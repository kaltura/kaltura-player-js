/*! For license information please see kaltura-ovp-player.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.KalturaPlayer=t():e.KalturaPlayer=t()}(self,(()=>(()=>{var __webpack_modules__={989:(module,e,t)=>{var r,n,a,i;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}module=t.nmd(module),self,i=function(){return function(){var e={"./src/entities/bumper.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=(0,n.default)((function e(t){(0,a.default)(this,e),this.url=t.url,this.clickThroughUrl=t.clickThroughUrl}))},"./src/entities/document-source.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{DocumentSource:function(){return i},default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=(0,n.default)((function e(t){(0,a.default)(this,e),this.id=t.id,this.url=t.downloadUrl,this.thumbnailUrl=t.poster,this.mimetype=""}))},"./src/entities/drm.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t,r,a){(0,n.default)(this,e),this.licenseUrl=t,this.scheme=r,a&&(this.certificate=a)}return(0,a.default)(e,[{key:"toJSON",value:function(){var e={licenseUrl:this.licenseUrl,scheme:this.scheme};return this.certificate&&(e.certificate=this.certificate),e}}]),e}()},"./src/entities/entry-list.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=(0,n.default)((function e(){(0,a.default)(this,e),this.items=[]}))},"./src/entities/image-source.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ImageSource:function(){return i},default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t){(0,n.default)(this,e),this.id=t.id,this.url=e.extractBaseThumbnailUrl(t.dataUrl),this.mimetype=""}return(0,a.default)(e,null,[{key:"extractBaseThumbnailUrl",value:function(e){return e.match(".+entry_id/[a-zA-Z0-9_]+/")[0].slice(0,-1)}}]),e}()},"./src/entities/media-entry.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/entities/media-sources.ts"),o=function(){function e(){(0,n.default)(this,e),this.metadata=new Map,this.sources=new s.default,this.type=e.Type.UNKNOWN}return(0,a.default)(e,[{key:"toJSON",value:function(){return{id:this.id,name:this.name,sources:this.sources.toJSON(),duration:this.duration,dvrStatus:this.dvrStatus,status:this.status,metadata:this.metadata,type:this.type,poster:this.poster,assetReferenceType:this.assetReferenceType,downloadUrl:this.downloadUrl,rawThumbnailUrl:this.rawThumbnailUrl,rootEntryId:this.rootEntryId,capabilities:this.capabilities}}}]),e}();(0,i.default)(o,"Type",{VOD:"Vod",LIVE:"Live",IMAGE:"Image",AUDIO:"Audio",UNKNOWN:"Unknown",DOCUMENT:"Document"}),(0,i.default)(o,"DvrStatus",{ON:1,OFF:0})},"./src/entities/media-format.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{MediaFormat:function(){return n},SupportedStreamFormat:function(){return a},isProgressiveSource:function(){return i}});var n={DASH:{name:"dash",mimeType:"application/dash+xml",pathExt:"mpd"},HLS:{name:"hls",mimeType:"application/x-mpegURL",pathExt:"m3u8"},WVM:{name:"wvm",mimeType:"video/wvm",pathExt:"wvm"},MP4:{name:"mp4",mimeType:"video/mp4",pathExt:"mp4"},MP3:{name:"mp3",mimeType:"audio/mpeg",pathExt:"mp3"}},a=new Map([["mpegdash",n.DASH],["applehttp",n.HLS],["url",n.MP4]]);function i(e){var t=a.get(e);return!!t&&t.name===n.MP4.name}},"./src/entities/media-source.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,[{key:"toJSON",value:function(){var e={id:this.id,url:this.url,mimetype:this.mimetype};return this.bandwidth&&(e.bandwidth=this.bandwidth),this.width&&(e.width=this.width),this.height&&(e.height=this.height),this.label&&(e.label=this.label),this.drmData&&this.drmData.length>0&&(e.drmData=[],this.drmData.forEach((function(t){Array.isArray(e.drmData)&&e.drmData.push(t.toJSON())}))),e}}]),e}()},"./src/entities/media-sources.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/entities/media-format.ts"),s=function(){function e(){(0,n.default)(this,e),this.progressive=[],this.dash=[],this.hls=[],this.image=[],this.document=[]}return(0,a.default)(e,[{key:"map",value:function(e,t){if(t)switch(t.name){case i.MediaFormat.MP4.name:this.progressive.push(e);break;case i.MediaFormat.DASH.name:this.dash.push(e);break;case i.MediaFormat.HLS.name:this.hls.push(e)}}},{key:"toJSON",value:function(){var e={progressive:[],dash:[],hls:[],image:[],document:[]};return this.progressive.forEach((function(t){return e.progressive.push(t.toJSON())})),this.hls.forEach((function(t){return e.hls.push(t.toJSON())})),this.dash.forEach((function(t){return e.dash.push(t.toJSON())})),e.image=this.image,e.document=this.document,e}}]),e}()},"./src/entities/playlist.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=(0,n.default)((function e(){(0,a.default)(this,e),this.items=[]}))},"./src/k-provider/common/base-provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BaseProvider:function(){return l},default:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/util/logger.ts"),o=r("./src/util/error/error.ts"),l=function(){function e(t,r){(0,n.default)(this,e),(0,i.default)(this,"_networkRetryConfig",{async:!0,timeout:0,maxAttempts:4}),(0,s.setLogger)(t.logger),this._partnerId=t.partnerId,this._widgetId=t.widgetId,this._uiConfId=t.uiConfId,this._isAnonymous=!t.ks,this._ks=t.ks||"",this._playerVersion=r,this._referrer=t.referrer}return(0,a.default)(e,[{key:"partnerId",get:function(){return this._partnerId}},{key:"widgetId",get:function(){return this._widgetId||this.defaultWidgetId}},{key:"defaultWidgetId",get:function(){return"_"+this._partnerId}},{key:"uiConfId",get:function(){return this._uiConfId}},{key:"ks",get:function(){return this._ks},set:function(e){this._ks=e}},{key:"playerVersion",get:function(){return this._playerVersion}},{key:"isAnonymous",get:function(){return this._isAnonymous}},{key:"getMediaConfig",value:function(e){return Promise.reject(new o.default(o.default.Severity.CRITICAL,o.default.Category.PROVIDER,o.default.Code.METHOD_NOT_IMPLEMENTED,{message:"getMediaConfig method must be implement by the derived class"}))}},{key:"getPlaylistConfig",value:function(e){return Promise.reject(new o.default(o.default.Severity.CRITICAL,o.default.Category.PROVIDER,o.default.Code.METHOD_NOT_IMPLEMENTED,{message:"The provider does not support loading playlist by id"}))}},{key:"getEntryListConfig",value:function(e){return Promise.reject(new o.default(o.default.Severity.CRITICAL,o.default.Category.PROVIDER,o.default.Code.METHOD_NOT_IMPLEMENTED,{message:"The provider does not support loading entry list"}))}},{key:"_verifyHasSources",value:function(e){if(0===e.hls.concat(e.dash,e.progressive,e.image,e.document).length)throw new o.default(o.default.Severity.CRITICAL,o.default.Category.SERVICE,o.default.Code.MISSING_PLAY_SOURCE,{action:"",messages:"No play source for entry id: ".concat(e.id)})}},{key:"LogLevel",get:function(){return s.LogLevel}},{key:"getLogLevel",value:function(e){return(0,s.getLogLevel)(e)}},{key:"setLogLevel",value:function(e,t){(0,s.setLogLevel)(e,t)}}]),e}()},"./src/k-provider/common/base-service-result.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(0,n.default)((function e(t){(0,a.default)(this,e),(0,i.default)(this,"hasError",!1),"KalturaAPIException"===t.objectType?(this.hasError=!0,this.error=new o(t.code,t.message)):t.error&&"KalturaAPIException"===t.error.objectType?(this.hasError=!0,this.error=new o(t.error.code,t.error.message)):this.data=t})),o=(0,n.default)((function e(t,r){(0,a.default)(this,e),this.code=t,this.message=r}))},"./src/k-provider/common/data-loader-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/util/error/error.ts"),o=function(){function e(t){(0,n.default)(this,e),(0,i.default)(this,"_loadersResponseMap",new Map),(0,i.default)(this,"_loaders",new Map),this._networkRetryConfig=t}return(0,a.default)(e,[{key:"add",value:function(e,t,r){var n=this,a=new e(t);if(a.isValid()){this._loaders.set(e.id,a);var i=this._multiRequest.requests.length,s=a.requests;this._multiRequest.retryConfig=this._networkRetryConfig,s.forEach((function(e){e.params=e.params||{},e.params.ks=e.params.ks||r,n._multiRequest.add(e)}));var o=Array.from(new Array(s.length),(function(e,t){return t+i}));this._loadersResponseMap.set(e.id,o)}}},{key:"fetchData",value:function(e){var t=this;return new Promise((function(r,n){t._multiRequest.execute(e).then((function(e){t._multiResponse=e.response,t.prepareData(e.response).success?r(t._loaders):n(new s.default(s.default.Severity.CRITICAL,s.default.Category.NETWORK,s.default.Code.API_RESPONSE_MISMATCH,{headers:e.headers}))}),(function(e){n(e)}))}))}},{key:"prepareData",value:function(e){var t=this;return this._loaders.forEach((function(r,n){var a=t._loadersResponseMap.get(n);try{a&&a.length>0&&(r.response=e.results.slice(a[0],a[a.length-1]+1))}catch(e){return{success:!1,error:e}}})),{success:!0,data:this._loaders}}}]),e}()},"./src/k-provider/common/multi-request-builder.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{MultiRequestResult:function(){return g},default:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=r("./src/util/request-builder.ts"),d=r("./src/util/logger.ts"),p=r("./src/k-provider/common/base-service-result.ts"),h=r("./src/util/error/error.ts");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var m=function(e){(0,s.default)(r,e);var t=f(r);function r(){var e;(0,n.default)(this,r);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s)),(0,u.default)((0,i.default)(e),"requests",[]),e}return(0,a.default)(r,[{key:"add",value:function(e){this.requests.push(e);var t={},r={service:e.service,action:e.action};return Object.assign(t,(0,u.default)({},this.requests.length,Object.assign(r,e.params))),Object.assign(t,this.params),this.params=t,this}},{key:"execute",value:function(e){var t=this;return new Promise((function(n,a){try{t.params=JSON.stringify(t.params)}catch(e){r._logger.error("".concat(e.message)),a(new h.default(h.default.Severity.CRITICAL,h.default.Category.PROVIDER,h.default.Code.FAILED_PARSING_REQUEST,{error:e,params:t.params}))}t.doHttpRequest().then((function(r){var i=new g(r,e);i.success?n({headers:t.responseHeaders,response:i}):a(new h.default(h.default.Severity.CRITICAL,h.default.Category.NETWORK,h.default.Code.MULTIREQUEST_API_ERROR,{url:t.url,headers:t.responseHeaders,results:i.results}))}),(function(e){a(e)}))}))}}]),r}(c.default);(0,u.default)(m,"_logger",(0,d.default)("MultiRequestBuilder"));var g=(0,a.default)((function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,n.default)(this,e),(0,u.default)(this,"results",[]);var a=t.result?t.result:t,i=(Array.isArray(a)?a:[a]).map((function(e){return new p.default(e)})),s=i.filter((function(e){return e.hasError}));s.forEach((function(t){e._logger.error("Service returned an error with error code: ".concat(t.error.code," and message: ").concat(t.error.message,"."))})),this.results=i,r&&s.length||s.length===this.results.length?this.success=!1:(this.results=this.results.filter((function(e){return!e.hasError})),this.success=!0)}));(0,u.default)(g,"_logger",(0,d.default)("MultiRequestResult"))},"./src/k-provider/common/response-types/kaltura-access-control-message.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaAccessControlMessage:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=(0,n.default)((function e(t){(0,a.default)(this,e),this.message=t.message,this.code=t.code}))},"./src/k-provider/common/response-types/kaltura-drm-playback-plugin-data.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaDrmPlaybackPluginData:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(0,n.default)((function e(t){(0,a.default)(this,e),this.scheme=t.scheme,this.licenseURL=t.licenseURL,this.certificate=t.certificate}));(0,i.default)(s,"Scheme",{"drm.PLAYREADY_CENC":"com.microsoft.playready","drm.WIDEVINE_CENC":"com.widevine.alpha","fairplay.FAIRPLAY":"com.apple.fairplay",WIDEVINE_CENC:"com.widevine.alpha",PLAYREADY_CENC:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"})},"./src/k-provider/ovp/config.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{OVPConfiguration:function(){return o},default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/util/clone.ts"),s={serviceUrl:"https://cdnapisec.kaltura.com/api_v3",cdnUrl:"https://cdnapisec.kaltura.com",serviceParams:{apiVersion:"3.3.0",format:1},useApiCaptions:!0,loadThumbnailWithKs:!1,replaceHostOnlyManifestUrls:!1},o=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"set",value:function(e){null!=e&&e.overrideServiceUrl&&(e.serviceUrl=e.overrideServiceUrl),e&&Object.assign(s,e)}},{key:"get",value:function(){return(0,i.clone)(s)}},{key:"serviceUrl",get:function(){return s.serviceUrl}}]),e}()},"./src/k-provider/ovp/external-captions-builder.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ExternalCaptionsBuilder:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/k-provider/ovp/provider-parser.ts"),s={SRT:"1",DFXP:"2",WEBVTT:"3",CAP:"4"},o={3:"vtt",1:"srt"},l=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"createConfig",value:function(e,t){return e.map((function(e){var r=e.url,n=o[e.format];return[s.DFXP,s.CAP].includes(e.format)&&(r=e.webVttUrl,n=o[s.WEBVTT]),r=(0,i.addKsToUrl)(r,t),{default:!!e.isDefault,type:n,language:e.languageCode,label:e.label,url:r}}))}}]),e}()},"./src/k-provider/ovp/loaders/data-loader-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/common/data-loader-manager.ts"),u=r("./src/k-provider/ovp/services/ovp-service.ts");function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(e,n){var i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3?arguments[3]:void 0;return(0,a.default)(this,r),(i=t.call(this,o))._multiRequest=u.default.getMultiRequest(e,s,n),i}return(0,n.default)(r)}(l.default)},"./src/k-provider/ovp/loaders/entry-list-loader.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/k-provider/ovp/config.ts"),o=r("./src/k-provider/ovp/services/base-entry-service.ts"),l=r("./src/k-provider/ovp/response-types/kaltura-base-entry-list-response.ts"),u=function(){function e(t){(0,n.default)(this,e),(0,i.default)(this,"_response",{playlistItems:{entries:[]}}),this.requests=this.buildRequests(t),this._entries=t.entries}return(0,a.default)(e,[{key:"requests",get:function(){return this._requests},set:function(e){this._requests=e}},{key:"response",get:function(){return this._response},set:function(e){var t,r=this;e.forEach((function(e){t=new l.KalturaBaseEntryListResponse(e.data),r._response.playlistItems.entries.push(t.entries[0])}))}},{key:"buildRequests",value:function(e){var t=s.default.get(),r=[];return e.entries.forEach((function(n){r.push(o.default.list(t.serviceUrl,e.ks,n.entryId||n,e.redirectFromEntryId,n.referenceId))})),r}},{key:"isValid",value:function(){return!(!this._entries||!this._entries.length)}}],[{key:"id",get:function(){return"entry_list"}}]),e}()},"./src/k-provider/ovp/loaders/media-entry-loader.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/k-provider/ovp/services/base-entry-service.ts"),o=r("./src/k-provider/ovp/services/meta-data-service.ts"),l=r("./src/k-provider/ovp/config.ts"),u=r("./src/k-provider/ovp/response-types/index.ts"),c=function(){function e(t){(0,n.default)(this,e),(0,i.default)(this,"_response",{}),this.requests=this.buildRequests(t),this._entryId=t.entryId,this._referenceId=t.referenceId}return(0,a.default)(e,[{key:"requests",get:function(){return this._requests},set:function(e){this._requests=e}},{key:"response",get:function(){return this._response},set:function(e){var t=new u.KalturaBaseEntryListResponse(e[0].data);this._response.entry=t.entries[0],this._response.playBackContextResult=new u.KalturaPlaybackContext(e[1].data),this._response.metadataListResult=new u.KalturaMetadataListResponse(e[2].data)}},{key:"buildRequests",value:function(e){var t=l.default.get(),r=[];r.push(s.default.list(t.serviceUrl,e.ks,e.entryId,e.redirectFromEntryId,e.referenceId));var n="{1:result:ks}"===e.ks?"{2:result:objects:0:id}":"{1:result:objects:0:id}";return r.push(s.default.getPlaybackContext(t.serviceUrl,e.ks,n,e.referrer)),r.push(o.default.list(t.serviceUrl,e.ks,n)),r}},{key:"isValid",value:function(){return!(!this._entryId&&!this._referenceId)}}],[{key:"id",get:function(){return"media"}}]),e}()},"./src/k-provider/ovp/loaders/playlist-loader.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/k-provider/ovp/services/playlist-service.ts"),o=r("./src/k-provider/ovp/config.ts"),l=r("./src/k-provider/ovp/response-types/index.ts"),u=function(){function e(t){(0,n.default)(this,e),(0,i.default)(this,"_response",{}),this.requests=this.buildRequests(t),this._playlistId=t.playlistId}return(0,a.default)(e,[{key:"requests",get:function(){return this._requests},set:function(e){this._requests=e}},{key:"response",get:function(){return this._response},set:function(e){this._response.playlistData=new l.KalturaPlaylist(e[0].data),this._response.playlistItems=new l.KalturaMediaEntries(e[1].data),this._response.playlistUserEntries=new l.KalturaUserEntryListResponse(e[2].data)}},{key:"buildRequests",value:function(e){var t=o.default.get(),r=[];return r.push(s.default.get(t.serviceUrl,e.ks,e.playlistId)),r.push(s.default.execute(t.serviceUrl,e.ks,e.playlistId)),r.push(s.default.getLastEntryId(t.serviceUrl,e.ks,e.playlistId)),r}},{key:"isValid",value:function(){return!!this._playlistId}}],[{key:"id",get:function(){return"playlist"}}]),e}()},"./src/k-provider/ovp/loaders/session-loader.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/k-provider/ovp/services/session-service.ts"),o=r("./src/k-provider/ovp/config.ts"),l=function(){function e(t){(0,n.default)(this,e),(0,i.default)(this,"_response",{}),this.requests=this.buildRequests(t),this._widgetId=t.widgetId}return(0,a.default)(e,[{key:"requests",get:function(){return this._requests},set:function(e){this._requests=e}},{key:"response",get:function(){return this._response.ks},set:function(e){this._response.ks=e[0].data.ks}},{key:"buildRequests",value:function(e){var t=o.default.get(),r=[];return r.push(s.default.anonymousSession(t.serviceUrl,e.widgetId)),r}},{key:"isValid",value:function(){return!!this._widgetId}}],[{key:"id",get:function(){return"session"}}]),e}()},"./src/k-provider/ovp/play-source-url-builder.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/k-provider/ovp/config.ts"),s=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"build",value:function(e){var t=i.default.get(),r=t.serviceUrl.substr(0,t.serviceUrl.lastIndexOf("/")),n=e.partnerId,a=e.entryId,s=e.ks,o=e.uiConfId,l=e.format,u=e.protocol,c=e.extension,d=e.flavorIds;if(!r||isNaN(Number.parseInt(n))||!a||!l||!u)return"";var p=r;return r.endsWith("/")||(p+="/"),p+="p/"+n+"/sp/"+n+"00/playManifest/entryId/"+a+"/protocol/"+u+"/format/"+l,d?p+="/flavorIds/"+d:o&&(p+="/uiConfId/"+o),""!==s&&(p+="/ks/"+s),""!==c&&(p+="/a."+c),o&&""!==d&&(p+="?uiConfId="+o),p}}]),e}()},"./src/k-provider/ovp/provider-parser.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{addKsToUrl:function(){return A}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/k-provider/ovp/response-types/index.ts"),o=r("./src/k-provider/common/response-types/kaltura-drm-playback-plugin-data.ts"),l=r("./src/k-provider/ovp/play-source-url-builder.ts"),u=r("./src/util/xml-parser.ts"),c=r("./src/util/logger.ts"),d=r("./src/k-provider/ovp/config.ts"),p=r("./src/entities/media-entry.ts"),h=r("./src/entities/drm.ts"),f=r("./src/entities/media-source.ts"),m=r("./src/entities/media-sources.ts"),g=r("./src/entities/media-format.ts"),y=r("./src/entities/playlist.ts"),v=r("./src/entities/entry-list.ts"),_=r("./src/entities/bumper.ts"),k=r("./src/k-provider/ovp/external-captions-builder.ts"),E=r("./src/entities/image-source.ts"),b=r("./src/entities/document-source.ts"),T=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"getMediaEntry",value:function(t,r,n,a){var i=new p.default,s=a.entry,o=a.playBackContextResult,l=a.metadataListResult,u=o.sources;return i.activeLiveStreamTime=o.activeLiveStreamTime,i.sources=e._getParsedSources(u,t,r,n,s,o),e._fillBaseData(i,s,l,o),i.type!==p.default.Type.LIVE&&d.default.get().useApiCaptions&&o.data.playbackCaptions&&(i.sources.captions=k.ExternalCaptionsBuilder.createConfig(o.data.playbackCaptions,t)),i}},{key:"addKsToUrl",value:function(e,t){var r;return t?(r=-1!==e.split("?")[0].replace(/^.*[\\/]/,"").indexOf(".")?-1===e.indexOf("?")?"?ks=":"&ks=":"/ks/",e+r+t):e}},{key:"getPlaylist",value:function(t){var r=new y.default,n=t.playlistData,a=t.playlistItems.entries,i=t.playlistUserEntries.entries;return r.id=n.id,r.name=n.name,r.description=n.description,r.poster=n.poster,r.playlistLastEntryId=i.map((function(e){return e.playlistLastEntryId}))[0],a.forEach((function(t){var n=new p.default;e._fillBaseData(n,t),r.items.push(n)})),r}},{key:"getEntryList",value:function(t){var r=new v.default;return t.playlistItems.entries.forEach((function(t){var n=new p.default;e._fillBaseData(n,t),r.items.push(n)})),r}},{key:"getBumper",value:function(t,r,n){var a=t.playBackContextResult,i=a.bumperData[0];if(i){var s=(i&&i.sources).find((function(e){return(0,g.isProgressiveSource)(e.format)}));if(s){var o=e._parseProgressiveSources(s,a,r,n,0,i.entryId);if(o[0])return new _.default({url:o[0].url,clickThroughUrl:i.clickThroughUrl})}}}},{key:"_fillBaseData",value:function(t,r,n,a){if(t.poster=r.poster,t.rawThumbnailUrl=r.rawThumbnailUrl,t.id=r.id,t.duration=r.duration,t.downloadUrl=r.downloadUrl||"",t.metadata=e._parseMetadata(n),t.metadata.description=r.description||"",t.metadata.entryId=r.id||"",t.metadata.name=r.name||"",r.createdAt&&(t.metadata.createdAt=r.createdAt),r.updatedAt&&(t.metadata.updatedAt=r.updatedAt),r.creatorId&&(t.metadata.creatorId=r.creatorId),r.endDate&&(t.metadata.endDate=r.endDate),r.views&&(t.metadata.views=r.views),r.plays&&(t.metadata.plays=r.plays),t.metadata.tags=r.tags||"",t.status=r.status,t.rootEntryId=r.rootEntryId,t.capabilities=r.capabilities?r.capabilities.split(","):[],t.type=e._getEntryType(r.entryType,r.type),t.type===p.default.Type.LIVE&&(t.dvrStatus=r.dvrStatus),a&&a.flavorAssets[0]&&a.flavorAssets[0].width&&a.flavorAssets[0].height){var i=a.flavorAssets[0],s=i.height,o=i.width;t.metadata.aspectRatio=+Number(o/s).toFixed(2)}return a&&Array.isArray(a.flavorAssets)&&(t.metadata.audioFlavors=a.flavorAssets.filter((function(e){return e.bitrate&&!e.width&&!e.height}))),t}},{key:"_getEntryType",value:function(e,t){var r=p.default.Type.UNKNOWN;switch(e){case s.KalturaMediaEntry.MediaType.IMAGE.value:r=p.default.Type.IMAGE;break;case s.KalturaMediaEntry.MediaType.AUDIO.value:r=p.default.Type.AUDIO;break;default:switch(t){case s.KalturaMediaEntry.EntryType.MEDIA_CLIP.value:r=p.default.Type.VOD;break;case s.KalturaMediaEntry.EntryType.LIVE_STREAM.value:case s.KalturaMediaEntry.EntryType.LIVE_CHANNEL.value:r=p.default.Type.LIVE;break;case s.KalturaMediaEntry.EntryType.DOCUMENT.value:r=p.default.Type.DOCUMENT;break;default:r=p.default.Type.UNKNOWN}}return r}},{key:"_getParsedSources",value:function(t,r,n,a,i,o){var l,u,c=new m.default,d=function(t){var s=e._parseAdaptiveSource(t,o,r,n,a,i.id);if(s){var l=g.SupportedStreamFormat.get(t.format);c.map(s,l)}};return i.type===s.KalturaMediaEntry.EntryType.EXTERNAL_MEDIA.value?((u=new f.default).mimetype="video/youtube",u.url=i.referenceId,u.id=i.id+"_youtube",c.progressive.push(u)):i.entryType===s.KalturaMediaEntry.MediaType.IMAGE.value?c.image.push(new E.ImageSource(i)):i.type===s.KalturaMediaEntry.EntryType.DOCUMENT.value?c.document.push(new b.DocumentSource(i)):t&&t.length>0&&(t.filter((function(e){return!(0,g.isProgressiveSource)(e.format)})).forEach(d),l=t.find((function(t){return(0,g.isProgressiveSource)(t.format)&&""!==t.getProtocol(e._getBaseProtocol())})),c.progressive=e._parseProgressiveSources(l,o,r,n,a,i.id)),c}},{key:"_parseAdaptiveSource",value:function(t,r,n,a,i,s){var u=new f.default;if(t){var c="",d=g.SupportedStreamFormat.get(t.format),p=t.getProtocol(e._getBaseProtocol()),m=t.deliveryProfileId,y=t.format,v="";if(d&&(v=d.pathExt,u.mimetype=d.mimeType),t.hasFlavorIds()?(!v&&r.flavorAssets&&r.flavorAssets.length>0&&(v=r.flavorAssets[0].fileExt),c=l.default.build({entryId:s,flavorIds:t.flavorIds,format:y,ks:n,partnerId:a,uiConfId:i,extension:v,protocol:p})):c=e.addKsToUrl(t.url,n),!c){var _="failed to create play url from source, discarding source: (".concat(s,"_").concat(m,"), ").concat(y);return e._logger.warn(_),null}if(u.url=c,u.id=s+"_"+m+","+y,t.hasDrmData()){var k=[];t.drm.forEach((function(e){k.push(new h.default(e.licenseURL,o.KalturaDrmPlaybackPluginData.Scheme[e.scheme],e.certificate))})),u.drmData=k}}return u}},{key:"_parseProgressiveSources",value:function(t,r,n,a,i,s){var o=[],u=[];if(t){var c=t.getProtocol(e._getBaseProtocol()),d=t.format,p=t.deliveryProfileId,h=p+","+d;r.flavorAssets.map((function(t){var r=new f.default;r.id=t.id+h,r.mimetype="mp3"===t.fileExt?"audio/mp3":"video/mp4",r.height=t.height,r.width=t.width,r.bandwidth=1024*t.bitrate,r.label=t.label||t.language;var m=l.default.build({entryId:s,flavorIds:t.id,format:d,ks:n,partnerId:a,uiConfId:i,extension:t.fileExt,protocol:c});if(""===m)return e._logger.warn("failed to create play url from source, discarding source: (".concat(s,"_").concat(p,"), ").concat(d,".")),null;r.url=m,t.height&&t.width?o.push(r):u.push(r)}))}return u.length&&!o.length?u:o}},{key:"_parseMetadata",value:function(e){var t={};return e&&e.metas&&e.metas.length>0&&e.metas.forEach((function(e){if(e.xml){var r=new DOMParser;e.xml=e.xml.replace(/\r?\n|\r/g,""),e.xml=e.xml.replace(/>\s*/g,">"),e.xml=e.xml.replace(/>\s*/g,">");var n=r.parseFromString(e.xml,"text/xml"),a=u.default.xmlToJson(n);Object.keys(a.metadata).forEach((function(e){t[e]=a.metadata[e]["#text"]}))}})),t}},{key:"_getBaseProtocol",value:function(){var e=d.default.get(),t=/^https?:/.exec(e.cdnUrl),r=t?t[0]:document.location.protocol;return"string"==typeof r?r.slice(0,-1):"https"}},{key:"hasBlockAction",value:function(e){return e.playBackContextResult.hasBlockAction()}},{key:"getBlockAction",value:function(e){return e.playBackContextResult.getBlockAction()}},{key:"hasScheduledRestriction",value:function(e){return e.playBackContextResult.hasScheduledRestriction()}},{key:"getErrorMessages",value:function(e){return e.playBackContextResult.getErrorMessages()}}]),e}();(0,i.default)(T,"_logger",(0,c.default)("OVPProviderParser"));var A=T.addKsToUrl;t.default=T},"./src/k-provider/ovp/provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var n=r("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),o=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),l=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=r("./node_modules/@babel/runtime/regenerator/index.js"),p=r.n(d),h=r("./src/util/logger.ts"),f=r("./src/k-provider/ovp/config.ts"),m=r("./src/k-provider/ovp/provider-parser.ts"),g=r("./src/k-provider/ovp/response-types/index.ts"),y=r("./src/k-provider/ovp/loaders/media-entry-loader.ts"),v=r("./src/k-provider/ovp/loaders/session-loader.ts"),_=r("./src/k-provider/ovp/loaders/data-loader-manager.ts"),k=r("./src/k-provider/ovp/loaders/playlist-loader.ts"),E=r("./src/k-provider/common/base-provider.ts"),b=r("./src/entities/media-entry.ts"),T=r("./src/k-provider/ovp/loaders/entry-list-loader.ts"),A=r("./src/util/error/error.ts"),S=r("./src/k-provider/ovp/regex-action-handler.ts"),P=r("./src/k-provider/ovp/services/user-service.ts"),C=r("./src/k-provider/ovp/response-types/kaltura-user-get-response.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}var I=function(e){(0,o.default)(l,e);var t,r=x(l);function l(e,t){var n;return(0,a.default)(this,l),n=r.call(this,e,t),(0,c.default)((0,s.default)(n),"_filterOptionsConfig",{redirectFromEntryId:!0}),n._logger=(0,h.default)("OVPProvider"),f.default.set(e.env),n._setFilterOptionsConfig(e.filterOptions),n._vrTag=e.vrTag||"360",n._networkRetryConfig=Object.assign(n._networkRetryConfig,e.networkRetryParameters),n._isAnonymous=!n._ks||void 0,void 0===n._isAnonymous&&n.initializeUserResponse(f.default.serviceUrl,n._ks).then((function(){n._logger.info("User response initialized")})).catch((function(e){n._logger.error("Failed to initialize user response",e)})),n}return(0,i.default)(l,[{key:"env",get:function(){return f.default.get()}},{key:"initializeUserResponse",value:(t=(0,n.default)(p().mark((function e(t,r){var n,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=P.default.get(t,r)).params=JSON.stringify(n.params),e.next=4,n.doHttpRequest();case 4:a=e.sent,i=new C.KalturaUserGetResponse(a),this._isAnonymous=i.isAnonymous();case 7:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"getMediaConfig",value:function(e){var t=this;return e.ks&&(this.ks=e.ks),this._dataLoader=new _.default(this.playerVersion,this.partnerId,this.ks,this._networkRetryConfig),new Promise((function(r,n){var a=e.entryId,i=e.referenceId;if(a||i){var s=t.ks;s||(s="{1:result:ks}",t._dataLoader.add(v.default,{widgetId:t.widgetId}));var o=t._getEntryRedirectFilter(e);return t._dataLoader.add(y.default,{entryId:a,ks:s,redirectFromEntryId:o,referenceId:i,referrer:t._referrer}),t._dataLoader.fetchData().then((function(e){try{var a=t._parseDataFromResponse(e);S.default.handleRegexAction(a,e).then(r)}catch(e){n(e)}}),(function(e){n(e)}))}n(new A.default(A.default.Severity.CRITICAL,A.default.Category.PROVIDER,A.default.Code.MISSING_MANDATORY_PARAMS,{message:"missing entry id"}))}))}},{key:"doRequest",value:function(e,t,r){var n=this,a=t||this.ks,i=new _.default(this.playerVersion,this.partnerId,a,this._networkRetryConfig);return new Promise((function(t,s){return a||i.add(v.default,{widgetId:n.widgetId}),e.forEach((function(e){i.add(e.loader,e.params,a||"{1:result:ks}")})),i.fetchData(r).then((function(e){try{t(e)}catch(e){s(e)}}),(function(e){s(e)}))}))}},{key:"_getEntryRedirectFilter",value:function(e){return"boolean"==typeof e.redirectFromEntryId?e.redirectFromEntryId:"boolean"!=typeof this._filterOptionsConfig.redirectFromEntryId||this._filterOptionsConfig.redirectFromEntryId}},{key:"_setFilterOptionsConfig",value:function(e){e&&"boolean"==typeof e.redirectFromEntryId&&(this._filterOptionsConfig.redirectFromEntryId=e.redirectFromEntryId)}},{key:"_parseDataFromResponse",value:function(e){this._logger.debug("Data parsing started");var t={session:{isAnonymous:this._isAnonymous,partnerId:this.partnerId},sources:this._getDefaultSourcesObject(),plugins:{}};if(this.uiConfId&&(t.session.uiConfId=this.uiConfId),e){if(e.has(v.default.id)){var r=e.get(v.default.id);r&&r.response&&(t.session.ks=r.response,this.widgetId!==this.defaultWidgetId&&(this.ks=t.session.ks))}else t.session.ks=this.ks;if(e.has(y.default.id)){var n=e.get(y.default.id);if(n&&n.response){var a=n.response;if(m.default.hasBlockAction(a))throw new A.default(A.default.Severity.CRITICAL,A.default.Category.SERVICE,A.default.Code.BLOCK_ACTION,{action:m.default.getBlockAction(a),messages:m.default.getErrorMessages(a)});if(m.default.hasScheduledRestriction(a))throw new A.default(A.default.Severity.CRITICAL,A.default.Category.SERVICE,A.default.Code.SCHEDULED_RESTRICTED,{messages:m.default.getErrorMessages(a)});var i=m.default.getMediaEntry(this.ks,this.partnerId,this.uiConfId,a);Object.assign(t.sources,this._getSourcesObject(i)),this._verifyMediaStatus(i),this._verifyHasSources(t.sources);var s=m.default.getBumper(a,this.ks,this.partnerId);s&&Object.assign(t.plugins,{bumper:s})}}}return this._logger.debug("Data parsing finished",t),t}},{key:"_verifyMediaStatus",value:function(e){if([g.KalturaMediaEntry.EntryStatus.IMPORT,g.KalturaMediaEntry.EntryStatus.PRECONVERT].includes(e.status))throw new A.default(A.default.Severity.CRITICAL,A.default.Category.SERVICE,A.default.Code.MEDIA_STATUS_NOT_READY,{messages:"Status of entry id ".concat(e.id," is ").concat(e.status," and is still being imported or converted"),data:{status}})}},{key:"getPlaylistConfig",value:function(e){var t=this;return e.ks&&(this.ks=e.ks),this._dataLoader=new _.default(this.playerVersion,this.partnerId,this.ks,this._networkRetryConfig),new Promise((function(r,n){var a=e.playlistId;if(a){var i=t.ks;i||(i="{1:result:ks}",t._dataLoader.add(v.default,{widgetId:t.widgetId})),t._dataLoader.add(k.default,{playlistId:a,ks:i}),t._dataLoader.fetchData().then((function(e){r(t._parsePlaylistDataFromResponse(e))}),(function(e){n(e)}))}else n({success:!1,data:"Missing mandatory parameter"})}))}},{key:"_parsePlaylistDataFromResponse",value:function(e){var t=this;this._logger.debug("Data parsing started");var r=this._getPlaylistObject();if(e&&e.has(k.default.id)){var n=e.get(k.default.id);if(n&&n.response){var a=m.default.getPlaylist(n.response);r.id=a.id,r.poster=a.poster,r.metadata.name=a.name,r.metadata.description=a.description,r.playlistLastEntryId=a.playlistLastEntryId,a.items.forEach((function(e){return r.items.push({sources:t._getSourcesObject(e)})}))}}return this._logger.debug("Data parsing finished",r),r}},{key:"getEntryListConfig",value:function(e){var t=this;return e.ks&&(this.ks=e.ks),this._dataLoader=new _.default(this.playerVersion,this.partnerId,this.ks,this._networkRetryConfig),new Promise((function(r,n){var a=e.entries;if(a&&a.length){var i=t.ks;i||(i="{1:result:ks}",t._dataLoader.add(v.default,{widgetId:t.widgetId}));var s=t._getEntryRedirectFilter(e);t._dataLoader.add(T.default,{entries:a,ks:i,redirectFromEntryId:s}),t._dataLoader.fetchData(!1).then((function(e){r(t._parseEntryListDataFromResponse(e))}),(function(e){n(e)}))}else n({success:!1,data:"Missing mandatory parameter"})}))}},{key:"_parseEntryListDataFromResponse",value:function(e){var t=this;this._logger.debug("Data parsing started");var r=this._getPlaylistObject();if(e&&e.has(T.default.id)){var n=e.get(T.default.id);n&&n.response&&m.default.getEntryList(n.response).items.forEach((function(e){return r.items.push({sources:t._getSourcesObject(e)})}))}return this._logger.debug("Data parsing finished",r),r}},{key:"_getPlaylistObject",value:function(){return{id:"",metadata:{name:"",description:""},poster:"",playlistLastEntryId:"",items:[]}}},{key:"_getDefaultSourcesObject",value:function(){return{hls:[],dash:[],progressive:[],image:[],document:[],id:"",duration:0,type:b.default.Type.UNKNOWN,poster:"",rawThumbnailUrl:"",dvr:!1,vr:null,metadata:{name:"",description:"",tags:""}}}},{key:"_getSourcesObject",value:function(e){var t=this,r=this._getDefaultSourcesObject(),n=e.sources.toJSON();return r.hls=n.hls,r.dash=n.dash,r.progressive=n.progressive,r.image=n.image,r.document=n.document,r.id=e.id,r.duration=e.duration,r.type=e.type,r.dvr=!!e.dvrStatus,r.poster=e.poster,r.rawThumbnailUrl=e.rawThumbnailUrl,r.downloadUrl=e.downloadUrl,r.rootEntryId=e.rootEntryId,r.capabilities=e.capabilities,e.activeLiveStreamTime&&(r.activeLiveStreamTime=e.activeLiveStreamTime),e.sources.captions&&(r.captions=e.sources.captions),e.metadata&&"string"==typeof e.metadata.tags&&e.metadata.tags.split(",").some((function(e){return e.trim()===t._vrTag}))&&(r.vr={}),Object.assign(r.metadata,e.metadata),r}}]),l}(E.default)},"./src/k-provider/ovp/regex-action-handler.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/util/logger.ts"),l=r("./src/k-provider/ovp/config.ts"),u=r("./src/k-provider/ovp/loaders/media-entry-loader.ts"),c=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,null,[{key:"_applyRegexAction",value:function(e,t){if(e){var r=new RegExp(e.pattern,"i");if(t.match(r))return t.replace(r,e.replacement+"/")}return t}},{key:"_pingECDNAndReplaceHostUrls",value:function(t,r,n){return new Promise((function(a){var i=n+"/api_v3/service/system/action/ping/format/1",s=new XMLHttpRequest;s.open("GET",i),s.timeout=r.checkAliveTimeoutMs,s.onreadystatechange=function(){4===s.readyState&&(200===s.status&&e._replaceHostUrls(t,r),a(t))},s.ontimeout=function(){e._logger.warn("Got timeout while pinging the ECDN url. the ping url: ".concat(i)),a(t)},s.send()}))}},{key:"handleRegexAction",value:function(t,r){return new Promise((function(n){var a=l.default.get().cdnUrl,i=e._extractRegexActionFromData(r),s=e._getRegExp(i);a&&i&&s&&a.match(s)?i.checkAliveTimeoutMs>0?(e._logger.debug("executing ping request..."),e._pingECDNAndReplaceHostUrls(t,i,a.replace(s,i.replacement)).then(n)):(e._replaceHostUrls(t,i),n(t)):(e._logger.debug("exiting handleRegexAction - not applying regex action."),n(t))}))}},{key:"_replaceHostUrls",value:function(t,r){e._logger.debug("Starting to modify urls...");var a=t.sources,i=a.hls,s=a.dash,o=a.progressive,u=a.image;[].concat((0,n.default)(i),(0,n.default)(s),(0,n.default)(o),(0,n.default)(u)).forEach((function(t){return t.url=e._applyRegexAction(r,t.url)})),l.default.get().replaceHostOnlyManifestUrls||(e._logger.debug("replaceHostOnlyManifestUrls flag is off - modifying captions and poster URLs"),a.captions&&a.captions.forEach((function(t){return t.url=e._applyRegexAction(r,t.url)})),"string"==typeof a.poster&&(a.poster=e._applyRegexAction(r,a.poster))),e._logger.debug("Finished modifying urls")}},{key:"_extractRegexActionFromData",value:function(e){var t;return null===(t=e.get(u.default.id))||void 0===t||null===(t=t.response)||void 0===t?void 0:t.playBackContextResult.getRequestHostRegexAction()}},{key:"_getRegExp",value:function(e){if(e&&e.pattern&&e.replacement)return new RegExp(e.pattern,"i")}}]),e}();(0,s.default)(c,"_logger",(0,o.default)("RegexActionHandler")),t.default=c},"./src/k-provider/ovp/request-params/base-entry-response-profile.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BaseEntryResponseProfile:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(0,n.default)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),this.type=t.type||e.Type.INCLUDE_FIELDS,this.fields=t.fields||"id,referenceId,name,description,thumbnailUrl,dataUrl,duration,msDuration,flavorParamsIds,mediaType,type,tags,dvrStatus,externalSourceType,status,createdAt,updatedAt,endDate,plays,views,downloadUrl,creatorId,rootEntryId,capabilities"}));(0,i.default)(s,"Type",{INCLUDE_FIELDS:1,EXCLUDE_FIELDS:2})},"./src/k-provider/ovp/response-types/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BaseServiceResult:function(){return n.default},KalturaAccessControlMessage:function(){return v.KalturaAccessControlMessage},KalturaAccessControlModifyRequestHostRegexAction:function(){return s.KalturaAccessControlModifyRequestHostRegexAction},KalturaBaseEntryListResponse:function(){return a.KalturaBaseEntryListResponse},KalturaBumper:function(){return o.KalturaBumper},KalturaDrmPlaybackPluginData:function(){return y.KalturaDrmPlaybackPluginData},KalturaFlavorAsset:function(){return l.KalturaFlavorAsset},KalturaMediaEntries:function(){return u.KalturaMediaEntries},KalturaMediaEntry:function(){return i.KalturaMediaEntry},KalturaMetadata:function(){return c.KalturaMetadata},KalturaMetadataListResponse:function(){return d.KalturaMetadataListResponse},KalturaPlaybackContext:function(){return p.KalturaPlaybackContext},KalturaPlaybackSource:function(){return h.KalturaPlaybackSource},KalturaPlaylist:function(){return f.KalturaPlaylist},KalturaRuleAction:function(){return m.KalturaRuleAction},KalturaUIConfResponse:function(){return g.KalturaUIConfResponse},KalturaUserEntry:function(){return _.KalturaUserEntry},KalturaUserEntryListResponse:function(){return k.KalturaUserEntryListResponse}});var n=r("./src/k-provider/common/base-service-result.ts"),a=r("./src/k-provider/ovp/response-types/kaltura-base-entry-list-response.ts"),i=r("./src/k-provider/ovp/response-types/kaltura-media-entry.ts"),s=r("./src/k-provider/ovp/response-types/kaltura-access-control-modify-request-host-regex-action.ts"),o=r("./src/k-provider/ovp/response-types/kaltura-bumper.ts"),l=r("./src/k-provider/ovp/response-types/kaltura-flavor-asset.ts"),u=r("./src/k-provider/ovp/response-types/kaltura-media-entries.ts"),c=r("./src/k-provider/ovp/response-types/kaltura-metadata.ts"),d=r("./src/k-provider/ovp/response-types/kaltura-metadata-list-response.ts"),p=r("./src/k-provider/ovp/response-types/kaltura-playback-context.ts"),h=r("./src/k-provider/ovp/response-types/kaltura-playback-source.ts"),f=r("./src/k-provider/ovp/response-types/kaltura-playlist.ts"),m=r("./src/k-provider/ovp/response-types/kaltura-rule-action.ts"),g=r("./src/k-provider/ovp/response-types/kaltura-ui-conf-response.ts"),y=r("./src/k-provider/common/response-types/kaltura-drm-playback-plugin-data.ts"),v=r("./src/k-provider/common/response-types/kaltura-access-control-message.ts"),_=r("./src/k-provider/ovp/response-types/kaltura-user-entry.ts"),k=r("./src/k-provider/ovp/response-types/kaltura-user-entry-list-response.ts")},"./src/k-provider/ovp/response-types/kaltura-access-control-modify-request-host-regex-action.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaAccessControlModifyRequestHostRegexAction:function(){return u}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var u=function(e){(0,i.default)(r,e);var t=l(r);function r(e){var n;return(0,a.default)(this,r),(n=t.call(this,e)).pattern=e.pattern,n.replacement=e.replacement,n.replacmenServerNodeId=e.replacmenServerNodeId,n.checkAliveTimeoutMs=e.checkAliveTimeoutMs,n}return(0,n.default)(r)}(r("./src/k-provider/ovp/response-types/kaltura-rule-action.ts").KalturaRuleAction)},"./src/k-provider/ovp/response-types/kaltura-base-entry-list-response.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaBaseEntryListResponse:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/common/base-service-result.ts"),u=r("./src/k-provider/ovp/response-types/kaltura-media-entry.ts");function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(e){var n;return(0,a.default)(this,r),(n=t.call(this,e)).hasError||(n.totalCount=e.totalCount,n.totalCount>0&&(n.entries=[],e.objects.map((function(e){return n.entries.push(new u.KalturaMediaEntry(e))})))),n}return(0,n.default)(r)}(l.default)},"./src/k-provider/ovp/response-types/kaltura-bumper.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaBumper:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./src/k-provider/ovp/response-types/kaltura-playback-source.ts"),s=(0,n.default)((function e(t){(0,a.default)(this,e),this.entryId=t.entryId,this.clickThroughUrl=t.url,this.sources=t.sources?t.sources.map((function(e){return new i.KalturaPlaybackSource(e)})):[]}))},"./src/k-provider/ovp/response-types/kaltura-flavor-asset.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaFlavorAsset:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=function(){function e(t){(0,n.default)(this,e),this.id=t.id,this.flavorParamsId=t.flavorParamsId,this.fileExt=t.fileExt,this.bitrate=t.bitrate,this.width=t.width,this.height=t.height,this.id=t.id,this.frameRate=t.frameRate,this.isOriginal=t.isOriginal,this.isWeb=t.isWeb,this.containerFormat=t.containerFormat,this.videoCodecId=t.videoCodecId,this.status=t.status,this.language=t.language,this.label=t.label,this.tags=e.parseTags(t.tags)}return(0,a.default)(e,null,[{key:"parseTags",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(",")}}]),e}();(0,i.default)(s,"Status",{ERROR:-1,QUEUED:0,CONVERTING:1,READY:2,DELETED:3,NOT_APPLICABLE:4,TEMP:5,WAIT_FOR_CONVERT:6,IMPORTING:7,VALIDATING:8,EXPORTING:9})},"./src/k-provider/ovp/response-types/kaltura-media-entries.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaMediaEntries:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/common/base-service-result.ts"),u=r("./src/k-provider/ovp/response-types/kaltura-media-entry.ts");function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(e){var n;return(0,a.default)(this,r),(n=t.call(this,e)).hasError||(n.entries=[],e.map((function(e){return n.entries.push(new u.KalturaMediaEntry(e))}))),n}return(0,n.default)(r)}(l.default)},"./src/k-provider/ovp/response-types/kaltura-media-entry.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaMediaEntry:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(0,n.default)((function e(t){(0,a.default)(this,e),this.id=t.id,this.referenceId=t.referenceId,this.externalSourceType=t.externalSourceType,this.name=t.name,this.description=t.description,this.dataUrl=t.dataUrl,this.type=t.type,this.entryType=t.mediaType,this.flavorParamsIds=t.flavorParamsIds,this.duration=t.duration,this.poster=t.thumbnailUrl,this.rawThumbnailUrl=t.thumbnailUrl,this.status=t.status,this.dvrStatus=t.dvrStatus,this.tags=t.tags,this.createdAt=t.createdAt,this.updatedAt=t.updatedAt,this.creatorId=t.creatorId,this.endDate=t.endDate,this.plays=t.plays,this.views=t.views,this.downloadUrl=t.downloadUrl,this.rootEntryId=t.rootEntryId,this.capabilities=t.capabilities}));(0,i.default)(s,"EntryType",{AUTOMATIC:{value:-1},EXTERNAL_MEDIA:{value:"externalMedia.externalMedia"},MEDIA_CLIP:{value:1},MIX:{value:2},PLAYLIST:{value:5},DATA:{value:6},LIVE_STREAM:{value:7},LIVE_CHANNEL:{value:8},DOCUMENT:{value:10}}),(0,i.default)(s,"MediaType",{VIDEO:{value:1},IMAGE:{value:2},AUDIO:{value:5},LIVE_STREAM_FLASH:{value:201},LIVE_STREAM_WINDOWS_MEDIA:{value:202},LIVE_STREAM_REAL_MEDIA:{value:203},LIVE_STREAM_QUICK_TIME:{value:204}}),(0,i.default)(s,"EntryStatus",{ERROR_IMPORTING:-2,ERROR_CONVERTING:-1,SCAN_FAILURE:"virusScan.ScanFailure",IMPORT:0,INFECTED:"virusScan.Infected",PRECONVERT:1,READY:2,DELETED:3,PENDING:4,MODERATE:5,BLOCKED:6,NO_CONTENT:7}),(0,i.default)(s,"EntryModerationStatus",{PENDING_MODERATION:1,APPROVED:2,REJECTED:3,FLAGGED_FOR_REVIEW:4,MODERATE:5,AUTO_APPROVED:6})},"./src/k-provider/ovp/response-types/kaltura-metadata-list-response.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaMetadataListResponse:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/common/base-service-result.ts"),u=r("./src/k-provider/ovp/response-types/kaltura-metadata.ts");function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(e){var n;return(0,a.default)(this,r),(n=t.call(this,e)).hasError||(n.totalCount=e.totalCount,n.totalCount>0&&(n.metas=[],e.objects.map((function(e){return n.metas.push(new u.KalturaMetadata(e))})))),n}return(0,n.default)(r)}(l.default)},"./src/k-provider/ovp/response-types/kaltura-metadata.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaMetadata:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(0,n.default)((function e(t){(0,a.default)(this,e),this.id=t.id,this.metadataProfileId=t.metadataProfileId,this.metadataProfileVersion=t.metadataProfileVersion,this.metadataProfileId=t.metadataProfileId,this.metadataObjectType=t.metadataObjectType,this.objectId=t.objectId,this.version=t.version,this.created=new Date(0),this.created.setUTCSeconds(t.createdAt),this.updated=new Date(0),this.updated.setUTCSeconds(t.updatedAt),this.status=t.status,this.xml=t.xml}));(0,i.default)(s,"ObjectType",{AD_CUE_POINT:"adCuePointMetadata.AdCuePoint",ANNOTATION:"annotationMetadata.Annotation",CODE_CUE_POINT:"codeCuePointMetadata.CodeCuePoint",THUMB_CUE_POINT:"thumbCuePointMetadata.thumbCuePoint",ENTRY:1,CATEGORY:2,USER:3,PARTNER:4,DYNAMIC_OBJECT:5}),(0,i.default)(s,"Status",{VALID:1,INVALID:2,DELETED:3})},"./src/k-provider/ovp/response-types/kaltura-playback-context.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaPlaybackContext:function(){return v}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=r("./src/k-provider/common/base-service-result.ts"),d=r("./src/k-provider/common/response-types/kaltura-access-control-message.ts"),p=r("./src/k-provider/ovp/response-types/kaltura-playback-source.ts"),h=r("./src/k-provider/ovp/response-types/kaltura-access-control-modify-request-host-regex-action.ts"),f=r("./src/k-provider/ovp/response-types/kaltura-rule-action.ts"),m=r("./src/k-provider/ovp/response-types/kaltura-flavor-asset.ts"),g=r("./src/k-provider/ovp/response-types/kaltura-bumper.ts");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var v=function(e){(0,s.default)(r,e);var t=y(r);function r(e){var a;if((0,n.default)(this,r),a=t.call(this,e),(0,u.default)((0,i.default)(a),"sources",[]),(0,u.default)((0,i.default)(a),"actions",[]),(0,u.default)((0,i.default)(a),"messages",[]),(0,u.default)((0,i.default)(a),"flavorAssets",[]),(0,u.default)((0,i.default)(a),"bumperData",[]),!a.hasError){var s=e.messages;s&&s.map((function(e){return a.messages.push(new d.KalturaAccessControlMessage(e))}));var o=e.actions;o&&o.map((function(e){e.type===f.KalturaRuleAction.Type.REQUEST_HOST_REGEX?a.actions.push(new h.KalturaAccessControlModifyRequestHostRegexAction(e)):a.actions.push(new f.KalturaRuleAction(e))}));var l=e.sources;l&&l.map((function(e){return a.sources.push(new p.KalturaPlaybackSource(e))}));var c=e.flavorAssets;c&&c.map((function(e){return a.flavorAssets.push(new m.KalturaFlavorAsset(e))}));var y=e.bumperData;y&&y.map((function(e){return a.bumperData.push(new g.KalturaBumper(e))})),e.activeLiveStreamTime&&(a.activeLiveStreamTime={startTime:e.activeLiveStreamTime.startTime,endTime:e.activeLiveStreamTime.endTime})}return a}return(0,a.default)(r,[{key:"hasBlockAction",value:function(){return void 0!==this.getBlockAction()}},{key:"getBlockAction",value:function(){return this.actions.find((function(e){return e.type===f.KalturaRuleAction.Type.BLOCK}))}},{key:"hasScheduledRestriction",value:function(){return this.messages.some((function(e){return e.code===f.KalturaRuleAction.Type.SCHEDULED_RESTRICTED}))}},{key:"getErrorMessages",value:function(){return this.messages}},{key:"getRequestHostRegexAction",value:function(){var e=this.actions.find((function(e){return e.type===f.KalturaRuleAction.Type.REQUEST_HOST_REGEX}));if(e instanceof h.KalturaAccessControlModifyRequestHostRegexAction)return e}}]),r}(c.default)},"./src/k-provider/ovp/response-types/kaltura-playback-source.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaPlaybackSource:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/k-provider/common/response-types/kaltura-drm-playback-plugin-data.ts"),o=function(){function e(t){var r=this;(0,n.default)(this,e),(0,i.default)(this,"drm",[]),this.format=t.format,this.deliveryProfileId=t.deliveryProfileId,this.url=t.url,this.protocols=t.protocols,this.flavorIds=t.flavorIds,t.drm&&t.drm.map((function(e){return r.drm.push(new s.KalturaDrmPlaybackPluginData(e))}))}return(0,a.default)(e,[{key:"hasDrmData",value:function(){return this.drm&&this.drm.length>0}},{key:"hasFlavorIds",value:function(){return!!this.flavorIds&&this.flavorIds.length>0}},{key:"getProtocol",value:function(e){var t="";if(this.protocols&&this.protocols.length>0)this.protocols.split(",").forEach((function(r){r===e&&(t=r)}));else if("http"===e)return e;return t}}]),e}()},"./src/k-provider/ovp/response-types/kaltura-playlist.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaPlaylist:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=(0,n.default)((function e(t){(0,a.default)(this,e),this.id=t.id,this.name=t.name,this.description=t.description,this.poster=t.thumbnailUrl}))},"./src/k-provider/ovp/response-types/kaltura-rule-action.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaRuleAction:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(0,n.default)((function e(t){(0,a.default)(this,e),this.type=t.type}));(0,i.default)(s,"Type",{DRM_POLICY:"drm.DRM_POLICY",BLOCK:1,PREVIEW:2,LIMIT_FLAVORS:3,ADD_TO_STORAGE:4,LIMIT_DELIVERY_PROFILES:5,SERVE_FROM_REMOTE_SERVER:6,REQUEST_HOST_REGEX:7,LIMIT_THUMBNAIL_CAPTURE:8,SCHEDULED_RESTRICTED:"SCHEDULED_RESTRICTED"})},"./src/k-provider/ovp/response-types/kaltura-ui-conf-response.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaUIConfResponse:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js");function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var c=function(e){(0,i.default)(r,e);var t=u(r);function r(e){var n;return(0,a.default)(this,r),(n=t.call(this,e)).hasError||(n.name=e.name,n.description=e.description,n.objTypeAsString=e.objTypeAsString,n.width=e.width,n.height=e.height,n.htmlParams=e.htmlParams,n.swfUrl=e.swfUrl,n.confFilePath=e.confFilePath,n.confFile=e.confFile,n.confFileFeatures=e.confFileFeatures,n.config=e.config,n.confVars=e.confVars,n.useCdn=e.useCdn,n.tags=e.tags,n.swfUrlVersion=e.swfUrlVersion,n.created=new Date(0),n.created.setUTCSeconds(e.createdAt),n.updated=new Date(0),n.updated.setUTCSeconds(e.updatedAt),n.html5Url=e.description,n.version=e.description,n.partnerTags=e.description,n.objType=e.description,n.creationMode=e.description),n}return(0,n.default)(r)}(r("./src/k-provider/common/base-service-result.ts").default);(0,l.default)(c,"Type",{PLAYER:1,CONTRIBUTION_WIZARD:2,SIMPLE_EDITOR:3,ADVANCED_EDITOR:4,PLAYLIST:5,APP_STUDIO:6,KRECORD:7,PLAYER_V3:8,KMC_ACCOUNT:9,KMC_ANALYTICS:10,KMC_CONTENT:11,KMC_DASHBOARD:12,KMC_LOGIN:13,PLAYER_SL:14,CLIENTSIDE_ENCODER:15,KMC_GENERAL:16,KMC_ROLES_AND_PERMISSIONS:17,CLIPPER:18,KSR:19,KUPLOAD:20,WEBCASTING:21}),(0,l.default)(c,"CreationMode",{WIZARD:2,ADVANCED:3})},"./src/k-provider/ovp/response-types/kaltura-user-entry-list-response.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaUserEntryListResponse:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/common/base-service-result.ts"),u=r("./src/k-provider/ovp/response-types/kaltura-user-entry.ts");function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(e){var n;return(0,a.default)(this,r),(n=t.call(this,e)).hasError||(n.totalCount=e.totalCount,n.entries=[],n.totalCount>0&&e.objects.map((function(e){return n.entries.push(new u.KalturaUserEntry(e))}))),n}return(0,n.default)(r)}(l.default)},"./src/k-provider/ovp/response-types/kaltura-user-entry.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaUserEntry:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=(0,n.default)((function e(t){(0,a.default)(this,e),this.playlistLastEntryId=t.playlistLastEntryId,this.entryId=t.entryId,this.id=t.id,this.userId=t.userId,this.partnerId=t.partnerId,this.status=t.status,this.createdAt=t.createdAt,this.updatedAt=t.updatedAt}))},"./src/k-provider/ovp/response-types/kaltura-user-get-response.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KalturaUserGetResponse:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=function(){function e(t){(0,n.default)(this,e),this.id=t.id}return(0,a.default)(e,[{key:"isAnonymous",value:function(){return e.INVALID_IDS.includes(this.id)}}]),e}();(0,i.default)(s,"INVALID_IDS",["0","",null,void 0])},"./src/k-provider/ovp/services/base-entry-service.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/ovp/services/ovp-service.ts"),u=r("./src/util/request-builder.ts"),c=r("./src/k-provider/ovp/request-params/base-entry-response-profile.ts");function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var p="baseEntry",h=function(e){(0,i.default)(r,e);var t=d(r);function r(){return(0,n.default)(this,r),t.apply(this,arguments)}return(0,a.default)(r,null,[{key:"getPlaybackContext",value:function(e,t,r,n){var a=new Map;a.set("Content-Type","application/json");var i=new u.default(a);i.service=p,i.action="getPlaybackContext",i.method="POST",i.url=i.getUrl(e),i.tag="baseEntry-getPlaybackContext";var s={objectType:"KalturaContextDataParams",flavorTags:"all"};return n&&(s.referrer=n),i.params={entryId:r,ks:t,contextDataParams:s},i}},{key:"list",value:function(e,t,n,a,i){var s=new Map;s.set("Content-Type","application/json");var o=new u.default(s);return o.service=p,o.action="list",o.method="POST",o.url=o.getUrl(e),o.tag="list",o.params=r.getEntryListReqParams(n,t,a,i),o}},{key:"getEntryListReqParams",value:function(e,t,r,n){var a={};return e?a=r?{redirectFromEntryId:e}:{idEqual:e}:n&&(a={objectType:"KalturaBaseEntryFilter",referenceIdEqual:n}),{ks:t,filter:a,responseProfile:new c.BaseEntryResponseProfile}}}]),r}(l.default)},"./src/k-provider/ovp/services/meta-data-service.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/ovp/services/ovp-service.ts"),u=r("./src/util/request-builder.ts");function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(){return(0,n.default)(this,r),t.apply(this,arguments)}return(0,a.default)(r,null,[{key:"list",value:function(e,t,r){var n=new Map;n.set("Content-Type","application/json");var a=new u.default(n);a.service="metadata_metadata",a.action="list",a.method="POST",a.url=a.getUrl(e),a.tag="metadata_metadata-list";var i={objectType:"KalturaMetadataFilter",objectIdEqual:r,metadataObjectTypeEqual:"1"};return a.params={filter:i,ks:t},a}}]),r}(l.default)},"./src/k-provider/ovp/services/ovp-service.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/k-provider/common/multi-request-builder.ts"),s=r("./src/k-provider/ovp/config.ts"),o=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"getMultiRequest",value:function(e,t,r){var n=s.default.get(),a=n.serviceParams;Object.assign(a,{ks:t,clientTag:"html5:v"+e}),r&&Object.assign(a,{partnerId:r});var o=new Map;o.set("Content-Type","application/json");var l=new i.default(o);return l.method="POST",l.service="multirequest",l.url=l.getUrl(n.serviceUrl),l.params=a,l}}]),e}()},"./src/k-provider/ovp/services/playlist-service.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/ovp/services/ovp-service.ts"),u=r("./src/util/request-builder.ts"),c=r("./src/k-provider/ovp/request-params/base-entry-response-profile.ts");function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var p="playlist",h=function(e){(0,i.default)(r,e);var t=d(r);function r(){return(0,n.default)(this,r),t.apply(this,arguments)}return(0,a.default)(r,null,[{key:"execute",value:function(e,t,r){var n=new Map;n.set("Content-Type","application/json");var a=new u.default(n);return a.service=p,a.action="execute",a.method="POST",a.url=a.getUrl(e),a.tag="".concat(p,"-execute"),a.params={ks:t,id:r,responseProfile:new c.BaseEntryResponseProfile},a}},{key:"get",value:function(e,t,r){var n=new Map;n.set("Content-Type","application/json");var a=new u.default(n);return a.service=p,a.action="get",a.method="POST",a.url=a.getUrl(e),a.tag="".concat(p,"-get"),a.params={ks:t,id:r,responseProfile:{fields:"id,name,description,thumbnailUrl",type:1}},a}},{key:"getLastEntryId",value:function(e,t,r){var n=new Map;n.set("Content-Type","application/json");var a=new u.default(n);return a.service="userEntry",a.action="list",a.method="POST",a.url=a.getUrl(e),a.tag="userEntry-list",a.params={ks:t,filter:{objectType:"KalturaViewHistoryUserEntry",entryIdEqual:r,userIdEqualCurrent:1},responseProfile:{fields:"playlistLastEntryId",type:1}},a}}]),r}(l.default)},"./src/k-provider/ovp/services/session-service.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/ovp/services/ovp-service.ts"),u=r("./src/util/request-builder.ts");function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(){return(0,n.default)(this,r),t.apply(this,arguments)}return(0,a.default)(r,null,[{key:"anonymousSession",value:function(e,t){var r=new Map;r.set("Content-Type","application/json");var n=new u.default(r);return n.service="session",n.action="startWidgetSession",n.method="POST",n.url=n.getUrl(e),n.tag="session-startWidget",n.params={widgetId:t},n}}]),r}(l.default)},"./src/k-provider/ovp/services/user-service.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/k-provider/ovp/services/ovp-service.ts"),u=r("./src/util/request-builder.ts");function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=c(r);function r(){return(0,n.default)(this,r),t.apply(this,arguments)}return(0,a.default)(r,null,[{key:"get",value:function(e,t){var r=new Map;r.set("Content-Type","application/json");var n=new u.default(r);return n.service="user",n.action="get",n.method="POST",n.url=n.getUrl(e),n.tag="user-get",n.params={ks:t,format:1},n}}]),r}(l.default)},"./src/util/clone.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{clone:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js"),a=function e(t){var r;return Array.isArray(t)?(r=t.length>0?t.slice(0):[]).forEach((function(t,a){("object"===(0,n.default)(t)||Array.isArray(t)&&t.length>0)&&(r[a]=e(t))})):"object"===(0,n.default)(t)?(r=Object.assign({},t),Object.keys(r).forEach((function(t){("object"===(0,n.default)(r[t])||Array.isArray(r[t])&&r[t].length>0)&&(r[t]=e(r[t]))}))):r=t,r}},"./src/util/error/category.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Category:function(){return n}});var n={NETWORK:1,SERVICE:2,PROVIDER:3}},"./src/util/error/code.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Code:function(){return n}});var n={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,BAD_SERVER_RESPONSE:1005,MULTIREQUEST_API_ERROR:1006,API_RESPONSE_MISMATCH:1007,ERROR:2e3,BLOCK_ACTION:2001,MEDIA_STATUS_NOT_READY:2002,SCHEDULED_RESTRICTED:2003,MISSING_MANDATORY_PARAMS:3e3,MISSING_PLAY_SOURCE:3001,METHOD_NOT_IMPLEMENTED:3002}},"./src/util/error/error.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/util/logger.ts"),o=r("./src/util/error/severity.ts"),l=r("./src/util/error/code.ts"),u=r("./src/util/error/category.ts"),c=(0,n.default)((function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,a.default)(this,e),this.severity=t,this.category=r,this.code=n,this.data=i,e._logger.error("Category:".concat(r," | Code:").concat(n," |"),i)}));(0,i.default)(c,"Severity",o.Severity),(0,i.default)(c,"Category",u.Category),(0,i.default)(c,"Code",l.Code),(0,i.default)(c,"_logger",(0,s.default)("Error"))},"./src/util/error/severity.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Severity:function(){return n}});var n={RECOVERABLE:1,CRITICAL:2}},"./src/util/logger.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{LogLevel:function(){return a},getLogLevel:function(){return o},setLogLevel:function(){return l},setLogger:function(){return i}});var n={get:function(){return{VERSION:"",DEBUG:{value:"",name:""},ERROR:{value:"",name:""},INFO:{value:"",name:""},OFF:{value:"",name:""},TIME:{value:"",name:""},TRACE:{value:"",name:""},WARN:{value:"",name:""},createDefaultHandler:function(){},debug:function(){},enabledFor:function(){},error:function(){},get:function(){},getLevel:function(){},info:function(){},log:function(){},setHandler:function(){},setLevel:function(){},time:function(){},timeEnd:function(){},trace:function(){},useDefaults:function(){},warn:function(){}}}},a={};function i(e){e&&"function"==typeof e.getLogger&&(n.get=e.getLogger),e&&e.LogLevel&&(a=e.LogLevel)}function s(e){return n.get(e)}function o(e){return s(e).getLevel()}function l(e,t){s(t).setLevel(e)}t.default=s},"./src/util/request-builder.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/util/error/error.ts"),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;(0,n.default)(this,e),(0,i.default)(this,"retryConfig",{async:!0,timeout:0,maxAttempts:4}),(0,i.default)(this,"_attemptCounter",1),this.headers=t}return(0,a.default)(e,[{key:"getUrl",value:function(e){return e+"/service/"+this.service+(this.action?"/action/"+this.action:"")}},{key:"doHttpRequest",value:function(){var e=this,t=new Promise((function(t,r){e._requestPromise={resolve:t,reject:r}}));return this.url||this._requestPromise.reject(new s.default(s.default.Severity.CRITICAL,s.default.Category.NETWORK,s.default.Code.MALFORMED_DATA_URI,{url:this.url})),this._createXHR(),t}},{key:"_createXHR",value:function(){var e=this,t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status)try{var r=JSON.parse(t.responseText);return e.responseHeaders=e._getResponseHeaders(t),e._requestPromise.resolve(r)}catch(r){e._requestPromise.reject(e._createError(t,s.default.Code.BAD_SERVER_RESPONSE,{text:t.responseText}))}},t.open(this.method,this.url,this.retryConfig.async),this.retryConfig.async&&this.retryConfig.timeout&&(t.timeout=this.retryConfig.timeout);var r=performance.now();t.ontimeout=function(){e._handleError(t,s.default.Code.TIMEOUT,{timeout:(performance.now()-r)/1e3,statusText:t.statusText})},t.onerror=t.onabort=function(){e._handleError(t,s.default.Code.HTTP_ERROR,{text:t.responseText,statusText:t.statusText})},this.headers.forEach((function(e,r){t.setRequestHeader(r,e)})),t.send(this.params)}},{key:"_getResponseHeaders",value:function(e){return e.getAllResponseHeaders().split("\n").filter((function(e){return 0===e.toLowerCase().indexOf("x-")}))}},{key:"_handleError",value:function(e,t,r){var n=this._createError(e,t,r);if(e.onreadystatechange=function(){},e.onerror=function(){},e.ontimeout=function(){},e.onabort=function(){},!(this.retryConfig.maxAttempts&&this._attemptCounter<this.retryConfig.maxAttempts))return this._requestPromise.reject(n);this._attemptCounter++,this._createXHR()}},{key:"_createError",value:function(e,t,r){return Object.assign(r,{url:this.url,headers:this._getResponseHeaders(e),attempt:this._attemptCounter}),new s.default(s.default.Severity.CRITICAL,s.default.Category.NETWORK,t,r)}}]),e}()},"./src/util/xml-parser.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"xmlToJson",value:function(e){var t={};if(1===e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var r=0;r<e.attributes.length;r++){var n=e.attributes.item(r);t["@attributes"][n.nodeName]=n.nodeValue}}}else 3===e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var a=0;a<e.childNodes.length;a++){var i=e.childNodes.item(a),s=i.nodeName;if(void 0===t[s])t[s]=this.xmlToJson(i);else{if(void 0===t[s].push){var o=t[s];t[s]=[],t[s].push(o)}t[s].push(this.xmlToJson(i))}}return t}}]),e}()},"./node_modules/@babel/runtime/helpers/regeneratorRuntime.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/typeof.js").default;function n(){"use strict";module.exports=n=function(){return t},module.exports.__esModule=!0,module.exports.default=module.exports;var e,t={},a=Object.prototype,i=a.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var a=t&&t.prototype instanceof _?t:_,i=Object.create(a.prototype),o=new M(n||[]);return s(i,"_invoke",{value:x(e,r,o)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var f="suspendedStart",m="suspendedYield",g="executing",y="completed",v={};function _(){}function k(){}function E(){}var b={};d(b,l,(function(){return this}));var T=Object.getPrototypeOf,A=T&&T(T(D([])));A&&A!==a&&i.call(A,l)&&(b=A);var S=E.prototype=_.prototype=Object.create(b);function P(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(a,s,o,l){var u=h(e[a],e,s);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,l)}),(function(e){n("throw",e,o,l)})):t.resolve(d).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,l)}))}l(u.arg)}var a;s(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}})}function x(t,r,n){var a=f;return function(i,s){if(a===g)throw new Error("Generator is already running");if(a===y){if("throw"===i)throw s;return{value:e,done:!0}}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var l=I(o,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=g;var u=h(t,r,n);if("normal"===u.type){if(a=n.done?y:m,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=y,n.method="throw",n.arg=u.arg)}}}function I(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var s=i.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[l];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,s=function r(){for(;++a<t.length;)if(i.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return s.next=s}}throw new TypeError(r(t)+" is not iterable")}return k.prototype=E,s(S,"constructor",{value:E,configurable:!0}),s(E,"constructor",{value:k,configurable:!0}),k.displayName=d(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,d(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},P(C.prototype),d(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var s=new C(p(e,r,n,a),i);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},P(S),d(S,c,"Generator"),d(S,l,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=D,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return o.type="throw",o.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),u=i.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;R(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}module.exports=n,module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/@babel/runtime/helpers/typeof.js":function(module){function e(t){return module.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},module.exports.__esModule=!0,module.exports.default=module.exports,e(t)}module.exports=e,module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/@babel/runtime/regenerator/index.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/regeneratorRuntime.js")();module.exports=r;try{regeneratorRuntime=r}catch(e){"object"===("undefined"==typeof globalThis?"undefined":s(globalThis))?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},"./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js":function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js");function a(e){if(Array.isArray(e))return(0,n.default)(e)}},"./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js":function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js":function(e,t,r){"use strict";function n(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var s=e.apply(t,r);function o(e){n(s,a,i,o,l,"next",e)}function l(e){n(s,a,i,o,l,"throw",e)}o(void 0)}))}}r.r(t),r.d(t,{default:function(){return a}})},"./node_modules/@babel/runtime/helpers/esm/classCallCheck.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/createClass.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,n.default)(a.key),a)}}function i(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}},"./node_modules/@babel/runtime/helpers/esm/defineProperty.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function a(e,t,r){return(t=(0,n.default)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},"./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js":function(e,t,r){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/inherits.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js");function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,n.default)(e,t)}},"./node_modules/@babel/runtime/helpers/esm/iterableToArray.js":function(e,t,r){"use strict";function n(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js":function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js"),a=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js");function i(e,t){if(t&&("object"===(0,n.default)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,a.default)(e)}},"./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js":function(e,t,r){"use strict";function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js"),a=r("./node_modules/@babel/runtime/helpers/esm/iterableToArray.js"),i=r("./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js"),s=r("./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js");function o(e){return(0,n.default)(e)||(0,a.default)(e)||(0,i.default)(e)||(0,s.default)()}},"./node_modules/@babel/runtime/helpers/esm/toPrimitive.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js");function a(e,t){if("object"!==(0,n.default)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!==(0,n.default)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}},"./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js"),a=r("./node_modules/@babel/runtime/helpers/esm/toPrimitive.js");function i(e){var t=(0,a.default)(e,"string");return"symbol"===(0,n.default)(t)?t:String(t)}},"./node_modules/@babel/runtime/helpers/esm/typeof.js":function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js");function a(e,t){if(e){if("string"==typeof e)return(0,n.default)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.default)(e,t):void 0}}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var module=t[n]={exports:{}};return e[n](module,module.exports,r),module.exports}r.n=function(module){var e=module&&module.__esModule?function(){return module.default}:function(){return module};return r.d(e,{a:e}),e},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return function(){"use strict";r.r(n),r.d(n,{NAME:function(){return s},Provider:function(){return e.default},ProviderParser:function(){return t.default},RequestBuilder:function(){return a.default},ResponseTypes:function(){return i},VERSION:function(){return o}});var e=r("./src/k-provider/ovp/provider.ts"),t=r("./src/k-provider/ovp/provider-parser.ts"),a=r("./src/util/request-builder.ts"),i=r("./src/k-provider/ovp/response-types/index.ts"),s="@playkit-js/playkit-js-providers-ovp",o="2.43.2"}(),n}()},"object"===s(e)&&"object"===s(module)?module.exports=i():(n=[],void 0===(a="function"==typeof(r=i)?r.apply(e,n):r)||(module.exports=a))},693:(module,e,t)=>{var r,n,a,i;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}module=t.nmd(module),self,i=function(e){return function(){var t={"./node_modules/@babel/runtime/helpers/arrayLikeToArray.js":function(module){module.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},"./node_modules/@babel/runtime/helpers/arrayWithHoles.js":function(module){module.exports=function(e){if(Array.isArray(e))return e}},"./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/arrayLikeToArray.js");module.exports=function(e){if(Array.isArray(e))return r(e)}},"./node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(module){module.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},"./node_modules/@babel/runtime/helpers/classCallCheck.js":function(module){module.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},"./node_modules/@babel/runtime/helpers/createClass.js":function(module){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}module.exports=function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}},"./node_modules/@babel/runtime/helpers/defineProperty.js":function(module){module.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},"./node_modules/@babel/runtime/helpers/extends.js":function(module){function e(){return module.exports=e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.apply(this,arguments)}module.exports=e},"./node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(module){function e(t){return module.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e(t)}module.exports=e},"./node_modules/@babel/runtime/helpers/inherits.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/setPrototypeOf.js");module.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},"./node_modules/@babel/runtime/helpers/iterableToArray.js":function(module){module.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},"./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js":function(module){module.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}},"./node_modules/@babel/runtime/helpers/nonIterableRest.js":function(module){module.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},"./node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(module){module.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},"./node_modules/@babel/runtime/helpers/objectWithoutProperties.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js");module.exports=function(e,t){if(null==e)return{};var n,a,i=r(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}},"./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js":function(module){module.exports=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}},"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/typeof.js"),n=t("./node_modules/@babel/runtime/helpers/assertThisInitialized.js");module.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?n(e):t}},"./node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(module){function e(t,r){return module.exports=e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e(t,r)}module.exports=e},"./node_modules/@babel/runtime/helpers/slicedToArray.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/arrayWithHoles.js"),n=t("./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js"),a=t("./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js"),i=t("./node_modules/@babel/runtime/helpers/nonIterableRest.js");module.exports=function(e,t){return r(e)||n(e,t)||a(e,t)||i()}},"./node_modules/@babel/runtime/helpers/toConsumableArray.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),n=t("./node_modules/@babel/runtime/helpers/iterableToArray.js"),a=t("./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js"),i=t("./node_modules/@babel/runtime/helpers/nonIterableSpread.js");module.exports=function(e){return r(e)||n(e)||a(e)||i()}},"./node_modules/@babel/runtime/helpers/typeof.js":function(module){function e(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?module.exports=e=function(e){return typeof e}:module.exports=e=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}module.exports=e},"./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/arrayLikeToArray.js");module.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},"./src/components/active-preset/active-preset.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ActivePreset:function(){return S}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/react-redux/es/index.js"),_=r("./src/utils/index.ts"),k=r("./src/reducers/shell.ts"),E=r("./src/utils/logger.ts");function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var S=(0,r("./src/components/event-dispatcher/index.ts").withEventDispatcher)("ActivePreset")(n=(0,v.connect)((function(e){return{state:{shell:e.shell,engine:{adBreak:e.engine.adBreak,isLive:e.engine.isLive,hasError:e.engine.hasError,isIdle:e.engine.isIdle,isVr:e.engine.isVr,isImg:e.engine.isImg,isDocument:e.engine.isDocument,playlist:e.engine.playlist}},config:e.config}}),(0,_.bindActions)(k.actions))((a=function(e){c()(r,e);var t=A(r);function r(){var e;return s()(this,r),e=t.call(this),r.logger=(0,E.default)("ActivePreset"),e}return l()(r,[{key:"getMatchedUI",value:function(e,t){var r,n,a=b(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(void 0===i.condition||i.condition(t)){r=i;break}}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"render",value:function(e){var t,n=this.props,a=n.uis,i=n.state.shell.activePresetName;if(a.length>0){var s=(t=this.getMatchedUI(a,e.state))?t.template(e):a[a.length-1].template(e),o=s&&s.type.displayName||"";return i!==o&&(e.notifyChange({from:i,to:o}),e.updateActivePresetName(o),e.updatePresetSettings(null),r.logger.debug("update active preset to '".concat(i,"' and reset preset settings"))),s}}}]),r}(y.Component),g()(a,"logger",void 0),n=a))||n)||n},"./src/components/active-preset/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ActivePreset:function(){return n.ActivePreset}});var n=r("./src/components/active-preset/active-preset.tsx")},"./src/components/ad-learn-more/ad-learn-more.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLearnMore:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,y.connect)((function(e){return{url:e.engine.adUrl}}))(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"render",value:function(e){return(0,g.h)("a",{href:e.url,target:"_blank",rel:"noreferrer",className:[m().btn,m().btnDarkTransparent,m().learnMore].join(" ")},(0,g.h)(v.Text,{id:"ads.learn_more"}))}}]),r}(g.Component))||n;k.displayName="AdLearnMore"},"./src/components/ad-learn-more/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLearnMore:function(){return n.AdLearnMore}});var n=r("./src/components/ad-learn-more/ad-learn-more.tsx")},"./src/components/ad-left-controls/ad-left-controls.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLeftControls:function(){return v}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./node_modules/react-redux/es/index.js"),g=r("./src/components/ad-notice/index.tsx");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var v=(0,m.connect)((function(e){return{isBumper:e.engine.adIsBumper}}))(n=function(e){u()(r,e);var t=y(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"render",value:function(){return this.props.isBumper?null:(0,f.h)(g.AdNotice,null)}}]),r}(f.Component))||n;v.displayName="AdLeftControls"},"./src/components/ad-left-controls/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLeftControls:function(){return n.AdLeftControls}});var n=r("./src/components/ad-left-controls/ad-left-controls.tsx")},"./src/components/ad-notice/ad-notice.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdNotice:function(){return v}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./src/styles/style.scss"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js"),g=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var v=function(e){l()(r,e);var t=y(r);function r(){return a()(this,r),t.apply(this,arguments)}return s()(r,[{key:"render",value:function(){return(0,m.h)("span",{className:f().adNotice},(0,m.h)(g.Text,{id:"ads.ad_notice"}))}}]),r}(m.Component);v.displayName="AdNotice"},"./src/components/ad-notice/index.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdNotice:function(){return n.AdNotice}});var n=r("./src/components/ad-notice/ad-notice.tsx")},"./src/components/ad-skip/ad-skip.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdSkip:function(){return I}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/react-redux/es/index.js"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./src/components/player/index.ts"),P=r("./src/components/logger/index.ts");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var x="AdSkip",I=(n=(0,T.connect)((function(e){return{currentTime:e.engine.adProgress.currentTime,duration:e.engine.adProgress.duration,adSkipTimeOffset:e.engine.adSkipTimeOffset,adSkippableState:e.engine.adSkippableState}})),a=(0,P.withLogger)(x),n(i=(0,S.withPlayer)(i=a(i=function(e){h()(r,e);var t=C(r);function r(){var e;o()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"skipAd",(function(){var t;null===(t=e.props.player.ads)||void 0===t||t.skipAd()})),e}return u()(r,[{key:"getSkipTimeOffset",value:function(){return Math.ceil(this.props.adSkipTimeOffset-this.props.currentTime)}},{key:"render",value:function(){return this.props.adSkippableState?this.getSkipTimeOffset()<=0?(0,b.h)(A.Localizer,null,(0,b.h)("a",{className:[E().btn,E().btnBranded,E().btnSkipAd].join(" "),onClick:this.skipAd},(0,b.h)(A.Text,{id:"ads.skip_ad"}))):(0,b.h)(A.Localizer,null,(0,b.h)("span",{className:E().skipAd},(0,b.h)(A.Text,{id:"ads.skip_in"})," "+this.getSkipTimeOffset())):void 0}}]),r}(b.Component))||i)||i)||i);I.displayName=x},"./src/components/ad-skip/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdSkip:function(){return n.AdSkip}});var n=r("./src/components/ad-skip/ad-skip.tsx")},"./src/components/advanced-audio-desc-toggle/advanced-audio-desc-toggle.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdvancedAudioDescToggle:function(){return x}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),k=r("./node_modules/react-redux/es/index.js"),E=r("./src/utils/index.ts"),b=r("./src/reducers/settings.ts"),T=r("./src/components/index.ts"),A=r("./src/components/icon/index.ts"),S=r("./src/components/event-dispatcher/index.ts");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var C="AdvancedAudioDescToggle",x=(0,k.connect)((function(e){return{isAdvancedAudioDescChecked:e.settings.advancedAudioDesc}}),(0,E.bindActions)(b.actions))(n=(0,S.withEventDispatcher)(C)(n=(0,_.withText)({advancedAudioText:"settings.advanced_audio_description"})(n=function(e){d()(r,e);var t=P(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"onAdvancedAudioClick",(function(t){e.props.updateAdvancedAudioDesc(t),e.props.notifyClick({type:"AdvancedAudioDescription",checked:t,settings:!0})})),e}return o()(r,[{key:"render",value:function(e){return(0,v.h)(T.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:A.IconType.AdvancedAudioDescription,label:e.advancedAudioText,isChecked:e.isAdvancedAudioDescChecked,onMenuChosen:this.onAdvancedAudioClick})}}]),r}(v.Component))||n)||n)||n;x.displayName=C},"./src/components/advanced-audio-desc-toggle/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdvancedAudioDescToggle:function(){return n.AdvancedAudioDescToggle}});var n=r("./src/components/advanced-audio-desc-toggle/advanced-audio-desc-toggle.tsx")},"./src/components/advanced-audio-desc/advanced-audio-desc.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdvancedAudioDesc:function(){return F}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./src/components/icon/index.ts"),P=r("./src/components/event-dispatcher/index.ts"),C=r("./src/components/tooltip/index.ts"),x=r("./src/components/button/index.ts"),I=r("./node_modules/react-redux/es/index.js"),w=r("./src/components/button-control/index.ts"),R=r("./src/utils/index.ts"),M=r("./src/reducers/settings.ts"),D=r("./src/components/bottom-bar/index.ts"),O=r("./src/index.ts"),L=r("./src/components/player/index.ts");function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var B="AdvancedAudioDesc",F=(n=(0,I.connect)((function(e){var t=e.config,r=e.settings;return{showAdvancedAudioDescToggle:t.settings.showAdvancedAudioDescToggle,advancedAudioDescEnabled:r.advancedAudioDesc}}),(0,R.bindActions)(M.actions)),a=(0,P.withEventDispatcher)(B),i=(0,A.withText)({advancedAudioDescEnabledText:"settings.advanced_audio_description_enabled",advancedAudioDescDisabledText:"settings.advanced_audio_description_disabled"}),n(s=(0,L.withPlayer)(s=a(s=i(s=function(e){f()(r,e);var t=j(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"getComponentText",(function(){return e.advancedAudioDesc?e.props.advancedAudioDescEnabledText:e.props.advancedAudioDescDisabledText})),k()(p()(e),"getSvgIcon",(function(){return{type:O.redux.useStore().getState().settings.advancedAudioDesc?S.IconType.AdvancedAudioDescriptionActive:S.IconType.AdvancedAudioDescription}})),k()(p()(e),"onClick",(function(){var t=!e.advancedAudioDesc;e.props.updateAdvancedAudioDesc(t),e.props.notifyClick({type:"AdvancedAudioDescription",checked:t,settings:!1})})),k()(p()(e),"onKeyDown",(function(t){[R.KeyCode.Enter,R.KeyCode.Space].includes(t.code)&&(t.preventDefault(),e.onClick())})),e}return c()(r,[{key:"componentDidUpdate",value:function(e){var t=this;this.props.showAdvancedAudioDescToggle&&!e.showAdvancedAudioDescToggle&&(0,D.registerToBottomBar)(B,this.props.player,(function(){return t.registerComponent()}))}},{key:"registerComponent",value:function(){var e=this;return{ariaLabel:function(){return e.getComponentText()},displayName:B,order:5,svgIcon:function(){return e.getSvgIcon()},onClick:function(){return e.onClick()},component:function(){return V(U(U({},e.props),{},{classNames:[b().upperBarIcon]}))},shouldHandleOnClick:!1}}},{key:"_shouldRender",value:function(){return this.props.showAdvancedAudioDescToggle}},{key:"render",value:function(e){var t,r=e.innerRef;return this._shouldRender()?(0,T.h)(w.ButtonControl,{name:B,className:[b().noIdleControl,this.props.classNames?this.props.classNames.join(" "):""].join(" ")},(0,T.h)(C.Tooltip,{label:this.getComponentText(),type:(null===(t=this.props.classNames)||void 0===t?void 0:t.includes(b().upperBarIcon))?"bottom-left":"top",strictPosition:!0},(0,T.h)(x.Button,{tabIndex:"0","aria-label":this.getComponentText(),className:"".concat(b().controlButton),ref:r,onClick:this.onClick,onKeyDown:this.onKeyDown},(0,T.h)(S.Icon,{type:this.props.advancedAudioDescEnabled?S.IconType.AdvancedAudioDescriptionActive:S.IconType.AdvancedAudioDescription})))):void 0}},{key:"advancedAudioDesc",get:function(){return O.redux.useStore().getState().settings.advancedAudioDesc}}]),r}(T.Component))||s)||s)||s)||s),V=function(e){return(0,T.h)(F,e)};F.displayName=B},"./src/components/advanced-audio-desc/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdvancedAudioDesc:function(){return n.AdvancedAudioDesc}});var n=r("./src/components/advanced-audio-desc/advanced-audio-desc.tsx")},"./src/components/audio-entry-details/audio-entry-details.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioEntryDetails:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./src/styles/style.scss"),s=r.n(i),o=r("./node_modules/react-redux/es/index.js"),l=r("./node_modules/preact/dist/preact.module.js"),u=r("./node_modules/preact/hooks/dist/hooks.module.js"),c=r("./src/components/shell/shell.tsx"),d=r("./src/components/player/index.ts"),p=r("./src/components/expandable-text/index.ts"),h=r("./src/components/scrollable/index.ts"),f=r("./src/event/index.ts"),m=(0,o.connect)((function(e){return{isAudio:e.engine.isAudio,playerSize:e.shell.playerSize}}))((0,f.withEventManager)((0,d.withPlayer)((function(e){var t,r,n,i=function(e){return g.parseFromString(e,"text/html").body.textContent||""},o=(0,u.useRef)(null),d=(0,u.useRef)(null),f=(0,u.useState)(null),m=a()(f,2),g=m[0],y=m[1],v=(0,u.useState)(!1),_=a()(v,2),k=_[0],E=_[1],b=(0,u.useState)(!1),T=a()(b,2),A=T[0],S=T[1],P=(0,u.useState)(!1),C=a()(P,2),x=C[0],I=C[1],w=(0,u.useState)(!1),R=a()(w,2),M=R[0],D=R[1];if((0,u.useLayoutEffect)((function(){var e,t,r,n;(null==o?void 0:o.current)&&(null==d?void 0:d.current)&&(S(!0),I((null==o||null===(e=o.current)||void 0===e?void 0:e.getBoundingClientRect().height)>(null==d||null===(t=d.current)||void 0===t?void 0:t.getBoundingClientRect().height))),M||D((null==o||null===(r=o.current)||void 0===r?void 0:r.getBoundingClientRect().height)>(null==d||null===(n=d.current)||void 0===n?void 0:n.getBoundingClientRect().height))})),(0,u.useLayoutEffect)((function(){e.eventManager.listen(e.player,e.player.Event.CHANGE_SOURCE_STARTED,(function(){E(!1)})),e.eventManager.listen(e.player,e.player.Event.CHANGE_SOURCE_ENDED,(function(){E(!0)})),y(new DOMParser)}),[]),!k||!e.isAudio||!(null===(t=e.player.sources)||void 0===t||null===(r=t.metadata)||void 0===r?void 0:r.name)&&!(null===(n=e.player.sources)||void 0===n?void 0:n.metadata.description))return null;var O=e.player.sources.metadata,L=O.name,N=void 0===L?"":L,U=O.description,j=void 0===U?"":U;N=i(N),j=i(j);var B=function(e){switch(e){case c.PLAYER_SIZE.EXTRA_LARGE:case c.PLAYER_SIZE.LARGE:return s().audioEntryL;case c.PLAYER_SIZE.MEDIUM:return s().audioEntryM;default:return s().audioEntryT}}(e.playerSize),F="".concat(s().audioEntryTitle," ").concat(x?s().audioEntryTitleTrimmed:""),V=x?"":s().audioEntryExpanded;return(0,l.h)("div",{className:"".concat(s().audioEntryBackdrop," ").concat(V)},(0,l.h)("div",{className:"".concat(s().audioEntryDetails," ").concat(B)},(0,l.h)(h.Scrollable,{isVertical:!0},(0,l.h)("div",{className:s().audioEntryContent},(0,l.h)("div",{ref:o,className:F},N),A?void 0:(0,l.h)("div",{ref:d,className:"".concat(s().audioEntryTitle," ").concat(s().audioEntryTitleTrimmed)},N),(0,l.h)("div",{className:s().audioEntryDescription},(0,l.h)(p.ExpandableText,{text:j,lines:3,onClick:function(){I(!x)},forceShowMore:M},j))))))}))));m.displayName="AudioEntryDetails"},"./src/components/audio-entry-details/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioEntryDetails:function(){return n.AudioEntryDetails}});var n=r("./src/components/audio-entry-details/audio-entry-details.tsx")},"./src/components/audio-menu/audio-menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioMenu:function(){return x}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/utils/index.ts"),E=r("./src/reducers/settings.ts"),b=r("./src/components/index.ts"),T=r("./src/components/icon/index.ts"),A=r("./src/components/player/index.ts"),S=r("./src/components/event-dispatcher/index.ts");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var C="AudioMenu",x=(n=(0,_.connect)((function(e){return{audioTracks:e.engine.audioTracks}}),(0,k.bindActions)(E.actions)),a=(0,S.withEventDispatcher)(C),i=(0,v.withText)({audioLabelText:"settings.audio"}),n(s=(0,A.withPlayer)(s=a(s=i(s=function(e){p()(r,e);var t=P(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"onAudioChange",value:function(e){this.props.updateAudio(e),this.props.player.selectTrack(e),this.props.notifyClick({type:this.props.player.Track.AUDIO,track:e})}},{key:"render",value:function(e){var t=this,r=e.audioTracks.filter((function(e){return e.label||e.language})).map((function(e){return{label:e.label||e.language,active:e.active,value:e}}));return(0,y.h)(b.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:T.IconType.Audio,label:this.props.audioLabelText,options:r,onMenuChosen:function(e){return t.onAudioChange(e)}})}}]),r}(y.Component))||s)||s)||s)||s);x.displayName=C},"./src/components/audio-menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioMenu:function(){return n.AudioMenu}});var n=r("./src/components/audio-menu/audio-menu.tsx")},"./src/components/base.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{BaseComponent:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./src/utils/logger.ts"),_=r("./src/middlewares/event-dispatcher.ts"),k=r("@playkit-js/playkit-js");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var b=function(e){c()(r,e);var t=E(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{config:{}};return a()(this,r),e=t.call(this),g()(l()(e),"player",void 0),g()(l()(e),"name",void 0),g()(l()(e),"config",void 0),g()(l()(e),"logger",void 0),g()(l()(e),"eventManager",void 0),e.name=n.name,e.config=n.config,e.player=n.player,e.eventManager=new k.EventManager,e.logger=(0,v.default)("UI ".concat(e.name)),e.logger.debug("Initialized"),e}return s()(r,[{key:"notifyClick",value:function(e){this.context.store.dispatch({type:_.types.COMPONENT_CLICKED,name:this.name,payload:e})}},{key:"notifyChange",value:function(e){this.context.store.dispatch({type:_.types.COMPONENT_CHANGED,name:this.name,payload:e})}},{key:"componentWillUnmount",value:function(){this.eventManager.removeAll()}},{key:"render",value:function(e,t,r){}}]),r}(y.Component);g()(b,"defaultProps",{}),t.default=b},"./src/components/bottom-bar/bottom-bar-registry-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BottomBarRegistryManager:function(){return u},bottomBarRegistryManager:function(){return c},registerToBottomBar:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),l=r.n(o),u=function(){function e(){a()(this,e),l()(this,"_registry",void 0),this._registry=new Map}return s()(e,[{key:"register",value:function(e,t){this.getComponentItem(e)||this._registry.set(e,t)}},{key:"unregister",value:function(e){this.getComponentItem(e)&&this._registry.delete(e)}},{key:"getComponentItem",value:function(e){return this._registry.get(e)}},{key:"clear",value:function(){this._registry.clear()}}]),e}(),c="bottomBarRegistryManager",d=function(e,t,r){var n=(null==t?void 0:t.getService(c))||void 0;n&&!n.getComponentItem(e)&&n.register(e,r())}},"./src/components/bottom-bar/bottom-bar-utils.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{filterControlsByPriority:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=r.n(n);function i(e,t,r,n){var i=Math.ceil((e-t)/r)||1,s=n.flat().slice(0,i),o=a()(n).reverse().find((function(e){return e.length>1}));return s[s.length-1]===(null==o?void 0:o[0])&&s.push(o[1]),s}},"./src/components/bottom-bar/bottom-bar.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{BottomBar:function(){return j}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./src/utils/bind-actions.ts"),T=r("./src/reducers/shell.ts"),A=r("./src/reducers/bottom-bar.ts"),S=r("./node_modules/react-redux/es/index.js"),P=r("./src/components/player-area/index.ts"),C=r("./src/components/index.ts"),x=r("./src/event/index.ts"),I=r("./src/components/player/index.ts"),w=r("./src/components/bottom-bar/bottom-bar-utils.ts"),R=r("./src/components/bottom-bar/bottom-bar-registry-manager.ts"),M=r("./src/event/events/bottom-bar-client-rect-event.ts");function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=[["PictureInPicture"],["VrStereo"],["TimeDisplayPlaybackContainer"],["AdvancedAudioDesc"],["ClosedCaptions"],["CaptionsControl"],["Cast"]],U="TimeDisplayPlaybackContainer",j=(n=(0,S.connect)((function(e){return{isCasting:e.engine.isCasting,isPlaybackEnded:e.engine.isPlaybackEnded,guiClientRect:e.shell.guiClientRect,playerSize:e.shell.playerSize,playlist:e.engine.playlist}}),(0,b.bindActions)(L(L({},T.actions),A.actions))),(0,I.withPlayer)(a=(0,x.withEventManager)(a=n(a=function(e){p()(r,e);var t=D(r);function r(e){var n;s()(this,r),n=t.call(this),v()(c()(n),"bottomBarContainerRef",(0,E.createRef)()),v()(c()(n),"presetControls",{}),v()(c()(n),"resizeObserver",void 0),v()(c()(n),"_currBarWidthArr",[0,0]),v()(c()(n),"_maxControlsWidthArr",[0,0]),v()(c()(n),"_isFullscreenModeChanging",!1),v()(c()(n),"_getControlsWidth",(function(){return Array.from(n.bottomBarContainerRef.current.childNodes).reduce((function(e,t){return e+t.offsetWidth}),0)})),v()(c()(n),"onToggleControl",(function(e,t){e in n.state.activeControls&&n.state.activeControls[e]!==t&&n.setState((function(r){return{activeControls:L(L({},r.activeControls),v()({},e,t))}}))})),v()(c()(n),"toggleObserver",(function(e){e?n.resizeObserver.disconnect():n.resizeObserver.observe(n.bottomBarContainerRef.current)})),e.leftControls=e.leftControls||[],e.rightControls=e.rightControls||[],e.leftControls.concat(e.rightControls).map((function(e){return e.displayName})).forEach((function(e){return n.presetControls[e]=!0})),n.state={fitInControls:n.presetControls,activeControls:n.presetControls},e.player.registerService(R.bottomBarRegistryManager,new R.BottomBarRegistryManager);var a=null,i=function(){n._isFullscreenModeChanging=!0,a&&clearTimeout(a),a=setTimeout((function(){n._isFullscreenModeChanging=!1,n.onBarWidthChange(!0),a=null}),100)};return e.eventManager.listen(e.player,e.player.Event.Core.ENTER_FULLSCREEN,i),e.eventManager.listen(e.player,e.player.Event.Core.EXIT_FULLSCREEN,i),n}return l()(r,[{key:"componentDidMount",value:function(){var e=this;this.resizeObserver=new ResizeObserver((function(){return e.onBarWidthChange(!1)})),this.resizeObserver.observe(this.bottomBarContainerRef.current)}},{key:"componentWillUnmount",value:function(){this.resizeObserver.disconnect(),this._currBarWidthArr=[0,0],this._maxControlsWidthArr=[0,0],this._isFullscreenModeChanging=!1}},{key:"onBarWidthChange",value:function(e){var t,r=this;if(!this._isFullscreenModeChanging){var n=this.props.player,a=(null===(t=this.bottomBarContainerRef.current)||void 0===t?void 0:t.offsetWidth)||0,i=this._getControlsWidth();if(this.setMaxControlsWidth(n.isFullscreen(),Math.max(this.getMaxControlsWidth(n.isFullscreen()),i)),e||a!==this.getCurrentBarWidth(n.isFullscreen())){n.dispatchEvent(new M.BottomBarClientRectEvent),this.setCurrentBarWidth(n.isFullscreen(),a);var s=this.props.guiClientRect.width<=C.PLAYER_BREAK_POINTS.SMALL?38:44,o=N.filter((function(e){return r.state.activeControls[e[0]]}));this.filterControls(a,this.getMaxControlsWidth(n.isFullscreen()),s,o)}}}},{key:"getMaxControlsWidth",value:function(e){return this._maxControlsWidthArr[Number(e)]}},{key:"setMaxControlsWidth",value:function(e,t){this._maxControlsWidthArr[Number(e)]=t}},{key:"getCurrentBarWidth",value:function(e){return this._currBarWidthArr[Number(e)]}},{key:"setCurrentBarWidth",value:function(e,t){this._currBarWidthArr[Number(e)]=t}},{key:"filterControls",value:function(e,t,r,n){if(t>=e){var a=(0,w.filterControlsByPriority)(t,e,r,n),i={};a.forEach((function(e){return i[e]=!1})),this.props.updateControlsToMove(a),this.setState({fitInControls:L(L({},this.presetControls),i)})}else this.setState({fitInControls:L({},this.presetControls)}),this.props.updateControlsToMove([])}},{key:"render",value:function(e){var t=this,r=[k().bottomBar];e.isCasting&&e.isPlaybackEnded&&r.push(k().hide);var n=this.presetControls[U]&&!this.state.fitInControls[U];return(0,E.h)("div",{className:r.join(" ")},(0,E.h)("div",{className:k().bottomBarArea},(0,E.h)(P.PlayerArea,{shouldUpdate:!0,name:"BottomBar"},n&&(0,E.h)(C.TimeDisplayPlaybackContainer,null),e.children)),(0,E.h)("div",{ref:this.bottomBarContainerRef,className:k().controlsContainer},(0,E.h)("div",{className:k().leftControls},(0,E.h)(P.PlayerArea,{shouldUpdate:!0,name:"BottomBarLeftControls"},e.leftControls&&e.leftControls.map((function(e){return t.presetControls[e.displayName]&&t.state.fitInControls[e.displayName]&&(0,E.h)(e,{key:e.displayName,onToggle:t.onToggleControl,toggleObserver:t.toggleObserver})})))),(0,E.h)(P.PlayerArea,{shouldUpdate:!0,name:"BottomBarCenterControls"}),(0,E.h)("div",{className:k().rightControls},(0,E.h)(P.PlayerArea,{shouldUpdate:!0,name:"BottomBarRightControls"},e.rightControls&&e.rightControls.map((function(e){return t.presetControls[e.displayName]&&t.state.fitInControls[e.displayName]&&(0,E.h)(e,{key:e.displayName,onToggle:t.onToggleControl,toggleObserver:t.toggleObserver})}))))))}}]),r}(E.Component))||a)||a)||a);j.displayName="BottomBar"},"./src/components/bottom-bar/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BottomBar:function(){return n.BottomBar},BottomBarRegistryManager:function(){return a.BottomBarRegistryManager},bottomBarRegistryManager:function(){return a.bottomBarRegistryManager},registerToBottomBar:function(){return a.registerToBottomBar}});var n=r("./src/components/bottom-bar/bottom-bar.tsx"),a=r("./src/components/bottom-bar/bottom-bar-registry-manager.ts")},"./src/components/button-control/button-control.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ButtonControl:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),s=r.n(i),o=r("./node_modules/preact/dist/preact.module.js"),l=r("./src/styles/style.scss"),u=r.n(l),c=(0,r("./node_modules/preact/compat/dist/compat.module.js").forwardRef)((function(e,t){var r=e.className,n=e.children,i=e.name,l=s()(e,["className","children","name"]),c=[u().controlButtonContainer,"".concat("playkit","-control-").concat(d(i))];if(r){var p=Array.isArray(r)?r:[r];c=c.concat(p)}return(0,o.h)("div",a()({className:c.join(" "),ref:t},l),n)})),d=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase()}},"./src/components/button-control/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ButtonControl:function(){return n.ButtonControl}});var n=r("./src/components/button-control/button-control.tsx")},"./src/components/button/button.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Button:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/preact/dist/preact.module.js"),s=(0,r("./node_modules/preact/compat/dist/compat.module.js").forwardRef)((function(e,t){return(0,i.h)("button",a()({type:"button",ref:t},e))}));s.displayName="Button"},"./src/components/button/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Button:function(){return n.Button}});var n=r("./src/components/button/button.tsx")},"./src/components/captions-control/captions-control-mini.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsControlMini:function(){return T}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/preact/compat/dist/compat.module.js"),s=r("./src/components/bottom-bar/index.ts"),o=r("./src/index.ts"),l=r("./src/components/icon/index.ts"),u=r("./node_modules/preact/dist/preact.module.js"),c=r("./src/components/button-control/index.ts"),d=r("./src/components/tooltip/index.ts"),p=r("./src/components/button/index.ts"),h=r("./src/components/cvaa-overlay/index.ts"),f=r("./node_modules/preact/hooks/dist/hooks.module.js"),m=r("./node_modules/react-redux/es/index.js"),g=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),y=r("./src/components/captions-menu/index.ts"),v=r("./src/components/smart-container/index.ts"),_=r("./src/components/captions-control/captions-control.tsx"),k=r("./src/components/overlay-portal/index.ts"),E=r("./src/utils/key-map.ts"),b="CaptionsControlMini",T=(0,m.connect)((function(e){return{controlsToMove:e.bottomBar.controlsToMove,isCaptionsEnabled:e.settings.isCaptionsEnabled}}))((function(e,t){var r=(0,f.useState)(!1),n=a()(r,2),m=n[0],T=n[1],S=t.player,P=e.controlsToMove,C=null;(0,f.useEffect)((function(){(0,s.registerToBottomBar)(_.CaptionsControl.displayName,S,(function(){return x()}))}),[]);var x=function(){return{ariaLabel:e.captionsLabelText,displayName:b,order:5,svgIcon:{type:l.IconType.ClosedCaptionsOn},onClick:function(){return R()},component:function(){return A(e)},shouldHandleOnClick:!1}};(0,f.useEffect)((function(){T(P.includes(_.CaptionsControl.displayName))}),[P]);var I=function(){C&&(C(),C=null)},w=function(){I(),C=S.ui.addComponent({label:"cvaa-overlay",area:"GuiArea",presets:[o.ReservedPresetNames.Playback,o.ReservedPresetNames.Live],get:function(){return(0,i.createPortal)((0,u.h)(h.CVAAOverlay,{onClose:function(){return I()}}),(0,k.getOverlayPortalElement)(S))}})},R=function(){C=S.ui.addComponent({label:"captions-overlay",area:"GuiArea",presets:[o.ReservedPresetNames.Playback,o.ReservedPresetNames.Live],get:function(){return(0,u.h)(v.SmartContainer,{targetId:S.config.targetId,onClose:function(){return I()},title:(0,u.h)(g.Text,{id:"controls.language"})},(0,u.h)(y.CaptionsMenu,{asDropdown:!1,onAdvancedCaptionsClick:w}))}})};return m?(0,u.h)(c.ButtonControl,{name:b,className:o.style.upperBarIcon},(0,u.h)(d.Tooltip,{label:e.captionsLabelText},(0,u.h)(p.Button,{tabIndex:"0","aria-label":e.captionsLabelText,"aria-haspopup":"true",className:o.style.controlButton,onClick:R,onKeyDown:function(e){((0,E.isEnter)(e)||(0,E.isSpace)(e))&&(e.preventDefault(),R())}},(0,u.h)(l.Icon,{type:e.isCaptionsEnabled?l.IconType.ClosedCaptionsOn:l.IconType.ClosedCaptionsOff})))):void 0})),A=function(e){return(0,u.h)(T,e)};T.displayName=b},"./src/components/captions-control/captions-control.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsControl:function(){return A}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/preact/dist/preact.module.js"),s=r("./node_modules/react-redux/es/index.js"),o=r("./src/components/captions-menu/index.ts"),l=r("./src/components/button-control/index.ts"),u=r("./src/components/tooltip/index.ts"),c=r("./src/components/button/index.ts"),d=r("./src/styles/style.scss"),p=r.n(d),h=r("./src/components/icon/index.ts"),f=r("./src/components/smart-container/index.ts"),m=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),g=r("./node_modules/preact/hooks/dist/hooks.module.js"),y=r("./src/utils/index.ts"),v=r("./node_modules/preact/compat/dist/compat.module.js"),_=r("./src/components/cvaa-overlay/index.ts"),k=r("./src/components/captions-control/captions-control-mini.tsx"),E=r("./src/components/overlay-portal/index.ts"),b=r("./src/utils/key-map.ts"),T="CaptionsControl",A=(0,s.connect)((function(e){return{textTracks:e.engine.textTracks,showCCButton:e.config.showCCButton,openMenuFromCCButton:e.config.openMenuFromCCButton,isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,isCVAAOverlayOpen:e.shell.isCVAAOverlayOpen,isCaptionsEnabled:e.settings.isCaptionsEnabled}}))((0,m.withText)({captionsLabelText:"captions.captions"})((function(e,t){var r,n=(0,g.useState)(!1),s=a()(n,2),d=s[0],A=s[1],S=(0,g.useState)(!1),P=a()(S,2),C=P[0],x=P[1],I=(0,g.useState)(!1),w=a()(I,2),R=w[0],M=w[1],D=(0,g.useRef)(null),O=(0,g.useRef)(null),L=t.player,N=e.isSmallSize,U=e.isMobile,j=e.textTracks,B=j.find((function(e){return e.active})),F=function(e,t){A((function(e){return!e})),t&&d&&(0,y.focusElement)(D.current)},V=function(){e.toggleObserver(!C),x((function(e){return!e}))},G=function(e){U||N||!O.current||O.current.contains(e.target)||A(!1)};(0,g.useEffect)((function(){return document.addEventListener("click",G),function(){return document.removeEventListener("click",G)}}),[N,U]),(0,g.useEffect)((function(){M("off"!==(null==B?void 0:B.language))}),[B]),(0,g.useEffect)((function(){M(e.isCaptionsEnabled)}),[e.isCaptionsEnabled]);var H=!!(null==j?void 0:j.length)&&e.showCCButton&&e.openMenuFromCCButton;if(e.onToggle(T,H),H)return(0,i.h)(i.Fragment,null,(0,i.h)(l.ButtonControl,{name:T,ref:O},(0,i.h)(u.Tooltip,{label:e.captionsLabelText,type:(null===(r=e.classNames)||void 0===r?void 0:r.includes(p().upperBarIcon))?"bottom-left":"top",strictPosition:!0},(0,i.h)(c.Button,{ref:D,tabIndex:"0","aria-label":e.captionsLabelText,"aria-haspopup":"true",className:[p().controlButton,d?p().active:""].join(" "),onClick:F,onKeyDown:function(e){((0,b.isEnter)(e)||(0,b.isSpace)(e))&&(e.preventDefault(),F(0,!0))}},(0,i.h)(h.Icon,{type:R?h.IconType.ClosedCaptionsOn:h.IconType.ClosedCaptionsOff}))),d&&!C&&(0,i.h)(f.SmartContainer,{targetId:L.config.targetId,onClose:function(){return A(!1)},title:(0,i.h)(m.Text,{id:"controls.language"})},(0,i.h)(o.CaptionsMenu,{asDropdown:!1,onAdvancedCaptionsClick:V})),C?(0,v.createPortal)((0,i.h)(_.CVAAOverlay,{onClose:function(e,t){V(),F(0,t)}}),(0,E.getOverlayPortalElement)(L)):(0,i.h)("div",null)),(0,i.h)(k.CaptionsControlMini,e))})));A.displayName=T},"./src/components/captions-control/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsControl:function(){return n.CaptionsControl}});var n=r("./src/components/captions-control/captions-control.tsx")},"./src/components/captions-menu/captions-menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsMenu:function(){return G}});var n,a,i,s,o,l,u=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/typeof.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/createClass.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/inherits.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./node_modules/react-redux/es/index.js"),P=r("./src/utils/index.ts"),C=r("./src/reducers/cvaa.ts"),x=r("./src/index.ts"),I=r("./src/components/smart-container/smart-container-item.tsx"),w=r("./src/components/icon/index.ts"),R=r("./src/components/player/index.ts"),M=r("./src/event/index.ts"),D=r("./src/components/logger/index.ts"),O=r("./src/components/event-dispatcher/index.ts"),L=r("./src/components/keyboard/index.ts"),N=r("./src/components/menu/index.ts"),U=r("./src/reducers/settings.ts");function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var a=b()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return k()(this,r)}}var V="CaptionsMenu",G=(n=(0,S.connect)((function(e){return{textTracks:e.engine.textTracks,isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,showAdvancedCaptionsMenu:e.config.settings.showAdvancedCaptionsMenu}}),(0,P.bindActions)(C.actions)),a=(0,L.withKeyboardEvent)(V),i=(0,D.withLogger)(V),s=(0,O.withEventDispatcher)(V),o=(0,A.withText)({captionsLabelText:"captions.captions",advancedCaptionsSettingsText:"captions.advanced_captions_settings"}),n(l=(0,R.withPlayer)(l=(0,M.withEventManager)(l=a(l=i(l=s(l=o(l=function(e){v()(r,e);var t=F(r);function r(){return f()(this,r),t.apply(this,arguments)}return g()(r,[{key:"onCaptionsChange",value:function(e){if(e!==this.props.advancedCaptionsSettingsText){this.props.player.selectTrack(e);var t="object"===p()(e)&&"off"!==e.language;x.redux.useStore().dispatch({type:U.types.UPDATE_IS_CAPTIONS_ENABLED,isCaptionsEnabled:t}),this.props.notifyClick({type:this.props.player.Track.TEXT,track:e})}else this.props.onAdvancedCaptionsClick()}},{key:"render",value:function(e){var t=this,r=e.textTracks.map((function(e){return{label:e.label||e.language,active:e.active,value:e}})).map((function(e){return B(B({},e),{},{label:e.label.charAt(0).toUpperCase()+e.label.slice(1)})})).sort((function(e,t){return e.label>t.label||"Off"===e.label?1:-1})),n=e.showAdvancedCaptionsMenu?[{label:e.advancedCaptionsSettingsText,value:e.advancedCaptionsSettingsText,active:!1,isAdvanced:!0}]:[];return this.props.asDropdown?(0,T.h)(I.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:w.IconType.Captions,label:this.props.captionsLabelText,options:r,onMenuChosen:function(e){return t.onCaptionsChange(e)},additionalOptions:n}):(0,T.h)(N.Menu,{pushRef:function(r){t.props.addAccessibleChild(r),e.pushRef(r)},options:r,onMenuChosen:function(e){return t.onCaptionsChange(e)},onClose:function(){},additionalOptions:n})}}]),r}(T.Component))||l)||l)||l)||l)||l)||l)||l);G.displayName=V},"./src/components/captions-menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsMenu:function(){return n.CaptionsMenu}});var n=r("./src/components/captions-menu/captions-menu.tsx")},"./src/components/cast-on-tv/cast-after-play.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CastAfterPlay:function(){return M}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/components/icon/index.ts"),P=r("./src/components/icon/icon.tsx"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),x=r("./src/components/player/index.ts"),I=r("./src/components/logger/index.ts");function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var R="CastAfterPlay",M=(n=(0,A.connect)((function(e){return{isPlaybackEnded:e.engine.isPlaybackEnded,isCasting:e.engine.isCasting}}),null),a=(0,I.withLogger)(R),n(i=(0,x.withPlayer)(i=a((s=function(e){f()(r,e);var t=w(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_timeoutId",null),k()(p()(e),"onClick",(function(t){t.stopPropagation(),e.props.player.stopCasting()})),e}return c()(r,[{key:"componentDidMount",value:function(){var e=this;this._timeoutId=setTimeout((function(){e.setState({show:!0})}),700)}},{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}},{key:"render",value:function(e){if(e.isCasting&&e.isPlaybackEnded){var t=[b().castOnTvButtonContainer];return this.state.show&&t.push(b().showCastOnTv),(0,T.h)("div",null,(0,T.h)("div",{className:t.join(" "),onClick:this.onClick},(0,T.h)("a",{className:[b().btn,b().btnDarkTransparent,b().castOnTvButton].join(" ")},(0,T.h)("div",{className:b().castOnTvIconContainer},(0,T.h)(P.Icon,{type:e.icon})),(0,T.h)(C.Localizer,null,(0,T.h)("span",null,(0,T.h)(C.Text,{id:"cast.disconnect_from_tv"}))))))}}}]),r}(T.Component),k()(s,"defaultProps",{icon:S.IconType.CastBrand}),i=s))||i)||i)||i);M.displayName=R},"./src/components/cast-on-tv/cast-before-play.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CastBeforePlay:function(){return L}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/components/icon/index.ts"),P=r("./src/components/icon/icon.tsx"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),x=r("./src/components/player/index.ts"),I=r("./src/components/logger/index.ts"),w=r("./src/components/button/index.ts"),R=r("./src/components/cast/index.ts"),M=r("./src/utils/index.ts");function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var O="CastBeforePlay",L=(n=(0,A.connect)((function(e){return{isPlaybackEnded:e.engine.isPlaybackEnded,prePlayback:e.engine.prePlayback,loading:e.loading.show,isCastAvailable:e.engine.isCastAvailable}})),a=(0,I.withLogger)(O),n(i=(0,x.withPlayer)(i=a((s=function(e){f()(r,e);var t=D(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_timeoutId",null),k()(p()(e),"onClick",(function(){e.props.player.startCasting(R.RemotePlayerType.CHROMECAST)})),k()(p()(e),"_handleKeydown",(function(t){t.keyCode!==M.KeyMap.ENTER&&t.keyCode!==M.KeyMap.SPACE||(t.preventDefault(),e.onClick())})),e}return c()(r,[{key:"componentDidMount",value:function(){var e=this;this._timeoutId=setTimeout((function(){e.setState({show:!0})}),700)}},{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}},{key:"render",value:function(e){if(e.isCastAvailable&&!e.loading&&e.prePlayback){var t=[b().castOnTvButtonContainer];return this.state.show&&t.push(b().showCastOnTv),(0,T.h)("div",{className:t.join(" ")},(0,T.h)(C.Localizer,null,(0,T.h)(w.Button,{tabIndex:"0","aria-label":(0,T.h)(C.Text,{id:"cast.play_on_tv"}),onClick:this.onClick,onKeyDown:this._handleKeydown,className:[b().btn,b().btnDarkTransparent,b().castOnTvButton].join(" ")},(0,T.h)("div",{className:b().castOnTvIconContainer},(0,T.h)(P.Icon,{type:e.icon})),(0,T.h)("span",null,(0,T.h)(C.Text,{id:"cast.play_on_tv"})))))}}}]),r}(T.Component),k()(s,"defaultProps",{icon:S.IconType.Cast}),i=s))||i)||i)||i);L.displayName=O},"./src/components/cast-on-tv/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CastAfterPlay:function(){return a.CastAfterPlay},CastBeforePlay:function(){return n.CastBeforePlay}});var n=r("./src/components/cast-on-tv/cast-before-play.tsx"),a=r("./src/components/cast-on-tv/cast-after-play.tsx")},"./src/components/cast-overlay/cast-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CastOverlay:function(){return C}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./src/styles/style.scss"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./node_modules/react-redux/es/index.js"),E=r("./src/components/icon/index.ts"),b=r("./src/components/icon/icon.tsx"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./src/components/logger/index.ts");function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var P="CastOverlay",C=(0,k.connect)((function(e){return{poster:e.engine.poster,castSession:e.engine.castSession,isIdle:e.engine.isIdle,isPlaying:e.engine.isPlaying,isPlaybackEnded:e.engine.isPlaybackEnded,isPaused:e.engine.isPaused,isChangingSource:e.engine.isChangingSource}}))(n=(0,A.withLogger)(P)((a=function(e){c()(r,e);var t=S(r);function r(){return s()(this,r),t.apply(this,arguments)}return l()(r,[{key:"getStatus",value:function(){return this.props.isPlaying||this.props.isPaused?(0,_.h)(T.Text,{id:"cast.status.playing_on"}):this.props.isPlaybackEnded||this.props.isChangingSource||this.props.castSession.resuming?(0,_.h)(T.Text,{id:"cast.status.connected_to"}):(0,_.h)(T.Text,{id:"cast.status.connecting_to"})}},{key:"getIcon",value:function(){return this.props.isPlaying||this.props.isPaused||this.props.isPlaybackEnded||this.props.isChangingSource||this.props.castSession.resuming?(0,_.h)(b.Icon,{type:this.props.icon}):(0,_.h)("div",{className:v().castConnectingSpinner})}},{key:"render",value:function(e){if(e.castSession){var t={},r=[v().castPoster];e.poster&&(t={backgroundImage:e.isChangingSource?"":"url(".concat(e.poster,")"),backgroundSize:"contain"},r.push(v().hasPoster));var n=this.getStatus(),a=this.getIcon();return(0,_.h)("div",null,(0,_.h)("div",{className:v().castOverlay},(0,_.h)("div",{className:r.join(" "),style:t,onMouseOver:function(e){return e.stopPropagation()}}),(0,_.h)("div",{className:v().castBlackCover})),(0,_.h)("div",{className:v().castBox},(0,_.h)("div",{className:v().castIcon},a),(0,_.h)("div",{className:v().castText},(0,_.h)(T.Localizer,null,(0,_.h)("span",{className:v().castStatus},n)),(0,_.h)("br",null),(0,_.h)("span",{className:v().castDevice},e.castSession.deviceFriendlyName))))}}}]),r}(_.Component),g()(a,"defaultProps",{icon:E.IconType.Cast}),n=a))||n)||n;C.displayName=P},"./src/components/cast-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CastOverlay:function(){return n.CastOverlay}});var n=r("./src/components/cast-overlay/cast-overlay.tsx")},"./src/components/cast/cast.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Cast:function(){return O}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/index.ts"),P=r("./src/components/player/index.ts"),C=r("./src/event/index.ts"),x=r("./src/components/logger/index.ts"),I=r("./src/components/tooltip/index.ts"),w=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),R=r("./src/components/cast/remote-player-type.ts");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var D="Cast",O=(n=(0,A.connect)((function(e){return{isCasting:e.engine.isCasting,isCastAvailable:e.engine.isCastAvailable}})),a=(0,x.withLogger)(D),i=(0,w.withText)({castText:"cast.play_on_tv"}),n(s=(0,P.withPlayer)(s=(0,C.withEventManager)(s=a(s=i(s=function(e){f()(r,e);var t=M(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"onClick",(function(){e.props.player.setIsCastInitiator(R.RemotePlayerType.CHROMECAST,!0),e.props.eventManager.listenOnce(e.props.player,e.props.player.Event.Cast.CAST_SESSION_START_FAILED,(function(){return e.props.player.setIsCastInitiator(R.RemotePlayerType.CHROMECAST,!1)}))})),k()(p()(e),"onKeyDown",(function(t){t.keyCode!==S.KeyMap.ENTER&&t.keyCode!==S.KeyMap.SPACE||(t.preventDefault(),e.props.player.startCasting(R.RemotePlayerType.CHROMECAST))})),e}return c()(r,[{key:"_shouldRender",value:function(){var e=this.props.isCasting||this.props.isCastAvailable;return this.props.onToggle(D,e),e}},{key:"render",value:function(e){if(this._shouldRender()){var t,r=e.isCasting?"".concat(b().castButton," ").concat(b().castButtonActive):b().castButton;return(0,T.h)("div",{role:"button","aria-label":this.props.castText,className:b().controlButtonContainer,onClick:this.onClick,onKeyDown:this.onKeyDown},(0,T.h)(I.Tooltip,{label:this.props.castText,type:(null===(t=e.classNames)||void 0===t?void 0:t.includes(b().upperBarIcon))?"bottom-left":"top",strictPosition:!0},(0,T.h)("google-cast-launcher",{className:r,tabIndex:"0"})))}}}]),r}(T.Component))||s)||s)||s)||s)||s);O.displayName=D},"./src/components/cast/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Cast:function(){return n.Cast},RemotePlayerType:function(){return a.RemotePlayerType}});var n=r("./src/components/cast/cast.tsx"),a=r("./src/components/cast/remote-player-type.ts")},"./src/components/cast/remote-player-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{RemotePlayerType:function(){return n}});var n={CHROMECAST:"chromecast"}},"./src/components/closed-captions/closed-captions.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ClosedCaptions:function(){return P}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),s=r.n(i),o=r("./src/styles/style.scss"),l=r.n(o),u=r("./node_modules/preact/dist/preact.module.js"),c=r("./node_modules/preact/hooks/dist/hooks.module.js"),d=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),p=r("./src/components/icon/index.ts"),h=r("./node_modules/react-redux/es/index.js"),f=r("./src/components/event-dispatcher/index.ts"),m=r("./src/components/logger/index.ts"),g=r("./src/components/tooltip/index.ts"),y=r("./src/components/button/index.ts"),v=r("./src/components/button-control/index.ts"),_=r("./src/components/bottom-bar/index.ts"),k=r("./src/index.ts"),E=r("./src/reducers/settings.ts"),b=r("./src/utils/key-map.ts");function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var S="ClosedCaptions",P=(0,h.connect)((function(e){return{textTracks:e.engine.textTracks,showCCButton:e.config.showCCButton,openMenuFromCCButton:e.config.openMenuFromCCButton}}))((0,m.withLogger)(S)((0,f.withEventDispatcher)(S)((0,d.withText)({closedCaptionsOnText:"controls.closedCaptionsOn",closedCaptionsOffText:"controls.closedCaptionsOff"})((function(e,t){var r,n,a=(0,c.useState)(!1),i=s()(a,2),o=i[0],d=i[1],h=e.textTracks,f=t.player,m=h.find((function(e){return e.active}));(0,c.useEffect)((function(){d("off"!==(null==m?void 0:m.language))}),[m]),(0,c.useEffect)((function(){(0,_.registerToBottomBar)(S,f,(function(){return T()}))}),[]);var T=function(){return{ariaLabel:function(){return x()},displayName:S,order:5,svgIcon:function(){return I()},onClick:function(){return w()},component:function(){return C(A(A({},e),{},{classNames:[l().upperBarIcon]}))},shouldHandleOnClick:!1}},P=function(){return k.redux.useStore().getState().settings.isCaptionsEnabled},x=function(){return P()?e.closedCaptionsOnText:e.closedCaptionsOffText},I=function(){return{type:P()?p.IconType.ClosedCaptionsOn:p.IconType.ClosedCaptionsOff}},w=function(){var t=P();e.notifyClick(t),t?(f.hideTextTrack(),k.redux.useStore().dispatch({type:E.types.UPDATE_IS_CAPTIONS_ENABLED,isCaptionsEnabled:!1})):(f.showTextTrack(),k.redux.useStore().dispatch({type:E.types.UPDATE_IS_CAPTIONS_ENABLED,isCaptionsEnabled:!0}))},R=function(e){((0,b.isEnter)(e)||(0,b.isSpace)(e))&&(e.preventDefault(),w())},M=!!(null==h?void 0:h.length)&&e.showCCButton&&!e.openMenuFromCCButton;if(e.onToggle(S,M),M)return(0,u.h)(v.ButtonControl,{name:S,className:e.classNames?e.classNames.join(" "):""},o?(0,u.h)(g.Tooltip,{label:e.closedCaptionsOnText,type:(null===(r=e.classNames)||void 0===r?void 0:r.includes(l().upperBarIcon))?"bottom-left":"top",strictPosition:!0},(0,u.h)(y.Button,{tabIndex:0,"aria-label":e.closedCaptionsOnText,className:[l().controlButton,l().ccOn].join(" "),onClick:function(){e.notifyClick(!0),f.hideTextTrack(),k.redux.useStore().dispatch({type:E.types.UPDATE_IS_CAPTIONS_ENABLED,isCaptionsEnabled:!1})},onKeyDown:R},(0,u.h)(p.Icon,{type:p.IconType.ClosedCaptionsOn}))):(0,u.h)(g.Tooltip,{label:e.closedCaptionsOffText,type:(null===(n=e.classNames)||void 0===n?void 0:n.includes(l().upperBarIcon))?"bottom-left":"top",strictPosition:!0},(0,u.h)(y.Button,{tabIndex:0,"aria-label":e.closedCaptionsOffText,className:l().controlButton,onClick:function(){f.showTextTrack(),e.notifyClick(!1),k.redux.useStore().dispatch({type:E.types.UPDATE_IS_CAPTIONS_ENABLED,isCaptionsEnabled:!0})},onKeyDown:R},(0,u.h)(p.Icon,{type:p.IconType.ClosedCaptionsOff}))))}))))),C=function(e){return(0,u.h)(P,e)};P.displayName=S},"./src/components/closed-captions/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ClosedCaptions:function(){return n.ClosedCaptions}});var n=r("./src/components/closed-captions/closed-captions.tsx")},"./src/components/context-menu/context-menu-utils.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ContextMenuUtils:function(){return u}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("@playkit-js/playkit-js"),l=r("./src/event/index.ts"),u=function(){function e(){a()(this,e)}return s()(e,null,[{key:"copyDebugInfoToClipboard",value:function(t){var r=t.debugInfo;if(r){var n=JSON.stringify(r,null,2);e.copyToClipboard(n).then((function(){t.dispatchEvent(new o.FakeEvent(l.EventType.USER_COPIED_DEBUG_INFO))})).catch((function(){e.copyToClipboardFallback(n),t.dispatchEvent(new o.FakeEvent(l.EventType.USER_COPIED_DEBUG_INFO))}))}}},{key:"copyToClipboard",value:function(e){try{return navigator.clipboard.writeText(e)}catch(e){return Promise.reject()}}},{key:"copyToClipboardFallback",value:function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}catch(e){}finally{document.body.removeChild(t)}}}]),e}()},"./src/components/context-menu/context-menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ContextMenu:function(){return v}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/preact/dist/preact.module.js"),s=r("./node_modules/preact/compat/dist/compat.module.js"),o=r("./node_modules/preact/hooks/dist/hooks.module.js"),l=r("./node_modules/react-redux/es/index.js"),u=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),c=r("./src/components/index.ts"),d=r("./src/event/index.ts"),p=r("./src/styles/style.scss"),h=r.n(p),f=r("@playkit-js/playkit-js"),m=r("./src/components/context-menu/context-menu-utils.ts"),g=r("./src/utils/index.ts"),y={copyDebugInfoLabel:(0,i.h)(u.Text,{id:"error.copy_debug_info"},"Copy debug info")},v=(0,l.connect)((function(e){return{isFullscreen:e.engine.fullscreen}}))((0,u.withText)(y)((0,d.withEventManager)((0,c.withPlayer)((function(e){var t=e.player,r=e.eventManager,n=e.copyDebugInfoLabel,l=e.isFullscreen,u=(0,o.useRef)(null),c=(0,o.useState)(!1),d=a()(c,2),y=d[0],v=d[1],_=(0,o.useRef)(y);(0,o.useEffect)((function(){var e=null,n=function e(){r.unlisten(document,"click",e),v(!1)},a=function(e){var a;if(u.current&&t.debugInfo&&(null===(a=document.getElementById(t.config.targetId))||void 0===a?void 0:a.contains(e.target)))if(_.current)n();else if(e.preventDefault(),document.getElementById(t.config.targetId)){var i=Number(p.contextMenuWidth),s=Number(p.contextMenuHeight),o=e.pageX,l=e.pageY;o+i>window.innerWidth&&(o=window.innerWidth-i),l+s>window.innerHeight&&(l=window.innerHeight-s),u.current.style.left=o+"px",u.current.style.top=l+"px",r.listen(document,"click",n),v(!0)}};f.Env.isIOS?(r.listen(document,"touchstart",(function(t){e=Date.now(),t.preventDefault()})),r.listen(document,"touchend",(function(t){null===e||e&&Date.now()-e<500||(a({target:t.target,pageX:t.pageX,pageY:t.pageY,preventDefault:t.preventDefault.bind(t)}),e=null)}))):(r.listen(document,"contextmenu",a),r.listen(document,"keydown",(function(e){e.code===g.KeyCode.KeyD&&e.altKey&&e.ctrlKey&&e.shiftKey&&m.ContextMenuUtils.copyDebugInfoToClipboard(t)})))}),[]),(0,o.useEffect)((function(){_.current=y}),[y]);var k=function(){return(0,i.h)("div",{ref:u,className:[h().contextMenu,y?"":h().hidden].join(" "),role:"menu"},(0,i.h)("div",{className:h().contextMenuItem,onClick:function(){return m.ContextMenuUtils.copyDebugInfoToClipboard(t)},role:"menuitem"},n))};return l?k():(0,s.createPortal)(k(),document.body)})))));v.displayName="ContextMenu"},"./src/components/context-menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ContextMenu:function(){return n.ContextMenu}});var n=r("./src/components/context-menu/context-menu.tsx")},"./src/components/copy-button/copy-button.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CopyButton:function(){return w}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./src/styles/style.scss"),_=r.n(v),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./src/components/icon/index.ts"),b=r("./src/components/icon/icon.tsx"),T=r("./src/components/tooltip/index.ts"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./src/utils/index.ts"),P=r("./src/components/index.ts");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var x="CopyButton",I=[{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7 4C5.89543 4 5 4.89543 5 6V13C5 14.1046 5.89543 15 7 15H11C12.1046 15 13 14.1046 13 13V6C13 4.89543 12.1046 4 11 4H7ZM7 6H11V13H7V6Z"},{d:"M15 11H16V18H12V17.2H10V18.1C10 19.2458 10.9971 20 12 20H16C17.0029 20 18 19.2458 18 18.1V10.9C18 9.75416 17.0029 9 16 9H15V11Z"}],w=(0,A.withText)({copyButtonLabel:"copy.button"})(n=function(e){d()(r,e);var t=C(r);function r(e){var n;return i()(this,r),n=t.call(this,e),y()(u()(n),"_timeoutId",null),y()(u()(n),"copy",(function(){try{n.props.copy(),n.setState({copySuccess:!0}),n._timeoutId=setTimeout((function(){n.setState({copySuccess:!1})}),2e3)}catch(e){n.setState({copySuccess:!1})}})),y()(u()(n),"onKeyDown",(function(e){e.keyCode===S.KeyMap.ENTER&&n.copy()})),n.setState({copySuccess:!1}),n}return o()(r,[{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}},{key:"render",value:function(e){var t=[_().btnCopyUrl,_().btnBorderless,_().onlyIcon].join(" ");return t+=this.state.copySuccess?" "+_().copied:"",(0,k.h)(A.Localizer,null,(0,k.h)(P.ButtonControl,{name:x},(0,k.h)(T.Tooltip,{label:this.props.copyButtonLabel},(0,k.h)(P.Button,{tabIndex:"0","aria-label":this.props.copyButtonLabel,ref:function(t){e.addAccessibleChild&&e.addAccessibleChild(t)},className:t,onClick:this.copy,onKeyDown:this.onKeyDown},(0,k.h)(b.Icon,{id:"copy",color:"#fff",path:I,width:"24",height:"24",viewBox:"0 0 24 24"}),(0,k.h)(b.Icon,{type:E.IconType.Check})))))}}]),r}(k.Component))||n;w.displayName=x},"./src/components/copy-button/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CopyButton:function(){return n.CopyButton}});var n=r("./src/components/copy-button/copy-button.tsx")},"./src/components/cvaa-overlay/custom-captions-window.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CustomCaptionsWindow:function(){return x}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./src/utils/key-map.ts"),b=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),T=r("./src/components/cvaa-overlay/drop-down-captions-style.tsx"),A=r("./src/components/cvaa-overlay/slider-captions-style.tsx");function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var x=(0,r("./src/components/player/index.ts").withPlayer)(n=function(e){d()(r,e);var t=C(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"changeCaptionsStyle",(function(){e.props.changeCaptionsStyle(e.props.customTextStyle)})),y()(u()(e),"transitionToState",(function(){e.props.transitionToState(e.props.cvaaOverlayState.Main)})),y()(u()(e),"onKeyDown",(function(t){t.keyCode!==E.KeyMap.ENTER&&t.keyCode!==E.KeyMap.SPACE||(t.preventDefault(),t.stopPropagation(),e.changeCaptionsStyle(),e.transitionToState(),e.focusCustomOrEdit())})),e}return o()(r,[{key:"componentDidMount",value:function(){this.props.focusOnDefault()}},{key:"focusCustomOrEdit",value:function(){var e,t;null===(e=(t=this.props).focusCustomOrEdit)||void 0===e||e.call(t)}},{key:"render",value:function(e){var t=this,r=this.props.player,n=r.TextStyle.FontFamily,a=r.TextStyle.EdgeStyles,i=r.TextStyle.StandardColors,s=r.TextStyle.FontSizes.map((function(t){return{value:t.label,label:t.label,active:e.customTextStyle.fontSize===t.label}})),o=Object.keys(i).map((function(t){return{value:i[t],label:t.charAt(0).toUpperCase()+t.toLowerCase().slice(1),active:e.customTextStyle.fontColor.every((function(e,r){return e===i[t][r]}))}})),l=Object.keys(n).map((function(t){return{value:n[t],label:n[t],active:e.customTextStyle.fontFamily===n[t]}})),u=Object.keys(a).map((function(t){return{value:a[t],label:t.charAt(0).toUpperCase()+t.toLowerCase().slice(1),active:e.customTextStyle.fontEdge===a[t]}})),c=Object.keys(i).map((function(t){return{value:i[t],label:t.charAt(0).toUpperCase()+t.toLowerCase().slice(1),active:e.customTextStyle.backgroundColor.every((function(e,r){return e===i[t][r]}))}})),d=r.TextStyle.FontAlignment.map((function(t){return P(P({},t),{},{active:e.customTextStyle.textAlign===t.value})}));return(0,v.h)("div",{className:[k().overlayScreen,k().active].join(" ")},(0,v.h)("h2",{className:k().title},(0,v.h)(b.Text,{id:"cvaa.set_custom_caption"})),(0,v.h)("form",{className:[k().form,k().customCaptionForm].join(" ")},(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.size_label",options:s,classNames:[k().formGroupRow,k().fontSize],styleName:"fontSize",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_alignment_label",options:d,classNames:[k().formGroupRow,k().fontAlignment],styleName:"textAlign",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_color_label",options:o,classNames:[k().formGroupRow,k().fontColor],styleName:"fontColor",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_family_label",options:l,classNames:[k().formGroupRow,k().fontFamily],styleName:"fontFamily",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_style_label",options:u,classNames:[k().formGroupRow,k().fontStyle],styleName:"fontEdge",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(A.SliderCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_opacity_label",value:e.customTextStyle.fontOpacity,classNames:[k().formGroupRow,k().fontOpacity],styleName:"fontOpacity",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.background_color_label",options:c,classNames:[k().formGroupRow,k().backgroundColor],styleName:"backgroundColor",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(A.SliderCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.background_opacity_label",value:e.customTextStyle.backgroundOpacity,classNames:[k().formGroupRow,k().backgroundOpacity],styleName:"backgroundOpacity",changeCustomStyle:e.changeCustomStyle}),(0,v.h)("div",{className:k().formGroupRow},(0,v.h)("a",{role:"button",tabIndex:0,ref:function(t){e.addAccessibleChild(t)},onClick:function(){t.changeCaptionsStyle(),t.transitionToState(),t.focusCustomOrEdit()},onKeyDown:this.onKeyDown,className:[k().btn,k().btnBranded,k().btnBlock].join(" ")},(0,v.h)(b.Text,{id:"cvaa.apply"}))),(0,v.h)("div",{className:k().previewContainer},(0,v.h)("span",{style:e.getPreviewStyle()},(0,v.h)(b.Text,{id:"cvaa.caption_preview"})))))}}]),r}(v.Component))||n},"./src/components/cvaa-overlay/cvaa-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CVAAOverlay:function(){return G}});var n,a,i,s,o,l=r("./node_modules/@babel/runtime/helpers/extends.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/createClass.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/inherits.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),E=r.n(k),b=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/react-redux/es/index.js"),P=r("./src/utils/index.ts"),C=r("./src/reducers/cvaa.ts"),x=r("./src/reducers/shell.ts"),I=r("./src/components/overlay/index.ts"),w=r("./src/components/player/index.ts"),R=r("./src/components/event-dispatcher/index.ts"),M=r("./src/components/logger/index.ts"),D=r("./src/components/cvaa-overlay/main-captions_window.tsx"),O=r("./src/components/cvaa-overlay/custom-captions-window.tsx"),L=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),N=r("@playkit-js/playkit-js");function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var a=E()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _()(this,r)}}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){T()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F={Main:"main",CustomCaptions:"custom-captions"},V="CVAAOverlay",G=(n=(0,S.connect)((function(e){return{style:e.cvaa.style,targetId:e.config.targetId}}),(0,P.bindActions)(B(B({},C.actions),x.actions))),a=(0,M.withLogger)(V),i=(0,R.withEventDispatcher)(V),s=(0,L.withText)({cvvaDialogText:"cvaa.title",cvvaSetCustomCaptionsText:"cvaa.set_custom_caption",cvaaCloseLabel:"cvaa.close_label"}),n(o=(0,w.withPlayer)(o=a(o=i(o=(0,P.withKeyboardA11y)(o=s(o=function(e){y()(r,e);var t=U(r);function r(){var e;d()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),T()(m()(e),"customOrEditRef",null),T()(m()(e),"focusOnNextUpdate",!1),T()(m()(e),"setCustomOrEditRef",(function(t){e.customOrEditRef=t})),T()(m()(e),"focusCustomOrEdit",(function(){e.focusOnNextUpdate=!0})),T()(m()(e),"transitionToState",(function(t){e.setState({activeWindow:t})})),T()(m()(e),"changeCaptionsStyle",(function(t){e.props.notifyClick({textStyle:t}),e.props.updateCaptionsStyle(t),e.props.player.textStyle=t})),T()(m()(e),"getPreviewStyle",(function(){var t=100*e.state.customTextStyle.implicitFontScale+"%",r=e.state.customTextStyle.toCSS();return"font-size: ".concat(t,"!important; ").concat(r)})),T()(m()(e),"changeCustomStyle",(function(t){e.setState((function(e){var r=e.customTextStyle.clone();return{customTextStyle:Object.assign(r,t)}}))})),T()(m()(e),"focusPlayerButtonBadge",(function(){e.props.player;var t=document.getElementById(e.props.targetId);if(t)var r=0,n=setInterval((function(){var e=t.querySelector(".playkit-button-badge");if(e&&"hidden"!==getComputedStyle(e).visibility)return e.focus(),void clearInterval(n);++r>=10&&clearInterval(n)}),100)})),e}return h()(r,[{key:"componentDidUpdate",value:function(){this.focusOnNextUpdate&&(this.focusOnNextUpdate=!1,(0,P.focusElement)(this.customOrEditRef,20))}},{key:"componentWillUnmount",value:function(){this.setState({activeWindow:F.Main})}},{key:"componentWillMount",value:function(){var e=this.props.player;this.setState({activeWindow:F.Main,customTextStyle:e.textStyle}),this.props.setIsModal(!0)}},{key:"render",value:function(e){var t=this;e.clearAccessibleChildren();var r=this.state.activeWindow===F.Main,n="captions_title_".concat(N.Utils.Generator.guid()),a=r?{ariaLabelledBy:n}:{ariaLabel:this.props.cvvaSetCustomCaptionsText};return(0,A.h)(I.Overlay,u()({open:!0,handleKeyDown:this.props.handleKeyDown,addAccessibleChild:this.props.addAccessibleChild,onClose:function(){e.onClose(),t.focusPlayerButtonBadge()},type:"cvaa"},a,{closeAriaLabel:this.props.cvaaCloseLabel}),this.state.activeWindow===F.Main?(0,A.h)(D.MainCaptionsWindow,{captionsTitleId:n,cvaaOverlayState:F,addAccessibleChild:e.addAccessibleChild,captionsStyleDefault:this.captionsStyleDefault,captionsStyleBlackBG:this.captionsStyleBlackBG,captionsStyleYellow:this.captionsStyleYellow,changeCaptionsStyle:this.changeCaptionsStyle,transitionToState:this.transitionToState,customTextStyle:this.state.customTextStyle,setCustomOrEditRef:this.setCustomOrEditRef}):(0,A.h)(O.CustomCaptionsWindow,{addAccessibleChild:e.addAccessibleChild,focusOnDefault:this.props.focusOnDefault,changeCaptionsStyle:this.changeCaptionsStyle,changeCustomStyle:this.changeCustomStyle,getPreviewStyle:this.getPreviewStyle,customTextStyle:this.state.customTextStyle,transitionToState:this.transitionToState,cvaaOverlayState:F,focusCustomOrEdit:this.focusCustomOrEdit}))}}]),r}(A.Component))||o)||o)||o)||o)||o)||o);G.displayName=V},"./src/components/cvaa-overlay/drop-down-captions-style.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{DropDownCaptionsStyle:function(){return s}});var n=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),a=r("./src/components/dropdown/index.ts"),i=r("./node_modules/preact/dist/preact.module.js"),s=function(e){var t=null;return(0,i.h)("div",{className:e.classNames.join(" ")},(0,i.h)("label",{id:e.styleName},(0,i.h)(n.Text,{id:e.labelId})),(0,i.h)(a.DropDown,{name:e.styleName,pushRef:function(r){t=r,e.addAccessibleChild(r)},tabbable:!0,onMenuChosen:function(r){var n={};n[e.styleName]=r,e.changeCustomStyle(n),t&&t.focus()},options:e.options}))}},"./src/components/cvaa-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CVAAOverlay:function(){return n.CVAAOverlay}});var n=r("./src/components/cvaa-overlay/cvaa-overlay.tsx")},"./src/components/cvaa-overlay/main-captions_window.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{MainCaptionsWindow:function(){return P}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),b=r("./src/utils/key-map.ts"),T=r("./src/components/icon/index.ts"),A=r("./src/components/cvaa-overlay/sample-captions-style-button.tsx");function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var P=(0,r("./src/components/player/index.ts").withPlayer)(n=function(e){d()(r,e);var t=S(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"captionsStyleDefault",void 0),y()(u()(e),"captionsStyleYellow",void 0),y()(u()(e),"captionsStyleBlackBG",void 0),y()(u()(e),"transitionToState",(function(){e.props.transitionToState(e.props.cvaaOverlayState.CustomCaptions)})),y()(u()(e),"onKeyDown",(function(t){t.keyCode===b.KeyMap.ENTER&&e.transitionToState()})),e}return o()(r,[{key:"componentWillMount",value:function(){var e=this.props.player;this.captionsStyleDefault=e.TextStyle.fromJson({backgroundOpacity:e.TextStyle.StandardOpacities.TRANSPARENT}),this.captionsStyleYellow=e.TextStyle.fromJson({backgroundOpacity:e.TextStyle.StandardOpacities.TRANSPARENT,fontColor:e.TextStyle.StandardColors.YELLOW}),this.captionsStyleBlackBG=e.TextStyle.fromJson({backgroundColor:e.TextStyle.StandardColors.BLACK,fontColor:e.TextStyle.StandardColors.WHITE})}},{key:"render",value:function(e){var t=this;return(0,v.h)("div",{className:[k().overlayScreen,k().active].join(" ")},(0,v.h)("h2",{className:k().title,id:this.props.captionsTitleId},(0,v.h)(E.Text,{id:"cvaa.title"})),(0,v.h)("div",{role:"radiogroup"},(0,v.h)(A.SampleCaptionsStyleButton,{addAccessibleChild:e.addAccessibleChild,classNames:[k().sample],changeCaptionsStyle:function(){return e.changeCaptionsStyle(t.captionsStyleDefault)},isActive:e.player.textStyle.isEqual(this.captionsStyleDefault)},(0,v.h)(E.Text,{id:"cvaa.sample_caption_tag",fields:{number:"1"}})),(0,v.h)(A.SampleCaptionsStyleButton,{addAccessibleChild:e.addAccessibleChild,classNames:[k().sample,k().blackBg],changeCaptionsStyle:function(){return e.changeCaptionsStyle(t.captionsStyleBlackBG)},isActive:e.player.textStyle.isEqual(this.captionsStyleBlackBG)},(0,v.h)(E.Text,{id:"cvaa.sample_caption_tag",fields:{number:"2"}})),(0,v.h)(A.SampleCaptionsStyleButton,{addAccessibleChild:e.addAccessibleChild,classNames:[k().sample,k().yellowText],changeCaptionsStyle:function(){return e.changeCaptionsStyle(t.captionsStyleYellow)},isActive:e.player.textStyle.isEqual(this.captionsStyleYellow)},(0,v.h)(E.Text,{id:"cvaa.sample_caption_tag",fields:{number:"3"}}))),this.isAdvancedStyleApplied()?(0,v.h)("div",{className:k().customCaptionsApplied},(0,v.h)("div",{className:[k().sample,k().custom].join(" "),style:e.customTextStyle.toCSS()},(0,v.h)(E.Text,{id:"cvaa.sample_custom_caption_tag"}),(0,v.h)("div",{className:k().activeTick},(0,v.h)(T.Icon,{type:T.IconType.Check}))),(0,v.h)("a",{id:"editCaption",role:"button",tabIndex:0,"aria-haspopup":"true",className:k().buttonEditCvaa,onClick:this.transitionToState,ref:function(t){var r;e.addAccessibleChild(t),null===(r=e.setCustomOrEditRef)||void 0===r||r.call(e,t)},onKeyDown:this.onKeyDown},(0,v.h)(E.Text,{id:"cvaa.edit_caption"}))):(0,v.h)("a",{id:"setCustom",role:"button","aria-haspopup":"true",tabIndex:0,className:k().buttonSaveCvaa,onClick:this.transitionToState,ref:function(t){var r;e.addAccessibleChild(t),null===(r=e.setCustomOrEditRef)||void 0===r||r.call(e,t)},onKeyDown:this.onKeyDown},(0,v.h)(E.Text,{id:"cvaa.set_custom_caption"})))}},{key:"isAdvancedStyleApplied",value:function(){var e=this.props.player;return!e.textStyle.isEqual(this.captionsStyleDefault)&&!e.textStyle.isEqual(this.captionsStyleBlackBG)&&!e.textStyle.isEqual(this.captionsStyleYellow)}}]),r}(v.Component))||n},"./src/components/cvaa-overlay/sample-captions-style-button.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SampleCaptionsStyleButton:function(){return u}});var n=r("./src/utils/index.ts"),a=r("./src/styles/style.scss"),i=r.n(a),s=r("./src/components/icon/index.ts"),o=r("./node_modules/preact/dist/preact.module.js"),l=r("./node_modules/preact/compat/dist/compat.module.js"),u=function(e){var t=(0,l.useRef)(null);return(0,l.useEffect)((function(){e.isActive&&t.current&&t.current.focus()}),[]),(0,o.h)("div",{role:"radio",tabIndex:0,"aria-checked":e.isActive?"true":"false",ref:function(r){r&&(t.current=r,e.addAccessibleChild(r))},className:e.classNames.join(" "),onClick:e.changeCaptionsStyle,onKeyDown:function(t){t.keyCode===n.KeyMap.ENTER&&e.changeCaptionsStyle()}},e.children,e.isActive?(0,o.h)("div",{className:i().activeTick},(0,o.h)(s.Icon,{type:s.IconType.Check})):void 0)}},"./src/components/cvaa-overlay/slider-captions-style.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SliderCaptionsStyle:function(){return s}});var n=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),a=r("./node_modules/preact/dist/preact.module.js"),i=r("./src/components/slider/index.ts"),s=function(e){return(0,a.h)("div",{className:e.classNames.join(" ")},(0,a.h)("label",{id:e.styleName},(0,a.h)(n.Text,{id:e.labelId})),(0,a.h)(i.Slider,{name:e.styleName,pushRef:function(t){e.addAccessibleChild(t)},min:0,max:100,value:100*e.value,onChange:function(t){var r={};r[e.styleName]=t/100,e.changeCustomStyle(r)}}))}},"./src/components/dropdown/dropdown.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{DropDown:function(){return P}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./src/styles/style.scss"),_=r.n(v),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./node_modules/react-redux/es/index.js"),b=r("./src/components/menu/index.ts"),T=r("./src/components/icon/index.ts"),A=r("./src/utils/key-map.ts");function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var P=(0,E.connect)((function(e){return{isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize}}))(n=function(e){d()(r,e);var t=S(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"_el",void 0),y()(u()(e),"onMenuChosen",(function(t){e.props.onMenuChosen(t),e.setState({dropMenuActive:!1})})),y()(u()(e),"onClick",(function(){e.state.dropMenuActive||setTimeout((function(){return e.toggleDropDown()}))})),y()(u()(e),"onKeyDown",(function(t){switch(t.keyCode){case A.KeyMap.ENTER:e.onClick();break;case A.KeyMap.SPACE:t.preventDefault(),e.onClick();break;case A.KeyMap.ESC:e.state.dropMenuActive&&(e.onClose(),t.stopPropagation())}})),y()(u()(e),"onClose",(function(){e.setState({dropMenuActive:!1})})),e}return o()(r,[{key:"componentWillMount",value:function(){this.setState({dropMenuActive:!1})}},{key:"componentDidMount",value:function(){this.props.registerParentSelectedCallback&&this.props.registerParentSelectedCallback(this.toggleDropDown.bind(this))}},{key:"isSelected",value:function(e){return e.active}},{key:"getActiveOption",value:function(){var e=this.props.options.find((function(e){return e.active}));return e||this.props.options[0]||{label:"Unlabled"}}},{key:"renderNativeSelect",value:function(e){return(0,k.h)(b.Menu,{labelledby:e,pushRef:this.props.pushRef,options:this.props.options,onMenuChosen:this.onMenuChosen,onClose:this.onClose,additionalOptions:this.props.additionalOptions||[]})}},{key:"render",value:function(e){var t,r,n=this,a=e.name+"Active",i=this.getActiveOption(),s=(null==i||null===(t=i.dropdownOptions)||void 0===t?void 0:t.label)||i.label,o=T.BadgeType[i.badgeType||(null==i||null===(r=i.dropdownOptions)||void 0===r?void 0:r.badgeType)];return e.isMobile||e.isSmallSize?this.renderNativeSelect(e.name):(0,k.h)("div",{name:e.name,className:this.state.dropMenuActive?[_().dropdown,_().active].join(" "):_().dropdown,ref:function(e){return e?n._el=e:void 0}},(0,k.h)("div",{tabIndex:e.tabbable?0:-1,ref:function(t){e.pushRef&&e.pushRef(t)},role:"combobox","aria-haspopup":"listbox","aria-expanded":this.state.dropMenuActive?"true":"false","aria-labelledby":e.name,className:_().dropdownButton,onClick:this.onClick,onKeyDown:this.onKeyDown},(0,k.h)("span",{id:a,className:o?[_().labelBadge,o].join(" "):"","aria-label":(null==o?void 0:o.includes("quality-hd"))?"".concat(s," HD"):s},s),(0,k.h)(T.Icon,{type:T.IconType.ArrowDown}),this.state.dropMenuActive?(0,k.h)(b.Menu,{parentEl:this._el,options:e.options,onMenuChosen:this.onMenuChosen,onClose:this.onClose,additionalOptions:e.additionalOptions||[]}):void 0))}},{key:"toggleDropDown",value:function(){this.setState((function(e){return{dropMenuActive:!e.dropMenuActive}}))}}]),r}(k.Component))||n;P.displayName="DropDown"},"./src/components/dropdown/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{DropDown:function(){return n.DropDown}});var n=r("./src/components/dropdown/dropdown.tsx")},"./src/components/engine-connector/engine-connector.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineConnector:function(){return L}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/utils/index.ts"),E=r("./src/reducers/engine.ts"),b=r("./src/reducers/loading.ts"),T=r("./src/reducers/shell.ts"),A=r("./src/reducers/seekbar.ts"),S=r("./src/reducers/settings.ts"),P=r("./src/components/player/index.ts"),C=r("./src/event/index.ts"),x=r("./src/components/logger/index.ts");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var M=A.actions.updateCurrentTime,D=S.actions.updateIsCaptionsEnabled,O="EngineConnector",L=(n=(0,_.connect)(E.default,(0,k.bindActions)(R(R(R(R({},E.actions),b.actions),T.actions),{},{seekbarUpdateCurrentTime:M,updateIsCaptionsEnabled:D}))),a=(0,x.withLogger)(O),n(i=(0,P.withPlayer)(i=(0,C.withEventManager)(i=a(i=function(e){d()(r,e);var t=I(r);function r(){return o()(this,r),t.apply(this,arguments)}return u()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.player,n=t.eventManager,a=r.Track;this.props.updatePrePlayback(!r.config.playback.autoplay),n.listen(r,r.Event.Core.PLAYER_RESET,(function(t){e.props.updateCurrentTime(0),e.props.seekbarUpdateCurrentTime(0),t.payload.isChangeMedia||e.props.updateIsIdle(!0),e.props.updateIsPlaybackStarted(!1),e.props.updateDataLoadingStatus(!1)})),n.listen(r,r.Event.Core.SOURCE_SELECTED,(function(){e.props.updateIsCastAvailable(r.isCastAvailable()),e.props.updateIsLive(r.isLive()),e.props.updateIsVr(r.isVr()),e.props.updateIsImg(r.isUntimedImg()),e.props.updateIsDocument(r.isUntimedDocument()),e.props.updateIsAudio(r.isAudio()),e.props.updateIsInPictureInPicture(r.isInPictureInPicture()),r.config.playback.autoplay?e.props.updateLoadingSpinnerState(!0):e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.Core.CHANGE_SOURCE_STARTED,(function(){e.props.updatePrePlayback(!r.config.playback.autoplay&&!e.props.engine.isPlaybackStarted),e.props.updateIsChangingSource(!0),e.props.updateFallbackToMutedAutoPlay(!1),e.props.updateAdBreak(!1),e.props.updateAdIsPlaying(!1),e.props.updateIsPlaying(!1),e.props.updateIsEnded(!1),e.props.updateIsPlaybackEnded(!1),e.props.updateLastSeekPoint(0),e.props.updateIsPaused(!1),e.props.engine.isCasting&&e.props.updateLoadingSpinnerState(!0)})),n.listen(r,r.Event.Core.CHANGE_SOURCE_ENDED,(function(){e.props.updateIsChangingSource(!1),e.props.updatePlayerPoster(r.poster),e.props.updateIsIdle(!1)})),n.listen(r,r.Event.Core.PLAYER_STATE_CHANGED,(function(t){e.props.updatePlayerState(t.payload.oldState.type,t.payload.newState.type)})),n.listen(r,r.Event.Core.TIME_UPDATE,(function(){e.props.updateCurrentTime(r.currentTime)})),n.listen(r,r.Event.Core.DURATION_CHANGE,(function(){e.props.updateDuration(r.isLive()?r.liveDuration:r.duration)})),n.listen(r,r.Event.Core.LOADED_DATA,(function(){e.props.updateDuration(r.isLive()?r.liveDuration:r.duration),e.props.updatePictureInPictureSupport(r.isPictureInPictureSupported()),e.props.updateDataLoadingStatus(!0)})),n.listen(r,r.Event.Core.LOADED_METADATA,(function(){e.props.updateMuted(r.muted),e.props.updateMetadataLoadingStatus(!0),e.props.updateIsLive(r.isLive()),e.props.updateIsDvr(r.isDvr()),e.props.updatePlayerPoster(r.poster)})),n.listen(r,r.Event.Core.VOLUME_CHANGE,(function(){e.props.updateVolume(r.volume)})),n.listen(r,r.Event.Core.MUTE_CHANGE,(function(){e.props.updateMuted(r.muted),e.props.engine.fallbackToMutedAutoPlay&&e.props.updateFallbackToMutedAutoPlay(r.muted)})),n.listen(r,r.Event.Core.PLAYBACK_START,(function(){e.props.updatePrePlayback(!1),e.props.updateIsPlaybackStarted(!0),e.props.updateLoadingSpinnerState(!0)})),n.listen(r,r.Event.Core.AUTOPLAY_FAILED,(function(){e.props.updatePrePlayback(!0)})),n.listen(r,r.Event.Core.FIRST_PLAY,(function(){e.props.updatePrePlayback(!1)})),n.listen(r,r.Event.Core.PLAY,(function(){e.props.updateIsPlaying(!0),e.props.updateIsEnded(!1),e.props.updateIsPaused(!1),e.props.updateIsPlaybackEnded(!1)})),n.listen(r,r.Event.Core.PAUSE,(function(){e.props.updateIsPlaying(!1),e.props.updateIsPaused(!0)})),n.listen(r,r.Event.Core.SEEKING,(function(){e.props.updateIsSeeking(!0)})),n.listen(r,r.Event.Core.SEEKED,(function(){e.props.updateIsSeeking(!1),e.props.updateLastSeekPoint(r.currentTime),e.props.updateIsPlaybackEnded(!1)})),n.listen(r,r.Event.Core.ENDED,(function(){e.props.updateIsEnded(!0),e.props.updateIsPlaying(!1),e.props.updateIsPaused(!0)})),n.listen(r,r.Event.Core.PLAYBACK_ENDED,(function(){e.props.updateIsPlaybackEnded(!0)})),n.listen(r,r.Event.Core.TRACKS_CHANGED,(function(){var t=r.getTracks(a.AUDIO),n=r.getTracks(a.VIDEO),i=r.getTracks(a.TEXT);e.props.updateAudioTracks(t),e.props.updateVideoTracks(n),e.props.updateTextTracks(i)})),n.listen(r,r.Event.Core.TEXT_TRACK_CHANGED,(function(){var t,n=r.getTracks(a.TEXT);e.props.updateTextTracks(n),e.props.updateIsCaptionsEnabled("off"!==(null===(t=n.find((function(e){return e.active})))||void 0===t?void 0:t.language))})),n.listen(r,r.Event.Core.AUDIO_TRACK_CHANGED,(function(){var t=r.getTracks(a.AUDIO);e.props.updateAudioTracks(t)})),n.listen(r,r.Event.Core.VIDEO_TRACK_CHANGED,(function(){var t=r.getTracks(a.VIDEO);e.props.updateVideoTracks(t)})),n.listen(r,r.Event.Core.AD_BREAK_START,(function(){e.props.updateHasError(!1),e.props.updateAdBreak(!0)})),n.listen(r,r.Event.Core.AD_BREAK_END,(function(){e.props.updateAdBreak(!1)})),n.listen(r,r.Event.Core.ALL_ADS_COMPLETED,(function(){e.props.updateAdBreak(!1)})),n.listen(r,r.Event.Core.AD_PROGRESS,(function(t){var r=t.payload.adProgress.currentTime,n=t.payload.adProgress.duration;e.props.updateAdBreakProgress(r,n)})),n.listen(r,r.Event.Core.AD_COMPLETED,(function(){e.props.updateAdBreakCompleted()})),n.listen(r,r.Event.Core.AD_STARTED,(function(t){var r=t.payload.ad;e.props.updateLoadingSpinnerState(!1),e.props.updateAdIsPlaying(!0),e.props.updatePrePlayback(!1),e.props.updateAdIsBumper(r.bumper),e.props.updateAdContentType(r.contentType)})),n.listen(r,r.Event.Core.AD_RESUMED,(function(){e.props.updateAdIsPlaying(!0)})),n.listen(r,r.Event.Core.AD_PAUSED,(function(){e.props.updateAdIsPlaying(!1)})),n.listen(r,r.Event.Core.AD_ERROR,(function(t){t.payload.severity===r.Error.Severity.CRITICAL&&e.props.updateAdBreak(!1)})),n.listen(r,r.Event.Core.FALLBACK_TO_MUTED_AUTOPLAY,(function(){e.props.updateFallbackToMutedAutoPlay(!0)})),n.listen(r,r.Event.Core.AD_LOADED,(function(t){var r=t.payload.ad;e.props.updateAdIsLinear(r.linear),e.props.updateAdIsBumper(r.bumper),e.props.updateAdClickUrl(r.clickThroughUrl),e.props.updateAdSkipTimeOffset(r.skipOffset),e.props.updateAdSkippableState(r.skippable)})),n.listen(r,r.Event.Core.VR_STEREO_MODE_CHANGED,(function(t){e.props.updateVrStereoMode(t.payload.mode)})),n.listen(r,r.Event.Core.ERROR,(function(t){var n,a;t.payload.severity===r.Error.Severity.CRITICAL&&(e.props.updateIsIdle(!1),e.props.updateHasError(!0),e.props.updateErrorDetails(t.payload.category||void 0,null===(n=t.payload.errorDetails)||void 0===n?void 0:n.errorTitle,null===(a=t.payload.errorDetails)||void 0===a?void 0:a.errorMessage))})),n.listen(r,r.Event.Cast.CAST_SESSION_STARTED,(function(t){var r=t.payload.session;e.props.updateIsCasting(!0),e.props.updateCastSession(r),r.resuming&&e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.Cast.CAST_SESSION_ENDED,(function(){e.props.updateIsCasting(!1),e.props.updateCastSession(null)})),n.listen(r,r.Event.Cast.CAST_AVAILABLE,(function(t){var r=t.payload.available;e.props.updateIsCastAvailable(r)})),n.listen(r,r.Event.Playlist.PLAYLIST_ITEM_CHANGED,(function(){e.props.updatePlaylist({next:r.playlist.next,prev:r.playlist.prev})})),n.listen(r,r.Event.Core.ENTER_PICTURE_IN_PICTURE,(function(){e.props.updateIsInPictureInPicture(!0)})),n.listen(r,r.Event.Core.LEAVE_PICTURE_IN_PICTURE,(function(){e.props.updateIsInPictureInPicture(!1)})),n.listen(r,r.Event.Core.PRESENTATION_MODE_CHANGED,(function(){e.props.updateIsInPictureInPicture(r.isInPictureInPicture()),e.props.updateFullscreen(r.isFullscreen())})),n.listen(r,r.Event.Core.ENTER_FULLSCREEN,(function(){e.props.updateFullscreen(!0)})),n.listen(r,r.Event.Core.EXIT_FULLSCREEN,(function(){e.props.updateFullscreen(!1)}))}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return(0,v.h)("span",null)}}]),r}(v.Component))||i)||i)||i)||i);L.displayName=O},"./src/components/engine-connector/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineConnector:function(){return n.EngineConnector}});var n=r("./src/components/engine-connector/engine-connector.tsx")},"./src/components/error-overlay/error-message-provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{getErrorDetailsByCategory:function(){return i}});var n=new Map([[1,{title:"network_error_title",message:"network_error_message"}],[2,{title:"text_error_title",message:"text_error_message"}],[3,{title:"media_error_title",message:"media_error_message"}],[4,{title:"manifest_error_title",message:"manifest_error_message"}],[5,{title:"streaming_error_title",message:"streaming_error_message"}],[6,{title:"media_unavailable_error_title",message:"drm_error_message"}],[7,{title:"default_error_title",message:"default_error_message"}],[8,{title:"default_error_title",message:"default_error_message"}],[9,{title:"default_error_title",message:"default_error_message"}],[12,{title:"media_not_ready_error_title",message:"media_not_ready_error_message"}],[13,{title:"geo_location_error_title",message:"geo_location_error_message"}],[14,{title:"media_unavailable_error_title",message:"media_unavailable_error_message"}],[15,{title:"media_unavailable_error_title",message:"ip_restricted_error_message"}],[16,{title:"media_unavailable_error_title",message:"site_restricted_error_message"}],[17,{title:"media_unavailable_error_title",message:"scheduled_restricted_error_message"}],[18,{title:"error_title",message:"access_control_error_message"}]]),a={title:"default_error_title",message:"default_error_message"},i=function(e){return n.get(e)||a}},"./src/components/error-overlay/error-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ErrorOverlay:function(){return j}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/react-redux/es/index.js"),A=r("./src/components/overlay/index.ts"),S=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./src/utils/bind-actions.ts"),C=r("./src/reducers/engine.ts"),x=r("./src/components/copy-button/index.ts"),I=r("./src/components/logger/index.ts"),w=r("./src/components/player/index.ts"),R=r("./src/components/button/index.ts"),M=r("./src/components/error-overlay/error-message-provider.ts"),D=r("./src/reducers/overlay.ts");function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){_()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var U="ErrorOverlay",j=(n=(0,T.connect)((function(e){var t;return{hasError:e.engine.hasError,errorOverlaConfig:null===(t=e.config.components)||void 0===t?void 0:t.errorOverlay,errorDetails:e.engine.errorDetails}}),(0,P.bindActions)(N(N({},C.actions),D.actions))),a=(0,I.withLogger)(U),n(i=(0,w.withPlayer)(i=a(i=function(e){h()(r,e);var t=O(r);function r(){var e;o()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"sessionEl",void 0),_()(d()(e),"copyError",(function(){navigator.clipboard.writeText(JSON.stringify(e.props.player.debugInfo))})),_()(d()(e),"handleClick",(function(){var t=e.props.player.getMediaInfo();e.props.updateOverlay(!1),e.props.player.loadMedia(t)})),_()(d()(e),"getBackgroundUrl",(function(){var t=e.props.errorOverlaConfig;return null==t?void 0:t.backgroundUrl})),e}return u()(r,[{key:"renderSessionID",value:function(){var e=this.props.player,t=e&&e.config&&e.config.session&&e.config.session.id;return(0,b.h)("div",{className:E().linkOptionsContainer},(0,b.h)("div",{className:E().copyUrlRow},(0,b.h)("div",null,(0,b.h)(S.Text,{id:"error.default_session_text"})," "," "+t||0),(0,b.h)(x.CopyButton,{copy:this.copyError})))}},{key:"renderRetryButton",value:function(){if(this.props.player.getMediaInfo()){var e=Boolean(this.getBackgroundUrl());return(0,b.h)("div",{className:E().controlButtonContainer,onClick:this.handleClick},(0,b.h)(R.Button,{className:[e?E().btnTranslucent:E().btnBorderless,E().retryBtn].join(" ")},(0,b.h)(S.Text,{id:"error.retry"})))}}},{key:"renderErrorHead",value:function(){var e=this.props.errorDetails,t=e.errorCategory,r=e.errorTitle,n=e.errorMessage,a="",i="";if(r&&n)a=r,i=n;else{var s=(0,M.getErrorDetailsByCategory)(t);a=(0,b.h)(S.Text,{id:"error.".concat(s.title)}),i=(0,b.h)(S.Text,{id:"error.".concat(s.message)})}return(0,b.h)("div",{className:E().headline},(0,b.h)("div",{className:E().errorTitle},this.props.errorHead||a),i?(0,b.h)("div",{className:E().errorMessage},i):void 0)}},{key:"render",value:function(){if(this.props&&this.props.hasError||this.props.permanent){var e=this.getBackgroundUrl(),t=e?{backgroundImage:"url(".concat(e,")")}:void 0;return(0,b.h)("div",{className:["overlay-portal",e?E().customErrorSlate:""].join(" ")},(0,b.h)(A.Overlay,{open:!0,permanent:!0,type:"error"},(0,b.h)("div",{className:E().errorOverlay,style:t},(0,b.h)("p",{className:E().errorText}),this.renderErrorHead(),this.renderSessionID(),this.renderRetryButton())))}}}]),r}(b.Component))||i)||i)||i);j.displayName=U},"./src/components/error-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ErrorOverlay:function(){return n.ErrorOverlay}});var n=r("./src/components/error-overlay/error-overlay.tsx")},"./src/components/event-dispatcher/event-dispatcher-provider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{EventDispatcherProvider:function(){return O}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("@playkit-js/playkit-js"),_=r("./src/event/index.ts"),k=r("./src/event/events/audio-selected-event.ts"),E=r("./src/event/events/caption-selected-event.ts"),b=r("./src/event/events/captions-style-selected-event.ts"),T=r("./src/event/events/quality-selected-event.ts"),A=r("./src/event/events/seeked-event.ts"),S=r("./src/event/events/speed-selected-event.ts"),P=r("./src/event/events/ui-visibility-changed-event.ts"),C=r("./src/event/events/rewind-clicked.ts"),x=r("./src/event/events/forward-clicked.ts"),I=r("./src/event/events/volume-changed.ts"),w=r("./src/utils/index.ts"),R=r("./src/utils/is-equal.ts"),M=r("./node_modules/preact/dist/preact.module.js");function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var O=function(e){d()(r,e);var t=D(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"_notifyClick",(function(t){return function(e,t,r){switch(t.name){case"Keyboard":B[t.payload.key](e,t,r);break;case"OverlayAction":!function(e,t,r){"PlayPause"===t.payload.type?L(e,0,r):"Fullscreen"===t.payload.type&&U(0,0,r)}(e,t,r);break;case"CVAAOverlay":!function(e,t,r){var n,a=r.textStyle,i=null===(n=t.payload)||void 0===n?void 0:n.textStyle;[{key:"fontSize",eventType:_.EventType.USER_SELECTED_CAPTIONS_SIZE},{key:"textAlign",eventType:_.EventType.USER_SELECTED_CAPTIONS_ALIGNMENT},{key:"fontFamily",eventType:_.EventType.USER_SELECTED_CAPTIONS_FONT_FAMILY},{key:"fontOpacity",eventType:_.EventType.USER_SELECTED_CAPTIONS_FONT_OPACITY},{key:"backgroundOpacity",eventType:_.EventType.USER_SELECTED_CAPTIONS_BACKGROUND_OPACITY},{key:"backgroundColor",eventType:_.EventType.USER_SELECTED_CAPTIONS_BACKGROUND_COLOR,collection:r.TextStyle.StandardColors},{key:"fontColor",eventType:_.EventType.USER_SELECTED_CAPTIONS_FONT_COLOR,collection:r.TextStyle.StandardColors},{key:"fontEdge",eventType:_.EventType.USER_SELECTED_CAPTIONS_FONT_STYLE,collection:r.TextStyle.EdgeStyles}].map((function(e){var t=e.key,n=e.eventType,s=e.collection;s&&!(0,R.default)(null==a?void 0:a[t],null==i?void 0:i[t])?Object.keys(s).some((function(e){if((0,R.default)(s[e],null==i?void 0:i[t]))return r.dispatchEvent(new v.FakeEvent(n,e.toLowerCase())),!0})):(null==a?void 0:a[t])!==(null==i?void 0:i[t])&&r.dispatchEvent(new v.FakeEvent(n,null==i?void 0:i[t])),r.dispatchEvent(new b.CaptionsStyleSelectedEvent(i))}))}(0,t,r);break;case"Fullscreen":U(0,0,r);break;case"CaptionsMenu":!function(e,t,r){t.payload.type===r.Track.TEXT&&r.dispatchEvent(new E.CaptionSelectedEvent(t.payload.track))}(0,t,r);break;case"AudioMenu":!function(e,t,r){t.payload.type===r.Track.AUDIO&&r.dispatchEvent(new k.AudioSelectedEvent(t.payload.track))}(0,t,r);break;case"QualityMenu":!function(e,t,r){t.payload.type===r.Track.VIDEO&&r.dispatchEvent(new T.QualitySelectedEvent(t.payload.track))}(0,t,r);break;case"SpeedMenu":!function(e,t,r){"speed"===t.payload.type&&r.dispatchEvent(new S.SpeedSelectedEvent(t.payload.speed))}(0,t,r);break;case"AdvancedAudioDescToggle":case"AdvancedAudioDesc":!function(e,t,r){"AdvancedAudioDescription"===t.payload.type&&r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_ADVANCED_AUDIO_DESCRIPTION,t.payload))}(0,t,r);break;case"Shell":r.dispatchEvent(new v.FakeEvent(_.EventType.UI_CLICKED));break;case"Rewind":r.dispatchEvent(new C.RewindClickedEvent(t.payload.from,t.payload.to));break;case"Forward":r.dispatchEvent(new x.ForwardClickedEvent(t.payload.from,t.payload.to));break;case"LiveTag":r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_LIVE_TAG));break;case"Logo":r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_LOGO,t.payload));break;case"PrePlaybackPlayOverlay":case"PlayPause":L(e,0,r);break;case"Volume":N(e,0,r);break;case"PictureInPicture":j(0,0,r);break;case"ClosedCaptions":!function(e,t,r){var n,a=t.payload,i=null===(n=r.getActiveTracks())||void 0===n?void 0:n[r.Track.TEXT];r.dispatchEvent(new v.FakeEvent(a?_.EventType.USER_HID_CAPTIONS:_.EventType.USER_SHOWED_CAPTIONS,{language:null==i?void 0:i.language}))}(0,t,r)}}(e.props.store,t,e.props.player)})),y()(u()(e),"_notifyChange",(function(t){return function(e,t,r){switch(t.name){case"Volume":r.dispatchEvent(new I.VolumeChangedEvent(t.payload.volume));break;case"SeekBarPlaybackContainer":case"SeekBarLivePlaybackContainer":r.dispatchEvent(new A.SeekedEvent(t.payload.from,t.payload.to));break;case"ActivePreset":r.dispatchEvent(new v.FakeEvent(_.EventType.UI_PRESET_CHANGE,t.payload))}}(e.props.store,t,e.props.player)})),y()(u()(e),"_notifyHoverChange",(function(t){return r=e.props.store,n=t,a=e.props.player,i=r.getState().engine,s=r.getState().shell,void(!i.adBreak&&i.isPlaying&&s.playerHover!==n.payload.hover&&a.dispatchEvent(new P.UIVisibilityChangedEvent(n.payload.hover)));var r,n,a,i,s})),e}return o()(r,[{key:"getChildContext",value:function(){return{notifyClick:this._notifyClick,notifyChange:this._notifyChange,notifyHoverChange:this._notifyHoverChange}}},{key:"render",value:function(){return this.props.children&&(0,M.toChildArray)(this.props.children)[0]||null}}]),r}(M.Component);function L(e,t,r){var n=e.getState().engine;n.adBreak?n.adIsPlaying?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_PAUSE)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_PLAY)):n.isPlaying?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_PAUSE)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_PLAY))}function N(e,t,r){e.getState().engine.muted?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_MUTE)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_UNMUTE))}function U(e,t,r){r.isFullscreen()?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_EXITED_FULL_SCREEN)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_ENTERED_FULL_SCREEN))}function j(e,t,r){r.isInPictureInPicture()?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_EXITED_PICTURE_IN_PICTURE)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_ENTERED_PICTURE_IN_PICTURE))}var B=(n={},y()(n,w.KeyMap.SPACE,(function(e,t,r){L(e,0,r)})),y()(n,w.KeyMap.UP,(function(e,t,r){r.dispatchEvent(new I.VolumeChangedEvent(t.payload.volume))})),y()(n,w.KeyMap.DOWN,(function(e,t,r){r.dispatchEvent(new I.VolumeChangedEvent(t.payload.volume))})),y()(n,w.KeyMap.F,(function(e,t,r){U(0,0,r)})),y()(n,w.KeyMap.P,(function(e,t,r){j(0,0,r)})),y()(n,w.KeyMap.ESC,(function(e,t,r){U(0,0,r)})),y()(n,w.KeyMap.LEFT,(function(e,t,r){r.dispatchEvent(new A.SeekedEvent(t.payload.from,t.payload.to))})),y()(n,w.KeyMap.RIGHT,(function(e,t,r){r.dispatchEvent(new A.SeekedEvent(t.payload.from,t.payload.to))})),y()(n,w.KeyMap.HOME,(function(e,t,r){r.dispatchEvent(new A.SeekedEvent(t.payload.from,t.payload.to))})),y()(n,w.KeyMap.END,(function(e,t,r){r.dispatchEvent(new A.SeekedEvent(t.payload.from,t.payload.to))})),y()(n,w.KeyMap.M,(function(e,t,r){N(e,0,r)})),y()(n,w.KeyMap.SEMI_COLON,(function(e,t,r){r.dispatchEvent(new S.SpeedSelectedEvent(t.payload.speed))})),y()(n,w.KeyMap.PERIOD,(function(e,t,r){r.dispatchEvent(new S.SpeedSelectedEvent(t.payload.speed))})),y()(n,w.KeyMap.COMMA,(function(e,t,r){r.dispatchEvent(new S.SpeedSelectedEvent(t.payload.speed))})),y()(n,w.KeyMap.C,(function(e,t,r){r.dispatchEvent(new E.CaptionSelectedEvent(t.payload.track))})),n)},"./src/components/event-dispatcher/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EventDispatcherProvider:function(){return n.EventDispatcherProvider},withEventDispatcher:function(){return a.withEventDispatcher}});var n=r("./src/components/event-dispatcher/event-dispatcher-provider.tsx"),a=r("./src/components/event-dispatcher/with-event-dispatcher.tsx")},"./src/components/event-dispatcher/with-event-dispatcher.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withEventDispatcher:function(){return y}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var y=function(e){return function(t){return function(r){c()(i,r);var n=g(i);function i(){return s()(this,i),n.apply(this,arguments)}return l()(i,[{key:"notifyClick",value:function(t){this.context.notifyClick({name:e,payload:t})}},{key:"notifyChange",value:function(t){this.context.notifyChange({name:e,payload:t})}},{key:"notifyHoverChange",value:function(t){this.context.notifyHoverChange({name:e,payload:t})}},{key:"render",value:function(){var e=this;return(0,m.h)(t,a()({},this.props,{notifyHoverChange:function(t){return e.notifyHoverChange(t)},notifyChange:function(t){return e.notifyChange(t)},notifyClick:function(t){return e.notifyClick(t)}}))}}]),i}(m.Component)}}},"./src/components/expandable-text/expandable-text.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ExpandableText:function(){return v}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/extends.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),l=r.n(o),u=r("./node_modules/preact/dist/preact.module.js"),c=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),d=r("./node_modules/preact/hooks/dist/hooks.module.js"),p=r("./src/utils/index.ts"),h=r("./src/styles/style.scss"),f=r.n(h),m=p.KeyMap.ENTER,g=p.KeyMap.SPACE,y=function(e){var t=e.isTextExpanded,r=e.readLessLabel,n=e.readMoreLabel,a=e.onClick,i=e.onKeyDown,o=l()(e,["isTextExpanded","readLessLabel","readMoreLabel","onClick","onKeyDown"]);return(0,u.h)("div",s()({role:"button",tabIndex:0,className:f().moreButtonText,onClick:a,onKeyDown:i},o),t?r:n)},v=(0,c.withText)({readMoreLabel:"controls.readMore",readLessLabel:"controls.readLess"})((function(e){var t=(0,d.useState)(!1),r=a()(t,2),n=r[0],i=r[1],o=(0,d.useState)(!1),l=a()(o,2),c=l[0],p=l[1],h=(0,d.useState)(!1),v=a()(h,2),_=v[0],k=v[1],E=(0,d.useRef)(null),b=(0,d.useRef)(null);(0,d.useLayoutEffect)((function(){var e,t;(null==b?void 0:b.current)&&(null==E?void 0:E.current)&&(k(!0),p((null==b||null===(e=b.current)||void 0===e?void 0:e.getBoundingClientRect().height)<(null==E||null===(t=E.current)||void 0===t?void 0:t.getBoundingClientRect().height)))}),[_]);var T=function(t){e.onClick&&e.onClick(t),i((function(t){var r=!t;return e.onExpand&&e.onExpand(r),r}))};return c||e.forceShowMore?(0,u.h)("div",{className:[e.className,n?e.classNameExpanded:""].join(" ")},n?e.children:(0,u.h)("div",{className:f().expandableText,style:{"-webkit-line-clamp":e.lines}},e.text),(0,u.h)(y,s()({onClick:function(e){T(e)},onKeyDown:function(e){e.keyCode!==g&&e.keyCode!==m||T(e)},isTextExpanded:n,readLessLabel:e.readLessLabel,readMoreLabel:e.readMoreLabel},e.buttonProps))):(0,u.h)("div",{className:f().contentText},(0,u.h)("div",{className:f().titleWrapper},(0,u.h)("div",{ref:b,style:{"-webkit-line-clamp":e.lines},className:f().expandableText},e.text),_?void 0:(0,u.h)("div",{ref:E,style:{"-webkit-line-clamp":e.lines+1},className:f().expandableText},e.text)))}));v.defaultProps={buttonProps:{}},v.displayName="ExpandableText"},"./src/components/expandable-text/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ExpandableText:function(){return n.ExpandableText}});var n=r("./src/components/expandable-text/expandable-text.tsx")},"./src/components/forward/forward.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{FORWARD_DEFAULT_STEP:function(){return j},Forward:function(){return B}});var n,a,i,s,o,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),P=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./src/components/icon/index.ts"),x=r("./src/utils/with-animation.tsx"),I=r("./src/components/player/index.ts"),w=r("./src/components/event-dispatcher/index.ts"),R=r("./src/components/logger/index.ts"),M=r("./src/components/tooltip/index.ts"),D=r("./src/components/button/index.ts"),O=r("./node_modules/react-redux/es/index.js"),L=r("./src/components/button-control/index.ts");function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}var U="Forward",j=10,B=(n=(0,O.connect)((function(e){return{isDvr:e.engine.isDvr,isLive:e.engine.isLive}})),a=(0,R.withLogger)(U),i=(0,w.withEventDispatcher)(U),s=(0,x.withAnimation)(A().reverseRotate),o=(0,P.withText)((function(e){return{forwardText:(0,S.h)(P.Text,{id:"controls.secondsForward",fields:{seconds:e.step||j}})}})),n(l=(0,I.withPlayer)(l=a(l=i(l=s(l=o(l=function(e){g()(r,e);var t=N(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"onClick",(function(){var t,r=e.props.player;e.props.animate();var n=e.props.step||j,a=r.currentTime,i=r.isLive()?r.liveDuration:r.duration;r.currentTime+n>i?r.isOnLiveEdge()||(t=i):t=r.currentTime+n,r.currentTime=t,e.props.notifyClick({from:a,to:t})})),e}return p()(r,[{key:"_shouldRender",value:function(){var e=!(this.props.isLive&&!this.props.isDvr);return this.props.onToggle(U,e),e}},{key:"render",value:function(e){var t=e.step,r=e.forwardText,n=e.innerRef;return this._shouldRender()?(0,S.h)(L.ButtonControl,{name:U,className:A().noIdleControl},(0,S.h)(M.Tooltip,{label:r},(0,S.h)(D.Button,{tabIndex:"0","aria-label":r,className:"".concat(A().controlButton),ref:n,onClick:this.onClick},(0,S.h)(C.Icon,{type:t&&t!==j?C.IconType.Forward:C.IconType.Forward10})))):void 0}}]),r}(S.Component))||l)||l)||l)||l)||l)||l);B.displayName=U},"./src/components/forward/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Forward:function(){return n.Forward}});var n=r("./src/components/forward/forward.tsx")},"./src/components/fullscreen/fullscreen.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Fullscreen:function(){return B}});var n,a,i,s,o,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),P=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./node_modules/react-redux/es/index.js"),x=r("./src/utils/key-map.ts"),I=r("./src/components/icon/index.ts"),w=r("./src/components/player/index.ts"),R=r("./src/components/keyboard/index.ts"),M=r("./src/components/logger/index.ts"),D=r("./src/components/tooltip/index.ts"),O=r("./src/components/event-dispatcher/index.ts"),L=r("./src/components/button/index.ts"),N=r("./src/components/button-control/index.ts");function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}var j="Fullscreen",B=(n=(0,C.connect)((function(e){return{isInFullscreen:e.engine.fullscreen}})),a=(0,M.withLogger)(j),i=(0,R.withKeyboardEvent)(j),s=(0,O.withEventDispatcher)(j),o=(0,P.withText)({fullscreenText:"controls.fullscreen",fullscreenExitText:"controls.fullscreenExit"}),n(l=(0,w.withPlayer)(l=a(l=i(l=s(l=o(l=function(e){g()(r,e);var t=U(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"_keyboardEventHandlers",[{key:{code:x.KeyMap.ENTER},action:function(t){e.handleKeydown(t)}},{key:{code:x.KeyMap.F},action:function(t){e.handleKeydown(t)}},{key:{code:x.KeyMap.ESC},action:function(t){e.handleKeydown(t)}}]),b()(f()(e),"handleKeydown",(function(t){switch(t.keyCode){case x.KeyMap.ENTER:t.preventDefault(),t.repeat||e.toggleFullscreen();case x.KeyMap.F:e.toggleFullscreen();break;case x.KeyMap.ESC:e.props.player.isFullscreen()&&e.toggleFullscreen()}})),b()(f()(e),"toggleFullscreen",(function(){var t=e.props,r=t.logger,n=t.player;r.debug("Toggle fullscreen"),n.isFullscreen()?n.exitFullscreen():n.enterFullscreen(),e.props.notifyClick()})),e}return p()(r,[{key:"componentDidMount",value:function(){this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"render",value:function(){return(0,S.h)(N.ButtonControl,{name:j},(0,S.h)(D.Tooltip,{label:this.props.isInFullscreen?this.props.fullscreenExitText:this.props.fullscreenText},(0,S.h)(L.Button,{tabIndex:"0","aria-label":this.props.isInFullscreen?this.props.fullscreenExitText:this.props.fullscreenText,className:this.props.isInFullscreen?[A().controlButton,A().isFullscreen].join(" "):A().controlButton,onKeyDown:this.handleKeydown,onClick:this.toggleFullscreen},(0,S.h)(I.Icon,{type:I.IconType.Maximize}),(0,S.h)(I.Icon,{type:I.IconType.Minimize}))))}}]),r}(S.Component))||l)||l)||l)||l)||l)||l);B.displayName=j},"./src/components/fullscreen/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Fullscreen:function(){return n.Fullscreen}});var n=r("./src/components/fullscreen/fullscreen.tsx")},"./src/components/gui-area/gui-area.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{GuiArea:function(){return A}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/components/player-area/index.ts"),E=r("./src/styles/style.scss"),b=r.n(E);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var A=(0,_.connect)((function(e){return{guiStyles:e.shell.layoutStyles.gui}}))(n=function(e){d()(r,e);var t=T(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"_ref",void 0),y()(u()(e),"_setRef",(function(t){t&&(e._ref=t,e.setState((function(e){return{render:!e.render}})))})),e}return o()(r,[{key:"shouldComponentUpdate",value:function(e,t){return e.guiStyles!==this.props.guiStyles||t.render!==this.state.render}},{key:"render",value:function(){var e=this.props,t=e.guiStyles,r=e.children,n=(0,v.toChildArray)(r),a=n[0],i=n[1];return(0,v.h)("div",{ref:this._setRef,style:t,className:b().guiArea},(0,v.h)("div",{style:{pointerEvents:"auto"}},(0,v.h)(k.PlayerArea,{name:"GuiArea"},a)),"function"==typeof i?i({containerRef:this._ref}):i)}}]),r}(v.Component))||n},"./src/components/gui-area/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{GuiArea:function(){return n.GuiArea}});var n=r("./src/components/gui-area/gui-area.tsx")},"./src/components/icon/icon.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{BadgeType:function(){return C},Icon:function(){return I},IconState:function(){return x},IconType:function(){return P}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./src/index.ts");function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var P={Maximize:"maximize",Minimize:"minimize",Play:"play",Pause:"pause",Stop:"stop",VolumeBase:"volume-base",VolumeWaves:"volume-waves",VolumeWave:"volume-wave",VolumeMute:"volume-mute",Close:"close",Settings:"settings",Check:"check",CheckActive:"check-active",Language:"language",Quality:"quality",Captions:"captions",Speed:"speed",SpeedDown:"speed-down",SpeedUp:"speed-up",Audio:"audio",ArrowDown:"arrow-down",StartOver:"start-over",SeekEnd:"seek-end",Rewind:"rewind",Rewind10:"rewind10",Forward:"forward",Forward10:"forward10",vrStereo:"vr-stereo",vrStereoFull:"vr-stereo-full",Cast:"cast",CastBrand:"cast-brand",Next:"next",Prev:"prev",PictureInPictureStart:"picture-in-picture-start",PictureInPictureStop:"picture-in-picture-stop",ClosedCaptionsOn:"closed-captions-on",ClosedCaptionsOff:"closed-captions-off",AdvancedAudioDescription:"advanced-audio-description",AdvancedAudioDescriptionActive:"advanced-audio-description-active"},C={qualityHd:"".concat(k().badgeIcon," ").concat(k().iconQualityHd),qualityHdActive:"".concat(k().badgeIcon," ").concat(k().iconQualityHdActive),quality4k:"".concat(k().badgeIcon," ").concat(k().iconQuality4K),quality4kActive:"".concat(k().badgeIcon," ").concat(k().iconQuality4KActive),quality8k:"".concat(k().badgeIcon," ").concat(k().iconQuality8K),quality8kActive:"".concat(k().badgeIcon," ").concat(k().iconQuality8KActive)},x={INACTIVE:0,ACTIVE:1},I=function(e){p()(r,e);var t=S(r);function r(e){var n;s()(this,r),n=t.call(this,e),v()(c()(n),"_defaultColor",k().white),v()(c()(n),"_activeColor",k().brandColor),v()(c()(n),"_className",""),v()(c()(n),"createDynamicIconClass",(function(e){var t=e.path,r=e.state,a=e.color,i=e.activeColor,s=e.width,o=e.height,l=e.viewBox,u=e.fillRule,c=n.getFillColor(r,a,i),d=n.getPathTag(t,c),p=n.getSVGUrl(d,s,o,l,u),h=".".concat(n._className," { background-image: ").concat(p,"; }"),f=document.getElementById(b.NAME);f&&f.appendChild(document.createTextNode(h))})),v()(c()(n),"getSVGUrl",(function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:36,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"nonzero",a='<svg xmlns="http://www.w3.org/2000/svg"  xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="'.concat(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"0 0 1024 1024",'" width="').concat(t,'" height="').concat(r,'" fill-rule="').concat(n,'">').concat(e,"</svg>"),i=[['"',"'"],["%","%25"],["&","%26"],["#","%23"],["{","%7B"],["}","%7D"],["<","%3C"],[">","%3E"]],s=2e3,o=Math.ceil(a.length/s),l=0,u="",c=0;c<o;c++){for(var d=a.slice(l,l+s-1),p=0;p<i.length;p++)d=d.split(i[p][0]).join(i[p][1]);u="".concat(u).concat(d),l+=s}return'url("data:image/svg+xml,'.concat(u,'")')})),v()(c()(n),"getFillColor",(function(e,t,r){return e===x.ACTIVE?r||n._activeColor:t||n._defaultColor})),v()(c()(n),"getPathTag",(function(e,t){return Array.isArray(e)||(e=[e]),e.map((function(e){var r="string"==typeof e?{d:e,fill:t}:A(A({},e),{},{fill:t}),n=Object.keys(r).map((function(e){return"".concat(e,'="').concat(r[e],'"')})).join(" ");return"<path ".concat(n," />")})).join(" ")}));var a=e.path,i=e.id;if(a&&i){n._className="playkit-icon-".concat(i);var o=Array.from(document.styleSheets).find((function(e){return e.ownerNode.id===b.NAME}));o&&Array.from(o.rules).find((function(e){return e.selectorText===".".concat(n._className)}))||n.createDynamicIconClass(e)}return n}return l()(r,[{key:"componentWillUpdate",value:function(e){this._className&&this.props.state!==e.state&&this.createDynamicIconClass(e)}},{key:"render",value:function(e){if(this._className)return(0,E.h)("i",a()({className:[k().icon,this._className].join(" ")},e.hidden?{"aria-hidden":"true"}:{}));switch(e.type){case P.Maximize:return(0,E.h)("i",{className:[k().icon,k().iconMaximize].join(" "),"aria-hidden":"true"});case P.Minimize:return(0,E.h)("i",{className:[k().icon,k().iconMinimize].join(" "),"aria-hidden":"true"});case P.Play:return(0,E.h)("i",{className:[k().icon,k().iconPlay].join(" "),"aria-hidden":"true"});case P.Pause:return(0,E.h)("i",{className:[k().icon,k().iconPause].join(" "),"aria-hidden":"true"});case P.Stop:return(0,E.h)("i",{className:[k().icon,k().iconStop].join(" "),"aria-hidden":"true"});case P.VolumeBase:return(0,E.h)("i",{className:[k().icon,k().iconVolumeBase].join(" "),"aria-hidden":"true"});case P.VolumeWaves:return(0,E.h)("i",{className:[k().icon,k().iconVolumeWaves].join(" "),"aria-hidden":"true"});case P.VolumeWave:return(0,E.h)("i",{className:[k().icon,k().iconVolumeWave].join(" "),"aria-hidden":"true"});case P.VolumeMute:return(0,E.h)("i",{className:[k().icon,k().iconVolumeMute].join(" "),"aria-hidden":"true"});case P.Close:return(0,E.h)("i",{className:[k().icon,k().iconClose].join(" "),"aria-hidden":"true"});case P.Settings:return(0,E.h)("i",{className:[k().icon,k().iconSettings].join(" "),"aria-hidden":"true"});case P.Check:return(0,E.h)("i",{className:[k().icon,k().iconCheck].join(" ")});case P.CheckActive:return(0,E.h)("i",{className:[k().icon,k().iconCheckActive].join(" ")});case P.Language:return(0,E.h)("i",{className:[k().icon,k().iconLanguage].join(" "),"aria-hidden":"true"});case P.Quality:return(0,E.h)("i",{className:[k().icon,k().iconQuality].join(" ")});case P.Captions:return(0,E.h)("i",{className:[k().icon,k().iconCaptions].join(" ")});case P.Speed:return(0,E.h)("i",{className:[k().icon,k().iconSpeed].join(" ")});case P.SpeedDown:return(0,E.h)("i",{className:[k().icon,k().iconSpeedDown].join(" ")});case P.SpeedUp:return(0,E.h)("i",{className:[k().icon,k().iconSpeedUp].join(" ")});case P.Audio:return(0,E.h)("i",{className:[k().icon,k().iconAudio].join(" ")});case P.ArrowDown:return(0,E.h)("i",{className:[k().icon,k().iconArrowDown].join(" ")});case P.StartOver:return(0,E.h)("i",{className:[k().icon,k().iconStartOver].join(" ")});case P.SeekEnd:return(0,E.h)("i",{className:[k().icon,k().iconSeekEnd].join(" ")});case P.Rewind:return(0,E.h)("i",{className:[k().icon,k().iconRewind].join(" "),"aria-hidden":"true"});case P.Rewind10:return(0,E.h)("i",{className:[k().icon,k().iconRewind10].join(" "),"aria-hidden":"true"});case P.Forward:return(0,E.h)("i",{className:[k().icon,k().iconForward].join(" "),"aria-hidden":"true"});case P.Forward10:return(0,E.h)("i",{className:[k().icon,k().iconForward10].join(" "),"aria-hidden":"true"});case P.vrStereo:return(0,E.h)("i",{className:[k().icon,k().iconVrStereo].join(" ")});case P.vrStereoFull:return(0,E.h)("i",{className:[k().icon,k().iconVrStereoFull].join(" ")});case P.Cast:return(0,E.h)("i",{className:[k().icon,k().iconChromecast].join(" ")});case P.CastBrand:return(0,E.h)("i",{className:[k().icon,k().iconChromecastBrand].join(" ")});case P.Next:return(0,E.h)("i",{className:[k().icon,k().iconNext].join(" ")});case P.Prev:return(0,E.h)("i",{className:[k().icon,k().iconPrev].join(" ")});case P.PictureInPictureStart:return(0,E.h)("i",{className:[k().icon,k().iconPictureInPictureStart].join(" "),"aria-hidden":"true"});case P.PictureInPictureStop:return(0,E.h)("i",{className:[k().icon,k().iconPictureInPictureStop].join(" "),"aria-hidden":"true"});case P.ClosedCaptionsOn:return(0,E.h)("i",{className:[k().icon,k().iconClosedCaptionsOn].join(" "),"aria-hidden":"true"});case P.ClosedCaptionsOff:return(0,E.h)("i",{className:[k().icon,k().iconClosedCaptionsOff].join(" "),"aria-hidden":"true"});case P.AdvancedAudioDescription:return(0,E.h)("i",{className:[k().icon,k().iconAdvancedAudioDescription].join(" ")});case P.AdvancedAudioDescriptionActive:return(0,E.h)("i",{className:[k().icon,k().iconAdvancedAudioDescriptionActive].join(" ")})}}}]),r}(E.Component);t.default=I},"./src/components/icon/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BadgeType:function(){return n.BadgeType},Icon:function(){return n.Icon},IconState:function(){return n.IconState},IconType:function(){return n.IconType}});var n=r("./src/components/icon/icon.tsx");t.default=n.default},"./src/components/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLearnMore:function(){return h.AdLearnMore},AdNotice:function(){return m.AdNotice},AdSkip:function(){return f.AdSkip},AdvancedAudioDesc:function(){return ue.AdvancedAudioDesc},AdvancedAudioDescToggle:function(){return le.AdvancedAudioDescToggle},AudioMenu:function(){return ae.AudioMenu},BadgeType:function(){return A.BadgeType},BaseComponent:function(){return g.BaseComponent},BottomBar:function(){return y.BottomBar},Button:function(){return re.Button},ButtonControl:function(){return te.ButtonControl},CVAAOverlay:function(){return v.CVAAOverlay},CaptionsControl:function(){return _e.CaptionsControl},CaptionsMenu:function(){return ie.CaptionsMenu},Cast:function(){return n.Cast},CastAfterPlay:function(){return Y.CastAfterPlay},CastBeforePlay:function(){return Y.CastBeforePlay},CastControl:function(){return n.Cast},CastOverlay:function(){return q.CastOverlay},ClosedCaptions:function(){return p.ClosedCaptions},ClosedCaptionsControl:function(){return p.ClosedCaptions},CopyButton:function(){return ee.CopyButton},DropDown:function(){return _.DropDown},EngineConnector:function(){return k.EngineConnector},ErrorOverlay:function(){return E.ErrorOverlay},EventDispatcherProvider:function(){return b.EventDispatcherProvider},ExpandableText:function(){return ce.ExpandableText},Forward:function(){return o.Forward},ForwardControl:function(){return o.Forward},Fullscreen:function(){return a.Fullscreen},FullscreenControl:function(){return a.Fullscreen},GuiArea:function(){return ge.GuiArea},HeightResolution:function(){return oe.HeightResolution},Icon:function(){return A.Icon},IconState:function(){return A.IconState},IconType:function(){return A.IconType},InteractiveArea:function(){return ye.InteractiveArea},Keyboard:function(){return T.Keyboard},KeyboardControl:function(){return T.Keyboard},KeyboardEventProvider:function(){return T.KeyboardEventProvider},LiveTag:function(){return S.LiveTag},Loading:function(){return P.Loading},Logo:function(){return z.Logo},Menu:function(){return C.Menu},Overlay:function(){return x.Overlay},OverlayAction:function(){return I.OverlayAction},OverlayPortal:function(){return w.OverlayPortal},PLAYER_BREAK_POINTS:function(){return N.PLAYER_BREAK_POINTS},PLAYER_SIZE:function(){return N.PLAYER_SIZE},PictureInPicture:function(){return Q.PictureInPicture},PlayPause:function(){return i.PlayPause},PlayPauseControl:function(){return i.PlayPause},PlaybackControls:function(){return J.PlaybackControls},PlayerArea:function(){return fe.PlayerArea},PlayerProvider:function(){return R.PlayerProvider},PlaylistButton:function(){return X.PlaylistButton},PlaylistNextScreen:function(){return Z.PlaylistNextScreen},PrePlaybackPlayOverlay:function(){return M.PrePlaybackPlayOverlay},PrevNext:function(){return X.PrevNext},ProgressIndicator:function(){return pe.ProgressIndicator},QualityMenu:function(){return oe.QualityMenu},Remove:function(){return fe.Remove},Rewind:function(){return s.Rewind},RewindControl:function(){return s.Rewind},Scrollable:function(){return de.Scrollable},SeekBar:function(){return l.SeekBar},SeekBarControl:function(){return l.SeekBar},SeekBarLivePlaybackContainer:function(){return D.SeekBarLivePlaybackContainer},SeekBarPlaybackContainer:function(){return O.SeekBarPlaybackContainer},SeekBarPreview:function(){return he.SeekBarPreview},Settings:function(){return u.Settings},SettingsControl:function(){return u.Settings},Shell:function(){return N.Shell},SidePanel:function(){return ve.SidePanel},Slider:function(){return U.Slider},SmartContainer:function(){return j.SmartContainer},SmartContainerItem:function(){return j.SmartContainerItem},SpeedMenu:function(){return se.SpeedMenu},TimeDisplay:function(){return B.TimeDisplay},TimeDisplayAdsContainer:function(){return F.TimeDisplayAdsContainer},TimeDisplayPlaybackContainer:function(){return V.TimeDisplayPlaybackContainer},ToggleSwitch:function(){return ne.ToggleSwitch},ToolTipType:function(){return G.ToolTipType},Tooltip:function(){return G.Tooltip},TopBar:function(){return H.TopBar},UnmuteIndication:function(){return K.UnmuteIndication},VideoArea:function(){return me.VideoArea},VideoPlayer:function(){return W.VideoPlayer},Volume:function(){return c.Volume},VolumeControl:function(){return c.Volume},VrStereo:function(){return d.VrStereo},VrStereoControl:function(){return d.VrStereo},Watermark:function(){return $.Watermark},getLabelBadgeType:function(){return oe.getLabelBadgeType},withEventDispatcher:function(){return b.withEventDispatcher},withKeyboardEvent:function(){return T.withKeyboardEvent},withLogger:function(){return L.withLogger},withPlayer:function(){return R.withPlayer},withPlayerPreset:function(){return fe.withPlayerPreset}});var n=r("./src/components/cast/index.ts"),a=r("./src/components/fullscreen/index.ts"),i=r("./src/components/play-pause/index.ts"),s=r("./src/components/rewind/index.ts"),o=r("./src/components/forward/index.ts"),l=r("./src/components/seekbar/index.ts"),u=r("./src/components/settings/index.ts"),c=r("./src/components/volume/index.ts"),d=r("./src/components/vr-stereo/index.ts"),p=r("./src/components/closed-captions/index.ts"),h=r("./src/components/ad-learn-more/index.ts"),f=r("./src/components/ad-skip/index.ts"),m=r("./src/components/ad-notice/index.tsx"),g=r("./src/components/base.tsx"),y=r("./src/components/bottom-bar/index.ts"),v=r("./src/components/cvaa-overlay/index.ts"),_=r("./src/components/dropdown/index.ts"),k=r("./src/components/engine-connector/index.ts"),E=r("./src/components/error-overlay/index.ts"),b=r("./src/components/event-dispatcher/index.ts"),T=r("./src/components/keyboard/index.ts"),A=r("./src/components/icon/index.ts"),S=r("./src/components/live-tag/index.ts"),P=r("./src/components/loading/index.ts"),C=r("./src/components/menu/index.ts"),x=r("./src/components/overlay/index.ts"),I=r("./src/components/overlay-action/index.ts"),w=r("./src/components/overlay-portal/index.ts"),R=r("./src/components/player/index.ts"),M=r("./src/components/pre-playback-play-overlay/index.ts"),D=r("./src/components/seekbar-live-playback-container/index.ts"),O=r("./src/components/seekbar-playback-container/index.ts"),L=r("./src/components/logger/index.ts"),N=r("./src/components/shell/index.ts"),U=r("./src/components/slider/index.ts"),j=r("./src/components/smart-container/index.ts"),B=r("./src/components/time-display/index.ts"),F=r("./src/components/time-display-ads-container/index.ts"),V=r("./src/components/time-display-playback-container/index.ts"),G=r("./src/components/tooltip/index.ts"),H=r("./src/components/top-bar/index.ts"),K=r("./src/components/unmute-indication/index.ts"),W=r("./src/components/video-player/index.ts"),$=r("./src/components/watermark/index.ts"),z=r("./src/components/logo/index.ts"),q=r("./src/components/cast-overlay/index.ts"),Y=r("./src/components/cast-on-tv/index.ts"),X=r("./src/components/playlist-button/index.ts"),Z=r("./src/components/playlist-next-screen/index.ts"),Q=r("./src/components/picture-in-picture/index.ts"),J=r("./src/components/playback-controls/index.ts"),ee=r("./src/components/copy-button/index.ts"),te=r("./src/components/button-control/index.ts"),re=r("./src/components/button/index.ts"),ne=r("./src/components/toggle-switch/index.ts"),ae=r("./src/components/audio-menu/index.ts"),ie=r("./src/components/captions-menu/index.ts"),se=r("./src/components/speed-menu/index.ts"),oe=r("./src/components/quality-menu/index.ts"),le=r("./src/components/advanced-audio-desc-toggle/index.ts"),ue=r("./src/components/advanced-audio-desc/index.ts"),ce=r("./src/components/expandable-text/index.ts"),de=r("./src/components/scrollable/index.ts"),pe=r("./src/components/progress-indicator/index.ts"),he=r("./src/components/seekbar-preview/index.ts"),fe=r("./src/components/player-area/index.ts"),me=r("./src/components/video-area/index.ts"),ge=r("./src/components/gui-area/index.ts"),ye=r("./src/components/interactive-area/index.ts"),ve=r("./src/components/side-panel/index.ts"),_e=r("./src/components/captions-control/index.ts")},"./src/components/interactive-area/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{InteractiveArea:function(){return n.InteractiveArea}});var n=r("./src/components/interactive-area/interactive-area.tsx")},"./src/components/interactive-area/interactive-area.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{InteractiveArea:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./src/components/player/index.ts"),g=r("./src/styles/style.scss"),y=r.n(g),v=r("./src/components/player-area/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,m.withPlayer)(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this.props.children;return(0,f.h)("div",{className:y().interactiveArea},(0,f.h)("div",{style:{pointerEvents:"auto"}},(0,f.h)(v.PlayerArea,{name:"InteractiveArea"},e)))}}]),r}(f.Component))||n},"./src/components/keyboard/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Keyboard:function(){return n.Keyboard},KeyboardEventProvider:function(){return i.KeyboardEventProvider},withKeyboardEvent:function(){return a.withKeyboardEvent}});var n=r("./src/components/keyboard/keyboard.tsx"),a=r("./src/components/keyboard/with-keyboard-event.tsx"),i=r("./src/components/keyboard/keyboard-event-provider.tsx")},"./src/components/keyboard/keyboard-event-provider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{KEYBOARD_EVENTS:function(){return S},KeyboardEventProvider:function(){return P}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./src/event/with-event-manager.tsx"),b=r("./src/components/logger/index.ts"),T=r("./node_modules/react-redux/es/index.js");function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var S=["keydown","keyup"],P=(n=(0,T.connect)((function(e){return{playerNav:e.shell.playerNav,overlayOpen:e.overlay.isOpen}})),a=(0,b.withLogger)("KEYBOARD_PROVIDER"),n(i=(0,E.withEventManager)(i=a(i=function(e){h()(r,e);var t=A(r);function r(){for(var e,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return o()(this,r),e=t.call.apply(t,[this].concat(a)),_()(d()(e),"_keyboardListeners",[]),_()(d()(e),"_isKeyboardEnable",!1),_()(d()(e),"_componentToHandle",null),_()(d()(e),"keyEventHandler",void 0),_()(d()(e),"_addKeyboardHandler",(function(t,r,n,a){var i=e._createKeyCode(r,n);e._keyboardListeners[i]?e.props.logger.warn("Combination of key ".concat(n.code," altKey ").concat((!!n.altKey).toString()," ctrlKey ").concat((!!n.ctrlKey).toString(),"\n      metaKey ").concat((!!n.metaKey).toString()," shiftKey ").concat((!!n.shiftKey).toString()," already exist")):e._keyboardListeners[i]={callback:a,componentName:t}})),_()(d()(e),"_removeKeyboardHandler",(function(t,r){var n=e._createKeyCode(t,r);e._keyboardListeners[n]&&delete e._keyboardListeners[n]})),_()(d()(e),"_updateIsKeyboardEnabled",(function(t){e._isKeyboardEnable=t})),_()(d()(e),"_setKeyboardEventToScope",(function(t){e._componentToHandle=t})),e}return u()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.eventManager,n=t.playerContainer;this.keyEventHandler=this._keyEventHandler.bind(this),S.forEach((function(t){r.listen(n,t,e.keyEventHandler)}))}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"_keyEventHandler",value:function(e){var t=this._createKeyCode(e.type,{code:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey}),r=e.target instanceof Node&&e.target.nodeName||"";-1!==["INPUT","SELECT","TEXTAREA"].indexOf(r)||!this._shouldHandleKeyboardEvents()||!this._keyboardListeners[t]||"function"!=typeof this._keyboardListeners[t].callback||this._componentToHandle&&this._keyboardListeners[t].componentName!==this._componentToHandle||(e.preventDefault(),e.stopPropagation(),this._keyboardListeners[t].callback(e))}},{key:"_shouldHandleKeyboardEvents",value:function(){return this._isKeyboardEnable&&!this.props.playerNav&&!this.props.overlayOpen}},{key:"_createKeyCode",value:function(e,t){var r=S.indexOf(e),n=t.altKey?1:0,a=t.ctrlKey?1:0,i=t.metaKey?1:0,s=t.shiftKey?1:0;return parseInt(""+r+t.code+n+a+i+s)}},{key:"getChildContext",value:function(){return{addKeyboardHandler:this._addKeyboardHandler,removeKeyboardHandler:this._removeKeyboardHandler,updateIsKeyboardEnabled:this._updateIsKeyboardEnabled,setKeyboardEventToScope:this._setKeyboardEventToScope}}},{key:"render",value:function(){return this.props.children&&(0,k.toChildArray)(this.props.children)[0]||null}}]),r}(k.Component))||i)||i)||i)},"./src/components/keyboard/keyboard.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{KEYBOARD_DEFAULT_SEEK_JUMP:function(){return O},KEYBOARD_DEFAULT_VOLUME_JUMP:function(){return L},Keyboard:function(){return j}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./node_modules/react-redux/es/index.js"),T=r("./src/reducers/shell.ts"),A=r("./src/reducers/overlay-action.ts"),S=r("./src/utils/bind-actions.ts"),P=r("./src/utils/key-map.ts"),C=r("./src/components/icon/index.ts"),x=r("./src/reducers/getters.ts"),I=r("./src/components/player/index.ts"),w=r("./src/components/event-dispatcher/index.ts"),R=r("./src/components/logger/index.ts");function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var O=5,L=5,N="Keyboard",U={preventDefault:!1,payload:null},j=(n=(0,b.connect)((function(e){return{isPlayingAdOrPlayback:(0,x.isPlayingAdOrPlayback)(e.engine),playerNav:e.shell.playerNav,textTracks:e.engine.textTracks,overlayOpen:e.overlay.isOpen}}),(0,S.bindActions)(Object.assign({},T.actions,A.actions))),a=(0,R.withLogger)(N),i=(0,w.withEventDispatcher)(N),n(s=(0,I.withPlayer)(s=a(s=i(s=function(e){f()(r,e);var t=D(r);function r(e){var n,a;l()(this,r),a=t.call(this),k()(p()(a),"_lastActiveTextLanguage",""),k()(p()(a),"_hoverTimeout",null),k()(p()(a),"keyboardHandlers",(n={},k()(n,P.KeyMap.SPACE,(function(){return a.props.isPlayingAdOrPlayback?(a.props.player.pause(),a.props.updateOverlayActionIcon(C.IconType.Pause)):(a.props.player.play(),a.props.updateOverlayActionIcon(C.IconType.Play)),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:!0}})),k()(n,P.KeyMap.UP,(function(){var e=(Math.round(100*a.props.player.volume)+L)/100;return e=e>1?1:e,a.props.logger.debug("Changing volume. ".concat(a.props.player.volume," => ").concat(e)),a.props.player.muted&&(a.props.player.muted=!1),a.props.player.volume=e,a.props.updateOverlayActionIcon([C.IconType.VolumeBase,C.IconType.VolumeWaves]),{preventDefault:!0,payload:{volume:a.props.player.volume}}})),k()(n,P.KeyMap.DOWN,(function(){var e=(Math.round(100*a.props.player.volume)-L)/100;return e=e<0?0:e,a.props.logger.debug("Changing volume. ".concat(a.props.player.volume," => ").concat(e)),a.props.player.volume=e,0===e?(a.props.player.muted=!0,a.props.updateOverlayActionIcon([C.IconType.VolumeBase,C.IconType.VolumeMute])):a.props.updateOverlayActionIcon([C.IconType.VolumeBase,C.IconType.VolumeWave]),{preventDefault:!0,payload:{volume:a.props.player.volume}}})),k()(n,P.KeyMap.F,(function(){return a.props.player.isFullscreen()?{preventDefault:!0,payload:null}:(a.props.logger.debug("Enter fullscreen"),a.props.player.enterFullscreen(),{preventDefault:!0,payload:!0})})),k()(n,P.KeyMap.P,(function(){return a.props.player.isInPictureInPicture()?(a.props.logger.debug("Exit Picture In Picture"),a.props.player.exitPictureInPicture()):(a.props.logger.debug("Enter Picture In Picture"),a.props.player.enterPictureInPicture()),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:!0}})),k()(n,P.KeyMap.ESC,(function(){return a.props.player.isFullscreen()?(a.props.logger.debug("Exit fullscreen"),a.props.player.exitFullscreen(),{preventDefault:!0,payload:!0}):{preventDefault:!0,payload:null}})),k()(n,P.KeyMap.LEFT,(function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime-O,t=a.props.player.currentTime,r=e>0?e:0;return a.props.logger.debug("Seek. ".concat(t," => ").concat(r)),a.props.player.currentTime=r,a.props.updateOverlayActionIcon(C.IconType.Rewind),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:t,to:r}}}return{preventDefault:!0,payload:null}})),k()(n,P.KeyMap.RIGHT,(function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime+O,t=a.props.player.currentTime,r=e>a.props.player.duration?a.props.player.duration:e;return a.props.logger.debug("Seek. ".concat(t," => ").concat(r)),a.props.player.currentTime=e>a.props.player.duration?a.props.player.duration:e,a.props.updateOverlayActionIcon(C.IconType.Forward),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:t,to:r}}}return{preventDefault:!0,payload:null}})),k()(n,P.KeyMap.HOME,(function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime;return a.props.logger.debug("Seek. ".concat(e," => ").concat(0)),a.props.player.currentTime=0,a.props.updateOverlayActionIcon(C.IconType.StartOver),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:e,to:0}}}return{preventDefault:!0,payload:null}})),k()(n,P.KeyMap.END,(function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime,t=a.props.player.duration;return a.props.logger.debug("Seek. ".concat(e," => ").concat(t)),a.props.player.currentTime=t,a.props.updateOverlayActionIcon(C.IconType.SeekEnd),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:e,to:t}}}return{preventDefault:!0,payload:null}})),k()(n,P.KeyMap.M,(function(){return a.props.logger.debug(a.props.player.muted?"Umnute":"Mute"),a.props.player.muted=!a.props.player.muted,a.props.player.muted?a.props.updateOverlayActionIcon([C.IconType.VolumeBase,C.IconType.VolumeMute]):a.props.updateOverlayActionIcon([C.IconType.VolumeBase,C.IconType.VolumeWaves]),{preventDefault:!0,payload:!0}})),k()(n,P.KeyMap.SEMI_COLON,(function(e){return e.shiftKey?a.props.player.playbackRate!==a.props.player.defaultPlaybackRate?(a.props.logger.debug("Changing playback rate. ".concat(a.props.player.playbackRate," => ").concat(a.props.player.defaultPlaybackRate)),a.props.player.playbackRate=a.props.player.defaultPlaybackRate,a.props.updateOverlayActionIcon(C.IconType.Speed),{preventDefault:!0,payload:{speed:a.props.player.defaultPlaybackRate}}):{preventDefault:!0,payload:null}:U})),k()(n,P.KeyMap.PERIOD,(function(e){if(e.shiftKey){var t=a.props.player.playbackRate,r=a.props.player.playbackRates.indexOf(t);return r<a.props.player.playbackRates.length-1?(a.props.logger.debug("Changing playback rate. ".concat(t," => ").concat(a.props.player.playbackRates[r+1])),a.props.player.playbackRate=a.props.player.playbackRates[r+1],a.props.updateOverlayActionIcon(C.IconType.SpeedUp),{preventDefault:!0,payload:{speed:a.props.player.playbackRates[r+1]}}):{preventDefault:!0,payload:null}}return U})),k()(n,P.KeyMap.COMMA,(function(e){if(e.shiftKey){var t=a.props.player.playbackRate,r=a.props.player.playbackRates.indexOf(t);return r>0?(a.props.logger.debug("Changing playback rate. ".concat(t," => ").concat(a.props.player.playbackRates[r-1])),a.props.player.playbackRate=a.props.player.playbackRates[r-1],a.props.updateOverlayActionIcon(C.IconType.SpeedDown),{preventDefault:!0,payload:{speed:a.props.player.playbackRates[r-1]}}):{preventDefault:!0,payload:null}}return U})),k()(n,P.KeyMap.C,(function(e){var t=a.props.player.getActiveTracks().text;if(e.altKey||e.shiftKey||e.ctrlKey||e.metaKey)return U;if(t){if("off"===t.language&&a._lastActiveTextLanguage){a.props.logger.debug("Changing text track to language",a._lastActiveTextLanguage);var r=a.props.player.getTracks("text").find((function(e){return e.language===a._lastActiveTextLanguage}));return a.props.player.selectTrack(r),{preventDefault:!0,payload:{track:r}}}"off"===t.language||a._lastActiveTextLanguage||(a.props.logger.debug("Hiding text track"),a._lastActiveTextLanguage=t.language,a.props.player.hideTextTrack())}return{preventDefault:!0,payload:null}})),n));var i=document.getElementById(e.config.targetId);return i?(i.onkeydown=function(e){var t=e.target instanceof Node&&e.target.nodeName||"";if(-1===["INPUT","SELECT","TEXTAREA"].indexOf(t)&&!a.props.overlayOpen&&!a.props.playerNav&&"function"==typeof a.keyboardHandlers[e.keyCode]){a.props.logger.debug("KeyDown -> keyName: ".concat((0,P.getKeyName)(e.keyCode),", shiftKey: ").concat(e.shiftKey.toString()));var r=a.keyboardHandlers[e.keyCode](e),n=r.preventDefault,i=r.payload;n&&e.preventDefault(),i&&a.props.notifyClick(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({key:e.keyCode},i))}},a):g()(a)}return c()(r,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.textTracks.find((function(e){return e.active})),r=e.textTracks.find((function(e){return e.active}));t&&"off"!==t.language&&r&&"off"===r.language?this._lastActiveTextLanguage=t.language:r&&"off"!==r.language&&(this._lastActiveTextLanguage="")}},{key:"render",value:function(){}}]),r}(E.Component))||s)||s)||s)||s)},"./src/components/keyboard/with-keyboard-event.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withKeyboardEvent:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/components/keyboard/keyboard-event-provider.tsx");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){return function(t){return function(r){p()(i,r);var n=E(i);function i(){var t;s()(this,i);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=n.call.apply(n,[this].concat(a)),v()(c()(t),"keyboardEventHandlers",[]),v()(c()(t),"_updateIsKeyboardEnabled",(function(e){t.context.updateIsKeyboardEnabled(e)})),v()(c()(t),"_setKeyboardEventToScope",(function(r){r?t.context.setKeyboardEventToScope(e):t.context.setKeyboardEventToScope(null)})),t}return l()(i,[{key:"componentDidMount",value:function(){var t=this;this.keyboardEventHandlers.forEach((function(r){var n=r.eventType?r.eventType:k.KEYBOARD_EVENTS[0];t._addKeyboardHandler(e,n,r.key,r.action)}))}},{key:"componentWillUnmount",value:function(){var e=this;this.keyboardEventHandlers.forEach((function(t){var r=t.eventType?t.eventType:k.KEYBOARD_EVENTS[0];e._removeKeyboardHandler(r,t.key)}))}},{key:"registerKeyboardEvents",value:function(e){this.keyboardEventHandlers=e}},{key:"_addKeyboardHandler",value:function(e,t,r,n){this.context.addKeyboardHandler(e,t,r,n)}},{key:"_removeKeyboardHandler",value:function(e,t){this.context.removeKeyboardHandler(e,t)}},{key:"render",value:function(){var e=this;return(0,_.h)(t,a()({},this.props,{setKeyboardEventToScope:function(t){return e._setKeyboardEventToScope(t)},updateIsKeyboardEnabled:function(t){return e._updateIsKeyboardEnabled(t)},registerKeyboardEvents:function(t){return e.registerKeyboardEvents(t)}}))}}]),i}(_.Component)}}},"./src/components/live-tag/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{LiveTag:function(){return n.LiveTag}});var n=r("./src/components/live-tag/live-tag.tsx")},"./src/components/live-tag/live-tag.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{LiveTag:function(){return M}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/key-map.ts"),P=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./src/components/player/index.ts"),x=r("./src/components/event-dispatcher/index.ts"),I=r("./src/components/logger/index.ts");function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var R="LiveTag",M=(n=(0,A.connect)((function(e){return{isLive:e.engine.isLive,isDvr:e.engine.isDvr,currentTime:e.engine.currentTime,duration:e.engine.duration}})),a=(0,I.withLogger)(R),i=(0,x.withEventDispatcher)(R),n(s=(0,C.withPlayer)(s=a(s=i(s=function(e){f()(r,e);var t=w(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"onKeyDown",(function(t){t.keyCode===S.KeyMap.ENTER&&e.onClick()})),k()(p()(e),"onClick",(function(){e.isOnLiveEdge()||(e.props.player.seekToLiveEdge(),e.props.player.paused&&e.props.player.play()),e.props.notifyClick()})),e}return c()(r,[{key:"isOnLiveEdge",value:function(){return this.props.player.isOnLiveEdge()}},{key:"render",value:function(e){var t=[b().liveTag];return e.isDvr&&!this.isOnLiveEdge()&&t.push(b().nonLivePlayhead),(0,T.h)("div",{tabIndex:0,className:t.join(" "),onClick:this.onClick,onKeyDown:this.onKeyDown},(0,T.h)(P.Text,{id:"controls.live"}))}}]),r}(T.Component))||s)||s)||s)||s);M.displayName=R},"./src/components/loading/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Loading:function(){return n.Loading}});var n=r("./src/components/loading/loading.tsx")},"./src/components/loading/loading.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Loading:function(){return w}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./src/styles/style.scss"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/utils/index.ts"),E=r("./src/reducers/loading.ts"),b=r("./src/components/player/index.ts"),T=r("./src/event/index.ts"),A=r("./src/components/logger/index.ts"),S=r("./src/components/player-area/index.ts"),P=r("./src/components/spinner/index.ts"),C=r("./src/reducers/shell.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var I="Loading",w=(n=(0,_.connect)((function(e){return{show:e.loading.show,isMobile:e.shell.isMobile,adBreak:e.engine.adBreak,adIsLinear:e.engine.adIsLinear}}),(0,k.bindActions)(E.actions)),a=(0,A.withLogger)(I),n(i=(0,b.withPlayer)(i=(0,T.withEventManager)(i=a(i=function(e){d()(r,e);var t=x(r);function r(){return o()(this,r),t.call(this)}return u()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.player,n=t.eventManager;n.listen(r,r.Event.PLAYER_STATE_CHANGED,(function(t){var n=r.State;t.payload.newState.type===n.IDLE||t.payload.newState.type===n.PLAYING||t.payload.newState.type===n.PAUSED?e.props.updateLoadingSpinnerState(!1):e.props.updateLoadingSpinnerState(!0)})),n.listen(r,r.Event.AD_BREAK_START,(function(){e.props.updateLoadingSpinnerState(!0)})),n.listen(r,r.Event.AD_PROGRESS,(function(){e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.AD_STARTED,(function(){e.props.adIsLinear&&e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.ALL_ADS_COMPLETED,(function(){e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.AUTOPLAY_FAILED,(function(){e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.PLAYING,(function(){e.props.updateLoadingSpinnerState(!1)}))}},{key:"render",value:function(e){if(e.show)return(0,v.h)("div",{className:[y().loadingBackdrop,y().show].join(" ")},(0,v.h)("div",{className:y().spinnerContainer},(0,v.h)(S.PlayerArea,{name:C.ReservedPresetAreas.LoadingSpinner},(0,v.h)(P.Spinner,null))))}}]),r}(v.Component))||i)||i)||i)||i);w.displayName=I},"./src/components/logger/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{withLogger:function(){return n.withLogger}});var n=r("./src/components/logger/with-logger.tsx")},"./src/components/logger/with-logger.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withLogger:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/utils/logger.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){return function(t){return function(r){p()(i,r);var n=E(i);function i(t){var r;return s()(this,i),r=n.call(this),v()(c()(r),"logger",void 0),r.logger=(0,k.default)("UI ".concat(e)),r.logger.debug("Initialized"),r}return l()(i,[{key:"render",value:function(){return(0,_.h)(t,a()({},this.props,{logger:this.logger}))}}]),i}(_.Component)}}},"./src/components/logo/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Logo:function(){return n.Logo}});var n=r("./src/components/logo/logo.tsx")},"./src/components/logo/logo.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Logo:function(){return L}});var n,a,i,s,o,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/react-redux/es/index.js"),P=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./src/components/player/index.ts"),x=r("./src/components/logger/index.ts"),I=r("./src/event/index.ts"),w=r("./src/components/event-dispatcher/index.ts"),R=r("./src/utils/index.ts");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}var D="Logo",O="{entryId}",L=(n=(0,S.connect)((function(e){return{isMobile:e.shell.isMobile,playerSize:e.shell.playerSize,config:e.config.components.logo}})),a=(0,x.withLogger)(D),i=(0,w.withEventDispatcher)(D),s=(0,P.withText)({logoText:"controls.logo"}),n(o=(0,C.withPlayer)(o=(0,I.withEventManager)(o=a(o=i(o=s(o=function(e){m()(r,e);var t=M(r);function r(e){var n;return u()(this,r),n=t.call(this,e),E()(h()(n),"_handleKeyDown",(function(e){e.keyCode!==R.KeyMap.ENTER&&e.keyCode!==R.KeyMap.SPACE||(window.open(n.state.urlLink,"_blank"),e.preventDefault(),n._handleOnClick())})),E()(h()(n),"_handleOnClick",(function(){n.props.notifyClick({logoUrl:n.state.urlLink})})),n.setState({isUrlClickable:"string"==typeof e.config.url,urlLink:e.config.url}),n}return d()(r,[{key:"componentDidMount",value:function(){this._handleLogoUrl()}},{key:"_handleLogoUrl",value:function(){var e=this,t=this.props.config.url;if(t&&-1!==t.indexOf(O)){var r=this.props,n=r.player,a=r.eventManager;this._setLogoUrlWithEntryId(t)||a.listen(n,n.Event.MEDIA_LOADED,(function(){e._setLogoUrlWithEntryId(t)}))}}},{key:"_setLogoUrlWithEntryId",value:function(e){var t=this.props.player.sources.id;return"string"==typeof t?(this.setState({urlLink:e.replace(O,t),isUrlClickable:!0}),!0):(this.props.logger.debug("Logo url was not replaced; entry id was not found."),this.setState({isUrlClickable:!1}),!1)}},{key:"_shouldRender",value:function(){var e=!(0===Object.keys(this.props.config).length&&this.props.config.constructor===Object)&&this.props.config.img;return this.props.onToggle(D,e),e}},{key:"render",value:function(e){if(this._shouldRender())return(0,A.h)("div",{className:[T().controlButtonContainer,e.config.url&&this.state.isUrlClickable?"":T().emptyUrl].join(" "),title:e.config.text},this.state.isUrlClickable?(0,A.h)("a",{onClick:this._handleOnClick,onKeyDown:this._handleKeyDown,className:T().controlButton,href:this.state.urlLink,"aria-label":e.config.text||e.logoText,target:"_blank",rel:"noopener noreferrer",tabIndex:0},(0,A.h)("img",{className:T().icon,src:e.config.img,alt:""})):(0,A.h)("span",{className:T().controlButton,"aria-label":e.config.text||e.logoText},(0,A.h)("img",{className:T().icon,src:e.config.img,alt:""})))}}]),r}(A.Component))||o)||o)||o)||o)||o)||o);L.displayName=D},"./src/components/menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Menu:function(){return n.Menu}});var n=r("./src/components/menu/menu.tsx")},"./src/components/menu/menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Menu:function(){return x}});var n,a=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./src/components/icon/index.ts"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/index.ts"),P=r("./src/event/index.ts");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var x=(0,A.connect)((function(e){return{isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,guiClientRect:e.shell.guiClientRect,topBarClientRect:e.shell.topBarClientRect}}))(n=(0,P.withEventManager)(n=(0,S.withKeyboardA11y)(n=function(e){h()(r,e);var t=C(r);function r(){var e;o()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"_menuElement",void 0),_()(d()(e),"handleClickOutside",(function(t){e.props.isMobile||e.props.isSmallSize||!e._menuElement||e._menuElement.contains(t.target)||e.props.onClose()})),_()(d()(e),"onChange",(function(t){var r=Number(t.target.value);if(r<e.props.options.length){var n=e.props.options[r];n&&e.onSelect(n)}else{var a,i=r-e.props.options.length,s=null===(a=e.props.additionalOptions)||void 0===a?void 0:a[i];s&&e.props.onMenuChosen(s.value)}})),e}return u()(r,[{key:"componentWillMount",value:function(){this.setState({position:[E().top,E().left]})}},{key:"componentDidMount",value:function(){this.props.eventManager.listen(document,"click",this.handleClickOutside),this.props.isMobile||this.props.isSmallSize||this.setState({position:this.getPosition()})}},{key:"getPosition",value:function(){var e=this._menuElement.getBoundingClientRect(),t=this.props.guiClientRect,r=this.props.topBarClientRect;return e.top>=r.bottom?[E().top,E().left]:e.bottom+e.height<t.bottom?[E().bottom,E().left]:(this._menuElement.style.maxHeight=t.height-r.height-Number(E().bottomBarMaxHeight)+"px",[E().stickBottom,E().left])}},{key:"isSelected",value:function(e){return e.active}},{key:"onSelect",value:function(e){this.props.onMenuChosen(e.value),this.props.options.filter((function(e){return e.active})).forEach((function(e){e.active=!1})),this.props.options.filter((function(t){return t.value===e.value}))[0].active=!0}},{key:"renderNativeSelect",value:function(e){var t,r=this,n=this.props.hideSelect?E().mobileHiddenSelect:"";n+=" ".concat(E().dropdown);var a=this.props.options.findIndex((function(e){return r.isSelected(e)}));return(0,b.h)("select",{"aria-labelledby":e,ref:function(e){r.props.pushRef&&r.props.pushRef(e)},className:n,value:a,onChange:this.onChange},this.props.options.map((function(e,t){return(0,b.h)("option",{value:t,key:t},e.label)})),null===(t=this.props.additionalOptions)||void 0===t?void 0:t.map((function(e,t){return(0,b.h)("option",{value:r.props.options.length+t,key:"additional-".concat(t)},e.label)})))}},{key:"render",value:function(e){var t,r=this;return e.clearAccessibleChildren(),e.isMobile||e.isSmallSize?this.renderNativeSelect(e.labelledby):(0,b.h)("div",{role:"listbox",onKeyDown:e.handleKeyDown,ref:function(e){return e?r._menuElement=e:void 0},className:[E().dropdownMenu].concat(i()(this.state.position)).join(" ")},e.options.map((function(t,n){return(0,b.h)(I,{setDefaultFocusedElement:e.setDefaultFocusedElement,addAccessibleChild:e.addAccessibleChild,isSelected:r.isSelected,onSelect:function(e){r.onSelect(e)},key:n,data:t,role:"option","aria-selected":r.isSelected(t)})})),(null===(t=e.additionalOptions)||void 0===t?void 0:t.length)>0&&(0,b.h)("div",{className:E().dropdownMenuAdditionalOptions},e.additionalOptions.map((function(t,r){return(0,b.h)(I,{setDefaultFocusedElement:e.setDefaultFocusedElement,addAccessibleChild:e.addAccessibleChild,isSelected:function(){return!1},onSelect:function(){return e.onMenuChosen(t.value)},key:"footer-".concat(r),data:t,role:"menuitem",isFooter:!0})}))))}}]),r}(b.Component))||n)||n)||n;x.displayName="Menu";var I=function(e){h()(r,e);var t=C(r);function r(){var e;o()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"onClick",(function(t){t.stopPropagation(),e.props.onSelect(e.props.data)})),_()(d()(e),"onKeyDown",(function(t){switch(t.keyCode){case S.KeyMap.ENTER:case S.KeyMap.SPACE:e.props.onSelect(e.props.data),t.stopPropagation(),t.preventDefault()}})),e}return u()(r,[{key:"render",value:function(e){var t=this,r=!e.isAdditional&&e.isSelected(e.data),n=e.data.badgeType&&!r?T.BadgeType[e.data.badgeType]:T.BadgeType[e.data.badgeType+"Active"];return(0,b.h)("div",{role:null==e?void 0:e.role,tabIndex:-1,"aria-selected":e.isSelected(e.data),ref:function(r){t.props.addAccessibleChild(r),e.isSelected(e.data)&&setTimeout((function(){return e.setDefaultFocusedElement(r)}))},className:e.isSelected(e.data)?[E().dropdownMenuItem,E().active].join(" "):E().dropdownMenuItem,onClick:this.onClick,onKeyDown:this.onKeyDown},(0,b.h)("span",{className:n?[E().labelBadge,n].join(" "):"","aria-label":(null==n?void 0:n.includes("quality-hd"))?"".concat(e.data.label," HD"):e.data.label},e.data.label),(0,b.h)("span",{className:[E().menuIconContainer,E().active].join(" ")},(0,b.h)(T.default,{type:T.IconType.CheckActive})))}}]),r}(b.Component)},"./src/components/overlay-action/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{OverlayAction:function(){return n.OverlayAction}});var n=r("./src/components/overlay-action/overlay-action.tsx")},"./src/components/overlay-action/overlay-action.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{OVERLAY_ACTION_DEFAULT_TIMEOUT:function(){return N},OverlayAction:function(){return j}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/index.ts"),P=r("./src/reducers/overlay-action.ts"),C=r("./src/reducers/shell.ts"),x=r("./src/components/icon/index.ts"),I=r("./src/reducers/getters.ts"),w=r("./src/components/player/index.ts"),R=r("./src/components/event-dispatcher/index.ts"),M=r("./src/components/logger/index.ts");function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=300,U="OverlayAction",j=(n=(0,A.connect)((function(e){return{isPlayingAdOrPlayback:(0,I.isPlayingAdOrPlayback)(e.engine),iconType:e.overlayAction.iconType,playerHover:e.shell.playerHover,isMobile:e.shell.isMobile,guiStyles:e.shell.layoutStyles.gui,isSmartContainerOpen:e.shell.smartContainerOpen,fullscreenConfig:e.config.components.fullscreen,seekbarDraggingActive:e.seekbar.draggingActive}}),(0,S.bindActions)(L(L({},P.actions),C.actions))),a=(0,M.withLogger)(U),i=(0,R.withEventDispatcher)(U),n(s=(0,w.withPlayer)(s=a(s=i(s=function(e){f()(r,e);var t=D(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_iconTimeout",null),k()(p()(e),"_pointerDownPosX",NaN),k()(p()(e),"_pointerDownPosY",NaN),k()(p()(e),"_firstClickTime",0),k()(p()(e),"_clickTimeout",null),k()(p()(e),"togglePlayPause",(function(){var t=!e.props.player.isLive()||e.props.player.isDvr();e.props.isPlayingAdOrPlayback?(e.props.player.pause(),e.props.updateOverlayActionIcon(t?x.IconType.Pause:x.IconType.Stop)):(e.props.player.play(),e.props.updateOverlayActionIcon(x.IconType.Play)),e.props.updatePlayerHoverState(!0),e.props.notifyClick({type:"PlayPause"})})),k()(p()(e),"onOverlayPointerDown",(function(t){e._pointerDownPosX=t.clientX||t.changedTouches&&t.changedTouches[0]&&t.changedTouches[0].clientX,e._pointerDownPosY=t.clientY||t.changedTouches&&t.changedTouches[0]&&t.changedTouches[0].clientY})),k()(p()(e),"onOverlayMouseUp",(function(t){var r=2===t.button&&e.props.player.debugInfo;e.isDragging(t)||r||e.overlayClick()})),k()(p()(e),"onOverlayTouchEnd",(function(t){t.preventDefault(),e.props.playerHover&&!e.isDragging(t)&&e.togglePlayPause()})),e}return c()(r,[{key:"componentWillUnmount",value:function(){this.cancelClickTimeout(),this.cancelIconTimeout()}},{key:"toggleFullscreen",value:function(){this.props.player.isFullscreen()?(this.props.logger.debug("Exit fullscreen"),this.props.player.exitFullscreen()):(this.props.logger.debug("Enter fullscreen"),this.props.player.enterFullscreen()),this.props.notifyClick({type:"Fullscreen"})}},{key:"isDragging",value:function(e){var t=e.clientX||e.changedTouches&&e.changedTouches[0]&&e.changedTouches[0].clientX,r=e.clientY||e.changedTouches&&e.changedTouches[0]&&e.changedTouches[0].clientY;return this.props.seekbarDraggingActive||Math.abs(t-this._pointerDownPosX)>5||Math.abs(r-this._pointerDownPosY)>5}},{key:"overlayClick",value:function(){var e=this;if(!this.props.isSmartContainerOpen){if(!this.props.fullscreenConfig.disableDoubleClick){var t=Date.now();if(t-this._firstClickTime<200)return this.cancelClickTimeout(),void this.toggleFullscreen();if(t-this._firstClickTime<500)return this.cancelClickTimeout(),this.togglePlayPause(),this.toggleFullscreen(),void(this._firstClickTime=0);this._firstClickTime=t}this._clickTimeout=setTimeout((function(){e._clickTimeout=null,e.togglePlayPause()}),200)}}},{key:"cancelClickTimeout",value:function(){this._clickTimeout&&(clearTimeout(this._clickTimeout),this._clickTimeout=null)}},{key:"cancelIconTimeout",value:function(){this._iconTimeout&&(clearTimeout(this._iconTimeout),this._iconTimeout=null)}},{key:"shouldComponentUpdate",value:function(e){return e.iconType&&this.toggleOverlayActionIcon(e.iconType),!0}},{key:"toggleOverlayActionIcon",value:function(e){var t=this,r=function(){t.setState({animation:!0,iconType:e},(function(){t._iconTimeout=setTimeout((function(){t._iconTimeout=null,t.setState({animation:!1})}),N)}))};null!==this._iconTimeout?(this.cancelIconTimeout(),this.setState({animation:!1},(function(){t.forceUpdate(),r()}))):r()}},{key:"render",value:function(){var e=this.props.guiStyles;return(0,E.h)("div",{style:e,className:"".concat(T().overlayAction," ").concat(this.state.animation?T().in:""),onMouseDown:this.onOverlayPointerDown,onTouchStart:this.onOverlayPointerDown,onMouseUp:this.onOverlayMouseUp,onTouchEnd:this.onOverlayTouchEnd},this.state.animation?this.renderIcons():void 0)}},{key:"renderIcons",value:function(){return Array.isArray(this.state.iconType)?this.state.iconType.map((function(e,t){return(0,E.h)(x.default,{key:t,type:e})})):(0,E.h)(x.default,{type:this.state.iconType})}},{key:"componentDidUpdate",value:function(){this.state.animation&&this.props.updateOverlayActionIcon(null)}}]),r}(E.Component))||s)||s)||s)||s);j.displayName=U},"./src/components/overlay-portal/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{OverlayPortal:function(){return n.OverlayPortal},getOverlayPortalElement:function(){return a.getOverlayPortalElement}});var n=r("./src/components/overlay-portal/overlay-portal.tsx"),a=r("./src/components/overlay-portal/overlay-portal-utils.ts")},"./src/components/overlay-portal/overlay-portal-utils.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{getOverlayPortalElement:function(){return n}});var n=function(e){return(document.getElementById(e.config.targetId)||document).querySelector(".overlay-portal")}},"./src/components/overlay-portal/overlay-portal.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{OverlayPortal:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./node_modules/preact/dist/preact.module.js");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var m=function(e){l()(r,e);var t=f(r);function r(){return a()(this,r),t.apply(this,arguments)}return s()(r,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(e){return(0,h.h)("div",{className:"overlay-portal","aria-live":"polite"},e.children)}}]),r}(h.Component);m.displayName="OverlayPortal"},"./src/components/overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Overlay:function(){return n.Overlay}});var n=r("./src/components/overlay/overlay.tsx")},"./src/components/overlay/overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Overlay:function(){return L}});var n,a,i=r("./node_modules/@babel/runtime/helpers/extends.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./node_modules/react-redux/es/index.js"),P=r("./src/utils/index.ts"),C=r("./src/reducers/overlay.ts"),x=r("./src/reducers/shell.ts"),I=r("./src/components/icon/index.ts"),w=r("./src/components/player/index.ts"),R=r("./src/components/overlay-portal/index.ts");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var L=(0,S.connect)((function(e){return{overlayOpen:e.overlay.isOpen}}),(0,P.bindActions)(O(O({},x.actions),C.actions)))(n=(0,w.withPlayer)((a=function(e){f()(r,e);var t=M(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_timeoutId",null),k()(p()(e),"_wasPlayed",!1),k()(p()(e),"onCloseButtonKeyDown",(function(t){var r,n;t.keyCode!==P.KeyMap.ENTER&&t.keyCode!==P.KeyMap.SPACE||(t.preventDefault(),null===(r=(n=e.props).onClose)||void 0===r||r.call(n,t,!0))})),k()(p()(e),"onKeyDown",(function(t){e.props.handleKeyDown&&e.props.handleKeyDown(t)})),e}return c()(r,[{key:"componentDidMount",value:function(){var e=this;this._timeoutId=setTimeout((function(){return e.props.addPlayerClass(T().overlayActive)}),0)}},{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),(this.props.dontCheckOverlayPortal||(0,R.getOverlayPortalElement)(this.props.player).childElementCount<=1)&&this.props.removePlayerClass(T().overlayActive),this.props.overlayOpen&&this._wasPlayed&&(this._wasPlayed=!1,this.props.player.play())}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.player,n=t.pauseOnOpen;this.props.overlayOpen&&!e.overlayOpen&&n&&!r.paused&&(this._wasPlayed=!0,r.pause())}},{key:"renderCloseButton",value:function(e){return e.permanent?void 0:(0,E.h)(A.Localizer,null,(0,E.h)("a",{role:"button",ref:function(t){e.addAccessibleChild&&e.addAccessibleChild(t)},tabIndex:0,onClick:function(){e.updateOverlay(!1),e.onClose()},onKeyDown:this.onCloseButtonKeyDown,"aria-label":e.closeAriaLabel,className:T().closeOverlay},(0,E.h)(I.default,{type:I.IconType.Close})))}},{key:"render",value:function(e){var t=e.type,r=e.open,n=e.ariaLabel,a=e.ariaLabelledBy,i="error"===t?"alert":"dialog",o="error"===t?"polite":void 0,l=a?{"aria-labelledby":a,"aria-live":o}:{"aria-label":n,"aria-live":o},u=[T().overlay];if(t){var c=T()[t+"-overlay"]?T()[t+"-overlay"]:t+"-overlay";u.push(c)}return r&&(this.props.updateOverlay(r),u.push(T().active)),(0,E.h)("div",s()({tabIndex:-1,className:u.join(" "),role:i,onKeyDown:this.onKeyDown},l),(0,E.h)("div",{className:T().overlayContents},this.props.children),this.renderCloseButton(this.props))}}]),r}(E.Component),k()(a,"defaultProps",{closeAriaLabel:(0,E.h)(A.Text,{id:"overlay.close"})}),n=a))||n)||n;L.displayName="Overlay"},"./src/components/picture-in-picture-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PictureInPictureOverlay:function(){return n.PictureInPictureOverlay}});var n=r("./src/components/picture-in-picture-overlay/picture-in-picture-overlay.tsx")},"./src/components/picture-in-picture-overlay/picture-in-picture-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PictureInPictureOverlay:function(){return S}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./src/styles/style.scss"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),E=r("./src/components/player/index.ts"),b=r("./src/components/logger/index.ts");function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var A="PictureInPictureOverlay",S=(n=(0,_.connect)((function(e){return{poster:e.engine.poster,isInPictureInPicture:e.engine.isInPictureInPicture,isChangingSource:e.engine.isChangingSource}})),a=(0,b.withLogger)(A),n(i=(0,E.withPlayer)(i=a(i=function(e){d()(r,e);var t=T(r);function r(){return o()(this,r),t.apply(this,arguments)}return u()(r,[{key:"_handleClick",value:function(){this.props.player.exitPictureInPicture()}},{key:"render",value:function(){if(this.props.isInPictureInPicture){var e={},t=[y().pictureInPicturePoster];return this.props.poster&&(e={backgroundImage:this.props.isChangingSource?"":"url(".concat(this.props.poster,")"),backgroundSize:"contain"},t.push(y().hasPoster)),(0,v.h)("div",null,(0,v.h)("div",{className:y().pictureInPictureOverlay},(0,v.h)("div",{className:t.join(" "),style:e,onMouseOver:function(e){return e.stopPropagation()}},(0,v.h)("div",{className:y().darkLayer})),(0,v.h)("div",{className:y().pictureInPictureControl},(0,v.h)(k.Localizer,null,(0,v.h)("span",{className:y().pictureInPictureText},(0,v.h)(k.Text,{id:"pictureInPicture.overlay_text"}))))))}}}]),r}(v.Component))||i)||i)||i);S.displayName=A},"./src/components/picture-in-picture/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PictureInPicture:function(){return n.PictureInPicture}});var n=r("./src/components/picture-in-picture/picture-in-picture.tsx")},"./src/components/picture-in-picture/picture-in-picture.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PictureInPicture:function(){return H}});var n,a,i,s,o,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),P=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./src/components/icon/index.ts"),x=r("./node_modules/react-redux/es/index.js"),I=r("./src/components/player/index.ts"),w=r("./src/components/logger/index.ts"),R=r("./src/utils/index.ts"),M=r("./src/components/keyboard/index.ts"),D=r("./src/components/event-dispatcher/index.ts"),O=r("./src/components/tooltip/index.ts"),L=r("./src/components/button/index.ts"),N=r("./src/reducers/shell.ts"),U=r("./src/components/button-control/index.ts"),j=r("./src/components/bottom-bar/index.ts");function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}var G="PictureInPicture",H=(n=(0,x.connect)((function(e){return{isPictureInPictureSupported:e.engine.isPictureInPictureSupported,isInPictureInPicture:e.engine.isInPictureInPicture,playerSize:e.shell.playerSize}}),(0,R.bindActions)(N.actions)),a=(0,M.withKeyboardEvent)(G),i=(0,w.withLogger)(G),s=(0,D.withEventDispatcher)(G),o=(0,P.withText)({pictureInPictureText:"controls.pictureInPicture",pictureInPictureExitText:"controls.pictureInPictureExit"}),n(l=(0,I.withPlayer)(l=a(l=i(l=s(l=o(l=function(e){g()(r,e);var t=V(r);function r(e){var n;return c()(this,r),n=t.call(this,e),b()(f()(n),"_keyboardEventHandlers",[{key:{code:R.KeyMap.P},action:function(){n.togglePip(),n.props.updatePlayerHoverState(!0)}}]),b()(f()(n),"getSvgIcon",(function(){return{type:n.props.player.isInPictureInPicture()?C.IconType.PictureInPictureStop:C.IconType.PictureInPictureStart}})),b()(f()(n),"getComponentText",(function(){return n.props.player.isInPictureInPicture()?n.props.pictureInPictureExitText:n.props.pictureInPictureText})),b()(f()(n),"onKeyDown",(function(e){[R.KeyCode.Enter,R.KeyCode.Space].includes(e.code)&&(e.preventDefault(),n.togglePip(),n.props.updatePlayerHoverState(!0))})),b()(f()(n),"togglePip",(function(){var e,t=n.props.player;n.props.player.hasService("dualScreen")&&(t=n.props.player.getService("dualScreen").getActivePlayer(),e=n.props.player.getService("dualScreen").getPipPlayer()),t.isInPictureInPicture()||e?(n.props.logger.debug("Exit Picture In Picture"),n.props.notifyClick(),e?e.exitPictureInPicture():t.exitPictureInPicture()):(n.props.logger.debug("Enter Picture In Picture"),n.props.notifyClick(),t.enterPictureInPicture())})),(0,j.registerToBottomBar)(G,e.player,(function(){return n.registerComponent()})),n}return p()(r,[{key:"registerComponent",value:function(){var e=this;return{ariaLabel:function(){return e.getComponentText()},displayName:G,order:5,svgIcon:function(){return e.getSvgIcon()},onClick:function(){return e.togglePip()},component:function(){return K(F(F({},e.props),{},{classNames:[A().upperBarIcon]}))},shouldHandleOnClick:!1}}},{key:"componentDidMount",value:function(){this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"_shouldRender",value:function(){var e=!(void 0!==this.props.isPictureInPictureSupported&&!this.props.isPictureInPictureSupported);return this.props.onToggle(G,e),e}},{key:"render",value:function(){var e;if(this._shouldRender())return(0,S.h)(U.ButtonControl,{name:G,className:this.props.classNames?this.props.classNames.join(" "):""},(0,S.h)(O.Tooltip,{label:this.props.isInPictureInPicture?this.props.pictureInPictureExitText:this.props.pictureInPictureText,type:(null===(e=this.props.classNames)||void 0===e?void 0:e.includes(A().upperBarIcon))?"bottom-left":"top",strictPosition:!0},(0,S.h)(L.Button,{tabIndex:"0","aria-label":this.props.isInPictureInPicture?this.props.pictureInPictureExitText:this.props.pictureInPictureText,className:this.props.isInPictureInPicture?[A().controlButton,A().isInPictureInPicture].join(" "):A().controlButton,onClick:this.togglePip,onKeyDown:this.onKeyDown},(0,S.h)(C.default,{type:C.IconType.PictureInPictureStart}),(0,S.h)(C.default,{type:C.IconType.PictureInPictureStop}))))}}]),r}(S.Component))||l)||l)||l)||l)||l)||l),K=function(e){return(0,S.h)(H,e)};H.displayName=G},"./src/components/play-pause/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayPause:function(){return n.PlayPause}});var n=r("./src/components/play-pause/play-pause.tsx")},"./src/components/play-pause/play-pause.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayPause:function(){return K}});var n,a,i,s,o,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./node_modules/react-redux/es/index.js"),C=r("./src/components/icon/index.ts"),x=r("./src/reducers/getters.ts"),I=r("./src/components/player/index.ts"),w=r("./src/components/event-dispatcher/index.ts"),R=r("./src/components/logger/index.ts"),M=r("./src/utils/index.ts"),D=r("./src/reducers/settings.ts"),O=r("./src/reducers/overlay-action.ts"),L=r("./src/components/tooltip/index.ts"),N=r("./src/components/button/index.ts"),U=r("./src/reducers/shell.ts"),j=r("./src/components/button-control/index.ts"),B=r("./src/event/index.ts");function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){E()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var H="PlayPause",K=(n=(0,P.connect)((function(e){return{isPlayingAdOrPlayback:(0,x.isPlayingAdOrPlayback)(e.engine),isPlaying:e.engine.isPlaying,adBreak:e.engine.adBreak,isPlaybackEnded:e.engine.isPlaybackEnded,playerSize:e.shell.playerSize,showPlayPauseButton:e.config.showPlayPauseButton,showLivePlayPauseButton:e.config.showLivePlayPauseButton}}),(0,M.bindActions)(G(G(G({},U.actions),D.actions),O.actions))),a=(0,R.withLogger)(H),i=(0,w.withEventDispatcher)(H),s=(0,S.withText)({startOverText:"controls.startOver",pauseText:"controls.pause",playText:"controls.play",title:"controls.title"}),n(o=(0,I.withPlayer)(o=a(o=i(o=(0,B.withEventManager)(o=s(o=function(e){m()(r,e);var t=F(r);function r(){var e;return u()(this,r),e=t.call(this),E()(h()(e),"_playPauseButtonRef",(0,A.createRef)()),E()(h()(e),"togglePlayPause",(function(){e.props.logger.debug("Toggle play"),e.props.isPlayingAdOrPlayback?e.props.player.pause():e.props.player.play(),e.props.notifyClick()})),E()(h()(e),"handleKeyDown",(function(t){t.keyCode!==M.KeyMap.ENTER&&t.keyCode!==M.KeyMap.SPACE||(t.preventDefault(),t.stopPropagation(),e.togglePlayPause())})),e.state={entryName:""},e}return d()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.eventManager,n=t.player;r.listenOnce(n,n.Event.UI.USER_CLICKED_PLAY,(function(){r.listenOnce(n,n.Event.Core.FIRST_PLAY,(function(){var t,r=null===(t=e._playPauseButtonRef)||void 0===t?void 0:t.current;if(r){var n=r.querySelector("button");(0,M.focusElement)(n)}}))})),r.listenOnce(n,n.Event.Core.CHANGE_SOURCE_ENDED,(function(){var t,r,a=null===(t=n.sources)||void 0===t||null===(r=t.metadata)||void 0===r?void 0:r.name;a&&e.setState({entryName:a})}))}},{key:"render",value:function(e){if((e.player.isLive()||e.showPlayPauseButton)&&(!e.player.isLive()||e.showLivePlayPauseButton)){var t=this.props.isPlayingAdOrPlayback?[T().controlButton,T().isPlaying].join(" "):T().controlButton,r=e.isPlaybackEnded&&!this.props.adBreak,n="".concat(this.props.title,": ").concat(this.state.entryName),a=this.props.isPlayingAdOrPlayback?this.props.pauseText:this.props.playText,i=r?this.props.startOverText:a,s=!this.props.player.isLive()||this.props.player.isDvr();return(0,A.h)(j.ButtonControl,{name:H},(0,A.h)("div",{ref:this._playPauseButtonRef},(0,A.h)(L.Tooltip,{label:i},(0,A.h)(N.Button,{tabIndex:"0","aria-label":"".concat(i,", ").concat(n),className:t,onClick:this.togglePlayPause,onKeyDown:this.handleKeyDown},r?(0,A.h)(C.default,{type:C.IconType.StartOver}):(0,A.h)("div",null,(0,A.h)(C.default,{type:C.IconType.Play}),s?(0,A.h)(C.default,{type:C.IconType.Pause}):(0,A.h)(C.default,{type:C.IconType.Stop}))))))}}}]),r}(A.Component))||o)||o)||o)||o)||o)||o);K.displayName=H},"./src/components/playback-controls/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaybackControls:function(){return n.PlaybackControls}});var n=r("./src/components/playback-controls/playback-controls.tsx")},"./src/components/playback-controls/playback-controls.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaybackControls:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/components/playlist-button/index.ts"),_=r("./src/components/play-pause/index.ts"),k=r("./src/components/player-area/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var b=(0,y.connect)((function(e){return{playlist:e.engine.playlist,image:e.engine.isImg}}))(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"componentDidMount",value:function(){this.setState({shouldUpdate:!1})}},{key:"componentDidUpdate",value:function(e){!!e.playlist!=!!this.props.playlist&&this.setState({shouldUpdate:!0})}},{key:"render",value:function(e){var t=e.showPreview,r=void 0===t||t,n=e.playlist,a=e.className,i=this.state.shouldUpdate;i&&this.setState({shouldUpdate:!1});var s=this.props.image?m().image:"";return(0,g.h)("div",{className:[m().playbackControls,a,s].join(" ")},(0,g.h)(k.PlayerArea,{name:"BottomBarPlaybackControls",shouldUpdate:i},n?(0,g.h)(g.Fragment,null,(0,g.h)(v.PlaylistButton,{type:"prev",showPreview:r}),(0,g.h)(_.PlayPause,null),(0,g.h)(v.PlaylistButton,{type:"next",showPreview:r})):(0,g.h)(_.PlayPause,null)))}}]),r}(g.Component))||n;b.displayName="PlaybackControls"},"./src/components/player-area/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerArea:function(){return n.PlayerArea},PlayerAreaProvider:function(){return a.PlayerAreaProvider},Remove:function(){return n.Remove},withPlayerPreset:function(){return i.withPlayerPreset}});var n=r("./src/components/player-area/player-area.tsx"),a=r("./src/components/player-area/player-area-provider.tsx"),i=r("./src/components/player-area/with-player-preset.tsx")},"./src/components/player-area/player-area-provider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerAreaProvider:function(){return T}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/components/logger/index.ts"),E=r("./src/components/player-area/styles-store-adapter.tsx");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var T=(0,k.withLogger)("PlayerAreaProvider")(n=(0,_.connect)((function(e){return{activePresetName:e.shell.activePresetName}}))(n=function(e){d()(r,e);var t=b(r);function r(){var e;return i()(this,r),e=t.call(this),y()(u()(e),"_listeners",void 0),y()(u()(e),"_componentsByPreset",void 0),y()(u()(e),"_validateComponentData",(function(t){var r=t.container||t.area;return!!(t.get&&t.presets&&r)||(e.props.logger.warn("component data with label '".concat(t.label||"","' is invalid (did you remember to set 'get', 'presets' and 'area'?)")),!1)})),y()(u()(e),"_addNewComponentAndUpdateListeners",(function(t){return e._addNewComponent(t,!0)})),y()(u()(e),"_addNewComponent",(function(t,r){var n=Object.assign({},t);if(n.container&&(n.area=n.area||n.container,delete n.container),!e._validateComponentData(n))return function(){};var a=n.area;return n.presets.forEach((function(t){if((e._componentsByPreset[t]||(e._componentsByPreset[t]=[])).push(n),r){var i=e._findListeners(a,t);e._emitListeners(i)}})),function(){e._removeNewComponent(n)}})),y()(u()(e),"_removeNewComponent",(function(t){e._validateComponentData(t)&&t.presets.forEach((function(r){var n=e._componentsByPreset[r]||[],a=n.indexOf(t);if(-1!==a){n.splice(a,1);var i=e._findListeners(t.area,t.presetName);e._emitListeners(i)}}))})),y()(u()(e),"_findListeners",(function(t,r){return t?e._listeners.filter((function(e){return(!r||e.presetName===r)&&e.areaName===t})):[]})),y()(u()(e),"_listen",(function(t,r,n){if(!t||!r||!n)return function(){};var a=e._findListeners(r,t);a&&a.length>0&&(e.props.logger.warn("Another component is already registered to updates for player area '".concat(r,"' in preset '").concat(t,"'. Unlisten to previous listener")),a.forEach((function(t){e._unlisten(t)})));var i={presetName:t,areaName:r,callback:n};return e._listeners.push(i),e._emitListeners([i]),function(){e._unlisten(i)}})),y()(u()(e),"_unlisten",(function(t){var r=e._listeners.indexOf(t);-1!==r&&e._listeners.splice(r,1)})),y()(u()(e),"_getAreaComponents",(function(t,r){if(!r||!t)return[];var n=e._componentsByPreset[t];return(n?n.filter((function(e){return e.area===r})):[])||[]})),e._listeners=[],e._componentsByPreset={},e}return o()(r,[{key:"_initializePlayerComponents",value:function(){var e=this;this.props.uiComponents&&this.props.uiComponents.length>0&&(this.props.uiComponents.forEach((function(t){return e._addNewComponent(t)})),this._emitAllListeners())}},{key:"_emitListeners",value:function(e){var t=this,r=this.props.activePresetName;(e||[]).forEach((function(e){var n=e.presetName===r?t._getAreaComponents(r,e.areaName):[];try{e.callback(n)}catch(r){t.props.logger.error("Error occurred when handling player area ".concat(e.areaName," of preset ").concat(e.presetName,"."),r)}}))}},{key:"_emitAllListeners",value:function(){this._emitListeners(this._listeners)}},{key:"componentDidMount",value:function(){this.props.setApi(this._addNewComponentAndUpdateListeners),this._initializePlayerComponents()}},{key:"componentDidUpdate",value:function(e){e.activePresetName!==this.props.activePresetName&&this._emitAllListeners()}},{key:"getChildContext",value:function(){return{playerAreaComponentsStore:{listen:this._listen,addNewComponent:this._addNewComponentAndUpdateListeners,getAreaComponents:this._getAreaComponents}}}},{key:"render",value:function(e){return(0,v.h)(v.Fragment,null,(0,v.h)(E.StylesStoreAdapter,null),e.children)}}]),r}(v.Component))||n)||n},"./src/components/player-area/player-area.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerArea:function(){return x},Remove:function(){return S}});var n,a,i=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./node_modules/react-redux/es/index.js"),T=r("./src/components/logger/index.ts");function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var S="remove";function P(e,t){return e[t]=e[t]||{before:[],after:[],replace:null},e[t]}var C={playerAreaComponents:null,hasPositionedComponents:!1,presetComponentsOnlyMode:!0},x=(0,T.withLogger)("PlayerArea")(n=(0,b.connect)((function(e){return{activePresetName:e.shell.activePresetName}}))((a=function(e){f()(r,e);var t=A(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_unregisterListenerCallback",void 0),k()(p()(e),"_actualChildren",void 0),k()(p()(e),"_updateAreaComponents",(function(t){var r=e.props,n=r.activePresetName,a=r.name;e.props.logger.debug("Player area '".concat(a,"' in preset '").concat(n,"' - update children components"));var i={},s={appendedComponents:[],positionedComponentMap:i},o=!1;t.forEach((function(e){e.beforeComponent?(P(i,e.beforeComponent).before.push(e),o=!0):e.afterComponent?(P(i,e.afterComponent).after.push(e),o=!0):e.replaceComponent?(P(i,e.replaceComponent).replace=e,o=!0):s.appendedComponents.push(e)})),e.setState({playerAreaComponents:s,hasPositionedComponents:o,presetComponentsOnlyMode:!1})})),e}return c()(r,[{key:"shouldComponentUpdate",value:function(e,t){return e.shouldUpdate||this.state.playerAreaComponents!==t.playerAreaComponents||e.activePresetName!==this.props.activePresetName}},{key:"componentDidUpdate",value:function(e){e.activePresetName!==this.props.activePresetName&&this._registerListener()}},{key:"_unregisterListener",value:function(){this.props.logger.debug("Player area '".concat(this.props.name,"' - unregister to changes")),"function"==typeof this._unregisterListenerCallback&&(this._unregisterListenerCallback(),this._unregisterListenerCallback=null)}},{key:"_registerListener",value:function(){var e=this.props,t=e.activePresetName,r=e.name;this._unregisterListener(),t&&r&&(this.props.logger.debug("Player area '".concat(r,"' in preset '").concat(t,"' - register to changes")),this._unregisterListenerCallback=this.context.playerAreaComponentsStore.listen(t,r,this._updateAreaComponents))}},{key:"componentDidMount",value:function(){this.props.logger.debug("Player area '".concat(this.props.name,"' - handle did mount")),this.setState(C),this._registerListener(),this._actualChildren=[]}},{key:"componentWillUpdate",value:function(e){var t=e.children;this._actualChildren=t&&t.type===E.Fragment?t.props.children:t}},{key:"componentWillUnmount",value:function(){var e=this.props.name;this.props.logger.debug("Player area '".concat(e,"' - handle will unmount")),this._unregisterListener()}},{key:"_renderUIComponent",value:function(e){return e.get?(0,E.h)(e.get,e.props):null}},{key:"renderContent",value:function(e){return(0,E.h)(E.Fragment,null,e)}},{key:"_getPositionedComponents",value:function(e){var t=this,r=this.state.playerAreaComponents,n=[];return(0,E.toChildArray)(e).forEach((function(e){if("div"===e.type||e.type===E.Fragment)return e.props.children=t._getPositionedComponents(e.props.children),void n.push(e);var a,i=(a=e)&&a.type?a.type.displayName:null;if(i){var s=r.positionedComponentMap[i];if(s){var o=s.replace,l=s.before,u=s.after;if(o){if(o.get===S)return;return"string"!=typeof o.get&&(o.props=o.props||{},o.props.replacedComponentProps=e.props),void n.push(t._renderUIComponent(o))}l.length&&l.forEach((function(e){n.push(t._renderUIComponent(e))})),n.push(e),u.length&&u.forEach((function(e){n.push(t._renderUIComponent(e))}))}else n.push(e)}else n.push(e)})),n}},{key:"render",value:function(){var e,t=this,r=this.props.show,n=this.state,a=n.playerAreaComponents,i=n.hasPositionedComponents;if(n.presetComponentsOnlyMode)return this.renderContent(this._actualChildren);if(!a||!r)return null;var o,l=[];i?l=this._getPositionedComponents(this._actualChildren):(o=l).push.apply(o,s()((0,E.toChildArray)(this._actualChildren)));var u=a.appendedComponents.map((function(e){return t._renderUIComponent(e)})),c=l.length;return(e=l).splice.apply(e,[c,0].concat(s()(u))),this.renderContent(l)}}]),r}(E.Component),k()(a,"defaultProps",{show:!0}),n=a))||n)||n},"./src/components/player-area/player-areas-utils.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{calculateGuiContainerStyles:function(){return p},calculateSidePanelStyles:function(){return h},calculateVideoContainerStyles:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./src/reducers/shell.ts"),s=r("./src/components/shell/shell.tsx");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e){var t,r=e.sidePanelsSizes,n=e.sidePanelsModes,a=e.playerClientRect,o=e.isVideo,l=r[i.SidePanelOrientation.VERTICAL],u=a.width,c=Math.max(l.min,Math.min(l.max,u*l.ratio)),d=n[i.SidePanelPositions.LEFT],p=n[i.SidePanelPositions.RIGHT],h=u-(t=o?d===i.SidePanelModes.ALONGSIDE&&p===i.SidePanelModes.ALONGSIDE?2:1:d!==i.SidePanelModes.HIDDEN&&p!==i.SidePanelModes.HIDDEN?2:1)*c;return u<s.PLAYER_BREAK_POINTS.SMALL&&(h=u,c=u),{verticalPanelWidth:c,videoWidth:h,verticalPanelCount:t}}function c(e){var t,r=e.sidePanelsSizes,n=e.sidePanelsModes,a=e.playerClientRect,o=e.isVideo,l=r[i.SidePanelOrientation.HORIZONTAL],u=a.height,c=Math.max(l.min,Math.min(l.max,u*l.ratio)),d=n[i.SidePanelPositions.TOP],p=n[i.SidePanelPositions.BOTTOM],h=u-(t=o?d===i.SidePanelModes.ALONGSIDE&&p===i.SidePanelModes.ALONGSIDE?2:1:d!==i.SidePanelModes.HIDDEN&&p!==i.SidePanelModes.HIDDEN?2:1)*c;return a.width<s.PLAYER_BREAK_POINTS.SMALL&&(h=u,c=u),{horizontalPanelHeight:c,videoHeight:h,horizontalPanelCount:t}}function d(e){var t=e.sidePanelsModes,r=e.allowSidePanels,n={position:"absolute",left:0,right:0,top:0,bottom:0},a=r?t[i.SidePanelPositions.LEFT]:i.SidePanelModes.HIDDEN,o=r?t[i.SidePanelPositions.RIGHT]:i.SidePanelModes.HIDDEN,d=r?t[i.SidePanelPositions.TOP]:i.SidePanelModes.HIDDEN,p=r?t[i.SidePanelPositions.BOTTOM]:i.SidePanelModes.HIDDEN;if(e.playerClientRect.width>s.PLAYER_BREAK_POINTS.SMALL){if(a===i.SidePanelModes.ALONGSIDE||o===i.SidePanelModes.ALONGSIDE){var h=u(l(l({},e),{},{isVideo:!0})),f=h.verticalPanelWidth,m=h.videoWidth;n.left=a===i.SidePanelModes.ALONGSIDE?f:0,n.right=o===i.SidePanelModes.ALONGSIDE?f:0,n.width=m,n.position="absolute"}if(d===i.SidePanelModes.ALONGSIDE||p===i.SidePanelModes.ALONGSIDE){var g=c(l(l({},e),{},{isVideo:!0})),y=g.horizontalPanelHeight,v=g.videoHeight;n.top=d===i.SidePanelModes.ALONGSIDE?y:0,n.bottom=p===i.SidePanelModes.ALONGSIDE?y:0,n.height=v,n.position="absolute"}}return n}function p(e){var t=e.sidePanelsModes,r=e.playerClientRect,n=e.allowSidePanels,a={position:"absolute",left:0,right:0,top:0,bottom:0},o=r.width,l=r.height,d=n?t[i.SidePanelPositions.LEFT]:i.SidePanelModes.HIDDEN,p=n?t[i.SidePanelPositions.RIGHT]:i.SidePanelModes.HIDDEN,h=n?t[i.SidePanelPositions.TOP]:i.SidePanelModes.HIDDEN,f=n?t[i.SidePanelPositions.BOTTOM]:i.SidePanelModes.HIDDEN;if(r.width>s.PLAYER_BREAK_POINTS.SMALL){if(d!==i.SidePanelModes.HIDDEN||p!==i.SidePanelModes.HIDDEN){var m=u(e).verticalPanelWidth;d!==i.SidePanelModes.HIDDEN&&(a.left=m),p!==i.SidePanelModes.HIDDEN&&(a.right=m)}if(h!==i.SidePanelModes.HIDDEN||f!==i.SidePanelModes.HIDDEN){var g=c(e).horizontalPanelHeight;h!==i.SidePanelModes.HIDDEN&&(a.top=g),f!==i.SidePanelModes.HIDDEN&&(a.bottom=g)}o=o-a.right-a.left,l=l-a.top-a.bottom}var y=r.left+(d!==i.SidePanelModes.HIDDEN?a.left:0),v=r.top+(h!==i.SidePanelModes.HIDDEN?a.top:0);return{style:a,rect:{x:y,y:v,width:o,height:l,top:v,right:r.right+(p!==i.SidePanelModes.HIDDEN?a.right:0),bottom:r.bottom+(f!==i.SidePanelModes.HIDDEN?a.bottom:0),left:y}}}function h(e){var t=e.position,r=e.sidePanelsModes,n=r[i.SidePanelPositions.LEFT],a=r[i.SidePanelPositions.RIGHT],s=r[i.SidePanelPositions.TOP],o=r[i.SidePanelPositions.BOTTOM];if(-1!==[i.SidePanelPositions.RIGHT,i.SidePanelPositions.LEFT].indexOf(t)){var l={},d=u(e).verticalPanelWidth;return l.width=d,t===i.SidePanelPositions.RIGHT?(a===i.SidePanelModes.HIDDEN?(l.right=-d,l.opacity=0):(l.right=0,l.opacity=1),l):(n===i.SidePanelModes.HIDDEN?(l.left=-d,l.opacity=0):(l.left=0,l.opacity=1),l)}var p={},h=c(e).horizontalPanelHeight,f=u(e).verticalPanelWidth;return p.height=h,n!==i.SidePanelModes.HIDDEN&&(p.left=f),a!==i.SidePanelModes.HIDDEN&&(p.right=f),t===i.SidePanelPositions.TOP?(s===i.SidePanelModes.HIDDEN?(p.top=-h,p.opacity=0):(p.top=0,p.opacity=1),p):(o===i.SidePanelModes.HIDDEN?(p.bottom=-h,p.opacity=0):(p.bottom=0,p.opacity=1),p)}},"./src/components/player-area/styles-store-adapter.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{StylesStoreAdapter:function(){return S}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/reducers/shell.ts"),_=r("./src/utils/index.ts"),k=r("./src/components/player-area/player-areas-utils.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e){var t,r;return e.allowSidePanels?(t={},m()(t,v.SidePanelPositions.TOP,k.calculateSidePanelStyles(T(T({},e),{},{position:v.SidePanelPositions.TOP}))),m()(t,v.SidePanelPositions.BOTTOM,k.calculateSidePanelStyles(T(T({},e),{},{position:v.SidePanelPositions.BOTTOM}))),m()(t,v.SidePanelPositions.RIGHT,k.calculateSidePanelStyles(T(T({},e),{},{position:v.SidePanelPositions.RIGHT}))),m()(t,v.SidePanelPositions.LEFT,k.calculateSidePanelStyles(T(T({},e),{},{position:v.SidePanelPositions.LEFT}))),t):(r={},m()(r,v.SidePanelPositions.TOP,{}),m()(r,v.SidePanelPositions.BOTTOM,{}),m()(r,v.SidePanelPositions.RIGHT,{}),m()(r,v.SidePanelPositions.LEFT,{}),r)}var S=(0,y.connect)((function(e){return{sidePanelsModes:e.shell.sidePanelsModes,sidePanelsSizes:e.shell.sidePanelsSizes,allowSidePanels:e.shell.presetSettings.allowSidePanels,playerClientRect:e.shell.playerClientRect}}),(0,_.bindActions)(v.actions))(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,r=t.sidePanelsModes,n=t.sidePanelsSizes,a=t.allowSidePanels,i=t.playerClientRect,s=e.sidePanelsModes,o=e.sidePanelsSizes,l=e.allowSidePanels,u=e.playerClientRect;return!(r===s&&n===o&&a===l&&i===u)}},{key:"componentDidUpdate",value:function(){var e={sidePanelsModes:this.props.sidePanelsModes,sidePanelsSizes:this.props.sidePanelsSizes,playerClientRect:this.props.playerClientRect,allowSidePanels:this.props.allowSidePanels},t=k.calculateGuiContainerStyles(e),r=t.style,n=t.rect;this.props.updateLayoutStyles({gui:r,video:k.calculateVideoContainerStyles(e),sidePanels:A(e)}),this.props.updateGuiClientRect(n)}},{key:"render",value:function(){return null}}]),r}(g.Component))||n},"./src/components/player-area/with-player-preset.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withPlayerPreset:function(){return _}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./node_modules/preact/dist/preact.module.js"),f=r("./node_modules/react-redux/es/index.js"),m=r("./src/reducers/shell.ts"),g=r("./src/utils/index.ts");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var v={allowSidePanels:!1,allowPlayerArea:!1},_=function(e){return function(t){var r,n=(0,f.connect)(null,(0,g.bindActions)(m.actions))(r=function(r){l()(i,r);var n=y(i);function i(){return a()(this,i),n.apply(this,arguments)}return s()(i,[{key:"componentDidMount",value:function(){var t=Object.assign({},v,e),r=t.allowSidePanels,n=t.allowPlayerArea;this.props.updatePresetSettings({allowSidePanels:r,allowPlayerArea:n})}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(e){return(0,h.h)(t,e)}}]),i}(h.Component))||r;return n}}},"./src/components/player-gui/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerGUI:function(){return n.PlayerGUI}});var n=r("./src/components/player-gui/player-gui.tsx")},"./src/components/player-gui/player-gui.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerGUI:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./node_modules/react-redux/es/index.js"),g=r("./src/components/active-preset/index.ts"),y=r("./src/components/player-area/index.ts"),v=r("./src/reducers/shell.ts"),_=r("./src/components/side-panel/index.ts"),k=r("./src/utils/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var b=(0,m.connect)((function(e){return{allowSidePanels:e.shell.presetSettings.allowSidePanels,allowPlayerArea:e.shell.presetSettings.allowPlayerArea,sidePanelsConfig:e.config.components.sidePanels}}),(0,k.bindActions)(v.actions))(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"componentDidUpdate",value:function(){var e=this.props.sidePanelsConfig,t=e.verticalSizes,r=e.horizontalSizes;t&&this.props.updateSidePanelSize(v.SidePanelOrientation.VERTICAL,t),r&&this.props.updateSidePanelSize(v.SidePanelOrientation.HORIZONTAL,r)}},{key:"render",value:function(){var e=this.props,t=e.uis,r=e.playerContainer,n=e.allowSidePanels,a=e.allowPlayerArea;return(0,f.h)(f.Fragment,null,(0,f.h)(g.ActivePreset,{uis:t,playerContainer:r}),n?(0,f.h)(f.Fragment,null,(0,f.h)(_.SidePanel,{position:v.SidePanelPositions.RIGHT}),(0,f.h)(_.SidePanel,{position:v.SidePanelPositions.LEFT}),(0,f.h)(_.SidePanel,{position:v.SidePanelPositions.TOP}),(0,f.h)(_.SidePanel,{position:v.SidePanelPositions.BOTTOM})):void 0,a?(0,f.h)(y.PlayerArea,{name:"PlayerArea"}):void 0)}}]),r}(f.Component))||n},"./src/components/player/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerProvider:function(){return n.PlayerProvider},withPlayer:function(){return a.withPlayer}});var n=r("./src/components/player/player-provider.tsx"),a=r("./src/components/player/with-player.tsx")},"./src/components/player/player-provider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerProvider:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./node_modules/preact/dist/preact.module.js");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var m=function(e){l()(r,e);var t=f(r);function r(){return a()(this,r),t.apply(this,arguments)}return s()(r,[{key:"getChildContext",value:function(){return{player:this.props.player}}},{key:"render",value:function(){return this.props.children&&(0,h.toChildArray)(this.props.children)[0]||null}}]),r}(h.Component)},"./src/components/player/with-player.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withPlayer:function(){return y}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var y=function(e){return function(t){c()(n,t);var r=g(n);function n(e){return s()(this,n),r.call(this)}return l()(n,[{key:"render",value:function(){var t=this.context.player;return(0,m.h)(e,a()({},this.props,{player:t}))}}]),n}(m.Component)}},"./src/components/playlist-button/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistButton:function(){return n.PlaylistButton},PrevNext:function(){return a.PrevNext}});var n=r("./src/components/playlist-button/playlist-button.tsx"),a=r("./src/components/playlist-button/prev-next.tsx")},"./src/components/playlist-button/playlist-button.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistButton:function(){return T}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/components/player/index.ts"),E=r("./src/components/playlist-button/prev-next.tsx");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var T=(0,_.connect)((function(e){return{playlist:e.engine.playlist}}))(n=(0,k.withPlayer)(n=function(e){d()(r,e);var t=b(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"onClick",(function(){"prev"===e.props.type?e.props.player.playlist.playPrev():e.props.player.playlist.playNext()})),e}return o()(r,[{key:"render",value:function(e){var t=e.playlist[e.type];return(0,v.h)(E.PrevNext,{type:e.type,item:t,onClick:this.onClick.bind(this),showPreview:e.showPreview})}}]),r}(v.Component))||n)||n;T.displayName="PlaylistButton"},"./src/components/playlist-button/prev-next.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PrevNext:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),v=r("./src/components/button/index.ts"),_=r("./src/components/tooltip/index.ts"),k=r("./src/components/icon/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var b=(0,y.withText)({prevControlsText:"controls.prev",nextControlsText:"controls.next",playlistPrevText:"playlist.prev",playlistUpNextText:"playlist.up_next"})(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"render",value:function(e){var t,r,n=e.type,a=e.item,i=e.onClick,s="next"===n?k.IconType.Next:k.IconType.Prev,o=e["".concat(e.type,"ControlsText")],l="prev"===n?this.props.playlistPrevText:this.props.playlistUpNextText,u=null==a||null===(t=a.sources)||void 0===t?void 0:t.poster,c=(null==a||null===(r=a.sources)||void 0===r?void 0:r.metadata)?a.sources.metadata.name:"",d=(0,g.h)(v.Button,{disabled:!a,tabIndex:"0","aria-label":o,className:"".concat(m().controlButton),onClick:i},(0,g.h)("div",null,(0,g.h)(k.default,{type:s})));return(0,g.h)("div",{className:[m().controlButtonContainer,m().controlPlaylistButton].join(" ")},e.showPreview&&(u||c)?(0,g.h)(g.Fragment,null,(0,g.h)("div",{className:m().posterPreview},u?(0,g.h)("div",{className:m().posterPreviewImg,style:"background-image: url(".concat(u,");")}):void 0,(0,g.h)("div",{className:m().posterPreviewText},(0,g.h)("div",{className:m().posterPreviewTextTitle},l),(0,g.h)("div",{className:m().posterPreviewTextName},"".concat(c||"")))),d):(0,g.h)(_.Tooltip,{label:o},d))}}]),r}(g.Component))||n},"./src/components/playlist-countdown/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistCountdown:function(){return n.PlaylistCountdown}});var n=r("./src/components/playlist-countdown/playlist-countdown.tsx")},"./src/components/playlist-countdown/playlist-countdown.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistCountdown:function(){return O}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./src/components/icon/index.ts"),S=r("./src/utils/index.ts"),P=r("./node_modules/react-redux/es/index.js"),C=r("./src/components/player/index.ts"),x=r("./src/components/logger/index.ts"),I=r("./src/reducers/playlist.ts"),w=r("./src/event/index.ts"),R=r("./src/components/button/index.ts");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var D="PlaylistCountdown",O=(n=(0,P.connect)((function(e){return{playlist:e.engine.playlist,currentTime:e.engine.currentTime,duration:e.engine.duration,lastSeekPoint:e.engine.lastSeekPoint,isSeeking:e.engine.isSeeking,isPlaybackEnded:e.engine.isPlaybackEnded,countdownCanceled:e.playlist.countdownCanceled}}),(0,S.bindActions)(I.actions)),a=(0,x.withLogger)(D),n(i=(0,C.withPlayer)(i=(0,w.withEventManager)(i=a(i=function(e){h()(r,e);var t=M(r);function r(e){var n;return o()(this,r),n=t.call(this,e),_()(d()(n),"focusElement",void 0),_()(d()(n),"nextShown",void 0),_()(d()(n),"onClick",(function(){n.props.player.playlist.playNext()})),_()(d()(n),"cancelNext",(function(e){n.props.logger.debug("Cancel auto play next item"),e.stopPropagation(),n.props.updatePlaylistCountdownCanceled(!0)})),_()(d()(n),"onKeyDown",(function(e){switch(e.keyCode){case S.KeyMap.ENTER:n.onClick();break;case S.KeyMap.ESC:n.cancelNext(e)}})),_()(d()(n),"onCancelButtonKeyDown",(function(e){e.keyCode===S.KeyMap.ENTER&&n.cancelNext(e)})),n.setState({focusable:!1}),n}return u()(r,[{key:"_shouldRender",value:function(e){return this.state.timeToShow&&e.playlist&&e.playlist.next&&e.playlist.next.sources&&e.player.playlist.countdown.showing&&(e.player.playlist.options.autoContinue||e.player.playlist.options.loop)}},{key:"_getTimeToShow",value:function(){var e=this.props.player.playlist.countdown,t=this.props.duration-e.duration;return e.timeToShow>=0&&e.timeToShow<=this.props.duration&&(t=Math.max(e.timeToShow,this.props.lastSeekPoint)),Math.max(0,Math.min(t,this.props.duration))}},{key:"componentWillUpdate",value:function(e){var t=this._getTimeToShow();e.currentTime>=t?this.setState({timeToShow:!0}):(this.setState({timeToShow:!1}),this.props.updatePlaylistCountdownCanceled(!1))}},{key:"isHidden",value:function(e){return!e.timeToShow||this.props.player.playlist.countdown.duration>=this.props.duration}},{key:"isCanceled",value:function(){return this.props.countdownCanceled}},{key:"isShown",value:function(e){return!this.isHidden(e)&&!this.isCanceled()}},{key:"componentDidUpdate",value:function(e,t){var r=this;if(this._shouldRender(e)){var n=this._getTimeToShow(),a=this.props.player.playlist.countdown;e.isSeeking||this.props.countdownCanceled||!(this.props.isPlaybackEnded||this.props.currentTime>=n+a.duration&&this.props.currentTime<this.props.duration)||this.props.player.playlist.playNext()}!t.shown&&this.state.shown?this.focusElement&&this.props.eventManager.listenOnce(this.focusElement,"animationend",(function(){r.isShown(r.state)&&(r.focusElement.focus(),r.setState({focusable:!0}))})):t.shown&&!this.state.shown&&this.setState({focusable:!1}),this.isShown(this.state)!==this.state.shown&&this.setState((function(e){return{shown:r.isShown(e)}}))}},{key:"shouldComponentUpdate",value:function(e){return this.props.duration>0&&!e.isSeeking&&!this.props.isPlaybackEnded}},{key:"render",value:function(e){var t=this;if(this._shouldRender(e)&&(this.isShown(this.state)&&(this.nextShown=e.playlist.next),e.playlist.next&&e.playlist.next.sources&&this.nextShown)){var r=this.props.player.playlist.countdown,n=this._getTimeToShow(),a=e.currentTime-n,i=Math.min(r.duration,e.duration-n),s=Math.ceil(i-(a>0?a:0)),o=[E().playlistCountdown];return this.isHidden(this.state)?o.push(E().hidden):this.isCanceled()?o.push(E().canceled):o.push(E().slideIn),(0,b.h)("div",{role:"button","aria-labelledby":"playlistCountdownTextId",ref:function(e){return e?t.focusElement=e:void 0},tabIndex:this.state.focusable?0:-1,className:o.join(" "),onKeyDown:this.onKeyDown,onClick:this.onClick},(0,b.h)("div",{className:E().playlistCountdownPoster,style:"background-image: url(".concat(this.nextShown.sources.poster,");")}),(0,b.h)("div",{className:E().playlistCountdownContentPlaceholder},(0,b.h)("div",{className:E().playlistCountdownContentBackground},(0,b.h)("div",{className:E().playlistCountdownContent},(0,b.h)(T.Localizer,null,(0,b.h)("div",{id:"playlistCountdownTextId",className:E().playlistCountdownText},(0,b.h)("div",{className:E().playlistCountdownTextTitle},(0,b.h)(T.Text,{id:"playlist.up_next_in"}),(0,b.h)("div",{className:E().playlistCountdownTimeLeft},s)),(0,b.h)("div",{className:E().playlistCountdownTextName},"".concat(this.nextShown.sources.metadata?this.nextShown.sources.metadata.name:"")))),(0,b.h)("div",{className:[E().controlButtonContainer,E().playlistCountdownCancel].join(" ")},(0,b.h)(T.Localizer,null,(0,b.h)(R.Button,{tabIndex:this.state.focusable?0:-1,"aria-label":(0,b.h)(T.Text,{id:"playlist.cancel"}),className:[E().controlButton,E().playlistCountdownCancelButton].join(" "),onClick:this.cancelNext,onKeyDown:this.onCancelButtonKeyDown},(0,b.h)(A.default,{type:A.IconType.Close}))))))))}}}]),r}(b.Component))||i)||i)||i)||i);O.displayName=D},"./src/components/playlist-next-screen/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistNextScreen:function(){return n.PlaylistNextScreen}});var n=r("./src/components/playlist-next-screen/playlist-next-screen.tsx")},"./src/components/playlist-next-screen/playlist-next-screen.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistNextScreen:function(){return R}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/components/icon/index.ts"),P=r("./src/utils/index.ts"),C=r("./src/components/player/index.ts"),x=r("./src/components/logger/index.ts");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var w="PlaylistNextScreen",R=(n=(0,A.connect)((function(e){return{playlist:e.engine.playlist,isPlaybackEnded:e.engine.isPlaybackEnded}})),a=(0,x.withLogger)(w),n(i=(0,C.withPlayer)(i=a(i=function(e){h()(r,e);var t=I(r);function r(){var e;o()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"focusElement",void 0),_()(d()(e),"onPosterClick",(function(){e.props.player.playlist.playNext()})),_()(d()(e),"onKeyDown",(function(t){t.keyCode!==P.KeyMap.ENTER&&t.keyCode!==P.KeyMap.SPACE||(t.preventDefault(),e.onPosterClick())})),e}return u()(r,[{key:"componentDidUpdate",value:function(e){!this._shouldRender(e)&&this._shouldRender(this.props)&&this.focusElement&&this.focusElement.focus()}},{key:"_shouldRender",value:function(e){return!(!(e.playlist&&e.playlist.next&&e.playlist.next.sources&&e.isPlaybackEnded)||e.player.playlist.options.autoContinue)}},{key:"_getPosterUrl",value:function(){var e=this.props.playlist.next;return e.sources.poster?e.sources.poster.indexOf("entry_id/".concat(e.sources.id))>-1&&-1===e.sources.poster.indexOf("/width/")?"".concat(e.sources.poster,"/width/").concat(384):e.sources.poster:""}},{key:"render",value:function(e){var t=this;if(this._shouldRender(e)){var r=e.playlist.next;return(0,b.h)("div",{className:E().playlistNextScreenOverlay},(0,b.h)("div",{className:E().playlistNextScreenContent},(0,b.h)("div",{id:"playlistNextScreenTextId",className:E().playlistNextScreenText},(0,b.h)(T.Localizer,null,(0,b.h)("div",{className:E().playlistNextScreenTextTitle},(0,b.h)(T.Text,{id:"playlist.next"}))),(0,b.h)("div",{className:E().playlistNextScreenTextName},"".concat(r.sources.metadata?r.sources.metadata.name:""))),(0,b.h)("div",{className:E().playlistNextScreenPosterPlaceholder},(0,b.h)("div",{className:E().playlistNextScreenPosterAspectRatio},(0,b.h)("div",{role:"button","aria-labelledby":"playlistNextScreenTextId",ref:function(e){return e?t.focusElement=e:void 0},tabIndex:0,className:E().playlistNextScreenPoster,onClick:this.onPosterClick,onKeyDown:this.onKeyDown},(0,b.h)("div",{className:E().playlistNextScreenPosterImg,style:"background-image: url(".concat(this._getPosterUrl(),");")}),(0,b.h)(S.default,{type:S.IconType.Play}))))))}}}]),r}(b.Component))||i)||i)||i);R.displayName=w},"./src/components/pre-playback-play-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PrePlaybackPlayOverlay:function(){return n.PrePlaybackPlayOverlay}});var n=r("./src/components/pre-playback-play-overlay/pre-playback-play-overlay.tsx")},"./src/components/pre-playback-play-overlay/pre-playback-play-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PrePlaybackPlayOverlay:function(){return U}});var n,a,i,s,o,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/react-redux/es/index.js"),P=r("./src/utils/index.ts"),C=r("./src/components/icon/index.ts"),x=r("./src/reducers/loading.ts"),I=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),w=r("./src/components/player/index.ts"),R=r("./src/components/event-dispatcher/index.ts"),M=r("./src/components/logger/index.ts"),D=r("./src/components/tooltip/index.ts"),O=r("./src/components/button/index.ts");function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}var N="PrePlaybackPlayOverlay",U=(n=(0,S.connect)((function(e){return{prePlayback:e.engine.prePlayback,isPlaybackEnded:e.engine.isPlaybackEnded,playlist:e.engine.playlist,loading:e.loading.show,targetId:e.config.targetId}}),(0,P.bindActions)(x.actions)),a=(0,M.withLogger)(N),i=(0,R.withEventDispatcher)(N),s=(0,I.withText)({startOverText:"controls.startOver",playText:"controls.play",title:"controls.title"}),n(o=(0,w.withPlayer)(o=a(o=i(o=s(o=function(e){m()(r,e);var t=L(r);function r(){var e;u()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),E()(h()(e),"handleClick",(function(){e.props.playlist&&e.props.isPlaybackEnded?e.props.player.playlist.playNext():e.props.player.play(),e.props.notifyClick()})),E()(h()(e),"onKeyDown",(function(t){t.keyCode===P.KeyMap.ENTER&&(t.preventDefault(),t.stopPropagation(),e.handleClick())})),E()(h()(e),"onMouseOver",(function(e){e.stopPropagation()})),E()(h()(e),"createPrePlaybackClassName",(function(){var t,r=[T().prePlaybackPlayOverlay],n=null===(t=e.props.player.sources.capabilities)||void 0===t?void 0:t.includes("quiz.quiz");return e.props.player.engineType!==e.props.player.EngineType.YOUTUBE||n||r.push(T().prePlaybackPlayOverlayYoutube),r})),e}return d()(r,[{key:"render",value:function(e){var t,r=e.isPlaybackEnded&&!e.player.config.playback.loop&&!(e.playlist&&e.playlist.next);if((e.prePlayback||r)&&!e.loading){var n="".concat(this.props.title,": ").concat(null===(t=this.props.player.sources.metadata)||void 0===t?void 0:t.name),a=e.isPlaybackEnded?e.startOverText:e.playText,i=this.createPrePlaybackClassName();return(0,A.h)("div",{className:i.join(" "),onMouseOver:this.onMouseOver,onClick:this.handleClick},(0,A.h)(O.Button,{className:T().prePlaybackPlayButton,tabIndex:"0","aria-label":"".concat(a,", ").concat(n),onKeyDown:this.onKeyDown},(0,A.h)(D.Tooltip,{label:a},e.isPlaybackEnded?(0,A.h)(C.default,{type:C.IconType.StartOver}):(0,A.h)(C.default,{type:C.IconType.Play}))))}}}]),r}(A.Component))||o)||o)||o)||o)||o);U.displayName=N},"./src/components/progress-indicator/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ProgressIndicator:function(){return n.ProgressIndicator}});var n=r("./src/components/progress-indicator/progress-indicator.tsx")},"./src/components/progress-indicator/progress-indicator.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ProgressIndicator:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./src/styles/style.scss"),g=r.n(m),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/components/player/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,y.connect)((function(e){return{dataLoaded:e.engine.dataLoaded,currentTime:e.seekbar.currentTime,duration:e.engine.duration,isMobile:e.shell.isMobile,adBreak:e.engine.adBreak}}))(n=(0,v.withPlayer)(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"getBufferedPercent",value:function(){var e=this.props.player;if(this.props.duration>0&&e.buffered.length>0){var t=(e.isLive()?e.buffered.end(0)-e.getStartTimeOfDvrWindow():e.buffered.end(0))/this.props.duration*100;return t<100?t:100}return 0}},{key:"render",value:function(e){var t="".concat(Math.round(this.getBufferedPercent()),"%"),r="".concat(e.player.isLive()&&e.player.isOnLiveEdge()?100:e.currentTime/e.duration*100,"%");return(0,f.h)(f.Fragment,null,(0,f.h)("div",{className:g().buffered,style:{width:t}}),e.dataLoaded?(0,f.h)("div",{className:g().progress,style:{width:r}}):void 0)}}]),r}(f.Component))||n)||n;k.displayName="ProgressIndicator"},"./src/components/quality-menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{HeightResolution:function(){return n.HeightResolution},QualityMenu:function(){return n.QualityMenu},getLabelBadgeType:function(){return n.getLabelBadgeType}});var n=r("./src/components/quality-menu/quality-menu.tsx")},"./src/components/quality-menu/quality-menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{HeightResolution:function(){return I},QualityMenu:function(){return D},getLabelBadgeType:function(){return w}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),E=r("./node_modules/react-redux/es/index.js"),b=r("./src/utils/index.ts"),T=r("./src/reducers/settings.ts"),A=r("./src/components/index.ts"),S=r("./src/components/icon/index.ts"),P=r("./src/components/player/index.ts"),C=r("./src/components/event-dispatcher/index.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var I={HD:1080,UHD_4K:2160,UHD_8K:4320};function w(e){var t=Object.keys(A.BadgeType),r=v()(t,5),n=r[0],a=r[2],i=r[4];return e>=I.HD&&e<I.UHD_4K?n:e>=I.UHD_4K&&e<I.UHD_8K?a:e>=I.UHD_8K?i:null}var R=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],M="QualityMenu",D=(n=(0,E.connect)((function(e){return{videoTracks:e.engine.videoTracks}}),(0,b.bindActions)(T.actions)),a=(0,C.withEventDispatcher)(M),i=(0,k.withText)({qualityLabelText:"settings.quality",qualityAutoLabelText:"settings.qualityAuto"}),n(s=(0,P.withPlayer)(s=a(s=i(s=function(e){p()(r,e);var t=x(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"onQualityChange",value:function(e){this.props.updateQuality(e);var t=this.props.player;"auto"===e?t.enableAdaptiveBitrate():t.selectTrack(e),this.props.notifyClick({type:t.Track.VIDEO,track:e})}},{key:"filterUniqueQualities",value:function(e,t){var r=e.length-1,n=e[r];return r>-1&&t.label===n.label?(t.bandwidth>n.bandwidth&&(e[r]=t),e[r].active=t.active||n.active):e.push(t),e}},{key:"render",value:function(e){var t=this,r=e.videoTracks.sort((function(e,t){return e.height<t.height?1:-1})).filter((function(e){return e.bandwidth||e.height})).reduce(this.filterUniqueQualities,[]).map((function(t){return{label:t.label,active:!e.player.isAdaptiveBitrateEnabled()&&t.active,value:t,badgeType:w(t.height)}}));if(r.length>1&&"progressive"!==e.player.streamType){var n,a,i=null===(n=r.find((function(e){return!0===e.value.active})))||void 0===n?void 0:n.value,s=(null==i?void 0:i.label)||"".concat(360,"p");a=R.includes(this.props.player._localPlayer._config.ui.locale)?s+" - "+this.props.qualityAutoLabelText:this.props.qualityAutoLabelText+" - "+s,r.unshift({label:this.props.qualityAutoLabelText,dropdownOptions:{label:a,badgeType:w((null==i?void 0:i.height)||360)},active:e.player.isAdaptiveBitrateEnabled(),value:"auto"})}return(0,_.h)(A.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:S.IconType.Quality,label:e.qualityLabelText,options:r,onMenuChosen:function(e){return t.onQualityChange(e)}})}}]),r}(_.Component))||s)||s)||s)||s);D.displayName=M},"./src/components/rewind/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Rewind:function(){return n.Rewind}});var n=r("./src/components/rewind/rewind.tsx")},"./src/components/rewind/rewind.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{REWIND_DEFAULT_STEP:function(){return j},Rewind:function(){return B}});var n,a,i,s,o,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),P=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./src/components/icon/index.ts"),x=r("./src/utils/with-animation.tsx"),I=r("./src/components/player/index.ts"),w=r("./src/components/event-dispatcher/index.ts"),R=r("./src/components/logger/index.ts"),M=r("./src/components/tooltip/index.ts"),D=r("./src/components/button/index.ts"),O=r("./node_modules/react-redux/es/index.js"),L=r("./src/components/button-control/index.ts");function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}var U="Rewind",j=10,B=(n=(0,O.connect)((function(e){return{isDvr:e.engine.isDvr,isLive:e.engine.isLive}})),a=(0,R.withLogger)(U),i=(0,w.withEventDispatcher)(U),s=(0,x.withAnimation)(A().rotate),o=(0,P.withText)((function(e){return{rewindText:(0,S.h)(P.Text,{id:"controls.secondsRewind",fields:{seconds:e.step||j}})}})),n(l=(0,I.withPlayer)(l=a(l=i(l=s(l=o(l=function(e){g()(r,e);var t=N(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"onClick",(function(){var t,r=e.props.player;e.props.animate();var n=e.props.step||j,a=r.currentTime,i=r.isLive()?r.getStartTimeOfDvrWindow():0;r.currentTime-n<i?e.props.isDvr||(t=i):t=r.currentTime-n,r.currentTime=t,e.props.notifyClick({from:a,to:t})})),e}return p()(r,[{key:"_shouldRender",value:function(){var e=!(this.props.isLive&&!this.props.isDvr);return this.props.onToggle(U,e),e}},{key:"render",value:function(e){var t=e.step,r=e.rewindText,n=e.innerRef;return this._shouldRender()?(0,S.h)(L.ButtonControl,{name:U,className:A().noIdleControl},(0,S.h)(M.Tooltip,{label:r},(0,S.h)(D.Button,{tabIndex:"0","aria-label":r,className:"".concat(A().controlButton),ref:n,onClick:this.onClick},(0,S.h)(C.default,{type:t&&t!==j?C.IconType.Rewind:C.IconType.Rewind10})))):void 0}}]),r}(S.Component))||l)||l)||l)||l)||l)||l);B.displayName=U},"./src/components/scrollable/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Scrollable:function(){return n.Scrollable}});var n=r("./src/components/scrollable/scrollable.tsx")},"./src/components/scrollable/scrollable.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Scrollable:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),s=r.n(i),o=r("./node_modules/preact/dist/preact.module.js"),l=r("./node_modules/preact/hooks/dist/hooks.module.js"),u=r("./src/styles/style.scss"),c=r.n(u),d=function(e){var t=e.children,r=e.isVertical,n=(0,l.useRef)(null),i=(0,l.useRef)(null),u=(0,l.useState)(!1),d=s()(u,2),p=d[0],h=d[1],f=(0,l.useState)(-1),m=s()(f,2),g=m[0],y=m[1],v=(0,l.useState)(-1),_=s()(v,2),k=_[0],E=_[1],b=function(){clearTimeout(g),h(!0),y(window.setTimeout((function(){h(!1)}),250))},T=function(e){e.preventDefault(),(null==n?void 0:n.current)&&(n.current.scrollLeft+=e.deltaY,b())};(0,l.useLayoutEffect)((function(){if(r&&(null==n?void 0:n.current)&&(null==i?void 0:i.current)){var e,t=n.current,a=null===(e=t.parentElement)||void 0===e?void 0:e.clientHeight;if(a){var s=getComputedStyle(t.parentElement),o=a-(parseFloat(s.paddingTop)+parseFloat(s.paddingBottom));i.current.clientHeight>o?E(o):-1!==k&&E(-1)}}}));var A=(0,l.useMemo)((function(){return r?{onScroll:b}:{onWheel:T,ref:n}}),[r]);return(0,o.h)("div",a()({className:"".concat(c().scrollable," ").concat(p?c().scrolling:""," ").concat(r?c().vertical:c().horizontal),style:"".concat(r&&k>-1?"height: ".concat(k,"px"):""),ref:n},A),(0,o.h)("div",{className:c().itemsContainer,ref:i},t))}},"./src/components/seekbar-live-playback-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarLivePlaybackContainer:function(){return n.SeekBarLivePlaybackContainer}});var n=r("./src/components/seekbar-live-playback-container/seekbar-live-playback-container.tsx")},"./src/components/seekbar-live-playback-container/seekbar-live-playback-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarLivePlaybackContainer:function(){return x}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/react-redux/es/index.js"),_=r("./src/utils/index.ts"),k=r("./src/reducers/seekbar.ts"),E=r("./src/components/seekbar/index.ts"),b=r("./src/components/player/index.ts"),T=r("./src/event/index.ts"),A=r("./src/components/logger/index.ts"),S=r("./src/components/event-dispatcher/index.ts");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var C="SeekBarLivePlaybackContainer",x=(n=(0,v.connect)((function(e){return{currentTime:e.seekbar.currentTime,virtualTime:e.seekbar.virtualTime,isDraggingActive:e.seekbar.draggingActive,isMobile:e.shell.isMobile,poster:e.engine.poster,isDvr:e.engine.isDvr,dataLoaded:e.engine.dataLoaded}}),(0,_.bindActions)(k.actions)),a=(0,S.withEventDispatcher)(C),i=(0,A.withLogger)(C),n(s=(0,b.withPlayer)(s=(0,T.withEventManager)(s=a(s=i(s=function(e){p()(r,e);var t=P(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.eventManager,r=e.player,n=e.isDraggingActive,a=e.updateCurrentTime;t.listen(r,r.Event.TIME_UPDATE,(function(){n||a(Math.max(r.normalizedCurrentTime,0))})),t.listen(r,r.Event.LOADED_DATA,(function(){a(Math.max(r.normalizedCurrentTime,0))}))}},{key:"render",value:function(e){var t=this;if(e.isDvr)return(0,y.h)(E.SeekBar,{playerElement:this.props.playerContainer,showFramePreview:this.props.showFramePreview,showTimeBubble:this.props.showTimeBubble,changeCurrentTime:function(e){t.props.player.isOnLiveEdge()&&e===t.duration||(t.props.player.normalizedCurrentTime=e)},playerPoster:this.props.poster,updateSeekbarDraggingStatus:function(e){return t.props.updateSeekbarDraggingStatus(e)},updateSeekbarHoverActive:function(e){return t.props.updateSeekbarHoverActive(e)},updateSeekbarClientRect:function(e){return t.props.updateSeekbarClientRect(e)},updateCurrentTime:function(e){return t.props.updateCurrentTime(e)},updateVirtualTime:function(e){return t.props.updateVirtualTime(e)},isDvr:this.props.isDvr,currentTime:this.currentTime,virtualTime:this.props.virtualTime,duration:this.duration,isDraggingActive:this.props.isDraggingActive,isMobile:this.props.isMobile,notifyChange:function(e){return t.props.notifyChange(e)},forceFullProgress:this.props.player.isOnLiveEdge(),dataLoaded:this.props.dataLoaded})}},{key:"currentTime",get:function(){return Math.min(this.props.currentTime,this.duration)}},{key:"duration",get:function(){return this.props.player.normalizedDuration}}]),r}(y.Component))||s)||s)||s)||s)||s);x.displayName=C},"./src/components/seekbar-playback-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarPlaybackContainer:function(){return n.SeekBarPlaybackContainer}});var n=r("./src/components/seekbar-playback-container/seekbar-playback-container.tsx")},"./src/components/seekbar-playback-container/seekbar-playback-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarPlaybackContainer:function(){return x}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/react-redux/es/index.js"),_=r("./src/utils/index.ts"),k=r("./src/reducers/seekbar.ts"),E=r("./src/components/seekbar/index.ts"),b=r("./src/components/player/index.ts"),T=r("./src/event/index.ts"),A=r("./src/components/logger/index.ts"),S=r("./src/components/event-dispatcher/index.ts");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var C="SeekBarPlaybackContainer",x=(n=(0,v.connect)((function(e){return{currentTime:e.seekbar.currentTime,virtualTime:e.seekbar.virtualTime,duration:e.engine.duration,isDraggingActive:e.seekbar.draggingActive,isMobile:e.shell.isMobile,poster:e.engine.poster,dataLoaded:e.engine.dataLoaded}}),(0,_.bindActions)(k.actions)),a=(0,A.withLogger)(C),i=(0,S.withEventDispatcher)(C),n(s=(0,b.withPlayer)(s=(0,T.withEventManager)(s=a(s=i(s=function(e){p()(r,e);var t=P(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"componentDidMount",value:function(){var e=this;this.props.eventManager.listen(this.props.player,this.props.player.Event.TIME_UPDATE,(function(){e.props.isDraggingActive||e.props.updateCurrentTime(e.props.player.currentTime)}))}},{key:"render",value:function(){var e=this;return(0,y.h)(E.SeekBar,{playerElement:this.props.playerContainer,showFramePreview:this.props.showFramePreview,showTimeBubble:this.props.showTimeBubble,changeCurrentTime:function(t){return e.props.player.currentTime=t},playerPoster:this.props.poster,updateSeekbarDraggingStatus:function(t){return e.props.updateSeekbarDraggingStatus(t)},updateSeekbarHoverActive:function(t){return e.props.updateSeekbarHoverActive(t)},updateSeekbarClientRect:function(t){return e.props.updateSeekbarClientRect(t)},updateCurrentTime:function(t){return e.props.updateCurrentTime(t)},updateVirtualTime:function(t){return e.props.updateVirtualTime(t)},currentTime:this.props.currentTime,virtualTime:this.props.virtualTime,duration:this.props.duration,isDraggingActive:this.props.isDraggingActive,isMobile:this.props.isMobile,notifyChange:function(t){return e.props.notifyChange(t)},dataLoaded:this.props.dataLoaded})}}]),r}(y.Component))||s)||s)||s)||s)||s);x.displayName=C},"./src/components/seekbar-preview/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarPreview:function(){return n.SeekBarPreview}});var n=r("./src/components/seekbar-preview/seekbar-preview.tsx")},"./src/components/seekbar-preview/seekbar-preview.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarPreview:function(){return E}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./src/styles/style.scss"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/react-redux/es/index.js"),_=r("./src/components/player/index.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var E=(n=(0,v.connect)((function(e){return{duration:e.engine.duration}})),(0,_.withPlayer)(a=n(a=function(e){c()(r,e);var t=k(r);function r(){return s()(this,r),t.apply(this,arguments)}return l()(r,[{key:"_getFramePreviewImgStyle",value:function(e){var t="background: url(".concat(e.url,");");return t+="background-position: -".concat(e.x,"px -").concat(e.y,"px;")}},{key:"_getFramePreviewImgContainerStyle",value:function(e){return{height:"".concat(e.height+4,"px"),width:"".concat(e.width+4,"px")}}},{key:"render",value:function(){var e=this.props.player.getThumbnail(this.props.virtualTime);if(e)return(0,y.h)("div",{style:this._getFramePreviewImgContainerStyle(e),className:[g().framePreviewImgContainer,g().nonSticky].join(" ")},(0,y.h)("div",{className:g().framePreviewImg,style:this._getFramePreviewImgStyle(e)}))}}]),r}(y.Component))||a)||a);E.displayName="SeekBarPreview"},"./src/components/seekbar/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBar:function(){return n.SeekBar}});var n=r("./src/components/seekbar/seekbar.tsx")},"./src/components/seekbar/seekbar.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBar:function(){return K}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),P=r("./src/utils/index.ts"),C=r("./node_modules/react-redux/es/index.js"),x=r("./src/reducers/shell.ts"),I=r("./src/components/player/index.ts"),w=r("./src/components/keyboard/index.ts"),R=r("./src/reducers/overlay-action.ts"),M=r("./src/components/icon/index.ts"),D=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),O=r("./src/components/player-area/index.ts"),L=r("./src/event/index.ts"),N=r("./src/components/seekbar-preview/index.ts"),U=r("./src/components/progress-indicator/index.ts"),j=r("./src/components/shell/index.ts");function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var G="SeekBar",H={sliderAriaLabel:(0,S.h)(D.Text,{id:"controls.seekBarSlider"},"Seek bar"),valuetextLabel:(0,S.h)(D.Text,{id:"controls.valuetextLabel"},"of")},K=(n=(0,C.connect)((function(e){return{config:e.config.components.seekbar,isMobile:e.shell.isMobile,previewHoverActive:e.seekbar.previewHoverActive,hidePreview:e.seekbar.hidePreview,hideTimeBubble:e.seekbar.hideTimeBubble,segments:e.seekbar.segments,seekbarClasses:e.seekbar.seekbarClasses,isPreventSeek:e.seekbar.isPreventSeek,playerSize:e.shell.playerSize}}),(0,P.bindActions)(V(V({},x.actions),R.actions))),a=(0,w.withKeyboardEvent)(G),i=(0,D.withText)(H),n(s=(0,I.withPlayer)(s=(0,L.withEventManager)(s=a(s=i(s=function(e){g()(r,e);var t=B(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"_seekBarElement",void 0),b()(f()(e),"_framePreviewElement",void 0),b()(f()(e),"_timeBubbleElement",void 0),b()(f()(e),"_keyboardEventHandlers",[{key:{code:P.KeyMap.LEFT},action:function(t){e.handleKeydown(t,!1)}},{key:{code:P.KeyMap.RIGHT},action:function(t){e.handleKeydown(t,!1)}},{key:{code:P.KeyMap.HOME},action:function(t){e.handleKeydown(t,!1)}},{key:{code:P.KeyMap.END},action:function(t){e.handleKeydown(t,!1)}}]),b()(f()(e),"handleUpdateSeekBarClientRect",(function(){var t=e._seekBarElement.getBoundingClientRect();e.props.updateSeekbarClientRect(t)})),b()(f()(e),"onSeekbarMouseDown",(function(t){if(!e.props.isMobile&&!e.props.previewHoverActive&&(t.preventDefault(),t.stopPropagation(),e.props.updateSeekbarDraggingStatus(!0),e.props.isDraggingActive)){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration)}})),b()(f()(e),"onPlayerMouseUp",(function(t){if(!e.props.isMobile&&!e.props.previewHoverActive&&e.props.isDraggingActive){var r=e.props.currentTime,n=e.getTime(t);e.props.changeCurrentTime(n),e.updateSeekBarProgress(n,e.props.duration),e.props.updateSeekbarDraggingStatus(!1),e.props.notifyChange({from:r,to:n})}})),b()(f()(e),"onPlayerMouseMove",(function(t){if(!e.props.isMobile&&e.props.isDraggingActive){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration),e.updateSeekBarProgress(r,e.props.duration,!0)}})),b()(f()(e),"onSeekbarMouseMove",(function(t){if(!e.props.isMobile&&!e.props.previewHoverActive){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration,!0)}})),b()(f()(e),"onSeekbarTouchStart",(function(t){if(e.props.updateSeekbarDraggingStatus(!0),e.props.isDraggingActive){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration)}})),b()(f()(e),"onSeekbarTouchMove",(function(t){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration,!0),e.props.isDraggingActive&&e.updateSeekBarProgress(r,e.props.duration),t.preventDefault()})),b()(f()(e),"onKeyDown",(function(t){switch(t.keyCode){case P.KeyMap.LEFT:case P.KeyMap.RIGHT:e.handleKeydown(t,!0);break;case P.KeyMap.ENTER:case P.KeyMap.SPACE:t.preventDefault(),t.stopPropagation(),e.togglePlayPause()}})),b()(f()(e),"togglePlayPause",(function(){e.props.player.paused?e.props.player.play():e.props.player.pause()})),b()(f()(e),"onSeekbarTouchEnd",(function(t){if(e.props.isDraggingActive){var r=e.getTime(t),n=e.props.currentTime,a=r;e.props.changeCurrentTime(a),e.updateSeekBarProgress(a,e.props.duration),e.props.notifyChange({from:n,to:a})}e.props.updateSeekbarDraggingStatus(!1)})),b()(f()(e),"onSeekbarMouseOver",(function(){e.props.isMobile||e.props.updateSeekbarHoverActive(!0)})),b()(f()(e),"onSeekbarMouseLeave",(function(){e.props.isMobile||e.props.updateSeekbarHoverActive(!1)})),e}return p()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.player,n=t.eventManager,a=this._seekBarElement.getBoundingClientRect();this.props.updateSeekbarClientRect(a);var i=[j.PLAYER_SIZE.TINY,j.PLAYER_SIZE.EXTRA_SMALL,j.PLAYER_SIZE.SMALL];n.listenOnce(r,r.Event.UI.USER_CLICKED_PLAY,(function(){n.listenOnce(r,r.Event.Core.FIRST_PLAY,(function(){var t;i.includes(e.props.playerSize)&&(null===(t=e._seekBarElement)||void 0===t||t.focus())}))})),n.listen(r,L.EventType.BOTTOM_BAR_CLIENT_RECT_CHANGED,this.handleUpdateSeekBarClientRect),document.addEventListener("mouseup",this.onPlayerMouseUp),document.addEventListener("mousemove",this.onPlayerMouseMove),this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.onPlayerMouseUp),document.removeEventListener("mousemove",this.onPlayerMouseMove)}},{key:"handleKeydown",value:function(e,t){var r=this,n=this.props,a=n.duration,i=n.currentTime,s=function(e,t){r.props.changeCurrentTime(t),r.updateSeekBarProgress(t,a,!0),r.props.notifyChange({from:e,to:t})};switch(this.props.updatePlayerHoverState(!0),e.keyCode){case P.KeyMap.LEFT:t||this.props.updateOverlayActionIcon(M.IconType.Rewind),s(i,i-1>0?i-1:0);break;case P.KeyMap.RIGHT:t||this.props.updateOverlayActionIcon(M.IconType.Forward),s(i,i+1>a?a:i+1);break;case P.KeyMap.HOME:t||this.props.updateOverlayActionIcon(M.IconType.StartOver),s(i,0);break;case P.KeyMap.END:t||this.props.updateOverlayActionIcon(M.IconType.SeekEnd),s(i,a)}}},{key:"updateSeekBarProgress",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.props.updateVirtualTime(e):this.props.updateCurrentTime(e)}},{key:"getOffset",value:function(e){for(var t=0,r=0;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft-e.scrollLeft+this._getTransformX(e),r+=e.offsetTop-e.scrollTop,e=e.offsetParent;return this.props.player.isFullscreen()&&(t=0),{top:r,left:t}}},{key:"_getTransformX",value:function(e){var t=getComputedStyle(e),r=(t.getPropertyValue("transform")||t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")).match(/-?\d+/g),n=0;return r&&r.length>0&&(n=parseFloat(r[4])),n}},{key:"getTime",value:function(e){var t,r=("number"==typeof e.clientX?e.clientX:null==e||null===(t=e.changedTouches[0])||void 0===t?void 0:t.clientX)-this._seekBarElement.getBoundingClientRect().left,n=parseFloat((this.props.duration/this._seekBarElement.offsetWidth*r).toFixed(2));return n<0?0:n>this.props.duration?this.props.duration:n}},{key:"getFramePreviewOffset",value:function(){if(this._seekBarElement&&this._framePreviewElement){var e=this.props.virtualTime/this.props.duration*this._seekBarElement.clientWidth-this._framePreviewElement.clientWidth/2;return e<0?0:e>this._seekBarElement.clientWidth-this._framePreviewElement.clientWidth?this._seekBarElement.clientWidth-this._framePreviewElement.clientWidth:e}return 0}},{key:"getTimeBubbleOffset",value:function(){if(this._timeBubbleElement){var e=this.props.virtualTime/this.props.duration*this._seekBarElement.clientWidth-this._timeBubbleElement.clientWidth/2;return e<0?0:e>this._seekBarElement.clientWidth-this._timeBubbleElement.clientWidth?this._seekBarElement.clientWidth-this._timeBubbleElement.clientWidth:e}return 0}},{key:"renderFramePreview",value:function(){var e=this;if(this.props.showFramePreview&&!this.props.isMobile&&!this.props.isPreventSeek)return(0,S.h)("div",{className:this.props.hidePreview?[A().framePreview,A().hideFramePreview].join(" "):A().framePreview,style:this._getFramePreviewStyle(),ref:function(t){return t?e._framePreviewElement=t:void 0}},(0,S.h)(N.SeekBarPreview,{virtualTime:this.props.virtualTime}))}},{key:"_getFramePreviewStyle",value:function(){return"left: ".concat(this.getFramePreviewOffset(),"px;")}},{key:"renderTimeBubble",value:function(){var e=this;if(!this.props.hideTimeBubble&&this.props.showTimeBubble&&!this.props.isMobile){var t="left: ".concat(this.getTimeBubbleOffset(),"px"),r=this.props.isDvr?"-"+(0,P.toHHMMSS)(this.props.duration-this.props.virtualTime):(0,P.toHHMMSS)(this.props.virtualTime);return(0,S.h)("div",{className:A().timePreview,style:t,ref:function(t){return t?e._timeBubbleElement=t:void 0}},r)}}},{key:"render",value:function(e,t){var r,n=this,a="".concat(e.virtualTime/e.duration*100,"%"),i="".concat(e.currentTime/e.duration*(null===(r=this._seekBarElement)||void 0===r?void 0:r.clientWidth),"px"),s=[A().seekBar].concat(l()(e.seekbarClasses));return e.adBreak&&s.push(A().adBreak),e.isDvr&&s.push(A().live),e.isMobile&&s.push(A().hover),e.isDraggingActive&&s.push(A().hover),t.resizing&&s.push(A().resizing),(0,S.h)("div",{tabIndex:0,className:s.join(" "),ref:function(e){return e?n._seekBarElement=e:void 0},role:"slider","aria-label":e.sliderAriaLabel,"aria-valuemin":0,"aria-valuemax":Math.round(this.props.duration),"aria-valuenow":Math.round(this.props.currentTime),"aria-valuetext":"".concat((0,P.getDurationAsText)(e.currentTime,e.player.config.ui.locale,!0)," ").concat(this.props.valuetextLabel," ").concat((0,P.getDurationAsText)(e.duration,e.player.config.ui.locale,!0)),onMouseOver:this.onSeekbarMouseOver,onMouseLeave:this.onSeekbarMouseLeave,onMouseMove:this.onSeekbarMouseMove,onMouseDown:this.onSeekbarMouseDown,onTouchStart:this.onSeekbarTouchStart,onTouchMove:this.onSeekbarTouchMove,onTouchEnd:this.onSeekbarTouchEnd,onKeyDown:this.onKeyDown},(0,S.h)("div",{className:A().progressBar},(0,S.h)(O.PlayerArea,{name:"SeekBar",shouldUpdate:!0},this.renderFramePreview(),this.renderTimeBubble(),(0,S.h)(U.ProgressIndicator,null),e.adBreak?void 0:(0,S.h)("div",{id:"scrubber-container",style:"transform: translateX(".concat(i,")")},(0,S.h)("div",{id:"scrubber",className:A().scrubber})),(0,S.h)("div",{className:A().virtualProgress,style:{width:a}},(0,S.h)("div",{className:A().virtualProgressIndicator})))))}}]),r}(S.Component))||s)||s)||s)||s)||s);K.displayName=G},"./src/components/settings/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Settings:function(){return n.Settings}});var n=r("./src/components/settings/settings.tsx")},"./src/components/settings/settings.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Settings:function(){return $}});var n,a,i,s,o,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./node_modules/react-redux/es/index.js"),C=r("./src/utils/index.ts"),x=r("./src/reducers/settings.ts"),I=r("./src/components/index.ts"),w=r("./src/components/icon/index.ts"),R=r("./src/components/player/index.ts"),M=r("./src/event/index.ts"),D=r("./src/reducers/overlay-action.ts"),O=r("./src/components/tooltip/index.ts"),L=r("./src/components/button/index.ts"),N=r("./src/components/button-control/index.ts"),U=r("./node_modules/preact/compat/dist/compat.module.js"),j=r("./src/components/keyboard/index.ts"),B=r("./src/components/logger/index.ts"),F=r("./src/event/events/speed-selected-event.ts"),V=r("./src/components/overlay-portal/index.ts");function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){E()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var W="Settings",$=(n=(0,P.connect)((function(e){return{audioTracks:e.engine.audioTracks,textTracks:e.engine.textTracks,videoTracks:e.engine.videoTracks,isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,isLive:e.engine.isLive,isAudio:e.engine.isAudio,showQualityMenu:e.config.settings.showQualityMenu,showAudioMenu:e.config.settings.showAudioMenu,showCaptionsMenu:e.config.settings.showCaptionsMenu,showSpeedMenu:e.config.settings.showSpeedMenu,showAdvancedAudioDescToggle:e.config.settings.showAdvancedAudioDescToggle}}),(0,C.bindActions)(K(K({},x.actions),D.actions))),a=(0,S.withText)((function(){return{buttonLabel:(0,A.h)(S.Text,{id:"controls.settings"},"Settings"),qualityHdLabel:(0,A.h)(S.Text,{id:"settings.qualityHdLabel"},"Quality is HD"),quality4kLabel:(0,A.h)(S.Text,{id:"settings.quality4kLabel"},"Quality is 4k"),quality8kLabel:(0,A.h)(S.Text,{id:"settings.quality8kLabel"},"Quality is 8k")}})),i=(0,j.withKeyboardEvent)(W),s=(0,B.withLogger)(W),n(o=a(o=(0,R.withPlayer)(o=(0,M.withEventManager)(o=i(o=s(o=function(e){m()(r,e);var t=G(r);function r(){var e;u()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),E()(h()(e),"_controlSettingsElement",void 0),E()(h()(e),"_buttonRef",null),E()(h()(e),"_lastActiveTextLanguage",""),E()(h()(e),"_keyboardEventHandlers",[{key:{code:C.KeyMap.PERIOD,shiftKey:!0},action:function(t){e.handleKeydown(t)}},{key:{code:C.KeyMap.SEMI_COLON,shiftKey:!0},action:function(t){e.handleKeydown(t)}},{key:{code:C.KeyMap.COMMA,shiftKey:!0},action:function(t){e.handleKeydown(t)}}]),E()(h()(e),"onControlButtonClick",(function(t,r){e.setState((function(e){return{smartContainerOpen:!e.smartContainerOpen}})),r&&e.state.smartContainerOpen&&(0,C.focusElement)(e._buttonRef)})),E()(h()(e),"setButtonRef",(function(t){e._buttonRef=t})),E()(h()(e),"toggleCVAAOverlay",(function(){e.setState((function(e){return{cvaaOverlay:!e.cvaaOverlay}}))})),E()(h()(e),"onCVAAOverlayClose",(function(t,r){e.toggleCVAAOverlay(),e.onControlButtonClick(t,r)})),e}return d()(r,[{key:"componentWillMount",value:function(){this.setState({smartContainerOpen:!1,cvaaOverlay:!1})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.eventManager;t.listen(document,"click",(function(t){return e.handleClickOutside(t)})),t.listen(document,"keydown",(function(t){return e.handleCCToggle(t)})),this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"handleKeydown",value:function(e){var t,r,n=this.props,a=n.player,i=n.logger;switch(e.keyCode){case C.KeyMap.PERIOD:t=a.playbackRate,(r=a.playbackRates.indexOf(t))<a.playbackRates.length-1&&(i.debug("Changing playback rate. ".concat(t," => ").concat(a.playbackRates[r+1])),a.playbackRate=a.playbackRates[r+1],this.props.updateOverlayActionIcon(w.IconType.SpeedUp),a.dispatchEvent(new F.SpeedSelectedEvent(a.playbackRate)));break;case C.KeyMap.SEMI_COLON:a.playbackRate!==a.defaultPlaybackRate&&(i.debug("Changing playback rate. ".concat(a.playbackRate," => ").concat(a.defaultPlaybackRate)),a.playbackRate=a.defaultPlaybackRate,this.props.updateOverlayActionIcon(w.IconType.Speed),a.dispatchEvent(new F.SpeedSelectedEvent(a.playbackRate)));break;case C.KeyMap.COMMA:t=a.playbackRate,(r=a.playbackRates.indexOf(t))>0&&(i.debug("Changing playback rate. ".concat(t," => ").concat(a.playbackRates[r-1])),a.playbackRate=a.playbackRates[r-1],this.props.updateOverlayActionIcon(w.IconType.SpeedDown),a.dispatchEvent(new F.SpeedSelectedEvent(a.playbackRate)))}}},{key:"handleCCToggle",value:function(e){var t=this;if("c"===e.key||"C"===e.key){var r=this.props,n=r.player,a=r.logger,i=n.getActiveTracks().text;if(i)if("off"===i.language&&this._lastActiveTextLanguage){a.debug("Changing text track to language",this._lastActiveTextLanguage);var s=n.getTracks("text").find((function(e){return e.language===t._lastActiveTextLanguage}));n.selectTrack(s)}else"off"===i.language||this._lastActiveTextLanguage||(a.debug("Hiding text track"),this._lastActiveTextLanguage=i.language,n.hideTextTrack())}}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.textTracks.find((function(e){return e.active})),r=e.textTracks.find((function(e){return e.active}));t&&"off"!==t.language&&r&&"off"===r.language?this._lastActiveTextLanguage=t.language:r&&"off"!==r.language&&(this._lastActiveTextLanguage="")}},{key:"handleClickOutside",value:function(e){this.state.cvaaOverlay||this.props.isMobile||this.props.isSmallSize||!this._controlSettingsElement||this._controlSettingsElement.contains(e.target)||!this.state.smartContainerOpen||this.setState({smartContainerOpen:!1})}},{key:"getButtonBadgeType",value:function(){var e,t,r=null===(e=this.props.player.getActiveTracks())||void 0===e||null===(t=e.video)||void 0===t?void 0:t.height;return r?(0,I.getLabelBadgeType)(r):null}},{key:"getQualityLabel",value:function(e){switch(e){case"qualityHd":return this.props.qualityHdLabel;case"quality4k":return this.props.quality4kLabel;case"quality8k":return this.props.quality8kLabel;default:return""}}},{key:"render",value:function(e){var t=this,r=e.showAudioMenu&&e.audioTracks.length>1,n=e.showAdvancedAudioDescToggle,a=e.showCaptionsMenu&&e.textTracks.length>1,i=e.showQualityMenu&&!e.isAudio&&e.videoTracks.length>1,s=e.showSpeedMenu&&e.player.playbackRates.length>1&&!e.isLive;if((r||a||i||s)&&(!(e.isLive&&e.videoTracks.length<=1)||r||a)){var o=this.getButtonBadgeType()||"",l="".concat(e.buttonLabel," ").concat(this.getQualityLabel(o)," ");return(0,A.h)(N.ButtonControl,{name:W,ref:function(e){return e?t._controlSettingsElement=e:void 0}},(0,A.h)(O.Tooltip,{label:e.buttonLabel},(0,A.h)(L.Button,{ref:this.setButtonRef,tabIndex:"0","aria-label":l,"aria-haspopup":"true","aria-expanded":this.state.smartContainerOpen,className:[T().controlButton,T().buttonBadge,w.BadgeType[o+"Active"],this.state.smartContainerOpen?T().active:""].join(" "),onClick:this.onControlButtonClick},(0,A.h)(w.default,{type:w.IconType.Settings}))),this.state.smartContainerOpen&&!this.state.cvaaOverlay&&(0,A.h)(I.SmartContainer,{title:(0,A.h)(S.Text,{id:"settings.title"}),onClose:this.onControlButtonClick},n&&(0,A.h)(I.AdvancedAudioDescToggle,null),r&&(0,A.h)(I.AudioMenu,null),a&&(0,A.h)(I.CaptionsMenu,{asDropdown:!0,onAdvancedCaptionsClick:this.toggleCVAAOverlay}),i&&(0,A.h)(I.QualityMenu,null),s&&(0,A.h)(I.SpeedMenu,null)),this.state.cvaaOverlay?(0,U.createPortal)((0,A.h)(I.CVAAOverlay,{onClose:this.onCVAAOverlayClose}),(0,V.getOverlayPortalElement)(e.player)):(0,A.h)("div",null))}}}]),r}(A.Component))||o)||o)||o)||o)||o)||o);$.displayName=W},"./src/components/shell/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PLAYER_BREAK_POINTS:function(){return n.PLAYER_BREAK_POINTS},PLAYER_SIZE:function(){return n.PLAYER_SIZE},Shell:function(){return n.Shell}});var n=r("./src/components/shell/shell.tsx")},"./src/components/shell/shell.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PLAYER_BREAK_POINTS:function(){return V},PLAYER_SIZE:function(){return F},Shell:function(){return H}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),P=r("./node_modules/react-redux/es/index.js"),C=r("./src/utils/index.ts"),x=r("./src/reducers/shell.ts"),I=r("./src/reducers/engine.ts"),w=r("./src/components/player/index.ts"),R=r("./src/event/index.ts"),M=r("./src/components/event-dispatcher/index.ts"),D=r("./src/components/logger/index.ts"),O=r("./src/utils/resize-watcher.ts"),L=r("./src/utils/debounce.ts");function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var B=100,F={TINY:"tiny",EXTRA_SMALL:"extrasmall",SMALL:"small",MEDIUM:"medium",LARGE:"large",EXTRA_LARGE:"extralarge"},V={TINY:280,EXTRA_SMALL:380,SMALL:480,MEDIUM:768,LARGE:1024},G="Shell",H=(n=(0,P.connect)((function(e){return{targetId:e.config.targetId,forceTouchUI:e.config.forceTouchUI,hoverTimeout:e.config.hoverTimeout,metadataLoaded:e.engine.metadataLoaded,currentState:e.engine.playerState.currentState,playerClasses:e.shell.playerClasses,isMobile:e.shell.isMobile,playerSize:e.shell.playerSize,isCasting:e.engine.isCasting,guiClientRect:e.shell.guiClientRect,playerHover:e.shell.playerHover,playerNav:e.shell.playerNav,seekbarDraggingActive:e.seekbar.draggingActive,seekbarHoverActive:e.seekbar.hoverActive,volumeHoverActive:e.volume.hover,adBreak:e.engine.adBreak,prePlayback:e.engine.prePlayback,smartContainerOpen:e.shell.smartContainerOpen,fullscreen:e.engine.fullscreen,fallbackToMutedAutoPlay:e.engine.fallbackToMutedAutoPlay,playlist:e.engine.playlist,tinySizeDisabled:e.config.tinySizeDisabled,isCopyProtected:e.config.isCopyProtected}}),(0,C.bindActions)(j(j({},x.actions),I.actions))),a=(0,D.withLogger)(G),i=(0,M.withEventDispatcher)(G),n(s=(0,w.withPlayer)(s=(0,R.withEventManager)(s=a(s=i(s=function(e){g()(r,e);var t=N(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"hoverTimeout",null),b()(f()(e),"_environmentClasses",void 0),b()(f()(e),"_playerResizeWatcher",void 0),b()(f()(e),"_playerRef",null),b()(f()(e),"onMouseLeave",(function(t){Object.prototype.hasOwnProperty.call(t,"toElement")&&(e.props.isMobile||e.state.hover&&e._updatePlayerHover(!1))})),b()(f()(e),"onMouseMove",(function(){e.props.isMobile||(e.state.nav&&(e.setState({nav:!1}),e.props.updatePlayerNavState(!1)),e._updatePlayerHoverState())})),b()(f()(e),"onMouseUp",(function(){e.unMuteFallback(),e.props.notifyClick(),e._startHoverTimeout()})),b()(f()(e),"onTouchEnd",(function(t){e.props.prePlayback||(e.props.fallbackToMutedAutoPlay&&(e.props.player.muted=!1),e.state.hover||t.stopPropagation(),e._updatePlayerHoverState())})),b()(f()(e),"onKeyDown",(function(t){var r=t.target,n=r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement||r.isContentEditable;e.state.nav||t.keyCode!==C.KeyMap.TAB||(e.setState({nav:!0}),e.props.updatePlayerNavState(!0)),e.state.nav&&t.keyCode===C.KeyMap.F&&!n&&e.toggleFullscreen(),!e.state.nav||t.keyCode!==C.KeyMap.ENTER&&t.keyCode!==C.KeyMap.SPACE||(e.unMuteFallback(),t.srcElement.contains(e._playerRef)&&(t.preventDefault(),e.props.player.paused?e.props.player.play():e.props.player.pause()))})),b()(f()(e),"_handleClickOutside",(function(t){var r,n=t.target,a=e.props,i=a.isMobile,s=a.isSmallSize,o=a.updatePlayerNavState;i||s||(null===(r=e._playerRef)||void 0===r?void 0:r.contains(n))||!e.state.nav||(e.setState({nav:!1}),o(!1))})),b()(f()(e),"_onWindowResize",(function(){e._updatePlayerClientRect(),document.body&&e.props.updateDocumentWidth(document.body.clientWidth)})),b()(f()(e),"_updatePlayerClientRect",(function(){var t=document.getElementById(e.props.targetId);t&&e.props.updatePlayerClientRect(t.getBoundingClientRect()),setTimeout((function(){t&&e.props.updatePlayerClientRect(t.getBoundingClientRect())}),B)})),e}return p()(r,[{key:"unMuteFallback",value:function(){this.props.fallbackToMutedAutoPlay&&(this.props.player.muted=!1)}},{key:"toggleFullscreen",value:function(){this.props.player.isFullscreen()?this.props.player.exitFullscreen():this.props.player.enterFullscreen()}},{key:"componentWillMount",value:function(){var e=this.props,t=e.player,r=e.forceTouchUI;this._environmentClasses=["".concat("playkit","-").concat(t.env.os.name.replace(/ /g,"-")),"".concat("playkit","-").concat(t.env.browser.name.replace(/ /g,"-"))];var n=t.env,a=n.isIPadOS,i=n.isTablet,s=n.isMobile;this.props.updateIsMobile(a||i||s||r)}},{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.player,n=t.eventManager;n.listen(window,"resize",(0,L.debounce)(this._onWindowResize,B)),n.listen(document,"scroll",(0,L.debounce)(this._updatePlayerClientRect,B)),n.listen(document,"click",(0,L.debounce)(this._handleClickOutside,B)),this._playerResizeWatcher=new O.ResizeWatcher,this._playerResizeWatcher.init(document.getElementById(this.props.targetId)),n.listen(this._playerResizeWatcher,R.EventType.RESIZE,(0,L.debounce)(this._onWindowResize,B)),n.listen(r,r.Event.FIRST_PLAY,(function(){return e._onWindowResize()})),n.listen(r,R.EventType.PLAYER_HOVERED,(function(){e._updatePlayerHover(!0)})),this._onWindowResize()}},{key:"componentWillUnmount",value:function(){this._clearHoverTimeout(),this._playerResizeWatcher.destroy()}},{key:"_updatePlayerHoverState",value:function(){this.props.prePlayback||(this.state.hover||this._updatePlayerHover(!0),this._startHoverTimeout())}},{key:"_updatePlayerHover",value:function(e){this.props.updatePlayerHoverState(e),this.props.notifyHoverChange({hover:e}),this.setState({hover:e})}},{key:"_canEndHoverState",value:function(){return!this.props.seekbarDraggingActive&&!this.props.seekbarHoverActive&&!this.props.volumeHoverActive&&!this.props.smartContainerOpen&&(!this.props.player.paused||this.props.adBreak)}},{key:"_startHoverTimeout",value:function(){var e=this;this._clearHoverTimeout(),this.props.hoverTimeout&&(this.hoverTimeout=setTimeout((function(){e._canEndHoverState()&&e._updatePlayerHover(!1)}),this.props.hoverTimeout))}},{key:"_clearHoverTimeout",value:function(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)}},{key:"componentDidUpdate",value:function(e){(this.state.hover!==this.props.playerHover||"playing"===this.props.currentState&&"paused"===e.currentState||!this.props.prePlayback&&e.prePlayback||!this.props.adBreak&&e.adBreak||this.props.adBreak&&!e.adBreak)&&(this.state.hover!==this.props.playerHover&&this.props.notifyHoverChange({hover:this.props.playerHover}),this._updatePlayerHoverState())}},{key:"render",value:function(e){var t=this,r=[A().player,A().skinDefault].concat(l()(this._environmentClasses)).concat(e.playerClasses);this.props.prePlayback&&r.push(A().prePlayback),this.props.isCasting&&r.push("".concat("playkit","-casting")),this.props.isCopyProtected&&r.push(A().protected),this.props.isMobile&&r.push(A().touch),this.props.playerNav&&r.push(A().nav),(this.props.playerHover||this.props.playerNav)&&r.push(A().hover),this.props.metadataLoaded&&r.push(A().metadataLoaded),this.props.adBreak&&r.push(A().adBreak),this.props.metadataLoaded&&r.push(A()["state-"+this.props.currentState]),this.props.seekbarDraggingActive&&r.push(A().hover),this.props.fullscreen&&r.push(A().fullscreen),this.props.playlist&&r.push(A().playlist),this.props.guiClientRect&&(this.props.guiClientRect.width<=V.TINY&&!this.props.tinySizeDisabled?(r.push(A().sizeTy),this.props.updatePlayerSize(F.TINY)):this.props.guiClientRect.width<=V.EXTRA_SMALL?(r.push(A().sizeXs),this.props.updatePlayerSize(F.EXTRA_SMALL)):this.props.guiClientRect.width<=V.SMALL?(r.push(A().sizeSm),this.props.updatePlayerSize(F.SMALL)):this.props.guiClientRect.width<=V.MEDIUM?(r.push(A().sizeMd),this.props.updatePlayerSize(F.MEDIUM)):this.props.guiClientRect.width<=V.LARGE?(r.push(A().sizeLg),this.props.updatePlayerSize(F.LARGE)):this.props.updatePlayerSize(F.EXTRA_LARGE),this.props.updateIsSmallSize([F.SMALL,F.EXTRA_SMALL].includes(this.props.playerSize))),r.push("notranslate");var n=r.join(" ");return(0,S.h)("div",{tabIndex:-1,ref:function(e){return t._playerRef=e},className:n,onTouchEnd:this.onTouchEnd,onMouseUp:this.onMouseUp,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,onKeyDown:this.onKeyDown},e.children)}}]),r}(S.Component))||s)||s)||s)||s)||s)},"./src/components/side-panel/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SidePanel:function(){return n.SidePanel}});var n=r("./src/components/side-panel/side-panel.tsx")},"./src/components/side-panel/side-panel.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SidePanel:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/player-area/index.ts"),v=r("./src/reducers/shell.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,r("./node_modules/react-redux/es/index.js").connect)((function(e){return{sidePanelsStyles:e.shell.layoutStyles.sidePanels,playerClientRect:e.shell.playerClientRect,isSmallSize:e.shell.isSmallSize}}))(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,r=t.sidePanelsStyles,n=t.position,a=t.isSmallSize,i=e.sidePanelsStyles,s=e.position;return r[n]!==i[s]||a!==e.isSmallSize}},{key:"render",value:function(e){var t=e.position,r=e.sidePanelsStyles,n=-1!==[v.SidePanelPositions.RIGHT,v.SidePanelPositions.LEFT].indexOf(t)?"verticalSidePanel":"horizontalSidePanel",a=[m().sidePanel,m()[n]];e.isSmallSize&&a.push(m().smallSize);var i="SidePanel".concat(t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()),s=r[t];return(0,g.h)("div",{style:s,className:a.join(" ")},(0,g.h)("div",{className:m().sidePanelContent},(0,g.h)(y.PlayerArea,{name:i})))}}]),r}(g.Component))||n},"./src/components/slider/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Slider:function(){return n.Slider}});var n=r("./src/components/slider/slider.tsx")},"./src/components/slider/slider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Slider:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./src/styles/style.scss"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/utils/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var b=function(e){c()(r,e);var t=E(r);function r(){var e;a()(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e=t.call.apply(t,[this].concat(i)),g()(l()(e),"sliderWidth",void 0),g()(l()(e),"_sliderElement",void 0),g()(l()(e),"_sliderElementOffsetLeft",void 0),g()(l()(e),"mouseDownHandler",(function(t){e._sliderElementOffsetLeft=e._sliderElement.getBoundingClientRect().left,e.state.dragging||e.setState((function(r){return{dragging:!0,value:e.mouseEventToValue(t,r)}}),(function(){e.props.onChange(e.mouseEventToValue(t,e.state))}))})),g()(l()(e),"onKeyDown",(function(t){t.keyCode!==k.KeyMap.LEFT&&t.keyCode!==k.KeyMap.RIGHT||e.onKeyboardDragging(t)})),g()(l()(e),"mouseMoveHandler",(function(t){e.state.dragging&&e.setState((function(r){return{value:e.mouseEventToValue(t,r)}}),(function(){e.props.onChange(e.mouseEventToValue(t,e.state))}))})),g()(l()(e),"mouseUpHandler",(function(t){e.state.dragging&&e.setState((function(r){return{value:e.mouseEventToValue(t,r),dragging:!1}}),(function(){e.props.onChange(e.mouseEventToValue(t,e.state))}))})),e}return s()(r,[{key:"componentWillMount",value:function(){this.setState({value:this.props.value||0,min:this.props.min||0,max:this.props.max||100,dragging:!1}),document.addEventListener("mouseup",this.mouseUpHandler),document.addEventListener("mousemove",this.mouseMoveHandler),document.addEventListener("touchend",this.mouseUpHandler),document.addEventListener("touchmove",this.mouseMoveHandler)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.mouseUpHandler),document.removeEventListener("mousemove",this.mouseMoveHandler),document.removeEventListener("touchend",this.mouseUpHandler),document.removeEventListener("touchmove",this.mouseMoveHandler)}},{key:"componentDidMount",value:function(){this.sliderWidth=this._sliderElement.clientWidth,this._sliderElementOffsetLeft=this._sliderElement.getBoundingClientRect().left}},{key:"onKeyboardDragging",value:function(e){var t=this;e.stopPropagation(),this._sliderElementOffsetLeft=this._sliderElement.getBoundingClientRect().left;var r=this.props.value;switch(e.keyCode){case k.KeyMap.RIGHT:(r+=5)>this.state.max&&(r=this.state.max);break;case k.KeyMap.LEFT:(r-=5)<this.state.min&&(r=this.state.min)}this.setState({value:r,dragging:!1},(function(){t.props.onChange(r)}))}},{key:"mouseEventToValue",value:function(e,t){var r=(e.touches&&e.touches.length>0?e.touches[0].clientX:e.changedTouches?e.changedTouches[0].pageX:e.clientX)-this._sliderElement.getBoundingClientRect().left,n=Math.round(r/this._sliderElement.clientWidth*100);return this.getValueByPersentage(n)<t.min?t.min:this.getValueByPersentage(n)>t.max?t.max:this.getValueByPersentage(n)}},{key:"getValueByPersentage",value:function(e){return this.state.max/100*e}},{key:"getPercentageByValue",value:function(){return Math.round(this.state.value/this.state.max*100)}},{key:"render",value:function(e){var t=this;return(0,_.h)("div",{role:"slider","aria-valuemin":this.state.min,"aria-valuenow":this.state.value,"aria-valuemax":this.state.max,"aria-labelledby":e.name,tabIndex:0,ref:function(r){r&&(t._sliderElement=r,e.pushRef&&e.pushRef(r))},className:v().slider,onMouseDown:this.mouseDownHandler,onTouchStart:this.mouseDownHandler,onKeyDown:this.onKeyDown},(0,_.h)("div",{className:v().progress,style:{width:this.getPercentageByValue()+"%"}},(0,_.h)("div",{className:v().handle,onMouseDown:this.mouseDownHandler,onTouchStart:this.mouseDownHandler})))}}]),r}(_.Component);b.displayName="Slider"},"./src/components/smart-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SmartContainer:function(){return n.SmartContainer},SmartContainerItem:function(){return a.SmartContainerItem}});var n=r("./src/components/smart-container/smart-container.tsx"),a=r("./src/components/smart-container/smart-container-item.tsx")},"./src/components/smart-container/smart-container-item.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SmartContainerItem:function(){return k}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./src/styles/style.scss"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js"),g=r("./src/components/dropdown/index.ts"),y=r("./src/components/icon/index.ts"),v=r("./src/components/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var k=function(e){l()(r,e);var t=_(r);function r(){return a()(this,r),t.apply(this,arguments)}return s()(r,[{key:"render",value:function(e){var t=e.label&&e.label.toLowerCase();return(0,m.h)("div",{className:[f().smartContainerItem,f().selectMenuItem].join(" ")},(0,m.h)("label",{id:t,htmlFor:t},e.icon?(0,m.h)("div",{className:f().labelIcon},(0,m.h)(y.default,{type:e.icon})):void 0,e.label),e.options&&e.options.length?(0,m.h)(g.DropDown,{pushRef:function(t){e.pushRef(t)},name:t,onMenuChosen:function(t){return e.onMenuChosen(t)},options:e.options,additionalOptions:e.additionalOptions}):(0,m.h)("div",{style:{paddingLeft:"20px"}},(0,m.h)(v.ToggleSwitch,{pushRef:function(t){e.pushRef(t)},name:t,isChecked:e.isChecked,onMenuChosen:function(t){return e.onMenuChosen(t)}})))}}]),r}(m.Component);k.displayName="SmartContainerItem"},"./src/components/smart-container/smart-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SmartContainer:function(){return R}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./src/styles/style.scss"),_=r.n(v),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./node_modules/react-redux/es/index.js"),b=r("./src/utils/index.ts"),T=r("./src/reducers/shell.ts"),A=r("./node_modules/preact/compat/dist/compat.module.js"),S=r("./src/components/overlay/index.ts"),P=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./src/components/player/index.ts"),x=r("./src/components/overlay-portal/index.ts");function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var R=(n=(0,E.connect)((function(e){return{isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize}}),(0,b.bindActions)(T.actions)),a=(0,P.withText)({settingsText:"settings.title"}),n(i=(0,b.withKeyboardA11y)(i=(0,C.withPlayer)(i=a(i=function(e){h()(r,e);var t=w(r);function r(){return u()(this,r),t.apply(this,arguments)}return d()(r,[{key:"componentWillMount",value:function(){this.props.addPlayerClass(_().smartContainerOpen),this.props.updateSmartContainerOpen(!0)}},{key:"componentWillUnmount",value:function(){this.props.removePlayerClass(_().smartContainerOpen),this.props.updateSmartContainerOpen(!1)}},{key:"componentDidMount",value:function(){this.props.setIsModal(this.isPortal)}},{key:"render",value:function(e){return e.clearAccessibleChildren(),this.isPortal?(0,A.createPortal)((0,k.h)(S.Overlay,{open:!0,onClose:e.onClose,handleKeyDown:this.props.handleKeyDown,addAccessibleChild:this.props.addAccessibleChild,ariaLabel:e.settingsText},(0,k.h)("div",{className:_().title},e.title),this.renderChildren(e)),(0,x.getOverlayPortalElement)(e.player)):(0,k.h)("div",{onKeyDown:e.handleKeyDown,tabIndex:-1,role:"menu",className:[_().smartContainer,_().top,_().left].join(" ")},this.renderChildren(e))}},{key:"renderChildren",value:function(e){var t=this,r=(0,k.toChildArray)(e.children).map((function(r){if(r)return(0,k.cloneElement)(r,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({pushRef:function(t){e.addAccessibleChild(t)}},t.props))}));return r}},{key:"isPortal",get:function(){return this.props.isMobile||this.props.isSmallSize}}]),r}(k.Component))||i)||i)||i)||i);R.displayName="SmartContainer"},"./src/components/speed-menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SpeedMenu:function(){return n.SpeedMenu}});var n=r("./src/components/speed-menu/speed-menu.tsx")},"./src/components/speed-menu/speed-menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SpeedMenu:function(){return O}});var n,a,i,s,o,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/index.ts"),P=r("./src/reducers/settings.ts"),C=r("./src/components/index.ts"),x=r("./src/components/icon/index.ts"),I=r("./src/components/player/index.ts"),w=r("./src/components/logger/index.ts"),R=r("./src/components/event-dispatcher/index.ts");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}var D="SpeedMenu",O=(n=(0,A.connect)(null,(0,S.bindActions)(P.actions)),a=(0,w.withLogger)(D),i=(0,R.withEventDispatcher)(D),s=(0,T.withText)({speedLabelText:"settings.speed",speedNormalLabelText:"settings.speedNormal"}),n(o=(0,I.withPlayer)(o=a(o=i(o=s(o=function(e){m()(r,e);var t=M(r);function r(){var e;u()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),E()(h()(e),"onSpeedChange",(function(t){e.props.updateSpeed(t),e.props.player.playbackRate=t,e.props.notifyClick({type:"speed",speed:t})})),e}return d()(r,[{key:"render",value:function(e){var t=e.optionsRenderer?e.optionsRenderer(e.player.playbackRates):e.player.playbackRates.reduce((function(t,r){var n={value:r,label:1===r?e.speedNormalLabelText:r,active:!1};return r===e.player.playbackRate&&(n.active=!0),t.push(n),t}),[]);return(0,b.h)(C.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:x.IconType.Speed,label:e.speedLabelText,options:t,onMenuChosen:this.onSpeedChange})}}]),r}(b.Component))||o)||o)||o)||o)||o);O.displayName=D},"./src/components/spinner/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Spinner:function(){return n.Spinner}});var n=r("./src/components/spinner/spinner.tsx")},"./src/components/spinner/spinner.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Spinner:function(){return A}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./src/styles/style.scss"),_=r.n(v),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var T={loading:(0,k.h)(E.Text,{id:"spinner.loading"},"Loading")},A=(0,E.withText)(T)(n=function(e){d()(r,e);var t=b(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"loadingSpan",(0,k.createRef)()),e}return o()(r,[{key:"componentDidMount",value:function(){var e=this;this.loadingSpan.current&&"hidden"!==getComputedStyle(this.loadingSpan.current).visibility&&setTimeout((function(){e.loadingSpan.current&&(e.loadingSpan.current.innerText=e.props.loading)}),1e3)}},{key:"render",value:function(){return(0,k.h)("div",null,(0,k.h)("div",{className:_().spinner},Array(8).fill(0).map((function(e,t){return(0,k.h)("span",{key:t+1})}))),(0,k.h)("span",{className:_().srOnly,"aria-live":"assertive",ref:this.loadingSpan}))}}]),r}(k.Component))||n;A.displayName="Spinner"},"./src/components/time-display-ads-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplayAdsContainer:function(){return n.TimeDisplayAdsContainer}});var n=r("./src/components/time-display-ads-container/time-display-ads-container.tsx")},"./src/components/time-display-ads-container/time-display-ads-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplayAdsContainer:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/extends.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/components/time-display/index.ts"),_=r("./src/components/logger/index.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var E="TimeDisplayAdsContainer",b=(0,y.connect)((function(e){return{adProgress:e.engine.adProgress}}))(n=(0,_.withLogger)(E)(n=function(e){d()(r,e);var t=k(r);function r(){return o()(this,r),t.apply(this,arguments)}return u()(r,[{key:"render",value:function(e){return(0,g.h)(v.TimeDisplay,i()({currentTime:Math.round(e.adProgress.currentTime),duration:Math.round(e.adProgress.duration)},e))}}]),r}(g.Component))||n)||n;b.displayName=E},"./src/components/time-display-playback-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplayPlaybackContainer:function(){return n.TimeDisplayPlaybackContainer}});var n=r("./src/components/time-display-playback-container/time-display-playback-container.tsx")},"./src/components/time-display-playback-container/time-display-playback-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplayPlaybackContainer:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/extends.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/components/time-display/index.ts"),_=r("./src/components/logger/index.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var E="TimeDisplayPlaybackContainer",b=(0,y.connect)((function(e){return{currentTime:e.engine.currentTime,duration:e.engine.duration}}))(n=(0,_.withLogger)(E)(n=function(e){d()(r,e);var t=k(r);function r(){return o()(this,r),t.apply(this,arguments)}return u()(r,[{key:"render",value:function(e){return(0,g.h)(v.TimeDisplay,i()({currentTime:e.currentTime,duration:e.duration},e))}}]),r}(g.Component))||n)||n;b.displayName=E},"./src/components/time-display/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplay:function(){return n.TimeDisplay}});var n=r("./src/components/time-display/time-display.tsx")},"./src/components/time-display/time-display.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplay:function(){return v}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./src/styles/style.scss"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js"),g=r("./src/utils/index.ts");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var v=function(e){l()(r,e);var t=y(r);function r(){return a()(this,r),t.apply(this,arguments)}return s()(r,[{key:"getTimeDisplay",value:function(e,t,r){var n=r||"current / total",a=(0,g.toHHMMSS)(e),i=(0,g.toHHMMSS)(t),s=(0,g.toHHMMSS)(t-e);return n=(n=(n=n.replace(/current/g,a)).replace(/total/g,i)).replace(/left/g,s)}},{key:"render",value:function(e){var t=e.currentTime,r=e.duration,n=e.format,a=void 0===n?"current / total":n;return(0,m.h)("div",{className:f().timeDisplay},(0,m.h)("span",null,this.getTimeDisplay(t,r,a)))}}]),r}(m.Component);v.displayName="TimeDisplay"},"./src/components/toggle-switch/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ToggleSwitch:function(){return n.ToggleSwitch}});var n=r("./src/components/toggle-switch/toggle-switch.tsx")},"./src/components/toggle-switch/toggle-switch.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ToggleSwitch:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./src/utils/index.ts"),_=r("./src/styles/style.scss"),k=r.n(_);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var b=function(e){c()(r,e);var t=E(r);function r(){var e;a()(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e=t.call.apply(t,[this].concat(i)),g()(l()(e),"onChange",(function(t){e.props.onMenuChosen(t)})),g()(l()(e),"handleOnKeyDown",(function(t){t.keyCode!==v.KeyMap.ENTER&&t.keyCode!==v.KeyMap.SPACE||(t.preventDefault(),e.onChange(!e.props.isChecked))})),e}return s()(r,[{key:"render",value:function(e){var t=this;return(0,y.h)("label",{onKeyDown:function(e){return t.handleOnKeyDown(e)},className:k().switch,ref:function(t){e.pushRef&&e.pushRef(t)},"aria-label":e.name,role:"switch","aria-checked":e.isChecked,tabIndex:-1},(0,y.h)("input",{name:e.name,className:k().toggleInput,type:"checkbox",checked:e.isChecked,onChange:function(e){return t.onChange(e.target.checked)}}),(0,y.h)("span",{className:k().slider}))}}]),r}(y.Component);b.displayName="ToggleSwitch"},"./src/components/tooltip/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ToolTipType:function(){return n.ToolTipType},Tooltip:function(){return n.Tooltip}});var n=r("./src/components/tooltip/tooltip.tsx")},"./src/components/tooltip/tooltip.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ToolTipType:function(){return x},Tooltip:function(){return I}});var n,a,i=r("./node_modules/@babel/runtime/helpers/typeof.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/event/index.ts"),P=r("./src/utils/key-map.ts");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var x={Top:"top",Bottom:"bottom",TopRight:"top-right",TopLeft:"top-left",BottomRight:"bottom-right",BottomLeft:"bottom-left",Left:"left",Right:"right"},I=(0,A.connect)((function(e){return{playerClientRect:e.shell.playerClientRect,guiClientRect:e.shell.guiClientRect,isMobile:e.shell.isMobile}}))(n=(0,S.withEventManager)((a=function(e){f()(r,e);var t=C(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_hoverTimeout",null),k()(p()(e),"textElement",void 0),k()(p()(e),"tooltipElement",void 0),k()(p()(e),"lastAlternativeTypeIndex",-1),k()(p()(e),"_buttonRef",null),k()(p()(e),"showTooltip",(function(){e.setState({showTooltip:!0})})),k()(p()(e),"hideTooltip",(function(){e.setState({showTooltip:!1})})),k()(p()(e),"handleKeyDown",(function(t){t.keyCode===P.KeyMap.ESC&&e.hideTooltip()})),k()(p()(e),"setButtonRef",(function(t){e._buttonRef=t})),k()(p()(e),"handleFocusOnChildren",(function(){var t=e.props.children.props.onFocus;e.showTooltip(),t&&t()})),k()(p()(e),"handleBlurOnChildren",(function(){var t=e.props.children.props.onBlur;e.hideTooltip(),t&&t()})),k()(p()(e),"onMouseOver",(function(){e._clearHoverTimeout(),e._hoverTimeout=setTimeout((function(){e.showTooltip()}),750)})),k()(p()(e),"onMouseLeave",(function(){e.hideTooltip(),e._clearHoverTimeout()})),k()(p()(e),"handleRef",(function(t){e.setButtonRef(t);var r=e.props.children.ref;"function"==typeof r?r(t):r&&"object"===s()(r)&&(r.current=t)})),e}return c()(r,[{key:"_clearHoverTimeout",value:function(){this._hoverTimeout&&(clearTimeout(this._hoverTimeout),this._hoverTimeout=null)}},{key:"getAlternateType",value:function(){var e=this;return Object.values(x).find((function(t,r){return r>e.lastAlternativeTypeIndex&&t!=e.props.type&&(e.lastAlternativeTypeIndex=r,!0)}))}},{key:"isToolTipInBoundaries",value:function(){if(this.props.strictPosition)return!0;var e=this.textElement.getBoundingClientRect(),t=this.props.playerClientRect;return e.top>t.top+5&&e.bottom<t.bottom-5&&e.right<t.right-5&&e.left>t.left+5}},{key:"componentWillMount",value:function(){this.setState({valid:!1,type:this.props.type})}},{key:"componentDidMount",value:function(){var e,t=this,r=this.props.eventManager;r.listen(document,"click",(function(e){return t.handleClickOutside(e)})),(null===(e=this._buttonRef)||void 0===e?void 0:e.addEventListener)&&r.listen(this._buttonRef,"keydown",this.handleKeyDown)}},{key:"handleClickOutside",value:function(e){var t;!(null===(t=this.tooltipElement)||void 0===t?void 0:t.contains(e.target))&&this.state.showTooltip&&this.hideTooltip()}},{key:"componentDidUpdate",value:function(e){if(this.props.guiClientRect!==e.guiClientRect)this.lastAlternativeTypeIndex=-1,this.setState({valid:!1,type:this.props.type});else if(this.state.showTooltip)if(this.isToolTipInBoundaries())this.state.valid||this.setState({valid:!0});else{var t=this.getAlternateType();t&&this.setState({valid:!1,type:t})}}},{key:"componentWillUnmount",value:function(){this._clearHoverTimeout()}},{key:"render",value:function(e){var t=this,r=[b().tooltipLabel,b()["tooltip-".concat(this.state.type)]];if(e.className&&r.push(e.className),this.state.showTooltip&&this.state.valid?r.push(b().show):r.push(b().hide),e.isMobile)return(0,T.toChildArray)(e.children)[0];var n=(0,T.cloneElement)(e.children,{onFocus:this.handleFocusOnChildren,onBlur:this.handleBlurOnChildren,ref:this.handleRef});return(0,T.h)("div",{className:b().tooltip,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,ref:function(e){return e?t.tooltipElement=e:void 0}},n,(0,T.h)("span",{"aria-hidden":"true",style:{maxWidth:e.maxWidth},ref:function(e){return e?t.textElement=e:void 0},className:r.join(" ")},e.label))}}]),r}(T.Component),k()(a,"defaultProps",{type:x.Top,maxWidth:"240px",strictPosition:!1}),n=a))||n)||n},"./src/components/top-bar/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TopBar:function(){return n.TopBar}});var n=r("./src/components/top-bar/top-bar.tsx")},"./src/components/top-bar/top-bar.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{TopBar:function(){return I}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./node_modules/react-redux/es/index.js"),T=r("./src/components/player-area/index.ts"),A=r("./src/utils/index.ts"),S=r("./src/reducers/shell.ts"),P=r("./src/components/player/index.ts"),C=r("./src/event/index.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var I=(n=(0,b.connect)((function(e){return{isCasting:e.engine.isCasting,isPlaybackEnded:e.engine.isPlaybackEnded,isPlaying:e.engine.isPlaying}}),(0,A.bindActions)(S.actions)),(0,P.withPlayer)(a=(0,C.withEventManager)(a=n(a=function(e){p()(r,e);var t=x(r);function r(){var e;s()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),v()(c()(e),"topBarRef",(0,E.createRef)()),e}return l()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.player;t.eventManager.listenOnce(r,r.Event.PLAYING,(function(){var t;e.props.updateTopBarClientRect(null===(t=e.topBarRef.current)||void 0===t?void 0:t.getBoundingClientRect())}))}},{key:"render",value:function(e){var t=e.disabled,r=e.isPlaybackEnded,n=e.isCasting,a=e.leftControls,i=e.rightControls,s=[k().topBar];return t&&s.push(k().disabled),n&&r&&s.push(k().hide),(0,E.h)("div",{className:s.join(" "),ref:this.topBarRef},(0,E.h)("div",{className:k().topBarArea},(0,E.h)(T.PlayerArea,{name:"TopBar"})),e.children,(0,E.h)("div",{className:k().leftControls},(0,E.h)(T.PlayerArea,{name:"TopBarLeftControls"},a)),(0,E.h)("div",{className:k().rightControls},(0,E.h)(T.PlayerArea,{name:"TopBarRightControls"},i)))}}]),r}(E.Component))||a)||a)||a);I.displayName="TopBar"},"./src/components/unmute-indication/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{UnmuteIndication:function(){return n.UnmuteIndication}});var n=r("./src/components/unmute-indication/unmute-indication.tsx")},"./src/components/unmute-indication/unmute-indication.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{MUTED_AUTOPLAY_ICON_ONLY_DEFAULT_TIMEOUT:function(){return D},UnmuteIndication:function(){return N}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/components/icon/index.ts"),P=r("./src/utils/index.ts"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),x=r("./src/components/player/index.ts"),I=r("./src/event/index.ts"),w=r("./src/components/logger/index.ts"),R=r("./src/components/button/index.ts");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var D=3e3,O="UnmuteIndication",L={unmuteAriaLabel:(0,T.h)(C.Text,{id:"controls.unmute"},"Unmute"),unmuteButtonText:(0,T.h)(C.Text,{id:"unmute.unmute"},"Unmute")},N=(n=(0,A.connect)((function(e){return{fallbackToMutedAutoPlay:e.engine.fallbackToMutedAutoPlay}}),null),a=(0,w.withLogger)(O),i=(0,C.withText)(L),n(s=(0,x.withPlayer)(s=(0,I.withEventManager)(s=a(s=i(s=function(e){f()(r,e);var t=M(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_iconTimeout",null),k()(p()(e),"onKeyDown",(function(t){t.keyCode===P.KeyMap.ENTER&&(e.props.player.muted=!e.props.player.muted)})),k()(p()(e),"onMouseOver",(function(){return e.setState({iconOnly:!1})})),k()(p()(e),"onMouseOut",(function(){return e.setState({iconOnly:!0})})),k()(p()(e),"onMouseUp",(function(){return e.props.player.muted=!e.props.player.muted})),k()(p()(e),"onTouchEnd",(function(e){return e.stopImmediatePropagation()})),e}return c()(r,[{key:"componentDidUpdate",value:function(e){var t=this;!e.fallbackToMutedAutoPlay&&this.props.fallbackToMutedAutoPlay&&(this.props.eventManager.listenOnce(this.props.player,this.props.player.Event.PLAYING,(function(){return t._iconOnlyTimeout()})),this.props.eventManager.listenOnce(this.props.player,this.props.player.Event.AD_STARTED,(function(){return t._iconOnlyTimeout()})))}},{key:"componentWillUnmount",value:function(){this._iconTimeout&&(clearTimeout(this._iconTimeout),this._iconTimeout=null)}},{key:"_iconOnlyTimeout",value:function(){var e=this;this._iconTimeout=setTimeout((function(){e.setState({iconOnly:!0})}),D)}},{key:"render",value:function(e){if(this.props.fallbackToMutedAutoPlay){var t=[b().unmuteButtonContainer];return e.hasTopBar&&t.push(b().hasTopBar),this.state.iconOnly&&t.push(b().showIconOnly),(0,T.h)(C.Localizer,null,(0,T.h)("div",{className:t.join(" ")},(0,T.h)(R.Button,{className:[b().btn,b().btnDarkTransparent,b().unmuteButton,b().btnTranslucent].join(" "),tabIndex:0,"aria-label":e.unmuteAriaLabel,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd,onKeyDown:this.onKeyDown},(0,T.h)("div",{className:b().unmuteIconContainer},(0,T.h)(S.default,{type:S.IconType.VolumeBase}),(0,T.h)(S.default,{type:S.IconType.VolumeMute})),(0,T.h)("span",null,e.unmuteButtonText))))}}}]),r}(T.Component))||s)||s)||s)||s)||s);N.displayName=O},"./src/components/video-area/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoArea:function(){return n.VideoArea}});var n=r("./src/components/video-area/video-area.tsx")},"./src/components/video-area/video-area.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoArea:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./node_modules/react-redux/es/index.js"),g=r("./src/components/player-area/index.ts"),y=r("./src/styles/style.scss"),v=r.n(y);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,m.connect)((function(e){return{videoStyles:e.shell.layoutStyles.video}}))(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"shouldComponentUpdate",value:function(e){return e.videoStyles!==this.props.videoStyles}},{key:"render",value:function(){var e=this.props,t=e.videoStyles,r=e.children;return(0,f.h)("div",{style:t,className:v().videoArea},(0,f.h)("div",{style:{pointerEvents:"auto"}},(0,f.h)(g.PlayerArea,{name:"VideoArea"},r)))}}]),r}(f.Component))||n},"./src/components/video-player/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoPlayer:function(){return n.VideoPlayer}});var n=r("./src/components/video-player/video-player.tsx")},"./src/components/video-player/video-player.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoPlayer:function(){return w}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./src/utils/resize-watcher.ts"),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./node_modules/react-redux/es/index.js"),b=r("./src/reducers/shell.ts"),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./src/utils/index.ts"),P=r("./src/components/player/index.ts"),C=r("./src/event/index.ts"),x=r("./src/components/player-area/index.ts");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var w=(n=(0,E.connect)((function(e){return{videoStyles:e.shell.layoutStyles.video,targetId:e.config.targetId}}),(0,S.bindActions)(b.actions)),(0,P.withPlayer)(a=(0,C.withEventManager)(a=n(a=function(e){p()(r,e);var t=I(r);function r(){var e;s()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),v()(c()(e),"_el",void 0),v()(c()(e),"_videoResizeWatcher",void 0),v()(c()(e),"_onVideoResize",(function(){var t=e.props.player.getVideoElement();t&&e.props.updateVideoClientRect(t.getBoundingClientRect())})),v()(c()(e),"_setRef",(function(t){e._videoResizeWatcher&&(e.props.eventManager.unlisten(e._videoResizeWatcher,C.EventType.RESIZE,e._onVideoResize),e._videoResizeWatcher.destroy()),t&&(e._el=t),e._el?e._el.appendChild(e.props.player.getView()):e.props.updateVideoClientRect({x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0})})),e}return l()(r,[{key:"shouldComponentUpdate",value:function(e){return e.videoStyles!==this.props.videoStyles}},{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.eventManager,n=t.player;r.listen(n,n.Event.SOURCE_SELECTED,(function(){return e._onVideoResize()}));var a=new _.ResizeWatcher;a.init(this._el),this._videoResizeWatcher=a,this.props.eventManager.listen(this._videoResizeWatcher,C.EventType.RESIZE,this._onVideoResize)}},{key:"componentWillUnmount",value:function(){this._videoResizeWatcher.destroy()}},{key:"render",value:function(){var e=this.props,t=e.videoStyles,r=e.targetId;return(0,k.h)("div",{role:"region",id:"".concat(r,"-video"),className:A().videoPlayer,style:t,ref:this._setRef},(0,k.h)(x.PlayerArea,{name:"VideoContainer"}))}}]),r}(k.Component))||a)||a)||a)},"./src/components/volume/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Volume:function(){return n.Volume}});var n=r("./src/components/volume/volume.tsx")},"./src/components/volume/volume.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Volume:function(){return W}});var n,a,i,s,o,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),P=r("./node_modules/react-redux/es/index.js"),C=r("./src/utils/index.ts"),x=r("./src/reducers/volume.ts"),I=r("./src/reducers/engine.ts"),w=r("./src/components/icon/index.ts"),R=r("./src/components/player/index.ts"),M=r("./src/event/index.ts"),D=r("./src/components/logger/index.ts"),O=r("./src/components/event-dispatcher/index.ts"),L=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),N=r("./src/components/keyboard/index.ts"),U=r("./src/reducers/overlay-action.ts"),j=r("./src/components/tooltip/index.ts"),B=r("./src/components/button/index.ts"),F=r("./src/components/button-control/index.ts");function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var K="Volume",W=(n=(0,P.connect)((function(e){return{isDraggingActive:e.volume.draggingActive,volume:e.engine.volume,muted:e.engine.muted,isMobile:e.shell.isMobile}}),(0,C.bindActions)(H(H(H({},x.actions),I.actions),U.actions))),a=(0,N.withKeyboardEvent)(K),i=(0,D.withLogger)(K),s=(0,O.withEventDispatcher)(K),o=(0,L.withText)((function(e){return{volumeLabel:e.muted?(0,S.h)(L.Text,{id:"controls.unmute"},"Unmute"):(0,S.h)(L.Text,{id:"controls.mute"},"Mute"),volumeButtonAriaLabel:(0,S.h)(L.Text,{id:"volume.volume_button_aria_label"},"Volume"),volumeButtonAriaDescription:(0,S.h)(L.Text,{id:"volume.volume_button_description"},"Click to volume control"),sliderAriaLabel:(0,S.h)(L.Text,{id:"volume.volume_slider_aria_label"},"Volume control"),sliderDescription:(0,S.h)(L.Text,{id:"volume.volume_slider_description"},"Use the arrows to control the volume")}})),n(l=(0,R.withPlayer)(l=(0,M.withEventManager)(l=a(l=i(l=s(l=o(l=function(e){g()(r,e);var t=V(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"_volumeControlElement",void 0),b()(f()(e),"_volumeSliderElement",void 0),b()(f()(e),"_volumeProgressBarElement",void 0),b()(f()(e),"_keyboardEventHandlers",[{key:{code:C.KeyMap.UP},action:function(t){e.handleKeydown(t)}},{key:{code:C.KeyMap.DOWN},action:function(t){e.handleKeydown(t)}},{key:{code:C.KeyMap.M},action:function(t){e.handleKeydown(t)}}]),b()(f()(e),"onVolumeProgressBarMouseDown",(function(){e.props.updateVolumeDraggingStatus(!0)})),b()(f()(e),"onVolumeProgressBarMouseMove",(function(t){e.props.isDraggingActive&&e.changeVolume(t)})),b()(f()(e),"onMouseOver",(function(){e.props.isMobile||(e.props.updateVolumeHover(!0),e.setState({hover:!0}))})),b()(f()(e),"onMouseOut",(function(){e.props.isMobile||(e.props.updateVolumeHover(!1),e.setState({hover:!1}))})),b()(f()(e),"onKeyDown",(function(t){switch(t.keyCode){case C.KeyMap.UP:case C.KeyMap.DOWN:case C.KeyMap.ENTER:case C.KeyMap.SPACE:t.preventDefault(),t.stopPropagation(),e.handleKeydown(t);break;case C.KeyMap.TAB:break;default:e.setState({hover:!1})}})),b()(f()(e),"onFocus",(function(){e.props.isMobile||e.state.hover||e.setState({hover:!0})})),b()(f()(e),"onTouchEnd",(function(e){e.stopImmediatePropagation()})),b()(f()(e),"onVolumeProgressBarMouseUp",(function(t){e.props.isDraggingActive&&(e.props.updateVolumeDraggingStatus(!1),e.changeVolume(t))})),b()(f()(e),"toggleMute",(function(){var t=e.props.player;0===t.volume?(e.props.logger.debug("Toggle mute. Volume is 0, set mute to false & volume to 0.5"),t.muted=!1,t.volume=.5):(e.props.logger.debug("Toggle mute. ".concat(t.muted," => ").concat(!t.muted)),t.muted=!t.muted),e.props.notifyClick()})),b()(f()(e),"onProgressBarKeyDown",(function(t){t.keyCode===C.KeyMap.TAB?e.setState({hover:!1}):(t.preventDefault(),t.stopPropagation(),e.handleKeydown(t,!0))})),b()(f()(e),"handleClickOnVolumeButton",(function(t){var r,n,a;null===(r=t.stopPropagation)||void 0===r||r.call(t),null===(n=t.preventDefault)||void 0===n||n.call(t),null===(a=e._volumeSliderElement)||void 0===a||a.focus()})),e}return p()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props.player;this.props.eventManager.listen(t,t.Event.LOADED_METADATA,(function(){e.props.updateVolume(t.volume),e.props.updateMuted(t.muted)})),this.props.eventManager.listen(t,t.Event.VOLUME_CHANGE,(function(){e.props.updateMuted(t.muted),e.props.updateVolume(t.volume)})),this.props.eventManager.listen(document,"mouseup",this.onVolumeProgressBarMouseUp),this.props.eventManager.listen(document,"mousemove",this.onVolumeProgressBarMouseMove),this.props.eventManager.listen(document,"click",(function(t){return e.handleClickOutside(t)})),this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"_shouldRender",value:function(){var e=!(this.props.player.isImage()||this.props.player.isDocument());return this.props.onToggle(K,e),e}},{key:"handleClickOutside",value:function(e){!this.props.isMobile&&this._volumeControlElement&&!this._volumeControlElement.contains(e.target)&&this.state.hover&&this.setState({hover:!1})}},{key:"getVolumeProgressHeight",value:function(){return this.props.muted?"0%":Math.round(100*this.props.volume)+"%"}},{key:"handleKeydown",value:function(e){var t,r=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.props.player,i=function(e){e===a.volume||e>100||e<0||(a.muted=e<5,a.volume=e/100,r.props.notifyChange({volume:a.volume}))};switch(e.keyCode){case C.KeyMap.UP:this.props.updateOverlayActionIcon([w.IconType.VolumeBase,w.IconType.VolumeWaves]),i(t=Math.min(Math.round(100*a.volume)+5,100));break;case C.KeyMap.DOWN:0===(t=Math.max(Math.round(100*a.volume)-5,0))?this.props.updateOverlayActionIcon([w.IconType.VolumeBase,w.IconType.VolumeMute]):this.props.updateOverlayActionIcon([w.IconType.VolumeBase,w.IconType.VolumeWave]),i(t);break;case C.KeyMap.M:a.muted?this.props.updateOverlayActionIcon([w.IconType.VolumeBase,w.IconType.VolumeWaves]):this.props.updateOverlayActionIcon([w.IconType.VolumeBase,w.IconType.VolumeMute]),this.toggleMute();break;case C.KeyMap.ENTER:case C.KeyMap.SPACE:n||this.toggleMute()}}},{key:"changeVolume",value:function(e){var t,r=this.props.player,n=this._volumeProgressBarElement.getBoundingClientRect();t=n.height>n.width?this._getVerticalVolume(n,e):this._getHorizontalVolume(n,e),(t=parseFloat(t.toFixed(2)))<=1&&t>=0&&(this.props.logger.debug("Change volume from ".concat(r.volume," => ").concat(t)),r.volume=t,this.props.muted&&(r.muted=!1),this.props.notifyChange({volume:r.volume}))}},{key:"_getHorizontalVolume",value:function(e,t){var r=e.width,n=e.left,a=t.clientX;return 0!=r?(a-n)/r:0}},{key:"_getVerticalVolume",value:function(e,t){var r=e.height,n=e.top,a=t.clientY;return 0!=r?1-(a-n)/r:0}},{key:"render",value:function(){var e=this;if(this._shouldRender){var t=this.props,r=t.player,n=t.isDraggingActive,a=t.muted,i=t.volume,s=t.smartContainerOpen,o=[A().volumeControl];n&&o.push(A().draggingActive),(a||0===i)&&o.push(A().isMuted),this.state.hover&&!s&&o.push(A().hover);var l=Math.round(100*r.volume);return(0,S.h)(F.ButtonControl,{name:K,ref:function(t){return t?e._volumeControlElement=t:void 0},className:o,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},(0,S.h)(j.Tooltip,{label:this.props.volumeLabel,type:this.props.toolTipType?this.props.toolTipType:j.ToolTipType.Left},(0,S.h)(B.Button,{tabIndex:"0","aria-label":"".concat(this.props.volumeLabel),className:A().controlButton,onMouseUp:this.toggleMute,onTouchEnd:this.onTouchEnd,onKeyDown:this.onKeyDown,"aria-describedBy":"volumeButtonDescription"},(0,S.h)(w.Icon,{type:w.IconType.VolumeBase}),(0,S.h)(w.Icon,{type:w.IconType.VolumeWaves}),(0,S.h)(w.Icon,{type:w.IconType.VolumeMute}))),(0,S.h)("span",{className:A().volumeButton,hidden:this.state.hover,role:"button",tabIndex:-1,onClick:this.handleClickOnVolumeButton,"aria-label":this.props.volumeButtonAriaLabel}),(0,S.h)("div",{ref:function(t){return t?e._volumeSliderElement=t:void 0},tabIndex:0,"aria-orientation":"vertical","aria-label":this.props.sliderAriaLabel,"aria-describedBy":"sliderDescription",onKeyDown:this.onProgressBarKeyDown,className:A().volumeControlBar,onFocus:this.onFocus,role:"slider","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":l,"aria-valuetext":"".concat(l,"% volume ").concat(r.muted?"muted":"")},(0,S.h)("div",{className:A().bar,ref:function(t){return t?e._volumeProgressBarElement=t:void 0},onMouseDown:this.onVolumeProgressBarMouseDown},(0,S.h)("div",{className:A().progress,style:{height:this.getVolumeProgressHeight()}}))),(0,S.h)("span",{className:A().srOnly},(0,S.h)("span",{id:"volumeButtonDescription"},this.props.volumeButtonAriaDescription),(0,S.h)("span",{id:"sliderDescription"},this.props.sliderDescription)))}}}]),r}(S.Component))||l)||l)||l)||l)||l)||l)||l);W.displayName=K},"./src/components/vr-stereo/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VrStereo:function(){return n.VrStereo}});var n=r("./src/components/vr-stereo/vr-stereo.tsx")},"./src/components/vr-stereo/vr-stereo.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{VrStereo:function(){return V}});var n,a,i,s,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./src/components/icon/index.ts"),P=r("./src/utils/index.ts"),C=r("./src/reducers/engine.ts"),x=r("./node_modules/react-redux/es/index.js"),I=r("./src/reducers/shell.ts"),w=r("./src/components/player/index.ts"),R=r("./src/components/logger/index.ts"),M=r("./src/components/tooltip/index.ts"),D=r("./src/components/button/index.ts"),O=r("./src/components/button-control/index.ts"),L=r("./src/components/bottom-bar/index.ts"),N=r("./src/index.ts");function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F="VrStereo",V=(n=(0,x.connect)((function(e){return{isVr:e.engine.isVr,vrStereoMode:e.engine.vrStereoMode,config:e.config.components.vrStereo}}),(0,P.bindActions)(B(B({},I.actions),C.actions))),a=(0,R.withLogger)(F),i=(0,A.withText)({vrStereoText:"controls.vrStereo"}),n(s=(0,w.withPlayer)(s=a(s=i(s=function(e){f()(r,e);var t=U(r);function r(e){var n;return l()(this,r),n=t.call(this,e),k()(p()(n),"getComponentText",(function(){return n.props.vrStereoText})),k()(p()(n),"onClick",(function(){n.props.player.toggleVrStereoMode(),n.props.updateVrStereoMode(!n.props.vrStereoMode)})),k()(p()(n),"onKeyDown",(function(e){[P.KeyCode.Enter,P.KeyCode.Space].includes(e.code)&&(e.preventDefault(),n.onClick())})),(0,L.registerToBottomBar)(F,e.player,(function(){return n.registerComponent()})),n}return c()(r,[{key:"registerComponent",value:function(){var e=this;return{ariaLabel:function(){return e.getComponentText()},displayName:F,order:5,svgIcon:function(){return e.getSvgIcon()},onClick:function(){return e.onClick()},component:function(){return G(B(B({},e.props),{},{classNames:[b().upperBarIcon]}))},shouldHandleOnClick:!1}}},{key:"getSvgIcon",value:function(){return{type:N.redux.useStore().getState().engine.vrStereoMode?S.IconType.vrStereoFull:S.IconType.vrStereo}}},{key:"_shouldRender",value:function(){var e=this.props.config,t=this.props.isVr&&!(0===Object.keys(e).length&&e.constructor===Object);return this.props.onToggle(F,t),t}},{key:"componentWillMount",value:function(){this.props.updateVrStereoMode(this.props.config.vrStereoMode)}},{key:"render",value:function(){var e;return this._shouldRender()?(0,T.h)(O.ButtonControl,{name:F,className:this.props.classNames?this.props.classNames.join(" "):""},(0,T.h)(M.Tooltip,{label:this.props.vrStereoText,type:(null===(e=this.props.classNames)||void 0===e?void 0:e.includes(b().upperBarIcon))?"bottom-left":"top",strictPosition:!0},(0,T.h)(D.Button,{tabIndex:"0","aria-label":this.props.vrStereoText,className:this.props.vrStereoMode?[b().controlButton,b().vrStereoMode].join(" "):b().controlButton,onClick:this.onClick,onKeyDown:this.onKeyDown},(0,T.h)(S.default,{type:S.IconType.vrStereo}),(0,T.h)(S.default,{type:S.IconType.vrStereoFull})))):void 0}}]),r}(T.Component))||s)||s)||s)||s),G=function(e){return(0,T.h)(V,e)};V.displayName=F},"./src/components/watermark/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Watermark:function(){return n.Watermark}});var n=r("./src/components/watermark/watermark.tsx")},"./src/components/watermark/watermark.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Watermark:function(){return M}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/react-redux/es/index.js"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./src/components/player/index.ts"),P=r("./src/event/index.ts"),C=r("./src/components/logger/index.ts"),x=r("@playkit-js/playkit-js");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var w="Watermark",R="{entryId}",M=(n=(0,T.connect)((function(e){return{config:Object.assign({placement:"top-left",timeout:0},e.config.components.watermark),targetId:e.config.targetId}})),a=(0,C.withLogger)(w),n(i=(0,S.withPlayer)(i=(0,P.withEventManager)(i=a(i=function(e){h()(r,e);var t=I(r);function r(e){var n;return o()(this,r),n=t.call(this),_()(d()(n),"_timeoutId",null),_()(d()(n),"_imgAspectRatio",null),_()(d()(n),"_originalImgWidth",null),_()(d()(n),"_originalImgHeight",null),_()(d()(n),"_playerHeight",null),_()(d()(n),"_playerWidth",null),n.setState({show:!0,urlLink:e.config.url}),n}return u()(r,[{key:"componentWillMount",value:function(){this._loadPlayerDimension(),this._loadImageDimension()}},{key:"componentDidMount",value:function(){var e=this,t=function(){e.props.config.timeout>0&&(e._timeoutId=setTimeout((function(){return e.setState({show:!1})}),e.props.config.timeout))},r=this.props.player;this.props.eventManager.listenOnce(r,r.Event.PLAYING,t),this.props.eventManager.listen(r,r.Event.CHANGE_SOURCE_ENDED,(function(){e.setState({show:!0}),e.props.eventManager.listenOnce(r,r.Event.PLAYING,t)})),this.props.eventManager.listen(r,x.EventType.RESIZE,(function(){e.onPlayerResize()})),this._handleWatermarkUrl()}},{key:"_handleWatermarkUrl",value:function(){var e=this,t=this.props.config.url;if(t&&-1!==t.indexOf(R)){var r=this.props,n=r.player,a=r.eventManager;this._setWatermarkUrlWithEntryId(t)||a.listen(n,n.Event.MEDIA_LOADED,(function(){e._setWatermarkUrlWithEntryId(t)}))}}},{key:"_loadImageDimension",value:function(){var e=this;if(this.props.config.img){var t=new Image;t.src=this.props.config.img,t.onload=function(){e._originalImgWidth=t.naturalWidth,e._originalImgHeight=t.naturalHeight,e._imgAspectRatio=t.naturalWidth/t.naturalHeight,e.setState({imgWidth:t.naturalWidth,imgHeight:t.naturalHeight})}}}},{key:"_loadPlayerDimension",value:function(){var e=document.getElementById(this.props.targetId);if(e){var t=e.getBoundingClientRect(),r=t.width,n=t.height;this._playerWidth=r,this._playerHeight=n}}},{key:"onPlayerResize",value:function(){var e=document.getElementById(this.props.targetId);if(e&&this._imgAspectRatio&&this._originalImgWidth&&this._originalImgHeight){var t=e.getBoundingClientRect().width,r=t/(this._playerWidth||t),n=this._originalImgWidth*r,a=n/this._imgAspectRatio;this.setState({imgWidth:n,imgHeight:a})}}},{key:"_setWatermarkUrlWithEntryId",value:function(e){var t=this.props.player.sources.id;return"string"==typeof t?(this.setState({urlLink:e.replace(R,t),show:!0}),!0):(this.props.logger.debug("Watermark url was not replaced; entry id was not found."),this.setState({show:!1}),!1)}},{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}},{key:"render",value:function(e){if(e.config.img){var t=[E().watermark];return e.config.placement.split("-").forEach((function(e){t.push(E()[e])})),e.config.url||t.push(E().emptyUrl),this.state.show||t.push(E().hideWatermark),(0,b.h)("div",{className:t.join(" ")},(0,b.h)("a",{href:this.state.urlLink,target:"_blank",rel:"noopener noreferrer"},(0,b.h)(A.Localizer,null,this.state.imgWidth&&this.state.imgHeight&&(0,b.h)("img",{src:e.config.img,alt:(0,b.h)(A.Text,{id:"watermark.watermark_alt_text"}),style:{width:"".concat(this.state.imgWidth,"px"),height:"".concat(this.state.imgHeight,"px")}}))))}}}]),r}(b.Component))||i)||i)||i)||i);M.displayName=w},"./src/event/event-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EventType:function(){return a}});var n="playkit-ui",a={UI_CLICKED:"".concat(n,"-uiclicked"),UI_VISIBILITY_CHANGED:"".concat(n,"-uivisibilitychanged"),GUI_RESIZE:"".concat(n,"-guiresize"),PLAYER_RESIZE:"".concat(n,"-playerresize"),VIDEO_RESIZE:"".concat(n,"-videoresize"),UI_PRESET_CHANGE:"".concat(n,"-uipresetchange"),USER_CLICKED_PLAY:"".concat(n,"-userclickedplay"),USER_CLICKED_PAUSE:"".concat(n,"-userclickedpause"),USER_CLICKED_REWIND:"".concat(n,"-userclickedrewind"),USER_CLICKED_FORWARD:"".concat(n,"-userclickedforward"),USER_CLICKED_LIVE_TAG:"".concat(n,"-userclickedlivetag"),USER_CLICKED_LOGO:"".concat(n,"-userclickedlogo"),USER_CLICKED_MUTE:"".concat(n,"-userclickedmute"),USER_CLICKED_UNMUTE:"".concat(n,"-userclickedunmute"),USER_CLICKED_ADVANCED_AUDIO_DESCRIPTION:"".concat(n,"-userclickedadvancedaudiodescription"),USER_CHANGED_VOLUME:"".concat(n,"-userchangedvolume"),USER_SELECTED_CAPTION_TRACK:"".concat(n,"-userselectedcaptiontrack"),USER_SHOWED_CAPTIONS:"".concat(n,"-usershowedcaptions"),USER_HID_CAPTIONS:"".concat(n,"-userhidcaptions"),USER_SELECTED_AUDIO_TRACK:"".concat(n,"-userselectedaudiotrack"),USER_SELECTED_QUALITY_TRACK:"".concat(n,"-userselectedqualitytrack"),USER_ENTERED_FULL_SCREEN:"".concat(n,"-userenteredfullscreen"),USER_EXITED_FULL_SCREEN:"".concat(n,"-userexitedfullscreen"),USER_ENTERED_PICTURE_IN_PICTURE:"".concat(n,"-userenteredpictureinpicture"),USER_EXITED_PICTURE_IN_PICTURE:"".concat(n,"-userexitedpictureinpicture"),USER_SELECTED_CAPTIONS_STYLE:"".concat(n,"-userselectedcaptionsstyle"),USER_SELECTED_SPEED:"".concat(n,"-userselectedspeed"),USER_SEEKED:"".concat(n,"-userseeked"),RESIZE:"".concat(n,"-resize"),USER_SELECTED_CAPTIONS_SIZE:"".concat(n,"-userselectedcaptionssize"),USER_SELECTED_CAPTIONS_ALIGNMENT:"".concat(n,"-userselectedcaptionsalignment"),USER_SELECTED_CAPTIONS_FONT_COLOR:"".concat(n,"-userselectedcaptionsfontcolor"),USER_SELECTED_CAPTIONS_FONT_FAMILY:"".concat(n,"-userselectedcaptionsfontfamily"),USER_SELECTED_CAPTIONS_FONT_STYLE:"".concat(n,"-userselectedcaptionsfontstyle"),USER_SELECTED_CAPTIONS_FONT_OPACITY:"".concat(n,"-userselectedcaptionsfontopacity"),USER_SELECTED_CAPTIONS_BACKGROUND_COLOR:"".concat(n,"-userselectedcaptionsbackgroundcolor"),USER_SELECTED_CAPTIONS_BACKGROUND_OPACITY:"".concat(n,"-userselectedcaptionsbackgroundopacity"),BOTTOM_BAR_CLIENT_RECT_CHANGED:"".concat(n,"-bottombarclientrectchanged"),PLAYER_HOVERED:"".concat(n,"-playerhovered"),USER_COPIED_DEBUG_INFO:"".concat(n,"-usercopieddebuginfo")}},"./src/event/events/audio-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioSelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_AUDIO_TRACK)).payload={audioTrack:e},n}return r}(d.FakeEvent)},"./src/event/events/bottom-bar-client-rect-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BottomBarClientRectEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(){return a()(this,r),t.call(this,p.EventType.BOTTOM_BAR_CLIENT_RECT_CHANGED)}return r}(d.FakeEvent)},"./src/event/events/caption-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionSelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_CAPTION_TRACK)).payload={captionTrack:e},n}return r}(d.FakeEvent)},"./src/event/events/captions-style-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsStyleSelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_CAPTIONS_STYLE)).payload={captionsStyle:e},n}return r}(d.FakeEvent)},"./src/event/events/forward-clicked.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ForwardClickedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e,n){var i;return a()(this,r),(i=t.call(this,p.EventType.USER_CLICKED_FORWARD)).payload={from:e,to:n},i}return r}(d.FakeEvent)},"./src/event/events/gui-resize-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{GuiResizeEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.GUI_RESIZE)).payload={guiSize:e},n}return r}(d.FakeEvent)},"./src/event/events/player-resize-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerResizeEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.PLAYER_RESIZE)).payload={playerSize:e},n}return r}(d.FakeEvent)},"./src/event/events/quality-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{QualitySelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_QUALITY_TRACK)).payload={qualityTrack:e},n}return r}(d.FakeEvent)},"./src/event/events/rewind-clicked.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{RewindClickedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e,n){var i;return a()(this,r),(i=t.call(this,p.EventType.USER_CLICKED_REWIND)).payload={from:e,to:n},i}return r}(d.FakeEvent)},"./src/event/events/seeked-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e,n){var i;return a()(this,r),(i=t.call(this,p.EventType.USER_SEEKED)).payload={from:e,to:n},i}return r}(d.FakeEvent)},"./src/event/events/speed-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SpeedSelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_SPEED)).payload={speed:e},n}return r}(d.FakeEvent)},"./src/event/events/ui-visibility-changed-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{UIVisibilityChangedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.UI_VISIBILITY_CHANGED)).payload={visible:e},n}return r}(d.FakeEvent)},"./src/event/events/video-resize-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoResizeEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.VIDEO_RESIZE)).payload={videoSize:e},n}return r}(d.FakeEvent)},"./src/event/events/volume-changed.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VolumeChangedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){s()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_CHANGED_VOLUME)).payload={volume:e},n}return r}(d.FakeEvent)},"./src/event/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EventType:function(){return a.EventType},withEventManager:function(){return n.withEventManager}});var n=r("./src/event/with-event-manager.tsx"),a=r("./src/event/event-type.ts")},"./src/event/with-event-manager.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withEventManager:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("@playkit-js/playkit-js");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){return function(t){p()(n,t);var r=E(n);function n(){var e;s()(this,n);for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return e=r.call.apply(r,[this].concat(a)),v()(c()(e),"eventManager",new k.EventManager),e}return l()(n,[{key:"componentWillUnmount",value:function(){this.eventManager&&(this.eventManager.destroy(),this.eventManager=null)}},{key:"render",value:function(){return(0,_.h)(e,a()({},this.props,{eventManager:this.eventManager}))}}]),n}(_.Component)}},"./src/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Components:function(){return c},Event:function(){return m},EventType:function(){return y.EventType},NAME:function(){return k},Presets:function(){return u},Reducers:function(){return l},ReservedPresetAreas:function(){return f.ReservedPresetAreas},ReservedPresetNames:function(){return f.ReservedPresetNames},SidePanelModes:function(){return f.SidePanelModes},SidePanelPositions:function(){return f.SidePanelPositions},UIEventType:function(){return y.EventType},UIManager:function(){return n.UIManager},Utils:function(){return d},VERSION:function(){return _},components:function(){return c},createPortal:function(){return v.createPortal},getDurationAsText:function(){return d.getDurationAsText},getOverlayPortalElement:function(){return g.getOverlayPortalElement},h:function(){return a.h},preact:function(){return a},preactHooks:function(){return o},preacti18n:function(){return s},presets:function(){return u},reducers:function(){return l},redux:function(){return i},style:function(){return E},utils:function(){return d}});var n=r("./src/ui-manager.tsx"),a=r("./node_modules/preact/dist/preact.module.js"),i=r("./node_modules/react-redux/es/index.js"),s=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),o=r("./node_modules/preact/hooks/dist/hooks.module.js"),l=r("./src/reducers/index.ts"),u=r("./src/ui-presets/index.ts"),c=r("./src/components/index.ts"),d=r("./src/utils/index.ts"),p=r("./src/styles/style.scss"),h=r.n(p),f=r("./src/reducers/shell.ts"),m=r("./src/event/index.ts"),g=r("./src/components/overlay-portal/index.ts"),y=r("./src/event/event-type.ts"),v=r("./node_modules/preact/compat/dist/compat.module.js"),_=(r("./src/types/index.ts"),"0.82.9"),k="@playkit-js/playkit-js-ui",E=h()},"./src/middlewares/debounce-middleware.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{debounceMiddleware:function(){return s}});var n=r("./src/reducers/shell.ts"),a=null,i=null,s=function(){return function(e){return function(e){return function(t){t.type===n.types.UPDATE_IS_SMALL_SIZE?(i=t,a&&clearTimeout(a),a=setTimeout((function(){a=null,e(i)}),150)):e(t)}}}}},"./src/middlewares/event-dispatcher.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{eventDispatcherMiddleware:function(){return S},types:function(){return A}});var n,a=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),i=r.n(a),s=r("@playkit-js/playkit-js"),o=r("./src/reducers/shell.ts"),l=r("./src/event/events/audio-selected-event.ts"),u=r("./src/event/events/caption-selected-event.ts"),c=r("./src/event/events/captions-style-selected-event.ts"),d=r("./src/event/events/quality-selected-event.ts"),p=r("./src/event/events/seeked-event.ts"),h=r("./src/event/events/speed-selected-event.ts"),f=r("./src/event/events/player-resize-event.ts"),m=r("./src/event/events/gui-resize-event.ts"),g=r("./src/event/events/video-resize-event.ts"),y=r("./src/event/events/ui-visibility-changed-event.ts"),v=r("./src/event/events/rewind-clicked.ts"),_=r("./src/event/events/forward-clicked.ts"),k=r("./src/event/events/volume-changed.ts"),E=r("./src/utils/index.ts"),b=r("./src/event/index.ts"),T="event-dispatcher-middleware",A={COMPONENT_CLICKED:"".concat(T,"/COMPONENT_CLICKED"),COMPONENT_CHANGED:"".concat(T,"/COMPONENT_CHANGED")},S=function(e){return function(t){return function(r){return function(n){switch(n.type){case A.COMPONENT_CLICKED:!function(e,t,r){switch(t.name){case"Keyboard":I[t.payload.key](e,t,r);break;case"OverlayAction":!function(e,t,r){"PlayPause"===t.payload.type?P(e,0,r):"Fullscreen"===t.payload.type&&x(0,0,r)}(e,t,r);break;case"CaptionsMenu":!function(e,t,r){t.payload.type===r.Track.TEXT&&r.dispatchEvent(new u.CaptionSelectedEvent(t.payload.track))}(0,t,r);break;case"AudioMenu":!function(e,t,r){t.payload.type===r.Track.AUDIO&&r.dispatchEvent(new l.AudioSelectedEvent(t.payload.track))}(0,t,r);break;case"QualityMenu":!function(e,t,r){t.payload.type===r.Track.VIDEO&&r.dispatchEvent(new d.QualitySelectedEvent(t.payload.track))}(0,t,r);break;case"SpeedMenu":!function(e,t,r){"speed"===t.payload.type&&r.dispatchEvent(new h.SpeedSelectedEvent(t.payload.speed))}(0,t,r);break;case"AdvancedAudioDescToggle":!function(e,t,r){"AdvancedAudioDescription"===t.payload.type&&r.dispatchEvent(new s.FakeEvent(b.EventType.USER_CLICKED_ADVANCED_AUDIO_DESCRIPTION,t.payload))}(0,t,r);break;case"CVAAOverlay":r.dispatchEvent(new c.CaptionsStyleSelectedEvent(t.payload.textStyle));break;case"Fullscreen":x(0,0,r);break;case"Shell":r.dispatchEvent(new s.FakeEvent(b.EventType.UI_CLICKED));break;case"Rewind":r.dispatchEvent(new v.RewindClickedEvent(t.payload.from,t.payload.to));break;case"Forward":r.dispatchEvent(new _.ForwardClickedEvent(t.payload.from,t.payload.to));break;case"LiveTag":r.dispatchEvent(new s.FakeEvent(b.EventType.USER_CLICKED_LIVE_TAG));break;case"PrePlaybackPlayOverlay":case"PlayPause":P(e,0,r);break;case"Volume":C(e,0,r)}}(t,n,e);break;case A.COMPONENT_CHANGED:!function(e,t,r){switch(t.name){case"Volume":r.dispatchEvent(new k.VolumeChangedEvent(t.payload.volume));break;case"SeekBarPlaybackContainer":r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to));break;case"ActivePreset":r.dispatchEvent(new s.FakeEvent(b.EventType.UI_PRESET_CHANGE,t.payload))}}(0,n,e);break;case o.types.UPDATE_PLAYER_HOVER_STATE:!function(e,t,r){var n=e.getState().engine,a=e.getState().shell;!n.adBreak&&n.isPlaying&&a.playerHover!==t.hover&&r.dispatchEvent(new y.UIVisibilityChangedEvent(t.hover))}(t,n,e)}switch(r(n),n.type){case o.types.UPDATE_GUI_CLIENT_RECT:!function(e,t,r){var n=e.getState().shell.guiClientRect;r.dispatchEvent(new m.GuiResizeEvent(n))}(t,0,e);break;case o.types.UPDATE_PLAYER_CLIENT_RECT:!function(e,t,r){var n=e.getState().shell.playerClientRect;r.dispatchEvent(new f.PlayerResizeEvent(n))}(t,0,e);break;case o.types.UPDATE_VIDEO_CLIENT_RECT:!function(e,t,r){var n=e.getState().shell.videoClientRect;r.dispatchEvent(new g.VideoResizeEvent(n))}(t,0,e)}}}}};function P(e,t,r){var n=e.getState().engine;n.adBreak?n.adIsPlaying?r.dispatchEvent(new s.FakeEvent(b.EventType.USER_CLICKED_PAUSE)):r.dispatchEvent(new s.FakeEvent(b.EventType.USER_CLICKED_PLAY)):n.isPlaying?r.dispatchEvent(new s.FakeEvent(b.EventType.USER_CLICKED_PAUSE)):r.dispatchEvent(new s.FakeEvent(b.EventType.USER_CLICKED_PLAY))}function C(e,t,r){e.getState().engine.muted?r.dispatchEvent(new s.FakeEvent(b.EventType.USER_CLICKED_MUTE)):r.dispatchEvent(new s.FakeEvent(b.EventType.USER_CLICKED_UNMUTE))}function x(e,t,r){r.isFullscreen()?r.dispatchEvent(new s.FakeEvent(b.EventType.USER_EXITED_FULL_SCREEN)):r.dispatchEvent(new s.FakeEvent(b.EventType.USER_ENTERED_FULL_SCREEN))}var I=(n={},i()(n,E.KeyMap.SPACE,(function(e,t,r){P(e,0,r)})),i()(n,E.KeyMap.UP,(function(e,t,r){r.dispatchEvent(new k.VolumeChangedEvent(t.payload.volume))})),i()(n,E.KeyMap.DOWN,(function(e,t,r){r.dispatchEvent(new k.VolumeChangedEvent(t.payload.volume))})),i()(n,E.KeyMap.F,(function(e,t,r){x(0,0,r)})),i()(n,E.KeyMap.P,(function(e,t,r){!function(e,t,r){r.isInPictureInPicture()?r.dispatchEvent(new s.FakeEvent(b.EventType.USER_EXITED_PICTURE_IN_PICTURE)):r.dispatchEvent(new s.FakeEvent(b.EventType.USER_ENTERED_PICTURE_IN_PICTURE))}(0,0,r)})),i()(n,E.KeyMap.ESC,(function(e,t,r){x(0,0,r)})),i()(n,E.KeyMap.LEFT,(function(e,t,r){r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to))})),i()(n,E.KeyMap.RIGHT,(function(e,t,r){r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to))})),i()(n,E.KeyMap.HOME,(function(e,t,r){r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to))})),i()(n,E.KeyMap.END,(function(e,t,r){r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to))})),i()(n,E.KeyMap.M,(function(e,t,r){C(e,0,r)})),i()(n,E.KeyMap.SEMI_COLON,(function(e,t,r){r.dispatchEvent(new h.SpeedSelectedEvent(t.payload.speed))})),i()(n,E.KeyMap.PERIOD,(function(e,t,r){r.dispatchEvent(new h.SpeedSelectedEvent(t.payload.speed))})),i()(n,E.KeyMap.COMMA,(function(e,t,r){r.dispatchEvent(new h.SpeedSelectedEvent(t.payload.speed))})),i()(n,E.KeyMap.C,(function(e,t,r){r.dispatchEvent(new u.CaptionSelectedEvent(t.payload.track))})),n)},"./src/middlewares/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{middleware:function(){return o}});var n=r("./node_modules/redux/es/redux.js"),a=r("./src/middlewares/event-dispatcher.ts"),i=r("./src/middlewares/logger.ts"),s=r("./src/middlewares/debounce-middleware.ts"),o=function(e,t){return(0,n.applyMiddleware)((0,i.loggerMiddleware)(t),(0,a.eventDispatcherMiddleware)(e),(0,s.debounceMiddleware)())}},"./src/middlewares/logger.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{loggerMiddleware:function(){return i}});var n,a=r("./src/utils/logger.ts"),i=function(e){return function(t){return function(t){return function(r){n||(n=(0,a.default)("UILoggerMiddleware")),e.debugActions&&n.debug("Action fired",r),t(r)}}}}},"./src/reducers/bottom-bar.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={UPDATE_CONTROLS_TO_MOVE:"bottom-bar/UPDATE_CONTROLS_TO_MOVE"},l={controlsToMove:[]};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===o.UPDATE_CONTROLS_TO_MOVE?s(s({},e),{},{controlsToMove:t.controlsToMove}):e};var u={updateControlsToMove:function(e){return{type:o.UPDATE_CONTROLS_TO_MOVE,controlsToMove:e}}}},"./src/reducers/config.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return c},initialState:function(){return u},types:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./src/utils/merge-deep.ts");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l={UPDATE:"config/UPDATE",UPDATE_COMPONENT:"config/UPDATE_COMPONENT",RESET:"config/RESET"},u={targetId:void 0,forceTouchUI:!1,showPlayPauseButton:!0,showLivePlayPauseButton:!0,showCCButton:!0,openMenuFromCCButton:!1,settings:{showAudioMenu:!0,showCaptionsMenu:!0,showQualityMenu:!0,showSpeedMenu:!0,showAdvancedAudioDescToggle:!1,showAdvancedCaptionsMenu:!0},hoverTimeout:3e3,tinySizeDisabled:!1,components:{watermark:{},seekbar:{},vrStereo:{},logo:{},fullscreen:{},sidePanels:{}}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.UPDATE:var r=(0,i.mergeDeep)({},e,t.config);return o(o({},e),r);case l.UPDATE_COMPONENT:return o(o({},e),{},{components:o(o({},e.components),{},a()({},t.componentAlias,(0,i.mergeDeep)({},e.components[t.componentAlias],t.config)))});default:return e}};var c={updateConfig:function(e){return{type:l.UPDATE,config:e}},updateComponentConfig:function(e,t){return{type:l.UPDATE_COMPONENT,componentAlias:e,config:t}}}},"./src/reducers/cvaa.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={UPDATE_CAPTIONS_STYLE:"cvaa/UPDATE_CAPTIONS_STYLE"},l={style:"default"};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===o.UPDATE_CAPTIONS_STYLE?s(s({},e),{},{style:t.style}):e};var u={updateCaptionsStyle:function(e){return{type:o.UPDATE_CAPTIONS_STYLE,style:e}}}},"./src/reducers/engine.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return p},initialState:function(){return d},types:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./src/utils/component-config.ts"),s=r("./src/reducers/config.ts");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u="engine",c={UPDATE_PLAYER_STATE:"".concat(u,"/UPDATE_PLAYER_STATE"),UPDATE_PRE_PLAYBACK:"".concat(u,"/UPDATE_PRE_PLAYBACK"),UPDATE_IS_PLAYING:"".concat(u,"/UPDATE_IS_PLAYING"),UPDATE_IS_PAUSED:"".concat(u,"/UPDATE_IS_PAUSED"),UPDATE_IS_SEEKING:"".concat(u,"/UPDATE_IS_SEEKING"),UPDATE_LAST_SEEK_POINT:"".concat(u,"/UPDATE_LAST_SEEK_POINT"),UPDATE_IS_CHANGING_SOURCE:"".concat(u,"/UPDATE_IS_CHANGING_SOURCE"),UPDATE_IS_ENDED:"".concat(u,"/UPDATE_IS_ENDED"),UPDATE_IS_PLAYBACK_STARTED:"".concat(u,"/UPDATE_IS_PLAYBACK_STARTED"),UPDATE_IS_PLAYBACK_ENDED:"".concat(u,"/UPDATE_IS_PLAYBACK_ENDED"),UPDATE_CURRENT_TIME:"".concat(u,"/UPDATE_CURRENT_TIME"),UPDATE_DURATION:"".concat(u,"/UPDATE_DURATION"),UPDATE_VOLUME:"".concat(u,"/UPDATE_VOLUME"),UPDATE_MUTED:"".concat(u,"/UPDATE_MUTED"),UPDATE_METADATA_LOADING_STATUS:"".concat(u,"/UPDATE_METADATA_LOADING_STATUS"),UPDATE_DATA_LOADING_STATUS:"".concat(u,"/UPDATE_DATA_LOADING_STATUS"),UPDATE_AUDIO_TRACKS:"".concat(u,"/UPDATE_AUDIO_TRACKS"),UPDATE_VIDEO_TRACKS:"".concat(u,"/UPDATE_VIDEO_TRACKS"),UPDATE_TEXT_TRACKS:"".concat(u,"/UPDATE_TEXT_TRACKS"),UPDATE_AD_BREAK:"".concat(u,"/UPDATE_AD_BREAK"),UPDATE_AD_BREAK_PROGRESS:"".concat(u,"/UPDATE_AD_BREAK_PROGRESS"),UPDATE_AD_BREAK_COMPLETED:"".concat(u,"/UPDATE_AD_BREAK_COMPLETED"),UPDATE_AD_IS_PLAYING:"".concat(u,"/UPDATE_AD_IS_PLAYING"),UPDATE_AD_SKIP_TIME_OFFSET:"".concat(u,"/UPDATE_AD_SKIP_TIME_OFFSET"),UPDATE_AD_SKIPPABLE_STATE:"".concat(u,"/UPDATE_AD_SKIPPABLE_STATE"),UPDATE_AD_URL:"".concat(u,"/UPDATE_AD_URL"),UPDATE_AD_IS_LINEAR:"".concat(u,"/UPDATE_AD_IS_LINEAR"),UPDATE_AD_IS_BUMPER:"".concat(u,"/UPDATE_AD_IS_BUMPER"),UPDATE_AD_CONTENT_TYPE:"".concat(u,"/UPDATE_AD_CONTENT_TYPE"),UPDATE_PLAYER_POSTER:"".concat(u,"/UPDATE_PLAYER_POSTER"),UPDATE_IS_AUDIO:"".concat(u,"/UPDATE_IS_AUDIO"),UPDATE_IS_LIVE:"".concat(u,"/UPDATE_IS_LIVE"),UPDATE_IS_DVR:"".concat(u,"/UPDATE_IS_DVR"),UPDATE_IS_IMG:"".concat(u,"/UPDATE_IS_IMG"),UPDATE_IS_DOCUMENT:"".concat(u,"/UPDATE_IS_DOCUMENT"),UPDATE_ERROR:"".concat(u,"/ERROR"),UPDATE_ERROR_DETAILS:"".concat(u,"/ERROR_DETAILS"),UPDATE_IS_IDLE:"".concat(u,"/UPDATE_IS_IDLE"),UPDATE_FALLBACK_TO_MUTED_AUTOPLAY:"".concat(u,"/UPDATE_FALLBACK_TO_MUTED_AUTOPLAY"),UPDATE_IS_VR:"".concat(u,"/UPDATE_IS_VR"),UPDATE_VR_STEREO_MODE:"".concat(u,"/UPDATE_VR_STEREO_MODE"),UPDATE_IS_CASTING:"".concat(u,"/UPDATE_IS_CASTING"),UPDATE_CAST_SESSION:"".concat(u,"/UPDATE_CAST_SESSION"),UPDATE_IS_CAST_AVAILABLE:"".concat(u,"/UPDATE_IS_CAST_AVAILABLE"),UPDATE_PLAYLIST:"".concat(u,"/UPDATE_PLAYLIST"),UPDATE_PICTURE_IN_PICTURE_SUPPORTED:"".concat(u,"/UPDATE_PICTURE_IN_PICTURE_SUPPORTED"),UPDATE_PICTURE_IN_PICTURE_MODE:"".concat(u,"/UPDATE_PICTURE_IN_PICTURE_MODE"),UPDATE_FULLSCREEN:"".concat(u,"/UPDATE_FULLSCREEN")},d={isIdle:!1,isPlaying:!1,isPaused:!0,isSeeking:!1,isEnded:!1,isPlaybackStarted:!1,isPlaybackEnded:!1,isChangingSource:!1,prePlayback:!0,metadataLoaded:!1,dataLoaded:!1,playerState:{previousState:"",currentState:""},fallbackToMutedAutoPlay:!1,poster:"",currentTime:0,lastSeekPoint:0,duration:0,volume:1,muted:!1,videoTracks:[],audioTracks:[],textTracks:[],adIsLinear:!1,adBreak:!1,adIsPlaying:!1,adSkipTimeOffset:0,adSkippableState:!1,adIsBumper:!1,adContentType:null,isLive:!1,isDvr:!1,isImg:!1,isDocument:!1,isAudio:!1,adProgress:{currentTime:0,duration:0},adUrl:"",hasError:!1,errorDetails:{errorCategory:void 0,errorTitle:void 0,errorMessage:void 0},isVr:!1,vrStereoMode:!1,isCasting:!1,castSession:null,isCastAvailable:!1,pictureInPictureSupported:!1,isInPictureInPicture:!1,playlist:null,fullscreen:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s.types.UPDATE:return(0,i.getComponentStateFromConfig)(u,e,t);case s.types.UPDATE_COMPONENT:return(0,i.getComponentStateFromComponentConfig)(u,e,t);case c.UPDATE_ERROR:return l(l({},e),{},{hasError:t.hasError});case c.UPDATE_ERROR_DETAILS:return l(l({},e),{},{errorDetails:t.errorDetails});case c.UPDATE_PLAYER_STATE:return l(l({},e),{},{playerState:t.playerState});case c.UPDATE_PRE_PLAYBACK:return l(l({},e),{},{prePlayback:t.prePlayback});case c.UPDATE_IS_PLAYING:return l(l({},e),{},{isPlaying:t.isPlaying});case c.UPDATE_IS_PAUSED:return l(l({},e),{},{isPaused:t.isPaused});case c.UPDATE_IS_SEEKING:return l(l({},e),{},{isSeeking:t.isSeeking});case c.UPDATE_LAST_SEEK_POINT:return l(l({},e),{},{lastSeekPoint:t.lastSeekPoint});case c.UPDATE_IS_ENDED:return l(l({},e),{},{isEnded:t.isEnded});case c.UPDATE_IS_PLAYBACK_STARTED:return l(l({},e),{},{isPlaybackStarted:t.isPlaybackStarted});case c.UPDATE_IS_PLAYBACK_ENDED:return l(l({},e),{},{isPlaybackEnded:t.isPlaybackEnded});case c.UPDATE_CURRENT_TIME:return l(l({},e),{},{currentTime:t.currentTime});case c.UPDATE_DURATION:return l(l({},e),{},{duration:t.duration});case c.UPDATE_VOLUME:return l(l({},e),{},{volume:t.volume});case c.UPDATE_MUTED:return l(l({},e),{},{muted:t.muted});case c.UPDATE_METADATA_LOADING_STATUS:return l(l({},e),{},{metadataLoaded:t.metadataLoaded});case c.UPDATE_DATA_LOADING_STATUS:return l(l({},e),{},{dataLoaded:t.dataLoaded});case c.UPDATE_AUDIO_TRACKS:return l(l({},e),{},{audioTracks:t.tracks});case c.UPDATE_VIDEO_TRACKS:return l(l({},e),{},{videoTracks:t.tracks});case c.UPDATE_TEXT_TRACKS:return l(l({},e),{},{textTracks:t.tracks});case c.UPDATE_AD_BREAK:return l(l({},e),{},{adBreak:t.adBreak});case c.UPDATE_AD_BREAK_PROGRESS:return l(l({},e),{},{adProgress:t.adProgress});case c.UPDATE_AD_BREAK_COMPLETED:return l(l({},e),{},{adProgress:{currentTime:e.adProgress.duration,duration:e.adProgress.duration}});case c.UPDATE_AD_IS_PLAYING:return l(l({},e),{},{adIsPlaying:t.adIsPlaying});case c.UPDATE_AD_IS_LINEAR:return l(l({},e),{},{adIsLinear:t.adIsLinear});case c.UPDATE_AD_SKIP_TIME_OFFSET:return l(l({},e),{},{adSkipTimeOffset:t.adSkipTimeOffset});case c.UPDATE_AD_SKIPPABLE_STATE:return l(l({},e),{},{adSkippableState:t.adSkippableState});case c.UPDATE_AD_URL:return l(l({},e),{},{adUrl:t.adUrl});case c.UPDATE_AD_IS_BUMPER:return l(l({},e),{},{adIsBumper:t.adIsBumper});case c.UPDATE_AD_CONTENT_TYPE:return l(l({},e),{},{adContentType:t.adContentType});case c.UPDATE_PLAYER_POSTER:return l(l({},e),{},{poster:t.poster});case c.UPDATE_IS_AUDIO:return l(l({},e),{},{isAudio:t.isAudio});case c.UPDATE_IS_LIVE:return l(l({},e),{},{isLive:t.isLive});case c.UPDATE_IS_DVR:return l(l({},e),{},{isDvr:t.isDvr});case c.UPDATE_IS_IMG:return l(l({},e),{},{isImg:t.isImg});case c.UPDATE_IS_DOCUMENT:return l(l({},e),{},{isDocument:t.isDocument});case c.UPDATE_IS_IDLE:return l(l({},e),{},{isIdle:t.IsIdle});case c.UPDATE_FALLBACK_TO_MUTED_AUTOPLAY:return l(l({},e),{},{fallbackToMutedAutoPlay:t.fallback});case c.UPDATE_IS_VR:return l(l({},e),{},{isVr:t.isVr});case c.UPDATE_VR_STEREO_MODE:return l(l({},e),{},{vrStereoMode:t.vrStereoMode});case c.UPDATE_IS_CASTING:return l(l({},e),{},{isCasting:t.isCasting});case c.UPDATE_CAST_SESSION:return l(l({},e),{},{castSession:t.castSession});case c.UPDATE_IS_CAST_AVAILABLE:return l(l({},e),{},{isCastAvailable:t.isCastAvailable});case c.UPDATE_IS_CHANGING_SOURCE:return l(l({},e),{},{isChangingSource:t.isChangingSource});case c.UPDATE_PLAYLIST:return l(l({},e),{},{playlist:t.playlist});case c.UPDATE_PICTURE_IN_PICTURE_SUPPORTED:return l(l({},e),{},{isPictureInPictureSupported:t.isPictureInPictureSupported});case c.UPDATE_PICTURE_IN_PICTURE_MODE:return l(l({},e),{},{isInPictureInPicture:t.isInPictureInPicture});case c.UPDATE_FULLSCREEN:return l(l({},e),{},{fullscreen:t.fullscreen});default:return e}};var p={updateHasError:function(e){return{type:c.UPDATE_ERROR,hasError:e}},updateErrorDetails:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{type:c.UPDATE_ERROR_DETAILS,errorDetails:{errorCategory:e,errorTitle:t,errorMessage:r}}},updatePlayerState:function(e,t){return{type:c.UPDATE_PLAYER_STATE,playerState:{prevoiusState:e,currentState:t}}},updatePrePlayback:function(e){return{type:c.UPDATE_PRE_PLAYBACK,prePlayback:e}},updateIsPlaying:function(e){return{type:c.UPDATE_IS_PLAYING,isPlaying:e}},updateIsPaused:function(e){return{type:c.UPDATE_IS_PAUSED,isPaused:e}},updateIsSeeking:function(e){return{type:c.UPDATE_IS_SEEKING,isSeeking:e}},updateLastSeekPoint:function(e){return{type:c.UPDATE_LAST_SEEK_POINT,lastSeekPoint:e}},updateIsEnded:function(e){return{type:c.UPDATE_IS_ENDED,isEnded:e}},updateIsPlaybackStarted:function(e){return{type:c.UPDATE_IS_PLAYBACK_STARTED,isPlaybackStarted:e}},updateIsPlaybackEnded:function(e){return{type:c.UPDATE_IS_PLAYBACK_ENDED,isPlaybackEnded:e}},updateCurrentTime:function(e){return{type:c.UPDATE_CURRENT_TIME,currentTime:e}},updateDuration:function(e){return{type:c.UPDATE_DURATION,duration:e}},updateVolume:function(e){return{type:c.UPDATE_VOLUME,volume:e}},updateMuted:function(e){return{type:c.UPDATE_MUTED,muted:e}},updateMetadataLoadingStatus:function(e){return{type:c.UPDATE_METADATA_LOADING_STATUS,metadataLoaded:e}},updateDataLoadingStatus:function(e){return{type:c.UPDATE_DATA_LOADING_STATUS,dataLoaded:e}},updateAudioTracks:function(e){return{type:c.UPDATE_AUDIO_TRACKS,tracks:e}},updateVideoTracks:function(e){return{type:c.UPDATE_VIDEO_TRACKS,tracks:e}},updateTextTracks:function(e){return{type:c.UPDATE_TEXT_TRACKS,tracks:e}},updateAdBreak:function(e){return{type:c.UPDATE_AD_BREAK,adBreak:e}},updateAdBreakProgress:function(e,t){return{type:c.UPDATE_AD_BREAK_PROGRESS,adProgress:{currentTime:e,duration:t}}},updateAdBreakCompleted:function(){return{type:c.UPDATE_AD_BREAK_COMPLETED}},updateAdIsPlaying:function(e){return{type:c.UPDATE_AD_IS_PLAYING,adIsPlaying:e}},updateAdSkipTimeOffset:function(e){return{type:c.UPDATE_AD_SKIP_TIME_OFFSET,adSkipTimeOffset:e}},updateAdSkippableState:function(e){return{type:c.UPDATE_AD_SKIPPABLE_STATE,adSkippableState:e}},updateAdClickUrl:function(e){return{type:c.UPDATE_AD_URL,adUrl:e}},updateAdIsLinear:function(e){return{type:c.UPDATE_AD_IS_LINEAR,adIsLinear:e}},updateAdIsBumper:function(e){return{type:c.UPDATE_AD_IS_BUMPER,adIsBumper:e}},updateAdContentType:function(e){return{type:c.UPDATE_AD_CONTENT_TYPE,adContentType:e}},updatePlayerPoster:function(e){return{type:c.UPDATE_PLAYER_POSTER,poster:e}},updateIsAudio:function(e){return{type:c.UPDATE_IS_AUDIO,isAudio:e}},updateIsLive:function(e){return{type:c.UPDATE_IS_LIVE,isLive:e}},updateIsDvr:function(e){return{type:c.UPDATE_IS_DVR,isDvr:e}},updateIsImg:function(e){return{type:c.UPDATE_IS_IMG,isImg:e}},updateIsDocument:function(e){return{type:c.UPDATE_IS_DOCUMENT,isDocument:e}},updateIsIdle:function(e){return{type:c.UPDATE_IS_IDLE,IsIdle:e}},updateFallbackToMutedAutoPlay:function(e){return{type:c.UPDATE_FALLBACK_TO_MUTED_AUTOPLAY,fallback:e}},updateIsVr:function(e){return{type:c.UPDATE_IS_VR,isVr:e}},updateVrStereoMode:function(e){return{type:c.UPDATE_VR_STEREO_MODE,vrStereoMode:e}},updateIsCasting:function(e){return{type:c.UPDATE_IS_CASTING,isCasting:e}},updateCastSession:function(e){return{type:c.UPDATE_CAST_SESSION,castSession:e}},updateIsCastAvailable:function(e){return{type:c.UPDATE_IS_CAST_AVAILABLE,isCastAvailable:e}},updateIsChangingSource:function(e){return{type:c.UPDATE_IS_CHANGING_SOURCE,isChangingSource:e}},updatePlaylist:function(e){return{type:c.UPDATE_PLAYLIST,playlist:e}},updatePictureInPictureSupport:function(e){return{type:c.UPDATE_PICTURE_IN_PICTURE_SUPPORTED,isPictureInPictureSupported:e}},updateIsInPictureInPicture:function(e){return{type:c.UPDATE_PICTURE_IN_PICTURE_MODE,isInPictureInPicture:e}},updateFullscreen:function(e){return{type:c.UPDATE_FULLSCREEN,fullscreen:e}}}},"./src/reducers/getters.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{isPlayingAdOrPlayback:function(){return n}});var n=function(e){return e.adBreak&&e.adIsPlaying||!e.adBreak&&e.isPlaying}},"./src/reducers/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{bottomBar:function(){return m},config:function(){return n},cvaa:function(){return a},engine:function(){return i},getters:function(){return s},loading:function(){return o},overlay:function(){return f},overlayAction:function(){return l},playlist:function(){return u},seekbar:function(){return c},setting:function(){return d},shell:function(){return p},volume:function(){return h}});var n=r("./src/reducers/config.ts"),a=r("./src/reducers/cvaa.ts"),i=r("./src/reducers/engine.ts"),s=r("./src/reducers/getters.ts"),o=r("./src/reducers/loading.ts"),l=r("./src/reducers/overlay-action.ts"),u=r("./src/reducers/playlist.ts"),c=r("./src/reducers/seekbar.ts"),d=r("./src/reducers/settings.ts"),p=r("./src/reducers/shell.ts"),h=r("./src/reducers/volume.ts"),f=r("./src/reducers/overlay.ts"),m=r("./src/reducers/bottom-bar.ts")},"./src/reducers/loading.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return p},initialState:function(){return d},types:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./src/reducers/config.ts"),s=r("./src/utils/component-config.ts");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u="loading",c={UPDATE_LOADING_SPINNER_STATE:"".concat(u,"/UPDATE_LOADING_SPINNER_STATE")},d={show:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.types.UPDATE:return(0,s.getComponentStateFromConfig)(u,e,t);case i.types.UPDATE_COMPONENT:return(0,s.getComponentStateFromComponentConfig)(u,e,t);case c.UPDATE_LOADING_SPINNER_STATE:return l(l({},e),{},{show:t.show});default:return e}};var p={updateLoadingSpinnerState:function(e){return{type:c.UPDATE_LOADING_SPINNER_STATE,show:e}}}},"./src/reducers/overlay-action.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={UPDATE_ACTION_ICON:"overlay-action/UPDATE_ACTION_ICON"},l={iconType:null};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===o.UPDATE_ACTION_ICON?s(s({},e),{},{iconType:t.iconType}):e};var u={updateOverlayActionIcon:function(e){return{type:o.UPDATE_ACTION_ICON,iconType:e}}}},"./src/reducers/overlay.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={UPDATE_OVERLAY:"overlay/UPDATE_OVERLAY"},l={isOpen:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===o.UPDATE_OVERLAY?s(s({},e),{},{isOpen:t.isOpen}):e};var u={updateOverlay:function(e){return{type:o.UPDATE_OVERLAY,isOpen:e}}}},"./src/reducers/playlist.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={UPDATE_PLAYLIST_COUNTDOWN_CANCELED:"playlist-countdown/UPDATE_PLAYLIST_COUNTDOWN_CANCELED"},l={countdownCanceled:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===o.UPDATE_PLAYLIST_COUNTDOWN_CANCELED?s(s({},e),{},{countdownCanceled:t.countdownCanceled}):e};var u={updatePlaylistCountdownCanceled:function(e){return{type:o.UPDATE_PLAYLIST_COUNTDOWN_CANCELED,countdownCanceled:e}}}},"./src/reducers/seekbar.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return p},initialState:function(){return d},types:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),s=r.n(i);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u="seekbar",c={UPDATE_SEEKBAR_DRAGGING_STATUS:"".concat(u,"/UPDATE_SEEKBAR_DRAGGING_STATUS"),UPDATE_SEEKBAR_HOVER_ACTIVE:"".concat(u,"/UPDATE_SEEKBAR_HOVER_ACTIVE"),UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE:"".concat(u,"/UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE"),UPDATE_SEEKBAR_CLIENT_RECT:"".concat(u,"/UPDATE_SEEKBAR_CLIENT_RECT"),UPDATE_HIDE_SEEKBAR_PREVIEW:"".concat(u,"/UPDATE_HIDE_SEEKBAR_PREVIEW"),UPDATE_HIDE_SEEKBAR_TIME_BUBBLE:"".concat(u,"/UPDATE_HIDE_SEEKBAR_TIME_BUBBLE"),UPDATE_CURRENT_TIME:"".concat(u,"/UPDATE_CURRENT_TIME"),UPDATE_VIRTUAL_TIME:"".concat(u,"/UPDATE_VIRTUAL_TIME"),UPDATE_HOVERED_SEGMENT:"".concat(u,"/UPDATE_HOVERED_SEGMENT"),UPDATE_SEEKBAR_SEGMENTS:"".concat(u,"/UPDATE_SEEKBAR_SEGMENTS"),UPDATE_SEGMENT_END_TIME:"".concat(u,"/UPDATE_SEGMENT_END_TIME"),ADD_SEEKBAR_CLASS:"".concat(u,"/ADD_SEEKBAR_CLASS"),REMOVE_SEEKBAR_CLASS:"".concat(u,"/REMOVE_SEEKBAR_CLASS"),UPDATE_PREVENT_SEEK:"".concat(u,"/UPDATE_PREVENT_SEEK")},d={currentTime:0,virtualTime:0,draggingActive:!1,hoverActive:!1,previewHoverActive:!1,clientRect:{x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0},hidePreview:!1,hideTimeBubble:!1,segments:[],seekbarClasses:[],isPreventSeek:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.UPDATE_SEEKBAR_DRAGGING_STATUS:return l(l({},e),{},{draggingActive:t.draggingActive});case c.UPDATE_SEEKBAR_HOVER_ACTIVE:return l(l({},e),{},{hoverActive:t.hoverActive});case c.UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE:return l(l({},e),{},{previewHoverActive:t.previewHoverActive});case c.UPDATE_SEEKBAR_CLIENT_RECT:return l(l({},e),{},{clientRect:t.clientRect});case c.UPDATE_HIDE_SEEKBAR_PREVIEW:return l(l({},e),{},{hidePreview:t.hidePreview});case c.UPDATE_HIDE_SEEKBAR_TIME_BUBBLE:return l(l({},e),{},{hideTimeBubble:t.hideTimeBubble});case c.UPDATE_CURRENT_TIME:return l(l({},e),{},{currentTime:t.currentTime});case c.UPDATE_VIRTUAL_TIME:return l(l({},e),{},{virtualTime:t.virtualTime});case c.UPDATE_HOVERED_SEGMENT:return l(l({},e),{},{segments:e.segments.map((function(e){return e.id===t.id?l(l({},e),{},{isHovered:t.isHovered}):e}))});case c.UPDATE_SEEKBAR_SEGMENTS:return l(l({},e),{},{segments:t.segments});case c.UPDATE_SEGMENT_END_TIME:return l(l({},e),{},{segments:e.segments.map((function(e){return e.id===t.id?l(l({},e),{},{endTime:t.endTime}):e}))});case c.ADD_SEEKBAR_CLASS:return e.seekbarClasses.includes(t.className)?e:l(l({},e),{},{seekbarClasses:[].concat(a()(e.seekbarClasses),[t.className])});case c.REMOVE_SEEKBAR_CLASS:return l(l({},e),{},{seekbarClasses:e.seekbarClasses.filter((function(e){return e!==t.className}))});case c.UPDATE_PREVENT_SEEK:return l(l({},e),{},{isPreventSeek:t.isPreventSeek});default:return e}};var p={updateSeekbarDraggingStatus:function(e){return{type:c.UPDATE_SEEKBAR_DRAGGING_STATUS,draggingActive:e}},updateSeekbarHoverActive:function(e){return{type:c.UPDATE_SEEKBAR_HOVER_ACTIVE,hoverActive:e}},updateSeekbarPreviewHoverActive:function(e){return{type:c.UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE,previewHoverActive:e}},updateSeekbarClientRect:function(e){return{type:c.UPDATE_SEEKBAR_CLIENT_RECT,clientRect:e}},updateHideSeekbarPreview:function(e){return{type:c.UPDATE_HIDE_SEEKBAR_PREVIEW,hidePreview:e}},updateHideSeekbarTimeBubble:function(e){return{type:c.UPDATE_HIDE_SEEKBAR_TIME_BUBBLE,hideTimeBubble:e}},updateCurrentTime:function(e){return{type:c.UPDATE_CURRENT_TIME,currentTime:e}},updateVirtualTime:function(e){return{type:c.UPDATE_VIRTUAL_TIME,virtualTime:e}},updateHoveredSegment:function(e,t){return{type:c.UPDATE_HOVERED_SEGMENT,id:e,isHovered:t}},updateSegmentEndTime:function(e,t){return{type:c.UPDATE_SEGMENT_END_TIME,id:e,endTime:t}},updateSeekbarSegments:function(e){return{type:c.UPDATE_SEEKBAR_SEGMENTS,segments:e}},addSeekbarClass:function(e){return{type:c.ADD_SEEKBAR_CLASS,className:e}},removeSeekbarClass:function(e){return{type:c.REMOVE_SEEKBAR_CLASS,className:e}},updatePreventSeek:function(e){return{type:c.UPDATE_PREVENT_SEEK,isPreventSeek:e}}}},"./src/reducers/settings.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={UPDATE_QUALITY:"settings/UPDATE_QUALITY",UPDATE_SPEED:"settings/UPDATE_SPEED",UPDATE_AUDIO:"settings/UPDATE_AUDIO",UPDATE_ADVANCED_AUDIO_DESC:"settings/UPDATE_ADVANCED_AUDIO_DESC",UPDATE_IS_CAPTIONS_ENABLED:"settings/UPDATE_IS_CAPTIONS_ENABLED"},l={quality:1,speed:2,advancedAudioDesc:!1,isCaptionsEnabled:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.UPDATE_QUALITY:return s(s({},e),{},{quality:t.quality});case o.UPDATE_SPEED:return s(s({},e),{},{speed:t.speed});case o.UPDATE_AUDIO:return s(s({},e),{},{audio:t.audio});case o.UPDATE_ADVANCED_AUDIO_DESC:return s(s({},e),{},{advancedAudioDesc:t.isChecked});case o.UPDATE_IS_CAPTIONS_ENABLED:return s(s({},e),{},{isCaptionsEnabled:t.isCaptionsEnabled});default:return e}};var u={updateQuality:function(e){return{type:o.UPDATE_QUALITY,quality:e}},updateSpeed:function(e){return{type:o.UPDATE_SPEED,speed:e}},updateAudio:function(e){return{type:o.UPDATE_AUDIO,audio:e}},updateAdvancedAudioDesc:function(e){return{type:o.UPDATE_ADVANCED_AUDIO_DESC,isChecked:e}},updateIsCaptionsEnabled:function(e){return{type:o.UPDATE_IS_CAPTIONS_ENABLED,isCaptionsEnabled:e}}}},"./src/reducers/shell.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ReservedPresetAreas:function(){return v},ReservedPresetNames:function(){return y},SidePanelModes:function(){return g},SidePanelOrientation:function(){return f},SidePanelPositions:function(){return m},actions:function(){return b},initialState:function(){return E},types:function(){return h}});var n,a,i,s=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),u=r.n(l),c=r("./src/utils/is-equal.ts");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h={ADD_PLAYER_CLASS:"shell/ADD_PLAYER_CLASS",REMOVE_PLAYER_CLASS:"shell/REMOVE_PLAYER_CLASS",UPDATE_IS_MOBILE:"shell/UPDATE_IS_MOBILE",UPDATE_PLAYER_SIZE:"shell/UPDATE_PLAYER_SIZE",UPDATE_IS_SMALL_SIZE:"shell/UPDATE_IS_SMALL_SIZE",UPDATE_GUI_CLIENT_RECT:"shell/UPDATE_GUI_CLIENT_RECT",UPDATE_TOP_BAR_CLIENT_RECT:"shell/UPDATE_TOP_BAR_CLIENT_RECT",UPDATE_PLAYER_CLIENT_RECT:"shell/UPDATE_PLAYER_CLIENT_RECT",UPDATE_VIDEO_CLIENT_RECT:"shell/UPDATE_VIDEO_CLIENT_RECT",UPDATE_DOCUMENT_WIDTH:"shell/UPDATE_DOCUMENT_WIDTH",UPDATE_PLAYER_HOVER_STATE:"shell/UPDATE_PLAYER_HOVER_STATE",UPDATE_PLAYER_NAV_STATE:"shell/UPDATE_PLAYER_NAV_STATE",UPDATE_SMART_CONTAINER_OPEN:"shell/UPDATE_SMART_CONTAINER_OPEN",UPDATE_ACTIVE_PRESET_NAME:"shell/UPDATE_ACTIVE_PRESET_NAME",UPDATE_SIDE_PANEL_MODE:"shell/UPDATE_SIDE_PANEL_MODE",UPDATE_SIDE_PANEL_SIZE:"shell/UPDATE_SIDE_PANEL_SIZE",UPDATE_PRESET_SETTINGS:"shell/UPDATE_PRESET_SETTINGS",UPDATE_LAYOUT_STYLES:"shell/UPDATE_LAYOUT_STYLES"},f={VERTICAL:"vertical",HORIZONTAL:"horizontal"},m={LEFT:"left",TOP:"top",BOTTOM:"bottom",RIGHT:"right"},g={ALONGSIDE:"alongside",HIDDEN:"hidden",OVER:"over"},y={Playback:"Playback",Live:"Live",Ads:"Ads",Error:"Error",Idle:"Idle",Img:"Img",Document:"Document",MiniAudioUI:"MiniAudioUI"},v={PlayerArea:"PlayerArea",PresetArea:"PresetArea",InteractiveArea:"InteractiveArea",VideoArea:"VideoArea",GuiArea:"GuiArea",TopBar:"TopBar",BottomBar:"BottomBar",PresetFloating:"PresetFloating",TopBarLeftControls:"TopBarLeftControls",TopBarRightControls:"TopBarRightControls",BottomBarLeftControls:"BottomBarLeftControls",BottomBarRightControls:"BottomBarRightControls",SidePanelTop:"SidePanelTop",SidePanelLeft:"SidePanelLeft",SidePanelRight:"SidePanelRight",SidePanelBottom:"SidePanelBottom",SeekBar:"SeekBar",LoadingSpinner:"LoadingSpinner"},_={x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0},k={position:"absolute",left:0,right:0,top:0,bottom:0},E={playerClasses:[],guiClientRect:_,topBarClientRect:_,playerClientRect:_,videoClientRect:_,layoutStyles:{video:k,gui:k,sidePanels:(n={},u()(n,m.LEFT,{}),u()(n,m.RIGHT,{}),u()(n,m.TOP,{}),u()(n,m.BOTTOM,{}),n)},playerHover:!1,playerNav:!1,smartContainerOpen:!1,activePresetName:"",sidePanelsModes:(a={},u()(a,m.LEFT,g.HIDDEN),u()(a,m.RIGHT,g.HIDDEN),u()(a,m.TOP,g.HIDDEN),u()(a,m.BOTTOM,g.HIDDEN),a),sidePanelsSizes:(i={},u()(i,f.VERTICAL,{min:240,max:480,ratio:.33}),u()(i,f.HORIZONTAL,{min:144,max:288,ratio:.33}),i),presetSettings:{allowSidePanels:!1,allowPlayerArea:!1}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.ADD_PLAYER_CLASS:return e.playerClasses.includes(t.className)?e:p(p({},e),{},{playerClasses:[].concat(o()(e.playerClasses),[t.className])});case h.REMOVE_PLAYER_CLASS:return p(p({},e),{},{playerClasses:e.playerClasses.filter((function(e){return e!==t.className}))});case h.UPDATE_IS_MOBILE:return p(p({},e),{},{isMobile:t.isMobile});case h.UPDATE_PLAYER_SIZE:return p(p({},e),{},{playerSize:t.playerSize});case h.UPDATE_IS_SMALL_SIZE:return p(p({},e),{},{isSmallSize:t.isSmallSize});case h.UPDATE_GUI_CLIENT_RECT:return p(p({},e),{},{guiClientRect:t.guiClientRect});case h.UPDATE_TOP_BAR_CLIENT_RECT:return p(p({},e),{},{topBarClientRect:t.topBarClientRect});case h.UPDATE_PLAYER_CLIENT_RECT:return p(p({},e),{},{playerClientRect:t.playerClientRect});case h.UPDATE_LAYOUT_STYLES:var r,n=e.layoutStyles,a=n.sidePanels,i=n.video,s=n.gui,l=t.layoutStyles,d=l.sidePanels,f=l.video,g=l.gui;return p(p({},e),{},{layoutStyles:{sidePanels:(r={},u()(r,m.LEFT,(0,c.default)(a[m.LEFT],d[m.LEFT])?a[m.LEFT]:d[m.LEFT]),u()(r,m.RIGHT,(0,c.default)(a[m.RIGHT],d[m.RIGHT])?a[m.RIGHT]:d[m.RIGHT]),u()(r,m.TOP,(0,c.default)(a[m.TOP],d[m.TOP])?a[m.TOP]:d[m.TOP]),u()(r,m.BOTTOM,(0,c.default)(a[m.BOTTOM],d[m.BOTTOM])?a[m.BOTTOM]:d[m.BOTTOM]),r),video:(0,c.default)(i,f)?i:f,gui:(0,c.default)(s,g)?s:g}});case h.UPDATE_VIDEO_CLIENT_RECT:return p(p({},e),{},{videoClientRect:t.videoClientRect});case h.UPDATE_DOCUMENT_WIDTH:return p(p({},e),{},{documentWidth:t.documentWidth});case h.UPDATE_PLAYER_HOVER_STATE:return p(p({},e),{},{playerHover:t.hover});case h.UPDATE_PLAYER_NAV_STATE:return p(p({},e),{},{playerNav:t.nav});case h.UPDATE_SMART_CONTAINER_OPEN:return p(p({},e),{},{smartContainerOpen:t.open});case h.UPDATE_ACTIVE_PRESET_NAME:return p(p({},e),{},{activePresetName:t.activePresetName});case h.UPDATE_SIDE_PANEL_MODE:return p(p({},e),{},{sidePanelsModes:p(p({},e.sidePanelsModes),{},u()({},t.position,t.sidePanelMode))});case h.UPDATE_SIDE_PANEL_SIZE:var y=t.options,v=y.ratio,_=y.min,k=y.max,b=e.sidePanelsSizes[t.orientation],T={ratio:"number"==typeof v&&v<=1?v:b.ratio,min:"number"==typeof _?_:b.min,max:"number"==typeof k?k:b.max};return p(p({},e),{},{sidePanelsSizes:p(p({},e.sidePanelsSizes),{},u()({},t.orientation,T))});case h.UPDATE_PRESET_SETTINGS:return p(p({},e),{},{presetSettings:p(p({},{allowSidePanels:!1,allowPlayerArea:!1}),t.presetSettings||{})});default:return e}};var b={addPlayerClass:function(e){return{type:h.ADD_PLAYER_CLASS,className:e}},removePlayerClass:function(e){return{type:h.REMOVE_PLAYER_CLASS,className:e}},updateIsMobile:function(e){return{type:h.UPDATE_IS_MOBILE,isMobile:e}},updatePlayerSize:function(e){return{type:h.UPDATE_PLAYER_SIZE,playerSize:e}},updateIsSmallSize:function(e){return{type:h.UPDATE_IS_SMALL_SIZE,isSmallSize:e}},updateGuiClientRect:function(e){return{type:h.UPDATE_GUI_CLIENT_RECT,guiClientRect:e}},updateTopBarClientRect:function(e){return{type:h.UPDATE_TOP_BAR_CLIENT_RECT,topBarClientRect:e}},updatePlayerClientRect:function(e){return{type:h.UPDATE_PLAYER_CLIENT_RECT,playerClientRect:e}},updateVideoClientRect:function(e){return{type:h.UPDATE_VIDEO_CLIENT_RECT,videoClientRect:e}},updateDocumentWidth:function(e){return{type:h.UPDATE_DOCUMENT_WIDTH,documentWidth:e}},updatePlayerHoverState:function(e){return{type:h.UPDATE_PLAYER_HOVER_STATE,hover:e}},updatePlayerNavState:function(e){return{type:h.UPDATE_PLAYER_NAV_STATE,nav:e}},updateSmartContainerOpen:function(e){return{type:h.UPDATE_SMART_CONTAINER_OPEN,open:e}},updateActivePresetName:function(e){return{type:h.UPDATE_ACTIVE_PRESET_NAME,activePresetName:e}},updateSidePanelMode:function(e,t){return{type:h.UPDATE_SIDE_PANEL_MODE,position:e,sidePanelMode:t}},updateSidePanelSize:function(e,t){return{type:h.UPDATE_SIDE_PANEL_SIZE,orientation:e,options:t}},updatePresetSettings:function(e){return{type:h.UPDATE_PRESET_SETTINGS,presetSettings:e}},updateLayoutStyles:function(e){return{type:h.UPDATE_LAYOUT_STYLES,layoutStyles:e}}}},"./src/reducers/volume.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={UPDATE_VOLUME_DRAGGING_STATUS:"volume/UPDATE_VOLUME_DRAGGING_STATUS",UPDATE_HOVER:"volume/UPDATE_HOVER"},l={draggingActive:!1,hover:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.UPDATE_VOLUME_DRAGGING_STATUS:return s(s({},e),{},{draggingActive:t.draggingActive});case o.UPDATE_HOVER:return s(s({},e),{},{hover:t.hover});default:return e}};var u={updateVolumeDraggingStatus:function(e){return{type:o.UPDATE_VOLUME_DRAGGING_STATUS,draggingActive:e}},updateVolumeHover:function(e){return{type:o.UPDATE_HOVER,hover:e}}}},"./src/store.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/redux/es/redux.js"),a=r("./src/reducers/config.ts"),i=r("./src/reducers/engine.ts"),s=r("./src/reducers/shell.ts"),o=r("./src/reducers/seekbar.ts"),l=r("./src/reducers/volume.ts"),u=r("./src/reducers/loading.ts"),c=r("./src/reducers/cvaa.ts"),d=r("./src/reducers/settings.ts"),p=r("./src/reducers/overlay-action.ts"),h=r("./src/reducers/playlist.ts"),f=r("./src/reducers/overlay.ts"),m=r("./src/reducers/bottom-bar.ts"),g=(0,n.combineReducers)({config:a.default,engine:i.default,shell:s.default,seekbar:o.default,volume:l.default,loading:u.default,cvaa:c.default,settings:d.default,overlayAction:p.default,playlist:h.default,overlay:f.default,bottomBar:m.default});t.default=g},"./src/types/components-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/event-handler-option.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/fullscreen-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/index.ts":function(e,t,r){"use strict";r.r(t),r("./src/types/components-config.ts"),r("./src/types/event-handler-option.ts"),r("./src/types/fullscreen-config.ts"),r("./src/types/keyboard-event-handlers.ts"),r("./src/types/keyboard-key.ts"),r("./src/types/logo-config.ts"),r("./src/types/side-panels-config.ts"),r("./src/types/ui-options.ts"),r("./src/types/ui-preset.ts"),r("./src/types/user-theme.ts"),r("./src/types/vr-stereo-config.ts"),r("./src/types/watermark-config.ts"),r("./src/types/reducers/root-state.ts"),r("./src/types/ui-component.ts"),r("./src/types/ui-component-options.ts")},"./src/types/keyboard-event-handlers.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/keyboard-key.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/logo-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/reducers/root-state.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/side-panels-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ui-component-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ui-component.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ui-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ui-preset.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/user-theme.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/vr-stereo-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/watermark-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/ui-manager.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{UIManager:function(){return M}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),p=r.n(d),h=r("./node_modules/preact/dist/preact.module.js"),f=r("./node_modules/react-redux/es/index.js"),m=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),g=r("./node_modules/redux/es/redux.js"),y=r("./src/utils/copy-deep.ts"),v=r("./src/utils/merge-deep.ts"),_=r("./src/utils/logger.ts"),k=r("./src/event/index.ts"),E=r("./src/utils/key-map.ts"),b=r("./src/components/player-area/index.ts"),T=r("./src/store.ts"),A=r("./translations/en.i18n.json"),S=r("./src/reducers/config.ts"),P=r("./src/components/index.ts"),C=r("./src/components/player-gui/index.ts"),x=r("./src/ui-presets/index.ts"),I=r("./src/middlewares/index.ts"),w=(r("./src/styles/style.scss"),r("./src/utils/themes-manager.ts")),R=r("./src/components/context-menu/index.ts"),M=function(){function e(t,r){l()(this,e),p()(this,"player",void 0),p()(this,"targetId",void 0),p()(this,"store",void 0),p()(this,"container",void 0),p()(this,"_translations",{en:A.en}),p()(this,"_locale","en"),p()(this,"_uiComponents",void 0),p()(this,"_themesManager",void 0),(0,_.setLogger)(r.logger),this._uiComponents=s()(r.uiComponents||[]),this.player=t,this.targetId=r.targetId,this._createStore(r),this.setConfig(r),this._setLocaleTranslations(r),this._themesManager=new w.ThemesManager(t,r.userTheme,r.targetId),(0,E.setEnv)(this.player.env)}return c()(e,[{key:"setConfig",value:function(e,t){t?this.store.dispatch(S.actions.updateComponentConfig(t,e)):this.store.dispatch(S.actions.updateConfig(e))}},{key:"addComponent",value:function(e){return function(){}}},{key:"buildDefaultUI",value:function(){var e=[{template:function(e){return x.idleUI(e)},condition:function(e){return e.engine.isIdle}},{template:function(e){return x.errorUI(e)},condition:function(e){return e.engine.hasError}},{template:function(e){return x.adsUI(e)},condition:function(e){return e.engine.adBreak}},{template:function(e){return x.liveUI(e)},condition:function(e){return e.engine.isLive}},{template:function(e){return x.imgUI(e)},condition:function(e){return e.engine.isImg}},{template:function(e){return x.docUI(e)},condition:function(e){return e.engine.isDocument}},{template:function(e){return x.playbackUI(e)}}];this._buildUI(e),this._themesManager.applyUserTheme()}},{key:"buildCustomUI",value:function(e){if(e.length>0)this._buildUI(e);else{var t=[{template:function(e){return x.playbackUI(e)}}];this._buildUI(t)}this._themesManager.applyUserTheme()}},{key:"_setLocaleTranslations",value:function(e){var t=this;e.translations&&Object.entries(e.translations).forEach((function(e){var r=a()(e,2),n=r[0],i=r[1];i=(0,v.mergeDeep)({},t._translations.en,i),t._translations[n]=i})),e.locale&&this._translations[e.locale]&&(this._locale=e.locale)}},{key:"_createStore",value:function(e){var t=window.__REDUX_DEVTOOLS_EXTENSION__;this.store=(0,g.createStore)(T.default,(0,g.compose)((0,I.middleware)(this.player,e),t?t({trace:!1}):function(e){return e}))}},{key:"_buildUI",value:function(e){var t=this;if(this.player&&(this.container=document.getElementById(this.targetId),this.container)){var r=(0,h.h)(f.Provider,{store:this.store},(0,h.h)(b.PlayerAreaProvider,{uiComponents:this._uiComponents,setApi:function(e){e&&(t.addComponent=e)}},(0,h.h)(m.IntlProvider,{definition:this._translations[this._locale]},(0,h.h)(P.PlayerProvider,{player:this.player},(0,h.h)(P.EventDispatcherProvider,{player:this.player,store:this.store},(0,h.h)(P.KeyboardEventProvider,{playerContainer:this.container},(0,h.h)(P.Shell,null,(0,h.h)(R.ContextMenu,null),(0,h.h)(P.EngineConnector,null),(0,h.h)(P.VideoPlayer,null),(0,h.h)(C.PlayerGUI,{uis:e,playerContainer:this.container}))))))));(0,h.render)(r,this.container)}}},{key:"destroy",value:function(){this.container&&(this.container.prepend(this.player.getView()),(0,h.render)("",this.container))}},{key:"getLogLevel",value:function(e){return(0,_.getLogLevel)(e)}},{key:"setLogLevel",value:function(e,t){(0,_.setLogLevel)(e,t)}},{key:"getCSSVariable",value:function(e){return this._themesManager.getCSSVariable(e)}},{key:"setCSSVariable",value:function(e,t){this._themesManager.setCSSVariable(e,t)}},{key:"config",get:function(){return(0,y.copyDeep)(this.store.getState().config)}},{key:"LogLevel",get:function(){return _.LogLevel}},{key:"Event",get:function(){return k.EventType}}]),e}()},"./src/ui-presets/ads.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{adsUI:function(){return c}});var n=r("./src/styles/style.scss"),a=r.n(n),i=r("./node_modules/preact/dist/preact.module.js"),s=r("./node_modules/react-redux/es/index.js"),o=r("./src/components/index.ts"),l=r("./src/components/ad-left-controls/index.ts"),u=(0,s.connect)((function(e){return{state:{shell:e.shell,engine:{adIsLinear:e.engine.adIsLinear,adContentType:e.engine.adContentType}}}}))((0,o.withKeyboardEvent)("Ads")((function(e,t){if(e.updateIsKeyboardEnabled(!0),function(e,t){var r=e.state.shell.isMobile&&!t.player.env.isIPadOS,n=!1;try{var a=t.player.config.plugins.ima.adsRenderingSettings;n=a&&a.useStyledLinearAds}catch(e){}return r||n}(e,t))return(0,i.h)("div",{className:a().adGuiWrapper},(0,i.h)(o.PlayerArea,{name:"PresetArea"},(0,i.h)("div",{className:a().playerGui,id:"player-gui"},(0,i.h)(o.GuiArea,null,(0,i.h)(i.Fragment,null,(0,i.h)(o.Loading,null),(0,i.h)(o.UnmuteIndication,{hasTopBar:!0})),(0,i.h)(i.Fragment,null,(0,i.h)(o.TopBar,{disabled:!0,leftControls:(0,i.h)(l.AdLeftControls,null)}))))));var r={learnMoreButton:!1,skipButton:!1},n=(0,i.h)(o.BottomBar,{leftControls:[o.PlaybackControls,o.TimeDisplayAdsContainer],rightControls:[o.Volume,o.Fullscreen]}),s=(0,i.h)(o.BottomBar,{rightControls:[o.Fullscreen]});return(0,i.h)("div",{className:a().adGuiWrapper},(0,i.h)(o.PlayerArea,{name:"PresetArea"},(0,i.h)("div",{className:a().playerGui,id:"player-gui"},(0,i.h)(o.GuiArea,null,(0,i.h)(i.Fragment,null,(0,i.h)(o.Loading,null),(0,i.h)(o.UnmuteIndication,{hasTopBar:!0}),r.skipButton?(0,i.h)(o.AdSkip,null):void 0,(0,i.h)(o.PlaybackControls,{name:"OverlayPlaybackControls",className:a().centerPlaybackControls})),(0,i.h)(i.Fragment,null,(0,i.h)(o.TopBar,{disabled:!0,leftControls:(0,i.h)(l.AdLeftControls,null),rightControls:r.learnMoreButton?(0,i.h)(o.AdLearnMore,null):void 0}),function(e){var t=e.state.engine,r=t.adIsLinear,n=t.adContentType;return!(r&&n&&!n.startsWith("video"))}(e)?n:s)))))})));function c(e){return(0,i.h)(u,e)}u.displayName="Ads"},"./src/ui-presets/doc.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{docUI:function(){return E}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/index.ts");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var _="Document",k=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=(0,y.withKeyboardEvent)(_)(n=function(e){u()(r,e);var t=v(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"componentDidMount",value:function(){this.props.updateIsKeyboardEnabled(!0)}},{key:"render",value:function(){return(0,g.h)("div",{className:m().playbackGuiWrapper},(0,g.h)(y.PlayerArea,{name:"PresetArea"},(0,g.h)("div",{className:m().playerGui,id:"player-gui"},(0,g.h)(y.VideoArea,null),(0,g.h)(y.GuiArea,null,(0,g.h)(g.Fragment,null,(0,g.h)(y.UnmuteIndication,null),(0,g.h)(y.Loading,null),(0,g.h)(y.OverlayPortal,null),(0,g.h)(y.PlaybackControls,{name:"OverlayPlaybackControls",className:m().centerPlaybackControls}),(0,g.h)(y.CastBeforePlay,null)),(function(){return(0,g.h)(g.Fragment,null,(0,g.h)(y.TopBar,null),(0,g.h)(y.InteractiveArea,null,(0,g.h)(y.Watermark,null)),(0,g.h)(y.BottomBar,{rightControls:[y.VrStereo,y.Cast,y.Fullscreen,y.Logo],leftControls:[]}))})))))}}]),r}(g.Component))||n)||n;function E(e){return(0,g.h)(k,e)}k.displayName=_},"./src/ui-presets/error.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ErrorUI:function(){return u},errorUI:function(){return c}});var n=r("./src/styles/style.scss"),a=r.n(n),i=r("./node_modules/preact/dist/preact.module.js"),s=r("./src/components/error-overlay/index.ts"),o=r("./src/components/player-area/index.ts"),l=r("./src/components/gui-area/index.ts");function u(){return(0,i.h)("div",{className:a().playbackGuiWrapper},(0,i.h)(o.PlayerArea,{name:"PresetArea"},(0,i.h)(l.GuiArea,null,(0,i.h)(i.Fragment,null,(0,i.h)(s.ErrorOverlay,null)))))}function c(e){return(0,i.h)(u,e)}u.displayName="Error"},"./src/ui-presets/idle.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{idleUI:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./src/styles/style.scss"),g=r.n(m),y=r("./src/components/index.ts");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var _=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=function(e){u()(r,e);var t=v(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"render",value:function(){return(0,f.h)("div",{className:g().playbackGuiWrapper},(0,f.h)(y.PlayerArea,{name:"PresetArea"},(0,f.h)(y.GuiArea,null,(0,f.h)(y.Loading,null))))}}]),r}(f.Component))||n;function k(e){return(0,f.h)(_,e)}_.displayName="Idle"},"./src/ui-presets/img.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{imgUI:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/index.ts");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var _=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=(0,y.withKeyboardEvent)("Img")(n=function(e){u()(r,e);var t=v(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"componentDidMount",value:function(){this.props.updateIsKeyboardEnabled(!0)}},{key:"render",value:function(){return(0,g.h)("div",{className:m().playbackGuiWrapper},(0,g.h)(y.PlayerArea,{name:"PresetArea"},(0,g.h)("div",{className:m().playerGui,id:"player-gui"},(0,g.h)(y.VideoArea,null),(0,g.h)(y.GuiArea,null,(0,g.h)(g.Fragment,null,(0,g.h)(y.UnmuteIndication,null),(0,g.h)(y.Loading,null),(0,g.h)(y.OverlayPortal,null),(0,g.h)(y.PlaybackControls,{name:"OverlayPlaybackControls",className:m().centerPlaybackControls}),(0,g.h)(y.CastBeforePlay,null)),(function(){return(0,g.h)(g.Fragment,null,(0,g.h)(y.TopBar,null),(0,g.h)(y.InteractiveArea,null,(0,g.h)(y.Watermark,null)),(0,g.h)(y.BottomBar,{rightControls:[y.VrStereo,y.Cast,y.Fullscreen,y.Logo],leftControls:[]}))})))))}}]),r}(g.Component))||n)||n;function k(e){return(0,g.h)(_,e)}_.displayName="Img"},"./src/ui-presets/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{adsUI:function(){return i.adsUI},docUI:function(){return u.docUI},errorUI:function(){return s.errorUI},idleUI:function(){return n.idleUI},imgUI:function(){return l.imgUI},liveUI:function(){return o.liveUI},playbackUI:function(){return a.playbackUI}});var n=r("./src/ui-presets/idle.tsx"),a=r("./src/ui-presets/playback.tsx"),i=r("./src/ui-presets/ads.tsx"),s=r("./src/ui-presets/error.tsx"),o=r("./src/ui-presets/live.tsx"),l=r("./src/ui-presets/img.tsx"),u=r("./src/ui-presets/doc.tsx")},"./src/ui-presets/live.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{liveUI:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/index.ts"),v=r("./src/components/picture-in-picture-overlay/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k="Live",E=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=(0,y.withKeyboardEvent)(k)(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"componentDidMount",value:function(){this.props.updateIsKeyboardEnabled(!0)}},{key:"render",value:function(){return(0,g.h)("div",{className:m().playbackGuiWrapper},(0,g.h)(y.PlayerArea,{name:"PresetArea"},(0,g.h)("div",{className:m().playerGui,id:"player-gui"},(0,g.h)(y.OverlayAction,null),(0,g.h)(y.VideoArea,null),(0,g.h)(y.GuiArea,null,(0,g.h)(g.Fragment,null,(0,g.h)(y.Loading,null),(0,g.h)(y.OverlayPortal,null),(0,g.h)(v.PictureInPictureOverlay,null),(0,g.h)(y.PlaybackControls,{name:"OverlayPlaybackControls",className:m().centerPlaybackControls}),(0,g.h)(y.PrePlaybackPlayOverlay,null),(0,g.h)(y.CastBeforePlay,null)),(function(e){var t=e.containerRef;return(0,g.h)(g.Fragment,null,(0,g.h)(y.TopBar,null),(0,g.h)(y.InteractiveArea,null,(0,g.h)(y.Watermark,null),(0,g.h)(y.UnmuteIndication,null)),(0,g.h)(y.BottomBar,{leftControls:[y.PlaybackControls,y.Rewind,y.Forward,y.LiveTag],rightControls:[y.VrStereo,y.Volume,y.ClosedCaptions,y.CaptionsControl,y.Settings,y.Cast,y.PictureInPicture,y.Fullscreen,y.Logo]},(0,g.h)(y.SeekBarLivePlaybackContainer,{showFramePreview:!0,showTimeBubble:!0,playerContainer:t})))})))))}}]),r}(g.Component))||n)||n;function b(e){return(0,g.h)(E,e)}E.displayName=k},"./src/ui-presets/playback.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{playbackUI:function(){return A}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(s),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/index.ts"),v=r("./src/components/playlist-countdown/index.ts"),_=r("./src/components/picture-in-picture-overlay/index.ts"),k=r("./src/components/audio-entry-details/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var b="Playback",T=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=(0,y.withKeyboardEvent)(b)(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return o()(r,[{key:"componentDidMount",value:function(){this.props.updateIsKeyboardEnabled(!0)}},{key:"render",value:function(){return(0,g.h)("div",{className:m().playbackGuiWrapper},(0,g.h)(y.PlayerArea,{name:"PresetArea"},(0,g.h)("div",{className:m().playerGui,id:"player-gui"},(0,g.h)(y.OverlayAction,null),(0,g.h)(y.VideoArea,null),(0,g.h)(y.GuiArea,null,(0,g.h)(g.Fragment,null,(0,g.h)(k.AudioEntryDetails,null),(0,g.h)(y.Loading,null),(0,g.h)(y.OverlayPortal,null),(0,g.h)(_.PictureInPictureOverlay,null),(0,g.h)(y.PlaybackControls,{name:"OverlayPlaybackControls",className:m().centerPlaybackControls}),(0,g.h)(y.PlaylistNextScreen,null),(0,g.h)(y.PrePlaybackPlayOverlay,null),(0,g.h)(y.CastBeforePlay,null)),(function(e){var t=e.containerRef;return(0,g.h)(g.Fragment,null,(0,g.h)(y.TopBar,null),(0,g.h)(y.InteractiveArea,null,(0,g.h)(y.UnmuteIndication,null),(0,g.h)(y.Watermark,null),(0,g.h)(v.PlaylistCountdown,null)),(0,g.h)(y.BottomBar,{leftControls:[y.PlaybackControls,y.Rewind,y.Forward,y.TimeDisplayPlaybackContainer],rightControls:[y.VrStereo,y.Volume,y.AdvancedAudioDesc,y.ClosedCaptions,y.CaptionsControl,y.Settings,y.Cast,y.PictureInPicture,y.Fullscreen,y.Logo]},(0,g.h)(y.SeekBarPlaybackContainer,{showFramePreview:!0,showTimeBubble:!0,playerContainer:t})))})))))}}]),r}(g.Component))||n)||n;function A(e){return(0,g.h)(T,e)}T.displayName=b},"./src/utils/bind-actions.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{bindActions:function(){return a}});var n=r("./node_modules/redux/es/redux.js");function a(e){return function(t){return(0,n.bindActionCreators)(e,t)}}},"./src/utils/color-format-convertors.ts":function(e,t,r){"use strict";function n(e){var t=e.toString().match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var r=t[0];3===t[0].length&&(r=r.split("").map((function(e){return e+e})).join(""));var n=parseInt(r,16);return[n>>16&255,n>>8&255,255&n]}function a(e){var t,r=e[0]/255,n=e[1]/255,a=e[2]/255,i=Math.min(r,n,a),s=Math.max(r,n,a),o=s-i;s===i?t=0:r===s?t=(n-a)/o:n===s?t=2+(a-r)/o:a===s&&(t=4+(r-n)/o),(t=Math.min(60*t,360))<0&&(t+=360);var l=(i+s)/2;return[t,100*(s===i?0:l<=.5?o/(s+i):o/(2-s-i)),100*l]}function i(e){return a(n(e))}function s(e,t,r){t/=100,r/=100;var n=(1-Math.abs(2*r-1))*t,a=n*(1-Math.abs(e/60%2-1)),i=r-n/2,s=0,o=0,l=0;return 0<=e&&e<60?(s=n,o=a,l=0):60<=e&&e<120?(s=a,o=n,l=0):120<=e&&e<180?(s=0,o=n,l=a):180<=e&&e<240?(s=0,o=a,l=n):240<=e&&e<300?(s=a,o=0,l=n):300<=e&&e<360&&(s=n,o=0,l=a),s=Math.round(255*(s+i)).toString(16),o=Math.round(255*(o+i)).toString(16),l=Math.round(255*(l+i)).toString(16),1==s.length&&(s="0"+s),1==o.length&&(o="0"+o),1==l.length&&(l="0"+l),"#"+s+o+l}r.r(t),r.d(t,{hexToHsl:function(){return i},hexToRgb:function(){return n},hslToHex:function(){return s},rgbToHsl:function(){return a}})},"./src/utils/component-config.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{getComponentStateFromComponentConfig:function(){return i},getComponentStateFromConfig:function(){return a}});var n=r("./src/utils/merge-deep.ts");function a(e,t,r){var a=r.config.components&&r.config.components[e];return a?(0,n.mergeDeep)(t,a):t}function i(e,t,r){return r.componentAlias===e?(0,n.mergeDeep)(t,r.config):t}},"./src/utils/copy-deep.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{copyDeep:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/typeof.js"),a=r.n(n);function i(e){var t;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach((function(e,r){("object"===a()(e)||Array.isArray(e)&&e.length>0)&&(t[r]=i(e))})):"object"===a()(e)?(t=Object.assign({},e),Object.keys(t).forEach((function(e){("object"===a()(t[e])||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=i(t[e]))}))):t=e,t}},"./src/utils/debounce.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{debounce:function(){return n}});var n=function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];var o=void 0;n&&!r&&e.apply(o,i),clearTimeout(r),r=setTimeout((function(){r=null,n||e.apply(o,i)}),t)}}},"./src/utils/duration-humanizer.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{getDurationAsText:function(){return s}});var n,a=r("./node_modules/humanize-duration/humanize-duration.js"),i=r("./src/utils/logger.ts"),s=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var a=o(t);if(a)try{return e?a(1e3*e,{round:r}):"0"}catch(t){return"".concat(e)}}catch(e){n||(n=(0,i.default)("DurationHumanizer")),n.log(e)}},o=function(e){var t=["en"];e&&(e.match("_")&&t.unshift(e.split("_")[0]),t.unshift(e));for(var r=new Map(a.getSupportedLanguages().map((function(e){return[e.toLowerCase(),e]}))),n=0,i=t;n<i.length;n++){var s=i[n];try{if(r.has(s))return a.humanizer({language:r.get(s)})}catch(e){}}return null}},"./src/utils/focus-element.ts":function(e,t,r){"use strict";function n(e){var t=setInterval((function(){e&&"hidden"!==getComputedStyle(e).visibility&&(e.focus({preventScroll:!0}),clearInterval(t))}),arguments.length>1&&void 0!==arguments[1]?arguments[1]:100)}r.r(t),r.d(t,{focusElement:function(){return n}})},"./src/utils/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KeyCode:function(){return i.KeyCode},KeyMap:function(){return i.KeyMap},bindActions:function(){return n.bindActions},focusElement:function(){return a.focusElement},formatOnlyNumbersInput:function(){return l.formatOnlyNumbersInput},getDurationAsText:function(){return u.getDurationAsText},getLogger:function(){return s.default},toHHMMSS:function(){return l.toHHMMSS},toSecondsFromHHMMSS:function(){return l.toSecondsFromHHMMSS},withKeyboardA11y:function(){return o.withKeyboardA11y}});var n=r("./src/utils/bind-actions.ts"),a=r("./src/utils/focus-element.ts"),i=r("./src/utils/key-map.ts"),s=r("./src/utils/logger.ts"),o=r("./src/utils/popup-keyboard-accessibility.tsx"),l=r("./src/utils/time-format.ts"),u=r("./src/utils/duration-humanizer.ts")},"./src/utils/is-equal.ts":function(e,t,r){"use strict";r.r(t),t.default=function(e,t){var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;a++)if(e[r[a]]!==t[r[a]])return!1;return!0}},"./src/utils/key-map.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KeyCode:function(){return a},KeyMap:function(){return n},getKeyName:function(){return s},isEnter:function(){return l},isEsc:function(){return c},isSpace:function(){return u},isTab:function(){return o},setEnv:function(){return i}});var n={TAB:9,ENTER:13,ESC:27,SPACE:32,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,P:80,C:67,F:70,M:77,SEMI_COLON:186,COMMA:188,PERIOD:190},a={Backspace:"Backspace",Tab:"Tab",Enter:"Enter",ShiftLeft:"ShiftLeft",ShiftRight:"ShiftRight",ControlLeft:"ControlLeft",ControlRight:"ControlRight",AltLeft:"AltLeft",AltRight:"AltRight",Pause:"Pause",CapsLock:"CapsLock",Escape:"Escape",Space:"Space",PageUp:"PageUp",PageDown:"PageDown",End:"End",Home:"Home",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Insert:"Insert",Delete:"Delete",KeyP:"KeyP",KeyC:"KeyC",KeyF:"KeyF",KeyM:"KeyM",KeyR:"KeyR",KeyD:"KeyD",KeyQ:"KeyQ",Numpad0:"Numpad0",Semicolon:"Semicolon",Equal:"Equal",Comma:"Comma",Minus:"Minus",Period:"Period",Slash:"Slash"};function i(e){n.SEMI_COLON="firefox"===e.browser.name.toLowerCase()?59:186}function s(e){for(var t in n)if(n[t]===e)return t;return"NOT_FOUND"}function o(e){return d(e.code,a.Tab)}function l(e){return d(e.code,a.Enter)}function u(e){return d(e.code,a.Space)}function c(e){return d(e.code,a.Escape)}function d(e,t){return e===t}},"./src/utils/logger.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{LogLevel:function(){return a},getLogLevel:function(){return o},setLogLevel:function(){return l},setLogger:function(){return i}});var n={get:function(e){return{VERSION:"",DEBUG:{value:"",name:""},ERROR:{value:"",name:""},INFO:{value:"",name:""},OFF:{value:"",name:""},TIME:{value:"",name:""},TRACE:{value:"",name:""},WARN:{value:"",name:""},createDefaultHandler:function(){},debug:function(){},enabledFor:function(){},error:function(){},get:function(){},getLevel:function(){},info:function(){},log:function(){},setHandler:function(){},setLevel:function(){},time:function(){},timeEnd:function(){},trace:function(){},useDefaults:function(){},warn:function(){}}}},a={};function i(e){e&&"function"==typeof e.getLogger&&(n.get=e.getLogger),e&&e.LogLevel&&(a=e.LogLevel)}function s(e){return n.get(e)}function o(e){return s(e).getLevel()}function l(e,t){s(t).setLevel(e)}t.default=s},"./src/utils/merge-deep.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{isObject:function(){return o},mergeDeep:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/typeof.js"),s=r.n(i);function o(e){return e&&"object"===s()(e)&&!Array.isArray(e)}function l(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!r.length)return e;var i=r.shift();if(o(e)&&o(i))for(var s in i)o(i[s])?(e[s]||Object.assign(e,a()({},s,{})),l(e[s],i[s])):Object.assign(e,a()({},s,i[s]));return l.apply(void 0,[e].concat(r))}},"./src/utils/popup-keyboard-accessibility.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withKeyboardA11y:function(){return A}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/components/player/index.ts"),E=r("./src/utils/key-map.ts"),b=r("./src/utils/focus-element.ts");function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var A=function(e){var t,r=(0,k.withPlayer)(t=function(t){p()(n,t);var r=T(n);function n(){var e;s()(this,n);for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return e=r.call.apply(r,[this].concat(a)),v()(c()(e),"_defaultFocusedElement",void 0),v()(c()(e),"_accessibleChildren",[]),v()(c()(e),"_previouslyActiveElement",void 0),v()(c()(e),"_isModal",!1),v()(c()(e),"_morePluginButton",null),v()(c()(e),"onKeyDown",(function(t){switch(t.keyCode){case E.KeyMap.ESC:e.props.onClose&&(e.props.onClose(),t.stopPropagation());break;case E.KeyMap.DOWN:case E.KeyMap.UP:if(document.activeElement&&!e._isModal){var r=e._accessibleChildren.indexOf(document.activeElement);r=(r+(t.keyCode==E.KeyMap.DOWN?1:-1)+e._accessibleChildren.length)%e._accessibleChildren.length,e._accessibleChildren[r].focus(),t.preventDefault(),t.stopPropagation()}break;case E.KeyMap.TAB:e._isModal?t.shiftKey||document.activeElement!==e._accessibleChildren[e._accessibleChildren.length-1]?t.shiftKey&&document.activeElement===e._accessibleChildren[0]&&(e._accessibleChildren[e._accessibleChildren.length-1].focus(),t.preventDefault(),t.stopPropagation()):(e._accessibleChildren[0].focus(),t.preventDefault(),t.stopPropagation()):(e._previouslyActiveElement=null,e.props.onClose&&e.props.onClose())}})),v()(c()(e),"setDefaultFocusedElement",(function(t){t&&(e._defaultFocusedElement=t)})),v()(c()(e),"addAccessibleChild",(function(t,r){t&&-1==e._accessibleChildren.indexOf(t)&&(r?e._accessibleChildren.unshift(t):e._accessibleChildren.push(t))})),v()(c()(e),"clearAccessibleChildren",(function(){e._accessibleChildren=[]})),v()(c()(e),"focusOnDefault",(function(){var t=e._defaultFocusedElement||e._accessibleChildren.length&&e._accessibleChildren[0];t&&(e._previouslyActiveElement=document.activeElement,"SELECT"===t.tagName?requestAnimationFrame((function(){return t.focus({preventScroll:!0})})):t.focus({preventScroll:!0}))})),v()(c()(e),"setIsModel",(function(t){e.isModal=t})),v()(c()(e),"setMoreButton",(function(t){e.morePluginButton=t})),e}return l()(n,[{key:"componentDidMount",value:function(){this.focusOnDefault()}},{key:"componentWillUnmount",value:function(){var e;this._previouslyActiveElement&&document.contains(this._previouslyActiveElement)&&!this.isOverlayOpen?(0,b.focusElement)(this._previouslyActiveElement):(null===(e=this._previouslyActiveElement)||void 0===e?void 0:e.classList.contains("playkit-dropdown-item_kw"))&&(0,b.focusElement)(this._morePluginButton)}},{key:"render",value:function(t){return(0,_.h)(e,a()({},t,{setDefaultFocusedElement:this.setDefaultFocusedElement,focusOnDefault:this.focusOnDefault,addAccessibleChild:this.addAccessibleChild,clearAccessibleChildren:this.clearAccessibleChildren,handleKeyDown:this.onKeyDown,setIsModal:this.setIsModel,setMoreButton:this.setMoreButton}))}},{key:"isOverlayOpen",get:function(){return this.props.player.ui.store.getState().overlay.isOpen}},{key:"isModal",set:function(e){this._isModal=e}},{key:"morePluginButton",set:function(e){this._morePluginButton=e}}]),n}(_.Component))||t;return r}},"./src/utils/resize-watcher.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ResizeWatcher:function(){return k}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("@playkit-js/playkit-js"),v=r("./src/event/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var k=function(e){c()(r,e);var t=_(r);function r(){var e;a()(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e=t.call.apply(t,[this].concat(i)),g()(l()(e),"_observer",void 0),g()(l()(e),"_el",void 0),e}return s()(r,[{key:"destroy",value:function(){this._observer&&this._observer.disconnect(),this._observer=null,this._el=null}},{key:"init",value:function(e){this._observer||(this._el=e,ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))}},{key:"_createNativeObserver",value:function(){var e=this;this._observer=new ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))}},{key:"_createIframeObserver",value:function(){this._observer=new E(this._triggerResize.bind(this))}},{key:"_triggerResize",value:function(){this.dispatchEvent(new y.FakeEvent(v.EventType.RESIZE))}}]),r}(y.FakeEventTarget),E=function(){function e(t){a()(this,e),g()(this,"_observersStore",{}),g()(this,"_onChangeCallback",void 0),this._onChangeCallback=t}return s()(e,[{key:"observe",value:function(e){var t=this,r=this._createIframe(),n=e.getAttribute("id");this._observersStore[n]=r,e.appendChild(r),r.contentWindow.onresize=function(){return t._onChangeCallback()}}},{key:"disconnect",value:function(){for(var e in this._observersStore){var t=document.getElementById(e),r=this._observersStore[e];r.onresize=null,t&&(t.removeChild(r),delete this._observersStore[t.getAttribute("id")])}}},{key:"_createIframe",value:function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e}}]),e}()},"./src/utils/themes-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ThemesManager:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),c=r.n(u),d=r("./src/utils/color-format-convertors.ts"),p=r("./src/styles/style.scss"),h=r.n(p),f="playkit",m="--".concat(f,"-{name}-color"),g="--".concat(f,"-{name}-hsl-hue"),y="--".concat(f,"-{name}-hsl-saturation"),v="--".concat(f,"-{name}-hsl-lightness"),_={colors:{live:"--playkit-live-color",playerBackground:"--playkit-player-background-color",paperSurface:"--playkit-paper-color",elevatedSurface:"--playkit-elevated-color",protectionSurface:"--playkit-protection-color",tone1:"--playkit-tone-1-color",tone2:"--playkit-tone-2-color",tone3:"--playkit-tone-3-color",tone4:"--playkit-tone-4-color",tone5:"--playkit-tone-5-color",tone6:"--playkit-tone-6-color",tone7:"--playkit-tone-7-color",tone8:"--playkit-tone-8-color",tone1RGB:"--playkit-tone-1-color-rgb",tone2RGB:"--playkit-tone-2-color-rgb",tone3RGB:"--playkit-tone-3-color-rgb",tone4RGB:"--playkit-tone-4-color-rgb",tone5RGB:"--playkit-tone-5-color-rgb",tone6RGB:"--playkit-tone-6-color-rgb",tone7RGB:"--playkit-tone-7-color-rgb",tone8RGB:"--playkit-tone-8-color-rgb"}},k=["primary","secondary","success","danger","warning"],E=["--playkit-icon-data-url","--playkit-icon-chromecast-url","--playkit-icon-quality-HD-active-url","--playkit-icon-quality-4K-active-url","--playkit-icon-quality-8K-active-url"],b=function(){function e(t,r,n){s()(this,e),c()(this,"player",void 0),c()(this,"config",void 0),c()(this,"playerContainerElement",void 0),this.player=t,this.config=r,this.playerContainerElement=document.querySelector("#".concat(n))}return l()(e,[{key:"applyUserTheme",value:function(){this.config&&this.setColors(this.config)}},{key:"makeTextContrastColor",value:function(e){var t=(0,d.hexToHsl)(e),r=t[0],n=t[1],a=t[2];return(r<30||r>205)&&(a=a<70?100:0),r>30&&r<205&&(a=a<40?100:0),(0,d.hslToHex)(r,n,a)}},{key:"setColors",value:function(e){for(var t in e.colors.primary&&this.setSvgFillColor(e.colors.primary),e.colors)if(k.includes(t)){var r=e.colors[t],n=this.makeTextContrastColor(r);this.setAccentOrAcknowledgementColor("".concat(t,"-").concat("text-contrast"),n),this.setAccentOrAcknowledgementColor(t,r),"primary"===t&&this.setSvgFillColor(n,!0)}else this.setColor(_.colors[t],e.colors[t])}},{key:"setAccentOrAcknowledgementColor",value:function(e,t){var r=(0,d.hexToHsl)(t),n=a()(r,3),i=n[0],s=n[1],o=n[2];this.setCSSVariable(m.replace("{name}",e),t),this.setCSSVariable(g.replace("{name}",e),"".concat(Math.round(i),"deg")),this.setCSSVariable(y.replace("{name}",e),"".concat(Math.round(s),"%")),this.setCSSVariable(v.replace("{name}",e),"".concat(Math.round(o),"%"))}},{key:"setColor",value:function(e,t){this.setCSSVariable(e,t)}},{key:"setSvgFillColor",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=0,n=E;r<n.length;r++){var a=n[r],i=this.getCSSVariable(a),s=e.replace("#","%23"),o=/fill='%23([a-f0-9]{3}){1,2}\b'/g;t&&(o=/fill='textColor'/g),this.setCSSVariable(a,i.replaceAll(o,"fill='".concat(s,"'")))}}},{key:"getCSSVariable",value:function(e){return getComputedStyle(this.playerContainerElement.querySelector(".".concat(h().player))).getPropertyValue(e)||""}},{key:"setCSSVariable",value:function(e,t){this.playerContainerElement.querySelector(".".concat(h().player)).style.setProperty(e,t)}}]),e}()},"./src/utils/time-format.ts":function(e,t,r){"use strict";function n(e){var t=parseInt(e,10),r=Math.floor(t/3600),n=Math.floor((t-3600*r)/60),a=t-3600*r-60*n,i=r,s=n,o=a;return r<10&&(i="0"+r),n<10&&(s="0"+n),a<10&&(o="0"+a),"".concat("00"!==i?i+":":"").concat(s,":").concat(o)}function a(e){for(var t=e.split(":"),r=0,n=1,a=t.length-1;a>=0;a--){var i=parseInt(t[a]);if(isNaN(i)||i>59){r=0;break}r+=i*n,n*=60}return r}function i(e){var t=parseInt(e);return t<10?"00:0"+e:t<=59?"00:"+e:n(t)}r.r(t),r.d(t,{formatOnlyNumbersInput:function(){return i},toHHMMSS:function(){return n},toSecondsFromHHMMSS:function(){return a}})},"./src/utils/with-animation.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withAnimation:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(i),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(o),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/event/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){return function(t){return(0,k.withEventManager)(function(r){p()(i,r);var n=E(i);function i(){var t;s()(this,i);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=n.call.apply(n,[this].concat(a)),v()(c()(t),"ref",(0,_.createRef)()),v()(c()(t),"animate",(function(){t.ref.current&&(t.ref.current.classList.add(e),t.props.eventManager.listenOnce(t.ref.current,"animationend",(function(){t.ref.current.classList.remove(e)})))})),t}return l()(i,[{key:"render",value:function(){return(0,_.h)(t,a()({},this.props,{innerRef:this.ref,animate:this.animate}))}}]),i}(_.Component))}}},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/styles/style.scss":function(module,e,t){(e=t("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,"@charset \"UTF-8\";\n.playkit-player {\n  --playkit-primary-hsl-hue: 214deg;\n  --playkit-secondary-hsl-hue: 40deg;\n  --playkit-success-hsl-hue: 135deg;\n  --playkit-danger-hsl-hue: 354deg;\n  --playkit-warning-hsl-hue: 21deg;\n  --playkit-primary-hsl-saturation: 100%;\n  --playkit-secondary-hsl-saturation: 100%;\n  --playkit-success-hsl-saturation: 57%;\n  --playkit-danger-hsl-saturation: 76%;\n  --playkit-warning-hsl-saturation: 81%;\n  --playkit-primary-hsl-lightness: 49%;\n  --playkit-secondary-hsl-lightness: 50%;\n  --playkit-success-hsl-lightness: 30%;\n  --playkit-danger-hsl-lightness: 51%;\n  --playkit-warning-hsl-lightness: 53%;\n  --playkit-primary-color: hsl(var(--playkit-primary-hsl-hue) var(--playkit-primary-hsl-saturation) var(--playkit-primary-hsl-lightness));\n  --playkit-primary-darker-color: hsl(\n    var(--playkit-primary-hsl-hue) var(--playkit-primary-hsl-saturation) calc(var(--playkit-primary-hsl-lightness) - 15%)\n  );\n  --playkit-primary-brighter-color: hsl(\n    var(--playkit-primary-hsl-hue) var(--playkit-primary-hsl-saturation) calc(var(--playkit-primary-hsl-lightness) + 15%)\n  );\n  --playkit-primary-text-contrast-color: #ffffff;\n  --playkit-secondary-color: hsl(var(--playkit-secondary-hsl-hue) var(--playkit-secondary-hsl-saturation) var(--playkit-secondary-hsl-lightness));\n  --playkit-secondary-darker-color: hsl(\n    var(--playkit-secondary-hsl-hue) var(--playkit-secondary-hsl-saturation) calc(var(--playkit-secondary-hsl-lightness) - 15%)\n  );\n  --playkit-secondary-brighter-color: hsl(\n    var(--playkit-secondary-hsl-hue) var(--playkit-secondary-hsl-saturation) calc(var(--playkit-secondary-hsl-lightness) + 15%)\n  );\n  --playkit-secondary-text-contrast-color: #ffffff;\n  --playkit-success-color: hsl(var(--playkit-success-hsl-hue) var(--playkit-success-hsl-saturation) var(--playkit-success-hsl-lightness));\n  --playkit-success-darker-color: hsl(\n    var(--playkit-success-hsl-hue) var(--playkit-success-hsl-saturation) calc(var(--playkit-success-hsl-lightness) - 15%)\n  );\n  --playkit-success-brighter-color: hsl(\n    var(--playkit-success-hsl-hue) var(--playkit-success-hsl-saturation) calc(var(--playkit-success-hsl-lightness) + 15%)\n  );\n  --playkit-success-text-contrast-color: #ffffff;\n  --playkit-danger-color: hsl(var(--playkit-danger-hsl-hue) var(--playkit-danger-hsl-saturation) var(--playkit-danger-hsl-lightness));\n  --playkit-danger-darker-color: hsl(\n    var(--playkit-danger-hsl-hue) var(--playkit-danger-hsl-saturation) calc(var(--playkit-danger-hsl-lightness) - 15%)\n  );\n  --playkit-danger-brighter-color: hsl(\n    var(--playkit-danger-hsl-hue) var(--playkit-danger-hsl-saturation) calc(var(--playkit-danger-hsl-lightness) + 15%)\n  );\n  --playkit-danger-text-contrast-color: #ffffff;\n  --playkit-warning-color: hsl(var(--playkit-warning-hsl-hue) var(--playkit-warning-hsl-saturation) var(--playkit-warning-hsl-lightness));\n  --playkit-warning-darker-color: hsl(\n    var(--playkit-warning-hsl-hue) var(--playkit-warning-hsl-saturation) calc(var(--playkit-warning-hsl-lightness) - 15%)\n  );\n  --playkit-warning-brighter-color: hsl(\n    var(--playkit-warning-hsl-hue) var(--playkit-warning-hsl-saturation) calc(var(--playkit-warning-hsl-lightness) + 15%)\n  );\n  --playkit-warning-text-contrast-color: #ffffff;\n  --playkit-tone-1-color: #ffffff;\n  --playkit-tone-2-color: #cccccc;\n  --playkit-tone-3-color: #999999;\n  --playkit-tone-4-color: #666666;\n  --playkit-tone-5-color: #525252;\n  --playkit-tone-6-color: #383838;\n  --playkit-tone-7-color: #212121;\n  --playkit-tone-8-color: #000000;\n  --playkit-tone-1-color-rgb: 255, 255, 255;\n  --playkit-tone-2-color-rgb: 204, 204, 204;\n  --playkit-tone-3-color-rgb: 153, 153, 153;\n  --playkit-tone-4-color-rgb: 102, 102, 102;\n  --playkit-tone-5-color-rgb: 82, 82, 82;\n  --playkit-tone-6-color-rgb: 56, 56, 56;\n  --playkit-tone-7-color-rgb: 33, 33, 33;\n  --playkit-tone-8-color-rgb: 0, 0, 0;\n  --playkit-live-color: #e12437;\n  --playkit-player-background-color: #000000;\n  --playkit-tab-focus-color: var(--playkit-primary-color);\n  --playkit-tooltip-background-color: var(--playkit-tone-1-color);\n  --playkit-tooltip-color: var(--playkit-tone-7-color);\n  --playkit-ads-color: var(--playkit-secondary-color);\n  --playkit-background-color: #121212;\n  --playkit-elevated-color: #333333;\n  --playkit-paper-color: #242424;\n  --playkit-protection-color: #222222;\n}\n\n.playkit-row {\n  display: block;\n}\n.playkit-row:after {\n  content: \"\";\n  clear: both;\n  display: block;\n}\n\n.playkit-d-inline-block {\n  display: inline-block;\n}\n\n.playkit-mobile-hidden-select {\n  display: block;\n  opacity: 0;\n  position: absolute;\n  top: 0;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n}\n\n.playkit-font-size-base, .playkit-ad-notice {\n  font-size: 15px;\n}\n\n.playkit-player .playkit-form-group {\n  margin: 10px 0;\n  position: relative;\n  max-width: 100%;\n}\n.playkit-player .playkit-form-group.playkit-has-error .playkit-form-control {\n  border-color: var(--playkit-danger-color);\n}\n.playkit-player .playkit-form-group.playkit-has-error .playkit-form-control:focus {\n  border-color: #fff;\n}\n.playkit-player .playkit-form-group.playkit-has-icon .playkit-form-control {\n  padding-left: 34px;\n}\n.playkit-player .playkit-form-group .playkit-icon {\n  position: absolute;\n  top: 2px;\n  left: 2px;\n  width: 32px;\n  height: 32px;\n  fill: rgba(255, 255, 255, 0.4);\n}\n.playkit-player .playkit-form-control {\n  height: 32px;\n  width: 100%;\n  min-width: 72px;\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  background-color: rgba(0, 0, 0, 0.4);\n  font-size: 15px;\n  line-height: 18px;\n  color: #fff;\n  padding: 8px 10px;\n  text-overflow: ellipsis;\n}\n.playkit-player .playkit-form-control::-webkit-input-placeholder {\n  color: rgba(255, 255, 255, 0.6);\n}\n.playkit-player .playkit-form-control:focus {\n  background-color: #fff;\n  border-color: #fff;\n  color: var(--playkit-tone-7-color);\n}\n.playkit-player .playkit-form-control:focus::-webkit-input-placeholder {\n  color: var(--playkit-tone-2-color);\n}\n.playkit-player .playkit-form-control:focus + .playkit-icon {\n  fill: var(--playkit-tone-3-color);\n}\n.playkit-player textarea.playkit-form-control {\n  min-height: 72px;\n}\n.playkit-player select {\n  font-size: 15px;\n  color: #fff;\n  -webkit-appearance: none;\n  border: 0;\n  background: url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23FFFFFF' viewBox='0 0 1024 1024'><path d='M301.255 338.745c-24.994-24.994-65.516-24.994-90.51 0s-24.994 65.516 0 90.51l256 256c24.994 24.994 65.516 24.994 90.51 0l256-256c24.994-24.994 24.994-65.516 0-90.51s-65.516-24.994-90.51 0l-210.745 210.745-210.745-210.745z' /></svg>\") no-repeat;\n  background-size: 16px;\n  background-position: 100% center;\n  background-repeat: no-repeat;\n  padding-right: 24px;\n}\n\n.playkit-checkbox {\n  font-size: 15px;\n  position: relative;\n}\n.playkit-checkbox input {\n  display: none;\n}\n.playkit-checkbox label:before {\n  height: 16px;\n  width: 16px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  background-color: rgba(0, 0, 0, 0.4);\n  margin-right: 8px;\n  display: inline-block;\n  content: \"\";\n  vertical-align: middle;\n}\n.playkit-checkbox input:checked + label:before {\n  content: \"\";\n  text-align: center;\n  font-size: 14px;\n}\n\n.playkit-form-group-row {\n  font-size: 15px;\n  margin: 24px 0;\n}\n.playkit-form-group-row:after {\n  clear: both;\n  content: \" \";\n  display: block;\n}\n.playkit-form-group-row label {\n  float: left;\n  color: rgba(244, 244, 244, 0.8);\n}\n.playkit-form-group-row .playkit-dropdown {\n  float: right;\n}\n\n.playkit-btn {\n  text-decoration: none;\n  height: 36px;\n  border-radius: 18px;\n  color: #fff;\n  line-height: 36px;\n  font-weight: bold;\n  cursor: pointer;\n  display: inline-block;\n  padding: 0 24px;\n}\n.playkit-btn.playkit-btn-block {\n  display: block;\n}\n.playkit-btn.playkit-btn-dark-transparent {\n  background-color: rgba(0, 0, 0, 0.5);\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  line-height: 32px;\n}\n.playkit-btn.playkit-btn-dark-transparent:hover {\n  color: #fff;\n  border: 2px solid rgba(255, 255, 255, 0.4);\n}\n.playkit-btn.playkit-btn-branded {\n  background-color: var(--playkit-primary-color);\n}\n.playkit-btn.playkit-btn-branded:hover {\n  color: #fff;\n}\n\n.playkit-btn-rounded {\n  height: 36px;\n  width: 36px;\n  min-width: 36px;\n  min-height: 36px;\n  border-radius: 18px;\n  background-color: rgba(0, 0, 0, 0.4);\n  display: inline-block;\n  padding: 2px;\n}\n\n.playkit-player button:focus {\n  outline: none;\n}\n\n.playkit-btn-borderless {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  border-radius: 4px;\n  border: none;\n  padding: 8px 12px 8px 8px;\n  width: 82px;\n  height: 40px;\n  background-color: transparent;\n  cursor: pointer;\n}\n.playkit-btn-borderless.playkit-only-icon {\n  padding: 4px;\n  width: 40px;\n  height: 40px;\n}\n.playkit-btn-borderless.playkit-only-label {\n  padding: 8px;\n  width: 50px;\n  height: 40px;\n}\n.playkit-btn-borderless i {\n  width: 32px;\n  height: 32px;\n}\n.playkit-btn-borderless label {\n  color: var(--playkit-tone-1-color);\n}\n.playkit-btn-borderless:hover {\n  background-color: var(--playkit-tone-5-color);\n}\n\n.playkit-btn-translucent {\n  background-color: rgba(0, 0, 0, 0.6);\n}\n.playkit-btn-translucent:hover {\n  background-color: rgba(0, 0, 0, 0.7);\n}\n\n.playkit-player.playkit-size-sm .playkit-btn-borderless,\n.playkit-player.playkit-size-xs .playkit-btn-borderless {\n  height: 32px;\n}\n.playkit-player.playkit-size-sm .playkit-btn-borderless i,\n.playkit-player.playkit-size-xs .playkit-btn-borderless i {\n  width: 24px;\n  height: 24px;\n}\n.playkit-player.playkit-size-sm .playkit-btn-borderless.playkit-only-icon,\n.playkit-player.playkit-size-xs .playkit-btn-borderless.playkit-only-icon {\n  padding: 4px;\n  width: 32px;\n  height: 32px;\n}\n.playkit-player.playkit-size-sm .playkit-btn-borderless.playkit-only-label,\n.playkit-player.playkit-size-xs .playkit-btn-borderless.playkit-only-label {\n  padding: 8px;\n  width: 50px;\n  height: 32px;\n}\n\n.playkit-icon {\n  display: inline-block;\n  font-size: 0;\n  width: 100%;\n  height: 100%;\n  margin: 0 auto;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n  filter: drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.7));\n}\n\n.playkit-badge-icon:after {\n  content: \"\";\n  position: absolute;\n  height: 16px;\n  width: 16px;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n}\n\n.playkit-player {\n  --playkit-icon-vr-stereo-full-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M12 16C12 17.3807 10.8807 18.5 9.5 18.5C8.11929 18.5 7 17.3807 7 16C7 14.6193 8.11929 13.5 9.5 13.5C10.8807 13.5 12 14.6193 12 16Z'/%3E%3Cpath fill='%23006bff' d='M22.5 18.5C23.8807 18.5 25 17.3807 25 16C25 14.6193 23.8807 13.5 22.5 13.5C21.1193 13.5 20 14.6193 20 16C20 17.3807 21.1193 18.5 22.5 18.5Z'/%3E%3Cpath fill='%23006bff' fill-rule='evenodd' clip-rule='evenodd' d='M27 7H5C3.34315 7 2 8.34315 2 10V22C2 23.6569 3.34315 25 5 25H11.8676C12.9214 25 13.8979 24.4471 14.4401 23.5435L16 20.9437L17.5599 23.5435C18.1021 24.4471 19.0786 25 20.1324 25H27C28.6569 25 30 23.6569 30 22V10C30 8.34315 28.6569 7 27 7ZM4 10C4 9.44772 4.44772 9 5 9H27C27.5523 9 28 9.44772 28 10V22C28 22.5523 27.5523 23 27 23H20.1324C19.7811 23 19.4556 22.8157 19.2749 22.5145L17.715 19.9147C17.1467 18.9675 15.9182 18.6604 14.971 19.2287C14.6895 19.3976 14.4539 19.6332 14.285 19.9147L12.7251 22.5145C12.5444 22.8157 12.2189 23 11.8676 23H5C4.44772 23 4 22.5523 4 22V10Z'/%3E%3C/svg%3E\");\n  --playkit-icon-chromecast-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M160 704v96h96c0-53.12-42.88-96-96-96zM160 576v64c88.32 0 160 71.68 160 160h64c0-123.84-100.16-224-224-224zM736 352h-448v52.16c126.72 40.96 226.88 141.12 267.84 267.84h180.16v-320zM160 448v64c159.040 0 288 128.96 288 288h64c0-194.56-157.76-352-352-352zM800 224h-576c-35.2 0-64 28.8-64 64v96h64v-96h576v448h-224v64h224c35.2 0 64-28.8 64-64v-448c0-35.2-28.8-64-64-64z'%3E%3C/path%3E%3C/svg%3E\");\n  --playkit-icon-quality-HD-active-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M13.9932 4C14.5492 4 15 4.45304 15 4.99703V11.003C15 11.5536 14.5501 12 13.9932 12H2.00685C1.45078 12 1 11.547 1 11.003V4.99703C1 4.44639 1.44995 4 2.00685 4H13.9932Z' fill-rule='evenodd' clip-rule='evenodd'/%3E%3Cpath fill='textColor' d='M3.74623 5H2.00684V11H3.74623L3.74602 8.56941H5.97529L5.976 11H7.70614V5H5.976L5.97529 7.32457H3.74602L3.74623 5Z'/%3E%3Cpath fill='textColor' d='M10.8565 5H8.66374V11H10.8842L11.1456 10.9922C11.5739 10.966 11.9652 10.8745 12.3197 10.7176L12.4987 10.6312L12.6935 10.52C13.0708 10.2858 13.3744 9.98155 13.6044 9.60714C13.8344 9.23273 13.9658 8.81089 13.9986 8.34161L14.0068 8.10302V7.9011L13.9986 7.66146C13.9658 7.19033 13.8344 6.76815 13.6044 6.39492C13.3361 5.95948 12.9652 5.61813 12.4918 5.37088C12.086 5.15895 11.6276 5.03784 11.1164 5.00757L10.8565 5ZM10.8565 6.24902C11.1618 6.24902 11.417 6.30946 11.6221 6.43034C11.8272 6.55122 11.9814 6.73323 12.0847 6.97636C12.1674 7.17086 12.217 7.40537 12.2335 7.67988L12.2397 7.89325V8.10342L12.2334 8.31837C12.2166 8.59485 12.1663 8.83089 12.0824 9.0265C11.9776 9.271 11.8249 9.45369 11.6244 9.57457C11.4641 9.67128 11.2741 9.7293 11.0545 9.74864L10.8843 9.75589L10.4026 9.75641V6.24977L10.8565 6.24902Z' fill-rule='evenodd' clip-rule='evenodd'/%3E%3C/svg%3E\");\n  --playkit-icon-quality-4K-active-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M13.9932 4C14.5492 4 15 4.45304 15 4.99703V11.003C15 11.5536 14.5501 12 13.9932 12H2.00685C1.45078 12 1 11.547 1 11.003V4.99703C1 4.44639 1.44995 4 2.00685 4H13.9932Z' fill-rule='evenodd' clip-rule='evenodd'/%3E%3Cpath fill='textColor' fill-rule='evenodd' clip-rule='evenodd' d='M6.52118 5H4.77854L4.77781 5.01382L2 8.80769L2.10649 9.76786L4.77781 9.76867L4.77854 11H6.52118L6.52064 9.76867L7.19403 9.76786V8.5728L6.52064 8.57363L6.52118 5ZM4.77781 7.01953V8.5741L3.65067 8.57327L4.69625 7.13921L4.77781 7.01953Z'/%3E%3Cpath fill='textColor' d='M9.81283 5H7.99274V11H9.81283L9.81198 9.5062L10.4712 8.88589L11.8314 11H13.9806L11.6857 7.663L14 5H11.7588L10.355 6.78434L9.81198 7.5229L9.81283 5Z'/%3E%3C/svg%3E\");\n  --playkit-icon-quality-8K-active-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M13.9932 4C14.5492 4 15 4.45304 15 4.99703V11.003C15 11.5536 14.5501 12 13.9932 12H2.00685C1.45078 12 1 11.547 1 11.003V4.99703C1 4.44639 1.44995 4 2.00685 4H13.9932Z' fill-rule='evenodd' clip-rule='evenodd'/%3E%3Cpath fill='textColor' d='M4.5 5C4.04427 5 3.639 5.06279 3.28418 5.18838C2.92936 5.31396 2.65104 5.49967 2.44922 5.74549C2.2474 5.99132 2.14648 6.29459 2.14648 6.65531C2.14648 6.96259 2.24821 7.23113 2.45166 7.46092C2.58729 7.61412 2.75693 7.74445 2.96056 7.85193L3.07973 7.90981L3.04818 7.92134L2.87891 8.00067C2.71615 8.08484 2.57292 8.18353 2.44922 8.29676L2.33203 8.41483L2.24394 8.52321C2.08131 8.74602 2 9.00515 2 9.3006C2 9.67735 2.10986 9.99132 2.32959 10.2425C2.54932 10.4937 2.8488 10.6827 3.22803 10.8096C3.60726 10.9365 4.03613 11 4.51465 11C4.99642 11 5.42367 10.9365 5.79639 10.8096C6.16911 10.6827 6.46289 10.4937 6.67773 10.2425C6.89258 9.99132 7 9.67735 7 9.3006C7 8.95591 6.89176 8.66065 6.67529 8.41483L6.56041 8.29676C6.39837 8.14579 6.20089 8.02065 5.96796 7.92134L5.94 7.911L6.06141 7.85193L6.20532 7.76703C6.29701 7.70758 6.3802 7.64241 6.45489 7.57153L6.56055 7.46092L6.65156 7.3428C6.78945 7.14054 6.8584 6.91138 6.8584 6.65531C6.8584 6.29459 6.7583 5.99132 6.55811 5.74549C6.35791 5.49967 6.08122 5.31396 5.72803 5.18838C5.37484 5.06279 4.9655 5 4.5 5ZM4.5 6.16211C4.63672 6.16211 4.74902 6.18549 4.83691 6.23225C4.9248 6.27901 4.99072 6.34514 5.03467 6.43065C5.07861 6.51615 5.10059 6.62036 5.10059 6.74327C5.10059 6.86351 5.08024 6.96972 5.03955 7.06191C4.99886 7.15409 4.93538 7.22624 4.84912 7.27834C4.76286 7.33045 4.65137 7.3565 4.51465 7.3565C4.37793 7.3565 4.26481 7.33045 4.17529 7.27834C4.08577 7.22624 4.01986 7.15409 3.97754 7.06191C3.93522 6.96972 3.91406 6.86351 3.91406 6.74327C3.91406 6.62036 3.93522 6.51615 3.97754 6.43065C4.01986 6.34514 4.08496 6.27901 4.17285 6.23225C4.26074 6.18549 4.36979 6.16211 4.5 6.16211ZM4.50488 8.51882C4.65462 8.51882 4.78402 8.54354 4.89307 8.59297C5.00212 8.6424 5.08675 8.71522 5.14697 8.81141C5.20719 8.9076 5.2373 9.02784 5.2373 9.17213C5.2373 9.3084 5.20801 9.42597 5.14941 9.52484C5.09082 9.6237 5.007 9.70052 4.89795 9.7553C4.7889 9.81007 4.66113 9.83746 4.51465 9.83746C4.36491 9.83746 4.23389 9.81007 4.12158 9.7553C4.00928 9.70052 3.9222 9.6237 3.86035 9.52484C3.7985 9.42597 3.76758 9.3084 3.76758 9.17213C3.76758 9.02784 3.7985 8.9076 3.86035 8.81141C3.9222 8.71522 4.00846 8.6424 4.11914 8.59297C4.22982 8.54354 4.3584 8.51882 4.50488 8.51882Z' fill-rule='evenodd' clip-rule='evenodd'/%3E%3Cpath fill='textColor' d='M9.81789 5H8V11H9.81789L9.81771 9.5062L10.4752 8.88673L11.834 11H13.9807L11.6891 7.663L14 5H11.7615L10.3594 6.78434L9.81771 7.5229L9.81789 5Z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-maximize {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M800 269.255v114.745c0 17.673 14.327 32 32 32s32-14.327 32-32v-192c0-17.673-14.327-32-32-32h-192c-17.673 0-32 14.327-32 32s14.327 32 32 32h114.745l-137.373 137.373c-12.497 12.497-12.497 32.758 0 45.255s32.758 12.497 45.255 0l137.373-137.373z' /%3E %3Cpath fill='%23fff' d='M224 754.745v-114.745c0-17.673-14.327-32-32-32s-32 14.327-32 32v192c0 17.673 14.327 32 32 32h192c17.673 0 32-14.327 32-32s-14.327-32-32-32h-114.745l137.373-137.373c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0l-137.373 137.373z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-minimize {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M672 306.745v-114.745c0-17.673-14.327-32-32-32s-32 14.327-32 32v192c0 17.673 14.327 32 32 32h192c17.673 0 32-14.327 32-32s-14.327-32-32-32h-114.745l137.373-137.373c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0l-137.373 137.373z' /%3E%3Cpath fill='%23fff' d='M352 717.255v114.745c0 17.673 14.327 32 32 32s32-14.327 32-32v-192c0-17.673-14.327-32-32-32h-192c-17.673 0-32 14.327-32 32s14.327 32 32 32h114.745l-137.373 137.373c-12.497 12.497-12.497 32.758 0 45.255s32.758 12.497 45.255 0l137.373-137.373z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-play {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M796.806 461.202c44.919 28.075 44.739 73.706 0 101.668l-459.472 287.171c-44.919 28.075-81.334 7.915-81.334-45.305v-585.4c0-53.096 36.595-73.266 81.334-45.305l459.472 287.171z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-pause {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M256 287.843c0-35.259 28.407-63.843 64-63.843 35.346 0 64 28.564 64 63.843v448.314c0 35.259-28.407 63.843-64 63.843-35.346 0-64-28.564-64-63.843v-448.314zM640 287.843c0-35.259 28.407-63.843 64-63.843 35.346 0 64 28.564 64 63.843v448.314c0 35.259-28.407 63.843-64 63.843-35.346 0-64-28.564-64-63.843v-448.314z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-stop {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='32' height='32' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M8 10.6667C8 9.19391 9.19391 8 10.6667 8H21.3333C22.8061 8 24 9.19391 24 10.6667V21.3333C24 22.8061 22.8061 24 21.3333 24H10.6667C9.19391 24 8 22.8061 8 21.3333V10.6667Z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-volume-base {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M128 416v192h96v-192h-96zM64 383.853c0-17.592 14.012-31.853 32.094-31.853h159.813c17.725 0 32.094 14.581 32.094 31.853v256.295c0 17.592-14.012 31.853-32.094 31.853h-159.813c-17.725 0-32.094-14.581-32.094-31.853v-256.295z' /%3E%3Cpath fill='%23fff' d='M288 634.342l160 88.889v-422.462l-160 88.889v244.684zM224 352l231.787-128.771c31.046-17.248 56.213-2.487 56.213 32.476v512.589c0 35.184-25.054 49.786-56.213 32.476l-231.787-128.771v-320z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-volume-waves {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M802.017 837.177c82.359-86.627 129.183-201.774 129.183-324.26 0-123.976-47.976-240.409-132.127-327.329-12.293-12.697-32.552-13.025-45.249-0.732s-13.025 32.552-0.732 45.249c72.692 75.084 114.109 175.597 114.109 282.812 0 105.928-40.422 205.331-111.566 280.162-12.177 12.808-11.666 33.063 1.143 45.24s33.063 11.666 45.24-1.143z' /%3E%3Cpath fill='%23fff' d='M667.436 743.221c67.761-60.884 107.273-147.888 107.273-241.233 0-87.318-34.552-169.203-94.836-229.446-12.501-12.493-32.762-12.486-45.255 0.015s-12.486 32.762 0.015 45.255c48.375 48.342 76.075 113.989 76.075 184.176 0 75.021-31.679 144.776-86.048 193.627-13.146 11.812-14.227 32.044-2.416 45.19s32.044 14.227 45.19 2.416z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-volume-wave {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M667.436 743.221c67.761-60.884 107.273-147.888 107.273-241.233 0-87.318-34.552-169.203-94.836-229.446-12.501-12.493-32.762-12.486-45.255 0.015s-12.486 32.762 0.015 45.255c48.375 48.342 76.075 113.989 76.075 184.176 0 75.021-31.679 144.776-86.048 193.627-13.146 11.812-14.227 32.044-2.416 45.19s32.044 14.227 45.19 2.416z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-volume-mute {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M768 466.745l-67.986-67.986c-12.213-12.213-32.654-12.393-45.151 0.104-12.584 12.584-12.543 32.711-0.104 45.151l67.986 67.986-67.986 67.986c-12.213 12.213-12.393 32.654 0.104 45.151 12.584 12.584 32.711 12.543 45.151 0.104l67.986-67.986 67.986 67.986c12.213 12.213 32.654 12.393 45.151-0.104 12.584-12.584 12.543-32.711 0.104-45.151l-67.986-67.986 67.986-67.986c12.213-12.213 12.393-32.654-0.104-45.151-12.584-12.584-32.711-12.543-45.151-0.104l-67.986 67.986z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-close {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M573.162 512l214.269-214.269c16.772-16.772 16.688-44.071-0.202-60.96-17.007-17.007-44.182-16.98-60.96-0.202l-214.269 214.269-214.269-214.269c-16.772-16.772-44.071-16.688-60.96 0.202-17.007 17.007-16.98 44.182-0.202 60.96l214.269 214.269-214.269 214.269c-16.772 16.772-16.688 44.071 0.202 60.96 17.007 17.007 44.182 16.98 60.96 0.202l214.269-214.269 214.269 214.269c16.772 16.772 44.071 16.688 60.96-0.202 17.007-17.007 16.98-44.182 0.202-60.96l-214.269-214.269z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-settings {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M803.451 546.033c2.552-22.107 2.552-44.408 0.246-64.81-1.084-6.208-6.499-10.721-12.535-10.671-30.286 0.533-57.727-17.773-68.866-45.941s-3.64-60.291 18.795-80.593c3.935-3.569 4.416-9.583 0.92-13.959-13.595-17.35-29.146-33.073-46.311-46.83-4.23-3.38-10.359-2.886-14.783 1.966-14.421 14.721-34.212 22.938-54.434 22.761-9.009 0.041-17.942-1.652-26.865-5.212-28.414-11.992-46.226-40.546-44.49-71.542 0.335-5.319-3.547-9.972-8.785-10.588-21.926-2.538-44.068-2.595-65.961-0.176-5.349 0.6-9.341 5.207-9.175 10.514 1.027 30.384-16.802 58.251-45.764 70.431-8.238 3.138-16.993 4.701-25.207 4.609-20.599 0.206-40.395-7.982-55.482-23.363-2.014-2.187-4.849-3.435-7.553-3.445-2.441 0.015-4.811 0.83-6.513 2.139-17.541 13.798-33.455 29.547-47.262 46.729-3.418 4.337-2.922 10.575 0.97 14.162 22.816 20.692 30.19 53.479 17.807 83.351-13.035 27.396-41.135 44.394-71.446 43.222-5.112-0.197-9.499 3.606-10.086 9.179-2.673 22.023-2.673 44.289-0.212 64.867 1.080 6.27 6.559 10.824 13.309 10.737l2.225 0.006c28.935 0.604 54.726 18.391 65.634 45.374 11.22 28.205 3.921 60.407-18.565 81.204-3.866 3.509-4.341 9.418-0.895 13.742 13.545 17.354 29.027 33.106 46.042 46.867 4.303 3.449 10.547 2.954 14.986-1.907 14.414-14.76 34.226-23.001 54.43-22.82 9.070-0.052 18.063 1.668 27.041 5.299 28.19 12.071 45.891 40.41 44.347 71.468-0.342 5.312 3.536 9.962 8.802 10.578 21.915 2.548 44.049 2.605 65.929 0.176 5.364-0.604 9.364-5.227 9.191-10.598-0.997-30.358 16.84-58.183 45.452-70.201 8.263-3.256 17.070-4.908 25.521-4.865 20.676-0.206 40.533 8.070 55.398 23.38 2.039 2.195 4.898 3.446 7.673 3.455 2.268-0.011 4.468-0.776 6.321-2.228 17.625-13.724 33.599-29.444 47.415-46.611 3.426-4.348 2.928-10.6-0.863-14.097-22.358-20.082-30.057-51.85-19.372-79.939s37.55-46.71 67.745-46.857h5.229c5.12-0.026 9.413-3.875 9.996-8.962zM861.733 552.735c-3.961 34.572-33.157 60.748-68.129 60.926h-5.235c-5.803 0.028-10.991 3.624-13.054 9.048s-0.577 11.558 4.020 15.69c26.602 24.519 29.853 65.381 7.275 94.034-16.847 20.934-36.063 39.845-57.197 56.302-12.034 9.427-26.861 14.584-42.368 14.658-19.254-0.051-37.623-8.090-50.269-21.718-3.221-3.315-7.66-5.165-12.712-5.118-1.425-0.007-2.839 0.258-3.554 0.532-5.581 2.346-9.136 7.892-8.937 13.966 1.152 35.958-25.509 66.771-61.307 70.804-26.332 2.923-52.909 2.854-79.246-0.208-36.286-4.245-62.897-36.157-60.576-72.186 0.304-6.123-3.235-11.788-8.302-13.964-1.328-0.536-2.748-0.808-4.606-0.8-4.651-0.041-9.118 1.817-11.635 4.367-24.544 27.036-65.886 30.311-94.481 7.394-20.587-16.65-39.207-35.595-55.308-56.226-22.552-28.277-19.261-69.208 7.317-93.334 4.474-4.138 5.939-10.604 3.748-16.115-2.052-5.076-6.932-8.442-11.794-8.55-36.436 0.464-66.759-24.741-72.949-60.89-3.243-26.718-3.243-53.731-0.055-79.964 3.744-35.827 34.642-62.605 70.642-61.219 6.877 0.266 13.251-3.59 15.584-8.401 2.309-5.59 0.861-12.028-3.789-16.247-26.603-24.51-29.856-65.368-7.293-93.994 16.767-20.868 35.856-39.76 57.129-56.491 12.099-9.322 26.921-14.42 42.463-14.513 19.308 0.059 37.717 8.166 50.145 21.684 3.263 3.322 7.737 5.172 12.994 5.126 1.471 0.015 2.933-0.245 3.363-0.39 5.601-2.359 9.165-7.93 8.957-14.077-1.126-35.941 25.542-66.721 61.322-70.731 26.322-2.909 52.889-2.84 79.251 0.212 36.244 4.265 62.828 36.125 60.546 72.343-0.339 6.047 3.159 11.654 8.186 13.782 1.381 0.55 2.855 0.829 4.726 0.823 4.663 0.040 9.142-1.819 11.615-4.312 24.439-26.99 65.656-30.312 94.137-7.557 20.721 16.607 39.456 35.549 55.655 56.225 22.667 28.35 19.38 69.439-7.531 93.846-4.33 3.918-5.776 10.112-3.628 15.542s7.438 8.96 13.543 8.854c34.999-0.298 65.076 24.766 71.337 60.925 3.065 26.552 3.065 53.368 0 79.92zM511.956 589.951c43.215-0.108 78.137-35.17 78.072-78.385 0-31.732-19.132-60.334-48.461-72.448s-63.068-5.35-85.461 17.133c-22.393 22.483-29.022 56.249-16.791 85.529s40.909 48.298 72.641 48.171zM512.146 648.617c-55.438 0.221-105.58-33.029-126.965-84.224s-9.796-110.233 29.358-149.543c39.153-39.31 98.144-51.136 149.424-29.956s84.731 71.189 84.732 126.627c0.114 75.549-60.999 136.907-136.548 137.096z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-check {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M342.481 563.894c-12.577-12.416-32.838-12.285-45.254 0.292s-12.285 32.838 0.292 45.254l118.857 117.333c13.275 13.105 34.901 12.123 46.933-2.131l297.143-352c11.4-13.505 9.694-33.694-3.811-45.094s-33.694-9.694-45.094 3.811l-274.828 325.566-94.238-93.030z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-check-active {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M342.481 563.894c-12.577-12.416-32.838-12.285-45.254 0.292s-12.285 32.838 0.292 45.254l118.857 117.333c13.275 13.105 34.901 12.123 46.933-2.131l297.143-352c11.4-13.505 9.694-33.694-3.811-45.094s-33.694-9.694-45.094 3.811l-274.828 325.566-94.238-93.030z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-language {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 800c159.058 0 288-128.942 288-288s-128.942-288-288-288c-159.058 0-288 128.942-288 288s128.942 288 288 288zM512 864c-194.404 0-352-157.596-352-352s157.596-352 352-352c194.404 0 352 157.596 352 352s-157.596 352-352 352z' /%3E%3Cpath fill='%23fff' d='M441.231 173.324c-76.632 84.62-121.231 207.208-121.231 338.676 0 134.304 46.556 259.282 126.083 343.936l46.646-43.82c-68.041-72.429-108.728-181.651-108.728-300.116 0-116.001 39.001-223.203 104.669-295.716l-47.438-42.96z' /%3E%3Cpath fill='%23fff' d='M584.297 173.324c76.632 84.62 121.231 207.208 121.231 338.676 0 134.304-46.556 259.282-126.083 343.936l-46.646-43.82c68.041-72.429 108.728-181.651 108.728-300.116 0-116.001-39.001-223.203-104.669-295.716l47.438-42.96z' /%3E%3Cpath fill='%23fff' d='M840.432 419.786c-81.65-22.637-200.551-35.786-328.432-35.786-128.056 0-247.103 13.185-328.758 35.876l17.136 61.663c75.47-20.972 188.938-33.539 311.622-33.539 122.521 0 235.854 12.533 311.334 33.459l17.099-61.674z' /%3E%3Cpath fill='%23fff' d='M840.432 605.754c-81.65 22.637-200.551 35.786-328.432 35.786-128.056 0-247.103-13.185-328.758-35.876l17.136-61.663c75.47 20.972 188.938 33.539 311.622 33.539 122.521 0 235.854-12.533 311.334-33.459l17.099 61.674z' /%3E%3Cpath fill='%23fff' d='M480 192h64v640h-64v-640z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M159.904 192h288.234c17.277 0 31.862 14.323 31.862 31.992 0 17.792-14.261 31.993-31.853 31.994l-288.147 0.014v544.174c-0.017-0.18 704-0.174 704-0.174v-128.006c0-17.795 14.327-31.994 32-31.994 17.796 0 32 14.34 32 32.029v128.145c0 35.25-28.639 63.826-63.904 63.826h-704.192c-35.293 0-63.904-28.875-63.904-63.826v-544.348c0-35.25 28.639-63.826 63.904-63.826zM501.818 378.182c108.449 0 196.364-87.915 196.364-196.364 0-29.091 43.636-29.091 43.636 0 0 108.449 87.915 196.364 196.364 196.364 29.091 0 29.091 43.636 0 43.636-108.449 0-196.364 87.915-196.364 196.364 0 29.091-43.636 29.091-43.636 0 0-108.449-87.915-196.364-196.364-196.364-29.091 0-29.091-43.636 0-43.636z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-captions {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M160 771.213c-0.017-0.172 704-0.166 704-0.166v-518.261c0.017 0.172-704 0.166-704 0.166v518.261zM96 252.787c0-33.572 28.639-60.787 63.904-60.787h704.192c35.293 0 63.904 27.5 63.904 60.787v518.427c0 33.572-28.639 60.787-63.904 60.787h-704.192c-35.293 0-63.904-27.5-63.904-60.787v-518.427z' /%3E%3Cpath fill='%23fff' d='M490.583 568.655c0 7.729-2.311 15.987-6.933 24.777s-11.668 17.162-21.14 25.118c-9.471 7.956-21.405 14.358-35.801 19.208s-30.611 7.274-48.644 7.274c-38.34 0-68.268-11.176-89.787-33.528s-32.278-52.319-32.278-89.901c0-25.459 4.925-47.962 14.775-67.511s24.095-34.665 42.734-45.348c18.639-10.684 40.916-16.025 66.829-16.025 16.063 0 30.8 2.349 44.212 7.047s24.777 10.759 34.096 18.185c9.32 7.425 16.442 15.343 21.367 23.754s7.388 16.253 7.388 23.527c0 7.425-2.766 13.714-8.297 18.867s-12.237 7.729-20.117 7.729c-5.152 0-9.433-1.326-12.843-3.978s-7.236-6.933-11.479-12.843c-7.577-11.517-15.495-20.155-23.754-25.913s-18.753-8.638-31.482-8.638c-18.336 0-33.111 7.16-44.325 21.481s-16.821 33.907-16.821 58.759c0 11.669 1.44 22.39 4.319 32.164s7.047 18.109 12.502 25.004c5.455 6.895 12.047 12.123 19.776 15.684s16.215 5.342 25.459 5.342c12.426 0 23.072-2.879 31.937-8.638s16.707-14.548 23.527-26.368c3.789-6.971 7.88-12.426 12.275-16.366s9.774-5.91 16.139-5.91c7.577 0 13.866 2.879 18.867 8.638s7.501 11.896 7.501 18.412zM767.219 568.655c0 7.729-2.311 15.987-6.933 24.777s-11.668 17.162-21.14 25.118c-9.471 7.956-21.405 14.358-35.801 19.208s-30.611 7.274-48.644 7.274c-38.34 0-68.268-11.176-89.787-33.528s-32.278-52.319-32.278-89.901c0-25.459 4.925-47.962 14.775-67.511s24.095-34.665 42.734-45.348c18.639-10.684 40.916-16.025 66.829-16.025 16.063 0 30.8 2.349 44.212 7.047s24.777 10.759 34.096 18.185c9.32 7.425 16.442 15.343 21.367 23.754s7.388 16.253 7.388 23.527c0 7.425-2.766 13.714-8.297 18.867s-12.237 7.729-20.117 7.729c-5.152 0-9.433-1.326-12.843-3.978s-7.236-6.933-11.479-12.843c-7.577-11.517-15.495-20.155-23.754-25.913s-18.753-8.638-31.482-8.638c-18.336 0-33.111 7.16-44.325 21.481s-16.821 33.907-16.821 58.759c0 11.669 1.44 22.39 4.319 32.164s7.047 18.109 12.502 25.004c5.455 6.895 12.047 12.123 19.776 15.684s16.215 5.342 25.459 5.342c12.426 0 23.072-2.879 31.937-8.638s16.707-14.548 23.527-26.368c3.789-6.971 7.88-12.426 12.275-16.366s9.774-5.91 16.139-5.91c7.577 0 13.866 2.879 18.867 8.638s7.501 11.896 7.501 18.412z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-speed {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 832c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM480.239 643.971c-0.158-1.272-0.239-2.566-0.239-3.876v-192.19c0-17.621 14.204-31.905 32-31.905 17.673 0 32 14.497 32 31.905v192.19c0 1.313-0.079 2.607-0.232 3.878 55.325 14.128 96.232 64.301 96.232 124.027 0 70.692-57.308 128-128 128s-128-57.308-128-128c0-59.729 40.91-109.903 96.239-124.029zM928 576c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-194.404-157.596-352-352-352s-352 157.596-352 352c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-229.75 186.25-416 416-416s416 186.25 416 416z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-speed-down {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM401.852 670.758c-1.056-0.826-2.077-1.728-3.055-2.706l-113.005-113.005c-12.533-12.533-12.65-32.737-0.066-45.321 12.497-12.497 32.536-12.719 45.321 0.066l113.005 113.005c0.976 0.976 1.876 1.998 2.701 3.059 19.106-11.343 41.416-17.855 65.248-17.855 70.692 0 128 57.308 128 128s-57.308 128-128 128c-70.692 0-128-57.308-128-128 0-23.829 6.511-46.137 17.852-65.242zM928 576c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-194.404-157.596-352-352-352s-352 157.596-352 352c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-229.75 186.25-416 416-416s416 186.25 416 416z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-speed-up {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM546.516 612.708c0.524-1.23 1.129-2.446 1.819-3.64l79.906-138.402c8.862-15.35 28.348-20.692 43.76-11.794 15.305 8.837 20.707 28.135 11.666 43.794l-79.906 138.402c-0.693 1.201-1.451 2.34-2.268 3.416 23.761 23.238 38.508 55.655 38.508 91.516 0 70.692-57.308 128-128 128s-128-57.308-128-128c0-70.692 57.308-128 128-128 11.959 0 23.535 1.64 34.516 4.708zM928 576c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-194.404-157.596-352-352-352s-352 157.596-352 352c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-229.75 186.25-416 416-416s416 186.25 416 416z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-audio {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M768 625.124v-354.531l-352 135.385v330.022c0 70.692-57.308 128-128 128s-128-57.308-128-128c0-70.692 57.308-128 128-128 23.314 0 45.173 6.233 64 17.124v-241.124c0-13.241 8.155-25.114 20.513-29.867l416-160c20.96-8.062 43.487 7.41 43.487 29.867v512c0 70.692-57.308 128-128 128s-128-57.308-128-128c0-70.692 57.308-128 128-128 23.314 0 45.173 6.233 64 17.124zM288 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM704 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-arrow-down {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M301.255 338.745c-24.994-24.994-65.516-24.994-90.51 0s-24.994 65.516 0 90.51l256 256c24.994 24.994 65.516 24.994 90.51 0l256-256c24.994-24.994 24.994-65.516 0-90.51s-65.516-24.994-90.51 0l-210.745 210.745-210.745-210.745z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-start-over {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M255.271 339.053c94.182-126.513 270.298-165.203 410.222-84.418 150.758 87.040 202.411 279.813 115.371 430.571s-279.813 202.411-430.571 115.371c-61.424-35.463-107.948-89.4-134.169-153.673-7.677-18.818-29.156-27.85-47.974-20.173s-27.85 29.156-20.173 47.974c32.339 79.269 89.818 145.906 165.517 189.611 185.96 107.364 423.747 43.649 531.111-142.311s43.649-423.747-142.311-531.111c-172.433-99.554-389.428-52.014-505.682 103.69l-27.226-78.49c-6.66-19.202-27.626-29.368-46.828-22.708s-29.368 27.626-22.708 46.828l52.434 151.164c5.36 15.452 20.275 25.513 36.61 24.694l159.799-8.011c20.299-1.018 35.929-18.298 34.911-38.596s-18.298-35.929-38.596-34.911l-89.738 4.499z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-seek-end {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M742.494 323.053c-94.182-126.513-270.298-165.203-410.222-84.418-150.758 87.040-202.411 279.813-115.371 430.571s279.813 202.411 430.571 115.371c61.424-35.463 107.948-89.4 134.169-153.673 7.677-18.818 29.156-27.85 47.974-20.173s27.85 29.156 20.173 47.974c-32.339 79.269-89.818 145.906-165.517 189.611-185.96 107.364-423.747 43.649-531.111-142.311s-43.649-423.747 142.311-531.111c172.433-99.554 389.428-52.014 505.682 103.69l27.226-78.49c6.66-19.202 27.626-29.368 46.828-22.708s29.368 27.626 22.708 46.828l-52.434 151.164c-5.36 15.452-20.275 25.513-36.61 24.694l-159.799-8.011c-20.299-1.018-35.929-18.298-34.911-38.596s18.298-35.929 38.596-34.911l89.738 4.499z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-rewind {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' opacity='0.5' d='M258.471 323.053c94.182-126.513 270.298-165.203 410.222-84.418 150.758 87.040 202.411 279.813 115.371 430.571s-279.813 202.411-430.571 115.371c-61.424-35.463-107.948-89.4-134.169-153.673-7.677-18.818-29.156-27.85-47.974-20.173s-27.85 29.156-20.173 47.974c32.339 79.269 89.818 145.906 165.517 189.611 185.96 107.364 423.747 43.649 531.111-142.311s43.649-423.747-142.311-531.111c-172.433-99.554-389.428-52.014-505.682 103.69l-27.226-78.49c-6.66-19.202-27.626-29.368-46.828-22.708s-29.368 27.626-22.708 46.828l52.434 151.164c5.36 15.452 20.275 25.513 36.61 24.694l159.799-8.011c20.299-1.018 35.929-18.298 34.911-38.596s-18.298-35.929-38.596-34.911l-89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M816.068 431.974c-20.553-78.699-71.369-149.456-147.375-193.338-139.923-80.785-316.040-42.095-410.222 84.418l89.738-4.499c20.299-1.018 37.579 14.613 38.596 34.911s-14.613 37.579-34.911 38.596l-159.799 8.011c-16.335 0.819-31.25-9.242-36.61-24.694l-52.434-151.164c-6.66-19.202 3.506-40.167 22.708-46.828s40.167 3.506 46.828 22.708l27.226 78.49c116.254-155.703 333.248-203.244 505.682-103.69 91.184 52.645 152.976 136.648 179.618 230.523l-69.044 26.555z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-rewind-10 {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M258.471 323.053c94.182-126.513 270.298-165.203 410.222-84.418 150.758 87.040 202.411 279.813 115.371 430.571s-279.813 202.411-430.571 115.371c-61.424-35.463-107.948-89.4-134.169-153.673-7.677-18.818-29.156-27.85-47.974-20.173s-27.85 29.156-20.173 47.974c32.339 79.269 89.818 145.906 165.517 189.611 185.96 107.364 423.747 43.649 531.111-142.311s43.649-423.747-142.311-531.111c-172.433-99.554-389.428-52.014-505.682 103.69l-27.226-78.49c-6.66-19.202-27.626-29.368-46.828-22.708s-29.368 27.626-22.708 46.828l52.434 151.164c5.36 15.452 20.275 25.513 36.61 24.694l159.799-8.011c20.299-1.018 35.929-18.298 34.911-38.596s-18.298-35.929-38.596-34.911l-89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M413.327 636.083h67.358v-252.083h-48.527c-2.173 7.358-4.949 13.589-8.329 18.693s-7.726 9.139-13.037 12.106c-5.311 2.967-11.709 5.103-19.193 6.409s-16.417 1.958-26.798 1.958v41.302h48.527v171.616zM596.807 554.192c0 17.803 1.569 29.849 4.708 36.139s8.208 9.435 15.21 9.435c7.001 0 12.071-3.145 15.21-9.435s4.708-18.336 4.708-36.139v-83.316c0-17.803-1.569-29.849-4.708-36.139s-8.208-9.435-15.21-9.435c-7.001 0-12.071 3.145-15.21 9.435s-4.708 18.336-4.708 36.139v83.316zM529.449 512.534c0-25.398 1.75-46.405 5.251-63.021s8.812-29.789 15.934-39.522c7.122-9.732 16.176-16.497 27.16-20.295s23.962-5.697 38.93-5.697c14.969 0 27.945 1.899 38.93 5.697s20.038 10.563 27.16 20.295c7.122 9.732 12.433 22.906 15.934 39.522s5.251 37.622 5.251 63.021c0 25.636-1.75 46.702-5.251 63.199s-8.812 29.552-15.934 39.166c-7.122 9.613-16.176 16.2-27.16 19.761s-23.962 5.341-38.93 5.341c-14.969 0-27.945-1.78-38.93-5.341s-20.038-10.147-27.16-19.761c-7.122-9.613-12.433-22.668-15.934-39.166s-5.251-37.563-5.251-63.199z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-forward {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' opacity='0.5' d='M765.529 323.053c-94.182-126.513-270.298-165.203-410.222-84.418-150.758 87.040-202.411 279.813-115.371 430.571s279.813 202.411 430.571 115.371c61.424-35.463 107.948-89.4 134.169-153.673 7.677-18.818 29.156-27.85 47.974-20.173s27.85 29.156 20.173 47.974c-32.339 79.269-89.818 145.906-165.517 189.611-185.96 107.364-423.747 43.649-531.111-142.311s-43.649-423.747 142.311-531.111c172.433-99.554 389.428-52.014 505.682 103.69l27.226-78.49c6.66-19.202 27.626-29.368 46.828-22.708s29.368 27.626 22.708 46.828l-52.434 151.164c-5.36 15.452-20.275 25.513-36.61 24.694l-159.799-8.011c-20.299-1.018-35.929-18.298-34.911-38.596s18.298-35.929 38.596-34.911l89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M207.932 431.974c20.553-78.699 71.369-149.456 147.375-193.338 139.923-80.785 316.040-42.095 410.222 84.418l-89.738-4.499c-20.299-1.018-37.579 14.613-38.596 34.911s14.613 37.579 34.911 38.596l159.799 8.011c16.335 0.819 31.25-9.242 36.61-24.694l52.434-151.164c6.66-19.202-3.506-40.167-22.708-46.828s-40.167 3.506-46.828 22.708l-27.226 78.49c-116.254-155.703-333.248-203.244-505.682-103.69-91.184 52.645-152.976 136.648-179.618 230.523l69.044 26.555z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-forward-10 {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M765.529 323.053c-94.182-126.513-270.298-165.203-410.222-84.418-150.758 87.040-202.411 279.813-115.371 430.571s279.813 202.411 430.571 115.371c61.424-35.463 107.948-89.4 134.169-153.673 7.677-18.818 29.156-27.85 47.974-20.173s27.85 29.156 20.173 47.974c-32.339 79.269-89.818 145.906-165.517 189.611-185.96 107.364-423.747 43.649-531.111-142.311s-43.649-423.747 142.311-531.111c172.433-99.554 389.428-52.014 505.682 103.69l27.226-78.49c6.66-19.202 27.626-29.368 46.828-22.708s29.368 27.626 22.708 46.828l-52.434 151.164c-5.36 15.452-20.275 25.513-36.61 24.694l-159.799-8.011c-20.299-1.018-35.929-18.298-34.911-38.596s18.298-35.929 38.596-34.911l89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M365.327 636.083h67.358v-252.083h-48.527c-2.173 7.358-4.949 13.589-8.329 18.693s-7.726 9.139-13.037 12.106c-5.311 2.967-11.709 5.103-19.193 6.409s-16.417 1.958-26.798 1.958v41.302h48.527v171.616zM548.807 554.192c0 17.803 1.569 29.849 4.708 36.139s8.208 9.435 15.21 9.435c7.001 0 12.071-3.145 15.21-9.435s4.708-18.336 4.708-36.139v-83.316c0-17.803-1.569-29.849-4.708-36.139s-8.208-9.435-15.21-9.435c-7.001 0-12.071 3.145-15.21 9.435s-4.708 18.336-4.708 36.139v83.316zM481.449 512.534c0-25.398 1.75-46.405 5.251-63.021s8.812-29.789 15.934-39.522c7.122-9.732 16.176-16.497 27.16-20.295s23.962-5.697 38.93-5.697c14.969 0 27.945 1.899 38.93 5.697s20.038 10.563 27.16 20.295c7.122 9.732 12.433 22.906 15.934 39.522s5.251 37.622 5.251 63.021c0 25.636-1.75 46.702-5.251 63.199s-8.812 29.552-15.934 39.166c-7.122 9.613-16.176 16.2-27.16 19.761s-23.962 5.341-38.93 5.341c-14.969 0-27.945-1.78-38.93-5.341s-20.038-10.147-27.16-19.761c-7.122-9.613-12.433-22.668-15.934-39.166s-5.251-37.563-5.251-63.199z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-vr-stereo {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='32' height='32' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M25 16C25 17.3807 23.8807 18.5 22.5 18.5C21.1193 18.5 20 17.3807 20 16C20 14.6193 21.1193 13.5 22.5 13.5C23.8807 13.5 25 14.6193 25 16Z'/%3E%3Cpath fill='%23fff' fill-rule='evenodd' clip-rule='evenodd' d='M29.6097 6.79267C30.0475 6.45594 30.1293 5.82809 29.7926 5.39034C29.4559 4.95258 28.828 4.87069 28.3903 5.20743L2.39028 25.2074C1.95252 25.5442 1.87063 26.172 2.20736 26.6098C2.5441 27.0475 3.17195 27.1294 3.6097 26.7927L5.94017 25H11.8676C12.9214 25 13.8979 24.4471 14.4401 23.5435L16 20.9437L17.5599 23.5435C18.1021 24.4471 19.0786 25 20.1324 25H27C28.6569 25 30 23.6569 30 22V10C30 8.96373 29.4746 8.05017 28.6756 7.5112L29.6097 6.79267ZM26.7402 9L8.54017 23H11.8676C12.2189 23 12.5444 22.8157 12.7251 22.5145L14.285 19.9147C14.4539 19.6332 14.6895 19.3976 14.971 19.2287C15.9182 18.6604 17.1467 18.9675 17.715 19.9147L19.2749 22.5145C19.4556 22.8157 19.7811 23 20.1324 23H27C27.5523 23 28 22.5523 28 22V10C28 9.44772 27.5523 9 27 9H26.7402Z'/%3E%3Cpath fill='%23fff' d='M5 7H22.7795L20.1795 9H5C4.44772 9 4 9.44772 4 10V21.4458L2.13197 22.8827C2.04618 22.6036 2 22.3072 2 22V10C2 8.34315 3.34315 7 5 7Z'/%3E%3Cpath fill='%23fff' d='M11.9163 15.3563C11.6324 14.2875 10.6582 13.5 9.5 13.5C8.11929 13.5 7 14.6193 7 16C7 16.9287 7.50642 17.7392 8.25819 18.1703L11.9163 15.3563Z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-vr-stereo-full {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='32' height='32' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M12 16C12 17.3807 10.8807 18.5 9.5 18.5C8.11929 18.5 7 17.3807 7 16C7 14.6193 8.11929 13.5 9.5 13.5C10.8807 13.5 12 14.6193 12 16Z'/%3E%3Cpath fill='%23fff' d='M22.5 18.5C23.8807 18.5 25 17.3807 25 16C25 14.6193 23.8807 13.5 22.5 13.5C21.1193 13.5 20 14.6193 20 16C20 17.3807 21.1193 18.5 22.5 18.5Z'/%3E%3Cpath fill='%23fff' fill-rule='evenodd' clip-rule='evenodd' d='M27 7H5C3.34315 7 2 8.34315 2 10V22C2 23.6569 3.34315 25 5 25H11.8676C12.9214 25 13.8979 24.4471 14.4401 23.5435L16 20.9437L17.5599 23.5435C18.1021 24.4471 19.0786 25 20.1324 25H27C28.6569 25 30 23.6569 30 22V10C30 8.34315 28.6569 7 27 7ZM4 10C4 9.44772 4.44772 9 5 9H27C27.5523 9 28 9.44772 28 10V22C28 22.5523 27.5523 23 27 23H20.1324C19.7811 23 19.4556 22.8157 19.2749 22.5145L17.715 19.9147C17.1467 18.9675 15.9182 18.6604 14.971 19.2287C14.6895 19.3976 14.4539 19.6332 14.285 19.9147L12.7251 22.5145C12.5444 22.8157 12.2189 23 11.8676 23H5C4.44772 23 4 22.5523 4 22V10Z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-chromecast {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M160 704v96h96c0-53.12-42.88-96-96-96zM160 576v64c88.32 0 160 71.68 160 160h64c0-123.84-100.16-224-224-224zM736 352h-448v52.16c126.72 40.96 226.88 141.12 267.84 267.84h180.16v-320zM160 448v64c159.040 0 288 128.96 288 288h64c0-194.56-157.76-352-352-352zM800 224h-576c-35.2 0-64 28.8-64 64v96h64v-96h576v448h-224v64h224c35.2 0 64-28.8 64-64v-448c0-35.2-28.8-64-64-64z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-chromecast-brand {\n  background-image: var(--playkit-icon-chromecast-url);\n}\n\n.playkit-icon-next {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M640 549.333l-264.982 154.573c-30.386 17.725-55.018 3.388-55.018-32.094v-319.625c0-35.45 24.605-49.835 55.018-32.094l264.982 154.573v-154.448c0-17.794 14.204-32.219 32-32.219 17.673 0 32 14.398 32 32.219v383.562c0 17.794-14.204 32.219-32 32.219-17.673 0-32-14.398-32-32.219v-154.448z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-prev {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M384 549.333l264.982 154.573c30.386 17.725 55.018 3.388 55.018-32.094v-319.625c0-35.45-24.605-49.835-55.018-32.094l-264.982 154.573v-154.448c0-17.794-14.204-32.219-32-32.219-17.673 0-32 14.398-32 32.219v383.562c0 17.794 14.204 32.219 32 32.219 17.673 0 32-14.398 32-32.219v-154.448z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-picture-in-picture-start {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M224 256c-17.673 0-32 14.327-32 32v448c0 17.673 14.327 32 32 32h576c17.673 0 32-14.327 32-32v-448c0-17.673-14.327-32-32-32h-576zM224 192h576c53.019 0 96 42.981 96 96v448c0 53.019-42.981 96-96 96h-576c-53.019 0-96-42.981-96-96v-448c0-53.019 42.981-96 96-96z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M544 512h192c17.673 0 32 14.327 32 32v128c0 17.673-14.327 32-32 32h-192c-17.673 0-32-14.327-32-32v-128c0-17.673 14.327-32 32-32z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-picture-in-picture-stop {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M800 192c51.126 0 92.917 39.965 95.837 90.359l0.163 5.641v448c0 51.126-39.965 92.917-90.359 95.837l-5.641 0.163h-576c-51.126 0-92.917-39.965-95.837-90.359l-0.163-5.641v-64c0-17.673 14.327-32 32-32 16.411 0 29.936 12.353 31.785 28.268l0.215 3.732v64c0 16.411 12.353 29.936 28.268 31.785l3.732 0.215h576c16.411 0 29.936-12.353 31.785-28.268l0.215-3.732v-448c0-16.411-12.353-29.936-28.268-31.785l-3.732-0.215h-192c-17.673 0-32-14.327-32-32 0-16.411 12.353-29.936 28.268-31.785l3.732-0.215h192z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M416 192c17.673 0 32 14.327 32 32 0 16.411-12.353 29.936-28.268 31.785l-3.732 0.215-178.752-0.032 202.711 202.736c12.497 12.497 12.497 32.758 0 45.255-11.535 11.535-29.687 12.423-42.24 2.662l-3.015-2.662-202.704-202.679v178.72c0 16.411-12.353 29.936-28.268 31.785l-3.732 0.215c-16.411 0-29.936-12.353-31.785-28.268l-0.215-3.732v-256l0.005-0.588c0.014-0.757 0.054-1.514 0.122-2.268l-0.127 2.856c0-1.62 0.12-3.212 0.353-4.767 0.083-0.544 0.182-1.101 0.295-1.656 0.141-0.705 0.307-1.399 0.495-2.084 0.14-0.5 0.288-0.992 0.449-1.482 0.204-0.629 0.434-1.262 0.684-1.885 0.227-0.568 0.466-1.121 0.722-1.669 0.311-0.661 0.644-1.314 0.998-1.954 0.212-0.388 0.439-0.779 0.676-1.166 0.503-0.818 1.040-1.614 1.61-2.382 0.174-0.238 0.351-0.47 0.532-0.7 1.588-2.021 3.42-3.854 5.45-5.446l-2.891 2.563c1.133-1.133 2.329-2.163 3.578-3.090 0.774-0.571 1.569-1.108 2.389-1.609 0.386-0.239 0.777-0.466 1.171-0.685 0.633-0.348 1.285-0.681 1.951-0.993 0.544-0.255 1.098-0.495 1.656-0.718 0.632-0.253 1.265-0.483 1.907-0.694 0.476-0.154 0.969-0.302 1.464-0.438 0.69-0.192 1.384-0.359 2.086-0.502 0.557-0.111 1.115-0.209 1.674-0.293 0.327-0.051 0.672-0.097 1.019-0.137l0.876-0.088c0.755-0.067 1.511-0.108 2.268-0.122l0.588-0.005h256z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-advanced-audio-description {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='32' height='32' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M24.5517 12.666H23.6342C24.67 13.5857 25.2672 14.8454 25.2672 16.1541C25.2672 17.3159 24.7998 18.4262 23.9718 19.3072H24.8517C25.5874 18.403 26 17.2953 26 16.1541C26 14.8686 25.4749 13.6321 24.5517 12.666Z'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M29.6097 6.79267C30.0475 6.45594 30.1293 5.82809 29.7926 5.39034C29.4559 4.95258 28.828 4.87069 28.3903 5.20743L2.39028 25.2074C1.95252 25.5442 1.87063 26.172 2.20736 26.6098C2.5441 27.0475 3.17195 27.1294 3.6097 26.7927L4.67285 25.9749C4.77836 25.9914 4.88663 26 4.997 26H27.003C28.105 26 29 25.1495 29 24.1004V7.89958C29 7.70242 28.9679 7.51176 28.9083 7.33221L29.6097 6.79267ZM27 8.80013L21.9744 12.666H22.6752C23.5984 13.6321 24.1235 14.8686 24.1235 16.1541C24.1235 17.2953 23.7109 18.403 22.9695 19.3072H22.0953C22.9233 18.4262 23.3907 17.3159 23.3907 16.1541C23.3907 14.8877 22.8315 13.6673 21.8569 12.7564L21.2576 13.2174C21.8933 14.0825 22.2412 15.1019 22.2412 16.1541C22.2412 17.2953 21.8344 18.403 21.093 19.3072H20.2188C21.041 18.4262 21.5084 17.3159 21.5084 16.1541C21.5084 15.2579 21.2311 14.3848 20.7237 13.628L19.7255 14.3959C20.0176 14.8723 20.1836 15.42 20.1836 16.0032C20.1836 17.8374 18.5103 19.3289 16.4532 19.3289V19.3315H14.1654V18.6729L13.3945 19.2659V19.3327H13.3077L7.1129 24.0979C12.6219 24.0951 27 24.0952 27 24.0952V8.80013ZM15.732 17.4679V17.7781H16.2513C17.3505 17.7781 18.2362 16.9821 18.2362 16.0032C18.2362 15.859 18.2169 15.7188 18.1804 15.5844L15.732 17.4679Z' fill='%23fff'/%3E%3Cpath fill='%23fff' d='M4.997 6H24.0795L21.6053 7.90324C15.0918 7.90485 5 7.90476 5 7.90476V20.6766L3 22.215V7.89958C3 6.85047 3.89498 6 4.997 6Z'/%3E%3Cpath fill='%23fff' d='M14.1654 12.6723H15.4055L14.1654 13.6263V12.6723Z'/%3E%3Cpath fill='%23fff' d='M13.3945 12.6709V14.2193L11.7717 15.4676V14.678L10.4942 16.4502L6.74704 19.3327H6L11.3547 12.6709H13.3945Z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-advanced-audio-description-active {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='32' height='32' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M24.5517 12.666H23.6342C24.67 13.5857 25.2672 14.8454 25.2672 16.1541C25.2672 17.3159 24.7998 18.4262 23.9718 19.3072H24.8517C25.5874 18.403 26 17.2953 26 16.1541C26 14.8686 25.4749 13.6321 24.5517 12.666Z'/%3E%3Cpath fill='%23fff' fill-rule='evenodd' clip-rule='evenodd' d='M13.3945 19.3327H11.7615V18.4517H9.02645L8.3975 19.3327H6L11.3547 12.6709H13.3945V19.3327ZM10.0522 17.0635H11.7717V14.678L10.0522 17.0635Z'/%3E%3Cpath fill='%23fff' fill-rule='evenodd' clip-rule='evenodd' d='M20.1836 16.0032C20.1836 17.8374 18.5103 19.3289 16.4532 19.3289V19.3315H14.1654V12.6723H16.4705C18.5276 12.6723 20.1836 14.1613 20.1836 16.0032ZM16.2513 14.2308C17.3505 14.2308 18.2362 15.0268 18.2362 16.0032C18.2362 16.9821 17.3505 17.7781 16.2513 17.7781H15.732V14.2308H16.2513Z'/%3E%3Cpath fill='%23fff' d='M21.7577 12.666H22.6752C23.5984 13.6321 24.1235 14.8686 24.1235 16.1541C24.1235 17.2953 23.7109 18.403 22.9695 19.3072H22.0953C22.9233 18.4262 23.3907 17.3159 23.3907 16.1541C23.3907 14.8454 22.7935 13.5857 21.7577 12.666Z'/%3E%3Cpath fill='%23fff' d='M20.7929 12.666H19.8812C20.917 13.5857 21.5084 14.8454 21.5084 16.1541C21.5084 17.3159 21.041 18.4262 20.2188 19.3072H21.093C21.8344 18.403 22.2412 17.2953 22.2412 16.1541C22.2412 14.8686 21.7219 13.6321 20.7929 12.666Z'/%3E%3Cpath fill='%23fff' fill-rule='evenodd' clip-rule='evenodd' d='M4.997 6C3.89498 6 3 6.85047 3 7.89958V24.1004C3 25.1406 3.89409 26 4.997 26H27.003C28.105 26 29 25.1495 29 24.1004V7.89958C29 6.85938 28.1059 6 27.003 6H4.997ZM27 24.0952C27 24.0952 4.99946 24.0951 5 24.1004V7.90476C5 7.90476 27.0005 7.90495 27 7.89958V24.0952Z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality-hd:after {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M3.73939861,5 L2,5 L2,11 L3.73939861,11 L3.73918396,8.56940659 L5.96845644,8.56940659 L5.9691596,11 L7.69930609,11 L7.69930609,5 L5.9691596,5 L5.96845644,7.32457143 L3.73918396,7.32457143 L3.73939861,5 Z M10.849653,5 L8.65690054,5 L8.65690054,11 L10.8774094,11 L11.1387878,10.9921562 C11.5670397,10.9660102 11.9583976,10.8744992 12.3128614,10.7176232 L12.3128614,10.7176232 L12.4919044,10.6311813 L12.686671,10.5199596 C13.0639309,10.2858264 13.3675515,9.98155416 13.5975328,9.60714286 C13.827514,9.23273155 13.9589319,8.81088809 13.9917864,8.34161247 L13.9917864,8.34161247 L14,8.10302198 L14,7.9010989 L13.9917864,7.66145717 C13.9589319,7.19033135 13.827514,6.76815149 13.5975328,6.39491758 C13.3292213,5.95947802 12.9583655,5.61813187 12.4849653,5.37087912 C12.0791937,5.15894819 11.6207417,5.03784481 11.1096093,5.00756896 L11.1096093,5.00756896 L10.849653,5 Z M10.849653,6.24862637 C11.154973,6.24862637 11.4101773,6.30906593 11.615266,6.42994505 C11.8203547,6.55082418 11.9745567,6.73282967 12.077872,6.97596154 C12.1605243,7.17046703 12.2101157,7.40497253 12.2266461,7.67947802 L12.2266461,7.67947802 L12.232845,7.89285714 L12.232845,8.10302198 L12.2265536,8.31796703 C12.2097764,8.59445055 12.1594449,8.83049451 12.075559,9.0260989 C11.9707016,9.2706044 11.8180416,9.4532967 11.617579,9.57417582 C11.4572089,9.67087912 11.2672321,9.7289011 11.0476484,9.74824176 L11.0476484,9.74824176 L10.8774094,9.75549451 L10.3957366,9.75600879 L10.3957366,6.24937143 Z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality-hd-active:after {\n  background-image: var(--playkit-icon-quality-HD-active-url);\n}\n\n.playkit-icon-quality-4k:after {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M6.52117789,5 L4.77853973,5 L4.7778117,5.01381978 L2,8.80769231 L2.10649455,9.76785714 L4.7778117,9.76866813 L4.77853973,11 L6.52117789,11 L6.52063574,9.76866813 L7.19402985,9.76785714 L7.19402985,8.5728022 L6.52063574,8.57362637 L6.52117789,5 Z M9.81282775,5 L7.99273901,5 L7.99273901,11 L9.81282775,11 L9.8119758,9.5061978 L10.4712352,8.88589011 L11.8313836,11 L13.9806374,11 L11.6856603,7.6629978 L14,5 L11.7587737,5 L10.3549818,6.78434066 L9.8119758,7.5229011 L9.81282775,5 Z M4.7778117,7.01905934 L4.7778117,8.57362637 L3.65066559,8.5728022 L4.69624849,7.13873626 L4.7778117,7.01905934 Z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality-4k-active:after {\n  background-image: var(--playkit-icon-quality-4K-active-url);\n}\n\n.playkit-icon-quality-8k:after {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M4.5,5 C4.04427083,5 3.6389974,5.06279225 3.28417969,5.18837675 C2.92936198,5.31396126 2.65104167,5.499666 2.44921875,5.74549098 C2.24739583,5.99131597 2.14648438,6.29458918 2.14648438,6.65531062 C2.14648438,6.96259185 2.24820964,7.23112892 2.45166016,7.46092184 C2.58729384,7.61411712 2.75692636,7.74445187 2.96055773,7.85192607 L2.96055773,7.85192607 L3.07972656,7.90981323 L3.04817708,7.92134269 L2.87890625,8.000668 C2.71614583,8.08483634 2.57291667,8.18353373 2.44921875,8.29676019 L2.44921875,8.29676019 L2.33203125,8.41482966 L2.24394133,8.52320968 C2.08131378,8.74602266 2,9.00515316 2,9.3006012 C2,9.67735471 2.10986328,9.99131597 2.32958984,10.242485 C2.54931641,10.493654 2.84879557,10.6826987 3.22802734,10.8096192 C3.60725911,10.9365397 4.03613281,11 4.51464844,11 C4.99641927,11 5.42366536,10.9365397 5.79638672,10.8096192 C6.16910807,10.6826987 6.46289063,10.493654 6.67773438,10.242485 C6.89257813,9.99131597 7,9.67735471 7,9.3006012 C7,8.95591182 6.89176432,8.66065464 6.67529297,8.41482966 L6.67529297,8.41482966 L6.56041124,8.29676019 C6.3983742,8.14579158 6.20089157,8.02065242 5.96796332,7.92134269 L5.96796332,7.92134269 L5.94,7.911 L6.06141493,7.85192607 L6.20532227,7.76703407 C6.29701063,7.70758183 6.38019929,7.64241446 6.45488824,7.57153195 L6.45488824,7.57153195 L6.56054688,7.46092184 L6.65155707,7.3427967 C6.78945132,7.14054034 6.85839844,6.91137831 6.85839844,6.65531062 C6.85839844,6.29458918 6.75830078,5.99131597 6.55810547,5.74549098 C6.35791016,5.499666 6.08121745,5.31396126 5.72802734,5.18837675 C5.37483724,5.06279225 4.96549479,5 4.5,5 Z M9.8178888,5 L8,5 L8,11 L9.8178888,11 L9.81771088,9.5061978 L10.4751832,8.88673407 L11.8340048,11 L13.9806608,11 L11.6891307,7.6629978 L14,5 L11.7614827,5 L10.3593876,6.78434066 L9.81771088,7.5229011 L9.8178888,5 Z M4.50488281,8.51903808 C4.6546224,8.51903808 4.78401693,8.54375418 4.89306641,8.59318637 C5.00211589,8.64261857 5.0867513,8.71543086 5.14697266,8.81162325 C5.20719401,8.90781563 5.23730469,9.02805611 5.23730469,9.17234469 C5.23730469,9.30861723 5.20800781,9.4261857 5.14941406,9.5250501 C5.09082031,9.6239145 5.0069987,9.7007348 4.89794922,9.75551102 C4.78889974,9.81028724 4.66113281,9.83767535 4.51464844,9.83767535 C4.36490885,9.83767535 4.23388672,9.81028724 4.12158203,9.75551102 C4.00927734,9.7007348 3.92220052,9.6239145 3.86035156,9.5250501 C3.7985026,9.4261857 3.76757812,9.30861723 3.76757812,9.17234469 C3.76757812,9.02805611 3.7985026,8.90781563 3.86035156,8.81162325 C3.92220052,8.71543086 4.00846354,8.64261857 4.11914062,8.59318637 C4.22981771,8.54375418 4.35839844,8.51903808 4.50488281,8.51903808 Z M4.5,6.16232465 C4.63671875,6.16232465 4.74902344,6.18570474 4.83691406,6.23246493 C4.92480469,6.27922512 4.99072266,6.34535738 5.03466797,6.43086172 C5.07861328,6.51636607 5.10058594,6.62057448 5.10058594,6.74348697 C5.10058594,6.86372745 5.08024089,6.96993988 5.03955078,7.06212425 C4.99886068,7.15430862 4.93538411,7.22645291 4.84912109,7.27855711 C4.76285807,7.33066132 4.65136719,7.35671343 4.51464844,7.35671343 C4.37792969,7.35671343 4.2648112,7.33066132 4.17529297,7.27855711 C4.08577474,7.22645291 4.01985677,7.15430862 3.97753906,7.06212425 C3.93522135,6.96993988 3.9140625,6.86372745 3.9140625,6.74348697 C3.9140625,6.62057448 3.93522135,6.51636607 3.97753906,6.43086172 C4.01985677,6.34535738 4.08496094,6.27922512 4.17285156,6.23246493 C4.26074219,6.18570474 4.36979167,6.16232465 4.5,6.16232465 Z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality-8k-active:after {\n  background-image: var(--playkit-icon-quality-8K-active-url);\n}\n\n.playkit-icon-closed-captions-on {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M15.114 18.545c0.144-0.275 0.217-0.533 0.217-0.774 0-0.204-0.078-0.395-0.234-0.575s-0.353-0.27-0.59-0.27c-0.199 0-0.367 0.061-0.504 0.185s-0.265 0.294-0.384 0.511c-0.213 0.369-0.458 0.644-0.735 0.824s-0.61 0.27-0.998 0.27c-0.289 0-0.554-0.056-0.796-0.167s-0.447-0.275-0.618-0.49c-0.171-0.215-0.301-0.476-0.391-0.781s-0.135-0.64-0.135-1.005c0-0.777 0.175-1.389 0.526-1.836s0.812-0.671 1.385-0.671c0.398 0 0.726 0.090 0.984 0.27s0.505 0.45 0.742 0.81c0.133 0.185 0.252 0.318 0.359 0.401s0.24 0.124 0.401 0.124c0.246 0 0.456-0.081 0.629-0.242s0.259-0.357 0.259-0.59c0-0.227-0.077-0.472-0.231-0.735s-0.377-0.51-0.668-0.742c-0.291-0.232-0.646-0.421-1.066-0.568s-0.88-0.22-1.382-0.22c-0.81 0-1.506 0.167-2.088 0.501s-1.028 0.806-1.335 1.417-0.462 1.314-0.462 2.11c0 1.174 0.336 2.111 1.009 2.809s1.608 1.048 2.806 1.048c0.564 0 1.070-0.076 1.52-0.227s0.823-0.352 1.119-0.6c0.296-0.249 0.516-0.51 0.661-0.785z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M23.759 18.545c0.145-0.275 0.217-0.533 0.217-0.774 0-0.204-0.078-0.395-0.234-0.575s-0.353-0.27-0.59-0.27c-0.199 0-0.367 0.061-0.504 0.185s-0.265 0.294-0.384 0.511c-0.213 0.369-0.458 0.644-0.735 0.824s-0.61 0.27-0.998 0.27c-0.289 0-0.554-0.056-0.796-0.167s-0.448-0.275-0.618-0.49c-0.17-0.215-0.301-0.476-0.391-0.781s-0.135-0.64-0.135-1.005c0-0.777 0.175-1.389 0.526-1.836s0.812-0.671 1.385-0.671c0.398 0 0.726 0.090 0.984 0.27s0.506 0.45 0.742 0.81c0.133 0.185 0.252 0.318 0.359 0.401s0.24 0.124 0.401 0.124c0.246 0 0.456-0.081 0.629-0.242s0.259-0.357 0.259-0.59c0-0.227-0.077-0.472-0.231-0.735s-0.377-0.51-0.668-0.742c-0.291-0.232-0.646-0.421-1.066-0.568s-0.88-0.22-1.382-0.22c-0.81 0-1.506 0.167-2.088 0.501s-1.028 0.806-1.335 1.417-0.462 1.314-0.462 2.11c0 1.174 0.336 2.111 1.009 2.809s1.608 1.048 2.806 1.048c0.564 0 1.070-0.076 1.52-0.227s0.823-0.352 1.119-0.6 0.516-0.51 0.661-0.785z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M3 7.9c0-1.049 0.895-1.9 1.997-1.9h22.006c1.103 0 1.997 0.859 1.997 1.9v16.201c0 1.049-0.895 1.9-1.997 1.9h-22.006c-1.103 0-1.997-0.859-1.997-1.9v-16.201zM5 24.1c-0.001-0.005 22-0.005 22-0.005v-16.196c0 0.005-22 0.005-22 0.005v16.196z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-closed-captions-off {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M30.133 6.838l-1.143 0.863c0.007 0.065 0.011 0.131 0.011 0.198v16.201c0 1.049-0.895 1.9-1.997 1.9h-22.006c-0.080 0-0.159-0.005-0.236-0.013l-1.128 0.851c-0.463 0.349-1.121 0.257-1.471-0.206s-0.257-1.121 0.206-1.471l26.5-20c0.463-0.349 1.121-0.257 1.471 0.206s0.257 1.121-0.206 1.471zM27 9.202l-4.619 3.486c0.222 0.109 0.421 0.233 0.596 0.373 0.291 0.232 0.514 0.479 0.668 0.742s0.231 0.508 0.231 0.735c0 0.232-0.086 0.429-0.259 0.59s-0.382 0.242-0.629 0.242c-0.161 0-0.295-0.041-0.401-0.124s-0.226-0.217-0.359-0.401c-0.237-0.36-0.484-0.63-0.742-0.81-0.164-0.114-0.357-0.193-0.578-0.234l-2.249 1.697c-0.045 0.237-0.068 0.495-0.068 0.774 0 0.365 0.045 0.7 0.135 1.005s0.22 0.566 0.391 0.781c0.171 0.215 0.377 0.379 0.618 0.49s0.507 0.167 0.796 0.167c0.388 0 0.721-0.090 0.998-0.27s0.522-0.455 0.735-0.824c0.118-0.218 0.246-0.388 0.384-0.511s0.305-0.185 0.504-0.185c0.237 0 0.433 0.090 0.59 0.27s0.234 0.372 0.234 0.575c0 0.241-0.072 0.5-0.217 0.774s-0.365 0.536-0.661 0.785-0.669 0.449-1.119 0.6c-0.45 0.152-0.957 0.227-1.52 0.227-1.198 0-2.133-0.349-2.806-1.048-0.536-0.557-0.858-1.265-0.967-2.123l-1.382 1.043c-0.033 0.165-0.096 0.337-0.19 0.516-0.145 0.275-0.365 0.536-0.661 0.785s-0.669 0.449-1.119 0.6c-0.246 0.083-0.508 0.143-0.788 0.18l-5.283 3.987c5.615-0.003 19.737-0.003 19.737-0.003v-14.893z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M4.997 6h19.546l-2.492 1.903c-6.487 0.002-17.051 0.002-17.051 0.002v13.019l-2 1.527v-14.551c0-1.049 0.895-1.9 1.997-1.9z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M12.841 14.034c0.179 0.125 0.353 0.293 0.521 0.504l1.399-1.068c-0.121-0.141-0.264-0.277-0.428-0.409-0.291-0.232-0.646-0.421-1.066-0.568s-0.88-0.22-1.382-0.22c-0.81 0-1.506 0.167-2.088 0.501s-1.028 0.806-1.335 1.417-0.462 1.314-0.462 2.11c0 0.77 0.144 1.437 0.433 2.002l1.598-1.22c-0.056-0.252-0.085-0.522-0.085-0.81 0-0.777 0.175-1.389 0.526-1.836s0.812-0.671 1.385-0.671c0.398 0 0.726 0.090 0.984 0.27z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n@keyframes playkit-openDropmenu {\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n.playkit-dropdown {\n  position: relative;\n  font-size: 15px;\n}\n.playkit-dropdown .playkit-label-badge {\n  position: relative;\n}\n.playkit-dropdown .playkit-label-badge:after {\n  top: -5px;\n  right: -18px;\n}\n.playkit-dropdown.playkit-active .playkit-dropdown-menu {\n  display: block;\n  opacity: 1;\n}\n.playkit-dropdown.playkit-active .playkit-dropdown-button .playkit-icon-arrow-down {\n  transform: rotate(180deg);\n}\n.playkit-dropdown .playkit-dropdown-button {\n  font-weight: bold;\n  line-height: 18px;\n  color: #fff;\n  cursor: pointer;\n  margin-left: 20px;\n  display: flex;\n}\n.playkit-dropdown .playkit-dropdown-button .playkit-icon {\n  width: 16px;\n  height: 16px;\n  vertical-align: middle;\n  margin-left: 6px;\n  transition: 150ms transform;\n  will-change: transform;\n}\n.playkit-dropdown .playkit-dropdown-button > .playkit-label-badge.playkit-badge-icon {\n  margin-right: 13px;\n}\n\n.playkit-dropdown-menu {\n  display: block;\n  opacity: 1;\n  position: absolute;\n  background-color: #333333;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.3);\n  border-radius: 4px;\n  padding: 8px 0;\n  z-index: 5;\n  animation: playkit-openDropmenu 100ms ease-out forwards;\n  max-height: 220px;\n  overflow-y: auto;\n  font-size: 15px;\n  text-align: left;\n  font-weight: normal;\n}\n.playkit-dropdown-menu.playkit-top {\n  margin-bottom: 10px;\n  bottom: 100%;\n}\n.playkit-dropdown-menu.playkit-bottom {\n  margin-top: 10px;\n  top: 100%;\n}\n.playkit-dropdown-menu.playkit-right {\n  left: 0;\n}\n.playkit-dropdown-menu.playkit-left {\n  right: 0;\n}\n.playkit-dropdown-menu.playkit-stick-bottom {\n  bottom: -95px;\n  margin: 5px 0;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 4px 12px;\n  margin: 4px;\n  white-space: nowrap;\n  min-height: 30px;\n  cursor: pointer;\n  border-radius: 4px;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item:hover {\n  background-color: var(--playkit-tone-5-color);\n  color: #fff;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item:focus {\n  color: #fff;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item.playkit-active .playkit-menu-icon-container {\n  opacity: 1;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item .playkit-icon-check-active {\n  display: inline-block;\n  margin-left: 16px;\n  vertical-align: middle;\n  width: 24px;\n  height: 24px;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item .playkit-menu-icon-container {\n  opacity: 0;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item > .playkit-label-badge.playkit-badge-icon {\n  margin-right: 5px;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-additional-options {\n  border-top: 1px solid var(--playkit-tone-5-color);\n}\n\n.playkit-smart-container > div:last-child .playkit-dropdown-menu.playkit-stick-bottom {\n  bottom: -55px !important;\n}\n\n.playkit-player .playkit-control-button {\n  width: 32px;\n  height: 32px;\n  border-radius: 4px;\n  background: transparent;\n  display: inline-block;\n  opacity: 0.8;\n  border: none;\n  padding: 0;\n  cursor: pointer;\n}\n.playkit-player .playkit-control-button.playkit-button-badge {\n  position: relative;\n}\n.playkit-player .playkit-control-button.playkit-button-badge:after {\n  top: -4px;\n  right: -1px;\n}\n.playkit-player .playkit-control-button i {\n  width: 32px;\n  height: 32px;\n}\n.playkit-player .playkit-control-button.playkit-active {\n  opacity: 1;\n}\n.playkit-player .playkit-control-button:disabled {\n  opacity: 0.4;\n  cursor: default;\n}\n.playkit-player .playkit-control-button.playkit-control-button-rounded {\n  width: 36px;\n  height: 36px;\n  padding: 2px;\n}\n\n.playkit-player:not(.playkit-touch) .playkit-control-button:not(:disabled):hover {\n  opacity: 1;\n}\n.playkit-player:not(.playkit-touch) .playkit-control-button:not(:disabled).playkit-control-button-rounded:hover {\n  background-color: rgba(0, 0, 0, 0.4);\n  border-radius: 18px;\n}\n\n.playkit-player .playkit-control-button-container {\n  display: inline-block;\n  position: relative;\n  vertical-align: top;\n}\n\n.playkit-player.playkit-touch .playkit-player .playkit-control-button-container {\n  position: static;\n}\n.playkit-player.playkit-touch .playkit-control-button {\n  position: relative;\n}\n\n.playkit-player.playkit-state-idle .playkit-no-idle-control {\n  display: none;\n}\n\n.playkit-rotate {\n  -moz-animation: playkit-spin 0.3s 1 linear;\n  -o-animation: playkit-spin 0.3s 1 linear;\n  -webkit-animation: playkit-spin 0.3s 1 linear;\n  animation: playkit-spin 0.3s 1 linear;\n}\n\n.playkit-reverse-rotate {\n  -moz-animation: playkit-reverse-spin 0.3s 1 linear;\n  -o-animation: playkit-reverse-spin 0.3s 1 linear;\n  -webkit-animation: playkit-reverse-spin 0.3s 1 linear;\n  animation: playkit-reverse-spin 0.3s 1 linear;\n}\n\n@-webkit-keyframes playkit-spin {\n  0% {\n    -webkit-transform: rotate(359deg);\n  }\n  100% {\n    -webkit-transform: rotate(0deg);\n  }\n}\n@-moz-keyframes playkit-spin {\n  0% {\n    -moz-transform: rotate(359deg);\n  }\n  100% {\n    -moz-transform: rotate(0deg);\n  }\n}\n@-o-keyframes playkit-spin {\n  0% {\n    -o-transform: rotate(359deg);\n  }\n  100% {\n    -o-transform: rotate(0deg);\n  }\n}\n@-ms-keyframes playkit-spin {\n  0% {\n    -ms-transform: rotate(359deg);\n  }\n  100% {\n    -ms-transform: rotate(0deg);\n  }\n}\n@keyframes playkit-spin {\n  0% {\n    transform: rotate(359deg);\n  }\n  100% {\n    transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n@-moz-keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n@-o-keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n@-ms-keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n@keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n.playkit-upper-bar-icon {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  padding: 2px;\n  cursor: pointer;\n  color: var(--playkit-tone-1-color);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0.8;\n  border: none;\n  background-color: transparent;\n  margin: 0 4px;\n}\n.playkit-upper-bar-icon:hover {\n  background-color: var(--playkit-tone-4-color);\n  opacity: 1;\n}\n.playkit-upper-bar-icon:active {\n  background-color: var(--playkit-tone-6-color);\n  opacity: 1;\n}\n.playkit-upper-bar-icon:disabled {\n  opacity: 0.4;\n}\n\n.playkit-player a {\n  font-size: 15px;\n  line-height: 18px;\n  cursor: pointer;\n  --primary-hover-color: hsl(var(--playkit-primary-hsl-hue) var(--playkit-hsl-saturation) calc(var(--playkit-hsl-lightness) - 10%));\n}\n.playkit-player a:hover {\n  color: var(--primary-hover-color);\n}\n.playkit-player a:active {\n  opacity: 0.7;\n}\n\n.playkit-emptyUrl a {\n  cursor: auto;\n  pointer-events: none;\n}\n\n.playkit-player {\n  overflow: hidden;\n  user-select: none;\n  width: 100%;\n  height: 100%;\n  position: relative;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n  cursor: none;\n  font-family: Lato, Helvetica Neue, Segoe UI, sans-serif;\n}\n.playkit-player:-webkit-full-screen {\n  width: 100%;\n  height: 100%;\n  max-width: none;\n}\n.playkit-player * {\n  box-sizing: border-box;\n  outline: none;\n}\n.playkit-player ::selection {\n  background-color: rgba(0, 0, 0, 0.1);\n}\n.playkit-player video {\n  width: 100%;\n  left: 0;\n}\n.playkit-player video::-webkit-media-controls-panel-container, .playkit-player video::-webkit-media-controls {\n  display: none !important;\n  -webkit-appearance: none;\n}\n.playkit-player video::-webkit-media-controls-start-playback-button {\n  display: none !important;\n  -webkit-appearance: none;\n}\n.playkit-player .playkit-player-gui {\n  overflow: hidden;\n  font-size: 0;\n}\n.playkit-player .playkit-player-gui label {\n  margin-bottom: 0;\n}\n.playkit-player .overlay-portal {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n}\n.playkit-player.playkit-overlay-active .overlay-portal {\n  z-index: 11;\n  pointer-events: initial;\n}\n.playkit-player.playkit-protected .no-copy {\n  user-select: none !important;\n  -webkit-user-select: none !important;\n  -moz-user-select: none !important;\n  -ms-user-select: none !important;\n  -webkit-touch-callout: none !important;\n  cursor: default;\n}\n.playkit-player.playkit-protected .no-copy::selection {\n  background: transparent;\n}\n\n.playkit-player.playkit-nav *:focus {\n  outline: 2px solid var(--playkit-tab-focus-color) !important;\n  box-shadow: 0 0 0 2px white !important;\n  outline-offset: 2px;\n}\n\n.playkit-player [id^=\"playkit-ads-container\"] {\n  transition: transform 100ms;\n}\n.playkit-player [id^=\"playkit-ads-container\"][data-adtype=\"overlay\"] {\n  z-index: 1;\n}\n\n.playkit-player:not(.playkit-ad-break).playkit-metadata-loaded.playkit-hover [id^=\"playkit-ads-container\"], .playkit-player:not(.playkit-ad-break).playkit-metadata-loaded.playkit-state-paused [id^=\"playkit-ads-container\"], .playkit-player:not(.playkit-ad-break).playkit-metadata-loaded.playkit-state-idle [id^=\"playkit-ads-container\"] {\n  transform: translateY(-60px);\n  -webkit-transform: translateY(-60px);\n  -ms-transform: translateY(-60px);\n}\n\n.playkit-player.playkit-pre-playback, .playkit-player.playkit-casting, .playkit-player.playkit-metadata-loaded.playkit-hover, .playkit-player.playkit-state-paused, .playkit-player.playkit-state-idle, .playkit-player.playkit-ad-break, .playkit-player.playkit-menu-active, .playkit-player.playkit-overlay-active {\n  cursor: auto;\n}\n\n.playkit-player video::-webkit-media-text-track-container {\n  max-height: none;\n}\n.playkit-player.playkit-iOS video::-webkit-media-text-track-container {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.playkit-player.playkit-state-paused video::-webkit-media-text-track-container, .playkit-player.playkit-state-idle video::-webkit-media-text-track-container, .playkit-player.playkit-hover video::-webkit-media-text-track-container {\n  padding: 0 0 50px 0;\n}\n.playkit-player.playkit-state-paused.playkit-Safari video::-webkit-media-text-track-container, .playkit-player.playkit-state-paused.playkit-iOS video::-webkit-media-text-track-container, .playkit-player.playkit-state-idle.playkit-Safari video::-webkit-media-text-track-container, .playkit-player.playkit-state-idle.playkit-iOS video::-webkit-media-text-track-container, .playkit-player.playkit-hover.playkit-Safari video::-webkit-media-text-track-container, .playkit-player.playkit-hover.playkit-iOS video::-webkit-media-text-track-container {\n  padding: initial;\n  max-height: calc(100% - 50px);\n}\n.playkit-player.playkit-state-paused.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-display, .playkit-player.playkit-state-idle.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-display, .playkit-player.playkit-hover.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-display {\n  transform: translateY(-50px);\n  -webkit-transform: translateY(-50px);\n  -ms-transform: translateY(-50px);\n}\n.playkit-player.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-container {\n  max-height: none;\n}\n.playkit-player.playkit-overlay-active .playkit-subtitles {\n  visibility: hidden;\n}\n.playkit-player .playkit-subtitles {\n  top: 50px;\n  transform: translateY(0px);\n  -webkit-transform: translateY(0px);\n  -ms-transform: translateY(0px);\n  transition: ease-in 100ms;\n}\n.playkit-player:not(.playkit-overlay-active).playkit-state-paused .playkit-subtitles, .playkit-player:not(.playkit-overlay-active).playkit-state-idle .playkit-subtitles, .playkit-player:not(.playkit-overlay-active).playkit-hover .playkit-subtitles {\n  transform: translateY(-50px);\n  -webkit-transform: translateY(-50px);\n  -ms-transform: translateY(-50px);\n}\n.playkit-player:not(.playkit-overlay-active).playkit-fullscreen.playkit-iOS .playkit-subtitles {\n  transform: translateY(0px);\n  -webkit-transform: translateY(0px);\n  -ms-transform: translateY(0px);\n}\n\n.playkit-video-player {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: var(--playkit-player-background-color);\n  transition: all 500ms;\n  transition-property: left, right, bottom, top, width, height;\n  display: flex;\n}\n.playkit-overlay-active .playkit-video-player {\n  filter: blur(16px);\n}\n\n@keyframes playkit-openOverlay {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n.playkit-overlay {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: none;\n  opacity: 0;\n  animation: playkit-openOverlay 100ms ease-in-out forwards;\n  z-index: 11;\n}\n.playkit-overlay.playkit-active {\n  display: block;\n  opacity: 1;\n}\n.playkit-overlay .playkit-overlay-contents {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.7);\n  z-index: 4;\n  text-align: center;\n  color: #fff;\n  padding: 60px 20px 30px 20px;\n  overflow-y: auto;\n}\n.playkit-overlay .playkit-title {\n  font-size: 24px;\n  font-weight: bold;\n  line-height: 29px;\n  margin-bottom: 60px;\n  margin-top: 0px;\n}\n.playkit-overlay .playkit-close-overlay {\n  position: absolute;\n  top: 48px;\n  right: 48px;\n  z-index: 5;\n  cursor: pointer;\n}\n.playkit-overlay .playkit-close-overlay .playkit-icon-close {\n  width: 24px;\n  height: 24px;\n}\n.playkit-overlay .playkit-overlay-screen {\n  display: none;\n}\n.playkit-overlay .playkit-overlay-screen.playkit-active {\n  display: block;\n}\n\n.playkit-player.playkit-size-md .playkit-overlay .playkit-overlay-contents {\n  padding: 36px 20px;\n}\n.playkit-player.playkit-size-md .playkit-overlay .playkit-close-overlay {\n  top: 38px;\n}\n.playkit-player.playkit-size-md .playkit-overlay .playkit-title {\n  margin-bottom: 24px;\n  margin-top: 0px;\n}\n\n.playkit-player.playkit-size-sm .playkit-overlay .playkit-overlay-contents, .playkit-player.playkit-size-xs .playkit-overlay .playkit-overlay-contents {\n  padding: 16px 24px;\n}\n.playkit-player.playkit-size-sm .playkit-overlay .playkit-close-overlay, .playkit-player.playkit-size-xs .playkit-overlay .playkit-close-overlay {\n  top: 15px;\n  right: 24px;\n}\n.playkit-player.playkit-size-sm .playkit-overlay .playkit-title, .playkit-player.playkit-size-xs .playkit-overlay .playkit-title {\n  font-size: 20px;\n  line-height: 19px;\n  margin-bottom: 24px;\n  margin-top: 0px;\n}\n\n@keyframes playkit-openSmartContainer {\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n@keyframes playkit-closeSmartContainer {\n  from {\n    opacity: 1;\n    transform: translateY(0);\n  }\n  to {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container {\n  background-color: #222222;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.3);\n  border-radius: 4px;\n  position: absolute;\n  right: 0px;\n  min-width: 193px;\n  font-size: 15px;\n  z-index: 10;\n  display: block;\n  animation: playkit-openSmartContainer 100ms ease-out forwards;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-leaving {\n  animation: playkit-closeSmartContainer 100ms ease-out forwards;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-top {\n  bottom: 100%;\n  margin-bottom: 6px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-top:before {\n  display: block;\n  content: \" \";\n  position: absolute;\n  bottom: -6px;\n  left: 0;\n  width: 100%;\n  height: 6px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-bottom {\n  top: 100%;\n  margin-top: 6px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-right {\n  left: 0px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-left {\n  right: 0px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item {\n  margin: 16px;\n  color: rgba(244, 244, 244, 0.8);\n  white-space: nowrap;\n  display: flex;\n  justify-content: space-between;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon {\n  display: none;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item select {\n  align-self: flex-end;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown span:not(.playkit-badge-icon) {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  vertical-align: middle;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item select {\n  text-align-last: right;\n}\n\n.playkit-player.playkit-touch .playkit-smart-container-item, .playkit-player.playkit-size-sm .playkit-smart-container-item, .playkit-player.playkit-size-xs .playkit-smart-container-item {\n  width: 300px;\n  max-width: 100%;\n  margin: 16px auto;\n  color: rgba(244, 244, 244, 0.8);\n  white-space: nowrap;\n  text-align: left;\n  display: flex;\n  justify-content: space-between;\n}\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item label, .playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item label, .playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item label {\n  font-size: 16px;\n  color: rgba(255, 255, 255, 0.8);\n  margin-right: 20px;\n}\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon, .playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon, .playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon {\n  width: 24px;\n  height: 24px;\n  display: inline-block;\n  vertical-align: middle;\n  margin-right: 16px;\n}\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item select, .playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,\n.playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item select, .playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,\n.playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item select {\n  align-self: flex-end;\n}\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item select, .playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item select, .playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item select {\n  text-align-last: right;\n  min-width: 1px;\n  line-height: 24px;\n}\n.playkit-player.playkit-touch.playkit-Windows select option, .playkit-player.playkit-size-sm.playkit-Windows select option, .playkit-player.playkit-size-xs.playkit-Windows select option {\n  color: black;\n  background-color: white;\n}\n\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample {\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  font-size: 16px;\n  font-weight: bold;\n  line-height: 36px;\n  text-align: center;\n  padding: 0 31px;\n  display: inline-block;\n  margin: 0 12px;\n  position: relative;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample:not(.playkit-custom) {\n  cursor: pointer;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample.playkit-black-bg {\n  background-color: #000;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample.playkit-yellow-text {\n  color: #faff00;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample .playkit-active-tick {\n  height: 16px;\n  width: 16px;\n  border-radius: 8px;\n  background-color: var(--playkit-primary-color);\n  position: absolute;\n  top: -5px;\n  right: -5px;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample .playkit-active-tick .playkit-icon {\n  vertical-align: top;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample span {\n  font-size: 16px !important;\n  line-height: 1;\n  vertical-align: middle;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-button-save-cvaa {\n  margin-top: 50px;\n  height: 40px;\n  width: 400px;\n  max-width: 100%;\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  font-size: 16px;\n  font-weight: bold;\n  line-height: 38px;\n  text-align: center;\n  display: inline-block;\n  color: #fff;\n  text-decoration: none;\n  cursor: pointer;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-button-save-cvaa:focus {\n  outline: 2px solid #2684FF;\n  box-shadow: 0 0 0 2px white;\n  outline-offset: 1px;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-button-edit-cvaa {\n  display: inline-block;\n  text-decoration: none;\n  cursor: pointer;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-button-edit-cvaa:focus {\n  outline: 1px solid #2684FF;\n  box-shadow: 0 0 0 1px white;\n  outline-offset: 1px;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-captions-applied {\n  margin-top: 50px;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-captions-applied a {\n  color: var(--playkit-primary-brighter-color);\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form {\n  width: 300px;\n  max-width: 100%;\n  margin: 0 auto;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form a {\n  color: white;\n  line-height: 36px;\n  text-decoration: none;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form a:hover, .playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form a:focus {\n  text-decoration: underline;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form .playkit-slider {\n  float: right;\n  width: 100px;\n  margin-top: 5px;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-preview-container {\n  width: 100%;\n  text-align: center;\n  font-size: 16px;\n}\n\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample {\n  width: 30%;\n  margin: 2.33%;\n  padding: 0;\n}\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample:first-child {\n  margin-left: 0;\n}\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample:last-child {\n  margin-right: 0;\n}\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample.playkit-custom {\n  width: auto;\n  padding: 0 10px;\n}\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-button-save-cvaa,\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-custom-captions-applied {\n  margin-top: 20px;\n}\n\n.playkit-font-size,\n.playkit-font-alignment,\n.playkit-font-color,\n.playkit-font-family,\n.playkit-font-style,\n.playkit-font-opacity,\n.playkit-background-color,\n.playkit-background-opacity {\n  background: initial;\n}\n\n.playkit-loading-backdrop {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transition: 100ms opacity;\n  opacity: 0;\n  z-index: 5;\n}\n.playkit-loading-backdrop.playkit-show {\n  opacity: 1;\n}\n.playkit-loading-backdrop.playkit-show .playkit-spinner-container {\n  display: block;\n}\n.playkit-loading-backdrop .playkit-spinner-container {\n  display: none;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate3d(-50%, -50%, 0);\n}\n\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button {\n  transition: 400ms transform;\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button .playkit-icon-pause,\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button .playkit-icon-stop {\n  transition: 400ms opacity;\n  opacity: 0;\n  display: none;\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button .playkit-icon-play {\n  transition: 400ms opacity;\n  opacity: 1;\n  display: block;\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing {\n  transform: rotate(360deg);\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing .playkit-icon-pause,\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing .playkit-icon-stop {\n  opacity: 1;\n  display: block;\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing .playkit-icon-play {\n  opacity: 0;\n  display: none;\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button:focus {\n  outline: 2px solid var(--playkit-tab-focus-color) !important;\n  box-shadow: 0 0 0 2px white !important;\n  outline-offset: 2px;\n}\n\n.playkit-control-button-container.playkit-control-volume, .playkit-control-button-container.playkit-volume-control {\n  display: inline-block !important;\n}\n.playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-volume-control-bar, .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-volume-control-bar {\n  display: block !important;\n  opacity: 1;\n  height: 112px;\n  padding: 2px;\n}\n.playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-volume-control-bar:before, .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-volume-control-bar:before {\n  height: 14px;\n}\n.playkit-control-button-container.playkit-control-volume.playkit-is-muted .playkit-icon-volume-waves, .playkit-control-button-container.playkit-volume-control.playkit-is-muted .playkit-icon-volume-waves {\n  opacity: 0;\n  -webkit-transform: translateX(-5px);\n  -ms-transform: translateX(-5px);\n  transform: translateX(-5px);\n}\n.playkit-control-button-container.playkit-control-volume.playkit-is-muted .playkit-icon-volume-mute, .playkit-control-button-container.playkit-volume-control.playkit-is-muted .playkit-icon-volume-mute {\n  opacity: 1;\n  -webkit-transform: scale(1);\n  -ms-transform: scale(1);\n  transform: scale(1);\n}\n.playkit-control-button-container.playkit-control-volume.playkit-dragging-active .playkit-volume-control-bar, .playkit-control-button-container.playkit-volume-control.playkit-dragging-active .playkit-volume-control-bar {\n  display: block !important;\n  opacity: 1;\n  height: 112px;\n  padding: 2px;\n}\n.playkit-control-button-container.playkit-control-volume.playkit-dragging-active .playkit-volume-control-bar:before, .playkit-control-button-container.playkit-volume-control.playkit-dragging-active .playkit-volume-control-bar:before {\n  height: 14px;\n}\n.playkit-control-button-container.playkit-control-volume .playkit-volume-button, .playkit-control-button-container.playkit-volume-control .playkit-volume-button {\n  position: absolute;\n  bottom: -2px;\n  left: 0;\n  width: 2px;\n  height: 2px;\n  background: transparent;\n}\n.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-waves, .playkit-control-button-container.playkit-volume-control .playkit-icon-volume-waves {\n  -webkit-transform: translateX(0px);\n  -ms-transform: translateX(0px);\n  transform: translateX(0px);\n}\n.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-mute, .playkit-control-button-container.playkit-volume-control .playkit-icon-volume-mute {\n  opacity: 1;\n  -webkit-transform: scale(0);\n  -ms-transform: scale(0);\n  transform: scale(0);\n}\n.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-waves,\n.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-mute, .playkit-control-button-container.playkit-volume-control .playkit-icon-volume-waves,\n.playkit-control-button-container.playkit-volume-control .playkit-icon-volume-mute {\n  transition: 300ms transform, 300ms opacity;\n}\n.playkit-control-button-container.playkit-control-volume i, .playkit-control-button-container.playkit-volume-control i {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.playkit-volume-control-bar {\n  position: absolute;\n  z-index: 2;\n  bottom: 38px;\n  left: 0;\n  height: 0px;\n  width: 24px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.3);\n  background-color: rgba(255, 255, 255, 0.3);\n  padding: 0px;\n  opacity: 0;\n}\n.playkit-volume-control-bar:before {\n  position: absolute;\n  width: 24px;\n  height: 0px;\n  bottom: -8px;\n  left: 0;\n  content: \" \";\n  display: block;\n}\n.playkit-volume-control-bar .playkit-bar {\n  background-color: #212121;\n  height: 100%;\n  position: relative;\n  cursor: pointer;\n  border-radius: 4px;\n}\n.playkit-volume-control-bar .playkit-progress {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  border-radius: 0 0 2px 2px;\n  background-color: var(--playkit-tone-1-color);\n  border-radius: 4px;\n}\n\n.playkit-player.playkit-smart-container-open .playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-control-volume-bar, .playkit-player.playkit-smart-container-open .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-control-volume-bar {\n  display: none !important;\n}\n\n.playkit-size-ty .playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-control-volume-bar, .playkit-size-ty .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-control-volume-bar {\n  display: none !important;\n}\n\n.playkit-touch .playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-control-volume-bar, .playkit-touch .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-control-volume-bar {\n  display: none !important;\n}\n\n.playkit-sr-only {\n  position: absolute;\n  left: -10000px;\n  top: auto;\n  width: 1px;\n  height: 1px;\n  overflow: hidden;\n}\n\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button {\n  transition: 100ms transform;\n  transform: scale(1);\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button .playkit-icon-minimize {\n  display: none;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-maximize {\n  display: none;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-minimize {\n  display: block;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button:focus {\n  outline: 2px solid var(--playkit-tab-focus-color) !important;\n  box-shadow: 0 0 0 2px white !important;\n  outline-offset: 2px;\n}\n\n.playkit-player:not(.playkit-touch) .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button:hover {\n  transform: scale(1.1);\n}\n\n.playkit-player .playkit-seek-bar {\n  padding: 12px 0 12px 0;\n  cursor: pointer;\n  position: relative;\n  z-index: 1;\n}\n.playkit-player .playkit-seek-bar:hover .playkit-time-preview,\n.playkit-player .playkit-seek-bar:hover .playkit-frame-preview:not(.playkit-hide-frame-preview), .playkit-player .playkit-seek-bar.playkit-hover .playkit-time-preview,\n.playkit-player .playkit-seek-bar.playkit-hover .playkit-frame-preview:not(.playkit-hide-frame-preview) {\n  display: block;\n}\n.playkit-player .playkit-seek-bar:hover .playkit-progress-bar .playkit-scrubber, .playkit-player .playkit-seek-bar.playkit-hover .playkit-progress-bar .playkit-scrubber {\n  transform: scale(1);\n}\n.playkit-player .playkit-seek-bar:hover .playkit-progress-bar .playkit-virtual-progress, .playkit-player .playkit-seek-bar.playkit-hover .playkit-progress-bar .playkit-virtual-progress {\n  display: block;\n}\n.playkit-player .playkit-seek-bar.playkit-ad-break {\n  cursor: initial;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar {\n  width: 100%;\n  height: 4px;\n  background-color: rgba(255, 255, 255, 0.4);\n  border-radius: 2px;\n  border: 1px solid rgba(0, 0, 0, 0.4);\n  position: absolute;\n  transition: height 200ms ease, transform 200ms ease;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar.playkit-chapters {\n  background-color: transparent;\n  border: none;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar.playkit-chapters .playkit-virtual-progress-indicator {\n  height: 8px;\n  transform: translateY(-2px);\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress {\n  display: none;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  border-radius: inherit;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress-indicator {\n  width: 1px;\n  height: 100%;\n  background-color: var(--playkit-tone-1-color);\n  float: right;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-scrubber {\n  position: absolute;\n  cursor: pointer;\n  display: block;\n  top: -6px;\n  left: -6px;\n  border-radius: 8px;\n  height: 16px;\n  width: 16px;\n  background-color: var(--playkit-tone-1-color);\n  box-shadow: 0 0 31px 0 rgba(0, 0, 0, 0.3);\n  transform: scale(0);\n  transition: 100ms transform;\n  z-index: 1;\n  pointer-events: none;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-scrubber:active {\n  opacity: 1;\n  cursor: grabbing;\n}\n.playkit-player .playkit-seek-bar .playkit-frame-preview {\n  position: absolute;\n  bottom: 20px;\n  left: 0;\n}\n.playkit-player .playkit-seek-bar .playkit-time-preview {\n  position: absolute;\n  bottom: 26px;\n  left: 0;\n  height: 22px;\n  min-width: 48px;\n  padding: 0 3px;\n  text-align: center;\n  border-radius: 3px;\n  background-color: rgba(0, 0, 0, 0.7);\n  font-size: 13px;\n  font-weight: bold;\n  line-height: 22px;\n  color: #fff;\n  z-index: 1;\n  pointer-events: none;\n}\n.playkit-player .playkit-seek-bar .playkit-time-preview,\n.playkit-player .playkit-seek-bar .playkit-frame-preview {\n  display: none;\n}\n.playkit-player .playkit-seek-bar .playkit-non-sticky:hover {\n  display: none;\n}\n\n.playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar:hover .playkit-progress-bar:not(.playkit-chapters), .playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar.playkit-hover .playkit-progress-bar:not(.playkit-chapters) {\n  height: 8px;\n  border-radius: 4px;\n  transform: translateY(-2px);\n}\n.playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar:hover .playkit-progress-bar:not(.playkit-chapters) .playkit-scrubber, .playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar.playkit-hover .playkit-progress-bar:not(.playkit-chapters) .playkit-scrubber {\n  top: -4px;\n}\n\n.playkit-player.playkit-touch .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress,\n.playkit-player.playkit-touch .playkit-seek-bar .playkit-progress-bar .playkit-time-preview,\n.playkit-player.playkit-touch .playkit-seek-bar .playkit-progress-bar .playkit-frame-preview {\n  display: none;\n}\n\n.playkit-player.playkit-size-ty .playkit-seek-bar {\n  padding: 12px 0;\n  cursor: pointer;\n  position: relative;\n  float: left;\n  width: calc(100% - 45px);\n  margin: 1px 0;\n}\n.playkit-player.playkit-size-ty .playkit-seek-bar .playkit-frame-preview {\n  display: none;\n}\n.playkit-player.playkit-size-ty .playkit-seek-bar .playkit-time-preview {\n  bottom: 16px;\n}\n\n.playkit-player .playkit-seek-bar.playkit-ad-break {\n  cursor: initial;\n}\n.playkit-player .playkit-seek-bar.playkit-ad-break .playkit-progress-bar .playkit-progress {\n  background-color: var(--playkit-ads-color);\n}\n.playkit-player .playkit-seek-bar.playkit-live .playkit-progress-bar .playkit-progress {\n  background-color: var(--playkit-live-color);\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-progress {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  border-radius: inherit;\n  background-color: var(--playkit-primary-color);\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-buffered {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  border-radius: inherit;\n  background-color: rgba(255, 255, 255, 0.6);\n}\n\n.playkit-frame-preview .playkit-frame-preview-img-container {\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n}\n.playkit-frame-preview .playkit-frame-preview-img-container .playkit-frame-preview-img {\n  background-size: auto 100% !important;\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n\n.playkit-player .playkit-time-display {\n  display: inline-block;\n  line-height: 32px;\n  vertical-align: top;\n  font-size: 14px;\n  padding: 0 23px 0 4px;\n  font-weight: bold;\n  white-space: nowrap;\n  filter: drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.7));\n}\n\n.playkit-touch .playkit-time-display {\n  padding-left: 0;\n}\n\n.playkit-player.playkit-size-md .playkit-time-display, .playkit-player.playkit-size-sm .playkit-time-display, .playkit-player.playkit-size-xs .playkit-time-display {\n  padding-right: 12px;\n}\n\n.playkit-player .playkit-video-playing-title {\n  font-size: 15px;\n  font-weight: bold;\n  line-height: 18px;\n  padding: 6px 0;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.playkit-player .playkit-bottom-bar {\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.8) 100%);\n  color: #fff;\n  height: auto;\n  width: 100%;\n  margin-top: auto;\n  bottom: 0;\n  left: 0;\n  z-index: 1;\n  pointer-events: auto;\n  position: absolute;\n  padding: 0;\n  opacity: 0;\n  max-height: 60px;\n  transition: 100ms opacity ease-in-out, 0ms padding linear 100ms;\n}\n.playkit-player .playkit-bottom-bar.playkit-hide {\n  display: none;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  justify-content: space-between;\n  width: 100%;\n  position: relative;\n  z-index: 1;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container .playkit-left-controls {\n  flex-shrink: 0;\n  text-align: left;\n  pointer-events: none;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container .playkit-left-controls .playkit-control-button-container:first-child {\n  margin-left: 0px;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container .playkit-right-controls {\n  display: flex;\n  flex-wrap: nowrap;\n  flex-grow: 0;\n  text-align: left;\n  pointer-events: none;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container .playkit-right-controls .playkit-control-button-container:last-child {\n  margin-right: 0px;\n}\n.playkit-player .playkit-bottom-bar .playkit-bottom-bar-area {\n  position: relative;\n  pointer-events: none;\n}\n.playkit-player .playkit-bottom-bar .playkit-bottom-bar-area .playkit-time-display {\n  padding: 0;\n  position: absolute;\n  bottom: 20px;\n  font-size: 12px;\n  line-height: normal;\n  font-weight: 400;\n}\n.playkit-player .playkit-bottom-bar .playkit-control-button-container {\n  margin: 0 4px;\n}\n\n.playkit-player.playkit-overlay-active .playkit-bottom-bar {\n  display: none;\n}\n.playkit-player.playkit-size-ty .playkit-controls-container {\n  display: block;\n}\n.playkit-player.playkit-size-ty .playkit-controls-container .playkit-left-controls {\n  display: none;\n}\n.playkit-player.playkit-size-ty .playkit-controls-container .playkit-right-controls {\n  display: block;\n  float: right;\n}\n.playkit-player.playkit-size-ty .playkit-control-button-container {\n  display: none;\n  margin: 0;\n}\n.playkit-player.playkit-size-xs .playkit-control-button-container:not(.playkit-upper-bar-icon), .playkit-player.playkit-size-sm .playkit-control-button-container:not(.playkit-upper-bar-icon) {\n  margin: 0 3px;\n}\n\n.playkit-player.playkit-casting:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-state-paused:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-state-idle:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-ad-break:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-menu-active:not(.playkit-overlay-active) .playkit-bottom-bar {\n  position: relative;\n  opacity: 1;\n  padding: 0 16px 4px;\n  transition: 100ms opacity ease-in-out;\n}\n\n.playkit-player.playkit-size-sm .playkit-playback-controls + .playkit-time-display, .playkit-player.playkit-size-xs .playkit-playback-controls + .playkit-time-display {\n  padding-left: 0;\n}\n\n.playkit-player.playkit-size-sm .playkit-bottom-bar {\n  padding: 0 8px 4px;\n}\n\n.playkit-player .playkit-bottom-bar .playkit-left-controls > *,\n.playkit-player .playkit-bottom-bar .playkit-right-controls > *,\n.playkit-player .playkit-bottom-bar .playkit-bottom-bar-area > * {\n  pointer-events: auto;\n}\n\n.playkit-player .playkit-top-bar {\n  display: flex;\n  justify-content: space-between;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%);\n  color: #fff;\n  visibility: hidden;\n  position: relative;\n  height: auto;\n  min-height: 75px;\n  max-height: 75px;\n  margin-top: -75px;\n  transition: 100ms visibility ease-in-out, 100ms margin-top ease-in-out, 100ms min-height ease-in-out;\n  width: 100%;\n  top: 0;\n  left: 0;\n  z-index: 2;\n  pointer-events: auto;\n}\n.playkit-player .playkit-top-bar .playkit-top-bar-area {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: calc(100% - 24px);\n  width: calc(100% - 32px);\n  margin: 12px 16px;\n  pointer-events: none;\n}\n.playkit-player .playkit-top-bar .playkit-top-bar-area:empty {\n  margin: 0;\n  height: 0;\n  width: 0;\n}\n.playkit-player .playkit-top-bar.playkit-disabled {\n  pointer-events: none;\n}\n.playkit-player .playkit-top-bar.playkit-hide {\n  display: none;\n}\n.playkit-player .playkit-top-bar .playkit-left-controls {\n  float: left;\n  text-align: left;\n  min-width: 0;\n  margin: 12px 16px;\n  pointer-events: none;\n}\n.playkit-player .playkit-top-bar .playkit-left-controls:empty {\n  margin: 0;\n}\n.playkit-player .playkit-top-bar .playkit-right-controls {\n  float: right;\n  text-align: left;\n  margin: 12px 16px 12px 32px;\n  pointer-events: none;\n}\n.playkit-player .playkit-top-bar .playkit-right-controls:empty {\n  margin: 0;\n}\n.playkit-player .playkit-top-bar .playkit-right-controls .playkit-control-button-container:not(.playkit-upper-bar-icon) {\n  margin: 0 6px;\n}\n.playkit-player .playkit-top-bar .playkit-right-controls .playkit-control-button-container:not(.playkit-upper-bar-icon):last-child {\n  margin-right: 0;\n}\n\n.playkit-player.playkit-casting:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-state-paused:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-state-idle:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-ad-break:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-menu-active:not(.playkit-overlay-active) .playkit-top-bar {\n  visibility: visible;\n  margin-top: 0;\n  min-height: 16px;\n}\n\n.playkit-player .playkit-top-bar .playkit-left-controls > *,\n.playkit-player .playkit-top-bar .playkit-right-controls > *,\n.playkit-player .playkit-top-bar .playkit-top-bar-area > * {\n  pointer-events: auto;\n}\n\n.playkit-player .playkit-top-bar:has(.playkit-left-controls:empty + .playkit-right-controls:empty) {\n  visibility: hidden;\n}\n\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-left-controls {\n  margin: 12px 0 12px 8px;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-left-controls:empty {\n  margin: 0;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-right-controls {\n  margin: 12px 8px 12px 0;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-right-controls:empty {\n  margin: 0;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-top-bar-area {\n  width: calc(100% - 16px);\n  margin: 12px 8px;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-top-bar-area:empty {\n  margin: 0;\n}\n\n@keyframes playkit-overlayActionIconIn {\n  0% {\n    opacity: 0;\n    transform: scale(0);\n  }\n  10% {\n    opacity: 0.1;\n    transform: scale(0.1);\n  }\n  20% {\n    opacity: 0.3;\n    transform: scale(0.2);\n  }\n  30% {\n    opacity: 0.5;\n    transform: scale(0.3);\n  }\n  40% {\n    opacity: 0.7;\n    transform: scale(0.4);\n  }\n  50% {\n    opacity: 0.9;\n    transform: scale(0.5);\n  }\n  60% {\n    opacity: 0.9;\n    transform: scale(0.5);\n  }\n  70% {\n    opacity: 0.9;\n    transform: scale(0.5);\n  }\n  75% {\n    opacity: 0.9;\n    transform: scale(0.5);\n  }\n  80% {\n    opacity: 1;\n    transform: scale(0.5);\n  }\n  85% {\n    opacity: 1;\n    transform: scale(0.5);\n  }\n  90% {\n    opacity: 1;\n    transform: scale(0.5);\n  }\n  93% {\n    opacity: 0.7;\n    transform: scale(0.5);\n  }\n  95% {\n    opacity: 0.5;\n    transform: scale(0.5);\n  }\n  98% {\n    opacity: 0.2;\n    transform: scale(0.5);\n  }\n  100% {\n    opacity: 0;\n    transform: scale(0.5);\n  }\n}\n.playkit-overlay-action .playkit-icon {\n  width: 144px;\n  height: 144px;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin: -72px 0 0 -72px;\n  opacity: 0;\n}\n\n.playkit-player:not(.playkit-touch):not(.playkit-size-sm) .playkit-overlay-action.playkit-in .playkit-icon {\n  animation: playkit-overlayActionIconIn 300ms linear forwards;\n}\n\n.playkit-pre-playback-play-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.playkit-pre-playback-play-overlay.playkit-prePlaybackPlayOverlayYoutube {\n  z-index: 2;\n}\n.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button {\n  z-index: 2;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  height: 108px;\n  width: 108px;\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  background-color: rgba(0, 0, 0, 0.5);\n  transform: translate(-50%, -50%);\n  -webkit-transform: translate(-50%, -50%);\n  -ms-transform: translate(-50%, -50%);\n  border-radius: 54px;\n  padding: 20px;\n  cursor: pointer;\n}\n.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button:hover {\n  border: 2px solid rgba(255, 255, 255, 0.4);\n}\n.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button:active {\n  opacity: 0.7;\n  transform: scale(1) translate(-50%, -50%);\n}\n.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button:focus {\n  outline: 2px solid var(--playkit-tab-focus-color) !important;\n  box-shadow: 0 0 0 2px white !important;\n  outline-offset: 2px;\n}\n\n.playkit-pre-playback .playkit-bottom-bar,\n.playkit-pre-playback .playkit-top-bar {\n  opacity: 0;\n  display: none;\n}\n\n.playkit-player.playkit-size-ty .playkit-pre-playback-play-button {\n  width: 75px;\n  height: 75px;\n  padding: 12px;\n}\n.playkit-player.playkit-size-xs .playkit-pre-playback-play-button {\n  width: 85px;\n  height: 85px;\n  padding: 15px;\n}\n.playkit-player.playkit-overlay-active .playkit-gui-area .playkit-pre-playback-play-overlay {\n  opacity: 0;\n  visibility: hidden;\n}\n\n.playkit-player .playkit-btn-skip-ad {\n  font-weight: lighter;\n  position: absolute;\n  bottom: 60px;\n  right: 16px;\n  line-height: 36px;\n}\n.playkit-player .playkit-skip-ad {\n  color: #fff;\n  font-size: 20px;\n  font-weight: lighter;\n  line-height: 24px;\n  text-shadow: 0 0 6px rgba(0, 0, 0, 0.6);\n  position: absolute;\n  bottom: 66px;\n  right: 16px;\n}\n\n.playkit-row {\n  display: block;\n}\n.playkit-row:after {\n  content: \"\";\n  clear: both;\n  display: block;\n}\n\n.playkit-d-inline-block {\n  display: inline-block;\n}\n\n.playkit-mobile-hidden-select {\n  display: block;\n  opacity: 0;\n  position: absolute;\n  top: 0;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n}\n\n.playkit-font-size-base, .playkit-ad-notice {\n  font-size: 15px;\n}\n\n.playkit-ad-notice {\n  pointer-events: none;\n}\n\n.playkit-live-tag {\n  display: inline-block;\n  background-color: var(--playkit-live-color);\n  color: #ffffff;\n  border-radius: 4px;\n  padding: 3px 4px;\n  margin: 5px 10px;\n  text-transform: uppercase;\n  font-size: 15px;\n  cursor: default;\n}\n.playkit-live-tag.playkit-non-live-playhead {\n  background-color: #666666;\n  cursor: pointer;\n}\n\n.playkit-player.playkit-size-sm .playkit-live-tag {\n  margin-left: 0;\n}\n\n.playkit-unmute-button-container {\n  display: inline-block;\n  position: absolute;\n  z-index: 15;\n}\n.playkit-unmute-button-container a {\n  color: #ffffff;\n}\n.playkit-unmute-button-container.playkit-show-icon-only .playkit-btn.playkit-unmute-button {\n  max-width: 64px;\n}\n.playkit-unmute-button-container.playkit-show-icon-only .playkit-btn.playkit-unmute-button span {\n  transform: translateX(10px);\n  opacity: 0;\n  margin-left: 0;\n  max-width: 0;\n}\n\n.playkit-btn.playkit-unmute-button {\n  font-size: 14px;\n  max-width: 200px;\n  transition: max-width 200ms;\n  padding: 8px 12px;\n  white-space: nowrap;\n  display: flex;\n  align-items: center;\n  height: 32px;\n  border-radius: 4px;\n  border: none;\n}\n.playkit-btn.playkit-unmute-button span {\n  transform: translateX(0px);\n  max-width: 51px;\n  opacity: 1;\n  transition: max-width 100ms, transform 100ms, opacity 100ms;\n  display: inline-block;\n  color: #ffffff;\n  margin-left: 4px;\n}\n.playkit-btn.playkit-unmute-button.playkit-has-top-bar {\n  transition: 100ms transform;\n}\n.playkit-btn.playkit-unmute-button:hover {\n  border: none;\n}\n\n.playkit-unmute-icon-container {\n  width: 24px;\n  height: 24px;\n  display: inline-block;\n  vertical-align: top;\n  position: relative;\n}\n.playkit-unmute-icon-container i {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.playkit-player.playkit-hover .playkit-unmute-button-container.playkit-has-top-bar,\n.playkit-player.playkit-state-paused .playkit-unmute-button-container.playkit-has-top-bar,\n.playkit-player.playkit-state-idle .playkit-unmute-button-container.playkit-has-top-bar,\n.playkit-player.playkit-menu-active .playkit-unmute-button-container.playkit-has-top-bar {\n  transform: translateY(32px);\n}\n\n.playkit-overlay.playkit-error-overlay {\n  background-color: var(--playkit-tone-7-color);\n  font-size: 0em;\n}\n\n.playkit-custom-error-slate .playkit-overlay.playkit-error-overlay .playkit-overlay-contents {\n  padding: 0;\n}\n\n.playkit-error-overlay {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  height: 100%;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n.playkit-error-overlay .playkit-copy-url-row {\n  display: flex;\n  align-items: center;\n  margin-bottom: 16px;\n}\n.playkit-error-overlay .playkit-headline {\n  color: var(--playkit-tone-1-color);\n  margin-bottom: 16px;\n}\n.playkit-error-overlay .playkit-headline .playkit-error-title {\n  font-weight: 700;\n  font-size: 20px;\n  font-style: normal;\n  line-height: 22px;\n  margin: 0 0 4px 0;\n  text-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);\n}\n.playkit-error-overlay .playkit-headline .playkit-error-message {\n  font-weight: 400;\n  font-size: 16px;\n  font-style: normal;\n  line-height: 22px;\n}\n.playkit-error-overlay .playkit-error-session {\n  font-size: 14px;\n  color: var(--playkit-tone-1-color);\n  font-style: normal;\n  font-weight: 400;\n  line-height: 18px;\n  user-select: text;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  max-width: 310px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  text-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);\n}\n.playkit-error-overlay .playkit-retry-btn {\n  height: 32px;\n  width: auto;\n  min-width: 120px;\n  padding: 0 8px;\n  border-radius: 4px;\n  color: var(--playkit-tone-1-color);\n  border: none;\n  font-size: 14px;\n  font-weight: 700;\n  font-style: normal;\n  line-height: normal;\n  cursor: pointer;\n}\n.playkit-error-overlay .playkit-error-text {\n  height: 0px;\n  visibility: hidden;\n}\n\n.playkit-link-options-container {\n  width: auto;\n}\n.playkit-link-options-container .playkit-copy-url-row .playkit-input-copy-url {\n  margin: 0;\n}\n.playkit-link-options-container .playkit-copy-url-row .playkit-btn-copy-url {\n  margin-left: 8px;\n  height: 32px;\n  width: 32px;\n}\n.playkit-link-options-container .playkit-copy-url-row .playkit-btn-copy-url .playkit-icon {\n  height: 24px;\n  width: 24px;\n  margin-top: -3px;\n}\n\n.playkit-slider {\n  height: 8px;\n  border-radius: 8px;\n  background-color: rgba(255, 255, 255, 0.6);\n}\n.playkit-slider .playkit-progress {\n  background-color: var(--playkit-primary-color);\n  height: 8px;\n  border-radius: 4px;\n  position: relative;\n}\n.playkit-slider .playkit-progress .playkit-handle {\n  height: 12px;\n  width: 12px;\n  border-radius: 5px;\n  background-color: #ffffff;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.3);\n  position: absolute;\n  right: 0;\n  top: 0px;\n  transform: translate3d(6px, -2px, 0);\n  cursor: pointer;\n}\n\n.playkit-player .playkit-learn-more {\n  font-weight: lighter;\n}\n\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button {\n  transition: 100ms transform;\n  transform: scale(1);\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button .playkit-icon-minimize {\n  display: none;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-maximize {\n  display: none;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-minimize {\n  display: block;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button:focus {\n  outline: 2px solid var(--playkit-tab-focus-color) !important;\n  box-shadow: 0 0 0 2px white !important;\n  outline-offset: 2px;\n}\n\n.playkit-player:not(.playkit-touch) .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button:hover {\n  transform: scale(1.1);\n}\n\n.playkit-player .playkit-watermark {\n  position: absolute;\n  transition: visibility 0s 1s, opacity 1s linear, transform ease-out 100ms;\n}\n.playkit-player .playkit-watermark.playkit-hide-watermark {\n  visibility: hidden;\n  opacity: 0;\n}\n.playkit-player .playkit-watermark.playkit-top {\n  top: 0;\n}\n.playkit-player .playkit-watermark.playkit-bottom {\n  bottom: 0;\n}\n.playkit-player .playkit-watermark.playkit-right {\n  right: 0;\n}\n.playkit-player .playkit-watermark.playkit-left {\n  left: 0;\n}\n\n.playkit-control-button-container.playkit-control-vr-stereo .playkit-control-button .playkit-icon-vr-stereo-full {\n  display: none;\n}\n.playkit-control-button-container.playkit-control-vr-stereo .playkit-control-button.playkit-vr-stereo-mode .playkit-icon-vr-stereo {\n  display: none;\n}\n.playkit-control-button-container.playkit-control-vr-stereo .playkit-control-button.playkit-vr-stereo-mode .playkit-icon-vr-stereo-full {\n  display: block;\n}\n\n.playkit-control-button-container.playkit-control-closed-captions .playkit-control-button .playkit-icon-closed-captions-on {\n  display: none;\n}\n.playkit-control-button-container.playkit-control-closed-captions .playkit-control-button.playkit-cc-on .playkit-icon-closed-captions-off {\n  display: none;\n}\n.playkit-control-button-container.playkit-control-closed-captions .playkit-control-button.playkit-cc-on .playkit-icon-closed-captions-on {\n  display: block;\n}\n\n.playkit-player .playkit-cast-button {\n  display: block;\n  width: 32px;\n  height: 32px;\n  background-color: rgba(255, 255, 255, 0);\n  border: none;\n  cursor: pointer;\n  --connected-color: var(--playkit-tone-2-color);\n  --disconnected-color: var(--playkit-tone-2-color);\n}\n.playkit-player .playkit-cast-button:hover {\n  --connected-color: #ffffffff;\n  --disconnected-color: #ffffffff;\n}\n.playkit-player .playkit-cast-button.playkit-cast-button-active {\n  --connected-color: rgba(1, 172, 205, 0.8);\n}\n.playkit-player .playkit-cast-button.playkit-cast-button-active:hover {\n  --connected-color: var(--playkit-primary-color);\n}\n\n.playkit-player .playkit-cast-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.playkit-player .playkit-cast-overlay .playkit-cast-poster {\n  all: inherit;\n  background-size: contain;\n  background: black no-repeat center center;\n}\n.playkit-player .playkit-cast-overlay .playkit-cast-poster.playkit-has-poster {\n  background-color: #000;\n}\n.playkit-player .playkit-cast-overlay .playkit-cast-black-cover {\n  all: inherit;\n  background: linear-gradient(to top, rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0) 72%, rgba(0, 0, 0, 0) 100%);\n}\n.playkit-player .playkit-cast-box .playkit-cast-icon {\n  position: absolute;\n  bottom: 0;\n  left: 46px;\n  height: 128px;\n}\n.playkit-player .playkit-cast-box .playkit-cast-icon .playkit-icon {\n  width: 30px;\n  height: 22px;\n  color: rgba(255, 255, 255, 0.6);\n  opacity: 0.6;\n}\n.playkit-player .playkit-cast-box .playkit-cast-connecting-spinner {\n  height: 21px;\n  width: 21px;\n  -webkit-animation: playkit-spin 0.9s infinite linear;\n  border: 3px solid rgba(255, 255, 255, 0.4);\n  border-top-color: rgba(255, 255, 255, 0.8);\n  border-radius: 100%;\n}\n.playkit-player .playkit-cast-box .playkit-cast-text {\n  position: absolute;\n  bottom: 0;\n  left: 89px;\n  height: 128px;\n  font-weight: lighter;\n}\n.playkit-player .playkit-cast-box .playkit-cast-text .playkit-cast-status {\n  display: inline-block;\n  margin-top: 3px;\n  font-size: 16px;\n  color: rgba(255, 255, 255, 0.6);\n  float: left;\n  font-weight: inherit;\n}\n.playkit-player .playkit-cast-box .playkit-cast-text .playkit-cast-device {\n  left: 0;\n  display: inline-block;\n  font-weight: inherit;\n  font-size: 25px;\n  color: #ffffff;\n  line-height: 40px;\n}\n\n@keyframes playkit-castOnTVAnimation {\n  0% {\n    opacity: 0;\n    transform: rotateY(70deg);\n  }\n  33% {\n    opacity: 0.3;\n    transform: rotateY(50deg);\n  }\n  66% {\n    opacity: 0.6;\n    transform: rotateY(30deg);\n  }\n  100% {\n    opacity: 1;\n    transform: rotateY(0);\n  }\n}\n.playkit-player .playkit-cast-on-tv-button-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n}\n.playkit-player .playkit-cast-on-tv-button-container span {\n  font-weight: lighter;\n  color: white;\n}\n.playkit-player .playkit-cast-on-tv-button-container.playkit-show-cast-on-tv {\n  animation: playkit-castOnTVAnimation 300ms linear forwards;\n}\n.playkit-player .playkit-btn.playkit-cast-on-tv-button {\n  font-size: 15px;\n  max-width: 200px;\n  transition: max-width 200ms;\n  padding: 0 16px;\n  white-space: nowrap;\n  position: absolute;\n  bottom: 0;\n  transform: translate(-50%, -50%);\n  left: 50%;\n}\n.playkit-player .playkit-btn.playkit-cast-on-tv-button span {\n  transform: translateX(0px);\n  opacity: 1;\n  transition: transform 100ms, opacity 100ms;\n  display: inline-block;\n}\n.playkit-player .playkit-cast-on-tv-icon-container {\n  width: 32px;\n  height: 32px;\n  display: inline-block;\n  vertical-align: top;\n  position: relative;\n  margin-right: 3px;\n}\n.playkit-player .playkit-cast-on-tv-icon-container i {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview {\n  position: absolute;\n  bottom: 35px;\n  width: 280px;\n  height: 72px;\n  display: flex;\n  border-radius: 4px;\n  box-shadow: 0px 0px 0px 1px rgba(0, 0, 0, 0.2), 0px 8px 60px -16px rgba(0, 0, 0, 0.2);\n  opacity: 0;\n  transition: 400ms opacity;\n  pointer-events: none;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview:hover {\n  opacity: 0 !important;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-img {\n  width: 128px;\n  height: inherit;\n  border-radius: 4px 0 0 4px;\n  background-size: contain;\n  background-repeat: round;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-text {\n  width: 152px;\n  height: inherit;\n  padding: 8px;\n  background-color: rgba(0, 0, 0, 0.7);\n  border-radius: 0 4px 4px 0;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-text .playkit-poster-preview-text-title {\n  font-size: 14px;\n  font-weight: 400;\n  margin-bottom: 3px;\n  opacity: 0.7;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-text .playkit-poster-preview-text-name {\n  font-size: 15px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-weight: 400;\n}\n.playkit-control-button-container.playkit-control-playlist-button:hover .playkit-poster-preview {\n  opacity: 1;\n}\n\n.playkit-icon-picture-in-picture-stop {\n  display: none;\n}\n\n.playkit-is-in-picture-in-picture .playkit-icon-picture-in-picture-start {\n  display: none;\n}\n.playkit-is-in-picture-in-picture .playkit-icon-picture-in-picture-stop {\n  display: block;\n}\n\n.playkit-player-gui > .playkit-playback-controls,\n.playkit-center-playback-controls {\n  display: none;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  -webkit-transform: translate(-50%, -50%);\n  -ms-transform: translate(-50%, -50%);\n  white-space: nowrap;\n  z-index: 1;\n}\n\n.playkit-bottom-bar .playkit-playback-controls {\n  display: inline;\n}\n\n.playkit-player.playkit-size-sm.playkit-state-idle .playkit-control-playlist-button, .playkit-player.playkit-size-xs.playkit-state-idle .playkit-control-playlist-button, .playkit-player.playkit-touch.playkit-state-idle .playkit-control-playlist-button {\n  display: none;\n}\n.playkit-player.playkit-size-sm:has(.playkit-pre-playback-play-overlay) .playkit-center-playback-controls, .playkit-player.playkit-size-xs:has(.playkit-pre-playback-play-overlay) .playkit-center-playback-controls, .playkit-player.playkit-touch:has(.playkit-pre-playback-play-overlay) .playkit-center-playback-controls {\n  display: none !important;\n}\n.playkit-player.playkit-size-sm:not(.playkit-state-idle) .playkit-bottom-bar .playkit-playback-controls, .playkit-player.playkit-size-xs:not(.playkit-state-idle) .playkit-bottom-bar .playkit-playback-controls, .playkit-player.playkit-touch:not(.playkit-state-idle) .playkit-bottom-bar .playkit-playback-controls {\n  display: none;\n}\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls:not(.playkit-image),\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls:not(.playkit-image), .playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls:not(.playkit-image),\n.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls:not(.playkit-image), .playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls:not(.playkit-image),\n.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls:not(.playkit-image) {\n  display: block;\n}\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls:not(.playkit-image) .playkit-control-button,\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls:not(.playkit-image) .playkit-control-button, .playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls:not(.playkit-image) .playkit-control-button,\n.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls:not(.playkit-image) .playkit-control-button, .playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls:not(.playkit-image) .playkit-control-button,\n.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls:not(.playkit-image) .playkit-control-button {\n  width: auto;\n  height: auto;\n  padding: 0 16px;\n  -webkit-filter: drop-shadow(0px 0px 8px rgba(0, 0, 0, 0.5));\n  filter: drop-shadow(0px 0px 8px rgba(0, 0, 0, 0.5));\n}\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls:not(.playkit-image) .playkit-icon,\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls:not(.playkit-image) .playkit-icon, .playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls:not(.playkit-image) .playkit-icon,\n.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls:not(.playkit-image) .playkit-icon, .playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls:not(.playkit-image) .playkit-icon,\n.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls:not(.playkit-image) .playkit-icon {\n  width: 64px;\n  height: 64px;\n}\n.playkit-player.playkit-overlay-active .playkit-gui-area .playkit-playback-controls {\n  opacity: 0;\n  visibility: hidden;\n}\n\n@keyframes playkit-slideIn {\n  0% {\n    right: -160px;\n  }\n  100% {\n    right: 0;\n  }\n}\n.playkit-player .playkit-playlist-countdown {\n  display: flex;\n  height: 72px;\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  border-radius: 4px;\n  transition: opacity 400ms, bottom 300ms;\n  cursor: pointer;\n  box-shadow: 0px 0px 0px 1px rgba(0, 0, 0, 0.2), 0px 8px 60px -16px rgba(0, 0, 0, 0.2);\n}\n.playkit-player .playkit-playlist-countdown.playkit-slideIn {\n  right: -160px;\n  animation: playkit-slideIn 500ms 500ms forwards;\n}\n.playkit-player .playkit-playlist-countdown.playkit-hidden {\n  pointer-events: none;\n  opacity: 0;\n}\n.playkit-player .playkit-playlist-countdown.playkit-hidden .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background {\n  width: 0;\n}\n.playkit-player .playkit-playlist-countdown.playkit-hidden .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content {\n  opacity: 0;\n}\n.playkit-player .playkit-playlist-countdown.playkit-canceled {\n  bottom: -50px;\n  opacity: 0;\n}\n.playkit-player .playkit-playlist-countdown:hover .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background {\n  background-color: #000000;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-poster {\n  width: 128px;\n  height: inherit;\n  border-radius: 4px 0 0 4px;\n  background-size: contain;\n  background-repeat: round;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder {\n  width: 152px;\n  height: inherit;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background {\n  width: inherit;\n  border-radius: 0 4px 3px 0;\n  background-color: rgba(0, 0, 0, 0.7);\n  height: inherit;\n  transition: width 500ms 1000ms;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content {\n  width: inherit;\n  transition: opacity 300ms 1200ms;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text {\n  width: 100%;\n  padding: 10px;\n  font-size: 14px;\n  font-weight: 400;\n  text-align: left;\n  color: #fff;\n  float: left;\n  line-height: initial;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title {\n  margin-bottom: 12px;\n  opacity: 0.7;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title .playkit-playlist-countdown-time-left {\n  display: inline;\n  margin-left: 4px;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel {\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  width: 24px;\n  height: 24px;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel * {\n  width: inherit;\n  height: inherit;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown {\n  height: 54px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-poster {\n  width: 96px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder {\n  width: 152px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text {\n  padding: 8px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title {\n  margin-bottom: 4px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel {\n  top: 3px;\n  right: 3px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown, .playkit-player.playkit-size-xs .playkit-playlist-countdown, .playkit-player.playkit-size-ty .playkit-playlist-countdown {\n  z-index: 1;\n  height: 36px;\n  margin: 8px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-poster, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-poster, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-poster {\n  display: none;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder {\n  width: 108px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background {\n  transition: width 500ms;\n  border-radius: 2px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text {\n  width: 90%;\n  padding: 3px 0 0 4px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title {\n  font-size: 12px;\n  margin-bottom: 0;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name {\n  font-size: 12px;\n  font-weight: 400;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel {\n  top: 0;\n  right: 0;\n}\n\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content {\n  position: relative;\n  top: 50%;\n  transform: translateY(-50%);\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text {\n  position: absolute;\n  width: 100%;\n  top: -90px;\n  font-size: 15px;\n  color: #fff;\n  padding: 4px 8px 12px 8px;\n  text-align: center;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text .playkit-playlist-next-screen-text-title {\n  padding: 4px;\n  font-weight: 100;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text .playkit-playlist-next-screen-text-name {\n  padding: 16px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder {\n  position: relative;\n  margin: auto;\n  width: 384px;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio {\n  width: 100%;\n  padding-top: 56%;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  cursor: pointer;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img {\n  height: 100%;\n  border-radius: 3px;\n  background-size: contain;\n  background-repeat: round;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 64px;\n  height: 64px;\n}\n.playkit-player.playkit-state-idle.playkit-size-lg .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder {\n  width: 37.5%;\n}\n.playkit-player.playkit-state-idle.playkit-size-md .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text {\n  top: -58px;\n}\n.playkit-player.playkit-state-idle.playkit-size-md .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text .playkit-playlist-next-screen-text-name {\n  padding: 0;\n}\n.playkit-player.playkit-state-idle.playkit-size-md .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder {\n  width: 42%;\n}\n.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder, .playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder, .playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder {\n  width: 32px;\n}\n.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster, .playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster, .playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster {\n  border: 0;\n}\n.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img, .playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img, .playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img {\n  display: none;\n}\n.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon, .playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon, .playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon {\n  width: 32px;\n  height: 32px;\n}\n\n.playkit-picture-in-picture-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-poster {\n  all: inherit;\n  background-size: contain;\n  background: black no-repeat center center;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-poster.playkit-has-poster {\n  background-color: #000;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-poster .playkit-dark-layer {\n  background-color: rgba(0, 0, 0, 0.4);\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-control {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-control::after {\n  content: \"\";\n  flex: 3;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-control::before {\n  content: \"\";\n  flex: 1;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-text {\n  color: var(--playkit-tone-1-color);\n  font-size: 18px;\n  white-space: nowrap;\n  overflow: hidden;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-button {\n  height: 36px;\n  width: 120px;\n  border: 2px solid var(--playkit-tone-6-color);\n  border-radius: 18px;\n  background-color: var(--playkit-tone-7-color);\n  color: var(--playkit-tone-1-color);\n  font-size: 15px;\n  font-weight: bold;\n  line-height: 30px;\n  cursor: pointer;\n  margin-top: 20px;\n  align-self: center;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-button:hover {\n  background-color: var(--playkit-tone-6-color);\n}\n\n.playkit-copy-url-row .playkit-input-copy-url {\n  margin: 0;\n}\n.playkit-copy-url-row .playkit-btn-copy-url {\n  margin: 0 8px;\n}\n.playkit-copy-url-row .playkit-btn-copy-url .playkit-icon {\n  height: 24px;\n  width: 24px;\n  margin-top: -3px;\n  display: none;\n}\n.playkit-copy-url-row .playkit-btn-copy-url .playkit-icon-copy {\n  display: block;\n}\n.playkit-copy-url-row .playkit-btn-copy-url.playkit-copied .playkit-icon-copy {\n  display: none;\n}\n.playkit-copy-url-row .playkit-btn-copy-url.playkit-copied .playkit-icon-check {\n  display: block;\n}\n\n.playkit-IE.playkit-player .playkit-tooltip .playkit-tooltip-label {\n  white-space: nowrap;\n}\n\n.playkit-player .playkit-tooltip {\n  position: relative;\n  display: inline-block;\n  height: 100%;\n  width: 100%;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label {\n  visibility: hidden;\n  background-color: var(--playkit-tooltip-background-color);\n  color: var(--playkit-tooltip-color);\n  text-align: center;\n  padding: 4px 6px;\n  border-radius: 4px;\n  position: absolute;\n  line-height: normal;\n  font-weight: bold;\n  font-size: 13px;\n  opacity: 0;\n  transition: opacity 1s;\n  width: max-content;\n  display: table;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label:before {\n  content: \"\";\n  position: absolute;\n  border-width: 5px;\n  border-style: solid;\n  border-radius: 3px;\n  color: var(--playkit-tooltip-background-color);\n  z-index: -1;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label:after {\n  content: \"\";\n  position: absolute;\n  inset: -1em;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top {\n  bottom: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-50%);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top:before {\n  bottom: -4px;\n  left: 50%;\n  transform: translate(-50%) rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-left {\n  bottom: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-100%);\n  margin-left: 16px;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-left:before {\n  bottom: -4px;\n  right: 0;\n  margin-right: 11px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-right {\n  bottom: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-16px);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-right:before {\n  bottom: -4px;\n  left: 0;\n  margin-left: 11px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom {\n  top: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-50%);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom:before {\n  top: -4px;\n  left: 50%;\n  margin-left: -5px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-right {\n  top: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-16px);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-right:before {\n  top: -4px;\n  left: 0;\n  margin-left: 11px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-left {\n  top: calc(100% + 10px);\n  transform: translate(-100%);\n  left: 50%;\n  margin-left: 16px;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-left:before {\n  top: -4px;\n  right: 0;\n  margin-right: 11px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-left {\n  top: 50%;\n  right: calc(100% + 10px);\n  transform: translate(0, -50%);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-left:before {\n  top: 50%;\n  left: 100%;\n  margin-left: -6px;\n  margin-top: -5px;\n  transform: rotate(135deg) skew(10deg, 10deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-right {\n  top: 50%;\n  left: calc(100% + 10px);\n  transform: translate(0, -50%);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-right:before {\n  top: 50%;\n  right: 100%;\n  margin-top: -5px;\n  margin-right: -6px;\n  transform: rotate(135deg) skew(10deg, 10deg);\n}\n\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-show {\n  visibility: visible;\n  opacity: 1;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-hide {\n  transition: opacity 0.15s ease-in-out;\n}\n\n.playkit-side-panel {\n  position: absolute;\n  transition: all 500ms;\n  transition-property: left, right, bottom, top, opacity;\n  z-index: 1;\n}\n.playkit-side-panel.playkit-small-size {\n  z-index: 2;\n}\n\n.playkit-vertical-side-panel {\n  height: 100%;\n}\n\n.playkit-horizontal-side-panel {\n  height: 0;\n  left: 0;\n  right: 0;\n}\n\n.playkit-side-panel-content {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n\n.playkit-player.playkit-overlay-active .playkit-interactive-area {\n  filter: blur(16px);\n}\n\n.playkit-interactive-area {\n  pointer-events: none;\n  position: relative;\n  top: 0;\n  margin: 16px;\n  transition: margin 100ms ease-in-out;\n  flex: 1;\n}\n\n.playkit-player.playkit-size-sm .playkit-interactive-area {\n  margin: 8px;\n}\n.playkit-player.playkit-casting:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-state-paused:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-state-idle:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-ad-break:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-menu-active:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area {\n  margin: 0px 8px;\n}\n.playkit-player.playkit-casting .playkit-interactive-area, .playkit-player.playkit-metadata-loaded.playkit-hover .playkit-interactive-area, .playkit-player.playkit-state-paused .playkit-interactive-area, .playkit-player.playkit-state-idle .playkit-interactive-area, .playkit-player.playkit-ad-break .playkit-interactive-area, .playkit-player.playkit-menu-active .playkit-interactive-area {\n  margin: 0px 16px;\n}\n\n.playkit-video-area {\n  pointer-events: none;\n  transition: all 500ms;\n  transition-property: left, right, bottom, top, width, height;\n}\n\n.playkit-gui-area {\n  pointer-events: none;\n  transition: all 500ms;\n  transition-property: left, right, bottom, top;\n  display: flex;\n  flex-flow: column nowrap;\n}\n\n@keyframes playkit-kaltura-spinner {\n  0% {\n    transform: rotate(0deg) scale(0.7);\n    opacity: 1;\n  }\n  70% {\n    transform: rotate(360deg) scale(0.7);\n    opacity: 1;\n  }\n  82% {\n    transform: rotate(360deg) scale(0);\n    opacity: 0;\n  }\n  87% {\n    transform: rotate(360deg) scale(0.9);\n    opacity: 1;\n  }\n  100% {\n    transform: rotate(360deg) scale(0.7);\n    opacity: 1;\n  }\n}\n.playkit-spinner {\n  width: 100px;\n  height: 100px;\n  position: relative;\n  animation: playkit-kaltura-spinner 2.5s infinite;\n}\n.playkit-spinner span {\n  width: 8px;\n  height: 8px;\n  background-color: #fff;\n  display: block;\n  border-radius: 8px;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin-top: -4px;\n  margin-left: -4px;\n}\n.playkit-spinner span:nth-child(1) {\n  transform: rotate(45deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(218, 31, 38);\n}\n.playkit-spinner span:nth-child(2) {\n  transform: rotate(90deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(6, 168, 133);\n}\n.playkit-spinner span:nth-child(3) {\n  transform: rotate(135deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(0, 147, 68);\n}\n.playkit-spinner span:nth-child(4) {\n  transform: rotate(180deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(248, 166, 26);\n}\n.playkit-spinner span:nth-child(5) {\n  transform: rotate(225deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(27, 74, 151);\n}\n.playkit-spinner span:nth-child(6) {\n  transform: rotate(270deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(0, 171, 204);\n}\n.playkit-spinner span:nth-child(7) {\n  transform: rotate(315deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(177, 210, 56);\n}\n.playkit-spinner span:nth-child(8) {\n  transform: rotate(360deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(252, 210, 3);\n}\n\n.playkit-sr-only {\n  position: absolute;\n  left: -10000px;\n  top: auto;\n  width: 1px;\n  height: 1px;\n  overflow: hidden;\n}\n\n.playkit-switch {\n  position: relative;\n  display: inline-block;\n  width: 32px;\n  height: 16px;\n}\n.playkit-switch .playkit-toggle-input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n.playkit-switch .playkit-toggle-input:checked + .playkit-slider {\n  background-color: #2196f3;\n}\n.playkit-switch .playkit-toggle-input:focus + .playkit-slider {\n  box-shadow: 0 0 1px #2196f3;\n}\n.playkit-switch .playkit-toggle-input:checked + .playkit-slider:before {\n  transform: translateX(14px);\n  -webkit-transform: translateX(14px);\n  -ms-transform: translateX(14px);\n}\n.playkit-switch .playkit-slider {\n  height: 100%;\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #ccc;\n  -webkit-transition: 0.4s;\n  transition: 0.4s;\n  border-radius: 34px;\n}\n.playkit-switch .playkit-slider:before {\n  position: absolute;\n  content: \"\";\n  height: 12px;\n  width: 12px;\n  left: 3px;\n  top: 2px;\n  background-color: white;\n  -webkit-transition: 0.3s;\n  transition: 0.3s;\n  border-radius: 50%;\n}\n\n.playkit-player .playkit-audio-entry-backdrop {\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.7) 100%);\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  width: 100%;\n  pointer-events: none;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details {\n  margin: 128px 16px 60px 16px;\n  left: 16px;\n  color: white;\n  max-height: 100%;\n  pointer-events: auto;\n  z-index: 1;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details.playkit-audio-entry-l {\n  max-width: 600px;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details.playkit-audio-entry-m {\n  max-width: min(600px, 100%);\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details.playkit-audio-entry-t {\n  max-width: 0px;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details.playkit-audio-entry-t .playkit-audio-entry-description {\n  font-size: 0;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details .playkit-audio-entry-title {\n  font-size: 32px;\n  line-height: 38px;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details .playkit-audio-entry-title.playkit-audio-entry-title-trimmed {\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n  display: -webkit-box;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details .playkit-audio-entry-description {\n  font-size: 14px;\n  line-height: 18px;\n}\n.playkit-player .playkit-audio-entry-backdrop.playkit-audio-entry-expanded {\n  overflow: auto;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.7) 100%);\n  height: auto;\n}\n.playkit-player .playkit-audio-entry-backdrop.playkit-audio-entry-expanded .playkit-audio-entry-details {\n  overflow: auto;\n  margin: 60px 16px;\n}\n\n.playkit-player .playkit-expandable-text {\n  text-overflow: ellipsis;\n  overflow: hidden;\n  -webkit-box-orient: vertical;\n  display: -webkit-box;\n}\n.playkit-player .playkit-more-button-text {\n  pointer-events: auto;\n  cursor: pointer;\n  position: relative;\n  z-index: 1;\n  width: fit-content;\n  outline-offset: -1px;\n}\n\n.playkit-scrollable {\n  display: flex;\n  width: 100%;\n}\n.playkit-scrollable .playkit-items-container {\n  display: flex;\n  width: 100%;\n  height: fit-content;\n}\n.playkit-scrollable.playkit-horizontal {\n  flex-direction: row;\n  overflow: auto hidden;\n}\n.playkit-scrollable.playkit-horizontal .playkit-items-container {\n  flex-direction: row;\n}\n.playkit-scrollable.playkit-vertical {\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden auto;\n}\n.playkit-scrollable.playkit-vertical .playkit-items-container {\n  flex-direction: column;\n}\n.playkit-scrollable::-webkit-scrollbar {\n  height: 4px;\n  width: 4px;\n}\n.playkit-scrollable::-webkit-scrollbar-track {\n  visibility: hidden;\n}\n.playkit-scrollable::-webkit-scrollbar-thumb {\n  background-color: rgba(255, 255, 255, 0.3);\n  border-radius: 3px;\n  visibility: hidden;\n}\n.playkit-scrollable.playkit-scrolling::-webkit-scrollbar-track, .playkit-scrollable.playkit-scrolling::-webkit-scrollbar-thumb {\n  visibility: visible;\n}\n\n.playkit-context-menu {\n  position: absolute;\n  z-index: 999;\n  display: flex;\n  align-items: center;\n  height: 40px;\n  width: 260px;\n  padding: 8px 16px;\n  box-shadow: 0px 4px 30px -8px rgba(0, 0, 0, 0.2), 0px 0px 0px 1px rgba(0, 0, 0, 0.2);\n  color: white;\n  background-color: rgb(51, 51, 51);\n  border-radius: 4px;\n  font-family: Lato, Helvetica Neue, Segoe UI, sans-serif;\n}\n.playkit-context-menu.playkit-hidden {\n  display: none;\n}\n.playkit-context-menu .playkit-context-menu-item {\n  cursor: pointer;\n}",""]),e.locals={primaryColor:"var(--playkit-primary-color)",primaryDarkerColor:"var(--playkit-primary-darker-color)",primaryBrighterColor:"var(--playkit-primary-brighter-color)",primaryTextContrastColor:"var(--playkit-primary-text-contrast-color)",secondaryColor:"var(--playkit-secondary-color)",secondaryDarkerColor:"var(--playkit-secondary-darker-color)",secondaryBrighterColor:"var(--playkit-secondary-brighter-color)",secondaryTextContrastColor:"var(--playkit-secondary-text-contrast-color)",successDarkerColor:"var(--playkit-success-darker-color)",successBrighterColor:"var(--playkit-success-brighter-color)",successTextContrastColor:"var(--playkit-success-text-contrast-color)",dangerColor:"var(--playkit-danger-color)",dangerDarkerColor:"var(--playkit-danger-darker-color)",dangerBrighterColor:"var(--playkit-danger-brighter-color)","danger-text-contrast-color":"var(--playkit-danger-text-contrast-color)",dangerTextContrastColor:"var(--playkit-danger-text-contrast-color)",warningColor:"var(--playkit-warning-color)",warningDarkerColor:"var(--playkit-warning-darker-color)",warningBrighterColor:"var(--playkit-warning-brighter-color)",warningTextContrastColor:"var(--playkit-warning-text-contrast-color)",tone1Color:"var(--playkit-tone-1-color)",tone2Color:"var(--playkit-tone-2-color)",tone3Color:"var(--playkit-tone-3-color)",tone4Color:"var(--playkit-tone-4-color)",tone5Color:"var(--playkit-tone-5-color)",tone6Color:"var(--playkit-tone-6-color)",tone7Color:"var(--playkit-tone-7-color)",tone8Color:"var(--playkit-tone-8-color)",liveColor:"var(--playkit-live-color)",playerBackgroundColor:"var(--playkit-player-background-color)",tabFocusColor:"var(--playkit-tab-focus-color)",tooltipBackgroundColor:"var(--playkit-tooltip-background-color)",tooltipColor:"var(--playkit-tooltip-color)",adsColor:"var(--playkit-ads-color)",progressBarHeight:"4px",progressBarBorderRadius:"2px",defaultTransitionTime:"500",bottomBarMaxHeight:"60",topBarMaxHeight:"75",contextMenuHeight:"40",contextMenuWidth:"260",brandColor:"#006bff",white:"#ffffff",player:"playkit-player",row:"playkit-row","d-inline-block":"playkit-d-inline-block",dInlineBlock:"playkit-d-inline-block","mobile-hidden-select":"playkit-mobile-hidden-select",mobileHiddenSelect:"playkit-mobile-hidden-select","font-size-base":"playkit-font-size-base",fontSizeBase:"playkit-font-size-base","ad-notice":"playkit-ad-notice",adNotice:"playkit-ad-notice","form-group":"playkit-form-group",formGroup:"playkit-form-group","has-error":"playkit-has-error",hasError:"playkit-has-error","form-control":"playkit-form-control",formControl:"playkit-form-control","has-icon":"playkit-has-icon",hasIcon:"playkit-has-icon",icon:"playkit-icon",checkbox:"playkit-checkbox","form-group-row":"playkit-form-group-row",formGroupRow:"playkit-form-group-row",dropdown:"playkit-dropdown",btn:"playkit-btn","btn-block":"playkit-btn-block",btnBlock:"playkit-btn-block","btn-dark-transparent":"playkit-btn-dark-transparent",btnDarkTransparent:"playkit-btn-dark-transparent","btn-branded":"playkit-btn-branded",btnBranded:"playkit-btn-branded","btn-rounded":"playkit-btn-rounded",btnRounded:"playkit-btn-rounded","btn-borderless":"playkit-btn-borderless",btnBorderless:"playkit-btn-borderless","only-icon":"playkit-only-icon",onlyIcon:"playkit-only-icon","only-label":"playkit-only-label",onlyLabel:"playkit-only-label","btn-translucent":"playkit-btn-translucent",btnTranslucent:"playkit-btn-translucent","size-sm":"playkit-size-sm",sizeSm:"playkit-size-sm","size-xs":"playkit-size-xs",sizeXs:"playkit-size-xs","badge-icon":"playkit-badge-icon",badgeIcon:"playkit-badge-icon","icon-maximize":"playkit-icon-maximize",iconMaximize:"playkit-icon-maximize","icon-minimize":"playkit-icon-minimize",iconMinimize:"playkit-icon-minimize","icon-play":"playkit-icon-play",iconPlay:"playkit-icon-play","icon-pause":"playkit-icon-pause",iconPause:"playkit-icon-pause","icon-stop":"playkit-icon-stop",iconStop:"playkit-icon-stop","icon-volume-base":"playkit-icon-volume-base",iconVolumeBase:"playkit-icon-volume-base","icon-volume-waves":"playkit-icon-volume-waves",iconVolumeWaves:"playkit-icon-volume-waves","icon-volume-wave":"playkit-icon-volume-wave",iconVolumeWave:"playkit-icon-volume-wave","icon-volume-mute":"playkit-icon-volume-mute",iconVolumeMute:"playkit-icon-volume-mute","icon-close":"playkit-icon-close",iconClose:"playkit-icon-close","icon-settings":"playkit-icon-settings",iconSettings:"playkit-icon-settings","icon-check":"playkit-icon-check",iconCheck:"playkit-icon-check","icon-check-active":"playkit-icon-check-active",iconCheckActive:"playkit-icon-check-active","icon-language":"playkit-icon-language",iconLanguage:"playkit-icon-language","icon-quality":"playkit-icon-quality",iconQuality:"playkit-icon-quality","icon-captions":"playkit-icon-captions",iconCaptions:"playkit-icon-captions","icon-speed":"playkit-icon-speed",iconSpeed:"playkit-icon-speed","icon-speed-down":"playkit-icon-speed-down",iconSpeedDown:"playkit-icon-speed-down","icon-speed-up":"playkit-icon-speed-up",iconSpeedUp:"playkit-icon-speed-up","icon-audio":"playkit-icon-audio",iconAudio:"playkit-icon-audio","icon-arrow-down":"playkit-icon-arrow-down",iconArrowDown:"playkit-icon-arrow-down","icon-start-over":"playkit-icon-start-over",iconStartOver:"playkit-icon-start-over","icon-seek-end":"playkit-icon-seek-end",iconSeekEnd:"playkit-icon-seek-end","icon-rewind":"playkit-icon-rewind",iconRewind:"playkit-icon-rewind","icon-rewind-10":"playkit-icon-rewind-10",iconRewind10:"playkit-icon-rewind-10","icon-forward":"playkit-icon-forward",iconForward:"playkit-icon-forward","icon-forward-10":"playkit-icon-forward-10",iconForward10:"playkit-icon-forward-10","icon-vr-stereo":"playkit-icon-vr-stereo",iconVrStereo:"playkit-icon-vr-stereo","icon-vr-stereo-full":"playkit-icon-vr-stereo-full",iconVrStereoFull:"playkit-icon-vr-stereo-full","icon-chromecast":"playkit-icon-chromecast",iconChromecast:"playkit-icon-chromecast","icon-chromecast-brand":"playkit-icon-chromecast-brand",iconChromecastBrand:"playkit-icon-chromecast-brand","icon-next":"playkit-icon-next",iconNext:"playkit-icon-next","icon-prev":"playkit-icon-prev",iconPrev:"playkit-icon-prev","icon-picture-in-picture-start":"playkit-icon-picture-in-picture-start",iconPictureInPictureStart:"playkit-icon-picture-in-picture-start","icon-picture-in-picture-stop":"playkit-icon-picture-in-picture-stop",iconPictureInPictureStop:"playkit-icon-picture-in-picture-stop","icon-advanced-audio-description":"playkit-icon-advanced-audio-description",iconAdvancedAudioDescription:"playkit-icon-advanced-audio-description","icon-advanced-audio-description-active":"playkit-icon-advanced-audio-description-active",iconAdvancedAudioDescriptionActive:"playkit-icon-advanced-audio-description-active","icon-quality-hd":"playkit-icon-quality-hd",iconQualityHd:"playkit-icon-quality-hd","icon-quality-hd-active":"playkit-icon-quality-hd-active",iconQualityHdActive:"playkit-icon-quality-hd-active","icon-quality-4k":"playkit-icon-quality-4k",iconQuality4K:"playkit-icon-quality-4k","icon-quality-4k-active":"playkit-icon-quality-4k-active",iconQuality4KActive:"playkit-icon-quality-4k-active","icon-quality-8k":"playkit-icon-quality-8k",iconQuality8K:"playkit-icon-quality-8k","icon-quality-8k-active":"playkit-icon-quality-8k-active",iconQuality8KActive:"playkit-icon-quality-8k-active","icon-closed-captions-on":"playkit-icon-closed-captions-on",iconClosedCaptionsOn:"playkit-icon-closed-captions-on","icon-closed-captions-off":"playkit-icon-closed-captions-off",iconClosedCaptionsOff:"playkit-icon-closed-captions-off","label-badge":"playkit-label-badge",labelBadge:"playkit-label-badge",active:"playkit-active","dropdown-menu":"playkit-dropdown-menu",dropdownMenu:"playkit-dropdown-menu","dropdown-button":"playkit-dropdown-button",dropdownButton:"playkit-dropdown-button",openDropmenu:"playkit-openDropmenu",top:"playkit-top",bottom:"playkit-bottom",right:"playkit-right",left:"playkit-left","stick-bottom":"playkit-stick-bottom",stickBottom:"playkit-stick-bottom","dropdown-menu-item":"playkit-dropdown-menu-item",dropdownMenuItem:"playkit-dropdown-menu-item","menu-icon-container":"playkit-menu-icon-container",menuIconContainer:"playkit-menu-icon-container","dropdown-menu-additional-options":"playkit-dropdown-menu-additional-options",dropdownMenuAdditionalOptions:"playkit-dropdown-menu-additional-options","smart-container":"playkit-smart-container",smartContainer:"playkit-smart-container","control-button":"playkit-control-button",controlButton:"playkit-control-button","button-badge":"playkit-button-badge",buttonBadge:"playkit-button-badge","control-button-rounded":"playkit-control-button-rounded",controlButtonRounded:"playkit-control-button-rounded",touch:"playkit-touch","control-button-container":"playkit-control-button-container",controlButtonContainer:"playkit-control-button-container","state-idle":"playkit-state-idle",stateIdle:"playkit-state-idle","no-idle-control":"playkit-no-idle-control",noIdleControl:"playkit-no-idle-control",rotate:"playkit-rotate",spin:"playkit-spin","reverse-rotate":"playkit-reverse-rotate",reverseRotate:"playkit-reverse-rotate","reverse-spin":"playkit-reverse-spin",reverseSpin:"playkit-reverse-spin","upper-bar-icon":"playkit-upper-bar-icon",upperBarIcon:"playkit-upper-bar-icon",emptyUrl:"playkit-emptyUrl","player-gui":"playkit-player-gui",playerGui:"playkit-player-gui","overlay-active":"playkit-overlay-active",overlayActive:"playkit-overlay-active",protected:"playkit-protected",nav:"playkit-nav","ad-break":"playkit-ad-break",adBreak:"playkit-ad-break","metadata-loaded":"playkit-metadata-loaded",metadataLoaded:"playkit-metadata-loaded",hover:"playkit-hover","state-paused":"playkit-state-paused",statePaused:"playkit-state-paused","pre-playback":"playkit-pre-playback",prePlayback:"playkit-pre-playback",casting:"playkit-casting","menu-active":"playkit-menu-active",menuActive:"playkit-menu-active",iOS:"playkit-iOS",iOs:"playkit-iOS",Safari:"playkit-Safari",safari:"playkit-Safari",fullscreen:"playkit-fullscreen","video-player":"playkit-video-player",videoPlayer:"playkit-video-player",overlay:"playkit-overlay",openOverlay:"playkit-openOverlay","overlay-contents":"playkit-overlay-contents",overlayContents:"playkit-overlay-contents",title:"playkit-title","close-overlay":"playkit-close-overlay",closeOverlay:"playkit-close-overlay","overlay-screen":"playkit-overlay-screen",overlayScreen:"playkit-overlay-screen","size-md":"playkit-size-md",sizeMd:"playkit-size-md",openSmartContainer:"playkit-openSmartContainer",leaving:"playkit-leaving",closeSmartContainer:"playkit-closeSmartContainer","smart-container-item":"playkit-smart-container-item",smartContainerItem:"playkit-smart-container-item","select-menu-item":"playkit-select-menu-item",selectMenuItem:"playkit-select-menu-item","label-icon":"playkit-label-icon",labelIcon:"playkit-label-icon",Windows:"playkit-Windows",windows:"playkit-Windows","cvaa-overlay":"playkit-cvaa-overlay",cvaaOverlay:"playkit-cvaa-overlay",sample:"playkit-sample",custom:"playkit-custom","black-bg":"playkit-black-bg",blackBg:"playkit-black-bg","yellow-text":"playkit-yellow-text",yellowText:"playkit-yellow-text","active-tick":"playkit-active-tick",activeTick:"playkit-active-tick","button-save-cvaa":"playkit-button-save-cvaa",buttonSaveCvaa:"playkit-button-save-cvaa","button-edit-cvaa":"playkit-button-edit-cvaa",buttonEditCvaa:"playkit-button-edit-cvaa","custom-captions-applied":"playkit-custom-captions-applied",customCaptionsApplied:"playkit-custom-captions-applied","custom-caption-form":"playkit-custom-caption-form",customCaptionForm:"playkit-custom-caption-form",slider:"playkit-slider","preview-container":"playkit-preview-container",previewContainer:"playkit-preview-container","font-size":"playkit-font-size",fontSize:"playkit-font-size","font-alignment":"playkit-font-alignment",fontAlignment:"playkit-font-alignment","font-color":"playkit-font-color",fontColor:"playkit-font-color","font-family":"playkit-font-family",fontFamily:"playkit-font-family","font-style":"playkit-font-style",fontStyle:"playkit-font-style","font-opacity":"playkit-font-opacity",fontOpacity:"playkit-font-opacity","background-color":"playkit-background-color",backgroundColor:"playkit-background-color","background-opacity":"playkit-background-opacity",backgroundOpacity:"playkit-background-opacity","loading-backdrop":"playkit-loading-backdrop",loadingBackdrop:"playkit-loading-backdrop",show:"playkit-show","spinner-container":"playkit-spinner-container",spinnerContainer:"playkit-spinner-container","control-play-pause":"playkit-control-play-pause",controlPlayPause:"playkit-control-play-pause","is-playing":"playkit-is-playing",isPlaying:"playkit-is-playing","control-volume":"playkit-control-volume",controlVolume:"playkit-control-volume","volume-control":"playkit-volume-control",volumeControl:"playkit-volume-control","volume-control-bar":"playkit-volume-control-bar",volumeControlBar:"playkit-volume-control-bar","is-muted":"playkit-is-muted",isMuted:"playkit-is-muted","dragging-active":"playkit-dragging-active",draggingActive:"playkit-dragging-active","volume-button":"playkit-volume-button",volumeButton:"playkit-volume-button",bar:"playkit-bar",progress:"playkit-progress","smart-container-open":"playkit-smart-container-open",smartContainerOpen:"playkit-smart-container-open","control-volume-bar":"playkit-control-volume-bar",controlVolumeBar:"playkit-control-volume-bar","size-ty":"playkit-size-ty",sizeTy:"playkit-size-ty","sr-only":"playkit-sr-only",srOnly:"playkit-sr-only","control-fullscreen":"playkit-control-fullscreen",controlFullscreen:"playkit-control-fullscreen","is-fullscreen":"playkit-is-fullscreen",isFullscreen:"playkit-is-fullscreen","seek-bar":"playkit-seek-bar",seekBar:"playkit-seek-bar","time-preview":"playkit-time-preview",timePreview:"playkit-time-preview","frame-preview":"playkit-frame-preview",framePreview:"playkit-frame-preview","hide-frame-preview":"playkit-hide-frame-preview",hideFramePreview:"playkit-hide-frame-preview","progress-bar":"playkit-progress-bar",progressBar:"playkit-progress-bar",scrubber:"playkit-scrubber","virtual-progress":"playkit-virtual-progress",virtualProgress:"playkit-virtual-progress",chapters:"playkit-chapters","virtual-progress-indicator":"playkit-virtual-progress-indicator",virtualProgressIndicator:"playkit-virtual-progress-indicator","non-sticky":"playkit-non-sticky",nonSticky:"playkit-non-sticky",live:"playkit-live",buffered:"playkit-buffered","frame-preview-img-container":"playkit-frame-preview-img-container",framePreviewImgContainer:"playkit-frame-preview-img-container","frame-preview-img":"playkit-frame-preview-img",framePreviewImg:"playkit-frame-preview-img","time-display":"playkit-time-display",timeDisplay:"playkit-time-display","video-playing-title":"playkit-video-playing-title",videoPlayingTitle:"playkit-video-playing-title","bottom-bar":"playkit-bottom-bar",bottomBar:"playkit-bottom-bar",hide:"playkit-hide","controls-container":"playkit-controls-container",controlsContainer:"playkit-controls-container","left-controls":"playkit-left-controls",leftControls:"playkit-left-controls","right-controls":"playkit-right-controls",rightControls:"playkit-right-controls","bottom-bar-area":"playkit-bottom-bar-area",bottomBarArea:"playkit-bottom-bar-area","playback-controls":"playkit-playback-controls",playbackControls:"playkit-playback-controls","top-bar":"playkit-top-bar",topBar:"playkit-top-bar","top-bar-area":"playkit-top-bar-area",topBarArea:"playkit-top-bar-area",disabled:"playkit-disabled","overlay-action":"playkit-overlay-action",overlayAction:"playkit-overlay-action",in:"playkit-in",overlayActionIconIn:"playkit-overlayActionIconIn","pre-playback-play-overlay":"playkit-pre-playback-play-overlay",prePlaybackPlayOverlay:"playkit-pre-playback-play-overlay",prePlaybackPlayOverlayYoutube:"playkit-prePlaybackPlayOverlayYoutube","pre-playback-play-button":"playkit-pre-playback-play-button",prePlaybackPlayButton:"playkit-pre-playback-play-button","gui-area":"playkit-gui-area",guiArea:"playkit-gui-area","btn-skip-ad":"playkit-btn-skip-ad",btnSkipAd:"playkit-btn-skip-ad","skip-ad":"playkit-skip-ad",skipAd:"playkit-skip-ad","live-tag":"playkit-live-tag",liveTag:"playkit-live-tag","non-live-playhead":"playkit-non-live-playhead",nonLivePlayhead:"playkit-non-live-playhead","unmute-button-container":"playkit-unmute-button-container",unmuteButtonContainer:"playkit-unmute-button-container","show-icon-only":"playkit-show-icon-only",showIconOnly:"playkit-show-icon-only","unmute-button":"playkit-unmute-button",unmuteButton:"playkit-unmute-button","has-top-bar":"playkit-has-top-bar",hasTopBar:"playkit-has-top-bar","unmute-icon-container":"playkit-unmute-icon-container",unmuteIconContainer:"playkit-unmute-icon-container","error-overlay":"playkit-error-overlay",errorOverlay:"playkit-error-overlay","custom-error-slate":"playkit-custom-error-slate",customErrorSlate:"playkit-custom-error-slate","copy-url-row":"playkit-copy-url-row",copyUrlRow:"playkit-copy-url-row",headline:"playkit-headline","error-title":"playkit-error-title",errorTitle:"playkit-error-title","error-message":"playkit-error-message",errorMessage:"playkit-error-message","error-session":"playkit-error-session",errorSession:"playkit-error-session","retry-btn":"playkit-retry-btn",retryBtn:"playkit-retry-btn","error-text":"playkit-error-text",errorText:"playkit-error-text","link-options-container":"playkit-link-options-container",linkOptionsContainer:"playkit-link-options-container","input-copy-url":"playkit-input-copy-url",inputCopyUrl:"playkit-input-copy-url","btn-copy-url":"playkit-btn-copy-url",btnCopyUrl:"playkit-btn-copy-url",handle:"playkit-handle","learn-more":"playkit-learn-more",learnMore:"playkit-learn-more",watermark:"playkit-watermark","hide-watermark":"playkit-hide-watermark",hideWatermark:"playkit-hide-watermark","control-vr-stereo":"playkit-control-vr-stereo",controlVrStereo:"playkit-control-vr-stereo","vr-stereo-mode":"playkit-vr-stereo-mode",vrStereoMode:"playkit-vr-stereo-mode","control-closed-captions":"playkit-control-closed-captions",controlClosedCaptions:"playkit-control-closed-captions","cc-on":"playkit-cc-on",ccOn:"playkit-cc-on","cast-button":"playkit-cast-button",castButton:"playkit-cast-button","cast-button-active":"playkit-cast-button-active",castButtonActive:"playkit-cast-button-active","cast-overlay":"playkit-cast-overlay",castOverlay:"playkit-cast-overlay","cast-poster":"playkit-cast-poster",castPoster:"playkit-cast-poster","has-poster":"playkit-has-poster",hasPoster:"playkit-has-poster","cast-black-cover":"playkit-cast-black-cover",castBlackCover:"playkit-cast-black-cover","cast-box":"playkit-cast-box",castBox:"playkit-cast-box","cast-icon":"playkit-cast-icon",castIcon:"playkit-cast-icon","cast-connecting-spinner":"playkit-cast-connecting-spinner",castConnectingSpinner:"playkit-cast-connecting-spinner","cast-text":"playkit-cast-text",castText:"playkit-cast-text","cast-status":"playkit-cast-status",castStatus:"playkit-cast-status","cast-device":"playkit-cast-device",castDevice:"playkit-cast-device","cast-on-tv-button-container":"playkit-cast-on-tv-button-container",castOnTvButtonContainer:"playkit-cast-on-tv-button-container","show-cast-on-tv":"playkit-show-cast-on-tv",showCastOnTv:"playkit-show-cast-on-tv",castOnTVAnimation:"playkit-castOnTVAnimation",castOnTvAnimation:"playkit-castOnTVAnimation","cast-on-tv-button":"playkit-cast-on-tv-button",castOnTvButton:"playkit-cast-on-tv-button","cast-on-tv-icon-container":"playkit-cast-on-tv-icon-container",castOnTvIconContainer:"playkit-cast-on-tv-icon-container","control-playlist-button":"playkit-control-playlist-button",controlPlaylistButton:"playkit-control-playlist-button","poster-preview":"playkit-poster-preview",posterPreview:"playkit-poster-preview","poster-preview-img":"playkit-poster-preview-img",posterPreviewImg:"playkit-poster-preview-img","poster-preview-text":"playkit-poster-preview-text",posterPreviewText:"playkit-poster-preview-text","poster-preview-text-title":"playkit-poster-preview-text-title",posterPreviewTextTitle:"playkit-poster-preview-text-title","poster-preview-text-name":"playkit-poster-preview-text-name",posterPreviewTextName:"playkit-poster-preview-text-name","is-in-picture-in-picture":"playkit-is-in-picture-in-picture",isInPictureInPicture:"playkit-is-in-picture-in-picture","center-playback-controls":"playkit-center-playback-controls",centerPlaybackControls:"playkit-center-playback-controls",image:"playkit-image","playlist-countdown":"playkit-playlist-countdown",playlistCountdown:"playkit-playlist-countdown",slideIn:"playkit-slideIn",hidden:"playkit-hidden","playlist-countdown-content-placeholder":"playkit-playlist-countdown-content-placeholder",playlistCountdownContentPlaceholder:"playkit-playlist-countdown-content-placeholder","playlist-countdown-content-background":"playkit-playlist-countdown-content-background",playlistCountdownContentBackground:"playkit-playlist-countdown-content-background","playlist-countdown-content":"playkit-playlist-countdown-content",playlistCountdownContent:"playkit-playlist-countdown-content",canceled:"playkit-canceled","playlist-countdown-poster":"playkit-playlist-countdown-poster",playlistCountdownPoster:"playkit-playlist-countdown-poster","playlist-countdown-text":"playkit-playlist-countdown-text",playlistCountdownText:"playkit-playlist-countdown-text","playlist-countdown-text-title":"playkit-playlist-countdown-text-title",playlistCountdownTextTitle:"playkit-playlist-countdown-text-title","playlist-countdown-time-left":"playkit-playlist-countdown-time-left",playlistCountdownTimeLeft:"playkit-playlist-countdown-time-left","playlist-countdown-text-name":"playkit-playlist-countdown-text-name",playlistCountdownTextName:"playkit-playlist-countdown-text-name","playlist-countdown-cancel":"playkit-playlist-countdown-cancel",playlistCountdownCancel:"playkit-playlist-countdown-cancel","playlist-next-screen-overlay":"playkit-playlist-next-screen-overlay",playlistNextScreenOverlay:"playkit-playlist-next-screen-overlay","playlist-next-screen-content":"playkit-playlist-next-screen-content",playlistNextScreenContent:"playkit-playlist-next-screen-content","playlist-next-screen-text":"playkit-playlist-next-screen-text",playlistNextScreenText:"playkit-playlist-next-screen-text","playlist-next-screen-text-title":"playkit-playlist-next-screen-text-title",playlistNextScreenTextTitle:"playkit-playlist-next-screen-text-title","playlist-next-screen-text-name":"playkit-playlist-next-screen-text-name",playlistNextScreenTextName:"playkit-playlist-next-screen-text-name","playlist-next-screen-poster-placeholder":"playkit-playlist-next-screen-poster-placeholder",playlistNextScreenPosterPlaceholder:"playkit-playlist-next-screen-poster-placeholder","playlist-next-screen-poster-aspect-ratio":"playkit-playlist-next-screen-poster-aspect-ratio",playlistNextScreenPosterAspectRatio:"playkit-playlist-next-screen-poster-aspect-ratio","playlist-next-screen-poster":"playkit-playlist-next-screen-poster",playlistNextScreenPoster:"playkit-playlist-next-screen-poster","playlist-next-screen-poster-img":"playkit-playlist-next-screen-poster-img",playlistNextScreenPosterImg:"playkit-playlist-next-screen-poster-img","size-lg":"playkit-size-lg",sizeLg:"playkit-size-lg","picture-in-picture-overlay":"playkit-picture-in-picture-overlay",pictureInPictureOverlay:"playkit-picture-in-picture-overlay","picture-in-picture-poster":"playkit-picture-in-picture-poster",pictureInPicturePoster:"playkit-picture-in-picture-poster","dark-layer":"playkit-dark-layer",darkLayer:"playkit-dark-layer","picture-in-picture-control":"playkit-picture-in-picture-control",pictureInPictureControl:"playkit-picture-in-picture-control","picture-in-picture-text":"playkit-picture-in-picture-text",pictureInPictureText:"playkit-picture-in-picture-text","picture-in-picture-button":"playkit-picture-in-picture-button",pictureInPictureButton:"playkit-picture-in-picture-button","icon-copy":"playkit-icon-copy",iconCopy:"playkit-icon-copy",copied:"playkit-copied",IE:"playkit-IE",ie:"playkit-IE",tooltip:"playkit-tooltip","tooltip-label":"playkit-tooltip-label",tooltipLabel:"playkit-tooltip-label","tooltip-top":"playkit-tooltip-top",tooltipTop:"playkit-tooltip-top","tooltip-top-left":"playkit-tooltip-top-left",tooltipTopLeft:"playkit-tooltip-top-left","tooltip-top-right":"playkit-tooltip-top-right",tooltipTopRight:"playkit-tooltip-top-right","tooltip-bottom":"playkit-tooltip-bottom",tooltipBottom:"playkit-tooltip-bottom","tooltip-bottom-right":"playkit-tooltip-bottom-right",tooltipBottomRight:"playkit-tooltip-bottom-right","tooltip-bottom-left":"playkit-tooltip-bottom-left",tooltipBottomLeft:"playkit-tooltip-bottom-left","tooltip-left":"playkit-tooltip-left",tooltipLeft:"playkit-tooltip-left","tooltip-right":"playkit-tooltip-right",tooltipRight:"playkit-tooltip-right","side-panel":"playkit-side-panel",sidePanel:"playkit-side-panel","small-size":"playkit-small-size",smallSize:"playkit-small-size","vertical-side-panel":"playkit-vertical-side-panel",verticalSidePanel:"playkit-vertical-side-panel","horizontal-side-panel":"playkit-horizontal-side-panel",horizontalSidePanel:"playkit-horizontal-side-panel","side-panel-content":"playkit-side-panel-content",sidePanelContent:"playkit-side-panel-content","interactive-area":"playkit-interactive-area",interactiveArea:"playkit-interactive-area","video-area":"playkit-video-area",videoArea:"playkit-video-area",spinner:"playkit-spinner","kaltura-spinner":"playkit-kaltura-spinner",kalturaSpinner:"playkit-kaltura-spinner",switch:"playkit-switch","toggle-input":"playkit-toggle-input",toggleInput:"playkit-toggle-input","audio-entry-backdrop":"playkit-audio-entry-backdrop",audioEntryBackdrop:"playkit-audio-entry-backdrop","audio-entry-details":"playkit-audio-entry-details",audioEntryDetails:"playkit-audio-entry-details","audio-entry-l":"playkit-audio-entry-l",audioEntryL:"playkit-audio-entry-l","audio-entry-m":"playkit-audio-entry-m",audioEntryM:"playkit-audio-entry-m","audio-entry-t":"playkit-audio-entry-t",audioEntryT:"playkit-audio-entry-t","audio-entry-description":"playkit-audio-entry-description",audioEntryDescription:"playkit-audio-entry-description","audio-entry-title":"playkit-audio-entry-title",audioEntryTitle:"playkit-audio-entry-title","audio-entry-title-trimmed":"playkit-audio-entry-title-trimmed",audioEntryTitleTrimmed:"playkit-audio-entry-title-trimmed","audio-entry-expanded":"playkit-audio-entry-expanded",audioEntryExpanded:"playkit-audio-entry-expanded","expandable-text":"playkit-expandable-text",expandableText:"playkit-expandable-text","more-button-text":"playkit-more-button-text",moreButtonText:"playkit-more-button-text",scrollable:"playkit-scrollable","items-container":"playkit-items-container",itemsContainer:"playkit-items-container",horizontal:"playkit-horizontal",vertical:"playkit-vertical",scrolling:"playkit-scrolling","context-menu":"playkit-context-menu",contextMenu:"playkit-context-menu","context-menu-item":"playkit-context-menu-item",contextMenuItem:"playkit-context-menu-item"},module.exports=e},"./node_modules/css-loader/dist/runtime/api.js":function(module){"use strict";module.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r,n,a,i=e[1]||"",s=e[3];if(!s)return i;if(t&&"function"==typeof btoa){var o=(r=s,n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(a," */")),l=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[i].concat(l).concat([o]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,n){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(n)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(a[s]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);n&&a[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},"./node_modules/dlv/dist/dlv.umd.js":function(module){module.exports=function(e,t,r,n,a){for(t=t.split?t.split("."):t,n=0;n<t.length;n++)e=e?e[t[n]]:a;return e===a?r:e}},"./node_modules/hoist-non-react-statics/dist/hoist-non-react-statics.cjs.js":function(module,e,t){"use strict";var r=t("./node_modules/react-is/index.js"),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function o(e){return r.isMemo(e)?i:s[e.$$typeof]||n}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=i;var l=Object.defineProperty,u=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,h=Object.prototype;module.exports=function e(t,r,n){if("string"!=typeof r){if(h){var i=p(r);i&&i!==h&&e(t,i,n)}var s=u(r);c&&(s=s.concat(c(r)));for(var f=o(t),m=o(r),g=0;g<s.length;++g){var y=s[g];if(!(a[y]||n&&n[y]||m&&m[y]||f&&f[y])){var v=d(r,y);try{l(t,y,v)}catch(e){}}}}return t}},"./node_modules/humanize-duration/humanize-duration.js":function(module,e,t){var r;!function(){var n=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])f(t,n)&&(e[n]=t[n]);return e},a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=o((function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return(1===e?"":"")+"  "}),","),s={af:o("jaar",(function(e){return"maand"+(1===e?"":"e")}),(function(e){return 1===e?"week":"weke"}),(function(e){return 1===e?"dag":"dae"}),(function(e){return 1===e?"uur":"ure"}),(function(e){return 1===e?"minuut":"minute"}),(function(e){return"sekonde"+(1===e?"":"s")}),(function(e){return"millisekonde"+(1===e?"":"s")}),","),am:o("","","","","","","",""),ar:n(o((function(e){return["","",""][l(e)]}),(function(e){return["","",""][l(e)]}),(function(e){return["","",""][l(e)]}),(function(e){return["","",""][l(e)]}),(function(e){return["","",""][l(e)]}),(function(e){return["","",""][l(e)]}),(function(e){return["","",""][l(e)]}),(function(e){return["  ","  ","  "][l(e)]}),","),{delimiter:"  ",_hideCountIf2:!0,_digitReplacements:["","","","","","","","","",""]}),bg:o((function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),","),bn:o("","","","","","","",""),ca:o((function(e){return"any"+(1===e?"":"s")}),(function(e){return"mes"+(1===e?"":"os")}),(function(e){return"setman"+(1===e?"a":"es")}),(function(e){return"di"+(1===e?"a":"es")}),(function(e){return"hor"+(1===e?"a":"es")}),(function(e){return"minut"+(1===e?"":"s")}),(function(e){return"segon"+(1===e?"":"s")}),(function(e){return"milisegon"+(1===e?"":"s")}),","),ckb:o("","","","","","",""," ","."),cs:o((function(e){return["rok","roku","roky","let"][d(e)]}),(function(e){return["msc","msce","msce","msc"][d(e)]}),(function(e){return["tden","tdne","tdny","tdn"][d(e)]}),(function(e){return["den","dne","dny","dn"][d(e)]}),(function(e){return["hodina","hodiny","hodiny","hodin"][d(e)]}),(function(e){return["minuta","minuty","minuty","minut"][d(e)]}),(function(e){return["sekunda","sekundy","sekundy","sekund"][d(e)]}),(function(e){return["milisekunda","milisekundy","milisekundy","milisekund"][d(e)]}),","),cy:o("flwyddyn","mis","wythnos","diwrnod","awr","munud","eiliad","milieiliad"),da:o("r",(function(e){return"mned"+(1===e?"":"er")}),(function(e){return"uge"+(1===e?"":"r")}),(function(e){return"dag"+(1===e?"":"e")}),(function(e){return"time"+(1===e?"":"r")}),(function(e){return"minut"+(1===e?"":"ter")}),(function(e){return"sekund"+(1===e?"":"er")}),(function(e){return"millisekund"+(1===e?"":"er")}),","),de:o((function(e){return"Jahr"+(1===e?"":"e")}),(function(e){return"Monat"+(1===e?"":"e")}),(function(e){return"Woche"+(1===e?"":"n")}),(function(e){return"Tag"+(1===e?"":"e")}),(function(e){return"Stunde"+(1===e?"":"n")}),(function(e){return"Minute"+(1===e?"":"n")}),(function(e){return"Sekunde"+(1===e?"":"n")}),(function(e){return"Millisekunde"+(1===e?"":"n")}),","),el:i,en:o((function(e){return"year"+(1===e?"":"s")}),(function(e){return"month"+(1===e?"":"s")}),(function(e){return"week"+(1===e?"":"s")}),(function(e){return"day"+(1===e?"":"s")}),(function(e){return"hour"+(1===e?"":"s")}),(function(e){return"minute"+(1===e?"":"s")}),(function(e){return"second"+(1===e?"":"s")}),(function(e){return"millisecond"+(1===e?"":"s")})),eo:o((function(e){return"jaro"+(1===e?"":"j")}),(function(e){return"monato"+(1===e?"":"j")}),(function(e){return"semajno"+(1===e?"":"j")}),(function(e){return"tago"+(1===e?"":"j")}),(function(e){return"horo"+(1===e?"":"j")}),(function(e){return"minuto"+(1===e?"":"j")}),(function(e){return"sekundo"+(1===e?"":"j")}),(function(e){return"milisekundo"+(1===e?"":"j")}),","),es:o((function(e){return"ao"+(1===e?"":"s")}),(function(e){return"mes"+(1===e?"":"es")}),(function(e){return"semana"+(1===e?"":"s")}),(function(e){return"da"+(1===e?"":"s")}),(function(e){return"hora"+(1===e?"":"s")}),(function(e){return"minuto"+(1===e?"":"s")}),(function(e){return"segundo"+(1===e?"":"s")}),(function(e){return"milisegundo"+(1===e?"":"s")}),","),et:o((function(e){return"aasta"+(1===e?"":"t")}),(function(e){return"kuu"+(1===e?"":"d")}),(function(e){return"ndal"+(1===e?"":"at")}),(function(e){return"pev"+(1===e?"":"a")}),(function(e){return"tund"+(1===e?"":"i")}),(function(e){return"minut"+(1===e?"":"it")}),(function(e){return"sekund"+(1===e?"":"it")}),(function(e){return"millisekund"+(1===e?"":"it")}),","),eu:o("urte","hilabete","aste","egun","ordu","minutu","segundo","milisegundo",","),fa:o("","","","","","",""," "),fi:o((function(e){return 1===e?"vuosi":"vuotta"}),(function(e){return 1===e?"kuukausi":"kuukautta"}),(function(e){return"viikko"+(1===e?"":"a")}),(function(e){return"piv"+(1===e?"":"")}),(function(e){return"tunti"+(1===e?"":"a")}),(function(e){return"minuutti"+(1===e?"":"a")}),(function(e){return"sekunti"+(1===e?"":"a")}),(function(e){return"millisekunti"+(1===e?"":"a")}),","),fo:o("r",(function(e){return 1===e?"mnaur":"mnair"}),(function(e){return 1===e?"vika":"vikur"}),(function(e){return 1===e?"dagur":"dagar"}),(function(e){return 1===e?"tmi":"tmar"}),(function(e){return 1===e?"minuttur":"minuttir"}),"sekund","millisekund",","),fr:o((function(e){return"an"+(e>=2?"s":"")}),"mois",(function(e){return"semaine"+(e>=2?"s":"")}),(function(e){return"jour"+(e>=2?"s":"")}),(function(e){return"heure"+(e>=2?"s":"")}),(function(e){return"minute"+(e>=2?"s":"")}),(function(e){return"seconde"+(e>=2?"s":"")}),(function(e){return"milliseconde"+(e>=2?"s":"")}),","),gr:i,he:o((function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""})),hr:o((function(e){return e%10==2||e%10==3||e%10==4?"godine":"godina"}),(function(e){return 1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci"}),(function(e){return e%10==1&&11!==e?"tjedan":"tjedna"}),(function(e){return 1===e?"dan":"dana"}),(function(e){return 1===e?"sat":2===e||3===e||4===e?"sata":"sati"}),(function(e){var t=e%10;return 2!==t&&3!==t&&4!==t||!(e<10||e>14)?"minuta":"minute"}),(function(e){var t=e%10;return 5===t||Math.floor(e)===e&&e>=10&&e<=19?"sekundi":1===t?"sekunda":2===t||3===t||4===t?"sekunde":"sekundi"}),(function(e){return 1===e?"milisekunda":e%10==2||e%10==3||e%10==4?"milisekunde":"milisekundi"}),","),hi:o("",(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),"",(function(e){return 1===e?"":""}),"","",""),hu:o("v","hnap","ht","nap","ra","perc","msodperc","ezredmsodperc",","),id:o("tahun","bulan","minggu","hari","jam","menit","detik","milidetik"),is:o("r",(function(e){return"mnu"+(1===e?"ur":"ir")}),(function(e){return"vik"+(1===e?"a":"ur")}),(function(e){return"dag"+(1===e?"ur":"ar")}),(function(e){return"klukkutm"+(1===e?"i":"ar")}),(function(e){return"mnt"+(1===e?"a":"ur")}),(function(e){return"seknd"+(1===e?"a":"ur")}),(function(e){return"milliseknd"+(1===e?"a":"ur")})),it:o((function(e){return"ann"+(1===e?"o":"i")}),(function(e){return"mes"+(1===e?"e":"i")}),(function(e){return"settiman"+(1===e?"a":"e")}),(function(e){return"giorn"+(1===e?"o":"i")}),(function(e){return"or"+(1===e?"a":"e")}),(function(e){return"minut"+(1===e?"o":"i")}),(function(e){return"second"+(1===e?"o":"i")}),(function(e){return"millisecond"+(1===e?"o":"i")}),","),ja:o("","","","","","","",""),km:o("","","","","","","",""),kn:o((function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""})),ko:o("","","","","","",""," "),ku:o("sal","meh","hefte","roj","seet","deqe","saniye","mlirk",","),lo:o("","","","","","","","",","),lt:o((function(e){return e%10==0||e%100>=10&&e%100<=20?"met":"metai"}),(function(e){return["mnuo","mnesiai","mnesi"][p(e)]}),(function(e){return["savait","savaits","savaii"][p(e)]}),(function(e){return["diena","dienos","dien"][p(e)]}),(function(e){return["valanda","valandos","valand"][p(e)]}),(function(e){return["minut","minuts","minui"][p(e)]}),(function(e){return["sekund","sekunds","sekundi"][p(e)]}),(function(e){return["milisekund","milisekunds","milisekundi"][p(e)]}),","),lv:o((function(e){return h(e)?"gads":"gadi"}),(function(e){return h(e)?"mnesis":"mnei"}),(function(e){return h(e)?"neda":"nedas"}),(function(e){return h(e)?"diena":"dienas"}),(function(e){return h(e)?"stunda":"stundas"}),(function(e){return h(e)?"minte":"mintes"}),(function(e){return h(e)?"sekunde":"sekundes"}),(function(e){return h(e)?"milisekunde":"milisekundes"}),","),mk:o((function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),","),mn:o("",""," ","","","","",""),mr:o((function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),"","",(function(e){return 1===e?"":""}),"",""),ms:o("tahun","bulan","minggu","hari","jam","minit","saat","milisaat"),nl:o("jaar",(function(e){return 1===e?"maand":"maanden"}),(function(e){return 1===e?"week":"weken"}),(function(e){return 1===e?"dag":"dagen"}),"uur",(function(e){return 1===e?"minuut":"minuten"}),(function(e){return 1===e?"seconde":"seconden"}),(function(e){return 1===e?"milliseconde":"milliseconden"}),","),no:o("r",(function(e){return"mned"+(1===e?"":"er")}),(function(e){return"uke"+(1===e?"":"r")}),(function(e){return"dag"+(1===e?"":"er")}),(function(e){return"time"+(1===e?"":"r")}),(function(e){return"minutt"+(1===e?"":"er")}),(function(e){return"sekund"+(1===e?"":"er")}),(function(e){return"millisekund"+(1===e?"":"er")}),","),pl:o((function(e){return["rok","roku","lata","lat"][u(e)]}),(function(e){return["miesic","miesica","miesice","miesicy"][u(e)]}),(function(e){return["tydzie","tygodnia","tygodnie","tygodni"][u(e)]}),(function(e){return["dzie","dnia","dni","dni"][u(e)]}),(function(e){return["godzina","godziny","godziny","godzin"][u(e)]}),(function(e){return["minuta","minuty","minuty","minut"][u(e)]}),(function(e){return["sekunda","sekundy","sekundy","sekund"][u(e)]}),(function(e){return["milisekunda","milisekundy","milisekundy","milisekund"][u(e)]}),","),pt:o((function(e){return"ano"+(1===e?"":"s")}),(function(e){return 1===e?"ms":"meses"}),(function(e){return"semana"+(1===e?"":"s")}),(function(e){return"dia"+(1===e?"":"s")}),(function(e){return"hora"+(1===e?"":"s")}),(function(e){return"minuto"+(1===e?"":"s")}),(function(e){return"segundo"+(1===e?"":"s")}),(function(e){return"milissegundo"+(1===e?"":"s")}),","),ro:o((function(e){return 1===e?"an":"ani"}),(function(e){return 1===e?"lun":"luni"}),(function(e){return 1===e?"sptmn":"sptmni"}),(function(e){return 1===e?"zi":"zile"}),(function(e){return 1===e?"or":"ore"}),(function(e){return 1===e?"minut":"minute"}),(function(e){return 1===e?"secund":"secunde"}),(function(e){return 1===e?"milisecund":"milisecunde"}),","),ru:o((function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),","),sq:o((function(e){return 1===e?"vit":"vjet"}),"muaj","jav","dit","or",(function(e){return"minut"+(1===e?"":"a")}),(function(e){return"sekond"+(1===e?"":"a")}),(function(e){return"milisekond"+(1===e?"":"a")}),","),sr:o((function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),","),ta:o((function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return""+(1===e?"":"")}),(function(e){return""+(1===e?"":"")}),(function(e){return" "+(1===e?"":"")})),te:o((function(e){return""+(1===e?"":"")}),(function(e){return""+(1===e?"":"")}),(function(e){return 1===e?"":""}),(function(e){return""+(1===e?"":"")}),(function(e){return""+(1===e?"":"")}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""})),uk:o((function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),(function(e){return["","",""][c(e)]}),","),ur:o("",(function(e){return 1===e?"":""}),(function(e){return 1===e?"":""}),"",(function(e){return 1===e?"":""}),"",""," "),sk:o((function(e){return["rok","roky","roky","rokov"][d(e)]}),(function(e){return["mesiac","mesiace","mesiace","mesiacov"][d(e)]}),(function(e){return["tde","tdne","tdne","tdov"][d(e)]}),(function(e){return["de","dni","dni","dn"][d(e)]}),(function(e){return["hodina","hodiny","hodiny","hodn"][d(e)]}),(function(e){return["minta","minty","minty","mint"][d(e)]}),(function(e){return["sekunda","sekundy","sekundy","seknd"][d(e)]}),(function(e){return["milisekunda","milisekundy","milisekundy","miliseknd"][d(e)]}),","),sl:o((function(e){return e%10==1?"leto":e%100==2?"leti":e%100==3||e%100==4||Math.floor(e)!==e&&e%100<=5?"leta":"let"}),(function(e){return e%10==1?"mesec":e%100==2||Math.floor(e)!==e&&e%100<=5?"meseca":e%10==3||e%10==4?"mesece":"mesecev"}),(function(e){return e%10==1?"teden":e%10==2||Math.floor(e)!==e&&e%100<=4?"tedna":e%10==3||e%10==4?"tedne":"tednov"}),(function(e){return e%100==1?"dan":"dni"}),(function(e){return e%10==1?"ura":e%100==2?"uri":e%10==3||e%10==4||Math.floor(e)!==e?"ure":"ur"}),(function(e){return e%10==1?"minuta":e%10==2?"minuti":e%10==3||e%10==4||Math.floor(e)!==e&&e%100<=4?"minute":"minut"}),(function(e){return e%10==1?"sekunda":e%100==2?"sekundi":e%100==3||e%100==4||Math.floor(e)!==e?"sekunde":"sekund"}),(function(e){return e%10==1?"milisekunda":e%100==2?"milisekundi":e%100==3||e%100==4||Math.floor(e)!==e?"milisekunde":"milisekund"}),","),sv:o("r",(function(e){return"mnad"+(1===e?"":"er")}),(function(e){return"veck"+(1===e?"a":"or")}),(function(e){return"dag"+(1===e?"":"ar")}),(function(e){return"timm"+(1===e?"e":"ar")}),(function(e){return"minut"+(1===e?"":"er")}),(function(e){return"sekund"+(1===e?"":"er")}),(function(e){return"millisekund"+(1===e?"":"er")}),","),sw:n(o((function(e){return 1===e?"mwaka":"miaka"}),(function(e){return 1===e?"mwezi":"miezi"}),"wiki",(function(e){return 1===e?"siku":"masiku"}),(function(e){return 1===e?"saa":"masaa"}),"dakika","sekunde","milisekunde"),{_numberFirst:!0}),tr:o("yl","ay","hafta","gn","saat","dakika","saniye","milisaniye",","),th:o("","","","","","","",""),uz:o("yil","oy","hafta","kun","soat","minut","sekund","millisekund"),uz_CYR:o("","","","","","","",""),vi:o("nm","thng","tun","ngy","gi","pht","giy","mili giy",","),zh_CN:o("","","","","","","",""),zh_TW:o("","","","","","","","")};function o(e,t,r,n,a,i,s,o,l){var u={y:e,mo:t,w:r,d:n,h:a,m:i,s,ms:o};return void 0!==l&&(u.decimal=l),u}function l(e){return 2===e?1:e>2&&e<11?2:0}function u(e){return 1===e?0:Math.floor(e)!==e?1:e%10>=2&&e%10<=4&&!(e%100>10&&e%100<20)?2:3}function c(e){return Math.floor(e)!==e?2:e%100>=5&&e%100<=20||e%10>=5&&e%10<=9||e%10==0?0:e%10==1?1:e>1?2:0}function d(e){return 1===e?0:Math.floor(e)!==e?1:e%10>=2&&e%10<=4&&e%100<10?2:3}function p(e){return 1===e||e%10==1&&e%100>20?0:Math.floor(e)!==e||e%10>=2&&e%100>20||e%10>=2&&e%100<10?1:2}function h(e){return e%10==1&&e%100!=11}function f(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function m(e,t,r){var n,a,i,s=e.unitName,o=e.unitCount,l=r.spacer,u=r.maxDecimalPoints;n=f(r,"decimal")?r.decimal:f(t,"decimal")?t.decimal:".","digitReplacements"in r?a=r.digitReplacements:"_digitReplacements"in t&&(a=t._digitReplacements);var c=(void 0===u?o:Math.floor(o*Math.pow(10,u))/Math.pow(10,u)).toString();if(t._hideCountIf2&&2===o)i="",l="";else if(a){i="";for(var d=0;d<c.length;d++){var p=c[d];i+="."===p?n:a[p]}}else i=c.replace(".",n);var h,m=t[s];return h="function"==typeof m?m(o):m,t._numberFirst?h+l+i:i+l+h}function g(e,t){var r=function(e){var t=[e.language];if(f(e,"fallbacks")){if(!a(e.fallbacks)||!e.fallbacks.length)throw new Error("fallbacks must be an array with at least one element");t=t.concat(e.fallbacks)}for(var r=0;r<t.length;r++){var n=t[r];if(f(e.languages,n))return e.languages[n];if(f(s,n))return s[n]}throw new Error("No language found.")}(t);if(!e.length){var n=t.units;return m({unitName:n[n.length-1],unitCount:0},r,t)}var i,o=t.conjunction,l=t.serialComma;i=f(t,"delimiter")?t.delimiter:f(r,"delimiter")?r.delimiter:", ";for(var u=[],c=0;c<e.length;c++)u.push(m(e[c],r,t));return o&&1!==e.length?2===e.length?u.join(o):u.slice(0,-1).join(i)+(l?",":"")+o+u.slice(-1):u.join(i)}function y(e){var t=function(e,r){e=Math.abs(e);var a=n({},t,r||{}),i=function(e,t){var r,n,a,i,s=t.units,o=t.unitMeasures,l="largest"in t?t.largest:1/0;if(!s.length)return[];var u={};for(i=e,n=0;n<s.length;n++){var c=o[r=s[n]];a=n===s.length-1?i/c:Math.floor(i/c),u[r]=a,i-=a*c}if(t.round){var d=l;for(n=0;n<s.length;n++)if(0!==(a=u[r=s[n]])&&0==--d){for(var p=n+1;p<s.length;p++){var h=s[p],f=u[h];u[r]+=f*o[h]/o[r],u[h]=0}break}for(n=s.length-1;n>=0;n--)if(0!==(a=u[r=s[n]])){var m=Math.round(a);if(u[r]=m,0===n)break;var g=s[n-1],y=o[g],v=Math.floor(m*o[r]/y);if(!v)break;u[g]+=v,u[r]=0}}var _=[];for(n=0;n<s.length&&_.length<l;n++)(a=u[r=s[n]])&&_.push({unitName:r,unitCount:a});return _}(e,a);return g(i,a)};return n(t,{language:"en",spacer:" ",conjunction:"",serialComma:!0,units:["y","mo","w","d","h","m","s"],languages:{},round:!1,unitMeasures:{y:315576e5,mo:26298e5,w:6048e5,d:864e5,h:36e5,m:6e4,s:1e3,ms:1}},e)}var v=n(y({}),{getSupportedLanguages:function(){var e=[];for(var t in s)f(s,t)&&"gr"!==t&&e.push(t);return e},humanizer:y});void 0===(r=function(){return v}.call(e,t,e,module))||(module.exports=r)}()},"./node_modules/object-assign/index.js":function(module){"use strict";var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;module.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(n,a){for(var i,s,o=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(n),l=1;l<arguments.length;l++){for(var u in i=Object(arguments[l]))t.call(i,u)&&(o[u]=i[u]);if(e){s=e(i);for(var c=0;c<s.length;c++)r.call(i,s[c])&&(o[s[c]]=i[s[c]])}}return o}},"./node_modules/preact-i18n/dist/preact-i18n.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,{IntlProvider:function(){return d},Localizer:function(){return E},MarkupText:function(){return b},Text:function(){return _},intl:function(){return p},withText:function(){return A}});var n=r("./node_modules/preact/dist/preact.module.js"),a=r("./node_modules/dlv/dist/dlv.umd.js"),i=r.n(a);function o(e){return null!=e}function l(e,t){for(var r in t)e[r]=t[r];return e}function u(e,t){var r=l({},e);for(var n in t)t.hasOwnProperty(n)&&(e[n]&&t[n]&&"object"===s(e[n])&&"object"===s(t[n])?r[n]=u(e[n],t[n]):r[n]=e[n]||t[n]);return r}var c=/[?&#]intl=show/,d=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getChildContext=function(){var e=this.props,t=e.scope,r=e.definition,n=e.mark,a=l({},this.context.intl||{});return t&&(a.scope=t),r&&(a.dictionary=u(a.dictionary||{},r)),(n||"undefined"!=typeof location&&String(location).match(c))&&(a.mark=!0),{intl:a}},t.prototype.render=function(e){return e.children},t}(n.Component);function p(e,t){if(arguments.length<2)return t=e,function(e){return p(e,t)};function r(r){return(0,n.h)(d,t||{},(0,n.h)(e,r))}return r.getWrappedComponent=e&&e.getWrappedComponent||function(){return e},r}var h,f={};function m(e,t){return h=t||f,e&&e.replace(/\{\{([\w.-]+)\}\}/g,g)}function g(e,t){for(var r=t.split("."),n=h,a=0;a<r.length;a++)if(null==(n=n[r[a]]))return"";return"string"==typeof n&&n.match(/\{\{/)&&(n=m(n,h)),n}function y(e,t,r,n,a,l){t&&(e=t+"."+e);var u=r&&i()(r,e);return(a||0===a)&&u&&"object"===s(u)&&(u=u.splice?u[a]||u[0]:0===a&&o(u.none)?u.none:1===a&&o(u.one||u.singular)?u.one||u.singular:u.some||u.many||u.plural||u.other||u),u&&m(u,n)||l||null}function v(e,t){var r=e.value,a=e.id,s=t.intl;if(s&&s.mark){var o="dictionary"+(s&&s.scope?"."+s.scope:"")+"."+a;return(0,n.h)("mark",{style:{background:r?i()(s,o)?"rgba(119,231,117,.5)":"rgba(229,226,41,.5)":"rgba(228,147,51,.5)"},title:a},r)}return r}function _(e,t){var r=e.id,a=e.children,i=e.plural,s=e.fields,o=t.intl,l=y(r,o&&o.scope,o&&o.dictionary,s,i,a);return(0,n.h)(v,{id:r,value:l})}function k(e,t,r){var n={};for(var a in t=t||{},e=function(e){if("string"==typeof(e=e||{})&&(e=e.split(",")),"join"in e){for(var t={},r=0;r<e.length;r++){var n=e[r].trim();n&&(t[n.split(".").pop()]=n)}return t}return e}(e))if(e.hasOwnProperty(a)&&e[a]){var i=e[a];r||"string"!=typeof i?i.type===_&&(i=l({fallback:i.props.children},i.props),n[a]=y(i.id,t.scope,t.dictionary,i.fields,i.plural,i.fallback)):n[a]=y(i,t.scope,t.dictionary)}return n}function E(e,t){var r=e.children,a=t.intl;return r&&r.length?r.map((function(e){return(0,n.cloneElement)(e,k(e.props,a,!0))})):r&&(0,n.cloneElement)(r,k(r.props,a,!0))}function b(e){return(0,n.h)(E,null,(0,n.h)(T,{html:(0,n.h)(_,e),id:e.id}))}function T(e){var t=e.html,r=e.id,a=t?"string"==typeof t?(0,n.h)("span",{dangerouslySetInnerHTML:{__html:t}}):(0,n.h)("span",null,t):t;return(0,n.h)(v,{id:r,value:a})}function A(e){return function(t){function r(r,a){var i=k("function"==typeof e?e(r,a):e,a.intl);return(0,n.h)(t,l(l({},r),i))}return r.getWrappedComponent=t&&t.getWrappedComponent||function(){return t},r}}p.intl=p,p.IntlProvider=d,p.Text=_,p.MarkupText=b,p.Localizer=E,p.withText=A,t.default=p},"./node_modules/preact/compat/dist/compat.module.js":function(e,t,r){"use strict";r.r(t),r.d(t,{Children:function(){return f},Component:function(){return a.Component},Fragment:function(){return a.Fragment},PureComponent:function(){return l},StrictMode:function(){return F},Suspense:function(){return y},SuspenseList:function(){return k},cloneElement:function(){return N},createContext:function(){return a.createContext},createElement:function(){return a.createElement},createFactory:function(){return O},createPortal:function(){return A},createRef:function(){return a.createRef},findDOMNode:function(){return j},forwardRef:function(){return p},hydrate:function(){return x},isValidElement:function(){return L},lazy:function(){return _},memo:function(){return u},render:function(){return C},unmountComponentAtNode:function(){return U},unstable_batchedUpdates:function(){return B},useCallback:function(){return n.useCallback},useContext:function(){return n.useContext},useDebugValue:function(){return n.useDebugValue},useEffect:function(){return n.useEffect},useErrorBoundary:function(){return n.useErrorBoundary},useImperativeHandle:function(){return n.useImperativeHandle},useLayoutEffect:function(){return n.useLayoutEffect},useMemo:function(){return n.useMemo},useReducer:function(){return n.useReducer},useRef:function(){return n.useRef},useState:function(){return n.useState},version:function(){return D}});var n=r("./node_modules/preact/hooks/dist/hooks.module.js"),a=r("./node_modules/preact/dist/preact.module.js");function i(e,t){for(var r in t)e[r]=t[r];return e}function o(e,t){for(var r in e)if("__source"!==r&&!(r in t))return!0;for(var n in t)if("__source"!==n&&e[n]!==t[n])return!0;return!1}var l=function(e){var t,r;function n(t){var r;return(r=e.call(this,t)||this).isPureReactComponent=!0,r}return r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,n.prototype.shouldComponentUpdate=function(e,t){return o(this.props,e)||o(this.state,t)},n}(a.Component);function u(e,t){function r(e){var r=this.props.ref,n=r==e.ref;return!n&&r&&(r.call?r(null):r.current=null),t?!t(this.props,e)||!n:o(this.props,e)}function n(t){return this.shouldComponentUpdate=r,(0,a.createElement)(e,t)}return n.prototype.isReactComponent=!0,n.displayName="Memo("+(e.displayName||e.name)+")",n.t=!0,n}var c=a.options.__b;a.options.__b=function(e){e.type&&e.type.t&&e.ref&&(e.props.ref=e.ref,e.ref=null),c&&c(e)};var d="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function p(e){function t(t,r){var n=i({},t);return delete n.ref,e(n,(r=t.ref||r)&&("object"!=s(r)||"current"in r)?r:null)}return t.$$typeof=d,t.render=t,t.prototype.isReactComponent=t.t=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var h=function(e,t){return e?(0,a.toChildArray)(e).reduce((function(e,r,n){return e.concat(t(r,n))}),[]):null},f={map:h,forEach:h,count:function(e){return e?(0,a.toChildArray)(e).length:0},only:function(e){if(1!==(e=(0,a.toChildArray)(e)).length)throw new Error("Children.only() expects only one child.");return e[0]},toArray:a.toChildArray},m=a.options.__e;function g(e){return e&&((e=i({},e)).__c=null,e.__k=e.__k&&e.__k.map(g)),e}function y(){this.__u=0,this.o=null,this.__b=null}function v(e){var t=e.__.__c;return t&&t.u&&t.u(e)}function _(e){var t,r,n;function i(i){if(t||(t=e()).then((function(e){r=e.default||e}),(function(e){n=e})),n)throw n;if(!r)throw t;return(0,a.createElement)(r,i)}return i.displayName="Lazy",i.t=!0,i}function k(){this.i=null,this.l=null}a.options.__e=function(e,t,r){if(e.then)for(var n,a=t;a=a.__;)if((n=a.__c)&&n.__c)return n.__c(e,t.__c);m(e,t,r)},(y.prototype=new a.Component).__c=function(e,t){var r=this;null==r.o&&(r.o=[]),r.o.push(t);var n=v(r.__v),a=!1,i=function(){a||(a=!0,n?n(s):s())};t.__c=t.componentWillUnmount,t.componentWillUnmount=function(){i(),t.__c&&t.__c()};var s=function(){var e;if(! --r.__u)for(r.__v.__k[0]=r.state.u,r.setState({u:r.__b=null});e=r.o.pop();)e.forceUpdate()};r.__u++||r.setState({u:r.__b=r.__v.__k[0]}),e.then(i,i)},y.prototype.render=function(e,t){return this.__b&&(this.__v.__k&&(this.__v.__k[0]=g(this.__b)),this.__b=null),[(0,a.createElement)(a.Fragment,null,t.u?null:e.children),t.u&&e.fallback]};var E=function(e,t,r){if(++r[1]===r[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(r=e.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.i=r=r[2]}};(k.prototype=new a.Component).u=function(e){var t=this,r=v(t.__v),n=t.l.get(e);return n[0]++,function(a){var i=function(){t.props.revealOrder?(n.push(a),E(t,e,n)):a()};r?r(i):i()}},k.prototype.render=function(e){this.i=null,this.l=new Map;var t=(0,a.toChildArray)(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var r=t.length;r--;)this.l.set(t[r],this.i=[1,0,this.i]);return e.children},k.prototype.componentDidUpdate=k.prototype.componentDidMount=function(){var e=this;e.l.forEach((function(t,r){E(e,r,t)}))};var b=function(){function e(){}var t=e.prototype;return t.getChildContext=function(){return this.props.context},t.render=function(e){return e.children},e}();function T(e){var t=this,r=e.container,n=(0,a.createElement)(b,{context:t.context},e.vnode);return t.s&&t.s!==r&&(t.v.parentNode&&t.s.removeChild(t.v),(0,a.__u)(t.h),t.p=!1),e.vnode?t.p?(r.__k=t.__k,(0,a.render)(n,r),t.__k=r.__k):(t.v=document.createTextNode(""),(0,a.hydrate)("",r),r.appendChild(t.v),t.p=!0,t.s=r,(0,a.render)(n,r,t.v),t.__k=t.v.__k):t.p&&(t.v.parentNode&&t.s.removeChild(t.v),(0,a.__u)(t.h)),t.h=n,t.componentWillUnmount=function(){t.v.parentNode&&t.s.removeChild(t.v),(0,a.__u)(t.h)},null}function A(e,t){return(0,a.createElement)(T,{vnode:e,container:t})}var S=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;a.Component.prototype.isReactComponent={};var P="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;function C(e,t,r){if(null==t.__k)for(;t.firstChild;)t.removeChild(t.firstChild);return(0,a.render)(e,t),"function"==typeof r&&r(),e?e.__c:null}function x(e,t,r){return(0,a.hydrate)(e,t),"function"==typeof r&&r(),e?e.__c:null}var I=a.options.event;function w(e,t){e["UNSAFE_"+t]&&!e[t]&&Object.defineProperty(e,t,{configurable:!1,get:function(){return this["UNSAFE_"+t]},set:function(e){this["UNSAFE_"+t]=e}})}a.options.event=function(e){I&&(e=I(e)),e.persist=function(){};var t=!1,r=!1,n=e.stopPropagation;e.stopPropagation=function(){n.call(e),t=!0};var a=e.preventDefault;return e.preventDefault=function(){a.call(e),r=!0},e.isPropagationStopped=function(){return t},e.isDefaultPrevented=function(){return r},e.nativeEvent=e};var R={configurable:!0,get:function(){return this.class}},M=a.options.vnode;a.options.vnode=function(e){e.$$typeof=P;var t=e.type,r=e.props;if(t){if(r.class!=r.className&&(R.enumerable="className"in r,null!=r.className&&(r.class=r.className),Object.defineProperty(r,"className",R)),"function"!=typeof t){var n,i,s;for(s in r.defaultValue&&void 0!==r.value&&(r.value||0===r.value||(r.value=r.defaultValue),delete r.defaultValue),Array.isArray(r.value)&&r.multiple&&"select"===t&&((0,a.toChildArray)(r.children).forEach((function(e){-1!=r.value.indexOf(e.props.value)&&(e.props.selected=!0)})),delete r.value),r)if(n=S.test(s))break;if(n)for(s in i=e.props={},r)i[S.test(s)?s.replace(/[A-Z0-9]/,"-$&").toLowerCase():s]=r[s]}!function(t){var r=e.type,n=e.props;if(n&&"string"==typeof r){var a={};for(var i in n)/^on(Ani|Tra|Tou)/.test(i)&&(n[i.toLowerCase()]=n[i],delete n[i]),a[i.toLowerCase()]=i;if(a.ondoubleclick&&(n.ondblclick=n[a.ondoubleclick],delete n[a.ondoubleclick]),a.onbeforeinput&&(n.onbeforeinput=n[a.onbeforeinput],delete n[a.onbeforeinput]),a.onchange&&("textarea"===r||"input"===r.toLowerCase()&&!/^fil|che|ra/i.test(n.type))){var s=a.oninput||"oninput";n[s]||(n[s]=n[a.onchange],delete n[a.onchange])}}}(),"function"==typeof t&&!t.m&&t.prototype&&(w(t.prototype,"componentWillMount"),w(t.prototype,"componentWillReceiveProps"),w(t.prototype,"componentWillUpdate"),t.m=!0)}M&&M(e)};var D="16.8.0";function O(e){return a.createElement.bind(null,e)}function L(e){return!!e&&e.$$typeof===P}function N(e){return L(e)?a.cloneElement.apply(null,arguments):e}function U(e){return!!e.__k&&((0,a.render)(null,e),!0)}function j(e){return e&&(e.base||1===e.nodeType&&e)||null}var B=function(e,t){return e(t)},F=a.Fragment;t.default={useState:n.useState,useReducer:n.useReducer,useEffect:n.useEffect,useLayoutEffect:n.useLayoutEffect,useRef:n.useRef,useImperativeHandle:n.useImperativeHandle,useMemo:n.useMemo,useCallback:n.useCallback,useContext:n.useContext,useDebugValue:n.useDebugValue,version:"16.8.0",Children:f,render:C,hydrate:x,unmountComponentAtNode:U,createPortal:A,createElement:a.createElement,createContext:a.createContext,createFactory:O,cloneElement:N,createRef:a.createRef,Fragment:a.Fragment,isValidElement:L,findDOMNode:j,Component:a.Component,PureComponent:l,memo:u,forwardRef:p,unstable_batchedUpdates:B,StrictMode:a.Fragment,Suspense:y,SuspenseList:k,lazy:_}},"./node_modules/preact/dist/preact.module.js":function(e,t,r){"use strict";r.r(t),r.d(t,{Component:function(){return _},Fragment:function(){return v},__u:function(){return L},cloneElement:function(){return B},createContext:function(){return F},createElement:function(){return m},createRef:function(){return y},h:function(){return m},hydrate:function(){return j},isValidElement:function(){return a},options:function(){return n},render:function(){return U},toChildArray:function(){return S}});var n,a,i,s,o,l,u,c={},d=[],p=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function h(e,t){for(var r in t)e[r]=t[r];return e}function f(e){var t=e.parentNode;t&&t.removeChild(e)}function m(e,t,r){var n,a=arguments,i={};for(n in t)"key"!==n&&"ref"!==n&&(i[n]=t[n]);if(arguments.length>3)for(r=[r],n=3;n<arguments.length;n++)r.push(a[n]);if(null!=r&&(i.children=r),"function"==typeof e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===i[n]&&(i[n]=e.defaultProps[n]);return g(e,i,t&&t.key,t&&t.ref,null)}function g(e,t,r,a,i){var s={type:e,props:t,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:i};return null==i&&(s.__v=s),n.vnode&&n.vnode(s),s}function y(){return{current:null}}function v(e){return e.children}function _(e,t){this.props=e,this.context=t}function k(e,t){if(null==t)return e.__?k(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?k(e):null}function E(e){var t,r;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e){e.__e=e.__c.base=r.__e;break}return E(e)}}function b(e){(!e.__d&&(e.__d=!0)&&i.push(e)&&!T.__r++||o!==n.debounceRendering)&&((o=n.debounceRendering)||s)(T)}function T(){for(var e;T.__r=i.length;)e=i.sort((function(e,t){return e.__v.__b-t.__v.__b})),i=[],e.some((function(e){var t,r,n,a,i,s,o;e.__d&&(s=(i=(t=e).__v).__e,(o=t.__P)&&(r=[],(n=h({},i)).__v=n,a=R(o,i,n,t.__n,void 0!==o.ownerSVGElement,null,r,null==s?k(i):s),M(r,i),a!=s&&E(i)))}))}function A(e,t,r,n,a,i,s,o,l,u){var p,h,m,y,_,E,b,T=n&&n.__k||d,A=T.length;for(l==c&&(l=null!=s?s[0]:A?k(n,0):null),r.__k=[],p=0;p<t.length;p++)if(null!=(y=r.__k[p]=null==(y=t[p])||"boolean"==typeof y?null:"string"==typeof y||"number"==typeof y?g(null,y,null,null,y):Array.isArray(y)?g(v,{children:y},null,null,null):null!=y.__e||null!=y.__c?g(y.type,y.props,y.key,null,y.__v):y)){if(y.__=r,y.__b=r.__b+1,null===(m=T[p])||m&&y.key==m.key&&y.type===m.type)T[p]=void 0;else for(h=0;h<A;h++){if((m=T[h])&&y.key==m.key&&y.type===m.type){T[h]=void 0;break}m=null}_=R(e,y,m=m||c,a,i,s,o,l,u),(h=y.ref)&&m.ref!=h&&(b||(b=[]),m.ref&&b.push(m.ref,null,y),b.push(h,y.__c||_,y)),null!=_?(null==E&&(E=_),l=P(e,y,m,T,s,_,l),"option"==r.type?e.value="":"function"==typeof r.type&&(r.__d=l)):l&&m.__e==l&&l.parentNode!=e&&(l=k(m))}if(r.__e=E,null!=s&&"function"!=typeof r.type)for(p=s.length;p--;)null!=s[p]&&f(s[p]);for(p=A;p--;)null!=T[p]&&L(T[p],T[p]);if(b)for(p=0;p<b.length;p++)O(b[p],b[++p],b[++p])}function S(e){return null==e||"boolean"==typeof e?[]:Array.isArray(e)?d.concat.apply([],e.map(S)):[e]}function P(e,t,r,n,a,i,s){var o,l,u;if(void 0!==t.__d)o=t.__d,t.__d=void 0;else if(a==r||i!=s||null==i.parentNode)e:if(null==s||s.parentNode!==e)e.appendChild(i),o=null;else{for(l=s,u=0;(l=l.nextSibling)&&u<n.length;u+=2)if(l==i)break e;e.insertBefore(i,s),o=s}return void 0!==o?o:i.nextSibling}function C(e,t,r){"-"===t[0]?e.setProperty(t,r):e[t]="number"==typeof r&&!1===p.test(t)?r+"px":null==r?"":r}function x(e,t,r,n,a){var i,s,o,l,u;if(a?"className"===t&&(t="class"):"class"===t&&(t="className"),"style"===t)if(i=e.style,"string"==typeof r)i.cssText=r;else{if("string"==typeof n&&(i.cssText="",n=null),n)for(l in n)r&&l in r||C(i,l,"");if(r)for(u in r)n&&r[u]===n[u]||C(i,u,r[u])}else"o"===t[0]&&"n"===t[1]?(s=t!==(t=t.replace(/Capture$/,"")),o=t.toLowerCase(),t=(o in e?o:t).slice(2),r?(n||e.addEventListener(t,I,s),(e.l||(e.l={}))[t]=r):e.removeEventListener(t,I,s)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&!a&&t in e?e[t]=null==r?"":r:"function"!=typeof r&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==r||!1===r?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):null==r||!1===r&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,r))}function I(e){this.l[e.type](n.event?n.event(e):e)}function w(e,t,r){var n,a;for(n=0;n<e.__k.length;n++)(a=e.__k[n])&&(a.__=e,a.__e&&("function"==typeof a.type&&a.__k.length>1&&w(a,t,r),t=P(r,a,a,e.__k,null,a.__e,t),"function"==typeof e.type&&(e.__d=t)))}function R(e,t,r,a,i,s,o,l,u){var c,d,p,f,m,g,y,k,E,b,T,S=t.type;if(void 0!==t.constructor)return null;(c=n.__b)&&c(t);try{e:if("function"==typeof S){if(k=t.props,E=(c=S.contextType)&&a[c.__c],b=c?E?E.props.value:c.__:a,r.__c?y=(d=t.__c=r.__c).__=d.__E:("prototype"in S&&S.prototype.render?t.__c=d=new S(k,b):(t.__c=d=new _(k,b),d.constructor=S,d.render=N),E&&E.sub(d),d.props=k,d.state||(d.state={}),d.context=b,d.__n=a,p=d.__d=!0,d.__h=[]),null==d.__s&&(d.__s=d.state),null!=S.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=h({},d.__s)),h(d.__s,S.getDerivedStateFromProps(k,d.__s))),f=d.props,m=d.state,p)null==S.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==S.getDerivedStateFromProps&&k!==f&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(k,b),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(k,d.__s,b)||t.__v===r.__v){d.props=k,d.state=d.__s,t.__v!==r.__v&&(d.__d=!1),d.__v=t,t.__e=r.__e,t.__k=r.__k,d.__h.length&&o.push(d),w(t,l,e);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(k,d.__s,b),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(f,m,g)}))}d.context=b,d.props=k,d.state=d.__s,(c=n.__r)&&c(t),d.__d=!1,d.__v=t,d.__P=e,c=d.render(d.props,d.state,d.context),d.state=d.__s,null!=d.getChildContext&&(a=h(h({},a),d.getChildContext())),p||null==d.getSnapshotBeforeUpdate||(g=d.getSnapshotBeforeUpdate(f,m)),T=null!=c&&c.type==v&&null==c.key?c.props.children:c,A(e,Array.isArray(T)?T:[T],t,r,a,i,s,o,l,u),d.base=t.__e,d.__h.length&&o.push(d),y&&(d.__E=d.__=null),d.__e=!1}else null==s&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=D(r.__e,t,r,a,i,s,o,u);(c=n.diffed)&&c(t)}catch(e){t.__v=null,n.__e(e,t,r)}return t.__e}function M(e,t){n.__c&&n.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){n.__e(e,t.__v)}}))}function D(e,t,r,n,a,i,s,o){var l,u,p,h,f,m=r.props,g=t.props;if(a="svg"===t.type||a,null!=i)for(l=0;l<i.length;l++)if(null!=(u=i[l])&&((null===t.type?3===u.nodeType:u.localName===t.type)||e==u)){e=u,i[l]=null;break}if(null==e){if(null===t.type)return document.createTextNode(g);e=a?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,g.is&&{is:g.is}),i=null,o=!1}if(null===t.type)m!==g&&e.data!=g&&(e.data=g);else{if(null!=i&&(i=d.slice.call(e.childNodes)),p=(m=r.props||c).dangerouslySetInnerHTML,h=g.dangerouslySetInnerHTML,!o){if(null!=i)for(m={},f=0;f<e.attributes.length;f++)m[e.attributes[f].name]=e.attributes[f].value;(h||p)&&(h&&p&&h.__html==p.__html||(e.innerHTML=h&&h.__html||""))}(function(e,t,r,n,a){var i;for(i in r)"children"===i||"key"===i||i in t||x(e,i,null,r[i],n);for(i in t)a&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||r[i]===t[i]||x(e,i,t[i],r[i],n)})(e,g,m,a,o),h?t.__k=[]:(l=t.props.children,A(e,Array.isArray(l)?l:[l],t,r,n,"foreignObject"!==t.type&&a,i,s,c,o)),o||("value"in g&&void 0!==(l=g.value)&&l!==e.value&&x(e,"value",l,m.value,!1),"checked"in g&&void 0!==(l=g.checked)&&l!==e.checked&&x(e,"checked",l,m.checked,!1))}return e}function O(e,t,r){try{"function"==typeof e?e(t):e.current=t}catch(e){n.__e(e,r)}}function L(e,t,r){var a,i,s;if(n.unmount&&n.unmount(e),(a=e.ref)&&(a.current&&a.current!==e.__e||O(a,null,t)),r||"function"==typeof e.type||(r=null!=(i=e.__e)),e.__e=e.__d=void 0,null!=(a=e.__c)){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(e){n.__e(e,t)}a.base=a.__P=null}if(a=e.__k)for(s=0;s<a.length;s++)a[s]&&L(a[s],t,r);null!=i&&f(i)}function N(e,t,r){return this.constructor(e,r)}function U(e,t,r){var a,i,s;n.__&&n.__(e,t),i=(a=r===l)?null:r&&r.__k||t.__k,e=m(v,null,[e]),s=[],R(t,(a?t:r||t).__k=e,i||c,c,void 0!==t.ownerSVGElement,r&&!a?[r]:i?null:t.childNodes.length?d.slice.call(t.childNodes):null,s,r||c,a),M(s,e)}function j(e,t){U(e,t,l)}function B(e,t){var r,n;for(n in t=h(h({},e.props),t),arguments.length>2&&(t.children=d.slice.call(arguments,2)),r={},t)"key"!==n&&"ref"!==n&&(r[n]=t[n]);return g(e.type,r,t.key||e.key,t.ref||e.ref,null)}function F(e){var t={},r={__c:"__cC"+u++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,a=this;return this.getChildContext||(n=[],this.getChildContext=function(){return t[r.__c]=a,t},this.shouldComponentUpdate=function(e){a.props.value!==e.value&&n.some((function(t){t.context=e.value,b(t)}))},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return r.Consumer.contextType=r,r.Provider.__=r,r}n={__e:function(e,t){for(var r,n;t=t.__;)if((r=t.__c)&&!r.__)try{if(r.constructor&&null!=r.constructor.getDerivedStateFromError&&(n=!0,r.setState(r.constructor.getDerivedStateFromError(e))),null!=r.componentDidCatch&&(n=!0,r.componentDidCatch(e)),n)return b(r.__E=r)}catch(t){e=t}throw e}},a=function(e){return null!=e&&void 0===e.constructor},_.prototype.setState=function(e,t){var r;r=this.__s!==this.state?this.__s:this.__s=h({},this.state),"function"==typeof e&&(e=e(r,this.props)),e&&h(r,e),null!=e&&this.__v&&(t&&this.__h.push(t),b(this))},_.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),b(this))},_.prototype.render=v,i=[],s="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,T.__r=0,l=c,u=0},"./node_modules/preact/hooks/dist/hooks.module.js":function(e,t,r){"use strict";r.r(t),r.d(t,{useCallback:function(){return E},useContext:function(){return b},useDebugValue:function(){return T},useEffect:function(){return g},useErrorBoundary:function(){return A},useImperativeHandle:function(){return _},useLayoutEffect:function(){return y},useMemo:function(){return k},useReducer:function(){return m},useRef:function(){return v},useState:function(){return f}});var n,a,i,s=r("./node_modules/preact/dist/preact.module.js"),o=0,l=[],u=s.options.__r,c=s.options.diffed,d=s.options.__c,p=s.options.unmount;function h(e,t){s.options.__h&&s.options.__h(a,e,o||t),o=0;var r=a.__H||(a.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function f(e){return o=1,m(w,e)}function m(e,t,r){var i=h(n++,2);return i.t=e,i.__c||(i.__c=a,i.__=[r?r(t):w(void 0,t),function(e){var t=i.t(i.__[0],e);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}]),i.__}function g(e,t){var r=h(n++,3);!s.options.__s&&I(r.__H,t)&&(r.__=e,r.__H=t,a.__H.__h.push(r))}function y(e,t){var r=h(n++,4);!s.options.__s&&I(r.__H,t)&&(r.__=e,r.__H=t,a.__h.push(r))}function v(e){return o=5,k((function(){return{current:e}}),[])}function _(e,t,r){o=6,y((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==r?r:r.concat(e))}function k(e,t){var r=h(n++,7);return I(r.__H,t)?(r.__H=t,r.__h=e,r.__=e()):r.__}function E(e,t){return o=8,k((function(){return e}),t)}function b(e){var t=a.context[e.__c],r=h(n++,9);return r.__c=e,t?(null==r.__&&(r.__=!0,t.sub(a)),t.props.value):e.__}function T(e,t){s.options.useDebugValue&&s.options.useDebugValue(t?t(e):e)}function A(e){var t=h(n++,10),r=f();return t.__=e,a.componentDidCatch||(a.componentDidCatch=function(e){t.__&&t.__(e),r[1](e)}),[r[0],function(){r[1](void 0)}]}function S(){l.some((function(e){if(e.__P)try{e.__H.__h.forEach(C),e.__H.__h.forEach(x),e.__H.__h=[]}catch(t){return e.__H.__h=[],s.options.__e(t,e.__v),!0}})),l=[]}s.options.__r=function(e){u&&u(e),n=0;var t=(a=e.__c).__H;t&&(t.__h.forEach(C),t.__h.forEach(x),t.__h=[])},s.options.diffed=function(e){c&&c(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==l.push(t)&&i===s.options.requestAnimationFrame||((i=s.options.requestAnimationFrame)||function(e){var t,r=function(){clearTimeout(n),P&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,100);P&&(t=requestAnimationFrame(r))})(S))},s.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(C),e.__h=e.__h.filter((function(e){return!e.__||x(e)}))}catch(r){t.some((function(e){e.__h&&(e.__h=[])})),t=[],s.options.__e(r,e.__v)}})),d&&d(e,t)},s.options.unmount=function(e){p&&p(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(C)}catch(e){s.options.__e(e,t.__v)}};var P="function"==typeof requestAnimationFrame;function C(e){"function"==typeof e.u&&e.u()}function x(e){e.u=e.__()}function I(e,t){return!e||t.some((function(t,r){return t!==e[r]}))}function w(e,t){return"function"==typeof t?t(e):t}},"./node_modules/prop-types/checkPropTypes.js":function(module,e,t){"use strict";var r=function(){},n=t("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),a={},i=Function.call.bind(Object.prototype.hasOwnProperty);function o(e,t,o,l,u){for(var c in e)if(i(e,c)){var d;try{if("function"!=typeof e[c]){var p=Error((l||"React class")+": "+o+" type `"+c+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+s(e[c])+"`.");throw p.name="Invariant Violation",p}d=e[c](t,c,l,o,null,n)}catch(e){d=e}if(!d||d instanceof Error||r((l||"React class")+": type specification of "+o+" `"+c+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+s(d)+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),d instanceof Error&&!(d.message in a)){a[d.message]=!0;var h=u?u():"";r("Failed "+o+" type: "+d.message+(null!=h?h:""))}}}r=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}},o.resetWarningCache=function(){a={}},module.exports=o},"./node_modules/prop-types/factoryWithTypeCheckers.js":function(module,e,t){"use strict";var r=t("./node_modules/react-is/index.js"),n=t("./node_modules/object-assign/index.js"),a=t("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),i=t("./node_modules/prop-types/checkPropTypes.js"),o=Function.call.bind(Object.prototype.hasOwnProperty),l=function(){};function u(){return null}l=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}},module.exports=function(e,t){var c="function"==typeof Symbol&&Symbol.iterator,d="@@iterator",p="<<anonymous>>",h={array:y("array"),bool:y("boolean"),func:y("function"),number:y("number"),object:y("object"),string:y("string"),symbol:y("symbol"),any:g(u),arrayOf:function(e){return g((function(t,r,n,i,s){if("function"!=typeof e)return new m("Property `"+s+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var o=t[r];if(!Array.isArray(o))return new m("Invalid "+i+" `"+s+"` of type `"+_(o)+"` supplied to `"+n+"`, expected an array.");for(var l=0;l<o.length;l++){var u=e(o,l,n,i,s+"["+l+"]",a);if(u instanceof Error)return u}return null}))},element:g((function(t,r,n,a,i){var s=t[r];return e(s)?null:new m("Invalid "+a+" `"+i+"` of type `"+_(s)+"` supplied to `"+n+"`, expected a single ReactElement.")})),elementType:g((function(e,t,n,a,i){var s=e[t];return r.isValidElementType(s)?null:new m("Invalid "+a+" `"+i+"` of type `"+_(s)+"` supplied to `"+n+"`, expected a single ReactElement type.")})),instanceOf:function(e){return g((function(t,r,n,a,i){if(!(t[r]instanceof e)){var s=e.name||p;return new m("Invalid "+a+" `"+i+"` of type `"+((o=t[r]).constructor&&o.constructor.name?o.constructor.name:p)+"` supplied to `"+n+"`, expected instance of `"+s+"`.")}var o;return null}))},node:g((function(e,t,r,n,a){return v(e[t])?null:new m("Invalid "+n+" `"+a+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(e){return g((function(t,r,n,i,s){if("function"!=typeof e)return new m("Property `"+s+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var l=t[r],u=_(l);if("object"!==u)return new m("Invalid "+i+" `"+s+"` of type `"+u+"` supplied to `"+n+"`, expected an object.");for(var c in l)if(o(l,c)){var d=e(l,c,n,i,s+"."+c,a);if(d instanceof Error)return d}return null}))},oneOf:function(e){return Array.isArray(e)?g((function(t,r,n,a,i){for(var s=t[r],o=0;o<e.length;o++)if(f(s,e[o]))return null;var l=JSON.stringify(e,(function(e,t){return"symbol"===k(t)?String(t):t}));return new m("Invalid "+a+" `"+i+"` of value `"+String(s)+"` supplied to `"+n+"`, expected one of "+l+".")})):(l(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),u)},oneOfType:function(e){if(!Array.isArray(e))return l("Invalid argument supplied to oneOfType, expected an instance of array."),u;for(var t=0;t<e.length;t++){var r=e[t];if("function"!=typeof r)return l("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+E(r)+" at index "+t+"."),u}return g((function(t,r,n,i,s){for(var o=0;o<e.length;o++)if(null==(0,e[o])(t,r,n,i,s,a))return null;return new m("Invalid "+i+" `"+s+"` supplied to `"+n+"`.")}))},shape:function(e){return g((function(t,r,n,i,s){var o=t[r],l=_(o);if("object"!==l)return new m("Invalid "+i+" `"+s+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");for(var u in e){var c=e[u];if(c){var d=c(o,u,n,i,s+"."+u,a);if(d)return d}}return null}))},exact:function(e){return g((function(t,r,i,s,o){var l=t[r],u=_(l);if("object"!==u)return new m("Invalid "+s+" `"+o+"` of type `"+u+"` supplied to `"+i+"`, expected `object`.");var c=n({},t[r],e);for(var d in c){var p=e[d];if(!p)return new m("Invalid "+s+" `"+o+"` key `"+d+"` supplied to `"+i+"`.\nBad object: "+JSON.stringify(t[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var h=p(l,d,i,s,o+"."+d,a);if(h)return h}return null}))}};function f(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function m(e){this.message=e,this.stack=""}function g(e){var r={},n=0;function i(i,s,o,u,c,d,h){if(u=u||p,d=d||o,h!==a){if(t){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}if("undefined"!=typeof console){var g=u+":"+o;!r[g]&&n<3&&(l("You are manually calling a React.PropTypes validation function for the `"+d+"` prop on `"+u+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),r[g]=!0,n++)}}return null==s[o]?i?null===s[o]?new m("The "+c+" `"+d+"` is marked as required in `"+u+"`, but its value is `null`."):new m("The "+c+" `"+d+"` is marked as required in `"+u+"`, but its value is `undefined`."):null:e(s,o,u,c,d)}var s=i.bind(null,!1);return s.isRequired=i.bind(null,!0),s}function y(e){return g((function(t,r,n,a,i,s){var o=t[r];return _(o)!==e?new m("Invalid "+a+" `"+i+"` of type `"+k(o)+"` supplied to `"+n+"`, expected `"+e+"`."):null}))}function v(t){switch(s(t)){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(v);if(null===t||e(t))return!0;var r=function(e){var t=e&&(c&&e[c]||e[d]);if("function"==typeof t)return t}(t);if(!r)return!1;var n,a=r.call(t);if(r!==t.entries){for(;!(n=a.next()).done;)if(!v(n.value))return!1}else for(;!(n=a.next()).done;){var i=n.value;if(i&&!v(i[1]))return!1}return!0;default:return!1}}function _(e){var t=s(e);return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function k(e){if(null==e)return""+e;var t=_(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function E(e){var t=k(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return m.prototype=Error.prototype,h.checkPropTypes=i,h.resetWarningCache=i.resetWarningCache,h.PropTypes=h,h}},"./node_modules/prop-types/index.js":function(module,e,t){var r=t("./node_modules/react-is/index.js");module.exports=t("./node_modules/prop-types/factoryWithTypeCheckers.js")(r.isElement,!0)},"./node_modules/prop-types/lib/ReactPropTypesSecret.js":function(module){"use strict";module.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},"./node_modules/react-is/cjs/react-is.development.js":function(e,t){"use strict";!function(){var e="function"==typeof Symbol&&Symbol.for,r=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,u=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,m=e?Symbol.for("react.memo"):60115,g=e?Symbol.for("react.lazy"):60116,y=e?Symbol.for("react.block"):60121,v=e?Symbol.for("react.fundamental"):60117,_=e?Symbol.for("react.responder"):60118,k=e?Symbol.for("react.scope"):60119;function E(e){if("object"===s(e)&&null!==e){var t=e.$$typeof;switch(t){case r:var f=e.type;switch(f){case c:case d:case a:case o:case i:case h:return f;default:var y=f&&f.$$typeof;switch(y){case u:case p:case g:case m:case l:return y;default:return t}}case n:return t}}}var b=c,T=d,A=u,S=l,P=r,C=p,x=a,I=g,w=m,R=n,M=o,D=i,O=h,L=!1;function N(e){return E(e)===d}t.AsyncMode=b,t.ConcurrentMode=T,t.ContextConsumer=A,t.ContextProvider=S,t.Element=P,t.ForwardRef=C,t.Fragment=x,t.Lazy=I,t.Memo=w,t.Portal=R,t.Profiler=M,t.StrictMode=D,t.Suspense=O,t.isAsyncMode=function(e){return L||(L=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),N(e)||E(e)===c},t.isConcurrentMode=N,t.isContextConsumer=function(e){return E(e)===u},t.isContextProvider=function(e){return E(e)===l},t.isElement=function(e){return"object"===s(e)&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return E(e)===p},t.isFragment=function(e){return E(e)===a},t.isLazy=function(e){return E(e)===g},t.isMemo=function(e){return E(e)===m},t.isPortal=function(e){return E(e)===n},t.isProfiler=function(e){return E(e)===o},t.isStrictMode=function(e){return E(e)===i},t.isSuspense=function(e){return E(e)===h},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===d||e===o||e===i||e===h||e===f||"object"===s(e)&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===p||e.$$typeof===v||e.$$typeof===_||e.$$typeof===k||e.$$typeof===y)},t.typeOf=E}()},"./node_modules/react-is/index.js":function(module,e,t){"use strict";module.exports=t("./node_modules/react-is/cjs/react-is.development.js")},"./node_modules/react-redux/es/components/Context.js":function(e,t,r){"use strict";r.r(t),r.d(t,{ReactReduxContext:function(){return n}});var n=r("./node_modules/preact/compat/dist/compat.module.js").default.createContext(null);n.displayName="ReactRedux",t.default=n},"./node_modules/react-redux/es/components/Provider.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/preact/compat/dist/compat.module.js"),a=r("./node_modules/prop-types/index.js"),i=r.n(a),s=r("./node_modules/react-redux/es/components/Context.js"),o=r("./node_modules/react-redux/es/utils/Subscription.js");function l(e){var t=e.store,r=e.context,a=e.children,i=(0,n.useMemo)((function(){var e=new o.default(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),l=(0,n.useMemo)((function(){return t.getState()}),[t]);(0,n.useEffect)((function(){var e=i.subscription;return e.trySubscribe(),l!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[i,l]);var u=r||s.ReactReduxContext;return n.default.createElement(u.Provider,{value:i},a)}l.propTypes={store:i().shape({subscribe:i().func.isRequired,dispatch:i().func.isRequired,getState:i().func.isRequired}),context:i().object,children:i().any},t.default=l},"./node_modules/react-redux/es/components/connectAdvanced.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var n=r("./node_modules/@babel/runtime/helpers/esm/extends.js"),a=r("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),i=r("./node_modules/hoist-non-react-statics/dist/hoist-non-react-statics.cjs.js"),s=r.n(i),o=r("./node_modules/preact/compat/dist/compat.module.js"),l=r("./node_modules/react-is/index.js"),u=r("./node_modules/react-redux/es/utils/Subscription.js"),c=r("./node_modules/react-redux/es/utils/useIsomorphicLayoutEffect.js"),d=r("./node_modules/react-redux/es/components/Context.js"),p=[],h=[null,null],f=function(e){try{return JSON.stringify(e)}catch(t){return String(e)}};function m(e,t){var r=e[1];return[t.payload,r+1]}function g(e,t,r){(0,c.useIsomorphicLayoutEffect)((function(){return e.apply(void 0,t)}),r)}function y(e,t,r,n,a,i,s){e.current=n,t.current=a,r.current=!1,i.current&&(i.current=null,s())}function v(e,t,r,n,a,i,s,o,l,u){if(e){var c=!1,d=null,p=function(){if(!c){var e,r,p=t.getState();try{e=n(p,a.current)}catch(e){r=e,d=e}r||(d=null),e===i.current?s.current||l():(i.current=e,o.current=e,s.current=!0,u({type:"STORE_UPDATED",payload:{error:r}}))}};return r.onStateChange=p,r.trySubscribe(),p(),function(){if(c=!0,r.tryUnsubscribe(),r.onStateChange=null,d)throw d}}}var _=function(){return[null,0]};function k(e,t){void 0===t&&(t={});var r=t,i=r.getDisplayName,c=void 0===i?function(e){return"ConnectAdvanced("+e+")"}:i,k=r.methodName,E=void 0===k?"connectAdvanced":k,b=r.renderCountProp,T=void 0===b?void 0:b,A=r.shouldHandleStateChanges,S=void 0===A||A,P=r.storeKey,C=void 0===P?"store":P,x=r.withRef,I=void 0!==x&&x,w=r.forwardRef,R=void 0!==w&&w,M=r.context,D=void 0===M?d.ReactReduxContext:M,O=(0,a.default)(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]);if(void 0!==T)throw new Error("renderCountProp is removed. render counting is built into the latest React Dev Tools profiling extension");if(I)throw new Error("withRef is removed. To access the wrapped instance, use a ref on the connected component");if("store"!==C)throw new Error("storeKey has been removed and does not do anything. To use a custom Redux store for specific components, create a custom React context with React.createContext(), and pass the context object to React Redux's Provider and specific components like: <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. You may also pass a {context : MyContext} option to connect");var L=D;return function(t){if(!(0,l.isValidElementType)(t))throw new Error("You must pass a component to the function returned by "+E+". Instead received "+f(t));var r=t.displayName||t.name||"Component",i=c(r),d=(0,n.default)({},O,{getDisplayName:c,methodName:E,renderCountProp:T,shouldHandleStateChanges:S,storeKey:C,displayName:i,wrappedComponentName:r,WrappedComponent:t}),k=O.pure,b=k?o.useMemo:function(e){return e()};function A(r){var s=(0,o.useMemo)((function(){var e=r.reactReduxForwardedRef,t=(0,a.default)(r,["reactReduxForwardedRef"]);return[r.context,e,t]}),[r]),c=s[0],f=s[1],k=s[2],E=(0,o.useMemo)((function(){return c&&c.Consumer&&(0,l.isContextConsumer)(o.default.createElement(c.Consumer,null))?c:L}),[c,L]),T=(0,o.useContext)(E),A=Boolean(r.store)&&Boolean(r.store.getState)&&Boolean(r.store.dispatch),P=Boolean(T)&&Boolean(T.store);if(!A&&!P)throw new Error('Could not find "store" in the context of "'+i+'". Either wrap the root component in a <Provider>, or pass a custom React context provider to <Provider> and the corresponding React context consumer to '+i+" in connect options.");var C=A?r.store:T.store,x=(0,o.useMemo)((function(){return function(t){return e(t.dispatch,d)}(C)}),[C]),I=(0,o.useMemo)((function(){if(!S)return h;var e=new u.default(C,A?null:T.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[C,A,T]),w=I[0],R=I[1],M=(0,o.useMemo)((function(){return A?T:(0,n.default)({},T,{subscription:w})}),[A,T,w]),D=(0,o.useReducer)(m,p,_),O=D[0][0],N=D[1];if(O&&O.error)throw O.error;var U=(0,o.useRef)(),j=(0,o.useRef)(k),B=(0,o.useRef)(),F=(0,o.useRef)(!1),V=b((function(){return B.current&&k===j.current?B.current:x(C.getState(),k)}),[C,O,k]);g(y,[j,U,F,k,V,B,R]),g(v,[S,C,w,x,j,U,F,B,R,N],[C,w,x]);var G=(0,o.useMemo)((function(){return o.default.createElement(t,(0,n.default)({},V,{ref:f}))}),[f,t,V]);return(0,o.useMemo)((function(){return S?o.default.createElement(E.Provider,{value:M},G):G}),[E,G,M])}var P=k?o.default.memo(A):A;if(P.WrappedComponent=t,P.displayName=i,R){var x=o.default.forwardRef((function(e,t){return o.default.createElement(P,(0,n.default)({},e,{reactReduxForwardedRef:t}))}));return x.displayName=i,x.WrappedComponent=t,s()(x,t)}return s()(P,t)}}},"./node_modules/react-redux/es/connect/connect.js":function(e,t,r){"use strict";r.r(t),r.d(t,{createConnect:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/esm/extends.js"),a=r("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),i=r("./node_modules/react-redux/es/components/connectAdvanced.js"),o=r("./node_modules/react-redux/es/utils/shallowEqual.js"),l=r("./node_modules/react-redux/es/connect/mapDispatchToProps.js"),u=r("./node_modules/react-redux/es/connect/mapStateToProps.js"),c=r("./node_modules/react-redux/es/connect/mergeProps.js"),d=r("./node_modules/react-redux/es/connect/selectorFactory.js");function p(e,t,r){for(var n=t.length-1;n>=0;n--){var a=t[n](e);if(a)return a}return function(t,n){throw new Error("Invalid value of type "+s(e)+" for "+r+" argument when connecting component "+n.wrappedComponentName+".")}}function h(e,t){return e===t}function f(e){var t=void 0===e?{}:e,r=t.connectHOC,s=void 0===r?i.default:r,f=t.mapStateToPropsFactories,m=void 0===f?u.default:f,g=t.mapDispatchToPropsFactories,y=void 0===g?l.default:g,v=t.mergePropsFactories,_=void 0===v?c.default:v,k=t.selectorFactory,E=void 0===k?d.default:k;return function(e,t,r,i){void 0===i&&(i={});var l=i,u=l.pure,c=void 0===u||u,d=l.areStatesEqual,f=void 0===d?h:d,g=l.areOwnPropsEqual,v=void 0===g?o.default:g,k=l.areStatePropsEqual,b=void 0===k?o.default:k,T=l.areMergedPropsEqual,A=void 0===T?o.default:T,S=(0,a.default)(l,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),P=p(e,m,"mapStateToProps"),C=p(t,y,"mapDispatchToProps"),x=p(r,_,"mergeProps");return s(E,(0,n.default)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:P,initMapDispatchToProps:C,initMergeProps:x,pure:c,areStatesEqual:f,areOwnPropsEqual:v,areStatePropsEqual:b,areMergedPropsEqual:A},S))}}t.default=f()},"./node_modules/react-redux/es/connect/mapDispatchToProps.js":function(e,t,r){"use strict";r.r(t),r.d(t,{whenMapDispatchToPropsIsFunction:function(){return i},whenMapDispatchToPropsIsMissing:function(){return o},whenMapDispatchToPropsIsObject:function(){return l}});var n=r("./node_modules/redux/es/redux.js"),a=r("./node_modules/react-redux/es/connect/wrapMapToProps.js");function i(e){return"function"==typeof e?(0,a.wrapMapToPropsFunc)(e,"mapDispatchToProps"):void 0}function o(e){return e?void 0:(0,a.wrapMapToPropsConstant)((function(e){return{dispatch:e}}))}function l(e){return e&&"object"===s(e)?(0,a.wrapMapToPropsConstant)((function(t){return(0,n.bindActionCreators)(e,t)})):void 0}t.default=[i,o,l]},"./node_modules/react-redux/es/connect/mapStateToProps.js":function(e,t,r){"use strict";r.r(t),r.d(t,{whenMapStateToPropsIsFunction:function(){return a},whenMapStateToPropsIsMissing:function(){return i}});var n=r("./node_modules/react-redux/es/connect/wrapMapToProps.js");function a(e){return"function"==typeof e?(0,n.wrapMapToPropsFunc)(e,"mapStateToProps"):void 0}function i(e){return e?void 0:(0,n.wrapMapToPropsConstant)((function(){return{}}))}t.default=[a,i]},"./node_modules/react-redux/es/connect/mergeProps.js":function(e,t,r){"use strict";r.r(t),r.d(t,{defaultMergeProps:function(){return i},whenMergePropsIsFunction:function(){return o},whenMergePropsIsOmitted:function(){return l},wrapMergePropsFunc:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/extends.js"),a=r("./node_modules/react-redux/es/utils/verifyPlainObject.js");function i(e,t,r){return(0,n.default)({},r,{},e,{},t)}function s(e){return function(t,r){var n,i=r.displayName,s=r.pure,o=r.areMergedPropsEqual,l=!1;return function(t,r,u){var c=e(t,r,u);return l?s&&o(c,n)||(n=c):(l=!0,n=c,(0,a.default)(n,i,"mergeProps")),n}}}function o(e){return"function"==typeof e?s(e):void 0}function l(e){return e?void 0:function(){return i}}t.default=[o,l]},"./node_modules/react-redux/es/connect/selectorFactory.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o},impureFinalPropsSelectorFactory:function(){return i},pureFinalPropsSelectorFactory:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),a=r("./node_modules/react-redux/es/connect/verifySubselectors.js");function i(e,t,r,n){return function(a,i){return r(e(a,i),t(n,i),i)}}function s(e,t,r,n,a){var i,s,o,l,u,c=a.areStatesEqual,d=a.areOwnPropsEqual,p=a.areStatePropsEqual,h=!1;function f(a,h){var f,m,g=!d(h,s),y=!c(a,i);return i=a,s=h,g&&y?(o=e(i,s),t.dependsOnOwnProps&&(l=t(n,s)),u=r(o,l,s)):g?(e.dependsOnOwnProps&&(o=e(i,s)),t.dependsOnOwnProps&&(l=t(n,s)),u=r(o,l,s)):y?(f=e(i,s),m=!p(f,o),o=f,m&&(u=r(o,l,s)),u):u}return function(a,c){return h?f(a,c):(o=e(i=a,s=c),l=t(n,s),u=r(o,l,s),h=!0,u)}}function o(e,t){var r=t.initMapStateToProps,o=t.initMapDispatchToProps,l=t.initMergeProps,u=(0,n.default)(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),c=r(e,u),d=o(e,u),p=l(e,u);return(0,a.default)(c,d,p,u.displayName),(u.pure?s:i)(c,d,p,e,u)}},"./node_modules/react-redux/es/connect/verifySubselectors.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/react-redux/es/utils/warning.js");function a(e,t,r){if(!e)throw new Error("Unexpected value for "+t+" in "+r+".");"mapStateToProps"!==t&&"mapDispatchToProps"!==t||Object.prototype.hasOwnProperty.call(e,"dependsOnOwnProps")||(0,n.default)("The selector for "+t+" of "+r+" did not specify a value for dependsOnOwnProps.")}function i(e,t,r,n){a(e,"mapStateToProps",n),a(t,"mapDispatchToProps",n),a(r,"mergeProps",n)}},"./node_modules/react-redux/es/connect/wrapMapToProps.js":function(e,t,r){"use strict";r.r(t),r.d(t,{getDependsOnOwnProps:function(){return i},wrapMapToPropsConstant:function(){return a},wrapMapToPropsFunc:function(){return s}});var n=r("./node_modules/react-redux/es/utils/verifyPlainObject.js");function a(e){return function(t,r){var n=e(t,r);function a(){return n}return a.dependsOnOwnProps=!1,a}}function i(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function s(e,t){return function(r,a){var s=a.displayName,o=function(e,t){return o.dependsOnOwnProps?o.mapToProps(e,t):o.mapToProps(e)};return o.dependsOnOwnProps=!0,o.mapToProps=function(r,a){o.mapToProps=e,o.dependsOnOwnProps=i(e);var l=o(r,a);return"function"==typeof l&&(o.mapToProps=l,o.dependsOnOwnProps=i(l),l=o(r,a)),(0,n.default)(l,s,t),l},o}}},"./node_modules/react-redux/es/hooks/useDispatch.js":function(e,t,r){"use strict";r.r(t),r.d(t,{createDispatchHook:function(){return i},useDispatch:function(){return s}});var n=r("./node_modules/react-redux/es/components/Context.js"),a=r("./node_modules/react-redux/es/hooks/useStore.js");function i(e){void 0===e&&(e=n.ReactReduxContext);var t=e===n.ReactReduxContext?a.useStore:(0,a.createStoreHook)(e);return function(){return t().dispatch}}var s=i()},"./node_modules/react-redux/es/hooks/useReduxContext.js":function(e,t,r){"use strict";r.r(t),r.d(t,{useReduxContext:function(){return i}});var n=r("./node_modules/preact/compat/dist/compat.module.js"),a=r("./node_modules/react-redux/es/components/Context.js");function i(){var e=(0,n.useContext)(a.ReactReduxContext);if(!e)throw new Error("could not find react-redux context value; please ensure the component is wrapped in a <Provider>");return e}},"./node_modules/react-redux/es/hooks/useSelector.js":function(e,t,r){"use strict";r.r(t),r.d(t,{createSelectorHook:function(){return u},useSelector:function(){return c}});var n=r("./node_modules/preact/compat/dist/compat.module.js"),a=r("./node_modules/react-redux/es/hooks/useReduxContext.js"),i=r("./node_modules/react-redux/es/utils/Subscription.js"),s=r("./node_modules/react-redux/es/utils/useIsomorphicLayoutEffect.js"),o=r("./node_modules/react-redux/es/components/Context.js"),l=function(e,t){return e===t};function u(e){void 0===e&&(e=o.ReactReduxContext);var t=e===o.ReactReduxContext?a.useReduxContext:function(){return(0,n.useContext)(e)};return function(e,r){if(void 0===r&&(r=l),!e)throw new Error("You must pass a selector to useSelector");var a=t(),o=function(e,t,r,a){var o,l=(0,n.useReducer)((function(e){return e+1}),0)[1],u=(0,n.useMemo)((function(){return new i.default(r,a)}),[r,a]),c=(0,n.useRef)(),d=(0,n.useRef)(),p=(0,n.useRef)(),h=(0,n.useRef)(),f=r.getState();try{o=e!==d.current||f!==p.current||c.current?e(f):h.current}catch(e){throw c.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+c.current.stack+"\n\n"),e}return(0,s.useIsomorphicLayoutEffect)((function(){d.current=e,p.current=f,h.current=o,c.current=void 0})),(0,s.useIsomorphicLayoutEffect)((function(){function e(){try{var e=d.current(r.getState());if(t(e,h.current))return;h.current=e}catch(e){c.current=e}l()}return u.onStateChange=e,u.trySubscribe(),e(),function(){return u.tryUnsubscribe()}}),[r,u]),o}(e,r,a.store,a.subscription);return(0,n.useDebugValue)(o),o}}var c=u()},"./node_modules/react-redux/es/hooks/useStore.js":function(e,t,r){"use strict";r.r(t),r.d(t,{createStoreHook:function(){return s},useStore:function(){return o}});var n=r("./node_modules/preact/compat/dist/compat.module.js"),a=r("./node_modules/react-redux/es/components/Context.js"),i=r("./node_modules/react-redux/es/hooks/useReduxContext.js");function s(e){void 0===e&&(e=a.ReactReduxContext);var t=e===a.ReactReduxContext?i.useReduxContext:function(){return(0,n.useContext)(e)};return function(){return t().store}}var o=s()},"./node_modules/react-redux/es/index.js":function(e,t,r){"use strict";r.r(t),r.d(t,{Provider:function(){return n.default},ReactReduxContext:function(){return i.ReactReduxContext},batch:function(){return d.unstable_batchedUpdates},connect:function(){return s.default},connectAdvanced:function(){return a.default},createDispatchHook:function(){return o.createDispatchHook},createSelectorHook:function(){return l.createSelectorHook},createStoreHook:function(){return u.createStoreHook},shallowEqual:function(){return p.default},useDispatch:function(){return o.useDispatch},useSelector:function(){return l.useSelector},useStore:function(){return u.useStore}});var n=r("./node_modules/react-redux/es/components/Provider.js"),a=r("./node_modules/react-redux/es/components/connectAdvanced.js"),i=r("./node_modules/react-redux/es/components/Context.js"),s=r("./node_modules/react-redux/es/connect/connect.js"),o=r("./node_modules/react-redux/es/hooks/useDispatch.js"),l=r("./node_modules/react-redux/es/hooks/useSelector.js"),u=r("./node_modules/react-redux/es/hooks/useStore.js"),c=r("./node_modules/react-redux/es/utils/batch.js"),d=r("./node_modules/react-redux/es/utils/reactBatchedUpdates.js"),p=r("./node_modules/react-redux/es/utils/shallowEqual.js");(0,c.setBatch)(d.unstable_batchedUpdates)},"./node_modules/react-redux/es/utils/Subscription.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/react-redux/es/utils/batch.js"),a={notify:function(){}},i=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=a,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){var e,t,r;this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=(e=(0,n.getBatch)(),t=null,r=null,{clear:function(){t=null,r=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],r=t;r;)e.push(r),r=r.next;return e},subscribe:function(e){var n=!0,a=r={callback:e,next:null,prev:r};return a.prev?a.prev.next=a:t=a,function(){n&&null!==t&&(n=!1,a.next?a.next.prev=a.prev:r=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}))},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=a)},e}()},"./node_modules/react-redux/es/utils/batch.js":function(e,t,r){"use strict";r.r(t),r.d(t,{getBatch:function(){return i},setBatch:function(){return a}});var n=function(e){e()},a=function(e){return n=e},i=function(){return n}},"./node_modules/react-redux/es/utils/isPlainObject.js":function(e,t,r){"use strict";function n(e){if("object"!==s(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var r=t;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return t===r}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/react-redux/es/utils/reactBatchedUpdates.js":function(e,t,r){"use strict";r.r(t),r.d(t,{unstable_batchedUpdates:function(){return n.unstable_batchedUpdates}});var n=r("./node_modules/preact/compat/dist/compat.module.js")},"./node_modules/react-redux/es/utils/shallowEqual.js":function(e,t,r){"use strict";function n(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function a(e,t){if(n(e,t))return!0;if("object"!==s(e)||null===e||"object"!==s(t)||null===t)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(var i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!n(e[r[i]],t[r[i]]))return!1;return!0}r.r(t),r.d(t,{default:function(){return a}})},"./node_modules/react-redux/es/utils/useIsomorphicLayoutEffect.js":function(e,t,r){"use strict";r.r(t),r.d(t,{useIsomorphicLayoutEffect:function(){return a}});var n=r("./node_modules/preact/compat/dist/compat.module.js"),a="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?n.useLayoutEffect:n.useEffect},"./node_modules/react-redux/es/utils/verifyPlainObject.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/react-redux/es/utils/isPlainObject.js"),a=r("./node_modules/react-redux/es/utils/warning.js");function i(e,t,r){(0,n.default)(e)||(0,a.default)(r+"() in "+t+" must return a plain object. Instead received "+e+".")}},"./node_modules/react-redux/es/utils/warning.js":function(e,t,r){"use strict";function n(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/redux/es/redux.js":function(e,t,r){"use strict";r.r(t),r.d(t,{__DO_NOT_USE__ActionTypes:function(){return i},applyMiddleware:function(){return y},bindActionCreators:function(){return h},combineReducers:function(){return d},compose:function(){return g},createStore:function(){return l}});var n=r("./node_modules/symbol-observable/es/index.js"),a=function(){return Math.random().toString(36).substring(7).split("").join(".")},i={INIT:"@@redux/INIT"+a(),REPLACE:"@@redux/REPLACE"+a(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+a()}};function o(e){if("object"!==s(e)||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function l(e,t,r){var a;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(l)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var u=e,c=t,d=[],p=d,h=!1;function f(){p===d&&(p=d.slice())}function m(){if(h)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return c}function g(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(h)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return f(),p.push(e),function(){if(t){if(h)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,f();var r=p.indexOf(e);p.splice(r,1),d=null}}}function y(e){if(!o(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(h)throw new Error("Reducers may not dispatch actions.");try{h=!0,c=u(c,e)}finally{h=!1}for(var t=d=p,r=0;r<t.length;r++)(0,t[r])();return e}return y({type:i.INIT}),(a={dispatch:y,subscribe:g,getState:m,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");u=e,y({type:i.REPLACE})}})[n.default]=function(){var e,t=g;return(e={subscribe:function(e){if("object"!==s(e)||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(m())}return r(),{unsubscribe:t(r)}}})[n.default]=function(){return this},e},a}function u(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}function c(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function d(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var a=t[n];void 0===e[a]&&u('No reducer provided for key "'+a+'"'),"function"==typeof e[a]&&(r[a]=e[a])}var s,l,d=Object.keys(r);s={};try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:i.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:i.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+i.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){l=e}return function(e,t){if(void 0===e&&(e={}),l)throw l;var n=function(e,t,r,n){var a=Object.keys(t),s=r&&r.type===i.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(0===a.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!o(e))return"The "+s+' has unexpected type of "'+{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1]+'". Expected argument to be an object with the following keys: "'+a.join('", "')+'"';var l=Object.keys(e).filter((function(e){return!t.hasOwnProperty(e)&&!n[e]}));return l.forEach((function(e){n[e]=!0})),r&&r.type===i.REPLACE?void 0:l.length>0?"Unexpected "+(l.length>1?"keys":"key")+' "'+l.join('", "')+'" found in '+s+'. Expected to find one of the known reducer keys instead: "'+a.join('", "')+'". Unexpected keys will be ignored.':void 0}(e,r,t,s);n&&u(n);for(var a=!1,p={},h=0;h<d.length;h++){var f=d[h],m=r[f],g=e[f],y=m(g,t);if(void 0===y){var v=c(f,t);throw new Error(v)}p[f]=y,a=a||y!==g}return(a=a||d.length!==Object.keys(e).length)?p:e}}function p(e,t){return function(){return t(e.apply(this,arguments))}}function h(e,t){if("function"==typeof e)return p(e,t);if("object"!==s(e)||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":s(e))+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var a=e[n];"function"==typeof a&&(r[n]=p(a,t))}return r}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function g(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function y(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},a={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},i=t.map((function(e){return e(a)}));return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(r,!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r,{dispatch:n=g.apply(void 0,i)(r.dispatch)})}}}function v(){}"string"==typeof v.name&&"isCrushed"!==v.name&&u('You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) to ensure you have the correct code for your production build.')},"./src/styles/style.scss":function(module,e,t){var r=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),n=t("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/styles/style.scss");"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[module.id,n,""]]);var a={attributes:{id:"@playkit-js/playkit-js-ui"},insert:function(e){var t;"string"==typeof(null===(t=window.kalturaGlobalConfig)||void 0===t?void 0:t.stylesNonce)&&e.setAttribute("nonce",window.kalturaGlobalConfig.stylesNonce),document.head.appendChild(e)},singleton:!1};r(n,a),module.exports=n.locals||{}},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":function(module,e,t){"use strict";var r,n=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),i=[];function s(e){for(var t=-1,r=0;r<i.length;r++)if(i[r].identifier===e){t=r;break}return t}function o(e,t){for(var r={},n=[],a=0;a<e.length;a++){var o=e[a],l=t.base?o[0]+t.base:o[0],u=r[l]||0,c="".concat(l," ").concat(u);r[l]=u+1;var d=s(c),p={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(i[d].references++,i[d].updater(p)):i.push({identifier:c,updater:m(p,t),references:1}),n.push(c)}return n}function l(e){var r=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var i=t.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(e){r.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(r);else{var s=a(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(r)}return r}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,r,n){var a=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=c(t,a);else{var i=document.createTextNode(a),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function p(e,t,r){var n=r.css,a=r.media,i=r.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),i&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var h=null,f=0;function m(e,t){var r,n,a;if(t.singleton){var i=f++;r=h||(h=l(t)),n=d.bind(null,r,i,!1),a=d.bind(null,r,i,!0)}else r=l(t),n=p.bind(null,r,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else a()}}module.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var r=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<r.length;n++){var a=s(r[n]);i[a].references--}for(var l=o(e,t),u=0;u<r.length;u++){var c=s(r[u]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}r=l}}}},"./node_modules/symbol-observable/es/index.js":function(module,e,t){"use strict";t.r(e);var r,n=t("./node_modules/symbol-observable/es/ponyfill.js");module=t.hmd(module),r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t.g?t.g:module;var a=(0,n.default)(r);e.default=a},"./node_modules/symbol-observable/es/ponyfill.js":function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.r(t),r.d(t,{default:function(){return n}})},"@playkit-js/playkit-js":function(module){"use strict";module.exports=e},"./node_modules/@babel/runtime/helpers/esm/extends.js":function(e,t,r){"use strict";function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n.apply(this,arguments)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js":function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}r.r(t),r.d(t,{default:function(){return n}})},"./translations/en.i18n.json":function(module){"use strict";module.exports=JSON.parse('{"en":{"controls":{"play":"Play","pause":"Pause","stop":"Stop","title":"title","language":"Language","settings":"Settings","fullscreen":"Fullscreen","fullscreenExit":"Exit fullscreen","rewind":"Seek backwards","secondsRewind":"Seek {{seconds}} seconds backwards","forward":"Seek forward","secondsForward":"Seek {{seconds}} seconds forward","vrStereo":"vrStereo","closedCaptionsOn":"Disable Captions","closedCaptionsOff":"Enable Captions","live":"Live","mute":"Mute","unmute":"Unmute","next":"Next","prev":"Prev","startOver":"Start over","pictureInPicture":"Picture in picture","pictureInPictureExit":"Exit picture in picture","logo":"Logo","seekBarSlider":"Seek bar","readLess":"Less","readMore":"More","valuetextLabel":"of"},"unmute":{"unmute":"Unmute"},"volume":{"muted_click_to_unmute":"Muted. Click to unmute","volume_click_to_mute":"{{vol}}% volume. Click to mute","ten_percent":"ten percent","twenty_percent":"twenty percent","thirty_percent":"thirty percent","fourty_percent":"forty percent","fifty_percent":"fifty percent","sixty_percent":"sixty percent","seventy_percent":"seventy percent","eighty_percent":"eighty percent","ninety_percent":"ninety percent","one_hundred_percent":"one hundred percent","volume_button_aria_label":"Volume","volume_button_description":"Click to volume control","volume_slider_aria_label":"Volume control","volume_slider_description":"Use the arrows to control the volume"},"copy":{"button":"Copy URL"},"settings":{"title":"Settings","audio":"Audio","quality":"Quality","speed":"Speed","speedNormal":"Normal","qualityAuto":"Auto","qualityHdLabel":"Quality is HD","quality4kLabel":"Quality is 4k","quality8kLabel":"Quality is 8k","advanced_audio_description":"Extended Audio Description","advanced_audio_description_enabled":"Disable Extended Audio Description","advanced_audio_description_disabled":"Enable Extended Audio Description"},"captions":{"captions":"Captions","advanced_captions_settings":"Advanced captions settings"},"overlay":{"close":"Close"},"error":{"default_error_title":"Something went wrong","default_error_message":"An error occurred, please try again later.","network_error_title":"Theres a problem with your network","network_error_message":"Please check your network connection and try again.","media_unavailable_error_title":"Media unavailable","media_unavailable_error_message":"This media has been restricted. Please obtain relevant permissions to access content.","text_error_title":"Text stream error","text_error_message":"Text stream error occurred","media_error_title":"Media stream error","media_error_message":"One or more media streams have failed.","manifest_error_title":"Play manifest error","manifest_error_message":"Error processing the play manifest.","streaming_error_title":"Cannot load stream","streaming_error_message":"A streaming protocol error occurred.","drm_error_message":"You dont have permissions to view this media.","media_not_ready_error_title":"Media is being processed","media_not_ready_error_message":"Media is processing, check back soon.","geo_location_error_title":"Geo location unavailable","geo_location_error_message":"This content is unavailable in your region.","ip_restricted_error_message":"This media has been restricted to certain IP addresses.","site_restricted_error_message":"This content is unavailable in this domain.","scheduled_restricted_error_message":"This content is currently unavailable.","default_session_text":"Copy for customer care: session ID","retry":"Try again","error_title":"Error","access_control_error_message":"Blocked by Conditional Access","copy_debug_info":"Copy debug info"},"ads":{"ad_notice":"Advertisement","learn_more":"Learn more","skip_ad":"Skip ad","skip_in":"Skip in"},"cvaa":{"title":"Advanced captions settings","sample_caption_tag":"Sample {{number}}","sample_custom_caption_tag":"Custom captions","set_custom_caption":"Set custom caption","edit_caption":"Edit caption","size_label":"Size","font_color_label":"Font color","font_alignment_label":"Font alignment","font_family_label":"Font family","font_style_label":"Font style","font_opacity_label":"Font opacity","background_color_label":"Background color","background_opacity_label":"Background opacity","apply":"Apply","caption_preview":"This is your caption preview","close_label":"Close Advanced captions settings"},"cast":{"play_on_tv":"Play on TV","disconnect_from_tv":"Disconnect from TV","status":{"connecting_to":"Connecting to","connected_to":"Connected to","playing_on":"Playing on"}},"playlist":{"prev":"Previous","next":"Next","up_next":"Up Next","up_next_in":"Up next in","cancel":"Cancel"},"pictureInPicture":{"overlay_text":"Playing in Picture In Picture mode"},"watermark":{"watermark_alt_text":"Watermark"},"spinner":{"loading":"Loading"}}}')}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var module=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(module.exports,module,module.exports,n),module.loaded=!0,module.exports}return n.n=function(module){var e=module&&module.__esModule?function(){return module.default}:function(){return module};return n.d(e,{a:e}),e},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===("undefined"==typeof globalThis?"undefined":s(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===("undefined"==typeof window?"undefined":s(window)))return window}}(),n.hmd=function(module){return(module=Object.create(module)).children||(module.children=[]),Object.defineProperty(module,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+module.id)}}),module},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0,n("./src/index.ts")}()},"object"===s(e)&&"object"===s(module)?module.exports=i(t(771)):(n=[t(771)],void 0===(a="function"==typeof(r=i)?r.apply(e,n):r)||(module.exports=a))},538:(module,e,t)=>{var r,n,a,i;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}module=t.nmd(module),self,i=function(){return function(){var e={"./src/ads/ad-break-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdBreakType:function(){return n}});var n={PRE:"preroll",MID:"midroll",POST:"postroll",OVERLAY:"overlay"}},"./src/ads/ad-error-code.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdErrorCode:function(){return n}});var n={XML_PARSING_ERROR:8100,VAST_SCHEMA_VALIDATION_ERROR:8101,VAST_RESPONSE_VERSION_NOT_SUPPORTED:8102,TRAFFICKING_ERROR:8200,VAST_UNEXPECTED_LINEARITY:8201,VAST_UNEXPECTED_DURATION_ERROR:8202,VAST_UNEXPECTED_SIZE_ERROR:8203,VAST_WRAPPER_ERROR:8300,VAST_URI_ERROR:8301,VAST_TOO_MANY_REDIRECTS:8302,NO_ADS_VAST_RESPONSE:8303,GENERAL_LINEAR_ERROR:8400,FILE_NOT_FOUND:8401,VAST_MEDIA_LOAD_TIMEOUT:8402,MEDIA_FILE_NOT_FOUND:8403,MEDIA_FILE_DISPLAY_ERROR:8405,MEZZANINE_FILE_NOT_PROVIDED:8406,MEZZANINE_DOWNLOADED_FOR_THE_FIRST_TIME:8407,VAST_RESPONSE_AD_REJECTED:8408,CREATIVE_WAS_NOT_EXECUTED:8409,CODE_REFERENCED_NOT_EXECUTED:8410,GENERAL_NON_LINEAR_AD_ERROR:8500,NON_LINEAR_CREATIVE_DIMENSIONS_NOT_ALIGN_ERROR:8501,NON_LINEAR_FETCH_ERROR:8502,NON_LINEAR_RESOURCE_NOT_FOUND:8503,GENERAL_COMPANION_ADS_ERROR:8600,COMPANION_DIMENSIONS_NOT_FIT:8601,COMPANION_CANNOT_BE_DISPLAY:8602,COMPANION_CANNOT_BE_FETCHED:8603,COMPANION_TYPE_NOT_FOUND:8604,AD_UNDEFINED_ERROR:8900,GENERAL_VPAID_ERROR:8901}},"./src/ads/ad-event-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdEventType:function(){return n}});var n={AD_CAN_SKIP:"adcanskip",AD_MANIFEST_LOADED:"admanifestloaded",AD_LOADED:"adloaded",AD_STARTED:"adstarted",AD_RESUMED:"adresumed",AD_PAUSED:"adpaused",AD_CLICKED:"adclicked",AD_SKIPPED:"adskipped",AD_COMPLETED:"adcompleted",AD_ERROR:"aderror",ADS_COMPLETED:"adscompleted",ALL_ADS_COMPLETED:"alladscompleted",AD_BREAK_START:"adbreakstart",AD_BREAK_END:"adbreakend",AD_FIRST_QUARTILE:"adfirstquartile",AD_MIDPOINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",USER_CLOSED_AD:"userclosedad",AD_VOLUME_CHANGED:"advolumechanged",AD_MUTED:"admuted",AD_PROGRESS:"adprogress",AD_BUFFERING:"adbuffering",AD_WATERFALLING:"adwaterfalling",AD_WATERFALLING_FAILED:"adwaterfallingfailed",AD_AUTOPLAY_FAILED:"adautoplayfailed"}},"./src/ads/ad-tag-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdTagType:function(){return n}});var n={VAST:"vast",VMAP:"vmap"}},"./src/drm/drm-scheme.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{DrmScheme:function(){return n}});var n={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"}},"./src/drm/fairplay.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/drm/drm-scheme.ts"),s=(0,r("./src/utils/logger.ts").default)("FairPlay"),o=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"isConfigured",value:function(e,t){return i.DrmScheme.FAIRPLAY===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))}},{key:"canPlayDrm",value:function(e){var t=e.some((function(e){return e.scheme===i.DrmScheme.FAIRPLAY}))&&!!window.WebKitMediaKeys;return s.debug("Can play DRM scheme of: ".concat(i.DrmScheme.FAIRPLAY," is ").concat(t.toString())),t}},{key:"setDrmPlayback",value:function(e,t){s.debug("Sets drm playback");var r=t.find((function(e){return e.scheme===i.DrmScheme.FAIRPLAY}));r&&(e.licenseUrl=r.licenseUrl,e.certificate=r.certificate)}}]),e}();t.default=o},"./src/engines/dropped-frames-watcher.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{DroppedFramesWatcher:function(){return y}});var n=r("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),o=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),l=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=r("./src/event/fake-event-target.ts"),p=r("./src/utils/logger.ts"),h=r("./src/event/event-type.ts"),f=r("./src/event/event-manager.ts"),m=r("./src/event/fake-event.ts");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}var y=function(e){(0,o.default)(r,e);var t=g(r);function r(e,n,i){var o;return(0,a.default)(this,r),o=t.call(this),(0,c.default)((0,s.default)(o),"_droppedFramesInterval",null),(0,c.default)((0,s.default)(o),"_lastDroppedFrames",0),(0,c.default)((0,s.default)(o),"_lastDecodedFrames",0),(0,c.default)((0,s.default)(o),"_lastTime",0),(0,c.default)((0,s.default)(o),"_currentBitrate",0),o._eventManager=new f.EventManager,o._mediaSourceAdapter=e,o._config=n,o._videoElement=i,o._mediaSourceAdapter.capabilities.fpsControl?(o._eventManager.listen(o._mediaSourceAdapter,h.CustomEventType.FPS_DROP,(function(e){return o._triggerFPSDrop(e.payload.data)})),(0,l.default)(o)):(-1===o._getDroppedAndDecodedFrames()[0]?r._logger.debug("Dropped frame watcher is not supported"):o._config.capLevelOnFPSDrop?(r._logger.debug("Initialized capLevelOnFPSDrop = true"),o._init()):r._logger.debug("Not Initialized"),o)}return(0,i.default)(r,[{key:"_init",value:function(){var e=this;this._eventManager.listen(this._mediaSourceAdapter,h.CustomEventType.VIDEO_TRACK_CHANGED,(function(t){return e._currentBitrate=t.payload.selectedVideoTrack.bandwidth})),this._droppedFramesInterval=setInterval((function(){return e._checkFPS()}),this._config.fpsDroppedFramesInterval)}},{key:"_triggerFPSDrop",value:function(e){this.dispatchEvent(new m.FakeEvent(h.CustomEventType.FPS_DROP,e))}},{key:"_getDroppedAndDecodedFrames",value:function(){if("function"==typeof this._videoElement.getVideoPlaybackQuality){var e=this._videoElement.getVideoPlaybackQuality();return[e.droppedVideoFrames,e.totalVideoFrames]}return"number"==typeof this._videoElement.webkitDroppedFrameCount&&"number"==typeof this._videoElement.webkitDecodedFrameCount?[this._videoElement.webkitDroppedFrameCount,this._videoElement.webkitDecodedFrameCount]:[-1,-1]}},{key:"_checkFPS",value:function(){var e=this._getDroppedAndDecodedFrames(),t=(0,n.default)(e,2),a=t[0],i=t[1];try{var s=performance.now();if(i){if(this._lastTime){var o=s-this._lastTime,l=a-this._lastDroppedFrames,u=i-this._lastDecodedFrames,c=1e3*l/o;c>0&&(r._logger.debug("checkFPS : droppedFPS/decodedFPS:"+c/(1e3*u/o)),l>this._config.fpsDroppedMonitoringThreshold*u&&(this._mediaSourceAdapter.setMaxBitrate(this._currentBitrate-1),this._triggerFPSDrop({currentDropped:l,currentDecoded:u,totalDroppedFrames:c})))}this._lastTime=s,this._lastDroppedFrames=a,this._lastDecodedFrames=i}}catch(e){r._logger.error("Error occur while trying to check dropFrames: ",e)}}},{key:"destroy",value:function(){this._droppedFramesInterval&&clearInterval(this._droppedFramesInterval),this._droppedFramesInterval=null,this._eventManager.destroy()}}]),r}(d.FakeEventTarget);(0,c.default)(y,"_logger",(0,p.default)("droppedFramesWatcher"))},"./src/engines/engine-decorator-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineDecoratorManager:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/utils/logger.ts"),o=function(){function e(){(0,n.default)(this,e),(0,i.default)(this,"_decoratorProviders",new Map),(0,i.default)(this,"_logger",(0,s.default)("EngineDecoratorManager"))}return(0,a.default)(e,[{key:"register",value:function(e){this._decoratorProviders.has(e.getName())?this._logger.warn("decorator already registered for ".concat(e.getName())):this._decoratorProviders.set(e.getName(),e)}},{key:"createDecorators",value:function(e,t){return this._logger.debug("decorators created for ".concat(Array.from(this._decoratorProviders.keys()).toString())),Array.from(this._decoratorProviders.values(),(function(r){return r.getEngineDecorator(e,t)}))}},{key:"destroy",value:function(){this._logger.debug("decorators destroyed"),this._decoratorProviders.clear()}}]),e}()},"./src/engines/engine-decorator-provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineDecoratorProvider:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t){(0,n.default)(this,e),this._name=t.getName(),this._getEngineDecorator=t.getEngineDecorator.bind(t)}return(0,a.default)(e,[{key:"getEngineDecorator",value:function(e,t){return this._getEngineDecorator(e,t)}},{key:"getName",value:function(){return this._name}}]),e}()},"./src/engines/engine-decorator.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineDecorator:function(){return h}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/get.js"),u=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=r("./src/event/event-type.ts"),d=r("./src/event/event-manager.ts");function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var h=function(e){(0,s.default)(r,e);var t=p(r);function r(e,a){var s,p;return(0,n.default)(this,r),(p=t.call(this))._eventManager=new d.EventManager,p._pluginDecorators=a.createDecorators(e,(0,l.default)((s=(0,i.default)(p),(0,u.default)(r.prototype)),"dispatchEvent",s).bind((0,i.default)(p))),Object.values(c.EventType).forEach((function(t){return p._eventManager.listen(e,t,(function(e){return p.dispatchEvent(e)}))})),(0,o.default)(p,new Proxy(e,{get:function(e,t){"destroy"===t&&p._destroy();var r,n=p._pluginDecorators.find((function(e){return e.active}));return(r="addEventListener"===t||"removeEventListener"===t?(0,i.default)(p):n&&t in n?n:e)[t]&&"function"==typeof r[t].bind?r[t].bind(r):r[t]},set:function(e,t,r){var n=p._pluginDecorators.find((function(e){return t in e&&e.active}));return n&&t in n?n[t]=r:e[t]=r,!0}}))}return(0,a.default)(r,[{key:"dispatchEvent",value:function(e){var t=this._pluginDecorators.find((function(e){return e.active}));return t&&t.dispatchEvent?t.dispatchEvent(e):(0,l.default)((0,u.default)(r.prototype),"dispatchEvent",this).call(this,e)}},{key:"_destroy",value:function(){this._pluginDecorators=[],this._eventManager.destroy()}},{key:"active",get:function(){return!0}}]),r}(r("./src/event/fake-event-target.ts").FakeEventTarget)},"./src/engines/engine-provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineProvider:function(){return l},registerEngine:function(){return u},unRegisterEngine:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/utils/logger.ts"),o=r("./src/engines/html5/html5.ts"),l=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"register",value:function(t,r){t&&!e._engineProviders[t]?(e._logger.debug("Engine <".concat(t,"> has been registered successfully")),e._engineProviders[t]=r):e._logger.debug("Engine <".concat(t,"> is already registered, do not register again"))}},{key:"unRegister",value:function(t){e._engineProviders[t]&&(e._logger.debug("Unregistered <".concat(t,"> Engine")),delete e._engineProviders[t])}},{key:"getEngines",value:function(){return Object.keys(e._engineProviders).map((function(t){return e._engineProviders[t]}))}},{key:"destroy",value:function(){e._engineProviders={}}}]),e}();(0,i.default)(l,"_logger",(0,s.default)("EngineProvider")),(0,i.default)(l,"_engineProviders",{}),o.default.isSupported()&&l.register(o.default.id,o.default);var u=l.register,c=l.unRegister},"./src/engines/engine-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineType:function(){return n}});var n={HTML5:"html5",FLASH:"flash",SILVERLIGHT:"silverlight",CAST:"cast",YOUTUBE:"youtube",IMAGE:"image",DOCUMENT:"document"}},"./src/engines/html5/capabilities/html5-autoplay.ts":function(e,t,r){"use strict";r.r(t);var n,a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/utils/util.ts"),l=r("./src/event/event-type.ts"),u=r("./src/utils/logger.ts"),c=r("./src/assets/encoding-sources.json"),d=(n=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,null,[{key:"runCapability",value:function(){e._capabilities.autoplay||"boolean"==typeof e._capabilities.autoplay&&"boolean"==typeof e._capabilities.mutedAutoPlay?e._playPromiseResult=Promise.resolve(e._capabilities):(e._vid||(e._vid=o.Dom.createElement("video"),e._vid.src=c.Base64Mp4Source,e._vid.setAttribute("playsinline","")),e._playPromiseResult=new Promise((function(t){e._setMuted(!1),e._getPlayPromise().then((function(){return t({autoplay:!0,mutedAutoPlay:!0})})).catch((function(){e._setMuted(!0),e._getPlayPromise().then((function(){return t({autoplay:!1,mutedAutoPlay:!0})})).catch((function(){return t({autoplay:!1,mutedAutoPlay:!1})}))}))})))}},{key:"getCapability",value:function(){return e._playPromiseResult.then((function(t){var r;return t.autoplay?r=Promise.resolve(t):(e.runCapability(),r=e._playPromiseResult),r.then((function(t){return o.Object.mergeDeep(t,e._capabilities)}))}))}},{key:"setCapabilities",value:function(t){e._logger.debug("Set player capabilities",t);var r=t.autoplay,n=t.mutedAutoPlay;"boolean"==typeof r&&(e._capabilities.autoplay=r),"boolean"==typeof n&&(e._capabilities.mutedAutoPlay=n)}},{key:"_getPlayPromise",value:function(){return e._vid.play()||e._forcePromiseReturnValue()}},{key:"_setMuted",value:function(t){t?(e._vid.muted=!0,e._vid.setAttribute("muted","")):(e._vid.muted=!1,e._vid.removeAttribute("muted"))}},{key:"_forcePromiseReturnValue",value:function(){return new Promise((function(t,r){e._vid.addEventListener(l.Html5EventType.ERROR,(function(){r()}));var n=setTimeout((function(){e._logger.debug("Timeout ".concat(500," ms has been reached")),r()}),500);!0===e._vid.paused?(clearTimeout(n),r()):(clearTimeout(n),t())}))}}]),e}(),(0,s.default)(n,"_logger",(0,u.default)("Html5AutoPlayCapability")),(0,s.default)(n,"_capabilities",{}),n);t.default=d},"./src/engines/html5/cors-types.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CorsType:function(){return n}});var n={ANONYMOUS:"anonymous",USE_CREDENTIALS:"use-credentials"}},"./src/engines/html5/html5.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return A}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=r("./src/event/fake-event-target.ts"),d=r("./src/event/fake-event.ts"),p=r("./src/event/event-manager.ts"),h=r("./src/event/event-type.ts"),f=r("./src/engines/html5/media-source/media-source-provider.ts"),m=r("./src/track/text-track.ts"),g=r("./src/track/timed-metadata.ts"),y=r("./src/utils/util.ts"),v=r("./src/engines/html5/capabilities/html5-autoplay.ts"),_=r("./src/error/error.ts"),k=r("./src/utils/logger.ts"),E=r("./src/engines/dropped-frames-watcher.ts"),b=r("./src/utils/env.ts");function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var A=function(e){(0,s.default)(r,e);var t=T(r);function r(e,a,s){var o;return(0,n.default)(this,r),o=t.call(this),(0,u.default)((0,i.default)(o),"_reset",!1),(0,u.default)((0,i.default)(o),"_cachedUrls",[]),o._eventManager=new p.EventManager,o._canLoadMediaSourceAdapterPromise=Promise.resolve(),o._createVideoElement(s),o._init(e,a),o}return(0,a.default)(r,[{key:"restore",value:function(e,t){this.reset(),this._init(e,t)}},{key:"reset",value:function(){var e=this;this._reset||(this._reset=!0,this._eventManager.removeAll(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=void 0),this._canLoadMediaSourceAdapterPromise=new Promise((function(t,r){var n=e._mediaSourceAdapter?e._mediaSourceAdapter.destroy():Promise.resolve();e._el&&e._el.src?n.then((function(){y.Dom.setAttribute(e._el,"src",""),y.Dom.removeAttribute(e._el,"src"),t()}),r):n.then(t,r)})),this._mediaSourceAdapter=null)}},{key:"destroy",value:function(){this.detach(),this._el&&(this.pause(),y.Dom.removeAttribute(this._el,"src"),y.Dom.removeChild(this._el.parentNode,this._el)),this._eventManager.destroy(),f.default.destroy(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=void 0),this._mediaSourceAdapter&&(this._mediaSourceAdapter.setCachedUrls([]),this._mediaSourceAdapter.destroy(),this._mediaSourceAdapter=null)}},{key:"mediaSourceAdapter",get:function(){return this._mediaSourceAdapter}},{key:"id",get:function(){return r.id}},{key:"attachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.attachMediaSource()}},{key:"detachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.detachMediaSource()}},{key:"attach",value:function(){var e=this;Object.keys(h.Html5EventType).forEach((function(t){[h.Html5EventType.ERROR,h.Html5EventType.WAITING].includes(h.Html5EventType[t])||e._eventManager.listen(e._el,h.Html5EventType[t],(function(){return e.dispatchEvent(new d.FakeEvent(h.Html5EventType[t]))}))})),this._eventManager.listen(this._el,h.Html5EventType.ERROR,(function(){return e._handleVideoError()})),this._eventManager.listen(this._el,h.Html5EventType.WAITING,(function(){return e._handleWaiting()})),this._handleMetadataTrackEvents(),this._eventManager.listen(this._el.textTracks,"addtrack",(function(t){m.PKTextTrack.isNativeTextTrack(t.track)&&e.dispatchEvent(new d.FakeEvent(h.CustomEventType.TEXT_TRACK_ADDED,{track:t.track}))}));var t=this._mediaSourceAdapter;t&&(this._eventManager.listen(t,h.CustomEventType.VIDEO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.AUDIO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.TEXT_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.TEXT_CUE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.TRACKS_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.Html5EventType.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.Html5EventType.TIME_UPDATE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.Html5EventType.PLAYING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.Html5EventType.WAITING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,"hlsFragParsingMetadata",(function(t){return e.dispatchEvent(t)})),this._droppedFramesWatcher&&this._eventManager.listen(this._droppedFramesWatcher,h.CustomEventType.FPS_DROP,(function(t){return e.dispatchEvent(t)})))}},{key:"detach",value:function(){var e=this;Object.keys(h.Html5EventType).forEach((function(t){e._eventManager.unlisten(e._el,h.Html5EventType[t])})),this._mediaSourceAdapter&&(this._eventManager.unlisten(this._mediaSourceAdapter,h.CustomEventType.VIDEO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,h.CustomEventType.AUDIO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,h.CustomEventType.TEXT_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,h.CustomEventType.TEXT_CUE_CHANGED))}},{key:"getVideoElement",value:function(){return this._el}},{key:"selectVideoTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectVideoTrack(e)}},{key:"selectAudioTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectAudioTrack(e)}},{key:"selectTextTrack",value:function(e){this._removeCueChangeListeners(),this._mediaSourceAdapter&&this._mediaSourceAdapter.selectTextTrack(e),this.resetAllCues(),this._addCueChangeListener()}},{key:"selectImageTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectImageTrack(e)}},{key:"hideTextTrack",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.hideTextTrack(),this._removeCueChangeListeners()}},{key:"enableAdaptiveBitrate",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.enableAdaptiveBitrate()}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isAdaptiveBitrateEnabled()}},{key:"applyABRRestriction",value:function(e){if(this._mediaSourceAdapter)return this._mediaSourceAdapter.applyABRRestriction(e)}},{key:"seekToLiveEdge",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.seekToLiveEdge()}},{key:"isOnLiveEdge",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isOnLiveEdge()}},{key:"getStartTimeOfDvrWindow",value:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getStartTimeOfDvrWindow():0}},{key:"isLive",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isLive()}},{key:"resetIfPlaybackEnded",value:function(){(Math.round(1e3*this._el.currentTime)>=Math.round(1e3*this._el.duration)||this._el.ended)&&(this._el.currentTime=0)}},{key:"play",value:function(){var e=this;b.default.isSafari&&this.isInPictureInPicture&&!this.isLive()&&this.resetIfPlaybackEnded();var t=this._el.play();return t&&t.catch((function(t){return e.dispatchEvent(new d.FakeEvent(h.CustomEventType.PLAY_FAILED,{error:t}))})),t}},{key:"pause",value:function(){return this._el.pause()}},{key:"load",value:function(e){var t=this;return this._el.load(),this._canLoadMediaSourceAdapterPromise.then((function(){return t._mediaSourceAdapter?t._mediaSourceAdapter.load(e):Promise.resolve({})})).catch((function(e){return t.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,e)),Promise.reject(e)}))}},{key:"enterPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof this._el.requestPictureInPicture&&!this._el.disablePictureInPicture?this._el.requestPictureInPicture().catch((function(t){e.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,new _.default(_.default.Severity.RECOVERABLE,_.default.Category.PLAYER,_.default.Code.ENTER_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&(this._el.webkitSetPresentationMode("picture-in-picture"),setTimeout((function(){return e.dispatchEvent(new d.FakeEvent(h.Html5EventType.ENTER_PICTURE_IN_PICTURE))}),0))}catch(e){this.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,new _.default(_.default.Severity.RECOVERABLE,_.default.Category.PLAYER,_.default.Code.ENTER_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"exitPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof document.exitPictureInPicture&&this._el===document.pictureInPictureElement?document.exitPictureInPicture().catch((function(t){e.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,new _.default(_.default.Severity.RECOVERABLE,_.default.Category.PLAYER,_.default.Code.EXIT_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&this._el.webkitSetPresentationMode("inline")}catch(e){this.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,new _.default(_.default.Severity.RECOVERABLE,_.default.Category.PLAYER,_.default.Code.EXIT_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"isPictureInPictureSupported",value:function(){return"function"==typeof this._el.webkitSupportsPresentationMode?this._el.webkitSupportsPresentationMode("picture-in-picture"):!!document.pictureInPictureEnabled}},{key:"getThumbnail",value:function(e){return this._mediaSourceAdapter?this._mediaSourceAdapter.getThumbnail(e):null}},{key:"src",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.src:""},set:function(e){this._mediaSourceAdapter&&(this._mediaSourceAdapter.src=e)}},{key:"currentTime",get:function(){return this._el?this._el.currentTime:0},set:function(e){this._el&&(this._el.currentTime=e)}},{key:"duration",get:function(){return this._el.duration}},{key:"liveDuration",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.liveDuration:-1}},{key:"volume",get:function(){return this._el.volume},set:function(e){this._el.volume=e}},{key:"paused",get:function(){return this._el.paused}},{key:"seeking",get:function(){return this._el.seeking}},{key:"seekable",get:function(){return this._el.seekable}},{key:"played",get:function(){return this._el.played}},{key:"buffered",get:function(){return this._el.buffered}},{key:"muted",get:function(){return this._el.muted},set:function(e){this._el.muted=e}},{key:"defaultMuted",get:function(){return this._el.defaultMuted}},{key:"poster",get:function(){return this._el.poster},set:function(e){this._el.poster=e}},{key:"preload",get:function(){return this._el.preload},set:function(e){this._el.preload=e}},{key:"autoplay",get:function(){return this._el.autoplay},set:function(e){this._el.autoplay=e}},{key:"loop",get:function(){return this._el.loop},set:function(e){this._el.loop=e}},{key:"controls",get:function(){return this._el.controls},set:function(e){this._el.controls=e}},{key:"playbackRate",get:function(){return this._el.playbackRate},set:function(e){this._el.playbackRate=e}},{key:"defaultPlaybackRate",get:function(){return this._el.defaultPlaybackRate},set:function(e){this._el.defaultPlaybackRate=e}},{key:"ended",get:function(){return this._el.ended}},{key:"error",get:function(){return this._el.error}},{key:"networkState",get:function(){return this._el.networkState}},{key:"readyState",get:function(){return this._el.readyState}},{key:"videoHeight",get:function(){return this._el.videoHeight}},{key:"videoWidth",get:function(){return this._el.videoWidth}},{key:"playsinline",get:function(){return""===this._el.getAttribute("playsinline")},set:function(e){e?this._el.setAttribute("playsinline",""):this._el.removeAttribute("playsinline")}},{key:"crossOrigin",get:function(){return this._el.getAttribute("crossorigin")},set:function(e){"string"==typeof e?this._el.setAttribute("crossorigin",e):this._el.removeAttribute("crossorigin")}},{key:"playbackRates",get:function(){return r.PLAYBACK_RATES}},{key:"isInPictureInPicture",get:function(){return!!document.pictureInPictureElement&&null!==document.pictureInPictureElement&&this._el===document.pictureInPictureElement||!!this._el.webkitPresentationMode&&"picture-in-picture"===this._el.webkitPresentationMode}},{key:"_init",value:function(e,t){this._config=t,this._reset=!1,this._loadMediaSourceAdapter(e),this.attach()}},{key:"_createVideoElement",value:function(e){this._el=r.videoElementStore[e]||y.Dom.createElement("video"),this._el.id=y.Generator.uniqueId(5),this._el.controls=!1}},{key:"_loadMediaSourceAdapter",value:function(e){this._mediaSourceAdapter=f.default.getMediaSourceAdapter(this.getVideoElement(),e,this._config),this._mediaSourceAdapter&&(this._droppedFramesWatcher=new E.DroppedFramesWatcher(this._mediaSourceAdapter,this._config.abr,this._el),this._cachedUrls.length&&(this._mediaSourceAdapter.setCachedUrls(this._cachedUrls),this._cachedUrls=[]))}},{key:"_addCueChangeListener",value:function(){var e=this,t=Array.from(this._el.textTracks).find((function(e){return m.PKTextTrack.isNativeTextTrack(e)&&e.mode!==m.PKTextTrack.MODE.DISABLED}));t&&this._eventManager.listen(t,"cuechange",(function(t){return e._onCueChange(t)}))}},{key:"_removeCueChangeListeners",value:function(){var e=this;Array.from(this._el.textTracks).filter((function(e){return!m.PKTextTrack.isMetaDataTrack(e)})).forEach((function(t){e._eventManager.unlisten(t,"cuechange")}))}},{key:"_onCueChange",value:function(e){var t=e.currentTarget.activeCues,r=(0,m.getActiveCues)(t);this.dispatchEvent(new d.FakeEvent(h.CustomEventType.TEXT_CUE_CHANGED,{cues:r}))}},{key:"resetAllCues",value:function(){var e=Array.from(this._el.textTracks).find((function(e){return m.PKTextTrack.isNativeTextTrack(e)&&e.mode!==m.PKTextTrack.MODE.DISABLED}));if(e)for(var t=0;t<e.cues.length;t++)e.cues[t].hasBeenReset=!0}},{key:"_handleVideoError",value:function(){if(this._el.error){var e=this._el.error.code;if(e!==MediaError.MEDIA_ERR_ABORTED){var t=this._getMsExtendedError(),r=this._el.error.message;if(this._mediaSourceAdapter&&!this._mediaSourceAdapter.handleMediaError(this._el.error)){var n=new _.default(_.default.Severity.CRITICAL,_.default.Category.MEDIA,_.default.Code.VIDEO_ERROR,{code:e,extended:t,message:r});this.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,n))}}}}},{key:"_handleWaiting",value:function(){var e=this,t=!1;this._eventManager.listenOnce(this._el,h.Html5EventType.PLAYING,(function(){return t=!0})),setTimeout((function(){t||e.dispatchEvent(new d.FakeEvent(h.Html5EventType.WAITING))}),200)}},{key:"_getMsExtendedError",value:function(){var e=this._el.error.msExtendedCode;return e&&(e<0&&(e+=Math.pow(2,32)),e=e.toString(16)),e}},{key:"_handleMetadataTrackEvents",value:function(){var e=this,t=function(t){t.mode=m.PKTextTrack.MODE.HIDDEN,e._eventManager.listen(t,"cuechange",(function(){var t=[];Array.from(e._el.textTracks).forEach((function(e){m.PKTextTrack.isMetaDataTrack(e)&&(t=t.concat((0,m.getActiveCues)(e.activeCues)))})),t=t.sort((function(e,t){return e.startTime-t.startTime})),e.dispatchEvent(new d.FakeEvent(h.CustomEventType.TIMED_METADATA,{cues:t})),e.dispatchEvent(new d.FakeEvent(h.CustomEventType.TIMED_METADATA_CHANGE,{cues:t.map((function(e){return(0,g.createTimedMetadata)(e)}))}))}))};Array.from(this._el.textTracks).forEach((function(e){m.PKTextTrack.isMetaDataTrack(e)&&t(e)})),this._eventManager.listen(this._el.textTracks,"addtrack",(function(e){m.PKTextTrack.isMetaDataTrack(e.track)&&t(e.track)})),this._eventManager.listen(this._el.textTracks,"change",(function(){Array.from(e._el.textTracks).forEach((function(e){m.PKTextTrack.isMetaDataTrack(e)&&e.mode!==m.PKTextTrack.MODE.HIDDEN&&(e.mode=m.PKTextTrack.MODE.HIDDEN)}))}))}},{key:"targetBuffer",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.targetBuffer:NaN}},{key:"availableBuffer",get:function(){var e=0;if(this.buffered)for(var t=0;t<this.buffered.length;t++)this.buffered.start(t)<=this._el.currentTime&&this._el.currentTime<=this.buffered.end(t)&&(e=this.buffered.end(t)-this._el.currentTime);return e}},{key:"addTextTrack",value:function(e,t,r){return this._el.addTextTrack(e,t,r)}},{key:"getNativeTextTracks",value:function(){return Array.from(this._el.textTracks)}},{key:"getDrmInfo",value:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getDrmInfo():null}},{key:"setCachedUrls",value:function(e){this._cachedUrls=e,this._mediaSourceAdapter&&(this._mediaSourceAdapter.setCachedUrls(e),this._cachedUrls=[])}}],[{key:"isSupported",value:function(){try{var e=y.Dom.createElement("video");return e.volume=.5,!!e.canPlayType}catch(e){return!1}}},{key:"createEngine",value:function(e,t,r){return new this(e,t,r)}},{key:"canPlaySource",value:function(e,t,r){return f.default.canPlaySource(e,t,r)}},{key:"runCapabilities",value:function(){r._capabilities.forEach((function(e){return e.runCapability()}))}},{key:"getCapabilities",value:function(){var e=[];return r._capabilities.forEach((function(t){return e.push(t.getCapability())})),Promise.all(e).then((function(e){var t={};return e.forEach((function(e){return Object.assign(t,e)})),(0,u.default)({},r.id,t)}))}},{key:"setCapabilities",value:function(e){r._capabilities.forEach((function(t){return t.setCapabilities(e)}))}},{key:"prepareVideoElement",value:function(e){if(!r.videoElementStore[e]){r._logger.debug("Create the video element for playing ".concat(e));var t=y.Dom.createElement("video");t.setAttribute("aria-hidden","true"),r.videoElementStore[e]=t}r._logger.debug("Prepare the video element for playing ".concat(e)),r.videoElementStore[e].load()}}]),r}(c.FakeEventTarget);(0,u.default)(A,"_logger",(0,k.default)("Html5")),(0,u.default)(A,"_capabilities",[v.default]),(0,u.default)(A,"id","html5"),(0,u.default)(A,"videoElementStore",{}),(0,u.default)(A,"PLAYBACK_RATES",[.5,1,1.5,2])},"./src/engines/html5/media-source/adapters/fairplay-drm-handler-v2.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{FairPlayDrmHandlerV2:function(){return g}});var n=r("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./node_modules/@babel/runtime/regenerator/index.js"),l=r.n(o),u=r("./src/error/error.ts"),c=r("./src/event/event-manager.ts"),d=r("./src/engines/html5/media-source/adapters/fairplay-drm-handler.ts"),p=r("./src/utils/logger.ts"),h=r("./src/drm/drm-scheme.ts"),f=r("./src/enums/request-type.ts"),m=function(e){return e.ENCRYPTED="encrypted",e}(m||{}),g=function(){function e(t,r,i,o){var u,d;(0,a.default)(this,e),(0,s.default)(this,"logger",(0,p.default)("FairPlayDrmHandlerV2")),this.videoElement=t,this.config=r,this.errorCallback=i,this.drmResponseCallback=o,this.eventManager=new c.EventManager,this.eventManager.listen(t,m.ENCRYPTED,this.onEncrypted.bind(this)),this.requestFilter=null===(u=r.network)||void 0===u?void 0:u.requestFilter,this.responseFilter=(null===(d=r.network)||void 0===d?void 0:d.responseFilter)||function(){var e=(0,n.default)(l().mark((function e(t,r){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r);case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}var t,r;return(0,i.default)(e,[{key:"onEncrypted",value:(r=(0,n.default)(l().mark((function t(r){var n,a,i,s,o,c,p,h=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("skd"===(n=r.initDataType)){t.next=4;break}return this.logger.warn('Received unexpected initialization data type "'.concat(n,'"')),t.abrupt("return");case 4:if(this.videoElement.mediaKeys){t.next=77;break}return a=[{initDataTypes:[n],videoCapabilities:[{contentType:"application/vnd.apple.mpegurl",robustness:""}],distinctiveIdentifier:"not-allowed",persistentState:"not-allowed",sessionTypes:["temporary"]}],t.prev=6,t.next=9,navigator.requestMediaKeySystemAccess("com.apple.fps",a);case 9:return i=t.sent,t.next=12,i.createMediaKeys();case 12:if(s=t.sent,i&&s){t.next=16;break}return this.onError(u.default.Code.COULD_NOT_CREATE_MEDIA_KEY),t.abrupt("return");case 16:return t.next=18,s.setServerCertificate(d.FairPlayDrmHandler._base64DecodeUint8Array(this.config.certificate));case 18:return t.next=20,this.videoElement.setMediaKeys(s);case 20:if(this.videoElement.mediaKeys){t.next=23;break}return this.onError(u.default.Code.COULD_NOT_SET_MEDIA_KEYS),t.abrupt("return");case 23:if(this.keySession=this.videoElement.mediaKeys.createSession(),this.keySession){t.next=27;break}return this.onError(u.default.Code.COULD_NOT_CREATE_KEY_SESSION),t.abrupt("return");case 27:return this.keySession.generateRequest(n,r.initData),t.next=30,new Promise((function(e,t){h.eventManager.listenOnce(h.keySession,"message",(function(t){e(t.message)})),setTimeout(t,1e3)}));case 30:if(o=t.sent){t.next=34;break}return this.onError(u.default.Code.COULD_NOT_CREATE_KEY_SESSION),t.abrupt("return");case 34:if(c={url:this.config.licenseUrl,body:new Uint8Array(o).toBase64?new Uint8Array(o).toBase64():o,headers:{"Content-Type":"application/json"}},!this.requestFilter){t.next=46;break}return t.prev=36,t.next=39,this.requestFilter(f.RequestType.LICENSE,c);case 39:c=t.sent,t.next=46;break;case 42:return t.prev=42,t.t0=t.catch(36),this.onError(u.default.Code.REQUEST_FILTER_ERROR,t.t0),t.abrupt("return");case 46:return t.prev=46,t.next=49,e.getUDRMResponse(c.url,c.body,c.headers);case 49:p=t.sent,t.next=56;break;case 52:return t.prev=52,t.t1=t.catch(46),this.onError(u.default.Code.LICENSE_REQUEST_FAILED,t.t1),t.abrupt("return");case 56:if(!this.responseFilter){t.next=67;break}return t.prev=57,t.next=60,this.responseFilter(f.RequestType.LICENSE,p);case 60:p=t.sent,t.next=67;break;case 63:return t.prev=63,t.t2=t.catch(57),this.onError(u.default.Code.RESPONSE_FILTER_ERROR,t.t2),t.abrupt("return");case 67:if(p.ckc&&""!==p.ckc){t.next=70;break}return this.onError(u.default.Code.LICENSE_RESPONSE_EMPTY),t.abrupt("return");case 70:return t.next=72,this.keySession.update(e.base64DecodeUint8Array(p.ckc));case 72:t.next=77;break;case 74:t.prev=74,t.t3=t.catch(6),this.onError(u.default.Code.FAILED_TO_REQUEST_MEDIA_KEY_SYSTEM_ACCESS,t.t3);case 77:case"end":return t.stop()}}),t,this,[[6,74],[36,42],[46,52],[57,63]])}))),function(e){return r.apply(this,arguments)})},{key:"onError",value:function(e,t){this.errorCallback(new u.default(u.default.Severity.CRITICAL,u.default.Category.DRM,e,t))}},{key:"getDrmInfo",value:function(){var e=this.config;return{certificate:e.certificate,licenseUrl:e.licenseUrl,scheme:h.DrmScheme.FAIRPLAY}}},{key:"destroy",value:function(){this.eventManager.destroy(),this.keySession.close(),this.keySession=null}}],[{key:"base64DecodeUint8Array",value:function(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}},{key:"getUDRMResponse",value:(t=(0,n.default)(l().mark((function e(t,r){var n,a,i=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:{"Content-Type":"application/json"},e.next=3,fetch(t,{method:"POST",body:r,headers:n});case 3:return a=e.sent,e.abrupt("return",a.json());case 5:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})}]),e}()},"./src/engines/html5/media-source/adapters/fairplay-drm-handler.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{FairPlayDrmHandler:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/error/error.ts"),l=r("./src/utils/logger.ts"),u=r("./src/utils/util.ts"),c=r("./src/enums/request-type.ts"),d=r("./src/drm/drm-scheme.ts"),p=r("./src/event/event-manager.ts"),h="com.apple.fps.1_0",f={NEED_KEY:"webkitneedkey",KEY_MESSAGE:"webkitkeymessage",KEY_ADDED:"webkitkeyadded",KEY_ERROR:"webkitkeyerror"},m=function(){function e(t,r,n,i){var c=this;(0,a.default)(this,e),(0,s.default)(this,"_logger",(0,l.default)("FairPlayDrmHandler")),(0,s.default)(this,"_retryLicenseRequest",4),(0,s.default)(this,"_defaultConfig",{licenseUrl:"",certificate:"",network:{responseFilter:function(t,r){var n={};try{var a=new DataView(r.data),i=(new TextDecoder).decode(a).trim();n=JSON.parse(i)}catch(e){return void c._onError(o.default.Code.BAD_FAIRPLAY_RESPONSE,{error:e,responseText:r.data})}var s=e._validateResponse(n);s.valid?r.data=e._base64DecodeUint8Array(n.ckc):c._onError(o.default.Code.BAD_FAIRPLAY_RESPONSE,s)}}}),this._config=u.Object.mergeDeep({},this._defaultConfig,r),this._errorCallback=n,this._drmResponseCallback=i,this._videoElement=t,this._onWebkitNeedKeyHandler=function(e){return c._onWebkitNeedKey(e)},this._eventManager=new p.EventManager,this._eventManager.listen(this._videoElement,f.NEED_KEY,this._onWebkitNeedKeyHandler)}return(0,i.default)(e,[{key:"_onWebkitNeedKey",value:function(t){var r=this;this._logger.debug("Webkit need key triggered");var n=t.target,a=t.initData,i=e._extractContentId(a,!!this._config.useKIDHeader),s=e._base64DecodeUint8Array(this._config.certificate);if(a=e._concatInitDataIdAndCertificate(a,i,s),!n.webkitKeys){var l=this._selectKeySystem();this._logger.debug("Sets media keys"),n.webkitSetMediaKeys(new WebKitMediaKeys(l))}n.webkitKeys||this._onError(o.default.Code.COULD_NOT_CREATE_MEDIA_KEYS),this._logger.debug("Creates session"),this._keySession=n.webkitKeys.createSession("video/mp4",a),this._keySession||this._onError(o.default.Code.COULD_NOT_CREATE_KEY_SESSION),this._keySession.contentId=i,this._eventManager.listen(this._keySession,f.KEY_MESSAGE,(function(e){return r._onWebkitKeyMessage(e)})),this._eventManager.listen(this._keySession,f.KEY_ADDED,(function(){return r._onWebkitKeyAdded()})),this._eventManager.listen(this._keySession,f.KEY_ERROR,(function(e){return r._onWebkitKeyError(e)}))}},{key:"getDrmInfo",value:function(){var e=this._config;return{certificate:e.certificate,licenseUrl:e.licenseUrl,scheme:d.DrmScheme.FAIRPLAY}}},{key:"destroy",value:function(){this._eventManager.destroy(),this._keySession.close(),this._keySession=null}},{key:"_onWebkitKeyMessage",value:function(t){var r=this;this._logger.debug("Webkit key message triggered");var a=t.message,i=t.target,s=null==i?void 0:i.contentId,l=null!=s?btoa(s):"",u=new XMLHttpRequest;u.responseType="arraybuffer",this._eventManager.listenOnce(u,"load",(function(e){return r._licenseRequestLoaded(e)}));var d,p={url:this._config.licenseUrl,body:e._base64EncodeUint8Array(a),headers:this._config.useKIDHeader?{"X-Kaltura-InitData":l}:{}},h=this._config.network.requestFilter;if(h){this._logger.debug("Apply request filter");try{d=h(c.RequestType.LICENSE,p)}catch(e){d=Promise.reject(e)}}(d=d||Promise.resolve(p)).then((function(e){u.open("POST",e.url,!0);var t=!0;e.headers&&Object.entries(e.headers).forEach((function(e){var r=(0,n.default)(e,2),a=r[0],i=r[1];"string"==typeof i&&u.setRequestHeader(a,i),t&&(t="content-type"!==a.toLowerCase())})),"boolean"==typeof e.withCredentials&&(u.withCredentials=e.withCredentials),t&&u.setRequestHeader("Content-type","application/json"),r._logger.debug("Ready for license request"),u.onerror=function(){r._onError(o.default.Code.LICENSE_REQUEST_FAILED,{status:u.status,responseText:u.responseText})},r._licenseRequestTime=Date.now(),u.send(e.body)})).catch((function(e){r._errorCallback(new o.default(o.default.Severity.CRITICAL,o.default.Category.NETWORK,o.default.Code.REQUEST_FILTER_ERROR,e)),r.destroy()}))}},{key:"_onWebkitKeyAdded",value:function(){this._logger.debug("Decryption key was added to session")}},{key:"_onWebkitKeyError",value:function(e){this._logger.error("A decryption key error was encountered",e),this._retryLicenseRequest<=0&&this._onError(o.default.Code.LICENSE_REQUEST_FAILED,e.target.error),this._retryLicenseRequest--}},{key:"_licenseRequestLoaded",value:function(e){var t=this;this._logger.debug("License request loaded");var r=e.target;if(r.status>299)this._onError(o.default.Code.LICENSE_REQUEST_FAILED,{status:r.status,error:r.responseText});else{if(this._drmResponseCallback){var n=Date.now()-this._licenseRequestTime;this._drmResponseCallback({licenseTime:n/1e3,scheme:d.DrmScheme.FAIRPLAY})}var a,i=r.responseURL,s=r.response,l={url:i,originalUrl:this._config.licenseUrl,data:s,headers:u.Http.convertHeadersToDictionary(r.getAllResponseHeaders())};this._logger.debug("Apply response filter");try{a=this._config.network.responseFilter(c.RequestType.LICENSE,l)}catch(e){a=Promise.reject(e)}(a=a||Promise.resolve(l)).then((function(e){t._keySession.update(e.data)})).catch((function(e){t._errorCallback(new o.default(o.default.Severity.CRITICAL,o.default.Category.NETWORK,o.default.Code.RESPONSE_FILTER_ERROR,e)),t.destroy()}))}}},{key:"_onError",value:function(e,t){this._errorCallback(new o.default(o.default.Severity.CRITICAL,o.default.Category.DRM,e,t))}},{key:"_selectKeySystem",value:function(){var e=null;return WebKitMediaKeys.isTypeSupported(h,"video/mp4")?e=h:this._logger.warn("Key System not supported"),e}}],[{key:"_validateResponse",value:function(e){return e.message&&e.message.indexOf("error")>0||null===e.reference||500===e.status_code?{valid:!1,details:"internal server error"}:""===e.ckc?{valid:!1,details:"ckc is missing"}:{valid:!0}}},{key:"_extractContentId",value:function(t,r){if(r){var n=e._arrayToString(t);return n.slice(n.lastIndexOf("skd://")+6,n.length)}var a=document.createElement("a");return a.href=e._arrayToString(t),a.hostname}},{key:"_arrayToString",value:function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))}},{key:"_base64DecodeUint8Array",value:function(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(new ArrayBuffer(r)),a=0;a<r;a++)n[a]=t.charCodeAt(a);return n}},{key:"_concatInitDataIdAndCertificate",value:function(t,r,n){"string"==typeof r&&(r=e._stringToArray(r));var a=0,i=new ArrayBuffer(t.byteLength+4+r.byteLength+4+n.byteLength),s=new DataView(i);new Uint8Array(i,a,t.byteLength).set(t),a+=t.byteLength,s.setUint32(a,r.byteLength,!0),a+=4;var o=new Uint8Array(i,a,r.byteLength);return o.set(r),a+=o.byteLength,s.setUint32(a,n.byteLength,!0),a+=4,new Uint8Array(i,a,n.byteLength).set(n),new Uint8Array(i,0,i.byteLength)}},{key:"_stringToArray",value:function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),n=0,a=e.length;n<a;n++)r[n]=e.charCodeAt(n);return r}},{key:"_base64EncodeUint8Array",value:function(e){for(var t,r,n,a,i,s,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;c<e.length;)a=(t=e[c++])>>2,i=(3&t)<<4|(r=c<e.length?e[c++]:Number.NaN)>>4,s=(15&r)<<2|(n=c<e.length?e[c++]:Number.NaN)>>6,o=63&n,isNaN(r)?s=o=64:isNaN(n)&&(o=64),u+=l.charAt(a)+l.charAt(i)+l.charAt(s)+l.charAt(o);return u}}]),e}();(0,s.default)(m,"WebkitEvents",f),m.WebkitEvents=f},"./src/engines/html5/media-source/adapters/native-adapter.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return M}});var n,a=r("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),i=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=r("./node_modules/@babel/runtime/helpers/esm/get.js"),u=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),c=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),p=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),h=r("./src/event/event-type.ts"),f=r("./src/track/video-track.ts"),m=r("./src/track/audio-track.ts"),g=r("./src/track/text-track.ts"),y=r("./src/enums/request-type.ts"),v=r("./src/engines/html5/media-source/base-media-source-adapter.ts"),_=r("./src/utils/resolution.ts"),k=r("./src/utils/restrictions.ts"),E=r("./src/utils/util.ts"),b=r("./src/drm/fairplay.ts"),T=r("./src/utils/env.ts"),A=r("./src/error/error.ts"),S=r("./src/engines/html5/media-source/adapters/native-adapter-default-config.json"),P=r("./src/engines/html5/media-source/adapters/fairplay-drm-handler.ts"),C=r("./src/engines/html5/media-source/adapters/fairplay-drm-handler-v2.ts");function x(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.default)(e);if(t){var a=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var R="playkit-native-text",M=function(e){(0,u.default)(r,e);var t=w(r);function r(e,n,a){var s;return(0,i.default)(this,r),s=t.call(this,e,n,a),(0,p.default)((0,o.default)(s),"_lastTimeUpdate",0),(0,p.default)((0,o.default)(s),"_waitingEventTriggered",!1),(0,p.default)((0,o.default)(s),"_segmentDuration",0),(0,p.default)((0,o.default)(s),"_startTimeOfDvrWindow",0),(0,p.default)((0,o.default)(s),"_mediaErrorRecoveryAttempts",0),(0,p.default)((0,o.default)(s),"_lastTimeDetach",NaN),(0,p.default)((0,o.default)(s),"_startTimeAttach",NaN),(0,p.default)((0,o.default)(s),"_nativeTextTracksMap",{}),(0,p.default)((0,o.default)(s),"_captionsHidden",!1),r._logger.debug("Creating adapter"),s._config=E.Object.mergeDeep({},S,s._config),s._progressiveSources=a.progressiveSources,s._liveEdge=0,s._setStarTimeOfDvrWindowInterval(),s}return(0,s.default)(r,[{key:"_dispatchErrorCallback",value:function(e){this._trigger(h.Html5EventType.ERROR,e)}},{key:"_dispatchDRMLicenseLoaded",value:function(e){this._trigger(h.CustomEventType.DRM_LICENSE_LOADED,e)}},{key:"_maybeSetDrmPlayback",value:function(){var e=this;if(r._drmProtocol&&this._sourceObj&&this._sourceObj.drmData){var t={licenseUrl:"",certificate:"",network:this._config.network,useKIDHeader:!!this._config.useKIDHeader};r._drmProtocol.setDrmPlayback(t,this._sourceObj.drmData),this._config.useFairPlayHandlerV2?this._drmHandler=new C.FairPlayDrmHandlerV2(this._videoElement,t,(function(t){return e._dispatchErrorCallback(t)}),(function(t){return e._dispatchDRMLicenseLoaded(t)})):this._drmHandler=new P.FairPlayDrmHandler(this._videoElement,t,(function(t){return e._dispatchErrorCallback(t)}),(function(t){return e._dispatchDRMLicenseLoaded(t)}))}}},{key:"_setProgressiveSource",value:function(){var e=(0,_.getSuitableSourceForResolution)(this._progressiveSources,this._videoElement.offsetWidth,this._videoElement.offsetHeight);e&&(this._sourceObj=e)}},{key:"_isProgressivePlayback",value:function(){return!!this._sourceObj&&r._progressiveMimeTypes.includes(this._sourceObj.mimetype.toLowerCase())}},{key:"load",value:function(e){var t=this;return this._maybeSetDrmPlayback(),this._loadPromise||(this._loadPromise=new Promise((function(r,n){t._lastTimeUpdate=e||0;var a="number"==typeof e?e:-1,i=t._startTimeAttach||a;t._loadPromiseReject=n,t._eventManager.listenOnce(t._videoElement,h.Html5EventType.LOADED_DATA,(function(){return t._onLoadedData(r,i)})),t._eventManager.listenOnce(t._videoElement,h.Html5EventType.PLAYING,(function(){return t._onPlaying(i)})),t._eventManager.listen(t._videoElement,h.Html5EventType.TIME_UPDATE,(function(){return t._onTimeUpdate()})),t._eventManager.listen(t._videoElement,h.Html5EventType.PLAY,(function(){return t._resetHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,h.Html5EventType.PAUSE,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,h.Html5EventType.ENDED,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,h.Html5EventType.ABORT,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,h.Html5EventType.SEEKED,(function(){return t._syncCurrentTime()})),t._eventManager.listen(t._videoElement,h.Html5EventType.WAITING,(function(){return t._waitingEventTriggered=!0})),t._eventManager.listen(t._videoElement,h.Html5EventType.PLAYING,(function(){return t._waitingEventTriggered=!1})),t._eventManager.listen(window,"focus",(function(){setTimeout((function(){T.default.isIOS&&(t._videoElement.currentTime=t._videoElement.currentTime>.1?t._videoElement.currentTime-.1:0),t._syncCurrentTime()}),1e3)})),t._isProgressivePlayback()&&t._setProgressiveSource(),t._sourceObj&&t._sourceObj.url?t._setSrc().then((function(){t._trigger(h.CustomEventType.ABR_MODE_CHANGED,{mode:t._isProgressivePlayback()?"manual":"auto"}),t._videoElement.load()})):t._videoElement.load()}))),this._loadPromise}},{key:"_handleDecodeError",value:function(e){var t=this;r._logger.debug("handleDecodeError",e);var n=this._videoElement.currentTime,a=this._getActivePKAudioTrack(),i=this._getActivePKTextTrack();this._videoElement.load(),this._eventManager.listenOnce(this._videoElement,h.Html5EventType.PLAYING,(function(){t._mediaErrorRecoveryAttempts=0})),this._eventManager.listenOnce(this._videoElement,h.Html5EventType.CAN_PLAY,(function(){r._logger.debug("CAN_PLAY"),t._videoElement.currentTime=n,t._videoElement.play(),t._videoElement.pause(),a&&t.selectAudioTrack(a),i?t.selectTextTrack(i):t.disableNativeTextTracks()}))}},{key:"handleMediaError",value:function(e){return this._loadPromiseReject?(this._loadPromiseReject(new A.default(A.default.Severity.CRITICAL,A.default.Category.MEDIA,A.default.Code.NATIVE_ADAPTER_LOAD_FAILED,e)),!0):!!(e&&e.code===MediaError.MEDIA_ERR_DECODE&&(this._mediaErrorRecoveryAttempts++,this._mediaErrorRecoveryAttempts<=3))&&(this._handleDecodeError(e),!0)}},{key:"attachMediaSource",value:function(){this._startTimeAttach=this._lastTimeDetach,this._lastTimeDetach=NaN}},{key:"detachMediaSource",value:function(){this._lastTimeDetach=this._videoElement.currentTime,this._videoElement&&this._videoElement.src&&(E.Dom.setAttribute(this._videoElement,"src",""),E.Dom.removeAttribute(this._videoElement,"src")),this._loadPromise=void 0}},{key:"_setSrc",value:function(){var e,t=this,n={url:this._sourceObj?this._sourceObj.url:"",body:null,headers:{}};if("function"==typeof E.Object.getPropertyPath(this._config,"network.requestFilter"))try{r._logger.debug("Apply request filter"),e=this._config.network.requestFilter(y.RequestType.MANIFEST,n)}catch(t){e=Promise.reject(t)}return(e=e||Promise.resolve(n)).then((function(e){if(t._config.useSourceTag){var n,a=document.createElement("source"),i=(null===(n=t._sourceObj)||void 0===n?void 0:n.mimetype.toLowerCase())||"";if(a.setAttribute("src",e.url),a.setAttribute("type",i),t._config.useMediaOptionAttribute){var s={};if(t._config.mediaOptionAttribute&&(s=t._config.mediaOptionAttribute),t._config.abrEwmaDefaultEstimate){var o={start:t._config.abrEwmaDefaultEstimate};E.Object.createPropertyPath(s,"option.adaptiveStreaming.bps",o)}r._logger.debug("Setting mediaOption -",s);var l=encodeURI(JSON.stringify(s));a.setAttribute("type",i+";mediaOption="+l)}t._videoElement.appendChild(a)}else t._videoElement.src=e.url})).catch((function(e){t._trigger(h.Html5EventType.ERROR,new A.default(A.default.Severity.CRITICAL,A.default.Category.NETWORK,A.default.Code.REQUEST_FILTER_ERROR,e))})),e}},{key:"_onPlaying",value:function(e){this.isLive()&&this._setStartTime(e)}},{key:"_onLoadedData",value:function(e,t){var n=this,a=function(){n._playerTracks=n._getParsedTracks(),n._addNativeAudioTrackChangeListener(),n._addNativeTextTrackChangeListener(),n._addNativeTextTrackAddedListener(),r._logger.debug("The source has been loaded successfully"),n._loadPromiseReject=void 0,e({tracks:n._playerTracks}),n.isLive()&&n._handleLiveDurationChange()};void 0!==t&&t>-1&&(this._videoElement.currentTime=t),this._videoElement.textTracks.length>0?a():this._eventManager.listenOnce(this._videoElement,h.Html5EventType.CAN_PLAY,a.bind(this)),this._startTimeAttach=NaN}},{key:"_setStartTime",value:function(e){"number"==typeof e&&e>-1&&(this._videoElement.currentTime=e)}},{key:"_onTimeUpdate",value:function(){this._videoElement.paused||(this._videoElement.currentTime>this._lastTimeUpdate?(this._waitingEventTriggered&&(this._waitingEventTriggered=!1,this._trigger(h.Html5EventType.PLAYING)),this._resetHeartbeatTimeout()):this._videoElement.currentTime<this._lastTimeUpdate?this._syncCurrentTime():(this._waitingEventTriggered=!0,this._trigger(h.Html5EventType.WAITING))),this._handleVideoTracksChange()}},{key:"_syncCurrentTime",value:function(){this._lastTimeUpdate=this._videoElement.currentTime}},{key:"_resetHeartbeatTimeout",value:function(){var e=this;this._lastTimeUpdate=this._videoElement.currentTime,this._clearHeartbeatTimeout(),this._heartbeatTimeoutId=setTimeout((function(){e._clearHeartbeatTimeout(),e._trigger(h.Html5EventType.ERROR,new A.default(A.default.Severity.CRITICAL,A.default.Category.NETWORK,A.default.Code.TIMEOUT,"The player exceeded max buffer time of ".concat(e._config.heartbeatTimeout," ms. No progress has been done during this time.")))}),this._config.heartbeatTimeout)}},{key:"_clearHeartbeatTimeout",value:function(){this._heartbeatTimeoutId&&(clearTimeout(this._heartbeatTimeoutId),this._heartbeatTimeoutId=void 0)}},{key:"_handleVideoTracksChange",value:function(){if(!this._isProgressivePlayback()){var e=this._videoElement,t=e.videoHeight,r=e.videoWidth,n=e.videoTracks;if(!this._videoDimensions||t!==this._videoDimensions.videoHeight||r!==this._videoDimensions.videoWidth){this._videoDimensions={videoHeight:t,videoWidth:r};var a={language:"",height:t,width:r,active:!0,index:Array.from(n).findIndex((function(e){return e.selected}))};this._onTrackChanged(new f.default(a))}}}},{key:"destroy",value:function(){var e=this;return r._logger.debug("destroy"),new Promise((function(t,n){e._maybeRemoveSourceTag(),(0,l.default)((0,d.default)(r.prototype),"destroy",e).call(e).then((function(){e._videoElement.classList.remove(R),e._drmHandler&&e._drmHandler.destroy(),e._waitingEventTriggered=!1,e._progressiveSources=[],e._loadPromise=void 0,e._nativeTextTracksMap={},e._loadPromiseReject=void 0,e._liveEdge=0,e._lastTimeUpdate=0,e._lastTimeDetach=NaN,e._startTimeAttach=NaN,e._videoDimensions=void 0,e._clearHeartbeatTimeout(),clearInterval(e._startTimeOfDvrWindowInterval),e._liveDurationChangeInterval&&(clearInterval(e._liveDurationChangeInterval),e._liveDurationChangeInterval=void 0),t()}),(function(){return n}))}))}},{key:"_maybeRemoveSourceTag",value:function(){if(this._config.useSourceTag&&this._videoElement){var e=this._videoElement.firstChild;e&&(e.setAttribute("src",""),e.removeAttribute("src"),this._videoElement.removeChild(e))}}},{key:"_getParsedTracks",value:function(){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),r=this._getParsedTextTracks();return[].concat((0,a.default)(e),(0,a.default)(t),(0,a.default)(r))}},{key:"_getParsedVideoTracks",value:function(){return this._isProgressivePlayback()?this._getParsedProgressiveVideoTracks():this._getParsedAdaptiveVideoTracks()}},{key:"_getParsedProgressiveVideoTracks",value:function(){var e=this._progressiveSources,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,bandwidth:e[r].bandwidth,width:e[r].width,height:e[r].height,active:!!this._sourceObj&&e[r].id===this._sourceObj.id,index:r};t.push(new f.default(n))}return t}},{key:"_getParsedAdaptiveVideoTracks",value:function(){var e=this._videoElement.videoTracks,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,active:e[r].selected,label:e[r].label,language:e[r].language,index:r};t.push(new f.default(n))}return t}},{key:"_getParsedAudioTracks",value:function(){var e=this._videoElement.audioTracks,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,active:e[r].enabled,label:e[r].label,language:e[r].language,index:r,kind:e[r].kind};t.push(new m.default(n))}return t}},{key:"_getParsedTextTracks",value:function(){var e=[this._config.captionsTextTrack1Label,this._config.captionsTextTrack2Label],t=[this._config.captionsTextTrack1LanguageCode,this._config.captionsTextTrack2LanguageCode],r=this._videoElement.textTracks,n=[];if(r){for(var a=0;a<r.length;a++)if(!g.default.isExternalTrack(r[a])){var i={kind:r[a].kind,active:r[a].mode===g.default.MODE.SHOWING,label:r[a].label,language:r[a].language,available:!0};if(i.kind===g.default.KIND.SUBTITLES){var s=new g.default(i);n.push(s),this._nativeTextTracksMap[s.index]=r[a]}else if(i.kind===g.default.KIND.CAPTIONS&&this._config.enableCEA708Captions){i.label=i.label||e.shift(),i.language=i.language||t.shift(),i.available=this._captionsHidden;var o=new g.default(i);n.push(o),this._nativeTextTracksMap[o.index]=r[a]}}this._captionsHidden||this._maybeShow708Captions()}return n}},{key:"_maybeShow708Captions",value:function(){var e=this,t=Array.from(this._videoElement.textTracks).filter((function(e){return e.kind===g.default.KIND.CAPTIONS})),r=t.find((function(e){return e.mode===g.default.MODE.SHOWING||e.mode===g.default.MODE.HIDDEN}))||t[0];r&&(r.mode=g.default.MODE.HIDDEN,this._captionsHidden=!0,this._eventManager.listenOnce(r,"cuechange",(function(){e._getPKTextTracks().forEach((function(e){return(e.available=!0)&&(e.mode=g.default.MODE.DISABLED)})),e._trigger(h.CustomEventType.TRACKS_CHANGED,{tracks:e._playerTracks})})))}},{key:"selectVideoTrack",value:function(e){this._isProgressivePlayback()?this._selectProgressiveVideoTrack(e):this.selectAdaptiveVideoTrack(e)}},{key:"_selectProgressiveVideoTrack",value:function(e){var t=this,r=this._progressiveSources;if(e instanceof f.default&&r&&r[e.index]){var n=this._videoElement.currentTime,a=this._videoElement.paused;e.active=!0,this._sourceObj=r[e.index],this._eventManager.listenOnce(this._videoElement,h.Html5EventType.LOADED_DATA,(function(){"Android Browser"===T.default.browser.name?(t._eventManager.listenOnce(t._videoElement,h.Html5EventType.DURATION_CHANGE,(function(){t._videoElement.currentTime=n})),t._eventManager.listenOnce(t._videoElement,h.Html5EventType.SEEKED,(function(){t._onTrackChanged(e),a&&t._videoElement.pause()})),t._videoElement.play()):(t._eventManager.listenOnce(t._videoElement,h.Html5EventType.SEEKED,(function(){t._onTrackChanged(e)})),t._videoElement.currentTime=n,a||t._videoElement.play())})),this._setSrc()}}},{key:"selectAdaptiveVideoTrack",value:function(e){var t=this._videoElement.videoTracks;e instanceof f.default&&t&&t[e.index]&&(this._disableVideoTracks(),t[e.index].selected=!0,this._onTrackChanged(e))}},{key:"selectAudioTrack",value:function(e){r._logger.debug("selectAudioTrack");var t=this._videoElement.audioTracks;e instanceof m.default&&t&&t[e.index]&&(this._removeNativeAudioTrackChangeListener(),this._switchAudioTrack(e.index),this._onTrackChanged(e),this._addNativeAudioTrackChangeListener())}},{key:"_removeNativeAudioTrackChangeListener",value:function(){this._videoElement.audioTracks&&this._eventManager.unlisten(this._videoElement.audioTracks,"change")}},{key:"_addNativeAudioTrackChangeListener",value:function(){var e=this;this._videoElement.audioTracks&&this._eventManager.listen(this._videoElement.audioTracks,"change",(function(){return e._onNativeAudioTrackChange()}))}},{key:"_getPKAudioTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof m.default})).map((function(e){return e}))}},{key:"_getActivePKAudioTrack",value:function(){return this._getPKAudioTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeAudioTrackChange",value:function(){var e=this,t=function(){for(var t=0;t<e._videoElement.audioTracks.length;t++)if(e._videoElement.audioTracks[t].enabled)return t;return-1}(),n=this._getActivePKAudioTrack(),a=n?n.index:-1;if(t!==a){var i=this._getPKAudioTracks().find((function(e){return e.index===t}));i&&(r._logger.debug("Native selection of track, update the player audio track ("+a+" -> "+t+")"),this._onTrackChanged(i))}}},{key:"selectTextTrack",value:function(e){if(e instanceof g.default&&g.default.isNativeTextTrack(e)){this._removeNativeTextTrackChangeListener();var t=this._nativeTextTracksMap[e.index];t&&(this.disableNativeTextTracks(),t.mode=this._getDisplayTextTrackModeString(),this._onTrackChanged(e),this._addNativeTextTrackChangeListener())}}},{key:"_removeNativeTextTrackChangeListener",value:function(){this._videoElement.textTracks&&this._eventManager.unlisten(this._videoElement.textTracks,"change")}},{key:"_addNativeTextTrackChangeListener",value:function(){var e=this;this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"change",(function(){return e._onNativeTextTrackChange()}))}},{key:"_getPKTextTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof g.default}))}},{key:"_getActivePKTextTrack",value:function(){return this._getPKTextTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeTextTrackChange",value:function(){var e=this,t=this._getPKTextTracks(),n=t.find((function(e){return"off"===e.language})),a=function(){for(var t in e._nativeTextTracksMap)if(e._getDisplayTextTrackModeString()===e._nativeTextTracksMap[t].mode)return Number(t);return-1}(),i=this._getActivePKTextTrack(),s=i?i.index:-1;if(a!==s)if(-1===a)n&&(r._logger.debug("Native selection of track, update the player text track ("+s+" -> off)"),this._onTrackChanged(n));else{var o=t.find((function(e){return e.index===a}));o&&(r._logger.debug("Native selection of track, update the player text track ("+s+" -> "+a+")"),this._onTrackChanged(o))}}},{key:"_getDisplayTextTrackModeString",value:function(){return this._config.displayTextTrack?g.default.MODE.SHOWING:g.default.MODE.HIDDEN}},{key:"_addNativeTextTrackAddedListener",value:function(){var e=this;!this._config.displayTextTrack&&this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"addtrack",(function(){return e._onNativeTextTrackAdded()}))}},{key:"_onNativeTextTrackAdded",value:function(){this._playerTracks=this._getParsedTracks(),this._trigger(h.CustomEventType.TRACKS_CHANGED,{tracks:this._playerTracks})}},{key:"hideTextTrack",value:function(){this.disableNativeTextTracks()}},{key:"enableAdaptiveBitrate",value:function(){r._logger.warn("Enabling adaptive bitrate is not supported for native playback")}},{key:"isAdaptiveBitrateEnabled",value:function(){return!this._isProgressivePlayback()}},{key:"applyABRRestriction",value:function(e){E.Object.createPropertyPath(this._config,"abr.restrictions",e),this._maybeApplyAbrRestrictions(e)}},{key:"_maybeApplyAbrRestrictions",value:function(e){if(this._isProgressivePlayback()){var t=this._playerTracks.filter((function(e){return e instanceof f.default})),n=(0,k.filterTracksByRestriction)(t,e);!n.find((function(e){return e.active}))&&n.length?this.selectVideoTrack(n[0]):r._logger.warn("Invalid restrictions, there are not tracks within the restriction range")}}},{key:"_disableVideoTracks",value:function(){var e=this._videoElement.videoTracks;if(e)for(var t=0;t<e.length;t++)e[t].selected=!1}},{key:"_switchAudioTrack",value:function(e){r._logger.debug("_switchAudioTracks");var t=this._videoElement.audioTracks;if(t)for(var n=0;n<t.length;n++)t[n].enabled=n===e}},{key:"_getLiveEdge",value:function(){return this._videoElement.seekable.length?this._videoElement.seekable.end(this._videoElement.seekable.length-1):this._videoElement.buffered.length?this._videoElement.buffered.end(this._videoElement.buffered.length-1):this._videoElement.duration}},{key:"liveDuration",get:function(){return this._getLiveEdge()}},{key:"seekToLiveEdge",value:function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}}},{key:"getSegmentDuration",value:function(){return this._segmentDuration}},{key:"isLive",value:function(){return this._videoElement.duration===1/0}},{key:"_handleLiveDurationChange",value:function(){var e=this;this._liveDurationChangeInterval=setInterval((function(){e._calculateSegmentDuration();var t=e._getLiveEdge();e._liveEdge!==t&&(e._liveEdge=t,e._videoElement.dispatchEvent(new Event(h.Html5EventType.DURATION_CHANGE)))}),1e3)}},{key:"_calculateSegmentDuration",value:function(){if(this._videoElement.seekable.length>0&&0===this._videoElement.seekable.start(0)){var e=this._videoElement,t=e.buffered,r=e.seekable;t.length&&r.length&&(this._segmentDuration=(t.end(t.length-1)-r.end(r.length-1))/3)}else{var n=this._getLiveEdge();this._liveEdge&&this._liveEdge!==n&&(this._segmentDuration=n-this._liveEdge)}}},{key:"_getStartTimeOfDvrWindow",value:function(){return this.isLive()&&this._videoElement.seekable.length?this._videoElement.seekable.start(0):0}},{key:"getStartTimeOfDvrWindow",value:function(){return this._startTimeOfDvrWindow}},{key:"_setStarTimeOfDvrWindowInterval",value:function(){var e=this;this._startTimeOfDvrWindowInterval=setInterval((function(){var t=e._segmentDuration;!e._waitingEventTriggered&&e._getStartTimeOfDvrWindow()&&t&&Math.abs(e._getStartTimeOfDvrWindow()-e._startTimeOfDvrWindow)<=2*t?e._startTimeOfDvrWindow+=1:e._startTimeOfDvrWindow=e._getStartTimeOfDvrWindow()}),1e3)}},{key:"getDrmInfo",value:function(){return this._drmHandler?this._drmHandler.getDrmInfo():null}}],[{key:"canPlayType",value:function(e){var t=!1;return"string"==typeof e&&(t=!!r.TEST_VIDEO.canPlayType(e.toLowerCase())),r._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t}},{key:"canPlayDrm",value:function(e,t){r._drmProtocol=null;var n,a=x(r._drmProtocols);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.isConfigured(e,t)){r._drmProtocol=i;break}}}catch(e){a.e(e)}finally{a.f()}if(!r._drmProtocol){var s,o=x(r._drmProtocols);try{for(o.s();!(s=o.n()).done;){var l=s.value;l.canPlayDrm(e)&&(r._drmProtocol=l)}}catch(e){o.e(e)}finally{o.f()}}return!!r._drmProtocol}},{key:"createAdapter",value:function(e,t,n){r._logger.debug("createAdapter");var a={displayTextTrack:!1,progressiveSources:[]};if(E.Object.hasPropertyPath(n,"text.useNativeTextTrack")&&(a.displayTextTrack=E.Object.getPropertyPath(n,"text.useNativeTextTrack")),!1!==a.displayTextTrack&&e.classList.add(R),E.Object.hasPropertyPath(n,"sources.progressive")&&(a.progressiveSources=E.Object.getPropertyPath(n,"sources.progressive")),E.Object.hasPropertyPath(n,"text")&&(a.enableCEA708Captions=n.text.enableCEA708Captions,a.captionsTextTrack1Label=n.text.captionsTextTrack1Label,a.captionsTextTrack1LanguageCode=n.text.captionsTextTrack1LanguageCode,a.captionsTextTrack2Label=n.text.captionsTextTrack2Label,a.captionsTextTrack2LanguageCode=n.text.captionsTextTrack2LanguageCode),E.Object.hasPropertyPath(n,"playback")&&E.Object.hasPropertyPath(n.playback,"options.html5.native")&&E.Object.mergeDeep(a,n.playback.options.html5.native),E.Object.hasPropertyPath(n,"abr")){var i=n.abr;i.defaultBandwidthEstimate&&(a.abrEwmaDefaultEstimate=i.defaultBandwidthEstimate),i.restrictions&&E.Object.createPropertyPath(a,"abr.restrictions",i.restrictions)}return a.network=n.network,new this(e,t,a)}}]),r}(v.default);n=M,(0,p.default)(M,"id","NativeAdapter"),(0,p.default)(M,"_logger",v.default.getLogger(n.id)),(0,p.default)(M,"TEST_VIDEO",E.Dom.createElement("video")),(0,p.default)(M,"_drmProtocols",[b.default]),(0,p.default)(M,"_drmProtocol",null),(0,p.default)(M,"_progressiveMimeTypes",["video/mp4","audio/mp3"])},"./src/engines/html5/media-source/base-media-source-adapter.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),o=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),l=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=r("./src/event/fake-event.ts"),p=r("./src/event/fake-event-target.ts"),h=r("./src/error/error.ts"),f=r("./src/event/event-type.ts"),m=r("./src/utils/logger.ts"),g=r("./src/track/video-track.ts"),y=r("./src/track/audio-track.ts"),v=r("./src/track/text-track.ts"),_=r("./src/event/event-manager.ts"),k=r("./src/track/image-track.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}var b=function(e){(0,o.default)(r,e);var t=E(r);function r(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,a.default)(this,r),i=t.call(this),(0,c.default)((0,s.default)(i),"_capabilities",{fpsControl:!1}),i._videoElement=e,i._sourceObj=n,i._config=o,i._onDurationChanged=function(){i.isLive()&&i._videoElement.paused&&i._trigger(f.Html5EventType.TIME_UPDATE)},i._eventManager=new _.EventManager,i._handleLiveTimeUpdate(),i}return(0,i.default)(r,[{key:"destroy",value:function(){return this._sourceObj=void 0,this._config={},this.disableNativeTextTracks(),this._videoElement.removeEventListener(f.Html5EventType.DURATION_CHANGE,this._onDurationChanged),this._eventManager.destroy(),Promise.resolve()}},{key:"_onTrackChanged",value:function(e){e instanceof g.default?(r._logger.debug("Video track changed",e),this._trigger(f.CustomEventType.VIDEO_TRACK_CHANGED,{selectedVideoTrack:e})):e instanceof y.default?(r._logger.debug("Audio track changed",e),this._trigger(f.CustomEventType.AUDIO_TRACK_CHANGED,{selectedAudioTrack:e})):e instanceof v.default?(r._logger.debug("Text track changed",e),this._trigger(f.CustomEventType.TEXT_TRACK_CHANGED,{selectedTextTrack:e})):e instanceof k.default&&(r._logger.debug("Image track changed",e),this._trigger(f.CustomEventType.IMAGE_TRACK_CHANGED,{selectedImageTrack:e}))}},{key:"_trigger",value:function(e,t){this.dispatchEvent(new d.FakeEvent(e,t))}},{key:"applyTextTrackStyles",value:function(e,t,n,a){return r._throwNotImplementedError("applyTextTrackStyles")}},{key:"load",value:function(){return r._throwNotImplementedError("load")}},{key:"selectVideoTrack",value:function(e){return r._throwNotImplementedError("selectVideoTrack")}},{key:"selectAudioTrack",value:function(e){r._throwNotImplementedError("selectAudioTrack")}},{key:"selectTextTrack",value:function(e){r._throwNotImplementedError("selectTextTrack")}},{key:"selectImageTrack",value:function(e){}},{key:"hideTextTrack",value:function(){r._throwNotImplementedError("hideTextTrack")}},{key:"enableAdaptiveBitrate",value:function(){r._throwNotImplementedError("enableAdaptiveBitrate")}},{key:"isAdaptiveBitrateEnabled",value:function(){return r._throwNotImplementedError("isAdaptiveBitrateEnabled")}},{key:"applyABRRestriction",value:function(e){return r._throwNotImplementedError("applyABRRestriction")}},{key:"_getLiveEdge",value:function(){return r._throwNotImplementedError("_getLiveEdge")}},{key:"seekToLiveEdge",value:function(){r._throwNotImplementedError("seekToLiveEdge")}},{key:"isLive",value:function(){return r._throwNotImplementedError("isLive")}},{key:"isOnLiveEdge",value:function(){return 0===this.getSegmentDuration()||this.liveDuration-this._videoElement.currentTime<=2*this.getSegmentDuration()}},{key:"setMaxBitrate",value:function(e){}},{key:"attachMediaSource",value:function(){}},{key:"detachMediaSource",value:function(){}},{key:"_handleLiveTimeUpdate",value:function(){this._videoElement.addEventListener(f.Html5EventType.DURATION_CHANGE,this._onDurationChanged)}},{key:"disableNativeTextTracks",value:function(){Array.from(this._videoElement.textTracks).forEach((function(e){v.default.isNativeTextTrack(e)&&!v.default.isExternalTrack(e)&&(e.mode=v.default.MODE.DISABLED)}))}},{key:"handleMediaError",value:function(e){return!1}},{key:"getStartTimeOfDvrWindow",value:function(){return r._throwNotImplementedError("getStartTimeOfDvrWindow")}},{key:"getThumbnail",value:function(e){return null}},{key:"getSegmentDuration",value:function(){return r._throwNotImplementedError("getSegmentDuration")}},{key:"liveDuration",get:function(){return r._throwNotImplementedError("liveDuration")}},{key:"src",get:function(){return this._loadPromise&&this._sourceObj?this._sourceObj.url:""},set:function(e){!this._loadPromise&&this._sourceObj&&(this._sourceObj.url=e)}},{key:"capabilities",get:function(){return this._capabilities}},{key:"targetBuffer",get:function(){return NaN}},{key:"getDrmInfo",value:function(){return null}},{key:"setCachedUrls",value:function(e){}}],[{key:"isSupported",value:function(){return!0}},{key:"isMSESupported",value:function(){var e=window.MediaSource||window.WebKitMediaSource;return!!e&&"function"==typeof e.isTypeSupported}},{key:"canPlayType",value:function(e,t){return r._throwNotImplementedError("static canPlayType")}},{key:"_throwNotImplementedError",value:function(e){throw new h.default(h.default.Severity.CRITICAL,h.default.Category.PLAYER,h.default.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,e)}}]),r}(p.FakeEventTarget);n=b,(0,c.default)(b,"id","BaseAdapter"),(0,c.default)(b,"getLogger",m.default),(0,c.default)(b,"_logger",n.getLogger(n.id))},"./src/engines/html5/media-source/media-source-provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l},registerMediaSourceAdapter:function(){return u}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/engines/html5/media-source/adapters/native-adapter.ts"),o=r("./src/utils/logger.ts"),l=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"register",value:function(t){t&&(e._mediaSourceAdapters.includes(t)?e._logger.debug("Adapter <".concat(t.id,"> is already registered, do not register again")):(e._logger.debug("Adapter <".concat(t.id,"> has been registered successfully")),e._mediaSourceAdapters.push(t)))}},{key:"unRegister",value:function(t){var r=e._mediaSourceAdapters.indexOf(t);r>-1&&(e._logger.debug("Unregistered <".concat(t.id,"> adapter")),e._mediaSourceAdapters.splice(r,1))}},{key:"canPlaySource",value:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;e._orderMediaSourceAdapters(r);var a=e._mediaSourceAdapters;if(t&&t.mimetype)for(var i=0;i<a.length;i++)if(a[i].canPlayType(t.mimetype)&&(!t.drmData||a[i].canPlayDrm(t.drmData,n)))return e._selectedAdapter=a[i],e._logger.debug("Selected adapter is <".concat(e._selectedAdapter.id,">")),!0;return!1}},{key:"_orderMediaSourceAdapters",value:function(t){e._mediaSourceAdapters=e._mediaSourceAdapters.filter((function(e){return"NativeAdapter"!==e.id})),t?e._mediaSourceAdapters.unshift(s.default):e._mediaSourceAdapters.push(s.default)}},{key:"getMediaSourceAdapter",value:function(t,r,n){return t&&r&&n?(e._selectedAdapter||e.canPlaySource(r,!0,n.drm),e._selectedAdapter?e._selectedAdapter.createAdapter(t,r,n):null):null}},{key:"destroy",value:function(){e._selectedAdapter=null}}]),e}();(0,i.default)(l,"_logger",(0,o.default)("MediaSourceProvider")),(0,i.default)(l,"_mediaSourceAdapters",[s.default]),(0,i.default)(l,"_selectedAdapter",null);var u=l.register},"./src/engines/stream-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{StreamType:function(){return n}});var n={DASH:"dash",HLS:"hls",PROGRESSIVE:"progressive",IMAGE:"image",DOCUMENT:"document"}},"./src/enums/auto-play-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AutoPlayType:function(){return n}});var n={TRUE:!0,FALSE:!1,IN_VIEW:"inview"}},"./src/enums/media-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{MediaType:function(){return n}});var n={VOD:"Vod",LIVE:"Live",AUDIO:"Audio",IMAGE:"Image",DOCUMENT:"Document",UNKNOWN:"Unknown"}},"./src/enums/mime-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{MimeType:function(){return n}});var n={HLS:["application/x-mpegurl","application/vnd.apple.mpegurl"],DASH:["application/dash+xml"],PROGRESSIVE:["video/mp4"],SMOOTH_STREAMING:["application/vnd.ms-sstr+xml"]}},"./src/enums/request-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{RequestType:function(){return n}});var n={MANIFEST:0,SEGMENT:1,LICENSE:2}},"./src/enums/screen-orientation-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ScreenOrientationType:function(){return n}});var n={NONE:"none",ANY:"any",NATURAL:"natural",LANDSCAPE:"landscape",PORTRAIT:"portrait",PORTRAIT_PRIMARY:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary",LANDSCAPE_PRIMARY:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary"}},"./src/error/category.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Category:function(){return n}});var n={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,ADS:8,STORAGE:9,CAST:10,VR:11,MEDIA_NOT_READY:12,GEO_LOCATION:13,MEDIA_UNAVAILABLE:14,IP_RESTRICTED:15,SITE_RESTRICTED:16,SCHEDULED_RESTRICTED:17,ACCESS_CONTROL_BLOCKED:18}},"./src/error/code.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Code:function(){return a}});var n=r("./src/ads/ad-error-code.ts"),a={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,LIVE_MANIFEST_REFRESH_ERROR:1008,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_CREATE_TEXT_CUE:2009,DASH_ADAPTER_ERROR_PARSE_ISSUE:2010,UNKNOWN_FILE_TYPE:2011,UNKNOWN_LANGUAGE:2012,INVALID_VTT_THUMBNAILS_FILE:2013,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,HLS_FATAL_MEDIA_ERROR:3018,HLS_FRAG_PARSING_ERROR:3019,HLS_BUFFER_APPEND_ISSUE:3020,HLS_BUFFER_APPENDING_ISSUE:3021,NATIVE_ADAPTER_LOAD_FAILED:3022,HLS_BUFFER_STALLED_ERROR:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_LIVE_CONTENT_NOT_SUPPORTED:4029,HLSJS_CANNOT_PARSE:4030,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,BAD_FAIRPLAY_RESPONSE:6015,COULD_NOT_CREATE_MEDIA_KEYS:6016,COULD_NOT_CREATE_KEY_SESSION:6017,LOAD_INTERRUPTED:7e3,BITRATE_SWITCH_ISSUE:7001,LOAD_FAILED:7002,RUNTIME_ERROR_NOT_REGISTERED_PLUGIN:7003,RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED:7004,RUNTIME_ERROR_NOT_VALID_HANDLER:7005,NO_SOURCE_PROVIDED:7006,NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE:7007,ENTER_PICTURE_IN_PICTURE_FAILED:7008,EXIT_PICTURE_IN_PICTURE_FAILED:7009,PLUGIN_LOAD_FAILED:7010,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,CONTENT_UNSUPPORTED_BY_BROWSER:9009,CANNOT_ADD_ITEM:9010,DOWNLOAD_FAILED:9011,COULD_NOT_GET_INFO_FROM_MEDIA_PROVIDER:9012,ENTRY_DOES_NOT_EXIST:9013,PAUSE_FAILED:9014,RESUME_FAILED:9015,RENEW_LICENSE_FAILED:9016,ENTRY_ALREADY_EXISTS:9017,REMOVE_FAILED:9018,CAST_LOAD_MEDIA_FAILED:10001,CAST_CUSTOM_MESSAGE_PARSING_ERROR:10002,CAST_EDIT_TRACKS_INFO_ERROR:10003,VR_NOT_SUPPORTED:11e3};Object.assign(a,n.AdErrorCode)},"./src/error/error.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/utils/logger.ts"),o=r("./src/error/severity.ts"),l=r("./src/error/code.ts"),u=r("./src/error/category.ts"),c="Error",d=(0,n.default)((function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0;(0,a.default)(this,e),this.severity=t,this.category=r,this.code=n,this.data=i,this.errorDetails=o||{},(0,s.getLogLevel)(c)!==s.LogLevel.OFF&&e._logger.error("Category:".concat(r," | Code:").concat(n," |"),i)}));(0,i.default)(d,"Severity",o.Severity),(0,i.default)(d,"Category",u.Category),(0,i.default)(d,"Code",l.Code),(0,i.default)(d,"_logger",(0,s.default)(c))},"./src/error/severity.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Severity:function(){return n}});var n={RECOVERABLE:1,CRITICAL:2}},"./src/event/event-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EventManager:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/utils/index.ts");function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=function(){function e(){(0,n.default)(this,e),this._bindingMap=new i.MultiMap}return(0,a.default)(e,[{key:"destroy",value:function(){return this.removeAll(),this._bindingMap=null,Promise.resolve()}},{key:"listenOnce",value:function(e,t,r,n){var a=this;this.listen(e,t,(function n(i){a.unlisten(e,t,n),r.call(a,i)}),n)}},{key:"listen",value:function(e,t,r,n){var a=new u(e,t,r,n);this._bindingMap&&this._bindingMap.push(t,a)}},{key:"unlisten",value:function(e,t,r){if(this._bindingMap)for(var n=this._bindingMap.get(t),a=0;a<n.length;++a){var i=n[a];i.target!==e||i.listener!==r&&r||(i.unlisten(),this._bindingMap&&this._bindingMap.remove(t,i))}}},{key:"removeAll",value:function(){if(this._bindingMap){var e,t=s(this._bindingMap.getAll());try{for(t.s();!(e=t.n()).done;)e.value.unlisten()}catch(e){t.e(e)}finally{t.f()}this._bindingMap&&this._bindingMap.clear()}}}]),e}(),u=function(){function e(t,r,a,i){(0,n.default)(this,e),this.target=t,this.type=r,this.listener=a,this.options=i,this.target.addEventListener(r,a,!1)}return(0,a.default)(e,[{key:"unlisten",value:function(){this.target&&(this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=null)}}]),e}()},"./src/event/event-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CustomEventType:function(){return l},EventType:function(){return u},Html5EventType:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=r("./src/ads/ad-event-type.ts");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},l={MEDIA_LOADED:"medialoaded",PLAYER_RESET:"playerreset",PLAYER_DESTROY:"playerdestroy",ENTER_FULLSCREEN:"enterfullscreen",EXIT_FULLSCREEN:"exitfullscreen",PLAY_FAILED:"playfailed",AUTOPLAY_FAILED:"autoplayfailed",FALLBACK_TO_MUTED_AUTOPLAY:"fallbacktomutedautoplay",CHANGE_SOURCE_STARTED:"changesourcestarted",CHANGE_SOURCE_ENDED:"changesourceended",MUTE_CHANGE:"mutechange",VIDEO_TRACK_CHANGED:"videotrackchanged",AUDIO_TRACK_CHANGED:"audiotrackchanged",TEXT_TRACK_CHANGED:"texttrackchanged",IMAGE_TRACK_CHANGED:"imagetrackchanged",TEXT_TRACK_ADDED:"texttrackadded",TEXT_CUE_CHANGED:"textcuechanged",TRACKS_CHANGED:"trackschanged",ABR_MODE_CHANGED:"abrmodechanged",PLAYER_STATE_CHANGED:"playerstatechanged",PLAYBACK_START:"playbackstart",FIRST_PLAY:"firstplay",FIRST_PLAYING:"firstplaying",PLAYBACK_ENDED:"playbackended",SOURCE_SELECTED:"sourceselected",TEXT_STYLE_CHANGED:"textstylechanged",MEDIA_RECOVERED:"mediarecovered",VR_STEREO_MODE_CHANGED:"vrstereomodechanged",FPS_DROP:"fpsdrop",BOOKMARK_ERROR:"bookmarkerror",CONCURRENCY_LIMIT:"concurrencylimit",RESIZE:"resize",TIMED_METADATA:"timedmetadata",TIMED_METADATA_CHANGE:"timedmetadatachange",TIMED_METADATA_ADDED:"timedmetadataadded",FRAG_LOADED:"fragloaded",MANIFEST_LOADED:"manifestloaded",USER_GESTURE:"usergesture",DRM_LICENSE_LOADED:"drmlicenseloaded",SOURCE_URL_SWITCHED:"sourceurlswitched"},u=s(s(s({},o),l),a.AdEventType)},"./src/event/fake-event-target.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{FakeEventTarget:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/utils/index.ts"),s=r("./src/utils/logger.ts"),o=function(){function e(){(0,n.default)(this,e),this._listeners=new i.MultiMap,this.dispatchTarget=this,this.__logger=(0,s.getLogger)("FakeEventTarget")}return(0,a.default)(e,[{key:"addEventListener",value:function(e,t){this._listeners.push(e,t)}},{key:"removeEventListener",value:function(e,t){this._listeners.remove(e,t)}},{key:"dispatchEvent",value:function(e){for(var t=this._listeners.get(e.type)||[],r=0;r<t.length;++r){e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;var n=t[r];try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(t){this.__logger.error("Error occurred when handling event: ".concat(e.type,"."),t)}if(e.stopped)break}return e.defaultPrevented}}]),e}()},"./src/event/fake-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{FakeEvent:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t,r){(0,n.default)(this,e),this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance?window.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1,this.payload=r}return(0,a.default)(e,[{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.stopped=!0}},{key:"stopPropagation",value:function(){}}]),e}()},"./src/fullscreen/fullscreen-controller.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{FullscreenController:function(){return p}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/event/event-manager.ts"),o=r("./src/event/fake-event.ts"),l=r("./src/utils/util.ts"),u=r("./src/enums/screen-orientation-type.ts"),c=r("./src/engines/engine-type.ts"),d="playkit-in-browser-fullscreen-mode",p=function(){function e(t){(0,n.default)(this,e),(0,i.default)(this,"_isElementInFullscreen",!1),(0,i.default)(this,"_isScreenLocked",!1),(0,i.default)(this,"_isScreenOrientationSupport",!!screen&&!!screen.orientation&&"function"==typeof screen.orientation.unlock&&"function"==typeof screen.orientation.lock),(0,i.default)(this,"_isFullscreenEventDispatched",!1),this._player=t,this._isInBrowserFullscreen=!1,this._eventManager=new s.EventManager}return(0,a.default)(e,[{key:"_isNativeDocumentFullscreen",value:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}},{key:"_isIOSFullscreen",value:function(){var e="function"==typeof this._player.getVideoElement?this._player.getVideoElement():null;return"iOS"===this._player.env.os.name&&!!e&&("fullscreen"===e.webkitPresentationMode||!e.webkitPresentationMode&&e.webkitDisplayingFullscreen)}},{key:"isFullscreen",value:function(){return this._isNativeDocumentFullscreen()&&this._isElementInFullscreen||this._isIOSFullscreen()||this._isInBrowserFullscreen}},{key:"enterFullscreen",value:function(e){if(!this.isFullscreen()){this.registerFullScreenEvents();var t=e&&l.Dom.getElementById(e),r=this._player.config.playback;if(t||(t=this._player.getView()),"iOS"===this._player.env.os.name)if(r.inBrowserFullscreen&&r.playsinline||this._player.engineType===c.EngineType.YOUTUBE)this._enterInBrowserFullscreen(t);else{var n=this._player.getVideoElement();n&&"function"==typeof n.webkitEnterFullScreen&&(this._player.isInPictureInPicture()?(setTimeout((function(){return n.webkitEnterFullScreen()}),1e3),this._player.exitPictureInPicture()):n.webkitEnterFullScreen())}else this._requestFullscreen(t)}}},{key:"exitFullscreen",value:function(){if(this.isFullscreen())if("iOS"===this._player.env.os.name)if(this._isInBrowserFullscreen||this._player.engineType===c.EngineType.YOUTUBE)this._exitInBrowserFullscreen();else{var e=this._player.getVideoElement();e&&"function"==typeof e.webkitExitFullscreen&&e.webkitExitFullscreen()}else this._requestExitFullscreen()}},{key:"_nativeEnterFullScreen",value:function(e){return"function"==typeof e.requestFullscreen?e.requestFullscreen():"function"==typeof e.mozRequestFullScreen?e.mozRequestFullScreen():"function"==typeof e.webkitRequestFullScreen?e.webkitRequestFullScreen():"function"==typeof e.msRequestFullscreen?e.msRequestFullscreen():void 0}},{key:"_requestFullscreen",value:function(e){var t=this;this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),Promise.resolve(this._nativeEnterFullScreen(e)).then((function(){t._isElementInFullscreen=!0;var e=l.Object.getPropertyPath(t._player,"config.playback.screenLockOrientionMode"),r=e!==u.ScreenOrientationType.NONE&&Object.values(u.ScreenOrientationType).includes(e);t._isScreenOrientationSupport&&r&&screen.orientation.lock(e).then((function(){return t._isScreenLocked=!0})).catch((function(){return t._isScreenLocked=!1}))}),(function(){}))}},{key:"_nativeExitFullScreen",value:function(){return"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.msExitFullscreen?document.msExitFullscreen():void 0}},{key:"_requestExitFullscreen",value:function(){var e=this;Promise.resolve(this._nativeExitFullScreen()).then((function(){e._isElementInFullscreen=!1,e._isScreenOrientationSupport&&e._isScreenLocked&&(screen.orientation.unlock(),e._isScreenLocked=!1)}),(function(){}))}},{key:"_enterInBrowserFullscreen",value:function(e){this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),l.Dom.addClassName(e,d),this._isInBrowserFullscreen=!0,this._fullscreenEnterHandler(),this._player.dispatchEvent(new o.FakeEvent(this._player.Event.RESIZE))}},{key:"_exitInBrowserFullscreen",value:function(){var e=l.Dom.getElementBySelector("."+d);e&&l.Dom.removeClassName(e,d),this._isInBrowserFullscreen=!1,this._fullscreenExitHandler(),this._player.dispatchEvent(new o.FakeEvent(this._player.Event.RESIZE))}},{key:"registerFullScreenEvents",value:function(){var e=this;"iOS"===this._player.env.os.name?this._handleIosFullscreen():(this._eventManager.listen(document,"webkitfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"mozfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"fullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"MSFullscreenChange",(function(){return e._fullscreenChangeHandler()})))}},{key:"_handleIosFullscreen",value:function(){var e=this,t=function(){var t=e._player.getVideoElement();t&&(e._eventManager.listen(t,"webkitbeginfullscreen",(function(){return e._fullscreenEnterHandler()})),e._eventManager.listen(t,"webkitendfullscreen",(function(){return e._fullscreenExitHandler()})))};this._player.getVideoElement()?t():this._eventManager.listenOnce(this._player,this._player.Event.SOURCE_SELECTED,(function(){return t()}))}},{key:"_fullscreenChangeHandler",value:function(){this.isFullscreen()?this._fullscreenEnterHandler():this._fullscreenExitHandler()}},{key:"_fullscreenEnterHandler",value:function(){this.isFullscreen()&&!this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!0,this._player.dispatchEvent(new o.FakeEvent(this._player.Event.ENTER_FULLSCREEN)))}},{key:"_fullscreenExitHandler",value:function(){!this.isFullscreen()&&this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!1,this._eventManager.removeAll(),this._player.dispatchEvent(new o.FakeEvent(this._player.Event.EXIT_FULLSCREEN)))}},{key:"destroy",value:function(){this._eventManager.destroy()}}]),e}()},"./src/middleware/base-middleware.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,[{key:"callNext",value:function(e){e&&e()}}]),e}()},"./src/middleware/middleware.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./src/utils/multi-map.ts"),o=r("./src/utils/logger.ts"),l=function(){function e(t){(0,a.default)(this,e),this._actions=t,this._middlewares=new s.MultiMap,this._logger=(0,o.default)("Middleware")}return(0,i.default)(e,[{key:"use",value:function(e){for(var t in this._actions){var r=this._actions[t];"function"==typeof e[r]&&(this._logger.debug("Register <".concat(e.id,"> for action ").concat(r)),this._middlewares.push(r,e[r].bind(e)))}}},{key:"run",value:function(e,t){var r=this;this._logger.debug("Start middleware chain for action "+e);for(var n=this._middlewares.get(e),a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s];this._executeMiddleware(n,(function(){r._logger.debug("Finish middleware chain for action "+e),t.apply(void 0,arguments)}),i)}},{key:"_executeMiddleware",value:function(e,t,r){var a=r,i=function(e,t,r){var i;null!=t&&t.length&&(a=t),null!==(i=a)&&void 0!==i&&i.length?e.apply(void 0,(0,n.default)(a).concat([r])):e(r)},s=e.reduceRight((function(e,t){return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];i(t,n,e)}}),(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];i(t,r)}));s()}}]),e}()},"./src/middleware/playback-middleware.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/middleware/middleware.ts"),o=function(){function e(){(0,n.default)(this,e),this._middleware=new s.default(e.Actions)}return(0,a.default)(e,[{key:"use",value:function(e){this._middleware.use(e)}},{key:"load",value:function(t){this._middleware.run(e.Actions.LOAD,t)}},{key:"play",value:function(t){this._middleware.run(e.Actions.PLAY,t)}},{key:"pause",value:function(t){this._middleware.run(e.Actions.PAUSE,t)}},{key:"setCurrentTime",value:function(t,r){this._middleware.run(e.Actions.SET_CURRENT_TIME,r,t)}}]),e}();(0,i.default)(o,"Actions",{LOAD:"load",PLAY:"play",PAUSE:"pause",SET_CURRENT_TIME:"setCurrentTime"})},"./src/player-config.js":function(e,t,r){"use strict";r.r(t),r.d(t,{DefaultConfig:function(){return n},DefaultSources:function(){return a}});var n={log:{level:"ERROR"},text:{enableCEA708Captions:!0,useNativeTextTrack:!1,forceCenter:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},playback:{audioLanguage:"",textLanguage:"",volume:1,playsinline:!0,preload:"none",autoplay:!1,loop:!1,autopause:!1,allowMutedAutoPlay:!0,updateAudioDescriptionLabels:!0,alphabeticalSort:void 0,muted:!1,pictureInPicture:!0,options:{html5:{hls:{},dash:{},native:{}}},preferNative:{hls:!1,dash:!1},inBrowserFullscreen:!1,screenLockOrientionMode:r("./src/enums/screen-orientation-type.ts").ScreenOrientationType.NONE,playAdsWithMSE:!1,streamPriority:[{engine:"html5",format:"hls"},{engine:"html5",format:"dash"},{engine:"html5",format:"progressive"},{engine:"flash",format:"hls"}]},streaming:{forceBreakStall:!1},abr:{enabled:!0,fpsDroppedFramesInterval:5e3,fpsDroppedMonitoringThreshold:.2,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,restrictions:{minHeight:0,maxHeight:1/0,minWidth:0,maxWidth:1/0,minBitrate:0,maxBitrate:1/0}},drm:{keySystem:""},network:{maxStaleLevelReloads:20}},a={options:{},metadata:{}}},"./src/player.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ie}});var n=r("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),i=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),u=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),c=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),p=r("./src/utils/env.ts"),h=r("./src/event/event-manager.ts"),f=r("./src/utils/poster-manager.ts"),m=r("./src/event/fake-event.ts"),g=r("./src/event/fake-event-target.ts"),y=r("./src/event/event-type.ts"),v=r("./src/utils/util.ts"),_=r("./src/utils/locale.ts"),k=r("./src/utils/logger.ts"),E=r("./src/state/state-manager.ts"),b=r("./src/track/track.ts"),T=r("./src/track/video-track.ts"),A=r("./src/track/audio-track.ts"),S=r("./src/track/text-track.ts"),P=r("./src/track/text-style.ts"),C=r("./src/track/text-track-display.ts"),x=r("./src/state/state-type.ts"),I=r("./src/track/track-type.ts"),w=r("./src/engines/stream-type.ts"),R=r("./src/engines/engine-type.ts"),M=r("./src/enums/media-type.ts"),D=r("./src/track/abr-mode-type.ts"),O=r("./src/engines/html5/cors-types.ts"),L=r("./src/middleware/playback-middleware.ts"),N=r("./src/player-config.js"),U=(r("./src/assets/style.css"),r("./src/error/error.ts")),j=r("./src/engines/engine-provider.ts"),B=r("./src/track/external-captions-handler.ts"),F=r("./src/ads/ad-break-type.ts"),V=r("./src/ads/ad-tag-type.ts"),G=r("./src/utils/index.ts"),H=r("./src/fullscreen/fullscreen-controller.ts"),K=r("./src/engines/engine-decorator.ts"),W=r("./src/track/label-options.ts"),$=r("./src/enums/auto-play-type.ts"),z=r("./src/track/image-track.ts"),q=r("./src/engines/engine-decorator-manager.ts"),Y=r("./src/utils/restrictions.ts"),X=r("./src/thumbnail/external-thumbnails-handler.ts");function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){(0,d.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function J(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.default)(e);if(t){var a=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}var re="playkit-engine",ne="auto",ae="off",ie=function(e){(0,l.default)(r,e);var t=te(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.default)(this,r),e=t.call(this),(0,d.default)((0,o.default)(e),"_sources",{}),(0,d.default)((0,o.default)(e),"_activeTextCues",[]),(0,d.default)((0,o.default)(e),"_textDisplaySettings",{}),(0,d.default)((0,o.default)(e),"_playbackAttributesState",{muted:void 0,volume:void 0,rate:void 0,videoTrack:void 0,audioLanguage:"",textLanguage:"",captionsDisplay:void 0}),(0,d.default)((0,o.default)(e),"_hasUserInteracted",!1),(0,d.default)((0,o.default)(e),"_isOnLiveEdge",!1),(0,d.default)((0,o.default)(e),"_shouldLoadAfterAttach",!1),(0,d.default)((0,o.default)(e),"_cachedUrls",[]),e._setConfigLogLevel(n),e._playerId=v.Generator.uniqueId(5),e._prepareVideoElement(),r.runCapabilities(),e._env=p.default,e._tracks=[],e._firstPlay=!0,e._loadingMedia=!1,e._loading=!1,e._playbackStart=!1,e._firstPlaying=!1,e._reset=!0,e._destroyed=!1,e._fallbackToMutedAutoPlay=!1,e._config=r._defaultConfig,e._sources=v.Object.copyDeep(N.DefaultSources),e._eventManager=new h.EventManager,e._posterManager=new f.default,e._stateManager=new E.default((0,o.default)(e)),e._resizeWatcher=new G.ResizeWatcher,e._playbackMiddleware=new L.default,e._textStyle=new P.default,e._createReadyPromise(),e._createPlayerContainer(),e._appendDomElements(),e._externalCaptionsHandler=new B.ExternalCaptionsHandler((0,o.default)(e)),e._externalThumbnailsHandler=new X.ExternalThumbnailsHandler,e._fullscreenController=new H.FullscreenController((0,o.default)(e)),e.configure(n),e}return(0,s.default)(r,[{key:"configure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setConfigLogLevel(e),v.Object.mergeDeep(this._config,e),this._applyTextTrackConfig(),this._applyABRRestriction(e)}},{key:"setSourcesMetadata",value:function(e){this._sources&&(this._sources.metadata||(this._sources.metadata={}),v.Object.mergeDeep(this._sources.metadata,e))}},{key:"setSources",value:function(e){this._hasSources(e)?(this.reset(),v.Object.mergeDeep(this._sources,e),this._resizeWatcher.init(v.Dom.getElementById(this._playerId)),r._logger.debug("Change source started"),this.dispatchEvent(new m.FakeEvent(y.CustomEventType.CHANGE_SOURCE_STARTED)),this._reset=!1,this._selectEngineByPriority()?(this.dispatchEvent(new m.FakeEvent(y.CustomEventType.SOURCE_SELECTED,{selectedSource:this._sources[this._streamType]})),this._attachMedia(),this._handlePlaybackOptions(),this._posterManager.setSrc(this._sources.poster),this._handleDimensions(),this._handlePreload(),this._handleAutoPlay(),r._logger.debug("Change source ended"),this.dispatchEvent(new m.FakeEvent(y.CustomEventType.CHANGE_SOURCE_ENDED))):(r._logger.warn("No playable engines was found to play the given sources"),this.dispatchEvent(new m.FakeEvent(y.Html5EventType.ERROR,new U.default(U.default.Severity.CRITICAL,U.default.Category.PLAYER,U.default.Code.NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE,"No Engine Found To Play The Source"))))):v.Object.mergeDeep(this._sources,e)}},{key:"ready",value:function(){return this._readyPromise?this._readyPromise:Promise.resolve()}},{key:"load",value:function(){var e=this;this.src?r._logger.debug("The source has already been loaded. load request ignored"):this._playbackMiddleware.load((function(){e._engine?e._load():e._eventManager.listenOnce(e,y.CustomEventType.SOURCE_SELECTED,(function(){return e._load()}))}))}},{key:"play",value:function(e){var t=this;e&&e.programmatic?this._autoPlay():(this._playbackStart||(this._playbackStart=!0,this.dispatchEvent(new m.FakeEvent(y.CustomEventType.PLAYBACK_START)),this.src||this._prepareVideoElement(),this.load()),this._engine?this._playbackMiddleware.play((function(){return t._play()})):this._loadingMedia?this._playbackMiddleware.play((function(){return t._playAfterAsyncMiddleware()})):this.dispatchEvent(new m.FakeEvent(y.Html5EventType.ERROR,new U.default(U.default.Severity.CRITICAL,U.default.Category.PLAYER,U.default.Code.NO_SOURCE_PROVIDED,"No Source Provided"))))}},{key:"pause",value:function(){this._engine&&this._playbackMiddleware.pause(this._pause.bind(this))}},{key:"getView",value:function(){return this._el}},{key:"getVideoElement",value:function(){if(this._engine)return this._engine.getVideoElement()}},{key:"videoHeight",get:function(){return this._engine?this._engine.videoHeight:null}},{key:"videoWidth",get:function(){return this._engine?this._engine.videoWidth:null}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._reset||(this.pause(),this._externalCaptionsHandler.reset(),this._externalThumbnailsHandler.reset(),this._posterManager.reset(),this._stateManager.reset(),this._sources=v.Object.copyDeep(N.DefaultSources),this._activeTextCues=[],this._updateTextDisplay([]),this._tracks=[],S.PKTextTrack.reset(),this._resetStateFlags(),this._engineType="",this._streamType="",this._pendingSelectedVideoTrack=void 0,this._engine&&this._engine.reset(),this.showBlackCover(),this._reset=!0,this.dispatchEvent(new m.FakeEvent(y.CustomEventType.PLAYER_RESET,{isChangeMedia:e})),this._eventManager.removeAll(),this._resizeWatcher.init(v.Dom.getElementById(this._playerId)),this._createReadyPromise(),this._isOnLiveEdge=!1,this._shouldLoadAfterAttach=!1)}},{key:"destroy",value:function(){this._destroyed||(this._externalCaptionsHandler.destroy(),this._posterManager.destroy(),this._stateManager.destroy(),this._fullscreenController.destroy(),this._activeTextCues=[],this._textDisplaySettings={},this._config={},this._tracks=[],this._engineType="",this._streamType="",this._readyPromise=void 0,this._pendingSelectedVideoTrack=void 0,this._resetStateFlags(),this._playbackAttributesState={},this._engine&&this._engine.destroy(),this._engineDecoratorManager&&this._engineDecoratorManager.destroy(),this._resizeWatcher.destroy(),this._el&&v.Dom.removeChild(this._el.parentNode,this._el),this._destroyed=!0,this.dispatchEvent(new m.FakeEvent(y.CustomEventType.PLAYER_DESTROY)),this._eventManager.destroy())}},{key:"hideBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="hidden")}},{key:"showBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="visible")}},{key:"attachMediaSource",value:function(){var e=this;this._engine&&(this._shouldLoadAfterAttach=!0,this._engine.attachMediaSource(),this._eventManager.listenOnce(this,y.Html5EventType.CAN_PLAY,(function(){"number"==typeof e._playbackAttributesState.rate?e.playbackRate=e._playbackAttributesState.rate:e.playbackRate=e.defaultPlaybackRate})))}},{key:"detachMediaSource",value:function(){this._engine&&(this.pause(),this.hideTextTrack(),this._shouldLoadAfterAttach=!1,this._createReadyPromise(),this._engine.detachMediaSource())}},{key:"registerEngineDecoratorProvider",value:function(e){this._engineDecoratorManager||(this._engineDecoratorManager=new q.EngineDecoratorManager),e&&this._engineDecoratorManager.register(e)}},{key:"buffered",get:function(){return this._engine?this._engine.buffered:null}},{key:"stats",get:function(){var e={targetBuffer:NaN,availableBuffer:NaN};return this._engine&&(e.targetBuffer=this._engine.targetBuffer,e.availableBuffer=this._engine.availableBuffer),e}},{key:"currentTime",get:function(){return this._engine?this._engine.currentTime:null},set:function(e){this._playbackMiddleware.setCurrentTime(e,this._setCurrentTime.bind(this))}},{key:"duration",get:function(){return this._engine?this._engine.duration:null}},{key:"liveDuration",get:function(){return this._engine?this._engine.liveDuration:null}},{key:"volume",get:function(){return this._engine?this._engine.volume:null},set:function(e){if(this._engine&&(v.Number.isFloat(e)||0===e||1===e)){var t=e;t<0&&(t=0),t>1&&(t=1),this._engine.volume=t}}},{key:"paused",get:function(){return this._engine?this._engine.paused:null}},{key:"seeking",get:function(){return this._engine?this._engine.seeking:null}},{key:"playsinline",get:function(){return this._engine?this._engine.playsinline:null},set:function(e){this._engine&&(this._engine.playsinline=e)}},{key:"muted",get:function(){return this._engine?this._engine.muted:null},set:function(e){this._engine&&(this._engine.muted=e,this.dispatchEvent(new m.FakeEvent(y.CustomEventType.MUTE_CHANGE,{mute:e})),!1===e&&(this._fallbackToMutedAutoPlay=e))}},{key:"src",get:function(){return this._engine?this._engine.src:null}},{key:"dimensions",get:function(){return{width:this._el.clientWidth,height:this._el.clientHeight}},set:function(e){var t=this._getTargetElement();if(!e||v.Object.isEmptyObject(e))this._aspectRatio=null,t.style.width=null,t.style.height=null;else{var r=v.Object.mergeDeep(this.dimensions,e),n=r.height,a=r.width;t.style.width="number"==typeof a?"".concat(a,"px"):a,t.style.height="number"==typeof n?"".concat(n,"px"):n,this._calcRatio(t,e)}}},{key:"_getTargetElement",value:function(){return v.Dom.getElementById(this._config.targetId)}},{key:"poster",get:function(){return this._posterManager.src}},{key:"playbackRate",get:function(){return this._engine?this._engine.playbackRate:null},set:function(e){this._engine&&(this._engine.playbackRate=e)}},{key:"playbackRates",get:function(){return this._playbackRates?this._playbackRates:this._engine?this._engine.playbackRates:[]}},{key:"defaultPlaybackRate",get:function(){return this._engine?"number"==typeof this._defaultPlaybackRate||this._defaultPlaybackRate>0?this._defaultPlaybackRate:this._engine.defaultPlaybackRate:1}},{key:"engineType",get:function(){return this._engineType}},{key:"streamType",get:function(){return this._streamType}},{key:"env",get:function(){return this._env}},{key:"config",get:function(){return v.Object.mergeDeep({},this._config)}},{key:"sources",get:function(){return v.Object.mergeDeep({},this._sources)}},{key:"hasUserInteracted",get:function(){return this._hasUserInteracted}},{key:"loadingMedia",set:function(e){this._loadingMedia=e}},{key:"crossOrigin",get:function(){return this._engine?this._engine.crossOrigin:null},set:function(e){this._engine&&(this._engine.crossOrigin=e)}},{key:"ended",get:function(){return this._engine?this._engine.ended:null}},{key:"playbackMiddleware",get:function(){return this._playbackMiddleware}},{key:"posterManager",get:function(){return this._posterManager}},{key:"isLive",value:function(){return!(this._sources.type===M.MediaType.VOD||!(this._sources.type===M.MediaType.LIVE||this._engine&&this._engine.isLive()))}},{key:"isAudio",value:function(){return this._sources.type===M.MediaType.AUDIO}},{key:"isOnLiveEdge",value:function(){return this._engine&&"function"==typeof this._engine.isOnLiveEdge?this._engine.isOnLiveEdge():this._isOnLiveEdge}},{key:"isDvr",value:function(){return this.isLive()&&this._sources.dvr}},{key:"seekToLiveEdge",value:function(){this._engine&&this.isLive()&&(this._engine.seekToLiveEdge(),this._isOnLiveEdge=!0)}},{key:"getStartTimeOfDvrWindow",value:function(){return this._engine?this._engine.getStartTimeOfDvrWindow():0}},{key:"getTracks",value:function(e){switch(e){case I.TrackType.VIDEO:return v.Object.copyDeep(this._getVideoTracks());case I.TrackType.AUDIO:return v.Object.copyDeep(this._getAudioTracks());case I.TrackType.TEXT:return v.Object.copyDeep(this._getTextTracks());case I.TrackType.IMAGE:return v.Object.copyDeep(this._getImageTracks());default:return v.Object.copyDeep(this._tracks)}}},{key:"getActiveTracks",value:function(){return v.Object.copyDeep({video:this._getVideoTracks().find((function(e){return e.active})),audio:this._getAudioTracks().find((function(e){return e.active})),text:this._getTextTracks().find((function(e){return e.active}))})}},{key:"changeQuality",value:function(e){"auto"===e?this.enableAdaptiveBitrate():this.selectTrack(e),this._markActiveTrack(e)}},{key:"selectTrack",value:function(e){this._engine&&(e instanceof T.default?(this._playbackAttributesState.videoTrack=e,this._stateManager.currentState.type===x.StateType.IDLE?this._pendingSelectedVideoTrack=e:this._engine.selectVideoTrack(e)):e instanceof A.default?this._engine.selectAudioTrack(e):e instanceof S.PKTextTrack?(this._resetTextDisplay(),e.language===ae?(this.hideTextTrack(),this._externalCaptionsHandler.hideTextTrack(),this._playbackAttributesState.captionsDisplay=!1):e.external?(this._engine.hideTextTrack(),this._externalCaptionsHandler.selectTextTrack(e)):(this._externalCaptionsHandler.hideTextTrack(),this._engine.selectTextTrack(e))):e instanceof z.default&&this._engine.selectImageTrack(e))}},{key:"hideTextTrack",value:function(){if(this._engine){this._engine.hideTextTrack(),this._resetTextDisplay();var e=this._getTextTracks(),t=e.find((function(e){return!0===e.active}));t&&t.external&&this._externalCaptionsHandler.hideTextTrack(),e.map((function(e){return e.active=!1}));var r=e.find((function(e){return e.language===ae}));r&&(r.active=!0,this.dispatchEvent(new m.FakeEvent(y.CustomEventType.TEXT_TRACK_CHANGED,{selectedTextTrack:r}))),this._playbackAttributesState.captionsDisplay=!1}}},{key:"showTextTrack",value:function(){var e=this._getTextTracks(),t=this._playbackAttributesState.textLanguage||this._getLanguage(e,ne,e.find((function(e){return e.default})));this._setDefaultTrack(e,t)}},{key:"addTextTrack",value:function(e,t,r){if(this._engine&&"function"==typeof this._engine.addTextTrack)return this._engine.addTextTrack(e,t,r)}},{key:"getNativeTextTracks",value:function(){return this._engine&&"function"==typeof this._engine.getNativeTextTracks?this._engine.getNativeTextTracks():[]}},{key:"enableAdaptiveBitrate",value:function(){this._engine&&this._engine.enableAdaptiveBitrate(),this._playbackAttributesState.videoTrack=void 0}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._engine&&this._engine.isAdaptiveBitrateEnabled()}},{key:"_applyABRRestriction",value:function(e){var t;if(v.Object.hasPropertyPath(e,"abr.restrictions")&&this._engine&&null!==(t=this._tracks)&&void 0!==t&&t.length){var n=this._config.abr.restrictions,a=this._tracks.filter((function(e){return e instanceof T.default})),i=(0,Y.filterTracksByRestriction)(a,n);if(i.length){var s=this._tracks.filter((function(e){return e instanceof T.default&&e.available}));(s.length!==i.length||!s.every((function(e,t){return e.bandwidth===i[t].bandwidth})))&&(this._engine.applyABRRestriction(n),this._tracks.forEach((function(e){!i.includes(e)&&e instanceof T.default?(e.available=!1,e.active=!1):e.available=!0})),this.getActiveTracks().video||(i[0].active=!0),this.dispatchEvent(new m.FakeEvent(y.CustomEventType.TRACKS_CHANGED,{tracks:this._tracks.filter((function(e){return e.available}))})))}else r._logger.warn("Invalid restriction, Nothing has changed values do not meet the restriction")}}},{key:"_applyTextTrackConfig",value:function(){var e=v.Object.getPropertyPath(this._config,"text.textTrackDisplaySetting"),t=v.Object.getPropertyPath(this._config,"text.useNativeTextTrack"),n=v.Object.getPropertyPath(this._config,"text.textStyle");if(e&&!t){var a=v.Object.mergeDeep({},e,{align:(null==e?void 0:e.align)||(null==n?void 0:n.textAlign)||"center"});v.Object.getPropertyPath(this._config,"text.forceCenter")&&(a.position="auto",a.align="center",a.size="100"),this.setTextDisplaySettings(a)}try{n&&(this.textStyle=P.default.fromJson(n))}catch(e){r._logger.warn(e)}}},{key:"getThumbnail",value:function(e){return this._externalThumbnailsHandler.isUsingVttThumbnails()?this._externalThumbnailsHandler.getThumbnail(e):this._engine?this._engine.getThumbnail(e):null}},{key:"setTextDisplaySettings",value:function(e){this._textDisplaySettings=v.Object.mergeDeep(this._textDisplaySettings,e),this._updateCueDisplaySettings();for(var t=0;t<this._activeTextCues.length;t++)this._activeTextCues[t].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)}},{key:"textDisplaySetting",get:function(){return v.Object.copyDeep(this._textDisplaySettings)}},{key:"textStyle",get:function(){return this._textStyle.clone()},set:function(e){if(!(e instanceof P.default))throw new Error("Style must be instance of TextStyle");(0,G.resetSubtitleStyleSheet)(this._playerId);try{this._textStyle=e,this._config.text.useNativeTextTrack?this._applyCustomSubtitleStyles():this._engine&&(this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay(this._activeTextCues)),this.dispatchEvent(new m.FakeEvent(y.CustomEventType.TEXT_STYLE_CHANGED))}catch(e){r._logger.error(e.message)}}},{key:"isFullscreen",value:function(){return this._fullscreenController.isFullscreen()}},{key:"notifyEnterFullscreen",value:function(){this.isFullscreen()&&this.dispatchEvent(new m.FakeEvent(y.CustomEventType.ENTER_FULLSCREEN))}},{key:"notifyExitFullscreen",value:function(){this.isFullscreen()||this.dispatchEvent(new m.FakeEvent(y.CustomEventType.EXIT_FULLSCREEN))}},{key:"enterFullscreen",value:function(e){this._fullscreenController.enterFullscreen(e)}},{key:"exitFullscreen",value:function(){this._fullscreenController.exitFullscreen()}},{key:"enterPictureInPicture",value:function(){this.isFullscreen()&&this.exitFullscreen(),this._engine&&!this._engine.isInPictureInPicture&&this._engine.enterPictureInPicture()}},{key:"exitPictureInPicture",value:function(){this._engine&&this._engine.isInPictureInPicture&&this._engine.exitPictureInPicture()}},{key:"isInPictureInPicture",value:function(){return!!this._engine&&this._engine.isInPictureInPicture}},{key:"isPictureInPictureSupported",value:function(){return!!this._config.playback.pictureInPicture&&this._engine.isPictureInPictureSupported()}},{key:"isVr",value:function(){return!!this._sources.vr}},{key:"getLogLevel",value:function(e){return(0,k.getLogLevel)(e)}},{key:"setLogLevel",value:function(e,t){(0,k.setLogLevel)(e,t)}},{key:"getDrmInfo",value:function(){return this._engine.getDrmInfo()}},{key:"_applyCustomSubtitleStyles",value:function(){try{var e,t=(null===(e=this._el)||void 0===e||null===(e=e.parentElement)||void 0===e?void 0:e.id)||this._playerId;if(this._config.text.useNativeTextTrack&&!this._config.text.useShakaTextTrackDisplay){var n=(0,G.getSubtitleStyleSheet)(this._playerId);B.ExternalCaptionsHandler.applyNativeTextTrackStyles(n,this._textStyle,t,re)}else if(this._config.text.useShakaTextTrackDisplay){var a,i;(0,G.resetSubtitleStyleSheet)(this._playerId);var s=(0,G.getSubtitleStyleSheet)(this._playerId);null===(a=this._engine.mediaSourceAdapter)||void 0===a||null===(i=a.applyTextTrackStyles)||void 0===i||i.call(a,s,this._textStyle,t)}}catch(e){r._logger.error("Failed to add custom text style: ".concat(e.message))}}},{key:"_resetTextDisplay",value:function(){this._activeTextCues=[],this._updateTextDisplay([])}},{key:"_prepareVideoElement",value:function(){var e=this;j.EngineProvider.getEngines().forEach((function(t){t.prepareVideoElement(e._playerId)}))}},{key:"_setConfigLogLevel",value:function(e){e.log&&e.log.level&&k.LogLevel[e.log.level]&&(0,k.setLogLevel)(k.LogLevel[e.log.level]),e.log&&"function"==typeof e.log.handler&&(0,k.setLogHandler)(e.log.handler)}},{key:"_hasSources",value:function(e){return!!e&&!!Object.values(w.StreamType).find((function(t){return e[t]&&e[t].length>0}))}},{key:"_createPlayerContainer",value:function(){var e=this._el=v.Dom.createElement("div");v.Dom.addClassName(e,"playkit-container"),v.Dom.setAttribute(e,"id",this._playerId),v.Dom.setAttribute(e,"tabindex","-1")}},{key:"_appendEngineEl",value:function(){if(this._el){var e=this._engine.getVideoElement(),t="".concat(re);v.Dom.addClassName(e,t);var r="".concat(re,"-").concat(this._engine.id);v.Dom.addClassName(e,r),v.Dom.prependTo(e,this._el),v.Dom.setAttribute(e,"tabindex","-1"),this._isYouTubeEngine()?this._el.style.zIndex="1":this._el.style.zIndex&&(this._el.style.zIndex="")}}},{key:"_appendDomElements",value:function(){var e=v.Dom.createElement("div");v.Dom.addClassName(e,"playkit-video-filter"),v.Dom.appendChild(this._el,e),this._blackCoverEl=v.Dom.createElement("div"),v.Dom.addClassName(this._blackCoverEl,"playkit-black-cover"),v.Dom.appendChild(this._el,this._blackCoverEl);var t=this._posterManager.getElement();v.Dom.addClassName(t,"playkit-poster"),v.Dom.appendChild(this._el,t),this._textDisplayEl=v.Dom.createElement("div"),v.Dom.addClassName(this._textDisplayEl,"playkit-subtitles"),v.Dom.appendChild(this._el,this._textDisplayEl)}},{key:"_createReadyPromise",value:function(){var e=this;this._readyPromise=new Promise((function(t,r){e._eventManager.listenOnce(e,y.CustomEventType.TRACKS_CHANGED,(function(){e.dispatchEvent(new m.FakeEvent(y.CustomEventType.MEDIA_LOADED)),e._handlePlaybackRate(),t()})),e._eventManager.listen(e,y.Html5EventType.ERROR,(function(e){e.payload.severity===U.default.Severity.CRITICAL&&r()}))})).catch((function(){}))}},{key:"_handlePlaybackRate",value:function(){"number"==typeof this._playbackAttributesState.rate?this.playbackRate=this._playbackAttributesState.rate:"number"==typeof this._config.playback.playbackRate?this.playbackRate=this._config.playback.playbackRate:this.playbackRate=this.defaultPlaybackRate}},{key:"_selectEngineByPriority",value:function(){var e,t=this,n=this._config.playback.streamPriority,a=this._config.playback.preferNative,i=this._sources,s=J(n);try{var o,l=function(){var n=e.value,s="string"==typeof n.engine?n.engine.toLowerCase():"",o="string"==typeof n.format?n.format.toLowerCase():"",l=j.EngineProvider.getEngines().find((function(e){return e.id===s}));if(l){var u=i[o];if(u&&u.length>0){var c=u[0];if(l.canPlaySource(c,a[o],t._config.drm))return r._logger.debug("Source selected: ",u),t._loadEngine(l,c),t._engineType=s,t._streamType=o,{v:!0}}}};for(s.s();!(e=s.n()).done;)if(o=l())return o.v}catch(e){s.e(e)}finally{s.f()}return!1}},{key:"_loadEngine",value:function(e,t){if(this._engine)if(this._engine.id===e.id)this._engine.restore(t,Q(Q({},this._config),{},{sources:this._sources}));else{if(this._engine.destroy(),this._createEngine(e,t),this._isYouTubeEngine()){var r=".".concat(this._el.className," .").concat(re,".").concat(re,"-").concat(this._engine.id),n=v.Dom.getElementBySelector(r);n&&v.Dom.removeChild(this._el,n)}this._appendEngineEl()}else this._createEngine(e,t),this._appendEngineEl()}},{key:"_isYouTubeEngine",value:function(){var e;return"youtube"===(null===(e=this._engine)||void 0===e?void 0:e.id)}},{key:"_createEngine",value:function(e,t){var r=e.createEngine(t,Q(Q({},this._config),{},{sources:this._sources}),this._playerId);this._engine=this._engineDecoratorManager?new K.EngineDecorator(r,this._engineDecoratorManager):r,this._cachedUrls.length&&this.setCachedUrls(this._cachedUrls)}},{key:"_attachMedia",value:function(){var e=this;if(this._engine){Object.keys(y.Html5EventType).forEach((function(t){e._eventManager.listen(e._engine,y.Html5EventType[t],(function(t){return e.dispatchEvent(t)}))})),this._eventManager.listen(this._engine,y.Html5EventType.SEEKING,(function(){e.isLive()&&(e._isOnLiveEdge=!(!e.duration||!e.currentTime)&&e.currentTime>=e.duration-1&&!e.paused)})),this._eventManager.listen(this._engine,y.CustomEventType.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.TEXT_TRACK_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.VIDEO_TRACK_CHANGED,(function(t){return e._markActiveTrack(t.payload.selectedVideoTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.AUDIO_TRACK_CHANGED,(function(t){e.ready().then((function(){return e._playbackAttributesState.audioLanguage=t.payload.selectedAudioTrack.language})),e._markActiveTrack(t.payload.selectedAudioTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._engine,y.CustomEventType.TRACKS_CHANGED,(function(t){return e._onTracksChanged(t)})),this._eventManager.listen(this._engine,y.CustomEventType.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._engine,y.CustomEventType.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.TIMED_METADATA,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.TIMED_METADATA_CHANGE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.PLAY_FAILED,(function(t){e._onPlayFailed(t),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.FPS_DROP,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.CustomEventType.MEDIA_RECOVERED,(function(){return e._handleRecovered()})),this._eventManager.listen(this,y.CustomEventType.CHANGE_SOURCE_ENDED,(function(){return e._addTitleOnIframe()})),this._eventManager.listen(this,y.Html5EventType.PLAY,this._onPlay.bind(this)),this._eventManager.listen(this,y.Html5EventType.PAUSE,this._onPause.bind(this)),this._eventManager.listen(this,y.Html5EventType.PLAYING,this._onPlaying.bind(this)),this._eventManager.listen(this,y.Html5EventType.ENDED,this._onEnded.bind(this)),this._eventManager.listen(this,y.CustomEventType.MUTE_CHANGE,(function(t){var r;e._playbackAttributesState.muted=(null===(r=t.payload)||void 0===r?void 0:r.mute)||e.muted})),this._eventManager.listen(this,y.Html5EventType.VOLUME_CHANGE,(function(){e._playbackAttributesState.volume=e.volume})),this._eventManager.listen(this,y.Html5EventType.RATE_CHANGE,(function(){e._playbackAttributesState.rate=e.playbackRate})),this._eventManager.listen(this,y.CustomEventType.ENTER_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this,y.CustomEventType.EXIT_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this._resizeWatcher,y.CustomEventType.RESIZE,(function(t){e._resetTextCuesAndReposition(),e.dispatchEvent(t)})),this._eventManager.listen(this._externalCaptionsHandler,y.CustomEventType.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._externalCaptionsHandler,y.CustomEventType.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._externalCaptionsHandler,y.Html5EventType.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._externalThumbnailsHandler,y.Html5EventType.ERROR,(function(t){return e.dispatchEvent(t)}));var t=v.Dom.getElementBySelector("#".concat(this.config.targetId));t&&this._eventManager.listen(t,"click",(function(){e._hasUserInteracted=!0,e.dispatchEvent(new m.FakeEvent(y.CustomEventType.USER_GESTURE))}),{capture:!0})}}},{key:"_addTitleOnIframe",value:function(){if(window.self!==window.top){var e=v.Dom.getElementBySelector("head"),t=e.querySelector("title");t||(t=v.Dom.createElement("title"),e.appendChild(t)),t.innerHTML=this._sources.metadata.name?this._sources.metadata.name:""}}},{key:"_handleRecovered",value:function(){this._stateManager.currentState.type===x.StateType.PLAYING&&this.play()}},{key:"_onTextTrackChanged",value:function(e){var t=this;this.ready().then((function(){return t._playbackAttributesState.textLanguage=e.payload.selectedTextTrack.language})),this._markActiveTrack(e.payload.selectedTextTrack),this.dispatchEvent(e)}},{key:"_resetTextCuesAndReposition",value:function(){this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay([]);for(var e=0;e<this._activeTextCues.length;e++)this._activeTextCues[e].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)}},{key:"_handlePlaybackOptions",value:function(){if(this._config.playback=this._config.playback||{},"boolean"==typeof this._playbackAttributesState.muted?this.muted=this._playbackAttributesState.muted:"boolean"==typeof this._config.playback.muted&&(this.muted=this._config.playback.muted),"number"==typeof this._playbackAttributesState.volume?this.volume=this._playbackAttributesState.volume:"number"==typeof this._config.playback.volume&&(this.volume=this._config.playback.volume),"boolean"==typeof this._config.playback.playsinline&&(this.playsinline=this._config.playback.playsinline),"string"==typeof this._config.playback.crossOrigin&&(this.crossOrigin=this._config.playback.crossOrigin),"number"==typeof this._config.playback.defaultPlaybackRate&&(this._defaultPlaybackRate=this._config.playback.defaultPlaybackRate),Array.isArray(this._config.playback.playbackRates)){var e=this._config.playback.playbackRates.filter((function(e,t,r){return e>0&&e<=16&&r.indexOf(e)===t})).sort((function(e,t){return e-t}));e&&(this._playbackRates=e)}}},{key:"_handlePreload",value:function(){"auto"!==this._config.playback.preload||this._config.playback.autoplay||this.load()}},{key:"_autoPlay",value:function(){var e=this,t=this._config.playback.allowMutedAutoPlay;r.getCapabilities(this.engineType).then((function(r){r.autoplay?a():r.mutedAutoPlay?n()&&!e._fallbackToMutedAutoPlay?i():t?s():o():o()}));var n=function(){r._logger.debug("Checking muted value");var t="boolean"==typeof e._playbackAttributesState.muted&&e._playbackAttributesState.muted||"boolean"==typeof e._config.playback.muted&&e._config.playback.muted||e.muted;return r._logger.debug("Muted value is:",t),t},a=function(){r._logger.debug("Start autoplay"),e._fallbackToMutedAutoPlay&&(e._fallbackToMutedAutoPlay=!1,e.muted=!1),e.play()},i=function(){r._logger.debug("Start muted autoplay"),e.play()},s=function(){r._logger.debug("Fallback to muted autoplay"),e._fallbackToMutedAutoPlay=!0,e.muted=!0,e.dispatchEvent(new m.FakeEvent(y.CustomEventType.FALLBACK_TO_MUTED_AUTOPLAY)),e.play()},o=function(){r._logger.warn("Autoplay failed, pause player"),e._posterManager.show(),e.load(),e.dispatchEvent(new m.FakeEvent(y.CustomEventType.AUTOPLAY_FAILED))}}},{key:"_handleAutoPlay",value:function(){(this.isAudio()||this._config.playback.autoplay!==$.AutoPlayType.TRUE)&&this._posterManager.show(),this._config.playback.autoplay===$.AutoPlayType.TRUE&&this._autoPlay()}},{key:"_playAfterAsyncMiddleware",value:function(){var e=this;this._engine?this._play():this._eventManager.listenOnce(this,y.CustomEventType.SOURCE_SELECTED,(function(){return e._play()}))}},{key:"_load",value:function(){var e=this;if(this._engine&&!this.src&&!this._loading){this._loading=!0;var t=this._sources.startTime;this._engine.load(t).then((function(r){e.isLive()&&(-1===t||Number(t)>=Number(e.duration))&&(e._isOnLiveEdge=!0),e._updateTracks(r.tracks),e.dispatchEvent(new m.FakeEvent(y.CustomEventType.TRACKS_CHANGED,{tracks:e._tracks})),e.sources.thumbnails&&e._externalThumbnailsHandler.load(e.sources.thumbnails)})).finally((function(){e._loading=!1,e._reset=!1}))}}},{key:"_handleDimensions",value:function(){var e=this.config.dimensions;v.Object.isObject(e)&&!v.Object.isEmptyObject(e)&&(this.dimensions=e)}},{key:"_play",value:function(){var e=this;this._shouldLoadAfterAttach&&(this._load(),this._shouldLoadAfterAttach=!1),this.ready().then((function(){e._shouldPlayerSeekToLiveEdge()&&e.seekToLiveEdge(),e._engine.play()}))}},{key:"_shouldPlayerSeekToLiveEdge",value:function(){if(this.isLive()){var e=!this.isDvr()||"number"==typeof this.currentTime&&this.currentTime<0;return this._firstPlay?!!this.src&&!this.isOnLiveEdge()&&void 0===this._sources.startTime:e}return!1}},{key:"_pause",value:function(){this._engine.pause()}},{key:"_setCurrentTime",value:function(e){if(this._engine&&v.Number.isNumber(e)){var t=e;e<0&&(t=0);var r=this.isLive()?this._engine.duration:this._engine.duration-.1;t>r&&(t=r),this._engine.currentTime=t}}},{key:"_onPause",value:function(){this._isOnLiveEdge=!1}},{key:"_onPlay",value:function(){this._firstPlay&&(this._firstPlay=!1,this.dispatchEvent(new m.FakeEvent(y.CustomEventType.FIRST_PLAY)),this.hideBlackCover(),this._checkEndTime(),"number"==typeof this._playbackAttributesState.rate&&(this.playbackRate=this._playbackAttributesState.rate))}},{key:"_onPlaying",value:function(){this._firstPlaying||(this._firstPlaying=!0,this.isAudio()||this._posterManager.hide(),this.dispatchEvent(new m.FakeEvent(y.CustomEventType.FIRST_PLAYING))),this._engine&&this._pendingSelectedVideoTrack&&(this._engine.selectVideoTrack(this._pendingSelectedVideoTrack),this._pendingSelectedVideoTrack=void 0)}},{key:"_checkEndTime",value:function(){var e=this,t=this._sources.endTime;t&&"number"==typeof this.currentTime&&this.currentTime<t&&this._eventManager.listen(this._engine,y.Html5EventType.TIME_UPDATE,(function r(){Math.floor(e.currentTime)===t&&(e.pause(),e._eventManager.unlisten(e._engine,y.Html5EventType.TIME_UPDATE,r))}))}},{key:"_onPlayFailed",value:function(e){this._firstPlay&&this._config.playback.autoplay&&(this._posterManager.show(),this.dispatchEvent(new m.FakeEvent(y.CustomEventType.AUTOPLAY_FAILED,e.payload)))}},{key:"_onEnded",value:function(){this.paused||this._pause()}},{key:"_resetStateFlags",value:function(){this._loading=!1,this._firstPlay=!0,this._loadingMedia=!1,this._playbackStart=!1,this._firstPlaying=!1}},{key:"_calcRatio",value:function(e,t){if(void 0!==t.ratio&&(this._aspectRatio=t.ratio),this._aspectRatio){var r=this._aspectRatio.split(":").map((function(e){return Number(e)})),n=(0,a.default)(r,2),i=n[0],s=n[1];if(t.width||!t.width&&!t.height){var o=s/i*e.clientWidth;e.style.height="".concat(o,"px")}else if(t.height&&!t.width){var l=i/s*e.clientHeight;e.style.width="".concat(l,"px")}}}},{key:"_onTracksChanged",value:function(e){this._updateTracks(e.payload.tracks),this.dispatchEvent(e)}},{key:"_updateTracks",value:function(e){var t;e&&(r._logger.debug("Tracks changed",e),this.config.playback.updateAudioDescriptionLabels&&(0,A.audioDescriptionTrackHandler)(e,null===(t=this._sources.metadata)||void 0===t?void 0:t.audioFlavors),this._tracks=null==e?void 0:e.concat(this._externalCaptionsHandler.getExternalTracks(e)),this._applyABRRestriction(this._config),this._addTextTrackOffOption(),this._maybeSetTracksLabels(),this._setDefaultTracks())}},{key:"_getTracksByType",value:function(e){var t;return null===(t=this._tracks)||void 0===t?void 0:t.reduce((function(t,r){return r instanceof e&&r.available&&t.push(r),t}),[])}},{key:"_getImageTracks",value:function(){return this._getTracksByType(z.default)}},{key:"_getTextTracks",value:function(){return this._getTracksByType(S.PKTextTrack)}},{key:"_getVideoTracks",value:function(){return this._getTracksByType(T.default)}},{key:"_getAudioTracks",value:function(){var e=this._getTracksByType(A.default);return this._config.playback.alphabeticalSort&&(e=e.sort((function(e,t){var r,n,a=(null===(r=e.label)||void 0===r?void 0:r.toLowerCase())||e.language||"",i=(null===(n=t.label)||void 0===n?void 0:n.toLowerCase())||t.language||"";return a.localeCompare(i)}))),e}},{key:"_markActiveTrack",value:function(e){var t;if(e instanceof T.default?t=this._getVideoTracks():e instanceof A.default?t=this._getAudioTracks():e instanceof S.PKTextTrack&&(t=this._getTextTracks()),t)for(var r=0;r<t.length;r++)t[r].active=e.index===t[r].index}},{key:"_onCueChange",value:function(e){r._logger.debug("Text cue changed",e.payload.cues);try{this._activeTextCues=e.payload.cues.filter((function(e,t,r){var n=r[t-1];return!n||!(e.startTime===n.startTime&&e.endTime===n.endTime&&e.text.trim()===n.text.trim())}))}catch(t){this._activeTextCues=e.payload.cues}this._updateCueDisplaySettings(),this._updateTextDisplay(this._activeTextCues),this.dispatchEvent(e)}},{key:"_updateCueDisplaySettings",value:function(){for(var e=this._activeTextCues,t=this._textDisplaySettings,r=0;r<e.length;r++){var n=e[r];for(var a in t)t[a]&&(n[a]=t[a])}}},{key:"_updateTextDisplay",value:function(e){this._config.text.useShakaTextTrackDisplay&&this._applyCustomSubtitleStyles(),this._config.text.useNativeTextTrack&&!this.isAudio()||this._config.text.useShakaTextTrackDisplay||(0,C.processCues)(window,e,this._textDisplayEl,this._textStyle)}},{key:"_addTextTrackOffOption",value:function(){var e=this._getTextTracks();e&&e.length&&this._tracks.push(new S.PKTextTrack({active:!1,kind:S.PKTextTrack.KIND.SUBTITLES,label:"Off",language:ae}))}},{key:"_setDefaultTracks",value:function(){var e,t=this,r=this.getActiveTracks(),a=this._getTextTracks().find((function(e){return e.default})),i=this.config.playback,s=this._getTextTracks().find((function(e){return S.PKTextTrack.langComparer(ae,e.language)})),o=this._getLanguage(this._getTextTracks(),i.textLanguage,a),l=!this._playbackAttributesState.textLanguage||this.config.disableUserCache?o:this._playbackAttributesState.textLanguage,u=this._getAudioTracks(),c=(e=function(){var e,t,r=J(null!==(e=navigator)&&void 0!==e&&null!==(e=e.languages)&&void 0!==e&&e.length?(0,n.default)(navigator.languages):_.default.language?[_.default.language]:[]);try{var a,i=function(){var e=t.value,r=u.find((function(t){var r;return!(null!==(r=t.language)&&void 0!==r&&r.startsWith("ad-"))&&b.default.langComparer(e,t.language)}));if(r)return{v:r}};for(r.s();!(t=r.n()).done;)if(a=i())return a.v}catch(e){r.e(e)}finally{r.f()}return u.find((function(e){var t;return!(null!==(t=e.language)&&void 0!==t&&t.startsWith("ad-"))}))}(),i.audioLanguage||(null==e?void 0:e.language)||t._getLanguage(t._getAudioTracks(),i.audioLanguage,r.audio));i.captionsDisplay?l===i.textLanguage?this._setDefaultTrack(this._getTextTracks(),l,s,i.additionalTextLanguage):this._setDefaultTrack(this._getTextTracks(),l,s):(this._playbackAttributesState.textLanguage=o,this._setDefaultTrack(this._getTextTracks(),ae,s)),c===i.audioLanguage?this._setDefaultTrack(this._getAudioTracks(),c,r.audio,i.additionalAudioLanguage):this._setDefaultTrack(this._getAudioTracks(),c,r.audio),this._setDefaultVideoTrack()}},{key:"_getLanguage",value:function(e,t,r){var n=t;if(n===ne){var a=e.find((function(e){return b.default.langComparer(_.default.language,e.language)}));r&&r.language!==ae?n=r.language:a?n=a.language:e&&e.length>0&&(n=e[0].language)}return n}},{key:"_setDefaultTrack",value:function(e,t,r,n){var a=this,i=function(e){a.selectTrack(e),a._markActiveTrack(e)},s=e.find((function(e){return b.default.langComparer(t,e.language,n,!0)}));if(s)i(s);else{var o=e.find((function(e){return b.default.langComparer(t,e.language,n,!1)}));o?i(o):r&&!r.active&&this.selectTrack(r)}}},{key:"_setDefaultVideoTrack",value:function(){var e=this,t=this._getVideoTracks().sort((function(e,t){return t.bandwidth-e.bandwidth})),r=t.find((function(t){var r;return t.label&&t.label===(null===(r=e._playbackAttributesState.videoTrack)||void 0===r?void 0:r.label)}));r||(r=t.find((function(t){var r;return t.height&&t.height===(null===(r=e._playbackAttributesState.videoTrack)||void 0===r?void 0:r.height)}))),r&&this.selectTrack(r)}},{key:"_maybeSetTracksLabels",value:function(){var e=this._config.customLabels;if(e)for(var t in e){if(!Object.prototype.hasOwnProperty.call(e,t))return;switch(t){case W.LabelOptions.QUALITIES:this._setTracksCustomLabels(this._getVideoTracks(),e[t]);break;case W.LabelOptions.AUDIO:this._setTracksCustomLabels(this._getAudioTracks(),e[t]);break;case W.LabelOptions.CAPTIONS:this._setTracksCustomLabels(this._getTextTracks(),e[t])}}}},{key:"_setTracksCustomLabels",value:function(e,t){e.forEach((function(e){var r=t(v.Object.copyDeep(e));r&&(e.label=r)}))}},{key:"Event",get:function(){return y.EventType}},{key:"TextStyle",get:function(){return P.default}},{key:"State",get:function(){return x.StateType}},{key:"Track",get:function(){return I.TrackType}},{key:"LogLevelType",get:function(){return k.LogLevelType}},{key:"LogLevel",get:function(){return k.LogLevel}},{key:"AbrMode",get:function(){return D.AbrMode}},{key:"MediaType",get:function(){return M.MediaType}},{key:"StreamType",get:function(){return w.StreamType}},{key:"EngineType",get:function(){return R.EngineType}},{key:"CorsType",get:function(){return O.CorsType}},{key:"AdBreakType",get:function(){return F.AdBreakType}},{key:"AdTagType",get:function(){return V.AdTagType}},{key:"Error",get:function(){return U.default}},{key:"setCachedUrls",value:function(e){this._cachedUrls=e,this._engine&&this._engine.setCachedUrls&&(this._engine.setCachedUrls(e),this._cachedUrls=[])}},{key:"setSeekFrom",value:function(e){this._externalCaptionsHandler.seekFrom=e}},{key:"setClipTo",value:function(e){this._externalCaptionsHandler.clipTo=e}},{key:"clearReset",value:function(){this._reset=!1}}],[{key:"runCapabilities",value:function(){r._logger.debug("Running player capabilities"),j.EngineProvider.getEngines().forEach((function(e){return e.runCapabilities()}))}},{key:"getCapabilities",value:function(e){r._logger.debug("Get player capabilities",e);var t=[];return j.EngineProvider.getEngines().forEach((function(e){return t.push(e.getCapabilities())})),Promise.all(t).then((function(t){var r={};return t.forEach((function(e){return Object.assign(r,e)})),e?r[e]:r}))}},{key:"setCapabilities",value:function(e,t){r._logger.debug("Set player capabilities",e,t);var n=j.EngineProvider.getEngines().find((function(t){return t.id===e}));n&&n.setCapabilities(t)}},{key:"_defaultConfig",get:function(){return v.Object.copyDeep(N.DefaultConfig)}}]),r}(g.FakeEventTarget);(0,d.default)(ie,"_logger",(0,k.default)("Player"))},"./src/state/state-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/event/event-manager.ts"),o=r("./src/state/state.ts"),l=r("./src/state/state-type.ts"),u=r("./src/event/event-type.ts"),c=r("./src/event/fake-event.ts"),d=r("./src/utils/logger.ts"),p=r("./src/utils/env.ts"),h=r("./src/error/error.ts"),f=function(){function e(t){var r,a,c,f,m,g,y=this;(0,n.default)(this,e),(0,i.default)(this,"_transitions",(g={},(0,i.default)(g,l.StateType.IDLE,(r={},(0,i.default)(r,u.Html5EventType.LOAD_START,(function(){return y._updateState(l.StateType.LOADING)})),(0,i.default)(r,u.Html5EventType.PLAY,(function(){return y._updateState(l.StateType.BUFFERING)})),(0,i.default)(r,u.Html5EventType.SEEKED,(function(){return y._updateState(l.StateType.PAUSED)})),r)),(0,i.default)(g,l.StateType.LOADING,(a={},(0,i.default)(a,u.Html5EventType.LOADED_METADATA,(function(){return y._updateState(l.StateType.PAUSED)})),(0,i.default)(a,u.Html5EventType.ERROR,(function(e){return e.payload.severity===h.default.Severity.CRITICAL&&y._updateState(l.StateType.IDLE)})),(0,i.default)(a,u.Html5EventType.SEEKED,(function(){y._prevState&&y._prevState.type===l.StateType.PLAYING&&y._updateState(l.StateType.PLAYING)})),a)),(0,i.default)(g,l.StateType.PAUSED,(c={},(0,i.default)(c,u.Html5EventType.PLAY,(function(){return y._updateState(l.StateType.PLAYING)})),(0,i.default)(c,u.Html5EventType.PLAYING,(function(){return y._updateState(l.StateType.PLAYING)})),(0,i.default)(c,u.Html5EventType.ENDED,(function(){return y._updateState(l.StateType.IDLE)})),c)),(0,i.default)(g,l.StateType.PLAYING,(f={},(0,i.default)(f,u.Html5EventType.PAUSE,(function(){return y._updateState(l.StateType.PAUSED)})),(0,i.default)(f,u.Html5EventType.WAITING,(function(){y._player.seeking?y._updateState(l.StateType.LOADING):(y._updateState(l.StateType.BUFFERING),y._lastWaitingTime=y._player.currentTime)})),(0,i.default)(f,u.Html5EventType.ENDED,(function(){return y._updateState(l.StateType.IDLE)})),(0,i.default)(f,u.Html5EventType.ERROR,(function(e){return e.payload.severity===h.default.Severity.CRITICAL&&y._updateState(l.StateType.IDLE)})),f)),(0,i.default)(g,l.StateType.BUFFERING,(m={},(0,i.default)(m,u.Html5EventType.PLAYING,(function(){return y._updateState(l.StateType.PLAYING)})),(0,i.default)(m,u.Html5EventType.PAUSE,(function(){return y._updateState(l.StateType.PAUSED)})),(0,i.default)(m,u.Html5EventType.TIME_UPDATE,(function(){"IE"===p.default.browser.name&&y._player.currentTime!==y._lastWaitingTime&&y._prevState&&y._prevState.type===l.StateType.PLAYING&&(y._lastWaitingTime=null,y._updateState(l.StateType.PLAYING))})),m)),g)),this._player=t,this._logger=(0,d.default)("StateManager"),this._eventManager=new s.EventManager,this._history=[],this._prevState=null,this._curState=new o.default(l.StateType.IDLE),this._attachListeners()}return(0,a.default)(e,[{key:"_attachListeners",value:function(){this._eventManager.listen(this._player,u.Html5EventType.ERROR,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.ENDED,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.PLAY,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.LOAD_START,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.PLAYING,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.LOADED_METADATA,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.PAUSE,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.WAITING,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.SEEKED,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.TIME_UPDATE,this._doTransition.bind(this))}},{key:"_doTransition",value:function(e){(e.type!==u.Html5EventType.TIME_UPDATE||this._curState===l.StateType.BUFFERING&&e.type===u.Html5EventType.TIME_UPDATE)&&this._logger.debug("Do transition request",e.type);var t=this._transitions[this._curState.type];"function"==typeof t[e.type]&&t[e.type](e)}},{key:"_updateState",value:function(e){this._curState.type!==e&&(this._curState.duration=Date.now()/1e3,this._history.push(this._curState),this._prevState=this._curState,this._curState=new o.default(e),this._logger.debug("Switch player state: from ".concat(this._prevState.type," to ").concat(this._curState.type)),this._dispatchEvent())}},{key:"_dispatchEvent",value:function(){var e=new c.FakeEvent(u.CustomEventType.PLAYER_STATE_CHANGED,{oldState:this._prevState,newState:this._curState});this._player.dispatchEvent(e)}},{key:"destroy",value:function(){this._history=[],this._eventManager.destroy()}},{key:"reset",value:function(){this._history=[]}},{key:"currentState",get:function(){return this._curState}},{key:"previousState",get:function(){return this._prevState}},{key:"history",get:function(){return this._history}}]),e}()},"./src/state/state-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{StateType:function(){return n}});var n={IDLE:"idle",LOADING:"loading",PLAYING:"playing",PAUSED:"paused",BUFFERING:"buffering"}},"./src/state/state.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t){(0,n.default)(this,e),this.type=t,this._duration=0,this._timestamp=Date.now()/1e3}return(0,a.default)(e,[{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e-this._timestamp}}]),e}()},"./src/thumbnail/external-thumbnails-handler.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ExternalThumbnailsHandler:function(){return R}});var n=r("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),i=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),u=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),c=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),p=r("./node_modules/@babel/runtime/regenerator/index.js"),h=r.n(p),f=r("./src/event/event-manager.ts"),m=r("./src/event/fake-event-target.ts"),g=r("./src/utils/logger.ts"),y=r("./src/track/text-track-display.ts"),v=r("./src/utils/util.ts"),_=r("./src/thumbnail/thumbnail-info.ts"),k=r("./src/error/error.ts"),E=r("./src/event/fake-event.ts"),b=r("./src/event/event-type.ts");function T(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,d.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.default)(e);if(t){var a=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}var x=/#wh=/i,I=/#xywh=/i,w=new RegExp("^/[^/].+"),R=function(e){(0,l.default)(g,e);var t,r,u,c,p,m=C(g);function g(){var e;return(0,i.default)(this,g),e=m.call(this),(0,d.default)((0,o.default)(e),"_cues",[]),e._eventManager=new f.EventManager,e}return(0,s.default)(g,[{key:"load",value:(p=(0,a.default)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return g._logger.debug("start loading the vtt thumbnails"),e.next=5,this._downloadAndParseCues(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getThumbnail",value:function(e){var t=this._findCue(e,this._cues);if(t){var r=t.imgUrl,n=t.size,a=t.coordinates;a=a||{x:0,y:0};var i=P(P({url:r},n=n||this._naturalImgSize),a);return new _.ThumbnailInfo(i)}return null}},{key:"isUsingVttThumbnails",value:function(){var e;return!(null===(e=this._cues)||void 0===e||!e.length)}},{key:"_downloadAndParseCues",value:(c=(0,a.default)(h().mark((function e(t){var r,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._downloadVttFile(t);case 3:return r=e.sent,e.next=6,this._processVtt(r);case 6:return n=e.sent,e.next=9,this._formatIntoThumbnailCues(n,t);case 9:this._cues=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.dispatchEvent(new E.FakeEvent(b.Html5EventType.ERROR,e.t0));case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return c.apply(this,arguments)})},{key:"_downloadVttFile",value:(u=(0,a.default)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.Http.execute(t.vttUrl,{},"GET");case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),new k.default(k.default.Severity.RECOVERABLE,k.default.Category.TEXT,k.default.Code.HTTP_ERROR,e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e){return u.apply(this,arguments)})},{key:"_processVtt",value:(r=(0,a.default)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new y.Parser(window,(0,y.StringDecoder)()),a=[];n.oncue=function(e){a.push(e)},n.onflush=function(){g._logger.debug("finished parsing thumbnails cues"),e(a)},n.parse(t),n.flush(),n.onparsingerror((function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"_formatIntoThumbnailCues",value:(t=(0,a.default)(h().mark((function e(t,r){var n,a,i,s,o,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validateThumbnailsVTTFormat(t)){e.next=4;break}throw new k.default(k.default.Severity.RECOVERABLE,k.default.Category.TEXT,k.default.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"invalid thumbnail vtt format",vttUrl:r.vttUrl});case 4:return n=this._extractCueMetadata(t[0],r),e.next=7,this.validateImgUrl(n.imgUrl);case 7:if(e.sent){e.next=11;break}throw new k.default(k.default.Severity.RECOVERABLE,k.default.Category.TEXT,k.default.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"failed loading the image - invalid image url",imgUrl:n.imgUrl});case 11:return e.next=13,this.extractImgNaturalDimensions(n.imgUrl);case 13:this._naturalImgSize=e.sent,a=[],i=T(t);try{for(i.s();!(s=i.n()).done;)o=s.value,l=this._extractCueMetadata(o,r),a.push(l)}catch(e){i.e(e)}finally{i.f()}return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"validateThumbnailsVTTFormat",value:function(e){return e.length&&e[0]instanceof VTTCue}},{key:"extractImgNaturalDimensions",value:function(e){var t=this;return new Promise((function(r){var n=new Image;n.src=e,t._eventManager.listenOnce(n,"load",(function(){r({height:n.naturalHeight,width:n.naturalWidth})})),t._eventManager.listenOnce(n,"error",(function(){return r(null)}))}))}},{key:"validateImgUrl",value:function(e){var t=this;return new Promise((function(r){var n=new Image;n.src=e,t._eventManager.listenOnce(n,"load",(function(){r(!0)})),t._eventManager.listenOnce(n,"error",(function(){return r(!1)}))}))}},{key:"_extractCueMetadata",value:function(e,t){var r,a=e.startTime,i=e.endTime,s=e.text,o=t.vttUrl.substring(0,t.vttUrl.lastIndexOf("/")),l=x.test(s),u=I.test(s),c=!1,d=null,p=null;if(l){var h=s.split(x);r=(0,n.default)(h,1)[0],g._logger.warn('vtt thumbnails in "'.concat(x,'" form - is supported but the width and height options are ignored and The images will be displayed in their natural dimensions')),c=void 0!==r}else if(u){var f=s.split(I),m=(0,n.default)(f,2);r=m[0];var y=m[1].split(",").map(Number),v=(0,n.default)(y,4),_=v[0],E=v[1],b=v[2],T=v[3];d={x:_,y:E},p={width:b,height:T},c=[_,E,b,T,r].every((function(e){return void 0!==e}))}else r=s,c=!!s;if(0!==r.indexOf("http://")&&0!==r.indexOf("https://")&&(r=w.test(r)?r.substring(1):r,r="".concat(o,"/").concat(r)),c)return{startTime:a,endTime:i,imgUrl:r,size:p,coordinates:d};throw new k.default(k.default.Severity.RECOVERABLE,k.default.Category.TEXT,k.default.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"error while parsing the vtt cues - invalid cue",parsedCue:{startTime:a,endTime:i,options:s}})}},{key:"_findCue",value:function(e,t){for(var r=0,n=t.length-1;r<=n;){var a=Math.floor((r+n)/2),i=t[a];if(e>=i.startTime&&e<i.endTime)return t[a];e<i.startTime?n=a-1:r=a+1}return null}},{key:"reset",value:function(){this._cues=[],this._eventManager.removeAll(),this._naturalImgSize={}}},{key:"destroy",value:function(){this.reset(),this._eventManager.destroy()}}]),g}(m.FakeEventTarget);(0,d.default)(R,"_logger",(0,g.default)("ExternalThumbnailsHandler"))},"./src/thumbnail/thumbnail-info.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ThumbnailInfo:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t){(0,n.default)(this,e);var r=t.url,a=t.width,i=t.height,s=t.x,o=t.y;this._url=r,this._width=a,this._height=i,this._x=s,this._y=o}return(0,a.default)(e,[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}]),e}()},"./src/track/abr-mode-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AbrMode:function(){return n}});var n={MANUAL:"manual",AUTO:"auto"}},"./src/track/audio-track.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioTrackKind:function(){return d},audioDescriptionTrackHandler:function(){return h}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./src/track/track.ts");function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var c=function(e){return e.AUDIO_ONLY="audio_only",e.AUDIO_DESCRIPTION="audio_description",e}(c||{}),d=function(e){return e.MAIN="main",e.DESCRIPTION="description",e}({}),p=function(e){(0,i.default)(r,e);var t=u(r);function r(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.default)(this,r),(e=t.call(this,a))._kind=a.kind||d.MAIN,e}return(0,a.default)(r,[{key:"kind",get:function(){return this._kind},set:function(e){this._kind=e}}]),r}(l.default);function h(e,t){if(null!=e&&e.length){var r=t&&t.length>0,n=0;e.forEach((function(e){var a,i;e instanceof p&&((r&&(null===(a=t[n])||void 0===a||null===(a=a.tags)||void 0===a?void 0:a.includes(c.AUDIO_DESCRIPTION))||e.kind.includes(d.DESCRIPTION))&&(e.language="ad-".concat(e.language),!r||null!==(i=t[n])&&void 0!==i&&i.label||(e.label="".concat(e.label," - Audio Description"))),n++)}))}}t.default=p},"./src/track/external-captions-handler.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ExternalCaptionsHandler:function(){return P}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=r("./src/error/error.ts"),d=r("./src/utils/util.ts"),p=r("./src/track/text-track-display.ts"),h=r("./src/track/text-track.ts"),f=r("./src/track/track.ts"),m=r("./src/event/event-type.ts"),g=r("./src/event/fake-event.ts"),y=r("./src/utils/logger.ts"),v=r("./src/event/event-manager.ts"),_=r("./src/event/fake-event-target.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var E=1,b=2,T=3,A="srt",S="vtt",P=function(e){(0,s.default)(r,e);var t=k(r);function r(e){var a;return(0,n.default)(this,r),a=t.call(this),(0,u.default)((0,i.default)(a),"_externalCueIndex",0),(0,u.default)((0,i.default)(a),"_textTrackModel",{}),(0,u.default)((0,i.default)(a),"_activeTextCues",[]),(0,u.default)((0,i.default)(a),"_isTextTrackActive",!1),(0,u.default)((0,i.default)(a),"_lastTimeUpdate",0),(0,u.default)((0,i.default)(a),"_seekFrom",-1),(0,u.default)((0,i.default)(a),"_clipTo",-1),a._player=e,a._eventManager=new v.EventManager,a}return(0,a.default)(r,[{key:"hideTextTrack",value:function(){this._player.config.text.useNativeTextTrack?(this._removeCueChangeListeners(),this._resetExternalNativeTextTrack()):this._isTextTrackActive&&(this._eventManager.unlisten(this._player,m.Html5EventType.TIME_UPDATE),this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_CUE_CHANGED,{cues:[]})),this._resetCurrentTrack())}},{key:"getExternalTracks",value:function(e){var t=this,r=this._player.sources.captions;if(!r)return[];this._player.config.text.useNativeTextTrack&&this._addNativeTextTrack();var n=e.filter((function(e){return e instanceof h.default})),a=[];return r.forEach((function(e){if(e.language){var r=t._createTextTrack(e);t._maybeAddTrack(r,e,n,a)}else{var i=new c.default(c.default.Severity.RECOVERABLE,c.default.Category.TEXT,c.default.Code.UNKNOWN_LANGUAGE,{caption:e});t.dispatchEvent(new g.FakeEvent(m.Html5EventType.ERROR,i))}})),a}},{key:"_maybeAddTrack",value:function(e,t,n,a){var i=n.find((function(e){return e.available&&f.default.langComparer(t.language,e.language)}));i?r._logger.warn("duplicated language, taking the inband option. Language: ",i.language):(a.push(e),this._updateTextTracksModel(t))}},{key:"_createTextTrack",value:function(e){return new h.default({active:!!e.default,kind:h.default.KIND.SUBTITLES,label:e.label,language:e.language,external:!0})}},{key:"_updateTextTracksModel",value:function(e){this._textTrackModel[e.language]={cuesStatus:E,cues:[],url:e.url,type:e.type}}},{key:"selectTextTrack",value:function(e){var t=this;this._textTrackModel[e.language]&&(this._textTrackModel[e.language].cuesStatus===T?this._selectTextTrack(e):this._textTrackModel[e.language].cuesStatus===E&&this._downloadAndParseCues(e).then((function(){t._textTrackModel[e.language].cuesStatus=T,t._selectTextTrack(e)})).catch((function(e){return t.dispatchEvent(new g.FakeEvent(m.Html5EventType.ERROR,e))})))}},{key:"_selectTextTrack",value:function(e){this.hideTextTrack(),this._player.config.text.useNativeTextTrack?(this._addCuesToNativeTextTrack(this._textTrackModel[e.language].cues),this._addCueChangeListener()):this._setTextTrack(e),e.active=!0,this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_TRACK_CHANGED,{selectedTextTrack:e}))}},{key:"resetAllCues",value:function(){for(var e in this._textTrackModel)this._textTrackModel[e].cues.forEach((function(e){e.hasBeenReset=!0}))}},{key:"_addCueChangeListener",value:function(){var e=this,t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return h.default.isNativeTextTrack(e)&&e.mode===h.default.MODE.SHOWING}));r&&this._eventManager.listen(r,"cuechange",(function(t){return e._onCueChange(t)}))}}},{key:"_removeCueChangeListeners",value:function(){var e=this._player.getVideoElement();if(e&&e.textTracks)for(var t=0;t<e.textTracks.length;t++)this._eventManager.unlisten(e.textTracks[t],"cuechange")}},{key:"_onCueChange",value:function(e){var t=e.currentTarget.activeCues,r=(0,h.getActiveCues)(t);this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_CUE_CHANGED,{cues:r}))}},{key:"reset",value:function(){this._seekFrom=-1,this._clipTo=-1,this._resetCurrentTrack(),this._textTrackModel={},this._resetExternalNativeTextTrack(),this._eventManager.removeAll()}},{key:"destroy",value:function(){this._textTrackModel={},this._eventManager.destroy(),this._activeTextCues=[]}},{key:"_resetCurrentTrack",value:function(){this._activeTextCues=[],this._isTextTrackActive=!1,this._maybeSetExternalCueIndex()}},{key:"_getCuesString",value:function(e){var t=this;return new Promise((function(r,n){var a=t._textTrackModel[e.language],i=a.type||t._getFileType(a.url);[A,S].includes(i)||(t._textTrackModel[e.language].cuesStatus=E,n(new c.default(c.default.Severity.RECOVERABLE,c.default.Category.TEXT,c.default.Code.UNKNOWN_FILE_TYPE,{captionType:i}))),d.Http.execute(a.url,{},"GET").then((function(e){r(i===A?t._convertSrtToVtt(e):e)})).catch((function(){t._textTrackModel[e.language].cuesStatus=E,n(new c.default(c.default.Severity.RECOVERABLE,c.default.Category.TEXT,c.default.Code.HTTP_ERROR,{url:a.url}))}))}))}},{key:"_parseCues",value:function(e){return new Promise((function(t,n){var a=new p.Parser(window,(0,p.StringDecoder)()),i=[];a.oncue=function(e){i.push(e)},a.onflush=function(){r._logger.debug("finished parsing external cues"),t(i)},a.parse(e),a.flush(),a.onparsingerror((function(e){return n(e)}))}))}},{key:"_convertSrtToVtt",value:function(e){var t=e.replace(/(\d\d:\d\d:\d\d),(\d\d\d) --> (\d\d:\d\d:\d\d),(\d\d\d)/g,(function(e,t,r,n,a){return"".concat(t,".").concat(r," --\x3e ").concat(n,".").concat(a)}));return"WEBVTT\n\n".concat(t)}},{key:"_downloadAndParseCues",value:function(e){var t=this;return this._textTrackModel[e.language].cuesStatus=b,new Promise((function(r,n){t._getCuesString(e).then((function(e){return t._parseCues(e)})).then((function(e){return t._filterAndShiftCues(e)})).then((function(n){t._textTrackModel[e.language].cues=n,r()})).catch((function(e){return n(e)}))}))}},{key:"_getFileType",value:function(e){return e.split(/[#?]/)[0].split(".").pop().trim()}},{key:"_handleCaptionOnTimeUpdate",value:function(e){var t=this._player.currentTime;if(t){var r=!1;this._hadSeeked()&&(this._activeTextCues=[],r=this._maybeSetExternalCueIndex());var n=this._maybeRemoveActiveCues(),a=this._maybeAddToActiveCues(e);(r||a||n)&&this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._lastTimeUpdate=t}}},{key:"_hadSeeked",value:function(){return!!this._player.currentTime&&Math.abs(this._player.currentTime-this._lastTimeUpdate)>1}},{key:"_maybeRemoveActiveCues",value:function(){var e=this._player.currentTime;if(!e)return!1;var t=this._activeTextCues.filter((function(t){return t.startTime<e&&e<t.endTime})),r=this._activeTextCues.length!==t.length;return this._activeTextCues=t,r}},{key:"_maybeAddToActiveCues",value:function(e){var t=this._player.currentTime;if(!t)return!1;for(var r=!1,n=this._textTrackModel[e.language].cues;this._externalCueIndex<n.length&&t>n[this._externalCueIndex].startTime;)t<n[this._externalCueIndex].endTime&&this._activeTextCues.push(n[this._externalCueIndex]),this._externalCueIndex++,r=!0;return r}},{key:"_maybeSetExternalCueIndex",value:function(){var e,t=null===(e=this._player._getTextTracks())||void 0===e?void 0:e.find((function(e){return e.active&&e.external}));if(t&&t.external){for(var r=this._textTrackModel[t.language]?this._textTrackModel[t.language].cues:[],n=0;n<r.length&&!(r[n].startTime<this._player.currentTime&&this._player.currentTime<r[n].endTime)&&!(r[n].endTime>this._player.currentTime&&r[n].startTime>this._player.currentTime);n++);return this._externalCueIndex=n,!0}return!1}},{key:"_resetExternalNativeTextTrack",value:function(){var e=this._player.getVideoElement();if(e&&e.textTracks){var t=Array.from(e.textTracks).find((function(e){return!!e&&h.default.isExternalTrack(e)}));t&&(t.cues&&Object.values(t.cues).forEach((function(e){return t.removeCue(e)})),t.mode=h.default.MODE.DISABLED)}}},{key:"_addCuesToNativeTextTrack",value:function(e){var t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return!!e&&h.default.isExternalTrack(e)}));r&&(r.mode=h.default.MODE.SHOWING,void 0===VTTCue?this._convertCues(e).forEach((function(e){return r.addCue(e)})):e.forEach((function(e){return r.addCue(e)})))}}},{key:"_convertCues",value:function(e){return e.map((function(e){return new TextTrackCue(e.startTime,e.endTime,e.text)}))}},{key:"_addNativeTextTrack",value:function(){var e=this._player.getVideoElement();e&&e.textTracks&&(Array.from(e.textTracks).findIndex((function(e){return!!e&&h.default.isExternalTrack(e)}))>-1?this._resetExternalNativeTextTrack():e.addTextTrack(h.default.KIND.SUBTITLES,h.default.EXTERNAL_TRACK_ID,h.default.EXTERNAL_TRACK_ID))}},{key:"_setTextTrack",value:function(e){var t=this;this._player.config.text.useNativeTextTrack||(this._isTextTrackActive=!0,r._logger.debug("External text track changed",e),this._activeTextCues=[],this._externalCueIndex=0,this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._eventManager.listen(this._player,m.Html5EventType.TIME_UPDATE,(function(){return t._handleCaptionOnTimeUpdate(e)})))}},{key:"_filterCuePointsOutOfVideoRange",value:function(e,t,r){return e.filter((function(e){return e.startTime>=t&&(!r||e.startTime<r)}))}},{key:"seekFrom",set:function(e){this._seekFrom=e}},{key:"clipTo",set:function(e){this._clipTo=e}},{key:"_filterAndShiftCues",value:function(e){if(!e||!e.length)return[];if(-1===this._seekFrom&&-1===this._clipTo)return e;var t=-1===this._seekFrom?0:this._seekFrom,r=-1===this._clipTo?void 0:this._clipTo,n=this._filterCuePointsOutOfVideoRange(e,t,r);return n.forEach((function(e){e.startTime=e.startTime-t,e.endTime=e.endTime-t})),n}}],[{key:"applyNativeTextTrackStyles",value:function(e,t,r,n){e.insertRule("#".concat(r," video.").concat(n,"::-webkit-media-text-track-display { text-align: ").concat(t.textAlign,"!important; }"),0),e.insertRule("#".concat(r," video.").concat(n,"::cue { ").concat(t.toCSS()," }"),0)}}]),r}(_.FakeEventTarget);(0,u.default)(P,"_logger",(0,y.default)("ExternalCaptionsHandler"))},"./src/track/image-track.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var u=function(e){(0,i.default)(r,e);var t=l(r);function r(e){var a;(0,n.default)(this,r),a=t.call(this,e);var i=e.url,s=e.width,o=e.height,l=e.duration,u=e.rows,c=e.cols,d=e.customData;return a._url=i,a._width=s,a._height=o,a._duration=l,a._customData=d,a._rows=u||1,a._cols=c||1,a}return(0,a.default)(r,[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"duration",get:function(){return this._duration}},{key:"rows",get:function(){return this._rows}},{key:"cols",get:function(){return this._cols}},{key:"customData",get:function(){return this._customData}},{key:"sliceWidth",get:function(){return this._width/this._cols}},{key:"sliceHeight",get:function(){return this._height/this._rows}}]),r}(r("./src/track/track.ts").default);t.default=u},"./src/track/label-options.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{LabelOptions:function(){return n}});var n={AUDIO:"audio",CAPTIONS:"captions",QUALITIES:"qualities"}},"./src/track/text-style.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=function(){function e(){(0,n.default)(this,e),(0,i.default)(this,"_fontSizeIndex",2),(0,i.default)(this,"textAlign",e.FontAlignment[0].value),(0,i.default)(this,"fontFamily",e.FontFamily.SANS_SERIF),(0,i.default)(this,"fontColor",e.StandardColors.WHITE),(0,i.default)(this,"fontOpacity",e.StandardOpacities.OPAQUE),(0,i.default)(this,"backgroundColor",e.StandardColors.BLACK),(0,i.default)(this,"backgroundOpacity",e.StandardOpacities.OPAQUE),(0,i.default)(this,"fontEdge",e.EdgeStyles.NONE)}return(0,a.default)(e,[{key:"fontSize",get:function(){return e.FontSizes[this._fontSizeIndex].label},set:function(t){var r=e.FontSizes.findIndex((function(e){return e.label===t}));-1!==r&&(this._fontSizeIndex=r)}},{key:"fontScale",get:function(){return e.FontSizes[this._fontSizeIndex].value},set:function(t){var r=e.FontSizes.findIndex((function(e){return e.value===t}));-1!==r&&(this._fontSizeIndex=r)}},{key:"getTextShadow",value:function(){for(var t=[],r=0;r<this.fontEdge.length;r++){var n=this.fontEdge[r].slice(0,3),a=this.fontEdge[r].slice(3,6);t.push(e.toRGBA(n,this.fontOpacity)+" "+a.join("px ")+"px")}return t.join(",")}},{key:"toCSS",value:function(){var t=[];return t.push("text-align: "+this.textAlign),t.push("font-family: "+this.fontFamily),t.push("color: "+e.toRGBA(this.fontColor,this.fontOpacity)),t.push("background: linear-gradient(0deg, ".concat(e.toRGBA(this.backgroundColor,this.backgroundOpacity),", ").concat(e.toRGBA(this.backgroundColor,this.backgroundOpacity),")")),t.push("font-size: "+this.fontSize),t.push("text-shadow: "+this.getTextShadow()),t.join("!important; ")}},{key:"clone",value:function(){return e.fromJson(e.toJson(this))}},{key:"isEqual",value:function(t){return!!t&&JSON.stringify(e.toJson(this))===JSON.stringify(e.toJson(t))}},{key:"implicitFontScale",get:function(){return.25*e.FontSizes[this._fontSizeIndex].value+1}}],[{key:"toRGBA",value:function(e,t){return"rgba("+e.concat(t).join(",")+")"}},{key:"fromJson",value:function(t){var r=function(e,t){return null!=e?e:t},n=new e;return n.fontEdge=r(t.fontEdge,n.fontEdge),n.fontSize=r(t.fontSize,n.fontSize),n.textAlign=r(t.textAlign,n.textAlign),n.fontScale=r(t.fontScale,n.fontScale),n.fontColor=r(t.fontColor,n.fontColor),n.fontOpacity=r(t.fontOpacity,n.fontOpacity),n.backgroundColor=r(t.backgroundColor,n.backgroundColor),n.backgroundOpacity=r(t.backgroundOpacity,n.backgroundOpacity),n.fontFamily=r(t.fontFamily,n.fontFamily),n}},{key:"toJson",value:function(e){return{fontEdge:e.fontEdge,fontSize:e.fontSize,textAlign:e.textAlign,fontScale:e.fontScale,fontColor:e.fontColor,fontOpacity:e.fontOpacity,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity,fontFamily:e.fontFamily}}}]),e}();(0,i.default)(s,"FontFamily",{ARIAL:"Arial",HELVETICA:"Helvetica",VERDANA:"Verdana",SANS_SERIF:"sans-serif",ROBOTO:'Roboto, "Open Sans", Arial, sans-serif',OPEN_DYSLEXIC:'"OpenDyslexic", Lexend, sans-serif',COMIC:'"Comic Sans MS", "Century Gothic", Arial, sans-serif',SEGOE:'"Segoe UI", "SF Pro Text", Helvetica, sans-serif',COURIER:'Courier, "Lucida Console", Verdana, monospace'}),(0,i.default)(s,"StandardColors",{WHITE:[255,255,255],BLACK:[0,0,0],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255],DARK_BLUE:[0,51,102],LIGHT_YELLOW:[255,255,204],LIGHT_GRAY:[204,204,204]}),(0,i.default)(s,"StandardOpacities",{OPAQUE:1,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0}),(0,i.default)(s,"EdgeStyles",{NONE:[],RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]}),(0,i.default)(s,"FontSizes",[{value:-2,label:"50%"},{value:-1,label:"75%"},{value:0,label:"100%"},{value:2,label:"200%"},{value:3,label:"300%"},{value:4,label:"400%"}]),(0,i.default)(s,"FontAlignment",[{label:"Default",value:"default"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]),t.default=s},"./src/track/text-track-display.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Parser:function(){return M},StringDecoder:function(){return D},convertCueToDOMTree:function(){return x},processCues:function(){return R}});var n=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),i=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),s=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),o=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),l=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),u=r("./src/track/vtt-region.ts"),c=r("./src/track/text-style.ts"),d=r("./src/track/text-track.ts");function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var a=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,i.default)(this,r)}}var h=1;function f(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+(0|n)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}var m={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""},g={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},y={v:"title",lang:"lang"},v={rt:"ruby"};function _(){this.values=O(null)}function k(e,t,r,n){var a=n?e.split(n):[e];for(var i in a)if("string"==typeof a[i]){var s=a[i].split(r);2===s.length&&t(s[0],s[1])}}function E(e,t,r){var n=e;function a(){var t=f(e);if(null===t)throw new L(L.Errors.BadTimeStamp,"Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){e=e.replace(/^\s+/,"")}if(i(),t.startTime=a(),i(),"--\x3e"!==e.substr(0,3))throw new L(L.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),i(),t.endTime=a(),i(),function(e,t){var n=new _;k(e,(function(e,t){switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){n.set(e,r[a].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),s=i[0];n.integer(e,s),n.percent(e,s)&&n.set("snapToLines",!1),n.alt(e,s,["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start","center","end"]);break;case"position":i=t.split(","),n.percent(e,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start","center","end"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical",""),t.line=n.get("line",t.line||"auto"),t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100);try{t.align=n.get("align","center")}catch(e){t.align=n.get("align","middle")}t.position=n.get("position",t.position||"auto"),t.positionAlign=n.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}function b(e,t){function r(){if(!t)return null;var e,r=t.match(/^([^<]*)(<[^>]+>?)?/);return e=r[1]?r[1]:r[2],t=t.substr(e.length),e}function n(e){return m[e]}function a(e){for(var t;t=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(t[0],n);return e}function i(e,t){return!v[t.localName]||v[t.localName]===e.localName}function s(t,r){var n=g[t];if(!n)return null;var a=e.document.createElement(n),i=y[t];return i&&r&&(a[i]=r.trim()),a}for(var o,l=e.document.createElement("div"),u=l,c=[];null!==(o=r());)if("<"!==o[0])u.appendChild(e.document.createTextNode(a(o)));else{if("/"===o[1]){c.length&&c[c.length-1]===o.substr(2).replace(">","")&&(c.pop(),u=u.parentNode);continue}var d=f(o.substr(1,o.length-2)),p=void 0;if(d){p=e.document.createProcessingInstruction("timestamp",d),u.appendChild(p);continue}var h=o.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!h)continue;if(!(p=s(h[1],h[3])))continue;if(!i(u,p))continue;h[2]&&(p.className=h[2].substr(1).replace("."," ")),c.push(h[1]),u.appendChild(p),u=p}return l}_.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var T=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function A(e){for(var t=0;t<T.length;t++){var r=T[t];if(e>=r[0]&&e<=r[1])return!0}return!1}var S=function(e){(0,a.default)(r,e);var t=p(r);function r(e,n,a){var i;(0,o.default)(this,r),i=t.call(this);var s="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent);"undefined"!=typeof WebVTTSet&&(WebVTTSet.fontSet,WebVTTSet.backgroundSet,WebVTTSet.edgeSet),i.cue=n,i.cueDiv=b(e,n.text);var l={color:a.color,backgroundColor:a.backgroundColor,textShadow:a.textShadow,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};s||(l.writingMode=""===n.vertical?"horizontal-tb":"lr"===n.vertical?"vertical-lr":"vertical-rl",l.unicodeBidi="plaintext"),i.applyStyles(l,i.cueDiv);var u="default"===a.textAlign;i.div=e.document.createElement("div");var c="middle"===n.align?"center":n.align;u||(c=a.textAlign),l={textAlign:c,font:a.font,whiteSpace:"pre-line",position:"absolute"},s||(l.direction=function(e){var t=[],r="";if(!e||!e.childNodes)return"ltr";function n(e,t){for(var r=t.childNodes.length-1;r>=0;r--)e.push(t.childNodes[r])}function a(e){if(!e||!e.length)return null;var t=e.pop(),r=t.textContent||t.innerText;if(r){var i=r.match(/^.*(\n|\r)/);return i?(e.length=0,i[0]):r}return"ruby"===t.tagName?a(e):t.childNodes?(n(e,t),a(e)):void 0}for(n(t,e);r=a(t);)for(var i=0;i<r.length;i++)if(A(r.charCodeAt(i)))return"rtl";return"ltr"}(i.cueDiv),l.writingMode=""===n.vertical?"horizontal-tb":"lr"===n.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),i.applyStyles(l),i.div.appendChild(i.cueDiv);var d=0,p=n.positionAlign||n.align;if(u)switch(p){case"start":case"left":case"line-left":d=n.position;break;case"center":d=n.position-n.size/2;break;case"end":case"right":case"line-right":d=n.position-n.size}return""===n.vertical?i.applyStyles({left:i.formatStyle(d,"%"),width:i.formatStyle(Math.min(n.size,100-d)||n.size,"%")}):i.applyStyles({top:i.formatStyle(d,"%"),height:i.formatStyle(Math.min(n.size,100-d)||n.size,"%")}),i.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})},i}return(0,l.default)(r)}(function(){function e(){(0,o.default)(this,e)}return(0,l.default)(e,[{key:"applyStyles",value:function(e,t){for(var r in t=t||this.div,e)e.hasOwnProperty(r)&&(t.style[r]=e[r])}},{key:"formatStyle",value:function(e,t){return 0===e?0:e+t}}]),e}()),P=function(){function e(t){var r,a,i,s,l;(0,o.default)(this,e),(0,n.default)(this,"overlaps",(function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top})),t.div&&(a=t.div.offsetHeight,i=t.div.offsetWidth,s=t.div.offsetTop,l=(l=t.div.childNodes)&&(l=l[0])&&l.getClientRects&&l.getClientRects(),t=t.div.getBoundingClientRect(),r=l?Math.max(l[0]&&l[0].height||0,t.height/l.length):0),this.left=t.left,this.right=t.right,this.top=t.top||s,this.height=t.height||a,this.bottom=t.bottom||s+(t.height||a),this.width=t.width||i,this.lineHeight=r||t.lineHeight||13}return(0,l.default)(e,[{key:"move",value:function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}}},{key:"overlapsAny",value:function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1}},{key:"within",value:function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right}},{key:"overlapsOppositeAxis",value:function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}}},{key:"intersectPercentage",value:function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)}},{key:"toCSSCompatValues",value:function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}}}],[{key:"getSimpleBoxPosition",value:function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,r=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,n=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||n,height:e.height||t,bottom:e.bottom||n+(e.height||t),width:e.width||r}}}]),e}();function C(e,t,r,n){var a=new P(t),i=t.cue,s=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,r=t.textTrackList,n=0,a=0;a<r.length&&r[a]!==t;a++)r[a].mode===d.default.MODE.SHOWING&&n++;return-1*++n}(i),o=[];if(i.snapToLines){var l;switch(i.vertical){case"":o=["+y","-y"],l="height";break;case"rl":o=["+x","-x"],l="width";break;case"lr":o=["-x","+x"],l="width"}var u=a.lineHeight,c=u*Math.round(s),p=r[l]+u,h=o[0];Math.abs(c)>p&&(c=c<0?-1:1,c*=Math.ceil(p/u)*u),s<0&&(c+=""===i.vertical?r.height:r.width,o=o.reverse()),a.move(h,c)}else{var f=a.lineHeight/r.height*100;switch(i.lineAlign){case"center":s-=f/2;break;case"end":s-=f}switch(i.vertical){case"":t.applyStyles({top:t.formatStyle(s,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(s,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(s,"%")})}o=["+y","-x","+x","-y"],a=new P(t)}var m=function(e,t){for(var a,i=new P(e),s=1,o=0;o<t.length;o++){for(;e.overlapsOppositeAxis(r,t[o])||e.within(r)&&e.overlapsAny(n);)e.move(t[o]);if(e.within(r))return e;var l=e.intersectPercentage(r);s>l&&(a=new P(e),s=l),e=new P(i)}return a||i}(a,o);t.move(m.toCSSCompatValues(r))}function x(e,t){return e&&t?b(e,t):null}var I=.058,w="1.5%";function R(e,t,r,n){if(!e||!t||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var a=e.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin=w,r.appendChild(a),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var i=[],s=P.getSimpleBoxPosition(a),o=s.height<s.width?s.height:s.width,l={font:Math.round(o*I*100)/100*h*n.implicitFontScale+"px "+n.fontFamily,textAlign:n.textAlign,color:c.default.toRGBA(n.fontColor,n.fontOpacity),backgroundColor:c.default.toRGBA(n.backgroundColor,n.backgroundOpacity),textShadow:n.getTextShadow()};!function(){for(var r,n,o=0;o<t.length;o++)n=t[o],r=new S(e,n,l),a.appendChild(r.div),C(0,r,s,i),n.displayState=r.div,i.push(P.getSimpleBoxPosition(r))}()}else for(var u=0;u<t.length;u++)a.appendChild(t[u].displayState)}var M=function(e,t){this.window=e,this.state="INITIAL",this.buffer="",this.decoder=t||new TextDecoder("utf8"),this.regionList=[]},D=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},O=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function L(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}L.prototype=O(Error.prototype),L.prototype.constructor=L,L.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},M.prototype={reportOrThrowError:function(e){if(!(e instanceof L))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function r(){for(var e=t.buffer,r=0;r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),n}function n(e){k(e,(function(e,r){"Region"===e&&function(e){var r=new _;if(k(e,(function(e,t){switch(e){case"id":r.set(e,t);break;case"width":r.percent(e,t);break;case"lines":r.integer(e,t);break;case"regionanchor":case"viewportanchor":var n=t.split(",");if(2!==n.length)break;var a=new _;if(a.percent("x",n[0]),a.percent("y",n[1]),!a.has("x")||!a.has("y"))break;r.set(e+"X",a.get("x")),r.set(e+"Y",a.get("y"));break;case"scroll":r.alt(e,t,["up"])}}),/=/,/\s/),r.has("id")){var n=new u.Region;n.width=r.get("width",100),n.lines=r.get("lines",3),n.regionAnchorX=r.get("regionanchorX",0),n.regionAnchorY=r.get("regionanchorY",100),n.viewportAnchorX=r.get("viewportanchorX",0),n.viewportAnchorY=r.get("viewportanchorY",100),n.scroll=r.get("scroll",""),t.onregion&&t.onregion(n),t.regionList.push({id:r.get("id"),region:n})}}(r)}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var a;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var i=(a=r()).match(/^WEBVTT([ \t].*)?$/);if(!i||!i[0])throw new L(L.Errors.BadSignature);t.state="HEADER"}for(var s=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:a=r(),t.state){case"HEADER":/:/.test(a)?n(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new VTTCue(0,0,""),t.state="CUE",-1===a.indexOf("--\x3e")){t.cue.id=a;continue}case"CUE":try{E(a,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==a.indexOf("--\x3e");if(!a||o&&(s=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=a;continue;case"BADCUE":a||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new L(L.Errors.BadSignature)}catch(t){e.reportOrThrowError(t)}return e.onflush&&e.onflush(),this}}},"./src/track/text-track.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PKTextTrack:function(){return f},default:function(){return f},getActiveCues:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),u=r("./src/track/track.ts"),c=r("./src/error/error.ts");function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var f=function(e){(0,i.default)(r,e);var t=h(r);function r(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.default)(this,r),(e=t.call(this,a))._label=e.label||e.language,e._kind=a.kind,e._external=a.external,e._index=r._generateIndex(),e._default=a.default||!1,e}return(0,a.default)(r,[{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e}},{key:"kind",get:function(){return this._kind}},{key:"external",get:function(){return this._external}},{key:"default",get:function(){return this._default}}],[{key:"_generateIndex",value:function(){return r._tracksCount++}},{key:"reset",value:function(){r._tracksCount=0}},{key:"isMetaDataTrack",value:function(e){return e&&e.kind===r.KIND.METADATA}},{key:"isNativeTextTrack",value:function(e){return e&&[r.KIND.SUBTITLES,r.KIND.CAPTIONS].includes(e.kind)}},{key:"isExternalTrack",value:function(e){return e&&[e.language,e.label].includes(r.EXTERNAL_TRACK_ID)}}]),r}(u.default);function m(e){var t,r=[],n=d(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(VTTCue&&a instanceof VTTCue||window.DataCue&&a instanceof window.DataCue)r.push(a);else if(TextTrackCue&&a instanceof TextTrackCue)try{r.push(new VTTCue(a.startTime,a.endTime,a.text))}catch(e){new c.default(c.default.Severity.RECOVERABLE,c.default.Category.TEXT,c.default.Code.UNABLE_TO_CREATE_TEXT_CUE,e)}}}catch(e){n.e(e)}finally{n.f()}return r}(0,l.default)(f,"MODE",{DISABLED:"disabled",SHOWING:"showing",HIDDEN:"hidden"}),(0,l.default)(f,"KIND",{METADATA:"metadata",SUBTITLES:"subtitles",CAPTIONS:"captions"}),(0,l.default)(f,"EXTERNAL_TRACK_ID","playkit-external-track"),(0,l.default)(f,"_tracksCount",0)},"./src/track/timed-metadata.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TimedMetadata:function(){return i},createTextTrackCue:function(){return s},createTimedMetadata:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=(0,n.default)((function e(t,r,n,i,s){(0,a.default)(this,e),this.startTime=t,this.endTime=r,this.id=n,this.type=i,this.metadata=s}));function s(e){try{var t=e.startTime,r=e.endTime,n=e.id,a=e.type,i=e.metadata,s=new VTTCue(t,r,""),o={key:a,data:i};return s.id=n,s.value=o,s}catch(e){return null}}function o(e){if(e){var t=e.startTime,r=e.endTime,n=e.id;if(l(e)){var a=l(e),s=a.type,o=a.metadata;return new i(t,r,n,s,o)}}return null}function l(e){if(e&&"value"in e&&e.value){var t=e.type,r=e.value,n=e.track,a=r.key,s=r.data,o="org.id3"===t||"id3"===(n&&n.label),l=Object.values(i.TYPE).find((function(e){return e===a}));return l||(l=o?i.TYPE.ID3:i.TYPE.CUSTOM),{type:l,metadata:o||!s?r:s}}return null}i.TYPE={ID3:"id3",EMSG:"emsg",CUE_POINT:"cuepoint",CUSTOM:"custom"}},"./src/track/track-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TrackType:function(){return n}});var n={VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"}},"./src/track/track.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js");function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),this._id=t.id,this._active=t.active,this._label=t.label,this._language=t.language,this._index=t.index,this._available="boolean"!=typeof t.available||t.available,this.clone=e.clone.bind(null,this)}return(0,i.default)(e,[{key:"id",get:function(){return this._id}},{key:"active",get:function(){return this._active},set:function(e){this._active=e}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"language",get:function(){return this._language},set:function(e){this._language=e}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"available",get:function(){return this._available},set:function(e){this._available=e}}],[{key:"langComparer",value:function(t,r,a,i){try{var s;return s=Array.isArray(a)?[t].concat((0,n.default)(a)):[t,a],e._langComparer(s,r,i)}catch(e){return!1}}},{key:"_langComparer",value:function(e,t,r){var n,a=s(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(""!==(null==i?void 0:i.trim()))if(r){if(this._isLangEqual(i,t))return!0}else if(this._isLangPrefixEqual(i,t))return!0}}catch(e){a.e(e)}finally{a.f()}return!1}},{key:"_isLangEqual",value:function(e,t){return e.toLowerCase()===t.toLowerCase()}},{key:"_isLangPrefixEqual",value:function(e,t){return e.toLowerCase().startsWith(t.toLowerCase())||t.toLowerCase().startsWith(e.toLowerCase())}},{key:"clone",value:function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}}]),e}()},"./src/track/video-track.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var u=function(e){(0,i.default)(r,e);var t=l(r);function r(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.default)(this,r),(e=t.call(this,a))._bandwidth=a.bandwidth,e._width=a.width,e._height=a.height,e._label=a.label?a.label:e._height?e._height+"p":void 0,e}return(0,a.default)(r,[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),r}(r("./src/track/track.ts").default)},"./src/track/vtt-region.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Region:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s={"":!0,up:!0};function o(e){return"number"==typeof e&&e>=0&&e<=100}var l,u=function(){function e(){(0,n.default)(this,e),(0,i.default)(this,"_width",100),(0,i.default)(this,"_lines",3),(0,i.default)(this,"_regionAnchorX",0),(0,i.default)(this,"_regionAnchorY",100),(0,i.default)(this,"_viewportAnchorX",0),(0,i.default)(this,"_viewportAnchorY",100),(0,i.default)(this,"_scroll","")}return(0,a.default)(e,[{key:"width",get:function(){return this._width},set:function(e){if(!o(e))throw new Error("Width must be between 0 and 100.");this._width=e}},{key:"scroll",get:function(){return this._scroll},set:function(e){var t=function(e){return"string"==typeof e&&!!s[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");this._scroll=t}},{key:"viewportAnchorY",get:function(){return this._viewportAnchorY},set:function(e){if(!o(e))throw new Error("ViewportAnchorY must be between 0 and 100.");this._viewportAnchorY=e}},{key:"viewportAnchorX",get:function(){return this._viewportAnchorX},set:function(e){if(!o(e))throw new Error("ViewportAnchorX must be between 0 and 100.");this._viewportAnchorX=e}},{key:"regionAnchorX",get:function(){return this._regionAnchorX},set:function(e){if(!o(e))throw new Error("RegionAnchorY must be between 0 and 100.");this._regionAnchorX=e}},{key:"lines",get:function(){return this._lines},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");this._lines=e}},{key:"regionAnchorY",get:function(){return this._regionAnchorY},set:function(e){if(!o(e))throw new Error("RegionAnchorX must be between 0 and 100.");this._regionAnchorY=e}}]),e}();l="undefined"!=typeof window&&window.VTTRegion?window.VTTRegion:u},"./src/types/abr-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ad-break-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ad-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/custom-labels-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/deferred-promise.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/dimensions.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/drm-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/drm-data.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/engine-decorator-provider.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/event-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/exteranl-thumbnails-object.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/image-player-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TrackType:function(){return n.TrackType}}),r("./src/types/abr-config.ts"),r("./src/types/ad-break-options.ts"),r("./src/types/ad-options.ts"),r("./src/types/custom-labels-config.ts"),r("./src/types/deferred-promise.ts"),r("./src/types/dimensions.ts"),r("./src/types/drm-config.ts"),r("./src/types/drm-data.ts"),r("./src/types/engine-decorator-provider.ts"),r("./src/types/event-types.ts"),r("./src/types/exteranl-thumbnails-object.ts"),r("./src/types/image-player-options.ts"),r("./src/types/log-level.ts"),r("./src/types/media-source.ts"),r("./src/types/media-source-capabilities.ts"),r("./src/types/media-source-options.ts"),r("./src/types/metadata-config.ts"),r("./src/types/mime-types.ts"),r("./src/types/network-config.ts"),r("./src/types/play-options.ts"),r("./src/types/playback-config.ts"),r("./src/types/playback-options.ts"),r("./src/types/player-state.ts"),r("./src/types/prefer-native-config.ts"),r("./src/types/request.ts"),r("./src/types/request-types.ts"),r("./src/types/response.ts"),r("./src/types/restrictions-types.ts"),r("./src/types/screen-orientation-type.ts"),r("./src/types/session-config.ts"),r("./src/types/sources-config.ts"),r("./src/types/stream-types.ts"),r("./src/types/stats.ts"),r("./src/types/stream-priority.ts"),r("./src/types/streaming-config.ts"),r("./src/types/text-config.ts"),r("./src/types/text-style.ts"),r("./src/types/text-track-cue.ts"),r("./src/types/text-track-display-setting.ts"),r("./src/types/thumbnail-vtt-cue.ts"),r("./src/types/track-types.ts"),r("./src/types/video-dimensions.ts"),r("./src/types/video-element-store.ts"),r("./src/types/interfaces/index.ts");var n=r("./src/track/track-type.ts"),a=(r("./src/types/logger-levels.ts"),r("./node_modules/js-logger/src/logger.js")),i={};for(var s in a)["default","TrackType"].indexOf(s)<0&&(i[s]=function(e){return a[e]}.bind(0,s));r.d(t,i)},"./src/types/interfaces/drm-protocol.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/interfaces/engine-capabilty.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/interfaces/engine-decorator.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/interfaces/engine.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/interfaces/index.ts":function(e,t,r){"use strict";r.r(t),r("./src/types/interfaces/drm-protocol.ts"),r("./src/types/interfaces/engine.ts"),r("./src/types/interfaces/engine-capabilty.ts"),r("./src/types/interfaces/engine-decorator.ts"),r("./src/types/interfaces/media-source-adapter.ts")},"./src/types/interfaces/media-source-adapter.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/log-level.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/logger-levels.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/media-source-capabilities.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/media-source-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/media-source.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/metadata-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/mime-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/network-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/play-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/playback-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/playback-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/player-state.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/prefer-native-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/request-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/request.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/response.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/restrictions-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/screen-orientation-type.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/session-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/sources-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/stats.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/stream-priority.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/stream-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/streaming-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/text-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/text-style.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/text-track-cue.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/text-track-display-setting.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/thumbnail-vtt-cue.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/track-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/video-dimensions.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/video-element-store.ts":function(e,t,r){"use strict";r.r(t)},"./src/utils/binary-search.ts":function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 1};if(0===e.length||1===e.length&&0!==t(e[0]))return null;var r=Math.floor(e.length/2);return 0===t(e[r])?e[r]:t(e[r])>0?n(e.slice(0,r),t):n(e.slice(r+1),t)}r.r(t),r.d(t,{binarySearch:function(){return n}})},"./src/utils/env.ts":function(e,t,r){"use strict";r.r(t);var n,a=r("./node_modules/ua-parser-js/src/ua-parser.js"),i=r.n(a),s=/^.*(web0s).*(smarttv).*$/i,o=/^.*(smart-tv).*(tizen).*$/i,l=/^.*(vidaa).*(smarttv).*$/i,u=[[o],[[i().BROWSER.NAME,"SAMSUNG_TV_BROWSER"],[i().BROWSER.MAJOR,""],[i().BROWSER.VERSION,""]]],c=[[s],[i().OS.NAME],[l],[i().OS.NAME]],d=[[s],[[i().DEVICE.VENDOR,"LG"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[o],[[i().DEVICE.VENDOR,"SAMSUNG"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[l],[[i().DEVICE.VENDOR,"HISENSE"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[/^.*(smart-tv|smarttv).*$/i],[[i().DEVICE.TYPE,i().DEVICE.SMARTTV]]],p=[[/(edg)\/((\d+)?[\w.]+)/i],[[i().BROWSER.NAME,"Edge"],i().BROWSER.VERSION,i().BROWSER.MAJOR]],h=[].concat(p,u),f=new(i())(void 0,{browser:h,device:d,os:c}).getResult();f.isConsole=f.device.type===i().DEVICE.CONSOLE,f.isSmartTV=f.device.type===i().DEVICE.SMARTTV,f.isMobile=f.device.type===i().DEVICE.MOBILE,f.isTablet=f.device.type===i().DEVICE.TABLET,f.isWearable=f.device.type===i().DEVICE.WEARABLE,f.isEmbedded=f.device.type===i().DEVICE.EMBEDDED,f.isIPadOS="Mac OS"===f.os.name&&"ontouchend"in document,f.isSafari=Boolean(null===(n=f.browser.name)||void 0===n?void 0:n.includes("Safari")),f.isIOS="iOS"===f.os.name,f.isMacOS="Mac OS"===f.os.name,t.default=f},"./src/utils/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Dom:function(){return n.Dom},Generator:function(){return n.Generator},Http:function(){return n.Http},MultiMap:function(){return i.MultiMap},Number:function(){return n.Number},Object:function(){return n.Object},ResizeWatcher:function(){return a.ResizeWatcher},String:function(){return n.String},VERSION:function(){return n.VERSION},binarySearch:function(){return s.binarySearch},getSubtitleStyleSheet:function(){return o.getSubtitleStyleSheet},resetSubtitleStyleSheet:function(){return o.resetSubtitleStyleSheet}});var n=r("./src/utils/util.ts"),a=r("./src/utils/resize-watcher.ts"),i=r("./src/utils/multi-map.ts"),s=r("./src/utils/binary-search.ts"),o=r("./src/utils/styles.ts")},"./src/utils/jsonp.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{jsonp:function(){return o}});var n=r("./src/error/error.ts"),a=5e3,i="jsonpcallback",s="responseFormat=jsonp&callback=";function o(e,t,r){var o,l=(r=r||{}).timeout?r.timeout:a,u=document.createElement("script"),c=i+Math.round(Date.now()+1000001*Math.random()),d=e,p=function(){u&&u.parentNode&&u.parentNode.removeChild(u),window[c]=function(){},o&&clearTimeout(o)};return new Promise((function(r,a){l&&(o=setTimeout((function(){p(),a(new n.default(n.default.Severity.CRITICAL,n.default.Category.NETWORK,n.default.Code.TIMEOUT,e))}),l)),window[c]=function(n){var a=t(n,e);p(),r(a)},d.match(/\?/)?d+="&"+s+c:d+="?"+s+c,u.type="text/javascript",u.src=d,document.getElementsByTagName("head")[0].appendChild(u)}))}},"./src/utils/locale.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"language",get:function(){var e;return(e=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language)&&e.match("-")&&(e=e.split("-")[0]),e}}]),e}()},"./src/utils/logger.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{LogLevel:function(){return i},LogLevelType:function(){return s},getLogLevel:function(){return u},getLogger:function(){return l},setLogHandler:function(){return o},setLogLevel:function(){return c}});var n=r("./node_modules/js-logger/src/logger.js"),a=r.n(n),i={DEBUG:a().DEBUG,INFO:a().INFO,TIME:a().TIME,WARN:a().WARN,ERROR:a().ERROR,OFF:a().OFF,TRACE:a().TRACE},s={};function o(e){a().setHandler((function(t,r){return e(t,r)}))}function l(e){return e?a().get(e):a()}function u(e){return l(e).getLevel()}function c(e,t){l(t).setLevel(e)}Object.keys(i).forEach((function(e){s[e]=e})),a().useDefaults({defaultLevel:a().ERROR}),t.default=l},"./src/utils/multi-map.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{MultiMap:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js");function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=function(){function e(){(0,n.default)(this,e),this._map=new Map}return(0,a.default)(e,[{key:"push",value:function(e,t){if(this._map.has(e)){var r=this._map.get(e);Array.isArray(r)&&(r.push(t),this._map.set(e,r))}else this._map.set(e,[t])}},{key:"set",value:function(e,t){this._map.set(e,t)}},{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){var t=this._map.get(e);return t?t.slice():[]}},{key:"getAll",value:function(){var e,t=[],r=i(this._map.values());try{for(r.s();!(e=r.n()).done;){var n=e.value;t=t.concat(n)}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"remove",value:function(e,t){if(this._map.has(e)){var r=this._map.get(e);if(Array.isArray(r)){for(var n=0;n<r.length;++n)r[n]===t&&(r.splice(n,1),--n);0===r.length&&this._map.delete(e)}}}},{key:"keys",value:function(){return this._map.keys()}},{key:"clear",value:function(){this._map.clear()}}]),e}()},"./src/utils/poster-manager.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/utils/util.ts"),s=function(){function e(){(0,n.default)(this,e),this._createEl()}return(0,a.default)(e,[{key:"setSrc",value:function(e){e&&(this._posterUrl=e,i.Dom.setStyle(this._el,"background-image",'url("'.concat(this._posterUrl,'")')),this.hide())}},{key:"src",get:function(){return this._posterUrl}},{key:"getElement",value:function(){return this._el}},{key:"_createEl",value:function(){if(!this._el){var e=this._el=i.Dom.createElement("div");i.Dom.setAttribute(e,"id",i.Generator.uniqueId(5)),i.Dom.setAttribute(e,"tabindex","-1")}}},{key:"_removeEl",value:function(){this._el&&i.Dom.removeChild(this._el.parentNode||void 0,this._el)}},{key:"show",value:function(){i.Dom.setStyle(this._el,"display","")}},{key:"hide",value:function(){i.Dom.setStyle(this._el,"display","none")}},{key:"reset",value:function(){this._posterUrl="",i.Dom.setStyle(this._el,"background-image","")}},{key:"destroy",value:function(){this.reset(),this._removeEl()}}]),e}();t.default=s},"./src/utils/resize-watcher.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ResizeWatcher:function(){return h}});var n=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=r("./src/event/fake-event.ts"),c=r("./src/event/fake-event-target.ts"),d=r("./src/event/event-type.ts");function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var h=function(e){(0,s.default)(r,e);var t=p(r);function r(){return(0,a.default)(this,r),t.call(this)}return(0,i.default)(r,[{key:"destroy",value:function(){this._observer&&this._observer.disconnect(),this._observer=void 0,this._el=void 0}},{key:"init",value:function(e){this._observer||(this._el=e,window.ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))}},{key:"_createNativeObserver",value:function(){var e=this;this._observer=new ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))}},{key:"_createIframeObserver",value:function(){this._observer=new f(this._triggerResize.bind(this))}},{key:"_triggerResize",value:function(){this.dispatchEvent(new u.FakeEvent(d.CustomEventType.RESIZE))}}]),r}(c.FakeEventTarget),f=function(){function e(t){(0,a.default)(this,e),(0,n.default)(this,"_observersStore",{}),this._onChangeCallback=t}return(0,i.default)(e,[{key:"observe",value:function(e){var t=this,r=this._createIframe(),n=e.getAttribute("id");this._observersStore[n]=r,e.appendChild(r),r.contentWindow.onresize=function(){return t._onChangeCallback()}}},{key:"disconnect",value:function(){for(var e in this._observersStore){var t=document.getElementById(e),r=this._observersStore[e];r.onresize=null,t&&(t.removeChild(r),delete this._observersStore[t.getAttribute("id")])}}},{key:"_createIframe",value:function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e}}]),e}()},"./src/utils/resolution.ts":function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw s}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t,r){var a=null;if(r&&e){var i,s=[],o=1/0,l=n(e);try{for(l.s();!(i=l.n()).done;){var u=i.value,c=Math.abs(u.width-t);c<o?(o=c,s=[u]):c===o&&s.push(u)}}catch(e){l.e(e)}finally{l.f()}for(var d=t/r,p=s,h=1/0,f=0,m=s;f<m.length;f++){var g=m[f];if(g.height){var y=Math.abs(g.width/g.height-d);y<h?(h=y,p=[g]):y===h&&p.push(g)}}for(var v=0,_=0,k=p;_<k.length;_++){var E=k[_];(E.bandwidth>v||!E.bandwidth)&&(v=E.bandwidth||v,a=E)}}return a}r.r(t),r.d(t,{getSuitableSourceForResolution:function(){return i}})},"./src/utils/restrictions.ts":function(e,t,r){"use strict";function n(e,t){var r=function(e,t){var r=1/0,n=function(e,t,n){return e>=(t||0)&&e<=(n||r)},a=t.maxHeight,i=t.minHeight,s=t.maxWidth,o=t.minWidth;if(0!==i||0!==o||a!==r||s!==r)return e.filter((function(e){return n(e.height,i,a)})).filter((function(e){return n(e.width,o,s)}));var l=t.maxBitrate,u=t.minBitrate;return 0!==u||l!==r?e.filter((function(e){return n(e.bandwidth,u,l)})):e}(e,t);return r.length?r:[]}r.r(t),r.d(t,{filterTracksByRestriction:function(){return n}})},"./src/utils/styles.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{getSubtitleStyleSheet:function(){return i},resetSubtitleStyleSheet:function(){return s}});var n=r("./src/utils/util.ts"),a="playkit-subtitles-style",i=function(e){var t=n.Dom.getElementBySelector(".".concat(e,".").concat(a));return t||(t=n.Dom.createElement("style"),n.Dom.addClassName(t,e),n.Dom.addClassName(t,a),n.Dom.appendChild(document.head,t)),t.sheet},s=function(e){var t=n.Dom.getElementBySelector(".".concat(e,".").concat(a));null==t||t.remove()}},"./src/utils/util.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Dom:function(){return h},Generator:function(){return p},Http:function(){return f},Number:function(){return u},Object:function(){return d},String:function(){return c},VERSION:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/esm/toArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=r("./node_modules/@babel/runtime/helpers/esm/typeof.js"),s=r("./src/utils/jsonp.ts");function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u={isNumber:function(e){return Number(e)===e},isInt:function(e){return this.isNumber(e)&&e%1==0},isFloat:function(e){return this.isNumber(e)&&e%1!=0}},c={capitlize:function(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)},endsWith:function(e,t){return"string"==typeof e&&"string"==typeof t&&-1!==e.indexOf(t,e.length-t.length)}},d={merge:function(e){var t,r={},n=o(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;Object.assign(r,a)}}catch(e){n.e(e)}finally{n.f()}return r},isObject:function(e){return e&&"object"===(0,i.default)(e)&&!Array.isArray(e)},isClassInstance:function(e){return e&&e.constructor&&e.constructor.name&&"Object"!==e.constructor.name},mergeDeep:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!r.length)return e;var i=r.shift();if(this.isObject(e)&&this.isObject(i))for(var s in i)this.isObject(i[s])&&!this.isClassInstance(i[s])?(e[s]||Object.assign(e,(0,a.default)({},s,{})),this.mergeDeep(e[s],i[s])):Object.assign(e,(0,a.default)({},s,i[s]));return this.mergeDeep.apply(this,[e].concat(r))},copyDeep:function(e){var t,r=this;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach((function(e,n){("object"===(0,i.default)(e)||Array.isArray(e)&&e.length>0)&&(t[n]=r.copyDeep(e))})):null!==e&&"object"===(0,i.default)(e)?e.clone&&"function"==typeof e.clone?t=e.clone():(t=Object.assign({__proto__:e.__proto__},e),Object.keys(t).forEach((function(e){("object"===(0,i.default)(t[e])||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=r.copyDeep(t[e]))}))):t=e,t},isEmptyObject:function(e){for(var t in e)if(Object.hasOwnProperty.call(e,t))return!1;return!0},getPropertyPath:function(e,t){return t.split(".").reduce((function(e,t){return null==e?e:e[t]}),e)},hasPropertyPath:function(e,t){if(!t)return!1;for(var r=t.split("."),n=0;n<r.length;n++){var a=r[n];if(!e||!Object.hasOwnProperty.call(e,a))return!1;e=e[a]}return!0},createPropertyPath:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.split("."),i=e;a.length>1;){var s=a,o=(0,n.default)(s),l=o[0];a=o.slice(1),void 0===i[l]&&(i[l]={}),i=i[l]}return i[a[0]]=r,e},deletePropertyPath:function(e,t){if(e&&t){for(var r=t.split("."),n=0;n<r.length-1;n++)if(void 0===(e=e[r[n]]))return;delete e[r.pop()]}},defer:function(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.resolve=e,r.reject=t,r},bind:function(e,t){return function(){t.apply(e,arguments)}}},p={uniqueId:function(e){var t=2+(!e||e<0?0:e-2);return"_"+Math.random().toString(36).slice(2,2+t)},guid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},h={addClassName:function(e,t){e&&(e.classList?e.classList.add(t):h.hasClassName(e,t)||(e.className+=t))},removeClassName:function(e,t){e&&(e.classList?e.classList.remove(t):h.hasClassName(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,"")))},hasClassName:function(e,t){return e&&e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},setAttribute:function(e,t,r){e.setAttribute(t,r)},removeAttribute:function(e,t){e.removeAttribute(t)},setStyle:function(e,t,r){void 0!==e.style.getPropertyValue(t)&&e.style.setProperty(t,r)},appendChild:function(e,t){e&&t&&e.appendChild&&e.appendChild(t)},removeChild:function(e,t){e&&t&&e.removeChild&&e.removeChild(t)},prependTo:function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},getElementById:function(e){return document.getElementById(e)},getElementsByTagName:function(e){return document.getElementsByTagName(e)},createElement:function(e){return document.createElement(e)},loadStyleSheetAsync:function(e){var t=this;return new Promise((function(r,n){var a=!1,i=t.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,i.async=!0,i.onload=i.onreadystatechange=function(){a||this.readyState&&"complete"!==this.readyState||(a=!0,r(this))},i.onerror=i.onabort=n,h.appendChild(document.head,i)}))},loadScriptAsync:function(e){var t=this;return new Promise((function(r,n){var a=!1,i=document.getElementsByTagName("script")[0],s=t.createElement("script");s.type="text/javascript",s.src=e,s.async=!0,s.onload=s.onreadystatechange=function(){a||this.readyState&&"complete"!==this.readyState||(a=!0,r(this))},s.onerror=s.onabort=n,i&&i.parentNode&&i.parentNode.insertBefore(s,i)}))},getElementBySelector:function(e){try{return document.querySelector(e)}catch(e){return}},insertBefore:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{return e.insertBefore(t,r)}catch(e){return null}}},f={protocol:/^(https?:)/i.test(document.location.protocol)?document.location.protocol:"https:",execute:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,s=new XMLHttpRequest;return new Promise((function(o,l){s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status)try{var e=JSON.parse(s.responseText);o(e)}catch(e){o(s.responseText)}else l(s.responseText)},s.open(r,e),n&&n.forEach((function(e,t){s.setRequestHeader(t,e)})),a&&(s.timeout=a),i&&(s.ontimeout=function(e){i(),l(e)}),s.send(t)}))},jsonp:s.jsonp,convertHeadersToDictionary:function(e){var t={};try{e.trim().split(/[\r\n]+/).forEach((function(e){var r=e.split(": "),n=r.shift().toLowerCase(),a=r.join(": ");t[n]=a}))}catch(e){}return t}},m={compare:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=(r=d.merge([{lexicographical:!1,zeroExtend:!0},r])).lexicographical,a=r.zeroExtend,i=(e||"0").split("."),s=(t||"0").split("."),o=function(e){return(n?/^\d+[A-Za-z]*$/:/^\d+[A-Za-z]?$/).test(e)},l=function(e){return e.map((function(e){var t=/[A-Za-z]/.exec(e);return Number(t?e.replace(t[0],"."+e.charCodeAt(t.index)):e)}))};if(!i.every(o)||!s.every(o))return NaN;if(a){for(;i.length<s.length;)i.push("0");for(;s.length<i.length;)s.push("0")}n||(i=l(i),s=l(s));for(var u=0;u<i.length;++u){if(s.length===u)return 1;if(i[u]!==s[u])return i[u]>s[u]?1:-1}return i.length!==s.length?-1:0}}},"./node_modules/css-loader/dist/cjs.js!./src/assets/style.css":function(module,e,t){"use strict";t.r(e);var r=t("./node_modules/css-loader/dist/runtime/sourceMaps.js"),n=t.n(r),a=t("./node_modules/css-loader/dist/runtime/api.js"),i=t.n(a)()(n());i.push([module.id,".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: var(--playkit-player-background-color);\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n","",{version:3,sources:["webpack://./src/assets/style.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,WAAW;EACX,aAAa;EACb,2BAA2B;EAC3B,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,wCAAwC;AAC1C;;AAEA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,MAAM;EACN,OAAO;EACP,mBAAmB;AACrB;;AAEA;;;;EAIE,aAAa;EACb,wBAAwB;AAC1B;;AAEA;EACE,kBAAkB;EAClB,cAAc;EACd,MAAM;EACN,SAAS;EACT,OAAO;EACP,QAAQ;EACR,wBAAwB;EACxB,kCAAkC;EAClC,4BAA4B;EAC5B,wDAAwD;EACxD,oBAAoB;AACtB;;AAEA;EACE,kBAAkB;EAClB,MAAM;EACN,SAAS;EACT,QAAQ;EACR,OAAO;EACP,oBAAoB;EACpB,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,SAAS;EACT,aAAa;AACf;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,0BAA0B;EAC1B,iBAAiB;EACjB,kBAAkB;EAClB,0FAA0F;EAC1F,0BAA0B;AAC5B",sourcesContent:[".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: var(--playkit-player-background-color);\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n"],sourceRoot:""}]),e.default=i},"./node_modules/css-loader/dist/runtime/api.js":function(module){"use strict";module.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(s[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);n&&s[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":function(module){"use strict";module.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},"./node_modules/js-logger/src/logger.js":function(module,e,t){var r,n;!function(a){"use strict";var i,s={VERSION:"1.6.1"},o={},l=function(e,t){return function(){return t.apply(e,arguments)}},u=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},c=function(e,t){return{value:e,name:t}};s.TRACE=c(1,"TRACE"),s.DEBUG=c(2,"DEBUG"),s.INFO=c(3,"INFO"),s.TIME=c(4,"TIME"),s.WARN=c(5,"WARN"),s.ERROR=c(8,"ERROR"),s.OFF=c(99,"OFF");var d=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};d.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(s.TRACE,arguments)},debug:function(){this.invoke(s.DEBUG,arguments)},info:function(){this.invoke(s.INFO,arguments)},warn:function(){this.invoke(s.WARN,arguments)},error:function(){this.invoke(s.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"end"])},invoke:function(e,t){i&&this.enabledFor(e)&&i(t,u({level:e},this.context))}};var p,h=new d({filterLevel:s.OFF});(p=s).enabledFor=l(h,h.enabledFor),p.trace=l(h,h.trace),p.debug=l(h,h.debug),p.time=l(h,h.time),p.timeEnd=l(h,h.timeEnd),p.info=l(h,h.info),p.warn=l(h,h.warn),p.error=l(h,h.error),p.log=p.info,s.setHandler=function(e){i=e},s.setLevel=function(e){for(var t in h.setLevel(e),o)o.hasOwnProperty(t)&&o[t].setLevel(e)},s.getLevel=function(){return h.getLevel()},s.get=function(e){return o[e]||(o[e]=new d(u({name:e},h.context)))},s.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(n,a){n=Array.prototype.slice.call(n);var i,o=console.log;a.level===s.TIME?(i=(a.name?"["+a.name+"] ":"")+n[0],"start"===n[1]?console.time?console.time(i):t[i]=(new Date).getTime():console.timeEnd?console.timeEnd(i):r(o,[i+": "+((new Date).getTime()-t[i])+"ms"])):(a.level===s.WARN&&console.warn?o=console.warn:a.level===s.ERROR&&console.error?o=console.error:a.level===s.INFO&&console.info?o=console.info:a.level===s.DEBUG&&console.debug?o=console.debug:a.level===s.TRACE&&console.trace&&(o=console.trace),e.formatter(n,a),r(o,n))}},s.useDefaults=function(e){s.setLevel(e&&e.defaultLevel||s.DEBUG),s.setHandler(s.createDefaultHandler(e))},s.setDefaults=s.useDefaults,void 0===(n="function"==typeof(r=s)?r.call(e,t,e,module):r)||(module.exports=n)}()},"./src/assets/style.css":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),a=r.n(n),i=r("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),s=r.n(i),o=r("./node_modules/style-loader/dist/runtime/setAttributesWithAttributesAndNonce.js"),l=r.n(o),u=r("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),c=r.n(u),d=r("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),p=r.n(d),h=r("./node_modules/css-loader/dist/cjs.js!./src/assets/style.css"),f={attributes:{id:"@playkit-js/playkit-js"}};f.styleTagTransform=p(),f.setAttributes=l(),f.insert=function(e){window.kalturaGlobalConfig&&"string"==typeof window.kalturaGlobalConfig.stylesNonce&&e.setAttribute("nonce",window.kalturaGlobalConfig.stylesNonce),document.head.appendChild(e)},f.domAPI=s(),f.insertStyleElement=c(),a()(h.default,f),t.default=h.default&&h.default.locals?h.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":function(module){"use strict";var e=[];function t(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function r(r,a){for(var i={},s=[],o=0;o<r.length;o++){var l=r[o],u=a.base?l[0]+a.base:l[0],c=i[u]||0,d="".concat(u," ").concat(c);i[u]=c+1;var p=t(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(h);else{var f=n(h,a);a.byIndex=o,e.splice(o,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function n(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}module.exports=function(n,a){var i=r(n=n||[],a=a||{});return function(n){n=n||[];for(var s=0;s<i.length;s++){var o=t(i[s]);e[o].references--}for(var l=r(n,a),u=0;u<i.length;u++){var c=t(i[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}i=l}}},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":function(module){"use strict";module.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},"./node_modules/style-loader/dist/runtime/setAttributesWithAttributesAndNonce.js":function(module){"use strict";module.exports=function(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":function(module){"use strict";module.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,a&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":function(module){"use strict";module.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},"./node_modules/ua-parser-js/src/ua-parser.js":function(module,e,t){var r;!function(n,a){"use strict";var i="function",o="undefined",l="object",u="string",c="major",d="model",p="name",h="type",f="vendor",m="version",g="architecture",y="console",v="mobile",_="tablet",k="smarttv",E="wearable",b="embedded",T="Amazon",A="Apple",S="ASUS",P="BlackBerry",C="Browser",x="Chrome",I="Firefox",w="Google",R="Huawei",M="LG",D="Microsoft",O="Motorola",L="Opera",N="Samsung",U="Sharp",j="Sony",B="Xiaomi",F="Zebra",V="Facebook",G="Chromium OS",H="Mac OS",K=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},W=function(e,t){return s(e)===u&&-1!==$(t).indexOf($(e))},$=function(e){return e.toLowerCase()},z=function(e,t){if(s(e)===u)return e=e.replace(/^\s\s*/,""),s(t)===o?e:e.substring(0,500)},q=function(e,t){for(var r,n,o,u,c,d,p=0;p<t.length&&!c;){var h=t[p],f=t[p+1];for(r=n=0;r<h.length&&!c&&h[r];)if(c=h[r++].exec(e))for(o=0;o<f.length;o++)d=c[++n],s(u=f[o])===l&&u.length>0?2===u.length?s(u[1])==i?this[u[0]]=u[1].call(this,d):this[u[0]]=u[1]:3===u.length?s(u[1])!==i||u[1].exec&&u[1].test?this[u[0]]=d?d.replace(u[1],u[2]):a:this[u[0]]=d?u[1].call(this,d,u[2]):a:4===u.length&&(this[u[0]]=d?u[3].call(this,d.replace(u[1],u[2])):a):this[u]=d||a;p+=2}},Y=function(e,t){for(var r in t)if(s(t[r])===l&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(W(t[r][n],e))return"?"===r?a:r}else if(W(t[r],e))return"?"===r?a:r;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,m],[/opios[\/ ]+([\w\.]+)/i],[m,[p,L+" Mini"]],[/\bopr\/([\w\.]+)/i],[m,[p,L]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[m,[p,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,m],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[p,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[m,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[p,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[m,[p,"Smart Lenovo "+C]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+C],m],[/\bfocus\/([\w\.]+)/i],[m,[p,I+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[p,L+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[p,L+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[p,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[m,[p,I]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+C]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+C],m],[/samsungbrowser\/([\w\.]+)/i],[m,[p,N+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],m],[/metasr[\/ ]?([\d\.]+)/i],[m,[p,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[p,"Sogou Mobile"],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[p,m],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,V],m],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[p,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[p,x+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,x+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[p,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[m,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[p,I+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,m],[/(cobalt)\/([\w\.]+)/i],[p,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,$]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",$]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,$]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[f,N],[h,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[f,N],[h,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[f,A],[h,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[f,A],[h,_]],[/(macintosh);/i],[d,[f,A]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[f,U],[h,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[f,R],[h,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[f,R],[h,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[f,B],[h,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[f,B],[h,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[f,"OPPO"],[h,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[f,"Vivo"],[h,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[f,"Realme"],[h,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[f,O],[h,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[f,O],[h,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[f,M],[h,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[f,M],[h,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[f,"Lenovo"],[h,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[f,"Nokia"],[h,v]],[/(pixel c)\b/i],[d,[f,w],[h,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[f,w],[h,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[f,j],[h,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[f,j],[h,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[f,"OnePlus"],[h,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[f,T],[h,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[f,T],[h,v]],[/(playbook);[-\w\),; ]+(rim)/i],[d,f,[h,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[f,P],[h,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[f,S],[h,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[f,S],[h,v]],[/(nexus 9)/i],[d,[f,"HTC"],[h,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[d,/_/g," "],[h,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[f,"Acer"],[h,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[f,"Meizu"],[h,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[f,"Ulefone"],[h,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,d,[h,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,d,[h,_]],[/(surface duo)/i],[d,[f,D],[h,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[f,"Fairphone"],[h,v]],[/(u304aa)/i],[d,[f,"AT&T"],[h,v]],[/\bsie-(\w*)/i],[d,[f,"Siemens"],[h,v]],[/\b(rct\w+) b/i],[d,[f,"RCA"],[h,_]],[/\b(venue[\d ]{2,7}) b/i],[d,[f,"Dell"],[h,_]],[/\b(q(?:mv|ta)\w+) b/i],[d,[f,"Verizon"],[h,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[f,"Barnes & Noble"],[h,_]],[/\b(tm\d{3}\w+) b/i],[d,[f,"NuVision"],[h,_]],[/\b(k88) b/i],[d,[f,"ZTE"],[h,_]],[/\b(nx\d{3}j) b/i],[d,[f,"ZTE"],[h,v]],[/\b(gen\d{3}) b.+49h/i],[d,[f,"Swiss"],[h,v]],[/\b(zur\d{3}) b/i],[d,[f,"Swiss"],[h,_]],[/\b((zeki)?tb.*\b) b/i],[d,[f,"Zeki"],[h,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],d,[h,_]],[/\b(ns-?\w{0,9}) b/i],[d,[f,"Insignia"],[h,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[f,"NextBook"],[h,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],d,[h,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],d,[h,v]],[/\b(ph-1) /i],[d,[f,"Essential"],[h,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[f,"Envizen"],[h,_]],[/\b(trio[-\w\. ]+) b/i],[d,[f,"MachSpeed"],[h,_]],[/\btu_(1491) b/i],[d,[f,"Rotor"],[h,_]],[/(shield[\w ]+) b/i],[d,[f,"Nvidia"],[h,_]],[/(sprint) (\w+)/i],[f,d,[h,v]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[f,D],[h,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[f,F],[h,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[f,F],[h,v]],[/smart-tv.+(samsung)/i],[f,[h,k]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[f,N],[h,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,M],[h,k]],[/(apple) ?tv/i],[f,[d,A+" TV"],[h,k]],[/crkey/i],[[d,x+"cast"],[f,w],[h,k]],[/droid.+aft(\w+)( bui|\))/i],[d,[f,T],[h,k]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[f,U],[h,k]],[/(bravia[\w ]+)( bui|\))/i],[d,[f,j],[h,k]],[/(mitv-\w{5}) bui/i],[d,[f,B],[h,k]],[/Hbbtv.*(technisat) (.*);/i],[f,d,[h,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,z],[d,z],[h,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,k]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,d,[h,y]],[/droid.+; (shield) bui/i],[d,[f,"Nvidia"],[h,y]],[/(playstation [345portablevi]+)/i],[d,[f,j],[h,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[f,D],[h,y]],[/((pebble))app/i],[f,d,[h,E]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[f,A],[h,E]],[/droid.+; (glass) \d/i],[d,[f,w],[h,E]],[/droid.+; (wt63?0{2,3})\)/i],[d,[f,F],[h,E]],[/(quest( 2| pro)?)/i],[d,[f,V],[h,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[h,b]],[/(aeobc)\b/i],[d,[f,T],[h,b]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[h,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[h,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,v]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,m],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[p,[m,Y,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,Y,X],[p,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,H],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,m],[/\(bb(10);/i],[m,[p,P]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[p,I+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[p,x+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,G],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,m],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,m]]},Q=function e(t,r){if(s(t)===l&&(r=t,t=a),!(this instanceof e))return new e(t,r).getResult();var y=s(n)!==o&&n.navigator?n.navigator:a,k=t||(y&&y.userAgent?y.userAgent:""),E=y&&y.userAgentData?y.userAgentData:a,b=r?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(Z,r):Z,T=y&&y.userAgent==k;return this.getBrowser=function(){var e,t={};return t[p]=a,t[m]=a,q.call(t,k,b.browser),t[c]=s(e=t[m])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:a,T&&y&&y.brave&&s(y.brave.isBrave)==i&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[g]=a,q.call(e,k,b.cpu),e},this.getDevice=function(){var e={};return e[f]=a,e[d]=a,e[h]=a,q.call(e,k,b.device),T&&!e[h]&&E&&E.mobile&&(e[h]=v),T&&"Macintosh"==e[d]&&y&&s(y.standalone)!==o&&y.maxTouchPoints&&y.maxTouchPoints>2&&(e[d]="iPad",e[h]=_),e},this.getEngine=function(){var e={};return e[p]=a,e[m]=a,q.call(e,k,b.engine),e},this.getOS=function(){var e={};return e[p]=a,e[m]=a,q.call(e,k,b.os),T&&!e[p]&&E&&"Unknown"!=E.platform&&(e[p]=E.platform.replace(/chrome os/i,G).replace(/macos/i,H)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return k},this.setUA=function(e){return k=s(e)===u&&e.length>500?z(e,500):e,this},this.setUA(k),this};Q.VERSION="1.0.37",Q.BROWSER=K([p,m,c]),Q.CPU=K([g]),Q.DEVICE=K([d,f,h,y,v,k,_,E,b]),Q.ENGINE=Q.OS=K([p,m]),s(e)!==o?(module.exports&&(e=module.exports=Q),e.UAParser=Q):t.amdO?(r=function(){return Q}.call(e,t,e,module))===a||(module.exports=r):s(n)!==o&&(n.UAParser=Q);var J=s(n)!==o&&(n.jQuery||n.Zepto);if(J&&!J.ua){var ee=new Q;J.ua=ee.getResult(),J.ua.get=function(){return ee.getUA()},J.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var r in t)J.ua[r]=t[r]}}}("object"===("undefined"==typeof window?"undefined":s(window))?window:this)},"./node_modules/@babel/runtime/helpers/regeneratorRuntime.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/typeof.js").default;function n(){"use strict";module.exports=n=function(){return t},module.exports.__esModule=!0,module.exports.default=module.exports;var e,t={},a=Object.prototype,i=a.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},l=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var a=t&&t.prototype instanceof _?t:_,i=Object.create(a.prototype),o=new M(n||[]);return s(i,"_invoke",{value:x(e,r,o)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var f="suspendedStart",m="suspendedYield",g="executing",y="completed",v={};function _(){}function k(){}function E(){}var b={};d(b,l,(function(){return this}));var T=Object.getPrototypeOf,A=T&&T(T(D([])));A&&A!==a&&i.call(A,l)&&(b=A);var S=E.prototype=_.prototype=Object.create(b);function P(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(a,s,o,l){var u=h(e[a],e,s);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,l)}),(function(e){n("throw",e,o,l)})):t.resolve(d).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,l)}))}l(u.arg)}var a;s(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}})}function x(t,r,n){var a=f;return function(i,s){if(a===g)throw new Error("Generator is already running");if(a===y){if("throw"===i)throw s;return{value:e,done:!0}}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var l=I(o,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=g;var u=h(t,r,n);if("normal"===u.type){if(a=n.done?y:m,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=y,n.method="throw",n.arg=u.arg)}}}function I(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var s=i.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[l];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,s=function r(){for(;++a<t.length;)if(i.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return s.next=s}}throw new TypeError(r(t)+" is not iterable")}return k.prototype=E,s(S,"constructor",{value:E,configurable:!0}),s(E,"constructor",{value:k,configurable:!0}),k.displayName=d(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,d(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},P(C.prototype),d(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var s=new C(p(e,r,n,a),i);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},P(S),d(S,c,"Generator"),d(S,l,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=D,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return o.type="throw",o.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),u=i.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;R(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}module.exports=n,module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/@babel/runtime/helpers/typeof.js":function(module){function e(t){return module.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},module.exports.__esModule=!0,module.exports.default=module.exports,e(t)}module.exports=e,module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/@babel/runtime/regenerator/index.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/regeneratorRuntime.js")();module.exports=r;try{regeneratorRuntime=r}catch(e){"object"===("undefined"==typeof globalThis?"undefined":s(globalThis))?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},"./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js":function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js":function(e,t,r){"use strict";function n(e){if(Array.isArray(e))return e}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js");function a(e){if(Array.isArray(e))return(0,n.default)(e)}},"./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js":function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js":function(e,t,r){"use strict";function n(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var s=e.apply(t,r);function o(e){n(s,a,i,o,l,"next",e)}function l(e){n(s,a,i,o,l,"throw",e)}o(void 0)}))}}r.r(t),r.d(t,{default:function(){return a}})},"./node_modules/@babel/runtime/helpers/esm/classCallCheck.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/createClass.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,n.default)(a.key),a)}}function i(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}},"./node_modules/@babel/runtime/helpers/esm/defineProperty.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function a(e,t,r){return(t=(0,n.default)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},"./node_modules/@babel/runtime/helpers/esm/get.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/superPropBase.js");function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var a=(0,n.default)(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},a.apply(this,arguments)}},"./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js":function(e,t,r){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/inherits.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js");function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,n.default)(e,t)}},"./node_modules/@babel/runtime/helpers/esm/iterableToArray.js":function(e,t,r){"use strict";function n(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js":function(e,t,r){"use strict";function n(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js":function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js":function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js"),a=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js");function i(e,t){if(t&&("object"===(0,n.default)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,a.default)(e)}},"./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js":function(e,t,r){"use strict";function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/slicedToArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js"),a=r("./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js"),i=r("./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js"),s=r("./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js");function o(e,t){return(0,n.default)(e)||(0,a.default)(e,t)||(0,i.default)(e,t)||(0,s.default)()}},"./node_modules/@babel/runtime/helpers/esm/superPropBase.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,n.default)(e)););return e}},"./node_modules/@babel/runtime/helpers/esm/toArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js"),a=r("./node_modules/@babel/runtime/helpers/esm/iterableToArray.js"),i=r("./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js"),s=r("./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js");function o(e){return(0,n.default)(e)||(0,a.default)(e)||(0,i.default)(e)||(0,s.default)()}},"./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js"),a=r("./node_modules/@babel/runtime/helpers/esm/iterableToArray.js"),i=r("./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js"),s=r("./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js");function o(e){return(0,n.default)(e)||(0,a.default)(e)||(0,i.default)(e)||(0,s.default)()}},"./node_modules/@babel/runtime/helpers/esm/toPrimitive.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js");function a(e,t){if("object"!==(0,n.default)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!==(0,n.default)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}},"./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js"),a=r("./node_modules/@babel/runtime/helpers/esm/toPrimitive.js");function i(e){var t=(0,a.default)(e,"string");return"symbol"===(0,n.default)(t)?t:String(t)}},"./node_modules/@babel/runtime/helpers/esm/typeof.js":function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js");function a(e,t){if(e){if("string"==typeof e)return(0,n.default)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.default)(e,t):void 0}}},"./src/assets/encoding-sources.json":function(module){"use strict";module.exports=JSON.parse('{"Base64Mp4Source":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="}')},"./src/engines/html5/media-source/adapters/native-adapter-default-config.json":function(module){"use strict";module.exports=JSON.parse('{"heartbeatTimeout":30000}')}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var module=t[n]={id:n,exports:{}};return e[n].call(module.exports,module,module.exports,r),module.exports}r.amdO={},r.n=function(module){var e=module&&module.__esModule?function(){return module.default}:function(){return module};return r.d(e,{a:e}),e},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return function(){"use strict";r.r(n),r.d(n,{AbrMode:function(){return S.AbrMode},AdBreakType:function(){return R.AdBreakType},AdEventType:function(){return D.AdEventType},AdTagType:function(){return M.AdTagType},AudioTrack:function(){return p.default},AudioTrackKind:function(){return p.AudioTrackKind},AutoPlayType:function(){return L.AutoPlayType},BaseMediaSourceAdapter:function(){return t.default},BaseMiddleware:function(){return o.default},CorsType:function(){return C.CorsType},CustomEventType:function(){return A.CustomEventType},DrmScheme:function(){return x.DrmScheme},EngineDecoratorProvider:function(){return i.EngineDecoratorProvider},EngineType:function(){return b.EngineType},Env:function(){return g.default},Error:function(){return v.default},EventManager:function(){return B.EventManager},EventType:function(){return A.EventType},FakeEvent:function(){return j.FakeEvent},FakeEventTarget:function(){return F.FakeEventTarget},Html5EventType:function(){return A.Html5EventType},ImageTrack:function(){return c.default},LogLevel:function(){return P.LogLevel},LogLevelType:function(){return P.LogLevelType},MediaType:function(){return T.MediaType},MimeType:function(){return I.MimeType},NAME:function(){return W},PKTextTrack:function(){return h.PKTextTrack},Player:function(){return e.default},RequestType:function(){return w.RequestType},ScreenOrientationType:function(){return O.ScreenOrientationType},State:function(){return l.default},StateType:function(){return _.StateType},StreamType:function(){return E.StreamType},TextStyle:function(){return m.default},TextTrack:function(){return h.default},ThumbnailInfo:function(){return N.ThumbnailInfo},TimedMetadata:function(){return f.TimedMetadata},Track:function(){return u.default},TrackType:function(){return k.TrackType},Utils:function(){return y},VERSION:function(){return K},VideoTrack:function(){return d.default},createTextTrackCue:function(){return f.createTextTrackCue},createTimedMetadata:function(){return f.createTimedMetadata},filterTracksByRestriction:function(){return U.filterTracksByRestriction},getCapabilities:function(){return z},getLogLevel:function(){return P.getLogLevel},getLogger:function(){return P.default},loadPlayer:function(){return $},registerEngine:function(){return s.registerEngine},registerMediaSourceAdapter:function(){return a.registerMediaSourceAdapter},setCapabilities:function(){return q},setLogHandler:function(){return P.setLogHandler},setLogLevel:function(){return P.setLogLevel},unRegisterEngine:function(){return s.unRegisterEngine},utils:function(){return y}});var e=r("./src/player.ts"),t=r("./src/engines/html5/media-source/base-media-source-adapter.ts"),a=r("./src/engines/html5/media-source/media-source-provider.ts"),i=r("./src/engines/engine-decorator-provider.ts"),s=r("./src/engines/engine-provider.ts"),o=r("./src/middleware/base-middleware.ts"),l=r("./src/state/state.ts"),u=r("./src/track/track.ts"),c=r("./src/track/image-track.ts"),d=r("./src/track/video-track.ts"),p=r("./src/track/audio-track.ts"),h=r("./src/track/text-track.ts"),f=r("./src/track/timed-metadata.ts"),m=r("./src/track/text-style.ts"),g=r("./src/utils/env.ts"),y=r("./src/utils/index.ts"),v=r("./src/error/error.ts"),_=r("./src/state/state-type.ts"),k=r("./src/track/track-type.ts"),E=r("./src/engines/stream-type.ts"),b=r("./src/engines/engine-type.ts"),T=r("./src/enums/media-type.ts"),A=r("./src/event/event-type.ts"),S=r("./src/track/abr-mode-type.ts"),P=r("./src/utils/logger.ts"),C=r("./src/engines/html5/cors-types.ts"),x=r("./src/drm/drm-scheme.ts"),I=r("./src/enums/mime-type.ts"),w=r("./src/enums/request-type.ts"),R=r("./src/ads/ad-break-type.ts"),M=r("./src/ads/ad-tag-type.ts"),D=r("./src/ads/ad-event-type.ts"),O=r("./src/enums/screen-orientation-type.ts"),L=r("./src/enums/auto-play-type.ts"),N=r("./src/thumbnail/thumbnail-info.ts"),U=r("./src/utils/restrictions.ts"),j=r("./src/event/fake-event.ts"),B=r("./src/event/event-manager.ts"),F=r("./src/event/fake-event-target.ts"),V=r("./src/types/index.ts"),G={};for(var H in V)["default","loadPlayer","registerMediaSourceAdapter","BaseMediaSourceAdapter","BaseMiddleware","Track","VideoTrack","AudioTrack","TextTrack","PKTextTrack","ImageTrack","TextStyle","AudioTrackKind","TimedMetadata","createTextTrackCue","createTimedMetadata","Utils","utils","Error","FakeEvent","EventManager","FakeEventTarget","VERSION","NAME","Env","State","getCapabilities","setCapabilities","EngineDecoratorProvider","registerEngine","unRegisterEngine","AdBreakType","AdTagType","AdEventType","filterTracksByRestriction","Html5EventType","CustomEventType","EventType","StateType","TrackType","EngineType","MediaType","StreamType","AbrMode","LogLevelType","CorsType","DrmScheme","MimeType","RequestType","ScreenOrientationType","AutoPlayType","ThumbnailInfo","getLogger","LogLevel","getLogLevel","setLogLevel","setLogHandler","Player"].indexOf(H)<0&&(G[H]=function(e){return V[e]}.bind(0,H));r.d(n,G);var K="0.84.31",W="@playkit-js/playkit-js";function $(t){return new e.default(t||{})}var z=e.default.getCapabilities,q=e.default.setCapabilities;n.default=$}(),n}()},"object"===s(e)&&"object"===s(module)?module.exports=i():(n=[],void 0===(a="function"==typeof(r=i)?r.apply(e,n):r)||(module.exports=a))},129:(module,e,t)=>{"use strict";t.d(e,{Z:()=>s});var r=t(864),n=t.n(r),a=t(352),i=t.n(a)()(n());i.push([module.id,".kaltura-player-container {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  background-color: #000;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n","",{version:3,sources:["webpack://./assets/style.css"],names:[],mappings:"AAAA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,sBAAsB;EACtB,aAAa;EACb,2BAA2B;EAC3B,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,wCAAwC;AAC1C",sourcesContent:[".kaltura-player-container {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  background-color: #000;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n"],sourceRoot:""}]);const s=i},644:(module,e,t)=>{var r,n;self,module.exports=(r=t(538),n=t(673),function(){var e={774:function(e,t,r){"use strict";var n=r(864),a=r.n(n),i=r(352),s=r.n(i)()(a());s.push([e.id,".shaka-text-container {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  width: 100%;\n  min-width: 48px;\n  transition: bottom cubic-bezier(0.4, 0, 0.6, 1) 0.1s;\n  transition-delay: 0s;\n  font-size: 20px;\n  line-height: 1.4;\n  color: #fff;\n  font-family: Roboto-Regular, Roboto, sans-serif, TengwarTelcontar;\n}\n.shaka-text-container span.shaka-text-wrapper {\n  display: inline;\n  background: 0 0;\n  text-align: center;\n}\n\n:fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-webkit-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-moz-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-ms-fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n","",{version:3,sources:["webpack://./src/assets/style.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,OAAO;EACP,QAAQ;EACR,MAAM;EACN,SAAS;EACT,oBAAoB;EACpB,WAAW;EACX,eAAe;EACf,oDAAoD;EACpD,oBAAoB;EACpB,eAAe;EACf,gBAAgB;EAChB,WAAW;EACX,iEAAiE;AACnE;AACA;EACE,eAAe;EACf,eAAe;EACf,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;AACpB",sourcesContent:[".shaka-text-container {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  width: 100%;\n  min-width: 48px;\n  transition: bottom cubic-bezier(0.4, 0, 0.6, 1) 0.1s;\n  transition-delay: 0s;\n  font-size: 20px;\n  line-height: 1.4;\n  color: #fff;\n  font-family: Roboto-Regular, Roboto, sans-serif, TengwarTelcontar;\n}\n.shaka-text-container span.shaka-text-wrapper {\n  display: inline;\n  background: 0 0;\n  text-align: center;\n}\n\n:fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-webkit-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-moz-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-ms-fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n"],sourceRoot:""}]),t.Z=s},352:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(s[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);n&&s[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},864:function(e){"use strict";e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},701:function(e){"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},s=[],o=0;o<e.length;o++){var l=e[o],u=n.base?l[0]+n.base:l[0],c=i[u]||0,d="".concat(u," ").concat(c);i[u]=c+1;var p=r(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var f=a(h,n);n.byIndex=o,t.splice(o,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function a(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,a){var i=n(e=e||[],a=a||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var o=r(i[s]);t[o].references--}for(var l=n(e,a),u=0;u<i.length;u++){var c=r(i[u]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=l}}},182:function(e){"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},75:function(e){"use strict";e.exports=function(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}},236:function(e){"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,a&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},213:function(e){"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},230:function(e){"use strict";e.exports=r},475:function(e){"use strict";e.exports=n},333:function(e,t,r){var n=r(125).default;function a(){"use strict";e.exports=a=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var t,r={},i=Object.prototype,s=i.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function p(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(t){p=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var a=t&&t.prototype instanceof k?t:k,i=Object.create(a.prototype),s=new D(n||[]);return o(i,"_invoke",{value:I(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var m="suspendedStart",g="suspendedYield",y="executing",v="completed",_={};function k(){}function E(){}function b(){}var T={};p(T,u,(function(){return this}));var A=Object.getPrototypeOf,S=A&&A(A(O([])));S&&S!==i&&s.call(S,u)&&(T=S);var P=b.prototype=k.prototype=Object.create(T);function C(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(a,i,o,l){var u=f(e[a],e,i);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==n(d)&&s.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,o,l)}),(function(e){r("throw",e,o,l)})):t.resolve(d).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}})}function I(e,r,n){var a=m;return function(i,s){if(a===y)throw new Error("Generator is already running");if(a===v){if("throw"===i)throw s;return{value:t,done:!0}}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var l=w(o,n);if(l){if(l===_)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===m)throw a=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=y;var u=f(e,r,n);if("normal"===u.type){if(a=n.done?v:g,u.arg===_)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=v,n.method="throw",n.arg=u.arg)}}}function w(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,w(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var i=f(a,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var s=i.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(s.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(n(e)+" is not iterable")}return E.prototype=b,o(P,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:E,configurable:!0}),E.displayName=p(b,d,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,p(e,d,"GeneratorFunction")),e.prototype=Object.create(P),e},r.awrap=function(e){return{__await:e}},C(x.prototype),p(x.prototype,c,(function(){return this})),r.AsyncIterator=x,r.async=function(e,t,n,a,i){void 0===i&&(i=Promise);var s=new x(h(e,t,n,a),i);return r.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},C(P),p(P,d,"Generator"),p(P,u,(function(){return this})),p(P,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=O,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var r in this)"t"===r.charAt(0)&&s.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,a){return o.type="throw",o.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=s.call(i,"catchLoc"),u=s.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;M(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},r}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},125:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},47:function(e,t,r){var n=r(333)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,a),i.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){"use strict";a.r(i),a.d(i,{NAME:function(){return ie},VERSION:function(){return ae},default:function(){return se}});var e=a(230);function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}function n(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,l,"next",e)}function l(e){s(i,n,a,o,l,"throw",e)}o(void 0)}))}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:String(t)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function p(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?e:r):a.value}},m.apply(this,arguments)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function y(e,t,r){return(t=c(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v,_,k=a(47),E=a.n(k),b=a(475),T=a.n(b),A=(v=function(){function t(){l(this,t)}return p(t,null,[{key:"isConfigured",value:function(t,r){return e.DrmScheme.WIDEVINE===r.keySystem&&!!t.find((function(e){return e.scheme===r.keySystem}))}},{key:"canPlayDrm",value:function(r){return t._logger.debug("Can play DRM scheme of: "+e.DrmScheme.WIDEVINE),!!r.find((function(t){return t.scheme===e.DrmScheme.WIDEVINE}))}},{key:"setDrmPlayback",value:function(r,n){t._logger.debug("Sets drm playback");var a=e.Env.browser.name,i=n.find((function(t){return t.scheme===e.DrmScheme.WIDEVINE}));i&&(r.drm={servers:y({},e.DrmScheme.WIDEVINE,i.licenseUrl),advanced:{}},"Chrome"===a&&(r.drm.advanced=y({},e.DrmScheme.WIDEVINE,{videoRobustness:"SW_SECURE_CRYPTO",audioRobustness:"SW_SECURE_CRYPTO"})))}}]),t}(),y(v,"_logger",(0,e.getLogger)("Widevine")),v),S=(_=function(){function t(){l(this,t)}return p(t,null,[{key:"isConfigured",value:function(t,r){return e.DrmScheme.PLAYREADY===r.keySystem&&!!t.find((function(e){return e.scheme===r.keySystem}))}},{key:"canPlayDrm",value:function(r){return t._logger.debug("Can play DRM scheme of: "+e.DrmScheme.PLAYREADY),!!r.find((function(t){return t.scheme===e.DrmScheme.PLAYREADY}))}},{key:"setDrmPlayback",value:function(r,n){t._logger.debug("Sets drm playback");var a=n.find((function(t){return t.scheme===e.DrmScheme.PLAYREADY}));a&&(r.drm={servers:y({},e.DrmScheme.PLAYREADY,a.licenseUrl)})}}]),t}(),y(_,"_logger",(0,e.getLogger)("PlayReady")),_),P=JSON.parse('{"shakaConfig":{"streaming":{"ignoreTextStreamFailures":true,"bufferingGoal":60,"alwaysStreamText":true},"abr":{"enabled":true,"restrictions":{}}},"forceRedirectExternalStreams":false,"trackEmsgEvents":true,"switchDynamicToStatic":false,"stallDetectionThreshold":3}'),C=a(701),x=a.n(C),I=a(236),w=a.n(I),R=a(75),M=a.n(R),D=a(182),O=a.n(D),L=a(213),N=a.n(L),U=a(774),j={attributes:{id:"@playkit-js/playkit-js-dash"}};j.styleTagTransform=N(),j.setAttributes=M(),j.insert=function(e){window.kalturaGlobalConfig&&"string"==typeof window.kalturaGlobalConfig.stylesNonce&&e.setAttribute("nonce",window.kalturaGlobalConfig.stylesNonce),document.head.appendChild(e)},j.domAPI=w(),j.insertStyleElement=O(),x()(U.Z,j),U.Z&&U.Z.locals&&U.Z.locals;var B=function(){function e(t){l(this,e),this._media=G.parseAttr(t,V.AttributeTypes.MEDIA),this._startNumber=G.parseAttr(t,V.AttributeTypes.START_NUMBER,G.parseInt,1),this._duration=G.parseAttr(t,V.AttributeTypes.DURATION,G.parseFloat),this._timescale=G.parseAttr(t,V.AttributeTypes.TIMESCALE,G.parsePositiveInt,1),this._presentationTimeOffset=G.parseAttr(t,V.AttributeTypes.PRESENTATION_TIME_OFFSET,G.parseInt,0),this._endNumber=G.parseAttr(t,V.AttributeTypes.END_NUMBER,G.parsePositiveInt)}return p(e,[{key:"media",get:function(){return this._media}},{key:"startNumber",get:function(){return this._startNumber}},{key:"duration",get:function(){return this._duration}},{key:"timescale",get:function(){return this._timescale}},{key:"presentationTimeOffset",get:function(){return this._presentationTimeOffset}},{key:"endNumber",get:function(){return this._endNumber}}]),e}();y(B,"MediaTemplateType",{REPRESENTATION:"$RepresentationID$",NUMBER:"$Number$",BANDWIDTH:"$Bandwidth$",TIME:"$Time$"});var F=function(e,t){var r=t.id,n=t.index,a=t.bitrate,i=t.time,s=e.match(/\$([a-zA-Z]+)\$/g),o=function(e,t,r){return r?e.replace(t,r):e};return s&&s.forEach((function(t){switch(t){case B.MediaTemplateType.REPRESENTATION:e=o(e,t,r);break;case B.MediaTemplateType.NUMBER:e=o(e,t,n);break;case B.MediaTemplateType.BANDWIDTH:e=o(e,t,a);break;case B.MediaTemplateType.TIME:e=o(e,t,i)}})),e},V={TagTypes:{BASE_URL:"BaseURL",SEGMENT_TEMPLATE:"SegmentTemplate",REPRESENTATION:"Representation",ESSENTIAL_PROPERTY:"EssentialProperty",ADAPTATION_SET:"AdaptationSet"},AttributeTypes:{BASE_URL:"BaseURL",ID:"id",CONTENT_TYPE:"contentType",MIME_TYPE:"mimeType",MEDIA:"media",DURATION:"duration",START_NUMBER:"startNumber",TIMESCALE:"timescale",PRESENTATION_TIME_OFFSET:"presentationTimeOffset",END_NUMBER:"endNumber",BANDWIDTH:"bandwidth",WIDTH:"width",HEIGHT:"height",SCHEME_ID_URI:"schemeIdUri",VALUE:"value"}},G={parseXml:function(e){return(new DOMParser).parseFromString(e,"text/xml")},parseAttr:function(e,t,r,n){var a=null,i=e.getAttribute(t);return null!==i&&(a=r?r(i):i),null===a?n:a},findElements:function(e,t){return e.getElementsByTagName(t)},findChild:function(e,t){var r=this.findChildren(e,t);return 1!==r.length?null:r[0]},findChildren:function(e,t){return Array.from(e.childNodes).filter((function(e){return e instanceof Element&&e.tagName===t}))},parseInt:function(e){var t=Number(e);return t%1==0?t:null},parsePositiveInt:function(e){var t=Number(e);return t%1==0&&t>0?t:null},parseFloat:function(e){var t=Number(e);return isNaN(t)?null:t}},H=function(){function e(t){l(this,e),this._schemeIdUri=G.parseAttr(t,V.AttributeTypes.SCHEME_ID_URI),this._value=G.parseAttr(t,V.AttributeTypes.VALUE)}return p(e,[{key:"schemeIdUri",get:function(){return this._schemeIdUri}},{key:"value",get:function(){return this._value}}]),e}(),K=function(){function e(t){l(this,e),this._id=G.parseAttr(t,V.AttributeTypes.ID),this._bandwidth=G.parseAttr(t,V.AttributeTypes.BANDWIDTH,parseInt),this._width=G.parseAttr(t,V.AttributeTypes.WIDTH,parseInt),this._height=G.parseAttr(t,V.AttributeTypes.HEIGHT,parseInt);var r=G.findChild(t,V.TagTypes.ESSENTIAL_PROPERTY);r&&(this._essentialProperty=new H(r))}return p(e,[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"id",get:function(){return this._id}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"essentialProperty",get:function(){return this._essentialProperty}}]),e}(),W=function(){function e(t){l(this,e),this._id=G.parseAttr(t,V.AttributeTypes.ID),this._mimeType=G.parseAttr(t,V.AttributeTypes.MIME_TYPE),this._contentType=G.parseAttr(t,V.AttributeTypes.CONTENT_TYPE),this._representations=Array.from(G.findChildren(t,V.TagTypes.REPRESENTATION)).map((function(e){return new K(e)}));var r=G.findChild(t,V.TagTypes.SEGMENT_TEMPLATE);r&&(this._segmentTemplate=new B(r));var n=G.findChild(t,V.TagTypes.ESSENTIAL_PROPERTY);n&&(this._essentialProperty=new H(n))}return p(e,[{key:"id",get:function(){return this._id}},{key:"mimeType",get:function(){return this._mimeType}},{key:"contentType",get:function(){return this._contentType}},{key:"segmentTemplate",get:function(){return this._segmentTemplate}},{key:"essentialProperty",get:function(){return this._essentialProperty}},{key:"representations",get:function(){return this._representations}}]),e}();y(W,"ContentType",{VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"});var $,z=function(){function t(r){var n,a,i=this;l(this,t),y(this,"_logger",(0,e.getLogger)("DashManifestParser")),y(this,"_parseAdaptionSets",(function(){var e=G.findElements(i._xmlDoc,V.TagTypes.BASE_URL);e&&e.length>0&&e[0].innerHTML&&(i._baseURL=e[0].textContent);var t=G.findElements(i._xmlDoc,V.TagTypes.ADAPTATION_SET),r=Array.from(t).filter((function(e){return G.parseAttr(e,V.AttributeTypes.CONTENT_TYPE)===W.ContentType.IMAGE}));r.length>0?(i._adaptationSets=r.map((function(e){return new W(e)})),i._logger.debug("Found image adaptation set",i._adaptationSets)):i._logger.debug("No image adaptations were found in manifest")})),this._logger.debug("Initialize manifest parser"),this._adaptationSets=[],(n=r instanceof ArrayBuffer?(a=r,TextDecoder?(new TextDecoder).decode(new Uint8Array(a)):null):r)&&(this._xmlDoc=G.parseXml(n))}return p(t,[{key:"parseManifest",value:function(){try{this._logger.debug("Start parsing dash manifest"),this._parseAdaptionSets(),this._logger.debug("Manifest parsing finished successfully")}catch(e){this._logger.warn("Manifest parsing failed",e)}}},{key:"getBaseUrl",value:function(){return this._baseURL||""}},{key:"getImageSet",value:function(){return this._adaptationSets.find((function(e){return e.contentType===W.ContentType.IMAGE}))}},{key:"hasImageSet",value:function(){return!!this.getImageSet()}},{key:"adaptationSets",get:function(){return this._adaptationSets}}],[{key:"isValid",value:function(){return!(!window.TextEncoder||!window.TextDecoder)}}]),t}(),q=function(){function t(n,a,i){var s=this;l(this,t),y(this,"_tracks",[]),y(this,"_parseTracks",(function(t,n,a){var i=t.representations,o=t.segmentTemplate,l=t.essentialProperty;i.forEach((function(t,i){var u,c,d=t.id,p=t.bandwidth,h=t.width,f=t.height,m=o,g=m.startNumber,y=m.duration,v=m.media,_=m.timescale,k=m.presentationTimeOffset,E=s._getEssentialValue(l,t),b=(c=2,function(e){if(Array.isArray(e))return e}(u=s._getDimensions(E))||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}(u,c)||r(u,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),T=b[0],A=b[1];s._tracks.push(new e.ImageTrack({id:d,index:i,active:!1,width:h,height:f,duration:y,rows:T,cols:A,url:s._buildTemplateUrl(v,d,n,a),customData:{bitrate:p,startNumber:g,timescale:_,presentationTimeOffset:k}}))}))})),y(this,"_getDimensions",(function(e){var t=1,r=1;if(e.includes("x")){var n=e.split("x");r=parseInt(n[0]),t=parseInt(n[1])}return[t,r]})),y(this,"_getEssentialValue",(function(e,t){return e?e.value:t.essentialProperty?t.essentialProperty.value:""})),y(this,"_buildTemplateUrl",(function(e,t,r,n){var a=r.split("/").pop(),i=r.replace(a,"");(n=n.replace(/^\.\//,"")).length>0&&!n.endsWith("/")&&(n+="/");var s="".concat(i).concat(n).concat(e);return F(s,{id:t})})),y(this,"_buildUrlFromTemplate",(function(e,t){return F(e.url,{index:t,time:(t-1)*e.duration*e.customData.timescale,bitrate:e.customData.bitrate})})),this._parseTracks(n,a,i),this._tracks.length>0&&(this._tracks.sort((function(e,t){return e.customData.bitrate-t.customData.bitrate})),this.selectTrack(this._tracks[this._tracks.length-1]))}return p(t,[{key:"selectTrack",value:function(e){this._tracks.forEach((function(t){return t.index===e.index?t.active=!0:t.active=!1}))}},{key:"getTracks",value:function(){return this._tracks}},{key:"getActiveTrack",value:function(){return this._tracks.find((function(e){return e.active}))}},{key:"getThumbnail",value:function(t){var r=this.getActiveTrack(),n=r.duration,a=r.rows,i=r.cols,s=r.sliceWidth,o=r.sliceHeight,l=r.customData,u=Math.floor(t/n)+l.startNumber,c=t%n,d=Math.floor(c*a*i/n);return new e.ThumbnailInfo({width:Math.floor(s),height:Math.floor(o),x:Math.floor(d%i)*s,y:Math.floor(d/i)*o,url:this._buildUrlFromTemplate(r,u)})}}]),t}(),Y=["startTime","endTime","id"];function X(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Z(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Q="error",J="adaptation",ee="buffering",te="drmsessionupdate",re="emsg",ne=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(v,t);var r,a,i,s,c,d=(s=v,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(s);if(c){var r=f(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}(this,e)});function v(t,r){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l(this,v),y(h(n=d.call(this,t,r,a)),"_shakaLib",T()),y(h(n),"_adapterEventsBindings",y(y(y(y(y(y(y({},Q,(function(e){return n._onError(e)})),J,(function(){return n._onAdaptation()})),ee,(function(e){return n._onBuffering(e)})),te,(function(){return n._onDrmSessionUpdate()})),re,(function(e){return n._onEmsg(e)})),e.EventType.WAITING,(function(){return n._onWaiting()})),e.EventType.PLAYING,(function(){return n._onPlaying()}))),y(h(n),"_buffering",!1),y(h(n),"_waitingSent",!1),y(h(n),"_playingSent",!1),y(h(n),"_videoSizeUpdateTimer",null),y(h(n),"_stallInterval",null),y(h(n),"VIDEO_ERROR_CODE",3016),y(h(n),"_lastTimeDetach",NaN),y(h(n),"_requestFilterError",!1),y(h(n),"_responseFilterError",!1),y(h(n),"_isDestroyInProgress",!1),y(h(n),"_errorCounter",{}),y(h(n),"_isStartOver",!0),y(h(n),"_seekRangeStart",0),y(h(n),"_isLive",!1),y(h(n),"_isStaticLive",!1),y(h(n),"_selectedVideoTrack",null),v._logger.debug("Creating adapter. Shaka version: "+T().Player.version),n._config=e.Utils.Object.mergeDeep({},P,n._config),n._init(),n}return p(v,[{key:"applyTextTrackStyles",value:function(e,t,r){e.insertRule("#".concat(r," .").concat(v.textContainerClass," { align-items: ").concat({left:"flex-start",center:"center",right:"flex-end"}[t.textAlign],"!important; }"),0),e.insertRule("#".concat(r," .").concat(v.textContainerClass," > * { ").concat(t.toCSS()," }"),0)}},{key:"setMaxBitrate",value:function(e){this._hasLowerOrEqualBitrate(e)&&this._shaka.configure({abr:{restrictions:{maxBandwidth:e}}})}},{key:"_getSortedTracks",value:function(){return this._shaka.getVariantTracks().map((function(e){return{id:e.id,bandwidth:e.bandwidth,active:e.active}})).sort((function(e,t){return e.bandwidth-t.bandwidth}))}},{key:"_hasLowerOrEqualBitrate",value:function(e){return this._getSortedTracks()[0].bandwidth<=e}},{key:"_init",value:function(){T().polyfill.installAll(),this._shaka=new(T().Player),this._config.useShakaTextTrackDisplay&&this._shaka.setVideoContainer(e.Utils.Dom.getElementBySelector(".playkit-subtitles")),this._maybeSetFilters(),this._maybeSetDrmConfig(),this._maybeBreakStalls(),this._shaka.configure(this._config.shakaConfig),this._addBindings()}},{key:"_clearStallInterval",value:function(){this._stallInterval&&(clearInterval(this._stallInterval),this._stallInterval=null)}},{key:"_stallHandler",value:function(){var e=this;this._clearStallInterval();var t=function(){return Date.now()/1e3},r=t(),n=this._videoElement.currentTime;this._stallInterval=window.setInterval((function(){t()-r>e._config.stallDetectionThreshold&&!e._videoElement.paused&&(n===e._videoElement.currentTime&&(v._logger.debug("stall found, break the stall"),e._videoElement.currentTime=parseFloat(e._videoElement.currentTime.toFixed(1))+.1),e._clearStallInterval()),n=e._videoElement.currentTime}),500)}},{key:"_maybeBreakStalls",value:function(){var t=this;this._config.forceBreakStall&&this._eventManager.listen(this._videoElement,e.EventType.SEEKING,(function(){return t._stallHandler()}))}},{key:"_maybeGetRedirectedUrl",value:function(t){var r=this._config.forceRedirectExternalStreams,n=this._config.redirectExternalStreamsTimeout,a=this._config.redirectExternalStreamsHandler;return new Promise((function(i){if(!r)return i(t);e.Utils.Http.jsonp(t,a,{timeout:n}).then((function(e){i(e)})).catch((function(){return i(t)}))}))}},{key:"_maybeSetFilters",value:function(){var t,r,n=this;"function"==typeof e.Utils.Object.getPropertyPath(this._config,"network.requestFilter")&&(v._logger.debug("Register request filter"),null===(t=this._shaka.getNetworkingEngine())||void 0===t||t.registerRequestFilter((function(t,r){if(Object.values(e.RequestType).includes(t)){var a,i={url:r.uris[0],body:r.body,headers:r.headers};try{a=n._config.network.requestFilter(t,i)}catch(e){a=Promise.reject(e)}return(a=a||Promise.resolve(i)).then((function(e){r.uris=[e.url],r.headers=e.headers,"boolean"==typeof e.withCredentials&&(r.allowCrossSiteCredentials=e.withCredentials),"POST"===r.method?r.body=e.body:e.body&&v._logger.warn("Request with ".concat(r.method," method cannot have body"))})).catch((function(e){throw n._requestFilterError=!0,e}))}}))),"function"==typeof e.Utils.Object.getPropertyPath(this._config,"network.responseFilter")&&(v._logger.debug("Register response filter"),null===(r=this._shaka.getNetworkingEngine())||void 0===r||r.registerResponseFilter((function(t,r){if(Object.values(e.RequestType).includes(t)){var a,i=r.uri,s=r.data,o=r.headers,l={url:i,originalUrl:n._sourceObj.url,data:s,headers:o};try{a=n._config.network.responseFilter(t,l)}catch(e){a=Promise.reject(e)}return(a=a||Promise.resolve(l)).then((function(e){r.data=e.data})).catch((function(e){throw n._responseFilterError=!0,e}))}})))}},{key:"_maybeSetDrmConfig",value:function(){if(this._sourceObj&&this._sourceObj.drmData){var t,r={},n=X(v._availableDrmProtocol);try{for(n.s();!(t=n.n()).done;)t.value.setDrmPlayback(r,this._sourceObj.drmData),this._config.shakaConfig.drm&&e.Utils.Object.mergeDeep(r.drm,this._config.shakaConfig.drm),e.Utils.Object.mergeDeep(this._config.shakaConfig,r)}catch(e){n.e(e)}finally{n.f()}}}},{key:"_maybeCapLevelToPlayerSize",value:function(){var e=this;if(this._config.capLevelToPlayerSize){var t=function(){return{minHeight:0,maxHeight:e._videoHeight,minWidth:0,maxWidth:e._videoWidth,minBitrate:0,maxBitrate:1/0}};this._clearVideoUpdateTimer(),this._videoSizeUpdateTimer=window.setInterval((function(){return e._updateRestriction(t())}),1e3),this._updateRestriction(t())}}},{key:"_maybeApplyAbrRestrictions",value:function(){this._config.capLevelToPlayerSize||(this._clearVideoUpdateTimer(),e.Utils.Object.hasPropertyPath(this._config,"abr.restrictions")&&this._updateRestriction(this._config.abr.restrictions))}},{key:"_updateRestriction",value:function(e){var t=this._getRestrictionShakaConfig(e);this._shaka.configure({abr:{restrictions:t}})}},{key:"_getRestrictionShakaConfig",value:function(e){var t=this,r=function(e){var r=t._getVideoTracks();return Math.min.apply(null,r.map((function(t){return t[e]})))},n={};if(e){var a=e.maxHeight,i=e.maxWidth,s=e.maxBitrate,o=e.minHeight,l=e.minWidth,u=e.minBitrate,c=Math.max(o,0),d=Math.max(a,r("height"));d>=c?(n.minHeight=c,n.maxHeight=d):v._logger.warn("Invalid maxHeight restriction, maxHeight must be greater than minHeight",o,a);var p=Math.max(l,0),h=Math.max(i,r("width"));h>=p?(n.minWidth=p,n.maxWidth=h):v._logger.warn("Invalid maxWidth restriction, maxWidth must be greater than minWidth",l,i);var f=Math.max(u,0),m=Math.max(s,r("bandwidth"));m>=f?(n.minBandwidth=f,n.maxBandwidth=m):v._logger.warn("Invalid maxBitrate restriction, maxBitrate must be greater than minBitrate",u,s)}return n}},{key:"attachMediaSource",value:function(){this._shaka||(this._videoElement&&this._videoElement.src&&(e.Utils.Dom.setAttribute(this._videoElement,"src",""),e.Utils.Dom.removeAttribute(this._videoElement,"src")),this._init())}},{key:"detachMediaSource",value:function(){var e=this;return this._shaka?(0===Math.floor(this.duration-this.currentTime)?this._lastTimeDetach=0:this.currentTime>0&&(this._lastTimeDetach=this.currentTime),this._reset().then((function(){e._shaka=null,e._loadPromise=void 0}))):Promise.resolve()}},{key:"_clearVideoUpdateTimer",value:function(){this._videoSizeUpdateTimer&&(clearInterval(this._videoSizeUpdateTimer),this._videoSizeUpdateTimer=null)}},{key:"_videoWidth",get:function(){var e,t=this._videoElement;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=this._contentScaleFactor),e}},{key:"_videoHeight",get:function(){var e,t=this._videoElement;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=this._contentScaleFactor),e}},{key:"_contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){v._logger.debug("failed reading devicePixelRatio, assume 1")}return e}},{key:"_addBindings",value:function(){var t,r=this;this._eventManager.listen(this._shaka,J,this._adapterEventsBindings.adaptation),this._eventManager.listen(this._shaka,Q,this._adapterEventsBindings.error),this._eventManager.listen(this._shaka,te,this._adapterEventsBindings.drmsessionupdate),this._eventManager.listen(this._videoElement,e.EventType.WAITING,this._adapterEventsBindings.waiting),this._eventManager.listen(this._videoElement,e.EventType.PLAYING,this._adapterEventsBindings.playing),this._eventManager.listen(this._videoElement,e.EventType.LOADED_DATA,(function(){return r._onLoadedData()})),this._eventManager.listenOnce(this._videoElement,e.EventType.PLAYING,(function(){r._eventManager.listen(r._shaka,ee,r._adapterEventsBindings.buffering)})),this._config.trackEmsgEvents&&this._eventManager.listen(this._shaka,re,this._adapterEventsBindings.emsg),null===(t=this._shaka.getNetworkingEngine())||void 0===t||t.registerResponseFilter((function(t,n){switch(t){case T().net.NetworkingEngine.RequestType.SEGMENT:r._trigger(e.EventType.FRAG_LOADED,{miliSeconds:n.timeMs,bytes:n.data.byteLength,url:n.uri}),r.isLive()&&r._dispatchNativeEvent(e.EventType.DURATION_CHANGE);break;case T().net.NetworkingEngine.RequestType.MANIFEST:r._parseManifest(n.data),r._playbackActualUri=n.uri,r._trigger(e.EventType.MANIFEST_LOADED,{miliSeconds:n.timeMs}),setTimeout((function(){var e,t;r._isLive=r._isLive||(null===(e=r._shaka)||void 0===e?void 0:e.isLive()),!r._isLive||null!==(t=r._shaka)&&void 0!==t&&t.isLive()||r._isStaticLive||!r._config.switchDynamicToStatic||(r._sourceObj.url=n.uri,r._switchFromDynamicToStatic())}))}}))}},{key:"_onLoadedData",value:function(){var e=this;this._setLowLatencyMode();var t=this.getSegmentDuration();this._seekRangeStart=this._shaka.seekRange().start,this._startOverTimeout=window.setTimeout((function(){e._shaka.seekRange().start-e._seekRangeStart>=t&&(e._isStartOver=!1)}),1e3*(t+1))}},{key:"_switchFromDynamicToStatic",value:(i=o(E().mark((function t(){var r,n,a;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v._logger.info("Switching from dynamic manifest to static"),this._dispatchNativeEvent(e.EventType.WAITING),r=this._videoElement.currentTime-this._seekRangeStart,n=this.isAdaptiveBitrateEnabled(),a=this._videoElement.paused,t.next=7,this.detachMediaSource();case 7:return this._isStaticLive=!0,this._isLive=!0,this.attachMediaSource(),t.next=12,this.load();case 12:this._videoElement.currentTime=r,a||this._videoElement.play(),n?this._onAdaptation():this._selectedVideoTrack&&this.selectVideoTrack(this._selectedVideoTrack);case 15:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"_setLowLatencyMode",value:function(){this._shaka.configure({streaming:{lowLatencyMode:"boolean"==typeof this._config.lowLatencyMode?this._config.lowLatencyMode:this.isLive()}})}},{key:"_parseManifest",value:function(e){!this._manifestParser&&z.isValid()&&(v._logger.debug("Creating parser for the first time"),this._manifestParser=new z(e),this._manifestParser.parseManifest())}},{key:"load",value:(a=o(E().mark((function t(r){var n=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._loadPromise){t.next=5;break}return t.next=3,this._removeMediaKeys();case 3:this._shaka.attach(this._videoElement),this._loadPromise=new Promise((function(t,a){if(n._sourceObj&&n._sourceObj.url){n._trigger(e.EventType.ABR_MODE_CHANGED,{mode:n.isAdaptiveBitrateEnabled()?"auto":"manual"});var i="number"==typeof r&&r>-1?r:void 0;i=isNaN(n._lastTimeDetach)?i:n._lastTimeDetach,n._lastTimeDetach=NaN,n._maybeGetRedirectedUrl(n._sourceObj.url).then((function(e){return n._shaka.load(e,i)})).then((function(){var e={tracks:n._getParsedTracks()};n._maybeCapLevelToPlayerSize(),v._logger.debug("The source has been loaded successfully"),t(e)})).catch((function(t){a(new e.Error(n._isDestroyInProgress?e.Error.Severity.RECOVERABLE:t.severity,t.category,t.code,t.data))}))}}));case 5:return t.abrupt("return",this._loadPromise);case 6:case"end":return t.stop()}}),t,this)}))),function(e){return a.apply(this,arguments)})},{key:"destroy",value:function(){var e=this;return this._isDestroyInProgress=!0,new Promise((function(t,r){m(f(v.prototype),"destroy",e).call(e).then((function(){v._logger.debug("destroy"),e._loadPromise=void 0,e._adapterEventsBindings={},e._reset().then((function(r){e._isDestroyInProgress=!1,t(r)})).catch((function(t){e._isDestroyInProgress=!1,r(t)}))}))}))}},{key:"getThumbnail",value:function(e){return this._thumbnailController?this._thumbnailController.getThumbnail(e):null}},{key:"_reset",value:function(){return this._buffering=!1,this._waitingSent=!1,this._playingSent=!1,this._isLive=!1,this._isStaticLive=!1,this._requestFilterError=!1,this._responseFilterError=!1,this._manifestParser=null,this._thumbnailController=null,this._errorCounter={},this._clearStallInterval(),this._clearVideoUpdateTimer(),clearTimeout(this._startOverTimeout),this._eventManager&&this._eventManager.removeAll(),this._shaka?this._shaka.destroy():Promise.resolve()}},{key:"_removeMediaKeys",value:(r=o(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._videoElement||!this._videoElement.mediaKeys){e.next=16;break}return e.prev=1,v._logger.debug("Removing mediaKeys from the video element"),e.next=5,this._videoElement.setMediaKeys(null);case 5:v._logger.debug("mediaKeys removed"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),v._logger.warn("mediaKeys not cleared");case 11:return e.prev=11,e.abrupt("return",Promise.resolve());case 14:e.next=17;break;case 16:return e.abrupt("return",Promise.resolve());case 17:case"end":return e.stop()}}),e,this,[[1,8,11,14]])}))),function(){return r.apply(this,arguments)})},{key:"_getVideoTracks",value:function(){var e=this._shaka.getVariantTracks(),t=this._getActiveTrack();return e.filter((function(e){return e.audioId===t.audioId}))}},{key:"_getActiveTrack",value:function(){return this._shaka.getVariantTracks().find((function(e){return e.active}))}},{key:"_getAudioTracks",value:function(){var t=this._shaka.getVariantTracks(),r=this._shaka.getAudioLanguagesAndRoles();return r.forEach((function(r){var n=t.filter((function(e){return e.language===r.language&&(!r.role||!e.audioRoles||e.audioRoles.includes(r.role))})),a=n.map((function(e){return e.id})).join("_"),i=n.some((function(e){return e.active})),s=n.some((function(e){return e.accessibilityPurpose}));r.id=a,r.label=n[0].label,r.active=i,r.kind=s?e.AudioTrackKind.DESCRIPTION:e.AudioTrackKind.MAIN})),r}},{key:"_getParsedTracks",value:function(){if(this._shaka){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),r=this._getParsedTextTracks(),a=this._getParsedImageTracks();return[].concat(n(e),n(t),n(r),n(a))}return[]}},{key:"_getParsedVideoTracks",value:function(){var t=this._getVideoTracks(),r=[];if(t)for(var n=0;n<t.length;n++){var a={id:t[n].id,bandwidth:t[n].videoBandwidth||t[n].bandwidth,width:t[n].width,height:t[n].height,active:t[n].active,index:n};r.push(new e.VideoTrack(a))}return r}},{key:"_getParsedAudioTracks",value:function(){var t=this._getAudioTracks(),r=[];if(t)for(var n=0;n<t.length;n++){var a={id:t[n].id,active:t[n].active,label:t[n].label,language:t[n].language,index:n,kind:t[n].kind};r.push(new e.AudioTrack(a))}return r}},{key:"_getParsedTextTracks",value:function(){var t,r=[],n=X(this._shaka.getTextTracks());try{for(n.s();!(t=n.n()).done;){var a=t.value,i=a.kind?a.kind+"s":"";i=""===i&&this._config.useShakaTextTrackDisplay?"captions":i;var s={id:a.id,kind:i,active:!1,default:a.primary,label:a.label,language:a.language};r.push(new e.TextTrack(s))}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"_getParsedImageTracks",value:function(){var e,t,r=null===(e=this._manifestParser)||void 0===e?void 0:e.getImageSet(),n=(null===(t=this._manifestParser)||void 0===t?void 0:t.getBaseUrl())||"";return r?(this._thumbnailController=new q(r,this._playbackActualUri,n),this._thumbnailController.getTracks()):[]}},{key:"selectVideoTrack",value:function(t){if(this._shaka){var r=this._getVideoTracks();if(t instanceof e.VideoTrack&&r){var n=r[t.index];n&&(this.isAdaptiveBitrateEnabled()&&(this._shaka.configure({abr:{enabled:!1}}),this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:"manual"})),n.active||(this._selectedVideoTrack=t,this._shaka.selectVariantTrack(r[t.index],!0),this._onTrackChanged(t)))}}}},{key:"selectAudioTrack",value:function(t){this._shaka&&t instanceof e.AudioTrack&&!t.active&&(this._shaka.selectAudioLanguage(t.language),this._onTrackChanged(t))}},{key:"selectTextTrack",value:function(t){this._shaka&&t instanceof e.TextTrack&&!t.active&&("subtitles"===t.kind||"captions"===t.kind)&&(this._shaka.setTextTrackVisibility(this._config.textTrackVisibile),this._shaka.selectTextLanguage(t.language),this._onTrackChanged(t))}},{key:"selectImageTrack",value:function(t){this._shaka&&this._thumbnailController&&t instanceof e.ImageTrack&&!t.active&&(this._thumbnailController.selectTrack(t),this._onTrackChanged(t))}},{key:"hideTextTrack",value:function(){this._shaka&&this._shaka.setTextTrackVisibility(!1)}},{key:"enableAdaptiveBitrate",value:function(){this._shaka&&!this.isAdaptiveBitrateEnabled()&&(this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:"auto"}),this._shaka.configure({abr:{enabled:!0}}))}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._shaka&&this._shaka.getConfiguration().abr.enabled}},{key:"applyABRRestriction",value:function(t){if(e.Utils.Object.createPropertyPath(this._config,"abr.restrictions",t),this._maybeApplyAbrRestrictions(),!this.isAdaptiveBitrateEnabled()){var r=this._getParsedVideoTracks(),n=(0,e.filterTracksByRestriction)(r,this._config.abr.restrictions);n.length&&(n.find((function(e){return e.active}))||this.selectVideoTrack(n[0]))}}},{key:"_getLiveEdge",value:function(){return this._shaka?this._shaka.seekRange().end:NaN}},{key:"seekToLiveEdge",value:function(){this._shaka&&this._videoElement.readyState>0&&(this._videoElement.currentTime=this._getLiveEdge())}},{key:"isLive",value:function(){var e;return(null===(e=this._shaka)||void 0===e?void 0:e.isLive())||this._isLive}},{key:"liveDuration",get:function(){return this._getLiveEdge()}},{key:"getSegmentDuration",value:function(){return this._shaka?this._shaka.getStats().maxSegmentDuration:0}},{key:"_onAdaptation",value:function(){var e=this._getParsedVideoTracks().find((function(e){return e.active}));this._onTrackChanged(e)}},{key:"_onError",value:function(t){if(t&&t.detail){var r=t.detail;if(r.code===this.VIDEO_ERROR_CODE)return;(this._requestFilterError||this._responseFilterError)&&r.data[0]instanceof T().util.Error&&(r=r.data[0],this._requestFilterError?this._requestFilterError=!1:this._responseFilterError=!1),r.severity=this._shouldErrorChangeSeverity(r.code)?e.Error.Severity.CRITICAL:r.severity,this._trigger(e.EventType.ERROR,new e.Error(r.severity,r.category,r.code,r.data)),v._logger.error(r),r.severity===e.Error.Severity.CRITICAL&&this.destroy()}}},{key:"_shouldErrorChangeSeverity",value:function(e){var t=function(){return Date.now()/1e3};return e in this._errorCounter?(this._errorCounter[e].count+=1,this._errorCounter[e].count>3?(delete this._errorCounter[e],!0):t()-this._errorCounter[e].timeStamp>30&&(this._errorCounter[e].timeStamp=t(),this._errorCounter[e].count=1,!1)):(this._errorCounter[e]={count:1,timeStamp:t()},!1)}},{key:"_onBuffering",value:function(t){t.buffering?this._waitingSent||(this._dispatchNativeEvent(e.EventType.WAITING),this._buffering=!0):(this._buffering=!1,this._videoElement.paused||this._playingSent||this._dispatchNativeEvent(e.EventType.PLAYING))}},{key:"_dispatchNativeEvent",value:function(e){var t;"function"==typeof window.Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),this._videoElement.dispatchEvent(t)}},{key:"_onDrmSessionUpdate",value:function(){var t;this._trigger(e.EventType.DRM_LICENSE_LOADED,{licenseTime:this._shaka.getStats().licenseTime,scheme:null===(t=this._shaka.drmInfo())||void 0===t?void 0:t.keySystem})}},{key:"_onEmsg",value:function(t){var r=t.detail,n=t.type,a=Array.from(this._videoElement.textTracks).find((function(e){return e.label===n}));a||(a=this._videoElement.addTextTrack(e.TextTrack.KIND.METADATA,n));var i=r.startTime,s=r.endTime,o=r.id,l=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(r,Y),u=new e.TimedMetadata(i,s,o,e.TimedMetadata.TYPE.EMSG,l),c=(0,e.createTextTrackCue)(u);a.addCue(c),this._trigger(e.EventType.TIMED_METADATA_ADDED,{cues:[u]})}},{key:"_onWaiting",value:function(){this._waitingSent=!0,this._playingSent=!1}},{key:"_onPlaying",value:function(){this._playingSent=!0,this._waitingSent=!1,this._buffering&&this._dispatchNativeEvent(e.EventType.WAITING)}},{key:"getStartTimeOfDvrWindow",value:function(){return this.isLive()&&this._shaka?(this._isStartOver?this._seekRangeStart:this._shaka.seekRange().start)+this._shaka.getConfiguration().streaming.safeSeekOffset:0}},{key:"targetBuffer",get:function(){var e=NaN;return this._shaka?(e=this.isLive()?this._getLiveEdge()-this._videoElement.currentTime:this._videoElement.duration-this._videoElement.currentTime,e=Math.min(e,this._shaka.getConfiguration().streaming.bufferingGoal+this._shaka.getStats().maxSegmentDuration)):NaN}},{key:"getDrmInfo",value:function(){var e=this._shaka.drmInfo();if(e){var t=e.licenseServerUri,r=e.keySystem,n=e.serverCertificateUri,a={licenseUrl:t,scheme:r};return n&&(a.certificate=n),a}return null}}],[{key:"createAdapter",value:function(t,r,n){var a=e.Utils.Object.copyDeep(P);if(e.Utils.Object.hasPropertyPath(n,"text.useNativeTextTrack")&&(a.textTrackVisibile=e.Utils.Object.getPropertyPath(n,"text.useNativeTextTrack")),e.Utils.Object.hasPropertyPath(n,"text.useShakaTextTrackDisplay")&&(a.useShakaTextTrackDisplay=e.Utils.Object.getPropertyPath(n,"text.useShakaTextTrackDisplay"),a.textTrackVisibile=a.textTrackVisibile||a.useShakaTextTrackDisplay),e.Utils.Object.hasPropertyPath(n,"streaming")){var i=n.streaming;"boolean"==typeof i.forceBreakStall&&(a.forceBreakStall=i.forceBreakStall),"number"==typeof i.stallDetectionThreshold&&(a.stallDetectionThreshold=Math.max(2,i.stallDetectionThreshold)),"boolean"==typeof i.lowLatencyMode&&(a.lowLatencyMode=i.lowLatencyMode),"boolean"==typeof i.trackEmsgEvents&&(a.trackEmsgEvents=i.trackEmsgEvents),"boolean"==typeof i.switchDynamicToStatic&&(a.switchDynamicToStatic=i.switchDynamicToStatic)}if(e.Utils.Object.hasPropertyPath(n,"sources.options")){var s=n.sources.options;a.forceRedirectExternalStreams=s.forceRedirectExternalStreams,a.redirectExternalStreamsHandler=s.redirectExternalStreamsHandler,a.redirectExternalStreamsTimeout=s.redirectExternalStreamsTimeout}if(e.Utils.Object.hasPropertyPath(n,"abr")){var o=n.abr;"boolean"==typeof o.enabled&&(a.shakaConfig.abr.enabled=o.enabled),"boolean"==typeof o.capLevelToPlayerSize&&(a.capLevelToPlayerSize=o.capLevelToPlayerSize),o.defaultBandwidthEstimate&&(a.shakaConfig.abr.defaultBandwidthEstimate=o.defaultBandwidthEstimate),o.restrictions&&e.Utils.Object.createPropertyPath(a,"abr.restrictions",o.restrictions)}return e.Utils.Object.hasPropertyPath(n,"playback.options.html5.dash")&&(e.Utils.Object.mergeDeep(a.shakaConfig,n.playback.options.html5.dash),e.Utils.Object.hasPropertyPath(a.shakaConfig,"manifest.dash.defaultPresentationDelay")&&(a.shakaConfig.manifest.defaultPresentationDelay=a.shakaConfig.manifest.dash.defaultPresentationDelay,delete a.shakaConfig.manifest.dash.defaultPresentationDelay)),a.network=n.network,new this(t,r,a)}},{key:"canPlayType",value:function(e){var t="string"==typeof e&&e.toLowerCase()===v._dashMimeType&&v.isMSESupported();return v._logger.debug("canPlayType result for mimeType: "+e+" is "+t.toString()),t}},{key:"canPlayDrm",value:function(e,t){v._availableDrmProtocol=[];var r,n=X(v._drmProtocols);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.isConfigured(e,t)){v._availableDrmProtocol.push(a);break}}}catch(e){n.e(e)}finally{n.f()}if(!v._availableDrmProtocol.length){var i,s=X(v._drmProtocols);try{for(s.s();!(i=s.n()).done;){var o=i.value;o.canPlayDrm(e)&&v._availableDrmProtocol.push(o)}}catch(e){s.e(e)}finally{s.f()}}return!!v._availableDrmProtocol.length}},{key:"isSupported",value:function(){var e=T().Player.isBrowserSupported();return v._logger.debug("isSupported:"+e),e}}]),v}(e.BaseMediaSourceAdapter);$=ne,y(ne,"id","DashAdapter"),y(ne,"_logger",e.BaseMediaSourceAdapter.getLogger($.id)),y(ne,"textContainerClass","shaka-text-container"),y(ne,"_dashMimeType","application/dash+xml"),y(ne,"_drmProtocols",[A,S]),y(ne,"_availableDrmProtocol",[]);var ae="1.39.1",ie="@playkit-js/playkit-js-dash",se=ne;ne.isSupported()&&(0,e.registerMediaSourceAdapter)(ne)}(),i}())},305:(module,e,t)=>{var r,n;self,module.exports=(r=t(538),n=t(718),function(){"use strict";var e={230:function(e){e.exports=r},85:function(e){e.exports=n}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,a),i.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){a.r(i),a.d(i,{NAME:function(){return I},VERSION:function(){return x},default:function(){return w}});var e=a(230);function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function l(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===o(t)?t:String(t)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function c(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?e:r):a.value}},h.apply(this,arguments)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function g(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}function y(e,t,r){return(t=l(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v,_,k=a(85),E=a.n(k),b=JSON.parse('{"recoverDecodingErrorDelay":3000,"recoverSwapAudioCodecDelay":3000,"abr":{"enabled":true,"restrictions":{}},"hlsConfig":{"fragLoadingMaxRetry":4,"maxMaxBufferLength":60,"stretchShortVideoTrack":true},"network":{}}'),T=(y(y(y(y(y(y(y(y(y(y(v={},E().ErrorDetails.MANIFEST_LOAD_ERROR,{category:e.Error.Category.MANIFEST,code:e.Error.Code.HTTP_ERROR}),E().ErrorDetails.MANIFEST_LOAD_TIMEOUT,{category:e.Error.Category.MANIFEST,code:e.Error.Code.TIMEOUT}),E().ErrorDetails.MANIFEST_PARSING_ERROR,{category:e.Error.Category.MANIFEST,code:e.Error.Code.HLSJS_CANNOT_PARSE}),E().ErrorDetails.LEVEL_LOAD_ERROR,{category:e.Error.Category.NETWORK,code:e.Error.Code.HTTP_ERROR}),E().ErrorDetails.LEVEL_LOAD_TIMEOUT,{category:e.Error.Category.NETWORK,code:e.Error.Code.TIMEOUT}),E().ErrorDetails.LEVEL_SWITCH_ERROR,{category:e.Error.Category.PLAYER,code:e.Error.Code.BITRATE_SWITCH_ISSUE}),E().ErrorDetails.FRAG_LOAD_ERROR,{category:e.Error.Category.NETWORK,code:e.Error.Code.HTTP_ERROR}),E().ErrorDetails.FRAG_LOAD_TIMEOUT,{category:e.Error.Category.NETWORK,code:e.Error.Code.TIMEOUT}),E().ErrorDetails.FRAG_PARSING_ERROR,{category:e.Error.Category.MEDIA,code:e.Error.Code.HLS_FRAG_PARSING_ERROR}),E().ErrorDetails.BUFFER_APPEND_ERROR,{category:e.Error.Category.MEDIA,code:e.Error.Code.HLS_BUFFER_APPEND_ISSUE}),y(y(v,E().ErrorDetails.BUFFER_APPENDING_ERROR,{category:e.Error.Category.MEDIA,code:e.Error.Code.HLS_BUFFER_APPENDING_ISSUE}),E().ErrorDetails.BUFFER_STALLED_ERROR,{category:e.Error.Category.MEDIA,code:e.Error.Code.HLS_BUFFER_STALLED_ERROR})),A=function(e){m(a,e);var t,r,n=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return g(this,e)});function a(e){var t;return s(this,a),t=n.call(this,e),e&&e.readystatechange&&(t.readystatechange=e.readystatechange),t}return c(a,[{key:"loadInternal",value:function(){var e,t=this,r=this.context;e=this.loader=new XMLHttpRequest;var n=this.stats;n.tfirst=0,n.loaded=0;var a,i=this.xhrSetup;try{if(i)try{a=i(e,r.url,r)}catch(t){e.open("GET",r.url,!0),a=i(e,r.url,r)}e.readyState||e.open("GET",r.url,!0)}catch(e){a=Promise.reject(e)}(a=a||Promise.resolve()).then((function(){r.rangeEnd&&e.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1)),e.onreadystatechange=t.readystatechange.bind(t),e.onprogress=t.loadprogress.bind(t),e.responseType=r.responseType,t.requestTimeout=window.setTimeout(t.loadtimeout.bind(t),t.config.timeout),e.send()})).catch((function(n){t.callbacks.onError({code:e.status,text:n.message},r,e)}))}}]),a}(E().DefaultConfig.loader),S=function(t){m(i,t);var r,n,a=(r=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(n){var a=p(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return g(this,e)});function i(t){var r;s(this,i);var n=(r=a.call(this,t)).load.bind(d(r)),o=i.redirectExternalStreamsHandler;return r.load=function(t,r,a){var s=t.url;"manifest"===t.type?e.Utils.Http.jsonp(s,o,{timeout:i.redirectExternalStreamsTimeout}).then((function(e){t.url=e,n(t,r,a)})).catch((function(){return n(t,r,a)})):n(t,r,a)},r}return c(i)}(A);function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}y(S,"redirectExternalStreamsHandler",(function(e,t){return t}));var C=function(a){m(u,a);var i,o,l=(i=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(i);if(o){var r=p(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return g(this,e)});function u(t,r,n){var a;return s(this,u),y(d(a=l.call(this,t,r,n)),"_hlsjsLib",E()),y(d(a),"_triedReloadWithRedirect",!1),y(d(a),"_playerTracks",[]),y(d(a),"_startTime",0),y(d(a),"_requestFilterError",!1),y(d(a),"_responseFilterError",!1),y(d(a),"_nativeTextTracksMap",{}),y(d(a),"_lastLoadedFragSN",-1),y(d(a),"_sameFragSNLoadedCount",0),y(d(a),"_waitForSubtitleLoad",!0),y(d(a),"_adapterEventsBindings",y(y(y(y(y(y(y(y(y({},E().Events.ERROR,(function(e,t){return a._onError(t)})),E().Events.MANIFEST_LOADED,(function(e,t){return a._onManifestLoaded(t)})),E().Events.LEVEL_SWITCHED,(function(e,t){return a._onLevelSwitched(e,t)})),E().Events.AUDIO_TRACK_SWITCHED,(function(e,t){return a._onAudioTrackSwitched(e,t)})),E().Events.FPS_DROP,(function(e,t){return a._onFpsDrop(t)})),E().Events.FRAG_PARSING_METADATA,(function(e,t){return a._onFragParsingMetadata(t)})),E().Events.FRAG_LOADED,(function(e,t){return a._onFragLoaded(t)})),E().Events.MEDIA_ATTACHED,(function(){return a._onMediaAttached()})),E().Events.LEVEL_LOADED,(function(e,t){return a._onLevelLoaded(e,t)}))),y(d(a),"_onLevelLoaded",(function(t,r){if(a.isLive()){var n=r.details.endSN;if(a._lastLoadedFragSN===n){if(a._sameFragSNLoadedCount++,u._logger.debug("Same frag SN. Count is: ".concat(a._sameFragSNLoadedCount,", Max is: ").concat(a._config.network.maxStaleLevelReloads)),a._sameFragSNLoadedCount>=a._config.network.maxStaleLevelReloads){u._logger.error("Same frag loading reached max count");var i=new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.NETWORK,e.Error.Code.LIVE_MANIFEST_REFRESH_ERROR,{fragSN:n});return a._trigger(e.EventType.ERROR,i),a.destroy()}u._logger.debug("Last frag SN is: ".concat(n))}else a._sameFragSNLoadedCount=0;a._lastLoadedFragSN=n}})),u._logger.debug("Creating adapter. Hls version: "+E().version),a._config=e.Utils.Object.mergeDeep({},b,a._config),a._init(),a}return c(u,[{key:"_init",value:function(){this._config.forceRedirectExternalStreams&&(this._config.hlsConfig.pLoader=S),this._maybeSetFilters(),this._hls=new(E())(this._config.hlsConfig),this._capabilities.fpsControl=!0,this._hls.subtitleDisplay=this._config.subtitleDisplay,this._addBindings()}},{key:"_maybeSetFilters",value:function(){var n=this;if("function"==typeof e.Utils.Object.getPropertyPath(this._config,"network.requestFilter")&&(u._logger.debug("Register request filter"),e.Utils.Object.mergeDeep(this._config.hlsConfig,{loader:A,xhrSetup:function(a,i,s){var o,l={url:i,body:null,headers:{}};try{"manifest"===s.type&&(o=n._config.network.requestFilter(e.RequestType.MANIFEST,l)),s.frag&&"subtitle"!==s.frag.type&&(o=n._config.network.requestFilter(e.RequestType.SEGMENT,l))}catch(e){o=Promise.reject(e)}return(o=o||Promise.resolve(l)).then((function(e){s.url=e.url,a.open("GET",e.url,!0),Object.entries(e.headers).forEach((function(e){var n;a.setRequestHeader.apply(a,function(e){if(Array.isArray(e))return t(e)}(n=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||r(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())})),"boolean"==typeof e.withCredentials&&(a.withCredentials=e.withCredentials)})).catch((function(e){throw n._requestFilterError=!0,e}))}})),"function"==typeof e.Utils.Object.getPropertyPath(this._config,"network.responseFilter")){var a=this;u._logger.debug("Register response filter"),e.Utils.Object.mergeDeep(this._config.hlsConfig,{loader:A,readystatechange:function(t){var r=this,n=t.currentTarget,i=n.readyState,s=this.stats,o=this.context,l=this.config;if(!s.aborted&&i>=2){window.clearTimeout(this.requestTimeout);var c=s.loading;if(0===c.first&&(c.first=Math.max(performance.now(),c.start)),4===i){var d=n.status;if(d>=200&&d<300){var p,h;c.end=Math.max(s.tfirst,performance.now()),h="arraybuffer"===o.responseType?(p=n.response).byteLength:(p=n.responseText).length,s.loaded=s.total=h;var f,m={url:n.responseURL,originalUrl:o.url,data:p,headers:e.Utils.Http.convertHeadersToDictionary(n.getAllResponseHeaders())};try{"manifest"===o.type&&(f=a._config.network.responseFilter(e.RequestType.MANIFEST,m)),o.frag&&"subtitle"!==o.frag.type&&(f=a._config.network.responseFilter(e.RequestType.SEGMENT,m))}catch(e){f=Promise.reject(e)}return(f=f||Promise.resolve(m)).then((function(e){r.callbacks.onSuccess(e,s,o,n)})).catch((function(e){a._responseFilterError=!0,r.callbacks.onError({code:d,text:e.message},o,n)}))}s.retry>=l.maxRetry||d>=400&&d<499?(u._logger.error("".concat(d," while loading ").concat(o.url)),this.callbacks.onError({code:d,text:n.statusText},o,n)):(u._logger.warn("".concat(d," while loading ").concat(o.url,", retrying in ").concat(this.retryDelay,"...")),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,l.maxRetryDelay),s.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),l.timeout)}}})}}},{key:"_addBindings",value:function(){var e=this;this._mediaAttachedPromise=new Promise((function(t){return e._onMediaAttached=t}));for(var t=0,r=Object.entries(this._adapterEventsBindings);t<r.length;t++){var a=n(r[t],2),i=a[0],s=a[1];this._hls.on(i,s)}this._onRecoveredCallback=function(){return e._onRecovered()},this._onAddTrack=this._onAddTrack.bind(this),this._eventManager.listen(this._videoElement,"addtrack",this._onAddTrack),this._videoElement.textTracks.onaddtrack=this._onAddTrack}},{key:"_onFpsDrop",value:function(t){this._trigger(e.EventType.FPS_DROP,t)}},{key:"_onFragParsingMetadata",value:function(t){var r;this._trigger("hlsFragParsingMetadata",t);var n=Array.from(null===(r=this._videoElement)||void 0===r?void 0:r.textTracks).find((function(e){return"id3"===e.label})),a=Array.from((null==n?void 0:n.cues)||[]),i=[];null==t||t.samples.forEach((function(t){var r=e.Utils.binarySearch(a,(function(e){return e.startTime-t.pts}));if(r){var n=(0,e.createTimedMetadata)(r);i.push(n)}})),i.length&&this._trigger(e.EventType.TIMED_METADATA_ADDED,{cues:i})}},{key:"_onAddTrack",value:function(t){if(!this._hls.subtitleTracks.length){var r=this._parseCEATextTrack(t.track);r&&(u._logger.debug("A CEA 608/708 caption has been found",r),this._playerTracks.push(r),this._trigger(e.EventType.TRACKS_CHANGED,{tracks:this._playerTracks}))}}},{key:"attachMediaSource",value:function(){this._hls||(this._videoElement&&this._videoElement.src&&(e.Utils.Dom.setAttribute(this._videoElement,"src",""),e.Utils.Dom.removeAttribute(this._videoElement,"src")),this._init())}},{key:"detachMediaSource",value:function(){var t;this._hls&&(0===Math.floor(this.duration-this.currentTime)?this._config.hlsConfig.startPosition=0:this.currentTime>0&&(this._config.hlsConfig.startPosition=this.currentTime),this._reset(),null===(t=this._loadPromiseHandlers)||void 0===t||t.reject(new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.PLAYER,e.Error.Code.HLS_FATAL_MEDIA_ERROR,"media detached while loading")),this._loadPromiseHandlers=null,this._loadPromise=void 0,this._hls=null)}},{key:"handleMediaError",value:function(e){return e.code===e.MEDIA_ERR_DECODE&&(u._logger.debug("The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",e.message),this._handleMediaError(E().ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR))}},{key:"load",value:function(e){var t=this;return this._loadPromise||(this._startTime=e,this._loadPromise=new Promise((function(e,r){t._loadPromiseHandlers={resolve:e,reject:r},t._loadInternal()}))),this._loadPromise}},{key:"_loadInternal",value:function(){var t;this._hls&&this._sourceObj&&this._sourceObj.url?(this._hls.loadSource(this._sourceObj.url),this._hls.attachMedia(this._videoElement),this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:this.isAdaptiveBitrateEnabled()?"auto":"manual"})):null===(t=this._loadPromiseHandlers)||void 0===t||t.reject(new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.PLAYER,e.Error.Code.HLS_FATAL_MEDIA_ERROR,"no url provided"))}},{key:"_reloadWithDirectManifest",value:function(){this._triedReloadWithRedirect=!0,this._reset(),this._config.hlsConfig.pLoader=S,this._hls=new(E())(this._config.hlsConfig),this._addBindings(),this._loadInternal()}},{key:"destroy",value:function(){var t=this;return new Promise((function(r,n){h(p(u.prototype),"destroy",t).call(t).then((function(){var n;u._logger.debug("destroy"),t._playerTracks=[],t._nativeTextTracksMap={},t._sameFragSNLoadedCount=0,t._lastLoadedFragSN=-1,null===(n=t._loadPromiseHandlers)||void 0===n||n.reject(new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.PLAYER,e.Error.Code.HLS_FATAL_MEDIA_ERROR,"The adapter has been destroyed while loading")),t._loadPromiseHandlers=null,t._loadPromise=void 0,t._reset(),r()}),(function(){return n()}))}))}},{key:"_reset",value:function(){this._removeBindings(),this._requestFilterError=!1,this._responseFilterError=!1,this._hls.detachMedia(),this._hls.destroy()}},{key:"_parseTracks",value:function(){var e=this._parseAudioTracks(this._hls.audioTracks||[]),t=this._parseVideoTracks(this._hls.levels||[]),r=this._parseTextTracks(this._hls.subtitleTracks||[]);return e.concat(t).concat(r)}},{key:"_parseAudioTracks",value:function(t){for(var r=[],n=0;n<t.length;n++){var a={id:t[n].id,active:this._hls.audioTrack===t[n].id,label:t[n].name,language:t[n].lang,index:n,kind:t[n].characteristics?e.AudioTrackKind.DESCRIPTION:e.AudioTrackKind.MAIN};r.push(new e.AudioTrack(a))}return r}},{key:"_parseVideoTracks",value:function(t){for(var r=[],n=0;n<t.length;n++){var a={active:this._hls.startLevel===n,bandwidth:t[n].bitrate,width:t[n].width,height:t[n].height,language:"",index:n};r.push(new e.VideoTrack(a))}return r}},{key:"_parseTextTracks",value:function(t){var r,n=[],a=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}(t);try{for(a.s();!(r=a.n()).done;){var i=r.value,s={id:i.id,active:!1,default:i.default,label:i.name,kind:this._captionsOrSubtitlesFromCharacteristics(i),language:i.lang};n.push(new e.TextTrack(s))}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"_captionsOrSubtitlesFromCharacteristics",value:function(t){var r=t.characteristics;return r&&/transcribes-spoken-dialog/gi.test(r)&&/describes-music-and-sound/gi.test(r)?e.TextTrack.KIND.CAPTIONS:e.TextTrack.KIND.SUBTITLES}},{key:"_parseCEATextTrack",value:function(t){var r=null;if("captions"===t.kind){var n={id:t.id,active:"showing"===t.mode,label:t.label,kind:t.kind,language:t.language};r=new e.TextTrack(n),this._nativeTextTracksMap[r.index]=t}return r}},{key:"selectAudioTrack",value:function(t){t instanceof e.AudioTrack&&!t.active&&this._hls.audioTracks&&(this._hls.audioTrack=t.id)}},{key:"selectVideoTrack",value:function(t){t instanceof e.VideoTrack&&(!t.active||this.isAdaptiveBitrateEnabled())&&this._hls.levels&&(this.isAdaptiveBitrateEnabled()&&this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:"manual"}),this._hls.currentLevel=t.index)}},{key:"selectTextTrack",value:function(t){t instanceof e.TextTrack&&!t.active&&this._hls&&(this._hls.subtitleTracks.length?(this._hls.subtitleTrack=t.id,this._notifyTrackChanged(t)):this._selectNativeTextTrack(t))}},{key:"_selectNativeTextTrack",value:function(e){var t=this._nativeTextTracksMap[e.index];t&&(this.disableNativeTextTracks(),t.mode=this._config.subtitleDisplay?"showing":"hidden",this._notifyTrackChanged(e))}},{key:"_notifyTrackChanged",value:function(e){this._onTrackChanged(e)}},{key:"hideTextTrack",value:function(){this._hls&&!this._hls.subtitleTracks.length&&this.disableNativeTextTracks()}},{key:"enableAdaptiveBitrate",value:function(){this.isAdaptiveBitrateEnabled()||(this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:"auto"}),this._hls.nextLevel=-1)}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._hls&&this._hls.autoLevelEnabled}},{key:"applyABRRestriction",value:function(t){e.Utils.Object.createPropertyPath(this._config,"abr.restrictions",t),this._hls.capLevelToPlayerSize||this._maybeApplyAbrRestrictions(t)}},{key:"_getLevelDetails",value:function(){var e=this._hls.levels[this._hls.currentLevel]||this._hls.levels[this._hls.nextLevel]||this._hls.levels[this._hls.nextAutoLevel]||this._hls.levels[this._hls.nextLoadLevel];return e&&e.details?e.details:{}}},{key:"_getLiveEdge",value:function(){try{var e;return(e=this._hls.liveSyncPosition?this._hls.liveSyncPosition:this._hls.config.liveSyncDuration?this._videoElement.duration-this._hls.config.liveSyncDuration:this._videoElement.duration-this._hls.config.liveSyncDurationCount*this._getLevelDetails().targetduration)>0?e:this._videoElement.duration}catch(e){return u._logger.debug("Live edge calculation failed, fall back to duration"),this._videoElement.duration}}},{key:"seekToLiveEdge",value:function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}}},{key:"getSegmentDuration",value:function(){var t=e.Utils.Object.getPropertyPath(this._hls,"streamController.fragCurrent");return t?t.duration:0}},{key:"liveDuration",get:function(){return this._getLiveEdge()+this.getSegmentDuration()}},{key:"isLive",value:function(){try{return!!this._getLevelDetails().live}catch(e){return!1}}},{key:"_onManifestLoaded",value:function(t){var r=this;u._logger.debug("The source has been loaded successfully"),this._hls.config.autoStartLoad||this._hls.startLoad(this._startTime),this._playerTracks=this._parseTracks(),this._config.abr.enabled||(this._hls.currentLevel=0),this._mediaAttachedPromise.then((function(){var e;null===(e=r._loadPromiseHandlers)||void 0===e||e.resolve({tracks:r._playerTracks}),r._loadPromiseHandlers=null}));var n=t.stats.loading,a=n.end-n.start;this._trigger(e.EventType.MANIFEST_LOADED,{miliSeconds:a})}},{key:"_maybeApplyAbrRestrictions",value:function(t){var r=this._playerTracks.filter((function(t){return t instanceof e.VideoTrack})),n=(0,e.filterTracksByRestriction)(r,t);if(n.length){var a=n[0],i=n.pop();this._hls.config.minAutoBitrate=a.bandwidth,this._hls.autoLevelCapping=i.index;var s=n.some((function(e){return e.active}));this.isAdaptiveBitrateEnabled()||s||this.selectVideoTrack(a)}else u._logger.warn("Invalid restrictions, there are not tracks within the restriction range")}},{key:"_onLevelSwitched",value:function(t,r){var n=this._playerTracks.find((function(t){return t instanceof e.VideoTrack&&t.index===r.level}));this._onTrackChanged(n)}},{key:"_onAudioTrackSwitched",value:function(t,r){var n=this._playerTracks.find((function(t){return t instanceof e.AudioTrack&&t.id===r.id}));this._onTrackChanged(n),this._handleWaitingUponAudioTrackSwitch()}},{key:"_handleWaitingUponAudioTrackSwitch",value:function(){var t=this;["IE","Edge"].includes(e.Env.browser.name)&&this._eventManager.listenOnce(this._videoElement,e.EventType.TIME_UPDATE,(function(){t._trigger(e.EventType.PLAYING)}))}},{key:"_getErrorDataObject",value:function(e){var t={};switch(t.name=e.details,t.name){case E().ErrorDetails.MANIFEST_LOAD_ERROR:case E().ErrorDetails.LEVEL_LOAD_ERROR:case E().ErrorDetails.AUDIO_TRACK_LOAD_ERROR:t.url=e.url,t.responseCode=e.response?e.response.code:null;break;case E().ErrorDetails.MANIFEST_LOAD_TIMEOUT:case E().ErrorDetails.LEVEL_LOAD_TIMEOUT:case E().ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:t.url=e.url;break;case E().ErrorDetails.MANIFEST_PARSING_ERROR:t.url=e.url,t.reason=e.reason;break;case E().ErrorDetails.LEVEL_SWITCH_ERROR:t.level=e.level,t.reason=e.reason;break;case E().ErrorDetails.FRAG_LOAD_ERROR:t.fragUrl=e.frag?e.frag.url:null,t.responseCode=e.response?e.response.code:null;break;case E().ErrorDetails.FRAG_LOAD_TIMEOUT:t.fragUrl=e.frag?e.frag.url:null;break;case E().ErrorDetails.FRAG_DECRYPT_ERROR:case E().ErrorDetails.FRAG_PARSING_ERROR:t.reason=e.reason;break;case E().ErrorDetails.KEY_LOAD_ERROR:t.fragDecryptedDataUri=e.frag&&e.frag.decryptdata?e.frag.decryptdata.uri:null,t.responseCode=e.response?e.response.code:null;break;case E().ErrorDetails.KEY_LOAD_TIMEOUT:t.fragDecryptedDataUri=e.frag&&e.frag.decryptdata?e.frag.decryptdata.uri:null;break;case E().ErrorDetails.BUFFER_ADD_CODEC_ERROR:t.mimeType=e.mimeType,t.errorMsg=e.err?e.err.message:null;break;case E().ErrorDetails.BUFFER_STALLED_ERROR:t.buffer=e.buffer}return(this._requestFilterError||this._responseFilterError)&&(t.reason=e.response.text),t}},{key:"_onError",value:function(t){var r=t.type,n=t.details,a=t.fatal,i=this._getErrorDataObject(t);if(a){var s,o;switch(r){case E().ErrorTypes.NETWORK_ERROR:var l;l=this._requestFilterError?e.Error.Code.REQUEST_FILTER_ERROR:this._responseFilterError?e.Error.Code.RESPONSE_FILTER_ERROR:e.Error.Code.HTTP_ERROR,![E().ErrorDetails.MANIFEST_LOAD_ERROR,E().ErrorDetails.MANIFEST_LOAD_TIMEOUT].includes(n)||this._triedReloadWithRedirect||this._config.forceRedirectExternalStreams||this._requestFilterError||this._responseFilterError?s=new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.NETWORK,l,i):(s=new e.Error(e.Error.Severity.RECOVERABLE,e.Error.Category.NETWORK,l,i),this._reloadWithDirectManifest());break;case E().ErrorTypes.MEDIA_ERROR:s=this._handleMediaError(n)?new e.Error(e.Error.Severity.RECOVERABLE,e.Error.Category.MEDIA,e.Error.Code.HLS_FATAL_MEDIA_ERROR,i):new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.MEDIA,e.Error.Code.HLS_FATAL_MEDIA_ERROR,i);break;default:s=new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.PLAYER,e.Error.Code.HLS_FATAL_MEDIA_ERROR,i)}this._trigger(e.EventType.ERROR,s),s&&s.severity===e.Error.Severity.CRITICAL&&(this._loadPromiseHandlers&&(null===(o=this._loadPromiseHandlers)||void 0===o||o.reject(s),this._loadPromiseHandlers=null,this._loadPromise=void 0),this.destroy())}else{var c=this._requestFilterError||this._responseFilterError?{category:e.Error.Category.NETWORK,code:this._requestFilterError?e.Error.Code.REQUEST_FILTER_ERROR:e.Error.Code.RESPONSE_FILTER_ERROR}:T[n]||{category:0,code:0},d=c.category,p=c.code;u._logger.warn(new e.Error(e.Error.Severity.RECOVERABLE,d,p,i))}this._requestFilterError=!1,this._responseFilterError=!1}},{key:"_handleMediaError",value:function(t){u._logger.error("_handleMediaError mediaErrorName:",t);var r=performance.now(),n=!0;if(t===E().ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR)u._logger.error("recover aborted due to: MANIFEST_INCOMPATIBLE_CODECS_ERROR"),n=!1;else if(this._checkTimeDeltaHasPassed(r,this._recoverDecodingErrorDate,this._config.recoverDecodingErrorDelay)){if(t===E().ErrorDetails.FRAG_PARSING_ERROR)return u._logger.error("Manifest parsing error on "+this._videoElement.currentTime+". Try to recover"),n;this._eventManager.listen(this._videoElement,e.EventType.LOADED_METADATA,this._onRecoveredCallback),u._logger.debug("try to recover using: _recoverDecodingError()"),this._recoverDecodingError()}else this._checkTimeDeltaHasPassed(r,this._recoverSwapAudioCodecDate,this._config.recoverSwapAudioCodecDelay)?(this._eventManager.listen(this._videoElement,e.EventType.LOADED_METADATA,this._onRecoveredCallback),u._logger.debug("try to recover using: _recoverSwapAudioCodec()"),this._recoverSwapAudioCodec()):(u._logger.error("cannot recover, last media error recovery failed error: ",t),n=!1);return n}},{key:"_onRecovered",value:function(){this._trigger(e.EventType.MEDIA_RECOVERED),this._videoElement.removeEventListener(e.EventType.LOADED_METADATA,this._onRecoveredCallback)}},{key:"_checkTimeDeltaHasPassed",value:function(e,t,r){return!t||e-t>r}},{key:"_recoverDecodingError",value:function(){this._recoverDecodingErrorDate=performance.now(),u._logger.warn("try to recover media Error"),this._hls.recoverMediaError()}},{key:"_recoverSwapAudioCodec",value:function(){this._recoverSwapAudioCodecDate=performance.now(),u._logger.warn("try to swap Audio Codec and recover media Error"),this._hls.swapAudioCodec(),this._hls.recoverMediaError()}},{key:"_removeBindings",value:function(){for(var e=0,t=Object.entries(this._adapterEventsBindings);e<t.length;e++){var r=n(t[e],2),a=r[0],i=r[1];this._hls.off(a,i)}this._videoElement.textTracks.onaddtrack=null,this._onRecoveredCallback=null,this._eventManager&&this._eventManager.removeAll()}},{key:"getStartTimeOfDvrWindow",value:function(){if(!this.isLive())return 0;try{var e=this._hls.levels[this._hls.nextLoadLevel].details,t=e.fragments,r=t.length,n=t[0].start+t[0].duration,a=t[r-1].start+t[r-1].duration,i=void 0!==this._hls.config.liveMaxLatencyDuration?this._hls.config.liveMaxLatencyDuration:this._hls.config.liveMaxLatencyDurationCount*e.targetduration;return Math.max(n-this._hls.config.maxFragLookUpTolerance,a-i)}catch(e){return u._logger.debug("Unable obtain the start of DVR window"),0}}},{key:"_onFragLoaded",value:function(t){if(e.Utils.Object.hasPropertyPath(t,"frag.stats.loading")){var r=t.frag.stats,n=r.loading.end-r.loading.start;this._trigger(e.EventType.FRAG_LOADED,{miliSeconds:n,bytes:r.loaded,url:t.frag.url})}}},{key:"targetBuffer",get:function(){var e=NaN;return this._hls?(e=this.isLive()?this._getLiveTargetBuffer()-(this._videoElement.currentTime-this._getLiveEdge()):this._videoElement.duration-this._videoElement.currentTime,e=Math.min(e,this._hls.config.maxMaxBufferLength+this._getLevelDetails().targetduration)):NaN}},{key:"_getLiveTargetBuffer",value:function(){return this._hls.config.liveSyncDuration?this._hls.config.liveSyncDuration:this._hls.config.liveSyncDurationCount*this._getLevelDetails().targetduration}}],[{key:"createAdapter",value:function(t,r,n){var a=e.Utils.Object.copyDeep(b);if(e.Utils.Object.hasPropertyPath(n,"sources.options")){var i=n.sources.options;a.forceRedirectExternalStreams=i.forceRedirectExternalStreams,a.redirectExternalStreamsHandler=i.redirectExternalStreamsHandler,a.redirectExternalStreamsTimeout=i.redirectExternalStreamsTimeout,S.redirectExternalStreamsHandler=a.redirectExternalStreamsHandler,S.redirectExternalStreamsTimeout=a.redirectExternalStreamsTimeout}if(e.Utils.Object.hasPropertyPath(n,"sources.startTime")&&e.Utils.Object.getPropertyPath(n,"sources.startTime")>-1&&(a.hlsConfig.startPosition=n.sources.startTime),e.Utils.Object.hasPropertyPath(n,"text.useNativeTextTrack")&&(a.subtitleDisplay=e.Utils.Object.getPropertyPath(n,"text.useNativeTextTrack")),e.Utils.Object.hasPropertyPath(n,"abr.fpsDroppedFramesInterval")&&(a.hlsConfig.fpsDroppedFramesInterval=n.abr.fpsDroppedFramesInterval),e.Utils.Object.hasPropertyPath(n,"abr.fpsDroppedMonitoringThreshold")&&(a.hlsConfig.fpsDroppedMonitoringThreshold=n.abr.fpsDroppedMonitoringThreshold),e.Utils.Object.hasPropertyPath(n,"abr.capLevelOnFPSDrop")&&(u._logger.debug("capLevelOnFPSDrop = ",n.abr.capLevelOnFPSDrop),a.hlsConfig.capLevelOnFPSDrop=n.abr.capLevelOnFPSDrop),e.Utils.Object.hasPropertyPath(n,"text")&&(a.hlsConfig.enableCEA708Captions=n.text.enableCEA708Captions,a.hlsConfig.captionsTextTrack1Label=n.text.captionsTextTrack1Label,a.hlsConfig.captionsTextTrack1LanguageCode=n.text.captionsTextTrack1LanguageCode,a.hlsConfig.captionsTextTrack2Label=n.text.captionsTextTrack2Label,a.hlsConfig.captionsTextTrack2LanguageCode=n.text.captionsTextTrack2LanguageCode),e.Utils.Object.hasPropertyPath(n,"abr")){var s=n.abr;"boolean"==typeof s.enabled&&(a.abr.enabled=s.enabled),"boolean"==typeof s.capLevelToPlayerSize&&(a.hlsConfig.capLevelToPlayerSize=s.capLevelToPlayerSize),s.defaultBandwidthEstimate&&(a.hlsConfig.abrEwmaDefaultEstimate=s.defaultBandwidthEstimate),s.restrictions&&e.Utils.Object.createPropertyPath(a,"abr.restrictions",s.restrictions)}return e.Utils.Object.hasPropertyPath(n,"streaming.lowLatencyMode")&&(a.hlsConfig.lowLatencyMode=e.Utils.Object.getPropertyPath(n,"streaming.lowLatencyMode")),e.Utils.Object.hasPropertyPath(n,"playback.options.html5.hls")&&e.Utils.Object.mergeDeep(a.hlsConfig,n.playback.options.html5.hls),a.network=n.network,new this(t,r,a)}},{key:"canPlayType",value:function(e){var t="string"==typeof e&&u._hlsMimeTypes.includes(e.toLowerCase())&&u.isMSESupported();return u._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t}},{key:"canPlayDrm",value:function(){return u._logger.warn("canPlayDrm result is false"),!1}},{key:"isSupported",value:function(){var e=E().isSupported();return u._logger.debug("isSupported:"+e),e}}]),u}(e.BaseMediaSourceAdapter);_=C,y(C,"id","HlsAdapter"),y(C,"_logger",e.BaseMediaSourceAdapter.getLogger(_.id)),y(C,"_hlsMimeTypes",["application/x-mpegurl","application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"]);var x="1.32.20",I="@playkit-js/playkit-js-hls",w=C;C.isSupported()&&(0,e.registerMediaSourceAdapter)(C)}(),i}())},352:module=>{"use strict";module.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(s[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);n&&s[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},864:module=>{"use strict";module.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},718:module=>{!function e(t){var r;r=function(){"use strict";function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(null,arguments)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,d(e,t)}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function h(e){var t="function"==typeof Map?new Map:void 0;return h=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(l())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var a=new(e.bind.apply(e,n));return r&&d(a,r.prototype),a}(e,arguments,s(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,e)},h(e)}var f,m,g={exports:{}},y=(f||(f=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new a(n,i||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),o.prototype.eventNames=function(){var e,n,a=[];if(0===this._eventsCount)return a;for(n in e=this._events)t.call(e,n)&&a.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,i=n.length,s=new Array(i);a<i;a++)s[a]=n[a].fn;return s},o.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},o.prototype.emit=function(e,t,n,a,i,s){var o=r?r+e:e;if(!this._events[o])return!1;var l,u,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,a),!0;case 5:return c.fn.call(c.context,t,n,a,i),!0;case 6:return c.fn.call(c.context,t,n,a,i,s),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var p,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,a);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];c[u].fn.apply(c[u].context,l)}}return!0},o.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,n,a){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||a&&!o.once||n&&o.context!==n||s(this,i);else{for(var l=0,u=[],c=o.length;l<c;l++)(o[l].fn!==t||a&&!o[l].once||n&&o[l].context!==n)&&u.push(o[l]);u.length?this._events[i]=1===u.length?u[0]:u:s(this,i)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o}(g)),g.exports),v=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(y),_={exports:{}},k=(m||(m=1,function(e,t){var r,n,a,i,s;r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,i=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var a=s.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");return a.path=s.normalizePath(a.path),s.buildURLFromParts(a)}var i=s.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=s.normalizePath(i.path),s.buildURLFromParts(i)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=n.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(u.netLoc=o.netLoc,"/"!==i.path[0]))if(i.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+i.path;u.path=s.normalizePath(d)}else u.path=o.path,i.params||(u.params=o.params,i.query||(u.query=o.query));return null===u.path&&(u.path=r.alwaysNormalize?s.normalizePath(i.path):i.path),s.buildURLFromParts(u)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(i,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s}(_)),_.exports),E=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},b=Number.isSafeInteger||function(e){return"number"==typeof e&&Math.abs(e)<=T},T=Number.MAX_SAFE_INTEGER||9007199254740991,A=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),S=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",e.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",e.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.ASSET_LIST_LOAD_ERROR="assetListLoadError",e.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",e.ASSET_LIST_PARSING_ERROR="assetListParsingError",e.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.ATTACH_MEDIA_ERROR="attachMediaError",e.UNKNOWN="unknown",e}({}),P=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.MEDIA_ENDED="hlsMediaEnded",e.STALL_RESOLVED="hlsStallResolved",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFERED_TO_END="hlsBufferedToEnd",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e.ASSET_LIST_LOADING="hlsAssetListLoading",e.ASSET_LIST_LOADED="hlsAssetListLoaded",e.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",e.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",e.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",e.INTERSTITIAL_STARTED="hlsInterstitialStarted",e.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",e.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",e.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",e.INTERSTITIAL_ENDED="hlsInterstitialEnded",e.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",e.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",e.EVENT_CUE_ENTER="hlsEventCueEnter",e}({}),C="manifest",x="level",I="audioTrack",w="subtitleTrack",R="main",M="audio",D="subtitle",O=function(){function e(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_},e}(),L=function(){function e(e,t,r,n){void 0===n&&(n=100),this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new O(e),this.fast_=new O(t),this.defaultTTFB_=n,this.ttfb_=new O(e)}var t=e.prototype;return t.update=function(e,t){var r=this.slow_,n=this.fast_,a=this.ttfb_;r.halfLife!==e&&(this.slow_=new O(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==t&&(this.fast_=new O(t,n.getEstimate(),n.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new O(e,a.getEstimate(),a.getTotalWeight()))},t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*t/r;this.fast_.sample(r,n),this.slow_.sample(r,n)},t.sampleTTFB=function(e){var t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))},t.canEstimate=function(){return this.fast_.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.getEstimateTTFB=function(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_},t.destroy=function(){},n(e,[{key:"defaultEstimate",get:function(){return this.defaultEstimate_}}])}(),N=function(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;var r="["+e+"]:";this.trace=U,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)},U=function(){},j={trace:U,debug:U,log:U,warn:U,info:U,error:U};function B(){return i({},j)}function F(e,t,r){return t[e]?t[e].bind(t):function(e,t){var r=self.console[e];return r?r.bind(self.console,(t?"["+t+"] ":"")+"["+e+"] >"):U}(e,r)}var V=B();function G(e,t,r){var n=B();if("object"==typeof console&&!0===e||"object"==typeof e){var a=["debug","log","info","warn","error"];a.forEach((function(t){n[t]=F(t,e,r)}));try{n.log('Debug logs enabled for "'+t+'" in hls.js version 1.6.12')}catch(e){return B()}a.forEach((function(t){V[t]=F(t,e)}))}else i(V,n);return n}var H=V;function K(e){if(void 0===e&&(e=!0),"undefined"!=typeof self)return(e||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function W(e,t){var r=Object.keys(e),n=Object.keys(t),a=r.length,i=n.length;return!a||!i||a===i&&!r.some((function(e){return-1===n.indexOf(e)}))}function $(e,t){if(void 0===t&&(t=!1),"undefined"!=typeof TextDecoder){var r=new TextDecoder("utf-8").decode(e);if(t){var n=r.indexOf("\0");return-1!==n?r.substring(0,n):r}return r.replace(/\0/g,"")}for(var a,i,s,o=e.length,l="",u=0;u<o;){if(0===(a=e[u++])&&t)return l;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(a);break;case 12:case 13:i=e[u++],l+=String.fromCharCode((31&a)<<6|63&i);break;case 14:i=e[u++],s=e[u++],l+=String.fromCharCode((15&a)<<12|(63&i)<<6|(63&s)<<0)}}return l}function z(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length<2&&(n="0"+n),t+=n}return t}function q(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var Y=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}},X="audio",Z="video",Q="audiovideo",J=function(){function e(e){var t;this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"==typeof e&&(e={url:e}),this.base=e,(t=ne(this,"stats"))&&(t.enumerable=!0,Object.defineProperty(this,"stats",t))}var t=e.prototype;return t.setByteRange=function(e,t){var r,n=e.split("@",2);r=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]},t.clearElementaryStreamInfo=function(){var e=this.elementaryStreams;e[X]=null,e[Z]=null,e[Q]=null},n(e,[{key:"baseurl",get:function(){return this.base.url}},{key:"byteRange",get:function(){return null===this._byteRange?[]:this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"elementaryStreams",get:function(){var e;return null===this._streams&&(this._streams=((e={})[X]=null,e[Z]=null,e[Q]=null,e)),this._streams},set:function(e){this._streams=e}},{key:"hasStats",get:function(){return null!==this._stats}},{key:"hasStreams",get:function(){return null!==this._streams}},{key:"stats",get:function(){return null===this._stats&&(this._stats=new Y),this._stats},set:function(e){this._stats=e}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=k.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}])}();function ee(e){return"initSegment"!==e.sn}var te=function(e){function t(t,r){var n;return(n=e.call(this,r)||this)._decryptdata=null,n._programDateTime=null,n._ref=null,n._bitrate=void 0,n.rawProgramDateTime=null,n.tagList=[],n.duration=0,n.sn=0,n.levelkeys=void 0,n.type=void 0,n.loader=null,n.keyLoader=null,n.level=-1,n.cc=0,n.startPTS=void 0,n.endPTS=void 0,n.startDTS=void 0,n.endDTS=void 0,n.start=0,n.playlistOffset=0,n.deltaPTS=void 0,n.maxStartPTS=void 0,n.minEndPTS=void 0,n.data=void 0,n.bitrateTest=!1,n.title=null,n.initSegment=null,n.endList=void 0,n.gap=void 0,n.urlId=0,n.type=t,n}o(t,e);var r=t.prototype;return r.addStart=function(e){this.setStart(this.start+e)},r.setStart=function(e){this.start=e,this._ref&&(this._ref.start=e)},r.setDuration=function(e){this.duration=e,this._ref&&(this._ref.duration=e)},r.setKeyFormat=function(e){if(this.levelkeys){var t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}},r.abortRequests=function(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()},r.setElementaryStreamInfo=function(e,t,r,n,a,i){void 0===i&&(i=!1);var s=this.elementaryStreams,o=s[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,r),o.startDTS=Math.min(o.startDTS,n),o.endDTS=Math.max(o.endDTS,a)):s[e]={startPTS:t,endPTS:r,startDTS:n,endDTS:a,partial:i}},n(t,[{key:"byteLength",get:function(){if(this.hasStats){var e=this.stats.total;if(e)return e}if(this.byteRange.length){var t=this.byteRange[0],r=this.byteRange[1];if(E(t)&&E(r))return r-t}return null}},{key:"bitrate",get:function(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null},set:function(e){this._bitrate=e}},{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{var t=Object.keys(this.levelkeys);if(1===t.length){var r=this._decryptdata=this.levelkeys[t[0]]||null;if(r)return r.getDecryptData(this.sn)}}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;var e=E(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){var t,r=Object.keys(this.levelkeys),n=r.length;if(n>1||1===n&&null!=(t=this.levelkeys[r[0]])&&t.encrypted)return!0}return!1}},{key:"programDateTime",get:function(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime},set:function(e){E(e)?this._programDateTime=e:this._programDateTime=this.rawProgramDateTime=null}},{key:"ref",get:function(){return ee(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}}])}(J),re=function(e){function t(t,r,n,a,i){var s;(s=e.call(this,n)||this).fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.duration=t.decimalFloatingPoint("DURATION"),s.gap=t.bool("GAP"),s.independent=t.bool("INDEPENDENT"),s.relurl=t.enumeratedString("URI"),s.fragment=r,s.index=a;var o=t.enumeratedString("BYTERANGE");return o&&s.setByteRange(o,i),i&&(s.fragOffset=i.fragOffset+i.duration),s}return o(t,e),n(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}])}(J);function ne(e,t){var r=Object.getPrototypeOf(e);if(r)return Object.getOwnPropertyDescriptor(r,t)||ne(r,t)}var ae=Math.pow(2,32)-1,ie=[].push,se={video:1,audio:2,id3:3,text:4};function oe(e){return String.fromCharCode.apply(null,e)}function le(e,t){var r=e[t]<<8|e[t+1];return r<0?65536+r:r}function ue(e,t){var r=de(e,t);return r<0?4294967296+r:r}function ce(e,t){var r=ue(e,t);return(r*=Math.pow(2,32))+ue(e,t+4)}function de(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function pe(e,t){var r=[];if(!t.length)return r;for(var n=e.byteLength,a=0;a<n;){var i=ue(e,a),s=i>1?a+i:n;if(oe(e.subarray(a+4,a+8))===t[0])if(1===t.length)r.push(e.subarray(a+8,s));else{var o=pe(e.subarray(a+8,s),t.slice(1));o.length&&ie.apply(r,o)}a=s}return r}function he(e){var t=[],r=e[0],n=8,a=ue(e,n);n+=4;var i=0,s=0;0===r?(i=ue(e,n),s=ue(e,n+4),n+=8):(i=ce(e,n),s=ce(e,n+8),n+=16),n+=2;var o=e.length+s,l=le(e,n);n+=2;for(var u=0;u<l;u++){var c=n,d=ue(e,c);c+=4;var p=2147483647&d;if(1==(2147483648&d)>>>31)return H.warn("SIDX has hierarchical references (not supported)"),null;var h=ue(e,c);c+=4,t.push({referenceSize:p,subsegmentDuration:h,info:{duration:h/a,start:o,end:o+p-1}}),o+=p,n=c+=4}return{earliestPresentationTime:i,timescale:a,version:r,referencesCount:l,references:t}}function fe(e){for(var t=[],r=pe(e,["moov","trak"]),n=0;n<r.length;n++){var a=r[n],i=pe(a,["tkhd"])[0];if(i){var s=i[0],o=ue(i,0===s?12:20),l=pe(a,["mdia","mdhd"])[0];if(l){var u=ue(l,0===(s=l[0])?12:20),d=pe(a,["mdia","hdlr"])[0];if(d){var p=oe(d.subarray(8,12)),h={soun:X,vide:Z}[p],f=me(pe(a,["mdia","minf","stbl","stsd"])[0]);h?(t[o]={timescale:u,type:h,stsd:f},t[h]=c({timescale:u,id:o},f)):t[o]={timescale:u,type:p,stsd:f}}}}}return pe(e,["moov","mvex","trex"]).forEach((function(e){var r=ue(e,4),n=t[r];n&&(n.default={duration:ue(e,12),flags:ue(e,20)})})),t}function me(e){var t,r=e.subarray(8),n=r.subarray(86),a=oe(r.subarray(4,8)),i=a,s="enca"===a||"encv"===a;if(s){var o=pe(r,[a])[0];pe(o.subarray("enca"===a?28:78),["sinf"]).forEach((function(e){var t=pe(e,["schm"])[0];if(t){var r=oe(t.subarray(4,8));if("cbcs"===r||"cenc"===r){var n=pe(e,["frma"])[0];n&&(i=oe(n))}}}))}var l=i;switch(i){case"avc1":case"avc2":case"avc3":case"avc4":var u=pe(n,["avcC"])[0];u&&u.length>3&&(i+="."+ve(u[1])+ve(u[2])+ve(u[3]),t=ge("avc1"===l?"dva1":"dvav",n));break;case"mp4a":var c=pe(r,[a])[0],d=pe(c.subarray(28),["esds"])[0];if(d&&d.length>7){var p=4;if(3!==d[p++])break;p=ye(d,p),p+=2;var h=d[p++];if(128&h&&(p+=2),64&h&&(p+=d[p++]),4!==d[p++])break;p=ye(d,p);var f=d[p++];if(64!==f)break;if(i+="."+ve(f),p+=12,5!==d[p++])break;p=ye(d,p);var m=d[p++],g=(248&m)>>3;31===g&&(g+=1+((7&m)<<3)+((224&d[p])>>5)),i+="."+g}break;case"hvc1":case"hev1":var y=pe(n,["hvcC"])[0];if(y&&y.length>12){var v=y[1],_=["","A","B","C"][v>>6],k=31&v,E=ue(y,2),b=(32&v)>>5?"H":"L",T=y[12],A=y.subarray(6,12);i+="."+_+k,i+="."+function(e){for(var t=0,r=0;r<32;r++)t|=(e>>r&1)<<31-r;return t>>>0}(E).toString(16).toUpperCase(),i+="."+b+T;for(var S="",P=A.length;P--;){var C=A[P];(C||S)&&(S="."+C.toString(16).toUpperCase()+S)}i+=S}t=ge("hev1"==l?"dvhe":"dvh1",n);break;case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":i=ge(i,n)||i;break;case"vp09":var x=pe(n,["vpcC"])[0];if(x&&x.length>6){var I=x[4],w=x[5],R=x[6]>>4&15;i+="."+_e(I)+"."+_e(w)+"."+_e(R)}break;case"av01":var M=pe(n,["av1C"])[0];if(M&&M.length>2){var D=M[1]>>>5,O=31&M[1],L=M[2]>>>7?"H":"M",N=(64&M[2])>>6,U=(32&M[2])>>5,j=2===D&&N?U?12:10:N?10:8,B=(16&M[2])>>4,F=(8&M[2])>>3,V=(4&M[2])>>2,G=3&M[2];i+="."+D+"."+_e(O)+L+"."+_e(j)+"."+B+"."+F+V+G+"."+_e(1)+"."+_e(1)+"."+_e(1)+".0",t=ge("dav1",n)}}return{codec:i,encrypted:s,supplemental:t}}function ge(e,t){var r=pe(t,["dvvC"]),n=r.length?r[0]:pe(t,["dvcC"])[0];if(n){var a=n[2]>>1&127,i=n[2]<<5&32|n[3]>>3&31;return e+"."+_e(a)+"."+_e(i)}}function ye(e,t){for(var r=t+5;128&e[t++]&&t<r;);return t}function ve(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function _e(e){return(e<10?"0":"")+e}function ke(e){var t=pe(e,["schm"])[0];if(t){var r=oe(t.subarray(4,8));if("cbcs"===r||"cenc"===r)return pe(e,["schi","tenc"])[0]}return null}function Ee(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function be(e,t){var r=[],n=t.samples,a=t.timescale,i=t.id,s=!1;return pe(n,["moof"]).map((function(o){var l=o.byteOffset-8;pe(o,["traf"]).map((function(o){var u=pe(o,["tfdt"]).map((function(e){var t=e[0],r=ue(e,4);return 1===t&&(r*=Math.pow(2,32),r+=ue(e,8)),r/a}))[0];return void 0!==u&&(e=u),pe(o,["tfhd"]).map((function(u){var c=ue(u,4),d=16777215&ue(u,0),p=0,h=0!=(16&d),f=0,m=0!=(32&d),g=8;c===i&&(0!=(1&d)&&(g+=8),0!=(2&d)&&(g+=4),0!=(8&d)&&(p=ue(u,g),g+=4),h&&(f=ue(u,g),g+=4),m&&(g+=4),"video"===t.type&&(s=Te(t.codec)),pe(o,["trun"]).map((function(i){var o=i[0],u=16777215&ue(i,0),c=0!=(1&u),d=0,h=0!=(4&u),m=0!=(256&u),g=0,y=0!=(512&u),v=0,_=0!=(1024&u),k=0!=(2048&u),E=0,b=ue(i,4),T=8;c&&(d=ue(i,T),T+=4),h&&(T+=4);for(var A=d+l,S=0;S<b;S++){if(m?(g=ue(i,T),T+=4):g=p,y?(v=ue(i,T),T+=4):v=f,_&&(T+=4),k&&(E=0===o?ue(i,T):de(i,T),T+=4),t.type===Z)for(var P=0;P<v;){var C=ue(n,A);Ae(s,n[A+=4])&&Se(n.subarray(A,A+C),s?2:1,e+E/a,r),A+=C,P+=C+4}e+=g/a}})))}))}))})),r}function Te(e){if(!e)return!1;var t=e.substring(0,4);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}function Ae(e,t){if(e){var r=t>>1&63;return 39===r||40===r}return 6==(31&t)}function Se(e,t,r,n){var a=Pe(e),i=0;i+=t;for(var s=0,o=0,l=0;i<a.length;){s=0;do{if(i>=a.length)break;s+=l=a[i++]}while(255===l);o=0;do{if(i>=a.length)break;o+=l=a[i++]}while(255===l);var u=a.length-i,c=i;if(o<u)i+=o;else if(o>u){H.error("Malformed SEI payload. "+o+" is too small, only "+u+" bytes left to parse.");break}if(4===s){if(181===a[c++]){var d=le(a,c);if(c+=2,49===d){var p=ue(a,c);if(c+=4,1195456820===p){var h=a[c++];if(3===h){var f=a[c++],m=64&f,g=m?2+3*(31&f):0,y=new Uint8Array(g);if(m){y[0]=f;for(var v=1;v<g;v++)y[v]=a[c++]}n.push({type:h,payloadType:s,pts:r,bytes:y})}}}}}else if(5===s&&o>16){for(var _=[],k=0;k<16;k++){var E=a[c++].toString(16);_.push(1==E.length?"0"+E:E),3!==k&&5!==k&&7!==k&&9!==k||_.push("-")}for(var b=o-16,T=new Uint8Array(b),A=0;A<b;A++)T[A]=a[c++];n.push({payloadType:s,pts:r,uuid:_.join(""),userData:$(T),userDataBytes:T})}}}function Pe(e){for(var t=e.byteLength,r=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return e;var a=t-r.length,i=new Uint8Array(a),s=0;for(n=0;n<a;s++,n++)s===r[0]&&(s++,r.shift()),i[n]=e[s];return i}function Ce(e){var t=e.getUint32(0),r=e.byteOffset,n=e.byteLength;if(n<t)return{offset:r,size:n};if(1886614376!==e.getUint32(4))return{offset:r,size:t};var a=e.getUint32(8)>>>24;if(0!==a&&1!==a)return{offset:r,size:t};var i=e.buffer,s=z(new Uint8Array(i,r+12,16)),o=null,l=0;if(0===a)l=28;else{var u=e.getUint32(28);if(!u||n<32+16*u)return{offset:r,size:t};o=[];for(var c=0;c<u;c++)o.push(new Uint8Array(i,r+32+16*c,16));l=32+16*u}if(!l)return{offset:r,size:t};var d=e.getUint32(l);return t-32<d?{offset:r,size:t}:{version:a,systemId:s,kids:o,data:new Uint8Array(i,r+l+4,d),offset:r,size:t}}var xe=function(){return/\(Windows.+Firefox\//i.test(navigator.userAgent)},Ie={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function we(e,t){var r=Ie[t];return!!r&&!!r[e.slice(0,4)]}function Re(e,t,r){return void 0===r&&(r=!0),!e.split(",").some((function(e){return!Me(e,t,r)}))}function Me(e,t,r){var n;void 0===r&&(r=!0);var a=K(r);return null!=(n=null==a?void 0:a.isTypeSupported(De(e,t)))&&n}function De(e,t){return t+"/mp4;codecs="+e}function Oe(e){if(e){var t=e.substring(0,4);return Ie.video[t]}return 2}function Le(e){var t=xe();return e.split(",").reduce((function(e,r){var n=t&&Te(r)?9:Ie.video[r];return n?(2*n+e)/(e?3:2):(Ie.audio[r]+e)/(e?2:1)}),0)}var Ne={},Ue=/flac|opus|mp4a\.40\.34/i;function je(e,t){return void 0===t&&(t=!0),e.replace(Ue,(function(e){return function(e,t){if(void 0===t&&(t=!0),Ne[e])return Ne[e];for(var r={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[e],n=0;n<r.length;n++){var a;if(Me(r[n],"audio",t))return Ne[e]=r[n],r[n];if("mp3"===r[n]&&null!=(a=K(t))&&a.isTypeSupported("audio/mpeg"))return""}return e}(e.toLowerCase(),t)}))}function Be(e,t){if(e&&(e.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(e))&&(Fe(e,"audio")||Fe(e,"video")))return e;if(t){var r=t.split(",");if(r.length>1){if(e)for(var n=r.length;n--;)if(r[n].substring(0,4)===e.substring(0,4))return r[n];return r[0]}}return t||e}function Fe(e,t){return we(e,t)&&Me(e,t)}function Ve(e){if(e.startsWith("av01.")){for(var t=e.split("."),r=["0","111","01","01","01","0"],n=t.length;n>4&&n<10;n++)t[n]=r[n-4];return t.join(".")}return e}function Ge(e){var t=K(e)||{isTypeSupported:function(){return!1}};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function He(e){return e.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}var Ke={supported:!1,smooth:!1,powerEfficient:!1},We={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function $e(e,t){return{supported:!1,configurations:t,decodingInfoResults:[Ke],error:e}}function ze(e,t,r,n){void 0===n&&(n={});var a=e.videoCodec;if(!a&&!e.audioCodec||!r)return Promise.resolve(We);for(var i=[],s=function(e){var t,r=null==(t=e.videoCodec)?void 0:t.split(","),n=Ye(e),a=e.width||640,i=e.height||480,s=e.frameRate||30,o=e.videoRange.toLowerCase();return r?r.map((function(e){var t={contentType:De(Ve(e),"video"),width:a,height:i,bitrate:n,framerate:s};return"sdr"!==o&&(t.transferFunction=o),t})):[]}(e),o=s.length,l=function(e,t,r){var n,a=null==(n=e.audioCodec)?void 0:n.split(","),i=Ye(e);return a&&e.audioGroups?e.audioGroups.reduce((function(e,n){var s,o=n?null==(s=t.groups[n])?void 0:s.tracks:null;return o?o.reduce((function(e,t){if(t.groupId===n){var s=parseFloat(t.channels||"");a.forEach((function(t){var n={contentType:De(t,"audio"),bitrate:r?qe(t,i):i};s&&(n.channels=""+s),e.push(n)}))}return e}),e):e}),[]):[]}(e,t,o>0),u=l.length,c=o||1*u||1;c--;){var d={type:"media-source"};if(o&&(d.video=s[c%o]),u){d.audio=l[c%u];var p=d.audio.bitrate;d.video&&p&&(d.video.bitrate-=p)}i.push(d)}if(a){var h=navigator.userAgent;if(a.split(",").some((function(e){return Te(e)}))&&xe())return Promise.resolve($e(new Error("Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: ("+h+")"),i))}return Promise.all(i.map((function(e){var t,a,i,s,o=(a="",i=(t=e).audio,(s=t.video)&&(a+=He(s.contentType)+"_r"+s.height+"x"+s.width+"f"+Math.ceil(s.framerate)+(s.transferFunction||"sd")+"_"+Math.ceil(s.bitrate/1e5)),i&&(a+=(s?"_":"")+He(i.contentType)+"_c"+i.channels),a);return n[o]||(n[o]=r.decodingInfo(e))}))).then((function(e){return{supported:!e.some((function(e){return!e.supported})),configurations:i,decodingInfoResults:e}})).catch((function(e){return{supported:!1,configurations:i,decodingInfoResults:[],error:e}}))}function qe(e,t){if(t<=1)return 1;var r=128e3;return"ec-3"===e?r=768e3:"ac-3"===e&&(r=64e4),Math.min(t/2,r)}function Ye(e){return 1e3*Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)/1e3)||1}var Xe=["NONE","TYPE-0","TYPE-1",null],Ze=["SDR","PQ","HLG"];function Qe(e){var t=e.canSkipUntil,r=e.canSkipDateRanges,n=e.age;return t&&n<t/2?r?"v2":"YES":""}var Je=function(){function e(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}return e.prototype.addDirectives=function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href},e}(),et=function(){function e(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter((function(e){return!!e})).map((function(e){return e.substring(0,4)})).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;var r=null==(t=e.supplemental)?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=","+r.substring(0,4))}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}var t=e.prototype;return t.hasAudioGroup=function(e){return tt(this._audioGroups,e)},t.hasSubtitleGroup=function(e){return tt(this._subtitleGroups,e)},t.addGroupId=function(e,t){if(t)if("audio"===e){var r=this._audioGroups;r||(r=this._audioGroups=[]),-1===r.indexOf(t)&&r.push(t)}else if("text"===e){var n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),-1===n.indexOf(t)&&n.push(t)}},t.addFallback=function(){},n(e,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"averageBitrate",get:function(){return this._avgBitrate||this.realBitrate||this.bitrate}},{key:"attrs",get:function(){return this._attrs[0]}},{key:"codecs",get:function(){return this.attrs.CODECS||""}},{key:"pathwayId",get:function(){return this.attrs["PATHWAY-ID"]||"."}},{key:"videoRange",get:function(){return this.attrs["VIDEO-RANGE"]||"SDR"}},{key:"score",get:function(){return this.attrs.optionalFloat("SCORE",0)}},{key:"uri",get:function(){return this.url[0]||""}},{key:"audioGroups",get:function(){return this._audioGroups}},{key:"subtitleGroups",get:function(){return this._subtitleGroups}},{key:"urlId",get:function(){return 0},set:function(e){}},{key:"audioGroupIds",get:function(){return this.audioGroups?[this.audioGroupId]:void 0}},{key:"textGroupIds",get:function(){return this.subtitleGroups?[this.textGroupId]:void 0}},{key:"audioGroupId",get:function(){var e;return null==(e=this.audioGroups)?void 0:e[0]}},{key:"textGroupId",get:function(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}}])}();function tt(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}var rt=function(e,t){return JSON.stringify(e,function(e){var t=new WeakSet;return function(r,n){if(e&&(n=e(r,n)),"object"==typeof n&&null!==n){if(t.has(n))return;t.add(n)}return n}}(t))};function nt(e,t){H.log('[abr] start candidates with "'+e+'" ignored because '+t)}function at(e){return e.reduce((function(e,t){var r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);var n=t.channels||"2";return r.channels[n]=(r.channels[n]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function it(e){if(!e)return e;var t=e;return{lang:t.lang,assocLang:t.assocLang,characteristics:t.characteristics,channels:t.channels,audioCodec:t.audioCodec}}function st(e,t,r){if("attrs"in e){var n=t.indexOf(e);if(-1!==n)return n}for(var a=0;a<t.length;a++)if(ot(e,t[a],r))return a;return-1}function ot(e,t,r){var n,a,i=e.groupId,s=e.name,o=e.lang,l=e.assocLang,u=e.default,c=e.forced;return(void 0===i||t.groupId===i)&&(void 0===s||t.name===s)&&(void 0===o||(n=o,void 0===(a=t.lang)&&(a="--"),n.length===a.length?n===a:n.startsWith(a)||a.startsWith(n)))&&(void 0===o||t.assocLang===l)&&(void 0===u||t.default===u)&&(void 0===c||t.forced===c)&&(!("characteristics"in e)||function(e,t){void 0===t&&(t="");var r=e.split(","),n=t.split(",");return r.length===n.length&&!r.some((function(e){return-1===n.indexOf(e)}))}(e.characteristics||"",t.characteristics))&&(void 0===r||r(e,t))}function lt(e,t){var r=e.audioCodec,n=e.channels;return!(void 0!==r&&(t.audioCodec||"").substring(0,4)!==r.substring(0,4)||void 0!==n&&n!==(t.channels||"2"))}function ut(e,t,r){for(var n=t;n>-1;n--)if(r(e[n]))return n;for(var a=t+1;a<e.length;a++)if(r(e[a]))return a;return-1}function ct(e,t){var r;return!!e&&e!==(null==(r=t.loadLevelObj)?void 0:r.uri)}var dt=function(e){function t(t){var r;return(r=e.call(this,"abr",t.logger)||this).hls=void 0,r.lastLevelLoadSec=0,r.lastLoadedFragLevel=-1,r.firstSelection=-1,r._nextAutoLevel=-1,r.nextAutoLevelKey="",r.audioTracksByGroup=null,r.codecTiers=null,r.timer=-1,r.fragCurrent=null,r.partCurrent=null,r.bitrateTestDelay=0,r.rebufferNotice=-1,r.supportedCache={},r.bwEstimator=void 0,r._abandonRulesCheck=function(e){var t,n=r,a=n.fragCurrent,i=n.partCurrent,s=n.hls,o=s.autoLevelEnabled,l=s.media;if(a&&l){var u=performance.now(),c=i?i.stats:a.stats,d=i?i.duration:a.duration,p=u-c.loading.start,h=s.minAutoLevel,f=a.level,m=r._nextAutoLevel;if(c.aborted||c.loaded&&c.loaded===c.total||f<=h)return r.clearTimer(),void(r._nextAutoLevel=-1);if(o){var g=m>-1&&m!==f,y=!!e||g;if(y||!l.paused&&l.playbackRate&&l.readyState){var v=s.mainForwardBufferInfo;if(y||null!==v){var _=r.bwEstimator.getEstimateTTFB(),k=Math.abs(l.playbackRate);if(!(p<=Math.max(_,d/(2*k)*1e3))){var b=v?v.len/k:0,T=c.loading.first?c.loading.first-c.loading.start:-1,A=c.loaded&&T>-1,S=r.getBwEstimate(),C=s.levels,x=C[f],I=Math.max(c.loaded,Math.round(d*(a.bitrate||x.averageBitrate)/8)),w=A?p-T:p;w<1&&A&&(w=Math.min(p,8*c.loaded/S));var R=A?1e3*c.loaded/w:0,M=_/1e3,D=R?(I-c.loaded)/R:8*I/S+M;if(!(D<=b)){var O,L=R?8*R:S,N=!0===(null==(t=(null==e?void 0:e.details)||r.hls.latestLevelDetails)?void 0:t.live),U=r.hls.config.abrBandWidthUpFactor,j=Number.POSITIVE_INFINITY;for(O=f-1;O>h;O--){var B=C[O].maxBitrate,F=!C[O].details||N;if((j=r.getTimeToLoadFrag(M,L,d*B,F))<Math.min(b,d+M))break}if(!(j>=D||j>10*d)){A?r.bwEstimator.sample(p-Math.min(_,T),c.loaded):r.bwEstimator.sampleTTFB(p);var V=C[O].maxBitrate;r.getBwEstimate()*U>V&&r.resetEstimator(V);var G=r.findBestLevel(V,h,O,0,b,1,1);G>-1&&(O=G),r.warn("Fragment "+a.sn+(i?" part "+i.index:"")+" of level "+f+" is loading too slowly;\n      Fragment duration: "+a.duration.toFixed(3)+"\n      Time to underbuffer: "+b.toFixed(3)+" s\n      Estimated load time for current fragment: "+D.toFixed(3)+" s\n      Estimated load time for down switch fragment: "+j.toFixed(3)+" s\n      TTFB estimate: "+(0|T)+" ms\n      Current BW estimate: "+(E(S)?0|S:"Unknown")+" bps\n      New BW estimate: "+(0|r.getBwEstimate())+" bps\n      Switching to level "+O+" @ "+(0|V)+" bps"),s.nextLoadLevel=s.nextAutoLevel=O,r.clearTimer();var H=function(){if(r.clearTimer(),r.fragCurrent===a&&r.hls.loadLevel===O&&O>0){var e=r.getStarvationDelay();if(r.warn("Aborting inflight request "+(O>0?"and switching down":"")+"\n      Fragment duration: "+a.duration.toFixed(3)+" s\n      Time to underbuffer: "+e.toFixed(3)+" s"),a.abortRequests(),r.fragCurrent=r.partCurrent=null,O>h){var t=r.findBestLevel(r.hls.levels[h].bitrate,h,O,0,e,1,1);-1===t&&(t=h),r.hls.nextLoadLevel=r.hls.nextAutoLevel=t,r.resetEstimator(r.hls.levels[t].bitrate)}}};g||D>2*j?H():r.timer=self.setInterval(H,1e3*j),s.trigger(P.FRAG_LOAD_EMERGENCY_ABORTED,{frag:a,part:i,stats:c})}}}}}}}},r.hls=t,r.bwEstimator=r.initEstimator(),r.registerListeners(),r}o(t,e);var r=t.prototype;return r.resetEstimator=function(e){e&&(this.log("setting initial bwe to "+e),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()},r.initEstimator=function(){var e=this.hls.config;return new L(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)},r.registerListeners=function(){var e=this.hls;e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.FRAG_LOADING,this.onFragLoading,this),e.on(P.FRAG_LOADED,this.onFragLoaded,this),e.on(P.FRAG_BUFFERED,this.onFragBuffered,this),e.on(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(P.LEVEL_LOADED,this.onLevelLoaded,this),e.on(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(P.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(P.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.FRAG_LOADING,this.onFragLoading,this),e.off(P.FRAG_LOADED,this.onFragLoaded,this),e.off(P.FRAG_BUFFERED,this.onFragBuffered,this),e.off(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(P.LEVEL_LOADED,this.onLevelLoaded,this),e.off(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(P.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(P.ERROR,this.onError,this))},r.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null},r.onManifestLoading=function(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()},r.onLevelsUpdated=function(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null},r.onMaxAutoLevelUpdated=function(){this.firstSelection=-1,this.nextAutoLevelKey=""},r.onFragLoading=function(e,t){var r,n=t.frag;this.ignoreFragment(n)||(n.bitrateTest||(this.fragCurrent=n,this.partCurrent=null!=(r=t.part)?r:null),this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100))},r.onLevelSwitching=function(e,t){this.clearTimer()},r.onError=function(e,t){if(!t.fatal)switch(t.details){case S.BUFFER_ADD_CODEC_ERROR:case S.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case S.FRAG_LOAD_TIMEOUT:var r=t.frag,n=this.fragCurrent,a=this.partCurrent;if(r&&n&&r.sn===n.sn&&r.level===n.level){var i=performance.now(),s=a?a.stats:r.stats,o=i-s.loading.start,l=s.loading.first?s.loading.first-s.loading.start:-1;if(s.loaded&&l>-1){var u=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(o-Math.min(u,l),s.loaded)}else this.bwEstimator.sampleTTFB(o)}}},r.getTimeToLoadFrag=function(e,t,r,n){return e+r/t+(n?e+this.lastLevelLoadSec:0)},r.onLevelLoaded=function(e,t){var r=this.hls.config,n=t.stats.loading,a=n.end-n.first;E(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)},r.onFragLoaded=function(e,t){var r=t.frag,n=t.part,a=n?n.stats:r.stats;if(r.type===R&&this.bwEstimator.sampleTTFB(a.loading.first-a.loading.start),!this.ignoreFragment(r)){if(this.clearTimer(),r.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){var i=n?n.duration:r.duration,s=this.hls.levels[r.level],o=(s.loaded?s.loaded.bytes:0)+a.loaded,l=(s.loaded?s.loaded.duration:0)+i;s.loaded={bytes:o,duration:l},s.realBitrate=Math.round(8*o/l)}if(r.bitrateTest){var u={stats:a,frag:r,part:n,id:r.type};this.onFragBuffered(P.FRAG_BUFFERED,u),r.bitrateTest=!1}else this.lastLoadedFragLevel=r.level}},r.onFragBuffered=function(e,t){var r=t.frag,n=t.part,a=null!=n&&n.stats.loaded?n.stats:r.stats;if(!a.aborted&&!this.ignoreFragment(r)){var i=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(i,a.loaded),a.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},r.ignoreFragment=function(e){return e.type!==R||"initSegment"===e.sn},r.clearTimer=function(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)},r.getAutoLevelKey=function(){return this.getBwEstimate()+"_"+this.getStarvationDelay().toFixed(2)},r.getNextABRAutoLevel=function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls;if(r.levels.length<=1)return r.loadLevel;var n=r.maxAutoLevel,a=r.config,i=r.minAutoLevel,s=t?t.duration:e?e.duration:0,o=this.getBwEstimate(),l=this.getStarvationDelay(),u=a.abrBandWidthFactor,c=a.abrBandWidthUpFactor;if(l){var d=this.findBestLevel(o,i,n,l,0,u,c);if(d>=0)return this.rebufferNotice=-1,d}var p=s?Math.min(s,a.maxStarvationDelay):a.maxStarvationDelay;if(!l){var h=this.bitrateTestDelay;h&&(p=(s?Math.min(s,a.maxLoadingDelay):a.maxLoadingDelay)-h,this.info("bitrate test took "+Math.round(1e3*h)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),u=c=1)}var f=this.findBestLevel(o,i,n,l,p,u,c);if(this.rebufferNotice!==f&&(this.rebufferNotice=f,this.info((l?"rebuffering expected":"buffer is empty")+", optimal quality level "+f)),f>-1)return f;var m=r.levels[i],g=r.loadLevelObj;return g&&(null==m?void 0:m.bitrate)<g.bitrate?i:r.loadLevel},r.getStarvationDelay=function(){var e=this.hls,t=e.media;if(!t)return 1/0;var r=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,n=e.mainForwardBufferInfo;return(n?n.len:0)/r},r.getBwEstimate=function(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate},r.findBestLevel=function(e,t,r,n,a,i,s){var o,l=this,u=n+a,c=this.lastLoadedFragLevel,d=-1===c?this.hls.firstLevel:c,p=this.fragCurrent,h=this.partCurrent,f=this.hls,m=f.levels,g=f.allAudioTracks,y=f.loadLevel,v=f.config;if(1===m.length)return 0;var _,k=m[d],b=!(null==(o=this.hls.latestLevelDetails)||!o.live),T=-1===y||-1===c,A="SDR",S=(null==k?void 0:k.frameRate)||0,P=v.audioPreference,C=v.videoPreference,x=this.audioTracksByGroup||(this.audioTracksByGroup=at(g)),I=-1;if(T){if(-1!==this.firstSelection)return this.firstSelection;var w=this.codecTiers||(this.codecTiers=function(e,t,r,n){return e.slice(r,n+1).reduce((function(e,r,n){if(!r.codecSet)return e;var a=r.audioGroups,i=e[r.codecSet];i||(e[r.codecSet]=i={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:n,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!a,fragmentError:0}),i.minBitrate=Math.min(i.minBitrate,r.bitrate);var s=Math.min(r.height,r.width);return i.minHeight=Math.min(i.minHeight,s),i.minFramerate=Math.min(i.minFramerate,r.frameRate),i.minIndex=Math.min(i.minIndex,n),i.maxScore=Math.max(i.maxScore,r.score),i.fragmentError+=r.fragmentError,i.videoRanges[r.videoRange]=(i.videoRanges[r.videoRange]||0)+1,a&&a.forEach((function(e){if(e){var r=t.groups[e];r&&(i.hasDefaultAudio=i.hasDefaultAudio||t.hasDefaultAudio?r.hasDefault:r.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(r.channels).forEach((function(e){i.channels[e]=(i.channels[e]||0)+r.channels[e]})))}})),e}),{})}(m,x,t,r)),R=function(e,t,r,n,a){for(var i=Object.keys(e),s=null==n?void 0:n.channels,o=null==n?void 0:n.audioCodec,l=null==a?void 0:a.videoCodec,u=s&&2===parseInt(s),c=!1,d=!1,p=1/0,h=1/0,f=1/0,m=1/0,g=0,y=[],v=function(e,t){var r=!1,n=[];if(e&&(r="SDR"!==e,n=[e]),t){var a="SDR"!==(n=t.allowedVideoRanges||Ze.slice(0)).join("")&&!t.videoCodec;(r=void 0!==t.preferHDR?t.preferHDR:a&&function(){if("function"==typeof matchMedia){var e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}())||(n=["SDR"])}return{preferHDR:r,allowedVideoRanges:n}}(t,a),_=v.preferHDR,k=v.allowedVideoRanges,b=function(){var t=e[i[T]];c||(c=t.channels[2]>0),p=Math.min(p,t.minHeight),h=Math.min(h,t.minFramerate),f=Math.min(f,t.minBitrate),k.filter((function(e){return t.videoRanges[e]>0})).length>0&&(d=!0)},T=i.length;T--;)b();p=E(p)?p:0,h=E(h)?h:0;var A=Math.max(1080,p),S=Math.max(30,h);f=E(f)?f:r,r=Math.max(f,r),d||(t=void 0);var P=i.length>1;return{codecSet:i.reduce((function(t,n){var a=e[n];if(n===t)return t;if(y=d?k.filter((function(e){return a.videoRanges[e]>0})):[],P){if(a.minBitrate>r)return nt(n,"min bitrate of "+a.minBitrate+" > current estimate of "+r),t;if(!a.hasDefaultAudio)return nt(n,"no renditions with default or auto-select sound found"),t;if(o&&n.indexOf(o.substring(0,4))%5!=0)return nt(n,'audio codec preference "'+o+'" not found'),t;if(s&&!u){if(!a.channels[s])return nt(n,"no renditions with "+s+" channel sound found (channels options: "+Object.keys(a.channels)+")"),t}else if((!o||u)&&c&&0===a.channels[2])return nt(n,"no renditions with stereo sound found"),t;if(a.minHeight>A)return nt(n,"min resolution of "+a.minHeight+" > maximum of "+A),t;if(a.minFramerate>S)return nt(n,"min framerate of "+a.minFramerate+" > maximum of "+S),t;if(!y.some((function(e){return a.videoRanges[e]>0})))return nt(n,"no variants with VIDEO-RANGE of "+rt(y)+" found"),t;if(l&&n.indexOf(l.substring(0,4))%5!=0)return nt(n,'video codec preference "'+l+'" not found'),t;if(a.maxScore<g)return nt(n,"max score of "+a.maxScore+" < selected max of "+g),t}return t&&(Le(n)>=Le(t)||a.fragmentError>e[t].fragmentError)?t:(m=a.minIndex,g=a.maxScore,n)}),void 0),videoRanges:y,preferHDR:_,minFramerate:h,minBitrate:f,minIndex:m}}(w,A,e,P,C),M=R.codecSet,D=R.videoRanges,O=R.minFramerate,L=R.minBitrate,N=R.minIndex,U=R.preferHDR;I=N,_=M,A=U?D[D.length-1]:D[0],S=O,e=Math.max(e,L),this.log("picked start tier "+rt(R))}else _=null==k?void 0:k.codecSet,A=null==k?void 0:k.videoRange;for(var j,B=h?h.duration:p?p.duration:0,F=this.bwEstimator.getEstimateTTFB()/1e3,V=[],G=function(){var t,o=m[H],p=H>d;if(!o)return 0;if(v.useMediaCapabilities&&!o.supportedResult&&!o.supportedPromise){var f=navigator.mediaCapabilities;"function"==typeof(null==f?void 0:f.decodingInfo)&&function(e,t,r,n,a,i){var s=e.videoCodec,o=e.audioCodec?e.audioGroups:null,l=null==i?void 0:i.audioCodec,u=null==i?void 0:i.channels,c=u?parseInt(u):l?1/0:2,d=null;if(null!=o&&o.length)try{d=1===o.length&&o[0]?t.groups[o[0]].channels:o.reduce((function(e,r){if(r){var n=t.groups[r];if(!n)throw new Error("Audio track group "+r+" not found");Object.keys(n.channels).forEach((function(t){e[t]=(e[t]||0)+n.channels[t]}))}return e}),{2:0})}catch(e){return!0}return void 0!==s&&(s.split(",").some((function(e){return Te(e)}))||e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(n,30)||"SDR"!==e.videoRange&&e.videoRange!==r||e.bitrate>Math.max(a,8e6))||!!d&&E(c)&&Object.keys(d).some((function(e){return parseInt(e)>c}))}(o,x,A,S,e,P)?(o.supportedPromise=ze(o,x,f,l.supportedCache),o.supportedPromise.then((function(e){if(l.hls){o.supportedResult=e;var t=l.hls.levels,r=t.indexOf(o);e.error?l.warn('MediaCapabilities decodingInfo error: "'+e.error+'" for level '+r+" "+rt(e)):e.supported?e.decodingInfoResults.some((function(e){return!1===e.smooth||!1===e.powerEfficient}))&&l.log("MediaCapabilities decodingInfo for level "+r+" not smooth or powerEfficient: "+rt(e)):(l.warn("Unsupported MediaCapabilities decodingInfo result for level "+r+" "+rt(e)),r>-1&&t.length>1&&(l.log("Removing unsupported level "+r),l.hls.removeLevel(r),-1===l.hls.loadLevel&&(l.hls.nextLoadLevel=0)))}})).catch((function(e){l.warn("Error handling MediaCapabilities decodingInfo: "+e)}))):o.supportedResult=We}if((_&&o.codecSet!==_||A&&o.videoRange!==A||p&&S>o.frameRate||!p&&S>0&&S<o.frameRate||null!=(t=o.supportedResult)&&null!=(t=t.decodingInfoResults)&&t.some((function(e){return!1===e.smooth})))&&(!T||H!==I))return V.push(H),0;var g,k=o.details,C=(h?null==k?void 0:k.partTarget:null==k?void 0:k.averagetargetduration)||B;g=p?s*e:i*e;var w=B&&n>=2*B&&0===a?o.averageBitrate:o.maxBitrate,R=l.getTimeToLoadFrag(F,g,w*C,void 0===k);if(g>=w&&(H===c||0===o.loadError&&0===o.fragmentError)&&(R<=F||!E(R)||b&&!l.bitrateTestDelay||R<u)){var M=l.forcedAutoLevel;return H===y||-1!==M&&M===y||(V.length&&l.trace("Skipped level(s) "+V.join(",")+" of "+r+' max with CODECS and VIDEO-RANGE:"'+m[V[0]].codecs+'" '+m[V[0]].videoRange+'; not compatible with "'+_+'" '+A),l.info("switch candidate:"+d+"->"+H+" adjustedbw("+Math.round(g)+")-bitrate="+Math.round(g-w)+" ttfb:"+F.toFixed(1)+" avgDuration:"+C.toFixed(1)+" maxFetchDuration:"+u.toFixed(1)+" fetchDuration:"+R.toFixed(1)+" firstSelection:"+T+" codecSet:"+o.codecSet+" videoRange:"+o.videoRange+" hls.loadLevel:"+y)),T&&(l.firstSelection=H),{v:H}}},H=r;H>=t;H--)if(0!==(j=G())&&j)return j.v;return-1},r.deriveNextAutoLevel=function(e){var t=this.hls,r=t.maxAutoLevel,n=t.minAutoLevel;return Math.min(Math.max(e,n),r)},n(t,[{key:"firstAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.minAutoLevel,n=this.getBwEstimate(),a=this.hls.config.maxStarvationDelay,i=this.findBestLevel(n,r,t,0,a,1,1);if(i>-1)return i;var s=this.hls.firstLevel,o=Math.min(Math.max(s,r),t);return this.warn("Could not find best starting auto level. Defaulting to first in playlist "+s+" clamped to "+o),o}},{key:"forcedAutoLevel",get:function(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}},{key:"nextAutoLevel",get:function(){var e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(!(-1===e||t&&r&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return e;var n=t&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){var a=this.hls.levels;if(a.length>Math.max(e,n)&&a[e].loadError<=a[n].loadError)return e}return this._nextAutoLevel=n,this.nextAutoLevelKey=this.getAutoLevelKey(),n},set:function(e){var t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}}])}(N),pt=function(e,t){for(var r=0,n=e.length-1,a=null,i=null;r<=n;){var s=t(i=e[a=(r+n)/2|0]);if(s>0)r=a+1;else{if(!(s<0))return i;n=a-1}}return null};function ht(e,t,r,n,a){void 0===r&&(r=0),void 0===n&&(n=0),void 0===a&&(a=.005);var i=null;if(e){i=t[1+e.sn-t[0].sn]||null;var s=e.endDTS-r;s>0&&s<15e-7&&(r+=15e-7),i&&e.level!==i.level&&i.end<=e.end&&(i=t[2+e.sn-t[0].sn]||null)}else 0===r&&0===t[0].start&&(i=t[0]);if(i&&((!e||e.level===i.level)&&0===ft(r,n,i)||function(e,t,r){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){var n=t.tagList.reduce((function(e,t){return"INF"===t[0]&&(e+=parseFloat(t[1])),e}),r);return e.start<=n}return!1}(i,e,Math.min(a,n))))return i;var o=pt(t,ft.bind(null,r,n));return!o||o===e&&i?i:o}function ft(e,t,r){if(void 0===e&&(e=0),void 0===t&&(t=0),r.start<=e&&r.start+r.duration>e)return 0;var n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=e?1:r.start-n>e&&r.start?-1:0}function mt(e,t,r){var n=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>e}function gt(e,t,r){if(e&&e.startCC<=t&&e.endCC>=t){var n,a=e.fragments,i=e.fragmentHint;return i&&(a=a.concat(i)),pt(a,(function(e){return e.cc<t?1:e.cc>t?-1:(n=e,e.end<=r?1:e.start>r?-1:0)})),n||null}return null}function yt(e){switch(e.details){case S.FRAG_LOAD_TIMEOUT:case S.KEY_LOAD_TIMEOUT:case S.LEVEL_LOAD_TIMEOUT:case S.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function vt(e){return e.details.startsWith("key")}function _t(e){return vt(e)&&!!e.frag&&!e.frag.decryptdata}function kt(e,t){var r=yt(t);return e.default[(r?"timeout":"error")+"Retry"]}function Et(e,t){var r="linear"===e.backoff?1:Math.pow(2,t);return Math.min(r*e.retryDelayMs,e.maxRetryDelayMs)}function bt(e){return c(c({},e),{errorRetry:null,timeoutRetry:null})}function Tt(e,t,r,n){if(!e)return!1;var a=null==n?void 0:n.code,i=t<e.maxNumRetry&&(function(e){return At(e)||!!e&&(e<400||e>499)}(a)||!!r);return e.shouldRetry?e.shouldRetry(e,t,r,n,i):i}function At(e){return 0===e&&!1===navigator.onLine}var St=function(e){function t(t){var r;return(r=e.call(this,"error-controller",t.logger)||this).hls=void 0,r.playlistError=0,r.hls=t,r.registerListeners(),r}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(P.ERROR,this.onError,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.LEVEL_UPDATED,this.onLevelUpdated,this)},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(P.ERROR,this.onError,this),e.off(P.ERROR,this.onErrorOut,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.LEVEL_UPDATED,this.onLevelUpdated,this))},r.destroy=function(){this.unregisterListeners(),this.hls=null},r.startLoad=function(e){},r.stopLoad=function(){this.playlistError=0},r.getVariantLevelIndex=function(e){return(null==e?void 0:e.type)===R?e.level:this.getVariantIndex()},r.getVariantIndex=function(){var e,t=this.hls,r=t.currentLevel;return null!=(e=t.loadLevelObj)&&e.details||-1===r?t.loadLevel:r},r.variantHasKey=function(e,t){if(e){var r;if(null!=(r=e.details)&&r.hasKey(t))return!0;var n=e.audioGroups;if(n)return this.hls.allAudioTracks.filter((function(e){return n.indexOf(e.groupId)>=0})).some((function(e){var r;return null==(r=e.details)?void 0:r.hasKey(t)}))}return!1},r.onManifestLoading=function(){this.playlistError=0},r.onLevelUpdated=function(){this.playlistError=0},r.onError=function(e,t){var r;if(!t.fatal){var n=this.hls,a=t.context;switch(t.details){case S.FRAG_LOAD_ERROR:case S.FRAG_LOAD_TIMEOUT:case S.KEY_LOAD_ERROR:case S.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case S.FRAG_PARSING_ERROR:if(null!=(r=t.frag)&&r.gap)return void(t.errorAction=Pt());case S.FRAG_GAP:case S.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=2);case S.LEVEL_EMPTY_ERROR:case S.LEVEL_PARSING_ERROR:var i,s=t.parent===R?t.level:n.loadLevel;return void(t.details===S.LEVEL_EMPTY_ERROR&&null!=(i=t.context)&&null!=(i=i.levelDetails)&&i.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,s)));case S.LEVEL_LOAD_ERROR:case S.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==a?void 0:a.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level)));case S.AUDIO_TRACK_LOAD_ERROR:case S.AUDIO_TRACK_LOAD_TIMEOUT:case S.SUBTITLE_LOAD_ERROR:case S.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){var o=n.loadLevelObj;if(o&&(a.type===I&&o.hasAudioGroup(a.groupId)||a.type===w&&o.hasSubtitleGroup(a.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.loadLevel),t.errorAction.action=2,void(t.errorAction.flags=1)}return;case S.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:return void(t.errorAction={action:2,flags:2});case S.KEY_SYSTEM_SESSION_UPDATE_FAILED:case S.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case S.KEY_SYSTEM_NO_SESSION:return void(t.errorAction={action:2,flags:4});case S.BUFFER_ADD_CODEC_ERROR:case S.REMUX_ALLOC_ERROR:case S.BUFFER_APPEND_ERROR:var l;return void(t.errorAction||(t.errorAction=this.getLevelSwitchAction(t,null!=(l=t.level)?l:n.loadLevel)));case S.INTERNAL_EXCEPTION:case S.BUFFER_APPENDING_ERROR:case S.BUFFER_FULL_ERROR:case S.LEVEL_SWITCH_ERROR:case S.BUFFER_STALLED_ERROR:case S.BUFFER_SEEK_OVER_HOLE:case S.BUFFER_NUDGE_ON_STALL:return void(t.errorAction=Pt())}t.type===A.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=Pt())}},r.getPlaylistRetryOrSwitchAction=function(e,t){var r=kt(this.hls.config.playlistLoadPolicy,e),n=this.playlistError++;if(Tt(r,n,yt(e),e.response))return{action:5,flags:0,retryConfig:r,retryCount:n};var a=this.getLevelSwitchAction(e,t);return r&&(a.retryConfig=r,a.retryCount=n),a},r.getFragRetryOrSwitchAction=function(e){var t=this.hls,r=this.getVariantLevelIndex(e.frag),n=t.levels[r],a=t.config,i=a.fragLoadPolicy,s=a.keyLoadPolicy,o=kt(vt(e)?s:i,e),l=t.levels.reduce((function(e,t){return e+t.fragmentError}),0);if(n&&(e.details!==S.FRAG_GAP&&n.fragmentError++,!_t(e)&&Tt(o,l,yt(e),e.response)))return{action:5,flags:0,retryConfig:o,retryCount:l};var u=this.getLevelSwitchAction(e,r);return o&&(u.retryConfig=o,u.retryCount=l),u},r.getLevelSwitchAction=function(e,t){var r=this.hls;null==t&&(t=r.loadLevel);var n=this.hls.levels[t];if(n){var a,i,s=e.details;n.loadError++,s===S.BUFFER_APPEND_ERROR&&n.fragmentError++;var o=-1,l=r.levels,u=r.loadLevel,c=r.minAutoLevel,d=r.maxAutoLevel;r.autoLevelEnabled||r.config.preserveManualLevelOnError||(r.loadLevel=-1);for(var p,h=null==(a=e.frag)?void 0:a.type,f=(h===M&&s===S.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(s===S.BUFFER_ADD_CODEC_ERROR||s===S.BUFFER_APPEND_ERROR))&&l.some((function(e){var t=e.audioCodec;return n.audioCodec!==t})),m="video"===e.sourceBufferName&&(s===S.BUFFER_ADD_CODEC_ERROR||s===S.BUFFER_APPEND_ERROR)&&l.some((function(e){var t=e.codecSet,r=e.audioCodec;return n.codecSet!==t&&n.audioCodec===r})),g=null!=(i=e.context)?i:{},y=g.type,v=g.groupId,_=function(){var t=(k+u)%l.length;if(t!==u&&t>=c&&t<=d&&0===l[t].loadError){var r,a,i=l[t];if(s===S.FRAG_GAP&&h===R&&e.frag){var p=l[t].details;if(p){var g=ht(e.frag,p.fragments,e.frag.start);if(null!=g&&g.gap)return 0}}else{if(y===I&&i.hasAudioGroup(v)||y===w&&i.hasSubtitleGroup(v))return 0;if(h===M&&null!=(r=n.audioGroups)&&r.some((function(e){return i.hasAudioGroup(e)}))||h===D&&null!=(a=n.subtitleGroups)&&a.some((function(e){return i.hasSubtitleGroup(e)}))||f&&n.audioCodec===i.audioCodec||m&&n.codecSet===i.codecSet||!f&&n.codecSet!==i.codecSet)return 0}return o=t,1}},k=l.length;k--&&(0===(p=_())||1!==p););if(o>-1&&r.loadLevel!==o)return e.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:o}}return{action:2,flags:1}},r.onErrorOut=function(e,t){var r;switch(null==(r=t.errorAction)?void 0:r.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===S.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn('MediaSource ended after "'+t.sourceBufferName+'" sourceBuffer append error. Attempting to recover from media error.'),this.hls.recoverMediaError()):t.fatal=!0}t.fatal&&this.hls.stopLoad()},r.sendAlternateToPenaltyBox=function(e){var t=this.hls,r=e.errorAction;if(r){var n=r.flags,a=r.nextAutoLevel;switch(n){case 0:this.switchLevel(e,a);break;case 2:var i=this.getVariantLevelIndex(e.frag),s=t.levels[i],o=null==s?void 0:s.attrs["HDCP-LEVEL"];if(r.hdcpLevel=o,"NONE"===o)this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(o){t.maxHdcpLevel=Xe[Xe.indexOf(o)-1],r.resolved=!0,this.warn('Restricting playback to HDCP-LEVEL of "'+t.maxHdcpLevel+'" or lower');break}case 4:var l=e.decryptdata;if(l){for(var u=this.hls.levels,c=u.length,d=c;d--;){var p,h;this.variantHasKey(u[d],l)&&(this.log("Banned key found in level "+d+" ("+u[d].bitrate+'bps) or audio group "'+(null==(p=u[d].audioGroups)?void 0:p.join(","))+'" ('+(null==(h=e.frag)?void 0:h.type)+" fragment) "+z(l.keyId||[])),u[d].fragmentError++,u[d].loadError++,this.log("Removing level "+d+" with key error ("+e.error+")"),this.hls.removeLevel(d))}var f=e.frag;if(this.hls.levels.length<c)r.resolved=!0;else if(f&&f.type!==R){var m=f.decryptdata;m&&!l.matches(m)&&(r.resolved=!0)}}}r.resolved||this.switchLevel(e,a)}},r.switchLevel=function(e,t){if(void 0!==t&&e.errorAction&&(this.warn("switching to level "+t+" after "+e.details),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===S.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&"audiovideo"!==e.sourceBufferName))for(var r=He(e.mimeType),n=this.hls.levels,a=n.length;a--;)n[a][e.sourceBufferName+"Codec"]===r&&(this.log("Removing level "+a+" for "+e.details+' ("'+r+'" not supported)'),this.hls.removeLevel(a))},t}(N);function Pt(e){var t={action:0,flags:0};return e&&(t.resolved=!0),t}var Ct="NOT_LOADED",xt="APPENDING",It="PARTIAL",wt="OK",Rt=function(){function e(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}var t=e.prototype;return t._registerListeners=function(){var e=this.hls;e&&(e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.BUFFER_APPENDED,this.onBufferAppended,this),e.on(P.FRAG_BUFFERED,this.onFragBuffered,this),e.on(P.FRAG_LOADED,this.onFragLoaded,this))},t._unregisterListeners=function(){var e=this.hls;e&&(e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.BUFFER_APPENDED,this.onBufferAppended,this),e.off(P.FRAG_BUFFERED,this.onFragBuffered,this),e.off(P.FRAG_LOADED,this.onFragLoaded,this))},t.destroy=function(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null},t.getAppendedFrag=function(e,t){var r=this.activePartLists[t];if(r)for(var n=r.length;n--;){var a=r[n];if(!a)break;if(a.start<=e&&e<=a.end&&a.loaded)return a}return this.getBufferedFrag(e,t)},t.getBufferedFrag=function(e,t){return this.getFragAtPos(e,t,!0)},t.getFragAtPos=function(e,t,r){for(var n=this.fragments,a=Object.keys(n),i=a.length;i--;){var s=n[a[i]];if((null==s?void 0:s.body.type)===t&&(!r||s.buffered)){var o=s.body;if(o.start<=e&&e<=o.end)return o}}return null},t.detectEvictedFragments=function(e,t,r,n,a){var i=this;this.timeRanges&&(this.timeRanges[e]=t);var s=(null==n?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach((function(n){var o=i.fragments[n];if(o&&!(s>=o.body.sn))if(o.buffered||o.loaded&&!a){var l=o.range[e];l&&(0!==l.time.length?l.time.some((function(e){var r=!i.isTimeBuffered(e.startPTS,e.endPTS,t);return r&&i.removeFragment(o.body),r})):i.removeFragment(o.body))}else o.body.type===r&&i.removeFragment(o.body)}))},t.detectPartialFragments=function(e){var t=this,r=this.timeRanges;if(r&&"initSegment"!==e.frag.sn){var n=e.frag,a=Dt(n),i=this.fragments[a];if(!(!i||i.buffered&&n.gap)){var s=!n.relurl;Object.keys(r).forEach((function(a){var o=n.elementaryStreams[a];if(o){var l=r[a],u=s||!0===o.partial;i.range[a]=t.getBufferedTimes(n,e.part,u,l)}})),i.loaded=null,Object.keys(i.range).length?(i.buffered=!0,(i.body.endList=n.endList||i.body.endList)&&(this.endListFragments[i.body.type]=i),Mt(i)||this.removeParts(n.sn-1,n.type)):this.removeFragment(i.body)}}},t.removeParts=function(e,t){var r=this.activePartLists[t];r&&(this.activePartLists[t]=Ot(r,(function(t){return t.fragment.sn>=e})))},t.fragBuffered=function(e,t){var r=Dt(e),n=this.fragments[r];!n&&t&&(n=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)},t.getBufferedTimes=function(e,t,r,n){for(var a={time:[],partial:r},i=e.start,s=e.end,o=e.minEndPTS||s,l=e.maxStartPTS||i,u=0;u<n.length;u++){var c=n.start(u)-this.bufferPadding,d=n.end(u)+this.bufferPadding;if(l>=c&&o<=d){a.time.push({startPTS:Math.max(i,n.start(u)),endPTS:Math.min(s,n.end(u))});break}if(i<d&&s>c){var p=Math.max(i,n.start(u)),h=Math.min(s,n.end(u));h>p&&(a.partial=!0,a.time.push({startPTS:p,endPTS:h}))}else if(s<=c)break}return a},t.getPartialFragment=function(e){var t,r,n,a=null,i=0,s=this.bufferPadding,o=this.fragments;return Object.keys(o).forEach((function(l){var u=o[l];u&&Mt(u)&&(r=u.body.start-s,n=u.body.end+s,e>=r&&e<=n&&(t=Math.min(e-r,n-e),i<=t&&(a=u.body,i=t)))})),a},t.isEndListAppended=function(e){var t=this.endListFragments[e];return void 0!==t&&(t.buffered||Mt(t))},t.getState=function(e){var t=Dt(e),r=this.fragments[t];return r?r.buffered?Mt(r)?It:wt:xt:Ct},t.isTimeBuffered=function(e,t,r){for(var n,a,i=0;i<r.length;i++){if(n=r.start(i)-this.bufferPadding,a=r.end(i)+this.bufferPadding,e>=n&&t<=a)return!0;if(t<=n)return!1}return!1},t.onManifestLoading=function(){this.removeAllFragments()},t.onFragLoaded=function(e,t){if("initSegment"!==t.frag.sn&&!t.frag.bitrateTest){var r=t.frag,n=t.part?null:t,a=Dt(r);this.fragments[a]={body:r,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}},t.onBufferAppended=function(e,t){var r=t.frag,n=t.part,a=t.timeRanges,i=t.type;if("initSegment"!==r.sn){var s=r.type;if(n){var o=this.activePartLists[s];o||(this.activePartLists[s]=o=[]),o.push(n)}this.timeRanges=a;var l=a[i];this.detectEvictedFragments(i,l,s,n)}},t.onFragBuffered=function(e,t){this.detectPartialFragments(t)},t.hasFragment=function(e){var t=Dt(e);return!!this.fragments[t]},t.hasFragments=function(e){var t=this.fragments,r=Object.keys(t);if(!e)return r.length>0;for(var n=r.length;n--;){var a=t[r[n]];if((null==a?void 0:a.body.type)===e)return!0}return!1},t.hasParts=function(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)},t.removeFragmentsInRange=function(e,t,r,n,a){var i=this;n&&!this.hasGaps||Object.keys(this.fragments).forEach((function(s){var o=i.fragments[s];if(o){var l=o.body;l.type!==r||n&&!l.gap||l.start<t&&l.end>e&&(o.buffered||a)&&i.removeFragment(l)}}))},t.removeFragment=function(e){var t=Dt(e);e.clearElementaryStreamInfo();var r=this.activePartLists[e.type];if(r){var n=e.sn;this.activePartLists[e.type]=Ot(r,(function(e){return e.fragment.sn!==n}))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]},t.removeAllFragments=function(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;var t=null==(e=this.hls)||null==(e=e.latestLevelDetails)?void 0:e.partList;t&&t.forEach((function(e){return e.clearElementaryStreamInfo()}))},e}();function Mt(e){var t,r,n;return e.buffered&&!!(e.body.gap||null!=(t=e.range.video)&&t.partial||null!=(r=e.range.audio)&&r.partial||null!=(n=e.range.audiovideo)&&n.partial)}function Dt(e){return e.type+"_"+e.level+"_"+e.sn}function Ot(e,t){return e.filter((function(e){var r=t(e);return r||e.clearElementaryStreamInfo(),r}))}var Lt=function(){function e(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}return e.prototype.decrypt=function(e,t){switch(this.aesMode){case 0:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case 1:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error("[AESCrypto] invalid aes mode "+this.aesMode)}},e}(),Nt=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],a=r[1],i=r[2],s=r[3],o=this.invSubMix,l=o[0],u=o[1],c=o[2],d=o[3],p=new Uint32Array(256),h=0,f=0,m=0;for(m=0;m<256;m++)p[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=f^f<<1^f<<2^f<<3^f<<4;g=g>>>8^255&g^99,e[h]=g,t[g]=h;var y=p[h],v=p[y],_=p[v],k=257*p[g]^16843008*g;n[h]=k<<24|k>>>8,a[h]=k<<16|k>>>16,i[h]=k<<8|k>>>24,s[h]=k,k=16843009*_^65537*v^257*y^16843008*h,l[g]=k<<24|k>>>8,u[g]=k<<16|k>>>16,c[g]=k<<8|k>>>24,d[g]=k,h?(h=y^p[p[p[_^y]]],f^=p[p[f]]):h=f=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);var i,s,o,l,u=this.ksRows=4*(a+6+1),c=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),p=this.sBox,h=this.rcon,f=this.invSubMix,m=f[0],g=f[1],y=f[2],v=f[3];for(i=0;i<u;i++)i<a?o=c[i]=t[i]:(l=o,i%a==0?(l=p[(l=l<<8|l>>>24)>>>24]<<24|p[l>>>16&255]<<16|p[l>>>8&255]<<8|p[255&l],l^=h[i/a|0]<<24):a>6&&i%a==4&&(l=p[l>>>24]<<24|p[l>>>16&255]<<16|p[l>>>8&255]<<8|p[255&l]),c[i]=o=(c[i-a]^l)>>>0);for(s=0;s<u;s++)i=u-s,l=3&s?c[i]:c[i-4],d[s]=s<4||i<=4?l:m[p[l>>>24]]^g[p[l>>>16&255]]^y[p[l>>>8&255]]^v[p[255&l]],d[s]=d[s]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r){for(var n,a,i,s,o,l,u,c,d,p,h,f,m,g,y=this.keySize+6,v=this.invKeySchedule,_=this.invSBox,k=this.invSubMix,E=k[0],b=k[1],T=k[2],A=k[3],S=this.uint8ArrayToUint32Array_(r),P=S[0],C=S[1],x=S[2],I=S[3],w=new Int32Array(e),R=new Int32Array(w.length),M=this.networkToHostOrderSwap;t<w.length;){for(d=M(w[t]),p=M(w[t+1]),h=M(w[t+2]),f=M(w[t+3]),o=d^v[0],l=f^v[1],u=h^v[2],c=p^v[3],m=4,g=1;g<y;g++)n=E[o>>>24]^b[l>>16&255]^T[u>>8&255]^A[255&c]^v[m],a=E[l>>>24]^b[u>>16&255]^T[c>>8&255]^A[255&o]^v[m+1],i=E[u>>>24]^b[c>>16&255]^T[o>>8&255]^A[255&l]^v[m+2],s=E[c>>>24]^b[o>>16&255]^T[l>>8&255]^A[255&u]^v[m+3],o=n,l=a,u=i,c=s,m+=4;n=_[o>>>24]<<24^_[l>>16&255]<<16^_[u>>8&255]<<8^_[255&c]^v[m],a=_[l>>>24]<<24^_[u>>16&255]<<16^_[c>>8&255]<<8^_[255&o]^v[m+1],i=_[u>>>24]<<24^_[c>>16&255]<<16^_[o>>8&255]<<8^_[255&l]^v[m+2],s=_[c>>>24]<<24^_[o>>16&255]<<16^_[l>>8&255]<<8^_[255&u]^v[m+3],R[t]=M(n^P),R[t+1]=M(s^C),R[t+2]=M(i^x),R[t+3]=M(a^I),P=d,C=p,x=h,I=f,t+=4}return R.buffer},e}(),Ut=function(){function e(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}return e.prototype.expandKey=function(){var e=function(e){switch(e){case 0:return"AES-CBC";case 1:return"AES-CTR";default:throw new Error("[FastAESKey] invalid aes mode "+e)}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])},e}(),jt=function(){function e(e,t){var r=(void 0===t?{}:t).removePKCS7Padding,n=void 0===r||r;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=n,n)try{var a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}this.useSoftware=!this.subtle}var t=e.prototype;return t.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},t.isSync=function(){return this.useSoftware},t.flush=function(){var e=this.currentResult,t=this.remainderData;if(!e||t)return this.reset(),null;var r,n,a,i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?(a=(n=(r=i).byteLength)&&new DataView(r.buffer).getUint8(n-1))?r.slice(0,n-a):r:i},t.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},t.decrypt=function(e,t,r,n){var a=this;return this.useSoftware?new Promise((function(i,s){var o=ArrayBuffer.isView(e)?e:new Uint8Array(e);a.softwareDecrypt(o,t,r,n);var l=a.flush();l?i(l.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,r,n)},t.softwareDecrypt=function(e,t,r,n){var a=this.currentIV,i=this.currentResult,s=this.remainderData;if(0!==n||16!==t.byteLength)return H.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),s&&(e=Ee(s,e),this.remainderData=null);var o=this.getValidChunk(e);if(!o.length)return null;a&&(r=a);var l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new Nt),l.expandKey(t);var u=i;return this.currentResult=l.decrypt(o.buffer,0,r),this.currentIV=o.slice(-16).buffer,u||null},t.webCryptoDecrypt=function(e,t,r,n){var a=this;if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,n));this.key=t,this.fastAesKey=new Ut(this.subtle,t,n)}return this.fastAesKey.expandKey().then((function(t){return a.subtle?(a.logOnce("WebCrypto AES decrypt"),new Lt(a.subtle,new Uint8Array(r),n).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized"))})).catch((function(i){return H.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+i.name+": "+i.message),a.onWebCryptoError(e,t,r,n)}))},t.onWebCryptoError=function(e,t,r,n){var a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,n);var i=this.flush();if(i)return i.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")},t.getValidChunk=function(e){var t=e,r=e.length-e.length%16;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t},t.logOnce=function(e){this.logEnabled&&(H.log("[decrypter]: "+e),this.logEnabled=!1)},e}(),Bt=Math.pow(2,17),Ft=function(){function e(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}var t=e.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,t){var r=this,n=e.url;if(!n)return Promise.reject(new Ht({type:A.NETWORK_ERROR,details:S.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();var a=this.config,i=a.fLoader,s=a.loader;return new Promise((function(o,l){if(r.loader&&r.loader.destroy(),e.gap){if(e.tagList.some((function(e){return"GAP"===e[0]})))return void l(Gt(e));e.gap=!1}var u=r.loader=i?new i(a):new s(a),d=Vt(e);e.loader=u;var p=bt(a.fragLoadPolicy.default),h={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:Bt};e.stats=u.stats;var f={onSuccess:function(t,n,a,i){r.resetLoader(e,u);var s=t.data;a.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),o({frag:e,part:null,payload:s,networkDetails:i})},onError:function(t,a,i,s){r.resetLoader(e,u),l(new Ht({type:A.NETWORK_ERROR,details:S.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:c({url:n,data:void 0},t),error:new Error("HTTP Error "+t.code+" "+t.text),networkDetails:i,stats:s}))},onAbort:function(t,n,a){r.resetLoader(e,u),l(new Ht({type:A.NETWORK_ERROR,details:S.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:a,stats:t}))},onTimeout:function(t,n,a){r.resetLoader(e,u),l(new Ht({type:A.NETWORK_ERROR,details:S.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error("Timeout after "+h.timeout+"ms"),networkDetails:a,stats:t}))}};t&&(f.onProgress=function(r,n,a,i){return t({frag:e,part:null,payload:a,networkDetails:i})}),u.load(d,h,f)}))},t.loadPart=function(e,t,r){var n=this;this.abort();var a=this.config,i=a.fLoader,s=a.loader;return new Promise((function(o,l){if(n.loader&&n.loader.destroy(),e.gap||t.gap)l(Gt(e,t));else{var u=n.loader=i?new i(a):new s(a),d=Vt(e,t);e.loader=u;var p=bt(a.fragLoadPolicy.default),h={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Bt};t.stats=u.stats,u.load(d,h,{onSuccess:function(a,i,s,l){n.resetLoader(e,u),n.updateStatsFromPart(e,t);var c={frag:e,part:t,payload:a.data,networkDetails:l};r(c),o(c)},onError:function(r,a,i,s){n.resetLoader(e,u),l(new Ht({type:A.NETWORK_ERROR,details:S.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:c({url:d.url,data:void 0},r),error:new Error("HTTP Error "+r.code+" "+r.text),networkDetails:i,stats:s}))},onAbort:function(r,a,i){e.stats.aborted=t.stats.aborted,n.resetLoader(e,u),l(new Ht({type:A.NETWORK_ERROR,details:S.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:i,stats:r}))},onTimeout:function(r,a,i){n.resetLoader(e,u),l(new Ht({type:A.NETWORK_ERROR,details:S.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error("Timeout after "+h.timeout+"ms"),networkDetails:i,stats:r}))}})}}))},t.updateStatsFromPart=function(e,t){var r=e.stats,n=t.stats,a=n.total;if(r.loaded+=n.loaded,a){var i=Math.round(e.duration/t.duration),s=Math.min(Math.round(r.loaded/a),i),o=(i-s)*Math.round(r.loaded/s);r.total=r.loaded+o}else r.total=Math.max(r.loaded,r.total);var l=r.loading,u=n.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end},t.resetLoader=function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()},e}();function Vt(e,t){void 0===t&&(t=null);var r,n=t||e,a={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},i=n.byteRangeStartOffset,s=n.byteRangeEndOffset;if(E(i)&&E(s)){var o,l=i,u=s;if("initSegment"===e.sn&&("AES-128"===(r=null==(o=e.decryptdata)?void 0:o.method)||"AES-256"===r)){var c=s-i;c%16&&(u=s+(16-c%16)),0!==i&&(a.resetIV=!0,l=i-16)}a.rangeStart=l,a.rangeEnd=u}return a}function Gt(e,t){var r=new Error("GAP "+(e.gap?"tag":"attribute")+" found"),n={type:A.MEDIA_ERROR,details:S.FRAG_GAP,fatal:!1,frag:e,error:r,networkDetails:null};return t&&(n.part=t),(t||e).stats.aborted=!0,new Ht(n)}var Ht=function(e){function t(t){var r;return(r=e.call(this,t.error.message)||this).data=void 0,r.data=t,r}return o(t,e),t}(h(Error)),Kt=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this)._boundTick=void 0,n._tickTimer=null,n._tickInterval=null,n._tickCallCount=0,n._boundTick=n.tick.bind(n),n}o(t,e);var r=t.prototype;return r.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},r.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},r.onHandlerDestroyed=function(){},r.hasInterval=function(){return!!this._tickInterval},r.hasNextTick=function(){return!!this._tickTimer},r.setInterval=function(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)},r.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},r.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},r.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},r.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},r.doTick=function(){},t}(N),Wt=function(e,t,r,n,a,i){void 0===n&&(n=0),void 0===a&&(a=-1),void 0===i&&(i=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=r,this.size=n,this.part=a,this.partial=i},$t={length:0,start:function(){return 0},end:function(){return 0}},zt=function(){function e(){}return e.isBuffered=function(t,r){if(t)for(var n=e.getBuffered(t),a=n.length;a--;)if(r>=n.start(a)&&r<=n.end(a))return!0;return!1},e.bufferedRanges=function(t){if(t){var r=e.getBuffered(t);return e.timeRangesToArray(r)}return[]},e.timeRangesToArray=function(e){for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t},e.bufferInfo=function(t,r,n){if(t){var a=e.bufferedRanges(t);if(a.length)return e.bufferedInfo(a,r,n)}return{len:0,start:r,end:r,bufferedIndex:-1}},e.bufferedInfo=function(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var n=-1,a=[];if(r)for(var i=0;i<e.length;i++){t>=e[i].start&&t<=e[i].end&&(n=i);var s=a.length;if(s){var o=a[s-1].end;e[i].start-o<r?e[i].end>o&&(a[s-1].end=e[i].end):a.push(e[i])}else a.push(e[i])}else a=e;for(var l,u=0,c=t,d=t,p=0;p<a.length;p++){var h=a[p].start,f=a[p].end;if(-1===n&&t>=h&&t<=f&&(n=p),t+r>=h&&t<f)c=h,u=(d=f)-t;else if(t+r<h){l=h;break}}return{len:u,start:c||0,end:d||0,nextStart:l,buffered:e,bufferedIndex:n}},e.getBuffered=function(e){try{return e.buffered||$t}catch(e){return H.log("failed to get media.buffered",e),$t}},e}(),qt=/\{\$([a-zA-Z0-9-_]+)\}/g;function Yt(e){return qt.test(e)}function Xt(e,t){if(null!==e.variableList||e.hasVariableRefs){var r=e.variableList;return t.replace(qt,(function(t){var n=t.substring(2,t.length-1),a=null==r?void 0:r[n];return void 0===a?(e.playlistParsingError||(e.playlistParsingError=new Error('Missing preceding EXT-X-DEFINE tag for Variable Reference: "'+n+'"')),t):a}))}return t}function Zt(e,t,r){var n,a,i=e.variableList;if(i||(e.variableList=i={}),"QUERYPARAM"in t){n=t.QUERYPARAM;try{var s=new self.URL(r).searchParams;if(!s.has(n))throw new Error('"'+n+'" does not match any query parameter in URI: "'+r+'"');a=s.get(n)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: "+t.message))}}else n=t.NAME,a=t.VALUE;n in i?e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE duplicate Variable Name declarations: "'+n+'"')):i[n]=a||""}function Qt(e,t,r){var n=t.IMPORT;if(r&&n in r){var a=e.variableList;a||(e.variableList=a={}),a[n]=r[n]}else e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "'+n+'"'))}var Jt=/^(\d+)x(\d+)$/,er=/(.+?)=(".*?"|.*?)(?:,|$)/g,tr=function(){function e(t,r){"string"==typeof t&&(t=e.parseAttrList(t,r)),i(this,t)}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.optionalFloat=function(e,t){var r=this[e];return r?parseFloat(r):t},t.enumeratedString=function(e){return this[e]},t.enumeratedStringList=function(e,t){var r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((function(e,t){return e[t.toLowerCase()]=!0,e}),t)},t.bool=function(e){return"YES"===this[e]},t.decimalResolution=function(e){var t=Jt.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e,t){var r,n={};for(er.lastIndex=0;null!==(r=er.exec(e));){var a=r[1].trim(),i=r[2],s=0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1,o=!1;if(s)i=i.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":o=!0}if(t&&(s||o))i=Xt(t,i);else if(!o&&!s)switch(a){case"CLOSED-CAPTIONS":if("NONE"===i)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":H.warn(e+": attribute "+a+" is missing quotes")}n[a]=i}return n},n(e,[{key:"clientAttrs",get:function(){return Object.keys(this).filter((function(e){return"X-"===e.substring(0,2)}))}}])}();function rr(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e||"SCTE35-CMD"===e}var nr=n((function(e,t,r){var n;if(void 0===r&&(r=0),this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==t?void 0:t.tagAnchor)||null,this.tagOrder=null!=(n=null==t?void 0:t.tagOrder)?n:r,t){var a=t.attr;for(var s in a)if(Object.prototype.hasOwnProperty.call(e,s)&&e[s]!==a[s]){H.warn('DATERANGE tag attribute: "'+s+'" does not match for tags with ID: "'+e.ID+'"'),this._badValueForSameId=s;break}e=i(new tr({}),a,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){var o=(null==t?void 0:t.endDate)||new Date(this.attr["END-DATE"]);E(o.getTime())&&(this._endDate=o)}}),[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"cue",get:function(){var e=this._cue;return void 0===e?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}},{key:"startTime",get:function(){var e=this.tagAnchor;return null===e||null===e.programDateTime?(H.warn('Expected tagAnchor Fragment with PDT set for DateRange "'+this.id+'": '+e),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){var e=this._endDate||this._dateAtEnd;if(e)return e;var t=this.duration;return null!==t?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*t):null}},{key:"duration",get:function(){if("DURATION"in this.attr){var e=this.attr.decimalFloatingPoint("DURATION");if(E(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}},{key:"endOnNext",get:function(){return this.attr.bool("END-ON-NEXT")}},{key:"isInterstitial",get:function(){return"com.apple.hls.interstitial"===this.class}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&E(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}]),ar=function(){function e(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}var t=e.prototype;return t.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1},t.hasKey=function(e){return this.encryptedFragments.some((function(t){var r=t.decryptdata;return r||(t.setKeyFormat(e.keyFormat),r=t.decryptdata),!!r&&e.matches(r)}))},n(e,[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&E(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}},{key:"fragmentStart",get:function(){return this.fragments.length?this.fragments[0].start:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"maxPartIndex",get:function(){var e=this.partList;if(e){var t=this.lastPartIndex;if(-1!==t){for(var r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}},{key:"lastPartSn",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}},{key:"expired",get:function(){if(this.live&&this.age&&this.misses<3){var e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}])}();function ir(e,t){return e.length===t.length&&!e.some((function(e,r){return e!==t[r]}))}function sr(e,t){return!e&&!t||!(!e||!t)&&ir(e,t)}function or(e){return"AES-128"===e||"AES-256"===e||"AES-256-CTR"===e}function lr(e){switch(e){case"AES-128":case"AES-256":return 0;case"AES-256-CTR":return 1;default:throw new Error("invalid full segment method "+e)}}function ur(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}function cr(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(function(e){return e.charCodeAt(0)}))}function dr(e){var t=function(e,t,r){var n=e[t];e[t]=e[r],e[r]=n};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}var pr="undefined"!=typeof self?self:void 0,hr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},fr="org.w3.clearkey",mr="com.apple.streamingkeydelivery",gr="com.microsoft.playready",yr="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function vr(e){switch(e){case mr:return hr.FAIRPLAY;case gr:return hr.PLAYREADY;case yr:return hr.WIDEVINE;case fr:return hr.CLEARKEY}}function _r(e){switch(e){case hr.FAIRPLAY:return mr;case hr.PLAYREADY:return gr;case hr.WIDEVINE:return yr;case hr.CLEARKEY:return fr}}function kr(e){var t=e.drmSystems,r=e.widevineLicenseUrl,n=t?[hr.FAIRPLAY,hr.WIDEVINE,hr.PLAYREADY,hr.CLEARKEY].filter((function(e){return!!t[e]})):[];return!n[hr.WIDEVINE]&&r&&n.push(hr.WIDEVINE),n}var Er,br=null!=pr&&null!=(Er=pr.navigator)&&Er.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null,Tr={},Ar=function(){function e(e,t,r,n,a,i){void 0===n&&(n=[1]),void 0===a&&(a=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=n,this.iv=a,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&!or(e),null!=i&&i.startsWith("0x")&&(this.keyId=new Uint8Array(q(i)))}e.clearKeyUriToKeyIdMap=function(){Tr={}},e.setKeyIdForUri=function(e,t){Tr[e]=t};var t=e.prototype;return t.matches=function(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&ir(e.keyFormatVersions,this.keyFormatVersions)&&sr(e.iv,this.iv)&&sr(e.keyId,this.keyId)},t.isSupported=function(){if(this.method){if(or(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case mr:case yr:case gr:case fr:return-1!==["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1},t.getDecryptData=function(t){if(!this.encrypted||!this.uri)return null;if(or(this.method)){var r=this.iv;return r||("number"!=typeof t&&(H.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),t=0),r=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}(t)),new e(this.method,this.uri,"identity",this.keyFormatVersions,r)}if(this.pssh&&this.keyId)return this;var n=function(e){var t,r,n=e.split(":"),a=null;if("data"===n[0]&&2===n.length){var i=n[1].split(";"),s=i[i.length-1].split(",");if(2===s.length){var o="base64"===s[0],l=s[1];o?(i.splice(-1,1),a=ur(l)):(t=cr(l).subarray(0,16),(r=new Uint8Array(16)).set(t,16-t.length),a=r)}}return a}(this.uri);if(n)switch(this.keyFormat){case yr:if(this.pssh=n,!this.keyId){var a=function(e){var t=[];if(e instanceof ArrayBuffer)for(var r=e.byteLength,n=0;n+32<r;){var a=Ce(new DataView(e,n));t.push(a),n+=a.size}return t}(n.buffer);if(a.length){var i,s=a[0];this.keyId=null!=(i=s.kids)&&i.length?s.kids[0]:null}}if(!this.keyId){var o=n.length-22;this.keyId=n.subarray(o,o+16)}break;case gr:var l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function(e,t,r){if(16!==e.byteLength)throw new RangeError("Invalid system id");var n,a;n=new Uint8Array,a=new Uint8Array;var i=new Uint8Array(4);return r.byteLength>0&&new DataView(i.buffer).setUint32(0,r.byteLength,!1),function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var a=r.length,i=8,s=a;s--;)i+=r[s].byteLength;var o=new Uint8Array(i);for(o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=255&i,o.set(e,4),s=0,i=8;s<a;s++)o.set(r[s],i),i+=r[s].byteLength;return o}([112,115,115,104],new Uint8Array([0,0,0,0]),e,a,n,i,r)}(l,0,n),this.keyId=function(e){var t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),r=String.fromCharCode.apply(null,Array.from(t)),n=r.substring(r.indexOf("<"),r.length),a=(new DOMParser).parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(a){var i=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(i){var s=ur(i).subarray(0,16);return dr(s),s}}return null}(n);break;default:var u=n.subarray(0,16);if(16!==u.length){var c=new Uint8Array(16);c.set(u,16-u.length),u=c}this.keyId=u}if(!this.keyId||16!==this.keyId.byteLength){var d=Tr[this.uri];if(!d){var p=Object.keys(Tr).length%Number.MAX_SAFE_INTEGER;d=new Uint8Array(16),new DataView(d.buffer,12,4).setUint32(0,p),e.setKeyIdForUri(this.uri,d)}this.keyId=d}return this},e}(),Sr=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Pr=/#EXT-X-MEDIA:(.*)/g,Cr=/^#EXT(?:INF|-X-TARGETDURATION):/m,xr=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Ir=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),wr=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.id===t)return n}},e.resolve=function(e,t){return k.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.isMediaPlaylist=function(e){return Cr.test(e)},e.parseMasterPlaylist=function(t,r){var n,a={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:Yt(t)},i=[];if(Sr.lastIndex=0,!t.startsWith("#EXTM3U"))return a.playlistParsingError=new Error("no EXTM3U delimiter"),a;for(;null!=(n=Sr.exec(t));)if(n[1]){var s,o=new tr(n[1],a),l=Xt(a,n[2]),u={attrs:o,bitrate:o.decimalInteger("BANDWIDTH")||o.decimalInteger("AVERAGE-BANDWIDTH"),name:o.NAME,url:e.resolve(l,r)},c=o.decimalResolution("RESOLUTION");c&&(u.width=c.width,u.height=c.height),Lr(o.CODECS,u);var d=o["SUPPLEMENTAL-CODECS"];d&&(u.supplemental={},Lr(d,u.supplemental)),null!=(s=u.unknownCodecs)&&s.length||i.push(u),a.levels.push(u)}else if(n[3]){var p=n[3],h=n[4];switch(p){case"SESSION-DATA":var f=new tr(h,a),m=f["DATA-ID"];m&&(null===a.sessionData&&(a.sessionData={}),a.sessionData[m]=f);break;case"SESSION-KEY":var g=Dr(h,r,a);g.encrypted&&g.isSupported()?(null===a.sessionKeys&&(a.sessionKeys=[]),a.sessionKeys.push(g)):H.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+h+'"');break;case"DEFINE":Zt(a,new tr(h,a),r);break;case"CONTENT-STEERING":var y=new tr(h,a);a.contentSteering={uri:e.resolve(y["SERVER-URI"],r),pathwayId:y["PATHWAY-ID"]||"."};break;case"START":a.startTimeOffset=Or(h)}}var v=i.length>0&&i.length<a.levels.length;return a.levels=v?i:a.levels,0===a.levels.length&&(a.playlistParsingError=new Error("no levels found in manifest")),a},e.parseMasterPlaylistMedia=function(t,r,n){var a,i={},s=n.levels,o={AUDIO:s.map((function(e){return{id:e.attrs.AUDIO,audioCodec:e.audioCodec}})),SUBTITLES:s.map((function(e){return{id:e.attrs.SUBTITLES,textCodec:e.textCodec}})),"CLOSED-CAPTIONS":[]},l=0;for(Pr.lastIndex=0;null!==(a=Pr.exec(t));){var u=new tr(a[1],n),c=u.TYPE;if(c){var d=o[c],p=i[c]||[];i[c]=p;var h=u.LANGUAGE,f=u["ASSOC-LANGUAGE"],m=u.CHANNELS,g=u.CHARACTERISTICS,y=u["INSTREAM-ID"],v={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||h||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:h,url:u.URI?e.resolve(u.URI,r):""};if(f&&(v.assocLang=f),m&&(v.channels=m),g&&(v.characteristics=g),y&&(v.instreamId=y),null!=d&&d.length){var _=e.findGroup(d,v.groupId)||d[0];Nr(v,_,"audioCodec"),Nr(v,_,"textCodec")}p.push(v)}}return i},e.parseLevelPlaylist=function(e,t,r,n,a,s){var o,l,u,c,d,p={url:t},h=new ar(t),f=h.fragments,m=[],g=null,y=0,v=0,_=0,k=0,b=0,T=null,A=new te(n,p),S=-1,P=!1,C=null;if(xr.lastIndex=0,h.m3u8=e,h.hasVariableRefs=Yt(e),"#EXTM3U"!==(null==(o=xr.exec(e))?void 0:o[0]))return h.playlistParsingError=new Error("Missing format identifier #EXTM3U"),h;for(;null!==(l=xr.exec(e));){P&&(P=!1,(A=new te(n,p)).playlistOffset=_,A.setStart(_),A.sn=y,A.cc=k,b&&(A.bitrate=b),A.level=r,g&&(A.initSegment=g,g.rawProgramDateTime&&(A.rawProgramDateTime=g.rawProgramDateTime,g.rawProgramDateTime=null),C&&(A.setByteRange(C),C=null)));var x=l[1];if(x){A.duration=parseFloat(x);var I=(" "+l[2]).slice(1);A.title=I||null,A.tagList.push(I?["INF",x,I]:["INF",x])}else if(l[3]){if(E(A.duration)){A.playlistOffset=_,A.setStart(_),c&&Br(A,c,h),A.sn=y,A.level=r,A.cc=k,f.push(A);var w=(" "+l[3]).slice(1);A.relurl=Xt(h,w),Ur(A,T,m),T=A,_+=A.duration,y++,v=0,P=!0}}else{if(!(l=l[0].match(Ir))){H.warn("No matches on slow regex match for level playlist!");continue}for(u=1;u<l.length&&void 0===l[u];u++);var R=(" "+l[u]).slice(1),M=(" "+l[u+1]).slice(1),D=l[u+2]?(" "+l[u+2]).slice(1):null;switch(R){case"BYTERANGE":T?A.setByteRange(M,T):A.setByteRange(M);break;case"PROGRAM-DATE-TIME":A.rawProgramDateTime=M,A.tagList.push(["PROGRAM-DATE-TIME",M]),-1===S&&(S=f.length);break;case"PLAYLIST-TYPE":h.type&&Fr(h,R,l),h.type=M.toUpperCase();break;case"MEDIA-SEQUENCE":0!==h.startSN?Fr(h,R,l):f.length>0&&Vr(h,R,l),y=h.startSN=parseInt(M);break;case"SKIP":h.skippedSegments&&Fr(h,R,l);var O=new tr(M,h),L=O.decimalInteger("SKIPPED-SEGMENTS");if(E(L)){h.skippedSegments+=L;for(var N=L;N--;)f.push(null);y+=L}var U=O.enumeratedString("RECENTLY-REMOVED-DATERANGES");U&&(h.recentlyRemovedDateranges=(h.recentlyRemovedDateranges||[]).concat(U.split("\t")));break;case"TARGETDURATION":0!==h.targetduration&&Fr(h,R,l),h.targetduration=Math.max(parseInt(M),1);break;case"VERSION":null!==h.version&&Fr(h,R,l),h.version=parseInt(M);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":h.live||Fr(h,R,l),h.live=!1;break;case"#":(M||D)&&A.tagList.push(D?[M,D]:[M]);break;case"DISCONTINUITY":k++,A.tagList.push(["DIS"]);break;case"GAP":A.gap=!0,A.tagList.push([R]);break;case"BITRATE":A.tagList.push([R,M]),b=1e3*parseInt(M),E(b)?A.bitrate=b:b=0;break;case"DATERANGE":var j=new tr(M,h),B=new nr(j,h.dateRanges[j.ID],h.dateRangeTagCount);h.dateRangeTagCount++,B.isValid||h.skippedSegments?h.dateRanges[B.id]=B:H.warn('Ignoring invalid DATERANGE tag: "'+M+'"'),A.tagList.push(["EXT-X-DATERANGE",M]);break;case"DEFINE":var F=new tr(M,h);"IMPORT"in F?Qt(h,F,s):Zt(h,F,t);break;case"DISCONTINUITY-SEQUENCE":0!==h.startCC?Fr(h,R,l):f.length>0&&Vr(h,R,l),h.startCC=k=parseInt(M);break;case"KEY":var V=Dr(M,t,h);if(V.isSupported()){if("NONE"===V.method){c=void 0;break}c||(c={});var G=c[V.keyFormat];null!=G&&G.matches(V)||(G&&(c=i({},c)),c[V.keyFormat]=V)}else H.warn('[Keys] Ignoring unsupported EXT-X-KEY tag: "'+M+'"');break;case"START":h.startTimeOffset=Or(M);break;case"MAP":var K=new tr(M,h);if(A.duration){var W=new te(n,p);jr(W,K,r,c),g=W,A.initSegment=g,g.rawProgramDateTime&&!A.rawProgramDateTime&&(A.rawProgramDateTime=g.rawProgramDateTime)}else{var $=A.byteRangeEndOffset;if($){var z=A.byteRangeStartOffset;C=$-z+"@"+z}else C=null;jr(A,K,r,c),g=A,P=!0}g.cc=k;break;case"SERVER-CONTROL":d&&Fr(h,R,l),d=new tr(M),h.canBlockReload=d.bool("CAN-BLOCK-RELOAD"),h.canSkipUntil=d.optionalFloat("CAN-SKIP-UNTIL",0),h.canSkipDateRanges=h.canSkipUntil>0&&d.bool("CAN-SKIP-DATERANGES"),h.partHoldBack=d.optionalFloat("PART-HOLD-BACK",0),h.holdBack=d.optionalFloat("HOLD-BACK",0);break;case"PART-INF":h.partTarget&&Fr(h,R,l);var q=new tr(M);h.partTarget=q.decimalFloatingPoint("PART-TARGET");break;case"PART":var Y=h.partList;Y||(Y=h.partList=[]);var X=v>0?Y[Y.length-1]:void 0,Z=v++,Q=new tr(M,h),J=new re(Q,A,p,Z,X);Y.push(J),A.duration+=J.duration;break;case"PRELOAD-HINT":var ee=new tr(M,h);h.preloadHint=ee;break;case"RENDITION-REPORT":var ne=new tr(M,h);h.renditionReports=h.renditionReports||[],h.renditionReports.push(ne);break;default:H.warn("line parsed but not handled: "+l)}}}T&&!T.relurl?(f.pop(),_-=T.duration,h.partList&&(h.fragmentHint=T)):h.partList&&(Ur(A,T,m),A.cc=k,h.fragmentHint=A,c&&Br(A,c,h)),h.targetduration||(h.playlistParsingError=new Error("Missing Target Duration"));var ae=f.length,ie=f[0],se=f[ae-1];if((_+=h.skippedSegments*h.targetduration)>0&&ae&&se){h.averagetargetduration=_/ae;var oe=se.sn;h.endSN="initSegment"!==oe?oe:0,h.live||(se.endList=!0),S>0&&(function(e,t){for(var r=e[t],n=t;n--;){var a=e[n];if(!a)return;a.programDateTime=r.programDateTime-1e3*a.duration,r=a}}(f,S),ie&&m.unshift(ie))}return h.fragmentHint&&(_+=h.fragmentHint.duration),h.totalduration=_,m.length&&h.dateRangeTagCount&&ie&&Rr(m,h),h.endCC=k,h},e}();function Rr(e,t){var r=e.length;if(!r){if(!t.hasProgramDateTime)return;var n=t.fragments[t.fragments.length-1];e.push(n),r++}for(var a=e[r-1],i=t.live?1/0:t.totalduration,s=Object.keys(t.dateRanges),o=s.length;o--;){var l=t.dateRanges[s[o]],u=l.startDate.getTime();l.tagAnchor=a.ref;for(var c=r;c--;){var d;if((null==(d=e[c])?void 0:d.sn)<t.startSN)break;var p=Mr(t,u,e,c,i);if(-1!==p){l.tagAnchor=t.fragments[p].ref;break}}}}function Mr(e,t,r,n,a){var i=r[n];if(i){var s,o=i.programDateTime;if((t>=o||0===n)&&t<=o+1e3*(((null==(s=r[n+1])?void 0:s.start)||a)-i.start)){var l=r[n].sn-e.startSN;if(l<0)return-1;var u=e.fragments;if(u.length>r.length)for(var c=(r[n+1]||u[u.length-1]).sn-e.startSN;c>l;c--){var d=u[c].programDateTime;if(t>=d&&t<d+1e3*u[c].duration)return c}return l}}return-1}function Dr(e,t,r){var n,a,i=new tr(e,r),s=null!=(n=i.METHOD)?n:"",o=i.URI,l=i.hexadecimalInteger("IV"),u=i.KEYFORMATVERSIONS,c=null!=(a=i.KEYFORMAT)?a:"identity";o&&i.IV&&!l&&H.error("Invalid IV: "+i.IV);var d=o?wr.resolve(o,t):"",p=(u||"1").split("/").map(Number).filter(Number.isFinite);return new Ar(s,d,c,p,l,i.KEYID)}function Or(e){var t=new tr(e).decimalFloatingPoint("TIME-OFFSET");return E(t)?t:null}function Lr(e,t){var r=(e||"").split(/[ ,]+/).filter((function(e){return e}));["video","audio","text"].forEach((function(e){var n=r.filter((function(t){return we(t,e)}));n.length&&(t[e+"Codec"]=n.map((function(e){return e.split("/")[0]})).join(","),r=r.filter((function(e){return-1===n.indexOf(e)})))})),t.unknownCodecs=r}function Nr(e,t,r){var n=t[r];n&&(e[r]=n)}function Ur(e,t,r){e.rawProgramDateTime?r.push(e):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime)}function jr(e,t,r,n){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=r,e.sn="initSegment",n&&(e.levelkeys=n),e.initSegment=null}function Br(e,t,r){e.levelkeys=t;var n=r.encryptedFragments;n.length&&n[n.length-1].levelkeys===t||!Object.keys(t).some((function(e){return t[e].isCommonEncryption}))||n.push(e)}function Fr(e,t,r){e.playlistParsingError=new Error("#EXT-X-"+t+" must not appear more than once ("+r[0]+")")}function Vr(e,t,r){e.playlistParsingError=new Error("#EXT-X-"+t+" must appear before the first Media Segment ("+r[0]+")")}function Gr(e,t){var r=t.startPTS;if(E(r)){var n,a=0;t.sn>e.sn?(a=r-e.start,n=e):(a=e.start-r,n=t),n.duration!==a&&n.setDuration(a)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.setStart(e.start+(e.minEndPTS-e.start)):t.setStart(e.start+e.duration):t.setStart(Math.max(e.start-t.duration,0))}function Hr(e,t,r,n,a,i,s){n-r<=0&&(s.warn("Fragment should have a positive duration",t),n=r+t.duration,i=a+t.duration);var o=r,l=n,u=t.startPTS,c=t.endPTS;if(E(u)){var d=Math.abs(u-r);e&&d>e.totalduration?s.warn("media timestamps and playlist times differ by "+d+"s for level "+t.level+" "+e.url):E(t.deltaPTS)?t.deltaPTS=Math.max(d,t.deltaPTS):t.deltaPTS=d,o=Math.max(r,u),r=Math.min(r,u),a=void 0!==t.startDTS?Math.min(a,t.startDTS):a,l=Math.min(n,c),n=Math.max(n,c),i=void 0!==t.endDTS?Math.max(i,t.endDTS):i}var p=r-t.start;0!==t.start&&t.setStart(r),t.setDuration(n-t.start),t.startPTS=r,t.maxStartPTS=o,t.startDTS=a,t.endPTS=n,t.minEndPTS=l,t.endDTS=i;var h,f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;var m=f-e.startSN,g=e.fragments;for(g[m]=t,h=m;h>0;h--)Gr(g[h],g[h-1]);for(h=m;h<g.length-1;h++)Gr(g[h],g[h+1]);return e.fragmentHint&&Gr(g[g.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,p}function Kr(e,t,r){if(e!==t){for(var n,a=null,s=e.fragments,o=s.length-1;o>=0;o--){var l=s[o].initSegment;if(l){a=l;break}}e.fragmentHint&&delete e.fragmentHint.endPTS,function(e,t,r){for(var n=t.skippedSegments,a=Math.max(e.startSN,t.startSN)-t.startSN,i=(e.fragmentHint?1:0)+(n?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,s=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=a;u<=i;u++){var c=l[s+u],d=o[u];if(n&&!d&&c&&(d=t.fragments[u]=c),c&&d){r(c,d,u,o);var p=c.relurl,h=d.relurl;if(p&&Jr(p,h))return void(t.playlistParsingError=Wr("media sequence mismatch "+d.sn+":",e,t,0,d));if(c.cc!==d.cc)return void(t.playlistParsingError=Wr("discontinuity sequence mismatch ("+c.cc+"!="+d.cc+")",e,t,0,d))}}}(e,t,(function(e,r,i,s){if((!t.startCC||t.skippedSegments)&&r.cc!==e.cc){for(var o=e.cc-r.cc,l=i;l<s.length;l++)s[l].cc+=o;t.endCC=s[s.length-1].cc}E(e.startPTS)&&E(e.endPTS)&&(r.setStart(r.startPTS=e.startPTS),r.startDTS=e.startDTS,r.maxStartPTS=e.maxStartPTS,r.endPTS=e.endPTS,r.endDTS=e.endDTS,r.minEndPTS=e.minEndPTS,r.setDuration(e.endPTS-e.startPTS),r.duration&&(n=r),t.PTSKnown=t.alignedSliding=!0),e.hasStreams&&(r.elementaryStreams=e.elementaryStreams),r.loader=e.loader,e.hasStats&&(r.stats=e.stats),e.initSegment&&(r.initSegment=e.initSegment,a=e.initSegment)}));var u=t.fragments,c=t.fragmentHint?u.concat(t.fragmentHint):u;if(a&&c.forEach((function(e){var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=a)?void 0:t.relurl)||(e.initSegment=a)})),t.skippedSegments){if(t.deltaUpdateFailed=u.some((function(e){return!e})),t.deltaUpdateFailed){r.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var d=t.skippedSegments;d--;)u.shift();t.startSN=u[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=function(e,t,r){var n=t.dateRanges,a=t.recentlyRemovedDateranges,s=i({},e);a&&a.forEach((function(e){delete s[e]}));var o=Object.keys(s).length;return o?(Object.keys(n).forEach((function(e){var t=s[e],a=new nr(n[e].attr,t);a.isValid?(s[e]=a,t||(a.tagOrder+=o)):r.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+rt(n[e].attr)+'"')})),s):n}(e.dateRanges,t,r));var p=e.fragments.filter((function(e){return e.rawProgramDateTime}));if(e.hasProgramDateTime&&!t.hasProgramDateTime)for(var h=1;h<c.length;h++)null===c[h].programDateTime&&Ur(c[h],c[h-1],p);Rr(p,t)}t.endCC=u[u.length-1].cc}if(!t.startCC){var f,m=Yr(e,t.startSN-1);t.startCC=null!=(f=null==m?void 0:m.cc)?f:u[0].cc}!function(e,t,r){if(e&&t)for(var n=0,a=0,i=e.length;a<=i;a++){var s=e[a],o=t[a+n];s&&o&&s.index===o.index&&s.fragment.sn===o.fragment.sn?r(s,o):n--}}(e.partList,t.partList,(function(e,t){t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),n?Hr(t,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS,r):$r(e,t),u.length&&(t.totalduration=t.edge-u[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var g=t.advancedDateTime;if(t.advanced&&g){var y=t.edge;t.driftStart||(t.driftStartTime=g,t.driftStart=y),t.driftEndTime=g,t.driftEnd=y}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime;-1===t.requestScheduled&&(t.requestScheduled=e.requestScheduled)}}function Wr(e,t,r,n,a){return new Error(e+" "+a.url+"\nPlaylist starting @"+t.startSN+"\n"+t.m3u8+"\n\nPlaylist starting @"+r.startSN+"\n"+r.m3u8)}function $r(e,t,r){void 0===r&&(r=!0);var n=t.startSN+t.skippedSegments-e.startSN,a=e.fragments,i=n>=0,s=0;if(i&&n<a.length)s=a[n].start;else if(i&&t.startSN===e.endSN+1)s=e.fragmentEnd;else if(i&&r)s=e.fragmentStart+n*t.levelTargetDuration;else{if(t.skippedSegments||0!==t.fragmentStart)return;s=e.fragmentStart}zr(t,s)}function zr(e,t){if(t){for(var r=e.fragments,n=e.skippedSegments;n<r.length;n++)r[n].addStart(t);e.fragmentHint&&e.fragmentHint.addStart(t)}}function qr(e,t){void 0===t&&(t=1/0);var r=1e3*e.targetduration;if(e.updated){var n=e.fragments;if(n.length&&4*r>t){var a=1e3*n[n.length-1].duration;a<r&&(r=a)}}else r/=2;return Math.round(r)}function Yr(e,t,r){if(!e)return null;var n=e.fragments[t-e.startSN];return n||((n=e.fragmentHint)&&n.sn===t?n:t<e.startSN&&r&&r.sn===t?r:null)}function Xr(e,t,r){return e?Zr(e.partList,t,r):null}function Zr(e,t,r){if(e)for(var n=e.length;n--;){var a=e[n];if(a.index===r&&a.fragment.sn===t)return a}return null}function Qr(e){e.forEach((function(e,t){var r;null==(r=e.details)||r.fragments.forEach((function(e){e.level=t,e.initSegment&&(e.initSegment.level=t)}))}))}function Jr(e,t){return!(e===t||!t)&&en(e)!==en(t)}function en(e){return e.replace(/\?[^?]*$/,"")}function tn(e,t){for(var r=0,n=e.length;r<n;r++){var a;if((null==(a=e[r])?void 0:a.cc)===t)return e[r]}return null}function rn(e,t){var r=e.start+t;e.startPTS=r,e.setStart(r),e.endPTS=r+e.duration}function nn(e,t){for(var r=t.fragments,n=0,a=r.length;n<a;n++)rn(r[n],e);t.fragmentHint&&rn(t.fragmentHint,e),t.alignedSliding=!0}function an(e,t){if(function(e,t){return!!(e&&t.startCC<e.endCC&&t.endCC>e.startCC)}(t,e)){var r=Math.min(t.endCC,e.endCC),n=tn(t.fragments,r),a=tn(e.fragments,r);n&&a&&(H.log("Aligning playlist at start of dicontinuity sequence "+r),nn(n.start-a.start,e))}}function sn(e,t){if(e.hasProgramDateTime&&t.hasProgramDateTime){var r=e.fragments,n=t.fragments;if(r.length&&n.length){var a,i,s=Math.min(t.endCC,e.endCC);t.startCC<s&&e.startCC<s&&(a=tn(n,s),i=tn(r,s)),a&&i||(i=tn(r,(a=n[Math.floor(n.length/2)]).cc)||r[Math.floor(r.length/2)]);var o=a.programDateTime,l=i.programDateTime;o&&l&&nn((l-o)/1e3-(i.start-a.start),e)}}}function on(e,t,r){ln(e,t,r),e.addEventListener(t,r)}function ln(e,t,r){e.removeEventListener(t,r)}var un={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},cn=function(e){function t(t,r,n,a,i){var s;return(s=e.call(this,a,t.logger)||this).hls=void 0,s.fragPrevious=null,s.fragCurrent=null,s.fragmentTracker=void 0,s.transmuxer=null,s._state=un.STOPPED,s.playlistType=void 0,s.media=null,s.mediaBuffer=null,s.config=void 0,s.bitrateTest=!1,s.lastCurrentTime=0,s.nextLoadPosition=0,s.startPosition=0,s.startTimeOffset=null,s.retryDate=0,s.levels=null,s.fragmentLoader=void 0,s.keyLoader=void 0,s.levelLastLoaded=null,s.startFragRequested=!1,s.decrypter=void 0,s.initPTS=[],s.buffering=!0,s.loadingParts=!1,s.loopSn=void 0,s.onMediaSeeking=function(){var e=s,t=e.config,r=e.fragCurrent,n=e.media,a=e.mediaBuffer,i=e.state,o=n?n.currentTime:0,l=zt.bufferInfo(a||n,o,t.maxBufferHole),u=!l.len;if(s.log("Media seeking to "+(E(o)?o.toFixed(3):o)+", state: "+i+", "+(u?"out of":"in")+" buffer"),s.state===un.ENDED)s.resetLoadingState();else if(r){var c=t.maxFragLookUpTolerance,d=r.start-c,p=r.start+r.duration+c;if(u||p<l.start||d>l.end){var h=o>p;(o<d||h)&&(h&&r.loader&&(s.log("Cancelling fragment load for seek (sn: "+r.sn+")"),r.abortRequests(),s.resetLoadingState()),s.fragPrevious=null)}}if(n&&(s.fragmentTracker.removeFragmentsInRange(o,1/0,s.playlistType,!0),o>s.lastCurrentTime&&(s.lastCurrentTime=o),!s.loadingParts)){var f=Math.max(l.end,o),m=s.shouldLoadParts(s.getLevelDetails(),f);m&&(s.log("LL-Part loading ON after seeking to "+o.toFixed(2)+" with buffer @"+f.toFixed(2)),s.loadingParts=m)}s.hls.hasEnoughToStart||(s.log("Setting "+(u?"startPosition":"nextLoadPosition")+" to "+o+" for seek without enough to start"),s.nextLoadPosition=o,u&&(s.startPosition=o)),u&&s.state===un.IDLE&&s.tickImmediate()},s.onMediaEnded=function(){s.log("setting startPosition to 0 because media ended"),s.startPosition=s.lastCurrentTime=0},s.playlistType=i,s.hls=t,s.fragmentLoader=new Ft(t.config),s.keyLoader=n,s.fragmentTracker=r,s.config=t.config,s.decrypter=new jt(t.config),s}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(P.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(P.ERROR,this.onError,this)},r.doTick=function(){this.onTickEnd()},r.onTickEnd=function(){},r.startLoad=function(e){},r.stopLoad=function(){if(this.state!==un.STOPPED){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=un.STOPPED}},r.pauseBuffering=function(){this.buffering=!1},r.resumeBuffering=function(){this.buffering=!0},r._streamEnded=function(e,t){if(t.live||!this.media)return!1;var r=e.end||0,n=this.config.timelineOffset||0;if(r<=n)return!1;var a=e.buffered;this.config.maxBufferHole&&a&&a.length>1&&(e=zt.bufferedInfo(a,e.start,0));var i=e.nextStart;if(i&&i>n&&i<t.edge)return!1;if(this.media.currentTime<e.start)return!1;var s=t.partList;if(null!=s&&s.length){var o=s[s.length-1];return zt.isBuffered(this.media,o.start+o.duration/2)}var l=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(l)},r.getLevelDetails=function(){if(this.levels&&null!==this.levelLastLoaded)return this.levelLastLoaded.details},r.onMediaAttached=function(e,t){var r=this.media=this.mediaBuffer=t.media;on(r,"seeking",this.onMediaSeeking),on(r,"ended",this.onMediaEnded);var n=this.config;this.levels&&n.autoStartLoad&&this.state===un.STOPPED&&this.startLoad(n.startPosition)},r.onMediaDetaching=function(e,t){var r=!!t.transferMedia,n=this.media;if(null!==n){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),ln(n,"seeking",this.onMediaSeeking),ln(n,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}},r.onManifestLoading=function(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1},r.onError=function(e,t){},r.onManifestLoaded=function(e,t){this.startTimeOffset=t.startTimeOffset},r.onHandlerDestroying=function(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),e.prototype.onHandlerDestroying.call(this),this.hls=this.onMediaSeeking=this.onMediaEnded=null},r.onHandlerDestroyed=function(){this.state=un.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,e.prototype.onHandlerDestroyed.call(this)},r.loadFragment=function(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)},r._loadFragForPlayback=function(e,t,r){var n=this;this._doFragLoad(e,t,r,(function(e){var t=e.frag;if(n.fragContextChanged(t))return n.warn(t.type+" sn: "+t.sn+(e.part?" part: "+e.part.index:"")+" of "+n.fragInfo(t,!1,e.part)+") was dropped during download."),void n.fragmentTracker.removeFragment(t);t.stats.chunkCount++,n._handleFragmentLoadProgress(e)})).then((function(e){if(e){var t=n.state,r=e.frag;n.fragContextChanged(r)?(t===un.FRAG_LOADING||!n.fragCurrent&&t===un.PARSING)&&(n.fragmentTracker.removeFragment(r),n.state=un.IDLE):("payload"in e&&(n.log("Loaded "+r.type+" sn: "+r.sn+" of "+n.playlistLabel()+" "+r.level),n.hls.trigger(P.FRAG_LOADED,e)),n._handleFragmentLoadComplete(e))}})).catch((function(t){n.state!==un.STOPPED&&n.state!==un.ERROR&&(n.warn("Frag error: "+((null==t?void 0:t.message)||t)),n.resetFragmentLoading(e))}))},r.clearTrackerIfNeeded=function(e){var t,r=this.fragmentTracker;if(r.getState(e)===xt){var n=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,n),i=Math.max(e.duration,a?a.len:this.config.maxBufferLength),s=this.backtrackFragment;(1==(s?e.sn-s.sn:0)||this.reduceMaxBufferLength(i,e.duration))&&r.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===It&&r.removeFragment(e))},r.checkLiveUpdate=function(e){if(e.updated&&!e.live){var t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)},r.waitForLive=function(e){var t=e.details;return(null==t?void 0:t.live)&&"EVENT"!==t.type&&(this.levelLastLoaded!==e||t.expired)},r.flushMainBuffer=function(e,t,r){if(void 0===r&&(r=null),e-t){var n={startOffset:e,endOffset:t,type:r};this.hls.trigger(P.BUFFER_FLUSHING,n)}},r._loadInitSegment=function(e,t){var r=this;this._doFragLoad(e,t).then((function(e){var t=null==e?void 0:e.frag;if(!t||r.fragContextChanged(t)||!r.levels)throw new Error("init load aborted");return e})).then((function(e){var t=r.hls,n=e.frag,a=e.payload,i=n.decryptdata;if(a&&a.byteLength>0&&null!=i&&i.key&&i.iv&&or(i.method)){var s=self.performance.now();return r.decrypter.decrypt(new Uint8Array(a),i.key.buffer,i.iv.buffer,lr(i.method)).catch((function(e){throw t.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:n}),e})).then((function(a){var i=self.performance.now();return t.trigger(P.FRAG_DECRYPTED,{frag:n,payload:a,stats:{tstart:s,tdecrypt:i}}),e.payload=a,r.completeInitSegmentLoad(e)}))}return r.completeInitSegmentLoad(e)})).catch((function(t){r.state!==un.STOPPED&&r.state!==un.ERROR&&(r.warn(t),r.resetFragmentLoading(e))}))},r.completeInitSegmentLoad=function(e){if(!this.levels)throw new Error("init load aborted, missing levels");var t=e.frag.stats;this.state!==un.STOPPED&&(this.state=un.IDLE),e.frag.data=new Uint8Array(e.payload),t.parsing.start=t.buffering.start=self.performance.now(),t.parsing.end=t.buffering.end=self.performance.now(),this.tick()},r.unhandledEncryptionError=function(e,t){var r,n,a=e.tracks;if(a&&!t.encrypted&&(null!=(r=a.audio)&&r.encrypted||null!=(n=a.video)&&n.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){var i=this.media,s=new Error("Encrypted track with no key in "+this.fragInfo(t)+" (media "+(i?"attached mediaKeys: "+i.mediaKeys:"detached")+")");return this.warn(s.message),!(!i||i.mediaKeys||(this.hls.trigger(P.ERROR,{type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_NO_KEYS,fatal:!1,error:s,frag:t}),this.resetTransmuxer(),0))}return!1},r.fragContextChanged=function(e){var t=this.fragCurrent;return!e||!t||e.sn!==t.sn||e.level!==t.level},r.fragBufferedComplete=function(e,t){var r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log("Buffered "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+this.fragInfo(e,!1,t)+" > buffer:"+(r?function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+"-"+e.end(n).toFixed(3)+"]";return t}(zt.getBuffered(r)):"(detached)")+")"),ee(e)){var n;if(e.type!==D){var a=e.elementaryStreams;if(!Object.keys(a).some((function(e){return!!a[e]})))return void(this.state=un.IDLE)}var i=null==(n=this.levels)?void 0:n[e.level];null!=i&&i.fragmentError&&(this.log("Resetting level fragment error count of "+i.fragmentError+" on frag buffered"),i.fragmentError=0)}this.state=un.IDLE},r._handleFragmentLoadComplete=function(e){var t=this.transmuxer;if(t){var r=e.frag,n=e.part,a=e.partsLoaded,i=!a||0===a.length||a.some((function(e){return!e})),s=new Wt(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!i);t.flush(s)}},r._handleFragmentLoadProgress=function(e){},r._doFragLoad=function(e,t,r,n){var a,i=this;void 0===r&&(r=null),this.fragCurrent=e;var s=t.details;if(!this.levels||!s)throw new Error("frag load aborted, missing level"+(s?"":" detail")+"s");var o=null;if(!e.encrypted||null!=(a=e.decryptdata)&&a.key)e.encrypted||(o=this.keyLoader.loadClear(e,s.encryptedFragments,this.startFragRequested))&&this.log("[eme] blocking frag load until media-keys acquired");else if(this.log("Loading key for "+e.sn+" of ["+s.startSN+"-"+s.endSN+"], "+this.playlistLabel()+" "+e.level),this.state=un.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then((function(e){if(!i.fragContextChanged(e.frag))return i.hls.trigger(P.KEY_LOADED,e),i.state===un.KEY_LOADING&&(i.state=un.IDLE),e})),this.hls.trigger(P.KEY_LOADING,{frag:e}),null===this.fragCurrent)return this.log("context changed in KEY_LOADING"),Promise.resolve(null);var l,u=this.fragPrevious;if(ee(e)&&(!u||e.sn!==u.sn)){var c=this.shouldLoadParts(t.details,e.end);c!==this.loadingParts&&(this.log("LL-Part loading "+(c?"ON":"OFF")+" loading sn "+(null==u?void 0:u.sn)+"->"+e.sn),this.loadingParts=c)}if(r=Math.max(e.start,r||0),this.loadingParts&&ee(e)){var d=s.partList;if(d&&n){r>s.fragmentEnd&&s.fragmentHint&&(e=s.fragmentHint);var p=this.getNextPart(d,e,r);if(p>-1){var h,f=d[p];return e=this.fragCurrent=f.fragment,this.log("Loading "+e.type+" sn: "+e.sn+" part: "+f.index+" ("+p+"/"+(d.length-1)+") of "+this.fragInfo(e,!1,f)+") cc: "+e.cc+" ["+s.startSN+"-"+s.endSN+"], target: "+parseFloat(r.toFixed(3))),this.nextLoadPosition=f.start+f.duration,this.state=un.FRAG_LOADING,h=o?o.then((function(r){return!r||i.fragContextChanged(r.frag)?null:i.doFragPartsLoad(e,f,t,n)})).catch((function(e){return i.handleFragLoadError(e)})):this.doFragPartsLoad(e,f,t,n).catch((function(e){return i.handleFragLoadError(e)})),this.hls.trigger(P.FRAG_LOADING,{frag:e,part:f,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):h}if(!e.url||this.loadedEndOfParts(d,r))return Promise.resolve(null)}}if(ee(e)&&this.loadingParts)this.log("LL-Part loading OFF after next part miss @"+r.toFixed(2)+" Check buffer at sn: "+e.sn+" loaded parts: "+(null==(l=s.partList)?void 0:l.filter((function(e){return e.loaded})).map((function(e){return"["+e.start+"-"+e.end+"]"})))),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log("Loading "+e.type+" sn: "+e.sn+" of "+this.fragInfo(e,!1)+") cc: "+e.cc+" ["+s.startSN+"-"+s.endSN+"], target: "+parseFloat(r.toFixed(3))),E(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=un.FRAG_LOADING;var m,g=this.config.progressive;return m=g&&o?o.then((function(t){return!t||i.fragContextChanged(t.frag)?null:i.fragmentLoader.load(e,n)})).catch((function(e){return i.handleFragLoadError(e)})):Promise.all([this.fragmentLoader.load(e,g?n:void 0),o]).then((function(e){var t=e[0];return!g&&n&&n(t),t})).catch((function(e){return i.handleFragLoadError(e)})),this.hls.trigger(P.FRAG_LOADING,{frag:e,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):m},r.doFragPartsLoad=function(e,t,r,n){var a=this;return new Promise((function(i,s){var o,l=[],u=null==(o=r.details)?void 0:o.partList,c=function(t){a.fragmentLoader.loadPart(e,t,n).then((function(n){l[t.index]=n;var s=n.part;a.hls.trigger(P.FRAG_LOADED,n);var o=Xr(r.details,e.sn,t.index+1)||Zr(u,e.sn,t.index+1);if(!o)return i({frag:e,part:s,partsLoaded:l});c(o)})).catch(s)};c(t)}))},r.handleFragLoadError=function(e){if("data"in e){var t=e.data;t.frag&&t.details===S.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===A.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(P.ERROR,t)}else this.hls.trigger(P.ERROR,{type:A.OTHER_ERROR,details:S.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null},r._handleTransmuxerFlush=function(e){var t=this.getCurrentContext(e);if(t&&this.state===un.PARSING){var r=t.frag,n=t.part,a=t.level,i=self.performance.now();r.stats.parsing.end=i,n&&(n.stats.parsing.end=i);var s=this.getLevelDetails(),o=s&&r.sn>s.endSN||this.shouldLoadParts(s,r.end);o!==this.loadingParts&&(this.log("LL-Part loading "+(o?"ON":"OFF")+" after parsing segment ending @"+r.end.toFixed(2)),this.loadingParts=o),this.updateLevelTiming(r,n,a,e.partial)}else this.fragCurrent||this.state===un.STOPPED||this.state===un.ERROR||(this.state=un.IDLE)},r.shouldLoadParts=function(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r,n,a=e.partList[0];if(a.fragment.type===D)return!1;if(t>=a.end+((null==(r=e.fragmentHint)?void 0:r.duration)||0)&&(this.hls.hasEnoughToStart?(null==(n=this.media)?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}return!1},r.getCurrentContext=function(e){var t=this.levels,r=this.fragCurrent,n=e.level,a=e.sn,i=e.part;if(null==t||!t[n])return this.warn("Levels object was unset while buffering fragment "+a+" of "+this.playlistLabel()+" "+n+". The current chunk will not be buffered."),null;var s=t[n],o=s.details,l=i>-1?Xr(o,a,i):null,u=l?l.fragment:Yr(o,a,r);return u?(r&&r!==u&&(u.stats=r.stats),{frag:u,part:l,level:s}):null},r.bufferFragmentData=function(e,t,r,n,a){if(this.state===un.PARSING){var i=e.data1,s=e.data2,o=i;if(s&&(o=Ee(i,s)),o.length){var l=this.initPTS[t.cc],u=l?-l.baseTime/l.timescale:void 0,c={type:e.type,frag:t,part:r,chunkMeta:n,offset:u,parent:t.type,data:o};if(this.hls.trigger(P.BUFFER_APPENDING,c),e.dropped&&e.independent&&!r){if(a)return;this.flushBufferGap(t)}}}},r.flushBufferGap=function(e){var t=this.media;if(t)if(zt.isBuffered(t,t.currentTime)){var r=t.currentTime,n=zt.bufferInfo(t,r,0),a=e.duration,i=Math.min(2*this.config.maxFragLookUpTolerance,.25*a),s=Math.max(Math.min(e.start-i,n.end-i),r+i);e.start-s>i&&this.flushMainBuffer(s,e.start)}else this.flushMainBuffer(0,e.start)},r.getFwdBufferInfo=function(e,t){var r,n=this.getLoadPosition();if(!E(n))return null;var a=this.lastCurrentTime>n||null!=(r=this.media)&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,n,t,a)},r.getFwdBufferInfoAtPos=function(e,t,r,n){var a=zt.bufferInfo(e,t,n);if(0===a.len&&void 0!==a.nextStart){var i=this.fragmentTracker.getBufferedFrag(t,r);if(i&&(a.nextStart<=i.end||i.gap)){var s=Math.max(Math.min(a.nextStart,i.end)-t,n);return zt.bufferInfo(e,t,s)}}return a},r.getMaxBufferLength=function(e){var t,r=this.config;return t=e?Math.max(8*r.maxBufferSize/e,r.maxBufferLength):r.maxBufferLength,Math.min(t,r.maxMaxBufferLength)},r.reduceMaxBufferLength=function(e,t){var r=this.config,n=Math.max(Math.min(e-t,r.maxBufferLength),t),a=Math.max(e-3*t,r.maxMaxBufferLength/2,n);return a>=n&&(r.maxMaxBufferLength=a,this.warn("Reduce max buffer length to "+a+"s"),!0)},r.getAppendedFrag=function(e,t){void 0===t&&(t=R);var r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return r&&"fragment"in r?r.fragment:r},r.getNextFragment=function(e,t){var r=t.fragments,n=r.length;if(!n)return null;var a=this.config,i=r[0].start,s=a.lowLatencyMode&&!!t.partList,o=null;if(t.live){var l=a.initialLiveManifestSize;if(n<l)return this.warn("Not enough fragments to start playback (have: "+n+", need: "+l+")"),null;if(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<i){var u;s&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),o=this.getInitialLiveFragment(t);var c=this.hls.startPosition,d=this.hls.liveSyncPosition,p=o?(-1!==c&&c>=i?c:d)||o.start:e;this.log("Setting startPosition to "+p+" to match start frag at live edge. mainStart: "+c+" liveSyncPosition: "+d+" frag.start: "+(null==(u=o)?void 0:u.start)),this.startPosition=this.nextLoadPosition=p}}else e<=i&&(o=r[0]);if(!o){var h=this.loadingParts?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,h,t)}var f=this.filterReplacedPrimary(o,t);if(!f&&o){var m=o.sn-t.startSN;f=this.filterReplacedPrimary(r[m+1]||null,t)}return this.mapToInitFragWhenRequired(f)},r.isLoopLoading=function(e,t){var r=this.fragmentTracker.getState(e);return(r===wt||r===It&&!!e.gap)&&this.nextLoadPosition>t},r.getNextFragmentLoopLoading=function(e,t,r,n,a){var i=null;if(e.gap&&(i=this.getNextFragment(this.nextLoadPosition,t))&&!i.gap&&r.nextStart){var s=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n,0);if(null!==s&&r.len+s.len>=a){var o=i.sn;return this.loopSn!==o&&(this.log('buffer full after gaps in "'+n+'" playlist starting at sn: '+o),this.loopSn=o),null}}return this.loopSn=void 0,i},r.filterReplacedPrimary=function(e,t){if(!e)return e;if(dn(this.config)&&e.type!==D){var r=this.hls.interstitialsManager,n=null==r?void 0:r.bufferingItem;if(n){var a=n.event;if(a){if(a.appendInPlace||Math.abs(e.start-n.start)>1||0===n.start)return null}else{if(e.end<=n.start&&!1===(null==t?void 0:t.live))return null;if(e.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||e.start-n.end>1))return null}}var i=null==r?void 0:r.playerQueue;if(i)for(var s=i.length;s--;){var o=i[s].interstitial;if(o.appendInPlace&&e.start>=o.startTime&&e.end<=o.resumeTime)return null}}return e},r.mapToInitFragWhenRequired=function(e){return null==e||!e.initSegment||e.initSegment.data||this.bitrateTest?e:e.initSegment},r.getNextPart=function(e,t,r){for(var n=-1,a=!1,i=!0,s=0,o=e.length;s<o;s++){var l=e[s];if(i=i&&!l.independent,n>-1&&r<l.start)break;var u=l.loaded;u?n=-1:(a||(l.independent||i)&&l.fragment===t)&&(l.fragment!==t&&this.warn("Need buffer at "+r+" but next unloaded part starts at "+l.start),n=s),a=u}return n},r.loadedEndOfParts=function(e,t){for(var r,n=e.length;n--;){if(!(r=e[n]).loaded)return!1;if(t>r.start)return!0}return!1},r.getInitialLiveFragment=function(e){var t=e.fragments,r=this.fragPrevious,n=null;if(r){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),n=function(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!E(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;for(var n=0;n<e.length;++n){var a=e[n];if(mt(t,r,a))return a}return null}(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){var a=r.sn+1;if(a>=e.startSN&&a<=e.endSN){var i=t[a-e.startSN];r.cc===i.cc&&(n=i,this.log("Live playlist, switching playlist, load frag with next SN: "+n.sn))}n||(n=gt(e,r.cc,r.end))&&this.log("Live playlist, switching playlist, load frag with same CC: "+n.sn)}}else{var s=this.hls.liveSyncPosition;null!==s&&(n=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n},r.getFragmentAtPosition=function(e,t,r){var n,a,i=this.config,s=this.fragPrevious,o=r.fragments,l=r.endSN,u=r.fragmentHint,c=i.maxFragLookUpTolerance,d=r.partList,p=!!(this.loadingParts&&null!=d&&d.length&&u);if(p&&!this.bitrateTest&&d[d.length-1].fragment.sn===u.sn&&(o=o.concat(u),l=u.sn),n=e<t?ht(s,o,e,e<this.lastCurrentTime||e>t-c||null!=(a=this.media)&&a.paused||!this.startFragRequested?0:c):o[o.length-1]){var h=n.sn-r.startSN,f=this.fragmentTracker.getState(n);if((f===wt||f===It&&n.gap)&&(s=n),s&&n.sn===s.sn&&(!p||d[0].fragment.sn>n.sn||!r.live)&&n.level===s.level){var m=o[h+1];n=n.sn<l&&this.fragmentTracker.getState(m)!==wt?m:null}}return n},r.alignPlaylists=function(e,t,r){var n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;var a=e.fragmentStart,i=!t,s=e.alignedSliding&&E(a);if(i||!s&&!a){!function(e,t){e&&(an(t,e),t.alignedSliding||sn(t,e),t.alignedSliding||t.skippedSegments||$r(e,t,!1))}(r,e);var o=e.fragmentStart;return this.log("Live playlist sliding: "+o.toFixed(2)+" start-sn: "+(t?t.startSN:"na")+"->"+e.startSN+" fragments: "+n),o}return a},r.waitForCdnTuneIn=function(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)},r.setStartPosition=function(e,t){var r=this.startPosition;r<t&&(r=-1);var n=this.timelineOffset;if(-1===r){var a=null!==this.startTimeOffset,i=a?this.startTimeOffset:e.startTimeOffset;null!==i&&E(i)?(r=t+i,i<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log("Setting startPosition to "+r+" for start time offset "+i+" found in "+(a?"multivariant":"media")+" playlist"),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log("Setting startPosition to -1 to start at live edge "+r),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+n}this.nextLoadPosition=r+n},r.getLoadPosition=function(){var e,t=this.media,r=0;return null!=(e=this.hls)&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r},r.handleFragLoadAborted=function(e,t){this.transmuxer&&e.type===this.playlistType&&ee(e)&&e.stats.aborted&&(this.log("Fragment "+e.sn+(t?" part "+t.index:"")+" of "+this.playlistLabel()+" "+e.level+" was aborted"),this.resetFragmentLoading(e))},r.resetFragmentLoading=function(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===un.FRAG_LOADING_WAITING_RETRY)||(this.state=un.IDLE)},r.onFragmentOrKeyLoadError=function(e,t){var r;if(t.chunkMeta&&!t.frag){var n=this.getCurrentContext(t.chunkMeta);n&&(t.frag=n.frag)}var a=t.frag;if(a&&a.type===e&&this.levels)if(this.fragContextChanged(a)){var i;this.warn("Frag load error must match current frag to retry "+a.url+" > "+(null==(i=this.fragCurrent)?void 0:i.url))}else{var s=t.details===S.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(a,!0);var o=t.errorAction;if(o){var l=o.action,u=o.flags,c=o.retryCount,d=void 0===c?0:c,p=o.retryConfig,h=!!p,f=h&&5===l,m=h&&!o.resolved&&1===u,g=null==(r=this.hls.latestLevelDetails)?void 0:r.live;if(!f&&m&&ee(a)&&!a.endList&&g&&!_t(t))this.resetFragmentErrors(e),this.treatAsGap(a),o.resolved=!0;else if((f||m)&&d<p.maxNumRetry){var y,v=At(null==(y=t.response)?void 0:y.code),_=Et(p,d);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+_,this.state=un.FRAG_LOADING_WAITING_RETRY,o.resolved=!0,v)return this.log("Waiting for connection (offline)"),this.retryDate=1/0,void(t.reason="offline");this.warn("Fragment "+a.sn+" of "+e+" "+a.level+" errored with "+t.details+", retrying loading "+(d+1)+"/"+p.maxNumRetry+" in "+_+"ms")}else if(p){if(this.resetFragmentErrors(e),!(d<p.maxNumRetry))return void this.warn(t.details+" reached or exceeded max retry ("+d+")");s||3===l||(o.resolved=!0)}else this.state=2===l?un.WAITING_LEVEL:un.ERROR;this.tickImmediate()}else this.state=un.ERROR}},r.checkRetryDate=function(){var e=self.performance.now(),t=this.retryDate,r=t===1/0;(!t||e>=t||r&&!At(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=un.IDLE)},r.reduceLengthAndFlushBuffer=function(e){if(this.state===un.PARSING||this.state===un.PARSED){var t=e.frag,r=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,r),a=n&&n.len>.5;a&&this.reduceMaxBufferLength(n.len,(null==t?void 0:t.duration)||10);var i=!a;return i&&this.warn("Buffer full error while media.currentTime ("+this.getLoadPosition()+") is not buffered, flush "+r+" buffer"),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),i}return!1},r.resetFragmentErrors=function(e){e===M&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==un.STOPPED&&(this.state=un.IDLE)},r.afterBufferFlushed=function(e,t,r){if(e){var n=zt.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,r),this.state===un.ENDED&&this.resetLoadingState()}},r.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==un.STOPPED&&(this.state=un.IDLE)},r.resetStartWhenNotLoaded=function(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;var e=this.levelLastLoaded,t=e?e.details:null;null!=t&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},r.resetWhenMissingContext=function(e){this.log("Loading context changed while buffering sn "+e.sn+" of "+this.playlistLabel()+" "+(-1===e.level?"<removed>":e.level)+". This chunk will not be buffered."),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()},r.removeUnbufferedFrags=function(e){void 0===e&&(e=0),this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)},r.updateLevelTiming=function(e,t,r,n){var a=this,i=r.details;if(i){var s;if(!Object.keys(e.elementaryStreams).reduce((function(t,s){var o=e.elementaryStreams[s];if(o){var l=o.endPTS-o.startPTS;if(l<=0)return a.warn("Could not parse fragment "+e.sn+" "+s+" duration reliably ("+l+")"),t||!1;var u=n?0:Hr(i,e,o.startPTS,o.endPTS,o.startDTS,o.endDTS,a);return a.hls.trigger(P.LEVEL_PTS_UPDATED,{details:i,level:r,drift:u,type:s,frag:e,start:o.startPTS,end:o.endPTS}),!0}return t}),!1)&&(0===r.fragmentError&&this.treatAsGap(e,r),null===(null==(s=this.transmuxer)?void 0:s.error))){var o=new Error("Found no media in fragment "+e.sn+" of "+this.playlistLabel()+" "+e.level+" resetting transmuxer to fallback to playlist timing");if(this.warn(o.message),this.hls.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.FRAG_PARSING_ERROR,fatal:!1,error:o,frag:e,reason:"Found no media in msn "+e.sn+" of "+this.playlistLabel()+' "'+r.url+'"'}),!this.hls)return;this.resetTransmuxer()}this.state=un.PARSED,this.log("Parsed "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+this.fragInfo(e,!1,t)+")"),this.hls.trigger(P.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")},r.playlistLabel=function(){return this.playlistType===R?"level":"track"},r.fragInfo=function(e,t,r){var n,a;return void 0===t&&(t=!0),this.playlistLabel()+" "+e.level+" ("+(r?"part":"frag")+":["+(null!=(n=t&&!r?e.startPTS:(r||e).start)?n:NaN).toFixed(3)+"-"+(null!=(a=t&&!r?e.endPTS:(r||e).end)?a:NaN).toFixed(3)+"]"+(r&&"main"===e.type?"INDEPENDENT="+(r.independent?"YES":"NO"):"")},r.treatAsGap=function(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)},r.resetTransmuxer=function(){var e;null==(e=this.transmuxer)||e.reset()},r.recoverWorkerError=function(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())},n(t,[{key:"startPositionValue",get:function(){var e=this.nextLoadPosition,t=this.startPosition;return-1===t&&e?e:t}},{key:"bufferingEnabled",get:function(){return this.buffering}},{key:"inFlightFrag",get:function(){return{frag:this.fragCurrent,state:this.state}}},{key:"timelineOffset",get:function(){var e,t=this.config.timelineOffset;return t?(null==(e=this.getLevelDetails())?void 0:e.appliedTimelineOffset)||t:0}},{key:"primaryPrefetch",get:function(){var e;return!(!dn(this.config)||!(null==(e=this.hls.interstitialsManager)||null==(e=e.playingItem)?void 0:e.event))}},{key:"state",get:function(){return this._state},set:function(e){var t=this._state;t!==e&&(this._state=e,this.log(t+"->"+e))}}])}(Kt);function dn(e){return!!e.interstitialsController&&!1!==e.enableInterstitialPlayback}var pn=function(){function e(){this.chunks=[],this.dataLength=0}var t=e.prototype;return t.push=function(e){this.chunks.push(e),this.dataLength+=e.length},t.flush=function(){var e,t=this.chunks,r=this.dataLength;return t.length?(e=1===t.length?t[0]:function(e,t){for(var r=new Uint8Array(t),n=0,a=0;a<e.length;a++){var i=e[a];r.set(i,n),n+=i.length}return r}(t,r),this.reset(),e):new Uint8Array(0)},t.reset=function(){this.chunks.length=0,this.dataLength=0},e}();function hn(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function fn(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function mn(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]}function gn(e,t){for(var r=t,n=0;fn(e,t);)n+=10,n+=mn(e,t+6),hn(e,t+10)&&(n+=10),t+=n;if(n>0)return e.subarray(r,r+n)}function yn(e,t){return 255===e[t]&&240==(246&e[t+1])}function vn(e,t){return 1&e[t+1]?7:9}function _n(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function kn(e,t){return t+1<e.length&&yn(e,t)}function En(e,t){if(kn(e,t)){var r=vn(e,t);if(t+r>=e.length)return!1;var n=_n(e,t);if(n<=r)return!1;var a=t+n;return a===e.length||kn(e,a)}return!1}function bn(e,t,r,n,a){if(!e.samplerate){var s=function(e,t,r,n){var a=t[r+2],i=a>>2&15;if(!(i>12)){var s=1+(a>>6&3),o=t[r+3]>>6&3|(1&a)<<2,l="mp4a.40."+s,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][i],c=i;5!==s&&29!==s||(c-=3);var d=[s<<3|(14&c)>>1,(1&c)<<7|o<<3];return H.log("manifest codec:"+n+", parsed codec:"+l+", channels:"+o+", rate:"+u+" (ADTS object type:"+s+" sampling index:"+i+")"),{config:d,samplerate:u,channelCount:o,codec:l,parsedCodec:l,manifestCodec:n}}var p=new Error("invalid ADTS sampling index:"+i);e.emit(P.ERROR,P.ERROR,{type:A.MEDIA_ERROR,details:S.FRAG_PARSING_ERROR,fatal:!0,error:p,reason:p.message})}(t,r,n,a);if(!s)return;i(e,s)}}function Tn(e){return 9216e4/e}function An(e,t,r,n,a){var i,s=n+a*Tn(e.samplerate),o=function(e,t){var r=vn(e,t);if(t+r<=e.length){var n=_n(e,t)-r;if(n>0)return{headerLength:r,frameLength:n}}}(t,r);if(o){var l=o.frameLength,u=o.headerLength,c=u+l,d=Math.max(0,r+c-t.length);d?(i=new Uint8Array(c-u)).set(t.subarray(r+u,t.length),0):i=t.subarray(r+u,r+c);var p={unit:i,pts:s};return d||e.samples.push(p),{sample:p,length:c,missing:d}}var h=t.length-r;return(i=new Uint8Array(h)).set(t.subarray(r,t.length),0),{sample:{unit:i,pts:s},length:h,missing:-1}}function Sn(e,t){return fn(e,t)&&mn(e,t+6)+10<=e.length-t}function Pn(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1/0),function(e,t,r,n){var a=function(e){return e instanceof ArrayBuffer?e:e.buffer}(e),i=1;"BYTES_PER_ELEMENT"in n&&(i=n.BYTES_PER_ELEMENT);var s,o=(s=e)&&s.buffer instanceof ArrayBuffer&&void 0!==s.byteLength&&void 0!==s.byteOffset?e.byteOffset:0,l=(o+e.byteLength)/i,u=(o+t)/i,c=Math.floor(Math.max(0,Math.min(u,l)));return new n(a,c,Math.floor(Math.min(c+Math.max(r,0),l))-c)}(e,t,r,Uint8Array)}function Cn(e){return"PRIV"===e.type?function(e){if(!(e.size<2)){var t=$(e.data,!0),r=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:r.buffer}}}(e):"W"===e.type[0]?function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,r=$(e.data.subarray(t),!0);t+=r.length+1;var n=$(e.data.subarray(t));return{key:e.type,info:r,data:n}}var a=$(e.data);return{key:e.type,info:"",data:a}}(e):"APIC"===e.type?function(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if(!(e.size<2))if(3===e.data[0]){var r=e.data.subarray(1).indexOf(0);if(-1!==r){var n=$(Pn(e.data,1,r)),a=e.data[2+r],i=e.data.subarray(3+r).indexOf(0);if(-1!==i){var s,o=$(Pn(e.data,3+r,i));return s="--\x3e"===n?$(Pn(e.data,4+r+i)):function(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}(e.data.subarray(4+r+i)),t.mimeType=n,t.pictureType=a,t.description=o,t.data=s,t}}}else console.log("Ignore frame with unrecognized character encoding")}(e):function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,r=$(e.data.subarray(t),!0);t+=r.length+1;var n=$(e.data.subarray(t));return{key:e.type,info:r,data:n}}var a=$(e.data.subarray(1));return{key:e.type,info:"",data:a}}}(e)}function xn(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=mn(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}}var In=10,wn=10;function Rn(e){for(var t=0,r=[];fn(e,t);){var n=mn(e,t+6);e[t+5]>>6&1&&(t+=In);for(var a=(t+=In)+n;t+wn<a;){var i=xn(e.subarray(t)),s=Cn(i);s&&r.push(s),t+=i.size+In}hn(e,t)&&(t+=In)}return r}function Mn(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}function Dn(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}}function On(e){for(var t=Rn(e),r=0;r<t.length;r++){var n=t[r];if(Mn(n))return Dn(n)}}var Ln=function(e){return e.audioId3="org.id3",e.dateRange="com.apple.quicktime.HLS",e.emsg="https://aomedia.org/emsg/ID3",e.misbklv="urn:misb:KLV:bin:1910.1",e}({});function Nn(e,t){return void 0===e&&(e=""),void 0===t&&(t=9e4),{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}var Un=function(){function e(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var t=e.prototype;return t.resetInitSegment=function(e,t,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},t.resetTimeStamp=function(e){this.initPTS=e,this.resetContiguity()},t.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},t.canParse=function(e,t){return!1},t.appendFrame=function(e,t,r){},t.demux=function(e,t){this.cachedData&&(e=Ee(this.cachedData,e),this.cachedData=null);var r,n=gn(e,0),a=n?n.length:0,i=this._audioTrack,s=this._id3Track,o=n?On(n):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&E(o))&&(this.basePTS=jn(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),n&&n.length>0&&s.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Ln.audioId3,duration:Number.POSITIVE_INFINITY});a<l;){if(this.canParse(e,a)){var u=this.appendFrame(i,e,a);u?(this.frameIndex++,this.lastPTS=u.sample.pts,r=a+=u.length):a=l}else Sn(e,a)?(n=gn(e,a),s.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Ln.audioId3,duration:Number.POSITIVE_INFINITY}),r=a+=n.length):a++;if(a===l&&r!==l){var c=e.slice(r);this.cachedData?this.cachedData=Ee(this.cachedData,c):this.cachedData=c}}return{audioTrack:i,videoTrack:Nn(),id3Track:s,textTrack:Nn()}},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},t.flush=function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Nn(),id3Track:this._id3Track,textTrack:Nn()}},t.destroy=function(){this.cachedData=null,this._audioTrack=this._id3Track=void 0},e}(),jn=function(e,t,r){return E(e)?90*e:9e4*t+(r?9e4*r.baseTime/r.timescale:0)},Bn=null,Fn=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Vn=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Gn=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Hn=[0,1,1,4];function Kn(e,t,r,n,a){if(!(r+24>t.length)){var i=Wn(t,r);if(i&&r+i.frameLength<=t.length){var s=n+a*(9e4*i.samplesPerFrame/i.sampleRate),o={unit:t.subarray(r,r+i.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=i.channelCount,e.samplerate=i.sampleRate,e.samples.push(o),{sample:o,length:i.frameLength,missing:0}}}}function Wn(e,t){var r=e[t+1]>>3&3,n=e[t+1]>>1&3,a=e[t+2]>>4&15,i=e[t+2]>>2&3;if(1!==r&&0!==a&&15!==a&&3!==i){var s=e[t+2]>>1&1,o=e[t+3]>>6,l=1e3*Fn[14*(3===r?3-n:3===n?3:4)+a-1],u=Vn[3*(3===r?0:2===r?1:2)+i],c=3===o?1:2,d=Gn[r][n],p=Hn[n],h=8*d*p,f=Math.floor(d*l/u+s)*p;if(null===Bn){var m=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Bn=m?parseInt(m[1]):0}return!!Bn&&Bn<=87&&2===n&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:f,samplesPerFrame:h}}}function $n(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function zn(e,t){return t+1<e.length&&$n(e,t)}function qn(e,t){if(t+1<e.length&&$n(e,t)){var r=Wn(e,t),n=4;null!=r&&r.frameLength&&(n=r.frameLength);var a=t+n;return a===e.length||zn(e,a)}return!1}var Yn=function(e){function t(t,r){var n;return(n=e.call(this)||this).observer=void 0,n.config=void 0,n.observer=t,n.config=r,n}o(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,n,a){e.prototype.resetInitSegment.call(this,t,r,n,a),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:r,duration:a,inputTimeScale:9e4,dropped:0}},t.probe=function(e,t){if(!e)return!1;var r=gn(e,0),n=(null==r?void 0:r.length)||0;if(qn(e,n))return!1;for(var a=e.length;n<a;n++)if(En(e,n))return t.log("ADTS sync word found !"),!0;return!1},r.canParse=function(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&yn(e,t)&&_n(e,t)<=e.length-t}(e,t)},r.appendFrame=function(e,t,r){bn(e,this.observer,t,r,e.manifestCodec);var n=An(e,t,r,this.basePTS,this.frameIndex);if(n&&0===n.missing)return n},t}(Un),Xn=function(e,t){var r=0,n=5;t+=n;for(var a=new Uint32Array(1),i=new Uint32Array(1),s=new Uint8Array(1);n>0;){s[0]=e[t];var o=Math.min(n,8),l=8-o;i[0]=4278190080>>>24+l<<l,a[0]=(s[0]&i[0])>>l,r=r?r<<o|a[0]:a[0],t+=1,n-=o}return r},Zn=function(e){function t(t){var r;return(r=e.call(this)||this).observer=void 0,r.observer=t,r}o(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,n,a){e.prototype.resetInitSegment.call(this,t,r,n,a),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:r,duration:a,inputTimeScale:9e4,dropped:0}},r.canParse=function(e,t){return t+64<e.length},r.appendFrame=function(e,t,r){var n=Qn(e,t,r,this.basePTS,this.frameIndex);if(-1!==n)return{sample:e.samples[e.samples.length-1],length:n,missing:0}},t.probe=function(e){if(!e)return!1;var t=gn(e,0);if(!t)return!1;var r=t.length;return 11===e[r]&&119===e[r+1]&&void 0!==On(t)&&Xn(e,r)<16},t}(Un);function Qn(e,t,r,n,a){if(r+8>t.length)return-1;if(11!==t[r]||119!==t[r+1])return-1;var i=t[r+4]>>6;if(i>=3)return-1;var s=[48e3,44100,32e3][i],o=63&t[r+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+i];if(r+l>t.length)return-1;var u=t[r+6]>>5,c=0;2===u?c+=2:(1&u&&1!==u&&(c+=2),4&u&&(c+=2));var d=(t[r+6]<<8|t[r+7])>>12-c&1,p=[2,1,2,3,3,4,4,5][u]+d,h=t[r+5]>>3,f=7&t[r+5],m=new Uint8Array([i<<6|h<<1|f>>2,(3&f)<<6|u<<3|d<<2|o>>4,o<<4&224]),g=n+a*(1536/s*9e4),y=t.subarray(r,r+l);return e.config=m,e.channelCount=p,e.samplerate=s,e.samples.push({unit:y,pts:g}),l}var Jn=function(e){function t(){return e.apply(this,arguments)||this}o(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,n,a){e.prototype.resetInitSegment.call(this,t,r,n,a),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:r,duration:a,inputTimeScale:9e4,dropped:0}},t.probe=function(e){if(!e)return!1;var t=gn(e,0),r=(null==t?void 0:t.length)||0;if(t&&11===e[r]&&119===e[r+1]&&void 0!==On(t)&&Xn(e,r)<=16)return!1;for(var n=e.length;r<n;r++)if(qn(e,r))return H.log("MPEG Audio sync word found !"),!0;return!1},r.canParse=function(e,t){return function(e,t){return $n(e,t)&&4<=e.length-t}(e,t)},r.appendFrame=function(e,t,r){if(null!==this.basePTS)return Kn(e,t,r,this.basePTS,this.frameIndex)},t}(Un),ea=/\/emsg[-/]ID3/i,ta=function(){function e(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}var t=e.prototype;return t.resetTimeStamp=function(){},t.resetInitSegment=function(e,t,r,n){var a=this.videoTrack=Nn("video",1),i=this.audioTrack=Nn("audio",1),s=this.txtTrack=Nn("text",1);if(this.id3Track=Nn("id3",1),this.timeOffset=0,null!=e&&e.byteLength){var o=fe(e);if(o.video){var l=o.video,u=l.id,c=l.timescale,d=l.codec,p=l.supplemental;a.id=u,a.timescale=s.timescale=c,a.codec=d,a.supplemental=p}if(o.audio){var h=o.audio,f=h.id,m=h.timescale,g=h.codec;i.id=f,i.timescale=m,i.codec=g}s.id=se.text,a.sampleDuration=0,a.duration=i.duration=n}},t.resetContiguity=function(){this.remainderData=null},e.probe=function(e){return function(e){for(var t=e.byteLength,r=0;r<t;){var n=ue(e,r);if(n>8&&109===e[r+4]&&111===e[r+5]&&111===e[r+6]&&102===e[r+7])return!0;r=n>1?r+n:t}return!1}(e)},t.demux=function(e,t){this.timeOffset=t;var r=e,n=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=Ee(this.remainderData,e));var i=function(e){var t={valid:null,remainder:null},r=pe(e,["moof"]);if(r.length<2)return t.remainder=e,t;var n=r[r.length-1];return t.valid=e.slice(0,n.byteOffset-8),t.remainder=e.slice(n.byteOffset-8),t}(r);this.remainderData=i.remainder,n.samples=i.valid||new Uint8Array}else n.samples=r;var s=this.extractID3Track(n,t);return a.samples=be(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}},t.flush=function(){var e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;var n=this.extractID3Track(t,this.timeOffset);return r.samples=be(e,t),{videoTrack:t,audioTrack:Nn(),id3Track:n,textTrack:Nn()}},t.extractID3Track=function(e,t){var r=this,n=this.id3Track;if(e.samples.length){var a=pe(e.samples,["emsg"]);a&&a.forEach((function(e){var a=function(e){var t=e[0],r="",n="",a=0,i=0,s=0,o=0,l=0,u=0;if(0===t){for(;"\0"!==oe(e.subarray(u,u+1));)r+=oe(e.subarray(u,u+1)),u+=1;for(r+=oe(e.subarray(u,u+1)),u+=1;"\0"!==oe(e.subarray(u,u+1));)n+=oe(e.subarray(u,u+1)),u+=1;n+=oe(e.subarray(u,u+1)),u+=1,a=ue(e,12),i=ue(e,16),o=ue(e,20),l=ue(e,24),u=28}else if(1===t){a=ue(e,u+=4);var c=ue(e,u+=4),d=ue(e,u+=4);for(u+=4,s=Math.pow(2,32)*c+d,b(s)||(s=Number.MAX_SAFE_INTEGER,H.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=ue(e,u),l=ue(e,u+=4),u+=4;"\0"!==oe(e.subarray(u,u+1));)r+=oe(e.subarray(u,u+1)),u+=1;for(r+=oe(e.subarray(u,u+1)),u+=1;"\0"!==oe(e.subarray(u,u+1));)n+=oe(e.subarray(u,u+1)),u+=1;n+=oe(e.subarray(u,u+1)),u+=1}return{schemeIdUri:r,value:n,timeScale:a,presentationTime:s,presentationTimeDelta:i,eventDuration:o,id:l,payload:e.subarray(u,e.byteLength)}}(e);if(ea.test(a.schemeIdUri)){var i=ra(a,t),s=4294967295===a.eventDuration?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;s<=.001&&(s=Number.POSITIVE_INFINITY);var o=a.payload;n.samples.push({data:o,len:o.byteLength,dts:i,pts:i,type:Ln.emsg,duration:s})}else if(r.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){var l=ra(a,t);n.samples.push({data:a.payload,len:a.payload.byteLength,dts:l,pts:l,type:Ln.misbklv,duration:Number.POSITIVE_INFINITY})}}))}return n},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},t.destroy=function(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0},e}();function ra(e,t){return E(e.presentationTime)?e.presentationTime/e.timeScale:t+e.presentationTimeDelta/e.timeScale}var na=function(){function e(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new jt(t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,0)},t.decryptAacSample=function(e,t,r){var n=this,a=e[t].unit;if(!(a.length<=16)){var i=a.subarray(16,a.length-a.length%16),s=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(s).then((function(i){var s=new Uint8Array(i);a.set(s,16),n.decrypter.isSync()||n.decryptAacSamples(e,t+1,r)})).catch(r)}},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,r),this.decrypter.isSync())))return}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,a=32;a<e.length-16;a+=160,n+=16)r.set(e.subarray(a,a+16),n);return r},t.getAvcDecryptedUnit=function(e,t){for(var r=new Uint8Array(t),n=0,a=32;a<e.length-16;a+=160,n+=16)e.set(r.subarray(n,n+16),a);return e},t.decryptAvcSample=function(e,t,r,n,a){var i=this,s=Pe(a.data),o=this.getAvcEncryptedData(s);this.decryptBuffer(o.buffer).then((function(o){a.data=i.getAvcDecryptedUnit(s,o),i.decrypter.isSync()||i.decryptAvcSamples(e,t,r+1,n)})).catch(n)},t.decryptAvcSamples=function(e,t,r,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length)return void n();for(var a=e[t].units;!(r>=a.length);r++){var i=a[r];if(!(i.data.length<=48||1!==i.type&&5!==i.type||(this.decryptAvcSample(e,t,r,n,i),this.decrypter.isSync())))return}}},e}(),aa=function(){function e(){this.VideoSample=null}var t=e.prototype;return t.createVideoSample=function(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}},t.getLastNalUnit=function(e){var t,r,n=this.VideoSample;if(n&&0!==n.units.length||(n=e[e.length-1]),null!=(t=n)&&t.units){var a=n.units;r=a[a.length-1]}return r},t.pushAccessUnit=function(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var r=t.samples,n=r.length;if(!n)return void t.dropped++;var a=r[n-1];e.pts=a.pts,e.dts=a.dts}t.samples.push(e)}},t.parseNALu=function(e,t,r){var n,a,i=t.byteLength,s=e.naluState||0,o=s,l=[],u=0,c=-1,d=0;for(-1===s&&(c=0,d=this.getNALuType(t,0),s=0,u=1);u<i;)if(n=t[u++],s)if(1!==s)if(n)if(1===n){if(a=u-s-1,c>=0){var p={data:t.subarray(c,a),type:d};l.push(p)}else{var h=this.getLastNalUnit(e.samples);h&&(o&&u<=4-o&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-o)),a>0&&(h.data=Ee(h.data,t.subarray(0,a)),h.state=0))}u<i?(c=u,d=this.getNALuType(t,u),s=0):s=-1}else s=0;else s=3;else s=n?0:2;else s=n?0:1;if(c>=0&&s>=0){var f={data:t.subarray(c,i),type:d,state:s};l.push(f)}if(0===l.length){var m=this.getLastNalUnit(e.samples);m&&(m.data=Ee(m.data,t))}return e.naluState=s,l},e}(),ia=function(){function e(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");n.set(e.subarray(r,r+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a},t.skipBits=function(e){var t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;if(e>32&&H.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},e}(),sa=function(e){function t(){return e.apply(this,arguments)||this}o(t,e);var r=t.prototype;return r.parsePES=function(e,t,r,n){var a,i=this,s=this.parseNALu(e,r.data,n),o=this.VideoSample,l=!1;r.data=null,o&&s.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),s.forEach((function(n){var s,u;switch(n.type){case 1:var c=!1;a=!0;var d,p=n.data;if(l&&p.length>4){var h=i.readSliceType(p);2!==h&&4!==h&&7!==h&&9!==h||(c=!0)}c&&null!=(d=o)&&d.frame&&!o.key&&(i.pushAccessUnit(o,e),o=i.VideoSample=null),o||(o=i.VideoSample=i.createVideoSample(!0,r.pts,r.dts)),o.frame=!0,o.key=c;break;case 5:a=!0,null!=(s=o)&&s.frame&&!o.key&&(i.pushAccessUnit(o,e),o=i.VideoSample=null),o||(o=i.VideoSample=i.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 6:a=!0,Se(n.data,1,r.pts,t.samples);break;case 7:var f,m;a=!0,l=!0;var g=n.data,y=i.readSPS(g);if(!e.sps||e.width!==y.width||e.height!==y.height||(null==(f=e.pixelRatio)?void 0:f[0])!==y.pixelRatio[0]||(null==(m=e.pixelRatio)?void 0:m[1])!==y.pixelRatio[1]){e.width=y.width,e.height=y.height,e.pixelRatio=y.pixelRatio,e.sps=[g];for(var v=g.subarray(1,4),_="avc1.",k=0;k<3;k++){var E=v[k].toString(16);E.length<2&&(E="0"+E),_+=E}e.codec=_}break;case 8:a=!0,e.pps=[n.data];break;case 9:a=!0,e.audFound=!0,null!=(u=o)&&u.frame&&(i.pushAccessUnit(o,e),o=null),o||(o=i.VideoSample=i.createVideoSample(!1,r.pts,r.dts));break;case 12:a=!0;break;default:a=!1}o&&a&&o.units.push(n)})),n&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)},r.getNALuType=function(e,t){return 31&e[t]},r.readSliceType=function(e){var t=new ia(e);return t.readUByte(),t.readUEG(),t.readUEG()},r.skipScalingList=function(e,t){for(var r=8,n=8,a=0;a<e;a++)0!==n&&(n=(r+t.readEG()+256)%256),r=0===n?r:n},r.readSPS=function(e){var t,r,n,a=new ia(e),i=0,s=0,o=0,l=0,u=a.readUByte.bind(a),c=a.readBits.bind(a),d=a.readUEG.bind(a),p=a.readBoolean.bind(a),h=a.skipBits.bind(a),f=a.skipEG.bind(a),m=a.skipUEG.bind(a),g=this.skipScalingList.bind(this);u();var y=u();if(c(5),h(3),u(),m(),100===y||110===y||122===y||244===y||44===y||83===y||86===y||118===y||128===y){var v=d();if(3===v&&h(1),m(),m(),h(1),p())for(r=3!==v?8:12,n=0;n<r;n++)p()&&g(n<6?16:64,a)}m();var _=d();if(0===_)d();else if(1===_)for(h(1),f(),f(),t=d(),n=0;n<t;n++)f();m(),h(1);var k=d(),E=d(),b=c(1);0===b&&h(1),h(1),p()&&(i=d(),s=d(),o=d(),l=d());var T=[1,1];if(p()&&p())switch(u()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[u()<<8|u(),u()<<8|u()]}return{width:Math.ceil(16*(k+1)-2*i-2*s),height:(2-b)*(E+1)*16-(b?2:4)*(o+l),pixelRatio:T}},t}(aa),oa=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this).initVPS=null,t}o(t,e);var r=t.prototype;return r.parsePES=function(e,t,r,n){var a,s=this,o=this.parseNALu(e,r.data,n),l=this.VideoSample,u=!1;r.data=null,l&&o.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),o.forEach((function(n){var o,c;switch(n.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:l||(l=s.VideoSample=s.createVideoSample(!1,r.pts,r.dts)),l.frame=!0,a=!0;break;case 16:case 17:case 18:case 21:var d;a=!0,u&&null!=(d=l)&&d.frame&&!l.key&&(s.pushAccessUnit(l,e),l=s.VideoSample=null),l||(l=s.VideoSample=s.createVideoSample(!0,r.pts,r.dts)),l.key=!0,l.frame=!0;break;case 19:case 20:a=!0,null!=(o=l)&&o.frame&&!l.key&&(s.pushAccessUnit(l,e),l=s.VideoSample=null),l||(l=s.VideoSample=s.createVideoSample(!0,r.pts,r.dts)),l.key=!0,l.frame=!0;break;case 39:a=!0,Se(n.data,2,r.pts,t.samples);break;case 32:a=!0,e.vps||("object"!=typeof e.params&&(e.params={}),e.params=i(e.params,s.readVPS(n.data)),s.initVPS=n.data),e.vps=[n.data];break;case 33:if(a=!0,u=!0,void 0===e.vps||e.vps[0]===s.initVPS||void 0===e.sps||s.matchSPS(e.sps[0],n.data)||(s.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){var p=s.readSPS(n.data);for(var h in e.width=p.width,e.height=p.height,e.pixelRatio=p.pixelRatio,e.codec=p.codecString,e.sps=[],"object"!=typeof e.params&&(e.params={}),p.params)e.params[h]=p.params[h]}s.pushParameterSet(e.sps,n.data,e.vps),l||(l=s.VideoSample=s.createVideoSample(!0,r.pts,r.dts)),l.key=!0;break;case 34:if(a=!0,"object"==typeof e.params){if(!e.pps){e.pps=[];var f=s.readPPS(n.data);for(var m in f)e.params[m]=f[m]}s.pushParameterSet(e.pps,n.data,e.vps)}break;case 35:a=!0,e.audFound=!0,null!=(c=l)&&c.frame&&(s.pushAccessUnit(l,e),l=null),l||(l=s.VideoSample=s.createVideoSample(!1,r.pts,r.dts));break;default:a=!1}l&&a&&l.units.push(n)})),n&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)},r.pushParameterSet=function(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)},r.getNALuType=function(e,t){return(126&e[t])>>>1},r.ebsp2rbsp=function(e){for(var t=new Uint8Array(e.byteLength),r=0,n=0;n<e.byteLength;n++)n>=2&&3===e[n]&&0===e[n-1]&&0===e[n-2]||(t[r]=e[n],r++);return new Uint8Array(t.buffer,0,r)},r.pushAccessUnit=function(t,r){e.prototype.pushAccessUnit.call(this,t,r),this.initVPS&&(this.initVPS=null)},r.readVPS=function(e){var t=new ia(e);return t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6),{numTemporalLayers:t.readBits(3)+1,temporalIdNested:t.readBoolean()}},r.readSPS=function(e){var t=new ia(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);var r=t.readBits(3);t.readBoolean();for(var n=t.readBits(2),a=t.readBoolean(),i=t.readBits(5),s=t.readUByte(),o=t.readUByte(),l=t.readUByte(),u=t.readUByte(),c=t.readUByte(),d=t.readUByte(),p=t.readUByte(),h=t.readUByte(),f=t.readUByte(),m=t.readUByte(),g=t.readUByte(),y=[],v=[],_=0;_<r;_++)y.push(t.readBoolean()),v.push(t.readBoolean());if(r>0)for(var k=r;k<8;k++)t.readBits(2);for(var E=0;E<r;E++)y[E]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),v[E]&&t.readUByte();t.readUEG();var b=t.readUEG();3==b&&t.skipBits(1);var T=t.readUEG(),A=t.readUEG(),S=t.readBoolean(),P=0,C=0,x=0,I=0;S&&(P+=t.readUEG(),C+=t.readUEG(),x+=t.readUEG(),I+=t.readUEG());for(var w=t.readUEG(),R=t.readUEG(),M=t.readUEG(),D=t.readBoolean()?0:r;D<=r;D++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(var O=0;O<4;O++)for(var L=0;L<(3===O?2:6);L++)if(t.readBoolean()){var N=Math.min(64,1<<4+(O<<1));O>1&&t.readEG();for(var U=0;U<N;U++)t.readEG()}else t.readUEG();t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());for(var j=t.readUEG(),B=0,F=0;F<j;F++){var V=!1;if(0!==F&&(V=t.readBoolean()),V){F===j&&t.readUEG(),t.readBoolean(),t.readUEG();for(var G=0,H=0;H<=B;H++){var K=t.readBoolean(),W=!1;K||(W=t.readBoolean()),(K||W)&&G++}B=G}else{var $=t.readUEG(),z=t.readUEG();B=$+z;for(var q=0;q<$;q++)t.readUEG(),t.readBoolean();for(var Y=0;Y<z;Y++)t.readUEG(),t.readBoolean()}}if(t.readBoolean())for(var X=t.readUEG(),Z=0;Z<X;Z++){for(var Q=0;Q<M+4;Q++)t.readBits(1);t.readBits(1)}var J=0,ee=1,te=1,re=!0,ne=1,ae=0;if(t.readBoolean(),t.readBoolean(),t.readBoolean()){if(t.readBoolean()){var ie=t.readUByte();ie>0&&ie<16?(ee=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][ie-1],te=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][ie-1]):255===ie&&(ee=t.readBits(16),te=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(ne=t.readBits(32),ae=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){var se=t.readBoolean(),oe=t.readBoolean(),le=!1;(se||oe)&&((le=t.readBoolean())&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),le&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(var ue=0;ue<=r;ue++){var ce=!1;(re=t.readBoolean())||t.readBoolean()?t.readEG():ce=t.readBoolean();var de=ce?1:t.readUEG()+1;if(se)for(var pe=0;pe<de;pe++)t.readUEG(),t.readUEG(),le&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(oe)for(var he=0;he<de;he++)t.readUEG(),t.readUEG(),le&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),J=t.readUEG())}var fe=T,me=A;if(S){var ge=1,ye=1;1===b?ge=ye=2:2==b&&(ge=2),fe=T-ge*C-ge*P,me=A-ye*I-ye*x}for(var ve=n?["A","B","C"][n]:"",_e=s<<24|o<<16|l<<8|u,ke=0,Ee=0;Ee<32;Ee++)ke=(ke|(_e>>Ee&1)<<31-Ee)>>>0;var be=ke.toString(16);return 1===i&&"2"===be&&(be="6"),{codecString:"hvc1."+ve+i+"."+be+"."+(a?"H":"L")+g+".B0",params:{general_tier_flag:a,general_profile_idc:i,general_profile_space:n,general_profile_compatibility_flags:[s,o,l,u],general_constraint_indicator_flags:[c,d,p,h,f,m],general_level_idc:g,bit_depth:w+8,bit_depth_luma_minus8:w,bit_depth_chroma_minus8:R,min_spatial_segmentation_idc:J,chroma_format_idc:b,frame_rate:{fixed:re,fps:ae/ne}},width:fe,height:me,pixelRatio:[ee,te]}},r.readPPS=function(e){var t=new ia(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);var r=t.readBoolean(),n=t.readBoolean(),a=1;return n&&r?a=0:n?a=3:r&&(a=2),{parallelismType:a}},r.matchSPS=function(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)},t}(aa),la=188,ua=function(){function e(e,t,r,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=n,this.videoParser=null}e.probe=function(t,r){var n=e.syncOffset(t);return n>0&&r.warn("MPEG2-TS detected but first sync word found @ offset "+n),-1!==n},e.syncOffset=function(e){for(var t=e.length,r=Math.min(940,t-la)+1,n=0;n<r;){for(var a=!1,i=-1,s=0,o=n;o<t;o+=la){if(71!==e[o]||t-o!==la&&71!==e[o+la]){if(s)return-1;break}if(s++,-1===i&&0!==(i=o)&&(r=Math.min(i+18612,e.length-la)+1),a||(a=0===ca(e,o)),a&&s>1&&(0===i&&s>2||o+la>r))return i}n++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:se[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}};var t=e.prototype;return t.resetInitSegment=function(t,r,n,a){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=e.createTrack("video"),this._videoTrack.duration=a,this._audioTrack=e.createTrack("audio",a),this._id3Track=e.createTrack("id3"),this._txtTrack=e.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=r,this.videoCodec=n},t.resetTimeStamp=function(){},t.resetContiguity=function(){var e=this._audioTrack,t=this._videoTrack,r=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null},t.demux=function(t,r,n,a){var i;void 0===n&&(n=!1),void 0===a&&(a=!1),n||(this.sampleAes=null);var s=this._videoTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack,c=s.pid,d=s.pesData,p=o.pid,h=l.pid,f=o.pesData,m=l.pesData,g=null,y=this.pmtParsed,v=this._pmtId,_=t.length;if(this.remainderData&&(_=(t=Ee(this.remainderData,t)).length,this.remainderData=null),_<la&&!a)return this.remainderData=t,{audioTrack:o,videoTrack:s,id3Track:l,textTrack:u};var k=Math.max(0,e.syncOffset(t));(_-=(_-k)%la)<t.byteLength&&!a&&(this.remainderData=new Uint8Array(t.buffer,_,t.buffer.byteLength-_));for(var E=0,b=k;b<_;b+=la)if(71===t[b]){var T=!!(64&t[b+1]),A=ca(t,b),S=void 0;if((48&t[b+3])>>4>1){if((S=b+5+t[b+4])===b+la)continue}else S=b+4;switch(A){case c:T&&(d&&(i=ma(d,this.logger))&&(this.readyVideoParser(s.segmentCodec),null!==this.videoParser&&this.videoParser.parsePES(s,u,i,!1)),d={data:[],size:0}),d&&(d.data.push(t.subarray(S,b+la)),d.size+=b+la-S);break;case p:if(T){if(f&&(i=ma(f,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,i);break;case"mp3":this.parseMPEGPES(o,i);break;case"ac3":this.parseAC3PES(o,i)}f={data:[],size:0}}f&&(f.data.push(t.subarray(S,b+la)),f.size+=b+la-S);break;case h:T&&(m&&(i=ma(m,this.logger))&&this.parseID3PES(l,i),m={data:[],size:0}),m&&(m.data.push(t.subarray(S,b+la)),m.size+=b+la-S);break;case 0:T&&(S+=t[S]+1),v=this._pmtId=da(t,S);break;case v:T&&(S+=t[S]+1);var P=pa(t,S,this.typeSupported,n,this.observer,this.logger);(c=P.videoPid)>0&&(s.pid=c,s.segmentCodec=P.segmentVideoCodec),(p=P.audioPid)>0&&(o.pid=p,o.segmentCodec=P.segmentAudioCodec),(h=P.id3Pid)>0&&(l.pid=h),null===g||y||(this.logger.warn("MPEG-TS PMT found at "+b+" after unknown PID '"+g+"'. Backtracking to sync byte @"+k+" to parse all TS packets."),g=null,b=k-188),y=this.pmtParsed=!0;break;case 17:case 8191:break;default:g=A}}else E++;E>0&&ha(this.observer,new Error("Found "+E+" TS packet/s that do not start with 0x47"),void 0,this.logger),s.pesData=d,o.pesData=f,l.pesData=m;var C={audioTrack:o,videoTrack:s,id3Track:l,textTrack:u};return a&&this.extractRemainingSamples(C),C},t.flush=function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e},t.extractRemainingSamples=function(e){var t,r=e.audioTrack,n=e.videoTrack,a=e.id3Track,i=e.textTrack,s=n.pesData,o=r.pesData,l=a.pesData;if(s&&(t=ma(s,this.logger))?(this.readyVideoParser(n.segmentCodec),null!==this.videoParser&&(this.videoParser.parsePES(n,i,t,!0),n.pesData=null)):n.pesData=s,o&&(t=ma(o,this.logger))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,t);break;case"mp3":this.parseMPEGPES(r,t);break;case"ac3":this.parseAC3PES(r,t)}r.pesData=null}else null!=o&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=o;l&&(t=ma(l,this.logger))?(this.parseID3PES(a,t),a.pesData=null):a.pesData=l},t.demuxSampleAes=function(e,t,r){var n=this.demux(e,r,!0,!this.config.progressive),a=this.sampleAes=new na(this.observer,this.config,t);return this.decrypt(n,a)},t.readyVideoParser=function(e){null===this.videoParser&&("avc"===e?this.videoParser=new sa:"hevc"===e&&(this.videoParser=new oa))},t.decrypt=function(e,t){return new Promise((function(r){var n=e.audioTrack,a=e.videoTrack;n.samples&&"aac"===n.segmentCodec?t.decryptAacSamples(n.samples,0,(function(){a.samples?t.decryptAvcSamples(a.samples,0,0,(function(){r(e)})):r(e)})):a.samples&&t.decryptAvcSamples(a.samples,0,0,(function(){r(e)}))}))},t.destroy=function(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0},t.parseAACPES=function(e,t){var r,n,a,i=0,s=this.aacOverFlow,o=t.data;if(s){this.aacOverFlow=null;var l=s.missing,u=s.sample.unit.byteLength;if(-1===l)o=Ee(s.sample.unit,o);else{var c=u-l;s.sample.unit.set(o.subarray(0,l),c),e.samples.push(s.sample),i=s.missing}}for(r=i,n=o.length;r<n-1&&!kn(o,r);r++);if(r!==i){var d,p=r<n-1;if(d=p?"AAC PES did not start with ADTS header,offset:"+r:"No ADTS header found in AAC PES",ha(this.observer,new Error(d),p,this.logger),!p)return}if(bn(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!s)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var h=Tn(e.samplerate);a=s.sample.pts+h}for(var f,m=0;r<n;){if(r+=(f=An(e,o,r,a,m)).length,f.missing){this.aacOverFlow=f;break}for(m++;r<n-1&&!kn(o,r);r++);}},t.parseMPEGPES=function(e,t){var r=t.data,n=r.length,a=0,i=0,s=t.pts;if(void 0!==s)for(;i<n;)if(zn(r,i)){var o=Kn(e,r,i,s,a);if(!o)break;i+=o.length,a++}else i++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},t.parseAC3PES=function(e,t){var r=t.data,n=t.pts;if(void 0!==n)for(var a,i=r.length,s=0,o=0;o<i&&(a=Qn(e,r,o,n,s++))>0;)o+=a;else this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS")},t.parseID3PES=function(e,t){if(void 0!==t.pts){var r=i({},t,{type:this._videoTrack?Ln.emsg:Ln.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}else this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},e}();function ca(e,t){return((31&e[t+1])<<8)+e[t+2]}function da(e,t){return(31&e[t+10])<<8|e[t+11]}function pa(e,t,r,n,a,i){var s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<o;){var l=ca(e,t),u=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!n){fa("ADTS AAC",i);break}case 15:-1===s.audioPid&&(s.audioPid=l);break;case 21:-1===s.id3Pid&&(s.id3Pid=l);break;case 219:if(!n){fa("H.264",i);break}case 27:-1===s.videoPid&&(s.videoPid=l);break;case 3:case 4:r.mpeg||r.mp3?-1===s.audioPid&&(s.audioPid=l,s.segmentAudioCodec="mp3"):i.log("MPEG audio found, not supported in this browser");break;case 193:if(!n){fa("AC-3",i);break}case 129:r.ac3?-1===s.audioPid&&(s.audioPid=l,s.segmentAudioCodec="ac3"):i.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===s.audioPid&&u>0)for(var c=t+5,d=u;d>2;){106===e[c]&&(!0!==r.ac3?i.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=l,s.segmentAudioCodec="ac3"));var p=e[c+1]+2;c+=p,d-=p}break;case 194:case 135:return ha(a,new Error("Unsupported EC-3 in M2TS found"),void 0,i),s;case 36:-1===s.videoPid&&(s.videoPid=l,s.segmentVideoCodec="hevc",i.log("HEVC in M2TS found"))}t+=u+5}return s}function ha(e,t,r,n){n.warn("parsing error: "+t.message),e.emit(P.ERROR,P.ERROR,{type:A.MEDIA_ERROR,details:S.FRAG_PARSING_ERROR,fatal:!1,levelRetry:r,error:t,reason:t.message})}function fa(e,t){t.log(e+" with AES-128-CBC encryption found in unencrypted stream")}function ma(e,t){var r,n,a,i,s,o=0,l=e.data;if(!e||0===e.size)return null;for(;l[0].length<19&&l.length>1;)l[0]=Ee(l[0],l[1]),l.splice(1,1);if(1===((r=l[0])[0]<<16)+(r[1]<<8)+r[2]){if((n=(r[4]<<8)+r[5])&&n>e.size-6)return null;var u=r[7];192&u&&(i=536870912*(14&r[9])+4194304*(255&r[10])+16384*(254&r[11])+128*(255&r[12])+(254&r[13])/2,64&u?i-(s=536870912*(14&r[14])+4194304*(255&r[15])+16384*(254&r[16])+128*(255&r[17])+(254&r[18])/2)>54e5&&(t.warn(Math.round((i-s)/9e4)+"s delta between PTS and DTS, align them"),i=s):s=i);var c=(a=r[8])+9;if(e.size<=c)return null;e.size-=c;for(var d=new Uint8Array(e.size),p=0,h=l.length;p<h;p++){var f=(r=l[p]).byteLength;if(c){if(c>f){c-=f;continue}r=r.subarray(c),f-=c,c=0}d.set(r,o),o+=f}return n&&(n-=a+3),{data:d,pts:i,dts:s,len:n}}return null}var ga=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},e}(),ya=Math.pow(2,32)-1,va=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=i,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,l,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))},e.box=function(e){for(var t=8,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];for(var i=n.length,s=i;i--;)t+=n[i].byteLength;var o=new Uint8Array(t);for(o[0]=t>>24&255,o[1]=t>>16&255,o[2]=t>>8&255,o[3]=255&t,o.set(e,4),i=0,t=8;i<s;i++)o.set(n[i],t),t+=n[i].byteLength;return o},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var n=Math.floor(r/(ya+1)),a=Math.floor(r%(ya+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale||0,t.duration||0),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))},e.moov=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale||0,t[0].duration||0)].concat(n).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))},e.mvhd=function(t,r){r*=t;var n=Math.floor(r/(ya+1)),a=Math.floor(r%(ya+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,i)},e.sdtp=function(t){var r,n,a=t.samples||[],i=new Uint8Array(4+a.length);for(r=0;r<a.length;r++)n=a[r].flags,i[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,i)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,n,a,i=[],s=[];for(r=0;r<t.sps.length;r++)a=(n=t.sps[r]).byteLength,i.push(a>>>8&255),i.push(255&a),i=i.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)a=(n=t.pps[r]).byteLength,s.push(a>>>8&255),s.push(255&a),s=s.concat(Array.prototype.slice.call(n));var o=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(s))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2].concat(t,[6,1,2]))},e.audioStsd=function(e){var t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])},e.mp4a=function(t){return e.box(e.types.mp4a,e.audioStsd(t),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){return e.box(e.types[".mp3"],e.audioStsd(t))},e.ac3=function(t){return e.box(e.types["ac-3"],e.audioStsd(t),e.box(e.types.dac3,t.config))},e.stsd=function(t){var r=t.segmentCodec;if("audio"===t.type){if("aac"===r)return e.box(e.types.stsd,e.STSD,e.mp4a(t));if("ac3"===r&&t.config)return e.box(e.types.stsd,e.STSD,e.ac3(t));if("mp3"===r&&"mp3"===t.codec)return e.box(e.types.stsd,e.STSD,e.mp3(t))}else{if(!t.pps||!t.sps)throw new Error("video track missing pps or sps");if("avc"===r)return e.box(e.types.stsd,e.STSD,e.avc1(t));if("hevc"===r&&t.vps)return e.box(e.types.stsd,e.STSD,e.hvc1(t))}throw new Error("unsupported "+t.type+" segment codec ("+r+"/"+t.codec+")")},e.tkhd=function(t){var r=t.id,n=(t.duration||0)*(t.timescale||0),a=t.width||0,i=t.height||0,s=Math.floor(n/(ya+1)),o=Math.floor(n%(ya+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,i>>8&255,255&i,0,0]))},e.traf=function(t,r){var n=e.sdtp(t),a=t.id,i=Math.floor(r/(ya+1)),s=Math.floor(r%(ya+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,n.length+16+20+8+16+8+8),n)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var n,a,i,s,o,l,u=t.samples||[],c=u.length,d=12+16*c,p=new Uint8Array(d);for(r+=8+d,p.set(["video"===t.type?1:0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)i=(a=u[n]).duration,s=a.size,o=a.flags,l=a.cts,p.set([i>>>24&255,i>>>16&255,i>>>8&255,255&i,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,p)},e.initSegment=function(t){e.types||e.init();var r=e.moov(t);return Ee(e.FTYP,r)},e.hvc1=function(t){for(var r=t.params,n=[t.vps,t.sps,t.pps],a=new Uint8Array([1,r.general_profile_space<<6|(r.general_tier_flag?32:0)|r.general_profile_idc,r.general_profile_compatibility_flags[0],r.general_profile_compatibility_flags[1],r.general_profile_compatibility_flags[2],r.general_profile_compatibility_flags[3],r.general_constraint_indicator_flags[0],r.general_constraint_indicator_flags[1],r.general_constraint_indicator_flags[2],r.general_constraint_indicator_flags[3],r.general_constraint_indicator_flags[4],r.general_constraint_indicator_flags[5],r.general_level_idc,240|r.min_spatial_segmentation_idc>>8,255&r.min_spatial_segmentation_idc,252|r.parallelismType,252|r.chroma_format_idc,248|r.bit_depth_luma_minus8,248|r.bit_depth_chroma_minus8,0,parseInt(r.frame_rate.fps),3|r.temporal_id_nested<<2|r.num_temporal_layers<<3|(r.frame_rate.fixed?64:0),n.length]),i=a.length,s=0;s<n.length;s+=1){i+=3;for(var o=0;o<n[s].length;o+=1)i+=2+n[s][o].length}var l=new Uint8Array(i);l.set(a,0),i=a.length;for(var u=n.length-1,c=0;c<n.length;c+=1){l.set(new Uint8Array([32+c|(c===u?128:0),0,n[c].length]),i),i+=3;for(var d=0;d<n[c].length;d+=1)l.set(new Uint8Array([n[c][d].length>>8,255&n[c][d].length]),i),i+=2,l.set(n[c][d],i),i+=n[c][d].length}var p=e.box(e.types.hvcC,l),h=t.width,f=t.height,m=t.pixelRatio[0],g=t.pixelRatio[1];return e.box(e.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,255&h,f>>8&255,255&f,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),p,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,255&m,g>>24,g>>16&255,g>>8&255,255&g])))},e}();va.types=void 0,va.HDLR_TYPES=void 0,va.STTS=void 0,va.STSC=void 0,va.STCO=void 0,va.STSZ=void 0,va.VMHD=void 0,va.SMHD=void 0,va.STSD=void 0,va.FTYP=void 0,va.DINF=void 0;function _a(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);var a=e*t*r;return n?Math.round(a):a}function ka(e,t){return _a(e,1e3,1/9e4,t)}var Ea=null,ba=null;function Ta(e,t,r,n){return{duration:t,size:r,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}var Aa=function(e){function t(t,r,n,a){var i;if((i=e.call(this,"mp4-remuxer",a)||this).observer=void 0,i.config=void 0,i.typeSupported=void 0,i.ISGenerated=!1,i._initPTS=null,i._initDTS=null,i.nextVideoTs=null,i.nextAudioTs=null,i.videoSampleDuration=null,i.isAudioContiguous=!1,i.isVideoContiguous=!1,i.videoTrackConfig=void 0,i.observer=t,i.config=r,i.typeSupported=n,i.ISGenerated=!1,null===Ea){var s=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ea=s?parseInt(s[1]):0}if(null===ba){var o=navigator.userAgent.match(/Safari\/(\d+)/i);ba=o?parseInt(o[1]):0}return i}o(t,e);var r=t.prototype;return r.destroy=function(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null},r.resetTimeStamp=function(e){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=e},r.resetNextTimestamp=function(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},r.resetInitSegment=function(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0},r.getVideoStartPts=function(e){var t=!1,r=e[0].pts,n=e.reduce((function(e,n){var a=n.pts,i=a-e;return i<-4294967296&&(t=!0,i=(a=Sa(a,r))-e),i>0?e:a}),r);return t&&this.debug("PTS rollover detected"),n},r.remux=function(e,t,r,n,a,i,s,o){var l,u,c,d,p,h,f=a,m=a,g=e.pid>-1,y=t.pid>-1,v=t.samples.length,_=e.samples.length>0,k=s&&v>0||v>1;if((!g||_)&&(!y||k)||this.ISGenerated||s){if(this.ISGenerated){var E,b,T,A,S=this.videoTrackConfig;(S&&(t.width!==S.width||t.height!==S.height||(null==(E=t.pixelRatio)?void 0:E[0])!==(null==(b=S.pixelRatio)?void 0:b[0])||(null==(T=t.pixelRatio)?void 0:T[1])!==(null==(A=S.pixelRatio)?void 0:A[1]))||!S&&k||null===this.nextAudioTs&&_)&&this.resetInitSegment()}this.ISGenerated||(c=this.generateIS(e,t,a,i));var P,C=this.isVideoContiguous,x=-1;if(k&&(x=function(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!C&&this.config.forceKeyFrameOnDiscontinuity))if(h=!0,x>0){this.warn("Dropped "+x+" out of "+v+" video samples due to a missing keyframe");var I=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(x),t.dropped+=x,P=m+=(t.samples[0].pts-I)/t.inputTimeScale}else-1===x&&(this.warn("No keyframe found out of "+v+" video samples"),h=!1);if(this.ISGenerated){if(_&&k){var w=this.getVideoStartPts(t.samples),R=(Sa(e.samples[0].pts,w)-w)/t.inputTimeScale;f+=Math.max(0,R),m+=Math.max(0,-R)}if(_){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),c=this.generateIS(e,t,a,i)),u=this.remuxAudio(e,f,this.isAudioContiguous,i,y||k||o===M?m:void 0),k){var D=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),c=this.generateIS(e,t,a,i)),l=this.remuxVideo(t,m,C,D)}}else k&&(l=this.remuxVideo(t,m,C,0));l&&(l.firstKeyFrame=x,l.independent=-1!==x,l.firstKeyFramePTS=P)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(p=Pa(r,a,this._initPTS,this._initDTS)),n.samples.length&&(d=Ca(n,a,this._initPTS))),{audio:u,video:l,initSegment:c,independent:h,text:d,id3:p}},r.generateIS=function(e,t,r,n){var a,i,s,o=e.samples,l=t.samples,u=this.typeSupported,c={},d=this._initPTS,p=!d||n,h="audio/mp4",f=-1;if(p&&(a=i=1/0),e.config&&o.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(h="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}c.audio={id:"audio",container:h,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&u.mpeg?new Uint8Array(0):va.initSegment([e]),metadata:{channelCount:e.channelCount}},p&&(f=e.id,s=e.inputTimeScale,d&&s===d.timescale?p=!1:a=i=o[0].pts-Math.round(s*r))}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,c.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:va.initSegment([t]),metadata:{width:t.width,height:t.height}},p)if(f=t.id,s=t.inputTimeScale,d&&s===d.timescale)p=!1;else{var m=this.getVideoStartPts(l),g=Math.round(s*r);i=Math.min(i,Sa(l[0].dts,m)-g),a=Math.min(a,m-g)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(c).length)return this.ISGenerated=!0,p?(d&&this.warn("Timestamps at playlist time: "+(n?"":"~")+r+" "+a/s+" != initPTS: "+d.baseTime/d.timescale+" ("+d.baseTime+"/"+d.timescale+") trackId: "+d.trackId),this.log("Found initPTS at playlist time: "+r+" offset: "+a/s+" ("+a+"/"+s+") trackId: "+f),this._initPTS={baseTime:a,timescale:s,trackId:f},this._initDTS={baseTime:i,timescale:s,trackId:f}):a=s=void 0,{tracks:c,initPTS:a,timescale:s,trackId:f}},r.remuxVideo=function(e,t,r,n){var a,s,o=e.inputTimeScale,l=e.samples,u=[],c=l.length,d=this._initPTS,p=d.baseTime*o/d.timescale,h=this.nextVideoTs,f=8,m=this.videoSampleDuration,g=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,v=!1;if(!r||null===h){var _=p+t*o,k=l[0].pts-Sa(l[0].dts,l[0].pts);Ea&&null!==h&&Math.abs(_-k-(h+p))<15e3?r=!0:h=_-k-p}for(var E=h+p,b=0;b<c;b++){var T=l[b];T.pts=Sa(T.pts,E),T.dts=Sa(T.dts,E),T.dts<l[b>0?b-1:b].dts&&(v=!0)}v&&l.sort((function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n})),a=l[0].dts;var C=l[l.length-1].dts-a,x=C?Math.round(C/(c-1)):m||e.inputTimeScale/30;if(r){var I=a-E,w=I>x,R=I<-1;if((w||R)&&(w?this.warn((e.segmentCodec||"").toUpperCase()+": "+ka(I,!0)+" ms ("+I+"dts) hole between fragments detected at "+t.toFixed(3)):this.warn((e.segmentCodec||"").toUpperCase()+": "+ka(-I,!0)+" ms ("+I+"dts) overlapping between fragments detected at "+t.toFixed(3)),!R||E>=l[0].pts||Ea)){a=E;var M=l[0].pts-I;if(w)l[0].dts=a,l[0].pts=M;else for(var D=!0,O=0;O<l.length&&!(l[O].dts>M&&D);O++){var L=l[O].pts;if(l[O].dts-=I,l[O].pts-=I,O<l.length-1){var N=l[O+1].pts;D=N<=l[O].pts==N<=L}}this.log("Video: Initial PTS/DTS adjusted: "+ka(M,!0)+"/"+ka(a,!0)+", delta: "+ka(I,!0)+" ms")}}for(var U=0,j=0,B=a=Math.max(0,a),F=0;F<c;F++){for(var V=l[F],G=V.units,H=G.length,K=0,W=0;W<H;W++)K+=G[W].data.length;j+=K,U+=H,V.length=K,V.dts<B?(V.dts=B,B+=x/4|0||1):B=V.dts,g=Math.min(V.pts,g),y=Math.max(V.pts,y)}s=l[c-1].dts;var $,z=j+4*U+8;try{$=new Uint8Array(z)}catch(e){return void this.observer.emit(P.ERROR,P.ERROR,{type:A.MUX_ERROR,details:S.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:z,reason:"fail allocating video mdat "+z})}var q=new DataView($.buffer);q.setUint32(0,z),$.set(va.types.mdat,4);for(var Y=!1,X=Number.POSITIVE_INFINITY,Z=Number.POSITIVE_INFINITY,Q=Number.NEGATIVE_INFINITY,J=Number.NEGATIVE_INFINITY,ee=0;ee<c;ee++){for(var te=l[ee],re=te.units,ne=0,ae=0,ie=re.length;ae<ie;ae++){var se=re[ae],oe=se.data,le=se.data.byteLength;q.setUint32(f,le),f+=4,$.set(oe,f),f+=le,ne+=4+le}var ue=void 0;if(ee<c-1)m=l[ee+1].dts-te.dts,ue=l[ee+1].pts-te.pts;else{var ce=this.config,de=ee>0?te.dts-l[ee-1].dts:x;if(ue=ee>0?te.pts-l[ee-1].pts:x,ce.stretchShortVideoTrack&&null!==this.nextAudioTs){var pe=Math.floor(ce.maxBufferHole*o),he=(n?g+n*o:this.nextAudioTs+p)-te.pts;he>pe?((m=he-de)<0?m=de:Y=!0,this.log("It is approximately "+he/90+" ms to the next segment; using duration "+m/90+" ms for the last video frame.")):m=de}else m=de}var fe=Math.round(te.pts-te.dts);X=Math.min(X,m),Q=Math.max(Q,m),Z=Math.min(Z,ue),J=Math.max(J,ue),u.push(Ta(te.key,m,ne,fe))}if(u.length)if(Ea){if(Ea<70){var me=u[0].flags;me.dependsOn=2,me.isNonSync=0}}else if(ba&&J-Z<Q-X&&x/Q<.025&&0===u[0].cts){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var ge=a,ye=0,ve=u.length;ye<ve;ye++){var _e=ge+u[ye].duration,ke=ge+u[ye].cts;if(ye<ve-1){var Ee=_e+u[ye+1].cts;u[ye].duration=Ee-ke}else u[ye].duration=ye?u[ye-1].duration:x;u[ye].cts=0,ge=_e}}var be=s+(m=Y||!m?x:m);this.nextVideoTs=h=be-p,this.videoSampleDuration=m,this.isVideoContiguous=!0;var Te={data1:va.moof(e.sequenceNumber++,a,i(e,{samples:u})),data2:$,startPTS:(g-p)/o,endPTS:(y+m-p)/o,startDTS:(a-p)/o,endDTS:h/o,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,Te},r.getSamplesPerFrame=function(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}},r.remuxAudio=function(e,t,r,n,a){var s=e.inputTimeScale,o=s/(e.samplerate?e.samplerate:s),l=this.getSamplesPerFrame(e),u=l*o,c=this._initPTS,d="mp3"===e.segmentCodec&&this.typeSupported.mpeg,p=[],h=void 0!==a,f=e.samples,m=d?0:8,g=this.nextAudioTs||-1,y=c.baseTime*s/c.timescale,v=y+t*s;if(this.isAudioContiguous=r=r||f.length&&g>0&&(n&&Math.abs(v-(g+y))<9e3||Math.abs(Sa(f[0].pts,v)-(g+y))<20*u),f.forEach((function(e){e.pts=Sa(e.pts,v)})),!r||g<0){if(f=f.filter((function(e){return e.pts>=0})),!f.length)return;g=0===a?0:n&&!h?Math.max(0,v-y):f[0].pts-y}if("aac"===e.segmentCodec)for(var _=this.config.maxAudioFramesDrift,k=0,E=g+y;k<f.length;k++){var b=f[k],T=b.pts,C=T-E,x=Math.abs(1e3*C/s);if(C<=-_*u&&h)0===k&&(this.warn("Audio frame @ "+(T/s).toFixed(3)+"s overlaps marker by "+Math.round(1e3*C/s)+" ms."),this.nextAudioTs=g=T-y,E=T);else if(C>=_*u&&x<1e4&&h){var I=Math.round(C/u);for(E=T-I*u;E<0&&I&&u;)I--,E+=u;0===k&&(this.nextAudioTs=g=E-y),this.warn("Injecting "+I+" audio frames @ "+((E-y)/s).toFixed(3)+"s due to "+Math.round(1e3*C/s)+" ms gap.");for(var w=0;w<I;w++){var R=ga.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);R||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),R=b.unit.subarray()),f.splice(k,0,{unit:R,pts:E}),E+=u,k++}}b.pts=E,E+=u}for(var M,D=null,O=null,L=0,N=f.length;N--;)L+=f[N].unit.byteLength;for(var U=0,j=f.length;U<j;U++){var B=f[U],F=B.unit,V=B.pts;if(null!==O)p[U-1].duration=Math.round((V-O)/o);else{if(r&&"aac"===e.segmentCodec&&(V=g+y),D=V,!(L>0))return;L+=m;try{M=new Uint8Array(L)}catch(e){return void this.observer.emit(P.ERROR,P.ERROR,{type:A.MUX_ERROR,details:S.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:L,reason:"fail allocating audio mdat "+L})}d||(new DataView(M.buffer).setUint32(0,L),M.set(va.types.mdat,4))}M.set(F,m);var G=F.byteLength;m+=G,p.push(Ta(!0,l,G,0)),O=V}var H=p.length;if(H){var K=p[p.length-1];g=O-y,this.nextAudioTs=g+o*K.duration;var W=d?new Uint8Array(0):va.moof(e.sequenceNumber++,D/o,i({},e,{samples:p}));e.samples=[];var $=(D-y)/s,z=g/s,q={data1:W,data2:M,startPTS:$,endPTS:z,startDTS:$,endDTS:z,type:"audio",hasAudio:!0,hasVideo:!1,nb:H};return this.isAudioContiguous=!0,q}},t}(N);function Sa(e,t){var r;if(null===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}function Pa(e,t,r,n){var a=e.samples.length;if(a){for(var i=e.inputTimeScale,s=0;s<a;s++){var o=e.samples[s];o.pts=Sa(o.pts-r.baseTime*i/r.timescale,t*i)/i,o.dts=Sa(o.dts-n.baseTime*i/n.timescale,t*i)/i}var l=e.samples;return e.samples=[],{samples:l}}}function Ca(e,t,r){var n=e.samples.length;if(n){for(var a=e.inputTimeScale,i=0;i<n;i++){var s=e.samples[i];s.pts=Sa(s.pts-r.baseTime*a/r.timescale,t*a)/a}e.samples.sort((function(e,t){return e.pts-t.pts}));var o=e.samples;return e.samples=[],{samples:o}}}var xa,Ia=function(e){function t(t,r,n,a){var i;return(i=e.call(this,"passthrough-remuxer",a)||this).emitInitSegment=!1,i.audioCodec=void 0,i.videoCodec=void 0,i.initData=void 0,i.initPTS=null,i.initTracks=void 0,i.lastEndTime=null,i.isVideoContiguous=!1,i}o(t,e);var r=t.prototype;return r.destroy=function(){},r.resetTimeStamp=function(e){this.lastEndTime=null;var t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)},r.resetNextTimestamp=function(){this.isVideoContiguous=!1,this.lastEndTime=null},r.resetInitSegment=function(e,t,r,n){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(e,n),this.emitInitSegment=!0},r.generateInitSegment=function(e,t){var r=this.audioCodec,n=this.videoCodec;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var a=this.initData=fe(e),i=a.audio,s=a.video;if(t)!function(e,t){if(e&&t){var r=t.keyId;r&&t.isCommonEncryption&&pe(e,["moov","trak"]).forEach((function(e){var t=pe(e,["mdia","minf","stbl","stsd"])[0].subarray(8),n=pe(t,["enca"]),a=n.length>0;a||(n=pe(t,["encv"])),n.forEach((function(e){pe(a?e.subarray(28):e.subarray(78),["sinf"]).forEach((function(e){var t=ke(e);if(t){var n=t.subarray(8,24);n.some((function(e){return 0!==e}))||(H.log("[eme] Patching keyId in 'enc"+(a?"a":"v")+">sinf>>tenc' box: "+z(n)+" -> "+z(r)),t.set(r,8))}}))}))}))}}(e,t);else{var o=i||s;null!=o&&o.encrypted&&this.warn('Init segment with encrypted track with has no key ("'+o.codec+'")!')}i&&(r=Ra(i,X,this)),s&&(n=Ra(s,Z,this));var l={};i&&s?l.audiovideo={container:"video/mp4",codec:r+","+n,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:e,id:"main"}:i?l.audio={container:"audio/mp4",codec:r,encrypted:i.encrypted,initSegment:e,id:"audio"}:s?l.video={container:"video/mp4",codec:n,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=l},r.remux=function(e,t,r,n,a,i){var s,o,l=this.initPTS,u=this.lastEndTime,c={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};E(u)||(u=this.lastEndTime=a||0);var d=t.samples;if(!d.length)return c;var p={initPTS:void 0,timescale:void 0,trackId:void 0},h=this.initData;if(null!=(s=h)&&s.length||(this.generateInitSegment(d),h=this.initData),null==(o=h)||!o.length)return this.warn("Failed to generate initSegment."),c;this.emitInitSegment&&(p.tracks=this.initTracks,this.emitInitSegment=!1);var f=function(e,t,r){for(var n={},a=pe(e,["moof","traf"]),i=0;i<a.length;i++){var s=a[i],o=pe(s,["tfhd"])[0],l=ue(o,4),u=t[l];if(u){n[l]||(n[l]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type});var c=n[l],d=pe(s,["tfdt"])[0];if(d){var p=d[0],h=ue(d,4);1===p&&(h===ae?r.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(h*=ae+1,h+=ue(d,8))),E(h)&&(!E(c.start)||h<c.start)&&(c.start=h)}var f=u.default,m=ue(o,0)|(null==f?void 0:f.flags),g=(null==f?void 0:f.duration)||0;8&m&&(g=ue(o,2&m?12:8));for(var y=pe(s,["trun"]),v=c.start||0,_=0,k=g,b=0;b<y.length;b++){var T=y[b],A=ue(T,4),S=c.sampleCount;c.sampleCount+=A;var P=1&T[3],C=4&T[3],x=1&T[2],I=2&T[2],w=4&T[2],R=8&T[2],M=8,D=A;for(P&&(M+=4),C&&A&&(1&T[M+1]||void 0!==c.keyFrameIndex||(c.keyFrameIndex=S),M+=4,x?(k=ue(T,M),M+=4):k=g,I&&(M+=4),R&&(M+=4),v+=k,_+=k,D--);D--;)x?(k=ue(T,M),M+=4):k=g,I&&(M+=4),w&&(1&T[M+1]||void 0===c.keyFrameIndex&&(c.keyFrameIndex=c.sampleCount-(D+1),c.keyFrameStart=v),M+=4),R&&(M+=4),v+=k,_+=k;!_&&g&&(_+=g*A)}c.duration+=_}}if(!Object.keys(n).some((function(e){return n[e].duration}))){for(var O=1/0,L=0,N=pe(e,["sidx"]),U=0;U<N.length;U++){var j=he(N[U]);if(null!=j&&j.references){O=Math.min(O,j.earliestPresentationTime/j.timescale);var B=j.references.reduce((function(e,t){return e+t.info.duration||0}),0);L=Math.max(L,B+j.earliestPresentationTime/j.timescale)}}L&&E(L)&&Object.keys(n).forEach((function(e){n[e].duration||(n[e].duration=L*n[e].timescale-n[e].start)}))}return n}(d,h,this),m=h.audio?f[h.audio.id]:null,g=h.video?f[h.video.id]:null,y=wa(g,1/0),v=wa(m,1/0),_=wa(g,0,!0),k=wa(m,0,!0),b=a,T=0,A=m&&(!g||!l&&v<y||l&&l.trackId===h.audio.id),S=A?m:g;if(S){var P=S.timescale,C=S.start-a*P,x=A?h.audio.id:h.video.id;b=S.start/P,T=A?k-v:_-y,!i&&l||!function(e,t,r,n){if(null===e)return!0;var a=Math.max(n,1),i=t-e.baseTime/e.timescale;return Math.abs(i-r)>a}(l,b,a,T)&&P===l.timescale||(l&&this.warn("Timestamps at playlist time: "+(i?"":"~")+a+" "+C/P+" != initPTS: "+l.baseTime/l.timescale+" ("+l.baseTime+"/"+l.timescale+") trackId: "+l.trackId),this.log("Found initPTS at playlist time: "+a+" offset: "+(b-a)+" ("+C+"/"+P+") trackId: "+x),l=null,p.initPTS=C,p.timescale=P,p.trackId=x)}else this.warn("No audio or video samples found for initPTS at playlist time: "+a);l?(p.initPTS=l.baseTime,p.timescale=l.timescale,p.trackId=l.trackId):(p.timescale&&void 0!==p.trackId&&void 0!==p.initPTS||(this.warn("Could not set initPTS"),p.initPTS=b,p.timescale=1,p.trackId=-1),this.initPTS=l={baseTime:p.initPTS,timescale:p.timescale,trackId:p.trackId});var I=b-l.baseTime/l.timescale,w=I+T;T>0?this.lastEndTime=w:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var R=!!h.audio,M=!!h.video,D="";R&&(D+="audio"),M&&(D+="video");var O={data1:d,startPTS:I,startDTS:I,endPTS:w,endDTS:w,type:D,hasAudio:R,hasVideo:M,nb:1,dropped:0,encrypted:!!h.audio&&h.audio.encrypted||!!h.video&&h.video.encrypted};c.audio=R&&!M?O:void 0,c.video=M?O:void 0;var L=null==g?void 0:g.sampleCount;if(L){var N=g.keyFrameIndex,U=-1!==N;O.nb=L,O.dropped=0===N||this.isVideoContiguous?0:U?N:L,O.independent=U,O.firstKeyFrame=N,U&&g.keyFrameStart&&(O.firstKeyFramePTS=(g.keyFrameStart-l.baseTime)/l.timescale),this.isVideoContiguous||(c.independent=U),this.isVideoContiguous||(this.isVideoContiguous=U),O.dropped&&this.warn("fmp4 does not start with IDR: firstIDR "+N+"/"+L+" dropped: "+O.dropped+" start: "+(O.firstKeyFramePTS||"NA"))}return c.initSegment=p,c.id3=Pa(r,a,l,l),n.samples.length&&(c.text=Ca(n,a,l)),c},t}(N);function wa(e,t,r){return void 0===r&&(r=!1),void 0!==(null==e?void 0:e.start)?(e.start+(r?e.duration:0))/e.timescale:t}function Ra(e,t,r){var n=e.codec;return n&&n.length>4?n:t===X?"ec-3"===n||"ac-3"===n||"alac"===n?n:"fLaC"===n||"Opus"===n?je(n,!1):(r.warn('Unhandled audio codec "'+n+'" in mp4 MAP'),n||"mp4a"):(r.warn('Unhandled video codec "'+n+'" in mp4 MAP'),n||"avc1")}try{xa=self.performance.now.bind(self.performance)}catch(e){xa=Date.now}var Ma=[{demux:ta,remux:Ia},{demux:ua,remux:Aa},{demux:Yn,remux:Aa},{demux:Jn,remux:Aa}];Ma.splice(2,0,{demux:Zn,remux:Aa});var Da=function(){function e(e,t,r,n,a,i){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=a,this.logger=i}var t=e.prototype;return t.configure=function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()},t.push=function(e,t,r,n){var a=this,i=r.transmuxing;i.executeStart=xa();var s=new Uint8Array(e),o=this.currentTransmuxState,l=this.transmuxConfig;n&&(this.currentTransmuxState=n);var u=n||o,c=u.contiguous,d=u.discontinuity,p=u.trackSwitch,h=u.accurateTimeOffset,f=u.timeOffset,m=u.initSegmentChange,g=l.audioCodec,y=l.videoCodec,v=l.defaultInitPts,_=l.duration,k=l.initSegmentData,E=function(e,t){var r=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(r=t),r}(s,t);if(E&&or(E.method)){var b=this.getDecrypter(),T=lr(E.method);if(!b.isSync())return this.asyncResult=!0,this.decryptionPromise=b.webCryptoDecrypt(s,E.key.buffer,E.iv.buffer,T).then((function(e){var t=a.push(e,null,r);return a.decryptionPromise=null,t})),this.decryptionPromise;var C=b.softwareDecrypt(s,E.key.buffer,E.iv.buffer,T);if(r.part>-1){var x=b.flush();C=x?x.buffer:x}if(!C)return i.executeEnd=xa(),Oa(r);s=new Uint8Array(C)}var I=this.needsProbing(d,p);if(I){var w=this.configureTransmuxer(s);if(w)return this.logger.warn("[transmuxer] "+w.message),this.observer.emit(P.ERROR,P.ERROR,{type:A.MEDIA_ERROR,details:S.FRAG_PARSING_ERROR,fatal:!1,error:w,reason:w.message}),i.executeEnd=xa(),Oa(r)}(d||p||m||I)&&this.resetInitSegment(k,g,y,_,t),(d||m||I)&&this.resetInitialTimestamp(v),c||this.resetContiguity();var R=this.transmux(s,E,f,h,r);this.asyncResult=La(R);var M=this.currentTransmuxState;return M.contiguous=!0,M.discontinuity=!1,M.trackSwitch=!1,i.executeEnd=xa(),R},t.flush=function(e){var t=this,r=e.transmuxing;r.executeStart=xa();var n=this.decrypter,a=this.currentTransmuxState,i=this.decryptionPromise;if(i)return this.asyncResult=!0,i.then((function(){return t.flush(e)}));var s=[],o=a.timeOffset;if(n){var l=n.flush();l&&s.push(this.push(l.buffer,null,e))}var u=this.demuxer,c=this.remuxer;if(!u||!c){r.executeEnd=xa();var d=[Oa(e)];return this.asyncResult?Promise.resolve(d):d}var p=u.flush(o);return La(p)?(this.asyncResult=!0,p.then((function(r){return t.flushRemux(s,r,e),s}))):(this.flushRemux(s,p,e),this.asyncResult?Promise.resolve(s):s)},t.flushRemux=function(e,t,r){var n=t.audioTrack,a=t.videoTrack,i=t.id3Track,s=t.textTrack,o=this.currentTransmuxState,l=o.accurateTimeOffset,u=o.timeOffset;this.logger.log("[transmuxer.ts]: Flushed "+this.id+" sn: "+r.sn+(r.part>-1?" part: "+r.part:"")+" of "+(this.id===R?"level":"track")+" "+r.level);var c=this.remuxer.remux(n,a,i,s,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:r}),r.transmuxing.executeEnd=xa()},t.resetInitialTimestamp=function(e){var t=this.demuxer,r=this.remuxer;t&&r&&(t.resetTimeStamp(e),r.resetTimeStamp(e))},t.resetContiguity=function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())},t.resetInitSegment=function(e,t,r,n,a){var i=this.demuxer,s=this.remuxer;i&&s&&(i.resetInitSegment(e,t,r,n),s.resetInitSegment(e,t,r,a))},t.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},t.transmux=function(e,t,r,n,a){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,r,n,a):this.transmuxUnencrypted(e,r,n,a)},t.transmuxUnencrypted=function(e,t,r,n){var a=this.demuxer.demux(e,t,!1,!this.config.progressive),i=a.audioTrack,s=a.videoTrack,o=a.id3Track,l=a.textTrack;return{remuxResult:this.remuxer.remux(i,s,o,l,t,r,!1,this.id),chunkMeta:n}},t.transmuxSampleAes=function(e,t,r,n,a){var i=this;return this.demuxer.demuxSampleAes(e,t,r).then((function(e){return{remuxResult:i.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,r,n,!1,i.id),chunkMeta:a}}))},t.configureTransmuxer=function(e){for(var t,r=this.config,n=this.observer,a=this.typeSupported,i=0,s=Ma.length;i<s;i++){var o;if(null!=(o=Ma[i].demux)&&o.probe(e,this.logger)){t=Ma[i];break}}if(!t)return new Error("Failed to find demuxer by probing fragment data");var l=this.demuxer,u=this.remuxer,c=t.remux,d=t.demux;u&&u instanceof c||(this.remuxer=new c(n,r,a,this.logger)),l&&l instanceof d||(this.demuxer=new d(n,r,a,this.logger),this.probe=d.probe)},t.needsProbing=function(e,t){return!this.demuxer||!this.remuxer||e||t},t.getDecrypter=function(){var e=this.decrypter;return e||(e=this.decrypter=new jt(this.config)),e},e}(),Oa=function(e){return{remuxResult:{},chunkMeta:e}};function La(e){return"then"in e&&e.then instanceof Function}var Na=function(e,t,r,n,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=n,this.defaultInitPts=a||null},Ua=function(e,t,r,n,a,i){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=a,this.initSegmentChange=i},ja=[];function Ba(e,t,r){if(!((n=t.remuxResult).audio||n.video||n.text||n.id3||n.initSegment))return!1;var n,a=[],i=t.remuxResult,s=i.audio,o=i.video;return s&&Fa(a,s),o&&Fa(a,o),e.postMessage({event:"transmuxComplete",data:t,instanceNo:r},a),!0}function Fa(e,t){t.data1&&e.push(t.data1.buffer),t.data2&&e.push(t.data2.buffer)}function Va(e,t,r,n){t.reduce((function(t,r){return Ba(e,r,n)||t}),!1)||e.postMessage({event:"transmuxComplete",data:t[0],instanceNo:n}),e.postMessage({event:"flush",data:r,instanceNo:n})}function Ga(e,t,r){self.postMessage({event:e,data:t,instanceNo:r})}void 0!==t&&t&&self.addEventListener("message",(function(e){var t=e.data,r=t.instanceNo;if(void 0!==r){var n=ja[r];if("reset"===t.cmd&&(delete ja[t.resetNo],n&&n.destroy(),t.cmd="init"),"init"===t.cmd){var a=JSON.parse(t.config),i=new v;i.on(P.FRAG_DECRYPTED,Ga),i.on(P.ERROR,Ga);var s=G(a.debug,t.id);return function(e,t){var r=function(r){e[r]=function(){var e=Array.prototype.join.call(arguments," ");Ga("workerLog",{logType:r,message:e},t)}};for(var n in e)r(n)}(s,r),ja[r]=new Da(i,t.typeSupported,a,"",t.id,s),void Ga("init",null,r)}if(n)switch(t.cmd){case"configure":n.configure(t.config);break;case"demux":var o=n.push(t.data,t.decryptdata,t.chunkMeta,t.state);La(o)?o.then((function(e){Ba(self,e,r)})).catch((function(e){Ga(P.ERROR,{instanceNo:r,type:A.MEDIA_ERROR,details:S.FRAG_PARSING_ERROR,chunkMeta:t.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker push error"},r)})):Ba(self,o,r);break;case"flush":var l=t.chunkMeta,u=n.flush(l);La(u)?u.then((function(e){Va(self,e,l,r)})).catch((function(e){Ga(P.ERROR,{type:A.MEDIA_ERROR,details:S.FRAG_PARSING_ERROR,chunkMeta:t.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker flush error"},r)})):Va(self,u,l,r)}}}));var Ha="1.6.12",Ka={},Wa=0,$a=function(){function t(t,r,n,a){var i=this;this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Wa++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=function(e){var t=e.data,r=i.hls;if(r&&null!=t&&t.event&&t.instanceNo===i.instanceNo)switch(t.event){case"init":var n,a=null==(n=i.workerContext)?void 0:n.objectURL;a&&self.URL.revokeObjectURL(a);break;case"transmuxComplete":i.handleTransmuxComplete(t.data);break;case"flush":i.onFlush(t.data);break;case"workerLog":r.logger[t.data.logType]&&r.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=i.frag,t.data.part=i.part,t.data.id=i.id,r.trigger(t.event,t.data)}},this.onWorkerError=function(e){if(i.hls){var t=new Error(e.message+"  ("+e.filename+":"+e.lineno+")");i.hls.config.enableWorker=!1,i.hls.logger.warn('Error in "'+i.id+'" Web Worker, fallback to inline'),i.hls.trigger(P.ERROR,{type:A.OTHER_ERROR,details:S.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})}};var s=t.config;this.hls=t,this.id=r,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=a;var o=function(e,t){(t=t||{}).frag=i.frag||void 0,e===P.ERROR&&(t.parent=i.id,t.part=i.part,i.error=t.error),i.hls.trigger(e,t)};this.observer=new v,this.observer.on(P.FRAG_DECRYPTED,o),this.observer.on(P.ERROR,o);var l=Ge(s.preferManagedMediaSource);if(this.useWorker&&"undefined"!=typeof Worker){var u=this.hls.logger;s.workerPath;try{s.workerPath?(u.log("loading Web Worker "+s.workerPath+' for "'+r+'"'),this.workerContext=function(e){var t=Ka[e];if(t)return t.clientCount++,t;var r=new self.URL(e,self.location.href).href,n={worker:new self.Worker(r),scriptURL:r,clientCount:1};return Ka[e]=n,n}(s.workerPath)):(u.log('injecting Web Worker for "'+r+'"'),this.workerContext=function(){var t=Ka[Ha];if(t)return t.clientCount++,t;var r=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;("+e.toString()+")(true);"],{type:"text/javascript"}),n=self.URL.createObjectURL(r),a={worker:new self.Worker(n),objectURL:n,clientCount:1};return Ka[Ha]=a,a}());var c=this.workerContext.worker;c.addEventListener("message",this.onWorkerMessage),c.addEventListener("error",this.onWorkerError),c.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:r,config:rt(s)})}catch(e){u.warn('Error setting up "'+r+'" Web Worker, fallback to inline',e),this.terminateWorker(),this.error=null,this.transmuxer=new Da(this.observer,l,s,"",r,t.logger)}}else this.transmuxer=new Da(this.observer,l,s,"",r,t.logger)}var r=t.prototype;return r.reset=function(){if(this.frag=null,this.part=null,this.workerContext){var e=this.instanceNo;this.instanceNo=Wa++;var t=this.hls.config,r=Ge(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:rt(t)})}},r.terminateWorker=function(){if(this.workerContext){var e=this.workerContext.worker;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),function(e){var t=Ka[e||Ha];if(t&&1==t.clientCount--){var r=t.worker,n=t.objectURL;delete Ka[e||Ha],n&&self.URL.revokeObjectURL(n),r.terminate()}}(this.hls.config.workerPath)}},r.destroy=function(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{var e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null},r.push=function(e,t,r,n,a,i,s,o,l,u){var c,d,p=this;l.transmuxing.start=self.performance.now();var h=this.instanceNo,f=this.transmuxer,m=i?i.start:a.start,g=a.decryptdata,y=this.frag,v=!(y&&a.cc===y.cc),_=!(y&&l.level===y.level),k=y?l.sn-y.sn:-1,E=this.part?l.part-this.part.index:-1,b=0===k&&l.id>1&&l.id===(null==y?void 0:y.stats.chunkCount),T=!_&&(1===k||0===k&&(1===E||b&&E<=0)),A=self.performance.now();(_||k||0===a.stats.parsing.start)&&(a.stats.parsing.start=A),!i||!E&&T||(i.stats.parsing.start=A);var S=!(y&&(null==(c=a.initSegment)?void 0:c.url)===(null==(d=y.initSegment)?void 0:d.url)),P=new Ua(v,T,o,_,m,S);if(!T||v||S){this.hls.logger.log("[transmuxer-interface]: Starting new transmux session for "+a.type+" sn: "+l.sn+(l.part>-1?" part: "+l.part:"")+" "+(this.id===R?"level":"track")+": "+l.level+" id: "+l.id+"\n        discontinuity: "+v+"\n        trackSwitch: "+_+"\n        contiguous: "+T+"\n        accurateTimeOffset: "+o+"\n        timeOffset: "+m+"\n        initSegmentChange: "+S);var C=new Na(r,n,t,s,u);this.configureTransmuxer(C)}if(this.frag=a,this.part=i,this.workerContext)this.workerContext.worker.postMessage({instanceNo:h,cmd:"demux",data:e,decryptdata:g,chunkMeta:l,state:P},e instanceof ArrayBuffer?[e]:[]);else if(f){var x=f.push(e,g,l,P);La(x)?x.then((function(e){p.handleTransmuxComplete(e)})).catch((function(e){p.transmuxerError(e,l,"transmuxer-interface push error")})):this.handleTransmuxComplete(x)}},r.flush=function(e){var t=this;e.transmuxing.start=self.performance.now();var r=this.instanceNo,n=this.transmuxer;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:r,cmd:"flush",chunkMeta:e});else if(n){var a=n.flush(e);La(a)?a.then((function(r){t.handleFlushResult(r,e)})).catch((function(r){t.transmuxerError(r,e,"transmuxer-interface flush error")})):this.handleFlushResult(a,e)}},r.transmuxerError=function(e,t,r){this.hls&&(this.error=e,this.hls.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))},r.handleFlushResult=function(e,t){var r=this;e.forEach((function(e){r.handleTransmuxComplete(e)})),this.onFlush(t)},r.configureTransmuxer=function(e){var t=this.instanceNo,r=this.transmuxer;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)},r.handleTransmuxComplete=function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)},t}(),za=function(e){function t(t,r,n){var a;return(a=e.call(this,t,r,n,"audio-stream-controller",M)||this).mainAnchor=null,a.mainFragLoading=null,a.audioOnly=!1,a.bufferedTrack=null,a.switchingTrack=null,a.trackId=-1,a.waitingData=null,a.mainDetails=null,a.flushing=!1,a.bufferFlushed=!1,a.cachedTrackLoadedData=null,a.registerListeners(),a}o(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this.unregisterListeners(),e.prototype.onHandlerDestroying.call(this),this.resetItem()},r.resetItem=function(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null},r.registerListeners=function(){e.prototype.registerListeners.call(this);var t=this.hls;t.on(P.LEVEL_LOADED,this.onLevelLoaded,this),t.on(P.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(P.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(P.BUFFER_RESET,this.onBufferReset,this),t.on(P.BUFFER_CREATED,this.onBufferCreated,this),t.on(P.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(P.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(P.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(P.FRAG_LOADING,this.onFragLoading,this),t.on(P.FRAG_BUFFERED,this.onFragBuffered,this)},r.unregisterListeners=function(){var t=this.hls;t&&(e.prototype.unregisterListeners.call(this),t.off(P.LEVEL_LOADED,this.onLevelLoaded,this),t.off(P.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(P.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(P.BUFFER_RESET,this.onBufferReset,this),t.off(P.BUFFER_CREATED,this.onBufferCreated,this),t.off(P.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(P.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(P.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(P.FRAG_LOADING,this.onFragLoading,this),t.off(P.FRAG_BUFFERED,this.onFragBuffered,this))},r.onInitPtsFound=function(e,t){var r=t.frag,n=t.id,a=t.initPTS,i=t.timescale,s=t.trackId;if(n===R){var o=r.cc,l=this.fragCurrent;if(this.initPTS[o]={baseTime:a,timescale:i,trackId:s},this.log("InitPTS for cc: "+o+" found from main: "+a/i+" ("+a+"/"+i+") trackId: "+s),this.mainAnchor=r,this.state===un.WAITING_INIT_PTS){var u=this.waitingData;(!u&&!this.loadingParts||u&&u.frag.cc!==o)&&this.syncWithAnchor(r,null==u?void 0:u.frag)}else!this.hls.hasEnoughToStart&&l&&l.cc!==o?(l.abortRequests(),this.syncWithAnchor(r,l)):this.state===un.IDLE&&this.tick()}},r.getLoadPosition=function(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:e.prototype.getLoadPosition.call(this)},r.syncWithAnchor=function(e,t){var r,n=(null==(r=this.mainFragLoading)?void 0:r.frag)||null;if(!t||(null==n?void 0:n.cc)!==t.cc){var a=(n||e).cc,i=gt(this.getLevelDetails(),a,this.getLoadPosition());i&&(this.log("Syncing with main frag at "+i.start+" cc "+i.cc),this.startFragRequested=!1,this.nextLoadPosition=i.start,this.resetLoadingState(),this.state===un.IDLE&&this.doTickIdle())}},r.startLoad=function(e,t){if(!this.levels)return this.startPosition=e,void(this.state=un.STOPPED);var r=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),r>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @"+r.toFixed(3)),e=r,this.state=un.IDLE):this.state=un.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()},r.doTick=function(){switch(this.state){case un.IDLE:this.doTickIdle();break;case un.WAITING_TRACK:var t=this.levels,r=this.trackId,n=null==t?void 0:t[r],a=null==n?void 0:n.details;if(a&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(a))break;this.state=un.WAITING_INIT_PTS}break;case un.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break;case un.WAITING_INIT_PTS:var i=this.waitingData;if(i){var s=i.frag,o=i.part,l=i.cache,u=i.complete,c=this.mainAnchor;if(void 0!==this.initPTS[s.cc]){this.waitingData=null,this.state=un.FRAG_LOADING;var d={frag:s,part:o,payload:l.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(d),u&&e.prototype._handleFragmentLoadComplete.call(this,d)}else c&&c.cc!==i.frag.cc&&this.syncWithAnchor(c,i.frag)}else this.state=un.IDLE}this.onTickEnd()},r.resetLoadingState=function(){var t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null),e.prototype.resetLoadingState.call(this)},r.onTickEnd=function(){var e=this.media;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)},r.doTickIdle=function(){var e,t=this.hls,r=this.levels,n=this.media,a=this.trackId,i=t.config;if(this.buffering&&(n||this.primaryPrefetch||!this.startFragRequested&&i.startFragPrefetch)&&null!=r&&r[a]){var s=r[a],o=s.details;if(!o||this.waitForLive(s)||this.waitForCdnTuneIn(o))return this.state=un.WAITING_TRACK,void(this.startFragRequested=!1);var l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,X,M));var u=this.getFwdBufferInfo(l,M);if(null!==u){if(!this.switchingTrack&&this._streamEnded(u,o))return t.trigger(P.BUFFER_EOS,{type:"audio"}),void(this.state=un.ENDED);var c=u.len,d=t.maxBufferLength,p=o.fragments,h=p[0].start,f=this.getLoadPosition(),m=this.flushing?f:u.end;if(this.switchingTrack&&n){var g=f;o.PTSKnown&&g<h&&(u.end>h||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=h+.05)}if(!(c>=d&&!this.switchingTrack&&m<p[p.length-1].start)){var y=this.getNextFragment(m,o);if(y&&this.isLoopLoading(y,m)&&(y=this.getNextFragmentLoopLoading(y,o,u,R,d)),y){var v=(null==(e=this.mainFragLoading)?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&v&&ee(y)&&!y.endList&&(!o.live||!this.loadingParts&&m<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(v)===wt&&(this.mainFragLoading=v=null),v&&ee(v))){if(y.start>v.end){var _=this.fragmentTracker.getFragAtPos(m,R);_&&_.end>v.end&&(v=_,this.mainFragLoading={frag:_,targetBufferTime:null})}if(y.start>v.end)return}this.loadFragment(y,s,m)}else this.bufferFlushed=!0}}}},r.onMediaDetaching=function(t,r){this.bufferFlushed=this.flushing=!1,e.prototype.onMediaDetaching.call(this,t,r)},r.onAudioTracksUpdated=function(e,t){var r=t.audioTracks;this.resetTransmuxer(),this.levels=r.map((function(e){return new et(e)}))},r.onAudioTrackSwitching=function(e,t){var r=!!t.url;this.trackId=t.id;var n=this.fragCurrent;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==un.STOPPED&&(this.setInterval(100),this.state=un.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())},r.onManifestLoading=function(){e.prototype.onManifestLoading.call(this),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1},r.onLevelLoaded=function(e,t){this.mainDetails=t.details;var r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(P.AUDIO_TRACK_LOADED,r))},r.onAudioTrackLoaded=function(e,t){var r,n=this.levels,a=t.details,i=t.id,s=t.groupId,o=t.track;if(n){var l=this.mainDetails;if(!l||a.endCC>l.endCC||l.expired)return this.cachedTrackLoadedData=t,void(this.state!==un.STOPPED&&(this.state=un.WAITING_TRACK));this.cachedTrackLoadedData=null,this.log("Audio track "+i+' "'+o.name+'" of "'+s+'" loaded ['+a.startSN+","+a.endSN+"]"+(a.lastPartSn?"[part-"+a.lastPartSn+"-"+a.lastPartIndex+"]":"")+",duration:"+a.totalduration);var u=n[i],c=0;if(a.live||null!=(r=u.details)&&r.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;var d;u.details&&(c=this.alignPlaylists(a,u.details,null==(d=this.levelLastLoaded)?void 0:d.details)),a.alignedSliding||(an(a,l),a.alignedSliding||sn(a,l),c=a.fragmentStart)}u.details=a,this.levelLastLoaded=u,this.startFragRequested||this.setStartPosition(l,c),this.hls.trigger(P.AUDIO_TRACK_UPDATED,{details:a,id:i,groupId:t.groupId}),this.state!==un.WAITING_TRACK||this.waitForCdnTuneIn(a)||(this.state=un.IDLE),this.tick()}else this.warn("Audio tracks reset while loading track "+i+' "'+o.name+'" of "'+s+'"')},r._handleFragmentLoadProgress=function(e){var t,r=e.frag,n=e.part,a=e.payload,i=this.config,s=this.trackId,o=this.levels;if(o){var l=o[s];if(l){var u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(r.start);var c=i.defaultAudioCodec||l.audioCodec||"mp4a.40.2",d=this.transmuxer;d||(d=this.transmuxer=new $a(this.hls,M,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var p=this.initPTS[r.cc],h=null==(t=r.initSegment)?void 0:t.data;if(void 0!==p){var f=n?n.index:-1,m=-1!==f,g=new Wt(r.level,r.sn,r.stats.chunkCount,a.byteLength,f,m);d.push(a,h,c,"",r,n,u.totalduration,!1,g,p)}else this.log("Unknown video PTS for cc "+r.cc+", waiting for video PTS before demuxing audio frag "+r.sn+" of ["+u.startSN+" ,"+u.endSN+"],track "+s),(this.waitingData=this.waitingData||{frag:r,part:n,cache:new pn,complete:!1}).cache.push(new Uint8Array(a)),this.state!==un.STOPPED&&(this.state=un.WAITING_INIT_PTS)}else this.warn("Audio track is undefined on fragment load progress")}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},r._handleFragmentLoadComplete=function(t){this.waitingData?this.waitingData.complete=!0:e.prototype._handleFragmentLoadComplete.call(this,t)},r.onBufferReset=function(){this.mediaBuffer=null},r.onBufferCreated=function(e,t){this.bufferFlushed=this.flushing=!1;var r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)},r.onFragLoading=function(e,t){!this.audioOnly&&t.frag.type===R&&ee(t.frag)&&(this.mainFragLoading=t,this.state===un.IDLE&&this.tick())},r.onFragBuffered=function(e,t){var r=t.frag,n=t.part;if(r.type===M)if(this.fragContextChanged(r))this.warn("Fragment "+r.sn+(n?" p: "+n.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+(this.switchingTrack?this.switchingTrack.name:"false"));else{if(ee(r)){this.fragPrevious=r;var a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(P.AUDIO_TRACK_SWITCHED,c({},a)))}this.fragBufferedComplete(r,n),this.media&&this.tick()}else this.audioOnly||r.type!==R||r.elementaryStreams.video||r.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)},r.onError=function(t,r){var n;if(r.fatal)this.state=un.ERROR;else switch(r.details){case S.FRAG_GAP:case S.FRAG_PARSING_ERROR:case S.FRAG_DECRYPT_ERROR:case S.FRAG_LOAD_ERROR:case S.FRAG_LOAD_TIMEOUT:case S.KEY_LOAD_ERROR:case S.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(M,r);break;case S.AUDIO_TRACK_LOAD_ERROR:case S.AUDIO_TRACK_LOAD_TIMEOUT:case S.LEVEL_PARSING_ERROR:r.levelRetry||this.state!==un.WAITING_TRACK||(null==(n=r.context)?void 0:n.type)!==I||(this.state=un.IDLE);break;case S.BUFFER_ADD_CODEC_ERROR:case S.BUFFER_APPEND_ERROR:if("audio"!==r.parent)return;this.reduceLengthAndFlushBuffer(r)||this.resetLoadingState();break;case S.BUFFER_FULL_ERROR:if("audio"!==r.parent)return;this.reduceLengthAndFlushBuffer(r)&&(this.bufferedTrack=null,e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"));break;case S.INTERNAL_EXCEPTION:this.recoverWorkerError(r)}},r.onBufferFlushing=function(e,t){t.type!==Z&&(this.flushing=!0)},r.onBufferFlushed=function(e,t){var r=t.type;if(r!==Z){this.flushing=!1,this.bufferFlushed=!0,this.state===un.ENDED&&(this.state=un.IDLE);var n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,r,M),this.tick())}},r._handleTransmuxComplete=function(e){var t,r="audio",n=this.hls,a=e.remuxResult,s=e.chunkMeta,o=this.getCurrentContext(s);if(o){var l=o.frag,u=o.part,c=o.level,d=c.details,p=a.audio,h=a.text,f=a.id3,m=a.initSegment;if(!this.fragContextChanged(l)&&d){if(this.state=un.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),null!=m&&m.tracks){var g=l.initSegment||l;if(this.unhandledEncryptionError(m,l))return;this._bufferInitSegment(c,m.tracks,g,s),n.trigger(P.FRAG_PARSING_INIT_SEGMENT,{frag:g,id:r,tracks:m.tracks})}if(p){var y=p.startPTS,v=p.endPTS,_=p.startDTS,k=p.endDTS;u&&(u.elementaryStreams[X]={startPTS:y,endPTS:v,startDTS:_,endDTS:k}),l.setElementaryStreamInfo(X,y,v,_,k),this.bufferFragmentData(p,l,u,s)}if(null!=f&&null!=(t=f.samples)&&t.length){var E=i({id:r,frag:l,details:d},f);n.trigger(P.FRAG_PARSING_METADATA,E)}if(h){var b=i({id:r,frag:l,details:d},h);n.trigger(P.FRAG_PARSING_USERDATA,b)}}else this.fragmentTracker.removeFragment(l)}else this.resetWhenMissingContext(s)},r._bufferInitSegment=function(e,t,r,n){if(this.state===un.PARSING&&(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,t.audio)){var a=t.audio;a.id=M;var i=e.audioCodec;this.log("Init audio buffer, container:"+a.container+", codecs[level/parsed]=["+i+"/"+a.codec+"]"),i&&1===i.split(",").length&&(a.levelCodec=i),this.hls.trigger(P.BUFFER_CODECS,t);var s=a.initSegment;if(null!=s&&s.byteLength){var o={type:"audio",frag:r,part:null,chunkMeta:n,parent:r.type,data:s};this.hls.trigger(P.BUFFER_APPENDING,o)}this.tickImmediate()}},r.loadFragment=function(t,r,n){var a,i=this.fragmentTracker.getState(t);if(this.switchingTrack||i===Ct||i===It)if(ee(t))if(null!=(a=r.details)&&a.live&&!this.initPTS[t.cc]){this.log("Waiting for video PTS in continuity counter "+t.cc+" of live stream before loading audio fragment "+t.sn+" of level "+this.trackId),this.state=un.WAITING_INIT_PTS;var s=this.mainDetails;s&&s.fragmentStart!==r.details.fragmentStart&&sn(r.details,s)}else e.prototype.loadFragment.call(this,t,r,n);else this._loadInitSegment(t,r);else this.clearTrackerIfNeeded(t)},r.flushAudioIfNeeded=function(t){if(this.media&&this.bufferedTrack){var r=this.bufferedTrack;ot({name:r.name,lang:r.lang,assocLang:r.assocLang,characteristics:r.characteristics,audioCodec:r.audioCodec,channels:r.channels},t,lt)||(ct(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t)}},r.completeAudioSwitch=function(e){var t=this.hls;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(P.AUDIO_TRACK_SWITCHED,c({},e))},t}(cn),qa=function(e){function t(t,r){var n;return(n=e.call(this,r,t.logger)||this).hls=void 0,n.canLoad=!1,n.timer=-1,n.hls=t,n}o(t,e);var r=t.prototype;return r.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},r.clearTimer=function(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)},r.startLoad=function(){this.canLoad=!0,this.loadPlaylist()},r.stopLoad=function(){this.canLoad=!1,this.clearTimer()},r.switchParams=function(e,t,r){var n=null==t?void 0:t.renditionReports;if(n){for(var a=-1,i=0;i<n.length;i++){var s=n[i],o=void 0;try{o=new self.URL(s.URI,t.url).href}catch(e){this.warn("Could not construct new URL for Rendition Report: "+e),o=s.URI||""}if(o===e){a=i;break}o===e.substring(0,o.length)&&(a=i)}if(-1!==a){var l=n[a],u=parseInt(l["LAST-MSN"])||t.lastPartSn,c=parseInt(l["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){var d=Math.min(t.age-t.partTarget,t.targetduration);c>=0&&d>t.partTarget&&(c+=1)}var p=r&&Qe(r);return new Je(u,c>=0?c:void 0,p)}}},r.loadPlaylist=function(e){this.clearTimer()},r.loadingPlaylist=function(e,t){this.clearTimer()},r.shouldLoadPlaylist=function(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)},r.getUrlWithDirectives=function(e,t){if(t)try{return t.addDirectives(e)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}return e},r.playlistLoaded=function(e,t,r){var n=t.details,a=t.stats,i=self.performance.now(),s=a.loading.first?Math.max(0,i-a.loading.first):0;n.advancedDateTime=Date.now()-s;var o=this.hls.config.timelineOffset;if(o!==n.appliedTimelineOffset){var l=Math.max(o||0,0);n.appliedTimelineOffset=l,n.fragments.forEach((function(e){e.setStart(e.playlistOffset+l)}))}if(n.live||null!=r&&r.live){var u="levelInfo"in t?t.levelInfo:t.track;if(n.reloaded(r),r&&n.fragments.length>0){Kr(r,n,this);var c=n.playlistParsingError;if(c){this.warn(c);var d=this.hls;if(!d.config.ignorePlaylistParsingErrors){var p,h=t.networkDetails;return void d.trigger(P.ERROR,{type:A.NETWORK_ERROR,details:S.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:c,reason:c.message,level:t.level||void 0,parent:null==(p=n.fragments[0])?void 0:p.type,networkDetails:h,stats:a})}n.playlistParsingError=null}}-1===n.requestScheduled&&(n.requestScheduled=a.loading.start);var f,m=this.hls.mainForwardBufferInfo,g=m?m.end-m.len:0,y=qr(n,1e3*(n.edge-g));if(n.requestScheduled+y<i?n.requestScheduled=i:n.requestScheduled+=y,this.log("live playlist "+e+" "+(n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED")),!this.canLoad||!n.live)return;var v=void 0,_=void 0;if(n.canBlockReload&&n.endSN&&n.advanced){var k=this.hls.config.lowLatencyMode,E=n.lastPartSn,b=n.endSN,T=n.lastPartIndex,C=E===b;-1!==T?C?(v=b+1,_=k?0:T):(v=E,_=k?T+1:n.maxPartIndex):v=b+1;var x=n.age,I=x+n.ageHeader,w=Math.min(I-n.partTarget,1.5*n.targetduration);if(w>0){if(I>3*n.targetduration)this.log("Playlist last advanced "+x.toFixed(2)+"s ago. Omitting segment and part directives."),v=void 0,_=void 0;else if(null!=r&&r.tuneInGoal&&I-n.partTarget>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+r.tuneInGoal+" to: "+w+" with playlist age: "+n.age),w=0;else{var R=Math.floor(w/n.targetduration);v+=R,void 0!==_&&(_+=Math.round(w%n.targetduration/n.partTarget)),this.log("CDN Tune-in age: "+n.ageHeader+"s last advanced "+x.toFixed(2)+"s goal: "+w+" skip sn "+R+" to part "+_)}n.tuneInGoal=w}if(f=this.getDeliveryDirectives(n,t.deliveryDirectives,v,_),k||!C)return n.requestScheduled=i,void this.loadingPlaylist(u,f)}else(n.canBlockReload||n.canSkipUntil)&&(f=this.getDeliveryDirectives(n,t.deliveryDirectives,v,_));f&&void 0!==v&&n.canBlockReload&&(n.requestScheduled=a.loading.first+Math.max(y-2*s,y/2)),this.scheduleLoading(u,f,n)}else this.clearTimer()},r.scheduleLoading=function(e,t,r){var n=this,a=r||e.details;if(a){var i=self.performance.now(),s=a.requestScheduled;if(i>=s)this.loadingPlaylist(e,t);else{var o=s-i;this.log("reload live playlist "+(e.name||e.bitrate+"bps")+" in "+Math.round(o)+" ms"),this.clearTimer(),this.timer=self.setTimeout((function(){return n.loadingPlaylist(e,t)}),o)}}else this.loadingPlaylist(e,t)},r.getDeliveryDirectives=function(e,t,r,n){var a=Qe(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,n=t.part,a=""),new Je(r,n,a)},r.checkRetry=function(e){var t=this,r=e.details,n=yt(e),a=e.errorAction,i=a||{},s=i.action,o=i.retryCount,l=void 0===o?0:o,u=i.retryConfig,c=!!a&&!!u&&(5===s||!a.resolved&&2===s);if(c){var d;if(l>=u.maxNumRetry)return!1;if(n&&null!=(d=e.context)&&d.deliveryDirectives)this.warn("Retrying playlist loading "+(l+1)+"/"+u.maxNumRetry+' after "'+r+'" without delivery-directives'),this.loadPlaylist();else{var p=Et(u,l);this.clearTimer(),this.timer=self.setTimeout((function(){return t.loadPlaylist()}),p),this.warn("Retrying playlist loading "+(l+1)+"/"+u.maxNumRetry+' after "'+r+'" in '+p+"ms")}e.levelRetry=!0,a.resolved=!0}return c},t}(N);function Ya(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!Xa(e[r].attrs,t[r].attrs))return!1;return!0}function Xa(e,t,r){var n=e["STABLE-RENDITION-ID"];return n&&!r?n===t["STABLE-RENDITION-ID"]:!(r||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((function(r){return e[r]!==t[r]}))}function Za(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}var Qa=function(e){function t(t){var r;return(r=e.call(this,t,"audio-track-controller")||this).tracks=[],r.groupIds=null,r.tracksInGroup=[],r.trackId=-1,r.currentTrack=null,r.selectDefaultTrack=!0,r.registerListeners(),r}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.LEVEL_LOADING,this.onLevelLoading,this),e.on(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(P.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(P.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.LEVEL_LOADING,this.onLevelLoading,this),e.off(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(P.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(P.ERROR,this.onError,this)},r.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,e.prototype.destroy.call(this)},r.onManifestLoading=function(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0},r.onManifestParsed=function(e,t){this.tracks=t.audioTracks||[]},r.onAudioTrackLoaded=function(e,t){var r=t.id,n=t.groupId,a=t.details,i=this.tracksInGroup[r];if(i&&i.groupId===n){var s=i.details;i.details=t.details,this.log("Audio track "+r+' "'+i.name+'" lang:'+i.lang+" group:"+n+" loaded ["+a.startSN+"-"+a.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,t,s)}else this.warn("Audio track with id:"+r+" and group:"+n+" not found in active group "+(null==i?void 0:i.groupId))},r.onLevelLoading=function(e,t){this.switchLevel(t.level)},r.onLevelSwitching=function(e,t){this.switchLevel(t.level)},r.switchLevel=function(e){var t=this.hls.levels[e];if(t){var r=t.audioGroups||null,n=this.groupIds,a=this.currentTrack;if(!r||(null==n?void 0:n.length)!==(null==r?void 0:r.length)||null!=r&&r.some((function(e){return-1===(null==n?void 0:n.indexOf(e))}))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;var i=this.tracks.filter((function(e){return!r||-1!==r.indexOf(e.groupId)}));if(i.length)this.selectDefaultTrack&&!i.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),i.forEach((function(e,t){e.id=t}));else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=i;var s=this.hls.config.audioPreference;if(!a&&s){var o=st(s,i,lt);if(o>-1)a=i[o];else{var l=st(s,this.tracks);a=this.tracks[l]}}var u=this.findTrackId(a);-1===u&&a&&(u=this.findTrackId(null));var c={audioTracks:i};this.log("Updating audio tracks, "+i.length+" track(s) found in group(s): "+(null==r?void 0:r.join(","))),this.hls.trigger(P.AUDIO_TRACKS_UPDATED,c);var d=this.trackId;if(-1!==u&&-1===d)this.setAudioTrack(u);else if(i.length&&-1===d){var p,h=new Error("No audio track selected for current audio group-ID(s): "+(null==(p=this.groupIds)?void 0:p.join(","))+" track count: "+i.length);this.warn(h.message),this.hls.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:h})}}}},r.onError=function(e,t){!t.fatal&&t.context&&(t.context.type!==I||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))},r.setAudioOption=function(e){var t=this.hls;if(t.config.audioPreference=e,e){var r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){var n=this.currentTrack;if(n&&ot(e,n,lt))return n;var a=st(e,this.tracksInGroup,lt);if(a>-1){var i=this.tracksInGroup[a];return this.setAudioTrack(a),i}if(n){var s=t.loadLevel;-1===s&&(s=t.firstAutoLevel);var o=function(e,t,r,n,a){var i=t[n],s=t.reduce((function(e,t,r){var n=t.uri;return(e[n]||(e[n]=[])).push(r),e}),{})[i.uri];s.length>1&&(n=Math.max.apply(Math,s));var o=i.videoRange,l=i.frameRate,u=i.codecSet.substring(0,4),c=ut(t,n,(function(t){if(t.videoRange!==o||t.frameRate!==l||t.codecSet.substring(0,4)!==u)return!1;var n=t.audioGroups,i=r.filter((function(e){return!n||-1!==n.indexOf(e.groupId)}));return st(e,i,a)>-1}));return c>-1?c:ut(t,n,(function(t){var n=t.audioGroups,i=r.filter((function(e){return!n||-1!==n.indexOf(e.groupId)}));return st(e,i,a)>-1}))}(e,t.levels,r,s,lt);if(-1===o)return null;t.nextLoadLevel=o}if(e.channels||e.audioCodec){var l=st(e,r);if(l>-1)return r[l]}}}return null},r.setAudioTrack=function(e){var t=this.tracksInGroup;if(e<0||e>=t.length)this.warn("Invalid audio track id: "+e);else{this.selectDefaultTrack=!1;var r=this.currentTrack,n=t[e],a=n.details&&!n.details.live;if(!(e===this.trackId&&n===r&&a||(this.log("Switching to audio-track "+e+' "'+n.name+'" lang:'+n.lang+" group:"+n.groupId+" channels:"+n.channels),this.trackId=e,this.currentTrack=n,this.hls.trigger(P.AUDIO_TRACK_SWITCHING,c({},n)),a))){var i=this.switchParams(n.url,null==r?void 0:r.details,n.details);this.loadPlaylist(i)}}},r.findTrackId=function(e){for(var t=this.tracksInGroup,r=0;r<t.length;r++){var n=t[r];if((!this.selectDefaultTrack||n.default)&&(!e||ot(e,n,lt)))return r}if(e){for(var a=e.name,i=e.lang,s=e.assocLang,o=e.characteristics,l=e.audioCodec,u=e.channels,c=0;c<t.length;c++)if(ot({name:a,lang:i,assocLang:s,characteristics:o,audioCodec:l,channels:u},t[c],lt))return c;for(var d=0;d<t.length;d++){var p=t[d];if(Xa(e.attrs,p.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(var h=0;h<t.length;h++){var f=t[h];if(Xa(e.attrs,f.attrs,["LANGUAGE"]))return h}}return-1},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.currentTrack;this.shouldLoadPlaylist(r)&&ct(r.url,this.hls)&&this.scheduleLoading(r,t)},r.loadingPlaylist=function(t,r){e.prototype.loadingPlaylist.call(this,t,r);var n=t.id,a=t.groupId,i=this.getUrlWithDirectives(t.url,r),s=t.details,o=null==s?void 0:s.age;this.log("Loading audio-track "+n+' "'+t.name+'" lang:'+t.lang+" group:"+a+(void 0!==(null==r?void 0:r.msn)?" at sn "+r.msn+" part "+r.part:"")+(o&&s.live?" age "+o.toFixed(1)+(s.type&&" "+s.type||""):"")+" "+i),this.hls.trigger(P.AUDIO_TRACK_LOADING,{url:i,id:n,groupId:a,deliveryDirectives:r||null,track:t})},n(t,[{key:"allAudioTracks",get:function(){return this.tracks}},{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}}])}(qa),Ja=function(){function e(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}var t=e.prototype;return t.destroy=function(){this.tracks=this.queues=null},t.append=function(e,t,r){if(null!==this.queues&&null!==this.tracks){var n=this.queues[t];n.push(e),1!==n.length||r||this.executeNext(t)}},t.appendBlocker=function(e){var t=this;return new Promise((function(r){var n={label:"async-blocker",execute:r,onStart:function(){},onComplete:function(){},onError:function(){}};t.append(n,e)}))},t.prependBlocker=function(e){var t=this;return new Promise((function(r){if(t.queues){var n={label:"async-blocker-prepend",execute:r,onStart:function(){},onComplete:function(){},onError:function(){}};t.queues[e].unshift(n)}}))},t.removeBlockers=function(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach((function(e){var t,r=null==(t=e[0])?void 0:t.label;"async-blocker"!==r&&"async-blocker-prepend"!==r||(e[0].execute(),e.splice(0,1))}))},t.unblockAudio=function(e){null!==this.queues&&this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")},t.executeNext=function(e){if(null!==this.queues&&null!==this.tracks){var t=this.queues[e];if(t.length){var r=t[0];try{r.execute()}catch(t){var n;if(r.onError(t),null===this.queues||null===this.tracks)return;var a=null==(n=this.tracks[e])?void 0:n.buffer;null!=a&&a.updating||this.shiftAndExecuteNext(e)}}}},t.shiftAndExecuteNext=function(e){null!==this.queues&&(this.queues[e].shift(),this.executeNext(e))},t.current=function(e){var t;return(null==(t=this.queues)?void 0:t[e][0])||null},t.toString=function(){var e=this.queues,t=this.tracks;return null===e||null===t?"<destroyed>":"\n"+this.list("video")+"\n"+this.list("audio")+"\n"+this.list("audiovideo")+"}"},t.list=function(e){var t,r;return null!=(t=this.queues)&&t[e]||null!=(r=this.tracks)&&r[e]?e+": ("+this.listSbInfo(e)+") "+this.listOps(e):""},t.listSbInfo=function(e){var t,r=null==(t=this.tracks)?void 0:t[e],n=null==r?void 0:r.buffer;return n?"SourceBuffer"+(n.updating?" updating":"")+(r.ended?" ended":"")+(r.ending?" ending":""):"none"},t.listOps=function(e){var t;return(null==(t=this.queues)?void 0:t[e].map((function(e){return e.label})).join(", "))||""},e}(),ei=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,ti="HlsJsTrackRemovedError",ri=function(e){function t(t){var r;return(r=e.call(this,t)||this).name=ti,r}return o(t,e),t}(h(Error)),ni=function(e){function t(t,r){var n,a;return(n=e.call(this,"buffer-controller",t.logger)||this).hls=void 0,n.fragmentTracker=void 0,n.details=null,n._objectUrl=null,n.operationQueue=null,n.bufferCodecEventsTotal=0,n.media=null,n.mediaSource=null,n.lastMpegAudioChunk=null,n.blockedAudioAppend=null,n.lastVideoAppendEnd=0,n.appendSource=void 0,n.transferData=void 0,n.overrides=void 0,n.appendErrors={audio:0,video:0,audiovideo:0},n.tracks={},n.sourceBuffers=[[null,null],[null,null]],n._onEndStreaming=function(e){var t;n.hls&&"open"===(null==(t=n.mediaSource)?void 0:t.readyState)&&n.hls.pauseBuffering()},n._onStartStreaming=function(e){n.hls&&n.hls.resumeBuffering()},n._onMediaSourceOpen=function(e){var t=n,r=t.media,a=t.mediaSource;e&&n.log("Media source opened"),r&&a&&(a.removeEventListener("sourceopen",n._onMediaSourceOpen),r.removeEventListener("emptied",n._onMediaEmptied),n.updateDuration(),n.hls.trigger(P.MEDIA_ATTACHED,{media:r,mediaSource:a}),null!==n.mediaSource&&n.checkPendingTracks())},n._onMediaSourceClose=function(){n.log("Media source closed")},n._onMediaSourceEnded=function(){n.log("Media source ended")},n._onMediaEmptied=function(){var e=n,t=e.mediaSrc,r=e._objectUrl;t!==r&&n.error("Media element src was set while attaching MediaSource ("+r+" > "+t+")")},n.hls=t,n.fragmentTracker=r,n.appendSource=(a=K(t.config.preferManagedMediaSource),"undefined"!=typeof self&&a===self.ManagedMediaSource),n.initTracks(),n.registerListeners(),n}o(t,e);var r=t.prototype;return r.hasSourceTypes=function(){return Object.keys(this.tracks).length>0},r.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null},r.registerListeners=function(){var e=this.hls;e.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.BUFFER_RESET,this.onBufferReset,this),e.on(P.BUFFER_APPENDING,this.onBufferAppending,this),e.on(P.BUFFER_CODECS,this.onBufferCodecs,this),e.on(P.BUFFER_EOS,this.onBufferEos,this),e.on(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(P.FRAG_PARSED,this.onFragParsed,this),e.on(P.FRAG_CHANGED,this.onFragChanged,this),e.on(P.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.BUFFER_RESET,this.onBufferReset,this),e.off(P.BUFFER_APPENDING,this.onBufferAppending,this),e.off(P.BUFFER_CODECS,this.onBufferCodecs,this),e.off(P.BUFFER_EOS,this.onBufferEos,this),e.off(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(P.FRAG_PARSED,this.onFragParsed,this),e.off(P.FRAG_CHANGED,this.onFragChanged,this),e.off(P.ERROR,this.onError,this)},r.transferMedia=function(){var e=this,t=this.media,r=this.mediaSource;if(!t)return null;var n={};if(this.operationQueue){var a=this.isUpdating();a||this.operationQueue.removeBlockers();var s=this.isQueued();(a||s)&&this.warn("Transfering MediaSource with"+(s?" operations in queue":"")+(a?" updating SourceBuffer(s)":"")+" "+this.operationQueue),this.operationQueue.destroy()}var o=this.transferData;return!this.sourceBufferCount&&o&&o.mediaSource===r?i(n,o.tracks):this.sourceBuffers.forEach((function(t){var r=t[0];r&&(n[r]=i({},e.tracks[r]),e.removeBuffer(r)),t[0]=t[1]=null})),{media:t,mediaSource:r,tracks:n}},r.initTracks=function(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0},r.onManifestLoading=function(){this.bufferCodecEventsTotal=0,this.details=null},r.onManifestParsed=function(e,t){var r,n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(n+" bufferCodec event(s) expected."),null!=(r=this.transferData)&&r.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()},r.onMediaAttaching=function(e,t){var r=this.media=t.media;this.transferData=this.overrides=void 0;var n=K(this.appendSource);if(n){var a=!!t.mediaSource;(a||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);var i=this.mediaSource=t.mediaSource||new n;if(this.assignMediaSource(i),a)this._objectUrl=r.src,this.attachTransferred();else{var s=this._objectUrl=self.URL.createObjectURL(i);if(this.appendSource)try{r.removeAttribute("src");var o=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||o&&i instanceof o,ai(r),function(e,t){var r=self.document.createElement("source");r.type="video/mp4",r.src=t,e.appendChild(r)}(r,s),r.load()}catch(e){r.src=s}else r.src=s}r.addEventListener("emptied",this._onMediaEmptied)}},r.assignMediaSource=function(e){var t,r;this.log(((null==(t=this.transferData)?void 0:t.mediaSource)===e?"transferred":"created")+" media source: "+(null==(r=e.constructor)?void 0:r.name)),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))},r.attachTransferred=function(){var e=this,t=this.media,r=this.transferData;if(r&&t){var n=this.tracks,a=r.tracks,i=a?Object.keys(a):null,s=i?i.length:0,o=function(){Promise.resolve().then((function(){e.media&&e.mediaSourceOpenOrEnded&&e._onMediaSourceOpen()}))};if(a&&i&&s){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log("attachTransferred: (bufferCodecEventsTotal "+this.bufferCodecEventsTotal+")\nrequired tracks: "+rt(n,(function(e,t){return"initSegment"===e?void 0:t}))+";\ntransfer tracks: "+rt(a,(function(e,t){return"initSegment"===e?void 0:t}))+"}"),!W(a,n)){r.mediaSource=null,r.tracks=void 0;var l=t.currentTime,u=this.details,c=Math.max(l,(null==u?void 0:u.fragments[0].start)||0);return c-l>1?void this.log("attachTransferred: waiting for playback to reach new tracks start time "+l+" -> "+c):(this.warn('attachTransferred: resetting MediaSource for incompatible tracks ("'+Object.keys(a)+'"->"'+Object.keys(n)+'") start time: '+c+" currentTime: "+l),this.onMediaDetaching(P.MEDIA_DETACHING,{}),this.onMediaAttaching(P.MEDIA_ATTACHING,r),void(t.currentTime=c))}this.transferData=void 0,i.forEach((function(t){var r=t,n=a[r];if(n){var i=n.buffer;if(i){var s=e.fragmentTracker,o=n.id;if(s.hasFragments(o)||s.hasParts(o)){var l=zt.getBuffered(i);s.detectEvictedFragments(r,l,o,null,!0)}var u=ii(r),c=[r,i];e.sourceBuffers[u]=c,i.updating&&e.operationQueue&&e.operationQueue.prependBlocker(r),e.trackSourceBuffer(r,n)}}})),o(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o()}},r.onMediaDetaching=function(e,t){var r=this,n=!!t.transferMedia;this.transferData=this.overrides=void 0;var a=this.media,i=this.mediaSource,s=this._objectUrl;if(i){if(this.log("media source "+(n?"transferring":"detaching")),n)this.sourceBuffers.forEach((function(e){var t=e[0];t&&r.removeBuffer(t)})),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){var o="open"===i.readyState;try{for(var l=i.sourceBuffers,u=l.length;u--;)o&&l[u].abort(),i.removeSourceBuffer(l[u]);o&&i.endOfStream()}catch(e){this.warn("onMediaDetaching: "+e.message+" while calling endOfStream")}}this.sourceBufferCount&&this.onBufferReset()}i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}a&&(a.removeEventListener("emptied",this._onMediaEmptied),n||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(a.removeAttribute("src"),this.appendSource&&ai(a),a.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(P.MEDIA_DETACHED,t)},r.onBufferReset=function(){var e=this;this.sourceBuffers.forEach((function(t){var r=t[0];r&&e.resetBuffer(r)})),this.initTracks()},r.resetBuffer=function(e){var t,r=null==(t=this.tracks[e])?void 0:t.buffer;if(this.removeBuffer(e),r)try{var n;null!=(n=this.mediaSource)&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(t){this.warn("onBufferReset "+e,t)}delete this.tracks[e]},r.removeBuffer=function(e){this.removeBufferListeners(e),this.sourceBuffers[ii(e)]=[null,null];var t=this.tracks[e];t&&(t.buffer=void 0)},r.resetQueue=function(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Ja(this.tracks)},r.onBufferCodecs=function(e,t){var r,n=this,a=this.tracks,i=Object.keys(t);this.log('BUFFER_CODECS: "'+i+'" (current SB count '+this.sourceBufferCount+")");var s="audiovideo"in t&&(a.audio||a.video)||a.audiovideo&&("audio"in t||"video"in t),o=!s&&this.sourceBufferCount&&this.media&&i.some((function(e){return!a[e]}));s||o?this.warn('Unsupported transition between "'+Object.keys(a)+'" and "'+i+'" SourceBuffers'):(i.forEach((function(e){var r,i,s=t[e],o=s.id,l=s.codec,u=s.levelCodec,c=s.container,d=s.metadata,p=s.supplemental,h=a[e],f=null==(r=n.transferData)||null==(r=r.tracks)?void 0:r[e],m=null!=f&&f.buffer?f:h,g=(null==m?void 0:m.pendingCodec)||(null==m?void 0:m.codec),y=null==m?void 0:m.levelCodec;h||(h=a[e]={buffer:void 0,listeners:[],codec:l,supplemental:p,container:c,levelCodec:u,metadata:d,id:o});var v=Be(g,y),_=null==v?void 0:v.replace(ei,"$1"),k=Be(l,u),E=null==(i=k)?void 0:i.replace(ei,"$1");k&&v&&_!==E&&("audio"===e.slice(0,5)&&(k=je(k,n.appendSource)),n.log("switching codec "+g+" to "+k),k!==(h.pendingCodec||h.codec)&&(h.pendingCodec=k),h.container=c,n.appendChangeType(e,c,k))})),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),this.sourceBufferCount||(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&"main"===(null==(r=t.audio)?void 0:r.id)&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks()))},r.appendChangeType=function(e,t,r){var n=this,a=t+";codecs="+r,i={label:"change-type="+a,execute:function(){var i=n.tracks[e];if(i){var s=i.buffer;null!=s&&s.changeType&&(n.log("changing "+e+" sourceBuffer type to "+a),s.changeType(a),i.codec=r,i.container=t)}n.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(t){n.warn("Failed to change "+e+" SourceBuffer type",t)}};this.append(i,e,this.isPending(this.tracks[e]))},r.blockAudio=function(e){var t,r=this,n=e.start,a=n+.05*e.duration;if(!0!==(null==(t=this.fragmentTracker.getAppendedFrag(n,R))?void 0:t.gap)){var i={label:"block-audio",execute:function(){var e,t=r.tracks.video;(r.lastVideoAppendEnd>a||null!=t&&t.buffer&&zt.isBuffered(t.buffer,a)||!0===(null==(e=r.fragmentTracker.getAppendedFrag(a,R))?void 0:e.gap))&&(r.blockedAudioAppend=null,r.shiftAndExecuteNext("audio"))},onStart:function(){},onComplete:function(){},onError:function(e){r.warn("Error executing block-audio operation",e)}};this.blockedAudioAppend={op:i,frag:e},this.append(i,"audio",!0)}},r.unblockAudio=function(){var e=this.blockedAudioAppend,t=this.operationQueue;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))},r.onBufferAppending=function(e,t){var r=this,n=this.tracks,a=t.data,i=t.type,s=t.parent,o=t.frag,l=t.part,u=t.chunkMeta,c=t.offset,d=u.buffering[i],p=o.sn,h=o.cc,f=self.performance.now();d.start=f;var m=o.stats.buffering,g=l?l.stats.buffering:null;0===m.start&&(m.start=f),g&&0===g.start&&(g.start=f);var y=n.audio,v=!1;"audio"===i&&"audio/mpeg"===(null==y?void 0:y.container)&&(v=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);var _=n.video,k=null==_?void 0:_.buffer;if(k&&"initSegment"!==p){var b=l||o,T=this.blockedAudioAppend;if("audio"!==i||"main"===s||this.blockedAudioAppend||_.ending||_.ended){if("video"===i){var C=b.end;if(T){var x=T.frag.start;(C>x||C<this.lastVideoAppendEnd||zt.isBuffered(k,x))&&this.unblockAudio()}this.lastVideoAppendEnd=C}}else{var I=b.start+.05*b.duration,w=k.buffered,M=this.currentOp("video");w.length||M?!M&&!zt.isBuffered(k,I)&&this.lastVideoAppendEnd<I&&this.blockAudio(b):this.blockAudio(b)}}var D=(l||o).start,O={label:"append-"+i,execute:function(){var e;d.executeStart=self.performance.now();var t=null==(e=r.tracks[i])?void 0:e.buffer;t&&(v?r.updateTimestampOffset(t,D,.1,i,p,h):void 0!==c&&E(c)&&r.updateTimestampOffset(t,c,1e-6,i,p,h)),r.appendExecutor(a,i)},onStart:function(){},onComplete:function(){var e=self.performance.now();d.executeEnd=d.end=e,0===m.first&&(m.first=e),g&&0===g.first&&(g.first=e);var t={};r.sourceBuffers.forEach((function(e){var r=e[0],n=e[1];r&&(t[r]=zt.getBuffered(n))})),r.appendErrors[i]=0,"audio"===i||"video"===i?r.appendErrors.audiovideo=0:(r.appendErrors.audio=0,r.appendErrors.video=0),r.hls.trigger(P.BUFFER_APPENDED,{type:i,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:t})},onError:function(e){var t,n={type:A.MEDIA_ERROR,parent:o.type,details:S.BUFFER_APPEND_ERROR,sourceBufferName:i,frag:o,part:l,chunkMeta:u,error:e,err:e,fatal:!1},a=null==(t=r.media)?void 0:t.error;if(e.code===DOMException.QUOTA_EXCEEDED_ERR||"QuotaExceededError"==e.name||"quota"in e)n.details=S.BUFFER_FULL_ERROR;else if(e.code===DOMException.INVALID_STATE_ERR&&r.mediaSourceOpenOrEnded&&!a)n.errorAction=Pt(!0);else if(e.name===ti&&0===r.sourceBufferCount)n.errorAction=Pt(!0);else{var s=++r.appendErrors[i];r.warn("Failed "+s+"/"+r.hls.config.appendErrorMaxRetry+' times to append segment in "'+i+'" sourceBuffer ('+(a||"no media error")+")"),(s>=r.hls.config.appendErrorMaxRetry||a)&&(n.fatal=!0)}r.hls.trigger(P.ERROR,n)}};this.log('queuing "'+i+'" append sn: '+p+(l?" p: "+l.index:"")+" of "+(o.type===R?"level":"track")+" "+o.level+" cc: "+h),this.append(O,i,this.isPending(this.tracks[i]))},r.getFlushOp=function(e,t,r){var n=this;return this.log('queuing "'+e+'" remove '+t+"-"+r),{label:"remove",execute:function(){n.removeExecutor(e,t,r)},onStart:function(){},onComplete:function(){n.hls.trigger(P.BUFFER_FLUSHED,{type:e})},onError:function(a){n.warn("Failed to remove "+t+"-"+r+' from "'+e+'" SourceBuffer',a)}}},r.onBufferFlushing=function(e,t){var r=this,n=t.type,a=t.startOffset,i=t.endOffset;n?this.append(this.getFlushOp(n,a,i),n):this.sourceBuffers.forEach((function(e){var t=e[0];t&&r.append(r.getFlushOp(t,a,i),t)}))},r.onFragParsed=function(e,t){var r=this,n=t.frag,a=t.part,i=[],s=a?a.elementaryStreams:n.elementaryStreams;s[Q]?i.push("audiovideo"):(s[X]&&i.push("audio"),s[Z]&&i.push("video")),0===i.length&&this.warn("Fragments must have at least one ElementaryStreamType set. type: "+n.type+" level: "+n.level+" sn: "+n.sn),this.blockBuffers((function(){var e=self.performance.now();n.stats.buffering.end=e,a&&(a.stats.buffering.end=e);var t=a?a.stats:n.stats;r.hls.trigger(P.FRAG_BUFFERED,{frag:n,part:a,stats:t,id:n.type})}),i).catch((function(e){r.warn("Fragment buffered callback "+e),r.stepOperationQueue(r.sourceBufferTypes)}))},r.onFragChanged=function(e,t){this.trimBuffers()},r.onBufferEos=function(e,t){var r,n=this;this.sourceBuffers.forEach((function(e){var r=e[0];if(r){var a=n.tracks[r];t.type&&t.type!==r||(a.ending=!0,a.ended||(a.ended=!0,n.log(r+" buffer reached EOS")))}}));var a=!1!==(null==(r=this.overrides)?void 0:r.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some((function(e){var t,r=e[0];return r&&!(null!=(t=n.tracks[r])&&t.ended)}))?a?(this.log("Queueing EOS"),this.blockUntilOpen((function(){n.tracksEnded();var e=n.mediaSource;e&&"open"===e.readyState?(n.log("Calling mediaSource.endOfStream()"),e.endOfStream(),n.hls.trigger(P.BUFFERED_TO_END,void 0)):e&&n.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: "+e.readyState)}))):(this.tracksEnded(),this.hls.trigger(P.BUFFERED_TO_END,void 0)):"video"===t.type&&this.unblockAudio()},r.tracksEnded=function(){var e=this;this.sourceBuffers.forEach((function(t){var r=t[0];if(null!==r){var n=e.tracks[r];n&&(n.ending=!1)}}))},r.onLevelUpdated=function(e,t){var r=t.details;r.fragments.length&&(this.details=r,this.updateDuration())},r.updateDuration=function(){var e=this;this.blockUntilOpen((function(){var t=e.getDurationAndRange();t&&e.updateMediaSource(t)}))},r.onError=function(e,t){if(t.details===S.BUFFER_APPEND_ERROR&&t.frag){var r,n=null==(r=t.errorAction)?void 0:r.nextAutoLevel;E(n)&&n!==t.frag.level&&this.resetAppendErrors()}},r.resetAppendErrors=function(){this.appendErrors={audio:0,video:0,audiovideo:0}},r.trimBuffers=function(){var e=this.hls,t=this.details,r=this.media;if(r&&null!==t&&this.sourceBufferCount){var n=e.config,a=r.currentTime,i=t.levelTargetDuration,s=t.live&&null!==n.liveBackBufferLength?n.liveBackBufferLength:n.backBufferLength;if(E(s)&&s>=0){var o=Math.max(s,i),l=Math.floor(a/i)*i-o;this.flushBackBuffer(a,i,l)}var u=n.frontBufferFlushThreshold;if(E(u)&&u>0){var c=Math.max(n.maxBufferLength,u),d=Math.max(c,i),p=Math.floor(a/i)*i+d;this.flushFrontBuffer(a,i,p)}}},r.flushBackBuffer=function(e,t,r){var n=this;this.sourceBuffers.forEach((function(e){var t=e[0],a=e[1];if(a){var i=zt.getBuffered(a);if(i.length>0&&r>i.start(0)){var s;n.hls.trigger(P.BACK_BUFFER_REACHED,{bufferEnd:r});var o=n.tracks[t];if(null!=(s=n.details)&&s.live)n.hls.trigger(P.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(null!=o&&o.ended)return void n.log("Cannot flush "+t+" back buffer while SourceBuffer is in ended state");n.hls.trigger(P.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:t})}}}))},r.flushFrontBuffer=function(e,t,r){var n=this;this.sourceBuffers.forEach((function(t){var a=t[0],i=t[1];if(i){var s=zt.getBuffered(i),o=s.length;if(o<2)return;var l=s.start(o-1),u=s.end(o-1);if(r>l||e>=l&&e<=u)return;n.hls.trigger(P.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:a})}}))},r.getDurationAndRange=function(){var e,t=this.details,r=this.mediaSource;if(!t||!this.media||"open"!==(null==r?void 0:r.readyState))return null;var n=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&r.setLiveSeekableRange){var a=Math.max(0,t.fragmentStart);return{duration:1/0,start:a,end:Math.max(a,n)}}return{duration:1/0}}var i=null==(e=this.overrides)?void 0:e.duration;if(i)return E(i)?{duration:i}:null;var s=this.media.duration;return n>(E(r.duration)?r.duration:0)&&n>s||!E(s)?{duration:n}:null},r.updateMediaSource=function(e){var t=e.duration,r=e.start,n=e.end,a=this.mediaSource;this.media&&a&&"open"===a.readyState&&(a.duration!==t&&(E(t)&&this.log("Updating MediaSource duration to "+t.toFixed(3)),a.duration=t),void 0!==r&&void 0!==n&&(this.log("MediaSource duration is set to "+a.duration+". Setting seekable range to "+r+"-"+n+"."),a.setLiveSeekableRange(r,n)))},r.checkPendingTracks=function(){var e=this.bufferCodecEventsTotal,t=this.pendingTrackCount,r=this.tracks;if(this.log("checkPendingTracks (pending: "+t+" codec events expected: "+e+") "+rt(r)),this.tracksReady){var n,a=null==(n=this.transferData)?void 0:n.tracks;a&&Object.keys(a).length?this.attachTransferred():this.createSourceBuffers()}},r.bufferCreated=function(){var e=this;if(this.sourceBufferCount){var t={};this.sourceBuffers.forEach((function(r){var n=r[0],a=r[1];if(n){var i=e.tracks[n];t[n]={buffer:a,container:i.container,codec:i.codec,supplemental:i.supplemental,levelCodec:i.levelCodec,id:i.id,metadata:i.metadata}}})),this.hls.trigger(P.BUFFER_CREATED,{tracks:t}),this.log("SourceBuffers created. Running queue: "+this.operationQueue),this.sourceBuffers.forEach((function(t){var r=t[0];e.executeNext(r)}))}else{var r=new Error("could not create source buffer for media codec(s)");this.hls.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:r,reason:r.message})}},r.createSourceBuffers=function(){var e=this.tracks,t=this.sourceBuffers,r=this.mediaSource;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(var n in e){var a=n,i=e[a];if(this.isPending(i)){var s=this.getTrackCodec(i,a),o=i.container+";codecs="+s;i.codec=s,this.log("creating sourceBuffer("+o+")"+(this.currentOp(a)?" Queued":"")+" "+rt(i));try{var l=r.addSourceBuffer(o),u=ii(a),c=[a,l];t[u]=c,i.buffer=l}catch(e){var d;return this.error("error while trying to add sourceBuffer: "+e.message),this.shiftAndExecuteNext(a),null==(d=this.operationQueue)||d.removeBlockers(),delete this.tracks[a],void this.hls.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,sourceBufferName:a,mimeType:o,parent:i.id})}this.trackSourceBuffer(a,i)}}this.bufferCreated()},r.getTrackCodec=function(e,t){var r=e.supplemental,n=e.codec;r&&("video"===t||"audiovideo"===t)&&Re(r,"video")&&(n=function(e,t){var r=[];if(e)for(var n=e.split(","),a=0;a<n.length;a++)we(n[a],"video")||r.push(n[a]);return t&&r.push(t),r.join(",")}(n,r));var a=Be(n,e.levelCodec);return a?"audio"===t.slice(0,5)?je(a,this.appendSource):a:""},r.trackSourceBuffer=function(e,t){var r=this,n=t.buffer;if(n){var a=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:a,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(function(e,t){var n=t.removedRanges;null!=n&&n.length&&r.hls.trigger(P.BUFFER_FLUSHED,{type:e})}))}},r.onSBUpdateStart=function(e){var t=this.currentOp(e);t&&t.onStart()},r.onSBUpdateEnd=function(e){var t;if("closed"!==(null==(t=this.mediaSource)?void 0:t.readyState)){var r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}else this.resetBuffer(e)},r.onSBUpdateError=function(e,t){var r,n=new Error(e+" SourceBuffer error. MediaSource readyState: "+(null==(r=this.mediaSource)?void 0:r.readyState));this.error(""+n,t),this.hls.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});var a=this.currentOp(e);a&&a.onError(n)},r.updateTimestampOffset=function(e,t,r,n,a,i){var s=t-e.timestampOffset;Math.abs(s)>=r&&(this.log("Updating "+n+" SourceBuffer timestampOffset to "+t+" (sn: "+a+" cc: "+i+")"),e.timestampOffset=t)},r.removeExecutor=function(e,t,r){var n=this.media,a=this.mediaSource,i=this.tracks[e],s=null==i?void 0:i.buffer;if(!n||!a||!s)return this.warn("Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void this.shiftAndExecuteNext(e);var o=E(n.duration)?n.duration:1/0,l=E(a.duration)?a.duration:1/0,u=Math.max(0,t),c=Math.min(r,o,l);c>u&&(!i.ending||i.ended)?(i.ended=!1,this.log("Removing ["+u+","+c+"] from the "+e+" SourceBuffer"),s.remove(u,c)):this.shiftAndExecuteNext(e)},r.appendExecutor=function(e,t){var r=this.tracks[t],n=null==r?void 0:r.buffer;if(!n)throw new ri("Attempting to append to the "+t+" SourceBuffer, but it does not exist");r.ending=!1,r.ended=!1,n.appendBuffer(e)},r.blockUntilOpen=function(e){var t=this;if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch((function(e){t.warn("SourceBuffer blocked callback "+e),t.stepOperationQueue(t.sourceBufferTypes)}));else try{e()}catch(e){this.warn("Callback run without blocking "+this.operationQueue+" "+e)}},r.isUpdating=function(){return this.sourceBuffers.some((function(e){var t=e[0],r=e[1];return t&&r.updating}))},r.isQueued=function(){var e=this;return this.sourceBuffers.some((function(t){var r=t[0];return r&&!!e.currentOp(r)}))},r.isPending=function(e){return!!e&&!e.buffer},r.blockBuffers=function(e,t){var r=this;if(void 0===t&&(t=this.sourceBufferTypes),!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);var n=this.operationQueue,a=t.map((function(e){return r.appendBlocker(e)}));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(a).then((function(t){n===r.operationQueue&&(e(),r.stepOperationQueue(r.sourceBufferTypes))}))},r.stepOperationQueue=function(e){var t=this;e.forEach((function(e){var r,n=null==(r=t.tracks[e])?void 0:r.buffer;n&&!n.updating&&t.shiftAndExecuteNext(e)}))},r.append=function(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)},r.appendBlocker=function(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)},r.currentOp=function(e){return this.operationQueue?this.operationQueue.current(e):null},r.executeNext=function(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)},r.shiftAndExecuteNext=function(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)},r.addBufferListener=function(e,t,r){var n=this.tracks[e];if(n){var a=n.buffer;if(a){var i=r.bind(this,e);n.listeners.push({event:t,listener:i}),a.addEventListener(t,i)}}},r.removeBufferListeners=function(e){var t=this.tracks[e];if(t){var r=t.buffer;r&&(t.listeners.forEach((function(e){r.removeEventListener(e.event,e.listener)})),t.listeners.length=0)}},n(t,[{key:"mediaSourceOpenOrEnded",get:function(){var e,t=null==(e=this.mediaSource)?void 0:e.readyState;return"open"===t||"ended"===t}},{key:"sourceBufferTracks",get:function(){var e=this;return Object.keys(this.tracks).reduce((function(t,r){var n=e.tracks[r];return t[r]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},t}),{})}},{key:"bufferedToEnd",get:function(){var e=this;return this.sourceBufferCount>0&&!this.sourceBuffers.some((function(t){var r=t[0];if(r){var n=e.tracks[r];if(n)return!n.ended||n.ending}return!1}))}},{key:"tracksReady",get:function(){var e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}},{key:"mediaSrc",get:function(){var e,t,r=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==r?void 0:r.src}},{key:"pendingTrackCount",get:function(){var e=this;return Object.keys(this.tracks).reduce((function(t,r){return t+(e.isPending(e.tracks[r])?1:0)}),0)}},{key:"sourceBufferCount",get:function(){return this.sourceBuffers.reduce((function(e,t){return e+(t[0]?1:0)}),0)}},{key:"sourceBufferTypes",get:function(){return this.sourceBuffers.map((function(e){return e[0]})).filter((function(e){return!!e}))}}])}(N);function ai(e){var t=e.querySelectorAll("source");[].slice.call(t).forEach((function(t){e.removeChild(t)}))}function ii(e){return"audio"===e?1:0}var si=function(){function e(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.destroy=function(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},t.registerListeners=function(){var e=this.hls;e.on(P.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(P.BUFFER_CODECS,this.onBufferCodecs,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this)},t.unregisterListener=function(){var e=this.hls;e.off(P.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(P.BUFFER_CODECS,this.onBufferCodecs,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this)},t.onFpsDropLevelCapping=function(e,t){var r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})},t.onMediaAttaching=function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()},t.onManifestParsed=function(e,t){var r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()},t.onLevelsUpdated=function(e,t){this.timer&&E(this.autoLevelCapping)&&this.detectPlayerSize()},t.onBufferCodecs=function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},t.onMediaDetaching=function(){this.stopCapping(),this.media=null},t.detectPlayerSize=function(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);var e=this.hls.levels;if(e.length){var t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log("Setting autoLevelCapping to "+r+": "+e[r].height+"p@"+e[r].bitrate+" for media "+this.mediaWidth+"x"+this.mediaHeight),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},t.getMaxLevel=function(t){var r=this,n=this.hls.levels;if(!n.length)return-1;var a=n.filter((function(e,n){return r.isLevelAllowed(e)&&n<=t}));return this.clientRect=null,e.getMaxLevelByMediaSize(a,this.mediaWidth,this.mediaHeight)},t.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},t.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},t.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t},t.isLevelAllowed=function(e){return!this.restrictedLevels.some((function(t){return e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height}))},e.getMaxLevelByMediaSize=function(e,t,r){if(null==e||!e.length)return-1;for(var n,a,i=e.length-1,s=Math.max(t,r),o=0;o<e.length;o+=1){var l=e[o];if((l.width>=s||l.height>=s)&&(n=l,!(a=e[o+1])||n.width!==a.width||n.height!==a.height)){i=o;break}}return i},n(e,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return Math.min(e,this.hls.config.maxDevicePixelRatio)}}])}(),oi="m",li="a",ui="v",ci="av",di="i",pi="tt",hi="h",fi=function e(t,r){Array.isArray(t)&&(t=t.map((function(t){return t instanceof e?t:new e(t)}))),this.value=t,this.params=r},mi="Dict";function gi(e,t,r){return function(e,t,r,n){return new Error("failed to "+e+' "'+(a=t,(Array.isArray(a)?JSON.stringify(a):a instanceof Map?"Map{}":a instanceof Set?"Set{}":"object"==typeof a?JSON.stringify(a):String(a))+'" as ')+r,{cause:n});var a}("serialize",e,t,r)}var yi=function(e){this.description=e},vi="Bare Item",_i="Boolean",ki="Byte Sequence";var Ei="Integer";function bi(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw gi(e,Ei);return e.toString()}function Ti(e,t){if(e<0)return-Ti(-e,t);var r=Math.pow(10,t);if(Math.abs(e*r%1-.5)<Number.EPSILON){var n=Math.floor(e*r);return(n%2==0?n:n+1)/r}return Math.round(e*r)/r}var Ai="Decimal";function Si(e){var t=Ti(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw gi(e,Ai);var r=t.toString();return r.includes(".")?r:r+".0"}var Pi="String",Ci=/[\x00-\x1f\x7f]+/,xi="Token";function Ii(e){var t,r=(t=e).description||t.toString().slice(7,-1);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(r))throw gi(r,xi);return r}function wi(e){switch(typeof e){case"number":if(!E(e))throw gi(e,vi);return Number.isInteger(e)?bi(e):Si(e);case"string":return function(e){if(Ci.test(e))throw gi(e,Pi);return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}(e);case"symbol":return Ii(e);case"boolean":return function(e){if("boolean"!=typeof e)throw gi(e,_i);return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return"@"+bi(e.getTime()/1e3)}(e);if(e instanceof Uint8Array)return function(e){if(!1===ArrayBuffer.isView(e))throw gi(e,ki);return":"+(t=e,btoa(String.fromCharCode.apply(String,t))+":");var t}(e);if(e instanceof yi)return Ii(e);default:throw gi(e,vi)}}var Ri="Key";function Mi(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw gi(e,Ri);return e}function Di(e){return null==e?"":Object.entries(e).map((function(e){var t=e[0],r=e[1];return!0===r?";"+Mi(t):";"+Mi(t)+"="+wi(r)})).join("")}function Oi(e){return e instanceof fi?""+wi(e.value)+Di(e.params):wi(e)}function Li(e,t){return function(e,t){if(void 0===t&&(t={whitespace:!0}),"object"!=typeof e||null==e)throw gi(e,mi);var r=e instanceof Map?e.entries():Object.entries(e),n=(null==t?void 0:t.whitespace)?" ":"";return Array.from(r).map((function(e){var t=e[0],r=e[1];r instanceof fi==0&&(r=new fi(r));var n,a=Mi(t);return!0===r.value?a+=Di(r.params):(a+="=",Array.isArray(r.value)?a+="("+(n=r).value.map(Oi).join(" ")+")"+Di(n.params):a+=Oi(r)),a})).join(","+n)}(e,t)}var Ni="CMCD-Object",Ui="CMCD-Request",ji="CMCD-Session",Bi="CMCD-Status",Fi={br:Ni,ab:Ni,d:Ni,ot:Ni,tb:Ni,tpb:Ni,lb:Ni,tab:Ni,lab:Ni,url:Ni,pb:Ui,bl:Ui,tbl:Ui,dl:Ui,ltc:Ui,mtp:Ui,nor:Ui,nrr:Ui,rc:Ui,sn:Ui,sta:Ui,su:Ui,ttfb:Ui,ttfbb:Ui,ttlb:Ui,cmsdd:Ui,cmsds:Ui,smrt:Ui,df:Ui,cs:Ui,ts:Ui,cid:ji,pr:ji,sf:ji,sid:ji,st:ji,v:ji,msd:ji,bs:Bi,bsd:Bi,cdn:Bi,rtp:Bi,bg:Bi,pt:Bi,ec:Bi,e:Bi},Vi={REQUEST:Ui};var Gi="event",Hi=function(e){return Math.round(e)},Ki=function(e,t){return Array.isArray(e)?e.map((function(e){return Ki(e,t)})):e instanceof fi&&"string"==typeof e.value?new fi(Ki(e.value,t),e.params):(t.baseUrl&&(e=function(e,t){var r=new URL(e),n=new URL(t);if(r.origin!==n.origin)return e;for(var a=r.pathname.split("/").slice(1),i=n.pathname.split("/").slice(1,-1);a[0]===i[0];)a.shift(),i.shift();for(;i.length;)i.shift(),a.unshift("..");return a.join("/")+r.search+r.hash}(e,t.baseUrl)),1===t.version?encodeURIComponent(e):e)},Wi=function(e){return 100*Hi(e/100)},$i={br:Hi,d:Hi,bl:Wi,dl:Wi,mtp:Wi,nor:function(e,t){var r=e;return t.version>=2&&(e instanceof fi&&"string"==typeof e.value?r=new fi([e]):"string"==typeof e&&(r=[e])),Ki(r,t)},rtp:Wi,tb:Hi},zi="request",qi="response",Yi=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],Xi=["e"],Zi=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Qi(e){return Zi.test(e)}var Ji,es=["d","dl","nor","ot","rtp","su"],ts=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"],rs=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function ns(e){return rs.includes(e)||Qi(e)}var as=((Ji={})[qi]=function(e){return Yi.includes(e)||es.includes(e)||ts.includes(e)||Qi(e)},Ji[Gi]=function(e){return Yi.includes(e)||Xi.includes(e)||Qi(e)},Ji[zi]=function(e){return Yi.includes(e)||es.includes(e)||Qi(e)},Ji);function is(e,t){void 0===t&&(t={});var r={};if(null==e||"object"!=typeof e)return r;var n=t.version||e.v||1,a=t.reportingMode||zi,s=1===n?ns:as[a],o=Object.keys(e).filter(s),l=t.filter;"function"==typeof l&&(o=o.filter(l));var u=a===qi||a===Gi;u&&!o.includes("ts")&&o.push("ts"),n>1&&!o.includes("v")&&o.push("v");var c=i({},$i,t.formatters),d={version:n,reportingMode:a,baseUrl:t.baseUrl};return o.sort().forEach((function(t){var a=e[t],i=c[t];if("function"==typeof i&&(a=i(a,d)),"v"===t){if(1===n)return;a=n}"pr"==t&&1===a||(u&&"ts"===t&&!E(a)&&(a=Date.now()),function(e){return"number"==typeof e?E(e):null!=e&&""!==e&&!1!==e}(a)&&(function(e){return["ot","sf","st","e","sta"].includes(e)}(t)&&"string"==typeof a&&(a=new yi(a)),r[t]=a))})),r}function ss(e,t,r){return i(e,function(e,t){void 0===t&&(t={});var r={};if(!e)return r;var n=function(e,t){var r={};if(!e)return r;var n,a=Object.keys(e),i=t?(n=t,Object.keys(n).reduce((function(e,t){var r;return null===(r=n[t])||void 0===r||r.forEach((function(r){return e[r]=t})),e}),{})):{};return a.reduce((function(t,r){var n,a=Fi[r]||i[r]||Vi.REQUEST;return(null!==(n=t[a])&&void 0!==n?n:t[a]={})[r]=e[r],t}),r)}(is(e,t),null==t?void 0:t.customHeaderMap);return Object.entries(n).reduce((function(e,t){var r=t[0],n=Li(t[1],{whitespace:!1});return n&&(e[r]=n),e}),r)}(t,r))}var os=/CMCD=[^&#]+/;function ls(e,t,r){var n=function(e,t){if(void 0===t&&(t={}),!e)return"";var r=function(e,t){if(void 0===t&&(t={}),!e)return"";var r=function(e,t){return void 0===t&&(t={}),e?Li(is(e,t),{whitespace:!1}):""}(e,t);return encodeURIComponent(r)}(e,t);return"CMCD="+r}(t,r);if(!n)return e;if(os.test(e))return e.replace(os,n);var a=e.includes("?")?"&":"?";return""+e+a+n}var us=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){t.initialized&&(t.starved=!0),t.buffering=!0},this.onPlaying=function(){t.initialized||(t.initialized=!0),t.buffering=!1},this.applyPlaylistData=function(e){try{t.apply(e,{ot:oi,su:!t.initialized})}catch(e){t.hls.logger.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=function(e){try{var r=e.frag,n=e.part,a=t.hls.levels[r.level],i=t.getObjectType(r),s={d:1e3*(n||r).duration,ot:i};i!==ui&&i!==li&&i!=ci||(s.br=a.bitrate/1e3,s.tb=t.getTopBandwidth(i)/1e3,s.bl=t.getBufferLength(i));var o=n?t.getNextPart(n):t.getNextFrag(r);null!=o&&o.url&&o.url!==r.url&&(s.nor=o.url),t.apply(e,s)}catch(e){t.hls.logger.warn("Could not generate segment CMCD data.",e)}},this.hls=e;var r=this.config=e.config,n=r.cmcd;null!=n&&(r.pLoader=this.createPlaylistLoader(),r.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHED,this.onMediaDetached,this),e.on(P.BUFFER_CREATED,this.onBufferCreated,this)},t.unregisterListeners=function(){var e=this.hls;e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHED,this.onMediaDetached,this),e.off(P.BUFFER_CREATED,this.onBufferCreated,this)},t.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null},t.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},t.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},t.onBufferCreated=function(e,t){var r,n;this.audioBuffer=null==(r=t.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(n=t.tracks.video)?void 0:n.buffer},t.createData=function(){var e;return{v:1,sf:hi,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},t.apply=function(e,t){void 0===t&&(t={}),i(t,this.createData());var r=t.ot===di||t.ot===ui||t.ot===ci;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);var n=this.includeKeys;n&&(t=Object.keys(t).reduce((function(e,r){return n.includes(r)&&(e[r]=t[r]),e}),{}));var a={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),ss(e.headers,t,a)):e.url=ls(e.url,t,a)},t.getNextFrag=function(e){var t,r=null==(t=this.hls.levels[e.level])?void 0:t.details;if(r){var n=e.sn-r.startSN;return r.fragments[n+1]}},t.getNextPart=function(e){var t,r=e.index,n=e.fragment,a=null==(t=this.hls.levels[n.level])||null==(t=t.details)?void 0:t.partList;if(a)for(var i=n.sn,s=a.length-1;s>=0;s--){var o=a[s];if(o.index===r&&o.fragment.sn===i)return a[s+1]}},t.getObjectType=function(e){var t=e.type;return"subtitle"===t?pi:"initSegment"===e.sn?di:"audio"===t?li:"main"===t?this.hls.audioTracks.length?ui:ci:void 0},t.getTopBandwidth=function(e){var t,r=0,n=this.hls;if(e===li)t=n.audioTracks;else{var a=n.maxAutoLevel,i=a>-1?a+1:n.levels.length;t=n.levels.slice(0,i)}return t.forEach((function(e){e.bitrate>r&&(r=e.bitrate)})),r>0?r:NaN},t.getBufferLength=function(e){var t=this.media,r=e===li?this.audioBuffer:this.videoBuffer;return r&&t?1e3*zt.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len:NaN},t.createPlaylistLoader=function(){var e=this.config.pLoader,t=this.applyPlaylistData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e)}var a=e.prototype;return a.destroy=function(){this.loader.destroy()},a.abort=function(){this.loader.abort()},a.load=function(e,r,n){t(e),this.loader.load(e,r,n)},n(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}])}()},t.createFragmentLoader=function(){var e=this.config.fLoader,t=this.applyFragmentData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e)}var a=e.prototype;return a.destroy=function(){this.loader.destroy()},a.abort=function(){this.loader.abort()},a.load=function(e,r,n){t(e),this.loader.load(e,r,n)},n(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}])}()},e}(),cs=function(e){function t(t){var r;return(r=e.call(this,"content-steering",t.logger)||this).hls=void 0,r.loader=null,r.uri=null,r.pathwayId=".",r._pathwayPriority=null,r.timeToLoad=300,r.reloadTimer=-1,r.updated=0,r.started=!1,r.enabled=!0,r.levels=null,r.audioTracks=null,r.subtitleTracks=null,r.penalizedPathways={},r.hls=t,r.registerListeners(),r}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.ERROR,this.onError,this))},r.pathways=function(){return(this.levels||[]).reduce((function(e,t){return-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e}),[])},r.startLoad=function(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){var e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}},r.stopLoad=function(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()},r.clearTimeout=function(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)},r.destroy=function(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null},r.removeLevel=function(e){var t=this.levels;t&&(this.levels=t.filter((function(t){return t!==e})))},r.onManifestLoading=function(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null},r.onManifestLoaded=function(e,t){var r=t.contentSteering;null!==r&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())},r.onManifestParsed=function(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks},r.onError=function(e,t){var r=t.errorAction;if(2===(null==r?void 0:r.action)&&1===r.flags){var n=this.levels,a=this._pathwayPriority,i=this.pathwayId;if(t.context){var s=t.context,o=s.groupId,l=s.pathwayId,u=s.type;o&&n?i=this.getPathwayForGroupId(o,u,i):l&&(i=l)}i in this.penalizedPathways||(this.penalizedPathways[i]=performance.now()),!a&&n&&(a=this.pathways()),a&&a.length>1&&(this.updatePathwayPriority(a),r.resolved=this.pathwayId!==i),t.details!==S.BUFFER_APPEND_ERROR||t.fatal?r.resolved||this.warn("Could not resolve "+t.details+' ("'+t.error.message+'") with content-steering for Pathway: '+i+" levels: "+(n?n.length:n)+" priorities: "+rt(a)+" penalized: "+rt(this.penalizedPathways)):r.resolved=!0}},r.filterParsedLevels=function(e){this.levels=e;var t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){var r=e[0].pathwayId;this.log("No levels found in Pathway "+this.pathwayId+'. Setting initial Pathway to "'+r+'"'),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log("Found "+t.length+"/"+e.length+' levels in Pathway "'+this.pathwayId+'"'),t},r.getLevelsForPathway=function(e){return null===this.levels?[]:this.levels.filter((function(t){return e===t.pathwayId}))},r.updatePathwayPriority=function(e){var t;this._pathwayPriority=e;var r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach((function(e){n-r[e]>3e5&&delete r[e]}));for(var a=0;a<e.length;a++){var i=e[a];if(!(i in r)){if(i===this.pathwayId)return;var s=this.hls.nextLoadLevel,o=this.hls.levels[s];if((t=this.getLevelsForPathway(i)).length>0){this.log('Setting Pathway to "'+i+'"'),this.pathwayId=i,Qr(t),this.hls.trigger(P.LEVELS_UPDATED,{levels:t});var l=this.hls.levels[s];o&&l&&this.levels&&(l.attrs["STABLE-VARIANT-ID"]!==o.attrs["STABLE-VARIANT-ID"]&&l.bitrate!==o.bitrate&&this.log("Unstable Pathways change from bitrate "+o.bitrate+" to "+l.bitrate),this.hls.nextLoadLevel=s);break}}}},r.getPathwayForGroupId=function(e,t,r){for(var n=this.getLevelsForPathway(r).concat(this.levels||[]),a=0;a<n.length;a++)if(t===I&&n[a].hasAudioGroup(e)||t===w&&n[a].hasSubtitleGroup(e))return n[a].pathwayId;return r},r.clonePathways=function(e){var t=this,r=this.levels;if(r){var n={},a={};e.forEach((function(e){var i=e.ID,s=e["BASE-ID"],o=e["URI-REPLACEMENT"];if(!r.some((function(e){return e.pathwayId===i}))){var l=t.getLevelsForPathway(s).map((function(e){var t=new tr(e.attrs);t["PATHWAY-ID"]=i;var r=t.AUDIO&&t.AUDIO+"_clone_"+i,s=t.SUBTITLES&&t.SUBTITLES+"_clone_"+i;r&&(n[t.AUDIO]=r,t.AUDIO=r),s&&(a[t.SUBTITLES]=s,t.SUBTITLES=s);var l=ps(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",o),u=new et({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(var c=1;c<e.audioGroups.length;c++)u.addGroupId("audio",e.audioGroups[c]+"_clone_"+i);if(e.subtitleGroups)for(var d=1;d<e.subtitleGroups.length;d++)u.addGroupId("text",e.subtitleGroups[d]+"_clone_"+i);return u}));r.push.apply(r,l),ds(t.audioTracks,n,o,i),ds(t.subtitleTracks,a,o,i)}}))}},r.loadSteeringManifest=function(e){var t,r=this,n=this.hls.config,a=n.loader;this.loader&&this.loader.destroy(),this.loader=new a(n);try{t=new self.URL(e)}catch(t){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: "+e)}if("data:"!==t.protocol){var i=0|(this.hls.bandwidthEstimate||n.abrEwmaDefaultEstimate);t.searchParams.set("_HLS_pathway",this.pathwayId),t.searchParams.set("_HLS_throughput",""+i)}var s={responseType:"json",url:t.href},o=n.steeringManifestLoadPolicy.default,l=o.errorRetry||o.timeoutRetry||{},u={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},c={onSuccess:function(e,n,a,i){r.log('Loaded steering manifest: "'+t+'"');var s=e.data;if(1===(null==s?void 0:s.VERSION)){r.updated=performance.now(),r.timeToLoad=s.TTL;var o=s["RELOAD-URI"],l=s["PATHWAY-CLONES"],u=s["PATHWAY-PRIORITY"];if(o)try{r.uri=new self.URL(o,t).href}catch(e){return r.enabled=!1,void r.log("Failed to parse Steering Manifest RELOAD-URI: "+o)}r.scheduleRefresh(r.uri||a.url),l&&r.clonePathways(l);var c={steeringManifest:s,url:t.toString()};r.hls.trigger(P.STEERING_MANIFEST_LOADED,c),u&&r.updatePathwayPriority(u)}else r.log("Steering VERSION "+s.VERSION+" not supported!")},onError:function(e,t,n,a){if(r.log("Error loading steering manifest: "+e.code+" "+e.text+" ("+t.url+")"),r.stopLoad(),410===e.code)return r.enabled=!1,void r.log("Steering manifest "+t.url+" no longer available");var i=1e3*r.timeToLoad;if(429!==e.code)r.scheduleRefresh(r.uri||t.url,i);else{var s=r.loader;if("function"==typeof(null==s?void 0:s.getResponseHeader)){var o=s.getResponseHeader("Retry-After");o&&(i=1e3*parseFloat(o))}r.log("Steering manifest "+t.url+" rate limited")}},onTimeout:function(e,t,n){r.log("Timeout loading steering manifest ("+t.url+")"),r.scheduleRefresh(r.uri||t.url)}};this.log("Requesting steering manifest: "+t),this.loader.load(s,u,c)},r.scheduleRefresh=function(e,t){var r=this;void 0===t&&(t=1e3*this.timeToLoad),this.clearTimeout(),this.reloadTimer=self.setTimeout((function(){var t,n=null==(t=r.hls)?void 0:t.media;!n||n.ended?r.scheduleRefresh(e,1e3*r.timeToLoad):r.loadSteeringManifest(e)}),t)},n(t,[{key:"pathwayPriority",get:function(){return this._pathwayPriority},set:function(e){this.updatePathwayPriority(e)}}])}(N);function ds(e,t,r,n){e&&Object.keys(t).forEach((function(a){var s=e.filter((function(e){return e.groupId===a})).map((function(e){var s=i({},e);return s.details=void 0,s.attrs=new tr(s.attrs),s.url=s.attrs.URI=ps(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",r),s.groupId=s.attrs["GROUP-ID"]=t[a],s.attrs["PATHWAY-ID"]=n,s}));e.push.apply(e,s)}))}function ps(e,t,r,n){var a,i=n.HOST,s=n.PARAMS,o=n[r];t&&(a=null==o?void 0:o[t])&&(e=a);var l=new self.URL(e);return i&&!a&&(l.host=i),s&&Object.keys(s).sort().forEach((function(e){e&&l.searchParams.set(e,s[e])})),l.href}var hs=function(e){function t(r){var n;return(n=e.call(this,"eme",r.logger)||this).hls=void 0,n.config=void 0,n.media=null,n.keyFormatPromise=null,n.keySystemAccessPromises={},n._requestLicenseFailureCount=0,n.mediaKeySessions=[],n.keyIdToKeySessionPromise={},n.mediaKeys=null,n.setMediaKeysQueue=t.CDMCleanupPromise?[t.CDMCleanupPromise]:[],n.bannedKeyIds={},n.onMediaEncrypted=function(e){var t=e.initDataType,r=e.initData,a='"'+e.type+'" event: init data type: "'+t+'"';if(n.debug(a),null!==r){if(!n.keyFormatPromise){var i=Object.keys(n.keySystemAccessPromises);i.length||(i=kr(n.config));var s=i.map(_r).filter((function(e){return!!e}));n.keyFormatPromise=n.getKeyFormatPromise(s)}n.keyFormatPromise.then((function(i){var s=vr(i);if("sinf"===t&&s===hr.FAIRPLAY){var o;try{var l=oe(new Uint8Array(r)),u=ke(ur(JSON.parse(l).sinf));if(!u)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");o=new Uint8Array(u.subarray(8,24))}catch(e){return void n.warn(a+" Failed to parse sinf: "+e)}for(var c,d=z(o),p=n,h=p.keyIdToKeySessionPromise,f=p.mediaKeySessions,m=h[d],g=function(){var e=f[y],a=e.decryptdata;if(!a.keyId)return 0;var i=z(a.keyId);return ir(o,a.keyId)||-1!==a.uri.replace(/-/g,"").indexOf(d)?(m=h[i])?(a.pssh||(delete h[i],a.pssh=new Uint8Array(r),a.keyId=o,(m=h[d]=m.then((function(){return n.generateRequestWithPreferredKeySession(e,t,r,"encrypted-event-key-match")}))).catch((function(e){return n.handleError(e)}))),1):0:void 0},y=0;y<f.length&&(0===(c=g())||1!==c);y++);m||n.handleError(new Error("Key ID "+d+" not encountered in playlist. Key-system sessions "+f.length+"."))}else n.log('Ignoring "'+e.type+'" event with init data type: "'+t+'" for selected key-system '+s)})).catch((function(e){return n.handleError(e)}))}},n.onWaitingForKey=function(e){n.log('"'+e.type+'" event')},n.hls=r,n.config=r.config,n.registerListeners(),n}o(t,e);var r=t.prototype;return r.destroy=function(){this.onDestroying(),this.onMediaDetached();var e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null},r.registerListeners=function(){this.hls.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(P.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(P.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(P.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(P.DESTROYING,this.onDestroying,this)},r.unregisterListeners=function(){this.hls.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(P.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(P.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(P.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(P.DESTROYING,this.onDestroying,this)},r.getLicenseServerUrl=function(e){var t=this.config,r=t.drmSystems,n=t.widevineLicenseUrl,a=null==r?void 0:r[e];return a?a.licenseUrl:e===hr.WIDEVINE&&n?n:void 0},r.getLicenseServerUrlOrThrow=function(e){var t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error('no license server URL configured for key-system "'+e+'"');return t},r.getServerCertificateUrl=function(e){var t=this.config.drmSystems,r=null==t?void 0:t[e];if(r)return r.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+e+'"]')},r.attemptKeySystemAccess=function(e){var t=this,r=this.hls.levels,n=function(e,t,r){return!!e&&r.indexOf(e)===t},a=r.map((function(e){return e.audioCodec})).filter(n),i=r.map((function(e){return e.videoCodec})).filter(n);return a.length+i.length===0&&i.push("avc1.42e01e"),new Promise((function(r,n){var s=function(e){var o=e.shift();t.getMediaKeysPromise(o,a,i).then((function(e){return r({keySystem:o,mediaKeys:e})})).catch((function(t){e.length?s(e):n(t instanceof gs?t:new gs({type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))};s(e)}))},r.requestMediaKeySystemAccess=function(e,t){var r=this.config.requestMediaKeySystemAccessFunc;if("function"!=typeof r){var n="Configured requestMediaKeySystemAccess is not a function "+r;return null===br&&"http:"===self.location.protocol&&(n="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(n))}return r(e,t)},r.getMediaKeysPromise=function(e,t,r){var n,a=this,i=function(e,t,r,n){var a;switch(e){case hr.FAIRPLAY:a=["cenc","sinf"];break;case hr.WIDEVINE:case hr.PLAYREADY:a=["cenc"];break;case hr.CLEARKEY:a=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+e)}return function(e,t,r,n){return[{initDataTypes:e,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:t.map((function(e){return{contentType:"audio/mp4; codecs="+e,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null}})),videoCapabilities:r.map((function(e){return{contentType:"video/mp4; codecs="+e,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}}))}]}(a,t,r,n)}(e,t,r,this.config.drmSystemOptions||{}),s=this.keySystemAccessPromises[e],o=null==(n=s)?void 0:n.keySystemAccess;if(!o){this.log('Requesting encrypted media "'+e+'" key-system access with config: '+rt(i)),o=this.requestMediaKeySystemAccess(e,i);var l=s=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch((function(t){a.log('Failed to obtain access to key-system "'+e+'": '+t)})),o.then((function(t){a.log('Access for key-system "'+t.keySystem+'" obtained');var r=a.fetchServerCertificate(e);a.log('Create media-keys for "'+e+'"');var n=l.mediaKeys=t.createMediaKeys().then((function(t){return a.log('Media-keys created for "'+e+'"'),l.hasMediaKeys=!0,r.then((function(r){return r?a.setMediaKeysServerCertificate(t,e,r):t}))}));return n.catch((function(t){a.error('Failed to create media-keys for "'+e+'"}: '+t)})),n}))}return o.then((function(){return s.mediaKeys}))},r.createMediaKeySessionContext=function(e){var t=e.decryptdata,r=e.keySystem,n=e.mediaKeys;this.log('Creating key-system session "'+r+'" keyId: '+z(t.keyId||[])+" keyUri: "+t.uri);var a=n.createSession(),i={decryptdata:t,keySystem:r,mediaKeys:n,mediaKeysSession:a,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i},r.renewKeySession=function(e){var t=e.decryptdata;if(t.pssh){var r=this.createMediaKeySessionContext(e),n=fs(t);this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,"cenc",t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)},r.updateKeySession=function(e,t){var r=e.mediaKeysSession;return this.log('Updating key-session "'+r.sessionId+'" for keyId '+z(e.decryptdata.keyId||[])+"\n      } (data length: "+t.byteLength+")"),r.update(t)},r.getSelectedKeySystemFormats=function(){var e=this;return Object.keys(this.keySystemAccessPromises).map((function(t){return{keySystem:t,hasMediaKeys:e.keySystemAccessPromises[t].hasMediaKeys}})).filter((function(e){return!!e.hasMediaKeys})).map((function(e){return _r(e.keySystem)})).filter((function(e){return!!e}))},r.getKeySystemAccess=function(e){var t=this;return this.getKeySystemSelectionPromise(e).then((function(e){var r=e.keySystem,n=e.mediaKeys;return t.attemptSetMediaKeys(r,n)}))},r.selectKeySystem=function(e){var t=this;return new Promise((function(r,n){t.getKeySystemSelectionPromise(e).then((function(e){var t=e.keySystem,a=_r(t);a?r(a):n(new Error('Unable to find format for key-system "'+t+'"'))})).catch(n)}))},r.selectKeySystemFormat=function(e){var t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+e.sn+" "+e.type+": "+e.level+") key formats "+t.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise},r.getKeyFormatPromise=function(e){var t=kr(this.config),r=e.map(vr).filter((function(e){return!!e&&-1!==t.indexOf(e)}));return this.selectKeySystem(r)},r.getKeyStatus=function(e){for(var t=this.mediaKeySessions,r=0;r<t.length;r++){var n=ms(e,t[r]);if(n)return n}},r.loadKey=function(e){var t=this,r=e.keyInfo.decryptdata,n=fs(r),a=this.bannedKeyIds[n];if(a||"internal-error"===this.getKeyStatus(r)){var i=ys(a||"internal-error",r);return this.handleError(i,e.frag),Promise.reject(i)}var s="(keyId: "+n+' format: "'+r.keyFormat+'" method: '+r.method+" uri: "+r.uri+")";this.log("Starting session for key "+s);var o=this.keyIdToKeySessionPromise[n];if(!o){var l=this.getKeySystemForKeyPromise(r).then((function(n){var a=n.keySystem,i=n.mediaKeys;return t.throwIfDestroyed(),t.log("Handle encrypted media sn: "+e.frag.sn+" "+e.frag.type+": "+e.frag.level+" using key "+s),t.attemptSetMediaKeys(a,i).then((function(){return t.throwIfDestroyed(),t.createMediaKeySessionContext({keySystem:a,mediaKeys:i,decryptdata:r})}))})).then((function(e){var n=r.pssh?r.pssh.buffer:null;return t.generateRequestWithPreferredKeySession(e,"cenc",n,"playlist-key")}));return l.catch((function(r){return t.handleError(r,e.frag)})),this.keyIdToKeySessionPromise[n]=l,l}return o.catch((function(n){if(n instanceof gs){var a=c({},n.data);"internal-error"===t.getKeyStatus(r)&&(a.decryptdata=r);var i=new gs(a,n.message);t.handleError(i,e.frag)}})),o},r.throwIfDestroyed=function(e){if(!this.hls)throw new Error("invalid state")},r.handleError=function(e,t){if(this.hls)if(e instanceof gs){t&&(e.data.frag=t);var r=e.data.decryptdata;this.error(e.message+(r?" ("+z(r.keyId||[])+")":"")),this.hls.trigger(P.ERROR,e.data)}else this.error(e.message),this.hls.trigger(P.ERROR,{type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})},r.getKeySystemForKeyPromise=function(e){var t=fs(e),r=this.keyIdToKeySessionPromise[t];if(!r){var n=vr(e.keyFormat),a=n?[n]:kr(this.config);return this.attemptKeySystemAccess(a)}return r},r.getKeySystemSelectionPromise=function(e){if(e.length||(e=kr(this.config)),0===e.length)throw new gs({type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+rt({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(e)},r.attemptSetMediaKeys=function(e,t){var r=this;if(this.mediaKeys===t)return Promise.resolve();var n=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+e+'"');var a=Promise.all(n).then((function(){if(!r.media)throw r.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return r.media.setMediaKeys(t)}));return this.mediaKeys=t,this.setMediaKeysQueue.push(a),a.then((function(){r.log('Media-keys set for "'+e+'"'),n.push(a),r.setMediaKeysQueue=r.setMediaKeysQueue.filter((function(e){return-1===n.indexOf(e)}))}))},r.generateRequestWithPreferredKeySession=function(e,t,r,n){var a,i=this,s=null==(a=this.config.drmSystems)||null==(a=a[e.keySystem])?void 0:a.generateRequest;if(s)try{var o=s.call(this.hls,t,r,e);if(!o)throw new Error("Invalid response from configured generateRequest filter");t=o.initDataType,r=o.initData?o.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(e){if(this.warn(e.message),this.hls&&this.hls.config.debug)throw e}if(null===r)return this.log('Skipping key-session request for "'+n+'" (no initData)'),Promise.resolve(e);var l=fs(e.decryptdata),u=e.decryptdata.uri;this.log('Generating key-session request for "'+n+'" keyId: '+l+" URI: "+u+" (init data type: "+t+" length: "+r.byteLength+")");var c=new v,d=e._onmessage=function(t){var r=e.mediaKeysSession;if(r){var n=t.messageType,a=t.message;i.log('"'+n+'" message event for session "'+r.sessionId+'" message size: '+a.byteLength),"license-request"===n||"license-renewal"===n?i.renewLicense(e,a).catch((function(e){c.eventNames().length?c.emit("error",e):i.handleError(e)})):"license-release"===n?e.keySystem===hr.FAIRPLAY&&i.updateKeySession(e,cr("acknowledged")).then((function(){return i.removeSession(e)})).catch((function(e){return i.handleError(e)})):i.warn('unhandled media key message type "'+n+'"')}else c.emit("error",new Error("invalid state"))},p=function(e,t){var r;t.keyStatus=e,e.startsWith("usable")?c.emit("resolved"):"internal-error"===e||"output-restricted"===e||"output-downscaled"===e?r=ys(e,t.decryptdata):"expired"===e?r=new Error("key expired (keyId: "+l+")"):"released"===e?r=new Error("key released"):"status-pending"===e||i.warn('unhandled key status change "'+e+'" (keyId: '+l+")"),r&&(c.eventNames().length?c.emit("error",r):i.handleError(r))},h=e._onkeystatuseschange=function(t){if(e.mediaKeysSession){var r=i.getKeyStatuses(e);if(Object.keys(r).some((function(e){return"status-pending"!==r[e]}))){if("expired"===r[l])return i.log("Expired key "+rt(r)+' in key-session "'+e.mediaKeysSession.sessionId+'"'),void i.renewKeySession(e);var n,a=r[l];a?p(a,e):(e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(n=e.keyStatusTimeouts)[l]||(n[l]=self.setTimeout((function(){if(e.mediaKeysSession&&i.mediaKeys){var t=i.getKeyStatus(e.decryptdata);if(t&&"status-pending"!==t)return i.log("No status for keyId "+l+' in key-session "'+e.mediaKeysSession.sessionId+'". Using session key-status '+t+" from other session."),p(t,e);i.log("key status for "+l+' in key-session "'+e.mediaKeysSession.sessionId+'" timed out after 0ms'),p(a="internal-error",e)}}),0)),i.log("No status for keyId "+l+" ("+rt(r)+")."))}}else c.emit("error",new Error("invalid state"))};on(e.mediaKeysSession,"message",d),on(e.mediaKeysSession,"keystatuseschange",h);var f=new Promise((function(e,t){c.on("error",t),c.on("resolved",e)}));return e.mediaKeysSession.generateRequest(t,r).then((function(){i.log('Request generated for key-session "'+e.mediaKeysSession.sessionId+'" keyId: '+l+" URI: "+u)})).catch((function(t){throw new gs({type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_NO_SESSION,error:t,decryptdata:e.decryptdata,fatal:!1},"Error generating key-session request: "+t)})).then((function(){return f})).catch((function(t){return c.removeAllListeners(),i.removeSession(e).then((function(){throw t}))})).then((function(){return c.removeAllListeners(),e}))},r.getKeyStatuses=function(e){var t=this,r={};return e.mediaKeysSession.keyStatuses.forEach((function(n,a){if("string"==typeof a&&"object"==typeof n){var i=a;a=n,n=i}var s="buffer"in a?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):new Uint8Array(a);e.keySystem===hr.PLAYREADY&&16===s.length&&dr(s);var o=z(s);"internal-error"===n&&(t.bannedKeyIds[o]=n),t.log('key status change "'+n+'" for keyStatuses keyId: '+o+' key-session "'+e.mediaKeysSession.sessionId+'"'),r[o]=n})),r},r.fetchServerCertificate=function(e){var t=this.config,r=new(0,t.loader)(t),n=this.getServerCertificateUrl(e);return n?(this.log('Fetching server certificate for "'+e+'"'),new Promise((function(a,i){var s={responseType:"arraybuffer",url:n},o=t.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:function(e,t,r,n){a(e.data)},onError:function(t,r,a,o){i(new gs({type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:c({url:s.url,data:void 0},t)},'"'+e+'" certificate request failed ('+n+"). Status: "+t.code+" ("+t.text+")"))},onTimeout:function(t,r,a){i(new gs({type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:s.url,data:void 0}},'"'+e+'" certificate request timed out ('+n+")"))},onAbort:function(e,t,r){i(new Error("aborted"))}};r.load(s,l,u)}))):Promise.resolve()},r.setMediaKeysServerCertificate=function(e,t,r){var n=this;return new Promise((function(a,i){e.setServerCertificate(r).then((function(i){n.log("setServerCertificate "+(i?"success":"not supported by CDM")+" ("+r.byteLength+') on "'+t+'"'),a(e)})).catch((function(e){i(new gs({type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))},r.renewLicense=function(e,t){var r=this;return this.requestLicense(e,new Uint8Array(t)).then((function(t){return r.updateKeySession(e,new Uint8Array(t)).catch((function(t){throw new gs({type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:t,fatal:!1},t.message)}))}))},r.unpackPlayReadyKeyMessage=function(e,t){var r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;var n=(new DOMParser).parseFromString(r,"application/xml"),a=n.querySelectorAll("HttpHeader");if(a.length>0)for(var i,s=0,o=a.length;s<o;s++){var l,u,c=null==(l=(i=a[s]).querySelector("name"))?void 0:l.textContent,d=null==(u=i.querySelector("value"))?void 0:u.textContent;c&&d&&e.setRequestHeader(c,d)}var p=n.querySelector("Challenge"),h=null==p?void 0:p.textContent;if(!h)throw new Error("Cannot find <Challenge> in key message");return cr(atob(h))},r.setupLicenseXHR=function(e,t,r,n){var a=this,i=this.config.licenseXhrSetup;return i?Promise.resolve().then((function(){if(!r.decryptdata)throw new Error("Key removed");return i.call(a.hls,e,t,r,n)})).catch((function(s){if(!r.decryptdata)throw s;return e.open("POST",t,!0),i.call(a.hls,e,t,r,n)})).then((function(r){return e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:r||n}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))},r.requestLicense=function(e,t){var r=this,n=this.config.keyLoadPolicy.default;return new Promise((function(a,i){var s=r.getLicenseServerUrlOrThrow(e.keySystem);r.log("Sending license request to URL: "+s);var o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=function(){if(!r.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(4===o.readyState)if(200===o.status){r._requestLicenseFailureCount=0;var l=o.response;r.log("License received "+(l instanceof ArrayBuffer?l.byteLength:l));var u=r.config.licenseResponseCallback;if(u)try{l=u.call(r.hls,o,s,e)}catch(e){r.error(e)}a(l)}else{var c=n.errorRetry,d=c?c.maxNumRetry:0;if(r._requestLicenseFailureCount++,r._requestLicenseFailureCount>d||o.status>=400&&o.status<500)i(new gs({type:A.KEY_SYSTEM_ERROR,details:S.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:o,response:{url:s,data:void 0,code:o.status,text:o.statusText}},"License Request XHR failed ("+s+"). Status: "+o.status+" ("+o.statusText+")"));else{var p=d-r._requestLicenseFailureCount+1;r.warn("Retrying license request, "+p+" attempts left"),r.requestLicense(e,t).then(a,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,r.setupLicenseXHR(o,s,e,t).then((function(t){var n=t.xhr,a=t.licenseChallenge;e.keySystem==hr.PLAYREADY&&(a=r.unpackPlayReadyKeyMessage(n,a)),n.send(a)})).catch(i)}))},r.onDestroying=function(){this.unregisterListeners(),this._clear()},r.onMediaAttached=function(e,t){if(this.config.emeEnabled){var r=t.media;this.media=r,on(r,"encrypted",this.onMediaEncrypted),on(r,"waitingforkey",this.onWaitingForKey)}},r.onMediaDetached=function(){var e=this.media;e&&(ln(e,"encrypted",this.onMediaEncrypted),ln(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)},r._clear=function(){var e,r=this;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},this.mediaKeys||this.mediaKeySessions.length){var n=this.media,a=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Ar.clearKeyUriToKeyIdMap();var i=a.length;t.CDMCleanupPromise=Promise.all(a.map((function(e){return r.removeSession(e)})).concat((null==n||null==(e=n.setMediaKeys(null))?void 0:e.catch((function(e){r.log("Could not clear media keys: "+e),r.hls&&r.hls.trigger(P.ERROR,{type:A.OTHER_ERROR,details:S.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error("Could not clear media keys: "+e)})})))||Promise.resolve())).catch((function(e){r.log("Could not close sessions and clear media keys: "+e),r.hls&&r.hls.trigger(P.ERROR,{type:A.OTHER_ERROR,details:S.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close sessions and clear media keys: "+e)})})).then((function(){i&&r.log("finished closing key sessions and clearing media keys")}))}},r.onManifestLoading=function(){this.keyFormatPromise=null,this.bannedKeyIds={}},r.onManifestLoaded=function(e,t){var r=t.sessionKeys;if(r&&this.config.emeEnabled&&!this.keyFormatPromise){var n=r.reduce((function(e,t){return-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e}),[]);this.log("Selecting key-system from session-keys "+n.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(n)}},r.removeSession=function(e){var t=this,r=e.mediaKeysSession,n=e.licenseXhr,a=e.decryptdata;if(r){this.log('Remove licenses and keys and close session "'+r.sessionId+'" keyId: '+z((null==a?void 0:a.keyId)||[])),e._onmessage&&(r.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(r.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;var i=this.mediaKeySessions.indexOf(e);i>-1&&this.mediaKeySessions.splice(i,1);var s=e.keyStatusTimeouts;s&&Object.keys(s).forEach((function(e){return self.clearTimeout(s[e])}));var o=function(e){var t;return!(!e||"persistent-license"!==e.sessionType&&(null==(t=e.sessionTypes)||!t.some((function(e){return"persistent-license"===e}))))}(this.config.drmSystemOptions)?new Promise((function(e,t){self.setTimeout((function(){return t(new Error("MediaKeySession.remove() timeout"))}),8e3),r.remove().then(e).catch(t)})):Promise.resolve();return o.catch((function(e){t.log("Could not remove session: "+e),t.hls&&t.hls.trigger(P.ERROR,{type:A.OTHER_ERROR,details:S.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error("Could not remove session: "+e)})})).then((function(){return r.close()})).catch((function(e){t.log("Could not close session: "+e),t.hls&&t.hls.trigger(P.ERROR,{type:A.OTHER_ERROR,details:S.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close session: "+e)})}))}return Promise.resolve()},t}(N);function fs(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return z(e.keyId)}function ms(e,t){return e.keyId&&t.mediaKeysSession.keyStatuses.has(e.keyId)?t.mediaKeysSession.keyStatuses.get(e.keyId):e.matches(t.decryptdata)?t.keyStatus:void 0}hs.CDMCleanupPromise=void 0;var gs=function(e){function t(t,r){var n;return(n=e.call(this,r)||this).data=void 0,t.error||(t.error=new Error(r)),n.data=t,t.err=t.error,n}return o(t,e),t}(h(Error));function ys(e,t){var r="output-restricted"===e,n=r?S.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:S.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new gs({type:A.KEY_SYSTEM_ERROR,details:n,fatal:!1,decryptdata:t},r?"HDCP level output restricted":'key status changed to "'+e+'"')}var vs=function(){function e(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.registerListeners=function(){this.hls.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(P.MEDIA_DETACHING,this.onMediaDetaching,this)},t.unregisterListeners=function(){this.hls.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(P.MEDIA_DETACHING,this.onMediaDetaching,this)},t.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},t.onMediaAttaching=function(e,t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&"function"==typeof n.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}},t.onMediaDetaching=function(){this.media=null},t.checkFPS=function(e,t,r){var n=performance.now();if(t){if(this.lastTime){var a=n-this.lastTime,i=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*i/a,l=this.hls;if(l.trigger(P.FPS_DROP,{currentDropped:i,currentDecoded:s,totalDroppedFrames:r}),o>0&&i>l.config.fpsDroppedMonitoringThreshold*s){var u=l.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(P.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},t.checkFPSInterval=function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},e}();function _s(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()}var ks=.025,Es=function(e){return e[e.Point=0]="Point",e[e.Range=1]="Range",e}({});function bs(e,t,r){return e.identifier+"-"+(r+1)+"-"+_s(t)}var Ts=function(){function e(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}var t=e.prototype;return t.setDateRange=function(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)},t.reset=function(){var e;this.appendInPlaceStarted=!1,null==(e=this.assetListLoader)||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)},t.isAssetPastPlayoutLimit=function(e){var t;if(e>0&&e>=this.assetList.length)return!0;var r=this.playoutLimit;return!(e<=0||isNaN(r))&&(0===r||((null==(t=this.assetList[e])?void 0:t.startOffset)||0)>r)},t.findAssetIndex=function(e){return this.assetList.indexOf(e)},t.toString=function(){return'["'+(e=this).identifier+'" '+(e.cue.pre?"<pre>":e.cue.post?"<post>":"")+e.timelineStart.toFixed(2)+"-"+e.resumeTime.toFixed(2)+"]";var e},n(e,[{key:"identifier",get:function(){return this.dateRange.id}},{key:"startDate",get:function(){return this.dateRange.startDate}},{key:"startTime",get:function(){var e=this.dateRange.startTime;if(this.snapOptions.out){var t=this.dateRange.tagAnchor;if(t)return As(e,t)}return e}},{key:"startOffset",get:function(){return this.cue.pre?0:this.startTime}},{key:"startIsAligned",get:function(){if(0===this.startTime||this.snapOptions.out)return!0;var e=this.dateRange.tagAnchor;if(e){var t=this.dateRange.startTime;return t-As(t,e)<.1}return!1}},{key:"resumptionOffset",get:function(){var e=this.resumeOffset,t=E(e)?e:this.duration;return this.cumulativeDuration+t}},{key:"resumeTime",get:function(){var e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){var t=this.resumeAnchor;if(t)return As(e,t)}return e}},{key:"appendInPlace",get:function(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<ks))},set:function(e){this.appendInPlaceStarted?this.resetOnResume=!e:this.appendInPlaceDisabled=!e}},{key:"timelineStart",get:function(){return null!==this._timelineStart?this._timelineStart:this.startTime},set:function(e){this._timelineStart=e}},{key:"duration",get:function(){var e,t=this.playoutLimit;return e=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e},set:function(e){this._duration=e}},{key:"cue",get:function(){return this.dateRange.cue}},{key:"timelineOccupancy",get:function(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?Es.Range:Es.Point}},{key:"supplementsPrimary",get:function(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}},{key:"contentMayVary",get:function(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}},{key:"assetUrl",get:function(){return this.dateRange.attr["X-ASSET-URI"]}},{key:"assetListUrl",get:function(){return this.dateRange.attr["X-ASSET-LIST"]}},{key:"baseUrl",get:function(){return this.base.url}},{key:"assetListLoaded",get:function(){return this.assetList.length>0||null!==this.assetListResponse}}])}();function As(e,t){return e-t.start<t.duration/2&&!(Math.abs(e-(t.start+t.duration))<ks)?t.start:t.start+t.duration}function Ss(e,t,r){var n=new self.URL(e,r);return"data:"!==n.protocol&&n.searchParams.set("_HLS_primary_id",t),n}function Ps(e,t){for(;null!=(r=e.assetList[++t])&&r.error;)var r;return t}function Cs(e){var t=e.timelineStart,r=e.duration||0;return'["'+e.identifier+'" '+t.toFixed(2)+"-"+(t+r).toFixed(2)+"]"}var xs=function(){function e(e,t,r,n){var a=this;this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=function(){a.reachedPlayout(a.currentTime)&&a.hls&&a.hls.trigger(P.PLAYOUT_LIMIT_REACHED,{})};var i=this.hls=new e(t);this.interstitial=r,this.assetItem=n;var s=function(){a.hasDetails=!0};i.once(P.LEVEL_LOADED,s),i.once(P.AUDIO_TRACK_LOADED,s),i.once(P.SUBTITLE_TRACK_LOADED,s),i.on(P.MEDIA_ATTACHING,(function(e,t){var r=t.media;a.removeMediaListeners(),a.mediaAttached=r,a.interstitial.playoutLimit&&(r.addEventListener("timeupdate",a.checkPlayout),a.appendInPlace&&i.on(P.BUFFER_APPENDED,(function(){var e=a.bufferedEnd;a.reachedPlayout(e)&&(a._bufferedEosTime=e,i.trigger(P.BUFFERED_TO_END,void 0))})))}))}var t=e.prototype;return t.loadSource=function(){var e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{var t=this.assetItem.uri;try{t=Ss(t,e.config.primarySessionId||"").href}catch(e){}e.loadSource(t)}},t.bufferedInPlaceToEnd=function(e){var t;if(!this.appendInPlace)return!1;if(null!=(t=this.hls)&&t.bufferedToEnd)return!0;if(!e)return!1;var r=Math.min(this._bufferedEosTime||1/0,this.duration),n=this.timelineOffset,a=zt.bufferInfo(e,n,0);return this.getAssetTime(a.end)>=r-.02},t.reachedPlayout=function(e){var t=this.interstitial.playoutLimit;return this.startOffset+e>=t},t.getAssetTime=function(e){var t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)},t.removeMediaListeners=function(){var e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))},t.bufferSnapShot=function(){var e;this.mediaAttached&&null!=(e=this.hls)&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)},t.destroy=function(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null},t.attachMedia=function(e){var t;this.loadSource(),null==(t=this.hls)||t.attachMedia(e)},t.detachMedia=function(){var e;this.removeMediaListeners(),this.mediaAttached=null,null==(e=this.hls)||e.detachMedia()},t.resumeBuffering=function(){var e;null==(e=this.hls)||e.resumeBuffering()},t.pauseBuffering=function(){var e;null==(e=this.hls)||e.pauseBuffering()},t.transferMedia=function(){var e;return this.bufferSnapShot(),(null==(e=this.hls)?void 0:e.transferMedia())||null},t.resetDetails=function(){var e=this.hls;if(e&&this.hasDetails){e.stopLoad();var t=function(e){return delete e.details};e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}},t.on=function(e,t,r){var n;null==(n=this.hls)||n.on(e,t)},t.once=function(e,t,r){var n;null==(n=this.hls)||n.once(e,t)},t.off=function(e,t,r){var n;null==(n=this.hls)||n.off(e,t)},t.toString=function(){var e;return"HlsAssetPlayer: "+Cs(this.assetItem)+" "+(null==(e=this.hls)?void 0:e.sessionId)+" "+(this.appendInPlace?"append-in-place":"")},n(e,[{key:"appendInPlace",get:function(){return this.interstitial.appendInPlace}},{key:"destroyed",get:function(){var e;return!(null!=(e=this.hls)&&e.userConfig)}},{key:"assetId",get:function(){return this.assetItem.identifier}},{key:"interstitialId",get:function(){return this.assetItem.parentIdentifier}},{key:"media",get:function(){var e;return(null==(e=this.hls)?void 0:e.media)||null}},{key:"bufferedEnd",get:function(){var e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;var t=zt.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}},{key:"currentTime",get:function(){var e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}},{key:"duration",get:function(){var e=this.assetItem.duration;if(!e)return 0;var t=this.interstitial.playoutLimit;if(t){var r=t-this.startOffset;if(r>0&&r<e)return r}return e}},{key:"remaining",get:function(){var e=this.duration;return e?Math.max(0,e-this.currentTime):0}},{key:"startOffset",get:function(){return this.assetItem.startOffset}},{key:"timelineOffset",get:function(){var e;return(null==(e=this.hls)?void 0:e.config.timelineOffset)||0},set:function(e){var t=this.timelineOffset;if(e!==t){var r=e-t;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}}])}(),Is=function(e){function t(t,r){var n;return(n=e.call(this,"interstitials-sched",r)||this).onScheduleUpdate=void 0,n.eventMap={},n.events=null,n.items=null,n.durations={primary:0,playout:0,integrated:0},n.onScheduleUpdate=t,n}o(t,e);var r=t.prototype;return r.destroy=function(){this.reset(),this.onScheduleUpdate=null},r.reset=function(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach((function(e){return e.reset()})),this.events=this.items=null},r.resetErrorsInRange=function(e,t){return this.events?this.events.reduce((function(r,n){return e<=n.startOffset&&t>n.startOffset?(delete n.error,r+1):r}),0):0},r.getEvent=function(e){return e&&this.eventMap[e]||null},r.hasEvent=function(e){return e in this.eventMap},r.findItemIndex=function(e,t){if(e.event)return this.findEventIndex(e.event.identifier);var r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);var n=this.items;if(n)for(n[r]||(void 0===t&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&null!=(a=n[r])&&a.event;){var a;r--}return r},r.findItemIndexAtTime=function(e,t){var r=this.items;if(r)for(var n=0;n<r.length;n++){var a=r[n];if(t&&"primary"!==t&&(a=a[t]),e===a.start||e>a.start&&e<a.end)return n}return-1},r.findJumpRestrictedIndex=function(e,t){var r=this.items;if(r)for(var n=e;n<=t&&r[n];n++){var a=r[n].event;if(null!=a&&a.restrictions.jump&&!a.appendInPlace)return n}return-1},r.findEventIndex=function(e){var t=this.items;if(t)for(var r=t.length;r--;){var n;if((null==(n=t[r].event)?void 0:n.identifier)===e)return r}return-1},r.findAssetIndex=function(e,t){var r=e.assetList,n=r.length;if(n>1)for(var a=0;a<n;a++){var i=r[a];if(!i.error){var s=i.timelineStart;if(t===s||t>s&&(t<s+(i.duration||0)||a===n-1))return a}}return 0},r.parseInterstitialDateRanges=function(e,t){var r=this,n=e.main.details,a=n.dateRanges,i=this.events,s=this.parseDateRanges(a,{url:n.url},t),o=Object.keys(a),l=i?i.filter((function(e){return!o.includes(e.identifier)})):[];s.length&&s.sort((function(e,t){var r=e.cue.pre,n=e.cue.post,a=t.cue.pre,i=t.cue.post;if(r&&!a)return-1;if(a&&!r)return 1;if(n&&!i)return 1;if(i&&!n)return-1;if(!(r||a||n||i)){var s=e.startTime,o=t.startTime;if(s!==o)return s-o}return e.dateRange.tagOrder-t.dateRange.tagOrder})),this.events=s,l.forEach((function(e){r.removeEvent(e)})),this.updateSchedule(e,l)},r.updateSchedule=function(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=!1);var n=this.events||[];if(n.length||t.length||this.length<2){var a=this.items,i=this.parseSchedule(n,e);(r||t.length||(null==a?void 0:a.length)!==i.length||i.some((function(e,t){return Math.abs(e.playout.start-a[t].playout.start)>.005||Math.abs(e.playout.end-a[t].playout.end)>.005})))&&(this.items=i,this.onScheduleUpdate(t,a))}},r.parseDateRanges=function(e,t,r){for(var n=[],a=Object.keys(e),i=0;i<a.length;i++){var s=a[i],o=e[s];if(o.isInterstitial){var l=this.eventMap[s];l?l.setDateRange(o):(l=new Ts(o,t),this.eventMap[s]=l,!1===r&&(l.appendInPlace=r)),n.push(l)}}return n},r.parseSchedule=function(e,t){var r=[],n=t.main.details,a=n.live?1/0:n.edge,i=0;if((e=e.filter((function(e){return!(e.error||e.cue.once&&e.hasPlayed)}))).length){this.resolveOffsets(e,t);var s=0,o=0;if(e.forEach((function(t,n){var l=t.cue.pre,u=t.cue.post,c=e[n-1]||null,d=t.appendInPlace,p=u?a:t.startOffset,h=t.duration,f=t.timelineOccupancy===Es.Range?h:0,m=t.resumptionOffset,g=(null==c?void 0:c.startTime)===p,y=p+t.cumulativeDuration,v=d?y+h:p+m;if(l||!u&&p<=0){var _=o;o+=f,t.timelineStart=y;var k=i;i+=h,r.push({event:t,start:y,end:v,playout:{start:k,end:i},integrated:{start:_,end:o}})}else{if(!(p<=a))return;if(!g){var E=p-s;if(E>.033){var b=s,T=o;o+=E;var A=i;i+=E;var S={previousEvent:e[n-1]||null,nextEvent:t,start:b,end:b+E,playout:{start:A,end:i},integrated:{start:T,end:o}};r.push(S)}else E>0&&c&&(c.cumulativeDuration+=E,r[r.length-1].end=p)}u&&(v=y),t.timelineStart=y;var P=o;o+=f;var C=i;i+=h,r.push({event:t,start:y,end:v,playout:{start:C,end:i},integrated:{start:P,end:o}})}var x=t.resumeTime;s=u||x>a?a:x})),s<a){var l,u=s,c=o,d=a-s;o+=d;var p=i;i+=d,r.push({previousEvent:(null==(l=r[r.length-1])?void 0:l.event)||null,nextEvent:null,start:s,end:u+d,playout:{start:p,end:i},integrated:{start:c,end:o}})}this.setDurations(a,i,o)}else r.push({previousEvent:null,nextEvent:null,start:0,end:a,playout:{start:0,end:a},integrated:{start:0,end:a}}),this.setDurations(a,a,a);return r},r.setDurations=function(e,t,r){this.durations={primary:e,playout:t,integrated:r}},r.resolveOffsets=function(e,t){var r=this,n=t.main.details,a=n.live?1/0:n.edge,i=0,s=-1;e.forEach((function(o,l){var u=o.cue.pre,c=o.cue.post,d=u?0:c?a:o.startTime;r.updateAssetDurations(o),s===d?o.cumulativeDuration=i:(i=0,s=d),!c&&o.snapOptions.in&&(o.resumeAnchor=ht(null,n.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted&&(r.primaryCanResumeInPlaceAt(o,t)||(o.appendInPlace=!1)),!o.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<.033&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&r.warn("Could not change append strategy for abutting event "+o));var p=E(o.resumeOffset)?o.resumeOffset:o.duration;i+=p}))},r.primaryCanResumeInPlaceAt=function(e,t){var r=this,n=e.resumeTime,a=e.startTime+e.resumptionOffset;return Math.abs(n-a)>ks?(this.log('"'+e.identifier+'" resumption '+n+" not aligned with estimated timeline end "+a),!1):!Object.keys(t).some((function(a){var i=t[a].details,s=i.edge;if(n>=s)return r.log('"'+e.identifier+'" resumption '+n+" past "+a+" playlist end "+s),!1;var o=ht(null,i.fragments,n);if(!o)return r.log('"'+e.identifier+'" resumption '+n+" does not align with any fragments in "+a+" playlist ("+i.fragStart+"-"+i.fragmentEnd+")"),!0;var l="audio"===a?.175:0;return!(Math.abs(o.start-n)<ks+l||Math.abs(o.end-n)<ks+l||(r.log('"'+e.identifier+'" resumption '+n+" not aligned with "+a+" fragment bounds ("+o.start+"-"+o.end+" sn: "+o.sn+" cc: "+o.cc+")"),0))}))},r.updateAssetDurations=function(e){if(e.assetListLoaded){for(var t=e.timelineStart,r=0,n=!1,a=!1,i=0;i<e.assetList.length;i++){var s=e.assetList[i],o=t+r;s.startOffset=r,s.timelineStart=o,n||(n=null===s.duration),a||(a=!!s.error),r+=s.error?0:s.duration||0}e.duration=n&&!a?Math.max(r,e.duration):r}},r.removeEvent=function(e){e.reset(),delete this.eventMap[e.identifier]},n(t,[{key:"duration",get:function(){var e=this.items;return e?e[e.length-1].end:0}},{key:"length",get:function(){return this.items?this.items.length:0}},{key:"assetIdAtEnd",get:function(){var e,t=null==(e=this.items)||null==(e=e[this.length-1])?void 0:e.event;if(t){var r=t.assetList,n=r[r.length-1];if(n)return n.identifier}return null}}])}(N);function ws(e){return"["+(e.event?'"'+e.event.identifier+'"':"primary")+": "+e.start.toFixed(2)+"-"+e.end.toFixed(2)+"]"}var Rs=function(){function e(e){this.hls=void 0,this.hls=e}var t=e.prototype;return t.destroy=function(){this.hls=null},t.loadAssetList=function(e,t){var r,n=this,a=e.assetListUrl;try{r=Ss(a,this.hls.sessionId,e.baseUrl)}catch(t){var i=this.assignAssetListError(e,S.ASSET_LIST_LOAD_ERROR,t,a);return void this.hls.trigger(P.ERROR,i)}t&&"data:"!==r.protocol&&r.searchParams.set("_HLS_start_offset",""+t);var s=this.hls.config,o=new(0,s.loader)(s),l={responseType:"json",url:r.href},u=s.interstitialAssetListLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:function(t,r,a,i){var s=t.data,o=null==s?void 0:s.ASSETS;if(Array.isArray(o))e.assetListResponse=s,n.hls.trigger(P.ASSET_LIST_LOADED,{event:e,assetListResponse:s,networkDetails:i});else{var l=n.assignAssetListError(e,S.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),a.url,r,i);n.hls.trigger(P.ERROR,l)}},onError:function(t,r,a,i){var s=n.assignAssetListError(e,S.ASSET_LIST_LOAD_ERROR,new Error("Error loading X-ASSET-LIST: HTTP status "+t.code+" "+t.text+" ("+r.url+")"),r.url,i,a);n.hls.trigger(P.ERROR,s)},onTimeout:function(t,r,a){var i=n.assignAssetListError(e,S.ASSET_LIST_LOAD_TIMEOUT,new Error("Timeout loading X-ASSET-LIST ("+r.url+")"),r.url,t,a);n.hls.trigger(P.ERROR,i)}};return o.load(l,c,d),this.hls.trigger(P.ASSET_LIST_LOADING,{event:e}),o},t.assignAssetListError=function(e,t,r,n,a,i){return e.error=r,{type:A.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:n,error:r,networkDetails:i,stats:a}},e}();function Ms(e){null==e||e.play().catch((function(){}))}function Ds(e,t){return"["+e+"] Advancing timeline position to "+t}var Os=function(e){function t(t,r){var n;return(n=e.call(this,"interstitials",t.logger)||this).HlsPlayerClass=void 0,n.hls=void 0,n.assetListLoader=void 0,n.mediaSelection=null,n.altSelection=null,n.media=null,n.detachedData=null,n.requiredTracks=null,n.manager=null,n.playerQueue=[],n.bufferedPos=-1,n.timelinePos=-1,n.schedule=void 0,n.playingItem=null,n.bufferingItem=null,n.waitingItem=null,n.endedItem=null,n.playingAsset=null,n.endedAsset=null,n.bufferingAsset=null,n.shouldPlay=!1,n.onPlay=function(){n.shouldPlay=!0},n.onPause=function(){n.shouldPlay=!1},n.onSeeking=function(){var e=n.currentTime;if(void 0!==e&&!n.playbackDisabled&&n.schedule){var t=e-n.timelinePos;if(!(Math.abs(t)<1/7056e5)){var r=t<=-.01;n.timelinePos=e,n.bufferedPos=e;var a=n.playingItem;if(a)if(r&&n.schedule.resetErrorsInRange(e,e-t)&&n.updateSchedule(!0),n.checkBuffer(),r&&e<a.start||e>=a.end){var i,s=n.findItemIndex(a),o=n.schedule.findItemIndexAtTime(e);if(-1===o&&(o=s+(r?-1:1),n.log("seeked "+(r?"back ":"")+"to position not covered by schedule "+e+" (resolving from "+s+" to "+o+")")),!n.isInterstitial(a)&&null!=(i=n.media)&&i.paused&&(n.shouldPlay=!1),!r&&o>s){var l=n.schedule.findJumpRestrictedIndex(s+1,o);if(l>s)return void n.setSchedulePosition(l)}n.setSchedulePosition(o)}else{var u=n.playingAsset;if(u){var c,d=u.timelineStart,p=u.duration||0;(r&&e<d||e>=d+p)&&(null!=(c=a.event)&&c.appendInPlace&&(n.clearInterstitial(a.event,a),n.flushFrontBuffer(e)),n.setScheduleToAssetAtTime(e,u))}else if(n.playingLastItem&&n.isInterstitial(a)){var h=a.event.assetList[0];h&&(n.endedItem=n.playingItem,n.playingItem=null,n.setScheduleToAssetAtTime(e,h))}}else n.checkBuffer()}}},n.onTimeupdate=function(){var e=n.currentTime;if(void 0!==e&&!n.playbackDisabled&&e>n.timelinePos){n.timelinePos=e,e>n.bufferedPos&&n.checkBuffer();var t=n.playingItem;if(t&&!n.playingLastItem){if(e>=t.end){n.timelinePos=t.end;var r=n.findItemIndex(t);n.setSchedulePosition(r+1)}var a=n.playingAsset;a&&e>=a.timelineStart+(a.duration||0)&&n.setScheduleToAssetAtTime(e,a)}}},n.onScheduleUpdate=function(e,t){var r=n.schedule;if(r){var a=n.playingItem,i=r.events||[],s=r.items||[],o=r.durations,l=e.map((function(e){return e.identifier})),u=!(!i.length&&!l.length);(u||t)&&n.log("INTERSTITIALS_UPDATED ("+i.length+"): "+i+"\nSchedule: "+s.map((function(e){return ws(e)}))+" pos: "+n.timelinePos),l.length&&n.log("Removed events "+l);var c=null,d=null;a&&(c=n.updateItem(a,n.timelinePos),n.itemsMatch(a,c)?n.playingItem=c:n.waitingItem=n.endedItem=null),n.waitingItem=n.updateItem(n.waitingItem),n.endedItem=n.updateItem(n.endedItem);var p=n.bufferingItem;if(p&&(d=n.updateItem(p,n.bufferedPos),n.itemsMatch(p,d)?n.bufferingItem=d:p.event&&(n.bufferingItem=n.playingItem,n.clearInterstitial(p.event,null))),e.forEach((function(e){e.assetList.forEach((function(e){n.clearAssetPlayer(e.identifier,null)}))})),n.playerQueue.forEach((function(e){if(e.interstitial.appendInPlace){var t=e.assetItem.timelineStart,r=e.timelineOffset-t;if(r)try{e.timelineOffset=t}catch(a){Math.abs(r)>ks&&n.warn(a+' ("'+e.assetId+'" '+e.timelineOffset+"->"+t+")")}}})),u||t){if(n.hls.trigger(P.INTERSTITIALS_UPDATED,{events:i.slice(0),schedule:s.slice(0),durations:o,removedIds:l}),n.isInterstitial(a)&&l.includes(a.event.identifier))return n.warn('Interstitial "'+a.event.identifier+'" removed while playing'),void n.primaryFallback(a.event);a&&n.trimInPlace(c,a),p&&d!==c&&n.trimInPlace(d,p),n.checkBuffer()}}},n.hls=t,n.HlsPlayerClass=r,n.assetListLoader=new Rs(t),n.schedule=new Is(n.onScheduleUpdate,t.logger),n.registerListeners(),n}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e&&(e.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(P.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(P.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(P.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(P.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(P.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(P.BUFFER_APPENDED,this.onBufferAppended,this),e.on(P.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(P.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(P.MEDIA_ENDED,this.onMediaEnded,this),e.on(P.ERROR,this.onError,this),e.on(P.DESTROYING,this.onDestroying,this))},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(P.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(P.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(P.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(P.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(P.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(P.BUFFER_CODECS,this.onBufferCodecs,this),e.off(P.BUFFER_APPENDED,this.onBufferAppended,this),e.off(P.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(P.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(P.MEDIA_ENDED,this.onMediaEnded,this),e.off(P.ERROR,this.onError,this),e.off(P.DESTROYING,this.onDestroying,this))},r.startLoad=function(){this.resumeBuffering()},r.stopLoad=function(){this.pauseBuffering()},r.resumeBuffering=function(){var e;null==(e=this.getBufferingPlayer())||e.resumeBuffering()},r.pauseBuffering=function(){var e;null==(e=this.getBufferingPlayer())||e.pauseBuffering()},r.destroy=function(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null},r.onDestroying=function(){var e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)},r.removeMediaListeners=function(e){ln(e,"play",this.onPlay),ln(e,"pause",this.onPause),ln(e,"seeking",this.onSeeking),ln(e,"timeupdate",this.onTimeupdate)},r.onMediaAttaching=function(e,t){var r=this.media=t.media;on(r,"seeking",this.onSeeking),on(r,"timeupdate",this.onTimeupdate),on(r,"play",this.onPlay),on(r,"pause",this.onPause)},r.onMediaAttached=function(e,t){var r=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,null===r)this.checkStart();else if(!n){this.clearScheduleState();var a=this.findItemIndex(r);this.setSchedulePosition(a)}},r.clearScheduleState=function(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null},r.onMediaDetaching=function(e,t){var r=!!t.transferMedia,n=this.media;if(this.media=null,!r&&(n&&this.removeMediaListeners(n),this.detachedData)){var a=this.getBufferingPlayer();a&&(this.log("Removing schedule state for detachedData and "+a),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,a.detachMedia()),this.shouldPlay=!1}},r.isInterstitial=function(e){return!(null==e||!e.event)},r.retreiveMediaSource=function(e,t){var r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)},r.transferMediaFromPlayer=function(e,t){var r=e.interstitial.appendInPlace,n=e.media;if(r&&n===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&n)return void(this.detachedData={media:n});var a=e.transferMedia();this.log("transfer MediaSource from "+e+" "+rt(a)),this.detachedData=a}else t&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))},r.transferMediaTo=function(e,t){var r,n,a=this;if(e.media!==t){var i,s=null,o=this.hls,l=e!==o,u=l&&e.interstitial.appendInPlace,c=null==(r=this.detachedData)?void 0:r.mediaSource;if(o.media)u&&(s=o.transferMedia(),this.detachedData=s),i="Primary";else if(c){var d=this.getBufferingPlayer();d?(s=d.transferMedia(),i=""+d):i="detached MediaSource"}else i="detached media";if(!s)if(c)s=this.detachedData,this.log("using detachedData: MediaSource "+rt(s));else if(!this.detachedData||o.media===t){var p=this.playerQueue;p.length>1&&p.forEach((function(e){if(l&&e.interstitial.appendInPlace!==u){var t=e.interstitial;a.clearInterstitial(e.interstitial,null),t.appendInPlace=!1,t.appendInPlace&&a.warn("Could not change append strategy for queued assets "+t)}})),this.hls.detachMedia(),this.detachedData={media:t}}var h=s&&"mediaSource"in s&&"closed"!==(null==(n=s.mediaSource)?void 0:n.readyState),f=h&&s?s:t;this.log((h?"transfering MediaSource":"attaching media")+" to "+(l?e:"Primary")+" from "+i+" (media.currentTime: "+t.currentTime+")");var m=this.schedule;if(f===s&&m){var g=l&&e.assetId===m.assetIdAtEnd;f.overrides={duration:m.duration,endOfStream:!l||g,cueRemoval:!l}}e.attachMedia(f)}},r.onInterstitialCueEnter=function(){this.onTimeupdate()},r.checkStart=function(){var e=this.schedule,t=null==e?void 0:e.events;if(t&&!this.playbackDisabled&&this.media){-1===this.bufferedPos&&(this.bufferedPos=0);var r=this.timelinePos,n=this.effectivePlayingItem;if(-1===r){var a=this.hls.startPosition;if(this.log(Ds("checkStart",a)),this.timelinePos=a,t.length&&t[0].cue.pre){var i=e.findEventIndex(t[0].identifier);this.setSchedulePosition(i)}else if(a>=0||!this.primaryLive){var s=this.timelinePos=a>0?a:0,o=e.findItemIndexAtTime(s);this.setSchedulePosition(o)}}else if(n&&!this.playingItem){var l=e.findItemIndex(n);this.setSchedulePosition(l)}}},r.advanceAssetBuffering=function(e,t){var r=e.event,n=r.findAssetIndex(t),a=Ps(r,n);if(r.isAssetPastPlayoutLimit(a)){if(this.schedule){var i,s=null==(i=this.schedule.items)?void 0:i[this.findItemIndex(e)+1];s&&this.bufferedToItem(s)}}else this.bufferedToEvent(e,a)},r.advanceAfterAssetEnded=function(e,t,r){var n=Ps(e,r);if(e.isAssetPastPlayoutLimit(n)){if(this.schedule){var a=this.schedule.items;if(a){var i=t+1;if(i>=a.length)return void this.setSchedulePosition(-1);var s=e.resumeTime;this.timelinePos<s&&(this.log(Ds("advanceAfterAssetEnded",s)),this.timelinePos=s,e.appendInPlace&&this.advanceInPlace(s),this.checkBuffer(this.bufferedPos<s)),this.setSchedulePosition(i)}}}else{if(e.appendInPlace){var o=e.assetList[n];o&&this.advanceInPlace(o.timelineStart)}this.setSchedulePosition(t,n)}},r.setScheduleToAssetAtTime=function(e,t){var r=this.schedule;if(r){var n=t.parentIdentifier,a=r.getEvent(n);if(a){var i=r.findEventIndex(n),s=r.findAssetIndex(a,e);this.advanceAfterAssetEnded(a,i,s-1)}}},r.setSchedulePosition=function(e,t){var r,n=null==(r=this.schedule)?void 0:r.items;if(n&&!this.playbackDisabled){var a=e>=0?n[e]:null;this.log("setSchedulePosition "+e+", "+t+" ("+(a?ws(a):a)+") pos: "+this.timelinePos);var i=this.waitingItem||this.playingItem,s=this.playingLastItem;if(this.isInterstitial(i)){var o=i.event,l=this.playingAsset,u=null==l?void 0:l.identifier,c=u?this.getAssetPlayer(u):null;if(c&&u&&(!this.eventItemsMatch(i,a)||void 0!==t&&u!==o.assetList[t].identifier)){var d,p=o.findAssetIndex(l);if(this.log("INTERSTITIAL_ASSET_ENDED "+(p+1)+"/"+o.assetList.length+" "+Cs(l)),this.endedAsset=l,this.playingAsset=null,this.hls.trigger(P.INTERSTITIAL_ASSET_ENDED,{asset:l,assetListIndex:p,event:o,schedule:n.slice(0),scheduleIndex:e,player:c}),i!==this.playingItem)return void(this.itemsMatch(i,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(o,this.findItemIndex(this.playingItem),p));this.retreiveMediaSource(u,a),!c.media||null!=(d=this.detachedData)&&d.mediaSource||c.detachMedia()}if(!this.eventItemsMatch(i,a)&&(this.endedItem=i,this.playingItem=null,this.log("INTERSTITIAL_ENDED "+o+" "+ws(i)),o.hasPlayed=!0,this.hls.trigger(P.INTERSTITIAL_ENDED,{event:o,schedule:n.slice(0),scheduleIndex:e}),o.cue.once)){var h;this.updateSchedule();var f=null==(h=this.schedule)?void 0:h.items;if(a&&f){var m=this.findItemIndex(a);this.advanceSchedule(m,f,t,i,s)}return}}this.advanceSchedule(e,n,t,i,s)}},r.advanceSchedule=function(e,t,r,n,a){var i=this,s=this.schedule;if(s){var o=t[e]||null,l=this.primaryMedia,u=this.playerQueue;if(u.length&&u.forEach((function(t){var r=t.interstitial,n=s.findEventIndex(r.identifier);(n<e||n>e+1)&&i.clearInterstitial(r,o)})),this.isInterstitial(o)){this.timelinePos=Math.min(Math.max(this.timelinePos,o.start),o.end);var c=o.event;if(void 0===r){var d=Ps(c,(r=s.findAssetIndex(c,this.timelinePos))-1);if(c.isAssetPastPlayoutLimit(d)||c.appendInPlace&&this.timelinePos===o.end)return void this.advanceAfterAssetEnded(c,e,r);r=d}var p=this.waitingItem;this.assetsBuffered(o,l)||this.setBufferingItem(o);var h=this.preloadAssets(c,r);if(this.eventItemsMatch(o,p||n)||(this.waitingItem=o,this.log("INTERSTITIAL_STARTED "+ws(o)+" "+(c.appendInPlace?"append in place":"")),this.hls.trigger(P.INTERSTITIAL_STARTED,{event:c,schedule:t.slice(0),scheduleIndex:e})),!c.assetListLoaded)return void this.log("Waiting for ASSET-LIST to complete loading "+c);if(c.assetListLoader&&(c.assetListLoader.destroy(),c.assetListLoader=void 0),!l)return void this.log("Waiting for attachMedia to start Interstitial "+c);this.waitingItem=this.endedItem=null,this.playingItem=o;var f=c.assetList[r];if(!f)return void this.advanceAfterAssetEnded(c,e,r||0);if(h||(h=this.getAssetPlayer(f.identifier)),null===h||h.destroyed){var m=c.assetList.length;this.warn("asset "+(r+1)+"/"+m+" player destroyed "+c),(h=this.createAssetPlayer(c,f,r)).loadSource()}if(!this.eventItemsMatch(o,this.bufferingItem)&&c.appendInPlace&&this.isAssetBuffered(f))return;this.startAssetPlayer(h,r,t,e,l),this.shouldPlay&&Ms(h.media)}else o?(this.resumePrimary(o,e,n),this.shouldPlay&&Ms(this.hls.media)):a&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(s.durations.primary,null))}},r.resumePrimary=function(e,t,r){var n,a;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log("resuming "+ws(e)),null==(n=this.detachedData)||!n.mediaSource){var i=this.timelinePos;(i<e.start||i>=e.end)&&(i=this.getPrimaryResumption(e,t),this.log(Ds("resumePrimary",i)),this.timelinePos=i),this.attachPrimary(i,e)}if(r){var s=null==(a=this.schedule)?void 0:a.items;s&&(this.log("INTERSTITIALS_PRIMARY_RESUMED "+ws(e)),this.hls.trigger(P.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:t}),this.checkBuffer())}},r.getPrimaryResumption=function(e,t){var r=e.start;if(this.primaryLive){var n=this.primaryDetails;if(0===t)return this.hls.startPosition;if(n&&(r<n.fragmentStart||r>n.edge))return this.hls.liveSyncPosition||-1}return r},r.isAssetBuffered=function(e){var t=this.getAssetPlayer(e.identifier);return null!=t&&t.hls?t.hls.bufferedToEnd:zt.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)},r.attachPrimary=function(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;var n=this.primaryMedia;if(n){var a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,n),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(Ds("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}},r.startLoadingPrimaryAt=function(e,t){var r,n=this.hls;!n.loadingEnabled||!n.media||Math.abs(((null==(r=n.mainForwardBufferInfo)?void 0:r.start)||n.media.currentTime)-e)>.5?n.startLoad(e,t):n.bufferingEnabled||n.resumeBuffering()},r.onManifestLoading=function(){var e;this.stopLoad(),null==(e=this.schedule)||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(P.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(P.BUFFER_CODECS,this.onBufferCodecs,this)},r.onLevelUpdated=function(e,t){if(-1!==t.level&&this.schedule){var r=this.hls.levels[t.level];if(r.details){var n=c(c({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}}},r.onAudioTrackUpdated=function(e,t){var r=this.hls.audioTracks[t.id],n=this.mediaSelection;if(n){var a=c(c({},n),{},{audio:r});this.mediaSelection=a}else this.altSelection=c(c({},this.altSelection),{},{audio:r})},r.onSubtitleTrackUpdated=function(e,t){var r=this.hls.subtitleTracks[t.id],n=this.mediaSelection;if(n){var a=c(c({},n),{},{subtitles:r});this.mediaSelection=a}else this.altSelection=c(c({},this.altSelection),{},{subtitles:r})},r.onAudioTrackSwitching=function(e,t){var r=it(t);this.playerQueue.forEach((function(e){var n=e.hls;return n&&(n.setAudioOption(t)||n.setAudioOption(r))}))},r.onSubtitleTrackSwitch=function(e,t){var r=it(t);this.playerQueue.forEach((function(e){var n=e.hls;return n&&(n.setSubtitleOption(t)||-1!==t.id&&n.setSubtitleOption(r))}))},r.onBufferCodecs=function(e,t){var r=t.tracks;r&&(this.requiredTracks=r)},r.onBufferAppended=function(e,t){this.checkBuffer()},r.onBufferFlushed=function(e,t){var r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){var n=this.timelinePos;this.bufferedPos=n,this.checkBuffer()}},r.onBufferedToEnd=function(e){if(this.schedule){var t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(var r=0;r<t.length;r++){var n=t[r];if(n.cue.post){var a,i=this.schedule.findEventIndex(n.identifier),s=null==(a=this.schedule.items)?void 0:a[i];this.isInterstitial(s)&&this.eventItemsMatch(s,this.bufferingItem)&&this.bufferedToItem(s,0);break}}this.bufferedPos=Number.MAX_VALUE}}},r.onMediaEnded=function(e){var t=this.playingItem;if(!this.playingLastItem&&t){var r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1},r.updateItem=function(e,t){var r,n=null==(r=this.schedule)?void 0:r.items;return e&&n&&n[this.findItemIndex(e,t)]||null},r.trimInPlace=function(e,t){var r=this;if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((function(t,n){e.event.isAssetPastPlayoutLimit(n)&&r.clearAssetPlayer(t.identifier,null)}));var n=e.end+.25,a=zt.bufferInfo(this.primaryMedia,n,0);(a.end>n||(a.nextStart||0)>n)&&(this.log("trim buffered interstitial "+ws(e)+" (was "+ws(t)+")"),this.attachPrimary(n,null,!0),this.flushFrontBuffer(n))}},r.itemsMatch=function(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))},r.eventItemsMatch=function(e,t){var r;return!!t&&(e===t||e.event.identifier===(null==(r=t.event)?void 0:r.identifier))},r.findItemIndex=function(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1},r.updateSchedule=function(e){var t;void 0===e&&(e=!1);var r=this.mediaSelection;r&&(null==(t=this.schedule)||t.updateSchedule(r,[],e))},r.checkBuffer=function(e){var t,r=null==(t=this.schedule)?void 0:t.items;if(r){var n=zt.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=n.len<1),this.updateBufferedPos(n.end,r,e)}},r.updateBufferedPos=function(e,t,r){var n=this.schedule,a=this.bufferingItem;if(!(this.bufferedPos>e)&&n)if(1===t.length&&this.itemsMatch(t[0],a))this.bufferedPos=e;else{var i=this.playingItem,s=this.findItemIndex(i),o=n.findItemIndexAtTime(e);if(this.bufferedPos<e){var l,u=this.findItemIndex(a),c=Math.min(u+1,t.length-1),d=t[c];if((-1===o&&a&&e>=a.end||null!=(l=d.event)&&l.appendInPlace&&e+.01>=d.start)&&(o=c),this.isInterstitial(a)){var p=a.event;if(c-s>1&&!1===p.appendInPlace)return;if(0===p.assetList.length&&p.assetListLoader)return}if(this.bufferedPos=e,o>u&&o>s)this.bufferedToItem(d);else{var h=this.primaryDetails;this.primaryLive&&h&&e>h.edge-h.targetduration&&d.start<h.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(d)&&this.preloadAssets(d.event,0)}}else r&&i&&!this.itemsMatch(i,a)&&(o===s?this.bufferedToItem(i):o===s+1&&this.bufferedToItem(t[o]))}},r.assetsBuffered=function(e,t){var r=this;return 0!==e.event.assetList.length&&!e.event.assetList.some((function(e){var n=r.getAssetPlayer(e.identifier);return!(null!=n&&n.bufferedInPlaceToEnd(t))}))},r.setBufferingItem=function(e){var t=this,r=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,r)&&n){var a=n.items,i=n.events;if(!a||!i)return r;var s=this.isInterstitial(e),o=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));var l=o?o.remaining:r?r.end-this.timelinePos:0;if(this.log("INTERSTITIALS_BUFFERED_TO_BOUNDARY "+ws(e)+(r?" ("+l.toFixed(2)+" remaining)":"")),!this.playbackDisabled)if(s){var u=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((function(e,r){var n=t.getAssetPlayer(e.identifier);n&&(r===u&&n.loadSource(),n.resumeBuffering())}))}else this.hls.resumeBuffering(),this.playerQueue.forEach((function(e){return e.pauseBuffering()}));this.hls.trigger(P.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:i.slice(0),schedule:a.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return r},r.bufferedToItem=function(e,t){void 0===t&&(t=0);var r=this.setBufferingItem(e);if(!this.playbackDisabled)if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(null!==r){this.bufferingAsset=null;var n=this.detachedData;n&&n.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e)}},r.preloadPrimary=function(e){var t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)},r.bufferedToEvent=function(e,t){var r=e.event,n=0===r.assetList.length&&!r.assetListLoader,a=r.cue.once;if(n||!a){var i=this.preloadAssets(r,t);if(null!=i&&i.interstitial.appendInPlace){var s=this.primaryMedia;s&&this.bufferAssetPlayer(i,s)}}},r.preloadAssets=function(e,t){var r=e.assetUrl,n=e.assetList.length,a=0===n&&!e.assetListLoader,i=e.cue.once;if(a){var s,o=e.timelineStart;if(e.appendInPlace){var l,u=this.playingItem;this.isInterstitial(u)||(null==u||null==(l=u.nextEvent)?void 0:l.identifier)!==e.identifier||this.flushFrontBuffer(o+.25)}var c=0;if(!this.playingItem&&this.primaryLive&&-1===(c=this.hls.startPosition)&&(c=this.hls.liveSyncPosition||0),c&&!e.cue.pre&&!e.cue.post){var d=c-o;d>0&&(s=Math.round(1e3*d)/1e3)}if(this.log("Load interstitial asset "+(t+1)+"/"+(r?1:n)+" "+e+(s?" live-start: "+c+" start-offset: "+s:"")),r)return this.createAsset(e,0,0,o,e.duration,r);var p=this.assetListLoader.loadAssetList(e,s);p&&(e.assetListLoader=p)}else if(!i&&n){for(var h=t;h<n;h++){var f=e.assetList[h],m=this.getAssetPlayerQueueIndex(f.identifier);-1!==m&&!this.playerQueue[m].destroyed||f.error||this.createAssetPlayer(e,f,h)}var g=e.assetList[t];if(g){var y=this.getAssetPlayer(g.identifier);return y&&y.loadSource(),y}}return null},r.flushFrontBuffer=function(e){var t=this,r=this.requiredTracks;r&&(this.log("Removing front buffer starting at "+e),Object.keys(r).forEach((function(r){t.hls.trigger(P.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})})))},r.getAssetPlayerQueueIndex=function(e){for(var t=this.playerQueue,r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1},r.getAssetPlayer=function(e){var t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null},r.getBufferingPlayer=function(){var e=this.playerQueue,t=this.primaryMedia;if(t)for(var r=0;r<e.length;r++)if(e[r].media===t)return e[r];return null},r.createAsset=function(e,t,r,n,a,i){var s={parentIdentifier:e.identifier,identifier:bs(e,i,t),duration:a,startOffset:r,timelineStart:n,uri:i};return this.createAssetPlayer(e,s,t)},r.createAssetPlayer=function(e,t,r){var n=this,a=this.hls,s=a.userConfig,o=s.videoPreference,l=a.loadLevelObj||a.levels[a.currentLevel];(o||l)&&(o=i({},o),l.videoCodec&&(o.videoCodec=l.videoCodec),l.videoRange&&(o.allowedVideoRanges=[l.videoRange]));var u=a.audioTracks[a.audioTrack],d=a.subtitleTracks[a.subtitleTrack],p=0;if(this.primaryLive||e.appendInPlace){var h=this.timelinePos-t.timelineStart;if(h>1){var f=t.duration;f&&h<f&&(p=h)}}var m=t.identifier,g=c(c({},s),{},{maxMaxBufferLength:Math.min(180,a.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:a.sessionId,assetPlayerId:m,abrEwmaDefaultEstimate:a.bandwidthEstimate,interstitialsController:void 0,startPosition:p,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:u||s.audioPreference,subtitlePreference:d||s.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(g.timelineOffset=t.timelineStart));var y=g.cmcd;null!=y&&y.sessionId&&y.contentId&&(g.cmcd=i({},y,{contentId:_s(t.uri)})),this.getAssetPlayer(m)&&this.warn("Duplicate date range identifier "+e+" and asset "+m);var v=new xs(this.HlsPlayerClass,g,e,t);this.playerQueue.push(v),e.assetList[r]=t;var _=!0,k=function(a){if(a.live){var i,s=new Error("Interstitials MUST be VOD assets "+e),o={fatal:!0,type:A.OTHER_ERROR,details:S.INTERSTITIAL_ASSET_ITEM_ERROR,error:s},l=(null==(i=n.schedule)?void 0:i.findEventIndex(e.identifier))||-1;n.handleAssetItemError(o,e,l,r,s.message)}else{var u=a.edge-a.fragmentStart,c=t.duration;(_||null===c||u>c)&&(_=!1,n.log('Interstitial asset "'+m+'" duration change '+c+" > "+u),t.duration=u,n.updateSchedule())}};v.on(P.LEVEL_UPDATED,(function(e,t){var r=t.details;return k(r)})),v.on(P.LEVEL_PTS_UPDATED,(function(e,t){var r=t.details;return k(r)})),v.on(P.EVENT_CUE_ENTER,(function(){return n.onInterstitialCueEnter()}));var E=function(e,t){var r=n.getAssetPlayer(m);if(r&&t.tracks){r.off(P.BUFFER_CODECS,E),r.tracks=t.tracks;var a=n.primaryMedia;n.bufferingAsset===r.assetItem&&a&&!r.media&&n.bufferAssetPlayer(r,a)}};v.on(P.BUFFER_CODECS,E),v.on(P.BUFFERED_TO_END,(function(){var r,a=n.getAssetPlayer(m);if(n.log("buffered to end of asset "+a),a&&n.schedule){var i=n.schedule.findEventIndex(e.identifier),s=null==(r=n.schedule.items)?void 0:r[i];n.isInterstitial(s)&&n.advanceAssetBuffering(s,t)}}));var b=function(t){return function(){if(n.getAssetPlayer(m)&&n.schedule){n.shouldPlay=!0;var r=n.schedule.findEventIndex(e.identifier);n.advanceAfterAssetEnded(e,r,t)}}};return v.once(P.MEDIA_ENDED,b(r)),v.once(P.PLAYOUT_LIMIT_REACHED,b(1/0)),v.on(P.ERROR,(function(t,a){if(n.schedule){var i=n.getAssetPlayer(m);if(a.details===S.BUFFER_STALLED_ERROR)return null!=i&&i.appendInPlace?void n.handleInPlaceStall(e):(n.onTimeupdate(),void n.checkBuffer(!0));n.handleAssetItemError(a,e,n.schedule.findEventIndex(e.identifier),r,"Asset player error "+a.error+" "+e)}})),v.on(P.DESTROYING,(function(){if(n.getAssetPlayer(m)&&n.schedule){var t=new Error("Asset player destroyed unexpectedly "+m),a={fatal:!0,type:A.OTHER_ERROR,details:S.INTERSTITIAL_ASSET_ITEM_ERROR,error:t};n.handleAssetItemError(a,e,n.schedule.findEventIndex(e.identifier),r,t.message)}})),this.log("INTERSTITIAL_ASSET_PLAYER_CREATED "+Cs(t)),this.hls.trigger(P.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:v}),v},r.clearInterstitial=function(e,t){var r=this;e.assetList.forEach((function(e){r.clearAssetPlayer(e.identifier,t)})),e.reset()},r.resetAssetPlayer=function(e){var t=this.getAssetPlayerQueueIndex(e);if(-1!==t){this.log('reset asset player "'+e+'" after error');var r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}},r.clearAssetPlayer=function(e,t){var r=this.getAssetPlayerQueueIndex(e);if(-1!==r){var n=this.playerQueue[r];this.log("clear "+n+" toSegment: "+(t?ws(t):t)),this.transferMediaFromPlayer(n,t),this.playerQueue.splice(r,1),n.destroy()}},r.emptyPlayerQueue=function(){for(var e;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]},r.startAssetPlayer=function(e,t,r,n,a){var i=e.interstitial,s=e.assetItem,o=e.assetId,l=i.assetList.length,u=this.playingAsset;this.endedAsset=null,this.playingAsset=s,u&&u.identifier===o||(u&&(this.clearAssetPlayer(u.identifier,r[n]),delete u.error),this.log("INTERSTITIAL_ASSET_STARTED "+(t+1)+"/"+l+" "+Cs(s)),this.hls.trigger(P.INTERSTITIAL_ASSET_STARTED,{asset:s,assetListIndex:t,event:i,schedule:r.slice(0),scheduleIndex:n,player:e})),this.bufferAssetPlayer(e,a)},r.bufferAssetPlayer=function(e,t){var r,n;if(this.schedule){var a=e.interstitial,i=e.assetItem,s=this.schedule.findEventIndex(a.identifier),o=null==(r=this.schedule.items)?void 0:r[s];if(o){e.loadSource(),this.setBufferingItem(o),this.bufferingAsset=i;var l=this.getBufferingPlayer();if(l!==e){var u=a.appendInPlace;if(!u||!1!==(null==l?void 0:l.interstitial.appendInPlace)){var c=(null==l?void 0:l.tracks)||(null==(n=this.detachedData)?void 0:n.tracks)||this.requiredTracks;if(u&&i!==this.playingAsset){if(!e.tracks)return void this.log("Waiting for track info before buffering "+e);if(c&&!W(c,e.tracks)){var d=new Error("Asset "+Cs(i)+" SourceBuffer tracks ('"+Object.keys(e.tracks)+"') are not compatible with primary content tracks ('"+Object.keys(c)+"')"),p={fatal:!0,type:A.OTHER_ERROR,details:S.INTERSTITIAL_ASSET_ITEM_ERROR,error:d},h=a.findAssetIndex(i);return void this.handleAssetItemError(p,a,s,h,d.message)}}this.transferMediaTo(e,t)}}}}},r.handleInPlaceStall=function(e){var t=this.schedule,r=this.primaryMedia;if(t&&r){var n=r.currentTime,a=t.findAssetIndex(e,n),i=e.assetList[a];if(i){var s=this.getAssetPlayer(i.identifier);if(s){var o=s.currentTime||n-i.timelineStart,l=s.duration-o;if(this.warn("Stalled at "+o+" of "+(o+l)+" in "+s+" "+e+" (media.currentTime: "+n+")"),o&&(l/r.playbackRate<.5||s.bufferedInPlaceToEnd(r))&&s.hls){var u=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,u,a)}}}}},r.advanceInPlace=function(e){var t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)},r.handleAssetItemError=function(e,t,r,n,a){if(e.details!==S.BUFFER_STALLED_ERROR){var s=t.assetList[n]||null;if(this.warn("INTERSTITIAL_ASSET_ERROR "+(s?Cs(s):s)+" "+e.error),this.schedule){var o=(null==s?void 0:s.identifier)||"",l=this.getAssetPlayerQueueIndex(o),u=this.playerQueue[l]||null,c=this.schedule.items,d=i({},e,{fatal:!1,errorAction:Pt(!0),asset:s,assetListIndex:n,event:t,schedule:c,scheduleIndex:r,player:u});if(this.hls.trigger(P.INTERSTITIAL_ASSET_ERROR,d),e.fatal){var p=this.playingAsset,h=this.bufferingAsset,f=new Error(a);if(s&&(this.clearAssetPlayer(o,null),s.error=f),t.assetList.some((function(e){return!e.error})))for(var m=n;m<t.assetList.length;m++)this.resetAssetPlayer(t.assetList[m].identifier);else t.error=f;this.updateSchedule(!0),t.error?this.primaryFallback(t):p&&p.identifier===o?this.advanceAfterAssetEnded(t,r,n):h&&h.identifier===o&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,h)}}}},r.primaryFallback=function(e){var t=e.timelineStart,r=this.effectivePlayingItem;if(r){this.log('Fallback to primary from event "'+e.identifier+'" start: '+t+" pos: "+this.timelinePos+" playing: "+ws(r)+" error: "+e.error);var n=this.timelinePos;-1===n&&(n=this.hls.startPosition);var a=this.updateItem(r,n);if(this.itemsMatch(r,a)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t)),!this.schedule)return;var i=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(i)}else this.checkStart()},r.onAssetListLoaded=function(e,t){var r,n,a=this,i=t.event,s=i.identifier,o=t.assetListResponse.ASSETS;if(null!=(r=this.schedule)&&r.hasEvent(s)){var l=i.timelineStart,u=i.duration,c=0;o.forEach((function(e,t){var r=parseFloat(e.DURATION);a.createAsset(i,t,c,l+c,r,e.URI),c+=r})),i.duration=c,this.log("Loaded asset-list with duration: "+c+" (was: "+u+") "+i);var d=this.waitingItem,p=(null==d?void 0:d.event.identifier)===s;this.updateSchedule();var h=null==(n=this.bufferingItem)?void 0:n.event;if(p){var f,m=this.schedule.findEventIndex(s),g=null==(f=this.schedule.items)?void 0:f[m];if(g){if(!this.playingItem&&this.timelinePos>g.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==m)return i.error=new Error("Interstitial no longer within playback range "+this.timelinePos+" "+i),this.updateSchedule(!0),void this.primaryFallback(i);this.setBufferingItem(g)}this.setSchedulePosition(m)}else if((null==h?void 0:h.identifier)===s){var y=i.assetList[0];if(y){var v=this.getAssetPlayer(y.identifier);if(h.appendInPlace){var _=this.primaryMedia;v&&_&&this.bufferAssetPlayer(v,_)}else v&&v.loadSource()}}}},r.onError=function(e,t){if(this.schedule)switch(t.details){case S.ASSET_LIST_PARSING_ERROR:case S.ASSET_LIST_LOAD_ERROR:case S.ASSET_LIST_LOAD_TIMEOUT:var r=t.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break;case S.BUFFER_STALLED_ERROR:var n=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&n.event.appendInPlace)return void this.handleInPlaceStall(n.event);this.log("Primary player stall @"+this.timelinePos+" bufferedPos: "+this.bufferedPos),this.onTimeupdate(),this.checkBuffer(!0)}},n(t,[{key:"interstitialsManager",get:function(){if(!this.hls)return null;if(this.manager)return this.manager;var e=this,t=function(){return e.bufferingItem||e.waitingItem},r=function(t){return t?e.getAssetPlayer(t.identifier):t},n=function(t,n,i,s,o){if(t){var l=t[n].start,u=t.event;if(u){if("playout"===n||u.timelineOccupancy!==Es.Point){var c=r(i);(null==c?void 0:c.interstitial)===u&&(l+=c.assetItem.startOffset+c[o])}}else l+=("bufferedPos"===s?a():e[s])-t.start;return l}return 0},a=function(){var t=e.bufferedPos;return t===Number.MAX_VALUE?i("primary"):Math.max(t,0)},i=function(t){var r,n;return null!=(r=e.primaryDetails)&&r.live?e.primaryDetails.edge:(null==(n=e.schedule)?void 0:n.durations[t])||0},s=function(t,a){var i,s,o=e.effectivePlayingItem;if((null==o||null==(i=o.event)||!i.restrictions.skip)&&e.schedule){e.log("seek to "+t+' "'+a+'"');var l=e.effectivePlayingItem,u=e.schedule.findItemIndexAtTime(t,a),c=null==(s=e.schedule.items)?void 0:s[u],d=e.getBufferingPlayer(),p=null==d?void 0:d.interstitial,h=null==p?void 0:p.appendInPlace,f=l&&e.itemsMatch(l,c);if(l&&(h||f)){var m=r(e.playingAsset),g=(null==m?void 0:m.media)||e.primaryMedia;if(g){var y="primary"===a?g.currentTime:n(l,a,e.playingAsset,"timelinePos","currentTime"),v=t-y,_=(h?y:g.currentTime)+v;if(_>=0&&(!m||h||_<=m.duration))return void(g.currentTime=_)}}if(c){var k=t;if("primary"!==a){var E=t-c[a].start;k=c.start+E}var b=!e.isInterstitial(c);if(e.isInterstitial(l)&&!l.event.appendInPlace||!b&&!c.event.appendInPlace){if(l){var T=e.findItemIndex(l);if(u>T){var A=e.schedule.findJumpRestrictedIndex(T+1,u);if(A>T)return void e.setSchedulePosition(A)}var S=0;if(b)e.timelinePos=k,e.checkBuffer();else for(var P=c.event.assetList,C=t-(c[a]||c).start,x=P.length;x--;){var I=P[x];if(I.duration&&C>=I.startOffset&&C<I.startOffset+I.duration){S=x;break}}e.setSchedulePosition(u,S)}}else{var w=e.media||(h?null==d?void 0:d.media:null);w&&(w.currentTime=k)}}}},o=function(){var r=e.effectivePlayingItem;if(e.isInterstitial(r))return r;var n=t();return e.isInterstitial(n)?n:null},l={get bufferedEnd(){var r,a=t(),i=e.bufferingItem;return i&&i===a&&(n(i,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-i.playout.start||(null==(r=e.bufferingAsset)?void 0:r.startOffset))||0},get currentTime(){var t=o(),r=e.effectivePlayingItem;return r&&r===t?n(r,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-r.playout.start:0},set currentTime(t){var r=o(),n=e.effectivePlayingItem;n&&n===r&&s(t+n.playout.start,"playout")},get duration(){var e=o();return e?e.playout.end-e.playout.start:0},get assetPlayers(){var t,r=null==(t=o())?void 0:t.event.assetList;return r?r.map((function(t){return e.getAssetPlayer(t.identifier)})):[]},get playingIndex(){var t,r=null==(t=o())?void 0:t.event;return r&&e.effectivePlayingAsset?r.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return o()}};return this.manager={get events(){var t;return(null==(t=e.schedule)||null==(t=t.events)?void 0:t.slice(0))||[]},get schedule(){var t;return(null==(t=e.schedule)||null==(t=t.items)?void 0:t.slice(0))||[]},get interstitialPlayer(){return o()?l:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){var r=t();return e.findItemIndex(r)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){var t=e.effectivePlayingItem;return e.findItemIndex(t)},primary:{get bufferedEnd(){return a()},get currentTime(){var t=e.timelinePos;return t>0?t:0},set currentTime(e){s(e,"primary")},get duration(){return i("primary")},get seekableStart(){var t;return(null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(e){s(e,"integrated")},get duration(){return i("integrated")},get seekableStart(){var t;return function(t,r){var n;if(0!==t&&null!=(n=e.schedule)&&n.length){var a,i=e.schedule.findItemIndexAtTime(t),s=null==(a=e.schedule.items)?void 0:a[i];if(s)return t+(s[r].start-s.start)}return t}((null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0,"integrated")}},skip:function(){var t=e.effectivePlayingItem,r=null==t?void 0:t.event;if(r&&!r.restrictions.skip){var n=e.findItemIndex(t);if(r.appendInPlace){var a=t.playout.start+t.event.duration;s(a+.001,"playout")}else e.advanceAfterAssetEnded(r,n,1/0)}}}}},{key:"effectivePlayingItem",get:function(){return this.waitingItem||this.playingItem||this.endedItem}},{key:"effectivePlayingAsset",get:function(){return this.playingAsset||this.endedAsset}},{key:"playingLastItem",get:function(){var e,t=this.playingItem,r=null==(e=this.schedule)?void 0:e.items;return!!(this.playbackStarted&&t&&r)&&this.findItemIndex(t)===r.length-1}},{key:"playbackStarted",get:function(){return null!==this.effectivePlayingItem}},{key:"currentTime",get:function(){var e,t;if(null!==this.mediaSelection){var r=this.waitingItem||this.playingItem;if(!this.isInterstitial(r)||r.event.appendInPlace){var n=this.media;!n&&null!=(e=this.bufferingItem)&&null!=(e=e.event)&&e.appendInPlace&&(n=this.primaryMedia);var a=null==(t=n)?void 0:t.currentTime;if(void 0!==a&&E(a))return a}}}},{key:"primaryMedia",get:function(){var e;return this.media||(null==(e=this.detachedData)?void 0:e.media)||null}},{key:"playbackDisabled",get:function(){return!1===this.hls.config.enableInterstitialPlayback}},{key:"primaryDetails",get:function(){var e;return null==(e=this.mediaSelection)?void 0:e.main.details}},{key:"primaryLive",get:function(){var e;return!(null==(e=this.primaryDetails)||!e.live)}}])}(N),Ls=function(e){function t(t,r,n){var a;return(a=e.call(this,t,r,n,"subtitle-stream-controller",D)||this).currentTrackId=-1,a.tracksBuffered=[],a.mainDetails=null,a.registerListeners(),a}o(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this.unregisterListeners(),e.prototype.onHandlerDestroying.call(this),this.mainDetails=null},r.registerListeners=function(){e.prototype.registerListeners.call(this);var t=this.hls;t.on(P.LEVEL_LOADED,this.onLevelLoaded,this),t.on(P.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(P.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(P.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(P.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(P.BUFFER_FLUSHING,this.onBufferFlushing,this)},r.unregisterListeners=function(){e.prototype.unregisterListeners.call(this);var t=this.hls;t.off(P.LEVEL_LOADED,this.onLevelLoaded,this),t.off(P.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(P.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(P.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(P.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(P.BUFFER_FLUSHING,this.onBufferFlushing,this)},r.startLoad=function(e,t){this.stopLoad(),this.state=un.IDLE,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()},r.onManifestLoading=function(){e.prototype.onManifestLoading.call(this),this.mainDetails=null},r.onMediaDetaching=function(t,r){this.tracksBuffered=[],e.prototype.onMediaDetaching.call(this,t,r)},r.onLevelLoaded=function(e,t){this.mainDetails=t.details},r.onSubtitleFragProcessed=function(e,t){var r=t.frag,n=t.success;if(this.fragContextChanged(r)||(ee(r)&&(this.fragPrevious=r),this.state=un.IDLE),n){var a=this.tracksBuffered[this.currentTrackId];if(a){for(var i,s=r.start,o=0;o<a.length;o++)if(s>=a[o].start&&s<=a[o].end){i=a[o];break}var l=r.start+r.duration;i?i.end=l:(i={start:s,end:l},a.push(i)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}}},r.onBufferFlushing=function(e,t){var r=t.startOffset,n=t.endOffset;if(0===r&&n!==Number.POSITIVE_INFINITY){var a=n-1;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach((function(e){for(var t=0;t<e.length;)if(e[t].end<=a)e.shift();else{if(!(e[t].start<a))break;e[t].start=a,t++}})),this.fragmentTracker.removeFragmentsInRange(r,a,D)}},r.onError=function(e,t){var r=t.frag;(null==r?void 0:r.type)===D&&(t.details===S.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==un.STOPPED&&(this.state=un.IDLE))},r.onSubtitleTracksUpdated=function(e,t){var r=this,n=t.subtitleTracks;this.levels&&Ya(this.levels,n)?this.levels=n.map((function(e){return new et(e)})):(this.tracksBuffered=[],this.levels=n.map((function(e){var t=new et(e);return r.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,D),this.fragPrevious=null,this.mediaBuffer=null)},r.onSubtitleTrackSwitch=function(e,t){var r;if(this.currentTrackId=t.id,null!=(r=this.levels)&&r.length&&-1!==this.currentTrackId){var n=this.levels[this.currentTrackId];null!=n&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==un.STOPPED&&this.setInterval(500)}else this.clearInterval()},r.onSubtitleTrackLoaded=function(e,t){var r,n=this.currentTrackId,a=this.levels,i=t.details,s=t.id;if(a){var o=a[s];if(!(s>=a.length)&&o){this.log("Subtitle track "+s+" loaded ["+i.startSN+","+i.endSN+"]"+(i.lastPartSn?"[part-"+i.lastPartSn+"-"+i.lastPartIndex+"]":"")+",duration:"+i.totalduration),this.mediaBuffer=this.mediaBufferTimeRanges;var l=0;if(i.live||null!=(r=o.details)&&r.live){if(i.deltaUpdateFailed)return;var u=this.mainDetails;if(!u)return void(this.startFragRequested=!1);var c,d=u.fragments[0];o.details?0===(l=this.alignPlaylists(i,o.details,null==(c=this.levelLastLoaded)?void 0:c.details))&&d&&zr(i,l=d.start):i.hasProgramDateTime&&u.hasProgramDateTime?(sn(i,u),l=i.fragmentStart):d&&zr(i,l=d.start),u&&!this.startFragRequested&&this.setStartPosition(u,l)}o.details=i,this.levelLastLoaded=o,s===n&&(this.hls.trigger(P.SUBTITLE_TRACK_UPDATED,{details:i,id:s,groupId:t.groupId}),this.tick(),i.live&&!this.fragCurrent&&this.media&&this.state===un.IDLE&&(ht(null,i.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)))}}else this.warn("Subtitle tracks were reset while loading level "+s)},r._handleFragmentLoadComplete=function(e){var t=this,r=e.frag,n=e.payload,a=r.decryptdata,i=this.hls;if(!this.fragContextChanged(r)&&n&&n.byteLength>0&&null!=a&&a.key&&a.iv&&or(a.method)){var s=performance.now();this.decrypter.decrypt(new Uint8Array(n),a.key.buffer,a.iv.buffer,lr(a.method)).catch((function(e){throw i.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:r}),e})).then((function(e){var t=performance.now();i.trigger(P.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:s,tdecrypt:t}})})).catch((function(e){t.warn(e.name+": "+e.message),t.state=un.IDLE}))}},r.doTick=function(){if(this.media){if(this.state===un.IDLE){var e=this.currentTrackId,t=this.levels,r=null==t?void 0:t[e];if(!r||!t.length||!r.details)return;if(this.waitForLive(r))return;var n=this.config,a=this.getLoadPosition(),i=zt.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,n.maxBufferHole),s=i.end,o=i.len,l=r.details;if(o>this.hls.maxBufferLength+l.levelTargetDuration)return;var u=l.fragments,c=u.length,d=l.edge,p=null,h=this.fragPrevious;if(s<d){var f=n.maxFragLookUpTolerance,m=s>d-f?0:f;!(p=ht(h,u,Math.max(u[0].start,s),m))&&h&&h.start<u[0].start&&(p=u[0])}else p=u[c-1];if(!(p=this.filterReplacedPrimary(p,r.details)))return;var g=u[p.sn-l.startSN-1];if(g&&g.cc===p.cc&&this.fragmentTracker.getState(g)===Ct&&(p=g),this.fragmentTracker.getState(p)===Ct){var y=this.mapToInitFragWhenRequired(p);y&&this.loadFragment(y,r,s)}}}else this.state=un.IDLE},r.loadFragment=function(t,r,n){ee(t)?e.prototype.loadFragment.call(this,t,r,n):this._loadInitSegment(t,r)},n(t,[{key:"mediaBufferTimeRanges",get:function(){return new Ns(this.tracksBuffered[this.currentTrackId]||[])}}])}(cn),Ns=function(e){this.buffered=void 0;var t=function(t,r,n){if((r>>>=0)>n-1)throw new DOMException("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+r+") is greater than the maximum bound ("+n+")");return e[r][t]};this.buffered={get length(){return e.length},end:function(r){return t("end",r,e.length)},start:function(r){return t("start",r,e.length)}}};function Us(e,t){var r;try{r=new Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function js(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){H.debug("[texttrack-utils]: "+r);try{var n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){H.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+e)}}"disabled"===r&&(e.mode=r)}function Bs(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues)for(var n=e.cues.length;n--;)t&&e.cues[n].removeEventListener("enter",t),e.removeCue(e.cues[n]);"disabled"===r&&(e.mode=r)}function Fs(e,t,r,n){var a=e.mode;if("disabled"===a&&(e.mode="hidden"),e.cues&&e.cues.length>0)for(var i=function(e,t,r){var n=[],a=function(e,t){if(t<=e[0].startTime)return 0;var r=e.length-1;if(t>e[r].endTime)return-1;for(var n,a=0,i=r;a<=i;)if(t<e[n=Math.floor((i+a)/2)].startTime)i=n-1;else{if(!(t>e[n].startTime&&a<r))return n;a=n+1}return e[a].startTime-t<t-e[i].startTime?a:i}(e,t);if(a>-1)for(var i=a,s=e.length;i<s;i++){var o=e[i];if(o.startTime>=t&&o.endTime<=r)n.push(o);else if(o.startTime>r)return n}return n}(e.cues,t,r),s=0;s<i.length;s++)n&&!n(i[s])||e.removeCue(i[s]);"disabled"===a&&(e.mode=a)}function Vs(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];"subtitles"!==n.kind&&"captions"!==n.kind||!n.label||t.push(e[r])}return t}var Gs=function(e){function t(t){var r;return(r=e.call(this,t,"subtitle-track-controller")||this).media=null,r.tracks=[],r.groupIds=null,r.tracksInGroup=[],r.trackId=-1,r.currentTrack=null,r.selectDefaultTrack=!0,r.queuedDefaultTrack=-1,r.useTextTrackPolling=!1,r.subtitlePollingInterval=-1,r._subtitleDisplay=!0,r.asyncPollTrackChange=function(){return r.pollTrackChange(0)},r.onTextTracksChanged=function(){if(r.useTextTrackPolling||self.clearInterval(r.subtitlePollingInterval),r.media&&r.hls.config.renderTextTracksNatively){for(var e=null,t=Vs(r.media.textTracks),n=0;n<t.length;n++)if("hidden"===t[n].mode)e=t[n];else if("showing"===t[n].mode){e=t[n];break}var a=r.findTrackForTextTrack(e);r.subtitleTrack!==a&&r.setSubtitleTrack(a)}},r.registerListeners(),r}o(t,e);var r=t.prototype;return r.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,e.prototype.destroy.call(this)},r.registerListeners=function(){var e=this.hls;e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_PARSED,this.onManifestParsed,this),e.on(P.LEVEL_LOADING,this.onLevelLoading,this),e.on(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(P.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(P.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_PARSED,this.onManifestParsed,this),e.off(P.LEVEL_LOADING,this.onLevelLoading,this),e.off(P.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(P.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(P.ERROR,this.onError,this)},r.onMediaAttached=function(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},r.pollTrackChange=function(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)},r.onMediaDetaching=function(e,t){var r=this.media;if(r){var n=!!t.transferMedia;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n||Vs(r.textTracks).forEach((function(e){Bs(e)}))}},r.onManifestLoading=function(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0},r.onManifestParsed=function(e,t){this.tracks=t.subtitleTracks},r.onSubtitleTrackLoaded=function(e,t){var r=t.id,n=t.groupId,a=t.details,i=this.tracksInGroup[r];if(i&&i.groupId===n){var s=i.details;i.details=t.details,this.log("Subtitle track "+r+' "'+i.name+'" lang:'+i.lang+" group:"+n+" loaded ["+a.startSN+"-"+a.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,t,s)}else this.warn("Subtitle track with id:"+r+" and group:"+n+" not found in active group "+(null==i?void 0:i.groupId))},r.onLevelLoading=function(e,t){this.switchLevel(t.level)},r.onLevelSwitching=function(e,t){this.switchLevel(t.level)},r.switchLevel=function(e){var t=this.hls.levels[e];if(t){var r=t.subtitleGroups||null,n=this.groupIds,a=this.currentTrack;if(!r||(null==n?void 0:n.length)!==(null==r?void 0:r.length)||null!=r&&r.some((function(e){return-1===(null==n?void 0:n.indexOf(e))}))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;var i=this.tracks.filter((function(e){return!r||-1!==r.indexOf(e.groupId)}));if(i.length)this.selectDefaultTrack&&!i.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),i.forEach((function(e,t){e.id=t}));else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=i;var s=this.hls.config.subtitlePreference;if(!a&&s){this.selectDefaultTrack=!1;var o=st(s,i);if(o>-1)a=i[o];else{var l=st(s,this.tracks);a=this.tracks[l]}}var u=this.findTrackId(a);-1===u&&a&&(u=this.findTrackId(null));var c={subtitleTracks:i};this.log("Updating subtitle tracks, "+i.length+' track(s) found in "'+(null==r?void 0:r.join(","))+'" group-id'),this.hls.trigger(P.SUBTITLE_TRACKS_UPDATED,c),-1!==u&&-1===this.trackId&&this.setSubtitleTrack(u)}}},r.findTrackId=function(e){for(var t=this.tracksInGroup,r=this.selectDefaultTrack,n=0;n<t.length;n++){var a=t[n];if((!r||a.default)&&(r||e)&&(!e||ot(a,e)))return n}if(e){for(var i=0;i<t.length;i++){var s=t[i];if(Xa(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(var o=0;o<t.length;o++){var l=t[o];if(Xa(e.attrs,l.attrs,["LANGUAGE"]))return o}}return-1},r.findTrackForTextTrack=function(e){if(e)for(var t=this.tracksInGroup,r=0;r<t.length;r++)if(Za(t[r],e))return r;return-1},r.onError=function(e,t){!t.fatal&&t.context&&(t.context.type!==w||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))},r.setSubtitleOption=function(e){if(this.hls.config.subtitlePreference=e,e){if(-1===e.id)return this.setSubtitleTrack(-1),null;var t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){var r=this.currentTrack;if(r&&ot(e,r))return r;var n=st(e,this.tracksInGroup);if(n>-1){var a=this.tracksInGroup[n];return this.setSubtitleTrack(n),a}if(r)return null;var i=st(e,t);if(i>-1)return t[i]}}return null},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t)},r.loadingPlaylist=function(t,r){e.prototype.loadingPlaylist.call(this,t,r);var n=t.id,a=t.groupId,i=this.getUrlWithDirectives(t.url,r),s=t.details,o=null==s?void 0:s.age;this.log("Loading subtitle "+n+' "'+t.name+'" lang:'+t.lang+" group:"+a+(void 0!==(null==r?void 0:r.msn)?" at sn "+r.msn+" part "+r.part:"")+(o&&s.live?" age "+o.toFixed(1)+(s.type&&" "+s.type||""):"")+" "+i),this.hls.trigger(P.SUBTITLE_TRACK_LOADING,{url:i,id:n,groupId:a,deliveryDirectives:r||null,track:t})},r.toggleTrackModes=function(){var e=this.media;if(e){var t,r=Vs(e.textTracks),n=this.currentTrack;if(n&&((t=r.filter((function(e){return Za(n,e)}))[0])||this.warn('Unable to find subtitle TextTrack with name "'+n.name+'" and language "'+n.lang+'"')),[].slice.call(r).forEach((function(e){"disabled"!==e.mode&&e!==t&&(e.mode="disabled")})),t){var a=this.subtitleDisplay?"showing":"hidden";t.mode!==a&&(t.mode=a)}}},r.setSubtitleTrack=function(e){var t=this.tracksInGroup;if(this.media)if(e<-1||e>=t.length||!E(e))this.warn("Invalid subtitle track id: "+e);else{this.selectDefaultTrack=!1;var r=this.currentTrack,n=t[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),n){var a=!!n.details&&!n.details.live;if(e!==this.trackId||n!==r||!a){this.log("Switching to subtitle-track "+e+(n?' "'+n.name+'" lang:'+n.lang+" group:"+n.groupId:""));var i=n.id,s=n.groupId,o=void 0===s?"":s,l=n.name,u=n.type,c=n.url;this.hls.trigger(P.SUBTITLE_TRACK_SWITCH,{id:i,groupId:o,name:l,type:u,url:c});var d=this.switchParams(n.url,null==r?void 0:r.details,n.details);this.loadPlaylist(d)}}else this.hls.trigger(P.SUBTITLE_TRACK_SWITCH,{id:e})}else this.queuedDefaultTrack=e},n(t,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}},{key:"allSubtitleTracks",get:function(){return this.tracks}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}}])}(qa),Hs={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Ks=function(e){return String.fromCharCode(Hs[e]||e)},Ws=15,$s=100,zs={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},qs={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ys={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Xs={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Zs=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],Qs=function(){function e(){this.time=null,this.verboseLevel=0}return e.prototype.log=function(e,t){if(this.verboseLevel>=e){var r="function"==typeof t?t():t;H.log(this.time+" ["+e+"] "+r)}},e}(),Js=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},eo=function(){function e(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),to=function(){function e(){this.uchar=" ",this.penState=new eo}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),ro=function(){function e(e){this.chars=[],this.pos=0,this.currPenState=new eo,this.cueStartTime=null,this.logger=void 0;for(var t=0;t<$s;t++)this.chars.push(new to);this.logger=e}var t=e.prototype;return t.equals=function(e){for(var t=0;t<$s;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0},t.copy=function(e){for(var t=0;t<$s;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<$s;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>$s&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=$s)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){var t=this;e>=144&&this.backSpace();var r=Ks(e);this.pos>=$s?this.logger.log(0,(function(){return"Cannot insert "+e.toString(16)+" ("+r+") at position "+t.pos+". Skipping it!"})):(this.chars[this.pos].setChar(r,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<$s;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,r=0;r<$s;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),no=function(){function e(e){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(var t=0;t<Ws;t++)this.rows.push(new ro(e));this.logger=e}var t=e.prototype;return t.reset=function(){for(var e=0;e<Ws;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,r=0;r<Ws;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<Ws;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<Ws;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(2,(function(){return"pacData = "+rt(e)}));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<Ws;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var i=a.rows[n].cueStartTime,s=this.logger.time;if(null!==i&&null!==s&&i<s)for(var o=0;o<this.nrRollUpRows;o++)this.rows[t-this.nrRollUpRows+o+1].copy(a.rows[n+o])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,c=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[c].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)},t.setBkgData=function(e){this.logger.log(2,(function(){return"bkgData = "+rt(e)})),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){var e=this;if(null!==this.nrRollUpRows){this.logger.log(1,(function(){return e.getDisplayText()}));var t=this.currRow+1-this.nrRollUpRows,r=this.rows.splice(t,1)[0];r.clear(),this.rows.splice(this.currRow,0,r),this.logger.log(2,"Rolling up")}else this.logger.log(3,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],r="",n=-1,a=0;a<Ws;a++){var i=this.rows[a].getTextString();i&&(n=a+1,e?t.push("Row "+n+": '"+i+"'"):t.push(i.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},t.getTextAndFormat=function(){return this.rows},e}(),ao=function(){function e(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new no(r),this.nonDisplayedMemory=new no(r),this.lastOutputScreen=new no(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(function(){return"MODE="+e})),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=this,r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(function(){return n+": "+t.writeScreen.getDisplayText(!0)})),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(function(){return"DISPLAYED: "+t.displayedMemory.getDisplayText(!0)})),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){var e=this;if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(function(){return"DISP: "+e.displayedMemory.getDisplayText()}))}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(2,"MIDROW: "+rt(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),io=function(){function e(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;var n=this.logger=new Qs;this.channels=[null,new ao(e,t,n),new ao(e+1,r,n)]}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var r=this;this.logger.time=e;for(var n=function(e){var n=127&t[e],a=127&t[e+1],i=!1,s=null;if(0===n&&0===a)return 0;r.logger.log(3,(function(){return"["+Js([t[e],t[e+1]])+"] -> ("+Js([n,a])+")"}));var o=r.cmdHistory;if(n>=16&&n<=31){if(function(e,t,r){return r.a===e&&r.b===t}(n,a,o))return so(null,null,o),r.logger.log(3,(function(){return"Repeated command ("+Js([n,a])+") is dropped"})),0;so(n,a,r.cmdHistory),(i=r.parseCmd(n,a))||(i=r.parseMidrow(n,a)),i||(i=r.parsePAC(n,a)),i||(i=r.parseBackgroundAttributes(n,a))}else so(null,null,o);if(!i&&(s=r.parseChars(n,a))){var l=r.currentChannel;l&&l>0?r.channels[l].insertChars(s):r.logger.log(2,"No channel found yet. TEXT-MODE?")}i||s||r.logger.log(2,(function(){return"Couldn't parse cleaned data "+Js([n,a])+" orig: "+Js([t[e],t[e+1]])}))},a=0;a<t.length;a+=2)n(a)},t.parseCmd=function(e,t){if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;var r=20===e||21===e||23===e?1:2,n=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),this.currentChannel=r,!0},t.parseMidrow=function(e,t){var r=0;if((17===e||25===e)&&t>=32&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;var n=this.channels[r];return!!n&&(n.ccMIDROW(t),this.logger.log(3,(function(){return"MIDROW ("+Js([e,t])+")"})),!0)}return!1},t.parsePAC=function(e,t){var r;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;var n=e<=23?1:2;r=t>=64&&t<=95?1===n?zs[e]:Ys[e]:1===n?qs[e]:Xs[e];var a=this.channels[n];return!!a&&(a.setPAC(this.interpretPAC(r,t)),this.currentChannel=n,!0)},t.interpretPAC=function(e,t){var r,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},t.parseChars=function(e,t){var r,n,a=null,i=null;return e>=25?(r=2,i=e-8):(r=1,i=e),i>=17&&i<=19?(n=17===i?t+80:18===i?t+112:t+144,this.logger.log(2,(function(){return"Special char '"+Ks(n)+"' in channel "+r})),a=[n]):e>=32&&e<=127&&(a=0===t?[e]:[e,t]),a&&this.logger.log(3,(function(){return"Char codes =  "+Js(a).join(",")})),a},t.parseBackgroundAttributes=function(e,t){var r;if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;var n={};16===e||24===e?(r=Math.floor((t-32)/2),n.background=Zs[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0));var a=e<=23?1:2;return this.channels[a].setBkgData(n),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}so(null,null,this.cmdHistory)},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}},e}();function so(e,t,r){r.a=e,r.b=t}var oo=function(){if(null!=pr&&pr.VTTCue)return self.VTTCue;var e=["","lr","rl"],t=["start","middle","end","left","right"];function r(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;var r=t.toLowerCase();return!!~e.indexOf(r)&&r}function n(e){return r(t,e)}function a(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var a=1;a<arguments.length;a++){var i=arguments[a];for(var s in i)e[s]=i[s]}return e}function i(t,i,s){var o=this,l={enumerable:!0};o.hasBeenReset=!1;var u="",c=!1,d=t,p=i,h=s,f=null,m="",g=!0,y="auto",v="start",_=50,k="middle",E=50,b="middle";Object.defineProperty(o,"id",a({},l,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(o,"pauseOnExit",a({},l,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(o,"startTime",a({},l,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",a({},l,{get:function(){return p},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");p=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",a({},l,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",a({},l,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",a({},l,{get:function(){return m},set:function(t){var n=function(t){return r(e,t)}(t);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");m=n,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",a({},l,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",a({},l,{get:function(){return y},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",a({},l,{get:function(){return v},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",a({},l,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",a({},l,{get:function(){return k},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");k=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",a({},l,{get:function(){return E},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",a({},l,{get:function(){return b},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),o.displayState=void 0}return i.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},i}(),lo=function(){function e(){}return e.prototype.decode=function(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))},e}();function uo(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+parseFloat(n||0)}var r=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?t(r[2],r[3],0,r[4]):t(r[1],r[2],r[3],r[4]):null}var co=function(){function e(){this.values=Object.create(null)}var t=e.prototype;return t.set=function(e,t){this.get(e)||""===t||(this.values[e]=t)},t.get=function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},t.has=function(e){return e in this.values},t.alt=function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},t.integer=function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},t.percent=function(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1},e}();function po(e,t,r,n){var a=n?e.split(n):[e];for(var i in a)if("string"==typeof a[i]){var s=a[i].split(r);2===s.length&&t(s[0],s[1])}}var ho=new oo(0,0,""),fo="middle"===ho.align?"middle":"center";function mo(e,t,r){var n=e;function a(){var t=uo(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){e=e.replace(/^\s+/,"")}if(i(),t.startTime=a(),i(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.slice(3),i(),t.endTime=a(),i(),function(e,t){var n=new co;po(e,(function(e,t){var a;switch(e){case"region":for(var i=r.length-1;i>=0;i--)if(r[i].id===t){n.set(e,r[i].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":a=t.split(","),n.integer(e,a[0]),n.percent(e,a[0])&&n.set("snapToLines",!1),n.alt(e,a[0],["auto"]),2===a.length&&n.alt("lineAlign",a[1],["start",fo,"end"]);break;case"position":a=t.split(","),n.percent(e,a[0]),2===a.length&&n.alt("positionAlign",a[1],["start",fo,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",fo,"end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");var a=n.get("line","auto");"auto"===a&&-1===ho.line&&(a=-1),t.line=a,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",fo);var i=n.get("position","auto");"auto"===i&&50===ho.position&&(i="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=i}(e,t)}function go(e){return e.replace(/<br(?: \/)?>/gi,"\n")}var yo=function(){function e(){this.state="INITIAL",this.buffer="",this.decoder=new lo,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var t=e.prototype;return t.parse=function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=go(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.slice(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.slice(r),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(n=r()).match(/^()?WEBVTT([ \t].*)?$/);if(null==a||!a[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var i=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:n=r(),t.state){case"HEADER":/:/.test(n)?po(n,(function(e,t){}),/:/):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new oo(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{mo(n,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==n.indexOf("--\x3e");if(!n||s&&(i=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},t.flush=function(){var e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this},e}(),vo=/\r\n|\n\r|\n|\r/g,_o=function(e,t,r){return void 0===r&&(r=0),e.slice(r,r+t.length)===t};function ko(e,t,r){return _s(e.toString())+_s(t.toString())+_s(r)}var Eo="stpp.ttml.im1t",bo=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,To=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Ao={left:"start",center:"center",right:"end",start:"start",end:"end"};function So(e,t,r,n){var a=pe(new Uint8Array(e),["mdat"]);if(0!==a.length){var s,o,l,u=a.map((function(e){return $(e)})),c=(s=t.baseTime,1,void 0===(o=t.timescale)&&(o=1),void 0===l&&(l=!1),_a(s,1,1/o,l));try{u.forEach((function(e){return r(function(e,t){var r=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");var n={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(n).reduce((function(e,t){return e[t]=r.getAttribute("ttp:"+t)||n[t],e}),{}),s="preserve"!==r.getAttribute("xml:space"),o=Co(Po(r,"styling","style")),l=Co(Po(r,"layout","region")),u=Po(r,"body","[begin]");return[].map.call(u,(function(e){var r=xo(e,s);if(!r||!e.hasAttribute("begin"))return null;var n=Ro(e.getAttribute("begin"),a),u=Ro(e.getAttribute("dur"),a),c=Ro(e.getAttribute("end"),a);if(null===n)throw wo(e);if(null===c){if(null===u)throw wo(e);c=n+u}var d=new oo(n-t,c-t,r);d.id=ko(d.startTime,d.endTime,d.text);var p=function(e,t,r){var n="http://www.w3.org/ns/ttml#styling",a=null,i=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return i&&r.hasOwnProperty(i)&&(a=r[i]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((function(r,i){var s=Io(t,n,i)||Io(e,n,i)||Io(a,n,i);return s&&(r[i]=s),r}),{})}(l[e.getAttribute("region")],o[e.getAttribute("style")],o),h=p.textAlign;if(h){var f=Ao[h];f&&(d.lineAlign=f),d.align=h}return i(d,p),d})).filter((function(e){return null!==e}))}(e,c))}))}catch(e){n(e)}}else n(new Error("Could not parse IMSC1 mdat"))}function Po(e,t,r){var n=e.getElementsByTagName(t)[0];return n?[].slice.call(n.querySelectorAll(r)):[]}function Co(e){return e.reduce((function(e,t){var r=t.getAttribute("xml:id");return r&&(e[r]=t),e}),{})}function xo(e,t){return[].slice.call(e.childNodes).reduce((function(e,r,n){var a;return"br"===r.nodeName&&n?e+"\n":null!=(a=r.childNodes)&&a.length?xo(r,t):t?e+r.textContent.trim().replace(/\s+/g," "):e+r.textContent}),"")}function Io(e,t,r){return e&&e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null}function wo(e){return new Error("Could not parse ttml timestamp "+e)}function Ro(e,t){if(!e)return null;var r=uo(e);return null===r&&(bo.test(e)?r=function(e,t){var r=bo.exec(e),n=(0|r[4])+(0|r[5])/t.subFrameRate;return 3600*(0|r[1])+60*(0|r[2])+(0|r[3])+n/t.frameRate}(e,t):To.test(e)&&(r=function(e,t){var r=To.exec(e),n=Number(r[1]);switch(r[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/t.frameRate;case"t":return n/t.tickRate}return n}(e,t))),r}var Mo=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[],this.startTime=null},e}(),Do=function(){function e(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(P.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(P.FRAG_LOADING,this.onFragLoading,this),e.on(P.FRAG_LOADED,this.onFragLoaded,this),e.on(P.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(P.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(P.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(P.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(P.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=e.prototype;return t.destroy=function(){var e=this.hls;e.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(P.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(P.FRAG_LOADING,this.onFragLoading,this),e.off(P.FRAG_LOADED,this.onFragLoaded,this),e.off(P.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(P.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(P.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(P.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(P.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0},t.initCea608Parsers=function(){var e=new Mo(this,"textTrack1"),t=new Mo(this,"textTrack2"),r=new Mo(this,"textTrack3"),n=new Mo(this,"textTrack4");this.cea608Parser1=new io(1,e,t),this.cea608Parser2=new io(3,r,n)},t.addCues=function(e,t,r,n,a){for(var i,s,o,l,u=!1,c=a.length;c--;){var d=a[c],p=(i=d[0],s=d[1],o=t,l=r,Math.min(s,l)-Math.max(i,o));if(p>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],r),u=!0,p/(r-t)>.5))return}if(u||a.push([t,r]),this.config.renderTextTracksNatively){var h=this.captionsTracks[e];this.Cues.newCue(h,t,r,n)}else{var f=this.Cues.newCue(null,t,r,n);this.hls.trigger(P.CUES_PARSED,{type:"captions",cues:f,track:e})}},t.onInitPtsFound=function(e,t){var r=this,n=t.frag,a=t.id,i=t.initPTS,s=t.timescale,o=t.trackId,l=this.unparsedVttFrags;a===R&&(this.initPTS[n.cc]={baseTime:i,timescale:s,trackId:o}),l.length&&(this.unparsedVttFrags=[],l.forEach((function(e){r.initPTS[e.frag.cc]?r.onFragLoaded(P.FRAG_LOADED,e):r.hls.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e.frag,error:new Error("Subtitle discontinuity domain does not match main")})})))},t.getExistingTrack=function(e,t){var r=this.media;if(r)for(var n=0;n<r.textTracks.length;n++){var a=r.textTracks[n];if(Lo(a,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,n=this.media,a=t[e],i=a.label,s=a.languageCode,o=this.getExistingTrack(i,s);if(o)r[e]=o,Bs(r[e]),Us(r[e],n);else{var l=this.createTextTrack("captions",i,s);l&&(l[e]=!0,r[e]=l)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(P.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},t.createTextTrack=function(e,t,r){var n=this.media;if(n)return n.addTextTrack(e,t,r)},t.onMediaAttaching=function(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()},t.onMediaDetaching=function(e,t){var r=!!t.transferMedia;if(this.media=null,!r){var n=this.captionsTracks;Object.keys(n).forEach((function(e){Bs(n[e]),delete n[e]})),this.nonNativeCaptionsTracks={}}},t.onManifestLoading=function(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)Bs(t[r])}},t.onSubtitleTracksUpdated=function(e,t){var r=this,n=t.subtitleTracks||[],a=n.some((function(e){return e.textCodec===Eo}));if(this.config.enableWebVTT||a&&this.config.enableIMSC1){if(Ya(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){var i=this.media,s=i?Vs(i.textTracks):null;if(this.tracks.forEach((function(e,t){var n;if(s){for(var a=null,i=0;i<s.length;i++)if(s[i]&&Lo(s[i],e)){a=s[i],s[i]=null;break}a&&(n=a)}if(n)Bs(n);else{var o=Oo(e);(n=r.createTextTrack(o,e.name,e.lang))&&(n.mode="disabled")}n&&r.textTracks.push(n)})),null!=s&&s.length){var o=s.filter((function(e){return null!==e})).map((function(e){return e.label}));o.length&&this.hls.logger.warn("Media element contains unused subtitle tracks: "+o.join(", ")+". Replace media element for each source to clear TextTracks and captions menu.")}}else if(this.tracks.length){var l=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(P.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}},t.onManifestLoaded=function(e,t){var r=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var n="textTrack"+t[1],a=r.captionsProperties[n];a&&(a.label=e.name,e.lang&&(a.languageCode=e.lang),a.media=e)}}))},t.closedCaptionsForLevel=function(e){var t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]},t.onFragLoading=function(e,t){if(this.enabled&&t.frag.type===R){var r,n,a=this.cea608Parser1,i=this.cea608Parser2,s=this.lastSn,o=t.frag,l=o.cc,u=o.sn,c=null!=(r=null==(n=t.part)?void 0:n.index)?r:-1;a&&i&&(u!==s+1||u===s&&c!==this.lastPartIndex+1||l!==this.lastCc)&&(a.reset(),i.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=c}},t.onFragLoaded=function(e,t){var r=t.frag,n=t.payload;if(r.type===D)if(n.byteLength){var a=r.decryptdata,i="stats"in t;if(null==a||!a.encrypted||i){var s=this.tracks[r.level],o=this.vttCCs;o[r.cc]||(o[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),s&&s.textCodec===Eo?this._parseIMSC1(r,n):this._parseVTTs(t)}}else this.hls.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(e,t){var r=this,n=this.hls;So(t,this.initPTS[e.cc],(function(t){r._appendCues(t,e.level),n.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){n.logger.log("Failed to parse IMSC1: "+t),n.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))},t._parseVTTs=function(e){var t,r=this,n=e.frag,a=e.payload,i=this.initPTS,s=this.unparsedVttFrags,o=i.length-1;if(i[n.cc]||-1!==o){var l=this.hls;!function(e,t,r,n,a,i,s){var o,l,u,c=new yo,d=$(new Uint8Array(e)).trim().replace(vo,"\n").split("\n"),p=[],h=t?(o=t.baseTime,void 0===(l=t.timescale)&&(l=1),_a(o,9e4,1/l)):0,f="00:00.000",m=0,g=0,y=!0;c.oncue=function(e){var i=r[n],s=r.ccOffset,o=(m-h)/9e4;if(null!=i&&i.new&&(void 0!==g?s=r.ccOffset=i.start:function(e,t,r){var n=e[t],a=e[n.prevCC];if(!a||!a.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;null!=(i=a)&&i.new;){var i;e.ccOffset+=n.start-a.start,n.new=!1,a=e[(n=a).prevCC]}e.presentationOffset=r}(r,n,o)),o){if(!t)return void(u=new Error("Missing initPTS for VTT MPEGTS"));s=o-r.presentationOffset}var l=e.endTime-e.startTime,c=Sa(9e4*(e.startTime+s-g),9e4*a)/9e4;e.startTime=Math.max(c,0),e.endTime=Math.max(c+l,0);var d=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(d)),e.id||(e.id=ko(e.startTime,e.endTime,d)),e.endTime>0&&p.push(e)},c.onparsingerror=function(e){u=e},c.onflush=function(){u?s(u):i(p)},d.forEach((function(e){if(y){if(_o(e,"X-TIMESTAMP-MAP=")){y=!1,e.slice(16).split(",").forEach((function(e){_o(e,"LOCAL:")?f=e.slice(6):_o(e,"MPEGTS:")&&(m=parseInt(e.slice(7)))}));try{g=function(e){var t=parseInt(e.slice(-3)),r=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(E(t)&&E(r)&&E(n)&&E(a)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*r,(t+=6e4*n)+36e5*a}(f)/1e3}catch(e){u=e}return}""===e&&(y=!1)}c.parse(e+"\n")})),c.flush()}(null!=(t=n.initSegment)&&t.data?Ee(n.initSegment.data,new Uint8Array(a)).buffer:a,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(function(e){r._appendCues(e,n.level),l.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(function(t){var i="Missing initPTS for VTT MPEGTS"===t.message;i?s.push(e):r._fallbackToIMSC1(n,a),l.logger.log("Failed to parse VTT cue: "+t),i&&o>n.cc||l.trigger(P.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}else s.push(e)},t._fallbackToIMSC1=function(e,t){var r=this,n=this.tracks[e.level];n.textCodec||So(t,this.initPTS[e.cc],(function(){n.textCodec=Eo,r._parseIMSC1(e,t)}),(function(){n.textCodec="wvtt"}))},t._appendCues=function(e,t){var r=this.hls;if(this.config.renderTextTracksNatively){var n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach((function(e){return js(n,e)}))}else{var a=this.tracks[t];if(!a)return;var i=a.default?"default":"subtitles"+t;r.trigger(P.CUES_PARSED,{type:"subtitles",cues:e,track:i})}},t.onFragDecrypted=function(e,t){t.frag.type===D&&this.onFragLoaded(P.FRAG_LOADED,t)},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,t){if(this.enabled&&this.config.enableCEA708Captions){var r=t.frag,n=t.samples;if(r.type!==R||"NONE"!==this.closedCaptionsForLevel(r))for(var a=0;a<n.length;a++){var i=n[a].bytes;if(i){this.cea608Parser1||this.initCea608Parsers();var s=this.extractCea608Data(i);this.cea608Parser1.addData(n[a].pts,s[0]),this.cea608Parser2.addData(n[a].pts,s[1])}}}},t.onBufferFlushing=function(e,t){var r=t.startOffset,n=t.endOffset,a=t.endOffsetSubtitles,i=t.type,s=this.media;if(s&&!(s.currentTime<n)){if(!i||"video"===i){var o=this.captionsTracks;Object.keys(o).forEach((function(e){return Fs(o[e],r,n)}))}if(this.config.renderTextTracksNatively&&0===r&&void 0!==a){var l=this.textTracks;Object.keys(l).forEach((function(e){return Fs(l[e],r,a)}))}}},t.extractCea608Data=function(e){for(var t=[[],[]],r=31&e[0],n=2,a=0;a<r;a++){var i=e[n++],s=127&e[n++],o=127&e[n++];if((0!==s||0!==o)&&0!=(4&i)){var l=3&i;0!==l&&1!==l||(t[l].push(s),t[l].push(o))}}return t},e}();function Oo(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function Lo(e,t){return!!e&&e.kind===Oo(t)&&Za(t,e)}var No=/\s/,Uo={newCue:function(e,t,r,n){for(var a,i,s,o,l,u=[],c=self.VTTCue||self.TextTrackCue,d=0;d<n.rows.length;d++)if(s=!0,o=0,l="",!(a=n.rows[d]).isEmpty()){for(var p,h=0;h<a.chars.length;h++)No.test(a.chars[h].uchar)&&s?o++:(l+=a.chars[h].uchar,s=!1);a.cueStartTime=t,t===r&&(r+=1e-4),o>=16?o--:o++;var f=go(l.trim()),m=ko(t,r,f);null!=e&&null!=(p=e.cues)&&p.getCueById(m)||((i=new c(t,r,f)).id=m,i.line=d+1,i.align="left",i.position=10+Math.min(80,10*Math.floor(8*o/32)),u.push(i))}return e&&u.length&&(u.sort((function(e,t){return"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line})),u.forEach((function(t){return js(e,t)}))),u}},jo=/(\d+)-(\d+)\/(\d+)/,Bo=function(){function e(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||Fo,this.controller=new self.AbortController,this.stats=new Y}var t=e.prototype;return t.destroy=function(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null},t.abortInternal=function(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())},t.abort=function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},t.load=function(e,t,r){var n=this,a=this.stats;if(a.loading.start)throw new Error("Loader can only be used once.");a.loading.start=self.performance.now();var s=function(e,t){var r={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(i({},e.headers))};return e.rangeEnd&&r.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),r}(e,this.controller.signal),o="arraybuffer"===e.responseType,l=o?"byteLength":"length",u=t.loadPolicy,c=u.maxTimeToFirstByteMs,d=u.maxLoadTimeMs;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=c&&E(c)?c:d,this.requestTimeout=self.setTimeout((function(){n.callbacks&&(n.abortInternal(),n.callbacks.onTimeout(a,e,n.response))}),t.timeout),(La(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then((function(r){var i;n.response=n.loader=r;var s=Math.max(self.performance.now(),a.loading.start);if(self.clearTimeout(n.requestTimeout),t.timeout=d,n.requestTimeout=self.setTimeout((function(){n.callbacks&&(n.abortInternal(),n.callbacks.onTimeout(a,e,n.response))}),d-(s-a.loading.start)),!r.ok){var l=r.status,u=r.statusText;throw new Vo(u||"fetch, bad network response",l,r)}a.loading.first=s,a.total=function(e){var t=e.get("Content-Range");if(t){var r=function(e){var t=jo.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(E(r))return r}var n=e.get("Content-Length");if(n)return parseInt(n)}(r.headers)||a.total;var c=null==(i=n.callbacks)?void 0:i.onProgress;return c&&E(t.highWaterMark)?n.loadProgressively(r,a,e,t.highWaterMark,c):o?r.arrayBuffer():"json"===e.responseType?r.json():r.text()})).then((function(r){var i,s,o=n.response;if(!o)throw new Error("loader destroyed");self.clearTimeout(n.requestTimeout),a.loading.end=Math.max(self.performance.now(),a.loading.first);var u=r[l];u&&(a.loaded=a.total=u);var c={url:o.url,data:r,code:o.status},d=null==(i=n.callbacks)?void 0:i.onProgress;d&&!E(t.highWaterMark)&&d(a,e,r,o),null==(s=n.callbacks)||s.onSuccess(c,a,e,o)})).catch((function(t){var r;if(self.clearTimeout(n.requestTimeout),!a.aborted){var i=t&&t.code||0,s=t?t.message:null;null==(r=n.callbacks)||r.onError({code:i,text:s},e,t?t.details:null,a)}}))},t.getCacheAge=function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null}return e},t.getResponseHeader=function(e){return this.response?this.response.headers.get(e):null},t.loadProgressively=function(e,t,r,n,a){void 0===n&&(n=0);var i=new pn,s=e.body.getReader(),o=function(){return s.read().then((function(s){if(s.done)return i.dataLength&&a(t,r,i.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));var l=s.value,u=l.length;return t.loaded+=u,u<n||i.dataLength?(i.push(l),i.dataLength>=n&&a(t,r,i.flush().buffer,e)):a(t,r,l.buffer,e),o()})).catch((function(){return Promise.reject()}))};return o()},e}();function Fo(e,t){return new self.Request(e.url,t)}var Vo=function(e){function t(t,r,n){var a;return(a=e.call(this,t)||this).code=void 0,a.details=void 0,a.code=r,a.details=n,a}return o(t,e),t}(h(Error)),Go=/^age:\s*[\d.]+\s*$/im,Ho=function(){function e(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Y,this.retryDelay=0}var t=e.prototype;return t.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null},t.abortInternal=function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))},t.abort=function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},t.load=function(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()},t.loadInternal=function(){var e=this,t=this.config,r=this.context;if(t&&r){var n=this.loader=new self.XMLHttpRequest,a=this.stats;a.loading.first=0,a.loaded=0,a.aborted=!1;var i=this.xhrSetup;i?Promise.resolve().then((function(){if(e.loader===n&&!e.stats.aborted)return i(n,r.url)})).catch((function(t){if(e.loader===n&&!e.stats.aborted)return n.open("GET",r.url,!0),i(n,r.url)})).then((function(){e.loader!==n||e.stats.aborted||e.openAndSendXhr(n,r,t)})).catch((function(t){var i;null==(i=e.callbacks)||i.onError({code:n.status,text:t.message},r,n,a)})):this.openAndSendXhr(n,r,t)}},t.openAndSendXhr=function(e,t,r){e.readyState||e.open("GET",t.url,!0);var n=t.headers,a=r.loadPolicy,i=a.maxTimeToFirstByteMs,s=a.maxLoadTimeMs;if(n)for(var o in n)e.setRequestHeader(o,n[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=i&&E(i)?i:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()},t.readystatechange=function(){var e=this.context,t=this.loader,r=this.stats;if(e&&t){var n=t.readyState,a=this.config;if(!r.aborted&&n>=2&&(0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),4===n)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;var i=t.status,s="text"===t.responseType?t.responseText:null;if(i>=200&&i<300){var o=null!=s?s:t.response;if(null!=o){var l,u;r.loading.end=Math.max(self.performance.now(),r.loading.first);var c="arraybuffer"===t.responseType?o.byteLength:o.length;r.loaded=r.total=c,r.bwEstimate=8e3*r.total/(r.loading.end-r.loading.first);var d=null==(l=this.callbacks)?void 0:l.onProgress;d&&d(r,e,o,t);var p={url:t.responseURL,data:o,code:i};return void(null==(u=this.callbacks)||u.onSuccess(p,r,e,t))}}var h,f=a.loadPolicy.errorRetry;Tt(f,r.retry,!1,{url:e.url,data:void 0,code:i})?this.retry(f):(H.error(i+" while loading "+e.url),null==(h=this.callbacks)||h.onError({code:i,text:t.statusText},e,t,r))}}},t.loadtimeout=function(){if(this.config){var e=this.config.loadPolicy.timeoutRetry;if(Tt(e,this.stats.retry,!0))this.retry(e);else{var t;H.warn("timeout while loading "+(null==(t=this.context)?void 0:t.url));var r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}},t.retry=function(e){var t=this.context,r=this.stats;this.retryDelay=Et(e,r.retry),r.retry++,H.warn((status?"HTTP Status "+status:"Timeout")+" while loading "+(null==t?void 0:t.url)+", retrying "+r.retry+"/"+e.maxNumRetry+" in "+this.retryDelay+"ms"),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)},t.loadprogress=function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)},t.getCacheAge=function(){var e=null;if(this.loader&&Go.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e},t.getResponseHeader=function(e){return this.loader&&new RegExp("^"+e+":\\s*[\\d.]+\\s*$","im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null},e}(),Ko=c(c({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:Ho,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:dt,bufferController:ni,capLevelController:si,errorController:St,fpsController:vs,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:br,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:Uo,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Ls,subtitleTrackController:Gs,timelineController:Do,audioStreamController:za,audioTrackController:Qa,emeController:hs,cmcdController:us,contentSteeringController:cs,interstitialsController:Os});function Wo(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(Wo):Object.keys(e).reduce((function(t,r){return t[r]=Wo(e[r]),t}),{}):e}var $o=function(e){function t(t,r){var n;return(n=e.call(this,"gap-controller",t.logger)||this).hls=void 0,n.fragmentTracker=void 0,n.media=null,n.mediaSource=void 0,n.nudgeRetry=0,n.stallReported=!1,n.stalled=null,n.moved=!1,n.seeking=!1,n.buffered={},n.lastCurrentTime=0,n.ended=0,n.waiting=0,n.onMediaPlaying=function(){n.ended=0,n.waiting=0},n.onMediaWaiting=function(){var e;null!=(e=n.media)&&e.seeking||(n.waiting=self.performance.now(),n.tick())},n.onMediaEnded=function(){var e;n.hls&&(n.ended=(null==(e=n.media)?void 0:e.currentTime)||1,n.hls.trigger(P.MEDIA_ENDED,{stalled:!1}))},n.hls=t,n.fragmentTracker=r,n.registerListeners(),n}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e&&(e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.BUFFER_APPENDED,this.onBufferAppended,this))},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.BUFFER_APPENDED,this.onBufferAppended,this))},r.destroy=function(){e.prototype.destroy.call(this),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0},r.onMediaAttached=function(e,t){this.setInterval(100),this.mediaSource=t.mediaSource;var r=this.media=t.media;on(r,"playing",this.onMediaPlaying),on(r,"waiting",this.onMediaWaiting),on(r,"ended",this.onMediaEnded)},r.onMediaDetaching=function(e,t){this.clearInterval();var r=this.media;r&&(ln(r,"playing",this.onMediaPlaying),ln(r,"waiting",this.onMediaWaiting),ln(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0},r.onBufferAppended=function(e,t){this.buffered=t.timeRanges},r.tick=function(){var e;if(null!=(e=this.media)&&e.readyState&&this.hasBuffered){var t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}},r.poll=function(e,t){var r,n,a=null==(r=this.hls)?void 0:r.config;if(a){var i=this.media;if(i){var s=i.seeking,o=this.seeking&&!s,l=!this.seeking&&s,u=i.paused&&!s||i.ended||0===i.playbackRate;if(this.seeking=s,e!==t)return t&&(this.ended=0),this.moved=!0,s||(this.nudgeRetry=0,a.nudgeOnVideoHole&&!u&&e>t&&this.nudgeOnVideoHole(e,t)),void(0===this.waiting&&this.stallResolved(e));if(l||o)o&&this.stallResolved(e);else{if(u)return this.nudgeRetry=0,this.stallResolved(e),void(!this.ended&&i.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(P.MEDIA_ENDED,{stalled:!1})));if(zt.getBuffered(i).length){var c=zt.bufferInfo(i,e,0),d=c.nextStart||0,p=this.fragmentTracker;if(s&&p&&this.hls){var h=zo(this.hls.inFlightFragments,e),f=c.len>2,m=!d||h||d-e>2&&!p.getPartialFragment(e);if(f||m)return;this.moved=!1}var g=null==(n=this.hls)?void 0:n.latestLevelDetails;if(!this.moved&&null!==this.stalled&&p){if(!(c.len>0||d))return;var y=Math.max(d,c.start||0)-e,v=null!=g&&g.live?2*g.targetduration:2,_=Yo(e,p);if(y>0&&(y<=v||_))return void(i.paused||this._trySkipBufferHole(_))}var k=a.detectStallWithCurrentTimeMs,E=self.performance.now(),b=this.waiting,T=this.stalled;if(null===T){if(!(b>0&&E-b<k))return void(this.stalled=E);T=this.stalled=b}var A=E-T;if(!s&&(A>=k||b)&&this.hls){var S;if("ended"===(null==(S=this.mediaSource)?void 0:S.readyState)&&(null==g||!g.live)&&Math.abs(e-((null==g?void 0:g.edge)||0))<1){if(this.ended)return;return this.ended=e||1,void this.hls.trigger(P.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(c),!this.media||!this.hls)return}var C=zt.bufferInfo(i,e,a.maxBufferHole);this._tryFixBufferStall(C,A,e)}else this.nudgeRetry=0}}}},r.stallResolved=function(e){var t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){var r=self.performance.now()-t;this.log("playback not stuck anymore @"+e+", after "+Math.round(r)+"ms"),this.stallReported=!1,this.waiting=0,this.hls.trigger(P.STALL_RESOLVED,{})}},r.nudgeOnVideoHole=function(e,t){var r,n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(r=this.buffered.audio)&&r.length&&n&&n.length>1&&e>n.end(0)){var a=zt.bufferedInfo(zt.timeRangesToArray(this.buffered.audio),e,0);if(a.len>1&&t>=a.start){var i=zt.timeRangesToArray(n),s=zt.bufferedInfo(i,t,0).bufferedIndex;if(s>-1&&s<i.length-1){var o=zt.bufferedInfo(i,e,0).bufferedIndex,l=i[s].end,u=i[s+1].start;if((-1===o||o>s)&&u-l<1&&e-l<2){var c=new Error("nudging playhead to flush pipeline after video hole. currentTime: "+e+" hole: "+l+" -> "+u+" buffered index: "+o);this.warn(c.message),this.media.currentTime+=1e-6;var d=Yo(e,this.fragmentTracker);d&&"fragment"in d?d=d.fragment:d||(d=void 0);var p=zt.bufferInfo(this.media,e,0);this.hls.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:c,reason:c.message,frag:d,buffer:p.len,bufferInfo:p})}}}}},r._tryFixBufferStall=function(e,t,r){var n,a,i=this.fragmentTracker,s=this.media,o=null==(n=this.hls)?void 0:n.config;if(s&&i&&o){var l=null==(a=this.hls)?void 0:a.latestLevelDetails,u=Yo(r,i);if((u||null!=l&&l.live&&r<l.fragmentStart)&&(this._trySkipBufferHole(u)||!this.media))return;var c=e.buffered,d=this.adjacentTraversal(e,r);(c&&c.length>1&&e.len>o.maxBufferHole||e.nextStart&&(e.nextStart-r<o.maxBufferHole||d))&&(t>1e3*o.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}},r.adjacentTraversal=function(e,t){var r=this.fragmentTracker,n=e.nextStart;if(r&&n){var a=r.getFragAtPos(t,R),i=r.getFragAtPos(n,R);if(a&&i)return i.sn-a.sn<2}return!1},r._reportStall=function(e){var t=this.hls,r=this.media,n=this.stallReported,a=this.stalled;if(!n&&null!==a&&r&&t){this.stallReported=!0;var i=new Error("Playback stalling at @"+r.currentTime+" due to low buffer ("+rt(e)+")");this.warn(i.message),t.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len,bufferInfo:e,stalled:{start:a}})}},r._trySkipBufferHole=function(e){var t,r=this.fragmentTracker,n=this.media,a=null==(t=this.hls)?void 0:t.config;if(!n||!r||!a)return 0;var i=n.currentTime,s=zt.bufferInfo(n,i,0),o=i<s.start?s.start:s.nextStart;if(o&&this.hls){var l=s.len<=a.maxBufferHole,u=s.len>0&&s.len<1&&n.readyState<3,c=o-i;if(c>0&&(l||u)){if(c>a.maxBufferHole){var d=!1;if(0===i){var p=r.getAppendedFrag(0,R);p&&o<p.end&&(d=!0)}if(!d&&e){var h;if(null==(h=this.hls.loadLevelObj)||!h.details)return 0;if(zo(this.hls.inFlightFragments,o))return 0;for(var f=!1,m=e.end;m<o;){var g=Yo(m,r);if(!g){f=!0;break}m+=g.duration}if(f)return 0}}var y=Math.max(o+.05,i+.1);if(this.warn("skipping hole, adjusting currentTime from "+i+" to "+y),this.moved=!0,n.currentTime=y,null==e||!e.gap){var v=new Error("fragment loaded with buffer holes, seeking from "+i+" to "+y),_={type:A.MEDIA_ERROR,details:S.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:v,reason:v.message,buffer:s.len,bufferInfo:s};e&&("fragment"in e?_.part=e:_.frag=e),this.hls.trigger(P.ERROR,_)}return y}}return 0},r._tryNudgeBuffer=function(e){var t=this.hls,r=this.media,n=this.nudgeRetry,a=null==t?void 0:t.config;if(!r||!a)return 0;var i=r.currentTime;if(this.nudgeRetry++,n<a.nudgeMaxRetry){var s=i+(n+1)*a.nudgeOffset,o=new Error("Nudging 'currentTime' from "+i+" to "+s);this.warn(o.message),r.currentTime=s,t.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1,buffer:e.len,bufferInfo:e})}else{var l=new Error("Playhead still not moving while enough data buffered @"+i+" after "+a.nudgeMaxRetry+" nudges");this.error(l.message),t.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.BUFFER_STALLED_ERROR,error:l,fatal:!0,buffer:e.len,bufferInfo:e})}},n(t,[{key:"hasBuffered",get:function(){return Object.keys(this.buffered).length>0}}])}(Kt);function zo(e,t){var r=qo(e.main);if(r&&r.start<=t)return r;var n=qo(e.audio);return n&&n.start<=t?n:null}function qo(e){if(!e)return null;switch(e.state){case un.IDLE:case un.STOPPED:case un.ENDED:case un.ERROR:return null}return e.frag}function Yo(e,t){return t.getAppendedFrag(e,R)||t.getPartialFragment(e)}function Xo(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function Zo(e,t,r,n,a){var i=new e(t,r,"");try{i.value=n,a&&(i.type=a)}catch(s){i=new e(t,r,rt(a?c({type:a},n):n))}return i}var Qo=function(){var e=Xo();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}(),Jo=function(){function e(e){var t=this;this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=function(){t.hls&&t.hls.trigger(P.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}var t=e.prototype;return t.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null},t._registerListeners=function(){var e=this.hls;e&&(e.on(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(P.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))},t._unregisterListeners=function(){var e=this.hls;e&&(e.off(P.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(P.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(P.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))},t.onMediaAttaching=function(e,t){var r;this.media=t.media,!1===(null==(r=t.overrides)?void 0:r.cueRemoval)&&(this.removeCues=!1)},t.onMediaAttached=function(){var e,t=null==(e=this.hls)?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)},t.onMediaDetaching=function(e,t){this.media=null,t.transferMedia||(this.id3Track&&(this.removeCues&&Bs(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})},t.onManifestLoading=function(){this.dateRangeCuesAppended={}},t.createTrack=function(e){var t=this.getID3Track(e.textTracks);return t.mode="hidden",t},t.getID3Track=function(e){if(this.media){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return Us(r,this.media),r}return this.media.addTextTrack("metadata","id3")}},t.onFragParsingMetadata=function(e,t){if(this.media&&this.hls){var r=this.hls.config,n=r.enableEmsgMetadataCues,a=r.enableID3MetadataCues;if(n||a){var i=t.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));var s=Xo();if(s)for(var o=0;o<i.length;o++){var l=i[o].type;if((l!==Ln.emsg||n)&&a){var u=Rn(i[o].data),c=i[o].pts,d=c+i[o].duration;d>Qo&&(d=Qo),d-c<=0&&(d=c+.25);for(var p=0;p<u.length;p++){var h=u[p];if(!Mn(h)){this.updateId3CueEnds(c,l);var f=Zo(s,c,d,h,l);f&&this.id3Track.addCue(f)}}}}}}},t.updateId3CueEnds=function(e,t){var r,n=null==(r=this.id3Track)?void 0:r.cues;if(n)for(var a=n.length;a--;){var i=n[a];i.type===t&&i.startTime<e&&i.endTime===Qo&&(i.endTime=e)}},t.onBufferFlushing=function(e,t){var r=t.startOffset,n=t.endOffset,a=t.type,i=this.id3Track,s=this.hls;if(s){var o=s.config,l=o.enableEmsgMetadataCues,u=o.enableID3MetadataCues;i&&(l||u)&&Fs(i,r,n,"audio"===a?function(e){return e.type===Ln.audioId3&&u}:"video"===a?function(e){return e.type===Ln.emsg&&l}:function(e){return e.type===Ln.audioId3&&u||e.type===Ln.emsg&&l})}},t.onLevelUpdated=function(e,t){var r=t.details;this.updateDateRangeCues(r,!0)},t.onLevelPtsUpdated=function(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)},t.updateDateRangeCues=function(e,t){var r=this;if(this.hls&&this.media){var n=this.hls.config,a=n.assetPlayerId,i=n.timelineOffset,s=n.enableDateRangeMetadataCues,o=n.interstitialsController;if(s){var l=Xo();if(a&&i&&!o){var u=e.fragmentStart,c=e.fragmentEnd,d=this.assetCue;d?(d.startTime=u,d.endTime=c):l&&(d=this.assetCue=Zo(l,u,c,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"))&&(d.id=a,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(d),d.addEventListener("enter",this.onEventCueEnter))}if(e.hasProgramDateTime){var p,h=this.id3Track,f=e.dateRanges,m=Object.keys(f),g=this.dateRangeCuesAppended;if(h&&t)if(null!=(p=h.cues)&&p.length)for(var y=Object.keys(g).filter((function(e){return!m.includes(e)})),v=function(){var e,t=y[_],n=null==(e=g[t])?void 0:e.cues;delete g[t],n&&Object.keys(n).forEach((function(e){var t=n[e];if(t){t.removeEventListener("enter",r.onEventCueEnter);try{h.removeCue(t)}catch(e){}}}))},_=y.length;_--;)v();else g=this.dateRangeCuesAppended={};var k=e.fragments[e.fragments.length-1];if(0!==m.length&&E(null==k?void 0:k.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var b=function(){var e=m[T],t=f[e],n=t.startTime,a=g[e],i=(null==a?void 0:a.cues)||{},s=(null==a?void 0:a.durationKnown)||!1,u=Qo,c=t.duration;if(t.endDate&&null!==c)u=n+c,s=!0;else if(t.endOnNext&&!s){var d=m.reduce((function(e,r){if(r!==t.id){var n=f[r];if(n.class===t.class&&n.startDate>t.startDate&&(!e||t.startDate<e.startDate))return n}return e}),null);d&&(u=d.startTime,s=!0)}for(var p,h=Object.keys(t.attr),y=0;y<h.length;y++){var v=h[y];if("ID"!==(p=v)&&"CLASS"!==p&&"CUE"!==p&&"START-DATE"!==p&&"DURATION"!==p&&"END-DATE"!==p&&"END-ON-NEXT"!==p){var _=i[v];if(_)!s||null!=a&&a.durationKnown?Math.abs(_.startTime-n)>.01&&(_.startTime=n,_.endTime=u):_.endTime=u;else if(l){var k=t.attr[v];rr(v)&&(k=q(k));var E=Zo(l,n,u,{key:v,data:k},Ln.dateRange);E&&(E.id=e,r.id3Track.addCue(E),i[v]=E,o&&("X-ASSET-LIST"!==v&&"X-ASSET-URL"!==v||E.addEventListener("enter",r.onEventCueEnter)))}}}g[e]={cues:i,dateRange:t,durationKnown:s}},T=0;T<m.length;T++)b()}}}}},e}(),el=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=function(){var e=t.media,r=t.levelDetails;if(e&&r){t.currentTime=e.currentTime;var n=t.computeLatency();if(null!==n){t._latency=n;var a=t.config,i=a.lowLatencyMode,s=a.maxLiveSyncPlaybackRate;if(i&&1!==s&&r.live){var o=t.targetLatency;if(null!==o){var l=n-o;if(l<Math.min(t.maxLatency,o+r.targetduration)&&l>.05&&t.forwardBufferLength>1){var u=Math.min(2,Math.max(1,s)),c=Math.round(2/(1+Math.exp(-.75*l-t.edgeStalled))*20)/20,d=Math.min(u,Math.max(1,c));t.changeMediaPlaybackRate(e,d)}else 1!==e.playbackRate&&0!==e.playbackRate&&t.changeMediaPlaybackRate(e,1)}}}}},this.hls=e,this.config=e.config,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null},t.registerListeners=function(){var e=this.hls;e&&(e.on(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(P.ERROR,this.onError,this))},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(P.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(P.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(P.ERROR,this.onError,this))},t.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)},t.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)},t.onManifestLoading=function(){this._latency=null,this.stallCount=0},t.onLevelUpdated=function(e,t){var r=t.details;r.advanced&&this.onTimeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)},t.onError=function(e,t){var r;t.details===S.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(r=this.levelDetails)&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))},t.changeMediaPlaybackRate=function(e,t){var r,n;e.playbackRate!==t&&(null==(r=this.hls)||r.logger.debug("[latency-controller]: latency="+this.latency.toFixed(3)+", targetLatency="+(null==(n=this.targetLatency)?void 0:n.toFixed(3))+", forwardBufferLength="+this.forwardBufferLength.toFixed(3)+": adjusting playback rate from "+e.playbackRate+" to "+t),e.playbackRate=t)},t.estimateLiveEdge=function(){var e=this.levelDetails;return null===e?null:e.edge+e.age},t.computeLatency=function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime},n(e,[{key:"levelDetails",get:function(){var e;return(null==(e=this.hls)?void 0:e.latestLevelDetails)||null}},{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config;if(void 0!==e.liveMaxLatencyDuration)return e.liveMaxLatencyDuration;var t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e||null===this.hls)return null;var t=e.holdBack,r=e.partHoldBack,n=e.targetduration,a=this.config,i=a.liveSyncDuration,s=a.liveSyncDurationCount,o=a.lowLatencyMode,l=this.hls.userConfig,u=o&&r||t;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||0===u)&&(u=void 0!==i?i:s*n);var c=n;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,c)},set:function(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency;if(null===e||null===t)return null;var r=this.levelDetails;if(null===r)return null;var n=r.edge,a=e-t-this.edgeStalled,i=n-r.totalduration,s=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(i,a),s)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}}])}(),tl=function(e){function t(t,r){var n;return(n=e.call(this,t,"level-controller")||this)._levels=[],n._firstLevel=-1,n._maxAutoLevel=-1,n._startLevel=void 0,n.currentLevel=null,n.currentLevelIndex=-1,n.manualLevelIndex=-1,n.steering=void 0,n.onParsedComplete=void 0,n.steering=r,n._registerListeners(),n}o(t,e);var r=t.prototype;return r._registerListeners=function(){var e=this.hls;e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(P.LEVEL_LOADED,this.onLevelLoaded,this),e.on(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(P.FRAG_BUFFERED,this.onFragBuffered,this),e.on(P.ERROR,this.onError,this)},r._unregisterListeners=function(){var e=this.hls;e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(P.LEVEL_LOADED,this.onLevelLoaded,this),e.off(P.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(P.FRAG_BUFFERED,this.onFragBuffered,this),e.off(P.ERROR,this.onError,this)},r.destroy=function(){this._unregisterListeners(),this.steering=null,this.resetLevels(),e.prototype.destroy.call(this)},r.stopLoad=function(){this._levels.forEach((function(e){e.loadError=0,e.fragmentError=0})),e.prototype.stopLoad.call(this)},r.resetLevels=function(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1},r.onManifestLoading=function(e,t){this.resetLevels()},r.onManifestLoaded=function(e,t){var r=this,n=this.hls.config.preferManagedMediaSource,a=[],i={},s={},o=!1,l=!1,u=!1;t.levels.forEach((function(e){var t=e.attrs,c=e.audioCodec,d=e.videoCodec;c&&(e.audioCodec=c=je(c,n)||void 0),d&&(d=e.videoCodec=function(e){for(var t=e.split(","),r=0;r<t.length;r++){var n=t[r].split(".");n.length>2&&"avc1"===n[0]&&(t[r]="avc1."+parseInt(n[1]).toString(16)+("000"+parseInt(n[2]).toString(16)).slice(-4))}return t.join(",")}(d));var p=e.width,h=e.height,f=e.unknownCodecs,m=(null==f?void 0:f.length)||0;if(o||(o=!(!p||!h)),l||(l=!!d),u||(u=!!c),m||c&&!r.isAudioSupported(c)||d&&!r.isVideoSupported(d))r.log('Some or all CODECS not supported "'+t.CODECS+'"');else{var g=t.CODECS,y=t["FRAME-RATE"],v=t["HDCP-LEVEL"],_=t["PATHWAY-ID"],k=t.RESOLUTION,E=t["VIDEO-RANGE"],b=(_||".")+"-"+e.bitrate+"-"+k+"-"+y+"-"+g+"-"+E+"-"+v;if(i[b])if(i[b].uri===e.url||e.attrs["PATHWAY-ID"])i[b].addGroupId("audio",t.AUDIO),i[b].addGroupId("text",t.SUBTITLES);else{var T=s[b]+=1;e.attrs["PATHWAY-ID"]=new Array(T+1).join(".");var A=r.createLevel(e);i[b]=A,a.push(A)}else{var S=r.createLevel(e);i[b]=S,s[b]=1,a.push(S)}}})),this.filterAndSortMediaOptions(a,t,o,l,u)},r.createLevel=function(e){var t=new et(e),r=e.supplemental;if(null!=r&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){var n=new Error('SUPPLEMENTAL-CODECS not supported "'+r.videoCodec+'"');this.log(n.message),t.supportedResult=$e(n,[])}return t},r.isAudioSupported=function(e){return Re(e,"audio",this.hls.config.preferManagedMediaSource)},r.isVideoSupported=function(e){return Re(e,"video",this.hls.config.preferManagedMediaSource)},r.filterAndSortMediaOptions=function(e,t,r,n,a){var i,s=this,o=[],l=[],u=e,c=(null==(i=t.stats)?void 0:i.parsing)||{};if((r||n)&&a&&(u=u.filter((function(e){var t,r=e.videoCodec,n=e.videoRange,a=e.width,i=e.height;return(!!r||!(!a||!i))&&!!(t=n)&&Ze.indexOf(t)>-1}))),0===u.length)return Promise.resolve().then((function(){if(s.hls){var e="no level with compatible codecs found in manifest",r=e;t.levels.length&&(r="one or more CODECS in variant not supported: "+rt(t.levels.map((function(e){return e.attrs.CODECS})).filter((function(e,t,r){return r.indexOf(e)===t}))),s.warn(r),e+=" ("+r+")");var n=new Error(e);s.hls.trigger(P.ERROR,{type:A.MEDIA_ERROR,details:S.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:n,reason:r})}})),void(c.end=performance.now());t.audioTracks&&rl(o=t.audioTracks.filter((function(e){return!e.audioCodec||s.isAudioSupported(e.audioCodec)}))),t.subtitles&&rl(l=t.subtitles);var d=u.slice(0);u.sort((function(e,t){if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return Ze.indexOf(e.videoRange)-Ze.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){var n=Oe(e.videoCodec),a=Oe(t.videoCodec);if(n!==a)return a-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){var i=Le(e.codecSet),s=Le(t.codecSet);if(i!==s)return s-i}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0}));var p=d[0];if(this.steering&&(u=this.steering.filterParsedLevels(u)).length!==d.length)for(var h=0;h<d.length;h++)if(d[h].pathwayId===u[0].pathwayId){p=d[h];break}this._levels=u;for(var f=0;f<u.length;f++)if(u[f]===p){var m;this._firstLevel=f;var g=p.bitrate,y=this.hls.bandwidthEstimate;if(this.log("manifest loaded, "+u.length+" level(s) found, first bitrate: "+g),void 0===(null==(m=this.hls.userConfig)?void 0:m.abrEwmaDefaultEstimate)){var v=Math.min(g,this.hls.config.abrEwmaDefaultEstimateMax);v>y&&y===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=v)}break}var _=a&&!n,k=this.hls.config,E=!(!k.audioStreamController||!k.audioTrackController),b={levels:u,audioTracks:o,subtitleTracks:l,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:n,altAudio:E&&!_&&o.some((function(e){return!!e.url}))};c.end=performance.now(),this.hls.trigger(P.MANIFEST_PARSED,b)},r.onError=function(e,t){!t.fatal&&t.context&&t.context.type===x&&t.context.level===this.level&&this.checkRetry(t)},r.onFragBuffered=function(e,t){var r=t.frag;if(void 0!==r&&r.type===R){var n=r.elementaryStreams;if(!Object.keys(n).some((function(e){return!!n[e]})))return;var a=this._levels[r.level];null!=a&&a.loadError&&(this.log("Resetting level error count of "+a.loadError+" on frag buffered"),a.loadError=0)}},r.onLevelLoaded=function(e,t){var r,n,a=t.level,i=t.details,s=t.levelInfo;if(!s)return this.warn("Invalid level index "+a),void(null!=(n=t.deliveryDirectives)&&n.skip&&(i.deltaUpdateFailed=!0));if(s===this.currentLevel||t.withoutMultiVariant){0===s.fragmentError&&(s.loadError=0);var o=s.details;o===t.details&&o.advanced&&(o=void 0),this.playlistLoaded(a,t,o)}else null!=(r=t.deliveryDirectives)&&r.skip&&(i.deltaUpdateFailed=!0)},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t)},r.loadingPlaylist=function(t,r){e.prototype.loadingPlaylist.call(this,t,r);var n=this.getUrlWithDirectives(t.uri,r),a=this.currentLevelIndex,i=t.attrs["PATHWAY-ID"],s=t.details,o=null==s?void 0:s.age;this.log("Loading level index "+a+(void 0!==(null==r?void 0:r.msn)?" at sn "+r.msn+" part "+r.part:"")+(i?" Pathway "+i:"")+(o&&s.live?" age "+o.toFixed(1)+(s.type&&" "+s.type||""):"")+" "+n),this.hls.trigger(P.LEVEL_LOADING,{url:n,level:a,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:r||null})},r.removeLevel=function(e){var t,r=this;if(1!==this._levels.length){var n=this._levels.filter((function(t,n){return n!==e||(r.steering&&r.steering.removeLevel(t),t===r.currentLevel&&(r.currentLevel=null,r.currentLevelIndex=-1,t.details&&t.details.fragments.forEach((function(e){return e.level=-1}))),!1)}));Qr(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);var a=n.length-1;this._firstLevel=Math.min(this._firstLevel,a),this._startLevel&&(this._startLevel=Math.min(this._startLevel,a)),this.hls.trigger(P.LEVELS_UPDATED,{levels:n})}},r.onLevelsUpdated=function(e,t){var r=t.levels;this._levels=r},r.checkMaxAutoUpdated=function(){var e=this.hls,t=e.autoLevelCapping,r=e.maxAutoLevel,n=e.maxHdcpLevel;this._maxAutoLevel!==r&&(this._maxAutoLevel=r,this.hls.trigger(P.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:r,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))},n(t,[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"loadLevelObj",get:function(){return this.currentLevel}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;if(0!==t.length){if(e<0||e>=t.length){var r=new Error("invalid level idx"),n=e<0;if(this.hls.trigger(P.ERROR,{type:A.OTHER_ERROR,details:S.LEVEL_SWITCH_ERROR,level:e,fatal:n,error:r,reason:r.message}),n)return;e=Math.min(e,t.length-1)}var a=this.currentLevelIndex,i=this.currentLevel,s=i?i.attrs["PATHWAY-ID"]:void 0,o=t[e],l=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,a!==e||!i||s!==l){this.log("Switching to level "+e+" ("+(o.height?o.height+"p ":"")+(o.videoRange?o.videoRange+" ":"")+(o.codecSet?o.codecSet+" ":"")+"@"+o.bitrate+")"+(l?" with Pathway "+l:"")+" from level "+a+(s?" with Pathway "+s:""));var u={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(P.LEVEL_SWITCHING,u);var c=o.details;if(!c||c.live){var d=this.switchParams(o.uri,null==i?void 0:i.details,c);this.loadPlaylist(d)}}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"pathways",get:function(){return this.steering?this.steering.pathways():[]}},{key:"pathwayPriority",get:function(){return this.steering?this.steering.pathwayPriority:null},set:function(e){if(this.steering){var t=this.steering.pathways(),r=e.filter((function(e){return-1!==t.indexOf(e)}));if(e.length<1)return void this.warn("pathwayPriority "+e+" should contain at least one pathway from list: "+t);this.steering.pathwayPriority=r}}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])}(qa);function rl(e){var t={};e.forEach((function(e){var r=e.groupId||"";e.id=t[r]=t[r]||0,t[r]++}))}function nl(){return self.SourceBuffer||self.WebKitSourceBuffer}function al(){if(!K())return!1;var e=nl();return!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove}var il=function(e){function t(t,r,n){var a;return(a=e.call(this,t,r,n,"stream-controller",R)||this).audioCodecSwap=!1,a.level=-1,a._forceStartLoad=!1,a._hasEnoughToStart=!1,a.altAudio=0,a.audioOnly=!1,a.fragPlaying=null,a.fragLastKbps=0,a.couldBacktrack=!1,a.backtrackFragment=null,a.audioCodecSwitch=!1,a.videoBuffer=null,a.onMediaPlaying=function(){a.tick()},a.onMediaSeeked=function(){var e=a.media,t=e?e.currentTime:null;if(null!==t&&E(t)&&(a.log("Media seeked to "+t.toFixed(3)),a.getBufferedFrag(t))){var r=a.getFwdBufferInfoAtPos(e,t,R,0);null!==r&&0!==r.len?a.tick():a.warn("Main forward buffer length at "+t+' on "seeked" event '+(r?r.len:"empty")+")")}},a.registerListeners(),a}o(t,e);var r=t.prototype;return r.registerListeners=function(){e.prototype.registerListeners.call(this);var t=this.hls;t.on(P.MANIFEST_PARSED,this.onManifestParsed,this),t.on(P.LEVEL_LOADING,this.onLevelLoading,this),t.on(P.LEVEL_LOADED,this.onLevelLoaded,this),t.on(P.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(P.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(P.BUFFER_CREATED,this.onBufferCreated,this),t.on(P.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(P.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(P.FRAG_BUFFERED,this.onFragBuffered,this)},r.unregisterListeners=function(){e.prototype.unregisterListeners.call(this);var t=this.hls;t.off(P.MANIFEST_PARSED,this.onManifestParsed,this),t.off(P.LEVEL_LOADED,this.onLevelLoaded,this),t.off(P.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(P.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(P.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(P.BUFFER_CREATED,this.onBufferCreated,this),t.off(P.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(P.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(P.FRAG_BUFFERED,this.onFragBuffered,this)},r.onHandlerDestroying=function(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),e.prototype.onHandlerDestroying.call(this)},r.startLoad=function(e,t){if(this.levels){var r=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){var a=n.startLevel;-1===a&&(n.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=n.firstAutoLevel),n.nextLoadLevel=a,this.level=n.loadLevel,this._hasEnoughToStart=!!t}r>0&&-1===e&&!t&&(this.log("Override startPosition with lastCurrentTime @"+r.toFixed(3)),e=r),this.state=un.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=un.STOPPED},r.stopLoad=function(){this._forceStartLoad=!1,e.prototype.stopLoad.call(this)},r.doTick=function(){switch(this.state){case un.WAITING_LEVEL:var e=this.levels,t=this.level,r=null==e?void 0:e[t],n=null==r?void 0:r.details;if(n&&(!n.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(n))break;this.state=un.IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=un.IDLE;break}break;case un.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate()}this.state===un.IDLE&&this.doTickIdle(),this.onTickEnd()},r.onTickEnd=function(){var t;e.prototype.onTickEnd.call(this),null!=(t=this.media)&&t.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()},r.doTickIdle=function(){var e=this.hls,t=this.levelLastLoaded,r=this.levels,n=this.media;if(null!==t&&(n||this.primaryPrefetch||!this.startFragRequested&&e.config.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)){var a=this.buffering?e.nextLoadLevel:e.loadLevel;if(null!=r&&r[a]){var i=r[a],s=this.getMainFwdBufferInfo();if(null!==s){var o=this.getLevelDetails();if(o&&this._streamEnded(s,o)){var l={};return 2===this.altAudio&&(l.type="video"),this.hls.trigger(P.BUFFER_EOS,l),void(this.state=un.ENDED)}if(this.buffering){e.loadLevel!==a&&-1===e.manualLevel&&this.log("Adapting to level "+a+" from level "+this.level),this.level=e.nextLoadLevel=a;var u=i.details;if(!u||this.state===un.WAITING_LEVEL||this.waitForLive(i))return this.level=a,this.state=un.WAITING_LEVEL,void(this.startFragRequested=!1);var c=s.len,d=this.getMaxBufferLength(i.maxBitrate);if(!(c>=d)){this.backtrackFragment&&this.backtrackFragment.start>s.end&&(this.backtrackFragment=null);var p=this.backtrackFragment?this.backtrackFragment.start:s.end,h=this.getNextFragment(p,u);if(this.couldBacktrack&&!this.fragPrevious&&h&&ee(h)&&this.fragmentTracker.getState(h)!==wt){var f,m=(null!=(f=this.backtrackFragment)?f:h).sn-u.startSN,g=u.fragments[m-1];g&&h.cc===g.cc&&(h=g,this.fragmentTracker.removeFragment(g))}else this.backtrackFragment&&s.len&&(this.backtrackFragment=null);if(h&&this.isLoopLoading(h,p)){if(!h.gap){var y=this.audioOnly&&!this.altAudio?X:Z,v=(y===Z?this.videoBuffer:this.mediaBuffer)||this.media;v&&this.afterBufferFlushed(v,y,R)}h=this.getNextFragmentLoopLoading(h,u,s,R,d)}h&&(!h.initSegment||h.initSegment.data||this.bitrateTest||(h=h.initSegment),this.loadFragment(h,i,p))}}}}}},r.loadFragment=function(t,r,n){var a=this.fragmentTracker.getState(t);a===Ct||a===It?ee(t)?this.bitrateTest?(this.log("Fragment "+t.sn+" of level "+t.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(t,r)):e.prototype.loadFragment.call(this,t,r,n):this._loadInitSegment(t,r):this.clearTrackerIfNeeded(t)},r.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,R)},r.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.end+.5):null},r.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},r.nextLevelSwitch=function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var r,n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);var a=this.getLevelDetails();if(null!=a&&a.live){var i=this.getMainFwdBufferInfo();if(!i||i.len<2*a.targetduration)return}if(!t.paused&&e){var s=e[this.hls.nextLoadLevel],o=this.fragLastKbps;r=o&&this.fragCurrent?this.fragCurrent.duration*s.maxBitrate/(1e3*o)+1:0}else r=0;var l=this.getBufferedFrag(t.currentTime+r);if(l){var u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();var c=u.maxStartPTS?u.maxStartPTS:u.start,d=u.duration,p=Math.max(l.end,c+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(p,Number.POSITIVE_INFINITY)}}}},r.abortCurrentFrag=function(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case un.KEY_LOADING:case un.FRAG_LOADING:case un.FRAG_LOADING_WAITING_RETRY:case un.PARSING:case un.PARSED:this.state=un.IDLE}this.nextLoadPosition=this.getLoadPosition()},r.flushMainBuffer=function(t,r){e.prototype.flushMainBuffer.call(this,t,r,2===this.altAudio?"video":null)},r.onMediaAttached=function(t,r){e.prototype.onMediaAttached.call(this,t,r);var n=r.media;on(n,"playing",this.onMediaPlaying),on(n,"seeked",this.onMediaSeeked)},r.onMediaDetaching=function(t,r){var n=this.media;n&&(ln(n,"playing",this.onMediaPlaying),ln(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,e.prototype.onMediaDetaching.call(this,t,r),r.transferMedia||(this._hasEnoughToStart=!1)},r.onManifestLoading=function(){e.prototype.onManifestLoading.call(this),this.log("Trigger BUFFER_RESET"),this.hls.trigger(P.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1},r.onManifestParsed=function(e,t){for(var r,n,a=!1,i=!1,s=0;s<t.levels.length;s++){var o=t.levels[s].audioCodec;o&&(a=a||-1!==o.indexOf("mp4a.40.2"),i=i||-1!==o.indexOf("mp4a.40.5"))}this.audioCodecSwitch=a&&i&&!("function"==typeof(null==(n=nl())||null==(r=n.prototype)?void 0:r.changeType)),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1},r.onLevelLoading=function(e,t){if(this.levels&&this.state===un.IDLE){var r=t.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=un.WAITING_LEVEL)}},r.onLevelLoaded=function(e,t){var r,n=this.levels,a=this.startFragRequested,i=t.level,s=t.details,o=s.totalduration;if(n){this.log("Level "+i+" loaded ["+s.startSN+","+s.endSN+"]"+(s.lastPartSn?"[part-"+s.lastPartSn+"-"+s.lastPartIndex+"]":"")+", cc ["+s.startCC+", "+s.endCC+"] duration:"+o);var l=t.levelInfo,u=this.fragCurrent;!u||this.state!==un.FRAG_LOADING&&this.state!==un.FRAG_LOADING_WAITING_RETRY||u.level!==t.level&&u.loader&&this.abortCurrentFrag();var c=0;if(s.live||null!=(r=l.details)&&r.live){var d;if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;c=this.alignPlaylists(s,l.details,null==(d=this.levelLastLoaded)?void 0:d.details)}if(l.details=s,this.levelLastLoaded=l,a||this.setStartPosition(s,c),this.hls.trigger(P.LEVEL_UPDATED,{details:s,level:i}),this.state===un.WAITING_LEVEL){if(this.waitForCdnTuneIn(s))return;this.state=un.IDLE}a&&s.live&&this.synchronizeToLiveEdge(s),this.tick()}else this.warn("Levels were reset while loading level "+i)},r.synchronizeToLiveEdge=function(e){var t=this.config,r=this.media;if(r){var n=this.hls.liveSyncPosition,a=this.getLoadPosition(),i=e.fragmentStart,s=e.edge,o=a>=i-t.maxFragLookUpTolerance&&a<=s;if(null!==n&&r.duration>n&&(a<n||!o)){var l=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!o&&r.readyState<4||a<s-l)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),r.readyState))if(this.warn("Playback: "+a.toFixed(3)+" is located too far from the end of live sliding playlist: "+s+", reset currentTime to : "+n.toFixed(3)),"buffered"===this.config.liveSyncMode){var u,c=zt.bufferInfo(r,n,0);if(null==(u=c.buffered)||!u.length)return void(r.currentTime=n);if(c.start<=a)return void(r.currentTime=n);var d=zt.bufferedInfo(c.buffered,a,0).nextStart;d&&(r.currentTime=d)}else r.currentTime=n}}},r._handleFragmentLoadProgress=function(e){var t,r=e.frag,n=e.part,a=e.payload,i=this.levels;if(i){var s=i[r.level];if(s){var o=s.details;if(!o)return this.warn("Dropping fragment "+r.sn+" of level "+r.level+" after level details were reset"),void this.fragmentTracker.removeFragment(r);var l=s.videoCodec,u=o.PTSKnown||!o.live,c=null==(t=r.initSegment)?void 0:t.data,d=this._getAudioCodec(s),p=this.transmuxer=this.transmuxer||new $a(this.hls,R,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=n?n.index:-1,f=-1!==h,m=new Wt(r.level,r.sn,r.stats.chunkCount,a.byteLength,h,f),g=this.initPTS[r.cc];p.push(a,c,d,l,r,n,o.totalduration,u,m,g)}else this.warn("Level "+r.level+" not found on progress")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},r.onAudioTrackSwitching=function(e,t){var r=this,n=this.hls,a=2===this.altAudio;if(ct(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i&&(this.log("Switching to main audio track, cancel main fragment load"),i.abortRequests(),this.fragmentTracker.removeFragment(i)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(a)return this.fragmentTracker.removeAllFragments(),n.once(P.BUFFER_FLUSHED,(function(){r.hls&&r.hls.trigger(P.AUDIO_TRACK_SWITCHED,t)})),void n.trigger(P.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});n.trigger(P.AUDIO_TRACK_SWITCHED,t)}},r.onAudioTrackSwitched=function(e,t){var r=ct(t.url,this.hls);if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r?2:0,this.tick()},r.onBufferCreated=function(e,t){var r,n,a=t.tracks,i=!1;for(var s in a){var o=a[s];if("main"===o.id){if(n=s,r=o,"video"===s){var l=a[s];l&&(this.videoBuffer=l.buffer)}}else i=!0}i&&r?(this.log("Alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},r.onFragBuffered=function(e,t){var r=t.frag,n=t.part,a=r.type===R;if(a){if(this.fragContextChanged(r))return this.warn("Fragment "+r.sn+(n?" p: "+n.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===un.PARSED&&(this.state=un.IDLE));var i=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*i.total/(i.buffering.end-i.loading.first)),ee(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}var s=this.media;s&&(!this._hasEnoughToStart&&zt.getBuffered(s).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),a&&this.tick())},r.onError=function(e,t){var r;if(t.fatal)this.state=un.ERROR;else switch(t.details){case S.FRAG_GAP:case S.FRAG_PARSING_ERROR:case S.FRAG_DECRYPT_ERROR:case S.FRAG_LOAD_ERROR:case S.FRAG_LOAD_TIMEOUT:case S.KEY_LOAD_ERROR:case S.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(R,t);break;case S.LEVEL_LOAD_ERROR:case S.LEVEL_LOAD_TIMEOUT:case S.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==un.WAITING_LEVEL||(null==(r=t.context)?void 0:r.type)!==x||(this.state=un.IDLE);break;case S.BUFFER_ADD_CODEC_ERROR:case S.BUFFER_APPEND_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case S.BUFFER_FULL_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case S.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}},r.onFragLoadEmergencyAborted=function(){this.state=un.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()},r.onBufferFlushed=function(e,t){var r=t.type;if(r!==X||!this.altAudio){var n=(r===Z?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,r,R),this.tick())}},r.onLevelsUpdated=function(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels},r.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},r.seekToStartPos=function(){var e=this.media;if(e){var t=e.currentTime,r=this.startPosition;if(r>=0&&t<r){if(e.seeking)return void this.log("could not seek to "+r+", already seeking at "+t);var n=this.timelineOffset;n&&r&&(r+=n);var a=this.getLevelDetails(),i=zt.getBuffered(e),s=i.length?i.start(0):0,o=s-r,l=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||o>0&&(o<l||this.loadingParts&&o<2*((null==a?void 0:a.partTarget)||0)))&&(this.log("adjusting start position by "+o+" to match buffer start"),r+=o,this.startPosition=r),t<r&&(this.log("seek to target start position "+r+" from current time "+t+" buffer start "+s),e.currentTime=r)}}},r._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t},r._loadBitrateTestFrag=function(e,t){var r=this;e.bitrateTest=!0,this._doFragLoad(e,t).then((function(e){var n=r.hls,a=null==e?void 0:e.frag;if(a&&!r.fragContextChanged(a)){t.fragmentError=0,r.state=un.IDLE,r.startFragRequested=!1,r.bitrateTest=!1;var i=a.stats;i.parsing.start=i.parsing.end=i.buffering.start=i.buffering.end=self.performance.now(),n.trigger(P.FRAG_LOADED,e),a.bitrateTest=!1}})).catch((function(t){r.state!==un.STOPPED&&r.state!==un.ERROR&&(r.warn(t),r.resetFragmentLoading(e))}))},r._handleTransmuxComplete=function(e){var t=this.playlistType,r=this.hls,n=e.remuxResult,a=e.chunkMeta,i=this.getCurrentContext(a);if(i){var s=i.frag,o=i.part,l=i.level,u=n.video,c=n.text,d=n.id3,p=n.initSegment,h=l.details,f=this.altAudio?void 0:n.audio;if(this.fragContextChanged(s))this.fragmentTracker.removeFragment(s);else{if(this.state=un.PARSING,p){var m=p.tracks;if(m){var g=s.initSegment||s;if(this.unhandledEncryptionError(p,s))return;this._bufferInitSegment(l,m,g,a),r.trigger(P.FRAG_PARSING_INIT_SEGMENT,{frag:g,id:t,tracks:m})}var y=p.initPTS,v=p.timescale,_=this.initPTS[s.cc];if(E(y)&&(!_||_.baseTime!==y||_.timescale!==v)){var k=p.trackId;this.initPTS[s.cc]={baseTime:y,timescale:v,trackId:k},r.trigger(P.INIT_PTS_FOUND,{frag:s,id:t,initPTS:y,timescale:v,trackId:k})}}if(u&&h){f&&"audiovideo"===u.type&&this.logMuxedErr(s);var b=h.fragments[s.sn-1-h.startSN],T=s.sn===h.startSN,A=!b||s.cc>b.cc;if(!1!==n.independent){var S=u.startPTS,C=u.endPTS,x=u.startDTS,I=u.endDTS;if(o)o.elementaryStreams[u.type]={startPTS:S,endPTS:C,startDTS:x,endDTS:I};else if(u.firstKeyFrame&&u.independent&&1===a.id&&!A&&(this.couldBacktrack=!0),u.dropped&&u.independent){var w=this.getMainFwdBufferInfo(),R=(w?w.end:this.getLoadPosition())+this.config.maxBufferHole,M=u.firstKeyFramePTS?u.firstKeyFramePTS:S;if(!T&&R<M-this.config.maxBufferHole&&!A)return void this.backtrack(s);A&&(s.gap=!0),s.setElementaryStreamInfo(u.type,s.start,C,s.start,I,!0)}else T&&S-(h.appliedTimelineOffset||0)>2&&(s.gap=!0);s.setElementaryStreamInfo(u.type,S,C,x,I),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(u,s,o,a,T||A)}else{if(!T&&!A)return void this.backtrack(s);s.gap=!0}}if(f){var D=f.startPTS,O=f.endPTS,L=f.startDTS,N=f.endDTS;o&&(o.elementaryStreams[X]={startPTS:D,endPTS:O,startDTS:L,endDTS:N}),s.setElementaryStreamInfo(X,D,O,L,N),this.bufferFragmentData(f,s,o,a)}if(h&&null!=d&&d.samples.length){var U={id:t,frag:s,details:h,samples:d.samples};r.trigger(P.FRAG_PARSING_METADATA,U)}if(h&&c){var j={id:t,frag:s,details:h,samples:c.samples};r.trigger(P.FRAG_PARSING_USERDATA,j)}}}else this.resetWhenMissingContext(a)},r.logMuxedErr=function(e){this.warn((ee(e)?"Media":"Init")+" segment with muxed audiovideo where only video expected: "+e.url)},r._bufferInitSegment=function(e,t,r,n){var a=this;if(this.state===un.PARSING){this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));var i=t.audio,s=t.video,o=t.audiovideo;if(i){var l=e.audioCodec,u=Be(i.codec,l);"mp4a"===u&&(u="mp4a.40.5");var c=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");var d=i.metadata;d&&"channelCount"in d&&1!==(d.channelCount||1)&&-1===c.indexOf("firefox")&&(u="mp4a.40.5")}u&&-1!==u.indexOf("mp4a.40.5")&&-1!==c.indexOf("android")&&"audio/mpeg"!==i.container&&(u="mp4a.40.2",this.log("Android: force audio codec to "+u)),l&&l!==u&&this.log('Swapping manifest audio codec "'+l+'" for "'+u+'"'),i.levelCodec=u,i.id=R,this.log("Init audio buffer, container:"+i.container+", codecs[selected/level/parsed]=["+(u||"")+"/"+(l||"")+"/"+i.codec+"]"),delete t.audiovideo}if(s){s.levelCodec=e.videoCodec,s.id=R;var p=s.codec;if(4===(null==p?void 0:p.length))switch(p){case"hvc1":case"hev1":s.codec="hvc1.1.6.L120.90";break;case"av01":s.codec="av01.0.04M.08";break;case"avc1":s.codec="avc1.42e01e"}this.log("Init video buffer, container:"+s.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+p+"]"+(s.codec!==p?" parsed-corrected="+s.codec:"")+(s.supplemental?" supplemental="+s.supplemental:"")),delete t.audiovideo}o&&(this.log("Init audiovideo buffer, container:"+o.container+", codecs[level/parsed]=["+e.codecs+"/"+o.codec+"]"),delete t.video,delete t.audio);var h=Object.keys(t);if(h.length){if(this.hls.trigger(P.BUFFER_CODECS,t),!this.hls)return;h.forEach((function(e){var i=t[e].initSegment;null!=i&&i.byteLength&&a.hls.trigger(P.BUFFER_APPENDING,{type:e,data:i,frag:r,part:null,chunkMeta:n,parent:r.type})}))}this.tickImmediate()}},r.getMainFwdBufferInfo=function(){var e=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,R)},r.backtrack=function(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=un.IDLE},r.checkFragmentChanged=function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var r=e.currentTime;if(zt.isBuffered(e,r)?t=this.getAppendedFrag(r):zt.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;var n=this.fragPlaying,a=t.level;n&&t.sn===n.sn&&n.level===a||(this.fragPlaying=t,this.hls.trigger(P.FRAG_CHANGED,{frag:t}),n&&n.level===a||this.hls.trigger(P.LEVEL_SWITCHED,{level:a}))}}},n(t,[{key:"hasEnoughToStart",get:function(){return this._hasEnoughToStart}},{key:"maxBufferLength",get:function(){var e=this.levels,t=this.level,r=null==e?void 0:e[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function(){var e;if(this.fragPlaying)return this.fragPlaying;var t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;return E(t)?this.getAppendedFrag(t):null}},{key:"currentProgramDateTime",get:function(){var e,t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;if(E(t)){var r=this.getLevelDetails(),n=this.currentFrag||(r?ht(null,r.fragments,t):null);if(n){var a=n.programDateTime;if(null!==a){var i=a+1e3*(t-n.start);return new Date(i)}}}return null}},{key:"currentLevel",get:function(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])}(cn),sl=function(e){function t(t,r){var n;return(n=e.call(this,"key-loader",r)||this).config=void 0,n.keyIdToKeyInfo={},n.emeController=null,n.config=t,n}o(t,e);var r=t.prototype;return r.abort=function(e){for(var t in this.keyIdToKeyInfo){var r=this.keyIdToKeyInfo[t].loader;if(r){var n;if(e&&e!==(null==(n=r.context)?void 0:n.frag.type))return;r.abort()}}},r.detach=function(){for(var e in this.keyIdToKeyInfo){var t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}},r.destroy=function(){for(var e in this.detach(),this.keyIdToKeyInfo){var t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}},r.createKeyLoadError=function(e,t,r,n,a){return void 0===t&&(t=S.KEY_LOAD_ERROR),new Ht({type:A.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:r,networkDetails:n})},r.loadClear=function(e,t,r){var n=this;if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(var a,i=function(){var a=t[s];if(e.cc<=a.cc&&(!ee(e)||!ee(a)||e.sn<a.sn)||!r&&s==o-1)return{v:n.emeController.selectKeySystemFormat(a).then((function(e){if(n.emeController){a.setKeyFormat(e);var t=vr(e);return t?n.emeController.getKeySystemAccess([t]):void 0}}))}},s=0,o=t.length;s<o;s++)if(a=i())return a.v;if(this.config.requireKeySystemAccessOnStart){var l=kr(this.config);if(l.length)return this.emeController.getKeySystemAccess(l)}}return null},r.load=function(e){var t=this;return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then((function(r){return t.loadInternal(e,r)})):this.loadInternal(e)},r.loadInternal=function(e,t){var r,n;t&&e.setKeyFormat(t);var a=e.decryptdata;if(!a){var i=new Error(t?"Expected frag.decryptdata to be defined after setting format "+t:"Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: "+(this.emeController&&this.config.emeEnabled)+")");return Promise.reject(this.createKeyLoadError(e,S.KEY_LOAD_ERROR,i))}var s=a.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,S.KEY_LOAD_ERROR,new Error('Invalid key URI: "'+s+'"')));var o=ol(a),l=this.keyIdToKeyInfo[o];if(null!=(r=l)&&r.decryptdata.key)return a.key=l.decryptdata.key,Promise.resolve({frag:e,keyInfo:l});if(this.emeController&&null!=(n=l)&&n.keyLoadPromise)switch(this.emeController.getKeyStatus(l.decryptdata)){case"usable":case"usable-in-future":return l.keyLoadPromise.then((function(t){var r=t.keyInfo;return a.key=r.decryptdata.key,{frag:e,keyInfo:r}}))}switch(this.log((this.keyIdToKeyInfo[o]?"Rel":"L")+"oading"+(a.keyId?" keyId: "+z(a.keyId):"")+" URI: "+a.uri+" from "+e.type+" "+e.level),l=this.keyIdToKeyInfo[o]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===a.keyFormat?this.loadKeyHTTP(l,e):this.loadKeyEME(l,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(l,e);default:return Promise.reject(this.createKeyLoadError(e,S.KEY_LOAD_ERROR,new Error('Key supplied with unsupported METHOD: "'+a.method+'"')))}},r.loadKeyEME=function(e,t){var r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var n=this.emeController.loadKey(r);return(e.keyLoadPromise=n.then((function(t){return e.mediaKeySessionContext=t,r}))).catch((function(r){throw e.keyLoadPromise=null,"data"in r&&(r.data.frag=t),r}))}return Promise.resolve(r)},r.loadKeyHTTP=function(e,t){var r=this,n=this.config,a=new(0,n.loader)(n);return t.keyLoader=e.loader=a,e.keyLoadPromise=new Promise((function(i,s){var o={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},l=n.keyLoadPolicy.default,u={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:function(e,t,n,a){var o=n.frag,l=n.keyInfo,u=ol(l.decryptdata);if(!o.decryptdata||l!==r.keyIdToKeyInfo[u])return s(r.createKeyLoadError(o,S.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),a));l.decryptdata.key=o.decryptdata.key=new Uint8Array(e.data),o.keyLoader=null,l.loader=null,i({frag:o,keyInfo:l})},onError:function(e,n,a,i){r.resetLoader(n),s(r.createKeyLoadError(t,S.KEY_LOAD_ERROR,new Error("HTTP Error "+e.code+" loading key "+e.text),a,c({url:o.url,data:void 0},e)))},onTimeout:function(e,n,a){r.resetLoader(n),s(r.createKeyLoadError(t,S.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),a))},onAbort:function(e,n,a){r.resetLoader(n),s(r.createKeyLoadError(t,S.INTERNAL_ABORTED,new Error("key loading aborted"),a))}};a.load(o,u,d)}))},r.resetLoader=function(e){var t=e.frag,r=e.keyInfo,n=e.url,a=r.loader;t.keyLoader===a&&(t.keyLoader=null,r.loader=null);var i=ol(r.decryptdata)||n;delete this.keyIdToKeyInfo[i],a&&a.destroy()},t}(N);function ol(e){if(e.keyFormat!==mr){var t=e.keyId;if(t)return z(t)}return e.uri}function ll(e){switch(e.type){case I:return M;case w:return D;default:return R}}function ul(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r}var cl=function(){function e(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}var t=e.prototype;return t.startLoad=function(e){},t.stopLoad=function(){this.destroyInternalLoaders()},t.registerListeners=function(){var e=this.hls;e.on(P.MANIFEST_LOADING,this.onManifestLoading,this),e.on(P.LEVEL_LOADING,this.onLevelLoading,this),e.on(P.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(P.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(P.LEVELS_UPDATED,this.onLevelsUpdated,this)},t.unregisterListeners=function(){var e=this.hls;e.off(P.MANIFEST_LOADING,this.onManifestLoading,this),e.off(P.LEVEL_LOADING,this.onLevelLoading,this),e.off(P.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(P.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(P.LEVELS_UPDATED,this.onLevelsUpdated,this)},t.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,n=t.loader,a=new(r||n)(t);return this.loaders[e.type]=a,a},t.getInternalLoader=function(e){return this.loaders[e.type]},t.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.destroy=function(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()},t.onManifestLoading=function(e,t){var r=t.url;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:C,url:r,deliveryDirectives:null,levelOrTrack:null})},t.onLevelLoading=function(e,t){var r=t.id,n=t.level,a=t.pathwayId,i=t.url,s=t.deliveryDirectives,o=t.levelInfo;this.load({id:r,level:n,pathwayId:a,responseType:"text",type:x,url:i,deliveryDirectives:s,levelOrTrack:o})},t.onAudioTrackLoading=function(e,t){var r=t.id,n=t.groupId,a=t.url,i=t.deliveryDirectives,s=t.track;this.load({id:r,groupId:n,level:null,responseType:"text",type:I,url:a,deliveryDirectives:i,levelOrTrack:s})},t.onSubtitleTrackLoading=function(e,t){var r=t.id,n=t.groupId,a=t.url,i=t.deliveryDirectives,s=t.track;this.load({id:r,groupId:n,level:null,responseType:"text",type:w,url:a,deliveryDirectives:i,levelOrTrack:s})},t.onLevelsUpdated=function(e,t){var r=this.loaders[x];if(r){var n=r.context;n&&!t.levels.some((function(e){return e===n.levelOrTrack}))&&(r.abort(),delete this.loaders[x])}},t.load=function(e){var t,r,n,a=this,s=this.hls.config,o=this.getInternalLoader(e);if(o){var l=this.hls.logger,u=o.context;if(u&&u.levelOrTrack===e.levelOrTrack&&(u.url===e.url||u.deliveryDirectives&&!e.deliveryDirectives))return void(u.url===e.url?l.log("[playlist-loader]: ignore "+e.url+" ongoing request"):l.log("[playlist-loader]: ignore "+e.url+" in favor of "+u.url));l.log("[playlist-loader]: aborting previous loader for type: "+e.type),o.abort()}if(r=e.type===C?s.manifestLoadPolicy.default:i({},s.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(e),E(null==(t=e.deliveryDirectives)?void 0:t.part)&&(e.type===x&&null!==e.level?n=this.hls.levels[e.level].details:e.type===I&&null!==e.id?n=this.hls.audioTracks[e.id].details:e.type===w&&null!==e.id&&(n=this.hls.subtitleTracks[e.id].details),n)){var c=n.partTarget,d=n.targetduration;if(c&&d){var p=1e3*Math.max(3*c,.8*d);r=i({},r,{maxTimeToFirstByteMs:Math.min(p,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,r.maxTimeToFirstByteMs)})}}var h=r.errorRetry||r.timeoutRetry||{},f={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:h.maxNumRetry||0,retryDelay:h.retryDelayMs||0,maxRetryDelay:h.maxRetryDelayMs||0},m={onSuccess:function(e,t,r,n){var i=a.getInternalLoader(r);a.resetInternalLoader(r.type);var s=e.data;t.parsing.start=performance.now(),wr.isMediaPlaylist(s)||r.type!==C?a.handleTrackOrLevelPlaylist(e,t,r,n||null,i):a.handleMasterPlaylist(e,t,r,n)},onError:function(e,t,r,n){a.handleNetworkError(t,r,!1,e,n)},onTimeout:function(e,t,r){a.handleNetworkError(t,r,!0,void 0,e)}};o.load(e,f,m)},t.checkAutostartLoad=function(){if(this.hls){var e=this.hls,t=e.config,r=t.autoStartLoad,n=t.startPosition,a=e.forceStartLoad;(r||a)&&(this.hls.logger.log((r?"auto":"force")+" startLoad with configured startPosition "+n),this.hls.startLoad(n))}},t.handleMasterPlaylist=function(e,t,r,n){var a=this,i=this.hls,s=e.data,o=ul(e,r),l=wr.parseMasterPlaylist(s,o);if(l.playlistParsingError)return t.parsing.end=performance.now(),void this.handleManifestParsingError(e,r,l.playlistParsingError,n,t);var u=l.contentSteering,c=l.levels,d=l.sessionData,p=l.sessionKeys,h=l.startTimeOffset,f=l.variableList;this.variableList=f,c.forEach((function(e){var t=e.unknownCodecs;if(t)for(var r=a.hls.config.preferManagedMediaSource,n=e.audioCodec,i=e.videoCodec,s=t.length;s--;){var o=t[s];Re(o,"audio",r)?(e.audioCodec=n=n?n+","+o:o,Ie.audio[n.substring(0,4)]=2,t.splice(s,1)):Re(o,"video",r)&&(e.videoCodec=i=i?i+","+o:o,Ie.video[i.substring(0,4)]=2,t.splice(s,1))}}));var m=wr.parseMasterPlaylistMedia(s,o,l),g=m.AUDIO,y=void 0===g?[]:g,v=m.SUBTITLES,_=m["CLOSED-CAPTIONS"];y.length&&(y.some((function(e){return!e.url}))||!c[0].audioCodec||c[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),y.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new tr({}),bitrate:0,url:""}))),i.trigger(P.MANIFEST_LOADED,{levels:c,audioTracks:y,subtitles:v,captions:_,contentSteering:u,url:o,stats:t,networkDetails:n,sessionData:d,sessionKeys:p,startTimeOffset:h,variableList:f})},t.handleTrackOrLevelPlaylist=function(e,t,r,n,a){var i=this.hls,s=r.id,o=r.level,l=r.type,u=ul(e,r),c=E(o)?o:E(s)?s:0,d=ll(r),p=wr.parseLevelPlaylist(e.data,u,c,d,0,this.variableList);if(l===C){var h={attrs:new tr({}),bitrate:0,details:p,name:"",url:u};p.requestScheduled=t.loading.start+qr(p,0),i.trigger(P.MANIFEST_LOADED,{levels:[h],audioTracks:[],url:u,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=p,this.handlePlaylistLoaded(p,e,t,r,n,a)},t.handleManifestParsingError=function(e,t,r,n,a){this.hls.trigger(P.ERROR,{type:A.NETWORK_ERROR,details:S.MANIFEST_PARSING_ERROR,fatal:t.type===C,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:n,stats:a})},t.handleNetworkError=function(e,t,r,n,a){void 0===r&&(r=!1);var i="A network "+(r?"timeout":"error"+(n?" (status "+n.code+")":""))+" occurred while loading "+e.type;e.type===x?i+=": "+e.level+" id: "+e.id:e.type!==I&&e.type!==w||(i+=" id: "+e.id+' group-id: "'+e.groupId+'"');var s=new Error(i);this.hls.logger.warn("[playlist-loader]: "+i);var o=S.UNKNOWN,l=!1,u=this.getInternalLoader(e);switch(e.type){case C:o=r?S.MANIFEST_LOAD_TIMEOUT:S.MANIFEST_LOAD_ERROR,l=!0;break;case x:o=r?S.LEVEL_LOAD_TIMEOUT:S.LEVEL_LOAD_ERROR,l=!1;break;case I:o=r?S.AUDIO_TRACK_LOAD_TIMEOUT:S.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case w:o=r?S.SUBTITLE_TRACK_LOAD_TIMEOUT:S.SUBTITLE_LOAD_ERROR,l=!1}u&&this.resetInternalLoader(e.type);var d={type:A.NETWORK_ERROR,details:o,fatal:l,url:e.url,loader:u,context:e,error:s,networkDetails:t,stats:a};if(n){var p=(null==t?void 0:t.url)||e.url;d.response=c({url:p,data:void 0},n)}this.hls.trigger(P.ERROR,d)},t.handlePlaylistLoaded=function(e,t,r,n,a,i){var s=this.hls,o=n.type,l=n.level,u=n.levelOrTrack,c=n.id,d=n.groupId,p=n.deliveryDirectives,h=ul(t,n),f=ll(n),m="number"==typeof n.level&&f===R?l:void 0,g=e.playlistParsingError;if(g){if(this.hls.logger.warn(g+" "+e.url),!s.config.ignorePlaylistParsingErrors)return void s.trigger(P.ERROR,{type:A.NETWORK_ERROR,details:S.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:g,reason:g.message,response:t,context:n,level:m,parent:f,networkDetails:a,stats:r});e.playlistParsingError=null}if(e.fragments.length)switch(e.live&&i&&(i.getCacheAge&&(e.ageHeader=i.getCacheAge()||0),i.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),o){case C:case x:if(m)if(u){if(u!==s.levels[m]){var y=s.levels.indexOf(u);y>-1&&(m=y)}}else m=0;s.trigger(P.LEVEL_LOADED,{details:e,levelInfo:u||s.levels[0],level:m||0,id:c||0,stats:r,networkDetails:a,deliveryDirectives:p,withoutMultiVariant:o===C});break;case I:s.trigger(P.AUDIO_TRACK_LOADED,{details:e,track:u,id:c||0,groupId:d||"",stats:r,networkDetails:a,deliveryDirectives:p});break;case w:s.trigger(P.SUBTITLE_TRACK_LOADED,{details:e,track:u,id:c||0,groupId:d||"",stats:r,networkDetails:a,deliveryDirectives:p})}else{var v=e.playlistParsingError=new Error("No Segments found in Playlist");s.trigger(P.ERROR,{type:A.NETWORK_ERROR,details:S.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:v,reason:v.message,response:t,context:n,level:m,parent:f,networkDetails:a,stats:r})}},e}(),dl=function(){function e(t){void 0===t&&(t={}),this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new v,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;var r=this.logger=G(t.debug||!1,"Hls instance",t.assetPlayerId),n=this.config=function(e,t,r){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');var n=Wo(e),a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((function(e){var i=("level"===e?"playlist":e)+"LoadPolicy",s=void 0===t[i],o=[];a.forEach((function(r){var a=e+"Loading"+r,l=t[a];if(void 0!==l&&s){o.push(a);var u=n[i].default;switch(t[i]={default:u},r){case"TimeOut":u.maxLoadTimeMs=l,u.maxTimeToFirstByteMs=l;break;case"MaxRetry":u.errorRetry.maxNumRetry=l,u.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":u.errorRetry.retryDelayMs=l,u.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":u.errorRetry.maxRetryDelayMs=l,u.timeoutRetry.maxRetryDelayMs=l}}})),o.length&&r.warn('hls.js config: "'+o.join('", "')+'" setting(s) are deprecated, use "'+i+'": '+rt(t[i]))})),c(c({},n),t)}(e.DefaultConfig,t,r);this.userConfig=t,n.progressive&&function(e,t){var r=e.loader;r!==Bo&&r!==Ho?(t.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(e.loader=Bo,e.progressive=!0,e.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}(n,r);var a=n.abrController,i=n.bufferController,s=n.capLevelController,o=n.errorController,l=n.fpsController,u=new o(this),d=this.abrController=new a(this),p=new Rt(this),h=n.interstitialsController,f=h?this.interstitialsController=new h(this,e):null,m=this.bufferController=new i(this,p),g=this.capLevelController=new s(this),y=new l(this),_=new cl(this),k=n.contentSteeringController,E=k?new k(this):null,b=this.levelController=new tl(this,E),T=new Jo(this),A=new sl(this.config,this.logger),S=this.streamController=new il(this,p,A),C=this.gapController=new $o(this,p);g.setStreamController(S),y.setStreamController(S);var x=[_,b,S];f&&x.splice(1,0,f),E&&x.splice(1,0,E),this.networkControllers=x;var I=[d,m,C,g,y,T,p];this.audioTrackController=this.createController(n.audioTrackController,x);var w=n.audioStreamController;w&&x.push(this.audioStreamController=new w(this,p,A)),this.subtitleTrackController=this.createController(n.subtitleTrackController,x);var R=n.subtitleStreamController;R&&x.push(this.subtititleStreamController=new R(this,p,A)),this.createController(n.timelineController,I),A.emeController=this.emeController=this.createController(n.emeController,I),this.cmcdController=this.createController(n.cmcdController,I),this.latencyController=this.createController(el,I),this.coreComponents=I,x.push(u);var M=u.onErrorOut;"function"==typeof M&&this.on(P.ERROR,M,u),this.on(P.MANIFEST_LOADED,_.onManifestLoaded,_)}e.isMSESupported=function(){return al()},e.isSupported=function(){return function(){if(!al())return!1;var e=K();return"function"==typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((function(t){return e.isTypeSupported(De(t,"video"))}))||["mp4a.40.2","fLaC"].some((function(t){return e.isTypeSupported(De(t,"audio"))})))}()},e.getMediaSource=function(){return K()};var t=e.prototype;return t.createController=function(e,t){if(e){var r=new e(this);return t&&t.push(r),r}return null},t.on=function(e,t,r){void 0===r&&(r=this),this._emitter.on(e,t,r)},t.once=function(e,t,r){void 0===r&&(r=this),this._emitter.once(e,t,r)},t.removeAllListeners=function(e){this._emitter.removeAllListeners(e)},t.off=function(e,t,r,n){void 0===r&&(r=this),this._emitter.off(e,t,r,n)},t.listeners=function(e){return this._emitter.listeners(e)},t.emit=function(e,t,r){return this._emitter.emit(e,t,r)},t.trigger=function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),!this.triggeringException){this.triggeringException=!0;var r=e===P.ERROR;this.trigger(P.ERROR,{type:A.OTHER_ERROR,details:S.INTERNAL_EXCEPTION,fatal:r,event:e,error:t}),this.triggeringException=!1}}return!1},t.listenerCount=function(e){return this._emitter.listenerCount(e)},t.destroy=function(){this.logger.log("destroy"),this.trigger(P.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach((function(e){return e.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(e){return e.destroy()})),this.coreComponents.length=0;var e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null},t.attachMedia=function(e){if(!e||"media"in e&&!e.media){var t=new Error("attachMedia failed: invalid argument ("+e+")");this.trigger(P.ERROR,{type:A.OTHER_ERROR,details:S.ATTACH_MEDIA_ERROR,fatal:!0,error:t})}else{this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());var r="media"in e,n=r?e.media:e,a=r?e:{media:n};this._media=n,this.trigger(P.MEDIA_ATTACHING,a)}},t.detachMedia=function(){this.logger.log("detachMedia"),this.trigger(P.MEDIA_DETACHING,{}),this._media=null},t.transferMedia=function(){this._media=null;var e=this.bufferController.transferMedia();return this.trigger(P.MEDIA_DETACHING,{transferMedia:e}),e},t.loadSource=function(e){this.stopLoad();var t=this.media,r=this._url,n=this._url=k.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log("loadSource:"+n),t&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(P.MANIFEST_LOADING,{url:e})},t.startLoad=function(e,t){void 0===e&&(e=-1),this.logger.log("startLoad("+e+(t?", <skip seek to start>":"")+")"),this.started=!0,this.resumeBuffering();for(var r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),this.started&&this.networkControllers);r++);},t.stopLoad=function(){this.logger.log("stopLoad"),this.started=!1;for(var e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);},t.resumeBuffering=function(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach((function(e){e.resumeBuffering&&e.resumeBuffering()})))},t.pauseBuffering=function(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach((function(e){e.pauseBuffering&&e.pauseBuffering()})))},t.swapAudioCodec=function(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},t.recoverMediaError=function(){this.logger.log("recoverMediaError");var e=this._media,t=null==e?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))},t.removeLevel=function(e){this.levelController.removeLevel(e)},t.setAudioOption=function(e){var t;return(null==(t=this.audioTrackController)?void 0:t.setAudioOption(e))||null},t.setSubtitleOption=function(e){var t;return(null==(t=this.subtitleTrackController)?void 0:t.setSubtitleOption(e))||null},t.getMediaDecodingInfo=function(e,t){return void 0===t&&(t=this.allAudioTracks),ze(e,at(t),navigator.mediaCapabilities)},n(e,[{key:"url",get:function(){return this._url}},{key:"hasEnoughToStart",get:function(){return this.streamController.hasEnoughToStart}},{key:"startPosition",get:function(){return this.streamController.startPositionValue}},{key:"loadingEnabled",get:function(){return this.started}},{key:"bufferingEnabled",get:function(){return this.streamController.bufferingEnabled}},{key:"inFlightFragments",get:function(){var e,t=((e={})[R]=this.streamController.inFlightFrag,e);return this.audioStreamController&&(t[M]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(t[D]=this.subtititleStreamController.inFlightFrag),t}},{key:"sessionId",get:function(){var e=this._sessionId;return e||(e=this._sessionId=function(){try{return crypto.randomUUID()}catch(n){try{var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){var r=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)}))}}}()),e}},{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"latestLevelDetails",get:function(){return this.streamController.getLevelDetails()||null}},{key:"loadLevelObj",get:function(){return this.levelController.loadLevelObj}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){this.logger.log("set currentLevel:"+e),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){this.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){this.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){this.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){var e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e},set:function(e){this.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(this.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN},set:function(e){this.abrController.resetEstimator(e)}},{key:"abrEwmaDefaultEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.defaultEstimate:NaN}},{key:"ttfbEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimateTTFB():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(e){(function(e){return Xe.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var r=e.length,n=0;n<r;n++)if(e[n].maxBitrate>=t)return n;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.levels,r=this.autoLevelCapping,n=this.maxHdcpLevel;if(e=-1===r&&null!=t&&t.length?t.length-1:r,n)for(var a=e;a--;){var i=t[a].attrs["HDCP-LEVEL"];if(i&&i<=n)return a}return e}},{key:"firstAutoLevel",get:function(){return this.abrController.firstAutoLevel}},{key:"nextAutoLevel",get:function(){return this.abrController.nextAutoLevel},set:function(e){this.abrController.nextAutoLevel=e}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"maxBufferLength",get:function(){return this.streamController.maxBufferLength}},{key:"allAudioTracks",get:function(){var e=this.audioTrackController;return e?e.allAudioTracks:[]}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"allSubtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency},set:function(e){this.latencyController.targetLatency=e}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}},{key:"pathways",get:function(){return this.levelController.pathways}},{key:"pathwayPriority",get:function(){return this.levelController.pathwayPriority},set:function(e){this.levelController.pathwayPriority=e}},{key:"bufferedToEnd",get:function(){var e;return!(null==(e=this.bufferController)||!e.bufferedToEnd)}},{key:"interstitialsManager",get:function(){var e;return(null==(e=this.interstitialsController)?void 0:e.interstitialsManager)||null}}],[{key:"version",get:function(){return Ha}},{key:"Events",get:function(){return P}},{key:"MetadataSchema",get:function(){return Ln}},{key:"ErrorTypes",get:function(){return A}},{key:"ErrorDetails",get:function(){return S}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:Ko},set:function(t){e.defaultConfig=t}}])}();return dl.defaultConfig=void 0,dl},module.exports=r()}(!1)},673:(__unused_webpack_module,exports,__webpack_require__)=>{(function(){var innerGlobal="undefined"!=typeof window?window:__webpack_require__.g,exportTo={};for(var k in function(window,global,module){var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.ISOLATE_POLYFILLS=!1,$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},$jscomp.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},$jscomp.global=$jscomp.getGlobal(this),$jscomp.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE,$jscomp.polyfills={},$jscomp.propertyToPolyfillSymbol={},$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(e,t,r){if(!r||null!=e)return null==(r=$jscomp.propertyToPolyfillSymbol[t])?e[t]:void 0!==(r=e[r])?r:e[t]};$jscomp.polyfill=function(e,t,r,n){t&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(e,t,r,n):$jscomp.polyfillUnisolated(e,t,r,n))},$jscomp.polyfillUnisolated=function(e,t,r,n){for(r=$jscomp.global,e=e.split("."),n=0;n<e.length-1;n++){var a=e[n];if(!(a in r))return;r=r[a]}(t=t(n=r[e=e[e.length-1]]))!=n&&null!=t&&$jscomp.defineProperty(r,e,{configurable:!0,writable:!0,value:t})},$jscomp.polyfillIsolated=function(e,t,r,n){var a=e.split(".");e=1===a.length,n=a[0],n=!e&&n in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var i=0;i<a.length-1;i++){var s=a[i];if(!(s in n))return;n=n[s]}a=a[a.length-1],null!=(t=t(r=$jscomp.IS_SYMBOL_NATIVE&&"es6"===r?n[a]:null))&&(e?$jscomp.defineProperty($jscomp.polyfills,a,{configurable:!0,writable:!0,value:t}):t!==r&&(void 0===$jscomp.propertyToPolyfillSymbol[a]&&(r=1e9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[a]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(a):$jscomp.POLYFILL_PREFIX+r+"$"+a),$jscomp.defineProperty(n,$jscomp.propertyToPolyfillSymbol[a],{configurable:!0,writable:!0,value:t})))},$jscomp.initSymbol=function(){},$jscomp.polyfill("Symbol",(function(e){if(e)return e;var t=function(e,t){this.$jscomp$symbol$id_=e,$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:t})};t.prototype.toString=function(){return this.$jscomp$symbol$id_};var r="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",n=0,a=function(e){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new t(r+(e||"")+"_"+n++,e)};return a}),"es6","es3"),$jscomp.polyfill("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<t.length;r++){var n=$jscomp.global[t[r]];"function"==typeof n&&"function"!=typeof n.prototype[e]&&$jscomp.defineProperty(n.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return e}),"es6","es3"),$jscomp.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},$jscomp.createTemplateTagFirstArg=function(e){return e.raw=e},$jscomp.createTemplateTagFirstArgWithRaw=function(e,t){return e.raw=t,e},$jscomp.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return $jscomp.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},$jscomp.arrayFromIterator=function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r},$jscomp.arrayFromIterable=function(e){return e instanceof Array?e:$jscomp.arrayFromIterator($jscomp.makeIterator(e))},$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},$jscomp.getConstructImplementation=function(){if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(function(){function e(){}return new e,Reflect.construct(e,[],(function(){})),new e instanceof e}())return Reflect.construct;var e=Reflect.construct;return function(t,r,n){return t=e(t,r),n&&Reflect.setPrototypeOf(t,n.prototype),t}}return function(e,t,r){return void 0===r&&(r=e),r=$jscomp.objectCreate(r.prototype||Object.prototype),Function.prototype.apply.call(e,r,t)||r}},$jscomp.construct=$jscomp.getConstructImplementation(),$jscomp.underscoreProtoCanBeSet=function(){var e={};try{return e.__proto__={a:!0},e.a}catch(e){}return!1},$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,$jscomp.inherits=function(e,t){if(e.prototype=$jscomp.objectCreate(t.prototype),e.prototype.constructor=e,$jscomp.setPrototypeOf){var r=$jscomp.setPrototypeOf;r(e,t)}else for(r in t)if("prototype"!=r)if(Object.defineProperties){var n=Object.getOwnPropertyDescriptor(t,r);n&&Object.defineProperty(e,r,n)}else e[r]=t[r];e.superClass_=t.prototype},$jscomp.generator={},$jscomp.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},$jscomp.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1},$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},$jscomp.generator.Context.prototype.next_=function(e){this.yieldResult=e},$jscomp.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},$jscomp.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},$jscomp.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},$jscomp.generator.Context.prototype.yieldAll=function(e,t){var r=(e=$jscomp.makeIterator(e)).next();if($jscomp.generator.ensureIteratorResultIsObject_(r),!r.done)return this.yieldAllIterator_=e,this.yield(r.value,t);this.yieldResult=r.value,this.nextAddress=t},$jscomp.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,null!=t&&(this.finallyAddress_=t)},$jscomp.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},$jscomp.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},$jscomp.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},$jscomp.generator.Context.prototype.enterFinallyBlock=function(e,t,r){r?this.finallyContexts_[r]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},$jscomp.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();null!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},$jscomp.generator.Context.prototype.forIn=function(e){return new $jscomp.generator.Context.PropertyIterator(e)},$jscomp.generator.Context.PropertyIterator=function(e){for(var t in this.object_=e,this.properties_=[],e)this.properties_.push(t);this.properties_.reverse()},$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null},$jscomp.generator.Engine_=function(e){this.context_=new $jscomp.generator.Context,this.program_=e},$jscomp.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},$jscomp.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(e){return{value:e,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},$jscomp.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},$jscomp.generator.Engine_.prototype.yieldAllStep_=function(e,t,r){try{var n=e.call(this.context_.yieldAllIterator_,t);if($jscomp.generator.ensureIteratorResultIsObject_(n),!n.done)return this.context_.stop_(),n;var a=n.value}catch(e){return this.context_.yieldAllIterator_=null,this.context_.throw_(e),this.nextStep_()}return this.context_.yieldAllIterator_=null,r.call(this.context_,a),this.nextStep_()},$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(e){this.context_.yieldResult=void 0,this.context_.throw_(e)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},$jscomp.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},$jscomp.generator.createGenerator=function(e,t){return t=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(t)),$jscomp.setPrototypeOf&&e.prototype&&$jscomp.setPrototypeOf(t,e.prototype),t},$jscomp.asyncExecutePromiseGenerator=function(e){function t(t){return e.next(t)}function r(t){return e.throw(t)}return new Promise((function(n,a){!function e(i){i.done?n(i.value):Promise.resolve(i.value).then(t,r).then(e,a)}(e.next())}))},$jscomp.asyncExecutePromiseGeneratorFunction=function(e){return $jscomp.asyncExecutePromiseGenerator(e())},$jscomp.asyncExecutePromiseGeneratorProgram=function(e){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(e)))},$jscomp.getRestArguments=function(){for(var e=Number(this),t=[],r=e;r<arguments.length;r++)t[r-e]=arguments[r];return t},$jscomp.polyfill("Reflect",(function(e){return e||{}}),"es6","es3"),$jscomp.polyfill("Reflect.construct",(function(e){return $jscomp.construct}),"es6","es3"),$jscomp.polyfill("Reflect.setPrototypeOf",(function(e){if(e)return e;if($jscomp.setPrototypeOf){var t=$jscomp.setPrototypeOf;return function(e,r){try{return t(e,r),!0}catch(e){return!1}}}return null}),"es6","es5"),$jscomp.polyfill("Promise",(function(e){function t(){this.batch_=null}function r(e){return e instanceof a?e:new a((function(t,r){t(e)}))}if(e&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&void 0===$jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return e;t.prototype.asyncExecute=function(e){if(null==this.batch_){this.batch_=[];var t=this;this.asyncExecuteFunction((function(){t.executeBatch_()}))}this.batch_.push(e)};var n=$jscomp.global.setTimeout;t.prototype.asyncExecuteFunction=function(e){n(e,0)},t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var t=0;t<e.length;++t){var r=e[t];e[t]=null;try{r()}catch(e){this.asyncThrow_(e)}}}this.batch_=null},t.prototype.asyncThrow_=function(e){this.asyncExecuteFunction((function(){throw e}))};var a=function(e){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[],this.isRejectionHandled_=!1;var t=this.createResolveAndReject_();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}};a.prototype.createResolveAndReject_=function(){function e(e){return function(n){r||(r=!0,e.call(t,n))}}var t=this,r=!1;return{resolve:e(this.resolveTo_),reject:e(this.reject_)}},a.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof a)this.settleSameAsPromise_(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}},a.prototype.resolveToNonPromiseObj_=function(e){var t=void 0;try{t=e.then}catch(e){return void this.reject_(e)}"function"==typeof t?this.settleSameAsThenable_(t,e):this.fulfill_(e)},a.prototype.reject_=function(e){this.settle_(2,e)},a.prototype.fulfill_=function(e){this.settle_(1,e)},a.prototype.settle_=function(e,t){if(0!=this.state_)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.state_);this.state_=e,this.result_=t,2===this.state_&&this.scheduleUnhandledRejectionCheck_(),this.executeOnSettledCallbacks_()},a.prototype.scheduleUnhandledRejectionCheck_=function(){var e=this;n((function(){if(e.notifyUnhandledRejection_()){var t=$jscomp.global.console;void 0!==t&&t.error(e.result_)}}),1)},a.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var e=$jscomp.global.CustomEvent,t=$jscomp.global.Event,r=$jscomp.global.dispatchEvent;return void 0===r||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=$jscomp.global.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.result_,r(e))},a.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=0;e<this.onSettledCallbacks_.length;++e)i.asyncExecute(this.onSettledCallbacks_[e]);this.onSettledCallbacks_=null}};var i=new t;return a.prototype.settleSameAsPromise_=function(e){var t=this.createResolveAndReject_();e.callWhenSettled_(t.resolve,t.reject)},a.prototype.settleSameAsThenable_=function(e,t){var r=this.createResolveAndReject_();try{e.call(t,r.resolve,r.reject)}catch(e){r.reject(e)}},a.prototype.then=function(e,t){function r(e,t){return"function"==typeof e?function(t){try{n(e(t))}catch(e){i(e)}}:t}var n,i,s=new a((function(e,t){n=e,i=t}));return this.callWhenSettled_(r(e,n),r(t,i)),s},a.prototype.catch=function(e){return this.then(void 0,e)},a.prototype.callWhenSettled_=function(e,t){function r(){switch(n.state_){case 1:e(n.result_);break;case 2:t(n.result_);break;default:throw Error("Unexpected state: "+n.state_)}}var n=this;null==this.onSettledCallbacks_?i.asyncExecute(r):this.onSettledCallbacks_.push(r),this.isRejectionHandled_=!0},a.resolve=r,a.reject=function(e){return new a((function(t,r){r(e)}))},a.race=function(e){return new a((function(t,n){for(var a=$jscomp.makeIterator(e),i=a.next();!i.done;i=a.next())r(i.value).callWhenSettled_(t,n)}))},a.all=function(e){var t=$jscomp.makeIterator(e),n=t.next();return n.done?r([]):new a((function(e,a){function i(t){return function(r){s[t]=r,0==--o&&e(s)}}var s=[],o=0;do{s.push(void 0),o++,r(n.value).callWhenSettled_(i(s.length-1),a),n=t.next()}while(!n.done)}))},a}),"es6","es3"),$jscomp.checkEs6ConformanceViaProxy=function(){try{var e={},t=Object.create(new $jscomp.global.Proxy(e,{get:function(r,n,a){return r==e&&"q"==n&&a==t}}));return!0===t.q}catch(e){return!1}},$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy(),$jscomp.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},$jscomp.polyfill("WeakMap",(function(e){function t(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function n(e){if(!$jscomp.owns(e,i)){var r=new t;$jscomp.defineProperty(e,i,{value:r})}}function a(e){if(!$jscomp.ISOLATE_POLYFILLS){var r=Object[e];r&&(Object[e]=function(e){return e instanceof t?e:(Object.isExtensible(e)&&n(e),r(e))})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),r=Object.seal({}),n=new e([[t,2],[r,3]]);return 2==n.get(t)&&3==n.get(r)&&(n.delete(t),n.set(r,4),!n.has(t)&&4==n.get(r))}catch(e){return!1}}())return e;var i="$jscomp_hidden_"+Math.random();a("freeze"),a("preventExtensions"),a("seal");var s=0,o=function(e){if(this.id_=(s+=Math.random()+1).toString(),e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};return o.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(n(e),!$jscomp.owns(e,i))throw Error("WeakMap key fail: "+e);return e[i][this.id_]=t,this},o.prototype.get=function(e){return r(e)&&$jscomp.owns(e,i)?e[i][this.id_]:void 0},o.prototype.has=function(e){return r(e)&&$jscomp.owns(e,i)&&$jscomp.owns(e[i],this.id_)},o.prototype.delete=function(e){return!!(r(e)&&$jscomp.owns(e,i)&&$jscomp.owns(e[i],this.id_))&&delete e[i][this.id_]},o}),"es6","es3"),$jscomp.MapEntry=function(){},$jscomp.polyfill("Map",(function(e){if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if($jscomp.ASSUME_NO_NATIVE_MAP||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e($jscomp.makeIterator([[t,"s"]]));if("s"!=r.get(t)||1!=r.size||r.get({x:4})||r.set({x:4},"t")!=r||2!=r.size)return!1;var n=r.entries(),a=n.next();return!a.done&&a.value[0]==t&&"s"==a.value[1]&&!((a=n.next()).done||4!=a.value[0].x||"t"!=a.value[1]||!n.next().done)}catch(e){return!1}}())return e;var t=new WeakMap,r=function(e){if(this[0]={},this[1]=i(),this.size=0,e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};r.prototype.set=function(e,t){var r=n(this,e=0===e?0:e);return r.list||(r.list=this[0][r.id]=[]),r.entry?r.entry.value=t:(r.entry={next:this[1],previous:this[1].previous,head:this[1],key:e,value:t},r.list.push(r.entry),this[1].previous.next=r.entry,this[1].previous=r.entry,this.size++),this},r.prototype.delete=function(e){return!(!(e=n(this,e)).entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this[0][e.id],e.entry.previous.next=e.entry.next,e.entry.next.previous=e.entry.previous,e.entry.head=null,this.size--,!0)},r.prototype.clear=function(){this[0]={},this[1]=this[1].previous=i(),this.size=0},r.prototype.has=function(e){return!!n(this,e).entry},r.prototype.get=function(e){return(e=n(this,e).entry)&&e.value},r.prototype.entries=function(){return a(this,(function(e){return[e.key,e.value]}))},r.prototype.keys=function(){return a(this,(function(e){return e.key}))},r.prototype.values=function(){return a(this,(function(e){return e.value}))},r.prototype.forEach=function(e,t){for(var r,n=this.entries();!(r=n.next()).done;)r=r.value,e.call(t,r[1],r[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var n=function(e,r){var n=r&&typeof r;"object"==n||"function"==n?t.has(r)?n=t.get(r):(n=""+ ++s,t.set(r,n)):n="p_"+r;var a=e[0][n];if(a&&$jscomp.owns(e[0],n))for(e=0;e<a.length;e++){var i=a[e];if(r!=r&&i.key!=i.key||r===i.key)return{id:n,list:a,index:e,entry:i}}return{id:n,list:a,index:-1,entry:void 0}},a=function(e,t){var r=e[1];return $jscomp.iteratorPrototype((function(){if(r){for(;r.head!=e[1];)r=r.previous;for(;r.next!=r.head;)return r=r.next,{done:!1,value:t(r)};r=null}return{done:!0,value:void 0}}))},i=function(){var e={};return e.previous=e.next=e.head=e},s=0;return r}),"es6","es3"),$jscomp.polyfill("Set",(function(e){if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if($jscomp.ASSUME_NO_NATIVE_SET||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e($jscomp.makeIterator([t]));if(!r.has(t)||1!=r.size||r.add(t)!=r||1!=r.size||r.add({x:4})!=r||2!=r.size)return!1;var n=r.entries(),a=n.next();return!a.done&&a.value[0]==t&&a.value[1]==t&&(!(a=n.next()).done&&a.value[0]!=t&&4==a.value[0].x&&a.value[1]==a.value[0]&&n.next().done)}catch(e){return!1}}())return e;var t=function(e){if(this.map_=new Map,e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.map_.size};return t.prototype.add=function(e){return e=0===e?0:e,this.map_.set(e,e),this.size=this.map_.size,this},t.prototype.delete=function(e){return e=this.map_.delete(e),this.size=this.map_.size,e},t.prototype.clear=function(){this.map_.clear(),this.size=0},t.prototype.has=function(e){return this.map_.has(e)},t.prototype.entries=function(){return this.map_.entries()},t.prototype.values=function(){return this.map_.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var r=this;this.map_.forEach((function(n){return e.call(t,n,n,r)}))},t}),"es6","es3"),$jscomp.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var r=0,n=!1,a={next:function(){if(!n&&r<e.length){var a=r++;return{value:t(a,e[a]),done:!1}}return n=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a},$jscomp.polyfill("Array.prototype.values",(function(e){return e||function(){return $jscomp.iteratorFromArray(this,(function(e,t){return t}))}}),"es8","es3"),$jscomp.polyfill("Array.from",(function(e){return e||function(e,t,r){t=null!=t?t:function(e){return e};var n=[],a="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof a){e=a.call(e);for(var i=0;!(a=e.next()).done;)n.push(t.call(r,a.value,i++))}else for(a=e.length,i=0;i<a;i++)n.push(t.call(r,e[i],i));return n}}),"es6","es3"),$jscomp.polyfill("Array.prototype.keys",(function(e){return e||function(){return $jscomp.iteratorFromArray(this,(function(e){return e}))}}),"es6","es3"),$jscomp.polyfill("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),"es6","es3"),$jscomp.polyfill("Array.prototype.includes",(function(e){return e||function(e,t){var r=this;r instanceof String&&(r=String(r));var n=r.length;for(0>(t=t||0)&&(t=Math.max(t+n,0));t<n;t++){var a=r[t];if(a===e||Object.is(a,e))return!0}return!1}}),"es7","es3"),$jscomp.checkStringArgs=function(e,t,r){if(null==e)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return e+""},$jscomp.polyfill("String.prototype.includes",(function(e){return e||function(e,t){return-1!==$jscomp.checkStringArgs(this,e,"includes").indexOf(e,t||0)}}),"es6","es3"),$jscomp.polyfill("String.fromCodePoint",(function(e){return e||function(e){for(var t="",r=0;r<arguments.length;r++){var n=Number(arguments[r]);if(0>n||1114111<n||n!==Math.floor(n))throw new RangeError("invalid_code_point "+n);65535>=n?t+=String.fromCharCode(n):(n-=65536,t+=String.fromCharCode(n>>>10&1023|55296),t+=String.fromCharCode(1023&n|56320))}return t}}),"es6","es3"),$jscomp.findInternal=function(e,t,r){e instanceof String&&(e=String(e));for(var n=e.length,a=0;a<n;a++){var i=e[a];if(t.call(r,i,a,e))return{i:a,v:i}}return{i:-1,v:void 0}},$jscomp.polyfill("Array.prototype.findIndex",(function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).i}}),"es6","es3"),$jscomp.polyfill("WeakSet",(function(e){if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),r=Object.seal({}),n=new e([t]);return!(!n.has(t)||n.has(r))&&(n.delete(t),n.add(r),!n.has(t)&&n.has(r))}catch(e){return!1}}())return e;var t=function(e){if(this.map_=new WeakMap,e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)this.add(t.value)}};return t.prototype.add=function(e){return this.map_.set(e,!0),this},t.prototype.has=function(e){return this.map_.has(e)},t.prototype.delete=function(e){return this.map_.delete(e)},t}),"es6","es3"),$jscomp.polyfill("Array.prototype.find",(function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).v}}),"es6","es3"),$jscomp.polyfill("String.prototype.startsWith",(function(e){return e||function(e,t){var r=$jscomp.checkStringArgs(this,e,"startsWith");e+="";var n=r.length,a=e.length;t=Math.max(0,Math.min(0|t,r.length));for(var i=0;i<a&&t<n;)if(r[t++]!=e[i++])return!1;return i>=a}}),"es6","es3"),$jscomp.polyfill("Object.entries",(function(e){return e||function(e){var t,r=[];for(t in e)$jscomp.owns(e,t)&&r.push([t,e[t]]);return r}}),"es8","es3"),$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(e,t){for(var r=1;r<arguments.length;r++){var n=arguments[r];if(n)for(var a in n)$jscomp.owns(n,a)&&(e[a]=n[a])}return e},$jscomp.polyfill("Object.assign",(function(e){return e||$jscomp.assign}),"es6","es3"),$jscomp.polyfill("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}}),"es9","es3"),$jscomp.polyfill("Array.prototype.entries",(function(e){return e||function(){return $jscomp.iteratorFromArray(this,(function(e,t){return[e,t]}))}}),"es6","es3"),$jscomp.polyfill("Number.isNaN",(function(e){return e||function(e){return"number"==typeof e&&isNaN(e)}}),"es6","es3"),$jscomp.polyfill("String.prototype.repeat",(function(e){return e||function(e){var t=$jscomp.checkStringArgs(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var r="";e;)1&e&&(r+=t),(e>>>=1)&&(t+=t);return r}}),"es6","es3"),$jscomp.polyfill("Number.EPSILON",(function(e){return Math.pow(2,-52)}),"es6","es3"),$jscomp.polyfill("Number.MAX_SAFE_INTEGER",(function(){return 9007199254740991}),"es6","es3"),$jscomp.polyfill("Number.isFinite",(function(e){return e||function(e){return"number"==typeof e&&(!isNaN(e)&&1/0!==e&&-1/0!==e)}}),"es6","es3"),$jscomp.polyfill("Object.values",(function(e){return e||function(e){var t,r=[];for(t in e)$jscomp.owns(e,t)&&r.push(e[t]);return r}}),"es8","es3"),$jscomp.polyfill("Math.log2",(function(e){return e||function(e){return Math.log(e)/Math.LN2}}),"es6","es3"),$jscomp.polyfill("String.prototype.endsWith",(function(e){return e||function(e,t){var r=$jscomp.checkStringArgs(this,e,"endsWith");e+="",void 0===t&&(t=r.length),t=Math.max(0,Math.min(0|t,r.length));for(var n=e.length;0<n&&0<t;)if(r[--t]!=e[--n])return!1;return 0>=n}}),"es6","es3"),$jscomp.polyfill("Math.trunc",(function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}}),"es6","es3");var COMPILED=!0,goog=goog||{};if(goog.global=this||self,goog.exportPath_=function(e,t,r,n){e=e.split("."),n=n||goog.global,e[0]in n||void 0===n.execScript||n.execScript("var "+e[0]);for(var a;e.length&&(a=e.shift());)if(e.length||void 0===t)n=n[a]&&n[a]!==Object.prototype[a]?n[a]:n[a]={};else if(!r&&goog.isObject(t)&&goog.isObject(n[a]))for(var i in t)t.hasOwnProperty(i)&&(n[a][i]=t[i]);else n[a]=t},goog.define=function(e,t){if(!COMPILED){var r=goog.global.CLOSURE_UNCOMPILED_DEFINES,n=goog.global.CLOSURE_DEFINES;r&&void 0===r.nodeType&&Object.prototype.hasOwnProperty.call(r,e)?t=r[e]:n&&void 0===n.nodeType&&Object.prototype.hasOwnProperty.call(n,e)&&(t=n[e])}return t},goog.FEATURESET_YEAR=2012,goog.DEBUG=!0,goog.LOCALE="en",goog.getLocale=function(){return goog.LOCALE},goog.TRUSTED_SITE=!0,goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(e){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");if(!COMPILED&&goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');goog.constructNamespace_(e)},goog.constructNamespace_=function(e,t,r){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var n=e;(n=n.substring(0,n.lastIndexOf(".")))&&!goog.getObjectByName(n);)goog.implicitNamespaces_[n]=!0}goog.exportPath_(e,t,r)},goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/,goog.getScriptNonce_=function(e){return(e=(e=(e||goog.global).document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&goog.NONCE_PATTERN_.test(e)?e:""},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(e){if("string"!=typeof e||!e||-1==e.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");if(goog.moduleLoaderState_.moduleName=e,!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e]}},goog.module.get=function(e){return goog.module.getInternal_(e)},goog.module.getInternal_=function(e){if(!COMPILED){if(e in goog.loadedModules_)return goog.loadedModules_[e].exports;if(!goog.implicitNamespaces_[e])return null!=(e=goog.getObjectByName(e))?e:null}return null},goog.ModuleType={ES6:"es6",GOOG:"goog"},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()},goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG},goog.isInEs6ModuleLoader_=function(){if(goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6)return!0;var e=goog.global.$jscomp;return!!e&&("function"==typeof e.getCurrentModulePath&&!!e.getCurrentModulePath())},goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInGoogModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.declareModuleId=function(e){if(!COMPILED){if(!goog.isInEs6ModuleLoader_())throw Error("goog.declareModuleId may only be called from within an ES6 module");if(goog.moduleLoaderState_&&goog.moduleLoaderState_.moduleName)throw Error("goog.declareModuleId may only be called once per module.");if(e in goog.loadedModules_)throw Error('Module with namespace "'+e+'" already exists.')}if(goog.moduleLoaderState_)goog.moduleLoaderState_.moduleName=e;else{var t=goog.global.$jscomp;if(!t||"function"!=typeof t.getCurrentModulePath)throw Error('Module with namespace "'+e+'" has been loaded incorrectly.');t=t.require(t.getCurrentModulePath()),goog.loadedModules_[e]={exports:t,type:goog.ModuleType.ES6,moduleId:e}}},goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},goog.forwardDeclare=function(e){},COMPILED||(goog.isProvided_=function(e){return e in goog.loadedModules_||!goog.implicitNamespaces_[e]&&null!=goog.getObjectByName(e)},goog.implicitNamespaces_={"goog.module":!0}),goog.getObjectByName=function(e,t){e=e.split("."),t=t||goog.global;for(var r=0;r<e.length;r++)if(null==(t=t[e[r]]))return null;return t},goog.addDependency=function(e,t,r,n){!COMPILED&&goog.DEPENDENCIES_ENABLED&&goog.debugLoader_.addDependency(e,t,r,n)},goog.ENABLE_DEBUG_LOADER=!1,goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)},goog.require=function(e){if(!COMPILED){if(goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_.requested(e),goog.isProvided_(e)){if(goog.isInModuleLoader_())return goog.module.getInternal_(e)}else if(goog.ENABLE_DEBUG_LOADER){var t=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{goog.debugLoader_.load_(e)}finally{goog.moduleLoaderState_=t}}return null}},goog.requireType=function(e){return{}},goog.basePath="",goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.instance_=void 0,e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.TRANSPILE="detect",goog.ASSUME_ES_MODULES_TRANSPILED=!1,goog.TRUSTED_TYPES_POLICY_NAME="goog",goog.hasBadLetScoping=null,goog.loadModule=function(e){var t=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1,type:goog.ModuleType.GOOG};var r={},n=r;if("function"==typeof e)n=e.call(void 0,n);else{if("string"!=typeof e)throw Error("Invalid module definition");n=goog.loadModuleFromSource_.call(void 0,n,e)}var a=goog.moduleLoaderState_.moduleName;if("string"!=typeof a||!a)throw Error('Invalid module name "'+a+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(a,n,r!==n):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof n&&null!=n&&Object.seal(n),goog.loadedModules_[a]={exports:n,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName}}finally{goog.moduleLoaderState_=t}},goog.loadModuleFromSource_=function(a,b){return eval(goog.CLOSURE_EVAL_PREFILTER_.createScript(b)),a},goog.normalizePath_=function(e){e=e.split("/");for(var t=0;t<e.length;)"."==e[t]?e.splice(t,1):t&&".."==e[t]&&e[t-1]&&".."!=e[t-1]?e.splice(--t,2):t++;return e.join("/")},goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);try{var t=new goog.global.XMLHttpRequest;return t.open("get",e,!1),t.send(),0==t.status||200==t.status?t.responseText:null}catch(e){return null}},goog.typeOf=function(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return Object.prototype.hasOwnProperty.call(e,goog.UID_PROPERTY_)&&e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(e){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if("function"==typeof e.clone)return e.clone();if("undefined"!=typeof Map&&e instanceof Map)return new Map(e);if("undefined"!=typeof Set&&e instanceof Set)return new Set(e);for(var r in t="array"==t?[]:{},e)t[r]=goog.cloneObject(e[r]);return t}return e},goog.bindNative_=function(e,t,r){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}}return function(){return e.apply(t,arguments)}},goog.bind=function(e,t,r){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}},goog.now=function(){return Date.now()},goog.globalEval=function(e){(0,eval)(e)},goog.getCssName=function(e,t){if("."==String(e).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+e);var r=function(e){return goog.cssNameMapping_[e]||e},n=function(e){e=e.split("-");for(var t=[],n=0;n<e.length;n++)t.push(r(e[n]));return t.join("-")};return n=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?r:n:function(e){return e},e=t?e+"-"+n(t):n(e),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(e):e},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.GetMsgOptions=function(){},goog.getMsg=function(e,t,r){return r&&r.html&&(e=e.replace(/</g,"&lt;")),r&&r.unescapeHtmlEntities&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),t&&(e=e.replace(/\{\$([^}]+)}/g,(function(e,r){return null!=t&&r in t?t[r]:e}))),e},goog.getMsgWithFallback=function(e,t){return e},goog.exportSymbol=function(e,t,r){goog.exportPath_(e,t,!0,r)},goog.exportProperty=function(e,t,r){e[t]=r},goog.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.base=function(e,r,n){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[r].apply(e,a)}},goog.scope=function(e){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a module.");e.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.defineClass=function(e,t){var r=t.constructor,n=t.statics;return r&&r!=Object.prototype.constructor||(r=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),r=goog.defineClass.createSealingConstructor_(r,e),e&&goog.inherits(r,e),delete t.constructor,delete t.statics,goog.defineClass.applyProperties_(r.prototype,t),null!=n&&(n instanceof Function?n(r):goog.defineClass.applyProperties_(r,n)),r},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(e,t){return goog.defineClass.SEAL_CLASS_INSTANCES?function(){var t=e.apply(this,arguments)||this;return t[goog.UID_PROPERTY_]=t[goog.UID_PROPERTY_],t}:e},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);for(var n=0;n<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;n++)r=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[n],Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},goog.identity_=function(e){return e},goog.createTrustedTypesPolicy=function(e){var t=null,r=goog.global.trustedTypes;if(!r||!r.createPolicy)return t;try{t=r.createPolicy(e,{createHTML:goog.identity_,createScript:goog.identity_,createScriptURL:goog.identity_})}catch(e){goog.logToConsole_(e.message)}return t},!COMPILED&&goog.DEPENDENCIES_ENABLED&&(goog.isEdge_=function(){return!!(goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"").match(/Edge\/(\d+)(\.\d)*/i)},goog.inHtmlDocument_=function(){var e=goog.global.document;return null!=e&&"write"in e},goog.isDocumentLoading_=function(){var e=goog.global.document;return e.attachEvent?"complete"!=e.readyState:"loading"==e.readyState},goog.findBasePath_=function(){if(null!=goog.global.CLOSURE_BASE_PATH&&"string"==typeof goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var e=goog.global.document,t=e.currentScript;for(t=(e=t?[t]:e.getElementsByTagName("SCRIPT")).length-1;0<=t;--t){var r=e[t].src,n=r.lastIndexOf("?");if(n=-1==n?r.length:n,"base.js"==r.slice(n-7,n)){goog.basePath=r.slice(0,n-7);break}}}},goog.findBasePath_(),goog.protectScriptTag_=function(e){return e.replace(/<\/(SCRIPT)/gi,"\\x3c/$1")},goog.DebugLoader_=function(){this.dependencies_={},this.idToPath_={},this.written_={},this.loadingDeps_=[],this.depsToLoad_=[],this.paused_=!1,this.factory_=new goog.DependencyFactory,this.deferredCallbacks_={},this.deferredQueue_=[]},goog.DebugLoader_.prototype.bootstrap=function(e,t){function r(){n&&(goog.global.setTimeout(n,0),n=null)}var n=t;if(e.length){t=[];for(var a=0;a<e.length;a++){var i=this.getPathFromDeps_(e[a]);if(!i)throw Error("Unregonized namespace: "+e[a]);t.push(this.dependencies_[i])}i=goog.require;var s=0;for(a=0;a<e.length;a++)i(e[a]),t[a].onLoad((function(){++s==e.length&&r()}))}else r()},goog.DebugLoader_.prototype.loadClosureDeps=function(){this.depsToLoad_.push(this.factory_.createDependency(goog.normalizePath_(goog.basePath+"deps.js"),"deps.js",[],[],{})),this.loadDeps_()},goog.DebugLoader_.prototype.requested=function(e,t){(e=this.getPathFromDeps_(e))&&(t||this.areDepsLoaded_(this.dependencies_[e].requires))&&(t=this.deferredCallbacks_[e])&&(delete this.deferredCallbacks_[e],t())},goog.DebugLoader_.prototype.setDependencyFactory=function(e){this.factory_=e},goog.DebugLoader_.prototype.load_=function(e){if(this.getPathFromDeps_(e)){var t=this,r=[],n=function(e){var a=t.getPathFromDeps_(e);if(!a)throw Error("Bad dependency path or symbol: "+e);if(!t.written_[a]){for(t.written_[a]=!0,e=t.dependencies_[a],a=0;a<e.requires.length;a++)goog.isProvided_(e.requires[a])||n(e.requires[a]);r.push(e)}};n(e),e=!!this.depsToLoad_.length,this.depsToLoad_=this.depsToLoad_.concat(r),this.paused_||e||this.loadDeps_()}else goog.logToConsole_("goog.require could not find: "+e)},goog.DebugLoader_.prototype.loadDeps_=function(){for(var e=this,t=this.paused_;this.depsToLoad_.length&&!t;)!function(){var r=!1,n=e.depsToLoad_.shift(),a=!1;e.loading_(n);var i={pause:function(){if(r)throw Error("Cannot call pause after the call to load.");t=!0},resume:function(){r?e.resume_():t=!1},loaded:function(){if(a)throw Error("Double call to loaded.");a=!0,e.loaded_(n)},pending:function(){for(var t=[],r=0;r<e.loadingDeps_.length;r++)t.push(e.loadingDeps_[r]);return t},setModuleState:function(e){goog.moduleLoaderState_={type:e,moduleName:"",declareLegacyNamespace:!1}},registerEs6ModuleExports:function(e,t,r){r&&(goog.loadedModules_[r]={exports:t,type:goog.ModuleType.ES6,moduleId:r||""})},registerGoogModuleExports:function(e,t){goog.loadedModules_[e]={exports:t,type:goog.ModuleType.GOOG,moduleId:e}},clearModuleState:function(){goog.moduleLoaderState_=null},defer:function(t){if(r)throw Error("Cannot register with defer after the call to load.");e.defer_(n,t)},areDepsLoaded:function(){return e.areDepsLoaded_(n.requires)}};try{n.load(i)}finally{r=!0}}();t&&this.pause_()},goog.DebugLoader_.prototype.pause_=function(){this.paused_=!0},goog.DebugLoader_.prototype.resume_=function(){this.paused_&&(this.paused_=!1,this.loadDeps_())},goog.DebugLoader_.prototype.loading_=function(e){this.loadingDeps_.push(e)},goog.DebugLoader_.prototype.loaded_=function(e){for(var t=0;t<this.loadingDeps_.length;t++)if(this.loadingDeps_[t]==e){this.loadingDeps_.splice(t,1);break}for(t=0;t<this.deferredQueue_.length;t++)if(this.deferredQueue_[t]==e.path){this.deferredQueue_.splice(t,1);break}if(this.loadingDeps_.length==this.deferredQueue_.length&&!this.depsToLoad_.length)for(;this.deferredQueue_.length;)this.requested(this.deferredQueue_.shift(),!0);e.loaded()},goog.DebugLoader_.prototype.areDepsLoaded_=function(e){for(var t=0;t<e.length;t++){var r=this.getPathFromDeps_(e[t]);if(!r||!(r in this.deferredCallbacks_)&&!goog.isProvided_(e[t]))return!1}return!0},goog.DebugLoader_.prototype.getPathFromDeps_=function(e){return e in this.idToPath_?this.idToPath_[e]:e in this.dependencies_?e:null},goog.DebugLoader_.prototype.defer_=function(e,t){this.deferredCallbacks_[e.path]=t,this.deferredQueue_.push(e.path)},goog.LoadController=function(){},goog.LoadController.prototype.pause=function(){},goog.LoadController.prototype.resume=function(){},goog.LoadController.prototype.loaded=function(){},goog.LoadController.prototype.pending=function(){},goog.LoadController.prototype.registerEs6ModuleExports=function(e,t,r){},goog.LoadController.prototype.setModuleState=function(e){},goog.LoadController.prototype.clearModuleState=function(){},goog.LoadController.prototype.defer=function(e){},goog.LoadController.prototype.areDepsLoaded=function(){},goog.Dependency=function(e,t,r,n,a){this.path=e,this.relativePath=t,this.provides=r,this.requires=n,this.loadFlags=a,this.loaded_=!1,this.loadCallbacks_=[]},goog.Dependency.prototype.getPathName=function(){var e=this.path,t=e.indexOf("://");return 0<=t&&(0<=(t=(e=e.substring(t+3)).indexOf("/"))&&(e=e.substring(t+1))),e},goog.Dependency.prototype.onLoad=function(e){this.loaded_?e():this.loadCallbacks_.push(e)},goog.Dependency.prototype.loaded=function(){this.loaded_=!0;var e=this.loadCallbacks_;this.loadCallbacks_=[];for(var t=0;t<e.length;t++)e[t]()},goog.Dependency.defer_=!1,goog.Dependency.callbackMap_={},goog.Dependency.registerCallback_=function(e){var t=Math.random().toString(32);return goog.Dependency.callbackMap_[t]=e,t},goog.Dependency.unregisterCallback_=function(e){delete goog.Dependency.callbackMap_[e]},goog.Dependency.callback_=function(e,t){if(!(e in goog.Dependency.callbackMap_))throw Error("Callback key "+e+" does not exist (was base.js loaded more than once?).");for(var r=goog.Dependency.callbackMap_[e],n=[],a=1;a<arguments.length;a++)n.push(arguments[a]);r.apply(void 0,n)},goog.Dependency.prototype.load=function(e){if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?e.loaded():e.pause();else if(goog.inHtmlDocument_()){var t=goog.global.document;if("complete"==t.readyState&&!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING){if(/\bdeps.js$/.test(this.path))return void e.loaded();throw Error('Cannot write "'+this.path+'" after document load')}var r=goog.getScriptNonce_();if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&goog.isDocumentLoading_()){var n=function(t){t.readyState&&"complete"!=t.readyState?t.onload=n:(goog.Dependency.unregisterCallback_(a),e.loaded())},a=goog.Dependency.registerCallback_(n);r=r?' nonce="'+r+'"':"";var i='<script src="'+this.path+'"'+r+(goog.Dependency.defer_?" defer":"")+' id="script-'+a+'"><\/script>';i+="<script"+r+">",i=goog.Dependency.defer_?i+"document.getElementById('script-"+a+"').onload = function() {\n  goog.Dependency.callback_('"+a+"', this);\n};\n":i+"goog.Dependency.callback_('"+a+"', document.getElementById('script-"+a+"'));",i+="<\/script>",t.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(i):i)}else{var s=t.createElement("script");s.defer=goog.Dependency.defer_,s.async=!1,r&&(s.nonce=r),s.onload=function(){s.onload=null,e.loaded()},s.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(this.path):this.path,t.head.appendChild(s)}}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),"deps.js"==this.relativePath?(goog.logToConsole_("Consider setting CLOSURE_IMPORT_SCRIPT before loading base.js, or setting CLOSURE_NO_DEPS to true."),e.loaded()):e.pause()},goog.Es6ModuleDependency=function(e,t,r,n,a){goog.Dependency.call(this,e,t,r,n,a)},goog.inherits(goog.Es6ModuleDependency,goog.Dependency),goog.Es6ModuleDependency.prototype.load=function(e){if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?e.loaded():e.pause();else if(goog.inHtmlDocument_()){var t=goog.global.document,r=this;if(goog.isDocumentLoading_()){var n=function(e,r){var n="",a=goog.getScriptNonce_();a&&(n=' nonce="'+a+'"'),e=r?'<script type="module" crossorigin'+n+">"+r+"<\/script>":'<script type="module" crossorigin src="'+e+'"'+n+"><\/script>",t.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(e):e)};goog.Dependency.defer_=!0}else n=function(e,r){var n=t.createElement("script");n.defer=!0,n.async=!1,n.type="module",n.setAttribute("crossorigin",!0);var a=goog.getScriptNonce_();a&&(n.nonce=a),r?n.text=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScript(r):r:n.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(e):e,t.head.appendChild(n)};var a=goog.Dependency.registerCallback_((function(){goog.Dependency.unregisterCallback_(a),e.setModuleState(goog.ModuleType.ES6)}));n(void 0,'goog.Dependency.callback_("'+a+'")'),n(this.path,void 0);var i=goog.Dependency.registerCallback_((function(t){goog.Dependency.unregisterCallback_(i),e.registerEs6ModuleExports(r.path,t,goog.moduleLoaderState_.moduleName)}));n(void 0,'import * as m from "'+this.path+'"; goog.Dependency.callback_("'+i+'", m)');var s=goog.Dependency.registerCallback_((function(){goog.Dependency.unregisterCallback_(s),e.clearModuleState(),e.loaded()}));n(void 0,'goog.Dependency.callback_("'+s+'")')}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),e.pause()},goog.TransformedDependency=function(e,t,r,n,a){goog.Dependency.call(this,e,t,r,n,a),this.contents_=null,this.lazyFetch_=!goog.inHtmlDocument_()||!("noModule"in goog.global.document.createElement("script"))},goog.inherits(goog.TransformedDependency,goog.Dependency),goog.TransformedDependency.prototype.load=function(e){function t(){s.contents_=goog.loadFileSync_(s.path),s.contents_&&(s.contents_=s.transform(s.contents_),s.contents_&&(s.contents_+="\n//# sourceURL="+s.path))}function r(){if(s.lazyFetch_&&t(),s.contents_){o&&e.setModuleState(goog.ModuleType.ES6);try{var r=s.contents_;if(s.contents_=null,goog.globalEval(goog.CLOSURE_EVAL_PREFILTER_.createScript(r)),o)var n=goog.moduleLoaderState_.moduleName}finally{o&&e.clearModuleState()}o&&goog.global.$jscomp.require.ensure([s.getPathName()],(function(){e.registerEs6ModuleExports(s.path,goog.global.$jscomp.require(s.getPathName()),n)})),e.loaded()}}var n,a,i,s=this;if(goog.global.CLOSURE_IMPORT_SCRIPT)t(),this.contents_&&goog.global.CLOSURE_IMPORT_SCRIPT("",this.contents_)?(this.contents_=null,e.loaded()):e.pause();else{var o=this.loadFlags.module==goog.ModuleType.ES6;this.lazyFetch_||t();var l=1<e.pending().length;if(goog.Dependency.defer_&&(l||goog.isDocumentLoading_()))e.defer((function(){r()}));else{var u=goog.global.document;if(l=goog.inHtmlDocument_()&&("ActiveXObject"in goog.global||goog.isEdge_()),o&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()&&!l){goog.Dependency.defer_=!0,e.pause();var c=u.onreadystatechange;u.onreadystatechange=function(){"interactive"==u.readyState&&(u.onreadystatechange=c,r(),e.resume()),"function"==typeof c&&c.apply(void 0,arguments)}}else goog.inHtmlDocument_()&&goog.isDocumentLoading_()?(n=goog.global.document,a=goog.Dependency.registerCallback_((function(){goog.Dependency.unregisterCallback_(a),r()})),i="<script"+((i=goog.getScriptNonce_())?' nonce="'+i+'"':"")+">"+goog.protectScriptTag_('goog.Dependency.callback_("'+a+'");')+"<\/script>",n.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(i):i)):r()}}},goog.TransformedDependency.prototype.transform=function(e){},goog.PreTranspiledEs6ModuleDependency=function(e,t,r,n,a){goog.TransformedDependency.call(this,e,t,r,n,a)},goog.inherits(goog.PreTranspiledEs6ModuleDependency,goog.TransformedDependency),goog.PreTranspiledEs6ModuleDependency.prototype.transform=function(e){return e},goog.GoogModuleDependency=function(e,t,r,n,a){goog.TransformedDependency.call(this,e,t,r,n,a)},goog.inherits(goog.GoogModuleDependency,goog.TransformedDependency),goog.GoogModuleDependency.prototype.transform=function(e){return goog.LOAD_MODULE_USING_EVAL&&void 0!==goog.global.JSON?"goog.loadModule("+goog.global.JSON.stringify(e+"\n//# sourceURL="+this.path+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+e+"\n;return exports});\n//# sourceURL="+this.path+"\n"},goog.DebugLoader_.prototype.addDependency=function(e,t,r,n){t=t||[],e=e.replace(/\\/g,"/");var a=goog.normalizePath_(goog.basePath+e);for(n&&"boolean"!=typeof n||(n=n?{module:goog.ModuleType.GOOG}:{}),r=this.factory_.createDependency(a,e,t,r,n),this.dependencies_[a]=r,r=0;r<t.length;r++)this.idToPath_[t[r]]=a;this.idToPath_[e]=a},goog.DependencyFactory=function(){},goog.DependencyFactory.prototype.createDependency=function(e,t,r,n,a){return a.module==goog.ModuleType.GOOG?new goog.GoogModuleDependency(e,t,r,n,a):a.module==goog.ModuleType.ES6?goog.ASSUME_ES_MODULES_TRANSPILED?new goog.PreTranspiledEs6ModuleDependency(e,t,r,n,a):new goog.Es6ModuleDependency(e,t,r,n,a):new goog.Dependency(e,t,r,n,a)},goog.debugLoader_=new goog.DebugLoader_,goog.loadClosureDeps=function(){goog.debugLoader_.loadClosureDeps()},goog.setDependencyFactory=function(e){goog.debugLoader_.setDependencyFactory(e)},goog.TRUSTED_TYPES_POLICY_=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#base"):null,goog.global.CLOSURE_NO_DEPS||goog.debugLoader_.loadClosureDeps(),goog.bootstrap=function(e,t){goog.debugLoader_.bootstrap(e,t)}),!COMPILED){var isChrome87=!1;try{isChrome87=eval(goog.global.trustedTypes.emptyScript)!==goog.global.trustedTypes.emptyScript}catch(a){}goog.CLOSURE_EVAL_PREFILTER_=goog.global.trustedTypes&&isChrome87&&goog.createTrustedTypesPolicy("goog#base#devonly#eval")||{createScript:goog.identity_}}goog.asserts=function(){},goog.asserts.assert=function(e,t){},goog.asserts.ENABLE_ASSERTS=!0,goog.asserts.ENABLE_ASSERTS&&console.assert&&console.assert.bind&&(goog.asserts.assert=console.assert.bind(console));var shaka={abr:{}};shaka.abr.Ewma=function(e){goog.asserts.assert(0<e,"expected halfLife to be positive"),this.alpha_=Math.exp(Math.log(.5)/e),this.totalWeight_=this.estimate_=0},shaka.abr.Ewma.prototype.updateAlpha=function(e){goog.asserts.assert(0<e,"expected halfLife to be positive"),this.alpha_=Math.exp(Math.log(.5)/e)},shaka.abr.Ewma.prototype.sample=function(e,t){var r=Math.pow(this.alpha_,e);t=t*(1-r)+r*this.estimate_,isNaN(t)||(this.estimate_=t,this.totalWeight_+=e)},shaka.abr.Ewma.prototype.getEstimate=function(){return this.estimate_/(1-Math.pow(this.alpha_,this.totalWeight_))},shaka.abr.EwmaBandwidthEstimator=function(){this.fast_=new shaka.abr.Ewma(2),this.slow_=new shaka.abr.Ewma(5),this.bytesSampled_=0,this.minTotalBytes_=128e3,this.minBytes_=16e3},shaka.abr.EwmaBandwidthEstimator.prototype.configure=function(e){this.minTotalBytes_=e.minTotalBytes,this.minBytes_=e.minBytes,this.fast_.updateAlpha(e.fastHalfLife),this.slow_.updateAlpha(e.slowHalfLife)},shaka.abr.EwmaBandwidthEstimator.prototype.sample=function(e,t){if(!(t<this.minBytes_)){var r=8e3*t/e;e/=1e3,this.bytesSampled_+=t,this.fast_.sample(e,r),this.slow_.sample(e,r)}},shaka.abr.EwmaBandwidthEstimator.prototype.getBandwidthEstimate=function(e){return this.bytesSampled_<this.minTotalBytes_?e:Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())},shaka.abr.EwmaBandwidthEstimator.prototype.hasGoodEstimate=function(){return this.bytesSampled_>=this.minTotalBytes_},shaka.log=function(){},shaka.log.alwaysError=function(){},shaka.log.alwaysWarn=function(){},shaka.log.warnOnce=function(e){var t=$jscomp.getRestArguments.apply(1,arguments);shaka.log.oneTimeWarningIssued_.has(e)||(shaka.log.oneTimeWarningIssued_.add(e),shaka.log.alwaysWarn.apply(shaka.log,$jscomp.arrayFromIterable(t)))},shaka.log.error=function(){},shaka.log.warning=function(){},shaka.log.info=function(){},shaka.log.debug=function(){},shaka.log.v1=function(){},shaka.log.v2=function(){},shaka.log.Level={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,V1:5,V2:6},shaka.log.MAX_LOG_LEVEL=4,shaka.log.oneTimeWarningIssued_=new Set,window.console&&(shaka.log.logMap_=(new Map).set(shaka.log.Level.ERROR,(function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.error.apply(console,$jscomp.arrayFromIterable(e))})).set(shaka.log.Level.WARNING,(function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.warn.apply(console,$jscomp.arrayFromIterable(e))})).set(shaka.log.Level.INFO,(function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.info.apply(console,$jscomp.arrayFromIterable(e))})).set(shaka.log.Level.DEBUG,(function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.log.apply(console,$jscomp.arrayFromIterable(e))})).set(shaka.log.Level.V1,(function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.debug.apply(console,$jscomp.arrayFromIterable(e))})).set(shaka.log.Level.V2,(function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.debug.apply(console,$jscomp.arrayFromIterable(e))})),shaka.log.alwaysWarn=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.warn.apply(console,$jscomp.arrayFromIterable(e))},shaka.log.alwaysError=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.error.apply(console,$jscomp.arrayFromIterable(e))},goog.DEBUG?(goog.exportSymbol("shaka.log",shaka.log),shaka.log.setLevel=function(e){var t=function(t){return t<=e?(goog.asserts.assert(shaka.log.logMap_.has(t),"Unexpected log level"),shaka.log.logMap_.get(t)):function(){}};shaka.log.currentLevel=e,shaka.log.error=t(shaka.log.Level.ERROR),shaka.log.warning=t(shaka.log.Level.WARNING),shaka.log.info=t(shaka.log.Level.INFO),shaka.log.debug=t(shaka.log.Level.DEBUG),shaka.log.v1=t(shaka.log.Level.V1),shaka.log.v2=t(shaka.log.Level.V2)},shaka.log.setLevel(shaka.log.MAX_LOG_LEVEL)):(shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.ERROR&&(shaka.log.error=shaka.log.logMap_.get(shaka.log.Level.ERROR)),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.WARNING&&(shaka.log.warning=shaka.log.logMap_.get(shaka.log.Level.WARNING)),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.INFO&&(shaka.log.info=shaka.log.logMap_.get(shaka.log.Level.INFO)),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.DEBUG&&(shaka.log.debug=shaka.log.logMap_.get(shaka.log.Level.DEBUG)),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.V1&&(shaka.log.v1=shaka.log.logMap_.get(shaka.log.Level.V1)),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.V2&&(shaka.log.v2=shaka.log.logMap_.get(shaka.log.Level.V2)))),shaka.util={},shaka.util.IReleasable=function(){},shaka.util.IReleasable.prototype.release=function(){},shaka.util.MultiMap=function(){this.map_=new Map},shaka.util.MultiMap.prototype.push=function(e,t){this.map_.has(e)?this.map_.get(e).push(t):this.map_.set(e,[t])},shaka.util.MultiMap.prototype.get=function(e){return this.map_.has(e)?this.map_.get(e).slice():null},shaka.util.MultiMap.prototype.getAll=function(){for(var e=[],t=$jscomp.makeIterator(this.map_.values()),r=t.next();!r.done;r=t.next())e.push.apply(e,$jscomp.arrayFromIterable(r.value));return e},shaka.util.MultiMap.prototype.remove=function(e,t){if(this.map_.has(e)){var r=this.map_.get(e).filter((function(e){return e!=t}));this.map_.set(e,r),r.length||this.map_.delete(e)}},shaka.util.MultiMap.prototype.clear=function(){this.map_.clear()},shaka.util.MultiMap.prototype.forEach=function(e){this.map_.forEach((function(t,r){e(r,t)}))},shaka.util.MultiMap.prototype.size=function(){return this.map_.size},shaka.util.MultiMap.prototype.keys=function(){return Array.from(this.map_.keys())},shaka.util.EventManager=function(){this.bindingMap_=new shaka.util.MultiMap},shaka.util.EventManager.prototype.release=function(){this.removeAll(),this.bindingMap_=null},shaka.util.EventManager.prototype.listen=function(e,t,r,n){this.bindingMap_&&(e=new shaka.util.EventManager.Binding_(e,t,r,n),this.bindingMap_.push(t,e))},shaka.util.EventManager.prototype.listenOnce=function(e,t,r,n){var a=this,i=function(n){a.unlisten(e,t,i),r(n)};this.listen(e,t,i,n)},shaka.util.EventManager.prototype.unlisten=function(e,t,r){if(this.bindingMap_)for(var n=this.bindingMap_.get(t)||[],a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next())(a=a.value).target!=e||r!=a.listener&&r||(a.unlisten(),this.bindingMap_.remove(t,a))},shaka.util.EventManager.prototype.removeAll=function(){if(this.bindingMap_){for(var e=this.bindingMap_.getAll(),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())t.value.unlisten();this.bindingMap_.clear()}},goog.exportSymbol("shaka.util.EventManager",shaka.util.EventManager),goog.exportProperty(shaka.util.EventManager.prototype,"removeAll",shaka.util.EventManager.prototype.removeAll),goog.exportProperty(shaka.util.EventManager.prototype,"unlisten",shaka.util.EventManager.prototype.unlisten),goog.exportProperty(shaka.util.EventManager.prototype,"listenOnce",shaka.util.EventManager.prototype.listenOnce),goog.exportProperty(shaka.util.EventManager.prototype,"listen",shaka.util.EventManager.prototype.listen),goog.exportProperty(shaka.util.EventManager.prototype,"release",shaka.util.EventManager.prototype.release),shaka.util.EventManager.Binding_=function(e,t,r,n){this.target=e,this.type=t,this.listener=r,this.options=shaka.util.EventManager.Binding_.convertOptions_(e,n),this.target.addEventListener(t,r,this.options)},shaka.util.EventManager.Binding_.prototype.unlisten=function(){goog.asserts.assert(this.target,"Missing target"),this.target.removeEventListener(this.type,this.listener,this.options),this.listener=this.target=null,this.options=!1},shaka.util.EventManager.Binding_.convertOptions_=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var r=new Set(["passive","capture"]),n=Object.keys(t).filter((function(e){return!r.has(e)}));return goog.asserts.assert(0==n.length,"Unsupported flag(s) to addEventListener: "+n.join(",")),shaka.util.EventManager.Binding_.doesSupportObject_(e)?t:t.capture||!1},shaka.util.EventManager.Binding_.doesSupportObject_=function(e){var t=shaka.util.EventManager.Binding_.supportsObject_;if(null==t){t=!1;try{var r={},n={get:function(){return t=!0,!1}};Object.defineProperty(r,"passive",n),Object.defineProperty(r,"capture",n),n=function(){},e.addEventListener("test",n,r),e.removeEventListener("test",n,r)}catch(e){t=!1}shaka.util.EventManager.Binding_.supportsObject_=t}return t||!1},shaka.util.EventManager.Binding_.supportsObject_=void 0,shaka.config={},shaka.config.AutoShowText={NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3},goog.exportSymbol("shaka.config.AutoShowText",shaka.config.AutoShowText),shaka.deprecate={},shaka.deprecate.Version=function(e,t){this.major_=e,this.minor_=t},shaka.deprecate.Version.prototype.major=function(){return this.major_},shaka.deprecate.Version.prototype.minor=function(){return this.minor_},shaka.deprecate.Version.prototype.compareTo=function(e){var t=this.minor_-e.minor_;return this.major_-e.major_||t},shaka.deprecate.Version.prototype.toString=function(){return"v"+this.major_+"."+this.minor_},shaka.deprecate.Version.parse=function(e){return e=e.substring(1).split(".",2),new shaka.deprecate.Version(Number(e[0]),Number(e[1]))},shaka.deprecate.Enforcer=function(e,t,r){this.libraryVersion_=e,this.onPending_=t,this.onExpired_=r},shaka.deprecate.Enforcer.prototype.enforce=function(e,t,r){(0<e.compareTo(this.libraryVersion_)?this.onPending_:this.onExpired_)(this.libraryVersion_,e,t,r)},shaka.Deprecate=function(){},shaka.Deprecate.init=function(e){goog.asserts.assert(null==shaka.Deprecate.enforcer_,"Deprecate.init should only be called once."),shaka.Deprecate.enforcer_=new shaka.deprecate.Enforcer(shaka.deprecate.Version.parse(e),shaka.Deprecate.onPending_,shaka.Deprecate.onExpired_)},shaka.Deprecate.deprecateFeature=function(e,t,r){var n=shaka.Deprecate.enforcer_;goog.asserts.assert(n,"Missing deprecation enforcer. Was |init| called?"),e=new shaka.deprecate.Version(e,0),n.enforce(e,t,r)},shaka.Deprecate.onPending_=function(e,t,r,n){shaka.log.alwaysWarn([r,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",n].join(" "))},shaka.Deprecate.onExpired_=function(e,t,r,n){e=[r,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",n].join(" "),shaka.log.alwaysError(e),goog.asserts.assert(!1,e)},shaka.Deprecate.enforcer_=null,goog.uri={},goog.uri.utils={},goog.uri.utils.splitRe_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),goog.uri.utils.ComponentIndex={SCHEME:1,USER_INFO:2,DOMAIN:3,PORT:4,PATH:5,QUERY_DATA:6,FRAGMENT:7},goog.uri.utils.split=function(e){return e.match(goog.uri.utils.splitRe_)},goog.Uri=function(e){var t;e instanceof goog.Uri?(this.setScheme(e.getScheme()),this.setUserInfo(e.getUserInfo()),this.setDomain(e.getDomain()),this.setPort(e.getPort()),this.setPath(e.getPath()),this.setQueryData(e.getQueryData().clone()),this.setFragment(e.getFragment())):e&&(t=goog.uri.utils.split(String(e)))?(this.setScheme(t[goog.uri.utils.ComponentIndex.SCHEME]||"",!0),this.setUserInfo(t[goog.uri.utils.ComponentIndex.USER_INFO]||"",!0),this.setDomain(t[goog.uri.utils.ComponentIndex.DOMAIN]||"",!0),this.setPort(t[goog.uri.utils.ComponentIndex.PORT]),this.setPath(t[goog.uri.utils.ComponentIndex.PATH]||"",!0),this.setQueryData(t[goog.uri.utils.ComponentIndex.QUERY_DATA]||"",!0),this.setFragment(t[goog.uri.utils.ComponentIndex.FRAGMENT]||"",!0)):this.queryData_=new goog.Uri.QueryData(null,null)},goog.Uri.prototype.scheme_="",goog.Uri.prototype.userInfo_="",goog.Uri.prototype.domain_="",goog.Uri.prototype.port_=null,goog.Uri.prototype.path_="",goog.Uri.prototype.fragment_="",goog.Uri.prototype.toString=function(){var e=[],t=this.getScheme();if(t&&e.push(goog.Uri.encodeSpecialChars_(t,goog.Uri.reDisallowedInSchemeOrUserInfo_,!0),":"),t=this.getDomain()){e.push("//");var r=this.getUserInfo();r&&e.push(goog.Uri.encodeSpecialChars_(r,goog.Uri.reDisallowedInSchemeOrUserInfo_,!0),"@"),e.push(goog.Uri.removeDoubleEncoding_(encodeURIComponent(t))),null!=(t=this.getPort())&&e.push(":",String(t))}return(t=this.getPath())&&(this.hasDomain()&&"/"!=t.charAt(0)&&e.push("/"),e.push(goog.Uri.encodeSpecialChars_(t,"/"==t.charAt(0)?goog.Uri.reDisallowedInAbsolutePath_:goog.Uri.reDisallowedInRelativePath_,!0))),(t=this.getEncodedQuery())&&e.push("?",t),(t=this.getFragment())&&e.push("#",goog.Uri.encodeSpecialChars_(t,goog.Uri.reDisallowedInFragment_)),e.join("")},goog.Uri.prototype.resolve=function(e){var t=this.clone();"data"===t.scheme_&&(t=new goog.Uri);var r=e.hasScheme();r?t.setScheme(e.getScheme()):r=e.hasUserInfo(),r?t.setUserInfo(e.getUserInfo()):r=e.hasDomain(),r?t.setDomain(e.getDomain()):r=e.hasPort();var n=e.getPath();if(r)t.setPort(e.getPort());else if(r=e.hasPath()){if("/"!=n.charAt(0))if(this.hasDomain()&&!this.hasPath())n="/"+n;else{var a=t.getPath().lastIndexOf("/");-1!=a&&(n=t.getPath().substr(0,a+1)+n)}n=goog.Uri.removeDotSegments(n)}return r?t.setPath(n):r=e.hasQuery(),r?t.setQueryData(e.getQueryData().clone()):r=e.hasFragment(),r&&t.setFragment(e.getFragment()),t},goog.Uri.prototype.clone=function(){return new goog.Uri(this)},goog.Uri.prototype.getScheme=function(){return this.scheme_},goog.Uri.prototype.setScheme=function(e,t){return(this.scheme_=t?goog.Uri.decodeOrEmpty_(e,!0):e)&&(this.scheme_=this.scheme_.replace(/:$/,"")),this},goog.Uri.prototype.hasScheme=function(){return!!this.scheme_},goog.Uri.prototype.getUserInfo=function(){return this.userInfo_},goog.Uri.prototype.setUserInfo=function(e,t){return this.userInfo_=t?goog.Uri.decodeOrEmpty_(e):e,this},goog.Uri.prototype.hasUserInfo=function(){return!!this.userInfo_},goog.Uri.prototype.getDomain=function(){return this.domain_},goog.Uri.prototype.setDomain=function(e,t){return this.domain_=t?goog.Uri.decodeOrEmpty_(e,!0):e,this},goog.Uri.prototype.hasDomain=function(){return!!this.domain_},goog.Uri.prototype.getPort=function(){return this.port_},goog.Uri.prototype.setPort=function(e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);this.port_=e}else this.port_=null;return this},goog.Uri.prototype.hasPort=function(){return null!=this.port_},goog.Uri.prototype.getPath=function(){return this.path_},goog.Uri.prototype.setPath=function(e,t){return this.path_=t?goog.Uri.decodeOrEmpty_(e,!0):e,this},goog.Uri.prototype.hasPath=function(){return!!this.path_},goog.Uri.prototype.hasQuery=function(){return""!==this.queryData_.toString()},goog.Uri.prototype.setQueryData=function(e,t){return e instanceof goog.Uri.QueryData?this.queryData_=e:(t||(e=goog.Uri.encodeSpecialChars_(e,goog.Uri.reDisallowedInQuery_)),this.queryData_=new goog.Uri.QueryData(e,null)),this},goog.Uri.prototype.getEncodedQuery=function(){return this.queryData_.toString()},goog.Uri.prototype.getDecodedQuery=function(){return this.queryData_.toDecodedString()},goog.Uri.prototype.getQueryData=function(){return this.queryData_},goog.Uri.prototype.getFragment=function(){return this.fragment_},goog.Uri.prototype.setFragment=function(e,t){return this.fragment_=t?goog.Uri.decodeOrEmpty_(e):e,this},goog.Uri.prototype.hasFragment=function(){return!!this.fragment_},goog.Uri.removeDotSegments=function(e){if(".."==e||"."==e)return"";if(-1==e.indexOf("./")&&-1==e.indexOf("/."))return e;var t=0==e.lastIndexOf("/",0);e=e.split("/");for(var r=[],n=0;n<e.length;){var a=e[n++];"."==a?t&&n==e.length&&r.push(""):".."==a?((1<r.length||1==r.length&&""!=r[0])&&r.pop(),t&&n==e.length&&r.push("")):(r.push(a),t=!0)}return r.join("/")},goog.Uri.decodeOrEmpty_=function(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""},goog.Uri.encodeSpecialChars_=function(e,t,r){return null!=e?(e=encodeURI(e).replace(t,goog.Uri.encodeChar_),r&&(e=goog.Uri.removeDoubleEncoding_(e)),e):null},goog.Uri.encodeChar_=function(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)},goog.Uri.removeDoubleEncoding_=function(e){return e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")},goog.Uri.reDisallowedInSchemeOrUserInfo_=/[#\/\?@]/g,goog.Uri.reDisallowedInRelativePath_=/[#\?:]/g,goog.Uri.reDisallowedInAbsolutePath_=/[#\?]/g,goog.Uri.reDisallowedInQuery_=/[#\?@]/g,goog.Uri.reDisallowedInFragment_=/#/g,goog.Uri.QueryData=function(e,t){this.encodedQuery_=e||null},goog.Uri.QueryData.prototype.ensureKeyMapInitialized_=function(){if(!this.keyMap_&&(this.keyMap_=new Map,this.count_=0,this.encodedQuery_))for(var e=this.encodedQuery_.split("&"),t=0;t<e.length;t++){var r=e[t].indexOf("="),n=null;if(0<=r){var a=e[t].substring(0,r);n=e[t].substring(r+1)}else a=e[t];a=decodeURIComponent(a.replace(/\+/g," ")),n=n||"",this.add(a,decodeURIComponent(n.replace(/\+/g," ")))}},goog.Uri.QueryData.prototype.keyMap_=null,goog.Uri.QueryData.prototype.count_=null,goog.Uri.QueryData.prototype.getCount=function(){return this.ensureKeyMapInitialized_(),this.count_},goog.Uri.QueryData.prototype.add=function(e,t){this.ensureKeyMapInitialized_(),this.encodedQuery_=null;var r=this.keyMap_.has(e)?this.keyMap_.get(e):null;return r||this.keyMap_.set(e,r=[]),r.push(t),goog.asserts.assert(null!=this.count_,"Should not be null."),this.count_++,this},goog.Uri.QueryData.prototype.set=function(e,t){return this.ensureKeyMapInitialized_(),this.encodedQuery_=null,this.keyMap_.has(e)?this.keyMap_.set(e,[t]):this.add(e,t),this},goog.Uri.QueryData.prototype.get=function(e){return this.ensureKeyMapInitialized_(),this.keyMap_.get(e)||[]},goog.Uri.QueryData.prototype.toString=function(){if(this.encodedQuery_)return this.encodedQuery_;if(!this.keyMap_||!this.keyMap_.size)return"";for(var e=[],t=$jscomp.makeIterator(this.keyMap_.keys()),r=t.next();!r.done;r=t.next()){var n=r.value;r=encodeURIComponent(n),n=this.keyMap_.get(n);for(var a=0;a<n.length;a++){var i=r;""!==n[a]&&(i+="="+encodeURIComponent(n[a])),e.push(i)}}return this.encodedQuery_=e.join("&")},goog.Uri.QueryData.prototype.toDecodedString=function(){return goog.Uri.decodeOrEmpty_(this.toString())},goog.Uri.QueryData.prototype.clone=function(){var e=new goog.Uri.QueryData;if(e.encodedQuery_=this.encodedQuery_,this.keyMap_){for(var t=new Map,r=$jscomp.makeIterator(this.keyMap_),n=r.next();!n.done;n=r.next()){var a=$jscomp.makeIterator(n.value);n=a.next().value,a=a.next().value,t.set(n,a.concat())}e.keyMap_=t,e.count_=this.count_}return e},shaka.util.BufferUtils=function(){},shaka.util.BufferUtils.equal=function(e,t){var r=shaka.util.BufferUtils;if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if(r.unsafeGetArrayBuffer_(e)==r.unsafeGetArrayBuffer_(t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;r=shaka.util.BufferUtils.toUint8(e),t=shaka.util.BufferUtils.toUint8(t);for(var n=0;n<e.byteLength;n++)if(r[n]!=t[n])return!1;return!0},shaka.util.BufferUtils.unsafeGetArrayBuffer_=function(e){return ArrayBuffer.isView(e)?e.buffer:e},shaka.util.BufferUtils.toArrayBuffer=function(e){return ArrayBuffer.isView(e)?0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer:e},shaka.util.BufferUtils.toUint8=function(e,t,r){return r=void 0===r?1/0:r,shaka.util.BufferUtils.view_(e,void 0===t?0:t,r,Uint8Array)},shaka.util.BufferUtils.toUint16=function(e,t,r){return r=void 0===r?1/0:r,shaka.util.BufferUtils.view_(e,void 0===t?0:t,r,Uint16Array)},shaka.util.BufferUtils.toDataView=function(e,t,r){return r=void 0===r?1/0:r,shaka.util.BufferUtils.view_(e,void 0===t?0:t,r,DataView)},shaka.util.BufferUtils.view_=function(e,t,r,n){var a=shaka.util.BufferUtils.unsafeGetArrayBuffer_(e),i=1;"BYTES_PER_ELEMENT"in n&&(i=n.BYTES_PER_ELEMENT);var s=((e.byteOffset||0)+e.byteLength)/i;return new n(a,e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/i,s))),Math.floor(Math.min(e+Math.max(r,0),s))-e)},goog.exportSymbol("shaka.util.BufferUtils",shaka.util.BufferUtils),goog.exportProperty(shaka.util.BufferUtils,"toDataView",shaka.util.BufferUtils.toDataView),goog.exportProperty(shaka.util.BufferUtils,"toUint16",shaka.util.BufferUtils.toUint16),goog.exportProperty(shaka.util.BufferUtils,"toUint8",shaka.util.BufferUtils.toUint8),goog.exportProperty(shaka.util.BufferUtils,"toArrayBuffer",shaka.util.BufferUtils.toArrayBuffer),goog.exportProperty(shaka.util.BufferUtils,"equal",shaka.util.BufferUtils.equal),shaka.util.Error=function(e,t,r){var n=$jscomp.getRestArguments.apply(3,arguments);if(this.severity=e,this.category=t,this.code=r,this.data=n,this.handled=!1,n="Shaka Error "+this.code,goog.DEBUG){var a,i=n="UNKNOWN";for(a in shaka.util.Error.Category)shaka.util.Error.Category[a]==this.category&&(n=a);for(var s in shaka.util.Error.Code)shaka.util.Error.Code[s]==this.code&&(i=s);n="Shaka Error "+n+"."+i+" ("+this.data.toString()+")"}if(this.message=n,shaka.util.Error.createStack)try{throw Error(this.message||"Shaka Error")}catch(e){this.stack=e.stack}},shaka.util.Error.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},goog.exportSymbol("shaka.util.Error",shaka.util.Error),shaka.util.Error.createStack=!0,shaka.util.Error.Severity={RECOVERABLE:1,CRITICAL:2},goog.exportProperty(shaka.util.Error,"Severity",shaka.util.Error.Severity),shaka.util.Error.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},goog.exportProperty(shaka.util.Error,"Category",shaka.util.Error.Category),shaka.util.Error.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,STREAMING_NOT_ALLOWED:3024,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,DASH_INVALID_PATCH:4052,HLS_EMPTY_MEDIA_PLAYLIST:4053,DASH_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4054,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,MISSING_EME_SUPPORT:6020,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,PRELOAD_DESTROYED:7006,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005,INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED:10006,VAST_INVALID_XML:10007},goog.exportProperty(shaka.util.Error,"Code",shaka.util.Error.Code),shaka.util.Lazy=function(e){this.gen_=e,this.value_=void 0},shaka.util.Lazy.prototype.value=function(){return void 0===this.value_&&(this.value_=this.gen_(),goog.asserts.assert(void 0!==this.value_,"Unable to create lazy value")),this.value_},shaka.util.Lazy.prototype.reset=function(){this.value_=void 0},shaka.drm={},shaka.drm.DrmUtils=function(){},shaka.drm.DrmUtils.isBrowserSupported=function(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)},shaka.drm.DrmUtils.areDrmCompatible=function(e,t){return!e.length||!t.length||e===t||0<shaka.drm.DrmUtils.getCommonDrmInfos(e,t).length},shaka.drm.DrmUtils.getCommonDrmInfos=function(e,t){if(!e.length)return t;if(!t.length)return e;for(var r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;for(var a=$jscomp.makeIterator(t),i=a.next();!i.done;i=a.next())if(i=i.value,n.keySystem==i.keySystem){a=new Map;for(var s=(n.initData||[]).concat(i.initData||[]),o=(s=$jscomp.makeIterator(s)).next();!o.done;o=s.next())o=o.value,a.set(o.keyId,o);a=Array.from(a.values()),s=n.keyIds&&i.keyIds?new Set([].concat($jscomp.arrayFromIterable(n.keyIds),$jscomp.arrayFromIterable(i.keyIds))):n.keyIds||i.keyIds,r.push({keySystem:n.keySystem,licenseServerUri:n.licenseServerUri||i.licenseServerUri,distinctiveIdentifierRequired:n.distinctiveIdentifierRequired||i.distinctiveIdentifierRequired,persistentStateRequired:n.persistentStateRequired||i.persistentStateRequired,videoRobustness:n.videoRobustness||i.videoRobustness,audioRobustness:n.audioRobustness||i.audioRobustness,serverCertificate:n.serverCertificate||i.serverCertificate,serverCertificateUri:n.serverCertificateUri||i.serverCertificateUri,initData:a,keyIds:s});break}}return r},shaka.drm.DrmUtils.keySystem=function(e){return e?e.keySystem:""},shaka.drm.DrmUtils.isClearKeySystem=function(e){return"org.w3.clearkey"===e},shaka.drm.DrmUtils.isWidevineKeySystem=function(e){return!!e&&!!e.match(/^com\.widevine\.alpha/)},shaka.drm.DrmUtils.isPlayReadyKeySystem=function(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)},shaka.drm.DrmUtils.isFairPlayKeySystem=function(e){return!!e&&!!e.match(/^com\.apple\.fps/)},shaka.drm.DrmUtils.isWisePlayKeySystem=function(e){return"com.huawei.wiseplay"===e},shaka.drm.DrmUtils.generateKeySystemCacheKey_=function(e,t,r){return e+"#"+t+"#"+r},shaka.drm.DrmUtils.hasMediaKeySystemAccess=function(e,t,r){var n=shaka.drm.DrmUtils;return e=n.generateKeySystemCacheKey_(e,t,r),n.memoizedMediaKeySystemAccessRequests_.has(e)},shaka.drm.DrmUtils.getMediaKeySystemAccess=function(e,t,r){var n=shaka.drm.DrmUtils;return e=n.generateKeySystemCacheKey_(e,t,r),n.memoizedMediaKeySystemAccessRequests_.get(e)||null},shaka.drm.DrmUtils.setMediaKeySystemAccess=function(e,t,r,n){var a=shaka.drm.DrmUtils;e=a.generateKeySystemCacheKey_(e,t,r),a.memoizedMediaKeySystemAccessRequests_.set(e,n)},shaka.drm.DrmUtils.clearMediaKeySystemAccessMap=function(){shaka.drm.DrmUtils.memoizedMediaKeySystemAccessRequests_.clear()},shaka.drm.DrmUtils.isMediaKeysPolyfilled=function(e){return e===window.shakaMediaKeysPolyfill},shaka.drm.DrmUtils.DUMMY_KEY_ID=new shaka.util.Lazy((function(){return shaka.util.BufferUtils.toArrayBuffer(new Uint8Array([0]))})),shaka.drm.DrmUtils.memoizedMediaKeySystemAccessRequests_=new Map,shaka.util.DelayedTick=function(e){this.onTick_=e,this.cancelPending_=null},shaka.util.DelayedTick.prototype.tickAfter=function(e){var t=this;this.stop();var r=!0,n=null;return this.cancelPending_=function(){window.clearTimeout(n),r=!1},n=window.setTimeout((function(){r&&t.onTick_()}),1e3*e),this},shaka.util.DelayedTick.prototype.stop=function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)},shaka.util.Timer=function(e){this.onTick_=e,this.ticker_=null},shaka.util.Timer.prototype.tickNow=function(){return this.stop(),this.onTick_(),this},shaka.util.Timer.prototype.tickAfter=function(e){var t=this;return this.stop(),this.ticker_=new shaka.util.DelayedTick((function(){t.onTick_()})).tickAfter(e),this},shaka.util.Timer.prototype.tickEvery=function(e){var t=this;return this.stop(),goog.DEBUG&&shaka.util.Timer.activeTimers.set(this,Error("Timer created").stack),this.ticker_=new shaka.util.DelayedTick((function(){t.ticker_.tickAfter(e),t.onTick_()})).tickAfter(e),this},shaka.util.Timer.prototype.stop=function(){this.ticker_&&(this.ticker_.stop(),this.ticker_=null),goog.DEBUG&&shaka.util.Timer.activeTimers.delete(this)},goog.exportSymbol("shaka.util.Timer",shaka.util.Timer),goog.exportProperty(shaka.util.Timer.prototype,"stop",shaka.util.Timer.prototype.stop),goog.exportProperty(shaka.util.Timer.prototype,"tickEvery",shaka.util.Timer.prototype.tickEvery),goog.exportProperty(shaka.util.Timer.prototype,"tickAfter",shaka.util.Timer.prototype.tickAfter),goog.exportProperty(shaka.util.Timer.prototype,"tickNow",shaka.util.Timer.prototype.tickNow),goog.DEBUG&&(shaka.util.Timer.activeTimers=new Map),shaka.util.Platform=function(){},shaka.util.Platform.supportsMediaSource=function(){var e=window.ManagedMediaSource||window.MediaSource;return!(!e||!e.isTypeSupported)},shaka.util.Platform.supportsMediaType=function(e){return""!=shaka.util.Platform.anyMediaElement().canPlayType(e)},shaka.util.Platform.isEdge=function(){return!!navigator.userAgent.match(/Edge?\//)},shaka.util.Platform.isLegacyEdge=function(){return!!navigator.userAgent.match(/Edge\//)},shaka.util.Platform.isIE=function(){return shaka.util.Platform.userAgentContains_("Trident/")},shaka.util.Platform.isXboxOne=function(){return shaka.util.Platform.userAgentContains_("Xbox One")},shaka.util.Platform.isTizen=function(){return shaka.util.Platform.userAgentContains_("Tizen")},shaka.util.Platform.isTizen6=function(){return shaka.util.Platform.userAgentContains_("Tizen 6")},shaka.util.Platform.isTizen5_0=function(){return shaka.util.Platform.userAgentContains_("Tizen 5.0")},shaka.util.Platform.isTizen5=function(){return shaka.util.Platform.userAgentContains_("Tizen 5")},shaka.util.Platform.isTizen4=function(){return shaka.util.Platform.userAgentContains_("Tizen 4")},shaka.util.Platform.isTizen3=function(){return shaka.util.Platform.userAgentContains_("Tizen 3")},shaka.util.Platform.isTizen2=function(){return shaka.util.Platform.userAgentContains_("Tizen 2")},shaka.util.Platform.isWebOS=function(){return shaka.util.Platform.userAgentContains_("Web0S")},shaka.util.Platform.isWebOS3=function(){return shaka.util.Platform.isWebOS()&&38===shaka.util.Platform.chromeVersion()},shaka.util.Platform.isWebOS4=function(){return shaka.util.Platform.isWebOS()&&53===shaka.util.Platform.chromeVersion()},shaka.util.Platform.isWebOS5=function(){return shaka.util.Platform.isWebOS()&&68===shaka.util.Platform.chromeVersion()},shaka.util.Platform.isWebOS6=function(){return shaka.util.Platform.isWebOS()&&79===shaka.util.Platform.chromeVersion()},shaka.util.Platform.isChromecast=function(){var e=shaka.util.Platform;return e.userAgentContains_("CrKey")&&!e.isVizio()},shaka.util.Platform.isOlderChromecast=function(){var e=shaka.util.Platform;return e.isChromecast()&&!e.isAndroid()&&!e.isFuchsia()},shaka.util.Platform.isAndroidCastDevice=function(){var e=shaka.util.Platform;return e.isChromecast()&&e.isAndroid()},shaka.util.Platform.isFuchsiaCastDevice=function(){var e=shaka.util.Platform;return e.isChromecast()&&e.isFuchsia()},shaka.util.Platform.chromeVersion=function(){if(!shaka.util.Platform.isChrome())return null;var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null},shaka.util.Platform.isChrome=function(){return shaka.util.Platform.userAgentContains_("Chrome")&&!shaka.util.Platform.isLegacyEdge()},shaka.util.Platform.isFirefox=function(){return shaka.util.Platform.userAgentContains_("Firefox")},shaka.util.Platform.isApple=function(){return shaka.util.Platform.isAppleVendor_()&&(shaka.util.Platform.isMac()||shaka.util.Platform.isIOS())},shaka.util.Platform.isPS5=function(){return shaka.util.Platform.userAgentContains_("PlayStation 5")},shaka.util.Platform.isPS4=function(){return shaka.util.Platform.userAgentContains_("PlayStation 4")},shaka.util.Platform.isHisense=function(){return shaka.util.Platform.userAgentContains_("Hisense")||shaka.util.Platform.userAgentContains_("VIDAA")},shaka.util.Platform.isVizio=function(){return shaka.util.Platform.userAgentContains_("VIZIO SmartCast")},shaka.util.Platform.isOrange=function(){return shaka.util.Platform.userAgentContains_("SOPOpenBrowser")},shaka.util.Platform.isSkyQ=function(){return shaka.util.Platform.userAgentContains_("Sky_STB")},shaka.util.Platform.isZenterio=function(){return shaka.util.Platform.userAgentContains_("DT_STB_BCM")},shaka.util.Platform.safariVersion=function(){if(!shaka.util.Platform.isApple()&&!shaka.util.Platform.isWebkitSTB())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null},shaka.util.Platform.isIOS=function(){return!!/(?:iPhone|iPad|iPod)/.test(navigator.userAgent)||shaka.util.Platform.isAppleVendor_()&&1<navigator.maxTouchPoints},shaka.util.Platform.isMobile=function(){return navigator.userAgentData?navigator.userAgentData.mobile:shaka.util.Platform.isIOS()||shaka.util.Platform.isAndroid()},shaka.util.Platform.isMac=function(){return navigator.userAgentData&&navigator.userAgentData.platform?"macos"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("mac")},shaka.util.Platform.isVisionOS=function(){return!(!shaka.util.Platform.isMac()||!("xr"in navigator))},shaka.util.Platform.isWebkitSTB=function(){return shaka.util.Platform.isAppleVendor_()&&!shaka.util.Platform.isApple()},shaka.util.Platform.isWindows=function(){return navigator.userAgentData&&navigator.userAgentData.platform?"windows"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("win32")},shaka.util.Platform.isAndroid=function(){return navigator.userAgentData&&navigator.userAgentData.platform?"android"==navigator.userAgentData.platform.toLowerCase():shaka.util.Platform.userAgentContains_("Android")},shaka.util.Platform.isFuchsia=function(){return navigator.userAgentData&&navigator.userAgentData.platform?"fuchsia"==navigator.userAgentData.platform.toLowerCase():shaka.util.Platform.userAgentContains_("Fuchsia")},shaka.util.Platform.isSmartTV=function(){var e=shaka.util.Platform;return!!(e.isTizen()||e.isWebOS()||e.isXboxOne()||e.isPS4()||e.isPS5()||e.isChromecast()||e.isHisense()||e.isVizio()||e.isWebkitSTB())},shaka.util.Platform.userAgentContains_=function(e){return(navigator.userAgent||"").includes(e)},shaka.util.Platform.isAppleVendor_=function(){return(navigator.vendor||"").includes("Apple")},shaka.util.Platform.anyMediaElement=function(){var e=shaka.util.Platform;return e.cachedMediaElement_||(e.cacheExpirationTimer_||(e.cacheExpirationTimer_=new shaka.util.Timer((function(){e.cachedMediaElement_=null}))),e.cachedMediaElement_=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0],e.cachedMediaElement_||(e.cachedMediaElement_=document.createElement("video")),e.cacheExpirationTimer_.tickAfter(1)),e.cachedMediaElement_},shaka.util.Platform.requiresEncryptionInfoInAllInitSegments=function(e,t){var r=shaka.util.Platform;return e=shaka.drm.DrmUtils.isPlayReadyKeySystem(e),r.isApple()&&"audio"===t||r.isTizen()||r.isXboxOne()||r.isOrange()||r.isEdge()&&r.isWindows()&&e},shaka.util.Platform.requiresTfhdFix=function(e){return shaka.util.Platform.isApple()&&"audio"===e},shaka.util.Platform.requiresEC3InitSegments=function(){return shaka.util.Platform.isTizen3()},shaka.util.Platform.supportsSequenceMode=function(){var e=shaka.util.Platform;if(e.isTizen3()||e.isTizen2()||e.isWebOS3()||e.isPS4()||e.isPS5())return!1;var t=e.safariVersion();return!(e.isWebkitSTB()&&null!=t&&15>t)},shaka.util.Platform.supportsSmoothCodecSwitching=function(){var e=shaka.util.Platform;return!(e.isTizen()||e.isPS4()||e.isPS5()||e.isWebOS6()||e.isOlderChromecast()||e.isWindows()&&e.isEdge())},shaka.util.Platform.isSeekingSlow=function(){var e=shaka.util.Platform;return!(!e.isChromecast()||e.isAndroidCastDevice())},shaka.util.Platform.detectMaxHardwareResolution=function(){var e,t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){switch(v.nextAddress){case 1:if(e=shaka.util.Platform,t={width:1/0,height:1/0},e.isChromecast()){if(f=window.cast&&cast.__platform__&&cast.__platform__.canDisplayType,t.width=1280,t.height=720,v.setCatchFinallyBlocks(14),!(m=f)){v.jumpTo(16);break}return v.yield(cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),17)}if(e.isTizen()){r=window.devicePixelRatio,t.width=1920<window.screen.width*r?3840:1920,t.height=1080<window.screen.height*r?2160:1080;try{webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution?(n=webapis.systeminfo.getMaxVideoResolution(),t.width=n.width,t.height=n.height):webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(t.width=7680,t.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(t.width=3840,t.height=2160)}catch(e){shaka.log.alwaysWarn("Tizen: Error detecting screen size, default screen size 1920x1080.")}v.jumpTo(3);break}if(e.isWebOS()){try{a=JSON.parse(window.PalmSystem.deviceInfo),t.width=Math.max(1920,a.screenWidth),t.height=Math.max(1080,a.screenHeight)}catch(e){shaka.log.alwaysWarn("WebOS: Error detecting screen size, default screen size 1920x1080."),t.width=1920,t.height=1080}v.jumpTo(3);break}if(e.isHisense()){if(i=null,window.Hisense_Get4KSupportState)try{i=window.Hisense_Get4KSupportState()}catch(e){shaka.log.debug("Hisense: Failed to get 4K support state",e)}null==i&&(i=e.userAgentContains_("UHD")),i?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),v.jumpTo(3);break}if(!e.isPS4()&&!e.isPS5()){s=void 0;try{s="undefined"!=typeof Windows?Windows:chrome.webview.hostObjects.sync.Windows}catch(e){}if(s){t.width=1920,t.height=1080;try{o=new s.Media.Protection.ProtectionCapabilities,l=s.Media.Protection.ProtectionCapabilityResult,u=null;do{u=o.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation")}while(u===l.maybe);u===l.probably&&(t.width=3840,t.height=2160)}catch(e){shaka.log.alwaysWarn("Xbox: Error detecting screen size, default screen size 1920x1080.")}}else e.isXboxOne()&&(t.width=1920,t.height=1080,shaka.log.alwaysWarn("Xbox: Error detecting screen size, default screen size 1920x1080."));v.jumpTo(3);break}return c=!1,v.setCatchFinallyBlocks(8),v.yield(window.msdk.device.getDisplayInfo(),10);case 10:d=v.yieldResult,c="4K"===d.resolution,v.leaveTryBlock(9);break;case 8:return v.enterCatchBlock(),v.setCatchFinallyBlocks(11),v.yield(window.msdk.device.getDisplayInfoImmediate(),13);case 13:p=v.yieldResult,c="4K"===p.resolution,v.leaveTryBlock(9);break;case 11:h=v.enterCatchBlock(),shaka.log.alwaysWarn("PlayStation: Failed to get the display info:",h);case 9:c?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),v.jumpTo(3);break;case 17:m=v.yieldResult;case 16:if(m){t.width=3840,t.height=2160,v.jumpTo(18);break}if(!(g=f)){v.jumpTo(19);break}return v.yield(cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),20);case 20:g=v.yieldResult;case 19:g&&(t.width=1920,t.height=1080);case 18:v.leaveTryBlock(3);break;case 14:y=v.enterCatchBlock(),shaka.log.alwaysError("Failed to check canDisplayType:",y);case 3:return v.return(t)}}))},shaka.util.Platform.getHdrLevel=function(e){return void 0!==window.matchMedia&&window.matchMedia("(color-gamut: p3)").matches?e?"HLG":"PQ":"SDR"},shaka.util.Platform.cacheExpirationTimer_=null,shaka.util.Platform.cachedMediaElement_=null,shaka.util.StringUtils=function(){},shaka.util.StringUtils.fromUTF8=function(e){if(!e)return"";if(239==(e=shaka.util.BufferUtils.toUint8(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),window.TextDecoder&&!shaka.util.Platform.isPS4())return(e=(new TextDecoder).decode(e)).includes("")&&shaka.log.alwaysError('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),e;for(var t="",r=0;r<e.length;++r){var n=65533;if(0==(128&e[r])?n=e[r]:e.length>=r+2&&192==(224&e[r])&&128==(192&e[r+1])?(n=(31&e[r])<<6|63&e[r+1],r+=1):e.length>=r+3&&224==(240&e[r])&&128==(192&e[r+1])&&128==(192&e[r+2])?(n=(15&e[r])<<12|(63&e[r+1])<<6|63&e[r+2],r+=2):e.length>=r+4&&240==(241&e[r])&&128==(192&e[r+1])&&128==(192&e[r+2])&&128==(192&e[r+3])&&(n=(7&e[r])<<18|(63&e[r+1])<<12|(63&e[r+2])<<6|63&e[r+3],r+=3),65535>=n)t+=String.fromCharCode(n);else{var a=1023&(n-=65536);t+=String.fromCharCode(55296+(n>>10)),t+=String.fromCharCode(56320+a)}}return t},shaka.util.StringUtils.fromUTF16=function(e,t,r){if(!e)return"";if(!r&&0!=e.byteLength%2)throw shaka.log.error("Data has an incorrect length, must be even."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BAD_ENCODING);r=Math.floor(e.byteLength/2);var n=new Uint16Array(r);e=shaka.util.BufferUtils.toDataView(e);for(var a=0;a<r;a++)n[a]=e.getUint16(2*a,t);return shaka.util.StringUtils.fromCharCode(n)},shaka.util.StringUtils.fromBytesAutoDetect=function(e){var t=shaka.util.StringUtils;if(!e)return"";var r=shaka.util.BufferUtils.toUint8(e);if(239==r[0]&&187==r[1]&&191==r[2])return t.fromUTF8(r);if(254==r[0]&&255==r[1])return t.fromUTF16(r.subarray(2),!1);if(255==r[0]&&254==r[1])return t.fromUTF16(r.subarray(2),!0);var n=function(e){return r.byteLength<=e||9<=r[e]&&126>=r[e]};if(shaka.log.debug("Unable to find byte-order-mark, making an educated guess."),0==r[0]&&0==r[2])return t.fromUTF16(e,!1);if(0==r[1]&&0==r[3])return t.fromUTF16(e,!0);if(n(0)&&n(1)&&n(2)&&n(3))return t.fromUTF8(e);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.UNABLE_TO_DETECT_ENCODING)},shaka.util.StringUtils.toUTF8=function(e){if(window.TextEncoder&&!shaka.util.Platform.isPS4()){var t=new TextEncoder;return shaka.util.BufferUtils.toArrayBuffer(t.encode(e))}e=encodeURIComponent(e),e=unescape(e),t=new Uint8Array(e.length);for(var r=0;r<e.length;r++)t[r]=e[r].charCodeAt(0);return shaka.util.BufferUtils.toArrayBuffer(t)},shaka.util.StringUtils.toUTF16=function(e,t){for(var r=new ArrayBuffer(2*e.length),n=new DataView(r),a=0;a<e.length;++a){var i=e.charCodeAt(a);n.setUint16(2*a,i,t)}return r},shaka.util.StringUtils.fromCharCode=function(e){return shaka.util.StringUtils.fromCharCodeImpl_.value()(e)},shaka.util.StringUtils.resetFromCharCode=function(){shaka.util.StringUtils.fromCharCodeImpl_.reset()},shaka.util.StringUtils.htmlUnescape=function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&nbsp;":"","&lrm;":"","&rlm;":""},r=/&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,n=RegExp(r.source);return e&&n.test(e)?e.replace(r,(function(e){return"#"==e[1]?0<=(e="x"==e[2]||"X"==e[2]?parseInt(e.substring(3),16):parseInt(e.substring(2),10))&&1114111>=e?String.fromCodePoint(e):"":t[e]||"'"})):e||""},goog.exportSymbol("shaka.util.StringUtils",shaka.util.StringUtils),goog.exportProperty(shaka.util.StringUtils,"resetFromCharCode",shaka.util.StringUtils.resetFromCharCode),goog.exportProperty(shaka.util.StringUtils,"toUTF16",shaka.util.StringUtils.toUTF16),goog.exportProperty(shaka.util.StringUtils,"toUTF8",shaka.util.StringUtils.toUTF8),goog.exportProperty(shaka.util.StringUtils,"fromBytesAutoDetect",shaka.util.StringUtils.fromBytesAutoDetect),goog.exportProperty(shaka.util.StringUtils,"fromUTF16",shaka.util.StringUtils.fromUTF16),goog.exportProperty(shaka.util.StringUtils,"fromUTF8",shaka.util.StringUtils.fromUTF8),shaka.util.StringUtils.fromCharCodeImpl_=new shaka.util.Lazy((function(){for(var e=function(e){try{var t=new Uint8Array(e),r=String.fromCharCode.apply(null,t);return goog.asserts.assert(r,"Should get value"),0<r.length}catch(e){return!1}},t={size$jscomp$22:65536};0<t.size$jscomp$22;(t={size$jscomp$22:t.size$jscomp$22}).size$jscomp$22/=2)if(e(t.size$jscomp$22))return function(e){return function(t){for(var r="",n=0;n<t.length;n+=e.size$jscomp$22){var a=t.subarray(n,n+e.size$jscomp$22);r+=String.fromCharCode.apply(null,a)}return r}}(t);return goog.asserts.assert(!1,"Unable to create a fromCharCode method"),null})),shaka.util.Uint8ArrayUtils=function(){},shaka.util.Uint8ArrayUtils.toStandardBase64=function(e){return e=shaka.util.StringUtils.fromCharCode(shaka.util.BufferUtils.toUint8(e)),btoa(e)},shaka.util.Uint8ArrayUtils.toBase64=function(e,t){return t=null==t||t,e=shaka.util.Uint8ArrayUtils.toStandardBase64(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")},shaka.util.Uint8ArrayUtils.fromBase64=function(e){e=window.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t},shaka.util.Uint8ArrayUtils.fromHex=function(e){for(var t=e.length/2,r=new Uint8Array(t),n=0;n<t;n++)r[n]=window.parseInt(e.substr(2*n,2),16);return r},shaka.util.Uint8ArrayUtils.toHex=function(e){var t=shaka.util.BufferUtils.toUint8(e);e="";for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())1==(r=(r=r.value).toString(16)).length&&(r="0"+r),e+=r;return e},shaka.util.Uint8ArrayUtils.concat=function(){for(var e=$jscomp.getRestArguments.apply(0,arguments),t=shaka.util.BufferUtils,r=0,n=0;n<e.length;++n)r+=e[n].byteLength;r=new Uint8Array(r);for(var a=n=0;a<e.length;++a){var i=e[a];ArrayBuffer.isView(i)&&1===i.BYTES_PER_ELEMENT?r.set(i,n):r.set(t.toUint8(i),n),n+=i.byteLength}return r},goog.exportSymbol("shaka.util.Uint8ArrayUtils",shaka.util.Uint8ArrayUtils),goog.exportProperty(shaka.util.Uint8ArrayUtils,"concat",shaka.util.Uint8ArrayUtils.concat),goog.exportProperty(shaka.util.Uint8ArrayUtils,"toHex",shaka.util.Uint8ArrayUtils.toHex),goog.exportProperty(shaka.util.Uint8ArrayUtils,"fromHex",shaka.util.Uint8ArrayUtils.fromHex),goog.exportProperty(shaka.util.Uint8ArrayUtils,"fromBase64",shaka.util.Uint8ArrayUtils.fromBase64),goog.exportProperty(shaka.util.Uint8ArrayUtils,"toBase64",shaka.util.Uint8ArrayUtils.toBase64),goog.exportProperty(shaka.util.Uint8ArrayUtils,"toStandardBase64",shaka.util.Uint8ArrayUtils.toStandardBase64),shaka.util.ManifestParserUtils=function(){},shaka.util.ManifestParserUtils.resolveUris=function(e,t,r){if(r=void 0===r?"":r,0==t.length)return e;if(1==e.length&&1==t.length){var n=new goog.Uri(e[0]);return t=new goog.Uri(t[0]),t=n.resolve(t),r&&t.setQueryData(r),[t.toString()]}t=t.map((function(e){return new goog.Uri(e)})),n=[];for(var a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){a=new goog.Uri(a.value);for(var i=$jscomp.makeIterator(t),s=i.next();!s.done;s=i.next())s=a.resolve(s.value),r&&s.setQueryData(r),n.push(s.toString())}return n},shaka.util.ManifestParserUtils.createDrmInfo=function(e,t,r,n){return e={keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:r||[],keyIds:new Set},n&&(e.keySystemUris=new Set([n])),e},shaka.util.ManifestParserUtils.createDrmInfoFromClearKeys=function(e,t){t=void 0===t?"cenc":t;var r=shaka.util.StringUtils,n=shaka.util.Uint8ArrayUtils,a=[],i=[],s=[];e.forEach((function(e,t){var r=t;22!=r.length&&(r=n.toBase64(n.fromHex(t),!1));var o=e;22!=o.length&&(o=n.toBase64(n.fromHex(e),!1)),e={kty:"oct",kid:r,k:o},a.push(e),i.push(e.kid),s.push(t)})),e=JSON.stringify({keys:a});var o=JSON.stringify({kids:i});return r=[{initData:shaka.util.BufferUtils.toUint8(r.toUTF8(o)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:t,licenseServerUri:"data:application/json;base64,"+window.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:r,keyIds:new Set(s)}},shaka.util.ManifestParserUtils.guessCodecs=function(e,t){if(1==t.length)return t[0];if(null!=(e=shaka.util.ManifestParserUtils.guessCodecsSafe(e,t)))return e;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_COULD_NOT_GUESS_CODECS,t)},shaka.util.ManifestParserUtils.guessCodecsSafe=function(e,t){for(var r=shaka.util.ManifestParserUtils.CODEC_REGEXPS_BY_CONTENT_TYPE_.get(e),n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next()){n=n.value;for(var a=$jscomp.makeIterator(t),i=a.next();!i.done;i=a.next())if(i=i.value,n.test(i.trim()))return i.trim()}return e==shaka.util.ManifestParserUtils.ContentType.TEXT?"":null},shaka.util.ManifestParserUtils.guessAllCodecsSafe=function(e,t){var r=[];e=shaka.util.ManifestParserUtils.CODEC_REGEXPS_BY_CONTENT_TYPE_.get(e);for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;for(var a=$jscomp.makeIterator(t),i=a.next();!i.done;i=a.next())i=i.value,n.test(i.trim())&&r.push(i.trim())}return r},shaka.util.ManifestParserUtils.ContentType={VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image",APPLICATION:"application"},shaka.util.ManifestParserUtils.TextStreamKind={SUBTITLE:"subtitle",CLOSED_CAPTION:"caption"},shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS=1/15,shaka.util.ManifestParserUtils.VIDEO_CODEC_REGEXPS_=[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/],shaka.util.ManifestParserUtils.AUDIO_CODEC_REGEXPS_=[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4/,/^dts[cex]$/,/^iamf/,/^mhm[12]/,/^ac3$/,/^eac3$/],shaka.util.ManifestParserUtils.TEXT_CODEC_REGEXPS_=[/^vtt$/,/^wvtt/,/^stpp/],shaka.util.ManifestParserUtils.CODEC_REGEXPS_BY_CONTENT_TYPE_=(new Map).set("audio",shaka.util.ManifestParserUtils.AUDIO_CODEC_REGEXPS_).set("video",shaka.util.ManifestParserUtils.VIDEO_CODEC_REGEXPS_).set("text",shaka.util.ManifestParserUtils.TEXT_CODEC_REGEXPS_),shaka.lcevc={},shaka.lcevc.Dec=function(e,t,r,n){this.dec_=null,this.media_=e,this.canvas_=t,this.decConfig_=r,this.isDualTrack_=n,this.toBeDeprecated_=!1,this.create_()},shaka.lcevc.Dec.prototype.appendBuffer=function(e,t,r){r.type!==shaka.util.ManifestParserUtils.ContentType.VIDEO||this.isDualTrack_&&!r.baseOriginalId||this.dec_&&this.dec_.appendBuffer(e,"video",r.id,-t,!this.isDualTrack_)},shaka.lcevc.Dec.prototype.hideCanvas=function(){this.dec_&&this.canvas_.classList.add("shaka-hidden")},shaka.lcevc.Dec.prototype.create_=function(){this.isSupported_()&&!this.dec_&&this.lcevcLib_.SupportObject.webGLSupport(this.canvas_)&&(this.canvas_.classList.remove("shaka-hidden"),this.dec_=this.toBeDeprecated_?new this.lcevcLib_.LcevcDil(this.media_,this.canvas_,this.decConfig_):new this.lcevcLib_.LCEVCdec(this.media_,this.canvas_,this.decConfig_))},shaka.lcevc.Dec.prototype.release=function(){this.dec_&&(this.dec_.close(),this.dec_=null)},shaka.lcevc.Dec.prototype.isSupported_=function(){if("undefined"==typeof libDPIModule&&shaka.log.alwaysWarn("Could not find LCEVC Library dependencies on this page"),"undefined"!=typeof LCEVCdec)this.lcevcLib_=LCEVCdec;else{if("undefined"==typeof LcevcDil)return shaka.log.alwaysWarn("Could not find LCEVC Library on this page"),!1;this.lcevcLib_=LcevcDil,this.toBeDeprecated_=!0,shaka.Deprecate.deprecateFeature(5,"LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead")}return void 0===this.lcevcLib_.SupportObject?(shaka.log.alwaysWarn("Could not find LCEVC Library on this page"),!1):(this.lcevcLib_.SupportObject.SupportStatus||shaka.log.alwaysWarn(this.lcevcLib_.SupportObject.SupportError),void 0!==this.lcevcLib_&&"undefined"!=typeof libDPIModule&&this.canvas_ instanceof HTMLCanvasElement&&this.lcevcLib_.SupportObject.SupportStatus)},shaka.lcevc.Dec.prototype.updateVariant=function(e,t){if(e=e.video){e.dependencyStream&&(e=e.dependencyStream);var r=shaka.lcevc.Dec.ContainerFormat.MPEG2_TS,n=shaka.lcevc.Dec.StreamingFormat.OTHER;switch(e.mimeType){case"video/webm":r=shaka.lcevc.Dec.ContainerFormat.WEBM;break;case"video/mp4":r=shaka.lcevc.Dec.ContainerFormat.MP4}switch(t){case"DASH":n=shaka.lcevc.Dec.StreamingFormat.DASH;break;case"HLS":n=shaka.lcevc.Dec.StreamingFormat.HLS}this.dec_&&(this.dec_.setLevelSwitching(e.id,!0),this.dec_.setContainerFormat(r),this.toBeDeprecated_||this.dec_.setStreamingFormat(n))}},shaka.lcevc.Dec.isStreamSupported=function(e){return!(!e||"undefined"==typeof LCEVCdec)&&"lvc1"==e.codecs},goog.exportSymbol("shaka.lcevc.Dec",shaka.lcevc.Dec),goog.exportProperty(shaka.lcevc.Dec.prototype,"release",shaka.lcevc.Dec.prototype.release),shaka.lcevc.Dec.ContainerFormat={MPEG2_TS:0,WEBM:1,MP4:2},shaka.lcevc.Dec.StreamingFormat={HLS:0,DASH:1,OTHER:-1},shaka.media={},shaka.media.Capabilities=function(){},shaka.media.Capabilities.isTypeSupported=function(e){var t=shaka.media.Capabilities.MediaSourceTypeSupportMap;if(t.has(e))return t.get(e);var r=window.ManagedMediaSource||window.MediaSource;return!!r&&(r=r.isTypeSupported(e),t.set(e,r),r)},shaka.media.Capabilities.isChangeTypeSupported=function(){var e=window.ManagedSourceBuffer||window.SourceBuffer;return!!e&&!!e.prototype&&!!e.prototype.changeType},shaka.media.Capabilities.isInfiniteLiveStreamDurationSupported=function(){var e=window.ManagedMediaSource||window.MediaSource;return!(!e||!e.prototype)&&(!!e.prototype.setLiveSeekableRange&&!!e.prototype.clearLiveSeekableRange)},shaka.media.Capabilities.MediaSourceTypeSupportMap=new Map,shaka.cea={},shaka.cea.DummyCaptionDecoder=function(){},shaka.cea.DummyCaptionDecoder.prototype.extract=function(e,t){},shaka.cea.DummyCaptionDecoder.prototype.decode=function(){return[]},shaka.cea.DummyCaptionDecoder.prototype.clear=function(){},shaka.cea.DummyCaptionDecoder.prototype.getStreams=function(){return[]},shaka.cea.DummyCeaParser=function(){},shaka.cea.DummyCeaParser.prototype.init=function(e){},shaka.cea.DummyCeaParser.prototype.parse=function(e){return[]},shaka.media.IClosedCaptionParser=function(){},shaka.media.IClosedCaptionParser.prototype.init=function(e,t){},shaka.media.IClosedCaptionParser.prototype.parseFrom=function(e){},shaka.media.IClosedCaptionParser.prototype.reset=function(){},shaka.media.IClosedCaptionParser.prototype.getStreams=function(){},goog.exportSymbol("shaka.media.IClosedCaptionParser",shaka.media.IClosedCaptionParser),shaka.media.ClosedCaptionParser=function(e){this.ceaParser_=new shaka.cea.DummyCeaParser,(e=shaka.media.ClosedCaptionParser.findParser(e.toLowerCase()))&&(this.ceaParser_=e()),this.ceaDecoder_=new shaka.cea.DummyCaptionDecoder,(e=shaka.media.ClosedCaptionParser.findDecoder())&&(this.ceaDecoder_=e())},shaka.media.ClosedCaptionParser.prototype.init=function(e,t){t=void 0!==t&&t,shaka.log.debug("Passing new init segment to CEA parser"),t||this.reset(),this.ceaParser_.init(e)},shaka.media.ClosedCaptionParser.prototype.parseFrom=function(e){e=this.ceaParser_.parse(e);for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){t=t.value;var r=shaka.util.BufferUtils.toUint8(t.packet);0<r.length&&this.ceaDecoder_.extract(r,t.pts)}return this.ceaDecoder_.decode()},shaka.media.ClosedCaptionParser.prototype.reset=function(){this.ceaDecoder_.clear()},shaka.media.ClosedCaptionParser.prototype.getStreams=function(){return this.ceaDecoder_.getStreams()},shaka.media.ClosedCaptionParser.registerParser=function(e,t){shaka.media.ClosedCaptionParser.parserMap_.set(e,t)},shaka.media.ClosedCaptionParser.unregisterParser=function(e){shaka.media.ClosedCaptionParser.parserMap_.delete(e)},shaka.media.ClosedCaptionParser.findParser=function(e){return shaka.media.ClosedCaptionParser.parserMap_.get(e)},shaka.media.ClosedCaptionParser.registerDecoder=function(e){shaka.media.ClosedCaptionParser.decoderFactory_=e},shaka.media.ClosedCaptionParser.unregisterDecoder=function(){shaka.media.ClosedCaptionParser.decoderFactory_=null},shaka.media.ClosedCaptionParser.findDecoder=function(){return shaka.media.ClosedCaptionParser.decoderFactory_},goog.exportSymbol("shaka.media.ClosedCaptionParser",shaka.media.ClosedCaptionParser),goog.exportProperty(shaka.media.ClosedCaptionParser,"findDecoder",shaka.media.ClosedCaptionParser.findDecoder),goog.exportProperty(shaka.media.ClosedCaptionParser,"unregisterDecoder",shaka.media.ClosedCaptionParser.unregisterDecoder),goog.exportProperty(shaka.media.ClosedCaptionParser,"registerDecoder",shaka.media.ClosedCaptionParser.registerDecoder),goog.exportProperty(shaka.media.ClosedCaptionParser,"findParser",shaka.media.ClosedCaptionParser.findParser),goog.exportProperty(shaka.media.ClosedCaptionParser,"unregisterParser",shaka.media.ClosedCaptionParser.unregisterParser),goog.exportProperty(shaka.media.ClosedCaptionParser,"registerParser",shaka.media.ClosedCaptionParser.registerParser),shaka.media.ClosedCaptionParser.parserMap_=new Map,shaka.media.ClosedCaptionParser.decoderFactory_=null,shaka.text={},shaka.text.CueRegion=function(){var e=shaka.text.CueRegion;this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=e.units.PERCENTAGE,this.scroll=e.scrollMode.NONE},goog.exportSymbol("shaka.text.CueRegion",shaka.text.CueRegion),shaka.text.CueRegion.units={PX:0,PERCENTAGE:1,LINES:2},goog.exportProperty(shaka.text.CueRegion,"units",shaka.text.CueRegion.units),shaka.text.CueRegion.scrollMode={NONE:"",UP:"up"},goog.exportProperty(shaka.text.CueRegion,"scrollMode",shaka.text.CueRegion.scrollMode),shaka.util.ArrayUtils=function(){},shaka.util.ArrayUtils.defaultEquals=function(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t},shaka.util.ArrayUtils.remove=function(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)},shaka.util.ArrayUtils.count=function(e,t){for(var r=0,n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())r+=t(n.value)?1:0;return r},shaka.util.ArrayUtils.hasSameElements=function(e,t,r){if(r||(r=shaka.util.ArrayUtils.defaultEquals),e.length!=t.length)return!1;t=t.slice();for(var n=(e=$jscomp.makeIterator(e)).next(),a={};!n.done;a={item$jscomp$29:void 0},n=e.next()){if(a.item$jscomp$29=n.value,-1==(n=t.findIndex(function(e){return function(t){return r(e.item$jscomp$29,t)}}(a))))return!1;t[n]=t[t.length-1],t.pop()}return 0==t.length},shaka.util.ArrayUtils.equal=function(e,t,r){if(e===t)return!0;if(!e||!t)return e==t;if(r||(r=shaka.util.ArrayUtils.defaultEquals),e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0},shaka.util.TextParser=function(e){this.data_=e||"",this.position_=0},shaka.util.TextParser.prototype.atEnd=function(){return this.position_==this.data_.length},shaka.util.TextParser.prototype.readLine=function(){return this.readRegexReturnCapture_(/(.*?)(\n|$)/gm,1)},shaka.util.TextParser.prototype.readWord=function(){return this.readRegexReturnCapture_(/[^ \t\n]*/gm,0)},shaka.util.TextParser.prototype.skipWhitespace=function(){this.readRegex(/[ \t]+/gm)},shaka.util.TextParser.prototype.readRegex=function(e){return e=this.indexOf_(e),this.atEnd()||null==e||e.position!=this.position_?null:(this.position_+=e.length,e.results)},shaka.util.TextParser.prototype.readRegexReturnCapture_=function(e,t){return this.atEnd()?null:(e=this.readRegex(e))?e[t]:null},shaka.util.TextParser.prototype.indexOf_=function(e){return goog.asserts.assert(e.global,"global flag should be set"),e.lastIndex=this.position_,null==(e=e.exec(this.data_))?null:{position:e.index,length:e[0].length,results:e}},shaka.util.TextParser.prototype.parseTime=function(){var e=this.readRegex(shaka.util.TextParser.timeFormat_);if(null==e)return null;var t=Number(e[2]),r=Number(e[3]);return 59<t||59<r?null:(Number(e[6])||0)/1e3+r+60*t+3600*(Number(e[1])||0)},shaka.util.TextParser.parseTime=function(e){return e?new shaka.util.TextParser(e).parseTime():null},shaka.util.TextParser.timeFormat_=/(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g,shaka.util.ObjectUtils=function(){},shaka.util.ObjectUtils.cloneObject=function(e){var t=new WeakSet,r=function(e){switch(typeof e){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return e;default:if(!e||ArrayBuffer.isView(e))return e;if(t.has(e))return null;var n=e.constructor==Array;if(e.constructor!=Object&&!n)return null;t.add(e);var a,i=n?[]:{};for(a in e)i[a]=r(e[a]);return n&&(i.length=e.length),i}};return r(e)},shaka.util.ObjectUtils.shallowCloneObject=function(e){var t,r={};for(t in e)r[t]=e[t];return r},shaka.util.ObjectUtils.alphabeticalKeyOrderStringify=function(e){return Array.isArray(e)?shaka.util.ObjectUtils.arrayStringify_(e):"function"==typeof e?"":e instanceof Object?shaka.util.ObjectUtils.objectStringify_(e):JSON.stringify(e)},shaka.util.ObjectUtils.objectStringify_=function(e){var t=Object.keys(e);t.sort();for(var r=[],n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next()){var a=n.value;n=JSON.stringify(a),void 0!==(a=e[a])&&(a=shaka.util.ObjectUtils.alphabeticalKeyOrderStringify(a))&&r.push(n+":"+a)}return"{"+r.join(",")+"}"},shaka.util.ObjectUtils.arrayStringify_=function(e){for(var t=[],r=0;r<e.length;r++){var n=r.toString(),a=e[r];void 0!==a&&(a=shaka.util.ObjectUtils.alphabeticalKeyOrderStringify(a))&&t.push(n+":"+a)}return"["+t.join(",")+"]"},shaka.util.TXml=function(){},shaka.util.TXml.parseXml=function(e,t,r){return r=void 0!==r&&r,e=shaka.util.StringUtils.fromBytesAutoDetect(e),shaka.util.TXml.parseXmlString(e,t,r)},shaka.util.TXml.parseXmlString=function(e,t,r){return e=shaka.util.TXml.parse(e,void 0!==r&&r),!t&&e.length?e[0]:(e=e.find((function(e){return t.split(",").includes(e.tagName)})))?e:(shaka.log.error("parseXml root element not found!"),null)},shaka.util.TXml.getKnownNameSpace=function(e){return shaka.util.TXml.uriToNameSpace_.has(e)?shaka.util.TXml.uriToNameSpace_.get(e):""},shaka.util.TXml.getKnownSchema=function(e){return shaka.util.TXml.nameSpaceToUri_.has(e)?shaka.util.TXml.nameSpaceToUri_.get(e):""},shaka.util.TXml.setKnownNameSpace=function(e,t){shaka.util.TXml.uriToNameSpace_.set(e,t),shaka.util.TXml.nameSpaceToUri_.set(t,e)},shaka.util.TXml.parse=function(e,t){function r(){for(var t=n;-1==="\r\n\t>/= ".indexOf(e[n])&&e[n];)n++;return e.slice(t,n)}var n=0;return function a(i,s){s=void 0!==s&&s;for(var o=[];e[n];)if(60==e.charCodeAt(n)){if(47===e.charCodeAt(n+1)){s=n+2,n=e.indexOf(">",n);var l=(s=e.substring(s,n)).indexOf(i);if(-1==l){var u=i.indexOf(".");0<u&&(i=i.substring(0,u),l=s.indexOf(i))}if(-1==l)throw o=e.substring(0,n).split("\n"),Error("Unexpected close tag\nLine: "+(o.length-1)+"\nColumn: "+(o[o.length-1].length+1)+"\nChar: "+e[n]);n+1&&(n+=1);break}if(33===e.charCodeAt(n+1)){if(45==e.charCodeAt(n+2)){for(;-1!==n&&(62!==e.charCodeAt(n)||45!=e.charCodeAt(n-1)||45!=e.charCodeAt(n-2)||-1==n);)n=e.indexOf(">",n+1);-1===n&&(n=e.length)}else if(91===e.charCodeAt(n+2)&&91===e.charCodeAt(n+8)&&"cdata"===e.substr(n+3,5).toLowerCase()){-1==(l=e.indexOf("]]>",n))?(o.push(e.substr(n+9)),n=e.length):(o.push(e.substring(n+9,l)),n=l+3);continue}n++;continue}e:{u=s,n++;var c=r(),d={};for(l=[];62!==e.charCodeAt(n)&&e[n];){var p=e.charCodeAt(n);if(64<p&&91>p||96<p&&123>p){p=r();for(var h=e.charCodeAt(n);h&&39!==h&&34!==h&&!(64<h&&91>h||96<h&&123>h)&&62!==h;)n++,h=e.charCodeAt(n);var f=n+1;if(n=e.indexOf(e[n],f),f=e.slice(f,n),39===h||34===h){if(-1===n){if(u={tagName:c,attributes:d,children:l,parent:null},t)for(c=0;c<l.length;c++)"string"!=typeof l[c]&&(l[c].parent=u);l=u;break e}}else f=null,n--;p.startsWith("xmlns:")&&(h=p.split(":"),shaka.util.TXml.setKnownNameSpace(f,h[1])),"tt"===c&&"xml:space"===p&&"preserve"===f&&(u=!0),d[p]=f}n++}for(47!==e.charCodeAt(n-1)?(n++,l=a(c,u)):n++,u={tagName:c,attributes:d,children:l,parent:null},c=l.length,d=0;d<c;d++)"string"!=typeof(p=l[d])?t&&(p.parent=u):d==c-1&&"\n"==p&&l.pop();l=u}if(o.push(l),"string"==typeof l)break;"?"===l.tagName[0]&&l.children&&(o.push.apply(o,$jscomp.arrayFromIterable(l.children)),l.children=[])}else l=n,-2===(n=e.indexOf("<",n)-1)&&(n=e.length),l=e.slice(l,n+1),s?0<l.length&&o.push(l):(o.length&&1==l.length&&"\n"==l[0]||0<l.trim().length)&&o.push(l),n++;return o}("")},shaka.util.TXml.isNode=function(e){return!!e.tagName},shaka.util.TXml.isText=function(e){return"string"==typeof e},shaka.util.TXml.getChildNodes=function(e){var t=[];if(!e.children)return[];for(var r=(e=$jscomp.makeIterator(e.children)).next();!r.done;r=e.next())"string"!=typeof(r=r.value)&&t.push(r);return t},shaka.util.TXml.findChildren=function(e,t){var r=[];if(!e.children)return[];for(var n=(e=$jscomp.makeIterator(e.children)).next();!n.done;n=e.next())(n=n.value).tagName===t&&r.push(n);return r},shaka.util.TXml.getTextContents=function(e){var t=shaka.util.StringUtils;return"string"==typeof e?t.htmlUnescape(e):""===(e=e.children.reduce((function(e,t){return"string"==typeof t?e+t:e}),""))?null:t.htmlUnescape(e)},shaka.util.TXml.getContents=function(e){return Array.from(e.children).every((function(e){return"string"==typeof e}))?((e=shaka.util.TXml.getTextContents(e))&&(e=e.trim()),e):null},shaka.util.TXml.getElementsByTagName=function(e,t,r){if(r=void 0===r?[]:r,e.tagName===t&&r.push(e),e.children)for(var n=(e=$jscomp.makeIterator(e.children)).next();!n.done;n=e.next())shaka.util.TXml.getElementsByTagName(n.value,t,r);return r},shaka.util.TXml.findChild=function(e,t){return 1!=(e=shaka.util.TXml.findChildren(e,t)).length?null:e[0]},shaka.util.TXml.findChildNS=function(e,t,r){return 1!=(e=shaka.util.TXml.findChildrenNS(e,t,r)).length?null:e[0]},shaka.util.TXml.parseAttr=function(e,t,r,n){n=void 0===n?null:n;var a=null;return null!=(e=e.attributes[t])&&(a=r(e)),null==a?n:a},shaka.util.TXml.getAttributeNS=function(e,t,r){return t=shaka.util.TXml.getKnownNameSpace(t),e.attributes[t+":"+r]||null},shaka.util.TXml.findChildrenNS=function(e,t,r){var n=shaka.util.TXml.getKnownNameSpace(t);if(t=[],e.children)for(r=n?n+":"+r:r,n=(e=$jscomp.makeIterator(e.children)).next();!n.done;n=e.next())(n=n.value)&&n.tagName===r&&t.push(n);return t},shaka.util.TXml.getAttributeNSList=function(e,t,r){for(var n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next())if(n=shaka.util.TXml.getAttributeNS(e,n.value,r))return n;return null},shaka.util.TXml.parseDate=function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null},shaka.util.TXml.parseDuration=function(e){if(!e)return null;var t=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$","i").exec(e);return t?(e=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(e)?e:null):(shaka.log.warning("Invalid duration string:",e),null)},shaka.util.TXml.parseRange=function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},shaka.util.TXml.parseInt=function(e){return 0==(e=Number(e))%1?e:null},shaka.util.TXml.parsePositiveInt=function(e){return 0==(e=Number(e))%1&&0<e?e:null},shaka.util.TXml.parseNonNegativeInt=function(e){return 0==(e=Number(e))%1&&0<=e?e:null},shaka.util.TXml.parseFloat=function(e){return e=Number(e),isNaN(e)?null:e},shaka.util.TXml.parseBoolean=function(e){return!!e&&"true"===e.toLowerCase()},shaka.util.TXml.evalDivision=function(e){var t,r=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(r)?null:r},shaka.util.TXml.parseXpath=function(e){var t=[];e=shaka.util.StringUtils.htmlUnescape(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/);for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var n=(r=r.value).match(/^([\w]+)/);if(n){var a=r.match(/(@id='(.*?)')/),i=r.match(/(@t='(\d+)')/),s=r.match(/(@n='(\d+)')/),o=r.match(/\[(\d+)\]/);t.push({name:n[0],id:a?a[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null,t:i?Number(i[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,n:s?Number(s[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,position:o?Number(o[1])-1:null,attribute:r.split("/@")[1]||null})}else r.startsWith("@")&&t.length&&(t[t.length-1].attribute=r.slice(1))}return t},shaka.util.TXml.modifyNodes=function(e,t){var r=shaka.util.TXml,n=r.parseXpath(t.attributes.sel||"");if(n.length){var a=n[n.length-1],i=t.attributes.pos||null;null==(n=a.position)&&(null!==a.t&&(n=r.nodePositionByAttribute_(e,"t",a.t)),null!==a.n&&(n=r.nodePositionByAttribute_(e,"n",a.n))),null===n?n="prepend"===i?0:e.length:"prepend"===i?--n:"after"===i&&++n,i=t.tagName,(a=a.attribute)&&e[n]?r.modifyNodeAttribute(e[n],i,a,r.getContents(t)||""):("remove"!==i&&"replace"!==i||e.splice(n,1),"add"!==i&&"replace"!==i||e.splice.apply(e,[n,0].concat($jscomp.arrayFromIterable(t.children))))}},shaka.util.TXml.nodePositionByAttribute_=function(e,t,r){for(var n=0,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){if(Number(a.value.attributes[t])===r)return n;n++}return null},shaka.util.TXml.modifyNodeAttribute=function(e,t,r,n){"remove"===t?delete e.attributes[r]:"add"!==t&&"replace"!==t||(e.attributes[r]=n)},shaka.util.TXml.txmlNodeToDomElement=function(e){var t=shaka.util.TXml,r="",n=e.tagName.split(":");for(var a in 0<n.length&&(r=t.getKnownSchema(n[0])),r=document.createElementNS(r,e.tagName),e.attributes)r.setAttribute(a,e.attributes[a]);for(a=(e=$jscomp.makeIterator(e.children)).next();!a.done;a=e.next())a="string"==typeof(a=a.value)?new Text(a):t.txmlNodeToDomElement(a),r.appendChild(a);return r},shaka.util.TXml.cloneNode=function(e){if(!e)return null;for(var t={tagName:e.tagName,attributes:shaka.util.ObjectUtils.shallowCloneObject(e.attributes),children:[],parent:null},r=(e=$jscomp.makeIterator(e.children)).next();!r.done;r=e.next())"string"==typeof(r=r.value)||((r=shaka.util.TXml.cloneNode(r)).parent=t),t.children.push(r);return t},shaka.util.TXml.uriToNameSpace_=new Map,shaka.util.TXml.nameSpaceToUri_=new Map,shaka.text.Cue=function(e,t,r){var n=shaka.text.Cue;this.startTime=e,this.endTime=t,this.payload=r,this.region=new shaka.text.CueRegion,this.position=null,this.positionAlign=n.positionAlign.AUTO,this.size=0,this.textAlign=n.textAlign.CENTER,this.direction=n.direction.HORIZONTAL_LEFT_TO_RIGHT,this.writingMode=n.writingMode.HORIZONTAL_TOP_TO_BOTTOM,this.lineInterpretation=n.lineInterpretation.LINE_NUMBER,this.line=null,this.lineHeight="",this.lineAlign=n.lineAlign.START,this.displayAlign=n.displayAlign.AFTER,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=n.fontWeight.NORMAL,this.fontStyle=n.fontStyle.NORMAL,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={columns:32,rows:15}},shaka.text.Cue.lineBreak=function(e,t){return(e=new shaka.text.Cue(e,t,"")).lineBreak=!0,e},shaka.text.Cue.prototype.clone=function(){var e,t=new shaka.text.Cue(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t},shaka.text.Cue.equal=function(e,t){if(e.payload!=t.payload||!(.001>Math.abs(e.startTime-t.startTime)&&.001>Math.abs(e.endTime-t.endTime)))return!1;for(var r in e)if("startTime"!=r&&"endTime"!=r&&"payload"!=r)if("nestedCues"==r){if(!shaka.util.ArrayUtils.equal(e.nestedCues,t.nestedCues,shaka.text.Cue.equal))return!1}else if("region"==r||"cellResolution"==r){for(var n in e[r])if(e[r][n]!=t[r][n])return!1}else if(Array.isArray(e[r])){if(!shaka.util.ArrayUtils.equal(e[r],t[r]))return!1}else if(e[r]!=t[r])return!1;return!0},shaka.text.Cue.parseCuePayload=function(e,t){t=void 0===t?new Map:t;var r=shaka.util.StringUtils,n=shaka.util.TXml,a=e.payload;if(a.includes("<")){0===t.size&&shaka.text.Cue.addDefaultTextColor(t),a=shaka.text.Cue.replaceKaraokeStylePayload_(a),a=shaka.text.Cue.replaceVoiceStylePayload_(a),a=shaka.text.Cue.escapeInvalidChevrons_(a),e.payload="";try{var i=n.parseXmlString("<span>"+a+"</span>","span")}catch(e){shaka.log.warning("cue parse fail: ",e)}if(i)if(1!=(i=i.children).length||n.isNode(i[0]))for(n=(r=$jscomp.makeIterator(i)).next();!n.done;n=r.next())shaka.text.Cue.generateCueFromElement_(n.value,e,t);else e.payload=r.htmlUnescape(a);else shaka.log.warning("The cue's markup could not be parsed: ",a),e.payload=r.htmlUnescape(a)}else e.payload=r.htmlUnescape(a)},shaka.text.Cue.addDefaultTextColor=function(e){for(var t=$jscomp.makeIterator(Object.entries(shaka.text.Cue.defaultTextColor)),r=t.next();!r.done;r=t.next()){var n=$jscomp.makeIterator(r.value);r=n.next().value,n=n.next().value;var a=new shaka.text.Cue(0,0,"");a.color=n,e.set("."+r,a)}for(r=(t=$jscomp.makeIterator(Object.entries(shaka.text.Cue.defaultTextBackgroundColor))).next();!r.done;r=t.next())r=(n=$jscomp.makeIterator(r.value)).next().value,n=n.next().value,(a=new shaka.text.Cue(0,0,"")).backgroundColor=n,e.set("."+r,a)},shaka.text.Cue.replaceKaraokeStylePayload_=function(e){for(var t=[],r=-1,n=0;n<e.length;n++)"<"===e[n]?r=n+1:">"===e[n]&&0<r&&((r=e.substr(r,n-r)).match(shaka.text.Cue.timeFormat_)&&t.push(r),r=-1);for(n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next())n=n.value,e=e.replace("<"+n+">",'<div time="'+n+'">'),e+="</div>";return e},shaka.text.Cue.replaceVoiceStylePayload_=function(e){for(var t=[],r=-1,n="",a=!1,i=0;i<e.length;i++)if("/"===e[i]){var s=e.indexOf(">",i);if(-1===s)return e;if((s=e.substring(i+1,s))&&"v"==s){a=!0;var o=null;if(t.length&&(o=t[t.length-1]),o){if(o===s)n+="/"+s+">";else{if(!o.startsWith("v")){n+=e[i];continue}n+="/"+o+">"}i+=s.length+1}else n+=e[i]}else n+=e[i]}else"<"===e[i]?"v"!=e[r=i+1]&&(r=-1):">"===e[i]&&0<r&&(t.push(e.substr(r,i-r)),r=-1),n+=e[i];for(t=(e=$jscomp.makeIterator(t)).next();!t.done;t=e.next())r=(t=t.value).replace(" ",".voice-"),n=(n=n.replace("<"+t+">","<"+r+">")).replace("</"+t+">","</"+r+">"),a||(n+="</"+r+">");return n},shaka.text.Cue.escapeInvalidChevrons_=function(e){var t={"< ":""," >":" &gt;"},r=/(< +>|<\s|\s>)/g,n=RegExp(r.source);return e&&n.test(e)?e.replace(r,(function(e){return t[e]||""})):e||""},shaka.text.Cue.generateCueFromElement_=function(e,t,r){var n=shaka.util.TXml,a=t.clone();if(a.nestedCues=[],a.payload="",a.rubyTag="",a.line=null,a.region=new shaka.text.CueRegion,a.position=null,a.size=0,a.textAlign=shaka.text.Cue.textAlign.CENTER,n.isNode(e))for(var i=shaka.text.Cue.fontWeight.BOLD,s=shaka.text.Cue.fontStyle.ITALIC,o=shaka.text.Cue.textDecoration.UNDERLINE,l=e.tagName.split(/(?=[ .])+/g),u=(l=$jscomp.makeIterator(l)).next();!u.done;u=l.next()){var c=u=u.value;if(c.startsWith(".voice-")){var d=c.split("-").pop();c='v[voice="'+d+'"]',r.has(c)||(c="v[voice="+d+"]")}switch(r.has(c)&&shaka.text.Cue.mergeStyle_(a,r.get(c)),u){case"br":return a=shaka.text.Cue.lineBreak(a.startTime,a.endTime),void t.nestedCues.push(a);case"b":a.fontWeight=i;break;case"i":a.fontStyle=s;break;case"u":a.textDecoration.push(o);break;case"font":(u=e.attributes.color)&&(a.color=u);break;case"div":if(!(u=e.attributes.time))break;(u=shaka.util.TextParser.parseTime(u))&&(a.startTime=u);break;case"ruby":case"rp":case"rt":a.rubyTag=u}}if(i=e.children,n.isText(e)||1==i.length&&n.isText(i[0]))for(r=n.getTextContents(e).split("\n"),e=!0,n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next())n=n.value,e||(e=shaka.text.Cue.lineBreak(a.startTime,a.endTime),t.nestedCues.push(e)),0<n.length&&((e=a.clone()).payload=shaka.util.StringUtils.htmlUnescape(n),t.nestedCues.push(e)),e=!1;else for(t.nestedCues.push(a),e=(t=$jscomp.makeIterator(i)).next();!e.done;e=t.next())shaka.text.Cue.generateCueFromElement_(e.value,a,r)},shaka.text.Cue.mergeStyle_=function(e,t){t&&(e.backgroundColor=shaka.text.Cue.getOrDefault_(t.backgroundColor,e.backgroundColor),e.color=shaka.text.Cue.getOrDefault_(t.color,e.color),e.fontFamily=shaka.text.Cue.getOrDefault_(t.fontFamily,e.fontFamily),e.fontSize=shaka.text.Cue.getOrDefault_(t.fontSize,e.fontSize),e.textShadow=shaka.text.Cue.getOrDefault_(t.textShadow,e.textShadow),e.fontWeight=t.fontWeight,e.fontStyle=t.fontStyle,e.opacity=t.opacity,e.rubyTag=t.rubyTag,e.textCombineUpright=t.textCombineUpright,e.wrapLine=t.wrapLine)},shaka.text.Cue.getOrDefault_=function(e,t){return e&&0<e.length?e:t},goog.exportSymbol("shaka.text.Cue",shaka.text.Cue),goog.exportProperty(shaka.text.Cue,"parseCuePayload",shaka.text.Cue.parseCuePayload),goog.exportProperty(shaka.text.Cue,"equal",shaka.text.Cue.equal),goog.exportProperty(shaka.text.Cue.prototype,"clone",shaka.text.Cue.prototype.clone),shaka.text.Cue.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:"auto"},goog.exportProperty(shaka.text.Cue,"positionAlign",shaka.text.Cue.positionAlign),shaka.text.Cue.textAlign={LEFT:"left",RIGHT:"right",CENTER:"center",START:"start",END:"end"},goog.exportProperty(shaka.text.Cue,"textAlign",shaka.text.Cue.textAlign),shaka.text.Cue.displayAlign={BEFORE:"before",CENTER:"center",AFTER:"after"},goog.exportProperty(shaka.text.Cue,"displayAlign",shaka.text.Cue.displayAlign),shaka.text.Cue.direction={HORIZONTAL_LEFT_TO_RIGHT:"ltr",HORIZONTAL_RIGHT_TO_LEFT:"rtl"},goog.exportProperty(shaka.text.Cue,"direction",shaka.text.Cue.direction),shaka.text.Cue.writingMode={HORIZONTAL_TOP_TO_BOTTOM:"horizontal-tb",VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"},goog.exportProperty(shaka.text.Cue,"writingMode",shaka.text.Cue.writingMode),shaka.text.Cue.lineInterpretation={LINE_NUMBER:0,PERCENTAGE:1},goog.exportProperty(shaka.text.Cue,"lineInterpretation",shaka.text.Cue.lineInterpretation),shaka.text.Cue.lineAlign={CENTER:"center",START:"start",END:"end"},goog.exportProperty(shaka.text.Cue,"lineAlign",shaka.text.Cue.lineAlign),shaka.text.Cue.defaultTextColor={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"},goog.exportProperty(shaka.text.Cue,"defaultTextColor",shaka.text.Cue.defaultTextColor),shaka.text.Cue.defaultTextBackgroundColor={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"},goog.exportProperty(shaka.text.Cue,"defaultTextBackgroundColor",shaka.text.Cue.defaultTextBackgroundColor),shaka.text.Cue.fontWeight={NORMAL:400,BOLD:700},goog.exportProperty(shaka.text.Cue,"fontWeight",shaka.text.Cue.fontWeight),shaka.text.Cue.fontStyle={NORMAL:"normal",ITALIC:"italic",OBLIQUE:"oblique"},goog.exportProperty(shaka.text.Cue,"fontStyle",shaka.text.Cue.fontStyle),shaka.text.Cue.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},goog.exportProperty(shaka.text.Cue,"textDecoration",shaka.text.Cue.textDecoration),shaka.text.Cue.timeFormat_=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g,shaka.util.IDestroyable=function(){},shaka.util.IDestroyable.prototype.destroy=function(){},shaka.transmuxer={},shaka.transmuxer.TransmuxerEngine=function(){},shaka.transmuxer.TransmuxerEngine.prototype.destroy=function(){},shaka.transmuxer.TransmuxerEngine.registerTransmuxer=function(e,t,r){var n=shaka.transmuxer.TransmuxerEngine;e=n.normalizeMimeType_(e),n.transmuxerMap_.set(e+"-"+r,{priority:r,plugin:t})},shaka.transmuxer.TransmuxerEngine.unregisterTransmuxer=function(e,t){var r=shaka.transmuxer.TransmuxerEngine;e=r.normalizeMimeType_(e),r.transmuxerMap_.delete(e+"-"+t)},shaka.transmuxer.TransmuxerEngine.findTransmuxer=function(e,t){for(var r=shaka.transmuxer.TransmuxerEngine,n=r.normalizeMimeType_(e),a=$jscomp.makeIterator([r.PluginPriority.APPLICATION,r.PluginPriority.PREFERRED,r.PluginPriority.PREFERRED_SECONDARY,r.PluginPriority.FALLBACK]),i=a.next();!i.done;i=a.next())if(i=r.transmuxerMap_.get(n+"-"+i.value)){var s=i.plugin(),o=s.isSupported(e,t);if(s.destroy(),o)return i.plugin}return null},shaka.transmuxer.TransmuxerEngine.normalizeMimeType_=function(e){return e.toLowerCase().split(";")[0]},shaka.transmuxer.TransmuxerEngine.isSupported=function(e,t){return!!shaka.transmuxer.TransmuxerEngine.findTransmuxer(e)},shaka.transmuxer.TransmuxerEngine.convertCodecs=function(e,t){var r=shaka.transmuxer.TransmuxerEngine.findTransmuxer(t);return r?(e=(r=r()).convertCodecs(e,t),r.destroy(),e):t},goog.exportSymbol("shaka.transmuxer.TransmuxerEngine",shaka.transmuxer.TransmuxerEngine),goog.exportProperty(shaka.transmuxer.TransmuxerEngine,"findTransmuxer",shaka.transmuxer.TransmuxerEngine.findTransmuxer),goog.exportProperty(shaka.transmuxer.TransmuxerEngine,"unregisterTransmuxer",shaka.transmuxer.TransmuxerEngine.unregisterTransmuxer),goog.exportProperty(shaka.transmuxer.TransmuxerEngine,"registerTransmuxer",shaka.transmuxer.TransmuxerEngine.registerTransmuxer),goog.exportProperty(shaka.transmuxer.TransmuxerEngine.prototype,"destroy",shaka.transmuxer.TransmuxerEngine.prototype.destroy),shaka.transmuxer.TransmuxerEngine.transmuxerMap_=new Map,shaka.transmuxer.TransmuxerEngine.PluginPriority={FALLBACK:1,PREFERRED_SECONDARY:2,PREFERRED:3,APPLICATION:4},goog.exportProperty(shaka.transmuxer.TransmuxerEngine,"PluginPriority",shaka.transmuxer.TransmuxerEngine.PluginPriority),shaka.util.MimeUtils=function(){},shaka.util.MimeUtils.getFullType=function(e,t){var r=e;return t&&!shaka.util.MimeUtils.RAW_FORMATS.includes(e)&&(r+='; codecs="'+t+'"'),r},shaka.util.MimeUtils.getFullTypeWithAllCodecs=function(e,t){return t&&(e+='; codecs="'+t+'"'),e},shaka.util.MimeUtils.getFullOrConvertedType=function(e,t,r){var n=shaka.util.MimeUtils,a=n.getFullType(e,t);t=n.getFullTypeWithAllCodecs(e,t),n=shaka.util.ManifestParserUtils.ContentType;var i=shaka.transmuxer.TransmuxerEngine;return i.isSupported(t,r)?i.convertCodecs(r,t):"video/mp2t"!=e&&r==n.AUDIO?a.replace("video","audio"):a},shaka.util.MimeUtils.getExtendedType=function(e,t,r){var n=[t];return shaka.util.MimeUtils.EXTENDED_MIME_PARAMETERS_.forEach((function(t,a){var i=e[a];"codecs"==a?shaka.util.MimeUtils.RAW_FORMATS.includes(e.mimeType)||n.push('codecs="'+r+'"'):i&&n.push(t+'="'+i+'"')})),"PQ"==e.hdr&&n.push('eotf="smpte2084"'),n.join(";")},shaka.util.MimeUtils.getContainerType=function(e){return e.split(";")[0].split("/")[1]},shaka.util.MimeUtils.splitCodecs=function(e){return e.split(",")},shaka.util.MimeUtils.getNormalizedCodec=function(e){var t=shaka.util.MimeUtils.getCodecParts_(e);switch(e=t[0].toLowerCase(),t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:case"mp4a"===e&&"40.34"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:case"ac3"===e:case"ac-3"===e:return"ac-3";case"mp4a"===e&&"a6"===t:case"eac3"===e:case"ec-3"===e:return"ec-3";case"ac-4"===e:return"ac-4";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"vp09"===e:case"vp9"===e:return"vp9";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"vvc1"===e:case"vvi1"===e:return"vvc";case"dvh1"===e:case"dvhe"===e:return t&&t.startsWith("05")?"dovi-p5":"dovi-hevc";case"dvav"===e:case"dva1"===e:return"dovi-avc";case"dav1"===e:return"dovi-av1";case"dvc1"===e:case"dvi1"===e:return"dovi-vvc"}return e},shaka.util.MimeUtils.getCodecBase=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e.split(","))).next();!r.done;r=e.next())r=shaka.util.MimeUtils.getCodecParts_(r.value),t.push(r[0]);return t.sort().join(",")},shaka.util.MimeUtils.getBasicType=function(e){return e.split(";")[0]},shaka.util.MimeUtils.getCodecs=function(e){return(e=e.split(/ *; */)).shift(),(e=e.find((function(e){return e.startsWith("codecs=")})))?e.split("=")[1].replace(/^"|"$/g,""):""},shaka.util.MimeUtils.isHlsType=function(e){return"application/x-mpegurl"===e||"application/vnd.apple.mpegurl"===e},shaka.util.MimeUtils.isDashType=function(e){return"application/dash+xml"===e||"video/vnd.mpeg.dash.mpd"===e},shaka.util.MimeUtils.getCodecParts_=function(e){var t=e.split(".");return e=t[0],t.shift(),[e,t=t.join(".")]},goog.exportSymbol("shaka.util.MimeUtils",shaka.util.MimeUtils),goog.exportProperty(shaka.util.MimeUtils,"getFullTypeWithAllCodecs",shaka.util.MimeUtils.getFullTypeWithAllCodecs),goog.exportProperty(shaka.util.MimeUtils,"getFullType",shaka.util.MimeUtils.getFullType),shaka.util.MimeUtils.EXTENDED_MIME_PARAMETERS_=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE="application/cea-608",shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE="application/cea-708",shaka.util.MimeUtils.RAW_FORMATS=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],shaka.text.TextEngine=function(e){this.parser_=null,this.displayer_=e,this.segmentRelativeVttTiming_=!1,this.appendWindowStart_=this.timestampOffset_=0,this.appendWindowEnd_=1/0,this.bufferEnd_=this.bufferStart_=null,this.selectedClosedCaptionId_="",this.modifyCueCallback_=function(e,t){},this.closedCaptionsMap_=new Map},shaka.text.TextEngine.registerParser=function(e,t){shaka.text.TextEngine.parserMap_.set(e,t)},shaka.text.TextEngine.unregisterParser=function(e){shaka.text.TextEngine.parserMap_.delete(e)},shaka.text.TextEngine.findParser=function(e){return shaka.text.TextEngine.parserMap_.get(e)},shaka.text.TextEngine.isTypeSupported=function(e){return!!shaka.text.TextEngine.parserMap_.has(e)||(e==shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE||e==shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE)&&!!shaka.media.ClosedCaptionParser.findDecoder()},shaka.text.TextEngine.prototype.destroy=function(){return this.displayer_=this.parser_=null,this.closedCaptionsMap_.clear(),Promise.resolve()},shaka.text.TextEngine.prototype.setDisplayer=function(e){this.displayer_=e},shaka.text.TextEngine.prototype.initParser=function(e,t,r,n){e==shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE||e==shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE?this.parser_=null:(e=shaka.text.TextEngine.parserMap_.get(e),goog.asserts.assert(e,"Text type negotiation should have happened already"),this.parser_=e(),this.parser_.setSequenceMode?this.parser_.setSequenceMode(t):shaka.Deprecate.deprecateFeature(5,"Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),this.parser_.setManifestType?this.parser_.setManifestType(n):shaka.Deprecate.deprecateFeature(5,"Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),this.segmentRelativeVttTiming_=r)},shaka.text.TextEngine.prototype.setModifyCueCallback=function(e){this.modifyCueCallback_=e},shaka.text.TextEngine.prototype.appendBuffer=function(e,t,r,n){var a,i,s,o,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress)return goog.asserts.assert(d.parser_,"The parser should already be initialized"),p.yield(Promise.resolve(),2);if(!d.parser_||!d.displayer_)return p.return();if(null==t||null==r)return d.parser_.parseInit(shaka.util.BufferUtils.toUint8(e)),p.return();for(a=d.segmentRelativeVttTiming_?t:d.timestampOffset_,i={periodStart:d.timestampOffset_,segmentStart:t,segmentEnd:r,vttOffset:a},s=d.parser_.parseMedia(shaka.util.BufferUtils.toUint8(e),i,n,[]),o=$jscomp.makeIterator(s),l=o.next();!l.done;l=o.next())u=l.value,d.modifyCueCallback_(u,n||null,i);c=s.filter((function(e){return e.startTime>=d.appendWindowStart_&&e.startTime<d.appendWindowEnd_})),d.displayer_.append(c),null==d.bufferStart_?d.bufferStart_=Math.max(t,d.appendWindowStart_):(goog.asserts.assert(null!=d.bufferEnd_,"There should already be a buffered range end."),goog.asserts.assert(1>=t-d.bufferEnd_,"There should not be a gap in text references >1s")),d.bufferEnd_=Math.min(r,d.appendWindowEnd_),p.jumpToEnd()}))},shaka.text.TextEngine.prototype.remove=function(e,t){var r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return n.yield(Promise.resolve(),2);r.displayer_&&r.displayer_.remove(e,t)&&(null==r.bufferStart_?goog.asserts.assert(null==r.bufferEnd_,"end must be null if startTime is null"):(goog.asserts.assert(null!=r.bufferEnd_,"end must be non-null if startTime is non-null"),t<=r.bufferStart_||e>=r.bufferEnd_||(e<=r.bufferStart_&&t>=r.bufferEnd_?r.bufferStart_=r.bufferEnd_=null:e<=r.bufferStart_&&t<r.bufferEnd_?r.bufferStart_=t:e>r.bufferStart_&&t>=r.bufferEnd_?r.bufferEnd_=e:goog.asserts.assert(!1,"removal from the middle is not supported by TextEngine")))),n.jumpToEnd()}))},shaka.text.TextEngine.prototype.setTimestampOffset=function(e){this.timestampOffset_=e},shaka.text.TextEngine.prototype.setAppendWindow=function(e,t){this.appendWindowStart_=e,this.appendWindowEnd_=t},shaka.text.TextEngine.prototype.bufferStart=function(){return this.bufferStart_},shaka.text.TextEngine.prototype.bufferEnd=function(){return this.bufferEnd_},shaka.text.TextEngine.prototype.isBuffered=function(e){return null!=this.bufferStart_&&null!=this.bufferEnd_&&(e>=this.bufferStart_&&e<this.bufferEnd_)},shaka.text.TextEngine.prototype.bufferedAheadOf=function(e){return null==this.bufferEnd_||this.bufferEnd_<e?0:(goog.asserts.assert(null!=this.bufferStart_,"start should not be null if end is not null"),this.bufferEnd_-Math.max(e,this.bufferStart_))},shaka.text.TextEngine.prototype.setSelectedClosedCaptionId=function(e,t){if(this.selectedClosedCaptionId_=e,e=this.closedCaptionsMap_.get(e))for(var r=$jscomp.makeIterator(e.keys()),n=r.next();!n.done;n=r.next())(n=e.get(n.value).filter((function(e){return e.endTime<=t})))&&this.displayer_.append(n)},shaka.text.TextEngine.prototype.applyVideoTimestampOffsetRecursive_=function(e,t){e.startTime+=t,e.endTime+=t;for(var r=(e=$jscomp.makeIterator(e.nestedCues)).next();!r.done;r=e.next())this.applyVideoTimestampOffsetRecursive_(r.value,t)},shaka.text.TextEngine.prototype.storeAndAppendClosedCaptions=function(e,t,r,n){for(var a=t+" "+r,i=new Map,s=(e=$jscomp.makeIterator(e)).next();!s.done;s=e.next()){var o=s.value;s=o.stream,o=o.cue,i.has(s)||i.set(s,new Map),i.get(s).has(a)||i.get(s).set(a,[]),this.applyVideoTimestampOffsetRecursive_(o,n),o.startTime>=this.appendWindowStart_&&o.startTime<this.appendWindowEnd_&&(i.get(s).get(a).push(o),s==this.selectedClosedCaptionId_&&this.displayer_.append([o]))}for(a=(n=$jscomp.makeIterator(i.keys())).next();!a.done;a=n.next())for(a=a.value,this.closedCaptionsMap_.has(a)||this.closedCaptionsMap_.set(a,new Map),s=(e=$jscomp.makeIterator(i.get(a).keys())).next();!s.done;s=e.next())s=s.value,o=i.get(a).get(s),this.closedCaptionsMap_.get(a).set(s,o);this.bufferStart_=null==this.bufferStart_?Math.max(t,this.appendWindowStart_):Math.min(this.bufferStart_,Math.max(t,this.appendWindowStart_)),this.bufferEnd_=Math.max(this.bufferEnd_,Math.min(r,this.appendWindowEnd_))},shaka.text.TextEngine.prototype.getNumberOfClosedCaptionChannels=function(){return this.closedCaptionsMap_.size},shaka.text.TextEngine.prototype.getNumberOfClosedCaptionsInChannel=function(e){return(e=this.closedCaptionsMap_.get(e))?e.size:0},goog.exportSymbol("shaka.text.TextEngine",shaka.text.TextEngine),goog.exportProperty(shaka.text.TextEngine.prototype,"destroy",shaka.text.TextEngine.prototype.destroy),goog.exportProperty(shaka.text.TextEngine,"findParser",shaka.text.TextEngine.findParser),goog.exportProperty(shaka.text.TextEngine,"unregisterParser",shaka.text.TextEngine.unregisterParser),goog.exportProperty(shaka.text.TextEngine,"registerParser",shaka.text.TextEngine.registerParser),shaka.text.TextEngine.parserMap_=new Map,shaka.util.Functional=function(){},shaka.util.Functional.createFallbackPromiseChain=function(e,t){return e.reduce((function(e,r){return e.catch((function(){return t(r)}))}),Promise.reject())},shaka.util.Functional.collapseArrays=function(e,t){return e.concat(t)},shaka.util.Functional.ignored=function(){},shaka.util.Functional.noop=function(){},shaka.util.Functional.isNotNull=function(e){return null!=e},shaka.util.Functional.promiseWithTimeout=function(e,t){return Promise.race([t,new Promise((function(t,r){new shaka.util.Timer(r).tickAfter(e)}))])},shaka.util.LanguageUtils=function(){},shaka.util.LanguageUtils.areLocaleCompatible=function(e,t){var r=shaka.util.LanguageUtils;return(e=r.normalize(e))==(t=r.normalize(t))},shaka.util.LanguageUtils.areLanguageCompatible=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),t=r.normalize(t),e=r.disassembleLocale_(e),t=r.disassembleLocale_(t),e[0]==t[0]},shaka.util.LanguageUtils.isParentOf=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),t=r.normalize(t),e=r.disassembleLocale_(e),t=r.disassembleLocale_(t),e[0]==t[0]&&1==e.length&&2==t.length},shaka.util.LanguageUtils.isSiblingOf=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),t=r.normalize(t),e=r.disassembleLocale_(e),t=r.disassembleLocale_(t),2==e.length&&2==t.length&&e[0]==t[0]},shaka.util.LanguageUtils.normalize=function(e){var t=shaka.util.LanguageUtils,r=(e=$jscomp.makeIterator(e.split("-x-"))).next().value;r=void 0===r?"":r,e=void 0===(e=e.next().value)?"":e;var n=$jscomp.makeIterator(r.split("-"));return r=void 0===(r=n.next().value)?"":r,n=void 0===(n=n.next().value)?"":n,e=e?"x-"+e:"",r=r.toLowerCase(),r=t.isoMap_.get(r)||r,((t=n.toUpperCase())?r+"-"+t:r)+(e?"-"+e:"")},shaka.util.LanguageUtils.areSiblings=function(e,t){var r=shaka.util.LanguageUtils,n=r.getBase(e);return r=r.getBase(t),e!=n&&t!=r&&n==r},shaka.util.LanguageUtils.relatedness=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),(t=r.normalize(t))==e?4:r.isParentOf(t,e)?3:r.isSiblingOf(t,e)?2:r.isParentOf(e,t)?1:0},shaka.util.LanguageUtils.getBase=function(e){var t=shaka.util.LanguageUtils,r=e.indexOf("-");return e=(e=0<=r?e.substring(0,r):e).toLowerCase(),t.isoMap_.get(e)||e},shaka.util.LanguageUtils.getLocaleForText=function(e){var t=shaka.util.LanguageUtils;return goog.asserts.assert(e.type==shaka.util.ManifestParserUtils.ContentType.TEXT,"Can only get language from text streams"),t.normalize(e.language||"und")},shaka.util.LanguageUtils.getLocaleForVariant=function(e){var t=shaka.util.LanguageUtils;return e.language?t.normalize(e.language):e.audio&&e.audio.language?t.normalize(e.audio.language):e.video&&e.video.language?t.normalize(e.video.language):"und"},shaka.util.LanguageUtils.findClosestLocale=function(e,t){var r=shaka.util.LanguageUtils;e=r.normalize(e);for(var n=new Set,a=(t=$jscomp.makeIterator(t)).next();!a.done;a=t.next())n.add(r.normalize(a.value));for(a=(t=$jscomp.makeIterator(n)).next();!a.done;a=t.next())if((a=a.value)==e)return a;for(a=(t=$jscomp.makeIterator(n)).next();!a.done;a=t.next())if(a=a.value,r.isParentOf(a,e))return a;for(a=(t=$jscomp.makeIterator(n)).next();!a.done;a=t.next())if(a=a.value,r.isSiblingOf(a,e))return a;for(t=(n=$jscomp.makeIterator(n)).next();!t.done;t=n.next())if(t=t.value,r.isParentOf(e,t))return t;return null},shaka.util.LanguageUtils.disassembleLocale_=function(e){var t=e.split("-");return goog.asserts.assert(2>=t.length,["Locales should not have more than 2 components. ",e," has too many components."].join()),t},goog.exportSymbol("shaka.util.LanguageUtils",shaka.util.LanguageUtils),goog.exportProperty(shaka.util.LanguageUtils,"findClosestLocale",shaka.util.LanguageUtils.findClosestLocale),goog.exportProperty(shaka.util.LanguageUtils,"getLocaleForVariant",shaka.util.LanguageUtils.getLocaleForVariant),goog.exportProperty(shaka.util.LanguageUtils,"getLocaleForText",shaka.util.LanguageUtils.getLocaleForText),goog.exportProperty(shaka.util.LanguageUtils,"getBase",shaka.util.LanguageUtils.getBase),goog.exportProperty(shaka.util.LanguageUtils,"relatedness",shaka.util.LanguageUtils.relatedness),goog.exportProperty(shaka.util.LanguageUtils,"areSiblings",shaka.util.LanguageUtils.areSiblings),goog.exportProperty(shaka.util.LanguageUtils,"normalize",shaka.util.LanguageUtils.normalize),goog.exportProperty(shaka.util.LanguageUtils,"isSiblingOf",shaka.util.LanguageUtils.isSiblingOf),goog.exportProperty(shaka.util.LanguageUtils,"isParentOf",shaka.util.LanguageUtils.isParentOf),goog.exportProperty(shaka.util.LanguageUtils,"areLanguageCompatible",shaka.util.LanguageUtils.areLanguageCompatible),goog.exportProperty(shaka.util.LanguageUtils,"areLocaleCompatible",shaka.util.LanguageUtils.areLocaleCompatible),shaka.util.LanguageUtils.isoMap_=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),shaka.util.StreamUtils=function(){},shaka.util.StreamUtils.chooseCodecsAndFilterManifest=function(e,t,r,n,a){var i=shaka.util.StreamUtils,s=shaka.util.MimeUtils;if(a.length){for(var o=e.textStreams,l=(a=$jscomp.makeIterator(a)).next(),u={};!l.done;u={textFormat:void 0},l=a.next())if(u.textFormat=l.value,(l=o.filter(function(e){return function(t){return!(!t.codecs.startsWith(e.textFormat)&&!t.mimeType.startsWith(e.textFormat))}}(u))).length){o=l;break}e.textStreams=o}if(o=e.variants,(t.length||r.length)&&(o=i.choosePreferredCodecs(o,t,r)),n.length){for(t=new shaka.util.MultiMap,i=(r=$jscomp.makeIterator(o)).next();!i.done;i=r.next())i=i.value,t.push(String(i.video.width||0),i);var c=[];t.forEach((function(e,t){e=0;for(var r=[],a=(t=$jscomp.makeIterator(t)).next(),i={};!a.done;i={variant$jscomp$4:void 0},a=t.next())i.variant$jscomp$4=a.value,(a=n.filter(function(e){return function(t){return e.variant$jscomp$4.decodingInfos[0][t]}}(i)).length)>e?(e=a,r=[i.variant$jscomp$4]):a==e&&r.push(i.variant$jscomp$4);c.push.apply(c,$jscomp.arrayFromIterable(r))})),o=c}for(r=new Set,t=new Set,o=(i=$jscomp.makeIterator(o)).next();!o.done;o=i.next())(o=o.value).audio&&r.add(o.audio),o.video&&t.add(o.video);o=Array.from(r).sort((function(e,t){return e.bandwidth-t.bandwidth}));var d=[];for(r=new Map,i=function(e){var t=e.language+(e.channelsCount||0)+(e.audioSamplingRate||0)+e.roles.join(",")+e.label+e.groupId+e.fastSwitching;return e.dependencyStream&&(t+=e.dependencyStream.baseOriginalId||""),t},a=(o=$jscomp.makeIterator(o)).next();!a.done;a=o.next()){if(l=i(a=a.value),(u=r.get(l)||[]).length){var p=u[u.length-1],h=s.getNormalizedCodec(p.codecs),f=s.getNormalizedCodec(a.codecs);h!=f||a.bandwidth&&p.bandwidth&&!(a.bandwidth>p.bandwidth)||(u.push(a),d.push(a.id))}else u.push(a),d.push(a.id);r.set(l,u)}var m={vp8:1,avc:1,"dovi-avc":.95,vp9:.9,vp09:.9,hevc:.85,"dovi-hevc":.8,"dovi-p5":.75,av01:.7,"dovi-av1":.65,vvc:.6};o=Array.from(t).sort((function(e,t){if(!e.bandwidth||!t.bandwidth||e.bandwidth==t.bandwidth){if(e.codecs&&t.codecs&&e.codecs!=t.codecs&&e.width==t.width){var r=s.getNormalizedCodec(e.codecs),n=s.getNormalizedCodec(t.codecs);if(r!=n)return(m[r]||1)-(m[n]||1)}return e.width-t.width}return e.bandwidth-t.bandwidth})),t=shaka.media.Capabilities.isChangeTypeSupported();var g=[];for(r=new Map,i=function(e){var t=String(e.width||"")+String(e.height||"")+String(Math.round(e.frameRate||0))+(e.hdr||"")+e.fastSwitching;return e.dependencyStream&&(t+=e.dependencyStream.baseOriginalId||""),t},a=(o=$jscomp.makeIterator(o)).next();!a.done;a=o.next()){if(l=i(a=a.value),(u=r.get(l)||[]).length){if(p=u[u.length-1],!t&&(h=s.getNormalizedCodec(p.codecs))!==(f=s.getNormalizedCodec(a.codecs)))continue;(h=s.getNormalizedCodec(p.codecs))!=(f=s.getNormalizedCodec(a.codecs))||a.bandwidth&&p.bandwidth&&!(a.bandwidth>p.bandwidth)||(u.push(a),g.push(a.id))}else u.push(a),g.push(a.id);r.set(l,u)}e.variants=e.variants.filter((function(e){var t=e.audio,r=e.video;return!(t&&!d.includes(t.id)||r&&!g.includes(r.id))||(shaka.log.debug("Dropping Variant (better codec available)",e),!1)}))},shaka.util.StreamUtils.choosePreferredCodecs=function(e,t,r){for(var n=(t=$jscomp.makeIterator(t)).next(),a={};!n.done;a={videoCodec$jscomp$4:void 0},n=t.next())if(a.videoCodec$jscomp$4=n.value,(n=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.videoCodec$jscomp$4)}}(a))).length){e=n;break}for(t=(r=$jscomp.makeIterator(r)).next(),n={};!t.done;n={audioCodec$jscomp$4:void 0},t=r.next())if(n.audioCodec$jscomp$4=t.value,(t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.audioCodec$jscomp$4)}}(n))).length){e=t;break}return e},shaka.util.StreamUtils.filterByRestrictions=function(e,t,r){e.variants=e.variants.filter((function(e){return shaka.util.StreamUtils.meetsRestrictions(e,t,r)}))},shaka.util.StreamUtils.meetsRestrictions=function(e,t,r){var n=function(e,t,r){return e>=t&&e<=r},a=e.video;if(a&&a.width&&a.height){var i=a.width,s=a.height;if(s>i&&(i=(s=$jscomp.makeIterator([s,i])).next().value,s=s.next().value),!n(i,t.minWidth,Math.min(t.maxWidth,r.width))||!n(s,t.minHeight,Math.min(t.maxHeight,r.height))||!n(a.width*a.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!n(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||e&&e.audio&&e.audio.channelsCount&&!n(e.audio.channelsCount,t.minChannelsCount,t.maxChannelsCount)||!n(e.bandwidth,t.minBandwidth,t.maxBandwidth))},shaka.util.StreamUtils.applyRestrictions=function(e,t,r){for(var n=!1,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){var i=(a=a.value).allowedByApplication;a.allowedByApplication=shaka.util.StreamUtils.meetsRestrictions(a,t,r),i!=a.allowedByApplication&&(n=!0)}return n},shaka.util.StreamUtils.filterManifest=function(e,t,r,n){return r=void 0===r?[]:r,n=void 0===n?{}:n,$jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?a.yield(shaka.util.StreamUtils.filterManifestByMediaCapabilities(e,t,0<t.offlineSessionIds.length,r,n),2):(shaka.util.StreamUtils.filterTextStreams_(t),a.yield(shaka.util.StreamUtils.filterImageStreams_(t),0))}))},shaka.util.StreamUtils.filterManifestByMediaCapabilities=function(e,t,r,n,a){var i,s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress)return goog.asserts.assert(navigator.mediaCapabilities,"MediaCapabilities should be valid."),shaka.util.Platform.isXboxOne()&&shaka.util.StreamUtils.overrideDolbyVisionCodecs(t.variants),l.yield(shaka.util.StreamUtils.getDecodingInfosForVariants(t.variants,r,!1,n),2);i=null,e&&(s=e.getDrmInfo())&&(i=s.keySystem),o=shaka.util.StreamUtils,t.variants=t.variants.filter((function(e){var t=o.checkVariantSupported_(e,i,a);return t||shaka.log.debug("Dropping variant - not compatible with platform",o.getVariantSummaryString_(e)),t})),l.jumpToEnd()}))},shaka.util.StreamUtils.overrideDolbyVisionCodecs=function(e){for(var t=(new Map).set("dvav","avc3").set("dva1","avc1").set("dvhe","hev1").set("dvh1","hvc1").set("dvc1","vvc1").set("dvi1","vvi1"),r=new Set,n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())(n=n.value).video&&r.add(n.video);for(e=(r=$jscomp.makeIterator(r)).next();!e.done;e=r.next()){e=e.value;for(var a=(n=$jscomp.makeIterator(t)).next();!a.done;a=n.next()){var i=$jscomp.makeIterator(a.value);if(a=i.next().value,i=i.next().value,e.codecs.includes(a)){e.codecs=e.codecs.replace(a,i);break}}}},shaka.util.StreamUtils.checkVariantSupported_=function(e,t,r){if(!e.decodingInfos.some((function(e){return!(!e.supported||t&&(e=e.keySystemAccess)&&(r[e.keySystem]||e.keySystem)!=t)})))return!1;var n=shaka.util.Platform.isXboxOne(),a=shaka.util.Platform.isFirefox()&&shaka.util.Platform.isAndroid(),i=e.video,s=i&&i.width||0,o=i&&i.height||0;return!(n&&i&&(1920<s||1080<o)&&(i.codecs.includes("avc1.")||i.codecs.includes("avc3."))||(n=i&&i.dependencyStream)&&!shaka.lcevc.Dec.isStreamSupported(n))&&(e=e.audio,!(a&&e&&e.encrypted&&e.codecs.toLowerCase().includes("opus")||e&&e.dependencyStream))},shaka.util.StreamUtils.getDecodingInfosForVariant_=function(e,t){var r,n,a,i,s,o,l,u;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r=function(e,t){if(e){var r=shaka.util.ObjectUtils.shallowCloneObject(e);return r.supported=e.supported&&t.supported,r.powerEfficient=e.powerEfficient&&t.powerEfficient,r.smooth=e.smooth&&t.smooth,t.keySystemAccess&&!r.keySystemAccess&&(r.keySystemAccess=t.keySystemAccess),r}return t},n=shaka.util.StreamUtils,a=null,i=[],s=$jscomp.makeIterator(t),o=s.next(),l={};!o.done;l={cache:void 0,cacheKey:void 0},o=s.next())u=o.value,l.cacheKey=shaka.util.ObjectUtils.alphabeticalKeyOrderStringify(u),l.cache=n.decodingConfigCache_,l.cache.has(l.cacheKey)?(shaka.log.v2("Using cached results of mediaCapabilities.decodingInfo","for key",l.cacheKey),a=r(a,l.cache.get(l.cacheKey))):i.push(n.checkEachDecodingConfigCombination_(u).then(function(e){return function(t){for(var n=null,i=(t=$jscomp.makeIterator(t||[])).next();!i.done;i=t.next())n=r(n,i.value);n&&(e.cache.set(e.cacheKey,n),a=r(a,n))}}(l)));return c.yield(Promise.all(i),2)}a&&e.decodingInfos.push(a),c.jumpToEnd()}))},shaka.util.StreamUtils.checkEachDecodingConfigCombination_=function(e){var t=[""];e.video&&(t=shaka.util.MimeUtils.getCodecs(e.video.contentType).split(","));var r=[""];e.audio&&(r=shaka.util.MimeUtils.getCodecs(e.audio.contentType).split(","));for(var n=[],a=(t=$jscomp.makeIterator(t)).next();!a.done;a=t.next()){a=a.value;for(var i=$jscomp.makeIterator(r),s=i.next(),o={};!s.done;o={copy$jscomp$1:void 0},s=i.next()){if(s=s.value,o.copy$jscomp$1=shaka.util.ObjectUtils.cloneObject(e),e.video){var l=shaka.util.MimeUtils.getBasicType(o.copy$jscomp$1.video.contentType);o.copy$jscomp$1.video.contentType=shaka.util.MimeUtils.getFullType(l,a)}e.audio&&(l=shaka.util.MimeUtils.getBasicType(o.copy$jscomp$1.audio.contentType),o.copy$jscomp$1.audio.contentType=shaka.util.MimeUtils.getFullType(l,s)),n.push(new Promise(function(e){return function(t,r){(shaka.util.Platform.isAndroid()?shaka.util.Functional.promiseWithTimeout(5,navigator.mediaCapabilities.decodingInfo(e.copy$jscomp$1)):navigator.mediaCapabilities.decodingInfo(e.copy$jscomp$1)).then((function(e){t(e)})).catch(r)}}(o)))}}return Promise.all(n).catch((function(t){return shaka.log.info("MediaCapabilities.decodingInfo() failed.",JSON.stringify(e),t),null}))},shaka.util.StreamUtils.getDecodingInfosForVariants=function(e,t,r,n){var a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E;return $jscomp.asyncExecutePromiseGeneratorProgram((function(b){switch(b.nextAddress){case 1:if(e.some((function(e){return e.decodingInfos.length})))return shaka.log.debug("Already got the variants' decodingInfo."),b.return();a=$jscomp.makeIterator(n),i=a.next(),s={};case 2:if(i.done){b.jumpTo(4);break}s.preferredKeySystem=i.value,o=!1,l=$jscomp.makeIterator(e),u=l.next();case 5:if(u.done){b.jumpTo(7);break}c=u.value,d=shaka.util.StreamUtils.getDecodingConfigs_(c,t,r).filter((T=s,function(e){return((e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)===T.preferredKeySystem})),p=$jscomp.makeIterator(d),h=p.next();case 8:if(h.done){b.jumpTo(10);break}return f=h.value,b.yield(shaka.util.StreamUtils.getDecodingInfosForVariant_(c,f),9);case 9:h=p.next(),b.jumpTo(8);break;case 10:c.decodingInfos.length&&(o=!0),u=l.next(),b.jumpTo(5);break;case 7:if(o)return b.return();s={preferredKeySystem:void 0},i=a.next(),b.jumpTo(2);break;case 4:m=$jscomp.makeIterator(e),g=m.next();case 12:if(g.done){b.jumpTo(0);break}y=g.value,v=shaka.util.StreamUtils.getDecodingConfigs_(y,t,r).filter((function(e){return!(e=(e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)||!n.includes(e)})),_=$jscomp.makeIterator(v),k=_.next();case 15:if(k.done){g=m.next(),b.jumpTo(12);break}return E=k.value,b.yield(shaka.util.StreamUtils.getDecodingInfosForVariant_(y,E),16);case 16:k=_.next(),b.jumpTo(15)}var T}))},shaka.util.StreamUtils.getDecodingConfigs_=function(e,t,r){var n=e.audio,a=e.video,i=shaka.util.ManifestParserUtils.ContentType,s=shaka.util.ManifestParserUtils,o=shaka.util.MimeUtils,l=shaka.util.StreamUtils,u=[],c=[];if(a)for(var d=$jscomp.makeIterator(a.fullMimeTypes),p=d.next();!p.done;p=d.next()){p=p.value;var h=o.getCodecs(p);if(h.includes(",")&&!n){var f=h.split(","),m=o.getBasicType(p);h=s.guessCodecs(i.VIDEO,f),f=s.guessCodecs(i.AUDIO,f),f=l.getCorrectAudioCodecs(f,m),m=o.getFullOrConvertedType(m,f,i.AUDIO),c.push({contentType:m,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(h=l.getCorrectVideoCodecs(h),p={contentType:o.getFullOrConvertedType(o.getBasicType(p),h,i.VIDEO),width:a.width||64,height:a.height||64,bitrate:a.bandwidth||e.bandwidth||1,framerate:a.frameRate||1},a.hdr)switch(a.hdr){case"SDR":p.transferFunction="srgb";break;case"PQ":p.transferFunction="pq";break;case"HLG":p.transferFunction="hlg"}a.colorGamut&&(p.colorGamut=a.colorGamut),u.push(p)}if(n)for(d=(s=$jscomp.makeIterator(n.fullMimeTypes)).next();!d.done;d=s.next())p=d.value,d=o.getBasicType(p),p=l.getCorrectAudioCodecs(o.getCodecs(p),d),d=o.getFullOrConvertedType(d,p,i.AUDIO),c.push({contentType:d,channels:n.channelsCount||2,bitrate:n.bandwidth||e.bandwidth||1,samplerate:n.audioSamplingRate||1,spatialRendering:n.spatialAudio});for(i=[],0==u.length&&u.push(null),0==c.length&&c.push(null),o=(u=$jscomp.makeIterator(u)).next();!o.done;o=u.next())for(o=o.value,s=(l=$jscomp.makeIterator(c)).next();!s.done;s=l.next())s=s.value,d={type:r?"file":"media-source"},o&&(d.video=o),s&&(d.audio=s),i.push(d);if(!(c=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])).length)return[i];for(e=[],r=new Map,u=(c=$jscomp.makeIterator(c)).next();!u.done;u=c.next())u=u.value,r.get(u.keySystem)||r.set(u.keySystem,[]),r.get(u.keySystem).push(u);for(c=t?"required":"optional",t=t?["persistent-license"]:["temporary"],o=(u=$jscomp.makeIterator(r.keys())).next();!o.done;o=u.next()){for(o=o.value,s=r.get(o),l=new Map,d=(s=$jscomp.makeIterator(s)).next();!d.done;d=s.next())p=(d=d.value).videoRobustness+","+d.audioRobustness,l.get(p)||l.set(p,[]),l.get(p).push(d);for(s=(l=$jscomp.makeIterator(l.values())).next();!s.done;s=l.next()){for(s=s.value,d=[],h=(p=$jscomp.makeIterator(i)).next();!h.done;h=p.next()){h=Object.assign({},h.value),m={keySystem:o,initDataType:"cenc",persistentState:c,distinctiveIdentifier:"optional",sessionTypes:t};for(var g=(f=$jscomp.makeIterator(s)).next();!g.done;g=f.next()){if((g=g.value).initData&&g.initData.length){for(var y=new Set,v=$jscomp.makeIterator(g.initData),_=v.next();!_.done;_=v.next())y.add(_.value.initDataType);1<y.size&&shaka.log.v2("DrmInfo contains more than one initDataType,","and we use the initDataType of the first initData.",g),m.initDataType=g.initData[0].initDataType}g.distinctiveIdentifierRequired&&(m.distinctiveIdentifier="required"),g.persistentStateRequired&&(m.persistentState="required"),g.sessionType&&(m.sessionTypes=[g.sessionType]),n&&(m.audio?(g.encryptionScheme&&(m.audio.encryptionScheme=m.audio.encryptionScheme||g.encryptionScheme),m.audio.robustness=m.audio.robustness||g.audioRobustness):(m.audio={robustness:g.audioRobustness},g.encryptionScheme&&(m.audio.encryptionScheme=g.encryptionScheme)),""==m.audio.robustness&&delete m.audio.robustness),a&&(m.video?(g.encryptionScheme&&(m.video.encryptionScheme=m.video.encryptionScheme||g.encryptionScheme),m.video.robustness=m.video.robustness||g.videoRobustness):(m.video={robustness:g.videoRobustness},g.encryptionScheme&&(m.video.encryptionScheme=g.encryptionScheme)),""==m.video.robustness&&delete m.video.robustness)}h.keySystemConfiguration=m,d.push(h)}e.push(d)}}return e},shaka.util.StreamUtils.getCorrectAudioCodecs=function(e,t){return"flac"==e.toLowerCase()?shaka.util.Platform.isApple()?"fLaC":"flac":"opus"===e.toLowerCase()?shaka.util.Platform.isApple()&&"mp4"==shaka.util.MimeUtils.getContainerType(t)?"Opus":"opus":"ac-3"==e.toLowerCase()&&shaka.util.Platform.requiresEC3InitSegments()?"ec-3":e},shaka.util.StreamUtils.getCorrectVideoCodecs=function(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",(e+=parseInt(t.shift(),10).toString(16))+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e},shaka.util.StreamUtils.filterManifestByCurrentVariant=function(e,t){var r=shaka.util.StreamUtils;t.variants=t.variants.filter((function(t){var n=t.audio;return t=t.video,n&&e&&e.audio&&!r.areStreamsCompatible_(n,e.audio)?(shaka.log.debug("Dropping variant - not compatible with active audio","active audio",r.getStreamSummaryString_(e.audio),"variant.audio",r.getStreamSummaryString_(n)),!1):!(t&&e&&e.video&&!r.areStreamsCompatible_(t,e.video))||(shaka.log.debug("Dropping variant - not compatible with active video","active video",r.getStreamSummaryString_(e.video),"variant.video",r.getStreamSummaryString_(t)),!1)}))},shaka.util.StreamUtils.filterTextStreams_=function(e){e.textStreams=e.textStreams.filter((function(e){var t=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs);return(t=shaka.text.TextEngine.isTypeSupported(t))||shaka.log.debug("Dropping text stream. Is not supported by the platform.",e),t}))},shaka.util.StreamUtils.filterImageStreams_=function(e){var t,r,n,a,i,s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:t=[],r=$jscomp.makeIterator(e.imageStreams),n=r.next();case 2:if(n.done){l.jumpTo(4);break}if(a=n.value,"application/mp4"==(i=a.mimeType)&&"mjpg"==a.codecs&&(i="image/jpg"),shaka.util.StreamUtils.supportedImageMimeTypes_.has(i)){l.jumpTo(5);break}if(!(s=shaka.util.StreamUtils.minImage_.get(i))){shaka.util.StreamUtils.supportedImageMimeTypes_.set(i,!1),l.jumpTo(5);break}return l.yield(shaka.util.StreamUtils.isImageSupported_(s),7);case 7:o=l.yieldResult,shaka.util.StreamUtils.supportedImageMimeTypes_.set(i,o);case 5:shaka.util.StreamUtils.supportedImageMimeTypes_.get(i)?t.push(a):shaka.log.debug("Dropping image stream. Is not supported by the platform.",a),n=r.next(),l.jumpTo(2);break;case 4:e.imageStreams=t,l.jumpToEnd()}}))},shaka.util.StreamUtils.isImageSupported_=function(e){return new Promise((function(t){var r=new Image;r.src=e,"decode"in r?r.decode().then((function(){t(!0)})).catch((function(){t(!1)})):r.onload=r.onerror=function(){t(2===r.height)}}))},shaka.util.StreamUtils.areStreamsCompatible_=function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]},shaka.util.StreamUtils.variantToTrack=function(e){var t=shaka.util.ManifestParserUtils,r=shaka.util.ManifestParserUtils.ContentType,n=e.audio,a=e.video,i=n?n.mimeType:null,s=a?a.mimeType:null,o=n?n.codecs:null,l=a?a.codecs:null,u=n?n.groupId:null,c=[];a&&c.push(a.mimeType),n&&c.push(n.mimeType),c=c[0]||null;var d=[];n&&d.push(n.kind),a&&d.push(a.kind),d=d[0]||null;var p=new Set;if(n)for(var h=$jscomp.makeIterator(n.roles),f=h.next();!f.done;f=h.next())p.add(f.value);if(a)for(f=(h=$jscomp.makeIterator(a.roles)).next();!f.done;f=h.next())p.add(f.value);if(e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:d,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:c,audioMimeType:i,videoMimeType:s,codecs:"",audioCodec:o,videoCodec:l,primary:e.primary,roles:Array.from(p),audioRoles:null,forced:!1,videoId:null,audioId:null,audioGroupId:u,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},a&&(e.videoId=a.id,e.originalVideoId=a.originalId,e.width=a.width||null,e.height=a.height||null,e.frameRate=a.frameRate||null,e.pixelAspectRatio=a.pixelAspectRatio||null,e.videoBandwidth=a.bandwidth||null,e.hdr=a.hdr||null,e.colorGamut=a.colorGamut||null,e.videoLayout=a.videoLayout||null,(i=a.dependencyStream)&&(e.width=i.width||e.width,e.height=i.height||e.height,e.videoCodec=i.codecs||e.videoCodec),l.includes(","))){e.channelsCount=a.channelsCount,e.audioSamplingRate=a.audioSamplingRate,e.spatialAudio=a.spatialAudio,e.originalLanguage=a.originalLanguage,e.audioMimeType=s,a=l.split(",");try{e.videoCodec=t.guessCodecs(r.VIDEO,a),e.audioCodec=t.guessCodecs(r.AUDIO,a)}catch(e){}}return n&&(e.audioId=n.id,e.originalAudioId=n.originalId,e.channelsCount=n.channelsCount,e.audioSamplingRate=n.audioSamplingRate,e.audioBandwidth=n.bandwidth||null,e.spatialAudio=n.spatialAudio,e.label=n.label,e.audioRoles=n.roles,e.accessibilityPurpose=n.accessibilityPurpose,e.originalLanguage=n.originalLanguage,t=n.dependencyStream)&&(e.audioCodec=t.codecs||e.audioCodec),t=[],e.videoCodec&&t.push(e.videoCodec),e.audioCodec&&t.push(e.audioCodec),e.codecs=t.join(", "),e},shaka.util.StreamUtils.textStreamToTrack=function(e){return{id:e.id,active:!1,type:shaka.util.ManifestParserUtils.ContentType.TEXT,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null,accessibilityPurpose:e.accessibilityPurpose,originalLanguage:e.originalLanguage}},shaka.util.StreamUtils.imageStreamToTrack=function(e){var t=shaka.util.ManifestParserUtils.ContentType,r=e.width||null,n=e.height||null,a=null;e.segmentIndex&&(a=e.segmentIndex.earliestReference());var i=e.tilesLayout;return a&&(i=a.getTilesLayout()||i),i&&null!=r&&(r/=Number(i.split("x")[0])),i&&null!=n&&(n/=Number(i.split("x")[1])),{id:e.id,active:!1,type:t.IMAGE,bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:r,height:n,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:i||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId,accessibilityPurpose:null,originalLanguage:null}},shaka.util.StreamUtils.html5TrackId=function(e){return e.__shaka_id||(e.__shaka_id=shaka.util.StreamUtils.nextTrackId_++),e.__shaka_id},shaka.util.StreamUtils.html5TextTrackToTrack=function(e){var t=shaka.util.StreamUtils.html5TrackToGenericShakaTrack_(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="unknown"),"subtitles"==e.kind&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),"forced"==e.kind&&(t.forced=!0),t},shaka.util.StreamUtils.html5AudioTrackToTrack=function(e){var t=shaka.util.StreamUtils.html5TrackToGenericShakaTrack_(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t},shaka.util.StreamUtils.html5TrackToGenericShakaTrack_=function(e){var t=e.language;return{id:shaka.util.StreamUtils.html5TrackId(e),active:!1,type:"",bandwidth:0,language:shaka.util.LanguageUtils.normalize(t||"und"),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,audioGroupId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:t}},shaka.util.StreamUtils.isPlayable=function(e){return e.allowedByApplication&&e.allowedByKeySystem&&0==e.disabledUntilTime},shaka.util.StreamUtils.getPlayableVariants=function(e){return e.filter((function(e){return shaka.util.StreamUtils.isPlayable(e)}))},shaka.util.StreamUtils.filterStreamsByLanguageAndRole=function(e,t,r,n){var a=shaka.util.LanguageUtils,i=e,s=e.filter((function(e){return e.primary}));s.length&&(i=s);var o=i.length?i[0].language:"";if(i=i.filter((function(e){return e.language==o})),t){var l=a.findClosestLocale(a.normalize(t),e.map((function(e){return e.language})));l&&(i=e.filter((function(e){return a.normalize(e.language)==l})))}if(i=i.filter((function(e){return e.forced==n})),r){if((e=shaka.util.StreamUtils.filterStreamsByRole_(i,r)).length)return e;shaka.log.warning("No exact match for the text role could be found.")}else if((e=i.filter((function(e){return 0==e.roles.length}))).length)return e;return(e=i.map((function(e){return e.roles})).reduce(shaka.util.Functional.collapseArrays,[])).length?shaka.util.StreamUtils.filterStreamsByRole_(i,e[0]):i},shaka.util.StreamUtils.filterStreamsByRole_=function(e,t){return e.filter((function(e){return e.roles.includes(t)}))},shaka.util.StreamUtils.isAudio=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.AUDIO},shaka.util.StreamUtils.isVideo=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.VIDEO},shaka.util.StreamUtils.getVariantStreams=function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t},shaka.util.StreamUtils.isFastSwitching=function(e){return!!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)},shaka.util.StreamUtils.setBetterIFrameStream=function(e,t){t.length&&(t=t.filter((function(t){return shaka.util.MimeUtils.getNormalizedCodec(e.codecs)==shaka.util.MimeUtils.getNormalizedCodec(t.codecs)})).sort((function(e,t){return e.bandwidth&&t.bandwidth&&e.bandwidth!=t.bandwidth?e.bandwidth-t.bandwidth:(e.width||0)-(t.width||0)})),e.trickModeVideo=t[0],1<t.length&&(t=t.find((function(t){return e.width==t.width&&e.height==t.height}))))&&(e.trickModeVideo=t)},shaka.util.StreamUtils.getVariantSummaryString_=function(e){var t=[];return e.audio&&t.push(shaka.util.StreamUtils.getStreamSummaryString_(e.audio)),e.video&&t.push(shaka.util.StreamUtils.getStreamSummaryString_(e.video)),t.join(", ")},shaka.util.StreamUtils.getStreamSummaryString_=function(e){return shaka.util.StreamUtils.isAudio(e)?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:shaka.util.StreamUtils.isVideo(e)?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"},shaka.util.StreamUtils.clearDecodingConfigCache=function(){shaka.util.StreamUtils.decodingConfigCache_.clear()},shaka.util.StreamUtils.shouldInitiallyShowText=function(e,t,r){var n=shaka.config.AutoShowText;if(r.autoShowText==n.NEVER)return!1;if(r.autoShowText==n.ALWAYS)return!0;var a=shaka.util.LanguageUtils,i=a.normalize(r.preferredTextLanguage);return t=a.normalize(t.language),r.autoShowText==n.IF_PREFERRED_TEXT_LANGUAGE?a.areLanguageCompatible(t,i):r.autoShowText==n.IF_SUBTITLES_MAY_BE_NEEDED?!!e&&(e=a.normalize(e.language),a.areLanguageCompatible(t,i)&&!a.areLanguageCompatible(e,t)):(shaka.log.alwaysWarn("Invalid autoShowText setting!"),!1)},goog.exportSymbol("shaka.util.StreamUtils",shaka.util.StreamUtils),goog.exportProperty(shaka.util.StreamUtils,"meetsRestrictions",shaka.util.StreamUtils.meetsRestrictions),shaka.util.StreamUtils.decodingConfigCache_=new Map,shaka.util.StreamUtils.nextTrackId_=0,shaka.util.StreamUtils.DecodingAttributes={SMOOTH:"smooth",POWER:"powerEfficient"},shaka.util.StreamUtils.supportedImageMimeTypes_=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),shaka.util.StreamUtils.minWebPImage_="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",shaka.util.StreamUtils.minAvifImage_="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",shaka.util.StreamUtils.minImage_=(new Map).set("image/webp",shaka.util.StreamUtils.minWebPImage_).set("image/avif",shaka.util.StreamUtils.minAvifImage_),shaka.abr.SimpleAbrManager=function(){var e=this;this.switch_=null,this.enabled_=!1,this.bandwidthEstimator_=new shaka.abr.EwmaBandwidthEstimator,this.eventManager_=new shaka.util.EventManager,navigator.connection&&navigator.connection.addEventListener&&this.eventManager_.listen(navigator.connection,"change",(function(){if(e.enabled_&&e.config_.useNetworkInformation){e.bandwidthEstimator_=new shaka.abr.EwmaBandwidthEstimator,e.config_&&e.bandwidthEstimator_.configure(e.config_.advanced);var t=e.chooseVariant();t&&navigator.onLine&&e.switch_(t,e.config_.clearBufferSwitch,e.config_.safeMarginSwitch)}})),this.variants_=[],this.playbackRate_=1,this.startupComplete_=!1,this.resizeObserver_=this.mediaElement_=this.config_=this.lastTimeChosenMs_=null,this.resizeObserverTimer_=new shaka.util.Timer((function(){if(e.enabled_&&(e.config_.restrictToElementSize||e.config_.restrictToScreenSize)){var t=e.chooseVariant();t&&e.switch_(t,e.config_.clearBufferSwitch,e.config_.safeMarginSwitch)}})),this.windowToCheck_=window,"documentPictureInPicture"in window&&this.eventManager_.listen(window.documentPictureInPicture,"enter",(function(){e.windowToCheck_=window.documentPictureInPicture.window,e.resizeObserverTimer_&&e.resizeObserverTimer_.tickNow(),e.eventManager_.listenOnce(e.windowToCheck_,"pagehide",(function(){e.windowToCheck_=window,e.resizeObserverTimer_&&e.resizeObserverTimer_.tickNow()}))})),this.cmsdManager_=this.pictureInPictureWindow_=null},shaka.abr.SimpleAbrManager.prototype.stop=function(){this.switch_=null,this.enabled_=!1,this.variants_=[],this.playbackRate_=1,this.mediaElement_=this.lastTimeChosenMs_=null,this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),this.resizeObserverTimer_.stop(),this.cmsdManager_=this.pictureInPictureWindow_=null},shaka.abr.SimpleAbrManager.prototype.release=function(){this.eventManager_.release(),this.resizeObserverTimer_=null},shaka.abr.SimpleAbrManager.prototype.init=function(e){this.switch_=e},shaka.abr.SimpleAbrManager.prototype.chooseVariant=function(){var e=1/0,t=1/0;if(this.config_.restrictToScreenSize){var r=this.config_.ignoreDevicePixelRatio?1:this.windowToCheck_.devicePixelRatio;e=this.windowToCheck_.screen.height*r,t=this.windowToCheck_.screen.width*r}if(this.resizeObserver_&&this.config_.restrictToElementSize){r=this.config_.ignoreDevicePixelRatio?1:this.windowToCheck_.devicePixelRatio;var n=this.mediaElement_.clientHeight,a=this.mediaElement_.clientWidth;this.pictureInPictureWindow_&&document.pictureInPictureElement&&document.pictureInPictureElement==this.mediaElement_&&(n=this.pictureInPictureWindow_.height,a=this.pictureInPictureWindow_.width),e=Math.min(e,n*r),t=Math.min(t,a*r)}if((r=this.variants_.filter((function(e){return e&&!shaka.util.StreamUtils.isFastSwitching(e)}))).length||(r=this.variants_),n=r,r.length!=this.variants_.length&&(n=this.variants_.filter((function(e){return e&&shaka.util.StreamUtils.isFastSwitching(e)}))),r=this.filterAndSortVariants_(this.config_.restrictions,n,1/0,1/0),1/0!=e||1/0!=t){for(r=this.getResolutionList_(r),a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next())if((a=a.value).height>=e&&a.width>=t){e=a.height,t=a.width;break}r=this.filterAndSortVariants_(this.config_.restrictions,n,e,t)}for(e=this.getBandwidthEstimate(),n.length&&!r.length&&(shaka.log.warning("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),r=[(r=this.filterAndSortVariants_(null,n,1/0,1/0))[0]]),t=r[0]||null,n=0;n<r.length;n++){a=r[n];for(var i=isNaN(this.playbackRate_)?1:Math.abs(this.playbackRate_),s=i*a.bandwidth,o=s/this.config_.bandwidthDowngradeTarget,l={bandwidth:1/0},u=n+1;u<r.length;u++)if(a.bandwidth!=r[u].bandwidth){l=r[u];break}i=i*l.bandwidth/this.config_.bandwidthUpgradeTarget,shaka.log.v2("Bandwidth ranges:",(s/1e6).toFixed(3),(o/1e6).toFixed(3),(i/1e6).toFixed(3)),e>=o&&e<=i&&(t.bandwidth!=a.bandwidth||this.isSameBandwidthAndHigherResolution_(t,a))&&(t=a)}return this.lastTimeChosenMs_=Date.now(),t},shaka.abr.SimpleAbrManager.prototype.enable=function(){this.enabled_=!0},shaka.abr.SimpleAbrManager.prototype.disable=function(){this.enabled_=!1},shaka.abr.SimpleAbrManager.prototype.segmentDownloaded=function(e,t,r,n){e<this.config_.cacheLoadThreshold||(shaka.log.v2("Segment downloaded:","contentType="+(n&&n.contentType),"deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.lastTimeChosenMs_,"enabled="+this.enabled_),goog.asserts.assert(0<=e,"expected a non-negative duration"),this.bandwidthEstimator_.sample(e,t),r&&null!=this.lastTimeChosenMs_&&this.enabled_&&this.suggestStreams_())},shaka.abr.SimpleAbrManager.prototype.trySuggestStreams=function(){null!=this.lastTimeChosenMs_&&this.enabled_&&this.suggestStreams_()},shaka.abr.SimpleAbrManager.prototype.getBandwidthEstimate=function(){var e=this.getDefaultBandwidth_();return navigator.connection&&navigator.connection.downlink&&this.config_.useNetworkInformation&&this.config_.preferNetworkInformationBandwidth?e:(e=this.bandwidthEstimator_.getBandwidthEstimate(e),this.cmsdManager_?this.cmsdManager_.getBandwidthEstimate(e):e)},shaka.abr.SimpleAbrManager.prototype.setVariants=function(e){this.variants_=e},shaka.abr.SimpleAbrManager.prototype.playbackRateChanged=function(e){this.playbackRate_=e},shaka.abr.SimpleAbrManager.prototype.setMediaElement=function(e){var t=this;this.mediaElement_=e,this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null);var r=function(){t.resizeObserverTimer_.tickAfter(shaka.abr.SimpleAbrManager.RESIZE_OBSERVER_BATCH_TIME)};this.mediaElement_&&"ResizeObserver"in window&&(this.resizeObserver_=new ResizeObserver(r),this.resizeObserver_.observe(this.mediaElement_)),this.eventManager_.listen(e,"enterpictureinpicture",(function(e){e.pictureInPictureWindow&&(t.pictureInPictureWindow_=e.pictureInPictureWindow,t.eventManager_.listen(t.pictureInPictureWindow_,"resize",r))})),this.eventManager_.listen(e,"leavepictureinpicture",(function(){t.pictureInPictureWindow_&&t.eventManager_.unlisten(t.pictureInPictureWindow_,"resize",r),t.pictureInPictureWindow_=null}))},shaka.abr.SimpleAbrManager.prototype.setCmsdManager=function(e){this.cmsdManager_=e},shaka.abr.SimpleAbrManager.prototype.configure=function(e){this.config_=e,this.bandwidthEstimator_&&this.config_&&this.bandwidthEstimator_.configure(this.config_.advanced)},shaka.abr.SimpleAbrManager.prototype.suggestStreams_=function(){if(shaka.log.v2("Suggesting Streams..."),goog.asserts.assert(null!=this.lastTimeChosenMs_,"lastTimeChosenMs_ should not be null"),!this.startupComplete_){if(!this.bandwidthEstimator_.hasGoodEstimate())return void shaka.log.v2("Still waiting for a good estimate...");this.startupComplete_=!0,this.lastTimeChosenMs_-=1e3*(this.config_.switchInterval-this.config_.minTimeToSwitch)}if(Date.now()-this.lastTimeChosenMs_<1e3*this.config_.switchInterval)shaka.log.v2("Still within switch interval...");else{var e=this.chooseVariant(),t=this.getBandwidthEstimate();t=Math.round(t/1e3),e&&(shaka.log.debug("Calling switch_(), bandwidth="+t+" kbps"),this.switch_(e,this.config_.clearBufferSwitch,this.config_.safeMarginSwitch))}},shaka.abr.SimpleAbrManager.prototype.getDefaultBandwidth_=function(){var e=this.config_.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.config_.useNetworkInformation&&(e=1e6*navigator.connection.downlink),e},shaka.abr.SimpleAbrManager.prototype.filterAndSortVariants_=function(e,t,r,n){if(this.cmsdManager_){var a=this.cmsdManager_.getMaxBitrate();a&&(t=t.filter((function(e){return!e.bandwidth||!a||e.bandwidth<=a})))}return e&&(t=t.filter((function(t){return goog.asserts.assert(e,"Restrictions should exist!"),shaka.util.StreamUtils.meetsRestrictions(t,e,{width:n,height:r})}))),t.sort((function(e,t){return e.bandwidth-t.bandwidth}))},shaka.abr.SimpleAbrManager.prototype.getResolutionList_=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value.video)&&r.height&&r.width&&t.push({height:r.height,width:r.width});return t.sort((function(e,t){return e.width-t.width}))},shaka.abr.SimpleAbrManager.prototype.isSameBandwidthAndHigherResolution_=function(e,t){return!(e.bandwidth!=t.bandwidth||!e.video||!t.video)&&(e.video.width<t.video.width||e.video.height<t.video.height)},goog.exportSymbol("shaka.abr.SimpleAbrManager",shaka.abr.SimpleAbrManager),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"configure",shaka.abr.SimpleAbrManager.prototype.configure),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"setCmsdManager",shaka.abr.SimpleAbrManager.prototype.setCmsdManager),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"setMediaElement",shaka.abr.SimpleAbrManager.prototype.setMediaElement),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"playbackRateChanged",shaka.abr.SimpleAbrManager.prototype.playbackRateChanged),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"setVariants",shaka.abr.SimpleAbrManager.prototype.setVariants),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"getBandwidthEstimate",shaka.abr.SimpleAbrManager.prototype.getBandwidthEstimate),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"trySuggestStreams",shaka.abr.SimpleAbrManager.prototype.trySuggestStreams),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"segmentDownloaded",shaka.abr.SimpleAbrManager.prototype.segmentDownloaded),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"disable",shaka.abr.SimpleAbrManager.prototype.disable),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"enable",shaka.abr.SimpleAbrManager.prototype.enable),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"chooseVariant",shaka.abr.SimpleAbrManager.prototype.chooseVariant),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"init",shaka.abr.SimpleAbrManager.prototype.init),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"release",shaka.abr.SimpleAbrManager.prototype.release),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"stop",shaka.abr.SimpleAbrManager.prototype.stop),shaka.abr.SimpleAbrManager.RESIZE_OBSERVER_BATCH_TIME=1,shaka.config.CrossBoundaryStrategy={KEEP:"keep",RESET:"reset",RESET_TO_ENCRYPTED:"reset_to_encrypted",RESET_ON_ENCRYPTION_CHANGE:"RESET_ON_ENCRYPTION_CHANGE"},goog.exportSymbol("shaka.config.CrossBoundaryStrategy",shaka.config.CrossBoundaryStrategy),shaka.debug={},shaka.debug.RunningInLab=!1,shaka.net={},shaka.net.Backoff=function(e,t){t=void 0!==t&&t;var r=shaka.net.Backoff.defaultRetryParameters();this.maxAttempts_=null==e.maxAttempts?r.maxAttempts:e.maxAttempts,goog.asserts.assert(1<=this.maxAttempts_,"maxAttempts should be >= 1"),this.baseDelay_=null==e.baseDelay?r.baseDelay:e.baseDelay,goog.asserts.assert(0<=this.baseDelay_,"baseDelay should be >= 0"),this.fuzzFactor_=null==e.fuzzFactor?r.fuzzFactor:e.fuzzFactor,goog.asserts.assert(0<=this.fuzzFactor_,"fuzzFactor should be >= 0"),this.backoffFactor_=null==e.backoffFactor?r.backoffFactor:e.backoffFactor,goog.asserts.assert(0<=this.backoffFactor_,"backoffFactor should be >= 0"),this.numAttempts_=0,this.nextUnfuzzedDelay_=this.baseDelay_,(this.autoReset_=t)&&(goog.asserts.assert(2<=this.maxAttempts_,"maxAttempts must be >= 2 for autoReset == true"),this.numAttempts_=1)},shaka.net.Backoff.prototype.attempt=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress){if(r.numAttempts_>=r.maxAttempts_){if(!r.autoReset_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.ATTEMPTS_EXHAUSTED);r.reset_()}return e=r.numAttempts_,r.numAttempts_++,0==e?(goog.asserts.assert(!r.autoReset_,"Failed to delay with auto-reset!"),n.return()):(t=shaka.net.Backoff.fuzz_(r.nextUnfuzzedDelay_,r.fuzzFactor_),n.yield(new Promise((function(e){shaka.net.Backoff.defer(t,e)})),2))}r.nextUnfuzzedDelay_*=r.backoffFactor_,n.jumpToEnd()}))},shaka.net.Backoff.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},shaka.net.Backoff.fuzz_=function(e,t){return e*(1+(2*Math.random()-1)*t)},shaka.net.Backoff.prototype.reset_=function(){goog.asserts.assert(this.autoReset_,"Should only be used for auto-reset!"),this.numAttempts_=1,this.nextUnfuzzedDelay_=this.baseDelay_},shaka.net.Backoff.defer=function(e,t){new shaka.util.Timer(t).tickAfter(e/1e3)},shaka.util.PublicPromise=function(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.resolve=e,r.reject=t,r},shaka.util.PublicPromise.prototype.resolve=function(e){},shaka.util.PublicPromise.prototype.reject=function(e){},shaka.util.AbortableOperation=function(e,t){this.promise=e,this.onAbort_=t,this.abortPromise_=null},shaka.util.AbortableOperation.failed=function(e){return new shaka.util.AbortableOperation(Promise.reject(e),(function(){return Promise.resolve()}))},shaka.util.AbortableOperation.aborted=function(){var e=Promise.reject(shaka.util.AbortableOperation.abortError());return e.catch((function(){})),new shaka.util.AbortableOperation(e,(function(){return Promise.resolve()}))},shaka.util.AbortableOperation.abortError=function(){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED)},shaka.util.AbortableOperation.completed=function(e){return new shaka.util.AbortableOperation(Promise.resolve(e),(function(){return Promise.resolve()}))},shaka.util.AbortableOperation.notAbortable=function(e){return new shaka.util.AbortableOperation(e,(function(){return e.catch((function(){}))}))},shaka.util.AbortableOperation.prototype.abort=function(){return this.abortPromise_||(this.abortPromise_=this.onAbort_()),this.abortPromise_},shaka.util.AbortableOperation.all=function(e){return new shaka.util.AbortableOperation(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))},shaka.util.AbortableOperation.prototype.finally=function(e){return this.promise.then((function(t){return e(!0)}),(function(t){return e(!1)})),this},shaka.util.AbortableOperation.prototype.chain=function(e,t){var r=this,n=new shaka.util.PublicPromise;n.catch((function(){}));var a=shaka.util.AbortableOperation.abortError(),i=function(){return n.reject(a),r.abort()},s=function(s){return function(o){if(r.abortPromise_&&s)n.reject(a);else{var l=s?e:t;l?i=shaka.util.AbortableOperation.wrapChainCallback_(l,o,n):(s?n.resolve:n.reject)(o)}}};return this.promise.then(s(!0),s(!1)),new shaka.util.AbortableOperation(n,(function(){return i()}))},shaka.util.AbortableOperation.wrapChainCallback_=function(e,t,r){try{var n=e(t);return n&&n.promise&&n.abort?(r.resolve(n.promise),function(){return n.abort()}):(r.resolve(n),function(){return Promise.resolve(n).then((function(){}),(function(){}))})}catch(e){return r.reject(e),function(){return Promise.resolve()}}},$jscomp.global.Object.defineProperties(shaka.util.AbortableOperation.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return null!==this.abortPromise_}}}),goog.exportSymbol("shaka.util.AbortableOperation",shaka.util.AbortableOperation),goog.exportProperty(shaka.util.AbortableOperation.prototype,"chain",shaka.util.AbortableOperation.prototype.chain),goog.exportProperty(shaka.util.AbortableOperation.prototype,"finally",shaka.util.AbortableOperation.prototype.finally),goog.exportProperty(shaka.util.AbortableOperation,"all",shaka.util.AbortableOperation.all),goog.exportProperty(shaka.util.AbortableOperation.prototype,"abort",shaka.util.AbortableOperation.prototype.abort),goog.exportProperty(shaka.util.AbortableOperation,"notAbortable",shaka.util.AbortableOperation.notAbortable),goog.exportProperty(shaka.util.AbortableOperation,"completed",shaka.util.AbortableOperation.completed),goog.exportProperty(shaka.util.AbortableOperation,"aborted",shaka.util.AbortableOperation.aborted),goog.exportProperty(shaka.util.AbortableOperation,"failed",shaka.util.AbortableOperation.failed),shaka.util.FakeEvent=function(e,t){if(t)if(t instanceof Map)for(var r=$jscomp.makeIterator(t.keys()),n=r.next();!n.done;n=r.next())n=n.value,Object.defineProperty(this,n,{value:t.get(n),writable:!0,enumerable:!0});else for(r in t=shaka.util.FakeEvent.recastDictAsObject_(t))Object.defineProperty(this,r,{value:t[r],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.stopped=!1},shaka.util.FakeEvent.fromRealEvent=function(e){var t,r=new shaka.util.FakeEvent(e.type);for(t in e)Object.defineProperty(r,t,{value:e[t],writable:!0,enumerable:!0});return r},shaka.util.FakeEvent.recastDictAsObject_=function(e){return goog.asserts.assert(!(e instanceof Map),"dict should not be a map"),e},shaka.util.FakeEvent.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},shaka.util.FakeEvent.prototype.stopImmediatePropagation=function(){this.stopped=!0},shaka.util.FakeEvent.prototype.stopPropagation=function(){},goog.exportSymbol("shaka.util.FakeEvent",shaka.util.FakeEvent),shaka.util.FakeEvent.EventName={AbrStatusChanged:"abrstatuschanged",Adaptation:"adaptation",AudioTrackChanged:"audiotrackchanged",AudioTracksChanged:"audiotrackschanged",BoundaryCrossed:"boundarycrossed",Buffering:"buffering",Complete:"complete",DownloadCompleted:"downloadcompleted",DownloadFailed:"downloadfailed",DownloadHeadersReceived:"downloadheadersreceived",DrmSessionUpdate:"drmsessionupdate",Emsg:"emsg",Prft:"prft",Error:"error",ExpirationUpdated:"expirationupdated",FirstQuartile:"firstquartile",GapJumped:"gapjumped",KeyStatusChanged:"keystatuschanged",Loaded:"loaded",Loading:"loading",ManifestParsed:"manifestparsed",ManifestUpdated:"manifestupdated",MediaQualityChanged:"mediaqualitychanged",MediaSourceRecovered:"mediasourcerecovered",Metadata:"metadata",Midpoint:"midpoint",NoSpatialVideoInfoEvent:"nospatialvideoinfo",OnStateChange:"onstatechange",RateChange:"ratechange",SegmentAppended:"segmentappended",SessionDataEvent:"sessiondata",SpatialVideoInfoEvent:"spatialvideoinfo",StallDetected:"stalldetected",Started:"started",StateChanged:"statechanged",Streaming:"streaming",TextChanged:"textchanged",TextTrackVisibility:"texttrackvisibility",ThirdQuartile:"thirdquartile",TimelineRegionAdded:"timelineregionadded",TimelineRegionEnter:"timelineregionenter",TimelineRegionExit:"timelineregionexit",TracksChanged:"trackschanged",Unloading:"unloading",VariantChanged:"variantchanged"},shaka.util.FakeEventTarget=function(){this.listeners_=new shaka.util.MultiMap,this.dispatchTarget=this},shaka.util.FakeEventTarget.prototype.addEventListener=function(e,t,r){this.listeners_&&this.listeners_.push(e,t)},shaka.util.FakeEventTarget.prototype.listenToAllEvents=function(e){this.addEventListener(shaka.util.FakeEventTarget.ALL_EVENTS_,e)},shaka.util.FakeEventTarget.prototype.removeEventListener=function(e,t,r){this.listeners_&&this.listeners_.remove(e,t)},shaka.util.FakeEventTarget.prototype.dispatchEvent=function(e){if(goog.asserts.assert(e instanceof shaka.util.FakeEvent,"FakeEventTarget can only dispatch FakeEvents!"),!this.listeners_)return!0;var t=this.listeners_.get(e.type)||[],r=this.listeners_.get(shaka.util.FakeEventTarget.ALL_EVENTS_);for(r&&(t=t.concat(r)),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next()){r=r.value,e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;try{r.handleEvent?r.handleEvent(e):r.call(this,e)}catch(e){shaka.log.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.stopped)break}return e.defaultPrevented},shaka.util.FakeEventTarget.prototype.release=function(){this.listeners_=null},shaka.util.FakeEventTarget.ALL_EVENTS_="All",shaka.util.OperationManager=function(){this.operations_=[]},shaka.util.OperationManager.prototype.manage=function(e){var t=this;this.operations_.push(e.finally((function(){shaka.util.ArrayUtils.remove(t.operations_,e)})))},shaka.util.OperationManager.prototype.destroy=function(){for(var e=[],t=$jscomp.makeIterator(this.operations_),r=t.next();!r.done;r=t.next())(r=r.value).promise.catch((function(){})),e.push(r.abort());return this.operations_=[],Promise.all(e)},shaka.net.NetworkingEngine=function(e,t,r,n,a,i,s){shaka.util.FakeEventTarget.call(this),this.destroyed_=!1,this.operationManager_=new shaka.util.OperationManager,this.requestFilters_=new Set,this.responseFilters_=new Set,this.onProgressUpdated_=e||null,this.onHeadersReceived_=t||null,this.onDownloadCompleted_=r||null,this.onDownloadFailed_=n||null,this.onRequest_=a||null,this.onRetry_=i||null,this.onResponse_=s||null,this.forceHTTPS_=this.forceHTTP_=!1,this.minBytesForProgressEvents_=16e3,this.hostCommonAccessTokenMap_=new Map},$jscomp.inherits(shaka.net.NetworkingEngine,shaka.util.FakeEventTarget),shaka.net.NetworkingEngine.prototype.setForceHTTP=function(e){this.forceHTTP_=e},shaka.net.NetworkingEngine.prototype.setForceHTTPS=function(e){this.forceHTTPS_=e},shaka.net.NetworkingEngine.prototype.setMinBytesForProgressEvents=function(e){this.minBytesForProgressEvents_=e},shaka.net.NetworkingEngine.registerScheme=function(e,t,r,n){n=void 0!==n&&n,goog.asserts.assert(null==r||0<r,"explicit priority must be > 0"),r=r||shaka.net.NetworkingEngine.PluginPriority.APPLICATION;var a=shaka.net.NetworkingEngine.schemes_.get(e);(!a||r>=a.priority)&&shaka.net.NetworkingEngine.schemes_.set(e,{priority:r,plugin:t,progressSupport:n})},shaka.net.NetworkingEngine.unregisterScheme=function(e){shaka.net.NetworkingEngine.schemes_.delete(e)},shaka.net.NetworkingEngine.prototype.copyFiltersInto=function(e){for(var t=$jscomp.makeIterator(this.requestFilters_),r=t.next();!r.done;r=t.next())e.requestFilters_.add(r.value);for(r=(t=$jscomp.makeIterator(this.responseFilters_)).next();!r.done;r=t.next())e.responseFilters_.add(r.value)},shaka.net.NetworkingEngine.prototype.registerRequestFilter=function(e){this.requestFilters_.add(e)},shaka.net.NetworkingEngine.prototype.unregisterRequestFilter=function(e){this.requestFilters_.delete(e)},shaka.net.NetworkingEngine.prototype.clearAllRequestFilters=function(){this.requestFilters_.clear()},shaka.net.NetworkingEngine.prototype.registerResponseFilter=function(e){this.responseFilters_.add(e)},shaka.net.NetworkingEngine.prototype.unregisterResponseFilter=function(e){this.responseFilters_.delete(e)},shaka.net.NetworkingEngine.prototype.clearAllResponseFilters=function(){this.responseFilters_.clear()},shaka.net.NetworkingEngine.prototype.clearCommonAccessTokenMap=function(){this.hostCommonAccessTokenMap_.clear()},shaka.net.NetworkingEngine.defaultRetryParameters=function(){return shaka.net.Backoff.defaultRetryParameters()},shaka.net.NetworkingEngine.makeRequest=function(e,t,r){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===r?null:r}},shaka.net.NetworkingEngine.prototype.destroy=function(){return this.destroyed_=!0,this.requestFilters_.clear(),this.responseFilters_.clear(),this.hostCommonAccessTokenMap_.clear(),shaka.util.FakeEventTarget.prototype.release.call(this),this.operationManager_.destroy()},shaka.net.NetworkingEngine.prototype.request=function(e,t,r){var n=this,a=shaka.util.ObjectUtils,i=new shaka.net.NetworkingEngine.NumBytesRemainingClass;if(this.destroyed_)return(a=Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED))).catch((function(){})),new shaka.net.NetworkingEngine.PendingRequest(a,(function(){return Promise.resolve()}),i);goog.asserts.assert(t.uris&&t.uris.length,"Request without URIs!"),t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?a.cloneObject(t.retryParameters):shaka.net.NetworkingEngine.defaultRetryParameters(),t.uris=a.cloneObject(t.uris);var s=(a=this.filterRequest_(e,t,r)).chain((function(){return n.makeRequestWithRetry_(e,t,r,i)})),o=s.chain((function(t){return n.filterResponse_(e,t,r)})),l=Date.now(),u=0;a.promise.then((function(){u=Date.now()-l}),(function(){}));var c=0;s.promise.then((function(){c=Date.now()}),(function(){}));var d=o.chain((function(a){var i=Date.now()-c,s=a.response;return s.timeMs+=u,s.timeMs+=i,a.gotProgress||!n.onProgressUpdated_||s.fromCache||"HEAD"==t.method||e!=shaka.net.NetworkingEngine.RequestType.SEGMENT||(a=n.allowSwitch_(r),n.onProgressUpdated_(s.timeMs,s.data.byteLength,a)),n.onResponse_&&n.onResponse_(e,s,r),s}),(function(e){throw e&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type"),e.severity=shaka.util.Error.Severity.CRITICAL),e}));return a=new shaka.net.NetworkingEngine.PendingRequest(d.promise,(function(){return d.abort()}),i),this.operationManager_.manage(a),a},shaka.net.NetworkingEngine.prototype.filterRequest_=function(e,t,r){var n=shaka.util.AbortableOperation.completed(void 0),a=function(a){n=n.chain((function(){return t.body&&(t.body=shaka.util.BufferUtils.toArrayBuffer(t.body)),a(e,t,r)}))};this.onRequest_&&a(this.onRequest_);for(var i=$jscomp.makeIterator(this.requestFilters_),s=i.next();!s.done;s=i.next())a(s.value);return n.chain(void 0,(function(e){if(e instanceof shaka.util.Error&&e.code==shaka.util.Error.Code.OPERATION_ABORTED)throw e;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.REQUEST_FILTER_ERROR,e)}))},shaka.net.NetworkingEngine.prototype.makeRequestWithRetry_=function(e,t,r,n){var a=new shaka.net.Backoff(t.retryParameters,!1);return this.send_(e,t,r,a,0,null,n)},shaka.net.NetworkingEngine.prototype.send_=function(e,t,r,n,a,i,s){var o=this;this.forceHTTP_&&(t.uris[a]=t.uris[a].replace("https://","http://")),this.forceHTTPS_&&(t.uris[a]=t.uris[a].replace("http://","https://")),0<a&&this.onRetry_&&this.onRetry_(e,r,t.uris[a],t.uris[a-1]);var l=new goog.Uri(t.uris[a]),u=l.getScheme(),c=!1;u||(u=shaka.net.NetworkingEngine.getLocationProtocol_(),goog.asserts.assert(":"==u[u.length-1],"location.protocol expected to end with a colon!"),u=u.slice(0,-1),l.setScheme(u),t.uris[a]=l.toString()),u=u.toLowerCase();var d=(u=shaka.net.NetworkingEngine.schemes_.get(u))?u.plugin:null;if(!d)return shaka.util.AbortableOperation.failed(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.UNSUPPORTED_SCHEME,l));var p=u.progressSupport;(l=this.hostCommonAccessTokenMap_.get(l.getDomain()))&&(t.headers[shaka.net.NetworkingEngine.CommonAccessTokenHeaderName_]=l);var h,f=null,m=null,g=!1,y=!1;return shaka.util.AbortableOperation.notAbortable(n.attempt()).chain((function(){if(o.destroyed_)return shaka.util.AbortableOperation.aborted();h=Date.now();var n=shaka.net.NetworkingEngine.RequestType.SEGMENT,i=0;t.requestStartTime=Date.now();var l=d(t.uris[a],t,e,(function(a,l,u){if(f&&f.stop(),m&&m.tickAfter(v/1e3),o.onProgressUpdated_&&e==n){i++,t.packetNumber=i;var d=o.allowSwitch_(r);o.onProgressUpdated_(a,l,d,t),c=!0,s.setBytes(u)}}),(function(r){y=!0,t.timeToFirstByte=Date.now()-t.requestStartTime,o.onHeadersReceived_&&o.onHeadersReceived_(r,t,e)}),{minBytesForProgressEvents:o.minBytesForProgressEvents_});if(!p)return l;var u=t.retryParameters.connectionTimeout;u&&(f=new shaka.util.Timer((function(){g=!0,l.abort()}))).tickAfter(u/1e3);var v=t.retryParameters.stallTimeout;return v&&(m=new shaka.util.Timer((function(){g=!0,l.abort()}))),l})).chain((function(r){f&&f.stop(),m&&m.stop(),null==r.timeMs&&(r.timeMs=Date.now()-h);var n=r.headers[shaka.net.NetworkingEngine.CommonAccessTokenHeaderName_];if(n){var a=new goog.Uri(r.uri);o.hostCommonAccessTokenMap_.set(a.getDomain(),n)}return n={response:r,gotProgress:c},!y&&o.onHeadersReceived_&&o.onHeadersReceived_(r.headers,t,e),o.onDownloadCompleted_&&o.onDownloadCompleted_(t,r),n}),(function(l){if(f&&f.stop(),m&&m.stop(),o.onDownloadFailed_){var u=null,c=0;l instanceof shaka.util.Error&&(u=l,l.code==shaka.util.Error.Code.BAD_HTTP_STATUS&&(c=l.data[1])),o.onDownloadFailed_(t,u,c,g)}if(o.destroyed_)return shaka.util.AbortableOperation.aborted();if(g&&(l=new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,t.uris[a],e)),l instanceof shaka.util.Error){if(l.code==shaka.util.Error.Code.OPERATION_ABORTED)throw l;if(l.code==shaka.util.Error.Code.ATTEMPTS_EXHAUSTED)throw goog.asserts.assert(i,"Should have last error"),i;if(l.severity==shaka.util.Error.Severity.RECOVERABLE){if(u=(new Map).set("error",l),(u=new shaka.util.FakeEvent("retry",u)).cancelable=!0,o.dispatchEvent(u),u.defaultPrevented)throw l;return a=(a+1)%t.uris.length,o.send_(e,t,r,n,a,l,s)}}throw l}))},shaka.net.NetworkingEngine.prototype.filterResponse_=function(e,t,r){for(var n=shaka.util.AbortableOperation.completed(void 0),a=$jscomp.makeIterator(this.responseFilters_),i=a.next(),s={};!i.done;s={responseFilter:void 0},i=a.next())s.responseFilter=i.value,n=n.chain(function(n){return function(){var a=t.response;return a.data&&(a.data=shaka.util.BufferUtils.toArrayBuffer(a.data)),(0,n.responseFilter)(e,a,r)}}(s));return n.chain((function(){return t}),(function(e){var t=shaka.util.Error.Severity.CRITICAL;if(e instanceof shaka.util.Error){if(e.code==shaka.util.Error.Code.OPERATION_ABORTED)throw e;t=e.severity}throw new shaka.util.Error(t,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.RESPONSE_FILTER_ERROR,e)}))},shaka.net.NetworkingEngine.prototype.allowSwitch_=function(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.isPartial())return!1}return!0},shaka.net.NetworkingEngine.getLocationProtocol_=function(){return location.protocol},goog.exportSymbol("shaka.net.NetworkingEngine",shaka.net.NetworkingEngine),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"request",shaka.net.NetworkingEngine.prototype.request),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"destroy",shaka.net.NetworkingEngine.prototype.destroy),goog.exportProperty(shaka.net.NetworkingEngine,"makeRequest",shaka.net.NetworkingEngine.makeRequest),goog.exportProperty(shaka.net.NetworkingEngine,"defaultRetryParameters",shaka.net.NetworkingEngine.defaultRetryParameters),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"clearCommonAccessTokenMap",shaka.net.NetworkingEngine.prototype.clearCommonAccessTokenMap),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"clearAllResponseFilters",shaka.net.NetworkingEngine.prototype.clearAllResponseFilters),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"unregisterResponseFilter",shaka.net.NetworkingEngine.prototype.unregisterResponseFilter),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"registerResponseFilter",shaka.net.NetworkingEngine.prototype.registerResponseFilter),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"clearAllRequestFilters",shaka.net.NetworkingEngine.prototype.clearAllRequestFilters),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"unregisterRequestFilter",shaka.net.NetworkingEngine.prototype.unregisterRequestFilter),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"registerRequestFilter",shaka.net.NetworkingEngine.prototype.registerRequestFilter),goog.exportProperty(shaka.net.NetworkingEngine,"unregisterScheme",shaka.net.NetworkingEngine.unregisterScheme),goog.exportProperty(shaka.net.NetworkingEngine,"registerScheme",shaka.net.NetworkingEngine.registerScheme),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"setForceHTTPS",shaka.net.NetworkingEngine.prototype.setForceHTTPS),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"setForceHTTP",shaka.net.NetworkingEngine.prototype.setForceHTTP),shaka.net.NetworkingEngine.NumBytesRemainingClass=function(){this.bytesToLoad_=0},shaka.net.NetworkingEngine.NumBytesRemainingClass.prototype.setBytes=function(e){this.bytesToLoad_=e},shaka.net.NetworkingEngine.NumBytesRemainingClass.prototype.getBytes=function(){return this.bytesToLoad_},goog.exportProperty(shaka.net.NetworkingEngine,"NumBytesRemainingClass",shaka.net.NetworkingEngine.NumBytesRemainingClass),shaka.net.NetworkingEngine.PendingRequest=function(e,t,r){shaka.util.AbortableOperation.call(this,e,t),this.bytesRemaining_=r},$jscomp.inherits(shaka.net.NetworkingEngine.PendingRequest,shaka.util.AbortableOperation),shaka.net.NetworkingEngine.PendingRequest.prototype.getBytesRemaining=function(){return this.bytesRemaining_.getBytes()},goog.exportProperty(shaka.net.NetworkingEngine,"PendingRequest",shaka.net.NetworkingEngine.PendingRequest),shaka.net.NetworkingEngine.CommonAccessTokenHeaderName_="common-access-token",shaka.net.NetworkingEngine.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8},goog.exportProperty(shaka.net.NetworkingEngine,"RequestType",shaka.net.NetworkingEngine.RequestType),shaka.net.NetworkingEngine.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5,MPD_PATCH:6,MEDIATAILOR_SESSION_INFO:7,MEDIATAILOR_TRACKING_INFO:8,MEDIATAILOR_STATIC_RESOURCE:9,MEDIATAILOR_TRACKING_EVENT:10,INTERSTITIAL_ASSET_LIST:11,INTERSTITIAL_AD_URL:12},goog.exportProperty(shaka.net.NetworkingEngine,"AdvancedRequestType",shaka.net.NetworkingEngine.AdvancedRequestType),shaka.net.NetworkingEngine.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3},goog.exportProperty(shaka.net.NetworkingEngine,"PluginPriority",shaka.net.NetworkingEngine.PluginPriority),shaka.net.NetworkingEngine.schemes_=new Map,shaka.util.Destroyer=function(e){this.destroyed_=!1,this.waitOnDestroy_=new shaka.util.PublicPromise,this.onDestroy_=e},shaka.util.Destroyer.prototype.destroyed=function(){return this.destroyed_},shaka.util.Destroyer.prototype.destroy=function(){var e=this;return this.destroyed_?this.waitOnDestroy_:(this.destroyed_=!0,this.onDestroy_().then((function(){e.waitOnDestroy_.resolve()}),(function(){e.waitOnDestroy_.resolve()})))},shaka.util.Destroyer.prototype.ensureNotDestroyed=function(e){if(this.destroyed_){if(e instanceof shaka.util.Error&&e.code==shaka.util.Error.Code.OBJECT_DESTROYED)throw e;throw shaka.util.Destroyer.destroyedError(e)}},shaka.util.Destroyer.destroyedError=function(e){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OBJECT_DESTROYED,e)},shaka.util.Iterables=function(){},shaka.util.Iterables.map=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())r.push(t(n.value));return r},shaka.util.Iterables.every=function(e,t){for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if(!t(r.value))return!1;return!0},shaka.util.Iterables.some=function(e,t){for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if(t(r.value))return!0;return!1},shaka.util.Iterables.filter=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())t(n=n.value)&&r.push(n);return r},shaka.util.MapUtils=function(){},shaka.util.MapUtils.asMap=function(e){for(var t=new Map,r=$jscomp.makeIterator(Object.keys(e)),n=r.next();!n.done;n=r.next())n=n.value,t.set(n,e[n]);return t},shaka.util.MapUtils.asObject=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},shaka.util.MapUtils.hasSameElements=function(e,t){if(!e&&!t)return!0;if(e&&!t||t&&!e)return!1;if(e.size!=t.size)return!1;for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var n=$jscomp.makeIterator(r.value);if(r=n.next().value,n=n.next().value,!t.has(r))return!1;if((r=t.get(r))!=n||null==r)return!1}return!0},shaka.util.DataViewReader=function(e,t){this.dataView_=shaka.util.BufferUtils.toDataView(e),this.littleEndian_=t==shaka.util.DataViewReader.Endianness.LITTLE_ENDIAN,this.position_=0},shaka.util.DataViewReader.prototype.getDataView=function(){return this.dataView_},shaka.util.DataViewReader.prototype.hasMoreData=function(){return this.position_<this.dataView_.byteLength},shaka.util.DataViewReader.prototype.getPosition=function(){return this.position_},shaka.util.DataViewReader.prototype.getLength=function(){return this.dataView_.byteLength},shaka.util.DataViewReader.prototype.readUint8=function(){try{var e=this.dataView_.getUint8(this.position_);return this.position_+=1,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readUint16=function(){try{var e=this.dataView_.getUint16(this.position_,this.littleEndian_);return this.position_+=2,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readUint32=function(){try{var e=this.dataView_.getUint32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readInt32=function(){try{var e=this.dataView_.getInt32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readUint64=function(){try{if(this.littleEndian_)var e=this.dataView_.getUint32(this.position_,!0),t=this.dataView_.getUint32(this.position_+4,!0);else t=this.dataView_.getUint32(this.position_,!1),e=this.dataView_.getUint32(this.position_+4,!1)}catch(e){throw this.outOfBounds_()}if(2097151<t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.JS_INTEGER_OVERFLOW);return this.position_+=8,t*Math.pow(2,32)+e},shaka.util.DataViewReader.prototype.readBytes=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.readBytes"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();var t=shaka.util.BufferUtils.toUint8(this.dataView_,this.position_,e);return this.position_+=e,t},shaka.util.DataViewReader.prototype.skip=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.skip"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_+=e},shaka.util.DataViewReader.prototype.rewind=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.rewind"),this.position_<e)throw this.outOfBounds_();this.position_-=e},shaka.util.DataViewReader.prototype.seek=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.seek"),0>e||e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_=e},shaka.util.DataViewReader.prototype.readTerminatedString=function(){for(var e=this.position_;this.hasMoreData()&&0!=this.dataView_.getUint8(this.position_);)this.position_+=1;return e=shaka.util.BufferUtils.toUint8(this.dataView_,e,this.position_-e),this.position_+=1,shaka.util.StringUtils.fromUTF8(e)},shaka.util.DataViewReader.prototype.outOfBounds_=function(){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS)},goog.exportSymbol("shaka.util.DataViewReader",shaka.util.DataViewReader),goog.exportProperty(shaka.util.DataViewReader.prototype,"readTerminatedString",shaka.util.DataViewReader.prototype.readTerminatedString),goog.exportProperty(shaka.util.DataViewReader.prototype,"seek",shaka.util.DataViewReader.prototype.seek),goog.exportProperty(shaka.util.DataViewReader.prototype,"rewind",shaka.util.DataViewReader.prototype.rewind),goog.exportProperty(shaka.util.DataViewReader.prototype,"skip",shaka.util.DataViewReader.prototype.skip),goog.exportProperty(shaka.util.DataViewReader.prototype,"readBytes",shaka.util.DataViewReader.prototype.readBytes),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint64",shaka.util.DataViewReader.prototype.readUint64),goog.exportProperty(shaka.util.DataViewReader.prototype,"readInt32",shaka.util.DataViewReader.prototype.readInt32),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint32",shaka.util.DataViewReader.prototype.readUint32),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint16",shaka.util.DataViewReader.prototype.readUint16),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint8",shaka.util.DataViewReader.prototype.readUint8),goog.exportProperty(shaka.util.DataViewReader.prototype,"getLength",shaka.util.DataViewReader.prototype.getLength),goog.exportProperty(shaka.util.DataViewReader.prototype,"getPosition",shaka.util.DataViewReader.prototype.getPosition),goog.exportProperty(shaka.util.DataViewReader.prototype,"hasMoreData",shaka.util.DataViewReader.prototype.hasMoreData),shaka.util.DataViewReader.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:1},goog.exportProperty(shaka.util.DataViewReader,"Endianness",shaka.util.DataViewReader.Endianness),shaka.util.Mp4Parser=function(){this.headers_=new Map,this.boxDefinitions_=new Map,this.done_=!1},shaka.util.Mp4Parser.prototype.box=function(e,t){return e=shaka.util.Mp4Parser.typeFromString_(e),this.headers_.set(e,shaka.util.Mp4Parser.BoxType_.BASIC_BOX),this.boxDefinitions_.set(e,t),this},shaka.util.Mp4Parser.prototype.fullBox=function(e,t){return e=shaka.util.Mp4Parser.typeFromString_(e),this.headers_.set(e,shaka.util.Mp4Parser.BoxType_.FULL_BOX),this.boxDefinitions_.set(e,t),this},shaka.util.Mp4Parser.prototype.stop=function(){this.done_=!0};shaka.util.Mp4Parser.prototype.parse=function(e,t,r){for(e=new shaka.util.DataViewReader(e,shaka.util.DataViewReader.Endianness.BIG_ENDIAN),this.done_=!1;e.hasMoreData()&&!this.done_;)this.parseNext(0,e,t,r)},shaka.util.Mp4Parser.prototype.parseNext=function(e,t,r,n){var a=t.getPosition();if(n&&a+8>t.getLength())this.done_=!0;else{var i=t.readUint32(),s=t.readUint32(),o=shaka.util.Mp4Parser.typeToString(s),l=!1;switch(shaka.log.v2("Parsing MP4 box",o),i){case 0:i=t.getLength()-a;break;case 1:if(n&&t.getPosition()+8>t.getLength())return void(this.done_=!0);i=t.readUint64(),l=!0}var u=this.boxDefinitions_.get(s);if(u){var c=null,d=null;if(this.headers_.get(s)==shaka.util.Mp4Parser.BoxType_.FULL_BOX){if(n&&t.getPosition()+4>t.getLength())return void(this.done_=!0);c=(d=t.readUint32())>>>24,d&=16777215}s=a+i,r&&s>t.getLength()&&(s=t.getLength()),n&&s>t.getLength()?this.done_=!0:(n=s-t.getPosition(),t=0<n?t.readBytes(n):new Uint8Array(0),u({name:o,parser:this,partialOkay:r||!1,version:c,flags:d,reader:t=new shaka.util.DataViewReader(t,shaka.util.DataViewReader.Endianness.BIG_ENDIAN),size:i,start:a+e,has64BitSize:l}))}else e=Math.min(a+i-t.getPosition(),t.getLength()-t.getPosition()),t.skip(e)}},shaka.util.Mp4Parser.children=function(e){for(var t=shaka.util.Mp4Parser.headerSize(e);e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)},shaka.util.Mp4Parser.sampleDescription=function(e){for(var t=shaka.util.Mp4Parser.headerSize(e),r=e.reader.readUint32(),n=0;n<r&&(e.parser.parseNext(e.start+t,e.reader,e.partialOkay),!e.parser.done_);n++);},shaka.util.Mp4Parser.visualSampleEntry=function(e){var t=shaka.util.Mp4Parser.headerSize(e);for(e.reader.skip(78);e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)},shaka.util.Mp4Parser.audioSampleEntry=function(e){var t=shaka.util.Mp4Parser.headerSize(e);e.reader.skip(8);var r=e.reader.readUint16();for(e.reader.skip(6),2==r?e.reader.skip(48):e.reader.skip(12),1==r&&e.reader.skip(16);e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)},shaka.util.Mp4Parser.allData=function(e){return function(t){var r=t.reader.getLength()-t.reader.getPosition();e(t.reader.readBytes(r))}},shaka.util.Mp4Parser.typeFromString_=function(e){goog.asserts.assert(4==e.length,"Mp4 box names must be 4 characters long");for(var t=0,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())t=t<<8|r.value.charCodeAt(0);return t},shaka.util.Mp4Parser.typeToString=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},shaka.util.Mp4Parser.headerSize=function(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)},goog.exportSymbol("shaka.util.Mp4Parser",shaka.util.Mp4Parser),goog.exportProperty(shaka.util.Mp4Parser,"headerSize",shaka.util.Mp4Parser.headerSize),goog.exportProperty(shaka.util.Mp4Parser,"typeToString",shaka.util.Mp4Parser.typeToString),goog.exportProperty(shaka.util.Mp4Parser,"allData",shaka.util.Mp4Parser.allData),goog.exportProperty(shaka.util.Mp4Parser,"audioSampleEntry",shaka.util.Mp4Parser.audioSampleEntry),goog.exportProperty(shaka.util.Mp4Parser,"visualSampleEntry",shaka.util.Mp4Parser.visualSampleEntry),goog.exportProperty(shaka.util.Mp4Parser,"sampleDescription",shaka.util.Mp4Parser.sampleDescription),goog.exportProperty(shaka.util.Mp4Parser,"children",shaka.util.Mp4Parser.children),goog.exportProperty(shaka.util.Mp4Parser.prototype,"parseNext",shaka.util.Mp4Parser.prototype.parseNext),goog.exportProperty(shaka.util.Mp4Parser.prototype,"parse",shaka.util.Mp4Parser.prototype.parse),goog.exportProperty(shaka.util.Mp4Parser.prototype,"stop",shaka.util.Mp4Parser.prototype.stop),goog.exportProperty(shaka.util.Mp4Parser.prototype,"fullBox",shaka.util.Mp4Parser.prototype.fullBox),goog.exportProperty(shaka.util.Mp4Parser.prototype,"box",shaka.util.Mp4Parser.prototype.box),shaka.util.Mp4Parser.BoxType_={BASIC_BOX:0,FULL_BOX:1},shaka.util.Pssh=function(e){var t=this;this.systemIds=[],this.cencKeyIds=[],this.data=[],(new shaka.util.Mp4Parser).box("moov",shaka.util.Mp4Parser.children).box("moof",shaka.util.Mp4Parser.children).fullBox("pssh",(function(e){return t.parsePsshBox_(e)})).parse(e),0==this.data.length&&shaka.log.v2("No pssh box found!")},shaka.util.Pssh.prototype.parsePsshBox_=function(e){if(goog.asserts.assert(null!=e.version,"PSSH boxes are full boxes and must have a valid version"),goog.asserts.assert(null!=e.flags,"PSSH boxes are full boxes and must have a valid flag"),1<e.version)shaka.log.warning("Unrecognized PSSH version found!");else{var t=e.reader.getDataView();if(goog.asserts.assert(12<=t.byteOffset,"DataView at incorrect position"),t=shaka.util.BufferUtils.toUint8(t,-12,e.size),this.data.push(t),this.systemIds.push(shaka.util.Uint8ArrayUtils.toHex(e.reader.readBytes(16))),0<e.version){t=e.reader.readUint32();for(var r=0;r<t;r++){var n=shaka.util.Uint8ArrayUtils.toHex(e.reader.readBytes(16));this.cencKeyIds.push(n)}}}},shaka.util.Pssh.createPssh=function(e,t,r,n){goog.asserts.assert(16==t.byteLength,"Invalid system ID length");var a=e.length,i=12+t.length+4+a;0<n&&(i+=4+16*r.size);var s=new Uint8Array(i),o=shaka.util.BufferUtils.toDataView(s),l=0;if(o.setUint32(l,i),l+=4,o.setUint32(l,1886614376),l+=4,1>n?o.setUint32(l,0):o.setUint32(l,16777216),l+=4,s.set(t,l),l+=t.length,0<n)for(o.setUint32(l,r.size),l+=4,t=shaka.util.Uint8ArrayUtils,n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next())n=t.fromHex(n.value),s.set(n,l),l+=n.length;return o.setUint32(l,a),l+=4,s.set(e,l),goog.asserts.assert(l+a===i,"PSSH invalid length."),s},shaka.util.Pssh.getPsshData=function(e){var t=8,r=(e=shaka.util.BufferUtils.toDataView(e)).getUint8(t);return t+=20,0<r&&(t+=4+16*e.getUint32(t)),shaka.util.BufferUtils.toUint8(e,t+4)},shaka.util.Pssh.normaliseInitData=function(e){if(!e)return e;var t=new shaka.util.Pssh(e);if(1>=t.data.length)return e;e=[];for(var r=(t=$jscomp.makeIterator(t.data)).next(),n={};!r.done;n={initData$jscomp$10:void 0},r=t.next())n.initData$jscomp$10=r.value,e.some(function(e){return function(t){return shaka.util.BufferUtils.equal(t,e.initData$jscomp$10)}}(n))||e.push(n.initData$jscomp$10);return shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(e))},shaka.drm.DrmEngine=function(e){var t=this;this.playerInterface_=e,this.video_=this.mediaKeys_=null,this.initializedForStorage_=this.initialized_=!1,this.licenseTimeSeconds_=0,this.currentDrmInfo_=null,this.eventManager_=new shaka.util.EventManager,this.activeSessions_=new Map,this.activeRequests_=[],this.storedPersistentSessions_=new Map,this.hasInitData_=!1,this.allSessionsLoaded_=new shaka.util.PublicPromise,this.config_=null,this.onError_=function(r){r.severity==shaka.util.Error.Severity.CRITICAL&&t.allSessionsLoaded_.reject(r),e.onError(r)},this.keyStatusByKeyId_=new Map,this.announcedKeyStatusByKeyId_=new Map,this.keyStatusTimer_=new shaka.util.Timer((function(){return t.processKeyStatusChanges_()})),this.usePersistentLicenses_=!1,this.mediaKeyMessageEvents_=[],this.initialRequestsSent_=!1,this.expirationTimer_=new shaka.util.Timer((function(){t.pollExpiration_()})),this.allSessionsLoaded_.catch((function(){})),this.destroyer_=new shaka.util.Destroyer((function(){return t.destroyNow_()})),this.srcEquals_=!1,this.manifestInitData_=this.mediaKeysAttached_=null,this.isPreload_=function(){return!1}},shaka.drm.DrmEngine.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.drm.DrmEngine.prototype.destroyNow_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:return t.eventManager_.release(),t.eventManager_=null,t.allSessionsLoaded_.reject(),t.expirationTimer_.stop(),t.expirationTimer_=null,t.keyStatusTimer_.stop(),t.keyStatusTimer_=null,r.yield(t.closeOpenSessions_(),2);case 2:if(!t.video_){r.jumpTo(3);break}return shaka.drm.DrmUtils.isMediaKeysPolyfilled("webkit")||goog.asserts.assert(!t.video_.src&&!t.video_.getElementsByTagName("source").length,"video src must be removed first!"),r.setCatchFinallyBlocks(4),r.yield(t.video_.setMediaKeys(null),6);case 6:r.leaveTryBlock(5);break;case 4:e=r.enterCatchBlock(),shaka.log.debug("DrmEngine.destroyNow_ exception",e);case 5:t.video_=null;case 3:t.currentDrmInfo_=null,t.mediaKeys_=null,t.storedPersistentSessions_=new Map,t.config_=null,t.onError_=function(){},t.playerInterface_=null,t.srcEquals_=!1,t.mediaKeysAttached_=null,r.jumpToEnd()}}))},shaka.drm.DrmEngine.prototype.configure=function(e,t){this.config_=e,t&&(this.isPreload_=t),this.expirationTimer_&&this.expirationTimer_.tickEvery(this.config_.updateExpirationTime)},shaka.drm.DrmEngine.prototype.setSrcEquals=function(e){this.srcEquals_=e},shaka.drm.DrmEngine.prototype.initForStorage=function(e,t){return this.initializedForStorage_=!0,this.storedPersistentSessions_=new Map,this.usePersistentLicenses_=t,this.init_(e,!1)},shaka.drm.DrmEngine.prototype.initForPlayback=function(e,t,r){r=void 0===r||r,this.storedPersistentSessions_=new Map;for(var n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next())this.storedPersistentSessions_.set(n.value,{initData:null,initDataType:null});for(n=(t=$jscomp.makeIterator(this.config_.persistentSessionsMetadata)).next();!n.done;n=t.next())n=n.value,this.storedPersistentSessions_.set(n.sessionId,{initData:n.initData,initDataType:n.initDataType});return this.usePersistentLicenses_=0<this.storedPersistentSessions_.size,this.init_(e,r)},shaka.drm.DrmEngine.prototype.initForRemoval=function(e,t,r,n,a){var i=new Map;return(n={audioCapabilities:n,videoCapabilities:a,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:e}).drmInfos=[{keySystem:e,licenseServerUri:t,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,serverCertificateUri:"",initData:null,keyIds:null}],i.set(e,n),this.queryMediaKeys_(i,[])},shaka.drm.DrmEngine.prototype.init_=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(b){if(1==b.nextAddress){for(goog.asserts.assert(E.config_,"DrmEngine configure() must be called before init()!"),shaka.drm.DrmEngine.configureClearKey(E.config_.clearKeys,e),!(r=e.some((function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)})))&&t&&(n=shaka.util.MapUtils.asMap(E.config_.servers),shaka.drm.DrmEngine.replaceDrmInfo_(e,n)),a=new Set,i=$jscomp.makeIterator(e),s=i.next();!s.done;s=i.next())for(o=s.value,l=E.getVariantDrmInfos_(o),u=$jscomp.makeIterator(l),c=u.next();!c.done;c=u.next())d=c.value,a.add(d);for(p=$jscomp.makeIterator(a),h=p.next();!h.done;h=p.next())f=h.value,shaka.drm.DrmEngine.fillInDrmInfoDefaults_(f,shaka.util.MapUtils.asMap(E.config_.servers),shaka.util.MapUtils.asMap(E.config_.advanced||{}),E.config_.keySystemsMapping);for(m=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){var a=(n=n.value)[t]||E.config_.advanced&&E.config_.advanced[n.keySystem]&&E.config_.advanced[n.keySystem][t]||"";if(""==a&&shaka.drm.DrmUtils.isWidevineKeySystem(n.keySystem)&&("audioRobustness"==t?a=[E.config_.defaultAudioRobustnessForWidevine]:"videoRobustness"==t&&(a=[E.config_.defaultVideoRobustnessForWidevine])),"string"==typeof a)r.push(n);else if(Array.isArray(a)){0===a.length&&(a=[""]);for(var i=(a=$jscomp.makeIterator(a)).next();!i.done;i=a.next()){var s={};r.push(Object.assign({},n,(s[t]=i.value,s)))}}}return r},g=new Set,y=$jscomp.makeIterator(e),v=y.next();!v.done;v=y.next())(_=v.value).video&&!g.has(_.video)&&(_.video.drmInfos=m(_.video.drmInfos,"videoRobustness"),_.video.drmInfos=m(_.video.drmInfos,"audioRobustness"),g.add(_.video)),_.audio&&!g.has(_.audio)&&(_.audio.drmInfos=m(_.audio.drmInfos,"videoRobustness"),_.audio.drmInfos=m(_.audio.drmInfos,"audioRobustness"),g.add(_.audio));return g.clear(),b.yield(shaka.util.StreamUtils.getDecodingInfosForVariants(e,E.usePersistentLicenses_,E.srcEquals_,E.config_.preferredKeySystems),2)}return E.destroyer_.ensureNotDestroyed(),r||Object.keys(E.config_.servers).length?(k=E.queryMediaKeys_(void 0,e),b.return(r?k:k.catch((function(){})))):(E.initialized_=!0,b.return(Promise.resolve()))}))},shaka.drm.DrmEngine.prototype.attachMediaKeys_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:if(t.video_.mediaKeys)return r.return();if(!t.mediaKeysAttached_){r.jumpTo(2);break}return r.yield(t.mediaKeysAttached_,3);case 3:return t.destroyer_.ensureNotDestroyed(),r.return();case 2:return r.setCatchFinallyBlocks(4),t.mediaKeysAttached_=t.video_.setMediaKeys(t.mediaKeys_),r.yield(t.mediaKeysAttached_,6);case 6:r.leaveTryBlock(5);break;case 4:e=r.enterCatchBlock(),goog.asserts.assert(e instanceof Error,"Wrong error type!"),t.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_ATTACH_TO_VIDEO,e.message));case 5:t.destroyer_.ensureNotDestroyed(),r.jumpToEnd()}}))},shaka.drm.DrmEngine.prototype.onEncryptedEvent_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(t.attachMediaKeys_(),2);t.newInitData(e.initDataType,shaka.util.BufferUtils.toUint8(e.initData)),r.jumpToEnd()}))},shaka.drm.DrmEngine.prototype.attach=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return t.video_===e?r.return():t.mediaKeys_?(t.video_=e,t.eventManager_.listenOnce(t.video_,"play",(function(){return t.onPlay_()})),t.video_.remote?(t.eventManager_.listen(t.video_.remote,"connect",(function(){return t.closeOpenSessions_()})),t.eventManager_.listen(t.video_.remote,"connecting",(function(){return t.closeOpenSessions_()})),t.eventManager_.listen(t.video_.remote,"disconnect",(function(){return t.closeOpenSessions_()}))):"webkitCurrentPlaybackTargetIsWireless"in t.video_&&t.eventManager_.listen(t.video_,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return t.closeOpenSessions_()})),t.manifestInitData_=t.currentDrmInfo_&&t.currentDrmInfo_.initData.find((function(e){return 0<e.initData.length}))||null,t.manifestInitData_||"com.apple.fps"!==t.currentDrmInfo_.keySystem||t.storedPersistentSessions_.size?r.yield(t.attachMediaKeys_(),2):r.jumpTo(2)):(t.eventManager_.listenOnce(e,"encrypted",(function(e){t.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.ENCRYPTED_CONTENT_WITHOUT_DRM_INFO))})),r.return());t.createOrLoad().catch((function(){})),t.manifestInitData_||t.storedPersistentSessions_.size||t.config_.parseInbandPsshEnabled||t.eventManager_.listen(t.video_,"encrypted",(function(e){return t.onEncryptedEvent_(e)})),r.jumpToEnd()}))},shaka.drm.DrmEngine.prototype.hasManifestInitData=function(){return!!this.manifestInitData_},shaka.drm.DrmEngine.prototype.setServerCertificate=function(){var e,t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:if(goog.asserts.assert(i.initialized_,"Must call init() before setServerCertificate"),!i.mediaKeys_||!i.currentDrmInfo_)return s.return();if(!i.currentDrmInfo_.serverCertificateUri||i.currentDrmInfo_.serverCertificate&&i.currentDrmInfo_.serverCertificate.length){s.jumpTo(2);break}return e=shaka.net.NetworkingEngine.makeRequest([i.currentDrmInfo_.serverCertificateUri],i.config_.retryParameters),s.setCatchFinallyBlocks(3),t=i.playerInterface_.netEngine.request(shaka.net.NetworkingEngine.RequestType.SERVER_CERTIFICATE,e,{isPreload:i.isPreload_()}),s.yield(t.promise,5);case 5:r=s.yieldResult,i.currentDrmInfo_.serverCertificate=shaka.util.BufferUtils.toUint8(r.data),s.leaveTryBlock(4);break;case 3:throw n=s.enterCatchBlock(),goog.asserts.assert(n instanceof shaka.util.Error,"Wrong NetworkingEngine error type!"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.SERVER_CERTIFICATE_REQUEST_FAILED,n);case 4:if(i.destroyer_.destroyed())return s.return();case 2:return i.currentDrmInfo_.serverCertificate&&i.currentDrmInfo_.serverCertificate.length?(s.setCatchFinallyBlocks(6),s.yield(i.mediaKeys_.setServerCertificate(i.currentDrmInfo_.serverCertificate),8)):s.return();case 8:s.yieldResult||shaka.log.warning("Server certificates are not supported by the key system.  The server certificate has been ignored."),s.leaveTryBlock(0);break;case 6:throw a=s.enterCatchBlock(),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.INVALID_SERVER_CERTIFICATE,a.message)}}))},shaka.drm.DrmEngine.prototype.removeSession=function(e){var t,r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(goog.asserts.assert(a.mediaKeys_,"Must call init() before removeSession"),i.yield(a.loadOfflineSession_(e,{initData:null,initDataType:null}),2)):3!=i.nextAddress?(t=i.yieldResult)?(r=[],(n=a.activeSessions_.get(t))&&(n.updatePromise=new shaka.util.PublicPromise,r.push(n.updatePromise)),shaka.log.v2("Attempting to remove session",e),r.push(t.remove()),i.yield(Promise.all(r),3)):(shaka.log.v2("Ignoring attempt to remove missing session",e),i.return()):(a.activeSessions_.delete(t),void i.jumpToEnd())}))},shaka.drm.DrmEngine.prototype.createOrLoad=function(){var e,t,r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){if(1==i.nextAddress)return a.storedPersistentSessions_.size?(a.storedPersistentSessions_.forEach((function(e,t){a.loadOfflineSession_(t,e)})),i.yield(a.allSessionsLoaded_,3)):i.jumpTo(2);if(2!=i.nextAddress){if(0<(a.currentDrmInfo_&&a.currentDrmInfo_.keyIds||new Set([])).size&&a.areAllKeysUsable_())return i.return(a.allSessionsLoaded_);a.hasInitData_=!1,a.allSessionsLoaded_=new shaka.util.PublicPromise,a.allSessionsLoaded_.catch((function(){}))}for(e=(a.currentDrmInfo_?a.currentDrmInfo_.initData:[])||[],t=$jscomp.makeIterator(e),r=t.next();!r.done;r=t.next())n=r.value,a.newInitData(n.initDataType,n.initData);return a.areAllSessionsLoaded_()&&a.allSessionsLoaded_.resolve(),i.return(a.allSessionsLoaded_)}))},shaka.drm.DrmEngine.prototype.newInitData=function(e,t){if(t.length){if(this.config_.ignoreDuplicateInitData){for(var r=this.activeSessions_.values(),n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next())if(shaka.util.BufferUtils.equal(t,n.value.initData))return void shaka.log.debug("Ignoring duplicate init data.");var a=!1;if(this.storedPersistentSessions_.forEach((function(e,r){!a&&shaka.util.BufferUtils.equal(t,e.initData)&&(a=!0)})),a)return void shaka.log.debug("Ignoring duplicate init data.")}this.hasInitData_=!0,0<this.activeSessions_.size&&this.areAllSessionsLoaded_()&&(this.allSessionsLoaded_.resolve(),this.hasInitData_=!1,this.allSessionsLoaded_=new shaka.util.PublicPromise,this.allSessionsLoaded_.catch((function(){}))),this.createSession(e,t,this.currentDrmInfo_.sessionType)}},shaka.drm.DrmEngine.prototype.initialized=function(){return this.initialized_},shaka.drm.DrmEngine.prototype.getSessionIds=function(){var e=this.activeSessions_.keys();return e=shaka.util.Iterables.map(e,(function(e){return e.sessionId})),Array.from(e)},shaka.drm.DrmEngine.prototype.getActiveSessionsMetadata=function(){var e=this,t=this.activeSessions_.keys();return t=shaka.util.Iterables.map(t,(function(t){var r=e.activeSessions_.get(t);return{sessionId:t.sessionId,sessionType:r.type,initData:r.initData,initDataType:r.initDataType}})),Array.from(t)},shaka.drm.DrmEngine.prototype.getExpiration=function(){for(var e=1/0,t=this.activeSessions_.keys(),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=r.value,isNaN(r.expiration)||(e=Math.min(e,r.expiration));return e},shaka.drm.DrmEngine.prototype.getLicenseTime=function(){return this.licenseTimeSeconds_?this.licenseTimeSeconds_:NaN},shaka.drm.DrmEngine.prototype.getDrmInfo=function(){return this.currentDrmInfo_},shaka.drm.DrmEngine.prototype.getMediaKeys=function(){return this.mediaKeys_},shaka.drm.DrmEngine.prototype.getKeyStatuses=function(){return shaka.util.MapUtils.asObject(this.announcedKeyStatusByKeyId_)},shaka.drm.DrmEngine.prototype.getMediaKeySessions=function(){return Array.from(this.activeSessions_.keys())},shaka.drm.DrmEngine.prototype.queryMediaKeys_=function(e,t){var r,n,a,i,s,o,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:if(r=new Map,t.length){n=c.getKeySystemAccessFromVariants_(t,r),d.jumpTo(2);break}return d.yield(c.getKeySystemAccessByConfigs_(e),3);case 3:n=d.yieldResult;case 2:if(!(a=n)){if(!navigator.requestMediaKeySystemAccess)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.MISSING_EME_SUPPORT);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE)}if(c.destroyer_.ensureNotDestroyed(),d.setCatchFinallyBlocks(4),i=a.getConfiguration(),shaka.log.v2("Got MediaKeySystemAccess with configuration",i),s=c.config_.keySystemsMapping[a.keySystem]||a.keySystem,c.currentDrmInfo_=t.length?c.createDrmInfoByInfos_(s,r.get(s)):shaka.drm.DrmEngine.createDrmInfoByConfigs_(s,e.get(s)),!c.currentDrmInfo_.licenseServerUri)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.NO_LICENSE_SERVER_GIVEN,c.currentDrmInfo_.keySystem);return d.yield(a.createMediaKeys(),6);case 6:if(o=d.yieldResult,c.destroyer_.ensureNotDestroyed(),shaka.log.info("Created MediaKeys object for key system",c.currentDrmInfo_.keySystem),c.mediaKeys_=o,""==c.config_.minHdcpVersion||!("getStatusForPolicy"in c.mediaKeys_)){d.jumpTo(7);break}return d.setCatchFinallyBlocks(8),d.yield(c.mediaKeys_.getStatusForPolicy({minHdcpVersion:c.config_.minHdcpVersion}),10);case 10:if("usable"!=d.yieldResult)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.MIN_HDCP_VERSION_NOT_MATCH);c.destroyer_.ensureNotDestroyed(),d.leaveTryBlock(7,4);break;case 8:if((l=d.enterCatchBlock(4))instanceof shaka.util.Error)throw l;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.ERROR_CHECKING_HDCP_VERSION,l.message);case 7:return c.initialized_=!0,d.yield(c.setServerCertificate(),11);case 11:c.destroyer_.ensureNotDestroyed(),d.leaveTryBlock(0);break;case 4:if(u=d.enterCatchBlock(),c.destroyer_.ensureNotDestroyed(u),c.currentDrmInfo_=null,u instanceof shaka.util.Error)throw u;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_CDM,u.message)}}))},shaka.drm.DrmEngine.prototype.getKeySystemAccessFromVariants_=function(e,t){for(var r=$jscomp.makeIterator(e),n=r.next();!n.done;n=r.next()){n=this.getVariantDrmInfos_(n.value);for(var a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next())a=a.value,t.has(a.keySystem)||t.set(a.keySystem,[]),t.get(a.keySystem).push(a)}if(1==t.size&&t.has(""))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.NO_RECOGNIZED_KEY_SYSTEMS);(r=this.config_.preferredKeySystems).length||1==(n=shaka.util.MapUtils.asMap(this.config_.servers)).size&&(r=Array.from(n.keys()));var i=(n=$jscomp.makeIterator(r)).next();for(a={};!i.done;a={preferredKeySystem$jscomp$1:void 0},i=n.next()){a.preferredKeySystem$jscomp$1=i.value;for(var s=(i=$jscomp.makeIterator(e)).next();!s.done;s=i.next())if(s=s.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.preferredKeySystem$jscomp$1}}(a)))return s.keySystemAccess}for(a=(n=$jscomp.makeIterator([!0,!1])).next();!a.done;a=n.next())for(a=a.value,s=(i=$jscomp.makeIterator(e)).next();!s.done;s=i.next())for(var o=(s=$jscomp.makeIterator(s.value.decodingInfos)).next();!o.done;o=s.next())if((o=o.value).supported&&o.keySystemAccess){var l=o.keySystemAccess.keySystem;if(!r.includes(l)){var u=t.get(l);for(!u&&this.config_.keySystemsMapping[l]&&(u=t.get(this.config_.keySystemsMapping[l])),u=(l=$jscomp.makeIterator(u)).next();!u.done;u=l.next())if(!!u.value.licenseServerUri==a)return o.keySystemAccess}}return null},shaka.drm.DrmEngine.prototype.getKeySystemAccessByConfigs_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:if(1==e.size&&e.has(""))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.NO_RECOGNIZED_KEY_SYSTEMS);for(r=$jscomp.makeIterator(e.values()),n=r.next();!n.done;n=r.next())0==(a=n.value).audioCapabilities.length&&delete a.audioCapabilities,0==a.videoCapabilities.length&&delete a.videoCapabilities;i=$jscomp.makeIterator(v.config_.preferredKeySystems),s=i.next();case 2:if(s.done){_.jumpTo(4);break}if(o=s.value,!e.has(o)){_.jumpTo(3);break}return l=e.get(o),_.setCatchFinallyBlocks(6),_.yield(navigator.requestMediaKeySystemAccess(o,[l]),8);case 8:return t=_.yieldResult,_.return(t);case 6:u=_.enterCatchBlock(),shaka.log.v2("Requesting",o,"failed with config",l,u);case 7:v.destroyer_.ensureNotDestroyed();case 3:s=i.next(),_.jumpTo(2);break;case 4:c=$jscomp.makeIterator([!0,!1]),d=c.next();case 9:if(d.done){_.jumpTo(11);break}p=d.value,h=$jscomp.makeIterator(e.keys()),f=h.next();case 12:if(f.done){d=c.next(),_.jumpTo(9);break}if(m=f.value,g=e.get(m),g.drmInfos.some((function(e){return!!e.licenseServerUri}))!=p){_.jumpTo(13);break}return _.setCatchFinallyBlocks(15),_.yield(navigator.requestMediaKeySystemAccess(m,[g]),17);case 17:return t=_.yieldResult,_.return(t);case 15:y=_.enterCatchBlock(),shaka.log.v2("Requesting",m,"failed with config",g,y);case 16:v.destroyer_.ensureNotDestroyed();case 13:f=h.next(),_.jumpTo(12);break;case 11:return _.return(t)}}))},shaka.drm.DrmEngine.prototype.checkSessionsLoaded_=function(){this.areAllSessionsLoaded_()&&this.allSessionsLoaded_.resolve()},shaka.drm.DrmEngine.prototype.setLoadSessionTimeoutTimer_=function(e){var t=this;new shaka.util.Timer((function(){e.loaded=!0,t.checkSessionsLoaded_()})).tickAfter(shaka.drm.DrmEngine.SESSION_LOAD_TIMEOUT_)},shaka.drm.DrmEngine.prototype.loadOfflineSession_=function(e,t){var r,n,a,i,s,o,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:try{shaka.log.v1("Attempting to load an offline session",e),r=u.mediaKeys_.createSession("persistent-license")}catch(e){return n=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,e.message),u.onError_(n),c.return(Promise.reject(n))}return u.eventManager_.listen(r,"message",(function(e){return u.onSessionMessage_(e)})),u.eventManager_.listen(r,"keystatuseschange",(function(e){return u.onKeyStatusesChange_(e)})),a={initData:t.initData,initDataType:t.initDataType,loaded:!1,oldExpiration:1/0,updatePromise:null,type:"persistent-license"},u.activeSessions_.set(r,a),c.setCatchFinallyBlocks(2),c.yield(r.load(e),4);case 4:return i=c.yieldResult,u.destroyer_.ensureNotDestroyed(),shaka.log.v2("Loaded offline session",e,i),i||(u.activeSessions_.delete(r),s=u.config_.persistentSessionOnlinePlayback?shaka.util.Error.Severity.RECOVERABLE:shaka.util.Error.Severity.CRITICAL,u.onError_(new shaka.util.Error(s,shaka.util.Error.Category.DRM,shaka.util.Error.Code.OFFLINE_SESSION_REMOVED)),a.loaded=!0),u.setLoadSessionTimeoutTimer_(a),u.checkSessionsLoaded_(),c.return(r);case 2:o=c.enterCatchBlock(),u.destroyer_.ensureNotDestroyed(o),u.activeSessions_.delete(r),l=u.config_.persistentSessionOnlinePlayback?shaka.util.Error.Severity.RECOVERABLE:shaka.util.Error.Severity.CRITICAL,u.onError_(new shaka.util.Error(l,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,o.message)),a.loaded=!0,u.checkSessionsLoaded_();case 3:return c.return(Promise.resolve())}}))},shaka.drm.DrmEngine.prototype.createSession=function(e,t,r){var n=this;goog.asserts.assert(this.mediaKeys_,"mediaKeys_ should be valid when creating temporary session.");try{shaka.log.info("Creating new",r,"session");var a=this.mediaKeys_.createSession(r)}catch(e){return void this.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,e.message))}this.eventManager_.listen(a,"message",(function(e){return n.onSessionMessage_(e)})),this.eventManager_.listen(a,"keystatuseschange",(function(e){return n.onKeyStatusesChange_(e)})),this.activeSessions_.set(a,{initData:t,initDataType:e,loaded:!1,oldExpiration:1/0,updatePromise:null,type:r});try{t=this.config_.initDataTransform(t,e,this.currentDrmInfo_)}catch(t){return e=t,t instanceof shaka.util.Error||(e=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.INIT_DATA_TRANSFORM_ERROR,t)),void this.onError_(e)}this.config_.logLicenseExchange&&(r=shaka.util.Uint8ArrayUtils.toBase64(t),shaka.log.info("EME init data: type=",e,"data=",r)),a.generateRequest(e,t).catch((function(e){if(!n.destroyer_.destroyed()){goog.asserts.assert(e instanceof Error,"Wrong error type!"),n.activeSessions_.delete(a);var t=e.errorCode;if(t&&t.systemCode){var r=t.systemCode;0>r&&(r+=Math.pow(2,32)),r="0x"+r.toString(16)}n.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_GENERATE_LICENSE_REQUEST,e.message,e,r))}}))},shaka.drm.DrmEngine.prototype.onSessionMessage_=function(e){this.delayLicenseRequest_()?this.mediaKeyMessageEvents_.push(e):this.sendLicenseRequest_(e)},shaka.drm.DrmEngine.prototype.delayLicenseRequest_=function(){return!!this.video_&&(this.config_.delayLicenseRequestUntilPlayed&&this.video_.paused&&!this.initialRequestsSent_)},shaka.drm.DrmEngine.prototype.waitForActiveRequests=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?e.hasInitData_?t.yield(e.allSessionsLoaded_,3):t.jumpTo(0):t.yield(Promise.all(e.activeRequests_.map((function(e){return e.promise}))),0)}))},shaka.drm.DrmEngine.prototype.sendLicenseRequest_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:if(t=e.target,shaka.log.v1("Sending license request for session",t.sessionId,"of type",e.messageType),v.config_.logLicenseExchange&&(r=shaka.util.Uint8ArrayUtils.toBase64(e.message),shaka.log.info("EME license request",r)),n=v.activeSessions_.get(t),a=v.currentDrmInfo_.licenseServerUri,i=v.config_.advanced[v.currentDrmInfo_.keySystem],"individualization-request"==e.messageType&&i&&i.individualizationServer&&(a=i.individualizationServer),s=shaka.net.NetworkingEngine.RequestType.LICENSE,(o=shaka.net.NetworkingEngine.makeRequest([a],v.config_.retryParameters)).body=e.message,o.method="POST",o.licenseRequestType=e.messageType,o.sessionId=t.sessionId,o.drmInfo=v.currentDrmInfo_,n&&(o.initData=n.initData,o.initDataType=n.initDataType),i&&i.headers)for(l in i.headers)o.headers[l]=i.headers[l];return shaka.drm.DrmUtils.isClearKeySystem(v.currentDrmInfo_.keySystem)&&v.fixClearKeyRequest_(o,v.currentDrmInfo_),shaka.drm.DrmUtils.isPlayReadyKeySystem(v.currentDrmInfo_.keySystem)&&v.unpackPlayReadyRequest_(o),u=Date.now(),_.setCatchFinallyBlocks(2),d=v.playerInterface_.netEngine.request(s,o,{isPreload:v.isPreload_()}),v.activeRequests_.push(d),_.yield(d.promise,4);case 4:c=_.yieldResult,shaka.util.ArrayUtils.remove(v.activeRequests_,d),_.leaveTryBlock(3);break;case 2:return p=_.enterCatchBlock(),v.destroyer_.destroyed()?_.return():(goog.asserts.assert(p instanceof shaka.util.Error,"Wrong NetworkingEngine error type!"),h=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.LICENSE_REQUEST_FAILED,p),1==v.activeSessions_.size?(v.onError_(h),n&&n.updatePromise&&n.updatePromise.reject(h)):(n&&n.updatePromise&&n.updatePromise.reject(h),v.activeSessions_.delete(t),v.areAllSessionsLoaded_()&&(v.allSessionsLoaded_.resolve(),v.keyStatusTimer_.tickAfter(.1))),_.return());case 3:return v.destroyer_.destroyed()?_.return():(v.licenseTimeSeconds_+=(Date.now()-u)/1e3,v.config_.logLicenseExchange&&(f=shaka.util.Uint8ArrayUtils.toBase64(c.data),shaka.log.info("EME license response",f)),_.setCatchFinallyBlocks(5),shaka.log.v1("Updating session",t.sessionId),_.yield(t.update(c.data),7));case 7:_.leaveTryBlock(6);break;case 5:return m=_.enterCatchBlock(),g=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.LICENSE_RESPONSE_REJECTED,m.message),v.onError_(g),n&&n.updatePromise&&n.updatePromise.reject(g),_.return();case 6:if(v.destroyer_.destroyed())return _.return();y=new shaka.util.FakeEvent("drmsessionupdate"),v.playerInterface_.onEvent(y),n&&(n.updatePromise&&n.updatePromise.resolve(),v.setLoadSessionTimeoutTimer_(n)),_.jumpToEnd()}}))},shaka.drm.DrmEngine.prototype.unpackPlayReadyRequest_=function(e){var t=shaka.util.TXml,r=shaka.util.StringUtils.fromUTF16(e.body,!0,!0);if(r.includes("PlayReadyKeyMessage")){shaka.log.debug("Unwrapping PlayReady request."),r=t.parseXmlString(r,"PlayReadyKeyMessage"),goog.asserts.assert(r,"Failed to parse PlayReady XML!");for(var n=t.getElementsByTagName(r,"HttpHeader"),a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next()){var i=a.value;a=t.getElementsByTagName(i,"name")[0],i=t.getElementsByTagName(i,"value")[0],goog.asserts.assert(a&&i,"Malformed PlayReady headers!"),e.headers[shaka.util.TXml.getTextContents(a)]=shaka.util.TXml.getTextContents(i)}t=t.getElementsByTagName(r,"Challenge")[0],goog.asserts.assert(t,"Malformed PlayReady challenge!"),goog.asserts.assert("base64encoded"==t.attributes.encoding,"Unexpected PlayReady challenge encoding!"),e.body=shaka.util.Uint8ArrayUtils.fromBase64(shaka.util.TXml.getTextContents(t))}else shaka.log.debug("PlayReady request is already unwrapped."),e.headers["Content-Type"]="text/xml; charset=utf-8"},shaka.drm.DrmEngine.prototype.fixClearKeyRequest_=function(e,t){try{var r=shaka.util.StringUtils.fromBytesAutoDetect(e.body);if(r){var n=JSON.parse(r);n.type||(n.type=t.sessionType,e.body=shaka.util.StringUtils.toUTF8(JSON.stringify(n)))}}catch(e){shaka.log.info("Error unpacking ClearKey license",e)}},shaka.drm.DrmEngine.prototype.onKeyStatusesChange_=function(e){var t=this;e=e.target,shaka.log.v2("Key status changed for session",e.sessionId);var r=this.activeSessions_.get(e),n=!1;e.keyStatuses.forEach((function(e,a){if("string"==typeof a){var i=a;a=e,e=i}if(shaka.drm.DrmUtils.isPlayReadyKeySystem(t.currentDrmInfo_.keySystem)&&16==a.byteLength&&(shaka.util.Platform.isEdge()||shaka.util.Platform.isPS4())){var s=(i=shaka.util.BufferUtils.toDataView(a)).getUint32(0,!0),o=i.getUint16(4,!0),l=i.getUint16(6,!0);i.setUint32(0,s,!1),i.setUint16(4,o,!1),i.setUint16(6,l,!1)}"status-pending"!=e&&(r.loaded=!0),r||goog.asserts.assert("usable"!=e,"Usable keys found in closed session"),"expired"==e&&(n=!0),a=shaka.util.Uint8ArrayUtils.toHex(a).slice(0,32),t.keyStatusByKeyId_.set(a,e)}));var a=e.expiration-Date.now();(0>a||n&&1e3>a)&&r&&!r.updatePromise&&(shaka.log.debug("Session has expired",e.sessionId),this.activeSessions_.delete(e),this.closeSession_(e)),this.areAllSessionsLoaded_()&&(this.allSessionsLoaded_.resolve(),this.keyStatusTimer_.tickAfter(shaka.drm.DrmEngine.KEY_STATUS_BATCH_TIME))},shaka.drm.DrmEngine.prototype.processKeyStatusChanges_=function(){var e=this.keyStatusByKeyId_,t=this.announcedKeyStatusByKeyId_;t.clear(),e.forEach((function(e,r){return t.set(r,e)})),(e=Array.from(t.values())).length&&e.every((function(e){return"expired"==e}))&&this.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.EXPIRED)),this.playerInterface_.onKeyStatus(shaka.util.MapUtils.asObject(t))},shaka.drm.DrmEngine.probeSupport=function(){var e,t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M;return $jscomp.asyncExecutePromiseGeneratorProgram((function(D){if(1==D.nextAddress){if(e="org.w3.clearkey com.widevine.alpha com.widevine.alpha.experiment com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.chromecast.playready com.apple.fps.1_0 com.apple.fps com.huawei.wiseplay".split(" "),!shaka.drm.DrmUtils.isBrowserSupported()){for(t={},r=$jscomp.makeIterator(e),n=r.next();!n.done;n=r.next())a=n.value,t[a]=null;return D.return(t)}for(i="1.0 1.1 1.2 1.3 1.4 2.0 2.1 2.2 2.3".split(" "),o={"com.widevine.alpha":s=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],"com.widevine.alpha.experiment":s,"com.microsoft.playready.recommendation":["150","2000","3000"]},c={videoCapabilities:l=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],audioCapabilities:u=[{contentType:'audio/mp4; codecs="mp4a.40.2"'},{contentType:'audio/webm; codecs="opus"'}],initDataTypes:["cenc","sinf","skd","keyids"]},d=[null,"cenc","cbcs","cbcs-1-9"],p=new Map,h=function(e,t){var r,n,a,s,o,l,u,c,d,h,f,m,g;return $jscomp.asyncExecutePromiseGeneratorProgram((function(y){switch(y.nextAddress){case 1:if(y.setCatchFinallyBlocks(2),goog.DEBUG&&shaka.util.Platform.isWindows()&&shaka.util.Platform.isFirefox()&&shaka.debug.RunningInLab)throw Error("Suppressing Firefox Windows DRM in testing!");return y.yield(t.createMediaKeys(),5);case 5:r=y.yieldResult;case 4:y.leaveTryBlock(3);break;case 2:return y.enterCatchBlock(),y.return();case 3:if(a=!!(n=t.getConfiguration().sessionTypes)&&n.includes("persistent-license"),shaka.util.Platform.isTizen3()&&(a=!1),s=t.getConfiguration().videoCapabilities,o=t.getConfiguration().audioCapabilities,l={persistentState:a,encryptionSchemes:[],videoRobustnessLevels:[],audioRobustnessLevels:[],minHdcpVersions:[]},p.has(e)&&p.get(e)?l=p.get(e):p.set(e,l),(u=s[0].encryptionScheme)&&!l.encryptionSchemes.includes(u)&&l.encryptionSchemes.push(u),(c=s[0].robustness)&&!l.videoRobustnessLevels.includes(c)&&l.videoRobustnessLevels.push(c),(d=o[0].robustness)&&!l.audioRobustnessLevels.includes(d)&&l.audioRobustnessLevels.push(d),"getStatusForPolicy"in r){for(h=[],f=$jscomp.makeIterator(i),m=f.next(),g={};!m.done;g={hdcpVersion:void 0},m=f.next())g.hdcpVersion=m.value,l.minHdcpVersions.includes(g.hdcpVersion)||h.push(r.getStatusForPolicy({minHdcpVersion:g.hdcpVersion}).then(function(e){return function(t){"usable"!=t||l.minHdcpVersions.includes(e.hdcpVersion)||l.minHdcpVersions.push(e.hdcpVersion)}}(g)));return y.yield(Promise.all(h),0)}y.jumpTo(0)}}))},f=function(e,t,r,n){var a,i,s,o,l,u,d,p,f,m;return $jscomp.asyncExecutePromiseGeneratorProgram((function(g){switch(g.nextAddress){case 1:for(g.setCatchFinallyBlocks(2),a=shaka.util.ObjectUtils.cloneObject(c),i=$jscomp.makeIterator(a.videoCapabilities),s=i.next();!s.done;s=i.next())(o=s.value).encryptionScheme=t,o.robustness=r;for(l=$jscomp.makeIterator(a.audioCapabilities),u=l.next();!u.done;u=l.next())(d=u.value).encryptionScheme=t,d.robustness=n;return(p=shaka.util.ObjectUtils.cloneObject(a)).persistentState="required",p.sessionTypes=["persistent-license"],f=[p,a],shaka.util.Platform.isAndroid()?g.yield(shaka.util.Functional.promiseWithTimeout(5,navigator.requestMediaKeySystemAccess(e,f)),7):g.yield(navigator.requestMediaKeySystemAccess(e,f),6);case 6:m=g.yieldResult,g.jumpTo(5);break;case 7:m=g.yieldResult;case 5:return g.yield(h(e,m),8);case 8:g.leaveTryBlock(0);break;case 2:g.enterCatchBlock(),g.jumpToEnd()}}))},m=function(e,t,r,n){var a,i,s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:return c.setCatchFinallyBlocks(2),a={type:"media-source",video:{contentType:l[0].contentType,width:640,height:480,bitrate:1,framerate:1},audio:{contentType:u[0].contentType,channels:2,bitrate:1,samplerate:1},keySystemConfiguration:{keySystem:e,video:{encryptionScheme:t,robustness:r},audio:{encryptionScheme:t,robustness:n}}},shaka.util.Platform.isAndroid()?c.yield(shaka.util.Functional.promiseWithTimeout(5,navigator.mediaCapabilities.decodingInfo(a)),7):c.yield(navigator.mediaCapabilities.decodingInfo(a),6);case 6:i=c.yieldResult,c.jumpTo(5);break;case 7:i=c.yieldResult;case 5:return s=i.keySystemAccess,c.yield(h(e,s),8);case 8:c.leaveTryBlock(0);break;case 2:o=c.enterCatchBlock(),shaka.log.v2("Failed to probe support for",e,o),c.jumpToEnd()}}))},g=$jscomp.makeIterator(e),y=g.next();!y.done;y=g.next())v=y.value,p.set(v,null);for(_=function(e){return!shaka.drm.DrmUtils.isClearKeySystem(e)||!shaka.util.Platform.isApple()},k=[],E=$jscomp.makeIterator(d),b=E.next();!b.done;b=E.next())for(T=b.value,A=$jscomp.makeIterator(e),S=A.next();!S.done;S=A.next())P=S.value,_(P)&&(k.push(f(P,T,"","")),k.push(m(P,T,"","")));for(C=$jscomp.makeIterator(e),x=C.next();!x.done;x=C.next())for(I=x.value,w=$jscomp.makeIterator(o[I]||[]),R=w.next();!R.done;R=w.next())M=R.value,_(I)&&(k.push(f(I,null,M,"")),k.push(f(I,null,"",M)),k.push(m(I,null,M,"")),k.push(m(I,null,"",M)));return D.yield(Promise.all(k),2)}return D.return(shaka.util.MapUtils.asObject(p))}))},shaka.drm.DrmEngine.prototype.onPlay_=function(){for(var e=$jscomp.makeIterator(this.mediaKeyMessageEvents_),t=e.next();!t.done;t=e.next())this.sendLicenseRequest_(t.value);this.initialRequestsSent_=!0,this.mediaKeyMessageEvents_=[]},shaka.drm.DrmEngine.prototype.closeSession_=function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?(t.setCatchFinallyBlocks(2),t.yield(shaka.util.Functional.promiseWithTimeout(shaka.drm.DrmEngine.CLOSE_TIMEOUT_,Promise.all([e.close().catch((function(){})),e.closed])),4)):2!=t.nextAddress?t.leaveTryBlock(0):(t.enterCatchBlock(),shaka.log.warning("Timeout waiting for session close"),void t.jumpToEnd())}))},shaka.drm.DrmEngine.prototype.closeOpenSessions_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return e=Array.from(t.activeSessions_.entries()),t.activeSessions_.clear(),r.yield(Promise.all(e.map((function(e){var r,n=(e=$jscomp.makeIterator(e)).next().value,a=e.next().value;return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return 1==e.nextAddress?(e.setCatchFinallyBlocks(2),t.initializedForStorage_||t.storedPersistentSessions_.has(n.sessionId)||"persistent-license"!==a.type||t.config_.persistentSessionOnlinePlayback?(shaka.log.v1("Closing session",n.sessionId,a),e.yield(t.closeSession_(n),5)):(shaka.log.v1("Removing session",n.sessionId),e.yield(n.remove(),5))):2!=e.nextAddress?e.leaveTryBlock(0):(r=e.enterCatchBlock(),shaka.log.error("Failed to close or remove the session",r),void e.jumpToEnd())}))}))),0)}))},shaka.drm.DrmEngine.prototype.getVariantDrmInfos_=function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])},shaka.drm.DrmEngine.prototype.pollExpiration_=function(){var e=this;this.activeSessions_.forEach((function(t,r){var n=t.oldExpiration,a=r.expiration;isNaN(a)&&(a=1/0),a!=n&&(e.playerInterface_.onExpirationUpdated(r.sessionId,a),t.oldExpiration=a)}))},shaka.drm.DrmEngine.prototype.areAllSessionsLoaded_=function(){var e=this.activeSessions_.values();return shaka.util.Iterables.every(e,(function(e){return e.loaded}))},shaka.drm.DrmEngine.prototype.areAllKeysUsable_=function(){for(var e=this.currentDrmInfo_&&this.currentDrmInfo_.keyIds||new Set([]),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())if("usable"!==this.keyStatusByKeyId_.get(t.value))return!1;return!0},shaka.drm.DrmEngine.replaceDrmInfo_=function(e,t){var r=[];for(t.forEach((function(e,t){r.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})})),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())(t=t.value).video&&(t.video.drmInfos=r),t.audio&&(t.audio.drmInfos=r)},shaka.drm.DrmEngine.prototype.createDrmInfoByInfos_=function(e,t){var r=[],n=[],a=[],i=[],s=[],o=new Set,l=new Set;shaka.drm.DrmEngine.processDrmInfos_(t,r,n,i,a,s,o,l),1<r.length&&shaka.log.warning("Multiple unique encryption schemes found! Only the first will be used."),1<i.length&&shaka.log.warning("Multiple unique server certificates found! Only the first will be used."),1<n.length&&shaka.log.warning("Multiple unique license server URIs found! Only the first will be used."),1<a.length&&shaka.log.warning("Multiple unique server certificate URIs found! Only the first will be used.");var u=this.usePersistentLicenses_?"persistent-license":"temporary";for(e={keySystem:e,encryptionScheme:r[0],licenseServerUri:n[0],distinctiveIdentifierRequired:t[0].distinctiveIdentifierRequired,persistentStateRequired:t[0].persistentStateRequired,sessionType:t[0].sessionType||u,audioRobustness:t[0].audioRobustness||"",videoRobustness:t[0].videoRobustness||"",serverCertificate:i[0],serverCertificateUri:a[0],initData:s,keyIds:o},0<l.size&&(e.keySystemUris=l),l=(t=$jscomp.makeIterator(t)).next();!l.done;l=t.next())(l=l.value).distinctiveIdentifierRequired&&(e.distinctiveIdentifierRequired=l.distinctiveIdentifierRequired),l.persistentStateRequired&&(e.persistentStateRequired=l.persistentStateRequired);return e},shaka.drm.DrmEngine.createDrmInfoByConfigs_=function(e,t){var r=[],n=[],a=[],i=[],s=[],o=new Set;return shaka.drm.DrmEngine.processDrmInfos_(t.drmInfos,r,n,i,a,s,o),1<r.length&&shaka.log.warning("Multiple unique encryption schemes found! Only the first will be used."),1<i.length&&shaka.log.warning("Multiple unique server certificates found! Only the first will be used."),1<a.length&&shaka.log.warning("Multiple unique server certificate URIs found! Only the first will be used."),1<n.length&&shaka.log.warning("Multiple unique license server URIs found! Only the first will be used."),{keySystem:e,encryptionScheme:r[0],licenseServerUri:n[0],distinctiveIdentifierRequired:"required"==t.distinctiveIdentifier,persistentStateRequired:"required"==t.persistentState,sessionType:t.sessionTypes[0]||"temporary",audioRobustness:(t.audioCapabilities?t.audioCapabilities[0].robustness:"")||"",videoRobustness:(t.videoCapabilities?t.videoCapabilities[0].robustness:"")||"",serverCertificate:i[0],serverCertificateUri:a[0],initData:s,keyIds:o}},shaka.drm.DrmEngine.processDrmInfos_=function(e,t,r,n,a,i,s,o){for(var l=[],u=(e=$jscomp.makeIterator(e)).next(),c={};!u.done;c={drmInfo$jscomp$5:void 0},u=e.next()){if(c.drmInfo$jscomp$5=u.value,t.includes(c.drmInfo$jscomp$5.encryptionScheme)||t.push(c.drmInfo$jscomp$5.encryptionScheme),"org.w3.clearkey"==c.drmInfo$jscomp$5.keySystem&&c.drmInfo$jscomp$5.licenseServerUri.startsWith("data:application/json;base64,")?l.includes(c.drmInfo$jscomp$5.licenseServerUri)||l.push(c.drmInfo$jscomp$5.licenseServerUri):r.includes(c.drmInfo$jscomp$5.licenseServerUri)||r.push(c.drmInfo$jscomp$5.licenseServerUri),a.includes(c.drmInfo$jscomp$5.serverCertificateUri)||a.push(c.drmInfo$jscomp$5.serverCertificateUri),c.drmInfo$jscomp$5.serverCertificate&&(n.some(function(e){return function(t){return shaka.util.BufferUtils.equal(t,e.drmInfo$jscomp$5.serverCertificate)}}(c))||n.push(c.drmInfo$jscomp$5.serverCertificate)),c.drmInfo$jscomp$5.initData)for(var d=(u=$jscomp.makeIterator(c.drmInfo$jscomp$5.initData)).next(),p={};!d.done;p={initDataOverride$jscomp$2:void 0},d=u.next())p.initDataOverride$jscomp$2=d.value,i.some(function(e){return function(t){var r=e.initDataOverride$jscomp$2;return t=!(!t.keyId||t.keyId!=r.keyId)||t.initDataType==r.initDataType&&shaka.util.BufferUtils.equal(t.initData,r.initData)}}(p))||i.push(p.initDataOverride$jscomp$2);if(c.drmInfo$jscomp$5.keyIds)for(d=(u=$jscomp.makeIterator(c.drmInfo$jscomp$5.keyIds)).next();!d.done;d=u.next())s.add(d.value);if(c.drmInfo$jscomp$5.keySystemUris&&o)for(u=(c=$jscomp.makeIterator(c.drmInfo$jscomp$5.keySystemUris)).next();!u.done;u=c.next())o.add(u.value)}if(1==l.length)r.push(l[0]);else if(0<l.length){for(t=[],n=(l=$jscomp.makeIterator(l)).next();!n.done;n=l.next())n=window.atob(n.value.split("data:application/json;base64,").pop()),n=JSON.parse(n),t.push.apply(t,$jscomp.arrayFromIterable(n.keys));l=JSON.stringify({keys:t}),r.push("data:application/json;base64,"+window.btoa(l))}},shaka.drm.DrmEngine.fillInDrmInfoDefaults_=function(e,t,r,n){var a=e.keySystem;!a||"org.w3.clearkey"==a&&e.licenseServerUri||(t.size&&t.get(a)&&(t=t.get(a),e.licenseServerUri=t),e.keyIds||(e.keyIds=new Set),(r=r.get(a))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=r.persistentStateRequired),e.serverCertificate||(e.serverCertificate=r.serverCertificate),r.sessionType&&(e.sessionType=r.sessionType),e.serverCertificateUri||(e.serverCertificateUri=r.serverCertificateUri)),n[a]&&(e.keySystem=n[a]),window.cast&&window.cast.__platform__&&"com.microsoft.playready"==a&&(e.keySystem="com.chromecast.playready"))},shaka.drm.DrmEngine.prototype.parseInbandPssh=function(e,t){if(!this.config_.parseInbandPsshEnabled||this.manifestInitData_)return Promise.resolve();var r=shaka.util.ManifestParserUtils.ContentType;if(![r.AUDIO,r.VIDEO].includes(e))return Promise.resolve();e=new shaka.util.Pssh(shaka.util.BufferUtils.toUint8(t)),t=0;for(var n=(r=$jscomp.makeIterator(e.data)).next();!n.done;n=r.next())t+=n.value.length;if(0==t)return Promise.resolve();for(t=new Uint8Array(t),r=0,n=(e=$jscomp.makeIterator(e.data)).next();!n.done;n=e.next())n=n.value,t.set(n,r),r+=n.length;return this.newInitData("cenc",t),this.allSessionsLoaded_},shaka.drm.DrmEngine.configureClearKey=function(e,t){if(0!=(e=shaka.util.MapUtils.asMap(e)).size){e=shaka.util.ManifestParserUtils.createDrmInfoFromClearKeys(e);for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())(r=r.value).video&&(r.video.drmInfos=[e]),r.audio&&(r.audio.drmInfos=[e])}},shaka.drm.DrmEngine.CLOSE_TIMEOUT_=1,shaka.drm.DrmEngine.SESSION_LOAD_TIMEOUT_=5,shaka.drm.DrmEngine.KEY_STATUS_BATCH_TIME=.5,shaka.media.AdaptationSet=function(e,t,r){for(r=void 0===r||r,this.root_=e,this.variants_=new Set([e]),t=t||[],t=(e=$jscomp.makeIterator(t)).next();!t.done;t=e.next())this.add(t.value,r)},shaka.media.AdaptationSet.prototype.add=function(e,t){return this.canInclude(e,t)?(this.variants_.add(e),!0):(shaka.log.warning("Rejecting variant - not compatible with root."),!1)},shaka.media.AdaptationSet.prototype.canInclude=function(e,t){return shaka.media.AdaptationSet.areAdaptable(this.root_,e,void 0===t||t)},shaka.media.AdaptationSet.areAdaptable=function(e,t,r){var n=shaka.media.AdaptationSet;return!!e.audio==!!t.audio&&!!e.video==!!t.video&&e.language==t.language&&(goog.asserts.assert(!!e.audio==!!t.audio,"Both should either have audio or not have audio."),!(e.audio&&t.audio&&!n.areAudiosCompatible_(e.audio,t.audio,r))&&(goog.asserts.assert(!!e.video==!!t.video,"Both should either have video or not have video."),!(e.video&&t.video&&!n.areVideosCompatible_(e.video,t.video,r))))},shaka.media.AdaptationSet.prototype.values=function(){return this.variants_.values()},shaka.media.AdaptationSet.areAudiosCompatible_=function(e,t,r){var n=shaka.media.AdaptationSet;return!((!e.channelsCount||!t.channelsCount||2<e.channelsCount||2<t.channelsCount)&&e.channelsCount!=t.channelsCount||e.spatialAudio!==t.spatialAudio||r&&!n.canTransitionBetween_(e,t)||!n.areRolesEqual_(e.roles,t.roles)||e.groupId!==t.groupId)},shaka.media.AdaptationSet.areVideosCompatible_=function(e,t,r){var n=shaka.media.AdaptationSet;return!(r&&!n.canTransitionBetween_(e,t)||!n.areRolesEqual_(e.roles,t.roles))},shaka.media.AdaptationSet.canTransitionBetween_=function(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=shaka.util.MimeUtils.splitCodecs(e.codecs).map((function(e){return shaka.util.MimeUtils.getCodecBase(e)})),t=shaka.util.MimeUtils.splitCodecs(t.codecs).map((function(e){return shaka.util.MimeUtils.getCodecBase(e)})),e.length!=t.length)return!1;e.sort(),t.sort();for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0},shaka.media.AdaptationSet.areRolesEqual_=function(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if(!t.has(r.value))return!1;return!0},goog.exportSymbol("shaka.media.AdaptationSet",shaka.media.AdaptationSet),shaka.config.CodecSwitchingStrategy={RELOAD:"reload",SMOOTH:"smooth"},goog.exportSymbol("shaka.config.CodecSwitchingStrategy",shaka.config.CodecSwitchingStrategy),shaka.media.AdaptationSetCriteria=function(){},shaka.media.AdaptationSetCriteria.prototype.create=function(e){},shaka.media.AdaptationSetCriteria.prototype.configure=function(e){},goog.exportSymbol("shaka.media.AdaptationSetCriteria",shaka.media.AdaptationSetCriteria),shaka.media.BufferingObserver=function(e,t){var r=shaka.media.BufferingObserver.State;this.previousState_=r.SATISFIED,this.thresholds_=(new Map).set(r.SATISFIED,t).set(r.STARVING,e),this.lastRebufferTime_=0},shaka.media.BufferingObserver.prototype.setThresholds=function(e,t){var r=shaka.media.BufferingObserver.State;this.thresholds_.set(r.SATISFIED,t).set(r.STARVING,e)},shaka.media.BufferingObserver.prototype.update=function(e,t){var r=shaka.media.BufferingObserver.State,n=this.thresholds_.get(this.previousState_),a=this.previousState_;return this.previousState_=e=t||e>=n&&0<e?r.SATISFIED:r.STARVING,(a=a!=e)&&e===r.SATISFIED&&(this.lastRebufferTime_=Date.now()),a},shaka.media.BufferingObserver.prototype.setState=function(e){this.previousState_=e},shaka.media.BufferingObserver.prototype.getState=function(){return this.previousState_},shaka.media.BufferingObserver.prototype.getLastRebufferTime=function(){return this.lastRebufferTime_},shaka.media.BufferingObserver.prototype.resetLastRebufferTime=function(){this.lastRebufferTime_=0},shaka.media.BufferingObserver.State={STARVING:0,SATISFIED:1},shaka.media.ManifestFilterer=function(e,t,r){goog.asserts.assert(e,"Must have config"),this.config_=e,this.maxHwRes_=t,this.drmEngine_=r},shaka.media.ManifestFilterer.prototype.setDrmEngine=function(e){this.drmEngine_=e},shaka.media.ManifestFilterer.prototype.filterManifest=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(goog.asserts.assert(e,"Manifest should exist!"),r.yield(shaka.util.StreamUtils.filterManifest(t.drmEngine_,e,t.config_.drm.preferredKeySystems,t.config_.drm.keySystemsMapping),2)):(t.config_.streaming.dontChooseCodecs||shaka.util.StreamUtils.chooseCodecsAndFilterManifest(e,t.config_.preferredVideoCodecs,t.config_.preferredAudioCodecs,t.config_.preferredDecodingAttributes,t.config_.preferredTextFormats),t.checkPlayableVariants_(e),r.return(t.filterManifestWithRestrictions(e)))}))},shaka.media.ManifestFilterer.prototype.applyRestrictions=function(e){return shaka.util.StreamUtils.applyRestrictions(e.variants,this.config_.restrictions,this.maxHwRes_)},shaka.media.ManifestFilterer.prototype.filterManifestWithRestrictions=function(e){var t=this.applyRestrictions(e);if(e){var r=this.drmEngine_?this.drmEngine_.getDrmInfo():null;if(r&&this.drmEngine_.getMediaKeys())for(var n=$jscomp.makeIterator(e.variants),a=n.next();!a.done;a=n.next())a=a.value,this.processDrmInfos(r.keySystem,a.video),this.processDrmInfos(r.keySystem,a.audio);this.checkRestrictedVariants(e)}return t},shaka.media.ManifestFilterer.prototype.checkPlayableVariants_=function(e){if(!e.variants.some(shaka.util.StreamUtils.isPlayable))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.CONTENT_UNSUPPORTED_BY_BROWSER)},shaka.media.ManifestFilterer.prototype.processDrmInfos=function(e,t){if(t)for(var r=(t=$jscomp.makeIterator(t.drmInfos)).next();!r.done;r=t.next())if((r=r.value).keySystem==e)for(var n=(r=$jscomp.makeIterator(r.initData||[])).next();!n.done;n=r.next())n=n.value,this.drmEngine_.newInitData(n.initDataType,n.initData)},shaka.media.ManifestFilterer.prototype.checkRestrictedVariants=function(e){var t=shaka.media.ManifestFilterer.restrictedStatuses,r=this.drmEngine_?this.drmEngine_.getKeyStatuses():{},n=Object.keys(r);n=n.length&&"00"==n[0];for(var a=!1,i=!1,s=new Set,o=new Set,l=(e=$jscomp.makeIterator(e.variants)).next();!l.done;l=e.next()){var u=[];(l=l.value).audio&&u.push(l.audio),l.video&&u.push(l.video);for(var c=(u=$jscomp.makeIterator(u)).next();!c.done;c=u.next())if((c=c.value).keyIds.size)for(var d=(c=$jscomp.makeIterator(c.keyIds)).next();!d.done;d=c.next()){d=d.value;var p=r[n?"00":d];p?t.includes(p)&&o.add(p):s.add(d)}l.allowedByApplication?l.allowedByKeySystem&&(a=!0):i=!0}if(!a)throw t={hasAppRestrictions:i,missingKeys:Array.from(s),restrictedKeyStatuses:Array.from(o)},new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.RESTRICTIONS_CANNOT_BE_MET,t)},shaka.media.ManifestFilterer.restrictedStatuses=["output-restricted","internal-error"],shaka.media.ManifestParser=function(){},shaka.media.ManifestParser.registerParserByExtension=function(e,t){shaka.Deprecate.deprecateFeature(5,"ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},shaka.media.ManifestParser.registerParserByMime=function(e,t){shaka.media.ManifestParser.parsersByMime.set(e,t)},shaka.media.ManifestParser.unregisterParserByMime=function(e){shaka.media.ManifestParser.parsersByMime.delete(e)},shaka.media.ManifestParser.probeSupport=function(){var e=shaka.media.ManifestParser,t={};if(shaka.util.Platform.supportsMediaSource())for(var r=$jscomp.makeIterator(e.parsersByMime.keys()),n=r.next();!n.done;n=r.next())t[n.value]=!0;for(n=(r=$jscomp.makeIterator(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!n.done;n=r.next())n=n.value,shaka.util.Platform.supportsMediaSource()?t[n]=e.parsersByMime.has(n):t[n]=shaka.util.Platform.supportsMediaType(n);return t},shaka.media.ManifestParser.getFactory=function(e,t){var r=shaka.media.ManifestParser;if(t){if(r=r.parsersByMime.get(t.toLowerCase()))return r;shaka.log.warning("Could not determine manifest type using MIME type ",t)}throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.UNABLE_TO_GUESS_MANIFEST_TYPE,e,t)},shaka.media.ManifestParser.isSupported=function(e){return!!shaka.util.Platform.supportsMediaSource()&&shaka.media.ManifestParser.parsersByMime.has(e)},goog.exportSymbol("shaka.media.ManifestParser",shaka.media.ManifestParser),goog.exportProperty(shaka.media.ManifestParser,"unregisterParserByMime",shaka.media.ManifestParser.unregisterParserByMime),goog.exportProperty(shaka.media.ManifestParser,"registerParserByMime",shaka.media.ManifestParser.registerParserByMime),goog.exportProperty(shaka.media.ManifestParser,"registerParserByExtension",shaka.media.ManifestParser.registerParserByExtension),shaka.media.ManifestParser.HLS="HLS",shaka.media.ManifestParser.DASH="DASH",shaka.media.ManifestParser.MSS="MSS",shaka.media.ManifestParser.UNKNOWN="UNKNOWN",shaka.media.ManifestParser.AccessibilityPurpose={VISUALLY_IMPAIRED:"visually impaired",HARD_OF_HEARING:"hard of hearing"},goog.exportProperty(shaka.media.ManifestParser,"AccessibilityPurpose",shaka.media.ManifestParser.AccessibilityPurpose),shaka.media.ManifestParser.parsersByMime=new Map,shaka.util.Mp4BoxParsers=function(){},shaka.util.Mp4BoxParsers.parseTFHD=function(e,t){var r=null,n=null,a=null,i=null,s=e.readUint32();return 1&t&&(a=e.readUint64()),2&t&&(i=e.readUint32()),8&t&&(r=e.readUint32()),16&t&&(n=e.readUint32()),{trackId:s,defaultSampleDuration:r,defaultSampleSize:n,baseDataOffset:a,sampleDescriptionIndex:i}},shaka.util.Mp4BoxParsers.parseTFDT=function(e,t){return{baseMediaDecodeTime:1==t?e.readUint64():e.readUint32()}},shaka.util.Mp4BoxParsers.parseTFDTInaccurate=function(e,t){return 1==t?(t=e.readUint32(),e=e.readUint32(),{baseMediaDecodeTime:t*Math.pow(2,32)+e}):{baseMediaDecodeTime:e.readUint32()}},shaka.util.Mp4BoxParsers.parsePRFTInaccurate=function(e,t){e.readUint32();var r=e.readUint32();return r=1e3*r+e.readUint32()/Math.pow(2,32)*1e3,0===t?e=e.readUint32():(t=e.readUint32(),e=e.readUint32(),e=t*Math.pow(2,32)+e),{mediaTime:e,ntpTimestamp:r}},shaka.util.Mp4BoxParsers.parseMDHD=function(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.readUint32(),e.skip(4),e=e.readUint16(),{timescale:t,language:e=String.fromCharCode(96+(e>>10))+String.fromCharCode(96+((960&e)>>5))+String.fromCharCode(96+(31&e))}},shaka.util.Mp4BoxParsers.parseTREX=function(e){return e.skip(4),e.skip(4),{defaultSampleDuration:e.readUint32(),defaultSampleSize:e=e.readUint32()}},shaka.util.Mp4BoxParsers.parseTRUN=function(e,t,r){var n=e.readUint32(),a=[],i=null;1&r&&(i=e.readInt32()),4&r&&e.skip(4);for(var s=0;s<n;s++){var o={sampleDuration:null,sampleSize:null,sampleCompositionTimeOffset:null};256&r&&(o.sampleDuration=e.readUint32()),512&r&&(o.sampleSize=e.readUint32()),1024&r&&e.skip(4),2048&r&&(o.sampleCompositionTimeOffset=0==t?e.readUint32():e.readInt32()),a.push(o)}return{sampleCount:n,sampleData:a,dataOffset:i}},shaka.util.Mp4BoxParsers.parseTKHD=function(e,t){1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4));var r=e.readUint32();return 1==t?e.skip(8):e.skip(4),e.skip(4),e.skip(8),e.skip(2),e.skip(2),e.skip(2),e.skip(2),e.skip(36),{trackId:r,width:t=e.readUint16()+e.readUint16()/16,height:e=e.readUint16()+e.readUint16()/16}},shaka.util.Mp4BoxParsers.visualSampleEntry=function(e){e.skip(24);var t=e.readUint16(),r=e.readUint16();return e.skip(50),{width:t,height:r}},shaka.util.Mp4BoxParsers.audioSampleEntry=function(e){e.skip(6),e.skip(2),e.skip(8);var t=e.readUint16();return e.skip(2),e.skip(2),e.skip(2),{channelCount:t,sampleRate:e=e.readUint16()+e.readUint16()/65536}},shaka.util.Mp4BoxParsers.parseESDS=function(e){for(var t,r,n="mp4a";e.hasMoreData();){t=e.readUint8();for(var a=e.readUint8();128&a;)a=e.readUint8();if(3==t)e.readUint16(),128&(a=e.readUint8())&&e.readUint16(),64&a&&e.skip(e.readUint8()),32&a&&e.readUint16();else if(4==t)r=e.readUint8(),e.skip(12);else if(5==t)break}return r&&(n+="."+shaka.util.Mp4BoxParsers.toHex_(r),5==t&&e.hasMoreData()&&(31===(r=(248&(t=e.readUint8()))>>3)&&e.hasMoreData()&&(r=32+((7&t)<<3)+((224&e.readUint8())>>5)),n+="."+r)),{codec:n}},shaka.util.Mp4BoxParsers.parseAVCC=function(e,t,r){return r=shaka.util.Mp4BoxParsers,t.skip(1),{codec:e+"."+r.toHex_(t.readUint8())+r.toHex_(t.readUint8())+r.toHex_(t.readUint8())}},shaka.util.Mp4BoxParsers.parseHVCC=function(e,t,r){var n=shaka.util.Mp4BoxParsers;t.skip(1);var a=["","A","B","C"][(r=t.readUint8())>>6],i=31&r,s=t.readUint32(),o=(32&r)>>5?"H":"L";for(r=[t.readUint8(),t.readUint8(),t.readUint8(),t.readUint8(),t.readUint8(),t.readUint8()],t=t.readUint8(),e=e+"."+a+i+"."+n.toHex_(n.reverseBits_(s),!0),e+="."+o+t,t="",n=r.length;n--;)((a=r[n])||t)&&(t="."+a.toString(16).toUpperCase()+t);return{codec:e+=t}},shaka.util.Mp4BoxParsers.parseDVCC=function(e,t,r){r=shaka.util.Mp4BoxParsers,t.skip(2);var n=t.readUint8();return t=n<<5&32|(t=t.readUint8())>>3&31,{codec:e+"."+r.addLeadingZero_(n>>1&127)+"."+r.addLeadingZero_(t)}},shaka.util.Mp4BoxParsers.parseDVVC=function(e,t,r){r=shaka.util.Mp4BoxParsers,t.skip(2);var n=t.readUint8();return t=n<<5&32|(t=t.readUint8())>>3&31,{codec:e+"."+r.addLeadingZero_(n>>1&127)+"."+r.addLeadingZero_(t)}},shaka.util.Mp4BoxParsers.parseVPCC=function(e,t,r){r=shaka.util.Mp4BoxParsers;var n=t.readUint8(),a=t.readUint8();return t=t.readUint8()>>4&15,{codec:e+"."+r.addLeadingZero_(n)+"."+r.addLeadingZero_(a)+"."+r.addLeadingZero_(t)}},shaka.util.Mp4BoxParsers.parseAV1C=function(e,t,r){r=shaka.util.Mp4BoxParsers,t.skip(1);var n=t.readUint8(),a=t.readUint8(),i=a>>>7?"H":"M",s=(64&a)>>6;s=2===(t=n>>>5)&&s?(32&a)>>5?12:10:s?10:8;var o=(16&a)>>4,l=(8&a)>>3,u=(4&a)>>2;return a&=3,{codec:e+"."+t+"."+r.addLeadingZero_(31&n)+i+"."+r.addLeadingZero_(s)+"."+o+"."+l+u+a+"."+r.addLeadingZero_(1)+"."+r.addLeadingZero_(1)+"."+r.addLeadingZero_(1)+".0"}},shaka.util.Mp4BoxParsers.parseFRMA=function(e){return e=e.readUint32(),{codec:shaka.util.Mp4Parser.typeToString(e)}},shaka.util.Mp4BoxParsers.parseTENC=function(e){var t=shaka.util.Uint8ArrayUtils;return e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),{defaultKID:t.toHex(e.readBytes(16))}},shaka.util.Mp4BoxParsers.parseHDLR=function(e){return e.skip(8),{handlerType:e.readTerminatedString()}},shaka.util.Mp4BoxParsers.parsePRJI=function(e){return{projection:e.readTerminatedString()}},shaka.util.Mp4BoxParsers.parseHFOV=function(e){return{hfov:e.readUint32()/1e3}},shaka.util.Mp4BoxParsers.parseCOLR=function(e){var t=null,r=null,n=e.readBytes(4),a=""+String.fromCharCode(n[0]);if(a+=String.fromCharCode(n[1]),a+=String.fromCharCode(n[2]),"nclx"===(a+=String.fromCharCode(n[3]))){switch(e.readUint16()){case 1:case 5:case 6:case 7:t="srgb";break;case 9:t="rec2020";break;case 11:case 12:t="p3"}switch(n=e.readUint16(),e.readUint16(),n){case 1:case 6:case 13:case 14:case 15:r="SDR";break;case 16:r="PQ";break;case 18:r="HLG"}}return{colorGamut:t,videoRange:r}},shaka.util.Mp4BoxParsers.updateAV1CodecWithCOLRBox=function(e,t){var r=shaka.util.Mp4BoxParsers,n=t.getPosition(),a=t.readBytes(4),i=""+String.fromCharCode(a[0]);if(i+=String.fromCharCode(a[1]),i+=String.fromCharCode(a[2]),"nclx"===(i+=String.fromCharCode(a[3]))){a=t.readUint16(),i=t.readUint16();var s=t.readUint16(),o=t.readUint8()>>7,l=e.split(".");10==l.length&&(l[6]=r.addLeadingZero_(a),l[7]=r.addLeadingZero_(i),l[8]=r.addLeadingZero_(s),l[9]=String(o),e=l.join("."))}return t.seek(n),e},shaka.util.Mp4BoxParsers.toHex_=function(e,t){return t=void 0!==t&&t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)},shaka.util.Mp4BoxParsers.reverseBits_=function(e){for(var t=0,r=0;32>r&&(t|=1&e,31!=r);r++)t<<=1,e>>=1;return t},shaka.util.Mp4BoxParsers.addLeadingZero_=function(e){return(10>e?"0":"")+e},shaka.util.Mp4Generator=function(e){shaka.util.Mp4Generator.initStaticProperties_(),this.streamInfos_=e},shaka.util.Mp4Generator.prototype.initSegment=function(){var e=shaka.util.Mp4Generator,t=this.moov_(),r=new Uint8Array(e.FTYP_.byteLength+t.byteLength);return r.set(e.FTYP_),r.set(t,e.FTYP_.byteLength),r},shaka.util.Mp4Generator.prototype.moov_=function(){goog.asserts.assert(0<this.streamInfos_.length,"StreamInfos must have elements");for(var e=shaka.util.Mp4Generator,t=[],r=$jscomp.makeIterator(this.streamInfos_),n=r.next();!n.done;n=r.next())t.push(this.trak_(n.value));return t=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(t)),r=this.streamInfos_[0],e.box("moov",this.mvhd_(r),t,this.mvex_(),this.pssh_(r))},shaka.util.Mp4Generator.prototype.mvhd_=function(e){var t=shaka.util.Mp4Generator,r=e.duration*e.timescale,n=Math.floor(r/(t.UINT32_MAX_+1));return r=Math.floor(r%(t.UINT32_MAX_+1)),e=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.timescale,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255])),t.box("mvhd",e)},shaka.util.Mp4Generator.prototype.trak_=function(e){return shaka.util.Mp4Generator.box("trak",this.tkhd_(e),this.mdia_(e))},shaka.util.Mp4Generator.prototype.tkhd_=function(e){var t=shaka.util.Mp4Generator,r=e.id+1,n=e.stream.width||0,a=e.stream.height||0;e.type==shaka.util.ManifestParserUtils.ContentType.AUDIO&&(a=n=0);var i=e.duration*e.timescale;return e=Math.floor(i/(t.UINT32_MAX_+1)),i=Math.floor(i%(t.UINT32_MAX_+1)),r=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)),[0,0,0,0],$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(i,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,2)),[0,0],$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(a,2)),[0,0])),t.box("tkhd",r)},shaka.util.Mp4Generator.prototype.mdia_=function(e){return shaka.util.Mp4Generator.box("mdia",this.mdhd_(e),this.hdlr_(e),this.minf_(e))},shaka.util.Mp4Generator.prototype.mdhd_=function(e){var t=shaka.util.Mp4Generator,r=e.duration*e.timescale,n=Math.floor(r/(t.UINT32_MAX_+1));r=Math.floor(r%(t.UINT32_MAX_+1));var a=e.stream.language;return a=a.charCodeAt(0)-96<<10|a.charCodeAt(1)-96<<5|a.charCodeAt(2)-96,e=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.timescale,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(a,2)),[0,0])),t.box("mdhd",e)},shaka.util.Mp4Generator.prototype.hdlr_=function(e){var t=shaka.util.Mp4Generator,r=shaka.util.ManifestParserUtils.ContentType,n=new Uint8Array([]);switch(e.type){case r.VIDEO:n=t.HDLR_TYPES_.video;break;case r.AUDIO:n=t.HDLR_TYPES_.audio}return t.box("hdlr",n)},shaka.util.Mp4Generator.prototype.minf_=function(e){var t=shaka.util.Mp4Generator,r=shaka.util.ManifestParserUtils.ContentType;switch(e.type){case r.VIDEO:return t.box("minf",t.box("vmhd",t.VMHD_),t.DINF_,this.stbl_(e));case r.AUDIO:return t.box("minf",t.box("smhd",t.SMHD_),t.DINF_,this.stbl_(e))}return new Uint8Array([])},shaka.util.Mp4Generator.prototype.stbl_=function(e){var t=shaka.util.Mp4Generator;return t.box("stbl",this.stsd_(e),t.box("stts",t.STTS_),t.box("stsc",t.STSC_),t.box("stsz",t.STSZ_),t.box("stco",t.STCO_))},shaka.util.Mp4Generator.prototype.stsd_=function(e){var t=shaka.util.Mp4Generator,r=shaka.util.ManifestParserUtils.ContentType,n="aac";e.codecs.includes("mp3")?n="mp3":e.codecs.includes("ac-3")?n=shaka.util.Platform.requiresEC3InitSegments()?"ec-3":"ac-3":e.codecs.includes("ec-3")?n="ec-3":e.codecs.includes("opus")&&(n="opus");var a=new Uint8Array([]);switch(e.type){case r.VIDEO:e.codecs.includes("avc1")?a=this.avc1_(e):e.codecs.includes("hvc1")&&(a=this.hvc1_(e));break;case r.AUDIO:a="mp3"==n?this.mp3_(e):"ac-3"==n?this.ac3_(e):"ec-3"==n?this.ec3_(e):"opus"==n?this.opus_(e):this.mp4a_(e)}return t.box("stsd",t.STSD_,a)},shaka.util.Mp4Generator.prototype.avc1_=function(e){var t=shaka.util.Mp4Generator,r=e.stream.width||0,n=e.stream.height||0,a=0<e.videoConfig.byteLength?t.box("avcC",e.videoConfig):t.box("avcC",this.avcC_(e));r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,2)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),n="avc1";var i=this.pasp_(e),s=new Uint8Array([]);return e.encrypted&&(s=this.sinf(e.stream,e.codecs),n="encv"),t.box(n,r,a,i,s)},shaka.util.Mp4Generator.prototype.avcC_=function(e){for(var t=7,r=[],n=[],a=0,i=0,s=0,o=0;o<e.videoNalus.length;o++){var l=this.hexStringToBuffer_(e.videoNalus[o]);switch(31&l[0]){case 7:r.push(l),t+=l.length+2;break;case 8:n.push(l),t+=l.length+2}}for(0<r.length&&(a=r[0][1],s=r[0][2],i=r[0][3]),e=new Uint8Array(t),t=0,e[t++]=1,e[t++]=a,e[t++]=s,e[t++]=i,e[t++]=255,e[t++]=224|r.length,a=0;a<r.length;a++)e[t++]=(65280&r[a].length)>>8,e[t++]=255&r[a].length,e.set(r[a],t),t+=r[a].length;for(e[t++]=n.length,r=0;r<n.length;r++)e[t++]=(65280&n[r].length)>>8,e[t++]=255&n[r].length,e.set(n[r],t),t+=n[r].length;return e},shaka.util.Mp4Generator.prototype.hvc1_=function(e){var t=shaka.util.Mp4Generator,r=e.stream.width||0,n=e.stream.height||0,a=new Uint8Array([]);0<e.videoConfig.byteLength&&(a=t.box("hvcC",e.videoConfig)),r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,2)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),n="hvc1";var i=this.pasp_(e),s=new Uint8Array([]);return e.encrypted&&(s=this.sinf(e.stream,e.codecs),n="encv"),t.box(n,r,a,i,s)},shaka.util.Mp4Generator.prototype.pasp_=function(e){if(!e.hSpacing&&!e.vSpacing)return new Uint8Array([]);var t=shaka.util.Mp4Generator,r=e.vSpacing;return e=new Uint8Array([].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.hSpacing,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)))),t.box("pasp",e)},shaka.util.Mp4Generator.prototype.audioStsd_=function(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.stream.audioSamplingRate||44100,2)),[0,0]))},shaka.util.Mp4Generator.prototype.mp3_=function(e){return shaka.util.Mp4Generator.box(".mp3",this.audioStsd_(e))},shaka.util.Mp4Generator.prototype.ac3_=function(e){var t=shaka.util.Mp4Generator,r=t.box("dac3",e.audioConfig),n="ac-3",a=new Uint8Array([]);return e.encrypted&&(a=this.sinf(e.stream,e.codecs),n="enca"),t.box(n,this.audioStsd_(e),r,a)},shaka.util.Mp4Generator.prototype.ec3_=function(e){var t=shaka.util.Mp4Generator,r=t.box("dec3",e.audioConfig),n="ec-3",a=new Uint8Array([]);return e.encrypted&&(a=this.sinf(e.stream,e.codecs),n="enca"),t.box(n,this.audioStsd_(e),r,a)},shaka.util.Mp4Generator.prototype.opus_=function(e){var t=shaka.util.Mp4Generator,r=t.box("dOps",e.audioConfig),n="Opus",a=new Uint8Array([]);return e.encrypted&&(a=this.sinf(e.stream,e.codecs),n="enca"),t.box(n,this.audioStsd_(e),r,a)},shaka.util.Mp4Generator.prototype.mp4a_=function(e){var t=shaka.util.Mp4Generator,r=0<e.audioConfig.byteLength?t.box("esds",e.audioConfig):t.box("esds",this.esds_(e)),n="mp4a",a=new Uint8Array([]);return e.encrypted&&(a=this.sinf(e.stream,e.codecs),n="enca"),t.box(n,this.audioStsd_(e),r,a)},shaka.util.Mp4Generator.prototype.esds_=function(e){var t=e.id+1,r=e.stream.channelsCount||2,n=e.stream.audioSamplingRate||44100,a=shaka.util.ManifestParserUtils.guessCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e.codecs.split(",")),i={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return e=i[n],"mp4a.40.5"!==a&&"mp4a.40.29"!==a||(e=i[2*n]),n=parseInt(a.split(".").pop(),10),new Uint8Array([0,0,0,0,3,25].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(t,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,n<<3|e>>>1,e<<7|r<<3,6,1,2]))},shaka.util.Mp4Generator.prototype.mvex_=function(){for(var e=shaka.util.Mp4Generator,t=[],r=$jscomp.makeIterator(this.streamInfos_),n=r.next();!n.done;n=r.next())t.push(this.trex_(n.value));return t=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(t)),e.box("mvex",t)},shaka.util.Mp4Generator.prototype.trex_=function(e){var t=shaka.util.Mp4Generator;return e=new Uint8Array([0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),t.box("trex",e)},shaka.util.Mp4Generator.prototype.pssh_=function(e){var t=[];if(!e.encrypted)return new Uint8Array([]);for(var r=(e=$jscomp.makeIterator(e.stream.drmInfos)).next();!r.done;r=e.next())if((r=r.value).initData)for(var n=(r=$jscomp.makeIterator(r.initData)).next();!n.done;n=r.next())t.push(n.value.initData);return shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(t))},shaka.util.Mp4Generator.prototype.sinf=function(e,t){return shaka.util.Mp4Generator.box("sinf",this.frma_(t),this.schm_(e),this.schi_(e))},shaka.util.Mp4Generator.prototype.frma_=function(e){var t=e.split(".")[0];return e=shaka.util.Mp4Generator,t=this.stringToCharCode_(t),t=new Uint8Array([].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(t,4)))),e.box("frma",t)},shaka.util.Mp4Generator.prototype.schm_=function(e){var t="cenc";return(e=e.drmInfos[0])&&e.encryptionScheme&&(t=e.encryptionScheme),e=shaka.util.Mp4Generator,t=this.stringToCharCode_(t),t=new Uint8Array([0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(t,4)),[0,1,0,0])),e.box("schm",t)},shaka.util.Mp4Generator.prototype.schi_=function(e){return shaka.util.Mp4Generator.box("schi",this.tenc_(e))},shaka.util.Mp4Generator.prototype.tenc_=function(e){for(var t=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),r=(e=$jscomp.makeIterator(e.drmInfos)).next();!r.done;r=e.next())if((r=r.value)&&r.keyIds&&r.keyIds.size)for(var n=(r=$jscomp.makeIterator(r.keyIds)).next();!n.done;n=r.next())t=this.hexStringToBuffer_(n.value);return e=shaka.util.Mp4Generator,r=new Uint8Array([0,0,0,0,0,0,1,8]),goog.asserts.assert(t,"Default KID should be non-null"),e.box("tenc",r,t)},shaka.util.Mp4Generator.prototype.segmentData=function(){for(var e=[],t=$jscomp.makeIterator(this.streamInfos_),r=t.next();!r.done;r=t.next())r=r.value,e.push.apply(e,[this.moof_(r),this.mdat_(r)]);return shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(e))},shaka.util.Mp4Generator.prototype.moof_=function(e){return shaka.util.Mp4Generator.box("moof",this.mfhd_(e),this.traf_(e))},shaka.util.Mp4Generator.prototype.mfhd_=function(e){var t=shaka.util.Mp4Generator;return e=new Uint8Array([0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.data?e.data.sequenceNumber:0,4)))),t.box("mfhd",e)},shaka.util.Mp4Generator.prototype.traf_=function(e){var t=shaka.util.Mp4Generator,r=this.sdtp_(e),n=r.length+32+20+8+16+8+8;return t.box("traf",this.tfhd_(e),this.tfdt_(e),this.trun_(e,n),r)},shaka.util.Mp4Generator.prototype.sdtp_=function(e){var t=shaka.util.Mp4Generator;e=e.data?e.data.samples:[];for(var r=new Uint8Array(4+e.length),n=0;n<e.length;n++){var a=e[n].flags;r[n+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy}return t.box("sdtp",r)},shaka.util.Mp4Generator.prototype.tfhd_=function(e){var t=shaka.util.Mp4Generator;return e=new Uint8Array([0,0,0,58].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),t.box("tfhd",e)},shaka.util.Mp4Generator.prototype.tfdt_=function(e){var t=shaka.util.Mp4Generator;e=e.data?e.data.baseMediaDecodeTime:0;var r=Math.floor(e%(t.UINT32_MAX_+1));return e=new Uint8Array([1,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(Math.floor(e/(t.UINT32_MAX_+1)),4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)))),t.box("tfdt",e)},shaka.util.Mp4Generator.prototype.trun_=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType,n=shaka.util.Mp4Generator,a=e.data?e.data.samples:[],i=a.length,s=12+16*i,o=new Uint8Array(s);for(t+=8+s,o.set([e.type===r.VIDEO?1:0,0,15,1].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(i,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(t,4))),0),e=0;e<i;e++){var l=a[e];t=this.breakNumberIntoBytes_(l.duration,4),r=this.breakNumberIntoBytes_(l.size,4),s=l.flags,l=this.breakNumberIntoBytes_(l.cts,4),o.set([].concat($jscomp.arrayFromIterable(t),$jscomp.arrayFromIterable(r),[s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.isNonSync,61440&s.degradPrio,15&s.degradPrio],$jscomp.arrayFromIterable(l)),12+16*e)}return n.box("trun",o)},shaka.util.Mp4Generator.prototype.mdat_=function(e){var t=shaka.util.Mp4Generator;return e=(e.data?e.data.samples:[]).map((function(e){return e.data})),e=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(e)),t.box("mdat",e)},shaka.util.Mp4Generator.prototype.breakNumberIntoBytes_=function(e,t){var r=[];for(--t;0<=t;t--)r.push(e>>8*t&255);return r},shaka.util.Mp4Generator.prototype.hexStringToBuffer_=function(e){for(var t=new Uint8Array(e.length/2),r=0;r<e.length/2;r+=1)t[r]=parseInt(String(e[2*r]+e[2*r+1]),16);return t},shaka.util.Mp4Generator.prototype.stringToCharCode_=function(e){for(var t=0,r=0;r<e.length;r+=1)t|=e.charCodeAt(r)<<8*(e.length-r-1);return t},shaka.util.Mp4Generator.initStaticProperties_=function(){var e=shaka.util.Mp4Generator;if(!e.initialized_){e.initialized_=!0;var t=new Uint8Array([105,115,111,109]),r=new Uint8Array([97,118,99,49]),n=new Uint8Array([0,0,0,1]);e.FTYP_=e.box("ftyp",t,n,t,r),t=e.box("dref",e.DREF_),e.DINF_=e.box("dinf",t)}},shaka.util.Mp4Generator.box=function(e){var t=$jscomp.getRestArguments.apply(1,arguments),r=shaka.util.Mp4Generator.BOX_TYPES_.get(e);r||(r=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],shaka.util.Mp4Generator.BOX_TYPES_.set(e,r));for(var n=8,a=t.length-1;0<=a;a--)n+=t[a].byteLength;for((a=new Uint8Array(n))[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=255&n,a.set(r,4),r=0,n=8;r<t.length;r++)a.set(t[r],n),n+=t[r].byteLength;return a},shaka.util.Mp4Generator.initialized_=!1,shaka.util.Mp4Generator.UINT32_MAX_=Math.pow(2,32)-1,shaka.util.Mp4Generator.BOX_TYPES_=new Map,shaka.util.Mp4Generator.HDLR_TYPES_={video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])},shaka.util.Mp4Generator.STTS_=new Uint8Array([0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.STSC_=new Uint8Array([0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.STCO_=new Uint8Array([0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.STSZ_=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.VMHD_=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.SMHD_=new Uint8Array([0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.STSD_=new Uint8Array([0,0,0,0,0,0,0,1]),shaka.util.Mp4Generator.FTYP_=new Uint8Array([]),shaka.util.Mp4Generator.DREF_=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),shaka.util.Mp4Generator.DINF_=new Uint8Array([]),shaka.media.ContentWorkarounds=function(){},shaka.media.ContentWorkarounds.fakeEncryption=function(e,t,r){var n,a=shaka.media.ContentWorkarounds,i=t=shaka.util.BufferUtils.toUint8(t),s=!1,o=[],l=function(e){o.push(e),shaka.util.Mp4Parser.children(e)},u=function(e){s=!0,e.parser.stop()},c=[],d=function(e){c.push({box:e,newType:a.BOX_TYPE_ENCV_})},p=function(e){c.push({box:e,newType:a.BOX_TYPE_ENCA_})};if((new shaka.util.Mp4Parser).box("moov",l).box("trak",l).box("mdia",l).box("minf",l).box("stbl",l).fullBox("stsd",(function(e){n=e,o.push(e),shaka.util.Mp4Parser.sampleDescription(e)})).fullBox("encv",u).fullBox("enca",u).fullBox("dvav",d).fullBox("dva1",d).fullBox("dvh1",d).fullBox("dvhe",d).fullBox("dvc1",d).fullBox("dvi1",d).fullBox("hev1",d).fullBox("hvc1",d).fullBox("avc1",d).fullBox("avc3",d).fullBox("ac-3",p).fullBox("ec-3",p).fullBox("ac-4",p).fullBox("Opus",p).fullBox("fLaC",p).fullBox("mp4a",p).parse(t),s)return shaka.log.debug("Init segment already indicates encryption."),t;if(0==c.length||!n)throw shaka.log.error("Failed to find boxes needed to fake encryption!"),shaka.log.v2("Failed init segment (hex):",shaka.util.Uint8ArrayUtils.toHex(t)),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.CONTENT_TRANSFORMATION_FAILED,r);for(c.reverse(),l=(r=$jscomp.makeIterator(c)).next();!l.done;l=r.next())l=l.value,u=shaka.util.Mp4Parser.typeToString(l.newType),shaka.log.debug('Inserting "'+u+'" box into init segment.'),i=a.insertEncryptionMetadata_(e,i,n,l.box,o,l.newType);return shaka.util.Platform.isEdge()&&shaka.util.Platform.isWindows()&&!shaka.util.Platform.isXboxOne()?((e=new Uint8Array(t.byteLength+i.byteLength)).set(i),e.set(t,i.byteLength),e):i},shaka.media.ContentWorkarounds.fakeMediaEncryption=function(e){e=shaka.util.BufferUtils.toUint8(e);var t=[];(new shaka.util.Mp4Parser).box("mdat",(function(e){t.push(e)})).parse(e);for(var r=[],n=0;n<t.length;n++){var a=t[n-1],i=t[n];a=e.subarray(a?a.start+a.size:0,i.start+i.size),r.push(shaka.media.ContentWorkarounds.fakeMediaEncryptionInChunk_(a))}return shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(r))},shaka.media.ContentWorkarounds.fakeMediaEncryptionInChunk_=function(e){var t,r,n,a,i=[],s=function(e){i.push(e),shaka.util.Mp4Parser.children(e)};if((new shaka.util.Mp4Parser).box("moof",s).box("traf",s).fullBox("tfhd",(function(e){t=e,n=shaka.util.Mp4BoxParsers.parseTFHD(e.reader,e.flags)})).fullBox("trun",(function(e){r=e,a=shaka.util.Mp4BoxParsers.parseTRUN(e.reader,e.version,e.flags)})).parse(e),n&&2!==n.sampleDescriptionIndex){s=t.start+shaka.util.Mp4Parser.headerSize(t)+4+(null!==n.baseDataOffset?8:0);var o=shaka.util.BufferUtils.toDataView(e);if(null!==n.sampleDescriptionIndex)o.setUint32(s,2);else{shaka.media.ContentWorkarounds.updateBoxSize_(e,t.start,t.size+4);var l=o.getUint32(t.start+8);if(o.setUint32(t.start+8,2|l),a&&null!==a.dataOffset){l=a.dataOffset+4;var u=r.start+shaka.util.Mp4Parser.headerSize(r)+4;o.setInt32(u,l)}for(l=e.subarray(0,s),o=e.subarray(s),(e=new Uint8Array(e.byteLength+4)).set(l),l=[],u=3;0<=u;u--)l.push(2>>8*u&255);for(e.set(new Uint8Array(l),s),e.set(o,s+4),o=(s=$jscomp.makeIterator(i)).next();!o.done;o=s.next())o=o.value,shaka.media.ContentWorkarounds.updateBoxSize_(e,o.start,o.size+4)}}return e},shaka.media.ContentWorkarounds.insertEncryptionMetadata_=function(e,t,r,n,a,i){var s=shaka.media.ContentWorkarounds;i=s.createEncryptionMetadata_(e,t,n,i),e=new Uint8Array(t.byteLength+i.byteLength),n=shaka.util.Platform.isApple()||shaka.util.Platform.isXboxOne()||shaka.util.Platform.isEdge()?n.start:n.start+n.size;var o=t.subarray(0,n);for(t=t.subarray(n),e.set(o),e.set(i,n),e.set(t,n+i.byteLength),t=(a=$jscomp.makeIterator(a)).next();!t.done;t=a.next())t=t.value,goog.asserts.assert(t.start<n,"Ancestor MP4 box found in the wrong location!  Modified init segment will not make sense!"),s.updateBoxSize_(e,t.start,t.size+i.byteLength);return s=shaka.util.BufferUtils.toDataView(e,r.start),r=shaka.util.Mp4Parser.headerSize(r),i=s.getUint32(r),s.setUint32(r,i+1),e},shaka.media.ContentWorkarounds.createEncryptionMetadata_=function(e,t,r,n){var a=shaka.media.ContentWorkarounds;e=new shaka.util.Mp4Generator([]).sinf(e,r.name),t=t.subarray(r.start,r.start+r.size);var i=new Uint8Array(r.size+e.byteLength);return i.set(t,0),shaka.util.BufferUtils.toDataView(i).setUint32(a.BOX_TYPE_OFFSET_,n),i.set(e,r.size),a.updateBoxSize_(i,0,i.byteLength),i},shaka.media.ContentWorkarounds.updateBoxSize_=function(e,t,r){var n=shaka.media.ContentWorkarounds;0!=(t=(e=shaka.util.BufferUtils.toDataView(e,t)).getUint32(n.BOX_SIZE_OFFSET_))&&(1==t?(e.setUint32(n.BOX_SIZE_64_OFFSET_,r>>32),e.setUint32(n.BOX_SIZE_64_OFFSET_+4,4294967295&r)):e.setUint32(n.BOX_SIZE_OFFSET_,r))},shaka.media.ContentWorkarounds.fakeEC3=function(e){var t=shaka.media.ContentWorkarounds,r=shaka.util.BufferUtils.toUint8(e),n=[];return e=function(e){n.push({start:e.start,size:e.size}),shaka.util.Mp4Parser.children(e)},(new shaka.util.Mp4Parser).box("moov",e).box("trak",e).box("mdia",e).box("minf",e).box("stbl",e).box("stsd",(function(e){n.push({start:e.start,size:e.size});for(var a=shaka.util.BufferUtils.toDataView(r,e.start),i=0;i<e.size-3;i++){var s=a.getUint32(i);s==t.BOX_TYPE_AC_3_?a.setUint32(i,t.BOX_TYPE_EC_3_):s==t.BOX_TYPE_DAC3_&&a.setUint32(i,t.BOX_TYPE_DEC3_)}})).parse(r),r},shaka.media.ContentWorkarounds.BOX_SIZE_OFFSET_=0,shaka.media.ContentWorkarounds.BOX_TYPE_OFFSET_=4,shaka.media.ContentWorkarounds.BOX_SIZE_64_OFFSET_=8,shaka.media.ContentWorkarounds.BOX_TYPE_ENCV_=1701733238,shaka.media.ContentWorkarounds.BOX_TYPE_ENCA_=1701733217,shaka.media.ContentWorkarounds.BOX_TYPE_AC_3_=1633889587,shaka.media.ContentWorkarounds.BOX_TYPE_DAC3_=1684103987,shaka.media.ContentWorkarounds.BOX_TYPE_EC_3_=1700998451,shaka.media.ContentWorkarounds.BOX_TYPE_DEC3_=1684366131,shaka.media.InitSegmentReference=function(e,t,r,n,a,i,s,o){this.getUris=e,this.startByte=t,this.endByte=r,this.mediaQuality=void 0===n?null:n,this.timescale=void 0===a?null:a,this.segmentData=void 0===i?null:i,this.aesKey=void 0===s?null:s,this.boundaryEnd=this.mimeType=this.codecs=null,this.encrypted=void 0!==o&&o},shaka.media.InitSegmentReference.prototype.getStartByte=function(){return this.startByte},shaka.media.InitSegmentReference.prototype.getEndByte=function(){return this.endByte},shaka.media.InitSegmentReference.prototype.getSize=function(){return this.endByte?this.endByte-this.startByte:null},shaka.media.InitSegmentReference.prototype.getMediaQuality=function(){return this.mediaQuality},shaka.media.InitSegmentReference.prototype.setSegmentData=function(e){this.segmentData=e},shaka.media.InitSegmentReference.prototype.getSegmentData=function(){return this.segmentData},shaka.media.InitSegmentReference.equal=function(e,t){var r=shaka.util.ArrayUtils,n=shaka.util.BufferUtils;return e===t||(e&&t?e.getStartByte()==t.getStartByte()&&e.getEndByte()==t.getEndByte()&&r.equal(e.getUris().sort(),t.getUris().sort())&&n.equal(e.getSegmentData(),t.getSegmentData()):e==t)},goog.exportSymbol("shaka.media.InitSegmentReference",shaka.media.InitSegmentReference),goog.exportProperty(shaka.media.InitSegmentReference.prototype,"getEndByte",shaka.media.InitSegmentReference.prototype.getEndByte),goog.exportProperty(shaka.media.InitSegmentReference.prototype,"getStartByte",shaka.media.InitSegmentReference.prototype.getStartByte),shaka.media.SegmentReference=function(e,t,r,n,a,i,s,o,l,u,c,d,p,h,f,m){for(u=void 0===u?[]:u,c=void 0===c?"":c,d=void 0===d?null:d,p=void 0===p?null:p,h=void 0===h?shaka.media.SegmentReference.Status.AVAILABLE:h,f=void 0===f?null:f,m=void 0!==m&&m,goog.asserts.assert(e<=t,"startTime must be less than or equal to endTime"),goog.asserts.assert(null==a||n<a,"startByte must be < endByte"),this.startTime=e,this.trueEndTime=this.endTime=t,this.getUrisInner=r,this.startByte=n,this.endByte=a,this.initSegmentReference=i,this.timestampOffset=s,this.appendWindowStart=o,this.appendWindowEnd=l,this.partialReferences=u,this.tilesLayout=c,this.tileDuration=d,this.syncTime=p,this.status=h,this.preload=!1,this.independent=!0,this.byterangeOptimization=!1,this.aesKey=f,this.thumbnailSprite=null,this.discontinuitySequence=-1,this.allPartialSegments=m,this.lastPartial=this.partial=!1,t=(e=$jscomp.makeIterator(this.partialReferences)).next();!t.done;t=e.next())t.value.markAsPartial();this.allPartialSegments&&this.partialReferences.length&&this.partialReferences[this.partialReferences.length-1].markAsLastPartial(),this.segmentData=this.bandwidth=this.mimeType=this.codecs=null,this.removeSegmentDataOnGet=!1},shaka.media.SegmentReference.prototype.getUris=function(){return this.getUrisInner()},shaka.media.SegmentReference.prototype.getStartTime=function(){return this.startTime},shaka.media.SegmentReference.prototype.getEndTime=function(){return this.endTime},shaka.media.SegmentReference.prototype.getStartByte=function(){return this.startByte},shaka.media.SegmentReference.prototype.getEndByte=function(){return this.endByte},shaka.media.SegmentReference.prototype.getSize=function(){return this.endByte?this.endByte-this.startByte:null},shaka.media.SegmentReference.prototype.hasPartialSegments=function(){return 0<this.partialReferences.length},shaka.media.SegmentReference.prototype.hasAllPartialSegments=function(){return this.allPartialSegments},shaka.media.SegmentReference.prototype.getTilesLayout=function(){return this.tilesLayout},shaka.media.SegmentReference.prototype.getTileDuration=function(){return this.tileDuration},shaka.media.SegmentReference.prototype.getStatus=function(){return this.status},shaka.media.SegmentReference.prototype.markAsUnavailable=function(){this.status=shaka.media.SegmentReference.Status.UNAVAILABLE},shaka.media.SegmentReference.prototype.markAsPreload=function(){this.preload=!0},shaka.media.SegmentReference.prototype.isPreload=function(){return this.preload},shaka.media.SegmentReference.prototype.markAsNonIndependent=function(){this.independent=!1},shaka.media.SegmentReference.prototype.isIndependent=function(){return this.independent},shaka.media.SegmentReference.prototype.markAsPartial=function(){this.partial=!0},shaka.media.SegmentReference.prototype.isPartial=function(){return this.partial},shaka.media.SegmentReference.prototype.markAsLastPartial=function(){this.lastPartial=!0},shaka.media.SegmentReference.prototype.isLastPartial=function(){return this.lastPartial},shaka.media.SegmentReference.prototype.markAsByterangeOptimization=function(){this.byterangeOptimization=!0},shaka.media.SegmentReference.prototype.hasByterangeOptimization=function(){return this.byterangeOptimization},shaka.media.SegmentReference.prototype.setThumbnailSprite=function(e){this.thumbnailSprite=e},shaka.media.SegmentReference.prototype.getThumbnailSprite=function(){return this.thumbnailSprite},shaka.media.SegmentReference.prototype.offset=function(e){this.startTime+=e,this.endTime+=e,this.trueEndTime+=e;for(var t=$jscomp.makeIterator(this.partialReferences),r=t.next();!r.done;r=t.next())(r=r.value).startTime+=e,r.endTime+=e,r.trueEndTime+=e},shaka.media.SegmentReference.prototype.syncAgainst=function(e){null==this.syncTime?shaka.log.alwaysError("Sync attempted without sync time!"):(e=this.syncTime-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},shaka.media.SegmentReference.prototype.setSegmentData=function(e,t){this.segmentData=e,this.removeSegmentDataOnGet=void 0!==t&&t},shaka.media.SegmentReference.prototype.getSegmentData=function(e){var t=this.segmentData;return(void 0===e||e)&&this.removeSegmentDataOnGet&&(this.segmentData=null),t},shaka.media.SegmentReference.prototype.updateInitSegmentReference=function(e){this.initSegmentReference=e;for(var t=$jscomp.makeIterator(this.partialReferences),r=t.next();!r.done;r=t.next())r.value.updateInitSegmentReference(e)},goog.exportSymbol("shaka.media.SegmentReference",shaka.media.SegmentReference),goog.exportProperty(shaka.media.SegmentReference.prototype,"getSegmentData",shaka.media.SegmentReference.prototype.getSegmentData),goog.exportProperty(shaka.media.SegmentReference.prototype,"setSegmentData",shaka.media.SegmentReference.prototype.setSegmentData),goog.exportProperty(shaka.media.SegmentReference.prototype,"syncAgainst",shaka.media.SegmentReference.prototype.syncAgainst),goog.exportProperty(shaka.media.SegmentReference.prototype,"offset",shaka.media.SegmentReference.prototype.offset),goog.exportProperty(shaka.media.SegmentReference.prototype,"getThumbnailSprite",shaka.media.SegmentReference.prototype.getThumbnailSprite),goog.exportProperty(shaka.media.SegmentReference.prototype,"setThumbnailSprite",shaka.media.SegmentReference.prototype.setThumbnailSprite),goog.exportProperty(shaka.media.SegmentReference.prototype,"hasByterangeOptimization",shaka.media.SegmentReference.prototype.hasByterangeOptimization),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsByterangeOptimization",shaka.media.SegmentReference.prototype.markAsByterangeOptimization),goog.exportProperty(shaka.media.SegmentReference.prototype,"isLastPartial",shaka.media.SegmentReference.prototype.isLastPartial),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsLastPartial",shaka.media.SegmentReference.prototype.markAsLastPartial),goog.exportProperty(shaka.media.SegmentReference.prototype,"isPartial",shaka.media.SegmentReference.prototype.isPartial),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsPartial",shaka.media.SegmentReference.prototype.markAsPartial),goog.exportProperty(shaka.media.SegmentReference.prototype,"isIndependent",shaka.media.SegmentReference.prototype.isIndependent),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsNonIndependent",shaka.media.SegmentReference.prototype.markAsNonIndependent),goog.exportProperty(shaka.media.SegmentReference.prototype,"isPreload",shaka.media.SegmentReference.prototype.isPreload),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsPreload",shaka.media.SegmentReference.prototype.markAsPreload),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsUnavailable",shaka.media.SegmentReference.prototype.markAsUnavailable),goog.exportProperty(shaka.media.SegmentReference.prototype,"getStatus",shaka.media.SegmentReference.prototype.getStatus),goog.exportProperty(shaka.media.SegmentReference.prototype,"getTileDuration",shaka.media.SegmentReference.prototype.getTileDuration),goog.exportProperty(shaka.media.SegmentReference.prototype,"getTilesLayout",shaka.media.SegmentReference.prototype.getTilesLayout),goog.exportProperty(shaka.media.SegmentReference.prototype,"getEndByte",shaka.media.SegmentReference.prototype.getEndByte),goog.exportProperty(shaka.media.SegmentReference.prototype,"getStartByte",shaka.media.SegmentReference.prototype.getStartByte),goog.exportProperty(shaka.media.SegmentReference.prototype,"getEndTime",shaka.media.SegmentReference.prototype.getEndTime),goog.exportProperty(shaka.media.SegmentReference.prototype,"getStartTime",shaka.media.SegmentReference.prototype.getStartTime),goog.exportProperty(shaka.media.SegmentReference.prototype,"getUris",shaka.media.SegmentReference.prototype.getUris),shaka.media.SegmentReference.Status={AVAILABLE:0,UNAVAILABLE:1,MISSING:2},goog.exportProperty(shaka.media.SegmentReference,"Status",shaka.media.SegmentReference.Status),shaka.media.TimeRangesUtils=function(){},shaka.media.TimeRangesUtils.isBufferNegligible_=function(e){return 1==e.length&&1e-4>e.end(0)-e.start(0)},shaka.media.TimeRangesUtils.bufferStart=function(e){return!e||shaka.media.TimeRangesUtils.isBufferNegligible_(e)?null:1==e.length&&0>e.start(0)?0:e.length?e.start(0):null},shaka.media.TimeRangesUtils.bufferEnd=function(e){return!e||shaka.media.TimeRangesUtils.isBufferNegligible_(e)?null:e.length?e.end(e.length-1):null},shaka.media.TimeRangesUtils.isBuffered=function(e,t){return!(!e||!e.length||shaka.media.TimeRangesUtils.isBufferNegligible_(e)||t>e.end(e.length-1))&&t>=e.start(0)},shaka.media.TimeRangesUtils.bufferedAheadOf=function(e,t){if(!e||!e.length||shaka.media.TimeRangesUtils.isBufferNegligible_(e))return 0;for(var r=0,n=(e=$jscomp.makeIterator(shaka.media.TimeRangesUtils.getBufferedInfo(e))).next();!n.done;n=e.next()){var a=n.value;n=a.start,(a=a.end)>t&&(r+=a-Math.max(n,t))}return r},shaka.media.TimeRangesUtils.getGapIndex=function(e,t,r){var n=shaka.media.TimeRangesUtils;return e&&e.length&&!shaka.media.TimeRangesUtils.isBufferNegligible_(e)&&0<=(e=n.getBufferedInfo(e).findIndex((function(e,n,a){return e.start>t&&(0==n||a[n-1].end-t<=r)})))?e:null},shaka.media.TimeRangesUtils.getBufferedInfo=function(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t},shaka.media.TimeRangesUtils.computeAddedRange=function(e,t){var r=shaka.media.TimeRangesUtils;if(!e||!e.length)return null;if(!t||!t.length)return r.getBufferedInfo(t).pop();for(t=r.getBufferedInfo(t).reverse(),e=r.getBufferedInfo(e).reverse(),t=(r=$jscomp.makeIterator(t)).next();!t.done;t=r.next()){t=t.value;for(var n=!1,a=$jscomp.makeIterator(e),i=a.next();!i.done;i=a.next())if((i=i.value).end>=t.start&&i.end<=t.end&&(n=!0,t.end>i.end))return{start:i.end,end:t.end};if(!n)return t}return null},shaka.util.Dom=function(){},shaka.util.Dom.createHTMLElement=function(e){return document.createElement(e)},shaka.util.Dom.createButton=function(){var e=document.createElement("button");return e.setAttribute("type","button"),e},shaka.util.Dom.createSourceElement=function(e,t){t=void 0===t?"":t;var r=document.createElement("source");return r.src=e,r.type=t,r},shaka.util.Dom.asHTMLElement=function(e){return e},shaka.util.Dom.asHTMLCanvasElement=function(e){return e},shaka.util.Dom.asHTMLMediaElement=function(e){return e},shaka.util.Dom.getElementByClassName=function(e,t){return t=t.getElementsByClassName(e),goog.asserts.assert(1==t.length,"Should only be one element with class name "+e),shaka.util.Dom.asHTMLElement(t[0])},shaka.util.Dom.removeAllChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},goog.exportSymbol("shaka.util.Dom",shaka.util.Dom),goog.exportProperty(shaka.util.Dom,"removeAllChildren",shaka.util.Dom.removeAllChildren),shaka.util.Id3Utils=function(){},shaka.util.Id3Utils.isHeader_=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]},shaka.util.Id3Utils.isFooter_=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]},shaka.util.Id3Utils.readSize_=function(e,t){var r=(127&e[t])<<21;return r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]},shaka.util.Id3Utils.getFrameData_=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=shaka.util.Id3Utils.readSize_(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}},shaka.util.Id3Utils.decodeFrame_=function(e){var t=shaka.util.BufferUtils,r=shaka.util.StringUtils,n={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if("APIC"===e.type){if(2>e.size)return null;if(e.data[0]!==shaka.util.Id3Utils.UTF8_encoding)return shaka.log.warning("Ignore frame with unrecognized character encoding"),null;var a=e.data.subarray(1).indexOf(0);if(-1===a)return null;var i=r.fromUTF8(t.toUint8(e.data,1,a)),s=e.data[2+a],o=e.data.subarray(3+a).indexOf(0);if(-1===o)return null;var l=r.fromUTF8(t.toUint8(e.data,3+a,o));return e="--\x3e"===i?r.fromUTF8(t.toUint8(e.data,4+a+o)):t.toArrayBuffer(e.data.subarray(4+a+o)),n.mimeType=i,n.pictureType=s,n.description=l,n.data=e,n}return"TXXX"===e.type||"WXXX"===e.type?2>e.size?null:e.data[0]!==shaka.util.Id3Utils.UTF8_encoding?(shaka.log.warning("Ignore frame with unrecognized character encoding"),null):-1===(s=e.data.subarray(1).indexOf(0))?null:(i=r.fromUTF8(t.toUint8(e.data,1,s)),e=r.fromUTF8(t.toUint8(e.data,2+s)).replace(/\0*$/,""),n.description=i,n.data=e,n):"PRIV"===e.type?2>e.size||-1===(i=e.data.indexOf(0))?null:(r=r.fromUTF8(t.toUint8(e.data,0,i)),n.description=r,"com.apple.streaming.transportStreamTimestamp"==r?(t=e.data.subarray(r.length+1),e=1&t[3],t=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7],t/=45,e&&(t+=47721858.84),n.data=t):(e=t.toArrayBuffer(e.data.subarray(r.length+1)),n.data=e),n):"T"===e.type[0]?2>e.size?null:e.data[0]!==shaka.util.Id3Utils.UTF8_encoding?(shaka.log.warning("Ignore frame with unrecognized character encoding"),null):(e=r.fromUTF8(e.data.subarray(1)).replace(/\0*$/,""),n.data=e,n):"W"===e.type[0]?(e=r.fromUTF8(e.data).replace(/\0*$/,""),n.data=e,n):e.data?(shaka.log.warning("Unrecognized ID3 frame type:",e.type),n.data=t.toArrayBuffer(e.data),n):null},shaka.util.Id3Utils.getID3Frames=function(e){for(var t=shaka.util.Id3Utils,r=0,n=[];t.isHeader_(e,r);){var a=t.readSize_(e,r+6);for(e[r+5]>>6&1&&(r+=10),a=(r+=10)+a;r+10<a;){var i=t.getFrameData_(e.subarray(r)),s=t.decodeFrame_(i);s&&n.push(s),r+=i.size+10}t.isFooter_(e,r)&&(r+=10)}return n},shaka.util.Id3Utils.getID3Data=function(e,t){t=void 0===t?0:t;for(var r=shaka.util.Id3Utils,n=t,a=0;r.isHeader_(e,t);){e[t+5]>>6&1&&(a+=10),a+=10,a+=r.readSize_(e,t+6),r.isFooter_(e,t+10)&&(a+=10),t+=a}return 0<a?e.subarray(n,n+a):new Uint8Array([])},goog.exportSymbol("shaka.util.Id3Utils",shaka.util.Id3Utils),goog.exportProperty(shaka.util.Id3Utils,"getID3Data",shaka.util.Id3Utils.getID3Data),goog.exportProperty(shaka.util.Id3Utils,"getID3Frames",shaka.util.Id3Utils.getID3Frames),shaka.util.Id3Utils.UTF8_encoding=3,shaka.util.ExpGolomb=function(e,t){this.data_=e,void 0!==t&&t&&(this.data_=this.ebsp2rbsp_(e)),this.workingBytesAvailable_=this.data_.byteLength,this.workingBitsAvailable_=this.workingWord_=0},shaka.util.ExpGolomb.prototype.ebsp2rbsp_=function(e){for(var t=new Uint8Array(e.byteLength),r=0,n=0;n<e.byteLength;n++)2<=n&&3==e[n]&&0==e[n-1]&&0==e[n-2]||(t[r]=e[n],r++);return shaka.util.BufferUtils.toUint8(t,0,r)},shaka.util.ExpGolomb.prototype.loadWord_=function(){var e=this.data_.byteLength-this.workingBytesAvailable_,t=new Uint8Array(4),r=Math.min(4,this.workingBytesAvailable_);0!==r&&(t.set(this.data_.subarray(e,e+r)),this.workingWord_=new shaka.util.DataViewReader(t,shaka.util.DataViewReader.Endianness.BIG_ENDIAN).readUint32(),this.workingBitsAvailable_=8*r,this.workingBytesAvailable_-=r)},shaka.util.ExpGolomb.prototype.skipBits=function(e){if(this.workingBitsAvailable_<=e){e-=this.workingBitsAvailable_;var t=Math.floor(e/8);e-=8*t,this.workingBitsAvailable_-=t,this.loadWord_()}this.workingWord_<<=e,this.workingBitsAvailable_-=e},shaka.util.ExpGolomb.prototype.readBits=function(e){var t=Math.min(this.workingBitsAvailable_,e),r=this.workingWord_>>>32-t;return this.workingBitsAvailable_-=t,0<this.workingBitsAvailable_?this.workingWord_<<=t:0<this.workingBytesAvailable_&&this.loadWord_(),0<(t=e-t)?r<<t|this.readBits(t):r},shaka.util.ExpGolomb.prototype.skipLeadingZeros_=function(){var e;for(e=0;e<this.workingBitsAvailable_;++e)if(0!=(this.workingWord_&2147483648>>>e))return this.workingWord_<<=e,this.workingBitsAvailable_-=e,e;return this.loadWord_(),e+this.skipLeadingZeros_()},shaka.util.ExpGolomb.prototype.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros_())},shaka.util.ExpGolomb.prototype.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros_();return this.readBits(e+1)-1},shaka.util.ExpGolomb.prototype.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},shaka.util.ExpGolomb.prototype.readBoolean=function(){return 1===this.readBits(1)},shaka.util.ExpGolomb.prototype.readUnsignedByte=function(){return this.readBits(8)},shaka.util.ExpGolomb.prototype.skipScalingList=function(e){for(var t=8,r=8,n=0;n<e;n++)0!==r&&(r=(t+(r=this.readExpGolomb())+256)%256),t=0===r?t:r},shaka.util.ExpGolomb.prototype.readSliceType=function(){return this.readUnsignedByte(),this.readUnsignedExpGolomb(),this.readUnsignedExpGolomb()},goog.exportSymbol("shaka.util.ExpGolomb",shaka.util.ExpGolomb),shaka.util.TsParser=function(){this.pmtId_=null,this.pmtParsed_=!1,this.videoCodec_=this.videoPid_=null,this.videoData_=[],this.videoPes_=[],this.audioCodec_=this.audioPid_=null,this.audioData_=[],this.audioPes_=[],this.id3Pid_=null,this.id3Data_=[],this.opusMetadata_=this.referenceDts_=this.referencePts_=null},shaka.util.TsParser.prototype.clearData=function(){this.videoData_=[],this.videoPes_=[],this.audioData_=[],this.audioPes_=[],this.id3Data_=[]},shaka.util.TsParser.prototype.parse=function(e){var t=shaka.util.TsParser.PacketLength_;if(e.length<3*t)return this;for(var r=Math.max(0,shaka.util.TsParser.syncOffset(e)),n=e.length-(e.length+r)%t,a=!1,i=r;i<n;i+=t)if(71==e[i]){var s=!!(64&e[i+1]),o=((31&e[i+1])<<8)+e[i+2];if(1<(48&e[i+3])>>4){var l=i+5+e[i+4];if(l==i+t)continue}else l=i+4;switch(o){case 0:s&&(l+=e[l]+1),this.pmtId_=this.getPmtId_(e,l);break;case 17:case 8191:break;case this.pmtId_:s&&(l+=e[l]+1),-1!=(s=this.parsePMT_(e,l)).video&&(this.videoPid_=s.video,this.videoCodec_=s.videoCodec),-1!=s.audio&&(this.audioPid_=s.audio,this.audioCodec_=s.audioCodec),-1!=s.id3&&(this.id3Pid_=s.id3),a&&!this.pmtParsed_&&(shaka.log.debug("reparse from beginning"),a=!1,i=r-t),this.pmtParsed_=!0;break;case this.videoPid_:o=e.subarray(l,i+t),s?this.videoData_.push([o]):this.videoData_.length&&this.videoData_[this.videoData_.length-1]&&this.videoData_[this.videoData_.length-1].push(o);break;case this.audioPid_:o=e.subarray(l,i+t),s?this.audioData_.push([o]):this.audioData_.length&&this.audioData_[this.audioData_.length-1]&&this.audioData_[this.audioData_.length-1].push(o);break;case this.id3Pid_:o=e.subarray(l,i+t),s?this.id3Data_.push([o]):this.id3Data_.length&&this.id3Data_[this.id3Data_.length-1]&&this.id3Data_[this.id3Data_.length-1].push(o);break;default:a=!0}}else shaka.log.warning("Found TS packet that do not start with 0x47");return this},shaka.util.TsParser.prototype.getPmtId_=function(e,t){return(31&e[t+10])<<8|e[t+11]},shaka.util.TsParser.prototype.parsePMT_=function(e,t){var r=shaka.util.StringUtils,n={audio:-1,video:-1,id3:-1,audioCodec:"",videoCodec:""},a=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){var i=(31&e[t+1])<<8|e[t+2],s=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 6:if(0<s)for(var o=t+5,l=s;2<l;){var u=e[o+1]+2;switch(e[o]){case 5:var c=e.subarray(o+2,o+u);c=r.fromCharCode(c),-1==n.audio&&"Opus"===c?(n.audio=i,n.audioCodec="opus"):-1==n.video&&"AV01"===c&&(n.video=i,n.videoCodec="av1");break;case 106:-1==n.audio&&(n.audio=i,n.audioCodec="ac3");break;case 122:-1==n.audio&&(n.audio=i,n.audioCodec="ec3");break;case 124:-1==n.audio&&(n.audio=i,n.audioCodec="aac");break;case 127:"opus"==n.audioCodec&&(c=null,128===e[o+2]&&(c=e[o+3]),null!=c&&(this.opusMetadata_={channelCount:0==(15&c)?2:15&c,channelConfigCode:c,sampleRate:48e3}))}o+=u,l-=u}break;case 15:-1==n.audio&&(n.audio=i,n.audioCodec="aac");break;case 17:-1==n.audio&&(n.audio=i,n.audioCodec="aac-loas");break;case 21:-1==n.id3&&(n.id3=i);break;case 27:-1==n.video&&(n.video=i,n.videoCodec="avc");break;case 3:case 4:-1==n.audio&&(n.audio=i,n.audioCodec="mp3");break;case 36:-1==n.video&&(n.video=i,n.videoCodec="hvc");break;case 129:-1==n.audio&&(n.audio=i,n.audioCodec="ac3");break;case 132:case 135:-1==n.audio&&(n.audio=i,n.audioCodec="ec3")}t+=s+5}return n},shaka.util.TsParser.prototype.parsePES_=function(e){if(1!=(e[0]<<16|e[1]<<8|e[2]))return null;var t={data:new Uint8Array(0),packetLength:e[4]<<8|e[5],pts:null,dts:null,nalus:[]};if(t.packetLength&&t.packetLength>e.byteLength-6)return null;var r=e[7];if(192&r){var n=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2;null==this.referencePts_&&(this.referencePts_=n),t.pts=this.handleRollover_(n,this.referencePts_),this.referencePts_=t.pts,t.dts=t.pts,64&r&&(r=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2,null==this.referenceDts_&&(this.referenceDts_=r),t.dts=this.handleRollover_(r,this.referenceDts_)),this.referenceDts_=t.dts}return r=e[8]+9,e.byteLength<=r?null:(t.data=e.subarray(r),t)},shaka.util.TsParser.prototype.parseAvcNalus=function(e,t){return shaka.Deprecate.deprecateFeature(5,"TsParser.parseAvcNalus","Please use parseNalus function instead."),this.parseNalus(e,{nalu:null,state:null})},shaka.util.TsParser.prototype.parseNalus=function(e,t){var r=shaka.util.TsParser.Timescale,n=e.pts?e.pts/r:null,a=(e=e.data).byteLength,i=1;"hvc"==this.videoCodec_&&(i=2);var s=t.state||0,o=s,l=0;r=[];var u=-1,c=0;for(-1==s&&(u=0,c="hvc"==this.videoCodec_?e[0]>>1&63:31&e[0],s=0,l=1);l<a;){var d=e[l++];s?1===s?s=d?0:2:d?1==d?(d=l-s-1,0<=u?(s={data:e.subarray(u+i,d),fullData:e.subarray(u,d),type:c,time:n,state:null},r.push(s)):(s=r.length?r[r.length-1]:t.nalu)&&(o&&l<=4-o&&s.state&&(s.data=s.data.subarray(0,s.data.byteLength-o),s.fullData=s.fullData.subarray(0,s.fullData.byteLength-o)),0<d&&(d=e.subarray(0,d),s.data=shaka.util.Uint8ArrayUtils.concat(s.data,d),s.fullData=shaka.util.Uint8ArrayUtils.concat(s.fullData,d),s.state=0)),l<a?(c="hvc"==this.videoCodec_?e[l]>>1&63:31&e[l],u=l,s=0):s=-1):s=0:s=3:s=d?0:1}return 0<=u&&0<=s&&(n={data:e.subarray(u+i,a),fullData:e.subarray(u,a),type:c,time:n,state:s},r.push(n)),!r.length&&t.nalu&&(n=r.length?r[r.length-1]:t.nalu)&&(n.data=shaka.util.Uint8ArrayUtils.concat(n.data,e),n.fullData=shaka.util.Uint8ArrayUtils.concat(n.fullData,e)),t.state=s,r},shaka.util.TsParser.prototype.getMetadata=function(){for(var e=shaka.util.TsParser.Timescale,t=[],r=$jscomp.makeIterator(this.id3Data_),n=r.next();!n.done;n=r.next())n=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(n.value)),(n=this.parsePES_(n))&&t.push({cueTime:n.pts?n.pts/e:null,data:n.data,frames:shaka.util.Id3Utils.getID3Frames(n.data),dts:n.dts,pts:n.pts});return t},shaka.util.TsParser.prototype.getAudioData=function(){if(this.audioData_.length&&!this.audioPes_.length){for(var e=!1,t=$jscomp.makeIterator(this.audioData_),r=t.next();!r.done;r=t.next()){var n=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(r.value)),a=this.parsePES_(n);r=this.audioPes_.length?this.audioPes_[this.audioPes_.length-1]:null,a&&null!=a.pts&&null!=a.dts&&(!r||r.pts!=a.pts&&r.dts!=a.dts)?(this.audioPes_.length&&a.dts<(r.dts||0)&&(e=!0),this.audioPes_.push(a)):this.audioPes_.length&&(n=a?a.data:n)&&((r=this.audioPes_.pop()).data=shaka.util.Uint8ArrayUtils.concat(r.data,n),this.audioPes_.push(r))}e&&(this.audioPes_=this.audioPes_.sort((function(e,t){var r=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||r})))}return this.audioPes_},shaka.util.TsParser.prototype.getVideoData=function(e){if(e=void 0===e||e,this.videoData_.length&&!this.videoPes_.length){for(var t=!1,r=$jscomp.makeIterator(this.videoData_),n=r.next();!n.done;n=r.next()){var a=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(n.value)),i=this.parsePES_(a);n=this.videoPes_.length?this.videoPes_[this.videoPes_.length-1]:null,i&&null!=i.pts&&null!=i.dts&&(!n||n.pts!=i.pts&&n.dts!=i.dts)?(this.videoPes_.length&&i.dts<(n.dts||0)&&(t=!0),this.videoPes_.push(i)):this.videoPes_.length&&(a=i?i.data:a)&&((n=this.videoPes_.pop()).data=shaka.util.Uint8ArrayUtils.concat(n.data,a),this.videoPes_.push(n))}if(e){for(r={nalu:null,state:null},n=[],i=(a=$jscomp.makeIterator(this.videoPes_)).next();!i.done;i=a.next())(i=i.value).nalus=this.parseNalus(i,r),i.nalus.length&&(n.push(i),r.nalu=i.nalus[i.nalus.length-1]);this.videoPes_=n}t&&(this.videoPes_=this.videoPes_.sort((function(e,t){var r=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||r})))}return e?this.videoPes_:(e=this.videoPes_,this.videoPes_=[],e)},shaka.util.TsParser.prototype.getStartTime=function(e){var t=shaka.util.TsParser.Timescale;if("audio"==e){e=null;var r=this.getAudioData();return r.length&&(e=r[0],e=Math.min(e.dts,e.pts)/t),e}return"video"==e?(e=null,(r=this.getVideoData(!1)).length&&(e=r[0],e=Math.min(e.dts,e.pts)/t),e):null},shaka.util.TsParser.prototype.getCodecs=function(){return{audio:this.audioCodec_,video:this.videoCodec_}},shaka.util.TsParser.prototype.getVideoNalus=function(){for(var e=[],t=$jscomp.makeIterator(this.getVideoData()),r=t.next();!r.done;r=t.next())e.push.apply(e,$jscomp.arrayFromIterable(r.value.nalus));return e},shaka.util.TsParser.prototype.getVideoResolution=function(){shaka.Deprecate.deprecateFeature(5,"TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.getVideoInfo();return{height:e.height,width:e.width}},shaka.util.TsParser.prototype.getVideoInfo=function(){return"hvc"==this.videoCodec_?this.getHvcInfo_():this.getAvcInfo_()},shaka.util.TsParser.prototype.getFrameRate_=function(){var e=shaka.util.TsParser.Timescale,t=this.getVideoData();if(1<t.length){var r=t[0].pts;if(goog.asserts.assert("number"==typeof r,"Should be an number!"),t=t[1].pts,goog.asserts.assert("number"==typeof t,"Should be an number!"),!isNaN(t-r))return String(1/(t-r)*e)}return null},shaka.util.TsParser.prototype.getAvcInfo_=function(){var e=shaka.util.TsParser,t={height:null,width:null,codec:null,frameRate:null},r=this.getVideoNalus();if(!r.length)return t;if(!(r=r.find((function(t){return t.type==e.H264_NALU_TYPE_SPS_}))))return t;var n=(r=new shaka.util.ExpGolomb(r.data)).readUnsignedByte(),a=r.readUnsignedByte(),i=r.readUnsignedByte();if(r.skipExpGolomb(),e.PROFILES_WITH_OPTIONAL_SPS_DATA_.includes(n)){var s=r.readUnsignedExpGolomb();if(3===s&&r.skipBits(1),r.skipExpGolomb(),r.skipExpGolomb(),r.skipBits(1),r.readBoolean()){s=3!==s?8:12;for(var o=0;o<s;o++)r.readBoolean()&&(6>o?r.skipScalingList(16):r.skipScalingList(64))}}if(r.skipExpGolomb(),0===(s=r.readUnsignedExpGolomb()))r.readUnsignedExpGolomb();else if(1===s)for(r.skipBits(1),r.skipExpGolomb(),r.skipExpGolomb(),s=r.readUnsignedExpGolomb(),o=0;o<s;o++)r.skipExpGolomb();r.skipExpGolomb(),r.skipBits(1),s=r.readUnsignedExpGolomb(),o=r.readUnsignedExpGolomb();var l=r.readBits(1);0===l&&r.skipBits(1),r.skipBits(1);var u=0,c=0,d=0,p=0;return r.readBoolean()&&(u=r.readUnsignedExpGolomb(),c=r.readUnsignedExpGolomb(),d=r.readUnsignedExpGolomb(),p=r.readUnsignedExpGolomb()),t.height=String((2-l)*(o+1)*16-2*d-2*p),t.width=String(16*(s+1)-2*u-2*c),t.codec="avc1."+this.byteToHex_(n)+this.byteToHex_(a)+this.byteToHex_(i),t.frameRate=this.getFrameRate_(),t},shaka.util.TsParser.prototype.getHvcInfo_=function(){var e=shaka.util.TsParser,t={height:null,width:null,codec:null,frameRate:null},r=this.getVideoNalus();if(!r.length)return t;if(!(r=r.find((function(t){return t.type==e.H265_NALU_TYPE_SPS_}))))return t;var n=new shaka.util.ExpGolomb(r.fullData,!0);n.readUnsignedByte(),n.readUnsignedByte(),n.readBits(4);var a=n.readBits(3);n.readBoolean();var i=n.readBits(2),s=n.readBits(1),o=n.readBits(5),l=n.readBits(32);r=n.readUnsignedByte();for(var u=n.readUnsignedByte(),c=n.readUnsignedByte(),d=n.readUnsignedByte(),p=n.readUnsignedByte(),h=n.readUnsignedByte(),f=n.readUnsignedByte(),m=[],g=[],y=0;y<a;y++)m.push(n.readBoolean()),g.push(n.readBoolean());if(0<a)for(y=a;8>y;y++)n.readBits(2);for(y=0;y<a;y++)m[y]&&n.readBits(88),g[y]&&n.readUnsignedByte();n.readUnsignedExpGolomb(),3==(a=n.readUnsignedExpGolomb())&&n.readBits(1),m=n.readUnsignedExpGolomb(),g=n.readUnsignedExpGolomb();var v=y=0,_=0,k=0;return n.readBoolean()&&(y+=n.readUnsignedExpGolomb(),v+=n.readUnsignedExpGolomb(),_+=n.readUnsignedExpGolomb(),k+=n.readUnsignedExpGolomb()),t.width=String(m-(y+v)*(1===a||2===a?2:1)),t.height=String(g-(_+k)*(1===a?2:1)),s=1==s?"H":"L",o="hvc1."+(n=["","A","B","C"][i])+o+"."+(l=function(e){for(var t=0,r=0;32>r;r++)t|=(e>>r&1)<<31-r;return t>>>0}(l)).toString(16).toUpperCase(),o+="."+s+f,h&&(o+="."+h.toString(16).toUpperCase()),p&&(o+="."+p.toString(16).toUpperCase()),d&&(o+="."+d.toString(16).toUpperCase()),c&&(o+="."+c.toString(16).toUpperCase()),u&&(o+="."+u.toString(16).toUpperCase()),r&&(o+="."+r.toString(16).toUpperCase()),t.codec=o,t.frameRate=this.getFrameRate_(),t},shaka.util.TsParser.prototype.getOpusMetadata=function(){return this.opusMetadata_},shaka.util.TsParser.prototype.byteToHex_=function(e){return("0"+e.toString(16).toUpperCase()).slice(-2)},shaka.util.TsParser.prototype.handleRollover_=function(e,t){var r=1;for(e>t&&(r=-1);4294967296<Math.abs(t-e);)e+=8589934592*r;return e},shaka.util.TsParser.probe=function(e){return!(0>(e=shaka.util.TsParser.syncOffset(e)))&&(0<e&&shaka.log.warning("MPEG2-TS detected but first sync word found @ offset "+e+", junk ahead ?"),!0)},shaka.util.TsParser.syncOffset=function(e){for(var t=shaka.util.TsParser.PacketLength_,r=Math.min(1e3,e.length-3*t),n=0;n<r;){if(71==e[n]&&71==e[n+t]&&71==e[n+2*t])return n;n++}return-1},goog.exportSymbol("shaka.util.TsParser",shaka.util.TsParser),goog.exportProperty(shaka.util.TsParser,"syncOffset",shaka.util.TsParser.syncOffset),goog.exportProperty(shaka.util.TsParser,"probe",shaka.util.TsParser.probe),goog.exportProperty(shaka.util.TsParser.prototype,"getVideoInfo",shaka.util.TsParser.prototype.getVideoInfo),goog.exportProperty(shaka.util.TsParser.prototype,"getVideoResolution",shaka.util.TsParser.prototype.getVideoResolution),goog.exportProperty(shaka.util.TsParser.prototype,"getVideoNalus",shaka.util.TsParser.prototype.getVideoNalus),goog.exportProperty(shaka.util.TsParser.prototype,"getCodecs",shaka.util.TsParser.prototype.getCodecs),goog.exportProperty(shaka.util.TsParser.prototype,"getStartTime",shaka.util.TsParser.prototype.getStartTime),goog.exportProperty(shaka.util.TsParser.prototype,"getVideoData",shaka.util.TsParser.prototype.getVideoData),goog.exportProperty(shaka.util.TsParser.prototype,"getAudioData",shaka.util.TsParser.prototype.getAudioData),goog.exportProperty(shaka.util.TsParser.prototype,"getMetadata",shaka.util.TsParser.prototype.getMetadata),goog.exportProperty(shaka.util.TsParser.prototype,"parseNalus",shaka.util.TsParser.prototype.parseNalus),goog.exportProperty(shaka.util.TsParser.prototype,"parseAvcNalus",shaka.util.TsParser.prototype.parseAvcNalus),goog.exportProperty(shaka.util.TsParser.prototype,"parse",shaka.util.TsParser.prototype.parse),goog.exportProperty(shaka.util.TsParser.prototype,"clearData",shaka.util.TsParser.prototype.clearData),shaka.util.TsParser.Timescale=9e4,goog.exportProperty(shaka.util.TsParser,"Timescale",shaka.util.TsParser.Timescale),shaka.util.TsParser.PacketLength_=188,shaka.util.TsParser.H264_NALU_TYPE_SPS_=7,shaka.util.TsParser.H265_NALU_TYPE_SPS_=33,shaka.util.TsParser.PROFILES_WITH_OPTIONAL_SPS_DATA_=[100,110,122,244,44,83,86,118,128,138,139,134],shaka.media.MediaSourceEngine=function(e,t,r,n){var a=this;this.video_=e,this.playerInterface_=r,this.config_=null,this.textDisplayer_=t,this.sourceBuffers_=new Map,this.sourceBufferTypes_=new Map,this.expectedEncryption_=new Map,this.textEngine_=null,this.segmentRelativeVttTiming_=!1,this.lcevcDec_=n||null,this.queues_=new Map,this.eventManager_=new shaka.util.EventManager,this.transmuxers_=new Map,this.captionParser_=null,this.mediaSourceOpen_=new shaka.util.PublicPromise,this.url_="",this.playbackHasBegun_=!1,this.streamingAllowed_=!0,this.usingRemotePlayback_=!1,this.secondarySource_=this.source_=null,this.mediaSource_=this.createMediaSource(this.mediaSourceOpen_),this.playAfterReset_=this.reloadingMediaSource_=!1,this.destroyer_=new shaka.util.Destroyer((function(){return a.doDestroy_()})),this.sequenceMode_=!1,this.manifestType_=shaka.media.ManifestParser.UNKNOWN,this.attemptTimestampOffsetCalculation_=this.ignoreManifestTimestampsInSegmentsMode_=!1,this.textSequenceModeOffset_=new shaka.util.PublicPromise,this.needSplitMuxedContent_=!1,this.lastDuration_=null,this.tsParsers_=new Map,this.firstAudioReferenceStartTime_=this.firstAudioTimestamp_=this.firstVideoReferenceStartTime_=this.firstVideoTimestamp_=null,this.audioCompensation_=new shaka.util.PublicPromise,this.video_.remote&&(this.usingRemotePlayback_="disconnected"!=this.video_.remote.state,this.eventManager_.listen(this.video_.remote,"connect",(function(){a.usingRemotePlayback_="disconnected"!=a.video_.remote.state})),this.eventManager_.listen(this.video_.remote,"connecting",(function(){a.usingRemotePlayback_="disconnected"!=a.video_.remote.state})),this.eventManager_.listen(this.video_.remote,"disconnect",(function(){a.usingRemotePlayback_="disconnected"!=a.video_.remote.state})))},shaka.media.MediaSourceEngine.prototype.createMediaSource=function(e){var t=this;if(this.streamingAllowed_=!0,window.ManagedMediaSource){this.secondarySource_||(this.video_.disableRemotePlayback=!0);var r=new ManagedMediaSource;this.eventManager_.listen(r,"startstreaming",(function(){shaka.log.info("MMS startstreaming"),t.streamingAllowed_=!0})),this.eventManager_.listen(r,"endstreaming",(function(){shaka.log.info("MMS endstreaming"),t.streamingAllowed_=!1}))}else r=new MediaSource;return this.eventManager_.listenOnce(r,"sourceopen",(function(){return t.onSourceOpen_(e)})),this.eventManager_.listenOnce(this.video_,"playing",(function(){t.playbackHasBegun_=!0})),this.url_=shaka.media.MediaSourceEngine.createObjectURL(r),this.video_.removeAttribute("src"),this.source_&&this.video_.removeChild(this.source_),this.secondarySource_&&this.video_.removeChild(this.secondarySource_),this.source_=shaka.util.Dom.createSourceElement(this.url_),this.video_.appendChild(this.source_),this.secondarySource_&&this.video_.appendChild(this.secondarySource_),this.video_.load(),r},shaka.media.MediaSourceEngine.prototype.addSecondarySource=function(e,t){this.video_&&window.ManagedMediaSource&&this.mediaSource_?(this.secondarySource_&&this.video_.removeChild(this.secondarySource_),this.secondarySource_=shaka.util.Dom.createSourceElement(e,t),this.video_.appendChild(this.secondarySource_),this.video_.disableRemotePlayback=!1):shaka.log.warning("Secondary source is used only with ManagedMediaSource")},shaka.media.MediaSourceEngine.prototype.onSourceOpen_=function(e){goog.asserts.assert(this.url_,"Must have object URL"),URL.revokeObjectURL(this.url_),e.resolve()},shaka.media.MediaSourceEngine.isStreamSupported=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h,f,m;return $jscomp.asyncExecutePromiseGeneratorProgram((function(g){if(1==g.nextAddress)return e.createSegmentIndex?g.yield(e.createSegmentIndex(),2):g.jumpTo(2);if(!e.segmentIndex)return g.return(!1);if(e.segmentIndex.isEmpty())return g.return(!0);for(r=shaka.util.MimeUtils,n=shaka.transmuxer.TransmuxerEngine,a=shaka.util.ManifestParserUtils.ContentType,i=shaka.util.StreamUtils,s=new Set,o=$jscomp.makeIterator(e.segmentIndex),l=o.next();!l.done;l=o.next())if(!(u=l.value,c=u.mimeType||e.mimeType||"",d=u.codecs||e.codecs||"",c==e.mimeType&&d==e.codecs||(p=c+":"+d,s.has(p))))if(s.add(p),t==a.TEXT){if(h=r.getFullType(c,d),!shaka.text.TextEngine.isTypeSupported(h))return g.return(!1)}else if(t==a.VIDEO?d=i.getCorrectVideoCodecs(d):t==a.AUDIO&&(d=i.getCorrectAudioCodecs(d,c)),f=r.getExtendedType(e,c,d),m=r.getFullTypeWithAllCodecs(c,d),!shaka.media.Capabilities.isTypeSupported(f)&&!n.isSupported(m,e.type))return g.return(!1);return g.return(!0)}))},shaka.media.MediaSourceEngine.probeSupport=function(){for(var e='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.05.01",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.01",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat($jscomp.arrayFromIterable(shaka.util.MimeUtils.RAW_FORMATS)),t={},r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){r=r.value,shaka.text.TextEngine.isTypeSupported(r)?t[r]=!0:shaka.util.Platform.supportsMediaSource()?t[r]=shaka.media.Capabilities.isTypeSupported(r)||shaka.transmuxer.TransmuxerEngine.isSupported(r):t[r]=shaka.util.Platform.supportsMediaType(r);var n=r.split(";")[0];t[n]=t[n]||t[r]}return t},shaka.media.MediaSourceEngine.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.media.MediaSourceEngine.prototype.doDestroy_=function(){var e,t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(E){if(1==E.nextAddress){for(e=shaka.util.Functional,t=[],r=$jscomp.makeIterator(k.queues_),n=r.next();!n.done;n=r.next())for(a=n.value,i=$jscomp.makeIterator(a),s=i.next().value,o=i.next().value,l=o[0],u=s,k.queues_.set(u,o.slice(0,1)),l&&t.push(l.p.catch(e.noop)),c=$jscomp.makeIterator(o.slice(1)),d=c.next();!d.done;d=c.next())d.value.p.reject(shaka.util.Destroyer.destroyedError());return k.textEngine_&&t.push(k.textEngine_.destroy()),E.yield(Promise.all(t),2)}for(p=$jscomp.makeIterator(k.transmuxers_.values()),h=p.next();!h.done;h=p.next())h.value.destroy();if(k.eventManager_&&(k.eventManager_.release(),k.eventManager_=null),k.video_&&k.secondarySource_&&k.video_.removeChild(k.secondarySource_),k.video_&&k.source_&&(k.video_.removeChild(k.source_),k.video_.load(),k.video_.disableRemotePlayback=!1),k.video_=null,k.source_=null,k.secondarySource_=null,k.config_=null,k.mediaSource_=null,k.textEngine_=null,k.textDisplayer_=null,k.sourceBuffers_.clear(),k.expectedEncryption_.clear(),k.transmuxers_.clear(),k.captionParser_=null,goog.DEBUG)for(f=$jscomp.makeIterator(k.queues_),m=f.next();!m.done;m=f.next())g=m.value,y=$jscomp.makeIterator(g),v=y.next().value,_=y.next().value,goog.asserts.assert(0==_.length,v+" queue should be empty after destroy!");k.queues_.clear(),k.lcevcDec_=null,k.tsParsers_.clear(),k.playerInterface_=null,E.jumpToEnd()}))},shaka.media.MediaSourceEngine.prototype.open=function(){return this.mediaSourceOpen_},shaka.media.MediaSourceEngine.prototype.init=function(e,t,r,n){t=void 0!==t&&t,r=void 0===r?shaka.media.ManifestParser.UNKNOWN:r,n=void 0!==n&&n;var a,i,s,o,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:return a=shaka.util.ManifestParserUtils.ContentType,d.yield(c.mediaSourceOpen_,2);case 2:if(!c.ended()&&!c.closed()){d.jumpTo(3);break}return shaka.log.alwaysError("Expected MediaSource to be open during init(); reopening the media source."),c.mediaSourceOpen_=new shaka.util.PublicPromise,c.mediaSource_=c.createMediaSource(c.mediaSourceOpen_),d.yield(c.mediaSourceOpen_,3);case 3:c.sequenceMode_=t,c.manifestType_=r,c.ignoreManifestTimestampsInSegmentsMode_=n,c.attemptTimestampOffsetCalculation_=!c.sequenceMode_&&c.manifestType_==shaka.media.ManifestParser.HLS&&!c.ignoreManifestTimestampsInSegmentsMode_,c.tsParsers_.clear(),c.firstVideoTimestamp_=null,c.firstVideoReferenceStartTime_=null,c.firstAudioTimestamp_=null,c.firstAudioReferenceStartTime_=null,c.audioCompensation_=new shaka.util.PublicPromise,i=$jscomp.makeIterator(e.keys()),s=i.next();case 5:if(s.done){d.jumpTo(7);break}return o=s.value,l=e.get(o),d.yield(c.initSourceBuffer_(o,l,l.codecs),8);case 8:c.needSplitMuxedContent_?(c.queues_.set(a.AUDIO,[]),c.queues_.set(a.VIDEO,[])):c.queues_.set(o,[]),s=i.next(),d.jumpTo(5);break;case 7:(u=e.get(a.AUDIO))&&u.isAudioMuxedInVideo&&(c.needSplitMuxedContent_=!0),d.jumpToEnd()}}))},shaka.media.MediaSourceEngine.prototype.initSourceBuffer_=function(e,t,r){var n,a,i,s,o,l,u,c,d,p,h,f,m=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(g){switch(g.nextAddress){case 1:return n=shaka.util.ManifestParserUtils.ContentType,a=goog.asserts,i=a.assert,g.yield(shaka.media.MediaSourceEngine.isStreamSupported(t,e),2);case 2:if(i.call(a,g.yieldResult,"Type negotiation should happen before MediaSourceEngine.init!"),e==n.AUDIO&&r&&(r=shaka.util.StreamUtils.getCorrectAudioCodecs(r,t.mimeType)),s=shaka.util.MimeUtils.getFullType(t.mimeType,r),e==n.TEXT){m.reinitText(s,m.sequenceMode_,t.external),g.jumpTo(0);break}if(o=m.config_.forceTransmux,(!shaka.media.Capabilities.isTypeSupported(s)||!m.sequenceMode_&&shaka.util.MimeUtils.RAW_FORMATS.includes(s))&&(o=!0),l=shaka.util.MimeUtils.getFullTypeWithAllCodecs(t.mimeType,r),!o){g.jumpTo(4);break}if(u=shaka.util.ManifestParserUtils.guessCodecsSafe(n.AUDIO,(r||"").split(",")),c=shaka.util.ManifestParserUtils.guessCodecsSafe(n.VIDEO,(r||"").split(",")),!u||!c){g.jumpTo(5);break}return m.needSplitMuxedContent_=!0,g.yield(m.initSourceBuffer_(n.AUDIO,t,u),6);case 6:return g.yield(m.initSourceBuffer_(n.VIDEO,t,c),7);case 7:return g.return();case 5:(d=shaka.transmuxer.TransmuxerEngine.findTransmuxer(l))&&(p=d(),m.transmuxers_.set(e,p),s=p.convertCodecs(e,l));case 4:h=m.addExtraFeaturesToMimeType_(s),m.destroyer_.ensureNotDestroyed();try{f=m.mediaSource_.addSourceBuffer(h)}catch(e){throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,e,"The mediaSource_ status was "+m.mediaSource_.readyState+" expected 'open'",null)}m.sequenceMode_&&(f.mode=shaka.media.MediaSourceEngine.SourceBufferMode_.SEQUENCE),m.eventManager_.listen(f,"error",(function(){return m.onError_(e)})),m.eventManager_.listen(f,"updateend",(function(){return m.onUpdateEnd_(e)})),m.sourceBuffers_.set(e,f),m.sourceBufferTypes_.set(e,s),m.expectedEncryption_.set(e,!!t.drmInfos.length),g.jumpToEnd()}}))},shaka.media.MediaSourceEngine.prototype.configure=function(e){this.config_=e,this.textEngine_&&this.textEngine_.setModifyCueCallback(e.modifyCueCallback)},shaka.media.MediaSourceEngine.prototype.isStreamingAllowed=function(){return this.streamingAllowed_&&!this.usingRemotePlayback_&&!this.reloadingMediaSource_},shaka.media.MediaSourceEngine.prototype.reinitText=function(e,t,r){this.textEngine_||(this.textEngine_=new shaka.text.TextEngine(this.textDisplayer_),this.textEngine_.setModifyCueCallback(this.config_.modifyCueCallback)),this.textEngine_.initParser(e,t,r||this.segmentRelativeVttTiming_,this.manifestType_)},shaka.media.MediaSourceEngine.prototype.ended=function(){return!this.reloadingMediaSource_&&(!this.mediaSource_||"ended"==this.mediaSource_.readyState)},shaka.media.MediaSourceEngine.prototype.closed=function(){return!this.reloadingMediaSource_&&(!this.mediaSource_||"closed"==this.mediaSource_.readyState)},shaka.media.MediaSourceEngine.prototype.bufferStart=function(e){return this.sourceBuffers_.size?e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.bufferStart():shaka.media.TimeRangesUtils.bufferStart(this.getBuffered_(e)):null},shaka.media.MediaSourceEngine.prototype.bufferEnd=function(e){return this.sourceBuffers_.size?e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.bufferEnd():shaka.media.TimeRangesUtils.bufferEnd(this.getBuffered_(e)):null},shaka.media.MediaSourceEngine.prototype.isBuffered=function(e,t){return e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.isBuffered(t):(e=this.getBuffered_(e),shaka.media.TimeRangesUtils.isBuffered(e,t))},shaka.media.MediaSourceEngine.prototype.bufferedAheadOf=function(e,t){return e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.bufferedAheadOf(t):(e=this.getBuffered_(e),shaka.media.TimeRangesUtils.bufferedAheadOf(e,t))},shaka.media.MediaSourceEngine.prototype.getBufferedInfo=function(){var e=shaka.util.ManifestParserUtils.ContentType,t=shaka.media.TimeRangesUtils;if(e={total:this.reloadingMediaSource_?[]:t.getBufferedInfo(this.video_.buffered),audio:t.getBufferedInfo(this.getBuffered_(e.AUDIO)),video:t.getBufferedInfo(this.getBuffered_(e.VIDEO)),text:[]},this.textEngine_){t=this.textEngine_.bufferStart();var r=this.textEngine_.bufferEnd();null!=t&&null!=r&&e.text.push({start:t,end:r})}return e},shaka.media.MediaSourceEngine.prototype.getBuffered_=function(e){if(this.reloadingMediaSource_||this.usingRemotePlayback_)return null;try{return this.sourceBuffers_.get(e).buffered}catch(t){return this.sourceBuffers_.has(e)&&shaka.log.error("failed to get buffered range for "+e,t),null}},shaka.media.MediaSourceEngine.prototype.getCaptionParser=function(e){return new shaka.media.ClosedCaptionParser(e)},shaka.media.MediaSourceEngine.prototype.getTimestampAndDispatchMetadata=function(e,t,r,n,a){var i=this,s=null,o=[],l=shaka.util.BufferUtils.toUint8(t);if(shaka.util.MimeUtils.RAW_FORMATS.includes(a))(t=shaka.util.Id3Utils.getID3Frames(l)).length&&r&&((e=t.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(s=Math.round(e.data)/1e3),this.playerInterface_.onMetadata([{cueTime:r.startTime,data:l,frames:t,dts:r.startTime,pts:r.startTime}],0,r.endTime));else if(a.includes("/mp4")&&r&&r.initSegmentReference&&r.initSegmentReference.timescale){var u=r.initSegmentReference.timescale;if(!isNaN(u)){var c=null!=n.emsgSchemeIdUris&&0<n.emsgSchemeIdUris.length||this.config_.dispatchAllEmsgBoxes;l=shaka.util.Mp4Parser;var d=0,p=!1;e=new l,c&&e.fullBox("emsg",(function(e){return i.parseEMSG_(r,n.emsgSchemeIdUris,e)})),e.fullBox("prft",(function(e){return i.parsePrft_(u,e)})).box("moof",l.children).box("traf",l.children).fullBox("tfdt",(function(e){p||(goog.asserts.assert(0==e.version||1==e.version,"TFDT version can only be 0 or 1"),d=shaka.util.Mp4BoxParsers.parseTFDTInaccurate(e.reader,e.version).baseMediaDecodeTime/u,p=!0,c||e.parser.stop())})).parse(t,!0),p&&0==r.timestampOffset&&(s=d)}}else a.includes("/mp4")||a.includes("/webm")||!shaka.util.TsParser.probe(l)||(this.tsParsers_.has(e)?this.tsParsers_.get(e).clearData():this.tsParsers_.set(e,new shaka.util.TsParser),null!=(t=(o=this.tsParsers_.get(e).parse(l)).getStartTime(e))&&(s=t),o=o.getMetadata());return{timestamp:s,metadata:o}},shaka.media.MediaSourceEngine.prototype.parseEMSG_=function(e,t,r){if(0===r.version)var n=r.reader.readTerminatedString(),a=r.reader.readTerminatedString(),i=r.reader.readUint32(),s=r.reader.readUint32(),o=r.reader.readUint32(),l=r.reader.readUint32(),u=e.startTime+s/i;else i=r.reader.readUint32(),s=(u=r.reader.readUint64()/i+e.timestampOffset)-e.startTime,o=r.reader.readUint32(),l=r.reader.readUint32(),n=r.reader.readTerminatedString(),a=r.reader.readTerminatedString();e=r.reader.readBytes(r.reader.getLength()-r.reader.getPosition()),(t&&t.includes(n)||this.config_.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==n?this.playerInterface_.onManifestUpdate():(i={startTime:u,endTime:t=u+o/i,schemeIdUri:n,value:a,timescale:i,presentationTimeDelta:s,eventDuration:o,id:l,messageData:e},l=shaka.util.FakeEvent.EventName.Emsg,o=(new Map).set("detail",i),new shaka.util.FakeEvent(l,o).cancelable=!0,this.playerInterface_.onEmsg(i),("https://aomedia.org/emsg/ID3"==n||"https://developer.apple.com/streaming/emsg-id3"==n)&&((n=shaka.util.Id3Utils.getID3Frames(e)).length&&this.playerInterface_.onMetadata([{cueTime:u,data:e,frames:n,dts:u,pts:u}],0,t))))},shaka.media.MediaSourceEngine.prototype.parsePrft_=function(e,t){goog.asserts.assert(0==t.version||1==t.version,"PRFT version can only be 0 or 1"),t=shaka.util.Mp4BoxParsers.parsePRFTInaccurate(t.reader,t.version);var r=this.convertNtp_(t.ntpTimestamp);t={wallClockTime:r,programStartDate:new Date(r-t.mediaTime/e*1e3)},e=shaka.util.FakeEvent.EventName.Prft,t=(new Map).set("detail",t),e=new shaka.util.FakeEvent(e,t),this.playerInterface_.onEvent(e)},shaka.media.MediaSourceEngine.prototype.convertNtp_=function(e){var t=new Date(Date.UTC(1900,0,1,0,0,0));return new Date(t.getTime()+e).getTime()},shaka.media.MediaSourceEngine.prototype.appendBuffer=function(e,t,r,n,a,i,s,o,l){i=void 0!==i&&i,s=void 0!==s&&s,o=void 0!==o&&o,l=void 0!==l&&l;var u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(M){switch(M.nextAddress){case 1:if(u=shaka.util.ManifestParserUtils.ContentType,e!=u.TEXT){M.jumpTo(2);break}if(R.manifestType_!=shaka.media.ManifestParser.HLS){M.jumpTo(3);break}return M.yield(R.textSequenceModeOffset_,4);case 4:c=M.yieldResult,R.textEngine_.setTimestampOffset(c);case 3:return M.yield(R.textEngine_.appendBuffer(t,r?r.startTime:null,r?r.endTime:null,r?r.getUris()[0]:null),5);case 5:return M.return();case 2:if(l||!R.needSplitMuxedContent_){M.jumpTo(6);break}return M.yield(R.appendBuffer(u.AUDIO,t,r,n,a,i,s,o,!0),7);case 7:return M.yield(R.appendBuffer(u.VIDEO,t,r,n,a,i,s,o,!0),8);case 8:return M.return();case 6:if(!R.sourceBuffers_.has(e))return shaka.log.warning("Attempted to restore a non-existent source buffer"),M.return();if(d=R.sourceBuffers_.get(e).timestampOffset,p=R.sourceBufferTypes_.get(e),R.transmuxers_.has(e)&&(p=R.transmuxers_.get(e).getOriginalMimeType()),r&&(h=R.getTimestampAndDispatchMetadata(e,t,r,n,p),f=h.timestamp,m=h.metadata,null!=f&&(null==R.firstVideoTimestamp_&&e==u.VIDEO&&(R.firstVideoTimestamp_=f,R.firstVideoReferenceStartTime_=r.startTime,null!=R.firstAudioTimestamp_&&(g=0,R.firstVideoReferenceStartTime_==R.firstAudioReferenceStartTime_&&(g=R.firstVideoTimestamp_-R.firstAudioTimestamp_),R.audioCompensation_.resolve(g))),null==R.firstAudioTimestamp_&&e==u.AUDIO&&(R.firstAudioTimestamp_=f,R.firstAudioReferenceStartTime_=r.startTime,null!=R.firstVideoTimestamp_&&(y=0,R.firstVideoReferenceStartTime_==R.firstAudioReferenceStartTime_&&(y=R.firstVideoTimestamp_-R.firstAudioTimestamp_),R.audioCompensation_.resolve(y))),v=f,_=shaka.util.MimeUtils.RAW_FORMATS,!R.sequenceMode_&&_.includes(R.sourceBufferTypes_.get(e))&&(v=0),k=r.startTime-v,(.001<=Math.abs(d-k)||i||s)&&(!o||0<k||!d)&&(d=k,R.attemptTimestampOffsetCalculation_&&(R.enqueueOperation_(e,(function(){return R.abort_(e)}),null),R.enqueueOperation_(e,(function(){return R.setTimestampOffset_(e,d)}),null))),(e==u.VIDEO||!R.sourceBuffers_.has(u.VIDEO))&&R.textSequenceModeOffset_.resolve(d)),m.length)&&R.playerInterface_.onMetadata(m,d,r?r.endTime:null),a&&e==u.VIDEO&&(R.textEngine_||R.reinitText(shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE,R.sequenceMode_,!1),R.captionParser_||(E=p.split(";",1)[0],R.captionParser_=R.getCaptionParser(E)),r?(b=R.captionParser_.parseFrom(t)).length&&R.textEngine_.storeAndAppendClosedCaptions(b,r.startTime,r.endTime,d):R.captionParser_.init(t,s)),!R.transmuxers_.has(e)){M.jumpTo(9);break}return M.yield(R.transmuxers_.get(e).transmux(t,n,r,R.mediaSource_.duration,e),10);case 10:t=M.yieldResult;case 9:if(t=R.workAroundBrokenPlatforms_(n,t,r,e),!r||!R.sequenceMode_||e==u.TEXT){M.jumpTo(11);break}if(!i&&!s){M.jumpTo(11);break}if(T=r.startTime,R.manifestType_!=shaka.media.ManifestParser.HLS||R.needSplitMuxedContent_||e!=u.AUDIO||!R.sourceBuffers_.has(u.VIDEO)){M.jumpTo(13);break}return M.yield(R.audioCompensation_,14);case 14:A=M.yieldResult,.15<Math.abs(A)&&(T-=A);case 13:R.enqueueOperation_(e,(function(){return R.abort_(e)}),null),R.enqueueOperation_(e,(function(){return R.setTimestampOffset_(e,T)}),null);case 11:return S=null,M.yield(R.enqueueOperation_(e,(function(){goog.DEBUG&&r&&!r.isPreload()&&!o&&(S=R.getBuffered_(e)),R.append_(e,t,d,n)}),r?r.getUris()[0]:null),15);case 15:goog.DEBUG&&r&&!r.isPreload()&&!o&&(P=R.getBuffered_(e),C=shaka.media.TimeRangesUtils.computeAddedRange(S,P))&&(x=r.endTime-r.startTime,I=C.end-C.start,w=Math.abs(C.end-r.endTime),.1<x&&(w>x/2||.03<Math.abs(x-I))&&shaka.log.error("Possible encoding problem detected!","Unexpected buffered range for reference",r,"from URIs",r.getUris(),"should be",{start:r.startTime,end:r.endTime},"but got",C)),M.jumpToEnd()}}))},shaka.media.MediaSourceEngine.prototype.setSelectedClosedCaptionId=function(e){var t=this.bufferEnd(shaka.util.ManifestParserUtils.ContentType.VIDEO)||0;this.textEngine_.setSelectedClosedCaptionId(e,t)},shaka.media.MediaSourceEngine.prototype.clearSelectedClosedCaptionId=function(){this.textEngine_&&this.textEngine_.setSelectedClosedCaptionId("",0)},shaka.media.MediaSourceEngine.prototype.remove=function(e,t,r){var n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(n=shaka.util.ManifestParserUtils.ContentType,e==n.TEXT?i.yield(a.textEngine_.remove(t,r),0):r>t?i.yield(a.enqueueOperation_(e,(function(){return a.remove_(e,t,r)}),null),5):i.jumpTo(0)):a.needSplitMuxedContent_?i.yield(a.enqueueOperation_(n.AUDIO,(function(){return a.remove_(n.AUDIO,t,r)}),null),0):i.jumpTo(0)}))},shaka.media.MediaSourceEngine.prototype.clear=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=shaka.util.ManifestParserUtils.ContentType,e==t.TEXT?r.textEngine_?n.yield(r.textEngine_.remove(0,1/0),0):n.return():n.yield(r.enqueueOperation_(e,(function(){return r.remove_(e,0,r.mediaSource_.duration)}),null),4)):r.needSplitMuxedContent_?n.yield(r.enqueueOperation_(t.AUDIO,(function(){return r.remove_(t.AUDIO,0,r.mediaSource_.duration)}),null),0):n.jumpTo(0)}))},shaka.media.MediaSourceEngine.prototype.resetCaptionParser=function(){this.captionParser_&&this.captionParser_.reset()},shaka.media.MediaSourceEngine.prototype.flush=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=shaka.util.ManifestParserUtils.ContentType,e==t.TEXT?n.return():n.yield(r.enqueueOperation_(e,(function(){return r.flush_(e)}),null),2)):r.needSplitMuxedContent_?n.yield(r.enqueueOperation_(t.AUDIO,(function(){return r.flush_(t.AUDIO)}),null),0):n.jumpTo(0)}))},shaka.media.MediaSourceEngine.prototype.setStreamProperties=function(e,t,r,n,a,i,s,o){var l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){return 1==d.nextAddress?(l=shaka.util.ManifestParserUtils.ContentType,e==l.TEXT?(a||c.textEngine_.setTimestampOffset(t),c.textEngine_.setAppendWindow(r,n),d.return()):(u=[],d.yield(c.codecSwitchIfNecessary_(e,i,s,o),2))):(d.yieldResult||(u.push(c.enqueueOperation_(e,(function(){return c.abort_(e)}),null)),c.needSplitMuxedContent_&&u.push(c.enqueueOperation_(l.AUDIO,(function(){return c.abort_(l.AUDIO)}),null))),a||(u.push(c.enqueueOperation_(e,(function(){return c.setTimestampOffset_(e,t)}),null)),c.needSplitMuxedContent_&&u.push(c.enqueueOperation_(l.AUDIO,(function(){return c.setTimestampOffset_(l.AUDIO,t)}),null))),0==r&&1/0==n||(u.push(c.enqueueOperation_(e,(function(){return c.setAppendWindow_(e,r,n)}),null)),c.needSplitMuxedContent_&&u.push(c.enqueueOperation_(l.AUDIO,(function(){return c.setAppendWindow_(l.AUDIO,r,n)}),null))),u.length?d.yield(Promise.all(u),0):d.jumpTo(0))}))},shaka.media.MediaSourceEngine.prototype.resync=function(e,t){var r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(r=shaka.util.ManifestParserUtils.ContentType,e==r.TEXT?i.return():(e==r.VIDEO&&(a.textSequenceModeOffset_=new shaka.util.PublicPromise),!a.sequenceMode_||(n=a.bufferEnd(e))&&.1>Math.abs(n-t)?i.return():(a.enqueueOperation_(e,(function(){return a.abort_(e)}),null),a.needSplitMuxedContent_&&a.enqueueOperation_(r.AUDIO,(function(){return a.abort_(r.AUDIO)}),null),i.yield(a.enqueueOperation_(e,(function(){return a.setTimestampOffset_(e,t)}),null),2)))):a.needSplitMuxedContent_?i.yield(a.enqueueOperation_(r.AUDIO,(function(){return a.setTimestampOffset_(r.AUDIO,t)}),null),0):i.jumpTo(0)}))},shaka.media.MediaSourceEngine.prototype.endOfStream=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return r.yield(t.enqueueBlockingOperation_((function(){t.ended()||t.closed()||(e?t.mediaSource_.endOfStream(e):t.mediaSource_.endOfStream())})),0)}))},shaka.media.MediaSourceEngine.prototype.setDuration=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return r.yield(t.enqueueBlockingOperation_((function(){if(e<t.mediaSource_.duration)for(var r=$jscomp.makeIterator(t.sourceBuffers_.keys()),n=r.next();!n.done;n=r.next()){n=n.value;var a={start:function(){},p:new shaka.util.PublicPromise,uri:null};t.queues_.get(n).unshift(a)}t.mediaSource_.duration=e,t.lastDuration_=e})),0)}))},shaka.media.MediaSourceEngine.prototype.getDuration=function(){return this.mediaSource_.duration},shaka.media.MediaSourceEngine.prototype.setLiveSeekableRange=function(e,t){var r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return goog.asserts.assert("setLiveSeekableRange"in r.mediaSource_,"Using setLiveSeekableRange on not supported platform"),r.ended()||r.closed()?n.return():n.yield(r.enqueueBlockingOperation_((function(){r.ended()||r.closed()||r.mediaSource_.setLiveSeekableRange(e,t)})),0)}))},shaka.media.MediaSourceEngine.prototype.clearLiveSeekableRange=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return goog.asserts.assert("clearLiveSeekableRange"in e.mediaSource_,"Using clearLiveSeekableRange on not supported platform"),e.ended()||e.closed()?t.return():t.yield(e.enqueueBlockingOperation_((function(){e.ended()||e.closed()||e.mediaSource_.clearLiveSeekableRange()})),0)}))},shaka.media.MediaSourceEngine.prototype.appendDependency=function(e,t,r){this.lcevcDec_&&this.lcevcDec_.appendBuffer(e,t,r)},shaka.media.MediaSourceEngine.prototype.append_=function(e,t,r,n){this.appendDependency(t,r,n),this.sourceBuffers_.get(e).appendBuffer(t)},shaka.media.MediaSourceEngine.prototype.remove_=function(e,t,r){r<=t?this.onUpdateEnd_(e):this.sourceBuffers_.get(e).remove(t,r)},shaka.media.MediaSourceEngine.prototype.abort_=function(e){var t=this.sourceBuffers_.get(e),r=t.appendWindowStart,n=t.appendWindowEnd;t.abort(),t.appendWindowStart=r,t.appendWindowEnd=n,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.flush_=function(e){goog.asserts.assert(0==this.video_.buffered.length,"MediaSourceEngine.flush_ should only be used after clearing all data!"),this.video_.currentTime-=.001,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.setTimestampOffset_=function(e,t){0>t&&(t+=.001);var r=!0;this.manifestType_==shaka.media.ManifestParser.HLS&&(r=!(r=this.bufferEnd(e))||.15<Math.abs(r-t)),r&&(this.sourceBuffers_.get(e).timestampOffset=t),this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.setAppendWindow_=function(e,t,r){var n=this.sourceBuffers_.get(e);n.appendWindowStart=0,n.appendWindowEnd=r,n.appendWindowStart=t,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.onError_=function(e){var t=this.queues_.get(e)[0];goog.asserts.assert(t,"Spurious error event!"),goog.asserts.assert(!this.sourceBuffers_.get(e).updating,"SourceBuffer should not be updating on error!"),t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_FAILED,this.video_.error?this.video_.error.code:0,t.uri))},shaka.media.MediaSourceEngine.prototype.onUpdateEnd_=function(e){if(!this.reloadingMediaSource_){var t=this.queues_.get(e)[0];goog.asserts.assert(t,"Spurious updateend event!"),t&&(goog.asserts.assert(!this.sourceBuffers_.get(e).updating,"SourceBuffer should not be updating on updateend!"),t.p.resolve(),this.popFromQueue_(e))}},shaka.media.MediaSourceEngine.prototype.enqueueOperation_=function(e,t,r){return this.destroyer_.ensureNotDestroyed(),t={start:t,p:new shaka.util.PublicPromise,uri:r},this.queues_.get(e).push(t),1==this.queues_.get(e).length&&this.startOperation_(e),t.p},shaka.media.MediaSourceEngine.prototype.enqueueBlockingOperation_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(b){switch(b.nextAddress){case 1:for(E.destroyer_.ensureNotDestroyed(),t=[],r=Array.from(E.sourceBuffers_.keys()),n=$jscomp.makeIterator(r),a=n.next(),i={};!a.done;i={ready:void 0},a=n.next())s=a.value,i.ready=new shaka.util.PublicPromise,o={start:function(e){return function(){return e.ready.resolve()}}(i),p:i.ready,uri:null},(l=E.queues_.get(s)).push(o),t.push(i.ready),1==l.length&&o.start();return b.setCatchFinallyBlocks(2),b.yield(Promise.all(t),4);case 4:b.leaveTryBlock(3);break;case 2:if(u=b.enterCatchBlock(),goog.asserts.assert(E.destroyer_.destroyed(),"Should be destroyed by now"),goog.DEBUG)for(c=$jscomp.makeIterator(r),d=c.next();!d.done;d=c.next())p=d.value,(h=E.queues_.get(p)).length&&(goog.asserts.assert(1==h.length,"Should be at most one item in queue!"),goog.asserts.assert(t.includes(h[0].p),"The item in queue should be one of our waiters!"),h.shift());throw u;case 3:if(goog.DEBUG)for(f=$jscomp.makeIterator(r),m=f.next();!m.done;m=f.next())g=m.value,goog.asserts.assert(0==E.sourceBuffers_.get(g).updating,"SourceBuffers should not be updating after a blocking op!");return b.setCatchFinallyBlocks(5,6),b.yield(e(),6);case 6:for(b.enterFinallyBlock(),y=$jscomp.makeIterator(r),v=y.next();!v.done;v=y.next())_=v.value,E.popFromQueue_(_);b.leaveFinallyBlock(0);break;case 5:throw k=b.enterCatchBlock(),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,k,E.video_.error||"No error in the media element",null)}}))},shaka.media.MediaSourceEngine.prototype.popFromQueue_=function(e){goog.asserts.assert(this.queues_.has(e),"Queue should exist"),this.queues_.get(e).shift(),this.startOperation_(e)},shaka.media.MediaSourceEngine.prototype.startOperation_=function(e){var t=this.queues_.get(e)[0];if(t)try{t.start()}catch(r){"QuotaExceededError"==r.name?t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.QUOTA_EXCEEDED_ERROR,e)):this.isStreamingAllowed()?t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,r,this.video_.error||"No error in the media element",t.uri)):t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.STREAMING_NOT_ALLOWED,e)),this.popFromQueue_(e)}},shaka.media.MediaSourceEngine.prototype.getTextDisplayer=function(){return goog.asserts.assert(this.textDisplayer_,"TextDisplayer should only be null when this is destroyed"),this.textDisplayer_},shaka.media.MediaSourceEngine.prototype.setTextDisplayer=function(e){this.textDisplayer_=e,this.textEngine_&&this.textEngine_.setDisplayer(e)},shaka.media.MediaSourceEngine.prototype.setSegmentRelativeVttTiming=function(e){this.segmentRelativeVttTiming_=e},shaka.media.MediaSourceEngine.prototype.workAroundBrokenPlatforms_=function(e,t,r,n){var a=shaka.util.Platform;if("mp4"!=shaka.util.MimeUtils.getContainerType(this.sourceBufferTypes_.get(n)))return t;var i=null===r,s=this.expectedEncryption_.get(n),o=this.playerInterface_.getKeySystem(),l=!1;return r&&r.initSegmentReference&&(l=r.initSegmentReference.encrypted),r=r?r.getUris()[0]:null,this.config_.insertFakeEncryptionInInit&&s&&a.requiresEncryptionInfoInAllInitSegments(o,n)&&(i?(shaka.log.debug("Forcing fake encryption information in init segment."),t=shaka.media.ContentWorkarounds.fakeEncryption(e,t,r)):!l&&a.requiresTfhdFix(n)&&(shaka.log.debug("Forcing fake encryption information in media segment."),t=shaka.media.ContentWorkarounds.fakeMediaEncryption(t))),i&&a.requiresEC3InitSegments()&&(shaka.log.debug("Forcing fake EC-3 information in init segment."),t=shaka.media.ContentWorkarounds.fakeEC3(t)),t},shaka.media.MediaSourceEngine.prototype.change_=function(e,t,r){if(e===shaka.util.ManifestParserUtils.ContentType.TEXT)shaka.log.debug("Change not supported for "+e);else{var n=this.sourceBufferTypes_.get(e);shaka.log.debug("Change Type: "+n+" -> "+t),shaka.media.Capabilities.isChangeTypeSupported()?(this.transmuxers_.has(e)&&(this.transmuxers_.get(e).destroy(),this.transmuxers_.delete(e)),r&&this.transmuxers_.set(e,r),r=this.addExtraFeaturesToMimeType_(t),this.sourceBuffers_.get(e).changeType(r),this.sourceBufferTypes_.set(e,t)):shaka.log.debug("Change Type not supported"),this.onUpdateEnd_(e)}},shaka.media.MediaSourceEngine.prototype.changeType=function(e,t,r){var n=this;return this.enqueueOperation_(e,(function(){return n.change_(e,t,r)}),null)},shaka.media.MediaSourceEngine.prototype.reset_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(E){switch(E.nextAddress){case 1:if(k.reloadingMediaSource_)return E.return();for(t=shaka.util.ManifestParserUtils.ContentType,k.reloadingMediaSource_=!0,k.needSplitMuxedContent_=!1,r=k.video_.currentTime,n=k.video_.autoplay,k.video_.paused||(k.playAfterReset_=!0),k.playbackHasBegun_&&(k.video_.autoplay=!1),E.setFinallyBlock(2),k.eventManager_.removeAll(),a=$jscomp.makeIterator(k.transmuxers_.values()),i=a.next();!i.done;i=a.next())i.value.destroy();for(s=$jscomp.makeIterator(k.sourceBuffers_.values()),o=s.next();!o.done;o=s.next()){l=o.value;try{k.mediaSource_.removeSourceBuffer(l)}catch(e){shaka.log.debug("Exception on removeSourceBuffer",e)}}return k.transmuxers_.clear(),k.sourceBuffers_.clear(),u=k.mediaSource_.duration,k.mediaSourceOpen_=new shaka.util.PublicPromise,k.mediaSource_=k.createMediaSource(k.mediaSourceOpen_),E.yield(k.mediaSourceOpen_,4);case 4:!isNaN(u)&&u?k.mediaSource_.duration=u:!isNaN(k.lastDuration_)&&k.lastDuration_&&(k.mediaSource_.duration=k.lastDuration_),c=new shaka.util.PublicPromise,d=k.mediaSource_.sourceBuffers,p=e.size,h=0,f=function(){++h===p&&(c.resolve(),k.eventManager_.unlisten(d,"addsourcebuffer",f))},k.eventManager_.listen(d,"addsourcebuffer",f),m=$jscomp.makeIterator(e.keys()),g=m.next();case 5:return g.done?((_=e.get(t.AUDIO))&&_.isAudioMuxedInVideo&&(k.needSplitMuxedContent_=!0),k.needSplitMuxedContent_&&!k.queues_.has(t.AUDIO)&&k.queues_.set(t.AUDIO,[]),k.video_.currentTime=r,E.yield(c,2)):(y=g.value,v=e.get(y),E.yield(k.initSourceBuffer_(y,v,v.codecs),6));case 6:g=m.next(),E.jumpTo(5);break;case 2:E.enterFinallyBlock(),k.reloadingMediaSource_=!1,k.destroyer_.ensureNotDestroyed(),k.eventManager_.listenOnce(k.video_,"canplaythrough",(function(){k.destroyer_.destroyed()||(k.video_.autoplay=n,k.playAfterReset_&&(k.playAfterReset_=!1,k.video_.play()))})),E.leaveFinallyBlock(0)}}))},shaka.media.MediaSourceEngine.prototype.reset=function(e){var t=this;return this.enqueueBlockingOperation_((function(){return t.reset_(e)}))},shaka.media.MediaSourceEngine.prototype.getRealInfo_=function(e,t,r){var n=shaka.util.ManifestParserUtils.ContentType,a=shaka.util.MimeUtils,i=!1,s=shaka.util.ManifestParserUtils.guessCodecsSafe(n.AUDIO,(r||"").split(",")),o=shaka.util.ManifestParserUtils.guessCodecsSafe(n.VIDEO,(r||"").split(",")),l=o;e==n.AUDIO&&(l=s),l||(l=r),r=shaka.util.MimeUtils.getFullType(t,l);var u=this.config_.forceTransmux;if((!shaka.media.Capabilities.isTypeSupported(r)||!this.sequenceMode_&&shaka.util.MimeUtils.RAW_FORMATS.includes(r))&&(u=!0),n=shaka.transmuxer.TransmuxerEngine,u&&(t=shaka.util.MimeUtils.getFullTypeWithAllCodecs(t,l),l=n.findTransmuxer(t))){var c=l();s&&o&&(i=!0),r=c.convertCodecs(e,t)}return e=a.getNormalizedCodec(a.getCodecs(r)),{transmuxer:c,transmuxerMuxed:i,basicType:a=a.getBasicType(r),codec:e,mimeType:r}},shaka.media.MediaSourceEngine.prototype.codecSwitchIfNecessary_=function(e,t,r,n){var a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(k){return 1==k.nextAddress?(a=shaka.util.ManifestParserUtils.ContentType,e==a.TEXT?k.return(!1):(i=shaka.util.MimeUtils,s=i.getNormalizedCodec(i.getCodecs(_.sourceBufferTypes_.get(e))),o=i.getBasicType(_.sourceBufferTypes_.get(e)),l=_.getRealInfo_(e,t,r),u=l.transmuxer,c=l.transmuxerMuxed,d=l.basicType,p=l.codec,h=l.mimeType,f=!0,c&&_.sourceBufferTypes_.has(a.AUDIO)&&(m=_.getRealInfo_(a.AUDIO,t,r),g=i.getNormalizedCodec(i.getCodecs(_.sourceBufferTypes_.get(a.AUDIO))),y=i.getBasicType(_.sourceBufferTypes_.get(a.AUDIO)),f=g==m.codec&&y==m.basicType,m.transmuxer&&m.transmuxer.destroy()),s===p&&o===d&&f?(_.transmuxers_.has(e)&&!u?(_.transmuxers_.get(e).destroy(),_.transmuxers_.delete(e)):!_.transmuxers_.has(e)&&u?_.transmuxers_.set(e,u):u&&(_.transmuxers_.has(e)&&_.transmuxers_.get(e).transmux!=u.transmux?(_.transmuxers_.get(e).destroy(),_.transmuxers_.delete(e),_.transmuxers_.set(e,u)):u.destroy()),k.return(!1)):(v=!0,(_.needSplitMuxedContent_||c&&u&&!_.transmuxers_.has(e))&&(v=!1),v&&_.config_.codecSwitchingStrategy===shaka.config.CodecSwitchingStrategy.SMOOTH&&shaka.media.Capabilities.isChangeTypeSupported()?k.yield(_.changeType(e,h,u),3):(u&&u.destroy(),k.yield(_.reset(n),3))))):k.return(!0)}))},shaka.media.MediaSourceEngine.prototype.isCodecSwitchNecessary_=function(e,t,r){if(e==shaka.util.ManifestParserUtils.ContentType.TEXT)return!1;var n=shaka.util.MimeUtils,a=n.getNormalizedCodec(n.getCodecs(this.sourceBufferTypes_.get(e))),i=n.getBasicType(this.sourceBufferTypes_.get(e)),s=shaka.util.MimeUtils.getFullType(t,r),o=this.config_.forceTransmux;return(!shaka.media.Capabilities.isTypeSupported(s)||!this.sequenceMode_&&shaka.util.MimeUtils.RAW_FORMATS.includes(s))&&(o=!0),t=shaka.util.MimeUtils.getFullTypeWithAllCodecs(t,r),r=shaka.transmuxer.TransmuxerEngine,o&&(o=r.findTransmuxer(t))&&(s=(o=o()).convertCodecs(e,t),o.destroy()),e=n.getNormalizedCodec(n.getCodecs(s)),n=n.getBasicType(s),a!==e||i!==n},shaka.media.MediaSourceEngine.prototype.isResetMediaSourceNecessary=function(e,t,r){return!!this.isCodecSwitchNecessary_(e,t,r)&&(this.config_.codecSwitchingStrategy!==shaka.config.CodecSwitchingStrategy.SMOOTH||!shaka.media.Capabilities.isChangeTypeSupported()||this.needSplitMuxedContent_)},shaka.media.MediaSourceEngine.prototype.updateLcevcDec=function(e){this.lcevcDec_=e},shaka.media.MediaSourceEngine.prototype.addExtraFeaturesToMimeType_=function(e){return e+=this.config_.addExtraFeaturesToSourceBuffer(e),shaka.log.debug("Using full mime type",e),e},shaka.media.MediaSourceEngine.createObjectURL=window.URL.createObjectURL,shaka.media.MediaSourceEngine.SourceBufferMode_={SEQUENCE:"sequence",SEGMENTS:"segments"},shaka.media.PresentationTimeline=function(e,t,r){this.presentationStartTime_=e,this.presentationDelay_=t,this.segmentAvailabilityDuration_=this.duration_=1/0,this.maxSegmentDuration_=1,this.maxSegmentEndTime_=this.minSegmentStartTime_=null,this.clockOffset_=0,this.static_=!0,this.isLive2VodTransition_=!1,this.userSeekStart_=0,this.autoCorrectDrift_=void 0===r||r,this.availabilityTimeOffset_=0,this.startTimeLocked_=!1,this.initialProgramDateTime_=e},shaka.media.PresentationTimeline.prototype.getDuration=function(){return this.duration_},shaka.media.PresentationTimeline.prototype.getMaxSegmentDuration=function(){return this.maxSegmentDuration_},shaka.media.PresentationTimeline.prototype.setPresentationStartTime=function(e){goog.asserts.assert(0<=e,"presentationStartTime must be >= 0"),this.presentationStartTime_=e},shaka.media.PresentationTimeline.prototype.setDuration=function(e){goog.asserts.assert(0<e,"duration must be > 0"),this.duration_=e},shaka.media.PresentationTimeline.prototype.getPresentationStartTime=function(){return this.presentationStartTime_},shaka.media.PresentationTimeline.prototype.setClockOffset=function(e){this.clockOffset_=e},shaka.media.PresentationTimeline.prototype.setStatic=function(e){e&&!this.static_&&(this.isLive2VodTransition_=!0),this.static_=e},shaka.media.PresentationTimeline.prototype.setSegmentAvailabilityDuration=function(e){goog.asserts.assert(0<=e,"segmentAvailabilityDuration must be >= 0"),this.segmentAvailabilityDuration_=e},shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityDuration=function(){return this.segmentAvailabilityDuration_},shaka.media.PresentationTimeline.prototype.setDelay=function(e){goog.asserts.assert(0<=e,"delay must be >= 0"),this.presentationDelay_=e},shaka.media.PresentationTimeline.prototype.getDelay=function(){return this.presentationDelay_},shaka.media.PresentationTimeline.prototype.notifyTimeRange=function(e,t){if(0!=e.length){var r=(Date.now()+this.clockOffset_)/1e3;if(0!=(e=e.filter((function(e){return e.start+t<r}))).length){var n=e[e.length-1].end+t;this.notifyMinSegmentStartTime(e[0].start+t),this.maxSegmentDuration_=e.reduce((function(e,t){return Math.max(e,t.end-t.start)}),this.maxSegmentDuration_),this.maxSegmentEndTime_=Math.max(this.maxSegmentEndTime_,n),null!=this.presentationStartTime_&&this.autoCorrectDrift_&&!this.startTimeLocked_&&(this.presentationStartTime_=r-this.maxSegmentEndTime_-this.maxSegmentDuration_),shaka.log.v1("notifySegments:","maxSegmentDuration="+this.maxSegmentDuration_)}}},shaka.media.PresentationTimeline.prototype.notifySegments=function(e){if(0!=e.length){for(var t=e[0].startTime,r=e[0].endTime,n=(Date.now()+this.clockOffset_)/1e3,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())n<(a=a.value).startTime||(t=Math.min(t,a.startTime),r=Math.max(r,a.endTime),this.maxSegmentDuration_=Math.max(this.maxSegmentDuration_,a.endTime-a.startTime));this.notifyMinSegmentStartTime(t),this.maxSegmentEndTime_=Math.max(this.maxSegmentEndTime_,r),null!=this.presentationStartTime_&&this.autoCorrectDrift_&&!this.startTimeLocked_&&(this.presentationStartTime_=n-this.maxSegmentEndTime_-this.maxSegmentDuration_),shaka.log.v1("notifySegments:","maxSegmentDuration="+this.maxSegmentDuration_)}},shaka.media.PresentationTimeline.prototype.notifyPeriodDuration=function(e,t){this.notifyMinSegmentStartTime(e),1/0==t||this.isLive()||(this.maxSegmentEndTime_=Math.max(this.maxSegmentEndTime_,t))},shaka.media.PresentationTimeline.prototype.getMaxSegmentEndTime=function(){return this.maxSegmentEndTime_},shaka.media.PresentationTimeline.prototype.lockStartTime=function(){this.startTimeLocked_=!0},shaka.media.PresentationTimeline.prototype.isStartTimeLocked=function(){return this.startTimeLocked_},shaka.media.PresentationTimeline.prototype.setInitialProgramDateTime=function(e){this.initialProgramDateTime_=e},shaka.media.PresentationTimeline.prototype.getInitialProgramDateTime=function(){return this.initialProgramDateTime_},shaka.media.PresentationTimeline.prototype.notifyMinSegmentStartTime=function(e){null==this.minSegmentStartTime_?this.minSegmentStartTime_=e:this.isLive2VodTransition_||(this.minSegmentStartTime_=Math.min(this.minSegmentStartTime_,e))},shaka.media.PresentationTimeline.prototype.notifyMaxSegmentDuration=function(e){this.maxSegmentDuration_=Math.max(this.maxSegmentDuration_,e),shaka.log.v1("notifyNewSegmentDuration:","maxSegmentDuration="+this.maxSegmentDuration_)},shaka.media.PresentationTimeline.prototype.offset=function(e){null!=this.minSegmentStartTime_&&(this.minSegmentStartTime_+=e),null!=this.maxSegmentEndTime_&&(this.maxSegmentEndTime_+=e)},shaka.media.PresentationTimeline.prototype.isLive=function(){return 1/0==this.duration_&&!this.static_},shaka.media.PresentationTimeline.prototype.isInProgress=function(){return 1/0!=this.duration_&&!this.static_},shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityStart=function(){goog.asserts.assert(0<=this.segmentAvailabilityDuration_,"The availability duration should be positive");var e=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_;return Math.max(this.userSeekStart_,e)},shaka.media.PresentationTimeline.prototype.setUserSeekStart=function(e){this.userSeekStart_=e},shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityEnd=function(){return this.isLive()||this.isInProgress()?Math.min(this.getLiveEdge_()+this.availabilityTimeOffset_,this.duration_):this.maxSegmentEndTime_?Math.min(this.maxSegmentEndTime_,this.duration_):this.duration_},shaka.media.PresentationTimeline.prototype.getSafeSeekRangeStart=function(e){var t=Math.max(this.minSegmentStartTime_,this.userSeekStart_);if(1/0==this.segmentAvailabilityDuration_)return Math.ceil(1e3*t)/1e3;var r=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_;return e=Math.min(r+e,this.getSeekRangeEnd()),Math.max(t,e)},shaka.media.PresentationTimeline.prototype.getSeekRangeStart=function(){return this.getSafeSeekRangeStart(0)},shaka.media.PresentationTimeline.prototype.getSeekRangeEnd=function(){var e=this.isLive()||this.isInProgress()?this.presentationDelay_:0;return Math.max(0,this.getSegmentAvailabilityEnd()-e)},shaka.media.PresentationTimeline.prototype.usingPresentationStartTime=function(){return!(null==this.presentationStartTime_||null!=this.maxSegmentEndTime_&&this.autoCorrectDrift_)},shaka.media.PresentationTimeline.prototype.getLiveEdge_=function(){goog.asserts.assert(null!=this.presentationStartTime_,"Cannot compute timeline live edge without start time");var e=(Date.now()+this.clockOffset_)/1e3;return Math.max(0,e-this.maxSegmentDuration_-this.presentationStartTime_)},shaka.media.PresentationTimeline.prototype.setAvailabilityTimeOffset=function(e){this.availabilityTimeOffset_=e},shaka.media.PresentationTimeline.prototype.getAvailabilityTimeOffset=function(){return this.availabilityTimeOffset_},shaka.media.PresentationTimeline.prototype.assertIsValid=function(){goog.DEBUG&&(this.isLive()?goog.asserts.assert(null!=this.presentationStartTime_,"Detected as live stream, but does not match our model of live!"):this.isInProgress()?goog.asserts.assert(null!=this.presentationStartTime_&&1/0==this.segmentAvailabilityDuration_,"Detected as IPR stream, but does not match our model of IPR!"):goog.asserts.assert(1/0==this.segmentAvailabilityDuration_&&1/0!=this.duration_&&this.static_,"Detected as VOD stream, but does not match our model of VOD!"))},goog.exportSymbol("shaka.media.PresentationTimeline",shaka.media.PresentationTimeline),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getAvailabilityTimeOffset",shaka.media.PresentationTimeline.prototype.getAvailabilityTimeOffset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setAvailabilityTimeOffset",shaka.media.PresentationTimeline.prototype.setAvailabilityTimeOffset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"usingPresentationStartTime",shaka.media.PresentationTimeline.prototype.usingPresentationStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSeekRangeEnd",shaka.media.PresentationTimeline.prototype.getSeekRangeEnd),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSeekRangeStart",shaka.media.PresentationTimeline.prototype.getSeekRangeStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSafeSeekRangeStart",shaka.media.PresentationTimeline.prototype.getSafeSeekRangeStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSegmentAvailabilityEnd",shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityEnd),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setUserSeekStart",shaka.media.PresentationTimeline.prototype.setUserSeekStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSegmentAvailabilityStart",shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"isInProgress",shaka.media.PresentationTimeline.prototype.isInProgress),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"isLive",shaka.media.PresentationTimeline.prototype.isLive),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"offset",shaka.media.PresentationTimeline.prototype.offset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifyMaxSegmentDuration",shaka.media.PresentationTimeline.prototype.notifyMaxSegmentDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifyMinSegmentStartTime",shaka.media.PresentationTimeline.prototype.notifyMinSegmentStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getInitialProgramDateTime",shaka.media.PresentationTimeline.prototype.getInitialProgramDateTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setInitialProgramDateTime",shaka.media.PresentationTimeline.prototype.setInitialProgramDateTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"isStartTimeLocked",shaka.media.PresentationTimeline.prototype.isStartTimeLocked),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"lockStartTime",shaka.media.PresentationTimeline.prototype.lockStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getMaxSegmentEndTime",shaka.media.PresentationTimeline.prototype.getMaxSegmentEndTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifyPeriodDuration",shaka.media.PresentationTimeline.prototype.notifyPeriodDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifySegments",shaka.media.PresentationTimeline.prototype.notifySegments),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifyTimeRange",shaka.media.PresentationTimeline.prototype.notifyTimeRange),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getDelay",shaka.media.PresentationTimeline.prototype.getDelay),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setDelay",shaka.media.PresentationTimeline.prototype.setDelay),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSegmentAvailabilityDuration",shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setSegmentAvailabilityDuration",shaka.media.PresentationTimeline.prototype.setSegmentAvailabilityDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setStatic",shaka.media.PresentationTimeline.prototype.setStatic),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setClockOffset",shaka.media.PresentationTimeline.prototype.setClockOffset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getPresentationStartTime",shaka.media.PresentationTimeline.prototype.getPresentationStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setDuration",shaka.media.PresentationTimeline.prototype.setDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setPresentationStartTime",shaka.media.PresentationTimeline.prototype.setPresentationStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getMaxSegmentDuration",shaka.media.PresentationTimeline.prototype.getMaxSegmentDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getDuration",shaka.media.PresentationTimeline.prototype.getDuration),shaka.media.GapJumpingController=function(e,t,r,n){var a=this;this.onEvent_=n,this.video_=e,this.timeline_=t,this.config_=r,this.eventManager_=new shaka.util.EventManager,this.seekingEventReceived_=this.started_=!1,this.prevReadyState_=e.readyState,this.stallsDetected_=this.gapsJumped_=this.startTime_=0,this.stallDetector_=this.createStallDetector_(),this.hadSegmentAppended_=!1,this.eventManager_.listen(e,"waiting",(function(){return a.onPollGapJump_()})),this.gapJumpTimer_=new shaka.util.Timer((function(){a.onPollGapJump_()})).tickEvery(this.config_.gapJumpTimerTime)},shaka.media.GapJumpingController.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.gapJumpTimer_&&(this.gapJumpTimer_.stop(),this.gapJumpTimer_=null),this.stallDetector_&&(this.stallDetector_.release(),this.stallDetector_=null),this.video_=this.timeline_=this.onEvent_=null},shaka.media.GapJumpingController.prototype.onSegmentAppended=function(){this.hadSegmentAppended_=!0,this.gapJumpTimer_&&this.gapJumpTimer_.tickEvery(this.config_.gapJumpTimerTime),this.onPollGapJump_()},shaka.media.GapJumpingController.prototype.onStarted=function(e){this.video_.seeking&&!this.seekingEventReceived_&&(this.seekingEventReceived_=!0,this.startTime_=e),this.gapJumpTimer_&&this.gapJumpTimer_.tickEvery(this.config_.gapJumpTimerTime),this.onPollGapJump_()},shaka.media.GapJumpingController.prototype.onSeeking=function(){this.seekingEventReceived_=!0,this.hadSegmentAppended_=!1,this.gapJumpTimer_&&this.gapJumpTimer_.tickEvery(this.config_.gapJumpTimerTime),this.onPollGapJump_()},shaka.media.GapJumpingController.prototype.getGapsJumped=function(){return this.gapsJumped_},shaka.media.GapJumpingController.prototype.getStallsDetected=function(){return this.stallsDetected_},shaka.media.GapJumpingController.prototype.onPollGapJump_=function(){if(0!=this.video_.readyState){if(this.video_.seeking){if(!this.seekingEventReceived_)return}else this.seekingEventReceived_=!1;if((!this.video_.paused||this.video_.currentTime==this.startTime_&&(this.video_.autoplay||this.video_.currentTime!=this.startTime_))&&(this.video_.readyState!=this.prevReadyState_&&(this.prevReadyState_=this.video_.readyState),!this.stallDetector_||!this.stallDetector_.poll())){var e=this.video_.currentTime,t=this.video_.buffered,r=shaka.media.TimeRangesUtils.getGapIndex(t,e,this.config_.gapDetectionThreshold);if(null!=r&&(0!=r||this.hadSegmentAppended_)){var n=t.start(r),a=this.config_.gapPadding;a&&(n=Math.ceil(100*(n+a))/100),n>=(a=this.timeline_.getSeekRangeEnd())||((a=n-e)<shaka.media.GapJumpingController.BROWSER_GAP_TOLERANCE||(0==r?shaka.log.info("Jumping forward",a,"seconds because of gap before start time of",n):shaka.log.info("Jumping forward",a,"seconds because of gap starting at",t.end(r-1),"and ending at",n),this.video_.currentTime=n,e==this.startTime_&&(this.startTime_=n),this.gapsJumped_++,this.onEvent_(new shaka.util.FakeEvent(shaka.util.FakeEvent.EventName.GapJumped))))}}}},shaka.media.GapJumpingController.prototype.createStallDetector_=function(){var e=this;if(!this.config_.stallEnabled)return null;goog.asserts.assert(this.video_,"Must have video");var t=this.config_.stallThreshold,r=this.config_.stallSkip;return new shaka.media.StallDetector(new shaka.media.StallDetector.MediaElementImplementation(this.video_),t,(function(t,n){return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return goog.asserts.assert(e.video_,"Must have video"),shaka.media.TimeRangesUtils.getBufferedInfo(e.video_.buffered).length?(shaka.log.debug("Stall detected at "+t+" for "+n+" seconds."),r?(shaka.log.debug("Seeking forward "+r+" seconds to break stall."),e.video_.currentTime+=r,a.jumpTo(2)):(shaka.log.debug("Wait for play to avoid reject a possible other play call."),a.yield(e.video_.play(),3))):a.return();if(2!=a.nextAddress){if(!e.video_)return a.return();shaka.log.debug("Pausing and unpausing to break stall."),e.video_.pause(),e.video_.play()}e.stallsDetected_++,e.onEvent_(new shaka.util.FakeEvent(shaka.util.FakeEvent.EventName.StallDetected)),a.jumpToEnd()}))}))},shaka.media.GapJumpingController.BROWSER_GAP_TOLERANCE=.001,shaka.media.StallDetector=function(e,t,r){this.implementation_=e,this.wasMakingProgress_=e.shouldBeMakingProgress(),this.value_=e.getPresentationSeconds(),this.lastUpdateSeconds_=e.getWallSeconds(),this.didJump_=!1,this.stallThresholdSeconds_=t,this.onStall_=r},shaka.media.StallDetector.prototype.release=function(){this.onStall_=this.implementation_=null},shaka.media.StallDetector.prototype.poll=function(){var e=this.implementation_,t=e.shouldBeMakingProgress(),r=e.getPresentationSeconds(),n=e.getWallSeconds();return this.value_==r&&this.wasMakingProgress_==t||(this.lastUpdateSeconds_=n,this.value_=r,this.wasMakingProgress_=t,this.didJump_=!1),(t=(r=n-this.lastUpdateSeconds_)>=this.stallThresholdSeconds_&&t&&!this.didJump_)&&(this.onStall_&&this.onStall_(this.value_,r),this.didJump_=!0,this.value_=e.getPresentationSeconds()),t},shaka.media.StallDetector.Implementation=function(){},shaka.media.StallDetector.Implementation.prototype.shouldBeMakingProgress=function(){},shaka.media.StallDetector.Implementation.prototype.getPresentationSeconds=function(){},shaka.media.StallDetector.Implementation.prototype.getWallSeconds=function(){},shaka.media.StallDetector.MediaElementImplementation=function(e){this.mediaElement_=e},shaka.media.StallDetector.MediaElementImplementation.prototype.shouldBeMakingProgress=function(){return!this.mediaElement_.paused&&0!=this.mediaElement_.playbackRate&&0!=this.mediaElement_.buffered.length&&this.hasContentFor_(this.mediaElement_.buffered,this.mediaElement_.currentTime)},shaka.media.StallDetector.MediaElementImplementation.prototype.getPresentationSeconds=function(){return this.mediaElement_.currentTime},shaka.media.StallDetector.MediaElementImplementation.prototype.getWallSeconds=function(){return Date.now()/1e3},shaka.media.StallDetector.MediaElementImplementation.prototype.hasContentFor_=function(e,t){for(var r=(e=$jscomp.makeIterator(shaka.media.TimeRangesUtils.getBufferedInfo(e))).next();!r.done;r=e.next())if(!(t<(r=r.value).start-.1||t>r.end-.5))return!0;return!1},shaka.util.MediaReadyState=function(){},shaka.util.MediaReadyState.waitForReadyState=function(e,t,r,n){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?n():(t=shaka.util.MediaReadyState.READY_STATES_TO_EVENT_NAMES_.value().get(t),r.listenOnce(e,t,n))},shaka.util.MediaReadyState.READY_STATES_TO_EVENT_NAMES_=new shaka.util.Lazy((function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])})),shaka.media.VideoWrapper=function(e,t,r,n){var a=this;this.video_=e,this.onSeek_=t,this.onStarted_=r,this.startTime_=null,this.getStartTime_=function(){return null==a.startTime_&&(a.startTime_=n()),a.startTime_},this.started_=!1,this.eventManager_=new shaka.util.EventManager,this.mover_=new shaka.media.VideoWrapper.PlayheadMover(e,10),shaka.util.MediaReadyState.waitForReadyState(this.video_,HTMLMediaElement.HAVE_METADATA,this.eventManager_,(function(){a.setStartTime_(a.getStartTime_())}))},shaka.media.VideoWrapper.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.mover_&&(this.mover_.release(),this.mover_=null),this.onSeek_=function(){},this.video_=null},shaka.media.VideoWrapper.prototype.getTime=function(){return this.started_?this.video_.currentTime:this.getStartTime_()},shaka.media.VideoWrapper.prototype.setTime=function(e){var t=this;0<this.video_.readyState?this.mover_.moveTo(e):shaka.util.MediaReadyState.waitForReadyState(this.video_,HTMLMediaElement.HAVE_METADATA,this.eventManager_,(function(){t.setStartTime_(t.getStartTime_())}))},shaka.media.VideoWrapper.prototype.setStartTime_=function(e){var t=this;.001>Math.abs(this.video_.currentTime-e)?this.startListeningToSeeks_():(this.eventManager_.listenOnce(this.video_,"seeking",(function(){t.startListeningToSeeks_()})),this.mover_.moveTo(this.video_.currentTime&&0!=this.video_.currentTime?this.video_.currentTime:e))},shaka.media.VideoWrapper.prototype.startListeningToSeeks_=function(){var e=this;goog.asserts.assert(0<this.video_.readyState,"The media element should be ready before we listen for seeking."),this.started_=!0,this.eventManager_.listen(this.video_,"seeking",(function(){return e.onSeek_()})),this.onStarted_(this.video_.currentTime)},shaka.media.VideoWrapper.PlayheadMover=function(e,t){var r=this;this.mediaElement_=e,this.maxAttempts_=t,this.targetTime_=this.originTime_=this.remainingAttempts_=0,this.timer_=new shaka.util.Timer((function(){return r.onTick_()}))},shaka.media.VideoWrapper.PlayheadMover.prototype.release=function(){this.timer_&&(this.timer_.stop(),this.timer_=null),this.mediaElement_=null},shaka.media.VideoWrapper.PlayheadMover.prototype.moveTo=function(e){this.originTime_=this.mediaElement_.currentTime,this.targetTime_=e,this.remainingAttempts_=this.maxAttempts_,this.mediaElement_.currentTime=e,this.timer_.tickEvery(.1)},shaka.media.VideoWrapper.PlayheadMover.prototype.onTick_=function(){0>=this.remainingAttempts_?(shaka.log.warning(["Failed to move playhead from",this.originTime_,"to",this.targetTime_].join(" ")),this.timer_.stop()):this.mediaElement_.currentTime!=this.originTime_||this.mediaElement_.currentTime===this.targetTime_?this.timer_.stop():(this.mediaElement_.currentTime=this.targetTime_,this.remainingAttempts_--)},shaka.media.Playhead=function(){},shaka.media.Playhead.prototype.ready=function(){},shaka.media.Playhead.prototype.setStartTime=function(e){},shaka.media.Playhead.prototype.getStallsDetected=function(){},shaka.media.Playhead.prototype.getGapsJumped=function(){},shaka.media.Playhead.prototype.getTime=function(){},shaka.media.Playhead.prototype.notifyOfBufferingChange=function(){},shaka.media.SrcEqualsPlayhead=function(e){this.mediaElement_=e,this.started_=!1,this.startTime_=null,this.eventManager_=new shaka.util.EventManager},shaka.media.SrcEqualsPlayhead.prototype.ready=function(){var e=this;goog.asserts.assert(null!=this.mediaElement_,"Playhead should not be released before calling ready()");shaka.util.MediaReadyState.waitForReadyState(this.mediaElement_,HTMLMediaElement.HAVE_CURRENT_DATA,this.eventManager_,(function(){!function(){if(null==e.startTime_||0==e.startTime_&&1/0!=e.mediaElement_.duration)e.started_=!0;else{var t=e.mediaElement_.currentTime,r=e.startTime_;0>e.startTime_&&(r=Math.max(0,t+e.startTime_)),t!=r?(e.eventManager_.listenOnce(e.mediaElement_,"seeking",(function(){e.started_=!0})),e.mediaElement_.currentTime=r):e.started_=!0}}()}))},shaka.media.SrcEqualsPlayhead.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.mediaElement_=null},shaka.media.SrcEqualsPlayhead.prototype.setStartTime=function(e){this.startTime_=this.started_?this.startTime_:e},shaka.media.SrcEqualsPlayhead.prototype.getTime=function(){return(this.started_?this.mediaElement_.currentTime:this.startTime_)||0},shaka.media.SrcEqualsPlayhead.prototype.getStallsDetected=function(){return 0},shaka.media.SrcEqualsPlayhead.prototype.getGapsJumped=function(){return 0},shaka.media.SrcEqualsPlayhead.prototype.notifyOfBufferingChange=function(){},shaka.media.MediaSourcePlayhead=function(e,t,r,n,a,i){var s=this;this.minSeekRange_=3,this.mediaElement_=e,this.timeline_=t.presentationTimeline,this.config_=r,this.onSeek_=a,this.lastCorrectiveSeek_=null,this.gapController_=new shaka.media.GapJumpingController(e,t.presentationTimeline,r,i),this.videoWrapper_=new shaka.media.VideoWrapper(e,(function(){return s.onSeeking_()}),(function(e){return s.onStarted_(e)}),(function(){return s.getStartTime_(n)})),this.checkWindowTimer_=new shaka.util.Timer((function(){s.onPollWindow_()}))},shaka.media.MediaSourcePlayhead.prototype.ready=function(){this.checkWindowTimer_.tickEvery(.25)},shaka.media.MediaSourcePlayhead.prototype.release=function(){this.videoWrapper_&&(this.videoWrapper_.release(),this.videoWrapper_=null),this.gapController_&&(this.gapController_.release(),this.gapController_=null),this.checkWindowTimer_&&(this.checkWindowTimer_.stop(),this.checkWindowTimer_=null),this.mediaElement_=this.videoWrapper_=this.timeline_=this.config_=null,this.onSeek_=function(){}},shaka.media.MediaSourcePlayhead.prototype.setStartTime=function(e){this.videoWrapper_.setTime(e)},shaka.media.MediaSourcePlayhead.prototype.getTime=function(){var e=this.videoWrapper_.getTime();return 0<this.mediaElement_.readyState&&!this.mediaElement_.paused?this.clampTime_(e):e},shaka.media.MediaSourcePlayhead.prototype.getStallsDetected=function(){return this.gapController_.getStallsDetected()},shaka.media.MediaSourcePlayhead.prototype.getGapsJumped=function(){return this.gapController_.getGapsJumped()},shaka.media.MediaSourcePlayhead.prototype.getStartTime_=function(e){return null==e?e=1/0>this.timeline_.getDuration()?this.timeline_.getSeekRangeStart():this.timeline_.getSeekRangeEnd():0>e&&(e=this.timeline_.getSeekRangeEnd()+e),this.clampSeekToDuration_(this.clampTime_(e))},shaka.media.MediaSourcePlayhead.prototype.notifyOfBufferingChange=function(){this.gapController_.onSegmentAppended()},shaka.media.MediaSourcePlayhead.prototype.onPollWindow_=function(){if(0!=this.mediaElement_.readyState&&!this.mediaElement_.paused){var e=this.videoWrapper_.getTime(),t=this.timeline_.getSeekRangeStart(),r=this.timeline_.getSeekRangeEnd();r-t<this.minSeekRange_&&(t=r-this.minSeekRange_),e<t&&(t=this.reposition_(e),shaka.log.info("Jumping forward "+(t-e)+" seconds to catch up with the seek range."),this.mediaElement_.currentTime=t)}},shaka.media.MediaSourcePlayhead.prototype.onStarted_=function(e){this.gapController_.onStarted(e)},shaka.media.MediaSourcePlayhead.prototype.onSeeking_=function(){this.gapController_.onSeeking();var e=this.videoWrapper_.getTime(),t=this.reposition_(e),r=shaka.media.GapJumpingController.BROWSER_GAP_TOLERANCE;if(!shaka.media.Capabilities.isInfiniteLiveStreamDurationSupported()&&Math.abs(t-e)>r){if(r=!1,shaka.util.Platform.isSeekingSlow()){var n=Date.now()/1e3,a=shaka.util.Platform.isFuchsiaCastDevice()?3:1;(!this.lastCorrectiveSeek_||this.lastCorrectiveSeek_<n-a)&&(this.lastCorrectiveSeek_=n,r=!0)}else r=!0;if(r)return void this.videoWrapper_.setTime(t)}shaka.log.v1("Seek to "+e),this.onSeek_()},shaka.media.MediaSourcePlayhead.prototype.clampSeekToDuration_=function(e){var t=this.timeline_.getDuration();return e>=t?(goog.asserts.assert(0<=this.config_.durationBackoff,"Duration backoff must be non-negative!"),t-this.config_.durationBackoff):e},shaka.media.MediaSourcePlayhead.prototype.reposition_=function(e){goog.asserts.assert(this.config_,"Cannot reposition playhead when it has been destroyed");var t=this.config_.rebufferingGoal,r=this.config_.safeSeekOffset,n=this.timeline_.getSeekRangeStart(),a=this.timeline_.getSeekRangeEnd(),i=this.timeline_.getDuration();a-n<this.minSeekRange_&&(n=a-this.minSeekRange_);var s=this.timeline_.getSafeSeekRangeStart(t),o=this.timeline_.getSafeSeekRangeStart(r);return t=this.timeline_.getSafeSeekRangeStart(t+r),e>=i?(shaka.log.v1("Playhead past duration."),this.clampSeekToDuration_(e)):e>a?(shaka.log.v1("Playhead past end."),a-this.config_.safeSeekEndOffset):e<n?shaka.media.TimeRangesUtils.isBuffered(this.mediaElement_.buffered,o)?(shaka.log.v1("Playhead before start & start is buffered"),o):(shaka.log.v1("Playhead before start & start is unbuffered"),t):e>=s||shaka.media.TimeRangesUtils.isBuffered(this.mediaElement_.buffered,e)?(shaka.log.v1("Playhead in safe region or in buffered region."),e):(shaka.log.v1("Playhead outside safe region & in unbuffered region."),t)},shaka.media.MediaSourcePlayhead.prototype.clampTime_=function(e){var t=this.timeline_.getSeekRangeStart();return e<t||e>(t=this.timeline_.getSeekRangeEnd())?t:e},shaka.media.SegmentIndex=function(e){goog.DEBUG&&shaka.media.SegmentIndex.assertCorrectReferences_(e),this.references=e,this.timer_=null,this.numEvicted_=0,this.immutable_=!1},shaka.media.SegmentIndex.prototype.getIsImmutable=function(){return this.immutable_},shaka.media.SegmentIndex.prototype.getNumReferences=function(){return this.references.length},shaka.media.SegmentIndex.prototype.getNumEvicted=function(){return this.numEvicted_},shaka.media.SegmentIndex.prototype.release=function(){this.immutable_||(this.references=[],this.timer_&&this.timer_.stop(),this.timer_=null)},shaka.media.SegmentIndex.prototype.markImmutable=function(){this.immutable_=!0},shaka.media.SegmentIndex.prototype.forEachTopLevelReference=function(e){for(var t=$jscomp.makeIterator(this.references),r=t.next();!r.done;r=t.next())e(r.value)},shaka.media.SegmentIndex.prototype.earliestReference=function(){return this.references[0]||null},shaka.media.SegmentIndex.prototype.dropFirstReferences=function(e){this.references.splice(0,e)},shaka.media.SegmentIndex.prototype.find=function(e){for(var t=this.references.length-1,r=t;0<=r;--r){var n=this.references[r],a=r<t?this.references[r+1].startTime:n.endTime;if(e>=n.startTime&&e<a)return r+this.numEvicted_}return this.references.length&&e<this.references[0].startTime?this.numEvicted_:null},shaka.media.SegmentIndex.prototype.get=function(e){return 0==this.references.length||0>(e-=this.numEvicted_)||e>=this.references.length?null:this.references[e]},shaka.media.SegmentIndex.prototype.offset=function(e){if(!this.immutable_)for(var t=$jscomp.makeIterator(this.references),r=t.next();!r.done;r=t.next())r.value.offset(e)},shaka.media.SegmentIndex.prototype.merge=function(e){if(goog.DEBUG&&shaka.media.SegmentIndex.assertCorrectReferences_(e),!this.immutable_&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.references=this.references.filter((function(e){return Math.round(1e3*e.startTime)/1e3<t})),this.references.push.apply(this.references,$jscomp.arrayFromIterable(e)),goog.DEBUG&&shaka.media.SegmentIndex.assertCorrectReferences_(this.references)}},shaka.media.SegmentIndex.prototype.mergeAndEvict=function(e,t){var r=this;e=e.filter((function(e){return e.endTime>t&&(0==r.references.length||e.endTime>r.references[0].startTime)}));var n=this.references[0];this.merge(e),e=this.references[0],n&&goog.asserts.assert(n.startTime==e.startTime,"SegmentIndex.merge should not change the first reference time!"),this.evict(t)},shaka.media.SegmentIndex.prototype.evict=function(e){if(!this.immutable_){var t=this.references.length;this.references=this.references.filter((function(t){return t.endTime>e})),this.numEvicted_+=t-this.references.length}},shaka.media.SegmentIndex.prototype.fit=function(e,t,r){if(r=void 0!==r&&r,goog.asserts.assert(null!=t,"Content duration must be known for static content!"),goog.asserts.assert(1/0!=t,"Content duration must be finite for static content!"),!this.immutable_){for(;this.references.length&&this.references[this.references.length-1].startTime>=t;)this.references.pop();for(;this.references.length&&this.references[0].endTime<=e;)this.references.shift(),r||this.numEvicted_++;0!=this.references.length&&(e=this.references[this.references.length-1],(t=new shaka.media.SegmentReference(e.startTime,t,e.getUrisInner,e.startByte,e.endByte,e.initSegmentReference,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.partialReferences,e.tilesLayout,e.tileDuration,e.syncTime,e.status,e.aesKey)).mimeType=e.mimeType,t.codecs=e.codecs,t.discontinuitySequence=e.discontinuitySequence,this.references[this.references.length-1]=t)}},shaka.media.SegmentIndex.prototype.updateEvery=function(e,t){var r=this;goog.asserts.assert(!this.timer_,"SegmentIndex timer already started!"),this.immutable_||(this.timer_&&this.timer_.stop(),this.timer_=new shaka.util.Timer((function(){var e=t();e?r.references.push.apply(r.references,$jscomp.arrayFromIterable(e)):(r.timer_.stop(),r.timer_=null)})),this.timer_.tickEvery(e))},shaka.media.SegmentIndex.prototype[Symbol.iterator]=function(){var e=this.getIteratorForTime(0);return goog.asserts.assert(null!=e,"Iterator for 0 should never be null!"),e},shaka.media.SegmentIndex.prototype.getIteratorForTime=function(e,t,r){t=void 0!==t&&t,r=void 0!==r&&r;var n=this.find(e);if(null==n)return null;var a=this.get(n);r?n++:n--;var i=-1;if(a&&a.hasPartialSegments())for(var s=a.partialReferences.length-1;0<=s;--s){var o=a.partialReferences[s];if(e>=o.startTime&&e<o.endTime){if(!t){for(;s&&!o.isIndependent();)s--,o=a.partialReferences[s];if(!o.isIndependent())return shaka.log.alwaysError("No independent partial segment found!"),null}r?n--:n++,i=s-1;break}}return new shaka.media.SegmentIterator(this,n,i,r)},shaka.media.SegmentIndex.prototype.isEmpty=function(){return 0==this.getNumReferences()},shaka.media.SegmentIndex.forSingleSegment=function(e,t,r){return e=new shaka.media.SegmentReference(e,e+t,(function(){return r}),0,null,null,e,e,e+t),new shaka.media.SegmentIndex([e])},goog.exportSymbol("shaka.media.SegmentIndex",shaka.media.SegmentIndex),goog.exportProperty(shaka.media.SegmentIndex,"forSingleSegment",shaka.media.SegmentIndex.forSingleSegment),goog.exportProperty(shaka.media.SegmentIndex.prototype,"getIteratorForTime",shaka.media.SegmentIndex.prototype.getIteratorForTime),goog.exportProperty(shaka.media.SegmentIndex.prototype,"updateEvery",shaka.media.SegmentIndex.prototype.updateEvery),goog.exportProperty(shaka.media.SegmentIndex.prototype,"fit",shaka.media.SegmentIndex.prototype.fit),goog.exportProperty(shaka.media.SegmentIndex.prototype,"evict",shaka.media.SegmentIndex.prototype.evict),goog.exportProperty(shaka.media.SegmentIndex.prototype,"mergeAndEvict",shaka.media.SegmentIndex.prototype.mergeAndEvict),goog.exportProperty(shaka.media.SegmentIndex.prototype,"offset",shaka.media.SegmentIndex.prototype.offset),goog.exportProperty(shaka.media.SegmentIndex.prototype,"get",shaka.media.SegmentIndex.prototype.get),goog.exportProperty(shaka.media.SegmentIndex.prototype,"find",shaka.media.SegmentIndex.prototype.find),goog.exportProperty(shaka.media.SegmentIndex.prototype,"markImmutable",shaka.media.SegmentIndex.prototype.markImmutable),goog.exportProperty(shaka.media.SegmentIndex.prototype,"release",shaka.media.SegmentIndex.prototype.release),goog.exportProperty(shaka.media.SegmentIndex.prototype,"getNumEvicted",shaka.media.SegmentIndex.prototype.getNumEvicted),goog.exportProperty(shaka.media.SegmentIndex.prototype,"getNumReferences",shaka.media.SegmentIndex.prototype.getNumReferences),goog.DEBUG&&(shaka.media.SegmentIndex.assertCorrectReferences_=function(e){goog.asserts.assert(e.every((function(t,r){return 0==r||((r=e[r-1]).startTime<t.startTime||!(r.startTime>t.startTime)&&r.endTime<=t.endTime)})),"SegmentReferences are incorrect")}),shaka.media.SegmentIterator=function(e,t,r,n){this.segmentIndex_=e,this.currentPosition_=t,this.currentPartialPosition_=r,this.reverse=n},shaka.media.SegmentIterator.prototype.setReverse=function(e){this.reverse=e},shaka.media.SegmentIterator.prototype.currentPosition=function(){return this.currentPosition_},shaka.media.SegmentIterator.prototype.current=function(){var e=this.segmentIndex_.get(this.currentPosition_);return e&&e.hasPartialSegments()&&e.hasAllPartialSegments()&&this.currentPartialPosition_>=e.partialReferences.length&&(this.currentPosition_++,this.currentPartialPosition_=0,e=this.segmentIndex_.get(this.currentPosition_)),e&&e.hasPartialSegments()?e.partialReferences[this.currentPartialPosition_]:e},shaka.media.SegmentIterator.prototype.next=function(){var e=this.segmentIndex_.get(this.currentPosition_);return this.reverse?e&&e.hasPartialSegments()?(this.currentPartialPosition_--,0>this.currentPartialPosition_&&(this.currentPosition_--,(e=this.segmentIndex_.get(this.currentPosition_))&&e.hasPartialSegments()?this.currentPartialPosition_=e.partialReferences.length-1:this.currentPartialPosition_=0)):(this.currentPosition_--,this.currentPartialPosition_=0):e&&e.hasPartialSegments()?(this.currentPartialPosition_++,e.hasAllPartialSegments()&&this.currentPartialPosition_==e.partialReferences.length&&(this.currentPosition_++,this.currentPartialPosition_=0)):(this.currentPosition_++,this.currentPartialPosition_=0),{value:e=this.current(),done:!e}},shaka.media.SegmentIterator.prototype.resetToLastIndependent=function(){var e=this.current();if(e.isPartial()&&!e.isIndependent()&&(e=this.segmentIndex_.get(this.currentPosition_))&&e.hasPartialSegments())for(var t=e.partialReferences[this.currentPartialPosition_];t.isIndependent()&&!(0>=this.currentPartialPosition_);)this.currentPartialPosition_--,t=e.partialReferences[this.currentPartialPosition_]},goog.exportSymbol("shaka.media.SegmentIterator",shaka.media.SegmentIterator),goog.exportProperty(shaka.media.SegmentIterator.prototype,"resetToLastIndependent",shaka.media.SegmentIterator.prototype.resetToLastIndependent),goog.exportProperty(shaka.media.SegmentIterator.prototype,"next",shaka.media.SegmentIterator.prototype.next),goog.exportProperty(shaka.media.SegmentIterator.prototype,"current",shaka.media.SegmentIterator.prototype.current),goog.exportProperty(shaka.media.SegmentIterator.prototype,"currentPosition",shaka.media.SegmentIterator.prototype.currentPosition),goog.exportProperty(shaka.media.SegmentIterator.prototype,"setReverse",shaka.media.SegmentIterator.prototype.setReverse),shaka.media.MetaSegmentIndex=function(){shaka.media.SegmentIndex.call(this,[]),this.indexes_=[]},$jscomp.inherits(shaka.media.MetaSegmentIndex,shaka.media.SegmentIndex),shaka.media.MetaSegmentIndex.prototype.evictEmpty=function(){for(;1<this.indexes_.length&&this.indexes_[0].isEmpty();){var e=this.indexes_.shift();this.numEvicted_+=e.getNumEvicted(),e.release()}},shaka.media.MetaSegmentIndex.prototype.appendSegmentIndex=function(e){goog.asserts.assert(0==this.indexes_.length||0==e.getNumEvicted(),"Should not append a new segment index with already-evicted segments"),this.indexes_.push(e)},shaka.media.MetaSegmentIndex.prototype.clone=function(){var e=new shaka.media.MetaSegmentIndex;return e.indexes_=this.indexes_.slice(),e.numEvicted_=this.numEvicted_,e},shaka.media.MetaSegmentIndex.prototype.release=function(){for(var e=$jscomp.makeIterator(this.indexes_),t=e.next();!t.done;t=e.next())t.value.release();this.indexes_=[]},shaka.media.MetaSegmentIndex.prototype.forEachTopLevelReference=function(e){for(var t=$jscomp.makeIterator(this.indexes_),r=t.next();!r.done;r=t.next())r.value.forEachTopLevelReference(e)},shaka.media.MetaSegmentIndex.prototype.find=function(e){for(var t=this.numEvicted_,r=$jscomp.makeIterator(this.indexes_),n=r.next();!n.done;n=r.next()){var a=(n=n.value).find(e);if(null!=a)return a+t;t+=n.getNumEvicted()+n.getNumReferences()}return null},shaka.media.MetaSegmentIndex.prototype.get=function(e){for(var t=this.numEvicted_,r=!1,n=$jscomp.makeIterator(this.indexes_),a=n.next();!a.done;a=n.next()){a=a.value,goog.asserts.assert(!r||0==a.getNumEvicted(),"Should not see evicted segments after available segments");var i=a.get(e-t);if(i)return i;i=a.getNumReferences(),t+=a.getNumEvicted()+i,r=r||0!=i}return null},shaka.media.MetaSegmentIndex.prototype.offset=function(e){goog.asserts.assert(!1,"offset() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.merge=function(e){goog.asserts.assert(!1,"merge() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.evict=function(e){for(var t=$jscomp.makeIterator(this.indexes_),r=t.next();!r.done;r=t.next())r.value.evict(e);this.evictEmpty()},shaka.media.MetaSegmentIndex.prototype.mergeAndEvict=function(e,t){goog.asserts.assert(!1,"mergeAndEvict() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.fit=function(e,t){goog.asserts.assert(!1,"fit() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.updateEvery=function(e,t){goog.asserts.assert(!1,"updateEvery() should not be used in MetaSegmentIndex!")},goog.exportSymbol("shaka.media.MetaSegmentIndex",shaka.media.MetaSegmentIndex),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"updateEvery",shaka.media.MetaSegmentIndex.prototype.updateEvery),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"fit",shaka.media.MetaSegmentIndex.prototype.fit),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"mergeAndEvict",shaka.media.MetaSegmentIndex.prototype.mergeAndEvict),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"evict",shaka.media.MetaSegmentIndex.prototype.evict),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"merge",shaka.media.MetaSegmentIndex.prototype.merge),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"offset",shaka.media.MetaSegmentIndex.prototype.offset),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"get",shaka.media.MetaSegmentIndex.prototype.get),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"find",shaka.media.MetaSegmentIndex.prototype.find),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"forEachTopLevelReference",shaka.media.MetaSegmentIndex.prototype.forEachTopLevelReference),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"release",shaka.media.MetaSegmentIndex.prototype.release),shaka.media.PlayRateController=function(e){var t=this;this.harness_=e,this.isBuffering_=!1,this.rate_=this.harness_.getRate(),this.pollRate_=.25,this.timer_=new shaka.util.Timer((function(){t.harness_.movePlayhead(t.rate_*t.pollRate_)}))},shaka.media.PlayRateController.prototype.release=function(){this.set(this.getDefaultRate()),this.timer_&&(this.timer_.stop(),this.timer_=null),this.harness_=null},shaka.media.PlayRateController.prototype.setBuffering=function(e){this.isBuffering_=e,this.apply_()},shaka.media.PlayRateController.prototype.set=function(e){goog.asserts.assert(0!=e,"Should never set rate of 0 explicitly!"),this.rate_=e,this.apply_()},shaka.media.PlayRateController.prototype.getRealRate=function(){return this.rate_},shaka.media.PlayRateController.prototype.getDefaultRate=function(){return this.harness_.getDefaultRate()},shaka.media.PlayRateController.prototype.apply_=function(){this.timer_.stop();var e=this.calculateCurrentRate_();if(shaka.log.v1("Changing effective playback rate to",e),0<=e)try{return void this.applyRate_(e)}catch(e){}this.timer_.tickEvery(this.pollRate_),this.applyRate_(0)},shaka.media.PlayRateController.prototype.calculateCurrentRate_=function(){return this.isBuffering_?0:this.rate_},shaka.media.PlayRateController.prototype.applyRate_=function(e){var t=this.harness_.getRate();return t!=e&&this.harness_.setRate(e),t!=e},shaka.media.IPlayheadObserver=function(){},shaka.media.IPlayheadObserver.prototype.poll=function(e,t){},shaka.media.PlayheadObserverManager=function(e){var t=this;this.mediaElement_=e,this.eventManager_=new shaka.util.EventManager,this.observers_=new Set,this.pollingLoop_=new shaka.util.Timer((function(){t.pollAllObservers_(!1)})).tickNow(),e.paused||this.pollingLoop_.tickEvery(.25),this.eventManager_.listen(e,"playing",(function(){t.pollingLoop_.tickNow().tickEvery(.25)})),this.eventManager_.listen(e,"pause",(function(){t.pollingLoop_.stop()}))},shaka.media.PlayheadObserverManager.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.pollingLoop_.stop();for(var e=$jscomp.makeIterator(this.observers_),t=e.next();!t.done;t=e.next())t.value.release();this.observers_.clear()},shaka.media.PlayheadObserverManager.prototype.manage=function(e){this.observers_.add(e)},shaka.media.PlayheadObserverManager.prototype.notifyOfSeek=function(){this.pollAllObservers_(!0)},shaka.media.PlayheadObserverManager.prototype.pollAllObservers_=function(e){for(var t=this.mediaElement_.currentTime,r=$jscomp.makeIterator(this.observers_),n=r.next();!n.done;n=r.next())n.value.poll(t,e)},shaka.media.QualityObserver=function(e){shaka.util.FakeEventTarget.call(this),this.contentTypeStates_=new Map,this.getBufferedInfo_=e},$jscomp.inherits(shaka.media.QualityObserver,shaka.util.FakeEventTarget),shaka.media.QualityObserver.prototype.release=function(){this.contentTypeStates_.clear(),shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.media.QualityObserver.prototype.getContentTypeState_=function(e){var t=this.contentTypeStates_.get(e);return t||(t={qualityChangePositions:[],currentQuality:null,contentType:e},this.contentTypeStates_.set(e,t)),t},shaka.media.QualityObserver.prototype.addMediaQualityChange=function(e,t){var r=this.getContentTypeState_(e.contentType);this.purgeQualityChangePositions_(r),e={mediaQuality:e,position:t};var n=(r=r.qualityChangePositions).findIndex((function(e){return e.position>=t}));0<=n?r.splice(n,r[n].position==t?1:0,e):r.push(e)},shaka.media.QualityObserver.getMediaQualityAtPosition_=function(e,t){for(var r=(t=t.qualityChangePositions).length-1;0<=r;r--){var n=t[r];if(n.position<=e)return n.mediaQuality}return null},shaka.media.QualityObserver.mediaQualitiesAreTheSame_=function(e,t){return e===t||!(!e||!t)&&(e.bandwidth==t.bandwidth&&e.audioSamplingRate==t.audioSamplingRate&&e.codecs==t.codecs&&e.contentType==t.contentType&&e.frameRate==t.frameRate&&e.height==t.height&&e.mimeType==t.mimeType&&e.channelsCount==t.channelsCount&&e.pixelAspectRatio==t.pixelAspectRatio&&e.width==t.width)},shaka.media.QualityObserver.prototype.poll=function(e,t){for(var r=(t=$jscomp.makeIterator(this.contentTypeStates_.values())).next();!r.done;r=t.next()){var n=(r=r.value).currentQuality,a=shaka.media.QualityObserver.getMediaQualityAtPosition_(e,r),i=a&&!shaka.media.QualityObserver.mediaQualitiesAreTheSame_(n,a),s=a&&n&&a.label&&n.label&&n.label!==a.label,o=a&&n&&a.language&&n.language&&n.language!==a.language;n=a&&n&&a.roles&&n.roles&&!shaka.util.ArrayUtils.equal(n.roles,a.roles),(s||o||n)&&this.positionIsBuffered_(e,a.contentType)&&(r.currentQuality=a,s=new shaka.util.FakeEvent("audiotrackchange",new Map([["quality",a],["position",e]])),this.dispatchEvent(s)),i&&this.positionIsBuffered_(e,a.contentType)&&(r.currentQuality=a,shaka.log.debug("Media quality changed at position "+e+" "+JSON.stringify(a)),r=new shaka.util.FakeEvent("qualitychange",new Map([["quality",a],["position",e]])),this.dispatchEvent(r))}},shaka.media.QualityObserver.prototype.positionIsBuffered_=function(e,t){if((t=this.getBufferedInfo_()[t])&&0<t.length){var r=t[t.length-1].end;if(e>=t[0].start&&e<r)return!0}return!1},shaka.media.QualityObserver.prototype.purgeQualityChangePositions_=function(e){var t=this.getBufferedInfo_()[e.contentType];if(t&&0<t.length){var r=t[0].start,n=t[t.length-1].end,a=e.qualityChangePositions;e.qualityChangePositions=a.filter((function(e,t){return!(e.position<=r&&t+1<a.length&&a[t+1].position<=r||e.position>=n)}))}else e.qualityChangePositions=[]},shaka.media.QualityObserver.createQualityInfo=function(e){var t={bandwidth:e.bandwidth||0,audioSamplingRate:null,codecs:e.codecs,contentType:e.type,frameRate:null,height:null,mimeType:e.mimeType,channelsCount:null,pixelAspectRatio:null,width:null,label:null,roles:e.roles,language:null};return e.type==shaka.util.ManifestParserUtils.ContentType.VIDEO&&(t.frameRate=e.frameRate||null,t.height=e.height||null,t.pixelAspectRatio=e.pixelAspectRatio||null,t.width=e.width||null),e.type==shaka.util.ManifestParserUtils.ContentType.AUDIO&&(t.audioSamplingRate=e.audioSamplingRate,t.channelsCount=e.channelsCount,t.label=e.label||null,t.language=e.language),t},shaka.media.RegionTimeline=function(e){shaka.util.FakeEventTarget.call(this),this.regions_=new Map,this.getSeekRange_=e,this.filterTimer_=null},$jscomp.inherits(shaka.media.RegionTimeline,shaka.util.FakeEventTarget),shaka.media.RegionTimeline.prototype.release=function(){this.regions_.clear(),this.releaseTimer_(),shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.media.RegionTimeline.prototype.addRegion=function(e){var t=this.generateKey_(e);this.regions_.has(t)||(this.regions_.set(t,e),e=new shaka.util.FakeEvent("regionadd",new Map([["region",e]])),this.dispatchEvent(e),this.setupTimer_())},shaka.media.RegionTimeline.prototype.filterBySeekRange_=function(){for(var e=this.getSeekRange_(),t=$jscomp.makeIterator(this.regions_),r=t.next();!r.done;r=t.next()){var n=$jscomp.makeIterator(r.value);r=n.next().value,(n=n.next().value).endTime<e.start&&(this.regions_.delete(r),r=new shaka.util.FakeEvent("regionremove",new Map([["region",n]])),this.dispatchEvent(r))}this.regions_.size||this.releaseTimer_()},shaka.media.RegionTimeline.prototype.setupTimer_=function(){var e=this;this.filterTimer_||(this.filterTimer_=new shaka.util.Timer((function(){e.filterBySeekRange_()})).tickEvery(shaka.media.RegionTimeline.REGION_FILTER_INTERVAL))},shaka.media.RegionTimeline.prototype.releaseTimer_=function(){this.filterTimer_&&(this.filterTimer_.stop(),this.filterTimer_=null)},shaka.media.RegionTimeline.prototype.regions=function(){return this.regions_.values()},shaka.media.RegionTimeline.prototype.generateKey_=function(e){return e.schemeIdUri+"_"+e.id+"_"+e.startTime.toFixed(1)+"_"+e.endTime.toFixed(1)},shaka.media.RegionTimeline.REGION_FILTER_INTERVAL=2,shaka.media.SegmentPrefetch=function(e,t,r,n){this.prefetchLimit_=e,this.stream_=t,this.fetchDispatcher_=r,this.segmentPrefetchMap_=new Map,this.initSegmentPrefetchMap_=new Map,this.iterator_=null,this.reverse_=n},shaka.media.SegmentPrefetch.prototype.replaceFetchDispatcher=function(e){this.fetchDispatcher_=e;for(var t=$jscomp.makeIterator(this.segmentPrefetchMap_.values()),r=t.next();!r.done;r=t.next())r.value.replaceFetchDispatcher(e)},shaka.media.SegmentPrefetch.prototype.prefetchSegmentsByTime=function(e,t){t=void 0!==t&&t,goog.asserts.assert(0<this.prefetchLimit_,"SegmentPrefetch can not be used when prefetchLimit <= 0.");var r=shaka.media.SegmentPrefetch.logPrefix_(this.stream_);if(!this.stream_.segmentIndex)return shaka.log.debug(r,"missing segmentIndex"),Promise.resolve();if(this.iterator_||(this.iterator_=this.stream_.segmentIndex.getIteratorForTime(e,!0,this.reverse_)),!this.iterator_)return shaka.log.debug(r,"missing iterator"),Promise.resolve();for(t&&this.iterator_.next(),e=[];this.segmentPrefetchMap_.size<this.prefetchLimit_&&(t=this.iterator_.next().value);)r=!0,t.isPreload()&&null!=t.endByte&&(r=!1),t.getStatus()==shaka.media.SegmentReference.Status.MISSING&&(r=!1),t.getSegmentData(!1)&&(r=!1),r&&t.initSegmentReference&&e.push(this.prefetchInitSegment(t.initSegmentReference)),r&&!this.segmentPrefetchMap_.has(t)&&(r=new shaka.media.SegmentPrefetchOperation(this.fetchDispatcher_),e.push(r.dispatchFetch(t,this.stream_)),this.segmentPrefetchMap_.set(t,r));return this.clearInitSegments_(),Promise.all(e)},shaka.media.SegmentPrefetch.prototype.prefetchInitSegment=function(e){goog.asserts.assert(0<this.prefetchLimit_,"SegmentPrefetch can not be used when prefetchLimit <= 0.");var t=shaka.media.SegmentPrefetch.logPrefix_(this.stream_);if(!this.stream_.segmentIndex)return shaka.log.debug(t,"missing segmentIndex"),Promise.resolve();if(e.getSegmentData()||Array.from(this.initSegmentPrefetchMap_.keys()).some((function(t){return shaka.media.InitSegmentReference.equal(t,e)})))return Promise.resolve();var r=(t=new shaka.media.SegmentPrefetchOperation(this.fetchDispatcher_)).dispatchFetch(e,this.stream_);return this.initSegmentPrefetchMap_.set(e,t),r},shaka.media.SegmentPrefetch.prototype.getPrefetchedSegment=function(e,t){goog.asserts.assert(0<this.prefetchLimit_,"SegmentPrefetch can not be used when prefetchLimit <= 0.");var r=shaka.media.SegmentPrefetch.logPrefix_(this.stream_),n=this.segmentPrefetchMap_;if(e instanceof shaka.media.InitSegmentReference&&(n=this.initSegmentPrefetchMap_),n.has(e)){var a=n.get(e);return t&&a.setStreamDataCallback(t),e instanceof shaka.media.SegmentReference?shaka.log.debug(r,"reused prefetched segment at time:",e.startTime,"mapSize",n.size):shaka.log.debug(r,"reused prefetched init segment at time, mapSize",n.size),a.getOperation()}return e instanceof shaka.media.SegmentReference?shaka.log.debug(r,"missed segment at time:",e.startTime,"mapSize",n.size):shaka.log.debug(r,"missed init segment at time, mapSize",n.size),null},shaka.media.SegmentPrefetch.prototype.clearMap_=function(e){for(var t=(e=$jscomp.makeIterator(e.keys())).next();!t.done;t=e.next())(t=t.value)&&this.abortPrefetchedSegment_(t)},shaka.media.SegmentPrefetch.prototype.resetPosition=function(){this.iterator_=null},shaka.media.SegmentPrefetch.prototype.clearAll=function(){this.clearMap_(this.segmentPrefetchMap_),this.clearMap_(this.initSegmentPrefetchMap_),this.resetPosition();var e=shaka.media.SegmentPrefetch.logPrefix_(this.stream_);shaka.log.debug(e,"cleared all")},shaka.media.SegmentPrefetch.prototype.removeReference=function(e){this.abortPrefetchedSegment_(e)},shaka.media.SegmentPrefetch.prototype.evict=function(e,t){t=void 0!==t&&t;for(var r=$jscomp.makeIterator(this.segmentPrefetchMap_.keys()),n=r.next();!n.done;n=r.next())e>(n=n.value).endTime&&this.abortPrefetchedSegment_(n);t&&this.clearInitSegments_()},shaka.media.SegmentPrefetch.prototype.setReverse=function(e){this.reverse_=e,this.iterator_&&this.iterator_.setReverse(e)},shaka.media.SegmentPrefetch.prototype.clearInitSegments_=function(){for(var e=Array.from(this.segmentPrefetchMap_.keys()),t=$jscomp.makeIterator(this.initSegmentPrefetchMap_.keys()),r=t.next(),n={};!r.done;n={initSegmentReference$jscomp$3:void 0},r=t.next())n.initSegmentReference$jscomp$3=r.value,e.some(function(e){return function(t){return shaka.media.InitSegmentReference.equal(t.initSegmentReference,e.initSegmentReference$jscomp$3)}}(n))||this.abortPrefetchedSegment_(n.initSegmentReference$jscomp$3)},shaka.media.SegmentPrefetch.prototype.resetLimit=function(e){goog.asserts.assert(0<=e,"The new prefetch limit must be >= 0.");var t=shaka.media.SegmentPrefetch.logPrefix_(this.stream_);for(shaka.log.debug(t,"resetting prefetch limit to",e),this.prefetchLimit_=e,t=Array.from(this.segmentPrefetchMap_.keys());t.length>e;){var r=t.pop();r&&this.abortPrefetchedSegment_(r)}this.clearInitSegments_()},shaka.media.SegmentPrefetch.prototype.switchStream=function(e){e&&e!==this.stream_&&(this.clearAll(),this.stream_=e)},shaka.media.SegmentPrefetch.prototype.getStream=function(){return this.stream_},shaka.media.SegmentPrefetch.prototype.abortPrefetchedSegment_=function(e){var t=shaka.media.SegmentPrefetch.logPrefix_(this.stream_),r=this.segmentPrefetchMap_;e instanceof shaka.media.InitSegmentReference&&(r=this.initSegmentPrefetchMap_);var n=r.get(e);r.delete(e),n&&(n.abort(),e instanceof shaka.media.SegmentReference?shaka.log.debug(t,"pop and abort prefetched segment at time:",e.startTime):shaka.log.debug(t,"pop and abort prefetched init segment"))},shaka.media.SegmentPrefetch.logPrefix_=function(e){return"SegmentPrefetch("+e.type+":"+e.id+")"},shaka.media.SegmentPrefetchOperation=function(e){this.fetchDispatcher_=e,this.operation_=this.streamDataCallback_=null},shaka.media.SegmentPrefetchOperation.prototype.replaceFetchDispatcher=function(e){this.fetchDispatcher_=e},shaka.media.SegmentPrefetchOperation.prototype.dispatchFetch=function(e,t){var r=this,n=new Uint8Array(0);return this.operation_=this.fetchDispatcher_(e,t,(function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return n=0<n.byteLength?shaka.util.Uint8ArrayUtils.concat(n,e):e,r.streamDataCallback_?t.yield(r.streamDataCallback_(n),3):t.jumpTo(0);n=new Uint8Array(0),t.jumpToEnd()}))})),this.operation_.promise.catch((function(e){return e instanceof shaka.util.Error&&e.code==shaka.util.Error.Code.OPERATION_ABORTED?Promise.resolve():Promise.reject(e)}))},shaka.media.SegmentPrefetchOperation.prototype.getOperation=function(){return this.operation_},shaka.media.SegmentPrefetchOperation.prototype.setStreamDataCallback=function(e){this.streamDataCallback_=e},shaka.media.SegmentPrefetchOperation.prototype.abort=function(){this.operation_&&this.operation_.abort()},shaka.media.SegmentUtils=function(){},shaka.media.SegmentUtils.getBasicInfoFromMimeType=function(e){var t=shaka.util.MimeUtils.getBasicType(e);return{type:t.split("/")[0],mimeType:t,codecs:e=shaka.util.MimeUtils.getCodecs(e),language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,videoRange:null,colorGamut:null,frameRate:null}},shaka.media.SegmentUtils.getBasicInfoFromTs=function(e,t,r,n){var a=shaka.util.BufferUtils.toUint8(e),i=(new shaka.util.TsParser).parse(a),s=i.getCodecs();a=i.getVideoInfo();var o=[],l=!1,u=!1;if(!t)switch(s.audio){case"aac":case"aac-loas":i.getAudioData().length&&(o.push("mp4a.40.2"),l=!0);break;case"mp3":i.getAudioData().length&&(o.push("mp4a.40.34"),l=!0);break;case"ac3":i.getAudioData().length&&(o.push("ac-3"),l=!0);break;case"ec3":i.getAudioData().length&&(o.push("ec-3"),l=!0);break;case"opus":i.getAudioData().length&&(o.push("opus"),l=!0)}if(!r)switch(s.video){case"avc":a.codec?o.push(a.codec):o.push("avc1.42E01E"),u=!0;break;case"hvc":a.codec?o.push(a.codec):o.push("hvc1.1.6.L93.90"),u=!0;break;case"av1":o.push("av01.0.01M.08"),u=!0}if(!o.length)return null;if(t=l&&!u,r=new Map,u&&!n){for((n=new shaka.media.ClosedCaptionParser("video/mp2t")).parseFrom(e),u=(e=$jscomp.makeIterator(n.getStreams())).next();!u.done;u=e.next())u=u.value,r.set(u,u);n.reset()}return{type:t?"audio":"video",mimeType:"video/mp2t",codecs:o.join(", "),language:null,height:a.height,width:a.width,channelCount:null,sampleRate:null,closedCaptions:r,videoRange:null,colorGamut:null,frameRate:a.frameRate}},shaka.media.SegmentUtils.getBasicInfoFromMp4=function(e,t,r){var n,a=shaka.util.Mp4Parser,i=shaka.media.SegmentUtils,s=[],o=[],l=!1,u=!1,c=function(e){switch(e=e.toLowerCase()){case"avc1":case"avc3":o.push(e+".42E01E"),u=!0;break;case"hev1":case"hvc1":o.push(e+".1.6.L93.90"),u=!0;break;case"dvh1":case"dvhe":o.push(e+".05.04"),u=!0;break;case"vp09":o.push(e+".00.10.08"),u=!0;break;case"av01":o.push(e+".0.01M.08"),u=!0;break;case"mp4a":s.push("mp4a.40.2"),l=!0;break;case"ac-3":case"ec-3":case"ac-4":case"opus":case"flac":s.push(e),l=!0}},d=null,p=null,h=null,f=null,m=null,g=null,y=null,v=function(e){var t=shaka.util.Mp4BoxParsers.audioSampleEntry(e.reader);f=t.channelCount,m=t.sampleRate,c(e.name)},_=function(e){n=e.name;var t=shaka.util.Mp4BoxParsers.visualSampleEntry(e.reader);h=String(t.width),p=String(t.height),e.reader.hasMoreData()&&a.children(e)};if((new a).box("moov",a.children).box("trak",a.children).box("mdia",a.children).fullBox("mdhd",(function(e){goog.asserts.assert(null!=e.version,"MDHD is a full box and should have a valid version."),d=shaka.util.Mp4BoxParsers.parseMDHD(e.reader,e.version).language})).box("minf",a.children).box("stbl",a.children).fullBox("stsd",a.sampleDescription).box("mp4a",(function(e){var t=shaka.util.Mp4BoxParsers.audioSampleEntry(e.reader);f=t.channelCount,m=t.sampleRate,e.reader.hasMoreData()?a.children(e):c(e.name)})).box("esds",(function(e){e=shaka.util.Mp4BoxParsers.parseESDS(e.reader),s.push(e.codec),l=!0})).box("ac-3",v).box("ec-3",v).box("ac-4",v).box("Opus",v).box("fLaC",v).box("avc1",_).box("avc3",_).box("hev1",_).box("hvc1",_).box("dva1",_).box("dvav",_).box("dvh1",_).box("dvhe",_).box("vp09",_).box("av01",_).box("avcC",(function(e){var t=n||"";switch(n){case"dvav":t="avc3";break;case"dva1":t="avc1"}e=shaka.util.Mp4BoxParsers.parseAVCC(t,e.reader,e.name),o.push(e.codec),u=!0})).box("hvcC",(function(e){var t=n||"";switch(n){case"dvh1":t="hvc1";break;case"dvhe":t="hev1"}e=shaka.util.Mp4BoxParsers.parseHVCC(t,e.reader,e.name),o.push(e.codec),u=!0})).box("dvcC",(function(e){var t=n||"";switch(n){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}e=shaka.util.Mp4BoxParsers.parseDVCC(t,e.reader,e.name),o.push(e.codec),u=!0})).box("dvvC",(function(e){var t=n||"";switch(n){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav";break;case"av01":t="dav1"}e=shaka.util.Mp4BoxParsers.parseDVVC(t,e.reader,e.name),o.push(e.codec),u=!0})).fullBox("vpcC",(function(e){e=shaka.util.Mp4BoxParsers.parseVPCC(n||"",e.reader,e.name),o.push(e.codec),u=!0})).box("av1C",(function(e){var t=n||"";if("dav1"===n)t="av01";e=shaka.util.Mp4BoxParsers.parseAV1C(t,e.reader,e.name),o.push(e.codec),u=!0})).box("enca",a.audioSampleEntry).box("encv",a.visualSampleEntry).box("sinf",a.children).box("frma",(function(e){e=shaka.util.Mp4BoxParsers.parseFRMA(e.reader).codec,c(e)})).box("colr",(function(e){o=o.map((function(t){return t.startsWith("av01.")?shaka.util.Mp4BoxParsers.updateAV1CodecWithCOLRBox(t,e.reader):t}));var t=shaka.util.Mp4BoxParsers.parseCOLR(e.reader),r=t.colorGamut;g=t.videoRange,y=r})).parse(e||t,!0),!s.length&&!o.length)return null;if(v=l&&!u,_=new Map,u&&!r){r=new shaka.media.ClosedCaptionParser("video/mp4"),e&&r.init(e);try{r.parseFrom(t);for(var k=$jscomp.makeIterator(r.getStreams()),E=k.next();!E.done;E=k.next()){var b=E.value;_.set(b,b)}}catch(e){shaka.log.debug("Error detecting CC streams",e)}r.reset()}return e=s.concat(o),{type:v?"audio":"video",mimeType:v?"audio/mp4":"video/mp4",codecs:i.codecsFiltering(e).join(", "),language:d,height:p,width:h,channelCount:f,sampleRate:m,closedCaptions:_,videoRange:g,colorGamut:y,frameRate:null}},shaka.media.SegmentUtils.codecsFiltering=function(e){var t=shaka.util.ManifestParserUtils.ContentType,r=shaka.util.ManifestParserUtils,n=shaka.media.SegmentUtils;e=n.filterDuplicateCodecs_(e);var a=r.guessAllCodecsSafe(t.AUDIO,e),i=r.guessAllCodecsSafe(t.VIDEO,e);return t=r.guessAllCodecsSafe(t.TEXT,e),n=n.chooseBetterCodecs_(i),n=a.concat(n).concat(t),e.length&&!n.length?e:n},shaka.media.SegmentUtils.filterDuplicateCodecs_=function(e){for(var t=new Set,r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;var a=shaka.util.MimeUtils.getCodecBase(n);t.has(a)?shaka.log.debug("Ignoring duplicate codec"):(r.push(n),t.add(a))}return r},shaka.media.SegmentUtils.chooseBetterCodecs_=function(e){if(1>=e.length)return e;var t=e.find((function(e){return e.startsWith("dvav.")||e.startsWith("dva1.")||e.startsWith("dvh1.")||e.startsWith("dvhe.")||e.startsWith("dav1.")||e.startsWith("dvc1.")||e.startsWith("dvi1.")}));return t?shaka.media.Capabilities.isTypeSupported('video/mp4; codecs="'+t+'"')?[t]:e.filter((function(e){return e!=t})):e},shaka.media.SegmentUtils.getDefaultKID=function(e){var t=shaka.util.Mp4Parser,r=null;return(new t).box("moov",t.children).box("trak",t.children).box("mdia",t.children).box("minf",t.children).box("stbl",t.children).fullBox("stsd",t.sampleDescription).box("encv",t.visualSampleEntry).box("enca",t.audioSampleEntry).box("sinf",t.children).box("schi",t.children).fullBox("tenc",(function(e){r=shaka.util.Mp4BoxParsers.parseTENC(e.reader).defaultKID})).parse(e,!0),r},shaka.media.SegmentUtils.aesDecrypt=function(e,t,r){var n,a,i,s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress)return(n=t).cryptoKey?l.jumpTo(2):(goog.asserts.assert(n.fetchKey,"If AES cryptoKey was not preloaded, fetchKey function should be provided"),l.yield(n.fetchKey(),3));if(2!=l.nextAddress&&goog.asserts.assert(n.cryptoKey,"AES cryptoKey should now be set"),!(a=n.iv))for(a=shaka.util.BufferUtils.toUint8(new ArrayBuffer(16)),i=n.firstMediaSequenceNumber+r,s=a.byteLength-1;0<=s;s--)a[s]=255&i,i>>=8;return o="CBC"==t.blockCipherMode?{name:"AES-CBC",iv:a}:{name:"AES-CTR",counter:a,length:64},l.return(window.crypto.subtle.decrypt(o,n.cryptoKey,e))}))},shaka.util.Networking=function(){},shaka.util.Networking.createSegmentRequest=function(e,t,r,n,a){return e=shaka.net.NetworkingEngine.makeRequest(e,n,a),0==t&&null==r||(e.headers.Range=r?"bytes="+t+"-"+r:"bytes="+t+"-"),e},shaka.media.StreamingEngine=function(e,t){var r=this;this.playerInterface_=t,this.manifest_=e,this.config_=null,this.deferredCloseSegmentIndex_=new Map,this.bufferingScale_=1,this.currentTextStream_=this.currentVariant_=null,this.textStreamSequenceId_=0,this.mediaStates_=new Map,this.startupComplete_=!1,this.failureCallbackBackoff_=null,this.fatalError_=!1,this.destroyer_=new shaka.util.Destroyer((function(){return r.doDestroy_()})),this.lastMediaSourceReset_=Date.now()/1e3,this.audioPrefetchMap_=new Map,this.spatialVideoInfo_={projection:null,hfov:null},this.playRangeStart_=0,this.playRangeEnd_=1/0,this.lastTextMediaStateBeforeUnload_=null,this.updateLiveSeekableRangeTime_=new shaka.util.Timer((function(){if(r.manifest_&&r.playerInterface_)if(r.manifest_.presentationTimeline.isLive()){var e=r.manifest_.presentationTimeline.getSeekRangeStart(),t=r.manifest_.presentationTimeline.getSeekRangeEnd();1<t-e?r.playerInterface_.mediaSourceEngine.setLiveSeekableRange(e,t):r.playerInterface_.mediaSourceEngine.clearLiveSeekableRange()}else r.playerInterface_.mediaSourceEngine.clearLiveSeekableRange(),r.updateLiveSeekableRangeTime_&&r.updateLiveSeekableRangeTime_.stop()})),this.boundaryTime_=null,this.crossBoundaryTimer_=new shaka.util.Timer((function(){var e=r.playerInterface_.video;!e.ended&&r.boundaryTime_&&(shaka.log.info("Crossing boundary at",r.boundaryTime_),e.currentTime=r.boundaryTime_,r.boundaryTime_=null)}))},shaka.media.StreamingEngine.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.media.StreamingEngine.prototype.doDestroy_=function(){var e,t,r,n,a,i,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){if(1==o.nextAddress){for(e=[],t=$jscomp.makeIterator(s.mediaStates_.values()),r=t.next();!r.done;r=t.next())n=r.value,s.cancelUpdate_(n),e.push(s.abortOperations_(n)),n.segmentPrefetch&&(n.segmentPrefetch.clearAll(),n.segmentPrefetch=null);for(a=$jscomp.makeIterator(s.audioPrefetchMap_.values()),i=a.next();!i.done;i=a.next())i.value.clearAll();return o.yield(Promise.all(e),2)}s.mediaStates_.clear(),s.audioPrefetchMap_.clear(),s.playerInterface_=null,s.manifest_=null,s.config_=null,s.updateLiveSeekableRangeTime_&&s.updateLiveSeekableRangeTime_.stop(),s.updateLiveSeekableRangeTime_=null,s.crossBoundaryTimer_&&s.crossBoundaryTimer_.stop(),s.crossBoundaryTimer_=null,s.boundaryTime_=null,o.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.configure=function(e){this.config_=e,this.failureCallbackBackoff_=new shaka.net.Backoff({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0);var t=shaka.util.ManifestParserUtils.ContentType;if(e.disableAudioPrefetch){var r=this.mediaStates_.get(t.AUDIO);r&&r.segmentPrefetch&&(r.segmentPrefetch.clearAll(),r.segmentPrefetch=null);for(var n=(r=$jscomp.makeIterator(this.audioPrefetchMap_.keys())).next();!n.done;n=r.next())n=n.value,this.audioPrefetchMap_.get(n).clearAll(),this.audioPrefetchMap_.delete(n)}for(e.disableTextPrefetch&&(r=this.mediaStates_.get(t.TEXT))&&r.segmentPrefetch&&(r.segmentPrefetch.clearAll(),r.segmentPrefetch=null),e.disableVideoPrefetch&&(t=this.mediaStates_.get(t.VIDEO))&&t.segmentPrefetch&&(t.segmentPrefetch.clearAll(),t.segmentPrefetch=null),r=(t=$jscomp.makeIterator(this.mediaStates_.keys())).next();!r.done;r=t.next())(r=this.mediaStates_.get(r.value)).segmentPrefetch?(r.segmentPrefetch.resetLimit(e.segmentPrefetchLimit),0<e.segmentPrefetchLimit||(r.segmentPrefetch.clearAll(),r.segmentPrefetch=null)):0<e.segmentPrefetchLimit&&(r.segmentPrefetch=this.createSegmentPrefetch_(r.stream));e.disableAudioPrefetch||this.updatePrefetchMapForAudio_()},shaka.media.StreamingEngine.prototype.applyPlayRange=function(e,t){this.manifest_.presentationTimeline.isLive()||(this.playRangeStart_=e,this.playRangeEnd_=t)},shaka.media.StreamingEngine.prototype.start=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return goog.asserts.assert(t.config_,"StreamingEngine configure() must be called before init()!"),r.yield(t.initStreams_(e||new Map),2);t.destroyer_.ensureNotDestroyed(),shaka.log.debug("init: completed initial Stream setup"),t.startupComplete_=!0,r.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.getCurrentVariant=function(){return this.currentVariant_},shaka.media.StreamingEngine.prototype.getCurrentTextStream=function(){return this.currentTextStream_},shaka.media.StreamingEngine.prototype.loadNewTextStream_=function(e){var t,r,n,a,i,s,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:return t=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(!o.mediaStates_.has(t.TEXT),"Should not call loadNewTextStream_ while streaming text!"),o.textStreamSequenceId_++,r=o.textStreamSequenceId_,l.setCatchFinallyBlocks(2),l.yield(o.playerInterface_.mediaSourceEngine.clear(t.TEXT),4);case 4:l.leaveTryBlock(3);break;case 2:n=l.enterCatchBlock(),o.playerInterface_&&o.playerInterface_.onError(n);case 3:a=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs),o.playerInterface_.mediaSourceEngine.reinitText(a,o.manifest_.sequenceMode,e.external),i=o.playerInterface_.mediaSourceEngine.getTextDisplayer(),(i.isTextVisible()||o.config_.alwaysStreamText)&&o.textStreamSequenceId_==r&&(s=o.createMediaState_(e),o.mediaStates_.set(t.TEXT,s),o.scheduleUpdate_(s,0)),l.jumpToEnd()}}))},shaka.media.StreamingEngine.prototype.unloadTextStream=function(){var e=shaka.util.ManifestParserUtils.ContentType,t=this.mediaStates_.get(e.TEXT);t&&(this.cancelUpdate_(t),this.abortOperations_(t).catch((function(){})),this.lastTextMediaStateBeforeUnload_=this.mediaStates_.get(e.TEXT),this.mediaStates_.delete(e.TEXT)),this.currentTextStream_=null},shaka.media.StreamingEngine.prototype.setTrickPlay=function(e){var t=shaka.util.ManifestParserUtils.ContentType;if(this.updateSegmentIteratorReverse_(),t=this.mediaStates_.get(t.VIDEO)){var r=t.stream;r&&(shaka.log.debug("setTrickPlay",e),e?(e=r.trickModeVideo)&&!t.restoreStreamAfterTrickPlay&&(shaka.log.debug("Engaging trick mode stream",e),this.switchInternal_(e,!1,0,!1),t.restoreStreamAfterTrickPlay=r):(e=t.restoreStreamAfterTrickPlay)&&(shaka.log.debug("Restoring non-trick-mode stream",e),t.restoreStreamAfterTrickPlay=null,this.switchInternal_(e,!0,0,!1)))}},shaka.media.StreamingEngine.prototype.switchVariant=function(e,t,r,n,a){t=void 0!==t&&t,r=void 0===r?0:r,n=void 0!==n&&n,a=void 0!==a&&a,this.currentVariant_=e,this.startupComplete_&&(e.video&&this.switchInternal_(e.video,t,r,n,a),e.audio&&this.switchInternal_(e.audio,t,r,n,a))},shaka.media.StreamingEngine.prototype.switchTextStream=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return r.lastTextMediaStateBeforeUnload_=null,r.currentTextStream_=e,r.startupComplete_?(t=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(e&&e.type==t.TEXT,"Wrong stream type passed to switchTextStream!"),e.segmentIndex?n.jumpTo(2):n.yield(e.createSegmentIndex(),2)):n.return();r.switchInternal_(e,!0,0,!1),n.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.reloadTextStream=function(){var e=this.mediaStates_.get(shaka.util.ManifestParserUtils.ContentType.TEXT);e&&this.switchInternal_(e.stream,!0,0,!0)},shaka.media.StreamingEngine.prototype.handleDeferredCloseSegmentIndexes_=function(e){for(var t=$jscomp.makeIterator(this.deferredCloseSegmentIndex_.entries()),r=t.next();!r.done;r=t.next()){var n=$jscomp.makeIterator(r.value);r=n.next().value,n=n.next().value,r.includes(e.type)&&(n(),this.deferredCloseSegmentIndex_.delete(r))}},shaka.media.StreamingEngine.prototype.switchInternal_=function(e,t,r,n,a){var i=this,s=shaka.util.ManifestParserUtils.ContentType,o=this.mediaStates_.get(e.type);o||e.type!=s.TEXT?(goog.asserts.assert(o,"switch: expected mediaState to exist"),o&&(o.restoreStreamAfterTrickPlay&&(shaka.log.debug("switch during trick play mode",e),e.trickModeVideo?(o.restoreStreamAfterTrickPlay=e,e=e.trickModeVideo,shaka.log.debug("switch found trick play stream",e)):(o.restoreStreamAfterTrickPlay=null,shaka.log.debug("switch found no special trick play stream"))),o.stream!=e||n?(this.audioPrefetchMap_.has(e)?o.segmentPrefetch=this.audioPrefetchMap_.get(e):o.segmentPrefetch&&o.segmentPrefetch.switchStream(e),e.type==s.TEXT&&(n=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs),this.playerInterface_.mediaSourceEngine.reinitText(n,this.manifest_.sequenceMode,e.external)),!this.audioPrefetchMap_.has(o.stream)&&o.stream.closeSegmentIndex&&(o.performingUpdate?(n=shaka.media.StreamingEngine.logPrefix_(o),this.deferredCloseSegmentIndex_.has(n)||this.deferredCloseSegmentIndex_.set(n,o.stream.closeSegmentIndex)):o.stream.closeSegmentIndex()),n=o.stream.isAudioMuxedInVideo!=e.isAudioMuxedInVideo,o.stream=e,o.segmentIterator=null,o.adaptation=!!a,o.dependencyMediaState=e.dependencyStream?this.createMediaState_(e.dependencyStream):null,e=shaka.media.StreamingEngine.logPrefix_(o),shaka.log.debug("switch: switching to Stream "+e),n?this.resetMediaSource(!0,!1):(t?o.clearingBuffer?o.waitingToFlushBuffer=!0:o.performingUpdate?(o.waitingToClearBuffer=!0,o.clearBufferSafeMargin=r,o.waitingToFlushBuffer=!0):(this.cancelUpdate_(o),this.clearBuffer_(o,!0,r).catch((function(e){i.playerInterface_&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),i.playerInterface_.onError(e))}))):o.performingUpdate||o.updateTimer||this.scheduleUpdate_(o,0),this.makeAbortDecision_(o).catch((function(e){i.playerInterface_&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),i.playerInterface_.onError(e))})))):(t=shaka.media.StreamingEngine.logPrefix_(o),shaka.log.debug("switch: Stream "+t+" already active")))):this.loadNewTextStream_(e)},shaka.media.StreamingEngine.prototype.makeAbortDecision_=function(e){var t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?e.operation?(t=e.stream,r=e.operation,t.segmentIndex?a.jumpTo(2):a.yield(t.createSegmentIndex(),2)):a.return():e.operation!=r||e.stream!=t?a.return():(goog.asserts.assert(e.stream.segmentIndex,"Segment index should exist by now!"),n.shouldAbortCurrentRequest_(e)&&(shaka.log.info("Aborting current segment request."),e.operation.abort()),void a.jumpToEnd())}))},shaka.media.StreamingEngine.prototype.shouldAbortCurrentRequest_=function(e){goog.asserts.assert(e.operation,"Abort logic requires an ongoing operation!"),goog.asserts.assert(e.stream&&e.stream.segmentIndex,"Abort logic requires a segment index");var t=this.playerInterface_.getPresentationTime(),r=this.playerInterface_.mediaSourceEngine.bufferEnd(e.type),n=this.getTimeNeeded_(e,t),a=null==(n=e.stream.segmentIndex.find(n))?null:e.stream.segmentIndex.get(n);return n=a?a.getSize():null,a&&!n&&(n=(a.getEndTime()-a.getStartTime())*(e.stream.bandwidth||0)/8),!!n&&((a=a.initSegmentReference)&&(n+=a.getSize()||0),8*n/(a=this.playerInterface_.getBandwidthEstimate())<(r||0)-t-this.config_.rebufferingGoal||e.operation.getBytesRemaining()>n)},shaka.media.StreamingEngine.prototype.seeked=function(){if(this.playerInterface_){for(var e=this.playerInterface_.getPresentationTime(),t=shaka.util.ManifestParserUtils.ContentType,r=!1,n=$jscomp.makeIterator(this.mediaStates_.keys()),a=n.next();!a.done;a=n.next()){a=a.value;var i=this.mediaStates_.get(a),s=shaka.media.StreamingEngine.logPrefix_(i);if(!this.playerInterface_.mediaSourceEngine.isBuffered(a,e)){if(this.lastMediaSourceReset_=0,i.segmentPrefetch&&i.segmentPrefetch.resetPosition(),i.type===t.AUDIO)for(var o=$jscomp.makeIterator(this.audioPrefetchMap_.values()),l=o.next();!l.done;l=o.next())l.value.resetPosition();i.segmentIterator=null,(null!=this.playerInterface_.mediaSourceEngine.bufferEnd(a)||i.performingUpdate)&&(this.forceClearBuffer_(i),r=!0),i.operation&&(i.operation.abort(),shaka.log.debug(s,"Aborting operation due to seek"),i.operation=null),a===t.TEXT&&this.playerInterface_.mediaSourceEngine.resetCaptionParser(),i.seeked=!0}}this.config_.crossBoundaryStrategy!==shaka.config.CrossBoundaryStrategy.KEEP&&this.forwardTimeForCrossBoundary(),r||shaka.log.debug("(all): seeked: buffered seek: presentationTime="+e)}},shaka.media.StreamingEngine.prototype.forceClearBuffer_=function(e){var t=this,r=shaka.media.StreamingEngine.logPrefix_(e);e.clearingBuffer?shaka.log.debug(r,"clear: already clearing the buffer"):e.waitingToClearBuffer?shaka.log.debug(r,"clear: already waiting"):e.performingUpdate?(shaka.log.debug(r,"clear: currently updating"),e.waitingToClearBuffer=!0,e.clearBufferSafeMargin=0):null==this.playerInterface_.mediaSourceEngine.bufferStart(e.type)?(shaka.log.debug(r,"clear: nothing buffered"),null==e.updateTimer&&this.scheduleUpdate_(e,0)):(shaka.log.debug(r,"clear: handling right now"),this.cancelUpdate_(e),this.clearBuffer_(e,!1,0).catch((function(e){t.playerInterface_&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),t.playerInterface_.onError(e))})))},shaka.media.StreamingEngine.prototype.initStreams_=function(e){var t,r,n,a,i,s,o,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress){if(t=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(d.config_,"StreamingEngine configure() must be called before init()!"),!d.currentVariant_)throw shaka.log.error("init: no Streams chosen"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STREAMING,shaka.util.Error.Code.STREAMING_ENGINE_STARTUP_INVALID_STATE);return r=new Map,n=new Set,d.currentVariant_.audio&&(r.set(t.AUDIO,d.currentVariant_.audio),n.add(d.currentVariant_.audio)),d.currentVariant_.video&&(r.set(t.VIDEO,d.currentVariant_.video),n.add(d.currentVariant_.video)),d.currentTextStream_&&(r.set(t.TEXT,d.currentTextStream_),n.add(d.currentTextStream_)),a=d.playerInterface_.mediaSourceEngine,p.yield(a.init(r,d.manifest_.sequenceMode,d.manifest_.type,d.manifest_.ignoreManifestTimestampsInSegmentsMode),2)}for(d.destroyer_.ensureNotDestroyed(),d.updateDuration(),i=$jscomp.makeIterator(r.keys()),s=i.next();!s.done;s=i.next())o=s.value,l=r.get(o),d.mediaStates_.has(o)||(u=d.createMediaState_(l),e.has(l.id)&&((c=e.get(l.id)).replaceFetchDispatcher((function(e,t,r){return d.dispatchFetch_(e,t,r)})),u.segmentPrefetch=c),d.mediaStates_.set(o,u),d.scheduleUpdate_(u,0));p.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.createMediaState_=function(e){var t={stream:e,type:e.type,segmentIterator:null,segmentPrefetch:this.createSegmentPrefetch_(e),lastSegmentReference:null,lastInitSegmentReference:null,lastTimestampOffset:null,lastAppendWindowStart:null,lastAppendWindowEnd:null,lastCodecs:null,lastMimeType:null,restoreStreamAfterTrickPlay:null,endOfStream:!1,performingUpdate:!1,updateTimer:null,waitingToClearBuffer:!1,clearBufferSafeMargin:0,waitingToFlushBuffer:!1,clearingBuffer:!1,seeked:!0,adaptation:!1,recovering:!1,hasError:!1,operation:null,dependencyMediaState:null};return e.dependencyStream&&(t.dependencyMediaState=this.createMediaState_(e.dependencyStream)),t},shaka.media.StreamingEngine.prototype.createSegmentPrefetch_=function(e){var t=this,r=shaka.util.ManifestParserUtils.ContentType;if(e.type===r.VIDEO&&this.config_.disableVideoPrefetch||e.type===r.AUDIO&&this.config_.disableAudioPrefetch)return null;var n=shaka.util.MimeUtils,a=n.CEA608_CLOSED_CAPTION_MIMETYPE;return n=n.CEA708_CLOSED_CAPTION_MIMETYPE,e.type===r.TEXT&&(e.mimeType==a||e.mimeType==n)||e.type===r.TEXT&&this.config_.disableTextPrefetch?null:this.audioPrefetchMap_.has(e)?this.audioPrefetchMap_.get(e):(r=(r=this.mediaStates_.get(e.type))&&r.segmentPrefetch)&&e===r.getStream()?r:0<this.config_.segmentPrefetchLimit?(r=0>this.playerInterface_.getPlaybackRate(),new shaka.media.SegmentPrefetch(this.config_.segmentPrefetchLimit,e,(function(e,r,n){return t.dispatchFetch_(e,r,n)}),r)):null},shaka.media.StreamingEngine.prototype.updatePrefetchMapForAudio_=function(){for(var e=this.config_.segmentPrefetchLimit,t=this.config_.prefetchAudioLanguages,r=shaka.util.LanguageUtils,n=$jscomp.makeIterator(this.manifest_.variants),a=n.next(),i={};!a.done;i={variant$jscomp$46:void 0},a=n.next())if(i.variant$jscomp$46=a.value,i.variant$jscomp$46.audio)if(this.audioPrefetchMap_.has(i.variant$jscomp$46.audio)){if((a=this.audioPrefetchMap_.get(i.variant$jscomp$46.audio)).resetLimit(e),!(0<e&&t.some(function(e){return function(t){return r.areLanguageCompatible(e.variant$jscomp$46.audio.language,t)}}(i)))){var s=this.mediaStates_.get(i.variant$jscomp$46.audio.type);a!==(s&&s.segmentPrefetch)&&a.clearAll(),this.audioPrefetchMap_.delete(i.variant$jscomp$46.audio)}}else 0>=e||!t.some(function(e){return function(t){return r.areLanguageCompatible(e.variant$jscomp$46.audio.language,t)}}(i))||!(a=this.createSegmentPrefetch_(i.variant$jscomp$46.audio))||(i.variant$jscomp$46.audio.segmentIndex||i.variant$jscomp$46.audio.createSegmentIndex(),this.audioPrefetchMap_.set(i.variant$jscomp$46.audio,a))},shaka.media.StreamingEngine.prototype.updateDuration=function(){var e=shaka.media.Capabilities.isInfiniteLiveStreamDurationSupported(),t=this.manifest_.presentationTimeline.getDuration();1/0>t?(e&&(this.updateLiveSeekableRangeTime_&&this.updateLiveSeekableRangeTime_.stop(),this.playerInterface_.mediaSourceEngine.clearLiveSeekableRange()),this.playerInterface_.mediaSourceEngine.setDuration(t)):e?(this.updateLiveSeekableRangeTime_&&this.updateLiveSeekableRangeTime_.tickEvery(.5),this.playerInterface_.mediaSourceEngine.setDuration(1/0)):this.playerInterface_.mediaSourceEngine.setDuration(Math.pow(2,32))},shaka.media.StreamingEngine.prototype.onUpdate_=function(e){var t,r,n,a,i,s,o,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){switch(u.nextAddress){case 1:if(l.destroyer_.ensureNotDestroyed(),t=shaka.media.StreamingEngine.logPrefix_(e),goog.asserts.assert(!e.performingUpdate&&null!=e.updateTimer,t+" unexpected call to onUpdate_()"),e.performingUpdate||null==e.updateTimer)return u.return();if(goog.asserts.assert(!e.clearingBuffer,t+" onUpdate_() should not be called when clearing the buffer"),e.clearingBuffer)return u.return();if(e.updateTimer=null,!e.waitingToClearBuffer){u.jumpTo(2);break}return shaka.log.debug(t,"skipping update and clearing the buffer"),u.yield(l.clearBuffer_(e,e.waitingToFlushBuffer,e.clearBufferSafeMargin),3);case 3:return u.return();case 2:if(l.handleDeferredCloseSegmentIndexes_(e),e.stream.segmentIndex){u.jumpTo(4);break}return r=e.stream,u.setCatchFinallyBlocks(5),u.yield(e.stream.createSegmentIndex(),7);case 7:u.leaveTryBlock(6);break;case 5:return n=u.enterCatchBlock(),u.yield(l.handleStreamingError_(e,n),8);case 8:return u.return();case 6:if(r!=e.stream)return r.closeSegmentIndex&&(goog.asserts.assert(!e.stream.segmentIndex,"mediaState.stream should not have segmentIndex yet."),r.closeSegmentIndex()),e.performingUpdate||e.updateTimer||l.scheduleUpdate_(e,0),u.return();case 4:u.setCatchFinallyBlocks(9),null!=(a=l.update_(e))&&(l.scheduleUpdate_(e,a),e.hasError=!1),u.leaveTryBlock(10);break;case 9:return i=u.enterCatchBlock(),u.yield(l.handleStreamingError_(e,i),11);case 11:return u.return();case 10:if(s=Array.from(l.mediaStates_.values()),!l.startupComplete_||!s.every((function(e){return e.endOfStream}))){u.jumpTo(0);break}return shaka.log.v1(t,"calling endOfStream()..."),u.yield(l.playerInterface_.mediaSourceEngine.endOfStream(),13);case 13:l.destroyer_.ensureNotDestroyed(),0!=(o=l.playerInterface_.mediaSourceEngine.getDuration())&&o<l.manifest_.presentationTimeline.getDuration()&&l.manifest_.presentationTimeline.setDuration(o),u.jumpToEnd()}}))},shaka.media.StreamingEngine.prototype.update_=function(e){goog.asserts.assert(this.manifest_,"manifest_ should not be null"),goog.asserts.assert(this.config_,"config_ should not be null");var t=shaka.util.ManifestParserUtils.ContentType;if(shaka.media.StreamingEngine.isEmbeddedText_(e))return this.playerInterface_.mediaSourceEngine.setSelectedClosedCaptionId(e.stream.originalId||""),null;if(e.type==t.TEXT&&this.playerInterface_.mediaSourceEngine.clearSelectedClosedCaptionId(),e.stream.isAudioMuxedInVideo)return null;var r=this.config_.updateIntervalSeconds/Math.max(1,Math.abs(this.playerInterface_.getPlaybackRate()));if(!this.playerInterface_.mediaSourceEngine.isStreamingAllowed()&&e.type!=t.TEXT)return r/2;var n=shaka.media.StreamingEngine.logPrefix_(e),a=this.playerInterface_.getPresentationTime();if(e.type===t.AUDIO)for(var i=$jscomp.makeIterator(this.audioPrefetchMap_.keys()),s=i.next();!s.done;s=i.next())(s=this.audioPrefetchMap_.get(s.value)).evict(a,!0),s.prefetchSegmentsByTime(a);i=this.getTimeNeeded_(e,a),shaka.log.v2(n,"timeNeeded="+i);var o=this.playerInterface_.mediaSourceEngine.bufferedAheadOf(e.type,a);shaka.log.v2(n,"update_:","presentationTime="+a,"bufferedAhead="+o);var l=Math.max(1,Math.max(this.config_.rebufferingGoal,this.config_.bufferingGoal)*this.bufferingScale_),u=this.manifest_.presentationTimeline.getDuration()-i;if(s=this.playerInterface_.mediaSourceEngine.bufferEnd(e.type),1e-6>u&&s)return shaka.log.debug(n,"buffered to end of presentation"),e.endOfStream=!0,e.type==t.VIDEO&&(e=this.mediaStates_.get(t.TEXT))&&shaka.media.StreamingEngine.isEmbeddedText_(e)&&(e.endOfStream=!0),null;if(e.endOfStream=!1,o>=l)return shaka.log.v2(n,"buffering goal met"),r/2;if(o=!e.segmentIterator,!(t=this.getSegmentReferenceNeeded_(e,a,s)))return r;for(s=!1,o&&e.adaptation&&(s=!0,e.adaptation=!1),o=1/0,l=Array.from(this.mediaStates_.values()),u=(l=$jscomp.makeIterator(l)).next();!u.done;u=l.next())u=u.value,shaka.media.StreamingEngine.isEmbeddedText_(u)||u.segmentIterator&&!u.segmentIterator.current()||(u=this.getTimeNeeded_(u,a),o=Math.min(o,u));return i>=o+(l=this.manifest_.presentationTimeline.getMaxSegmentDuration()*shaka.media.StreamingEngine.MAX_RUN_AHEAD_SEGMENTS_)?(shaka.log.v2(n,"waiting for other streams to buffer"),r):(this.config_.crossBoundaryStrategy!==shaka.config.CrossBoundaryStrategy.KEEP&&this.discardReferenceByBoundary_(e,t)||(e.segmentPrefetch&&e.segmentIterator&&!this.audioPrefetchMap_.has(e.stream)&&(e.segmentPrefetch.evict(t.startTime+.001),e.segmentPrefetch.prefetchSegmentsByTime(t.startTime).catch((function(){}))),this.fetchAndAppend_(e,a,t,s).catch((function(){})),e.dependencyMediaState&&this.fetchAndAppendDependency_(e.dependencyMediaState,a)),null)},shaka.media.StreamingEngine.prototype.getTimeNeeded_=function(e,t){return e.lastSegmentReference?e.lastSegmentReference.endTime:t},shaka.media.StreamingEngine.prototype.getSegmentReferenceNeeded_=function(e,t,r){var n=shaka.media.StreamingEngine.logPrefix_(e);if(goog.asserts.assert(e.stream.segmentIndex,"segment index should have been generated already"),e.segmentIterator)return(n=e.segmentIterator.current())&&e.lastSegmentReference&&.001>Math.abs(e.lastSegmentReference.startTime-n.startTime)&&(n=e.segmentIterator.next().value),n;if(e.lastSegmentReference||r)return t=e.lastSegmentReference?e.lastSegmentReference.endTime:r,goog.asserts.assert(null!=t,"Should have a time to search"),shaka.log.v1(n,"looking up segment from new stream endTime:",t),r=0>this.playerInterface_.getPlaybackRate(),e.stream.segmentIndex&&(e.segmentIterator=e.stream.segmentIndex.getIteratorForTime(t,!1,r)),null==(e=e.segmentIterator&&e.segmentIterator.next().value)&&shaka.log.warning(n,"cannot find segment","endTime:",t),e;r=this.manifest_.sequenceMode?0:this.config_.inaccurateManifestTolerance;var a=Math.max(t-r,0);shaka.log.v1(n,"looking up segment","lookupTime:",a,"presentationTime:",t);var i=0>this.playerInterface_.getPlaybackRate(),s=null;return r&&(e.stream.segmentIndex&&(e.segmentIterator=e.stream.segmentIndex.getIteratorForTime(a,!1,i)),s=e.segmentIterator&&e.segmentIterator.next().value),s||(e.stream.segmentIndex&&(e.segmentIterator=e.stream.segmentIndex.getIteratorForTime(t,!1,i)),s=e.segmentIterator&&e.segmentIterator.next().value),null==s&&shaka.log.warning(n,"cannot find segment","lookupTime:",a,"presentationTime:",t),s},shaka.media.StreamingEngine.prototype.fetchAndAppend_=function(e,t,r,n){var a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(P){switch(P.nextAddress){case 1:if(a=shaka.util.ManifestParserUtils.ContentType,i=shaka.media.StreamingEngine,s=i.logPrefix_(e),shaka.log.v1(s,"fetchAndAppend_:","presentationTime="+t,"reference.startTime="+r.startTime,"reference.endTime="+r.endTime),o=e.stream,l=e.segmentIterator,e.performingUpdate=!0,P.setCatchFinallyBlocks(2),r.getStatus()==shaka.media.SegmentReference.Status.MISSING)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.SEGMENT_MISSING);return P.yield(S.initSourceBuffer_(e,r,n),4);case 4:return S.destroyer_.ensureNotDestroyed(),S.fatalError_?P.return():(shaka.log.v2(s,"fetching segment"),u="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,c=window.ReadableStream,(d=S.config_.lowLatencyMode&&S.manifest_.isLowLatency)&&c&&u&&(S.manifest_.type!=shaka.media.ManifestParser.HLS||r.hasByterangeOptimization())?(f=new Uint8Array(0),g=m=!1,v=function(a){var i,s,l;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){switch(u.nextAddress){case 1:if(m)return u.return();if(g=!0,S.destroyer_.ensureNotDestroyed(),S.fatalError_)return u.return();if(u.setCatchFinallyBlocks(2),f=S.concatArray_(f,a),i=!1,s=0,(new shaka.util.Mp4Parser).box("mdat",(function(e){s=e.size+e.start,i=!0})).parse(f,!1,!0),!i){u.jumpTo(4);break}return l=f.subarray(0,s),f=f.subarray(s),u.yield(S.append_(e,t,o,r,l,!0,n),5);case 5:e.segmentPrefetch&&e.segmentIterator&&e.segmentPrefetch.prefetchSegmentsByTime(r.startTime,!0);case 4:u.leaveTryBlock(0);break;case 2:y=u.enterCatchBlock(),u.jumpToEnd()}}))},P.yield(S.fetch_(e,r,v),9)):(d&&!c&&shaka.log.warning("Low latency streaming mode is enabled, but ReadableStream is not supported by the browser."),p=S.fetch_(e,r),P.yield(p,7)));case 7:return h=P.yieldResult,S.destroyer_.ensureNotDestroyed(),S.fatalError_?P.return():(S.destroyer_.ensureNotDestroyed(),e.waitingToClearBuffer?(shaka.log.info(s,"waitingToClearBuffer, skip append"),e.performingUpdate=!1,S.scheduleUpdate_(e,0),P.return()):P.yield(S.append_(e,t,o,r,h,!1,n),6));case 9:if(_=P.yieldResult,y)throw y;if(g){P.jumpTo(10);break}return m=!0,S.destroyer_.ensureNotDestroyed(),S.fatalError_?P.return():e.waitingToClearBuffer?(shaka.log.info(s,"waitingToClearBuffer, skip append"),e.performingUpdate=!1,S.scheduleUpdate_(e,0),P.return()):P.yield(S.append_(e,t,o,r,_,!1,n),10);case 10:e.segmentPrefetch&&e.segmentIterator&&e.segmentPrefetch.prefetchSegmentsByTime(r.startTime,!0);case 6:if(S.destroyer_.ensureNotDestroyed(),S.fatalError_)return P.return();e.lastSegmentReference=r,k=l.next().value,shaka.log.v2(s,"advancing to next segment",k),e.performingUpdate=!1,e.recovering=!1,E=S.playerInterface_.mediaSourceEngine.getBufferedInfo(),b=E[e.type],shaka.log.v1(s,"finished fetch and append",JSON.stringify(b)),e.waitingToClearBuffer||(T=null,e.type===a.VIDEO?T=S.mediaStates_.get(a.AUDIO):e.type===a.AUDIO&&(T=S.mediaStates_.get(a.VIDEO)),T&&T.type==a.AUDIO?S.playerInterface_.onSegmentAppended(r,e.stream,T.stream.isAudioMuxedInVideo):S.playerInterface_.onSegmentAppended(r,e.stream,e.stream.codecs.includes(","))),S.scheduleUpdate_(e,0),P.leaveTryBlock(0);break;case 2:if(A=P.enterCatchBlock(),S.destroyer_.ensureNotDestroyed(A),S.fatalError_)return P.return();if(goog.asserts.assert(A instanceof shaka.util.Error,"Should only receive a Shaka error"),e.performingUpdate=!1,A.code==shaka.util.Error.Code.OPERATION_ABORTED)e.performingUpdate=!1,S.cancelUpdate_(e),S.scheduleUpdate_(e,0),P.jumpTo(0);else{if(e.type!=a.TEXT||!S.config_.ignoreTextStreamFailures)return A.code==shaka.util.Error.Code.QUOTA_EXCEEDED_ERROR?P.yield(S.handleQuotaExceeded_(e,A),0):(shaka.log.error(s,"failed fetch and append: code="+A.code),e.hasError=!0,A.category==shaka.util.Error.Category.NETWORK&&e.segmentPrefetch&&e.segmentPrefetch.removeReference(r),A.severity=shaka.util.Error.Severity.CRITICAL,P.yield(S.handleStreamingError_(e,A),0));A.code==shaka.util.Error.Code.BAD_HTTP_STATUS?shaka.log.warning(s,"Text stream failed to download. Proceeding without it."):shaka.log.warning(s,"Text stream failed to parse. Proceeding without it."),S.mediaStates_.delete(a.TEXT),P.jumpTo(0)}}}))},shaka.media.StreamingEngine.prototype.fetchAndAppendDependency_=function(e,t){var r,n,a,i,s,o,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:if(r=e.stream,!(a=(n=r.segmentIndex.getIteratorForTime(t))&&n.next().value)){d.jumpTo(0);break}if(!(i=a.initSegmentReference)||shaka.media.InitSegmentReference.equal(i,e.lastInitSegmentReference)){d.jumpTo(3);break}return e.lastInitSegmentReference=i,d.setCatchFinallyBlocks(4),d.yield(c.fetch_(e,i),6);case 6:s=d.yieldResult,c.playerInterface_.mediaSourceEngine.appendDependency(s,0,r),d.leaveTryBlock(3);break;case 4:throw o=d.enterCatchBlock(),e.lastInitSegmentReference=null,o;case 3:if(e.lastSegmentReference&&e.lastSegmentReference==a){d.jumpTo(0);break}return e.lastSegmentReference=a,d.setCatchFinallyBlocks(8),d.yield(c.fetch_(e,a),10);case 10:l=d.yieldResult,c.playerInterface_.mediaSourceEngine.appendDependency(l,0,r),d.leaveTryBlock(0);break;case 8:throw u=d.enterCatchBlock(),e.lastSegmentReference=null,u}}))},shaka.media.StreamingEngine.prototype.retry=function(e){if(this.destroyer_.destroyed())return shaka.log.error("Unable to retry after StreamingEngine is destroyed!"),!1;if(this.fatalError_)return shaka.log.error("Unable to retry after StreamingEngine encountered a fatal error!"),!1;for(var t=$jscomp.makeIterator(this.mediaStates_.values()),r=t.next();!r.done;r=t.next()){r=r.value;var n=shaka.media.StreamingEngine.logPrefix_(r);!r.hasError||r.performingUpdate||r.updateTimer||(shaka.log.info(n,"Retrying after failure..."),r.hasError=!1,this.scheduleUpdate_(r,e))}return!0},shaka.media.StreamingEngine.prototype.concatArray_=function(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r},shaka.media.StreamingEngine.prototype.handleQuotaExceeded_=function(e,t){var r,n,a,i,s,o,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress){if(r=shaka.media.StreamingEngine.logPrefix_(e),n=Array.from(l.mediaStates_.values()),n.some((function(t){return t!=e&&t.recovering})))return shaka.log.debug(r,"MediaSource threw QuotaExceededError:","waiting for another stream to recover..."),u.jumpTo(2);if((a=l.getDisabledTime_(t))&&shaka.log.debug(r,"Disabling stream due to quota",t),l.playerInterface_.disableStream(e.stream,a))return u.return();if(l.config_.avoidEvictionOnQuotaExceededError)return l.scheduleUpdate_(e,4),u.return();if(20<(i=Math.round(100*l.bufferingScale_)))l.bufferingScale_-=.2;else{if(!(4<i))return shaka.log.error(r,"MediaSource threw QuotaExceededError too many times"),e.hasError=!0,l.fatalError_=!0,l.playerInterface_.onError(t),u.return();l.bufferingScale_-=.04}return s=Math.round(100*l.bufferingScale_),shaka.log.warning(r,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-s)+"%"),e.recovering=!0,o=l.playerInterface_.getPresentationTime(),u.yield(l.evict_(e,o),2)}l.scheduleUpdate_(e,4),u.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.initSourceBuffer_=function(e,t,r){var n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(b){switch(b.nextAddress){case 1:if(n=shaka.util.ManifestParserUtils.ContentType,a=shaka.util.MimeUtils,i=shaka.media.StreamingEngine,s=i.logPrefix_(e),o=null==e.lastSegmentReference,l=[],u=Math.max(0,Math.max(t.appendWindowStart,E.playRangeStart_)-i.APPEND_WINDOW_START_FUDGE_),c=Math.min(t.appendWindowEnd,E.playRangeEnd_)+i.APPEND_WINDOW_END_FUDGE_,goog.asserts.assert(t.startTime<=c,s+" segment should start before append window end"),d=t.codecs||e.stream.codecs,p=a.getCodecBase(d),h=a.getBasicType(t.mimeType||e.stream.mimeType),(f=t.timestampOffset)==e.lastTimestampOffset&&u==e.lastAppendWindowStart&&c==e.lastAppendWindowEnd&&p==e.lastCodecs&&h==e.lastMimeType){b.jumpTo(2);break}if(shaka.log.v1(s,"setting timestamp offset to "+f),shaka.log.v1(s,"setting append window start to "+u),shaka.log.v1(s,"setting append window end to "+c),!(e.lastCodecs&&e.lastMimeType&&E.playerInterface_.mediaSourceEngine.isResetMediaSourceNecessary(e.type,h,d))){b.jumpTo(3);break}if(m=null,e.type===n.VIDEO?m=E.mediaStates_.get(n.AUDIO):e.type===n.AUDIO&&(m=E.mediaStates_.get(n.VIDEO)),!m){b.jumpTo(3);break}return b.yield(E.abortOperations_(m).catch((function(){})),5);case 5:m.lastInitSegmentReference=null,m.lastAppendWindowStart=null,m.lastAppendWindowEnd=null,E.forceClearBuffer_(m);case 3:return b.yield(E.setProperties_(e,f,u,c,t,p,h),2);case 2:return shaka.media.InitSegmentReference.equal(t.initSegmentReference,e.lastInitSegmentReference)||(e.lastInitSegmentReference=t.initSegmentReference,t.isIndependent()&&t.initSegmentReference&&(shaka.log.v1(s,"fetching init segment"),g=E.fetch_(e,t.initSegmentReference),y=function(){var a,i,o,l,u,c,d,p,h;return $jscomp.asyncExecutePromiseGeneratorProgram((function(f){switch(f.nextAddress){case 1:return f.setCatchFinallyBlocks(2),f.yield(g,4);case 4:return a=f.yieldResult,E.destroyer_.ensureNotDestroyed(),i=null,o=new Map,l={projection:null,hfov:null},u=new shaka.util.Mp4Parser,c=shaka.util.Mp4Parser,d=shaka.util.Mp4BoxParsers,u.box("moov",c.children).box("trak",c.children).box("mdia",c.children).fullBox("mdhd",(function(e){goog.asserts.assert(null!=e.version,"MDHD is a full box and should have a valid version."),i=d.parseMDHD(e.reader,e.version).timescale})).box("hdlr",(function(e){switch(d.parseHDLR(e.reader).handlerType){case"soun":o.set(n.AUDIO,i);break;case"vide":o.set(n.VIDEO,i)}i=null})).box("minf",c.children).box("stbl",c.children).fullBox("stsd",c.sampleDescription).box("encv",c.visualSampleEntry).box("avc1",c.visualSampleEntry).box("avc3",c.visualSampleEntry).box("hev1",c.visualSampleEntry).box("hvc1",c.visualSampleEntry).box("dvav",c.visualSampleEntry).box("dva1",c.visualSampleEntry).box("dvh1",c.visualSampleEntry).box("dvhe",c.visualSampleEntry).box("dvc1",c.visualSampleEntry).box("dvi1",c.visualSampleEntry).box("vexu",c.children).box("proj",c.children).fullBox("prji",(function(e){e=d.parsePRJI(e.reader),l.projection=e.projection})).box("hfov",(function(e){e=d.parseHFOV(e.reader),l.hfov=e.hfov})).parse(a),e.type===n.VIDEO&&E.updateSpatialVideoInfo_(l),o.has(e.type)?t.initSegmentReference.timescale=o.get(e.type):null!=i&&(t.initSegmentReference.timescale=i),shaka.log.v1(s,"appending init segment"),p=e.stream.closedCaptions&&0<e.stream.closedCaptions.size,f.yield(E.playerInterface_.beforeAppendSegment(e.type,a),5);case 5:return f.yield(E.playerInterface_.mediaSourceEngine.appendBuffer(e.type,a,null,e.stream,p,e.seeked,r),6);case 6:f.leaveTryBlock(0);break;case 2:throw h=f.enterCatchBlock(),e.lastInitSegmentReference=null,h}}))},v=t.startTime,o&&(null!=(_=E.playerInterface_.mediaSourceEngine.bufferEnd(e.type))&&(v=_)),E.playerInterface_.onInitSegmentAppended(v,t.initSegmentReference),l.push(y()))),k=e.lastSegmentReference?e.lastSegmentReference.discontinuitySequence:null,t.discontinuitySequence!=k&&l.push(E.playerInterface_.mediaSourceEngine.resync(e.type,t.startTime)),b.yield(Promise.all(l),0)}}))},shaka.media.StreamingEngine.prototype.setProperties_=function(e,t,r,n,a,i,s){var o,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress)return o=shaka.util.ManifestParserUtils.ContentType,l=new Map,d.currentVariant_.audio&&l.set(o.AUDIO,d.currentVariant_.audio),d.currentVariant_.video&&l.set(o.VIDEO,d.currentVariant_.video),p.setCatchFinallyBlocks(2),e.lastAppendWindowStart=r,e.lastAppendWindowEnd=n,i&&(e.lastCodecs=i),s&&(e.lastMimeType=s),e.lastTimestampOffset=t,u=d.manifest_.sequenceMode||d.manifest_.type==shaka.media.ManifestParser.HLS,p.yield(d.playerInterface_.mediaSourceEngine.setStreamProperties(e.type,t,r,n,u,a.mimeType||e.stream.mimeType,a.codecs||e.stream.codecs,l),4);if(2!=p.nextAddress)return p.leaveTryBlock(0);throw c=p.enterCatchBlock(),e.lastAppendWindowStart=null,e.lastAppendWindowEnd=null,e.lastCodecs=null,e.lastMimeType=null,e.lastTimestampOffset=null,c}))},shaka.media.StreamingEngine.prototype.append_=function(e,t,r,n,a,i,s){i=void 0!==i&&i,s=void 0!==s&&s;var o,l,u,c,d,p,h,f=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(m){switch(m.nextAddress){case 1:return o=shaka.media.StreamingEngine.logPrefix_(e),l=r.closedCaptions&&0<r.closedCaptions.size,f.config_.shouldFixTimestampOffset&&(c="video/mp4"==r.mimeType||"audio/mp4"==r.mimeType,d=null,n.initSegmentReference&&(d=n.initSegmentReference.timescale),(p=c&&d&&r.type===shaka.util.ManifestParserUtils.ContentType.VIDEO&&f.manifest_.type==shaka.media.ManifestParser.DASH)&&(u=new shaka.util.Mp4Parser),p&&u.box("moof",shaka.util.Mp4Parser.children).box("traf",shaka.util.Mp4Parser.children).fullBox("tfdt",(function(t){var r,a,i,s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return goog.asserts.assert(null!=t.version,"TFDT is a full box and should have a valid version."),r=shaka.util.Mp4BoxParsers.parseTFDTInaccurate(t.reader,t.version),(a=r.baseMediaDecodeTime)?(goog.asserts.assert("number"==typeof d,"Should be an number!"),i=-a/d,(Number(e.lastTimestampOffset)||0)<i?(s=e.lastAppendWindowStart,o=e.lastAppendWindowEnd,goog.asserts.assert("number"==typeof s,"Should be an number!"),goog.asserts.assert("number"==typeof o,"Should be an number!"),l.yield(f.setProperties_(e,i,s,o,n),0)):l.jumpTo(0)):l.return()}))})),p&&u.parse(a,!1,i)),m.yield(f.evict_(e,t),2);case 2:return f.destroyer_.ensureNotDestroyed(),h=e.seeked,e.seeked=!1,m.yield(f.playerInterface_.beforeAppendSegment(e.type,a),3);case 3:return m.yield(f.playerInterface_.mediaSourceEngine.appendBuffer(e.type,a,n,r,l,h,s,i),4);case 4:f.destroyer_.ensureNotDestroyed(),shaka.log.v2(o,"appended media segment"),m.jumpToEnd()}}))},shaka.media.StreamingEngine.prototype.evict_=function(e,t){var r,n,a,i,s,o,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){return 1==p.nextAddress?((r=e.stream.segmentIndex)instanceof shaka.media.MetaSegmentIndex&&r.evict(d.manifest_.presentationTimeline.getSegmentAvailabilityStart()),n=shaka.media.StreamingEngine.logPrefix_(e),shaka.log.v2(n,"checking buffer length"),a=Math.max(d.config_.bufferBehind*d.bufferingScale_,d.manifest_.presentationTimeline.getMaxSegmentDuration()),null==(i=d.playerInterface_.mediaSourceEngine.bufferStart(e.type))?(d.lastTextMediaStateBeforeUnload_==e&&(d.lastTextMediaStateBeforeUnload_=null),shaka.log.v2(n,"buffer behind okay because nothing buffered:","presentationTime="+t,"bufferBehind="+a),p.return()):(s=t-i,o=d.config_.evictionGoal,l=d.manifest_.presentationTimeline.getSeekRangeStart(),u=d.manifest_.presentationTimeline.getSeekRangeEnd(),c=s-a,u-l>o&&(c=Math.max(s-a,l-o-i)),c<=o?(shaka.log.v2(n,"buffer behind okay:","presentationTime="+t,"bufferedBehind="+s,"bufferBehind="+a,"evictionGoal="+o,"underflow="+Math.abs(c)),p.return()):(shaka.log.v1(n,"buffer behind too large:","presentationTime="+t,"bufferedBehind="+s,"bufferBehind="+a,"evictionGoal="+o,"overflow="+c),p.yield(d.playerInterface_.mediaSourceEngine.remove(e.type,i,i+c),2)))):4!=p.nextAddress?(d.destroyer_.ensureNotDestroyed(),shaka.log.v1(n,"evicted "+c+" seconds"),d.lastTextMediaStateBeforeUnload_?p.yield(d.evict_(d.lastTextMediaStateBeforeUnload_,t),4):p.jumpTo(0)):(d.destroyer_.ensureNotDestroyed(),void p.jumpToEnd())}))},shaka.media.StreamingEngine.isEmbeddedText_=function(e){var t=shaka.util.MimeUtils,r=t.CEA608_CLOSED_CAPTION_MIMETYPE;return t=t.CEA708_CLOSED_CAPTION_MIMETYPE,e&&e.type==shaka.util.ManifestParserUtils.ContentType.TEXT&&(e.stream.mimeType==r||e.stream.mimeType==t)},shaka.media.StreamingEngine.prototype.fetch_=function(e,t,r){var n,a,i,s,o,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){switch(u.nextAddress){case 1:return(n=t.getSegmentData())?u.return(n):(a=null,e.segmentPrefetch&&(a=e.segmentPrefetch.getPrefetchedSegment(t,r)),a||(a=l.dispatchFetch_(t,e.stream,r)),i=0,e.segmentIterator&&(i=e.segmentIterator.currentPosition()),e.operation=a,u.yield(a.promise,2));case 2:if(s=u.yieldResult,e.operation=null,o=s.data,!t.aesKey){u.jumpTo(3);break}return u.yield(shaka.media.SegmentUtils.aesDecrypt(o,t.aesKey,i),4);case 4:o=u.yieldResult;case 3:return u.return(o)}}))},shaka.media.StreamingEngine.prototype.dispatchFetch_=function(e,t,r,n){return goog.asserts.assert(this.playerInterface_.netEngine,"Must have net engine"),shaka.media.StreamingEngine.dispatchFetch(e,t,r||null,this.config_.retryParameters,this.playerInterface_.netEngine)},shaka.media.StreamingEngine.dispatchFetch=function(e,t,r,n,a,i){i=void 0!==i&&i;var s=shaka.net.NetworkingEngine.RequestType.SEGMENT,o=e instanceof shaka.media.SegmentReference?e:void 0,l=o?shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_SEGMENT:shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT;return(r=shaka.util.Networking.createSegmentRequest(e.getUris(),e.startByte,e.endByte,n,r)).contentType=t.type,shaka.log.v2("fetching: reference=",e),a.request(s,r,{type:l,stream:t,segment:o,isPreload:i})},shaka.media.StreamingEngine.prototype.clearBuffer_=function(e,t,r){var n,a,i,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(n=shaka.media.StreamingEngine.logPrefix_(e),goog.asserts.assert(!e.performingUpdate&&null==e.updateTimer,n+" unexpected call to clearBuffer_()"),e.waitingToClearBuffer=!1,e.waitingToFlushBuffer=!1,e.clearBufferSafeMargin=0,e.clearingBuffer=!0,e.lastSegmentReference=null,e.segmentIterator=null,shaka.log.debug(n,"clearing buffer"),e.segmentPrefetch&&!s.audioPrefetchMap_.has(e.stream)&&e.segmentPrefetch.clearAll(),r?(a=s.playerInterface_.getPresentationTime(),i=s.playerInterface_.mediaSourceEngine.getDuration(),o.yield(s.playerInterface_.mediaSourceEngine.remove(e.type,a+r,i),3)):o.yield(s.playerInterface_.mediaSourceEngine.clear(e.type),4)):3!=o.nextAddress?(s.destroyer_.ensureNotDestroyed(),t?o.yield(s.playerInterface_.mediaSourceEngine.flush(e.type),3):o.jumpTo(3)):(s.destroyer_.ensureNotDestroyed(),shaka.log.debug(n,"cleared buffer"),e.clearingBuffer=!1,e.endOfStream=!1,e.performingUpdate||e.updateTimer||s.scheduleUpdate_(e,0),void o.jumpToEnd())}))},shaka.media.StreamingEngine.prototype.scheduleUpdate_=function(e,t){var r=this,n=shaka.media.StreamingEngine.logPrefix_(e),a=e.type;a!=shaka.util.ManifestParserUtils.ContentType.TEXT||this.mediaStates_.has(a)?(shaka.log.v2(n,"updating in "+t+" seconds"),goog.asserts.assert(null==e.updateTimer,n+" did not expect update to be scheduled"),e.updateTimer=new shaka.util.DelayedTick((function(){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(n.setCatchFinallyBlocks(2),n.yield(r.onUpdate_(e),4)):2!=n.nextAddress?n.leaveTryBlock(0):(t=n.enterCatchBlock(),r.playerInterface_&&r.playerInterface_.onError(t),void n.jumpToEnd())}))})).tickAfter(t)):shaka.log.v1(n,"Text stream is unloaded. No update is needed.")},shaka.media.StreamingEngine.prototype.cancelUpdate_=function(e){null!=e.updateTimer&&(e.updateTimer.stop(),e.updateTimer=null)},shaka.media.StreamingEngine.prototype.abortOperations_=function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return e.operation?t.yield(e.operation.abort(),0):t.jumpTo(0)}))},shaka.media.StreamingEngine.prototype.handleStreamingError_=function(e,t){var r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){if(1==i.nextAddress)return r=shaka.media.StreamingEngine.logPrefix_(e),t.code==shaka.util.Error.Code.STREAMING_NOT_ALLOWED?(e.performingUpdate=!1,a.cancelUpdate_(e),a.scheduleUpdate_(e,0),i.return()):i.yield(a.failureCallbackBackoff_.attempt(),2);if(a.destroyer_.ensureNotDestroyed(),t.category===shaka.util.Error.Category.NETWORK&&t.code!=shaka.util.Error.Code.TIMEOUT){if(e.restoreStreamAfterTrickPlay)return a.setTrickPlay(!1),i.return();(n=a.getDisabledTime_(t))&&shaka.log.debug(r,"Disabling stream due to error",t),t.handled=a.playerInterface_.disableStream(e.stream,n),t.handled&&(t.severity=shaka.util.Error.Severity.RECOVERABLE)}t.handled&&t.code==shaka.util.Error.Code.SEGMENT_MISSING||a.playerInterface_.onError(t),t.handled||a.config_.failureCallback(t),i.jumpToEnd()}))};shaka.media.StreamingEngine.prototype.getDisabledTime_=function(e){return 0===this.config_.maxDisabledTime&&e.code==shaka.util.Error.Code.SEGMENT_MISSING?1:this.config_.maxDisabledTime},shaka.media.StreamingEngine.prototype.resetMediaSource=function(e,t){e=void 0!==e&&e,t=void 0===t||t;var r,n,a,i,s,o,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress){if(r=Date.now()/1e3,n=l.config_.minTimeBetweenRecoveries,!e){if(!l.config_.allowMediaSourceRecoveries||r-l.lastMediaSourceReset_<n)return u.return(!1);l.lastMediaSourceReset_=r}return a=shaka.util.ManifestParserUtils.ContentType,(i=l.mediaStates_.get(a.AUDIO))&&(i.lastInitSegmentReference=null,i.lastAppendWindowStart=null,i.lastAppendWindowEnd=null,t&&l.forceClearBuffer_(i),l.abortOperations_(i).catch((function(){})),i.segmentIterator&&i.segmentIterator.resetToLastIndependent()),(s=l.mediaStates_.get(a.VIDEO))&&(s.lastInitSegmentReference=null,s.lastAppendWindowStart=null,s.lastAppendWindowEnd=null,t&&l.forceClearBuffer_(s),l.abortOperations_(s).catch((function(){})),s.segmentIterator&&s.segmentIterator.resetToLastIndependent()),o=new Map,l.currentVariant_.audio&&o.set(a.AUDIO,l.currentVariant_.audio),l.currentVariant_.video&&o.set(a.VIDEO,l.currentVariant_.video),u.yield(l.playerInterface_.mediaSourceEngine.reset(o),2)}return!s||s.clearingBuffer||s.performingUpdate||s.updateTimer||l.scheduleUpdate_(s,0),!i||i.clearingBuffer||i.performingUpdate||i.updateTimer||l.scheduleUpdate_(i,0),u.return(!0)}))},shaka.media.StreamingEngine.prototype.updateSpatialVideoInfo_=function(e){if(this.spatialVideoInfo_.projection!=e.projection||this.spatialVideoInfo_.hfov!=e.hfov){var t=shaka.util.FakeEvent.EventName;if(null!=e.projection||null!=e.hfov){t=t.SpatialVideoInfoEvent;var r=(new Map).set("detail",e);t=new shaka.util.FakeEvent(t,r)}else t=new shaka.util.FakeEvent(t.NoSpatialVideoInfoEvent);t.cancelable=!0,this.playerInterface_.onEvent(t),this.spatialVideoInfo_=e}},shaka.media.StreamingEngine.prototype.updateSegmentIteratorReverse_=function(){for(var e=0>this.playerInterface_.getPlaybackRate(),t=$jscomp.makeIterator(this.mediaStates_.values()),r=t.next();!r.done;r=t.next())(r=r.value).segmentIterator&&r.segmentIterator.setReverse(e),r.segmentPrefetch&&r.segmentPrefetch.setReverse(e);for(r=(t=$jscomp.makeIterator(this.audioPrefetchMap_.values())).next();!r.done;r=t.next())r.value.setReverse(e)},shaka.media.StreamingEngine.prototype.forwardTimeForCrossBoundary=function(){if(this.config_.crossBoundaryStrategy!==shaka.config.CrossBoundaryStrategy.KEEP){this.crossBoundaryTimer_.stop();var e=this.playerInterface_.getPresentationTime(),t=shaka.util.ManifestParserUtils.ContentType;if((t=this.mediaStates_.get(t.VIDEO)||this.mediaStates_.get(t.AUDIO))&&(t=t.lastInitSegmentReference)&&null!==t.boundaryEnd){var r=shaka.media.StreamingEngine.CROSS_BOUNDARY_END_THRESHOLD_;0>(e=t.boundaryEnd-e)||e>r||(this.boundaryTime_=t.boundaryEnd+shaka.media.StreamingEngine.APPEND_WINDOW_END_FUDGE_,this.crossBoundaryTimer_.tickAfter(e))}}},shaka.media.StreamingEngine.prototype.discardReferenceByBoundary_=function(e,t){var r=this;if(e.type===shaka.util.ManifestParserUtils.ContentType.TEXT)return!1;var n=e.lastInitSegmentReference;if(!n)return!1;var a=shaka.config.CrossBoundaryStrategy,i=shaka.media.StreamingEngine.logPrefix_(e),s=t.initSegmentReference,o=n.boundaryEnd!==s.boundaryEnd;if(this.config_.crossBoundaryStrategy===a.RESET_TO_ENCRYPTED&&(n.encrypted||s.encrypted||(o=!1),n.encrypted&&(shaka.log.debug(i,"stream is encrypted, discard crossBoundaryStrategy"),this.config_.crossBoundaryStrategy=a.KEEP)),this.config_.crossBoundaryStrategy===a.RESET_ON_ENCRYPTION_CHANGE&&n.encrypted==s.encrypted&&(o=!1),o&&e.seeked){shaka.log.debug(i,"reset mediaSource","from=",e.lastInitSegmentReference,"to=",t.initSegmentReference);var l=this.playerInterface_.video,u=l.paused;this.resetMediaSource(!0).then((function(){r.playerInterface_.onEvent(new shaka.util.FakeEvent(shaka.util.FakeEvent.EventName.BoundaryCrossed)),u||l.play()}))}return o},shaka.media.StreamingEngine.logPrefix_=function(e){return"("+e.type+":"+e.stream.id+")"},shaka.media.StreamingEngine.APPEND_WINDOW_START_FUDGE_=.1,shaka.media.StreamingEngine.APPEND_WINDOW_END_FUDGE_=.01,shaka.media.StreamingEngine.MAX_RUN_AHEAD_SEGMENTS_=1,shaka.media.StreamingEngine.CROSS_BOUNDARY_END_THRESHOLD_=1,shaka.util.ConfigUtils=function(){},shaka.util.ConfigUtils.mergeConfigObjects=function(e,t,r,n,a){goog.asserts.assert(e,"Destination config must not be null!");var i,s=a in n,o=s?r.constructor==Object&&0==Object.keys(n).length:r.constructor==Object&&0==Object.keys(r).length,l=s||o,u=!0;for(i in t){var c=a+"."+i,d=s?n[a]:r[i];l||i in r?void 0===t[i]?void 0===d||l?delete e[i]:e[i]=shaka.util.ObjectUtils.cloneObject(d):o?e[i]=t[i]:d.constructor==Object&&t[i]&&t[i].constructor==Object?(e[i]||(e[i]=shaka.util.ObjectUtils.cloneObject(d)),c=shaka.util.ConfigUtils.mergeConfigObjects(e[i],t[i],d,n,c),u=u&&c):typeof t[i]!=typeof d||null==t[i]||"function"!=typeof t[i]&&t[i].constructor!=d.constructor?(shaka.log.alwaysError("Invalid config, wrong type for "+c),u=!1):("function"==typeof r[i]&&r[i].length!=t[i].length&&shaka.log.alwaysWarn("Unexpected number of arguments for "+c),e[i]=t[i]):(shaka.log.alwaysError("Invalid config, unrecognized key "+c),u=!1)}return u},shaka.util.ConfigUtils.convertToConfigObject=function(e,t){for(var r={},n=r,a=0,i=0;!(0>(a=e.indexOf(".",a)));)0!=a&&"\\"==e[a-1]||(n[i=e.substring(i,a).replace(/\\\./g,".")]={},n=n[i],i=a+1),a+=1;return n[e.substring(i).replace(/\\\./g,".")]=t,r},shaka.util.ConfigUtils.referenceParametersAndReturn=function(e,t){return e&&t},shaka.util.ConfigUtils.getDifferenceFromConfigObjects=function(e,t){var r=function(e){return e&&"object"==typeof e&&!Array.isArray(e)},n=function(e,t){return Object.keys(e).reduce((function(a,i){var s=e[i];return t.hasOwnProperty(i)?s instanceof HTMLElement&&t[i]instanceof HTMLElement?s.isEqualNode(t[i])||(a[i]=s):r(s)&&r(t[i])?(s=n(s,t[i]),(0<Object.keys(s).length||!r(s))&&(a[i]=s)):Array.isArray(s)&&Array.isArray(t[i])?shaka.util.ArrayUtils.hasSameElements(s,t[i])||(a[i]=s):Number.isNaN(s)&&Number.isNaN(t[i])||s!==t[i]&&(a[i]=s):a[i]=s,a}),{})};e=n(e,t);var a=function(e){for(var t=$jscomp.makeIterator(Object.keys(e)),n=t.next();!n.done;n=t.next())if(!(e[n=n.value]instanceof HTMLElement))if(r(e[n])&&0===Object.keys(e[n]).length)delete e[n];else{var i=e[n];Array.isArray(i)&&0===i.length||"function"==typeof e[n]?delete e[n]:r(e[n])&&(a(e[n]),0===Object.keys(e[n]).length&&delete e[n])}};return a(e),e},goog.exportSymbol("shaka.util.ConfigUtils",shaka.util.ConfigUtils),goog.exportProperty(shaka.util.ConfigUtils,"getDifferenceFromConfigObjects",shaka.util.ConfigUtils.getDifferenceFromConfigObjects),goog.exportProperty(shaka.util.ConfigUtils,"convertToConfigObject",shaka.util.ConfigUtils.convertToConfigObject),goog.exportProperty(shaka.util.ConfigUtils,"mergeConfigObjects",shaka.util.ConfigUtils.mergeConfigObjects),shaka.drm.FairPlay=function(){},shaka.drm.FairPlay.isFairPlaySupported=function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},t.setCatchFinallyBlocks(2),t.yield(navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.nextAddress?t.return(!0):(t.enterCatchBlock(),t.return(!1))}))},shaka.drm.FairPlay.defaultGetContentId=function(e){return e=shaka.util.StringUtils.fromBytesAutoDetect(e),new goog.Uri(e).getDomain()},shaka.drm.FairPlay.defaultGetKeyId=function(e){return 32===(e=new goog.Uri(e).getDomain().replace(/-/g,"").toLowerCase()).length&&/^[0-9a-f]+$/.test(e)?e:null},shaka.drm.FairPlay.initDataTransform=function(e,t,r){if(!r||!r.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.SERVER_CERTIFICATE_REQUIRED);t="string"==typeof t?shaka.util.StringUtils.toUTF16(t,!0):t,e=shaka.util.StringUtils.fromBytesAutoDetect(e),e=shaka.util.StringUtils.toUTF16(e,!0);var n=new Uint8Array(12+e.byteLength+t.byteLength+r.byteLength),a=0,i=function(e){shaka.util.BufferUtils.toDataView(n).setUint32(a,e.byteLength,!0),a+=4,n.set(shaka.util.BufferUtils.toUint8(e),a),a+=e.byteLength};return i(e),i(t),i(r),goog.asserts.assert(a==n.length,"Inconsistent init data length"),n},shaka.drm.FairPlay.basicInitDataTransform_=function(e,t,r){return"skd"!==t?e:(t=r.serverCertificate,r=shaka.util.StringUtils.fromBytesAutoDetect(e).split("skd://").pop(),shaka.drm.FairPlay.initDataTransform(e,r,t))},shaka.drm.FairPlay.verimatrixInitDataTransform=function(e,t,r){return shaka.drm.FairPlay.basicInitDataTransform_(e,t,r)},shaka.drm.FairPlay.ezdrmInitDataTransform=function(e,t,r){return"skd"!==t?e:(t=r.serverCertificate,r=shaka.util.StringUtils.fromBytesAutoDetect(e).split(";").pop(),shaka.drm.FairPlay.initDataTransform(e,r,t))},shaka.drm.FairPlay.conaxInitDataTransform=function(e,t,r){if("skd"!==t)return e;t=r.serverCertificate,r=shaka.util.StringUtils.fromBytesAutoDetect(e).split("skd://").pop().split("?").shift(),r=window.atob(r);var n=new ArrayBuffer(2*r.length);n=shaka.util.BufferUtils.toUint16(n);for(var a=0,i=r.length;a<i;a++)n[a]=r.charCodeAt(a);return shaka.drm.FairPlay.initDataTransform(e,n,t)},shaka.drm.FairPlay.expressplayInitDataTransform=function(e,t,r){return shaka.drm.FairPlay.basicInitDataTransform_(e,t,r)},shaka.drm.FairPlay.muxInitDataTransform=function(e,t,r){return shaka.drm.FairPlay.basicInitDataTransform_(e,t,r)},shaka.drm.FairPlay.verimatrixFairPlayRequest=function(e,t,r){e===shaka.net.NetworkingEngine.RequestType.LICENSE&&(e=t.drmInfo)&&shaka.drm.DrmUtils.isFairPlayKeySystem(e.keySystem)&&(e=shaka.util.BufferUtils.toUint8(t.body),e=shaka.util.Uint8ArrayUtils.toBase64(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=shaka.util.StringUtils.toUTF8("spc="+e))},shaka.drm.FairPlay.octetStreamFairPlayRequest_=function(e,t,r){e===shaka.net.NetworkingEngine.RequestType.LICENSE&&(e=t.drmInfo)&&shaka.drm.DrmUtils.isFairPlayKeySystem(e.keySystem)&&(t.headers["Content-Type"]="application/octet-stream")},shaka.drm.FairPlay.ezdrmFairPlayRequest=function(e,t,r){shaka.drm.FairPlay.octetStreamFairPlayRequest_(e,t)},shaka.drm.FairPlay.conaxFairPlayRequest=function(e,t,r){shaka.drm.FairPlay.octetStreamFairPlayRequest_(e,t)},shaka.drm.FairPlay.expressplayFairPlayRequest=function(e,t,r){e===shaka.net.NetworkingEngine.RequestType.LICENSE&&(r=t.drmInfo)&&shaka.drm.DrmUtils.isFairPlayKeySystem(r.keySystem)&&shaka.drm.FairPlay.octetStreamFairPlayRequest_(e,t)},shaka.drm.FairPlay.muxFairPlayRequest=function(e,t,r){shaka.drm.FairPlay.octetStreamFairPlayRequest_(e,t)},shaka.drm.FairPlay.commonFairPlayResponse=function(e,t,r){if(e===shaka.net.NetworkingEngine.RequestType.LICENSE&&(e=t.originalRequest.drmInfo)&&shaka.drm.DrmUtils.isFairPlayKeySystem(e.keySystem)){try{var n=shaka.util.StringUtils.fromUTF8(t.data)}catch(e){return}if(e=!1,"<ckc>"===(n=n.trim()).substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0),!e)try{var a=JSON.parse(n);a.ckc&&(n=a.ckc,e=!0),a.CkcMessage&&(n=a.CkcMessage,e=!0),a.License&&(n=a.License,e=!0)}catch(e){}e&&(t.data=shaka.util.BufferUtils.toArrayBuffer(shaka.util.Uint8ArrayUtils.fromBase64(n)))}},goog.exportSymbol("shaka.drm.FairPlay",shaka.drm.FairPlay),goog.exportProperty(shaka.drm.FairPlay,"commonFairPlayResponse",shaka.drm.FairPlay.commonFairPlayResponse),goog.exportProperty(shaka.drm.FairPlay,"muxFairPlayRequest",shaka.drm.FairPlay.muxFairPlayRequest),goog.exportProperty(shaka.drm.FairPlay,"expressplayFairPlayRequest",shaka.drm.FairPlay.expressplayFairPlayRequest),goog.exportProperty(shaka.drm.FairPlay,"conaxFairPlayRequest",shaka.drm.FairPlay.conaxFairPlayRequest),goog.exportProperty(shaka.drm.FairPlay,"ezdrmFairPlayRequest",shaka.drm.FairPlay.ezdrmFairPlayRequest),goog.exportProperty(shaka.drm.FairPlay,"verimatrixFairPlayRequest",shaka.drm.FairPlay.verimatrixFairPlayRequest),goog.exportProperty(shaka.drm.FairPlay,"muxInitDataTransform",shaka.drm.FairPlay.muxInitDataTransform),goog.exportProperty(shaka.drm.FairPlay,"expressplayInitDataTransform",shaka.drm.FairPlay.expressplayInitDataTransform),goog.exportProperty(shaka.drm.FairPlay,"conaxInitDataTransform",shaka.drm.FairPlay.conaxInitDataTransform),goog.exportProperty(shaka.drm.FairPlay,"ezdrmInitDataTransform",shaka.drm.FairPlay.ezdrmInitDataTransform),goog.exportProperty(shaka.drm.FairPlay,"verimatrixInitDataTransform",shaka.drm.FairPlay.verimatrixInitDataTransform),goog.exportProperty(shaka.drm.FairPlay,"initDataTransform",shaka.drm.FairPlay.initDataTransform),goog.exportProperty(shaka.drm.FairPlay,"defaultGetContentId",shaka.drm.FairPlay.defaultGetContentId),goog.exportProperty(shaka.drm.FairPlay,"isFairPlaySupported",shaka.drm.FairPlay.isFairPlaySupported),shaka.media.PreferenceBasedCriteria=function(){this.config_=null},shaka.media.PreferenceBasedCriteria.prototype.configure=function(e){this.config_=e},shaka.media.PreferenceBasedCriteria.prototype.create=function(e){var t,r=shaka.media.PreferenceBasedCriteria;if(this.config_.language){var n=r.filterByLanguage_(e,this.config_.language);n.length&&(t=n)}return t||(t=(t=e.filter((function(e){return e.primary}))).length?t:e),(e=r.filterVariantsByRole_(t,this.config_.role)).length?t=e:shaka.log.warning("No exact match for variant role could be found."),this.config_.videoLayout&&((e=r.filterVariantsByVideoLayout_(t,this.config_.videoLayout)).length?t=e:shaka.log.warning("No exact match for the video layout could be found.")),this.config_.hdrLevel&&((e=r.filterVariantsByHDRLevel_(t,this.config_.hdrLevel)).length?t=e:shaka.log.warning("No exact match for the hdr level could be found.")),this.config_.channelCount&&((e=r.filterVariantsByAudioChannelCount_(t,this.config_.channelCount)).length?t=e:shaka.log.warning("No exact match for the channel count could be found.")),this.config_.audioLabel&&((e=r.filterVariantsByAudioLabel_(t,this.config_.audioLabel)).length?t=e:shaka.log.warning("No exact match for audio label could be found.")),this.config_.videoLabel&&((e=r.filterVariantsByVideoLabel_(t,this.config_.videoLabel)).length?t=e:shaka.log.warning("No exact match for video label could be found.")),(e=r.filterVariantsBySpatialAudio_(t,this.config_.spatialAudio)).length?t=e:shaka.log.warning("No exact match for spatial audio could be found."),this.config_.audioCodec&&((r=r.filterVariantsByAudioCodec_(t,this.config_.audioCodec)).length?t=r:shaka.log.warning("No exact match for audio codec could be found.")),r=this.config_.codecSwitchingStrategy==shaka.config.CodecSwitchingStrategy.SMOOTH&&shaka.media.Capabilities.isChangeTypeSupported(),new shaka.media.AdaptationSet(t[0],t,!r)},shaka.media.PreferenceBasedCriteria.filterByLanguage_=function(e,t){var r=shaka.util.LanguageUtils;t=r.normalize(t);var n=r.findClosestLocale(t,e.map((function(e){return r.getLocaleForVariant(e)})));return n?e.filter((function(e){return n==r.getLocaleForVariant(e)})):[]},shaka.media.PreferenceBasedCriteria.filterVariantsByRole_=function(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))},shaka.media.PreferenceBasedCriteria.filterVariantsByAudioLabel_=function(e,t){return e.filter((function(e){return!(!e.audio||!e.audio.label)&&(e=e.audio.label.toLowerCase())==t.toLowerCase()}))},shaka.media.PreferenceBasedCriteria.filterVariantsByVideoLabel_=function(e,t){return e.filter((function(e){return!(!e.video||!e.video.label)&&(e=e.video.label.toLowerCase())==t.toLowerCase()}))},shaka.media.PreferenceBasedCriteria.filterVariantsByAudioChannelCount_=function(e,t){return e.filter((function(e){return!(e.audio&&e.audio.channelsCount&&e.audio.channelsCount>t)})).sort((function(e,t){return e.audio||t.audio?e.audio?t.audio?(t.audio.channelsCount||0)-(e.audio.channelsCount||0):1:-1:0}))},shaka.media.PreferenceBasedCriteria.filterVariantsByHDRLevel_=function(e,t){if("AUTO"==t){var r=e.some((function(e){return!(!e.video||!e.video.hdr||"HLG"!=e.video.hdr)}));t=shaka.util.Platform.getHdrLevel(r)}return e.filter((function(e){return!e.video||!e.video.hdr||e.video.hdr==t}))},shaka.media.PreferenceBasedCriteria.filterVariantsByVideoLayout_=function(e,t){return e.filter((function(e){return!e.video||!e.video.videoLayout||e.video.videoLayout==t}))},shaka.media.PreferenceBasedCriteria.filterVariantsBySpatialAudio_=function(e,t){return e.filter((function(e){return!e.audio||e.audio.spatialAudio==t}))},shaka.media.PreferenceBasedCriteria.filterVariantsByAudioCodec_=function(e,t){return e.filter((function(e){return!e.audio||e.audio.codecs==t}))},shaka.util.PlayerConfiguration=function(){},shaka.util.PlayerConfiguration.createDefault=function(){var e=1/0;navigator.connection&&navigator.connection.saveData&&(e=360);var t={retryParameters:shaka.net.NetworkingEngine.defaultRetryParameters(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(e,t,r){return shaka.drm.DrmUtils.isMediaKeysPolyfilled("apple")&&"skd"==t&&(t=r.serverCertificate,r=shaka.drm.FairPlay.defaultGetContentId(e),e=shaka.drm.FairPlay.initDataTransform(e,r,t)),e},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:shaka.util.Platform.isXboxOne(),minHdcpVersion:"",ignoreDuplicateInitData:!shaka.util.Platform.isTizen2(),defaultAudioRobustnessForWidevine:"SW_SECURE_CRYPTO",defaultVideoRobustnessForWidevine:"SW_SECURE_DECODE"};(shaka.util.Platform.isXboxOne()||shaka.util.Platform.isPS4())&&t.preferredKeySystems.push("com.microsoft.playready");var r=shaka.config.CodecSwitchingStrategy.RELOAD,n=!1;shaka.media.Capabilities.isChangeTypeSupported()&&shaka.util.Platform.supportsSmoothCodecSwitching()&&(r=shaka.config.CodecSwitchingStrategy.SMOOTH,n=!0),n={retryParameters:shaka.net.NetworkingEngine.defaultRetryParameters(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,disableIFrames:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,continueLoadingWhenPaused:!0,ignoreSupplementalCodecs:!1,updatePeriod:-1,ignoreDrmInfo:!1,dash:{clockSyncUri:"",disableXlinkProcessing:!0,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2":"com.apple.fps","urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c":"com.huawei.wiseplay"},manifestPreprocessor:shaka.util.PlayerConfiguration.defaultManifestPreprocessor,manifestPreprocessorTXml:shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml,sequenceMode:!1,multiTypeVariantsAllowed:n,useStreamOnceInPeriodFlattening:!1,enableFastSwitching:!0},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',liveSegmentsDelay:3,sequenceMode:shaka.util.Platform.supportsSequenceMode(),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,disableClosedCaptionsDetection:!1,allowLowLatencyByteRangeOptimization:!0,allowRangeRequestsToGuessMimeType:!1},mss:{manifestPreprocessor:shaka.util.PlayerConfiguration.defaultManifestPreprocessor,manifestPreprocessorTXml:shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}};var a={retryParameters:shaka.net.NetworkingEngine.defaultRetryParameters(),failureCallback:function(e){return shaka.log.error("Unhandled streaming error",e),shaka.util.ConfigUtils.referenceParametersAndReturn([e],void 0)},rebufferingGoal:0,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapPadding:0,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,safeSeekEndOffset:0,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,forceHTTP:!1,forceHTTPS:!1,minBytesForProgressEvents:16e3,preferNativeDash:!1,preferNativeHls:!1,updateIntervalSeconds:1,observeQualityChanges:!1,maxDisabledTime:30,segmentPrefetchLimit:1,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:{enabled:!1,targetLatency:.5,targetLatencyTolerance:.5,maxPlaybackRate:1.1,minPlaybackRate:.95,panicMode:!1,panicThreshold:60,dynamicTargetLatency:{enabled:!1,stabilityThreshold:60,rebufferIncrement:.5,maxAttempts:10,maxLatency:4,minLatency:1}},allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,preloadNextUrlWindow:30,loadTimeout:30,clearDecodingCache:shaka.util.Platform.isPS4()||shaka.util.Platform.isPS5(),dontChooseCodecs:!1,shouldFixTimestampOffset:shaka.util.Platform.isWebOS()||shaka.util.Platform.isTizen(),avoidEvictionOnQuotaExceededError:!1,crossBoundaryStrategy:shaka.config.CrossBoundaryStrategy.KEEP};(shaka.util.Platform.isWebOS()||shaka.util.Platform.isTizen()||shaka.util.Platform.isChromecast()||shaka.util.Platform.isHisense())&&(a.stallSkip=0),(shaka.util.Platform.isLegacyEdge()||shaka.util.Platform.isXboxOne())&&(a.gapPadding=.01),shaka.util.Platform.isTizen()&&(a.gapPadding=2),shaka.util.Platform.isWebOS3()&&(a.crossBoundaryStrategy=shaka.config.CrossBoundaryStrategy.RESET),shaka.util.Platform.isTizen3()&&(a.crossBoundaryStrategy=shaka.config.CrossBoundaryStrategy.RESET_TO_ENCRYPTED);var i={trackSelectionCallback:function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return t.return(e)}))},downloadSizeCallback:function(e){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?navigator.storage&&navigator.storage.estimate?r.yield(navigator.storage.estimate(),3):r.return(!0):(t=r.yieldResult,r.return(t.usage+e<.95*t.quota))}))},progressCallback:function(e,t){return shaka.util.ConfigUtils.referenceParametersAndReturn([e,t],void 0)},usePersistentLicense:!0,numberOfParallelDownloads:5};e={enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:20,minTimeToSwitch:shaka.util.Platform.isApple()?.5:0,preferNetworkInformationBandwidth:!1},r={codecSwitchingStrategy:r,addExtraFeaturesToSourceBuffer:function(e){return shaka.util.ConfigUtils.referenceParametersAndReturn([e],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,modifyCueCallback:function(e,t){return shaka.util.ConfigUtils.referenceParametersAndReturn([e,t],void 0)},dispatchAllEmsgBoxes:!1};var s=!1,o=!1,l=!0;shaka.util.Platform.isSmartTV()&&(o=s=!0,l=!1);var u={drm:t,manifest:n,streaming:a,mediaSource:r,offline:i,abrFactory:function(){return new shaka.abr.SimpleAbrManager},adaptationSetCriteriaFactory:function(){var e=$jscomp.getRestArguments.apply(0,arguments);return new(Function.prototype.bind.apply(shaka.media.PreferenceBasedCriteria,[null].concat($jscomp.arrayFromIterable(e))))},abr:e,autoShowText:shaka.config.AutoShowText.IF_SUBTITLES_MAY_BE_NEEDED,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferredTextFormats:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25,fontScaleFactor:1},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[],version:1},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1,poster:!0},ads:{customPlayheadTracker:s,skipPlayDetection:o,supportsMultipleMediaElements:l,disableHLSInterstitial:!1,disableDASHInterstitial:!1,allowPreloadOnDomElements:!0},ignoreHardwareResolution:!1};return i.trackSelectionCallback=function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return t.return(shaka.util.PlayerConfiguration.defaultTrackSelect(e,u.preferredAudioLanguage,u.preferredVideoHdrLevel))}))},u},shaka.util.PlayerConfiguration.createDefaultForLL=function(){return{streaming:{inaccurateManifestTolerance:0,segmentPrefetchLimit:2,updateIntervalSeconds:.1,maxDisabledTime:1,retryParameters:{baseDelay:100}},manifest:{dash:{autoCorrectDrift:!1},retryParameters:{baseDelay:100}},drm:{retryParameters:{baseDelay:100}}}},shaka.util.PlayerConfiguration.mergeConfigObjects=function(e,t,r){var n={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:[],audioRobustness:[],sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:"",headers:{}}};return shaka.util.ConfigUtils.mergeConfigObjects(e,t,r||shaka.util.PlayerConfiguration.createDefault(),n,"")},shaka.util.PlayerConfiguration.defaultTrackSelect=function(e,t,r){var n=shaka.util.ManifestParserUtils.ContentType,a=shaka.util.LanguageUtils,i=r;"AUTO"==i&&(r=e.some((function(e){return!(!e.hdr||"HLG"!=e.hdr)})),i=shaka.util.Platform.getHdrLevel(r));var s=e.filter((function(e){return!("variant"!=e.type||e.hdr&&e.hdr!=i)}));r=[];var o=a.findClosestLocale(t,s.map((function(e){return e.language})));o&&(r=s.filter((function(e){return a.normalize(e.language)==o}))),0==r.length&&(r=s.filter((function(e){return e.primary}))),0==r.length&&(1<new Set(s.map((function(e){return e.language}))).size&&shaka.log.warning("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),r=s);var l=r.filter((function(e){return e.height&&480>=e.height}));for(l.length&&(l.sort((function(e,t){return goog.asserts.assert(null!=e.height,"Null height"),goog.asserts.assert(null!=t.height,"Null height"),t.height-e.height})),r=l.filter((function(e){return e.height==l[0].height}))),t=[],r.length&&(s=Math.floor(r.length/2),r.sort((function(e,t){return e.bandwidth-t.bandwidth})),t.push(r[s])),r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value).type!=n.TEXT&&r.type!=n.IMAGE||t.push(r);return t},shaka.util.PlayerConfiguration.defaultManifestPreprocessor=function(e){return shaka.util.ConfigUtils.referenceParametersAndReturn([e],e)},shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml=function(e){return shaka.util.ConfigUtils.referenceParametersAndReturn([e],e)},goog.exportSymbol("shaka.util.PlayerConfiguration",shaka.util.PlayerConfiguration),goog.exportProperty(shaka.util.PlayerConfiguration,"mergeConfigObjects",shaka.util.PlayerConfiguration.mergeConfigObjects),goog.exportProperty(shaka.util.PlayerConfiguration,"createDefaultForLL",shaka.util.PlayerConfiguration.createDefaultForLL),goog.exportProperty(shaka.util.PlayerConfiguration,"createDefault",shaka.util.PlayerConfiguration.createDefault),shaka.util.StateHistory=function(){this.open_=null,this.closed_=[]},shaka.util.StateHistory.prototype.update=function(e){return null==this.open_?(this.start_(e),!0):this.update_(e)},shaka.util.StateHistory.prototype.getTimeSpentIn=function(e){var t=0;this.open_&&this.open_.state==e&&(t+=this.open_.duration);for(var r=$jscomp.makeIterator(this.closed_),n=r.next();!n.done;n=r.next())t+=(n=n.value).state==e?n.duration:0;return t},shaka.util.StateHistory.prototype.getCopy=function(){for(var e=function(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}},t=[],r=$jscomp.makeIterator(this.closed_),n=r.next();!n.done;n=r.next())t.push(e(n.value));return this.open_&&t.push(e(this.open_)),t},shaka.util.StateHistory.prototype.start_=function(e){goog.asserts.assert(null==this.open_,"There must be no open entry in order when we start"),shaka.log.v1("Changing Player state to",e),this.open_={timestamp:this.getNowInSeconds_(),state:e,duration:0}},shaka.util.StateHistory.prototype.update_=function(e){goog.asserts.assert(this.open_,"There must be an open entry in order to update it");var t=this.getNowInSeconds_();return this.open_.duration=t-this.open_.timestamp,this.open_.state!=e&&(shaka.log.v1("Changing Player state to",e),this.closed_.push(this.open_),this.open_={timestamp:t,state:e,duration:0},!0)},shaka.util.StateHistory.prototype.getNowInSeconds_=function(){return Date.now()/1e3},shaka.util.SwitchHistory=function(){this.currentText_=this.currentVariant_=null,this.history_=[]},shaka.util.SwitchHistory.prototype.updateCurrentVariant=function(e,t){this.currentVariant_!=e&&(this.currentVariant_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"variant",fromAdaptation:t,bandwidth:e.bandwidth}))},shaka.util.SwitchHistory.prototype.updateCurrentText=function(e,t){this.currentText_!=e&&(this.currentText_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"text",fromAdaptation:t,bandwidth:null}))},shaka.util.SwitchHistory.prototype.getCopy=function(){for(var e=[],t=$jscomp.makeIterator(this.history_),r=t.next();!r.done;r=t.next())e.push(this.clone_(r.value));return e},shaka.util.SwitchHistory.prototype.getNowInSeconds_=function(){return Date.now()/1e3},shaka.util.SwitchHistory.prototype.clone_=function(e){return{timestamp:e.timestamp,id:e.id,type:e.type,fromAdaptation:e.fromAdaptation,bandwidth:e.bandwidth}},shaka.util.Stats=function(){this.bytesDownloaded_=this.manifestSizeBytes_=this.bandwidthEstimate_=this.currentStreamBandwidth_=this.maxSegmentDurationSeconds_=this.liveLatencySeconds_=this.licenseTimeSeconds_=this.drmTimeSeconds_=this.manifestTimeSeconds_=this.loadLatencySeconds_=this.completionPercent_=this.totalGapsJumped_=this.totalStallsDetected_=this.totalCorruptedFrames_=this.totalDecodedFrames_=this.totalDroppedFrames_=this.height_=this.width_=NaN,this.nonFatalErrorCount_=0,this.manifestGapCount_=this.manifestPeriodCount_=NaN,this.stateHistory_=new shaka.util.StateHistory,this.switchHistory_=new shaka.util.SwitchHistory},shaka.util.Stats.prototype.setDroppedFrames=function(e,t){this.totalDroppedFrames_=e,this.totalDecodedFrames_=t},shaka.util.Stats.prototype.setCorruptedFrames=function(e){this.totalCorruptedFrames_=e},shaka.util.Stats.prototype.setStallsDetected=function(e){this.totalStallsDetected_=e},shaka.util.Stats.prototype.setGapsJumped=function(e){this.totalGapsJumped_=e},shaka.util.Stats.prototype.setResolution=function(e,t){this.width_=e,this.height_=t},shaka.util.Stats.prototype.setLoadLatency=function(e){this.loadLatencySeconds_=e},shaka.util.Stats.prototype.setManifestTime=function(e){this.manifestTimeSeconds_=e},shaka.util.Stats.prototype.setCompletionPercent=function(e){isNaN(this.completionPercent_)?this.completionPercent_=e:this.completionPercent_=Math.max(this.completionPercent_,e)},shaka.util.Stats.prototype.setDrmTime=function(e){this.drmTimeSeconds_=e},shaka.util.Stats.prototype.setLicenseTime=function(e){this.licenseTimeSeconds_=e},shaka.util.Stats.prototype.setLiveLatency=function(e){this.liveLatencySeconds_=e},shaka.util.Stats.prototype.setMaxSegmentDuration=function(e){this.maxSegmentDurationSeconds_=e},shaka.util.Stats.prototype.setCurrentStreamBandwidth=function(e){this.currentStreamBandwidth_=e},shaka.util.Stats.prototype.setBandwidthEstimate=function(e){this.bandwidthEstimate_=e},shaka.util.Stats.prototype.setManifestSize=function(e){this.manifestSizeBytes_=e},shaka.util.Stats.prototype.addBytesDownloaded=function(e){isNaN(this.bytesDownloaded_)?this.bytesDownloaded_=e:this.bytesDownloaded_+=e},shaka.util.Stats.prototype.addNonFatalError=function(){this.nonFatalErrorCount_++},shaka.util.Stats.prototype.setManifestPeriodCount=function(e){this.manifestPeriodCount_=e},shaka.util.Stats.prototype.setManifestGapCount=function(e){this.manifestGapCount_=e},shaka.util.Stats.prototype.getStateHistory=function(){return this.stateHistory_},shaka.util.Stats.prototype.getSwitchHistory=function(){return this.switchHistory_},shaka.util.Stats.prototype.getBlob=function(){return{width:this.width_,height:this.height_,streamBandwidth:this.currentStreamBandwidth_,decodedFrames:this.totalDecodedFrames_,droppedFrames:this.totalDroppedFrames_,corruptedFrames:this.totalCorruptedFrames_,stallsDetected:this.totalStallsDetected_,gapsJumped:this.totalGapsJumped_,estimatedBandwidth:this.bandwidthEstimate_,completionPercent:this.completionPercent_,loadLatency:this.loadLatencySeconds_,manifestTimeSeconds:this.manifestTimeSeconds_,drmTimeSeconds:this.drmTimeSeconds_,playTime:this.stateHistory_.getTimeSpentIn("playing"),pauseTime:this.stateHistory_.getTimeSpentIn("paused"),bufferingTime:this.stateHistory_.getTimeSpentIn("buffering"),licenseTime:this.licenseTimeSeconds_,liveLatency:this.liveLatencySeconds_,maxSegmentDuration:this.maxSegmentDurationSeconds_,manifestSizeBytes:this.manifestSizeBytes_,bytesDownloaded:this.bytesDownloaded_,nonFatalErrorCount:this.nonFatalErrorCount_,manifestPeriodCount:this.manifestPeriodCount_,manifestGapCount:this.manifestGapCount_,stateHistory:this.stateHistory_.getCopy(),switchHistory:this.switchHistory_.getCopy()}},shaka.util.Stats.getEmptyBlob=function(){return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,manifestSizeBytes:NaN,bytesDownloaded:NaN,nonFatalErrorCount:NaN,manifestPeriodCount:NaN,manifestGapCount:NaN,switchHistory:[],stateHistory:[]}},shaka.media.PreloadManager=function(e,t,r,n){shaka.util.FakeEventTarget.call(this),this.assetUri_=e,this.mimeType_=t,this.networkingEngine_=n.networkingEngine,this.startTime_=r,this.currentAdaptationSetCriteria_=null,this.startTimeOfDrm_=0,this.createDrmEngine_=n.createDrmEngine,this.manifestFilterer_=n.manifestFilterer,this.manifestPlayerInterface_=n.manifestPlayerInterface,this.config_=n.config,this.parser_=this.parserFactory_=this.manifest_=null,this.parserEntrusted_=!1,this.regionTimeline_=n.regionTimeline,this.regionTimelineEntrusted_=!1,this.drmEngine_=null,this.drmEngineEntrusted_=!1,this.abrManager_=this.abrManagerFactory_=null,this.abrManagerEntrusted_=!1,this.segmentPrefetchById_=new Map,this.segmentPrefetchEntrusted_=!1,this.qualityObserver_=n.qualityObserver,this.stats_=new shaka.util.Stats,this.manifestPromise_=new shaka.util.PublicPromise,this.successPromise_=new shaka.util.PublicPromise,this.eventHandoffTarget_=null,this.destroyed_=!1,this.allowPrefetch_=n.allowPrefetch,this.prefetchedTextStream_=this.prefetchedVariant_=null,this.allowMakeAbrManager_=n.allowMakeAbrManager,this.hasBeenAttached_=!1,this.queuedOperations_=[],this.latePhaseQueuedOperations_=[],this.isPreload_=!0},$jscomp.inherits(shaka.media.PreloadManager,shaka.util.FakeEventTarget),shaka.media.PreloadManager.prototype.markIsLoad=function(){this.isPreload_=!1},shaka.media.PreloadManager.prototype.addQueuedOperation=function(e,t){(e=e?this.latePhaseQueuedOperations_:this.queuedOperations_)?e.push(t):t()},shaka.media.PreloadManager.prototype.stopQueuingLatePhaseQueuedOperations=function(){if(this.latePhaseQueuedOperations_)for(var e=$jscomp.makeIterator(this.latePhaseQueuedOperations_),t=e.next();!t.done;t=e.next())(t=t.value)();this.latePhaseQueuedOperations_=null},shaka.media.PreloadManager.prototype.setEventHandoffTarget=function(e){if(this.eventHandoffTarget_=e,this.hasBeenAttached_=!0,this.queuedOperations_)for(var t=(e=$jscomp.makeIterator(this.queuedOperations_)).next();!t.done;t=e.next())(t=t.value)();this.queuedOperations_=null},shaka.media.PreloadManager.prototype.setOffsetToStartTime=function(e){this.startTime_&&e&&(this.startTime_+=e)},shaka.media.PreloadManager.prototype.getStartTime=function(){return this.startTime_},shaka.media.PreloadManager.prototype.getStartTimeOfDRM=function(){return this.startTimeOfDrm_},shaka.media.PreloadManager.prototype.getMimeType=function(){return this.mimeType_},shaka.media.PreloadManager.prototype.getAssetUri=function(){return this.assetUri_},shaka.media.PreloadManager.prototype.getManifest=function(){return this.manifest_},shaka.media.PreloadManager.prototype.getParserFactory=function(){return this.parserFactory_},shaka.media.PreloadManager.prototype.getCurrentAdaptationSetCriteria=function(){return this.currentAdaptationSetCriteria_},shaka.media.PreloadManager.prototype.getAbrManagerFactory=function(){return this.abrManagerFactory_},shaka.media.PreloadManager.prototype.receiveAbrManager=function(){return this.abrManagerEntrusted_=!0,this.abrManager_},shaka.media.PreloadManager.prototype.getAbrManager=function(){return this.abrManager_},shaka.media.PreloadManager.prototype.receiveParser=function(){return this.parserEntrusted_=!0,this.parser_},shaka.media.PreloadManager.prototype.getParser=function(){return this.parser_},shaka.media.PreloadManager.prototype.receiveRegionTimeline=function(){return this.regionTimelineEntrusted_=!0,this.regionTimeline_},shaka.media.PreloadManager.prototype.getRegionTimeline=function(){return this.regionTimeline_},shaka.media.PreloadManager.prototype.getQualityObserver=function(){return this.qualityObserver_},shaka.media.PreloadManager.prototype.getStats=function(){return this.stats_},shaka.media.PreloadManager.prototype.getManifestFilterer=function(){return this.manifestFilterer_},shaka.media.PreloadManager.prototype.receiveDrmEngine=function(){return this.drmEngineEntrusted_=!0,this.drmEngine_},shaka.media.PreloadManager.prototype.getDrmEngine=function(){return this.drmEngine_},shaka.media.PreloadManager.prototype.getPrefetchedVariant=function(){return this.prefetchedVariant_},shaka.media.PreloadManager.prototype.getPrefetchedVariantTrack=function(){return this.prefetchedVariant_?shaka.util.StreamUtils.variantToTrack(this.prefetchedVariant_):null},shaka.media.PreloadManager.prototype.getPrefetchedTextTrack=function(){return this.prefetchedTextStream_?shaka.util.StreamUtils.textStreamToTrack(this.prefetchedTextStream_):null},shaka.media.PreloadManager.prototype.receiveSegmentPrefetchesById=function(){return this.segmentPrefetchEntrusted_=!0,this.segmentPrefetchById_},shaka.media.PreloadManager.prototype.attachAbrManager=function(e,t){this.abrManager_=e,this.abrManagerFactory_=t},shaka.media.PreloadManager.prototype.attachAdaptationSetCriteria=function(e){this.currentAdaptationSetCriteria_=e},shaka.media.PreloadManager.prototype.attachManifest=function(e,t,r){this.manifest_=e,this.parser_=t,this.parserFactory_=r},shaka.media.PreloadManager.prototype.start=function(){var e,t=this;$jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:return r.yield(Promise.resolve(),2);case 2:return r.setCatchFinallyBlocks(3),r.yield(t.parseManifestInner_(),5);case 5:if(t.throwIfDestroyed_(),shaka.drm.DrmUtils.isMediaKeysPolyfilled("webkit")){r.jumpTo(6);break}return r.yield(t.initializeDrm(),7);case 7:t.throwIfDestroyed_();case 6:return r.yield(t.chooseInitialVariantAndPrefetchInner_(),8);case 8:if(t.throwIfDestroyed_(),!t.allowPrefetch_||!t.drmEngine_){r.jumpTo(9);break}return r.yield(t.drmEngine_.waitForActiveRequests(),10);case 10:t.throwIfDestroyed_();case 9:t.successPromise_.resolve(),r.leaveTryBlock(0);break;case 3:(e=r.enterCatchBlock())instanceof shaka.util.Error&&(e.code==shaka.util.Error.Code.OPERATION_ABORTED||e.code==shaka.util.Error.Code.OBJECT_DESTROYED)||t.successPromise_.reject(e),r.jumpToEnd()}}))},shaka.media.PreloadManager.prototype.dispatchEvent=function(e){return this.eventHandoffTarget_?this.eventHandoffTarget_.dispatchEvent(e):shaka.util.FakeEventTarget.prototype.dispatchEvent.call(this,e)},shaka.media.PreloadManager.prototype.onError=function(e){e.severity===shaka.util.Error.Severity.CRITICAL&&(this.successPromise_.reject(e),this.destroy());var t=this.makeEvent_(shaka.util.FakeEvent.EventName.Error,(new Map).set("detail",e));this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)},shaka.media.PreloadManager.prototype.throwIfDestroyed_=function(){if(this.isDestroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OBJECT_DESTROYED)},shaka.media.PreloadManager.prototype.makeStateChangeEvent_=function(e){this.dispatchEvent(new shaka.util.FakeEvent(shaka.util.FakeEvent.EventName.OnStateChange,(new Map).set("state",e)))},shaka.media.PreloadManager.prototype.makeEvent_=function(e,t){return new shaka.util.FakeEvent(e,t)},shaka.media.PreloadManager.prototype.parseManifestInner_=function(){var e,t,r,n,a,i,s,o,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:if(u.makeStateChangeEvent_("manifest-parser"),u.parser_||(u.parserFactory_=shaka.media.ManifestParser.getFactory(u.assetUri_,u.mimeType_),goog.asserts.assert(u.parserFactory_,"Must have manifest parser"),u.parser_=u.parserFactory_(),u.parser_.configure(u.config_.manifest,(function(){return u.isPreload_}))),e=Date.now()/1e3,u.makeStateChangeEvent_("manifest"),u.manifest_){c.jumpTo(2);break}return c.yield(u.parser_.start(u.assetUri_,u.manifestPlayerInterface_),3);case 3:if(u.manifest_=c.yieldResult,1!=u.manifest_.variants.length){c.jumpTo(2);break}for(t=[],r=u.manifest_.variants[0],n=$jscomp.makeIterator([r.video,r.audio]),a=n.next();!a.done;a=n.next())(i=a.value)&&!i.segmentIndex&&t.push(i.createSegmentIndex());if(!(0<t.length)){c.jumpTo(2);break}return c.yield(Promise.all(t),2);case 2:return u.manifestPromise_.resolve(),s=u.makeEvent_(shaka.util.FakeEvent.EventName.ManifestParsed),c.yield(Promise.resolve(),7);case 7:if(u.dispatchEvent(s),0==u.manifest_.variants.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.NO_VARIANTS);shaka.media.PreloadManager.filterForAVVariants_(u.manifest_),o=Date.now()/1e3,l=o-e,u.stats_.setManifestTime(l),c.jumpToEnd()}}))},shaka.media.PreloadManager.prototype.initializeDrm=function(e){var t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:if(!i.manifest_||i.drmEngine_)return s.return();if(i.makeStateChangeEvent_("drm-engine"),i.startTimeOfDrm_=Date.now()/1e3,i.drmEngine_=i.createDrmEngine_(),i.manifestFilterer_.setDrmEngine(i.drmEngine_),i.drmEngine_.configure(i.config_.drm,(function(){return i.isPreload_})),!i.manifestFilterer_.applyRestrictions(i.manifest_)){s.jumpTo(2);break}return t=i.makeEvent_(shaka.util.FakeEvent.EventName.TracksChanged),s.yield(Promise.resolve(),3);case 3:i.throwIfDestroyed_(),i.dispatchEvent(t);case 2:return r=shaka.util.StreamUtils.getPlayableVariants(i.manifest_.variants),n=!0,i.manifest_&&i.manifest_.presentationTimeline&&i.manifest_.type!=shaka.media.ManifestParser.HLS&&(n=i.manifest_.presentationTimeline.isLive()),s.yield(i.drmEngine_.initForPlayback(r,i.manifest_.offlineSessionIds,n),4);case 4:if(i.throwIfDestroyed_(),!e){s.jumpTo(5);break}return s.yield(i.drmEngine_.attach(e),6);case 6:i.throwIfDestroyed_();case 5:return s.yield(i.manifestFilterer_.filterManifest(i.manifest_),7);case 7:if(!s.yieldResult){s.jumpTo(0);break}return a=i.makeEvent_(shaka.util.FakeEvent.EventName.TracksChanged),s.yield(Promise.resolve(),9);case 9:i.dispatchEvent(a),s.jumpToEnd()}}))},shaka.media.PreloadManager.prototype.reconfigure=function(e){this.config_=e},shaka.media.PreloadManager.prototype.configure=function(e,t){e=shaka.util.ConfigUtils.convertToConfigObject(e,t),shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,e)},shaka.media.PreloadManager.prototype.getConfiguration=function(){return shaka.util.ObjectUtils.cloneObject(this.config_)},shaka.media.PreloadManager.prototype.chooseInitialVariantAndPrefetchInner_=function(){var e,t,r,n,a,i,s,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return goog.asserts.assert(o.manifest_,"The manifest should already be parsed."),o.currentAdaptationSetCriteria_||(o.currentAdaptationSetCriteria_=o.config_.adaptationSetCriteriaFactory(),o.currentAdaptationSetCriteria_.configure({language:o.config_.preferredAudioLanguage,role:o.config_.preferredVariantRole,channelCount:o.config_.preferredAudioChannelCount,hdrLevel:o.config_.preferredVideoHdrLevel,spatialAudio:o.config_.preferSpatialAudio,videoLayout:o.config_.preferredVideoLayout,audioLabel:o.config_.preferredAudioLabel,videoLabel:o.config_.preferredVideoLabel,codecSwitchingStrategy:o.config_.mediaSource.codecSwitchingStrategy,audioCodec:""})),o.allowMakeAbrManager_&&(e=o.config_.abrFactory,o.abrManagerFactory_=e,o.abrManager_=e(),o.abrManager_.configure(o.config_.abr)),o.allowPrefetch_?(t=o.manifest_.presentationTimeline.isLive(),r=shaka.util.StreamUtils.getPlayableVariants(o.manifest_.variants),n=o.currentAdaptationSetCriteria_.create(r),o.abrManager_.configure(o.config_.abr),o.abrManager_.setVariants(Array.from(n.values())),(a=o.abrManager_.chooseVariant())?(i=[],o.prefetchedVariant_=a,a.video&&i.push(o.prefetchStream_(a.video,t)),a.audio&&i.push(o.prefetchStream_(a.audio,t)),(s=o.chooseTextStream_())&&shaka.util.StreamUtils.shouldInitiallyShowText(a.audio,s,o.config_)&&(i.push(o.prefetchStream_(s,t)),o.prefetchedTextStream_=s),l.yield(Promise.all(i),0)):l.jumpTo(0)):l.jumpTo(0)}))},shaka.media.PreloadManager.prototype.chooseTextStream_=function(){return shaka.util.StreamUtils.filterStreamsByLanguageAndRole(this.manifest_.textStreams,this.config_.preferredTextLanguage,this.config_.preferredTextRole,this.config_.preferForcedSubs)[0]||null},shaka.media.PreloadManager.prototype.prefetchStream_=function(e,t){var r,n,a,i,s,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return 1==l.nextAddress?(r=o.config_.streaming.segmentPrefetchLimit||2,n=new shaka.media.SegmentPrefetch(r,e,(function(e,t,r){return shaka.media.StreamingEngine.dispatchFetch(e,t,r||null,o.config_.streaming.retryParameters,o.networkingEngine_,o.isPreload_)}),!1),o.segmentPrefetchById_.set(e.id,n),e.segmentIndex?l.jumpTo(2):l.yield(e.createSegmentIndex(),2)):(a=o.startTime_||0,i=e.segmentIndex.getIteratorForTime(a),s=null,i&&((s=i.current())||(s=i.next().value)),s||(s=e.segmentIndex.earliestReference()),s?t?s.initSegmentReference?l.yield(n.prefetchInitSegment(s.initSegmentReference),0):l.jumpTo(0):l.yield(n.prefetchSegmentsByTime(s.startTime),0):l.jumpTo(0))}))},shaka.media.PreloadManager.prototype.waitForFinish=function(){return this.successPromise_},shaka.media.PreloadManager.prototype.waitForManifest=function(){return Promise.race([this.manifestPromise_,this.successPromise_])},shaka.media.PreloadManager.prototype.destroy=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){switch(n.nextAddress){case 1:if(r.destroyed_=!0,!r.parser_||r.parserEntrusted_){n.jumpTo(2);break}return n.yield(r.parser_.stop(),2);case 2:if(!r.abrManager_||r.abrManagerEntrusted_){n.jumpTo(4);break}return n.yield(r.abrManager_.stop(),4);case 4:if(r.regionTimeline_&&!r.regionTimelineEntrusted_&&r.regionTimeline_.release(),!r.drmEngine_||r.drmEngineEntrusted_){n.jumpTo(6);break}return n.yield(r.drmEngine_.destroy(),6);case 6:if(0<r.segmentPrefetchById_.size&&!r.segmentPrefetchEntrusted_)for(e=$jscomp.makeIterator(r.segmentPrefetchById_.values()),t=e.next();!t.done;t=e.next())t.value.clearAll();n.jumpToEnd()}}))},shaka.media.PreloadManager.prototype.isDestroyed=function(){return this.destroyed_},shaka.media.PreloadManager.prototype.hasBeenAttached=function(){return this.hasBeenAttached_},shaka.media.PreloadManager.filterForAVVariants_=function(e){var t=function(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")};e.variants.some(t)&&(shaka.log.debug("Found variant with audio and video content, so filtering out audio-only content."),e.variants=e.variants.filter(t))},goog.exportSymbol("shaka.media.PreloadManager",shaka.media.PreloadManager),goog.exportProperty(shaka.media.PreloadManager.prototype,"destroy",shaka.media.PreloadManager.prototype.destroy),goog.exportProperty(shaka.media.PreloadManager.prototype,"waitForFinish",shaka.media.PreloadManager.prototype.waitForFinish),goog.exportProperty(shaka.media.PreloadManager.prototype,"getPrefetchedTextTrack",shaka.media.PreloadManager.prototype.getPrefetchedTextTrack),goog.exportProperty(shaka.media.PreloadManager.prototype,"getPrefetchedVariantTrack",shaka.media.PreloadManager.prototype.getPrefetchedVariantTrack),shaka.media.RegionObserver=function(e,t){shaka.util.FakeEventTarget.call(this);var r=this;this.timeline_=e,this.startsPastZero_=t,this.oldPosition_=new Map;var n=shaka.media.RegionObserver.RelativePosition_;e=n.BEFORE_THE_REGION,t=n.IN_THE_REGION,n=n.AFTER_THE_REGION,this.rules_=[{weWere:null,weAre:t,invoke:function(e,t){return r.onEvent_("enter",e,t)}},{weWere:e,weAre:t,invoke:function(e,t){return r.onEvent_("enter",e,t)}},{weWere:n,weAre:t,invoke:function(e,t){return r.onEvent_("enter",e,t)}},{weWere:t,weAre:e,invoke:function(e,t){return r.onEvent_("exit",e,t)}},{weWere:t,weAre:n,invoke:function(e,t){return r.onEvent_("exit",e,t)}},{weWere:e,weAre:n,invoke:function(e,t){t?r.onEvent_("skip",e,t):(r.onEvent_("enter",e,t),r.onEvent_("exit",e,t))}},{weWere:n,weAre:e,invoke:function(e,t){return r.onEvent_("skip",e,t)}}],this.eventManager_=new shaka.util.EventManager,this.eventManager_.listen(this.timeline_,"regionremove",(function(e){r.oldPosition_.delete(e.region)}))},$jscomp.inherits(shaka.media.RegionObserver,shaka.util.FakeEventTarget),shaka.media.RegionObserver.prototype.release=function(){this.timeline_=null,this.oldPosition_.clear(),this.eventManager_.release(),this.eventManager_=null,shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.media.RegionObserver.prototype.poll=function(e,t){var r=shaka.media.RegionObserver;if(!this.startsPastZero_||0!=e){this.startsPastZero_=!1;for(var n=$jscomp.makeIterator(this.timeline_.regions()),a=n.next();!a.done;a=n.next()){a=a.value;var i=this.oldPosition_.get(a),s=r.determinePositionRelativeTo_(a,e);this.oldPosition_.set(a,s);for(var o=$jscomp.makeIterator(this.rules_),l=o.next();!l.done;l=o.next())(l=l.value).weWere==i&&l.weAre==s&&l.invoke(a,t)}}},shaka.media.RegionObserver.prototype.onEvent_=function(e,t,r){e=new shaka.util.FakeEvent(e,new Map([["region",t],["seeking",r]])),this.dispatchEvent(e)},shaka.media.RegionObserver.determinePositionRelativeTo_=function(e,t){var r=shaka.media.RegionObserver.RelativePosition_;return t<e.startTime?r.BEFORE_THE_REGION:t>e.endTime?r.AFTER_THE_REGION:r.IN_THE_REGION},shaka.media.RegionObserver.RelativePosition_={BEFORE_THE_REGION:1,IN_THE_REGION:2,AFTER_THE_REGION:3},shaka.net.NetworkingUtils=function(){},shaka.net.NetworkingUtils.getMimeType=function(e,t,r){var n,a,i,s,o,l,u;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:return n=shaka.net.NetworkingUtils.getExtension_(e),(a=shaka.net.NetworkingUtils.EXTENSIONS_TO_MIME_TYPES_.get(n))?c.return(a):(i=shaka.net.NetworkingEngine.RequestType.MANIFEST,s=shaka.net.NetworkingEngine.makeRequest([e],r),c.setCatchFinallyBlocks(2),s.method="HEAD",c.yield(t.request(i,s).promise,4));case 4:o=c.yieldResult,a=o.headers["content-type"],c.leaveTryBlock(3);break;case 2:if(!(l=c.enterCatchBlock())||l.code!=shaka.util.Error.Code.HTTP_ERROR&&l.code!=shaka.util.Error.Code.BAD_HTTP_STATUS){c.jumpTo(3);break}return s.method="GET",c.yield(t.request(i,s).promise,6);case 6:u=c.yieldResult,a=u.headers["content-type"];case 3:return c.return(a?a.toLowerCase().split(";").shift():"")}}))},shaka.net.NetworkingUtils.getExtension_=function(e){return 1==(e=new goog.Uri(e).getPath().split("/").pop().split(".")).length?"":e.pop().toLowerCase()},shaka.net.NetworkingUtils.EXTENSIONS_TO_MIME_TYPES_=(new Map).set("mp4","video/mp4").set("m4v","video/mp4").set("m4a","audio/mp4").set("webm","video/webm").set("weba","audio/webm").set("mkv","video/webm").set("ts","video/mp2t").set("ogv","video/ogg").set("ogg","audio/ogg").set("mpg","video/mpeg").set("mpeg","video/mpeg").set("mov","video/quicktime").set("m3u8","application/x-mpegurl").set("mpd","application/dash+xml").set("ism","application/vnd.ms-sstr+xml").set("mp3","audio/mpeg").set("aac","audio/aac").set("flac","audio/flac").set("wav","audio/wav").set("sbv","text/x-subviewer").set("srt","text/srt").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml").set("lrc","application/x-subtitle-lrc").set("ssa","text/x-ssa").set("ass","text/x-ssa").set("jpeg","image/jpeg").set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif").set("html","text/html").set("htm","text/html"),shaka.text.Utils=function(){},shaka.text.Utils.flattenPayload_=function(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map((function(t){return shaka.text.Utils.flattenPayload_(t,e)})).join("");if(!e.payload)return e.payload;var r=[],n=e.fontWeight>=shaka.text.Cue.fontWeight.BOLD,a=e.fontStyle==shaka.text.Cue.fontStyle.ITALIC,i=e.textDecoration.includes(shaka.text.Cue.textDecoration.UNDERLINE);return n&&r.push(["b"]),a&&r.push(["i"]),i&&r.push(["u"]),""==(a=e.color)&&t&&(a=t.color),n="",(a=shaka.text.Utils.getColorName_(a))&&(n+="."+a),""==(a=e.backgroundColor)&&t&&(a=t.backgroundColor),(t=shaka.text.Utils.getColorName_(a))&&(n+=".bg_"+t),n&&r.push(["c",n]),r.reduceRight((function(e,t){var r=$jscomp.makeIterator(t);return"<"+(t=r.next().value)+(void 0===(r=r.next().value)?"":r)+">"+e+"</"+t+">"}),e.payload)},shaka.text.Utils.getColorName_=function(e){var t=(e=e.toLowerCase()).replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(256|parseInt(t[1],10)).toString(16).slice(1)+(256|parseInt(t[2],10)).toString(16).slice(1)+(256|parseInt(t[3],10)).toString(16).slice(1):e.startsWith("#")&&7<e.length&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null},shaka.text.Utils.getCuesToFlatten=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(shaka.text.Utils.removeDuplicates(e))).next();!n.done;n=e.next())if((n=n.value).isContainer)r.push.apply(r,$jscomp.arrayFromIterable(shaka.text.Utils.getCuesToFlatten(n.nestedCues,n)));else{var a=n.clone();a.nestedCues=[],a.payload=shaka.text.Utils.flattenPayload_(n,t),r.push(a)}return r},shaka.text.Utils.removeDuplicates=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next(),n={};!r.done;n={cue$jscomp$15:void 0},r=e.next())n.cue$jscomp$15=r.value,t.some(function(e){return function(t){return shaka.text.Cue.equal(e.cue$jscomp$15,t)}}(n))||t.push(n.cue$jscomp$15);return t},shaka.text.Utils.mapShakaCueToNativeCue=function(e){if(e.startTime>=e.endTime)return shaka.log.warning("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=shaka.text.Cue,r=new VTTCue(e.startTime,e.endTime,e.payload),n=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()};r.id=n(e.startTime.toString())+n(e.endTime.toString())+n(e.payload),r.lineAlign=e.lineAlign,r.positionAlign=e.positionAlign,e.size&&(r.size=e.size);try{r.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=r.align&&(r.align="middle"),e.writingMode==t.writingMode.VERTICAL_LEFT_TO_RIGHT?r.vertical="lr":e.writingMode==t.writingMode.VERTICAL_RIGHT_TO_LEFT&&(r.vertical="rl"),e.lineInterpretation==t.lineInterpretation.PERCENTAGE&&(r.snapToLines=!1),null!=e.line&&(r.line=e.line),null!=e.position&&(r.position=e.position),r},shaka.text.Utils.mapNativeCueToShakaCue=function(e){if(1/0===e.endTime||e.endTime<e.startTime)return null;var t=new shaka.text.Cue(e.startTime,e.endTime,e.text);return t.line="number"==typeof e.line?e.line:null,e.lineAlign&&(t.lineAlign=e.lineAlign),t.lineInterpretation=e.snapToLines?shaka.text.Cue.lineInterpretation.LINE_NUMBER:shaka.text.Cue.lineInterpretation.PERCENTAGE,t.position="number"==typeof e.position?e.position:null,e.positionAlign&&(t.positionAlign=e.positionAlign),t.size=e.size,t.textAlign=e.align,"lr"===e.vertical?t.writingMode=shaka.text.Cue.writingMode.VERTICAL_LEFT_TO_RIGHT:"rl"===e.vertical&&(t.writingMode=shaka.text.Cue.writingMode.VERTICAL_RIGHT_TO_LEFT),e.region&&(t.region.id=e.region.id,t.region.height=e.region.lines,t.region.heightUnits=shaka.text.CueRegion.units.LINES,t.region.regionAnchorX=e.region.regionAnchorX,t.region.regionAnchorY=e.region.regionAnchorY,t.region.scroll=e.region.scroll,t.region.viewportAnchorX=e.region.viewportAnchorX,t.region.viewportAnchorY=e.region.viewportAnchorY,t.region.viewportAnchorUnits=shaka.text.CueRegion.units.PERCENTAGE,t.region.width=e.region.width,t.region.widthUnits=shaka.text.CueRegion.units.PERCENTAGE),shaka.text.Cue.parseCuePayload(t),t},shaka.text.SimpleTextDisplayer=function(e,t){for(this.video_=e,this.textTrackLabel_=t,this.textTrack_=null,t=(e=$jscomp.makeIterator(Array.from(this.video_.textTracks))).next();!t.done;t=e.next())"metadata"!==(t=t.value).kind&&"chapters"!==t.kind&&(t.mode="disabled",t.label==this.textTrackLabel_&&(this.textTrack_=t));this.textTrack_&&(this.textTrack_.mode="hidden")},shaka.text.SimpleTextDisplayer.prototype.configure=function(e){},shaka.text.SimpleTextDisplayer.prototype.remove=function(e,t){return!!this.textTrack_&&(shaka.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,(function(r){return r.startTime<t&&r.endTime>e})),!0)},shaka.text.SimpleTextDisplayer.prototype.append=function(e){if(this.textTrack_){var t=shaka.text.Utils.getCuesToFlatten(e),r=[];e=this.textTrack_.cues?Array.from(this.textTrack_.cues):[];for(var n=(t=$jscomp.makeIterator(t)).next(),a={};!n.done;a={inCue:void 0},n=t.next())a.inCue=n.value,!e.some(function(e){return function(t){return t.startTime==e.inCue.startTime&&t.endTime==e.inCue.endTime&&t.text==e.inCue.payload}}(a))&&a.inCue.payload&&(n=shaka.text.Utils.mapShakaCueToNativeCue(a.inCue))&&r.push(n);for(e=r.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?r.indexOf(t)-r.indexOf(e):r.indexOf(e)-r.indexOf(t)})),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())this.textTrack_.addCue(t.value)}},shaka.text.SimpleTextDisplayer.prototype.destroy=function(){return this.textTrack_&&(shaka.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,(function(e){return!0})),this.textTrack_.mode="disabled"),this.textTrack_=this.video_=null,Promise.resolve()},shaka.text.SimpleTextDisplayer.prototype.isTextVisible=function(){return!!this.textTrack_&&"showing"==this.textTrack_.mode},shaka.text.SimpleTextDisplayer.prototype.setTextVisibility=function(e){e&&!this.textTrack_&&this.createTextTrack_(),this.textTrack_&&(this.textTrack_.mode=e?"showing":"hidden")},shaka.text.SimpleTextDisplayer.prototype.setTextLanguage=function(e){},shaka.text.SimpleTextDisplayer.prototype.enableTextDisplayer=function(){this.createTextTrack_()},shaka.text.SimpleTextDisplayer.prototype.createTextTrack_=function(){this.video_&&!this.textTrack_&&(this.textTrack_=this.video_.addTextTrack("subtitles",this.textTrackLabel_),this.textTrack_.mode="hidden")},shaka.text.SimpleTextDisplayer.removeWhere_=function(e,t){var r=e.mode,n="showing"==r?"showing":"hidden";e.mode=n,goog.asserts.assert(e.cues,'Cues should be accessible when mode is set to "'+n+'".');for(var a=(n=$jscomp.makeIterator(Array.from(e.cues))).next();!a.done;a=n.next())(a=a.value)&&t(a)&&e.removeCue(a);e.mode=r},goog.exportSymbol("shaka.text.SimpleTextDisplayer",shaka.text.SimpleTextDisplayer),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"enableTextDisplayer",shaka.text.SimpleTextDisplayer.prototype.enableTextDisplayer),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"setTextLanguage",shaka.text.SimpleTextDisplayer.prototype.setTextLanguage),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"setTextVisibility",shaka.text.SimpleTextDisplayer.prototype.setTextVisibility),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"isTextVisible",shaka.text.SimpleTextDisplayer.prototype.isTextVisible),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"destroy",shaka.text.SimpleTextDisplayer.prototype.destroy),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"append",shaka.text.SimpleTextDisplayer.prototype.append),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"remove",shaka.text.SimpleTextDisplayer.prototype.remove),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"configure",shaka.text.SimpleTextDisplayer.prototype.configure),shaka.text.StubTextDisplayer=function(){},shaka.text.StubTextDisplayer.prototype.configure=function(e){},shaka.text.StubTextDisplayer.prototype.remove=function(e,t){},shaka.text.StubTextDisplayer.prototype.append=function(e){},shaka.text.StubTextDisplayer.prototype.destroy=function(){},shaka.text.StubTextDisplayer.prototype.isTextVisible=function(){return!1},shaka.text.StubTextDisplayer.prototype.setTextVisibility=function(e){},shaka.text.StubTextDisplayer.prototype.setTextLanguage=function(e){},shaka.text.StubTextDisplayer.prototype.enableTextDisplayer=function(){},goog.exportSymbol("shaka.text.StubTextDisplayer",shaka.text.StubTextDisplayer),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"enableTextDisplayer",shaka.text.StubTextDisplayer.prototype.enableTextDisplayer),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"setTextLanguage",shaka.text.StubTextDisplayer.prototype.setTextLanguage),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"setTextVisibility",shaka.text.StubTextDisplayer.prototype.setTextVisibility),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"isTextVisible",shaka.text.StubTextDisplayer.prototype.isTextVisible),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"destroy",shaka.text.StubTextDisplayer.prototype.destroy),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"append",shaka.text.StubTextDisplayer.prototype.append),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"remove",shaka.text.StubTextDisplayer.prototype.remove),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"configure",shaka.text.StubTextDisplayer.prototype.configure),shaka.text.UITextDisplayer=function(e,t){var r=this;goog.asserts.assert(t,"videoContainer should be valid."),document.fullscreenEnabled||shaka.log.alwaysWarn("Using UITextDisplayer in a browser without Fullscreen API support causes subtitles to not be rendered in fullscreen"),this.isTextVisible_=!1,this.cues_=[],this.video_=e,this.videoContainer_=t,this.config_=this.aspectRatio_=null,this.textContainer_=shaka.util.Dom.createHTMLElement("div"),this.textContainer_.classList.add("shaka-text-container"),this.textContainer_.style.textAlign="center",this.textContainer_.style.display="flex",this.textContainer_.style.flexDirection="column",this.textContainer_.style.alignItems="center",this.textContainer_.style.justifyContent="flex-end",this.videoContainer_.appendChild(this.textContainer_),this.captionsTimer_=new shaka.util.Timer((function(){r.video_.paused||r.updateCaptions_()})),this.configureCaptionsTimer_(),this.currentCuesMap_=new Map,this.eventManager_=new shaka.util.EventManager,this.eventManager_.listen(document,"fullscreenchange",(function(){r.updateCaptions_(!0)})),this.eventManager_.listen(this.video_,"seeking",(function(){r.updateCaptions_(!0)})),this.eventManager_.listen(this.video_,"ratechange",(function(){r.configureCaptionsTimer_()})),this.eventManager_.listen(this.video_,"resize",(function(){var e=r.video_,t=e.videoWidth;e=e.videoHeight,r.aspectRatio_=t&&e?t/e:null})),this.resizeObserver_=null,"ResizeObserver"in window&&(this.resizeObserver_=new ResizeObserver((function(){r.updateCaptions_(!0)})),this.resizeObserver_.observe(this.textContainer_)),this.regionElements_=new Map},shaka.text.UITextDisplayer.prototype.configure=function(e){this.config_=e,this.configureCaptionsTimer_(),this.updateCaptions_(!0)},shaka.text.UITextDisplayer.prototype.append=function(e){for(var t=[].concat($jscomp.arrayFromIterable(this.cues_)),r=(e=$jscomp.makeIterator(shaka.text.Utils.removeDuplicates(e))).next(),n={};!r.done;n={cue$jscomp$22:void 0},r=e.next())n.cue$jscomp$22=r.value,t.some(function(e){return function(t){return shaka.text.Cue.equal(t,e.cue$jscomp$22)}}(n))||this.cues_.push(n.cue$jscomp$22);this.cues_.length&&this.configureCaptionsTimer_(),this.updateCaptions_()},shaka.text.UITextDisplayer.prototype.destroy=function(){return this.textContainer_?(this.videoContainer_.removeChild(this.textContainer_),this.textContainer_=null,this.isTextVisible_=!1,this.cues_=[],this.captionsTimer_&&(this.captionsTimer_.stop(),this.captionsTimer_=null),this.currentCuesMap_.clear(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),Promise.resolve()):Promise.resolve()},shaka.text.UITextDisplayer.prototype.remove=function(e,t){if(!this.textContainer_)return!1;var r=this.cues_.length;return this.cues_=this.cues_.filter((function(r){return r.startTime<e||r.endTime>=t})),this.updateCaptions_(r>this.cues_.length),this.cues_.length||this.configureCaptionsTimer_(),!0},shaka.text.UITextDisplayer.prototype.isTextVisible=function(){return this.isTextVisible_},shaka.text.UITextDisplayer.prototype.setTextVisibility=function(e){this.isTextVisible_=e,this.updateCaptions_(!0)},shaka.text.UITextDisplayer.prototype.setTextLanguage=function(e){e&&"und"!=e?this.textContainer_.setAttribute("lang",e):this.textContainer_.setAttribute("lang","")},shaka.text.UITextDisplayer.prototype.enableTextDisplayer=function(){},shaka.text.UITextDisplayer.prototype.configureCaptionsTimer_=function(){this.captionsTimer_&&(this.cues_.length?this.captionsTimer_.tickEvery((this.config_?this.config_.captionsUpdatePeriod:.25)/Math.max(1,Math.abs(this.video_.playbackRate))):this.captionsTimer_.stop())},shaka.text.UITextDisplayer.prototype.isElementUnderTextContainer_=function(e){for(;null!=e;){if(e==this.textContainer_)return!0;e=e.parentElement}return!1},shaka.text.UITextDisplayer.prototype.updateCuesRecursive_=function(e,t,r,n){for(var a=!1,i=[],s=[],o=(e=$jscomp.makeIterator(e)).next();!o.done;o=e.next()){o=o.value,n.push(o);var l=this.currentCuesMap_.get(o),u=o.startTime<=r&&o.endTime>r,c=l?l.wrapper:null;l&&(i.push(l.cueElement),l.regionElement&&i.push(l.regionElement),u||(a=!0,this.currentCuesMap_.delete(o),l=null)),u&&(s.push(o),l?this.isElementUnderTextContainer_(c)||(a=!0):(this.createCue_(o,n),c=(l=this.currentCuesMap_.get(o)).wrapper,a=!0)),0<o.nestedCues.length&&c&&this.updateCuesRecursive_(o.nestedCues,c,r,n),l=n.pop(),goog.asserts.assert(l==o,"Parent cues should be kept in order")}if(a){for(n=(r=$jscomp.makeIterator(i)).next();!n.done;n=r.next())(n=n.value).parentElement&&n.parentElement.removeChild(n);for(s.sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime})),r=(s=$jscomp.makeIterator(s)).next();!r.done;r=s.next())r=this.currentCuesMap_.get(r.value),goog.asserts.assert(r,"cueRegistry should exist."),r.regionElement?(r.regionElement.contains(t)&&r.regionElement.removeChild(t),t.appendChild(r.regionElement),r.regionElement.appendChild(r.cueElement)):t.appendChild(r.cueElement)}},shaka.text.UITextDisplayer.prototype.updateCaptions_=function(e){if(this.textContainer_){var t=this.video_.currentTime;if(!this.isTextVisible_||void 0!==e&&e){for(var r=(e=$jscomp.makeIterator(this.regionElements_.values())).next();!r.done;r=e.next())shaka.util.Dom.removeAllChildren(r.value);shaka.util.Dom.removeAllChildren(this.textContainer_),this.currentCuesMap_.clear(),this.regionElements_.clear()}if(this.isTextVisible_){if(e=new Map,goog.DEBUG)for(var n=(r=$jscomp.makeIterator(this.currentCuesMap_.keys())).next();!n.done;n=r.next())n=n.value,e.set(n,this.currentCuesMap_.get(n));if(this.updateCuesRecursive_(this.cues_,this.textContainer_,t,[]),goog.DEBUG)for(r=(t=$jscomp.makeIterator(e.keys())).next();!r.done;r=t.next())r=r.value,this.currentCuesMap_.has(r)||(r=e.get(r).cueElement,goog.asserts.assert(!r.parentNode,"Cue was not properly removed!"))}}},shaka.text.UITextDisplayer.prototype.generateRegionId_=function(e){var t=shaka.text.CueRegion.units.PERCENTAGE;return e.id+"_"+e.width+"x"+e.height+(e.heightUnits==t?"%":"px")+"-"+e.viewportAnchorX+"x"+e.viewportAnchorY+(e.viewportAnchorUnits==t?"%":"px")},shaka.text.UITextDisplayer.prototype.getRegionElement_=function(e){var t=e.region,r=this.aspectRatio_===4/3?2.5:1.9,n=this.generateRegionId_(t);if(this.regionElements_.has(n))return this.regionElements_.get(n);var a=shaka.util.Dom.createHTMLElement("span"),i=shaka.text.CueRegion.units.LINES,s=shaka.text.CueRegion.units.PERCENTAGE,o=shaka.text.CueRegion.units.PX,l=t.heightUnits==s?"%":"px",u=t.widthUnits==s?"%":"px",c=t.viewportAnchorUnits==s?"%":"px";a.id="shaka-text-region---"+n,a.classList.add("shaka-text-region"),a.style.position="absolute",s=t.height;var d=t.width;return t.heightUnits===i&&(s=5.33*t.height,l="%"),t.widthUnits===i&&(d=t.width*r,u="%"),a.style.height=s+l,a.style.width=d+u,t.viewportAnchorUnits===i?(r=t.viewportAnchorY/75*100,i=t.viewportAnchorX/(this.aspectRatio_===4/3?160:210)*100,r-=t.regionAnchorY*s/100,i-=t.regionAnchorX*d/100,a.style.top=r+"%",a.style.left=i+"%"):(a.style.top=t.viewportAnchorY-t.regionAnchorY*s/100+c,a.style.left=t.viewportAnchorX-t.regionAnchorX*d/100+c),t.heightUnits!==o&&t.widthUnits!==o&&t.viewportAnchorUnits!==o&&(t=parseInt(a.style.top.slice(0,-1),10)||0,s=parseInt(a.style.left.slice(0,-1),10)||0,o=parseInt(a.style.height.slice(0,-1),10)||0,d=parseInt(a.style.width.slice(0,-1),10)||0,s=Math.max(0,Math.min(100-d,s)),a.style.top=Math.max(0,Math.min(100-o,t))+"%",a.style.left=s+"%"),a.style.display="flex",a.style.flexDirection="column",a.style.alignItems="center",a.style.justifyContent=e.displayAlign==shaka.text.Cue.displayAlign.BEFORE?"flex-start":e.displayAlign==shaka.text.Cue.displayAlign.CENTER?"center":"flex-end",this.regionElements_.set(n,a),a},shaka.text.UITextDisplayer.prototype.createCue_=function(e,t){var r=1<t.length,n=r?"span":"div";e.lineBreak&&(n="br"),e.rubyTag&&(n=e.rubyTag),r=!r&&0<e.nestedCues.length;var a=shaka.util.Dom.createHTMLElement(n);"br"!=n&&this.setCaptionStyles_(a,e,t,r),t=null,e.region&&e.region.id&&(t=this.getRegionElement_(e)),n=a,r&&((n=shaka.util.Dom.createHTMLElement("span")).classList.add("shaka-text-wrapper"),n.style.backgroundColor=e.backgroundColor,n.style.lineHeight="normal",a.appendChild(n)),this.currentCuesMap_.set(e,{cueElement:a,wrapper:n,regionElement:t})},shaka.text.UITextDisplayer.prototype.computeCuePositionAlignment_=function(e){var t=shaka.text.Cue,r=e.direction,n=e.positionAlign;return e=e.textAlign,n!==t.positionAlign.AUTO?n:e===t.textAlign.LEFT||e===t.textAlign.START&&r===t.direction.HORIZONTAL_LEFT_TO_RIGHT||e===t.textAlign.END&&r===t.direction.HORIZONTAL_RIGHT_TO_LEFT?t.positionAlign.LEFT:e===t.textAlign.RIGHT||e===t.textAlign.START&&r===t.direction.HORIZONTAL_RIGHT_TO_LEFT||e===t.textAlign.END&&r===t.direction.HORIZONTAL_LEFT_TO_RIGHT?t.positionAlign.RIGHT:t.positionAlign.CENTER},shaka.text.UITextDisplayer.prototype.setCaptionStyles_=function(e,t,r,n){var a=shaka.text.Cue,i=e.style,s=0==t.nestedCues.length,o=1<r.length;i.whiteSpace="pre-wrap";var l=t.payload.replace(/\s+$/g,(function(e){return"".repeat(e.length)}));if(i.webkitTextStrokeColor=t.textStrokeColor,i.webkitTextStrokeWidth=t.textStrokeWidth,i.color=t.color,i.direction=t.direction,i.opacity=t.opacity,i.paddingLeft=shaka.text.UITextDisplayer.convertLengthValue_(t.linePadding,t,this.videoContainer_),i.paddingRight=shaka.text.UITextDisplayer.convertLengthValue_(t.linePadding,t,this.videoContainer_),i.textCombineUpright=t.textCombineUpright,i.textShadow=t.textShadow,t.backgroundImage)i.backgroundImage="url('"+t.backgroundImage+"')",i.backgroundRepeat="no-repeat",i.backgroundSize="contain",i.backgroundPosition="center",t.backgroundColor&&(i.backgroundColor=t.backgroundColor),i.width="100%",i.height="100%";else{if(t.nestedCues.length)var u=e;else u=shaka.util.Dom.createHTMLElement("span"),e.appendChild(u);t.border&&(u.style.border=t.border),n||((e=shaka.text.UITextDisplayer.inheritProperty_(r,(function(e){return e.backgroundColor})))?u.style.backgroundColor=e:l&&(u.style.backgroundColor="rgba(0, 0, 0, 0.8)")),l&&(u.textContent=l)}o&&!r[r.length-1].isContainer?i.display="inline":(i.display="flex",i.flexDirection="column",i.alignItems="center",t.textAlign==a.textAlign.LEFT||t.textAlign==a.textAlign.START?(i.width="100%",i.alignItems="start"):t.textAlign!=a.textAlign.RIGHT&&t.textAlign!=a.textAlign.END||(i.width="100%",i.alignItems="end"),i.justifyContent=t.displayAlign==a.displayAlign.BEFORE?"flex-start":t.displayAlign==a.displayAlign.CENTER?"center":"flex-end"),s||(i.margin="0"),i.fontFamily=t.fontFamily,i.fontWeight=t.fontWeight.toString(),i.fontStyle=t.fontStyle,i.letterSpacing=t.letterSpacing,i.fontSize=shaka.text.UITextDisplayer.convertLengthValue_(t.fontSize,t,this.videoContainer_,this.config_?this.config_.fontScaleFactor:1),null!=(r=t.line)&&((s=t.lineInterpretation)==a.lineInterpretation.LINE_NUMBER&&(s=a.lineInterpretation.PERCENTAGE,o=16,this.aspectRatio_&&1>this.aspectRatio_&&(o=32),r=0>r?100+r/o*100:r/o*100),s==a.lineInterpretation.PERCENTAGE&&(i.position="absolute",t.writingMode==a.writingMode.HORIZONTAL_TOP_TO_BOTTOM?(i.width="100%",t.lineAlign==a.lineAlign.START?i.top=r+"%":t.lineAlign==a.lineAlign.END&&(i.bottom=100-r+"%")):t.writingMode==a.writingMode.VERTICAL_LEFT_TO_RIGHT?(i.height="100%",t.lineAlign==a.lineAlign.START?i.left=r+"%":t.lineAlign==a.lineAlign.END&&(i.right=100-r+"%")):(i.height="100%",t.lineAlign==a.lineAlign.START?i.right=r+"%":t.lineAlign==a.lineAlign.END&&(i.left=100-r+"%")))),i.lineHeight=t.lineHeight,(r=this.computeCuePositionAlignment_(t))==a.positionAlign.LEFT?(i.cssFloat="left",null!==t.position&&(i.position="absolute",t.writingMode==a.writingMode.HORIZONTAL_TOP_TO_BOTTOM?(i.left=t.position+"%",i.width="auto"):i.top=t.position+"%")):r==a.positionAlign.RIGHT?(i.cssFloat="right",null!==t.position&&(i.position="absolute",t.writingMode==a.writingMode.HORIZONTAL_TOP_TO_BOTTOM?(i.right=100-t.position+"%",i.width="auto"):i.bottom=t.position+"%")):null!==t.position&&50!=t.position&&(i.position="absolute",t.writingMode==a.writingMode.HORIZONTAL_TOP_TO_BOTTOM?(i.left=t.position+"%",i.width="auto"):i.top=t.position+"%"),i.textAlign=t.textAlign,i.textDecoration=t.textDecoration.join(" "),i.writingMode=t.writingMode,"writingMode"in document.documentElement.style&&i.writingMode==t.writingMode||(i.webkitWritingMode=t.writingMode),t.size&&(t.writingMode==a.writingMode.HORIZONTAL_TOP_TO_BOTTOM?i.width=t.size+"%":i.height=t.size+"%")},shaka.text.UITextDisplayer.getLengthValueInfo_=function(e){return(e=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(e[1]),unit:e[2]}:null},shaka.text.UITextDisplayer.convertLengthValue_=function(e,t,r,n){n=void 0===n?1:n;var a=shaka.text.UITextDisplayer.getLengthValueInfo_(e);if(!a)return e;switch(e=a.unit,n*=a.value,e){case"%":return shaka.text.UITextDisplayer.getAbsoluteLengthInPixels_(n/100,t,r);case"c":return shaka.text.UITextDisplayer.getAbsoluteLengthInPixels_(n,t,r);default:return n+e}},shaka.text.UITextDisplayer.getAbsoluteLengthInPixels_=function(e,t,r){return r.clientHeight*e/t.cellResolution.rows+"px"},shaka.text.UITextDisplayer.inheritProperty_=function(e,t){for(var r=e.length-1;0<=r;r--){var n=t(e[r]);if(n||0===n)return n}return null},goog.exportSymbol("shaka.text.UITextDisplayer",shaka.text.UITextDisplayer),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"enableTextDisplayer",shaka.text.UITextDisplayer.prototype.enableTextDisplayer),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"setTextLanguage",shaka.text.UITextDisplayer.prototype.setTextLanguage),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"setTextVisibility",shaka.text.UITextDisplayer.prototype.setTextVisibility),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"isTextVisible",shaka.text.UITextDisplayer.prototype.isTextVisible),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"remove",shaka.text.UITextDisplayer.prototype.remove),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"destroy",shaka.text.UITextDisplayer.prototype.destroy),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"append",shaka.text.UITextDisplayer.prototype.append),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"configure",shaka.text.UITextDisplayer.prototype.configure),shaka.text.WebVttGenerator=function(){},shaka.text.WebVttGenerator.convert=function(e,t){var r=function(e){for(var r=e,n=$jscomp.makeIterator(t),a=n.next();!a.done;a=n.next())(a=a.value).end&&a.start<e&&(r+=a.end-a.start);return(10>(e=Math.floor(r/3600))?"0":"")+e+":"+(10>(n=Math.floor(r/60%60))?"0":"")+n+":"+(10>(a=Math.floor(r%60))?"0":"")+a+"."+(100>(r=Math.floor(1e3*r%1e3))?10>r?"00":"0":"")+r},n=shaka.text.Utils.getCuesToFlatten(e);e="WEBVTT\n\n";for(var a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next())e+=r((a=a.value).startTime)+" --\x3e "+r(a.endTime)+function(e){var t=[],r=shaka.text.Cue;switch(e.textAlign){case r.textAlign.LEFT:t.push("align:left");break;case r.textAlign.RIGHT:t.push("align:right");break;case r.textAlign.CENTER:t.push("align:middle");break;case r.textAlign.START:t.push("align:start");break;case r.textAlign.END:t.push("align:end")}switch(e.writingMode){case r.writingMode.VERTICAL_LEFT_TO_RIGHT:t.push("vertical:lr");break;case r.writingMode.VERTICAL_RIGHT_TO_LEFT:t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(a)+"\n",e+=a.payload+"\n\n";return e},goog.exportSymbol("shaka.text.WebVttGenerator",shaka.text.WebVttGenerator),shaka.util.CmcdManager=function(e,t){this.playerInterface_=e,this.config_=t,this.sf_=void 0,this.playbackStarted_=!1,this.buffering_=!0,this.lowLatency_=this.starved_=!1,this.playbackPlayingTime_=this.playbackPlayTime_=void 0,this.startTimeOfLoad_=0,this.msdSent_=!1,this.eventManager_=new shaka.util.EventManager,this.video_=null},shaka.util.CmcdManager.prototype.setMediaElement=function(e){this.video_=e,this.setupMSDEventListeners_()},shaka.util.CmcdManager.prototype.configure=function(e){this.config_=e},shaka.util.CmcdManager.prototype.reset=function(){this.playbackStarted_=!1,this.buffering_=!0,this.lowLatency_=this.starved_=!1,this.startTimeOfLoad_=this.playbackPlayingTime_=this.playbackPlayTime_=0,this.msdSent_=!1,this.video_=null,this.eventManager_.removeAll()},shaka.util.CmcdManager.prototype.setBuffering=function(e){e||this.playbackStarted_||(this.playbackStarted_=!0),this.playbackStarted_&&e&&(this.starved_=!0),this.buffering_=e},shaka.util.CmcdManager.prototype.setLowLatency=function(e){this.lowLatency_=e,e=shaka.util.CmcdManager.StreamingFormat,this.lowLatency_?this.sf_==e.DASH?this.sf_=e.LOW_LATENCY_DASH:this.sf_==e.HLS&&(this.sf_=e.LOW_LATENCY_HLS):this.sf_==e.LOW_LATENCY_DASH?this.sf_=e.DASH:this.sf_==e.LOW_LATENCY_HLS&&(this.sf_=e.HLS)},shaka.util.CmcdManager.prototype.setStartTimeOfLoad=function(e){var t=this;if(this.config_&&this.config_.enabled&&this.config_.version==shaka.util.CmcdManager.Version.VERSION_2&&this.video_&&this.video_.autoplay){var r=this.video_.play();r&&r.then((function(){t.startTimeOfLoad_=e})).catch((function(e){t.startTimeOfLoad_=0}))}},shaka.util.CmcdManager.prototype.applyData=function(e,t,r){if(r=void 0===r?{}:r,this.config_.enabled)if("HEAD"===t.method)this.apply_(t);else{var n=shaka.net.NetworkingEngine.RequestType,a=shaka.util.CmcdManager.ObjectType;switch(e){case n.MANIFEST:this.applyManifestData(t,r);break;case n.SEGMENT:this.applySegmentData(t,r);break;case n.LICENSE:case n.SERVER_CERTIFICATE:case n.KEY:this.apply_(t,{ot:a.KEY});break;case n.TIMING:this.apply_(t,{ot:a.OTHER})}}},shaka.util.CmcdManager.prototype.applyManifestData=function(e,t){try{this.config_.enabled&&(t.type&&(this.sf_=this.getStreamFormat_(t.type)),this.apply_(e,{ot:shaka.util.CmcdManager.ObjectType.MANIFEST,su:!this.playbackStarted_}))}catch(e){shaka.log.warnOnce("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",e)}},shaka.util.CmcdManager.prototype.applySegmentData=function(e,t){try{if(this.config_.enabled){var r=t.segment,n=0;r&&(n=r.endTime-r.startTime);var a={d:1e3*n,st:this.getStreamType_()};a.ot=this.getObjectType_(t);var i=shaka.util.CmcdManager.ObjectType,s=a.ot===i.VIDEO||a.ot===i.AUDIO||a.ot===i.MUXED||a.ot===i.TIMED_TEXT,o=t.stream;if(o){var l=this.playerInterface_.getPlaybackRate();if(s&&(a.bl=this.getBufferLength_(o.type),a.ot!==i.TIMED_TEXT)){var u=this.getRemainingBufferLength_(o.type);a.dl=l?u/Math.abs(l):u}if(o.bandwidth&&(a.br=o.bandwidth/1e3),o.segmentIndex&&r){var c=o.segmentIndex.getIteratorForTime(r.endTime,!0,0>l);if(c){var d=c.next().value;if(d&&d!=r&&(shaka.util.ArrayUtils.equal(r.getUris(),d.getUris())||(a.nor=this.urlToRelativePath_(d.getUris()[0],e.uris[0])),(d.startByte||d.endByte)&&(r.startByte!=d.startByte||r.endByte!=d.endByte))){var p=d.startByte+"-";d.endByte&&(p+=d.endByte),a.nrr=p}}var h=this.calculateRtp_(o,r);isNaN(h)||(a.rtp=h)}}s&&a.ot!==i.TIMED_TEXT&&(a.tb=this.getTopBandwidth_(a.ot)/1e3),this.apply_(e,a)}}catch(e){shaka.log.warnOnce("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",e)}},shaka.util.CmcdManager.prototype.applyTextData=function(e){try{this.config_.enabled&&this.apply_(e,{ot:shaka.util.CmcdManager.ObjectType.CAPTION,su:!0})}catch(e){shaka.log.warnOnce("CMCD_TEXT_ERROR","Could not generate text CMCD data.",e)}},shaka.util.CmcdManager.prototype.appendSrcData=function(e,t){try{if(!this.config_.enabled)return e;var r=this.createData_();r.ot=this.getObjectTypeFromMimeType_(t),r.su=!0;var n=shaka.util.CmcdManager.toQuery(r);return shaka.util.CmcdManager.appendQueryToUri(e,n)}catch(t){return shaka.log.warnOnce("CMCD_SRC_ERROR","Could not generate src CMCD data.",t),e}},shaka.util.CmcdManager.prototype.appendTextTrackData=function(e){try{if(!this.config_.enabled)return e;var t=this.createData_();t.ot=shaka.util.CmcdManager.ObjectType.CAPTION,t.su=!0;var r=shaka.util.CmcdManager.toQuery(t);return shaka.util.CmcdManager.appendQueryToUri(e,r)}catch(t){return shaka.log.warnOnce("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",t),e}},shaka.util.CmcdManager.prototype.onPlaybackPlay_=function(){this.playbackPlayTime_||(this.playbackPlayTime_=Date.now())},shaka.util.CmcdManager.prototype.onPlaybackPlaying_=function(){this.playbackPlayingTime_||(this.playbackPlayingTime_=Date.now())},shaka.util.CmcdManager.prototype.setupMSDEventListeners_=function(){var e=this;this.eventManager_.listenOnce(this.video_,"play",(function(){return e.onPlaybackPlay_()})),this.eventManager_.listenOnce(this.video_,"playing",(function(){return e.onPlaybackPlaying_()}))},shaka.util.CmcdManager.prototype.createData_=function(){return this.config_.sessionId||(this.config_.sessionId=window.crypto.randomUUID()),{v:this.config_.version,sf:this.sf_,sid:this.config_.sessionId,cid:this.config_.contentId,mtp:this.playerInterface_.getBandwidthEstimate()/1e3}},shaka.util.CmcdManager.prototype.apply_=function(e,t,r){if(t=void 0===t?{}:t,r=void 0===r?this.config_.useHeaders:r,this.config_.enabled){Object.assign(t,this.createData_()),t.pr=this.playerInterface_.getPlaybackRate();var n=t.ot===shaka.util.CmcdManager.ObjectType.VIDEO||t.ot===shaka.util.CmcdManager.ObjectType.MUXED;if(this.starved_&&n&&(t.bs=!0,t.su=!0,this.starved_=!1),null==t.su&&(t.su=this.buffering_),t.v===shaka.util.CmcdManager.Version.VERSION_2&&(this.playerInterface_.isLive()&&(t.ltc=this.playerInterface_.getLiveLatency()),null!=(n=this.calculateMSD_())&&(t.msd=n,this.msdSent_=!0)),t=this.filterKeys_(t),r)r=shaka.util.CmcdManager.toHeaders(t),Object.keys(r).length&&Object.assign(e.headers,r);else{var a=shaka.util.CmcdManager.toQuery(t);a&&(e.uris=e.uris.map((function(e){return shaka.util.CmcdManager.appendQueryToUri(e,a)})))}}},shaka.util.CmcdManager.prototype.filterKeys_=function(e){var t=this.config_.includeKeys;return t.length?Object.keys(e).reduce((function(r,n){return t.includes(n)&&(r[n]=e[n]),r}),{}):e},shaka.util.CmcdManager.prototype.getObjectType_=function(e){if(e.type===shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT)return shaka.util.CmcdManager.ObjectType.INIT;if(e=e.stream){var t=e.type;if("video"==t)return e.codecs&&e.codecs.includes(",")?shaka.util.CmcdManager.ObjectType.MUXED:shaka.util.CmcdManager.ObjectType.VIDEO;if("audio"==t)return shaka.util.CmcdManager.ObjectType.AUDIO;if("text"==t)return"application/mp4"===e.mimeType?shaka.util.CmcdManager.ObjectType.TIMED_TEXT:shaka.util.CmcdManager.ObjectType.CAPTION}},shaka.util.CmcdManager.prototype.getObjectTypeFromMimeType_=function(e){switch(e.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":return shaka.util.CmcdManager.ObjectType.AUDIO;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":return shaka.util.CmcdManager.ObjectType.MUXED;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":return shaka.util.CmcdManager.ObjectType.MANIFEST}},shaka.util.CmcdManager.prototype.getBufferLength_=function(e){if(!(e=this.playerInterface_.getBufferedInfo()[e]).length)return NaN;var t=this.playerInterface_.getCurrentTime();return(e=e.find((function(e){return e.start<=t&&e.end>=t})))?1e3*(e.end-t):NaN},shaka.util.CmcdManager.prototype.getRemainingBufferLength_=function(e){if(!(e=this.playerInterface_.getBufferedInfo()[e]).length)return 0;var t=this.playerInterface_.getCurrentTime();return(e=e.find((function(e){return e.start<=t&&e.end>=t})))?1e3*(e.end-t):0},shaka.util.CmcdManager.prototype.urlToRelativePath_=function(e,t){var r=new URL(e);if(t=new URL(t),r.origin!==t.origin)return e;for(e=r.pathname.split("/").slice(1),r=t.pathname.split("/").slice(1,-1);e[0]===r[0];)e.shift(),r.shift();for(;r.length;)r.shift(),e.unshift("..");return e.join("/")},shaka.util.CmcdManager.prototype.calculateMSD_=function(){if(!this.msdSent_&&this.playbackPlayingTime_&&this.playbackPlayTime_)return this.playbackPlayingTime_-(this.startTimeOfLoad_||this.playbackPlayTime_)},shaka.util.CmcdManager.prototype.calculateRtp_=function(e,t){var r=this.playerInterface_.getPlaybackRate()||1,n=this.getRemainingBufferLength_(e.type)||500;return(e=e.bandwidth)?e*(t.endTime-t.startTime)/1e3/(n/r/1e3)*this.config_.rtpSafetyFactor:NaN},shaka.util.CmcdManager.prototype.getStreamFormat_=function(e){var t=shaka.net.NetworkingEngine.AdvancedRequestType;switch(e){case t.MPD:return this.lowLatency_?shaka.util.CmcdManager.StreamingFormat.LOW_LATENCY_DASH:shaka.util.CmcdManager.StreamingFormat.DASH;case t.MASTER_PLAYLIST:case t.MEDIA_PLAYLIST:return this.lowLatency_?shaka.util.CmcdManager.StreamingFormat.LOW_LATENCY_HLS:shaka.util.CmcdManager.StreamingFormat.HLS;case t.MSS:return shaka.util.CmcdManager.StreamingFormat.SMOOTH}},shaka.util.CmcdManager.prototype.getStreamType_=function(){return this.playerInterface_.isLive()?shaka.util.CmcdManager.StreamType.LIVE:shaka.util.CmcdManager.StreamType.VOD},shaka.util.CmcdManager.prototype.getTopBandwidth_=function(e){var t=this.playerInterface_.getVariantTracks();if(!t.length)return NaN;for(var r=t[0],n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next())"variant"===(n=n.value).type&&n.bandwidth>r.bandwidth&&(r=n);switch(t=shaka.util.CmcdManager.ObjectType,e){case t.VIDEO:return r.videoBandwidth||NaN;case t.AUDIO:return r.audioBandwidth||NaN;default:return r.bandwidth}},shaka.util.CmcdManager.serialize=function(e){var t=[],r=function(e){return Math.round(e)},n=function(e){return 100*r(e/100)};n={br:r,d:r,bl:n,dl:n,mtp:n,nor:function(e){return encodeURIComponent(e)},rtp:n,tb:r};for(var a,i=Object.keys(e||{}).sort(),s=(i=$jscomp.makeIterator(i)).next();!s.done;s=i.next()){var o=e[s=s.value];if(!(a=o,Number.isNaN(a)||null==a||""===a||!1===a||"v"===s&&1===o||"pr"==s&&1===o)){var l=n[s];l&&(o=l(o));var u;u="string"===(l=typeof o)&&"ot"!==s&&"sf"!==s&&"st"!==s?s+"="+JSON.stringify(o):"boolean"===l?s:"symbol"===l?s+"="+o.description:s+"="+o,t.push(u)}}return t.join(",")},shaka.util.CmcdManager.toHeaders=function(e){for(var t=Object.keys(e),r={},n=["Object","Request","Session","Status"],a=[{},{},{},{}],i={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,ltc:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,msd:2,bs:3,rtp:3},s=(t=$jscomp.makeIterator(t)).next();!s.done;s=t.next())a[null!=i[s=s.value]?i[s]:1][s]=e[s];for(e=0;e<a.length;e++)(i=shaka.util.CmcdManager.serialize(a[e]))&&(r["CMCD-"+n[e]]=i);return r},shaka.util.CmcdManager.toQuery=function(e){return shaka.util.CmcdManager.serialize(e)},shaka.util.CmcdManager.appendQueryToUri=function(e,t){return!t||e.includes("offline:")?e:((e=new goog.Uri(e)).getQueryData().set("CMCD",t),e.toString())},shaka.util.CmcdManager.ObjectType={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},shaka.util.CmcdManager.Version={VERSION_1:1,VERSION_2:2},shaka.util.CmcdManager.StreamType={VOD:"v",LIVE:"l"},shaka.util.CmcdManager.StreamingFormat={DASH:"d",LOW_LATENCY_DASH:"ld",HLS:"h",LOW_LATENCY_HLS:"lh",SMOOTH:"s",OTHER:"o"},goog.exportSymbol("shaka.util.CmcdManager.StreamingFormat",shaka.util.CmcdManager.StreamingFormat),shaka.util.CmsdManager=function(e){this.config_=e,this.dynamicParams_=this.staticParams_=null},shaka.util.CmsdManager.prototype.configure=function(e){this.config_=e},shaka.util.CmsdManager.prototype.reset=function(){this.dynamicParams_=this.staticParams_=null},shaka.util.CmsdManager.prototype.processHeaders=function(e){if(this.config_.enabled){var t=shaka.util.CmsdManager,r=e[t.CMSD_STATIC_HEADER_NAME_];r&&(r=this.parseCMSDStatic_(r))&&(this.staticParams_=r),(e=e[t.CMSD_DYNAMIC_HEADER_NAME_])&&(e=this.parseCMSDDynamic_(e))&&(this.dynamicParams_=e)}},shaka.util.CmsdManager.prototype.getMaxBitrate=function(){var e=shaka.util.CmsdManager.KEYS_.MAX_SUGGESTED_BITRATE;return this.config_.enabled&&this.config_.applyMaximumSuggestedBitrate&&this.dynamicParams_&&this.dynamicParams_.has(e)?1e3*this.dynamicParams_.get(e):null},shaka.util.CmsdManager.prototype.getEstimatedThroughput=function(){var e=shaka.util.CmsdManager.KEYS_.ESTIMATED_THROUGHPUT;return this.config_.enabled&&this.dynamicParams_&&this.dynamicParams_.has(e)?1e3*this.dynamicParams_.get(e):null},shaka.util.CmsdManager.prototype.getResponseDelay=function(){var e=shaka.util.CmsdManager.KEYS_.RESPONSE_DELAY;return this.config_.enabled&&this.dynamicParams_&&this.dynamicParams_.has(e)?this.dynamicParams_.get(e):null},shaka.util.CmsdManager.prototype.getRoundTripTime=function(){var e=shaka.util.CmsdManager.KEYS_.ROUND_TRIP_TIME;return this.config_.enabled&&this.dynamicParams_&&this.dynamicParams_.has(e)?this.dynamicParams_.get(e):null},shaka.util.CmsdManager.prototype.getBandwidthEstimate=function(e){var t=this.getEstimatedThroughput();if(!t)return e;var r=this.config_.estimatedThroughputWeightRatio;return 0<r&&1>=r?e*(1-r)+t*r:e},shaka.util.CmsdManager.prototype.parseCMSDStatic_=function(e){try{var t=new Map,r=e.split(",");for(e=0;e<r.length;e++){var n=r[e].split("="),a=n[0],i=this.parseParameterValue_(n[1]);t.set(a,i)}return t}catch(e){return shaka.log.warning("Failed to parse CMSD-Static response header value:",e),null}},shaka.util.CmsdManager.prototype.parseCMSDDynamic_=function(e){try{var t=new Map,r=e.split(";");for(e=1;e<r.length;e++){var n=r[e].split("="),a=n[0],i=this.parseParameterValue_(n[1]);t.set(a,i)}return t}catch(e){return shaka.log.warning("Failed to parse CMSD-Dynamic response header value:",e),null}},shaka.util.CmsdManager.prototype.parseParameterValue_=function(e){return!e||"false"!==e.toLowerCase()&&(/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""))},goog.exportSymbol("shaka.util.CmsdManager",shaka.util.CmsdManager),goog.exportProperty(shaka.util.CmsdManager.prototype,"getBandwidthEstimate",shaka.util.CmsdManager.prototype.getBandwidthEstimate),goog.exportProperty(shaka.util.CmsdManager.prototype,"getRoundTripTime",shaka.util.CmsdManager.prototype.getRoundTripTime),goog.exportProperty(shaka.util.CmsdManager.prototype,"getResponseDelay",shaka.util.CmsdManager.prototype.getResponseDelay),goog.exportProperty(shaka.util.CmsdManager.prototype,"getEstimatedThroughput",shaka.util.CmsdManager.prototype.getEstimatedThroughput),goog.exportProperty(shaka.util.CmsdManager.prototype,"getMaxBitrate",shaka.util.CmsdManager.prototype.getMaxBitrate),shaka.util.CmsdManager.CMSD_STATIC_HEADER_NAME_="cmsd-static",shaka.util.CmsdManager.CMSD_DYNAMIC_HEADER_NAME_="cmsd-dynamic",shaka.util.CmsdManager.KEYS_={AVAILABILITY_TIME:"at",DURESS:"du",ENCODED_BITRATE:"br",ESTIMATED_THROUGHPUT:"etp",HELD_TIME:"ht",INTERMEDIARY_IDENTIFIER:"n",MAX_SUGGESTED_BITRATE:"mb",NEXT_OBJECT_RESPONSE:"nor",NEXT_RANGE_RESPONSE:"nrr",OBJECT_DURATION:"d",OBJECT_TYPE:"ot",RESPONSE_DELAY:"rd",ROUND_TRIP_TIME:"rtt",STARTUP:"su",STREAM_TYPE:"st",STREAMING_FORMAT:"sf",VERSION:"v"},shaka.util.Mutex=function(){this.acquiredIdentifier=null,this.unlockQueue=[]},shaka.util.Mutex.prototype.acquire=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return shaka.log.v2(e+" has requested mutex"),t.acquiredIdentifier?r.yield(new Promise((function(e){return t.unlockQueue.push(e)})),2):r.jumpTo(2);t.acquiredIdentifier=e,shaka.log.v2(e+" has acquired mutex"),r.jumpToEnd()}))},shaka.util.Mutex.prototype.release=function(){shaka.log.v2(this.acquiredIdentifier+" has released mutex"),0<this.unlockQueue.length?this.unlockQueue.shift()():this.acquiredIdentifier=null},shaka.util.Mutex.prototype.releaseAll=function(){for(;this.acquiredIdentifier;)this.release()},shaka.util.NumberUtils=function(){},shaka.util.NumberUtils.isFloatEqual=function(e,t,r){return r=void 0===r?Number.EPSILON:r,e===t||((e=Math.abs(e-t))<=r||r!==Number.EPSILON&&Math.abs(e-r)<=Number.EPSILON)},shaka.Player=function(e,t,r){t=void 0===t?null:t,shaka.util.FakeEventTarget.call(this);var n=this;this.loadMode_=shaka.Player.LoadMode.NOT_LOADED,this.video_=null,this.videoContainer_=t,this.isTextVisible_=!1,this.globalEventManager_=new shaka.util.EventManager,this.attachEventManager_=new shaka.util.EventManager,this.loadEventManager_=new shaka.util.EventManager,this.trickPlayEventManager_=new shaka.util.EventManager,this.adManagerEventManager_=new shaka.util.EventManager,this.playhead_=this.mediaSourceEngine_=this.drmEngine_=this.networkingEngine_=null,this.operationId_=0,this.mutex_=new shaka.util.Mutex,this.startTime_=this.mimeType_=this.assetUri_=this.manifest_=this.parserFactory_=this.parser_=this.streamingEngine_=this.qualityObserver_=this.lcevcDec_=this.lcevcCanvas_=this.cmsdManager_=this.cmcdManager_=this.emsgRegionTimeline_=this.metadataRegionTimeline_=this.regionTimeline_=this.bufferObserver_=this.bufferPoller_=this.playRateController_=this.playheadObservers_=null,this.fullyLoaded_=!1,this.abrManagerFactory_=this.abrManager_=null,this.nextExternalStreamId_=1e9,this.externalSrcEqualsThumbnailsStreams_=[],this.completionPercent_=-1,this.config_=this.defaultConfig_(),this.lowLatencyConfig_=shaka.util.PlayerConfiguration.createDefaultForLL(),this.currentTargetLatency_=null,this.rebufferingCount_=-1,this.targetLatencyReached_=null,this.maxHwRes_={width:1/0,height:1/0},this.manifestFilterer_=new shaka.media.ManifestFilterer(this.config_,this.maxHwRes_,null),this.createdPreloadManagers_=[],this.stats_=null,this.currentAdaptationSetCriteria_=this.config_.adaptationSetCriteriaFactory(),this.currentAdaptationSetCriteria_.configure({language:this.config_.preferredAudioLanguage,role:this.config_.preferredVariantRole,channelCount:this.config_.preferredAudioChannelCount,hdrLevel:this.config_.preferredVideoHdrLevel,spatialAudio:this.config_.preferSpatialAudio,videoLayout:this.config_.preferredVideoLayout,audioLabel:this.config_.preferredAudioLabel,videoLabel:this.config_.preferredVideoLabel,codecSwitchingStrategy:this.config_.mediaSource.codecSwitchingStrategy,audioCodec:""}),this.currentTextLanguage_=this.config_.preferredTextLanguage,this.currentTextRole_=this.config_.preferredTextRole,this.currentTextForced_=this.config_.preferForcedSubs,this.cleanupOnUnload_=[],r&&r(this),this.cmcdManager_=this.createCmcd_(),this.cmsdManager_=this.createCmsd_(),this.networkingEngine_=this.createNetworkingEngine(),this.networkingEngine_.setForceHTTP(this.config_.streaming.forceHTTP),this.networkingEngine_.setForceHTTPS(this.config_.streaming.forceHTTPS),this.networkingEngine_.setMinBytesForProgressEvents(this.config_.streaming.minBytesForProgressEvents),this.preloadDueAdManagerVideo_=this.preloadDueAdManager_=this.adManager_=null,this.preloadDueAdManagerVideoEnded_=!1,this.preloadDueAdManagerTimer_=new shaka.util.Timer((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return 1==e.nextAddress?n.preloadDueAdManager_?(goog.asserts.assert(n.preloadDueAdManagerVideo_,"Must have video"),e.yield(n.attach(n.preloadDueAdManagerVideo_,!0),3)):e.jumpTo(0):4!=e.nextAddress?e.yield(n.load(n.preloadDueAdManager_),4):(n.preloadDueAdManagerVideoEnded_?n.preloadDueAdManagerVideo_.pause():n.preloadDueAdManagerVideo_.play(),n.preloadDueAdManager_=null,n.preloadDueAdManagerVideoEnded_=!1,void e.jumpToEnd())}))})),shaka.Player.adManagerFactory_&&(this.adManager_=shaka.Player.adManagerFactory_(),this.adManager_.configure(this.config_.ads),this.adManagerEventManager_.listen(this.adManager_,"ad-content-pause-requested",(function(e){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return n.preloadDueAdManagerTimer_.stop(),n.preloadDueAdManager_?r.jumpTo(0):(n.preloadDueAdManagerVideo_=n.video_,n.preloadDueAdManagerVideoEnded_=n.isEnded(),t=e.saveLivePosition||!1,r.yield(n.detachAndSavePreload(!0,t),3));n.preloadDueAdManager_=r.yieldResult,r.jumpToEnd()}))})),this.adManagerEventManager_.listen(this.adManager_,"ad-content-resume-requested",(function(e){e=e.offset||0,n.preloadDueAdManager_&&n.preloadDueAdManager_.setOffsetToStartTime(e),n.preloadDueAdManagerTimer_.tickAfter(.1)})),this.adManagerEventManager_.listen(this.adManager_,"ad-content-attach-requested",(function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return n.video_||!n.preloadDueAdManagerVideo_?e.jumpTo(0):(goog.asserts.assert(n.preloadDueAdManagerVideo_,"Must have video"),e.yield(n.attach(n.preloadDueAdManagerVideo_,!0),0))}))}))),this.globalEventManager_.listen(window,"online",(function(){n.restoreDisabledVariants_(),n.retryStreaming()})),this.checkVariantsTimer_=new shaka.util.Timer((function(){return n.checkVariants_()})),this.preloadNextUrl_=null,e&&(shaka.Deprecate.deprecateFeature(5,"Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.attach(e,!0)),this.textDisplayer_=null},$jscomp.inherits(shaka.Player,shaka.util.FakeEventTarget),shaka.Player.prototype.createLcevcDec_=function(e,t){null==this.lcevcDec_&&(this.lcevcDec_=new shaka.lcevc.Dec(this.video_,this.lcevcCanvas_,e,t),this.mediaSourceEngine_&&this.mediaSourceEngine_.updateLcevcDec(this.lcevcDec_))},shaka.Player.prototype.closeLcevcDec_=function(){null!=this.lcevcDec_&&(this.lcevcDec_.hideCanvas(),this.lcevcDec_.release(),this.lcevcDec_=null)},shaka.Player.prototype.setupLcevc_=function(e,t){t||e.lcevc.enabled?(this.closeLcevcDec_(),this.createLcevcDec_(e.lcevc,t)):this.closeLcevcDec_()},shaka.Player.makeEvent_=function(e,t){return new shaka.util.FakeEvent(e,t)},shaka.Player.prototype.destroy=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:return t.loadMode_==shaka.Player.LoadMode.DESTROYED?r.return():(t.closeLcevcDec_(),e=t.detach(),t.loadMode_=shaka.Player.LoadMode.DESTROYED,r.yield(e,2));case 2:return r.yield(t.destroyAllPreloads(),3);case 3:if(t.globalEventManager_&&(t.globalEventManager_.release(),t.globalEventManager_=null),t.attachEventManager_&&(t.attachEventManager_.release(),t.attachEventManager_=null),t.loadEventManager_&&(t.loadEventManager_.release(),t.loadEventManager_=null),t.trickPlayEventManager_&&(t.trickPlayEventManager_.release(),t.trickPlayEventManager_=null),t.adManagerEventManager_&&(t.adManagerEventManager_.release(),t.adManagerEventManager_=null),t.abrManagerFactory_=null,t.config_=null,t.stats_=null,t.videoContainer_=null,t.cmcdManager_=null,t.cmsdManager_=null,!t.networkingEngine_){r.jumpTo(4);break}return r.yield(t.networkingEngine_.destroy(),5);case 5:t.networkingEngine_=null;case 4:t.abrManager_&&(t.abrManager_.release(),t.abrManager_=null),shaka.util.FakeEventTarget.prototype.release.call(t),r.jumpToEnd()}}))},shaka.Player.registerSupportPlugin=function(e,t){shaka.Player.supportPlugins_.set(e,t)},shaka.Player.setAdManagerFactory=function(e){shaka.Player.adManagerFactory_=e},shaka.Player.isBrowserSupported=function(){return window.Promise||shaka.log.alwaysWarn("A Promise implementation or polyfill is required"),!(!(window.Promise&&window.Uint8Array&&Array.prototype.forEach)||shaka.util.Platform.isIE())&&(!!shaka.util.Platform.supportsMediaSource()||shaka.util.Platform.supportsMediaType("application/x-mpegurl"))},shaka.Player.probeSupport=function(e){var t,r,n,a,i;return e=void 0===e||e,$jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:if(goog.asserts.assert(shaka.Player.isBrowserSupported(),"Must have basic support"),t={},!e){s.jumpTo(2);break}return s.yield(shaka.drm.DrmEngine.probeSupport(),3);case 3:t=s.yieldResult;case 2:return r=shaka.media.ManifestParser.probeSupport(),n=shaka.media.MediaSourceEngine.probeSupport(),s.yield(shaka.util.Platform.detectMaxHardwareResolution(),4);case 4:return a=s.yieldResult,i={manifest:r,media:n,drm:t,hardwareResolution:a},shaka.Player.supportPlugins_.forEach((function(e,t){i[t]=e()})),s.return(i)}}))},shaka.Player.prototype.makeStateChangeEvent_=function(e){this.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.OnStateChange,(new Map).set("state",e)))},shaka.Player.prototype.attach=function(e,t){t=void 0===t||t;var r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:if(i.loadMode_==shaka.Player.LoadMode.DESTROYED)throw i.createAbortLoadError_();if(r=i.video_&&i.video_==e,!i.video_||i.video_==e){s.jumpTo(2);break}return s.yield(i.detach(),2);case 2:return s.yield(i.atomicOperationAcquireMutex_("attach"),4);case 4:if(s.yieldResult)return s.return();if(s.setCatchFinallyBlocks(5,6),r||(i.makeStateChangeEvent_("attach"),n=function(e){return i.onVideoError_(e)},i.attachEventManager_.listen(e,"error",n),i.video_=e,i.cmcdManager_&&i.cmcdManager_.setMediaElement(e)),!t||!shaka.util.Platform.supportsMediaSource()||i.mediaSourceEngine_){s.jumpTo(6);break}return s.yield(i.initializeMediaSourceEngineInner_(),6);case 6:s.enterFinallyBlock(),i.mutex_.release(),s.leaveFinallyBlock(0);break;case 5:return a=s.enterCatchBlock(),s.yield(i.detach(),10);case 10:throw a}}))},shaka.Player.prototype.attachCanvas=function(e){this.lcevcCanvas_=e},shaka.Player.prototype.detach=function(e){e=void 0!==e&&e;var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress){if(t.loadMode_==shaka.Player.LoadMode.DESTROYED)throw t.createAbortLoadError_();return r.yield(t.unload(!1,e),2)}if(3!=r.nextAddress)return r.yield(t.atomicOperationAcquireMutex_("detach"),3);if(r.yieldResult)return r.return();try{t.video_&&(t.attachEventManager_.removeAll(),t.video_=null),t.makeStateChangeEvent_("detach"),t.adManager_&&!e&&t.adManager_.release()}finally{t.mutex_.release()}r.jumpToEnd()}))},shaka.Player.prototype.atomicOperationAcquireMutex_=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=++r.operationId_,n.yield(r.mutex_.acquire(e),2)):t!=r.operationId_?(r.mutex_.release(),n.return(!0)):n.return(!1)}))},shaka.Player.prototype.unload=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var r,n,a,i,s,o,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){switch(h.nextAddress){case 1:return p.loadMode_!=shaka.Player.LoadMode.DESTROYED&&(p.loadMode_=shaka.Player.LoadMode.NOT_LOADED),h.yield(p.atomicOperationAcquireMutex_("unload"),2);case 2:return h.yieldResult?h.return():(h.setFinallyBlock(3),p.fullyLoaded_=!1,p.makeStateChangeEvent_("unload"),p.closeLcevcDec_(),r=p.cleanupOnUnload_.map((function(e){return e()})),p.cleanupOnUnload_=[],h.yield(Promise.all(r),5));case 5:if(p.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Unloading)),p.regionTimeline_&&(p.regionTimeline_.release(),p.regionTimeline_=null),p.metadataRegionTimeline_&&(p.metadataRegionTimeline_.release(),p.metadataRegionTimeline_=null),p.emsgRegionTimeline_&&(p.emsgRegionTimeline_.release(),p.emsgRegionTimeline_=null),p.video_&&(p.loadEventManager_.removeAll(),p.trickPlayEventManager_.removeAll()),p.checkVariantsTimer_.stop(),p.playheadObservers_&&(p.playheadObservers_.release(),p.playheadObservers_=null),p.bufferPoller_&&(p.bufferPoller_.stop(),p.bufferPoller_=null),!p.parser_){h.jumpTo(6);break}return h.yield(p.parser_.stop(),7);case 7:p.parser_=null,p.parserFactory_=null;case 6:if(!p.abrManager_){h.jumpTo(8);break}return h.yield(p.abrManager_.stop(),8);case 8:if(!p.streamingEngine_){h.jumpTo(10);break}return h.yield(p.streamingEngine_.destroy(),11);case 11:p.streamingEngine_=null;case 10:if(p.playRateController_&&(p.playRateController_.release(),p.playRateController_=null),p.playhead_&&(p.playhead_.release(),p.playhead_=null),!shaka.drm.DrmUtils.isMediaKeysPolyfilled("webkit")||!p.drmEngine_){h.jumpTo(12);break}return h.yield(p.drmEngine_.destroy(),13);case 13:p.drmEngine_=null;case 12:if(!p.mediaSourceEngine_){h.jumpTo(14);break}return h.yield(p.mediaSourceEngine_.destroy(),15);case 15:p.mediaSourceEngine_=null;case 14:if(p.adManager_&&!t&&p.adManager_.onAssetUnload(),p.preloadDueAdManager_&&!t&&(p.preloadDueAdManager_.destroy(),p.preloadDueAdManager_=null),t||p.preloadDueAdManagerTimer_.stop(),p.cmcdManager_&&p.cmcdManager_.reset(),p.cmsdManager_&&p.cmsdManager_.reset(),!p.textDisplayer_){h.jumpTo(16);break}return h.yield(p.textDisplayer_.destroy(),17);case 17:p.textDisplayer_=null;case 16:if(p.video_&&(shaka.util.Dom.removeAllChildren(p.video_),p.video_.src&&(p.video_.removeAttribute("src"),p.video_.load())),!p.drmEngine_){h.jumpTo(18);break}return h.yield(p.drmEngine_.destroy(),19);case 19:p.drmEngine_=null;case 18:if(p.preloadNextUrl_&&p.assetUri_!=p.preloadNextUrl_.getAssetUri()&&(p.preloadNextUrl_.isDestroyed()||p.preloadNextUrl_.destroy(),p.preloadNextUrl_=null),p.assetUri_=null,p.mimeType_=null,p.bufferObserver_=null,p.manifest_){for(n=$jscomp.makeIterator(p.manifest_.variants),a=n.next();!a.done;a=n.next())for(i=a.value,s=$jscomp.makeIterator([i.audio,i.video]),o=s.next();!o.done;o=s.next())(l=o.value)&&l.segmentIndex&&l.segmentIndex.release();for(u=$jscomp.makeIterator(p.manifest_.textStreams),c=u.next();!c.done;c=u.next())(d=c.value).segmentIndex&&d.segmentIndex.release()}p.config_&&p.config_.streaming.clearDecodingCache&&(shaka.util.StreamUtils.clearDecodingConfigCache(),shaka.drm.DrmUtils.clearMediaKeySystemAccessMap()),p.manifest_=null,p.stats_=new shaka.util.Stats,p.lastTextFactory_=null,p.targetLatencyReached_=null,p.currentTargetLatency_=null,p.rebufferingCount_=-1,p.externalSrcEqualsThumbnailsStreams_=[],p.completionPercent_=-1,p.networkingEngine_&&p.networkingEngine_.clearCommonAccessTokenMap(),p.updateBufferState_();case 3:h.enterFinallyBlock(),p.mutex_.release(),h.leaveFinallyBlock(4);break;case 4:if(e&&shaka.util.Platform.supportsMediaSource()&&!p.mediaSourceEngine_&&p.video_)return h.yield(p.initializeMediaSourceEngineInner_(),0);h.jumpTo(0)}}))},shaka.Player.prototype.updateStartTime=function(e){this.startTime_=e},shaka.Player.prototype.load=function(e,t,r){t=void 0===t?null:t;var n,a,i,s,o,l,u,c,d,p,h,f,m,g=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(y){switch(y.nextAddress){case 1:if(g.loadMode_==shaka.Player.LoadMode.DESTROYED)throw g.createAbortLoadError_();if(n=null,a="",e instanceof shaka.media.PreloadManager){if(e.isDestroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.PRELOAD_DESTROYED);a=(n=e).getAssetUri()||""}else a=e||"";return y.yield(g.mutex_.acquire("load"),2);case 2:if(g.mutex_.release(),!g.video_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.NO_VIDEO_ELEMENT);if(!g.assetUri_){y.jumpTo(3);break}return g.assetUri_=a,y.yield(g.unload(!1),3);case 3:if(i=++g.operationId_,s=function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){if(1==e.nextAddress)return g.operationId_==i?e.jumpTo(0):n?e.yield(n.destroy(),3):e.jumpTo(3);throw g.createAbortLoadError_()}))},o=function(e,t){return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:return r.setFinallyBlock(2),r.yield(g.mutex_.acquire(t),4);case 4:return r.yield(s(),5);case 5:return r.yield(e(),6);case 6:return r.yield(s(),7);case 7:n&&g.config_&&n.reconfigure(g.config_);case 2:r.enterFinallyBlock(),g.mutex_.release(),r.leaveFinallyBlock(0)}}))},y.setCatchFinallyBlocks(5,6),null==t&&n&&(t=n.getStartTime()),g.startTime_=t,g.fullyLoaded_=!1,g.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Loading)),n){r=n.getMimeType(),y.jumpTo(8);break}if(r){y.jumpTo(8);break}return y.yield(o((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){if(1==e.nextAddress)return e.yield(g.guessMimeType_(a),2);r=e.yieldResult,e.jumpToEnd()}))}),"guessMimeType_"),8);case 8:if(l=!!n,n){n.setEventHandoffTarget(g),g.stats_=n.getStats(),y.jumpTo(11);break}return y.yield(g.preloadInner_(a,t,r,!0),12);case 12:(n=y.yieldResult)?(n.markIsLoad(),n.setEventHandoffTarget(g),g.stats_=n.getStats(),n.start(),n.waitForFinish().catch((function(){}))):g.stats_=new shaka.util.Stats;case 11:return u=!n,c=Date.now()/1e3,g.stats_=n?n.getStats():new shaka.util.Stats,g.assetUri_=a,g.mimeType_=r||null,g.metadataRegionTimeline_=new shaka.media.RegionTimeline((function(){return g.seekRange()})),u?y.yield(o((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return goog.asserts.assert(r,"We should know the mimeType by now!"),e.yield(g.initializeSrcEqualsDrmInner_(r),0)}))}),"initializeSrcEqualsDrmInner_"),23):(g.emsgRegionTimeline_=new shaka.media.RegionTimeline((function(){return g.seekRange()})),y.yield(o((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){if(1==e.nextAddress)return e.yield(n.waitForManifest(),2);g.parserFactory_=n.getParserFactory(),g.parser_=n.receiveParser(),g.manifest_=n.getManifest(),e.jumpToEnd()}))}),"waitForFinish"),15));case 15:if(g.mediaSourceEngine_){y.jumpTo(16);break}return y.yield(o((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(g.initializeMediaSourceEngineInner_(),0)}))}),"initializeMediaSourceEngineInner_"),16);case 16:return g.manifest_&&g.manifest_.textStreams.length&&(g.textDisplayer_.enableTextDisplayer?g.textDisplayer_.enableTextDisplayer():shaka.Deprecate.deprecateFeature(5,"Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),y.yield(o((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(n.waitForFinish(),0)}))}),"waitForFinish"),18);case 18:if(g.config_=n.getConfiguration(),g.manifestFilterer_=n.getManifestFilterer(),g.parser_&&g.parser_.setMediaElement&&g.video_&&g.parser_.setMediaElement(g.video_),g.regionTimeline_=n.receiveRegionTimeline(),g.qualityObserver_=n.getQualityObserver(),(d=n.getCurrentAdaptationSetCriteria())&&(g.currentAdaptationSetCriteria_=d),l&&g.video_&&"AUDIO"===g.video_.nodeName&&(g.makeManifestAudioOnly_(),g.configure("manifest.disableVideo",!0)),n.getDrmEngine()){y.jumpTo(19);break}return y.yield(o((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(n.initializeDrm(g.video_),0)}))}),"drmEngine_.init"),19);case 19:return g.drmEngine_=n.receiveDrmEngine(),y.yield(o((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(g.drmEngine_.attach(g.video_),0)}))}),"drmEngine_.attach"),21);case 21:return!(p=n.getAbrManagerFactory())||g.abrManagerFactory_&&g.abrManagerFactory_==p||(g.abrManager_=n.receiveAbrManager(),g.abrManagerFactory_=n.getAbrManagerFactory(),"function"!=typeof g.abrManager_.setMediaElement&&(shaka.Deprecate.deprecateFeature(5,"AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),g.abrManager_.setMediaElement=function(){}),"function"!=typeof g.abrManager_.setCmsdManager&&(shaka.Deprecate.deprecateFeature(5,"AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),g.abrManager_.setCmsdManager=function(){}),"function"!=typeof g.abrManager_.trySuggestStreams&&(shaka.Deprecate.deprecateFeature(5,"AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),g.abrManager_.trySuggestStreams=function(){})),h=n.receiveSegmentPrefetchesById(),f=n.getPrefetchedVariant(),y.yield(o((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(g.loadInner_(c,f,h),0)}))}),"loadInner_"),22);case 22:n.stopQueuingLatePhaseQueuedOperations(),g.mimeType_&&shaka.util.Platform.isApple()&&shaka.util.MimeUtils.isHlsType(g.mimeType_)&&g.mediaSourceEngine_.addSecondarySource(g.assetUri_,g.mimeType_),y.jumpTo(14);break;case 23:return y.yield(o((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return goog.asserts.assert(r,"We should know the mimeType by now!"),e.yield(g.srcEqualsInner_(c,r),0)}))}),"srcEqualsInner_"),14);case 14:g.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Loaded));case 6:if(y.enterFinallyBlock(),!n){y.jumpTo(25);break}return y.yield(n.destroy(),25);case 25:g.preloadNextUrl_=null,y.leaveFinallyBlock(0);break;case 5:if(!(m=y.enterCatchBlock())||m.code==shaka.util.Error.Code.LOAD_INTERRUPTED){y.jumpTo(27);break}return y.yield(g.unload(!1),27);case 27:throw m}}))},shaka.Player.prototype.makeManifestAudioOnly_=function(){for(var e=$jscomp.makeIterator(this.manifest_.variants),t=e.next();!t.done;t=e.next())(t=t.value).video&&(t.video.closeSegmentIndex(),t.video=null),t.bandwidth=t.audio&&t.audio.bandwidth?t.audio.bandwidth:0;this.manifest_.variants=this.manifest_.variants.filter((function(e){return e.audio}))},shaka.Player.prototype.unloadAndSavePreload=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?a.yield(n.savePreload_(),2):3!=a.nextAddress?(r=a.yieldResult,a.yield(n.unload(e,t),3)):a.return(r)}))},shaka.Player.prototype.detachAndSavePreload=function(e,t){e=void 0!==e&&e,t=void 0!==t&&t;var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?a.yield(n.savePreload_(t),2):3!=a.nextAddress?(r=a.yieldResult,a.yield(n.detach(e),3)):a.return(r)}))},shaka.Player.prototype.savePreload_=function(e){e=void 0!==e&&e;var t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(t=null,n.manifest_&&n.parser_&&n.parserFactory_&&n.assetUri_?(r=n.video_.currentTime,n.isLive()&&!e&&(r=null),a.yield(n.makePreloadManager_(n.assetUri_,r,n.mimeType_,!0,!1,!1),3)):a.jumpTo(2)):(2!=a.nextAddress&&(t=a.yieldResult,n.createdPreloadManagers_.push(t),n.parser_&&n.parser_.setMediaElement&&n.parser_.setMediaElement(null),t.attachManifest(n.manifest_,n.parser_,n.parserFactory_),t.attachAbrManager(n.abrManager_,n.abrManagerFactory_),t.attachAdaptationSetCriteria(n.currentAdaptationSetCriteria_),t.start(),n.manifest_=null,n.parser_=null,n.parserFactory_=null,n.abrManager_=null,n.abrManagerFactory_=null),a.return(t))}))},shaka.Player.prototype.preload=function(e,t,r){t=void 0===t?null:t;var n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?i.yield(a.preloadInner_(e,t,r),2):((n=i.yieldResult)?n.start():a.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.SRC_EQUALS_PRELOAD_NOT_SUPPORTED)),i.return(n))}))},shaka.Player.prototype.destroyAllPreloads=function(){var e,t,r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){for(e=[],t=$jscomp.makeIterator(a.createdPreloadManagers_),r=t.next();!r.done;r=t.next())(n=r.value).isDestroyed()||e.push(n.destroy());return a.createdPreloadManagers_=[],i.yield(Promise.all(e),0)}))},shaka.Player.prototype.preloadInner_=function(e,t,r,n){n=void 0!==n&&n;var a,i,s,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return 1==l.nextAddress?(goog.asserts.assert(o.networkingEngine_,"Should have a net engine!"),goog.asserts.assert(o.config_,"Config must not be null!"),r?l.jumpTo(2):l.yield(o.guessMimeType_(e),3)):(2!=l.nextAddress&&(r=l.yieldResult),o.shouldUseSrcEquals_(e,r)?l.return(null):(a=!1,i=!0,n&&(o.abrManager_&&o.abrManagerFactory_==o.config_.abrFactory&&(i=!1),o.video_&&"AUDIO"===o.video_.nodeName&&(a=!0)),s=o.makePreloadManager_(e,t,r||null,!n,a,i),s=n?s.then((function(e){return e.markIsLoad(),e})):s.then((function(e){return o.createdPreloadManagers_.push(e),e})),l.return(s)))}))},shaka.Player.prototype.makePreloadManager_=function(e,t,r,n,a,i){n=void 0===n||n,a=void 0!==a&&a,i=void 0===i||i;var s,o,l,u,c,d,p,h,f,m,g,y,v,_=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(k){return 1==k.nextAddress?(goog.asserts.assert(_.networkingEngine_,"Must have net engine"),s=null,o=shaka.util.ObjectUtils.cloneObject(_.config_),a&&(o.manifest.disableVideo=!0),l=function(){return goog.asserts.assert(s,"Must have preload manager"),s.hasBeenAttached()&&s.isDestroyed()?null:s},u=function(){return l()?l().getConfiguration():_.config_},1/0!=_.maxHwRes_.width||1/0!=_.maxHwRes_.height||_.config_.ignoreHardwareResolution?k.jumpTo(2):k.yield(shaka.util.Platform.detectMaxHardwareResolution(),3)):(2!=k.nextAddress&&(c=k.yieldResult,_.maxHwRes_.width=c.width,_.maxHwRes_.height=c.height),d=new shaka.media.ManifestFilterer(o,_.maxHwRes_,null),p={networkingEngine:_.networkingEngine_,filter:function(e){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?r.yield(d.filterManifest(e),2):4!=r.nextAddress?r.yieldResult?(t=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.TracksChanged),r.yield(Promise.resolve(),4)):r.jumpTo(0):(s.dispatchEvent(t),void r.jumpToEnd())}))},makeTextStreamsForClosedCaptions:function(e){return _.makeTextStreamsForClosedCaptions_(e)},onTimelineRegionAdded:function(e){s.getRegionTimeline().addRegion(e)},onEvent:function(e){return s.dispatchEvent(e)},onError:function(e){return s.onError(e)},isLowLatencyMode:function(){return u().streaming.lowLatencyMode},updateDuration:function(){_.streamingEngine_&&s.hasBeenAttached()&&_.streamingEngine_.updateDuration()},newDrmInfo:function(e){var t=s.getDrmEngine(),r=t?t.getDrmInfo():null;r&&t.getMediaKeys()&&d.processDrmInfos(r.keySystem,e)},onManifestUpdated:function(){var e=shaka.util.FakeEvent.EventName.ManifestUpdated,t=(new Map).set("isLive",_.isLive());s.dispatchEvent(shaka.Player.makeEvent_(e,t)),s.addQueuedOperation(!1,(function(){_.adManager_&&_.adManager_.onManifestUpdated(_.isLive())}))},getBandwidthEstimate:function(){return _.abrManager_.getBandwidthEstimate()},onMetadata:function(e,t,r,n){var a=e;"com.apple.hls.interstitial"==e&&(a="com.apple.quicktime.HLS",e={startTime:t,endTime:r,values:n},_.adManager_&&(goog.asserts.assert(_.video_,"Must have video"),_.adManager_.onHLSInterstitialMetadata(_,_.video_,e))),e=(n=$jscomp.makeIterator(n)).next();for(var i={};!e.done;i={payload$jscomp$7:void 0},e=n.next())i.payload$jscomp$7=e.value,"ID"!=i.payload$jscomp$7.name&&s.addQueuedOperation(!1,function(e){return function(){_.addMetadataToRegionTimeline_(t,r,a,e.payload$jscomp$7)}}(i))},disableStream:function(e){return _.disableStream(e,_.config_.streaming.maxDisabledTime)},addFont:function(e,t){return _.addFont(e,t)}},(h=new shaka.media.RegionTimeline((function(){return _.seekRange()}))).addEventListener("regionadd",(function(e){var t=e.region;_.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionAdded,t,s),s.addQueuedOperation(!1,(function(){_.adManager_&&(_.adManager_.onDashTimedMetadata(t),goog.asserts.assert(_.video_,"Must have video"),_.adManager_.onDASHInterstitialMetadata(_,_.video_,t))}))})),f=null,o.streaming.observeQualityChanges&&((f=new shaka.media.QualityObserver((function(){return _.getBufferedInfo()}))).addEventListener("qualitychange",(function(e){_.onMediaQualityChange_(e.quality,e.position)})),f.addEventListener("audiotrackchange",(function(e){_.onMediaQualityChange_(e.quality,e.position,!0)}))),m=!0,g={netEngine:_.networkingEngine_,onError:function(e){return s.onError(e)},onKeyStatus:function(e){s.addQueuedOperation(!0,(function(){_.onKeyStatus_(e)}))},onExpirationUpdated:function(e,t){var r=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.ExpirationUpdated);s.dispatchEvent(r),(r=s.getParser())&&r.onExpirationUpdated&&r.onExpirationUpdated(e,t)},onEvent:function(e){s.dispatchEvent(e),e.type==shaka.util.FakeEvent.EventName.DrmSessionUpdate&&m&&(m=!1,e=Date.now()/1e3-s.getStartTimeOfDRM(),(_.stats_||s.getStats()).setDrmTime(e),_.lcevcDec_&&_.lcevcDec_.hideCanvas())}},y=_.createNetworkingEngine(l),_.networkingEngine_.copyFiltersInto(y),v={config:o,manifestPlayerInterface:p,regionTimeline:h,qualityObserver:f,createDrmEngine:function(){return _.createDrmEngine(g)},manifestFilterer:d,networkingEngine:y,allowPrefetch:n,allowMakeAbrManager:i},s=new shaka.media.PreloadManager(e,r,t,v),k.return(s))}))},shaka.Player.prototype.guessMimeType_=function(e){var t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(goog.asserts.assert(n.networkingEngine_,"Should have a net engine!"),t=n.config_.manifest.retryParameters,a.yield(shaka.net.NetworkingUtils.getMimeType(e,n.networkingEngine_,t),2)):("application/x-mpegurl"==(r=a.yieldResult)&&shaka.util.Platform.isApple()&&(r="application/vnd.apple.mpegurl"),a.return(r))}))},shaka.Player.prototype.shouldUseSrcEquals_=function(e,t){e=shaka.util.Platform;var r=shaka.util.MimeUtils;if(!e.supportsMediaSource())return!0;if(t){var n=""!=(this.video_||e.anyMediaElement()).canPlayType(t);if(!n)return!1;var a=shaka.media.ManifestParser.isSupported(t);if(!a)return!0;if(goog.asserts.assert(n&&a,"Both native and MSE playback should be possible!"),r.isHlsType(t))return e.isApple()&&(this.config_.drm.servers["com.apple.fps"]||this.config_.drm.servers["com.apple.fps.1_0"])?this.config_.streaming.useNativeHlsForFairPlay:this.config_.streaming.preferNativeHls;if(r.isDashType(t))return this.config_.streaming.preferNativeDash}return!1},shaka.Player.prototype.createTextDisplayer_=function(){var e=this.config_.textDisplayFactory;e!==this.lastTextFactory_&&(this.textDisplayer_=e(),this.textDisplayer_.configure?this.textDisplayer_.configure(this.config_.textDisplayer):shaka.Deprecate.deprecateFeature(5,"Text displayer w/ configure",'Text displayer should have a "configure" method!'),this.lastTextFactory_=e,this.textDisplayer_.setTextVisibility(this.isTextVisible_))},shaka.Player.prototype.initializeMediaSourceEngineInner_=function(){var e,t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return goog.asserts.assert(shaka.util.Platform.supportsMediaSource(),"We should not be initializing media source on a platform that does not support media source."),goog.asserts.assert(n.video_,"We should have a media element when initializing media source."),goog.asserts.assert(null==n.mediaSourceEngine_,"We should not have a media source engine yet."),n.makeStateChangeEvent_("media-source"),n.video_.removeAttribute("src"),shaka.util.Dom.removeAllChildren(n.video_),n.createTextDisplayer_(),goog.asserts.assert(n.textDisplayer_,"Text displayer should be created already"),(e=n.createMediaSourceEngine(n.video_,n.textDisplayer_,{getKeySystem:function(){return n.keySystem()},onMetadata:function(e,t,r){n.processTimedMetadataMediaSrc_(e,t,r)},onEmsg:function(e){n.addEmsgToRegionTimeline_(e)},onEvent:function(e){return n.dispatchEvent(e)},onManifestUpdate:function(){return n.onManifestUpdate_()}},n.lcevcDec_)).configure(n.config_.mediaSource),t=n.config_.manifest,r=t.segmentRelativeVttTiming,e.setSegmentRelativeVttTiming(r),a.yield(e.open(),2);n.mediaSourceEngine_=e,a.jumpToEnd()}))},shaka.Player.prototype.addBasicMediaListeners_=function(e,t){var r=this,n=function(){return r.updateStateHistory_()};this.loadEventManager_.listen(e,"playing",n),this.loadEventManager_.listen(e,"pause",n),this.loadEventManager_.listen(e,"ended",n),this.loadEventManager_.listen(e,"ratechange",(function(){return r.onRateChange_()})),e.remote&&(this.loadEventManager_.listen(e.remote,"connect",(function(){return r.onTracksChanged_()})),this.loadEventManager_.listen(e.remote,"connecting",(function(){return r.onTracksChanged_()})),this.loadEventManager_.listen(e.remote,"disconnect",(function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return r.streamingEngine_&&"disconnected"==e.remote.state?t.yield(r.streamingEngine_.resetMediaSource(),2):t.jumpTo(2);r.onTracksChanged_(),t.jumpToEnd()}))}))),e.audioTracks&&(this.loadEventManager_.listen(e.audioTracks,"addtrack",(function(){return r.onTracksChanged_()})),this.loadEventManager_.listen(e.audioTracks,"removetrack",(function(){return r.onTracksChanged_()})),this.loadEventManager_.listen(e.audioTracks,"change",(function(){return r.onTracksChanged_()}))),e.textTracks&&(this.loadEventManager_.listen(e.textTracks,"addtrack",(function(e){if(e.track)switch(e=e.track,goog.asserts.assert(e instanceof TextTrack,"Wrong track type!"),e.kind){case"metadata":r.processTimedMetadataSrcEquals_(e);break;case"chapters":r.activateChaptersTrack_(e);break;default:r.onTracksChanged_()}})),this.loadEventManager_.listen(e.textTracks,"removetrack",(function(){return r.onTracksChanged_()})),this.loadEventManager_.listen(e.textTracks,"change",(function(){return r.onTracksChanged_()})),this.config_.streaming.crossBoundaryStrategy!==shaka.config.CrossBoundaryStrategy.KEEP&&(this.loadEventManager_.listen(e,"waiting",(function(){r.streamingEngine_&&r.streamingEngine_.forwardTimeForCrossBoundary()})),this.loadEventManager_.listen(e,"timeupdate",(function(){r.streamingEngine_&&r.streamingEngine_.forwardTimeForCrossBoundary()})))),"none"!=e.preload&&this.loadEventManager_.listenOnce(e,"loadedmetadata",(function(){var e=Date.now()/1e3-t;r.stats_.setLoadLatency(e)}))},shaka.Player.prototype.loadInner_=function(e,t,r){var n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(w){switch(w.nextAddress){case 1:for(goog.asserts.assert(I.video_,"We should have a media element by now."),goog.asserts.assert(I.manifest_,"The manifest should already be parsed."),goog.asserts.assert(I.assetUri_,"We should have an asset uri by now."),goog.asserts.assert(I.abrManager_,"We should have an abr manager by now."),I.makeStateChangeEvent_("load"),n=I.video_,I.playRateController_=new shaka.media.PlayRateController({getRate:function(){return n.playbackRate},getDefaultRate:function(){return n.defaultPlaybackRate},setRate:function(e){n.playbackRate=e},movePlayhead:function(e){n.currentTime+=e}}),I.addBasicMediaListeners_(n,e),a=!1,i=$jscomp.makeIterator(I.manifest_.variants),s=i.next();!s.done;s=i.next())o=s.value,(l=o.video&&o.video.dependencyStream)&&(a=shaka.lcevc.Dec.isStreamSupported(l));I.setupLcevc_(I.config_,a),I.currentTextLanguage_=I.config_.preferredTextLanguage,I.currentTextRole_=I.config_.preferredTextRole,I.currentTextForced_=I.config_.preferForcedSubs,shaka.Player.applyPlayRange_(I.manifest_.presentationTimeline,I.config_.playRangeStart,I.config_.playRangeEnd),I.abrManager_.init((function(e,t,r){return I.switch_(e,t,r)})),I.abrManager_.setMediaElement(n),I.abrManager_.setCmsdManager(I.cmsdManager_),I.streamingEngine_=I.createStreamingEngine(),I.streamingEngine_.configure(I.config_.streaming),I.loadMode_=shaka.Player.LoadMode.MEDIA_SOURCE,I.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Streaming)),u=t;case 2:for((d=I.streamingEngine_.getCurrentVariant())||u||(u=I.chooseVariant_(),goog.asserts.assert(u,"Must choose an initial variant!")),p=[],c=d||u,h=$jscomp.makeIterator([c.video,c.audio]),f=h.next();!f.done;f=h.next())(m=f.value)&&!m.segmentIndex&&(p.push(m.createSegmentIndex()),m.dependencyStream&&p.push(m.dependencyStream.createSegmentIndex()));if(!(0<p.length)){w.jumpTo(4);break}return w.yield(Promise.all(p),4);case 4:if(!c||0!=c.disabledUntilTime){w.jumpTo(2);break}if(I.parser_&&I.parser_.onInitialVariantChosen&&I.parser_.onInitialVariantChosen(c),I.manifest_.isLowLatency&&(I.config_.streaming.lowLatencyMode?I.configure(I.lowLatencyConfig_):shaka.log.alwaysWarn("Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.")),I.cmcdManager_&&(I.cmcdManager_.setLowLatency(I.manifest_.isLowLatency&&I.config_.streaming.lowLatencyMode),I.cmcdManager_.setStartTimeOfLoad(1e3*e)),shaka.Player.applyPlayRange_(I.manifest_.presentationTimeline,I.config_.playRangeStart,I.config_.playRangeEnd),I.streamingEngine_.applyPlayRange(I.config_.playRangeStart,I.config_.playRangeEnd),g=function(e){I.playhead_=I.createPlayhead(e),I.playheadObservers_=I.createPlayheadObserversForMSE_(e),I.startBufferManagement_(n,!1)},I.config_.streaming.startAtSegmentBoundary||(null==(y=I.startTime_)&&I.manifest_.startTime&&(y=I.manifest_.startTime),g(y)),d){w.jumpTo(7);break}if(goog.asserts.assert(u,"Must have chosen an initial variant!"),!I.config_.streaming.startAtSegmentBoundary){w.jumpTo(8);break}return v=I.manifest_.presentationTimeline,_=I.startTime_||I.video_.currentTime,null==I.startTime_&&I.manifest_.startTime&&(_=I.manifest_.startTime),k=v.getSeekRangeStart(),E=v.getSeekRangeEnd(),_<k?_=k:_>E&&(_=E),w.yield(I.adjustStartTime_(u,_),9);case 9:b=w.yieldResult,g(b);case 8:I.switchVariant_(u,!0,!1,0);case 7:return I.playhead_.ready(),I.getTextTracks().find((function(e){return e.active}))||((T=I.chooseTextStream_())&&I.addTextStreamToSwitchHistory_(T,!0),u&&I.setInitialTextState_(u,T),T&&I.shouldStreamText_()&&(I.streamingEngine_.switchTextStream(T),I.setTextDisplayerLanguage_())),w.yield(I.streamingEngine_.start(r),10);case 10:I.config_.abr.enabled&&(I.abrManager_.enable(),I.onAbrStatusChanged_()),I.onTracksChanged_(),I.updateAbrManagerVariants_(),A=I.manifest_.variants.some((function(e){return e.primary})),I.config_.preferredAudioLanguage||A||shaka.log.warning("No preferred audio language set.  We have chosen an arbitrary language initially"),((S=I.isLive())&&(I.config_.streaming.liveSync&&I.config_.streaming.liveSync.enabled||I.manifest_.serviceDescription||I.config_.streaming.liveSync.panicMode)||I.config_.streaming.vodDynamicPlaybackRate)&&(P=function(){return I.onTimeUpdate_()},I.loadEventManager_.listen(n,"timeupdate",P)),S||(C=function(){return I.onVideoProgress_()},I.loadEventManager_.listen(n,"timeupdate",C),I.onVideoProgress_(),I.manifest_.nextUrl&&(0<I.config_.streaming.preloadNextUrlWindow&&(x=function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return e=I.seekRange().end-I.video_.currentTime,!isNaN(e)&&e<=I.config_.streaming.preloadNextUrlWindow?(I.loadEventManager_.unlisten(n,"timeupdate",x),goog.asserts.assert(I.manifest_.nextUrl,"this.manifest_.nextUrl should be valid."),t.yield(I.preload(I.manifest_.nextUrl),4)):t.jumpTo(0);I.preloadNextUrl_=t.yieldResult,t.jumpToEnd()}))},I.loadEventManager_.listen(n,"timeupdate",x)),I.loadEventManager_.listen(n,"ended",(function(){I.load(I.preloadNextUrl_||I.manifest_.nextUrl)})))),I.adManager_&&I.adManager_.onManifestUpdated(S),I.fullyLoaded_=!0,w.jumpToEnd()}}))},shaka.Player.prototype.initializeSrcEqualsDrmInner_=function(e){var t,r,n,a,i,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(t=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(s.networkingEngine_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),goog.asserts.assert(s.config_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),r=Date.now()/1e3,n=!0,s.drmEngine_=s.createDrmEngine({netEngine:s.networkingEngine_,onError:function(e){s.onError_(e)},onKeyStatus:function(e){},onExpirationUpdated:function(e,t){e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.ExpirationUpdated),s.dispatchEvent(e)},onEvent:function(e){s.dispatchEvent(e),e.type==shaka.util.FakeEvent.EventName.DrmSessionUpdate&&n&&(n=!1,e=Date.now()/1e3-r,s.stats_.setDrmTime(e))}}),s.drmEngine_.configure(s.config_.drm),a={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},(i={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:e?shaka.util.MimeUtils.getBasicType(e):"",codecs:e?shaka.util.MimeUtils.getCodecs(e):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:t.VIDEO,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null}).fullMimeTypes.add(shaka.util.MimeUtils.getFullType(i.mimeType,i.codecs)),e.startsWith("audio/")?(i.type=t.AUDIO,a.audio=i):a.video=i,s.drmEngine_.setSrcEquals(!0),o.yield(s.drmEngine_.initForPlayback([a],[]),2)):o.yield(s.drmEngine_.attach(s.video_),0)}))},shaka.Player.prototype.srcEqualsInner_=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h,f=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(m){switch(m.nextAddress){case 1:if(f.makeStateChangeEvent_("src-equals"),goog.asserts.assert(f.video_,"We should have a media element when loading."),goog.asserts.assert(f.assetUri_,"We should have a valid uri when loading."),r=f.video_,f.playhead_=new shaka.media.SrcEqualsPlayhead(r),n=!1,f.cleanupOnUnload_.push((function(){n=!0})),null!=f.startTime_&&f.playhead_.setStartTime(f.startTime_),f.playheadObservers_=f.createPlayheadObserversForSrcEquals_(f.startTime_||0),f.playRateController_=new shaka.media.PlayRateController({getRate:function(){return r.playbackRate},getDefaultRate:function(){return r.defaultPlaybackRate},setRate:function(e){r.playbackRate=e},movePlayhead:function(e){r.currentTime+=e}}),f.startBufferManagement_(r,!0),r.textTracks&&(f.createTextDisplayer_(),a=function(){var e=f.getFilteredTextTracks_().find((function(e){return"disabled"!==e.mode}));e&&(e.mode="showing"),(e=f.getGeneratedTextTrack_())&&(e.mode="hidden")},i=function(){var e=f.getFilteredTextTracks_().find((function(e){return"disabled"!==e.mode}));e&&(e.mode="hidden"),e=f.getGeneratedTextTrack_();var t=f.textDisplayer_.isTextVisible();e&&t&&(e.mode="showing")},f.loadEventManager_.listen(r,"enterpictureinpicture",(function(){return a()})),f.loadEventManager_.listen(r,"leavepictureinpicture",(function(){return i()})),r.remote?(f.loadEventManager_.listen(r.remote,"connect",(function(){return i()})),f.loadEventManager_.listen(r.remote,"connecting",(function(){return i()})),f.loadEventManager_.listen(r.remote,"disconnect",(function(){return i()}))):"webkitCurrentPlaybackTargetIsWireless"in r&&f.loadEventManager_.listen(r,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return i()})),(s=r).webkitSupportsFullscreen&&f.loadEventManager_.listen(s,"webkitpresentationmodechanged",(function(){"inline"!=s.webkitPresentationMode?a():i()}))),f.addBasicMediaListeners_(r,e),!(o=f.cmcdManager_.appendSrcData(f.assetUri_,t)).includes("#t=")&&(0<f.config_.playRangeStart||isFinite(f.config_.playRangeEnd))&&(o+="#t=",0<f.config_.playRangeStart&&(o+=f.config_.playRangeStart),isFinite(f.config_.playRangeEnd)&&(o+=","+f.config_.playRangeEnd)),!f.mediaSourceEngine_){m.jumpTo(2);break}return m.yield(f.mediaSourceEngine_.destroy(),3);case 3:f.mediaSourceEngine_=null;case 2:return shaka.util.Dom.removeAllChildren(r),r.src=o,(shaka.util.Platform.isTizen()||shaka.util.Platform.isWebOS())&&r.load(),"none"!=r.preload&&!r.autoplay&&shaka.util.MimeUtils.isHlsType(t)&&shaka.util.Platform.isApple()&&r.load(),f.loadMode_=shaka.Player.LoadMode.SRC_EQUALS,f.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Streaming)),l=new shaka.util.PublicPromise,shaka.util.MediaReadyState.waitForReadyState(r,HTMLMediaElement.HAVE_METADATA,f.loadEventManager_,(function(){f.playhead_.ready(),l.resolve()})),u=function(){return new Promise((function(e){var t=new shaka.util.Timer(e);f.loadEventManager_.listen(r.textTracks,"change",(function(){return t.tickAfter(.5)})),t.tickAfter(.5)}))},shaka.util.MediaReadyState.waitForReadyState(r,HTMLMediaElement.HAVE_CURRENT_DATA,f.loadEventManager_,(function(){var e,t,r,a,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){if(1==s.nextAddress)return s.yield(u(),2);if(n)return s.return();for(f.setupPreferredAudioOnSrc_(),(e=f.getFilteredTextTracks_()).some((function(e){return"showing"===e.mode}))&&(f.isTextVisible_=!0,f.textDisplayer_.setTextVisibility(!0)),e.length&&(f.textDisplayer_.enableTextDisplayer?f.textDisplayer_.enableTextDisplayer():shaka.Deprecate.deprecateFeature(5,"Text displayer w/ enableTextDisplayer",'Text displayer should have a "enableTextDisplayer" method!')),t=!1,r=$jscomp.makeIterator(e),a=r.next();!a.done;a=r.next())"disabled"!==(i=a.value).mode&&(t?(i.mode="disabled",shaka.log.alwaysWarn("Found more than one enabled text track, disabling it",i)):(f.enableNativeTrack_(i),t=!0));f.setupPreferredTextOnSrc_(),s.jumpToEnd()}))})),r.error?l.reject(f.videoErrorToShakaError_()):"none"==r.preload&&(shaka.log.alwaysWarn('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),l.resolve()),f.loadEventManager_.listenOnce(r,"error",(function(){l.reject(f.videoErrorToShakaError_())})),m.yield(shaka.util.Functional.promiseWithTimeout(f.config_.streaming.loadTimeout,l),4);case 4:((c=f.isLive())&&(f.config_.streaming.liveSync&&f.config_.streaming.liveSync.enabled||f.config_.streaming.liveSync.panicMode)||f.config_.streaming.vodDynamicPlaybackRate)&&(d=function(){return f.onTimeUpdate_()},f.loadEventManager_.listen(r,"timeupdate",d)),c||(p=function(){return f.onVideoProgress_()},f.loadEventManager_.listen(r,"timeupdate",p),f.onVideoProgress_()),f.adManager_&&(f.adManager_.onManifestUpdated(c),c&&(h=f.seekRange().end,f.loadEventManager_.listen(r,"progress",(function(){var e=f.seekRange().end;h!=e&&(f.adManager_.onManifestUpdated(f.isLive()),h=e)})))),f.fullyLoaded_=!0,m.jumpToEnd()}}))},shaka.Player.prototype.setupPreferredAudioOnSrc_=function(){var e=this.config_.preferredAudioLanguage;""!=e&&this.selectAudioLanguage(e,this.config_.preferredVariantRole)},shaka.Player.prototype.setupPreferredTextOnSrc_=function(){var e=this.config_.preferredTextLanguage;""!=e&&this.selectTextLanguage(e,this.config_.preferredTextRole,this.config_.preferForcedSubs)},shaka.Player.prototype.processTimedMetadataSrcEquals_=function(e){var t=this;if("metadata"==e.kind){e.mode="hidden",this.loadEventManager_.listen(e,"cuechange",(function(){if(e.activeCues)for(var r=$jscomp.makeIterator(e.activeCues),n=r.next();!n.done;n=r.next())n=n.value,t.addMetadataToRegionTimeline_(n.startTime,n.endTime,n.type,n.value),t.adManager_&&t.adManager_.onCueMetadataChange(n.value);if(e.cues){r=[];for(var a=(n=$jscomp.makeIterator(e.cues)).next(),i={};!a.done;i={cue$jscomp$37:void 0},a=n.next())i.cue$jscomp$37=a.value,"com.apple.quicktime.HLS"==i.cue$jscomp$37.type&&null!=i.cue$jscomp$37.startTime&&(a=r.find(function(e){return function(t){return t.startTime==e.cue$jscomp$37.startTime&&t.endTime==e.cue$jscomp$37.endTime}}(i)),a||(a={startTime:i.cue$jscomp$37.startTime,endTime:i.cue$jscomp$37.endTime,values:[]},r.push(a)),a.values.push(i.cue$jscomp$37.value));for(n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next())(n=n.value).values.some((function(e){return"X-ASSET-URI"==e.key||"X-ASSET-LIST"==e.key}))&&t.adManager_&&(i=0==n.startTime&&!t.isLive(),n.values.push({key:"CUE",description:"",data:i?"ONCE,PRE":"ONCE",mimeType:null,pictureType:null}),goog.asserts.assert(t.video_,"Must have video"),t.adManager_.onHLSInterstitialMetadata(t,t.video_,n))}}));var r=new shaka.util.Timer((function(){for(var e=t.getMetadataTracks_(),r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())r.value.mode="hidden"})).tickNow().tickAfter(.5);this.cleanupOnUnload_.push((function(){r.stop()}))}},shaka.Player.prototype.processTimedMetadataMediaSrc_=function(e,t,r){for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())if((n=n.value).data&&"number"==typeof n.cueTime&&n.frames){var a=n.cueTime+t,i=r;i&&a>i&&(i=a);for(var s=$jscomp.makeIterator(n.frames),o=s.next();!o.done;o=s.next())this.addMetadataToRegionTimeline_(a,i,"org.id3",o.value);this.adManager_&&this.adManager_.onHlsTimedMetadata(n,a)}},shaka.Player.prototype.dispatchMetadataEvent_=function(e){var t=shaka.util.FakeEvent.EventName.Metadata;e=(new Map).set("startTime",e.startTime).set("endTime",e.endTime).set("metadataType",e.schemeIdUri).set("payload",e.payload),this.dispatchEvent(shaka.Player.makeEvent_(t,e))},shaka.Player.prototype.addMetadataToRegionTimeline_=function(e,t,r,n){this.metadataRegionTimeline_&&(goog.asserts.assert(!t||e<=t,"Metadata start time should be less or equal to the end time!"),(e={schemeIdUri:r,startTime:e,endTime:t||1/0,id:"",payload:n}).id=JSON.stringify(e),this.metadataRegionTimeline_.addRegion(e))},shaka.Player.prototype.dispatchEmsgEvent_=function(e){var t=shaka.util.FakeEvent.EventName.Emsg;e=e.emsg,e=(new Map).set("detail",e),this.dispatchEvent(shaka.Player.makeEvent_(t,e))},shaka.Player.prototype.addEmsgToRegionTimeline_=function(e){this.emsgRegionTimeline_&&this.emsgRegionTimeline_.addRegion({schemeIdUri:e.schemeIdUri,startTime:e.startTime,endTime:e.endTime,id:String(e.id),emsg:e})},shaka.Player.prototype.activateChaptersTrack_=function(e){if(e&&"chapters"==e.kind){e.mode="hidden";var t=new shaka.util.Timer((function(){e.mode="hidden"})).tickNow().tickAfter(.5);this.cleanupOnUnload_.push((function(){t.stop()}))}},shaka.Player.prototype.releaseAllMutexes=function(){this.mutex_.releaseAll()},shaka.Player.prototype.createDrmEngine=function(e){return new shaka.drm.DrmEngine(e)},shaka.Player.prototype.createNetworkingEngine=function(e){var t=this;e||(e=function(){return null});var r=function(t){e()?e().addQueuedOperation(!0,t):t()},n=function(r){e()?e().dispatchEvent(r):t.dispatchEvent(r)};return new shaka.net.NetworkingEngine((function(r,n,a,i){var s=e()?e().getAbrManager():t.abrManager_;s&&s.segmentDownloaded(r,n,a,i)}),(function(e,a,i){var s=shaka.util.FakeEvent.EventName.DownloadHeadersReceived;a=(new Map).set("headers",e).set("request",a).set("requestType",i),n(shaka.Player.makeEvent_(s,a)),r((function(){t.cmsdManager_&&t.cmsdManager_.processHeaders(e)}))}),(function(e,t){var r=shaka.util.FakeEvent.EventName.DownloadCompleted;e=(new Map).set("request",e).set("response",t),n(shaka.Player.makeEvent_(r,e))}),(function(e,t,r,a){var i=shaka.util.FakeEvent.EventName.DownloadFailed;e=(new Map).set("request",e).set("error",t).set("httpResponseCode",r).set("aborted",a),n(shaka.Player.makeEvent_(i,e))}),(function(e,n,a){r((function(){t.cmcdManager_.applyData(e,n,a)}))}),(function(r,n,a,i){(r=e()?e().getParser():t.parser_)&&r.banLocation&&r.banLocation(i)}),(function(r,n,a){n.data&&(n=n.data.byteLength,(a=e()?e().getStats():t.stats_)&&(a.addBytesDownloaded(n),r===shaka.net.NetworkingEngine.RequestType.MANIFEST&&a.setManifestSize(n)))}))},shaka.Player.prototype.createPlayhead=function(e){var t=this;return goog.asserts.assert(this.manifest_,"Must have manifest"),goog.asserts.assert(this.video_,"Must have video"),new shaka.media.MediaSourcePlayhead(this.video_,this.manifest_,this.config_.streaming,e,(function(){return t.onSeek_()}),(function(e){return t.dispatchEvent(e)}))},shaka.Player.prototype.createPlayheadObserversForMSE_=function(e){var t=this;goog.asserts.assert(this.manifest_,"Must have manifest"),goog.asserts.assert(this.regionTimeline_,"Must have region timeline"),goog.asserts.assert(this.metadataRegionTimeline_,"Must have metadata region timeline"),goog.asserts.assert(this.emsgRegionTimeline_,"Must have emsg region timeline"),goog.asserts.assert(this.video_,"Must have video element");var r=this.isLive()||0<e;(e=new shaka.media.RegionObserver(this.regionTimeline_,r)).addEventListener("enter",(function(e){t.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionEnter,e.region)})),e.addEventListener("exit",(function(e){t.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionExit,e.region)})),e.addEventListener("skip",(function(e){var r=e.region;e.seeking||(t.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionEnter,r),t.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionExit,r))}));var n=new shaka.media.RegionObserver(this.metadataRegionTimeline_,r);n.addEventListener("enter",(function(e){t.dispatchMetadataEvent_(e.region)})),(r=new shaka.media.RegionObserver(this.emsgRegionTimeline_,r)).addEventListener("enter",(function(e){t.dispatchEmsgEvent_(e.region)}));var a=new shaka.media.PlayheadObserverManager(this.video_);return a.manage(e),a.manage(n),a.manage(r),this.qualityObserver_&&a.manage(this.qualityObserver_),a},shaka.Player.prototype.createPlayheadObserversForSrcEquals_=function(e){var t=this;goog.asserts.assert(this.metadataRegionTimeline_,"Must have metadata region timeline"),goog.asserts.assert(this.video_,"Must have video element"),(e=new shaka.media.RegionObserver(this.metadataRegionTimeline_,0<e)).addEventListener("enter",(function(e){t.dispatchMetadataEvent_(e.region)}));var r=new shaka.media.PlayheadObserverManager(this.video_);return r.manage(e),r},shaka.Player.prototype.startBufferManagement_=function(e,t){var r=this;goog.asserts.assert(!this.bufferObserver_,"No buffering observer should exist before initialization."),goog.asserts.assert(!this.bufferPoller_,"No buffer timer should exist before initialization."),this.bufferObserver_=new shaka.media.BufferingObserver(1,2),this.bufferObserver_.setState(shaka.media.BufferingObserver.State.STARVING),this.updateBufferingSettings_(),this.updateBufferState_(),this.bufferPoller_=new shaka.util.Timer((function(){r.pollBufferState_()})),this.config_.streaming.rebufferingGoal&&this.bufferPoller_.tickEvery(.25),this.loadEventManager_.listen(e,"waiting",(function(e){return r.pollBufferState_()})),this.loadEventManager_.listen(e,"canplaythrough",(function(e){return r.pollBufferState_()})),this.loadEventManager_.listen(e,"playing",(function(e){return r.pollBufferState_()})),this.loadEventManager_.listen(e,"seeked",(function(e){return r.pollBufferState_()})),t&&(this.loadEventManager_.listen(e,"stalled",(function(e){return r.pollBufferState_()})),this.loadEventManager_.listen(e,"progress",(function(e){return r.pollBufferState_()})),this.loadEventManager_.listen(e,"timeupdate",(function(e){return r.pollBufferState_()})))},shaka.Player.prototype.updateBufferingSettings_=function(){var e=this.config_.streaming.rebufferingGoal;this.bufferObserver_.setThresholds(e,Math.min(shaka.Player.TYPICAL_BUFFERING_THRESHOLD_,e/2))},shaka.Player.prototype.pollBufferState_=function(){switch(goog.asserts.assert(this.video_,"Need a media element to update the buffering observer"),goog.asserts.assert(this.bufferObserver_,"Need a buffering observer to update"),this.loadMode_){case shaka.Player.LoadMode.SRC_EQUALS:var e=this.isBufferedToEndSrc_();break;case shaka.Player.LoadMode.MEDIA_SOURCE:e=this.isBufferedToEndMS_();break;default:e=!1}var t=shaka.media.TimeRangesUtils.bufferedAheadOf(this.video_.buffered,this.video_.currentTime);this.bufferObserver_.update(t,e)&&this.updateBufferState_()},shaka.Player.prototype.createMediaSourceEngine=function(e,t,r,n){return new shaka.media.MediaSourceEngine(e,t,r,n)},shaka.Player.prototype.createCmcd_=function(){var e=this;return new shaka.util.CmcdManager({getBandwidthEstimate:function(){return e.abrManager_?e.abrManager_.getBandwidthEstimate():NaN},getBufferedInfo:function(){return e.getBufferedInfo()},getCurrentTime:function(){return e.video_?e.video_.currentTime:0},getPlaybackRate:function(){return e.getPlaybackRate()},getNetworkingEngine:function(){return e.getNetworkingEngine()},getVariantTracks:function(){return e.getVariantTracks()},isLive:function(){return e.isLive()},getLiveLatency:function(){return e.getLiveLatency()}},this.config_.cmcd)},shaka.Player.prototype.createCmsd_=function(){return new shaka.util.CmsdManager(this.config_.cmsd)},shaka.Player.prototype.createStreamingEngine=function(){var e=this;return goog.asserts.assert(this.abrManager_&&this.mediaSourceEngine_&&this.manifest_&&this.video_,"Must not be destroyed"),new shaka.media.StreamingEngine(this.manifest_,{getPresentationTime:function(){return e.playhead_?e.playhead_.getTime():0},getBandwidthEstimate:function(){return e.abrManager_.getBandwidthEstimate()},getPlaybackRate:function(){return e.getPlaybackRate()},video:this.video_,mediaSourceEngine:this.mediaSourceEngine_,netEngine:this.networkingEngine_,onError:function(t){return e.onError_(t)},onEvent:function(t){return e.dispatchEvent(t)},onSegmentAppended:function(t,r,n){e.onSegmentAppended_(t.startTime,t.endTime,r.type,n)},onInitSegmentAppended:function(t,r){(r=r.getMediaQuality())&&e.qualityObserver_&&e.qualityObserver_.addMediaQualityChange(r,t)},beforeAppendSegment:function(t,r){return e.drmEngine_.parseInbandPssh(t,r)},disableStream:function(t,r){return e.disableStream(t,r)}})},shaka.Player.prototype.configure=function(e,t){var r=shaka.util.Platform;if(goog.asserts.assert(this.config_,"Config must not be null!"),goog.asserts.assert("object"==typeof e||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=shaka.util.ConfigUtils.convertToConfigObject(e,t)),goog.asserts.assert("object"==typeof e,"Should be an object!"),e.streaming&&"forceTransmuxTS"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead."),e.streaming.preferNativeHls=e.streaming.useNativeHlsOnSafari&&r.isApple(),delete e.streaming.useNativeHlsOnSafari),e.streaming&&"boolean"==typeof e.streaming.liveSync&&(shaka.Deprecate.deprecateFeature(5,"streaming.liveSync","Please Use streaming.liveSync.enabled instead."),r=e.streaming.liveSync,e.streaming.liveSync={},e.streaming.liveSync.enabled=r),e.streaming&&(!e.streaming.liveSync||!("targetLatency"in e.streaming.liveSync))&&("liveSyncMinLatency"in e.streaming||"liveSyncMaxLatency"in e.streaming)){r=e.streaming.liveSyncMinLatency||0;var n=Math.abs((e.streaming.liveSyncMaxLatency||1)-r)/2;e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=r+n,e.streaming.liveSync.targetLatencyTolerance=n}if(e.streaming&&"liveSyncMaxLatency"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.liveSyncMaxLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMaxLatency),e.streaming&&"liveSyncMinLatency"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.liveSyncMinLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMinLatency),e.streaming&&"liveSyncTargetLatency"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.liveSyncTargetLatency","Please Use streaming.liveSync.targetLatency instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=e.streaming.liveSyncTargetLatency,delete e.streaming.liveSyncTargetLatency),e.streaming&&"liveSyncTargetLatencyTolerance"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.liveSyncTargetLatencyTolerance","Please Use streaming.liveSync.targetLatencyTolerance instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatencyTolerance=e.streaming.liveSyncTargetLatencyTolerance,delete e.streaming.liveSyncTargetLatencyTolerance),e.streaming&&"liveSyncPlaybackRate"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.liveSyncPlaybackRate","Please Use streaming.liveSync.maxPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.maxPlaybackRate=e.streaming.liveSyncPlaybackRate,delete e.streaming.liveSyncPlaybackRate),e.streaming&&"liveSyncMinPlaybackRate"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.liveSyncMinPlaybackRate","Please Use streaming.liveSync.minPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.minPlaybackRate=e.streaming.liveSyncMinPlaybackRate,delete e.streaming.liveSyncMinPlaybackRate),e.streaming&&"liveSyncPanicMode"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.liveSyncPanicMode","Please Use streaming.liveSync.panicMode instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicMode=e.streaming.liveSyncPanicMode,delete e.streaming.liveSyncPanicMode),e.streaming&&"liveSyncPanicThreshold"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.liveSyncPanicThreshold","Please Use streaming.liveSync.panicThreshold instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicThreshold=e.streaming.liveSyncPanicThreshold,delete e.streaming.liveSyncPanicThreshold),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){shaka.Deprecate.deprecateFeature(5,"mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var a=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return a},delete e.mediaSource.sourceBufferExtraFeatures}if(e.manifest&&e.manifest.hls&&"useSafariBehaviorForLive"in e.manifest.hls&&(shaka.Deprecate.deprecateFeature(5,"manifest.hls.useSafariBehaviorForLive configuration","Please Use liveSync config to keep on live Edge instead."),delete e.manifest.hls.useSafariBehaviorForLive),e.streaming&&"parsePrftBox"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.parsePrftBox configuration","Now fired without needing a configuration."),delete e.streaming.parsePrftBox),e.manifest&&e.manifest.dash&&"enableAudioGroups"in e.manifest.dash&&(shaka.Deprecate.deprecateFeature(5,"manifest.dash.enableAudioGroups configuration","It is now enabled by default and cannot be disabled."),delete e.manifest.dash.enableAudioGroups),e.streaming&&"dispatchAllEmsgBoxes"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.dispatchAllEmsgBoxes configuration","Please Use mediaSource.dispatchAllEmsgBoxes instead."),e.mediaSource.dispatchAllEmsgBoxes=e.streaming.dispatchAllEmsgBoxes,delete e.streaming.dispatchAllEmsgBoxes),e.streaming&&"autoLowLatencyMode"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.autoLowLatencyMode configuration","Please Use streaming.lowLatencyMode instead."),e.streaming.lowLatencyMode=e.streaming.autoLowLatencyMode,delete e.streaming.autoLowLatencyMode),e.manifest&&e.manifest.dash&&"ignoreSupplementalCodecs"in e.manifest.dash&&(shaka.Deprecate.deprecateFeature(5,"manifest.dash.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.dash.ignoreSupplementalCodecs,delete e.manifest.dash.ignoreSupplementalCodecs),e.manifest&&e.manifest.hls&&"ignoreSupplementalCodecs"in e.manifest.hls&&(shaka.Deprecate.deprecateFeature(5,"manifest.hls.ignoreSupplementalCodecs configuration","Please Use manifest.ignoreSupplementalCodecs instead."),e.manifest.ignoreSupplementalCodecs=e.manifest.hls.ignoreSupplementalCodecs,delete e.manifest.hls.ignoreSupplementalCodecs),e.manifest&&e.manifest.dash&&"updatePeriod"in e.manifest.dash&&(shaka.Deprecate.deprecateFeature(5,"manifest.dash.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.dash.updatePeriod,delete e.manifest.dash.updatePeriod),e.manifest&&e.manifest.hls&&"updatePeriod"in e.manifest.hls&&(shaka.Deprecate.deprecateFeature(5,"manifest.hls.updatePeriod configuration","Please Use manifest.updatePeriod instead."),e.manifest.updatePeriod=e.manifest.hls.updatePeriod,delete e.manifest.hls.updatePeriod),e.manifest&&e.manifest.dash&&"ignoreDrmInfo"in e.manifest.dash&&(shaka.Deprecate.deprecateFeature(5,"manifest.dash.ignoreDrmInfo configuration","Please Use manifest.ignoreDrmInfo instead."),e.manifest.ignoreDrmInfo=e.manifest.dash.ignoreDrmInfo,delete e.manifest.dash.ignoreDrmInfo),e.drm&&e.drm.advanced){for(var i in r=!1,e.drm.advanced){var s=e.drm.advanced[i];n=s.videoRobustness,s=s.audioRobustness,"videoRobustness"in e.drm.advanced[i]&&!Array.isArray(e.drm.advanced[i].videoRobustness)&&(e.drm.advanced[i].videoRobustness=[n],r=!0),"audioRobustness"in e.drm.advanced[i]&&!Array.isArray(e.drm.advanced[i].audioRobustness)&&(e.drm.advanced[i].audioRobustness=[s],r=!0)}r&&shaka.Deprecate.deprecateFeature(5,"AdvancedDrmConfiguration's videoRobustness and audioRobustness","These properties are no longer strings but array of strings, please update your usage of these properties.")}return e.streaming&&"crossBoundaryStrategy"in e.streaming&&e.streaming.crossBoundaryStrategy!=shaka.config.CrossBoundaryStrategy.KEEP&&(e.streaming.inaccurateManifestTolerance=0),i=shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,e,this.defaultConfig_()),this.applyConfig_(),i},shaka.Player.prototype.configurationForLowLatency=function(e){this.lowLatencyConfig_=e},shaka.Player.prototype.applyConfig_=function(){if(this.manifestFilterer_=new shaka.media.ManifestFilterer(this.config_,this.maxHwRes_,this.drmEngine_),this.parser_){var e=shaka.util.ObjectUtils.cloneObject(this.config_.manifest);this.video_&&"AUDIO"===this.video_.nodeName&&(e.disableVideo=!0),this.parser_.configure(e)}if(this.drmEngine_&&this.drmEngine_.configure(this.config_.drm),this.streamingEngine_){this.streamingEngine_.configure(this.config_.streaming);try{this.loadMode_!=shaka.Player.LoadMode.DESTROYED&&this.manifestFilterer_.filterManifestWithRestrictions(this.manifest_)&&this.onTracksChanged_()}catch(e){this.onError_(e)}this.abrManager_&&this.updateAbrManagerVariants_(),!(e=this.streamingEngine_.getCurrentVariant())||e.allowedByApplication&&e.allowedByKeySystem||(shaka.log.debug("Choosing new variant after changing configuration"),this.chooseVariantAndSwitch_())}if(this.networkingEngine_&&(this.networkingEngine_.setForceHTTP(this.config_.streaming.forceHTTP),this.networkingEngine_.setForceHTTPS(this.config_.streaming.forceHTTPS),this.networkingEngine_.setMinBytesForProgressEvents(this.config_.streaming.minBytesForProgressEvents)),this.mediaSourceEngine_&&(this.mediaSourceEngine_.configure(this.config_.mediaSource),this.mediaSourceEngine_.setSegmentRelativeVttTiming(this.config_.manifest.segmentRelativeVttTiming)),this.textDisplayer_)if(e=this.config_.textDisplayFactory,this.lastTextFactory_!=e){var t=this.textDisplayer_;this.textDisplayer_=e(),this.textDisplayer_.configure?this.textDisplayer_.configure(this.config_.textDisplayer):shaka.Deprecate.deprecateFeature(5,"Text displayer w/ configure",'Text displayer should have a "configure" method!'),this.textDisplayer_.setTextLanguage||shaka.Deprecate.deprecateFeature(5,"Text displayer w/ setTextLanguage",'Text displayer should have a "setTextLanguage" method!'),this.textDisplayer_.setTextVisibility(t.isTextVisible()),t.destroy(),this.mediaSourceEngine_&&this.mediaSourceEngine_.setTextDisplayer(this.textDisplayer_),this.lastTextFactory_=e,this.streamingEngine_&&this.streamingEngine_.reloadTextStream()}else this.textDisplayer_.configure&&this.textDisplayer_.configure(this.config_.textDisplayer);this.abrManager_&&(this.abrManager_.configure(this.config_.abr),this.config_.abr.enabled?this.abrManager_.enable():this.abrManager_.disable(),this.onAbrStatusChanged_()),this.bufferObserver_&&this.updateBufferingSettings_(),this.bufferPoller_&&(this.config_.streaming.rebufferingGoal?this.bufferPoller_.tickEvery(.25):this.bufferPoller_.stop()),this.manifest_&&shaka.Player.applyPlayRange_(this.manifest_.presentationTimeline,this.config_.playRangeStart,this.config_.playRangeEnd),this.adManager_&&this.adManager_.configure(this.config_.ads),this.cmcdManager_&&this.cmcdManager_.configure(this.config_.cmcd),this.cmsdManager_&&this.cmsdManager_.configure(this.config_.cmsd)},shaka.Player.prototype.getConfiguration=function(){goog.asserts.assert(this.config_,"Config must not be null!");var e=this.defaultConfig_();return shaka.util.PlayerConfiguration.mergeConfigObjects(e,this.config_,this.defaultConfig_()),e},shaka.Player.prototype.getConfigurationForLowLatency=function(){return this.lowLatencyConfig_},shaka.Player.prototype.getNonDefaultConfiguration=function(){goog.asserts.assert(this.config_,"Config must not be null!");var e=this.defaultConfig_();return shaka.util.PlayerConfiguration.mergeConfigObjects(e,this.config_,this.defaultConfig_()),shaka.util.ConfigUtils.getDifferenceFromConfigObjects(this.config_,this.defaultConfig_())},shaka.Player.prototype.getSharedConfiguration=function(){return goog.asserts.assert(this.config_,"Cannot call getSharedConfiguration after call destroy!"),this.config_},shaka.Player.prototype.getBufferFullness=function(){if(this.video_){var e=this.video_.buffered.length;e=e?this.video_.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(e>=(t=Math.min(this.video_.currentTime+t,this.seekRange().end)))return 1;if(!(e<=this.video_.currentTime)&&e<t)return(e-this.video_.currentTime)/(t-this.video_.currentTime)}return 0},shaka.Player.prototype.resetConfiguration=function(){for(var e in goog.asserts.assert(this.config_,"Cannot be destroyed"),this.config_)delete this.config_[e];shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,this.defaultConfig_(),this.defaultConfig_()),this.applyConfig_()},shaka.Player.prototype.getLoadMode=function(){return this.loadMode_},shaka.Player.prototype.getManifestType=function(){return this.manifest_?this.manifest_.type:null},shaka.Player.prototype.getMediaElement=function(){return this.video_},shaka.Player.prototype.getNetworkingEngine=function(){return this.networkingEngine_},shaka.Player.prototype.getAssetUri=function(){return this.assetUri_},shaka.Player.prototype.getAdManager=function(){return this.adManager_?this.adManager_:null},shaka.Player.prototype.isLive=function(){return this.manifest_&&!this.isRemotePlayback()?this.manifest_.presentationTimeline.isLive():!(!this.video_||!this.video_.src)&&1/0==this.video_.duration},shaka.Player.prototype.isInProgress=function(){return!!this.manifest_&&this.manifest_.presentationTimeline.isInProgress()},shaka.Player.prototype.isAudioOnly=function(){if(this.manifest_&&!this.isRemotePlayback()){var e=this.manifest_.variants;return!!e.length&&!e[0].video}return!(!this.video_||!this.video_.src)&&(this.video_.videoTracks?0==this.video_.videoTracks.length:0==this.video_.videoHeight)},shaka.Player.prototype.seekRange=function(){if(this.manifest_&&!this.isRemotePlayback()){if(!this.fullyLoaded_&&this.manifest_.type==shaka.media.ManifestParser.HLS)return{start:0,end:0};var e=this.manifest_.presentationTimeline;return{start:e.getSeekRangeStart(),end:e.getSeekRangeEnd()}}if(this.video_&&this.video_.src&&(e=this.video_.seekable)&&e.length){var t=this.config_?this.config_.playRangeStart:0;t=Math.max(e.start(0),t);var r=this.config_?this.config_.playRangeEnd:1/0;return{start:t,end:e=Math.min(e.end(e.length-1),r)}}return{start:0,end:0}},shaka.Player.prototype.goToLive=function(){this.isLive()?this.video_.currentTime=this.seekRange().end:shaka.log.warning("goToLive is for live streams!")},shaka.Player.prototype.isFullyLoaded=function(){return this.fullyLoaded_},shaka.Player.prototype.keySystem=function(){return shaka.drm.DrmUtils.keySystem(this.drmInfo())},shaka.Player.prototype.drmInfo=function(){return this.drmEngine_?this.drmEngine_.getDrmInfo():null},shaka.Player.prototype.getDrmEngine=function(){return this.drmEngine_},shaka.Player.prototype.getExpiration=function(){return this.drmEngine_?this.drmEngine_.getExpiration():1/0},shaka.Player.prototype.getActiveSessionsMetadata=function(){return this.drmEngine_?this.drmEngine_.getActiveSessionsMetadata():[]},shaka.Player.prototype.getKeyStatuses=function(){return this.drmEngine_?this.drmEngine_.getKeyStatuses():{}},shaka.Player.prototype.isBuffering=function(){var e=shaka.media.BufferingObserver.State;return!!this.bufferObserver_&&this.bufferObserver_.getState()==e.STARVING},shaka.Player.prototype.getPlaybackRate=function(){return this.video_?this.playRateController_?this.playRateController_.getRealRate():1:0},shaka.Player.prototype.trickPlay=function(e,t){t=void 0===t||t,goog.asserts.assert(0!=e,"Should never set a trick play rate of 0!"),0==e?shaka.log.alwaysWarn("A trick play rate of 0 is unsupported!"):(this.playRateController_.set(e),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&(this.abrManager_.playbackRateChanged(e),this.streamingEngine_.setTrickPlay(t&&1<Math.abs(e))),this.setupTrickPlayEventListeners_(e))},shaka.Player.prototype.cancelTrickPlay=function(){var e=this.playRateController_.getDefaultRate();this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&this.playRateController_.set(e),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&(this.playRateController_.set(e),this.abrManager_.playbackRateChanged(e),this.streamingEngine_.setTrickPlay(!1)),this.trickPlayEventManager_.removeAll()},shaka.Player.prototype.getVariantTracks=function(){if(this.manifest_&&!this.isRemotePlayback()){for(var e=this.streamingEngine_?this.streamingEngine_.getCurrentVariant():null,t=[],r=0,n=$jscomp.makeIterator(this.manifest_.variants),a=n.next();!a.done;a=n.next())if(a=a.value,shaka.util.StreamUtils.isPlayable(a)){var i=shaka.util.StreamUtils.variantToTrack(a);i.active=a==e,i.active||1==r||null==e||a.video!=e.video||a.audio!=e.audio||(i.active=!0),i.active&&r++,t.push(i)}return goog.asserts.assert(1>=r,"It should only have one active track"),t}return this.video_&&this.video_.audioTracks?Array.from(this.video_.audioTracks).map((function(e){return shaka.util.StreamUtils.html5AudioTrackToTrack(e)})):[]},shaka.Player.prototype.getTextTracks=function(){if(this.manifest_&&!this.isRemotePlayback()){for(var e=this.streamingEngine_?this.streamingEngine_.getCurrentTextStream():null,t=[],r=$jscomp.makeIterator(this.manifest_.textStreams),n=r.next();!n.done;n=r.next()){n=n.value;var a=shaka.util.StreamUtils.textStreamToTrack(n);a.active=n==e,t.push(a)}return t}if(this.video_&&this.video_.src&&this.video_.textTracks){e=this.getFilteredTextTracks_();var i=shaka.util.StreamUtils;return e.map((function(e){return i.html5TextTrackToTrack(e)}))}return[]},shaka.Player.prototype.getImageTracks=function(){var e=shaka.util.StreamUtils,t=this.externalSrcEqualsThumbnailsStreams_;return this.manifest_&&(t=this.manifest_.imageStreams),t.map((function(t){return e.imageStreamToTrack(t)}))},shaka.Player.prototype.getAllThumbnails=function(e){var t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?a.yield(n.getBestImageStream_(e),2):(t=a.yieldResult)?(r=[],t.segmentIndex.forEachTopLevelReference((function(e){var a=n.parseTilesLayout_(e.getTilesLayout()||t.tilesLayout);if(a){a=a.rows*a.columns;for(var i=e.trueEndTime-e.startTime,s=0;s<a;s++){var o=n.getThumbnailsByStream_(t,e.startTime+i*s/a);o&&r.push(o)}}})),t.closeSegmentIndex&&t.closeSegmentIndex(),a.return(r)):a.return(null)}))},shaka.Player.prototype.parseTilesLayout_=function(e){if(!e)return null;var t=/(\d+)x(\d+)/.exec(e);return t?{columns:e=parseInt(t[1],10),rows:t=parseInt(t[2],10)}:(shaka.log.warning("Tiles layout does not contain a valid format  (columns x rows)"),null)},shaka.Player.prototype.getThumbnails=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?a.yield(n.getBestImageStream_(e),2):(r=a.yieldResult)?a.return(n.getThumbnailsByStream_(r,t)):a.return(null)}))},shaka.Player.prototype.getBestImageStream_=function(e){var t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?n.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&n.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS?a.return(null):(t=n.externalSrcEqualsThumbnailsStreams_,n.manifest_&&(t=n.manifest_.imageStreams),(r=t[0])?(null!=e&&(r=t.find((function(t){return t.id==e}))),r?r.segmentIndex?a.jumpTo(2):a.yield(r.createSegmentIndex(),2):a.return(null)):a.return(null)):a.return(r)}))},shaka.Player.prototype.getThumbnailsByStream_=function(e,t){var r=e.segmentIndex.find(t);if(null==r)return null;r=e.segmentIndex.get(r);var n=this.parseTilesLayout_(r.getTilesLayout()||e.tilesLayout);if(!n)return null;var a=e.width||0,i=e.height||0,s=a/n.columns,o=i/n.rows,l=n.columns*n.rows,u=r.trueEndTime-r.startTime;u=r.getTileDuration()||u/l;var c=r.startTime,d=0,p=0;return 1<l&&(t=Math.floor((t-r.startTime)/u),c=r.startTime+t*u,d=t%n.columns*s,p=Math.floor(t/n.columns)*o),t=!1,(n=r.getThumbnailSprite())&&(t=!0,o=n.height,d=n.positionX,p=n.positionY,s=n.width),{segment:r,imageHeight:i,imageWidth:a,height:o,positionX:d,positionY:p,startTime:c,duration:u,uris:r.getUris(),width:s,sprite:t,mimeType:r.mimeType||e.mimeType,codecs:r.codecs||e.codecs}},shaka.Player.prototype.selectTextTrack=function(e){var t,r=this;this.manifest_&&this.playhead_&&((t=r.manifest_.textStreams.find((function(t){return t.id==e.id})))?t==r.streamingEngine_.getCurrentTextStream()?shaka.log.debug("Text track already selected."):(r.addTextStreamToSwitchHistory_(t,!1),r.streamingEngine_.switchTextStream(t),r.onTextChanged_(),r.setTextDisplayerLanguage_(),r.currentTextLanguage_=t.language):r.isRemotePlayback()||shaka.log.error("No stream with id",e.id),!this.isRemotePlayback())||function(){if(r.video_&&r.video_.textTracks){var t=r.getFilteredTextTracks_(),n=t.find((function(e){return"disabled"!==e.mode}));(t=t.find((function(t){return shaka.util.StreamUtils.html5TrackId(t)===e.id})))?(n!==t&&(n&&(n.mode="disabled",r.loadEventManager_.unlisten(n,"cuechange"),r.textDisplayer_.remove(0,1/0)),t&&r.enableNativeTrack_(t)),r.onTextChanged_(),r.setTextDisplayerLanguage_()):shaka.log.error("No track with id",e.id)}}()},shaka.Player.prototype.enableNativeTrack_=function(e){var t=this;this.loadEventManager_.listen(e,"cuechange",(function(){t.textDisplayer_.remove(0,Math.max(0,t.video_.currentTime-t.config_.streaming.bufferBehind));for(var r={periodStart:0,segmentStart:0,segmentEnd:t.video_.duration,vttOffset:0},n=[],a=Array.from(e.activeCues||[]),i=(a=$jscomp.makeIterator(a)).next();!i.done;i=a.next())if(i=shaka.text.Utils.mapNativeCueToShakaCue(i.value)){var s=t.config_.mediaSource.modifyCueCallback;s&&s(i,null,r),n.push(i)}t.textDisplayer_.append(n)})),e.mode=document.pictureInPictureElement?"showing":"hidden"},shaka.Player.prototype.selectVariantTrack=function(e,t,r){var n=this;t=void 0!==t&&t,r=void 0===r?0:r;this.manifest_&&this.playhead_&&(function(){var a=n.manifest_.variants.find((function(t){return t.id==e.id}));if(a)if(shaka.util.StreamUtils.isPlayable(a)){var i=n.streamingEngine_.getCurrentVariant();n.config_.abr.enabled&&(i.video!=a.video||i.audio&&a.audio&&i.audio.language==a.audio.language&&i.audio.channelsCount==a.audio.channelsCount&&i.audio.label==a.audio.label)&&shaka.log.alwaysWarn("Changing tracks while abr manager is enabled will likely result in the selected track being overridden. Consider disabling abr before calling selectVariantTrack()."),n.isRemotePlayback()?n.switchVariant_(a,!1,!1,0):n.switchVariant_(a,!1,t||!1,r||0),n.currentAdaptationSetCriteria_.configure({language:a.language,role:a.audio&&a.audio.roles&&a.audio.roles[0]||"",channelCount:a.audio&&a.audio.channelsCount?a.audio.channelsCount:0,hdrLevel:a.video&&a.video.hdr?a.video.hdr:"",spatialAudio:!(!a.audio||!a.audio.spatialAudio)&&a.audio.spatialAudio,videoLayout:a.video&&a.video.videoLayout?a.video.videoLayout:"",audioLabel:a.audio&&a.audio.label?a.audio.label:"",videoLabel:"",codecSwitchingStrategy:n.config_.mediaSource.codecSwitchingStrategy,audioCodec:a.audio&&a.audio.codecs?a.audio.codecs:""}),n.updateAbrManagerVariants_()}else shaka.log.error("Unable to switch to restricted track",e.id);else n.isRemotePlayback()||shaka.log.error("No variant with id",e.id)}(),!this.isRemotePlayback())||function(){if(n.video_&&n.video_.audioTracks)for(var t=Array.from(n.video_.audioTracks),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())if(r=r.value,shaka.util.StreamUtils.html5TrackId(r)==e.id){n.switchHtml5Track_(r);break}}()},shaka.Player.prototype.selectAudioTrack=function(e,t){t=void 0===t?0:t;var r=shaka.util.ArrayUtils,n=this.getVariantTracks();if(n.length){var a=n.find((function(e){return e.active}));a&&(n=n.find((function(t){return t.videoId===a.videoId&&t.language==e.language&&t.label==e.label&&t.audioMimeType==e.mimeType&&t.audioCodec==e.codecs&&t.primary==e.primary&&r.equal(t.audioRoles,e.roles)&&t.accessibilityPurpose==e.accessibilityPurpose&&t.channelsCount==e.channelsCount&&t.audioSamplingRate==e.audioSamplingRate&&t.spatialAudio==e.spatialAudio})))&&!n.active&&this.selectVariantTrack(n,!0,t)}},shaka.Player.prototype.getAudioTracks=function(){var e=this.getVariantTracks();if(!e.length)return[];var t=e.find((function(e){return e.active}));if(!t)return[];var r=e;if(this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&(r=e.filter((function(e){return e.originalVideoId===t.originalVideoId&&e.audioCodec}))),!r.length)return[];e=new Map;for(var n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next()){var a=(n=n.value).originalAudioId;a||null==n.audioId||(a=String(n.audioId)),a&&e.set(a,{active:n.active,language:n.language,label:n.label,mimeType:n.audioMimeType,codecs:n.audioCodec,primary:n.primary,roles:n.audioRoles||[],accessibilityPurpose:n.accessibilityPurpose,channelsCount:n.channelsCount,audioSamplingRate:n.audioSamplingRate,spatialAudio:n.spatialAudio,originalLanguage:n.originalLanguage})}return Array.from(e.values())},shaka.Player.prototype.getAudioLanguagesAndRoles=function(){return shaka.Player.getLanguageAndRolesFrom_(this.getVariantTracks())},shaka.Player.prototype.getTextLanguagesAndRoles=function(){return shaka.Player.getLanguageAndRolesFrom_(this.getTextTracks())},shaka.Player.prototype.getAudioLanguages=function(){return Array.from(shaka.Player.getLanguagesFrom_(this.getVariantTracks()))},shaka.Player.prototype.getTextLanguages=function(){return Array.from(shaka.Player.getLanguagesFrom_(this.getTextTracks()))},shaka.Player.prototype.selectAudioLanguage=function(e,t,r,n,a,i,s){var o=this;r=void 0===r?0:r,n=void 0===n?0:n,a=void 0===a?"":a,i=void 0!==i&&i,s=void 0===s?"":s;this.manifest_&&this.playhead_&&(function(){o.currentAdaptationSetCriteria_=o.config_.adaptationSetCriteriaFactory(),o.currentAdaptationSetCriteria_.configure({language:e,role:t||"",channelCount:r||0,hdrLevel:"",spatialAudio:i||!1,videoLayout:"",audioLabel:s||"",videoLabel:"",codecSwitchingStrategy:o.config_.mediaSource.codecSwitchingStrategy,audioCodec:a||""});for(var l=function(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0},u=o.streamingEngine_.getCurrentVariant(),c=o.currentAdaptationSetCriteria_.create(o.manifest_.variants),d=null,p=(c=$jscomp.makeIterator(c.values())).next();!p.done;p=c.next())p=p.value,shaka.util.StreamUtils.isPlayable(p)&&(!d||l(d,u)>l(p,u))&&(d=p);d==u?shaka.log.debug("Audio already selected."):d?(l=shaka.util.StreamUtils.variantToTrack(d),o.selectVariantTrack(l,!0,n||0)):o.chooseVariantAndSwitch_()}(),!this.isRemotePlayback())||function(){if(o.video_&&o.video_.audioTracks){var r=shaka.util.StreamUtils.filterStreamsByLanguageAndRole(o.getVariantTracks(),e,t||"",!1)[0];r&&o.selectVariantTrack(r)}}()},shaka.Player.prototype.selectTextLanguage=function(e,t,r){var n=this;r=void 0!==r&&r;var a;this.manifest_&&this.playhead_&&(function(){n.currentTextLanguage_=e,n.currentTextRole_=t||"",n.currentTextForced_=r||!1;var a=n.chooseTextStream_();a&&(a==n.streamingEngine_.getCurrentTextStream()?shaka.log.debug("Text track already selected."):(n.addTextStreamToSwitchHistory_(a,!1),n.shouldStreamText_()&&(n.streamingEngine_.switchTextStream(a),n.onTextChanged_(),n.setTextDisplayerLanguage_())))}(),!this.isRemotePlayback())||(a=shaka.util.StreamUtils.filterStreamsByLanguageAndRole(n.getTextTracks(),e,t||"",r||!1)[0])&&n.selectTextTrack(a)},shaka.Player.prototype.selectVariantsByLabel=function(e,t,r){var n=this;t=void 0===t||t,r=void 0===r?0:r;this.manifest_&&this.playhead_&&(function(){for(var a=null,i=$jscomp.makeIterator(n.manifest_.variants),s=i.next();!s.done;s=i.next())if((s=s.value).audio.label==e){a=s;break}null==a?shaka.log.warning("No variants were found with label: "+e+". Ignoring the request to switch."):(n.currentAdaptationSetCriteria_=n.config_.adaptationSetCriteriaFactory(),n.currentAdaptationSetCriteria_.configure({language:a.language,role:"",channelCount:0,hdrLevel:"",spatialAudio:!1,videoLayout:"",videoLabel:"",audioLabel:e,codecSwitchingStrategy:n.config_.mediaSource.codecSwitchingStrategy,audioCodec:""}),n.chooseVariantAndSwitch_(t,r))}(),!this.isRemotePlayback())||function(){if(n.video_&&n.video_.audioTracks){for(var t=Array.from(n.video_.audioTracks),r=null,a=(t=$jscomp.makeIterator(t)).next();!a.done;a=t.next())(a=a.value).label==e&&(r=a);r&&n.switchHtml5Track_(r)}}()},shaka.Player.prototype.isTextTrackVisible=function(){var e=this.isTextVisible_;if(this.textDisplayer_){var t=this.textDisplayer_.isTextVisible();return goog.asserts.assert(t==e,"text visibility has fallen out of sync"),t}return e},shaka.Player.prototype.getChaptersTracks=function(){if(this.video_&&this.video_.currentSrc&&this.video_.textTracks){var e=this.getChaptersTracks_(),t=shaka.util.StreamUtils;return e.map((function(e){return t.html5TextTrackToTrack(e)}))}return[]},shaka.Player.prototype.getChapters=function(e){if(!this.video_||!this.video_.currentSrc||!this.video_.textTracks)return[];var t=shaka.util.LanguageUtils,r=t.normalize(e),n=this.getChaptersTracks_().filter((function(e){return t.normalize(e.language)==r}));if(!n||!n.length)return[];e=[];for(var a=new Set,i=(n=$jscomp.makeIterator(n)).next();!i.done;i=n.next())if((i=i.value)&&i.cues)for(var s=(i=$jscomp.makeIterator(i.cues)).next();!s.done;s=i.next()){var o=s.value;(s=o.id)&&""!=s||(s=o.startTime+"-"+o.endTime+"-"+o.text),o={id:s,title:o.text,startTime:o.startTime,endTime:o.endTime},a.has(s)||(e.push(o),a.add(s))}return e},shaka.Player.prototype.getFilteredTextTracks_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&e.label!=shaka.Player.TextTrackLabel}))},shaka.Player.prototype.getGeneratedTextTrack_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).find((function(e){return e.label==shaka.Player.TextTrackLabel}))},shaka.Player.prototype.getMetadataTracks_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).filter((function(e){return"metadata"==e.kind}))},shaka.Player.prototype.getChaptersTracks_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).filter((function(e){return"chapters"==e.kind}))},shaka.Player.prototype.setTextTrackVisibility=function(e){e=!!e,this.isTextVisible_!=e&&(this.isTextVisible_=e,this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE?(this.textDisplayer_.setTextVisibility(e),this.config_.streaming.alwaysStreamText||(e?this.streamingEngine_.getCurrentTextStream()||0<(e=shaka.util.StreamUtils.filterStreamsByLanguageAndRole(this.manifest_.textStreams,this.currentTextLanguage_,this.currentTextRole_,this.currentTextForced_)).length&&(this.streamingEngine_.switchTextStream(e[0]),this.onTextChanged_(),this.setTextDisplayerLanguage_()):this.streamingEngine_.unloadTextStream())):this.video_&&this.video_.src&&this.video_.textTracks&&this.textDisplayer_.setTextVisibility(e),this.onTextTrackVisibility_())},shaka.Player.prototype.getPlayheadTimeAsDate=function(){if(this.playhead_)var e=this.playhead_.getTime();else{if(null==this.startTime_)return new Date;e=this.startTime_}if(this.manifest_&&!this.isRemotePlayback()){var t=this.manifest_.presentationTimeline;return t=t.getInitialProgramDateTime()||t.getPresentationStartTime(),new Date(1e3*(t+e))}return this.video_&&this.video_.getStartDate?(t=this.video_.getStartDate(),isNaN(t.getTime())?(shaka.log.warning("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(t.getTime()+1e3*e)):(shaka.log.warning("No way to get playhead time as Date!"),null)},shaka.Player.prototype.getPresentationStartTimeAsDate=function(){if(this.manifest_&&!this.isRemotePlayback()){var e=this.manifest_.presentationTimeline;return e=e.getInitialProgramDateTime()||e.getPresentationStartTime(),goog.asserts.assert(null!=e,"Presentation start time should not be null!"),new Date(1e3*e)}return this.video_&&this.video_.getStartDate?(e=this.video_.getStartDate(),isNaN(e.getTime())?(shaka.log.warning("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):e):(shaka.log.warning("No way to get presentation start time as Date!"),null)},shaka.Player.prototype.getSegmentAvailabilityDuration=function(){return this.isLive()?this.manifest_?this.manifest_.presentationTimeline.getSegmentAvailabilityDuration():(shaka.log.warning("No way to get segment segment availability duration!"),null):(shaka.log.warning("getSegmentAvailabilityDuration is for live streams!"),null)},shaka.Player.prototype.getBufferedInfo=function(){if(this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE)return this.mediaSourceEngine_.getBufferedInfo();var e={total:[],audio:[],video:[],text:[]};return this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&(e.total=shaka.media.TimeRangesUtils.getBufferedInfo(this.video_.buffered)),e},shaka.Player.prototype.getLiveLatency=function(){if(!this.video_||!this.video_.currentTime)return null;var e=this.getPresentationStartTimeAsDate().getTime()+1e3*this.video_.currentTime;return Math.floor(Date.now()-e)},shaka.Player.prototype.getStats=function(){if(this.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&this.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)return shaka.util.Stats.getEmptyBlob();this.updateStateHistory_(),goog.asserts.assert(this.video_,"If we have stats, we should have video_");var e=this.video_,t=e.currentTime/e.duration;if(isNaN(t)||this.isLive()||this.stats_.setCompletionPercent(Math.round(100*t)),this.playhead_&&(this.stats_.setGapsJumped(this.playhead_.getGapsJumped()),this.stats_.setStallsDetected(this.playhead_.getStallsDetected())),e.getVideoPlaybackQuality&&(t=e.getVideoPlaybackQuality(),this.stats_.setDroppedFrames(Number(t.droppedVideoFrames),Number(t.totalVideoFrames)),this.stats_.setCorruptedFrames(Number(t.corruptedVideoFrames))),t=this.drmEngine_?this.drmEngine_.getLicenseTime():NaN,this.stats_.setLicenseTime(t),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE){t=this.streamingEngine_.getCurrentVariant();var r=this.streamingEngine_.getCurrentTextStream();if(t){var n=this.playRateController_?this.playRateController_.getRealRate():1,a=n*t.bandwidth;r&&r.bandwidth&&(a+=n*r.bandwidth),this.stats_.setCurrentStreamBandwidth(a)}t&&t.video&&this.stats_.setResolution(t.video.width||NaN,t.video.height||NaN),this.isLive()&&(t=this.getLiveLatency()||0,this.stats_.setLiveLatency(t/1e3)),this.manifest_&&(this.stats_.setManifestPeriodCount(this.manifest_.periodCount),this.stats_.setManifestGapCount(this.manifest_.gapCount),this.manifest_.presentationTimeline&&(t=this.manifest_.presentationTimeline.getMaxSegmentDuration(),this.stats_.setMaxSegmentDuration(t))),t=this.abrManager_.getBandwidthEstimate(),this.stats_.setBandwidthEstimate(t)}return this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&(this.stats_.addBytesDownloaded(NaN),this.stats_.setResolution(e.videoWidth||NaN,e.videoHeight||NaN)),this.stats_.getBlob()},shaka.Player.prototype.addTextTrackAsync=function(e,t,r,n,a,i,s){s=void 0!==s&&s;var o,l,u,c,d,p,h,f,m,g,y,v,_,k=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(E){switch(E.nextAddress){case 1:if(k.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&k.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Must call load() and wait for it to resolve before adding text tracks."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.CONTENT_NOT_LOADED);if("subtitles"!=r&&"captions"!=r&&shaka.log.alwaysWarn("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),n){E.jumpTo(2);break}return E.yield(k.getTextMimetype_(e),3);case 3:n=E.yieldResult;case 2:if(o=[],k.adManager_&&(o=k.adManager_.getCuePoints()),k.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS){E.jumpTo(4);break}return s&&(r="forced"),E.yield(k.addSrcTrackElement_(e,t,r,n,i||"",o),5);case 5:if(l=shaka.util.LanguageUtils,u=l.normalize(t),c=k.getTextTracks(),d=c.find((function(e){return l.normalize(e.language)==u&&e.label==(i||"")&&e.kind==r})))return k.onTracksChanged_(),E.return(d);throw shaka.log.error("Cannot add this text when loaded with src="),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS);case 4:if(p=shaka.util.ManifestParserUtils.ContentType,h=k.seekRange(),f=h.end-h.start,k.manifest_&&(f=k.manifest_.presentationTimeline.getDuration()),1/0==f)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM);if(!o.length){E.jumpTo(6);break}return goog.asserts.assert(k.networkingEngine_,"Need networking engine."),E.yield(k.getTextData_(e,k.networkingEngine_,k.config_.streaming.retryParameters),7);case 7:m=E.yieldResult,g=k.convertToWebVTT_(m,n,o),y=new Blob([g],{type:"text/vtt"}),e=shaka.media.MediaSourceEngine.createObjectURL(y),n="text/vtt";case 6:if(v={id:k.nextExternalStreamId_++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:shaka.media.SegmentIndex.forSingleSegment(0,f,[e]),mimeType:n||"",codecs:a||"",kind:r,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:i||null,type:p.TEXT,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!!s,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(n||"",a||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},_=shaka.util.MimeUtils.getFullType(v.mimeType,v.codecs),!shaka.text.TextEngine.isTypeSupported(_))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,n);return k.manifest_.textStreams.push(v),k.onTracksChanged_(),E.return(shaka.util.StreamUtils.textStreamToTrack(v))}}))},shaka.Player.prototype.addThumbnailsTrack=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(E){switch(E.nextAddress){case 1:if(k.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&k.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Must call load() and wait for it to resolve before adding image tracks."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.CONTENT_NOT_LOADED);if(t){E.jumpTo(2);break}return E.yield(k.getTextMimetype_(e),3);case 3:t=E.yieldResult;case 2:if("text/vtt"!=t)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.UNSUPPORTED_EXTERNAL_THUMBNAILS_URI,e);if(r=shaka.util.ManifestParserUtils.ContentType,n=k.seekRange(),a=n.end-n.start,k.manifest_&&(a=k.manifest_.presentationTimeline.getDuration()),1/0==a)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM);return goog.asserts.assert(k.networkingEngine_,"Need networking engine."),E.yield(k.getTextData_(e,k.networkingEngine_,k.config_.streaming.retryParameters),4);case 4:if(i=E.yieldResult,!(s=shaka.text.TextEngine.findParser(t)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,t);for(o=s(),l={periodStart:0,segmentStart:0,segmentEnd:a,vttOffset:0},u=shaka.util.BufferUtils.toUint8(i),c=o.parseMedia(u,l,e,[]),d=[],p=$jscomp.makeIterator(c),h=p.next(),f={};!h.done;f={uris$jscomp$5:void 0,cue$jscomp$40:void 0},h=p.next())f.cue$jscomp$40=h.value,f.uris$jscomp$5=null,m=function(t){return function(){return null==t.uris$jscomp$5&&(t.uris$jscomp$5=shaka.util.ManifestParserUtils.resolveUris([e],[t.cue$jscomp$40.payload])),t.uris$jscomp$5||[]}}(f),g=new shaka.media.SegmentReference(f.cue$jscomp$40.startTime,f.cue$jscomp$40.endTime,m,0,null,null,0,0,1/0),f.cue$jscomp$40.payload.includes("#xywh")&&(4===(y=f.cue$jscomp$40.payload.split("#xywh=")[1].split(",")).length&&g.setThumbnailSprite({height:parseInt(y[3],10),positionX:parseInt(y[0],10),positionY:parseInt(y[1],10),width:parseInt(y[2],10)})),d.push(g);if(v=t,!d.length){E.jumpTo(5);break}return E.yield(shaka.net.NetworkingUtils.getMimeType(d[0].getUris()[0],k.networkingEngine_,k.config_.manifest.retryParameters),6);case 6:v=E.yieldResult;case 5:return _={id:k.nextExternalStreamId_++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new shaka.media.SegmentIndex(d),mimeType:v||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:r.IMAGE,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(v||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null},k.loadMode_==shaka.Player.LoadMode.SRC_EQUALS?k.externalSrcEqualsThumbnailsStreams_.push(_):k.manifest_.imageStreams.push(_),k.onTracksChanged_(),E.return(shaka.util.StreamUtils.imageStreamToTrack(_))}}))},shaka.Player.prototype.addChaptersTrack=function(e,t,r){var n,a,i,s,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(o.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&o.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Must call load() and wait for it to resolve before adding chapters tracks."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.CONTENT_NOT_LOADED);if(r){l.jumpTo(2);break}return l.yield(o.getTextMimetype_(e),3);case 3:r=l.yieldResult;case 2:return n=[],o.adManager_&&(n=o.adManager_.getCuePoints()),l.yield(o.addSrcTrackElement_(e,t,"chapters",r,"",n),4);case 4:if(a=l.yieldResult,i=o.getChaptersTracks(),!(s=i.find((function(e){return e.language==t})))){l.jumpTo(5);break}return l.yield(new Promise((function(e,t){o.loadEventManager_.listenOnce(a,"load",e),o.loadEventManager_.listenOnce(a,"error",(function(e){t(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CHAPTERS_TRACK_FAILED))}))})),6);case 6:return o.onTracksChanged_(),l.return(s);case 5:throw shaka.log.error("Cannot add this text when loaded with src="),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS)}}))},shaka.Player.prototype.getTextMimetype_=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){switch(n.nextAddress){case 1:return n.setCatchFinallyBlocks(2),goog.asserts.assert(r.networkingEngine_,"Need networking engine."),n.yield(shaka.net.NetworkingUtils.getMimeType(e,r.networkingEngine_,r.config_.streaming.retryParameters),4);case 4:t=n.yieldResult,n.leaveTryBlock(3);break;case 2:n.enterCatchBlock();case 3:if(t)return n.return(t);throw shaka.log.error("The mimeType has not been provided and it could not be deduced from its uri."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.TEXT_COULD_NOT_GUESS_MIME_TYPE,e)}}))},shaka.Player.prototype.addSrcTrackElement_=function(e,t,r,n,a,i){var s,o,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){return 1==d.nextAddress?"text/vtt"!=n||i.length?(goog.asserts.assert(c.networkingEngine_,"Need networking engine."),d.yield(c.getTextData_(e,c.networkingEngine_,c.config_.streaming.retryParameters),3)):d.jumpTo(2):(2!=d.nextAddress&&(s=d.yieldResult,o=c.convertToWebVTT_(s,n,i),l=new Blob([o],{type:"text/vtt"}),e=shaka.media.MediaSourceEngine.createObjectURL(l),n="text/vtt"),(u=document.createElement("track")).src=c.cmcdManager_.appendTextTrackData(e),u.label=a,u.kind=r,u.srclang=t,c.video_.getAttribute("crossorigin")||c.video_.setAttribute("crossorigin","anonymous"),c.video_.appendChild(u),d.return(u))}))},shaka.Player.prototype.getTextData_=function(e,t,r){var n,a,i,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(n=shaka.net.NetworkingEngine.RequestType.SEGMENT,(a=shaka.net.NetworkingEngine.makeRequest([e],r)).method="GET",s.cmcdManager_.applyTextData(a),o.yield(t.request(n,a).promise,2)):(i=o.yieldResult,o.return(i.data))}))},shaka.Player.prototype.convertToWebVTT_=function(e,t,r){var n=shaka.text.TextEngine.findParser(t);if(n)return t=n(),n={periodStart:0,segmentStart:0,segmentEnd:this.video_.duration,vttOffset:0},e=shaka.util.BufferUtils.toUint8(e),e=t.parseMedia(e,n,null,[]),shaka.text.WebVttGenerator.convert(e,r);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,t)},shaka.Player.prototype.setMaxHardwareResolution=function(e,t){this.maxHwRes_.width=e,this.maxHwRes_.height=t},shaka.Player.prototype.retryStreaming=function(e){return this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&this.streamingEngine_.retry(void 0===e?.1:e)},shaka.Player.prototype.getManifest=function(){return shaka.log.alwaysWarn("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.manifest_},shaka.Player.prototype.getManifestParserFactory=function(){return this.parserFactory_},shaka.Player.prototype.getFetchedPlaybackInfo=function(){var e={video:null,audio:null,text:null};if(this.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE)return e;var t=shaka.util.ManifestParserUtils.ContentType,r=this.streamingEngine_.getCurrentVariant(),n=this.streamingEngine_.getCurrentTextStream(),a=this.video_.currentTime;for(n=(r=$jscomp.makeIterator([r.video,r.audio,n])).next();!n.done;n=r.next())if((n=n.value)&&n.segmentIndex){var i=n.segmentIndex.find(a);i={codecs:(i=n.segmentIndex.get(i)).codecs||n.codecs,mimeType:i.mimeType||n.mimeType,bandwidth:i.bandwidth||n.bandwidth},n.type==t.VIDEO?(i.width=n.width,i.height=n.height,e.video=i):n.type==t.AUDIO?e.audio=i:n.type==t.TEXT&&(e.text=i)}return e},shaka.Player.prototype.addVariantToSwitchHistory_=function(e,t){this.stats_.getSwitchHistory().updateCurrentVariant(e,t)},shaka.Player.prototype.addTextStreamToSwitchHistory_=function(e,t){this.stats_.getSwitchHistory().updateCurrentText(e,t)},shaka.Player.prototype.defaultConfig_=function(){var e=this,t=shaka.util.PlayerConfiguration.createDefault();return t.streaming.failureCallback=function(t){e.defaultStreamingFailureCallback_(t)},t.textDisplayFactory=function(){var t=shaka.util.Platform;return!e.videoContainer_||t.isApple()&&!document.fullscreenEnabled?"addTextTrack"in e.video_?new shaka.text.SimpleTextDisplayer(e.video_,shaka.Player.TextTrackLabel):(shaka.log.warning("Text tracks are not supported by the browser, disabling."),new shaka.text.StubTextDisplayer):new shaka.text.UITextDisplayer(e.video_,e.videoContainer_)},t},shaka.Player.prototype.setVideoContainer=function(e){this.videoContainer_=e},shaka.Player.prototype.defaultStreamingFailureCallback_=function(e){if(this.isLive()){var t=null;e.code==shaka.util.Error.Code.BAD_HTTP_STATUS||e.code==shaka.util.Error.Code.HTTP_ERROR?(t=1,this.config_.streaming.lowLatencyMode&&(t=.1)):e.code==shaka.util.Error.Code.TIMEOUT&&(t=.1),null!=t&&(e.severity=shaka.util.Error.Severity.RECOVERABLE,shaka.log.warning("Live streaming error.  Retrying automatically..."),this.retryStreaming(t))}},shaka.Player.prototype.makeTextStreamsForClosedCaptions_=function(e){for(var t=shaka.util.ManifestParserUtils.ContentType,r=shaka.util.ManifestParserUtils.TextStreamKind,n=shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE,a=shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE,i=new Set,s=$jscomp.makeIterator(e.textStreams),o=s.next();!o.done;o=s.next())(o=o.value).mimeType!=n&&o.mimeType!=a||i.add(o.originalId);for(o=(s=$jscomp.makeIterator(e.variants)).next();!o.done;o=s.next())if((o=o.value.video)&&o.closedCaptions)for(var l=$jscomp.makeIterator(o.closedCaptions.keys()),u=l.next();!u.done;u=l.next())if(u=u.value,!i.has(u)){var c=u.startsWith("CC")?n:a,d=new shaka.media.MetaSegmentIndex,p=o.closedCaptions.get(u);c={id:this.nextExternalStreamId_++,originalId:u,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:d,mimeType:c,codecs:"",kind:r.CLOSED_CAPTION,encrypted:!1,drmInfos:[],keyIds:new Set,language:p,originalLanguage:p,label:null,type:t.TEXT,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:o.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(c,"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},e.textStreams.push(c),i.add(u)}},shaka.Player.prototype.adjustStartTime_=function(e,t){var r,n,a,i,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(r=e.audio,n=e.video,a=function(e,t){var r,n,a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?e?e.segmentIndex?i.jumpTo(2):i.yield(e.createSegmentIndex(),2):i.return(null):(n=(r=e.segmentIndex.getIteratorForTime(t))?r.next().value:null)?(a=n.startTime,goog.asserts.assert(a<=t,"Segment should start before target time!"),i.return(a)):i.return(null)}))},o.yield(a(r,t),2)):3!=o.nextAddress?(i=o.yieldResult,o.yield(a(n,t),3)):null!=(s=o.yieldResult)&&null!=i?o.return(Math.max(s,i)):null!=s?o.return(s):null!=i?o.return(i):o.return(t)}))},shaka.Player.prototype.updateBufferState_=function(){var e=this.isBuffering();if(shaka.log.v2("Player changing buffering state to",e),this.stats_&&this.bufferObserver_&&this.playhead_){0==this.config_.streaming.rebufferingGoal?this.playRateController_.setBuffering(!1):this.playRateController_.setBuffering(e),this.cmcdManager_&&this.cmcdManager_.setBuffering(e),this.updateStateHistory_();var t=this.config_.streaming.liveSync.dynamicTargetLatency.maxAttempts;if(this.config_.streaming.liveSync.dynamicTargetLatency.enabled&&e&&this.rebufferingCount_<t){t=this.config_.streaming.liveSync.dynamicTargetLatency.maxLatency;var r=this.config_.streaming.liveSync.targetLatencyTolerance,n=this.config_.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;this.currentTargetLatency_&&(this.currentTargetLatency_=Math.min(this.currentTargetLatency_+ ++this.rebufferingCount_*n,t-r))}}t=shaka.util.FakeEvent.EventName.Buffering,e=(new Map).set("buffering",e),this.dispatchEvent(shaka.Player.makeEvent_(t,e))},shaka.Player.prototype.onRateChange_=function(){var e=this.video_.playbackRate;0!=e&&(this.playRateController_&&(this.playRateController_.set(e),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&this.abrManager_.playbackRateChanged(e),this.setupTrickPlayEventListeners_(e)),e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.RateChange),this.dispatchEvent(e))},shaka.Player.prototype.setupTrickPlayEventListeners_=function(e){var t=this;this.trickPlayEventManager_.removeAll(),this.trickPlayEventManager_.listen(this.video_,"timeupdate",(function(){var r=t.video_.currentTime,n=t.seekRange(),a=t.isLive()?t.config_.streaming.safeSeekOffset:0;0<e?Math.floor(r)>=Math.floor(n.end)&&t.cancelTrickPlay():Math.floor(r)<=Math.floor(n.start+a)&&t.cancelTrickPlay()}))},shaka.Player.prototype.updateStateHistory_=function(){if(this.stats_&&this.bufferObserver_){var e=shaka.media.BufferingObserver.State,t=this.stats_.getStateHistory(),r="playing";this.bufferObserver_.getState()==e.STARVING?r="buffering":this.isEnded()?r="ended":this.video_.paused&&(r="paused"),t.update(r)&&(e=shaka.util.FakeEvent.EventName.StateChanged,r=(new Map).set("newstate",r),this.dispatchEvent(shaka.Player.makeEvent_(e,r)))}},shaka.Player.prototype.onTimeUpdate_=function(){var e=this.video_.playbackRate,t=this.isLive();if(this.config_.streaming.vodDynamicPlaybackRate&&!t){var r=this.config_.streaming.vodDynamicPlaybackRateLowBufferRate,n=this.getBufferFullness(),a=this.config_.streaming.vodDynamicPlaybackRateBufferRatio;n<=a?e!=r&&(shaka.log.debug("Buffer fullness ratio ("+n+") is less than the vodDynamicPlaybackRateBufferRatio ("+a+"). Updating playbackRate to "+r),this.trickPlay(r,!1)):1==n&&e!==this.playRateController_.getDefaultRate()&&(shaka.log.debug("Buffer is full. Cancel trick play."),this.cancelTrickPlay())}if(t&&(t=this.seekRange(),Number.isFinite(t.end)&&!(this.video_.currentTime<t.start||this.video_.paused))){if(r=this.config_.streaming.liveSync.targetLatencyTolerance,n=this.config_.streaming.liveSync.dynamicTargetLatency.enabled,a=this.config_.streaming.liveSync.dynamicTargetLatency.stabilityThreshold,this.config_.streaming.liveSync&&this.config_.streaming.liveSync.enabled)var i=this.config_.streaming.liveSync.targetLatency,s=i+r,o=Math.max(0,i-r),l=this.config_.streaming.liveSync.maxPlaybackRate,u=this.config_.streaming.liveSync.minPlaybackRate;else this.manifest_&&this.manifest_.serviceDescription&&(i=this.manifest_.serviceDescription.targetLatency,null!=this.manifest_.serviceDescription.targetLatency?s=this.manifest_.serviceDescription.targetLatency+r:null!=this.manifest_.serviceDescription.maxLatency&&(s=this.manifest_.serviceDescription.maxLatency),null!=this.manifest_.serviceDescription.targetLatency?o=Math.max(0,this.manifest_.serviceDescription.targetLatency-r):null!=this.manifest_.serviceDescription.minLatency&&(o=this.manifest_.serviceDescription.minLatency),l=this.manifest_.serviceDescription.maxPlaybackRate||this.config_.streaming.liveSync.maxPlaybackRate,u=this.manifest_.serviceDescription.minPlaybackRate||this.config_.streaming.liveSync.minPlaybackRate);this.currentTargetLatency_||"number"!=typeof i||(this.currentTargetLatency_=i);var c=this.config_.streaming.liveSync.dynamicTargetLatency.maxAttempts;n&&this.targetLatencyReached_&&null!==this.currentTargetLatency_&&"number"==typeof i&&this.rebufferingCount_<c&&Date.now()-this.targetLatencyReached_>1e3*a&&(a=this.config_.streaming.liveSync.dynamicTargetLatency.minLatency,this.currentTargetLatency_=Math.max(this.currentTargetLatency_-(i-a)/2,a+r),this.targetLatencyReached_=Date.now()),n&&null!==this.currentTargetLatency_&&(s=this.currentTargetLatency_+r,o=this.currentTargetLatency_-r),i=t.end-this.video_.currentTime,r=0,this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&(0<(n=this.video_.buffered).length&&(r=n.end(n.length-1),r=Math.max(l,r-t.end))),t=this.config_.streaming.liveSync.panicMode,n=1e3*this.config_.streaming.liveSync.panicThreshold,a=Date.now()-this.bufferObserver_.getLastRebufferTime(),t&&!u&&(u=this.config_.streaming.liveSync.minPlaybackRate),t&&u&&a<=n?e!=u&&(shaka.log.debug("Time since last rebuffer ("+a+"s) is less than the live sync panicThreshold ("+n+"s). Updating playbackRate to "+u),this.trickPlay(u,!1)):null!=s&&l&&i-r>s?(e!=l&&(shaka.log.debug("Latency ("+i+"s) is greater than live sync maxLatency ("+s+"s). Updating playbackRate to "+l),this.trickPlay(l,!1)),this.targetLatencyReached_=null):null!=o&&u&&i-r<o?(e!=u&&(shaka.log.debug("Latency ("+i+"s) is smaller than live sync minLatency ("+o+"s). Updating playbackRate to "+u),this.trickPlay(u,!1)),this.targetLatencyReached_=null):e!==this.playRateController_.getDefaultRate()&&(this.cancelTrickPlay(),this.targetLatencyReached_=Date.now())}},shaka.Player.prototype.onVideoProgress_=function(){var e=this;if(this.video_){var t=function(t,r){return!!((shaka.util.NumberUtils.isFloatEqual(t,r)||r>t)&&e.completionPercent_<t)&&(e.completionPercent_=t,!0)},r=this.seekRange();if(r=0<(r=r.end-r.start)?this.video_.currentTime/r:0,!isNaN(r)){if(t(0,r*=100))var n=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Started);else t(25,r)?n=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.FirstQuartile):t(50,r)?n=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Midpoint):t(75,r)?n=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.ThirdQuartile):(t(100,r)&&(n=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Complete)),e.config_&&1/0!=e.config_.playRangeEnd&&e.isEnded()&&e.video_.pause());n&&this.dispatchEvent(n)}}},shaka.Player.prototype.onSeek_=function(){this.playheadObservers_&&this.playheadObservers_.notifyOfSeek(),this.streamingEngine_&&this.streamingEngine_.seeked(),this.bufferObserver_&&this.pollBufferState_()},shaka.Player.prototype.updateAbrManagerVariants_=function(){try{goog.asserts.assert(this.manifest_,"Manifest should exist by now!"),this.manifestFilterer_.checkRestrictedVariants(this.manifest_)}catch(e){return this.onError_(e),!1}var e=shaka.util.StreamUtils.getPlayableVariants(this.manifest_.variants);return e=this.currentAdaptationSetCriteria_.create(e),this.abrManager_.setVariants(Array.from(e.values())),!0},shaka.Player.prototype.chooseVariant_=function(){return this.updateAbrManagerVariants_()?this.abrManager_.chooseVariant():null},shaka.Player.prototype.checkVariants_=function(){goog.asserts.assert(this.manifest_,"Should have manifest!");for(var e=Date.now()/1e3,t=!1,r=!0,n=$jscomp.makeIterator(this.manifest_.variants),a=n.next();!a.done;a=n.next()){if(0<(a=a.value).disabledUntilTime&&a.disabledUntilTime<=e){a.disabledUntilTime=0,t=!0;var i=shaka.log,s=i.v2,o="";a.video&&(o+="video:"+a.video.id),a.audio&&(o=o+(o?"&":"")+"audio:"+a.audio.id),s.call(i,"Re-enabled variant with "+o)}0<a.disabledUntilTime&&(r=!1)}r&&this.checkVariantsTimer_.stop(),t&&this.chooseVariantAndSwitch_(!1,void 0,!1,!1)},shaka.Player.prototype.chooseTextStream_=function(){return shaka.util.StreamUtils.filterStreamsByLanguageAndRole(this.manifest_.textStreams,this.currentTextLanguage_,this.currentTextRole_,this.currentTextForced_)[0]||null},shaka.Player.prototype.chooseVariantAndSwitch_=function(e,t,r,n){e=void 0===e||e,t=void 0===t?0:t,r=void 0!==r&&r,n=void 0===n||n,goog.asserts.assert(this.config_,"Must not be destroyed");var a=this.chooseVariant_();a&&this.switchVariant_(a,n,e,t,r)},shaka.Player.prototype.switchVariant_=function(e,t,r,n,a){a=void 0!==a&&a;var i=this.streamingEngine_.getCurrentVariant();e==i?(shaka.log.debug("Variant already selected."),r&&this.streamingEngine_.switchVariant(e,r,n,!0)):(this.addVariantToSwitchHistory_(e,t),this.streamingEngine_.switchVariant(e,r,n,a,t),r=null,i&&(r=shaka.util.StreamUtils.variantToTrack(i)),(i=shaka.util.StreamUtils.variantToTrack(e)).active=!0,this.lcevcDec_&&this.lcevcDec_.updateVariant(e,this.getManifestType()),t?this.onAdaptation_(r,i):this.onVariantChanged_(r,i),this.checkAudioTracksChanged_(r,i))},shaka.Player.prototype.switchHtml5Track_=function(e){goog.asserts.assert(this.video_&&this.video_.audioTracks,"Video and video.audioTracks should not be null!");var t=Array.from(this.video_.audioTracks).find((function(e){return e.enabled}));e.enabled=!0,t&&(e.id!==t.id&&(t.enabled=!1),t=shaka.util.StreamUtils.html5AudioTrackToTrack(t),e=shaka.util.StreamUtils.html5AudioTrackToTrack(e),this.onVariantChanged_(t,e),this.checkAudioTracksChanged_(t,e))},shaka.Player.prototype.setInitialTextState_=function(e,t){t?(goog.asserts.assert(this.config_,"Must not be destroyed"),shaka.util.StreamUtils.shouldInitiallyShowText(e.audio,t,this.config_)&&(this.isTextVisible_=!0),this.isTextVisible_&&(this.textDisplayer_.setTextVisibility(!0),goog.asserts.assert(this.shouldStreamText_(),"Should be streaming text")),this.onTextTrackVisibility_()):this.isTextVisible_=!1},shaka.Player.prototype.onManifestUpdate_=function(){this.parser_&&this.parser_.update&&this.parser_.update()},shaka.Player.prototype.onSegmentAppended_=function(e,t,r,n){if(r!=shaka.util.ManifestParserUtils.ContentType.TEXT){if(this.playhead_){this.playhead_.notifyOfBufferingChange();var a=this.mediaSourceEngine_.bufferStart(r);!this.isLive()&&this.video_.paused&&!this.video_.seeking&&null!=a&&0<a&&this.playhead_.getTime()<a&&this.playhead_.setStartTime(a)}this.pollBufferState_()}e=(new Map).set("start",e).set("end",t).set("contentType",r).set("isMuxed",n),this.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.SegmentAppended,e))},shaka.Player.prototype.switch_=function(e,t,r){t=void 0!==t&&t,r=void 0===r?0:r,shaka.log.debug("switch_"),goog.asserts.assert(this.config_.abr.enabled,"AbrManager should not call switch while disabled!"),this.manifest_&&this.streamingEngine_&&e!=this.streamingEngine_.getCurrentVariant()&&this.switchVariant_(e,!0,t,r)},shaka.Player.prototype.onAdaptation_=function(e,t){e=(new Map).set("oldTrack",e).set("newTrack",t),e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Adaptation,e),this.delayDispatchEvent_(e)},shaka.Player.prototype.onTracksChanged_=function(){var e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.TracksChanged);this.delayDispatchEvent_(e),this.onAudioTracksChanged_()},shaka.Player.prototype.onVariantChanged_=function(e,t){e=(new Map).set("oldTrack",e).set("newTrack",t),e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.VariantChanged,e),this.delayDispatchEvent_(e)},shaka.Player.prototype.checkAudioTracksChanged_=function(e,t){var r=!1;e&&e.audioId==t.audioId&&e.audioGroupId==t.audioGroupId||(r=!0),r&&this.onAudioTracksChanged_()},shaka.Player.prototype.onAudioTracksChanged_=function(){var e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.AudioTracksChanged);this.delayDispatchEvent_(e)},shaka.Player.prototype.onTextChanged_=function(){var e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.TextChanged);this.delayDispatchEvent_(e)},shaka.Player.prototype.onTextTrackVisibility_=function(){var e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.TextTrackVisibility);this.delayDispatchEvent_(e)},shaka.Player.prototype.onAbrStatusChanged_=function(){this.config_.abr.enabled||this.restoreDisabledVariants_();var e=(new Map).set("newStatus",this.config_.abr.enabled);this.delayDispatchEvent_(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.AbrStatusChanged,e))},shaka.Player.prototype.setTextDisplayerLanguage_=function(){var e=this.getTextTracks().find((function(e){return e.active}));e&&this.textDisplayer_&&this.textDisplayer_.setTextLanguage&&this.textDisplayer_.setTextLanguage(e.language)},shaka.Player.prototype.restoreDisabledVariants_=function(e){if(e=void 0===e||e,this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE){goog.asserts.assert(this.manifest_,"Should have manifest!"),shaka.log.v2("Restoring all disabled streams..."),this.checkVariantsTimer_.stop();for(var t=$jscomp.makeIterator(this.manifest_.variants),r=t.next();!r.done;r=t.next())r.value.disabledUntilTime=0;e&&this.updateAbrManagerVariants_()}},shaka.Player.prototype.disableStream=function(e,t){if(!this.config_.abr.enabled||this.loadMode_===shaka.Player.LoadMode.DESTROYED||!navigator.onLine||0==t||!this.manifest_)return!1;if(this.manifest_.variants.some((function(t){var r=t[e.type];return!(!r||r.id===e.id||t.disabledUntilTime)&&(!shaka.util.StreamUtils.isAudio(e)||e.language===r.language)}))){for(var r=!1,n=!1,a=$jscomp.makeIterator(this.manifest_.variants),i=a.next();!i.done;i=a.next()){var s=(i=i.value)[e.type];s&&(s.id===e.id?(i.disabledUntilTime=Date.now()/1e3+t,r=!0,shaka.log.v2("Disabled stream "+e.type+":"+e.id+" for "+t+" seconds...")):s.trickModeVideo&&s.trickModeVideo.id==e.id&&(n=!0))}return!(!r&&n)&&(goog.asserts.assert(r,"Must have disabled stream"),this.checkVariantsTimer_.tickEvery(1),t=this.getBufferedInfo().video.reduce((function(e,t){return e+t.end-t.start}),0),this.chooseVariantAndSwitch_(!1,t,!0,!1),!0)}return shaka.log.warning("No alternate stream found for active "+e.type+" stream. Will ignore request to disable stream..."),!1},shaka.Player.prototype.onError_=function(e){var t,r,n,a,i,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:if(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),s.loadMode_==shaka.Player.LoadMode.DESTROYED)return o.return();if(e.severity===shaka.util.Error.Severity.RECOVERABLE&&s.stats_.addNonFatalError(),t=!0,!(s.fullyLoaded_&&s.manifest_&&s.streamingEngine_)||e.code!=shaka.util.Error.Code.VIDEO_ERROR&&e.code!=shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_FAILED&&e.code!=shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW&&e.code!=shaka.util.Error.Code.TRANSMUXING_FAILED){o.jumpTo(2);break}return shaka.util.Platform.isApple()&&e.code==shaka.util.Error.Code.VIDEO_ERROR?o.return():(o.setCatchFinallyBlocks(3),o.yield(s.streamingEngine_.resetMediaSource(),5));case 5:r=o.yieldResult,t=!r,r&&(n=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.MediaSourceRecovered),s.dispatchEvent(n)),o.leaveTryBlock(2);break;case 3:o.enterCatchBlock(),t=!0;case 2:if(!t)return o.return();e.severity===shaka.util.Error.Severity.CRITICAL&&s.restoreDisabledVariants_(!1),a=shaka.util.FakeEvent.EventName.Error,i=shaka.Player.makeEvent_(a,(new Map).set("detail",e)),s.dispatchEvent(i),i.defaultPrevented&&(e.handled=!0),o.jumpToEnd()}}))},shaka.Player.prototype.addFont=function(e,t){var r,n,a,i,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){if(1==o.nextAddress)return"fonts"in document&&"FontFace"in window?o.yield(document.fonts.ready,3):o.jumpTo(0);if(!("entries"in document.fonts))return o.return();for(r=function(e){for(var t=[],r=(e=e.entries()).next();!1===r.done;)t.push(r.value),r=e.next();return t},n=$jscomp.makeIterator(r(document.fonts)),a=n.next();!a.done;a=n.next())if((i=a.value).family==e&&"swap"==i.display)return o.return();s=new FontFace(e,"url("+t+")",{display:"swap"}),document.fonts.add(s),o.jumpToEnd()}))},shaka.Player.prototype.onRegionEvent_=function(e,t,r){r=void 0===r?this:r,t={schemeIdUri:t.schemeIdUri,value:t.value,startTime:t.startTime,endTime:t.endTime,id:t.id,timescale:t.timescale,eventElement:t.eventElement,eventNode:t.eventNode},t=(new Map).set("detail",t),r.dispatchEvent(shaka.Player.makeEvent_(e,t))},shaka.Player.prototype.onMediaQualityChange_=function(e,t,r){r=void 0!==r&&r,e={bandwidth:e.bandwidth,audioSamplingRate:e.audioSamplingRate,codecs:e.codecs,contentType:e.contentType,frameRate:e.frameRate,height:e.height,mimeType:e.mimeType,channelsCount:e.channelsCount,pixelAspectRatio:e.pixelAspectRatio,width:e.width,label:e.label,roles:e.roles,language:e.language},t=(new Map).set("mediaQuality",e).set("position",t),this.dispatchEvent(shaka.Player.makeEvent_(r?shaka.util.FakeEvent.EventName.AudioTrackChanged:shaka.util.FakeEvent.EventName.MediaQualityChanged,t))},shaka.Player.prototype.videoErrorToShakaError_=function(e){if(e=void 0===e||e,goog.asserts.assert(this.video_.error,"Video error expected, but missing!"),!this.video_.error)return e?new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.VIDEO_ERROR):null;var t=this.video_.error.code;return e||1!=t?((e=this.video_.error.msExtendedCode)&&(0>e&&(e+=Math.pow(2,32)),e=e.toString(16)),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.VIDEO_ERROR,t,e,this.video_.error.message)):null},shaka.Player.prototype.onVideoError_=function(e){(e=this.videoErrorToShakaError_(!1))&&this.onError_(e)},shaka.Player.prototype.onKeyStatus_=function(e){goog.asserts.assert(this.streamingEngine_,"Cannot be called in src= mode");var t=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.KeyStatusChanged);this.dispatchEvent(t);var r=Object.keys(e);0==r.length&&shaka.log.warning("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),1==r.length&&""==r[0]&&(r=["00"],e={"00":e[""]}),(t=1==r.length&&"00"==r[0])&&shaka.log.warning("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var n=shaka.media.ManifestFilterer.restrictedStatuses,a=!1;if(goog.asserts.assert(this.drmEngine_,"drmEngine should be non-null here."),r.length){r=this.keySystem();for(var i=shaka.util.MapUtils.asMap(this.config_.drm.clearKeys),s=$jscomp.makeIterator(this.manifest_.variants),o=s.next();!o.done;o=s.next()){o=o.value;for(var l=shaka.util.StreamUtils.getVariantStreams(o),u=(l=$jscomp.makeIterator(l)).next();!u.done;u=l.next()){var c=u.value;if(u=o.allowedByKeySystem,c.keyIds.size)if(c.drmInfos.length&&!i.size){for(var d=(c=$jscomp.makeIterator(c.drmInfos)).next();!d.done;d=c.next())if((d=d.value).keyIds.size&&d.keySystem==r){o.allowedByKeySystem=!0;for(var p=(d=$jscomp.makeIterator(d.keyIds)).next();!p.done;p=d.next())p=p.value,((p=e[t?"00":p])||this.drmEngine_.hasManifestInitData())&&(o.allowedByKeySystem=o.allowedByKeySystem&&!!p&&!n.includes(p))}}else for(o.allowedByKeySystem=!0,d=(c=$jscomp.makeIterator(c.keyIds)).next();!d.done;d=c.next())d=d.value,((d=e[t?"00":d])||this.drmEngine_.hasManifestInitData())&&(o.allowedByKeySystem=o.allowedByKeySystem&&!!d&&!n.includes(d));u!=o.allowedByKeySystem&&(a=!0)}}}a&&(this.onTracksChanged_(),!this.updateAbrManagerVariants_())||(e=this.streamingEngine_.getCurrentVariant())&&!e.allowedByKeySystem&&(shaka.log.debug("Choosing new streams after key status changed"),this.chooseVariantAndSwitch_())},shaka.Player.prototype.shouldStreamText_=function(){return this.config_.streaming.alwaysStreamText||this.isTextTrackVisible()},shaka.Player.applyPlayRange_=function(e,t,r){0<t&&(e.isLive()?shaka.log.warning("|playRangeStart| has been configured for live content. Ignoring the setting."):e.setUserSeekStart(t)),r<(t=e.getDuration())&&(e.isLive()?shaka.log.warning("|playRangeEnd| has been configured for live content. Ignoring the setting."):e.setDuration(r))},shaka.Player.prototype.delayDispatchEvent_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(Promise.resolve(),2);t.loadMode_!=shaka.Player.LoadMode.DESTROYED&&t.dispatchEvent(e),r.jumpToEnd()}))},shaka.Player.getLanguagesFrom_=function(e){for(var t=new Set,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value).language?t.add(shaka.util.LanguageUtils.normalize(r.language)):t.add("und");return t},shaka.Player.getLanguageAndRolesFrom_=function(e){for(var t=new Map,r=new Map,n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){var a="und",i=[];(n=n.value).language&&(a=shaka.util.LanguageUtils.normalize(n.language)),(i="variant"==n.type?n.audioRoles:n.roles)&&i.length||(i=[""]),t.has(a)||t.set(a,new Set);for(var s=(i=$jscomp.makeIterator(i)).next();!s.done;s=i.next())s=s.value,t.get(a).add(s),n.label&&(r.has(a)||r.set(a,new Map),r.get(a).set(s,n.label))}var o=[];return t.forEach((function(e,t){for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;var a=null;r.has(t)&&r.get(t).has(n)&&(a=r.get(t).get(n)),o.push({language:t,role:n,label:a})}})),o},shaka.Player.prototype.isBufferedToEndMS_=function(){if(goog.asserts.assert(this.video_,"We need a video element to get buffering information"),goog.asserts.assert(this.mediaSourceEngine_,"We need a media source engine to get buffering information"),goog.asserts.assert(this.manifest_,"We need a manifest to get buffering information"),this.isEnded()||this.mediaSourceEngine_.ended())return!0;if(this.manifest_.presentationTimeline.isLive()){var e=this.manifest_.presentationTimeline.getSegmentAvailabilityEnd(),t=shaka.media.TimeRangesUtils.bufferEnd(this.video_.buffered);if(null!=t&&t>=e)return!0}return!1},shaka.Player.prototype.isBufferedToEndSrc_=function(){if(goog.asserts.assert(this.video_,"We need a video element to get buffering information"),this.isEnded())return!0;var e=shaka.media.TimeRangesUtils.bufferEnd(this.video_.buffered);return null!=e&&e>=this.video_.duration-1},shaka.Player.prototype.createAbortLoadError_=function(){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.LOAD_INTERRUPTED)},shaka.Player.prototype.isRemotePlayback=function(){return!(!this.video_||!this.video_.remote)&&"disconnected"!=this.video_.remote.state},shaka.Player.prototype.isEnded=function(){return!(this.video_&&!this.video_.ended)||this.fullyLoaded_&&!this.isLive()&&this.video_.currentTime>=this.seekRange().end},goog.exportSymbol("shaka.Player",shaka.Player),goog.exportProperty(shaka.Player.prototype,"isEnded",shaka.Player.prototype.isEnded),goog.exportProperty(shaka.Player.prototype,"isRemotePlayback",shaka.Player.prototype.isRemotePlayback),goog.exportProperty(shaka.Player.prototype,"addFont",shaka.Player.prototype.addFont),goog.exportProperty(shaka.Player.prototype,"setVideoContainer",shaka.Player.prototype.setVideoContainer),goog.exportProperty(shaka.Player.prototype,"getFetchedPlaybackInfo",shaka.Player.prototype.getFetchedPlaybackInfo),goog.exportProperty(shaka.Player.prototype,"getManifestParserFactory",shaka.Player.prototype.getManifestParserFactory),goog.exportProperty(shaka.Player.prototype,"getManifest",shaka.Player.prototype.getManifest),goog.exportProperty(shaka.Player.prototype,"retryStreaming",shaka.Player.prototype.retryStreaming),goog.exportProperty(shaka.Player.prototype,"setMaxHardwareResolution",shaka.Player.prototype.setMaxHardwareResolution),goog.exportProperty(shaka.Player.prototype,"addChaptersTrack",shaka.Player.prototype.addChaptersTrack),goog.exportProperty(shaka.Player.prototype,"addThumbnailsTrack",shaka.Player.prototype.addThumbnailsTrack),goog.exportProperty(shaka.Player.prototype,"addTextTrackAsync",shaka.Player.prototype.addTextTrackAsync),goog.exportProperty(shaka.Player.prototype,"getStats",shaka.Player.prototype.getStats),goog.exportProperty(shaka.Player.prototype,"getBufferedInfo",shaka.Player.prototype.getBufferedInfo),goog.exportProperty(shaka.Player.prototype,"getSegmentAvailabilityDuration",shaka.Player.prototype.getSegmentAvailabilityDuration),goog.exportProperty(shaka.Player.prototype,"getPresentationStartTimeAsDate",shaka.Player.prototype.getPresentationStartTimeAsDate),goog.exportProperty(shaka.Player.prototype,"getPlayheadTimeAsDate",shaka.Player.prototype.getPlayheadTimeAsDate),goog.exportProperty(shaka.Player.prototype,"setTextTrackVisibility",shaka.Player.prototype.setTextTrackVisibility),goog.exportProperty(shaka.Player.prototype,"getChapters",shaka.Player.prototype.getChapters),goog.exportProperty(shaka.Player.prototype,"getChaptersTracks",shaka.Player.prototype.getChaptersTracks),goog.exportProperty(shaka.Player.prototype,"isTextTrackVisible",shaka.Player.prototype.isTextTrackVisible),goog.exportProperty(shaka.Player.prototype,"selectVariantsByLabel",shaka.Player.prototype.selectVariantsByLabel),goog.exportProperty(shaka.Player.prototype,"selectTextLanguage",shaka.Player.prototype.selectTextLanguage),goog.exportProperty(shaka.Player.prototype,"selectAudioLanguage",shaka.Player.prototype.selectAudioLanguage),goog.exportProperty(shaka.Player.prototype,"getTextLanguages",shaka.Player.prototype.getTextLanguages),goog.exportProperty(shaka.Player.prototype,"getAudioLanguages",shaka.Player.prototype.getAudioLanguages),goog.exportProperty(shaka.Player.prototype,"getTextLanguagesAndRoles",shaka.Player.prototype.getTextLanguagesAndRoles),goog.exportProperty(shaka.Player.prototype,"getAudioLanguagesAndRoles",shaka.Player.prototype.getAudioLanguagesAndRoles),goog.exportProperty(shaka.Player.prototype,"getAudioTracks",shaka.Player.prototype.getAudioTracks),goog.exportProperty(shaka.Player.prototype,"selectAudioTrack",shaka.Player.prototype.selectAudioTrack),goog.exportProperty(shaka.Player.prototype,"selectVariantTrack",shaka.Player.prototype.selectVariantTrack),goog.exportProperty(shaka.Player.prototype,"selectTextTrack",shaka.Player.prototype.selectTextTrack),goog.exportProperty(shaka.Player.prototype,"getThumbnails",shaka.Player.prototype.getThumbnails),goog.exportProperty(shaka.Player.prototype,"getAllThumbnails",shaka.Player.prototype.getAllThumbnails),goog.exportProperty(shaka.Player.prototype,"getImageTracks",shaka.Player.prototype.getImageTracks),goog.exportProperty(shaka.Player.prototype,"getTextTracks",shaka.Player.prototype.getTextTracks),goog.exportProperty(shaka.Player.prototype,"getVariantTracks",shaka.Player.prototype.getVariantTracks),goog.exportProperty(shaka.Player.prototype,"cancelTrickPlay",shaka.Player.prototype.cancelTrickPlay),goog.exportProperty(shaka.Player.prototype,"trickPlay",shaka.Player.prototype.trickPlay),goog.exportProperty(shaka.Player.prototype,"getPlaybackRate",shaka.Player.prototype.getPlaybackRate),goog.exportProperty(shaka.Player.prototype,"isBuffering",shaka.Player.prototype.isBuffering),goog.exportProperty(shaka.Player.prototype,"getKeyStatuses",shaka.Player.prototype.getKeyStatuses),goog.exportProperty(shaka.Player.prototype,"getActiveSessionsMetadata",shaka.Player.prototype.getActiveSessionsMetadata),goog.exportProperty(shaka.Player.prototype,"getExpiration",shaka.Player.prototype.getExpiration),goog.exportProperty(shaka.Player.prototype,"drmInfo",shaka.Player.prototype.drmInfo),goog.exportProperty(shaka.Player.prototype,"keySystem",shaka.Player.prototype.keySystem),goog.exportProperty(shaka.Player.prototype,"isFullyLoaded",shaka.Player.prototype.isFullyLoaded),goog.exportProperty(shaka.Player.prototype,"goToLive",shaka.Player.prototype.goToLive),goog.exportProperty(shaka.Player.prototype,"seekRange",shaka.Player.prototype.seekRange),goog.exportProperty(shaka.Player.prototype,"isAudioOnly",shaka.Player.prototype.isAudioOnly),goog.exportProperty(shaka.Player.prototype,"isInProgress",shaka.Player.prototype.isInProgress),goog.exportProperty(shaka.Player.prototype,"isLive",shaka.Player.prototype.isLive),goog.exportProperty(shaka.Player.prototype,"getAdManager",shaka.Player.prototype.getAdManager),goog.exportProperty(shaka.Player.prototype,"getAssetUri",shaka.Player.prototype.getAssetUri),goog.exportProperty(shaka.Player.prototype,"getNetworkingEngine",shaka.Player.prototype.getNetworkingEngine),goog.exportProperty(shaka.Player.prototype,"getMediaElement",shaka.Player.prototype.getMediaElement),goog.exportProperty(shaka.Player.prototype,"getManifestType",shaka.Player.prototype.getManifestType),goog.exportProperty(shaka.Player.prototype,"getLoadMode",shaka.Player.prototype.getLoadMode),goog.exportProperty(shaka.Player.prototype,"resetConfiguration",shaka.Player.prototype.resetConfiguration),goog.exportProperty(shaka.Player.prototype,"getBufferFullness",shaka.Player.prototype.getBufferFullness),goog.exportProperty(shaka.Player.prototype,"getNonDefaultConfiguration",shaka.Player.prototype.getNonDefaultConfiguration),goog.exportProperty(shaka.Player.prototype,"getConfigurationForLowLatency",shaka.Player.prototype.getConfigurationForLowLatency),goog.exportProperty(shaka.Player.prototype,"getConfiguration",shaka.Player.prototype.getConfiguration),goog.exportProperty(shaka.Player.prototype,"configurationForLowLatency",shaka.Player.prototype.configurationForLowLatency),goog.exportProperty(shaka.Player.prototype,"configure",shaka.Player.prototype.configure),goog.exportProperty(shaka.Player.prototype,"releaseAllMutexes",shaka.Player.prototype.releaseAllMutexes),goog.exportProperty(shaka.Player.prototype,"destroyAllPreloads",shaka.Player.prototype.destroyAllPreloads),goog.exportProperty(shaka.Player.prototype,"preload",shaka.Player.prototype.preload),goog.exportProperty(shaka.Player.prototype,"detachAndSavePreload",shaka.Player.prototype.detachAndSavePreload),goog.exportProperty(shaka.Player.prototype,"unloadAndSavePreload",shaka.Player.prototype.unloadAndSavePreload),goog.exportProperty(shaka.Player.prototype,"load",shaka.Player.prototype.load),goog.exportProperty(shaka.Player.prototype,"updateStartTime",shaka.Player.prototype.updateStartTime),goog.exportProperty(shaka.Player.prototype,"unload",shaka.Player.prototype.unload),goog.exportProperty(shaka.Player.prototype,"detach",shaka.Player.prototype.detach),goog.exportProperty(shaka.Player.prototype,"attachCanvas",shaka.Player.prototype.attachCanvas),goog.exportProperty(shaka.Player.prototype,"attach",shaka.Player.prototype.attach),goog.exportProperty(shaka.Player,"probeSupport",shaka.Player.probeSupport),goog.exportProperty(shaka.Player,"isBrowserSupported",shaka.Player.isBrowserSupported),goog.exportProperty(shaka.Player,"setAdManagerFactory",shaka.Player.setAdManagerFactory),goog.exportProperty(shaka.Player,"registerSupportPlugin",shaka.Player.registerSupportPlugin),goog.exportProperty(shaka.Player.prototype,"destroy",shaka.Player.prototype.destroy),shaka.Player.LoadMode={DESTROYED:0,NOT_LOADED:1,MEDIA_SOURCE:2,SRC_EQUALS:3},goog.exportProperty(shaka.Player,"LoadMode",shaka.Player.LoadMode),shaka.Player.TYPICAL_BUFFERING_THRESHOLD_=.5,shaka.Player.version="v4.14.9-debug",goog.exportProperty(shaka.Player,"version",shaka.Player.version),shaka.Deprecate.init(shaka.Player.version),shaka.Player.supportPlugins_=new Map,shaka.Player.adManagerFactory_=null,shaka.Player.TextTrackLabel="Shaka Player TextTrack",shaka.ads={},shaka.ads.AdsStats=function(){this.loadTimes_=[],this.errors_=this.skipped_=this.playedCompletely_=this.overlayAds_=this.started_=0},shaka.ads.AdsStats.prototype.addLoadTime=function(e){this.loadTimes_.push(e)},shaka.ads.AdsStats.prototype.incrementStarted=function(){this.started_++},shaka.ads.AdsStats.prototype.incrementOverlayAds=function(){this.overlayAds_++},shaka.ads.AdsStats.prototype.incrementPlayedCompletely=function(){this.playedCompletely_++},shaka.ads.AdsStats.prototype.incrementSkipped=function(){this.skipped_++},shaka.ads.AdsStats.prototype.incrementErrors=function(){this.errors_++},shaka.ads.AdsStats.prototype.getAverageLoadTime_=function(){return this.loadTimes_.length?this.loadTimes_.reduce((function(e,t){return e+t}),0)/this.loadTimes_.length:0},shaka.ads.AdsStats.prototype.getBlob=function(){return{loadTimes:this.loadTimes_,averageLoadTime:this.getAverageLoadTime_(),started:this.started_,overlayAds:this.overlayAds_,playedCompletely:this.playedCompletely_,skipped:this.skipped_,errors:this.errors_}},shaka.ads.ClientSideAd=function(e,t,r){var n=this;this.ad_=e,this.manager_=t,this.video_=r,this.isPaused_=!1,this.volume_=this.manager_.getVolume(),this.eventManager_=new shaka.util.EventManager,this.eventManager_.listen(this.manager_,google.ima.AdEvent.Type.PAUSED,(function(){n.isPaused_=!0})),this.eventManager_.listen(this.manager_,google.ima.AdEvent.Type.RESUMED,(function(){n.isPaused_=!1}))},shaka.ads.ClientSideAd.prototype.needsSkipUI=function(){return!1},shaka.ads.ClientSideAd.prototype.isClientRendering=function(){return!0},shaka.ads.ClientSideAd.prototype.hasCustomClick=function(){return!0},shaka.ads.ClientSideAd.prototype.isUsingAnotherMediaElement=function(){return!0},shaka.ads.ClientSideAd.prototype.getDuration=function(){return this.ad_.getDuration()},shaka.ads.ClientSideAd.prototype.getMinSuggestedDuration=function(){return this.ad_.getMinSuggestedDuration()},shaka.ads.ClientSideAd.prototype.getRemainingTime=function(){return this.manager_.getRemainingTime()},shaka.ads.ClientSideAd.prototype.isPaused=function(){return this.isPaused_},shaka.ads.ClientSideAd.prototype.isSkippable=function(){return 0<=this.ad_.getSkipTimeOffset()},shaka.ads.ClientSideAd.prototype.getTimeUntilSkippable=function(){var e=this.ad_.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},shaka.ads.ClientSideAd.prototype.canSkipNow=function(){return this.manager_.getAdSkippableState()},shaka.ads.ClientSideAd.prototype.skip=function(){return this.manager_.skip()},shaka.ads.ClientSideAd.prototype.setPaused=function(e){this.isPaused_=e},shaka.ads.ClientSideAd.prototype.pause=function(){return this.manager_.pause()},shaka.ads.ClientSideAd.prototype.play=function(){return this.manager_.resume()},shaka.ads.ClientSideAd.prototype.getVolume=function(){return this.manager_.getVolume()},shaka.ads.ClientSideAd.prototype.setVolume=function(e){return this.video_.volume=e,this.manager_.setVolume(e)},shaka.ads.ClientSideAd.prototype.isMuted=function(){return 0==this.manager_.getVolume()},shaka.ads.ClientSideAd.prototype.isLinear=function(){return this.ad_.isLinear()},shaka.ads.ClientSideAd.prototype.resize=function(e,t){var r=!1,n=this.video_;document.fullscreenEnabled?r=!!document.fullscreenElement:n.webkitSupportsFullscreen&&(r=n.webkitDisplayingFullscreen),this.manager_.resize(e,t,r?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},shaka.ads.ClientSideAd.prototype.setMuted=function(e){(this.video_.muted=e)?(this.volume_=this.getVolume(),this.manager_.setVolume(0)):this.manager_.setVolume(this.volume_)},shaka.ads.ClientSideAd.prototype.setInitialMuted=function(e){this.volume_=e,this.manager_.setVolume(0)},shaka.ads.ClientSideAd.prototype.getSequenceLength=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getTotalAds()},shaka.ads.ClientSideAd.prototype.getPositionInSequence=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getAdPosition()},shaka.ads.ClientSideAd.prototype.getTitle=function(){return this.ad_.getTitle()},shaka.ads.ClientSideAd.prototype.getDescription=function(){return this.ad_.getDescription()},shaka.ads.ClientSideAd.prototype.getVastMediaBitrate=function(){return this.ad_.getVastMediaBitrate()},shaka.ads.ClientSideAd.prototype.getVastMediaHeight=function(){return this.ad_.getVastMediaHeight()},shaka.ads.ClientSideAd.prototype.getVastMediaWidth=function(){return this.ad_.getVastMediaWidth()},shaka.ads.ClientSideAd.prototype.getAdId=function(){return this.ad_.getAdId()},shaka.ads.ClientSideAd.prototype.getCreativeAdId=function(){return this.ad_.getCreativeAdId()},shaka.ads.ClientSideAd.prototype.getAdvertiserName=function(){return this.ad_.getAdvertiserName()},shaka.ads.ClientSideAd.prototype.getMediaUrl=function(){return this.ad_.getMediaUrl()},shaka.ads.ClientSideAd.prototype.getTimeOffset=function(){var e=this.ad_.getAdPodInfo();return null==e?0:e.getTimeOffset()},shaka.ads.ClientSideAd.prototype.getPodIndex=function(){var e=this.ad_.getAdPodInfo();return null==e?0:e.getPodIndex()},shaka.ads.ClientSideAd.prototype.release=function(){this.manager_=this.ad_=null},goog.exportSymbol("shaka.ads.ClientSideAd",shaka.ads.ClientSideAd),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"release",shaka.ads.ClientSideAd.prototype.release),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getPodIndex",shaka.ads.ClientSideAd.prototype.getPodIndex),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getTimeOffset",shaka.ads.ClientSideAd.prototype.getTimeOffset),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getMediaUrl",shaka.ads.ClientSideAd.prototype.getMediaUrl),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getAdvertiserName",shaka.ads.ClientSideAd.prototype.getAdvertiserName),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getCreativeAdId",shaka.ads.ClientSideAd.prototype.getCreativeAdId),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getAdId",shaka.ads.ClientSideAd.prototype.getAdId),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getVastMediaWidth",shaka.ads.ClientSideAd.prototype.getVastMediaWidth),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getVastMediaHeight",shaka.ads.ClientSideAd.prototype.getVastMediaHeight),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getVastMediaBitrate",shaka.ads.ClientSideAd.prototype.getVastMediaBitrate),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getDescription",shaka.ads.ClientSideAd.prototype.getDescription),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getTitle",shaka.ads.ClientSideAd.prototype.getTitle),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getPositionInSequence",shaka.ads.ClientSideAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getSequenceLength",shaka.ads.ClientSideAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"setMuted",shaka.ads.ClientSideAd.prototype.setMuted),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"resize",shaka.ads.ClientSideAd.prototype.resize),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isLinear",shaka.ads.ClientSideAd.prototype.isLinear),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isMuted",shaka.ads.ClientSideAd.prototype.isMuted),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"setVolume",shaka.ads.ClientSideAd.prototype.setVolume),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getVolume",shaka.ads.ClientSideAd.prototype.getVolume),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"play",shaka.ads.ClientSideAd.prototype.play),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"pause",shaka.ads.ClientSideAd.prototype.pause),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"skip",shaka.ads.ClientSideAd.prototype.skip),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"canSkipNow",shaka.ads.ClientSideAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getTimeUntilSkippable",shaka.ads.ClientSideAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isSkippable",shaka.ads.ClientSideAd.prototype.isSkippable),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isPaused",shaka.ads.ClientSideAd.prototype.isPaused),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getRemainingTime",shaka.ads.ClientSideAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getMinSuggestedDuration",shaka.ads.ClientSideAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getDuration",shaka.ads.ClientSideAd.prototype.getDuration),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isUsingAnotherMediaElement",shaka.ads.ClientSideAd.prototype.isUsingAnotherMediaElement),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"hasCustomClick",shaka.ads.ClientSideAd.prototype.hasCustomClick),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isClientRendering",shaka.ads.ClientSideAd.prototype.isClientRendering),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"needsSkipUI",shaka.ads.ClientSideAd.prototype.needsSkipUI),shaka.ads.Utils=function(){},shaka.ads.Utils.parseVastToInterstitials=function(e,t){for(var r=shaka.util.TXml,n=[],a=(e=$jscomp.makeIterator(r.findChildren(e,"Ad"))).next();!a.done;a=e.next())if((a=r.findChild(a.value,"InLine"))&&(a=r.findChild(a,"Creatives")))for(var i=(a=$jscomp.makeIterator(r.findChildren(a,"Creative"))).next();!i.done;i=a.next()){i=i.value;var s=r.findChild(i,"Linear");if(s&&shaka.ads.Utils.processLinearAd_(n,t,s),i=r.findChild(i,"NonLinearAds"))for(i=r.findChildren(i,"NonLinear"),s=(i=$jscomp.makeIterator(i)).next();!s.done;s=i.next())shaka.ads.Utils.processNonLinearAd_(n,t,s.value)}return n},shaka.ads.Utils.processLinearAd_=function(e,t,r){var n=shaka.util.TXml,a=0;null!=t&&(a=t);var i=null;if(r.attributes.skipoffset&&(i=shaka.util.TextParser.parseTime(r.attributes.skipoffset),isNaN(i)&&(i=null)),r=n.findChild(r,"MediaFiles")){var s=n.findChildren(r,"MediaFile");for(r=s,s=s.filter((function(e){return"streaming"==e.attributes.delivery})),s.length&&(r=s),r=r.sort((function(e,t){return e=parseInt(e.attributes.height,10)||0,(parseInt(t.attributes.height,10)||0)-e})),s=(r=$jscomp.makeIterator(r)).next();!s.done;s=r.next())if(!(s=s.value).attributes.apiFramework){var o=n.getContents(s);if(o){e.push({id:null,groupId:null,startTime:a,endTime:null,uri:o,mimeType:s.attributes.type||null,isSkippable:null!=i,skipOffset:i,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:null,once:!0,pre:null==t,post:1/0==t,timelineRange:!1,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null});break}}}},shaka.ads.Utils.processNonLinearAd_=function(e,t,r){var n=shaka.util.TXml,a=n.findChild(r,"StaticResource");if(a)var i=a.attributes.creativeType;else{if(!(a=n.findChild(r,"HTMLResource")))return;i="text/html"}if(a=n.getContents(a)){"text/html"===i&&(a="data:text/html;charset=UTF-8,"+encodeURIComponent(a));var s=n.parseAttr(r,"width",n.parseInt)||n.parseAttr(r,"expandedWidth",n.parseInt);if(n=n.parseAttr(r,"height",n.parseInt)||n.parseAttr(r,"expandedHeight",n.parseInt),s||n){var o=null;(r=r.attributes.minSuggestedDuration)&&(o=shaka.util.TextParser.parseTime(r)),r=0,null!=t&&(r=t),e.push({id:null,groupId:null,startTime:r,endTime:null,uri:a,mimeType:i,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!1,resumeOffset:0,playoutLimit:o,once:!0,pre:null==t,post:1/0==t,timelineRange:!1,loop:!1,overlay:{viewport:{x:0,y:0},topLeft:{x:0,y:0},size:{x:s||0,y:n||0}},displayOnBackground:!1,currentVideo:null,background:null})}}},shaka.ads.Utils.parseVMAP=function(e){for(var t=shaka.util.TXml,r=[],n=(e=$jscomp.makeIterator(t.findChildren(e,"vmap:AdBreak"))).next();!n.done;n=e.next()){var a=n.value;(n=a.attributes.timeOffset)&&(n="start"==n?0:"end"==n?1/0:shaka.util.TextParser.parseTime(n),(a=t.findChild(a,"vmap:AdSource"))&&(a=t.findChild(a,"vmap:AdTagURI"))&&(a=t.getTextContents(a))&&r.push({time:n,uri:a}))}return r},goog.exportSymbol("shaka.ads.Utils",shaka.ads.Utils),shaka.ads.Utils.ADS_LOADED="ads-loaded",goog.exportProperty(shaka.ads.Utils,"ADS_LOADED",shaka.ads.Utils.ADS_LOADED),shaka.ads.Utils.AD_STARTED="ad-started",goog.exportProperty(shaka.ads.Utils,"AD_STARTED",shaka.ads.Utils.AD_STARTED),shaka.ads.Utils.AD_FIRST_QUARTILE="ad-first-quartile",goog.exportProperty(shaka.ads.Utils,"AD_FIRST_QUARTILE",shaka.ads.Utils.AD_FIRST_QUARTILE),shaka.ads.Utils.AD_MIDPOINT="ad-midpoint",goog.exportProperty(shaka.ads.Utils,"AD_MIDPOINT",shaka.ads.Utils.AD_MIDPOINT),shaka.ads.Utils.AD_THIRD_QUARTILE="ad-third-quartile",goog.exportProperty(shaka.ads.Utils,"AD_THIRD_QUARTILE",shaka.ads.Utils.AD_THIRD_QUARTILE),shaka.ads.Utils.AD_COMPLETE="ad-complete",goog.exportProperty(shaka.ads.Utils,"AD_COMPLETE",shaka.ads.Utils.AD_COMPLETE),shaka.ads.Utils.AD_STOPPED="ad-stopped",goog.exportProperty(shaka.ads.Utils,"AD_STOPPED",shaka.ads.Utils.AD_STOPPED),shaka.ads.Utils.AD_SKIPPED="ad-skipped",goog.exportProperty(shaka.ads.Utils,"AD_SKIPPED",shaka.ads.Utils.AD_SKIPPED),shaka.ads.Utils.AD_VOLUME_CHANGED="ad-volume-changed",goog.exportProperty(shaka.ads.Utils,"AD_VOLUME_CHANGED",shaka.ads.Utils.AD_VOLUME_CHANGED),shaka.ads.Utils.AD_MUTED="ad-muted",goog.exportProperty(shaka.ads.Utils,"AD_MUTED",shaka.ads.Utils.AD_MUTED),shaka.ads.Utils.AD_PAUSED="ad-paused",goog.exportProperty(shaka.ads.Utils,"AD_PAUSED",shaka.ads.Utils.AD_PAUSED),shaka.ads.Utils.AD_RESUMED="ad-resumed",goog.exportProperty(shaka.ads.Utils,"AD_RESUMED",shaka.ads.Utils.AD_RESUMED),shaka.ads.Utils.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",goog.exportProperty(shaka.ads.Utils,"AD_SKIP_STATE_CHANGED",shaka.ads.Utils.AD_SKIP_STATE_CHANGED),shaka.ads.Utils.CUEPOINTS_CHANGED="ad-cue-points-changed",goog.exportProperty(shaka.ads.Utils,"CUEPOINTS_CHANGED",shaka.ads.Utils.CUEPOINTS_CHANGED),shaka.ads.Utils.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",goog.exportProperty(shaka.ads.Utils,"IMA_AD_MANAGER_LOADED",shaka.ads.Utils.IMA_AD_MANAGER_LOADED),shaka.ads.Utils.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",goog.exportProperty(shaka.ads.Utils,"IMA_STREAM_MANAGER_LOADED",shaka.ads.Utils.IMA_STREAM_MANAGER_LOADED),shaka.ads.Utils.AD_CLICKED="ad-clicked",goog.exportProperty(shaka.ads.Utils,"AD_CLICKED",shaka.ads.Utils.AD_CLICKED),shaka.ads.Utils.AD_PROGRESS="ad-progress",goog.exportProperty(shaka.ads.Utils,"AD_PROGRESS",shaka.ads.Utils.AD_PROGRESS),shaka.ads.Utils.AD_BUFFERING="ad-buffering",goog.exportProperty(shaka.ads.Utils,"AD_BUFFERING",shaka.ads.Utils.AD_BUFFERING),shaka.ads.Utils.AD_IMPRESSION="ad-impression",goog.exportProperty(shaka.ads.Utils,"AD_IMPRESSION",shaka.ads.Utils.AD_IMPRESSION),shaka.ads.Utils.AD_DURATION_CHANGED="ad-duration-changed",goog.exportProperty(shaka.ads.Utils,"AD_DURATION_CHANGED",shaka.ads.Utils.AD_DURATION_CHANGED),shaka.ads.Utils.AD_CLOSED="ad-closed",goog.exportProperty(shaka.ads.Utils,"AD_CLOSED",shaka.ads.Utils.AD_CLOSED),shaka.ads.Utils.AD_LOADED="ad-loaded",goog.exportProperty(shaka.ads.Utils,"AD_LOADED",shaka.ads.Utils.AD_LOADED),shaka.ads.Utils.ALL_ADS_COMPLETED="all-ads-completed",goog.exportProperty(shaka.ads.Utils,"ALL_ADS_COMPLETED",shaka.ads.Utils.ALL_ADS_COMPLETED),shaka.ads.Utils.AD_LINEAR_CHANGED="ad-linear-changed",goog.exportProperty(shaka.ads.Utils,"AD_LINEAR_CHANGED",shaka.ads.Utils.AD_LINEAR_CHANGED),shaka.ads.Utils.AD_METADATA="ad-metadata",goog.exportProperty(shaka.ads.Utils,"AD_METADATA",shaka.ads.Utils.AD_METADATA),shaka.ads.Utils.AD_RECOVERABLE_ERROR="ad-recoverable-error",goog.exportProperty(shaka.ads.Utils,"AD_RECOVERABLE_ERROR",shaka.ads.Utils.AD_RECOVERABLE_ERROR),shaka.ads.Utils.AD_ERROR="ad-error",goog.exportProperty(shaka.ads.Utils,"AD_ERROR",shaka.ads.Utils.AD_ERROR),shaka.ads.Utils.AD_BREAK_READY="ad-break-ready",goog.exportProperty(shaka.ads.Utils,"AD_BREAK_READY",shaka.ads.Utils.AD_BREAK_READY),shaka.ads.Utils.AD_INTERACTION="ad-interaction",goog.exportProperty(shaka.ads.Utils,"AD_INTERACTION",shaka.ads.Utils.AD_INTERACTION),shaka.ads.Utils.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",goog.exportProperty(shaka.ads.Utils,"AD_CONTENT_PAUSE_REQUESTED",shaka.ads.Utils.AD_CONTENT_PAUSE_REQUESTED),shaka.ads.Utils.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",goog.exportProperty(shaka.ads.Utils,"AD_CONTENT_RESUME_REQUESTED",shaka.ads.Utils.AD_CONTENT_RESUME_REQUESTED),shaka.ads.Utils.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",goog.exportProperty(shaka.ads.Utils,"AD_CONTENT_ATTACH_REQUESTED",shaka.ads.Utils.AD_CONTENT_ATTACH_REQUESTED),shaka.ads.ClientSideAdManager=function(e,t,r,n,a){var i=this;this.adContainer_=e,this.video_=t,this.videoPlayed_=!1,this.resizeObserver_=this.config_=null,this.requestAdsStartTime_=NaN,this.onEvent_=a,this.ad_=null,this.eventManager_=new shaka.util.EventManager,google.ima.settings.setLocale(r),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.adDisplayContainer_=new google.ima.AdDisplayContainer(this.adContainer_,this.video_),this.adDisplayContainer_.initialize(),this.adsLoader_=new google.ima.AdsLoader(this.adDisplayContainer_),this.adsLoader_.getSettings().setPlayerType("shaka-player"),this.adsLoader_.getSettings().setPlayerVersion(shaka.Player.version),this.imaAdsManager_=null,this.adsRenderingSettings_=n||new google.ima.AdsRenderingSettings,this.eventManager_.listen(this.adsLoader_,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(e){i.onAdsManagerLoaded_(e)})),this.eventManager_.listen(this.adsLoader_,google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){i.onAdError_(e)})),this.eventManager_.listen(this.video_,"ended",(function(){i.adsLoader_.contentComplete()})),this.eventManager_.listenOnce(this.video_,"play",(function(){i.videoPlayed_=!0}))},shaka.ads.ClientSideAdManager.prototype.configure=function(e){this.config_=e},shaka.ads.ClientSideAdManager.prototype.requestAds=function(e){goog.asserts.assert(e.adTagUrl||e.adsResponse,"The ad tag needs to be set up before requesting ads, or adsResponse must be filled."),this.imaAdsManager_&&this.imaAdsManager_.destroy(),this.adsLoader_&&this.adsLoader_.contentComplete(),this.requestAdsStartTime_=Date.now()/1e3,this.adsLoader_.requestAds(e)},shaka.ads.ClientSideAdManager.prototype.updateAdsRenderingSettings=function(e){this.adsRenderingSettings_=e,this.imaAdsManager_&&this.imaAdsManager_.updateAdsRenderingSettings(this.adsRenderingSettings_)},shaka.ads.ClientSideAdManager.prototype.stop=function(){this.imaAdsManager_&&this.imaAdsManager_.stop(),this.adContainer_&&shaka.util.Dom.removeAllChildren(this.adContainer_)},shaka.ads.ClientSideAdManager.prototype.release=function(){this.stop(),this.resizeObserver_&&this.resizeObserver_.disconnect(),this.eventManager_&&this.eventManager_.release(),this.imaAdsManager_&&this.imaAdsManager_.destroy(),this.adsLoader_.destroy(),this.adDisplayContainer_.destroy()},shaka.ads.ClientSideAdManager.prototype.onAdError_=function(e){shaka.log.warning("There was an ad error from the IMA SDK: "+e.getError()),shaka.log.warning("Resuming playback."),e=(new Map).set("originalEvent",e),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_ERROR,e)),this.onAdComplete_(null),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.CUEPOINTS_CHANGED,(new Map).set("cuepoints",[])))},shaka.ads.ClientSideAdManager.prototype.onAdsManagerLoaded_=function(e){var t=this;goog.asserts.assert(null!=this.video_,"Video should not be null!");var r=Date.now()/1e3-this.requestAdsStartTime_;if(this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.ADS_LOADED,(new Map).set("loadTime",r))),this.config_.customPlayheadTracker){var n={currentTime:this.video_.currentTime};this.imaAdsManager_=e.getAdsManager(n,this.adsRenderingSettings_),this.video_.muted?this.imaAdsManager_.setVolume(0):this.imaAdsManager_.setVolume(this.video_.volume),this.eventManager_.listen(this.video_,"timeupdate",(function(){t.video_.duration&&(n.currentTime=t.video_.currentTime)})),this.eventManager_.listen(this.video_,"volumechange",(function(){t.ad_&&(t.ad_.setVolume(t.video_.volume),t.video_.muted&&t.ad_.setMuted(!0))}))}else this.imaAdsManager_=e.getAdsManager(this.video_,this.adsRenderingSettings_);if(this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.IMA_AD_MANAGER_LOADED,(new Map).set("imaAdManager",this.imaAdsManager_))),(r=this.imaAdsManager_.getCuePoints()).length){e=[];for(var a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next())e.push({start:a.value,end:null});this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.CUEPOINTS_CHANGED,(new Map).set("cuepoints",e)))}this.addImaEventListeners_();try{var i=this.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;this.imaAdsManager_.init(this.video_.offsetWidth,this.video_.offsetHeight,i),this.eventManager_.listen(this.video_,"loadeddata",(function(){var e=t.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;t.imaAdsManager_.resize(t.video_.offsetWidth,t.video_.offsetHeight,e)})),"ResizeObserver"in window?(this.resizeObserver_=new ResizeObserver((function(){var e=t.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;t.imaAdsManager_.resize(t.video_.offsetWidth,t.video_.offsetHeight,e)})),this.resizeObserver_.observe(this.video_)):this.eventManager_.listen(document,"fullscreenchange",(function(){var e=t.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;t.imaAdsManager_.resize(t.video_.offsetWidth,t.video_.offsetHeight,e)})),this.videoPlayed_||this.config_.skipPlayDetection?this.imaAdsManager_.start():this.eventManager_.listenOnce(this.video_,"play",(function(){t.videoPlayed_=!0,t.imaAdsManager_.start()}))}catch(e){this.onAdComplete_(null)}},shaka.ads.ClientSideAdManager.prototype.isFullScreenEnabled_=function(){if(document.fullscreenEnabled)return!!document.fullscreenElement;var e=this.video_;return!!e.webkitSupportsFullscreen&&e.webkitDisplayingFullscreen},shaka.ads.ClientSideAdManager.prototype.addImaEventListeners_=function(){var e=this,t=function(t,r){t=(new Map).set("originalEvent",t),e.onEvent_(new shaka.util.FakeEvent(r,t))};this.eventManager_.listen(this.imaAdsManager_,google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){e.onAdError_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(t){e.onAdStart_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.STARTED,(function(t){e.onAdStart_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.FIRST_QUARTILE,(function(e){t(e,shaka.ads.Utils.AD_FIRST_QUARTILE)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.MIDPOINT,(function(e){t(e,shaka.ads.Utils.AD_MIDPOINT)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.THIRD_QUARTILE,(function(e){t(e,shaka.ads.Utils.AD_THIRD_QUARTILE)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.COMPLETE,(function(e){t(e,shaka.ads.Utils.AD_COMPLETE)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(t){e.onAdComplete_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){e.onAdComplete_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.SKIPPED,(function(e){t(e,shaka.ads.Utils.AD_SKIPPED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.VOLUME_CHANGED,(function(e){t(e,shaka.ads.Utils.AD_VOLUME_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.VOLUME_MUTED,(function(e){t(e,shaka.ads.Utils.AD_MUTED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.PAUSED,(function(r){e.ad_&&(e.ad_.setPaused(!0),t(r,shaka.ads.Utils.AD_PAUSED))})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.RESUMED,(function(r){e.ad_&&(e.ad_.setPaused(!1),t(r,shaka.ads.Utils.AD_RESUMED))})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(r){e.ad_&&t(r,shaka.ads.Utils.AD_SKIP_STATE_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.CLICK,(function(e){t(e,shaka.ads.Utils.AD_CLICKED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_PROGRESS,(function(e){t(e,shaka.ads.Utils.AD_PROGRESS)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_BUFFERING,(function(e){t(e,shaka.ads.Utils.AD_BUFFERING)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.IMPRESSION,(function(e){t(e,shaka.ads.Utils.AD_IMPRESSION)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.DURATION_CHANGE,(function(e){t(e,shaka.ads.Utils.AD_DURATION_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.USER_CLOSE,(function(e){t(e,shaka.ads.Utils.AD_CLOSED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.LOADED,(function(e){t(e,shaka.ads.Utils.AD_LOADED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(e){t(e,shaka.ads.Utils.ALL_ADS_COMPLETED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.LINEAR_CHANGED,(function(e){t(e,shaka.ads.Utils.AD_LINEAR_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_METADATA,(function(e){t(e,shaka.ads.Utils.AD_METADATA)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.LOG,(function(e){t(e,shaka.ads.Utils.AD_RECOVERABLE_ERROR)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_BREAK_READY,(function(e){t(e,shaka.ads.Utils.AD_BREAK_READY)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.INTERACTION,(function(e){t(e,shaka.ads.Utils.AD_INTERACTION)}))},shaka.ads.ClientSideAdManager.prototype.onAdStart_=function(e){goog.asserts.assert(this.imaAdsManager_,"Should have an ads manager at this point!");var t=e.getAd();t?(this.ad_=new shaka.ads.ClientSideAd(t,this.imaAdsManager_,this.video_),e.type!=google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED||this.config_.supportsMultipleMediaElements||this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_CONTENT_PAUSE_REQUESTED)),e=(new Map).set("ad",this.ad_).set("sdkAdObject",t).set("originalEvent",e),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STARTED,e)),this.ad_.isLinear()&&(this.adContainer_.setAttribute("ad-active","true"),this.config_.customPlayheadTracker||this.video_.pause(),this.video_.muted?this.ad_.setInitialMuted(this.video_.volume):this.ad_.setVolume(this.video_.volume))):shaka.log.alwaysWarn("The IMA SDK fired a "+e.type+" event with no associated ad. Unable to play ad!")},shaka.ads.ClientSideAdManager.prototype.onAdComplete_=function(e){e&&e.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED&&!this.config_.supportsMultipleMediaElements&&this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_CONTENT_RESUME_REQUESTED)),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STOPPED,(new Map).set("originalEvent",e))),this.ad_&&this.ad_.isLinear()&&(this.adContainer_.removeAttribute("ad-active"),this.config_.customPlayheadTracker||this.video_.ended||this.video_.play())},shaka.ads.InterstitialAd=function(e,t,r,n,a,i){this.video_=e,this.interstitial_=t,this.skipOffset_=(this.isSkippable_=t.isSkippable)?t.skipOffset||0:t.skipOffset,this.skipFor_=t.skipFor,this.onSkip_=r,this.sequenceLength_=n,this.adPosition_=a,this.isUsingAnotherMediaElement_=i,this.overlay_=t.overlay},shaka.ads.InterstitialAd.prototype.needsSkipUI=function(){return!0},shaka.ads.InterstitialAd.prototype.isClientRendering=function(){return!0},shaka.ads.InterstitialAd.prototype.hasCustomClick=function(){return!1},shaka.ads.InterstitialAd.prototype.isUsingAnotherMediaElement=function(){return this.isUsingAnotherMediaElement_},shaka.ads.InterstitialAd.prototype.getDuration=function(){var e=this.video_.duration;return isNaN(e)?-1:e},shaka.ads.InterstitialAd.prototype.getMinSuggestedDuration=function(){return this.getDuration()},shaka.ads.InterstitialAd.prototype.getRemainingTime=function(){var e=this.video_.duration;return isNaN(e)?-1:e-this.video_.currentTime},shaka.ads.InterstitialAd.prototype.isPaused=function(){return this.video_.paused},shaka.ads.InterstitialAd.prototype.isSkippable=function(){return this.isSkippable_&&null!=this.skipFor_?this.getDuration()-this.getRemainingTime()<this.skipOffset_+this.skipFor_:this.isSkippable_},shaka.ads.InterstitialAd.prototype.getTimeUntilSkippable=function(){if(this.isSkippable()){var e=this.getRemainingTime()+this.skipOffset_-this.getDuration();return Math.max(e,0)}return Math.max(this.getRemainingTime(),0)},shaka.ads.InterstitialAd.prototype.canSkipNow=function(){return this.isSkippable_&&0==this.getTimeUntilSkippable()},shaka.ads.InterstitialAd.prototype.skip=function(){this.canSkipNow()&&this.onSkip_()},shaka.ads.InterstitialAd.prototype.pause=function(){return this.video_.pause()},shaka.ads.InterstitialAd.prototype.play=function(){return this.video_.play()},shaka.ads.InterstitialAd.prototype.getVolume=function(){return this.video_.volume},shaka.ads.InterstitialAd.prototype.setVolume=function(e){this.video_.volume=e},shaka.ads.InterstitialAd.prototype.isMuted=function(){return this.video_.muted},shaka.ads.InterstitialAd.prototype.isLinear=function(){return null==this.overlay_},shaka.ads.InterstitialAd.prototype.resize=function(e,t){},shaka.ads.InterstitialAd.prototype.setMuted=function(e){this.video_.muted=e},shaka.ads.InterstitialAd.prototype.getSequenceLength=function(){return this.sequenceLength_},shaka.ads.InterstitialAd.prototype.getPositionInSequence=function(){return this.adPosition_},shaka.ads.InterstitialAd.prototype.getTitle=function(){return""},shaka.ads.InterstitialAd.prototype.getDescription=function(){return""},shaka.ads.InterstitialAd.prototype.getVastMediaBitrate=function(){return 0},shaka.ads.InterstitialAd.prototype.getVastMediaHeight=function(){return 0},shaka.ads.InterstitialAd.prototype.getVastMediaWidth=function(){return 0},shaka.ads.InterstitialAd.prototype.getAdId=function(){return this.interstitial_.id||""},shaka.ads.InterstitialAd.prototype.getCreativeAdId=function(){return""};shaka.ads.InterstitialAd.prototype.getAdvertiserName=function(){return""},shaka.ads.InterstitialAd.prototype.getMediaUrl=function(){return this.interstitial_.uri},shaka.ads.InterstitialAd.prototype.getTimeOffset=function(){return 0},shaka.ads.InterstitialAd.prototype.getPodIndex=function(){return 0},shaka.ads.InterstitialAd.prototype.release=function(){this.video_=null},goog.exportSymbol("shaka.ads.InterstitialAd",shaka.ads.InterstitialAd),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"release",shaka.ads.InterstitialAd.prototype.release),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getPodIndex",shaka.ads.InterstitialAd.prototype.getPodIndex),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getTimeOffset",shaka.ads.InterstitialAd.prototype.getTimeOffset),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getMediaUrl",shaka.ads.InterstitialAd.prototype.getMediaUrl),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getAdvertiserName",shaka.ads.InterstitialAd.prototype.getAdvertiserName),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getCreativeAdId",shaka.ads.InterstitialAd.prototype.getCreativeAdId),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getAdId",shaka.ads.InterstitialAd.prototype.getAdId),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getVastMediaWidth",shaka.ads.InterstitialAd.prototype.getVastMediaWidth),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getVastMediaHeight",shaka.ads.InterstitialAd.prototype.getVastMediaHeight),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getVastMediaBitrate",shaka.ads.InterstitialAd.prototype.getVastMediaBitrate),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getDescription",shaka.ads.InterstitialAd.prototype.getDescription),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getTitle",shaka.ads.InterstitialAd.prototype.getTitle),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getPositionInSequence",shaka.ads.InterstitialAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getSequenceLength",shaka.ads.InterstitialAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"setMuted",shaka.ads.InterstitialAd.prototype.setMuted),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"resize",shaka.ads.InterstitialAd.prototype.resize),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"isLinear",shaka.ads.InterstitialAd.prototype.isLinear),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"isMuted",shaka.ads.InterstitialAd.prototype.isMuted),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"setVolume",shaka.ads.InterstitialAd.prototype.setVolume),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getVolume",shaka.ads.InterstitialAd.prototype.getVolume),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"play",shaka.ads.InterstitialAd.prototype.play),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"pause",shaka.ads.InterstitialAd.prototype.pause),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"skip",shaka.ads.InterstitialAd.prototype.skip),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"canSkipNow",shaka.ads.InterstitialAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getTimeUntilSkippable",shaka.ads.InterstitialAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"isSkippable",shaka.ads.InterstitialAd.prototype.isSkippable),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"isPaused",shaka.ads.InterstitialAd.prototype.isPaused),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getRemainingTime",shaka.ads.InterstitialAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getMinSuggestedDuration",shaka.ads.InterstitialAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"getDuration",shaka.ads.InterstitialAd.prototype.getDuration),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"isUsingAnotherMediaElement",shaka.ads.InterstitialAd.prototype.isUsingAnotherMediaElement),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"hasCustomClick",shaka.ads.InterstitialAd.prototype.hasCustomClick),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"isClientRendering",shaka.ads.InterstitialAd.prototype.isClientRendering),goog.exportProperty(shaka.ads.InterstitialAd.prototype,"needsSkipUI",shaka.ads.InterstitialAd.prototype.needsSkipUI),shaka.ads.InterstitialStaticAd=function(e,t,r){this.interstitial_=e,this.sequenceLength_=t,this.adPosition_=r,this.isLinear_=null==e.overlay},shaka.ads.InterstitialStaticAd.prototype.needsSkipUI=function(){return!0},shaka.ads.InterstitialStaticAd.prototype.isClientRendering=function(){return!0},shaka.ads.InterstitialStaticAd.prototype.hasCustomClick=function(){return!1},shaka.ads.InterstitialStaticAd.prototype.isUsingAnotherMediaElement=function(){return!1},shaka.ads.InterstitialStaticAd.prototype.getDuration=function(){return-1},shaka.ads.InterstitialStaticAd.prototype.getMinSuggestedDuration=function(){return this.getDuration()},shaka.ads.InterstitialStaticAd.prototype.getRemainingTime=function(){return-1},shaka.ads.InterstitialStaticAd.prototype.isPaused=function(){return!1},shaka.ads.InterstitialStaticAd.prototype.isSkippable=function(){return!1},shaka.ads.InterstitialStaticAd.prototype.getTimeUntilSkippable=function(){return 0},shaka.ads.InterstitialStaticAd.prototype.canSkipNow=function(){return!1},shaka.ads.InterstitialStaticAd.prototype.skip=function(){},shaka.ads.InterstitialStaticAd.prototype.pause=function(){},shaka.ads.InterstitialStaticAd.prototype.play=function(){},shaka.ads.InterstitialStaticAd.prototype.getVolume=function(){return 1},shaka.ads.InterstitialStaticAd.prototype.setVolume=function(e){},shaka.ads.InterstitialStaticAd.prototype.isMuted=function(){return!1},shaka.ads.InterstitialStaticAd.prototype.isLinear=function(){return this.isLinear_},shaka.ads.InterstitialStaticAd.prototype.resize=function(e,t){},shaka.ads.InterstitialStaticAd.prototype.setMuted=function(e){},shaka.ads.InterstitialStaticAd.prototype.getSequenceLength=function(){return this.sequenceLength_},shaka.ads.InterstitialStaticAd.prototype.getPositionInSequence=function(){return this.adPosition_},shaka.ads.InterstitialStaticAd.prototype.getTitle=function(){return""},shaka.ads.InterstitialStaticAd.prototype.getDescription=function(){return""},shaka.ads.InterstitialStaticAd.prototype.getVastMediaBitrate=function(){return 0},shaka.ads.InterstitialStaticAd.prototype.getVastMediaHeight=function(){return 0},shaka.ads.InterstitialStaticAd.prototype.getVastMediaWidth=function(){return 0},shaka.ads.InterstitialStaticAd.prototype.getAdId=function(){return this.interstitial_.id||""},shaka.ads.InterstitialStaticAd.prototype.getCreativeAdId=function(){return""},shaka.ads.InterstitialStaticAd.prototype.getAdvertiserName=function(){return""},shaka.ads.InterstitialStaticAd.prototype.getMediaUrl=function(){return this.interstitial_.uri},shaka.ads.InterstitialStaticAd.prototype.getTimeOffset=function(){return 0},shaka.ads.InterstitialStaticAd.prototype.getPodIndex=function(){return 0},shaka.ads.InterstitialStaticAd.prototype.release=function(){},goog.exportSymbol("shaka.ads.InterstitialStaticAd",shaka.ads.InterstitialStaticAd),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"release",shaka.ads.InterstitialStaticAd.prototype.release),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getPodIndex",shaka.ads.InterstitialStaticAd.prototype.getPodIndex),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getTimeOffset",shaka.ads.InterstitialStaticAd.prototype.getTimeOffset),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getMediaUrl",shaka.ads.InterstitialStaticAd.prototype.getMediaUrl),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getAdvertiserName",shaka.ads.InterstitialStaticAd.prototype.getAdvertiserName),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getCreativeAdId",shaka.ads.InterstitialStaticAd.prototype.getCreativeAdId),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getAdId",shaka.ads.InterstitialStaticAd.prototype.getAdId),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getVastMediaWidth",shaka.ads.InterstitialStaticAd.prototype.getVastMediaWidth),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getVastMediaHeight",shaka.ads.InterstitialStaticAd.prototype.getVastMediaHeight),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getVastMediaBitrate",shaka.ads.InterstitialStaticAd.prototype.getVastMediaBitrate),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getDescription",shaka.ads.InterstitialStaticAd.prototype.getDescription),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getTitle",shaka.ads.InterstitialStaticAd.prototype.getTitle),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getPositionInSequence",shaka.ads.InterstitialStaticAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getSequenceLength",shaka.ads.InterstitialStaticAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"setMuted",shaka.ads.InterstitialStaticAd.prototype.setMuted),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"resize",shaka.ads.InterstitialStaticAd.prototype.resize),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"isLinear",shaka.ads.InterstitialStaticAd.prototype.isLinear),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"isMuted",shaka.ads.InterstitialStaticAd.prototype.isMuted),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"setVolume",shaka.ads.InterstitialStaticAd.prototype.setVolume),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getVolume",shaka.ads.InterstitialStaticAd.prototype.getVolume),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"play",shaka.ads.InterstitialStaticAd.prototype.play),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"pause",shaka.ads.InterstitialStaticAd.prototype.pause),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"skip",shaka.ads.InterstitialStaticAd.prototype.skip),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"canSkipNow",shaka.ads.InterstitialStaticAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getTimeUntilSkippable",shaka.ads.InterstitialStaticAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"isSkippable",shaka.ads.InterstitialStaticAd.prototype.isSkippable),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"isPaused",shaka.ads.InterstitialStaticAd.prototype.isPaused),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getRemainingTime",shaka.ads.InterstitialStaticAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getMinSuggestedDuration",shaka.ads.InterstitialStaticAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"getDuration",shaka.ads.InterstitialStaticAd.prototype.getDuration),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"isUsingAnotherMediaElement",shaka.ads.InterstitialStaticAd.prototype.isUsingAnotherMediaElement),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"hasCustomClick",shaka.ads.InterstitialStaticAd.prototype.hasCustomClick),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"isClientRendering",shaka.ads.InterstitialStaticAd.prototype.isClientRendering),goog.exportProperty(shaka.ads.InterstitialStaticAd.prototype,"needsSkipUI",shaka.ads.InterstitialStaticAd.prototype.needsSkipUI),shaka.ads.InterstitialAdManager=function(e,t,r,n){var a=this;this.config_=null,this.adContainer_=e,this.basePlayer_=t,this.baseVideo_=r,this.adVideo_=null,this.usingBaseVideo_=!0,this.video_=this.baseVideo_,this.onEvent_=n,this.interstitialIds_=new Set,this.interstitials_=new Set,this.preloadManagerInterstitials_=new Map,this.preloadOnDomElements_=new Map,this.player_=new shaka.Player,this.updatePlayerConfig_(),this.eventManager_=new shaka.util.EventManager,this.adEventManager_=new shaka.util.EventManager,this.playingAd_=!1,this.lastOnSkip_=this.playoutLimitTimer_=this.lastPlayedAd_=this.lastTime_=null,this.usingListeners_=!1,this.videoCallbackId_=-1,this.checkForInterstitials_=function(){if(!a.playingAd_&&a.lastTime_&&!a.basePlayer_.isRemotePlayback()){a.lastTime_=a.baseVideo_.currentTime,a.lastPlayedAd_&&!a.lastPlayedAd_.pre&&!a.lastPlayedAd_.post&&a.lastTime_<a.lastPlayedAd_.startTime&&(a.lastPlayedAd_=null);var e=a.getCurrentInterstitial_();e&&a.setupAd_(e,1,1,Date.now())}},this.onTimeUpdate_=function(){if(!(a.playingAd_||a.lastTime_||a.basePlayer_.isRemotePlayback())){a.lastTime_=a.baseVideo_.currentTime;var e=a.getCurrentInterstitial_(!0);e&&a.setupAd_(e,1,1,Date.now())}},this.timeUpdateTimer_=new shaka.util.Timer(this.checkForInterstitials_),this.pollTimer_=new shaka.util.Timer((function(){var e,t,r,n,i,s,o,l,u,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){switch(p.nextAddress){case 1:if(!a.interstitials_.size||null==a.lastTime_){p.jumpTo(0);break}if((e=a.basePlayer_.getLoadMode())==shaka.Player.LoadMode.DESTROYED||e==shaka.Player.LoadMode.NOT_LOADED)return p.return();t=!1,r=Array.from(a.interstitials_),n=a.basePlayer_.seekRange(),i=$jscomp.makeIterator(r),s=i.next();case 3:if(s.done){p.jumpTo(5);break}if((o=s.value)==a.lastPlayedAd_){p.jumpTo(4);break}if(l=o.endTime||o.startTime,!(1<=n.start-l)){0<(u=o.startTime-a.lastTime_)&&10>=u&&(!a.preloadManagerInterstitials_.has(o)&&a.isPreloadAllowed_(o)&&a.preloadManagerInterstitials_.set(o,a.player_.preload(o.uri,null,o.mimeType||void 0)),a.checkPreloadOnDomElements_(o)),p.jumpTo(4);break}if(!a.preloadManagerInterstitials_.has(o)){p.jumpTo(7);break}return p.yield(a.preloadManagerInterstitials_.get(o),8);case 8:(c=p.yieldResult)&&c.destroy(),a.preloadManagerInterstitials_.delete(o);case 7:a.removePreloadOnDomElements_(o),d=JSON.stringify(o),a.interstitialIds_.has(d)&&a.interstitialIds_.delete(d),a.interstitials_.delete(o),a.removeEventListeners_(),o.overlay||(t=!0);case 4:s=i.next(),p.jumpTo(3);break;case 5:t&&a.cuepointsChanged_(),p.jumpToEnd()}}))}))},shaka.ads.InterstitialAdManager.prototype.configure=function(e){this.config_=e,this.determineIfUsingBaseVideo_()},shaka.ads.InterstitialAdManager.prototype.addEventListeners_=function(){var e=this;if(!this.usingListeners_&&this.interstitials_.size){if(this.eventManager_.listen(this.baseVideo_,"playing",this.onTimeUpdate_),this.eventManager_.listen(this.baseVideo_,"timeupdate",this.onTimeUpdate_),this.eventManager_.listen(this.baseVideo_,"ended",this.checkForInterstitials_),"requestVideoFrameCallback"in this.baseVideo_&&!shaka.util.Platform.isSmartTV()){var t=this.baseVideo_,r=function(n,a){-1!=e.videoCallbackId_&&(e.checkForInterstitials_(),-1!=e.videoCallbackId_&&(e.videoCallbackId_=t.requestVideoFrameCallback(r)))};this.videoCallbackId_=t.requestVideoFrameCallback(r)}else this.timeUpdateTimer_.tickEvery(.025);this.pollTimer_&&this.pollTimer_.tickEvery(1),this.usingListeners_=!0}},shaka.ads.InterstitialAdManager.prototype.removeEventListeners_=function(){this.usingListeners_&&!this.interstitials_.size&&(this.eventManager_.unlisten(this.baseVideo_,"playing",this.onTimeUpdate_),this.eventManager_.unlisten(this.baseVideo_,"timeupdate",this.onTimeUpdate_),this.eventManager_.unlisten(this.baseVideo_,"ended",this.checkForInterstitials_),-1!=this.videoCallbackId_&&(this.baseVideo_.cancelVideoFrameCallback(this.videoCallbackId_),this.videoCallbackId_=-1),this.timeUpdateTimer_&&this.timeUpdateTimer_.stop(),this.pollTimer_&&this.pollTimer_.stop(),this.usingListeners_=!1)},shaka.ads.InterstitialAdManager.prototype.determineIfUsingBaseVideo_=function(){if(this.adContainer_&&this.config_&&!this.playingAd_){var e=this.config_.supportsMultipleMediaElements,t=this.baseVideo_;t.webkitSupportsFullscreen&&t.webkitDisplayingFullscreen&&(e=!1),this.usingBaseVideo_==e&&((this.usingBaseVideo_=!e)?(this.video_=this.baseVideo_,this.adVideo_&&(this.adVideo_.parentElement&&this.adContainer_.removeChild(this.adVideo_),this.adVideo_=null)):(this.adVideo_||(this.adVideo_=this.createMediaElement_()),this.video_=this.adVideo_))}},shaka.ads.InterstitialAdManager.prototype.stop=function(){if(this.adEventManager_&&this.adEventManager_.removeAll(),this.interstitialIds_.clear(),this.interstitials_.clear(),this.player_.destroyAllPreloads(),this.preloadManagerInterstitials_.size)for(var e=Array.from(this.preloadManagerInterstitials_.values()),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())(t=t.value)&&t.then((function(e){e&&e.destroy()}));if(this.preloadManagerInterstitials_.clear(),this.preloadOnDomElements_.size)for(e=Array.from(this.preloadOnDomElements_.keys()),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())this.removePreloadOnDomElements_(t.value);this.preloadOnDomElements_.clear(),this.player_.detach(),this.playingAd_=!1,this.lastPlayedAd_=this.lastTime_=null,this.usingBaseVideo_=!0,this.video_=this.baseVideo_,this.adVideo_=null,this.removeBaseStyles_(),this.removeEventListeners_(),this.adContainer_&&shaka.util.Dom.removeAllChildren(this.adContainer_),this.playoutLimitTimer_&&(this.playoutLimitTimer_.stop(),this.playoutLimitTimer_=null)},shaka.ads.InterstitialAdManager.prototype.release=function(){this.stop(),this.eventManager_&&this.eventManager_.release(),this.adEventManager_&&this.adEventManager_.release(),this.timeUpdateTimer_&&(this.timeUpdateTimer_.stop(),this.timeUpdateTimer_=null),this.pollTimer_&&(this.pollTimer_.stop(),this.pollTimer_=null),this.player_.destroy()},shaka.ads.InterstitialAdManager.prototype.getPlayer=function(){return this.player_},shaka.ads.InterstitialAdManager.prototype.addMetadata=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return r.updatePlayerConfig_(),n.yield(r.getInterstitialsInfo_(e),2);(t=n.yieldResult).length?r.addInterstitials(t):shaka.log.alwaysWarn("Unsupported HLS interstitial",e),n.jumpToEnd()}))},shaka.ads.InterstitialAdManager.prototype.addRegion=function(e){var t=shaka.util.TXml,r="urn:mpeg:dash:event:alternativeMPD:replace:2025"==e.schemeIdUri,n="urn:mpeg:dash:event:alternativeMPD:insert:2025"==e.schemeIdUri;if(r||n){for(var a,i=e.startTime,s=e.endTime,o=null,l=0,u=$jscomp.makeIterator(e.eventNode.children),c=u.next();!c.done;c=u.next())if("AlternativeMPD"==(c=c.value).tagName){if(c=c.attributes.uri){a=c;break}}else if("InsertPresentation"==c.tagName||"ReplacePresentation"==c.tagName){var d=c.attributes.url;if(d){a=d,(u=t.parseAttr(c,"maxDuration",t.parseInt))&&(o=u/e.timescale),(t=t.parseAttr(c,"returnOffset",t.parseInt))&&(l=t/e.timescale),r&&l&&(s=i+l);break}}a?this.addInterstitials([{id:e.id,groupId:null,startTime:i,endTime:s,uri:a,mimeType:null,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:n?l:null,playoutLimit:o,once:!1,pre:!1,post:!1,timelineRange:r&&!n,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null}]):shaka.log.warning("Unsupported alternative media presentation",e)}else shaka.log.warning("Unsupported alternative media presentation",e)},shaka.ads.InterstitialAdManager.prototype.addOverlayRegion=function(e){var t=shaka.util.TXml;goog.asserts.assert(e.eventNode,"Need a region eventNode");var r=t.findChild(e.eventNode,"OverlayEvent"),n=r.attributes.uri,a=r.attributes.mimeType,i="true"==r.attributes.loop,s=t.parseAttr(r,"z",t.parseInt);if(n&&0!=s){var o={viewport:{x:1920,y:1080},topLeft:{x:0,y:0},size:{x:1920,y:1080}},l=t.findChild(r,"Viewport"),u=t.findChild(r,"TopLeft"),c=t.findChild(r,"Size");if(l&&u&&c){if(null==(o=t.parseAttr(l,"x",t.parseInt)))return void shaka.log.warning("Unsupported OverlayEvent",e);if(null==(l=t.parseAttr(l,"y",t.parseInt)))return void shaka.log.warning("Unsupported OverlayEvent",e);var d=t.parseAttr(u,"x",t.parseInt);if(null==d)return void shaka.log.warning("Unsupported OverlayEvent",e);if(null==(u=t.parseAttr(u,"y",t.parseInt)))return void shaka.log.warning("Unsupported OverlayEvent",e);var p=t.parseAttr(c,"x",t.parseInt);if(null==p)return void shaka.log.warning("Unsupported OverlayEvent",e);if(null==(c=t.parseAttr(c,"y",t.parseInt)))return void shaka.log.warning("Unsupported OverlayEvent",e);o={viewport:{x:o,y:l},topLeft:{x:d,y:u},size:{x:p,y:c}}}c=t.findChild(r,"SqueezeCurrent"),r=null,c&&(t=t.parseAttr(c,"percentage",t.parseFloat))&&(r={viewport:{x:1920,y:1080},topLeft:{x:0,y:0},size:{x:1920*t,y:1080*t}}),this.addInterstitials([{id:e.id,groupId:null,startTime:e.startTime,endTime:e.endTime,uri:n,mimeType:a,isSkippable:!1,skipOffset:null,skipFor:null,canJump:!0,resumeOffset:null,playoutLimit:null,once:!1,pre:!1,post:!1,timelineRange:!0,loop:i,overlay:o,displayOnBackground:-1==s,currentVideo:r,background:null}])}else shaka.log.warning("Unsupported OverlayEvent",e)},shaka.ads.InterstitialAdManager.prototype.addAdUrlInterstitial=function(e){var t,r,n,a,i,s,o,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){switch(p.nextAddress){case 1:return t=shaka.net.NetworkingEngine,r={type:t.AdvancedRequestType.INTERSTITIAL_AD_URL},p.yield(d.makeAdRequest_(e,r),2);case 2:if(n=p.yieldResult,!(a=shaka.util.TXml.parseXml(n,"VAST,vmap:VMAP")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.ADS,shaka.util.Error.Code.VAST_INVALID_XML);if(i=[],"VAST"==a.tagName){i=shaka.ads.Utils.parseVastToInterstitials(a,d.lastTime_),p.jumpTo(3);break}if("vmap:VMAP"!=a.tagName){p.jumpTo(3);break}s=$jscomp.makeIterator(shaka.ads.Utils.parseVMAP(a)),o=s.next();case 5:if(o.done){p.jumpTo(3);break}return l=o.value,p.yield(d.makeAdRequest_(l.uri,r),8);case 8:if(u=p.yieldResult,!(c=shaka.util.TXml.parseXml(u,"VAST")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.ADS,shaka.util.Error.Code.VAST_INVALID_XML);i.push.apply(i,$jscomp.arrayFromIterable(shaka.ads.Utils.parseVastToInterstitials(c,l.time))),o=s.next(),p.jumpTo(5);break;case 3:d.addInterstitials(i),p.jumpToEnd()}}))},shaka.ads.InterstitialAdManager.prototype.addInterstitials=function(e){var t,r,n,a,i,s,o,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:t=!1,r=$jscomp.makeIterator(e),n=r.next();case 2:if(n.done){c.jumpTo(4);break}if(!(a=n.value).uri){shaka.log.alwaysWarn("Missing URL in interstitial",a),c.jumpTo(3);break}if(a.mimeType){c.jumpTo(5);break}return c.setCatchFinallyBlocks(6),i=u.player_.getNetworkingEngine(),goog.asserts.assert(i,"Need networking engine"),c.yield(shaka.net.NetworkingUtils.getMimeType(a.uri,i,u.basePlayer_.getConfiguration().streaming.retryParameters),8);case 8:a.mimeType=c.yieldResult,c.leaveTryBlock(5);break;case 6:c.enterCatchBlock();case 5:if(s=a.id||JSON.stringify(a),u.interstitialIds_.has(s)){c.jumpTo(3);break}a.loop&&!a.overlay&&shaka.log.alwaysWarn("Loop is only supported in overlay interstitials",a),a.overlay||(t=!0),u.interstitialIds_.add(s),u.interstitials_.add(a),o=!1,a.pre&&null==u.lastTime_?o=!0:0!=a.startTime||a.canJump?null!=u.lastTime_&&(0<(l=a.startTime-u.lastTime_)&&10>=l&&(o=!0)):o=!0,o&&(!u.preloadManagerInterstitials_.has(a)&&u.isPreloadAllowed_(a)&&u.preloadManagerInterstitials_.set(a,u.player_.preload(a.uri,null,a.mimeType||void 0)),u.checkPreloadOnDomElements_(a));case 3:n=r.next(),c.jumpTo(2);break;case 4:t&&u.cuepointsChanged_(),u.addEventListeners_(),c.jumpToEnd()}}))},shaka.ads.InterstitialAdManager.prototype.createMediaElement_=function(){var e=document.createElement(this.baseVideo_.tagName);return e.autoplay=!0,e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.display="none",e.setAttribute("playsinline",""),e},shaka.ads.InterstitialAdManager.prototype.getCurrentInterstitial_=function(e,t){e=void 0!==e&&e,t=void 0===t?null:t;var r=0,n=null;if(this.interstitials_.size&&null!=this.lastTime_){var a=this.baseVideo_.ended,i=Array.from(this.interstitials_).sort((function(e,t){return t.startTime-e.startTime})),s=i;for(s=e?i.filter((function(e){return e.pre})):a?i.filter((function(e){return e.post})):i.filter((function(e){return!e.pre&&!e.post})),s=(i=$jscomp.makeIterator(s)).next();!s.done;s=i.next()){s=s.value;var o=!1;if(e)o=s.pre;else if(a)o=s.post;else if(!s.pre&&!s.post){var l=this.lastTime_-Math.round(1e3*s.startTime)/1e3;0<l&&(1>=l||!s.canJump)&&(o=!(null==t&&this.lastPlayedAd_&&!this.lastPlayedAd_.pre&&!this.lastPlayedAd_.post&&this.lastPlayedAd_.startTime>=s.startTime))}o&&(!this.lastPlayedAd_||s.startTime>=this.lastPlayedAd_.startTime)&&(r==(t||0)?n=s:n&&!s.canJump&&.001<Math.round(1e3*s.startTime)/1e3-Math.round(1e3*n.startTime)/1e3&&(n=s,r=0),r++)}}return n},shaka.ads.InterstitialAdManager.prototype.setupAd_=function(e,t,r,n,a){a=void 0===a?0:a,shaka.log.info("Starting interstitial",e.startTime,"at",this.lastTime_),this.lastPlayedAd_=e,this.determineIfUsingBaseVideo_(),goog.asserts.assert(this.video_,"Must have video"),!this.video_.parentElement&&this.adContainer_&&this.adContainer_.appendChild(this.video_),1==r&&1==t&&(t=Array.from(this.interstitials_).filter((function(t){return e.pre?t.pre==e.pre:e.post?t.post==e.post:.001>Math.abs(t.startTime-e.startTime)})).length),e.once&&(a++,this.interstitials_.delete(e),this.removeEventListeners_(),e.overlay||this.cuepointsChanged_()),e.mimeType&&(e.mimeType.startsWith("image/")||"text/html"===e.mimeType)?e.overlay?this.setupStaticAd_(e,t,r,a):shaka.log.alwaysWarn("Unsupported interstitial",e):this.usingBaseVideo_&&e.overlay?shaka.log.alwaysWarn("Unsupported interstitial",e):this.setupVideoAd_(e,t,r,n,a)},shaka.ads.InterstitialAdManager.prototype.setupStaticAd_=function(e,t,r,n){var a=this,i=e.overlay;goog.asserts.assert(i,"Must have overlay");var s="text/html"==e.mimeType?"iframe":"img",o=document.createElement(s);o.style.objectFit="contain",o.style.position="absolute",o.style.border="none",this.setBaseStyles_(e);var l=function(){a.playoutLimitTimer_&&(a.playoutLimitTimer_.stop(),a.playoutLimitTimer_=null),a.adContainer_.removeChild(o),a.removeBaseStyles_(e),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STOPPED));var i=a.getCurrentInterstitial_(e.pre,r-n);i?(a.adEventManager_.removeAll(),a.setupAd_(i,t,++r,Date.now(),n)):a.playingAd_=!1},u=new shaka.ads.InterstitialStaticAd(e,t,r);this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STARTED,(new Map).set("ad",u))),"iframe"==s?o.src=e.uri:(o.src=e.uri,o.onerror=function(e){a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_ERROR,(new Map).set("originalEvent",e))),l()}),u=i.viewport;var c=i.topLeft;i=i.size,0==u.x&&0==u.y?(o.width=e.overlay.size.x,o.height=e.overlay.size.y,o.style.bottom="10%",o.style.left="0",o.style.right="0",o.style.width="100%",e.overlay.size.y||"iframe"!=s||(o.style.height="auto")):(o.style.height=i.y/u.y*100+"%",o.style.left=c.x/u.x*100+"%",o.style.top=c.y/u.y*100+"%",o.style.width=i.x/u.x*100+"%"),this.adContainer_.appendChild(o);var d=Date.now();this.playoutLimitTimer_&&this.playoutLimitTimer_.stop(),this.playoutLimitTimer_=new shaka.util.Timer((function(){e.playoutLimit&&(Date.now()-d)/1e3>e.playoutLimit||e.endTime&&a.baseVideo_.currentTime>e.endTime?(a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_COMPLETE)),l()):a.baseVideo_.currentTime<e.startTime&&(a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_SKIPPED)),l())})),e.playoutLimit&&!e.endTime?this.playoutLimitTimer_.tickAfter(e.playoutLimit):e.endTime&&this.playoutLimitTimer_.tickEvery(.025),this.adEventManager_.listen(this.baseVideo_,"seeked",(function(){var t=a.baseVideo_.currentTime;(t<e.startTime||e.endTime&&t>e.endTime)&&(a.playoutLimitTimer_&&a.playoutLimitTimer_.stop(),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_SKIPPED)),l())}))},shaka.ads.InterstitialAdManager.prototype.setupVideoAd_=function(e,t,r,n,a){var i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(T){switch(T.nextAddress){case 1:if(goog.asserts.assert(b.video_,"Must have video"),i=Date.now(),b.playingAd_=!0,!b.usingBaseVideo_||1!=r){T.jumpTo(2);break}return b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_CONTENT_PAUSE_REQUESTED,(new Map).set("saveLivePosition",!0))),s=new shaka.util.PublicPromise,o=function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return"detach"!=e.state?t.jumpTo(0):shaka.util.Platform.isSmartTV()?t.yield(new Promise((function(e){return new shaka.util.Timer(e).tickAfter(.1)})),3):t.jumpTo(3);s.resolve(),b.adEventManager_.unlisten(b.basePlayer_,"onstatechange",o),t.jumpToEnd()}))},b.adEventManager_.listen(b.basePlayer_,"onstatechange",o),T.yield(s,2);case 2:return b.setBaseStyles_(e),b.usingBaseVideo_||(b.video_.style.display="",e.overlay?(b.video_.loop=e.loop,l=e.overlay.viewport,u=e.overlay.topLeft,c=e.overlay.size,b.video_.style.height=c.y/l.y*100+"%",b.video_.style.left=u.x/l.x*100+"%",b.video_.style.top=u.y/l.y*100+"%",b.video_.style.width=c.x/l.x*100+"%"):(b.baseVideo_.pause(),null!=e.resumeOffset&&0!=e.resumeOffset&&(b.baseVideo_.currentTime+=e.resumeOffset),b.video_.loop=!1,b.video_.style.height="100%",b.video_.style.left="0",b.video_.style.top="0",b.video_.style.width="100%")),d=!1,p=function(){if(!b.usingBaseVideo_&&!e.overlay&&null==e.resumeOffset)if(e.timelineRange&&e.endTime&&1/0!=e.endTime)b.baseVideo_.currentTime!=e.endTime&&(b.baseVideo_.currentTime=e.endTime);else{var t=Date.now();b.baseVideo_.currentTime+=(t-n)/1e3,n=t}},h=function(i){var s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress){if(p(),s=b.getCurrentInterstitial_(e.pre,r-a),i&&e.groupId)for(;s&&s.groupId==e.groupId;)r++,s=b.getCurrentInterstitial_(e.pre,r-a);return b.playoutLimitTimer_&&(!e.groupId||s&&s.groupId!=e.groupId)&&(b.playoutLimitTimer_.stop(),b.playoutLimitTimer_=null),b.removeBaseStyles_(e),s&&!s.overlay?l.jumpTo(2):(e.post&&(b.lastTime_=null,b.lastPlayedAd_=null),b.usingBaseVideo_?l.yield(b.player_.detach(),4):l.yield(b.player_.unload(),4))}2!=l.nextAddress&&(b.usingBaseVideo_&&(null==(o=e.resumeOffset)&&(o=e.timelineRange&&e.endTime&&1/0!=e.endTime?e.endTime-(b.lastTime_||0):(Date.now()-n)/1e3),b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_CONTENT_RESUME_REQUESTED,(new Map).set("offset",o)))),b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STOPPED)),b.adEventManager_.removeAll(),b.playingAd_=!1,b.usingBaseVideo_?b.cuepointsChanged_():(b.video_.style.display="none",p(),b.baseVideo_.ended||b.baseVideo_.play())),b.determineIfUsingBaseVideo_(),s&&(b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STOPPED)),b.adEventManager_.removeAll(),b.setupAd_(s,t,++r,n,a)),l.jumpToEnd()}))},f=function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return d?t.return():(d=!0,b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_ERROR,(new Map).set("originalEvent",e))),t.yield(h(!1),0))}))},m=function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){if(1==e.nextAddress)return d?e.return():(d=!0,e.yield(h(!1),2));b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_COMPLETE)),e.jumpToEnd()}))},b.lastOnSkip_=function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return d?e.return():(d=!0,b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_SKIPPED)),e.yield(h(!0),0))}))},g=new shaka.ads.InterstitialAd(b.video_,e,b.lastOnSkip_,t,r,!b.usingBaseVideo_),b.usingBaseVideo_||(g.setMuted(b.baseVideo_.muted),g.setVolume(b.baseVideo_.volume)),b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STARTED,(new Map).set("ad",g))),(y=g.canSkipNow())&&b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_SKIP_STATE_CHANGED)),b.adEventManager_.listenOnce(b.player_,"error",f),b.adEventManager_.listen(b.video_,"timeupdate",(function(){if(b.video_.duration){var e=g.canSkipNow();y!=e&&0<g.getRemainingTime()&&0<g.getDuration()&&b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_SKIP_STATE_CHANGED)),y=e}})),b.adEventManager_.listenOnce(b.player_,"firstquartile",(function(){p(),b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_FIRST_QUARTILE))})),b.adEventManager_.listenOnce(b.player_,"midpoint",(function(){p(),b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_MIDPOINT))})),b.adEventManager_.listenOnce(b.player_,"thirdquartile",(function(){p(),b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_THIRD_QUARTILE))})),b.adEventManager_.listenOnce(b.player_,"complete",m),b.adEventManager_.listen(b.video_,"play",(function(){b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_RESUMED))})),b.adEventManager_.listen(b.video_,"pause",(function(){var e=b.player_.getConfiguration();b.video_.currentTime>=e.playRangeEnd?m():b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_PAUSED))})),b.adEventManager_.listen(b.video_,"volumechange",(function(){b.video_.muted?b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_MUTED)):b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_VOLUME_CHANGED))})),T.setCatchFinallyBlocks(4),b.updatePlayerConfig_(),e.startTime&&e.endTime&&1/0!=e.endTime&&e.startTime!=e.endTime&&(0<(v=e.endTime-e.startTime)&&b.player_.configure("playRangeEnd",v)),e.playoutLimit&&!b.playoutLimitTimer_&&(b.playoutLimitTimer_=new shaka.util.Timer((function(){b.lastOnSkip_()})).tickAfter(e.playoutLimit),b.player_.configure("playRangeEnd",e.playoutLimit)),T.yield(b.player_.attach(b.video_),6);case 6:return b.preloadManagerInterstitials_.has(e)?T.yield(b.preloadManagerInterstitials_.get(e),10):T.yield(b.player_.load(e.uri,null,e.mimeType||void 0),8);case 10:return _=T.yieldResult,b.preloadManagerInterstitials_.delete(e),_?T.yield(b.player_.load(_),8):T.yield(b.player_.load(e.uri,null,e.mimeType||void 0),8);case 8:b.video_.play(),k=(Date.now()-i)/1e3,b.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.ADS_LOADED,(new Map).set("loadTime",k))),b.usingBaseVideo_&&b.baseVideo_.play(),e.overlay&&(b.adEventManager_.listen(b.baseVideo_,"seeking",(function(){var t=b.baseVideo_.currentTime-e.startTime;.1<Math.abs(t-b.video_.currentTime)&&(b.video_.currentTime=t)})),b.adEventManager_.listen(b.baseVideo_,"seeked",(function(){var t=b.baseVideo_.currentTime;(t<e.startTime||e.endTime&&t>e.endTime)&&b.lastOnSkip_()}))),T.leaveTryBlock(0);break;case 4:if(E=T.enterCatchBlock(),!b.playingAd_)return T.return();f(E),T.jumpToEnd()}}))},shaka.ads.InterstitialAdManager.prototype.setBaseStyles_=function(e){if(e.displayOnBackground&&(this.baseVideo_.style.zIndex="1"),null!=e.currentVideo){var t=e.currentVideo;this.baseVideo_.style.transformOrigin="top left";var r=!0,n=[],a=t.topLeft.x/t.viewport.x*100;0<a&&100>=a&&(n.push("translateX("+a+"%)"),r=!1),0<(a=t.topLeft.y/t.viewport.y*100)&&100>=a&&(n.push("translateY("+a+"%)"),r=!1),1>(a=t.size.x/t.viewport.x)&&n.push("scaleX("+a+")"),t=t.size.y/t.viewport.y,1>a&&n.push("scaleY("+t+")"),n.length&&(this.baseVideo_.style.transform=n.join(" ")),r&&(this.baseVideo_.style.transition="transform 250ms")}this.adContainer_&&(this.adContainer_.style.pointerEvents="none",e.background&&(this.adContainer_.style.background=e.background)),this.adVideo_&&(this.adVideo_.style.background=e.overlay?"":"rgb(0, 0, 0)")},shaka.ads.InterstitialAdManager.prototype.removeBaseStyles_=function(e){e&&!e.displayOnBackground||(this.baseVideo_.style.zIndex=""),e&&null==e.currentVideo||(this.baseVideo_.style.transformOrigin="",this.baseVideo_.style.transition="",this.baseVideo_.style.transform=""),this.adContainer_&&(this.adContainer_.style.pointerEvents="",!e||e.background)&&(this.adContainer_.style.background=""),this.adVideo_&&(this.adVideo_.style.background="")},shaka.ads.InterstitialAdManager.prototype.getInterstitialsInfo_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M,D,O,L,N,U,j,B,F,V,G,H,K=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(W){switch(W.nextAddress){case 1:if(t=[],!e)return W.return(t);if(r=e.values.find((function(e){return"X-ASSET-URI"==e.key})),n=e.values.find((function(e){return"X-ASSET-LIST"==e.key})),!r&&!n)return W.return(t);if(a=null,(i=e.values.find((function(e){return"ID"==e.key})))&&(a=i.data),s=null==a?Math.floor(10*e.startTime)/10:e.startTime,(o=e.endTime)&&1/0!=e.endTime&&"number"==typeof e.endTime&&(o=null==a?Math.floor(10*e.endTime)/10:e.endTime),l=e.values.find((function(e){return"X-RESTRICT"==e.key})),c=u=!0,l&&l.data&&(d=l.data,u=!d.includes("SKIP"),c=!d.includes("JUMP")),p=u?0:null,(h=e.values.find((function(e){return"X-ENABLE-SKIP-AFTER"==e.key})))&&(f=h.data,p=parseFloat(f),isNaN(p)&&(p=u?0:null)),m=null,(g=e.values.find((function(e){return"X-ENABLE-SKIP-FOR"==e.key})))&&(y=g.data,m=parseFloat(y),isNaN(p)&&(m=null)),v=null,(_=e.values.find((function(e){return"X-RESUME-OFFSET"==e.key})))&&(k=_.data,v=parseFloat(k),isNaN(v)&&(v=null)),E=null,(b=e.values.find((function(e){return"X-PLAYOUT-LIMIT"==e.key})))&&(T=b.data,E=parseFloat(T),isNaN(E)&&(E=null)),P=S=A=!1,(C=e.values.find((function(e){return"CUE"==e.key})))&&(x=C.data,A=x.includes("ONCE"),S=x.includes("PRE"),P=x.includes("POST")),I=!1,(w=e.values.find((function(e){return"X-TIMELINE-OCCUPIES"==e.key})))?(R=w.data,I=R.includes("RANGE")):!_&&K.basePlayer_.isLive()&&(I=!S&&!P),r){if(!(M=r.data))return W.return(t);t.push({id:a,groupId:null,startTime:s,endTime:o,uri:M,mimeType:null,isSkippable:u,skipOffset:p,skipFor:m,canJump:c,resumeOffset:v,playoutLimit:E,once:A,pre:S,post:P,timelineRange:I,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null}),W.jumpTo(2);break}if(!n){W.jumpTo(2);break}return(D=n.data)?(W.setCatchFinallyBlocks(4),O=shaka.net.NetworkingEngine,L={type:O.AdvancedRequestType.INTERSTITIAL_ASSET_LIST},W.yield(K.makeAdRequest_(D,L),6)):W.return(t);case 6:for(N=W.yieldResult,U=shaka.util.StringUtils.fromUTF8(N),j=JSON.parse(U),(B=j["SKIP-CONTROL"])&&("number"==typeof(F=B["ENABLE-SKIP-AFTER"])&&(p=parseFloat(F),isNaN(F)&&(p=u?0:null)),"number"==typeof(V=B["ENABLE-SKIP-FOR"])&&(m=parseFloat(V),isNaN(V)&&(m=null))),G=0;G<j.ASSETS.length;G++)(H=j.ASSETS[G]).URI&&t.push({id:a+"_shaka_asset_"+G,groupId:a,startTime:s,endTime:o,uri:H.URI,mimeType:null,isSkippable:u,skipOffset:p,skipFor:m,canJump:c,resumeOffset:v,playoutLimit:E,once:A,pre:S,post:P,timelineRange:I,loop:!1,overlay:null,displayOnBackground:!1,currentVideo:null,background:null});W.leaveTryBlock(2);break;case 4:W.enterCatchBlock();case 2:return W.return(t)}}))},shaka.ads.InterstitialAdManager.prototype.cuepointsChanged_=function(){for(var e=[],t=$jscomp.makeIterator(this.interstitials_),r=t.next(),n={};!r.done;n={shakaCuePoint$jscomp$1:void 0},r=t.next())(r=r.value).overlay||(n.shakaCuePoint$jscomp$1={start:r.startTime,end:null},r.pre?(n.shakaCuePoint$jscomp$1.start=0,n.shakaCuePoint$jscomp$1.end=null):r.post?(n.shakaCuePoint$jscomp$1.start=-1,n.shakaCuePoint$jscomp$1.end=null):r.timelineRange&&(n.shakaCuePoint$jscomp$1.end=r.endTime),e.find(function(e){return function(t){return e.shakaCuePoint$jscomp$1.start==t.start&&e.shakaCuePoint$jscomp$1.end==t.end}}(n))||e.push(n.shakaCuePoint$jscomp$1));this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.CUEPOINTS_CHANGED,(new Map).set("cuepoints",e)))},shaka.ads.InterstitialAdManager.prototype.updatePlayerConfig_=function(){goog.asserts.assert(this.player_,"Must have player"),goog.asserts.assert(this.basePlayer_,"Must have base player"),this.player_.configure(this.basePlayer_.getNonDefaultConfiguration()),this.player_.configure("ads.disableHLSInterstitial",!0),this.player_.configure("ads.disableDASHInterstitial",!0),this.player_.configure("playRangeEnd",1/0);var e=this.player_.getNetworkingEngine();goog.asserts.assert(e,"Need networking engine"),this.basePlayer_.getNetworkingEngine().copyFiltersInto(e)},shaka.ads.InterstitialAdManager.prototype.makeAdRequest_=function(e,t){var r,n,a,i,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(r=shaka.net.NetworkingEngine.RequestType.ADS,n=shaka.net.NetworkingEngine.makeRequest([e],shaka.net.NetworkingEngine.defaultRetryParameters()),a=s.basePlayer_.getNetworkingEngine().request(r,n,t),o.yield(a.promise,2)):(i=o.yieldResult,o.return(i.data))}))},shaka.ads.InterstitialAdManager.prototype.isPreloadAllowed_=function(e){return!(e=e.mimeType)||!e.startsWith("image/")&&"text/html"!==e},shaka.ads.InterstitialAdManager.prototype.getInterstitials=function(){return Array.from(this.interstitials_)},shaka.ads.InterstitialAdManager.prototype.checkPreloadOnDomElements_=function(e){if(!(this.preloadOnDomElements_.has(e)||this.config_&&!this.config_.allowPreloadOnDomElements)){var t=function(e){var t=document.createElement("link");return t.rel="preload",t.href=e,t.as="image",document.head.appendChild(t),t},r=[];if(e.background){var n=e.background.match(/url\(('|")?([^'"()]+)('|")\)?/);n&&r.push(t(n[2]))}e.mimeType.startsWith("image/")&&r.push(t(e.uri)),this.preloadOnDomElements_.set(e,r)}},shaka.ads.InterstitialAdManager.prototype.removePreloadOnDomElements_=function(e){if(this.preloadOnDomElements_.has(e)){for(var t=this.preloadOnDomElements_.get(e),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())(r=r.value).parentNode.removeChild(r);this.preloadOnDomElements_.delete(e)}},shaka.ads.MediaTailorAd=function(e,t,r,n,a){this.ad_=e,this.skipOffset_=shaka.util.TextParser.parseTime(this.ad_.skipOffset),this.video_=a,this.adPosition_=t,this.totalAds_=r,this.isLinear_=n,this.isSkipped_=!1},shaka.ads.MediaTailorAd.prototype.needsSkipUI=function(){return!0},shaka.ads.MediaTailorAd.prototype.isClientRendering=function(){return!1},shaka.ads.MediaTailorAd.prototype.hasCustomClick=function(){return!1},shaka.ads.MediaTailorAd.prototype.isUsingAnotherMediaElement=function(){return!1},shaka.ads.MediaTailorAd.prototype.getDuration=function(){return this.ad_.durationInSeconds},shaka.ads.MediaTailorAd.prototype.getMinSuggestedDuration=function(){return this.getDuration()},shaka.ads.MediaTailorAd.prototype.getRemainingTime=function(){return this.ad_.startTimeInSeconds+this.ad_.durationInSeconds-this.video_.currentTime},shaka.ads.MediaTailorAd.prototype.isPaused=function(){return this.video_.paused},shaka.ads.MediaTailorAd.prototype.isSkippable=function(){return"number"==typeof this.skipOffset_},shaka.ads.MediaTailorAd.prototype.getTimeUntilSkippable=function(){if("number"!=typeof this.skipOffset_)return this.getRemainingTime();var e=this.getRemainingTime()+this.skipOffset_-this.getDuration();return Math.max(e,0)},shaka.ads.MediaTailorAd.prototype.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},shaka.ads.MediaTailorAd.prototype.skip=function(){this.isSkipped_=!0,this.video_.currentTime+=this.getRemainingTime()},shaka.ads.MediaTailorAd.prototype.pause=function(){return this.video_.pause()},shaka.ads.MediaTailorAd.prototype.play=function(){return this.video_.play()},shaka.ads.MediaTailorAd.prototype.getVolume=function(){return this.video_.volume},shaka.ads.MediaTailorAd.prototype.setVolume=function(e){this.video_.volume=e},shaka.ads.MediaTailorAd.prototype.isMuted=function(){return this.video_.muted},shaka.ads.MediaTailorAd.prototype.isLinear=function(){return this.isLinear_},shaka.ads.MediaTailorAd.prototype.resize=function(e,t){},shaka.ads.MediaTailorAd.prototype.setMuted=function(e){this.video_.muted=e},shaka.ads.MediaTailorAd.prototype.getSequenceLength=function(){return this.totalAds_?this.totalAds_:1},shaka.ads.MediaTailorAd.prototype.getPositionInSequence=function(){return this.adPosition_?this.adPosition_:1},shaka.ads.MediaTailorAd.prototype.getTitle=function(){return this.ad_.adTitle},shaka.ads.MediaTailorAd.prototype.getDescription=function(){return""},shaka.ads.MediaTailorAd.prototype.getVastMediaBitrate=function(){return 0},shaka.ads.MediaTailorAd.prototype.getVastMediaHeight=function(){return 0},shaka.ads.MediaTailorAd.prototype.getVastMediaWidth=function(){return 0},shaka.ads.MediaTailorAd.prototype.getAdId=function(){return this.ad_.adId},shaka.ads.MediaTailorAd.prototype.getCreativeAdId=function(){return this.ad_.creativeId},shaka.ads.MediaTailorAd.prototype.getAdvertiserName=function(){return""},shaka.ads.MediaTailorAd.prototype.getMediaUrl=function(){return null},shaka.ads.MediaTailorAd.prototype.getTimeOffset=function(){return 0},shaka.ads.MediaTailorAd.prototype.getPodIndex=function(){return 0},shaka.ads.MediaTailorAd.prototype.release=function(){this.totalAds_=this.adPosition_=this.video_=this.ad_=null},shaka.ads.MediaTailorAd.prototype.isSkipped=function(){return this.isSkipped_},goog.exportSymbol("shaka.ads.MediaTailorAd",shaka.ads.MediaTailorAd),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"release",shaka.ads.MediaTailorAd.prototype.release),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getPodIndex",shaka.ads.MediaTailorAd.prototype.getPodIndex),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getTimeOffset",shaka.ads.MediaTailorAd.prototype.getTimeOffset),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getMediaUrl",shaka.ads.MediaTailorAd.prototype.getMediaUrl),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getAdvertiserName",shaka.ads.MediaTailorAd.prototype.getAdvertiserName),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getCreativeAdId",shaka.ads.MediaTailorAd.prototype.getCreativeAdId),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getAdId",shaka.ads.MediaTailorAd.prototype.getAdId),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getVastMediaWidth",shaka.ads.MediaTailorAd.prototype.getVastMediaWidth),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getVastMediaHeight",shaka.ads.MediaTailorAd.prototype.getVastMediaHeight),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getVastMediaBitrate",shaka.ads.MediaTailorAd.prototype.getVastMediaBitrate),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getDescription",shaka.ads.MediaTailorAd.prototype.getDescription),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getTitle",shaka.ads.MediaTailorAd.prototype.getTitle),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getPositionInSequence",shaka.ads.MediaTailorAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getSequenceLength",shaka.ads.MediaTailorAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"setMuted",shaka.ads.MediaTailorAd.prototype.setMuted),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"resize",shaka.ads.MediaTailorAd.prototype.resize),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isLinear",shaka.ads.MediaTailorAd.prototype.isLinear),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isMuted",shaka.ads.MediaTailorAd.prototype.isMuted),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"setVolume",shaka.ads.MediaTailorAd.prototype.setVolume),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getVolume",shaka.ads.MediaTailorAd.prototype.getVolume),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"play",shaka.ads.MediaTailorAd.prototype.play),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"pause",shaka.ads.MediaTailorAd.prototype.pause),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"skip",shaka.ads.MediaTailorAd.prototype.skip),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"canSkipNow",shaka.ads.MediaTailorAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getTimeUntilSkippable",shaka.ads.MediaTailorAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isSkippable",shaka.ads.MediaTailorAd.prototype.isSkippable),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isPaused",shaka.ads.MediaTailorAd.prototype.isPaused),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getRemainingTime",shaka.ads.MediaTailorAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getMinSuggestedDuration",shaka.ads.MediaTailorAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getDuration",shaka.ads.MediaTailorAd.prototype.getDuration),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isUsingAnotherMediaElement",shaka.ads.MediaTailorAd.prototype.isUsingAnotherMediaElement),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"hasCustomClick",shaka.ads.MediaTailorAd.prototype.hasCustomClick),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isClientRendering",shaka.ads.MediaTailorAd.prototype.isClientRendering),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"needsSkipUI",shaka.ads.MediaTailorAd.prototype.needsSkipUI),shaka.ads.MediaTailorAdManager=function(e,t,r,n){this.adContainer_=e,this.networkingEngine_=t,this.video_=r,this.streamPromise_=null,this.streamRequestStartTime_=NaN,this.onEvent_=n,this.isLive_=!1,this.snapForwardTime_=null,this.adBreaks_=[],this.playedAds_=[],this.mediaTailorAdBreak_=this.mediaTailorAd_=this.ad_=null,this.staticResources_=new Map,this.adListeners_=[],this.eventsSent=[],this.trackingUrl_="",this.firstTrackingRequest_=!0,this.backupUrl_="",this.currentCuePoints_=[],this.eventManager_=new shaka.util.EventManager},shaka.ads.MediaTailorAdManager.prototype.streamRequest=function(e,t,r){return this.streamPromise_?Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CURRENT_DAI_REQUEST_NOT_FINISHED)):(this.streamPromise_=new shaka.util.PublicPromise,this.requestSessionInfo_(e,t),this.backupUrl_=r||"",this.streamRequestStartTime_=Date.now()/1e3,this.streamPromise_)},shaka.ads.MediaTailorAdManager.prototype.addTrackingUrl=function(e){this.trackingUrl_=e,this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.ADS_LOADED,(new Map).set("loadTime",0)))},shaka.ads.MediaTailorAdManager.prototype.stop=function(){for(var e=$jscomp.makeIterator(this.adListeners_),t=e.next();!t.done;t=e.next())t=t.value,this.eventManager_.unlisten(t.target,t.type,t.listener);this.onEnded_(),this.adListeners_=[],this.eventsSent=[],this.trackingUrl_="",this.firstTrackingRequest_=!0,this.backupUrl_="",this.snapForwardTime_=null,this.adBreaks_=[],this.playedAds_=[],this.staticResources_.clear()},shaka.ads.MediaTailorAdManager.prototype.release=function(){this.stop(),this.eventManager_&&this.eventManager_.release()},shaka.ads.MediaTailorAdManager.prototype.onManifestUpdated=function(e){this.isLive_=e,""!=this.trackingUrl_&&(this.requestTrackingInfo_(this.trackingUrl_,this.firstTrackingRequest_),this.firstTrackingRequest_=!1)},shaka.ads.MediaTailorAdManager.prototype.getCuePoints=function(){for(var e=[],t=$jscomp.makeIterator(this.adBreaks_),r=t.next();!r.done;r=t.next())for(var n=(r=$jscomp.makeIterator(r.value.ads)).next();!n.done;n=r.next())n=n.value,e.push({start:n.startTimeInSeconds,end:n.startTimeInSeconds+n.durationInSeconds});return e},shaka.ads.MediaTailorAdManager.prototype.requestSessionInfo_=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h,f,m,g=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(y){if(1==y.nextAddress)return r=shaka.net.NetworkingEngine,n=r.RequestType.ADS,a={type:r.AdvancedRequestType.MEDIATAILOR_SESSION_INFO},(i=r.makeRequest([e],r.defaultRetryParameters())).method="POST",t&&(s=JSON.stringify(t),i.body=shaka.util.StringUtils.toUTF8(s)),o=g.networkingEngine_.request(n,i,a),y.setCatchFinallyBlocks(2),y.yield(o.promise,4);if(2!=y.nextAddress){if(l=y.yieldResult,u=shaka.util.StringUtils.fromUTF8(l.data),!(c=JSON.parse(u)).manifestUrl||!c.trackingUrl)throw Error("Insufficient data from MediaTailor.");return d=new goog.Uri(e),p=new goog.Uri(c.trackingUrl),g.trackingUrl_=d.resolve(p).toString(),h=Date.now()/1e3,f=h-g.streamRequestStartTime_,g.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.ADS_LOADED,(new Map).set("loadTime",f))),m=new goog.Uri(c.manifestUrl),g.streamPromise_.resolve(d.resolve(m).toString()),g.streamPromise_=null,y.leaveTryBlock(0)}if(y.enterCatchBlock(),!g.backupUrl_.length)return g.streamPromise_.reject("MediaTailor request returned an error and there was no backup asset uri provided."),g.streamPromise_=null,y.return();shaka.log.warning("MediaTailor request returned an error. Falling back to the backup asset uri."),g.streamPromise_.resolve(g.backupUrl_),g.streamPromise_=null,y.jumpToEnd()}))},shaka.ads.MediaTailorAdManager.prototype.requestTrackingInfo_=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(E){if(1==E.nextAddress)return r=shaka.net.NetworkingEngine,n=r.RequestType.ADS,a={type:r.AdvancedRequestType.MEDIATAILOR_TRACKING_INFO},i=r.makeRequest([e],r.defaultRetryParameters()),s=k.networkingEngine_.request(n,i,a),E.setCatchFinallyBlocks(2),E.yield(s.promise,4);if(2!=E.nextAddress){if(o=E.yieldResult,l=[],u=shaka.util.StringUtils.fromUTF8(o.data),0<(c=JSON.parse(u)).avails.length){if(JSON.stringify(k.adBreaks_)!=JSON.stringify(c.avails)){for(k.adBreaks_=c.avails,d=$jscomp.makeIterator(k.adBreaks_),p=d.next();!p.done;p=d.next())for(h=p.value,f=$jscomp.makeIterator(h.nonLinearAdsList),m=f.next();!m.done;m=f.next())for(g=m.value,y=$jscomp.makeIterator(g.nonLinearAdList),v=y.next();!v.done;v=y.next())_=v.value,k.requestStaticResource_(_);l=k.getCuePoints(),k.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.CUEPOINTS_CHANGED,(new Map).set("cuepoints",l)))}}else k.adBreaks_.length&&k.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.CUEPOINTS_CHANGED,(new Map).set("cuepoints",l))),k.onEnded_(),k.adBreaks_=[];return t&&(k.isLive_||0<l.length)&&k.setupAdBreakListeners_(),E.leaveTryBlock(0)}E.enterCatchBlock(),E.jumpToEnd()}))},shaka.ads.MediaTailorAdManager.prototype.requestStaticResource_=function(e){var t,r,n,a,i,s,o,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){return 1==p.nextAddress?e.staticResource?(t=d.getCacheKeyForNonLinear_(e),d.staticResources_.get(t)?p.return():(r=shaka.net.NetworkingEngine,n=r.RequestType.ADS,a={type:r.AdvancedRequestType.MEDIATAILOR_STATIC_RESOURCE},i=r.makeRequest([e.staticResource],r.defaultRetryParameters()),s=d.networkingEngine_.request(n,i,a),p.setCatchFinallyBlocks(2),d.staticResources_.set(t,[]),p.yield(s.promise,4))):p.return():2!=p.nextAddress?(o=p.yieldResult,l=shaka.util.StringUtils.fromUTF8(o.data),u=JSON.parse(l),c=u.apps,d.staticResources_.set(t,c),p.leaveTryBlock(0)):(p.enterCatchBlock(),d.staticResources_.delete(t),void p.jumpToEnd())}))},shaka.ads.MediaTailorAdManager.prototype.getCacheKeyForNonLinear_=function(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")},shaka.ads.MediaTailorAdManager.prototype.setupAdBreakListeners_=function(){var e=this;this.onTimeupdate_(),this.isLive_||(this.checkForSnapback_(),this.eventManager_.listen(this.video_,"seeked",(function(){e.checkForSnapback_()})),this.eventManager_.listen(this.video_,"ended",(function(){e.onEnded_()}))),this.eventManager_.listen(this.video_,"timeupdate",(function(){e.onTimeupdate_()}))},shaka.ads.MediaTailorAdManager.prototype.checkForSnapback_=function(){var e=this.video_.currentTime;if(0!=e&&null==this.snapForwardTime_){for(var t,r,n=$jscomp.makeIterator(this.adBreaks_),a=n.next();!a.done;a=n.next()){a=a.value;for(var i=$jscomp.makeIterator(a.ads),s=i.next();!s.done;s=i.next())if(s=s.value,r){if(s.startTimeInSeconds<e&&s.startTimeInSeconds>r.startTimeInSeconds+r.durationInSeconds){r=s,t=a;break}}else s.startTimeInSeconds<e&&(r=s,t=a)}t&&r&&!this.playedAds_.includes(r.adId)&&(shaka.log.info("Seeking back to the start of the ad break at "+t.startTimeInSeconds+" and will return to "+e),this.snapForwardTime_=e,this.video_.currentTime=t.startTimeInSeconds)}},shaka.ads.MediaTailorAdManager.prototype.onAdBreakEnded_=function(){var e=this.video_.currentTime;this.snapForwardTime_&&this.snapForwardTime_>e&&(this.video_.currentTime=this.snapForwardTime_),this.snapForwardTime_=null},shaka.ads.MediaTailorAdManager.prototype.onTimeupdate_=function(){if(this.video_.duration&&(this.ad_||this.adBreaks_.length)){var e=this.video_.currentTime,t=!1;if(this.ad_){t=!0,goog.asserts.assert(this.mediaTailorAd_,"Ad should be defined"),this.sendInProgressEvents_(e,this.mediaTailorAd_);var r=this.ad_.getRemainingTime(),n=this.ad_.getDuration();this.ad_.canSkipNow()&&0<r&&0<n&&this.sendTrackingEvent_(shaka.ads.MediaTailorAdManager.SKIP_STATE_CHANGED_),0<n&&(0>=r||r>n)&&this.onEnded_()}this.ad_&&this.ad_.isLinear()||(this.checkLinearAds_(e),this.ad_||this.checkNonLinearAds_(e),t&&!this.ad_&&this.onAdBreakEnded_())}},shaka.ads.MediaTailorAdManager.prototype.sendInProgressEvents_=function(e,t){var r=shaka.ads.MediaTailorAdManager,n=t.startTimeInSeconds+.5*t.durationInSeconds,a=t.startTimeInSeconds+.75*t.durationInSeconds;e>=t.startTimeInSeconds+.25*t.durationInSeconds&&!this.eventsSent.includes(r.FIRSTQUARTILE_)?(this.eventsSent.push(r.FIRSTQUARTILE_),this.sendTrackingEvent_(r.FIRSTQUARTILE_)):e>=n&&!this.eventsSent.includes(r.MIDPOINT_)?(this.eventsSent.push(r.MIDPOINT_),this.sendTrackingEvent_(r.MIDPOINT_)):e>=a&&!this.eventsSent.includes(r.THIRDQUARTILE_)&&(this.eventsSent.push(r.THIRDQUARTILE_),this.sendTrackingEvent_(r.THIRDQUARTILE_))},shaka.ads.MediaTailorAdManager.prototype.checkLinearAds_=function(e){for(var t=shaka.ads.MediaTailorAdManager,r=$jscomp.makeIterator(this.adBreaks_),n=r.next();!n.done&&(n=n.value,!this.ad_||!this.ad_.isLinear());n=r.next())for(var a=0;a<n.ads.length;a++){var i=n.ads[a],s=i.startTimeInSeconds+i.durationInSeconds;if(i.startTimeInSeconds<=e&&s>e){if(this.playedAds_.includes(i.adId)){if(this.video_.ended)continue;return void(this.video_.currentTime=s)}this.onEnded_(),this.mediaTailorAdBreak_=n,this.ad_=new shaka.ads.MediaTailorAd(i,a+1,n.ads.length,!0,this.video_),this.mediaTailorAd_=i,0===a&&this.sendTrackingEvent_(t.BREAK_START_),this.setupCurrentAdListeners_();break}}},shaka.ads.MediaTailorAdManager.prototype.checkNonLinearAds_=function(e){for(var t=shaka.ads.MediaTailorAdManager,r=$jscomp.makeIterator(this.adBreaks_),n=r.next();!n.done&&(n=n.value,!this.ad_);n=r.next())for(var a=0;a<n.nonLinearAdsList.length;a++){var i=n.nonLinearAdsList[a];if(i.nonLinearAdList.length){var s=n.startTimeInSeconds,o=this.getCacheKeyForNonLinear_(i.nonLinearAdList[0]);if(o=this.staticResources_.get(o),s<=e&&o&&o.length){this.onEnded_(),this.displayNonLinearAd_(o),this.mediaTailorAdBreak_=n,this.ad_=new shaka.ads.MediaTailorAd(i,a+1,n.ads.length,!1,this.video_),this.mediaTailorAd_=i,0===a&&this.sendTrackingEvent_(t.BREAK_START_),this.setupCurrentAdListeners_();break}}}},shaka.ads.MediaTailorAdManager.prototype.displayNonLinearAd_=function(e){for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())if((t=t.value).data.source.length){var r=document.createElement("img");r.src=t.data.source[0].url,r.style.top=(t.placeholder.top||0)+"%",r.style.height=100-(t.placeholder.top||0)+"%",r.style.left=(t.placeholder.left||0)+"%",r.style.maxWidth=100-(t.placeholder.left||0)+"%",r.style.objectFit="contain",r.style.position="absolute",this.adContainer_.appendChild(r)}},shaka.ads.MediaTailorAdManager.prototype.onEnded_=function(){if(this.ad_){for(;this.adContainer_.lastChild;)this.adContainer_.removeChild(this.adContainer_.firstChild);this.isLive_||this.playedAds_.push(this.mediaTailorAd_.adId),this.removeCurrentAdListeners_(this.ad_.isSkipped()),this.ad_.getPositionInSequence()===this.ad_.getSequenceLength()&&this.sendTrackingEvent_(shaka.ads.MediaTailorAdManager.BREAK_END_),this.mediaTailorAdBreak_=this.mediaTailorAd_=this.ad_=null}},shaka.ads.MediaTailorAdManager.prototype.setupCurrentAdListeners_=function(){var e=this,t=shaka.ads.MediaTailorAdManager,r=!1;this.video_.paused?r=!0:(this.sendTrackingEvent_(t.IMPRESSION_),this.sendTrackingEvent_(t.START_)),this.adListeners_.push({target:this.video_,type:"volumechange",listener:function(){e.video_.muted&&e.sendTrackingEvent_(t.MUTE_)}}),this.adListeners_.push({target:this.video_,type:"volumechange",listener:function(){e.video_.muted||e.sendTrackingEvent_(t.UNMUTE_)}}),this.adListeners_.push({target:this.video_,type:"play",listener:function(){r?(e.sendTrackingEvent_(t.IMPRESSION_),e.sendTrackingEvent_(t.START_),r=!1):e.sendTrackingEvent_(t.RESUME_)}}),this.adListeners_.push({target:this.video_,type:"pause",listener:function(){e.sendTrackingEvent_(t.PAUSE_)}});for(var n=$jscomp.makeIterator(this.adListeners_),a=n.next();!a.done;a=n.next())a=a.value,this.eventManager_.listen(a.target,a.type,a.listener)},shaka.ads.MediaTailorAdManager.prototype.removeCurrentAdListeners_=function(e){void 0!==e&&e?this.sendTrackingEvent_(shaka.ads.MediaTailorAdManager.SKIPPED_):this.sendTrackingEvent_(shaka.ads.MediaTailorAdManager.COMPLETE_);for(var t=(e=$jscomp.makeIterator(this.adListeners_)).next();!t.done;t=e.next())t=t.value,this.eventManager_.unlisten(t.target,t.type,t.listener);this.adListeners_=[],this.eventsSent=[]},shaka.ads.MediaTailorAdManager.prototype.sendTrackingEvent_=function(e){var t=this.mediaTailorAd_.trackingEvents.find((function(t){return t.eventType==e}));if(t||(t=this.mediaTailorAdBreak_.adBreakTrackingEvents.find((function(t){return t.eventType==e}))),t)for(var r=shaka.net.NetworkingEngine,n=r.RequestType.ADS,a={type:r.AdvancedRequestType.MEDIATAILOR_TRACKING_EVENT},i=(t=$jscomp.makeIterator(t.beaconUrls)).next();!i.done;i=t.next())(i=i.value)&&""!=i&&((i=r.makeRequest([i],r.defaultRetryParameters())).method="POST",this.networkingEngine_.request(n,i,a));switch(e){case shaka.ads.MediaTailorAdManager.IMPRESSION_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_IMPRESSION));break;case shaka.ads.MediaTailorAdManager.START_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STARTED,(new Map).set("ad",this.ad_)));break;case shaka.ads.MediaTailorAdManager.MUTE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_MUTED));break;case shaka.ads.MediaTailorAdManager.UNMUTE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_VOLUME_CHANGED));break;case shaka.ads.MediaTailorAdManager.RESUME_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_RESUMED));break;case shaka.ads.MediaTailorAdManager.PAUSE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_PAUSED));break;case shaka.ads.MediaTailorAdManager.FIRSTQUARTILE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_FIRST_QUARTILE));break;case shaka.ads.MediaTailorAdManager.MIDPOINT_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_MIDPOINT));break;case shaka.ads.MediaTailorAdManager.THIRDQUARTILE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_THIRD_QUARTILE));break;case shaka.ads.MediaTailorAdManager.COMPLETE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_COMPLETE)),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STOPPED));break;case shaka.ads.MediaTailorAdManager.SKIPPED_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_SKIPPED)),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STOPPED));break;case shaka.ads.MediaTailorAdManager.BREAK_START_:this.adContainer_.setAttribute("ad-active","true");break;case shaka.ads.MediaTailorAdManager.BREAK_END_:this.adContainer_.removeAttribute("ad-active");break;case shaka.ads.MediaTailorAdManager.SKIP_STATE_CHANGED_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_SKIP_STATE_CHANGED))}},shaka.ads.MediaTailorAdManager.IMPRESSION_="impression",shaka.ads.MediaTailorAdManager.START_="start",shaka.ads.MediaTailorAdManager.MUTE_="mute",shaka.ads.MediaTailorAdManager.UNMUTE_="unmute",shaka.ads.MediaTailorAdManager.RESUME_="resume",shaka.ads.MediaTailorAdManager.PAUSE_="pause",shaka.ads.MediaTailorAdManager.FIRSTQUARTILE_="firstQuartile",shaka.ads.MediaTailorAdManager.MIDPOINT_="midpoint",shaka.ads.MediaTailorAdManager.THIRDQUARTILE_="thirdQuartile",shaka.ads.MediaTailorAdManager.COMPLETE_="complete",shaka.ads.MediaTailorAdManager.SKIPPED_="skip",shaka.ads.MediaTailorAdManager.BREAK_START_="breakStart",shaka.ads.MediaTailorAdManager.BREAK_END_="breakEnd",shaka.ads.MediaTailorAdManager.SKIP_STATE_CHANGED_="skipStateChanged",shaka.ads.ServerSideAd=function(e,t){this.ad_=e,this.adProgressData_=null,this.video_=t},shaka.ads.ServerSideAd.prototype.setProgressData=function(e){this.adProgressData_=e},shaka.ads.ServerSideAd.prototype.needsSkipUI=function(){return!0},shaka.ads.ServerSideAd.prototype.isClientRendering=function(){return!1},shaka.ads.ServerSideAd.prototype.hasCustomClick=function(){return!0},shaka.ads.ServerSideAd.prototype.isUsingAnotherMediaElement=function(){return!1},shaka.ads.ServerSideAd.prototype.getDuration=function(){return this.adProgressData_?this.adProgressData_.duration:-1},shaka.ads.ServerSideAd.prototype.getMinSuggestedDuration=function(){return this.getDuration()},shaka.ads.ServerSideAd.prototype.getRemainingTime=function(){return this.adProgressData_?this.adProgressData_.duration-this.adProgressData_.currentTime:-1},shaka.ads.ServerSideAd.prototype.isPaused=function(){return this.video_.paused},shaka.ads.ServerSideAd.prototype.isSkippable=function(){return this.ad_.isSkippable()},shaka.ads.ServerSideAd.prototype.getTimeUntilSkippable=function(){var e=this.ad_.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},shaka.ads.ServerSideAd.prototype.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},shaka.ads.ServerSideAd.prototype.skip=function(){this.video_.currentTime+=this.getRemainingTime()},shaka.ads.ServerSideAd.prototype.pause=function(){return this.video_.pause()},shaka.ads.ServerSideAd.prototype.play=function(){return this.video_.play()},shaka.ads.ServerSideAd.prototype.getVolume=function(){return this.video_.volume},shaka.ads.ServerSideAd.prototype.setVolume=function(e){this.video_.volume=e},shaka.ads.ServerSideAd.prototype.isMuted=function(){return this.video_.muted},shaka.ads.ServerSideAd.prototype.isLinear=function(){return!0},shaka.ads.ServerSideAd.prototype.resize=function(e,t){},shaka.ads.ServerSideAd.prototype.setMuted=function(e){this.video_.muted=e},shaka.ads.ServerSideAd.prototype.getSequenceLength=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getTotalAds()},shaka.ads.ServerSideAd.prototype.getPositionInSequence=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getAdPosition()},shaka.ads.ServerSideAd.prototype.getTitle=function(){return this.ad_.getTitle()},shaka.ads.ServerSideAd.prototype.getDescription=function(){return this.ad_.getDescription()},shaka.ads.ServerSideAd.prototype.getVastMediaBitrate=function(){return 0},shaka.ads.ServerSideAd.prototype.getVastMediaHeight=function(){return this.ad_.getVastMediaHeight()},shaka.ads.ServerSideAd.prototype.getVastMediaWidth=function(){return this.ad_.getVastMediaWidth()},shaka.ads.ServerSideAd.prototype.getAdId=function(){return this.ad_.getAdId()},shaka.ads.ServerSideAd.prototype.getCreativeAdId=function(){return this.ad_.getCreativeAdId()},shaka.ads.ServerSideAd.prototype.getAdvertiserName=function(){return this.ad_.getAdvertiserName()},shaka.ads.ServerSideAd.prototype.getMediaUrl=function(){return null},shaka.ads.ServerSideAd.prototype.getTimeOffset=function(){var e=this.ad_.getAdPodInfo();return null==e?0:e.getTimeOffset()},shaka.ads.ServerSideAd.prototype.getPodIndex=function(){var e=this.ad_.getAdPodInfo();return null==e?0:e.getPodIndex()},shaka.ads.ServerSideAd.prototype.release=function(){this.video_=this.adProgressData_=this.ad_=null},goog.exportSymbol("shaka.ads.ServerSideAd",shaka.ads.ServerSideAd),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"release",shaka.ads.ServerSideAd.prototype.release),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getPodIndex",shaka.ads.ServerSideAd.prototype.getPodIndex),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getTimeOffset",shaka.ads.ServerSideAd.prototype.getTimeOffset),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getMediaUrl",shaka.ads.ServerSideAd.prototype.getMediaUrl),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getAdvertiserName",shaka.ads.ServerSideAd.prototype.getAdvertiserName),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getCreativeAdId",shaka.ads.ServerSideAd.prototype.getCreativeAdId),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getAdId",shaka.ads.ServerSideAd.prototype.getAdId),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getVastMediaWidth",shaka.ads.ServerSideAd.prototype.getVastMediaWidth),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getVastMediaHeight",shaka.ads.ServerSideAd.prototype.getVastMediaHeight),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getVastMediaBitrate",shaka.ads.ServerSideAd.prototype.getVastMediaBitrate),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getDescription",shaka.ads.ServerSideAd.prototype.getDescription),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getTitle",shaka.ads.ServerSideAd.prototype.getTitle),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getPositionInSequence",shaka.ads.ServerSideAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getSequenceLength",shaka.ads.ServerSideAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"setMuted",shaka.ads.ServerSideAd.prototype.setMuted),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"resize",shaka.ads.ServerSideAd.prototype.resize),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isLinear",shaka.ads.ServerSideAd.prototype.isLinear),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isMuted",shaka.ads.ServerSideAd.prototype.isMuted),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"setVolume",shaka.ads.ServerSideAd.prototype.setVolume),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getVolume",shaka.ads.ServerSideAd.prototype.getVolume),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"play",shaka.ads.ServerSideAd.prototype.play),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"pause",shaka.ads.ServerSideAd.prototype.pause),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"skip",shaka.ads.ServerSideAd.prototype.skip),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"canSkipNow",shaka.ads.ServerSideAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getTimeUntilSkippable",shaka.ads.ServerSideAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isSkippable",shaka.ads.ServerSideAd.prototype.isSkippable),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isPaused",shaka.ads.ServerSideAd.prototype.isPaused),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getRemainingTime",shaka.ads.ServerSideAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getMinSuggestedDuration",shaka.ads.ServerSideAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getDuration",shaka.ads.ServerSideAd.prototype.getDuration),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isUsingAnotherMediaElement",shaka.ads.ServerSideAd.prototype.isUsingAnotherMediaElement),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"hasCustomClick",shaka.ads.ServerSideAd.prototype.hasCustomClick),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isClientRendering",shaka.ads.ServerSideAd.prototype.isClientRendering),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"needsSkipUI",shaka.ads.ServerSideAd.prototype.needsSkipUI),shaka.ads.ServerSideAdManager=function(e,t,r,n){var a=this;this.adContainer_=e,this.video_=t,this.streamPromise_=this.config_=null,this.streamRequestStartTime_=NaN,this.onEvent_=n,this.isLiveContent_=!1,this.adProgressData_=this.ad_=this.snapForwardTime_=null,this.backupUrl_="",this.currentCuePoints_=[],this.eventManager_=new shaka.util.EventManager,(e=new google.ima.dai.api.UiSettings).setLocale(r),this.streamManager_=new google.ima.dai.api.StreamManager(this.video_,this.adContainer_,e),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.IMA_STREAM_MANAGER_LOADED,(new Map).set("imaStreamManager",this.streamManager_))),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.LOADED,(function(e){shaka.log.info("Ad SS Loaded"),a.onLoaded_(e)})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.ERROR,(function(){shaka.log.info("Ad SS Error"),a.onError_()})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,(function(){shaka.log.info("Ad Break Started")})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.STARTED,(function(e){shaka.log.info("Ad Started"),a.onAdStart_(e)})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,(function(){shaka.log.info("Ad Break Ended"),a.onAdBreakEnded_()})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,(function(e){a.onAdProgress_(e)})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,(function(){shaka.log.info("Ad event: First Quartile"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_FIRST_QUARTILE))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.MIDPOINT,(function(){shaka.log.info("Ad event: Midpoint"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_MIDPOINT))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,(function(){shaka.log.info("Ad event: Third Quartile"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_THIRD_QUARTILE))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.COMPLETE,(function(){shaka.log.info("Ad event: Complete"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_COMPLETE)),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STOPPED)),a.adContainer_.removeAttribute("ad-active"),a.ad_=null})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.SKIPPED,(function(){shaka.log.info("Ad event: Skipped"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_SKIPPED)),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STOPPED))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,(function(e){shaka.log.info("Ad event: Cue points changed"),a.onCuePointsChanged_(e)}))},shaka.ads.ServerSideAdManager.prototype.configure=function(e){this.config_=e},shaka.ads.ServerSideAdManager.prototype.streamRequest=function(e,t){return this.streamPromise_?Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CURRENT_DAI_REQUEST_NOT_FINISHED)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(this.isLiveContent_=!0),this.streamPromise_=new shaka.util.PublicPromise,this.streamManager_.requestStream(e),this.backupUrl_=t||"",this.streamRequestStartTime_=Date.now()/1e3,this.streamPromise_)},shaka.ads.ServerSideAdManager.prototype.replaceAdTagParameters=function(e){this.streamManager_.replaceAdTagParameters(e)},shaka.ads.ServerSideAdManager.prototype.stop=function(){this.backupUrl_="",this.snapForwardTime_=null,this.currentCuePoints_=[]},shaka.ads.ServerSideAdManager.prototype.release=function(){this.stop(),this.eventManager_&&this.eventManager_.release()},shaka.ads.ServerSideAdManager.prototype.onTimedMetadata=function(e,t,r){this.streamManager_.processMetadata(e,t,r)},shaka.ads.ServerSideAdManager.prototype.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.streamManager_.onTimedMetadata(t)}},shaka.ads.ServerSideAdManager.prototype.getCuePoints=function(){return this.currentCuePoints_},shaka.ads.ServerSideAdManager.prototype.checkForSnapback_=function(){var e=this.video_.currentTime;if(0!=e){this.streamManager_.streamTimeForContentTime(e);var t=this.streamManager_.previousCuePointForStreamTime(e);t&&!t.played&&(shaka.log.info("Seeking back to the start of the ad break at "+t.start+" and will return to "+e),this.snapForwardTime_=e,this.video_.currentTime=t.start)}},shaka.ads.ServerSideAdManager.prototype.onAdStart_=function(e){goog.asserts.assert(this.streamManager_,"Should have a stream manager at this point!"),e=e.getAd(),this.ad_=new shaka.ads.ServerSideAd(e,this.video_),this.adProgressData_&&this.ad_.setProgressData(this.adProgressData_),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STARTED,(new Map).set("ad",this.ad_))),this.adContainer_.setAttribute("ad-active","true")},shaka.ads.ServerSideAdManager.prototype.onAdBreakEnded_=function(){this.adContainer_.removeAttribute("ad-active");var e=this.video_.currentTime;this.snapForwardTime_&&this.snapForwardTime_>e&&(this.video_.currentTime=this.snapForwardTime_,this.snapForwardTime_=null)},shaka.ads.ServerSideAdManager.prototype.onLoaded_=function(e){var t=this,r=Date.now()/1e3-this.streamRequestStartTime_;this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.ADS_LOADED,(new Map).set("loadTime",r))),e=e.getStreamData().url,this.streamPromise_.resolve(e),this.streamPromise_=null,this.isLiveContent_||this.eventManager_.listen(this.video_,"seeked",(function(){t.checkForSnapback_()}))},shaka.ads.ServerSideAdManager.prototype.onError_=function(){this.backupUrl_.length?(shaka.log.warning("IMA stream request returned an error. Falling back to the backup asset uri."),this.streamPromise_.resolve(this.backupUrl_)):this.streamPromise_.reject("IMA Stream request returned an error and there was no backup asset uri provided."),this.streamPromise_=null},shaka.ads.ServerSideAdManager.prototype.onAdProgress_=function(e){this.adProgressData_=e.getStreamData().adProgressData,this.ad_&&this.ad_.setProgressData(this.adProgressData_)},shaka.ads.ServerSideAdManager.prototype.onCuePointsChanged_=function(e){var t=e.getStreamData();e=[];for(var r=(t=$jscomp.makeIterator(t.cuepoints)).next();!r.done;r=t.next())r=r.value,e.push({start:r.start,end:r.end});this.currentCuePoints_=e,this.onEvent_(new shaka.util.FakeEvent(shaka.ads.Utils.CUEPOINTS_CHANGED,(new Map).set("cuepoints",e)))},shaka.ads.AdManager=function(){shaka.util.FakeEventTarget.call(this),this.ssAdManager_=this.mtAdManager_=this.csAdManager_=this.interstitialAdManager_=null,this.stats_=new shaka.ads.AdsStats,this.locale_=navigator.language,this.config_=null},$jscomp.inherits(shaka.ads.AdManager,shaka.util.FakeEventTarget),shaka.ads.AdManager.prototype.setLocale=function(e){this.locale_=e},shaka.ads.AdManager.prototype.configure=function(e){this.config_=e,this.interstitialAdManager_&&this.interstitialAdManager_.configure(this.config_),this.csAdManager_&&this.csAdManager_.configure(this.config_),this.ssAdManager_&&this.ssAdManager_.configure(this.config_)},shaka.ads.AdManager.prototype.initInterstitial=function(e,t,r){var n=this;e||shaka.log.info("Initializing interstitials without ad container"),this.interstitialAdManager_&&this.interstitialAdManager_.release(),this.interstitialAdManager_=new shaka.ads.InterstitialAdManager(e,t,r,(function(e){return n.processAndDispatchEvent_(e)})),goog.asserts.assert(this.config_,"Config must not be null!"),this.interstitialAdManager_.configure(this.config_)},shaka.ads.AdManager.prototype.initClientSide=function(e,t,r){var n=this;if(!window.google||!google.ima||!google.ima.AdsLoader)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CS_IMA_SDK_MISSING);this.csAdManager_&&this.csAdManager_.release(),this.csAdManager_=new shaka.ads.ClientSideAdManager(e,t,this.locale_,r,(function(e){return n.processAndDispatchEvent_(e)})),goog.asserts.assert(this.config_,"Config must not be null!"),this.csAdManager_.configure(this.config_)},shaka.ads.AdManager.prototype.release=function(){this.interstitialAdManager_&&(this.interstitialAdManager_.release(),this.interstitialAdManager_=null),this.csAdManager_&&(this.csAdManager_.release(),this.csAdManager_=null),this.mtAdManager_&&(this.mtAdManager_.release(),this.mtAdManager_=null),this.ssAdManager_&&(this.ssAdManager_.release(),this.ssAdManager_=null),shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.ads.AdManager.prototype.onAssetUnload=function(){this.interstitialAdManager_&&this.interstitialAdManager_.stop(),this.csAdManager_&&this.csAdManager_.stop(),this.mtAdManager_&&this.mtAdManager_.stop(),this.ssAdManager_&&this.ssAdManager_.stop(),this.dispatchEvent(new shaka.util.FakeEvent(shaka.ads.Utils.AD_STOPPED)),this.dispatchEvent(new shaka.util.FakeEvent(shaka.ads.Utils.AD_CONTENT_ATTACH_REQUESTED)),this.stats_=new shaka.ads.AdsStats},shaka.ads.AdManager.prototype.requestClientSideAds=function(e){if(!this.csAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CS_AD_MANAGER_NOT_INITIALIZED);this.csAdManager_.requestAds(e)},shaka.ads.AdManager.prototype.updateClientSideAdsRenderingSettings=function(e){if(!this.csAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CS_AD_MANAGER_NOT_INITIALIZED);this.csAdManager_.updateAdsRenderingSettings(e)},shaka.ads.AdManager.prototype.initMediaTailor=function(e,t,r){var n=this;this.mtAdManager_&&this.mtAdManager_.release(),this.mtAdManager_=new shaka.ads.MediaTailorAdManager(e,t,r,(function(e){return n.processAndDispatchEvent_(e)}))},shaka.ads.AdManager.prototype.requestMediaTailorStream=function(e,t,r){if(r=void 0===r?"":r,!this.mtAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.MT_AD_MANAGER_NOT_INITIALIZED);return this.mtAdManager_.streamRequest(e,t,r)},shaka.ads.AdManager.prototype.addMediaTailorTrackingUrl=function(e){if(!this.mtAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.MT_AD_MANAGER_NOT_INITIALIZED);this.mtAdManager_.addTrackingUrl(e)},shaka.ads.AdManager.prototype.initServerSide=function(e,t){var r=this;if(!window.google||!google.ima||!google.ima.dai)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_IMA_SDK_MISSING);this.ssAdManager_&&this.ssAdManager_.release(),this.ssAdManager_=new shaka.ads.ServerSideAdManager(e,t,this.locale_,(function(e){return r.processAndDispatchEvent_(e)})),goog.asserts.assert(this.config_,"Config must not be null!"),this.ssAdManager_.configure(this.config_)},shaka.ads.AdManager.prototype.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.ssAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_AD_MANAGER_NOT_INITIALIZED);e.adTagParameters||(e.adTagParameters={});var r=e.adTagParameters;return(r.mpt||r.mpv)&&shaka.log.alwaysWarn('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv=shaka.Player.version,this.ssAdManager_.streamRequest(e,t)},shaka.ads.AdManager.prototype.replaceServerSideAdTagParameters=function(e){if(!this.ssAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_AD_MANAGER_NOT_INITIALIZED);(e.mpt||e.mpv)&&shaka.log.alwaysWarn('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overridden.'),e.mpt="Shaka Player",e.mpv=shaka.Player.version,this.ssAdManager_.replaceAdTagParameters(e)},shaka.ads.AdManager.prototype.getServerSideCuePoints=function(){return shaka.Deprecate.deprecateFeature(5,"AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},shaka.ads.AdManager.prototype.getCuePoints=function(){var e=[];return this.ssAdManager_&&(e=e.concat(this.ssAdManager_.getCuePoints())),this.mtAdManager_&&(e=e.concat(this.mtAdManager_.getCuePoints())),e},shaka.ads.AdManager.prototype.getStats=function(){return this.stats_.getBlob()},shaka.ads.AdManager.prototype.onManifestUpdated=function(e){this.mtAdManager_&&this.mtAdManager_.onManifestUpdated(e)},shaka.ads.AdManager.prototype.onDashTimedMetadata=function(e){this.ssAdManager_&&"urn:google:dai:2018"==e.schemeIdUri&&this.ssAdManager_.onTimedMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},shaka.ads.AdManager.prototype.onHlsTimedMetadata=function(e,t){this.ssAdManager_&&this.ssAdManager_.onTimedMetadata("ID3",e.data,t)},shaka.ads.AdManager.prototype.onCueMetadataChange=function(e){this.ssAdManager_&&this.ssAdManager_.onCueMetadataChange(e)},shaka.ads.AdManager.prototype.onHLSInterstitialMetadata=function(e,t,r){this.config_&&this.config_.disableHLSInterstitial||(this.interstitialAdManager_||this.initInterstitial(null,e,t),this.interstitialAdManager_&&this.interstitialAdManager_.addMetadata(r))},shaka.ads.AdManager.prototype.onDASHInterstitialMetadata=function(e,t,r){if(!this.config_||!this.config_.disableDASHInterstitial){var n=r.schemeIdUri;"urn:mpeg:dash:event:alternativeMPD:insert:2025"==n||"urn:mpeg:dash:event:alternativeMPD:replace:2025"==n?(this.interstitialAdManager_||this.initInterstitial(null,e,t),this.interstitialAdManager_&&this.interstitialAdManager_.addRegion(r)):("urn:mpeg:dash:event:2012"==n||"urn:scte:dash:scte214-events"==n)&&r.eventNode&&shaka.util.TXml.findChild(r.eventNode,"OverlayEvent")&&(this.interstitialAdManager_||this.initInterstitial(null,e,t),this.interstitialAdManager_&&this.interstitialAdManager_.addOverlayRegion(r))}},shaka.ads.AdManager.prototype.addCustomInterstitial=function(e){if(!this.interstitialAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED);this.interstitialAdManager_.addInterstitials([e])},shaka.ads.AdManager.prototype.addAdUrlInterstitial=function(e){if(!this.interstitialAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED);return this.interstitialAdManager_.addAdUrlInterstitial(e)},shaka.ads.AdManager.prototype.getInterstitialPlayer=function(){if(!this.interstitialAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.INTERSTITIAL_AD_MANAGER_NOT_INITIALIZED);return this.interstitialAdManager_.getPlayer()},shaka.ads.AdManager.prototype.processAndDispatchEvent_=function(e){if(e&&e.type)switch(e.type){case shaka.ads.Utils.ADS_LOADED:this.stats_.addLoadTime(e.loadTime);break;case shaka.ads.Utils.AD_STARTED:this.stats_.incrementStarted();var t=e.ad;t&&!t.isLinear()&&this.stats_.incrementOverlayAds();break;case shaka.ads.Utils.AD_COMPLETE:this.stats_.incrementPlayedCompletely();break;case shaka.ads.Utils.AD_SKIPPED:this.stats_.incrementSkipped();break;case shaka.ads.Utils.AD_ERROR:this.stats_.incrementErrors()}this.dispatchEvent(e)},goog.exportSymbol("shaka.ads.AdManager",shaka.ads.AdManager),goog.exportProperty(shaka.ads.AdManager.prototype,"getInterstitialPlayer",shaka.ads.AdManager.prototype.getInterstitialPlayer),goog.exportProperty(shaka.ads.AdManager.prototype,"addAdUrlInterstitial",shaka.ads.AdManager.prototype.addAdUrlInterstitial),goog.exportProperty(shaka.ads.AdManager.prototype,"addCustomInterstitial",shaka.ads.AdManager.prototype.addCustomInterstitial),goog.exportProperty(shaka.ads.AdManager.prototype,"onDASHInterstitialMetadata",shaka.ads.AdManager.prototype.onDASHInterstitialMetadata),goog.exportProperty(shaka.ads.AdManager.prototype,"onHLSInterstitialMetadata",shaka.ads.AdManager.prototype.onHLSInterstitialMetadata),goog.exportProperty(shaka.ads.AdManager.prototype,"onCueMetadataChange",shaka.ads.AdManager.prototype.onCueMetadataChange),goog.exportProperty(shaka.ads.AdManager.prototype,"onHlsTimedMetadata",shaka.ads.AdManager.prototype.onHlsTimedMetadata),goog.exportProperty(shaka.ads.AdManager.prototype,"onDashTimedMetadata",shaka.ads.AdManager.prototype.onDashTimedMetadata),goog.exportProperty(shaka.ads.AdManager.prototype,"onManifestUpdated",shaka.ads.AdManager.prototype.onManifestUpdated),goog.exportProperty(shaka.ads.AdManager.prototype,"getStats",shaka.ads.AdManager.prototype.getStats),goog.exportProperty(shaka.ads.AdManager.prototype,"getCuePoints",shaka.ads.AdManager.prototype.getCuePoints),goog.exportProperty(shaka.ads.AdManager.prototype,"getServerSideCuePoints",shaka.ads.AdManager.prototype.getServerSideCuePoints),goog.exportProperty(shaka.ads.AdManager.prototype,"replaceServerSideAdTagParameters",shaka.ads.AdManager.prototype.replaceServerSideAdTagParameters),goog.exportProperty(shaka.ads.AdManager.prototype,"requestServerSideStream",shaka.ads.AdManager.prototype.requestServerSideStream),goog.exportProperty(shaka.ads.AdManager.prototype,"initServerSide",shaka.ads.AdManager.prototype.initServerSide),goog.exportProperty(shaka.ads.AdManager.prototype,"addMediaTailorTrackingUrl",shaka.ads.AdManager.prototype.addMediaTailorTrackingUrl),goog.exportProperty(shaka.ads.AdManager.prototype,"requestMediaTailorStream",shaka.ads.AdManager.prototype.requestMediaTailorStream),goog.exportProperty(shaka.ads.AdManager.prototype,"initMediaTailor",shaka.ads.AdManager.prototype.initMediaTailor),goog.exportProperty(shaka.ads.AdManager.prototype,"updateClientSideAdsRenderingSettings",shaka.ads.AdManager.prototype.updateClientSideAdsRenderingSettings),goog.exportProperty(shaka.ads.AdManager.prototype,"requestClientSideAds",shaka.ads.AdManager.prototype.requestClientSideAds),goog.exportProperty(shaka.ads.AdManager.prototype,"onAssetUnload",shaka.ads.AdManager.prototype.onAssetUnload),goog.exportProperty(shaka.ads.AdManager.prototype,"release",shaka.ads.AdManager.prototype.release),goog.exportProperty(shaka.ads.AdManager.prototype,"initClientSide",shaka.ads.AdManager.prototype.initClientSide),goog.exportProperty(shaka.ads.AdManager.prototype,"initInterstitial",shaka.ads.AdManager.prototype.initInterstitial),goog.exportProperty(shaka.ads.AdManager.prototype,"configure",shaka.ads.AdManager.prototype.configure),goog.exportProperty(shaka.ads.AdManager.prototype,"setLocale",shaka.ads.AdManager.prototype.setLocale),shaka.ads.AdManager.ADS_LOADED="ads-loaded",goog.exportProperty(shaka.ads.AdManager,"ADS_LOADED",shaka.ads.AdManager.ADS_LOADED),shaka.ads.AdManager.AD_STARTED="ad-started",goog.exportProperty(shaka.ads.AdManager,"AD_STARTED",shaka.ads.AdManager.AD_STARTED),shaka.ads.AdManager.AD_FIRST_QUARTILE="ad-first-quartile",goog.exportProperty(shaka.ads.AdManager,"AD_FIRST_QUARTILE",shaka.ads.AdManager.AD_FIRST_QUARTILE),shaka.ads.AdManager.AD_MIDPOINT="ad-midpoint",goog.exportProperty(shaka.ads.AdManager,"AD_MIDPOINT",shaka.ads.AdManager.AD_MIDPOINT),shaka.ads.AdManager.AD_THIRD_QUARTILE="ad-third-quartile",goog.exportProperty(shaka.ads.AdManager,"AD_THIRD_QUARTILE",shaka.ads.AdManager.AD_THIRD_QUARTILE),shaka.ads.AdManager.AD_COMPLETE="ad-complete",goog.exportProperty(shaka.ads.AdManager,"AD_COMPLETE",shaka.ads.AdManager.AD_COMPLETE),shaka.ads.AdManager.AD_STOPPED="ad-stopped",goog.exportProperty(shaka.ads.AdManager,"AD_STOPPED",shaka.ads.AdManager.AD_STOPPED),shaka.ads.AdManager.AD_SKIPPED="ad-skipped",goog.exportProperty(shaka.ads.AdManager,"AD_SKIPPED",shaka.ads.AdManager.AD_SKIPPED),shaka.ads.AdManager.AD_VOLUME_CHANGED="ad-volume-changed",goog.exportProperty(shaka.ads.AdManager,"AD_VOLUME_CHANGED",shaka.ads.AdManager.AD_VOLUME_CHANGED),shaka.ads.AdManager.AD_MUTED="ad-muted",goog.exportProperty(shaka.ads.AdManager,"AD_MUTED",shaka.ads.AdManager.AD_MUTED),shaka.ads.AdManager.AD_PAUSED="ad-paused",goog.exportProperty(shaka.ads.AdManager,"AD_PAUSED",shaka.ads.AdManager.AD_PAUSED),shaka.ads.AdManager.AD_RESUMED="ad-resumed",goog.exportProperty(shaka.ads.AdManager,"AD_RESUMED",shaka.ads.AdManager.AD_RESUMED),shaka.ads.AdManager.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",goog.exportProperty(shaka.ads.AdManager,"AD_SKIP_STATE_CHANGED",shaka.ads.AdManager.AD_SKIP_STATE_CHANGED),shaka.ads.AdManager.CUEPOINTS_CHANGED="ad-cue-points-changed",goog.exportProperty(shaka.ads.AdManager,"CUEPOINTS_CHANGED",shaka.ads.AdManager.CUEPOINTS_CHANGED),shaka.ads.AdManager.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",goog.exportProperty(shaka.ads.AdManager,"IMA_AD_MANAGER_LOADED",shaka.ads.AdManager.IMA_AD_MANAGER_LOADED),shaka.ads.AdManager.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",goog.exportProperty(shaka.ads.AdManager,"IMA_STREAM_MANAGER_LOADED",shaka.ads.AdManager.IMA_STREAM_MANAGER_LOADED),shaka.ads.AdManager.AD_CLICKED="ad-clicked",goog.exportProperty(shaka.ads.AdManager,"AD_CLICKED",shaka.ads.AdManager.AD_CLICKED),shaka.ads.AdManager.AD_PROGRESS="ad-progress",goog.exportProperty(shaka.ads.AdManager,"AD_PROGRESS",shaka.ads.AdManager.AD_PROGRESS),shaka.ads.AdManager.AD_BUFFERING="ad-buffering",goog.exportProperty(shaka.ads.AdManager,"AD_BUFFERING",shaka.ads.AdManager.AD_BUFFERING),shaka.ads.AdManager.AD_IMPRESSION="ad-impression",goog.exportProperty(shaka.ads.AdManager,"AD_IMPRESSION",shaka.ads.AdManager.AD_IMPRESSION),shaka.ads.AdManager.AD_DURATION_CHANGED="ad-duration-changed",goog.exportProperty(shaka.ads.AdManager,"AD_DURATION_CHANGED",shaka.ads.AdManager.AD_DURATION_CHANGED),shaka.ads.AdManager.AD_CLOSED="ad-closed",goog.exportProperty(shaka.ads.AdManager,"AD_CLOSED",shaka.ads.AdManager.AD_CLOSED),shaka.ads.AdManager.AD_LOADED="ad-loaded",goog.exportProperty(shaka.ads.AdManager,"AD_LOADED",shaka.ads.AdManager.AD_LOADED),shaka.ads.AdManager.ALL_ADS_COMPLETED="all-ads-completed",goog.exportProperty(shaka.ads.AdManager,"ALL_ADS_COMPLETED",shaka.ads.AdManager.ALL_ADS_COMPLETED),shaka.ads.AdManager.AD_LINEAR_CHANGED="ad-linear-changed",goog.exportProperty(shaka.ads.AdManager,"AD_LINEAR_CHANGED",shaka.ads.AdManager.AD_LINEAR_CHANGED),shaka.ads.AdManager.AD_METADATA="ad-metadata",goog.exportProperty(shaka.ads.AdManager,"AD_METADATA",shaka.ads.AdManager.AD_METADATA),shaka.ads.AdManager.AD_RECOVERABLE_ERROR="ad-recoverable-error",goog.exportProperty(shaka.ads.AdManager,"AD_RECOVERABLE_ERROR",shaka.ads.AdManager.AD_RECOVERABLE_ERROR),shaka.ads.AdManager.AD_ERROR="ad-error",goog.exportProperty(shaka.ads.AdManager,"AD_ERROR",shaka.ads.AdManager.AD_ERROR),shaka.ads.AdManager.AD_BREAK_READY="ad-break-ready",goog.exportProperty(shaka.ads.AdManager,"AD_BREAK_READY",shaka.ads.AdManager.AD_BREAK_READY),shaka.ads.AdManager.AD_INTERACTION="ad-interaction",goog.exportProperty(shaka.ads.AdManager,"AD_INTERACTION",shaka.ads.AdManager.AD_INTERACTION),shaka.ads.AdManager.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",goog.exportProperty(shaka.ads.AdManager,"AD_CONTENT_PAUSE_REQUESTED",shaka.ads.AdManager.AD_CONTENT_PAUSE_REQUESTED),shaka.ads.AdManager.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",goog.exportProperty(shaka.ads.AdManager,"AD_CONTENT_RESUME_REQUESTED",shaka.ads.AdManager.AD_CONTENT_RESUME_REQUESTED),shaka.ads.AdManager.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",goog.exportProperty(shaka.ads.AdManager,"AD_CONTENT_ATTACH_REQUESTED",shaka.ads.AdManager.AD_CONTENT_ATTACH_REQUESTED),shaka.Player.setAdManagerFactory((function(){return new shaka.ads.AdManager})),shaka.cast={},shaka.cast.CastUtils=function(){},shaka.cast.CastUtils.serialize=function(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof shaka.util.FakeEvent){for(var r in e={},t){var n=t[r];n&&"object"==typeof n?"detail"==r&&(e[r]=n):r in Event||(e[r]=n)}return e}return t instanceof Error?shaka.cast.CastUtils.unpackError_(t):t instanceof TimeRanges?shaka.cast.CastUtils.unpackTimeRanges_(t):ArrayBuffer.isView(t)&&1===t.BYTES_PER_ELEMENT?shaka.cast.CastUtils.unpackUint8Array_(t):"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t}}))},shaka.cast.CastUtils.deserialize=function(e){return JSON.parse(e,(function(e,t){return"NaN"==t?NaN:"-Infinity"==t?-1/0:"Infinity"==t?1/0:t&&"object"==typeof t&&"TimeRanges"==t.__type__?shaka.cast.CastUtils.simulateTimeRanges_(t):t&&"object"==typeof t&&"Uint8Array"==t.__type__?shaka.cast.CastUtils.makeUint8Array_(t):t&&"object"==typeof t&&"Error"==t.__type__?shaka.cast.CastUtils.makeError_(t):t}))},shaka.cast.CastUtils.unpackTimeRanges_=function(e){for(var t={__type__:"TimeRanges",length:e.length,start:[],end:[]},r=(e=$jscomp.makeIterator(shaka.media.TimeRangesUtils.getBufferedInfo(e))).next();!r.done;r=e.next()){var n=(r=r.value).end;t.start.push(r.start),t.end.push(n)}return t},shaka.cast.CastUtils.simulateTimeRanges_=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}},shaka.cast.CastUtils.unpackUint8Array_=function(e){return{__type__:"Uint8Array",entries:Array.from(e)}},shaka.cast.CastUtils.makeUint8Array_=function(e){return new Uint8Array(e.entries)},shaka.cast.CastUtils.unpackError_=function(e){var t=new Set(["name","message","stack"]);for(r in e)t.add(r);for(var r=$jscomp.makeIterator(Object.getOwnPropertyNames(e)),n=r.next();!n.done;n=r.next())t.add(n.value);for(r={},n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next())r[n=n.value]=e[n];return{__type__:"Error",contents:r}},shaka.cast.CastUtils.makeError_=function(e){e=e.contents;var t,r=Error(e.message);for(t in e)r[t]=e[t];return r},shaka.cast.CastUtils.VideoEvents="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),shaka.cast.CastUtils.VideoAttributes="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),shaka.cast.CastUtils.VideoInitStateAttributes=["loop","playbackRate"],shaka.cast.CastUtils.VideoVoidMethods=["pause","play"],shaka.cast.CastUtils.PlayerGetterMethods=(new Map).set("getAssetUri",2).set("getAudioLanguages",4).set("getAudioLanguagesAndRoles",4).set("getBufferFullness",1).set("getBufferedInfo",2).set("getExpiration",2).set("getKeyStatuses",2).set("getPlaybackRate",2).set("getTextLanguages",4).set("getTextLanguagesAndRoles",4).set("getImageTracks",2).set("getThumbnails",2).set("isAudioOnly",10).set("isBuffering",1).set("isInProgress",1).set("isLive",10).set("isTextTrackVisible",1).set("keySystem",10).set("seekRange",1).set("getLoadMode",10).set("getManifestType",10).set("isFullyLoaded",1).set("isEnded",1),shaka.cast.CastUtils.LargePlayerGetterMethods=(new Map).set("getConfiguration",4).set("getConfigurationForLowLatency",4).set("getStats",5).set("getAudioTracks",2).set("getTextTracks",2).set("getVariantTracks",2),shaka.cast.CastUtils.PlayerGetterMethodsThatRequireLive=(new Map).set("getPlayheadTimeAsDate",1).set("getPresentationStartTimeAsDate",20).set("getSegmentAvailabilityDuration",20),shaka.cast.CastUtils.PlayerInitState=[["getConfiguration","configure","getConfigurationForLowLatency","configurationForLowLatency"]],shaka.cast.CastUtils.PlayerInitAfterLoadState=[["isTextTrackVisible","setTextTrackVisibility"]],shaka.cast.CastUtils.PlayerVoidMethods="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure configurationForLowLatency getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectAudioTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),shaka.cast.CastUtils.PlayerPromiseMethods=["attach","attachCanvas","detach","load","unload"],shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE="urn:x-cast:com.google.shaka.v2",shaka.cast.CastUtils.GENERIC_MESSAGE_NAMESPACE="urn:x-cast:com.google.cast.media",shaka.cast.CastSender=function(e,t,r,n,a,i,s){var o=this;this.receiverAppId_=e,this.androidReceiverCompatible_=s,this.statusChangeTimer_=new shaka.util.Timer(t),this.onFirstCastStateUpdate_=r,this.hasJoinedExistingSession_=!1,this.onRemoteEvent_=n,this.onResumeLocal_=a,this.onInitStateRequired_=i,this.isCasting_=this.apiReady_=!1,this.receiverName_="",this.appData_=null,this.onConnectionStatusChangedBound_=function(){return o.onConnectionStatusChanged_()},this.onMessageReceivedBound_=function(e,t){return o.onMessageReceived_(e,t)},this.cachedProperties_={video:{},player:{}},this.nextAsyncCallId_=0,this.asyncCallPromises_=new Map,this.castPromise_=null,shaka.cast.CastSender.instances_.add(this)},shaka.cast.CastSender.prototype.destroy=function(){return shaka.cast.CastSender.instances_.delete(this),this.rejectAllPromises_(),shaka.cast.CastSender.session_&&this.removeListeners_(),this.statusChangeTimer_&&(this.statusChangeTimer_.stop(),this.statusChangeTimer_=null),this.onResumeLocal_=this.onRemoteEvent_=null,this.isCasting_=this.apiReady_=!1,this.onMessageReceivedBound_=this.onConnectionStatusChangedBound_=this.castPromise_=this.asyncCallPromises_=this.cachedProperties_=this.appData_=null,Promise.resolve()},shaka.cast.CastSender.prototype.apiReady=function(){return this.apiReady_},shaka.cast.CastSender.prototype.hasReceivers=function(){return shaka.cast.CastSender.hasReceivers_},shaka.cast.CastSender.prototype.isCasting=function(){return this.isCasting_},shaka.cast.CastSender.prototype.receiverName=function(){return this.receiverName_},shaka.cast.CastSender.prototype.hasRemoteProperties=function(){return 0!=Object.keys(this.cachedProperties_.video).length},shaka.cast.CastSender.prototype.init=function(){var e=shaka.cast.CastSender;if(this.receiverAppId_.length)if(window.chrome&&chrome.cast&&chrome.cast.isAvailable){this.apiReady_=!0,this.statusChangeTimer_.tickNow();var t=new chrome.cast.SessionRequest(this.receiverAppId_,[],null,this.androidReceiverCompatible_,null);t=new chrome.cast.ApiConfig(t,(function(t){return e.onExistingSessionJoined_(t)}),(function(t){return e.onReceiverStatusChanged_(t)}),"origin_scoped"),chrome.cast.initialize(t,(function(){shaka.log.debug("CastSender: init")}),(function(e){shaka.log.error("CastSender: init error",e)})),shaka.cast.CastSender.hasReceivers_&&this.statusChangeTimer_.tickAfter(shaka.cast.CastSender.STATUS_DELAY),(t=shaka.cast.CastSender.session_)&&t.status!=chrome.cast.SessionStatus.STOPPED?(shaka.log.debug("CastSender: re-using existing connection"),this.onExistingSessionJoined_(t)):shaka.cast.CastSender.session_=null}else window.__onGCastApiAvailable!==e.onGCastApiAvailable_&&(e.__onGCastApiAvailable_=window.__onGCastApiAvailable||null,window.__onGCastApiAvailable=e.onGCastApiAvailable_)},shaka.cast.CastSender.prototype.setAppData=function(e){this.appData_=e,this.isCasting_&&this.sendMessage_({type:"appData",appData:this.appData_})},shaka.cast.CastSender.prototype.cast=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(!e.apiReady_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.CAST,shaka.util.Error.Code.CAST_API_UNAVAILABLE);if(!shaka.cast.CastSender.hasReceivers_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.CAST,shaka.util.Error.Code.NO_CAST_RECEIVERS);if(e.isCasting_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.CAST,shaka.util.Error.Code.ALREADY_CASTING);return e.castPromise_=new shaka.util.PublicPromise,chrome.cast.requestSession((function(t){return e.onSessionInitiated_(t)}),(function(t){return e.onConnectionError_(t)})),t.yield(e.castPromise_,0)}))},shaka.cast.CastSender.prototype.showDisconnectDialog=function(){var e=this;this.isCasting_&&chrome.cast.requestSession((function(t){return e.onSessionInitiated_(t)}),(function(t){return e.onConnectionError_(t)}))},shaka.cast.CastSender.prototype.forceDisconnect=function(){if(this.isCasting_){if(this.rejectAllPromises_(),shaka.cast.CastSender.session_){this.removeListeners_();try{shaka.cast.CastSender.session_.stop((function(){}),(function(){}))}catch(e){}shaka.cast.CastSender.session_=null}this.onConnectionStatusChanged_()}},shaka.cast.CastSender.prototype.get=function(e,t){var r=this;goog.asserts.assert("video"==e||"player"==e,"Unexpected target name");var n=shaka.cast.CastUtils;if("video"==e){if(n.VideoVoidMethods.includes(t))return function(){var n=$jscomp.getRestArguments.apply(0,arguments);return r.remoteCall_.apply(r,[e,t].concat($jscomp.arrayFromIterable(n)))}}else if("player"==e){if(n.PlayerGetterMethodsThatRequireLive.has(t)){var a=this.get("player","isLive")();if(goog.asserts.assert(a,t+" should be called on a live stream!"),!a)return function(){}}if(n.PlayerVoidMethods.includes(t))return function(){var n=$jscomp.getRestArguments.apply(0,arguments);return r.remoteCall_.apply(r,[e,t].concat($jscomp.arrayFromIterable(n)))};if(n.PlayerPromiseMethods.includes(t))return function(){var n=$jscomp.getRestArguments.apply(0,arguments);return r.remoteAsyncCall_.apply(r,[e,t].concat($jscomp.arrayFromIterable(n)))};if(n.PlayerGetterMethods.has(t)||n.LargePlayerGetterMethods.has(t))return function(){return r.propertyGetter_(e,t)}}return this.propertyGetter_(e,t)},shaka.cast.CastSender.prototype.set=function(e,t,r){goog.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]=r,this.sendMessage_({type:"set",targetName:e,property:t,value:r})},shaka.cast.CastSender.prototype.onSessionInitiated_=function(e){shaka.log.debug("CastSender: onSessionInitiated");var t=this.onInitStateRequired_();this.onSessionCreated_(e),this.sendMessage_({type:"init",initState:t,appData:this.appData_}),this.castPromise_.resolve()},shaka.cast.CastSender.prototype.onConnectionError_=function(e){var t=shaka.util.Error.Code.UNEXPECTED_CAST_ERROR;switch(e.code){case"cancel":t=shaka.util.Error.Code.CAST_CANCELED_BY_USER;break;case"timeout":t=shaka.util.Error.Code.CAST_CONNECTION_TIMED_OUT;break;case"receiver_unavailable":t=shaka.util.Error.Code.CAST_RECEIVER_APP_UNAVAILABLE}this.castPromise_.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.CAST,t,e))},shaka.cast.CastSender.prototype.propertyGetter_=function(e,t){return goog.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]},shaka.cast.CastSender.prototype.remoteCall_=function(e,t){var r=$jscomp.getRestArguments.apply(2,arguments);goog.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.sendMessage_({type:"call",targetName:e,methodName:t,args:r})},shaka.cast.CastSender.prototype.remoteAsyncCall_=function(e,t){var r=$jscomp.getRestArguments.apply(2,arguments);goog.asserts.assert("video"==e||"player"==e,"Unexpected target name");var n=new shaka.util.PublicPromise,a=this.nextAsyncCallId_.toString();this.nextAsyncCallId_++,this.asyncCallPromises_.set(a,n);try{this.sendMessage_({type:"asyncCall",targetName:e,methodName:t,args:r,id:a})}catch(e){n.reject(e)}return n},shaka.cast.CastSender.onExistingSessionJoined_=function(e){for(var t=$jscomp.makeIterator(shaka.cast.CastSender.instances_),r=t.next();!r.done;r=t.next())r.value.onExistingSessionJoined_(e)},shaka.cast.CastSender.prototype.onExistingSessionJoined_=function(e){shaka.log.debug("CastSender: onExistingSessionJoined"),this.castPromise_=new shaka.util.PublicPromise,this.hasJoinedExistingSession_=!0,this.onSessionInitiated_(e)},shaka.cast.CastSender.onReceiverStatusChanged_=function(e){for(var t=$jscomp.makeIterator(shaka.cast.CastSender.instances_),r=t.next();!r.done;r=t.next())r.value.onReceiverStatusChanged_(e)},shaka.cast.CastSender.prototype.onReceiverStatusChanged_=function(e){shaka.log.debug("CastSender: receiver status",e),shaka.cast.CastSender.hasReceivers_="available"==e,this.statusChangeTimer_.tickNow()},shaka.cast.CastSender.prototype.onSessionCreated_=function(e){shaka.cast.CastSender.session_=e,e.addUpdateListener(this.onConnectionStatusChangedBound_),e.addMessageListener(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_),this.onConnectionStatusChanged_()},shaka.cast.CastSender.prototype.removeListeners_=function(){var e=shaka.cast.CastSender.session_;e.removeUpdateListener(this.onConnectionStatusChangedBound_),e.removeMessageListener(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_)},shaka.cast.CastSender.prototype.onConnectionStatusChanged_=function(){var e=!!shaka.cast.CastSender.session_&&"connected"==shaka.cast.CastSender.session_.status;if(shaka.log.debug("CastSender: connection status",e),this.isCasting_&&!e){for(var t in this.onResumeLocal_(),this.cachedProperties_)this.cachedProperties_[t]={};this.rejectAllPromises_()}this.receiverName_=(this.isCasting_=e)?shaka.cast.CastSender.session_.receiver.friendlyName:"",this.statusChangeTimer_.tickNow()},shaka.cast.CastSender.prototype.rejectAllPromises_=function(){if(this.asyncCallPromises_)for(var e=$jscomp.makeIterator(this.asyncCallPromises_.keys()),t=e.next();!t.done;t=e.next()){t=t.value;var r=this.asyncCallPromises_.get(t);this.asyncCallPromises_.delete(t),r.reject(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.LOAD_INTERRUPTED))}},shaka.cast.CastSender.prototype.onMessageReceived_=function(e,t){switch(e=shaka.cast.CastUtils.deserialize(t),shaka.log.v2("CastSender: message",e),e.type){case"event":var r=e.targetName,n=shaka.util.FakeEvent.fromRealEvent(e.event);this.onRemoteEvent_(r,n);break;case"update":for(n in r=e.update)for(var a in e=this.cachedProperties_[n]||{},r[n])e[a]=r[n][a];this.hasJoinedExistingSession_&&(this.onFirstCastStateUpdate_(),this.hasJoinedExistingSession_=!1);break;case"asyncComplete":if(n=e.id,a=e.error,e=this.asyncCallPromises_.get(n),this.asyncCallPromises_.delete(n),goog.asserts.assert(e,"Unexpected async id"),e)if(a){for(r in n=new shaka.util.Error(a.severity,a.category,a.code),a)n[r]=a[r];e.reject(n)}else e.resolve()}},shaka.cast.CastSender.prototype.sendMessage_=function(e){e=shaka.cast.CastUtils.serialize(e);var t=shaka.cast.CastSender.session_;try{t.sendMessage(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,e,(function(){}),shaka.log.error)}catch(r){throw shaka.log.error("Cast session sendMessage threw",r),e=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.CAST,shaka.util.Error.Code.CAST_CONNECTION_TIMED_OUT,r),t=new shaka.util.FakeEvent("error",(new Map).set("detail",e)),this.onRemoteEvent_("player",t),this.forceDisconnect(),e}},shaka.cast.CastSender.STATUS_DELAY=.02,shaka.cast.CastSender.hasReceivers_=!1,shaka.cast.CastSender.session_=null,shaka.cast.CastSender.__onGCastApiAvailable_=null,shaka.cast.CastSender.instances_=new Set,shaka.cast.CastSender.onSdkLoaded_=function(e){if(e)for(var t=(e=$jscomp.makeIterator(shaka.cast.CastSender.instances_)).next();!t.done;t=e.next())t.value.init()},shaka.cast.CastSender.onGCastApiAvailable_=function(e){shaka.cast.CastSender.__onGCastApiAvailable_?window.__onGCastApiAvailable=shaka.cast.CastSender.__onGCastApiAvailable_:delete window.__onGCastApiAvailable,shaka.cast.CastSender.__onGCastApiAvailable_=null,shaka.cast.CastSender.onSdkLoaded_(e),"function"==typeof window.__onGCastApiAvailable&&window.__onGCastApiAvailable(e)},shaka.cast.CastProxy=function(e,t,r,n){n=void 0!==n&&n,shaka.util.FakeEventTarget.call(this);var a=this;this.localVideo_=e,this.localPlayer_=t,this.eventManager_=this.playerEventTarget_=this.videoEventTarget_=this.playerProxy_=this.videoProxy_=null,this.receiverAppId_=r,this.androidReceiverCompatible_=n,this.compiledToExternNames_=new Map,this.sender_=null,window.chrome?(this.sender_=new shaka.cast.CastSender(r,(function(){return a.onCastStatusChanged_()}),(function(){return a.onFirstCastStateUpdate_()}),(function(e,t){return a.onRemoteEvent_(e,t)}),(function(){return a.onResumeLocal_()}),(function(){return a.getInitState_()}),n),this.init_()):this.initWithoutSender_()},$jscomp.inherits(shaka.cast.CastProxy,shaka.util.FakeEventTarget),shaka.cast.CastProxy.prototype.destroy=function(e){return this.sender_&&e&&this.sender_.forceDisconnect(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),e=[],this.localPlayer_&&(e.push(this.localPlayer_.destroy()),this.localPlayer_=null),this.sender_&&(e.push(this.sender_.destroy()),this.sender_=null),this.playerProxy_=this.videoProxy_=this.localVideo_=null,shaka.util.FakeEventTarget.prototype.release.call(this),Promise.all(e)},shaka.cast.CastProxy.prototype.getVideo=function(){return this.videoProxy_},shaka.cast.CastProxy.prototype.getPlayer=function(){return this.playerProxy_},shaka.cast.CastProxy.prototype.canCast=function(){return!!this.sender_&&(this.sender_.apiReady()&&this.sender_.hasReceivers())},shaka.cast.CastProxy.prototype.isCasting=function(){return!!this.sender_&&this.sender_.isCasting()},shaka.cast.CastProxy.prototype.receiverName=function(){return this.sender_?this.sender_.receiverName():""},shaka.cast.CastProxy.prototype.cast=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?e.sender_?t.yield(e.sender_.cast(),2):t.return():e.localPlayer_?t.yield(e.localPlayer_.unload(),0):t.return()}))},shaka.cast.CastProxy.prototype.setAppData=function(e){this.sender_&&this.sender_.setAppData(e)},shaka.cast.CastProxy.prototype.suggestDisconnect=function(){this.sender_&&this.sender_.showDisconnectDialog()},shaka.cast.CastProxy.prototype.forceDisconnect=function(){this.sender_&&this.sender_.forceDisconnect()},shaka.cast.CastProxy.prototype.changeReceiverId=function(e,t){t=void 0!==t&&t;var r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return e==r.receiverAppId_&&t==r.androidReceiverCompatible_?n.return():(r.receiverAppId_=e,r.androidReceiverCompatible_=t,r.sender_?(r.sender_.forceDisconnect(),n.yield(r.sender_.destroy(),2)):n.return());r.sender_=null,r.sender_=new shaka.cast.CastSender(e,(function(){return r.onCastStatusChanged_()}),(function(){return r.onFirstCastStateUpdate_()}),(function(e,t){return r.onRemoteEvent_(e,t)}),(function(){return r.onResumeLocal_()}),(function(){return r.getInitState_()}),t),r.sender_.init(),n.jumpToEnd()}))},shaka.cast.CastProxy.prototype.initWithoutSender_=function(){this.videoProxy_=this.localVideo_,this.playerProxy_=this.localPlayer_},shaka.cast.CastProxy.prototype.init_=function(){var e=this;this.sender_.init(),this.eventManager_=new shaka.util.EventManager;for(var t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoEvents),r=t.next();!r.done;r=t.next())this.eventManager_.listen(this.localVideo_,r.value,(function(t){return e.videoProxyLocalEvent_(t)}));for(var n in shaka.util.FakeEvent.EventName)this.eventManager_.listen(this.localPlayer_,shaka.util.FakeEvent.EventName[n],(function(t){return e.playerProxyLocalEvent_(t)}));for(var a in this.videoProxy_={},t={},this.localVideo_)(t={k$jscomp$12:t.k$jscomp$12}).k$jscomp$12=a,Object.defineProperty(this.videoProxy_,t.k$jscomp$12,{configurable:!1,enumerable:!0,get:function(t){return function(){return e.videoProxyGet_(t.k$jscomp$12)}}(t),set:function(t){return function(r){e.videoProxySet_(t.k$jscomp$12,r)}}(t)});this.playerProxy_={},this.iterateOverPlayerMethods_((function(t,r){goog.asserts.assert(e.playerProxy_,"Must have player proxy!"),Object.defineProperty(e.playerProxy_,t,{configurable:!1,enumerable:!0,get:function(){return e.playerProxyGet_(t)}})})),COMPILED&&this.mapCompiledToUncompiledPlayerMethodNames_(),this.videoEventTarget_=new shaka.util.FakeEventTarget,this.videoEventTarget_.dispatchTarget=this.videoProxy_,this.playerEventTarget_=new shaka.util.FakeEventTarget,this.playerEventTarget_.dispatchTarget=this.playerProxy_},shaka.cast.CastProxy.prototype.mapCompiledToUncompiledPlayerMethodNames_=function(){var e=this,t=new Map;this.iterateOverPlayerMethods_((function(r,n){t.has(n)?(n=t.get(n),r.length<n.length?e.compiledToExternNames_.set(r,n):e.compiledToExternNames_.set(n,r)):t.set(n,r)}))},shaka.cast.CastProxy.prototype.iterateOverPlayerMethods_=function(e){function t(e){return"constructor"!=e&&"function"==typeof r[e]&&!n.has(e)}goog.asserts.assert(this.localPlayer_,"Must have player!");var r=this.localPlayer_,n=new Set;for(a in r)t(a)&&(n.add(a),e(a,r[a]));for(var a=Object.getPrototypeOf(r),i=Object.getPrototypeOf({});a&&a!=i;){for(var s=$jscomp.makeIterator(Object.getOwnPropertyNames(a)),o=s.next();!o.done;o=s.next())t(o=o.value)&&(n.add(o),e(o,r[o]));a=Object.getPrototypeOf(a)}},shaka.cast.CastProxy.prototype.getInitState_=function(){var e={video:{},player:{},playerAfterLoad:{},manifest:this.localPlayer_.getAssetUri(),startTime:null};this.localVideo_.pause();for(var t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoInitStateAttributes),r=t.next();!r.done;r=t.next())r=r.value,e.video[r]=this.localVideo_[r];for(this.localVideo_.ended||(e.startTime=this.localVideo_.currentTime),r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitState)).next();!r.done;r=t.next()){var n=r.value;r=n[1],n=this.localPlayer_[n[0]](),e.player[r]=n}for(r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitAfterLoadState)).next();!r.done;r=t.next())r=(n=r.value)[1],n=this.localPlayer_[n[0]](),e.playerAfterLoad[r]=n;return e},shaka.cast.CastProxy.prototype.onCastStatusChanged_=function(){var e=new shaka.util.FakeEvent("caststatuschanged");this.dispatchEvent(e)},shaka.cast.CastProxy.prototype.onFirstCastStateUpdate_=function(){var e=new shaka.util.FakeEvent(this.videoProxy_.paused?"pause":"play");this.videoEventTarget_.dispatchEvent(e)},shaka.cast.CastProxy.prototype.onResumeLocal_=function(){for(var e=this,t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitState),r=t.next();!r.done;r=t.next()){var n=r.value;r=n[1],n=this.sender_.get("player",n[0])(),this.localPlayer_[r](n)}var a=this.sender_.get("player","getAssetUri")();n=this.sender_.get("video","ended"),t=Promise.resolve();var i,s=this.localVideo_.autoplay;r=null,n||(r=this.sender_.get("video","currentTime")),(n=this.sender_.get("player","getTextTracks")())&&n.length&&(i=n.find((function(e){return e.active})));var o=this.sender_.get("player","isTextTrackVisible")();a&&(this.localVideo_.autoplay=!1,t=this.localPlayer_.load(a,r));var l={};for(n=(r=$jscomp.makeIterator(shaka.cast.CastUtils.VideoInitStateAttributes)).next();!n.done;n=r.next())n=n.value,l[n]=this.sender_.get("video",n);t.then((function(){if(e.localVideo_){for(var t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoInitStateAttributes),r=t.next();!r.done;r=t.next())r=r.value,e.localVideo_[r]=l[r];for(r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitAfterLoadState)).next();!r.done;r=t.next()){var n=r.value;r=n[1],n=e.sender_.get("player",n[0])(),e.localPlayer_[r](n)}e.localPlayer_.setTextTrackVisibility(o),i&&e.localPlayer_.selectTextLanguage(i.language,i.roles,i.forced),e.localVideo_.autoplay=s,a&&e.localVideo_.play()}}),(function(t){goog.asserts.assert(t instanceof shaka.util.Error,"Wrong error type!");var r=shaka.util.FakeEvent.EventName.Error;t=(new Map).set("detail",t),r=new shaka.util.FakeEvent(r,t),e.localPlayer_.dispatchEvent(r)}))},shaka.cast.CastProxy.prototype.videoProxyGet_=function(e){var t=this;if("addEventListener"==e)return function(e,r,n){return t.videoEventTarget_.addEventListener(e,r,n)};if("removeEventListener"==e)return function(e,r,n){return t.videoEventTarget_.removeEventListener(e,r,n)};if(this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()){var r=this.localVideo_[e];if("function"!=typeof r)return r}return this.sender_.isCasting()?this.sender_.get("video",e):("function"==typeof(e=this.localVideo_[e])&&(e=e.bind(this.localVideo_)),e)},shaka.cast.CastProxy.prototype.videoProxySet_=function(e,t){this.sender_.isCasting()?this.sender_.set("video",e,t):this.localVideo_[e]=t},shaka.cast.CastProxy.prototype.videoProxyLocalEvent_=function(e){this.sender_.isCasting()||(e=shaka.util.FakeEvent.fromRealEvent(e),this.videoEventTarget_.dispatchEvent(e))},shaka.cast.CastProxy.prototype.playerProxyGet_=function(e){var t=this;if(this.compiledToExternNames_.has(e)&&(e=this.compiledToExternNames_.get(e)),"addEventListener"==e)return function(e,r,n){return t.playerEventTarget_.addEventListener(e,r,n)};if("removeEventListener"==e)return function(e,r,n){return t.playerEventTarget_.removeEventListener(e,r,n)};if("getMediaElement"==e)return function(){return t.videoProxy_};if("getSharedConfiguration"==e)return shaka.log.warning("Can't share configuration across a network. Returning copy."),this.sender_.get("player","getConfiguration");if("getNetworkingEngine"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: getNetworkingEngine() is always local!"),function(){return t.localPlayer_.getNetworkingEngine()};if("getDrmEngine"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: getDrmEngine() is always local!"),function(){return t.localPlayer_.getDrmEngine()};if("getAdManager"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: getAdManager() is always local!"),function(){return t.localPlayer_.getAdManager()};if("setVideoContainer"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: setVideoContainer() is always local!"),function(e){return t.localPlayer_.setVideoContainer(e)};if(this.sender_.isCasting()){if("getManifest"==e||"drmInfo"==e)return function(){return shaka.log.alwaysWarn(e+"() does not work while casting!"),null};if("attach"==e||"detach"==e)return function(){return shaka.log.alwaysWarn(e+"() does not work while casting!"),Promise.resolve()}}if(this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()&&(shaka.cast.CastUtils.PlayerGetterMethods.has(e)||shaka.cast.CastUtils.LargePlayerGetterMethods.has(e))){var r=this.localPlayer_[e];return goog.asserts.assert("function"==typeof r,"only methods on Player"),r.bind(this.localPlayer_)}return this.sender_.isCasting()?this.sender_.get("player",e):(r=this.localPlayer_[e],goog.asserts.assert("function"==typeof r,"only methods on Player"),r.bind(this.localPlayer_))},shaka.cast.CastProxy.prototype.playerProxyLocalEvent_=function(e){this.sender_.isCasting()||this.playerEventTarget_.dispatchEvent(e)},shaka.cast.CastProxy.prototype.onRemoteEvent_=function(e,t){goog.asserts.assert(this.sender_.isCasting(),"Should only receive remote events while casting"),this.sender_.isCasting()&&("video"==e?this.videoEventTarget_.dispatchEvent(t):"player"==e&&this.playerEventTarget_.dispatchEvent(t))},goog.exportSymbol("shaka.cast.CastProxy",shaka.cast.CastProxy),goog.exportProperty(shaka.cast.CastProxy.prototype,"changeReceiverId",shaka.cast.CastProxy.prototype.changeReceiverId),goog.exportProperty(shaka.cast.CastProxy.prototype,"forceDisconnect",shaka.cast.CastProxy.prototype.forceDisconnect),goog.exportProperty(shaka.cast.CastProxy.prototype,"suggestDisconnect",shaka.cast.CastProxy.prototype.suggestDisconnect),goog.exportProperty(shaka.cast.CastProxy.prototype,"setAppData",shaka.cast.CastProxy.prototype.setAppData),goog.exportProperty(shaka.cast.CastProxy.prototype,"cast",shaka.cast.CastProxy.prototype.cast),goog.exportProperty(shaka.cast.CastProxy.prototype,"receiverName",shaka.cast.CastProxy.prototype.receiverName),goog.exportProperty(shaka.cast.CastProxy.prototype,"isCasting",shaka.cast.CastProxy.prototype.isCasting),goog.exportProperty(shaka.cast.CastProxy.prototype,"canCast",shaka.cast.CastProxy.prototype.canCast),goog.exportProperty(shaka.cast.CastProxy.prototype,"getPlayer",shaka.cast.CastProxy.prototype.getPlayer),goog.exportProperty(shaka.cast.CastProxy.prototype,"getVideo",shaka.cast.CastProxy.prototype.getVideo),goog.exportProperty(shaka.cast.CastProxy.prototype,"destroy",shaka.cast.CastProxy.prototype.destroy),shaka.cast.CastReceiver=function(e,t,r,n){shaka.util.FakeEventTarget.call(this);var a=this;this.video_=e,this.player_=t,this.eventManager_=new shaka.util.EventManager,this.targets_={video:e,player:t},this.appDataCallback_=r||function(){},this.contentIdCallback_=n||function(e){return e},this.metadata_=null,this.isConnected_=!1,this.isIdle_=!0,this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!0,this.genericBus_=this.shakaBus_=null,this.pollTimer_=new shaka.util.Timer((function(){a.pollAttributes_()})),this.init_()},$jscomp.inherits(shaka.cast.CastReceiver,shaka.util.FakeEventTarget),shaka.cast.CastReceiver.prototype.isConnected=function(){return this.isConnected_},shaka.cast.CastReceiver.prototype.isIdle=function(){return this.isIdle_},shaka.cast.CastReceiver.prototype.setContentMetadata=function(e){this.metadata_=e},shaka.cast.CastReceiver.prototype.clearContentMetadata=function(){this.metadata_=null},shaka.cast.CastReceiver.prototype.setContentTitle=function(e){this.metadata_||(this.metadata_={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.metadata_.title=e},shaka.cast.CastReceiver.prototype.setContentImage=function(e){this.metadata_||(this.metadata_={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.metadata_.images=[{url:e}]},shaka.cast.CastReceiver.prototype.setContentArtist=function(e){this.metadata_||(this.metadata_={}),this.metadata_.artist=e,this.metadata_.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},shaka.cast.CastReceiver.prototype.destroy=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return t.eventManager_&&(t.eventManager_.release(),t.eventManager_=null),e=[],t.player_&&(e.push(t.player_.destroy()),t.player_=null),t.pollTimer_&&(t.pollTimer_.stop(),t.pollTimer_=null),t.video_=null,t.targets_=null,t.appDataCallback_=null,t.isConnected_=!1,t.isIdle_=!0,t.shakaBus_=null,t.genericBus_=null,shaka.util.FakeEventTarget.prototype.release.call(t),r.yield(Promise.all(e),2);cast.receiver.CastReceiverManager.getInstance().stop(),r.jumpToEnd()}))},shaka.cast.CastReceiver.prototype.init_=function(){var e=this,t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return e.onSendersChanged_()},t.onSenderDisconnected=function(){return e.onSendersChanged_()},t.onSystemVolumeChanged=function(){return e.fakeVolumeChangeEvent_()},this.genericBus_=t.getCastMessageBus(shaka.cast.CastUtils.GENERIC_MESSAGE_NAMESPACE),this.genericBus_.onMessage=function(t){return e.onGenericMessage_(t)},this.shakaBus_=t.getCastMessageBus(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE),this.shakaBus_.onMessage=function(t){return e.onShakaMessage_(t)},goog.DEBUG?shaka.util.Platform.isChromecast()&&t.start():t.start();for(var r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoEvents)).next();!r.done;r=t.next())this.eventManager_.listen(this.video_,r.value,(function(t){return e.proxyEvent_("video",t)}));for(var n in shaka.util.FakeEvent.EventName)this.eventManager_.listen(this.player_,shaka.util.FakeEvent.EventName[n],(function(t){return e.proxyEvent_("player",t)}));this.eventManager_.listen(this.video_,"loadeddata",(function(){e.startUpdatingUpdateNumber_=!0})),this.eventManager_.listen(this.player_,"loading",(function(){e.isIdle_=!1,e.onCastStatusChanged_()})),this.eventManager_.listen(this.video_,"playing",(function(){e.isIdle_=!1,e.onCastStatusChanged_()})),this.eventManager_.listen(this.video_,"pause",(function(){e.onCastStatusChanged_()})),this.eventManager_.listen(this.player_,"unloading",(function(){e.isIdle_=!0,e.onCastStatusChanged_()})),this.eventManager_.listen(this.video_,"ended",(function(){new shaka.util.Timer((function(){e.video_&&e.video_.ended&&(e.isIdle_=!0,e.onCastStatusChanged_())})).tickAfter(shaka.cast.CastReceiver.IDLE_INTERVAL)}))},shaka.cast.CastReceiver.prototype.onSendersChanged_=function(){this.updateNumber_=0,this.initialStatusUpdatePending_=!0,this.isConnected_=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,this.onCastStatusChanged_()},shaka.cast.CastReceiver.prototype.onCastStatusChanged_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?r.yield(Promise.resolve(),2):t.player_?(e=new shaka.util.FakeEvent("caststatuschanged"),t.dispatchEvent(e),t.maybeSendMediaInfoMessage_()||t.sendMediaStatus_(),void r.jumpToEnd()):r.return()}))},shaka.cast.CastReceiver.prototype.initState_=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(f){switch(f.nextAddress){case 1:for(r in e.player)n=e.player[r],h.player_[r](n);return h.appDataCallback_(t),a=h.video_.autoplay,e.manifest?(h.video_.autoplay=!1,f.setCatchFinallyBlocks(5),f.yield(h.player_.load(e.manifest,e.startTime),7)):f.yield(Promise.resolve(),3);case 7:f.leaveTryBlock(3);break;case 5:return i=f.enterCatchBlock(),goog.asserts.assert(i instanceof shaka.util.Error,"Wrong error type! Error: "+i),s=shaka.util.FakeEvent.EventName.Error,o=(new Map).set("detail",i),l=new shaka.util.FakeEvent(s,o),h.player_&&h.player_.dispatchEvent(l),f.return();case 3:if(!h.player_)return f.return();for(u in e.video)c=e.video[u],h.video_[u]=c;for(d in e.playerAfterLoad)p=e.playerAfterLoad[d],h.player_[d](p);h.video_.autoplay=a,e.manifest&&(h.video_.play(),h.sendMediaStatus_()),f.jumpToEnd()}}))},shaka.cast.CastReceiver.prototype.proxyEvent_=function(e,t){this.player_&&(this.pollAttributes_(),this.sendMessage_({type:"event",targetName:e,event:t},this.shakaBus_))},shaka.cast.CastReceiver.prototype.pollAttributes_=function(){var e=this;this.pollTimer_.tickAfter(shaka.cast.CastReceiver.POLL_INTERVAL);for(var t={video:{},player:{}},r=$jscomp.makeIterator(shaka.cast.CastUtils.VideoAttributes),n=r.next();!n.done;n=r.next())n=n.value,t.video[n]=this.video_[n];this.player_.isLive()&&shaka.cast.CastUtils.PlayerGetterMethodsThatRequireLive.forEach((function(r,n){0==e.updateNumber_%r&&(t.player[n]=e.player_[n]())})),shaka.cast.CastUtils.PlayerGetterMethods.forEach((function(r,n){0==e.updateNumber_%r&&(t.player[n]=e.player_[n]())})),(r=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=r.level,t.video.muted=r.muted),this.sendMessage_({type:"update",update:t},this.shakaBus_),shaka.cast.CastUtils.LargePlayerGetterMethods.forEach((function(t,r){0==e.updateNumber_%t&&((t={player:{}}).player[r]=e.player_[r](),e.sendMessage_({type:"update",update:t},e.shakaBus_))})),this.startUpdatingUpdateNumber_&&(this.updateNumber_+=1),this.maybeSendMediaInfoMessage_()},shaka.cast.CastReceiver.prototype.maybeSendMediaInfoMessage_=function(){return!(!this.initialStatusUpdatePending_||!this.video_.duration&&!this.player_.isLive())&&(this.sendMediaInfoMessage_(),this.initialStatusUpdatePending_=!1,!0)},shaka.cast.CastReceiver.prototype.sendMediaInfoMessage_=function(e){e=void 0===e?0:e;var t={contentId:this.player_.getAssetUri(),streamType:this.player_.isLive()?"LIVE":"BUFFERED",contentType:""};this.player_.isLive()||(t.duration=this.video_.duration),this.metadata_&&(t.metadata=this.metadata_),this.sendMediaStatus_(e,t)},shaka.cast.CastReceiver.prototype.fakeVolumeChangeEvent_=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();goog.asserts.assert(e,"System volume should not be null!"),e&&this.sendMessage_({type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.shakaBus_),this.sendMessage_({type:"event",targetName:"video",event:{type:"volumechange"}},this.shakaBus_)},shaka.cast.CastReceiver.prototype.onShakaMessage_=function(e){var t=this,r=shaka.cast.CastUtils.deserialize(e.data);switch(shaka.log.debug("CastReceiver: message",r),r.type){case"init":this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!0,this.initState_(r.initState,r.appData),this.pollAttributes_();break;case"appData":this.appDataCallback_(r.appData);break;case"set":var n=r.targetName,a=r.property;if(r=r.value,"video"==n){if(e=cast.receiver.CastReceiverManager.getInstance(),"volume"==a){e.setSystemVolumeLevel(r);break}if("muted"==a){e.setSystemVolumeMuted(r);break}}this.targets_[n][a]=r;break;case"call":(n=this.targets_[r.targetName])[r.methodName].apply(n,r.args);break;case"asyncCall":n=r.targetName,a=r.methodName,"player"==n&&"load"==a&&(this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1);var i=r.id,s=e.senderId;r=(e=this.targets_[n])[a].apply(e,r.args),"player"==n&&"load"==a&&(r=r.then((function(){t.initialStatusUpdatePending_=!0}))),r.then((function(){return t.sendAsyncComplete_(s,i,null)}),(function(e){return t.sendAsyncComplete_(s,i,e)}))}},shaka.cast.CastReceiver.prototype.onGenericMessage_=function(e){var t=this,r=shaka.cast.CastUtils.deserialize(e.data);switch(shaka.log.debug("CastReceiver: message",r),r.type){case"PLAY":this.video_.play(),this.sendMediaStatus_();break;case"PAUSE":this.video_.pause(),this.sendMediaStatus_();break;case"SEEK":e=r.currentTime;var n=r.resumeState;null!=e&&(this.video_.currentTime=Number(e)),n&&"PLAYBACK_START"==n?(this.video_.play(),this.sendMediaStatus_()):n&&"PLAYBACK_PAUSE"==n&&(this.video_.pause(),this.sendMediaStatus_());break;case"STOP":this.player_.unload().then((function(){t.player_&&t.sendMediaStatus_()}));break;case"GET_STATUS":this.sendMediaInfoMessage_(Number(r.requestId));break;case"VOLUME":e=(n=r.volume).level,n=n.muted;var a=this.video_.volume,i=this.video_.muted;null!=e&&(this.video_.volume=Number(e)),null!=n&&(this.video_.muted=n),a==this.video_.volume&&i==this.video_.muted||this.sendMediaStatus_();break;case"LOAD":this.updateNumber_=0,this.initialStatusUpdatePending_=this.startUpdatingUpdateNumber_=!1,e=r.media,n=r.currentTime,a=this.contentIdCallback_(e.contentId),i=r.autoplay||!0,this.appDataCallback_(e.customData),i&&(this.video_.autoplay=!0),this.player_.load(a,n).then((function(){t.player_&&t.sendMediaInfoMessage_()})).catch((function(e){goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!");var n="LOAD_FAILED";e.category==shaka.util.Error.Category.PLAYER&&e.code==shaka.util.Error.Code.LOAD_INTERRUPTED&&(n="LOAD_CANCELLED"),t.sendMessage_({requestId:Number(r.requestId),type:n},t.genericBus_)}));break;default:shaka.log.warning("Unrecognized message type from the generic Chromecast controller!",r.type),this.sendMessage_({requestId:Number(r.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.genericBus_)}},shaka.cast.CastReceiver.prototype.sendAsyncComplete_=function(e,t,r){this.player_&&this.sendMessage_({type:"asyncComplete",id:t,error:r},this.shakaBus_,e)},shaka.cast.CastReceiver.prototype.sendMessage_=function(e,t,r){this.isConnected_&&(e=shaka.cast.CastUtils.serialize(e),r?t.getCastChannel(r).send(e):t.broadcast(e))},shaka.cast.CastReceiver.prototype.getPlayState_=function(){var e=shaka.cast.CastReceiver.PLAY_STATE;return this.isIdle_?e.IDLE:this.player_.isBuffering()?e.BUFFERING:this.video_.paused?e.PAUSED:e.PLAYING},shaka.cast.CastReceiver.prototype.sendMediaStatus_=function(e,t){e=void 0===e?0:e,t=void 0===t?null:t;var r={mediaSessionId:0,playbackRate:this.video_.playbackRate,playerState:this.getPlayState_(),currentTime:this.video_.currentTime,supportedMediaCommands:63,volume:{level:this.video_.volume,muted:this.video_.muted}};t&&(r.media=t),this.sendMessage_({requestId:e,type:"MEDIA_STATUS",status:[r]},this.genericBus_)},goog.exportSymbol("shaka.cast.CastReceiver",shaka.cast.CastReceiver),goog.exportProperty(shaka.cast.CastReceiver.prototype,"destroy",shaka.cast.CastReceiver.prototype.destroy),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentArtist",shaka.cast.CastReceiver.prototype.setContentArtist),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentImage",shaka.cast.CastReceiver.prototype.setContentImage),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentTitle",shaka.cast.CastReceiver.prototype.setContentTitle),goog.exportProperty(shaka.cast.CastReceiver.prototype,"clearContentMetadata",shaka.cast.CastReceiver.prototype.clearContentMetadata),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentMetadata",shaka.cast.CastReceiver.prototype.setContentMetadata),goog.exportProperty(shaka.cast.CastReceiver.prototype,"isIdle",shaka.cast.CastReceiver.prototype.isIdle),goog.exportProperty(shaka.cast.CastReceiver.prototype,"isConnected",shaka.cast.CastReceiver.prototype.isConnected),shaka.cast.CastReceiver.POLL_INTERVAL=.5,shaka.cast.CastReceiver.IDLE_INTERVAL=5,shaka.cast.CastReceiver.PLAY_STATE={IDLE:"IDLE",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED"},shaka.cea.CeaUtils=function(){},shaka.cea.CeaUtils.getParsedCaption=function(e,t,r,n,a){if(n>=a)return null;for(var i=-1,s=-1,o=0;o<r.length;o++)if(r[o].some((function(e){return null!=e&&""!=e.getChar().trim()}))){i=o;break}for(o=r.length-1;0<=o;o--)if(r[o].some((function(e){return null!=e&&""!=e.getChar().trim()}))){s=o;break}if(-1===i||-1===s)return null;for(var l=o=!1,u=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,c=shaka.cea.CeaUtils.DEFAULT_BG_COLOR,d=shaka.cea.CeaUtils.createStyledCue(n,a,o,l,u,c);i<=s;i++){for(var p=r[i],h=-1,f=-1,m=0;m<p.length;m++)if(null!=p[m]&&""!==p[m].getChar().trim()){h=m;break}for(m=p.length-1;0<=m;m--)if(null!=p[m]&&""!==p[m].getChar().trim()){f=m;break}if(-1===h||-1===f)p=shaka.cea.CeaUtils.createLineBreakCue(n,a),e.nestedCues.push(p);else{for(;h<=f;h++)if(m=p[h]){var g=m.isUnderlined(),y=m.isItalicized(),v=m.getTextColor(),_=m.getBackgroundColor();g==o&&y==l&&v==u&&_==c||(d.payload&&e.nestedCues.push(d),d=shaka.cea.CeaUtils.createStyledCue(n,a,g,y,v,_),o=g,l=y,u=v,c=_),d.payload+=m.getChar()}else d.payload+=" ";d.payload&&e.nestedCues.push(d),i!==s&&(d=shaka.cea.CeaUtils.createLineBreakCue(n,a),e.nestedCues.push(d)),d=shaka.cea.CeaUtils.createStyledCue(n,a,o,l,u,c)}}return e.nestedCues.length?{cue:e,stream:t}:null},shaka.cea.CeaUtils.createStyledCue=function(e,t,r,n,a,i){return e=new shaka.text.Cue(e,t,""),r&&e.textDecoration.push(shaka.text.Cue.textDecoration.UNDERLINE),n&&(e.fontStyle=shaka.text.Cue.fontStyle.ITALIC),e.color=a,e.backgroundColor=i,e},shaka.cea.CeaUtils.createLineBreakCue=function(e,t){return(e=new shaka.text.Cue(e,t,"")).lineBreak=!0,e},shaka.cea.CeaUtils.StyledChar=function(e,t,r,n,a){this.character_=e,this.underline_=t,this.italics_=r,this.backgroundColor_=n,this.textColor_=a},shaka.cea.CeaUtils.StyledChar.prototype.getChar=function(){return this.character_},shaka.cea.CeaUtils.StyledChar.prototype.isUnderlined=function(){return this.underline_},shaka.cea.CeaUtils.StyledChar.prototype.isItalicized=function(){return this.italics_},shaka.cea.CeaUtils.StyledChar.prototype.getBackgroundColor=function(){return this.backgroundColor_},shaka.cea.CeaUtils.StyledChar.prototype.getTextColor=function(){return this.textColor_},shaka.cea.CeaUtils.DEFAULT_BG_COLOR="black",shaka.cea.CeaUtils.DEFAULT_TXT_COLOR="white",shaka.cea.CeaUtils.H264_NALU_TYPE_SEI=6,shaka.cea.CeaUtils.H265_PREFIX_NALU_TYPE_SEI=39,shaka.cea.CeaUtils.H265_SUFFIX_NALU_TYPE_SEI=40,shaka.cea.CeaUtils.H266_PREFIX_NALU_TYPE_SEI=23,shaka.cea.CeaUtils.H266_SUFFIX_NALU_TYPE_SEI=24,shaka.cea.CeaUtils.DEFAULT_TIMESCALE_VALUE=9e4,shaka.cea.Cea608Memory=function(e,t){this.rows_=[],this.row_=1,this.scrollRows_=0,this.fieldNum_=e,this.channelNum_=t,this.italics_=this.underline_=!1,this.textColor_=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,this.backgroundColor_=shaka.cea.CeaUtils.DEFAULT_BG_COLOR,this.indent_=this.offset_=null,this.reset()},shaka.cea.Cea608Memory.prototype.forceEmit=function(e,t){var r=shaka.cea.Cea608Memory,n="CC"+(1+(this.fieldNum_<<1|this.channelNum_)),a=new shaka.text.Cue(e,t,"");a.lineInterpretation=shaka.text.Cue.lineInterpretation.PERCENTAGE;var i=r.ROW_TO_LINE_CONVERSION_.get(this.row_);return i&&(a.line=i),null!=this.indent_&&null!=this.offset_&&(a.position=10+Math.min(70,10*this.indent_)+2.5*this.offset_),(e=shaka.cea.CeaUtils.getParsedCaption(a,n,this.rows_,e,t))&&15<this.row_+e.cue.nestedCues.length-3&&(i=r.ROW_TO_LINE_CONVERSION_.get(this.row_+3-e.cue.nestedCues.length))&&(a.line=i),e},shaka.cea.Cea608Memory.prototype.reset=function(){this.resetAllRows(),this.row_=1},shaka.cea.Cea608Memory.prototype.getRow=function(){return this.row_},shaka.cea.Cea608Memory.prototype.setRow=function(e){this.row_=e},shaka.cea.Cea608Memory.prototype.getScrollSize=function(){return this.scrollRows_},shaka.cea.Cea608Memory.prototype.setScrollSize=function(e){this.scrollRows_=e},shaka.cea.Cea608Memory.prototype.addChar=function(e,t){if(!(32>t||127<t)){var r="";switch(e){case shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN:r=shaka.cea.Cea608Memory.CharSet.BasicNorthAmericanChars.has(t)?shaka.cea.Cea608Memory.CharSet.BasicNorthAmericanChars.get(t):String.fromCharCode(t);break;case shaka.cea.Cea608Memory.CharSet.SPECIAL_NORTH_AMERICAN:r=shaka.cea.Cea608Memory.CharSet.SpecialNorthAmericanChars.get(t);break;case shaka.cea.Cea608Memory.CharSet.SPANISH_FRENCH:this.eraseChar(),r=shaka.cea.Cea608Memory.CharSet.ExtendedSpanishFrench.get(t);break;case shaka.cea.Cea608Memory.CharSet.PORTUGUESE_GERMAN:this.eraseChar(),r=shaka.cea.Cea608Memory.CharSet.ExtendedPortugueseGerman.get(t)}r&&(e=new shaka.cea.CeaUtils.StyledChar(r,this.underline_,this.italics_,this.backgroundColor_,this.textColor_),this.rows_[this.row_].push(e))}},shaka.cea.Cea608Memory.prototype.eraseChar=function(){this.rows_[this.row_].pop()},shaka.cea.Cea608Memory.prototype.moveRows=function(e,t,r){if(!(0>t||0>e))if(e>=t)for(--r;0<=r;r--)this.rows_[e+r]=this.rows_[t+r].map((function(e){return e}));else for(var n=0;n<r;n++)this.rows_[e+n]=this.rows_[t+n].map((function(e){return e}))},shaka.cea.Cea608Memory.prototype.resetRows=function(e,t){for(var r=0;r<=t;r++)this.rows_[e+r]=[]},shaka.cea.Cea608Memory.prototype.resetAllRows=function(){this.resetRows(0,shaka.cea.Cea608Memory.CC_ROWS)},shaka.cea.Cea608Memory.prototype.eraseBuffer=function(){this.row_=0<this.scrollRows_?this.scrollRows_:0,this.resetAllRows()},shaka.cea.Cea608Memory.prototype.setUnderline=function(e){this.underline_=e},shaka.cea.Cea608Memory.prototype.setItalics=function(e){this.italics_=e},shaka.cea.Cea608Memory.prototype.setTextColor=function(e){this.textColor_=e},shaka.cea.Cea608Memory.prototype.setBackgroundColor=function(e){this.backgroundColor_=e},shaka.cea.Cea608Memory.prototype.setOffset=function(e){this.offset_=e},shaka.cea.Cea608Memory.prototype.setIndent=function(e){this.indent_=e},shaka.cea.Cea608Memory.CC_ROWS=15,shaka.cea.Cea608Memory.CharSet={BASIC_NORTH_AMERICAN:0,SPECIAL_NORTH_AMERICAN:1,SPANISH_FRENCH:2,PORTUGUESE_GERMAN:3},shaka.cea.Cea608Memory.CharSet.BasicNorthAmericanChars=new Map([[39,""],[42,""],[92,""],[92,""],[94,""],[95,""],[96,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),shaka.cea.Cea608Memory.CharSet.SpecialNorthAmericanChars=new Map([[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57," "],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),shaka.cea.Cea608Memory.CharSet.ExtendedSpanishFrench=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,"*"],[41,"'"],[42,""],[43,""],[44,""],[45,""],[46,""],[47,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),shaka.cea.Cea608Memory.CharSet.ExtendedPortugueseGerman=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,""],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),shaka.cea.Cea608Memory.ROW_TO_LINE_CONVERSION_=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]),shaka.cea.Cea608DataChannel=function(e,t){this.type_=shaka.cea.Cea608DataChannel.CaptionType.NONE,this.text_=new shaka.cea.Cea608Memory(e,t),this.displayedMemory_=new shaka.cea.Cea608Memory(e,t),this.curBuf_=this.nonDisplayedMemory_=new shaka.cea.Cea608Memory(e,t),this.prevEndTime_=0,this.lastCp_=null},shaka.cea.Cea608DataChannel.prototype.reset=function(){this.type_=shaka.cea.Cea608DataChannel.CaptionType.NONE,this.curBuf_=this.nonDisplayedMemory_,this.lastCp_=null,this.displayedMemory_.reset(),this.nonDisplayedMemory_.reset(),this.text_.reset()},shaka.cea.Cea608DataChannel.prototype.firstPts=function(e){this.prevEndTime_=e},shaka.cea.Cea608DataChannel.prototype.pacToRow_=function(e,t){return[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&e)<<1|t>>5&1]},shaka.cea.Cea608DataChannel.prototype.controlPac_=function(e,t){e=this.pacToRow_(e,t);var r=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,n=!1,a=null,i=95<t?t-96:t-64;if(13>=i?r=shaka.cea.Cea608DataChannel.TEXT_COLORS[Math.floor(i/2)]:15>=i?n=!0:a=Math.floor((i-16)/2),t=1==(1&t),this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT){if(i=this.curBuf_,this.type_===shaka.cea.Cea608DataChannel.CaptionType.ROLLUP&&e!==i.getRow()){var s=1+i.getRow()-i.getScrollSize(),o=1+e-i.getScrollSize();i.moveRows(o,s,i.getScrollSize()),i.resetRows(0,o-1),i.resetRows(e+1,shaka.cea.Cea608Memory.CC_ROWS-e)}i.setRow(e),i.setUnderline(t),i.setItalics(n),i.setTextColor(r),i.setIndent(a),i.setBackgroundColor(shaka.cea.CeaUtils.DEFAULT_BG_COLOR)}},shaka.cea.Cea608DataChannel.prototype.controlMidrow_=function(e){this.curBuf_.setUnderline(!1),this.curBuf_.setItalics(!1),this.curBuf_.setTextColor(shaka.cea.CeaUtils.DEFAULT_TXT_COLOR),this.curBuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,32);var t=!1,r=shaka.cea.Cea608DataChannel.TEXT_COLORS[(14&e)>>1];"white_italics"===r&&(r="white",t=!0),this.curBuf_.setUnderline(1==(1&e)),this.curBuf_.setItalics(t),this.curBuf_.setTextColor(r)},shaka.cea.Cea608DataChannel.prototype.controlBackgroundAttribute_=function(e,t){var r=shaka.cea.CeaUtils.DEFAULT_BG_COLOR;0==(7&e)&&(r=shaka.cea.Cea608DataChannel.BG_COLORS[(14&t)>>1]),this.curBuf_.setBackgroundColor(r)},shaka.cea.Cea608DataChannel.prototype.controlMiscellaneous_=function(e){var t=shaka.cea.Cea608DataChannel.MiscCmd_,r=e.pts,n=null;switch(e.ccData2){case t.RCL:this.controlRcl_();break;case t.BS:this.controlBs_();break;case t.RU2:n=this.controlRu_(2,r);break;case t.RU3:n=this.controlRu_(3,r);break;case t.RU4:n=this.controlRu_(4,r);break;case t.FON:this.controlFon_();break;case t.RDC:this.controlRdc_(r);break;case t.TR:this.controlTr_();break;case t.RTD:this.controlRtd_();break;case t.EDM:n=this.controlEdm_(r);break;case t.CR:n=this.controlCr_(r);break;case t.ENM:this.controlEnm_();break;case t.EOC:n=this.controlEoc_(r)}return n},shaka.cea.Cea608DataChannel.prototype.controlCr_=function(e){var t=this.curBuf_;if(this.type_!==shaka.cea.Cea608DataChannel.CaptionType.ROLLUP)return null;var r=t.forceEmit(this.prevEndTime_,e),n=t.getRow()-t.getScrollSize()+1;return t.moveRows(n-1,n,t.getScrollSize()),t.resetRows(0,n-1),t.resetRows(t.getRow(),shaka.cea.Cea608Memory.CC_ROWS-t.getRow()),this.prevEndTime_=e,r},shaka.cea.Cea608DataChannel.prototype.controlRu_=function(e,t){var r=this.curBuf_=this.displayedMemory_,n=null;return this.type_!==shaka.cea.Cea608DataChannel.CaptionType.ROLLUP&&this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT&&(n=r.forceEmit(this.prevEndTime_,t),this.displayedMemory_.eraseBuffer(),this.nonDisplayedMemory_.eraseBuffer(),r.setRow(shaka.cea.Cea608Memory.CC_ROWS)),this.type_=shaka.cea.Cea608DataChannel.CaptionType.ROLLUP,r.setScrollSize(e),n},shaka.cea.Cea608DataChannel.prototype.controlFon_=function(){this.curBuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,32)},shaka.cea.Cea608DataChannel.prototype.controlEdm_=function(e){var t=this.displayedMemory_,r=null;return this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT&&(r=t.forceEmit(this.prevEndTime_,e)),t.resetAllRows(),r},shaka.cea.Cea608DataChannel.prototype.controlRdc_=function(e){this.type_=shaka.cea.Cea608DataChannel.CaptionType.PAINTON,this.curBuf_=this.displayedMemory_,this.curBuf_.setScrollSize(0),this.prevEndTime_=e},shaka.cea.Cea608DataChannel.prototype.controlEnm_=function(){this.nonDisplayedMemory_.resetAllRows()},shaka.cea.Cea608DataChannel.prototype.controlEoc_=function(e){var t=null;this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT&&(t=this.displayedMemory_.forceEmit(this.prevEndTime_,e));var r=this.nonDisplayedMemory_;return this.nonDisplayedMemory_=this.displayedMemory_,this.displayedMemory_=r,this.controlRcl_(),this.prevEndTime_=e,t},shaka.cea.Cea608DataChannel.prototype.controlRcl_=function(){this.type_=shaka.cea.Cea608DataChannel.CaptionType.POPON,this.curBuf_=this.nonDisplayedMemory_,this.curBuf_.setScrollSize(0)},shaka.cea.Cea608DataChannel.prototype.controlBs_=function(){this.curBuf_.eraseChar()},shaka.cea.Cea608DataChannel.prototype.controlTr_=function(){this.text_.reset(),this.controlRtd_()},shaka.cea.Cea608DataChannel.prototype.controlRtd_=function(){shaka.log.warnOnce("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),this.curBuf_=this.text_,this.type_=shaka.cea.Cea608DataChannel.CaptionType.TEXT},shaka.cea.Cea608DataChannel.prototype.handleBasicNorthAmericanChar=function(e,t){this.curBuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,e),this.curBuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,t)},shaka.cea.Cea608DataChannel.prototype.handleExtendedWesternEuropeanChar_=function(e,t){this.curBuf_.addChar(1&e?shaka.cea.Cea608Memory.CharSet.PORTUGUESE_GERMAN:shaka.cea.Cea608Memory.CharSet.SPANISH_FRENCH,t)},shaka.cea.Cea608DataChannel.prototype.handleOffset_=function(e){this.curBuf_.setOffset(e)},shaka.cea.Cea608DataChannel.prototype.handleControlCode=function(e){var t=e.ccData1,r=e.ccData2;if(this.lastCp_===(t<<8|r))return this.lastCp_=null;if(this.lastCp_=t<<8|r,this.isPAC_(t,r))this.controlPac_(t,r);else if(this.isMidrowStyleChange_(t,r))this.controlMidrow_(r);else if(this.isBackgroundAttribute_(t,r))this.controlBackgroundAttribute_(t,r);else if(this.isSpecialNorthAmericanChar_(t,r))this.curBuf_.addChar(shaka.cea.Cea608Memory.CharSet.SPECIAL_NORTH_AMERICAN,r);else if(this.isExtendedWesternEuropeanChar_(t,r))this.handleExtendedWesternEuropeanChar_(t,r);else{if(this.isMiscellaneous_(t,r))return this.controlMiscellaneous_(e);this.isOffset_(t,r)&&this.handleOffset_(r-32)}return null},shaka.cea.Cea608DataChannel.prototype.isMiscellaneous_=function(e,t){return 20==(246&e)&&32==(240&t)},shaka.cea.Cea608DataChannel.prototype.isOffset_=function(e,t){return(23==e||31==e)&&33<=t&&35>=t},shaka.cea.Cea608DataChannel.prototype.isPAC_=function(e,t){return 16==(240&e)&&64==(192&t)},shaka.cea.Cea608DataChannel.prototype.isMidrowStyleChange_=function(e,t){return 17==(247&e)&&32==(240&t)},shaka.cea.Cea608DataChannel.prototype.isBackgroundAttribute_=function(e,t){return 16==(247&e)&&32==(240&t)||23==(247&e)&&45==(255&t)},shaka.cea.Cea608DataChannel.prototype.isSpecialNorthAmericanChar_=function(e,t){return 17==(247&e)&&48==(240&t)},shaka.cea.Cea608DataChannel.prototype.isExtendedWesternEuropeanChar_=function(e,t){return 18==(246&e)&&32==(224&t)},shaka.cea.Cea608DataChannel.isControlCode=function(e){return 16==(112&e)},shaka.cea.Cea608DataChannel.isXdsControlCode=function(e){return 1<=e&&15>=e},shaka.cea.Cea608DataChannel.MiscCmd_={RCL:32,BS:33,AOD:34,AON:35,DER:36,RU2:37,RU3:38,RU4:39,FON:40,RDC:41,TR:42,RTD:43,EDM:44,CR:45,ENM:46,EOC:47},shaka.cea.Cea608DataChannel.CaptionType={NONE:0,POPON:1,PAINTON:2,ROLLUP:3,TEXT:4},shaka.cea.Cea608DataChannel.BG_COLORS="black green blue cyan red yellow magenta black".split(" "),shaka.cea.Cea608DataChannel.TEXT_COLORS="white green blue cyan red yellow magenta white_italics".split(" "),shaka.cea.Cea708Window=function(e,t){this.parentService_=t,this.windowNum_=e,this.relativeToggle_=this.visible_=!1,this.colCount_=this.rowCount_=this.anchorId_=this.verticalAnchor_=this.horizontalAnchor_=0,this.justification_=shaka.cea.Cea708Window.TextJustification.CENTER,this.memory_=[],this.col_=this.row_=this.startTime_=0,this.underline_=this.italics_=!1,this.textColor_=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,this.backgroundColor_=shaka.cea.CeaUtils.DEFAULT_BG_COLOR,this.resetMemory()},shaka.cea.Cea708Window.prototype.defineWindow=function(e,t,r,n,a,i,s){this.visible_=e,this.verticalAnchor_=t,this.horizontalAnchor_=r,this.anchorId_=n,this.relativeToggle_=a,this.rowCount_=i,this.colCount_=s},shaka.cea.Cea708Window.prototype.resetMemory=function(){this.memory_=[];for(var e=0;e<shaka.cea.Cea708Window.MAX_ROWS;e++)this.memory_.push(this.createNewRow_())},shaka.cea.Cea708Window.prototype.createNewRow_=function(){for(var e=[],t=0;t<shaka.cea.Cea708Window.MAX_COLS;t++)e.push(null);return e},shaka.cea.Cea708Window.prototype.setCharacter=function(e){this.isPenInBounds_()&&(e=new shaka.cea.CeaUtils.StyledChar(e,this.underline_,this.italics_,this.backgroundColor_,this.textColor_),this.memory_[this.row_][this.col_]=e,this.col_++)},shaka.cea.Cea708Window.prototype.backspace=function(){!this.isPenInBounds_()||0>=this.col_&&0>=this.row_||(0>=this.col_?(this.col_=this.colCount_-1,this.row_--):this.col_--,this.memory_[this.row_][this.col_]=null)},shaka.cea.Cea708Window.prototype.isPenInBounds_=function(){var e=this.col_<this.colCount_&&0<=this.col_;return this.row_<this.rowCount_&&0<=this.row_&&e},shaka.cea.Cea708Window.prototype.isVisible=function(){return this.visible_},shaka.cea.Cea708Window.prototype.moveUpRows_=function(e){for(var t=0,r=e;r<shaka.cea.Cea708Window.MAX_ROWS;r++,t++)this.memory_[t]=this.memory_[r];for(r=0;r<e;r++,t++)this.memory_[t]=this.createNewRow_()},shaka.cea.Cea708Window.prototype.carriageReturn=function(){this.row_+1>=this.rowCount_?this.moveUpRows_(1):this.row_++,this.col_=0},shaka.cea.Cea708Window.prototype.horizontalCarriageReturn=function(){this.memory_[this.row_]=this.createNewRow_(),this.col_=0},shaka.cea.Cea708Window.prototype.forceEmit=function(e,t){t="svc"+t;var r=shaka.cea.Cea708Window.TextJustification,n=new shaka.text.Cue(this.startTime_,e,"");return n.textAlign=this.justification_===r.LEFT?shaka.text.Cue.textAlign.LEFT:this.justification_===r.RIGHT?shaka.text.Cue.textAlign.RIGHT:shaka.text.Cue.textAlign.CENTER,this.adjustRegion_(n.region),(t=shaka.cea.CeaUtils.getParsedCaption(n,t,this.memory_,this.startTime_,e))&&this.setStartTime(e),t},shaka.cea.Cea708Window.prototype.setPenLocation=function(e,t){this.row_=e,this.col_=t},shaka.cea.Cea708Window.prototype.setPenBackgroundColor=function(e){this.backgroundColor_=e},shaka.cea.Cea708Window.prototype.setPenTextColor=function(e){this.textColor_=e},shaka.cea.Cea708Window.prototype.setPenUnderline=function(e){this.underline_=e},shaka.cea.Cea708Window.prototype.setPenItalics=function(e){this.italics_=e},shaka.cea.Cea708Window.prototype.resetPen=function(){this.col_=this.row_=0,this.italics_=this.underline_=!1,this.textColor_=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,this.backgroundColor_=shaka.cea.CeaUtils.DEFAULT_BG_COLOR},shaka.cea.Cea708Window.prototype.setJustification=function(e){this.justification_=e},shaka.cea.Cea708Window.prototype.display=function(){this.visible_=!0},shaka.cea.Cea708Window.prototype.hide=function(){this.visible_=!1},shaka.cea.Cea708Window.prototype.toggle=function(){this.visible_=!this.visible_},shaka.cea.Cea708Window.prototype.setStartTime=function(e){this.startTime_=e},shaka.cea.Cea708Window.prototype.adjustRegion_=function(e){this.parentService_&&(e.id+="svc"+this.parentService_),e.id+="win"+this.windowNum_,e.height=this.rowCount_,e.width=this.colCount_,e.heightUnits=shaka.text.CueRegion.units.LINES,e.widthUnits=shaka.text.CueRegion.units.LINES,e.viewportAnchorX=this.horizontalAnchor_,e.viewportAnchorY=this.verticalAnchor_,e.viewportAnchorUnits=this.relativeToggle_?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.LINES;var t=shaka.cea.Cea708Window.AnchorId;switch(this.anchorId_){case t.UPPER_LEFT:e.regionAnchorX=0,e.regionAnchorY=0;break;case t.UPPER_CENTER:e.regionAnchorX=50,e.regionAnchorY=0;break;case t.UPPER_RIGHT:e.regionAnchorX=100,e.regionAnchorY=0;break;case t.MIDDLE_LEFT:e.regionAnchorX=0,e.regionAnchorY=50;break;case t.MIDDLE_CENTER:e.regionAnchorX=50,e.regionAnchorY=50;break;case t.MIDDLE_RIGHT:e.regionAnchorX=100,e.regionAnchorY=50;break;case t.LOWER_LEFT:e.regionAnchorX=0,e.regionAnchorY=100;break;case t.LOWER_CENTER:e.regionAnchorX=50,e.regionAnchorY=100;break;case t.LOWER_RIGHT:e.regionAnchorX=100,e.regionAnchorY=100}},shaka.cea.Cea708Window.TextJustification={LEFT:0,RIGHT:1,CENTER:2,FULL:3},shaka.cea.Cea708Window.AnchorId={UPPER_LEFT:0,UPPER_CENTER:1,UPPER_RIGHT:2,MIDDLE_LEFT:3,MIDDLE_CENTER:4,MIDDLE_RIGHT:5,LOWER_LEFT:6,LOWER_CENTER:7,LOWER_RIGHT:8},shaka.cea.Cea708Window.MAX_COLS=42,shaka.cea.Cea708Window.MAX_ROWS=16,shaka.cea.DtvccPacketBuilder=function(){this.builtPackets_=[],this.currentPacketBeingBuilt_=null,this.bytesLeftToAddInCurrentPacket_=0},shaka.cea.DtvccPacketBuilder.prototype.addByte=function(e){e.type===shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_START?(this.bytesLeftToAddInCurrentPacket_=2*(63&e.value)-1,this.currentPacketBeingBuilt_=[]):this.currentPacketBeingBuilt_&&(0<this.bytesLeftToAddInCurrentPacket_&&(this.currentPacketBeingBuilt_.push(e),this.bytesLeftToAddInCurrentPacket_--),0===this.bytesLeftToAddInCurrentPacket_&&(e=new shaka.cea.DtvccPacket(this.currentPacketBeingBuilt_),this.builtPackets_.push(e),this.currentPacketBeingBuilt_=null,this.bytesLeftToAddInCurrentPacket_=0))},shaka.cea.DtvccPacketBuilder.prototype.getBuiltPackets=function(){return this.builtPackets_},shaka.cea.DtvccPacketBuilder.prototype.clearBuiltPackets=function(){this.builtPackets_=[]},shaka.cea.DtvccPacketBuilder.prototype.clear=function(){this.builtPackets_=[],this.currentPacketBeingBuilt_=[],this.bytesLeftToAddInCurrentPacket_=0},shaka.cea.DtvccPacket=function(e){this.pos_=0,this.packetData_=e},shaka.cea.DtvccPacket.prototype.hasMoreData=function(){return this.pos_<this.packetData_.length},shaka.cea.DtvccPacket.prototype.getPosition=function(){return this.pos_},shaka.cea.DtvccPacket.prototype.readByte=function(){if(!this.hasMoreData())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS);return this.packetData_[this.pos_++]},shaka.cea.DtvccPacket.prototype.skip=function(e){if(this.pos_+e>this.packetData_.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS);this.pos_+=e},shaka.cea.DtvccPacket.prototype.rewind=function(e){if(0>this.pos_-e)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS);this.pos_-=e},shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_DATA=2,shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_START=3,shaka.cea.Cea708Service=function(e){this.serviceNumber_=e,this.windows_=[null,null,null,null,null,null,null,null],this.currentWindow_=null},shaka.cea.Cea708Service.prototype.handleCea708ControlCode=function(e){var t=e.readByte(),r=t.value;(t=t.pts,r===shaka.cea.Cea708Service.EXT_CEA708_CTRL_CODE_BYTE1)&&(r=r<<16|e.readByte().value);return 0<=r&&31>=r?this.handleC0_(e,r,t):128<=r&&159>=r?this.handleC1_(e,r,t):(4096<=r&&4127>=r?this.handleC2_(e,255&r):4224<=r&&4255>=r?this.handleC3_(e,255&r):32<=r&&127>=r?this.handleG0_(r):160<=r&&255>=r?this.handleG1_(r):4128<=r&&4223>=r?this.handleG2_(255&r):4256<=r&&4351>=r&&this.handleG3_(255&r),[])},shaka.cea.Cea708Service.prototype.handleG0_=function(e){this.currentWindow_&&(127===e?this.currentWindow_.setCharacter(""):this.currentWindow_.setCharacter(String.fromCharCode(e)))},shaka.cea.Cea708Service.prototype.handleG1_=function(e){this.currentWindow_&&this.currentWindow_.setCharacter(String.fromCharCode(e))},shaka.cea.Cea708Service.prototype.handleG2_=function(e){this.currentWindow_&&(shaka.cea.Cea708Service.G2Charset.has(e)?(e=shaka.cea.Cea708Service.G2Charset.get(e),this.currentWindow_.setCharacter(e)):this.currentWindow_.setCharacter("_"))},shaka.cea.Cea708Service.prototype.handleG3_=function(e){this.currentWindow_&&(160!=e?this.currentWindow_.setCharacter("_"):this.currentWindow_.setCharacter("[CC]"))},shaka.cea.Cea708Service.prototype.handleC0_=function(e,t,r){if(!this.currentWindow_)return[];if(24==t)return t=e.readByte().value,r=e.readByte().value,t=[t,r].map((function(e){return("0"+(255&e).toString(16)).slice(-2)})).join(""),t=String.fromCharCode(parseInt(t,16)),this.currentWindow_.setCharacter(t),[];e=this.currentWindow_;var n=null;switch(t){case shaka.cea.Cea708Service.ASCII_BACKSPACE:e.backspace();break;case shaka.cea.Cea708Service.ASCII_CARRIAGE_RETURN:e.isVisible()&&(n=e.forceEmit(r,this.serviceNumber_)),e.carriageReturn();break;case shaka.cea.Cea708Service.ASCII_HOR_CARRIAGE_RETURN:e.isVisible()&&(n=e.forceEmit(r,this.serviceNumber_)),e.horizontalCarriageReturn();break;case shaka.cea.Cea708Service.ASCII_FORM_FEED:e.isVisible()&&(n=e.forceEmit(r,this.serviceNumber_)),e.resetMemory(),e.setPenLocation(0,0)}return n?[n]:[]},shaka.cea.Cea708Service.prototype.handleC1_=function(e,t,r){if(128<=t&&135>=t)this.setCurrentWindow_(7&t);else{if(136===t)return e=e.readByte().value,this.clearWindows_(e,r);if(137===t)e=e.readByte().value,this.displayWindows_(e,r);else{if(138===t)return e=e.readByte().value,this.hideWindows_(e,r);if(139===t)return e=e.readByte().value,this.toggleWindows_(e,r);if(140===t)return e=e.readByte().value,this.deleteWindows_(e,r);if(143===t)return this.reset_(r);144===t?this.setPenAttributes_(e):145===t?this.setPenColor_(e):146===t?this.setPenLocation_(e):151===t?this.setWindowAttributes_(e):152<=t&&159>=t&&this.defineWindow_(e,(15&t)-8,r)}}return[]},shaka.cea.Cea708Service.prototype.handleC2_=function(e,t){8<=t&&15>=t?e.skip(1):16<=t&&23>=t?e.skip(2):24<=t&&31>=t&&e.skip(3)},shaka.cea.Cea708Service.prototype.handleC3_=function(e,t){128<=t&&135>=t?e.skip(4):136<=t&&143>=t&&e.skip(5)},shaka.cea.Cea708Service.prototype.setCurrentWindow_=function(e){this.windows_[e]&&(this.currentWindow_=this.windows_[e])},shaka.cea.Cea708Service.prototype.getSpecifiedWindowIds_=function(e){for(var t=[],r=0;8>r;r++)1==(1&e)&&this.windows_[r]&&t.push(r),e>>=1;return t},shaka.cea.Cea708Service.prototype.clearWindows_=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!n.done;n=e.next()){if((n=this.windows_[n.value]).isVisible()){var a=n.forceEmit(t,this.serviceNumber_);a&&r.push(a)}n.resetMemory()}return r},shaka.cea.Cea708Service.prototype.displayWindows_=function(e,t){for(var r=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!r.done;r=e.next())(r=this.windows_[r.value]).isVisible()||r.setStartTime(t),r.display()},shaka.cea.Cea708Service.prototype.hideWindows_=function(e,t){for(var r=null,n=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!n.done;n=e.next())(n=this.windows_[n.value]).isVisible()&&(r=n.forceEmit(t,this.serviceNumber_)),n.hide();return r?[r]:[]},shaka.cea.Cea708Service.prototype.toggleWindows_=function(e,t){for(var r=null,n=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!n.done;n=e.next())(n=this.windows_[n.value]).isVisible()?r=n.forceEmit(t,this.serviceNumber_):n.setStartTime(t),n.toggle();return r?[r]:[]},shaka.cea.Cea708Service.prototype.deleteWindows_=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!n.done;n=e.next()){n=n.value;var a=this.windows_[n];a.isVisible()&&(a=a.forceEmit(t,this.serviceNumber_))&&r.push(a),this.windows_[n]=null}return r},shaka.cea.Cea708Service.prototype.reset_=function(e){return e=this.deleteWindows_(255,e),this.clear(),e},shaka.cea.Cea708Service.prototype.clear=function(){this.currentWindow_=null,this.windows_=[null,null,null,null,null,null,null,null]},shaka.cea.Cea708Service.prototype.setPenAttributes_=function(e){if(e.skip(1),e=e.readByte().value,this.currentWindow_){var t=0<(64&e);this.currentWindow_.setPenItalics(0<(128&e)),this.currentWindow_.setPenUnderline(t)}},shaka.cea.Cea708Service.prototype.setPenColor_=function(e){var t=e.readByte().value,r=e.readByte().value;if(e.skip(1),this.currentWindow_){e=3&r;var n=(12&r)>>2;r=(48&r)>>4,t=this.rgbColorToHex_((48&t)>>4,(12&t)>>2,3&t),e=this.rgbColorToHex_(r,n,e),this.currentWindow_.setPenTextColor(t),this.currentWindow_.setPenBackgroundColor(e)}},shaka.cea.Cea708Service.prototype.setPenLocation_=function(e){var t=e.readByte().value;e=e.readByte().value,this.currentWindow_&&this.currentWindow_.setPenLocation(15&t,63&e)},shaka.cea.Cea708Service.prototype.setWindowAttributes_=function(e){e.skip(1),e.skip(1);var t=e.readByte().value;e.skip(1),this.currentWindow_&&this.currentWindow_.setJustification(3&t)},shaka.cea.Cea708Service.prototype.defineWindow_=function(e,t,r){var n=null!==this.windows_[t];if(!n){var a=new shaka.cea.Cea708Window(t,this.serviceNumber_);a.setStartTime(r),this.windows_[t]=a}var i=e.readByte().value,s=e.readByte().value;r=e.readByte().value;var o=e.readByte().value;a=e.readByte().value,e=e.readByte().value,i=0<(32&i);var l=127&s;s=0<(128&s);var u=1+(15&o);o=(240&o)>>4,a=1+(63&a),n&&0==(7&e)||this.windows_[t].resetPen(),this.windows_[t].defineWindow(i,l,r,o,s,u,a),this.currentWindow_=this.windows_[t]},shaka.cea.Cea708Service.prototype.rgbColorToHex_=function(e,t,r){var n={0:0,1:0,2:1,3:1};return e=n[e],t=n[t],r=n[r],shaka.cea.Cea708Service.Colors[e<<2|t<<1|r]},shaka.cea.Cea708Service.ASCII_BACKSPACE=8,shaka.cea.Cea708Service.ASCII_FORM_FEED=12,shaka.cea.Cea708Service.ASCII_CARRIAGE_RETURN=13,shaka.cea.Cea708Service.ASCII_HOR_CARRIAGE_RETURN=14,shaka.cea.Cea708Service.EXT_CEA708_CTRL_CODE_BYTE1=16,shaka.cea.Cea708Service.G2Charset=new Map([[32," "],[33,""],[37,""],[42,""],[44,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[57,""],[58,""],[60,""],[61,""],[63,""],[118,""],[119,""],[120,""],[121,""],[122,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),shaka.cea.Cea708Service.Colors="black blue green cyan red magenta yellow white".split(" "),shaka.cea.CeaDecoder=function(){this.cea608DataArray_=[],this.cea708DataArray_=[],this.dtvccPacketBuilder_=new shaka.cea.DtvccPacketBuilder,this.badFrames_=0,this.cea608ModeToStream_=new Map([["CC1",new shaka.cea.Cea608DataChannel(0,0)],["CC2",new shaka.cea.Cea608DataChannel(0,1)],["CC3",new shaka.cea.Cea608DataChannel(1,0)],["CC4",new shaka.cea.Cea608DataChannel(1,1)]]),this.currentField2Channel_=this.currentField1Channel_=0,this.serviceNumberToService_=new Map,this.waitingForFirstPacket_=!0,this.streams_=new Set,this.reset()},shaka.cea.CeaDecoder.prototype.clear=function(){shaka.log.debug("Clearing CEA decoder"),this.badFrames_=0,this.cea608DataArray_=[],this.cea708DataArray_=[],this.dtvccPacketBuilder_.clear(),this.reset();for(var e=$jscomp.makeIterator(this.serviceNumberToService_.values()),t=e.next();!t.done;t=e.next())t.value.clear()},shaka.cea.CeaDecoder.prototype.reset=function(){shaka.log.debug("Resetting CEA decoder"),this.currentField2Channel_=this.currentField1Channel_=0;for(var e=$jscomp.makeIterator(this.cea608ModeToStream_.values()),t=e.next();!t.done;t=e.next())t.value.reset();this.waitingForFirstPacket_=!0},shaka.cea.CeaDecoder.prototype.extract=function(e,t){if(this.waitingForFirstPacket_){shaka.log.debug("Setting first pts value to",t);for(var r=$jscomp.makeIterator(this.cea608ModeToStream_.values()),n=r.next();!n.done;n=r.next())n.value.firstPts(t);this.waitingForFirstPacket_=!1}if(!((e=new shaka.util.DataViewReader(e,shaka.util.DataViewReader.Endianness.BIG_ENDIAN)).getLength()<shaka.cea.CeaDecoder.MIN_LENGTH)&&e.readUint8()===shaka.cea.CeaDecoder.USA_COUNTRY_CODE&&e.readUint16()===shaka.cea.CeaDecoder.ATSC_PROVIDER_CODE&&e.readUint32()===shaka.cea.CeaDecoder.ATSC1_USER_IDENTIFIER&&3===e.readUint8()&&0!=(64&(r=e.readUint8())))for(r&=31,e.skip(1),n=0;n<r;n++){var a=e.readUint8(),i=(4&a)>>2,s=e.readUint8(),o=e.readUint8();i&&((a&=3)===shaka.cea.CeaDecoder.NTSC_CC_FIELD_1||a===shaka.cea.CeaDecoder.NTSC_CC_FIELD_2?this.cea608DataArray_.push({pts:t,type:a,ccData1:s,ccData2:o,order:this.cea608DataArray_.length}):(this.cea708DataArray_.push({pts:t,type:a,value:s,order:this.cea708DataArray_.length}),this.cea708DataArray_.push({pts:t,type:shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_DATA,value:o,order:this.cea708DataArray_.length})))}},shaka.cea.CeaDecoder.prototype.decode=function(){var e=[],t=function(e,t){return e.pts-t.pts||e.order-t.order};this.cea608DataArray_.sort(t),this.cea708DataArray_.sort(t);for(var r=(t=$jscomp.makeIterator(this.cea608DataArray_)).next();!r.done;r=t.next())(r=this.decodeCea608_(r.value))&&e.push(r);for(r=(t=$jscomp.makeIterator(this.cea708DataArray_)).next();!r.done;r=t.next())this.dtvccPacketBuilder_.addByte(r.value);for(t=this.dtvccPacketBuilder_.getBuiltPackets(),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=this.decodeCea708_(r.value),e.push.apply(e,$jscomp.arrayFromIterable(r));return this.dtvccPacketBuilder_.clearBuiltPackets(),this.cea608DataArray_=[],this.cea708DataArray_=[],e},shaka.cea.CeaDecoder.prototype.decodeCea608_=function(e){var t=e.type;if(shaka.cea.Cea608DataChannel.isControlCode(e.ccData1)){var r=e.ccData1>>3&1;0===t?this.currentField1Channel_=r:this.currentField2Channel_=r}if(t="CC"+(1+(t<<1|(t?this.currentField2Channel_:this.currentField1Channel_))),r=this.cea608ModeToStream_.get(t),255===e.ccData1&&255===e.ccData2||!e.ccData1&&!e.ccData2||!this.isOddParity_(e.ccData1)||!this.isOddParity_(e.ccData2))return 45<=++this.badFrames_&&this.reset(),null;if(this.badFrames_=0,e.ccData1&=127,e.ccData2&=127,shaka.cea.Cea608DataChannel.isXdsControlCode(e.ccData1)||!e.ccData1&&!e.ccData2)return null;var n=null;return shaka.cea.Cea608DataChannel.isControlCode(e.ccData1)?(this.streams_.add(t),n=r.handleControlCode(e)):r.handleBasicNorthAmericanChar(e.ccData1,e.ccData2),n},shaka.cea.CeaDecoder.prototype.decodeCea708_=function(e){var t=[];try{for(;e.hasMoreData();){var r=e.readByte().value,n=(224&r)>>5,a=31&r;if(7===n&&0!=a&&(n=63&e.readByte().value),0!=n){if(this.streams_.add("svc"+n),!this.serviceNumberToService_.has(n)){var i=new shaka.cea.Cea708Service(n);this.serviceNumberToService_.set(n,i)}for(var s=this.serviceNumberToService_.get(n),o=e.getPosition();e.getPosition()-o<a;){var l=s.handleCea708ControlCode(e);t.push.apply(t,$jscomp.arrayFromIterable(l))}}}}catch(e){if(!(e instanceof shaka.util.Error&&e.code===shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS))throw e;shaka.log.warnOnce("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return t},shaka.cea.CeaDecoder.prototype.isOddParity_=function(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t},shaka.cea.CeaDecoder.prototype.getStreams=function(){return Array.from(this.streams_)},goog.exportSymbol("shaka.cea.CeaDecoder",shaka.cea.CeaDecoder),shaka.cea.CeaDecoder.ATSC_PROVIDER_CODE=49,shaka.cea.CeaDecoder.ATSC1_USER_IDENTIFIER=1195456820,shaka.cea.CeaDecoder.NTSC_CC_FIELD_1=0,shaka.cea.CeaDecoder.NTSC_CC_FIELD_2=1,shaka.cea.CeaDecoder.USA_COUNTRY_CODE=181,shaka.cea.CeaDecoder.MIN_LENGTH=8,shaka.media.ClosedCaptionParser.registerDecoder((function(){return new shaka.cea.CeaDecoder})),shaka.cea.SeiProcessor=function(){},shaka.cea.SeiProcessor.prototype.process=function(e){var t=[];e=this.removeEmu(e);for(var r=0;r<e.length;){for(var n=0;255==e[r];)n+=255,r++;n+=e[r++];for(var a=0;255==e[r];)a+=255,r++;a+=e[r++],4==n&&t.push(e.subarray(r,r+a)),r+=a}return t},shaka.cea.SeiProcessor.prototype.removeEmu=function(e){for(var t=e,r=e=0;r<t.length;)2==e&&3==t[r]?(e=0,(t=[].concat($jscomp.arrayFromIterable(t))).splice(r,1),t=new Uint8Array(t)):0==t[r]?e++:e=0,r++;return t},shaka.cea.Mp4CeaParser=function(){this.seiProcessor_=new shaka.cea.SeiProcessor,this.trackIdToTimescale_=new Map,this.defaultSampleSize_=this.defaultSampleDuration_=0,this.bitstreamFormat_=shaka.cea.Mp4CeaParser.BitstreamFormat.UNKNOWN},shaka.cea.Mp4CeaParser.prototype.init=function(e){var t=this,r=shaka.util.Mp4Parser,n=shaka.cea.Mp4CeaParser.BitstreamFormat,a=[],i=[],s=function(e){return t.setBitstreamFormat_(e.name)};if((new r).box("moov",r.children).box("mvex",r.children).fullBox("trex",(function(e){e=shaka.util.Mp4BoxParsers.parseTREX(e.reader),t.defaultSampleDuration_=e.defaultSampleDuration,t.defaultSampleSize_=e.defaultSampleSize})).box("trak",r.children).fullBox("tkhd",(function(e){goog.asserts.assert(null!=e.version,"TKHD is a full box and should have a valid version."),e=shaka.util.Mp4BoxParsers.parseTKHD(e.reader,e.version),a.push(e.trackId)})).box("mdia",r.children).fullBox("mdhd",(function(e){goog.asserts.assert(null!=e.version,"MDHD is a full box and should have a valid version."),e=shaka.util.Mp4BoxParsers.parseMDHD(e.reader,e.version),i.push(e.timescale)})).box("minf",r.children).box("stbl",r.children).fullBox("stsd",r.sampleDescription).box("avc1",s).box("avc3",s).box("dvav",s).box("dva1",s).box("hev1",s).box("hvc1",s).box("dvh1",s).box("dvhe",s).box("vvc1",s).box("vvi1",s).box("dvc1",s).box("dvi1",s).box("encv",r.visualSampleEntry).box("sinf",r.children).box("frma",(function(e){e=shaka.util.Mp4BoxParsers.parseFRMA(e.reader).codec,t.setBitstreamFormat_(e)})).parse(e,!0),!a.length||!i.length||a.length!=i.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_CEA);this.bitstreamFormat_==n.UNKNOWN&&shaka.log.alwaysWarn("Unable to determine bitstream format for CEA parsing!"),a.forEach((function(e,r){t.trackIdToTimescale_.set(e,i[r])}))},shaka.cea.Mp4CeaParser.prototype.parse=function(e){var t=this,r=shaka.util.Mp4Parser;if(this.bitstreamFormat_==shaka.cea.Mp4CeaParser.BitstreamFormat.UNKNOWN)return[];var n=[],a=0,i=[];return(new r).box("moof",(function(e){a=e.start,i=[],r.children(e)})).box("traf",(function(e){i.push({baseMediaDecodeTime:null,defaultSampleDuration:t.defaultSampleDuration_,defaultSampleSize:t.defaultSampleSize_,parsedTRUNs:[],timescale:shaka.cea.CeaUtils.DEFAULT_TIMESCALE_VALUE}),r.children(e)})).fullBox("trun",(function(e){goog.asserts.assert(null!=e.version&&null!=e.flags,"TRUN is a full box and should have a valid version & flags.");var t=i[i.length-1];e=shaka.util.Mp4BoxParsers.parseTRUN(e.reader,e.version,e.flags),t.parsedTRUNs.push(e)})).fullBox("tfhd",(function(e){goog.asserts.assert(null!=e.flags,"TFHD is a full box and should have valid flags.");var r=i[i.length-1];e=shaka.util.Mp4BoxParsers.parseTFHD(e.reader,e.flags),r.defaultSampleDuration=e.defaultSampleDuration||t.defaultSampleDuration_,r.defaultSampleSize=e.defaultSampleSize||t.defaultSampleSize_,e=e.trackId,t.trackIdToTimescale_.has(e)&&(r.timescale=t.trackIdToTimescale_.get(e))})).fullBox("tfdt",(function(e){goog.asserts.assert(null!=e.version,"TFDT is a full box and should have a valid version.");var t=i[i.length-1];e=shaka.util.Mp4BoxParsers.parseTFDTInaccurate(e.reader,e.version),t.baseMediaDecodeTime=e.baseMediaDecodeTime})).box("mdat",(function(e){for(var r=a-e.start-8,s=e.reader.getPosition(),o=$jscomp.makeIterator(i),l=o.next();!l.done;l=o.next()){if(null===(l=l.value).baseMediaDecodeTime)throw shaka.log.alwaysWarn("Unable to find base media decode time for CEA captions!"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_CEA);e.reader.seek(s),t.parseMdat_(e.reader,l.baseMediaDecodeTime,l.timescale,l.defaultSampleDuration,l.defaultSampleSize,r,l.parsedTRUNs,n)}})).parse(e,!1),n},shaka.cea.Mp4CeaParser.prototype.parseMdat_=function(e,t,r,n,a,i,s,o){var l=shaka.cea.Mp4CeaParser.BitstreamFormat,u=shaka.cea.CeaUtils,c=0,d=a,p=s.map((function(e){return e.sampleData}));for((p=[].concat.apply([],$jscomp.arrayFromIterable(p))).length&&(d=p[0].sampleSize||a),e.skip(i+s[0].dataOffset);e.hasMoreData();){i=e.readUint32();var h=e.readUint8(),f=null;switch(f=!1,s=1,goog.asserts.assert(this.bitstreamFormat_!=l.UNKNOWN,"Bitstream format should have been checked before now!"),this.bitstreamFormat_){case l.H264:f=(f=31&h)==u.H264_NALU_TYPE_SEI;break;case l.H265:s=2,e.skip(1),f=(f=h>>1&63)==u.H265_PREFIX_NALU_TYPE_SEI||f==u.H265_SUFFIX_NALU_TYPE_SEI;break;case l.H266:s=2,e.skip(1),f=(f=h>>1&63)==u.H266_PREFIX_NALU_TYPE_SEI||f==u.H266_SUFFIX_NALU_TYPE_SEI;break;default:return}if(f)for(h=0,c<p.length&&(h=p[c].sampleCompositionTimeOffset||0),h=(t+h)/r,f=(s=$jscomp.makeIterator(this.seiProcessor_.process(e.readBytes(i-s)))).next();!f.done;f=s.next())o.push({packet:f.value,pts:h});else try{e.skip(i-s)}catch(e){break}0==(d-=i+4)&&(t=c<p.length?t+(p[c].sampleDuration||n):t+n,d=++c<p.length&&p[c].sampleSize||a)}},shaka.cea.Mp4CeaParser.prototype.setBitstreamFormat_=function(e){shaka.cea.Mp4CeaParser.CodecBitstreamMap_.has(e)&&(this.bitstreamFormat_=shaka.cea.Mp4CeaParser.CodecBitstreamMap_.get(e))},goog.exportSymbol("shaka.cea.Mp4CeaParser",shaka.cea.Mp4CeaParser),shaka.cea.Mp4CeaParser.BitstreamFormat={UNKNOWN:0,H264:1,H265:2,H266:3},shaka.cea.Mp4CeaParser.CodecBitstreamMap_=(new Map).set("avc1",shaka.cea.Mp4CeaParser.BitstreamFormat.H264).set("avc3",shaka.cea.Mp4CeaParser.BitstreamFormat.H264).set("dvav",shaka.cea.Mp4CeaParser.BitstreamFormat.H264).set("dva1",shaka.cea.Mp4CeaParser.BitstreamFormat.H264).set("hev1",shaka.cea.Mp4CeaParser.BitstreamFormat.H265).set("hvc1",shaka.cea.Mp4CeaParser.BitstreamFormat.H265).set("dvh1",shaka.cea.Mp4CeaParser.BitstreamFormat.H265).set("dvhe",shaka.cea.Mp4CeaParser.BitstreamFormat.H265).set("vvc1",shaka.cea.Mp4CeaParser.BitstreamFormat.H266).set("vvi1",shaka.cea.Mp4CeaParser.BitstreamFormat.H266).set("dvc1",shaka.cea.Mp4CeaParser.BitstreamFormat.H266).set("dvi1",shaka.cea.Mp4CeaParser.BitstreamFormat.H266),shaka.media.ClosedCaptionParser.registerParser("video/mp4",(function(){return new shaka.cea.Mp4CeaParser})),shaka.cea.TsCeaParser=function(){this.seiProcessor_=new shaka.cea.SeiProcessor,this.tsParser_=null},shaka.cea.TsCeaParser.prototype.init=function(e){},shaka.cea.TsCeaParser.prototype.parse=function(e){var t=shaka.cea.CeaUtils;this.tsParser_?this.tsParser_.clearData():this.tsParser_=new shaka.util.TsParser;var r=[];if(e=shaka.util.BufferUtils.toUint8(e),!shaka.util.TsParser.probe(e))return r;var n=(e=this.tsParser_.parse(e)).getCodecs(),a=e.getVideoNalus();switch(e=[],n.video){case"avc":e.push(t.H264_NALU_TYPE_SEI);break;case"hvc":e.push(t.H265_PREFIX_NALU_TYPE_SEI),e.push(t.H265_SUFFIX_NALU_TYPE_SEI)}if(!e.length)return r;for(n=(t=$jscomp.makeIterator(a)).next();!n.done;n=t.next())if(n=n.value,e.includes(n.type)&&null!=n.time)for(var i=(a=$jscomp.makeIterator(this.seiProcessor_.process(n.data))).next();!i.done;i=a.next())r.push({packet:i.value,pts:n.time});return r},goog.exportSymbol("shaka.cea.TsCeaParser",shaka.cea.TsCeaParser),shaka.media.ClosedCaptionParser.registerParser("video/mp2t",(function(){return new shaka.cea.TsCeaParser})),shaka.drm.PlayReady=function(){},shaka.drm.PlayReady.parseMsProRecords_=function(e,t){for(var r=[];t<e.byteLength-1;){var n=e.getUint16(t,!0);t+=2;var a=e.getUint16(t,!0);if(t+=2,0!=(1&a)||a+t>e.byteLength)return shaka.log.warning("Malformed MS PRO object"),[];var i=shaka.util.BufferUtils.toUint8(e,t,a);r.push({type:n,value:i}),t+=a}return r},shaka.drm.PlayReady.parseMsPro_=function(e){var t=0,r=shaka.util.BufferUtils.toDataView(e),n=r.getUint32(t,!0);return t+=4,n!=e.byteLength?(shaka.log.warning("PlayReady Object with invalid length encountered."),[]):shaka.drm.PlayReady.parseMsProRecords_(r,t+2)},shaka.drm.PlayReady.getLaurl_=function(e){for(var t=(e=$jscomp.makeIterator(shaka.util.TXml.getElementsByTagName(e,"DATA"))).next();!t.done;t=e.next())if((t=t.value).children)for(var r=(t=$jscomp.makeIterator(t.children)).next();!r.done;r=t.next())if("LA_URL"==(r=r.value).tagName)return shaka.util.TXml.getTextContents(r);return""},shaka.drm.PlayReady.getPlayReadyHeaderObject_=function(e){var t=shaka.drm.PlayReady.PLAYREADY_RECORD_TYPES;return e=shaka.util.Uint8ArrayUtils.fromBase64(shaka.util.TXml.getTextContents(e)),(e=shaka.drm.PlayReady.parseMsPro_(e).filter((function(e){return e.type===t.RIGHTS_MANAGEMENT}))[0])?(e=shaka.util.StringUtils.fromUTF16(e.value,!0),(e=shaka.util.TXml.parseXmlString(e,"WRMHEADER"))?e:null):null},shaka.drm.PlayReady.getLicenseUrl=function(e){try{var t=shaka.drm.PlayReady.getPlayReadyHeaderObject_(e);return t?shaka.drm.PlayReady.getLaurl_(t):""}catch(e){return""}},shaka.drm.PlayReady.getPlayReadyKID=function(e){var t=shaka.drm.PlayReady.getPlayReadyHeaderObject_(e);if(!t)return null;e=shaka.util.TXml;for(var r=(t=$jscomp.makeIterator(e.getElementsByTagName(t,"DATA"))).next();!r.done;r=t.next())if(r=e.findChild(r.value,"KID"))return e=shaka.util.Uint8ArrayUtils.fromBase64(shaka.util.TXml.getTextContents(r)),e=new Uint8Array([e[3],e[2],e[1],e[0],e[5],e[4],e[7],e[6]].concat($jscomp.arrayFromIterable(e.slice(8)))),shaka.util.Uint8ArrayUtils.toHex(e);return null},shaka.drm.PlayReady.PLAYREADY_RECORD_TYPES={RIGHTS_MANAGEMENT:1,RESERVED:2,EMBEDDED_LICENSE:3},shaka.dash={},shaka.dash.ContentProtection=function(){},shaka.dash.ContentProtection.parseFromAdaptationSet=function(e,t,r){var n=shaka.dash.ContentProtection,a=shaka.util.ManifestParserUtils,i=n.parseElements_(e),s=null;e=[];var o=[],l=null,u=new Set(i.map((function(e){return e.keyId})));u.delete(null);var c="cenc";if(1<u.size)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_CONFLICTING_KEY_IDS);if(!t){if(1<(o=i.filter((function(e){return e.schemeUri==n.Aes128Protection_}))).length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_CONFLICTING_AES_128);o.length&&(l=n.parseAes128_(o[0])),(o=i.find((function(e){return e.schemeUri==n.MP4Protection_})))&&o.encryptionScheme&&(c=o.encryptionScheme),(o=i.filter((function(e){return e.schemeUri==n.MP4Protection_?(goog.asserts.assert(!e.init||e.init.length,"Init data must be null or non-empty."),s=e.init||s,!1):e.schemeUri!=n.Aes128Protection_}))).length&&(0==(e=n.convertElements_(s,c,o,r,u)).length&&(e=[a.createDrmInfo("",c,s)]))}if(i.length&&!l&&(t||!o.length))for(e=[],r=(t=$jscomp.makeIterator(Object.values(r))).next();!r.done;r=t.next())"org.w3.clearkey"!=(r=r.value)&&(r=a.createDrmInfo(r,c,s),e.push(r));if(a=Array.from(u)[0]||null)for(c=(u=$jscomp.makeIterator(e)).next();!c.done;c=u.next())for(t=(c=$jscomp.makeIterator(c.value.initData)).next();!t.done;t=c.next())t.value.keyId=a;return{defaultKeyId:a,defaultInit:s,drmInfos:e,aes128Info:l,firstRepresentation:!0}},shaka.dash.ContentProtection.parseFromRepresentation=function(e,t,r,n){var a=shaka.dash.ContentProtection.parseFromAdaptationSet(e,r,n);if(t.firstRepresentation)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,r=0==a.drmInfos.length,(0==t.drmInfos.length||e&&!r)&&(t.drmInfos=a.drmInfos),t.firstRepresentation=!1;else if(0<a.drmInfos.length&&(t.drmInfos=t.drmInfos.filter((function(e){return a.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==t.drmInfos.length))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_COMMON_KEY_SYSTEM);return a.defaultKeyId||t.defaultKeyId},shaka.dash.ContentProtection.getFairPlayLicenseUrl=function(e){if(shaka.drm.DrmUtils.isMediaKeysPolyfilled("apple"))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED);return(e=shaka.util.TXml.findChildNS(e.node,shaka.dash.ContentProtection.DashIfNamespaceUri_,"Laurl"))&&(e=shaka.util.TXml.getTextContents(e))?e:""},shaka.dash.ContentProtection.getWidevineLicenseUrl=function(e){var t=shaka.util.StringUtils,r=shaka.util.TXml.findChildNS(e.node,shaka.dash.ContentProtection.DashIfNamespaceUri_,"Laurl");return r&&(r=shaka.util.TXml.getTextContents(r))?r:(e=shaka.util.TXml.findChildNS(e.node,"urn:microsoft","laurl"))&&t.htmlUnescape(e.attributes.licenseUrl)||""},shaka.dash.ContentProtection.getClearKeyLicenseUrl=function(e){var t=shaka.util.TXml.findChildNS(e.node,shaka.dash.ContentProtection.DashIfNamespaceUri_,"Laurl");return t&&(t=shaka.util.TXml.getTextContents(t))?t:(e=shaka.util.TXml.findChildNS(e.node,shaka.dash.ContentProtection.ClearKeyNamespaceUri_,"Laurl"))&&"EME-1.0"===e.attributes.Lic_type&&e&&(e=shaka.util.TXml.getTextContents(e))?e:""},shaka.dash.ContentProtection.getPlayReadyLicenseUrl=function(e){var t=shaka.util.TXml,r=t.findChildNS(e.node,shaka.dash.ContentProtection.DashIfNamespaceUri_,"Laurl");return r&&(r=t.getTextContents(r))?r:(r=t.findChildNS(e.node,"urn:microsoft:playready","pro"))&&t.getTextContents(r)?shaka.drm.PlayReady.getLicenseUrl(r):(e=t.findChildNS(e.node,shaka.dash.ContentProtection.CencNamespaceUri_,"pssh"))&&(e=t.getTextContents(e))?(e=shaka.util.Pssh.getPsshData(shaka.util.Uint8ArrayUtils.fromBase64(e)),e=shaka.util.Uint8ArrayUtils.toStandardBase64(e),t=t.parseXmlString("<pro>"+e+"</pro>"),goog.asserts.assert(t,"Must have pro node"),shaka.drm.PlayReady.getLicenseUrl(t)):""},shaka.dash.ContentProtection.getInitDataFromPro_=function(e){var t=shaka.util.TXml.findChildNS(e.node,"urn:microsoft:playready","pro");if(!t||!shaka.util.TXml.getTextContents(t))return null;var r=shaka.util.Uint8ArrayUtils;t=shaka.util.TXml.getTextContents(t),r=r.fromBase64(t),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);var n=new Set;return[{initData:shaka.util.Pssh.createPssh(r,t,n,0),initDataType:"cenc",keyId:e.keyId}]},shaka.dash.ContentProtection.getInitDataClearKey_=function(e,t){if(0==t.size)return null;var r=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),n=new Uint8Array([]);return[{initData:shaka.util.Pssh.createPssh(n,r,t,1),initDataType:"cenc",keyId:e.keyId}]},shaka.dash.ContentProtection.convertElements_=function(e,t,r,n,a){for(var i=shaka.dash.ContentProtection,s=shaka.util.ManifestParserUtils,o=i.licenseUrlParsers_,l=[],u=(r=$jscomp.makeIterator(r)).next();!u.done;u=r.next()){var c=n[(u=u.value).schemeUri];if(c){goog.asserts.assert(!u.init||u.init.length,"Init data must be null or non-empty.");var d=i.getInitDataFromPro_(u),p=null;u.schemeUri===shaka.dash.ContentProtection.ClearKeySchemeUri_&&(p=i.getInitDataClearKey_(u,a)),d=s.createDrmInfo(c,t,u.init||e||d||p),(c=o.get(c))&&(d.licenseServerUri=c(u)),l.push(d)}}return l},shaka.dash.ContentProtection.parseElements_=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=shaka.dash.ContentProtection.parseElement_(r.value))&&t.push(r);return t},shaka.dash.ContentProtection.parseElement_=function(e){var t=shaka.dash.ContentProtection.CencNamespaceUri_,r=shaka.util.TXml,n=e.attributes.schemeIdUri,a=r.getAttributeNS(e,t,"default_KID");if(t=r.findChildrenNS(e,t,"pssh").map(r.getContents),r=e.attributes.value,!n)return shaka.log.error("Missing required schemeIdUri attribute on","ContentProtection element",e),null;if(n=n.toLowerCase(),a&&(a=a.replace(/-/g,"").toLowerCase()).includes(" "))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED);var i=[];try{i=t.map((function(e){return{initDataType:"cenc",initData:shaka.util.Uint8ArrayUtils.fromBase64(e),keyId:null}}))}catch(e){throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_PSSH_BAD_ENCODING)}return{node:e,schemeUri:n,keyId:a,init:0<i.length?i:null,encryptionScheme:r}},shaka.dash.ContentProtection.parseAes128_=function(e){if(!window.crypto||!window.crypto.subtle)throw shaka.log.alwaysWarn("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.NO_WEB_CRYPTO_API);var t=shaka.util.TXml.findChildNS(e.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_AES_128);if("urn:mpeg:dash:sea:aes128-cbc:2013"!=t.attributes.schemeIdUri)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_AES_128);if(!(t=shaka.util.TXml.findChildNS(e.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_AES_128);if(e=t.attributes.IV,t=shaka.util.StringUtils.htmlUnescape(t.attributes.keyUriTemplate),!e||!t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_AES_128);if(16!=(e=shaka.util.Uint8ArrayUtils.fromHex(e.substr(2))).byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.AES_128_INVALID_IV_LENGTH);return{keyUri:t,iv:e}};shaka.dash.ContentProtection.licenseUrlParsers_=(new Map).set("com.apple.fps",shaka.dash.ContentProtection.getFairPlayLicenseUrl).set("com.widevine.alpha",shaka.dash.ContentProtection.getWidevineLicenseUrl).set("com.microsoft.playready",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.recommendation",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.software",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.hardware",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("org.w3.clearkey",shaka.dash.ContentProtection.getClearKeyLicenseUrl),shaka.dash.ContentProtection.MP4Protection_="urn:mpeg:dash:mp4protection:2011",shaka.dash.ContentProtection.Aes128Protection_="urn:mpeg:dash:sea:2012",shaka.dash.ContentProtection.CencNamespaceUri_="urn:mpeg:cenc:2013",shaka.dash.ContentProtection.ClearKeyNamespaceUri_="http://dashif.org/guidelines/clearKey",shaka.dash.ContentProtection.ClearKeySchemeUri_="urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",shaka.dash.ContentProtection.DashIfNamespaceUri_="https://dashif.org/CPS",shaka.dash.MpdUtils=function(){},shaka.dash.MpdUtils.fillUriTemplate=function(e,t,r,n,a,i){var s=(new Map).set("RepresentationID",t).set("Number",r).set("SubNumber",n).set("Bandwidth",a).set("Time",i);return e.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(t,r,n,a){if("$$"==t)return"$";var i=s.get(r);if(goog.asserts.assert(void 0!==i,"Unrecognized identifier"),null==i)return shaka.log.warning("URL template does not have an available substitution for ",'identifier "'+r+'":',e),t;switch("RepresentationID"==r&&n&&(shaka.log.warning("URL template should not contain a width specifier for identifier",'"RepresentationID":',e),n=void 0),"Time"==r&&"bigint"!=typeof i&&(goog.asserts.assert("number"==typeof i,"Time value should be a number or bigint!"),.2<=Math.abs(i-Math.round(i))&&shaka.log.alwaysWarn("Calculated $Time$ values must be close to integers"),i=Math.round(i)),a){case void 0:case"d":case"i":case"u":t=i.toString();break;case"o":t=i.toString(8);break;case"x":t=i.toString(16);break;case"X":t=i.toString(16).toUpperCase();break;default:goog.asserts.assert(!1,"Unhandled format specifier"),t=i.toString()}return n=window.parseInt(n,10)||1,Array(Math.max(0,n-t.length)+1).join("0")+t}))},shaka.dash.MpdUtils.createTimeline=function(e,t,r,n,a){goog.asserts.assert(0<t&&1/0>t,"timescale must be a positive, finite integer"),goog.asserts.assert(0<n,"period duration must be a positive integer");for(var i=shaka.util.TXml,s=[],o=-r,l=0;l<e.length;++l){var u=e[l],c=e[l+1],d=i.parseAttr(u,"t",i.parseNonNegativeInt),p=i.parseAttr(u,"d",i.parseNonNegativeInt),h=i.parseAttr(u,"r",i.parseInt),f=i.parseAttr(u,"k",i.parseInt)||0;if(null!=d&&(d-=r),p){if(d=null!=d?d:o,0>(h=h||0))if(c){if(null==(c=i.parseAttr(c,"t",i.parseNonNegativeInt))){shaka.log.warning('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',u);break}if(d>=c){shaka.log.warning('An "S" element cannot have a negative repeat if its start ','time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',u);break}h=Math.ceil((c-d)/p)-1}else{if(1/0==n){shaka.log.warning('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',u);break}if(d/t>=n){shaka.log.warning('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'ignoring the last "S" element.',u);break}h=Math.ceil((n*t-d)/p)-1}for(0<s.length&&d!=o&&(Math.abs((d-o)/t)>=shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS&&shaka.log.warning("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",u),s[s.length-1].end=d/t),u=0;u<=h;++u)o=d+p,s.push({start:d/t,end:o/t,unscaledStart:d,partialSegments:f,segmentPosition:s.length+a}),d=o}else shaka.log.warning('"S" element must have a duration: ignoring this element.',u)}return s},shaka.dash.MpdUtils.parseSegmentInfo=function(e,t){goog.asserts.assert(t(e.representation),"There must be at least one element of the given type.");var r=shaka.dash.MpdUtils,n=shaka.util.TXml,a=r.inheritAttribute(e,t,"timescale"),i=1;a&&(i=n.parsePositiveInt(a)||1),a=r.inheritAttribute(e,t,"duration");var s=(a=n.parsePositiveInt(a||""))?a/i:null,o=r.inheritAttribute(e,t,"startNumber"),l=Number(r.inheritAttribute(e,t,"presentationTimeOffset"))||0,u=n.parseNonNegativeInt(o||"");return null!=o&&null!=u||(u=1),o=null,(t=r.inheritChild(e,t,"SegmentTimeline"))&&(n=n.findChildren(t,"S"),o=r.createTimeline(n,i,l,e.periodInfo.duration||1/0,u)),{timescale:i,unscaledSegmentDuration:a,segmentDuration:s,startNumber:u,scaledPresentationTimeOffset:l/i||0,unscaledPresentationTimeOffset:l,timeline:o}},shaka.dash.MpdUtils.getNodes=function(e,t){var r=shaka.util.Functional;return goog.asserts.assert(t(e.representation),"There must be at least one element of the given type."),[t(e.representation),t(e.adaptationSet),t(e.period)].filter(r.isNotNull)},shaka.dash.MpdUtils.inheritAttribute=function(e,t,r){t=shaka.dash.MpdUtils.getNodes(e,t),e=null;for(var n=(t=$jscomp.makeIterator(t)).next();!n.done&&!(e=n.value.attributes[r]);n=t.next());return e},shaka.dash.MpdUtils.inheritChild=function(e,t,r){var n=shaka.dash.MpdUtils.getNodes(e,t);e=shaka.util.TXml,t=null;for(var a=(n=$jscomp.makeIterator(n)).next();!a.done&&!(t=e.findChild(a.value,r));a=n.next());return t},shaka.dash.MpdUtils.handleXlinkInElement_=function(e,t,r,n,a,i){for(var s=shaka.util.TXml,o=shaka.util.Error,l=shaka.util.ManifestParserUtils,u=shaka.dash.MpdUtils.XlinkNamespaceUri_,c=s.getAttributeNS(e,u,"href"),d=s.getAttributeNS(e,u,"actuate")||"onRequest",p=$jscomp.makeIterator(Object.keys(e.attributes)),h=p.next();!h.done;h=p.next()){var f=(h=h.value).split(":"),m=shaka.util.TXml.getKnownNameSpace(u);f[0]==m&&delete e.attributes[h]}if(5<=i)return shaka.util.AbortableOperation.failed(new o(o.Severity.CRITICAL,o.Category.MANIFEST,o.Code.DASH_XLINK_DEPTH_LIMIT));if("onLoad"!=d)return shaka.util.AbortableOperation.failed(new o(o.Severity.CRITICAL,o.Category.MANIFEST,o.Code.DASH_UNSUPPORTED_XLINK_ACTUATE));var g=l.resolveUris([n],[c]);return n=shaka.net.NetworkingEngine.RequestType.MANIFEST,l=shaka.net.NetworkingEngine.makeRequest(g,t),n=a.request(n,l),goog.asserts.assert(n instanceof shaka.util.AbortableOperation,"Unexpected implementation of IAbortableOperation!"),n.chain((function(n){if(!(n=s.parseXml(n.data,e.tagName)))return shaka.util.AbortableOperation.failed(new o(o.Severity.CRITICAL,o.Category.MANIFEST,o.Code.DASH_INVALID_XML,c));for(e.children=[];n.children.length;){var l=n.children.shift();e.children.push(l)}for(var u=(l=$jscomp.makeIterator(Object.keys(n.attributes))).next();!u.done;u=l.next())u=u.value,e.attributes[u]=n.attributes[u];return shaka.dash.MpdUtils.processXlinks(e,t,r,g[0],a,i+1)}))},shaka.dash.MpdUtils.processXlinks=function(e,t,r,n,a,i){i=void 0===i?0:i;var s=shaka.dash.MpdUtils,o=shaka.util.TXml,l=s.XlinkNamespaceUri_;if(o.getAttributeNS(e,l,"href"))return o=s.handleXlinkInElement_(e,t,r,n,a,i),r&&(o=o.chain(void 0,(function(o){return s.processXlinks(e,t,r,n,a,i)}))),o;for(var u=[],c=$jscomp.makeIterator(shaka.util.TXml.getChildNodes(e)),d=c.next(),p={};!d.done;p={child$jscomp$9:void 0},d=c.next())p.child$jscomp$9=d.value,"urn:mpeg:dash:resolve-to-zero:2013"==o.getAttributeNS(p.child$jscomp$9,l,"href")?e.children=e.children.filter(function(e){return function(t){return t!==e.child$jscomp$9}}(p)):"SegmentTimeline"!=p.child$jscomp$9.tagName&&u.push(shaka.dash.MpdUtils.processXlinks(p.child$jscomp$9,t,r,n,a,i));return shaka.util.AbortableOperation.all(u).chain((function(){return e}))},shaka.dash.MpdUtils.XlinkNamespaceUri_="http://www.w3.org/1999/xlink",shaka.dash.Mp4SegmentIndexParser=function(){},shaka.dash.Mp4SegmentIndexParser.parse=function(e,t,r,n,a,i,s){var o,l=shaka.dash.Mp4SegmentIndexParser,u=(new shaka.util.Mp4Parser).fullBox("sidx",(function(e){o=l.parseSIDX_(t,n,a,i,s,r,e)}));if(e&&u.parse(e),o)return o;throw shaka.log.error('Invalid box type, expected "sidx".'),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MP4_SIDX_WRONG_BOX_TYPE)},shaka.dash.Mp4SegmentIndexParser.parseSIDX_=function(e,t,r,n,a,i,s){goog.asserts.assert(null!=s.version,"SIDX is a full box and should have a valid version.");var o=[];s.reader.skip(4);var l=s.reader.readUint32();if(0==l)throw shaka.log.error("Invalid timescale."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MP4_SIDX_INVALID_TIMESCALE);if(0==s.version)var u=s.reader.readUint32(),c=s.reader.readUint32();else u=s.reader.readUint64(),c=s.reader.readUint64();s.reader.skip(2);var d=s.reader.readUint16();for(e=e+s.size+c,c=0;c<d;c++){var p=s.reader.readUint32(),h=(2147483648&p)>>>31;p&=2147483647;var f=s.reader.readUint32();if(s.reader.skip(4),1==h)throw shaka.log.error("Hierarchical SIDXs are not supported."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MP4_SIDX_TYPE_NOT_SUPPORTED);o.push(new shaka.media.SegmentReference(u/l+r,(u+f)/l+r,(function(){return i}),e,e+p-1,t,r,n,a)),u+=f,e+=p}return s.parser.stop(),o},shaka.dash.EbmlParser=function(e){this.dataView_=shaka.util.BufferUtils.toDataView(e),this.reader_=new shaka.util.DataViewReader(this.dataView_,shaka.util.DataViewReader.Endianness.BIG_ENDIAN)},shaka.dash.EbmlParser.prototype.hasMoreData=function(){return this.reader_.hasMoreData()},shaka.dash.EbmlParser.prototype.parseElement=function(){var e=this.parseId_(),t=this.parseVint_();t=shaka.dash.EbmlParser.isDynamicSizeValue_(t)?this.dataView_.byteLength-this.reader_.getPosition():shaka.dash.EbmlParser.getVintValue_(t),t=this.reader_.getPosition()+t<=this.dataView_.byteLength?t:this.dataView_.byteLength-this.reader_.getPosition();var r=shaka.util.BufferUtils.toDataView(this.dataView_,this.reader_.getPosition(),t);return this.reader_.skip(t),new shaka.util.EbmlElement(e,r)},shaka.dash.EbmlParser.prototype.parseId_=function(){var e=this.parseVint_();if(7<e.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_OVERFLOW);for(var t=0,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())t=256*t+r.value;return t},shaka.dash.EbmlParser.prototype.parseVint_=function(){var e=this.reader_.getPosition(),t=this.reader_.readUint8();if(0==t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_OVERFLOW);return t=8-Math.floor(Math.log2(t)),goog.asserts.assert(8>=t&&1<=t,"Incorrect log2 value"),this.reader_.skip(t-1),shaka.util.BufferUtils.toUint8(this.dataView_,e,t)},shaka.dash.EbmlParser.getVintValue_=function(e){if(8==e.length&&224&e[1])throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.JS_INTEGER_OVERFLOW);for(var t=0,r=0;r<e.length;r++){var n=e[r];t=0==r?n&(1<<8-e.length)-1:256*t+n}return t},shaka.dash.EbmlParser.isDynamicSizeValue_=function(e){for(var t=shaka.util.BufferUtils,r=$jscomp.makeIterator(shaka.dash.EbmlParser.DYNAMIC_SIZES),n=r.next();!n.done;n=r.next())if(t.equal(e,new Uint8Array(n.value)))return!0;return!1},shaka.dash.EbmlParser.DYNAMIC_SIZES=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]],shaka.util.EbmlElement=function(e,t){this.id=e,this.dataView_=t},shaka.util.EbmlElement.prototype.getOffset=function(){return this.dataView_.byteOffset},shaka.util.EbmlElement.prototype.createParser=function(){return new shaka.dash.EbmlParser(this.dataView_)},shaka.util.EbmlElement.prototype.getUint=function(){if(8<this.dataView_.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_OVERFLOW);if(8==this.dataView_.byteLength&&224&this.dataView_.getUint8(0))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.JS_INTEGER_OVERFLOW);for(var e=0,t=0;t<this.dataView_.byteLength;t++){e=256*e+this.dataView_.getUint8(t)}return e},shaka.util.EbmlElement.prototype.getFloat=function(){if(4==this.dataView_.byteLength)return this.dataView_.getFloat32(0);if(8==this.dataView_.byteLength)return this.dataView_.getFloat64(0);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_BAD_FLOATING_POINT_SIZE)},shaka.dash.WebmSegmentIndexParser=function(){},shaka.dash.WebmSegmentIndexParser.parse=function(e,t,r,n,a,i,s){if(t=shaka.dash.WebmSegmentIndexParser.parseWebmContainer_(t),(e=new shaka.dash.EbmlParser(e).parseElement()).id!=shaka.dash.WebmSegmentIndexParser.CUES_ID)throw shaka.log.error("Not a Cues element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_CUES_ELEMENT_MISSING);return shaka.dash.WebmSegmentIndexParser.parseCues_(e,t.segmentOffset,t.timecodeScale,t.duration,r,n,a,i,s)},shaka.dash.WebmSegmentIndexParser.parseWebmContainer_=function(e){if((e=new shaka.dash.EbmlParser(e)).parseElement().id!=shaka.dash.WebmSegmentIndexParser.EBML_ID)throw shaka.log.error("Not an EBML element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_EBML_HEADER_ELEMENT_MISSING);var t=e.parseElement();if(t.id!=shaka.dash.WebmSegmentIndexParser.SEGMENT_ID)throw shaka.log.error("Not a Segment element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_SEGMENT_ELEMENT_MISSING);return{segmentOffset:e=t.getOffset(),timecodeScale:(t=shaka.dash.WebmSegmentIndexParser.parseSegment_(t)).timecodeScale,duration:t.duration}},shaka.dash.WebmSegmentIndexParser.parseSegment_=function(e){e=e.createParser();for(var t=null;e.hasMoreData();){var r=e.parseElement();if(r.id==shaka.dash.WebmSegmentIndexParser.INFO_ID){t=r;break}}if(!t)throw shaka.log.error("Not an Info element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_INFO_ELEMENT_MISSING);return shaka.dash.WebmSegmentIndexParser.parseInfo_(t)},shaka.dash.WebmSegmentIndexParser.parseInfo_=function(e){var t=e.createParser(),r=1e6;for(e=null;t.hasMoreData();){var n=t.parseElement();n.id==shaka.dash.WebmSegmentIndexParser.TIMECODE_SCALE_ID?r=n.getUint():n.id==shaka.dash.WebmSegmentIndexParser.DURATION_ID&&(e=n.getFloat())}if(null==e)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_DURATION_ELEMENT_MISSING);return{timecodeScale:t=r/1e9,duration:e*t}},shaka.dash.WebmSegmentIndexParser.parseCues_=function(e,t,r,n,a,i,s,o,l){var u=[],c=function(){return a};e=e.createParser();for(var d=null,p=null;e.hasMoreData();){var h=e.parseElement();if(h.id==shaka.dash.WebmSegmentIndexParser.CUE_POINT_ID){var f=shaka.dash.WebmSegmentIndexParser.parseCuePoint_(h);f&&(h=r*f.unscaledTime,f=t+f.relativeOffset,null!=d&&(goog.asserts.assert(null!=p,"last offset cannot be null"),u.push(new shaka.media.SegmentReference(d+s,h+s,c,p,f-1,i,s,o,l))),d=h,p=f)}}return null!=d&&(goog.asserts.assert(null!=p,"last offset cannot be null"),u.push(new shaka.media.SegmentReference(d+s,n+s,c,p,null,i,s,o,l))),u},shaka.dash.WebmSegmentIndexParser.parseCuePoint_=function(e){var t=e.createParser();if((e=t.parseElement()).id!=shaka.dash.WebmSegmentIndexParser.CUE_TIME_ID)throw shaka.log.warning("Not a CueTime element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_CUE_TIME_ELEMENT_MISSING);if(e=e.getUint(),(t=t.parseElement()).id!=shaka.dash.WebmSegmentIndexParser.CUE_TRACK_POSITIONS_ID)throw shaka.log.warning("Not a CueTrackPositions element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING);t=t.createParser();for(var r=0;t.hasMoreData();){var n=t.parseElement();if(n.id==shaka.dash.WebmSegmentIndexParser.CUE_CLUSTER_POSITION){r=n.getUint();break}}return{unscaledTime:e,relativeOffset:r}},shaka.dash.WebmSegmentIndexParser.EBML_ID=440786851,shaka.dash.WebmSegmentIndexParser.SEGMENT_ID=408125543,shaka.dash.WebmSegmentIndexParser.INFO_ID=357149030,shaka.dash.WebmSegmentIndexParser.TIMECODE_SCALE_ID=2807729,shaka.dash.WebmSegmentIndexParser.DURATION_ID=17545,shaka.dash.WebmSegmentIndexParser.CUES_ID=475249515,shaka.dash.WebmSegmentIndexParser.CUE_POINT_ID=187,shaka.dash.WebmSegmentIndexParser.CUE_TIME_ID=179,shaka.dash.WebmSegmentIndexParser.CUE_TRACK_POSITIONS_ID=183,shaka.dash.WebmSegmentIndexParser.CUE_CLUSTER_POSITION=241,shaka.dash.SegmentBase=function(){},shaka.dash.SegmentBase.createInitSegment=function(e,t,r){var n=shaka.util.TXml,a=shaka.util.ManifestParserUtils,i=shaka.util.StringUtils;if(!(t=shaka.dash.MpdUtils.inheritChild(e,t,"Initialization")))return null;var s=e.representation.getBaseUris(),o=t.attributes.sourceURL;return o&&(s=a.resolveUris(s,[i.htmlUnescape(o)],e.urlParams())),a=0,i=null,(n=n.parseAttr(t,"range",n.parseRange))&&(a=n.start,i=n.end),n=shaka.dash.SegmentBase.createQualityInfo(e),(r=new shaka.media.InitSegmentReference((function(){return s}),a,i,n,null,null,r,e.adaptationSet.encrypted)).codecs=e.representation.codecs,r.mimeType=e.representation.mimeType,e.periodInfo&&(r.boundaryEnd=e.periodInfo.start+e.periodInfo.duration),r},shaka.dash.SegmentBase.createStreamInfo=function(e,t,r){goog.asserts.assert(e.representation.segmentBase,"Should only be called with SegmentBase");var n=shaka.dash.MpdUtils,a=shaka.dash.SegmentBase,i=shaka.util.TXml,s=Number(n.inheritAttribute(e,a.fromInheritance_,"presentationTimeOffset"))||0,o=1;(n=n.inheritAttribute(e,a.fromInheritance_,"timescale"))&&(o=i.parsePositiveInt(n)||1);var l=s/o||0,u=a.createInitSegment(e,a.fromInheritance_,r);a.checkSegmentIndexRangeSupport_(e,u);var c=shaka.util.ObjectUtils.shallowCloneObject(e);return{generateSegmentIndex:function(){return a.generateSegmentIndex_(c,t,u,l)}}},shaka.dash.SegmentBase.generateSegmentIndexFromUris=function(e,t,r,n,a,i,s){var o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A;return $jscomp.asyncExecutePromiseGeneratorProgram((function(S){if(1==S.nextAddress)return o=e.presentationTimeline,l=!e.dynamic||!e.periodInfo.isLastPeriod,u=e.periodInfo.start,c=e.periodInfo.duration,d=e.representation.mimeType.split("/")[1],h=null,f=[(p=t)(n,a,i,!1),"webm"==d?p(r.getUris(),r.startByte,r.endByte,!0):null],p=null,S.yield(Promise.all(f),2);for(m=S.yieldResult,g=m[0],y=m[1]||null,v=null,_=u-s,k=u,E=c?u+c:1/0,"mp4"==d?v=shaka.dash.Mp4SegmentIndexParser.parse(g,a,n,r,_,k,E):(goog.asserts.assert(y,"WebM requires init data"),v=shaka.dash.WebmSegmentIndexParser.parse(g,y,n,r,_,k,E)),b=$jscomp.makeIterator(v),T=b.next();!T.done;T=b.next())(A=T.value).codecs=e.representation.codecs,A.mimeType=e.representation.mimeType,A.bandwidth=e.bandwidth;return o.notifySegments(v),goog.asserts.assert(!h,"Should not call generateSegmentIndex twice"),h=new shaka.media.SegmentIndex(v),l&&h.fit(k,E,!0),S.return(h)}))},shaka.dash.SegmentBase.fromInheritance_=function(e){return e.segmentBase},shaka.dash.SegmentBase.computeIndexRange_=function(e){var t=shaka.dash.MpdUtils,r=shaka.dash.SegmentBase,n=shaka.util.TXml,a=t.inheritChild(e,r.fromInheritance_,"RepresentationIndex");return e=t.inheritAttribute(e,r.fromInheritance_,"indexRange"),e=n.parseRange(e||""),a&&(e=n.parseAttr(a,"range",n.parseRange,e)),e},shaka.dash.SegmentBase.computeIndexUris_=function(e){var t=shaka.util.ManifestParserUtils,r=shaka.util.StringUtils,n=shaka.dash.MpdUtils.inheritChild(e,shaka.dash.SegmentBase.fromInheritance_,"RepresentationIndex"),a=e.representation.getBaseUris();return n&&(r=r.htmlUnescape(n.attributes.sourceURL))&&(a=t.resolveUris(a,[r],e.urlParams())),a},shaka.dash.SegmentBase.checkSegmentIndexRangeSupport_=function(e,t){var r=shaka.dash.SegmentBase;if(r.checkSegmentIndexSupport(e,t),!r.computeIndexRange_(e))throw shaka.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)},shaka.dash.SegmentBase.checkSegmentIndexSupport=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType,n=e.representation.contentType,a=e.representation.mimeType.split("/")[1];if(n!=r.TEXT&&"mp4"!=a&&"webm"!=a)throw shaka.log.error("SegmentBase specifies an unsupported container type.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_CONTAINER);if("webm"==a&&!t)throw shaka.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_WEBM_MISSING_INIT)},shaka.dash.SegmentBase.generateSegmentIndex_=function(e,t,r,n){var a=shaka.dash.SegmentBase,i=a.computeIndexUris_(e);return a=a.computeIndexRange_(e),goog.asserts.assert(a,"Index range should not be null!"),shaka.dash.SegmentBase.generateSegmentIndexFromUris(e,t,r,i,a.start,a.end,n)},shaka.dash.SegmentBase.createQualityInfo=function(e){var t=e.representation;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.numChannels,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null,label:e.adaptationSet.label||null,roles:e.roles||null,language:e.adaptationSet.language||null}},shaka.dash.SegmentList=function(){},shaka.dash.SegmentList.createStreamInfo=function(e,t,r){goog.asserts.assert(e.representation.segmentList,"Should only be called with SegmentList");var n=shaka.dash.SegmentList,a=shaka.dash.SegmentBase.createInitSegment(e,n.fromInheritance_,r),i=n.parseSegmentListInfo_(e);n.checkSegmentListInfo_(e,i);var s=null,o=null;e.period.id&&e.representation.id&&(o=t.get(e.period.id+","+e.representation.id))&&(s=o.segmentIndex);var l=n.createSegmentReferences_(e.periodInfo.start,e.periodInfo.duration,i.startNumber,e.representation.getBaseUris,i,a,r,e.representation.mimeType,e.representation.codecs,e.bandwidth,e.urlParams);return t=!s,s?(r=e.presentationTimeline.getSegmentAvailabilityStart(),s.mergeAndEvict(l,r)):s=new shaka.media.SegmentIndex(l),e.presentationTimeline.notifySegments(l),e.dynamic&&e.periodInfo.isLastPeriod||s.fit(e.periodInfo.start,e.periodInfo.duration?e.periodInfo.start+e.periodInfo.duration:1/0,t),o&&(o.segmentIndex=s),{generateSegmentIndex:function(){return s&&!s.isEmpty()||s.merge(l),Promise.resolve(s)}}},shaka.dash.SegmentList.fromInheritance_=function(e){return e.segmentList},shaka.dash.SegmentList.parseSegmentListInfo_=function(e){var t=shaka.dash.SegmentList,r=shaka.dash.MpdUtils,n=t.parseMediaSegments_(e);return 0==(t=(e=r.parseSegmentInfo(e,t.fromInheritance_)).startNumber)&&(shaka.log.warning("SegmentList@startNumber must be > 0"),t=1),r=0,e.segmentDuration?r=e.segmentDuration*(t-1):e.timeline&&0<e.timeline.length&&(r=e.timeline[0].start),{segmentDuration:e.segmentDuration,startTime:r,startNumber:t,scaledPresentationTimeOffset:e.scaledPresentationTimeOffset,timeline:e.timeline,mediaSegments:n}},shaka.dash.SegmentList.checkSegmentListInfo_=function(e,t){if(!t.segmentDuration&&!t.timeline&&1<t.mediaSegments.length)throw shaka.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);if(!t.segmentDuration&&!e.periodInfo.duration&&!t.timeline&&1==t.mediaSegments.length)throw shaka.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);if(t.timeline&&0==t.timeline.length)throw shaka.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)},shaka.dash.SegmentList.createSegmentReferences_=function(e,t,r,n,a,i,s,o,l,u,c){var d=shaka.util.ManifestParserUtils;r=a.mediaSegments.length,a.timeline&&a.timeline.length!=a.mediaSegments.length&&(r=Math.min(a.timeline.length,a.mediaSegments.length),shaka.log.warning("The number of items in the segment timeline and the number of ","segment URLs do not match, truncating",a.mediaSegments.length,"to",r));for(var p=e-a.scaledPresentationTimeOffset,h=t?e+t:1/0,f=[],m=a.startTime,g={},y=0;y<r;g={uris$jscomp$12:void 0,segment$jscomp$9:void 0},y++){g.segment$jscomp$9=a.mediaSegments[y];var v=m;m=void 0,null!=a.segmentDuration?m=v+a.segmentDuration:a.timeline?m=a.timeline[y].end:(goog.asserts.assert(1==a.mediaSegments.length&&t,"There should be exactly one segment with a Period duration."),m=v+t),g.uris$jscomp$12=null;var _=function(e){return function(){return null==e.uris$jscomp$12&&(e.uris$jscomp$12=d.resolveUris(n(),[e.segment$jscomp$9.mediaUri],c())),e.uris$jscomp$12}}(g);(g=new shaka.media.SegmentReference(e+v,e+m,_,g.segment$jscomp$9.start,g.segment$jscomp$9.end,i,p,e,h,[],"",null,null,shaka.media.SegmentReference.Status.AVAILABLE,s)).codecs=l,g.mimeType=o,g.bandwidth=u,f.push(g)}return f},shaka.dash.SegmentList.parseMediaSegments_=function(e){var t=[e.representation.segmentList,e.adaptationSet.segmentList,e.period.segmentList].filter(shaka.util.Functional.isNotNull),r=shaka.util.TXml,n=shaka.util.StringUtils;return t.map((function(e){return r.findChildren(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.attributes.indexRange&&!e.indexRangeWarningGiven&&(e.indexRangeWarningGiven=!0,shaka.log.warning("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{mediaUri:n.htmlUnescape(t.attributes.media),start:(t=r.parseAttr(t,"mediaRange",r.parseRange,{start:0,end:null})).start,end:t.end}}))},shaka.dash.SegmentTemplate=function(){},shaka.dash.SegmentTemplate.createStreamInfo=function(e,t,r,n,a,i,s,o,l){goog.asserts.assert(e.representation.segmentTemplate,"Should only be called with SegmentTemplate or segment info defined");var u=shaka.dash.MpdUtils,c=shaka.dash.SegmentTemplate,d=shaka.dash.TimelineSegmentIndex;l||e.representation.initialization||(e.representation.initialization=u.inheritAttribute(e,c.fromInheritance_,"initialization"));var p=e.representation.initialization?c.createInitSegment_(e,s):null,h=c.parseSegmentTemplateInfo_(e);c.checkSegmentTemplateInfo_(e,h);var f=shaka.util.ObjectUtils.shallowCloneObject(e);if(h.indexTemplate)return shaka.dash.SegmentBase.checkSegmentIndexSupport(e,p),{generateSegmentIndex:function(){return c.generateSegmentIndexFromIndexTemplate_(f,t,p,h)}};if(h.segmentDuration)return n||"image"===e.adaptationSet.contentType||"text"===e.adaptationSet.contentType||(r=e.periodInfo.start,d=e.period.id,n=e.periodInfo.duration,d=(d=null!=d&&i.get(d)||n)?r+d:1/0,e.presentationTimeline.notifyMaxSegmentDuration(h.segmentDuration),e.presentationTimeline.notifyPeriodDuration(r,d)),{generateSegmentIndex:function(){return c.generateSegmentIndexFromDuration_(f,h,a,p,i,s,o,e.representation.segmentSequenceCadence)}};var m=null;n=n=null,e.period.id&&e.representation.id&&(n=e.period.id+","+e.representation.id,n=r.get(n))&&(m=n.segmentIndex);var g=e.periodInfo.start,y=e.periodInfo.duration?g+e.periodInfo.duration:1/0;return shaka.log.debug("New manifest "+g+" - "+y),m?((r=m).appendTemplateInfo(h,g,y,p),d=e.presentationTimeline.getSegmentAvailabilityStart(),r.evict(d)):(shaka.log.debug("Creating TSI with end "+y),m=new d(h,e.representation.originalId,e.bandwidth,e.representation.getBaseUris,e.urlParams,g,y,p,s,e.representation.segmentSequenceCadence)),h.timeline&&"image"!==e.adaptationSet.contentType&&"text"!==e.adaptationSet.contentType&&(r=m.getTimeline(),e.presentationTimeline.notifyTimeRange(r,g)),n&&e.dynamic&&(n.segmentIndex=m),{generateSegmentIndex:function(){return m instanceof shaka.dash.TimelineSegmentIndex&&m.isEmpty()&&m.appendTemplateInfo(h,g,y,p),Promise.resolve(m)}}},shaka.dash.SegmentTemplate.modifyTimepoints=function(e,t){var r=shaka.util.TXml;e=shaka.dash.MpdUtils.inheritChild(e,shaka.dash.SegmentTemplate.fromInheritance_,"SegmentTimeline"),goog.asserts.assert(e,"timeline node not found");var n=r.findChildren(e,"S");goog.asserts.assert(n,"timepoints should exist"),r.modifyNodes(n,t),e.children=n},shaka.dash.SegmentTemplate.removeTimepoints=function(e){e=shaka.dash.MpdUtils.inheritChild(e,shaka.dash.SegmentTemplate.fromInheritance_,"SegmentTimeline"),goog.asserts.assert(e,"timeline node not found"),e.children=[]},shaka.dash.SegmentTemplate.fromInheritance_=function(e){return e.segmentTemplate},shaka.dash.SegmentTemplate.parseSegmentTemplateInfo_=function(e){var t=shaka.dash.SegmentTemplate,r=shaka.dash.MpdUtils,n=shaka.util.StringUtils,a=r.parseSegmentInfo(e,t.fromInheritance_),i=r.inheritAttribute(e,t.fromInheritance_,"media"),s=r.inheritAttribute(e,t.fromInheritance_,"index");return t=r.inheritAttribute(e,t.fromInheritance_,"k"),r=0,t&&(r=parseInt(t,10)),{unscaledSegmentDuration:a.unscaledSegmentDuration,segmentDuration:a.segmentDuration,timescale:a.timescale,startNumber:a.startNumber,scaledPresentationTimeOffset:a.scaledPresentationTimeOffset,unscaledPresentationTimeOffset:a.unscaledPresentationTimeOffset,timeline:a.timeline,mediaTemplate:i&&n.htmlUnescape(i),indexTemplate:s,mimeType:e.representation.mimeType,codecs:e.representation.codecs,bandwidth:e.bandwidth,numChunks:r}},shaka.dash.SegmentTemplate.checkSegmentTemplateInfo_=function(e,t){var r=t.indexTemplate?1:0;if(r+=t.timeline?1:0,0==(r+=t.segmentDuration?1:0))throw shaka.log.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);if(1!=r&&(shaka.log.warning("SegmentTemplate contains multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.representation),t.indexTemplate?(shaka.log.info("Using the index URL template by default."),t.timeline=null):(goog.asserts.assert(t.timeline,"There should be a timeline"),shaka.log.info("Using the SegmentTimeline by default.")),t.unscaledSegmentDuration=null,t.segmentDuration=null),!t.indexTemplate&&!t.mediaTemplate)throw shaka.log.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)},shaka.dash.SegmentTemplate.generateSegmentIndexFromIndexTemplate_=function(e,t,r,n){var a=shaka.dash.MpdUtils,i=shaka.util.ManifestParserUtils;return goog.asserts.assert(n.indexTemplate,"must be using index template"),a=a.fillUriTemplate(n.indexTemplate,e.representation.originalId,null,null,e.bandwidth||null,null),i=i.resolveUris(e.representation.getBaseUris(),[a]),shaka.dash.SegmentBase.generateSegmentIndexFromUris(e,t,r,i,0,null,n.scaledPresentationTimeOffset)},shaka.dash.SegmentTemplate.generateSegmentIndexFromDuration_=function(e,t,r,n,a,i,s,o){goog.asserts.assert(t.mediaTemplate,"There should be a media template with duration");var l=shaka.dash.MpdUtils,u=shaka.util.ManifestParserUtils,c=e.presentationTimeline,d=e.periodInfo.start,p=e.period.id,h=e.periodInfo.duration,f=function(){var e=null!=p&&a.get(p)||h;return e?d+e:1/0},m=t.segmentDuration;goog.asserts.assert(null!=m,"Segment duration must not be null!");var g=t.startNumber,y=t.mediaTemplate,v=e.bandwidth||null,_=e.representation.id,k=e.representation.getBaseUris,E=e.urlParams,b=d-t.scaledPresentationTimeOffset,T=function(){var t=[Math.max(c.getSegmentAvailabilityStart(),d),Math.min(c.getSegmentAvailabilityEnd(),f())];return goog.asserts.assert(t.every(isFinite),"Available presentation times must be finite!"),goog.asserts.assert(t.every((function(e){return 0<=e})),"Available presentation times must be positive!"),goog.asserts.assert(null!=m,"Segment duration must not be null!"),t=t.map((function(e){return e-d})),t=[Math.ceil(t[0]/m),Math.ceil(t[1]/m)-1],e.representation.availabilityTimeOffset&&t[1]++,t.map((function(e){return e+g}))},A=T();r=e.dynamic?Math.max(A[0],A[1]-r+1):A[0],s=s||A[1],A=[];for(var S=function(r){goog.asserts.assert(null!=m,"Segment duration must not be null!");var a=r-g,s=a*m,c=t.unscaledSegmentDuration;goog.asserts.assert(null!=c,"Segment duration must not be null!");var p=a*c;"BigInt"in window&&p>Number.MAX_SAFE_INTEGER&&(p=BigInt(a)*BigInt(c)),a=(s+=d)+m,c=Math.min(a,f()),goog.asserts.assert(s<c,"Generated a segment outside of the period!");var h=[],T=t.numChunks;if(T)for(var A=(c-s)/T,S={},P=0;P<T;S={subNumber$jscomp$1:void 0},P++){var C=s+A*P,x=C+A;S.subNumber$jscomp$1=P+1,S=function(e){return function(){var t=l.fillUriTemplate(y,_,r,e.subNumber$jscomp$1,v,p);return u.resolveUris(k(),[t],E())}}(S),(C=new shaka.media.SegmentReference(C,x,S,0,null,n,b,d,f(),[],"",null,null,shaka.media.SegmentReference.Status.AVAILABLE,i)).codecs=e.representation.codecs,C.mimeType=e.representation.mimeType,0==o?0<P&&C.markAsNonIndependent():0!=P%o&&C.markAsNonIndependent(),h.push(C)}return(s=new shaka.media.SegmentReference(s,c,(function(){if(T)return[];var e=l.fillUriTemplate(y,_,r,null,v,p);return u.resolveUris(k(),[e],E())}),0,null,n,b,d,f(),h,"",null,null,shaka.media.SegmentReference.Status.AVAILABLE,i,0<h.length)).codecs=e.representation.codecs,s.mimeType=e.representation.mimeType,s.bandwidth=e.bandwidth,s.trueEndTime=a,s},P=r;P<=s;++P){var C=S(P);A.push(C)}var x=new shaka.media.SegmentIndex(A);if(A=c.getSegmentAvailabilityEnd()<f(),P=c.isLive(),A||P){var I=Math.max(r,s+1);r=m,e.representation.availabilityTimeOffset&&(r=.1),x.updateEvery(r,(function(){var e=c.getSegmentAvailabilityStart();x.evict(e);var t=$jscomp.makeIterator(T());t.next(),t=t.next().value;for(var r=[];I<=t;){var n=S(I);r.push(n),I++}return e>f()&&!r.length?null:r}))}return Promise.resolve(x)},shaka.dash.SegmentTemplate.createInitSegment_=function(e,t){var r=shaka.dash.MpdUtils,n=shaka.util.ManifestParserUtils,a=shaka.dash.SegmentTemplate,i=e.representation.initialization;if(i||(i=r.inheritAttribute(e,a.fromInheritance_,"initialization")),!i)return null;i=shaka.util.StringUtils.htmlUnescape(i);var s=e.representation.originalId,o=e.bandwidth||null,l=e.representation.getBaseUris,u=e.urlParams;return a=shaka.dash.SegmentBase.createQualityInfo(e),(t=new shaka.media.InitSegmentReference((function(){goog.asserts.assert(i,"Should have returned earlier");var e=r.fillUriTemplate(i,s,null,null,o,null);return n.resolveUris(l(),[e],u())}),0,null,a,null,null,t,e.adaptationSet.encrypted)).codecs=e.representation.codecs,t.mimeType=e.representation.mimeType,e.periodInfo&&(t.boundaryEnd=e.periodInfo.start+e.periodInfo.duration),t},shaka.dash.TimelineSegmentIndex=function(e,t,r,n,a,i,s,o,l,u){shaka.media.SegmentIndex.call(this,[]),this.templateInfo_=e,this.representationId_=t,this.bandwidth_=r,this.getBaseUris_=n,this.urlParams_=a,this.periodStart_=i,this.periodEnd_=s,this.initSegmentReference_=o,this.aesKey_=l,this.segmentSequenceCadence_=u,this.fitTimeline()},$jscomp.inherits(shaka.dash.TimelineSegmentIndex,shaka.media.SegmentIndex),shaka.dash.TimelineSegmentIndex.prototype.getNumReferences=function(){return this.templateInfo_?this.templateInfo_.timeline.length:0},shaka.dash.TimelineSegmentIndex.prototype.release=function(){shaka.media.SegmentIndex.prototype.release.call(this),this.templateInfo_=null},shaka.dash.TimelineSegmentIndex.prototype.evict=function(e){if(this.templateInfo_){shaka.log.debug(this.representationId_+" Evicting at "+e);for(var t=0,r=this.templateInfo_.timeline,n=0;n<r.length;n+=1){var a=r[n],i=a.end+this.periodStart_;if(a=a.start+this.periodStart_,!(i<=e))break;shaka.log.debug("Evicting "+a+" - "+i),t+=1}0<t&&(this.templateInfo_.timeline=r.slice(t),this.references.length>=t&&(this.references=this.references.slice(t)),this.numEvicted_+=t,0===this.getNumReferences()&&this.release())}},shaka.dash.TimelineSegmentIndex.prototype.appendTemplateInfo=function(e,t,r,n){if(this.updateInitSegmentReference(n),this.templateInfo_){if(t=this.templateInfo_.timeline,this.templateInfo_.mediaTemplate!==e.mediaTemplate&&(this.templateInfo_.mediaTemplate=e.mediaTemplate),t.length){var a=t[t.length-1];e=e.timeline.filter((function(e){return e.end>a.end}))}else e=e.timeline.slice();0<e.length&&(shaka.log.debug("Appending "+e.length+" entries"),this.templateInfo_.timeline.push.apply(this.templateInfo_.timeline,$jscomp.arrayFromIterable(e))),this.periodEnd_!==r&&(this.periodEnd_=r)}else this.templateInfo_=e,this.periodStart_=t,this.periodEnd_=r;this.fitTimeline()},shaka.dash.TimelineSegmentIndex.prototype.updateInitSegmentReference=function(e){if(this.initSegmentReference_!==e){this.initSegmentReference_=e;for(var t=$jscomp.makeIterator(this.references),r=t.next();!r.done;r=t.next())(r=r.value)&&r.updateInitSegmentReference(e)}},shaka.dash.TimelineSegmentIndex.prototype.isBeforeFirstEntry=function(e){return!!(this.templateInfo_&&this.templateInfo_.timeline&&this.templateInfo_.timeline.length)&&e<this.templateInfo_.timeline[0].start+this.periodStart_},shaka.dash.TimelineSegmentIndex.prototype.fitTimeline=function(){if(this.templateInfo_&&!this.getIsImmutable()){var e=this.templateInfo_.timeline;goog.asserts.assert(e,"Timeline should be non-null!");for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value).start>=this.periodEnd_||0>=r.end||t.push(r);this.templateInfo_.timeline=t,this.evict(this.periodStart_)}},shaka.dash.TimelineSegmentIndex.prototype.getTimeline=function(){if(!this.templateInfo_)return[];var e=this.templateInfo_.timeline;return goog.asserts.assert(e,"Timeline should be non-null!"),e},shaka.dash.TimelineSegmentIndex.prototype.find=function(e){if(shaka.log.debug("Find "+e),this.isBeforeFirstEntry(e))return this.numEvicted_;if(!this.templateInfo_)return null;var t=this.templateInfo_.timeline;if(e<this.periodStart_||e>=this.periodEnd_)return null;for(var r=t.length-1,n=0;n<t.length;n++){var a=t[n],i=a.start+this.periodStart_;if(a=n<r?t[n+1].start+this.periodStart_:1/0===this.periodEnd_?a.end+this.periodStart_:this.periodEnd_,e>=i&&e<a)return n+this.numEvicted_}return null},shaka.dash.TimelineSegmentIndex.prototype.get=function(e){var t=this;if(0>(e-=this.numEvicted_)||e>=this.getNumReferences()||!this.templateInfo_)return null;var r=this.references[e];if(!r){var n=this.templateInfo_.timeline[e],a=n.segmentPosition,i=n.unscaledStart+this.templateInfo_.unscaledPresentationTimeOffset;r=this.periodStart_-this.templateInfo_.scaledPresentationTimeOffset;var s=this.periodStart_+n.end,o=s;e===this.getNumReferences()-1&&1/0!==this.periodEnd_&&(o=this.periodEnd_);for(var l=this.templateInfo_.codecs,u=this.templateInfo_.mimeType,c=this.templateInfo_.bandwidth,d=[],p=(n.end-n.start)/n.partialSegments,h={},f=0;f<n.partialSegments;h={uris$jscomp$13:void 0,subNumber$jscomp$2:void 0},f++){var m=n.start+p*f,g=m+p;h.subNumber$jscomp$2=f+1,h.uris$jscomp$13=null,h=function(e){return function(){return t.templateInfo_?(null==e.uris$jscomp$13&&(e.uris$jscomp$13=shaka.dash.TimelineSegmentIndex.createUris_(t.templateInfo_.mediaTemplate,t.representationId_,a,t.bandwidth_,i,e.subNumber$jscomp$2,t.getBaseUris_,t.urlParams_)),e.uris$jscomp$13):[]}}(h),(m=new shaka.media.SegmentReference(this.periodStart_+m,this.periodStart_+g,h,0,null,this.initSegmentReference_,r,this.periodStart_,this.periodEnd_,[],"",null,null,shaka.media.SegmentReference.Status.AVAILABLE,this.aesKey_)).codecs=l,m.mimeType=u,m.bandwidth=c,0==this.segmentSequenceCadence_?0<f&&m.markAsNonIndependent():0!=f%this.segmentSequenceCadence_&&m.markAsNonIndependent(),d.push(m)}(r=new shaka.media.SegmentReference(this.periodStart_+n.start,o,(function(){return 0<n.partialSegments||!t.templateInfo_?[]:shaka.dash.TimelineSegmentIndex.createUris_(t.templateInfo_.mediaTemplate,t.representationId_,a,t.bandwidth_,i,null,t.getBaseUris_,t.urlParams_)}),0,null,this.initSegmentReference_,r,this.periodStart_,this.periodEnd_,d,"",null,null,shaka.media.SegmentReference.Status.AVAILABLE,this.aesKey_,0<n.partialSegments)).codecs=l,r.mimeType=u,r.trueEndTime=s,r.bandwidth=c,this.references[e]=r}return r},shaka.dash.TimelineSegmentIndex.prototype.forEachTopLevelReference=function(e){this.fitTimeline();for(var t=0;t<this.getNumReferences();t++){var r=this.get(t+this.numEvicted_);r&&e(r)}},shaka.dash.TimelineSegmentIndex.createUris_=function(e,t,r,n,a,i,s,o){return e=shaka.dash.MpdUtils.fillUriTemplate(e,t,r,i,n||null,a),shaka.util.ManifestParserUtils.resolveUris(s(),[e],o()).map((function(e){return e.toString()}))},shaka.util.ContentSteeringManager=function(e){this.config_=null,this.playerInterface_=e,this.operationManager_=new shaka.util.OperationManager,this.baseUris_=[],this.defaultPathwayId_=null,this.pathwayPriority_=[],this.lastPathwayUsed_=null,this.pathwayClones_=[],this.lastTTL_=300,this.locations_=new Map,this.bannedLocations_=new Map,this.updateTimer_=null,this.manifestType_=shaka.media.ManifestParser.UNKNOWN},shaka.util.ContentSteeringManager.prototype.configure=function(e){this.config_=e},shaka.util.ContentSteeringManager.prototype.destroy=function(){return this.playerInterface_=this.config_=null,this.baseUris_=[],this.defaultPathwayId_=null,this.pathwayPriority_=[],this.pathwayClones_=[],this.locations_.clear(),null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null),this.operationManager_.destroy()},shaka.util.ContentSteeringManager.prototype.setManifestType=function(e){this.manifestType_=e},shaka.util.ContentSteeringManager.prototype.setBaseUris=function(e){this.baseUris_=e},shaka.util.ContentSteeringManager.prototype.setDefaultPathwayId=function(e){this.defaultPathwayId_=e},shaka.util.ContentSteeringManager.prototype.requestInfo=function(e){var t,r,n,a,i,s,o,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){return 1==c.nextAddress?(t=shaka.util.ManifestParserUtils.resolveUris(u.baseUris_,[u.addQueryParams_(e)]),r=shaka.net.NetworkingEngine.RequestType.CONTENT_STEERING,n=shaka.net.NetworkingEngine.makeRequest(t,u.config_.retryParameters),a=u.playerInterface_.networkingEngine.request(r,n),u.operationManager_.manage(a),c.setCatchFinallyBlocks(2),c.yield(a.promise,4)):2!=c.nextAddress?(i=c.yieldResult,s=shaka.util.StringUtils.fromUTF8(i.data),1==(o=JSON.parse(s)).VERSION&&u.processManifest_(o,i.uri),c.leaveTryBlock(0)):(l=c.enterCatchBlock())&&l.code==shaka.util.Error.Code.OPERATION_ABORTED?c.return():(null!=u.updateTimer_&&(u.updateTimer_.stop(),u.updateTimer_=null),u.updateTimer_=new shaka.util.Timer((function(){u.requestInfo(e)})),u.updateTimer_.tickAfter(u.lastTTL_),void c.jumpToEnd())}))},shaka.util.ContentSteeringManager.prototype.addQueryParams_=function(e){if(!this.pathwayPriority_.length)return e;e=new goog.Uri(e);var t=this.lastPathwayUsed_||this.pathwayPriority_[0],r=Math.round(this.playerInterface_.getBandwidthEstimate()),n=e.getQueryData();return this.manifestType_==shaka.media.ManifestParser.DASH?(n.add("_DASH_pathway",t),n.add("_DASH_throughput",String(r))):this.manifestType_==shaka.media.ManifestParser.HLS&&(n.add("_HLS_pathway",t),n.add("_HLS_throughput",String(r))),n.getCount()&&e.setQueryData(n),e.toString()},shaka.util.ContentSteeringManager.prototype.processManifest_=function(e,t){var r=this;null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null);var n=e["RELOAD-URI"]||t;this.updateTimer_=new shaka.util.Timer((function(){r.requestInfo(n)})),(t=e.TTL)&&(this.lastTTL_=t),this.updateTimer_.tickAfter(this.lastTTL_),this.pathwayPriority_=e["PATHWAY-PRIORITY"]||[],this.pathwayClones_=e["PATHWAY-CLONES"]||[]},shaka.util.ContentSteeringManager.prototype.clearPreviousLocations=function(){this.locations_.clear()},shaka.util.ContentSteeringManager.prototype.addLocation=function(e,t,r){var n=this.locations_.get(e);n||(n=new Map),n.set(t,r),this.locations_.set(e,n)},shaka.util.ContentSteeringManager.prototype.banLocation=function(e){var t=Date.now()+6e4;this.bannedLocations_.set(e,t)},shaka.util.ContentSteeringManager.prototype.getLocations=function(e,t){var r=this;t=void 0!==t&&t,e=this.locations_.get(e)||new Map;for(var n=[],a=$jscomp.makeIterator(this.pathwayPriority_),i=a.next(),s={};!i.done;s={pathwayId$jscomp$1:void 0},i=a.next())if(s.pathwayId$jscomp$1=i.value,i=e.get(s.pathwayId$jscomp$1))n.push({pathwayId:s.pathwayId$jscomp$1,location:i});else if(i=this.pathwayClones_.find(function(e){return function(t){return t.ID==e.pathwayId$jscomp$1}}(s))){var o=e.get(i["BASE-ID"]);o&&(i["URI-REPLACEMENT"].HOST?((o=new goog.Uri(o)).setDomain(i["URI-REPLACEMENT"].HOST),n.push({pathwayId:s.pathwayId$jscomp$1,location:o.toString()})):n.push({pathwayId:s.pathwayId$jscomp$1,location:o}))}for(a=Date.now(),i=(s=$jscomp.makeIterator(this.bannedLocations_.keys())).next();!i.done;i=s.next())i=i.value,a>(o=this.bannedLocations_.get(i))&&this.bannedLocations_.delete(i);if(n=n.filter((function(e){for(var t=$jscomp.makeIterator(r.bannedLocations_.keys()),n=t.next();!n.done;n=t.next())if(n.value.includes(new goog.Uri(e.location).getDomain()))return!1;return!0})),n.length&&(this.lastPathwayUsed_=n[0].pathwayId),n=n.map((function(e){return e.location})),!n.length&&this.defaultPathwayId_)for(s=(a=$jscomp.makeIterator(this.defaultPathwayId_.split(","))).next();!s.done;s=a.next())(s=e.get(s.value))&&(this.lastPathwayUsed_=this.defaultPathwayId_,n.push(s));if(!n.length)for(a=(e=$jscomp.makeIterator(e.values())).next();!a.done;a=e.next())n.push(a.value);return t?n:shaka.util.ManifestParserUtils.resolveUris(this.baseUris_,n)},shaka.util.PeriodCombiner=function(){this.variants_=[],this.audioStreams_=[],this.videoStreams_=[],this.textStreams_=[],this.imageStreams_=[],this.useStreamOnce_=this.multiTypeVariantsAllowed_=!1,this.usedPeriodIds_=new Set},shaka.util.PeriodCombiner.prototype.release=function(){for(var e=this.audioStreams_.concat(this.videoStreams_,this.textStreams_,this.imageStreams_),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();this.audioStreams_=[],this.videoStreams_=[],this.textStreams_=[],this.imageStreams_=[],this.variants_=[],this.useStreamOnce_=this.multiTypeVariantsAllowed_=!1,this.usedPeriodIds_.clear()},shaka.util.PeriodCombiner.prototype.getVariants=function(){return this.variants_},shaka.util.PeriodCombiner.prototype.getTextStreams=function(){return this.textStreams_.slice()},shaka.util.PeriodCombiner.prototype.getImageStreams=function(){return this.imageStreams_},shaka.util.PeriodCombiner.prototype.deleteStream=function(e,t){if(e){var r=shaka.util.ManifestParserUtils.ContentType;if(e.type==r.AUDIO)for(var n=(r=$jscomp.makeIterator(this.audioStreams_)).next();!n.done;n=r.next())(n=n.value).matchedStreams=n.matchedStreams.filter((function(t){return t!==e}));else if(e.type==r.VIDEO)for(n=(r=$jscomp.makeIterator(this.videoStreams_)).next();!n.done;n=r.next())(n=n.value).matchedStreams=n.matchedStreams.filter((function(t){return t!==e})),n.trickModeVideo&&(n.trickModeVideo.matchedStreams=n.trickModeVideo.matchedStreams.filter((function(t){return t!==e}))),n.dependencyStream&&(n.dependencyStream.matchedStreams=n.dependencyStream.matchedStreams.filter((function(t){return t!==e})));else if(e.type==r.TEXT)for(n=(r=$jscomp.makeIterator(this.textStreams_)).next();!n.done;n=r.next())(n=n.value).matchedStreams=n.matchedStreams.filter((function(t){return t!==e}));else if(e.type==r.IMAGE)for(n=(r=$jscomp.makeIterator(this.imageStreams_)).next();!n.done;n=r.next())(n=n.value).matchedStreams=n.matchedStreams.filter((function(t){return t!==e}));e.segmentIndex&&e.closeSegmentIndex(),this.usedPeriodIds_.delete(t)}},shaka.util.PeriodCombiner.prototype.getStreamsPerPeriod_=function(e,t){for(var r=shaka.util.ManifestParserUtils.ContentType,n=shaka.util.PeriodCombiner,a=[],i=[],s=[],o=[],l=(e=$jscomp.makeIterator(e)).next();!l.done;l=e.next()){var u=l.value;l=new Map(u.audioStreams.map((function(e){return[n.generateAudioKey_(e),e]})));var c=new Map(u.videoStreams.map((function(e){return[n.generateVideoKey_(e),e]}))),d=new Map(u.textStreams.map((function(e){return[n.generateTextKey_(e),e]})));if(u=new Map(u.imageStreams.map((function(e){return[n.generateImageKey_(e),e]}))),t){var p=n.dummyStream_(r.TEXT);d.set(n.generateTextKey_(p),p),p=n.dummyStream_(r.IMAGE),u.set(n.generateImageKey_(p),p)}a.push(l),i.push(c),s.push(d),o.push(u)}return{audioStreamsPerPeriod:a,videoStreamsPerPeriod:i,textStreamsPerPeriod:s,imageStreamsPerPeriod:o}},shaka.util.PeriodCombiner.prototype.combinePeriods=function(e,t,r){r=void 0!==r&&r;var n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M,D,O,L=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(N){if(1==N.nextAddress){if(n=shaka.util.ManifestParserUtils.ContentType,!t&&1==e.length)return a=L.getStreamsPerPeriod_(e,!1),i=a.audioStreamsPerPeriod,s=a.videoStreamsPerPeriod,o=a.textStreamsPerPeriod,l=a.imageStreamsPerPeriod,L.audioStreams_=Array.from(i[0].values()),L.videoStreams_=Array.from(s[0].values()),L.textStreams_=Array.from(o[0].values()),L.imageStreams_=Array.from(l[0].values()),N.jumpTo(2);for(u=r?L.usedPeriodIds_.size:0,c=-1,d=0;d<e.length;d++)p=e[d],L.usedPeriodIds_.has(p.id)||(L.usedPeriodIds_.add(p.id),-1==c&&(c=d));return-1==c?N.return():(h=L.getStreamsPerPeriod_(e,!0),f=h.audioStreamsPerPeriod,m=h.videoStreamsPerPeriod,g=h.textStreamsPerPeriod,y=h.imageStreamsPerPeriod,N.yield(Promise.all([L.combine_(L.audioStreams_,f,c,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_,u),L.combine_(L.videoStreams_,m,c,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_,u),L.combine_(L.textStreams_,g,c,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_,u),L.combine_(L.imageStreams_,y,c,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_,u)]),2))}if(v=0,_=[],L.videoStreams_.length&&L.audioStreams_.length)for(P=$jscomp.makeIterator(L.audioStreams_),C=P.next();!C.done;C=P.next())for(x=C.value,I=$jscomp.makeIterator(L.videoStreams_),w=I.next();!w.done;w=I.next())R=w.value,M=shaka.drm.DrmUtils.getCommonDrmInfos(x.drmInfos,R.drmInfos),x.drmInfos.length&&R.drmInfos.length&&!M.length?shaka.log.warning("Incompatible DRM in audio & video, skipping variant creation.",x,R):(D=(x.bandwidth||0)+(R.bandwidth||0),x.dependencyStream&&(D+=x.dependencyStream.bandwidth||0),R.dependencyStream&&(D+=R.dependencyStream.bandwidth||0),O=v++,_.push({id:O,language:x.language,disabledUntilTime:0,primary:x.primary,audio:x,video:R,bandwidth:D,drmInfos:M,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(k=L.videoStreams_.length?L.videoStreams_:L.audioStreams_,E=$jscomp.makeIterator(k),b=E.next();!b.done;b=E.next())T=b.value,A=v++,S=T.bandwidth||0,T.dependencyStream&&(S+=T.dependencyStream.bandwidth||0),_.push({id:A,language:T.language,disabledUntilTime:0,primary:T.primary,audio:T.type==n.AUDIO?T:null,video:T.type==n.VIDEO?T:null,bandwidth:S,drmInfos:T.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});L.variants_=_,N.jumpToEnd()}))},shaka.util.PeriodCombiner.combineDbStreams=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w;return $jscomp.asyncExecutePromiseGeneratorProgram((function(R){switch(R.nextAddress){case 1:if(t=shaka.util.ManifestParserUtils.ContentType,r=shaka.util.PeriodCombiner,1==e.length)return R.return(e[0]);for(n=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.AUDIO})).map((function(e){return[r.generateAudioKey_(e),e]})))})),a=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.VIDEO})).map((function(e){return[r.generateVideoKey_(e),e]})))})),i=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.TEXT})).map((function(e){return[r.generateTextKey_(e),e]})))})),s=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.IMAGE})).map((function(e){return[r.generateImageKey_(e),e]})))})),o=$jscomp.makeIterator(i),l=o.next();!l.done;l=o.next())u=l.value,c=r.dummyStreamDB_(t.TEXT),u.set(r.generateTextKey_(c),c);for(d=$jscomp.makeIterator(s),p=d.next();!p.done;p=d.next())h=p.value,f=r.dummyStreamDB_(t.IMAGE),h.set(r.generateImageKey_(f),f);return m=new shaka.util.PeriodCombiner,R.yield(m.combine_([],n,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_,0),2);case 2:return g=R.yieldResult,R.yield(m.combine_([],a,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_,0),3);case 3:return y=R.yieldResult,R.yield(m.combine_([],i,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_,0),4);case 4:return v=R.yieldResult,R.yield(m.combine_([],s,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_,0),5);case 5:if(_=R.yieldResult,k=0,y.length&&g.length)for(A=$jscomp.makeIterator(g),S=A.next();!S.done;S=A.next())for(P=S.value,C=$jscomp.makeIterator(y),x=C.next();!x.done;x=C.next())I=x.value,w=k++,I.variantIds.push(w),P.variantIds.push(w);else for(E=y.concat(g),b=$jscomp.makeIterator(E),T=b.next();!T.done;T=b.next())T.value.variantIds=[k++];return R.return(y.concat(g).concat(v).concat(_))}}))},shaka.util.PeriodCombiner.prototype.combine_=function(e,t,r,n,a,i){var s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(S){switch(S.nextAddress){case 1:for(s=[],o=0;o<t.length;o++)o>=r?s.push(new Set(t[o].values())):s.push(new Set);l=$jscomp.makeIterator(e),u=l.next();case 2:if(u.done){S.jumpTo(4);break}return c=u.value,S.yield(A.extendExistingOutputStream_(c,t,r,a,s,i),5);case 5:if(!S.yieldResult)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.PERIOD_FLATTENING_FAILED);u=l.next(),S.jumpTo(2);break;case 4:for(d=$jscomp.makeIterator(s),p=d.next();!p.done;p=d.next())for(h=p.value,f=$jscomp.makeIterator(h),m=f.next();!m.done;m=f.next())g=m.value,(y=A.createNewOutputStream_(g,t,n,a,s))&&e.push(y);for(v=$jscomp.makeIterator(s),_=v.next();!_.done;_=v.next())for(k=_.value,E=$jscomp.makeIterator(k),b=E.next(),T={};!b.done;T={stream$jscomp$105:void 0},b=E.next())if(T.stream$jscomp$105=b.value,!shaka.util.PeriodCombiner.isDummy_(T.stream$jscomp$105)&&e.some(function(e){return function(t){return A.areAVStreamsCompatible_(e.stream$jscomp$105,t)}}(T)))throw shaka.log.error("Unused stream in period-flattening!",T.stream$jscomp$105,e),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.PERIOD_FLATTENING_FAILED);return S.return(e)}}))},shaka.util.PeriodCombiner.prototype.extendExistingOutputStream_=function(e,t,r,n,a,i){var s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(s.findMatchesInAllPeriods_(t,e,0<i),goog.asserts.assert(e.createSegmentIndex,"outputStream should be a Stream type!"),e.matchedStreams?e.segmentIndex?o.yield(shaka.util.PeriodCombiner.extendOutputSegmentIndex_(e,r+i),2):o.jumpTo(2):(shaka.log.error("No matches extending output stream!",e,t),o.return(!1))):(shaka.util.PeriodCombiner.extendOutputStream_(e,r,n,a,i),o.return(!0))}))},shaka.util.PeriodCombiner.extendOutputSegmentIndex_=function(e,t){var r,n,a,i,s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress){for(r=[],n=e.matchedStreams,goog.asserts.assert(n,"matched streams should be valid"),a=t;a<n.length;a++)i=n[a],r.push(i.createSegmentIndex()),i.trickModeVideo&&!i.trickModeVideo.segmentIndex&&r.push(i.trickModeVideo.createSegmentIndex()),i.dependencyStream&&!i.dependencyStream.segmentIndex&&r.push(i.dependencyStream.createSegmentIndex());return l.yield(Promise.all(r),2)}if(e.segmentIndex instanceof shaka.media.MetaSegmentIndex)for(s=t;s<n.length;s++)o=n[s],goog.asserts.assert(o.segmentIndex,"stream should have a segmentIndex."),o.segmentIndex&&e.segmentIndex.appendSegmentIndex(o.segmentIndex);l.jumpToEnd()}))},shaka.util.PeriodCombiner.prototype.createNewOutputStream_=function(e,t,r,n,a){if(shaka.util.PeriodCombiner.isDummy_(e))return null;var i=r(e);return this.findMatchesInAllPeriods_(t,i),i.createSegmentIndex&&(i.createSegmentIndex=function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return i.segmentIndex?e.jumpTo(0):(i.segmentIndex=new shaka.media.MetaSegmentIndex,e.yield(shaka.util.PeriodCombiner.extendOutputSegmentIndex_(i,0),0))}))}),i.matchedStreams&&i.matchedStreams.length?(shaka.util.PeriodCombiner.extendOutputStream_(i,0,n,a,0),i):null},shaka.util.PeriodCombiner.extendOutputStream_=function(e,t,r,n,a){var i=shaka.util.ManifestParserUtils.ContentType,s=shaka.util.LanguageUtils,o=e.matchedStreams;for(goog.asserts.assert(e.matchedStreams,"matchedStreams should be non-null"),t+=a;t<o.length;t++){var l=o[t];r(e,l);var u=!0;if(e.type==i.AUDIO&&0==s.relatedness(e.language,l.language)&&(u=!1),u&&(n[t-a].delete(l),l.fullMimeTypes))for(u=(l=$jscomp.makeIterator(l.fullMimeTypes.values())).next();!u.done;u=l.next())e.fullMimeTypes.add(u.value)}},shaka.util.PeriodCombiner.cloneStream_=function(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var e=$jscomp.makeIterator(t.matchedStreams),r=e.next();!r.done;r=e.next())(r=r.value).segmentIndex&&(r.segmentIndex.release(),r.segmentIndex=null)},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set(e.keyIds),t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t.trickModeVideo=null,t.dependencyStream=null,t},shaka.util.PeriodCombiner.cloneStreamDB_=function(e){var t=Object.assign({},e);return t.roles=t.roles.slice(),t.keyIds=new Set(e.keyIds),t.segments=[],t.variantIds=[],t.closedCaptions=e.closedCaptions?new Map(e.closedCaptions):null,t},shaka.util.PeriodCombiner.concatenateStreams_=function(e,t){var r=function(e,t){e||(e=[]);for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=r.value,e.includes(r)||e.push(r);return e};e.roles=r(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=r(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var n=(r=$jscomp.makeIterator(t.keyIds)).next();!n.done;n=r.next())e.keyIds.add(n.value);if(null==e.originalId?e.originalId=t.originalId:(r=t.originalId||"")&&!e.originalId.endsWith(r)&&(e.originalId+=","+r),r=shaka.drm.DrmUtils.getCommonDrmInfos(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!r.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.INCONSISTENT_DRM_ACROSS_PERIODS);if(e.drmInfos=r,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),n=(r=$jscomp.makeIterator(t.closedCaptions)).next();!n.done;n=r.next()){var a=$jscomp.makeIterator(n.value);n=a.next().value,a=a.next().value,e.closedCaptions.set(n,a)}e.bandwidth&&t.bandwidth&&(e.bandwidth=Math.max(e.bandwidth,t.bandwidth)),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=shaka.util.PeriodCombiner.cloneStream_(t.trickModeVideo),e.trickModeVideo.matchedStreams=[],e.trickModeVideo.createSegmentIndex=function(){if(e.trickModeVideo.segmentIndex)return Promise.resolve();var t=new shaka.media.MetaSegmentIndex;goog.asserts.assert(e.trickModeVideo.matchedStreams,"trickmode matched streams should exist");for(var r=$jscomp.makeIterator(e.trickModeVideo.matchedStreams),n=r.next();!n.done;n=r.next())n=n.value,goog.asserts.assert(n.segmentIndex,"trickmode segment index should exist"),t.appendSegmentIndex(n.segmentIndex);return e.trickModeVideo.segmentIndex=t,Promise.resolve()}),e.trickModeVideo.matchedStreams.push(t.trickModeVideo),shaka.util.PeriodCombiner.concatenateStreams_(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&(e.trickModeVideo.matchedStreams.push(t),shaka.util.PeriodCombiner.concatenateStreams_(e.trickModeVideo,t)),t.dependencyStream?(e.dependencyStream||(e.dependencyStream=shaka.util.PeriodCombiner.cloneStream_(t.dependencyStream),e.dependencyStream.matchedStreams=[],e.dependencyStream.createSegmentIndex=function(){if(e.dependencyStream.segmentIndex)return Promise.resolve();var t=new shaka.media.MetaSegmentIndex;goog.asserts.assert(e.dependencyStream.matchedStreams,"dependency video matched streams should exist");for(var r=$jscomp.makeIterator(e.dependencyStream.matchedStreams),n=r.next();!n.done;n=r.next())n=n.value,goog.asserts.assert(n.segmentIndex,"dependency video segment index should exist"),t.appendSegmentIndex(n.segmentIndex);return e.dependencyStream.segmentIndex=t,Promise.resolve()}),e.dependencyStream.matchedStreams.push(t.dependencyStream),shaka.util.PeriodCombiner.concatenateStreams_(e.dependencyStream,t.dependencyStream)):e.dependencyStream&&(e.dependencyStream.matchedStreams.push(t),shaka.util.PeriodCombiner.concatenateStreams_(e.dependencyStream,t))},shaka.util.PeriodCombiner.concatenateStreamDBs_=function(e,t){var r=e.roles;r||(r=[]);for(var n=$jscomp.makeIterator(t.roles),a=n.next();!a.done;a=n.next())a=a.value,r.includes(a)||r.push(a);for(e.roles=r,n=(r=$jscomp.makeIterator(t.keyIds)).next();!n.done;n=r.next())e.keyIds.add(n.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,$jscomp.arrayFromIterable(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),r=(t=$jscomp.makeIterator(t.closedCaptions)).next();!r.done;r=t.next())r=(n=$jscomp.makeIterator(r.value)).next().value,n=n.next().value,e.closedCaptions.set(r,n)},shaka.util.PeriodCombiner.prototype.findMatchesInAllPeriods_=function(e,t,r){r=void 0!==r&&r?t.matchedStreams:[];for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){if(!(n=this.findBestMatchInPeriod_(n.value,t)))return;r.push(n)}t.matchedStreams=r},shaka.util.PeriodCombiner.prototype.findBestMatchInPeriod_=function(e,t){var r=this,n={audio:shaka.util.PeriodCombiner.generateAudioKey_,video:shaka.util.PeriodCombiner.generateVideoKey_,text:shaka.util.PeriodCombiner.generateTextKey_,image:shaka.util.PeriodCombiner.generateImageKey_}[t.type],a=null,i=n(t);if(e.has(i))a=e.get(i);else{i={audio:function(e,t){return r.areAVStreamsCompatible_(e,t)},video:function(e,t){return r.areAVStreamsCompatible_(e,t)},text:shaka.util.PeriodCombiner.areTextStreamsCompatible_,image:shaka.util.PeriodCombiner.areImageStreamsCompatible_}[t.type];for(var s={audio:shaka.util.PeriodCombiner.isAudioStreamBetterMatch_,video:shaka.util.PeriodCombiner.isVideoStreamBetterMatch_,text:shaka.util.PeriodCombiner.isTextStreamBetterMatch_,image:shaka.util.PeriodCombiner.isImageStreamBetterMatch_}[t.type],o=$jscomp.makeIterator(e.values()),l=o.next();!l.done;l=o.next())!i(t,l=l.value)||t.fastSwitching!=l.fastSwitching||a&&!s(t,a,l)||(a=l)}return this.useStreamOnce_&&!shaka.util.PeriodCombiner.isDummy_(a)&&e.delete(n(a)),a},shaka.util.PeriodCombiner.areAVStreamsExactMatch_=function(e,t){return e.mimeType==t.mimeType&&shaka.util.PeriodCombiner.getCodec_(e.codecs)===shaka.util.PeriodCombiner.getCodec_(t.codecs)},shaka.util.PeriodCombiner.prototype.setAllowMultiTypeVariants=function(e){this.multiTypeVariantsAllowed_=e},shaka.util.PeriodCombiner.prototype.setUseStreamOnce=function(e){this.useStreamOnce_=e},shaka.util.PeriodCombiner.prototype.areAVStreamsCompatible_=function(e,t){return!(!shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,t)&&!this.multiTypeVariantsAllowed_||e.drmInfos&&!shaka.drm.DrmUtils.areDrmCompatible(e.drmInfos,t.drmInfos))},shaka.util.PeriodCombiner.areTextStreamsCompatible_=function(e,t){return!t.language||e.forced===t.forced&&0!=shaka.util.LanguageUtils.relatedness(e.language,t.language)&&t.kind==e.kind},shaka.util.PeriodCombiner.areImageStreamsCompatible_=function(e,t){return!0},shaka.util.PeriodCombiner.isAudioStreamBetterMatch_=function(e,t,r){var n=shaka.util.LanguageUtils,a=shaka.util.PeriodCombiner.BetterOrWorse,i=a.BETTER;a=a.WORSE;var s=shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,t),o=shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,r);if(s&&!o)return!1;if(!s&&o)return!0;if(s=n.relatedness(e.language,t.language),(n=n.relatedness(e.language,r.language))>s)return!0;if(n<s)return!1;if(t.label!==r.label){if(e.label===t.label)return!1;if(e.label===r.label)return!0}if(e.roles.length){if(n=t.roles.filter((function(t){return e.roles.includes(t)})),s=r.roles.filter((function(t){return e.roles.includes(t)})),s.length>n.length)return!0;if(s.length<n.length)return!1;if(r.roles.length!==t.roles.length)return r.roles.length<t.roles.length}else{if(!r.roles.length&&t.roles.length)return!0;if(r.roles.length&&!t.roles.length)return!1}return!(t.primary||!r.primary)||!(t.primary&&!r.primary)&&((n=shaka.util.PeriodCombiner.compareClosestPreferLower(e.channelsCount,t.channelsCount,r.channelsCount))==i||n!=a&&((n=shaka.util.PeriodCombiner.compareClosestPreferLower(e.audioSamplingRate,t.audioSamplingRate,r.audioSamplingRate))==i||n!=a&&!(!e.bandwidth||shaka.util.PeriodCombiner.compareClosestPreferMinimalAbsDiff_(e.bandwidth,t.bandwidth,r.bandwidth)!=i)))},shaka.util.PeriodCombiner.isVideoStreamBetterMatch_=function(e,t,r){var n=shaka.util.PeriodCombiner.BetterOrWorse,a=n.BETTER;n=n.WORSE;var i=shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,t),s=shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,r);if(i&&!s)return!1;if(!i&&s)return!0;if((i=shaka.util.PeriodCombiner.compareClosestPreferLower(e.width*e.height,t.width*t.height,r.width*r.height))==a)return!0;if(i==n)return!1;if(e.frameRate){if((i=shaka.util.PeriodCombiner.compareClosestPreferLower(e.frameRate,t.frameRate,r.frameRate))==a)return!0;if(i==n)return!1}return!(!e.bandwidth||shaka.util.PeriodCombiner.compareClosestPreferMinimalAbsDiff_(e.bandwidth,t.bandwidth,r.bandwidth)!=a)},shaka.util.PeriodCombiner.isTextStreamBetterMatch_=function(e,t,r){var n=shaka.util.LanguageUtils,a=n.relatedness(e.language,t.language);if((n=n.relatedness(e.language,r.language))>a)return!0;if(n<a)return!1;if(!t.primary&&r.primary)return!0;if(t.primary&&!r.primary)return!1;if(t.label!==r.label){if(e.label===t.label)return!1;if(e.label===r.label)return!0}if(e.roles.length){if(a=t.roles.filter((function(t){return e.roles.includes(t)})),(n=r.roles.filter((function(t){return e.roles.includes(t)}))).length>a.length)return!0;if(n.length<a.length)return!1}else{if(!r.roles.length&&t.roles.length)return!0;if(r.roles.length&&!t.roles.length)return!1}return r.mimeType==e.mimeType&&r.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)},shaka.util.PeriodCombiner.isImageStreamBetterMatch_=function(e,t,r){var n=shaka.util.PeriodCombiner.BetterOrWorse.BETTER;return shaka.util.PeriodCombiner.compareClosestPreferLower(e.width*e.height,t.width*t.height,r.width*r.height)==n},shaka.util.PeriodCombiner.dummyStreamDB_=function(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1,baseOriginalId:null}},shaka.util.PeriodCombiner.dummyStream_=function(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new shaka.media.SegmentIndex([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null}},shaka.util.PeriodCombiner.compareClosestPreferLower=function(e,t,r){var n=shaka.util.PeriodCombiner.BetterOrWorse,a=n.BETTER,i=n.WORSE;if(t==e&&e!=r)return i;if(r==e&&e!=t)return a;if(t>e){if(r<=e||r-e<t-e)return a;if(r-e>t-e)return i}else{if(r>e)return i;if(e-r<e-t)return a;if(e-r>e-t)return i}return n.EQUAL},shaka.util.PeriodCombiner.compareClosestPreferMinimalAbsDiff_=function(e,t,r){var n=shaka.util.PeriodCombiner.BetterOrWorse,a=n.BETTER,i=n.WORSE;return t=Math.abs(e-t),(e=Math.abs(e-r))<t?a:t<e?i:n.EQUAL},shaka.util.PeriodCombiner.isDummy_=function(e){var t=shaka.util.ManifestParserUtils.ContentType;switch(e.type){case t.TEXT:return!e.language;case t.IMAGE:return!e.tilesLayout;default:return!1}},shaka.util.PeriodCombiner.generateVideoKey_=function(e){return shaka.util.PeriodCombiner.generateKey_([e.fastSwitching,e.width,e.frameRate,shaka.util.PeriodCombiner.getCodec_(e.codecs),e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])},shaka.util.PeriodCombiner.generateAudioKey_=function(e){return shaka.util.PeriodCombiner.generateKey_([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,shaka.util.PeriodCombiner.getCodec_(e.codecs),e.mimeType,e.roles,e.audioSamplingRate,e.primary,e.dependencyStream?e.dependencyStream.baseOriginalId:null,Array.from(e.keyIds)])},shaka.util.PeriodCombiner.generateTextKey_=function(e){return shaka.util.PeriodCombiner.generateKey_([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])},shaka.util.PeriodCombiner.generateImageKey_=function(e){return shaka.util.PeriodCombiner.generateKey_([e.width,e.codecs,e.mimeType])},shaka.util.PeriodCombiner.generateKey_=function(e){return JSON.stringify(e)},shaka.util.PeriodCombiner.getCodec_=function(e){if(!shaka.util.PeriodCombiner.memoizedCodecs.has(e)){var t=shaka.util.MimeUtils.getNormalizedCodec(e);shaka.util.PeriodCombiner.memoizedCodecs.set(e,t)}return shaka.util.PeriodCombiner.memoizedCodecs.get(e)},goog.exportSymbol("shaka.util.PeriodCombiner",shaka.util.PeriodCombiner),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"setUseStreamOnce",shaka.util.PeriodCombiner.prototype.setUseStreamOnce),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"setAllowMultiTypeVariants",shaka.util.PeriodCombiner.prototype.setAllowMultiTypeVariants),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"combinePeriods",shaka.util.PeriodCombiner.prototype.combinePeriods),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"deleteStream",shaka.util.PeriodCombiner.prototype.deleteStream),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"getImageStreams",shaka.util.PeriodCombiner.prototype.getImageStreams),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"getTextStreams",shaka.util.PeriodCombiner.prototype.getTextStreams),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"getVariants",shaka.util.PeriodCombiner.prototype.getVariants),shaka.util.PeriodCombiner.BetterOrWorse={BETTER:1,EQUAL:0,WORSE:-1},shaka.util.PeriodCombiner.memoizedCodecs=new Map,shaka.util.XmlUtils=function(){},shaka.util.XmlUtils.parseXmlString=function(e,t){var r=new DOMParser,n=shaka.util.XmlUtils.trustedHTMLFromString_.value()(e);e=null;try{e=r.parseFromString(n,"text/xml")}catch(e){return shaka.log.error("XML parsing exception:",e),null}if(goog.asserts.assert(e,"Parsed XML document cannot be null!"),!(r=e.documentElement))return shaka.log.error("XML document was empty!"),null;if((n=r.getElementsByTagName("parsererror")).length)return shaka.log.error("XML parser error found:",n[0]),null;if(r.tagName!=t)return shaka.log.error('XML tag name does not match expected "'+t+'":',r.tagName),null;if(!("createNodeIterator"in document))return r;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return shaka.log.error("XML document embeds unsafe content!"),null;return r},shaka.util.XmlUtils.parseXml=function(e,t){try{var r=shaka.util.StringUtils.fromBytesAutoDetect(e);return shaka.util.XmlUtils.parseXmlString(r,t)}catch(e){return shaka.log.error("parseXmlString threw!",e),null}},shaka.util.XmlUtils.toArrayBuffer=function(e){return shaka.util.StringUtils.toUTF8(e.outerHTML)},shaka.util.XmlUtils.trustedHTMLFromString_=new shaka.util.Lazy((function(){if("undefined"!=typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}})),shaka.dash.DashParser=function(){var e=this;this.playerInterface_=this.config_=null,this.manifestUris_=[],this.manifest_=null,this.globalId_=1,this.patchLocationNodes_=[],this.manifestPatchContext_={mpdId:"",type:"",profiles:[],mediaPresentationDuration:null,availabilityTimeOffset:0,getBaseUris:null,publishTime:0},this.contextCache_=new Map,this.streamMap_=new Map,this.indexStreamMap_=new Map,this.periodDurations_=new Map,this.periodCombiner_=new shaka.util.PeriodCombiner,this.updatePeriod_=0,this.averageUpdateDuration_=new shaka.abr.Ewma(5),this.updateTimer_=new shaka.util.Timer((function(){e.mediaElement_&&!e.config_.continueLoadingWhenPaused&&(e.eventManager_.unlisten(e.mediaElement_,"timeupdate"),e.mediaElement_.paused)?e.eventManager_.listenOnce(e.mediaElement_,"timeupdate",(function(){return e.onUpdate_()})):e.onUpdate_()})),this.operationManager_=new shaka.util.OperationManager,this.largestPeriodStartTime_=null,this.lastManifestUpdatePeriodIds_=[],this.minTotalAvailabilityTimeOffset_=1/0,this.lowLatencyMode_=!1,this.contentSteeringManager_=null,this.gapCount_=0,this.isLowLatency_=!1,this.eventManager_=new shaka.util.EventManager,this.mediaElement_=null,this.isTransitionFromDynamicToStatic_=!1,this.lastManifestQueryParams_="",this.isPreloadFn_=function(){return!1},this.lastCalculatedBaseUris_=[]},shaka.dash.DashParser.prototype.configure=function(e,t){goog.asserts.assert(null!=e.dash,"DashManifestConfiguration should not be null!");var r=this.playerInterface_&&e.updatePeriod!=this.config_.updatePeriod&&0<=e.updatePeriod;this.config_=e,t&&(this.isPreloadFn_=t),r&&this.manifest_&&this.manifest_.presentationTimeline.isLive()&&this.updateNow_(),this.contentSteeringManager_&&this.contentSteeringManager_.configure(this.config_),this.periodCombiner_&&(this.periodCombiner_.setAllowMultiTypeVariants(this.config_.dash.multiTypeVariantsAllowed&&shaka.media.Capabilities.isChangeTypeSupported()),this.periodCombiner_.setUseStreamOnce(this.config_.dash.useStreamOnceInPeriodFlattening))},shaka.dash.DashParser.prototype.start=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return goog.asserts.assert(n.config_,"Must call configure() before start()!"),n.lowLatencyMode_=t.isLowLatencyMode(),n.manifestUris_=[e],n.playerInterface_=t,a.yield(n.requestManifest_(),2);if(r=a.yieldResult,n.playerInterface_&&n.setUpdateTimer_(r),!n.playerInterface_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);return goog.asserts.assert(n.manifest_,"Manifest should be non-null!"),a.return(n.manifest_)}))},shaka.dash.DashParser.prototype.stop=function(){for(var e=$jscomp.makeIterator(this.streamMap_.values()),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();return this.periodCombiner_&&this.periodCombiner_.release(),this.config_=this.playerInterface_=null,this.manifestUris_=[],this.manifest_=null,this.streamMap_.clear(),this.indexStreamMap_.clear(),this.contextCache_.clear(),this.manifestPatchContext_={mpdId:"",type:"",profiles:[],mediaPresentationDuration:null,availabilityTimeOffset:0,getBaseUris:null,publishTime:0},this.periodCombiner_=null,null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null),this.contentSteeringManager_&&this.contentSteeringManager_.destroy(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.operationManager_.destroy()},shaka.dash.DashParser.prototype.update=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(r.setCatchFinallyBlocks(2),r.yield(t.requestManifest_(),4)):2!=r.nextAddress?r.leaveTryBlock(0):(e=r.enterCatchBlock(),t.playerInterface_&&e?(goog.asserts.assert(e instanceof shaka.util.Error,"Bad error type"),t.playerInterface_.onError(e),void r.jumpToEnd()):r.return())}))},shaka.dash.DashParser.prototype.onExpirationUpdated=function(e,t){},shaka.dash.DashParser.prototype.onInitialVariantChosen=function(e){if(this.manifest_&&this.manifest_.presentationTimeline.isLive()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.manifest_.presentationTimeline.getSegmentAvailabilityEnd();var r=t.segmentIndex.find(e);null!=r&&(t=t.segmentIndex.get(r))&&(this.updatePeriod_=t.endTime-e,this.setUpdateTimer_(0))}}},shaka.dash.DashParser.prototype.banLocation=function(e){this.contentSteeringManager_&&this.contentSteeringManager_.banLocation(e)},shaka.dash.DashParser.prototype.setMediaElement=function(e){this.mediaElement_=e},shaka.dash.DashParser.prototype.requestManifest_=function(){var e,t,r,n,a,i,s,o,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){return 1==h.nextAddress?(e=shaka.net.NetworkingEngine.RequestType.MANIFEST,t=shaka.net.NetworkingEngine.AdvancedRequestType.MPD,r="MPD",n=p.getPatchLocationUris_(),a=p.manifestUris_,n.length?(a=n,r="Patch",t=shaka.net.NetworkingEngine.AdvancedRequestType.MPD_PATCH):1<p.manifestUris_.length&&p.contentSteeringManager_&&((i=p.contentSteeringManager_.getLocations("Location",!0)).length&&(a=i)),s=shaka.net.NetworkingEngine.makeRequest(a,p.config_.retryParameters),o=Date.now(),h.yield(p.makeNetworkRequest_(s,e,{type:t}),2)):3!=h.nextAddress?(l=h.yieldResult,p.playerInterface_?(l.uri&&l.uri!=l.originalUri&&!p.manifestUris_.includes(l.uri)&&p.manifestUris_.unshift(l.uri),u=new goog.Uri(l.uri),p.lastManifestQueryParams_=u.getQueryData().toString(),h.yield(p.parseManifest_(l.data,l.uri,r),3)):h.return(0)):(c=Date.now(),d=(c-o)/1e3,p.averageUpdateDuration_.sample(1,d),h.return(d))}))},shaka.dash.DashParser.prototype.parseManifest_=function(e,t,r){var n,a,i,s,o,l,u,c,d,p,h=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(f){if(1==f.nextAddress){if(n=e,a=h.config_.dash.manifestPreprocessor,i=shaka.util.PlayerConfiguration.defaultManifestPreprocessor,a!=i){if(shaka.Deprecate.deprecateFeature(5,"manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),!(s=shaka.util.XmlUtils.parseXml(n,r)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_INVALID_XML,t);a(s),n=shaka.util.XmlUtils.toArrayBuffer(s)}if(!(o=shaka.util.TXml.parseXml(n,r)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_INVALID_XML,t);return l=h.config_.dash.manifestPreprocessorTXml,u=shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml,l!=u&&l(o),"Patch"===r?f.return(h.processPatchManifest_(o)):h.config_.dash.disableXlinkProcessing?f.return(h.processManifest_(o,t)):(c=h.config_.dash.xlinkFailGracefully,d=shaka.dash.MpdUtils.processXlinks(o,h.config_.retryParameters,c,t,h.playerInterface_.networkingEngine),h.operationManager_.manage(d),f.yield(d.promise,2))}return p=f.yieldResult,f.return(h.processManifest_(p,t))}))},shaka.dash.DashParser.prototype.processManifest_=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M,D,O,L,N,U,j,B,F,V,G,H,K,W,$,z,q,Y,X,Z,Q,J,ee,te,re=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(ne){switch(ne.nextAddress){case 1:for(r=shaka.util.TXml,goog.asserts.assert(re.config_,"Must call configure() before processManifest_()!"),re.contentSteeringManager_&&re.contentSteeringManager_.clearPreviousLocations(),n=[t],a=[],i=new Map,s=r.findChildren(e,"Location"),o=$jscomp.makeIterator(s),l=o.next();!l.done;l=o.next())u=l.value,c=u.attributes.serviceLocation,(d=r.getContents(u))&&(p=shaka.util.ManifestParserUtils.resolveUris(n,[d])[0],c&&(re.contentSteeringManager_?re.contentSteeringManager_.addLocation("Location",c,p):i.set(c,p)),a.push(p));if(re.contentSteeringManager_?0<(h=re.contentSteeringManager_.getLocations("Location",!0)).length&&(n=re.manifestUris_=h):a.length&&(n=re.manifestUris_=a),re.manifestPatchContext_.mpdId=e.attributes.id||"",re.manifestPatchContext_.publishTime=r.parseAttr(e,"publishTime",r.parseDate)||0,re.patchLocationNodes_=r.findChildren(e,"PatchLocation"),f=Promise.resolve(),(m=r.findChild(e,"ContentSteering"))&&re.playerInterface_)for(g=m.attributes.defaultServiceLocation,re.contentSteeringManager_?(re.contentSteeringManager_.setBaseUris(n),re.contentSteeringManager_.setDefaultPathwayId(g)):(re.contentSteeringManager_=new shaka.util.ContentSteeringManager(re.playerInterface_),re.contentSteeringManager_.configure(re.config_),re.contentSteeringManager_.setManifestType(shaka.media.ManifestParser.DASH),re.contentSteeringManager_.setBaseUris(n),re.contentSteeringManager_.setDefaultPathwayId(g),(y=r.getContents(m))&&(r.parseAttr(m,"queryBeforeStart",r.parseBoolean,!1)?f=re.contentSteeringManager_.requestInfo(y):re.contentSteeringManager_.requestInfo(y))),v=$jscomp.makeIterator(i.keys()),_=v.next();!_.done;_=v.next())k=_.value,E=i.get(k),re.contentSteeringManager_.addLocation("Location",k,E);if(b=r.findChildren(e,"BaseURL"),T=!1,re.contentSteeringManager_)for(A=$jscomp.makeIterator(b),S=A.next();!S.done;S=A.next())P=S.value,C=P.attributes.serviceLocation,x=r.getContents(P),C&&x&&(re.contentSteeringManager_.addLocation("BaseURL",C,x),T=!0);if(re.lastCalculatedBaseUris_=null,T&&re.contentSteeringManager_||(I=b.map(r.getContents),re.lastCalculatedBaseUris_=shaka.util.ManifestParserUtils.resolveUris(n,I)),w=function(){return re.contentSteeringManager_&&T?re.contentSteeringManager_.getLocations("BaseURL"):re.lastCalculatedBaseUris_?re.lastCalculatedBaseUris_:[]},re.manifestPatchContext_.getBaseUris=w,R=0,b&&b.length&&(R=r.parseAttr(b[0],"availabilityTimeOffset",r.parseFloat)||0),re.manifestPatchContext_.availabilityTimeOffset=R,re.updatePeriod_=r.parseAttr(e,"minimumUpdatePeriod",r.parseDuration,-1),M=r.parseAttr(e,"availabilityStartTime",r.parseDate),D=r.parseAttr(e,"timeShiftBufferDepth",r.parseDuration),O=re.config_.dash.ignoreSuggestedPresentationDelay,L=null,O||(L=r.parseAttr(e,"suggestedPresentationDelay",r.parseDuration)),N=re.config_.dash.ignoreMaxSegmentDuration,U=null,N||(U=r.parseAttr(e,"maxSegmentDuration",r.parseDuration)),j=e.attributes.type||"static",re.manifest_&&re.manifest_.presentationTimeline&&(re.isTransitionFromDynamicToStatic_=re.manifest_.presentationTimeline.isLive()&&"static"==j),re.manifestPatchContext_.type=j,re.manifest_)for(B=re.manifest_.presentationTimeline,F=B.getSegmentAvailabilityStart(),V=$jscomp.makeIterator(re.streamMap_.values()),G=V.next();!G.done;G=V.next())(H=G.value).segmentIndex&&H.segmentIndex.evict(F);else K=re.config_.dash.ignoreMinBufferTime,W=0,K||(W=r.parseAttr(e,"minBufferTime",r.parseDuration)||0),0,$=null!=L?Math.min(L,D||1/0):0<re.config_.defaultPresentationDelay?re.config_.defaultPresentationDelay:Math.min(1.5*W,D||1/0),B=new shaka.media.PresentationTimeline(M,$,re.config_.dash.autoCorrectDrift);return B.setStatic("static"==j),B.isLive()&&!isNaN(re.config_.availabilityWindowOverride)&&(D=re.config_.availabilityWindowOverride),null==D&&(D=1/0),B.setSegmentAvailabilityDuration(D),z=e.attributes.profiles||"",re.manifestPatchContext_.profiles=z.split(","),q={dynamic:"static"!=j,presentationTimeline:B,period:null,periodInfo:null,adaptationSet:null,representation:null,bandwidth:0,indexRangeWarningGiven:!1,availabilityTimeOffset:R,mediaPresentationDuration:null,profiles:z.split(","),roles:null,urlParams:function(){return""}},ne.yield(f,2);case 2:return re.gapCount_=0,Y=re.parsePeriods_(q,w,e,!1),X=Y.duration,Z=Y.periods,("static"!=j||re.isTransitionFromDynamicToStatic_)&&Y.durationDerivedFromPeriods||B.setDuration(X||1/0),re.isLowLatency_&&re.lowLatencyMode_&&B.setAvailabilityTimeOffset(re.minTotalAvailabilityTimeOffset_),B.notifyMaxSegmentDuration(U||1),goog.DEBUG&&!re.isTransitionFromDynamicToStatic_&&B.assertIsValid(),re.isLowLatency_&&re.lowLatencyMode_&&(Q=null!=L?L:re.config_.defaultPresentationDelay,B.setDelay(Q)),re.manifest_?(re.manifest_.periodCount=Z.length,re.manifest_.gapCount=re.gapCount_,ne.yield(re.postPeriodProcessing_(Z,!1),4)):ne.yield(re.periodCombiner_.combinePeriods(Z,q.dynamic),6);case 6:if(re.manifest_={presentationTimeline:B,variants:re.periodCombiner_.getVariants(),textStreams:re.periodCombiner_.getTextStreams(),imageStreams:re.periodCombiner_.getImageStreams(),offlineSessionIds:[],sequenceMode:re.config_.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:shaka.media.ManifestParser.DASH,serviceDescription:re.parseServiceDescription_(e),nextUrl:re.parseMpdChaining_(e),periodCount:Z.length,gapCount:re.gapCount_,isLowLatency:re.isLowLatency_,startTime:null},!B.usingPresentationStartTime()){ne.jumpTo(7);break}return J=shaka.util.TXml,ee=J.findChildren(e,"UTCTiming"),ne.yield(re.parseUtcTiming_(w,ee),8);case 8:if(te=ne.yieldResult,!re.playerInterface_)return ne.return();B.setClockOffset(te);case 7:B.lockStartTime(),re.periodCombiner_&&!re.manifest_.presentationTimeline.isLive()&&re.periodCombiner_.release();case 4:re.playerInterface_.makeTextStreamsForClosedCaptions(re.manifest_),re.cleanStreamMap_(),ne.jumpToEnd()}}))},shaka.dash.DashParser.prototype.postPeriodProcessing_=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return a.yield(n.periodCombiner_.combinePeriods(e,!0,t),2);n.manifest_.variants=n.periodCombiner_.getVariants(),0<(r=n.periodCombiner_.getTextStreams()).length&&(n.manifest_.textStreams=r),n.manifest_.imageStreams=n.periodCombiner_.getImageStreams(),n.playerInterface_.filter(n.manifest_),a.jumpToEnd()}))},shaka.dash.DashParser.prototype.processPatchManifest_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(R){if(1==R.nextAddress){if(t=shaka.util.TXml,r=e.attributes.mpdId,n=t.parseAttr(e,"originalPublishTime",t.parseDate),!r||r!==w.manifestPatchContext_.mpdId||n!==w.manifestPatchContext_.publishTime)throw w.patchLocationNodes_=[],new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_INVALID_PATCH);for(a=[],i=[],s=new Set,o=$jscomp.makeIterator(t.getChildNodes(e)),l=o.next();!l.done;l=o.next()){if(u=l.value,c=!0,d=t.parseXpath(u.attributes.sel||""),p=d[d.length-1],h=t.getContents(u)||"","MPD"===p.name)"mediaPresentationDuration"===p.attribute?(f=t.getContents(u)||"",w.parsePatchMediaPresentationDurationChange_(f)):"type"===p.attribute?w.parsePatchMpdTypeChange_(h):"publishTime"===p.attribute?w.manifestPatchContext_.publishTime=t.parseDate(h)||0:null===p.attribute&&"add"===u.tagName?i.push(u):c=!1;else if("PatchLocation"===p.name)w.updatePatchLocationNodes_(u);else if("Period"===p.name)"add"===u.tagName?i.push(u):"remove"===u.tagName&&p.id&&w.removePatchPeriod_(p.id);else if("SegmentTemplate"===p.name)for(m=w.modifySegmentTemplate_(u),g=$jscomp.makeIterator(m),y=g.next();!y.done;y=g.next())v=y.value,s.add(v);else if("SegmentTimeline"===p.name||"S"===p.name)for(_=w.modifyTimepoints_(u),k=$jscomp.makeIterator(_),E=k.next();!E.done;E=k.next())b=E.value,s.add(b);else c=!1;c||shaka.log.warning("Unhandled "+u.tagName+" operation",u.attributes.sel)}for(T=$jscomp.makeIterator(s),A=T.next();!A.done;A=T.next())S=A.value,w.parsePatchSegment_(S);for(P=$jscomp.makeIterator(i),C=P.next();!C.done;C=P.next())x=C.value,a.push.apply(a,$jscomp.arrayFromIterable(w.parsePatchPeriod_(x)));return a.length?(w.manifest_.periodCount+=a.length,w.manifest_.gapCount=w.gapCount_,R.yield(w.postPeriodProcessing_(a,!0),2)):R.jumpTo(2)}"static"==w.manifestPatchContext_.type&&(I=w.manifestPatchContext_.mediaPresentationDuration,w.manifest_.presentationTimeline.setDuration(I||1/0)),R.jumpToEnd()}))},shaka.dash.DashParser.prototype.parsePatchMpdTypeChange_=function(e){this.manifest_.presentationTimeline.setStatic("static"==e),this.manifestPatchContext_.type=e;for(var t=$jscomp.makeIterator(this.contextCache_.values()),r=t.next();!r.done;r=t.next())r.value.dynamic="dynamic"==e;"static"==e&&(this.updatePeriod_=-1)},shaka.dash.DashParser.prototype.parsePatchMediaPresentationDurationChange_=function(e){if(null!=(e=shaka.util.TXml.parseDuration(e))){this.manifestPatchContext_.mediaPresentationDuration=e;for(var t=$jscomp.makeIterator(this.contextCache_.values()),r=t.next();!r.done;r=t.next())r.value.mediaPresentationDuration=e}},shaka.dash.DashParser.prototype.parsePatchPeriod_=function(e){return goog.asserts.assert(this.manifestPatchContext_.getBaseUris,"Must provide getBaseUris on manifestPatchContext_"),this.parsePeriods_({dynamic:"dynamic"==this.manifestPatchContext_.type,presentationTimeline:this.manifest_.presentationTimeline,period:null,periodInfo:null,adaptationSet:null,representation:null,bandwidth:0,indexRangeWarningGiven:!1,availabilityTimeOffset:this.manifestPatchContext_.availabilityTimeOffset,profiles:this.manifestPatchContext_.profiles,mediaPresentationDuration:this.manifestPatchContext_.mediaPresentationDuration,roles:null,urlParams:function(){return""}},this.manifestPatchContext_.getBaseUris,e,!0).periods},shaka.dash.DashParser.prototype.removePatchPeriod_=function(e){var t=shaka.dash.SegmentTemplate;this.manifest_.periodCount--;for(var r=$jscomp.makeIterator(this.contextCache_.keys()),n=r.next();!n.done;n=r.next())if((n=n.value).startsWith(e)){var a=this.contextCache_.get(n);t.removeTimepoints(a),this.parsePatchSegment_(n),this.contextCache_.delete(n)}this.lastManifestUpdatePeriodIds_=this.lastManifestUpdatePeriodIds_.filter((function(t){return t!==e}))},shaka.dash.DashParser.prototype.getContextIdsFromPath_=function(e){for(var t="",r="",n=-1,a="",i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next())"Period"===(i=i.value).name?t=i.id:"AdaptationSet"===i.name?(r=i.id,null!==i.position&&(n=i.position)):"Representation"===i.name&&(a=i.id);if(e=[],a)e.push(t+","+a);else if(r)for(a=(n=$jscomp.makeIterator(this.contextCache_.values())).next();!a.done;a=n.next())(a=a.value).period.id===t&&a.adaptationSet.id===r&&a.representation.id&&e.push(t+","+a.representation.id);else if(-1<n)for(a=(r=$jscomp.makeIterator(this.contextCache_.values())).next();!a.done;a=r.next())(a=a.value).period.id===t&&a.adaptationSet.position===n&&a.representation.id&&e.push(t+","+a.representation.id);return e},shaka.dash.DashParser.prototype.modifySegmentTemplate_=function(e){var t=shaka.util.TXml,r=t.parseXpath(e.attributes.sel||""),n=r[r.length-1];if(!n.attribute)return[];r=this.getContextIdsFromPath_(r);for(var a=t.getContents(e)||"",i=$jscomp.makeIterator(r),s=i.next();!s.done;s=i.next())s=this.contextCache_.get(s.value),goog.asserts.assert(s&&s.representation.segmentTemplate,"cannot modify segment template"),t.modifyNodeAttribute(s.representation.segmentTemplate,e.tagName,n.attribute,a);return r},shaka.dash.DashParser.prototype.modifyTimepoints_=function(e){var t=shaka.dash.SegmentTemplate,r=shaka.util.TXml.parseXpath(e.attributes.sel||"");r=this.getContextIdsFromPath_(r);for(var n=$jscomp.makeIterator(r),a=n.next();!a.done;a=n.next())a=this.contextCache_.get(a.value),t.modifyTimepoints(a,e);return r},shaka.dash.DashParser.prototype.parsePatchSegment_=function(e){var t=this,r=this.contextCache_.get(e),n=this.streamMap_.get(e);goog.asserts.assert(n,"stream should exist"),n.segmentIndex&&n.segmentIndex.evict(this.manifest_.presentationTimeline.getSegmentAvailabilityStart());try{var a=shaka.dash.SegmentTemplate.createStreamInfo(r,(function(e,r,n,a){return t.requestSegment_(e,r,n,a)}),this.streamMap_,!0,this.config_.dash.initialSegmentLimit,this.periodDurations_,r.representation.aesKey,null,!0);n.createSegmentIndex=function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){if(1==e.nextAddress)return n.segmentIndex?e.jumpTo(0):e.yield(a.generateSegmentIndex(),3);n.segmentIndex=e.yieldResult,e.jumpToEnd()}))}}catch(t){e=shaka.util.ManifestParserUtils.ContentType;var i=(r=r.representation.contentType)==e.IMAGE;if(r!=e.TEXT&&r!=e.APPLICATION&&!i||t.code!=shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)throw t}},shaka.dash.DashParser.prototype.parseServiceDescription_=function(e){var t=shaka.util.TXml,r=t.findChild(e,"ServiceDescription");return r?(e=t.findChild(r,"Latency"),t=t.findChild(r,"PlaybackRate"),e||t?(r={},e&&("target"in e.attributes&&(r.targetLatency=parseInt(e.attributes.target,10)/1e3),"max"in e.attributes&&(r.maxLatency=parseInt(e.attributes.max,10)/1e3),"min"in e.attributes&&(r.minLatency=parseInt(e.attributes.min,10)/1e3)),t&&("max"in t.attributes&&(r.maxPlaybackRate=parseFloat(t.attributes.max)),"min"in t.attributes&&(r.minPlaybackRate=parseFloat(t.attributes.min))),r):null):null},shaka.dash.DashParser.prototype.parseMpdChaining_=function(e){if(!(e=shaka.util.TXml.findChildren(e,"SupplementalProperty")).length)return null;for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())if("urn:mpeg:dash:chaining:2016"==(t=t.value).attributes.schemeIdUri)return t.attributes.value;return null},shaka.dash.DashParser.prototype.parsePeriods_=function(e,t,r,n){var a=shaka.util.TXml,i=e.mediaPresentationDuration;i||(i=a.parseAttr(r,"mediaPresentationDuration",a.parseDuration),this.manifestPatchContext_.mediaPresentationDuration=i);var s=0;this.manifest_&&this.manifest_.presentationTimeline&&this.isTransitionFromDynamicToStatic_&&(s=this.manifest_.presentationTimeline.getSeekRangeStart());var o=[],l=s;r=a.findChildren(r,"Period");for(var u=0;u<r.length;u++){var c=r[u],d=r[u+1],p=a.parseAttr(c,"start",a.parseDuration,l),h=c.attributes.id,f=a.parseAttr(c,"duration",a.parseDuration);p=0==u&&0==p&&this.isTransitionFromDynamicToStatic_?s:p;var m=null;if(d){var g=a.parseAttr(d,"start",a.parseDuration);null!=g&&(m=g-p+s)}else null!=i&&(m=i-p+s);if(g=shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS,m&&f&&Math.abs(m-f)>g&&(shaka.log.warning("There is a gap/overlap between Periods",c),m>f&&this.gapCount_++),null==m&&(m=f),null!==this.largestPeriodStartTime_&&null!==h&&null!==p&&p<this.largestPeriodStartTime_&&!this.lastManifestUpdatePeriodIds_.includes(h)&&u+1!=r.length)shaka.log.debug("Skipping Period with ID "+h+" as its start time is smaller than the largest period start time that has been seen, and ID is unseen before");else{if(null!==p&&(null===this.largestPeriodStartTime_||p>this.largestPeriodStartTime_)&&(this.largestPeriodStartTime_=p),l=this.parsePeriod_(e,t,{start:p,duration:m,node:c,isLastPeriod:null==m||!d}),o.push(l),e.period.id&&m&&this.periodDurations_.set(e.period.id,m),null==m){d&&shaka.log.warning("Skipping Period",u+1,"and any subsequent Periods:","Period",u+1,"does not have a valid start time.",d),l=null;break}l=p+m}}if(n)for(t=(e=$jscomp.makeIterator(o)).next();!t.done;t=e.next())t=t.value.id,this.lastManifestUpdatePeriodIds_.includes(t)||this.lastManifestUpdatePeriodIds_.push(t);else this.lastManifestUpdatePeriodIds_=o.map((function(e){return e.id}));return null!=i?(null!=l&&Math.abs(l-s-i)>shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS&&shaka.log.warning("@mediaPresentationDuration does not match the total duration ","of all Periods."),{periods:o,duration:i+s,durationDerivedFromPeriods:!1}):{periods:o,duration:l,durationDerivedFromPeriods:!0}},shaka.dash.DashParser.prototype.cleanStreamMap_=function(){for(var e=this,t=Array.from(this.indexStreamMap_.keys()).filter((function(t){return!e.lastManifestUpdatePeriodIds_.includes(t)})),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next()){r=r.value;for(var n=!0,a=$jscomp.makeIterator(this.indexStreamMap_.get(r)),i=a.next();!i.done;i=a.next()){i=i.value;var s=this.streamMap_.get(i);s&&(s.segmentIndex&&!s.segmentIndex.isEmpty()?n=!1:(this.periodCombiner_&&this.periodCombiner_.deleteStream(s,r),this.streamMap_.delete(i)))}n&&this.indexStreamMap_.delete(r)}},shaka.dash.DashParser.prototype.parsePeriod_=function(e,t,r){var n=this,a=shaka.util.Functional,i=shaka.util.TXml,s=shaka.util.ManifestParserUtils.ContentType;goog.asserts.assert(r.node,"periodInfo.node should exist"),e.period=this.createFrame_(r.node,null,t),e.periodInfo=r,e.period.availabilityTimeOffset=e.availabilityTimeOffset,e.period.id||(shaka.log.info("No Period ID given for Period with start time "+r.start+",  Assigning a default"),e.period.id="__shaka_period_"+r.start);var o=i.findChildren(r.node,"EventStream");t=e.presentationTimeline.getSegmentAvailabilityStart();for(var l=(o=$jscomp.makeIterator(o)).next();!l.done;l=o.next())this.parseEventStream_(r.start,r.duration,l.value,t);for(t=i.findChildren(r.node,"SupplementalProperty"),o=(t=$jscomp.makeIterator(t)).next();!o.done;o=t.next())"urn:mpeg:dash:urlparam:2014"==(o=o.value).attributes.schemeIdUri&&(o=this.getURLParametersFunction_(o))&&(e.urlParams=o);if(t=i.findChildren(r.node,"AdaptationSet").map((function(t,r){return n.parseAdaptationSet_(e,r,t)})).filter(a.isNotNull),e.dynamic){o=[];for(var u=(l=$jscomp.makeIterator(t)).next();!u.done;u=l.next())for(var c=(u=$jscomp.makeIterator(u.value.representationIds)).next();!c.done;c=u.next())o.push(c.value);if(l=new Set(o),o.length!=l.size)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_DUPLICATE_REPRESENTATION_ID)}for(o=new Map,u=(l=$jscomp.makeIterator(t)).next();!u.done;u=l.next())for(c=(u=$jscomp.makeIterator(u.value.dependencyStreamMap)).next();!c.done;c=u.next()){var d=$jscomp.makeIterator(c.value);c=d.next().value,d=d.next().value,o.set(c,d)}if(o.size)for(l=null,c=(u=$jscomp.makeIterator(t)).next();!c.done;c=u.next()){c=c.value,d=[];for(var p=$jscomp.makeIterator(c.streams),h=p.next(),f={};!h.done;f={stream$jscomp$118:void 0},h=p.next())if(f.stream$jscomp$118=h.value,o.has(f.stream$jscomp$118.originalId)){l||(l=i.findChildren(r.node,"AdaptationSet").map((function(t,r){return n.parseAdaptationSet_(e,r,t)})).filter(a.isNotNull));for(var m=(h=$jscomp.makeIterator(l)).next();!m.done;m=h.next())(m=m.value.streams.find(function(e){return function(t){return t.originalId==e.stream$jscomp$118.originalId}}(f)))&&(m.dependencyStream=o.get(m.originalId),d.push(m))}d.length&&c.streams.push.apply(c.streams,$jscomp.arrayFromIterable(d))}if(r=t.filter((function(e){return!e.trickModeFor})),a=t.filter((function(e){return e.trickModeFor})),!this.config_.disableIFrames)for(i=(a=$jscomp.makeIterator(a)).next();!i.done;i=a.next())for(t=(i=i.value).trickModeFor.split(" "),l=(o=$jscomp.makeIterator(r)).next();!l.done;l=o.next())if(l=l.value,t.includes(l.id))for(u=(l=$jscomp.makeIterator(l.streams)).next();!u.done;u=l.next())shaka.util.StreamUtils.setBetterIFrameStream(u.value,i.streams);if(a=this.getStreamsFromSets_(this.config_.disableAudio,r,s.AUDIO),i=this.getStreamsFromSets_(this.config_.disableVideo,r,s.VIDEO),t=this.getStreamsFromSets_(this.config_.disableText,r,s.TEXT),s=this.getStreamsFromSets_(this.config_.disableThumbnails,r,s.IMAGE),0===i.length&&0===a.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_EMPTY_PERIOD);return{id:e.period.id,audioStreams:a,videoStreams:i,textStreams:t,imageStreams:s}},shaka.dash.DashParser.prototype.getStreamsFromSets_=function(e,t,r){return e||!t.length?[]:t.reduce((function(e,t){return t.contentType!=r||e.push.apply(e,$jscomp.arrayFromIterable(t.streams)),e}),[])},shaka.dash.DashParser.prototype.parseAdaptationSet_=function(e,t,r){var n=this,a=shaka.util.TXml,i=shaka.util.Functional,s=shaka.util.ManifestParserUtils,o=s.ContentType,l=shaka.dash.ContentProtection;e.adaptationSet=this.createFrame_(r,e.period,null),e.adaptationSet.position=t;var u=!1,c=a.findChildren(r,"Role"),d=c.map((function(e){return e.attributes.value})).filter(i.isNotNull),p=void 0;for((t=e.adaptationSet.contentType==o.TEXT)&&(p=s.TextStreamKind.SUBTITLE),c=(i=$jscomp.makeIterator(c)).next();!c.done;c=i.next()){var h=(c=c.value).attributes.schemeIdUri;if(null==h||"urn:mpeg:dash:role:2011"==h)switch(c=c.attributes.value,c){case"main":u=!0;break;case"caption":case"subtitle":p=c}}c=function(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}},h=function(e){switch(e){case 1:case 5:case 6:case 7:return"srgb";case 9:return"rec2020";case 11:case 12:return"p3"}};var f=function(t){var r=t.attributes["dvb:fontFamily"];t=t.attributes["dvb:url"],r&&t&&(t=shaka.util.ManifestParserUtils.resolveUris(e.adaptationSet.getBaseUris(),[t],e.urlParams()),n.playerInterface_.addFont(r,t[0]))},m=a.findChildren(r,"EssentialProperty");i=null;for(var g=!1,y=null,v=!1,_=(m=$jscomp.makeIterator(m)).next();!_.done;_=m.next()){var k=(_=_.value).attributes.schemeIdUri;if("http://dashif.org/guidelines/trickmode"==k)i=_.attributes.value;else if("urn:mpeg:mpegB:cicp:TransferCharacteristics"==k)var E=c(parseInt(_.attributes.value,10));else if("urn:mpeg:mpegB:cicp:ColourPrimaries"==k)var b=h(parseInt(_.attributes.value,10));else"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=k&&("urn:mpeg:dash:ssr:2023"==k&&this.config_.dash.enableFastSwitching?g=!0:"urn:dvb:dash:fontdownload:2014"==k?f(_):"urn:mpeg:dash:urlparam:2014"==k&&(y=this.getURLParametersFunction_(_))||(v=!0))}if(v)return null;var T=null;for(v=a.findChildren(r,"SupplementalProperty"),m=(v=$jscomp.makeIterator(v)).next();!m.done;m=v.next())"http://dashif.org/guidelines/last-segment-number"==(_=(m=m.value).attributes.schemeIdUri)?T=parseInt(m.attributes.value,10)-1:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==_?E=c(parseInt(m.attributes.value,10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"==_?b=h(parseInt(m.attributes.value,10)):"urn:dvb:dash:fontdownload:2014"==_?f(m):"urn:mpeg:dash:urlparam:2014"==_&&(y=this.getURLParametersFunction_(m));y&&(e.urlParams=y),h=a.findChildren(r,"Accessibility"),c=shaka.util.LanguageUtils;var A=new Map;for(f=(h=$jscomp.makeIterator(h)).next();!f.done;f=h.next())if(f=(y=f.value).attributes.schemeIdUri,y=y.attributes.value,"urn:scte:dash:cc:cea-608:2015"!=f||this.config_.disableText)if("urn:scte:dash:cc:cea-708:2015"!=f||this.config_.disableText){if("urn:mpeg:dash:role:2011"==f)null!=y&&(d.push(y),"captions"==y&&(p=s.TextStreamKind.CLOSED_CAPTION));else if("urn:tva:metadata:cs:AudioPurposeCS:2007"==f)if("1"==y)var S=shaka.media.ManifestParser.AccessibilityPurpose.VISUALLY_IMPAIRED;else"2"==y&&(S=shaka.media.ManifestParser.AccessibilityPurpose.HARD_OF_HEARING)}else if(f=1,null!=y)for(v=(y=$jscomp.makeIterator(y.split(";"))).next();!v.done;v=y.next())m=v.value,_=v=void 0,m.includes("=")?(v="svc"+(m=m.split("="))[0],_=m[1].split(",")[0].split(":").pop()):(v="svc"+f,f++,_=m),A.set(v,c.normalize(_));else A.set("svc1","und");else if(f=1,null!=y)for(y=y.split(";"),m=(v=$jscomp.makeIterator(y)).next();!m.done;m=v.next())_=m.value,k=m=void 0,_.includes("=")?(m=(_=_.split("="))[0].startsWith("CC")?_[0]:"CC"+_[0],k=_[1]||"und"):(m="CC"+f,2==y.length?f+=2:f++,k=_),A.set(m,c.normalize(k));else A.set("CC1","und");s=a.findChildren(r,"ContentProtection");var P=l.parseFromAdaptationSet(s,this.config_.ignoreDrmInfo,this.config_.dash.keySystemsByURI);e.adaptationSet.encrypted=0<s.length;var C=shaka.util.LanguageUtils.normalize(e.adaptationSet.language||"und"),x=e.adaptationSet.label,I=new Map;if(r=a.findChildren(r,"Representation"),!this.config_.ignoreSupplementalCodecs){for(l=[],c=(s=$jscomp.makeIterator(r)).next();!c.done;c=s.next())h=c.value,(c=a.getAttributeNS(h,shaka.dash.DashParser.SCTE214_,"supplementalCodecs"))&&((h=shaka.util.ObjectUtils.cloneObject(h)).attributes.codecs=c.split(" ").join(","),h.attributes.id&&(h.attributes.supplementalId=h.attributes.id+"_supplementalCodecs"),l.push(h));r.push.apply(r,$jscomp.arrayFromIterable(l))}if(0==(a=r.map((function(t){var r=n.parseRepresentation_(e,P,p,C,x,u,d,A,t,S,T);return r&&(r.hdr=r.hdr||E,r.colorGamut=r.colorGamut||b,r.fastSwitching=g,t=t.attributes.dependencyId)?(r.baseOriginalId=t,I.set(t,r),null):r})).filter((function(e){return!!e}))).length&&0==I.size){if(i=e.adaptationSet.contentType==o.IMAGE,this.config_.dash.ignoreEmptyAdaptationSet||t||i)return null;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_EMPTY_ADAPTATION_SET)}if(!e.adaptationSet.contentType||e.adaptationSet.contentType==o.APPLICATION)for(e.adaptationSet.contentType=shaka.dash.DashParser.guessContentType_(a[0].mimeType,a[0].codecs),t=(o=$jscomp.makeIterator(a)).next();!t.done;t=o.next())t.value.type=e.adaptationSet.contentType;for(o=e.adaptationSet.id||"__fake__"+this.globalId_++,l=(t=$jscomp.makeIterator(a)).next();!l.done;l=t.next()){for(l=l.value,c=(s=$jscomp.makeIterator(P.drmInfos)).next();!c.done;c=s.next())(c=c.value).keyIds=c.keyIds&&l.keyIds?new Set([].concat($jscomp.arrayFromIterable(c.keyIds),$jscomp.arrayFromIterable(l.keyIds))):c.keyIds||l.keyIds;l.groupId=o}return t=r.map((function(e){return e.attributes.supplementalId||e.attributes.id})).filter(shaka.util.Functional.isNotNull),{id:o,contentType:e.adaptationSet.contentType,language:C,main:u,streams:a,drmInfos:P.drmInfos,trickModeFor:i,representationIds:t,dependencyStreamMap:I}},shaka.dash.DashParser.prototype.getURLParametersFunction_=function(e){var t=this,r=shaka.util.TXml;if((e=r.findChildNS(e,shaka.dash.DashParser.UP_NAMESPACE_,"UrlQueryInfo"))&&r.parseAttr(e,"useMPDUrlQuery",r.parseBoolean,!1)){var n=e.attributes.queryTemplate;if(n)return function(){return"$querypart$"==n?t.lastManifestQueryParams_:n.split("&").map((function(e){if("$querypart$"==e)return t.lastManifestQueryParams_;var r=/\$query:(.*?)\$/g.exec(e);if(r&&2==r.length){r=r[1];var n=new goog.Uri.QueryData(t.lastManifestQueryParams_).get(r);if(n.length)return r+"="+n[0]}return e})).join("&")}}return null},shaka.dash.DashParser.prototype.parseRepresentation_=function(e,t,r,n,a,i,s,o,l,u,c){var d=this,p=shaka.util.TXml,h=shaka.util.ManifestParserUtils.ContentType;e.representation=this.createFrame_(l,e.adaptationSet,null);var f=e.representation.id;if(this.minTotalAvailabilityTimeOffset_=Math.min(this.minTotalAvailabilityTimeOffset_,e.representation.availabilityTimeOffset),this.isLowLatency_=0<this.minTotalAvailabilityTimeOffset_,!this.verifyRepresentation_(e.representation))return shaka.log.warning("Skipping Representation",e.representation),null;var m=e.periodInfo.start;e.bandwidth=p.parseAttr(l,"bandwidth",p.parsePositiveInt)||0,e.roles=s;var g=p.findChildren(l,"SupplementalProperty"),y=p.findChildren(l,"EssentialProperty");p=p.findChildren(l,"ContentProtection"),l=null;var v,_,k=y.find((function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri}));(k||(k=g.find((function(e){return"urn:mpeg:dash:urlparam:2014"==e.attributes.schemeIdUri}))))&&(l=this.getURLParametersFunction_(k)),l&&(e.urlParams=l),l=(k=e.representation.contentType)==h.TEXT||k==h.APPLICATION,h=k==h.IMAGE,p.length&&(e.adaptationSet.encrypted=!0);try{var E=void 0;if(t.aes128Info){var b=e.representation.getBaseUris,T=e.urlParams,A=shaka.util.ManifestParserUtils.resolveUris(b(),[t.aes128Info.keyUri],T()),S=shaka.net.NetworkingEngine.RequestType.KEY,P=shaka.net.NetworkingEngine.makeRequest(A,this.config_.retryParameters);E={bitsKey:128,blockCipherMode:"CBC",iv:t.aes128Info.iv,firstMediaSequenceNumber:0,fetchKey:function(){var e,t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return n.yield(d.makeNetworkRequest_(P,S),2);if(3!=n.nextAddress){if(!(e=n.yieldResult).data||16!=e.data.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.AES_128_INVALID_KEY_LENGTH);return t={name:"AES-CBC"},r=E,n.yield(window.crypto.subtle.importKey("raw",e.data,t,!0,["decrypt"]),3)}r.cryptoKey=n.yieldResult,E.fetchKey=void 0,n.jumpToEnd()}))}}}if(e.representation.aesKey=E,b=function(e,t,r,n){return d.requestSegment_(e,t,r,n)},e.representation.segmentBase)var C=shaka.dash.SegmentBase.createStreamInfo(e,b,E);else if(e.representation.segmentList)C=shaka.dash.SegmentList.createStreamInfo(e,this.streamMap_,E);else if(e.representation.segmentTemplate)C=shaka.dash.SegmentTemplate.createStreamInfo(e,b,this.streamMap_,!!this.manifest_,this.config_.dash.initialSegmentLimit,this.periodDurations_,E,c,!1);else{goog.asserts.assert(l,"Must have Segment* with non-text streams.");var x=e.periodInfo.duration||0,I=e.representation.getBaseUris,w=e.representation.mimeType,R=e.representation.codecs;C={generateSegmentIndex:function(){var e=shaka.media.SegmentIndex.forSingleSegment(m,x,I());return e.forEachTopLevelReference((function(e){e.mimeType=w,e.codecs=R})),Promise.resolve(e)}}}}catch(e){if((l||h)&&e.code==shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)return null;throw e}if(c=shaka.dash.ContentProtection.parseFromRepresentation(p,t,this.config_.ignoreDrmInfo,this.config_.dash.keySystemsByURI),c=new Set(c?[c]:[]),b=!1,g.some((function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.attributes.schemeIdUri&&"JOC"==e.attributes.value}))&&(b=!0),g=!1,l&&(g=s.includes("forced_subtitle")||s.includes("forced-subtitle")),h&&((y=y.find((function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.attributes.schemeIdUri)})))&&(v=y.attributes.value),!v))return null;l=e.representation.codecs,e.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(l.includes("hvc1.2.4.L153.B0")||l.includes("hev1.2.4.L153.B0"))&&(_="PQ"),y=e.representation.id?e.period.id+","+e.representation.id:"",this.patchLocationNodes_.length&&f&&this.contextCache_.set(e.period.id+","+f,this.cloneContext_(e));var M=y&&this.streamMap_.has(y)?this.streamMap_.get(y):{id:this.globalId_++,originalId:e.representation.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){M.segmentIndex&&(M.segmentIndex.release(),M.segmentIndex=null)},segmentIndex:null,mimeType:e.representation.mimeType,codecs:l,frameRate:e.representation.frameRate,pixelAspectRatio:e.representation.pixelAspectRatio,bandwidth:e.bandwidth,width:e.representation.width,height:e.representation.height,kind:r,encrypted:0<t.drmInfos.length,drmInfos:t.drmInfos,keyIds:c,language:n,originalLanguage:e.adaptationSet.language,label:a,type:e.adaptationSet.contentType,primary:i,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:e.representation.emsgSchemeIdUris,roles:s,forced:g,channelsCount:e.representation.numChannels,audioSamplingRate:e.representation.audioSamplingRate,spatialAudio:b,closedCaptions:o,hdr:_,colorGamut:void 0,videoLayout:void 0,tilesLayout:v,accessibilityPurpose:u,external:!1,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(e.representation.mimeType,e.representation.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null};return M.createSegmentIndex=function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return M.segmentIndex?t.jumpTo(0):(e=M,t.yield(C.generateSegmentIndex(),3));e.segmentIndex=t.yieldResult,t.jumpToEnd()}))},y&&e.dynamic&&!this.streamMap_.has(y)&&(e=e.period.id||"",this.indexStreamMap_.has(e)||this.indexStreamMap_.set(e,[]),this.streamMap_.set(y,M),this.indexStreamMap_.get(e).push(y)),M},shaka.dash.DashParser.prototype.cloneContext_=function(e){var t=function(e){return e?((e=shaka.util.ObjectUtils.shallowCloneObject(e)).segmentBase=null,e.segmentList=null,e.segmentTemplate=shaka.util.TXml.cloneNode(e.segmentTemplate),e):null};return(e=shaka.util.ObjectUtils.shallowCloneObject(e)).period=t(e.period),e.adaptationSet=t(e.adaptationSet),e.representation=t(e.representation),e.periodInfo&&(e.periodInfo=shaka.util.ObjectUtils.shallowCloneObject(e.periodInfo),e.periodInfo.node=null),e},shaka.dash.DashParser.prototype.onUpdate_=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){switch(n.nextAddress){case 1:return goog.asserts.assert(0<=r.updatePeriod_,"There should be an update period"),shaka.log.info("Updating manifest..."),e=0,n.setCatchFinallyBlocks(2),n.yield(r.requestManifest_(),4);case 4:e=n.yieldResult,n.leaveTryBlock(3);break;case 2:if(t=n.enterCatchBlock(),goog.asserts.assert(t instanceof shaka.util.Error,"Should only receive a Shaka error"),r.playerInterface_){if(r.config_.raiseFatalErrorOnManifestUpdateRequestFailure)return r.playerInterface_.onError(t),n.return();t.severity=shaka.util.Error.Severity.RECOVERABLE,r.playerInterface_.onError(t)}case 3:if(!r.playerInterface_)return n.return();r.playerInterface_.onManifestUpdated(),r.setUpdateTimer_(e),n.jumpToEnd()}}))},shaka.dash.DashParser.prototype.updateNow_=function(){this.updateTimer_.tickNow()},shaka.dash.DashParser.prototype.setUpdateTimer_=function(e){if(!(0>this.updatePeriod_)){var t=this.updatePeriod_;0<=this.config_.updatePeriod&&(t=this.config_.updatePeriod),e=Math.max(t-e,this.averageUpdateDuration_.getEstimate()),this.updateTimer_.tickAfter(e)}},shaka.dash.DashParser.prototype.createFrame_=function(e,t,r){var n=this;goog.asserts.assert(t||r,"Must provide either parent or getBaseUris");var a=shaka.media.SegmentUtils,i=shaka.util.ManifestParserUtils,s=shaka.util.TXml;t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,numChannels:null,audioSamplingRate:null,availabilityTimeOffset:0,segmentSequenceCadence:0,encrypted:!1},r=r||t.getBaseUris;var o,l=s.parseNonNegativeInt,u=s.evalDivision,c=e.attributes.id,d=e.attributes.supplementalId,p=s.findChildren(e,"BaseURL"),h=!1;if(this.contentSteeringManager_)for(var f=$jscomp.makeIterator(p),m=f.next();!m.done;m=f.next()){var g=m.value;m=g.attributes.serviceLocation,g=s.getContents(g),m&&g&&(this.contentSteeringManager_.addLocation(c,m,g),h=!0)}h&&this.contentSteeringManager_||(o=p.map(s.getContents)),f=e.attributes.contentType||t.contentType,m=e.attributes.mimeType||t.mimeType,a=a.codecsFiltering([e.attributes.codecs||t.codecs]).join(","),u=s.parseAttr(e,"frameRate",u)||t.frameRate,g=e.attributes.sar||t.pixelAspectRatio;var y=this.emsgSchemeIdUris_(s.findChildren(e,"InbandEventStream"),t.emsgSchemeIdUris),v=s.findChildren(e,"AudioChannelConfiguration");v=this.parseAudioChannels_(v)||t.numChannels;var _=s.parseAttr(e,"audioSamplingRate",l)||t.audioSamplingRate;f||(f=shaka.dash.DashParser.guessContentType_(m,a));var k=s.findChild(e,"SegmentBase"),E=s.findChild(e,"SegmentTemplate"),b=k&&s.parseAttr(k,"availabilityTimeOffset",s.parseFloat)||0,T=E&&s.parseAttr(E,"availabilityTimeOffset",s.parseFloat)||0,A=p&&p.length&&s.parseAttr(p[0],"availabilityTimeOffset",s.parseFloat)||0;b=t.availabilityTimeOffset+A+b+T,T=null,(A=s.findChild(e,"SegmentSequenceProperties"))&&(A=s.findChild(A,"SAP"))&&(T=s.parseAttr(A,"cadence",s.parseInt)),A=e.attributes.label;var S=s.findChildren(e,"Label");return S&&S.length&&(S=S[0],s.getTextContents(S)&&(A=s.getTextContents(S))),{getBaseUris:function(){return i.resolveUris(r(),p.length?n.contentSteeringManager_&&h?n.contentSteeringManager_.getLocations(c):o||[]:[])},segmentBase:k||t.segmentBase,segmentList:s.findChild(e,"SegmentList")||t.segmentList,segmentTemplate:E||t.segmentTemplate,width:s.parseAttr(e,"width",l)||t.width,height:s.parseAttr(e,"height",l)||t.height,contentType:f,mimeType:m,codecs:a,frameRate:u,pixelAspectRatio:g,emsgSchemeIdUris:y,id:d||c,originalId:c,language:e.attributes.lang,numChannels:v,audioSamplingRate:_,availabilityTimeOffset:b,initialization:null,segmentSequenceCadence:T||t.segmentSequenceCadence,label:A||null,encrypted:!1}},shaka.dash.DashParser.prototype.emsgSchemeIdUris_=function(e,t){t=t.slice();for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())r=r.value.attributes.schemeIdUri,t.includes(r)||t.push(r);return t},shaka.dash.DashParser.prototype.parseAudioChannels_=function(e){for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value;if((t=r.attributes.schemeIdUri)&&(r=r.attributes.value))switch(t){case"urn:mpeg:dash:outputChannelPositionList:2012":return r.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var n=parseInt(r,10);if(!n){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}return n;case"tag:dolby.com,2015:dash:audio_channel_configuration:2015":n=[2,1,2,2,2,2,1,2,2,1,1,1,1,2,1,1,2,2];var a=parseInt(r,16);if(!a){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}for(r=t=0;r<n.length;r++)a&1<<r&&(t+=n[r]);if(t)return t;continue;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(n=[1,1,1,1,1,2,2,1,1,2,2,2,1,2,1,1].reverse(),!(a=parseInt(r,16))){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}for(r=t=0;r<n.length;r++)a&1<<r&&(t+=n[r]);if(t)return t;continue;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(n=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],!(a=parseInt(r,10))){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}if(0<a&&a<n.length)return n[a];continue;default:shaka.log.warning("Unrecognized audio channel scheme:",t,r)}}return null},shaka.dash.DashParser.prototype.verifyRepresentation_=function(e){var t=shaka.util.ManifestParserUtils.ContentType,r=e.segmentBase?1:0;return r+=e.segmentList?1:0,0==(r+=e.segmentTemplate?1:0)?e.contentType==t.TEXT||e.contentType==t.APPLICATION||(shaka.log.warning("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',e),!1):(1!=r&&(shaka.log.warning("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",e),e.segmentBase?(shaka.log.info("Using SegmentBase by default."),e.segmentList=null):(goog.asserts.assert(e.segmentList,"There should be a SegmentList"),shaka.log.info("Using SegmentList by default.")),e.segmentTemplate=null),!0)},shaka.dash.DashParser.prototype.requestForTiming_=function(e,t,r){var n,a,i,s,o,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress)return n=[shaka.util.StringUtils.htmlUnescape(t)],a=shaka.util.ManifestParserUtils.resolveUris(e(),n),(i=shaka.net.NetworkingEngine.makeRequest(a,d.config_.retryParameters)).method=r,s=shaka.net.NetworkingEngine.RequestType.TIMING,o=d.playerInterface_.networkingEngine.request(s,i,{isPreload:d.isPreloadFn_()}),d.operationManager_.manage(o),p.yield(o.promise,2);if(l=p.yieldResult,"HEAD"==r){if(!l.headers||!l.headers.date)return shaka.log.warning("UTC timing response is missing","expected date header"),p.return(0);u=l.headers.date}else u=shaka.util.StringUtils.fromUTF8(l.data);return c=Date.parse(u),isNaN(c)?(shaka.log.warning("Unable to parse date from UTC timing response"),p.return(0)):p.return(c-Date.now())}))},shaka.dash.DashParser.prototype.parseUtcTiming_=function(e,t){var r,n,a,i,s,o,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){switch(p.nextAddress){case 1:r=t.map((function(e){return{scheme:e.attributes.schemeIdUri,value:e.attributes.value}})),n=d.config_.dash.clockSyncUri,!r.length&&n&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:n}),a=$jscomp.makeIterator(r),i=a.next();case 2:if(i.done){p.jumpTo(4);break}switch(s=i.value,p.setCatchFinallyBlocks(5),o=s.scheme,l=s.value,o){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return p.jumpTo(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return p.jumpTo(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return u=Date.parse(l),p.return(isNaN(u)?0:u-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":shaka.log.alwaysWarn("NTP UTCTiming scheme is not supported");break;default:shaka.log.alwaysWarn("Unrecognized scheme in UTCTiming element",o)}p.jumpTo(9);break;case 7:return p.yield(d.requestForTiming_(e,l,"HEAD"),10);case 10:return p.return(p.yieldResult);case 8:return p.yield(d.requestForTiming_(e,l,"GET"),11);case 11:return p.return(p.yieldResult);case 9:p.leaveTryBlock(3);break;case 5:c=p.enterCatchBlock(),shaka.log.warning("Error fetching time from UTCTiming elem",c.message);case 3:i=a.next(),p.jumpTo(2);break;case 4:return shaka.log.alwaysWarn("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),p.return(0)}}))},shaka.dash.DashParser.prototype.parseEventStream_=function(e,t,r,n){for(var a=shaka.util.TXml,i=shaka.util.TXml.parseNonNegativeInt,s=r.attributes.schemeIdUri||"",o=r.attributes.value||"",l=a.parseAttr(r,"timescale",i)||1,u=a.parseAttr(r,"presentationTimeOffset",i)||0,c=(r=$jscomp.makeIterator(a.findChildren(r,"Event"))).next();!c.done;c=r.next()){c=c.value;var d=a.parseAttr(c,"presentationTime",i)||0,p=a.parseAttr(c,"duration",i)||0;p=(d=Math.max((d-u)/l+e,e))+p/l,null!=t&&(d=Math.min(d,e+t),p=Math.min(p,e+t)),p<n||(c={schemeIdUri:s,value:o,startTime:d,endTime:p,id:c.attributes.id||"",timescale:l,eventElement:a.txmlNodeToDomElement(c),eventNode:a.cloneNode(c)},this.playerInterface_.onTimelineRegionAdded(c))}},shaka.dash.DashParser.prototype.requestSegment_=function(e,t,r,n){var a,i,s,o,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){return 1==u.nextAddress?(a=shaka.net.NetworkingEngine.RequestType.SEGMENT,i=n?shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT:shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_SEGMENT,s=shaka.util.Networking.createSegmentRequest(e,t,r,l.config_.retryParameters),u.yield(l.makeNetworkRequest_(s,a,{type:i}),2)):(o=u.yieldResult,u.return(o.data))}))},shaka.dash.DashParser.guessContentType_=function(e,t){return t=shaka.util.MimeUtils.getFullType(e,t),shaka.text.TextEngine.isTypeSupported(t)?shaka.util.ManifestParserUtils.ContentType.TEXT:e.split("/")[0]},shaka.dash.DashParser.prototype.makeNetworkRequest_=function(e,t,r){return r||(r={}),r.isPreload=this.isPreloadFn_(),e=this.playerInterface_.networkingEngine.request(t,e,r),this.operationManager_.manage(e),e.promise},shaka.dash.DashParser.prototype.updatePatchLocationNodes_=function(e){shaka.util.TXml.modifyNodes(this.patchLocationNodes_,e)},shaka.dash.DashParser.prototype.getPatchLocationUris_=function(){var e=shaka.util.TXml,t=this.manifestPatchContext_.publishTime;if(!this.manifestPatchContext_.mpdId||!t||!this.patchLocationNodes_.length)return[];var r=Date.now()/1e3,n=this.patchLocationNodes_.filter((function(n){return!(n=e.parseNonNegativeInt(n.attributes.ttl))||t+n>r})).map(e.getContents).filter(shaka.util.Functional.isNotNull);return n.length?shaka.util.ManifestParserUtils.resolveUris(this.manifestUris_,n):[]},goog.exportSymbol("shaka.dash.DashParser",shaka.dash.DashParser),shaka.dash.DashParser.SCTE214_="urn:scte:dash:scte214-extensions",shaka.dash.DashParser.UP_NAMESPACE_="urn:mpeg:dash:schema:urlparam:2014",shaka.media.ManifestParser.registerParserByMime("application/dash+xml",(function(){return new shaka.dash.DashParser})),shaka.media.ManifestParser.registerParserByMime("video/vnd.mpeg.dash.mpd",(function(){return new shaka.dash.DashParser})),shaka.dependencies=function(){},shaka.dependencies.add=function(e,t){if(!shaka.dependencies.Allowed[e])throw Error(e+" is not supported");e==shaka.dependencies.Allowed.muxjs?shaka.Deprecate.deprecateFeature(5,"mux.js","mux.js is no longer used in Shaka Player."):shaka.dependencies.dependencies_.set(e,(function(){return t}))},shaka.dependencies.has=function(e){return shaka.dependencies.dependencies_.has(e)},shaka.dependencies.isoBoxer=function(){return shaka.dependencies.dependencies_.get(shaka.dependencies.Allowed.ISOBoxer)()},goog.exportSymbol("shaka.dependencies",shaka.dependencies),goog.exportProperty(shaka.dependencies,"has",shaka.dependencies.has),goog.exportProperty(shaka.dependencies,"add",shaka.dependencies.add),shaka.dependencies.Allowed={muxjs:"muxjs",ISOBoxer:"ISOBoxer"},goog.exportProperty(shaka.dependencies,"Allowed",shaka.dependencies.Allowed),shaka.dependencies.dependencies_=new Map([[shaka.dependencies.Allowed.ISOBoxer,function(){return window.ISOBoxer}]]),shaka.hls={},shaka.hls.Playlist=function(e,t,r){this.type=e,this.tags=t,this.segments=r||null},shaka.hls.PlaylistType={MASTER:0,MEDIA:1},shaka.hls.Tag=function(e,t,r,n){this.id=e,this.name=t,this.attributes=r,this.value=void 0===n?null:n},shaka.hls.Tag.prototype.toString=function(e){var t=function(e){var t=isNaN(Number(e.value))?'"'+e.value+'"':e.value;return e.name+"="+t},r="#"+this.name;return t=this.attributes?this.attributes.filter((function(t){return!e||!e.has(t.name)})).map(t):[],this.value&&t.unshift(this.value),0<t.length&&(r+=":"+t.join(",")),r},shaka.hls.Tag.prototype.getTagKey=function(e){return e?this.toString():(e=(new Set).add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI"),this.toString(e))},shaka.hls.Tag.prototype.addAttribute=function(e){this.attributes.push(e)},shaka.hls.Tag.prototype.getAttribute=function(e){var t=this.attributes.filter((function(t){return t.name==e}));return goog.asserts.assert(2>t.length,"A tag should not have multiple attributes with the same name!"),t.length?t[0]:null},shaka.hls.Tag.prototype.getAttributeValue=function(e,t){return(e=this.getAttribute(e))?e.value:t||null},shaka.hls.Tag.prototype.getRequiredAttrValue=function(e){var t=this.getAttribute(e);if(!t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_REQUIRED_ATTRIBUTE_MISSING,e);return t.value},shaka.hls.Tag.prototype.setName=function(e){this.name=e},shaka.hls.Segment=function(e,t,r){r=void 0===r?[]:r,this.tags=t,this.verbatimSegmentUri=e,this.partialSegments=r},shaka.hls.Attribute=function(e,t){this.name=e,this.value=t},shaka.hls.Utils=function(){},shaka.hls.Utils.filterTagsByName=function(e,t){return e.filter((function(e){return e.name==t}))},shaka.hls.Utils.filterTagsByType=function(e,t){return e.filter((function(e){return e.getRequiredAttrValue("TYPE")==t}))},shaka.hls.Utils.getFirstTagWithName=function(e,t){for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if((r=r.value).name===t)return r;return null},shaka.hls.Utils.getFirstTagWithNameAsNumber=function(e,t,r){return r=void 0===r?0:r,(e=shaka.hls.Utils.getFirstTagWithName(e,t))?Number(e.value):r},shaka.hls.Utils.constructSegmentUris=function(e,t,r){return t?shaka.hls.Utils.constructUris(e,[t],r):[]},shaka.hls.Utils.constructUris=function(e,t,r){if(!t.length)return[];var n=t;return r&&r.size&&(n=t.map((function(e){return shaka.hls.Utils.variableSubstitution(e,r)}))),shaka.util.ManifestParserUtils.resolveUris(e,n)},shaka.hls.Utils.variableSubstitution=function(e,t){if(!t||!t.size)return e;var r=(e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}")).match(/{\$\w*}/g);if(r)for(var n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next()){var a=(n=n.value).slice(2,n.length-1),i=t.get(a);if(!i)throw shaka.log.error("A variable has been found that is not declared",a),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_VARIABLE_NOT_FOUND,a);e=e.replace(n,i)}return e},shaka.hls.Utils.isComment=function(e){return/^#(?!EXT)/m.test(e)},shaka.hls.ManifestTextParser=function(){this.globalId_=0},shaka.hls.ManifestTextParser.prototype.parsePlaylist=function(e){var t=shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS,r=shaka.hls.ManifestTextParser.SEGMENT_TAGS,n=(e=(e=shaka.util.StringUtils.fromUTF8(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_PLAYLIST_HEADER_MISSING);e=shaka.hls.PlaylistType.MASTER;for(var a=!0,i=$jscomp.makeIterator(n),s=i.next();!s.done;s=i.next())if(s=s.value,shaka.hls.Utils.isComment(s)||a)a=!1;else{if(s=this.parseTag_(s),--this.globalId_,t.includes(s.name)){e=shaka.hls.PlaylistType.MEDIA;break}"EXT-X-STREAM-INF"==s.name&&(a=!0)}for(t=[],a=!0,i=0;i<n.length;i++){var o=n[i];if(s=n[i+1],shaka.hls.Utils.isComment(o)||a)a=!1;else{if(o=this.parseTag_(o),r.includes(o.name)){if(e!=shaka.hls.PlaylistType.MEDIA)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);return r=n.splice(i,n.length-i),r=this.parseSegments_(r,t),new shaka.hls.Playlist(e,t,r)}t.push(o),"EXT-X-STREAM-INF"==o.name&&(a=new shaka.hls.Attribute("URI",s),o.addAttribute(a),a=!0)}}return new shaka.hls.Playlist(e,t)},shaka.hls.ManifestTextParser.prototype.parseSegments_=function(e,t){for(var r=[],n=[],a=[],i=null,s=(e=$jscomp.makeIterator(e)).next();!s.done;s=e.next())s=s.value,/^(#EXT)/.test(s)?(s=this.parseTag_(s),shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS.includes(s.name)?t.push(s):"EXT-X-MAP"==s.name?i=s:"EXT-X-PART"==s.name?a.push(s):"EXT-X-PRELOAD-HINT"==s.name?"PART"==s.getAttributeValue("TYPE")?a.push(s):"MAP"==s.getAttributeValue("TYPE")&&(s.setName("EXT-X-MAP"),i=s):n.push(s)):shaka.hls.Utils.isComment(s)||(s=s.trim(),i&&n.push(i),n=new shaka.hls.Segment(s,n,a),r.push(n),n=[],a=[]);return a.length&&(i&&n.push(i),t=new shaka.hls.Segment("",n,a),r.push(t)),r},shaka.hls.ManifestTextParser.prototype.parseTag_=function(e){return shaka.hls.ManifestTextParser.parseTag(this.globalId_++,e)},shaka.hls.ManifestTextParser.parseTag=function(e,t){var r=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!r)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.INVALID_HLS_TAG,t);t=r[1];var n,a=r[2];if(r=[],a){var i,s=(a=new shaka.util.TextParser(a)).readRegex(/^([^,=]+)(?:,|$)/g);for(s&&(n=s[1]),s=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;i=a.readRegex(s);)i=new shaka.hls.Attribute(i[1],i[2]||i[3]),r.push(i),a.skipWhitespace()}return new shaka.hls.Tag(e,t,r,n)},shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(" "),shaka.hls.ManifestTextParser.SEGMENT_TAGS="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP EXT-X-TILES".split(" "),shaka.net.DataUriPlugin=function(){},shaka.net.DataUriPlugin.parse=function(e,t,r,n){try{var a=shaka.net.DataUriPlugin.parseRaw(e);return shaka.util.AbortableOperation.completed({uri:e,originalUri:e,data:a.data,headers:{"content-type":a.contentType},originalRequest:t})}catch(e){return shaka.util.AbortableOperation.failed(e)}},shaka.net.DataUriPlugin.parseRaw=function(e){var t=e.split(":");if(2>t.length||"data"!=t[0])throw shaka.log.error("Bad data URI, failed to parse scheme"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_DATA_URI,e);if(2>(t=t.slice(1).join(":").split(",")).length)throw shaka.log.error("Bad data URI, failed to extract encoding and MIME type"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_DATA_URI,e);var r=t[0];e=window.decodeURIComponent(t.slice(1).join(",")),t=r.split(";"),r=t[0];var n=!1;return 1<t.length&&"base64"==t[t.length-1]&&(n=!0,t.pop()),{data:n?shaka.util.Uint8ArrayUtils.fromBase64(e):shaka.util.StringUtils.toUTF8(e),contentType:r}},goog.exportSymbol("shaka.net.DataUriPlugin",shaka.net.DataUriPlugin),goog.exportProperty(shaka.net.DataUriPlugin,"parse",shaka.net.DataUriPlugin.parse),shaka.net.NetworkingEngine.registerScheme("data",shaka.net.DataUriPlugin.parse),shaka.hls.HlsParser=function(){var e=this;this.config_=this.playerInterface_=null,this.globalId_=1,this.globalVariables_=new Map,this.groupIdToStreamInfosMap_=new Map,this.mediaSequenceToStartTimeByType_=new Map;var t=shaka.util.ManifestParserUtils.ContentType;this.mediaSequenceToStartTimeByType_.set(t.VIDEO,new Map),this.mediaSequenceToStartTimeByType_.set(t.AUDIO,new Map),this.mediaSequenceToStartTimeByType_.set(t.TEXT,new Map),this.mediaSequenceToStartTimeByType_.set(t.IMAGE,new Map),this.keyFormatsToDrmParsers_=(new Map).set("com.apple.streamingkeydelivery",(function(t,r,n){return e.fairplayDrmParser_(t,r,n)})).set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",(function(t,r,n){return e.widevineDrmParser_(t,r,n)})).set("com.microsoft.playready",(function(t,r,n){return e.playreadyDrmParser_(t,r,n)})).set("urn:uuid:3d5e6d35-9b9a-41e8-b843-dd3c6e72c42c",(function(t,r,n){return e.wiseplayDrmParser_(t,r,n)})),this.variantUriSet_=new Set,this.uriToStreamInfosMap_=new Map,this.presentationTimeline_=null,this.masterPlaylistUri_="",this.manifestTextParser_=new shaka.hls.ManifestTextParser,this.minSequenceNumber_=-1,this.lowestSyncTime_=1/0,this.codecInfoInManifest_=this.streamsFinalized_=this.usesProgramDateTime_=!1,this.updatePlaylistTimer_=new shaka.util.Timer((function(){e.mediaElement_&&!e.config_.continueLoadingWhenPaused&&(e.eventManager_.unlisten(e.mediaElement_,"timeupdate"),e.mediaElement_.paused)?e.eventManager_.listenOnce(e.mediaElement_,"timeupdate",(function(){return e.onUpdate_()})):e.onUpdate_()})),this.presentationType_=shaka.hls.HlsParser.PresentationType_.VOD,this.manifest_=null,this.maxTargetDuration_=0,this.lastTargetDuration_=1/0,this.lowLatencyPresentationDelay_=this.presentationDelay_=this.partialTargetDuration_=0,this.operationManager_=new shaka.util.OperationManager,this.groupIdToClosedCaptionsMap_=new Map,this.groupIdToCodecsMap_=new Map,this.mapTagToInitSegmentRefMap_=new Map,this.aesKeyInfoMap_=new Map,this.aesKeyMap_=new Map,this.identityKeyMap_=new Map,this.initSegmentToKidMap_=new Map,this.lowLatencyByterangeOptimization_=this.lowLatencyMode_=!1,this.averageUpdateDuration_=new shaka.abr.Ewma(5),this.contentSteeringManager_=null,this.needsClosedCaptionsDetection_=!0,this.dateRangeIdsEmitted_=new Set,this.eventManager_=new shaka.util.EventManager,this.startTime_=this.mediaElement_=null,this.isPreloadFn_=function(){return!1}},shaka.hls.HlsParser.prototype.configure=function(e,t){var r=this.playerInterface_&&e.updatePeriod!=this.config_.updatePeriod&&0<=e.updatePeriod;this.config_=e,t&&(this.isPreloadFn_=t),this.contentSteeringManager_&&this.contentSteeringManager_.configure(this.config_),r&&this.manifest_&&this.manifest_.presentationTimeline.isLive()&&this.updatePlaylistTimer_.tickNow()},shaka.hls.HlsParser.prototype.start=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(goog.asserts.assert(n.config_,"Must call configure() before start()!"),n.playerInterface_=t,n.lowLatencyMode_=t.isLowLatencyMode(),a.yield(n.requestManifest_([e]).promise,2)):3!=a.nextAddress?(r=a.yieldResult,n.masterPlaylistUri_=r.uri,goog.asserts.assert(r.data,"Response data should be non-null!"),a.yield(n.parseManifest_(r.data),3)):(goog.asserts.assert(n.manifest_,"Manifest should be non-null"),a.return(n.manifest_))}))},shaka.hls.HlsParser.prototype.stop=function(){this.updatePlaylistTimer_&&(this.updatePlaylistTimer_.stop(),this.updatePlaylistTimer_=null);var e=[];return this.operationManager_&&(e.push(this.operationManager_.destroy()),this.operationManager_=null),this.config_=this.playerInterface_=null,this.variantUriSet_.clear(),this.manifest_=null,this.uriToStreamInfosMap_.clear(),this.groupIdToStreamInfosMap_.clear(),this.groupIdToCodecsMap_.clear(),this.globalVariables_.clear(),this.mapTagToInitSegmentRefMap_.clear(),this.aesKeyInfoMap_.clear(),this.aesKeyMap_.clear(),this.identityKeyMap_.clear(),this.initSegmentToKidMap_.clear(),this.dateRangeIdsEmitted_.clear(),this.contentSteeringManager_&&this.contentSteeringManager_.destroy(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),Promise.all(e)},shaka.hls.HlsParser.prototype.update=function(){var e,t,r,n,a,i,s,o,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){if(1==h.nextAddress){if(!p.isLive_())return h.return();for(e=[],t=Array.from(p.uriToStreamInfosMap_.values()),p.lastTargetDuration_=1/0,p.manifest_.gapCount=0,r=t.filter((function(e){return e.stream.segmentIndex})),n=$jscomp.makeIterator(r),a=n.next();!a.done;a=n.next())i=a.value,e.push(p.updateStream_(i));return h.yield(Promise.all(e),2)}for(p.notifySegmentsForStreams_(r.map((function(e){return e.stream}))),s=r.some((function(e){return 0==e.hasEndList})),r.length&&!s&&(o=shaka.hls.HlsParser.PresentationType_,p.setPresentationType_(o.VOD),l=r.map((function(e){return e.maxTimestamp})),p.presentationTimeline_.setDuration(Math.min.apply(Math,$jscomp.arrayFromIterable(l))),p.playerInterface_.updateDuration()),s&&p.determineDuration_(),u=$jscomp.makeIterator(r),c=u.next();!c.done;c=u.next())(d=c.value).stream.isAudioMuxedInVideo||!d.stream.segmentIndex||d.stream.segmentIndex.earliestReference()||p.playerInterface_.disableStream(d.stream);h.jumpToEnd()}))},shaka.hls.HlsParser.prototype.getMediaSequenceToStartTimeFor_=function(e){return this.isLive_()?this.mediaSequenceToStartTimeByType_.get(e.type):e.mediaSequenceToStartTime},shaka.hls.HlsParser.prototype.updateStream_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M,D,O,L,N=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(U){switch(U.nextAddress){case 1:if(e.stream.isAudioMuxedInVideo)return U.return();for(t=[],r=$jscomp.makeIterator(e.getUris()),n=r.next();!n.done;n=r.next())a=n.value,i=new goog.Uri(a),s=i.getQueryData(),e.canBlockReload&&(0<=e.nextMediaSequence&&s.add("_HLS_msn",String(e.nextMediaSequence)),0<=e.nextPart&&s.add("_HLS_part",String(e.nextPart))),e.canSkipSegments&&s.add("_HLS_skip","YES"),s.getCount()&&i.setQueryData(s.toDecodedString()),t.push(i.toString());return U.setCatchFinallyBlocks(2),U.yield(N.requestManifest_(t,!0).promise,4);case 4:o=U.yieldResult,U.leaveTryBlock(3);break;case 2:throw l=U.enterCatchBlock(),N.playerInterface_&&N.playerInterface_.disableStream(e.stream),l;case 3:if(!e.stream.segmentIndex)return U.return();if((u=N.manifestTextParser_.parsePlaylist(o.data)).type!=shaka.hls.PlaylistType.MEDIA)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);return(c=o.uri)==o.originalUri||e.getUris().includes(c)||e.redirectUris.push(c),d=shaka.hls.Utils.filterTagsByName(u.tags,"EXT-X-DEFINE"),p=N.parseMediaVariables_(d,c),h=e.stream,f=N.getMediaSequenceToStartTimeFor_(e),U.yield(N.parseDrmInfo_(u,h.mimeType,e.getUris,p),5);case 5:for(m=U.yieldResult,g=m.keyIds,y=m.drmInfos,v=m.encrypted,_=m.aesEncrypted,h.encrypted||!v||_||(h.encrypted=!0),function(e,t){return e.size===t.size&&[].concat($jscomp.arrayFromIterable(e)).every((function(e){return t.has(e)}))}(h.keyIds,g)||(h.keyIds=g,h.drmInfos=y,N.playerInterface_.newDrmInfo(h)),k=N.createSegments_(u,f,p,e.getUris,e.type),E=k.segments,(b=k.bandwidth)&&(h.bandwidth=b),T=shaka.media.QualityObserver.createQualityInfo(h),A=$jscomp.makeIterator(E),S=A.next();!S.done;S=A.next())(P=S.value).initSegmentReference&&(P.initSegmentReference.mediaQuality=T);h.segmentIndex.mergeAndEvict(E,N.presentationTimeline_.getSegmentAvailabilityStart()),E.length&&(C=shaka.hls.Utils.getFirstTagWithNameAsNumber(u.tags,"EXT-X-MEDIA-SEQUENCE",0),I=(x=shaka.hls.Utils.getFirstTagWithName(u.tags,"EXT-X-SKIP"))?Number(x.getAttributeValue("SKIPPED-SEGMENTS")):0,w=N.getNextMediaSequenceAndPart_(C,E),R=w.nextMediaSequence,M=w.nextPart,e.nextMediaSequence=R+I,e.nextPart=M,D=f.get(C),h.segmentIndex.evict(D)),(O=h.segmentIndex.earliestReference())&&(e.minTimestamp=O.startTime,L=E[E.length-1],goog.asserts.assert(L,"Should have segments!"),e.maxTimestamp=L.endTime),shaka.hls.Utils.getFirstTagWithName(u.tags,"EXT-X-ENDLIST")&&(e.hasEndList=!0),N.determineLastTargetDuration_(u),N.processDateRangeTags_(u.tags,h.type,p,e.getUris),U.jumpToEnd()}}))},shaka.hls.HlsParser.prototype.onExpirationUpdated=function(e,t){},shaka.hls.HlsParser.prototype.onInitialVariantChosen=function(e){},shaka.hls.HlsParser.prototype.banLocation=function(e){this.contentSteeringManager_&&this.contentSteeringManager_.banLocation(e)},shaka.hls.HlsParser.prototype.setMediaElement=function(e){this.mediaElement_=e},shaka.hls.HlsParser.prototype.syncStreamsWithSequenceNumber_=function(e,t){t=void 0!==t&&t;for(var r=-1==this.minSequenceNumber_,n=$jscomp.makeIterator(e),a=n.next();!a.done;a=n.next()){var i=(a=a.value).stream.segmentIndex;goog.asserts.assert(i,"Only loaded streams should be synced");var s=this.getMediaSequenceToStartTimeFor_(a);if(i=i.earliestReference()){goog.DEBUG&&s.values().next().value!=i.startTime&&shaka.log.warning("Sequence number map is not ordered as expected!");for(var o=(s=$jscomp.makeIterator(s)).next();!o.done;o=s.next()){var l=(o=$jscomp.makeIterator(o.value)).next().value;if(o.next().value==i.startTime){r&&(this.minSequenceNumber_=Math.max(this.minSequenceNumber_,l)),a.firstSequenceNumber=l;break}}}}if(!(0>this.minSequenceNumber_))for(shaka.log.debug("Syncing HLS streams against base sequence number:",this.minSequenceNumber_),r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())r=r.value,(this.ignoreManifestProgramDateTimeFor_(r.type)||t)&&(n=r.stream.segmentIndex)&&(0<(a=this.minSequenceNumber_-r.firstSequenceNumber)&&(n.dropFirstReferences(a),n=n.earliestReference())&&(n=-n.startTime,r.stream.segmentIndex.offset(n),this.offsetStreamInfo_(r,n)))},shaka.hls.HlsParser.prototype.syncStreamsWithProgramDateTime_=function(e){if(1/0==this.lowestSyncTime_)for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())t=t.value.stream.segmentIndex,goog.asserts.assert(t,"Only loaded streams should be synced"),null!=(t=t.earliestReference())&&null!=t.syncTime&&(this.lowestSyncTime_=Math.min(this.lowestSyncTime_,t.syncTime));if(1/0!=(e=this.lowestSyncTime_)){shaka.log.debug("Syncing HLS streams against base time:",e);for(var r=(t=$jscomp.makeIterator(this.uriToStreamInfosMap_.values())).next();!r.done;r=t.next())if(r=r.value,!this.ignoreManifestProgramDateTimeFor_(r.type)){var n=r.stream.segmentIndex;if(null!=n){var a=n.earliestReference();if(a)if(null==a.syncTime)shaka.log.alwaysError("Missing EXT-X-PROGRAM-DATE-TIME for stream",r.getUris(),"Expect AV sync issues!");else for(this.offsetStreamInfo_(r,a.syncTime-e-a.startTime),n=(r=$jscomp.makeIterator(n)).next();!n.done;n=r.next())n.value.syncAgainst(e)}}}},shaka.hls.HlsParser.prototype.offsetStreamInfo_=function(e,t){if(!(.001>Math.abs(t))){e.minTimestamp+=t,e.maxTimestamp+=t,goog.asserts.assert(0<=e.maxTimestamp,"Negative maxTimestamp after adjustment!");for(var r=this.getMediaSequenceToStartTimeFor_(e),n=$jscomp.makeIterator(r),a=n.next();!a.done;a=n.next()){var i=$jscomp.makeIterator(a.value);a=i.next().value,i=i.next().value,r.set(a,i+t)}shaka.log.debug("Offset",t,"applied to",e.getUris())}},shaka.hls.HlsParser.prototype.parseManifest_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M,D,O,L,N,U,j,B,F,V,G,H,K=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(W){switch(W.nextAddress){case 1:return t=shaka.hls.Utils,r=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(K.masterPlaylistUri_,"Master playlist URI must be set before calling parseManifest_!"),n=K.manifestTextParser_.parsePlaylist(e),a=t.filterTagsByName(n.tags,"EXT-X-DEFINE"),i=[],s=[],o=[],goog.asserts.assert(null==K.presentationTimeline_,"Presentation timeline created early!"),K.presentationTimeline_=new shaka.media.PresentationTimeline(null,0),K.presentationTimeline_.setStatic(!0),l=function(){return[K.masterPlaylistUri_]},u=null,c=new Map,n.type==shaka.hls.PlaylistType.MEDIA?(K.needsClosedCaptionsDetection_=!1,D=shaka.hls.Utils.filterTagsByName(n.tags,"EXT-X-DEFINE"),c=K.parseMediaVariables_(D,K.masterPlaylistUri_),u=r.VIDEO,O="",L=new Map,W.yield(K.convertParsedPlaylistIntoStreamInfo_(K.globalId_++,c,n,l,"",u,O,!0,"Media Playlist",null,L,null,!1,null,!1),7)):(K.parseMasterVariables_(a),d=t.filterTagsByName(n.tags,"EXT-X-MEDIA"),p=t.filterTagsByName(n.tags,"EXT-X-STREAM-INF"),h=t.filterTagsByName(n.tags,"EXT-X-IMAGE-STREAM-INF"),f=t.filterTagsByName(n.tags,"EXT-X-I-FRAME-STREAM-INF"),m=t.filterTagsByName(n.tags,"EXT-X-SESSION-KEY"),g=t.filterTagsByName(n.tags,"EXT-X-SESSION-DATA"),y=t.filterTagsByName(n.tags,"EXT-X-CONTENT-STEERING"),K.processSessionData_(g),W.yield(K.processContentSteering_(y),4));case 4:if(!K.config_.ignoreSupplementalCodecs){for(v=[],_=$jscomp.makeIterator(p),k=_.next(),E={};!k.done;E={supplementalCodecs$jscomp$1:void 0},k=_.next())b=k.value,(T=b.getAttributeValue("SUPPLEMENTAL-CODECS"))&&(E.supplementalCodecs$jscomp$1=T.split(/\s*,\s*/).map((function(e){return e.split("/")[0]})),A=b.attributes.map(function(e){return function(t){var r=t.name,n=t.value;return"CODECS"==r&&(n=e.supplementalCodecs$jscomp$1.join(","),1<(t=t.value.split(",")).length&&(t=shaka.util.ManifestParserUtils.guessCodecsSafe(shaka.util.ManifestParserUtils.ContentType.AUDIO,t))&&(n+=","+t)),new shaka.hls.Attribute(r,n)}}(E)),v.push(new shaka.hls.Tag(b.id,b.name,A,null)));for(p.push.apply(p,$jscomp.arrayFromIterable(v)),S=[],P=$jscomp.makeIterator(f),C=P.next(),x={};!C.done;x={supplementalCodecs$jscomp$2:void 0},C=P.next())I=C.value,(w=I.getAttributeValue("SUPPLEMENTAL-CODECS"))&&(x.supplementalCodecs$jscomp$2=w.split(/\s*,\s*/).map((function(e){return e.split("/")[0]})),R=I.attributes.map(function(e){return function(t){var r=t.name;return t=t.value,"CODECS"==r&&(t=e.supplementalCodecs$jscomp$2.join(",")),new shaka.hls.Attribute(r,t)}}(x)),S.push(new shaka.hls.Tag(I.id,I.name,R,null)));f.push.apply(f,$jscomp.arrayFromIterable(S))}return K.parseCodecs_(p),K.parseClosedCaptions_(d),M=K.parseIFrames_(f),W.yield(K.createVariantsForTags_(p,m,d,l,K.globalVariables_,M),5);case 5:return i=W.yieldResult,s=K.parseTexts_(d),W.yield(K.parseImages_(h,f),6);case 6:o=W.yieldResult,W.jumpTo(3);break;case 7:N=W.yieldResult,K.uriToStreamInfosMap_.set(K.masterPlaylistUri_,N),N.stream&&(U=shaka.media.QualityObserver.createQualityInfo(N.stream),N.stream.segmentIndex.forEachTopLevelReference((function(e){e.initSegmentReference&&(e.initSegmentReference.mediaQuality=U)}))),u=N.stream.type,i.push({id:0,language:K.getLanguage_(O),disabledUntilTime:0,primary:!0,audio:"audio"==u?N.stream:null,video:"video"==u?N.stream:null,bandwidth:N.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!K.playerInterface_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);if(K.determineStartTime_(n),n.type==shaka.hls.PlaylistType.MEDIA&&(K.isLive_()&&(K.changePresentationTimelineToLive_(n),j=K.getUpdatePlaylistDelay_(),K.updatePlaylistTimer_.tickAfter(j)),B=Array.from(K.uriToStreamInfosMap_.values()),K.finalizeStreams_(B),K.determineDuration_(),goog.asserts.assert(u,"mediaPlaylistType should be non-null"),K.processDateRangeTags_(n.tags,u,c,l)),K.manifest_={presentationTimeline:K.presentationTimeline_,variants:i,textStreams:s,imageStreams:o,offlineSessionIds:[],sequenceMode:K.config_.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:K.config_.hls.ignoreManifestTimestampsInSegmentsMode,type:shaka.media.ManifestParser.HLS,serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:K.startTime_},K.codecInfoInManifest_||!K.config_.hls.disableCodecGuessing){W.jumpTo(8);break}for(F=[],V=$jscomp.makeIterator(K.manifest_.variants),G=V.next();!G.done;G=V.next())(H=G.value).audio&&""===H.audio.codecs&&F.push(H.audio.createSegmentIndex()),H.video&&""===H.video.codecs&&F.push(H.video.createSegmentIndex());return W.yield(Promise.all(F),8);case 8:K.playerInterface_.makeTextStreamsForClosedCaptions(K.manifest_),W.jumpToEnd()}}))},shaka.hls.HlsParser.prototype.getBasicInfoFromSegments_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(k){if(1==k.nextAddress)return t=shaka.hls.HlsParser,r=shaka.media.SegmentUtils.getBasicInfoFromMimeType(_.config_.hls.mediaPlaylistFullMimeType),e.length?(n=_.getAvailableSegment_(e),a=n.segment,i=n.segmentIndex,s=a.getUris(),o=s[0],l=new goog.Uri(o),u=l.getPath().split(".").pop(),(c=t.RAW_FORMATS_TO_MIME_TYPES_.get(u))?k.return(shaka.media.SegmentUtils.getBasicInfoFromMimeType(c)):k.yield(Promise.all([_.getInfoFromSegment_(a.initSegmentReference,0),_.getInfoFromSegment_(a,i)]),2)):k.return(r);if(d=k.yieldResult,p=d[1].mimeType,h=d[0].data,f=d[1].data,m="mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" "),g=["audio/mp4","video/mp4","video/iso.segment"],shaka.util.TsParser.probe(shaka.util.BufferUtils.toUint8(f))){if(y=shaka.media.SegmentUtils.getBasicInfoFromTs(f,_.config_.disableAudio,_.config_.disableVideo,_.config_.disableText))return k.return(y)}else if((a.initSegmentReference||m.includes(u)||g.includes(p))&&(v=shaka.media.SegmentUtils.getBasicInfoFromMp4(h,f,_.config_.disableText)))return k.return(v);return p?k.return(shaka.media.SegmentUtils.getBasicInfoFromMimeType(p)):k.return(r)}))},shaka.hls.HlsParser.prototype.getInfoFromSegment_=function(e,t){var r,n,a,i,s,o,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){switch(u.nextAddress){case 1:return e?(r=shaka.net.NetworkingEngine.RequestType.SEGMENT,n=shaka.util.Networking.createSegmentRequest(e.getUris(),e.getStartByte(),e.getEndByte(),l.config_.retryParameters),a=e instanceof shaka.media.SegmentReference?shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_SEGMENT:shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT,u.yield(l.makeNetworkRequest_(n,r,{type:a}).promise,2)):u.return({mimeType:null,data:null});case 2:if(i=u.yieldResult,s=i.data,!e.aesKey){u.jumpTo(3);break}return u.yield(shaka.media.SegmentUtils.aesDecrypt(s,e.aesKey,t),4);case 4:s=u.yieldResult;case 3:return e instanceof shaka.media.SegmentReference?e.setSegmentData(s,!0):e.setSegmentData(s),(o=i.headers["content-type"])&&(o=o.split(";")[0].toLowerCase()),u.return({mimeType:o,data:s})}}))},shaka.hls.HlsParser.prototype.determineDuration_=function(){if(goog.asserts.assert(this.presentationTimeline_,"Presentation timeline not created!"),this.isLive_()){if(this.presentationType_==shaka.hls.HlsParser.PresentationType_.LIVE){var e=this.getLiveDuration_()||0;isNaN(this.config_.availabilityWindowOverride)||(e=this.config_.availabilityWindowOverride),this.presentationTimeline_.setSegmentAvailabilityDuration(e)}}else this.presentationTimeline_.setDuration(this.getMinDuration_());if(!this.presentationTimeline_.isStartTimeLocked())for(var t=(e=$jscomp.makeIterator(this.uriToStreamInfosMap_.values())).next();!t.done;t=e.next())!(t=t.value).stream.segmentIndex||"audio"!=t.type&&"video"!=t.type||(t=t.stream.segmentIndex.earliestReference())&&t.syncTime&&this.presentationTimeline_.setInitialProgramDateTime(t.syncTime);this.presentationTimeline_.lockStartTime(),goog.asserts.assert(!this.presentationTimeline_.usingPresentationStartTime(),"We should not be using the presentation start time in HLS!")},shaka.hls.HlsParser.prototype.parseMasterVariables_=function(e){for(var t=new goog.Uri(this.masterPlaylistUri_).getQueryData(),r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var n=r.value;r=n.getAttributeValue("NAME");var a=n.getAttributeValue("VALUE");n=n.getAttributeValue("QUERYPARAM"),r&&a&&(this.globalVariables_.has(r)||this.globalVariables_.set(r,a)),n&&(r=t.get(n)[0])&&!this.globalVariables_.has(r)&&this.globalVariables_.set(n,r)}},shaka.hls.HlsParser.prototype.parseMediaVariables_=function(e,t){t=new goog.Uri(t).getQueryData();for(var r=new Map,n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){var a=n.value,i=a.getAttributeValue("NAME"),s=a.getAttributeValue("VALUE");n=a.getAttributeValue("QUERYPARAM"),a=a.getAttributeValue("IMPORT"),i&&s&&(r.has(i)||r.set(i,s)),n&&(i=t.get(n)[0])&&!r.has(i)&&r.set(n,i),a&&(n=this.globalVariables_.get(a))&&r.set(a,n)}return r},shaka.hls.HlsParser.prototype.parseCodecs_=function(e){for(var t=shaka.util.ManifestParserUtils.ContentType,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var n=r.value,a=n.getAttributeValue("AUDIO");r=n.getAttributeValue("VIDEO");var i=n.getAttributeValue("SUBTITLES");if(n=this.getCodecsForVariantTag_(n),i){var s=shaka.util.ManifestParserUtils.guessCodecsSafe(t.TEXT,n);goog.asserts.assert(null!=s,"Text codecs should be valid."),this.groupIdToCodecsMap_.set(i,s),shaka.util.ArrayUtils.remove(n,s)}a&&((i=shaka.util.ManifestParserUtils.guessCodecsSafe(t.AUDIO,n))||(i=this.config_.hls.defaultAudioCodec),this.groupIdToCodecsMap_.set(a,i)),r&&((a=shaka.util.ManifestParserUtils.guessCodecsSafe(t.VIDEO,n))||(a=this.config_.hls.defaultVideoCodec),this.groupIdToCodecsMap_.set(r,a))}},shaka.hls.HlsParser.prototype.processSessionData_=function(e){for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value,n=r.getAttributeValue("DATA-ID");t=r.getAttributeValue("URI");var a=r.getAttributeValue("LANGUAGE");r=r.getAttributeValue("VALUE"),n=(new Map).set("id",n),t&&n.set("uri",shaka.hls.Utils.constructSegmentUris([this.masterPlaylistUri_],t,this.globalVariables_)[0]),a&&n.set("language",a),r&&n.set("value",r),t=new shaka.util.FakeEvent("sessiondata",n),this.playerInterface_&&this.playerInterface_.onEvent(t)}},shaka.hls.HlsParser.prototype.processContentSteering_=function(e){var t,r,n,a,i,s,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(!o.playerInterface_||!o.config_)return l.return();for(r=$jscomp.makeIterator(e),n=r.next();!n.done;n=r.next())if(a=n.value,i=a.getAttributeValue("PATHWAY-ID"),s=a.getAttributeValue("SERVER-URI"),i&&s){o.contentSteeringManager_=new shaka.util.ContentSteeringManager(o.playerInterface_),o.contentSteeringManager_.configure(o.config_),o.contentSteeringManager_.setBaseUris([o.masterPlaylistUri_]),o.contentSteeringManager_.setManifestType(shaka.media.ManifestParser.HLS),o.contentSteeringManager_.setDefaultPathwayId(i),t=o.contentSteeringManager_.requestInfo(s);break}return l.yield(t,0)}))},shaka.hls.HlsParser.prototype.parseTexts_=function(e){var t=this,r=shaka.hls.Utils.filterTagsByType(e,"SUBTITLES");e=r.map((function(e){if(t.config_.disableText)return null;try{return t.createStreamInfoFromMediaTags_([e],new Map).stream}catch(e){if(t.config_.hls.ignoreTextStreamFailures)return null;throw e}}));for(var n=shaka.util.ManifestParserUtils.ContentType.TEXT,a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next()){var i=a.value.getRequiredAttrValue("GROUP-ID");if((a=this.groupIdToCodecsMap_.get(i))&&(i=this.groupIdToStreamInfosMap_.get(i)))for(var s=(i=$jscomp.makeIterator(i)).next();!s.done;s=i.next())(s=s.value).stream.codecs=a,s.stream.mimeType=this.guessMimeTypeBeforeLoading_(n,a)||this.guessMimeTypeFallback_(n),this.setFullTypeForStream_(s.stream)}return e.filter((function(e){return e}))},shaka.hls.HlsParser.prototype.setFullTypeForStream_=function(e){var t=new Set([shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs)]);e.segmentIndex&&e.segmentIndex.forEachTopLevelReference((function(r){r.mimeType&&t.add(shaka.util.MimeUtils.getFullType(r.mimeType,e.codecs))})),e.fullMimeTypes=t},shaka.hls.HlsParser.prototype.parseImages_=function(e,t){var r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(r=e.map((function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return a.config_.disableThumbnails?n.return(null):(n.setCatchFinallyBlocks(2),n.yield(a.createStreamInfoFromImageTag_(e),4));if(2!=n.nextAddress)return t=n.yieldResult,n.return(t.stream);if(r=n.enterCatchBlock(),a.config_.hls.ignoreImageStreamFailures)return n.return(null);throw r}))})).concat(t.map((function(e){if(a.config_.disableThumbnails)return null;try{var t=a.createStreamInfoFromIframeTag_(e);return t.stream.type!==shaka.util.ManifestParserUtils.ContentType.IMAGE?null:t.stream}catch(e){if(a.config_.hls.ignoreImageStreamFailures)return null;throw e}}))),i.yield(Promise.all(r),2)):(n=i.yieldResult,i.return(n.filter((function(e){return e}))))}))},shaka.hls.HlsParser.prototype.createStreamInfosFromMediaTags_=function(e,t){e=e.filter((function(e){var t=e.getAttributeValue("URI")||"";return"SUBTITLES"!=(e=e.getAttributeValue("TYPE"))&&(""!=t||"AUDIO"==e)}));for(var r={},n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){var a=(n=n.value).getTagKey(!this.contentSteeringManager_);r[a]?r[a].push(n):r[a]=[n]}for(var i in r)this.createStreamInfoFromMediaTags_(r[i],t,!1)},shaka.hls.HlsParser.prototype.parseIFrames_=function(e){var t=this;return e.map((function(e){return(e=t.createStreamInfoFromIframeTag_(e)).stream.type!==shaka.util.ManifestParserUtils.ContentType.VIDEO?null:e.stream})).filter((function(e){return e}))},shaka.hls.HlsParser.prototype.createVariantsForTags_=function(e,t,r,n,a,i){var s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M,D,O,L,N,U,j,B,F,V,G,H=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(K){switch(K.nextAddress){case 1:if(s=[],o=new Set,H.config_.ignoreDrmInfo||!(0<t.length)){K.jumpTo(2);break}l=$jscomp.makeIterator(t),u=l.next();case 3:if(u.done){K.jumpTo(2);break}if(c=u.value,d=c.getRequiredAttrValue("METHOD"),p=c.getAttributeValue("KEYFORMAT")||"identity",h=null,"NONE"==d){K.jumpTo(4);break}if(H.isAesMethod_(d)){f=shaka.hls.Utils.constructSegmentUris(n(),c.getRequiredAttrValue("URI"),a),m=f.sort().join(""),H.aesKeyMap_.has(m)||(g=shaka.net.NetworkingEngine.RequestType.KEY,y=shaka.net.NetworkingEngine.makeRequest(f,H.config_.retryParameters),v=H.makeNetworkRequest_(y,g).promise,H.aesKeyMap_.set(m,v)),K.jumpTo(4);break}if("identity"==p)return K.yield(H.identityDrmParser_(c,"",n,null,a),12);if(!(_=H.keyFormatsToDrmParsers_.get(p))){k=null,K.jumpTo(10);break}return K.yield(_(c,"",null),11);case 11:k=K.yieldResult;case 10:h=k,K.jumpTo(6);break;case 12:h=K.yieldResult;case 6:if(h){if(h.keyIds)for(E=$jscomp.makeIterator(h.keyIds),b=E.next();!b.done;b=E.next())T=b.value,o.add(T);s.push(h)}else shaka.log.warning("Unsupported HLS KEYFORMAT",p);case 4:u=l.next(),K.jumpTo(3);break;case 2:for(A={},S=$jscomp.makeIterator(e),P=S.next();!P.done;P=S.next())C=P.value,x=C.getTagKey(!H.contentSteeringManager_),A[x]?A[x].push(C):A[x]=[C];for(w in I=[],A)R=A[w],M=R[0],D=M.getAttributeValue("FRAME-RATE"),O=Number(M.getAttributeValue("AVERAGE-BANDWIDTH"))||Number(M.getRequiredAttrValue("BANDWIDTH")),L=M.getAttributeValue("RESOLUTION"),N=$jscomp.makeIterator(L?L.split("x"):[null,null]),U=N.next().value,j=N.next().value,B=M.getAttributeValue("VIDEO-RANGE"),(F=M.getAttributeValue("REQ-VIDEO-LAYOUT"))&&F.includes(",")&&(V=F.split(",").filter((function(e){return"CH-STEREO"==e||"CH-MONO"==e})),F=V[0]),F=F||"CH-MONO",G=H.createStreamInfosForVariantTags_(R,r,L,D),goog.asserts.assert(G.audio.length||G.video.length,"We should have created a stream!"),I.push.apply(I,$jscomp.arrayFromIterable(H.createVariants_(G.audio,G.video,O,U,j,D,B,F,s,o,i)));return K.return(I.filter((function(e){return null!=e})))}}))},shaka.hls.HlsParser.prototype.createStreamInfosForVariantTags_=function(e,t,r,n){n=shaka.util.ManifestParserUtils.ContentType,r={audio:[],video:[]};for(var a=new Map,i=[],s=!1,o=!1,l=$jscomp.makeIterator(e),u=l.next();!u.done;u=l.next()){var c=(u=u.value).getAttributeValue("AUDIO"),d=u.getAttributeValue("VIDEO");goog.asserts.assert(null==c||null==d,"Unexpected: both video and audio described by media tags!");var p=c||d;if(p){i.includes(p)||i.push(p);var h=u.getAttributeValue("PATHWAY-ID");h&&a.set(p,h),c?s=!0:d&&(o=!0),shaka.log.debug("Guessing stream type for",u.toString())}}i.length&&t.length&&(t=t.filter((function(e){return i.includes(e.getRequiredAttrValue("GROUP-ID"))})),this.createStreamInfosFromMediaTags_(t,a)),a=(t=i.sort().join(","))&&this.groupIdToStreamInfosMap_.has(t)?this.groupIdToStreamInfosMap_.get(t):[],s?r.audio.push.apply(r.audio,$jscomp.arrayFromIterable(a)):o&&r.video.push.apply(r.video,$jscomp.arrayFromIterable(a)),s=!1;var f=e.map((function(e){return e.getRequiredAttrValue("URI")}));return u=r.audio.find((function(e){return e&&e.getUris().find((function(e){return f.includes(e)}))})),o=this.getCodecsForVariantTag_(e[0]),a=shaka.util.ManifestParserUtils.guessCodecsSafe(n.VIDEO,o),(l=shaka.util.ManifestParserUtils.guessCodecsSafe(n.AUDIO,o))&&!a?(n=n.AUDIO,shaka.log.debug("Guessing audio-only."),s=0<r.audio.length):!r.audio.length&&!r.video.length&&l&&a?(shaka.log.debug("Guessing multiplexed audio+video."),n=n.VIDEO,o=[[a,l].join()]):r.audio.length&&u?(shaka.log.debug("Guessing audio-only."),n=n.AUDIO,s=!0):r.video.length&&!r.audio.length?(shaka.log.debug("Guessing audio-only."),n=n.AUDIO):(shaka.log.debug("Guessing video-only."),n=n.VIDEO),s||(e=this.createStreamInfoFromVariantTags_(e,o,n),t&&(e.stream.groupId=t),r[e.stream.type]=[e]),r},shaka.hls.HlsParser.prototype.getCodecsForVariantTag_=function(e){return e=e.getAttributeValue("CODECS")||"",this.codecInfoInManifest_=0<e.length,this.codecInfoInManifest_||this.config_.hls.disableCodecGuessing||(e=[],this.config_.disableVideo||e.push(this.config_.hls.defaultVideoCodec),this.config_.disableAudio||e.push(this.config_.hls.defaultAudioCodec),e=e.join(",")),e=e.split(/\s*,\s*/),shaka.media.SegmentUtils.codecsFiltering(e)},shaka.hls.HlsParser.prototype.getChannelsCount_=function(e){return(e=e.getAttributeValue("CHANNELS"))?(e=e.split("/")[0],parseInt(e,10)):null},shaka.hls.HlsParser.prototype.getSampleRate_=function(e){return(e=e.getAttributeValue("SAMPLE-RATE"))?parseInt(e,10):null},shaka.hls.HlsParser.prototype.isSpatialAudio_=function(e){return!!(e=e.getAttributeValue("CHANNELS"))&&(2==(e=e.split("/")).length&&("JOC"===e[1]||e[1].includes("ATMOS")))},shaka.hls.HlsParser.prototype.getClosedCaptions_=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType;if(e=e.getAttributeValue("CLOSED-CAPTIONS"),t==r.VIDEO){if(this.config_.disableText)return this.needsClosedCaptionsDetection_=!1,null;if(e){if("NONE"!=e)return this.groupIdToClosedCaptionsMap_.get(e);this.needsClosedCaptionsDetection_=!1}else if(!e&&this.groupIdToClosedCaptionsMap_.size)for(t=$jscomp.makeIterator(this.groupIdToClosedCaptionsMap_.keys()).next();!t.done;)return this.groupIdToClosedCaptionsMap_.get(t.value)}return null},shaka.hls.HlsParser.prototype.getLanguage_=function(e){return shaka.util.LanguageUtils.normalize(e||"und")},shaka.hls.HlsParser.prototype.getType_=function(e){return"subtitles"==(e=e.getRequiredAttrValue("TYPE").toLowerCase())&&(e=shaka.util.ManifestParserUtils.ContentType.TEXT),e},shaka.hls.HlsParser.prototype.createVariants_=function(e,t,r,n,a,i,s,o,l,u,c){for(var d=shaka.util.ManifestParserUtils.ContentType,p=shaka.drm.DrmUtils,h=$jscomp.makeIterator(t),f=h.next();!f.done;f=h.next())this.addVideoAttributes_(f.value.stream,n,a,i,s,o,null);for(n=this.config_.disableAudio,e.length&&!n||(e=[null]),n=this.config_.disableVideo,t.length&&!n||(t=[null]),n=[],a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())for(a=a.value,s=(i=$jscomp.makeIterator(t)).next();!s.done;s=i.next()){var m=s.value;(s=a?a.stream:null)&&(s.drmInfos=l,s.keyIds=u),(o=m?m.stream:null)&&(o.drmInfos=l,o.keyIds=u,this.config_.disableIFrames||shaka.util.StreamUtils.setBetterIFrameStream(o,c)),o&&!s&&(o.bandwidth=r),!o&&s&&(s.bandwidth=r),h=a?a.stream.drmInfos:null,f=m?m.stream.drmInfos:null,m=m?m.getUris().sort().join(","):"";var g=a?a.getUris().sort().join(","):"",y=[];s&&s.codecs&&y.push(s.codecs),o&&o.codecs&&y.push(o.codecs),m=[m,g,y.sort()].join("-"),s&&o&&!p.areDrmCompatible(h,f)?shaka.log.warning("Incompatible DRM info in HLS variant.  Skipping."):this.variantUriSet_.has(m)?shaka.log.debug("Skipping variant which only differs in text streams."):(goog.asserts.assert(!s||s.type==d.AUDIO,"Audio parameter mismatch!"),goog.asserts.assert(!o||o.type==d.VIDEO,"Video parameter mismatch!"),s={id:this.globalId_++,language:s?s.language:"und",disabledUntilTime:0,primary:!!s&&s.primary||!!o&&o.primary,audio:s,video:o,bandwidth:r,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},n.push(s),this.variantUriSet_.add(m))}return n},shaka.hls.HlsParser.prototype.parseClosedCaptions_=function(e){e=shaka.hls.Utils.filterTagsByType(e,"CLOSED-CAPTIONS"),this.needsClosedCaptionsDetection_=0==e.length;for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value;goog.asserts.assert("EXT-X-MEDIA"==r.name,"Should only be called on media tags!");var n=r.getAttributeValue("LANGUAGE");t=this.getLanguage_(n),n||(n=r.getAttributeValue("NAME"))&&(t=n),n=r.getRequiredAttrValue("GROUP-ID"),r=r.getRequiredAttrValue("INSTREAM-ID").replace("SERVICE","svc"),this.groupIdToClosedCaptionsMap_.get(n)||this.groupIdToClosedCaptionsMap_.set(n,new Map),this.groupIdToClosedCaptionsMap_.get(n).set(r,t)}},shaka.hls.HlsParser.prototype.createStreamInfoFromMediaTags_=function(e,t,r){r=void 0===r||r;for(var n=[],a=[],i=new Map,s=$jscomp.makeIterator(e),o=s.next();!o.done;o=s.next()){var l=o.value;goog.asserts.assert("EXT-X-MEDIA"==l.name,"Should only be called on media tags!"),o=r?l.getRequiredAttrValue("URI"):l.getAttributeValue("URI")||shaka.hls.HlsParser.FAKE_MUXED_URL_,l=l.getRequiredAttrValue("GROUP-ID"),n.push(o),a.push(l),i.set(l,o)}if(r=a.sort().join(","),o=e[0],e="",(s=this.getType_(o))==shaka.util.ManifestParserUtils.ContentType.TEXT)e=o.getAttributeValue("CODECS")||"";else for(l=(a=$jscomp.makeIterator(a)).next();!l.done;l=a.next())if(l=l.value,this.groupIdToCodecsMap_.has(l)){e=this.groupIdToCodecsMap_.get(l);break}if(a=n.sort().join(","),this.uriToStreamInfosMap_.has(a))return this.uriToStreamInfosMap_.get(a);if(l=this.globalId_++,this.contentSteeringManager_)for(var u=(i=$jscomp.makeIterator(i)).next();!u.done;u=i.next()){var c=$jscomp.makeIterator(u.value);u=c.next().value,c=c.next().value,(u=t.get(u))&&this.contentSteeringManager_.addLocation(l,u,c)}t=o.getAttributeValue("LANGUAGE"),i=o.getAttributeValue("NAME"),u="YES"==o.getAttributeValue("DEFAULT"),c="audio"==s?this.getChannelsCount_(o):null;var d="audio"==s&&this.isSpatialAudio_(o),p=o.getAttributeValue("CHARACTERISTICS"),h="YES"==o.getAttributeValue("FORCED");return o="audio"==s?this.getSampleRate_(o):null,(n=this.createStreamInfo_(l,n,e,s,t,u,i,c,null,p,h,o,d)).stream&&(n.stream.groupId=r),this.groupIdToStreamInfosMap_.has(r)?this.groupIdToStreamInfosMap_.get(r).push(n):this.groupIdToStreamInfosMap_.set(r,[n]),this.uriToStreamInfosMap_.set(a,n),n},shaka.hls.HlsParser.prototype.createStreamInfoFromImageTag_=function(e){var t,r,n,a,i,s,o,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){return 1==h.nextAddress?(goog.asserts.assert("EXT-X-IMAGE-STREAM-INF"==e.name,"Should only be called on image tags!"),t=shaka.util.ManifestParserUtils.ContentType.IMAGE,r=e.getRequiredAttrValue("URI"),n=e.getAttributeValue("CODECS","jpeg")||"",p.uriToStreamInfosMap_.has(r)?h.return(p.uriToStreamInfosMap_.get(r)):(a=e.getAttributeValue("LANGUAGE"),i=e.getAttributeValue("NAME"),s=e.getAttributeValue("CHARACTERISTICS"),o=p.createStreamInfo_(p.globalId_++,[r],n,t,a,!1,i,null,null,s,!1,null,!1),(l=e.getAttributeValue("RESOLUTION"))?h.yield(o.stream.createSegmentIndex(),3):h.jumpTo(2))):(2!=h.nextAddress&&(u=o.stream.segmentIndex.earliestReference(),c=u.getTilesLayout())&&(o.stream.width=Number(l.split("x")[0])*Number(c.split("x")[0]),o.stream.height=Number(l.split("x")[1])*Number(c.split("x")[1])),(d=e.getAttributeValue("BANDWIDTH"))&&(o.stream.bandwidth=Number(d)),p.uriToStreamInfosMap_.set(r,o),h.return(o))}))},shaka.hls.HlsParser.prototype.createStreamInfoFromIframeTag_=function(e){goog.asserts.assert("EXT-X-I-FRAME-STREAM-INF"==e.name,"Should only be called on iframe tags!");var t=shaka.util.ManifestParserUtils.ContentType.VIDEO,r=e.getRequiredAttrValue("URI"),n=e.getAttributeValue("CODECS")||"";if("mjpg"==n&&(t=shaka.util.ManifestParserUtils.ContentType.IMAGE),this.uriToStreamInfosMap_.has(r))return this.uriToStreamInfosMap_.get(r);var a=e.getAttributeValue("LANGUAGE"),i=e.getAttributeValue("NAME"),s=e.getAttributeValue("CHARACTERISTICS");return t=this.createStreamInfo_(this.globalId_++,[r],n,t,a,!1,i,null,null,s,!1,null,!1),n=e.getAttributeValue("RESOLUTION"),a=$jscomp.makeIterator(n?n.split("x"):[null,null]),n=a.next().value,a=a.next().value,t.stream.width=Number(n)||void 0,t.stream.height=Number(a)||void 0,(e=e.getAttributeValue("BANDWIDTH"))&&(t.stream.bandwidth=Number(e)),this.uriToStreamInfosMap_.set(r,t),t},shaka.hls.HlsParser.prototype.createStreamInfoFromVariantTags_=function(e,t,r){for(var n=this.globalId_++,a=[],i=$jscomp.makeIterator(e),s=i.next();!s.done;s=i.next()){var o=s.value;goog.asserts.assert("EXT-X-STREAM-INF"==o.name,"Should only be called on variant tags!"),s=o.getRequiredAttrValue("URI"),o=o.getAttributeValue("PATHWAY-ID"),this.contentSteeringManager_&&o&&this.contentSteeringManager_.addLocation(n,o,s),a.push(s)}return i=a.sort().join(",")+t.sort().join(","),this.uriToStreamInfosMap_.has(i)?this.uriToStreamInfosMap_.get(i):(s=a.join(","),e=this.getClosedCaptions_(e[0],r),t=shaka.util.ManifestParserUtils.guessCodecs(r,t),r=this.createStreamInfo_(n,a,t,r,null,!1,s,null,e,null,!1,null,!1),this.uriToStreamInfosMap_.set(i,r),r)},shaka.hls.HlsParser.prototype.createStreamInfo_=function(e,t,r,n,a,i,s,o,l,u,c,d,p){var h=this,f=this.makeStreamObject_(e,r,n,a,i,s,o,l,u,c,d,p);t.includes(shaka.hls.HlsParser.FAKE_MUXED_URL_)&&(f.isAudioMuxedInVideo=!0,f.mimeType="video/mp2t",this.setFullTypeForStream_(f));var m={stream:f,type:n,redirectUris:[],getUris:function(){},minTimestamp:0,maxTimestamp:0,mediaSequenceToStartTime:new Map,canSkipSegments:!1,canBlockReload:!1,hasEndList:!1,firstSequenceNumber:-1,nextMediaSequence:-1,nextPart:-1,loadedOnce:!1},g=function(){return h.contentSteeringManager_&&1<t.length?h.contentSteeringManager_.getLocations(e):m.redirectUris.concat(shaka.hls.Utils.constructUris([h.masterPlaylistUri_],t,h.globalVariables_))};m.getUris=g;var y,v=null;return f.createSegmentIndex=function(){if(v)return v;if(f.isAudioMuxedInVideo){var t=new shaka.media.SegmentIndex([]);return f.segmentIndex=t,Promise.resolve()}return y=h.requestManifest_(m.getUris(),!0),v=new Promise((function(t){t(function(t){var y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M,D,O,L,N,U;return $jscomp.asyncExecutePromiseGeneratorProgram((function(j){switch(j.nextAddress){case 1:return y=shaka.util.ManifestParserUtils.ContentType,j.setCatchFinallyBlocks(2),j.yield(t.promise,4);case 4:if(v=j.yieldResult,t.aborted)return j.return();if((_=v.uri)!=v.originalUri&&(m.getUris().includes(_)||m.redirectUris.push(_)),(k=h.manifestTextParser_.parsePlaylist(v.data)).type!=shaka.hls.PlaylistType.MEDIA)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);return E=shaka.hls.Utils.filterTagsByName(k.tags,"EXT-X-DEFINE"),b=h.parseMediaVariables_(E,_),T=!1,(!h.codecInfoInManifest_&&h.config_.hls.disableCodecGuessing||h.needsClosedCaptionsDetection_&&n==y.VIDEO&&!h.config_.hls.disableClosedCaptionsDetection)&&0<k.segments.length&&(h.needsClosedCaptionsDetection_=!1,T=!0),A=!h.codecInfoInManifest_&&h.config_.hls.disableCodecGuessing,S=h.isLive_(),j.yield(h.convertParsedPlaylistIntoStreamInfo_(e,b,k,g,r,n,a,i,s,o,l,u,c,d,p,void 0,T,A),5);case 5:if(P=j.yieldResult,t.aborted)return j.return();if(C=P.stream,h.determineStartTime_(k),h.isLive_()&&!S&&h.changePresentationTimelineToLive_(k),m.minTimestamp=P.minTimestamp,m.maxTimestamp=P.maxTimestamp,m.canSkipSegments=P.canSkipSegments,m.canBlockReload=P.canBlockReload,m.hasEndList=P.hasEndList,m.mediaSequenceToStartTime=P.mediaSequenceToStartTime,m.nextMediaSequence=P.nextMediaSequence,m.nextPart=P.nextPart,m.loadedOnce=!0,f.segmentIndex=C.segmentIndex,f.encrypted=C.encrypted,f.drmInfos=C.drmInfos,f.keyIds=C.keyIds,f.mimeType=C.mimeType,f.bandwidth=f.bandwidth||C.bandwidth,f.codecs=f.codecs||C.codecs,f.closedCaptions=f.closedCaptions||C.closedCaptions,f.width=f.width||C.width,f.height=f.height||C.height,f.hdr=f.hdr||C.hdr,f.colorGamut=f.colorGamut||C.colorGamut,f.frameRate=f.frameRate||C.frameRate,"und"==f.language&&"und"!=C.language&&(f.language=C.language),f.language=f.language||C.language,f.channelsCount=f.channelsCount||C.channelsCount,f.audioSamplingRate=f.audioSamplingRate||C.audioSamplingRate,h.setFullTypeForStream_(f),f.drmInfos.length&&h.playerInterface_.newDrmInfo(f),x=!1,(!l&&f.closedCaptions||l&&f.closedCaptions&&l.size!=f.closedCaptions.size)&&(x=!0),h.manifest_&&x&&h.playerInterface_.makeTextStreamsForClosedCaptions(h.manifest_),n==y.VIDEO||n==y.AUDIO)for(I=$jscomp.makeIterator(h.uriToStreamInfosMap_.values()),w=I.next();!w.done;w=I.next())(R=w.value).loadedOnce||R.type!=n||(R.stream.mimeType=C.mimeType,h.setFullTypeForStream_(R.stream));n==y.TEXT&&(M=C.segmentIndex.earliestReference())&&M.initSegmentReference&&(f.mimeType="application/mp4",h.setFullTypeForStream_(f)),D=shaka.media.QualityObserver.createQualityInfo(f),f.segmentIndex.forEachTopLevelReference((function(e){e.initSegmentReference&&(e.initSegmentReference.mediaQuality=D)})),h.hasEnoughInfoToFinalizeStreams_()&&(h.streamsFinalized_?h.finalizeStreams_([m]):(h.streamsFinalized_=!0,O=Array.from(h.uriToStreamInfosMap_.values()),L=O.filter((function(e){return e.stream.segmentIndex})),h.finalizeStreams_(L),h.determineDuration_(),0<(N=h.getUpdatePlaylistDelay_())&&h.updatePlaylistTimer_.tickAfter(N))),h.processDateRangeTags_(k.tags,f.type,b,g),h.manifest_&&(h.manifest_.startTime=h.startTime_),j.leaveTryBlock(0);break;case 2:if(U=j.enterCatchBlock(),f.closeSegmentIndex(),U.code===shaka.util.Error.Code.OPERATION_ABORTED)return j.return();if(!h.playerInterface_.disableStream(f))throw U;j.jumpToEnd()}}))}(y))}))},f.closeSegmentIndex=function(){v&&!f.segmentIndex&&y.abort(),f.segmentIndex&&(f.segmentIndex.release(),f.segmentIndex=null),v=null},m},shaka.hls.HlsParser.prototype.getMinDuration_=function(){for(var e=1/0,t=$jscomp.makeIterator(this.uriToStreamInfosMap_.values()),r=t.next();!r.done;r=t.next())(r=r.value).stream.segmentIndex&&"text"!=r.stream.type&&!r.stream.isAudioMuxedInVideo&&(e=Math.min(e,r.maxTimestamp));return e},shaka.hls.HlsParser.prototype.getLiveDuration_=function(){for(var e=1/0,t=1/0,r=$jscomp.makeIterator(this.uriToStreamInfosMap_.values()),n=r.next();!n.done;n=r.next())(n=n.value).stream.segmentIndex&&"text"!=n.stream.type&&!n.stream.isAudioMuxedInVideo&&(e=Math.min(e,n.maxTimestamp),t=Math.min(t,n.minTimestamp));return e-t},shaka.hls.HlsParser.prototype.notifySegmentsForStreams_=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value).segmentIndex&&r.segmentIndex.forEachTopLevelReference((function(e){t.push(e)}));this.presentationTimeline_.notifySegments(t)},shaka.hls.HlsParser.prototype.finalizeStreams_=function(e){if(!this.isLive_())for(var t=this.getMinDuration_(),r=$jscomp.makeIterator(e),n=r.next();!n.done;n=r.next())n.value.stream.segmentIndex.fit(0,t);this.notifySegmentsForStreams_(e.map((function(e){return e.stream}))),r=Array.from(this.uriToStreamInfosMap_.values()).filter((function(e){return e.stream.segmentIndex}));var a=shaka.util.ManifestParserUtils.ContentType;t=r.some((function(e){return e.stream.type==a.AUDIO})),n=r.some((function(e){return e.stream.type==a.VIDEO})),r=this.isLive_()&&!this.usesProgramDateTime_,t=!this.isLive_()&&this.usesProgramDateTime_&&!(t&&n),this.config_.hls.ignoreManifestProgramDateTime||r||t?this.syncStreamsWithSequenceNumber_(e,r):(this.syncStreamsWithProgramDateTime_(e),0<this.config_.hls.ignoreManifestProgramDateTimeForTypes.length&&this.syncStreamsWithSequenceNumber_(e))},shaka.hls.HlsParser.prototype.ignoreManifestProgramDateTimeFor_=function(e){return!!this.config_.hls.ignoreManifestProgramDateTime||this.config_.hls.ignoreManifestProgramDateTimeForTypes.includes(e)},shaka.hls.HlsParser.prototype.hasEnoughInfoToFinalizeStreams_=function(){if(!this.manifest_)return!1;for(var e=[],t=[],r=$jscomp.makeIterator(this.manifest_.variants),n=r.next();!n.done;n=r.next())(n=n.value).video&&e.push(n.video),n.audio&&t.push(n.audio);return!(0<e.length&&!e.some((function(e){return e.segmentIndex}))||0<t.length&&!t.some((function(e){return e.segmentIndex})))},shaka.hls.HlsParser.prototype.convertParsedPlaylistIntoStreamInfo_=function(e,t,r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y){g=void 0===g||g,y=void 0===y||y;var v,_,k,E,b,T,A,S,P,C,x,I,w,R,M,D,O,L,N,U,j,B,F,V,G,H,K,W,$,z=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(q){switch(q.nextAddress){case 1:if(v=r.segments||[],_=v.every((function(e){return!!shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-GAP")})),!v.length||_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_EMPTY_MEDIA_PLAYLIST);if(z.determinePresentationType_(r),z.isLive_()&&z.determineLastTargetDuration_(r),k=z.isLive_()?z.mediaSequenceToStartTimeByType_.get(i):new Map,E=z.createSegments_(r,k,t,n,i),b=E.segments,T=E.bandwidth,x=C=P=S=A=null,!(0<b.length&&g)){q.jumpTo(2);break}return q.yield(z.getBasicInfoFromSegments_(b),3);case 3:I=q.yieldResult,i=I.type,s=I.language,u=I.channelCount,h=I.sampleRate,z.config_.disableText||(c=I.closedCaptions),S=I.height,A=I.width,P=I.videoRange,C=I.colorGamut,x=I.frameRate,y&&(m=I.mimeType,a=I.codecs);case 2:if(m){q.jumpTo(4);break}return q.yield(z.guessMimeType_(i,a,b),5);case 5:m=q.yieldResult,i!=shaka.util.ManifestParserUtils.ContentType.TEXT||a||"application/mp4"!=m||!b[0]||b[0].initSegmentReference||(m="text/vtt");case 4:return q.yield(z.parseDrmInfo_(r,m,n,t),6);case 6:if(w=q.yieldResult,R=w.drmInfos,M=w.keyIds,D=w.encrypted,O=w.aesEncrypted,D&&!R.length&&!O)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_KEYFORMATS_NOT_SUPPORTED);return(L=z.makeStreamObject_(e,a,i,s,o,l,u,c,d,p,h,f)).encrypted=D&&!O,L.drmInfos=R,L.keyIds=M,L.mimeType=m,T&&(L.bandwidth=T),z.setFullTypeForStream_(L),i==shaka.util.ManifestParserUtils.ContentType.VIDEO&&(A||S||P||C)&&z.addVideoAttributes_(L,A,S,x,P,null,C),z.isLive_()&&z.determineLastTargetDuration_(r),N=b[0].startTime,U=b[b.length-1],j=U.endTime,B=new shaka.media.SegmentIndex(b),L.segmentIndex=B,V=!!(F=shaka.hls.Utils.getFirstTagWithName(r.tags,"EXT-X-SERVER-CONTROL"))&&null!=F.getAttribute("CAN-SKIP-UNTIL"),G=!!F&&null!=F.getAttribute("CAN-BLOCK-RELOAD"),H=shaka.hls.Utils.getFirstTagWithNameAsNumber(r.tags,"EXT-X-MEDIA-SEQUENCE",0),K=z.getNextMediaSequenceAndPart_(H,b),W=K.nextMediaSequence,$=K.nextPart,q.return({stream:L,type:i,redirectUris:[],getUris:n,minTimestamp:N,maxTimestamp:j,canSkipSegments:V,canBlockReload:G,hasEndList:!1,firstSequenceNumber:-1,nextMediaSequence:W,nextPart:$,mediaSequenceToStartTime:k,loadedOnce:!1})}}))},shaka.hls.HlsParser.prototype.getNextMediaSequenceAndPart_=function(e,t){e=e+t.length-1;var r=-1;if(!t.length)return{nextMediaSequence:++e,nextPart:r};var n=(t=t[t.length-1]).partialReferences;return t.partialReferences.length?(r=n.length-1,n[n.length-1].isPreload()||(e++,r=0),{nextMediaSequence:e,nextPart:r}):(e++,t.hasByterangeOptimization()&&(r=0),{nextMediaSequence:e,nextPart:r})},shaka.hls.HlsParser.prototype.makeStreamObject_=function(e,t,r,n,a,i,s,o,l,u,c,d){e=this.guessMimeTypeBeforeLoading_(r,t)||this.guessMimeTypeFallback_(r);var p=[];if(l)for(var h=(l=$jscomp.makeIterator(l.split(","))).next();!h.done;h=l.next())p.push(h.value);return l=void 0,h=null,r==shaka.util.ManifestParserUtils.ContentType.TEXT?l=p.includes("public.accessibility.transcribes-spoken-dialog")&&p.includes("public.accessibility.describes-music-and-sound")?shaka.util.ManifestParserUtils.TextStreamKind.CLOSED_CAPTION:shaka.util.ManifestParserUtils.TextStreamKind.SUBTITLE:p.includes("public.accessibility.describes-video")&&(h=shaka.media.ManifestParser.AccessibilityPurpose.VISUALLY_IMPAIRED),p.length||l!==shaka.util.ManifestParserUtils.TextStreamKind.SUBTITLE||p.push(shaka.util.ManifestParserUtils.TextStreamKind.SUBTITLE),t={id:this.globalId_++,originalId:i,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:e,codecs:t,kind:r==shaka.util.ManifestParserUtils.ContentType.TEXT?shaka.util.ManifestParserUtils.TextStreamKind.SUBTITLE:void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:this.getLanguage_(n),originalLanguage:n,label:i,type:r,primary:a,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:p,forced:u,channelsCount:s,audioSamplingRate:c,spatialAudio:d,closedCaptions:o,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:h,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null},this.setFullTypeForStream_(t),t},shaka.hls.HlsParser.prototype.parseDrmInfo_=function(e,t,r,n){var a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M,D=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(O){switch(O.nextAddress){case 1:if(a=new Map,!D.config_.ignoreDrmInfo&&e.segments)for(i=$jscomp.makeIterator(e.segments),s=i.next();!s.done;s=i.next())if(o=s.value,l=shaka.hls.Utils.filterTagsByName(o.tags,"EXT-X-KEY"),u=null,l.length)for(u=D.getInitSegmentReference_(e,o.tags,r,n),c=$jscomp.makeIterator(l),d=c.next();!d.done;d=c.next())p=d.value,a.set(p,u);f=h=!1,m=[],g=new Set,y=$jscomp.makeIterator(a),v=y.next();case 2:if(v.done){O.jumpTo(4);break}if(_=v.value,k=$jscomp.makeIterator(_),E=k.next().value,b=k.next().value,A=b,"NONE"==(S=(T=E).getRequiredAttrValue("METHOD"))){O.jumpTo(3);break}if(h=!0,P=T.getAttributeValue("KEYFORMAT")||"identity",C=null,D.isAesMethod_(S)){f=!0,O.jumpTo(3);break}if("identity"==P)return O.yield(D.identityDrmParser_(T,t,r,A,n),11);if(!(x=D.keyFormatsToDrmParsers_.get(P))){I=null,O.jumpTo(9);break}return O.yield(x(T,t,A),10);case 10:I=O.yieldResult;case 9:C=I,O.jumpTo(6);break;case 11:C=O.yieldResult;case 6:if(C){if(C.keyIds)for(w=$jscomp.makeIterator(C.keyIds),R=w.next();!R.done;R=w.next())M=R.value,g.add(M);m.push(C)}else shaka.log.warning("Unsupported HLS KEYFORMAT",P);case 3:v=y.next(),O.jumpTo(2);break;case 4:return O.return({drmInfos:m,keyIds:g,encrypted:h,aesEncrypted:f})}}))},shaka.hls.HlsParser.prototype.parseAESDrmTag_=function(e,t,r,n){var a=this;if(!window.crypto||!window.crypto.subtle)throw shaka.log.alwaysWarn("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.NO_WEB_CRYPTO_API);var i=0,s=e.getAttributeValue("IV","");if(s){var o=shaka.util.Uint8ArrayUtils.fromHex(s.substr(2));if(16!=o.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.AES_128_INVALID_IV_LENGTH)}else i=shaka.hls.Utils.getFirstTagWithNameAsNumber(t.tags,"EXT-X-MEDIA-SEQUENCE",0);var l=shaka.hls.Utils.constructSegmentUris(r(),e.getRequiredAttrValue("URI"),n),u=l.sort().join("");if(t=e.toString()+"-"+i+"-"+u,!this.aesKeyInfoMap_.has(t)){var c={bitsKey:128,blockCipherMode:"CBC",iv:o,firstMediaSequenceNumber:i};switch(e.getRequiredAttrValue("METHOD")){case"AES-256":c.bitsKey=256;break;case"AES-256-CTR":c.bitsKey=256,c.blockCipherMode="CTR"}c.fetchKey=function(){var e,t,r,n,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){if(1==s.nextAddress)return a.aesKeyMap_.has(u)||(e=shaka.net.NetworkingEngine.RequestType.KEY,t=shaka.net.NetworkingEngine.makeRequest(l,a.config_.retryParameters),r=a.makeNetworkRequest_(t,e).promise,a.aesKeyMap_.set(u,r)),s.yield(a.aesKeyMap_.get(u),2);if(3!=s.nextAddress){if(!(n=s.yieldResult).data||n.data.byteLength!=c.bitsKey/8)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.AES_128_INVALID_KEY_LENGTH);return i={name:"CTR"==c.blockCipherMode?"AES-CTR":"AES-CBC",length:c.bitsKey},s.yield(window.crypto.subtle.importKey("raw",n.data,i,!0,["decrypt"]),3)}c.cryptoKey=s.yieldResult,c.fetchKey=void 0,s.jumpToEnd()}))},this.aesKeyInfoMap_.set(t,c)}return this.aesKeyInfoMap_.get(t)},shaka.hls.HlsParser.prototype.determineStartTime_=function(e){null==this.startTime_&&(e=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-START"))&&(this.startTime_=Number(e.getRequiredAttrValue("TIME-OFFSET")))},shaka.hls.HlsParser.prototype.determinePresentationType_=function(e){var t=shaka.hls.HlsParser.PresentationType_,r=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-PLAYLIST-TYPE");e=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-ENDLIST"),e=r&&"VOD"==r.value||e,r=r&&"EVENT"==r.value&&!e,r=!e&&!r,e?this.setPresentationType_(t.VOD):r?this.setPresentationType_(t.LIVE):this.setPresentationType_(t.EVENT)},shaka.hls.HlsParser.prototype.determineLastTargetDuration_=function(e){var t=1/0,r=e.segments;if(r.length)for(var n=r.length-1;0<=n;){var a=shaka.hls.Utils.getFirstTagWithName(r[n].tags,"EXTINF");if(a){t=a.value.split(","),t=Number(t[0]);break}n--}r=this.getRequiredTag_(e.tags,"EXT-X-TARGETDURATION"),r=Number(r.value),(n=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-PART-INF"))&&(this.partialTargetDuration_=Number(n.getRequiredAttrValue("PART-TARGET"))),e=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-SERVER-CONTROL"),this.lowLatencyMode_&&this.partialTargetDuration_?(this.lastTargetDuration_=this.lowLatencyByterangeOptimization_?5*this.partialTargetDuration_<=t?Math.min(this.partialTargetDuration_,this.lastTargetDuration_):Math.min(t,this.lastTargetDuration_):Math.min(this.partialTargetDuration_,this.lastTargetDuration_),this.lowLatencyPresentationDelay_=e?Number(e.getRequiredAttrValue("PART-HOLD-BACK")):0):(this.lastTargetDuration_=Math.min(t,this.lastTargetDuration_),this.presentationDelay_=(e=e?e.getAttribute("HOLD-BACK"):null)?Number(e.value):0),this.maxTargetDuration_=Math.max(r,this.maxTargetDuration_)},shaka.hls.HlsParser.prototype.changePresentationTimelineToLive_=function(e){var t=0;if(this.config_.defaultPresentationDelay)t=this.config_.defaultPresentationDelay;else if(this.lowLatencyPresentationDelay_)t=this.lowLatencyPresentationDelay_;else if(this.presentationDelay_)t=this.presentationDelay_;else{var r=e.segments.length,n=this.config_.hls.liveSegmentsDelay;for(n>r-2&&(n=Math.max(1,r-2)),n=r-n;n<r;n++){var a=shaka.hls.Utils.getFirstTagWithName(e.segments[n].tags,"EXTINF");a?(a=a.value.split(","),t+=Math.ceil(Number(a[0]))):t+=this.maxTargetDuration_}}this.startTime_&&0>this.startTime_&&(t=Math.min(-this.startTime_,t),this.startTime_+=t),this.presentationTimeline_.setPresentationStartTime(0),this.presentationTimeline_.setDelay(t),this.presentationTimeline_.setStatic(!1)},shaka.hls.HlsParser.prototype.getInitSegmentReference_=function(e,t,r,n){var a=shaka.hls.Utils.getFirstTagWithName(t,"EXT-X-MAP");if(!a)return null;var i=a.getRequiredAttrValue("URI"),s=shaka.hls.Utils.constructSegmentUris(r(),i,n);if(i=[s.toString(),a.getAttributeValue("BYTERANGE","")].join("-"),!this.mapTagToInitSegmentRefMap_.has(i)){for(var o=void 0,l=null,u=!1,c=(t=$jscomp.makeIterator(t)).next();!c.done;c=t.next())"EXT-X-KEY"==(c=c.value).name?(u=c.getRequiredAttrValue("METHOD"),this.isAesMethod_(u)&&c.id<a.id?(u=!1,o=this.parseAESDrmTag_(c,e,r,n)):u="NONE"!=u):"EXT-X-BYTERANGE"==c.name&&c.id<a.id&&(l=c);e=this.createInitSegmentReference_(s,a,l,o,u),this.mapTagToInitSegmentRefMap_.set(i,e)}return this.mapTagToInitSegmentRefMap_.get(i)},shaka.hls.HlsParser.prototype.createInitSegmentReference_=function(e,t,r,n,a){var i=0,s=null;return!(t=t.getAttributeValue("BYTERANGE"))&&r&&(t=r.value),t&&(i=t.split("@"),s=Number(i[0]),s=(i=Number(i[1]))+s-1,n&&((r=s+1-i)%16&&(s+=16-r%16))),new shaka.media.InitSegmentReference((function(){return e}),i,s,null,null,null,n,a)},shaka.hls.HlsParser.prototype.createSegmentReference_=function(e,t,r,n,a,i,s,o,l){var u=shaka.hls.HlsParser;i=function(e){e=new goog.Uri(e).getPath().split(".").pop();var t=u.EXTENSION_MAP_BY_CONTENT_TYPE_.get(s).get(e);return t||(t=u.RAW_FORMATS_TO_MIME_TYPES_.get(e)),t};var c=r.tags,d=shaka.hls.Utils.getFirstTagWithName(c,"EXTINF"),p=0,h=0,f=null;r.partialSegments.length&&(this.manifest_.isLowLatency=!0);var m=null;if(!this.config_.hls.ignoreManifestProgramDateTime){var g=shaka.hls.Utils.getFirstTagWithName(c,"EXT-X-PROGRAM-DATE-TIME");g&&g.value&&(m=shaka.util.TXml.parseDate(g.value),goog.asserts.assert(null!=m,"EXT-X-PROGRAM-DATE-TIME format not valid"),this.usesProgramDateTime_=!0)}var y=shaka.media.SegmentReference.Status.AVAILABLE;if(shaka.hls.Utils.getFirstTagWithName(c,"EXT-X-GAP")&&(this.manifest_.gapCount++,y=shaka.media.SegmentReference.Status.MISSING),!d){if(0==r.partialSegments.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_REQUIRED_TAG_MISSING,"EXTINF");if(!this.lowLatencyMode_)return null}var v=[];g=!1;var _=null,k=!1,E=!1;if(this.lowLatencyMode_&&r.partialSegments.length){p=e&&window.ReadableStream&&this.config_.hls.allowLowLatencyByteRangeOptimization;for(var b=m,T={},A=0;A<r.partialSegments.length;T={uris$jscomp$24:void 0,pUri:void 0},A++){var S=r.partialSegments[A],P=0==A?t:v[v.length-1],C=0==A?n:P.endTime,x=Number(S.getAttributeValue("DURATION"))||this.partialTargetDuration_;if(x){var I=C+x,w=0,R=null;if("EXT-X-PRELOAD-HINT"==S.name?(w=(w=S.getAttributeValue("BYTERANGE-START"))?Number(w):0,(P=S.getAttributeValue("BYTERANGE-LENGTH"))?R=w+Number(P)-1:w&&(R=Number.MAX_SAFE_INTEGER)):(w=S.getAttributeValue("BYTERANGE"),w=(R=$jscomp.makeIterator(this.parseByteRange_(P,w))).next().value,R=R.next().value),T.pUri=S.getAttributeValue("URI"),T.pUri){P=shaka.media.SegmentReference.Status.AVAILABLE,"YES"==S.getAttributeValue("GAP")&&(this.manifest_.gapCount++,P=shaka.media.SegmentReference.Status.MISSING,k=!0),T.uris$jscomp$24=null;var M=function(e){return function(){return null==e.uris$jscomp$24&&(goog.asserts.assert(e.pUri,"Partial uri should be defined!"),e.uris$jscomp$24=shaka.hls.Utils.constructSegmentUris(o(),e.pUri,a)),e.uris$jscomp$24}}(T);p&&0<=w&&null!=R&&(_=M,g=!0),C=new shaka.media.SegmentReference(C,I,M,w,R,e,0,0,1/0,[],"",null,b,P,l),"EXT-X-PRELOAD-HINT"==S.name&&(C.markAsPreload(),E=!0),"YES"!=S.getAttributeValue("INDEPENDENT")&&0<A&&C.markAsNonIndependent(),(T=i(T.pUri))&&(C.mimeType=T,u.MIME_TYPES_WITHOUT_INIT_SEGMENT_.has(T)&&(C.initSegmentReference=null)),v.push(C),b&&(b+=x)}}}}if(d){if(d=d.value.split(","),0==(d=Number(d[0])))return null;p=n+d}else{if(!v.length)return null;p=v[v.length-1].endTime}g&&(k||0!=v[0].startByte?(g=!1,_=null):v=[]),(k=shaka.hls.Utils.getFirstTagWithName(c,"EXT-X-BYTERANGE"))?(h=(f=$jscomp.makeIterator(this.parseByteRange_(t,k.value))).next().value,f=f.next().value):v.length&&(h=v[0].startByte,f=v[v.length-1].endByte),t="",k=null,s==shaka.util.ManifestParserUtils.ContentType.IMAGE&&(t="1x1",c=shaka.hls.Utils.getFirstTagWithName(c,"EXT-X-TILES"))&&(t=c.getRequiredAttrValue("LAYOUT"),(c=c.getAttributeValue("DURATION"))&&(k=Number(c)));var D=null;return e=new shaka.media.SegmentReference(n,p,(function(){return _?_():(null==D&&(D=shaka.hls.Utils.constructSegmentUris(o(),r.verbatimSegmentUri,a)),D||[])}),h,f,e,0,0,1/0,v,t,k,m,y,l,0<v.length&&!!r.verbatimSegmentUri),(n=i(r.verbatimSegmentUri))&&(e.mimeType=n,u.MIME_TYPES_WITHOUT_INIT_SEGMENT_.has(n)&&(e.initSegmentReference=null)),g&&(this.lowLatencyByterangeOptimization_=!0,e.markAsByterangeOptimization(),E&&e.markAsPreload()),e},shaka.hls.HlsParser.prototype.parseByteRange_=function(e,t){var r=0,n=null;return t&&(r=t.split("@"),t=Number(r[0]),r[1]?r=Number(r[1]):(goog.asserts.assert(e,"Cannot refer back to previous HLS segment!"),r=e.endByte+1),n=r+t-1),[r,n]},shaka.hls.HlsParser.prototype.processDateRangeTags_=function(e,t,r,n){var a=shaka.util.ManifestParserUtils.ContentType;if(t==a.VIDEO||t==a.AUDIO){a=shaka.hls.Utils;var i=this.presentationTimeline_.getInitialProgramDateTime();if(i&&!this.ignoreManifestProgramDateTimeFor_(t))for(e=(e=shaka.hls.Utils.filterTagsByName(e,"EXT-X-DATERANGE")).filter((function(e){return null!=e.getAttribute("START-DATE")})).sort((function(e,t){return(e=e.getRequiredAttrValue("START-DATE"))<(t=t.getRequiredAttrValue("START-DATE"))?-1:e>t?1:0})),t=0;t<e.length;t++){var s=e[t];try{var o=s.getRequiredAttrValue("ID");if(!this.dateRangeIdsEmitted_.has(o)){var l=s.getRequiredAttrValue("START-DATE"),u=shaka.util.TXml.parseDate(l);if(!isNaN(u)){goog.asserts.assert(null!=u,"Start date should not be null!");var c=Math.max(0,u-i),d=null,p=s.getAttributeValue("END-DATE");if(p){var h=shaka.util.TXml.parseDate(p);if(!isNaN(h)&&(goog.asserts.assert(null!=h,"End date should not be null!"),0>(d=h-i)))continue}if(null==d){var f=s.getAttributeValue("DURATION")||s.getAttributeValue("PLANNED-DURATION");if(f){var m=parseFloat(f);if(isNaN(m)||(d=c+m),0>u-i+m)continue}}var g=s.getAttributeValue("CLASS")||"com.apple.quicktime.HLS",y="YES"==s.getAttributeValue("END-ON-NEXT");if(null==d&&y){for(var v=t+1;v<e.length;v++){if(g==(e[v].getAttributeValue("CLASS")||"com.apple.quicktime.HLS")){var _=e[v].getRequiredAttrValue("START-DATE"),k=shaka.util.TXml.parseDate(_);if(!isNaN(k)&&k&&k>u){d=Math.max(0,k-i);break}}}if(null==d)continue}v=["CLASS","START-DATE","END-DATE","DURATION","END-ON-NEXT"];for(var E=[],b=$jscomp.makeIterator(s.attributes),T=b.next();!T.done;T=b.next()){var A=T.value;if(!v.includes(A.name)){var S=a.variableSubstitution(A.value,r);"X-ASSET-URI"!=A.name&&"X-ASSET-LIST"!=A.name||(S=a.constructSegmentUris(n(),A.value,r)[0]),E.push({key:A.name,description:"",data:S,mimeType:null,pictureType:null})}}1<E.length&&this.playerInterface_.onMetadata(g,c,d,E),this.dateRangeIdsEmitted_.add(o)}}}catch(e){shaka.log.warning("Ignoring DATERANGE with errors",s.toString())}}}},shaka.hls.HlsParser.prototype.createSegments_=function(e,t,r,n,a){var i=e.segments;goog.asserts.assert(i.length,"Playlist should have segments!");var s=void 0,o=shaka.hls.Utils.getFirstTagWithNameAsNumber(e.tags,"EXT-X-DISCONTINUITY-SEQUENCE",-1),l=shaka.hls.Utils.getFirstTagWithNameAsNumber(e.tags,"EXT-X-MEDIA-SEQUENCE",0),u=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-SKIP"),c=u?Number(u.getAttributeValue("SKIPPED-SEGMENTS")):0,d=l+c,p=0;this.isLive_()&&t.has(d)&&(p=t.get(d)),0===p&&this.presentationType_==shaka.hls.HlsParser.PresentationType_.LIVE&&0<t.size&&!t.has(d)&&null!=this.presentationTimeline_.getPresentationStartTime()&&(p=this.presentationTimeline_.getSegmentAvailabilityStart());var h=[],f=null;u=[];for(var m=0;m<i.length;m++){var g=i[m],y=0==m?p:f.endTime;d=l+c+m,shaka.hls.Utils.getFirstTagWithName(g.tags,"EXT-X-DISCONTINUITY")&&(o++,f&&f.initSegmentReference&&(f.initSegmentReference.boundaryEnd=y));for(var v=$jscomp.makeIterator(g.tags),_=v.next();!_.done;_=v.next())"EXT-X-KEY"==(_=_.value).name&&(s=this.isAesMethod_(_.getRequiredAttrValue("METHOD"))?this.parseAESDrmTag_(_,e,n,r):void 0);t.set(d,y),v=this.getInitSegmentReference_(e,g.tags,n,r),(y=this.createSegmentReference_(v,f,g,y,r,e,a,n,s))&&((f=shaka.hls.Utils.getFirstTagWithNameAsNumber(g.tags,"EXT-X-BITRATE"))?u.push({bitrate:f,duration:y.endTime-y.startTime}):u.length&&((f=u.pop()).duration+=y.endTime-y.startTime,u.push(f)),f=y,y.discontinuitySequence=o,this.ignoreManifestProgramDateTimeFor_(a)&&null!=this.minSequenceNumber_&&d<this.minSequenceNumber_||h.push(y))}if(e=void 0,u.length&&(e=u.reduce((function(e,t){return e+t.duration}),0),e=Math.round(u.reduce((function(e,t){return e+t.bitrate*t.duration}),0)/e*1e3)),u=h.some((function(e){return null!=e.syncTime})))for(t={},r=0;r<h.length;t={forwardI:void 0,forwardAdd:void 0,backwardI:void 0,reference$jscomp$49:void 0,backwardAdd:void 0},r++)if(t.reference$jscomp$49=h[r],null==t.reference$jscomp$49.syncTime)for(t.forwardAdd=0,t.forwardI=r,n=function(e){return function(){var t=h[e.forwardI];if(t){if(null!=t.syncTime)return t.syncTime+e.forwardAdd;e.forwardAdd-=t.endTime-t.startTime,e.forwardI+=1}return null}}(t),t.backwardAdd=0,t.backwardI=r,i=function(e){return function(){var t=h[e.backwardI];if(t){if(t!=e.reference$jscomp$49&&(e.backwardAdd+=t.endTime-t.startTime),null!=t.syncTime)return t.syncTime+e.backwardAdd;--e.backwardI}return null}}(t);null==t.reference$jscomp$49.syncTime;)t.reference$jscomp$49.syncTime=i(),null==t.reference$jscomp$49.syncTime&&(t.reference$jscomp$49.syncTime=n());if(u)for(r=(t=$jscomp.makeIterator(h)).next();!r.done;r=t.next())for(r=(n=r.value).syncTime,i=(n=$jscomp.makeIterator(n.partialReferences)).next();!i.done;i=n.next())(i=i.value).syncTime=r,r+=i.endTime-i.startTime;if(t=this.lowestSyncTime_,u&&1/0!=t&&!this.ignoreManifestProgramDateTimeFor_(a))for(u=(a=$jscomp.makeIterator(h)).next();!u.done;u=a.next())u.value.syncAgainst(t);return{segments:h,bandwidth:e}},shaka.hls.HlsParser.prototype.guessMimeTypeBeforeLoading_=function(e,t){if(e==shaka.util.ManifestParserUtils.ContentType.TEXT){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return e!=shaka.util.ManifestParserUtils.ContentType.IMAGE||t&&"jpeg"!=t?e==shaka.util.ManifestParserUtils.ContentType.AUDIO&&"mp4a.40.34"==t?"audio/mpeg":"mjpg"==t?"application/mp4":null:"image/jpeg"},shaka.hls.HlsParser.prototype.guessMimeTypeFallback_=function(e){return e==shaka.util.ManifestParserUtils.ContentType.TEXT?"text/vtt":shaka.hls.HlsParser.EXTENSION_MAP_BY_CONTENT_TYPE_.get(e).get("mp4")},shaka.hls.HlsParser.prototype.getAvailableSegment_=function(e){goog.asserts.assert(e.length,"Should have segments!");for(var t=this.isLive_()?Math.trunc((e.length-1)/2):0,r=e[t];r.getStatus()==shaka.media.SegmentReference.Status.MISSING&&t+1<e.length;)r=e[++t];return{segment:r,segmentIndex:t}},shaka.hls.HlsParser.prototype.guessMimeType_=function(e,t,r){var n,a,i,s,o,l,u,c,d,p,h,f,m,g,y=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){switch(v.nextAddress){case 1:return n=shaka.hls.HlsParser,a=shaka.net.NetworkingEngine.RequestType.SEGMENT,i=y.getAvailableSegment_(r),(s=i.segment).status==shaka.media.SegmentReference.Status.MISSING?v.return(y.guessMimeTypeFallback_(e)):(o=s.getUris(),l=new goog.Uri(o[0]),u=l.getPath().split(".").pop(),c=n.EXTENSION_MAP_BY_CONTENT_TYPE_.get(e),(d=c.get(u))||(d=n.RAW_FORMATS_TO_MIME_TYPES_.get(u))||(d=y.guessMimeTypeBeforeLoading_(e,t))?v.return(d):(h=shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_SEGMENT,f=shaka.net.NetworkingEngine.makeRequest(o,y.config_.retryParameters),v.setCatchFinallyBlocks(2),f.method="HEAD",v.yield(y.makeNetworkRequest_(f,a,{type:h}).promise,4)));case 4:m=v.yieldResult,p=m.headers["content-type"],v.leaveTryBlock(3);break;case 2:if(!(g=v.enterCatchBlock())||g.code!=shaka.util.Error.Code.HTTP_ERROR&&g.code!=shaka.util.Error.Code.BAD_HTTP_STATUS){v.jumpTo(3);break}return f.method="GET",y.config_.hls.allowRangeRequestsToGuessMimeType&&(f.headers.Range="bytes=0-0"),v.yield(y.makeNetworkRequest_(f,a,{type:h}).promise,6);case 6:m=v.yieldResult,p=m.headers["content-type"];case 3:if(!p){v.jumpTo(7);break}if("application/octet-stream"!=(d=p.toLowerCase().split(";")[0])){v.jumpTo(8);break}if(m.data.byteLength){v.jumpTo(9);break}return f.method="GET",v.yield(y.makeNetworkRequest_(f,a,{type:h}).promise,10);case 10:m=v.yieldResult;case 9:shaka.util.TsParser.probe(shaka.util.BufferUtils.toUint8(m.data))&&(d="video/mp2t");case 8:if("application/octet-stream"!=d)return v.return(d);case 7:return v.return(y.guessMimeTypeFallback_(e))}}))},shaka.hls.HlsParser.prototype.getRequiredTag_=function(e,t){if(!(e=shaka.hls.Utils.getFirstTagWithName(e,t)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_REQUIRED_TAG_MISSING,t);return e},shaka.hls.HlsParser.prototype.addVideoAttributes_=function(e,t,r,n,a,i,s){e&&(e.width=Number(t)||void 0,e.height=Number(r)||void 0,e.frameRate=Number(n)||void 0,e.hdr=a||void 0,e.videoLayout=i||void 0,e.colorGamut=s||void 0)},shaka.hls.HlsParser.prototype.requestManifest_=function(e,t){var r=shaka.net.NetworkingEngine.RequestType.MANIFEST;return e=shaka.net.NetworkingEngine.makeRequest(e,this.config_.retryParameters),this.makeNetworkRequest_(e,r,{type:t?shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_PLAYLIST:shaka.net.NetworkingEngine.AdvancedRequestType.MASTER_PLAYLIST})},shaka.hls.HlsParser.prototype.onUpdate_=function(){var e,t,r,n,a,i,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:return shaka.log.info("Updating manifest..."),goog.asserts.assert(0<s.getUpdatePlaylistDelay_(),"We should only call |onUpdate_| when we are suppose to be updating."),s.playerInterface_?(o.setCatchFinallyBlocks(2),e=Date.now(),o.yield(s.update(),4)):o.return();case 4:t=Date.now(),s.isLive_()&&(r=(t-e)/1e3,s.averageUpdateDuration_.sample(1,r),n=0<s.config_.updatePeriod?s.config_.updatePeriod:s.getUpdatePlaylistDelay_(),a=Math.max(0,n-s.averageUpdateDuration_.getEstimate()),s.updatePlaylistTimer_.tickAfter(a)),o.leaveTryBlock(3);break;case 2:if(i=o.enterCatchBlock(),!s.playerInterface_)return o.return();if(goog.asserts.assert(i instanceof shaka.util.Error,"Should only receive a Shaka error"),s.config_.raiseFatalErrorOnManifestUpdateRequestFailure)return s.playerInterface_.onError(i),o.return();i.severity=shaka.util.Error.Severity.RECOVERABLE,s.playerInterface_.onError(i),s.updatePlaylistTimer_.tickAfter(.1);case 3:if(!s.playerInterface_)return o.return();s.playerInterface_.onManifestUpdated(),o.jumpToEnd()}}))},shaka.hls.HlsParser.prototype.isLive_=function(){return this.presentationType_!=shaka.hls.HlsParser.PresentationType_.VOD},shaka.hls.HlsParser.prototype.getUpdatePlaylistDelay_=function(){return this.lastTargetDuration_},shaka.hls.HlsParser.prototype.setPresentationType_=function(e){this.presentationType_=e,this.presentationTimeline_&&this.presentationTimeline_.setStatic(!this.isLive_()),this.isLive_()||this.updatePlaylistTimer_.stop()},shaka.hls.HlsParser.prototype.makeNetworkRequest_=function(e,t,r){if(!this.operationManager_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);return r||(r={}),r.isPreload=this.isPreloadFn_(),e=this.playerInterface_.networkingEngine.request(t,e,r),this.operationManager_.manage(e),e},shaka.hls.HlsParser.prototype.isAesMethod_=function(e){return"AES-128"==e||"AES-256"==e||"AES-256-CTR"==e},shaka.hls.HlsParser.prototype.fairplayDrmParser_=function(e,t,r){var n,a,i,s,o,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){if("video/mp2t"==t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED);if(shaka.drm.DrmUtils.isMediaKeysPolyfilled("apple"))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED);return n=e.getRequiredAttrValue("METHOD"),(a=["SAMPLE-AES","SAMPLE-AES-CTR"]).includes(n)?(i="cenc","SAMPLE-AES"==n&&(i="cbcs"),s=e.getRequiredAttrValue("URI"),o=shaka.util.ManifestParserUtils.createDrmInfo("com.apple.fps",i,[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}],s),(l=shaka.drm.FairPlay.defaultGetKeyId(s))||!r?c.jumpTo(2):c.yield(u.getKeyIdFromInitSegment_(r),3)):(shaka.log.error("FairPlay in HLS is only supported with [",a.join(", "),"], not",n),c.return(null))}return 2!=c.nextAddress&&(l=c.yieldResult),l&&o.keyIds.add(l),c.return(o)}))},shaka.hls.HlsParser.prototype.widevineDrmParser_=function(e,t,r){return r=e.getRequiredAttrValue("METHOD"),(t=["SAMPLE-AES","SAMPLE-AES-CTR"]).includes(r)?(t="cenc","SAMPLE-AES"==r&&(t="cbcs"),r=e.getRequiredAttrValue("URI"),r=shaka.net.DataUriPlugin.parseRaw(r.split("?")[0]),r=shaka.util.BufferUtils.toUint8(r.data),t=shaka.util.ManifestParserUtils.createDrmInfo("com.widevine.alpha",t,[{initDataType:"cenc",initData:r}]),(e=e.getAttributeValue("KEYID"))&&(e=e.toLowerCase(),goog.asserts.assert(e.startsWith("0x"),"Incorrect KEYID format!"),t.keyIds.add(e.substr(2))),Promise.resolve(t)):(shaka.log.error("Widevine in HLS is only supported with [",t.join(", "),"], not",r),Promise.resolve(null))},shaka.hls.HlsParser.prototype.playreadyDrmParser_=function(e,t,r){if(r=e.getRequiredAttrValue("METHOD"),!(t=["SAMPLE-AES","SAMPLE-AES-CTR"]).includes(r))return shaka.log.error("PlayReady in HLS is only supported with [",t.join(", "),"], not",r),Promise.resolve(null);t="cenc","SAMPLE-AES"==r&&(t="cbcs"),e=e.getRequiredAttrValue("URI"),e=shaka.net.DataUriPlugin.parseRaw(e.split("?")[0]),e=shaka.util.BufferUtils.toUint8(e.data),r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);var n=new Set;return r=shaka.util.Pssh.createPssh(e,r,n,0),t=shaka.util.ManifestParserUtils.createDrmInfo("com.microsoft.playready",t,[{initDataType:"cenc",initData:r}]),(e=shaka.util.TXml.parseXmlString(["<PLAYREADY>",shaka.util.Uint8ArrayUtils.toBase64(e),"</PLAYREADY>"].join("\n")))&&(t.licenseServerUri=shaka.drm.PlayReady.getLicenseUrl(e)),Promise.resolve(t)},shaka.hls.HlsParser.prototype.wiseplayDrmParser_=function(e,t,r){return r=e.getRequiredAttrValue("METHOD"),(t=["SAMPLE-AES","SAMPLE-AES-CTR"]).includes(r)?(t="cenc","SAMPLE-AES"==r&&(t="cbcs"),r=e.getRequiredAttrValue("URI"),r=shaka.net.DataUriPlugin.parseRaw(r.split("?")[0]),r=shaka.util.BufferUtils.toUint8(r.data),t=shaka.util.ManifestParserUtils.createDrmInfo("com.huawei.wiseplay",t,[{initDataType:"cenc",initData:r}]),(e=e.getAttributeValue("KEYID"))&&(e=e.toLowerCase(),goog.asserts.assert(e.startsWith("0x"),"Incorrect KEYID format!"),t.keyIds.add(e.substr(2))),Promise.resolve(t)):(shaka.log.error("WisePlay in HLS is only supported with [",t.join(", "),"], not",r),Promise.resolve(null))},shaka.hls.HlsParser.prototype.identityDrmParser_=function(e,t,r,n,a){var i,s,o,l,u,c,d,p,h,f,m,g,y,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:if("video/mp2t"==t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED);if(shaka.drm.DrmUtils.isMediaKeysPolyfilled("apple"))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED);if(i=e.getRequiredAttrValue("METHOD"),!(s=["SAMPLE-AES","SAMPLE-AES-CTR"]).includes(i))return shaka.log.error("Identity (ClearKey) in HLS is only supported with [",s.join(", "),"], not",i),_.return(null);if((o=shaka.hls.Utils.constructSegmentUris(r(),e.getRequiredAttrValue("URI"),a))[0].startsWith("data:text/plain;base64,")){l=shaka.util.Uint8ArrayUtils.toHex(shaka.util.Uint8ArrayUtils.fromBase64(o[0].split("data:text/plain;base64,").pop())),_.jumpTo(2);break}return u=o.sort().join(""),v.identityKeyMap_.has(u)||(c=shaka.net.NetworkingEngine.RequestType.KEY,d=shaka.net.NetworkingEngine.makeRequest(o,v.config_.retryParameters),p=v.makeNetworkRequest_(d,c).promise,v.identityKeyMap_.set(u,p)),_.yield(v.identityKeyMap_.get(u),3);case 3:h=_.yieldResult,l=shaka.util.Uint8ArrayUtils.toHex(h.data);case 2:if(f="00000000000000000000000000000000",!n){_.jumpTo(4);break}return _.yield(v.getKeyIdFromInitSegment_(n),5);case 5:(m=_.yieldResult)&&(f=m);case 4:return(g=new Map).set(f,l),y="cenc","SAMPLE-AES"==i&&(y="cbcs"),_.return(shaka.util.ManifestParserUtils.createDrmInfoFromClearKeys(g,y))}}))},shaka.hls.HlsParser.prototype.getKeyIdFromInitSegment_=function(e){var t,r,n,a,i,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(t=null,s.initSegmentToKidMap_.has(e)?(t=s.initSegmentToKidMap_.get(e),o.jumpTo(2)):(r=shaka.util.Networking.createSegmentRequest(e.getUris(),e.getStartByte(),e.getEndByte(),s.config_.retryParameters),n=shaka.net.NetworkingEngine.RequestType.SEGMENT,a=shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT,o.yield(s.makeNetworkRequest_(r,n,{type:a}).promise,3))):(2!=o.nextAddress&&(i=o.yieldResult,e.setSegmentData(i.data),t=shaka.media.SegmentUtils.getDefaultKID(i.data),s.initSegmentToKidMap_.set(e,t)),o.return(t))}))},goog.exportSymbol("shaka.hls.HlsParser",shaka.hls.HlsParser),shaka.hls.HlsParser.RAW_FORMATS_TO_MIME_TYPES_=(new Map).set("aac","audio/aac").set("ac3","audio/ac3").set("ec3","audio/ec3").set("mp3","audio/mpeg"),shaka.hls.HlsParser.AUDIO_EXTENSIONS_TO_MIME_TYPES_=(new Map).set("mp4","audio/mp4").set("mp4a","audio/mp4").set("m4s","audio/mp4").set("m4i","audio/mp4").set("m4a","audio/mp4").set("m4f","audio/mp4").set("cmfa","audio/mp4").set("ts","video/mp2t").set("tsa","video/mp2t"),shaka.hls.HlsParser.VIDEO_EXTENSIONS_TO_MIME_TYPES_=(new Map).set("mp4","video/mp4").set("mp4v","video/mp4").set("m4s","video/mp4").set("m4i","video/mp4").set("m4v","video/mp4").set("m4f","video/mp4").set("cmfv","video/mp4").set("ts","video/mp2t").set("tsv","video/mp2t"),shaka.hls.HlsParser.TEXT_EXTENSIONS_TO_MIME_TYPES_=(new Map).set("mp4","application/mp4").set("m4s","application/mp4").set("m4i","application/mp4").set("m4f","application/mp4").set("cmft","application/mp4").set("vtt","text/vtt").set("webvtt","text/vtt").set("ttml","application/ttml+xml"),shaka.hls.HlsParser.IMAGE_EXTENSIONS_TO_MIME_TYPES_=(new Map).set("jpg","image/jpeg").set("png","image/png").set("svg","image/svg+xml").set("webp","image/webp").set("avif","image/avif"),shaka.hls.HlsParser.EXTENSION_MAP_BY_CONTENT_TYPE_=(new Map).set("audio",shaka.hls.HlsParser.AUDIO_EXTENSIONS_TO_MIME_TYPES_).set("video",shaka.hls.HlsParser.VIDEO_EXTENSIONS_TO_MIME_TYPES_).set("text",shaka.hls.HlsParser.TEXT_EXTENSIONS_TO_MIME_TYPES_).set("image",shaka.hls.HlsParser.IMAGE_EXTENSIONS_TO_MIME_TYPES_),shaka.hls.HlsParser.MIME_TYPES_WITHOUT_INIT_SEGMENT_=new Set(["video/mp2t"].concat($jscomp.arrayFromIterable(shaka.util.MimeUtils.RAW_FORMATS))),shaka.hls.HlsParser.PresentationType_={VOD:"VOD",EVENT:"EVENT",LIVE:"LIVE"},shaka.hls.HlsParser.FAKE_MUXED_URL_="shaka://hls-muxed",shaka.media.ManifestParser.registerParserByMime("application/x-mpegurl",(function(){return new shaka.hls.HlsParser})),shaka.media.ManifestParser.registerParserByMime("application/vnd.apple.mpegurl",(function(){return new shaka.hls.HlsParser})),shaka.mss={},shaka.mss.ContentProtection=function(){},shaka.mss.ContentProtection.parseFromProtection=function(e,t){for(var r=shaka.mss.ContentProtection,n=shaka.util.TXml,a=[],i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next())a=a.concat(n.findChildren(i.value,"ProtectionHeader"));return a.length?r.convertElements_(a,t):[]},shaka.mss.ContentProtection.getPlayReadyLicenseUrl=function(e){return shaka.drm.PlayReady.getLicenseUrl(e)},shaka.mss.ContentProtection.getPlayReadyKID_=function(e){return shaka.drm.PlayReady.getPlayReadyKID(e)},shaka.mss.ContentProtection.getInitDataFromPro_=function(e,t,r){var n=shaka.util.Uint8ArrayUtils;return e=n.fromBase64(shaka.util.TXml.getTextContents(e)),t=n.fromHex(t.replace(/-/g,"")),n=new Set,[{initData:shaka.util.Pssh.createPssh(e,t,n,0),initDataType:"cenc",keyId:r}]},shaka.mss.ContentProtection.convertElements_=function(e,t){for(var r=shaka.mss.ContentProtection,n=shaka.util.ManifestParserUtils,a=r.licenseUrlParsers_,i=[],s=0;s<e.length;s++){var o=e[s],l=o.attributes.SystemID.toLowerCase(),u=t[l];if(u){var c=r.getPlayReadyKID_(o);l=r.getInitDataFromPro_(o,l,c),l=n.createDrmInfo(u,"cenc",l),c&&l.keyIds.add(c),(u=a.get(u))&&(l.licenseServerUri=u(o)),i.push(l)}}return i},shaka.mss.ContentProtection.licenseUrlParsers_=(new Map).set("com.microsoft.playready",shaka.mss.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.recommendation",shaka.mss.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.software",shaka.mss.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.hardware",shaka.mss.ContentProtection.getPlayReadyLicenseUrl),shaka.mss.MssParser=function(){var e=this;this.playerInterface_=this.config_=null,this.manifestUris_=[],this.manifest_=null,this.globalId_=1,this.updatePeriod_=0,this.presentationTimeline_=null,this.averageUpdateDuration_=new shaka.abr.Ewma(5),this.updateTimer_=new shaka.util.Timer((function(){e.onUpdate_()})),this.operationManager_=new shaka.util.OperationManager,this.initSegmentDataByStreamId_=new Map,this.isPreloadFn_=function(){return!1}},shaka.mss.MssParser.prototype.configure=function(e,t){goog.asserts.assert(null!=e.mss,"MssManifestConfiguration should not be null!"),this.config_=e,t&&(this.isPreloadFn_=t)},shaka.mss.MssParser.prototype.start=function(e,t){var r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return goog.asserts.assert(r.config_,"Must call configure() before start()!"),r.manifestUris_=[e],r.playerInterface_=t,n.yield(r.requestManifest_(),2);if(!r.playerInterface_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);return r.setUpdateTimer_(),goog.asserts.assert(r.manifest_,"Manifest should be non-null!"),n.return(r.manifest_)}))},shaka.mss.MssParser.prototype.onUpdate_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:return goog.asserts.assert(0<=t.updatePeriod_,"There should be an update period"),shaka.log.info("Updating manifest..."),r.setCatchFinallyBlocks(2),r.yield(t.requestManifest_(),4);case 4:r.leaveTryBlock(3);break;case 2:e=r.enterCatchBlock(),goog.asserts.assert(e instanceof shaka.util.Error,"Should only receive a Shaka error"),t.playerInterface_&&(e.severity=shaka.util.Error.Severity.RECOVERABLE,t.playerInterface_.onError(e));case 3:if(!t.playerInterface_)return r.return();t.setUpdateTimer_(),r.jumpToEnd()}}))},shaka.mss.MssParser.prototype.setUpdateTimer_=function(){if(!(0>=this.updatePeriod_)){var e=Math.max(shaka.mss.MssParser.MIN_UPDATE_PERIOD_,this.updatePeriod_,this.averageUpdateDuration_.getEstimate());this.updateTimer_.tickAfter(e)}},shaka.mss.MssParser.prototype.stop=function(){return this.config_=this.playerInterface_=null,this.manifestUris_=[],this.manifest_=null,null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null),this.initSegmentDataByStreamId_.clear(),this.operationManager_.destroy()},shaka.mss.MssParser.prototype.update=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(r.setCatchFinallyBlocks(2),r.yield(t.requestManifest_(),4)):2!=r.nextAddress?r.leaveTryBlock(0):(e=r.enterCatchBlock(),t.playerInterface_&&e?(goog.asserts.assert(e instanceof shaka.util.Error,"Bad error type"),t.playerInterface_.onError(e),void r.jumpToEnd()):r.return())}))},shaka.mss.MssParser.prototype.onExpirationUpdated=function(e,t){},shaka.mss.MssParser.prototype.onInitialVariantChosen=function(e){},shaka.mss.MssParser.prototype.banLocation=function(e){},shaka.mss.MssParser.prototype.setMediaElement=function(e){},shaka.mss.MssParser.prototype.requestManifest_=function(){var e,t,r,n,a,i,s,o,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){return 1==c.nextAddress?(e=shaka.net.NetworkingEngine.RequestType.MANIFEST,t=shaka.net.NetworkingEngine.AdvancedRequestType.MSS,r=shaka.net.NetworkingEngine.makeRequest(u.manifestUris_,u.config_.retryParameters),n=u.playerInterface_.networkingEngine,a=Date.now(),i=n.request(e,r,{type:t,isPreload:u.isPreloadFn_()}),u.operationManager_.manage(i),c.yield(i.promise,2)):(s=c.yieldResult,u.playerInterface_?(s.uri&&!u.manifestUris_.includes(s.uri)&&u.manifestUris_.unshift(s.uri),u.parseManifest_(s.data,s.uri),o=Date.now(),l=(o-a)/1e3,u.averageUpdateDuration_.sample(1,l),void c.jumpToEnd()):c.return())}))},shaka.mss.MssParser.prototype.parseManifest_=function(e,t){var r=e;if((e=this.config_.mss.manifestPreprocessor)!=shaka.util.PlayerConfiguration.defaultManifestPreprocessor){if(shaka.Deprecate.deprecateFeature(5,"manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),!(r=shaka.util.XmlUtils.parseXml(r,"SmoothStreamingMedia")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.MSS_INVALID_XML,t);e(r),r=shaka.util.XmlUtils.toArrayBuffer(r)}if(!(e=shaka.util.TXml.parseXml(r,"SmoothStreamingMedia")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.MSS_INVALID_XML,t);return(r=this.config_.mss.manifestPreprocessorTXml)!=shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml&&r(e),this.processManifest_(e,t),Promise.resolve()},shaka.mss.MssParser.prototype.processManifest_=function(e,t){var r=shaka.util.TXml;if(this.presentationTimeline_||(this.presentationTimeline_=new shaka.media.PresentationTimeline(null,0)),t=r.parseAttr(e,"IsLive",r.parseBoolean,!1))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.MSS_LIVE_CONTENT_NOT_SUPPORTED);this.presentationTimeline_.setStatic(!t);var n=r.parseAttr(e,"TimeScale",r.parseNonNegativeInt,shaka.mss.MssParser.DEFAULT_TIME_SCALE_);goog.asserts.assert(n&&0<=n,"Timescale must be defined!");var a=r.parseAttr(e,"DVRWindowLength",r.parseNonNegativeInt);t&&(0===a||isNaN(a))&&(a=1/0);var i=r.parseAttr(e,"CanSeek",r.parseBoolean,!1);0===a&&i&&(a=1/0),i=null,a&&0<a&&(i=a/n),t&&!isNaN(this.config_.availabilityWindowOverride)&&(i=this.config_.availabilityWindowOverride),null==i&&(i=1/0),this.presentationTimeline_.setSegmentAvailabilityDuration(i),r=r.parseAttr(e,"Duration",r.parseNonNegativeInt,1/0),goog.asserts.assert(r&&0<=r,"Duration must be defined!"),t||this.presentationTimeline_.setDuration(r/n),t={variants:[],textStreams:[],timescale:n,duration:r/n},this.parseStreamIndexes_(e,t),this.manifest_?(this.manifest_.variants=t.variants,this.manifest_.textStreams=t.textStreams,this.playerInterface_.filter(this.manifest_)):(this.manifest_={presentationTimeline:this.presentationTimeline_,variants:t.variants,textStreams:t.textStreams,imageStreams:[],offlineSessionIds:[],sequenceMode:this.config_.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:shaka.media.ManifestParser.MSS,serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null},this.presentationTimeline_.lockStartTime())},shaka.mss.MssParser.prototype.parseStreamIndexes_=function(e,t){var r=shaka.mss.ContentProtection,n=shaka.util.TXml,a=shaka.util.ManifestParserUtils.ContentType,i=n.findChildren(e,"Protection"),s=r.parseFromProtection(i,this.config_.mss.keySystemsBySystemId),o=[];r=[],i=[],e=n.findChildren(e,"StreamIndex");for(var l=(e=$jscomp.makeIterator(e)).next();!l.done;l=e.next()){l=l.value;for(var u=n.findChildren(l,"QualityLevel"),c=this.createTimeline_(l,t.timescale,t.duration),d=(u=$jscomp.makeIterator(u)).next();!d.done;d=u.next())(d=this.createStream_(l,d.value,c,s,t))&&(d.type!=a.AUDIO||this.config_.disableAudio?d.type!=a.VIDEO||this.config_.disableVideo?d.type!=a.TEXT||this.config_.disableText||i.push(d):r.push(d):o.push(d))}for(n=[],o=(a=$jscomp.makeIterator(0<o.length?o:[null])).next();!o.done;o=a.next())for(o=o.value,e=(s=$jscomp.makeIterator(0<r.length?r:[null])).next();!e.done;e=s.next())n.push(this.createVariant_(o,e.value));t.variants=n,t.textStreams=i},shaka.mss.MssParser.prototype.createStream_=function(e,t,r,n,a){var i=this,s=shaka.util.TXml,o=shaka.util.ManifestParserUtils.ContentType,l=shaka.mss.MssParser,u=e.attributes.Type;if("audio"!==u&&"video"!==u&&"text"!==u)return shaka.log.alwaysWarn("Ignoring unrecognized type:",u),null;var c=e.attributes.Language,d=this.globalId_++,p=s.parseAttr(t,"Bitrate",s.parsePositiveInt),h=s.parseAttr(t,"MaxWidth",s.parsePositiveInt),f=s.parseAttr(t,"MaxHeight",s.parsePositiveInt),m=s.parseAttr(t,"Channels",s.parsePositiveInt);s=s.parseAttr(t,"SamplingRate",s.parsePositiveInt);var g=a.duration;r.length&&(g=r[r.length-1].end-r[0].start);var y=this.presentationTimeline_.getDuration();this.presentationTimeline_.setDuration(Math.min(g,y));var v={id:d,originalId:e.attributes.Name||String(d),groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:p||0,width:h||void 0,height:f||void 0,kind:"",encrypted:0<n.length,drmInfos:n,keyIds:new Set,language:shaka.util.LanguageUtils.normalize(c||"und"),originalLanguage:c,label:"",type:"",primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:m,audioSamplingRate:s,spatialAudio:!1,closedCaptions:null,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:g,timescale:a.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set,isAudioMuxedInVideo:!1,baseOriginalId:null};if((n=e.attributes.Subtype)&&((n=l.ROLE_MAPPING_.get(n))&&v.roles.push(n),"main"===n&&(v.primary=!0)),null!==(n=t.attributes.FourCC)&&""!==n||(n=e.attributes.FourCC),!n)if("audio"===u)n="AAC";else if("video"===u)return shaka.log.alwaysWarn('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!l.SUPPORTED_CODECS_.includes(n.toUpperCase()))return shaka.log.alwaysWarn("Codec not supported:",n),null;switch(l=this.getCodecPrivateData_(t,u,n,v),v.mssPrivateData.codecPrivateData=l,u){case"audio":if(!l)return shaka.log.alwaysWarn("Quality unsupported without CodecPrivateData",u),null;v.type=o.AUDIO,v.mimeType="mss/audio/mp4",v.codecs=this.getAACCodec_(t,n,l);break;case"video":if(!l)return shaka.log.alwaysWarn("Quality unsupported without CodecPrivateData",u),null;v.type=o.VIDEO,v.mimeType="mss/video/mp4",v.codecs=this.getH264Codec_(t,l);break;case"text":v.type=o.TEXT,v.mimeType="application/mp4",("TTML"===n||"DFXP"===n)&&(v.codecs="stpp")}return v.fullMimeTypes.add(shaka.util.MimeUtils.getFullType(v.mimeType,v.codecs)),v.createSegmentIndex=function(){if(v.segmentIndex)return Promise.resolve();if(i.initSegmentDataByStreamId_.has(v.id))var t=i.initSegmentDataByStreamId_.get(v.id);else t=[],v.type==o.VIDEO&&(t=v.mssPrivateData.codecPrivateData.split("00000001").slice(1)),t={id:v.id,type:v.type,codecs:v.codecs,encrypted:v.encrypted,timescale:v.mssPrivateData.timescale,duration:v.mssPrivateData.duration,videoNalus:t,audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:null,stream:v},t=new shaka.util.Mp4Generator([t]).initSegment(),i.initSegmentDataByStreamId_.set(v.id,t);var n=shaka.media.QualityObserver.createQualityInfo(v);return t=new shaka.media.InitSegmentReference((function(){return[]}),0,null,n,v.mssPrivateData.timescale,t,null,v.encrypted),t=i.createSegments_(t,v,e,r),v.segmentIndex=new shaka.media.SegmentIndex(t),Promise.resolve()},v.closeSegmentIndex=function(){v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null)},v},shaka.mss.MssParser.prototype.getCodecPrivateData_=function(e,t,r,n){if(e=e.attributes.CodecPrivateData)return e;if("audio"!==t)return null;t=n.channelsCount||2;var a={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return n=a[e=n.audioSamplingRate||44100],"AACH"===r?(r=new Uint8Array(4),e=a[2*e],r[0]=40|n>>1,r[1]=n<<7|t<<3|e>>1,r[2]=e<<7|8,r[3]=0,(t=new Uint16Array(2))[0]=(r[0]<<8)+r[1],t[1]=(r[2]<<8)+r[3],t[0].toString(16)+t[1].toString(16)):((r=new Uint8Array(2))[0]=16|n>>1,r[1]=n<<7|t<<3,(t=new Uint16Array(1))[0]=(r[0]<<8)+r[1],t[0].toString(16))},shaka.mss.MssParser.prototype.getAACCodec_=function(e,t,r){return e=0,"AACH"===t&&(e=5),r?0===e&&(e=(248&parseInt(r.substr(0,2),16))>>3):(e=2,"AACH"===t&&(e=5)),"mp4a.40."+e},shaka.mss.MssParser.prototype.getH264Codec_=function(e,t){return(e=/00000001[0-9]7/.exec(t)).length&&t?"avc1."+t.substr(t.indexOf(e[0])+10,6):""},shaka.mss.MssParser.prototype.createSegments_=function(e,t,r,n){var a=this,i=shaka.util.ManifestParserUtils;r=r.attributes.Url,goog.asserts.assert(r,"Missing URL for segments");var s=r.replace("{bitrate}",String(t.bandwidth));r=[];for(var o=(n=$jscomp.makeIterator(n)).next(),l={};!o.done;l={time$jscomp$40:void 0},o=n.next())l.time$jscomp$40=o.value,o=function(e){return function(){return i.resolveUris(a.manifestUris_,[s.replace("{start time}",String(e.time$jscomp$40.unscaledStart))])}}(l),r.push(new shaka.media.SegmentReference(l.time$jscomp$40.start,l.time$jscomp$40.end,o,0,null,e,0,0,t.mssPrivateData.duration));return r},shaka.mss.MssParser.prototype.createTimeline_=function(e,t,r){goog.asserts.assert(0<t&&1/0>t,"timescale must be a positive, finite integer"),goog.asserts.assert(0<r,"duration must be a positive integer");var n=shaka.util.TXml;e=n.findChildren(e,"c");for(var a=[],i=0,s=0;s<e.length;++s){var o=e[s],l=e[s+1],u=n.parseAttr(o,"t",n.parseNonNegativeInt),c=n.parseAttr(o,"d",n.parseNonNegativeInt),d=n.parseAttr(o,"r",n.parseInt);if(!c){shaka.log.warning('"c" element must have a duration:','ignoring the remaining "c" elements.',o);break}if(u=null!=u?u:i,(d=d||0)&&d--,0>d)if(l){if(null==(l=n.parseAttr(l,"t",n.parseNonNegativeInt))){shaka.log.warning('An "c" element cannot have a negative repeat','if the next "c" element does not have a valid start time:','ignoring the remaining "c" elements.',o);break}if(u>=l){shaka.log.warning('An "c" element cannot have a negative repeat if its start ','time exceeds the next "c" element\'s start time:','ignoring the remaining "c" elements.',o);break}d=Math.ceil((l-u)/c)-1}else{if(1/0==r){shaka.log.warning('The last "c" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "c" element.',o);break}if(u/t>=r){shaka.log.warning('The last "c" element cannot have a negative repeat',"if its start time exceeds the duration:",'ignoring the last "c" element.',o);break}d=Math.ceil((r*t-u)/c)-1}for(o=0;o<=d;++o)i=u+c,a.push({start:u/t,end:i/t,unscaledStart:u}),u=i}return a},shaka.mss.MssParser.prototype.createVariant_=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType;return goog.asserts.assert(!e||e.type==r.AUDIO,"Audio parameter mismatch!"),goog.asserts.assert(!t||t.type==r.VIDEO,"Video parameter mismatch!"),r=0,e&&e.bandwidth&&0<e.bandwidth&&(r+=e.bandwidth),t&&t.bandwidth&&0<t.bandwidth&&(r+=t.bandwidth),{id:this.globalId_++,language:e?e.language:"und",disabledUntilTime:0,primary:!!e&&e.primary||!!t&&t.primary,audio:e,video:t,bandwidth:r,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}},goog.exportSymbol("shaka.mss.MssParser",shaka.mss.MssParser),shaka.mss.MssParser.MIN_UPDATE_PERIOD_=3,shaka.mss.MssParser.DEFAULT_TIME_SCALE_=1e7,shaka.mss.MssParser.SUPPORTED_CODECS_="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),shaka.mss.MssParser.ROLE_MAPPING_=(new Map).set("CAPT","main").set("SUBT","alternate").set("DESC","main"),shaka.media.ManifestParser.registerParserByMime("application/vnd.ms-sstr+xml",(function(){return new shaka.mss.MssParser})),shaka.net.HttpPluginUtils=function(){},shaka.net.HttpPluginUtils.makeResponse=function(e,t,r,n,a,i,s){if(goog.asserts.assert(t,"Data should be non-null!"),200<=r&&299>=r&&202!=r||304==r)return{uri:a||n,originalUri:n,data:t,status:r,headers:e,fromCache:!!e["x-shaka-from-cache"],originalRequest:i};i=null;try{i=shaka.util.StringUtils.fromBytesAutoDetect(t)}catch(e){}throw shaka.log.debug("HTTP error text:",i),new shaka.util.Error(401==r||403==r?shaka.util.Error.Severity.CRITICAL:shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.BAD_HTTP_STATUS,n,r,i,e,s,a||n)},shaka.net.HttpFetchPlugin=function(){},shaka.net.HttpFetchPlugin.parse=function(e,t,r,n,a,i){var s=new shaka.net.HttpFetchPlugin.Headers_;shaka.util.MapUtils.asMap(t.headers).forEach((function(e,t){s.append(t,e)}));var o=new shaka.net.HttpFetchPlugin.AbortController_,l={canceled:!1,timedOut:!1};if(e=shaka.net.HttpFetchPlugin.request_(e,t,r,{body:t.body||void 0,headers:s,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},l,n,a,t.streamDataCallback,i.minBytesForProgressEvents||0),e=new shaka.util.AbortableOperation(e,(function(){return l.canceled=!0,o.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var u=new shaka.util.Timer((function(){l.timedOut=!0,o.abort()}));u.tickAfter(t/1e3),e.finally((function(){u.stop()}))}return e},shaka.net.HttpFetchPlugin.request_=function(e,t,r,n,a,i,s,o,l){var u,c,d,p,h,f,m,g,y,v,_,k,E;return $jscomp.asyncExecutePromiseGeneratorProgram((function(b){switch(b.nextAddress){case 1:return u=shaka.net.HttpFetchPlugin.fetch_,c=shaka.net.HttpFetchPlugin.ReadableStream_,p=new ArrayBuffer(0),f=h=0,m=Date.now(),b.setCatchFinallyBlocks(2),b.yield(u(e,n),4);case 4:if(d=b.yieldResult,s(shaka.net.HttpFetchPlugin.headersToGenericObject_(d.headers)),"HEAD"==n.method){b.jumpTo(5);break}return goog.asserts.assert(d.body,"non-HEAD responses should have a body"),y=(g=d.headers.get("Content-Length"))?parseInt(g,10):0,d.body?(v=d.clone().body.getReader(),new c({start:function(e){var t=function(){var r,n,a,s,u;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:return c.setCatchFinallyBlocks(2),c.yield(v.read(),4);case 4:r=c.yieldResult,c.leaveTryBlock(3);break;case 2:return n=c.enterCatchBlock(),shaka.log.v1("error reading from stream",n.message),c.return();case 3:if(r.done){c.jumpTo(5);break}if(h+=r.value.byteLength,!o){c.jumpTo(5);break}return c.yield(o(r.value),5);case 5:a=Date.now(),s=h-f,(100<a-m&&s>=l||r.done)&&(u=r.done?0:y-h,i(a-m,s,u),f=h,m=a),r.done?(goog.asserts.assert(!r.value,'readObj should be unset when "done" is true.'),e.close()):(e.enqueue(r.value),t()),c.jumpToEnd()}}))};t()}}),b.yield(d.arrayBuffer(),8)):b.yield(d.arrayBuffer(),9);case 8:p=b.yieldResult,b.jumpTo(5);break;case 9:p=b.yieldResult,_=Date.now(),i(_-m,p.byteLength,0);case 5:b.leaveTryBlock(3);break;case 2:if(k=b.enterCatchBlock(),a.canceled)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.OPERATION_ABORTED,e,r);if(a.timedOut)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,e,r);throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.HTTP_ERROR,e,k,r);case 3:return E=shaka.net.HttpFetchPlugin.headersToGenericObject_(d.headers),b.return(shaka.net.HttpPluginUtils.makeResponse(E,p,d.status,e,d.url,t,r))}}))},shaka.net.HttpFetchPlugin.headersToGenericObject_=function(e){var t={};return e.forEach((function(e,r){t[r.trim()]=e})),t},shaka.net.HttpFetchPlugin.isSupported=function(){if(!window.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!!window.Response&&(!!new Response("").body&&!(!window.fetch||"polyfill"in window.fetch||!window.AbortController))},goog.exportSymbol("shaka.net.HttpFetchPlugin",shaka.net.HttpFetchPlugin),goog.exportProperty(shaka.net.HttpFetchPlugin,"isSupported",shaka.net.HttpFetchPlugin.isSupported),goog.exportProperty(shaka.net.HttpFetchPlugin,"parse",shaka.net.HttpFetchPlugin.parse),shaka.net.HttpFetchPlugin.fetch_=window.fetch,shaka.net.HttpFetchPlugin.AbortController_=window.AbortController,shaka.net.HttpFetchPlugin.ReadableStream_=window.ReadableStream,shaka.net.HttpFetchPlugin.Headers_=window.Headers,shaka.net.HttpFetchPlugin.isSupported()&&(shaka.net.NetworkingEngine.registerScheme("http",shaka.net.HttpFetchPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.PREFERRED,!0),shaka.net.NetworkingEngine.registerScheme("https",shaka.net.HttpFetchPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.PREFERRED,!0),shaka.net.NetworkingEngine.registerScheme("blob",shaka.net.HttpFetchPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.PREFERRED,!0)),shaka.net.HttpXHRPlugin=function(){},shaka.net.HttpXHRPlugin.parse=function(e,t,r,n,a,i){var s=new shaka.net.HttpXHRPlugin.Xhr_,o=Date.now(),l=0,u=new Promise((function(u,c){s.open(t.method,e,!0),s.responseType="arraybuffer",s.timeout=t.retryParameters.timeout,s.withCredentials=t.allowCrossSiteCredentials,s.onabort=function(){c(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.OPERATION_ABORTED,e,r))};var d=!1;for(var p in s.onreadystatechange=function(e){2!=s.readyState||d||(e=shaka.net.HttpXHRPlugin.headersToGenericObject_(s),a(e),d=!0)},s.onload=function(a){var i=shaka.net.HttpXHRPlugin.headersToGenericObject_(s);goog.asserts.assert(s.response instanceof ArrayBuffer,"XHR should have a response by now!");var d=s.response;try{var p=Date.now();n(p-o,a.loaded-l,0);var h=shaka.net.HttpPluginUtils.makeResponse(i,d,s.status,e,s.responseURL,t,r);u(h)}catch(e){goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),c(e)}},s.onerror=function(t){c(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.HTTP_ERROR,e,t,r))},s.ontimeout=function(t){c(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,e,r))},s.onprogress=function(e){var t=Date.now(),r=i.minBytesForProgressEvents||0,a=e.loaded-l;(100<t-o&&a>=r||e.lengthComputable&&e.loaded==e.total)&&(n(t-o,a,4==s.readyState?0:e.total-e.loaded),l=e.loaded,o=t)},t.headers){var h=p.toLowerCase();s.setRequestHeader(h,t.headers[p])}s.send(t.body)}));return new shaka.util.AbortableOperation(u,(function(){return s.abort(),Promise.resolve()}))},shaka.net.HttpXHRPlugin.headersToGenericObject_=function(e){var t=e.getAllResponseHeaders().trim().split("\r\n");e={};for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())e[(r=r.value.split(": "))[0].toLowerCase()]=r.slice(1).join(": ");return e},goog.exportSymbol("shaka.net.HttpXHRPlugin",shaka.net.HttpXHRPlugin),goog.exportProperty(shaka.net.HttpXHRPlugin,"parse",shaka.net.HttpXHRPlugin.parse),shaka.net.HttpXHRPlugin.Xhr_=window.XMLHttpRequest,shaka.net.NetworkingEngine.registerScheme("http",shaka.net.HttpXHRPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.FALLBACK,!0),shaka.net.NetworkingEngine.registerScheme("https",shaka.net.HttpXHRPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.FALLBACK,!0),shaka.net.NetworkingEngine.registerScheme("blob",shaka.net.HttpXHRPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.FALLBACK,!0),shaka.offline={},shaka.offline.DownloadInfo=function(e,t,r,n,a){this.ref=e,this.estimateId=t,this.groupId=r,this.isInitSegment=n,this.refPosition=a},shaka.offline.DownloadInfo.idForSegmentRef=function(e){var t=e.getSegmentData(!1);return t?shaka.util.Uint8ArrayUtils.toBase64(t):e.getUris().map((function(e){return"{"+encodeURI(e.split("#xywh=")[0])+"}"})).join("")+":"+e.startByte+":"+e.endByte},shaka.offline.DownloadInfo.prototype.getRefId=function(){return shaka.offline.DownloadInfo.idForSegmentRef(this.ref)},shaka.offline.DownloadInfo.prototype.makeSegmentRequest=function(e){return shaka.util.Networking.createSegmentRequest(this.ref.getUris(),this.ref.startByte,this.ref.endByte,e.streaming.retryParameters)},shaka.offline.DownloadProgressEstimator=function(){this.actualDownloaded_=this.estimatedDownloaded_=this.estimatedTotal_=0,this.pending_=new Map,this.nextId_=0},shaka.offline.DownloadProgressEstimator.prototype.open=function(e){this.estimatedTotal_+=e;var t=this.nextId_;return this.nextId_++,this.pending_.set(t,e),t},shaka.offline.DownloadProgressEstimator.prototype.close=function(e,t){if(this.pending_.has(e)){var r=this.pending_.get(e);this.pending_.delete(e),this.estimatedDownloaded_+=r,this.actualDownloaded_+=t}},shaka.offline.DownloadProgressEstimator.prototype.getEstimatedProgress=function(){return 0==this.estimatedTotal_?0:this.estimatedDownloaded_/this.estimatedTotal_},shaka.offline.DownloadProgressEstimator.prototype.getTotalDownloaded=function(){return this.actualDownloaded_},shaka.offline.DownloadManager=function(e){var t=this;this.networkingEngine_=e,this.groups_=new Map,this.destroyer_=new shaka.util.Destroyer((function(){return t.abortAll().catch((function(){}))})),this.abortCallbacks_=[],this.onProgress_=function(e,t){},this.onInitData_=function(e,t){},this.estimator_=new shaka.offline.DownloadProgressEstimator,this.aborted_=!1},shaka.offline.DownloadManager.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.offline.DownloadManager.prototype.setCallbacks=function(e,t){this.onProgress_=e,this.onInitData_=t},shaka.offline.DownloadManager.prototype.abortAll=function(){this.aborted_=!0;var e=this.abortCallbacks_.map((function(e){return e()}));return this.abortCallbacks_=[],Promise.all(e)},shaka.offline.DownloadManager.prototype.isAborted=function(){return this.aborted_},shaka.offline.DownloadManager.prototype.addDownloadEstimate=function(e){return this.estimator_.open(e)},shaka.offline.DownloadManager.prototype.queue=function(e,t,r,n,a){var i=this;this.destroyer_.ensureNotDestroyed();var s=(this.groups_.get(e)||Promise.resolve()).then((function(){var e,s,o,l,u,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress)return p.yield(i.fetchSegment_(t),2);if(e=p.yieldResult,i.destroyer_.destroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.OPERATION_ABORTED);if(n)for(l in s=shaka.util.BufferUtils.toUint8(e),(o=new shaka.util.Pssh(s)).data)u=Number(l),c=o.data[u],d=o.systemIds[u],i.onInitData_(c,d);return i.estimator_.close(r,e.byteLength),i.onProgress_(i.estimator_.getEstimatedProgress(),i.estimator_.getTotalDownloaded()),p.return(a(e))}))}));return this.groups_.set(e,s),s},shaka.offline.DownloadManager.prototype.queueData=function(e,t,r,n,a){var i=this;this.destroyer_.ensureNotDestroyed();var s=(this.groups_.get(e)||Promise.resolve()).then((function(){if(i.destroyer_.destroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.OPERATION_ABORTED);if(n){var e=shaka.util.BufferUtils.toUint8(t);for(var s in(e=new shaka.util.Pssh(e)).data){var o=Number(s);i.onInitData_(e.data[o],e.systemIds[o])}}return i.estimator_.close(r,t.byteLength),i.onProgress_(i.estimator_.getEstimatedProgress(),i.estimator_.getTotalDownloaded()),a(t)}));return this.groups_.set(e,s),s},shaka.offline.DownloadManager.prototype.queueWork=function(e,t){this.destroyer_.ensureNotDestroyed();var r=(this.groups_.get(e)||Promise.resolve()).then((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(t(),0)}))}));return this.groups_.set(e,r),r},shaka.offline.DownloadManager.prototype.waitToFinish=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?t.yield(Promise.all(e.groups_.values()),2):t.return(e.estimator_.getTotalDownloaded())}))},shaka.offline.DownloadManager.prototype.fetchSegment_=function(e){var t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(t=shaka.net.NetworkingEngine.RequestType.SEGMENT,r=i.networkingEngine_.request(t,e),n=function(){return r.abort()},i.abortCallbacks_.push(n),s.yield(r.promise,2)):(a=s.yieldResult,shaka.util.ArrayUtils.remove(i.abortCallbacks_,n),s.return(a.data))}))},shaka.offline.indexeddb={},shaka.offline.indexeddb.DBOperation=function(e,t){var r=this;this.transaction_=e,this.store_=e.objectStore(t),this.promise_=new shaka.util.PublicPromise,e.onabort=function(e){e.preventDefault(),r.promise_.reject()},e.onerror=function(e){e.preventDefault(),r.promise_.reject()},e.oncomplete=function(e){r.promise_.resolve()}},shaka.offline.indexeddb.DBOperation.prototype.abort=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress){try{e.transaction_.abort()}catch(e){}return t.setCatchFinallyBlocks(2),t.yield(e.promise_,4)}if(2!=t.nextAddress)return t.leaveTryBlock(0);t.enterCatchBlock(),t.jumpToEnd()}))},shaka.offline.indexeddb.DBOperation.prototype.forEachEntry=function(e){var t=this;return new Promise((function(r,n){var a=t.store_.openCursor();a.onerror=n,a.onsuccess=function(t){var n;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return null==a.result?(r(),t.return()):(n=a.result,t.yield(e(n.key,n.value,n),2));n.continue(),t.jumpToEnd()}))}}))},shaka.offline.indexeddb.DBOperation.prototype.store=function(){return this.store_},shaka.offline.indexeddb.DBOperation.prototype.promise=function(){return this.promise_},shaka.offline.indexeddb.DBConnection=function(e){this.connection_=e,this.pending_=[]},shaka.offline.indexeddb.DBConnection.prototype.destroy=function(){return Promise.all(this.pending_.map((function(e){return e.abort()})))},shaka.offline.indexeddb.DBConnection.prototype.startReadOnlyOperation=function(e){return this.startOperation_(e,"readonly")},shaka.offline.indexeddb.DBConnection.prototype.startReadWriteOperation=function(e){return this.startOperation_(e,"readwrite")},shaka.offline.indexeddb.DBConnection.prototype.startOperation_=function(e,t){var r=this;t=this.connection_.transaction([e],t);var n=new shaka.offline.indexeddb.DBOperation(t,e);return this.pending_.push(n),n.promise().then((function(){return r.stopTracking_(n)}),(function(){return r.stopTracking_(n)})),n},shaka.offline.indexeddb.DBConnection.prototype.stopTracking_=function(e){shaka.util.ArrayUtils.remove(this.pending_,e)},shaka.offline.indexeddb.BaseStorageCell=function(e,t,r){this.connection_=new shaka.offline.indexeddb.DBConnection(e),this.segmentStore_=t,this.manifestStore_=r},shaka.offline.indexeddb.BaseStorageCell.prototype.destroy=function(){return this.connection_.destroy()},shaka.offline.indexeddb.BaseStorageCell.prototype.hasFixedKeySpace=function(){return!0},shaka.offline.indexeddb.BaseStorageCell.prototype.addSegments=function(e){return this.rejectAdd(this.segmentStore_)},shaka.offline.indexeddb.BaseStorageCell.prototype.removeSegments=function(e,t){return this.remove_(this.segmentStore_,e,t)},shaka.offline.indexeddb.BaseStorageCell.prototype.getSegments=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?n.yield(r.get_(r.segmentStore_,e),2):(t=n.yieldResult,n.return(t.map((function(e){return r.convertSegmentData(e)}))))}))},shaka.offline.indexeddb.BaseStorageCell.prototype.addManifests=function(e){return this.rejectAdd(this.manifestStore_)},shaka.offline.indexeddb.BaseStorageCell.prototype.updateManifest=function(e,t){return this.rejectUpdate(this.manifestStore_)},shaka.offline.indexeddb.BaseStorageCell.prototype.updateManifestImplementation=function(e,t){var r=this.connection_.startReadWriteOperation(this.manifestStore_),n=r.store();return n.get(e).onsuccess=function(r){n.put(t,e)},r.promise()},shaka.offline.indexeddb.BaseStorageCell.prototype.updateManifestExpiration=function(e,t){var r=this.connection_.startReadWriteOperation(this.manifestStore_),n=r.store();return n.get(e).onsuccess=function(r){(r=r.target.result)&&(r.expiration=t,n.put(r,e))},r.promise()},shaka.offline.indexeddb.BaseStorageCell.prototype.removeManifests=function(e,t){return this.remove_(this.manifestStore_,e,t)},shaka.offline.indexeddb.BaseStorageCell.prototype.getManifests=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?n.yield(r.get_(r.manifestStore_,e),2):(t=n.yieldResult,n.return(Promise.all(t.map((function(e){return r.convertManifest(e)})))))}))},shaka.offline.indexeddb.BaseStorageCell.prototype.getAllManifests=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(e=r.connection_.startReadOnlyOperation(r.manifestStore_),t=new Map,n.yield(e.forEachEntry((function(e,n){var a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){if(1==i.nextAddress)return i.yield(r.convertManifest(n),2);a=i.yieldResult,t.set(e,a),i.jumpToEnd()}))})),2)):3!=n.nextAddress?n.yield(e.promise(),3):n.return(t)}))},shaka.offline.indexeddb.BaseStorageCell.prototype.convertSegmentData=function(e){return e},shaka.offline.indexeddb.BaseStorageCell.prototype.convertManifest=function(e){return Promise.resolve(e)},shaka.offline.indexeddb.BaseStorageCell.prototype.rejectAdd=function(e){return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.NEW_KEY_OPERATION_NOT_SUPPORTED,"Cannot add new value to "+e))},shaka.offline.indexeddb.BaseStorageCell.prototype.rejectUpdate=function(e){return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MODIFY_OPERATION_NOT_SUPPORTED,"Cannot modify values in "+e))},shaka.offline.indexeddb.BaseStorageCell.prototype.add=function(e,t){var r,n,a,i,s,o,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r=u.connection_.startReadWriteOperation(e),n=r.store(),a=[],i=$jscomp.makeIterator(t),s=i.next(),o={};!s.done;o={request$jscomp$61:void 0},s=i.next())l=s.value,o.request$jscomp$61=n.add(l),o.request$jscomp$61.onsuccess=function(e){return function(t){a.push(e.request$jscomp$61.result)}}(o);return c.yield(r.promise(),2)}return c.return(a)}))},shaka.offline.indexeddb.BaseStorageCell.prototype.remove_=function(e,t,r){for(var n=(e=this.connection_.startReadWriteOperation(e)).store(),a=(t=$jscomp.makeIterator(t)).next(),i={};!a.done;i={key$jscomp$147:void 0},a=t.next())i.key$jscomp$147=a.value,n.delete(i.key$jscomp$147).onsuccess=function(e){return function(){return r(e.key$jscomp$147)}}(i);return e.promise()},shaka.offline.indexeddb.BaseStorageCell.prototype.get_=function(e,t){var r,n,a,i,s,o,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r=u.connection_.startReadOnlyOperation(e),n=r.store(),a={},i=[],s=$jscomp.makeIterator(t),o=s.next(),l={};!o.done;l={request$jscomp$62:void 0,key$jscomp$148:void 0},o=s.next())l.key$jscomp$148=o.value,l.request$jscomp$62=n.get(l.key$jscomp$148),l.request$jscomp$62.onsuccess=function(e){return function(){null==e.request$jscomp$62.result&&i.push(e.key$jscomp$148),a[e.key$jscomp$148]=e.request$jscomp$62.result}}(l);return c.yield(r.promise(),2)}if(i.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+i);return c.return(t.map((function(e){return a[e]})))}))},shaka.offline.indexeddb.EmeSessionStorageCell=function(e,t){this.connection_=new shaka.offline.indexeddb.DBConnection(e),this.store_=t},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.destroy=function(){return this.connection_.destroy()},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.getAll=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(e=r.connection_.startReadOnlyOperation(r.store_),t=[],n.yield(e.forEachEntry((function(e,r){t.push(r)})),2)):3!=n.nextAddress?n.yield(e.promise(),3):n.return(t)}))},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.add=function(e){for(var t=this.connection_.startReadWriteOperation(this.store_),r=t.store(),n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())r.add(n.value);return t.promise()},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.remove=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=r.connection_.startReadWriteOperation(r.store_),n.yield(t.forEachEntry((function(t,r,n){e.includes(r.sessionId)&&n.delete()})),2)):n.yield(t.promise(),0)}))},shaka.offline.StorageCellHandle={},shaka.offline.StorageCellPath={},shaka.offline.StorageMuxer=function(){this.mechanisms_=new Map},shaka.offline.StorageMuxer.prototype.destroy=function(){for(var e=[],t=$jscomp.makeIterator(this.mechanisms_.values()),r=t.next();!r.done;r=t.next())e.push(r.value.destroy());return this.mechanisms_.clear(),Promise.all(e)},shaka.offline.StorageMuxer.prototype.init=function(){var e=this;shaka.offline.StorageMuxer.getRegistry_().forEach((function(t,r){(t=t())?e.mechanisms_.set(r,t):shaka.log.info("Skipping "+r+" as it is not supported on this platform")}));for(var t=[],r=$jscomp.makeIterator(this.mechanisms_.values()),n=r.next();!n.done;n=r.next())t.push(n.value.init());return Promise.all(t)},shaka.offline.StorageMuxer.prototype.getActive=function(){var e=null;if(this.mechanisms_.forEach((function(t,r){t.getCells().forEach((function(t,n){t.hasFixedKeySpace()||e||(e={path:{mechanism:r,cell:n},cell:t})}))})),e)return e;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MISSING_STORAGE_CELL,"Could not find a cell that supports add-operations")},shaka.offline.StorageMuxer.prototype.forEachCell=function(e){this.mechanisms_.forEach((function(t,r){t.getCells().forEach((function(t,n){e({mechanism:r,cell:n},t)}))}))},shaka.offline.StorageMuxer.prototype.getCell=function(e,t){var r=this.mechanisms_.get(e);if(!r)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MISSING_STORAGE_CELL,"Could not find mechanism with name "+e);if(!(e=r.getCells().get(t)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MISSING_STORAGE_CELL,"Could not find cell with name "+t);return e},shaka.offline.StorageMuxer.prototype.forEachEmeSessionCell=function(e){this.mechanisms_.forEach((function(t,r){e(t.getEmeSessionCell())}))},shaka.offline.StorageMuxer.prototype.getEmeSessionCell=function(){var e=Array.from(this.mechanisms_.keys());if(!e.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.STORAGE_NOT_SUPPORTED,"No supported storage mechanisms found");return this.mechanisms_.get(e[0]).getEmeSessionCell()},shaka.offline.StorageMuxer.prototype.resolvePath=function(e){var t=this.mechanisms_.get(e.mechanism);return t?t.getCells().get(e.cell):null},shaka.offline.StorageMuxer.prototype.erase=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(e=Array.from(r.mechanisms_.values()),(t=0<e.length)||shaka.offline.StorageMuxer.getRegistry_().forEach((function(t,r){(t=t())&&e.push(t)})),n.yield(Promise.all(e.map((function(e){return e.erase()}))),2)):t?n.jumpTo(0):n.yield(Promise.all(e.map((function(e){return e.destroy()}))),0)}))},shaka.offline.StorageMuxer.register=function(e,t){shaka.offline.StorageMuxer.registry_.set(e,t)},shaka.offline.StorageMuxer.unregister=function(e){shaka.offline.StorageMuxer.registry_.delete(e)},shaka.offline.StorageMuxer.support=function(){for(var e=shaka.offline.StorageMuxer.getRegistry_(),t=(e=$jscomp.makeIterator(e.values())).next();!t.done;t=e.next())if(t=(t=t.value)())return t.destroy(),!0;return!1},shaka.offline.StorageMuxer.overrideSupport=function(e){shaka.offline.StorageMuxer.override_=e},shaka.offline.StorageMuxer.clearOverride=function(){shaka.offline.StorageMuxer.override_=null},shaka.offline.StorageMuxer.getRegistry_=function(){var e=shaka.offline.StorageMuxer.override_,t=shaka.offline.StorageMuxer.registry_;return COMPILED?t:e||t},goog.exportSymbol("shaka.offline.StorageMuxer",shaka.offline.StorageMuxer),goog.exportProperty(shaka.offline.StorageMuxer,"unregister",shaka.offline.StorageMuxer.unregister),goog.exportProperty(shaka.offline.StorageMuxer,"register",shaka.offline.StorageMuxer.register),goog.exportProperty(shaka.offline.StorageMuxer.prototype,"destroy",shaka.offline.StorageMuxer.prototype.destroy),shaka.offline.StorageMuxer.override_=null,shaka.offline.StorageMuxer.registry_=new Map,shaka.offline.indexeddb.V1StorageCell=function(){shaka.offline.indexeddb.BaseStorageCell.apply(this,arguments)},$jscomp.inherits(shaka.offline.indexeddb.V1StorageCell,shaka.offline.indexeddb.BaseStorageCell),shaka.offline.indexeddb.V1StorageCell.prototype.updateManifestExpiration=function(e,t){var r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return r=i.connection_.startReadWriteOperation(i.manifestStore_),n=r.store(),a=new shaka.util.PublicPromise,n.get(e).onsuccess=function(r){(r=r.target.result)?(goog.asserts.assert(r.key==e,"With in-line keys, the keys should match"),r.expiration=t,n.put(r),a.resolve()):a.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+e))},s.yield(Promise.all([r.promise(),a]),0)}))},shaka.offline.indexeddb.V1StorageCell.prototype.convertManifest=function(e){var t,r,n,a,i,s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress){for(t=shaka.offline.indexeddb.V1StorageCell,r=[],n=0;n<e.periods.length;++n)a=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=a-e.periods[n].startTime,s=t.convertPeriod_(e.periods[n],i),r.push(s);return l.yield(shaka.util.PeriodCombiner.combineDbStreams(r),2)}return o=l.yieldResult,l.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:o,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})}))},shaka.offline.indexeddb.V1StorageCell.convertPeriod_=function(e,t){var r=shaka.offline.indexeddb.V1StorageCell;r.fillMissingVariants_(e);for(var n=$jscomp.makeIterator(e.streams),a=n.next();!a.done;a=n.next())goog.asserts.assert(a.value.variantIds,"After filling in missing variants, each stream should have variant ids");return e.streams.map((function(n){return r.convertStream_(n,e.startTime,t)}))},shaka.offline.indexeddb.V1StorageCell.convertStream_=function(e,t,r){var n=shaka.offline.indexeddb.V1StorageCell,a=e.initSegmentUri?n.getKeyFromSegmentUri_(e.initSegmentUri):null,i=t+e.presentationTimeOffset,s=t+r;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:a,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(e){return n.convertSegment_(e,a,t,s,i)})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}},shaka.offline.indexeddb.V1StorageCell.convertSegment_=function(e,t,r,n,a){var i=shaka.offline.indexeddb.V1StorageCell.getKeyFromSegmentUri_(e.uri);return{startTime:r+e.startTime,endTime:r+e.endTime,dataKey:i,initSegmentKey:t,appendWindowStart:r,appendWindowEnd:n,timestampOffset:a,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}},shaka.offline.indexeddb.V1StorageCell.prototype.convertSegmentData=function(e){return{data:e.data}},shaka.offline.indexeddb.V1StorageCell.getKeyFromSegmentUri_=function(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,"Could not parse uri "+e)},shaka.offline.indexeddb.V1StorageCell.fillMissingVariants_=function(e){var t=shaka.util.ManifestParserUtils.ContentType.AUDIO,r=shaka.util.ManifestParserUtils.ContentType.VIDEO,n=e.streams.filter((function(e){return e.contentType==t}));if(e=e.streams.filter((function(e){return e.contentType==r})),!n.every((function(e){return e.variantIds}))||!e.every((function(e){return e.variantIds}))){goog.asserts.assert(n.every((function(e){return!e.variantIds})),"Some audio streams have variant ids and some do not."),goog.asserts.assert(e.every((function(e){return!e.variantIds})),"Some video streams have variant ids and some do not.");for(var a=$jscomp.makeIterator(n),i=a.next();!i.done;i=a.next())i.value.variantIds=[];for(i=(a=$jscomp.makeIterator(e)).next();!i.done;i=a.next())i.value.variantIds=[];if(a=0,e.length&&!n.length){shaka.log.debug("Found video-only content. Creating variants for video."),i=a++;for(var s=$jscomp.makeIterator(e),o=s.next();!o.done;o=s.next())o.value.variantIds.push(i)}if(!e.length&&n.length)for(shaka.log.debug("Found audio-only content. Creating variants for audio."),i=a++,o=(s=$jscomp.makeIterator(n)).next();!o.done;o=s.next())o.value.variantIds.push(i);if(e.length&&n.length)for(shaka.log.debug("Found audio-video content. Creating variants."),i=(n=$jscomp.makeIterator(n)).next();!i.done;i=n.next())for(i=i.value,o=(s=$jscomp.makeIterator(e)).next();!o.done;o=s.next()){o=o.value;var l=a++;i.variantIds.push(l),o.variantIds.push(l)}}},shaka.offline.indexeddb.V2StorageCell=function(){shaka.offline.indexeddb.BaseStorageCell.apply(this,arguments)},$jscomp.inherits(shaka.offline.indexeddb.V2StorageCell,shaka.offline.indexeddb.BaseStorageCell),shaka.offline.indexeddb.V2StorageCell.prototype.convertManifest=function(e){var t,r,n,a,i,s,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress){for(t=[],r=0;r<e.periods.length;++r)n=r==e.periods.length-1?e.duration:e.periods[r+1].startTime,a=n-e.periods[r].startTime,i=o.convertPeriod_(e.periods[r],a),t.push(i);return l.yield(shaka.util.PeriodCombiner.combineDbStreams(t),2)}return s=l.yieldResult,l.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:s,sequenceMode:!1})}))},shaka.offline.indexeddb.V2StorageCell.prototype.convertPeriod_=function(e,t){for(var r=[],n=$jscomp.makeIterator(e.streams),a=n.next();!a.done;a=n.next())0!=(a=a.value).variantIds.length&&r.push(this.convertStream_(a,e.startTime,e.startTime+t));return r},shaka.offline.indexeddb.V2StorageCell.prototype.convertStream_=function(e,t,r){var n=this;return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(a){return n.convertSegment_(a,e.initSegmentKey,t,r,e.presentationTimeOffset)})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1,isAudioMuxedInVideo:!1}},shaka.offline.indexeddb.V2StorageCell.prototype.convertSegment_=function(e,t,r,n,a){return{startTime:r+e.startTime,endTime:r+e.endTime,initSegmentKey:t,appendWindowStart:r,appendWindowEnd:n,timestampOffset:r-a,dataKey:e.dataKey,tilesLayout:"",mimeType:null,codecs:null,thumbnailSprite:null}},shaka.offline.indexeddb.V5StorageCell=function(){shaka.offline.indexeddb.BaseStorageCell.apply(this,arguments)},$jscomp.inherits(shaka.offline.indexeddb.V5StorageCell,shaka.offline.indexeddb.BaseStorageCell),shaka.offline.indexeddb.V5StorageCell.prototype.hasFixedKeySpace=function(){return!1},shaka.offline.indexeddb.V5StorageCell.prototype.addSegments=function(e){return this.add(this.segmentStore_,e)},shaka.offline.indexeddb.V5StorageCell.prototype.addManifests=function(e){return this.add(this.manifestStore_,e)},shaka.offline.indexeddb.V5StorageCell.prototype.updateManifest=function(e,t){return this.updateManifestImplementation(e,t)},shaka.offline.indexeddb.V5StorageCell.prototype.convertManifest=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},shaka.offline.indexeddb.StorageMechanism=function(){this.sessions_=this.v5_=this.v3_=this.v2_=this.v1_=this.db_=null},shaka.offline.indexeddb.StorageMechanism.prototype.init=function(){var e=this,t=shaka.offline.indexeddb.StorageMechanism.DB_NAME,r=shaka.offline.indexeddb.StorageMechanism.VERSION,n=new shaka.util.PublicPromise,a=!1,i=new shaka.util.Timer((function(){a=!0,n.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.INDEXED_DB_INIT_TIMED_OUT))}));i.tickAfter(5);var s=window.indexedDB.open(t,r);return s.onsuccess=function(t){a||(t=s.result,e.db_=t,e.v1_=shaka.offline.indexeddb.StorageMechanism.createV1_(t),e.v2_=shaka.offline.indexeddb.StorageMechanism.createV2_(t),e.v3_=shaka.offline.indexeddb.StorageMechanism.createV3_(t),e.v5_=shaka.offline.indexeddb.StorageMechanism.createV5_(t),e.sessions_=shaka.offline.indexeddb.StorageMechanism.createEmeSessionCell_(t),i.stop(),n.resolve())},s.onupgradeneeded=function(t){e.createStores_(s.result)},s.onerror=function(e){a||(n.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.INDEXED_DB_ERROR,s.error)),i.stop(),e.preventDefault())},n},shaka.offline.indexeddb.StorageMechanism.prototype.destroy=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:if(!e.v1_){t.jumpTo(2);break}return t.yield(e.v1_.destroy(),2);case 2:if(!e.v2_){t.jumpTo(4);break}return t.yield(e.v2_.destroy(),4);case 4:if(!e.v3_){t.jumpTo(6);break}return t.yield(e.v3_.destroy(),6);case 6:if(!e.v5_){t.jumpTo(8);break}return t.yield(e.v5_.destroy(),8);case 8:if(!e.sessions_){t.jumpTo(10);break}return t.yield(e.sessions_.destroy(),10);case 10:e.db_&&e.db_.close(),t.jumpToEnd()}}))},shaka.offline.indexeddb.StorageMechanism.prototype.getCells=function(){var e=new Map;return this.v1_&&e.set("v1",this.v1_),this.v2_&&e.set("v2",this.v2_),this.v3_&&e.set("v3",this.v3_),this.v5_&&e.set("v5",this.v5_),e},shaka.offline.indexeddb.StorageMechanism.prototype.getEmeSessionCell=function(){return goog.asserts.assert(this.sessions_,"Cannot be destroyed."),this.sessions_},shaka.offline.indexeddb.StorageMechanism.prototype.erase=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:if(!e.v1_){t.jumpTo(2);break}return t.yield(e.v1_.destroy(),2);case 2:if(!e.v2_){t.jumpTo(4);break}return t.yield(e.v2_.destroy(),4);case 4:if(!e.v3_){t.jumpTo(6);break}return t.yield(e.v3_.destroy(),6);case 6:if(!e.v5_){t.jumpTo(8);break}return t.yield(e.v5_.destroy(),8);case 8:return e.db_&&e.db_.close(),t.yield(shaka.offline.indexeddb.StorageMechanism.deleteAll_(),10);case 10:return e.db_=null,e.v1_=null,e.v2_=null,e.v3_=null,e.v5_=null,t.yield(e.init(),0)}}))},shaka.offline.indexeddb.StorageMechanism.createV1_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V1_SEGMENT_STORE;t=t.V1_MANIFEST_STORE;var n=e.objectStoreNames;return n.contains(t)&&n.contains(r)?(shaka.log.debug("Mounting v1 idb storage cell"),new shaka.offline.indexeddb.V1StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createV2_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V2_SEGMENT_STORE;t=t.V2_MANIFEST_STORE;var n=e.objectStoreNames;return n.contains(t)&&n.contains(r)?(shaka.log.debug("Mounting v2 idb storage cell"),new shaka.offline.indexeddb.V2StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createV3_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V3_SEGMENT_STORE;t=t.V3_MANIFEST_STORE;var n=e.objectStoreNames;return n.contains(t)&&n.contains(r)?(shaka.log.debug("Mounting v3 idb storage cell"),new shaka.offline.indexeddb.V2StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createV5_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V5_SEGMENT_STORE;t=t.V5_MANIFEST_STORE;var n=e.objectStoreNames;return n.contains(t)&&n.contains(r)?(shaka.log.debug("Mounting v5 idb storage cell"),new shaka.offline.indexeddb.V5StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createEmeSessionCell_=function(e){var t=shaka.offline.indexeddb.StorageMechanism.SESSION_ID_STORE;return e.objectStoreNames.contains(t)?(shaka.log.debug("Mounting session ID idb storage cell"),new shaka.offline.indexeddb.EmeSessionStorageCell(e,t)):null},shaka.offline.indexeddb.StorageMechanism.prototype.createStores_=function(e){for(var t=$jscomp.makeIterator([shaka.offline.indexeddb.StorageMechanism.V5_SEGMENT_STORE,shaka.offline.indexeddb.StorageMechanism.V5_MANIFEST_STORE,shaka.offline.indexeddb.StorageMechanism.SESSION_ID_STORE]),r=t.next();!r.done;r=t.next())r=r.value,e.objectStoreNames.contains(r)||e.createObjectStore(r,{autoIncrement:!0})},shaka.offline.indexeddb.StorageMechanism.deleteAll_=function(){var e=shaka.offline.indexeddb.StorageMechanism.DB_NAME,t=new shaka.util.PublicPromise,r=window.indexedDB.deleteDatabase(e);return r.onblocked=function(t){shaka.log.warning("Deleting",e,"is being blocked",t)},r.onsuccess=function(e){t.resolve()},r.onerror=function(e){t.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.INDEXED_DB_ERROR,r.error)),e.preventDefault()},t},shaka.offline.indexeddb.StorageMechanism.DB_NAME="shaka_offline_db",shaka.offline.indexeddb.StorageMechanism.VERSION=5,shaka.offline.indexeddb.StorageMechanism.V1_SEGMENT_STORE="segment",shaka.offline.indexeddb.StorageMechanism.V2_SEGMENT_STORE="segment-v2",shaka.offline.indexeddb.StorageMechanism.V3_SEGMENT_STORE="segment-v3",shaka.offline.indexeddb.StorageMechanism.V5_SEGMENT_STORE="segment-v5",shaka.offline.indexeddb.StorageMechanism.V1_MANIFEST_STORE="manifest",shaka.offline.indexeddb.StorageMechanism.V2_MANIFEST_STORE="manifest-v2",shaka.offline.indexeddb.StorageMechanism.V3_MANIFEST_STORE="manifest-v3",shaka.offline.indexeddb.StorageMechanism.V5_MANIFEST_STORE="manifest-v5",shaka.offline.indexeddb.StorageMechanism.SESSION_ID_STORE="session-ids",shaka.offline.StorageMuxer.register("idb",(function(){return shaka.util.Platform.isChromecast()&&!shaka.util.Platform.isAndroidCastDevice()||shaka.util.Platform.isXboxOne()||!window.indexedDB?null:new shaka.offline.indexeddb.StorageMechanism})),shaka.offline.OfflineUri=function(e,t,r,n){this.type_=e,this.mechanism_=t,this.cell_=r,this.key_=n,this.asString_=["offline:",e,"/",t,"/",r,"/",n].join("")},shaka.offline.OfflineUri.prototype.isManifest=function(){return"manifest"==this.type_},shaka.offline.OfflineUri.prototype.isSegment=function(){return"segment"==this.type_},shaka.offline.OfflineUri.prototype.mechanism=function(){return this.mechanism_},shaka.offline.OfflineUri.prototype.cell=function(){return this.cell_},shaka.offline.OfflineUri.prototype.key=function(){return this.key_},shaka.offline.OfflineUri.prototype.toString=function(){return this.asString_},shaka.offline.OfflineUri.parse=function(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var r=e[2];if(!r)return null;var n=e[3];return n&&null!=t?new shaka.offline.OfflineUri(t,r,n,Number(e[4])):null},shaka.offline.OfflineUri.manifest=function(e,t,r){return new shaka.offline.OfflineUri("manifest",e,t,r)},shaka.offline.OfflineUri.segment=function(e,t,r){return new shaka.offline.OfflineUri("segment",e,t,r)},shaka.offline.ManifestConverter=function(e,t){this.mechanism_=e,this.cell_=t},shaka.offline.ManifestConverter.prototype.fromManifestDB=function(e){var t=this,r=new shaka.media.PresentationTimeline(null,0);r.setDuration(e.duration);var n=e.streams.filter((function(e){return t.isAudio_(e)})),a=e.streams.filter((function(e){return t.isVideo_(e)}));n=this.createVariants(n,a,r),a=e.streams.filter((function(e){return t.isText_(e)})).map((function(e){return t.fromStreamDB_(e,r)}));var i=e.streams.filter((function(e){return t.isImage_(e)})).map((function(e){return t.fromStreamDB_(e,r)})),s=e.drmInfo?[e.drmInfo]:[];if(e.drmInfo)for(var o=$jscomp.makeIterator(n.values()),l=o.next();!l.done;l=o.next())(l=l.value).audio&&l.audio.encrypted&&(l.audio.drmInfos=s),l.video&&l.video.encrypted&&(l.video.drmInfos=s);return{presentationTimeline:r,offlineSessionIds:e.sessionIds,variants:Array.from(n.values()),textStreams:a,imageStreams:i,sequenceMode:e.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:e.type||shaka.media.ManifestParser.UNKNOWN,serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1,startTime:null}},shaka.offline.ManifestConverter.prototype.createVariants=function(e,t,r){for(var n=new Set,a=$jscomp.makeIterator(e),i=a.next();!i.done;i=a.next())for(var s=(i=$jscomp.makeIterator(i.value.variantIds)).next();!s.done;s=i.next())n.add(s.value);for(i=(a=$jscomp.makeIterator(t)).next();!i.done;i=a.next())for(s=(i=$jscomp.makeIterator(i.value.variantIds)).next();!s.done;s=i.next())n.add(s.value);for(a=new Map,i=(n=$jscomp.makeIterator(n)).next();!i.done;i=n.next())i=i.value,a.set(i,this.createEmptyVariant_(i));for(n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())for(i=n.value,n=this.fromStreamDB_(i,r),s=(i=$jscomp.makeIterator(i.variantIds)).next();!s.done;s=i.next())s=a.get(s.value),goog.asserts.assert(!s.audio,"A variant should only have one audio stream"),s.language=n.language,s.primary=s.primary||n.primary,s.audio=n;for(e=(t=$jscomp.makeIterator(t)).next();!e.done;e=t.next())for(n=e.value,e=this.fromStreamDB_(n,r),i=(n=$jscomp.makeIterator(n.variantIds)).next();!i.done;i=n.next())i=a.get(i.value),goog.asserts.assert(!i.video,"A variant should only have one video stream"),i.primary=i.primary||e.primary,i.video=e;return a},shaka.offline.ManifestConverter.prototype.fromStreamDB_=function(e,t){var r=this,n=e.segments.map((function(t,n){return r.fromSegmentDB_(n,t,e)}));return t.notifySegments(n),t=new shaka.media.SegmentIndex(n),{id:e.id,originalId:e.originalId,groupId:e.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:t,mimeType:e.mimeType,codecs:e.codecs,width:e.width||void 0,height:e.height||void 0,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:e.hdr,colorGamut:e.colorGamut,videoLayout:e.videoLayout,kind:e.kind,encrypted:e.encrypted,drmInfos:[],keyIds:e.keyIds,language:e.language,originalLanguage:e.originalLanguage||null,label:e.label,type:e.type,primary:e.primary,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:e.roles,forced:e.forced,channelsCount:e.channelsCount,audioSamplingRate:e.audioSamplingRate,spatialAudio:e.spatialAudio,closedCaptions:e.closedCaptions,tilesLayout:e.tilesLayout,mssPrivateData:e.mssPrivateData,accessibilityPurpose:null,external:e.external,fastSwitching:e.fastSwitching,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs)]),isAudioMuxedInVideo:!1,baseOriginalId:null}},shaka.offline.ManifestConverter.prototype.fromSegmentDB_=function(e,t,r){var n=shaka.offline.OfflineUri.segment(this.mechanism_,this.cell_,t.dataKey);return e=null!=t.initSegmentKey?this.fromInitSegmentDB_(t.initSegmentKey):null,(e=new shaka.media.SegmentReference(t.startTime,t.endTime,(function(){return[n.toString()]}),0,null,e,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||"")).mimeType=t.mimeType||r.mimeType||"",e.codecs=t.codecs||r.codecs||"",t.thumbnailSprite&&e.setThumbnailSprite(t.thumbnailSprite),e},shaka.offline.ManifestConverter.prototype.fromInitSegmentDB_=function(e){var t=shaka.offline.OfflineUri.segment(this.mechanism_,this.cell_,e);return new shaka.media.InitSegmentReference((function(){return[t.toString()]}),0,null)},shaka.offline.ManifestConverter.prototype.isAudio_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.AUDIO},shaka.offline.ManifestConverter.prototype.isVideo_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.VIDEO},shaka.offline.ManifestConverter.prototype.isText_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.TEXT},shaka.offline.ManifestConverter.prototype.isImage_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.IMAGE},shaka.offline.ManifestConverter.prototype.createEmptyVariant_=function(e){return{id:e,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}},shaka.offline.OfflineManifestParser=function(){this.uri_=null},shaka.offline.OfflineManifestParser.prototype.configure=function(e){},shaka.offline.OfflineManifestParser.prototype.start=function(e,t){var r,n,a,i,s,o,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:if(r=shaka.offline.OfflineUri.parse(e),u.uri_=r,null==r||!r.isManifest())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,e);return n=new shaka.offline.StorageMuxer,c.setFinallyBlock(2),c.yield(n.init(),4);case 4:return c.yield(n.getCell(r.mechanism(),r.cell()),5);case 5:return a=c.yieldResult,c.yield(a.getManifests([r.key()]),6);case 6:return i=c.yieldResult,s=i[0],o=new shaka.offline.ManifestConverter(r.mechanism(),r.cell()),l=o.fromManifestDB(s),t.makeTextStreamsForClosedCaptions(l),c.return(l);case 2:return c.enterFinallyBlock(),c.yield(n.destroy(),7);case 7:c.leaveFinallyBlock(0)}}))},shaka.offline.OfflineManifestParser.prototype.stop=function(){return Promise.resolve()},shaka.offline.OfflineManifestParser.prototype.update=function(){},shaka.offline.OfflineManifestParser.prototype.onExpirationUpdated=function(e,t){var r,n,a,i,s,o,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:return goog.asserts.assert(c.uri_,"Should not get update event before start has been called"),r=c.uri_,n=new shaka.offline.StorageMuxer,d.setCatchFinallyBlocks(2,3),d.yield(n.init(),5);case 5:return d.yield(n.getCell(r.mechanism(),r.cell()),6);case 6:return a=d.yieldResult,d.yield(a.getManifests([r.key()]),7);case 7:if(i=d.yieldResult,s=i[0],o=s.sessionIds.includes(e),l=null==s.expiration||s.expiration>t,!o||!l){d.jumpTo(3);break}return shaka.log.debug("Updating expiration for stored content"),d.yield(a.updateManifestExpiration(r.key(),t),3);case 3:return d.enterFinallyBlock(),d.yield(n.destroy(),10);case 10:d.leaveFinallyBlock(0);break;case 2:u=d.enterCatchBlock(),shaka.log.error("There was an error updating",r,u),d.jumpTo(3)}}))},shaka.offline.OfflineManifestParser.prototype.onInitialVariantChosen=function(e){},shaka.offline.OfflineManifestParser.prototype.banLocation=function(e){},shaka.offline.OfflineManifestParser.prototype.setMediaElement=function(e){},shaka.media.ManifestParser.registerParserByMime("application/x-offline-manifest",(function(){return new shaka.offline.OfflineManifestParser})),shaka.offline.OfflineScheme=function(){},shaka.offline.OfflineScheme.plugin=function(e,t,r,n){return(r=shaka.offline.OfflineUri.parse(e))&&r.isManifest()?shaka.offline.OfflineScheme.getManifest_(e,t):r&&r.isSegment()?shaka.offline.OfflineScheme.getSegment_(r.key(),r,t):shaka.util.AbortableOperation.failed(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,e))},shaka.offline.OfflineScheme.getManifest_=function(e,t){return e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"},originalRequest:t},shaka.util.AbortableOperation.completed(e)},shaka.offline.OfflineScheme.getSegment_=function(e,t,r){goog.asserts.assert(t.isSegment(),"Only segment uri's should be given to getSegment");var n=new shaka.offline.StorageMuxer;return shaka.util.AbortableOperation.completed(void 0).chain((function(){return n.init()})).chain((function(){return n.getCell(t.mechanism(),t.cell())})).chain((function(e){return e.getSegments([t.key()])})).chain((function(e){return{uri:t,data:e[0].data,headers:{},originalRequest:r}})).finally((function(){return n.destroy()}))},goog.exportSymbol("shaka.offline.OfflineScheme",shaka.offline.OfflineScheme),goog.exportProperty(shaka.offline.OfflineScheme,"plugin",shaka.offline.OfflineScheme.plugin),shaka.net.NetworkingEngine.registerScheme("offline",shaka.offline.OfflineScheme.plugin),shaka.offline.SessionDeleter=function(){},shaka.offline.SessionDeleter.prototype.delete=function(e,t,r){var n,a,i,s,o,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:n=shaka.offline.SessionDeleter,a=[],i=$jscomp.makeIterator(n.createBuckets_(r)),s=i.next();case 2:if(s.done){d.jumpTo(4);break}return o=s.value,l=c.doDelete_(e,t,o),d.yield(l,5);case 5:u=d.yieldResult,a=a.concat(u),s=i.next(),d.jumpTo(2);break;case 4:return d.return(a)}}))},shaka.offline.SessionDeleter.prototype.doDelete_=function(e,t,r){var n,a,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:return n=new shaka.drm.DrmEngine({netEngine:t,onError:function(){},onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),s.setCatchFinallyBlocks(2),n.configure(e),s.yield(n.initForRemoval(r.info.keySystem,r.info.licenseUri,r.info.serverCertificate,r.info.audioCapabilities,r.info.videoCapabilities),4);case 4:s.leaveTryBlock(3);break;case 2:return a=s.enterCatchBlock(),shaka.log.warning("Error initializing EME",a),s.yield(n.destroy(),5);case 5:return s.return([]);case 3:return i=[],s.yield(Promise.all(r.sessionIds.map((function(e){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(r.setCatchFinallyBlocks(2),r.yield(n.removeSession(e),4)):2!=r.nextAddress?(i.push(e),r.leaveTryBlock(0)):(t=r.enterCatchBlock(),shaka.log.warning("Error deleting offline session",t),void r.jumpToEnd())}))}))),6);case 6:return s.yield(n.destroy(),7);case 7:return s.return(i)}}))},shaka.offline.SessionDeleter.createBuckets_=function(e){for(var t=shaka.offline.SessionDeleter,r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;for(var a=!1,i=$jscomp.makeIterator(r),s=i.next();!s.done;s=i.next())if(s=s.value,t.isCompatible_(s.info,n)){s.sessionIds.push(n.sessionId),a=!0;break}a||r.push({info:n,sessionIds:[n.sessionId]})}return r},shaka.offline.SessionDeleter.isCompatible_=function(e,t){var r=shaka.util.ArrayUtils,n=function(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType};return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&r.hasSameElements(e.audioCapabilities,t.audioCapabilities,n)&&r.hasSameElements(e.videoCapabilities,t.videoCapabilities,n)},shaka.offline.StoredContentUtils=function(){},shaka.offline.StoredContentUtils.fromManifest=function(e,t,r,n){return goog.asserts.assert(t.variants.length,"Cannot create stored content from manifest with no variants."),{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.getDuration(),size:r,expiration:1/0,tracks:t=shaka.offline.StoredContentUtils.getTracks_(t),appMetadata:n,isIncomplete:!1}},shaka.offline.StoredContentUtils.fromManifestDB=function(e,t){goog.asserts.assert(t.streams.length,"Cannot create stored content from manifestDB with no streams.");var r=new shaka.offline.ManifestConverter(e.mechanism(),e.cell()).fromManifestDB(t),n=t.appMetadata||{};return r=shaka.offline.StoredContentUtils.getTracks_(r),goog.asserts.assert(null!=t.expiration,"Manifest expiration must be set by now!"),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:r,appMetadata:n,isIncomplete:t.isIncomplete||!1}},shaka.offline.StoredContentUtils.getTracks_=function(e){for(var t=shaka.util.StreamUtils,r=[],n=t.getPlayableVariants(e.variants),a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next())r.push(t.variantToTrack(a.value));for(n=(e=$jscomp.makeIterator(e.textStreams)).next();!n.done;n=e.next())r.push(t.textStreamToTrack(n.value));return r},shaka.offline.StreamBandwidthEstimator=function(){this.estimateByStreamId_=new Map},shaka.offline.StreamBandwidthEstimator.prototype.addVariant=function(e){var t=e.audio,r=e.video;if(t&&!r&&this.setBitrate_(t.id,t.bandwidth||e.bandwidth),!t&&r&&this.setBitrate_(r.id,r.bandwidth||e.bandwidth),t&&r){var n=t.bandwidth||shaka.offline.StreamBandwidthEstimator.DEFAULT_AUDIO_BITRATE_,a=r.bandwidth||e.bandwidth-n;0>=a&&(shaka.log.warning("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),a=e.bandwidth),this.setBitrate_(t.id,n),this.setBitrate_(r.id,a)}},shaka.offline.StreamBandwidthEstimator.prototype.setBitrate_=function(e,t){this.estimateByStreamId_.set(e,t)},shaka.offline.StreamBandwidthEstimator.prototype.addText=function(e){this.estimateByStreamId_.set(e.id,shaka.offline.StreamBandwidthEstimator.DEFAULT_TEXT_BITRATE_)},shaka.offline.StreamBandwidthEstimator.prototype.addImage=function(e){this.estimateByStreamId_.set(e.id,e.bandwidth||shaka.offline.StreamBandwidthEstimator.DEFAULT_IMAGE_BITRATE_)},shaka.offline.StreamBandwidthEstimator.prototype.getSegmentEstimate=function(e,t){return t=t.endTime-t.startTime,this.getEstimate_(e)*t},shaka.offline.StreamBandwidthEstimator.prototype.getInitSegmentEstimate=function(e){return.5*this.getEstimate_(e)},shaka.offline.StreamBandwidthEstimator.prototype.getEstimate_=function(e){return null==(e=this.estimateByStreamId_.get(e))&&(e=0,shaka.log.error("Asking for bitrate of stream not given to the estimator")),0==e&&shaka.log.warning("Using bitrate of 0, this stream won't affect progress"),e},shaka.offline.StreamBandwidthEstimator.DEFAULT_AUDIO_BITRATE_=393216,shaka.offline.StreamBandwidthEstimator.DEFAULT_TEXT_BITRATE_=52,shaka.offline.StreamBandwidthEstimator.DEFAULT_IMAGE_BITRATE_=2048,shaka.offline.Storage=function(e){var t=this;if(e&&e.constructor!=shaka.Player)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.LOCAL_PLAYER_INSTANCE_REQUIRED);this.networkingEngine_=this.config_=null,e?(this.config_=e.getSharedConfiguration(),this.networkingEngine_=e.getNetworkingEngine(),goog.asserts.assert(this.networkingEngine_,"Storage should not be initialized with a player that had |destroy| called on it.")):(this.config_=shaka.util.PlayerConfiguration.createDefault(),this.networkingEngine_=new shaka.net.NetworkingEngine),this.openOperations_=[],this.openDownloadManagers_=[];var r=!e;this.destroyer_=new shaka.util.Destroyer((function(){var e,n,a,i,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:return o.yield(Promise.all(t.openDownloadManagers_.map((function(e){return e.abortAll()}))),2);case 2:for(e=function(){},n=[],a=$jscomp.makeIterator(t.openOperations_),i=a.next();!i.done;i=a.next())s=i.value,n.push(s.then(e,e));return o.yield(Promise.all(n),3);case 3:if(!r){o.jumpTo(4);break}return o.yield(t.networkingEngine_.destroy(),4);case 4:t.config_=null,t.networkingEngine_=null,o.jumpToEnd()}}))})),this.nextExternalStreamId_=1e9},shaka.offline.Storage.support=function(){return!!shaka.util.Platform.supportsMediaSource()&&shaka.offline.StorageMuxer.support()},shaka.offline.Storage.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.offline.Storage.prototype.configure=function(e,t){return goog.asserts.assert("object"==typeof e||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=shaka.util.ConfigUtils.convertToConfigObject(e,t)),goog.asserts.assert("object"==typeof e,"Should be an object!"),goog.asserts.assert(this.config_,"Cannot reconfigure storage after calling destroy."),shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,e)},shaka.offline.Storage.prototype.getConfiguration=function(){goog.asserts.assert(this.config_,"Config must not be null!");var e=shaka.util.PlayerConfiguration.createDefault();return shaka.util.PlayerConfiguration.mergeConfigObjects(e,this.config_,shaka.util.PlayerConfiguration.createDefault()),e},shaka.offline.Storage.prototype.getNetworkingEngine=function(){return this.networkingEngine_},shaka.offline.Storage.prototype.store=function(e,t,r,n,a){var i=this;goog.asserts.assert(this.networkingEngine_,"Cannot call |store| after calling |destroy|.");var s=this.getConfiguration(),o=new shaka.offline.DownloadManager(this.networkingEngine_);return this.openDownloadManagers_.push(o),t=this.store_(e,t||{},n||[],a||[],(function(){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(goog.asserts.assert(i.networkingEngine_,"Should not call |store| after |destroy|"),r?n.jumpTo(2):n.yield(shaka.net.NetworkingUtils.getMimeType(e,i.networkingEngine_,s.manifest.retryParameters),3)):(2!=n.nextAddress&&(r=n.yieldResult),t=shaka.media.ManifestParser.getFactory(e,r||null),n.return(t()))}))}),s,o),(t=new shaka.util.AbortableOperation(t,(function(){return o.abortAll()}))).finally((function(){shaka.util.ArrayUtils.remove(i.openDownloadManagers_,o)})),this.startAbortableOperation_(t)},shaka.offline.Storage.prototype.store_=function(e,t,r,n,a,i,s){var o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(R){switch(R.nextAddress){case 1:return w.requireSupport_(),l=o=null,u=new shaka.offline.StorageMuxer,p=d=c=null,R.setCatchFinallyBlocks(2,3),R.yield(a(),5);case 5:return o=R.yieldResult,R.yield(w.parseManifest(e,o,i),6);case 6:if(h=R.yieldResult,w.ensureNotDestroyed_(),!(!h.presentationTimeline.isLive()&&!h.presentationTimeline.isInProgress()))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.CANNOT_STORE_LIVE_OFFLINE,e);f=$jscomp.makeIterator(r),m=f.next();case 7:if(m.done){R.jumpTo(9);break}return g=m.value,R.yield(w.createExternalImageStream_(g,h),10);case 10:y=R.yieldResult,h.imageStreams.push(y),w.ensureNotDestroyed_(),m=f.next(),R.jumpTo(7);break;case 9:v=$jscomp.makeIterator(n),_=v.next();case 11:return _.done?(shaka.drm.DrmEngine.configureClearKey(i.drm.clearKeys,h.variants),b=h.variants.some((function(e){if(e.audio)for(var t=$jscomp.makeIterator(e.audio.drmInfos),r=t.next();!r.done;r=t.next())if(r.value.licenseServerUri.startsWith("data:"))return!0;if(e.video)for(t=(e=$jscomp.makeIterator(e.video.drmInfos)).next();!t.done;t=e.next())if(t.value.licenseServerUri.startsWith("data:"))return!0;return!1})),T=i.offline.usePersistentLicense,b&&(T=!1),R.yield(w.createDrmEngine(h,(function(e){p=p||e}),i,T),15)):(k=_.value,R.yield(w.createExternalTextStream_(h,k.uri,k.language,k.kind,k.mime,k.codecs),14));case 14:E=R.yieldResult,h.textStreams.push(E),w.ensureNotDestroyed_(),_=v.next(),R.jumpTo(11);break;case 15:if(l=R.yieldResult,w.ensureNotDestroyed_(),p)throw p;return R.yield(w.filterManifest_(h,l,i,T),16);case 16:return R.yield(u.init(),17);case 17:return w.ensureNotDestroyed_(),R.yield(u.getActive(),18);case 18:return c=R.yieldResult,w.ensureNotDestroyed_(),goog.asserts.assert(l,"drmEngine should be non-null here."),A=w.makeManifestDB_(l,h,e,t,i,s,T),S=A.manifestDB,P=A.toDownload,R.yield(c.cell.addManifests([S]),19);case 19:if(C=R.yieldResult,w.ensureNotDestroyed_(),d=C[0],goog.asserts.assert(l,"drmEngine should be non-null here."),w.ensureNotDestroyed_(),p)throw p;return R.yield(w.downloadSegments_(P,d,S,s,i,c.cell,h,l,T),20);case 20:return w.ensureNotDestroyed_(),w.setManifestDrmFields_(h,S,l,T),R.yield(c.cell.updateManifest(d,S),21);case 21:return w.ensureNotDestroyed_(),x=shaka.offline.OfflineUri.manifest(c.path.mechanism,c.path.cell,d),R.return(shaka.offline.StoredContentUtils.fromManifestDB(x,S));case 3:return R.enterFinallyBlock(),R.yield(u.destroy(),22);case 22:if(!o){R.jumpTo(23);break}return R.yield(o.stop(),23);case 23:if(!l){R.jumpTo(25);break}return R.yield(l.destroy(),25);case 25:R.leaveFinallyBlock(0);break;case 2:if(I=R.enterCatchBlock(),null==d){R.jumpTo(27);break}return R.yield(shaka.offline.Storage.cleanStoredManifest(d),27);case 27:throw p||I}}))},shaka.offline.Storage.prototype.downloadSegments_=function(e,t,r,n,a,i,s,o,l){var u,c,d,p,h,f,m,g,y,v,_,k=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(E){switch(E.nextAddress){case 1:if(u={},c=0,d=function(){if(k.destroyer_.destroyed()||n.isAborted())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.OPERATION_ABORTED)},p=function(e,p){var h,f,m,g,y,v,_,E,b;return $jscomp.asyncExecutePromiseGeneratorProgram((function(T){if(1==T.nextAddress){for(h=$jscomp.makeIterator(e),f=h.next(),m={};!f.done;m={download$jscomp$1:void 0},f=h.next())m.download$jscomp$1=f.value,d(),g=m.download$jscomp$1.makeSegmentRequest(a),y=m.download$jscomp$1.estimateId,v=m.download$jscomp$1.isInitSegment,_=function(e){return function(t){var r,n,a,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:if(r=e.download$jscomp$1.ref,n=r.getSegmentData(!1),!r.aesKey||n){o.jumpTo(2);break}return o.yield(shaka.media.SegmentUtils.aesDecrypt(t,r.aesKey,e.download$jscomp$1.refPosition),3);case 3:t=o.yieldResult;case 2:return a=shaka.offline.DownloadInfo.idForSegmentRef(r),o.yield(i.addSegments([{data:t}]),4);case 4:s=o.yieldResult,d(),u[a]=s[0],c+=t.byteLength,o.jumpToEnd()}}))}}(m),E=m.download$jscomp$1.ref,(b=E.getSegmentData(!1))?n.queueData(m.download$jscomp$1.groupId,b,y,v,_):n.queue(m.download$jscomp$1.groupId,g,y,v,_);return T.yield(n.waitToFinish(),2)}return d(),!p||n.isAborted()?T.jumpTo(0):(k.setManifestDrmFields_(s,r,o,l),T.yield(i.updateManifest(t,r),0))}))},h=!1,E.setCatchFinallyBlocks(2),!k.getManifestIsEncrypted_(s)||!h||k.getManifestIncludesInitData_(s)){E.jumpTo(4);break}return E.yield(p(e.filter((function(e){return e.isInitSegment})),!0),5);case 5:return d(),e=e.filter((function(e){return!e.isInitSegment})),f=u,m=c,u={},c=0,E.yield(shaka.offline.Storage.assignSegmentsToManifest(i,t,r,f,m,(function(){return k.ensureNotDestroyed_()})),6);case 6:d();case 4:if(h){E.jumpTo(7);break}return E.yield(p(e,!1),8);case 8:return d(),g=u,y=c,u={},c=0,E.yield(shaka.offline.Storage.assignSegmentsToManifest(i,t,r,g,y,(function(){return d()})),9);case 9:d(),goog.asserts.assert(!r.isIncomplete,"The manifest should be complete by now");case 7:E.leaveTryBlock(0);break;case 2:return v=E.enterCatchBlock(),_=Object.values(u),E.yield(i.removeSegments(_,(function(e){})),10);case 10:throw v}}))},shaka.offline.Storage.cleanStoredManifest=function(e){var t,r,n,a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){switch(i.nextAddress){case 1:return t=new shaka.offline.StorageMuxer,i.yield(t.init(),2);case 2:return i.yield(t.getActive(),3);case 3:return r=i.yieldResult,n=shaka.offline.OfflineUri.manifest(r.path.mechanism,r.path.cell,e),i.yield(t.destroy(),4);case 4:return a=new shaka.offline.Storage,i.yield(a.remove(n.toString()),0)}}))},shaka.offline.Storage.assignSegmentsToManifest=function(e,t,r,n,a,i){var s,o,l,u,c,d,p,h,f,m,g;return $jscomp.asyncExecutePromiseGeneratorProgram((function(y){switch(y.nextAddress){case 1:for(s=!1,y.setCatchFinallyBlocks(2),o=!0,l=$jscomp.makeIterator(r.streams),u=l.next();!u.done;u=l.next())for(c=u.value,d=$jscomp.makeIterator(c.segments),p=d.next();!p.done;p=d.next())h=p.value,null!=(f=h.pendingSegmentRefId?n[h.pendingSegmentRefId]:null)&&(h.dataKey=f,h.pendingSegmentRefId=void 0),null!=(f=h.pendingInitSegmentRefId?n[h.pendingInitSegmentRefId]:null)&&(h.initSegmentKey=f,h.pendingInitSegmentRefId=void 0),h.pendingSegmentRefId&&(o=!1),h.pendingInitSegmentRefId&&(o=!1);return r.size+=a,o&&(r.isIncomplete=!1),y.yield(e.updateManifest(t,r),4);case 4:s=!0,i(),y.leaveTryBlock(0);break;case 2:return m=y.enterCatchBlock(),y.yield(shaka.offline.Storage.cleanStoredManifest(t),5);case 5:if(s){y.jumpTo(6);break}return g=Object.values(n),y.yield(e.removeSegments(g,(function(e){})),6);case 6:throw m}}))},shaka.offline.Storage.prototype.filterManifest_=function(e,t,r,n){var a,i,s,o,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,P,C,x,I,w,R,M;return $jscomp.asyncExecutePromiseGeneratorProgram((function(D){switch(D.nextAddress){case 1:return a={width:1/0,height:1/0},shaka.util.StreamUtils.filterByRestrictions(e,r.restrictions,a),D.yield(shaka.util.StreamUtils.filterManifestByMediaCapabilities(t,e,n,r.drm.preferredKeySystems,r.drm.keySystemsMapping),2);case 2:for(i=[],s=r.preferredDecodingAttributes,o=r.preferredVideoCodecs,l=r.preferredAudioCodecs,u=r.preferredTextFormats,shaka.util.StreamUtils.chooseCodecsAndFilterManifest(e,o,l,s,u),c=$jscomp.makeIterator(e.variants),d=c.next();!d.done;d=c.next())p=d.value,goog.asserts.assert(shaka.util.StreamUtils.isPlayable(p),'We should have already filtered by "is playable"'),i.push(shaka.util.StreamUtils.variantToTrack(p));for(h=$jscomp.makeIterator(e.textStreams),f=h.next();!f.done;f=h.next())m=f.value,i.push(shaka.util.StreamUtils.textStreamToTrack(m));for(g=$jscomp.makeIterator(e.imageStreams),y=g.next();!y.done;y=g.next())v=y.value,i.push(shaka.util.StreamUtils.imageStreamToTrack(v));return D.yield(r.offline.trackSelectionCallback(i),3);case 3:for(_=D.yieldResult,k=e.presentationTimeline.getDuration(),E=0,b=$jscomp.makeIterator(_),T=b.next();!T.done;T=b.next())A=T.value,S=A.bandwidth*k/8,E+=S;return D.setCatchFinallyBlocks(4),D.yield(r.offline.downloadSizeCallback(E),6);case 6:if(!D.yieldResult)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.STORAGE_LIMIT_REACHED);D.leaveTryBlock(5);break;case 4:if((P=D.enterCatchBlock())instanceof shaka.util.Error)throw P;throw shaka.log.warning("downloadSizeCallback has produced an unexpected error",P),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.DOWNLOAD_SIZE_CALLBACK_ERROR);case 5:for(C=new Set,x=new Set,I=new Set,w=$jscomp.makeIterator(_),R=w.next();!R.done;R=w.next())"variant"==(M=R.value).type&&C.add(M.id),"text"==M.type&&x.add(M.id),"image"==M.type&&I.add(M.id);e.variants=e.variants.filter((function(e){return C.has(e.id)})),e.textStreams=e.textStreams.filter((function(e){return x.has(e.id)})),e.imageStreams=e.imageStreams.filter((function(e){return I.has(e.id)})),shaka.offline.Storage.validateManifest_(e),D.jumpToEnd()}}))},shaka.offline.Storage.prototype.makeManifestDB_=function(e,t,r,n,a,i,s){var o=shaka.offline.StoredContentUtils.fromManifest(r,t,0,n),l=a.offline.progressCallback;i.setCallbacks((function(e,t){o.size=t,l(o,e)}),(function(t,r){u&&s&&c==r&&e.newInitData("cenc",t)}));var u=this.getManifestIsEncrypted_(t)&&!this.getManifestIncludesInitData_(t),c=null;if(u){var d=e.getDrmInfo();c=shaka.offline.Storage.defaultSystemIds_.get(d.keySystem)}d=new shaka.offline.StreamBandwidthEstimator;for(var p=$jscomp.makeIterator(t.textStreams),h=p.next();!h.done;h=p.next())d.addText(h.value);for(h=(p=$jscomp.makeIterator(t.imageStreams)).next();!h.done;h=p.next())d.addImage(h.value);for(h=(p=$jscomp.makeIterator(t.variants)).next();!h.done;h=p.next())d.addVariant(h.value);return a=(i=this.createStreams_(i,d,e,t,a)).streams,i=i.toDownload,(d=e.getDrmInfo())&&s&&(d.initData=[]),{manifestDB:{creationTime:Date.now(),originalManifestUri:r,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.getExpiration(),streams:a,sessionIds:s?e.getSessionIds():[],drmInfo:d,appMetadata:n,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},toDownload:i}},shaka.offline.Storage.prototype.getManifestIsEncrypted_=function(e){return e.variants.some((function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t}))},shaka.offline.Storage.prototype.getManifestIncludesInitData_=function(e){return e.variants.some((function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some((function(e){return e.initData&&e.initData.length}))}))},shaka.offline.Storage.prototype.setManifestDrmFields_=function(e,t,r,n){if(t.expiration=r.getExpiration(),r=r.getSessionIds(),t.sessionIds=n?r:[],this.getManifestIsEncrypted_(e)&&n&&!r.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.NO_INIT_DATA_FOR_OFFLINE)},shaka.offline.Storage.prototype.remove=function(e){return this.startOperation_(this.remove_(e))},shaka.offline.Storage.prototype.remove_=function(e){var t,r,n,a,i,s,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(o.requireSupport_(),null==(t=shaka.offline.OfflineUri.parse(e))||!t.isManifest())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,e);return r=t,n=new shaka.offline.StorageMuxer,l.setFinallyBlock(2),l.yield(n.init(),4);case 4:return l.yield(n.getCell(r.mechanism(),r.cell()),5);case 5:return a=l.yieldResult,l.yield(a.getManifests([r.key()]),6);case 6:return i=l.yieldResult,s=i[0],l.yield(Promise.all([o.removeFromDRM_(r,s,n),o.removeFromStorage_(a,r,s)]),2);case 2:return l.enterFinallyBlock(),l.yield(n.destroy(),8);case 8:l.leaveFinallyBlock(0)}}))},shaka.offline.Storage.getCapabilities_=function(e,t){for(var r=shaka.util.MimeUtils,n=[],a=$jscomp.makeIterator(e.streams),i=a.next();!i.done;i=a.next())i=i.value,t&&"video"==i.type?n.push({contentType:r.getFullType(i.mimeType,i.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=i.type||n.push({contentType:r.getFullType(i.mimeType,i.codecs),robustness:e.drmInfo.audioRobustness});return n},shaka.offline.Storage.prototype.removeFromDRM_=function(e,t,r){var n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return goog.asserts.assert(n.networkingEngine_,"Cannot be destroyed"),e.yield(shaka.offline.Storage.deleteLicenseFor_(n.networkingEngine_,n.config_.drm,r,t),0)}))},shaka.offline.Storage.prototype.removeFromStorage_=function(e,t,r){var n=this,a=shaka.offline.Storage.getAllSegmentIds_(r),i=a.length+1,s=0,o=shaka.offline.StoredContentUtils.fromManifestDB(t,r);return r=function(e){s+=1,n.config_.offline.progressCallback(o,s/i)},Promise.all([e.removeSegments(a,r),e.removeManifests([t.key()],r)])},shaka.offline.Storage.prototype.removeEmeSessions=function(){return this.startOperation_(this.removeEmeSessions_())},shaka.offline.Storage.prototype.removeEmeSessions_=function(){var e,t,r,n,a,i,s,o,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){switch(p.nextAddress){case 1:return d.requireSupport_(),goog.asserts.assert(d.networkingEngine_,"Cannot be destroyed"),e=d.networkingEngine_,t=d.config_.drm,r=new shaka.offline.StorageMuxer,n=new shaka.offline.SessionDeleter,a=!1,p.setFinallyBlock(2),p.yield(r.init(),4);case 4:i=[],r.forEachEmeSessionCell((function(e){return i.push(e)})),s=$jscomp.makeIterator(i),o=s.next();case 5:if(o.done){p.jumpTo(2);break}return l=o.value,p.yield(l.getAll(),8);case 8:return u=p.yieldResult,p.yield(n.delete(t,e,u),9);case 9:return c=p.yieldResult,p.yield(l.remove(c),10);case 10:c.length!=u.length&&(a=!0),o=s.next(),p.jumpTo(5);break;case 2:return p.enterFinallyBlock(),p.yield(r.destroy(),11);case 11:p.leaveFinallyBlock(3);break;case 3:return p.return(!a)}}))},shaka.offline.Storage.prototype.list=function(){return this.startOperation_(this.list_())},shaka.offline.Storage.prototype.list_=function(){var e,t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){switch(a.nextAddress){case 1:return n.requireSupport_(),e=[],t=new shaka.offline.StorageMuxer,a.setFinallyBlock(2),a.yield(t.init(),4);case 4:return r=Promise.resolve(),t.forEachCell((function(t,n){r=r.then((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(n.getAllManifests(),2);r.yieldResult.forEach((function(r,n){n=shaka.offline.OfflineUri.manifest(t.mechanism,t.cell,n),r=shaka.offline.StoredContentUtils.fromManifestDB(n,r),e.push(r)})),r.jumpToEnd()}))}))})),a.yield(r,2);case 2:return a.enterFinallyBlock(),a.yield(t.destroy(),6);case 6:a.leaveFinallyBlock(3);break;case 3:return a.return(e)}}))},shaka.offline.Storage.prototype.parseManifest=function(e,t,r){var n,a,i,s,o,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress)return n=null,a=l.networkingEngine_,goog.asserts.assert(a,"Should be initialized!"),i={networkingEngine:a,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(e){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){n=e},isLowLatencyMode:function(){return!1},updateDuration:function(){},newDrmInfo:function(e){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return r.abr.defaultBandwidthEstimate},onMetadata:function(){},disableStream:function(e){},addFont:function(e,t){}},t.configure(r.manifest),l.ensureNotDestroyed_(),u.yield(t.start(e,i),2);if(3!=u.nextAddress)return s=u.yieldResult,l.ensureNotDestroyed_(),o=shaka.offline.Storage.getAllStreamsFromManifest_(s),u.yield(Promise.all(shaka.util.Iterables.map(o,(function(e){return e.createSegmentIndex()}))),3);if(l.ensureNotDestroyed_(),n)throw n;return u.return(s)}))},shaka.offline.Storage.prototype.createExternalImageStream_=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h,f,m,g,y=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){switch(v.nextAddress){case 1:return v.yield(y.getTextMimetype_(e),2);case 2:if("text/vtt"!=(r=v.yieldResult))throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.UNSUPPORTED_EXTERNAL_THUMBNAILS_URI,e);return goog.asserts.assert(y.networkingEngine_,"Need networking engine."),v.yield(y.getTextData_(e,y.networkingEngine_,y.config_.streaming.retryParameters),3);case 3:if(n=v.yieldResult,!(a=shaka.text.TextEngine.findParser(r)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,r);for(i=a(),s={periodStart:0,segmentStart:0,segmentEnd:t.presentationTimeline.getDuration(),vttOffset:0},o=shaka.util.BufferUtils.toUint8(n),l=i.parseMedia(o,s,e,[]),u=[],c=$jscomp.makeIterator(l),d=c.next(),p={};!d.done;p={uris$jscomp$26:void 0,cue$jscomp$43:void 0},d=c.next())p.cue$jscomp$43=d.value,p.uris$jscomp$26=null,h=function(t){return function(){return null==t.uris$jscomp$26&&(t.uris$jscomp$26=shaka.util.ManifestParserUtils.resolveUris([e],[t.cue$jscomp$43.payload])),t.uris$jscomp$26||[]}}(p),f=new shaka.media.SegmentReference(p.cue$jscomp$43.startTime,p.cue$jscomp$43.endTime,h,0,null,null,0,0,1/0),p.cue$jscomp$43.payload.includes("#xywh")&&(4===(m=p.cue$jscomp$43.payload.split("#xywh=")[1].split(",")).length&&f.setThumbnailSprite({height:parseInt(m[3],10),positionX:parseInt(m[0],10),positionY:parseInt(m[1],10),width:parseInt(m[2],10)})),u.push(f);if(g=r,!u.length){v.jumpTo(4);break}return v.yield(shaka.net.NetworkingUtils.getMimeType(u[0].getUris()[0],y.networkingEngine_,y.config_.manifest.retryParameters),5);case 5:g=v.yieldResult;case 4:return v.return({id:y.nextExternalStreamId_++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new shaka.media.SegmentIndex(u),mimeType:g||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:shaka.util.ManifestParserUtils.ContentType.IMAGE,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(g||"","")]),isAudioMuxedInVideo:!1,baseOriginalId:null})}}))},shaka.offline.Storage.prototype.createExternalTextStream_=function(e,t,r,n,a,i){var s,o,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress)return a?u.jumpTo(2):u.yield(l.getTextMimetype_(t),3);if(2!=u.nextAddress&&(a=u.yieldResult),s={id:l.nextExternalStreamId_++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:shaka.media.SegmentIndex.forSingleSegment(0,e.presentationTimeline.getDuration(),[t]),mimeType:a||"",codecs:i||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:r,originalLanguage:r,label:null,type:shaka.util.ManifestParserUtils.ContentType.TEXT,primary:!1,trickModeVideo:null,dependencyStream:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(a||"",i||"")]),isAudioMuxedInVideo:!1,baseOriginalId:null},o=shaka.util.MimeUtils.getFullType(s.mimeType,s.codecs),!shaka.text.TextEngine.isTypeSupported(o))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,a);return u.return(s)}))},shaka.offline.Storage.prototype.getTextMimetype_=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){switch(n.nextAddress){case 1:return n.setCatchFinallyBlocks(2),goog.asserts.assert(r.networkingEngine_,"Need networking engine."),n.yield(shaka.net.NetworkingUtils.getMimeType(e,r.networkingEngine_,r.config_.streaming.retryParameters),4);case 4:t=n.yieldResult,n.leaveTryBlock(3);break;case 2:n.enterCatchBlock();case 3:if(t)return n.return(t);throw shaka.log.error("The mimeType has not been provided and it could not be deduced from its uri."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.TEXT_COULD_NOT_GUESS_MIME_TYPE,e)}}))},shaka.offline.Storage.prototype.getTextData_=function(e,t,r){var n,a,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(n=shaka.net.NetworkingEngine.RequestType.SEGMENT,(a=shaka.net.NetworkingEngine.makeRequest([e],r)).method="GET",s.yield(t.request(n,a).promise,2)):(i=s.yieldResult,s.return(i.data))}))},shaka.offline.Storage.prototype.createDrmEngine=function(e,t,r,n){var a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(goog.asserts.assert(i.networkingEngine_,"Cannot call |createDrmEngine| after |destroy|"),(a=new shaka.drm.DrmEngine({netEngine:i.networkingEngine_,onError:t,onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}})).configure(r.drm),s.yield(a.initForStorage(e.variants,n),2)):3!=s.nextAddress?s.yield(a.createOrLoad(),3):s.return(a)}))},shaka.offline.Storage.prototype.createStreams_=function(e,t,r,n,a){r=new Map;for(var i=shaka.offline.Storage.getAllStreamsFromManifest_(n),s=new Map,o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next()){o=o.value;var l=this.createStream_(e,t,n,o,a,r);s.set(o.id,l)}for(t=(e=$jscomp.makeIterator(n.variants)).next();!t.done;t=e.next())(t=t.value).audio&&s.get(t.audio.id).variantIds.push(t.id),t.video&&s.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(s.values()),toDownload:Array.from(r.values())}},shaka.offline.Storage.prototype.createStream_=function(e,t,r,n,a,i){var s={id:n.id,originalId:n.originalId,groupId:n.groupId,primary:n.primary,type:n.type,mimeType:n.mimeType,codecs:n.codecs,frameRate:n.frameRate,pixelAspectRatio:n.pixelAspectRatio,hdr:n.hdr,colorGamut:n.colorGamut,videoLayout:n.videoLayout,kind:n.kind,language:n.language,originalLanguage:n.originalLanguage,label:n.label,width:n.width||null,height:n.height||null,encrypted:n.encrypted,keyIds:n.keyIds,segments:[],variantIds:[],roles:n.roles,forced:n.forced,channelsCount:n.channelsCount,audioSamplingRate:n.audioSamplingRate,spatialAudio:n.spatialAudio,closedCaptions:n.closedCaptions,tilesLayout:n.tilesLayout,mssPrivateData:n.mssPrivateData,external:n.external,fastSwitching:n.fastSwitching,isAudioMuxedInVideo:n.isAudioMuxedInVideo};r=r.presentationTimeline.getSegmentAvailabilityStart();var o=a.offline.numberOfParallelDownloads,l=0===o?n.id:0;return shaka.offline.Storage.forEachSegment_(n,r,(function(r,a){var u=shaka.offline.DownloadInfo.idForSegmentRef(r),c=void 0;if(!i.has(u)){var d=e.addDownloadEstimate(t.getSegmentEstimate(n.id,r));d=new shaka.offline.DownloadInfo(r,d,l,!1,a),i.set(u,d)}r.initSegmentReference&&(c=shaka.offline.DownloadInfo.idForSegmentRef(r.initSegmentReference),i.has(c)||(d=e.addDownloadEstimate(t.getInitSegmentEstimate(n.id)),a=new shaka.offline.DownloadInfo(r.initSegmentReference,d,l,!0,a),i.set(c,a))),s.segments.push({pendingInitSegmentRefId:c,initSegmentKey:c?0:null,startTime:r.startTime,endTime:r.endTime,appendWindowStart:r.appendWindowStart,appendWindowEnd:r.appendWindowEnd,timestampOffset:r.timestampOffset,tilesLayout:r.tilesLayout,pendingSegmentRefId:u,dataKey:0,mimeType:r.mimeType,codecs:r.codecs,thumbnailSprite:r.thumbnailSprite}),0!==o&&(l=(l+1)%o)})),s},shaka.offline.Storage.forEachSegment_=function(e,t,r){if(null!=(t=e.segmentIndex.find(t)))for(var n=e.segmentIndex.get(t);n;)r(n,t),n=e.segmentIndex.get(++t)},shaka.offline.Storage.prototype.ensureNotDestroyed_=function(){if(this.destroyer_.destroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.OPERATION_ABORTED)},shaka.offline.Storage.prototype.requireSupport_=function(){if(!shaka.offline.Storage.support())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.STORAGE_NOT_SUPPORTED)},shaka.offline.Storage.prototype.startOperation_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(t.openOperations_.push(e),r.setFinallyBlock(2),r.yield(e,4)):2!=r.nextAddress?r.return(r.yieldResult):(r.enterFinallyBlock(),shaka.util.ArrayUtils.remove(t.openOperations_,e),r.leaveFinallyBlock(0))}))},shaka.offline.Storage.prototype.startAbortableOperation_=function(e){var t=this,r=e.promise;return this.openOperations_.push(r),e.finally((function(){shaka.util.ArrayUtils.remove(t.openOperations_,r)}))},shaka.offline.Storage.getAllSegmentIds_=function(e){for(var t=new Set,r=(e=$jscomp.makeIterator(e.streams)).next();!r.done;r=e.next())for(var n=(r=$jscomp.makeIterator(r.value.segments)).next();!n.done;n=r.next())null!=(n=n.value).initSegmentKey&&t.add(n.initSegmentKey),t.add(n.dataKey);return Array.from(t)},shaka.offline.Storage.deleteAll=function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?(e=new shaka.offline.StorageMuxer,t.setFinallyBlock(2),t.yield(e.erase(),2)):5!=t.nextAddress?(t.enterFinallyBlock(),t.yield(e.destroy(),5)):t.leaveFinallyBlock(0)}))},shaka.offline.Storage.deleteLicenseFor_=function(e,t,r,n){var a,i,s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return 1==l.nextAddress?n.drmInfo?(a=r.getEmeSessionCell(),i=n.sessionIds.map((function(e){return{sessionId:e,keySystem:n.drmInfo.keySystem,licenseUri:n.drmInfo.licenseServerUri,serverCertificate:n.drmInfo.serverCertificate,audioCapabilities:shaka.offline.Storage.getCapabilities_(n,!1),videoCapabilities:shaka.offline.Storage.getCapabilities_(n,!0)}})),s=new shaka.offline.SessionDeleter,l.yield(s.delete(t,e,i),2)):l.return():3!=l.nextAddress?(o=l.yieldResult,l.yield(a.remove(o),3)):l.yield(a.add(i.filter((function(e){return!o.includes(e.sessionId)}))),0)}))},shaka.offline.Storage.getAllStreamsFromManifest_=function(e){for(var t=new Set,r=$jscomp.makeIterator(e.variants),n=r.next();!n.done;n=r.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video);for(n=(r=$jscomp.makeIterator(e.textStreams)).next();!n.done;n=r.next())t.add(n.value);for(r=(e=$jscomp.makeIterator(e.imageStreams)).next();!r.done;r=e.next())t.add(r.value);return t},shaka.offline.Storage.validateManifest_=function(e){var t=new Set(e.variants.map((function(e){return e.video}))),r=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams,1<t.size&&shaka.log.warning("Multiple video tracks selected to be stored");for(var n=(t=$jscomp.makeIterator(r)).next();!n.done;n=t.next()){n=n.value;for(var a=$jscomp.makeIterator(r),i=a.next();!i.done;i=a.next())n!=(i=i.value)&&n.language==i.language&&shaka.log.warning("Similar audio tracks were selected to be stored",n.id,i.id)}for(t=(r=$jscomp.makeIterator(e)).next();!t.done;t=r.next())for(t=t.value,a=(n=$jscomp.makeIterator(e)).next();!a.done;a=n.next())t!=(a=a.value)&&t.language==a.language&&shaka.log.warning("Similar text tracks were selected to be stored",t.id,a.id)},goog.exportSymbol("shaka.offline.Storage",shaka.offline.Storage),goog.exportProperty(shaka.offline.Storage,"deleteAll",shaka.offline.Storage.deleteAll),goog.exportProperty(shaka.offline.Storage.prototype,"list",shaka.offline.Storage.prototype.list),goog.exportProperty(shaka.offline.Storage.prototype,"removeEmeSessions",shaka.offline.Storage.prototype.removeEmeSessions),goog.exportProperty(shaka.offline.Storage.prototype,"remove",shaka.offline.Storage.prototype.remove),goog.exportProperty(shaka.offline.Storage.prototype,"store",shaka.offline.Storage.prototype.store),goog.exportProperty(shaka.offline.Storage.prototype,"getNetworkingEngine",shaka.offline.Storage.prototype.getNetworkingEngine),goog.exportProperty(shaka.offline.Storage.prototype,"getConfiguration",shaka.offline.Storage.prototype.getConfiguration),goog.exportProperty(shaka.offline.Storage.prototype,"configure",shaka.offline.Storage.prototype.configure),goog.exportProperty(shaka.offline.Storage.prototype,"destroy",shaka.offline.Storage.prototype.destroy),goog.exportProperty(shaka.offline.Storage,"support",shaka.offline.Storage.support),shaka.offline.Storage.defaultSystemIds_=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.huawei.wiseplay","3d5e6d359b9a41e8b843dd3c6e72c42c"),shaka.Player.registerSupportPlugin("offline",shaka.offline.Storage.support),shaka.polyfill=function(){},shaka.polyfill.installAll=function(){for(var e=$jscomp.makeIterator(shaka.polyfill.polyfills_),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(e){shaka.log.alwaysWarn("Error installing polyfill!",e)}}},shaka.polyfill.register=function(e,t){for(e={priority:t||0,callback:e},t=0;t<shaka.polyfill.polyfills_.length;t++)if(shaka.polyfill.polyfills_[t].priority<e.priority)return void shaka.polyfill.polyfills_.splice(t,0,e);shaka.polyfill.polyfills_.push(e)},goog.exportSymbol("shaka.polyfill",shaka.polyfill),goog.exportProperty(shaka.polyfill,"register",shaka.polyfill.register),goog.exportProperty(shaka.polyfill,"installAll",shaka.polyfill.installAll),shaka.polyfill.polyfills_=[],shaka.polyfill.Aria=function(){},shaka.polyfill.Aria.install=function(){if(Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))shaka.log.info("Using native ARIAMixin interface.");else{shaka.log.info("ARIAMixin interface not detected. Installing polyfill.");for(var e=$jscomp.makeIterator(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())shaka.polyfill.Aria.addARIAMixinAttribute_(t.value)}},shaka.polyfill.Aria.addARIAMixinAttribute_=function(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||null==e?this.removeAttribute(t):this.setAttribute(t,e)}})},goog.exportProperty(shaka.polyfill,"Aria",shaka.polyfill.Aria),goog.exportProperty(shaka.polyfill.Aria,"install",shaka.polyfill.Aria.install),shaka.polyfill.register(shaka.polyfill.Aria.install),shaka.polyfill.EncryptionScheme=function(){},shaka.polyfill.EncryptionScheme.install=function(){shaka.util.Platform.isPS4()||shaka.util.Platform.isSkyQ()||EncryptionSchemePolyfills.install()},goog.exportProperty(shaka.polyfill,"EncryptionScheme",shaka.polyfill.EncryptionScheme),goog.exportProperty(shaka.polyfill.EncryptionScheme,"install",shaka.polyfill.EncryptionScheme.install),shaka.polyfill.register(shaka.polyfill.EncryptionScheme.install,-2),shaka.polyfill.Fullscreen=function(){},shaka.polyfill.Fullscreen.install=function(){if(window.Document){var e=Element.prototype;e.requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,(e=Document.prototype).exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),e=shaka.polyfill.Fullscreen.proxyEvent_,document.addEventListener("webkitfullscreenchange",e),document.addEventListener("webkitfullscreenerror",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("mozfullscreenerror",e),document.addEventListener("MSFullscreenChange",e),document.addEventListener("MSFullscreenError",e)}},shaka.polyfill.Fullscreen.proxyEvent_=function(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),r=document.createEvent("Event");r.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(r)},goog.exportProperty(shaka.polyfill,"Fullscreen",shaka.polyfill.Fullscreen),goog.exportProperty(shaka.polyfill.Fullscreen,"install",shaka.polyfill.Fullscreen.install),shaka.polyfill.register(shaka.polyfill.Fullscreen.install),shaka.polyfill.MediaCapabilities=function(){},shaka.polyfill.MediaCapabilities.install=function(){var e=!0;(shaka.util.Platform.isOlderChromecast()||shaka.util.Platform.isApple()||shaka.util.Platform.isPS5()||shaka.util.Platform.isPS4()||shaka.util.Platform.isWebOS()||shaka.util.Platform.isTizen()||shaka.util.Platform.isHisense()||shaka.util.Platform.isWebkitSTB())&&(e=!1),e&&navigator.mediaCapabilities?shaka.log.info("MediaCapabilities: Native mediaCapabilities support found."):(shaka.log.info("MediaCapabilities: install"),navigator.mediaCapabilities||(navigator.mediaCapabilities={}),shaka.polyfill.MediaCapabilities.originalMcap=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=shaka.polyfill.MediaCapabilities.decodingInfo_)},shaka.polyfill.MediaCapabilities.decodingInfo_=function(e){var t,r,n,a,i,s,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},r=e.video,n=e.audio,"media-source"!=e.type){if("file"!=e.type)return l.return(t);if(r&&(a=r.contentType,!shaka.util.Platform.supportsMediaType(a))||n&&(i=n.contentType,!shaka.util.Platform.supportsMediaType(i)))return l.return(t);l.jumpTo(2);break}if(!shaka.util.Platform.supportsMediaSource())return l.return(t);if(!r){l.jumpTo(3);break}return l.yield(shaka.polyfill.MediaCapabilities.checkVideoSupport_(r),4);case 4:if(!l.yieldResult)return l.return(t);case 3:if(n&&!shaka.polyfill.MediaCapabilities.checkAudioSupport_(n))return l.return(t);case 2:return e.keySystemConfiguration?(s=e.keySystemConfiguration,l.yield(shaka.polyfill.MediaCapabilities.checkDrmSupport_(r,n,s),6)):(t.supported=!0,l.return(t));case 6:(o=l.yieldResult)&&(t.supported=!0,t.keySystemAccess=o);case 5:return l.return(t)}}))},shaka.polyfill.MediaCapabilities.checkVideoSupport_=function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?shaka.util.Platform.isChromecast()?n.yield(shaka.polyfill.MediaCapabilities.canCastDisplayType_(e),3):shaka.util.Platform.isTizen()?(t=e.contentType,e.width&&e.height&&(t+="; width="+e.width,t+="; height="+e.height),e.framerate&&(t+="; framerate="+e.framerate),e.bitrate&&(t+="; bitrate="+e.bitrate),n.return(shaka.media.Capabilities.isTypeSupported(t))):n.jumpTo(2):2!=n.nextAddress?(r=n.yieldResult,n.return(r)):n.return(shaka.media.Capabilities.isTypeSupported(e.contentType))}))},shaka.polyfill.MediaCapabilities.checkAudioSupport_=function(e){var t=e.contentType;return shaka.util.Platform.isChromecast()&&e.spatialRendering&&(t+="; spatialRendering=true"),shaka.media.Capabilities.isTypeSupported(t)},shaka.polyfill.MediaCapabilities.checkDrmSupport_=function(e,t,r){var n,a,i,s,o,l,u,c,d,p,h,f;return $jscomp.asyncExecutePromiseGeneratorProgram((function(m){switch(m.nextAddress){case 1:if(n=shaka.util.MimeUtils,a=[],i=[],r.audio&&(s={robustness:r.audio.robustness||"",contentType:t.contentType},shaka.util.Platform.isTizen()&&t.contentType.includes('codecs="ac-3"')&&(s.contentType='audio/mp4; codecs="ec-3"'),r.audio.encryptionScheme&&(s.encryptionScheme=r.audio.encryptionScheme),a.push(s)),r.video&&(o={robustness:r.video.robustness||"",contentType:e.contentType},r.video.encryptionScheme&&(o.encryptionScheme=r.video.encryptionScheme),i.push(o)),l={initDataTypes:[r.initDataType],distinctiveIdentifier:r.distinctiveIdentifier,persistentState:r.persistentState,sessionTypes:r.sessionTypes},a.length&&(l.audioCapabilities=a),i.length&&(l.videoCapabilities=i),u=e?e.contentType:"",c=t?t.contentType:"",d=n.getBasicType(u)+";"+n.getCodecBase(u),p=n.getBasicType(c)+";"+n.getCodecBase(c),h=r.keySystem,f=null,m.setCatchFinallyBlocks(2),shaka.drm.DrmUtils.hasMediaKeySystemAccess(d,p,h)){f=shaka.drm.DrmUtils.getMediaKeySystemAccess(d,p,h),m.jumpTo(4);break}return m.yield(navigator.requestMediaKeySystemAccess(r.keySystem,[l]),5);case 5:f=m.yieldResult,shaka.drm.DrmUtils.setMediaKeySystemAccess(d,p,h,f);case 4:m.leaveTryBlock(3);break;case 2:m.enterCatchBlock(),shaka.log.info("navigator.requestMediaKeySystemAccess failed.");case 3:return m.return(f)}}))},shaka.polyfill.MediaCapabilities.canCastDisplayType_=function(e){var t,r,n,a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){if(1==i.nextAddress){if(!(window.cast&&cast.__platform__&&cast.__platform__.canDisplayType))return shaka.log.warning("Expected cast APIs to be available! Falling back to shaka.media.Capabilities.isTypeSupported() for type support."),i.return(shaka.media.Capabilities.isTypeSupported(e.contentType));switch(t=e.contentType,e.width&&e.height&&1280<e.width&&720<e.height&&(t+="; width="+e.width+"; height="+e.height),e.framerate&&(24>(r=Math.round(e.framerate))||30<r)&&(t+="; framerate="+e.framerate),e.transferFunction||""){case"":case"srgb":break;case"pq":t+="; eotf=smpte2084";break;case"hlg":t+="; eotf=arib-std-b67";break;default:return i.return(!1)}return n=!1,(a=shaka.polyfill.MediaCapabilities.memoizedCanDisplayTypeRequests_).has(t)?(n=a.get(t),i.jumpTo(2)):i.yield(cast.__platform__.canDisplayType(t),3)}return 2!=i.nextAddress&&(n=i.yieldResult,a.set(t,n)),i.return(n)}))},goog.exportProperty(shaka.polyfill,"MediaCapabilities",shaka.polyfill.MediaCapabilities),goog.exportProperty(shaka.polyfill.MediaCapabilities,"install",shaka.polyfill.MediaCapabilities.install),shaka.polyfill.MediaCapabilities.originalMcap=null,goog.exportProperty(shaka.polyfill.MediaCapabilities,"originalMcap",shaka.polyfill.MediaCapabilities.originalMcap),shaka.polyfill.MediaCapabilities.memoizedCanDisplayTypeRequests_=new Map,shaka.polyfill.register(shaka.polyfill.MediaCapabilities.install,-1),shaka.polyfill.MediaSource=function(){},shaka.polyfill.MediaSource.install=function(){shaka.log.debug("MediaSource.install");var e=shaka.util.Platform.safariVersion();window.MediaSource||window.ManagedMediaSource?e&&window.MediaSource?12>=e?(shaka.log.info("Patching Safari 8-12 MSE bugs."),shaka.polyfill.MediaSource.stubAbort_(),shaka.polyfill.MediaSource.patchRemovalRange_()):15>=e&&(shaka.log.info("Patching Safari 13 & 14 & 15 MSE bugs."),shaka.polyfill.MediaSource.stubAbort_()):shaka.util.Platform.isZenterio()?(shaka.polyfill.MediaSource.stubAbort_(),shaka.polyfill.MediaSource.patchRemovalRange_()):shaka.util.Platform.isTizen2()||shaka.util.Platform.isTizen3()||shaka.util.Platform.isTizen4()?(shaka.log.info("Rejecting Opus."),shaka.polyfill.MediaSource.rejectCodec_("opus")):shaka.log.info("Using native MSE as-is."):shaka.log.info("No MSE implementation available."),(window.MediaSource||window.ManagedMediaSource)&&shaka.polyfill.MediaSource.rejectContainer_("mp2t"),window.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&(shaka.log.info("Patching vp09 support queries."),shaka.polyfill.MediaSource.patchVp09_())},shaka.polyfill.MediaSource.stubAbort_=function(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=$jscomp.getRestArguments.apply(0,arguments);return(t=e.apply(this,t)).abort=function(){},t}},shaka.polyfill.MediaSource.patchRemovalRange_=function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,r){return e.call(this,t,r-.001)}},shaka.polyfill.MediaSource.rejectContainer_=function(e){if(window.MediaSource){var t=MediaSource.isTypeSupported.bind(MediaSource);MediaSource.isTypeSupported=function(r){return shaka.util.MimeUtils.getContainerType(r)!=e&&t(r)}}if(window.ManagedMediaSource){var r=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);window.ManagedMediaSource.isTypeSupported=function(t){return shaka.util.MimeUtils.getContainerType(t)!=e&&r(t)}}},shaka.polyfill.MediaSource.rejectCodec_=function(e){var t=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(r){return shaka.util.MimeUtils.getCodecBase(r)!=e&&t(r)},window.ManagedMediaSource){var r=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);window.ManagedMediaSource.isTypeSupported=function(t){return shaka.util.MimeUtils.getCodecBase(t)!=e&&r(t)}}},shaka.polyfill.MediaSource.patchVp09_=function(){var e=MediaSource.isTypeSupported;shaka.util.Platform.isWebOS()||(MediaSource.isTypeSupported=function(t){var r=t.split(/ *; */),n=r.findIndex((function(e){return e.startsWith("codecs=")}));if(0>n)return e(t);var a=r[n].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),i=a.findIndex((function(e){return e.startsWith("vp09")}));return 0<=i&&(a[i]="vp9",r[n]='codecs="'+a.join(",")+'"',t=r.join("; ")),e(t)})},goog.exportProperty(shaka.polyfill,"MediaSource",shaka.polyfill.MediaSource),goog.exportProperty(shaka.polyfill.MediaSource,"install",shaka.polyfill.MediaSource.install),shaka.polyfill.register(shaka.polyfill.MediaSource.install),shaka.polyfill.Orientation=function(){},shaka.polyfill.Orientation.install=function(){screen.orientation&&screen.orientation.unlock?shaka.log.info("Using native screen.orientation"):null!=screen.orientation?shaka.polyfill.Orientation.installBasedOnScreenMethods_():null!=window.orientation&&shaka.polyfill.Orientation.installBasedOnWindowMethods_()},shaka.polyfill.Orientation.installBasedOnScreenMethods_=function(){void 0===screen.orientation.lock&&(screen.orientation.lock=function(e){return shaka.log.info("screen.orientation.lock is a no-op"),Promise.resolve()}),void 0===screen.orientation.unlock&&(screen.orientation.unlock=function(){shaka.log.info("screen.orientation.unlock is a no-op")})},shaka.polyfill.Orientation.installBasedOnWindowMethods_=function(){var e=new shaka.polyfill.Orientation.FakeOrientation;screen.orientation=e;var t=function(){switch(window.orientation){case-90:e.type="landscape-secondary",e.angle=270;break;case 0:e.type="portrait-primary",e.angle=0;break;case 90:e.type="landscape-primary",e.angle=90;break;case 180:e.type="portrait-secondary",e.angle=180}};t(),window.addEventListener("orientationchange",(function(){t(),e.dispatchChangeEvent()}))},goog.exportProperty(shaka.polyfill,"Orientation",shaka.polyfill.Orientation),goog.exportProperty(shaka.polyfill.Orientation,"install",shaka.polyfill.Orientation.install),shaka.polyfill.Orientation.FakeOrientation=function(){shaka.util.FakeEventTarget.call(this),this.type="",this.angle=0},$jscomp.inherits(shaka.polyfill.Orientation.FakeOrientation,shaka.util.FakeEventTarget),shaka.polyfill.Orientation.FakeOrientation.prototype.dispatchChangeEvent=function(){var e=new shaka.util.FakeEvent("change");this.dispatchEvent(e)},shaka.polyfill.Orientation.FakeOrientation.prototype.lock=function(e){var t=function(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)},r=!1;switch(e){case"natural":r=t("default");break;case"any":r=!0,this.unlock();break;default:r=t(e)}return r?Promise.resolve():((e=Error("screen.orientation.lock() is not available on this device")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},shaka.polyfill.Orientation.FakeOrientation.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},shaka.polyfill.register(shaka.polyfill.Orientation.install),shaka.polyfill.PatchedMediaKeysApple=function(){},shaka.polyfill.PatchedMediaKeysApple.defaultInstall=function(){window.HTMLVideoElement&&window.WebKitMediaKeys&&(navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||shaka.polyfill.PatchedMediaKeysApple.install())},shaka.polyfill.PatchedMediaKeysApple.install=function(e){var t=shaka.polyfill.PatchedMediaKeysApple;window.HTMLVideoElement&&window.WebKitMediaKeys&&(void 0!==e&&e&&(t.enableUninstall=!0,t.originalHTMLMediaElementPrototypeMediaKeys=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),t.originalHTMLMediaElementPrototypeSetMediaKeys=HTMLMediaElement.prototype.setMediaKeys,t.originalWindowMediaKeys=window.MediaKeys,t.originalWindowMediaKeySystemAccess=window.MediaKeySystemAccess,t.originalNavigatorRequestMediaKeySystemAccess=navigator.requestMediaKeySystemAccess),shaka.log.info("Using Apple-prefixed EME"),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=t.setMediaKeys,window.MediaKeys=t.MediaKeys,window.MediaKeySystemAccess=t.MediaKeySystemAccess,navigator.requestMediaKeySystemAccess=t.requestMediaKeySystemAccess,window.shakaMediaKeysPolyfill=t.apiName_,shaka.util.StreamUtils.clearDecodingConfigCache(),shaka.drm.DrmUtils.clearMediaKeySystemAccessMap())},shaka.polyfill.PatchedMediaKeysApple.uninstall=function(){var e=shaka.polyfill.PatchedMediaKeysApple;e.enableUninstall&&(shaka.log.info("Un-installing Apple-prefixed EME"),e.enableUninstall=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",e.originalHTMLMediaElementPrototypeMediaKeys),HTMLMediaElement.prototype.setMediaKeys=e.originalHTMLMediaElementPrototypeSetMediaKeys,window.MediaKeys=e.originalWindowMediaKeys,window.MediaKeySystemAccess=e.originalWindowMediaKeySystemAccess,navigator.requestMediaKeySystemAccess=e.originalNavigatorRequestMediaKeySystemAccess,e.originalWindowMediaKeys=null,e.originalWindowMediaKeySystemAccess=null,e.originalHTMLMediaElementPrototypeSetMediaKeys=null,e.originalNavigatorRequestMediaKeySystemAccess=null,e.originalHTMLMediaElementPrototypeMediaKeys=null,window.shakaMediaKeysPolyfill="",shaka.util.StreamUtils.clearDecodingConfigCache(),shaka.drm.DrmUtils.clearMediaKeySystemAccessMap())},shaka.polyfill.PatchedMediaKeysApple.requestMediaKeySystemAccess=function(e,t){shaka.log.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess"),goog.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');var r=shaka.polyfill.PatchedMediaKeysApple;try{var n=new r.MediaKeySystemAccess(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}},shaka.polyfill.PatchedMediaKeysApple.setMediaKeys=function(e){shaka.log.debug("PatchedMediaKeysApple.setMediaKeys"),goog.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=shaka.polyfill.PatchedMediaKeysApple,r=this.mediaKeys;return r&&r!=e&&(goog.asserts.assert(r instanceof t.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,(this.mediaKeys=e)?(goog.asserts.assert(e instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),e.setMedia(this)):Promise.resolve()},shaka.polyfill.PatchedMediaKeysApple.onWebkitNeedKey_=function(e){if(shaka.log.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e),goog.asserts.assert(this.mediaKeys instanceof shaka.polyfill.PatchedMediaKeysApple.MediaKeys,"non-polyfill instance of newMediaKeys"),goog.asserts.assert(null!=e.initData,"missing init data!"),e=shaka.util.BufferUtils.toUint8(e.initData),shaka.util.BufferUtils.toDataView(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=shaka.util.StringUtils.fromUTF16(e.subarray(4),!0),e=shaka.util.StringUtils.toUTF8(e);var t=new Event("encrypted");t.initDataType="skd",t.initData=shaka.util.BufferUtils.toArrayBuffer(e),this.dispatchEvent(t)},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysApple",shaka.polyfill.PatchedMediaKeysApple),goog.exportProperty(shaka.polyfill.PatchedMediaKeysApple,"uninstall",shaka.polyfill.PatchedMediaKeysApple.uninstall),goog.exportProperty(shaka.polyfill.PatchedMediaKeysApple,"install",shaka.polyfill.PatchedMediaKeysApple.install),shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess=function(e,t){if(shaka.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=e,e.startsWith("com.apple.fps"))for(t=(e=$jscomp.makeIterator(t)).next();!t.done;t=e.next())if(t=this.checkConfig_(t.value))return void(this.configuration_=t);throw(e=Error("Unsupported keySystem")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e},shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess.prototype.checkConfig_=function(e){if("required"==e.persistentState)return null;var t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"],label:e.label},r=!1,n=!1;if(e.audioCapabilities)for(var a=$jscomp.makeIterator(e.audioCapabilities),i=a.next();!i.done;i=a.next())if((i=i.value).contentType){r=!0;var s=i.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,s)&&(t.audioCapabilities.push(i),n=!0)}if(e.videoCapabilities)for(a=(e=$jscomp.makeIterator(e.videoCapabilities)).next();!a.done;a=e.next())(a=a.value).contentType&&(r=!0,i=a.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,i)&&(t.videoCapabilities.push(a),n=!0));return r||(n=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),n?t:null},shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess.prototype.createMediaKeys=function(){shaka.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new shaka.polyfill.PatchedMediaKeysApple.MediaKeys(this.keySystem);return Promise.resolve(e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess.prototype.getConfiguration=function(){return shaka.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.configuration_},shaka.polyfill.PatchedMediaKeysApple.MediaKeys=function(e){shaka.log.debug("PatchedMediaKeysApple.MediaKeys"),this.nativeMediaKeys_=new WebKitMediaKeys(e),this.eventManager_=new shaka.util.EventManager},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.createSession=function(e){if(shaka.log.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new shaka.polyfill.PatchedMediaKeysApple.MediaKeySession(this.nativeMediaKeys_,e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.setServerCertificate=function(e){return shaka.log.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),Promise.resolve(!1)},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.setMedia=function(e){var t=this,r=shaka.polyfill.PatchedMediaKeysApple;if(this.eventManager_.removeAll(),!e)return Promise.resolve();this.eventManager_.listen(e,"webkitneedkey",r.onWebkitNeedKey_);try{return shaka.util.MediaReadyState.waitForReadyState(e,HTMLMediaElement.HAVE_METADATA,this.eventManager_,(function(){e.webkitSetMediaKeys(t.nativeMediaKeys_)})),Promise.resolve()}catch(e){return Promise.reject(e)}},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.getStatusForPolicy=function(e){return Promise.resolve("usable")},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession=function(e,t){shaka.log.debug("PatchedMediaKeysApple.MediaKeySession"),shaka.util.FakeEventTarget.call(this),this.nativeMediaKeySession_=null,this.nativeMediaKeys_=e,this.updatePromise_=this.generateRequestPromise_=null,this.eventManager_=new shaka.util.EventManager,this.sessionId="",this.expiration=NaN,this.closed=new shaka.util.PublicPromise,this.keyStatuses=new shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap},$jscomp.inherits(shaka.polyfill.PatchedMediaKeysApple.MediaKeySession,shaka.util.FakeEventTarget),shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.generateRequest=function(e,t){var r=this;shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.generateRequestPromise_=new shaka.util.PublicPromise;try{var n=this.nativeMediaKeys_.createSession("video/mp4",shaka.util.BufferUtils.toUint8(t));this.nativeMediaKeySession_=n,this.sessionId=n.sessionId||"",this.eventManager_.listen(this.nativeMediaKeySession_,"webkitkeymessage",(function(e){return r.onWebkitKeyMessage_(e)})),this.eventManager_.listen(n,"webkitkeyadded",(function(e){return r.onWebkitKeyAdded_(e)})),this.eventManager_.listen(n,"webkitkeyerror",(function(e){return r.onWebkitKeyError_(e)})),this.updateKeyStatus_("status-pending")}catch(e){this.generateRequestPromise_.reject(e)}return this.generateRequestPromise_},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.load=function(){return shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.update=function(e){shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.updatePromise_=new shaka.util.PublicPromise;try{this.nativeMediaKeySession_.update(shaka.util.BufferUtils.toUint8(e))}catch(e){this.updatePromise_.reject(e)}return this.updatePromise_},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.close=function(){shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.nativeMediaKeySession_.close(),this.closed.resolve(),this.eventManager_.removeAll()}catch(e){this.closed.reject(e)}return this.closed},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.remove=function(){return shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.onWebkitKeyMessage_=function(e){shaka.log.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),goog.asserts.assert(this.generateRequestPromise_,"generateRequestPromise_ should be set before now!"),this.generateRequestPromise_&&(this.generateRequestPromise_.resolve(),this.generateRequestPromise_=null);var t=null==this.keyStatuses.getStatus();e=(new Map).set("messageType",t?"license-request":"license-renewal").set("message",shaka.util.BufferUtils.toArrayBuffer(e.message)),e=new shaka.util.FakeEvent("message",e),this.dispatchEvent(e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.onWebkitKeyAdded_=function(e){shaka.log.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),goog.asserts.assert(!this.generateRequestPromise_,"Key added during generate!"),goog.asserts.assert(this.updatePromise_,"updatePromise_ should be set before now!"),this.updatePromise_&&(this.updateKeyStatus_("usable"),this.updatePromise_.resolve(),this.updatePromise_=null)},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.onWebkitKeyError_=function(e){if(shaka.log.debug("PatchedMediaKeysApple.onWebkitKeyError_",e),(e=Error("EME PatchedMediaKeysApple key error")).errorCode=this.nativeMediaKeySession_.error,null!=this.generateRequestPromise_)this.generateRequestPromise_.reject(e),this.generateRequestPromise_=null;else if(null!=this.updatePromise_)this.updatePromise_.reject(e),this.updatePromise_=null;else switch(this.nativeMediaKeySession_.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:this.updateKeyStatus_("output-not-allowed");break;default:this.updateKeyStatus_("internal-error")}},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.updateKeyStatus_=function(e){this.keyStatuses.setStatus(e),e=new shaka.util.FakeEvent("keystatuseschange"),this.dispatchEvent(e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap=function(){this.size=0,this.status_=void 0},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.setStatus=function(e){this.size=null==e?0:1,this.status_=e},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.getStatus=function(){return this.status_},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.forEach=function(e){this.status_&&e(this.status_,shaka.drm.DrmUtils.DUMMY_KEY_ID.value())},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.get=function(e){if(this.has(e))return this.status_},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.has=function(e){var t=shaka.drm.DrmUtils.DUMMY_KEY_ID.value();return!(!this.status_||!shaka.util.BufferUtils.equal(e,t))},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.entries=function(){goog.asserts.assert(!1,"Not used!  Provided only for the compiler.")},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.keys=function(){goog.asserts.assert(!1,"Not used!  Provided only for the compiler.")},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.values=function(){goog.asserts.assert(!1,"Not used!  Provided only for the compiler.")},shaka.polyfill.PatchedMediaKeysApple.apiName_="apple",shaka.polyfill.register(shaka.polyfill.PatchedMediaKeysApple.defaultInstall),shaka.polyfill.PatchedMediaKeysCert=function(){},shaka.polyfill.PatchedMediaKeysCert.install=function(){!window.MediaKeys||MediaKeys.prototype.setServerCertificate&&!shaka.polyfill.PatchedMediaKeysCert.hasInvalidImplementation_()||(shaka.log.info("Patching MediaKeys.setServerCertificate"),MediaKeys.prototype.setServerCertificate=shaka.polyfill.PatchedMediaKeysCert.setServerCertificate_)},shaka.polyfill.PatchedMediaKeysCert.setServerCertificate_=function(e){return shaka.log.debug("PatchedMediaKeysCert.setServerCertificate"),Promise.resolve(!1)},shaka.polyfill.PatchedMediaKeysCert.hasInvalidImplementation_=function(){return shaka.util.Platform.isTizen3()||shaka.util.Platform.isTizen4()||shaka.util.Platform.isTizen5_0()||shaka.util.Platform.isWebOS3()},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysCert",shaka.polyfill.PatchedMediaKeysCert),goog.exportProperty(shaka.polyfill.PatchedMediaKeysCert,"install",shaka.polyfill.PatchedMediaKeysCert.install),shaka.polyfill.register(shaka.polyfill.PatchedMediaKeysCert.install),shaka.polyfill.PatchedMediaKeysWebkit=function(){},shaka.polyfill.PatchedMediaKeysWebkit.install=function(){var e=shaka.polyfill.PatchedMediaKeysWebkit;if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)shaka.log.info("Using webkit-prefixed EME v0.1b"),e.prefix_="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;shaka.log.info("Using nonprefixed EME v0.1b")}goog.asserts.assert(HTMLMediaElement.prototype[e.prefixApi_("generateKeyRequest")],"PatchedMediaKeysWebkit APIs not available!"),navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess,window.shakaMediaKeysPolyfill=e.apiName_}},shaka.polyfill.PatchedMediaKeysWebkit.prefixApi_=function(e){var t=shaka.polyfill.PatchedMediaKeysWebkit.prefix_;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e},shaka.polyfill.PatchedMediaKeysWebkit.requestMediaKeySystemAccess=function(e,t){shaka.log.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess"),goog.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');var r=shaka.polyfill.PatchedMediaKeysWebkit;try{var n=new r.MediaKeySystemAccess(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}},shaka.polyfill.PatchedMediaKeysWebkit.setMediaKeys=function(e){shaka.log.debug("PatchedMediaKeysWebkit.setMediaKeys"),goog.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=shaka.polyfill.PatchedMediaKeysWebkit,r=this.mediaKeys;return r&&r!=e&&(goog.asserts.assert(r instanceof t.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,(this.mediaKeys=e)&&(goog.asserts.assert(e instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),e.setMedia(this)),Promise.resolve()},shaka.polyfill.PatchedMediaKeysWebkit.getVideoElement_=function(){var e=document.getElementsByTagName("video");return e.length?e[0]:document.createElement("video")},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysWebkit",shaka.polyfill.PatchedMediaKeysWebkit),goog.exportProperty(shaka.polyfill.PatchedMediaKeysWebkit,"install",shaka.polyfill.PatchedMediaKeysWebkit.install),shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess=function(e,t){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.internalKeySystem_=this.keySystem=e;var r=!1;"org.w3.clearkey"==e&&(this.internalKeySystem_="webkit-org.w3.clearkey",r=!1);for(var n=!1,a=shaka.polyfill.PatchedMediaKeysWebkit.getVideoElement_(),i=(t=$jscomp.makeIterator(t)).next();!i.done;i=t.next()){var s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(i=i.value).initDataTypes,sessionTypes:["temporary"],label:i.label},o=!1;if(i.audioCapabilities)for(var l=$jscomp.makeIterator(i.audioCapabilities),u=l.next();!u.done;u=l.next())if((u=u.value).contentType){o=!0;var c=u.contentType.split(";")[0];a.canPlayType(c,this.internalKeySystem_)&&(s.audioCapabilities.push(u),n=!0)}if(i.videoCapabilities)for(u=(l=$jscomp.makeIterator(i.videoCapabilities)).next();!u.done;u=l.next())(u=u.value).contentType&&(o=!0,a.canPlayType(u.contentType,this.internalKeySystem_)&&(s.videoCapabilities.push(u),n=!0));if(o||(n=a.canPlayType("video/mp4",this.internalKeySystem_)||a.canPlayType("video/webm",this.internalKeySystem_)),"required"==i.persistentState&&(r?(s.persistentState="required",s.sessionTypes=["persistent-license"]):n=!1),n)return void(this.configuration_=s)}throw r="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(r="None of the requested configurations were supported."),(e=Error(r)).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.createMediaKeys=function(){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys(this.internalKeySystem_);return Promise.resolve(e)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.getConfiguration=function(){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.configuration_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys=function(e){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys"),this.keySystem_=e,this.media_=null,this.eventManager_=new shaka.util.EventManager,this.newSessions_=[],this.sessionMap_=new Map},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setMedia=function(e){var t=this;this.media_=e,this.eventManager_.removeAll();var r=shaka.polyfill.PatchedMediaKeysWebkit.prefix_;e&&(this.eventManager_.listen(e,r+"needkey",(function(e){return t.onWebkitNeedKey_(e)})),this.eventManager_.listen(e,r+"keymessage",(function(e){return t.onWebkitKeyMessage_(e)})),this.eventManager_.listen(e,r+"keyadded",(function(e){return t.onWebkitKeyAdded_(e)})),this.eventManager_.listen(e,r+"keyerror",(function(e){return t.onWebkitKeyError_(e)})))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.createSession=function(e){if(shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=shaka.polyfill.PatchedMediaKeysWebkit,r=this.media_||document.createElement("video");return r.src||(r.src="about:blank"),e=new t.MediaKeySession(r,this.keySystem_,e),this.newSessions_.push(e),e},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setServerCertificate=function(e){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.getStatusForPolicy=function(e){return Promise.resolve("usable")},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitNeedKey_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e),goog.asserts.assert(this.media_,"media_ not set in onWebkitNeedKey_");var t=new CustomEvent("encrypted");t.initDataType="cenc",t.initData=shaka.util.BufferUtils.toArrayBuffer(e.initData),this.media_.dispatchEvent(t)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyMessage_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=this.findSession_(e.sessionId);if(t){var r=null==t.keyStatuses.getStatus();e=(new Map).set("messageType",r?"licenserequest":"licenserenewal").set("message",e.message),e=new shaka.util.FakeEvent("message",e),t.generated(),t.dispatchEvent(e)}else shaka.log.error("Session not found",e.sessionId)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyAdded_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e),e=this.findSession_(e.sessionId),goog.asserts.assert(e,"unable to find session in onWebkitKeyAdded_"),e&&e.ready()},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyError_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=this.findSession_(e.sessionId);goog.asserts.assert(t,"unable to find session in onWebkitKeyError_"),t&&t.handleError(e)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.findSession_=function(e){var t=this.sessionMap_.get(e);return t?(shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):(t=this.newSessions_.shift())?(t.sessionId=e,this.sessionMap_.set(e,t),shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):null},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession=function(e,t,r){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession"),shaka.util.FakeEventTarget.call(this),this.media_=e,this.initialized_=!1,this.updatePromise_=this.generatePromise_=null,this.keySystem_=t,this.type_=r,this.sessionId="",this.expiration=NaN,this.closed=new shaka.util.PublicPromise,this.keyStatuses=new shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap},$jscomp.inherits(shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession,shaka.util.FakeEventTarget),shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generated=function(){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),this.generatePromise_&&(this.generatePromise_.resolve(),this.generatePromise_=null)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.ready=function(){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),this.updateKeyStatus_("usable"),this.updatePromise_&&this.updatePromise_.resolve(),this.updatePromise_=null},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.handleError=function(e){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=Error("EME v0.1b key error"),r=e.errorCode;r.systemCode=e.systemCode,t.errorCode=r,!e.sessionId&&this.generatePromise_?(45==e.systemCode&&(t.message="Unsupported session type."),this.generatePromise_.reject(t),this.generatePromise_=null):e.sessionId&&this.updatePromise_?(this.updatePromise_.reject(t),this.updatePromise_=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?this.updateKeyStatus_("output-restricted"):1==t?this.updateKeyStatus_("expired"):this.updateKeyStatus_("internal-error"))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generate_=function(e,t){var r=this,n=shaka.polyfill.PatchedMediaKeysWebkit;if(this.initialized_)return Promise.reject(Error("The session is already initialized."));this.initialized_=!0;try{if("persistent-license"==this.type_){var a=shaka.util.StringUtils;if(t)var i=shaka.util.BufferUtils.toUint8(a.toUTF8("LOAD_SESSION|"+t));else{goog.asserts.assert(e,"expecting init data");var s=a.toUTF8("PERSISTENT|");i=shaka.util.Uint8ArrayUtils.concat(s,e)}}else goog.asserts.assert("temporary"==this.type_,"expected temporary session"),goog.asserts.assert(!t,"unexpected offline session ID"),goog.asserts.assert(e,"expecting init data"),i=shaka.util.BufferUtils.toUint8(e);goog.asserts.assert(i,"init data not set!")}catch(e){return Promise.reject(e)}goog.asserts.assert(null==this.generatePromise_,"generatePromise_ should be null"),this.generatePromise_=new shaka.util.PublicPromise;var o=n.prefixApi_("generateKeyRequest");try{this.media_[o](this.keySystem_,i)}catch(e){if("InvalidStateError"!=e.name)return this.generatePromise_=null,Promise.reject(e);new shaka.util.Timer((function(){try{r.media_[o](r.keySystem_,i)}catch(e){r.generatePromise_.reject(e),r.generatePromise_=null}})).tickAfter(.01)}return this.generatePromise_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update_=function(e,t){var r=this,n=shaka.polyfill.PatchedMediaKeysWebkit;if(this.updatePromise_)this.updatePromise_.then((function(){return r.update_(e,t)})).catch((function(){return r.update_(e,t)}));else{if(this.updatePromise_=e,"webkit-org.w3.clearkey"==this.keySystem_){var a=shaka.util.Uint8ArrayUtils,i=shaka.util.StringUtils.fromUTF8(t),s=JSON.parse(i);"oct"!=s.keys[0].kty&&(this.updatePromise_.reject(Error("Response is not a valid JSON Web Key Set.")),this.updatePromise_=null),i=a.fromBase64(s.keys[0].k),a=a.fromBase64(s.keys[0].kid)}else i=shaka.util.BufferUtils.toUint8(t),a=null;n=n.prefixApi_("addKey");try{this.media_[n](this.keySystem_,i,a,this.sessionId)}catch(e){this.updatePromise_.reject(e),this.updatePromise_=null}}},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.updateKeyStatus_=function(e){this.keyStatuses.setStatus(e),e=new shaka.util.FakeEvent("keystatuseschange"),this.dispatchEvent(e)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generateRequest=function(e,t){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),this.generate_(t,null)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.load=function(e){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.type_?this.generate_(null,e):Promise.reject(Error("Not a persistent session."))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update=function(e){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e),goog.asserts.assert(this.sessionId,"update without session ID");var t=new shaka.util.PublicPromise;return this.update_(t,e),t},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.close=function(){var e=shaka.polyfill.PatchedMediaKeysWebkit;if(shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.type_){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;e=e.prefixApi_("cancelKeyRequest");try{this.media_[e](this.keySystem_,this.sessionId)}catch(t){shaka.log.debug(e+" exception",t)}}return this.closed.resolve(),this.closed},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.remove=function(){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.type_?Promise.reject(Error("Not a persistent session.")):this.close()},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap=function(){this.size=0,this.status_=void 0};shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.setStatus=function(e){this.size=null==e?0:1,this.status_=e},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.getStatus=function(){return this.status_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.forEach=function(e){this.status_&&e(this.status_,shaka.drm.DrmUtils.DUMMY_KEY_ID.value())},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.get=function(e){if(this.has(e))return this.status_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.has=function(e){var t=shaka.drm.DrmUtils.DUMMY_KEY_ID.value();return!(!this.status_||!shaka.util.BufferUtils.equal(e,t))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.entries=function(){goog.asserts.assert(!1,"Not used!  Provided only for compiler.")},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.keys=function(){goog.asserts.assert(!1,"Not used!  Provided only for compiler.")},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.values=function(){goog.asserts.assert(!1,"Not used!  Provided only for compiler.")},shaka.polyfill.PatchedMediaKeysWebkit.prefix_="",shaka.polyfill.PatchedMediaKeysWebkit.apiName_="webkit",shaka.polyfill.register(shaka.polyfill.PatchedMediaKeysWebkit.install),shaka.polyfill.PiPWebkit=function(){},shaka.polyfill.PiPWebkit.install=function(){if(window.HTMLVideoElement){var e=HTMLVideoElement.prototype;if((!e.requestPictureInPicture||!document.exitPictureInPicture)&&e.webkitSupportsPresentationMode){var t=shaka.polyfill.PiPWebkit;shaka.log.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=t.requestPictureInPicture_,Object.defineProperty(e,"disablePictureInPicture",{get:t.getDisablePictureInPicture_,set:t.setDisablePictureInPicture_,enumerable:!0,configurable:!0}),document.exitPictureInPicture=t.exitPictureInPicture_,document.addEventListener("webkitpresentationmodechanged",t.proxyEvent_,!0)}}},shaka.polyfill.PiPWebkit.proxyEvent_=function(e){if((e=e.target).webkitPresentationMode==shaka.polyfill.PiPWebkit.PIP_MODE_){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)},shaka.polyfill.PiPWebkit.requestPictureInPicture_=function(){var e=shaka.polyfill.PiPWebkit;return this.webkitSupportsPresentationMode(e.PIP_MODE_)?(this.webkitSetPresentationMode(e.PIP_MODE_),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))},shaka.polyfill.PiPWebkit.exitPictureInPicture_=function(){var e=shaka.polyfill.PiPWebkit,t=document.pictureInPictureElement;return t?(t.webkitSetPresentationMode(e.INLINE_MODE_),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))},shaka.polyfill.PiPWebkit.getDisablePictureInPicture_=function(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode(shaka.polyfill.PiPWebkit.PIP_MODE_)},shaka.polyfill.PiPWebkit.setDisablePictureInPicture_=function(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")},goog.exportProperty(shaka.polyfill,"PiPWebkit",shaka.polyfill.PiPWebkit),goog.exportProperty(shaka.polyfill.PiPWebkit,"install",shaka.polyfill.PiPWebkit.install),shaka.polyfill.PiPWebkit.PIP_MODE_="picture-in-picture",shaka.polyfill.PiPWebkit.INLINE_MODE_="inline",shaka.polyfill.register(shaka.polyfill.PiPWebkit.install),shaka.polyfill.RandomUUID=function(){},shaka.polyfill.RandomUUID.install=function(){shaka.log.debug("randomUUID.install"),window.crypto?"randomUUID"in window.crypto?shaka.log.debug("RandomUUID: Native window.crypto.randomUUID() support found."):window.crypto.randomUUID=shaka.polyfill.RandomUUID.randomUUID_:shaka.log.debug("window.crypto must be available to install randomUUID polyfill.")},shaka.polyfill.RandomUUID.randomUUID_=function(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)},goog.exportProperty(shaka.polyfill,"RandomUUID",shaka.polyfill.RandomUUID),goog.exportProperty(shaka.polyfill.RandomUUID,"install",shaka.polyfill.RandomUUID.install),shaka.polyfill.register(shaka.polyfill.RandomUUID.install),shaka.polyfill.Symbol=function(){},shaka.polyfill.Symbol.install=function(){shaka.log.debug("Symbol.install");var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:shaka.polyfill.Symbol.getSymbolDescription_})},shaka.polyfill.Symbol.getSymbolDescription_=function(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0},goog.exportProperty(shaka.polyfill,"Symbol",shaka.polyfill.Symbol),goog.exportProperty(shaka.polyfill.Symbol,"install",shaka.polyfill.Symbol.install),shaka.polyfill.register(shaka.polyfill.Symbol.install),shaka.polyfill.VideoPlayPromise=function(){},shaka.polyfill.VideoPlayPromise.install=function(){if(shaka.log.debug("VideoPlayPromise.install"),window.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch((function(){})),t}}},goog.exportProperty(shaka.polyfill,"VideoPlayPromise",shaka.polyfill.VideoPlayPromise),goog.exportProperty(shaka.polyfill.VideoPlayPromise,"install",shaka.polyfill.VideoPlayPromise.install),shaka.polyfill.register(shaka.polyfill.VideoPlayPromise.install),shaka.polyfill.VideoPlaybackQuality=function(){},shaka.polyfill.VideoPlaybackQuality.install=function(){if(window.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in e||shaka.util.Platform.isWebOS3())&&(e.getVideoPlaybackQuality=shaka.polyfill.VideoPlaybackQuality.webkit_)}},shaka.polyfill.VideoPlaybackQuality.webkit_=function(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}},goog.exportProperty(shaka.polyfill,"VideoPlaybackQuality",shaka.polyfill.VideoPlaybackQuality),goog.exportProperty(shaka.polyfill.VideoPlaybackQuality,"install",shaka.polyfill.VideoPlaybackQuality.install),shaka.polyfill.register(shaka.polyfill.VideoPlaybackQuality.install),shaka.polyfill.VTTCue=function(){},shaka.polyfill.VTTCue.install=function(){if(window.VTTCue)shaka.log.info("Using native VTTCue.");else if(window.TextTrackCue){var e=null,t=TextTrackCue.length;3==t?(shaka.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e=shaka.polyfill.VTTCue.from3ArgsTextTrackCue_):6==t?(shaka.log.info("Using VTTCue polyfill from 6 argument TextTrackCue."),e=shaka.polyfill.VTTCue.from6ArgsTextTrackCue_):shaka.polyfill.VTTCue.canUse3ArgsTextTrackCue_()&&(shaka.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e=shaka.polyfill.VTTCue.from3ArgsTextTrackCue_),e?window.VTTCue=function(t,r,n){return e(t,r,n)}:shaka.log.error("No recognized signature for TextTrackCue found!")}else shaka.log.error("VTTCue not available.")},shaka.polyfill.VTTCue.from3ArgsTextTrackCue_=function(e,t,r){return new window.TextTrackCue(e,t,r)},shaka.polyfill.VTTCue.from6ArgsTextTrackCue_=function(e,t,r){return new window.TextTrackCue(e+"-"+t+"-"+r,e,t,r)},shaka.polyfill.VTTCue.canUse3ArgsTextTrackCue_=function(){try{return!!shaka.polyfill.VTTCue.from3ArgsTextTrackCue_(1,2,"")}catch(e){return!1}},goog.exportProperty(shaka.polyfill,"VTTCue",shaka.polyfill.VTTCue),goog.exportProperty(shaka.polyfill.VTTCue,"install",shaka.polyfill.VTTCue.install),shaka.polyfill.register(shaka.polyfill.VTTCue.install),shaka.text.LrcTextParser=function(){},shaka.text.LrcTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"LRC does not have init segments")},shaka.text.LrcTextParser.prototype.setSequenceMode=function(e){},shaka.text.LrcTextParser.prototype.setManifestType=function(e){},shaka.text.LrcTextParser.prototype.parseMedia=function(e,t){var r=shaka.text.LrcTextParser,n=null,a=[];e=shaka.util.StringUtils.fromUTF8(e).split(/\r?\n/);for(var i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next()){var s=i.value;s&&!/^\s+$/.test(s)&&((i=r.lyricLine_.exec(s))?(s=r.parseTime_(i[1]),i=new shaka.text.Cue(s,t.segmentEnd?t.segmentEnd:s+2,i[2]),n&&(n.endTime=s,a.push(n)),n=i):shaka.log.warning("LrcTextParser encountered an unknown line.",s))}return n&&a.push(n),a},shaka.text.LrcTextParser.parseTime_=function(e){var t=shaka.text.LrcTextParser.timeFormat_.exec(e);return 60*(e=parseInt(t[1],10))+(t=parseFloat(t[2].replace(",",".")))},goog.exportSymbol("shaka.text.LrcTextParser",shaka.text.LrcTextParser),goog.exportProperty(shaka.text.LrcTextParser.prototype,"parseMedia",shaka.text.LrcTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.LrcTextParser.prototype,"setManifestType",shaka.text.LrcTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.LrcTextParser.prototype,"setSequenceMode",shaka.text.LrcTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.LrcTextParser.prototype,"parseInit",shaka.text.LrcTextParser.prototype.parseInit),shaka.text.LrcTextParser.lyricLine_=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,shaka.text.LrcTextParser.timeFormat_=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/,shaka.text.TextEngine.registerParser("application/x-subtitle-lrc",(function(){return new shaka.text.LrcTextParser})),shaka.text.TtmlTextParser=function(){},shaka.text.TtmlTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"TTML does not have init segments")},shaka.text.TtmlTextParser.prototype.setSequenceMode=function(e){},shaka.text.TtmlTextParser.prototype.setManifestType=function(e){},shaka.text.TtmlTextParser.prototype.parseMedia=function(e,t,r,n){var a=shaka.text.TtmlTextParser,i=shaka.util.TXml,s=a.parameterNs_,o=a.styleNs_,l=shaka.util.StringUtils.fromUTF8(e);if(e=[],""==l)return e;var u=i.parseXmlString(l,"tt",!0);if(!u)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_XML,"Failed to parse TTML.");if(!(l=i.getElementsByTagName(u,"body")[0]))return[];var c=i.getAttributeNSList(u,s,"frameRate"),d=i.getAttributeNSList(u,s,"subFrameRate"),p=i.getAttributeNSList(u,s,"frameRateMultiplier"),h=i.getAttributeNSList(u,s,"tickRate"),f=i.getAttributeNSList(u,s,"cellResolution"),m=u.attributes["xml:space"]||"default";if(s=i.getAttributeNSList(u,o,"extent"),"default"!=m&&"preserve"!=m)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_XML,"Invalid xml:space value: "+m);o="default"==m,c=new a.RateInfo_(c,d,p,h),d=a.getCellResolution_(f),p=((p=i.getElementsByTagName(u,"metadata")[0])?p.children:[]).filter((function(e){return"\n"!=e})),h=i.getElementsByTagName(u,"style"),u=i.getElementsByTagName(u,"region"),f=[];for(var g=(m=$jscomp.makeIterator(u)).next();!g.done;g=m.next())(g=a.parseCueRegion_(g.value,h,s))&&f.push(g);if(i.findChildren(l,"p").length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"<p> can only be inside <div> in TTML");for(m=(s=$jscomp.makeIterator(i.findChildren(l,"div"))).next();!m.done;m=s.next())if(i.findChildren(m.value,"span").length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"<span> can only be inside <p> in TTML");return(t=a.parseCue_(l,t,c,p,h,u,f,o,d,null,!1,r,n))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},shaka.text.TtmlTextParser.parseCue_=function(e,t,r,n,a,i,s,o,l,u,c,d,p){var h=shaka.util.TXml,f=shaka.util.StringUtils,m=u;if(h.isText(e)){if(!c)return null;var g={tagName:"span",children:[h.getTextContents(e)],attributes:{},parent:null}}else g=e;goog.asserts.assert(g,"cueElement should be non-null!");for(var y=null,v=$jscomp.makeIterator(shaka.text.TtmlTextParser.smpteNsList_),_=v.next();!_.done&&!(y=shaka.text.TtmlTextParser.getElementsFromCollection_(g,"backgroundImage",n,"#",_.value)[0]);_=v.next());v=null;var k=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/;if((_=h.getAttributeNSList(g,shaka.text.TtmlTextParser.smpteNsList_,"backgroundImage"))&&k.test(_)){if((v=parseInt(_.split(":").pop(),10)-1)>=p.length)return null;v=p[v]}else d&&_&&!_.startsWith("#")&&(k=new goog.Uri(d),_=new goog.Uri(_),(_=k.resolve(_).toString())&&(v=_));if(("p"==e.tagName||y||v)&&(c=!0),e=c,_="default"==(g.attributes["xml:space"]||(o?"default":"preserve")),o=[],!(k=g.children.every(h.isText)))for(var E=$jscomp.makeIterator(g.children),b=E.next();!b.done;b=E.next())(b=shaka.text.TtmlTextParser.parseCue_(b.value,t,r,n,a,i,s,_,l,g,c,d,p))&&o.push(b);if(n=null!=u,d=h.getTextContents(g),d=g.children.length&&d&&/\S/.test(d),!((E=g.attributes.begin||g.attributes.end||g.attributes.dur)||d||"br"==g.tagName||0!=o.length||n&&!_))return null;for(d=(p=shaka.text.TtmlTextParser.parseTime_(g,r)).start,p=p.end;m&&h.isNode(m)&&"tt"!=m.tagName;)d=(p=shaka.text.TtmlTextParser.resolveTime_(m,r,d,p)).start,p=p.end,m=m.parent;if(null==d&&(d=0),d+=t.periodStart,p=null==p?1/0:p+t.periodStart,d=Math.max(d,t.segmentStart),p=Math.min(p,t.segmentEnd),!E&&0<o.length)for(d=1/0,p=0,r=(t=$jscomp.makeIterator(o)).next();!r.done;r=t.next())r=r.value,d=Math.min(d,r.startTime),p=Math.max(p,r.endTime);if("br"==g.tagName)return(a=new shaka.text.Cue(d,p,"")).lineBreak=!0,a;if(t="",k&&(t=f.htmlUnescape(shaka.util.TXml.getTextContents(g)||""),_&&(t=t.replace(/\s+/g," "))),(f=new shaka.text.Cue(d,p,t)).nestedCues=o,c||(f.isContainer=!0),l&&(f.cellResolution=l),l=shaka.text.TtmlTextParser.getElementsFromCollection_(g,"region",i,"")[0],g.attributes.region&&l&&l.attributes["xml:id"]){var T=l.attributes["xml:id"];f.region=s.filter((function(e){return e.id==T}))[0]}return s=l,u&&n&&!g.attributes.region&&!g.attributes.style&&(s=shaka.text.TtmlTextParser.getElementsFromCollection_(u,"region",i,"")[0]),shaka.text.TtmlTextParser.addStyle_(f,g,s,y,v,a,e,0==o.length),f},shaka.text.TtmlTextParser.parseCueRegion_=function(e,t,r){var n=shaka.text.TtmlTextParser,a=new shaka.text.CueRegion,i=e.attributes["xml:id"];if(!i)return shaka.log.warning("TtmlTextParser parser encountered a region with no id. Region will be ignored."),null;a.id=i,i=null,r&&(i=n.percentValues_.exec(r)||n.pixelValues_.exec(r)),r=i?Number(i[1]):null,i=i?Number(i[2]):null;var s,o=n.getStyleAttributeFromRegion_(e,t,"extent");if(o){var l=(s=n.percentValues_.exec(o))||n.pixelValues_.exec(o);null!=l&&(a.width=Number(l[1]),a.height=Number(l[2]),s||(null!=r&&(a.width=100*a.width/r),null!=i&&(a.height=100*a.height/i)),a.widthUnits=s||null!=r?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.PX,a.heightUnits=s||null!=i?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.PX)}return(e=n.getStyleAttributeFromRegion_(e,t,"origin"))&&(null!=(l=(s=n.percentValues_.exec(e))||n.pixelValues_.exec(e))&&(a.viewportAnchorX=Number(l[1]),a.viewportAnchorY=Number(l[2]),s?o||(a.width=100-a.viewportAnchorX,a.widthUnits=shaka.text.CueRegion.units.PERCENTAGE,a.height=100-a.viewportAnchorY,a.heightUnits=shaka.text.CueRegion.units.PERCENTAGE):(null!=i&&(a.viewportAnchorY=100*a.viewportAnchorY/i),null!=r&&(a.viewportAnchorX=100*a.viewportAnchorX/r)),a.viewportAnchorUnits=s||null!=r?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.PX)),a},shaka.text.TtmlTextParser.convertTTMLrgbaToHTMLrgba_=function(e){var t=e.match(/rgba\(([^)]+)\)/);return t&&4==(t=t[1].split(",")).length?(t[3]=String(Number(t[3])/255),"rgba("+t.join(",")+")"):e},shaka.text.TtmlTextParser.addStyle_=function(e,t,r,n,a,i,s,o){var l=shaka.text.TtmlTextParser,u=shaka.util.TXml,c=shaka.text.Cue;if(s=s||o,"rtl"==l.getStyleAttribute_(t,r,i,"direction",s)&&(e.direction=c.direction.HORIZONTAL_RIGHT_TO_LEFT),"tb"==(o=l.getStyleAttribute_(t,r,i,"writingMode",s))||"tblr"==o?e.writingMode=c.writingMode.VERTICAL_LEFT_TO_RIGHT:"tbrl"==o?e.writingMode=c.writingMode.VERTICAL_RIGHT_TO_LEFT:"rltb"==o||"rl"==o?e.direction=c.direction.HORIZONTAL_RIGHT_TO_LEFT:o&&(e.direction=c.direction.HORIZONTAL_LEFT_TO_RIGHT),(o=l.getStyleAttribute_(t,r,i,"textAlign",!0))?(e.positionAlign=l.textAlignToPositionAlign_.get(o),e.lineAlign=l.textAlignToLineAlign_.get(o),goog.asserts.assert(o.toUpperCase()in c.textAlign,o.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=c.textAlign[o.toUpperCase()]):e.textAlign=c.textAlign.CENTER,(o=l.getStyleAttribute_(t,r,i,"displayAlign",!0))&&(goog.asserts.assert(o.toUpperCase()in c.displayAlign,o.toUpperCase()+" Should be in Cue.displayAlign values!"),e.displayAlign=c.displayAlign[o.toUpperCase()]),(o=l.getStyleAttribute_(t,r,i,"color",s))&&(e.color=l.convertTTMLrgbaToHTMLrgba_(o)),(o=l.getStyleAttribute_(t,r,i,"backgroundColor",s))&&(e.backgroundColor=l.convertTTMLrgbaToHTMLrgba_(o)),(o=l.getStyleAttribute_(t,r,i,"border",s))&&(e.border=o),o=l.getStyleAttribute_(t,r,i,"fontFamily",s))switch(o){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=o.split(",").filter((function(e){return"default"!=e})).join(",")}switch((o=l.getStyleAttribute_(t,r,i,"fontWeight",s))&&"bold"==o&&(e.fontWeight=c.fontWeight.BOLD),o=l.getStyleAttribute_(t,r,i,"wrapOption",s),e.wrapLine=!o||"noWrap"!=o,(o=l.getStyleAttribute_(t,r,i,"lineHeight",s))&&o.match(l.unitValues_)&&(e.lineHeight=o),(o=l.getStyleAttribute_(t,r,i,"fontSize",s))&&(o.match(l.unitValues_)||o.match(l.percentValue_))&&(e.fontSize=o),(o=l.getStyleAttribute_(t,r,i,"fontStyle",s))&&(goog.asserts.assert(o.toUpperCase()in c.fontStyle,o.toUpperCase()+" Should be in Cue.fontStyle values!"),e.fontStyle=c.fontStyle[o.toUpperCase()]),n?(a=n.attributes.imageType||n.attributes.imagetype,c=n.attributes.encoding,n=u.getTextContents(n).trim(),"PNG"==a&&"Base64"==c&&n&&(e.backgroundImage="data:image/png;base64,"+n)):a&&(e.backgroundImage=a),(n=l.getStyleAttribute_(t,r,i,"textOutline",s))&&((n=n.split(" "))[0].match(l.unitValues_)?e.textStrokeColor=e.color:(e.textStrokeColor=l.convertTTMLrgbaToHTMLrgba_(n[0]),n.shift()),n[0]&&n[0].match(l.unitValues_)?e.textStrokeWidth=n[0]:e.textStrokeColor=""),(n=l.getStyleAttribute_(t,r,i,"letterSpacing",s))&&n.match(l.unitValues_)&&(e.letterSpacing=n),(n=l.getStyleAttribute_(t,r,i,"linePadding",s))&&n.match(l.unitValues_)&&(e.linePadding=n),(n=l.getStyleAttribute_(t,r,i,"opacity",s))&&(e.opacity=parseFloat(n)),(n=l.getStyleAttributeFromRegion_(r,i,"textDecoration"))&&l.addTextDecoration_(e,n),(n=l.getStyleAttributeFromElement_(t,i,"textDecoration"))&&l.addTextDecoration_(e,n),(n=l.getStyleAttribute_(t,r,i,"textCombine",s))&&(e.textCombineUpright=n),l.getStyleAttribute_(t,r,i,"ruby",s)){case"container":e.rubyTag="ruby";break;case"text":e.rubyTag="rt"}},shaka.text.TtmlTextParser.addTextDecoration_=function(e,t){for(var r=shaka.text.Cue,n=(t=$jscomp.makeIterator(t.split(" "))).next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes(r.textDecoration.UNDERLINE)||e.textDecoration.push(r.textDecoration.UNDERLINE);break;case"noUnderline":e.textDecoration.includes(r.textDecoration.UNDERLINE)&&shaka.util.ArrayUtils.remove(e.textDecoration,r.textDecoration.UNDERLINE);break;case"lineThrough":e.textDecoration.includes(r.textDecoration.LINE_THROUGH)||e.textDecoration.push(r.textDecoration.LINE_THROUGH);break;case"noLineThrough":e.textDecoration.includes(r.textDecoration.LINE_THROUGH)&&shaka.util.ArrayUtils.remove(e.textDecoration,r.textDecoration.LINE_THROUGH);break;case"overline":e.textDecoration.includes(r.textDecoration.OVERLINE)||e.textDecoration.push(r.textDecoration.OVERLINE);break;case"noOverline":e.textDecoration.includes(r.textDecoration.OVERLINE)&&shaka.util.ArrayUtils.remove(e.textDecoration,r.textDecoration.OVERLINE)}},shaka.text.TtmlTextParser.getStyleAttribute_=function(e,t,r,n,a){a=void 0===a||a;var i=shaka.text.TtmlTextParser;return(e=i.getStyleAttributeFromElement_(e,r,n))?e:a?i.getStyleAttributeFromRegion_(t,r,n):null},shaka.text.TtmlTextParser.getStyleAttributeFromRegion_=function(e,t,r){if(!e)return null;var n=shaka.util.TXml.getAttributeNSList(e,shaka.text.TtmlTextParser.styleNs_,r);return n||shaka.text.TtmlTextParser.getInheritedStyleAttribute_(e,t,r)},shaka.text.TtmlTextParser.getStyleAttributeFromElement_=function(e,t,r){var n=shaka.util.TXml.getAttributeNSList(e,shaka.text.TtmlTextParser.styleNs_,r);return n||shaka.text.TtmlTextParser.getInheritedStyleAttribute_(e,t,r)},shaka.text.TtmlTextParser.getInheritedStyleAttribute_=function(e,t,r){var n=shaka.util.TXml,a=shaka.text.TtmlTextParser.styleNs_,i=shaka.text.TtmlTextParser.styleEbuttsNs_;e=shaka.text.TtmlTextParser.getElementsFromCollection_(e,"style",t,"");for(var s=null,o=0;o<e.length;o++){var l=n.getAttributeNS(e[o],i,r);l||(l=n.getAttributeNSList(e[o],a,r)),l||(l=shaka.text.TtmlTextParser.getStyleAttributeFromElement_(e[o],t,r)),l&&(s=l)}return s},shaka.text.TtmlTextParser.getElementsFromCollection_=function(e,t,r,n,a){var i=[];if(!e||1>r.length)return i;if(e=shaka.text.TtmlTextParser.getInheritedAttribute_(e,t,a))for(e=e.split(" "),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){t=t.value;for(var s=(a=$jscomp.makeIterator(r)).next();!s.done;s=a.next())if(n+(s=s.value).attributes["xml:id"]==t){i.push(s);break}}return i},shaka.text.TtmlTextParser.getInheritedAttribute_=function(e,t,r){for(var n=null,a=shaka.util.TXml;!n&&!(n=r?a.getAttributeNS(e,r,t):e.attributes[t])&&(e=e.parent););return n},shaka.text.TtmlTextParser.resolveTime_=function(e,t,r,n){return e=shaka.text.TtmlTextParser.parseTime_(e,t),null==r?r=e.start:null!=e.start&&(r+=e.start),null==n?n=e.end:null!=e.start&&(n+=e.start),{start:r,end:n}},shaka.text.TtmlTextParser.parseTime_=function(e,t){var r=shaka.text.TtmlTextParser.parseTimeAttribute_(e.attributes.begin,t),n=shaka.text.TtmlTextParser.parseTimeAttribute_(e.attributes.end,t);return e=shaka.text.TtmlTextParser.parseTimeAttribute_(e.attributes.dur,t),null==n&&null!=e&&(n=r+e),{start:r,end:n}},shaka.text.TtmlTextParser.parseTimeAttribute_=function(e,t){var r=null,n=shaka.text.TtmlTextParser;if(n.timeColonFormatFrames_.test(e))r=n.parseColonTimeWithFrames_(t,e);else if(n.timeColonFormat_.test(e))r=n.parseTimeFromRegex_(n.timeColonFormat_,e);else if(n.timeColonFormatMilliseconds_.test(e))r=n.parseTimeFromRegex_(n.timeColonFormatMilliseconds_,e);else if(n.timeFramesFormat_.test(e))r=n.parseFramesTime_(t,e);else if(n.timeTickFormat_.test(e))r=n.parseTickTime_(t,e);else if(n.timeHMSFormat_.test(e))r=n.parseTimeFromRegex_(n.timeHMSFormat_,e);else if(e)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"Could not parse cue time range in TTML");return r},shaka.text.TtmlTextParser.parseFramesTime_=function(e,t){return t=shaka.text.TtmlTextParser.timeFramesFormat_.exec(t),Number(t[1])/e.frameRate},shaka.text.TtmlTextParser.parseTickTime_=function(e,t){return t=shaka.text.TtmlTextParser.timeTickFormat_.exec(t),Number(t[1])/e.tickRate},shaka.text.TtmlTextParser.parseColonTimeWithFrames_=function(e,t){t=shaka.text.TtmlTextParser.timeColonFormatFrames_.exec(t);var r=Number(t[1]),n=Number(t[2]),a=Number(t[3]),i=Number(t[4]);return(a+=(i+=(Number(t[5])||0)/e.subFrameRate)/e.frameRate)+60*n+3600*r},shaka.text.TtmlTextParser.parseTimeFromRegex_=function(e,t){return null==(e=e.exec(t))||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)},shaka.text.TtmlTextParser.getCellResolution_=function(e){if(!e)return null;var t=/^(\d+) (\d+)$/.exec(e);return t?{columns:e=parseInt(t[1],10),rows:t=parseInt(t[2],10)}:null},goog.exportSymbol("shaka.text.TtmlTextParser",shaka.text.TtmlTextParser),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"parseMedia",shaka.text.TtmlTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"setManifestType",shaka.text.TtmlTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"setSequenceMode",shaka.text.TtmlTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"parseInit",shaka.text.TtmlTextParser.prototype.parseInit),shaka.text.TtmlTextParser.RateInfo_=function(e,t,r,n){this.frameRate=Number(e)||30,this.subFrameRate=Number(t)||1,this.tickRate=Number(n),0==this.tickRate&&(this.tickRate=e?this.frameRate*this.subFrameRate:1),r&&(e=/^(\d+) (\d+)$/g.exec(r))&&(this.frameRate*=Number(e[1])/Number(e[2]))},shaka.text.TtmlTextParser.percentValues_=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,shaka.text.TtmlTextParser.percentValue_=/^(\d{1,4}(?:\.\d+)?|100)%$/,shaka.text.TtmlTextParser.unitValues_=/^(\d+px|\d+em|\d*\.?\d+c)$/,shaka.text.TtmlTextParser.pixelValues_=/^(\d+)px (\d+)px$/,shaka.text.TtmlTextParser.timeColonFormatFrames_=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,shaka.text.TtmlTextParser.timeColonFormat_=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,shaka.text.TtmlTextParser.timeColonFormatMilliseconds_=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,shaka.text.TtmlTextParser.timeFramesFormat_=/^(\d*(?:\.\d*)?)f$/,shaka.text.TtmlTextParser.timeTickFormat_=/^(\d*(?:\.\d*)?)t$/,shaka.text.TtmlTextParser.timeHMSFormat_=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),shaka.text.TtmlTextParser.textAlignToLineAlign_=(new Map).set("left",shaka.text.Cue.lineAlign.START).set("center",shaka.text.Cue.lineAlign.CENTER).set("right",shaka.text.Cue.lineAlign.END).set("start",shaka.text.Cue.lineAlign.START).set("end",shaka.text.Cue.lineAlign.END),shaka.text.TtmlTextParser.textAlignToPositionAlign_=(new Map).set("left",shaka.text.Cue.positionAlign.LEFT).set("center",shaka.text.Cue.positionAlign.CENTER).set("right",shaka.text.Cue.positionAlign.RIGHT),shaka.text.TtmlTextParser.parameterNs_=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],shaka.text.TtmlTextParser.styleNs_=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],shaka.text.TtmlTextParser.styleEbuttsNs_="urn:ebu:tt:style",shaka.text.TtmlTextParser.smpteNsList_=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"],shaka.text.TextEngine.registerParser("application/ttml+xml",(function(){return new shaka.text.TtmlTextParser})),shaka.text.Mp4TtmlParser=function(){this.parser_=new shaka.text.TtmlTextParser},shaka.text.Mp4TtmlParser.prototype.parseInit=function(e){var t=shaka.util.Mp4Parser,r=!1;if((new t).box("moov",t.children).box("trak",t.children).box("mdia",t.children).box("minf",t.children).box("stbl",t.children).fullBox("stsd",t.sampleDescription).box("stpp",(function(e){r=!0,e.parser.stop()})).parse(e),!r)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_TTML)},shaka.text.Mp4TtmlParser.prototype.setSequenceMode=function(e){},shaka.text.Mp4TtmlParser.prototype.setManifestType=function(e){},shaka.text.Mp4TtmlParser.prototype.parseMedia=function(e,t,r){var n=shaka.util.Mp4Parser,a=[],i=null,s=[],o=new Map,l=[];if((new n).box("moof",n.children).box("traf",n.children).fullBox("tfhd",(function(e){goog.asserts.assert(null!=e.flags,"A TFHD box should have a valid flags value"),i=shaka.util.Mp4BoxParsers.parseTFHD(e.reader,e.flags).defaultSampleSize})).fullBox("trun",(function(e){goog.asserts.assert(null!=e.version,"A TRUN box should have a valid version value"),goog.asserts.assert(null!=e.flags,"A TRUN box should have a valid flags value"),e=shaka.util.Mp4BoxParsers.parseTRUN(e.reader,e.version,e.flags);for(var t=(e=$jscomp.makeIterator(e.sampleData)).next();!t.done;t=e.next())l.push(t.value.sampleSize||i||0)})).fullBox("subs",(function(e){for(var t=e.reader,r=t.readUint32(),n=-1,a=0;a<r;a++){var i=t.readUint32();n+=i,i=t.readUint16();for(var s=[],l=0;l<i;l++)1==e.version?s.push(t.readUint32()):s.push(t.readUint16()),t.readUint8(),t.readUint8(),t.readUint32();o.set(n,s)}})).box("mdat",n.allData((function(e){s.push(e)}))).parse(e,!1),0==s.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_TTML);n=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(s));for(var u=0,c=0;c<l.length;c++){var d=shaka.util.BufferUtils.toUint8(n,u,l[c]);u+=l[c];var p=o.get(c);if(p&&p.length){d=shaka.util.BufferUtils.toUint8(d,0,p[0]);for(var h=[],f=p[0],m=1;m<p.length;m++){var g=shaka.util.BufferUtils.toUint8(e,f,p[m]);g=shaka.util.Uint8ArrayUtils.toStandardBase64(g),h.push("data:image/png;base64,"+g),f+=p[m]}a=a.concat(this.parser_.parseMedia(d,t,r,h))}else a=a.concat(this.parser_.parseMedia(d,t,r,[]))}return a},goog.exportSymbol("shaka.text.Mp4TtmlParser",shaka.text.Mp4TtmlParser),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"parseMedia",shaka.text.Mp4TtmlParser.prototype.parseMedia),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"setManifestType",shaka.text.Mp4TtmlParser.prototype.setManifestType),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"setSequenceMode",shaka.text.Mp4TtmlParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"parseInit",shaka.text.Mp4TtmlParser.prototype.parseInit),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml.im1i"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml.im1t"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml.im2i"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml.im2t"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml.etd1"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml.etd1|im1t"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml.im1t|etd1"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.TTML.im1t"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.VttTextParser=function(){this.sequenceMode_=!1,this.manifestType_=shaka.media.ManifestParser.UNKNOWN},shaka.text.VttTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"VTT does not have init segments")},shaka.text.VttTextParser.prototype.setSequenceMode=function(e){this.sequenceMode_=e},shaka.text.VttTextParser.prototype.setManifestType=function(e){this.manifestType_=e},shaka.text.VttTextParser.prototype.parseMedia=function(e,t){var r=shaka.text.VttTextParser,n=(e=(e=shaka.util.StringUtils.fromUTF8(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_HEADER);e=t.vttOffset,this.manifestType_==shaka.media.ManifestParser.HLS&&(n[0].includes("X-TIMESTAMP-MAP")?e=this.computeHlsOffset_(n[0],t):t.periodStart&&t.vttOffset==t.periodStart&&(e=0)),t=[];for(var a=$jscomp.makeIterator(n[0].split("\n")),i=a.next();!i.done;i=a.next())i=i.value,/^Region:/.test(i)&&(i=r.parseRegion_(i),t.push(i));a=new Map,shaka.text.Cue.addDefaultTextColor(a),i=[];for(var s=(n=$jscomp.makeIterator(n.slice(1))).next();!s.done;s=n.next())s=s.value.split("\n"),r.parseStyle_(s,a),(s=r.parseCue_(s,e,t,a))&&i.push(s);return i},shaka.text.VttTextParser.prototype.computeHlsOffset_=function(e,t){var r=e.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m);if(e=e.match(/MPEGTS:(\d+)/m),!r||!e)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_HEADER);if(null==(r=shaka.util.TextParser.parseTime(r[1])))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_HEADER);e=Number(e[1]);for(var n=shaka.text.VttTextParser.MPEG_TIMESCALE_,a=shaka.text.VttTextParser.TS_ROLLOVER_/n,i=t.segmentStart-t.periodStart;i>=a;)i-=a,e+=shaka.text.VttTextParser.TS_ROLLOVER_;return t.periodStart+e/n-r},shaka.text.VttTextParser.parseRegion_=function(e){var t=shaka.text.VttTextParser;e=new shaka.util.TextParser(e);var r=new shaka.text.CueRegion;e.readWord(),e.skipWhitespace();for(var n=e.readWord();n;)t.parseRegionSetting_(r,n)||shaka.log.warning("VTT parser encountered an invalid VTTRegion setting: ",n," The setting will be ignored."),e.skipWhitespace(),n=e.readWord();return r},shaka.text.VttTextParser.parseStyle_=function(e,t){if((1!=e.length||e[0])&&!/^NOTE($|[ \t])/.test(e[0])&&"STYLE"==e[0]){for(var r=[],n=-1,a=1;a<e.length;a++)e[a].includes("::cue")&&(r.push([]),n=r.length-1),-1!=n&&(r[n].push(e[a]),e[a].includes("}")&&(n=-1));for(r=(e=$jscomp.makeIterator(r)).next();!r.done;r=e.next()){a=r.value,r="global",(n=a[0].match(/\((.*)\)/))&&(r=n.pop()),n=a.slice(1,-1),a[0].includes("}")&&(a=/\{(.*?)\}/.exec(a[0]))&&(n=a[1].split(";")),(a=t.get(r))||(a=new shaka.text.Cue(0,0,""));for(var i=!1,s=0;s<n.length;s++){var o=/^\s*([^:]+):\s*(.*)/.exec(n[s]);if(o){var l=o[1].trim(),u=o[2].trim().replace(";","");switch(l){case"background-color":case"background":i=!0,a.backgroundColor=u;break;case"color":i=!0,a.color=u;break;case"font-family":i=!0,a.fontFamily=u;break;case"font-size":i=!0,a.fontSize=u;break;case"font-weight":(700<=parseInt(u,10)||"bold"==u)&&(i=!0,a.fontWeight=shaka.text.Cue.fontWeight.BOLD);break;case"font-style":switch(u){case"normal":i=!0,a.fontStyle=shaka.text.Cue.fontStyle.NORMAL;break;case"italic":i=!0,a.fontStyle=shaka.text.Cue.fontStyle.ITALIC;break;case"oblique":i=!0,a.fontStyle=shaka.text.Cue.fontStyle.OBLIQUE}break;case"opacity":i=!0,a.opacity=parseFloat(u);break;case"text-combine-upright":i=!0,a.textCombineUpright=u;break;case"text-shadow":i=!0,a.textShadow=u;break;case"white-space":i=!0,a.wrapLine="noWrap"!=u;break;default:shaka.log.warning("VTT parser encountered an unsupported style: ",o)}}}i&&t.set(r,a)}}},shaka.text.VttTextParser.parseCue_=function(e,t,r,n){var a=shaka.text.VttTextParser;if(1==e.length&&!e[0]||/^NOTE($|[ \t])/.test(e[0])||"STYLE"==e[0]||"REGION"==e[0])return null;var i=null;e[0].includes("--\x3e")||(i=e[0],e.splice(0,1));var s=new shaka.util.TextParser(e[0]),o=s.parseTime(),l=s.readRegex(/[ \t]+--\x3e[ \t]+/g),u=s.parseTime();if(null==o||null==l||null==u)return shaka.log.alwaysWarn("Failed to parse VTT time code. Cue skipped:",i,e),null;for(o+=t,u+=t,t=e.slice(1).join("\n").trim(),n.has("global")?((e=n.get("global").clone()).startTime=o,e.endTime=u,e.payload=t):e=new shaka.text.Cue(o,u,t),s.skipWhitespace(),o=s.readWord();o;)a.parseCueSetting(e,o,r)||shaka.log.warning("VTT parser encountered an invalid VTT setting: ",o," The setting will be ignored."),s.skipWhitespace(),o=s.readWord();return shaka.text.Cue.parseCuePayload(e,n),null!=i&&(e.id=i),e},shaka.text.VttTextParser.parseCueSetting=function(e,t,r){var n,a=shaka.text.VttTextParser;if(n=/^align:(start|middle|center|end|left|right)$/.exec(t))a.setTextAlign_(e,n[1]);else if(n=/^vertical:(lr|rl)$/.exec(t))a.setVerticalWritingMode_(e,n[1]);else if(n=/^size:([\d.]+)%$/.exec(t))e.size=Number(n[1]);else if(n=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))e.position=Number(n[1]),n[2]&&a.setPositionAlign_(e,n[2]);else{if(!(n=/^region:(.*)$/.exec(t)))return a.parsedLineValueAndInterpretation_(e,t);(t=a.getRegionById_(r,n[1]))&&(e.region=t)}return!0},shaka.text.VttTextParser.getRegionById_=function(e,t){return(e=e.filter((function(e){return e.id==t}))).length?(goog.asserts.assert(1==e.length,"VTTRegion ids should be unique!"),e[0]):(shaka.log.warning("VTT parser could not find a region with id: ",t," The region will be ignored."),null)},shaka.text.VttTextParser.parseRegionSetting_=function(e,t){var r;if(r=/^id=(.*)$/.exec(t))e.id=r[1];else if(r=/^width=(\d{1,2}|100)%$/.exec(t))e.width=Number(r[1]);else if(r=/^lines=(\d+)$/.exec(t))e.height=Number(r[1]),e.heightUnits=shaka.text.CueRegion.units.LINES;else if(r=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.regionAnchorX=Number(r[1]),e.regionAnchorY=Number(r[2]);else if(r=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.viewportAnchorX=Number(r[1]),e.viewportAnchorY=Number(r[2]);else{if(!/^scroll=up$/.exec(t))return!1;e.scroll=shaka.text.CueRegion.scrollMode.UP}return!0},shaka.text.VttTextParser.setTextAlign_=function(e,t){var r=shaka.text.Cue;"middle"==t?e.textAlign=r.textAlign.CENTER:(goog.asserts.assert(t.toUpperCase()in r.textAlign,t.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=r.textAlign[t.toUpperCase()])},shaka.text.VttTextParser.setPositionAlign_=function(e,t){var r=shaka.text.Cue;e.positionAlign="line-left"==t||"start"==t?r.positionAlign.LEFT:"line-right"==t||"end"==t?r.positionAlign.RIGHT:"center"==t||"middle"==t?r.positionAlign.CENTER:r.positionAlign.AUTO},shaka.text.VttTextParser.setVerticalWritingMode_=function(e,t){var r=shaka.text.Cue;e.writingMode="lr"==t?r.writingMode.VERTICAL_LEFT_TO_RIGHT:r.writingMode.VERTICAL_RIGHT_TO_LEFT},shaka.text.VttTextParser.parsedLineValueAndInterpretation_=function(e,t){var r,n=shaka.text.Cue;if(r=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=n.lineInterpretation.PERCENTAGE,e.line=Number(r[1]),r[2]&&(goog.asserts.assert(r[2].toUpperCase()in n.lineAlign,r[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=n.lineAlign[r[2].toUpperCase()]);else{if(!(r=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t)))return!1;e.lineInterpretation=n.lineInterpretation.LINE_NUMBER,e.line=Number(r[1]),r[2]&&(goog.asserts.assert(r[2].toUpperCase()in n.lineAlign,r[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=n.lineAlign[r[2].toUpperCase()])}return!0},goog.exportSymbol("shaka.text.VttTextParser",shaka.text.VttTextParser),goog.exportProperty(shaka.text.VttTextParser.prototype,"parseMedia",shaka.text.VttTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.VttTextParser.prototype,"setManifestType",shaka.text.VttTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.VttTextParser.prototype,"setSequenceMode",shaka.text.VttTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.VttTextParser.prototype,"parseInit",shaka.text.VttTextParser.prototype.parseInit),shaka.text.VttTextParser.MPEG_TIMESCALE_=9e4,shaka.text.VttTextParser.TS_ROLLOVER_=8589934592,shaka.text.TextEngine.registerParser("text/vtt",(function(){return new shaka.text.VttTextParser})),shaka.text.TextEngine.registerParser('text/vtt; codecs="vtt"',(function(){return new shaka.text.VttTextParser})),shaka.text.TextEngine.registerParser('text/vtt; codecs="wvtt"',(function(){return new shaka.text.VttTextParser})),shaka.text.Mp4VttParser=function(){this.timescale_=null},shaka.text.Mp4VttParser.prototype.parseInit=function(e){var t=this,r=shaka.util.Mp4Parser,n=!1;if((new r).box("moov",r.children).box("trak",r.children).box("mdia",r.children).fullBox("mdhd",(function(e){goog.asserts.assert(0==e.version||1==e.version,"MDHD version can only be 0 or 1"),e=shaka.util.Mp4BoxParsers.parseMDHD(e.reader,e.version),t.timescale_=e.timescale})).box("minf",r.children).box("stbl",r.children).fullBox("stsd",r.sampleDescription).box("wvtt",(function(e){n=!0})).parse(e),!this.timescale_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT);if(!n)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT)},shaka.text.Mp4VttParser.prototype.setSequenceMode=function(e){},shaka.text.Mp4VttParser.prototype.setManifestType=function(e){},shaka.text.Mp4VttParser.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.timescale_)throw shaka.log.error("No init segment for MP4+VTT!"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT);var r,n=shaka.util.Mp4Parser,a=0,i=[],s=[],o=!1,l=!1,u=!1,c=null;if((new n).box("moof",n.children).box("traf",n.children).fullBox("tfdt",(function(e){o=!0,goog.asserts.assert(0==e.version||1==e.version,"TFDT version can only be 0 or 1"),a=shaka.util.Mp4BoxParsers.parseTFDTInaccurate(e.reader,e.version).baseMediaDecodeTime})).fullBox("tfhd",(function(e){goog.asserts.assert(null!=e.flags,"A TFHD box should have a valid flags value"),c=shaka.util.Mp4BoxParsers.parseTFHD(e.reader,e.flags).defaultSampleDuration})).fullBox("trun",(function(e){l=!0,goog.asserts.assert(null!=e.version,"A TRUN box should have a valid version value"),goog.asserts.assert(null!=e.flags,"A TRUN box should have a valid flags value"),i=shaka.util.Mp4BoxParsers.parseTRUN(e.reader,e.version,e.flags).sampleData})).box("mdat",n.allData((function(e){goog.asserts.assert(!u,"VTT cues in mp4 with multiple MDAT are not currently supported"),u=!0,r=e}))).parse(e,!1),!u&&!o&&!l)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT);e=a,n=new shaka.util.DataViewReader(r,shaka.util.DataViewReader.Endianness.BIG_ENDIAN);for(var d=$jscomp.makeIterator(i),p=d.next();!p.done;p=d.next()){var h=(p=p.value).sampleDuration||c,f=p.sampleCompositionTimeOffset?a+p.sampleCompositionTimeOffset:e;e=f+(h||0);var m=0;do{var g=n.readUint32();m+=g;var y=n.readUint32(),v=null;"vttc"==(y=shaka.util.Mp4Parser.typeToString(y))?8<g&&(v=n.readBytes(g-8)):("vtte"!=y&&shaka.log.error("Unknown box "+y+"! Skipping!"),n.skip(g-8)),h?v&&(goog.asserts.assert(null!=this.timescale_,"Timescale should not be null!"),g=shaka.text.Mp4VttParser.parseVTTC_(v,t.periodStart+f/this.timescale_,t.periodStart+e/this.timescale_),s.push(g)):shaka.log.error("WVTT sample duration unknown, and no default found!"),goog.asserts.assert(!p.sampleSize||m<=p.sampleSize,"The samples do not fit evenly into the sample sizes given in the TRUN box!")}while(p.sampleSize&&m<p.sampleSize)}return goog.asserts.assert(!n.hasMoreData(),"MDAT which contain VTT cues and non-VTT data are not currently supported!"),s.filter(shaka.util.Functional.isNotNull)},shaka.text.Mp4VttParser.parseVTTC_=function(e,t,r){var n,a,i;return(new shaka.util.Mp4Parser).box("payl",shaka.util.Mp4Parser.allData((function(e){n=shaka.util.StringUtils.fromUTF8(e)}))).box("iden",shaka.util.Mp4Parser.allData((function(e){a=shaka.util.StringUtils.fromUTF8(e)}))).box("sttg",shaka.util.Mp4Parser.allData((function(e){i=shaka.util.StringUtils.fromUTF8(e)}))).parse(e),n?shaka.text.Mp4VttParser.assembleCue_(n,a,i,t,r):null},shaka.text.Mp4VttParser.assembleCue_=function(e,t,r,n,a){if(e=new shaka.text.Cue(n,a,e),shaka.text.Cue.parseCuePayload(e),t&&(e.id=t),r)for(r=(t=new shaka.util.TextParser(r)).readWord();r;)shaka.text.VttTextParser.parseCueSetting(e,r,[])||shaka.log.warning("VTT parser encountered an invalid VTT setting: ",r," The setting will be ignored."),t.skipWhitespace(),r=t.readWord();return e},goog.exportSymbol("shaka.text.Mp4VttParser",shaka.text.Mp4VttParser),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"parseMedia",shaka.text.Mp4VttParser.prototype.parseMedia),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"setManifestType",shaka.text.Mp4VttParser.prototype.setManifestType),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"setSequenceMode",shaka.text.Mp4VttParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"parseInit",shaka.text.Mp4VttParser.prototype.parseInit),shaka.text.TextEngine.registerParser('application/mp4; codecs="wvtt"',(function(){return new shaka.text.Mp4VttParser})),shaka.text.SbvTextParser=function(){},shaka.text.SbvTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"SubViewer does not have init segments")},shaka.text.SbvTextParser.prototype.setSequenceMode=function(e){},shaka.text.SbvTextParser.prototype.setManifestType=function(e){},shaka.text.SbvTextParser.prototype.parseMedia=function(e,t){if(t=shaka.util.StringUtils.fromUTF8(e).replace(/\r+/g,""),e=[],""==(t=t.trim()))return e;t=t.split("\n\n");for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next()){var n=r.value.split("\n"),a=new shaka.util.TextParser(n[0]);r=a.parseTime();var i=a.readRegex(/,/g);if(a=a.parseTime(),null==r||null==i||null==a)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"Could not parse cue time range in SubViewer");n=n.slice(1).join("\n").trim(),r=new shaka.text.Cue(r,a,n),e.push(r)}return e},goog.exportSymbol("shaka.text.SbvTextParser",shaka.text.SbvTextParser),goog.exportProperty(shaka.text.SbvTextParser.prototype,"parseMedia",shaka.text.SbvTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.SbvTextParser.prototype,"setManifestType",shaka.text.SbvTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.SbvTextParser.prototype,"setSequenceMode",shaka.text.SbvTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.SbvTextParser.prototype,"parseInit",shaka.text.SbvTextParser.prototype.parseInit),shaka.text.TextEngine.registerParser("text/x-subviewer",(function(){return new shaka.text.SbvTextParser})),shaka.text.SrtTextParser=function(){this.parser_=new shaka.text.VttTextParser},shaka.text.SrtTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"SRT does not have init segments")},shaka.text.SrtTextParser.prototype.setSequenceMode=function(e){},shaka.text.SrtTextParser.prototype.setManifestType=function(e){},shaka.text.SrtTextParser.prototype.parseMedia=function(e,t,r){var n=shaka.text.SrtTextParser,a=shaka.util.BufferUtils,i=shaka.util.StringUtils;return e=i.fromUTF8(e),n=n.srt2webvtt(e),a=a.toUint8(i.toUTF8(n)),this.parser_.parseMedia(a,t,r,[])},shaka.text.SrtTextParser.srt2webvtt=function(e){var t=shaka.text.SrtTextParser,r="WEBVTT\n\n";if(""==e)return r;e=(e=(e=e.replace(/\r+/g,"")).trim()).split("\n\n");for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())r+=t.convertSrtCue_(n.value);return r},shaka.text.SrtTextParser.convertSrtCue_=function(e){return(e=e.split(/\n/))[0].match(/\d+/)&&e.shift(),e[0]=e[0].replace(/,/g,"."),e.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n"},goog.exportSymbol("shaka.text.SrtTextParser",shaka.text.SrtTextParser),goog.exportProperty(shaka.text.SrtTextParser,"srt2webvtt",shaka.text.SrtTextParser.srt2webvtt),goog.exportProperty(shaka.text.SrtTextParser.prototype,"parseMedia",shaka.text.SrtTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.SrtTextParser.prototype,"setManifestType",shaka.text.SrtTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.SrtTextParser.prototype,"setSequenceMode",shaka.text.SrtTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.SrtTextParser.prototype,"parseInit",shaka.text.SrtTextParser.prototype.parseInit),shaka.text.TextEngine.registerParser("text/srt",(function(){return new shaka.text.SrtTextParser})),shaka.text.SsaTextParser=function(){},shaka.text.SsaTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"SSA does not have init segments")},shaka.text.SsaTextParser.prototype.setSequenceMode=function(e){},shaka.text.SsaTextParser.prototype.setManifestType=function(e){},shaka.text.SsaTextParser.prototype.parseMedia=function(e,t){t=shaka.text.SsaTextParser;var r="",n="",a=null,i=null;for(i=shaka.util.StringUtils.fromUTF8(e).split(/\r?\n\s*\r?\n/),i=(e=$jscomp.makeIterator(i)).next();!i.done;i=e.next()){var s=i.value;i=s,(s=t.ssaContent_.exec(s))&&(a=s[1],i=s[2]),"V4 Styles"==a||"V4+ Styles"==a?(r=i,r=n?r+"\n"+i:i):"Events"==a?n=n?n+"\n"+i:i:"Script Info"!=a&&shaka.log.warning("SsaTextParser parser encountered an unknown part.",i)}for(a=[],i=null,r=r.split(/\r?\n/),e=(r=$jscomp.makeIterator(r)).next();!e.done;e=r.next())if(e=e.value,!/^\s*;/.test(e)&&(s=t.lineParts_.exec(e)))if(e=s[1].trim(),s=s[2].trim(),"Format"==e)i=s.split(t.valuesFormat_);else if("Style"==e){e=s.split(t.valuesFormat_),s={};for(var o=0;o<i.length&&o<e.length;o++)s[i[o]]=e[o];a.push(s)}for(i=[],r=null,n=n.split(/\r?\n/),s=(n=$jscomp.makeIterator(n)).next(),e={};!s.done;e={styleName:void 0},s=n.next())if(s=s.value,!/^\s*;/.test(s)&&(o=t.lineParts_.exec(s)))if(s=o[1].trim(),o=o[2].trim(),"Format"==s)r=o.split(t.valuesFormat_);else if("Dialogue"==s){o=o.split(t.valuesFormat_),s={};for(var l=0;l<r.length&&l<o.length;l++)s[r[l]]=o[l];l=t.parseTime_(s.Start);var u=t.parseTime_(s.End);o=o.slice(r.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,""),o=new shaka.text.Cue(l,u,o),e.styleName=s.Style,(e=a.find(function(e){return function(t){return t.Name==e.styleName}}(e)))&&t.addStyle_(o,e),i.push(o)}return i},shaka.text.SsaTextParser.addStyle_=function(e,t){var r=shaka.text.Cue,n=shaka.text.SsaTextParser,a=t.Fontname;if(a&&(e.fontFamily=a),(a=t.Fontsize)&&(e.fontSize=a+"px"),(a=t.PrimaryColour)&&(a=n.parseSsaColor_(a))&&(e.color=a),(a=t.BackColour)&&(n=n.parseSsaColor_(a))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=r.fontWeight.BOLD),t.Italic&&(e.fontStyle=r.fontStyle.ITALIC),t.Underline&&e.textDecoration.push(r.textDecoration.UNDERLINE),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=r.displayAlign.AFTER,e.textAlign=r.textAlign.START;break;case 2:e.displayAlign=r.displayAlign.AFTER,e.textAlign=r.textAlign.CENTER;break;case 3:e.displayAlign=r.displayAlign.AFTER,e.textAlign=r.textAlign.END;break;case 5:e.displayAlign=r.displayAlign.BEFORE,e.textAlign=r.textAlign.START;break;case 6:e.displayAlign=r.displayAlign.BEFORE,e.textAlign=r.textAlign.CENTER;break;case 7:e.displayAlign=r.displayAlign.BEFORE,e.textAlign=r.textAlign.END;break;case 9:e.displayAlign=r.displayAlign.CENTER,e.textAlign=r.textAlign.START;break;case 10:e.displayAlign=r.displayAlign.CENTER,e.textAlign=r.textAlign.CENTER;break;case 11:e.displayAlign=r.displayAlign.CENTER,e.textAlign=r.textAlign.END}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))},shaka.text.SsaTextParser.parseSsaColor_=function(e){return 0<=(e=parseInt(e.replace("&H",""),16))?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null},shaka.text.SsaTextParser.parseTime_=function(e){var t=shaka.text.SsaTextParser.timeFormat_.exec(e);return 3600*(e=t[1]?parseInt(t[1].replace(":",""),10):0)+60*parseInt(t[2],10)+(t=parseFloat(t[3]))},goog.exportSymbol("shaka.text.SsaTextParser",shaka.text.SsaTextParser),goog.exportProperty(shaka.text.SsaTextParser.prototype,"parseMedia",shaka.text.SsaTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.SsaTextParser.prototype,"setManifestType",shaka.text.SsaTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.SsaTextParser.prototype,"setSequenceMode",shaka.text.SsaTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.SsaTextParser.prototype,"parseInit",shaka.text.SsaTextParser.prototype.parseInit),shaka.text.SsaTextParser.ssaContent_=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,shaka.text.SsaTextParser.lineParts_=/^\s*([^:]+):\s*(.*)/,shaka.text.SsaTextParser.valuesFormat_=/\s*,\s*/,shaka.text.SsaTextParser.timeFormat_=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/,shaka.text.TextEngine.registerParser("text/x-ssa",(function(){return new shaka.text.SsaTextParser})),shaka.transmuxer.ADTS=function(){},shaka.transmuxer.ADTS.parseHeader=function(e,t){var r=shaka.transmuxer.ADTS,n=r.getHeaderLength(e,t);return t+n<=e.length&&0<(e=r.getFullFrameLength(e,t)-n)?{headerLength:n,frameLength:e}:null},shaka.transmuxer.ADTS.parseInfo=function(e,t){var r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],n=(60&e[t+2])>>>2;if(n>r.length-1)return null;var a=1+((192&e[t+2])>>>6),i=(1&e[t+2])<<2;return i|=(192&e[t+3])>>>6,{sampleRate:r[n],channelCount:i,codec:"mp4a.40."+a}},shaka.transmuxer.ADTS.isHeaderPattern=function(e,t){return 255===e[t]&&240==(246&e[t+1])},shaka.transmuxer.ADTS.getHeaderLength=function(e,t){return 1&e[t+1]?7:9},shaka.transmuxer.ADTS.getFullFrameLength=function(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5},shaka.transmuxer.ADTS.isHeader=function(e,t){var r=shaka.transmuxer.ADTS;return t+1<e.length&&r.isHeaderPattern(e,t)},shaka.transmuxer.ADTS.probe=function(e,t){var r=shaka.transmuxer.ADTS;if(r.isHeader(e,t)){var n=r.getHeaderLength(e,t);if(t+n>=e.length)return!1;var a=r.getFullFrameLength(e,t);return!(a<=n)&&((t+=a)===e.length||r.isHeader(e,t))}return!1},shaka.transmuxer.ADTS.getFrameDuration=function(e){return 9e4*shaka.transmuxer.ADTS.AAC_SAMPLES_PER_FRAME/e},shaka.transmuxer.ADTS.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},shaka.transmuxer.ADTS.AAC_SAMPLES_PER_FRAME=1024,shaka.transmuxer.AacTransmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map,this.lastInitSegment_=null},shaka.transmuxer.AacTransmuxer.prototype.destroy=function(){this.initSegments.clear()},shaka.transmuxer.AacTransmuxer.prototype.isSupported=function(e,t){return t=shaka.media.Capabilities,!!this.isAacContainer_(e)&&t.isTypeSupported(this.convertCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e))},shaka.transmuxer.AacTransmuxer.prototype.isAacContainer_=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]},shaka.transmuxer.AacTransmuxer.prototype.convertCodecs=function(e,t){return this.isAacContainer_(t)?'audio/mp4; codecs="'+(shaka.util.MimeUtils.getCodecs(t)||"mp4a.40.2")+'"':t},shaka.transmuxer.AacTransmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.AacTransmuxer.prototype.transmux=function(e,t,r,n){for(var a=shaka.transmuxer.ADTS,i=shaka.util.Uint8ArrayUtils,s=shaka.util.BufferUtils.toUint8(e),o=shaka.util.Id3Utils.getID3Data(s),l=o.length;l<s.length&&!a.probe(s,l);l++);if(e=1e3*r.endTime,(o=shaka.util.Id3Utils.getID3Frames(o)).length&&r&&(o=o.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(e=o.data),!(o=a.parseInfo(s,l)))return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null));t.audioSamplingRate=o.sampleRate,t.channelsCount=o.channelCount;for(var u=[];l<s.length;){var c=a.parseHeader(s,l);if(!c)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null));var d=c.headerLength+c.frameLength;if(l+d<=s.length){var p=s.subarray(l+c.headerLength,l+d);u.push({data:p,size:c.frameLength,duration:a.AAC_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}})}l+=d}return a=o.sampleRate,e=Math.floor(e*a/1e3),n={id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:o.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:a,duration:n,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:e,samples:u},stream:t},n=new shaka.util.Mp4Generator([n]),r=t.id+"_"+r.discontinuitySequence,this.initSegments.has(r)?t=this.initSegments.get(r):(t=n.initSegment(),this.initSegments.set(r,t)),r=this.lastInitSegment_!==t,n=n.segmentData(),this.lastInitSegment_=t,this.frameIndex_++,r?(i=i.concat(t,n),Promise.resolve(i)):Promise.resolve(n)},goog.exportSymbol("shaka.transmuxer.AacTransmuxer",shaka.transmuxer.AacTransmuxer),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"transmux",shaka.transmuxer.AacTransmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.AacTransmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"convertCodecs",shaka.transmuxer.AacTransmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"isSupported",shaka.transmuxer.AacTransmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"destroy",shaka.transmuxer.AacTransmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("audio/aac",(function(){return new shaka.transmuxer.AacTransmuxer("audio/aac")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.Ac3=function(){},shaka.transmuxer.Ac3.parseFrame=function(e,t){if(t+8>e.length||11!==e[t]||119!==e[t+1])return null;var r=e[t+4]>>6;if(3<=r)return null;var n=63&e[t+4],a=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*n+r];if(t+a>e.length)return null;var i=e[t+6]>>5,s=0;2===i?s+=2:(1&i&&1!==i&&(s+=2),4&i&&(s+=2)),s=(e[t+6]<<8|e[t+7])>>12-s&1;var o=7&e[t+5];return e=new Uint8Array([r<<6|e[t+5]>>3<<1|o>>2,(3&o)<<6|i<<3|s<<2|n>>4,n<<4&224]),{sampleRate:[48e3,44100,32e3][r],channelCount:[2,1,2,3,3,4,4,5][i]+s,audioConfig:e,frameLength:a}},shaka.transmuxer.Ac3.probe=function(e,t){if(11===e[t]&&119===e[t+1]){var r,n,a=0,i=5;for(t+=i;0<i;){n=e[t];var s=Math.min(i,8),o=8-s;r=(n&(r=4278190080>>>24+o<<o))>>o,a=a?a<<s|r:r,t+=1,i-=s}if(16>a)return!0}return!1},shaka.transmuxer.Ac3.AC3_SAMPLES_PER_FRAME=1536,shaka.transmuxer.Ac3Transmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map,this.lastInitSegment_=null},shaka.transmuxer.Ac3Transmuxer.prototype.destroy=function(){this.initSegments.clear()},shaka.transmuxer.Ac3Transmuxer.prototype.isSupported=function(e,t){return t=shaka.media.Capabilities,!!this.isAc3Container_(e)&&t.isTypeSupported(this.convertCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e))},shaka.transmuxer.Ac3Transmuxer.prototype.isAc3Container_=function(e){return"audio/ac3"==e.toLowerCase().split(";")[0]},shaka.transmuxer.Ac3Transmuxer.prototype.convertCodecs=function(e,t){return this.isAc3Container_(t)?shaka.util.Platform.requiresEC3InitSegments()?'audio/mp4; codecs="ec-3"':'audio/mp4; codecs="ac-3"':t},shaka.transmuxer.Ac3Transmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.Ac3Transmuxer.prototype.transmux=function(e,t,r,n){var a=shaka.transmuxer.Ac3,i=shaka.util.Uint8ArrayUtils;e=shaka.util.BufferUtils.toUint8(e);for(var s=shaka.util.Id3Utils.getID3Data(e),o=s.length;o<e.length&&!a.probe(e,o);o++);var l=1e3*r.endTime;(s=shaka.util.Id3Utils.getID3Frames(s)).length&&r&&(s=s.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(l=s.data),s=0;for(var u=new Uint8Array([]),c=[];o<e.length;){var d=a.parseFrame(e,o);if(!d)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null));t.audioSamplingRate=d.sampleRate,t.channelsCount=d.channelCount,s=d.sampleRate,u=d.audioConfig;var p=e.subarray(o,o+d.frameLength);c.push({data:p,size:d.frameLength,duration:a.AC3_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),o+=d.frameLength}return a=Math.floor(l*s/1e3),n={id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:s,duration:n,videoNalus:[],audioConfig:u,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:a,samples:c},stream:t},n=new shaka.util.Mp4Generator([n]),r=t.id+"_"+r.discontinuitySequence,this.initSegments.has(r)?t=this.initSegments.get(r):(t=n.initSegment(),this.initSegments.set(r,t)),r=this.lastInitSegment_!==t,n=n.segmentData(),this.lastInitSegment_=t,this.frameIndex_++,r?(i=i.concat(t,n),Promise.resolve(i)):Promise.resolve(n)},goog.exportSymbol("shaka.transmuxer.Ac3Transmuxer",shaka.transmuxer.Ac3Transmuxer),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"transmux",shaka.transmuxer.Ac3Transmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.Ac3Transmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"convertCodecs",shaka.transmuxer.Ac3Transmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"isSupported",shaka.transmuxer.Ac3Transmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"destroy",shaka.transmuxer.Ac3Transmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("audio/ac3",(function(){return new shaka.transmuxer.Ac3Transmuxer("audio/ac3")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.Ec3=function(){},shaka.transmuxer.Ec3.parseFrame=function(e,t){if(t+8>e.length||!shaka.transmuxer.Ec3.probe(e,t))return null;var r=new shaka.util.ExpGolomb(e.subarray(t+2));r.skipBits(2),r.skipBits(3);var n=r.readBits(11)+1<<1,a=r.readBits(2);if(3==a){a=[24e3,22060,16e3][a=r.readBits(2)];var i=3}else a=[48e3,44100,32e3][a],i=r.readBits(2);var s=r.readBits(3),o=r.readBits(1);return r=r.readBits(5),t+n>e.byteLength?null:(e=Math.floor(n*a/(16*[1,2,3,6][i])),e=new Uint8Array([(8160&e)>>5,(31&e)<<3,a<<6|r<<1|0,0|s<<1|o<<0,0]),{sampleRate:a,channelCount:[2,1,2,3,3,4,4,5][s]+o,audioConfig:e,frameLength:n})},shaka.transmuxer.Ec3.probe=function(e,t){return 2935==(e[t]<<8|e[t+1]<<0)},shaka.transmuxer.Ec3.EC3_SAMPLES_PER_FRAME=1536,shaka.transmuxer.Ec3Transmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map,this.lastInitSegment_=null},shaka.transmuxer.Ec3Transmuxer.prototype.destroy=function(){this.initSegments.clear()},shaka.transmuxer.Ec3Transmuxer.prototype.isSupported=function(e,t){return t=shaka.media.Capabilities,!!this.isEc3Container_(e)&&t.isTypeSupported(this.convertCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e))},shaka.transmuxer.Ec3Transmuxer.prototype.isEc3Container_=function(e){return"audio/ec3"==e.toLowerCase().split(";")[0]},shaka.transmuxer.Ec3Transmuxer.prototype.convertCodecs=function(e,t){return this.isEc3Container_(t)?'audio/mp4; codecs="ec-3"':t},shaka.transmuxer.Ec3Transmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.Ec3Transmuxer.prototype.transmux=function(e,t,r,n){var a=shaka.transmuxer.Ec3,i=shaka.util.Uint8ArrayUtils;e=shaka.util.BufferUtils.toUint8(e);for(var s=shaka.util.Id3Utils.getID3Data(e),o=s.length;o<e.length&&!a.probe(e,o);o++);var l=1e3*r.endTime;(s=shaka.util.Id3Utils.getID3Frames(s)).length&&r&&(s=s.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(l=s.data),s=0;for(var u=new Uint8Array([]),c=[];o<e.length;){var d=a.parseFrame(e,o);if(!d)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null));t.audioSamplingRate=d.sampleRate,t.channelsCount=d.channelCount,s=d.sampleRate,u=d.audioConfig;var p=e.subarray(o,o+d.frameLength);c.push({data:p,size:d.frameLength,duration:a.EC3_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),o+=d.frameLength}return a=Math.floor(l*s/1e3),n={id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:s,duration:n,videoNalus:[],audioConfig:u,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:a,samples:c},stream:t},n=new shaka.util.Mp4Generator([n]),r=t.id+"_"+r.discontinuitySequence,this.initSegments.has(r)?t=this.initSegments.get(r):(t=n.initSegment(),this.initSegments.set(r,t)),r=this.lastInitSegment_!==t,n=n.segmentData(),this.lastInitSegment_=t,this.frameIndex_++,r?(i=i.concat(t,n),Promise.resolve(i)):Promise.resolve(n)},goog.exportSymbol("shaka.transmuxer.Ec3Transmuxer",shaka.transmuxer.Ec3Transmuxer),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"transmux",shaka.transmuxer.Ec3Transmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.Ec3Transmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"convertCodecs",shaka.transmuxer.Ec3Transmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"isSupported",shaka.transmuxer.Ec3Transmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"destroy",shaka.transmuxer.Ec3Transmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("audio/ec3",(function(){return new shaka.transmuxer.Ec3Transmuxer("audio/ec3")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.H264=function(){},shaka.transmuxer.H264.parseInfo=function(e){var t=shaka.transmuxer.H264;if(!e.length)return null;var r=e.find((function(e){return e.type==t.NALU_TYPE_SPS_}));if(e=e.find((function(e){return e.type==t.NALU_TYPE_PPS_})),!r||!e)return null;var n=new shaka.util.ExpGolomb(r.data),a=n.readUnsignedByte();if(n.readUnsignedByte(),n.readUnsignedByte(),n.skipExpGolomb(),t.PROFILES_WITH_OPTIONAL_SPS_DATA_.includes(a)&&(3===(a=n.readUnsignedExpGolomb())&&n.skipBits(1),n.skipExpGolomb(),n.skipExpGolomb(),n.skipBits(1),n.readBoolean())){a=3!==a?8:12;for(var i=0;i<a;i++)n.readBoolean()&&(6>i?n.skipScalingList(16):n.skipScalingList(64))}if(n.skipExpGolomb(),0===(a=n.readUnsignedExpGolomb()))n.readUnsignedExpGolomb();else if(1===a)for(n.skipBits(1),n.skipExpGolomb(),n.skipExpGolomb(),a=n.readUnsignedExpGolomb(),i=0;i<a;i++)n.skipExpGolomb();n.skipExpGolomb(),n.skipBits(1);var s=n.readUnsignedExpGolomb(),o=n.readUnsignedExpGolomb(),l=n.readBits(1);0===l&&n.skipBits(1),n.skipBits(1);var u=0,c=0,d=0,p=0;if(n.readBoolean()&&(u=n.readUnsignedExpGolomb(),c=n.readUnsignedExpGolomb(),d=n.readUnsignedExpGolomb(),p=n.readUnsignedExpGolomb()),i=a=1,n.readBoolean()&&n.readBoolean()){var h=n.readUnsignedByte();0<h&&16>=h?(a=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][h-1],i=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][h-1]):255===h&&(a=n.readBits(16),i=n.readBits(16))}return n=(2-l)*(o+1)*16-2*d-2*p,s=16*(s+1)-2*u-2*c,u=[],r=r.fullData,u.push(r.byteLength>>>8&255),u.push(255&r.byteLength),u=u.concat.apply(u,$jscomp.arrayFromIterable(r)),r=[],e=e.fullData,r.push(e.byteLength>>>8&255),r.push(255&e.byteLength),r=r.concat.apply(r,$jscomp.arrayFromIterable(e)),{height:n,width:s,videoConfig:e=new Uint8Array([1,u[3],u[4],u[5],255,225].concat(u).concat([1]).concat(r)),hSpacing:a,vSpacing:i}},shaka.transmuxer.H264.getVideoSamples=function(e){for(var t=shaka.transmuxer.H264,r=[],n=null,a=!1,i=function(){if(n&&n.nalus.length&&n.frame){for(var e=[],t=$jscomp.makeIterator(n.nalus),a=t.next();!a.done;a=t.next()){var i=(a=a.value).fullData.byteLength,s=new Uint8Array(4);s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,e.push(s),e.push(a.fullData)}n.data=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(e)),r.push(n)}},s=function(e){n={data:new Uint8Array([]),frame:!1,isKeyframe:!1,pts:e.pts,dts:e.dts,nalus:[]}},o=0;o<e.length;o++){var l=e[o],u=l.nalus,c=!1;n&&u.length&&!a&&(i(),s(l));for(var d=(u=$jscomp.makeIterator(l.nalus)).next();!d.done;d=u.next()){var p=!1;switch((d=d.value).type){case t.NALU_TYPE_NDR_:var h=!1;p=!0;var f=d.data;c&&4<f.length&&(2===(f=new shaka.util.ExpGolomb(f).readSliceType())||4===f||7===f||9===f)&&(h=!0),h&&n&&n.frame&&!n.isKeyframe&&(i(),n=null),n||s(l),n.frame=!0,n.isKeyframe=h;break;case t.NALU_TYPE_IDR_:p=!0,n&&n.frame&&!n.isKeyframe&&(i(),n=null),n||s(l),n.frame=!0,n.isKeyframe=!0;break;case t.NALU_TYPE_SEI_:p=!0;break;case t.NALU_TYPE_SPS_:c=p=!0;break;case t.NALU_TYPE_PPS_:p=!0;break;case t.NALU_TYPE_AUD_:a=p=!0,n&&n.frame&&(i(),n=null),n||s(l);break;case t.NALU_TYPE_FILLER_DATA_:p=!0;break;default:p=!1}n&&p&&n.nalus.push(d)}}return i(),r},shaka.transmuxer.H264.NALU_TYPE_NDR_=1,shaka.transmuxer.H264.NALU_TYPE_IDR_=5,shaka.transmuxer.H264.NALU_TYPE_SEI_=6,shaka.transmuxer.H264.NALU_TYPE_SPS_=7,shaka.transmuxer.H264.NALU_TYPE_PPS_=8,shaka.transmuxer.H264.NALU_TYPE_AUD_=9,shaka.transmuxer.H264.NALU_TYPE_FILLER_DATA_=12,shaka.transmuxer.H264.PROFILES_WITH_OPTIONAL_SPS_DATA_=[100,110,122,244,44,83,86,118,128,138,139,134],shaka.transmuxer.H265=function(){},shaka.transmuxer.H265.parseInfo=function(e){var t=shaka.transmuxer.H265;if(!e.length)return null;var r=e.find((function(e){return e.type==t.NALU_TYPE_VPS_})),n=e.find((function(e){return e.type==t.NALU_TYPE_SPS_})),a=e.find((function(e){return e.type==t.NALU_TYPE_PPS_}));if(!r||!n||!a)return null;var i=t.parseVPS_(r.fullData);e=t.parseSPS_(n.fullData);var s=t.parsePPS_(a.fullData);return r=t.getVideoConfiguration_(r.fullData,n.fullData,a.fullData,{numTemporalLayers:i.numTemporalLayers,temporalIdNested:i.temporalIdNested,generalProfileSpace:e.generalProfileSpace,generalTierFlag:e.generalTierFlag,generalLevelIdc:e.generalLevelIdc,generalProfileIdc:e.generalProfileIdc,generalProfileCompatibilityFlags1:e.generalProfileCompatibilityFlags1,generalProfileCompatibilityFlags2:e.generalProfileCompatibilityFlags2,generalProfileCompatibilityFlags3:e.generalProfileCompatibilityFlags3,generalProfileCompatibilityFlags4:e.generalProfileCompatibilityFlags4,generalConstraintIndicatorFlags1:e.generalConstraintIndicatorFlags1,generalConstraintIndicatorFlags2:e.generalConstraintIndicatorFlags2,generalConstraintIndicatorFlags3:e.generalConstraintIndicatorFlags3,generalConstraintIndicatorFlags4:e.generalConstraintIndicatorFlags4,generalConstraintIndicatorFlags5:e.generalConstraintIndicatorFlags5,generalConstraintIndicatorFlags6:e.generalConstraintIndicatorFlags6,constantFrameRate:e.constantFrameRate,minSpatialSegmentationIdc:e.minSpatialSegmentationIdc,chromaFormatIdc:e.chromaFormatIdc,bitDepthLumaMinus8:e.bitDepthLumaMinus8,bitDepthChromaMinus8:e.bitDepthChromaMinus8,parallelismType:s.parallelismType}),{height:e.height,width:e.width,videoConfig:r,hSpacing:e.sarWidth,vSpacing:e.sarHeight}},shaka.transmuxer.H265.parseVPS_=function(e){var t=new shaka.util.ExpGolomb(e,!0);return t.readUnsignedByte(),t.readUnsignedByte(),t.readBits(4),t.readBits(2),t.readBits(6),{numTemporalLayers:(e=t.readBits(3))+1,temporalIdNested:t=t.readBoolean()}},shaka.transmuxer.H265.parseSPS_=function(e){(e=new shaka.util.ExpGolomb(e,!0)).readUnsignedByte(),e.readUnsignedByte();var t=0,r=0,n=0,a=0;e.readBits(4);var i=e.readBits(3);e.readBoolean();for(var s=e.readBits(2),o=e.readBits(1),l=e.readBits(5),u=e.readUnsignedByte(),c=e.readUnsignedByte(),d=e.readUnsignedByte(),p=e.readUnsignedByte(),h=e.readUnsignedByte(),f=e.readUnsignedByte(),m=e.readUnsignedByte(),g=e.readUnsignedByte(),y=e.readUnsignedByte(),v=e.readUnsignedByte(),_=e.readUnsignedByte(),k=[],E=[],b=0;b<i;b++)k.push(e.readBoolean()),E.push(e.readBoolean());if(0<i)for(b=i;8>b;b++)e.readBits(2);for(b=0;b<i;b++)k[b]&&e.readBits(88),E[b]&&e.readUnsignedByte();e.readUnsignedExpGolomb(),3==(k=e.readUnsignedExpGolomb())&&e.readBits(1),E=e.readUnsignedExpGolomb(),b=e.readUnsignedExpGolomb(),e.readBoolean()&&(t+=e.readUnsignedExpGolomb(),r+=e.readUnsignedExpGolomb(),n+=e.readUnsignedExpGolomb(),a+=e.readUnsignedExpGolomb());var T=e.readUnsignedExpGolomb(),A=e.readUnsignedExpGolomb(),S=e.readUnsignedExpGolomb();if(e.readBoolean())for(var P=0;P<=i;P++)e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb();else e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb();if(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readBoolean()&&e.readBoolean())for(P=0;4>P;P++)for(var C=0;C<(3===P?2:6);C++)if(e.readBoolean()){var x=Math.min(64,1<<4+(P<<1));1<P&&e.readExpGolomb();for(var I=0;I<x;I++)e.readExpGolomb()}else e.readUnsignedExpGolomb();for(e.readBoolean(),e.readBoolean(),e.readBoolean()&&(e.readUnsignedByte(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readBoolean()),P=e.readUnsignedExpGolomb(),x=C=0;x<P;x++)if(I=!1,0!==x&&(I=e.readBoolean()),I){x===P&&e.readUnsignedExpGolomb(),e.readBoolean(),e.readUnsignedExpGolomb();for(var w=I=0;w<=C;w++){var R=e.readBoolean(),M=!1;R||(M=e.readBoolean()),(R||M)&&I++}C=I}else{for(C=(w=e.readUnsignedExpGolomb())+(I=e.readUnsignedExpGolomb()),R=0;R<w;R++)e.readUnsignedExpGolomb(),e.readBoolean();for(w=0;w<I;w++)e.readUnsignedExpGolomb(),e.readBoolean()}if(e.readBoolean())for(P=e.readUnsignedExpGolomb(),C=0;C<P;C++){for(x=0;x<S+4;x++)e.readBits(1);e.readBits(1)}if(P=S=1,C=0,e.readBoolean(),e.readBoolean(),e.readBoolean()){if(e.readBoolean()&&(I=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],w=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1],0<(x=e.readUnsignedByte())&&16>=x?(S=I[x-1],P=w[x-1]):255===x&&(S=e.readBits(16),P=e.readBits(16))),e.readBoolean()&&e.readBoolean(),e.readBoolean()&&(e.readBits(3),e.readBoolean(),e.readBoolean()&&(e.readUnsignedByte(),e.readUnsignedByte(),e.readUnsignedByte())),e.readBoolean()&&(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb()),e.readBoolean(),e.readBoolean(),e.readBoolean(),(x=e.readBoolean())&&(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb()),e.readBoolean()&&(e.readBits(32),e.readBits(32),e.readBoolean()&&e.readUnsignedExpGolomb(),e.readBoolean()))for(w=!1,x=e.readBoolean(),I=e.readBoolean(),(x||I)&&((w=e.readBoolean())&&(e.readUnsignedByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),w&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5)),R=0;R<=i;R++){var D=!0;M=1,e.readBoolean()||(D=e.readBoolean());var O=!1;if(D?e.readUnsignedExpGolomb():O=e.readBoolean(),O||(M=e.readUnsignedExpGolomb()+1),x){for(D=0;D<M;D++)e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),w&&(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb());e.readBoolean()}if(I){for(D=0;D<M;D++)e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),w&&(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb());e.readBoolean()}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),C=e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb())}return{generalLevelIdc:_,generalProfileSpace:s,generalTierFlag:o,generalProfileIdc:l,generalProfileCompatibilityFlags1:u,generalProfileCompatibilityFlags2:c,generalProfileCompatibilityFlags3:d,generalProfileCompatibilityFlags4:p,generalConstraintIndicatorFlags1:h,generalConstraintIndicatorFlags2:f,generalConstraintIndicatorFlags3:m,generalConstraintIndicatorFlags4:g,generalConstraintIndicatorFlags5:y,generalConstraintIndicatorFlags6:v,minSpatialSegmentationIdc:C,constantFrameRate:0,chromaFormatIdc:k,bitDepthLumaMinus8:T,bitDepthChromaMinus8:A,width:E-(t+r)*(1===k||2===k?2:1),height:b-(n+a)*(1===k?2:1),sarWidth:S,sarHeight:P}},shaka.transmuxer.H265.parsePPS_=function(e){var t=new shaka.util.ExpGolomb(e,!0);t.readUnsignedByte(),t.readUnsignedByte(),t.readUnsignedExpGolomb(),t.readUnsignedExpGolomb(),t.readBoolean(),t.readBoolean(),t.readBits(3),t.readBoolean(),t.readBoolean(),t.readUnsignedExpGolomb(),t.readUnsignedExpGolomb(),t.readExpGolomb(),t.readBoolean(),t.readBoolean(),t.readBoolean()&&t.readUnsignedExpGolomb(),t.readExpGolomb(),t.readExpGolomb(),t.readBoolean(),t.readBoolean(),t.readBoolean(),t.readBoolean(),e=t.readBoolean();var r=1;return(t=t.readBoolean())&&e?r=0:t?r=3:e&&(r=2),{parallelismType:r}},shaka.transmuxer.H265.getVideoConfiguration_=function(e,t,r,n){var a=shaka.transmuxer.H265,i=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+r.byteLength));return i[0]=1,i[1]=(3&n.generalProfileSpace)<<6|(n.generalTierFlag?1:0)<<5|31&n.generalProfileIdc,i[2]=n.generalProfileCompatibilityFlags1,i[3]=n.generalProfileCompatibilityFlags2,i[4]=n.generalProfileCompatibilityFlags3,i[5]=n.generalProfileCompatibilityFlags4,i[6]=n.generalConstraintIndicatorFlags1,i[7]=n.generalConstraintIndicatorFlags2,i[8]=n.generalConstraintIndicatorFlags3,i[9]=n.generalConstraintIndicatorFlags4,i[10]=n.generalConstraintIndicatorFlags5,i[11]=n.generalConstraintIndicatorFlags6,i[12]=n.generalLevelIdc,i[13]=240|(3840&n.minSpatialSegmentationIdc)>>8,i[14]=255&n.minSpatialSegmentationIdc,i[15]=252|3&n.parallelismType,i[16]=252|3&n.chromaFormatIdc,i[17]=248|7&n.bitDepthLumaMinus8,i[18]=248|7&n.bitDepthChromaMinus8,i[19]=0,i[20]=0,i[21]=(3&n.constantFrameRate)<<6|(7&n.numTemporalLayers)<<3|(n.temporalIdNested?1:0)<<2|3,i[22]=3,i[23]=128|a.NALU_TYPE_VPS_,i[24]=0,i[25]=1,i[26]=(65280&e.byteLength)>>8,i[27]=(255&e.byteLength)>>0,i.set(e,28),i[23+(5+e.byteLength)+0]=128|a.NALU_TYPE_SPS_,i[23+(5+e.byteLength)+1]=0,i[23+(5+e.byteLength)+2]=1,i[23+(5+e.byteLength)+3]=(65280&t.byteLength)>>8,i[23+(5+e.byteLength)+4]=(255&t.byteLength)>>0,i.set(t,23+(5+e.byteLength)+5),i[23+(5+e.byteLength+5+t.byteLength)+0]=128|a.NALU_TYPE_PPS_,i[23+(5+e.byteLength+5+t.byteLength)+1]=0,i[23+(5+e.byteLength+5+t.byteLength)+2]=1,i[23+(5+e.byteLength+5+t.byteLength)+3]=(65280&r.byteLength)>>8,i[23+(5+e.byteLength+5+t.byteLength)+4]=(255&r.byteLength)>>0,i.set(r,23+(5+e.byteLength+5+t.byteLength)+5),i},shaka.transmuxer.H265.parseFrame=function(e){for(var t=shaka.transmuxer.H265,r=!1,n=[],a=!1,i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next()){switch((i=i.value).type){case t.NALU_TYPE_TRAIL_N_:case t.NALU_TYPE_TRAIL_R_:var s=a=!0;break;case t.NALU_TYPE_IDR_W_RADL_:case t.NALU_TYPE_IDR_N_LP_:case t.NALU_TYPE_CRA_NUT_:r=s=a=!0;break;case t.NALU_TYPE_VPS_:case t.NALU_TYPE_SPS_:case t.NALU_TYPE_PPS_:s=!0;break;case t.NALU_TYPE_AUD_:a=s=!0;break;case t.NALU_TYPE_SEI_PREFIX_:case t.NALU_TYPE_SEI_SUFFIX_:s=!0;break;default:s=!1}if(a&&s){s=i.fullData.byteLength;var o=new Uint8Array(4);o[0]=s>>24&255,o[1]=s>>16&255,o[2]=s>>8&255,o[3]=255&s,n.push(o),n.push(i.fullData)}}return n.length?{data:shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(n)),isKeyframe:r}:null},shaka.transmuxer.H265.NALU_TYPE_TRAIL_N_=1,shaka.transmuxer.H265.NALU_TYPE_TRAIL_R_=0,shaka.transmuxer.H265.NALU_TYPE_IDR_W_RADL_=19,shaka.transmuxer.H265.NALU_TYPE_IDR_N_LP_=20,shaka.transmuxer.H265.NALU_TYPE_CRA_NUT_=21,shaka.transmuxer.H265.NALU_TYPE_VPS_=32,shaka.transmuxer.H265.NALU_TYPE_SPS_=33,shaka.transmuxer.H265.NALU_TYPE_PPS_=34,shaka.transmuxer.H265.NALU_TYPE_AUD_=35,shaka.transmuxer.H265.NALU_TYPE_SEI_PREFIX_=39,shaka.transmuxer.H265.NALU_TYPE_SEI_SUFFIX_=40,shaka.transmuxer.MpegAudio=function(){},shaka.transmuxer.MpegAudio.parseHeader=function(e,t){var r=shaka.transmuxer.MpegAudio,n=e[t+1]>>3&3,a=e[t+1]>>1&3,i=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==i&&15!==i&&3!==s){var o=e[t+3]>>6;i=1e3*r.BITRATES_MAP_[14*(3===n?3-a:3===a?3:4)+i-1],s=r.SAMPLING_RATE_MAP_[3*(3===n?0:2===n?1:2)+s];var l=3===o?1:2;n=r.SAMPLES_COEFFICIENTS_[n][a];var u=r.BYTES_IN_SLOT_[a];return r=8*n*u,n=Math.floor(n*i/s+(e[t+2]>>1&1))*u,(u=(u=(navigator.userAgent||"").match(/Chrome\/(\d+)/i))?parseInt(u[1],10):0)&&87>=u&&2===a&&224e3<=i&&0===o&&(e[t+3]|=128),{sampleRate:s,channelCount:l,frameLength:n,samplesPerFrame:r}}return null},shaka.transmuxer.MpegAudio.isHeaderPattern=function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},shaka.transmuxer.MpegAudio.isHeader=function(e,t){return t+1<e.length&&shaka.transmuxer.MpegAudio.isHeaderPattern(e,t)},shaka.transmuxer.MpegAudio.probe=function(e,t){var r=shaka.transmuxer.MpegAudio;if(t+1<e.length&&r.isHeaderPattern(e,t)){var n=r.parseHeader(e,t),a=4;return n&&n.frameLength&&(a=n.frameLength),(t+=a)===e.length||r.isHeader(e,t)}return!1},shaka.transmuxer.MpegAudio.BITRATES_MAP_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],shaka.transmuxer.MpegAudio.SAMPLING_RATE_MAP_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],shaka.transmuxer.MpegAudio.SAMPLES_COEFFICIENTS_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],shaka.transmuxer.MpegAudio.BYTES_IN_SLOT_=[0,1,1,4],shaka.transmuxer.MpegAudio.MPEG_AUDIO_SAMPLE_PER_FRAME=1152,shaka.transmuxer.Mp3Transmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map,this.lastInitSegment_=null},shaka.transmuxer.Mp3Transmuxer.prototype.destroy=function(){this.initSegments.clear()},shaka.transmuxer.Mp3Transmuxer.prototype.isSupported=function(e,t){return t=shaka.media.Capabilities,!!this.isMpegContainer_(e)&&t.isTypeSupported(this.convertCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e))},shaka.transmuxer.Mp3Transmuxer.prototype.isMpegContainer_=function(e){return"audio/mpeg"==e.toLowerCase().split(";")[0]},shaka.transmuxer.Mp3Transmuxer.prototype.convertCodecs=function(e,t){return this.isMpegContainer_(t)?'audio/mp4; codecs="mp3"':t},shaka.transmuxer.Mp3Transmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.Mp3Transmuxer.prototype.transmux=function(e,t,r,n){for(var a=shaka.transmuxer.MpegAudio,i=shaka.util.Uint8ArrayUtils,s=shaka.util.BufferUtils.toUint8(e),o=shaka.util.Id3Utils.getID3Data(s).length;o<s.length&&!a.probe(s,o);o++);var l;for(e=[];o<s.length;){var u=a.parseHeader(s,o);if(!u)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null));l||(l=u),o+u.frameLength<=s.length&&e.push({data:s.subarray(o,o+u.frameLength),size:u.frameLength,duration:a.MPEG_AUDIO_SAMPLE_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),o+=u.frameLength}return l?(a=9e4*l.samplesPerFrame/l.sampleRate*this.frameIndex_,n={id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:l.sampleRate,duration:n,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:a,samples:e},stream:t},n=new shaka.util.Mp4Generator([n]),r=t.id+"_"+r.discontinuitySequence,this.initSegments.has(r)?t=this.initSegments.get(r):(t=n.initSegment(),this.initSegments.set(r,t)),r=this.lastInitSegment_!==t,n=n.segmentData(),this.lastInitSegment_=t,this.frameIndex_++,r?(i=i.concat(t,n),Promise.resolve(i)):Promise.resolve(n)):Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null))},goog.exportSymbol("shaka.transmuxer.Mp3Transmuxer",shaka.transmuxer.Mp3Transmuxer),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"transmux",shaka.transmuxer.Mp3Transmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.Mp3Transmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"convertCodecs",shaka.transmuxer.Mp3Transmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"isSupported",shaka.transmuxer.Mp3Transmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"destroy",shaka.transmuxer.Mp3Transmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("audio/mpeg",(function(){return new shaka.transmuxer.Mp3Transmuxer("audio/mpeg")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.MpegTsTransmuxer=function(e){this.originalMimeType_=e,this.tsParser_=null},shaka.transmuxer.MpegTsTransmuxer.prototype.destroy=function(){},shaka.transmuxer.MpegTsTransmuxer.prototype.isSupported=function(e,t){if(t=shaka.media.Capabilities,!this.isTsContainer_(e))return!1;var r=shaka.util.ManifestParserUtils.ContentType,n=shaka.util.MimeUtils,a=n.getCodecs(e),i=n.splitCodecs(a);return a=shaka.util.ManifestParserUtils.guessCodecsSafe(r.AUDIO,i),i=shaka.util.ManifestParserUtils.guessCodecsSafe(r.VIDEO,i),!(!a||i||"mp3"!=n.getNormalizedCodec(a))&&t.isTypeSupported(this.convertCodecs(r.AUDIO,e))},shaka.transmuxer.MpegTsTransmuxer.prototype.isTsContainer_=function(e){return"video/mp2t"==e.toLowerCase().split(";")[0]},shaka.transmuxer.MpegTsTransmuxer.prototype.convertCodecs=function(e,t){return this.isTsContainer_(t)?"audio/mpeg":t},shaka.transmuxer.MpegTsTransmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.MpegTsTransmuxer.prototype.transmux=function(e,t,r,n,a){t=shaka.transmuxer.MpegAudio;var i=shaka.util.ManifestParserUtils.ContentType;if(n=shaka.util.Uint8ArrayUtils,this.tsParser_?this.tsParser_.clearData():this.tsParser_=new shaka.util.TsParser,e=shaka.util.BufferUtils.toUint8(e),"mp3"!=(e=this.tsParser_.parse(e)).getCodecs().audio||a!=i.AUDIO)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null));for(r=new Uint8Array([]),a=$jscomp.makeIterator(e.getAudioData()),e=a.next();!e.done;e=a.next())if(e=e.value.data)for(i=0;i<e.length;){var s=t.parseHeader(e,i);s?(i+s.frameLength<=e.length&&(r=n.concat(r,e.subarray(i,i+s.frameLength))),i+=s.frameLength):i++}return Promise.resolve(r)},goog.exportSymbol("shaka.transmuxer.MpegTsTransmuxer",shaka.transmuxer.MpegTsTransmuxer),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"transmux",shaka.transmuxer.MpegTsTransmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.MpegTsTransmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"convertCodecs",shaka.transmuxer.MpegTsTransmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"isSupported",shaka.transmuxer.MpegTsTransmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"destroy",shaka.transmuxer.MpegTsTransmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("video/mp2t",(function(){return new shaka.transmuxer.MpegTsTransmuxer("video/mp2t")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.PREFERRED_SECONDARY),shaka.transmuxer.MssTransmuxer=function(e){this.originalMimeType_=e,(this.isoBoxer_=shaka.dependencies.isoBoxer())&&this.addSpecificBoxProcessor_()},shaka.transmuxer.MssTransmuxer.prototype.addSpecificBoxProcessor_=function(){this.isoBoxer_.addBoxProcessor("saio",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)})),this.isoBoxer_.addBoxProcessor("saiz",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}));var e=function(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,(function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,(function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32)})))}))};this.isoBoxer_.addBoxProcessor("senc",e),this.isoBoxer_.addBoxProcessor("uuid",(function(){for(var t=shaka.transmuxer.MssTransmuxer,r=!0,n=0;16>n;n++)this.usertype[n]!==t.UUID_SENC_[n]&&(r=!1);r&&(this._parsing&&(this.type="sepiff"),e.call(this))}))},shaka.transmuxer.MssTransmuxer.prototype.destroy=function(){},shaka.transmuxer.MssTransmuxer.prototype.isSupported=function(e,t){var r=shaka.media.Capabilities,n=e.startsWith("mss/");return!(!this.isoBoxer_||!n)&&(t?r.isTypeSupported(this.convertCodecs(t,e)):(n=shaka.util.ManifestParserUtils.ContentType,t=this.convertCodecs(n.AUDIO,e),e=this.convertCodecs(n.VIDEO,e),r.isTypeSupported(t)||r.isTypeSupported(e)))},shaka.transmuxer.MssTransmuxer.prototype.convertCodecs=function(e,t){return t.replace("mss/","")},shaka.transmuxer.MssTransmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.MssTransmuxer.prototype.transmux=function(e,t,r){if(!r)return Promise.resolve(shaka.util.BufferUtils.toUint8(e));if(!t.mssPrivateData)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MSS_MISSING_DATA_FOR_TRANSMUXING,r?r.getUris()[0]:null));try{var n=this.processMediaSegment_(e,t,r);return Promise.resolve(n)}catch(e){return e instanceof shaka.util.Error?Promise.reject(e):Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MSS_TRANSMUXING_FAILED,r?r.getUris()[0]:null))}},shaka.transmuxer.MssTransmuxer.prototype.processMediaSegment_=function(e,t,r){var n=(e=this.isoBoxer_.parseBuffer(e)).fetch("tfhd");n.track_ID=t.id+1;var a=e.fetch("tfdt"),i=e.fetch("traf");if(null===a&&((a=this.isoBoxer_.createFullBox("tfdt",i,n)).version=1,a.flags=0,a.baseMediaDecodeTime=Math.floor(r.startTime*t.mssPrivateData.timescale)),t=e.fetch("trun"),(r=e.fetch("tfxd"))&&r._parent.boxes.splice(r._parent.boxes.indexOf(r),1),(r=e.fetch("tfrf"))&&r._parent.boxes.splice(r._parent.boxes.indexOf(r),1),null!==(r=e.fetch("sepiff"))&&(r.type="senc",r.usertype=void 0,null===(a=e.fetch("saio")))){(a=this.isoBoxer_.createFullBox("saio",i)).version=0,a.flags=0,a.entry_count=1,a.offset=[0];var s=this.isoBoxer_.createFullBox("saiz",i);if(s.version=0,s.flags=0,s.sample_count=r.sample_count,s.default_sample_info_size=0,s.sample_info_size=[],2&r.flags)for(a=0;a<r.sample_count;a+=1)s.sample_info_size[a]=10+6*r.entry[a].NumberOfEntries;else s.default_sample_info_size=8}return n.flags&=16777214,n.flags|=131072,t.flags|=1,r=(n=e.fetch("moof")).getLength(),t.data_offset=r+8,null!==(t=e.fetch("saio"))&&(n=this.getBoxOffset_(n,"traf"),i=this.getBoxOffset_(i,"senc"),t.offset[0]=n+i+16),shaka.util.BufferUtils.toUint8(e.write())},shaka.transmuxer.MssTransmuxer.prototype.getBoxOffset_=function(e,t){for(var r=8,n=0;n<e.boxes.length&&e.boxes[n].type!==t;n++)r+=e.boxes[n].size;return r},goog.exportSymbol("shaka.transmuxer.MssTransmuxer",shaka.transmuxer.MssTransmuxer),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"transmux",shaka.transmuxer.MssTransmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.MssTransmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"convertCodecs",shaka.transmuxer.MssTransmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"isSupported",shaka.transmuxer.MssTransmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"destroy",shaka.transmuxer.MssTransmuxer.prototype.destroy),shaka.transmuxer.MssTransmuxer.UUID_SENC_=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("mss/audio/mp4",(function(){return new shaka.transmuxer.MssTransmuxer("mss/audio/mp4")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("mss/video/mp4",(function(){return new shaka.transmuxer.MssTransmuxer("mss/video/mp4")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.Opus=function(){},shaka.transmuxer.Opus.getAudioConfig=function(e){var t=[];switch(e.channelConfigCode){case 1:case 2:t=[0];break;case 0:t=[255,1,1,0,1];break;case 128:t=[255,2,0,0,1];break;case 3:t=[1,2,1,0,2,1];break;case 4:t=[1,2,2,0,1,2,3];break;case 5:t=[1,3,2,0,4,1,2,3];break;case 6:t=[1,4,2,0,4,1,2,3,5];break;case 7:t=[1,4,2,0,4,1,2,3,5,6];break;case 8:t=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:t=[1,1,2,0,1];break;case 131:t=[1,1,3,0,1,2];break;case 132:t=[1,1,4,0,1,2,3];break;case 133:t=[1,1,5,0,1,2,3,4];break;case 134:t=[1,1,6,0,1,2,3,4,5];break;case 135:t=[1,1,7,0,1,2,3,4,5,6];break;case 136:t=[1,1,8,0,1,2,3,4,5,6,7]}return new Uint8Array([0,e.channelCount,0,0,e.sampleRate>>>24&255,e.sampleRate>>>17&255,e.sampleRate>>>8&255,e.sampleRate>>>0&255,0,0].concat($jscomp.arrayFromIterable(t)))},shaka.transmuxer.Opus.OPUS_AUDIO_SAMPLE_PER_FRAME=960,shaka.transmuxer.TsTransmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map,this.lastInitSegment_=this.aacTransmuxer_=this.tsParser_=null},shaka.transmuxer.TsTransmuxer.prototype.destroy=function(){this.initSegments.clear(),this.aacTransmuxer_&&this.aacTransmuxer_.destroy()},shaka.transmuxer.TsTransmuxer.prototype.isSupported=function(e,t){var r=shaka.media.Capabilities;if(!this.isTsContainer_(e))return!1;var n=shaka.util.ManifestParserUtils.ContentType,a=shaka.util.MimeUtils,i=e;t&&(i=this.convertCodecs(t,e)),i=a.getCodecs(i),i=a.splitCodecs(i);var s=shaka.util.ManifestParserUtils.guessCodecsSafe(n.AUDIO,i),o=shaka.util.ManifestParserUtils.guessCodecsSafe(n.VIDEO,i);return i=shaka.transmuxer.TsTransmuxer,!(s&&(s=a.getNormalizedCodec(s),!i.SUPPORTED_AUDIO_CODECS_.includes(s))||o&&(a=a.getNormalizedCodec(o),!i.SUPPORTED_VIDEO_CODECS_.includes(a)))&&(t?r.isTypeSupported(this.convertCodecs(t,e)):(t=this.convertCodecs(n.AUDIO,e),e=this.convertCodecs(n.VIDEO,e),r.isTypeSupported(t)||r.isTypeSupported(e)))},shaka.transmuxer.TsTransmuxer.prototype.isTsContainer_=function(e){return"video/mp2t"==e.toLowerCase().split(";")[0]},shaka.transmuxer.TsTransmuxer.prototype.convertCodecs=function(e,t){if(this.isTsContainer_(t)){var r=shaka.util.ManifestParserUtils.ContentType,n=shaka.util.StreamUtils;return t=shaka.util.MimeUtils.getCodecs(t).replace("mp4a.40.34","mp3").split(",").map((function(e){return n.getCorrectAudioCodecs(e,"audio/mp4")})).map(n.getCorrectVideoCodecs).join(","),e==r.AUDIO?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'}return t},shaka.transmuxer.TsTransmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.TsTransmuxer.prototype.transmux=function(e,t,r,n,a){var i=shaka.util.ManifestParserUtils.ContentType,s=shaka.util.Uint8ArrayUtils,o=shaka.util.BufferUtils.toUint8(e);if(a==i.AUDIO&&!shaka.util.TsParser.probe(o)){for(i=(s=shaka.util.Id3Utils.getID3Data(o)).length;i<o.length;i++)if(shaka.transmuxer.MpegAudio.probe(o,i))return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null));for(i=s.length;i<o.length;i++)if(shaka.transmuxer.ADTS.probe(o,i))return this.aacTransmuxer_||(this.aacTransmuxer_=new shaka.transmuxer.AacTransmuxer("audio/aac")),this.aacTransmuxer_.transmux(e,t,r,n,a);return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null))}this.tsParser_?this.tsParser_.clearData():this.tsParser_=new shaka.util.TsParser,e=this.tsParser_.parse(o),o=[];var l=e.getCodecs();try{var u=null;if(a==i.VIDEO){switch(l.video){case"avc":u=this.getAvcStreamInfo_(e,t,n,r);break;case"hvc":u=this.getHvcStreamInfo_(e,t,n,r)}u&&(o.push(u),u=null)}if(a==i.AUDIO){switch(l.audio){case"aac":u=this.getAacStreamInfo_(e,t,n,r);break;case"ac3":u=this.getAc3StreamInfo_(e,t,n,r);break;case"ec3":u=this.getEc3StreamInfo_(e,t,n,r);break;case"mp3":u=this.getMp3StreamInfo_(e,t,n,r);break;case"opus":u=this.getOpusStreamInfo_(e,t,n,r)}u&&o.push(u)}}catch(e){return e&&e.code==shaka.util.Error.Code.TRANSMUXING_NO_VIDEO_DATA?Promise.resolve(new Uint8Array([])):Promise.reject(e)}return o.length?(n=new shaka.util.Mp4Generator(o),r=t.id+"_"+r.discontinuitySequence,this.initSegments.has(r)?t=this.initSegments.get(r):(t=n.initSegment(),this.initSegments.set(r,t)),r=this.lastInitSegment_!==t,n=n.segmentData(),this.lastInitSegment_=t,this.frameIndex_++,r?(s=s.concat(t,n),Promise.resolve(s)):Promise.resolve(n)):Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,r?r.getUris()[0]:null))},shaka.transmuxer.TsTransmuxer.prototype.getAacStreamInfo_=function(e,t,r,n){for(var a,i=shaka.transmuxer.ADTS,s=shaka.util.TsParser.Timescale,o=shaka.util.Uint8ArrayUtils,l=[],u=null,c=null,d=null,p=$jscomp.makeIterator(e.getAudioData()),h=p.next();!h.done;h=p.next()){var f=h.value;if(h=f.data){var m=0;if(-1==c&&d?(h=o.concat(d,f.data),c=null):null!=c&&d&&(m=Math.max(0,c),a=o.concat(d,h.subarray(0,m)),l.push({data:a,size:a.byteLength,duration:i.AAC_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),c=d=null),!(a=i.parseInfo(h,m)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);for(t.audioSamplingRate=a.sampleRate,t.channelsCount=a.channelCount,null==u&&null!==f.pts&&(u=f.pts);m<h.length;){if(!(f=i.parseHeader(h,m))){d=h.subarray(m,h.length),c=-1;break}var g=f.headerLength+f.frameLength;if(0!=(c=Math.max(0,m+g-h.length)))d=h.subarray(m+f.headerLength,m+g);else if(m+g<=h.length){var y=h.subarray(m+f.headerLength,m+g);l.push({data:y,size:f.frameLength,duration:i.AAC_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}})}m+=g}}}if(!a||null==u){if(!e.getVideoData().length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);if(u=n.startTime*s,a=shaka.util.MimeUtils.splitCodecs(t.codecs),!(e=shaka.util.ManifestParserUtils.guessCodecsSafe(shaka.util.ManifestParserUtils.ContentType.AUDIO,a))||!t.channelsCount||!t.audioSamplingRate)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);if(a={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,codec:e},!(e=i.getSilentFrame(e,t.channelsCount)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);for(n=u+(n.endTime-n.startTime)*s,o=u;o<n;)l.push({data:e,size:e.byteLength,duration:i.AAC_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),o+=i.AAC_SAMPLES_PER_FRAME/a.sampleRate*s}return s=u/s*(i=a.sampleRate),{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:a.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:i,duration:r,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:s,samples:l},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getAc3StreamInfo_=function(e,t,r,n){for(var a=shaka.transmuxer.Ac3,i=shaka.util.TsParser.Timescale,s=[],o=0,l=new Uint8Array([]),u=null,c=(e=$jscomp.makeIterator(e.getAudioData())).next();!c.done;c=e.next()){var d=c.value;for(c=d.data,null==u&&null!==d.pts&&(u=d.pts),d=0;d<c.length;){var p=a.parseFrame(c,d);if(p){t.audioSamplingRate=p.sampleRate,t.channelsCount=p.channelCount,o=p.sampleRate,l=p.audioConfig;var h=c.subarray(d,d+p.frameLength);s.push({data:h,size:p.frameLength,duration:a.AC3_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),d+=p.frameLength}else d++}}if(0==o||0==l.byteLength||null==u)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);return n=u/i*o,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:o,duration:r,videoNalus:[],audioConfig:l,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:n,samples:s},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getEc3StreamInfo_=function(e,t,r,n){for(var a=shaka.transmuxer.Ec3,i=shaka.util.TsParser.Timescale,s=[],o=0,l=new Uint8Array([]),u=null,c=(e=$jscomp.makeIterator(e.getAudioData())).next();!c.done;c=e.next()){var d=c.value;for(c=d.data,null==u&&null!==d.pts&&(u=d.pts),d=0;d<c.length;){var p=a.parseFrame(c,d);if(p){t.audioSamplingRate=p.sampleRate,t.channelsCount=p.channelCount,o=p.sampleRate,l=p.audioConfig;var h=c.subarray(d,d+p.frameLength);s.push({data:h,size:p.frameLength,duration:a.EC3_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),d+=p.frameLength}else d++}}if(0==o||0==l.byteLength||null==u)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);return n=u/i*o,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:o,duration:r,videoNalus:[],audioConfig:l,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:n,samples:s},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getMp3StreamInfo_=function(e,t,r,n){for(var a,i=shaka.transmuxer.MpegAudio,s=shaka.util.TsParser.Timescale,o=[],l=null,u=(e=$jscomp.makeIterator(e.getAudioData())).next();!u.done;u=e.next()){var c=u.value;if(u=c.data)for(null==l&&null!==c.pts&&(l=c.pts),c=0;c<u.length;){var d=i.parseHeader(u,c);d?(a||(a=d),c+d.frameLength<=u.length&&o.push({data:u.subarray(c,c+d.frameLength),size:d.frameLength,duration:i.MPEG_AUDIO_SAMPLE_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),c+=d.frameLength):c++}}if(!a||null==l)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);return s=l/s*(n=a.sampleRate),{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:n,duration:r,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:s,samples:o},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getOpusStreamInfo_=function(e,t,r,n){var a=shaka.transmuxer.Opus,i=shaka.util.TsParser.Timescale,s=[],o=null,l=e.getOpusMetadata();if(!l)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);for(var u=a.getAudioConfig(l),c=l.sampleRate,d=(e=$jscomp.makeIterator(e.getAudioData())).next();!d.done;d=e.next()){var p=d.value;d=p.data,null==o&&null!==p.pts&&(o=p.pts);for(var h=0;h<d.length;){p=0!=(16&d[h+1]);var f=0!=(8&d[h+1]);h+=2;for(var m=0;255===d[h];)m+=255,h+=1;m+=d[h],h+=1,h+=p?2:0,h+=f?2:0,p=d.slice(h,h+m),s.push({data:p,size:p.byteLength,duration:a.OPUS_AUDIO_SAMPLE_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),h+=m}}if(0==u.byteLength||null==o)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);return t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount,n=o/i*c,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"opus",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:c,duration:r,videoNalus:[],audioConfig:u,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:n,samples:s},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getAvcStreamInfo_=function(e,t,r,n){var a=shaka.transmuxer.H264,i=shaka.util.TsParser.Timescale,s=[],o=null;e=e.getVideoData();var l=a.getVideoSamples(e);if(!l.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_NO_VIDEO_DATA,n?n.getUris()[0]:null);for(var u=0;u<l.length;u++){var c=l[u];null==o&&(o=c.dts),s.push({data:c.data,size:c.data.byteLength,duration:u+1<l.length?(l[u+1].dts||0)-(c.dts||0):1<l.length?(c.dts||0)-(l[u-1].dts||0):(n.endTime-n.startTime)*i,cts:Math.round((c.pts||0)-(c.dts||0)),flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:c.isKeyframe?2:1,isNonSync:c.isKeyframe?0:1}})}for(l=[],u=(e=$jscomp.makeIterator(e)).next();!u.done;u=e.next())l.push.apply(l,$jscomp.arrayFromIterable(u.value.nalus));if(!(a=a.parseInfo(l))||null==o)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);return t.height=a.height,t.width=a.width,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.VIDEO,codecs:"avc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:i,duration:r,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:a.videoConfig,hSpacing:a.hSpacing,vSpacing:a.vSpacing,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:o,samples:s},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getHvcStreamInfo_=function(e,t,r,n){var a=shaka.transmuxer.H265,i=shaka.util.TsParser.Timescale,s=[],o=null,l=[];if(!(e=e.getVideoData()).length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_NO_VIDEO_DATA,n?n.getUris()[0]:null);for(var u=0;u<e.length;u++){var c=e[u],d=c.nalus;l.push.apply(l,$jscomp.arrayFromIterable(d)),(d=a.parseFrame(d))&&(null==o&&null!=c.dts&&(o=c.dts),s.push({data:d.data,size:d.data.byteLength,duration:u+1<e.length?(e[u+1].dts||0)-(c.dts||0):1<e.length?(c.dts||0)-(e[u-1].dts||0):(n.endTime-n.startTime)*i,cts:Math.round((c.pts||0)-(c.dts||0)),flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:d.isKeyframe?2:1,isNonSync:d.isKeyframe?0:1}}))}if(!(a=a.parseInfo(l))||null==o)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED,n?n.getUris()[0]:null);return t.height=a.height,t.width=a.width,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.VIDEO,codecs:"hvc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:i,duration:r,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:a.videoConfig,hSpacing:a.hSpacing,vSpacing:a.vSpacing,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:o,samples:s},stream:t}},goog.exportSymbol("shaka.transmuxer.TsTransmuxer",shaka.transmuxer.TsTransmuxer),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"transmux",shaka.transmuxer.TsTransmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.TsTransmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"convertCodecs",shaka.transmuxer.TsTransmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"isSupported",shaka.transmuxer.TsTransmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"destroy",shaka.transmuxer.TsTransmuxer.prototype.destroy),shaka.transmuxer.TsTransmuxer.SUPPORTED_AUDIO_CODECS_=["aac","ac-3","ec-3","mp3","opus"],shaka.transmuxer.TsTransmuxer.SUPPORTED_VIDEO_CODECS_=["avc","hevc"],shaka.transmuxer.TransmuxerEngine.registerTransmuxer("video/mp2t",(function(){return new shaka.transmuxer.TsTransmuxer("video/mp2t")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.PREFERRED),shaka.util.FairPlayUtils=function(){shaka.drm.FairPlay.apply(this,arguments)},$jscomp.inherits(shaka.util.FairPlayUtils,shaka.drm.FairPlay),goog.exportSymbol("shaka.util.FairPlayUtils",shaka.util.FairPlayUtils);var EmeEncryptionSchemePolyfill=function(){};EmeEncryptionSchemePolyfill.install=function(){EmeEncryptionSchemePolyfill.originalRMKSA_||navigator.emeEncryptionSchemePolyfilled?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(EmeEncryptionSchemePolyfill.originalRMKSA_=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=EmeEncryptionSchemePolyfill.probeRMKSA_,navigator.emeEncryptionSchemePolyfilled=!0):console.debug("EmeEncryptionSchemePolyfill: EME not found")},EmeEncryptionSchemePolyfill.probeRMKSA_=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),a.yield(EmeEncryptionSchemePolyfill.originalRMKSA_.call(n,e,t),2)):hasEncryptionScheme(r=a.yieldResult)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=EmeEncryptionSchemePolyfill.originalRMKSA_,a.return(r)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=EmeEncryptionSchemePolyfill.polyfillRMKSA_,a.return(EmeEncryptionSchemePolyfill.polyfillRMKSA_.call(n,e,t)))}))},EmeEncryptionSchemePolyfill.polyfillRMKSA_=function(e,t){var r,n,a,i,s,o,l,u,c,d,p,h,f=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(m){if(1==m.nextAddress){for(console.assert(f==navigator,'bad "this" for requestMediaKeySystemAccess'),r=guessSupportedScheme(e),n=[],a=$jscomp.makeIterator(t),i=a.next();!i.done;i=a.next())s=i.value,o=EmeEncryptionSchemePolyfill.filterCapabilities_(s.videoCapabilities,r),l=EmeEncryptionSchemePolyfill.filterCapabilities_(s.audioCapabilities,r),s.videoCapabilities&&s.videoCapabilities.length&&!o.length||s.audioCapabilities&&s.audioCapabilities.length&&!l.length||((u=Object.assign({},s)).videoCapabilities=o,u.audioCapabilities=l,n.push(u));if(!n.length)throw(c=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c;return m.yield(EmeEncryptionSchemePolyfill.originalRMKSA_.call(f,e,n),2)}return d=m.yieldResult,h=p=null,n[0]&&(n[0].videoCapabilities&&(p=n[0].videoCapabilities[0].encryptionScheme),n[0].audioCapabilities&&(h=n[0].audioCapabilities[0].encryptionScheme)),m.return(new EmeEncryptionSchemePolyfillMediaKeySystemAccess(d,p,h))}))},EmeEncryptionSchemePolyfill.filterCapabilities_=function(e,t){return e?e.filter((function(e){return checkSupportedScheme(e.encryptionScheme,t)})):e},goog.exportSymbol("EmeEncryptionSchemePolyfill",EmeEncryptionSchemePolyfill),goog.exportProperty(EmeEncryptionSchemePolyfill,"install",EmeEncryptionSchemePolyfill.install);var McEncryptionSchemePolyfill=function(){};McEncryptionSchemePolyfill.install=function(){McEncryptionSchemePolyfill.originalDecodingInfo_||navigator.mediaCapabilitiesEncryptionSchemePolyfilled?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(McEncryptionSchemePolyfill.originalDecodingInfo_=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=McEncryptionSchemePolyfill.probeDecodingInfo_,navigator.mediaCapabilitiesEncryptionSchemePolyfilled=!0):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")},McEncryptionSchemePolyfill.probeDecodingInfo_=function(e){var t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){switch(a.nextAddress){case 1:return console.assert(n==navigator.mediaCapabilities,'bad "this" for decodingInfo'),a.yield(McEncryptionSchemePolyfill.originalDecodingInfo_.call(n,e),2);case 2:if(!(t=a.yieldResult).supported||!e.keySystemConfiguration)return a.return(t);if((r=t.keySystemAccess)&&hasEncryptionScheme(r))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=McEncryptionSchemePolyfill.originalDecodingInfo_,a.return(t);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=McEncryptionSchemePolyfill.polyfillDecodingInfo_,r){a.jumpTo(3);break}return a.yield(McEncryptionSchemePolyfill.getMediaKeySystemAccess_(e),4);case 4:return t.keySystemAccess=a.yieldResult,a.return(t);case 3:return a.return(McEncryptionSchemePolyfill.polyfillDecodingInfo_.call(n,e))}}))},McEncryptionSchemePolyfill.polyfillDecodingInfo_=function(e){var t,r,n,a,i,s,o,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){switch(u.nextAddress){case 1:return console.assert(l==navigator.mediaCapabilities,'bad "this" for decodingInfo'),r=t=null,!e.keySystemConfiguration||(n=e.keySystemConfiguration,a=n.keySystem,r=n.audio&&n.audio.encryptionScheme,t=n.video&&n.video.encryptionScheme,i=guessSupportedScheme(a),s={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},checkSupportedScheme(r,i)&&checkSupportedScheme(t,i))?u.yield(McEncryptionSchemePolyfill.originalDecodingInfo_.call(l,e),2):u.return(s);case 2:if((o=u.yieldResult).keySystemAccess){o.keySystemAccess=new EmeEncryptionSchemePolyfillMediaKeySystemAccess(o.keySystemAccess,t,r),u.jumpTo(3);break}if(!e.keySystemConfiguration){u.jumpTo(3);break}return u.yield(McEncryptionSchemePolyfill.getMediaKeySystemAccess_(e),5);case 5:o.keySystemAccess=u.yieldResult;case 3:return u.return(o)}}))},McEncryptionSchemePolyfill.getMediaKeySystemAccess_=function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=McEncryptionSchemePolyfill.convertToMediaKeySystemConfig_(e),n.yield(navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)):(r=n.yieldResult,n.return(r))}))},McEncryptionSchemePolyfill.convertToMediaKeySystemConfig_=function(e){var t=e.keySystemConfiguration,r=[],n=[];return t.audio&&r.push({robustness:t.audio.robustness||"",contentType:e.audio.contentType,encryptionScheme:t.audio.encryptionScheme}),t.video&&n.push({robustness:t.video.robustness||"",contentType:e.video.contentType,encryptionScheme:t.video.encryptionScheme}),e={initDataTypes:t.initDataType?[t.initDataType]:[],distinctiveIdentifier:t.distinctiveIdentifier,persistentState:t.persistentState,sessionTypes:t.sessionTypes},r.length&&(e.audioCapabilities=r),n.length&&(e.videoCapabilities=n),e},goog.exportSymbol("McEncryptionSchemePolyfill",McEncryptionSchemePolyfill),goog.exportProperty(McEncryptionSchemePolyfill,"install",McEncryptionSchemePolyfill.install);var EmeEncryptionSchemePolyfillMediaKeySystemAccess=function(e,t,r){this.mksa_=e,this.videoScheme_=t||null,this.audioScheme_=r||null,this.keySystem=e.keySystem};function guessSupportedScheme(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs":e.startsWith("com.huawei")?"cenc":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function hasEncryptionScheme(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function checkSupportedScheme(e,t){return!e||e==t||!("cbcs"!=e&&"cbcs-1-9"!=e||!(EncryptionSchemePolyfills.isRecentFirefox||EncryptionSchemePolyfills.isRecentWebOS||EncryptionSchemePolyfills.isChromecast))}EmeEncryptionSchemePolyfillMediaKeySystemAccess.prototype.getConfiguration=function(){var e=this.mksa_.getConfiguration();if(e.videoCapabilities)for(var t=$jscomp.makeIterator(e.videoCapabilities),r=t.next();!r.done;r=t.next())r.value.encryptionScheme=this.videoScheme_;if(e.audioCapabilities)for(r=(t=$jscomp.makeIterator(e.audioCapabilities)).next();!r.done;r=t.next())r.value.encryptionScheme=this.audioScheme_;return e},EmeEncryptionSchemePolyfillMediaKeySystemAccess.prototype.createMediaKeys=function(){return this.mksa_.createMediaKeys()};var EncryptionSchemePolyfills=function(){},a;EncryptionSchemePolyfills.install=function(){EmeEncryptionSchemePolyfill.install(),McEncryptionSchemePolyfill.install()},goog.exportSymbol("EncryptionSchemePolyfills",EncryptionSchemePolyfills),goog.exportProperty(EncryptionSchemePolyfills,"install",EncryptionSchemePolyfills.install),EncryptionSchemePolyfills.isChromecast=navigator.userAgent.includes("CrKey"),EncryptionSchemePolyfills.isRecentFirefox=100<=parseInt(navigator.userAgent.split("Firefox/").pop(),10),EncryptionSchemePolyfills.isRecentWebOS=(a=navigator.userAgent||"",!!a.includes("Web0S")&&!!(a=a.match(/Chrome\/(\d+)/))&&79<=parseInt(a[1],10)),void 0!==module&&module.exports&&(module.exports=EncryptionSchemePolyfills)}.call(exportTo,innerGlobal,innerGlobal,void 0),exportTo.shaka)exports[k]=exportTo.shaka[k]})()},701:module=>{"use strict";var e=[];function t(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function r(r,a){for(var i={},s=[],o=0;o<r.length;o++){var l=r[o],u=a.base?l[0]+a.base:l[0],c=i[u]||0,d="".concat(u," ").concat(c);i[u]=c+1;var p=t(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(h);else{var f=n(h,a);a.byIndex=o,e.splice(o,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function n(e,t){var r=t.domAPI(t);r.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}module.exports=function(n,a){var i=r(n=n||[],a=a||{});return function(n){n=n||[];for(var s=0;s<i.length;s++){var o=t(i[s]);e[o].references--}for(var l=r(n,a),u=0;u<i.length;u++){var c=t(i[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}i=l}}},182:module=>{"use strict";module.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},75:module=>{"use strict";module.exports=function(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}},236:module=>{"use strict";module.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,a&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},213:module=>{"use strict";module.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},771:module=>{self,module.exports=function(){var e={9063:function(e,t,r){"use strict";r.d(t,{S:function(){return n}});var n={PRE:"preroll",MID:"midroll",POST:"postroll",OVERLAY:"overlay"}},4611:function(e,t,r){"use strict";r.d(t,{J:function(){return n}});var n={AD_CAN_SKIP:"adcanskip",AD_MANIFEST_LOADED:"admanifestloaded",AD_LOADED:"adloaded",AD_STARTED:"adstarted",AD_RESUMED:"adresumed",AD_PAUSED:"adpaused",AD_CLICKED:"adclicked",AD_SKIPPED:"adskipped",AD_COMPLETED:"adcompleted",AD_ERROR:"aderror",ADS_COMPLETED:"adscompleted",ALL_ADS_COMPLETED:"alladscompleted",AD_BREAK_START:"adbreakstart",AD_BREAK_END:"adbreakend",AD_FIRST_QUARTILE:"adfirstquartile",AD_MIDPOINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",USER_CLOSED_AD:"userclosedad",AD_VOLUME_CHANGED:"advolumechanged",AD_MUTED:"admuted",AD_PROGRESS:"adprogress",AD_BUFFERING:"adbuffering",AD_WATERFALLING:"adwaterfalling",AD_WATERFALLING_FAILED:"adwaterfallingfailed",AD_AUTOPLAY_FAILED:"adautoplayfailed"}},8151:function(e,t,r){"use strict";r.d(t,{J:function(){return n}});var n={VAST:"vast",VMAP:"vmap"}},7237:function(e,t,r){"use strict";r.d(t,{J:function(){return n}});var n={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"}},1057:function(e,t,r){"use strict";r.d(t,{_:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(t){(0,n.Z)(this,e),this._name=t.getName(),this._getEngineDecorator=t.getEngineDecorator.bind(t)}return(0,a.Z)(e,[{key:"getEngineDecorator",value:function(e,t){return this._getEngineDecorator(e,t)}},{key:"getName",value:function(){return this._name}}]),e}()},4779:function(e,t,r){"use strict";r.d(t,{zv:function(){return P},Hl:function(){return C},co:function(){return x}});var n,a=r(5671),i=r(3144),s=r(4942),o=r(4358),l=r(7326),u=r(9340),c=r(2963),d=r(1120),p=r(8171),h=r(8987),f=r(4270),m=r(2114),g=r(2588),y=r(6462),v=r(375),_=r(4821),k=JSON.parse('{"$":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="}'),E=(n=function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,null,[{key:"runCapability",value:function(){e._capabilities.autoplay||"boolean"==typeof e._capabilities.autoplay&&"boolean"==typeof e._capabilities.mutedAutoPlay?e._playPromiseResult=Promise.resolve(e._capabilities):(e._vid||(e._vid=_.is.createElement("video"),e._vid.src=k.$,e._vid.setAttribute("playsinline","")),e._playPromiseResult=new Promise((function(t){e._setMuted(!1),e._getPlayPromise().then((function(){return t({autoplay:!0,mutedAutoPlay:!0})})).catch((function(){e._setMuted(!0),e._getPlayPromise().then((function(){return t({autoplay:!1,mutedAutoPlay:!0})})).catch((function(){return t({autoplay:!1,mutedAutoPlay:!1})}))}))})))}},{key:"getCapability",value:function(){return e._playPromiseResult.then((function(t){var r;return t.autoplay?r=Promise.resolve(t):(e.runCapability(),r=e._playPromiseResult),r.then((function(t){return _.c7.mergeDeep(t,e._capabilities)}))}))}},{key:"setCapabilities",value:function(t){e._logger.debug("Set player capabilities",t);var r=t.autoplay,n=t.mutedAutoPlay;"boolean"==typeof r&&(e._capabilities.autoplay=r),"boolean"==typeof n&&(e._capabilities.mutedAutoPlay=n)}},{key:"_getPlayPromise",value:function(){return e._vid.play()||e._forcePromiseReturnValue()}},{key:"_setMuted",value:function(t){t?(e._vid.muted=!0,e._vid.setAttribute("muted","")):(e._vid.muted=!1,e._vid.removeAttribute("muted"))}},{key:"_forcePromiseReturnValue",value:function(){return new Promise((function(t,r){e._vid.addEventListener(m.Rk.ERROR,(function(){r()}));var n=setTimeout((function(){e._logger.debug("Timeout ".concat(500," ms has been reached")),r()}),500);!0===e._vid.paused?(clearTimeout(n),r()):(clearTimeout(n),t())}))}}]),e}(),(0,s.Z)(n,"_logger",(0,o.ZP)("Html5AutoPlayCapability")),(0,s.Z)(n,"_capabilities",{}),n),b=r(962),T=r(9439),A=function(e){(0,u.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)});function o(e,t,r){var i;return(0,a.Z)(this,o),i=n.call(this),(0,s.Z)((0,l.Z)(i),"_droppedFramesInterval",null),(0,s.Z)((0,l.Z)(i),"_lastDroppedFrames",0),(0,s.Z)((0,l.Z)(i),"_lastDecodedFrames",0),(0,s.Z)((0,l.Z)(i),"_lastTime",0),(0,s.Z)((0,l.Z)(i),"_currentBitrate",0),i._eventManager=new f.Q,i._mediaSourceAdapter=e,i._config=t,i._videoElement=r,i._mediaSourceAdapter.capabilities.fpsControl?(i._eventManager.listen(i._mediaSourceAdapter,m.nQ.FPS_DROP,(function(e){return i._triggerFPSDrop(e.payload.data)})),(0,c.Z)(i)):(-1===i._getDroppedAndDecodedFrames()[0]?o._logger.debug("Dropped frame watcher is not supported"):i._config.capLevelOnFPSDrop?(o._logger.debug("Initialized capLevelOnFPSDrop = true"),i._init()):o._logger.debug("Not Initialized"),i)}return(0,i.Z)(o,[{key:"_init",value:function(){var e=this;this._eventManager.listen(this._mediaSourceAdapter,m.nQ.VIDEO_TRACK_CHANGED,(function(t){return e._currentBitrate=t.payload.selectedVideoTrack.bandwidth})),this._droppedFramesInterval=setInterval((function(){return e._checkFPS()}),this._config.fpsDroppedFramesInterval)}},{key:"_triggerFPSDrop",value:function(e){this.dispatchEvent(new h.v(m.nQ.FPS_DROP,e))}},{key:"_getDroppedAndDecodedFrames",value:function(){if("function"==typeof this._videoElement.getVideoPlaybackQuality){var e=this._videoElement.getVideoPlaybackQuality();return[e.droppedVideoFrames,e.totalVideoFrames]}return"number"==typeof this._videoElement.webkitDroppedFrameCount&&"number"==typeof this._videoElement.webkitDecodedFrameCount?[this._videoElement.webkitDroppedFrameCount,this._videoElement.webkitDecodedFrameCount]:[-1,-1]}},{key:"_checkFPS",value:function(){var e=this._getDroppedAndDecodedFrames(),t=(0,T.Z)(e,2),r=t[0],n=t[1];try{var a=performance.now();if(n){if(this._lastTime){var i=a-this._lastTime,s=r-this._lastDroppedFrames,l=n-this._lastDecodedFrames,u=1e3*s/i;u>0&&(o._logger.debug("checkFPS : droppedFPS/decodedFPS:"+u/(1e3*l/i)),s>this._config.fpsDroppedMonitoringThreshold*l&&(this._mediaSourceAdapter.setMaxBitrate(this._currentBitrate-1),this._triggerFPSDrop({currentDropped:s,currentDecoded:l,totalDroppedFrames:u})))}this._lastTime=a,this._lastDroppedFrames=r,this._lastDecodedFrames=n}}catch(e){o._logger.error("Error occur while trying to check dropFrames: ",e)}}},{key:"destroy",value:function(){this._droppedFramesInterval&&clearInterval(this._droppedFramesInterval),this._droppedFramesInterval=null,this._eventManager.destroy()}}]),o}(p.H);(0,s.Z)(A,"_logger",(0,o.ZP)("droppedFramesWatcher"));var S=function(e){(0,u.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)});function o(e,t,r){var i;return(0,a.Z)(this,o),i=n.call(this),(0,s.Z)((0,l.Z)(i),"_reset",!1),i._eventManager=new f.Q,i._canLoadMediaSourceAdapterPromise=Promise.resolve(),i._createVideoElement(r),i._init(e,t),i}return(0,i.Z)(o,[{key:"restore",value:function(e,t){this.reset(),this._init(e,t)}},{key:"reset",value:function(){var e=this;this._reset||(this._reset=!0,this._eventManager.removeAll(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=void 0),this._canLoadMediaSourceAdapterPromise=new Promise((function(t,r){var n=e._mediaSourceAdapter?e._mediaSourceAdapter.destroy():Promise.resolve();e._el&&e._el.src?n.then((function(){_.is.setAttribute(e._el,"src",""),_.is.removeAttribute(e._el,"src"),t()}),r):n.then(t,r)})),this._mediaSourceAdapter=null)}},{key:"destroy",value:function(){this.detach(),this._el&&(this.pause(),_.is.removeAttribute(this._el,"src"),_.is.removeChild(this._el.parentNode,this._el)),this._eventManager.destroy(),g.Z.destroy(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=void 0),this._mediaSourceAdapter&&(this._mediaSourceAdapter.destroy(),this._mediaSourceAdapter=null)}},{key:"id",get:function(){return o.id}},{key:"attachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.attachMediaSource()}},{key:"detachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.detachMediaSource()}},{key:"attach",value:function(){var e=this;Object.keys(m.Rk).forEach((function(t){[m.Rk.ERROR,m.Rk.WAITING].includes(m.Rk[t])||e._eventManager.listen(e._el,m.Rk[t],(function(){return e.dispatchEvent(new h.v(m.Rk[t]))}))})),this._eventManager.listen(this._el,m.Rk.ERROR,(function(){return e._handleVideoError()})),this._eventManager.listen(this._el,m.Rk.WAITING,(function(){return e._handleWaiting()})),this._handleMetadataTrackEvents(),this._eventManager.listen(this._el.textTracks,"addtrack",(function(t){y.PZ.isNativeTextTrack(t.track)&&e.dispatchEvent(new h.v(m.nQ.TEXT_TRACK_ADDED,{track:t.track}))}));var t=this._mediaSourceAdapter;t&&(this._eventManager.listen(t,m.nQ.VIDEO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.AUDIO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.TEXT_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.TEXT_CUE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.TRACKS_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.Rk.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.Rk.TIME_UPDATE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.Rk.PLAYING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.Rk.WAITING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,"hlsFragParsingMetadata",(function(t){return e.dispatchEvent(t)})),this._droppedFramesWatcher&&this._eventManager.listen(this._droppedFramesWatcher,m.nQ.FPS_DROP,(function(t){return e.dispatchEvent(t)})))}},{key:"detach",value:function(){var e=this;Object.keys(m.Rk).forEach((function(t){e._eventManager.unlisten(e._el,m.Rk[t])})),this._mediaSourceAdapter&&(this._eventManager.unlisten(this._mediaSourceAdapter,m.nQ.VIDEO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,m.nQ.AUDIO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,m.nQ.TEXT_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,m.nQ.TEXT_CUE_CHANGED))}},{key:"getVideoElement",value:function(){return this._el}},{key:"selectVideoTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectVideoTrack(e)}},{key:"selectAudioTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectAudioTrack(e)}},{key:"selectTextTrack",value:function(e){this._removeCueChangeListeners(),this._mediaSourceAdapter&&this._mediaSourceAdapter.selectTextTrack(e),this.resetAllCues(),this._addCueChangeListener()}},{key:"selectImageTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectImageTrack(e)}},{key:"hideTextTrack",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.hideTextTrack(),this._removeCueChangeListeners()}},{key:"enableAdaptiveBitrate",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.enableAdaptiveBitrate()}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isAdaptiveBitrateEnabled()}},{key:"applyABRRestriction",value:function(e){if(this._mediaSourceAdapter)return this._mediaSourceAdapter.applyABRRestriction(e)}},{key:"seekToLiveEdge",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.seekToLiveEdge()}},{key:"isOnLiveEdge",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isOnLiveEdge()}},{key:"getStartTimeOfDvrWindow",value:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getStartTimeOfDvrWindow():0}},{key:"isLive",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isLive()}},{key:"play",value:function(){var e=this,t=this._el.play();return t&&t.catch((function(t){return e.dispatchEvent(new h.v(m.nQ.PLAY_FAILED,{error:t}))})),t}},{key:"pause",value:function(){return this._el.pause()}},{key:"load",value:function(e){var t=this;return this._el.load(),this._canLoadMediaSourceAdapterPromise.then((function(){return t._mediaSourceAdapter?t._mediaSourceAdapter.load(e):Promise.resolve({})})).catch((function(e){return t.dispatchEvent(new h.v(m.Rk.ERROR,e)),Promise.reject(e)}))}},{key:"enterPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof this._el.requestPictureInPicture?this._el.requestPictureInPicture().catch((function(t){e.dispatchEvent(new h.v(m.Rk.ERROR,new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.PLAYER,b.Z.Code.ENTER_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&(this._el.webkitSetPresentationMode("picture-in-picture"),setTimeout((function(){return e.dispatchEvent(new h.v(m.Rk.ENTER_PICTURE_IN_PICTURE))}),0))}catch(e){this.dispatchEvent(new h.v(m.Rk.ERROR,new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.PLAYER,b.Z.Code.ENTER_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"exitPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof document.exitPictureInPicture&&this._el===document.pictureInPictureElement?document.exitPictureInPicture().catch((function(t){e.dispatchEvent(new h.v(m.Rk.ERROR,new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.PLAYER,b.Z.Code.EXIT_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&this._el.webkitSetPresentationMode("inline")}catch(e){this.dispatchEvent(new h.v(m.Rk.ERROR,new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.PLAYER,b.Z.Code.EXIT_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"isPictureInPictureSupported",value:function(){return"function"==typeof this._el.webkitSupportsPresentationMode?this._el.webkitSupportsPresentationMode("picture-in-picture"):!!document.pictureInPictureEnabled}},{key:"getThumbnail",value:function(e){return this._mediaSourceAdapter?this._mediaSourceAdapter.getThumbnail(e):null}},{key:"src",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.src:""},set:function(e){this._mediaSourceAdapter&&(this._mediaSourceAdapter.src=e)}},{key:"currentTime",get:function(){return this._el?this._el.currentTime:0},set:function(e){this._el&&(this._el.currentTime=e)}},{key:"duration",get:function(){return this._el.duration}},{key:"liveDuration",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.liveDuration:-1}},{key:"volume",get:function(){return this._el.volume},set:function(e){this._el.volume=e}},{key:"paused",get:function(){return this._el.paused}},{key:"seeking",get:function(){return this._el.seeking}},{key:"seekable",get:function(){return this._el.seekable}},{key:"played",get:function(){return this._el.played}},{key:"buffered",get:function(){return this._el.buffered}},{key:"muted",get:function(){return this._el.muted},set:function(e){this._el.muted=e}},{key:"defaultMuted",get:function(){return this._el.defaultMuted}},{key:"poster",get:function(){return this._el.poster},set:function(e){this._el.poster=e}},{key:"preload",get:function(){return this._el.preload},set:function(e){this._el.preload=e}},{key:"autoplay",get:function(){return this._el.autoplay},set:function(e){this._el.autoplay=e}},{key:"loop",get:function(){return this._el.loop},set:function(e){this._el.loop=e}},{key:"controls",get:function(){return this._el.controls},set:function(e){this._el.controls=e}},{key:"playbackRate",get:function(){return this._el.playbackRate},set:function(e){this._el.playbackRate=e}},{key:"defaultPlaybackRate",get:function(){return this._el.defaultPlaybackRate},set:function(e){this._el.defaultPlaybackRate=e}},{key:"ended",get:function(){return this._el.ended}},{key:"error",get:function(){return this._el.error}},{key:"networkState",get:function(){return this._el.networkState}},{key:"readyState",get:function(){return this._el.readyState}},{key:"videoHeight",get:function(){return this._el.videoHeight}},{key:"videoWidth",get:function(){return this._el.videoWidth}},{key:"playsinline",get:function(){return""===this._el.getAttribute("playsinline")},set:function(e){e?this._el.setAttribute("playsinline",""):this._el.removeAttribute("playsinline")}},{key:"crossOrigin",get:function(){return this._el.getAttribute("crossorigin")},set:function(e){"string"==typeof e?this._el.setAttribute("crossorigin",e):this._el.removeAttribute("crossorigin")}},{key:"playbackRates",get:function(){return o.PLAYBACK_RATES}},{key:"isInPictureInPicture",get:function(){return!!document.pictureInPictureElement&&null!==document.pictureInPictureElement&&this._el===document.pictureInPictureElement||!!this._el.webkitPresentationMode&&"picture-in-picture"===this._el.webkitPresentationMode}},{key:"_init",value:function(e,t){this._config=t,this._reset=!1,this._loadMediaSourceAdapter(e),this.attach()}},{key:"_createVideoElement",value:function(e){this._el=o.videoElementStore[e]||_.is.createElement("video"),this._el.id=_.RO.uniqueId(5),this._el.controls=!1}},{key:"_loadMediaSourceAdapter",value:function(e){this._mediaSourceAdapter=g.Z.getMediaSourceAdapter(this.getVideoElement(),e,this._config),this._mediaSourceAdapter&&(this._droppedFramesWatcher=new A(this._mediaSourceAdapter,this._config.abr,this._el))}},{key:"_addCueChangeListener",value:function(){var e=this,t=Array.from(this._el.textTracks).find((function(e){return y.PZ.isNativeTextTrack(e)&&e.mode!==y.PZ.MODE.DISABLED}));t&&this._eventManager.listen(t,"cuechange",(function(t){return e._onCueChange(t)}))}},{key:"_removeCueChangeListeners",value:function(){var e=this;Array.from(this._el.textTracks).filter((function(e){return!y.PZ.isMetaDataTrack(e)})).forEach((function(t){e._eventManager.unlisten(t,"cuechange")}))}},{key:"_onCueChange",value:function(e){var t=e.currentTarget.activeCues,r=(0,y.z6)(t);this.dispatchEvent(new h.v(m.nQ.TEXT_CUE_CHANGED,{cues:r}))}},{key:"resetAllCues",value:function(){var e=Array.from(this._el.textTracks).find((function(e){return y.PZ.isNativeTextTrack(e)&&e.mode!==y.PZ.MODE.DISABLED}));if(e)for(var t=0;t<e.cues.length;t++)e.cues[t].hasBeenReset=!0}},{key:"_handleVideoError",value:function(){if(this._el.error){var e=this._el.error.code;if(e!==MediaError.MEDIA_ERR_ABORTED){var t=this._getMsExtendedError(),r=this._el.error.message;if(this._mediaSourceAdapter&&!this._mediaSourceAdapter.handleMediaError(this._el.error)){var n=new b.Z(b.Z.Severity.CRITICAL,b.Z.Category.MEDIA,b.Z.Code.VIDEO_ERROR,{code:e,extended:t,message:r});this.dispatchEvent(new h.v(m.Rk.ERROR,n))}}}}},{key:"_handleWaiting",value:function(){var e=this,t=!1;this._eventManager.listenOnce(this._el,m.Rk.PLAYING,(function(){return t=!0})),setTimeout((function(){t||e.dispatchEvent(new h.v(m.Rk.WAITING))}),200)}},{key:"_getMsExtendedError",value:function(){var e=this._el.error.msExtendedCode;return e&&(e<0&&(e+=Math.pow(2,32)),e=e.toString(16)),e}},{key:"_handleMetadataTrackEvents",value:function(){var e=this,t=function(t){t.mode=y.PZ.MODE.HIDDEN,e._eventManager.listen(t,"cuechange",(function(){var t=[];Array.from(e._el.textTracks).forEach((function(e){y.PZ.isMetaDataTrack(e)&&(t=t.concat((0,y.z6)(e.activeCues)))})),t=t.sort((function(e,t){return e.startTime-t.startTime})),e.dispatchEvent(new h.v(m.nQ.TIMED_METADATA,{cues:t})),e.dispatchEvent(new h.v(m.nQ.TIMED_METADATA_CHANGE,{cues:t.map((function(e){return(0,v.cP)(e)}))}))}))};Array.from(this._el.textTracks).forEach((function(e){y.PZ.isMetaDataTrack(e)&&t(e)})),this._eventManager.listen(this._el.textTracks,"addtrack",(function(e){y.PZ.isMetaDataTrack(e.track)&&t(e.track)})),this._eventManager.listen(this._el.textTracks,"change",(function(){Array.from(e._el.textTracks).forEach((function(e){y.PZ.isMetaDataTrack(e)&&e.mode!==y.PZ.MODE.HIDDEN&&(e.mode=y.PZ.MODE.HIDDEN)}))}))}},{key:"targetBuffer",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.targetBuffer:NaN}},{key:"availableBuffer",get:function(){var e=0;if(this.buffered)for(var t=0;t<this.buffered.length;t++)this.buffered.start(t)<=this._el.currentTime&&this._el.currentTime<=this.buffered.end(t)&&(e=this.buffered.end(t)-this._el.currentTime);return e}},{key:"addTextTrack",value:function(e,t,r){return this._el.addTextTrack(e,t,r)}},{key:"getNativeTextTracks",value:function(){return Array.from(this._el.textTracks)}},{key:"getDrmInfo",value:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getDrmInfo():null}}],[{key:"isSupported",value:function(){try{var e=_.is.createElement("video");return e.volume=.5,!!e.canPlayType}catch(e){return!1}}},{key:"createEngine",value:function(e,t,r){return new this(e,t,r)}},{key:"canPlaySource",value:function(e,t,r){return g.Z.canPlaySource(e,t,r)}},{key:"runCapabilities",value:function(){o._capabilities.forEach((function(e){return e.runCapability()}))}},{key:"getCapabilities",value:function(){var e=[];return o._capabilities.forEach((function(t){return e.push(t.getCapability())})),Promise.all(e).then((function(e){var t={};return e.forEach((function(e){return Object.assign(t,e)})),(0,s.Z)({},o.id,t)}))}},{key:"setCapabilities",value:function(e){o._capabilities.forEach((function(t){return t.setCapabilities(e)}))}},{key:"prepareVideoElement",value:function(e){if(!o.videoElementStore[e]){o._logger.debug("Create the video element for playing ".concat(e));var t=_.is.createElement("video");o.videoElementStore[e]=t}o._logger.debug("Prepare the video element for playing ".concat(e)),o.videoElementStore[e].load()}}]),o}(p.H);(0,s.Z)(S,"_logger",(0,o.ZP)("Html5")),(0,s.Z)(S,"_capabilities",[E]),(0,s.Z)(S,"id","html5"),(0,s.Z)(S,"videoElementStore",{}),(0,s.Z)(S,"PLAYBACK_RATES",[.5,1,1.5,2]);var P=function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,null,[{key:"register",value:function(t,r){t&&!e._engineProviders[t]?(e._logger.debug("Engine <".concat(t,"> has been registered successfully")),e._engineProviders[t]=r):e._logger.debug("Engine <".concat(t,"> is already registered, do not register again"))}},{key:"unRegister",value:function(t){e._engineProviders[t]&&(e._logger.debug("Unregistered <".concat(t,"> Engine")),delete e._engineProviders[t])}},{key:"getEngines",value:function(){return Object.keys(e._engineProviders).map((function(t){return e._engineProviders[t]}))}},{key:"destroy",value:function(){e._engineProviders={}}}]),e}();(0,s.Z)(P,"_logger",(0,o.ZP)("EngineProvider")),(0,s.Z)(P,"_engineProviders",{}),S.isSupported()&&P.register(S.id,S);var C=P.register,x=P.unRegister},488:function(e,t,r){"use strict";r.d(t,{r:function(){return n}});var n={HTML5:"html5",FLASH:"flash",SILVERLIGHT:"silverlight",CAST:"cast",YOUTUBE:"youtube",IMAGE:"image"}},6145:function(e,t,r){"use strict";r.d(t,{X:function(){return n}});var n={ANONYMOUS:"anonymous",USE_CREDENTIALS:"use-credentials"}},4651:function(e,t,r){"use strict";r.d(t,{Z:function(){return E}});var n,a=r(5671),i=r(3144),s=r(7326),o=r(9340),l=r(2963),u=r(1120),c=r(4942),d=r(8987),p=r(8171),h=r(962),f=r(2114),m=r(4358),g=r(4877),y=r(7812),v=r(6462),_=r(4270),k=r(2983),E=function(e){(0,o.Z)(p,e);var t,r,n=(t=p,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function p(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,a.Z)(this,p),r=n.call(this),(0,c.Z)((0,s.Z)(r),"_capabilities",{fpsControl:!1}),r._videoElement=e,r._sourceObj=t,r._config=i,r._onDurationChanged=function(){r.isLive()&&r._videoElement.paused&&r._trigger(f.Rk.TIME_UPDATE)},r._eventManager=new _.Q,r._handleLiveTimeUpdate(),r}return(0,i.Z)(p,[{key:"destroy",value:function(){return this._sourceObj=void 0,this._config={},this.disableNativeTextTracks(),this._videoElement.removeEventListener(f.Rk.DURATION_CHANGE,this._onDurationChanged),this._eventManager.destroy(),Promise.resolve()}},{key:"_onTrackChanged",value:function(e){e instanceof g.Z?(p._logger.debug("Video track changed",e),this._trigger(f.nQ.VIDEO_TRACK_CHANGED,{selectedVideoTrack:e})):e instanceof y.Z?(p._logger.debug("Audio track changed",e),this._trigger(f.nQ.AUDIO_TRACK_CHANGED,{selectedAudioTrack:e})):e instanceof v.ZP?(p._logger.debug("Text track changed",e),this._trigger(f.nQ.TEXT_TRACK_CHANGED,{selectedTextTrack:e})):e instanceof k.Z&&(p._logger.debug("Image track changed",e),this._trigger(f.nQ.IMAGE_TRACK_CHANGED,{selectedImageTrack:e}))}},{key:"_trigger",value:function(e,t){this.dispatchEvent(new d.v(e,t))}},{key:"load",value:function(){return p._throwNotImplementedError("load")}},{key:"selectVideoTrack",value:function(e){return p._throwNotImplementedError("selectVideoTrack")}},{key:"selectAudioTrack",value:function(e){p._throwNotImplementedError("selectAudioTrack")}},{key:"selectTextTrack",value:function(e){p._throwNotImplementedError("selectTextTrack")}},{key:"selectImageTrack",value:function(e){}},{key:"hideTextTrack",value:function(){p._throwNotImplementedError("hideTextTrack")}},{key:"enableAdaptiveBitrate",value:function(){p._throwNotImplementedError("enableAdaptiveBitrate")}},{key:"isAdaptiveBitrateEnabled",value:function(){return p._throwNotImplementedError("isAdaptiveBitrateEnabled")}},{key:"applyABRRestriction",value:function(e){return p._throwNotImplementedError("applyABRRestriction")}},{key:"_getLiveEdge",value:function(){return p._throwNotImplementedError("_getLiveEdge")}},{key:"seekToLiveEdge",value:function(){p._throwNotImplementedError("seekToLiveEdge")}},{key:"isLive",value:function(){return p._throwNotImplementedError("isLive")}},{key:"isOnLiveEdge",value:function(){return 0===this.getSegmentDuration()||this.liveDuration-this._videoElement.currentTime<=2*this.getSegmentDuration()}},{key:"setMaxBitrate",value:function(e){}},{key:"attachMediaSource",value:function(){}},{key:"detachMediaSource",value:function(){}},{key:"_handleLiveTimeUpdate",value:function(){this._videoElement.addEventListener(f.Rk.DURATION_CHANGE,this._onDurationChanged)}},{key:"disableNativeTextTracks",value:function(){Array.from(this._videoElement.textTracks).forEach((function(e){v.ZP.isNativeTextTrack(e)&&!v.ZP.isExternalTrack(e)&&(e.mode=v.ZP.MODE.DISABLED)}))}},{key:"handleMediaError",value:function(e){return!1}},{key:"getStartTimeOfDvrWindow",value:function(){return p._throwNotImplementedError("getStartTimeOfDvrWindow")}},{key:"getThumbnail",value:function(e){return null}},{key:"getSegmentDuration",value:function(){return p._throwNotImplementedError("getSegmentDuration")}},{key:"liveDuration",get:function(){return p._throwNotImplementedError("liveDuration")}},{key:"src",get:function(){return this._loadPromise&&this._sourceObj?this._sourceObj.url:""},set:function(e){!this._loadPromise&&this._sourceObj&&(this._sourceObj.url=e)}},{key:"capabilities",get:function(){return this._capabilities}},{key:"targetBuffer",get:function(){return NaN}},{key:"getDrmInfo",value:function(){return null}}],[{key:"isSupported",value:function(){return!0}},{key:"isMSESupported",value:function(){var e=MediaSource||window.WebKitMediaSource;return!!e&&"function"==typeof e.isTypeSupported}},{key:"canPlayType",value:function(e,t){return p._throwNotImplementedError("static canPlayType")}},{key:"_throwNotImplementedError",value:function(e){throw new h.Z(h.Z.Severity.CRITICAL,h.Z.Category.PLAYER,h.Z.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,e)}}]),p}(p.H);n=E,(0,c.Z)(E,"id","BaseAdapter"),(0,c.Z)(E,"getLogger",m.ZP),(0,c.Z)(E,"_logger",n.getLogger(n.id))},2588:function(e,t,r){"use strict";r.d(t,{Z:function(){return U},L:function(){return j}});var n=r(5671),a=r(3144),i=r(4942),s=r(3433),o=r(7326),l=r(1752),u=r(9340),c=r(2963),d=r(1120),p=r(2114),h=r(4877),f=r(7812),m=r(6462),g=r(6975),y=r(4651);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _,k=r(1177),E=r(4821),b=r(7237),T=r(4358),A=(0,T.ZP)("FairPlay"),S=function(){function e(){(0,n.Z)(this,e)}return(0,a.Z)(e,null,[{key:"isConfigured",value:function(e,t){return b.J.FAIRPLAY===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))}},{key:"canPlayDrm",value:function(e){var t=e.some((function(e){return e.scheme===b.J.FAIRPLAY}))&&!!window.WebKitMediaKeys;return A.debug("Can play DRM scheme of: ".concat(b.J.FAIRPLAY," is ").concat(t.toString())),t}},{key:"setDrmPlayback",value:function(e,t){A.debug("Sets drm playback");var r=t.find((function(e){return e.scheme===b.J.FAIRPLAY}));r&&(e.licenseUrl=r.licenseUrl,e.certificate=r.certificate)}}]),e}(),P=r(2069),C=r(962),x=JSON.parse('{"heartbeatTimeout":30000}'),I=r(9439),w=r(4270),R="com.apple.fps.1_0",M={NEED_KEY:"webkitneedkey",KEY_MESSAGE:"webkitkeymessage",KEY_ADDED:"webkitkeyadded",KEY_ERROR:"webkitkeyerror"},D=function(){function e(t,r,a,s){var o=this;(0,n.Z)(this,e),(0,i.Z)(this,"_logger",(0,T.ZP)("FairPlayDrmHandler")),(0,i.Z)(this,"_retryLicenseRequest",4),(0,i.Z)(this,"_defaultConfig",{licenseUrl:"",certificate:"",network:{responseFilter:function(t,r){var n={};try{var a=new DataView(r.data),i=(new TextDecoder).decode(a).trim();n=JSON.parse(i)}catch(e){return void o._onError(C.Z.Code.BAD_FAIRPLAY_RESPONSE,{error:e,responseText:r.data})}var s=e._validateResponse(n);s.valid?r.data=e._base64DecodeUint8Array(n.ckc):o._onError(C.Z.Code.BAD_FAIRPLAY_RESPONSE,s)}}}),this._config=E.c7.mergeDeep({},this._defaultConfig,r),this._errorCallback=a,this._drmResponseCallback=s,this._videoElement=t,this._onWebkitNeedKeyHandler=function(e){return o._onWebkitNeedKey(e)},this._eventManager=new w.Q,this._eventManager.listen(this._videoElement,M.NEED_KEY,this._onWebkitNeedKeyHandler)}return(0,a.Z)(e,[{key:"_onWebkitNeedKey",value:function(t){var r=this;this._logger.debug("Webkit need key triggered");var n=t.target,a=t.initData,i=e._extractContentId(a),s=e._base64DecodeUint8Array(this._config.certificate);if(a=e._concatInitDataIdAndCertificate(a,i,s),!n.webkitKeys){var o=this._selectKeySystem();this._logger.debug("Sets media keys"),n.webkitSetMediaKeys(new WebKitMediaKeys(o))}n.webkitKeys||this._onError(C.Z.Code.COULD_NOT_CREATE_MEDIA_KEYS),this._logger.debug("Creates session"),this._keySession=n.webkitKeys.createSession("video/mp4",a),this._keySession||this._onError(C.Z.Code.COULD_NOT_CREATE_KEY_SESSION),this._keySession.contentId=i,this._eventManager.listen(this._keySession,M.KEY_MESSAGE,(function(e){return r._onWebkitKeyMessage(e)})),this._eventManager.listen(this._keySession,M.KEY_ADDED,(function(){return r._onWebkitKeyAdded()})),this._eventManager.listen(this._keySession,M.KEY_ERROR,(function(e){return r._onWebkitKeyError(e)}))}},{key:"getDrmInfo",value:function(){var e=this._config;return{certificate:e.certificate,licenseUrl:e.licenseUrl,scheme:b.J.FAIRPLAY}}},{key:"destroy",value:function(){this._eventManager.destroy(),this._keySession.close(),this._keySession=null}},{key:"_onWebkitKeyMessage",value:function(t){var r=this;this._logger.debug("Webkit key message triggered");var n=t.message,a=new XMLHttpRequest;a.responseType="arraybuffer",this._eventManager.listenOnce(a,"load",(function(e){return r._licenseRequestLoaded(e)}));var i,s={url:this._config.licenseUrl,body:e._base64EncodeUint8Array(n),headers:{}},o=this._config.network.requestFilter;if(o){this._logger.debug("Apply request filter");try{i=o(g.x.LICENSE,s)}catch(e){i=Promise.reject(e)}}(i=i||Promise.resolve(s)).then((function(e){a.open("POST",e.url,!0);var t=!0;e.headers&&Object.entries(e.headers).forEach((function(e){var r=(0,I.Z)(e,2),n=r[0],i=r[1];"string"==typeof i&&a.setRequestHeader(n,i),t&&(t="content-type"!==n.toLowerCase())})),"boolean"==typeof e.withCredentials&&(a.withCredentials=e.withCredentials),t&&a.setRequestHeader("Content-type","application/json"),r._logger.debug("Ready for license request"),a.onerror=function(){r._onError(C.Z.Code.LICENSE_REQUEST_FAILED,{status:a.status,responseText:a.responseText})},r._licenseRequestTime=Date.now(),a.send(e.body)})).catch((function(e){r._errorCallback(new C.Z(C.Z.Severity.CRITICAL,C.Z.Category.NETWORK,C.Z.Code.REQUEST_FILTER_ERROR,e)),r.destroy()}))}},{key:"_onWebkitKeyAdded",value:function(){this._logger.debug("Decryption key was added to session")}},{key:"_onWebkitKeyError",value:function(e){this._logger.error("A decryption key error was encountered",e),this._retryLicenseRequest<=0&&this._onError(C.Z.Code.LICENSE_REQUEST_FAILED,e.target.error),this._retryLicenseRequest--}},{key:"_licenseRequestLoaded",value:function(e){var t=this;this._logger.debug("License request loaded");var r=e.target;if(r.status>299)this._onError(C.Z.Code.LICENSE_REQUEST_FAILED,{status:r.status,error:r.responseText});else{if(this._drmResponseCallback){var n=Date.now()-this._licenseRequestTime;this._drmResponseCallback({licenseTime:n/1e3,scheme:b.J.FAIRPLAY})}var a,i=r.responseURL,s=r.response,o={url:i,originalUrl:this._config.licenseUrl,data:s,headers:E.eV.convertHeadersToDictionary(r.getAllResponseHeaders())};this._logger.debug("Apply response filter");try{a=this._config.network.responseFilter(g.x.LICENSE,o)}catch(e){a=Promise.reject(e)}(a=a||Promise.resolve(o)).then((function(e){t._keySession.update(e.data)})).catch((function(e){t._errorCallback(new C.Z(C.Z.Severity.CRITICAL,C.Z.Category.NETWORK,C.Z.Code.RESPONSE_FILTER_ERROR,e)),t.destroy()}))}}},{key:"_onError",value:function(e,t){this._errorCallback(new C.Z(C.Z.Severity.CRITICAL,C.Z.Category.DRM,e,t))}},{key:"_selectKeySystem",value:function(){var e=null;return WebKitMediaKeys.isTypeSupported(R,"video/mp4")?e=R:this._logger.warn("Key System not supported"),e}}],[{key:"_validateResponse",value:function(e){return e.message&&e.message.indexOf("error")>0||null===e.reference||500===e.status_code?{valid:!1,details:"internal server error"}:""===e.ckc?{valid:!1,details:"ckc is missing"}:{valid:!0}}},{key:"_extractContentId",value:function(t){var r=document.createElement("a");return r.href=e._arrayToString(t),r.hostname}},{key:"_arrayToString",value:function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))}},{key:"_base64DecodeUint8Array",value:function(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(new ArrayBuffer(r)),a=0;a<r;a++)n[a]=t.charCodeAt(a);return n}},{key:"_concatInitDataIdAndCertificate",value:function(t,r,n){"string"==typeof r&&(r=e._stringToArray(r));var a=0,i=new ArrayBuffer(t.byteLength+4+r.byteLength+4+n.byteLength),s=new DataView(i);new Uint8Array(i,a,t.byteLength).set(t),a+=t.byteLength,s.setUint32(a,r.byteLength,!0),a+=4;var o=new Uint8Array(i,a,r.byteLength);return o.set(r),a+=o.byteLength,s.setUint32(a,n.byteLength,!0),a+=4,new Uint8Array(i,a,n.byteLength).set(n),new Uint8Array(i,0,i.byteLength)}},{key:"_stringToArray",value:function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),n=0,a=e.length;n<a;n++)r[n]=e.charCodeAt(n);return r}},{key:"_base64EncodeUint8Array",value:function(e){for(var t,r,n,a,i,s,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;c<e.length;)a=(t=e[c++])>>2,i=(3&t)<<4|(r=c<e.length?e[c++]:Number.NaN)>>4,s=(15&r)<<2|(n=c<e.length?e[c++]:Number.NaN)>>6,o=63&n,isNaN(r)?s=o=64:isNaN(n)&&(o=64),u+=l.charAt(a)+l.charAt(i)+l.charAt(s)+l.charAt(o);return u}}]),e}();function O(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}(0,i.Z)(D,"WebkitEvents",M),D.WebkitEvents=M;var N=function(e){(0,u.Z)(_,e);var t,r,y=(t=_,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)});function _(e,t,r){var a;return(0,n.Z)(this,_),a=y.call(this,e,t,r),(0,i.Z)((0,o.Z)(a),"_lastTimeUpdate",0),(0,i.Z)((0,o.Z)(a),"_waitingEventTriggered",!1),(0,i.Z)((0,o.Z)(a),"_segmentDuration",0),(0,i.Z)((0,o.Z)(a),"_startTimeOfDvrWindow",0),(0,i.Z)((0,o.Z)(a),"_mediaErrorRecoveryAttempts",0),(0,i.Z)((0,o.Z)(a),"_lastTimeDetach",NaN),(0,i.Z)((0,o.Z)(a),"_startTimeAttach",NaN),(0,i.Z)((0,o.Z)(a),"_nativeTextTracksMap",{}),(0,i.Z)((0,o.Z)(a),"_captionsHidden",!1),_._logger.debug("Creating adapter"),a._config=E.c7.mergeDeep({},x,a._config),a._progressiveSources=r.progressiveSources,a._liveEdge=0,a._setStarTimeOfDvrWindowInterval(),a}return(0,a.Z)(_,[{key:"_dispatchErrorCallback",value:function(e){this._trigger(p.Rk.ERROR,e)}},{key:"_dispatchDRMLicenseLoaded",value:function(e){this._trigger(p.nQ.DRM_LICENSE_LOADED,e)}},{key:"_maybeSetDrmPlayback",value:function(){var e=this;if(_._drmProtocol&&this._sourceObj&&this._sourceObj.drmData){var t={licenseUrl:"",certificate:"",network:this._config.network};_._drmProtocol.setDrmPlayback(t,this._sourceObj.drmData),this._drmHandler=new D(this._videoElement,t,(function(t){return e._dispatchErrorCallback(t)}),(function(t){return e._dispatchDRMLicenseLoaded(t)}))}}},{key:"_setProgressiveSource",value:function(){var e=function(e,t,r){var n=null;if(r&&e){var a,i=[],s=1/0,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}(e);try{for(o.s();!(a=o.n()).done;){var l=a.value,u=Math.abs(l.width-t);u<s?(s=u,i=[l]):u===s&&i.push(l)}}catch(e){o.e(e)}finally{o.f()}for(var c=t/r,d=i,p=1/0,h=0,f=i;h<f.length;h++){var m=f[h];if(m.height){var g=Math.abs(m.width/m.height-c);g<p?(p=g,d=[m]):g===p&&d.push(m)}}for(var y=0,_=0,k=d;_<k.length;_++){var E=k[_];(E.bandwidth>y||!E.bandwidth)&&(y=E.bandwidth||y,n=E)}}return n}(this._progressiveSources,this._videoElement.offsetWidth,this._videoElement.offsetHeight);e&&(this._sourceObj=e)}},{key:"_isProgressivePlayback",value:function(){return!!this._sourceObj&&_._progressiveMimeTypes.includes(this._sourceObj.mimetype.toLowerCase())}},{key:"load",value:function(e){var t=this;return this._maybeSetDrmPlayback(),this._loadPromise||(this._loadPromise=new Promise((function(r,n){t._lastTimeUpdate=e||0;var a="number"==typeof e?e:-1,i=t._startTimeAttach||a;t._loadPromiseReject=n,t._eventManager.listenOnce(t._videoElement,p.Rk.LOADED_DATA,(function(){return t._onLoadedData(r,i)})),t._eventManager.listenOnce(t._videoElement,p.Rk.PLAYING,(function(){return t._onPlaying(i)})),t._eventManager.listen(t._videoElement,p.Rk.TIME_UPDATE,(function(){return t._onTimeUpdate()})),t._eventManager.listen(t._videoElement,p.Rk.PLAY,(function(){return t._resetHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,p.Rk.PAUSE,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,p.Rk.ENDED,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,p.Rk.ABORT,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,p.Rk.SEEKED,(function(){return t._syncCurrentTime()})),t._eventManager.listen(t._videoElement,p.Rk.WAITING,(function(){return t._waitingEventTriggered=!0})),t._eventManager.listen(t._videoElement,p.Rk.PLAYING,(function(){return t._waitingEventTriggered=!1})),t._eventManager.listen(window,"focus",(function(){setTimeout((function(){P.Z.isIOS&&(t._videoElement.currentTime=t._videoElement.currentTime>.1?t._videoElement.currentTime-.1:0),t._syncCurrentTime()}),1e3)})),t._isProgressivePlayback()&&t._setProgressiveSource(),t._sourceObj&&t._sourceObj.url?t._setSrc().then((function(){t._trigger(p.nQ.ABR_MODE_CHANGED,{mode:t._isProgressivePlayback()?"manual":"auto"}),t._videoElement.load()})):t._videoElement.load()}))),this._loadPromise}},{key:"_handleDecodeError",value:function(e){var t=this;_._logger.debug("handleDecodeError",e);var r=this._videoElement.currentTime,n=this._getActivePKAudioTrack(),a=this._getActivePKTextTrack();this._videoElement.load(),this._eventManager.listenOnce(this._videoElement,p.Rk.PLAYING,(function(){t._mediaErrorRecoveryAttempts=0})),this._eventManager.listenOnce(this._videoElement,p.Rk.CAN_PLAY,(function(){_._logger.debug("CAN_PLAY"),t._videoElement.currentTime=r,t._videoElement.play(),t._videoElement.pause(),n&&t.selectAudioTrack(n),a?t.selectTextTrack(a):t.disableNativeTextTracks()}))}},{key:"handleMediaError",value:function(e){return this._loadPromiseReject?(this._loadPromiseReject(new C.Z(C.Z.Severity.CRITICAL,C.Z.Category.MEDIA,C.Z.Code.NATIVE_ADAPTER_LOAD_FAILED,e)),!0):!!(e&&e.code===MediaError.MEDIA_ERR_DECODE&&(this._mediaErrorRecoveryAttempts++,this._mediaErrorRecoveryAttempts<=3))&&(this._handleDecodeError(e),!0)}},{key:"attachMediaSource",value:function(){this._startTimeAttach=this._lastTimeDetach,this._lastTimeDetach=NaN}},{key:"detachMediaSource",value:function(){this._lastTimeDetach=this._videoElement.currentTime,this._videoElement&&this._videoElement.src&&(E.is.setAttribute(this._videoElement,"src",""),E.is.removeAttribute(this._videoElement,"src")),this._loadPromise=void 0}},{key:"_setSrc",value:function(){var e,t=this,r={url:this._sourceObj?this._sourceObj.url:"",body:null,headers:{}};if("function"==typeof E.c7.getPropertyPath(this._config,"network.requestFilter"))try{_._logger.debug("Apply request filter"),e=this._config.network.requestFilter(g.x.MANIFEST,r)}catch(t){e=Promise.reject(t)}return(e=e||Promise.resolve(r)).then((function(e){if(t._config.useSourceTag){var r,n=document.createElement("source"),a=(null===(r=t._sourceObj)||void 0===r?void 0:r.mimetype.toLowerCase())||"";if(n.setAttribute("src",e.url),n.setAttribute("type",a),t._config.useMediaOptionAttribute){var i={};if(t._config.mediaOptionAttribute&&(i=t._config.mediaOptionAttribute),t._config.abrEwmaDefaultEstimate){var s={start:t._config.abrEwmaDefaultEstimate};E.c7.createPropertyPath(i,"option.adaptiveStreaming.bps",s)}_._logger.debug("Setting mediaOption -",i);var o=encodeURI(JSON.stringify(i));n.setAttribute("type",a+";mediaOption="+o)}t._videoElement.appendChild(n)}else t._videoElement.src=e.url})).catch((function(e){t._trigger(p.Rk.ERROR,new C.Z(C.Z.Severity.CRITICAL,C.Z.Category.NETWORK,C.Z.Code.REQUEST_FILTER_ERROR,e))})),e}},{key:"_onPlaying",value:function(e){this.isLive()&&this._setStartTime(e)}},{key:"_onLoadedData",value:function(e,t){var r=this,n=function(){r._playerTracks=r._getParsedTracks(),r._addNativeAudioTrackChangeListener(),r._addNativeTextTrackChangeListener(),r._addNativeTextTrackAddedListener(),_._logger.debug("The source has been loaded successfully"),r._loadPromiseReject=void 0,e({tracks:r._playerTracks}),r.isLive()&&r._handleLiveDurationChange()};void 0!==t&&t>-1&&(this._videoElement.currentTime=t),this._videoElement.textTracks.length>0?n():this._eventManager.listenOnce(this._videoElement,p.Rk.CAN_PLAY,n.bind(this)),this._startTimeAttach=NaN}},{key:"_setStartTime",value:function(e){"number"==typeof e&&e>-1&&(this._videoElement.currentTime=e)}},{key:"_onTimeUpdate",value:function(){this._videoElement.paused||(this._videoElement.currentTime>this._lastTimeUpdate?(this._waitingEventTriggered&&(this._waitingEventTriggered=!1,this._trigger(p.Rk.PLAYING)),this._resetHeartbeatTimeout()):this._videoElement.currentTime<this._lastTimeUpdate?this._syncCurrentTime():(this._waitingEventTriggered=!0,this._trigger(p.Rk.WAITING))),this._handleVideoTracksChange()}},{key:"_syncCurrentTime",value:function(){this._lastTimeUpdate=this._videoElement.currentTime}},{key:"_resetHeartbeatTimeout",value:function(){var e=this;this._lastTimeUpdate=this._videoElement.currentTime,this._clearHeartbeatTimeout(),this._heartbeatTimeoutId=setTimeout((function(){e._clearHeartbeatTimeout(),e._trigger(p.Rk.ERROR,new C.Z(C.Z.Severity.CRITICAL,C.Z.Category.NETWORK,C.Z.Code.TIMEOUT,"The player exceeded max buffer time of ".concat(e._config.heartbeatTimeout," ms. No progress has been done during this time.")))}),this._config.heartbeatTimeout)}},{key:"_clearHeartbeatTimeout",value:function(){this._heartbeatTimeoutId&&(clearTimeout(this._heartbeatTimeoutId),this._heartbeatTimeoutId=void 0)}},{key:"_handleVideoTracksChange",value:function(){if(!this._isProgressivePlayback()){var e=this._videoElement,t=e.videoHeight,r=e.videoWidth,n=e.videoTracks;if(!this._videoDimensions||t!==this._videoDimensions.videoHeight||r!==this._videoDimensions.videoWidth){this._videoDimensions={videoHeight:t,videoWidth:r};var a={language:"",height:t,width:r,active:!0,index:Array.from(n).findIndex((function(e){return e.selected}))};this._onTrackChanged(new h.Z(a))}}}},{key:"destroy",value:function(){var e=this;return _._logger.debug("destroy"),new Promise((function(t,r){e._maybeRemoveSourceTag(),(0,l.Z)((0,d.Z)(_.prototype),"destroy",e).call(e).then((function(){e._drmHandler&&e._drmHandler.destroy(),e._waitingEventTriggered=!1,e._progressiveSources=[],e._loadPromise=void 0,e._nativeTextTracksMap={},e._loadPromiseReject=void 0,e._liveEdge=0,e._lastTimeUpdate=0,e._lastTimeDetach=NaN,e._startTimeAttach=NaN,e._videoDimensions=void 0,e._clearHeartbeatTimeout(),clearInterval(e._startTimeOfDvrWindowInterval),e._liveDurationChangeInterval&&(clearInterval(e._liveDurationChangeInterval),e._liveDurationChangeInterval=void 0),t()}),(function(){return r}))}))}},{key:"_maybeRemoveSourceTag",value:function(){if(this._config.useSourceTag&&this._videoElement){var e=this._videoElement.firstChild;e&&(e.setAttribute("src",""),e.removeAttribute("src"),this._videoElement.removeChild(e))}}},{key:"_getParsedTracks",value:function(){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),r=this._getParsedTextTracks();return[].concat((0,s.Z)(e),(0,s.Z)(t),(0,s.Z)(r))}},{key:"_getParsedVideoTracks",value:function(){return this._isProgressivePlayback()?this._getParsedProgressiveVideoTracks():this._getParsedAdaptiveVideoTracks()}},{key:"_getParsedProgressiveVideoTracks",value:function(){var e=this._progressiveSources,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,bandwidth:e[r].bandwidth,width:e[r].width,height:e[r].height,active:!!this._sourceObj&&e[r].id===this._sourceObj.id,index:r};t.push(new h.Z(n))}return t}},{key:"_getParsedAdaptiveVideoTracks",value:function(){var e=this._videoElement.videoTracks,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,active:e[r].selected,label:e[r].label,language:e[r].language,index:r};t.push(new h.Z(n))}return t}},{key:"_getParsedAudioTracks",value:function(){var e=this._videoElement.audioTracks,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,active:e[r].enabled,label:e[r].label,language:e[r].language,index:r};t.push(new f.Z(n))}return t}},{key:"_getParsedTextTracks",value:function(){var e=[this._config.captionsTextTrack1Label,this._config.captionsTextTrack2Label],t=[this._config.captionsTextTrack1LanguageCode,this._config.captionsTextTrack2LanguageCode],r=this._videoElement.textTracks,n=[];if(r){for(var a=0;a<r.length;a++)if(!m.ZP.isExternalTrack(r[a])){var i={kind:r[a].kind,active:r[a].mode===m.ZP.MODE.SHOWING,label:r[a].label,language:r[a].language,available:!0};if(i.kind===m.ZP.KIND.SUBTITLES){var s=new m.ZP(i);n.push(s),this._nativeTextTracksMap[s.index]=r[a]}else if(i.kind===m.ZP.KIND.CAPTIONS&&this._config.enableCEA708Captions){i.label=i.label||e.shift(),i.language=i.language||t.shift(),i.available=this._captionsHidden;var o=new m.ZP(i);n.push(o),this._nativeTextTracksMap[o.index]=r[a]}}this._captionsHidden||this._maybeShow708Captions()}return n}},{key:"_maybeShow708Captions",value:function(){var e=this,t=Array.from(this._videoElement.textTracks).filter((function(e){return e.kind===m.ZP.KIND.CAPTIONS})),r=t.find((function(e){return e.mode===m.ZP.MODE.SHOWING||e.mode===m.ZP.MODE.HIDDEN}))||t[0];r&&(r.mode=m.ZP.MODE.HIDDEN,this._captionsHidden=!0,this._eventManager.listenOnce(r,"cuechange",(function(){e._getPKTextTracks().forEach((function(e){return(e.available=!0)&&(e.mode=m.ZP.MODE.DISABLED)})),e._trigger(p.nQ.TRACKS_CHANGED,{tracks:e._playerTracks})})))}},{key:"selectVideoTrack",value:function(e){this._isProgressivePlayback()?this._selectProgressiveVideoTrack(e):this.selectAdaptiveVideoTrack(e)}},{key:"_selectProgressiveVideoTrack",value:function(e){var t=this,r=this._progressiveSources;if(e instanceof h.Z&&r&&r[e.index]){var n=this._videoElement.currentTime,a=this._videoElement.paused;e.active=!0,this._sourceObj=r[e.index],this._eventManager.listenOnce(this._videoElement,p.Rk.LOADED_DATA,(function(){"Android Browser"===P.Z.browser.name?(t._eventManager.listenOnce(t._videoElement,p.Rk.DURATION_CHANGE,(function(){t._videoElement.currentTime=n})),t._eventManager.listenOnce(t._videoElement,p.Rk.SEEKED,(function(){t._onTrackChanged(e),a&&t._videoElement.pause()})),t._videoElement.play()):(t._eventManager.listenOnce(t._videoElement,p.Rk.SEEKED,(function(){t._onTrackChanged(e)})),t._videoElement.currentTime=n,a||t._videoElement.play())})),this._setSrc()}}},{key:"selectAdaptiveVideoTrack",value:function(e){var t=this._videoElement.videoTracks;e instanceof h.Z&&t&&t[e.index]&&(this._disableVideoTracks(),t[e.index].selected=!0,this._onTrackChanged(e))}},{key:"selectAudioTrack",value:function(e){_._logger.debug("selectAudioTrack");var t=this._videoElement.audioTracks;e instanceof f.Z&&t&&t[e.index]&&(this._removeNativeAudioTrackChangeListener(),this._switchAudioTrack(e.index),this._onTrackChanged(e),this._addNativeAudioTrackChangeListener())}},{key:"_removeNativeAudioTrackChangeListener",value:function(){this._videoElement.audioTracks&&this._eventManager.unlisten(this._videoElement.audioTracks,"change")}},{key:"_addNativeAudioTrackChangeListener",value:function(){var e=this;this._videoElement.audioTracks&&this._eventManager.listen(this._videoElement.audioTracks,"change",(function(){return e._onNativeAudioTrackChange()}))}},{key:"_getPKAudioTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof f.Z}))}},{key:"_getActivePKAudioTrack",value:function(){return this._getPKAudioTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeAudioTrackChange",value:function(){var e=this,t=function(){for(var t=0;t<e._videoElement.audioTracks.length;t++)if(e._videoElement.audioTracks[t].enabled)return t;return-1}(),r=this._getActivePKAudioTrack(),n=r?r.index:-1;if(t!==n){var a=this._getPKAudioTracks().find((function(e){return e.index===t}));a&&(_._logger.debug("Native selection of track, update the player audio track ("+n+" -> "+t+")"),this._onTrackChanged(a))}}},{key:"selectTextTrack",value:function(e){if(e instanceof m.ZP&&m.ZP.isNativeTextTrack(e)){this._removeNativeTextTrackChangeListener();var t=this._nativeTextTracksMap[e.index];t&&(this.disableNativeTextTracks(),t.mode=this._getDisplayTextTrackModeString(),this._onTrackChanged(e),this._addNativeTextTrackChangeListener())}}},{key:"_removeNativeTextTrackChangeListener",value:function(){this._videoElement.textTracks&&this._eventManager.unlisten(this._videoElement.textTracks,"change")}},{key:"_addNativeTextTrackChangeListener",value:function(){var e=this;this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"change",(function(){return e._onNativeTextTrackChange()}))}},{key:"_getPKTextTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof m.ZP}))}},{key:"_getActivePKTextTrack",value:function(){return this._getPKTextTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeTextTrackChange",value:function(){var e=this,t=this._getPKTextTracks(),r=t.find((function(e){return"off"===e.language})),n=function(){for(var t in e._nativeTextTracksMap)if(e._getDisplayTextTrackModeString()===e._nativeTextTracksMap[t].mode)return Number(t);return-1}(),a=this._getActivePKTextTrack(),i=a?a.index:-1;if(n!==i)if(-1===n)r&&(_._logger.debug("Native selection of track, update the player text track ("+i+" -> off)"),this._onTrackChanged(r));else{var s=t.find((function(e){return e.index===n}));s&&(_._logger.debug("Native selection of track, update the player text track ("+i+" -> "+n+")"),this._onTrackChanged(s))}}},{key:"_getDisplayTextTrackModeString",value:function(){return this._config.displayTextTrack?m.ZP.MODE.SHOWING:m.ZP.MODE.HIDDEN}},{key:"_addNativeTextTrackAddedListener",value:function(){var e=this;!this._config.displayTextTrack&&this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"addtrack",(function(){return e._onNativeTextTrackAdded()}))}},{key:"_onNativeTextTrackAdded",value:function(){this._playerTracks=this._getParsedTracks(),this._trigger(p.nQ.TRACKS_CHANGED,{tracks:this._playerTracks})}},{key:"hideTextTrack",value:function(){this.disableNativeTextTracks()}},{key:"enableAdaptiveBitrate",value:function(){_._logger.warn("Enabling adaptive bitrate is not supported for native playback")}},{key:"isAdaptiveBitrateEnabled",value:function(){return!this._isProgressivePlayback()}},{key:"applyABRRestriction",value:function(e){E.c7.createPropertyPath(this._config,"abr.restrictions",e),this._maybeApplyAbrRestrictions(e)}},{key:"_maybeApplyAbrRestrictions",value:function(e){if(this._isProgressivePlayback()){var t=this._playerTracks.filter((function(e){return e instanceof h.Z})),r=(0,k.u)(t,e);!r.find((function(e){return e.active}))&&r.length?this.selectVideoTrack(r[0]):_._logger.warn("Invalid restrictions, there are not tracks within the restriction range")}}},{key:"_disableVideoTracks",value:function(){var e=this._videoElement.videoTracks;if(e)for(var t=0;t<e.length;t++)e[t].selected=!1}},{key:"_switchAudioTrack",value:function(e){_._logger.debug("_switchAudioTracks");var t=this._videoElement.audioTracks;if(t)for(var r=0;r<t.length;r++)t[r].enabled=r===e}},{key:"_getLiveEdge",value:function(){return this._videoElement.seekable.length?this._videoElement.seekable.end(this._videoElement.seekable.length-1):this._videoElement.buffered.length?this._videoElement.buffered.end(this._videoElement.buffered.length-1):this._videoElement.duration}},{key:"liveDuration",get:function(){return this._getLiveEdge()}},{key:"seekToLiveEdge",value:function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}}},{key:"getSegmentDuration",value:function(){return this._segmentDuration}},{key:"isLive",value:function(){return this._videoElement.duration===1/0}},{key:"_handleLiveDurationChange",value:function(){var e=this;this._liveDurationChangeInterval=setInterval((function(){e._calculateSegmentDuration();var t=e._getLiveEdge();e._liveEdge!==t&&(e._liveEdge=t,e._videoElement.dispatchEvent(new Event(p.Rk.DURATION_CHANGE)))}),1e3)}},{key:"_calculateSegmentDuration",value:function(){if(this._videoElement.seekable.length>0&&0===this._videoElement.seekable.start(0)){var e=this._videoElement,t=e.buffered,r=e.seekable;t.length&&r.length&&(this._segmentDuration=(t.end(t.length-1)-r.end(r.length-1))/3)}else{var n=this._getLiveEdge();this._liveEdge&&this._liveEdge!==n&&(this._segmentDuration=n-this._liveEdge)}}},{key:"_getStartTimeOfDvrWindow",value:function(){return this.isLive()&&this._videoElement.seekable.length?this._videoElement.seekable.start(0):0}},{key:"getStartTimeOfDvrWindow",value:function(){return this._startTimeOfDvrWindow}},{key:"_setStarTimeOfDvrWindowInterval",value:function(){var e=this;this._startTimeOfDvrWindowInterval=setInterval((function(){var t=e._segmentDuration;!e._waitingEventTriggered&&e._getStartTimeOfDvrWindow()&&t&&Math.abs(e._getStartTimeOfDvrWindow()-e._startTimeOfDvrWindow)<=2*t?e._startTimeOfDvrWindow+=1:e._startTimeOfDvrWindow=e._getStartTimeOfDvrWindow()}),1e3)}},{key:"getDrmInfo",value:function(){return this._drmHandler?this._drmHandler.getDrmInfo():null}}],[{key:"canPlayType",value:function(e){var t=!1;return"string"==typeof e&&(t=!!_.TEST_VIDEO.canPlayType(e.toLowerCase())),_._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t}},{key:"canPlayDrm",value:function(e,t){_._drmProtocol=null;var r,n=O(_._drmProtocols);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.isConfigured(e,t)){_._drmProtocol=a;break}}}catch(e){n.e(e)}finally{n.f()}if(!_._drmProtocol){var i,s=O(_._drmProtocols);try{for(s.s();!(i=s.n()).done;){var o=i.value;o.canPlayDrm(e)&&(_._drmProtocol=o)}}catch(e){s.e(e)}finally{s.f()}}return!!_._drmProtocol}},{key:"createAdapter",value:function(e,t,r){_._logger.debug("createAdapter");var n={displayTextTrack:!1,progressiveSources:[]};if(E.c7.hasPropertyPath(r,"text.useNativeTextTrack")&&(n.displayTextTrack=E.c7.getPropertyPath(r,"text.useNativeTextTrack")),E.c7.hasPropertyPath(r,"sources.progressive")&&(n.progressiveSources=E.c7.getPropertyPath(r,"sources.progressive")),E.c7.hasPropertyPath(r,"text")&&(n.enableCEA708Captions=r.text.enableCEA708Captions,n.captionsTextTrack1Label=r.text.captionsTextTrack1Label,n.captionsTextTrack1LanguageCode=r.text.captionsTextTrack1LanguageCode,n.captionsTextTrack2Label=r.text.captionsTextTrack2Label,n.captionsTextTrack2LanguageCode=r.text.captionsTextTrack2LanguageCode),E.c7.hasPropertyPath(r,"playback")&&E.c7.hasPropertyPath(r.playback,"options.html5.native")&&E.c7.mergeDeep(n,r.playback.options.html5.native),E.c7.hasPropertyPath(r,"abr")){var a=r.abr;a.defaultBandwidthEstimate&&(n.abrEwmaDefaultEstimate=a.defaultBandwidthEstimate),a.restrictions&&E.c7.createPropertyPath(n,"abr.restrictions",a.restrictions)}return n.network=r.network,new this(e,t,n)}}]),_}(y.Z);_=N,(0,i.Z)(N,"id","NativeAdapter"),(0,i.Z)(N,"_logger",y.Z.getLogger(_.id)),(0,i.Z)(N,"TEST_VIDEO",E.is.createElement("video")),(0,i.Z)(N,"_drmProtocols",[S]),(0,i.Z)(N,"_drmProtocol",null),(0,i.Z)(N,"_progressiveMimeTypes",["video/mp4","audio/mp3"]);var U=function(){function e(){(0,n.Z)(this,e)}return(0,a.Z)(e,null,[{key:"register",value:function(t){t&&(e._mediaSourceAdapters.includes(t)?e._logger.debug("Adapter <".concat(t.id,"> is already registered, do not register again")):(e._logger.debug("Adapter <".concat(t.id,"> has been registered successfully")),e._mediaSourceAdapters.push(t)))}},{key:"unRegister",value:function(t){var r=e._mediaSourceAdapters.indexOf(t);r>-1&&(e._logger.debug("Unregistered <".concat(t.id,"> adapter")),e._mediaSourceAdapters.splice(r,1))}},{key:"canPlaySource",value:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;e._orderMediaSourceAdapters(r);var a=e._mediaSourceAdapters;if(t&&t.mimetype)for(var i=0;i<a.length;i++)if(a[i].canPlayType(t.mimetype)&&(!t.drmData||a[i].canPlayDrm(t.drmData,n)))return e._selectedAdapter=a[i],e._logger.debug("Selected adapter is <".concat(e._selectedAdapter.id,">")),!0;return!1}},{key:"_orderMediaSourceAdapters",value:function(t){e._mediaSourceAdapters=e._mediaSourceAdapters.filter((function(e){return"NativeAdapter"!==e.id})),t?e._mediaSourceAdapters.unshift(N):e._mediaSourceAdapters.push(N)}},{key:"getMediaSourceAdapter",value:function(t,r,n){return t&&r&&n?(e._selectedAdapter||e.canPlaySource(r,!0,n.drm),e._selectedAdapter?e._selectedAdapter.createAdapter(t,r,n):null):null}},{key:"destroy",value:function(){e._selectedAdapter=null}}]),e}();(0,i.Z)(U,"_logger",(0,T.ZP)("MediaSourceProvider")),(0,i.Z)(U,"_mediaSourceAdapters",[N]),(0,i.Z)(U,"_selectedAdapter",null);var j=U.register},7300:function(e,t,r){"use strict";r.d(t,{j:function(){return n}});var n={DASH:"dash",HLS:"hls",PROGRESSIVE:"progressive",IMAGE:"image"}},8143:function(e,t,r){"use strict";r.d(t,{B:function(){return n}});var n={TRUE:!0,FALSE:!1,IN_VIEW:"inview"}},2806:function(e,t,r){"use strict";r.d(t,{D:function(){return n}});var n={VOD:"Vod",LIVE:"Live",AUDIO:"Audio",IMAGE:"Image",UNKNOWN:"Unknown"}},3336:function(e,t,r){"use strict";r.d(t,{H:function(){return n}});var n={HLS:["application/x-mpegurl","application/vnd.apple.mpegurl"],DASH:["application/dash+xml"],PROGRESSIVE:["video/mp4"],SMOOTH_STREAMING:["application/vnd.ms-sstr+xml"]}},6975:function(e,t,r){"use strict";r.d(t,{x:function(){return n}});var n={MANIFEST:0,SEGMENT:1,LICENSE:2}},3323:function(e,t,r){"use strict";r.d(t,{z:function(){return n}});var n={NONE:"none",ANY:"any",NATURAL:"natural",LANDSCAPE:"landscape",PORTRAIT:"portrait",PORTRAIT_PRIMARY:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary",LANDSCAPE_PRIMARY:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary"}},962:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(3144),a=r(5671),i=r(4942),s=r(4358),o={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,LIVE_MANIFEST_REFRESH_ERROR:1008,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_CREATE_TEXT_CUE:2009,DASH_ADAPTER_ERROR_PARSE_ISSUE:2010,UNKNOWN_FILE_TYPE:2011,UNKNOWN_LANGUAGE:2012,INVALID_VTT_THUMBNAILS_FILE:2013,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,HLS_FATAL_MEDIA_ERROR:3018,HLS_FRAG_PARSING_ERROR:3019,HLS_BUFFER_APPEND_ISSUE:3020,HLS_BUFFER_APPENDING_ISSUE:3021,NATIVE_ADAPTER_LOAD_FAILED:3022,HLS_BUFFER_STALLED_ERROR:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_LIVE_CONTENT_NOT_SUPPORTED:4029,HLSJS_CANNOT_PARSE:4030,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,BAD_FAIRPLAY_RESPONSE:6015,COULD_NOT_CREATE_MEDIA_KEYS:6016,COULD_NOT_CREATE_KEY_SESSION:6017,LOAD_INTERRUPTED:7e3,BITRATE_SWITCH_ISSUE:7001,LOAD_FAILED:7002,RUNTIME_ERROR_NOT_REGISTERED_PLUGIN:7003,RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED:7004,RUNTIME_ERROR_NOT_VALID_HANDLER:7005,NO_SOURCE_PROVIDED:7006,NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE:7007,ENTER_PICTURE_IN_PICTURE_FAILED:7008,EXIT_PICTURE_IN_PICTURE_FAILED:7009,PLUGIN_LOAD_FAILED:7010,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,CONTENT_UNSUPPORTED_BY_BROWSER:9009,CANNOT_ADD_ITEM:9010,DOWNLOAD_FAILED:9011,COULD_NOT_GET_INFO_FROM_MEDIA_PROVIDER:9012,ENTRY_DOES_NOT_EXIST:9013,PAUSE_FAILED:9014,RESUME_FAILED:9015,RENEW_LICENSE_FAILED:9016,ENTRY_ALREADY_EXISTS:9017,REMOVE_FAILED:9018,CAST_LOAD_MEDIA_FAILED:10001,CAST_CUSTOM_MESSAGE_PARSING_ERROR:10002,CAST_EDIT_TRACKS_INFO_ERROR:10003,VR_NOT_SUPPORTED:11e3};Object.assign(o,{XML_PARSING_ERROR:8100,VAST_SCHEMA_VALIDATION_ERROR:8101,VAST_RESPONSE_VERSION_NOT_SUPPORTED:8102,TRAFFICKING_ERROR:8200,VAST_UNEXPECTED_LINEARITY:8201,VAST_UNEXPECTED_DURATION_ERROR:8202,VAST_UNEXPECTED_SIZE_ERROR:8203,VAST_WRAPPER_ERROR:8300,VAST_URI_ERROR:8301,VAST_TOO_MANY_REDIRECTS:8302,NO_ADS_VAST_RESPONSE:8303,GENERAL_LINEAR_ERROR:8400,FILE_NOT_FOUND:8401,VAST_MEDIA_LOAD_TIMEOUT:8402,MEDIA_FILE_NOT_FOUND:8403,MEDIA_FILE_DISPLAY_ERROR:8405,MEZZANINE_FILE_NOT_PROVIDED:8406,MEZZANINE_DOWNLOADED_FOR_THE_FIRST_TIME:8407,VAST_RESPONSE_AD_REJECTED:8408,CREATIVE_WAS_NOT_EXECUTED:8409,CODE_REFERENCED_NOT_EXECUTED:8410,GENERAL_NON_LINEAR_AD_ERROR:8500,NON_LINEAR_CREATIVE_DIMENSIONS_NOT_ALIGN_ERROR:8501,NON_LINEAR_FETCH_ERROR:8502,NON_LINEAR_RESOURCE_NOT_FOUND:8503,GENERAL_COMPANION_ADS_ERROR:8600,COMPANION_DIMENSIONS_NOT_FIT:8601,COMPANION_CANNOT_BE_DISPLAY:8602,COMPANION_CANNOT_BE_FETCHED:8603,COMPANION_TYPE_NOT_FOUND:8604,AD_UNDEFINED_ERROR:8900,GENERAL_VPAID_ERROR:8901});var l="Error",u=(0,n.Z)((function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,a.Z)(this,e),this.severity=t,this.category=r,this.code=n,this.data=i,(0,s.ZO)(l)!==s.in.OFF&&e._logger.error("Category:".concat(r," | Code:").concat(n," |"),i)}));(0,i.Z)(u,"Severity",{RECOVERABLE:1,CRITICAL:2}),(0,i.Z)(u,"Category",{NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,ADS:8,STORAGE:9,CAST:10,VR:11}),(0,i.Z)(u,"Code",o),(0,i.Z)(u,"_logger",(0,s.ZP)(l))},4270:function(e,t,r){"use strict";r.d(t,{Q:function(){return o}});var n=r(5671),a=r(3144),i=r(9021);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=function(){function e(){(0,n.Z)(this,e),this._bindingMap=new i.MultiMap}return(0,a.Z)(e,[{key:"destroy",value:function(){return this.removeAll(),this._bindingMap=null,Promise.resolve()}},{key:"listenOnce",value:function(e,t,r,n){var a=this;this.listen(e,t,(function n(i){a.unlisten(e,t,n),r.call(a,i)}),n)}},{key:"listen",value:function(e,t,r,n){var a=new l(e,t,r,n);this._bindingMap&&this._bindingMap.push(t,a)}},{key:"unlisten",value:function(e,t,r){if(this._bindingMap)for(var n=this._bindingMap.get(t),a=0;a<n.length;++a){var i=n[a];i.target!==e||i.listener!==r&&r||(i.unlisten(),this._bindingMap&&this._bindingMap.remove(t,i))}}},{key:"removeAll",value:function(){if(this._bindingMap){var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}(this._bindingMap.getAll());try{for(t.s();!(e=t.n()).done;)e.value.unlisten()}catch(e){t.e(e)}finally{t.f()}this._bindingMap&&this._bindingMap.clear()}}}]),e}(),l=function(){function e(t,r,a,i){(0,n.Z)(this,e),this.target=t,this.type=r,this.listener=a,this.options=i,this.target.addEventListener(r,a,!1)}return(0,a.Z)(e,[{key:"unlisten",value:function(){this.target&&(this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=null)}}]),e}()},2114:function(e,t,r){"use strict";r.d(t,{Rk:function(){return o},nQ:function(){return l},tw:function(){return u}});var n=r(4942),a=r(4611);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var o={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},l={MEDIA_LOADED:"medialoaded",PLAYER_RESET:"playerreset",PLAYER_DESTROY:"playerdestroy",ENTER_FULLSCREEN:"enterfullscreen",EXIT_FULLSCREEN:"exitfullscreen",PLAY_FAILED:"playfailed",AUTOPLAY_FAILED:"autoplayfailed",FALLBACK_TO_MUTED_AUTOPLAY:"fallbacktomutedautoplay",CHANGE_SOURCE_STARTED:"changesourcestarted",CHANGE_SOURCE_ENDED:"changesourceended",MUTE_CHANGE:"mutechange",VIDEO_TRACK_CHANGED:"videotrackchanged",AUDIO_TRACK_CHANGED:"audiotrackchanged",TEXT_TRACK_CHANGED:"texttrackchanged",IMAGE_TRACK_CHANGED:"imagetrackchanged",TEXT_TRACK_ADDED:"texttrackadded",TEXT_CUE_CHANGED:"textcuechanged",TRACKS_CHANGED:"trackschanged",ABR_MODE_CHANGED:"abrmodechanged",PLAYER_STATE_CHANGED:"playerstatechanged",PLAYBACK_START:"playbackstart",FIRST_PLAY:"firstplay",FIRST_PLAYING:"firstplaying",PLAYBACK_ENDED:"playbackended",SOURCE_SELECTED:"sourceselected",TEXT_STYLE_CHANGED:"textstylechanged",MEDIA_RECOVERED:"mediarecovered",VR_STEREO_MODE_CHANGED:"vrstereomodechanged",FPS_DROP:"fpsdrop",BOOKMARK_ERROR:"bookmarkerror",CONCURRENCY_LIMIT:"concurrencylimit",RESIZE:"resize",TIMED_METADATA:"timedmetadata",TIMED_METADATA_CHANGE:"timedmetadatachange",TIMED_METADATA_ADDED:"timedmetadataadded",FRAG_LOADED:"fragloaded",MANIFEST_LOADED:"manifestloaded",USER_GESTURE:"usergesture",DRM_LICENSE_LOADED:"drmlicenseloaded",SOURCE_URL_SWITCHED:"sourceurlswitched"},u=s(s(s({},o),l),a.J)},8171:function(e,t,r){"use strict";r.d(t,{H:function(){return o}});var n=r(5671),a=r(3144),i=r(9021),s=r(4358),o=function(){function e(){(0,n.Z)(this,e),this._listeners=new i.MultiMap,this.dispatchTarget=this,this.__logger=(0,s.jl)("FakeEventTarget")}return(0,a.Z)(e,[{key:"addEventListener",value:function(e,t){this._listeners.push(e,t)}},{key:"removeEventListener",value:function(e,t){this._listeners.remove(e,t)}},{key:"dispatchEvent",value:function(e){for(var t=this._listeners.get(e.type)||[],r=0;r<t.length;++r){e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;var n=t[r];try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(t){this.__logger.error("Error occurred when handling event: ".concat(e.type,"."),t)}if(e.stopped)break}return e.defaultPrevented}}]),e}()},8987:function(e,t,r){"use strict";r.d(t,{v:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(t,r){(0,n.Z)(this,e),this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance?window.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1,this.payload=r}return(0,a.Z)(e,[{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.stopped=!0}},{key:"stopPropagation",value:function(){}}]),e}()},902:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(){(0,n.Z)(this,e)}return(0,a.Z)(e,[{key:"callNext",value:function(e){e&&e()}}]),e}()},4649:function(e,t,r){"use strict";r.d(t,{Z:function(){return at}});var n=r(9439),a=r(5671),i=r(3144),s=r(7326),o=r(9340),l=r(2963),u=r(1120),c=r(4942),d=r(2069),p=r(4270),h=r(4821),f=function(){function e(){(0,a.Z)(this,e),this._createEl()}return(0,i.Z)(e,[{key:"setSrc",value:function(e){e&&(this._posterUrl=e,h.is.setStyle(this._el,"background-image",'url("'.concat(this._posterUrl,'")')),this.hide())}},{key:"src",get:function(){return this._posterUrl}},{key:"getElement",value:function(){return this._el}},{key:"_createEl",value:function(){if(!this._el){var e=this._el=h.is.createElement("div");h.is.setAttribute(e,"id",h.RO.uniqueId(5)),h.is.setAttribute(e,"tabindex","-1")}}},{key:"_removeEl",value:function(){this._el&&h.is.removeChild(this._el.parentNode||void 0,this._el)}},{key:"show",value:function(){h.is.setStyle(this._el,"display","")}},{key:"hide",value:function(){h.is.setStyle(this._el,"display","none")}},{key:"reset",value:function(){this._posterUrl="",h.is.setStyle(this._el,"background-image","")}},{key:"destroy",value:function(){this.reset(),this._removeEl()}}]),e}(),m=r(8987),g=r(8171),y=r(2114),v=function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,null,[{key:"language",get:function(){var e;return(e=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language)&&e.match("-")&&(e=e.split("-")[0]),e}}]),e}(),_=r(4358),k=r(4919),E=r(9769),b=r(962),T=function(){function e(t){var r,n,i,s,o,l,u=this;(0,a.Z)(this,e),(0,c.Z)(this,"_transitions",(l={},(0,c.Z)(l,E.Y.IDLE,(r={},(0,c.Z)(r,y.Rk.LOAD_START,(function(){return u._updateState(E.Y.LOADING)})),(0,c.Z)(r,y.Rk.PLAY,(function(){return u._updateState(E.Y.BUFFERING)})),(0,c.Z)(r,y.Rk.SEEKED,(function(){return u._updateState(E.Y.PAUSED)})),r)),(0,c.Z)(l,E.Y.LOADING,(n={},(0,c.Z)(n,y.Rk.LOADED_METADATA,(function(){return u._updateState(E.Y.PAUSED)})),(0,c.Z)(n,y.Rk.ERROR,(function(e){return e.payload.severity===b.Z.Severity.CRITICAL&&u._updateState(E.Y.IDLE)})),(0,c.Z)(n,y.Rk.SEEKED,(function(){u._prevState&&u._prevState.type===E.Y.PLAYING&&u._updateState(E.Y.PLAYING)})),n)),(0,c.Z)(l,E.Y.PAUSED,(i={},(0,c.Z)(i,y.Rk.PLAY,(function(){return u._updateState(E.Y.PLAYING)})),(0,c.Z)(i,y.Rk.PLAYING,(function(){return u._updateState(E.Y.PLAYING)})),(0,c.Z)(i,y.Rk.ENDED,(function(){return u._updateState(E.Y.IDLE)})),i)),(0,c.Z)(l,E.Y.PLAYING,(s={},(0,c.Z)(s,y.Rk.PAUSE,(function(){return u._updateState(E.Y.PAUSED)})),(0,c.Z)(s,y.Rk.WAITING,(function(){u._player.seeking?u._updateState(E.Y.LOADING):(u._updateState(E.Y.BUFFERING),u._lastWaitingTime=u._player.currentTime)})),(0,c.Z)(s,y.Rk.ENDED,(function(){return u._updateState(E.Y.IDLE)})),(0,c.Z)(s,y.Rk.ERROR,(function(e){return e.payload.severity===b.Z.Severity.CRITICAL&&u._updateState(E.Y.IDLE)})),s)),(0,c.Z)(l,E.Y.BUFFERING,(o={},(0,c.Z)(o,y.Rk.PLAYING,(function(){return u._updateState(E.Y.PLAYING)})),(0,c.Z)(o,y.Rk.PAUSE,(function(){return u._updateState(E.Y.PAUSED)})),(0,c.Z)(o,y.Rk.TIME_UPDATE,(function(){"IE"===d.Z.browser.name&&u._player.currentTime!==u._lastWaitingTime&&u._prevState&&u._prevState.type===E.Y.PLAYING&&(u._lastWaitingTime=null,u._updateState(E.Y.PLAYING))})),o)),l)),this._player=t,this._logger=(0,_.ZP)("StateManager"),this._eventManager=new p.Q,this._history=[],this._prevState=null,this._curState=new k.Z(E.Y.IDLE),this._attachListeners()}return(0,i.Z)(e,[{key:"_attachListeners",value:function(){this._eventManager.listen(this._player,y.Rk.ERROR,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.ENDED,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.PLAY,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.LOAD_START,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.PLAYING,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.LOADED_METADATA,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.PAUSE,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.WAITING,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.SEEKED,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.TIME_UPDATE,this._doTransition.bind(this))}},{key:"_doTransition",value:function(e){(e.type!==y.Rk.TIME_UPDATE||this._curState===E.Y.BUFFERING&&e.type===y.Rk.TIME_UPDATE)&&this._logger.debug("Do transition request",e.type);var t=this._transitions[this._curState.type];"function"==typeof t[e.type]&&t[e.type](e)}},{key:"_updateState",value:function(e){this._curState.type!==e&&(this._curState.duration=Date.now()/1e3,this._history.push(this._curState),this._prevState=this._curState,this._curState=new k.Z(e),this._logger.debug("Switch player state: from ".concat(this._prevState.type," to ").concat(this._curState.type)),this._dispatchEvent())}},{key:"_dispatchEvent",value:function(){var e=new m.v(y.nQ.PLAYER_STATE_CHANGED,{oldState:this._prevState,newState:this._curState});this._player.dispatchEvent(e)}},{key:"destroy",value:function(){this._history=[],this._eventManager.destroy()}},{key:"reset",value:function(){this._history=[]}},{key:"currentState",get:function(){return this._curState}},{key:"previousState",get:function(){return this._prevState}},{key:"history",get:function(){return this._history}}]),e}(),A=r(8413),S=r(4877),P=r(7812),C=r(6462),x=r(6234),I={"":!0,up:!0};function w(e){return"number"==typeof e&&e>=0&&e<=100}var R,M=function(){function e(){(0,a.Z)(this,e),(0,c.Z)(this,"_width",100),(0,c.Z)(this,"_lines",3),(0,c.Z)(this,"_regionAnchorX",0),(0,c.Z)(this,"_regionAnchorY",100),(0,c.Z)(this,"_viewportAnchorX",0),(0,c.Z)(this,"_viewportAnchorY",100),(0,c.Z)(this,"_scroll","")}return(0,i.Z)(e,[{key:"width",get:function(){return this._width},set:function(e){if(!w(e))throw new Error("Width must be between 0 and 100.");this._width=e}},{key:"scroll",get:function(){return this._scroll},set:function(e){var t=function(e){return"string"==typeof e&&!!I[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");this._scroll=t}},{key:"viewportAnchorY",get:function(){return this._viewportAnchorY},set:function(e){if(!w(e))throw new Error("ViewportAnchorY must be between 0 and 100.");this._viewportAnchorY=e}},{key:"viewportAnchorX",get:function(){return this._viewportAnchorX},set:function(e){if(!w(e))throw new Error("ViewportAnchorX must be between 0 and 100.");this._viewportAnchorX=e}},{key:"regionAnchorX",get:function(){return this._regionAnchorX},set:function(e){if(!w(e))throw new Error("RegionAnchorY must be between 0 and 100.");this._regionAnchorX=e}},{key:"lines",get:function(){return this._lines},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");this._lines=e}},{key:"regionAnchorY",get:function(){return this._regionAnchorY},set:function(e){if(!w(e))throw new Error("RegionAnchorX must be between 0 and 100.");this._regionAnchorY=e}}]),e}();function D(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+(0|n)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}R="undefined"!=typeof window&&window.VTTRegion?window.VTTRegion:M;var O={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""},L={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},N={v:"title",lang:"lang"},U={rt:"ruby"};function j(){this.values=q(null)}function B(e,t,r,n){var a=n?e.split(n):[e];for(var i in a)if("string"==typeof a[i]){var s=a[i].split(r);2===s.length&&t(s[0],s[1])}}function F(e,t,r){var n=e;function a(){var t=D(e);if(null===t)throw new Y(Y.Errors.BadTimeStamp,"Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){e=e.replace(/^\s+/,"")}if(i(),t.startTime=a(),i(),"--\x3e"!==e.substr(0,3))throw new Y(Y.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),i(),t.endTime=a(),i(),function(e,t){var n=new j;B(e,(function(e,t){switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){n.set(e,r[a].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),s=i[0];n.integer(e,s),n.percent(e,s)&&n.set("snapToLines",!1),n.alt(e,s,["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start","center","end"]);break;case"position":i=t.split(","),n.percent(e,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start","center","end"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical",""),t.line=n.get("line",t.line||"auto"),t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100);try{t.align=n.get("align","center")}catch(e){t.align=n.get("align","middle")}t.position=n.get("position",t.position||"auto"),t.positionAlign=n.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}j.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var V=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function G(e){for(var t=0;t<V.length;t++){var r=V[t];if(e>=r[0]&&e<=r[1])return!0}return!1}var H=function(e){(0,o.Z)(s,e);var t,r,n=(t=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function s(e,t,r){var i;(0,a.Z)(this,s),i=n.call(this);var o="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent);"undefined"!=typeof WebVTTSet&&(WebVTTSet.fontSet,WebVTTSet.backgroundSet,WebVTTSet.edgeSet),i.cue=t,i.cueDiv=function(e,t){function r(){if(!t)return null;var e,r=t.match(/^([^<]*)(<[^>]+>?)?/);return e=r[1]?r[1]:r[2],t=t.substr(e.length),e}function n(e){return O[e]}function a(e){for(var t;t=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(t[0],n);return e}function i(e,t){return!U[t.localName]||U[t.localName]===e.localName}function s(t,r){var n=L[t];if(!n)return null;var a=e.document.createElement(n),i=N[t];return i&&r&&(a[i]=r.trim()),a}for(var o,l=e.document.createElement("div"),u=l,c=[];null!==(o=r());)if("<"!==o[0])u.appendChild(e.document.createTextNode(a(o)));else{if("/"===o[1]){c.length&&c[c.length-1]===o.substr(2).replace(">","")&&(c.pop(),u=u.parentNode);continue}var d=D(o.substr(1,o.length-2)),p=void 0;if(d){p=e.document.createProcessingInstruction("timestamp",d),u.appendChild(p);continue}var h=o.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!h)continue;if(!(p=s(h[1],h[3])))continue;if(!i(u,p))continue;h[2]&&(p.className=h[2].substr(1).replace("."," ")),c.push(h[1]),u.appendChild(p),u=p}return l}(e,t.text);var l={color:r.color,backgroundColor:r.backgroundColor,textShadow:r.textShadow,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};o||(l.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",l.unicodeBidi="plaintext"),i.applyStyles(l,i.cueDiv),i.div=e.document.createElement("div"),l={textAlign:"middle"===t.align?"center":t.align,font:r.font,whiteSpace:"pre-line",position:"absolute"},o||(l.direction=function(e){var t=[],r="";if(!e||!e.childNodes)return"ltr";function n(e,t){for(var r=t.childNodes.length-1;r>=0;r--)e.push(t.childNodes[r])}function a(e){if(!e||!e.length)return null;var t=e.pop(),r=t.textContent||t.innerText;if(r){var i=r.match(/^.*(\n|\r)/);return i?(e.length=0,i[0]):r}return"ruby"===t.tagName?a(e):t.childNodes?(n(e,t),a(e)):void 0}for(n(t,e);r=a(t);)for(var i=0;i<r.length;i++)if(G(r.charCodeAt(i)))return"rtl";return"ltr"}(i.cueDiv),l.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),i.applyStyles(l),i.div.appendChild(i.cueDiv);var u=0;switch(t.positionAlign||t.align){case"start":case"left":case"line-left":u=t.position;break;case"center":u=t.position-t.size/2;break;case"end":case"right":case"line-right":u=t.position-t.size}return""===t.vertical?i.applyStyles({left:i.formatStyle(u,"%"),width:i.formatStyle(Math.min(t.size,100-u)||t.size,"%")}):i.applyStyles({top:i.formatStyle(u,"%"),height:i.formatStyle(Math.min(t.size,100-u)||t.size,"%")}),i.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})},i}return(0,i.Z)(s)}(function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"applyStyles",value:function(e,t){for(var r in t=t||this.div,e)e.hasOwnProperty(r)&&(t.style[r]=e[r])}},{key:"formatStyle",value:function(e,t){return 0===e?0:e+t}}]),e}()),K=function(){function e(t){var r,n,i,s,o;(0,a.Z)(this,e),(0,c.Z)(this,"overlaps",(function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top})),t.div&&(n=t.div.offsetHeight,i=t.div.offsetWidth,s=t.div.offsetTop,o=(o=t.div.childNodes)&&(o=o[0])&&o.getClientRects&&o.getClientRects(),t=t.div.getBoundingClientRect(),r=o?Math.max(o[0]&&o[0].height||0,t.height/o.length):0),this.left=t.left,this.right=t.right,this.top=t.top||s,this.height=t.height||n,this.bottom=t.bottom||s+(t.height||n),this.width=t.width||i,this.lineHeight=r||t.lineHeight||13}return(0,i.Z)(e,[{key:"move",value:function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}}},{key:"overlapsAny",value:function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1}},{key:"within",value:function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right}},{key:"overlapsOppositeAxis",value:function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}}},{key:"intersectPercentage",value:function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)}},{key:"toCSSCompatValues",value:function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}}}],[{key:"getSimpleBoxPosition",value:function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,r=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,n=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||n,height:e.height||t,bottom:e.bottom||n+(e.height||t),width:e.width||r}}}]),e}();function W(e,t,r,n){var a=new K(t),i=t.cue,s=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,r=t.textTrackList,n=0,a=0;a<r.length&&r[a]!==t;a++)r[a].mode===C.ZP.MODE.SHOWING&&n++;return-1*++n}(i),o=[];if(i.snapToLines){var l;switch(i.vertical){case"":o=["+y","-y"],l="height";break;case"rl":o=["+x","-x"],l="width";break;case"lr":o=["-x","+x"],l="width"}var u=a.lineHeight,c=u*Math.round(s),d=r[l]+u,p=o[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/u)*u),s<0&&(c+=""===i.vertical?r.height:r.width,o=o.reverse()),a.move(p,c)}else{var h=a.lineHeight/r.height*100;switch(i.lineAlign){case"center":s-=h/2;break;case"end":s-=h}switch(i.vertical){case"":t.applyStyles({top:t.formatStyle(s,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(s,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(s,"%")})}o=["+y","-x","+x","-y"],a=new K(t)}var f=function(e,t){for(var a,i=new K(e),s=1,o=0;o<t.length;o++){for(;e.overlapsOppositeAxis(r,t[o])||e.within(r)&&e.overlapsAny(n);)e.move(t[o]);if(e.within(r))return e;var l=e.intersectPercentage(r);s>l&&(a=new K(e),s=l),e=new K(i)}return a||i}(a,o);t.move(f.toCSSCompatValues(r))}var $=function(e,t){this.window=e,this.state="INITIAL",this.buffer="",this.decoder=t||new TextDecoder("utf8"),this.regionList=[]},z=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},q=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function Y(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}Y.prototype=q(Error.prototype),Y.prototype.constructor=Y,Y.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},$.prototype={reportOrThrowError:function(e){if(!(e instanceof Y))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function r(){for(var e=t.buffer,r=0;r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(n=r()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Y(Y.Errors.BadSignature);t.state="HEADER"}for(var i=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:n=r(),t.state){case"HEADER":/:/.test(n)?B(n,(function(e,r){"Region"===e&&function(e){var r=new j;if(B(e,(function(e,t){switch(e){case"id":r.set(e,t);break;case"width":r.percent(e,t);break;case"lines":r.integer(e,t);break;case"regionanchor":case"viewportanchor":var n=t.split(",");if(2!==n.length)break;var a=new j;if(a.percent("x",n[0]),a.percent("y",n[1]),!a.has("x")||!a.has("y"))break;r.set(e+"X",a.get("x")),r.set(e+"Y",a.get("y"));break;case"scroll":r.alt(e,t,["up"])}}),/=/,/\s/),r.has("id")){var n=new R;n.width=r.get("width",100),n.lines=r.get("lines",3),n.regionAnchorX=r.get("regionanchorX",0),n.regionAnchorY=r.get("regionanchorY",100),n.viewportAnchorX=r.get("viewportanchorX",0),n.viewportAnchorY=r.get("viewportanchorY",100),n.scroll=r.get("scroll",""),t.onregion&&t.onregion(n),t.regionList.push({id:r.get("id"),region:n})}}(r)}),/:/):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new VTTCue(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":try{F(n,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==n.indexOf("--\x3e");if(!n||s&&(i=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new Y(Y.Errors.BadSignature)}catch(t){e.reportOrThrowError(t)}return e.onflush&&e.onflush(),this}};var X=r(5856),Z=r(7300),Q=r(488),J=r(2806),ee=r(6820),te=r(6145),re=r(3433),ne=r(9654),ae=function(){function e(t){(0,a.Z)(this,e),this._actions=t,this._middlewares=new ne.k,this._logger=(0,_.ZP)("Middleware")}return(0,i.Z)(e,[{key:"use",value:function(e){for(var t in this._actions){var r=this._actions[t];"function"==typeof e[r]&&(this._logger.debug("Register <".concat(e.id,"> for action ").concat(r)),this._middlewares.push(r,e[r].bind(e)))}}},{key:"run",value:function(e,t){var r=this;this._logger.debug("Start middleware chain for action "+e);for(var n=this._middlewares.get(e),a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s];this._executeMiddleware(n,(function(){r._logger.debug("Finish middleware chain for action "+e),t.apply(void 0,arguments)}),i)}},{key:"_executeMiddleware",value:function(e,t,r){var n=r,a=function(e,t,r){var a;null!=t&&t.length&&(n=t),null!==(a=n)&&void 0!==a&&a.length?e.apply(void 0,(0,re.Z)(n).concat([r])):e(r)},i=e.reduceRight((function(e,t){return function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];a(t,n,e)}}),(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];a(t,r)}));i()}}]),e}(),ie=function(){function e(){(0,a.Z)(this,e),this._middleware=new ae(e.Actions)}return(0,i.Z)(e,[{key:"use",value:function(e){this._middleware.use(e)}},{key:"load",value:function(t){this._middleware.run(e.Actions.LOAD,t)}},{key:"play",value:function(t){this._middleware.run(e.Actions.PLAY,t)}},{key:"pause",value:function(t){this._middleware.run(e.Actions.PAUSE,t)}},{key:"setCurrentTime",value:function(t,r){this._middleware.run(e.Actions.SET_CURRENT_TIME,r,t)}}]),e}();(0,c.Z)(ie,"Actions",{LOAD:"load",PLAY:"play",PAUSE:"pause",SET_CURRENT_TIME:"setCurrentTime"});var se=r(3323),oe={log:{level:"ERROR"},text:{enableCEA708Captions:!0,useNativeTextTrack:!1,forceCenter:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},playback:{audioLanguage:"",textLanguage:"",volume:1,playsinline:!0,preload:"none",autoplay:!1,loop:!1,autopause:!1,allowMutedAutoPlay:!0,muted:!1,pictureInPicture:!0,options:{html5:{hls:{},dash:{},native:{}}},preferNative:{hls:!1,dash:!1},inBrowserFullscreen:!1,screenLockOrientionMode:se.z.NONE,playAdsWithMSE:!1,streamPriority:[{engine:"html5",format:"hls"},{engine:"html5",format:"dash"},{engine:"html5",format:"progressive"},{engine:"flash",format:"hls"}]},streaming:{forceBreakStall:!1},abr:{enabled:!0,fpsDroppedFramesInterval:5e3,fpsDroppedMonitoringThreshold:.2,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,restrictions:{minHeight:0,maxHeight:1/0,minWidth:0,maxWidth:1/0,minBitrate:0,maxBitrate:1/0}},drm:{keySystem:""},network:{maxStaleLevelReloads:20}},le={options:{},metadata:{}},ue=r(3379),ce=r.n(ue),de=r(7795),pe=r.n(de),he=r(569),fe=r.n(he),me=r(3565),ge=r.n(me),ye=r(9216),ve=r.n(ye),_e=r(4589),ke=r.n(_e),Ee=r(7774),be={};be.styleTagTransform=ke(),be.setAttributes=ge(),be.insert=fe().bind(null,"head"),be.domAPI=pe(),be.insertStyleElement=ve(),ce()(Ee.Z,be),Ee.Z&&Ee.Z.locals&&Ee.Z.locals;var Te=r(4779),Ae="srt",Se="vtt",Pe=function(e){(0,o.Z)(d,e);var t,r,n=(t=d,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function d(e){var t;return(0,a.Z)(this,d),t=n.call(this),(0,c.Z)((0,s.Z)(t),"_externalCueIndex",0),(0,c.Z)((0,s.Z)(t),"_textTrackModel",{}),(0,c.Z)((0,s.Z)(t),"_activeTextCues",[]),(0,c.Z)((0,s.Z)(t),"_isTextTrackActive",!1),(0,c.Z)((0,s.Z)(t),"_lastTimeUpdate",0),t._player=e,t._eventManager=new p.Q,t}return(0,i.Z)(d,[{key:"hideTextTrack",value:function(){this._player.config.text.useNativeTextTrack?(this._removeCueChangeListeners(),this._resetExternalNativeTextTrack()):this._isTextTrackActive&&(this._eventManager.unlisten(this._player,y.Rk.TIME_UPDATE),this.dispatchEvent(new m.v(y.nQ.TEXT_CUE_CHANGED,{cues:[]})),this._resetCurrentTrack())}},{key:"getExternalTracks",value:function(e){var t=this,r=this._player.sources.captions;if(!r)return[];this._player.config.text.useNativeTextTrack&&this._addNativeTextTrack();var n=e.filter((function(e){return e instanceof C.ZP})),a=[];return r.forEach((function(e){if(e.language){var r=t._createTextTrack(e);t._maybeAddTrack(r,e,n,a)}else{var i=new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.UNKNOWN_LANGUAGE,{caption:e});t.dispatchEvent(new m.v(y.Rk.ERROR,i))}})),a}},{key:"_maybeAddTrack",value:function(e,t,r,n){var a=r.find((function(e){return e.available&&A.Z.langComparer(t.language,e.language)}));a?d._logger.warn("duplicated language, taking the inband option. Language: ",a.language):(n.push(e),this._updateTextTracksModel(t))}},{key:"_createTextTrack",value:function(e){return new C.ZP({active:!!e.default,kind:C.ZP.KIND.SUBTITLES,label:e.label,language:e.language,external:!0})}},{key:"_updateTextTracksModel",value:function(e){this._textTrackModel[e.language]={cuesStatus:1,cues:[],url:e.url,type:e.type}}},{key:"selectTextTrack",value:function(e){var t=this;this._textTrackModel[e.language]&&(3===this._textTrackModel[e.language].cuesStatus?this._selectTextTrack(e):1===this._textTrackModel[e.language].cuesStatus&&this._downloadAndParseCues(e).then((function(){t._textTrackModel[e.language].cuesStatus=3,t._selectTextTrack(e)})).catch((function(e){return t.dispatchEvent(new m.v(y.Rk.ERROR,e))})))}},{key:"_selectTextTrack",value:function(e){this.hideTextTrack(),this._player.config.text.useNativeTextTrack?(this._addCuesToNativeTextTrack(this._textTrackModel[e.language].cues),this._addCueChangeListener()):this._setTextTrack(e),e.active=!0,this.dispatchEvent(new m.v(y.nQ.TEXT_TRACK_CHANGED,{selectedTextTrack:e}))}},{key:"resetAllCues",value:function(){for(var e in this._textTrackModel)this._textTrackModel[e].cues.forEach((function(e){e.hasBeenReset=!0}))}},{key:"_addCueChangeListener",value:function(){var e=this,t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return C.ZP.isNativeTextTrack(e)&&e.mode===C.ZP.MODE.SHOWING}));r&&this._eventManager.listen(r,"cuechange",(function(t){return e._onCueChange(t)}))}}},{key:"_removeCueChangeListeners",value:function(){var e=this._player.getVideoElement();if(e&&e.textTracks)for(var t=0;t<e.textTracks.length;t++)this._eventManager.unlisten(e.textTracks[t],"cuechange")}},{key:"_onCueChange",value:function(e){var t=e.currentTarget.activeCues,r=(0,C.z6)(t);this.dispatchEvent(new m.v(y.nQ.TEXT_CUE_CHANGED,{cues:r}))}},{key:"reset",value:function(){this._resetCurrentTrack(),this._textTrackModel={},this._resetExternalNativeTextTrack(),this._eventManager.removeAll()}},{key:"destroy",value:function(){this._textTrackModel={},this._eventManager.destroy(),this._activeTextCues=[]}},{key:"_resetCurrentTrack",value:function(){this._activeTextCues=[],this._isTextTrackActive=!1,this._maybeSetExternalCueIndex()}},{key:"_getCuesString",value:function(e){var t=this;return new Promise((function(r,n){var a=t._textTrackModel[e.language],i=a.type||t._getFileType(a.url);[Ae,Se].includes(i)||(t._textTrackModel[e.language].cuesStatus=1,n(new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.UNKNOWN_FILE_TYPE,{captionType:i}))),h.eV.execute(a.url,{},"GET").then((function(e){r(i===Ae?t._convertSrtToVtt(e):e)})).catch((function(){t._textTrackModel[e.language].cuesStatus=1,n(new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.HTTP_ERROR,{url:a.url}))}))}))}},{key:"_parseCues",value:function(e){return new Promise((function(t,r){var n=new $(window,z()),a=[];n.oncue=function(e){a.push(e)},n.onflush=function(){d._logger.debug("finished parsing external cues"),t(a)},n.parse(e),n.flush(),n.onparsingerror((function(e){return r(e)}))}))}},{key:"_convertSrtToVtt",value:function(e){var t=e.replace(/(\d\d:\d\d:\d\d),(\d\d\d) --> (\d\d:\d\d:\d\d),(\d\d\d)/g,(function(e,t,r,n,a){return"".concat(t,".").concat(r," --\x3e ").concat(n,".").concat(a)}));return"WEBVTT\n\n".concat(t)}},{key:"_downloadAndParseCues",value:function(e){var t=this;return this._textTrackModel[e.language].cuesStatus=2,new Promise((function(r,n){t._getCuesString(e).then((function(e){return t._parseCues(e)})).then((function(n){t._textTrackModel[e.language].cues=n,r()})).catch((function(e){return n(e)}))}))}},{key:"_getFileType",value:function(e){return e.split(/[#?]/)[0].split(".").pop().trim()}},{key:"_handleCaptionOnTimeUpdate",value:function(e){var t=this._player.currentTime;if(t){var r=!1;this._hadSeeked()&&(this._activeTextCues=[],r=this._maybeSetExternalCueIndex());var n=this._maybeRemoveActiveCues(),a=this._maybeAddToActiveCues(e);(r||a||n)&&this.dispatchEvent(new m.v(y.nQ.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._lastTimeUpdate=t}}},{key:"_hadSeeked",value:function(){return!!this._player.currentTime&&Math.abs(this._player.currentTime-this._lastTimeUpdate)>1}},{key:"_maybeRemoveActiveCues",value:function(){var e=this._player.currentTime;if(!e)return!1;var t=this._activeTextCues.filter((function(t){return t.startTime<e&&e<t.endTime})),r=this._activeTextCues.length!==t.length;return this._activeTextCues=t,r}},{key:"_maybeAddToActiveCues",value:function(e){var t=this._player.currentTime;if(!t)return!1;for(var r=!1,n=this._textTrackModel[e.language].cues;this._externalCueIndex<n.length&&t>n[this._externalCueIndex].startTime;)t<n[this._externalCueIndex].endTime&&this._activeTextCues.push(n[this._externalCueIndex]),this._externalCueIndex++,r=!0;return r}},{key:"_maybeSetExternalCueIndex",value:function(){var e=this._player._getTextTracks().find((function(e){return e.active&&e.external}));if(e&&e.external){for(var t=this._textTrackModel[e.language]?this._textTrackModel[e.language].cues:[],r=0;r<t.length&&!(t[r].startTime<this._player.currentTime&&this._player.currentTime<t[r].endTime)&&!(t[r].endTime>this._player.currentTime&&t[r].startTime>this._player.currentTime);r++);return this._externalCueIndex=r,!0}return!1}},{key:"_resetExternalNativeTextTrack",value:function(){var e=this._player.getVideoElement();if(e&&e.textTracks){var t=Array.from(e.textTracks).find((function(e){return!!e&&C.ZP.isExternalTrack(e)}));t&&(t.cues&&Object.values(t.cues).forEach((function(e){return t.removeCue(e)})),t.mode=C.ZP.MODE.DISABLED)}}},{key:"_addCuesToNativeTextTrack",value:function(e){var t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return!!e&&C.ZP.isExternalTrack(e)}));r&&(r.mode=C.ZP.MODE.SHOWING,void 0===VTTCue?this._convertCues(e).forEach((function(e){return r.addCue(e)})):e.forEach((function(e){return r.addCue(e)})))}}},{key:"_convertCues",value:function(e){return e.map((function(e){return new TextTrackCue(e.startTime,e.endTime,e.text)}))}},{key:"_addNativeTextTrack",value:function(){var e=this._player.getVideoElement();e&&e.textTracks&&(Array.from(e.textTracks).findIndex((function(e){return!!e&&C.ZP.isExternalTrack(e)}))>-1?this._resetExternalNativeTextTrack():e.addTextTrack(C.ZP.KIND.SUBTITLES,C.ZP.EXTERNAL_TRACK_ID,C.ZP.EXTERNAL_TRACK_ID))}},{key:"_setTextTrack",value:function(e){var t=this;this._player.config.text.useNativeTextTrack||(this._isTextTrackActive=!0,d._logger.debug("External text track changed",e),this._activeTextCues=[],this._externalCueIndex=0,this.dispatchEvent(new m.v(y.nQ.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._eventManager.listen(this._player,y.Rk.TIME_UPDATE,(function(){return t._handleCaptionOnTimeUpdate(e)})))}}]),d}(g.H);(0,c.Z)(Pe,"_logger",(0,_.ZP)("ExternalCaptionsHandler"));var Ce=r(9063),xe=r(8151),Ie=r(9021),we="playkit-in-browser-fullscreen-mode",Re=function(){function e(t){(0,a.Z)(this,e),(0,c.Z)(this,"_isElementInFullscreen",!1),(0,c.Z)(this,"_isScreenLocked",!1),(0,c.Z)(this,"_isScreenOrientationSupport",!!screen&&!!screen.orientation&&"function"==typeof screen.orientation.unlock&&"function"==typeof screen.orientation.lock),(0,c.Z)(this,"_isFullscreenEventDispatched",!1),this._player=t,this._isInBrowserFullscreen=!1,this._eventManager=new p.Q}return(0,i.Z)(e,[{key:"_isNativeDocumentFullscreen",value:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}},{key:"_isIOSFullscreen",value:function(){var e="function"==typeof this._player.getVideoElement?this._player.getVideoElement():null;return"iOS"===this._player.env.os.name&&!!e&&("fullscreen"===e.webkitPresentationMode||!e.webkitPresentationMode&&e.webkitDisplayingFullscreen)}},{key:"isFullscreen",value:function(){return this._isNativeDocumentFullscreen()&&this._isElementInFullscreen||this._isIOSFullscreen()||this._isInBrowserFullscreen}},{key:"enterFullscreen",value:function(e){if(!this.isFullscreen()){this.registerFullScreenEvents();var t=e&&h.is.getElementById(e),r=this._player.config.playback;if(t||(t=this._player.getView()),"iOS"===this._player.env.os.name)if(r.inBrowserFullscreen&&r.playsinline||this._player.engineType===Q.r.YOUTUBE)this._enterInBrowserFullscreen(t);else{var n=this._player.getVideoElement();n&&"function"==typeof n.webkitEnterFullScreen&&(this._player.isInPictureInPicture()?(setTimeout((function(){return n.webkitEnterFullScreen()}),1e3),this._player.exitPictureInPicture()):n.webkitEnterFullScreen())}else this._requestFullscreen(t)}}},{key:"exitFullscreen",value:function(){if(this.isFullscreen())if("iOS"===this._player.env.os.name)if(this._isInBrowserFullscreen||this._player.engineType===Q.r.YOUTUBE)this._exitInBrowserFullscreen();else{var e=this._player.getVideoElement();e&&"function"==typeof e.webkitExitFullscreen&&e.webkitExitFullscreen()}else this._requestExitFullscreen()}},{key:"_nativeEnterFullScreen",value:function(e){return"function"==typeof e.requestFullscreen?e.requestFullscreen():"function"==typeof e.mozRequestFullScreen?e.mozRequestFullScreen():"function"==typeof e.webkitRequestFullScreen?e.webkitRequestFullScreen():"function"==typeof e.msRequestFullscreen?e.msRequestFullscreen():void 0}},{key:"_requestFullscreen",value:function(e){var t=this;this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),Promise.resolve(this._nativeEnterFullScreen(e)).then((function(){t._isElementInFullscreen=!0;var e=h.c7.getPropertyPath(t._player,"config.playback.screenLockOrientionMode"),r=e!==se.z.NONE&&Object.values(se.z).includes(e);t._isScreenOrientationSupport&&r&&screen.orientation.lock(e).then((function(){return t._isScreenLocked=!0})).catch((function(){return t._isScreenLocked=!1}))}),(function(){}))}},{key:"_nativeExitFullScreen",value:function(){return"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.msExitFullscreen?document.msExitFullscreen():void 0}},{key:"_requestExitFullscreen",value:function(){var e=this;Promise.resolve(this._nativeExitFullScreen()).then((function(){e._isElementInFullscreen=!1,e._isScreenOrientationSupport&&e._isScreenLocked&&(screen.orientation.unlock(),e._isScreenLocked=!1)}),(function(){}))}},{key:"_enterInBrowserFullscreen",value:function(e){this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),h.is.addClassName(e,we),this._isInBrowserFullscreen=!0,this._fullscreenEnterHandler(),this._player.dispatchEvent(new m.v(this._player.Event.RESIZE))}},{key:"_exitInBrowserFullscreen",value:function(){var e=h.is.getElementBySelector("."+we);e&&h.is.removeClassName(e,we),this._isInBrowserFullscreen=!1,this._fullscreenExitHandler(),this._player.dispatchEvent(new m.v(this._player.Event.RESIZE))}},{key:"registerFullScreenEvents",value:function(){var e=this;"iOS"===this._player.env.os.name?this._handleIosFullscreen():(this._eventManager.listen(document,"webkitfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"mozfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"fullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"MSFullscreenChange",(function(){return e._fullscreenChangeHandler()})))}},{key:"_handleIosFullscreen",value:function(){var e=this,t=function(){var t=e._player.getVideoElement();t&&(e._eventManager.listen(t,"webkitbeginfullscreen",(function(){return e._fullscreenEnterHandler()})),e._eventManager.listen(t,"webkitendfullscreen",(function(){return e._fullscreenExitHandler()})))};this._player.getVideoElement()?t():this._eventManager.listenOnce(this._player,this._player.Event.SOURCE_SELECTED,(function(){return t()}))}},{key:"_fullscreenChangeHandler",value:function(){this.isFullscreen()?this._fullscreenEnterHandler():this._fullscreenExitHandler()}},{key:"_fullscreenEnterHandler",value:function(){this.isFullscreen()&&!this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!0,this._player.dispatchEvent(new m.v(this._player.Event.ENTER_FULLSCREEN)))}},{key:"_fullscreenExitHandler",value:function(){!this.isFullscreen()&&this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!1,this._eventManager.removeAll(),this._player.dispatchEvent(new m.v(this._player.Event.EXIT_FULLSCREEN)))}},{key:"destroy",value:function(){this._eventManager.destroy()}}]),e}(),Me=r(1752),De=function(e){(0,o.Z)(c,e);var t,r,n=(t=c,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function c(e,t){var r,i;return(0,a.Z)(this,c),(i=n.call(this))._eventManager=new p.Q,i._pluginDecorators=t.createDecorators(e,(0,Me.Z)((r=(0,s.Z)(i),(0,u.Z)(c.prototype)),"dispatchEvent",r).bind((0,s.Z)(i))),Object.values(y.tw).forEach((function(t){return i._eventManager.listen(e,t,(function(e){return i.dispatchEvent(e)}))})),(0,l.Z)(i,new Proxy(e,{get:function(e,t){"destroy"===t&&i._destroy();var r,n=i._pluginDecorators.find((function(e){return e.active}));return(r="addEventListener"===t||"removeEventListener"===t?(0,s.Z)(i):n&&t in n?n:e)[t]&&"function"==typeof r[t].bind?r[t].bind(r):r[t]},set:function(e,t,r){var n=i._pluginDecorators.find((function(e){return t in e&&e.active}));return n&&t in n?n[t]=r:e[t]=r,!0}}))}return(0,i.Z)(c,[{key:"dispatchEvent",value:function(e){var t=this._pluginDecorators.find((function(e){return e.active}));return t&&t.dispatchEvent?t.dispatchEvent(e):(0,Me.Z)((0,u.Z)(c.prototype),"dispatchEvent",this).call(this,e)}},{key:"_destroy",value:function(){this._pluginDecorators=[],this._eventManager.destroy()}},{key:"active",get:function(){return!0}}]),c}(g.H),Oe=r(8143),Le=r(2983),Ne=function(){function e(){(0,a.Z)(this,e),(0,c.Z)(this,"_decoratorProviders",new Map),(0,c.Z)(this,"_logger",(0,_.ZP)("EngineDecoratorManager"))}return(0,i.Z)(e,[{key:"register",value:function(e){this._decoratorProviders.has(e.getName())?this._logger.warn("decorator already registered for ".concat(e.getName())):this._decoratorProviders.set(e.getName(),e)}},{key:"createDecorators",value:function(e,t){return this._logger.debug("decorators created for ".concat(Array.from(this._decoratorProviders.keys()).toString())),Array.from(this._decoratorProviders.values(),(function(r){return r.getEngineDecorator(e,t)}))}},{key:"destroy",value:function(){this._logger.debug("decorators destroyed"),this._decoratorProviders.clear()}}]),e}(),Ue=r(1177);function je(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function Be(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){je(i,n,a,s,o,"next",e)}function o(e){je(i,n,a,s,o,"throw",e)}s(void 0)}))}}var Fe=r(4687),Ve=r.n(Fe),Ge=r(5590);function He(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ke(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ke(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function Ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function We(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?We(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):We(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ze=/#wh=/i,qe=/#xywh=/i,Ye=new RegExp("^/[^/].+"),Xe=function(e){(0,o.Z)(E,e);var t,r,d,f,g,v,_,k=(v=E,_=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,u.Z)(v);if(_){var r=(0,u.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,l.Z)(this,e)});function E(){var e;return(0,a.Z)(this,E),e=k.call(this),(0,c.Z)((0,s.Z)(e),"_cues",[]),e._eventManager=new p.Q,e}return(0,i.Z)(E,[{key:"load",value:(g=Be(Ve().mark((function e(t){return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return E._logger.debug("start loading the vtt thumbnails"),e.next=5,this._downloadAndParseCues(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"getThumbnail",value:function(e){var t=this._findCue(e,this._cues);if(t){var r=t.imgUrl,n=t.size,a=t.coordinates;a=a||{x:0,y:0};var i=$e($e({url:r},n=n||this._naturalImgSize),a);return new Ge.F(i)}return null}},{key:"isUsingVttThumbnails",value:function(){var e;return!(null===(e=this._cues)||void 0===e||!e.length)}},{key:"_downloadAndParseCues",value:(f=Be(Ve().mark((function e(t){var r,n;return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._downloadVttFile(t);case 3:return r=e.sent,e.next=6,this._processVtt(r);case 6:return n=e.sent,e.next=9,this._formatIntoThumbnailCues(n,t);case 9:this._cues=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.dispatchEvent(new m.v(y.Rk.ERROR,e.t0));case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return f.apply(this,arguments)})},{key:"_downloadVttFile",value:(d=Be(Ve().mark((function e(t){return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.eV.execute(t.vttUrl,{},"GET");case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.HTTP_ERROR,e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e){return d.apply(this,arguments)})},{key:"_processVtt",value:(r=Be(Ve().mark((function e(t){return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new $(window,z()),a=[];n.oncue=function(e){a.push(e)},n.onflush=function(){E._logger.debug("finished parsing thumbnails cues"),e(a)},n.parse(t),n.flush(),n.onparsingerror((function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"_formatIntoThumbnailCues",value:(t=Be(Ve().mark((function e(t,r){var n,a,i,s,o,l;return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validateThumbnailsVTTFormat(t)){e.next=4;break}throw new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"invalid thumbnail vtt format",vttUrl:r.vttUrl});case 4:return n=this._extractCueMetadata(t[0],r),e.next=7,this.validateImgUrl(n.imgUrl);case 7:if(e.sent){e.next=11;break}throw new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"failed loading the image - invalid image url",imgUrl:n.imgUrl});case 11:return e.next=13,this.extractImgNaturalDimensions(n.imgUrl);case 13:this._naturalImgSize=e.sent,a=[],i=He(t);try{for(i.s();!(s=i.n()).done;)o=s.value,l=this._extractCueMetadata(o,r),a.push(l)}catch(e){i.e(e)}finally{i.f()}return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"validateThumbnailsVTTFormat",value:function(e){return e.length&&e[0]instanceof VTTCue}},{key:"extractImgNaturalDimensions",value:function(e){var t=this;return new Promise((function(r){var n=new Image;n.src=e,t._eventManager.listenOnce(n,"load",(function(){r({height:n.naturalHeight,width:n.naturalWidth})})),t._eventManager.listenOnce(n,"error",(function(){return r(null)}))}))}},{key:"validateImgUrl",value:function(e){var t=this;return new Promise((function(r){var n=new Image;n.src=e,t._eventManager.listenOnce(n,"load",(function(){r(!0)})),t._eventManager.listenOnce(n,"error",(function(){return r(!1)}))}))}},{key:"_extractCueMetadata",value:function(e,t){var r,a=e.startTime,i=e.endTime,s=e.text,o=t.vttUrl.substring(0,t.vttUrl.lastIndexOf("/")),l=ze.test(s),u=qe.test(s),c=!1,d=null,p=null;if(l){var h=s.split(ze);r=(0,n.Z)(h,1)[0],E._logger.warn('vtt thumbnails in "'.concat(ze,'" form - is supported but the width and height options are ignored and The images will be displayed in their natural dimensions')),c=void 0!==r}else if(u){var f=s.split(qe),m=(0,n.Z)(f,2);r=m[0];var g=m[1].split(",").map(Number),y=(0,n.Z)(g,4),v=y[0],_=y[1],k=y[2],T=y[3];d={x:v,y:_},p={width:k,height:T},c=[v,_,k,T,r].every((function(e){return void 0!==e}))}else r=s,c=!!s;if(0!==r.indexOf("http://")&&0!==r.indexOf("https://")&&(r=Ye.test(r)?r.substring(1):r,r="".concat(o,"/").concat(r)),c)return{startTime:a,endTime:i,imgUrl:r,size:p,coordinates:d};throw new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"error while parsing the vtt cues - invalid cue",parsedCue:{startTime:a,endTime:i,options:s}})}},{key:"_findCue",value:function(e,t){for(var r=0,n=t.length-1;r<=n;){var a=Math.floor((r+n)/2),i=t[a];if(e>=i.startTime&&e<i.endTime)return t[a];e<i.startTime?n=a-1:r=a+1}return null}},{key:"reset",value:function(){this._cues=[],this._eventManager.removeAll(),this._naturalImgSize={}}},{key:"destroy",value:function(){this.reset(),this._eventManager.destroy()}}]),E}(g.H);function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}(0,c.Z)(Xe,"_logger",(0,_.ZP)("ExternalThumbnailsHandler"));var et="playkit-engine",tt="playkit-subtitles-style",rt="auto",nt="off",at=function(e){(0,o.Z)(k,e);var t,r,g=(t=k,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function k(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.Z)(this,k),e=g.call(this),(0,c.Z)((0,s.Z)(e),"_sources",{}),(0,c.Z)((0,s.Z)(e),"_activeTextCues",[]),(0,c.Z)((0,s.Z)(e),"_textDisplaySettings",{}),(0,c.Z)((0,s.Z)(e),"_playbackAttributesState",{muted:void 0,volume:void 0,rate:void 0,videoTrack:void 0,audioLanguage:"",textLanguage:"",captionsDisplay:void 0}),(0,c.Z)((0,s.Z)(e),"_hasUserInteracted",!1),(0,c.Z)((0,s.Z)(e),"_isOnLiveEdge",!1),(0,c.Z)((0,s.Z)(e),"_shouldLoadAfterAttach",!1),e._setConfigLogLevel(t),e._playerId=h.RO.uniqueId(5),e._prepareVideoElement(),k.runCapabilities(),e._env=d.Z,e._tracks=[],e._firstPlay=!0,e._loadingMedia=!1,e._loading=!1,e._playbackStart=!1,e._firstPlaying=!1,e._reset=!0,e._destroyed=!1,e._fallbackToMutedAutoPlay=!1,e._config=k._defaultConfig,e._sources=h.c7.copyDeep(le),e._eventManager=new p.Q,e._posterManager=new f,e._stateManager=new T((0,s.Z)(e)),e._resizeWatcher=new Ie.ResizeWatcher,e._playbackMiddleware=new ie,e._textStyle=new x.Z,e._createReadyPromise(),e._createPlayerContainer(),e._appendDomElements(),e._externalCaptionsHandler=new Pe((0,s.Z)(e)),e._externalThumbnailsHandler=new Xe,e._fullscreenController=new Re((0,s.Z)(e)),e.configure(t),e}return(0,i.Z)(k,[{key:"configure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setConfigLogLevel(e),h.c7.mergeDeep(this._config,e),this._applyTextTrackConfig(e),this._applyABRRestriction(e)}},{key:"setSourcesMetadata",value:function(e){this._sources&&(this._sources.metadata||(this._sources.metadata={}),h.c7.mergeDeep(this._sources.metadata,e))}},{key:"setSources",value:function(e){this._hasSources(e)?(this.reset(),h.c7.mergeDeep(this._sources,e),this._resizeWatcher.init(h.is.getElementById(this._playerId)),k._logger.debug("Change source started"),this.dispatchEvent(new m.v(y.nQ.CHANGE_SOURCE_STARTED)),this._reset=!1,this._selectEngineByPriority()?(this.dispatchEvent(new m.v(y.nQ.SOURCE_SELECTED,{selectedSource:this._sources[this._streamType]})),this._attachMedia(),this._handlePlaybackOptions(),this._posterManager.setSrc(this._sources.poster),this._handleDimensions(),this._handlePreload(),this._handleAutoPlay(),k._logger.debug("Change source ended"),this.dispatchEvent(new m.v(y.nQ.CHANGE_SOURCE_ENDED))):(k._logger.warn("No playable engines was found to play the given sources"),this.dispatchEvent(new m.v(y.Rk.ERROR,new b.Z(b.Z.Severity.CRITICAL,b.Z.Category.PLAYER,b.Z.Code.NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE,"No Engine Found To Play The Source"))))):h.c7.mergeDeep(this._sources,e)}},{key:"ready",value:function(){return this._readyPromise?this._readyPromise:Promise.resolve()}},{key:"load",value:function(){var e=this;this.src?k._logger.debug("The source has already been loaded. load request ignored"):this._playbackMiddleware.load((function(){e._engine?e._load():e._eventManager.listenOnce(e,y.nQ.SOURCE_SELECTED,(function(){return e._load()}))}))}},{key:"play",value:function(e){var t=this;e&&e.programmatic?this._autoPlay():(this._playbackStart||(this._playbackStart=!0,this.dispatchEvent(new m.v(y.nQ.PLAYBACK_START)),this.src||this._prepareVideoElement(),this.load()),this._engine?this._playbackMiddleware.play((function(){return t._play()})):this._loadingMedia?this._playbackMiddleware.play((function(){return t._playAfterAsyncMiddleware()})):this.dispatchEvent(new m.v(y.Rk.ERROR,new b.Z(b.Z.Severity.CRITICAL,b.Z.Category.PLAYER,b.Z.Code.NO_SOURCE_PROVIDED,"No Source Provided"))))}},{key:"pause",value:function(){this._engine&&this._playbackMiddleware.pause(this._pause.bind(this))}},{key:"getView",value:function(){return this._el}},{key:"getVideoElement",value:function(){if(this._engine)return this._engine.getVideoElement()}},{key:"videoHeight",get:function(){return this._engine?this._engine.videoHeight:null}},{key:"videoWidth",get:function(){return this._engine?this._engine.videoWidth:null}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._reset||(this.pause(),this._externalCaptionsHandler.reset(),this._externalThumbnailsHandler.reset(),this._posterManager.reset(),this._stateManager.reset(),this._sources=h.c7.copyDeep(le),this._activeTextCues=[],this._updateTextDisplay([]),this._tracks=[],C.PZ.reset(),this._resetStateFlags(),this._engineType="",this._streamType="",this._pendingSelectedVideoTrack=void 0,this._engine&&this._engine.reset(),this.showBlackCover(),this._reset=!0,this.dispatchEvent(new m.v(y.nQ.PLAYER_RESET,{isChangeMedia:e})),this._eventManager.removeAll(),this._resizeWatcher.init(h.is.getElementById(this._playerId)),this._createReadyPromise(),this._isOnLiveEdge=!1,this._shouldLoadAfterAttach=!1)}},{key:"destroy",value:function(){this._destroyed||(this._externalCaptionsHandler.destroy(),this._posterManager.destroy(),this._stateManager.destroy(),this._fullscreenController.destroy(),this._activeTextCues=[],this._textDisplaySettings={},this._config={},this._tracks=[],this._engineType="",this._streamType="",this._readyPromise=void 0,this._pendingSelectedVideoTrack=void 0,this._resetStateFlags(),this._playbackAttributesState={},this._engine&&this._engine.destroy(),this._engineDecoratorManager&&this._engineDecoratorManager.destroy(),this._resizeWatcher.destroy(),this._el&&h.is.removeChild(this._el.parentNode,this._el),this._destroyed=!0,this.dispatchEvent(new m.v(y.nQ.PLAYER_DESTROY)),this._eventManager.destroy())}},{key:"hideBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="hidden")}},{key:"showBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="visible")}},{key:"attachMediaSource",value:function(){var e=this;this._engine&&(this._shouldLoadAfterAttach=!0,this._engine.attachMediaSource(),this._eventManager.listenOnce(this,y.Rk.CAN_PLAY,(function(){"number"==typeof e._playbackAttributesState.rate&&(e.playbackRate=e._playbackAttributesState.rate)})))}},{key:"detachMediaSource",value:function(){this._engine&&(this.pause(),this.hideTextTrack(),this._shouldLoadAfterAttach=!1,this._createReadyPromise(),this._engine.detachMediaSource())}},{key:"registerEngineDecoratorProvider",value:function(e){this._engineDecoratorManager||(this._engineDecoratorManager=new Ne),e&&this._engineDecoratorManager.register(e)}},{key:"buffered",get:function(){return this._engine?this._engine.buffered:null}},{key:"stats",get:function(){var e={targetBuffer:NaN,availableBuffer:NaN};return this._engine&&(e.targetBuffer=this._engine.targetBuffer,e.availableBuffer=this._engine.availableBuffer),e}},{key:"currentTime",get:function(){return this._engine?this._engine.currentTime:null},set:function(e){this._playbackMiddleware.setCurrentTime(e,this._setCurrentTime.bind(this))}},{key:"duration",get:function(){return this._engine?this._engine.duration:null}},{key:"liveDuration",get:function(){return this._engine?this._engine.liveDuration:null}},{key:"volume",get:function(){return this._engine?this._engine.volume:null},set:function(e){if(this._engine&&(h.Mr.isFloat(e)||0===e||1===e)){var t=e;t<0&&(t=0),t>1&&(t=1),this._engine.volume=t}}},{key:"paused",get:function(){return this._engine?this._engine.paused:null}},{key:"seeking",get:function(){return this._engine?this._engine.seeking:null}},{key:"playsinline",get:function(){return this._engine?this._engine.playsinline:null},set:function(e){this._engine&&(this._engine.playsinline=e)}},{key:"muted",get:function(){return this._engine?this._engine.muted:null},set:function(e){this._engine&&(this._engine.muted=e,this.dispatchEvent(new m.v(y.nQ.MUTE_CHANGE,{mute:e})),!1===e&&(this._fallbackToMutedAutoPlay=e))}},{key:"src",get:function(){return this._engine?this._engine.src:null}},{key:"dimensions",get:function(){return{width:this._el.clientWidth,height:this._el.clientHeight}},set:function(e){var t=this._getTargetElement();if(!e||h.c7.isEmptyObject(e))this._aspectRatio=null,t.style.width=null,t.style.height=null;else{var r=h.c7.mergeDeep(this.dimensions,e),n=r.height,a=r.width;t.style.width="number"==typeof a?"".concat(a,"px"):a,t.style.height="number"==typeof n?"".concat(n,"px"):n,this._calcRatio(t,e)}}},{key:"_getTargetElement",value:function(){return h.is.getElementById(this._config.targetId)}},{key:"poster",get:function(){return this._posterManager.src}},{key:"playbackRate",get:function(){return this._engine?this._engine.playbackRate:null},set:function(e){this._engine&&(this._engine.playbackRate=e)}},{key:"playbackRates",get:function(){return this._playbackRates?this._playbackRates:this._engine?this._engine.playbackRates:[]}},{key:"defaultPlaybackRate",get:function(){return this._engine?this._engine.defaultPlaybackRate:1}},{key:"engineType",get:function(){return this._engineType}},{key:"streamType",get:function(){return this._streamType}},{key:"env",get:function(){return this._env}},{key:"config",get:function(){return h.c7.mergeDeep({},this._config)}},{key:"sources",get:function(){return h.c7.mergeDeep({},this._sources)}},{key:"hasUserInteracted",get:function(){return this._hasUserInteracted}},{key:"loadingMedia",set:function(e){this._loadingMedia=e}},{key:"crossOrigin",get:function(){return this._engine?this._engine.crossOrigin:null},set:function(e){this._engine&&(this._engine.crossOrigin=e)}},{key:"ended",get:function(){return this._engine?this._engine.ended:null}},{key:"playbackMiddleware",get:function(){return this._playbackMiddleware}},{key:"posterManager",get:function(){return this._posterManager}},{key:"isLive",value:function(){return!(this._sources.type===J.D.VOD||!(this._sources.type===J.D.LIVE||this._engine&&this._engine.isLive()))}},{key:"isAudio",value:function(){return this._sources.type===J.D.AUDIO}},{key:"isOnLiveEdge",value:function(){return this._engine&&"function"==typeof this._engine.isOnLiveEdge?this._engine.isOnLiveEdge():this._isOnLiveEdge}},{key:"isDvr",value:function(){return this.isLive()&&this._sources.dvr}},{key:"seekToLiveEdge",value:function(){this._engine&&this.isLive()&&(this._engine.seekToLiveEdge(),this._isOnLiveEdge=!0)}},{key:"getStartTimeOfDvrWindow",value:function(){return this._engine?this._engine.getStartTimeOfDvrWindow():0}},{key:"getTracks",value:function(e){switch(e){case X.V.VIDEO:return h.c7.copyDeep(this._getVideoTracks());case X.V.AUDIO:return h.c7.copyDeep(this._getAudioTracks());case X.V.TEXT:return h.c7.copyDeep(this._getTextTracks());case X.V.IMAGE:return h.c7.copyDeep(this._getImageTracks());default:return h.c7.copyDeep(this._tracks)}}},{key:"getActiveTracks",value:function(){return h.c7.copyDeep({video:this._getVideoTracks().find((function(e){return e.active})),audio:this._getAudioTracks().find((function(e){return e.active})),text:this._getTextTracks().find((function(e){return e.active}))})}},{key:"selectTrack",value:function(e){this._engine&&(e instanceof S.Z?(this._playbackAttributesState.videoTrack=e,this._stateManager.currentState.type===E.Y.IDLE?this._pendingSelectedVideoTrack=e:this._engine.selectVideoTrack(e)):e instanceof P.Z?this._engine.selectAudioTrack(e):e instanceof C.PZ?(this._resetTextDisplay(),e.language===nt?(this.hideTextTrack(),this._externalCaptionsHandler.hideTextTrack(),this._playbackAttributesState.captionsDisplay=!1):e.external?(this._engine.hideTextTrack(),this._externalCaptionsHandler.selectTextTrack(e)):(this._externalCaptionsHandler.hideTextTrack(),this._engine.selectTextTrack(e))):e instanceof Le.Z&&this._engine.selectImageTrack(e))}},{key:"hideTextTrack",value:function(){if(this._engine){this._engine.hideTextTrack(),this._resetTextDisplay();var e=this._getTextTracks(),t=e.find((function(e){return!0===e.active}));t&&t.external&&this._externalCaptionsHandler.hideTextTrack(),e.map((function(e){return e.active=!1}));var r=e.find((function(e){return e.language===nt}));r&&(r.active=!0,this.dispatchEvent(new m.v(y.nQ.TEXT_TRACK_CHANGED,{selectedTextTrack:r}))),this._playbackAttributesState.captionsDisplay=!1}}},{key:"showTextTrack",value:function(){var e=this._getTextTracks(),t=this._playbackAttributesState.textLanguage||this._getLanguage(e,rt,e.find((function(e){return e.default})));this._setDefaultTrack(e,t)}},{key:"addTextTrack",value:function(e,t,r){if(this._engine&&"function"==typeof this._engine.addTextTrack)return this._engine.addTextTrack(e,t,r)}},{key:"getNativeTextTracks",value:function(){return this._engine&&"function"==typeof this._engine.getNativeTextTracks?this._engine.getNativeTextTracks():[]}},{key:"enableAdaptiveBitrate",value:function(){this._engine&&this._engine.enableAdaptiveBitrate(),this._playbackAttributesState.videoTrack=void 0}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._engine&&this._engine.isAdaptiveBitrateEnabled()}},{key:"_applyABRRestriction",value:function(e){if(h.c7.hasPropertyPath(e,"abr.restrictions")&&this._engine&&this._tracks.length){var t=this._config.abr.restrictions,r=this._tracks.filter((function(e){return e instanceof S.Z})),n=(0,Ue.u)(r,t);if(n.length){var a=this._tracks.filter((function(e){return e instanceof S.Z&&e.available}));(a.length!==n.length||!a.every((function(e,t){return e.bandwidth===n[t].bandwidth})))&&(this._engine.applyABRRestriction(t),this._tracks.forEach((function(e){!n.includes(e)&&e instanceof S.Z?(e.available=!1,e.active=!1):e.available=!0})),this.getActiveTracks().video||(n[0].active=!0),this.dispatchEvent(new m.v(y.nQ.TRACKS_CHANGED,{tracks:this._tracks.filter((function(e){return e.available}))})))}else k._logger.warn("Invalid restriction, Nothing has changed values do not meet the restriction")}}},{key:"_applyTextTrackConfig",value:function(e){if(h.c7.hasPropertyPath(e,"text.textTrackDisplaySetting")||h.c7.getPropertyPath(e,"text.forceCenter")){var t={};h.c7.hasPropertyPath(this._config,"text.textTrackDisplaySetting")&&(t=h.c7.mergeDeep(t,this._config.text.textTrackDisplaySetting)),h.c7.getPropertyPath(this._config,"text.forceCenter")&&(t=h.c7.mergeDeep(t,{position:"auto",align:"center",size:"100"})),this.setTextDisplaySettings(t)}try{h.c7.hasPropertyPath(e,"text.textStyle")&&(this.textStyle=x.Z.fromJson(this._config.text.textStyle))}catch(e){k._logger.warn(e)}}},{key:"getThumbnail",value:function(e){return this._externalThumbnailsHandler.isUsingVttThumbnails()?this._externalThumbnailsHandler.getThumbnail(e):this._engine?this._engine.getThumbnail(e):null}},{key:"setTextDisplaySettings",value:function(e){this._textDisplaySettings=h.c7.mergeDeep(this._textDisplaySettings,e),this._updateCueDisplaySettings();for(var t=0;t<this._activeTextCues.length;t++)this._activeTextCues[t].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)}},{key:"textDisplaySetting",get:function(){return h.c7.copyDeep(this._textDisplaySettings)}},{key:"textStyle",get:function(){return this._textStyle.clone()},set:function(e){if(!(e instanceof x.Z))throw new Error("Style must be instance of TextStyle");var t=h.is.getElementBySelector(".".concat(this._playerId,".").concat(tt));t||(t=h.is.createElement("style"),h.is.addClassName(t,this._playerId),h.is.addClassName(t,tt),h.is.appendChild(document.head,t));for(var r=t.sheet;r.cssRules.length;)r.deleteRule(0);try{this._textStyle=e,this._config.text.useNativeTextTrack?r.insertRule("#".concat(this._playerId," video.").concat(et,"::cue { ").concat(e.toCSS()," }"),0):this._engine&&(this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay(this._activeTextCues)),this.dispatchEvent(new m.v(y.nQ.TEXT_STYLE_CHANGED))}catch(e){k._logger.error(e.message)}}},{key:"isFullscreen",value:function(){return this._fullscreenController.isFullscreen()}},{key:"notifyEnterFullscreen",value:function(){this.isFullscreen()&&this.dispatchEvent(new m.v(y.nQ.ENTER_FULLSCREEN))}},{key:"notifyExitFullscreen",value:function(){this.isFullscreen()||this.dispatchEvent(new m.v(y.nQ.EXIT_FULLSCREEN))}},{key:"enterFullscreen",value:function(e){this._fullscreenController.enterFullscreen(e)}},{key:"exitFullscreen",value:function(){this._fullscreenController.exitFullscreen()}},{key:"enterPictureInPicture",value:function(){this.isFullscreen()&&this.exitFullscreen(),this._engine&&!this._engine.isInPictureInPicture&&this._engine.enterPictureInPicture()}},{key:"exitPictureInPicture",value:function(){this._engine&&this._engine.isInPictureInPicture&&this._engine.exitPictureInPicture()}},{key:"isInPictureInPicture",value:function(){return!!this._engine&&this._engine.isInPictureInPicture}},{key:"isPictureInPictureSupported",value:function(){return!!this._config.playback.pictureInPicture&&this._engine.isPictureInPictureSupported()}},{key:"isVr",value:function(){return!!this._sources.vr}},{key:"getLogLevel",value:function(e){return(0,_.ZO)(e)}},{key:"setLogLevel",value:function(e,t){(0,_.Ub)(e,t)}},{key:"getDrmInfo",value:function(){return this._engine.getDrmInfo()}},{key:"_resetTextDisplay",value:function(){this._activeTextCues=[],this._updateTextDisplay([])}},{key:"_prepareVideoElement",value:function(){var e=this;Te.zv.getEngines().forEach((function(t){t.prepareVideoElement(e._playerId)}))}},{key:"_setConfigLogLevel",value:function(e){e.log&&e.log.level&&_.in[e.log.level]&&(0,_.Ub)(_.in[e.log.level]),e.log&&"function"==typeof e.log.handler&&(0,_.hs)(e.log.handler)}},{key:"_hasSources",value:function(e){return!!e&&!!Object.values(Z.j).find((function(t){return e[t]&&e[t].length>0}))}},{key:"_createPlayerContainer",value:function(){var e=this._el=h.is.createElement("div");h.is.addClassName(e,"playkit-container"),h.is.setAttribute(e,"id",this._playerId),h.is.setAttribute(e,"tabindex","-1")}},{key:"_appendEngineEl",value:function(){if(this._el){var e=this._engine.getVideoElement(),t="".concat(et);h.is.addClassName(e,t);var r="".concat(et,"-").concat(this._engine.id);h.is.addClassName(e,r),h.is.prependTo(e,this._el),"youtube"===this._engine.id&&(this._el.style.zIndex="1")}}},{key:"_appendDomElements",value:function(){this._blackCoverEl=h.is.createElement("div"),h.is.addClassName(this._blackCoverEl,"playkit-black-cover"),h.is.appendChild(this._el,this._blackCoverEl);var e=this._posterManager.getElement();h.is.addClassName(e,"playkit-poster"),h.is.appendChild(this._el,e),this._textDisplayEl=h.is.createElement("div"),h.is.addClassName(this._textDisplayEl,"playkit-subtitles"),h.is.appendChild(this._el,this._textDisplayEl)}},{key:"_createReadyPromise",value:function(){var e=this;this._readyPromise=new Promise((function(t,r){e._eventManager.listenOnce(e,y.nQ.TRACKS_CHANGED,(function(){e.dispatchEvent(new m.v(y.nQ.MEDIA_LOADED)),e._handlePlaybackRate(),t()})),e._eventManager.listen(e,y.Rk.ERROR,(function(e){e.payload.severity===b.Z.Severity.CRITICAL&&r()}))})).catch((function(){}))}},{key:"_handlePlaybackRate",value:function(){"number"==typeof this._playbackAttributesState.rate?this.playbackRate=this._playbackAttributesState.rate:"number"==typeof this._config.playback.playbackRate&&(this.playbackRate=this._config.playback.playbackRate)}},{key:"_selectEngineByPriority",value:function(){var e,t=this,r=this._config.playback.streamPriority,n=this._config.playback.preferNative,a=this._sources,i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Je(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}(r);try{var s,o=function(){var r=e.value,i="string"==typeof r.engine?r.engine.toLowerCase():"",s="string"==typeof r.format?r.format.toLowerCase():"",o=Te.zv.getEngines().find((function(e){return e.id===i}));if(o){var l=a[s];if(l&&l.length>0){var u=l[0];if(o.canPlaySource(u,n[s],t._config.drm))return k._logger.debug("Source selected: ",l),t._loadEngine(o,u),t._engineType=i,t._streamType=s,{v:!0}}}};for(i.s();!(e=i.n()).done;)if(s=o())return s.v}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"_loadEngine",value:function(e,t){this._engine?this._engine.id===e.id?this._engine.restore(t,Qe(Qe({},this._config),{},{sources:this._sources})):(this._engine.destroy(),this._createEngine(e,t),this._appendEngineEl()):(this._createEngine(e,t),this._appendEngineEl())}},{key:"_createEngine",value:function(e,t){var r=e.createEngine(t,Qe(Qe({},this._config),{},{sources:this._sources}),this._playerId);this._engine=this._engineDecoratorManager?new De(r,this._engineDecoratorManager):r}},{key:"_attachMedia",value:function(){var e=this;if(this._engine){Object.keys(y.Rk).forEach((function(t){e._eventManager.listen(e._engine,y.Rk[t],(function(t){return e.dispatchEvent(t)}))})),this._eventManager.listen(this._engine,y.Rk.SEEKING,(function(){e.isLive()&&(e._isOnLiveEdge=!(!e.duration||!e.currentTime)&&e.currentTime>=e.duration-1&&!e.paused)})),this._eventManager.listen(this._engine,y.nQ.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TEXT_TRACK_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.VIDEO_TRACK_CHANGED,(function(t){return e._markActiveTrack(t.payload.selectedVideoTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.AUDIO_TRACK_CHANGED,(function(t){e.ready().then((function(){return e._playbackAttributesState.audioLanguage=t.payload.selectedAudioTrack.language})),e._markActiveTrack(t.payload.selectedAudioTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._engine,y.nQ.TRACKS_CHANGED,(function(t){return e._onTracksChanged(t)})),this._eventManager.listen(this._engine,y.nQ.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._engine,y.nQ.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TIMED_METADATA,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TIMED_METADATA_CHANGE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.PLAY_FAILED,(function(t){e._onPlayFailed(t),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.FPS_DROP,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.MEDIA_RECOVERED,(function(){return e._handleRecovered()})),this._eventManager.listen(this,y.Rk.PLAY,this._onPlay.bind(this)),this._eventManager.listen(this,y.Rk.PAUSE,this._onPause.bind(this)),this._eventManager.listen(this,y.Rk.PLAYING,this._onPlaying.bind(this)),this._eventManager.listen(this,y.Rk.ENDED,this._onEnded.bind(this)),this._eventManager.listen(this,y.nQ.MUTE_CHANGE,(function(t){var r;e._playbackAttributesState.muted=(null===(r=t.payload)||void 0===r?void 0:r.mute)||e.muted})),this._eventManager.listen(this,y.Rk.VOLUME_CHANGE,(function(){e._playbackAttributesState.volume=e.volume})),this._eventManager.listen(this,y.Rk.RATE_CHANGE,(function(){e._playbackAttributesState.rate=e.playbackRate})),this._eventManager.listen(this,y.nQ.ENTER_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this,y.nQ.EXIT_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this._resizeWatcher,y.nQ.RESIZE,(function(t){e._resetTextCuesAndReposition(),e.dispatchEvent(t)})),this._eventManager.listen(this._externalCaptionsHandler,y.nQ.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._externalCaptionsHandler,y.nQ.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._externalCaptionsHandler,y.Rk.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._externalThumbnailsHandler,y.Rk.ERROR,(function(t){return e.dispatchEvent(t)}));var t=h.is.getElementBySelector("#".concat(this.config.targetId));t&&this._eventManager.listen(t,"click",(function(){e._hasUserInteracted=!0,e.dispatchEvent(new m.v(y.nQ.USER_GESTURE))}),{capture:!0})}}},{key:"_handleRecovered",value:function(){this._stateManager.currentState.type===E.Y.PLAYING&&this.play()}},{key:"_onTextTrackChanged",value:function(e){var t=this;this.ready().then((function(){return t._playbackAttributesState.textLanguage=e.payload.selectedTextTrack.language})),this._markActiveTrack(e.payload.selectedTextTrack),this.dispatchEvent(e)}},{key:"_resetTextCuesAndReposition",value:function(){this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay([]);for(var e=0;e<this._activeTextCues.length;e++)this._activeTextCues[e].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)}},{key:"_handlePlaybackOptions",value:function(){if(this._config.playback=this._config.playback||{},"boolean"==typeof this._playbackAttributesState.muted?this.muted=this._playbackAttributesState.muted:"boolean"==typeof this._config.playback.muted&&(this.muted=this._config.playback.muted),"number"==typeof this._playbackAttributesState.volume?this.volume=this._playbackAttributesState.volume:"number"==typeof this._config.playback.volume&&(this.volume=this._config.playback.volume),"boolean"==typeof this._config.playback.playsinline&&(this.playsinline=this._config.playback.playsinline),"string"==typeof this._config.playback.crossOrigin&&(this.crossOrigin=this._config.playback.crossOrigin),Array.isArray(this._config.playback.playbackRates)){var e=this._config.playback.playbackRates.filter((function(e,t,r){return e>0&&e<=16&&r.indexOf(e)===t})).sort((function(e,t){return e-t}));e&&(this._playbackRates=e)}}},{key:"_handlePreload",value:function(){"auto"!==this._config.playback.preload||this._config.playback.autoplay||this.load()}},{key:"_autoPlay",value:function(){var e=this,t=this._config.playback.allowMutedAutoPlay;k.getCapabilities(this.engineType).then((function(o){o.autoplay?n():o.mutedAutoPlay?r()&&!e._fallbackToMutedAutoPlay?a():t?i():s():s()}));var r=function(){k._logger.debug("Checking muted value");var t="boolean"==typeof e._playbackAttributesState.muted&&e._playbackAttributesState.muted||"boolean"==typeof e._config.playback.muted&&e._config.playback.muted||e.muted;return k._logger.debug("Muted value is:",t),t},n=function(){k._logger.debug("Start autoplay"),e._fallbackToMutedAutoPlay&&(e._fallbackToMutedAutoPlay=!1,e.muted=!1),e.play()},a=function(){k._logger.debug("Start muted autoplay"),e.play()},i=function(){k._logger.debug("Fallback to muted autoplay"),e._fallbackToMutedAutoPlay=!0,e.muted=!0,e.dispatchEvent(new m.v(y.nQ.FALLBACK_TO_MUTED_AUTOPLAY)),e.play()},s=function(){k._logger.warn("Autoplay failed, pause player"),e._posterManager.show(),e.load(),e.dispatchEvent(new m.v(y.nQ.AUTOPLAY_FAILED))}}},{key:"_handleAutoPlay",value:function(){(this.isAudio()||this._config.playback.autoplay!==Oe.B.TRUE)&&this._posterManager.show(),this._config.playback.autoplay===Oe.B.TRUE&&this._autoPlay()}},{key:"_playAfterAsyncMiddleware",value:function(){var e=this;this._engine?this._play():this._eventManager.listenOnce(this,y.nQ.SOURCE_SELECTED,(function(){return e._play()}))}},{key:"_load",value:function(){var e=this;if(this._engine&&!this.src&&!this._loading){this._loading=!0;var t=this._sources.startTime;this._engine.load(t).then((function(r){e.isLive()&&(-1===t||Number(t)>=Number(e.duration))&&(e._isOnLiveEdge=!0),e._updateTracks(r.tracks),e.dispatchEvent(new m.v(y.nQ.TRACKS_CHANGED,{tracks:e._tracks})),e.sources.thumbnails&&e._externalThumbnailsHandler.load(e.sources.thumbnails)})).finally((function(){e._loading=!1,e._reset=!1}))}}},{key:"_handleDimensions",value:function(){var e=this.config.dimensions;h.c7.isObject(e)&&!h.c7.isEmptyObject(e)&&(this.dimensions=e)}},{key:"_play",value:function(){var e=this;this._shouldLoadAfterAttach&&(this._load(),this._shouldLoadAfterAttach=!1),this.ready().then((function(){e._shouldPlayerSeekToLiveEdge()&&e.seekToLiveEdge(),e._engine.play()}))}},{key:"_shouldPlayerSeekToLiveEdge",value:function(){if(this.isLive()){var e=!this.isDvr()||"number"==typeof this.currentTime&&this.currentTime<0;return this._firstPlay?!!this.src&&!this.isOnLiveEdge()&&void 0===this._sources.startTime:e}return!1}},{key:"_pause",value:function(){this._engine.pause()}},{key:"_setCurrentTime",value:function(e){if(this._engine&&h.Mr.isNumber(e)){var t=e;e<0&&(t=0);var r=this.isLive()?this._engine.duration:this._engine.duration-.1;t>r&&(t=r),this._engine.currentTime=t}}},{key:"_onPause",value:function(){this._isOnLiveEdge=!1}},{key:"_onPlay",value:function(){this._firstPlay&&(this._firstPlay=!1,this.dispatchEvent(new m.v(y.nQ.FIRST_PLAY)),this.hideBlackCover(),"number"==typeof this._playbackAttributesState.rate&&(this.playbackRate=this._playbackAttributesState.rate))}},{key:"_onPlaying",value:function(){this._firstPlaying||(this._firstPlaying=!0,this.isAudio()||this._posterManager.hide(),this.dispatchEvent(new m.v(y.nQ.FIRST_PLAYING))),this._engine&&this._pendingSelectedVideoTrack&&(this._engine.selectVideoTrack(this._pendingSelectedVideoTrack),this._pendingSelectedVideoTrack=void 0)}},{key:"_onPlayFailed",value:function(e){this._firstPlay&&this._config.playback.autoplay&&(this._posterManager.show(),this.dispatchEvent(new m.v(y.nQ.AUTOPLAY_FAILED,e.payload)))}},{key:"_onEnded",value:function(){this.paused||this._pause()}},{key:"_resetStateFlags",value:function(){this._loading=!1,this._firstPlay=!0,this._loadingMedia=!1,this._playbackStart=!1,this._firstPlaying=!1}},{key:"_calcRatio",value:function(e,t){if(void 0!==t.ratio&&(this._aspectRatio=t.ratio),this._aspectRatio){var r=this._aspectRatio.split(":").map((function(e){return Number(e)})),a=(0,n.Z)(r,2),i=a[0],s=a[1];if(t.width||!t.width&&!t.height){var o=s/i*e.clientWidth;e.style.height="".concat(o,"px")}else if(t.height&&!t.width){var l=i/s*e.clientHeight;e.style.width="".concat(l,"px")}}}},{key:"_onTracksChanged",value:function(e){this._updateTracks(e.payload.tracks),this.dispatchEvent(e)}},{key:"_updateTracks",value:function(e){k._logger.debug("Tracks changed",e),this._tracks=null==e?void 0:e.concat(this._externalCaptionsHandler.getExternalTracks(e)),this._applyABRRestriction(this._config),this._addTextTrackOffOption(),this._maybeSetTracksLabels(),this._setDefaultTracks()}},{key:"_getTracksByType",value:function(e){return this._tracks.reduce((function(t,r){return r instanceof e&&r.available&&t.push(r),t}),[])}},{key:"_getImageTracks",value:function(){return this._getTracksByType(Le.Z)}},{key:"_getTextTracks",value:function(){return this._getTracksByType(C.PZ)}},{key:"_getVideoTracks",value:function(){return this._getTracksByType(S.Z)}},{key:"_getAudioTracks",value:function(){return this._getTracksByType(P.Z)}},{key:"_markActiveTrack",value:function(e){var t;if(e instanceof S.Z?t=this._getVideoTracks():e instanceof P.Z?t=this._getAudioTracks():e instanceof C.PZ&&(t=this._getTextTracks()),t)for(var r=0;r<t.length;r++)t[r].active=e.index===t[r].index}},{key:"_onCueChange",value:function(e){k._logger.debug("Text cue changed",e.payload.cues);try{this._activeTextCues=e.payload.cues.filter((function(e,t,r){var n=r[t-1];return!n||!(e.startTime===n.startTime&&e.endTime===n.endTime&&e.text.trim()===n.text.trim())}))}catch(t){this._activeTextCues=e.payload.cues}this._updateCueDisplaySettings(),this._updateTextDisplay(this._activeTextCues),this.dispatchEvent(e)}},{key:"_updateCueDisplaySettings",value:function(){for(var e=this._activeTextCues,t=this._textDisplaySettings,r=0;r<e.length;r++){var n=e[r];for(var a in t)t[a]&&(n[a]=t[a])}}},{key:"_updateTextDisplay",value:function(e){this._config.text.useNativeTextTrack||this._config.text.useShakaTextTrackDisplay||function(e,t,r,n){if(!e||!t||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var a=e.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin="1.5%",r.appendChild(a),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var i=[],s=K.getSimpleBoxPosition(a),o=s.height<s.width?s.height:s.width,l={font:Math.round(.058*o*100)/100*1*n.implicitFontScale+"px "+n.fontFamily,color:x.Z.toRGBA(n.fontColor,n.fontOpacity),backgroundColor:x.Z.toRGBA(n.backgroundColor,n.backgroundOpacity),textShadow:n.getTextShadow()};!function(){for(var r,n,o=0;o<t.length;o++)n=t[o],r=new H(e,n,l),a.appendChild(r.div),W(0,r,s,i),n.displayState=r.div,i.push(K.getSimpleBoxPosition(r))}()}else for(var u=0;u<t.length;u++)a.appendChild(t[u].displayState)}(window,e,this._textDisplayEl,this._textStyle)}},{key:"_addTextTrackOffOption",value:function(){var e=this._getTextTracks();e&&e.length&&this._tracks.push(new C.PZ({active:!1,kind:C.PZ.KIND.SUBTITLES,label:"Off",language:nt}))}},{key:"_setDefaultTracks",value:function(){var e=this.getActiveTracks(),t=this._getTextTracks().find((function(e){return e.default})),r=this.config.playback,n=this._getTextTracks().find((function(e){return C.PZ.langComparer(nt,e.language)})),a=this._getLanguage(this._getTextTracks(),r.textLanguage,t),i=!this._playbackAttributesState.textLanguage||this.config.disableUserCache?a:this._playbackAttributesState.textLanguage,s=this._playbackAttributesState.audioLanguage||this._getLanguage(this._getAudioTracks(),r.audioLanguage,e.audio);r.captionsDisplay?i===r.textLanguage?this._setDefaultTrack(this._getTextTracks(),i,n,r.additionalTextLanguage):this._setDefaultTrack(this._getTextTracks(),i,n):(this._playbackAttributesState.textLanguage=a,this._setDefaultTrack(this._getTextTracks(),nt,n)),s===r.audioLanguage?this._setDefaultTrack(this._getAudioTracks(),s,e.audio,r.additionalAudioLanguage):this._setDefaultTrack(this._getAudioTracks(),s,e.audio),this._setDefaultVideoTrack()}},{key:"_getLanguage",value:function(e,t,r){var n=t;if(n===rt){var a=e.find((function(e){return A.Z.langComparer(v.language,e.language)}));a?n=a.language:r&&r.language!==nt?n=r.language:e&&e.length>0&&(n=e[0].language)}return n}},{key:"_setDefaultTrack",value:function(e,t,r,n){var a=this,i=function(e){a.selectTrack(e),a._markActiveTrack(e)},s=e.find((function(e){return A.Z.langComparer(t,e.language,n,!0)}));if(s)i(s);else{var o=e.find((function(e){return A.Z.langComparer(t,e.language,n,!1)}));o?i(o):r&&!r.active&&this.selectTrack(r)}}},{key:"_setDefaultVideoTrack",value:function(){var e=this,t=this._getVideoTracks().sort((function(e,t){return t.bandwidth-e.bandwidth})),r=t.find((function(t){var r;return t.label&&t.label===(null===(r=e._playbackAttributesState.videoTrack)||void 0===r?void 0:r.label)}));r||(r=t.find((function(t){var r;return t.height&&t.height===(null===(r=e._playbackAttributesState.videoTrack)||void 0===r?void 0:r.height)}))),r&&this.selectTrack(r)}},{key:"_maybeSetTracksLabels",value:function(){var e=this._config.customLabels;if(e)for(var t in e){if(!Object.prototype.hasOwnProperty.call(e,t))return;switch(t){case"qualities":this._setTracksCustomLabels(this._getVideoTracks(),e[t]);break;case"audio":this._setTracksCustomLabels(this._getAudioTracks(),e[t]);break;case"captions":this._setTracksCustomLabels(this._getTextTracks(),e[t])}}}},{key:"_setTracksCustomLabels",value:function(e,t){e.forEach((function(e){var r=t(h.c7.copyDeep(e));r&&(e.label=r)}))}},{key:"Event",get:function(){return y.tw}},{key:"TextStyle",get:function(){return x.Z}},{key:"State",get:function(){return E.Y}},{key:"Track",get:function(){return X.V}},{key:"LogLevelType",get:function(){return _.hX}},{key:"LogLevel",get:function(){return _.in}},{key:"AbrMode",get:function(){return ee.n}},{key:"MediaType",get:function(){return J.D}},{key:"StreamType",get:function(){return Z.j}},{key:"EngineType",get:function(){return Q.r}},{key:"CorsType",get:function(){return te.X}},{key:"AdBreakType",get:function(){return Ce.S}},{key:"AdTagType",get:function(){return xe.J}},{key:"Error",get:function(){return b.Z}}],[{key:"runCapabilities",value:function(){k._logger.debug("Running player capabilities"),Te.zv.getEngines().forEach((function(e){return e.runCapabilities()}))}},{key:"getCapabilities",value:function(e){k._logger.debug("Get player capabilities",e);var t=[];return Te.zv.getEngines().forEach((function(e){return t.push(e.getCapabilities())})),Promise.all(t).then((function(t){var r={};return t.forEach((function(e){return Object.assign(r,e)})),e?r[e]:r}))}},{key:"setCapabilities",value:function(e,t){k._logger.debug("Set player capabilities",e,t);var r=Te.zv.getEngines().find((function(t){return t.id===e}));r&&r.setCapabilities(t)}},{key:"_defaultConfig",get:function(){return h.c7.copyDeep(oe)}}]),k}(g.H);(0,c.Z)(at,"_logger",(0,_.ZP)("Player"))},9769:function(e,t,r){"use strict";r.d(t,{Y:function(){return n}});var n={IDLE:"idle",LOADING:"loading",PLAYING:"playing",PAUSED:"paused",BUFFERING:"buffering"}},4919:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(t){(0,n.Z)(this,e),this.type=t,this._duration=0,this._timestamp=Date.now()/1e3}return(0,a.Z)(e,[{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e-this._timestamp}}]),e}()},5590:function(e,t,r){"use strict";r.d(t,{F:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(t){(0,n.Z)(this,e);var r=t.url,a=t.width,i=t.height,s=t.x,o=t.y;this._url=r,this._width=a,this._height=i,this._x=s,this._y=o}return(0,a.Z)(e,[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}]),e}()},6820:function(e,t,r){"use strict";r.d(t,{n:function(){return n}});var n={MANUAL:"manual",AUTO:"auto"}},7812:function(e,t,r){"use strict";var n=r(3144),a=r(5671),i=r(9340),s=r(2963),o=r(1120),l=function(e){(0,i.Z)(u,e);var t,r,l=(t=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,o.Z)(t);if(r){var a=(0,o.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,s.Z)(this,e)});function u(){return(0,a.Z)(this,u),l.apply(this,arguments)}return(0,n.Z)(u)}(r(8413).Z);t.Z=l},2983:function(e,t,r){"use strict";var n=r(5671),a=r(3144),i=r(9340),s=r(2963),o=r(1120),l=function(e){(0,i.Z)(u,e);var t,r,l=(t=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,o.Z)(t);if(r){var a=(0,o.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,s.Z)(this,e)});function u(e){var t;(0,n.Z)(this,u),t=l.call(this,e);var r=e.url,a=e.width,i=e.height,s=e.duration,o=e.rows,c=e.cols,d=e.customData;return t._url=r,t._width=a,t._height=i,t._duration=s,t._customData=d,t._rows=o||1,t._cols=c||1,t}return(0,a.Z)(u,[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"duration",get:function(){return this._duration}},{key:"rows",get:function(){return this._rows}},{key:"cols",get:function(){return this._cols}},{key:"customData",get:function(){return this._customData}},{key:"sliceWidth",get:function(){return this._width/this._cols}},{key:"sliceHeight",get:function(){return this._height/this._rows}}]),u}(r(8413).Z);t.Z=l},6234:function(e,t,r){"use strict";var n=r(5671),a=r(3144),i=r(4942),s=function(){function e(){(0,n.Z)(this,e),(0,i.Z)(this,"_fontSizeIndex",2),(0,i.Z)(this,"fontFamily",e.FontFamily.SANS_SERIF),(0,i.Z)(this,"fontColor",e.StandardColors.WHITE),(0,i.Z)(this,"fontOpacity",e.StandardOpacities.OPAQUE),(0,i.Z)(this,"backgroundColor",e.StandardColors.BLACK),(0,i.Z)(this,"backgroundOpacity",e.StandardOpacities.OPAQUE),(0,i.Z)(this,"fontEdge",e.EdgeStyles.NONE)}return(0,a.Z)(e,[{key:"fontSize",get:function(){return e.FontSizes[this._fontSizeIndex].label},set:function(t){var r=e.FontSizes.findIndex((function(e){return e.label===t}));-1!==r&&(this._fontSizeIndex=r)}},{key:"fontScale",get:function(){return e.FontSizes[this._fontSizeIndex].value},set:function(t){var r=e.FontSizes.findIndex((function(e){return e.value===t}));-1!==r&&(this._fontSizeIndex=r)}},{key:"getTextShadow",value:function(){for(var t=[],r=0;r<this.fontEdge.length;r++){var n=this.fontEdge[r].slice(0,3),a=this.fontEdge[r].slice(3,6);t.push(e.toRGBA(n,this.fontOpacity)+" "+a.join("px ")+"px")}return t.join(",")}},{key:"toCSS",value:function(){var t=[];return t.push("font-family: "+this.fontFamily),t.push("color: "+e.toRGBA(this.fontColor,this.fontOpacity)),t.push("background-color: "+e.toRGBA(this.backgroundColor,this.backgroundOpacity)),t.push("text-shadow: "+this.getTextShadow()),t.join("!important; ")}},{key:"clone",value:function(){return e.fromJson(e.toJson(this))}},{key:"isEqual",value:function(t){return JSON.stringify(e.toJson(this))===JSON.stringify(e.toJson(t))}},{key:"implicitFontScale",get:function(){return.25*e.FontSizes[this._fontSizeIndex].value+1}}],[{key:"toRGBA",value:function(e,t){return"rgba("+e.concat(t).join(",")+")"}},{key:"fromJson",value:function(t){var r=function(e,t){return null!=e?e:t},n=new e;return n.fontEdge=r(t.fontEdge,n.fontEdge),n.fontSize=r(t.fontSize,n.fontSize),n.fontScale=r(t.fontScale,n.fontScale),n.fontColor=r(t.fontColor,n.fontColor),n.fontOpacity=r(t.fontOpacity,n.fontOpacity),n.backgroundColor=r(t.backgroundColor,n.backgroundColor),n.backgroundOpacity=r(t.backgroundOpacity,n.backgroundOpacity),n.fontFamily=r(t.fontFamily,n.fontFamily),n}},{key:"toJson",value:function(e){return{fontEdge:e.fontEdge,fontSize:e.fontSize,fontScale:e.fontScale,fontColor:e.fontColor,fontOpacity:e.fontOpacity,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity,fontFamily:e.fontFamily}}}]),e}();(0,i.Z)(s,"FontFamily",{ARIAL:"Arial",HELVETICA:"Helvetica",VERDANA:"Verdana",SANS_SERIF:"sans-serif"}),(0,i.Z)(s,"StandardColors",{WHITE:[255,255,255],BLACK:[0,0,0],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]}),(0,i.Z)(s,"StandardOpacities",{OPAQUE:1,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0}),(0,i.Z)(s,"EdgeStyles",{NONE:[],RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]}),(0,i.Z)(s,"FontSizes",[{value:-2,label:"50%"},{value:-1,label:"75%"},{value:0,label:"100%"},{value:2,label:"200%"},{value:3,label:"300%"},{value:4,label:"400%"}]),t.Z=s},6462:function(e,t,r){"use strict";r.d(t,{PZ:function(){return p},ZP:function(){return p},z6:function(){return h}});var n=r(5671),a=r(3144),i=r(9340),s=r(2963),o=r(1120),l=r(4942),u=r(8413),c=r(962);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p=function(e){(0,i.Z)(u,e);var t,r,l=(t=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,o.Z)(t);if(r){var a=(0,o.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,s.Z)(this,e)});function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.Z)(this,u),(e=l.call(this,t))._label=e.label||e.language,e._kind=t.kind,e._external=t.external,e._index=u._generateIndex(),e._default=t.default||!1,e}return(0,a.Z)(u,[{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e}},{key:"kind",get:function(){return this._kind}},{key:"external",get:function(){return this._external}},{key:"default",get:function(){return this._default}}],[{key:"_generateIndex",value:function(){return u._tracksCount++}},{key:"reset",value:function(){u._tracksCount=0}},{key:"isMetaDataTrack",value:function(e){return e&&e.kind===u.KIND.METADATA}},{key:"isNativeTextTrack",value:function(e){return e&&[u.KIND.SUBTITLES,u.KIND.CAPTIONS].includes(e.kind)}},{key:"isExternalTrack",value:function(e){return e&&[e.language,e.label].includes(u.EXTERNAL_TRACK_ID)}}]),u}(u.Z);function h(e){var t,r=[],n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(VTTCue&&a instanceof VTTCue||window.DataCue&&a instanceof window.DataCue)r.push(a);else if(TextTrackCue&&a instanceof TextTrackCue)try{r.push(new VTTCue(a.startTime,a.endTime,a.text))}catch(e){new c.Z(c.Z.Severity.RECOVERABLE,c.Z.Category.TEXT,c.Z.Code.UNABLE_TO_CREATE_TEXT_CUE,e)}}}catch(e){n.e(e)}finally{n.f()}return r}(0,l.Z)(p,"MODE",{DISABLED:"disabled",SHOWING:"showing",HIDDEN:"hidden"}),(0,l.Z)(p,"KIND",{METADATA:"metadata",SUBTITLES:"subtitles",CAPTIONS:"captions"}),(0,l.Z)(p,"EXTERNAL_TRACK_ID","playkit-external-track"),(0,l.Z)(p,"_tracksCount",0)},375:function(e,t,r){"use strict";r.d(t,{D:function(){return i},PC:function(){return s},cP:function(){return o}});var n=r(3144),a=r(5671),i=(0,n.Z)((function e(t,r,n,i,s){(0,a.Z)(this,e),this.startTime=t,this.endTime=r,this.id=n,this.type=i,this.metadata=s}));function s(e){try{var t=e.startTime,r=e.endTime,n=e.id,a=e.type,i=e.metadata,s=new VTTCue(t,r,""),o={key:a,data:i};return s.id=n,s.value=o,s}catch(e){return null}}function o(e){if(e){var t=e.startTime,r=e.endTime,n=e.id;if(l(e)){var a=l(e),s=a.type,o=a.metadata;return new i(t,r,n,s,o)}}return null}function l(e){if(e&&"value"in e&&e.value){var t=e.type,r=e.value,n=e.track,a=r.key,s=r.data,o="org.id3"===t||"id3"===(n&&n.label),l=Object.values(i.TYPE).find((function(e){return e===a}));return l||(l=o?i.TYPE.ID3:i.TYPE.CUSTOM),{type:l,metadata:o||!s?r:s}}return null}i.TYPE={ID3:"id3",EMSG:"emsg",CUE_POINT:"cuepoint",CUSTOM:"custom"}},5856:function(e,t,r){"use strict";r.d(t,{V:function(){return n}});var n={VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"}},8413:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.Z)(this,e),this._id=t.id,this._active=t.active,this._label=t.label,this._language=t.language,this._index=t.index,this._available="boolean"!=typeof t.available||t.available,this.clone=e.clone.bind(null,this)}return(0,a.Z)(e,[{key:"id",get:function(){return this._id}},{key:"active",get:function(){return this._active},set:function(e){this._active=e}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"language",get:function(){return this._language}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"available",get:function(){return this._available},set:function(e){this._available=e}}],[{key:"langComparer",value:function(e,t,r,n){try{return e=e.toLowerCase(),t=t.toLowerCase(),r&&(r=r.toLowerCase()),n?e===t||r===t:!!e&&(e.startsWith(t)||t.startsWith(e))}catch(e){return!1}}},{key:"clone",value:function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}}]),e}()},4877:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(5671),a=r(3144),i=r(9340),s=r(2963),o=r(1120),l=function(e){(0,i.Z)(u,e);var t,r,l=(t=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,o.Z)(t);if(r){var a=(0,o.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,s.Z)(this,e)});function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.Z)(this,u),(e=l.call(this,t))._bandwidth=t.bandwidth,e._width=t.width,e._height=t.height,e._label=t.label?t.label:e._height?e._height+"p":void 0,e}return(0,a.Z)(u,[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),u}(r(8413).Z)},9150:function(e,t,r){"use strict";r.r(t),r.d(t,{TrackType:function(){return n.V}});var n=r(5856),a=r(5901),i={};for(var s in a)["default","TrackType"].indexOf(s)<0&&(i[s]=function(e){return a[e]}.bind(0,s));r.d(t,i)},2069:function(e,t,r){"use strict";var n,a=r(2238),i=r.n(a),s=/^.*(web0s).*(smarttv).*$/i,o=/^.*(smart-tv).*(tizen).*$/i,l=/^.*(vidaa).*(smarttv).*$/i,u=[[o],[[i().BROWSER.NAME,"SAMSUNG_TV_BROWSER"],[i().BROWSER.MAJOR,""],[i().BROWSER.VERSION,""]]],c=[[s],[i().OS.NAME],[l],[i().OS.NAME]],d=[[s],[[i().DEVICE.VENDOR,"LG"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[o],[[i().DEVICE.VENDOR,"SAMSUNG"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[l],[[i().DEVICE.VENDOR,"HISENSE"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[/^.*(smart-tv|smarttv).*$/i],[[i().DEVICE.TYPE,i().DEVICE.SMARTTV]]],p=[[/(edg)\/((\d+)?[\w.]+)/i],[[i().BROWSER.NAME,"Edge"],i().BROWSER.VERSION,i().BROWSER.MAJOR]],h=[].concat(p,u),f=new(i())(void 0,{browser:h,device:d,os:c}).getResult();f.isConsole=f.device.type===i().DEVICE.CONSOLE,f.isSmartTV=f.device.type===i().DEVICE.SMARTTV,f.isMobile=f.device.type===i().DEVICE.MOBILE,f.isTablet=f.device.type===i().DEVICE.TABLET,f.isWearable=f.device.type===i().DEVICE.WEARABLE,f.isEmbedded=f.device.type===i().DEVICE.EMBEDDED,f.isIPadOS="Mac OS"===f.os.name&&"ontouchend"in document,f.isSafari=Boolean(null===(n=f.browser.name)||void 0===n?void 0:n.includes("Safari")),f.isIOS="iOS"===f.os.name,f.isMacOS="Mac OS"===f.os.name,t.Z=f},9021:function(e,t,r){"use strict";r.r(t),r.d(t,{Dom:function(){return n.is},Generator:function(){return n.RO},Http:function(){return n.eV},MultiMap:function(){return m.k},Number:function(){return n.Mr},Object:function(){return n.c7},ResizeWatcher:function(){return h},String:function(){return n.Ld},VERSION:function(){return n.q4},binarySearch:function(){return g}});var n=r(4821),a=r(4942),i=r(5671),s=r(3144),o=r(9340),l=r(2963),u=r(1120),c=r(8987),d=r(8171),p=r(2114),h=function(e){(0,o.Z)(a,e);var t,r,n=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function a(){return(0,i.Z)(this,a),n.call(this)}return(0,s.Z)(a,[{key:"destroy",value:function(){this._observer&&this._observer.disconnect(),this._observer=void 0,this._el=void 0}},{key:"init",value:function(e){this._observer||(this._el=e,window.ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))}},{key:"_createNativeObserver",value:function(){var e=this;this._observer=new ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))}},{key:"_createIframeObserver",value:function(){this._observer=new f(this._triggerResize.bind(this))}},{key:"_triggerResize",value:function(){this.dispatchEvent(new c.v(p.nQ.RESIZE))}}]),a}(d.H),f=function(){function e(t){(0,i.Z)(this,e),(0,a.Z)(this,"_observersStore",{}),this._onChangeCallback=t}return(0,s.Z)(e,[{key:"observe",value:function(e){var t=this,r=this._createIframe(),n=e.getAttribute("id");this._observersStore[n]=r,e.appendChild(r),r.contentWindow.onresize=function(){return t._onChangeCallback()}}},{key:"disconnect",value:function(){for(var e in this._observersStore){var t=document.getElementById(e),r=this._observersStore[e];r.onresize=null,t&&(t.removeChild(r),delete this._observersStore[t.getAttribute("id")])}}},{key:"_createIframe",value:function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e}}]),e}(),m=r(9654);function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 1};if(0===e.length||1===e.length&&0!==t(e[0]))return null;var r=Math.floor(e.length/2);return 0===t(e[r])?e[r]:t(e[r])>0?g(e.slice(0,r),t):g(e.slice(r+1),t)}},4358:function(e,t,r){"use strict";r.d(t,{Ub:function(){return c},ZO:function(){return u},hX:function(){return s},hs:function(){return o},in:function(){return i},jl:function(){return l}});var n=r(5901),a=r.n(n),i={DEBUG:a().DEBUG,INFO:a().INFO,TIME:a().TIME,WARN:a().WARN,ERROR:a().ERROR,OFF:a().OFF,TRACE:a().TRACE},s={};function o(e){a().setHandler((function(t,r){return e(t,r)}))}function l(e){return e?a().get(e):a()}function u(e){return l(e).getLevel()}function c(e,t){l(t).setLevel(e)}Object.keys(i).forEach((function(e){s[e]=e})),a().useDefaults({defaultLevel:a().ERROR}),t.ZP=l},9654:function(e,t,r){"use strict";r.d(t,{k:function(){return s}});var n=r(5671),a=r(3144);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s=function(){function e(){(0,n.Z)(this,e),this._map=new Map}return(0,a.Z)(e,[{key:"push",value:function(e,t){if(this._map.has(e)){var r=this._map.get(e);Array.isArray(r)&&(r.push(t),this._map.set(e,r))}else this._map.set(e,[t])}},{key:"set",value:function(e,t){this._map.set(e,t)}},{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){var t=this._map.get(e);return t?t.slice():[]}},{key:"getAll",value:function(){var e,t=[],r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw s}}}}(this._map.values());try{for(r.s();!(e=r.n()).done;){var n=e.value;t=t.concat(n)}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"remove",value:function(e,t){if(this._map.has(e)){var r=this._map.get(e);if(Array.isArray(r)){for(var n=0;n<r.length;++n)r[n]===t&&(r.splice(n,1),--n);0===r.length&&this._map.delete(e)}}}},{key:"keys",value:function(){return this._map.keys()}},{key:"clear",value:function(){this._map.clear()}}]),e}()},1177:function(e,t,r){"use strict";function n(e,t){var r=function(e,t){var r=1/0,n=function(e,t,n){return e>=(t||0)&&e<=(n||r)},a=t.maxHeight,i=t.minHeight,s=t.maxWidth,o=t.minWidth;if(0!==i||0!==o||a!==r||s!==r)return e.filter((function(e){return n(e.height,i,a)})).filter((function(e){return n(e.width,o,s)}));var l=t.maxBitrate,u=t.minBitrate;return 0!==u||l!==r?e.filter((function(e){return n(e.bandwidth,u,l)})):e}(e,t);return r.length?r:[]}r.d(t,{u:function(){return n}})},4821:function(e,t,r){"use strict";r.d(t,{is:function(){return g},RO:function(){return m},eV:function(){return y},Mr:function(){return p},c7:function(){return f},Ld:function(){return h},q4:function(){return v}});var n=r(3878),a=r(9199),i=r(181),s=r(5267),o=r(4942),l=r(1002),u=r(962),c="responseFormat=jsonp&callback=";function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p={isNumber:function(e){return Number(e)===e},isInt:function(e){return this.isNumber(e)&&e%1==0},isFloat:function(e){return this.isNumber(e)&&e%1!=0}},h={capitlize:function(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)},endsWith:function(e,t){return"string"==typeof e&&"string"==typeof t&&-1!==e.indexOf(t,e.length-t.length)}},f={merge:function(e){var t,r={},n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;Object.assign(r,a)}}catch(e){n.e(e)}finally{n.f()}return r},isObject:function(e){return e&&"object"===(0,l.Z)(e)&&!Array.isArray(e)},isClassInstance:function(e){return e&&e.constructor&&e.constructor.name&&"Object"!==e.constructor.name},mergeDeep:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!r.length)return e;var a=r.shift();if(this.isObject(e)&&this.isObject(a))for(var i in a)this.isObject(a[i])&&!this.isClassInstance(a[i])?(e[i]||Object.assign(e,(0,o.Z)({},i,{})),this.mergeDeep(e[i],a[i])):Object.assign(e,(0,o.Z)({},i,a[i]));return this.mergeDeep.apply(this,[e].concat(r))},copyDeep:function(e){var t,r=this;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach((function(e,n){("object"===(0,l.Z)(e)||Array.isArray(e)&&e.length>0)&&(t[n]=r.copyDeep(e))})):null!==e&&"object"===(0,l.Z)(e)?e.clone&&"function"==typeof e.clone?t=e.clone():(t=Object.assign({__proto__:e.__proto__},e),Object.keys(t).forEach((function(e){("object"===(0,l.Z)(t[e])||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=r.copyDeep(t[e]))}))):t=e,t},isEmptyObject:function(e){for(var t in e)if(Object.hasOwnProperty.call(e,t))return!1;return!0},getPropertyPath:function(e,t){return t.split(".").reduce((function(e,t){return null==e?e:e[t]}),e)},hasPropertyPath:function(e,t){if(!t)return!1;for(var r=t.split("."),n=0;n<r.length;n++){var a=r[n];if(!e||!Object.hasOwnProperty.call(e,a))return!1;e=e[a]}return!0},createPropertyPath:function(e,t){for(var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=t.split("."),u=e;l.length>1;){var c=(r=l,(0,n.Z)(r)||(0,a.Z)(r)||(0,i.Z)(r)||(0,s.Z)()),d=c[0];l=c.slice(1),void 0===u[d]&&(u[d]={}),u=u[d]}return u[l[0]]=o,e},deletePropertyPath:function(e,t){if(e&&t){for(var r=t.split("."),n=0;n<r.length-1;n++)if(void 0===(e=e[r[n]]))return;delete e[r.pop()]}},defer:function(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.resolve=e,r.reject=t,r},bind:function(e,t){return function(){t.apply(e,arguments)}}},m={uniqueId:function(e){var t=2+(!e||e<0?0:e-2);return"_"+Math.random().toString(36).slice(2,2+t)},guid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},g={addClassName:function(e,t){e&&(e.classList?e.classList.add(t):g.hasClassName(e,t)||(e.className+=t))},removeClassName:function(e,t){e&&(e.classList?e.classList.remove(t):g.hasClassName(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,"")))},hasClassName:function(e,t){return e&&e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},setAttribute:function(e,t,r){e.setAttribute(t,r)},removeAttribute:function(e,t){e.removeAttribute(t)},setStyle:function(e,t,r){void 0!==e.style.getPropertyValue(t)&&e.style.setProperty(t,r)},appendChild:function(e,t){e&&t&&e.appendChild&&e.appendChild(t)},removeChild:function(e,t){e&&t&&e.removeChild&&e.removeChild(t)},prependTo:function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},getElementById:function(e){return document.getElementById(e)},getElementsByTagName:function(e){return document.getElementsByTagName(e)},createElement:function(e){return document.createElement(e)},loadStyleSheetAsync:function(e){var t=this;return new Promise((function(r,n){var a=!1,i=t.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,i.async=!0,i.onload=i.onreadystatechange=function(){a||this.readyState&&"complete"!==this.readyState||(a=!0,r(this))},i.onerror=i.onabort=n,g.appendChild(document.head,i)}))},loadScriptAsync:function(e){var t=this;return new Promise((function(r,n){var a=!1,i=document.getElementsByTagName("script")[0],s=t.createElement("script");s.type="text/javascript",s.src=e,s.async=!0,s.onload=s.onreadystatechange=function(){a||this.readyState&&"complete"!==this.readyState||(a=!0,r(this))},s.onerror=s.onabort=n,i&&i.parentNode&&i.parentNode.insertBefore(s,i)}))},getElementBySelector:function(e){try{return document.querySelector(e)}catch(e){return}},insertBefore:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{return e.insertBefore(t,r)}catch(e){return null}}},y={protocol:/^(https?:)/i.test(document.location.protocol)?document.location.protocol:"https:",execute:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,s=new XMLHttpRequest;return new Promise((function(o,l){s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status)try{var e=JSON.parse(s.responseText);o(e)}catch(e){o(s.responseText)}else l(s.responseText)},s.open(r,e),n&&n.forEach((function(e,t){s.setRequestHeader(t,e)})),a&&(s.timeout=a),i&&(s.ontimeout=function(e){i(),l(e)}),s.send(t)}))},jsonp:function(e,t,r){var n,a=(r=r||{}).timeout?r.timeout:5e3,i=document.createElement("script"),s="jsonpcallback"+Math.round(Date.now()+1000001*Math.random()),o=e,l=function(){i&&i.parentNode&&i.parentNode.removeChild(i),window[s]=function(){},n&&clearTimeout(n)};return new Promise((function(r,d){a&&(n=setTimeout((function(){l(),d(new u.Z(u.Z.Severity.CRITICAL,u.Z.Category.NETWORK,u.Z.Code.TIMEOUT,e))}),a)),window[s]=function(n){var a=t(n,e);l(),r(a)},o.match(/\?/)?o+="&"+c+s:o+="?"+c+s,i.type="text/javascript",i.src=o,document.getElementsByTagName("head")[0].appendChild(i)}))},convertHeadersToDictionary:function(e){var t={};try{e.trim().split(/[\r\n]+/).forEach((function(e){var r=e.split(": "),n=r.shift().toLowerCase(),a=r.join(": ");t[n]=a}))}catch(e){}return t}},v={compare:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=(r=f.merge([{lexicographical:!1,zeroExtend:!0},r])).lexicographical,a=r.zeroExtend,i=(e||"0").split("."),s=(t||"0").split("."),o=function(e){return(n?/^\d+[A-Za-z]*$/:/^\d+[A-Za-z]?$/).test(e)},l=function(e){return e.map((function(e){var t=/[A-Za-z]/.exec(e);return Number(t?e.replace(t[0],"."+e.charCodeAt(t.index)):e)}))};if(!i.every(o)||!s.every(o))return NaN;if(a){for(;i.length<s.length;)i.push("0");for(;s.length<i.length;)s.push("0")}n||(i=l(i),s=l(s));for(var u=0;u<i.length;++u){if(s.length===u)return 1;if(i[u]!==s[u])return i[u]>s[u]?1:-1}return i.length!==s.length?-1:0}}},7774:function(e,t,r){"use strict";var n=r(7537),a=r.n(n),i=r(3645),s=r.n(i)()(a());s.push([e.id,".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: var(--playkit-player-background-color);\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n","",{version:3,sources:["webpack://./src/assets/style.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,WAAW;EACX,aAAa;EACb,2BAA2B;EAC3B,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,wCAAwC;AAC1C;;AAEA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,MAAM;EACN,OAAO;EACP,mBAAmB;AACrB;;AAEA;;;;EAIE,aAAa;EACb,wBAAwB;AAC1B;;AAEA;EACE,kBAAkB;EAClB,cAAc;EACd,MAAM;EACN,SAAS;EACT,OAAO;EACP,QAAQ;EACR,wBAAwB;EACxB,kCAAkC;EAClC,4BAA4B;EAC5B,wDAAwD;EACxD,oBAAoB;AACtB;;AAEA;EACE,kBAAkB;EAClB,MAAM;EACN,SAAS;EACT,QAAQ;EACR,OAAO;EACP,oBAAoB;EACpB,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,SAAS;EACT,aAAa;AACf;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,0BAA0B;EAC1B,iBAAiB;EACjB,kBAAkB;EAClB,0FAA0F;EAC1F,0BAA0B;AAC5B",sourcesContent:[".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: var(--playkit-player-background-color);\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n"],sourceRoot:""}]),t.Z=s},3645:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(s[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);n&&s[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},7537:function(e){"use strict";e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},5901:function(e,t,r){var n,a;!function(i){"use strict";var s,o={VERSION:"1.6.1"},l={},u=function(e,t){return function(){return t.apply(e,arguments)}},c=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},d=function(e,t){return{value:e,name:t}};o.TRACE=d(1,"TRACE"),o.DEBUG=d(2,"DEBUG"),o.INFO=d(3,"INFO"),o.TIME=d(4,"TIME"),o.WARN=d(5,"WARN"),o.ERROR=d(8,"ERROR"),o.OFF=d(99,"OFF");var p=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};p.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(o.TRACE,arguments)},debug:function(){this.invoke(o.DEBUG,arguments)},info:function(){this.invoke(o.INFO,arguments)},warn:function(){this.invoke(o.WARN,arguments)},error:function(){this.invoke(o.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(o.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(o.TIME,[e,"end"])},invoke:function(e,t){s&&this.enabledFor(e)&&s(t,c({level:e},this.context))}};var h,f=new p({filterLevel:o.OFF});(h=o).enabledFor=u(f,f.enabledFor),h.trace=u(f,f.trace),h.debug=u(f,f.debug),h.time=u(f,f.time),h.timeEnd=u(f,f.timeEnd),h.info=u(f,f.info),h.warn=u(f,f.warn),h.error=u(f,f.error),h.log=h.info,o.setHandler=function(e){s=e},o.setLevel=function(e){for(var t in f.setLevel(e),l)l.hasOwnProperty(t)&&l[t].setLevel(e)},o.getLevel=function(){return f.getLevel()},o.get=function(e){return l[e]||(l[e]=new p(c({name:e},f.context)))},o.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(n,a){n=Array.prototype.slice.call(n);var i,s=console.log;a.level===o.TIME?(i=(a.name?"["+a.name+"] ":"")+n[0],"start"===n[1]?console.time?console.time(i):t[i]=(new Date).getTime():console.timeEnd?console.timeEnd(i):r(s,[i+": "+((new Date).getTime()-t[i])+"ms"])):(a.level===o.WARN&&console.warn?s=console.warn:a.level===o.ERROR&&console.error?s=console.error:a.level===o.INFO&&console.info?s=console.info:a.level===o.DEBUG&&console.debug?s=console.debug:a.level===o.TRACE&&console.trace&&(s=console.trace),e.formatter(n,a),r(s,n))}},o.useDefaults=function(e){o.setLevel(e&&e.defaultLevel||o.DEBUG),o.setHandler(o.createDefaultHandler(e))},o.setDefaults=o.useDefaults,void 0===(a="function"==typeof(n=o)?n.call(t,r,t,e):n)||(e.exports=a)}()},3379:function(e){"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},s=[],o=0;o<e.length;o++){var l=e[o],u=n.base?l[0]+n.base:l[0],c=i[u]||0,d="".concat(u," ").concat(c);i[u]=c+1;var p=r(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var f=a(h,n);n.byIndex=o,t.splice(o,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function a(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,a){var i=n(e=e||[],a=a||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var o=r(i[s]);t[o].references--}for(var l=n(e,a),u=0;u<i.length;u++){var c=r(i[u]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=l}}},569:function(e){"use strict";var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},9216:function(e){"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:function(e,t,r){"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},7795:function(e){"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,a&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:function(e){"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},2238:function(e,t,r){var n;!function(a,i){"use strict";var s="function",o="undefined",l="object",u="string",c="major",d="model",p="name",h="type",f="vendor",m="version",g="architecture",y="console",v="mobile",_="tablet",k="smarttv",E="wearable",b="embedded",T="Amazon",A="Apple",S="ASUS",P="BlackBerry",C="Browser",x="Chrome",I="Firefox",w="Google",R="Huawei",M="LG",D="Microsoft",O="Motorola",L="Opera",N="Samsung",U="Sharp",j="Sony",B="Xiaomi",F="Zebra",V="Facebook",G="Chromium OS",H="Mac OS",K=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},W=function(e,t){return typeof e===u&&-1!==$(t).indexOf($(e))},$=function(e){return e.toLowerCase()},z=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,500)},q=function(e,t){for(var r,n,a,o,u,c,d=0;d<t.length&&!u;){var p=t[d],h=t[d+1];for(r=n=0;r<p.length&&!u&&p[r];)if(u=p[r++].exec(e))for(a=0;a<h.length;a++)c=u[++n],typeof(o=h[a])===l&&o.length>0?2===o.length?typeof o[1]==s?this[o[0]]=o[1].call(this,c):this[o[0]]=o[1]:3===o.length?typeof o[1]!==s||o[1].exec&&o[1].test?this[o[0]]=c?c.replace(o[1],o[2]):i:this[o[0]]=c?o[1].call(this,c,o[2]):i:4===o.length&&(this[o[0]]=c?o[3].call(this,c.replace(o[1],o[2])):i):this[o]=c||i;d+=2}},Y=function(e,t){for(var r in t)if(typeof t[r]===l&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(W(t[r][n],e))return"?"===r?i:r}else if(W(t[r],e))return"?"===r?i:r;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,m],[/opios[\/ ]+([\w\.]+)/i],[m,[p,L+" Mini"]],[/\bopr\/([\w\.]+)/i],[m,[p,L]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[m,[p,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,m],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[p,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[m,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[p,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[m,[p,"Smart Lenovo "+C]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+C],m],[/\bfocus\/([\w\.]+)/i],[m,[p,I+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[p,L+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[p,L+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[p,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[m,[p,I]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+C]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+C],m],[/samsungbrowser\/([\w\.]+)/i],[m,[p,N+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],m],[/metasr[\/ ]?([\d\.]+)/i],[m,[p,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[p,"Sogou Mobile"],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[p,m],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,V],m],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[p,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[p,x+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,x+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[p,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[m,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[p,I+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,m],[/(cobalt)\/([\w\.]+)/i],[p,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,$]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",$]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,$]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[f,N],[h,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[f,N],[h,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[f,A],[h,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[f,A],[h,_]],[/(macintosh);/i],[d,[f,A]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[f,U],[h,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[f,R],[h,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[f,R],[h,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[f,B],[h,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[f,B],[h,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[f,"OPPO"],[h,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[f,"Vivo"],[h,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[f,"Realme"],[h,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[f,O],[h,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[f,O],[h,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[f,M],[h,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[f,M],[h,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[f,"Lenovo"],[h,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[f,"Nokia"],[h,v]],[/(pixel c)\b/i],[d,[f,w],[h,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[f,w],[h,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[f,j],[h,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[f,j],[h,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[f,"OnePlus"],[h,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[f,T],[h,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[f,T],[h,v]],[/(playbook);[-\w\),; ]+(rim)/i],[d,f,[h,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[f,P],[h,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[f,S],[h,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[f,S],[h,v]],[/(nexus 9)/i],[d,[f,"HTC"],[h,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[d,/_/g," "],[h,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[f,"Acer"],[h,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[f,"Meizu"],[h,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[f,"Ulefone"],[h,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,d,[h,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,d,[h,_]],[/(surface duo)/i],[d,[f,D],[h,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[f,"Fairphone"],[h,v]],[/(u304aa)/i],[d,[f,"AT&T"],[h,v]],[/\bsie-(\w*)/i],[d,[f,"Siemens"],[h,v]],[/\b(rct\w+) b/i],[d,[f,"RCA"],[h,_]],[/\b(venue[\d ]{2,7}) b/i],[d,[f,"Dell"],[h,_]],[/\b(q(?:mv|ta)\w+) b/i],[d,[f,"Verizon"],[h,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[f,"Barnes & Noble"],[h,_]],[/\b(tm\d{3}\w+) b/i],[d,[f,"NuVision"],[h,_]],[/\b(k88) b/i],[d,[f,"ZTE"],[h,_]],[/\b(nx\d{3}j) b/i],[d,[f,"ZTE"],[h,v]],[/\b(gen\d{3}) b.+49h/i],[d,[f,"Swiss"],[h,v]],[/\b(zur\d{3}) b/i],[d,[f,"Swiss"],[h,_]],[/\b((zeki)?tb.*\b) b/i],[d,[f,"Zeki"],[h,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],d,[h,_]],[/\b(ns-?\w{0,9}) b/i],[d,[f,"Insignia"],[h,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[f,"NextBook"],[h,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],d,[h,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],d,[h,v]],[/\b(ph-1) /i],[d,[f,"Essential"],[h,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[f,"Envizen"],[h,_]],[/\b(trio[-\w\. ]+) b/i],[d,[f,"MachSpeed"],[h,_]],[/\btu_(1491) b/i],[d,[f,"Rotor"],[h,_]],[/(shield[\w ]+) b/i],[d,[f,"Nvidia"],[h,_]],[/(sprint) (\w+)/i],[f,d,[h,v]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[f,D],[h,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[f,F],[h,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[f,F],[h,v]],[/smart-tv.+(samsung)/i],[f,[h,k]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[f,N],[h,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,M],[h,k]],[/(apple) ?tv/i],[f,[d,A+" TV"],[h,k]],[/crkey/i],[[d,x+"cast"],[f,w],[h,k]],[/droid.+aft(\w+)( bui|\))/i],[d,[f,T],[h,k]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[f,U],[h,k]],[/(bravia[\w ]+)( bui|\))/i],[d,[f,j],[h,k]],[/(mitv-\w{5}) bui/i],[d,[f,B],[h,k]],[/Hbbtv.*(technisat) (.*);/i],[f,d,[h,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,z],[d,z],[h,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,k]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,d,[h,y]],[/droid.+; (shield) bui/i],[d,[f,"Nvidia"],[h,y]],[/(playstation [345portablevi]+)/i],[d,[f,j],[h,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[f,D],[h,y]],[/((pebble))app/i],[f,d,[h,E]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[f,A],[h,E]],[/droid.+; (glass) \d/i],[d,[f,w],[h,E]],[/droid.+; (wt63?0{2,3})\)/i],[d,[f,F],[h,E]],[/(quest( 2| pro)?)/i],[d,[f,V],[h,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[h,b]],[/(aeobc)\b/i],[d,[f,T],[h,b]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[h,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[h,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,v]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,m],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[p,[m,Y,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,Y,X],[p,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,H],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,m],[/\(bb(10);/i],[m,[p,P]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[p,I+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[p,x+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,G],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,m],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,m]]},Q=function(e,t){if(typeof e===l&&(t=e,e=i),!(this instanceof Q))return new Q(e,t).getResult();var r=typeof a!==o&&a.navigator?a.navigator:i,n=e||(r&&r.userAgent?r.userAgent:""),y=r&&r.userAgentData?r.userAgentData:i,k=t?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(Z,t):Z,E=r&&r.userAgent==n;return this.getBrowser=function(){var e,t={};return t[p]=i,t[m]=i,q.call(t,n,k.browser),t[c]=typeof(e=t[m])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:i,E&&r&&r.brave&&typeof r.brave.isBrave==s&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[g]=i,q.call(e,n,k.cpu),e},this.getDevice=function(){var e={};return e[f]=i,e[d]=i,e[h]=i,q.call(e,n,k.device),E&&!e[h]&&y&&y.mobile&&(e[h]=v),E&&"Macintosh"==e[d]&&r&&typeof r.standalone!==o&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[d]="iPad",e[h]=_),e},this.getEngine=function(){var e={};return e[p]=i,e[m]=i,q.call(e,n,k.engine),e},this.getOS=function(){var e={};return e[p]=i,e[m]=i,q.call(e,n,k.os),E&&!e[p]&&y&&"Unknown"!=y.platform&&(e[p]=y.platform.replace(/chrome os/i,G).replace(/macos/i,H)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===u&&e.length>500?z(e,500):e,this},this.setUA(n),this};Q.VERSION="1.0.37",Q.BROWSER=K([p,m,c]),Q.CPU=K([g]),Q.DEVICE=K([d,f,h,y,v,k,_,E,b]),Q.ENGINE=Q.OS=K([p,m]),typeof t!==o?(e.exports&&(t=e.exports=Q),t.UAParser=Q):r.amdO?(n=function(){return Q}.call(t,r,t,e))===i||(e.exports=n):typeof a!==o&&(a.UAParser=Q);var J=typeof a!==o&&(a.jQuery||a.Zepto);if(J&&!J.ua){var ee=new Q;J.ua=ee.getResult(),J.ua.get=function(){return ee.getUA()},J.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var r in t)J.ua[r]=t[r]}}}("object"==typeof window?window:this)},7061:function(e,t,r){var n=r(8698).default;function a(){"use strict";e.exports=a=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var t,r={},i=Object.prototype,s=i.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function p(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(t){p=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var a=t&&t.prototype instanceof k?t:k,i=Object.create(a.prototype),s=new D(n||[]);return o(i,"_invoke",{value:I(e,r,s)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var m="suspendedStart",g="suspendedYield",y="executing",v="completed",_={};function k(){}function E(){}function b(){}var T={};p(T,u,(function(){return this}));var A=Object.getPrototypeOf,S=A&&A(A(O([])));S&&S!==i&&s.call(S,u)&&(T=S);var P=b.prototype=k.prototype=Object.create(T);function C(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(a,i,o,l){var u=f(e[a],e,i);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==n(d)&&s.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,o,l)}),(function(e){r("throw",e,o,l)})):t.resolve(d).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}})}function I(e,r,n){var a=m;return function(i,s){if(a===y)throw new Error("Generator is already running");if(a===v){if("throw"===i)throw s;return{value:t,done:!0}}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var l=w(o,n);if(l){if(l===_)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===m)throw a=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=y;var u=f(e,r,n);if("normal"===u.type){if(a=n.done?v:g,u.arg===_)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=v,n.method="throw",n.arg=u.arg)}}}function w(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,w(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var i=f(a,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var s=i.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(s.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(n(e)+" is not iterable")}return E.prototype=b,o(P,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:E,configurable:!0}),E.displayName=p(b,d,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,p(e,d,"GeneratorFunction")),e.prototype=Object.create(P),e},r.awrap=function(e){return{__await:e}},C(x.prototype),p(x.prototype,c,(function(){return this})),r.AsyncIterator=x,r.async=function(e,t,n,a,i){void 0===i&&(i=Promise);var s=new x(h(e,t,n,a),i);return r.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},C(P),p(P,d,"Generator"),p(P,u,(function(){return this})),p(P,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=O,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var r in this)"t"===r.charAt(0)&&s.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,a){return o.type="throw",o.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=s.call(i,"catchLoc"),u=s.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;M(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},r}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4687:function(e,t,r){var n=r(7061)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},907:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:function(){return n}})},3878:function(e,t,r){"use strict";function n(e){if(Array.isArray(e))return e}r.d(t,{Z:function(){return n}})},7326:function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{Z:function(){return n}})},5671:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,{Z:function(){return n}})},3144:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(9142);function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,n.Z)(a.key),a)}}function i(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}},4942:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(9142);function a(e,t,r){return(t=(0,n.Z)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},1752:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(1120);function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,n.Z)(e)););return e}(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},a.apply(this,arguments)}},1120:function(e,t,r){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.d(t,{Z:function(){return n}})},9340:function(e,t,r){"use strict";function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)}r.d(t,{Z:function(){return a}})},9199:function(e,t,r){"use strict";function n(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.d(t,{Z:function(){return n}})},5267:function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(t,{Z:function(){return n}})},2963:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(1002),a=r(7326);function i(e,t){if(t&&("object"===(0,n.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,a.Z)(e)}},9439:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(3878),a=r(181),i=r(5267);function s(e,t){return(0,n.Z)(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}(e,t)||(0,a.Z)(e,t)||(0,i.Z)()}},3433:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(907),a=r(9199),i=r(181);function s(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||(0,a.Z)(e)||(0,i.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9142:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(1002);function a(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!==(0,n.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===(0,n.Z)(t)?t:String(t)}},1002:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:function(){return n}})},181:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(907);function a(e,t){if(e){if("string"==typeof e)return(0,n.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={id:n,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.amdO={},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nc=void 0;var n={};return function(){"use strict";r.r(n),r.d(n,{AbrMode:function(){return S.n},AdBreakType:function(){return R.S},AdEventType:function(){return D.J},AdTagType:function(){return M.J},AudioTrack:function(){return p.Z},AutoPlayType:function(){return L.B},BaseMediaSourceAdapter:function(){return t.Z},BaseMiddleware:function(){return o.Z},CorsType:function(){return C.X},CustomEventType:function(){return A.nQ},DrmScheme:function(){return x.J},EngineDecoratorProvider:function(){return i._},EngineType:function(){return b.r},Env:function(){return g.Z},Error:function(){return v.Z},EventManager:function(){return B.Q},EventType:function(){return A.tw},FakeEvent:function(){return j.v},FakeEventTarget:function(){return F.H},Html5EventType:function(){return A.Rk},ImageTrack:function(){return c.Z},LogLevel:function(){return P.in},LogLevelType:function(){return P.hX},MediaType:function(){return T.D},MimeType:function(){return I.H},NAME:function(){return W},PKTextTrack:function(){return h.PZ},Player:function(){return e.Z},RequestType:function(){return w.x},ScreenOrientationType:function(){return O.z},State:function(){return l.Z},StateType:function(){return _.Y},StreamType:function(){return E.j},TextStyle:function(){return m.Z},TextTrack:function(){return h.ZP},ThumbnailInfo:function(){return N.F},TimedMetadata:function(){return f.D},Track:function(){return u.Z},TrackType:function(){return k.V},Utils:function(){return y},VERSION:function(){return K},VideoTrack:function(){return d.Z},createTextTrackCue:function(){return f.PC},createTimedMetadata:function(){return f.cP},filterTracksByRestriction:function(){return U.u},getCapabilities:function(){return z},getLogLevel:function(){return P.ZO},getLogger:function(){return P.ZP},loadPlayer:function(){return $},registerEngine:function(){return s.Hl},registerMediaSourceAdapter:function(){return a.L},setCapabilities:function(){return q},setLogHandler:function(){return P.hs},setLogLevel:function(){return P.Ub},unRegisterEngine:function(){return s.co},utils:function(){return y}});var e=r(4649),t=r(4651),a=r(2588),i=r(1057),s=r(4779),o=r(902),l=r(4919),u=r(8413),c=r(2983),d=r(4877),p=r(7812),h=r(6462),f=r(375),m=r(6234),g=r(2069),y=r(9021),v=r(962),_=r(9769),k=r(5856),E=r(7300),b=r(488),T=r(2806),A=r(2114),S=r(6820),P=r(4358),C=r(6145),x=r(7237),I=r(3336),w=r(6975),R=r(9063),M=r(8151),D=r(4611),O=r(3323),L=r(8143),N=r(5590),U=r(1177),j=r(8987),B=r(4270),F=r(8171),V=r(9150),G={};for(var H in V)["default","loadPlayer","registerMediaSourceAdapter","BaseMediaSourceAdapter","BaseMiddleware","Track","VideoTrack","AudioTrack","TextTrack","PKTextTrack","ImageTrack","TextStyle","TimedMetadata","createTextTrackCue","createTimedMetadata","Utils","utils","Error","FakeEvent","EventManager","FakeEventTarget","VERSION","NAME","Env","State","getCapabilities","setCapabilities","EngineDecoratorProvider","registerEngine","unRegisterEngine","AdBreakType","AdTagType","AdEventType","filterTracksByRestriction","Html5EventType","CustomEventType","EventType","StateType","TrackType","EngineType","MediaType","StreamType","AbrMode","LogLevelType","CorsType","DrmScheme","MimeType","RequestType","ScreenOrientationType","AutoPlayType","ThumbnailInfo","getLogger","LogLevel","getLogLevel","setLogLevel","setLogHandler","Player"].indexOf(H)<0&&(G[H]=function(e){return V[e]}.bind(0,H));r.d(n,G);var K="0.84.4",W="@playkit-js/playkit-js";function $(t){return new e.Z(t||{})}var z=e.Z.getCapabilities,q=e.Z.setCapabilities;n.default=$}(),n}()}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var module=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e](module,module.exports,__webpack_require__),module.loaded=!0,module.exports}__webpack_require__.n=module=>{var e=module&&module.__esModule?()=>module.default:()=>module;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=module=>(module.paths=[],module.children||(module.children=[]),module);var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Ad:()=>_s,AdBreak:()=>Ts,BasePlugin:()=>re,KALTURA_PLAYER_START_TIME_QS:()=>Bt,KalturaPlayer:()=>ci,LocalStorageManager:()=>et,PLAYER_NAME:()=>As,PLAYER_TYPE:()=>Ss,SessionStorageManager:()=>_t,VERSION:()=>Ps,cast:()=>fs,core:()=>p,getPlayer:()=>hi,getPlayers:()=>pi,playlist:()=>ms,providers:()=>f,registerPlugin:()=>ue,setup:()=>yi,ui:()=>h});var e=__webpack_require__(701),t=__webpack_require__.n(e),r=__webpack_require__(236),n=__webpack_require__.n(r),a=__webpack_require__(75),i=__webpack_require__.n(a),s=__webpack_require__(182),o=__webpack_require__.n(s),l=__webpack_require__(213),u=__webpack_require__.n(l),c=__webpack_require__(129),d={attributes:{id:"@playkit-js/kaltura-player-js"}};d.styleTagTransform=u(),d.setAttributes=i(),d.insert=function(e){window.kalturaGlobalConfig&&"string"==typeof window.kalturaGlobalConfig.stylesNonce&&e.setAttribute("nonce",window.kalturaGlobalConfig.stylesNonce),document.head.appendChild(e)},d.domAPI=n(),d.insertStyleElement=o();t()(c.Z,d);c.Z&&c.Z.locals&&c.Z.locals;var p=__webpack_require__(538),h=__webpack_require__(693),f=__webpack_require__(989);__webpack_require__(305),__webpack_require__(644);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function y(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:String(t)}var _=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),y(this,"_disabled",!1),this._player=t;var a=r.ui;if(a.disable){this._disabled=!0;var i=document.getElementById(a.targetId);i&&i.appendChild(t.getView())}else this._uiManager=new h.UIManager(t,a),a.customPreset||window.kalturaCustomPresetMap&&window.kalturaCustomPresetMap[a.targetId]?this._uiManager.buildCustomUI(a.customPreset||window.kalturaCustomPresetMap[a.targetId].audioPlayer):this._uiManager.buildDefaultUI(),this._handleVr(r.plugins),this._handleExternalCSS(a);return new Proxy(this,{get:function(e,t){return n._disabled?function(){}:e[t]}})}var t,r,n;return t=e,r=[{key:"destroy",value:function(){this._uiManager.destroy()}},{key:"reset",value:function(){this._resetErrorState()}},{key:"setConfig",value:function(e,t){this._uiManager.setConfig(e,t)}},{key:"addComponent",value:function(e){return this._uiManager.addComponent(e)}},{key:"removeComponent",value:function(e){var t={label:"Remove_".concat(e.removeComponent),get:h.Components.Remove,presets:e.presets,area:e.area||e.container,replaceComponent:e.removeComponent};return this._uiManager.addComponent(t)}},{key:"store",get:function(){return this._uiManager.store}},{key:"registerManager",value:function(e,t){this._player.registerService(e,t)}},{key:"getManager",value:function(e){return this._player.getService(e)}},{key:"hasManager",value:function(e){return this._player.hasService(e)}},{key:"setLoadingSpinnerState",value:function(e){this.setConfig({show:e},"loading")}},{key:"_resetErrorState",value:function(){this.setConfig({hasError:!1},"engine")}},{key:"_handleExternalCSS",value:function(t){t.css&&p.Utils.Dom.loadStyleSheetAsync(t.css).then((function(){e._logger.debug("external css was loaded successfully")}),(function(){e._logger.error("external css failed to load")}))}},{key:"_handleVr",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.vr&&!e.vr.disable&&this._setStereoConfig(e.vr)}},{key:"_setStereoConfig",value:function(e){(e.toggleStereo||(p.Env.isMobile||p.Env.isTablet)&&!1!==e.toggleStereo)&&this.setConfig(p.Utils.Object.mergeDeep({},{vrStereoMode:!!e.startInStereo}),"vrStereo")}}],r&&g(t.prototype,r),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function b(e,t,r){return(t=T(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e){var t=function(e,t){if("object"!=k(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==k(t)?t:String(t)}y(_,"_logger",(0,p.getLogger)("UIWrapper"));var A=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),b(this,"_prebid",null),this._loadPromise=p.Utils.Object.defer(),this._loadPromise.catch((function(){return e._logger.warn("Prebid SDK failed to load")})),t?(this._config=t,this._loadPrebidSDKLib(this._config.libUrl).then((function(){r._isPrebidSDKLibLoaded()?(r._prebid=window.pbjs,r._loadPromise.resolve()):r._loadPromise.reject()})).catch((function(){r._loadPromise.reject()}))):this._loadPromise.reject()}var t,r,n;return t=e,(r=[{key:"_isPrebidSDKLibLoaded",value:function(){return window.pbjs&&window.pbjs.que}},{key:"_loadPrebidSDKLib",value:function(e){return this._isPrebidSDKLibLoaded()?Promise.resolve():p.Utils.Dom.loadScriptAsync(e)}},{key:"_load",value:function(t){var r=this;return new Promise((function(n,a){r._loadPromise.then((function(){var i=setTimeout(a,t.timeout||4e3);r._prebid.que.push((function(){r._prebid.addAdUnits(t.adUnit),t.options&&r._prebid.setConfig(t.options),r._prebid.requestBids({bidsBackHandler:function(s){if(e._logger.debug("returned bids",s),clearTimeout(i),t.params){var o={};t.adUnit&&(o.adUnit=t.adUnit),o.params=t.params;var l=r._prebid.adServers.dfp.buildVideoUrl(o);n([{vastUrl:l}])}else try{var u=s[t.adUnit.code||Object.keys(s)[0]].bids;n(u)}catch(e){a()}}})}))})).catch(a)}))}},{key:"load",value:function(e){return this._load(e||this._config)}}])&&E(t.prototype,r),n&&E(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M(n.key),n)}}function C(e,t,r){return t=I(t),function(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}(e,x()?Reflect.construct(t,r||[],I(e).constructor):t.apply(e,r))}function x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}function M(e){var t=function(e,t){if("object"!=S(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==S(t)?t:String(t)}b(A,"_logger",(0,p.getLogger)("PrebidManager"));var D=function(e){function t(e){var r,n,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=C(this,t),n=w(r),i="AdLayoutMiddleware",(a=M(a="id"))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i,r._context=e,r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(t,e),r=t,(n=[{key:"load",value:function(e){var t=this;this._context.prerollReady.then((function(){return t.callNext(e)}))}},{key:"play",value:function(e){var t=this;this._context.prerollReady.then((function(){return t.callNext(e)}))}}])&&P(r.prototype,n),a&&P(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(p.BaseMiddleware);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function L(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K(n.key),n)}}function B(e,t,r){return t=V(t),function(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,F()?Reflect.construct(t,r||[],V(e).constructor):t.apply(e,r))}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(F=function(){return!!e})()}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}function G(e,t){return G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},G(e,t)}function H(e,t,r){return(t=K(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K(e){var t=function(e,t){if("object"!=O(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==O(t)?t:String(t)}var W=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=B(this,t))._player=e,n._eventManager=new p.EventManager,n._liveEventManager=new p.EventManager,n._adsPluginControllers=r,n._prebidManager=new A(n._player.config.advertising&&n._player.config.advertising.prebid),n._init(),n}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G(e,t)}(t,e),r=t,n=[{key:"allAdsCompleted",get:function(){return this._allAdsCompleted}},{key:"isAdPlaying",value:function(){return this.isAdBreak()&&this._isAdPlaying}},{key:"isAdBreak",value:function(){return!!this._adBreak}},{key:"getAdBreaksLayout",value:function(){return this._adBreaksLayout}},{key:"getAdBreak",value:function(){return this._adBreak}},{key:"getAd",value:function(){return this._ad}},{key:"skipAd",value:function(){var e=this._adsPluginControllers.find((function(e){return e.active}));e&&e.skipAd()}},{key:"playAdNow",value:function(e){var r=this;if(this.isAdBreak())t._logger.warn("Tried to call playAdNow during an ad break");else{var n=Promise.all(e.map((function(e){return r._getPrebidAds(e)})));this._playAdBreak({position:this._player.currentTime||0,ads:e,played:!1,loadedPromise:n})}}},{key:"getMiddleware",value:function(){return this._middleware?this._middleware:this._middleware=new D(this)}},{key:"_init",value:function(){this._initMembers(),this._addBindings()}},{key:"_initMembers",value:function(){this._allAdsCompleted=!0,this._adBreaksLayout=[],this._adBreak=void 0,this._ad=void 0,this._adPlayed=!1,this._snapback=0,this._adIsLoading=!1,this._isAdPlaying=!1,this._liveSeeking=!1}},{key:"_addBindings",value:function(){var e=this;this._eventManager.listen(this._player,p.CustomEventType.SOURCE_SELECTED,(function(){return e._handleConfiguredAdBreaks()})),this._eventManager.listen(this._player,p.AdEventType.AD_MANIFEST_LOADED,(function(t){return e._onAdManifestLoaded(t)})),this._eventManager.listen(this._player,p.AdEventType.AD_BREAK_START,(function(t){return e._onAdBreakStart(t)})),this._eventManager.listen(this._player,p.AdEventType.AD_LOADED,(function(){return e._onAdLoaded()})),this._eventManager.listen(this._player,p.AdEventType.AD_STARTED,(function(t){return e._onAdStarted(t)})),this._eventManager.listen(this._player,p.AdEventType.AD_COMPLETED,(function(){return e._isAdPlaying=!1})),this._eventManager.listen(this._player,p.AdEventType.AD_BREAK_END,(function(){return e._onAdBreakEnd()})),this._eventManager.listen(this._player,p.AdEventType.ADS_COMPLETED,(function(){return e._onAdsCompleted()})),this._eventManager.listen(this._player,p.AdEventType.AD_ERROR,(function(t){return e._onAdError(t)})),this._eventManager.listen(this._player,p.CustomEventType.PLAYER_RESET,(function(){return e._reset()})),this._eventManager.listen(this._player,p.CustomEventType.PLAYER_DESTROY,(function(){return e._destroy()})),this._eventManager.listenOnce(this._player,p.Html5EventType.ENDED,(function(){return e._onEnded()})),this._eventManager.listenOnce(this._player,p.CustomEventType.PLAYBACK_ENDED,(function(){return e._onPlaybackEnded()})),this._eventManager.listen(this._player,p.AdEventType.AD_RESUMED,(function(){return e._isAdPlaying=!0})),this._eventManager.listen(this._player,p.AdEventType.AD_PAUSED,(function(){return e._isAdPlaying=!1}))}},{key:"_handleConfiguredAdBreaks",value:function(){var e=this,t=this._player.config.advertising.playAdsAfterTime||this._player.config.sources.startTime;this._configAdBreaks=this._player.config.advertising.adBreaks.filter((function(e){return("number"==typeof e.every||"number"==typeof e.position||"number"==typeof e.percentage)&&e.ads.length})).map((function(r){e._validateOneTimeConfig(r);var n=r.position;0===r.percentage&&(n=0),100===r.percentage&&(n=-1),r.every&&(n=r.every);var a=e._player.isLive()?n<t:n<=t;return{position:n,percentage:r.percentage,every:r.every,ads:r.ads.slice(),played:-1<n&&a}})),this._configAdBreaks.length?(this._dispatchAdManifestLoaded(),this._handlePrebidAdConfig(),this._handleConfiguredPreroll(),this._eventManager.listenOnce(this._player,p.Html5EventType.DURATION_CHANGE,(function(){e._player.isLive()?e._eventManager.listenOnce(e._player,p.Html5EventType.SEEKING,(function(){e._pushNextAdsForLive(e._configAdBreaks,(function(t){return e._player.currentTime+t.every})),e._attachLiveSeekedHandler()})):e._handleEveryAndPercentage(),e._configAdBreaks.sort((function(e,t){return e.position-t.position})),e._configAdBreaks.some((function(e){return e.position>0}))&&e._handleConfiguredMidrolls()}))):this.prerollReady=Promise.resolve()}},{key:"_validateOneTimeConfig",value:function(e){"number"==typeof e.position&&("number"==typeof e.percentage&&(t._logger.warn("Validate ad break - ignore percentage ".concat(e.percentage," as position ").concat(e.position," configured")),delete e.percentage),"number"==typeof e.every&&(t._logger.warn("Validate ad break - ignore every ".concat(e.every," as position ").concat(e.position," configured")),delete e.every)),"number"==typeof e.percentage&&"number"==typeof e.every&&(t._logger.warn("Validate ad break - ignore every ".concat(e.every," as percentage ").concat(e.percentage," configured")),delete e.every)}},{key:"_dispatchAdManifestLoaded",value:function(){var e=this,r=Array.from(new Set(this._configAdBreaks.map((function(e){return e.every&&e.every+"s"||"number"==typeof e.percentage&&e.percentage+"%"||e.position}))));t._logger.debug(p.AdEventType.AD_MANIFEST_LOADED,r),this._player.dispatchEvent(new p.FakeEvent(p.AdEventType.AD_MANIFEST_LOADED,{adBreaksPosition:r})),this._player.hasService("timeline")&&this._player.config.advertising.showAdBreakCuePoint&&r.forEach((function(t){e._player.getService("timeline").addCuePoint(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){H(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({time:-1!==t?t:1/0},e._player.config.advertising.adBreakCuePointStyle))}))}},{key:"_handlePrebidAdConfig",value:function(){var e=this;this._prebidManager&&this._configAdBreaks.filter((function(e){return!e.played})).map((function(t){var r=Promise.all(t.ads.map((function(t){return e._getPrebidAds(t)})));t.loadedPromise=r,r.then((function(e){return t.ads=e}))}))}},{key:"_getPrebidAds",value:function(e){var t=this;return new Promise((function(r){if(e.prebid&&t._prebidManager){var n=p.Utils.Object.mergeDeep({},e.prebid,t._player.config.advertising.prebid);t._prebidManager.load(n).then((function(t){var n=t.map((function(e){return e&&e.vastUrl}));e.url=n.concat(e.url),r(e)})).catch((function(){r(e)}))}else r(e)}))}},{key:"_handleConfiguredPreroll",value:function(){var e=this._configAdBreaks.filter((function(e){return 0===e.position&&!e.played})),t=this._mergeAdBreaks(e);this.prerollReady=t&&t.loadedPromise?t.loadedPromise:Promise.resolve(),t&&this._playAdBreak(t)}},{key:"_handleEveryAndPercentage",value:function(){var e=this;this._configAdBreaks.forEach((function(t){if(e._player.duration&&t.every)for(var r=2*t.every;r<=e._player.duration;)e._configAdBreaks.push({position:r,ads:t.ads,played:!1,loadedPromise:Promise.resolve()}),r+=t.every;else e._player.duration&&t.percentage&&!t.position&&(t.position=Math.floor(e._player.duration*t.percentage/100))}))}},{key:"_attachLiveSeekedHandler",value:function(){var e=this;this._eventManager.listenOnce(this._player,p.CustomEventType.FIRST_PLAYING,(function(){e._eventManager.listen(e._player,p.Html5EventType.SEEKING,(function(){e._liveSeeking=!0})),e._eventManager.listen(e._player,p.Html5EventType.SEEKED,(function(){e._liveSeeking=!1,e._pushNextAdsForLive(e._configAdBreaks,(function(t){return e._player.currentTime+t.every}))}))}))}},{key:"_pushNextAdsForLive",value:function(e,r){this._liveEventManager.removeAll();var n=[];e.forEach((function(e){if(![-1,0].includes(e.position)){var a=e.every,i=e.ads,s={every:a,position:r(e),ads:i,played:!1,loadedPromise:Promise.resolve()};t._logger.debug("Pushing next ad for live",s),n.push(s)}})),n.length&&(this._configAdBreaks=[].concat(n,L(this._configAdBreaks.filter((function(e){return-1===e.position})))))}},{key:"_handleConfiguredMidrolls",value:function(){var e=this;this._eventManager.listen(this._player,p.Html5EventType.TIME_UPDATE,(function(){if(!e._player.paused&&!e._liveSeeking){var r=e._configAdBreaks.filter((function(t){return!t.played&&e._player.currentTime&&t.position<=e._player.currentTime&&t.position>e._snapback}));if(r.length){var n=r[r.length-1].position,a=r.filter((function(e){return e.position===n}));e._player.isLive()?!e._player.isDvr()||e._player.isOnLiveEdge()&&e._player.config.advertising.returnToLive?e._handleReturnToLive(a):e._pushNextAdsForLive(a,(function(t){return(e._player.isOnLiveEdge()?e._player.currentTime:t.position)+t.every})):(e._snapback=n,t._logger.debug("Set snapback value ".concat(e._snapback)),e._eventManager.listen(e._player,p.Html5EventType.SEEKED,(function(){var r=e._configAdBreaks.findIndex((function(t){return t.played&&"number"==typeof e._player.currentTime&&e._player.currentTime<t.position}));r>0&&!e._configAdBreaks[r-1].played&&(e._snapback=0,t._logger.debug("Reset snapback value"))})));var i=e._mergeAdBreaks(a);i&&e._playAdBreak(i)}}}))}},{key:"_handleReturnToLive",value:function(e){var t=this;this._liveEventManager.listenOnce(this._player,p.AdEventType.AD_ERROR,(function(){t._pushNextAdsForLive(e,(function(e){return(t._player.isOnLiveEdge()?t._player.currentTime:e.position)+e.every}))})),this._liveEventManager.listenOnce(this._player,p.AdEventType.AD_BREAK_END,(function(){t._player.seekToLiveEdge()}))}},{key:"_playAdBreak",value:function(e){var r=this._adsPluginControllers.find((function(e){return"function"==typeof e.playAdNow}));r?(e.played=!0,this._adIsLoading=!0,t._logger.debug("Playing ad break positioned in ".concat(e.position)),e.loadedPromise.then((function(){return r.playAdNow(e.ads)}))):t._logger.warn("No ads plugin registered")}},{key:"_onAdManifestLoaded",value:function(e){this._adBreaksLayout=Array.from(new Set(this._adBreaksLayout.concat(e.payload.adBreaksPosition))).sort(),this._allAdsCompleted=!1}},{key:"_onAdBreakStart",value:function(e){this._adBreak=e.payload.adBreak}},{key:"_onAdLoaded",value:function(){this._adIsLoading=!1}},{key:"_onAdStarted",value:function(e){this._ad=e.payload.ad,this._adPlayed=!0,this._isAdPlaying=!0}},{key:"_onAdBreakEnd",value:function(){this._adBreak=void 0,this._ad=void 0}},{key:"_onAdsCompleted",value:function(){this._adsPluginControllers.every((function(e){return e.done}))&&this._configAdBreaks.every((function(e){return e.played}))&&(this._allAdsCompleted=!0,t._logger.debug(p.AdEventType.ALL_ADS_COMPLETED),this.dispatchEvent(new p.FakeEvent(p.AdEventType.ALL_ADS_COMPLETED)))}},{key:"_onAdError",value:function(e){this._adIsLoading=!1,e.payload.severity===p.Error.Severity.CRITICAL&&(this._isAdPlaying=!1,this._adsPluginControllers.every((function(e){return e.done}))&&this._configAdBreaks.every((function(e){return e.played}))&&(this._allAdsCompleted=!0,this._adPlayed&&(t._logger.debug(p.AdEventType.ALL_ADS_COMPLETED),this.dispatchEvent(new p.FakeEvent(p.AdEventType.ALL_ADS_COMPLETED)))))}},{key:"_isBumper",value:function(e){return"bumper"===e.name}},{key:"_onEnded",value:function(){var e=this;if(!this._adIsLoading){var t=this._adsPluginControllers.find((function(t){return e._isBumper(t)})),r=this._adsPluginControllers.find((function(t){return!e._isBumper(t)&&!t.done})),n=t&&"function"==typeof t.onPlaybackEnded?function(){return t.onPlaybackEnded()}:function(){return Promise.resolve()},a=r&&"function"==typeof r.onPlaybackEnded?function(){return r.onPlaybackEnded()}:function(){return Promise.resolve()};this._adBreaksLayout.includes(-1)||this._adBreaksLayout.includes("100%")||(this._allAdsCompleted=!0),n().finally((function(){a().finally((function(){return e._handleConfiguredPostroll()}))}))}}},{key:"_onPlaybackEnded",value:function(){this._configAdBreaks.forEach((function(e){return e.played=!0}))}},{key:"_handleConfiguredPostroll",value:function(){var e=this._configAdBreaks.filter((function(e){return!e.played&&-1===e.position}));if(e.length){var t=this._mergeAdBreaks(e);t&&this._playAdBreak(t)}this._configAdBreaks.forEach((function(e){return e.played=!0}))}},{key:"_reset",value:function(){this._eventManager.removeAll(),this._liveEventManager.removeAll(),this._init()}},{key:"_destroy",value:function(){this._adsPluginControllers=[],this._eventManager.destroy(),this._liveEventManager.destroy()}},{key:"_mergeAdBreaks",value:function(e){if(e.length)return e.forEach((function(e){return e.played=!0})),{position:e[0].position,ads:e.reduce((function(e,t){return e.concat(t.ads)}),[]),played:!1,loadedPromise:Promise.all(e.map((function(e){return e.loadedPromise})))}}}],n&&j(r.prototype,n),a&&j(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(p.FakeEventTarget);function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q(n.key),n)}}function q(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:String(t)}H(W,"_logger",(0,p.getLogger)("AdsController"));var Y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._pluginManager=t}var t,r,n;return t=e,(r=[{key:"getAdsControllers",value:function(){return Object.values(this._pluginManager.getAll()).filter((function(e){return"function"==typeof e.getAdsController})).map((function(e){return e.getAdsController()}))}}])&&z(t.prototype,r),n&&z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,te(n.key),n)}}function ee(e,t,r){return(t=te(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e){var t=function(e,t){if("object"!=X(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==X(t)?t:String(t)}var re=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.player=r,this.eventManager=new p.EventManager,this.logger=(0,p.getLogger)(p.Utils.String.capitlize(this.name)),this.config=Q(Q({},this.constructor.defaultConfig),n)}var t,r,n;return t=e,r=[{key:"getConfig",value:function(e){return e?p.Utils.Object.copyDeep(this.config[e]):p.Utils.Object.copyDeep(this.config)}},{key:"ready",get:function(){return Promise.resolve()}},{key:"updateConfig",value:function(e){p.Utils.Object.mergeDeep(this.config,e)}},{key:"loadMedia",value:function(){}},{key:"open",value:function(){throw new p.Error(p.Error.Severity.CRITICAL,p.Error.Category.PLAYER,p.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"showOverlay()")}},{key:"destroy",value:function(){this.eventManager.destroy()}},{key:"reset",value:function(){}},{key:"getName",value:function(){return this.name}},{key:"dispatchEvent",value:function(e,t){this.logger.debug("Fire event: "+e,t),this.player.dispatchEvent(new p.FakeEvent(e,t))}}],n=[{key:"isValid",value:function(){throw new p.Error(p.Error.Severity.CRITICAL,p.Error.Category.PLAYER,p.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"isValid()")}}],r&&J(t.prototype,r),n&&J(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,se(n.key),n)}}function ie(e,t,r){return(t=se(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function se(e){var t=function(e,t){if("object"!=ne(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ne(t)?t:String(t)}ee(re,"defaultConfig",{});var oe="registeredpluginslistevent",le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ie(this,"_plugins",{}),ie(this,"_isDisabledPluginMap",new Map)}var t,r,n;return t=e,r=[{key:"load",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e._registry.has(t))throw e._logger.warn("Plugin <".concat(t,"> loading failed, plugin is not registered")),new p.Error(p.Error.Severity.RECOVERABLE,p.Error.Category.PLAYER,p.Error.Code.RUNTIME_ERROR_NOT_REGISTERED_PLUGIN,t);var a=e._registry.get(t);"boolean"==typeof n.disable&&this._isDisabledPluginMap.set(t,n.disable);var i=!!this._isDisabledPluginMap.get(t),s=!!a&&a.isValid();if(a&&s&&!i){try{this._plugins[t]=new a(t,r,n)}catch(e){throw new p.Error(p.Error.Severity.RECOVERABLE,p.Error.Category.PLAYER,p.Error.Code.PLUGIN_LOAD_FAILED,e)}return this._isDisabledPluginMap.set(t,!1),e._logger.debug("Plugin <".concat(t,"> has been loaded")),!0}return e._logger.debug("Plugin <".concat(t,"> isn't loaded, isValid()=").concat(s.toString(),", disabled=").concat(i.toString())),!1}},{key:"getRegisterdPluginsList",value:function(){return Array.from(e._registry.keys())}},{key:"loadMedia",value:function(){var e=this;Object.keys(this._plugins).forEach((function(t){return e._plugins[t].loadMedia()}))}},{key:"destroy",value:function(){var e=this;Object.keys(this._plugins).forEach((function(t){e._plugins[t].destroy(),delete e._plugins[t]}))}},{key:"reset",value:function(){var e=this;Object.keys(this._plugins).forEach((function(t){return e._plugins[t].reset()}))}},{key:"get",value:function(e){return this._plugins[e]}},{key:"getAll",value:function(){return this._plugins}}],n=[{key:"register",value:function(t,r){return"function"==typeof r&&r.prototype instanceof re?e._registry.has(t)?(e._logger.debug("Plugin <".concat(t,"> is already registered, do not register again")),!1):(e._registry.set(t,r),e._logger.debug("Plugin <".concat(t,"> has been registered successfully")),!0):(e._logger.error("Plugin <".concat(t,"> registration failed, plugin is not an instance of BasePlugin")),!1)}},{key:"unRegister",value:function(t){e._registry.has(t)&&(e._registry.delete(t),e._logger.debug("Unregistered <".concat(t,"> plugin.")))}}],r&&ae(t.prototype,r),n&&ae(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();ie(le,"_logger",(0,p.getLogger)("PluginManager")),ie(le,"_registry",new Map);var ue=le.register;function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function de(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pe(n.key),n)}}function pe(e){var t=function(e,t){if("object"!=ce(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ce(t)?t:String(t)}function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var me={youbora:{playerVersion:"{{pVersion}}",playerName:"{{pName}}",entryId:"{{entryId}}",entryName:"{{entryName}}",entryType:"{{entryType}}",sessionId:"{{sessionId}}",uiConfId:"{{uiConfId}}"},googleAnalytics:{entryId:"{{entryId}}",entryName:"{{entryName}}",uiConfId:"{{uiConfId}}",partnerId:"{{partnerId}}"},ottAnalytics:{entryId:"{{entryId}}",ks:"{{ks}}",isAnonymous:"{{isAnonymous}}",partnerId:"{{partnerId}}",serviceUrl:"{{serviceUrl}}"},ima:{playerVersion:"{{pVersion}}",playerName:"{{pName}}"},kava:{playerVersion:"{{pVersion}}",playerName:"{{pName}}",partnerId:"{{partnerId}}",playlistId:"{{playlistId}}",entryId:"{{entryId}}",entryType:"{{entryType}}",sessionId:"{{sessionId}}",ks:"{{ks}}",uiConfId:"{{uiConfId}}",referrer:"{{referrer}}",encodedReferrer:"{{encodedReferrer}}",serviceUrl:"{{analyticsServiceUrl}}"},comscore:{playerVersion:"{{pVersion}}"},vr:{rootElement:"{{domRootElementId}}"},share:{partnerId:"{{partnerId}}",uiConfId:"{{uiConfId}}",entryId:"{{entryId}}",embedBaseUrl:"{{embedBaseUrl}}",embedWidth:"{{embedWidth}}",embedHeight:"{{embedHeight}}"}},ge=new RegExp("{{.*}}"),ye=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(t).reduce((function(t,r){var n=he(r,2),a=n[0],i=n[1];return p.Utils.Object.isObject(i)?t[a]=e(i):"string"==typeof i&&ge.test(i)?t[a]=i:t[a]=void 0,t}),{})},ve=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(t).reduce((function(t,r){var n=he(r,2),a=n[0],i=n[1];return p.Utils.Object.isObject(i)?t[a]=e(i):i&&(t[a]=i),t}),{})};function _e(e){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(e)}function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pe(n.key),n)}}function Ee(e,t,r){return t=Te(t),function(e,t){if(t&&("object"===_e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ae(e)}(e,be()?Reflect.construct(t,r||[],Te(e).constructor):t.apply(e,r))}function be(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(be=function(){return!!e})()}function Te(e){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Te(e)}function Ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Se(e,t){return Se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Se(e,t)}function Pe(e){var t=function(e,t){if("object"!=_e(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_e(t)?t:String(t)}var Ce=function(e){function t(){var e,r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=Ee(this,t),r=Ae(e),a={ottAnalytics:{}},(n=Pe(n="_ovpPluginsConfig"))in r?Object.defineProperty(r,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[n]=a,e._config=p.Utils.Object.mergeDeep({},e._basePluginsConfig,e._ovpPluginsConfig),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Se(e,t)}(t,e),r=t,n&&ke(r.prototype,n),a&&ke(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._basePluginsConfig=p.Utils.Object.copyDeep(me)}var t,r,n;return t=e,(r=[{key:"get",value:function(){return this._config}},{key:"set",value:function(e){if(e){var t=ye(e);this._config=ve(p.Utils.Object.mergeDeep(this._config,t))}}},{key:"reset",value:function(){this._config=p.Utils.Object.copyDeep(me)}}])&&de(t.prototype,r),n&&de(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}());const xe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var r,n=e;for(var a in t){var i=void 0!==t[a]&&null!==t[a]?t[a]:"";"string"==typeof i&&i.indexOf('"')>-1&&(i=i.replace(/"/g,'\\"')),r=new RegExp("{{"+a+"}}","g"),n=n.replace(r,i)}return n}catch(e){return""}};function Ie(e,t){var r=function(e){var t=document.createElement("a");return t.href=e,t.hostname},n=r(t),a=!1,i="",s="";return e&&(e.flavors&&Array.isArray(e.flavors)?(i=(a=1===e.flavors.length)&&r(e.flavors[0].url),s=e.flavors[0].url):e.result&&(a=!0,i=r(e.result.url),s=e.result.url)),a&&n!==i?s:t}function we(e,t){var r,n={};if((null==t||null===(r=t.sources)||void 0===r?void 0:r.type)===p.MediaType.LIVE&&("IE"===p.Env.browser.name||"Chromecast"===p.Env.device.model)){var a=p.Utils.Object.getPropertyPath(e,"sources.options.forceRedirectExternalStreams"),i=p.Utils.Object.getPropertyPath(t,"sources.options.forceRedirectExternalStreams");"boolean"!=typeof a&&"boolean"!=typeof i&&p.Utils.Object.mergeDeep(n,{sources:{options:{forceRedirectExternalStreams:!0}}})}return p.Utils.Object.mergeDeep(n,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=p.Utils.Object.getPropertyPath(e,"sources.options.redirectExternalStreamsHandler"),a=p.Utils.Object.getPropertyPath(t,"sources.options.redirectExternalStreamsHandler");return"function"!=typeof n&&"function"!=typeof a&&p.Utils.Object.mergeDeep(r,{sources:{options:{redirectExternalStreamsHandler:Ie}}}),r}(e,t))}var Re={INITIAL_CONFIG_REQUIRED:"Must provide initial providers config",PARTNER_ID_REQUIRED:"Must provide partner id",TARGET_ID_REQUIRED:"Must provide target id",DOM_ELEMENT_WITH_TARGET_ID_REQUIRED:"Must provide DOM element with id of: ",TARGET_ID_ALREADY_USED:"The target id provided is already in use. Id: "};function Me(e){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(e)}function De(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oe(n.key),n)}}function Oe(e){var t=function(e,t){if("object"!=Me(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Me(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Me(t)?t:String(t)}var Le,Ne,Ue,je="@playkit-js/kaltura-player-js_",Be=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"isStorageAvailable",value:function(e){if("undefined"==typeof Storage)return!1;try{return e.setItem("test","test"),e.removeItem("test"),!0}catch(e){return!1}}},{key:"getStorageSize",value:function(e){return Object.keys(e).filter((function(e){return e.startsWith(je)})).length}},{key:"getStorageItems",value:function(e){var t={};return Object.keys(e).forEach((function(r){r.startsWith(je)&&(t[r]=e.getItem(r))})),t}},{key:"setItem",value:function(t,r,n){e._validateKey(t);try{e._logger.debug("Sets item for key: "+t,r),n.setItem(je+t,r)}catch(t){e._isQuotaExceeded(t)?e._logger.error("Quota exceeded: "+t.message):e._logger.error(t.message)}}},{key:"getItem",value:function(t,r){e._validateKey(t);var n=null;try{return"string"==typeof(n=r.getItem(je+t))?JSON.parse(n):null}catch(e){return n}}},{key:"_isQuotaExceeded",value:function(e){var t=!1;if(e)if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t}},{key:"_validateKey",value:function(e){if("string"!=typeof e||0===e.length)throw new Error("Invalid key")}}],(r=null)&&De(t.prototype,r),n&&De(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function Ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ke(n.key),n)}}function He(e,t,r){return t&&Ge(e.prototype,t),r&&Ge(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ke(e){var t=function(e,t){if("object"!=Fe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fe(t)?t:String(t)}Le=Be,Ne="_logger",Ue=(0,p.getLogger)("StorageWrapper"),(Ne=Oe(Ne))in Le?Object.defineProperty(Le,Ne,{value:Ue,enumerable:!0,configurable:!0,writable:!0}):Le[Ne]=Ue;var We=function(){function e(){Ve(this,e),this.storageManagers=[]}return He(e,[{key:"addManager",value:function(e){this.storageManagers.push(e)}}],[{key:"getInstance",value:function(){return null===this.instance&&(this.instance=new e),this.instance}}]),e}();!function(e,t,r){(t=Ke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(We,"instance",null);var $e=function(){function e(){Ve(this,e)}return He(e,null,[{key:"init",value:function(e){this._logger=(0,p.getLogger)(e),We.getInstance().addManager(this)}},{key:"attachAll",value:function(e){We.getInstance().storageManagers.forEach((function(t){t.isStorageAvailable()&&t.attach(e)}))}},{key:"setStorageConfig",value:function(e){We.getInstance().storageManagers.forEach((function(t){t.isStorageAvailable()&&t.hasStorage()&&p.Utils.Object.mergeDeep(e,t.getStorageConfig())}))}},{key:"isStorageAvailable",value:function(){return Be.isStorageAvailable(this.getStorageObject())}},{key:"hasStorage",value:function(){var e=this.getStorageSize(),t=0!==e;return t?this._logger.debug("Storage found with size of ",e):this._logger.debug("No storage found"),t}},{key:"setItem",value:function(e,t){Be.setItem(e,t,this.getStorageObject())}},{key:"getItem",value:function(e){return Be.getItem(e,this.getStorageObject())}},{key:"getStorageSize",value:function(){return Be.getStorageSize(this.getStorageObject())}},{key:"getStorageItems",value:function(){return Be.getStorageItems(this.getStorageObject())}},{key:"getStorageConfig",value:function(){var e=this._getExistingValues(),t=this._buildStorageConfig(e);return this._logger.debug("Gets storage config",t),t}},{key:"_getExistingValues",value:function(){var e=this,t={};return Object.keys(this.StorageKeys).forEach((function(r){var n=e.StorageKeys[r],a=e.getItem(n);null!=a&&(t[n]=a)})),t}},{key:"_buildStorageConfig",value:function(e){var t=p.Utils.Object.mergeDeep({},e);return delete t.textStyle,{playback:t}}},{key:"getStorageObject",value:function(){throw new p.Error(p.Error.Severity.CRITICAL,p.Error.Category.PLAYER,p.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"getStorageObject()")}},{key:"attach",value:function(e){throw new p.Error(p.Error.Severity.CRITICAL,p.Error.Category.PLAYER,p.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"attach()")}},{key:"initialize",value:function(){throw new p.Error(p.Error.Severity.CRITICAL,p.Error.Category.PLAYER,p.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"initialize()")}}]),e}();function ze(e){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ze(e)}function qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Je(n.key),n)}}function Ye(e,t,r){return t=Ze(t),function(e,t){if(t&&("object"===ze(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Xe()?Reflect.construct(t,r||[],Ze(e).constructor):t.apply(e,r))}function Xe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Xe=function(){return!!e})()}function Ze(e){return Ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ze(e)}function Qe(e,t){return Qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qe(e,t)}function Je(e){var t=function(e,t){if("object"!=ze(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ze(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ze(t)?t:String(t)}var et=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ye(this,t,arguments)}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qe(e,t)}(t,e),r=t,a=[{key:"initialize",value:function(){this.init(this.name)}},{key:"getStorageObject",value:function(){return localStorage}},{key:"attach",value:function(e){var t=this;this._logger.debug("Attach local storage");var r=new p.EventManager;r.listen(e,e.Event.UI.USER_CLICKED_MUTE,(function(){e.isCasting()||t.setItem(t.StorageKeys.MUTED,e.muted)})),r.listen(e,e.Event.UI.USER_CLICKED_UNMUTE,(function(){e.isCasting()||t.setItem(t.StorageKeys.MUTED,e.muted)})),r.listen(e,e.Event.UI.USER_CHANGED_VOLUME,(function(){e.isCasting()||(t.setItem(t.StorageKeys.MUTED,!e.volume),t.setItem(t.StorageKeys.VOLUME,e.volume))})),r.listen(e,e.Event.UI.USER_SELECTED_AUDIO_TRACK,(function(e){var r=e.payload.audioTrack;t.setItem(t.StorageKeys.AUDIO_LANG,r.language)}));var n=function(e){e&&"off"!==e?(t.setItem(t.StorageKeys.TEXT_LANG,e),t.setItem(t.StorageKeys.CAPTIONS_DISPLAY,!0)):t.setItem(t.StorageKeys.CAPTIONS_DISPLAY,!1)};r.listen(e,e.Event.UI.USER_SELECTED_CAPTION_TRACK,(function(e){var t,r=e.payload;return n(null===(t=r.captionTrack)||void 0===t?void 0:t.language)})),r.listen(e,e.Event.UI.USER_SHOWED_CAPTIONS,(function(e){var t=e.payload;return n(t.language)})),r.listen(e,e.Event.UI.USER_HID_CAPTIONS,(function(){return n("off")})),r.listen(e,e.Event.UI.USER_SELECTED_CAPTIONS_STYLE,(function(e){try{var r=JSON.stringify(e.payload.captionsStyle);t.setItem(t.StorageKeys.TEXT_STYLE,r)}catch(e){t._logger.error(e.message)}})),r.listen(e,e.Event.Core.PLAYER_DESTROY,(function(){return r.destroy()})),r.listen(e,e.Event.UI.USER_CLICKED_ADVANCED_AUDIO_DESCRIPTION,(function(e){var r=e.payload,n=r.isEnabled,a=r.selectedType;t.setItem(t.StorageKeys.AUDIO_DESCRIPTION,JSON.stringify({isEnabled:n,selectedType:a}))}))}},{key:"getPlayerTextStyle",value:function(){return this.getItem(this.StorageKeys.TEXT_STYLE)}}],(n=null)&&qe(r.prototype,n),a&&qe(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}($e);function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,it(n.key),n)}}function at(e,t,r){return t&&nt(e.prototype,t),r&&nt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function it(e){var t=function(e,t){if("object"!=tt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==tt(t)?t:String(t)}!function(e,t,r){(t=Je(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(et,"StorageKeys",{MUTED:"muted",VOLUME:"volume",AUDIO_LANG:"audioLanguage",TEXT_LANG:"textLanguage",CAPTIONS_DISPLAY:"captionsDisplay",TEXT_STYLE:"textStyle",AUDIO_DESCRIPTION:"audioDescription"});var st=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rt(this,e),t.observedThresholds=t.observedThresholds||ct,t.playerThreshold="number"==typeof t.playerThreshold?t.playerThreshold:dt,this._config=t,this._eventManager=new p.EventManager,this._targetsObserved=new p.Utils.MultiMap;var r={threshold:t.observedThresholds.map((function(e){return e/100}))};this._observer=new window.IntersectionObserver(this._intersectionChangedHandler.bind(this),r),this._initTabVisibility()}return at(e,[{key:"_intersectionChangedHandler",value:function(e){var t=this;e.forEach((function(e){t._targetsObserved.get(e.target).forEach((function(t){var r=e.intersectionRatio>=t.threshold;t.lastIntersectionRatio=e.intersectionRatio,r!==t.lastVisible&&(t.lastVisible=r,t.listener(r,ot.VIEWPORT))}))}))}},{key:"_handleTabVisibilityChange",value:function(){var e=this;this._isTabVisible=!document[this._visibilityTabHiddenAttr],this._targetsObserved.getAll().forEach((function(t){t.lastVisible&&t.listener(e._isTabVisible,ot.TAB)}))}},{key:"_initTabVisibility",value:function(){void 0!==document.hidden&&(this._visibilityTabHiddenAttr="hidden",this._visibilityTabChangeEventName="visibilitychange"),this._visibilityTabHiddenAttr&&this._visibilityTabChangeEventName&&(this._eventManager.listen(document,this._visibilityTabChangeEventName,this._handleTabVisibilityChange.bind(this)),this._isTabVisible=!document[this._visibilityTabHiddenAttr])}},{key:"observe",value:function(e,t,r){if(this._observer){var n="number"==typeof r?r:this._config.playerThreshold,a=new lt(n/100,t);if(e){if(this._targetsObserved.has(e)){var i=this._targetsObserved.get(e)[0].lastIntersectionRatio;void 0!==i&&(a.lastIntersectionRatio=i,a.listener(this._isTabVisible&&i>=a.threshold,ot.VIEWPORT))}else this._observer.observe(e);this._targetsObserved.push(e,a)}}}},{key:"unObserve",value:function(e,t){this._observer&&(this._targetsObserved.remove(e,t),this._targetsObserved.has(e)||this._observer.unobserve(e))}},{key:"destroy",value:function(){this._observer&&(this._eventManager.destroy(),this._observer.disconnect(),this._targetsObserved.clear())}}]),e}(),ot={VIEWPORT:"viewport",TAB:"tab"},lt=at((function e(t,r){rt(this,e),this.threshold=t,this.listener=r})),ut="visibilitychange",ct=[0,10,20,30,40,50,60,70,80,90,100],dt=50;function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function ht(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vt(n.key),n)}}function ft(e,t,r){return t=gt(t),function(e,t){if(t&&("object"===pt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,mt()?Reflect.construct(t,r||[],gt(e).constructor):t.apply(e,r))}function mt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(mt=function(){return!!e})()}function gt(e){return gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gt(e)}function yt(e,t){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yt(e,t)}function vt(e){var t=function(e,t){if("object"!=pt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pt(t)?t:String(t)}var _t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ft(this,t,arguments)}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yt(e,t)}(t,e),r=t,a=[{key:"initialize",value:function(){this.init(this.name)}},{key:"getStorageObject",value:function(){return sessionStorage}},{key:"attach",value:function(e){var t=this;this._logger.debug("Attach session storage"),(new p.EventManager).listen(e,e.Event.UI.USER_SELECTED_SPEED,(function(){e.isCasting()||t.setItem(t.StorageKeys.PLAYBACK_RATE,e.playbackRate)}))}}],(n=null)&&ht(r.prototype,n),a&&ht(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}($e);function kt(e){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kt(e)}function Et(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bt(n.key),n)}}function bt(e){var t=function(e,t){if("object"!=kt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==kt(t)?t:String(t)}!function(e,t,r){(t=vt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(_t,"StorageKeys",{PLAYBACK_RATE:"playbackRate"});var Tt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"init",value:function(){e._value="".concat(p.Utils.Generator.guid(),":").concat(p.Utils.Generator.guid())}},{key:"next",value:function(){if(!e._value)return this.init(),e._value;var t=e._value,r=/:((?:[a-z0-9]|-)*)/i.exec(t);return r&&r[1]&&(e._value=t.replace(r[1],p.Utils.Generator.guid())),t}}],(r=null)&&Et(t.prototype,r),n&&Et(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function At(e){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(e)}function St(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pt(n.key),n)}}function Pt(e){var t=function(e,t){if("object"!=At(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=At(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==At(t)?t:String(t)}!function(e,t,r){(t=bt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Tt,"_value","");var Ct=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uiConfId=""}var t,r,n;return t=e,n=[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}],(r=[{key:"setUiConfId",value:function(e){this.uiConfId=e}},{key:"getUiConfId",value:function(){return this.uiConfId}}])&&St(t.prototype,r),n&&St(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function It(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}(e,t)||Rt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wt(e){return function(e){if(Array.isArray(e))return Mt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Rt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(e,t){if(e){if("string"==typeof e)return Mt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mt(e,t):void 0}}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(r),!0).forEach((function(t){Lt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lt(e,t,r){var n;return n=function(e,t){if("object"!=xt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==xt(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Nt=[],Ut="kaltura-player-container",jt="debugKalturaPlayer",Bt="kalturaStartTime",Ft="kalturaEndTime",Vt="kalturaSeekFrom",Gt="kalturaClipTo",Ht=2504201,Kt="https://analytics.kaltura.com/api_v3/index.php?service=analytics&action=trackEvent&apiVersion=3.3.0&format=1&eventType=1&partnerId=".concat(Ht,"&entryId=1_3bwzbc9o&&eventIndex=1&position=0"),Wt=[],$t=1e3,zt=[],qt=function(e,t){Wt.forEach((function(r){r(e,Ot(Ot({},t),{},{level:p.LogLevel.INFO}))}))};function Yt(e){if(!e)throw new Error(Re.INITIAL_CONFIG_REQUIRED);!function(e){if(!e)throw new Error(Re.TARGET_ID_REQUIRED);var t=document.getElementById(e);if(!t)throw new Error(Re.DOM_ELEMENT_WITH_TARGET_ID_REQUIRED+e);if(t.getElementsByClassName(Ut).length>0)throw new Error(Re.TARGET_ID_ALREADY_USED+e)}(e.targetId)}function Xt(e){function t(e,t){var r=wt(e).map((function(e){try{return"string"==typeof e?e:JSON.stringify(e)}catch(t){return e}})).join(" ");return"[".concat(t.name,"] ").concat(r)}p.Utils.Object.getPropertyPath(e,"ui.log")||p.Utils.Object.createPropertyPath(e,"ui.log",{}),p.Utils.Object.getPropertyPath(e,"provider.log")||p.Utils.Object.createPropertyPath(e,"provider.log",{}),p.Utils.Object.getPropertyPath(e,"log")||p.Utils.Object.createPropertyPath(e,"log",{}),void 0===p.Utils.Object.getPropertyPath(e,"log.useDebugInfo")&&(e.log.useDebugInfo=!0),Wt.push((function(e,r){console.log(t(e,r))})),e.log&&e.log.useDebugInfo&&Wt.push((function(e,r){var n=t(e,r);zt.length===$t&&zt.shift(),zt.push("".concat((new Date).toLocaleString()," ").concat(n," \n"))})),e.log&&"function"==typeof e.log.handler&&Wt.push(e.log.handler),(0,p.setLogHandler)(qt),e.ui.log.handler=e.provider.log.handler=qt;var r=p.LogLevel.ERROR;!e.log||!0!==window.DEBUG_KALTURA_PLAYER&&""!==Zt(jt)?e.log&&e.log.level&&p.LogLevel[e.log.level]&&(r=p.LogLevel[e.log.level]):(r=p.LogLevel.DEBUG,e.log.level=p.LogLevel.DEBUG.name),e.ui.log.level=e.provider.log.level=r.name,(0,p.setLogLevel)(r)}function Zt(e){var t;window.URLSearchParams?t=new URLSearchParams(window.location.search).get(e):t=function(e){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search),r=location.search.indexOf(e)>-1;return null===t?r?"":null:decodeURIComponent(t[1].replace(/\+/g," "))}(e);return t}function Qt(){var e,t=Ct.getInstance().getUiConfId();return""!==t&&window.KalturaPlayers&&null!==(e=window.KalturaPlayers[t])&&void 0!==e&&e.config?window.KalturaPlayers[t].config:window.__kalturaplayerdata||{}}function Jt(e){var t=function(e){var t=document.createElement("div");t.id=p.Utils.Generator.uniqueId(5),t.className=Ut,t.setAttribute("tabindex","-1");var r=document.getElementById(e);return r&&t&&r.appendChild(t),t.id}(e.targetId),r={targetId:e.targetId,provider:{partnerId:e.provider.partnerId},ui:{targetId:t},plugins:{},advertising:{adBreaks:[]},viewability:{observedThresholds:ct,playerThreshold:dt}};if(p.Utils.Object.mergeDeep(r,e),!e.provider.ignoreServerConfig){var n=p.Utils.Object.copyDeep(Qt());delete n.productVersion,r=p.Utils.Object.mergeDeep({},er(n),r)}return function(e){if(p.Env.isMacOS&&p.Env.isSafari||p.Env.isIOS){"boolean"!=typeof p.Utils.Object.getPropertyPath(e,"playback.preferNative.hls")&&p.Utils.Object.mergeDeep(e,{playback:{preferNative:{hls:!0}}})}}(r),function(e){if(p.Env.isMacOS&&p.Env.isSafari||p.Env.isIOS){"boolean"!=typeof p.Utils.Object.getPropertyPath(e,"text.useNativeTextTrack")&&p.Utils.Object.mergeDeep(e,{text:{useNativeTextTrack:!0}})}}(r),function(e){var t=p.Utils.Object.getPropertyPath(e,"plugins.kava");t||(t=p.Utils.Object.mergeDeep(e,{plugins:{kava:{}}}))}(r),function(e){if(p.Env.isSmartTV){if((0,p.setCapabilities)(p.EngineType.HTML5,{autoplay:!0}),function(e){var t=p.Utils.Object.getPropertyPath(e,"playback.playAdsWithMSE");"boolean"!=typeof t&&(e=p.Utils.Object.createPropertyPath(e,"playback.playAdsWithMSE",!0));var r=p.Utils.Object.getPropertyPath(e,"plugins.ima.disableMediaPreload"),n=p.Utils.Object.getPropertyPath(e,"plugins.bumper.disableMediaPreload");e.plugins&&e.plugins.ima&&"boolean"!=typeof r&&(e=p.Utils.Object.createPropertyPath(e,"plugins.ima.disableMediaPreload",!0));e.plugins&&e.plugins.bumper&&"boolean"!=typeof n&&(e=p.Utils.Object.createPropertyPath(e,"plugins.bumper.disableMediaPreload",!0))}(e),function(e){var t=p.Utils.Object.getPropertyPath(e,"playback.options.html5.hls.liveSyncDurationCount");"boolean"!=typeof t&&p.Env.isSafari&&(e=p.Utils.Object.createPropertyPath(e,"playback.options.html5.hls.liveSyncDurationCount",2))}(e),e.plugins&&e.plugins.ima){var t=p.Utils.Object.getPropertyPath(e,"plugins.ima.forceReloadMediaAfterAds"),r=p.Utils.Object.getPropertyPath(e,"plugins.ima.delayInitUntilSourceSelected");"boolean"!=typeof t&&(e=p.Utils.Object.createPropertyPath(e,"plugins.ima.forceReloadMediaAfterAds",!0)),"boolean"!=typeof r&&(e=p.Utils.Object.createPropertyPath(e,"plugins.ima.delayInitUntilSourceSelected",!0))}if(e.plugins&&e.plugins.youbora)"number"!=typeof p.Utils.Object.getPropertyPath(e,"plugins.youbora.playheadMonitorInterval")&&(e=p.Utils.Object.createPropertyPath(e,"plugins.youbora.playheadMonitorInterval",2e3));"boolean"!=typeof p.Utils.Object.getPropertyPath(e,"streaming.lowLatencyMode")&&(e=p.Utils.Object.createPropertyPath(e,"streaming.lowLatencyMode",!1))}}(r),function(e){if("Edge"===p.Env.browser.name){p.Utils.Object.getPropertyPath(e,"drm.keySystem")||(e="Windows"===p.Env.os.name?p.Utils.Object.createPropertyPath(e,"drm.keySystem",p.DrmScheme.PLAYREADY):p.Utils.Object.createPropertyPath(e,"drm.keySystem",p.DrmScheme.WIDEVINE))}}(r),function(e){if(p.Env.isIOS&&e.plugins&&e.plugins.ima&&!e.plugins.ima.disable){var t=p.Utils.Object.getPropertyPath(e,"playback.playsinline"),r=p.Utils.Object.getPropertyPath(e,"plugins.ima.disableMediaPreload");!1===t&&"boolean"!=typeof r&&p.Utils.Object.createPropertyPath(e,"plugins.ima.disableMediaPreload",!0)}}(r),function(e){if(e.plugins&&e.plugins.imadai&&!e.plugins.imadai.disable){"boolean"!=typeof p.Utils.Object.getPropertyPath(e,"playback.options.html5.hls.autoStartLoad")&&p.Utils.Object.mergeDeep(e,{playback:{options:{html5:{hls:{autoStartLoad:!1}}}}})}}(r),function(e){var t=p.Utils.Object.getPropertyPath(e,"plugins.bumper"),r=p.Utils.Object.getPropertyPath(e,"plugins.imadai");if(t){var n={};"boolean"!=typeof t.playOnMainVideoTag&&(p.Env.isSmartTV||p.Env.isIOS&&e.playback&&!1===e.playback.playsinline)&&(n.playOnMainVideoTag=!0),r&&!r.disable&&(Array.isArray(t.position)||(n.position=[0]),"boolean"!=typeof t.disableMediaPreload&&(n.disableMediaPreload=!0)),p.Utils.Object.mergeDeep(e,{plugins:{bumper:n}})}}(r),function(e){var t=p.Utils.Object.getPropertyPath(e,"plugins.vr");if(t&&!t.disable){"boolean"!=typeof p.Utils.Object.getPropertyPath(e,"playback.inBrowserFullscreen")&&p.Utils.Object.mergeDeep(e,{playback:{inBrowserFullscreen:!0}})}}(r),function(e){if(p.Env.isIOS){var t=!1!==p.Utils.Object.getPropertyPath(e,"playback.playsinline");p.Utils.Object.hasPropertyPath(e,"plugins.airplay")?(0,p.setCapabilities)(p.EngineType.HTML5,{autoplay:!1,mutedAutoPlay:t}):"iPhone"!==p.Env.device.model||t||(0,p.setCapabilities)(p.EngineType.HTML5,{autoplay:!1,mutedAutoPlay:!1})}}(r),r}function er(e){return function(){if(e.player){Nt.push({level:"warn",msg:"Path config.player will be deprecated soon. Please update your config structure as describe here: ".concat("https://github.com/kaltura/kaltura-player-js/blob/master/docs/configuration.md")});var t=p.Utils.Object.copyDeep(e.player);delete e.player,p.Utils.Object.mergeDeep(e,t)}}(),[["duration","sources.duration"],["type","sources.type"],["dvr","sources.dvr"],["id","sources.id"],["name","metadata.name"],["metadata.poster","sources.poster"],["metadata","sources.metadata"],["logLevel","log.level"],["ui.components.fullscreen.inBrowserFullscreenForIOS","playback.inBrowserFullscreen"],["playback.enableCEA708Captions","text.enableCEA708Captions"],["playback.useNativeTextTrack","text.useNativeTextTrack"],["playback.options.html5.dash.useShakaTextTrackDisplay","text.useShakaTextTrackDisplay"],["playback.captionsTextTrack1Label","text.captionsTextTrack1Label"],["playback.captionsTextTrack1LanguageCode","text.captionsTextTrack1LanguageCode"],["playback.captionsTextTrack2Label","text.captionsTextTrack2Label"],["playback.captionsTextTrack2LanguageCode","text.captionsTextTrack2LanguageCode"],["plugins.visibility.threshold","viewability.playerThreshold"],["plugins.visibility.floating","plugins.floating"],["playback.startTime","sources.startTime"]].forEach((function(t){return function(t,r){if(p.Utils.Object.hasPropertyPath(e,t))if(Nt.push({level:"warn",msg:"Path config.player.".concat(t," will be deprecated soon. Please update your config structure as describe here: ").concat("https://github.com/kaltura/kaltura-player-js/blob/master/docs/configuration.md")}),p.Utils.Object.hasPropertyPath(e,r))p.Utils.Object.deletePropertyPath(e,t);else{var n=p.Utils.Object.getPropertyPath(e,t),a=p.Utils.Object.createPropertyPath({},r,n);p.Utils.Object.mergeDeep(e,a),p.Utils.Object.deletePropertyPath(e,t)}}(t[0],t[1])})),e}function tr(e,t,r){var n=e.config.playback,a=!1;return n.streamPriority.forEach((function(e){e.engine===t&&(a=!0)})),a||n.streamPriority.push({engine:t,format:r}),n}function rr(e){var t=e&&e.progressive;return!(!t||!t[0]||"video/youtube"!==t[0].mimetype)}function nr(e){var t=e&&e.image;return!(!t||!t[0])}function ar(e){var t=e&&e.document;return!(!t||!t[0])}function ir(e,t){var r={},n={};return p.Utils.Object.isObject(e)&&Object.entries(e).forEach((function(e){var a=It(e,2),i=a[0],s=a[1];r[i]={},n[i]={},Object.entries(s).forEach((function(e){var a=It(e,2),s=a[0],o=a[1],l=p.Utils.Object.getPropertyPath(t[i],s);r[i][s]=l||o,n[i][s]=l}))})),[r,n]}var sr="playSessionId=",or="referrer=",lr="uiConfId=",ur="clientTag=html5:v",cr="kaltura.com",dr="custom_data=",pr="signature=",hr="seekFrom=",fr="clipTo=";function mr(e,t){var r,n,a;e.config.session&&e.config.session.id?function(e,t){var r,n,a=null===(r=t.sources)||void 0===r?void 0:r.id;if(null!=e&&null!==(n=e.playlist)&&void 0!==n&&null!==(n=n.items)&&void 0!==n&&n.length){if(a){var i;if(null!==(i=e.sessionIdCache)&&void 0!==i&&i.get(a)){var s;gr(t,null===(s=e.sessionIdCache)||void 0===s?void 0:s.get(a))}else{var o,l=Tt.next();null===(o=e.sessionIdCache)||void 0===o||o.set(a,l),gr(t,l)}}}else gr(t,Tt.next())}(e,t):(function(e){gr(e,Tt.next())}(t),null!=e&&null!==(r=e.playlist)&&void 0!==r&&null!==(r=r.items)&&void 0!==r&&r.length&&null!==(n=t.sources)&&void 0!==n&&n.id&&(null===(a=e.sessionIdCache)||void 0===a||a.set(t.sources.id,t.session.id)))}function gr(e,t){e.session=e.session||{},e.session.id=t}function yr(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sr;if(r){var a,i=new RegExp(n+"((?:[a-z0-9]|-)*:(?:[a-z0-9]|-)*)","i").exec(t);if(i&&i[1])null!=e&&null!==(a=e.playlist)&&void 0!==a&&null!==(a=a.items)&&void 0!==a&&a.length||(t=t.replace(i[1],r));else t+=kr(t)+n+r}return t}function vr(){var e;try{if((e=window.parent.document.URL).toLowerCase().includes("kaltura.com"))throw new Error("ignoring referrer:"+e)}catch(t){e=window.originalRequestReferrer||document.referrer}return e}function _r(e){if(-1===e.indexOf(or)){var t=btoa(vr().substr(0,1e3));e+=kr(e)+or+t}return e}function kr(e){return-1===e.indexOf("?")?"?":"&"}function Er(e,t){return-1===e.indexOf(ur)&&(e+=kr(e)+ur+(t||"3.17.61")),e}function br(e,t){var r=p.Utils.Object.getPropertyPath(t,"seekFrom"),n=p.Utils.Object.getPropertyPath(t,"clipTo");return"number"==typeof r&&-1===e.indexOf(hr)&&(e+=kr(e)+hr+Math.floor(1e3*r)),"number"==typeof n&&-1===e.indexOf(fr)&&(e+=kr(e)+fr+Math.floor(1e3*n)),e}function Tr(e,t){var r;mr(e,t);var n=t.sources,a=t.session&&t.session.id,i=null===(r=Qt())||void 0===r?void 0:r.productVersion;Object.values(p.StreamType).forEach((function(r){n[r]&&n[r].forEach((function(r){"string"==typeof r.url&&r.url.toLowerCase().indexOf("playmanifest/")>-1&&!r.localSource&&(r.url=yr(e,r.url,a),r.url=_r(r.url),r.url=Er(r.url,i),r.url=br(r.url,n)),r.drmData&&r.drmData.length&&r.drmData.forEach((function(r){"string"==typeof r.licenseUrl&&[cr,dr,pr].every((function(e){return r.licenseUrl.includes(e)}))&&(r.licenseUrl=yr(e,r.licenseUrl,a,"sessionId="),r.licenseUrl=Er(r.licenseUrl,i),r.licenseUrl=_r(r.licenseUrl),r.licenseUrl=function(e,t){var r=p.Utils.Object.getPropertyPath(t,"provider.uiConfId");return-1===e.indexOf(lr)&&"number"==typeof r&&(e+=kr(e)+lr+r),e}(r.licenseUrl,t))}))}))}))}function Ar(e){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ar(e)}function Sr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pr(n.key),n)}}function Pr(e){var t=function(e,t){if("object"!=Ar(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ar(t)?t:String(t)}function Cr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ir=(0,p.getLogger)("PluginsConfig"),wr=function(e){return("number"==typeof e||"function"==typeof e||"string"==typeof e||"boolean"==typeof e||p.Utils.Object.isClassInstance(e))&&!ge.test(e.toString())},Rr=function(e){return p.Utils.Object.isObject(e)&&"function"!=typeof e&&!p.Utils.Object.isClassInstance(e)},Mr=function(e){return e.map((function(e){if(Rr(e)){var t=Dr(e);return p.Utils.Object.isEmptyObject(t)?null:t}return wr(e)?e:null})).filter((function(e){return null!==e}))},Dr=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(t).reduce((function(t,r){var n=Cr(r,2),a=n[0],i=n[1];return Rr(i)?t[a]=e(i):Array.isArray(i)?t[a]=Mr(i):wr(i)&&(t[a]=i),t}),{})};var Or=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._pluginConfigStore=new Ce}var t,r,n;return t=e,r=[{key:"evaluatePluginsConfig",value:function(e,t){if(e){this._pluginConfigStore.set(e);var r=function(e){var t,r={pVersion:(null===(t=Qt())||void 0===t?void 0:t.productVersion)||"3.17.61",pName:"@playkit-js/kaltura-player-js"};if(e.targetId&&(r.domRootElementId=e.targetId),e.provider&&e.provider.env){r.serviceUrl=e.provider.env.serviceUrl;var n=p.Utils.Object.getPropertyPath(e,"provider.env.analyticsServiceUrl");n&&(r.analyticsServiceUrl="".concat(n,"/api_v3/index.php")),r.serviceUrl&&(r.embedBaseUrl=r.serviceUrl.replace("api_v3",""))}var a,i={referrer:vr(),encodedReferrer:(a=vr(),encodeURIComponent(a))};e.provider&&p.Utils.Object.mergeDeep(i,{ks:e.provider.ks,uiConfId:e.provider.uiConfId,partnerId:e.provider.partnerId}),e.session&&p.Utils.Object.mergeDeep(i,{sessionId:e.session.id,ks:e.session.ks,isAnonymous:e.session.isAnonymous,uiConfId:e.session.uiConfId,partnerId:e.session.partnerId}),e.sources&&p.Utils.Object.mergeDeep(i,{entryId:e.sources.id,entryName:e.sources.metadata&&e.sources.metadata.name,entryType:e.sources.type}),e.playlist&&p.Utils.Object.mergeDeep(i,{playlistId:e.playlist.id}),Object.keys(i).forEach((function(e){void 0===i[e]&&delete i[e]})),p.Utils.Object.mergeDeep(r,i);var s=e.uiConfData;return s&&(r.embedWidth=s.width,r.embedHeight=s.height),r}(t),n=p.Utils.Object.mergeDeep({},this._pluginConfigStore.get(),e),a=function(e){var t,r;e=(r=e)?r.replace(/\\n/g,"\\n").replace(/\\'/g,"\\'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f").replace(/[\u0000-\u0019]+/g,""):"";try{t=JSON.parse(e,(function(e){try{return JSON.parse(this[e])}catch(t){return this[e]}}))}catch(e){Ir.error("An error occurred while formatting config string.",e),t={}}return t}(xe(JSON.stringify(n),r));!function(e,t){var r=Dr(t),n=Dr(e);n&&r&&Object.keys(e).forEach((function(t){e&&e[t]&&(e[t]=p.Utils.Object.mergeDeep({},r[t],n[t]))}))}(e,a)}}}],r&&Sr(t.prototype,r),n&&Sr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Lr(e){return Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lr(e)}function Nr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hr(n.key),n)}}function Ur(e,t,r){return t=Br(t),function(e,t){if(t&&("object"===Lr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fr(e)}(e,jr()?Reflect.construct(t,r||[],Br(e).constructor):t.apply(e,r))}function jr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jr=function(){return!!e})()}function Br(e){return Br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Br(e)}function Fr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vr(e,t){return Vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vr(e,t)}function Gr(e,t,r){return(t=Hr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hr(e){var t=function(e,t){if("object"!=Lr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Lr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Lr(t)?t:String(t)}var Kr=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Gr(Fr(r=Ur(this,t)),"id","PluginReadinessMiddleware"),r._plugins=e,t._logger.debug("plugins readiness",r._plugins),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vr(e,t)}(t,e),r=t,(n=[{key:"load",value:function(e){this._checkNextSettle(0,e)}},{key:"_checkNextSettle",value:function(e,t){e<this._plugins.length?this._checkSettle(e,t):this.callNext(t)}},{key:"_checkSettle",value:function(e,r){var n=this;(this._plugins[e].ready?this._plugins[e].ready:Promise.resolve()).then((function(){t._logger.debug("plugin ".concat(n._plugins[e].name," ready promise resolved")),n._checkNextSettle(e+1,r)})).catch((function(){t._logger.debug("plugin ".concat(n._plugins[e].name," ready promise rejected")),n._checkNextSettle(e+1,r)}))}},{key:"play",value:function(e){this._checkNextSettle(0,e)}}])&&Nr(r.prototype,n),a&&Nr(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(p.BaseMiddleware);function Wr(e){return Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wr(e)}function $r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function zr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$r(Object(r),!0).forEach((function(t){Yr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$r(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xr(n.key),n)}}function Yr(e,t,r){return(t=Xr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xr(e){var t=function(e,t){if("object"!=Wr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Wr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wr(t)?t:String(t)}Gr(Kr,"_logger",(0,p.getLogger)("PluginReadinessMiddleware"));var Zr={thumbsWidth:164,thumbsHeight:92,thumbsSlices:100},Qr=/.*\/p\/\d+\/(?:[a-zA-Z]+\/\d+\/)*thumbnail\/entry_id\/\w+\/.*\d+/,Jr=function(){function e(t,r,n){var a=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Yr(this,"_isUsingKalturaThumbnail",(function(){return!(!a._thumbnailConfig||!a._thumbnailConfig.thumbsSprite)})),Yr(this,"_convertKalturaThumbnailToThumbnailInfo",(function(e){if(a._thumbnailConfig){var t=a._thumbnailConfig,r=t.thumbsSprite,n=t.thumbsWidth,i=t.thumbsSlices,s=a._player.duration/i,o={x:Math.floor(e/s)*n,y:0,url:r,height:a._thumbsHeight,width:n};return new p.ThumbnailInfo(o)}return null})),Yr(this,"_buildKalturaThumbnailConfig",(function(e,t){var r,n,i,s=p.Utils.Object.getPropertyPath(e,"components.seekbar"),o=null===(r=t.sources)||void 0===r?void 0:r.rawThumbnailUrl,l=(null===(n=t.sources)||void 0===n?void 0:n.type)===p.MediaType.VOD,u=a._player.shouldAddKs(t)?null===(i=t.session)||void 0===i?void 0:i.ks:"",c=p.Utils.Object.mergeDeep(Zr,s);return zr({thumbsSprite:l?a._getThumbSlicesUrl(o,u,c):""},c)})),Yr(this,"_maybeCutThumbnail",(function(e){var t=a._clipData,r=t.seekFrom,n=t.clipTo,i=e;return"number"==typeof r&&(i+="/start_sec/".concat(r)),"number"==typeof n&&(i+="/end_sec/".concat(n)),i})),Yr(this,"_getThumbSlicesUrl",(function(e,t,r){if("string"==typeof e&&Qr.test(e))try{var n=zr({thumbnailUrl:e},r),i=xe("{{thumbnailUrl}}/width/{{thumbsWidth}}/vid_slices/{{thumbsSlices}}",n),s=a._maybeCutThumbnail(i);return t?s+"/ks/".concat(t):s}catch(e){return""}return""})),this._player=t,this._clipData=this._buildClipData(n),this._thumbnailConfig=this._buildKalturaThumbnailConfig(r,n),this._eventManager=new p.EventManager,this._isUsingKalturaThumbnail()){var i,s=new Image;this._eventManager.listenOnce(s,"load",(function(){a._thumbsHeight=s.naturalHeight})),s.src=(null===(i=this._thumbnailConfig)||void 0===i?void 0:i.thumbsSprite)||""}}var t,r,n;return t=e,(r=[{key:"_buildClipData",value:function(e){return{seekFrom:e.sources.seekFrom||p.Utils.Object.getPropertyPath(this._player.config.sources,"seekFrom"),clipTo:e.sources.clipTo||p.Utils.Object.getPropertyPath(this._player.config.sources,"clipTo")}}},{key:"destroy",value:function(){this._eventManager.destroy()}},{key:"getThumbnail",value:function(e){return this._isUsingKalturaThumbnail()?this._convertKalturaThumbnailToThumbnailInfo(e):this._player._localPlayer.getThumbnail(e)}},{key:"getKalturaThumbnailConfig",value:function(){return this._thumbnailConfig}}])&&qr(t.prototype,r),n&&qr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function en(e){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},en(e)}function tn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rn(n.key),n)}}function rn(e){var t=function(e,t){if("object"!=en(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=en(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==en(t)?t:String(t)}var nn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t}var t,r,n;return t=e,(r=[{key:"_addTextTrack",value:function(){this._textTrack=this._player.addTextTrack(p.PKTextTrack.KIND.METADATA,"CuePoints")}},{key:"_getMetadataTracks",value:function(){return this._player.getNativeTextTracks().filter((function(e){return e.kind===p.PKTextTrack.KIND.METADATA&&e.cues}))}},{key:"_createTextTrackCue",value:function(e){var t=e.startTime,r=e.endTime,n=e.id,a=e.metadata;return(0,p.createTextTrackCue)({startTime:t,endTime:r,id:n,type:p.TimedMetadata.TYPE.CUE_POINT,metadata:a})}},{key:"_cuesSorter",value:function(e,t){return e.startTime-t.startTime}},{key:"getAllCuePoints",value:function(){return this._getMetadataTracks().reduce((function(e,t){return e.concat(Array.from(t.cues).map((function(e){return(0,p.createTimedMetadata)(e)})))}),[]).sort(this._cuesSorter)}},{key:"getActiveCuePoints",value:function(){return this._getMetadataTracks().reduce((function(e,t){return e.concat(Array.from(t.activeCues).map((function(e){return(0,p.createTimedMetadata)(e)})))}),[]).sort(this._cuesSorter)}},{key:"_getTextTrackCueById",value:function(e){var t=null;return this._getMetadataTracks().some((function(r){return t=r.cues.getCueById(e)})),t}},{key:"_removeTextTrackCue",value:function(e){try{var t;null===(t=e.track)||void 0===t||t.removeCue(e)}catch(e){}}},{key:"addCuePoints",value:function(e){var t=this;this._player.ready().then((function(){t._textTrack||t._addTextTrack();var r=[];e.forEach((function(e){var n,a=t._createTextTrackCue(e),i=t._getTextTrackCueById(e.id);i&&t._removeTextTrackCue(i),null===(n=t._textTrack)||void 0===n||n.addCue(a),r.push((0,p.createTimedMetadata)(a))})),t._player.dispatchEvent(new p.FakeEvent(p.EventType.TIMED_METADATA_ADDED,{cues:r}))}))}},{key:"_clearAllTextTrackCues",value:function(){var e=this;this._getMetadataTracks().forEach((function(t){for(;t.cues.length;)e._removeTextTrackCue(t.cues[0])}))}},{key:"reset",value:function(){this._clearAllTextTrackCues()}},{key:"destroy",value:function(){this.reset()}}])&&tn(t.prototype,r),n&&tn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function an(e){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},an(e)}function sn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,on(n.key),n)}}function on(e){var t=function(e,t){if("object"!=an(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=an(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==an(t)?t:String(t)}var ln=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,r){(t=on(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"_servicesRegistry",new Map),e._logger=(0,p.getLogger)("ServiceProvider"),this._eventManager=new p.EventManager,this._eventManager.listen(t,t.Event.Core.PLAYER_RESET,(function(){return r.reset()}))}var t,r,n;return t=e,(r=[{key:"register",value:function(t,r){this._servicesRegistry.has(t)?e._logger.debug("".concat(t," service already exists")):(this._servicesRegistry.set(t,r),e._logger.debug("".concat(t," service registered")))}},{key:"get",value:function(e){return this._servicesRegistry.get(e)}},{key:"has",value:function(e){return this._servicesRegistry.has(e)}},{key:"reset",value:function(){this._servicesRegistry.forEach((function(e){return"function"==typeof e.reset&&e.reset()}))}},{key:"destroy",value:function(){this._servicesRegistry.forEach((function(e){return"function"==typeof e.destroy&&e.destroy()})),this._eventManager.removeAll(),this._servicesRegistry.clear()}}])&&sn(t.prototype,r),n&&sn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),un="kaltura-player",cn={PLAYLIST_LOADED:"".concat(un,"-playlistloaded"),PLAYLIST_ITEM_CHANGED:"".concat(un,"-playlistitemchanged"),PLAYLIST_ENDED:"".concat(un,"-playlistended")};function dn(e){return dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(e)}function pn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hn(n.key),n)}}function hn(e){var t=function(e,t){if("object"!=dn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=dn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dn(t)?t:String(t)}var fn=["hls","dash","progressive","image","document"],mn=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._sources=t,this._config=r,this._index=n}var t,r,n;return t=e,(r=[{key:"updateSources",value:function(e){this._sources=p.Utils.Object.mergeDeep({},e)}},{key:"updatePlugins",value:function(e){this._plugins=p.Utils.Object.copyDeep(e)}},{key:"sources",get:function(){var e=this;return fn.forEach((function(t){e._sources&&e._sources[t]&&0===e._sources[t].length&&delete e._sources[t]})),this._sources}},{key:"config",get:function(){return this._config}},{key:"plugins",get:function(){return this._plugins||{}}},{key:"index",get:function(){return this._index}},{key:"isPlayable",value:function(){var e=this;return!!fn.find((function(t){return e._sources&&e._sources[t]&&e._sources[t].length}))}}])&&pn(t.prototype,r),n&&pn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function gn(e){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gn(e)}function yn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vn(n.key),n)}}function vn(e){var t=function(e,t){if("object"!=gn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=gn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gn(t)?t:String(t)}var _n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id="",this._metadata={name:"",description:""},this._poster="",this._items=[],this._activeItemIndex=-1}var t,r,n;return t=e,(r=[{key:"configure",value:function(e,t){var r=this;this._id=e.id?e.id:this._id,this._poster=e.poster?e.poster:this._poster,this._metadata=e.metadata?e.metadata:this._metadata,e.items&&(this._items=[],e.items.forEach((function(e,n){if(e.sources){var a=p.Utils.Object.mergeDeep({},t),i=e.sources.options||{};e.sources.options=p.Utils.Object.mergeDeep(a,i)}r._items.push(new mn(e.sources,e.config,n))})))}},{key:"updateItemSources",value:function(e,t){this._items[e].updateSources(t)}},{key:"updateItemPlugins",value:function(e,t){this._items[e].updatePlugins(t)}},{key:"id",get:function(){return this._id}},{key:"items",get:function(){return this._items}},{key:"metadata",get:function(){return this._metadata}},{key:"poster",get:function(){return this._poster}},{key:"current",get:function(){return this._items[this._activeItemIndex]||null}},{key:"getNext",value:function(e){var t=e?(this._activeItemIndex+1)%this._items.length:this._activeItemIndex+1;return this._items[t]||null}},{key:"prev",get:function(){return this._items[this._activeItemIndex-1]||null}},{key:"activeItemIndex",set:function(e){this._activeItemIndex=e}}])&&yn(t.prototype,r),n&&yn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function kn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return En(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return En(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function En(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bn(e){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bn(e)}function Tn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,An(n.key),n)}}function An(e){var t=function(e,t){if("object"!=bn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bn(t)?t:String(t)}var Sn=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this._eventManager=new p.EventManager,this._playlist=new _n,this._options={autoContinue:!0,loop:!1,imageDuration:5,documentDuration:10},this._countdown={duration:10,showing:!0},this._mediaInfoList=[],this._playerOptions=r,this._appPluginConfig={}}var t,r,n;return t=e,r=[{key:"configure",value:function(e,t){if(e&&(this._playlist.configure(e,p.Utils.Object.getPropertyPath(this._player.sources,"options")),p.Utils.Object.mergeDeep(this._options,e.options),p.Utils.Object.mergeDeep(this._countdown,e.countdown),e.items&&e.items.find((function(e){return!!e.sources})))){var r;this._mediaInfoList=e.items.map((function(e,r){return t&&t.entries&&"object"===bn(t.entries[r])?t.entries[r]:{entryId:e.sources.id}})),this._player.dispatchEvent(new p.FakeEvent(cn.PLAYLIST_LOADED,{playlist:this})),this._addBindings();var n=null===(r=e.options)||void 0===r?void 0:r.startAtEntryId,a=!1;if(n&&"string"==typeof n){var i=this._playlist.items.find((function(e){return e.sources.id===n}));i&&(a=!0,this.playItem(i.index))}a||this.playNext()}}},{key:"load",value:function(e,t,r){var n=this._getMergedPlaylistData(e,t);this.configure(n,r)}},{key:"reset",value:function(){this._eventManager.removeAll(),this._playlist=new _n,this._mediaInfoList=[]}},{key:"playNext",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this._player.clearReset(),e._logger.debug("playNext");var t=this._playlist.getNext(!0);t&&this._setItem(t)}},{key:"playPrev",value:function(){e._logger.debug("playPrev");var t=this._playlist.prev;t&&this._setItem(t)}},{key:"playItem",value:function(t){e._logger.debug("playItem(".concat(t,")"));var r=this._playlist.items[t];r&&this._setItem(r)}},{key:"items",get:function(){return this._playlist.items}},{key:"current",get:function(){return this._playlist.current}},{key:"next",get:function(){return this._playlist.getNext(this._options.loop)}},{key:"prev",get:function(){return this._playlist.prev}},{key:"id",get:function(){return this._playlist.id}},{key:"metadata",get:function(){return this._playlist.metadata}},{key:"poster",get:function(){return this._playlist.poster}},{key:"countdown",get:function(){if(this._playlist.current&&this._playlist.current.config){var e={duration:10,showing:!0};return p.Utils.Object.mergeDeep(e,this._countdown,this._playlist.current.config.countdown),e}return this._countdown}},{key:"options",get:function(){return this._options}},{key:"_getMergedPlaylistData",value:function(e,t){var r=this;return{id:e.id,metadata:e.metadata,poster:e.poster,options:t?t.options:this._options,countdown:t?t.countdown:this.countdown,items:e.items.map((function(e,n){var a,i=p.Utils.Object.copyDeep(e);return i.sources.mediaEntryType=null==e||null===(a=e.sources)||void 0===a?void 0:a.type,["sources.dvr","sources.type"].forEach((function(e){p.Utils.Object.deletePropertyPath(i,e)})),p.Utils.Object.mergeDeep(i.sources,t&&t.items&&t.items[n]&&t.items[n].sources),Array.isArray(i.sources.poster)&&r._player.updateKalturaPoster(i.sources,e.sources,r._player.dimensions),{sources:i.sources,config:t&&t.items&&t.items[n]&&t.items[n].config}}))}}},{key:"_addBindings",value:function(){var e=this;this._eventManager.listen(this._player,this._player.Event.Core.PLAYBACK_ENDED,(function(){return e._onPlaybackEnded()})),this._eventManager.listen(this._player,this._player.Event.Core.CHANGE_SOURCE_STARTED,(function(){return e._onChangeSourceStarted()}))}},{key:"_onPlaybackEnded",value:function(){var e=this._playlist.getNext(!1);e||this._player.dispatchEvent(new p.FakeEvent(cn.PLAYLIST_ENDED)),!this._playerOptions.ui.disable&&this.countdown.showing||(e&&this._options.autoContinue||this._options.loop)&&this.playNext()}},{key:"_onChangeSourceStarted",value:function(){this._player.isImage()?this._player.configure({sources:{duration:this._options.imageDuration}}):this._player.isDocument()&&this._player.configure({sources:{duration:this._options.documentDuration}})}},{key:"_setItem",value:function(t){var r=this,n=t.index;e._logger.debug("Playing item number ".concat(n),t);var a={loop:!1};if(this._playlist.current&&(this._player._playbackStart?a.autoplay=!0:a.autoplay=!!this._playerOptions.playback.autoplay),this._player.configure({playback:a}),this._playlist.activeItemIndex=n,Promise.all(this.getEntryPromises([n-1,n+1])).then((function(e){var t,n=[],a=kn(e);try{for(a.s();!(t=a.n()).done;){var i,s=t.value;null!==(i=s.sources.dash)&&void 0!==i&&i.length&&(n=n.concat(s.sources.dash.map((function(e){return e.url}))))}}catch(e){a.e(e)}finally{a.f()}r._player.setCachedUrls(n)})),t.isPlayable()){var i,s;this._resetProviderPluginsConfig();var o=ir(t.plugins,this._player.config.plugins),l=o[0];this._appPluginConfig=o[1];var u={session:this._player.config.session,plugins:l,sources:t.sources};return this._player.setMedia(u),this._player.dispatchEvent(new p.FakeEvent(cn.PLAYLIST_ITEM_CHANGED,{index:n,activeItem:t,entryId:(null===(i=this._mediaInfoList[n])||void 0===i?void 0:i.entryId)||(null===(s=t.sources)||void 0===s?void 0:s.id)})),Promise.resolve()}if(this._mediaInfoList[n]){this._resetProviderPluginsConfig();var c={sources:t.sources};return this._player.setMedia(c),this._player.loadMedia(this._mediaInfoList[n]).then((function(e){var a;r._playlist.updateItemSources(n,e.sources),r._playlist.updateItemPlugins(n,e.plugins);var i,s=null===(a=r._player.sessionIdCache)||void 0===a?void 0:a.get(e.sources.id);s||(s=Tt.next(),null===(i=r._player.sessionIdCache)||void 0===i||i.set(e.sources.id,s)),e.sources.dash=e.sources.dash.map((function(t){return t.url=yr(r._player,t.url,s),t.url=_r(t.url),t.url=Er(t.url,e.productVersion),t.url=br(t.url,e.sources),t})),r._player.dispatchEvent(new p.FakeEvent(cn.PLAYLIST_ITEM_CHANGED,{index:n,activeItem:t,entryId:r._mediaInfoList[n].entryId}))}))}return Promise.reject()}},{key:"_resetProviderPluginsConfig",value:function(){this._player.configure({plugins:this._appPluginConfig}),this._appPluginConfig={}}},{key:"destroy",value:function(){this._eventManager.destroy()}},{key:"getEntryPromise",value:function(e){var t=this;return this._playlist.items[e].isPlayable()?Promise.resolve({sources:this._playlist.items[e].sources}):this._player.provider.getMediaConfig(this._mediaInfoList[e]).then((function(r){var n,a=p.Utils.Object.copyDeep(r);t._playlist.updateItemSources(e,a.sources),t._playlist.updateItemPlugins(e,a.plugins);var i,s=null===(n=t._player.sessionIdCache)||void 0===n?void 0:n.get(a.sources.id);return s||(s=Tt.next(),null===(i=t._player.sessionIdCache)||void 0===i||i.set(a.sources.id,s)),a.sources.dash=a.sources.dash.map((function(e){return e.url=yr(t._player,e.url,s),e.url=_r(e.url),e.url=Er(e.url,a.productVersion),e.url=br(e.url,a.sources),e})),Promise.resolve(a)}))}},{key:"getEntryPromises",value:function(e){var t,r=[],n=kn(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,i=this._playlist.items[a];if(null!=i&&i.sources){var s=i.sources,o=s.type,l=s.mediaEntryType;o!==p.MediaType.VOD&&l!==p.MediaType.VOD||r.push(this.getEntryPromise(a))}}}catch(e){n.e(e)}finally{n.f()}return r}}],r&&Tn(t.prototype,r),n&&Tn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Pn(e){return Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pn(e)}function Cn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,In(n.key),n)}}function xn(e,t,r){return t&&Cn(e.prototype,t),r&&Cn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function In(e){var t=function(e,t){if("object"!=Pn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Pn(t)?t:String(t)}!function(e,t,r){(t=An(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Sn,"_logger",(0,p.getLogger)("PlaylistManager"));var wn=xn((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textStyle=t.textStyle,this.mediaInfo=t.getMediaInfo(),this.mediaConfig=t.getMediaConfig(),this.advertising=t.config.plugins&&t.config.plugins.ima,this.config=p.Utils.Object.mergeDeep({},t.config,{sources:{startTime:Rn(t)},playback:{autoplay:0===t.currentTime||!t.paused,audioLanguage:Mn(p.TrackType.AUDIO,t),textLanguage:Mn(p.TrackType.TEXT,t)}})}));function Rn(e){return e.isLive()?e.isDvr()?e.duration-e.currentTime<e.config.cast.dvrThreshold||!e.currentTime?-1:e.currentTime:-1:!e.isCasting()&&!e.currentTime&&e.config.sources.startTime>-1?e.config.sources.startTime:e.currentTime}function Mn(e,t){var r=t.getActiveTracks();if(r[e])return r[e].language;try{return t.config.playback["".concat(e,"Language")]}catch(e){return null}}var Dn="kaltura-player",On={CAST_SESSION_START_FAILED:"".concat(Dn,"-castsessionstartfailed"),CAST_SESSION_STARTING:"".concat(Dn,"-castsessionstarting"),CAST_SESSION_STARTED:"".concat(Dn,"-castsessionstarted"),CAST_SESSION_ENDING:"".concat(Dn,"-castsessionending"),CAST_SESSION_ENDED:"".concat(Dn,"-castsessionended"),CAST_AVAILABLE:"".concat(Dn,"-castavailable")};function Ln(e){return Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ln(e)}function Nn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jn(n.key),n)}}function Un(e,t,r){return t&&Nn(e.prototype,t),r&&Nn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jn(e){var t=function(e,t){if("object"!=Ln(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ln(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ln(t)?t:String(t)}var Bn=Un((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getPlayerSnapshot=$n.bind(t),this.getUIWrapper=qn.bind(t),this.onRemoteDeviceAvailable=Kn.bind(t),this.onRemoteDeviceConnected=Vn.bind(t),this.onRemoteDeviceDisconnected=Hn.bind(t),this.onRemoteDeviceConnecting=Fn.bind(t),this.onRemoteDeviceDisconnecting=Gn.bind(t),this.onRemoteDeviceConnectFailed=Wn.bind(t),this.getPlayerSelectedSource=zn.bind(t)}));function Fn(){Bn._logger.debug("onRemoteDeviceConnecting"),this.dispatchEvent(new p.FakeEvent(On.CAST_SESSION_STARTING))}function Vn(e){var t=this;Bn._logger.debug("onRemoteDeviceConnected",e);var r=e.player,n=e.ui,a=e.session;this._eventManager.removeAll(),Object.values(p.EventType).forEach((function(e){return t._eventManager.listen(r,e,(function(e){return t.dispatchEvent(e)}))}));var i=this.config;n&&p.Utils.Object.mergeDeep(i,{ui:{customPreset:n.uis}}),this.configure({playback:{muted:this.muted,volume:this.volume}}),this._localPlayer.reset(),this._uiWrapper.destroy(),this._remotePlayer=r,this._uiWrapper=new _(this,i),this.dispatchEvent(new p.FakeEvent(On.CAST_SESSION_STARTED,{session:a}))}function Gn(){Bn._logger.debug("onRemoteDeviceDisconnecting"),this.dispatchEvent(new p.FakeEvent(On.CAST_SESSION_ENDING))}function Hn(e){var t=this;Bn._logger.debug("onRemoteDeviceDisconnected",e);var r=e.player,n=e.snapshot;if(this._remotePlayer&&this._remotePlayer===r&&(this._eventManager.removeAll(),Yn.call(this,n),n)){this.dispatchEvent(new p.FakeEvent(On.CAST_SESSION_ENDED));var a,i=this.config,s=!n.config.playback.autoplay,o=n.mediaInfo,l=n.mediaConfig;n.config.playback.autoplay=!0,Xn.call(this,n.config),this._eventManager.listenOnce(this,this.Event.Core.CHANGE_SOURCE_ENDED,(function(){Zn.call(t,n.config.sources)})),o?a=this.loadMedia(o):l&&(a=Promise.resolve(),this.setMedia(l)),a&&a.then((function(){t._eventManager.listenOnce(t,t.Event.Core.FIRST_PLAYING,(function(){t.textStyle=n.textStyle,Xn.call(t,i),Qn.call(t,n.config.playback),s&&t.pause()}))}))}}function Kn(e){Bn._logger.debug("onRemoteDeviceAvailable",e);var t=e.player,r=e.available;this.dispatchEvent(new p.FakeEvent(On.CAST_AVAILABLE,{type:t.type,available:r}))}function Wn(){Bn._logger.debug("onRemoteDeviceConnectFailed"),this.dispatchEvent(new p.FakeEvent(On.CAST_SESSION_START_FAILED))}function $n(){var e=new wn(this);return Bn._logger.debug("getPlayerSnapshot",e),e}function zn(){var e=this._sourceSelected,t=null!=e&&e.url?e.url:window.sessionStorage.getItem("sourceUrl");return window.sessionStorage.setItem("sourceUrl",t),Bn._logger.debug("getPlayerSelectedSource",t),t}function qn(){return Bn._logger.debug("getUIWrapper"),this._uiWrapper}function Yn(e){var t=this;this._uiWrapper.destroy();var r=this._localPlayer.config;if(r.plugins&&r.plugins.ima){var n={};if(r.cast.advertising&&r.cast.advertising.vast){if(e.config.sources.startTime>0){var a=r.plugins.ima.adTagUrl;n={adTagUrl:""},this._eventManager.listen(this,p.EventType.FIRST_PLAYING,(function(){return t.configure({plugins:{ima:{adTagUrl:a}}})}))}}else n={delayInitUntilSourceSelected:!0};p.Utils.Object.mergeDeep(r,{plugins:{ima:n}}),this._localPlayer.destroy(),this._remotePlayer=null,this._localPlayer=(0,p.loadPlayer)(r)}else this._remotePlayer=null;Object.values(p.EventType).forEach((function(e){return t._eventManager.listen(t._localPlayer,e,(function(e){return t.dispatchEvent(e)}))})),this._uiWrapper=new _(this,this.config),this._uiWrapper.setConfig({isCastAvailable:this.isCastAvailable()},"engine")}function Xn(e){var t=e.sources.startTime,r=e.playback.autoplay;this.configure({sources:{startTime:t},playback:{autoplay:r}})}function Zn(e){var t;if(null!==(t=e.captions)&&void 0!==t&&t.length){var r=e.captions;this.configure({sources:{captions:r}})}}function Qn(e){if(e.audioLanguage){var t=this.getTracks(p.TrackType.AUDIO).find((function(t){return t.language===e.audioLanguage}));this.selectTrack(t)}if(e.textLanguage){var r=this.getTracks(p.TrackType.TEXT).find((function(t){return t.language===e.textLanguage}));this.selectTrack(r)}}function Jn(e){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jn(e)}function ea(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ra(n.key),n)}}function ta(e,t,r){return(t=ra(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ra(e){var t=function(e,t){if("object"!=Jn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Jn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Jn(t)?t:String(t)}!function(e,t,r){(t=jn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Bn,"_logger",(0,p.getLogger)("RemoteControl"));var na=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ta(this,"_remotePlayers",new Map)}var t,r,n;return t=e,n=[{key:"register",value:function(t,r){"function"==typeof r?e._registry.has(t)?e._logger.debug("Remote player of type ".concat(t," is already registered")):(e._logger.debug("Register remote player of type ".concat(t)),e._registry.set(t,r)):e._logger.debug("remote player must be instance of BaseRemotePlayer")}}],(r=[{key:"load",value:function(t,r){var n=this;e._registry.forEach((function(a,i){e._logger.debug("Load remote player of type ".concat(i));var s=new a(t,new Bn(r),r.config.targetId);n._remotePlayers.set(i,s)}))}},{key:"startCasting",value:function(t){e._logger.debug("Start casting");var r=this._getRemotePlayer(t);return r?r.startCasting():Promise.reject()}},{key:"isCastAvailable",value:function(t){var r=this._getRemotePlayer(t);return!!r&&(e._logger.debug("isCastAvailable: ".concat(r.isCastAvailable())),r.isCastAvailable())}},{key:"destroy",value:function(){var e=this._remotePlayers;Array.from(e.values()).forEach((function(e){return e.destroy()}))}},{key:"setIsCastInitiator",value:function(e,t){var r=this._getRemotePlayer(e);r&&(r.isCastInitiator=t)}},{key:"_getRemotePlayer",value:function(e){var t=this._remotePlayers;return e&&t.get(e)?t.get(e):t.size>0?Array.from(t.values())[0]:void 0}}])&&ea(t.prototype,r),n&&ea(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function aa(e){return aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aa(e)}function ia(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}(e,t)||oa(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sa(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=oa(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function oa(e,t){if(e){if("string"==typeof e)return la(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?la(e,t):void 0}}function la(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ua(){ua=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,s=Object.create(i.prototype),o=new w(n||[]);return a(s,"_invoke",{value:P(e,r,o)}),s}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",g={};function y(){}function v(){}function _(){}var k={};u(k,s,(function(){return this}));var E=Object.getPrototypeOf,b=E&&E(E(R([])));b&&b!==r&&n.call(b,s)&&(k=b);var T=_.prototype=y.prototype=Object.create(k);function A(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(a,i,s,o){var l=d(e[a],e,i);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==aa(c)&&n.call(c,"__await")?t.resolve(c.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):t.resolve(c).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,o)}))}o(l.arg)}var i;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function P(t,r,n){var a=p;return function(i,s){if(a===f)throw new Error("Generator is already running");if(a===m){if("throw"===i)throw s;return{value:e,done:!0}}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var l=C(o,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=f;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:h,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var s=i.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(aa(t)+" is not iterable")}return v.prototype=_,a(T,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:v,configurable:!0}),v.displayName=u(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},A(S.prototype),u(S.prototype,o,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var s=new S(c(e,r,n,a),i);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},A(T),u(T,l,"Generator"),u(T,s,(function(){return this})),u(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,w.prototype={constructor:w,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return o.type="throw",o.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;I(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function ca(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function da(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){ca(i,n,a,s,o,"next",e)}function o(e){ca(i,n,a,s,o,"throw",e)}s(void 0)}))}}ta(na,"_registry",new Map),ta(na,"_logger",(0,p.getLogger)("RemotePlayerManager"));var pa='video/mp4;codecs="avc1.42E01E"',ha=[["widevine","com.widevine.alpha"],["playready","com.microsoft.playready"],["fairplay","com.apple.fps"]],fa='video/mp4; codecs="hvc1.1.6.L150.90"',ma=1920,ga=1080,ya=12e5,va=30,_a=(0,p.getLogger)("MediaCapabilities"),ka={SUPPORTED:1,NOT_SUPPORTED:0,MAYBE_SUPPORTED:-1};function Ea(){return(Ea=da(ua().mark((function e(t){var r,n,a;return ua().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,_a.debug("Starting to get media capabilities..."),e.next=4,Aa(t);case 4:return n=e.sent,e.next=7,ba();case 7:return a=e.sent,r=Object.assign({},n,a),_a.debug("Finished getting media capabilities ",{mediaCapabilities:r}),e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(0),_a.debug("There was a problem with getting the media capabilities, ",e.t0.message),r={isHEVCSupported:ka.NOT_SUPPORTED,isPowerEfficient:ka.NOT_SUPPORTED,isDRMSupported:ka.NOT_SUPPORTED,supportedDRMs:[]},_a.debug("Returning media capabilities defaults ",{mediaCapabilities:r}),e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function ba(){return Ta.apply(this,arguments)}function Ta(){return(Ta=da(ua().mark((function e(){var t,r,n,a,i,s,o,l;return ua().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={isDRMSupported:ka.MAYBE_SUPPORTED,supportedDRMs:[]},navigator.requestMediaKeySystemAccess){e.next=3;break}return e.abrupt("return",t);case 3:r=[{initDataTypes:["cenc"],videoCapabilities:[{contentType:pa}]}],n=new Map(ha),a=sa(n),e.prev=6,a.s();case 8:if((i=a.n()).done){e.next=21;break}return s=ia(i.value,2),o=s[0],l=s[1],e.prev=10,e.next=13,navigator.requestMediaKeySystemAccess(l,r);case 13:t.supportedDRMs.push(o),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(10),_a.debug(l+" not supported ("+e.t0.name+": "+e.t0.message+").");case 19:e.next=8;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(6),a.e(e.t1);case 26:return e.prev=26,a.f(),e.finish(26);case 29:return t.isDRMSupported=t.supportedDRMs.length>0?ka.SUPPORTED:ka.NOT_SUPPORTED,e.abrupt("return",t);case 31:case"end":return e.stop()}}),e,null,[[6,23,26,29],[10,16]])})))).apply(this,arguments)}function Aa(e){return Sa.apply(this,arguments)}function Sa(){return(Sa=da(ua().mark((function e(t){var r,n,a;return ua().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={isHEVCSupported:ka.MAYBE_SUPPORTED,isPowerEfficient:ka.MAYBE_SUPPORTED},navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo){e.next=3;break}return e.abrupt("return",r);case 3:return n={type:"media-source",video:{contentType:fa,width:(null==t?void 0:t.width)||ma,height:(null==t?void 0:t.height)||ga,bitrate:(null==t?void 0:t.bitrate)||ya,framerate:(null==t?void 0:t.framerate)||va}},e.prev=4,e.next=7,navigator.mediaCapabilities.decodingInfo(n);case 7:a=e.sent,r.isHEVCSupported=a.supported?ka.SUPPORTED:ka.NOT_SUPPORTED,r.isPowerEfficient=a.powerEfficient?ka.SUPPORTED:ka.NOT_SUPPORTED,e.next=17;break;case 12:e.prev=12,e.t0=e.catch(4),_a.debug("Failed to get the media capabilities from navigator. ("+e.t0.name+": "+e.t0.message+")."),r.isHEVCSupported=ka.MAYBE_SUPPORTED,r.isPowerEfficient=ka.MAYBE_SUPPORTED;case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}const Pa=function(e){return Ea.apply(this,arguments)};function Ca(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ia=function(e){return 2===e.category},wa=function(e){return 2001===e.code},Ra=function(e){var t,r;return(null===(t=e.data)||void 0===t?void 0:t.messages)&&"COUNTRY_RESTRICTED"===(null===(r=e.data)||void 0===r?void 0:r.messages[0].code)},Ma=function(e){var t,r;return(null===(t=e.data)||void 0===t?void 0:t.messages)&&"SESSION_RESTRICTED"===(null===(r=e.data)||void 0===r?void 0:r.messages[0].code)},Da=function(e){var t,r;return(null===(t=e.data)||void 0===t?void 0:t.messages)&&"IP_RESTRICTED"===(null===(r=e.data)||void 0===r?void 0:r.messages[0].code)},Oa=function(e){var t,r;return(null===(t=e.data)||void 0===t?void 0:t.messages)&&"SITE_RESTRICTED"===(null===(r=e.data)||void 0===r?void 0:r.messages[0].code)},La=function(e){var t,r;return(null===(t=e.data)||void 0===t?void 0:t.messages)&&"SCHEDULED_RESTRICTED"===(null===(r=e.data)||void 0===r?void 0:r.messages[0].code)},Na=[[function(e){return Ia(e)&&wa(e)&&Ma(e)},p.Error.Category.MEDIA_UNAVAILABLE],[function(e){return Ia(e)&&wa(e)&&Ra(e)},p.Error.Category.GEO_LOCATION],[function(e){return Ia(e)&&function(e){return 2002===e.code}(e)},p.Error.Category.MEDIA_NOT_READY],[function(e){return Ia(e)&&wa(e)&&Da(e)},p.Error.Category.IP_RESTRICTED],[function(e){return Ia(e)&&function(e){return 2003===e.code}(e)&&La(e)},p.Error.Category.SCHEDULED_RESTRICTED],[function(e){return Ia(e)&&wa(e)&&Oa(e)},p.Error.Category.SITE_RESTRICTED],[function(e){return Ia(e)&&wa(e)&&!Ra(e)&&!Ma(e)&&!Da(e)&&!Oa(e)&&!La(e)},p.Error.Category.ACCESS_CONTROL_BLOCKED]];function Ua(e){return Ca(Na.find((function(t){return t[0](e)}))||[],2)[1]||p.Error.Category.PLAYER}function ja(e){return ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ja(e)}function Ba(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fa(n.key),n)}}function Fa(e){var t=function(e,t){if("object"!=ja(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ja(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ja(t)?t:String(t)}var Va=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,r){(t=Fa(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"cache",new Map)}var t,r,n;return t=e,r=[{key:"set",value:function(e,t){this.cache.set(e,t)}},{key:"get",value:function(e){return this.cache.get(e)}},{key:"clear",value:function(){this.cache.clear()}}],r&&Ba(t.prototype,r),n&&Ba(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ga(e){return Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ga(e)}function Ha(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ka(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ka(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw i}}}}function Ka(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$a(n.key),n)}}function $a(e){var t=function(e,t){if("object"!=Ga(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ga(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ga(t)?t:String(t)}var za=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"sourceMatches",value:function(t,r){if(r.deliveryProfileId&&r.format){var n=e.FORMATS[r.format];return t.id.endsWith("".concat(r.deliveryProfileId,",").concat(n))}return!1}},{key:"getFallbackOptionsByToSourceFormat",value:function(e){return e.reduce((function(e,t){var r=t.fromSource,n=t.toSource;return e[n.format]||(e[n.format]=[]),e[n.format].push({fromSource:r,toSource:n}),e}),{})}},{key:"splitSources",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r={},n={},a=this.getFallbackOptionsByToSourceFormat(t);for(var i in this.FORMATS){var s=e[i]||[];r[i]=[],n[i]=[];var o,l=Ha(s);try{for(l.s();!(o=l.n()).done;){var u,c=o.value,d=!1,p=Ha(a[i]||[]);try{for(p.s();!(u=p.n()).done;){var h=u.value.toSource;if(this.sourceMatches(c,h)){d=!0;break}}}catch(e){p.e(e)}finally{p.f()}d?n[i].push(c):r[i].push(c)}}catch(e){l.e(e)}finally{l.f()}}return{fallbackSources:n,nonFallbackSources:r}}},{key:"getMatchingFallbackSources",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n={};for(var a in this.FORMATS)n[a]=[];var i,s=Ha(r);try{for(s.s();!(i=s.n()).done;){var o=i.value,l=o.fromSource,u=o.toSource;if(t[u.format]&&this.sourceMatches(e,l)){var c,d=Ha(t[u.format]);try{for(d.s();!(c=d.n()).done;){var p=c.value;if(this.sourceMatches(p,u))return n[u.format]=[p],n}}catch(e){d.e(e)}finally{d.f()}}}}catch(e){s.e(e)}finally{s.f()}return null}}],(r=null)&&Wa(t.prototype,r),n&&Wa(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function qa(e){return qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qa(e)}function Ya(e){return function(e){if(Array.isArray(e))return Xa(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Xa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xa(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Za(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Za(Object(r),!0).forEach((function(t){li(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Za(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ja(){Ja=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,s=Object.create(i.prototype),o=new w(n||[]);return a(s,"_invoke",{value:P(e,r,o)}),s}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",g={};function y(){}function v(){}function _(){}var k={};u(k,s,(function(){return this}));var E=Object.getPrototypeOf,b=E&&E(E(R([])));b&&b!==r&&n.call(b,s)&&(k=b);var T=_.prototype=y.prototype=Object.create(k);function A(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(a,i,s,o){var l=d(e[a],e,i);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==qa(c)&&n.call(c,"__await")?t.resolve(c.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):t.resolve(c).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,o)}))}o(l.arg)}var i;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function P(t,r,n){var a=p;return function(i,s){if(a===f)throw new Error("Generator is already running");if(a===m){if("throw"===i)throw s;return{value:e,done:!0}}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var l=C(o,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=f;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:h,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function C(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,C(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var s=i.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(qa(t)+" is not iterable")}return v.prototype=_,a(T,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:v,configurable:!0}),v.displayName=u(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},A(S.prototype),u(S.prototype,o,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var s=new S(c(e,r,n,a),i);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},A(T),u(T,l,"Generator"),u(T,s,(function(){return this})),u(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,w.prototype={constructor:w,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return o.type="throw",o.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;I(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function ei(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function ti(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){ei(i,n,a,s,o,"next",e)}function o(e){ei(i,n,a,s,o,"throw",e)}s(void 0)}))}}function ri(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ui(n.key),n)}}function ni(e,t,r){return t=ii(t),function(e,t){if(t&&("object"===qa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return si(e)}(e,ai()?Reflect.construct(t,r||[],ii(e).constructor):t.apply(e,r))}function ai(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ai=function(){return!!e})()}function ii(e){return ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ii(e)}function si(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oi(e,t){return oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oi(e,t)}function li(e,t,r){return(t=ui(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ui(e){var t=function(e,t){if("object"!=qa(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=qa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qa(t)?t:String(t)}!function(e,t,r){(t=$a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(za,"FORMATS",{dash:"mpegdash",hls:"applehttp",progressive:"url"});var ci=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),li(si(r=ni(this,t)),"_eventManager",new p.EventManager),li(si(r),"_mediaInfo",null),li(si(r),"_remotePlayer",null),li(si(r),"_pluginManager",new le),li(si(r),"_pluginsConfig",{}),li(si(r),"_reset",!0),li(si(r),"_firstPlay",!0),li(si(r),"_sourceSelected",null),li(si(r),"_appPluginConfig",{}),li(si(r),"_thumbnailManager",null),li(si(r),"_isVisible",!1),li(si(r),"_autoPaused",!1),li(si(r),"_sessionIdCache",null),li(si(r),"_isV2ToV7Redirected",!1);var n=e.sources,a=e.plugins;r._sessionIdCache=new Va,r._configEvaluator=new Or,r._configEvaluator.evaluatePluginsConfig(a,e),r._addCustomPreset(e),r._playbackStart=!1;var i=p.Utils.Object.mergeDeep({},e);delete i.plugins,delete i.sources,r._localPlayer=(0,p.loadPlayer)(i),r._controllerProvider=new Y(r._pluginManager),r._viewabilityManager=new st(r.config.viewability),r._serviceProvider=new ln(si(r)),r._uiWrapper=new _(si(r),p.Utils.Object.mergeDeep(e,{ui:{logger:{getLogger:p.getLogger,LogLevel:p.LogLevel}}})),r._cuepointManager=new nn(si(r)),r._provider=new f.Provider(p.Utils.Object.mergeDeep(e.provider,{logger:{getLogger:p.getLogger,LogLevel:p.LogLevel},referrer:window.originalRequestReferrer}),"3.17.61"),r._playlistManager=new Sn(si(r),e),Object.values(p.EventType).forEach((function(e){return r._eventManager.listen(r._localPlayer,e,(function(e){return r.dispatchEvent(e)}))})),r._addBindings();var s=p.Utils.Object.mergeDeep({},e.playlist,{items:null});return r._playlistManager.configure(s),r.configure({plugins:a}),r._playlistManager.configure({items:e.playlist&&e.playlist.items||[]}),r._remotePlayerManager=new na,r._localPlayer.setSources(n||{}),r}var r,n,a,i,s,o,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oi(e,t)}(t,e),r=t,n=[{key:"loadMedia",value:(l=ti(Ja().mark((function e(r,n){var a,i,s,o,l;return Ja().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._logger.debug("loadMedia",r),this._mediaInfo=r,this.reset(),this._localPlayer.loadingMedia=!0,this._uiWrapper.setLoadingSpinnerState(!0),e.prev=5,e.next=8,this._provider.getMediaConfig(r);case 8:return a=e.sent,i=p.Utils.Object.copyDeep(a),n&&(i.sources=i.sources||{},i.sources=p.Utils.Object.mergeDeep(i.sources,n)),s=ir(i.plugins,this.config.plugins),i.plugins=s[0],this._appPluginConfig=s[1],this.configure(we({sources:this.sources},i)),this.setMedia(i),e.abrupt("return",i);case 19:throw e.prev=19,e.t0=e.catch(5),o=Ua(e.t0),l=new p.Error(p.Error.Severity.CRITICAL,o,p.Error.Code.LOAD_FAILED,e.t0),this._localPlayer.dispatchEvent(new p.FakeEvent(p.EventType.ERROR,l)),e.t0;case 25:case"end":return e.stop()}}),e,this,[[5,19]])}))),function(e,t){return l.apply(this,arguments)})},{key:"setMedia",value:function(e){var r,n;if(null!==(r=this.config.playback.fallbackSourcesOptions)&&void 0!==r&&r.length&&!this._fallbackSources){var a=za.splitSources(e.sources,this.config.playback.fallbackSourcesOptions),i=a.fallbackSources,s=a.nonFallbackSources;e.sources=p.Utils.Object.mergeDeep(e.sources,s),this._fallbackSources=i}t._logger.debug("setMedia",e),this.reset(!0);var o=p.Utils.Object.copyDeep(e),l=p.Utils.Object.mergeDeep({},o.sources,this._localPlayer.sources);o.sources.type===p.MediaType.VOD&&(null===(n=this._localPlayer.sources.mediaEntryType)||void 0===n?void 0:n.toString())===p.MediaType.LIVE&&(l.id=o.sources.id,l.duration=o.sources.duration),delete o.sources,p.Utils.Object.mergeDeep(o.session,this._localPlayer.config.session),o.plugins=o.plugins||{},Object.keys(this._pluginsConfig).forEach((function(e){o.plugins[e]=o.plugins[e]||{}})),this.configure({session:e.session}),rr(l)||nr(l)||ar(l)?this._thumbnailManager=null:this._thumbnailManager=new Jr(this,this.config.ui,e),this.updateKalturaPoster(l,e.sources,this._localPlayer.dimensions),Tr(this,Qa(Qa({},o),{},{sources:l}));var u=function(e,t){return t&&rr(t)?tr(e,"youtube","progressive"):t&&nr(t)?tr(e,"image","image"):t&&ar(t)?tr(e,"document","document"):null}(this,l);u&&(o.playback=u),this.configure(Qa(Qa({},o),{},{sources:l})),this._configureInformationForDevice(e)}},{key:"loadPlaylist",value:(o=ti(Ja().mark((function e(r,n){var a,i;return Ja().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._logger.debug("loadPlaylist",r),this._uiWrapper.setLoadingSpinnerState(!0),e.prev=2,e.next=5,this._provider.getPlaylistConfig(r);case 5:return a=e.sent,this.setPlaylist(a,n),e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(2),i=new p.Error(p.Error.Severity.CRITICAL,p.Error.Category.PLAYER,p.Error.Code.LOAD_FAILED,e.t0),this._localPlayer.dispatchEvent(new p.FakeEvent(p.EventType.ERROR,i)),e.t0;case 15:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(e,t){return o.apply(this,arguments)})},{key:"loadPlaylistByEntryList",value:(s=ti(Ja().mark((function e(r,n){var a,i;return Ja().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._logger.debug("loadPlaylistByEntryList",r),this._uiWrapper.setLoadingSpinnerState(!0),e.prev=2,e.next=5,this._provider.getEntryListConfig(r);case 5:return a=e.sent,this.setPlaylist(a,n,r),e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(2),i=new p.Error(p.Error.Severity.CRITICAL,p.Error.Category.PLAYER,p.Error.Code.LOAD_FAILED,e.t0),this._localPlayer.dispatchEvent(new p.FakeEvent(p.EventType.ERROR,i)),e.t0;case 15:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(e,t){return s.apply(this,arguments)})},{key:"setPlaylist",value:function(e,r,n){t._logger.debug("setPlaylist",e);var a={playlist:e,plugins:{}};Object.keys(this._pluginsConfig).forEach((function(e){a.plugins[e]={}})),this._configEvaluator.evaluatePluginsConfig(a.plugins,a),this._configureOrLoadPlugins(a.plugins),this._playlistManager.load(e,r,n)}},{key:"clearReset",value:function(){this._localPlayer.clearReset()}},{key:"configure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=er(e);var t=p.Utils.Object.mergeDeep({},this.config,e);this._configEvaluator.evaluatePluginsConfig(e.plugins,t),this._configureOrLoadPlugins(e.plugins);var r=p.Utils.Object.mergeDeep({},e);if(delete r.plugins,r.sources){var n=r.sources;this.handleSourcesTimeRangeUpdate(n.seekFrom,n.clipTo),delete r.sources,this._localPlayer.configure(r),this._localPlayer.setSources(n||{})}else this._localPlayer.configure(r);e.ui&&this._uiWrapper.setConfig(t.ui),e.playlist&&this._playlistManager.configure(e.playlist)}},{key:"updateKalturaPoster",value:function(e,t,r){var n;!function(e,t,r,n){var a=e.poster,i=t.poster,s=r.width,o=r.height,l=t.rawThumbnailUrl;"string"==typeof a&&Qr.test(a)&&a===i&&"string"==typeof l&&(e.poster="".concat(l,"/height/").concat(o,"/width/").concat(s).concat(n?"/ks/".concat(n):"")),t.poster=e.poster||""}(e,t,r,this.shouldAddKs()?null===(n=this.config)||void 0===n||null===(n=n.session)||void 0===n?void 0:n.ks:"")}},{key:"shouldAddKs",value:function(e){var t,r;return!(null===(t=this.config)||void 0===t||null===(t=t.provider)||void 0===t||!t.loadThumbnailWithKs||null===(r=e||this.config)||void 0===r||null===(r=r.session)||void 0===r||!r.ks)}},{key:"getMediaInfo",value:function(){return p.Utils.Object.copyDeep(this._mediaInfo)}},{key:"getDrmInfo",value:function(){return this._localPlayer.getDrmInfo()}},{key:"getMediaConfig",value:function(){var e={sources:this._localPlayer.sources,plugins:this._pluginsConfig};return p.Utils.Object.copyDeep(e)}},{key:"setSourcesMetadata",value:function(e){this._localPlayer.setSourcesMetadata(e)}},{key:"ready",value:function(){return this._localPlayer.ready()}},{key:"load",value:function(){this._localPlayer.load()}},{key:"play",value:function(){this._localPlayer.play()}},{key:"pause",value:function(){this._localPlayer.pause()}},{key:"getView",value:function(){return this._localPlayer.getView()}},{key:"getVideoElement",value:function(){return this._localPlayer.getVideoElement()}},{key:"reset",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._reset||(this._reset=!0,this._firstPlay=!0,this._sourceSelected=null,this._fallbackSources=null,this._attachEventManager&&this._attachEventManager.removeAll(),this._uiWrapper.reset(),this._resetProviderPluginsConfig(),this._pluginManager.reset(),this._cuepointManager.reset(),this._localPlayer.reset(t),null===(e=this._thumbnailManager)||void 0===e||e.destroy())}},{key:"destroy",value:function(){var e,t,r=this.config.ui.targetId;this._reset=!0,this._playbackStart=!1,this._firstPlay=!0,this._uiWrapper.destroy(),this._pluginManager.destroy(),this._cuepointManager.destroy(),this._playlistManager.destroy(),this._localPlayer.destroy(),this._eventManager.destroy(),null===(e=this._thumbnailManager)||void 0===e||e.destroy(),this._viewabilityManager.destroy(),this._remotePlayerManager.destroy(),this._pluginsConfig={};var n=document.getElementById(r);n&&n.parentNode&&p.Utils.Dom.removeChild(n.parentNode,n),null===(t=this._sessionIdCache)||void 0===t||t.clear()}},{key:"isLive",value:function(){return this._localPlayer.isLive()}},{key:"isOnLiveEdge",value:function(){return this._localPlayer.isOnLiveEdge()}},{key:"isDvr",value:function(){return this._localPlayer.isDvr()}},{key:"isUntimedImg",value:function(){return nr(this.sources)&&!("number"==typeof this.config.sources.duration&&this.config.sources.duration>0)}},{key:"isUntimedDocument",value:function(){return ar(this.sources)&&!("number"==typeof this.config.sources.duration&&this.config.sources.duration>0)}},{key:"isImage",value:function(){return nr(this.sources)}},{key:"isDocument",value:function(){return ar(this.sources)}},{key:"isAudio",value:function(){return this._localPlayer.isAudio()}},{key:"seekToLiveEdge",value:function(){this._localPlayer.seekToLiveEdge()}},{key:"getStartTimeOfDvrWindow",value:function(){return this._localPlayer.getStartTimeOfDvrWindow()}},{key:"getTracks",value:function(e){return this._localPlayer.getTracks(e)}},{key:"getActiveTracks",value:function(){return this._localPlayer.getActiveTracks()}},{key:"selectTrack",value:function(e){this._localPlayer.selectTrack(e)}},{key:"hideTextTrack",value:function(){this._localPlayer.hideTextTrack()}},{key:"showTextTrack",value:function(){this._localPlayer.showTextTrack()}},{key:"changeQuality",value:function(e){this._localPlayer.changeQuality(e)}},{key:"enableAdaptiveBitrate",value:function(){this._localPlayer.enableAdaptiveBitrate()}},{key:"isAdaptiveBitrateEnabled",value:function(){return this._localPlayer.isAdaptiveBitrateEnabled()}},{key:"setTextDisplaySettings",value:function(e){this._localPlayer.setTextDisplaySettings(e)}},{key:"textDisplaySetting",get:function(){return this._localPlayer.textDisplaySetting}},{key:"isFullscreen",value:function(){return this._localPlayer.isFullscreen()}},{key:"notifyEnterFullscreen",value:function(){this._localPlayer.notifyEnterFullscreen()}},{key:"notifyExitFullscreen",value:function(){this._localPlayer.notifyExitFullscreen()}},{key:"enterFullscreen",value:function(e){var t=e||this.config.ui.targetId;this._localPlayer.enterFullscreen(t)}},{key:"exitFullscreen",value:function(){this._localPlayer.exitFullscreen()}},{key:"enterPictureInPicture",value:function(){this._localPlayer.enterPictureInPicture()}},{key:"exitPictureInPicture",value:function(){this._localPlayer.exitPictureInPicture()}},{key:"isInPictureInPicture",value:function(){return this._localPlayer.isInPictureInPicture()}},{key:"isPictureInPictureSupported",value:function(){return this._localPlayer.isPictureInPictureSupported()}},{key:"getLogLevel",value:function(e){return this._localPlayer.getLogLevel(e)}},{key:"startCasting",value:function(e){var t=this;return this.setIsCastInitiator(e,!0),new Promise((function(r,n){t.remotePlayerManager.startCasting(e).then(r).catch((function(){t.setIsCastInitiator(e,!1),n()}))}))}},{key:"setIsCastInitiator",value:function(e,t){this._remotePlayerManager.setIsCastInitiator(e,t)}},{key:"isCastAvailable",value:function(e){return this._remotePlayerManager.isCastAvailable(e)}},{key:"getCastSession",value:function(){return null}},{key:"stopCasting",value:function(){}},{key:"isCasting",value:function(){return!1}},{key:"isVr",value:function(){return this._localPlayer.isVr()}},{key:"toggleVrStereoMode",value:function(){var e=this._pluginManager.get("vr");e&&"function"==typeof e.toggleVrStereoMode&&e.toggleVrStereoMode()}},{key:"isInVrStereoMode",value:function(){var e=this._pluginManager.get("vr");return!(!e||"function"!=typeof e.isInStereoMode)&&e.isInStereoMode()}},{key:"setLogLevel",value:function(e,t){this._localPlayer.setLogLevel(e,t)}},{key:"getThumbnail",value:function(e){if(!e){if(isNaN(this.currentTime))return null;e=this.currentTime}return e=this.isLive()?e+this.getStartTimeOfDvrWindow():e,this._thumbnailManager?this._thumbnailManager.getThumbnail(e):null}},{key:"textStyle",get:function(){return this._localPlayer.textStyle},set:function(e){this._localPlayer.textStyle=e}},{key:"buffered",get:function(){return this._localPlayer.buffered}},{key:"stats",get:function(){return this._localPlayer.stats}},{key:"currentTime",get:function(){return this._localPlayer.currentTime},set:function(e){this._localPlayer.currentTime=e}},{key:"duration",get:function(){return this._localPlayer.duration}},{key:"liveDuration",get:function(){return this._localPlayer.liveDuration}},{key:"normalizedCurrentTime",get:function(){return this.isLive()?this.currentTime-this.getStartTimeOfDvrWindow():this.currentTime},set:function(e){this.isLive()?this.currentTime=e+this.getStartTimeOfDvrWindow():this.currentTime=e}},{key:"normalizedDuration",get:function(){return this.isLive()?this.liveDuration-this.getStartTimeOfDvrWindow():this.duration}},{key:"volume",get:function(){return this._localPlayer.volume},set:function(e){this._localPlayer.volume=e}},{key:"paused",get:function(){return this._localPlayer.paused}},{key:"seeking",get:function(){return this._localPlayer.seeking}},{key:"playsinline",get:function(){return this._localPlayer.playsinline},set:function(e){this._localPlayer.playsinline=e}},{key:"muted",get:function(){return this._localPlayer.muted},set:function(e){this._localPlayer.muted=e}},{key:"src",get:function(){return this._localPlayer.src}},{key:"videoHeight",get:function(){return this._localPlayer.videoHeight}},{key:"videoWidth",get:function(){return this._localPlayer.videoWidth}},{key:"dimensions",get:function(){return this._localPlayer.dimensions},set:function(e){this._localPlayer.dimensions=e}},{key:"poster",get:function(){return this._localPlayer.poster}},{key:"ended",get:function(){return this._localPlayer.ended}},{key:"playbackRate",get:function(){return this._localPlayer.playbackRate},set:function(e){this._localPlayer.playbackRate=e}},{key:"playbackRates",get:function(){return this._localPlayer.playbackRates}},{key:"defaultPlaybackRate",get:function(){return this._localPlayer.defaultPlaybackRate}},{key:"engineType",get:function(){return this._localPlayer.engineType}},{key:"streamType",get:function(){return this._localPlayer.streamType}},{key:"env",get:function(){return this._localPlayer.env}},{key:"selectedSource",get:function(){return this._sourceSelected}},{key:"sources",get:function(){return Qa({},this._localPlayer.sources)}},{key:"config",get:function(){return Qa(Qa({},this._localPlayer.config),{},{plugins:this._pluginsConfig,sources:this._localPlayer.sources})}},{key:"hasUserInteracted",get:function(){return this._localPlayer.hasUserInteracted}},{key:"loadingMedia",set:function(e){this._localPlayer.loadingMedia=e}},{key:"ads",get:function(){return this._adsController}},{key:"plugins",get:function(){return this._pluginManager.getAll()}},{key:"provider",get:function(){return this._provider}},{key:"ui",get:function(){return this._uiWrapper}},{key:"playlist",get:function(){return this._playlistManager}},{key:"Event",get:function(){return Qa({Cast:On,Core:p.EventType,Playlist:cn,UI:h.EventType,VISIBILITY_CHANGE:ut,REGISTERED_PLUGINS_LIST_EVENT:oe},p.EventType)}},{key:"TextStyle",get:function(){return this._localPlayer.TextStyle}},{key:"ViewabilityType",get:function(){return ot}},{key:"State",get:function(){return this._localPlayer.State}},{key:"Track",get:function(){return this._localPlayer.Track}},{key:"LogLevelType",get:function(){return this._localPlayer.LogLevelType}},{key:"LogLevel",get:function(){return this._localPlayer.LogLevel}},{key:"AbrMode",get:function(){return this._localPlayer.AbrMode}},{key:"MediaType",get:function(){return this._localPlayer.MediaType}},{key:"StreamType",get:function(){return this._localPlayer.StreamType}},{key:"EngineType",get:function(){return this._localPlayer.EngineType}},{key:"Error",get:function(){return this._localPlayer.Error}},{key:"_addCustomPreset",value:function(e){e.plugins&&Object.keys(e.plugins).forEach((function(t){window.kalturaCustomPreset&&window.kalturaCustomPreset[t]&&(window.kalturaCustomPresetMap||(window.kalturaCustomPresetMap={}),window.kalturaCustomPresetMap[e.ui.targetId]||(window.kalturaCustomPresetMap[e.ui.targetId]={}),window.kalturaCustomPresetMap[e.ui.targetId][t]=window.kalturaCustomPreset[t])}))}},{key:"_configureInformationForDevice",value:function(e){var t;if(navigator.mediaSession){var r,n="string"==typeof(t=e.sources.poster)?t:Array.isArray(t)&&t.length>0?t[0]:"";navigator.mediaSession.metadata=new MediaMetadata({title:(null===(r=e.sources.metadata)||void 0===r?void 0:r.name)||"",artwork:n?[{src:n}]:[]})}}},{key:"_addBindings",value:function(){var e=this;this._eventManager.listen(this,p.EventType.CHANGE_SOURCE_STARTED,(function(){return e._onChangeSourceStarted()})),this._eventManager.listen(this,p.EventType.CHANGE_SOURCE_ENDED,(function(){return e._onChangeSourceEnded()})),this._eventManager.listen(this,p.EventType.PLAYER_RESET,(function(){return e._onPlayerReset()})),this._eventManager.listen(this,p.EventType.ENDED,(function(){return e._onEnded()})),this._eventManager.listen(this,p.EventType.FIRST_PLAY,(function(){return e._firstPlay=!1})),this._eventManager.listen(this,p.EventType.SOURCE_SELECTED,(function(t){return e._sourceSelected=t.payload.selectedSource[0]})),this._eventManager.listen(this,p.EventType.PLAYBACK_ENDED,(function(){return e._onPlaybackEnded()})),this._eventManager.listen(this,p.EventType.PLAYBACK_START,(function(){e._playbackStart=!0})),this._eventManager.listen(this,p.AdEventType.AD_AUTOPLAY_FAILED,(function(t){return e._onAdAutoplayFailed(t)})),this._eventManager.listen(this,p.AdEventType.AD_STARTED,(function(){return e._onAdStarted()})),this.config.playback.playAdsWithMSE&&(this._attachEventManager=new p.EventManager,this._eventManager.listen(this,p.AdEventType.AD_LOADED,(function(t){var r=t.payload.ad;r&&r.linear&&1===r.position&&!r.inStream&&e.src?(e._attachEventManager.listenOnce(e,p.AdEventType.AD_BREAK_START,(function(){return e.detachMediaSource()})),e._attachEventManager.listenOnce(e,p.AdEventType.AD_BREAK_END,(function(){return e.attachMediaSource()})),e._attachEventManager.listenOnce(e,p.AdEventType.AD_ERROR,(function(){return e.attachMediaSource()}))):e._attachEventManager.removeAll()}))),this._eventManager.listen(this,p.EventType.ERROR,(function(t){var r;(r=t.payload).code<7e3&&r.code>=6e3?e._loadFallbackSources():t.payload.severity===p.Error.Severity.CRITICAL&&(e._reset=!1)}))}},{key:"_loadFallbackSources",value:function(){var e=za.getMatchingFallbackSources(this._sourceSelected,this._fallbackSources,this.config.playback.fallbackSourcesOptions);if(e){var t={sources:p.Utils.Object.mergeDeep({},this._localPlayer.sources,e),session:this.config.session},r=!this._firstPlay;this.setMedia(t),r&&this.play()}}},{key:"_onChangeSourceEnded",value:function(){p.Utils.Object.getPropertyPath(this.config,"ui.targetId")?this._viewabilityManager.observe(document.getElementById(this.config.ui.targetId),this._handleVisibilityChange.bind(this)):t._logger.warn("Cannot observe visibility change without config.ui.targetId")}},{key:"_onPlayerReset",value:function(){this._playbackStart=!1,p.Utils.Object.getPropertyPath(this.config,"ui.targetId")&&this._viewabilityManager.unObserve(document.getElementById(this.config.ui.targetId),this._handleVisibilityChange.bind(this))}},{key:"_onChangeSourceStarted",value:function(){this._configureOrLoadPlugins(this._pluginsConfig),this.reset(),this._pluginManager.loadMedia(),this._reset=!1,this.dispatchEvent(new p.FakeEvent(oe,this._pluginManager.getRegisterdPluginsList()))}},{key:"_onEnded",value:function(){var e=this;setTimeout((function(){e._adsController&&!e._adsController.allAdsCompleted?e._eventManager.listenOnce(e._adsController,p.AdEventType.ALL_ADS_COMPLETED,(function(){e.dispatchEvent(new p.FakeEvent(p.EventType.PLAYBACK_ENDED))})):e.dispatchEvent(new p.FakeEvent(p.EventType.PLAYBACK_ENDED))}))}},{key:"_onPlaybackEnded",value:function(){this.config.playback.loop&&(this.currentTime=0,this.play())}},{key:"_onAdStarted",value:function(){this._firstPlay&&(this._localPlayer.posterManager.hide(),this._localPlayer.hideBlackCover())}},{key:"_onAdAutoplayFailed",value:function(e){this._firstPlay&&this.config.playback.autoplay&&(this._localPlayer.posterManager.show(),this.dispatchEvent(new p.FakeEvent(p.EventType.AUTOPLAY_FAILED,e.payload)))}},{key:"_configureOrLoadPlugins",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=[],n=[],a=[];Object.keys(t).forEach((function(i){var s=e._pluginManager.get(i);if(s)s.updateConfig(t[i]),t[i]=s.getConfig();else if(e._sourceSelected)delete t[i];else{try{e._pluginManager.load(i,e,t[i])}catch(t){e.dispatchEvent(new p.FakeEvent(p.Error.Code.ERROR,t))}var o=e._pluginManager.get(i);o&&(a.push(o),t[i]=o.getConfig(),"function"==typeof o.getMiddlewareImpl&&("bumper"===o.name?r.push(o.getMiddlewareImpl()):r.unshift(o.getMiddlewareImpl())),"function"==typeof o.getUIComponents&&n.push.apply(n,Ya(o.getUIComponents()||[])),"function"==typeof o.getEngineDecorator&&e._localPlayer.registerEngineDecoratorProvider(new p.EngineDecoratorProvider(o)))}})),n.forEach((function(t){return e._uiWrapper.addComponent(t)})),this._pluginReadinessMiddleware||(this._pluginReadinessMiddleware=new Kr(a),this._localPlayer.playbackMiddleware.use(this._pluginReadinessMiddleware)),this._maybeCreateAdsController(),r.forEach((function(t){return e._localPlayer.playbackMiddleware.use(t)})),p.Utils.Object.mergeDeep(this._pluginsConfig,t)}},{key:"_maybeCreateAdsController",value:function(){var e=this;if(!this._adsController){var t=this._controllerProvider.getAdsControllers();t.length&&(this._adsController=new W(this,t),this._localPlayer.playbackMiddleware.use(this._adsController.getMiddleware()),this._eventManager.listen(this._adsController,p.AdEventType.ALL_ADS_COMPLETED,(function(t){e.dispatchEvent(t)})))}}},{key:"attachMediaSource",value:function(){this._localPlayer.attachMediaSource()}},{key:"detachMediaSource",value:function(){this._localPlayer.detachMediaSource()}},{key:"_resetProviderPluginsConfig",value:function(){this.configure({plugins:this._appPluginConfig}),this._appPluginConfig={}}},{key:"crossOrigin",get:function(){return this._localPlayer.crossOrigin},set:function(e){this._localPlayer.crossOrigin=e}},{key:"isVisible",get:function(){return this._isVisible}},{key:"viewabilityManager",get:function(){return this._viewabilityManager}},{key:"_handleVisibilityChange",value:function(e){this._isVisible=e,this.dispatchEvent(new p.FakeEvent(ut,{visible:this._isVisible})),this.config.playback.autoplay===p.AutoPlayType.IN_VIEW&&this._isVisible&&!this._playbackStart&&this._localPlayer.play({programmatic:!0}),!0===this.config.playback.autopause&&this._handleAutoPause(e)}},{key:"_handleAutoPause",value:function(e){var t=!this.paused||this._adsController&&this._adsController.isAdPlaying(),r=!this.isInPictureInPicture()&&this._playbackStart&&t;e?this._autoPaused&&(this.paused&&this.play(),this._autoPaused=!1):r&&(this.pause(),this._autoPaused=!0)}},{key:"getService",value:function(e){return this._serviceProvider.get(e)}},{key:"hasService",value:function(e){return this._serviceProvider.has(e)}},{key:"registerService",value:function(e,t){this._serviceProvider.register(e,t)}},{key:"cuePointManager",get:function(){return this._cuepointManager}},{key:"addTextTrack",value:function(e,t){return this._localPlayer.addTextTrack(e,t)}},{key:"getNativeTextTracks",value:function(){return this._localPlayer.getNativeTextTracks()}},{key:"remotePlayerManager",get:function(){return this._remotePlayerManager}},{key:"getMediaCapabilities",value:(i=ti(Ja().mark((function e(t){return Ja().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pa(t));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"setCachedUrls",value:function(e){this.config.playback.enableCachedUrls&&this._localPlayer.setCachedUrls(e)}},{key:"sessionIdCache",get:function(){return this._sessionIdCache}},{key:"debugInfo",get:function(){var e,t,r,n,a;if(null===(e=this.config.log)||void 0===e||!e.useDebugInfo)return null;var i=zt.join(""),s=vr();return{embedUrl:window.location.href,userAgent:navigator.userAgent,referrer:s,targetId:this.config.targetId,playerVersion:null===(t=window.KalturaPlayer)||void 0===t?void 0:t.VERSION,partnerId:null===(r=this.config.provider)||void 0===r?void 0:r.partnerId,entryId:this.sources.id,playlistId:null===(n=this.playlist)||void 0===n?void 0:n.id,manifestUrl:null===(a=this.selectedSource)||void 0===a?void 0:a.url,plugins:Ya(Object.keys(this.plugins)),localStorage:et.getStorageItems(),log:i}}},{key:"isV2ToV7Redirected",get:function(){return this._isV2ToV7Redirected},set:function(e){this._isV2ToV7Redirected=e}},{key:"handleSourcesTimeRangeUpdate",value:function(e,t){var r=!1;"number"==typeof e&&(r=!0,this._localPlayer.setSeekFrom(e)),"number"==typeof t&&(r=!0,this._localPlayer.setClipTo(t)),r&&this.configure({playback:{options:{html5:{hls:{subtitleTrackController:null},dash:{manifest:{disableText:!0}}}}}})}}],n&&ri(r.prototype,n),a&&ri(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(p.FakeEventTarget);li(ci,"_logger",(0,p.getLogger)("KalturaPlayer"+p.Utils.Generator.uniqueId(5)));var di={};function pi(){return di}function hi(e){return di[e]?di[e]:null}var fi=["_remotePlayer","_listeners","_uiWrapper"],mi={get:function(e,t){if("destroy"===t){var r=e.config.targetId;delete di[r]}return t in p.FakeEventTarget.prototype||fi.includes(t)?e[t]:e._remotePlayer&&t in e._remotePlayer?e._remotePlayer[t]:e[t]},set:function(e,t,r){return e._remotePlayer&&!fi.includes(t)?t in e._remotePlayer&&(e._remotePlayer[t]=r):e[t]=r,!0}},gi=function(e){var t=new ci(e),r=new Proxy(t,mi);return di[e.targetId]=r,r};function yi(e){!function(e){!1!==p.Utils.Object.getPropertyPath(e,"log.playerVersion")&&((0,p.setLogLevel)(p.LogLevel.INFO),(0,p.getLogger)().log("%c ".concat("@playkit-js/kaltura-player-js"," ").concat("3.17.61"),"color: #ff98f9;  font-size: large"),(0,p.getLogger)().log("%c For more details see ".concat("https://github.com/kaltura/kaltura-player-js"),"color: #ff98f9;"))}(e),Yt(e=er(e)),function(e){e.provider&&e.provider.uiConfId&&Ct.getInstance().setUiConfId(e.provider.uiConfId.toString())}(e);var t=Jt(e);!function(e){var t,r=e.provider,n=null===(t=Qt())||void 0===t?void 0:t.productVersion;if(!r.partnerId||r.partnerId===Ht){var a={url:Kt,mimetype:""};a.url=function(e,t){return t&&(e+="&clientVer=".concat(t)),e}(a.url,n),a.url=_r(a.url),a.url=Er(a.url,n),a.url=yr(null,a.url,Tt.next()),navigator.sendBeacon&&navigator.sendBeacon(a.url)}}(t),Xt(t),function(e){var t=parseFloat(Zt(Bt));isNaN(t)||p.Utils.Object.createPropertyPath(e,"sources.startTime",t)}(t),function(e){var t=parseFloat(Zt(Ft));isNaN(t)||p.Utils.Object.createPropertyPath(e,"sources.endTime",t)}(t),function(e){var t=parseFloat(Zt(Vt));isNaN(t)||p.Utils.Object.createPropertyPath(e,"sources.seekFrom",t);var r=parseFloat(Zt(Gt));isNaN(r)||p.Utils.Object.createPropertyPath(e,"sources.clipTo",r)}(t),Nt.forEach((function(e){return(0,p.getLogger)("KalturaPlayer:Setup")[e.level](e.msg)})),et.initialize(),_t.initialize(),function(e){e.disableUserCache||$e.setStorageConfig(e)}(t);var r=gi(t);return function(e){var t=e.provider.env,r=t.serviceUrl,n=t.initCallToServer;n&&fetch(r+n+"/format/1").then((function(e){e.json().then((function(e){(0,p.getLogger)().log("Initial server response: ".concat(e))}))}))}(r),function(e){if(!e.config.disableUserCache&&et.isStorageAvailable()){var t=et.getPlayerTextStyle();t&&(e.textStyle=p.Utils.Object.mergeDeep(new p.TextStyle,t))}}(r),function(e){$e.attachAll(e)}(r),function(e,t){e.cast&&t.remotePlayerManager.load(e.cast,t)}(t,r),function(e){if(p.Env.isIOS||p.Env.isIPadOS){var t=function t(){e.removeEventListener(e.Event.UI.UI_CLICKED,t),(0,p.setCapabilities)(p.EngineType.HTML5,{autoplay:!0})};e.addEventListener(e.Event.SOURCE_SELECTED,(function r(){e.removeEventListener(e.Event.SOURCE_SELECTED,r),e.addEventListener(e.Event.UI.UI_CLICKED,t)}))}}(r),r}function vi(e){return vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vi(e)}function _i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ki(n.key),n)}}function ki(e){var t=function(e,t){if("object"!=vi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=vi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==vi(t)?t:String(t)}var Ei=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t,this._friendlyName=r,this._resuming=n}var t,r,n;return t=e,(r=[{key:"deviceFriendlyName",get:function(){return this._friendlyName}},{key:"id",get:function(){return this._id}},{key:"resuming",get:function(){return this._resuming}}])&&_i(t.prototype,r),n&&_i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function bi(e){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bi(e)}function Ti(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wi(n.key),n)}}function Ai(e,t,r){return t=Pi(t),function(e,t){if(t&&("object"===bi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ci(e)}(e,Si()?Reflect.construct(t,r||[],Pi(e).constructor):t.apply(e,r))}function Si(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Si=function(){return!!e})()}function Pi(e){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pi(e)}function Ci(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xi(e,t){return xi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xi(e,t)}function Ii(e,t,r){return(t=wi(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wi(e){var t=function(e,t){if("object"!=bi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bi(t)?t:String(t)}var Ri=function(e){function t(e,r,n){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ii(Ci(a=Ai(this,t)),"_isCastInitiator",!1),a._playerConfig={},t._logger=(0,p.getLogger)(e),a._remoteControl=n,a._castConfig=p.Utils.Object.mergeDeep({},a.constructor.defaultConfig,r),a._eventManager=new p.EventManager,t._logger.debug("Initialized"),a}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xi(e,t)}(t,e),r=t,a=[{key:"isSupported",value:function(){return!0}}],(n=[{key:"loadMedia",value:function(e){return Promise.resolve()}},{key:"setMedia",value:function(e){}},{key:"getMediaInfo",value:function(){}},{key:"getMediaConfig",value:function(){}},{key:"configure",value:function(){}},{key:"ready",value:function(){return Promise.resolve()}},{key:"load",value:function(){}},{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"reset",value:function(){}},{key:"destroy",value:function(){}},{key:"isLive",value:function(){return!1}},{key:"isDvr",value:function(){return!1}},{key:"seekToLiveEdge",value:function(){}},{key:"getStartTimeOfDvrWindow",value:function(){return 0}},{key:"getTracks",value:function(e){return[]}},{key:"getActiveTracks",value:function(){return{audio:void 0,video:void 0,text:void 0}}},{key:"selectTrack",value:function(e){}},{key:"hideTextTrack",value:function(){}},{key:"enableAdaptiveBitrate",value:function(){}},{key:"isAdaptiveBitrateEnabled",value:function(){return!0}},{key:"setTextDisplaySettings",value:function(e){}},{key:"startCasting",value:function(){return Promise.reject("startCasting method was not overridden")}},{key:"stopCasting",value:function(){}},{key:"isCasting",value:function(){return!0}},{key:"isCastAvailable",value:function(){return!0}},{key:"getCastSession",value:function(){return new Ei("","")}},{key:"isVr",value:function(){return!1}},{key:"toggleVrStereoMode",value:function(){}},{key:"isInVrStereoMode",value:function(){return!1}},{key:"ads",get:function(){return null}},{key:"textStyle",get:function(){return new p.TextStyle},set:function(e){}},{key:"buffered",get:function(){return[]}},{key:"currentTime",get:function(){return 0},set:function(e){}},{key:"duration",get:function(){return 0}},{key:"liveDuration",get:function(){return NaN}},{key:"volume",get:function(){return 1},set:function(e){}},{key:"paused",get:function(){return!1}},{key:"ended",get:function(){return!1}},{key:"seeking",get:function(){return!1}},{key:"muted",get:function(){return!1},set:function(e){}},{key:"src",get:function(){return""}},{key:"poster",get:function(){return""}},{key:"playbackRate",get:function(){return 1},set:function(e){}},{key:"engineType",get:function(){return""}},{key:"streamType",get:function(){return""}},{key:"type",get:function(){return t.Type}},{key:"config",get:function(){return this._playerConfig}},{key:"isCastInitiator",get:function(){return this._isCastInitiator},set:function(e){this._isCastInitiator=e}}])&&Ti(r.prototype,n),a&&Ti(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(p.FakeEventTarget);function Mi(e,t,r){return t=Oi(t),function(e,t){if(t&&("object"===Ui(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Di()?Reflect.construct(t,r||[],Oi(e).constructor):t.apply(e,r))}function Di(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Di=function(){return!!e})()}function Oi(e){return Oi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Oi(e)}function Li(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ni(e,t)}function Ni(e,t){return Ni=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ni(e,t)}function Ui(e){return Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ui(e)}function ji(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vi(n.key),n)}}function Fi(e,t,r){return t&&Bi(e.prototype,t),r&&Bi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vi(e){var t=function(e,t){if("object"!=Ui(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ui(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ui(t)?t:String(t)}Ii(Ri,"defaultConfig",{}),Ii(Ri,"Type","BaseRemotePlayer");var Gi=function(){function e(t){ji(this,e),this._player=t}return Fi(e,[{key:"player",get:function(){return this._player}}]),e}(),Hi=function(e){function t(e,r,n){var a;return ji(this,t),(a=Mi(this,t,[e]))._session=r,n&&(a._ui=n),a}return Li(t,e),Fi(t,[{key:"ui",get:function(){return this._ui}},{key:"session",get:function(){return this._session}}]),t}(Gi),Ki=function(e){function t(e,r){var n;return ji(this,t),(n=Mi(this,t,[e]))._snapshot=r,n}return Li(t,e),Fi(t,[{key:"snapshot",get:function(){return this._snapshot}}]),t}(Gi),Wi=function(e){function t(e,r){var n;return ji(this,t),(n=Mi(this,t,[e]))._available=r,n}return Li(t,e),Fi(t,[{key:"available",get:function(){return this._available}}]),t}(Gi);function $i(e){return $i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$i(e)}function zi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qi(n.key),n)}}function qi(e){var t=function(e,t){if("object"!=$i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$i(t)?t:String(t)}var Yi=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,r){(t=qi(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"_uis",[{template:function(e){return t.idleUI(e)},condition:function(e){return e.engine.isIdle}},{template:function(e){return t.errorUI(e)},condition:function(e){return e.engine.hasError}},{template:function(e){return t.adsUI(e)},condition:function(e){return e.engine.adBreak}},{template:function(e){return t.liveUI(e)},condition:function(e){return e.engine.isLive}},{template:function(e){return t.playbackUI(e)}}])}var t,r,n;return t=e,(r=[{key:"playbackUI",value:function(e){return h.Presets.playbackUI(e)}},{key:"idleUI",value:function(e){return h.Presets.idleUI(e)}},{key:"adsUI",value:function(e){return h.Presets.adsUI(e)}},{key:"liveUI",value:function(e){return h.Presets.liveUI(e)}},{key:"errorUI",value:function(e){return h.Presets.errorUI(e)}},{key:"uis",get:function(){return this._uis}}])&&zi(t.prototype,r),n&&zi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Xi(e){return Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xi(e)}function Zi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qi(n.key),n)}}function Qi(e){var t=function(e,t){if("object"!=Xi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Xi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xi(t)?t:String(t)}var Ji=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"toCastTextStyle",value:function(t){if(window.chrome&&window.chrome.cast){var r=new window.chrome.cast.media.TextTrackStyle;return r.fontFamily=t.fontFamily,r.backgroundColor=e.rgbToHex(t.backgroundColor),r.foregroundColor=e.rgbToHex(t.fontColor),r.fontScale=Number.parseFloat(t.fontSize)/100,r}return{}}},{key:"toPlayerTextStyle",value:function(t){var r=new p.TextStyle;return r.fontFamily=t.fontFamily,r.fontSize=100*t.fontScale+"%",r.fontColor=e.hexToRGB(t.foregroundColor),r.backgroundColor=e.hexToRGB(t.backgroundColor),r}},{key:"rgbToHex",value:function(e){var t="#"+("0"+parseInt(e[0],10).toString(16)).slice(-2)+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2);if(e[3]){var r=e[3];r=Math.round(100*r)/100,t+=(Math.round(255*r)+65536).toString(16).substr(-2).toUpperCase()}else t+="FF";return t.toUpperCase()}},{key:"hexToRGB",value:function(e){for(var t=[],r=(e=e.slice(1)).match(/.{1,2}/g),n=0;n<3;n++){var a=r&&r[n];a&&t.push(parseInt(a,16))}return t}}],(r=null)&&Zi(t.prototype,r),n&&Zi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function es(e){return es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},es(e)}function ts(e,t,r){return t=ns(t),function(e,t){if(t&&("object"===es(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,rs()?Reflect.construct(t,r||[],ns(e).constructor):t.apply(e,r))}function rs(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(rs=function(){return!!e})()}function ns(e){return ns=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ns(e)}function as(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&is(e,t)}function is(e,t){return is=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},is(e,t)}function ss(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ls(n.key),n)}}function os(e,t,r){return t&&ss(e.prototype,t),r&&ss(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ls(e){var t=function(e,t){if("object"!=es(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=es(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==es(t)?t:String(t)}function us(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var cs={ACTION:"action",EVENT:"event"},ds=os((function e(t){us(this,e),this.type=t})),ps=function(e){function t(e,r){var n;return us(this,t),(n=ts(this,t,[cs.EVENT])).event=e,n.payload=r,n}return as(t,e),os(t)}(ds),hs=function(e){function t(e,r){var n;return us(this,t),(n=ts(this,t,[cs.ACTION])).action=e,n.args=r,n}return as(t,e),os(t)}(ds),fs={registerRemotePlayer:na.register,PlayerSnapshot:wn,RemoteControl:Bn,RemoteSession:Ei,BaseRemotePlayer:Ri,RemoteConnectedPayload:Hi,RemoteDisconnectedPayload:Ki,RemoteAvailablePayload:Wi,RemotePlayerUI:Yi,CastEventType:On,RemotePlayerType:{CHROMECAST:"chromecast"},TextStyleConverter:Ji,CustomEventMessage:ps,CustomActionMessage:hs,CustomMessageType:cs,CustomActionType:{SKIP_AD:"skipAd"},CustomMessage:ds},ms={PlaylistEventType:cn};function gs(e){return gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gs(e)}function ys(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vs(n.key),n)}}function vs(e){var t=function(e,t){if("object"!=gs(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=gs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gs(t)?t:String(t)}var _s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t,this._system=r.system,this._url=r.url,this._contentType=r.contentType,this._title=r.title,this._position=r.position,this._duration=r.duration,this._clickThroughUrl=r.clickThroughUrl,this._posterUrl=r.posterUrl,this._skipOffset=r.skipOffset,this._linear=r.linear,this._width=r.width||0,this._height=r.height||0,this._bitrate=r.bitrate||0,this._bumper=r.bumper,this._inStream=r.inStream||!1,this._vpaid=r.vpaid||!1,this._streamId=r.streamId||"",this._wrapperAdIds=r.wrapperAdIds,this._wrapperCreativeIds=r.wrapperCreativeIds,this._wrapperAdSystems=r.wrapperAdSystems}var t,r,n;return t=e,(r=[{key:"id",get:function(){return this._id}},{key:"system",get:function(){return this._system}},{key:"contentType",get:function(){return this._contentType}},{key:"url",get:function(){return this._url}},{key:"title",get:function(){return this._title}},{key:"position",get:function(){return this._position}},{key:"duration",get:function(){return this._duration}},{key:"clickThroughUrl",get:function(){return this._clickThroughUrl}},{key:"posterUrl",get:function(){return this._posterUrl}},{key:"skipOffset",get:function(){return this._skipOffset}},{key:"linear",get:function(){return this._linear}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"bitrate",get:function(){return this._bitrate}},{key:"bumper",get:function(){return this._bumper}},{key:"inStream",get:function(){return this._inStream}},{key:"skippable",get:function(){return!!(this.skipOffset&&this.skipOffset>0)}},{key:"vpaid",get:function(){return this._vpaid}},{key:"streamId",get:function(){return this._streamId}},{key:"wrapperAdIds",get:function(){return this._wrapperAdIds}},{key:"wrapperCreativeIds",get:function(){return this._wrapperCreativeIds}},{key:"wrapperAdSystems",get:function(){return this._wrapperAdSystems}},{key:"toJSON",value:function(){return{id:this.id,system:this.system,url:this.url,contentType:this.contentType,title:this.title,position:this.position,duration:this.duration,clickThroughUrl:this.clickThroughUrl,posterUrl:this.posterUrl,skipOffset:this.skipOffset,linear:this.linear,skippable:this.skippable,width:this.width,height:this.height,bitrate:this.bitrate,bumper:this.bumper,inStream:this.inStream,vpaid:this.vpaid}}}])&&ys(t.prototype,r),n&&ys(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ks(e){return ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ks(e)}function Es(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bs(n.key),n)}}function bs(e){var t=function(e,t){if("object"!=ks(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ks(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ks(t)?t:String(t)}var Ts=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._type=t.type,this._position=t.position,this._numAds=t.numAds}var t,r,n;return t=e,(r=[{key:"type",get:function(){return this._type}},{key:"position",get:function(){return this._position}},{key:"numAds",get:function(){return this._numAds}},{key:"toJSON",value:function(){return{type:this.type,position:this.position,numAds:this.numAds}}}])&&Es(t.prototype,r),n&&Es(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();p.Ad=_s,p.AdBreak=Ts,p.BasePlugin=re,p.registerPlugin=ue;var As="@playkit-js/kaltura-player-js",Ss="ovp",Ps="3.17.61"})(),__webpack_exports__})()));
//# sourceMappingURL=kaltura-ovp-player.js.map
