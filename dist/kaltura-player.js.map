{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap d30cd46ad570d42c093d","webpack:///webpack:///core/webpack/universalModuleDefinition","webpack:///webpack:/core/webpack/bootstrap f0d05eef2d0b0c7d87a0","webpack:///webpack:///core/track/track.js","webpack:///webpack:///core/utils/logger.js","webpack:///webpack:///core/event/fake-event.js","webpack:///webpack:///core/track/audio-track.js","webpack:///webpack:///core/track/text-track.js","webpack:///webpack:///core/track/video-track.js","webpack:///webpack:///core/event/event-manager.js","webpack:///webpack:///core/event/events.js","webpack:///webpack:///core/player.js","webpack:///webpack:///core/utils/util.js","webpack:///webpack:///core/event/fake-event-target.js","webpack:///webpack:///core/utils/player-error.js","webpack:///webpack:///core/engines/html5/media-source/base-media-source-adapter.js","webpack:///webpack:///core/engines/html5/media-source/media-source-provider.js","webpack:///webpack:///core/plugin/base-plugin.js","webpack:///webpack:///core/plugin/plugin-manager.js","webpack:///webpack:///core/state/state-types.js","webpack:///webpack:///core/utils/multi-map.js","webpack:///webpack:///package.json","webpack:///webpack:///core/engines/html5/html5.js","webpack:///webpack:///core/engines/html5/media-source/adapters/native-adapter.js","webpack:///webpack:///core/playkit.js","webpack:///webpack:///core/state/state-manager.js","webpack:///webpack:///core/state/state.js","webpack:///webpack:///core/track/track-types.js","webpack:///webpack:///core/assets/style.css","webpack:///webpack:///~/css-loader/lib/css-base.js","webpack:///webpack:///~/js-logger/src/logger.js","webpack:///webpack:///assets/style.css","webpack:///webpack:///~/style-loader/lib/addStyles.js","webpack:///webpack:///~/style-loader/lib/urls.js","webpack:///webpack:///core/player-config.json","webpack:///../node_modules/webpack/buildin/module.js","webpack:///webpack:///providers/webpack/universalModuleDefinition","webpack:///webpack:/providers/webpack/bootstrap 638014c152c6bb21e972","webpack:///webpack:///providers/k-provider/request-builder.js","webpack:///webpack:///providers/k-provider/ovp/config.js","webpack:///webpack:///providers/k-provider/enums.js","webpack:///webpack:///providers/k-provider/ovp/services/ovp-service.js","webpack:///webpack:///providers/k-provider/base-service-result.js","webpack:///webpack:///providers/util/logger.js","webpack:///webpack:///providers/k-provider/multi-request-builder.js","webpack:///webpack:///providers/entities/media-sources.js","webpack:///webpack:///providers/entities/media-entry.js","webpack:///webpack:///providers/entities/drm.js","webpack:///webpack:///providers/entities/media-format.js","webpack:///webpack:///providers/entities/media-source.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-flavor-asset.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-media-entry.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-metadata-list-response.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-playback-context.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-playback-source.js","webpack:///webpack:///~/enumify/lib/enumify.js","webpack:///webpack:///providers/k-provider/ovp/loaders/data-loader-manager.js","webpack:///webpack:///providers/k-provider/ovp/loaders/media-entry-loader.js","webpack:///webpack:///providers/k-provider/ovp/loaders/session-loader.js","webpack:///webpack:///providers/k-provider/ovp/loaders/ui-config-loader.js","webpack:///webpack:///providers/k-provider/ovp/provider-parser.js","webpack:///webpack:///providers/k-provider/ovp/ovp-provider.js","webpack:///webpack:///providers/k-provider/ovp/play-source-url-builder.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-access-control-message.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-base-entry-list-response.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-drm-playback-plugin-data.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-metadata.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-rule-action.js","webpack:///webpack:///providers/k-provider/ovp/response-types/kaltura-ui-conf-response.js","webpack:///webpack:///providers/k-provider/ovp/services/base-entry-service.js","webpack:///webpack:///providers/k-provider/ovp/services/meta-data-service.js","webpack:///webpack:///providers/k-provider/ovp/services/session-service.js","webpack:///webpack:///providers/k-provider/ovp/services/ui-conf-service.js","webpack:///webpack:///providers/k-provider/xml-parser.js","webpack:///./index.js","webpack:///webpack:///ui/webpack/universalModuleDefinition","webpack:///webpack:/ui/webpack/bootstrap 22c3c46a80b1c7885159","webpack:///webpack:///node_modules/preact/dist/preact.js","webpack:///webpack:///node_modules/preact-redux/dist/preact-redux.js","webpack:///webpack:///ui/components/base.js","webpack:///webpack:///ui/utils/bind-actions.js","webpack:///webpack:///ui/components/icon/icon.js","webpack:///webpack:///node_modules/preact-i18n/dist/preact-i18n.js","webpack:///webpack:///node_modules/redux/es/index.js","webpack:///webpack:///node_modules/redux/es/utils/warning.js","webpack:///webpack:///ui/reducers/shell.js","webpack:///webpack:///ui/reducers/play-pause.js","webpack:///webpack:///ui/reducers/share.js","webpack:///webpack:///node_modules/process/browser.js","webpack:///webpack:///node_modules/redux/es/createStore.js","webpack:///webpack:///node_modules/lodash-es/isPlainObject.js","webpack:///webpack:///node_modules/lodash-es/_Symbol.js","webpack:///webpack:///node_modules/webpack/buildin/global.js","webpack:///webpack:///node_modules/redux/es/compose.js","webpack:///webpack:///ui/reducers/engine.js","webpack:///webpack:///ui/reducers/seekbar.js","webpack:///webpack:///ui/reducers/volume.js","webpack:///webpack:///ui/reducers/fullscreen.js","webpack:///webpack:///ui/reducers/loading.js","webpack:///webpack:///ui/reducers/cvaa.js","webpack:///webpack:///ui/reducers/settings.js","webpack:///webpack:///ui/utils/time-format.js","webpack:///webpack:///ui/components/smart-container/smart-container.js","webpack:///webpack:///ui/components/smart-container/smart-container-item.js","webpack:///webpack:///ui/components/overlay/overlay.js","webpack:///webpack:///ui/ui-manager.js","webpack:///webpack:///node_modules/lodash-es/_baseGetTag.js","webpack:///webpack:///node_modules/lodash-es/_root.js","webpack:///webpack:///node_modules/lodash-es/_freeGlobal.js","webpack:///webpack:///node_modules/lodash-es/_getRawTag.js","webpack:///webpack:///node_modules/lodash-es/_objectToString.js","webpack:///webpack:///node_modules/lodash-es/_getPrototype.js","webpack:///webpack:///node_modules/lodash-es/_overArg.js","webpack:///webpack:///node_modules/lodash-es/isObjectLike.js","webpack:///webpack:///node_modules/symbol-observable/index.js","webpack:///webpack:///node_modules/symbol-observable/lib/index.js","webpack:///webpack:///node_modules/webpack/buildin/module.js","webpack:///webpack:///node_modules/symbol-observable/lib/ponyfill.js","webpack:///webpack:///node_modules/redux/es/combineReducers.js","webpack:///webpack:///node_modules/redux/es/bindActionCreators.js","webpack:///webpack:///node_modules/redux/es/applyMiddleware.js","webpack:///webpack:///ui/store.js","webpack:///webpack:///ui/fr.json","webpack:///webpack:///ui/components/engine-connector/engine-connector.js","webpack:///webpack:/ui/external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}","webpack:///webpack:///ui/utils/logger.js","webpack:///webpack:///node_modules/js-logger/src/logger.js","webpack:///webpack:///ui/components/shell/shell.js","webpack:///webpack:///ui/utils/is-mobile.js","webpack:///webpack:///ui/components/overlay-play/overlay-play.js","webpack:///webpack:///ui/components/loading/loading.js","webpack:///webpack:///ui/components/play-pause/play-pause.js","webpack:///webpack:///ui/components/seekbar/seekbar.js","webpack:///webpack:///ui/components/volume/volume.js","webpack:///webpack:///ui/components/share/share.js","webpack:///webpack:///ui/components/settings/settings.js","webpack:///webpack:///ui/components/dropdown-menu/dropdown-menu.js","webpack:///webpack:///ui/components/language/language.js","webpack:///webpack:///ui/components/fullscreen/fullscreen.js","webpack:///webpack:///ui/components/time-display/time-display.js","webpack:///webpack:///ui/components/top-bar/top-bar.js","webpack:///webpack:///ui/components/bottom-bar/bottom-bar.js","webpack:///webpack:///ui/components/share-overlay/share-overlay.js","webpack:///webpack:///ui/components/cvaa-overlay/cvaa-overlay.js","webpack:///webpack:///ui/components/keyboard.js","webpack:///../node_modules/playkit-js-ui/src/styles/style.css?b4f7","webpack:///../node_modules/playkit-js-ui/src/styles/style.css","webpack:///../node_modules/css-loader/lib/css-base.js","webpack:///../node_modules/style-loader/lib/addStyles.js","webpack:///../node_modules/style-loader/lib/urls.js","webpack:///webpack:///hls/webpack/universalModuleDefinition","webpack:///webpack:/hls/webpack/bootstrap 3d553f6cfbde57d4496a","webpack:///webpack:///hls/hls-adapter.js","webpack:///webpack:/hls/external {\"commonjs\":\"hls.js\",\"commonjs2\":\"hls.js\",\"amd\":\"hls.js\",\"root\":\"Hls\"}","webpack:///webpack:/hls/external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}","webpack:///node_modules/browser-pack/_prelude.js","webpack:///node_modules/events/events.js","webpack:///node_modules/url-toolkit/src/url-toolkit.js","webpack:///node_modules/webworkify/index.js","webpack:///src/config.js","webpack:///src/controller/abr-controller.js","webpack:///src/controller/audio-stream-controller.js","webpack:///src/controller/audio-track-controller.js","webpack:///src/controller/buffer-controller.js","webpack:///src/controller/cap-level-controller.js","webpack:///src/controller/fps-controller.js","webpack:///src/controller/id3-track-controller.js","webpack:///src/controller/level-controller.js","webpack:///src/controller/stream-controller.js","webpack:///src/controller/subtitle-stream-controller.js","webpack:///src/controller/subtitle-track-controller.js","webpack:///src/controller/timeline-controller.js","webpack:///src/crypt/aes-crypto.js","webpack:///src/crypt/aes-decryptor.js","webpack:///src/crypt/decrypter.js","webpack:///src/crypt/fast-aes-key.js","webpack:///src/demux/aacdemuxer.js","webpack:///src/demux/adts.js","webpack:///src/demux/demuxer-inline.js","webpack:///src/demux/demuxer-worker.js","webpack:///src/demux/demuxer.js","webpack:///src/demux/exp-golomb.js","webpack:///src/demux/id3.js","webpack:///src/demux/mp3demuxer.js","webpack:///src/demux/mp4demuxer.js","webpack:///src/demux/mpegaudio.js","webpack:///src/demux/sample-aes.js","webpack:///src/demux/tsdemuxer.js","webpack:///src/errors.js","webpack:///src/event-handler.js","webpack:///src/events.js","webpack:///src/helper/aac.js","webpack:///src/helper/buffer-helper.js","webpack:///src/helper/level-helper.js","webpack:///src/hls.js","webpack:///src/index.js","webpack:///src/loader/fragment-loader.js","webpack:///src/loader/key-loader.js","webpack:///src/loader/playlist-loader.js","webpack:///src/remux/mp4-generator.js","webpack:///src/remux/mp4-remuxer.js","webpack:///src/remux/passthrough-remuxer.js","webpack:///src/utils/attr-list.js","webpack:///src/utils/binary-search.js","webpack:///src/utils/cea-608-parser.js","webpack:///src/utils/cues.js","webpack:///src/utils/ewma-bandwidth-estimator.js","webpack:///src/utils/ewma.js","webpack:///src/utils/logger.js","webpack:///src/utils/timeRanges.js","webpack:///src/utils/vttcue.js","webpack:///src/utils/vttparser.js","webpack:///src/utils/webvtt-parser.js","webpack:///src/utils/xhr-loader.js","webpack:///webpack:///dash/webpack/universalModuleDefinition","webpack:///webpack:/dash/webpack/bootstrap 37792bb50222e2c929fb","webpack:///webpack:///dash/dash-adapter.js","webpack:///webpack:/dash/external {\"commonjs\":\"shaka-player\",\"commonjs2\":\"shaka-player\",\"amd\":\"shaka-player\",\"root\":\"shaka\"}","webpack:///webpack:/dash/external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}","webpack:///../node_modules/shaka-player/third_party/closure/goog/base.js","webpack:///../node_modules/shaka-player/lib/cast/cast_proxy.js","webpack:///../node_modules/shaka-player/lib/abr/ewma.js","webpack:///../node_modules/shaka-player/lib/abr/ewma_bandwidth_estimator.js","webpack:///../node_modules/shaka-player/lib/debug/log.js","webpack:///../node_modules/shaka-player/lib/util/error.js","webpack:///../node_modules/shaka-player/third_party/closure/goog/uri/utils.js","webpack:///../node_modules/shaka-player/third_party/closure/goog/uri/uri.js","webpack:///../node_modules/shaka-player/lib/util/functional.js","webpack:///../node_modules/shaka-player/lib/util/manifest_parser_utils.js","webpack:///../node_modules/shaka-player/lib/util/config_utils.js","webpack:///../node_modules/shaka-player/lib/util/public_promise.js","webpack:///../node_modules/shaka-player/lib/net/networking_engine.js","webpack:///../node_modules/shaka-player/lib/util/array_utils.js","webpack:///../node_modules/shaka-player/lib/util/multi_map.js","webpack:///../node_modules/shaka-player/lib/util/event_manager.js","webpack:///../node_modules/shaka-player/lib/util/map_utils.js","webpack:///../node_modules/shaka-player/lib/util/string_utils.js","webpack:///../node_modules/shaka-player/lib/util/timer.js","webpack:///../node_modules/shaka-player/lib/util/uint8array_utils.js","webpack:///../node_modules/shaka-player/lib/media/drm_engine.js","webpack:///../node_modules/shaka-player/lib/media/text_engine.js","webpack:///../node_modules/shaka-player/lib/media/time_ranges_utils.js","webpack:///../node_modules/shaka-player/lib/media/media_source_engine.js","webpack:///../node_modules/shaka-player/lib/util/language_utils.js","webpack:///../node_modules/shaka-player/lib/util/stream_utils.js","webpack:///../node_modules/shaka-player/lib/abr/simple_abr_manager.js","webpack:///../node_modules/shaka-player/lib/util/fake_event.js","webpack:///../node_modules/shaka-player/lib/cast/cast_utils.js","webpack:///../node_modules/shaka-player/lib/cast/cast_sender.js","webpack:///../node_modules/shaka-player/lib/util/fake_event_target.js","webpack:///../node_modules/shaka-player/lib/player.js","webpack:///../node_modules/shaka-player/lib/cast/cast_receiver.js","webpack:///../node_modules/shaka-player/lib/util/xml_utils.js","webpack:///../node_modules/shaka-player/lib/dash/content_protection.js","webpack:///../node_modules/shaka-player/lib/dash/mpd_utils.js","webpack:///../node_modules/shaka-player/lib/media/segment_reference.js","webpack:///../node_modules/shaka-player/lib/util/data_view_reader.js","webpack:///../node_modules/shaka-player/lib/util/mp4_parser.js","webpack:///../node_modules/shaka-player/lib/media/mp4_segment_index_parser.js","webpack:///../node_modules/shaka-player/lib/media/segment_index.js","webpack:///../node_modules/shaka-player/lib/util/ebml_parser.js","webpack:///../node_modules/shaka-player/lib/media/webm_segment_index_parser.js","webpack:///../node_modules/shaka-player/lib/dash/segment_base.js","webpack:///../node_modules/shaka-player/lib/dash/segment_list.js","webpack:///../node_modules/shaka-player/lib/dash/segment_template.js","webpack:///../node_modules/shaka-player/lib/media/manifest_parser.js","webpack:///../node_modules/shaka-player/lib/media/presentation_timeline.js","webpack:///../node_modules/shaka-player/lib/dash/dash_parser.js","webpack:///../node_modules/shaka-player/lib/hls/hls_classes.js","webpack:///../node_modules/shaka-player/lib/hls/hls_utils.js","webpack:///../node_modules/shaka-player/lib/util/text_parser.js","webpack:///../node_modules/shaka-player/lib/hls/manifest_text_parser.js","webpack:///../node_modules/shaka-player/lib/net/data_uri_plugin.js","webpack:///../node_modules/shaka-player/lib/hls/hls_parser.js","webpack:///../node_modules/shaka-player/lib/media/ttml_text_parser.js","webpack:///../node_modules/shaka-player/lib/media/mp4_ttml_parser.js","webpack:///../node_modules/shaka-player/lib/media/vtt_text_parser.js","webpack:///../node_modules/shaka-player/lib/media/mp4_vtt_parser.js","webpack:///../node_modules/shaka-player/lib/media/playhead.js","webpack:///../node_modules/shaka-player/lib/media/playhead_observer.js","webpack:///../node_modules/shaka-player/lib/media/streaming_engine.js","webpack:///../node_modules/shaka-player/lib/net/http_plugin.js","webpack:///../node_modules/shaka-player/lib/offline/db_engine.js","webpack:///../node_modules/shaka-player/lib/offline/download_manager.js","webpack:///../node_modules/shaka-player/lib/offline/offline_utils.js","webpack:///../node_modules/shaka-player/lib/offline/offline_manifest_parser.js","webpack:///../node_modules/shaka-player/lib/offline/offline_scheme.js","webpack:///../node_modules/shaka-player/lib/util/cancelable_chain.js","webpack:///../node_modules/shaka-player/lib/offline/storage.js","webpack:///../node_modules/shaka-player/lib/polyfill/all.js","webpack:///../node_modules/shaka-player/lib/polyfill/fullscreen.js","webpack:///../node_modules/shaka-player/lib/polyfill/indexed_db.js","webpack:///../node_modules/shaka-player/lib/polyfill/mathround.js","webpack:///../node_modules/shaka-player/lib/util/pssh.js","webpack:///../node_modules/shaka-player/lib/polyfill/patchedmediakeys_ms.js","webpack:///../node_modules/shaka-player/lib/polyfill/patchedmediakeys_nop.js","webpack:///../node_modules/shaka-player/lib/polyfill/patchedmediakeys_webkit.js","webpack:///../node_modules/shaka-player/lib/polyfill/mediakeys.js","webpack:///../node_modules/shaka-player/lib/polyfill/mediasource.js","webpack:///../node_modules/shaka-player/lib/polyfill/promise.js","webpack:///../node_modules/shaka-player/lib/polyfill/video_play_promise.js","webpack:///../node_modules/shaka-player/lib/polyfill/videoplaybackquality.js","webpack:///../node_modules/shaka-player/lib/polyfill/vttcue.js","webpack:///./setup.js","webpack:///./session-id.js"],"names":["Playkit","OvpProvider","PlaykitUI","setup","BaseComponent","obj","config","name","player","logger","getLogger","debug","attr","bindActions","actions","dispatch","Icon","props","type","types","ADD_PLAYER_CLASS","REMOVE_PLAYER_CLASS","UPDATE_IS_MOBILE","initialState","playerClasses","state","action","className","filter","c","isMobile","addPlayerClass","removePlayerClass","updateIsMobile","TOGGLE_PLAY","isPlaying","toggleIsPlaying","TOGGLE_SHARE_OVERLAY","overlayOpen","show","toggleShareOverlay","UPDATE_PLAYER_STATE","UPDATE_IS_PLAYING","UPDATE_CURRENT_TIME","UPDATE_DURATION","UPDATE_VOLUME","UPDATE_METADATA_LOADING_STATUS","UPDATE_AUDIO_TRACKS","UPDATE_VIDEO_TRACKS","UPDATE_TEXT_TRACKS","metadataLoaded","playerState","currentState","currentTime","volume","muted","videoTracks","audioTracks","textTracks","duration","UPDATE_MUTED","tracks","updateIsPlaying","updateCurrentTime","updateDuration","updateVolume","updateMetadataLoadingStatus","updateAudioTracks","updateVideoTracks","updateTextTracks","UPDATE_SEEKBAR_DRAGGING_STATUS","draggingActive","updateSeekbarDraggingStatus","UPDATE_VOLUME_DRAGGING_STATUS","updateMuted","fullscreen","UPDATE_FULLSCREEN","updateFullscreen","UPDATE_LOADING_SPINNER_STATE","showLoadingSpinner","updateLoadingSpinnerState","TOGGLE_CVAA_OVERLAY","toggleCVAAOverlay","UPDATE_QUALITY","UPDATE_SPEED","quality","speed","updateQuality","updateSpeed","toHHMMSS","input","sec_num","parseInt","hours","Math","floor","minutes","seconds","SmartContainer","children","label","onSelect","o","options","Overlay","open","overlayClass","onClose","ui","store","template","_buildUI","playerWrapper","document","body","appendChild","playerElement","removeAttribute","getElementsByClassName","engine","seekbar","loading","playPause","share","cvaa","settings","reducer","addEventListener","updatePlayerState","getTracks","TrackType","AUDIO","VIDEO","TEXT","Event","PLAY","PAUSE","EngineConnector","LOG_LEVEL","JsLogger","DEBUG","TIME","ERROR","OFF","LoggerFactory","useDefaults","get","lf","defaultLevel","shell","Shell","mapStateToProps","window","orientation","setTimeout","setState","animation","paused","pause","togglePlayPause","Loading","play","controlButtonClass","PlayPauseControl","isDraggingActive","SeekBarControl","onSeekbarMouseDown","onSeekbarMouseUp","time","getTime","e","updateSeekBarProgress","onSeekbarMouseMove","_playerElement","_seekBarElement","virtual","parseFloat","toFixed","virtualProgressWidth","virtualTime","progressWidth","framePreviewStyle","width","showFramePreview","showTimeBubble","VolumeControl","_volumeControlElement","round","changeVolume","barHeight","_volumeProgressBarElement","clientHeight","topY","getCoords","clickY","el","box","getBoundingClientRect","top","pageYOffset","left","pageXOffset","onVolumeProgressBarMouseDown","ShareControl","smartContainerOpen","value","speedOptions","length","onQualityChange","t","active","dropMenuActive","isSelected","DropDownMenu","LanguageControl","textTrack","onControlButtonClick","onAudioChange","onCaptionsChange","webkitIsFullScreen","webkitRequestFullscreen","webkitCancelFullScreen","exitFullscreen","toggleFullscreen","TimeDisplay","result","format","total","replace","TopBar","BottomBar","ShareOverlay","KeyboardControl","which","newVolume","disableKeyboardCommandsOnControls","controlButtonsElements","Array","forEach","element","onkeydown","preventDefault","HlsAdapter","mimeType","canHlsPlayType","_hlsMimeTypes","includes","toLowerCase","_logger","toString","isHlsSupported","isSupported","videoElement","source","version","_hls","_config","_addBindings","on","Events","_onError","bind","LEVEL_SWITCHED","_onLevelSwitched","AUDIO_TRACK_SWITCHED","_onAudioTrackSwitched","_loadPromise","Promise","resolve","MANIFEST_LOADED","event","data","_playerTracks","_parseTracks","_sourceObj","url","loadSource","attachMedia","_videoElement","_removeBindings","detachMedia","destroy","_parseAudioTracks","_parseVideoTracks","levels","_parseTextTracks","concat","hlsAudioTracks","i","id","audioTrack","language","lang","index","push","hlsVideoTracks","startLevel","bandwidth","bitrate","vidTextTracks","mode","kind","videoTrack","autoLevelEnabled","nextLevel","_disableAllTextTracks","_onTrackChanged","find","track","level","errorType","errorDetails","details","errorFatal","fatal","ErrorTypes","NETWORK_ERROR","error","startLoad","MEDIA_ERROR","recoverMediaError","ErrorDetails","MANIFEST_LOAD_ERROR","MANIFEST_LOAD_TIMEOUT","MANIFEST_PARSING_ERROR","LEVEL_LOAD_ERROR","LEVEL_LOAD_TIMEOUT","LEVEL_SWITCH_ERROR","FRAG_LOAD_ERROR","FRAG_LOOP_LOADING_ERROR","FRAG_LOAD_TIMEOUT","FRAG_PARSING_ERROR","BUFFER_APPEND_ERROR","BUFFER_APPENDING_ERROR","off","DashAdapter","canPlayType","_dashMimeType","polyfill","installAll","Player","isBrowserSupported","_shaka","configure","_onAdaptation","removeEventListener","reject","load","then","_getParsedTracks","catch","variantTracks","getVariantTracks","activeVariantTrack","variantTrack","audioId","videoId","_getParsedVideoTracks","_getParsedAudioTracks","_getParsedTextTracks","_getVideoTracks","parsedTracks","_getAudioTracks","getTextTracks","selectedVideoTrack","abr","enabled","selectVariantTrack","selectAudioLanguage","selectTextLanguage","goog.global","goog.global.CLOSURE_NO_DEPS","CLOSURE_NO_DEPS","goog.exportSymbol","publicPath","object","parts","split","cur","execScript","part","shift","goog.inherits","childCtor","shaka.util.FakeEventTarget","tempCtor","prototype","parentCtor","superClass_","constructor","base","childCtor.base","me","methodName","var_args","apply","slice","call","args","arguments","shaka.abr.Ewma","halfLife","alpha_","exp","log","totalWeight_","estimate_","shaka.abr.Ewma.prototype.sample","weight","adjAlpha","pow","newEstimate","isNaN","shaka.abr.Ewma.prototype.getEstimate","shaka.abr.EwmaBandwidthEstimator","fast_","slow_","bytesSampled_","defaultEstimate_","shaka.abr.EwmaBandwidthEstimator.DEFAULT_ESTIMATE","setDefaultEstimate","shaka.abr.EwmaBandwidthEstimator.prototype.setDefaultEstimate","estimate","getBandwidthEstimate","shaka.abr.EwmaBandwidthEstimator.prototype.getBandwidthEstimate","minTotalBytes_","min","getEstimate","shaka.log.error","shaka.util.Error","severity","category","code","Error","shaka.util.Error.prototype.toString","JSON","stringify","shaka.util.Error.Severity","shaka.util.Error.Category","shaka.util.Error.Code","goog.uri.utils.splitRe_","goog.Uri","opt_uri","m","setScheme","scheme_","setUserInfo","userInfo_","setDomain","domain_","setPort","port_","setPath","path_","setQueryData","clone","queryData_","setFragment","fragment_","String","uri","match","SCHEME","goog.Uri.decodeOrEmpty_","USER_INFO","DOMAIN","PORT","PATH","QUERY_DATA","FRAGMENT","goog.Uri.QueryData","goog$Uri.prototype","goog.Uri.prototype","goog.Uri.prototype.toString","out","scheme","getScheme","goog.Uri.encodeSpecialChars_","goog.Uri.reDisallowedInSchemeOrUserInfo_","domain","getDomain","userInfo","getUserInfo","encodeURIComponent","doubleEncodedString","port","getPort","path","getPath","hasDomain","charAt","goog.Uri.reDisallowedInAbsolutePath_","goog.Uri.reDisallowedInRelativePath_","query","getEncodedQuery","fragment","getFragment","goog.Uri.reDisallowedInFragment_","join","goog.Uri.prototype.resolve","relativeUri","absoluteUri","overridden","hasPath","lastSlashIndex","lastIndexOf","substr","indexOf","leadingSlash","segments","pos","segment","pop","goog.Uri.prototype.setScheme","newScheme","opt_decode","goog.Uri.prototype.setPort","newPort","Number","goog.Uri.prototype.setQueryData","queryData","goog.Uri.reDisallowedInQuery_","val","opt_preserveReserved","decodeURI","decodeURIComponent","unescapedPart","extra","opt_removeDoubleEncoding","encoded","encodeURI","goog.Uri.encodeChar_","ch","n","charCodeAt","opt_query","encodedQuery_","keyMap_","count_","goog.Uri.QueryData.prototype.toString","sb","key","encodedKey","j","param","goog.Uri.QueryData.prototype.clone","rv","cloneMap","shaka.util.Functional.createFallbackPromiseChain","array","callback","reduce","promise","elem","shaka.util.Functional.collapseArrays","all","shaka.util.Functional.noop","shaka.util.Functional.isNotNull","shaka.util.Functional.isNotEqualFunc","compare","a","shaka.util.Functional.isNotDuplicate","item","position","self","shaka.util.ManifestParserUtils.resolveUris","baseUris","relativeUris","relativeAsGoog","map","shaka.util.ManifestParserUtils.createDrmInfo","keySystem","initData","licenseServerUri","distinctiveIdentifierRequired","persistentStateRequired","audioRobustness","videoRobustness","serverCertificate","keyIds","shaka.util.ConfigUtils.mergeConfigObjects","destination","overrides","ignoreKeys","k","subPath","subTemplate","copyObject","undefined","shaka.util.ConfigUtils.cloneObject","arg","parse","shaka.util.PublicPromise","resolvePromise","rejectPromise","shaka.net.NetworkingEngine","opt_onSegmentDownloaded","destroyed_","requests_","requestFilters_","responseFilters_","onSegmentDownloaded_","NetworkingEngine","shaka.net.NetworkingEngine.RequestType","shaka.net.NetworkingEngine.schemes_","shaka.net.NetworkingEngine.registerScheme","plugin","shaka.net.NetworkingEngine.unregisterScheme","registerRequestFilter","shaka.net.NetworkingEngine.prototype.registerRequestFilter","goog.exportProperty","unregisterRequestFilter","shaka.net.NetworkingEngine.prototype.unregisterRequestFilter","filters","splice","clearAllRequestFilters","shaka.net.NetworkingEngine.prototype.clearAllRequestFilters","registerResponseFilter","shaka.net.NetworkingEngine.prototype.registerResponseFilter","unregisterResponseFilter","shaka.net.NetworkingEngine.prototype.unregisterResponseFilter","clearAllResponseFilters","shaka.net.NetworkingEngine.prototype.clearAllResponseFilters","shaka.net.NetworkingEngine.defaultRetryParameters","maxAttempts","baseDelay","backoffFactor","fuzzFactor","timeout","shaka.net.NetworkingEngine.makeRequest","uris","retryParams","method","headers","allowCrossSiteCredentials","retryParameters","shaka.net.NetworkingEngine.prototype.destroy","cleanup","request","shaka.net.NetworkingEngine.prototype.request","filterStartMs","Date","now","p","requestFilter","shaka.util.Error.Severity.CRITICAL","shaka.util.Error.Category.NETWORK","shaka.util.Error.Code.REQUEST_FILTER_ERROR","filterTimeMs","retry","delay","send_","err","shaka.util.Error.Severity.RECOVERABLE","random","resend_","response","fromCache","shaka.net.NetworkingEngine.RequestType.SEGMENT","timeMs","byteLength","shaka.net.NetworkingEngine.prototype.send_","requestFilterTime","location","protocol","shaka.util.Error.Code.UNSUPPORTED_SCHEME","startTimeMs","responseFilter","shaka.util.Error.Code.RESPONSE_FILTER_ERROR","shaka.util.ArrayUtils.removeDuplicates","opt_compareFn","matchFound","shaka.util.ArrayUtils.indexOf","compareFn","shaka.util.MultiMap","map_","shaka.util.MultiMap.prototype.push","hasOwnProperty","shaka.util.MultiMap.prototype.get","list","remove","shaka.util.MultiMap.prototype.remove","shaka.util.EventManager","bindingMap_","shaka.util.EventManager.prototype.destroy","removeAll","shaka.util.EventManager.prototype.listen","target","listener","binding","shaka.util.EventManager.Binding_","shaka.util.EventManager.prototype.listenOnce","listen","unlisten","shaka.util.EventManager.prototype.unlisten","shaka.util.EventManager.prototype.removeAll","shaka.util.EventManager.Binding_.prototype.unlisten","shaka.util.MapUtils.empty","Object","keys","shaka.util.MapUtils.values","shaka.util.MapUtils.map","ret","shaka.util.MapUtils.every","every","shaka.util.MapUtils.forEach","shaka.util.StringUtils.fromUTF8","uint8","Uint8Array","subarray","escaped","escape","shaka.util.StringUtils.fromCharCode_","utf8","shaka.util.Error.Category.TEXT","shaka.util.Error.Code.BAD_ENCODING","fromUTF8","shaka.util.StringUtils.fromUTF16","littleEndian","opt_noThrow","ArrayBuffer","buffer","temp","set","arr","Uint16Array","dataView","DataView","getUint16","fromUTF16","shaka.util.StringUtils.fromBytesAutoDetect","isAscii","shaka.util.Error.Code.UNABLE_TO_DETECT_ENCODING","fromBytesAutoDetect","shaka.util.StringUtils.toUTF8","str","unescape","toUTF8","max","fromCharCode","subArray","shaka.util.Timer","id_","callback_","cancel","shaka.util.Timer.prototype.cancel","clearTimeout","shaka.util.Timer.prototype.schedule","shaka.util.Uint8ArrayUtils.toBase64","opt_padding","padding","base64","btoa","bytes","toBase64","shaka.util.Uint8ArrayUtils.fromBase64","atob","fromBase64","shaka.util.Uint8ArrayUtils.fromHex","fromHex","shaka.util.Uint8ArrayUtils.toHex","hex","toHex","shaka.util.Uint8ArrayUtils.equal","arr1","arr2","equal","shaka.util.Uint8ArrayUtils.concat","totalLength","offset","shaka.media.DrmEngine","networkingEngine","onError","onKeyStatus","onExpirationUpdated","video_","mediaKeys_","supportedTypes_","initialized_","currentDrmInfo_","eventManager_","activeSessions_","offlineSessionIds_","allSessionsLoaded_","networkingEngine_","config_","onError_","keyStatusByKeyId_","onKeyStatus_","onExpirationUpdated_","keyStatusTimer_","processKeyStatusChanges_","isOffline_","mediaKeyMessageEvents_","initialRequestsSent_","expirationInterval_","setInterval","pollExpiration_","shaka$media$DrmEngine.prototype","shaka.media.DrmEngine.prototype","shaka.media.DrmEngine.prototype.destroy","async","activeSession","session","close","setMediaKeys","clearInterval","shaka.media.DrmEngine.prototype.configure","init","shaka.media.DrmEngine.prototype.init","manifest","offline","configsByKeySystem","keySystemsInOrder","offlineSessionIds","prepareMediaKeyConfigs_","queryMediaKeys_","shaka.media.DrmEngine.prototype.attach","video","listenOnce","shaka.util.Error.Category.DRM","shaka.util.Error.Code.ENCRYPTED_CONTENT_WITHOUT_DRM_INFO","onPlay_","exception","shaka.util.Error.Code.FAILED_TO_ATTACH_TO_VIDEO","message","setServerCertificate","shaka.util.Error.Code.INVALID_SERVER_CERTIFICATE","createOrLoad","onEncrypted_","onEncrypted","shaka.media.DrmEngine.prototype.removeSessions","sessions","sessionId","loadOfflineSession_","updatePromise","shaka.media.DrmEngine.prototype.createOrLoad","initDatas","initDataOverride","createTemporarySession_","initDataType","shaka.media.DrmEngine.prototype.keySystem","shaka.media.DrmEngine.prototype.getSessionIds","getExpiration","shaka.media.DrmEngine.prototype.getExpiration","expirations","expiration","Infinity","shaka.media.DrmEngine.prototype.prepareMediaKeyConfigs_","clearKeyDrmInfo","configureClearKey_","periods","period","variants","variant","drmInfos","drmInfo","fillInDrmInfoDefaults_","cast","__platform__","audioCapabilities","videoCapabilities","distinctiveIdentifier","persistentState","sessionTypes","streams","audio","stream","capabilities","robustness","fullMimeType","codecs","contentType","shaka.media.DrmEngine.prototype.queryMediaKeys_","shaka.util.Error.Code.NO_RECOGNIZED_KEY_SYSTEMS","instigator","shouldHaveLicenseServer","some","hasLicenseServer","info","navigator","requestMediaKeySystemAccess","shaka.util.Error.Code.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE","mediaKeySystemAccess","isEdge","userAgent","realConfig","getConfiguration","caps","originalConfig","createCurrentDrmInfo_","createMediaKeys","shaka.util.Error.Code.NO_LICENSE_SERVER_GIVEN","mediaKeys","shaka.util.Error.Code.FAILED_TO_CREATE_CDM","shaka.media.DrmEngine.prototype.fillInDrmInfoDefaults_","server","servers","advanced","shaka.media.DrmEngine.prototype.configureClearKey_","clearKeys","keyIdHex","keyHex","keyId","keyObj","kty","kid","license","jwkSet","initDataStr","shaka.media.DrmEngine.prototype.createCurrentDrmInfo_","licenseServers","serverCerts","processDrmInfos_","shaka.media.DrmEngine.prototype.processDrmInfos_","initDataOverrideEqual","b","shaka.media.DrmEngine.prototype.onEncrypted_","shaka.media.DrmEngine.prototype.loadOfflineSession_","createSession","shaka.util.Error.Code.FAILED_TO_CREATE_SESSION","onSessionMessage_","onKeyStatusesChange_","loaded","oldExpiration","present","s","shaka.util.Error.Code.OFFLINE_SESSION_REMOVED","shaka.media.DrmEngine.prototype.createTemporarySession_","generateRequest","shaka.util.Error.Code.FAILED_TO_GENERATE_LICENSE_REQUEST","shaka.media.DrmEngine.prototype.onSessionMessage_","delayLicenseRequest_","delayLicenseRequestUntilPlayed","sendLicenseRequest_","shaka.media.DrmEngine.prototype.sendLicenseRequest_","unpackPlayReadyRequest_","shaka.net.NetworkingEngine.RequestType.LICENSE","update","shakaErr","shaka.util.Error.Code.LICENSE_REQUEST_FAILED","shaka.util.Error.Code.LICENSE_RESPONSE_REJECTED","shaka.media.DrmEngine.prototype.unpackPlayReadyRequest_","xml","dom","parseFromString","DOMParser","getElementsByTagName","querySelector","textContent","challenge","shaka.media.DrmEngine.prototype.onKeyStatusesChange_","hasExpiredKeys","keyStatuses","status","tmp","part0","getUint32","part1","part2","setUint32","setUint16","msUntilExpiration","schedule","shaka.media.DrmEngine.prototype.processKeyStatusChanges_","isExpired","shaka.util.Error.Code.EXPIRED","shaka.media.DrmEngine.probeSupport","tests","basicVideoCapabilities","configs","offlineConfig","basicConfig","support","testKeySystems","access","shaka.media.DrmEngine.prototype.onPlay_","shaka.media.DrmEngine.prototype.isSupportedByKeySystem","shaka.media.DrmEngine.getCommonDrmInfos","drms1","drms2","commonDrms","drm1","drm2","mergedDrm","shaka.media.DrmEngine.prototype.pollExpiration_","old","new_","shaka.media.TextEngine","parser_","track_","timestampOffset_","appendWindowEnd_","bufferEnd_","bufferStart_","shaka.media.TextEngine.parserMap_","shaka.media.TextEngine.registerParser","shaka.media.TextEngine.TextParserWrapper_.bind","registerParser","unregisterParser","shaka.media.TextEngine.unregisterParser","shaka.media.TextEngine.makeCue","startTime","endTime","payload","VTTCue","makeCue","shaka.media.TextEngine.prototype.destroy","removeWhere_","shaka.media.TextEngine.prototype.appendBuffer","parseInit","cues","parseMedia","periodStart","segmentStart","segmentEnd","addCue","shaka.media.TextEngine.prototype.remove","start","end","cue","shaka.media.TextEngine.prototype.removeWhere_","predicate","removeMe","removeCue","shaka.media.TextEngine.TextParserWrapper_","parser","shaka.media.TextEngine.TextParserWrapper_.prototype.parseInit","shaka.media.TextEngine.TextParserWrapper_.prototype.parseMedia","shaka.media.TimeRangesUtils.bufferEnd","shaka.media.TimeRangesUtils.isBuffered","shaka.media.TimeRangesUtils.bufferedAheadOf","shaka.media.MediaSourceEngine","mediaSource","mediaSource_","textTrack_","sourceBuffers_","textEngine_","queues_","shaka.media.MediaSourceEngine.probeSupport","testMimeTypes","MediaSource","isTypeSupported","basicType","shaka$media$MediaSourceEngine.prototype","shaka.media.MediaSourceEngine.prototype","shaka.media.MediaSourceEngine.prototype.destroy","q","inProgress","shaka.media.MediaSourceEngine.prototype.init","typeConfig","reinitText","sourceBuffer","addSourceBuffer","onUpdateEnd_","shaka.media.MediaSourceEngine.prototype.reinitText","factory","shaka.media.MediaSourceEngine.prototype.bufferStart","shaka.media.MediaSourceEngine.prototype.getBuffered_","buffered","shaka.media.MediaSourceEngine.prototype.appendBuffer","appendBuffer","enqueueOperation_","append_","shaka.media.MediaSourceEngine.prototype.remove","remove_","shaka.media.MediaSourceEngine.prototype.clear","shaka.media.MediaSourceEngine.prototype.setStreamProperties","timestampOffset","appendWindowEnd","abort_","setTimestampOffset_","setAppendWindowEnd_","endOfStream","shaka.media.MediaSourceEngine.prototype.endOfStream","opt_reason","enqueueBlockingOperation_","setDuration","shaka.media.MediaSourceEngine.prototype.setDuration","getDuration","shaka.media.MediaSourceEngine.prototype.getDuration","shaka_media_MediaSourceEngine_prototype$append_","shaka.media.MediaSourceEngine.prototype.append_","shaka.media.MediaSourceEngine.prototype.remove_","shaka.media.MediaSourceEngine.prototype.abort_","abort","flush_","shaka.media.MediaSourceEngine.prototype.flush_","shaka.media.MediaSourceEngine.prototype.setTimestampOffset_","shaka.media.MediaSourceEngine.prototype.setAppendWindowEnd_","fudge","shaka_media_MediaSourceEngine_prototype$onError_","shaka.media.MediaSourceEngine.prototype.onError_","operation","shaka.util.Error.Category.MEDIA","shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_FAILED","shaka.media.MediaSourceEngine.prototype.onUpdateEnd_","popFromQueue_","shaka.media.MediaSourceEngine.prototype.enqueueOperation_","shaka.util.Error.Code.QUOTA_EXCEEDED_ERROR","shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW","shaka.media.MediaSourceEngine.prototype.enqueueBlockingOperation_","run","allWaiters","ready","shaka.media.MediaSourceEngine.prototype.popFromQueue_","next","shaka.util.LanguageUtils.match","fuzz","preference","candidate","shaka.util.LanguageUtils.MatchType.BASE_LANGUAGE_OKAY","shaka.util.LanguageUtils.MatchType.OTHER_SUB_LANGUAGE_OKAY","BASE_LANGUAGE_OKAY","OTHER_SUB_LANGUAGE_OKAY","shaka.util.LanguageUtils.normalize","fields","replacement","shaka.util.LanguageUtils.isoMap_","shaka.util.StreamUtils.meetsRestrictions","restrictions","maxHwRes","minWidth","maxWidth","height","minHeight","maxHeight","minPixels","maxPixels","minBandwidth","maxBandwidth","shaka.util.StreamUtils.applyRestrictions","tracksChanged","originalAllowed","allowedByApplication","shaka.util.StreamUtils.filterPeriod","drmEngine","activeStreams","activeVideo","activeAudio","isSupportedByKeySystem","shaka.util.StreamUtils.streamIsCompatible_","textStreams","shaka.util.StreamUtils.getFullMimeType","activeStream","drmSupportedMimeTypes","encrypted","shaka.util.StreamUtils.getVariantTracks","activeAudioId","activeVideoId","shaka.util.StreamUtils.getPlayableVariants","isActive","audioCodec","videoCodec","roles","audioRoles","videoRoles","frameRate","primary","shaka.util.StreamUtils.getTextTracks","activeStreamId","shaka.util.StreamUtils.findVariantForTrack","shaka.util.StreamUtils.findTextStreamForTrack","allowedByKeySystem","shaka.util.StreamUtils.filterVariantsByRoleAndLanguage","preferredLanguage","opt_languageMatches","opt_role","chosen","primaryVariants","pref","EXACT","matchType","betterLangMatchFound","role","chosenWithRoles","shaka.util.StreamUtils.filterTextStreamsByRoleAndLanguage","primaryStreams","shaka.util.StreamUtils.getVariantByStreams","shaka.util.StreamUtils.getVariantByStreamIds","matchesId","opt_codecs","shaka.util.StreamUtils.findPeriodContainingTime","shaka.util.StreamUtils.findPeriodContainingStream","periodIdx","textStream","trickModeVideo","shaka.abr.SimpleAbrManager","switch_","enabled_","bandwidthEstimator_","variants_","textStreams_","startupComplete_","lastTimeChosenMs_","restrictions_","SimpleAbrManager","stop","shaka.abr.SimpleAbrManager.prototype.stop","shaka.abr.SimpleAbrManager.prototype.init","switchCallback","chooseStreams","shaka.abr.SimpleAbrManager.prototype.chooseStreams","mediaTypesToUpdate","sortedVariants","shaka.abr.SimpleAbrManager.filterAndSortVariants_","chooseVariant_","currentBandwidth","shaka.util.Error.Category.MANIFEST","shaka.util.Error.Code.RESTRICTIONS_CANNOT_BE_MET","shaka.abr.SimpleAbrManager.BANDWIDTH_UPGRADE_TARGET_","shaka.abr.SimpleAbrManager.BANDWIDTH_DOWNGRADE_TARGET_","enable","shaka.abr.SimpleAbrManager.prototype.enable","disable","shaka.abr.SimpleAbrManager.prototype.disable","segmentDownloaded","shaka.abr.SimpleAbrManager.prototype.segmentDownloaded","deltaTimeMs","numBytes","minBytes_","sample","suggestStreams_","shaka.abr.SimpleAbrManager.SWITCH_INTERVAL_MS","shaka.abr.SimpleAbrManager.prototype.getBandwidthEstimate","shaka.abr.SimpleAbrManager.prototype.setDefaultEstimate","setRestrictions","shaka.abr.SimpleAbrManager.prototype.setRestrictions","setVariants","shaka.abr.SimpleAbrManager.prototype.setVariants","setTextStreams","shaka.abr.SimpleAbrManager.prototype.setTextStreams","sort","v1","v2","shaka.util.FakeEvent","opt_dict","dict","defaultPrevented","cancelable","bubbles","timeStamp","performance","isTrusted","currentTarget","stopped","shaka.util.FakeEvent.prototype.preventDefault","stopImmediatePropagation","shaka.util.FakeEvent.prototype.stopImmediatePropagation","stopPropagation","shaka.util.FakeEvent.prototype.stopPropagation","shaka.cast.CastUtils.VideoEvents","shaka.cast.CastUtils.VideoAttributes","shaka.cast.CastUtils.VideoInitStateAttributes","shaka.cast.CastUtils.VideoVoidMethods","shaka.cast.CastUtils.PlayerEvents","shaka.cast.CastUtils.PlayerGetterMethods","shaka.cast.CastUtils.PlayerInitState","shaka.cast.CastUtils.PlayerInitAfterLoadState","shaka.cast.CastUtils.PlayerVoidMethods","shaka.cast.CastUtils.PlayerPromiseMethods","shaka.cast.CastUtils.serialize","thing","simpleEvent","eventKey","eventValue","TimeRanges","ranges","shaka.cast.CastUtils.deserialize","NaN","shaka.cast.CastUtils.simulateTimeRanges_","shaka.cast.CastSender","receiverAppId","onStatusChanged","onRemoteEvent","onResumeLocal","onInitStateRequired","receiverAppId_","onStatusChanged_","onRemoteEvent_","onResumeLocal_","onInitStateRequired_","isCasting_","hasReceivers_","apiReady_","receiverName_","session_","appData_","cachedProperties_","nextAsyncCallId_","asyncCallPromises_","castPromise_","shaka$cast$CastSender.prototype","shaka.cast.CastSender.prototype","shaka.cast.CastSender.prototype.destroy","rejectAllPromises_","leave","isCasting","shaka.cast.CastSender.prototype.isCasting","receiverName","shaka.cast.CastSender.prototype.receiverName","shaka.cast.CastSender.prototype.init","chrome","isAvailable","__onGCastApiAvailable","sessionRequest","SessionRequest","apiConfig","ApiConfig","onExistingSessionJoined_","onReceiverStatusChanged_","initialize","setAppData","shaka.cast.CastSender.prototype.setAppData","appData","sendMessage_","shaka.cast.CastSender.prototype.cast","initState","shaka.util.Error.Category.CAST","shaka.util.Error.Code.CAST_API_UNAVAILABLE","shaka.util.Error.Code.NO_CAST_RECEIVERS","shaka.util.Error.Code.ALREADY_CASTING","requestSession","onSessionInitiated_","onConnectionError_","forceDisconnect","shaka.cast.CastSender.prototype.forceDisconnect","shaka.cast.CastSender.prototype.get","targetName","property","shaka.cast.CastUtils.VideoVoidMethods.indexOf","remoteCall_","shaka.cast.CastUtils.PlayerVoidMethods.indexOf","shaka.cast.CastUtils.PlayerPromiseMethods.indexOf","remoteAsyncCall_","shaka.cast.CastUtils.PlayerGetterMethods.indexOf","propertyGetter_","shaka.cast.CastSender.prototype.set","shaka.cast.CastSender.prototype.onSessionInitiated_","onSessionCreated_","addUpdateListener","onConnectionStatusChanged_","addMessageListener","shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE","onMessageReceived_","shaka.cast.CastSender.prototype.onConnectionError_","shaka.util.Error.Code.UNEXPECTED_CAST_ERROR","shaka.util.Error.Code.CAST_CANCELED_BY_USER","shaka.util.Error.Code.CAST_CONNECTION_TIMED_OUT","shaka.util.Error.Code.CAST_RECEIVER_APP_UNAVAILABLE","shaka.cast.CastSender.prototype.propertyGetter_","shaka.cast.CastSender.prototype.remoteCall_","shaka.cast.CastSender.prototype.remoteAsyncCall_","shaka.cast.CastSender.prototype.onExistingSessionJoined_","shaka.cast.CastSender.prototype.onReceiverStatusChanged_","availability","shaka.cast.CastSender.prototype.onConnectionStatusChanged_","connected","receiver","friendlyName","shaka.cast.CastSender.prototype.rejectAllPromises_","shaka.util.Error.Category.PLAYER","shaka.util.Error.Code.LOAD_INTERRUPTED","shaka.cast.CastSender.prototype.onMessageReceived_","namespace","serialized","fakeEvent","reconstructedError","shaka.cast.CastSender.prototype.sendMessage_","sendMessage","listeners_","dispatchTarget","shaka.util.FakeEventTarget.prototype.addEventListener","shaka.util.FakeEventTarget.prototype.removeEventListener","dispatchEvent","shaka.util.FakeEventTarget.prototype.dispatchEvent","handleEvent","shaka.cast.CastProxy","shaka.util.FakeEventTarget.call","localVideo_","localPlayer_","playerEventTarget_","videoEventTarget_","playerProxy_","videoProxy_","sender_","onCastStatusChanged_","getInitState_","init_","CastProxy","shaka.cast.CastProxy.prototype.destroy","opt_forceDisconnect","getVideo","shaka.cast.CastProxy.prototype.getVideo","getPlayer","shaka.cast.CastProxy.prototype.getPlayer","canCast","shaka.cast.CastProxy.prototype.canCast","shaka.cast.CastProxy.prototype.isCasting","shaka.cast.CastProxy.prototype.receiverName","shaka.cast.CastProxy.prototype.cast","unload","shaka.cast.CastProxy.prototype.setAppData","suggestDisconnect","shaka.cast.CastProxy.prototype.suggestDisconnect","shaka.cast.CastProxy.prototype.forceDisconnect","shaka.cast.CastProxy.prototype.init_","shaka.cast.CastUtils.VideoEvents.forEach","videoProxyLocalEvent_","shaka.cast.CastUtils.PlayerEvents.forEach","playerProxyLocalEvent_","defineProperty","configurable","enumerable","videoProxyGet_","videoProxySet_","playerProxyGet_","shaka$cast$CastProxy.prototype","shaka.cast.CastProxy.prototype","shaka.cast.CastProxy.prototype.getInitState_","manifestUri_","shaka.cast.CastUtils.VideoInitStateAttributes.forEach","ended","shaka.cast.CastUtils.PlayerInitState.forEach","pair","setter","getter","shaka.cast.CastUtils.PlayerInitAfterLoadState.forEach","shaka_cast_CastProxy_prototype$onCastStatusChanged_","shaka.cast.CastProxy.prototype.onCastStatusChanged_","shaka_cast_CastProxy_prototype$onResumeLocal_","shaka.cast.CastProxy.prototype.onResumeLocal_","manifestUri","manifestReady","autoplay","videoState","shaka.cast.CastProxy.prototype.videoProxyGet_","shaka.cast.CastProxy.prototype.videoProxySet_","shaka.cast.CastProxy.prototype.videoProxyLocalEvent_","shaka.cast.CastProxy.prototype.playerProxyGet_","getNetworkingEngine","shaka.cast.CastProxy.prototype.playerProxyLocalEvent_","shaka_cast_CastProxy_prototype$onRemoteEvent_","shaka.cast.CastProxy.prototype.onRemoteEvent_","shaka.cast.CastReceiver","opt_appDataCallback","opt_contentIdCallback","player_","targets_","appDataCallback_","opt_contentIdCallback_","contentId","isConnected_","isIdle_","pollTimerId_","genericBus_","shakaBus_","CastReceiver","isConnected","shaka.cast.CastReceiver.prototype.isConnected","isIdle","shaka.cast.CastReceiver.prototype.isIdle","shaka.cast.CastReceiver.prototype.destroy","CastReceiverManager","getInstance","manager","shaka.cast.CastReceiver.prototype.init_","onSenderConnected","onSendersChanged_","onSenderDisconnected","onSystemVolumeChanged","fakeVolumeChangeEvent_","getCastMessageBus","shaka.cast.CastUtils.GENERIC_MESSAGE_NAMESPACE","onMessage","onGenericMessage_","onShakaMessage_","proxyEvent_","canDisplayType","setMaxHardwareResolution","shaka$cast$CastReceiver.prototype","shaka.cast.CastReceiver.prototype","shaka.cast.CastReceiver.prototype.onSendersChanged_","getSenders","shaka.cast.CastReceiver.prototype.onCastStatusChanged_","sendMediaStatus_","shaka.cast.CastReceiver.prototype.initState_","v","shaka.cast.CastReceiver.prototype.proxyEvent_","pollAttributes_","shaka.cast.CastReceiver.prototype.pollAttributes_","shaka.cast.CastUtils.VideoAttributes.forEach","shaka.cast.CastUtils.PlayerGetterMethods.forEach","systemVolume","getSystemVolume","shaka.cast.CastReceiver.prototype.fakeVolumeChangeEvent_","shaka.cast.CastReceiver.prototype.onShakaMessage_","initState_","setSystemVolumeLevel","setSystemVolumeMuted","senderId","sendAsyncComplete_","shaka.cast.CastReceiver.prototype.onGenericMessage_","resumeState","volumeObject","oldVolumeLevel","oldVolumeMuted","mediaInfo","media","isLive","shaka.cast.CastReceiver.prototype.sendAsyncComplete_","shaka.cast.CastReceiver.prototype.sendMessage_","bus","opt_senderId","getCastChannel","send","broadcast","shaka.cast.CastReceiver.prototype.sendMediaStatus_","requestId","opt_media","playState","shaka.cast.CastReceiver.PLAY_STATE","mediaStatus","playbackRate","getPlayState_","IDLE","buffering_","BUFFERING","PAUSED","PLAYING","shaka.util.XmlUtils.findChild","shaka.util.XmlUtils.findChildren","childNodes","child","tagName","shaka.util.XmlUtils.getContents","contents","firstChild","nodeType","Node","TEXT_NODE","trim","shaka.util.XmlUtils.parseAttr","parseFunction","opt_defaultValue","parsedValue","getAttribute","shaka.util.XmlUtils.parseDate","dateString","shaka.util.XmlUtils.parseDuration","durationString","matches","exec","d","years","months","days","isFinite","shaka.util.XmlUtils.parseRange","rangeString","shaka.util.XmlUtils.parseInt","intString","shaka.util.XmlUtils.parsePositiveInt","shaka.util.XmlUtils.parseNonNegativeInt","shaka.util.XmlUtils.evalDivision","exprString","res","shaka.dash.ContentProtection.defaultKeySystems_","shaka.dash.ContentProtection.parseFromAdaptationSet","elems","ignoreDrmInfo","parsed","shaka.dash.ContentProtection.parseElements_","defaultInit","defaultKeyId","parsedNonCenc","shaka.util.Error.Code.DASH_CONFLICTING_KEY_IDS","shaka.dash.ContentProtection.MP4Protection_","schemeUri","shaka.dash.ContentProtection.convertElements_","firstRepresentation","shaka.dash.ContentProtection.parseFromRepresentation","context","repContext","asUnknown","repUnencrypted","asInfo","repInfo","shaka.util.Error.Code.DASH_NO_COMMON_KEY_SYSTEM","elements","node","psshs","shaka.util.Error.Code.DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED","pssh","shaka.util.Error.Code.DASH_PSSH_BAD_ENCODING","shaka.dash.MpdUtils.fillUriTemplate","uriTemplate","representationId","number","valueTable","re","widthString","valueString","paddingSize","shaka.dash.MpdUtils.parseSegmentInfo","timescaleStr","shaka.dash.MpdUtils.inheritAttribute","timescale","durationStr","segmentDuration","startNumberStr","presentationTimeOffset","startNumber","timelineNode","shaka.dash.MpdUtils.inheritChild","timeline","periodInfo","timePoints","lastEndTime","timePoint","r","repeat","nextStartTime","nextTimePoint","ceil","periodDuration","unscaledStart","unscaledPresentationTimeOffset","attribute","representation","adaptationSet","nodes","shaka.media.InitSegmentReference","startByte","endByte","getUris","InitSegmentReference","shaka.media.SegmentReference","SegmentReference","shaka.util.DataViewReader","endianness","dataView_","littleEndian_","shaka.util.DataViewReader.Endianness.LITTLE_ENDIAN","position_","DataViewReader","LITTLE_ENDIAN","shaka.util.DataViewReader.Endianness","BIG_ENDIAN","hasMoreData","shaka.util.DataViewReader.prototype.hasMoreData","getPosition","shaka.util.DataViewReader.prototype.getPosition","getLength","shaka.util.DataViewReader.prototype.getLength","readUint8","shaka.util.DataViewReader.prototype.readUint8","getUint8","throwOutOfBounds_","readUint16","shaka.util.DataViewReader.prototype.readUint16","readUint32","shaka.util.DataViewReader.prototype.readUint32","readInt32","shaka.util.DataViewReader.prototype.readInt32","getInt32","readUint64","shaka.util.DataViewReader.prototype.readUint64","low","high","shaka.util.Error.Code.JS_INTEGER_OVERFLOW","readBytes","shaka.util.DataViewReader.prototype.readBytes","skip","shaka.util.DataViewReader.prototype.skip","readTerminatedString","shaka.util.DataViewReader.prototype.readTerminatedString","shaka.util.DataViewReader.prototype.throwOutOfBounds_","shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS","shaka.util.Mp4Parser","headers_","boxDefinitions_","Mp4Parser","shaka.util.Mp4Parser.prototype.box","definition","typeCode","shaka.util.Mp4Parser.typeFromString_","BASIC_BOX","fullBox","shaka.util.Mp4Parser.prototype.fullBox","FULL_BOX","shaka.util.Mp4Parser.prototype.parse","reader","parseNext","shaka.util.Mp4Parser.prototype.parseNext","absStart","size","boxDefinition","flags","versionAndFlags","payloadSize","payloadReader","shaka.util.Mp4Parser.children","shaka.util.Mp4Parser.sampleDescription","count","shaka.util.Mp4Parser.allData","shaka.media.Mp4SegmentIndexParser","sidxData","sidxOffset","references","shaka.media.Mp4SegmentIndexParser.parseSIDX_","shaka.util.Error.Code.MP4_SIDX_WRONG_BOX_TYPE","shaka.util.Error.Code.MP4_SIDX_INVALID_TIMESCALE","earliestPresentationTime","firstOffset","referenceCount","unscaledStartTime","chunk","referenceType","referenceSize","subsegmentDuration","shaka.util.Error.Code.MP4_SIDX_TYPE_NOT_SUPPORTED","shaka.media.SegmentIndex","references_","SegmentIndex","shaka.media.SegmentIndex.prototype.destroy","shaka.media.SegmentIndex.prototype.find","shaka.media.SegmentIndex.prototype.get","merge","shaka.media.SegmentIndex.prototype.merge","nextPosition","newReferences","r1","r2","abs","evict","shaka.media.SegmentIndex.prototype.evict","shaka.media.SegmentIndex.prototype.fit","lastReference","shaka.util.EbmlParser","reader_","shaka.util.EbmlParser.DYNAMIC_SIZES","shaka.util.EbmlParser.prototype.hasMoreData","shaka.util.EbmlParser.prototype.parseElement","vint","parseVint_","parseId_","shaka.util.Error.Code.EBML_OVERFLOW","shaka.util.EbmlParser.DYNAMIC_SIZES.length","elementSize","byteOffset","shaka.util.EbmlElement","shaka.util.EbmlParser.prototype.parseVint_","firstByte","shaka.util.EbmlElement.prototype.getUint","shaka.media.WebmSegmentIndexParser","shaka.media.WebmSegmentIndexParser.prototype.parse","cuesData","shaka.media.WebmSegmentIndexParser.EBML_ID","parseElement","ebmlElement","shaka.util.Error.Code.WEBM_EBML_HEADER_ELEMENT_MISSING","segmentElement","shaka.media.WebmSegmentIndexParser.SEGMENT_ID","shaka.util.Error.Code.WEBM_SEGMENT_ELEMENT_MISSING","segmentOffset","infoElement","shaka.media.WebmSegmentIndexParser.INFO_ID","shaka.util.Error.Code.WEBM_INFO_ELEMENT_MISSING","timecodeScaleNanoseconds","durationScale","shaka.media.WebmSegmentIndexParser.TIMECODE_SCALE_ID","getUint","shaka.media.WebmSegmentIndexParser.DURATION_ID","getFloat32","getFloat64","shaka.util.Error.Code.EBML_BAD_FLOATING_POINT_SIZE","shaka.util.Error.Code.WEBM_DURATION_ELEMENT_MISSING","timecodeScale","cuesElement","shaka.media.WebmSegmentIndexParser.CUES_ID","shaka.util.Error.Code.WEBM_CUES_ELEMENT_MISSING","parseCues_","shaka.media.WebmSegmentIndexParser.prototype.parseCues_","lastTime","lastOffset","shaka.media.WebmSegmentIndexParser.CUE_POINT_ID","tuple","parseCuePoint_","unscaledTime","currentOffset","relativeOffset","shaka.media.WebmSegmentIndexParser.prototype.parseCuePoint_","cuePointElement","cueTimeElement","shaka.media.WebmSegmentIndexParser.CUE_TIME_ID","shaka.util.Error.Code.WEBM_CUE_TIME_ELEMENT_MISSING","cueTrackPositionsElement","shaka.media.WebmSegmentIndexParser.CUE_TRACK_POSITIONS_ID","shaka.util.Error.Code.WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING","cueTrackParser","shaka.media.WebmSegmentIndexParser.CUE_CLUSTER_POSITION","shaka.dash.SegmentBase.createInitSegment","initialization","resolvedUris","range","shaka.dash.SegmentBase.createStream","requestInitSegment","shaka.dash.SegmentBase.fromInheritance_","containerType","shaka.util.Error.Code.DASH_UNSUPPORTED_CONTAINER","shaka.util.Error.Code.DASH_WEBM_MISSING_INIT","representationIndex","indexRangeElem","indexUris","indexRange","representationUri","shaka.util.Error.Code.DASH_NO_SEGMENT_INFO","shaka.dash.SegmentBase.createSegmentIndexFromUris","createSegmentIndex","findSegmentPosition","getSegmentReference","initSegmentReference","presentationTimeline","fitLast","dynamic","isLastPeriod","localRequest","segmentIndex","create","results","indexData","notifySegments","periodStartTime","fit","frame","segmentBase","shaka.dash.SegmentList.createStream","segmentIndexMap","shaka.dash.SegmentList.fromInheritance_","mediaSegments","shaka.dash.SegmentList.parseMediaSegments_","segmentInfo","shaka.dash.SegmentList.createSegmentReferences_","getSegmentAvailabilityStart","segmentList","prevEndTime","mediaUri","segmentLists","urlNode","indexRangeWarningGiven","shaka.dash.SegmentTemplate.createStream","isUpdate","shaka.dash.SegmentTemplate.createInitSegment_","shaka.dash.SegmentTemplate.fromInheritance_","mediaTemplate","indexTemplate","filledTemplate","notifyMaxSegmentDuration","segmentIndexFunctions","shaka.dash.SegmentTemplate.createFromDuration_","shaka.dash.SegmentTemplate.createFromTimeline_","segmentTemplate","periodTime","segmentReplacement","repId","segmentId","g","createUris","shaka.media.ManifestParser.parsersByMime","shaka.media.ManifestParser.parsersByExtension","registerParserByExtension","shaka.media.ManifestParser.registerParserByExtension","extension","parserFactory","registerParserByMime","shaka.media.ManifestParser.registerParserByMime","shaka.media.ManifestParser.probeSupport","testExtensions","shaka.media.ManifestParser.getFactory","netEngine","opt_manifestParserFactory","filenamePieces","uriObj","uriPieces","uriFilename","headRequest","shaka.net.NetworkingEngine.RequestType.MANIFEST","shaka.util.Error.Code.UNABLE_TO_GUESS_MANIFEST_TYPE","shaka.media.PresentationTimeline","presentationStartTime","presentationDelay","presentationStartTime_","presentationDelay_","segmentAvailabilityDuration_","duration_","maxSegmentDuration_","clockOffset_","static_","PresentationTimeline","shaka.media.PresentationTimeline.prototype.getDuration","shaka.media.PresentationTimeline.prototype.setDuration","getPresentationStartTime","shaka.media.PresentationTimeline.prototype.getPresentationStartTime","setClockOffset","shaka.media.PresentationTimeline.prototype.setClockOffset","setStatic","shaka.media.PresentationTimeline.prototype.setStatic","isStatic","getSegmentAvailabilityDuration","shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityDuration","setSegmentAvailabilityDuration","shaka.media.PresentationTimeline.prototype.setSegmentAvailabilityDuration","segmentAvailabilityDuration","shaka.media.PresentationTimeline.prototype.notifySegments","shaka.media.PresentationTimeline.prototype.notifyMaxSegmentDuration","maxSegmentDuration","shaka.media.PresentationTimeline.prototype.isLive","isInProgress","shaka.media.PresentationTimeline.prototype.isInProgress","shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityStart","getSafeAvailabilityStart","shaka.media.PresentationTimeline.prototype.getSafeAvailabilityStart","getSegmentAvailabilityEnd","shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityEnd","getLiveEdge_","getSeekRangeEnd","shaka.media.PresentationTimeline.prototype.getSeekRangeEnd","shaka.dash.DashParser","playerInterface_","manifestUris_","manifest_","periodIds_","globalId_","segmentIndexMap_","updatePeriod_","updateTimer_","DashParser","shaka$dash$DashParser.prototype","shaka.dash.DashParser.prototype","shaka.dash.DashParser.prototype.configure","shaka.dash.DashParser.prototype.start","playerInterface","requestManifest_","setUpdateTimer_","shaka.dash.DashParser.prototype.stop","shaka.dash.DashParser.prototype.update","shaka.dash.DashParser.prototype.onExpirationUpdated","shaka.dash.DashParser.prototype.requestManifest_","parseManifest_","shaka.dash.DashParser.prototype.parseManifest_","finalManifestUri","string","mpd","documentElement","shaka.util.Error.Code.DASH_INVALID_XML","manifestBaseUris","locations","minBufferTime","suggestedPresentationDelay","mpdType","defaultPresentationDelay","shaka.dash.DashParser.DEFAULT_SUGGESTED_PRESENTATION_DELAY_","periodsAndDuration","parsePeriods_","timingElements","parseUtcTiming_","shaka.dash.DashParser.prototype.parsePeriods_","presentationDuration","prevEnd","periodNodes","givenDuration","nextStart","nextPeriod","parsePeriod_","periodId","filterPeriod","shaka.dash.DashParser.prototype.parsePeriod_","createFrame_","eventStreamNodes","parseEventStream_","adaptationSets","adaptationSetNodes","parseAdaptationSet_","representationIds","as","uniqueRepIds","shaka.util.Error.Code.DASH_DUPLICATE_REPRESENTATION_ID","normalAdaptationSets","trickModeFor","trickModeAdaptationSets","trickModeSet","targetId","normalSet","videoSets","getSetsOfType_","audioSets","shaka.util.Error.Code.DASH_EMPTY_PERIOD","createVariants_","audioSet","videoSet","textSets","shaka.dash.DashParser.prototype.getSetsOfType_","shaka.dash.DashParser.prototype.createVariants_","main","shaka.dash.DashParser.prototype.parseAdaptationSet_","roleElements","roleValues","SUBTITLE","unrecognizedEssentialProperty","essentialProperties","prop","schemeId","contentProtectionElems","contentProtection","dash","customScheme","representations","parseRepresentation_","shaka.util.Error.Code.DASH_EMPTY_ADAPTATION_SET","APPLICATION","shaka.dash.DashParser.guessContentType_","repIds","shaka.dash.DashParser.prototype.parseRepresentation_","isPrimary","verifyRepresentation_","requestInitSegment_","streamInfo","ref","containsEmsgBoxes","shaka_dash_DashParser_prototype$onUpdate_","shaka.dash.DashParser.prototype.onUpdate_","shaka.dash.DashParser.prototype.setUpdateTimer_","onUpdate_","interval","shaka.dash.DashParser.MIN_UPDATE_PERIOD_","shaka.dash.DashParser.prototype.createFrame_","parent","shaka.dash.DashParser.prototype.verifyRepresentation_","shaka.dash.DashParser.prototype.requestForTiming_","requestUris","text","date","shaka.dash.DashParser.prototype.parseUtcTiming_","schemesAndValues","clockSyncUri","sv","requestForTiming_","shaka.dash.DashParser.prototype.parseEventStream_","schemeIdUri","eventNode","presentationTime","region","eventElement","onTimelineRegionAdded","shaka.dash.DashParser.prototype.requestInitSegment_","shaka.hls.Playlist","tags","opt_segments","shaka.hls.Tag","attributes","opt_value","shaka.hls.Tag.prototype.toString","attr_to_str","shaka.hls.Attribute","shaka.hls.Tag.prototype.getAttribute","shaka.hls.Tag.prototype.getAttributeValue","defaultValue","shaka.hls.Segment","shaka.hls.Utils.filterTagsByName","tag","shaka.hls.Utils.getFirstTagWithName","tagsWithName","shaka.hls.Utils.findMediaTags","groupId","typeAttr","groupIdAttr","shaka.util.TextParser","data_","shaka.util.TextParser.prototype.readRegex","regex","lastIndex","indexOf_","atEnd","shaka.util.TextParser.prototype.readRegexReturnCapture_","readRegex","shaka.hls.ManifestTextParser","shaka.hls.ManifestTextParser.prototype.parsePlaylist","lines","test","shaka.util.Error.Code.HLS_PLAYLIST_HEADER_MISSING","playlistType","MASTER","line","shaka.hls.ManifestTextParser.parseTag","parseTag_","word","shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS.indexOf","MEDIA","shaka.hls.ManifestTextParser.SEGMENT_TAGS.indexOf","shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY","segmentsData","parseSegments_","tagUri","shaka.hls.ManifestTextParser.prototype.parseSegments_","blocks","shaka.util.Error.Code.INVALID_HLS_TAG","blockAttrs","attrName","shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS","shaka.hls.ManifestTextParser.SEGMENT_TAGS","shaka.net.DataUriPlugin","shaka.net.DataUriPlugin.parse","DataUriPlugin","shaka.util.Error.Code.MALFORMED_DATA_URI","infoAndData","dataStr","typeAndEncoding","encoding","shaka.util.Error.Code.UNKNOWN_DATA_URI_ENCODING","shaka.hls.HlsParser","mediaTagsToStreamInfosMap_","streamsToIndexMap_","presentationTimeline_","manifestTextParser_","HlsParser","shaka$hls$HlsParser.prototype","shaka.hls.HlsParser.prototype","shaka.hls.HlsParser.prototype.configure","shaka.hls.HlsParser.prototype.start","shaka.hls.HlsParser.prototype.stop","shaka.hls.HlsParser.prototype.update","shaka.hls.HlsParser.prototype.onExpirationUpdated","shaka.hls.HlsParser.prototype.parseManifest_","playlist","parsePlaylist","shaka.util.Error.Code.HLS_MASTER_PLAYLIST_NOT_PROVIDED","createPeriod_","shaka.hls.HlsParser.prototype.createPeriod_","variantsPromises","variantTags","createVariantsForTag_","textStreamPromises","mediaTags","textStreamTags","shaka.hls.HlsParser.getRequiredAttributeValue_","createTextStream_","allVariants","fitSegments_","shaka.hls.HlsParser.prototype.createVariantsForTag_","getAttributeValue","defaultCodecs","resolutionAttr","resBlocks","timeOffset","getTimeOffset_","audioGroupId","videoGroupId","promises","createStreamInfoFromMediaTag_","audioStreamInfos","videoStreamInfos","createStreamInfo_","createStreamInfoFromVariantTag_","allCodecs","shaka.hls.HlsParser.prototype.createVariants_","audioInfos","videoInfos","audioStream","videoStream","audioDrmInfos","videoDrmInfos","createVariant_","shaka.hls.HlsParser.prototype.createVariant_","shaka.hls.HlsParser.prototype.createTextStream_","shaka.hls.HlsParser.prototype.createStreamInfoFromMediaTag_","defaultAttr","autoselectAttr","shaka.hls.HlsParser.prototype.createStreamInfo_","mediaPlaylistTimeOffset","createInitSegmentReference_","mediaSequenceTag","createSegments_","startPosition","guessCodecs_","drmTags","segmentKeyTags","drmTag","keyFormat","drmParser","shaka.hls.HlsParser.KEYFORMATS_TO_DRM_PARSERS_","shaka.util.Error.Code.HLS_KEYFORMATS_NOT_SUPPORTED","guessMimeType_","shaka.hls.HlsParser.prototype.createInitSegmentReference_","mapTags","shaka.util.Error.Code.HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND","mapTag","initUri","byterange","shaka.hls.HlsParser.prototype.createSegments_","hlsSegments","extinfValues","getRequiredTag_","extinfTag","shaka.hls.HlsParser.prototype.fitSegments_","shaka.hls.HlsParser.prototype.guessCodecs_","formats","shaka.hls.HlsParser.VIDEO_CODEC_FORMATS_","shaka.hls.HlsParser.AUDIO_CODEC_FORMATS_","shaka.util.Error.Code.HLS_COULD_NOT_GUESS_CODECS","shaka.hls.HlsParser.prototype.guessMimeType_","shaka.hls.HlsParser.AUDIO_EXTENSIONS_TO_MIME_TYPES_","shaka.hls.HlsParser.VIDEO_EXTENSIONS_TO_MIME_TYPES_","shaka.util.Error.Code.HLS_COULD_NOT_GUESS_MIME_TYPE","shaka.hls.HlsParser.prototype.getTimeOffset_","startTag","hls","defaultTimeOffset","attributeName","shaka.util.Error.Code.HLS_REQUIRED_ATTRIBUTE_MISSING","shaka.hls.HlsParser.prototype.getRequiredTag_","shaka.util.Error.Code.HLS_REQUIRED_TAG_MISSING","shaka.hls.HlsParser.widevineDrmParser_","parsedData","shaka.media.TtmlTextParser","shaka.media.TtmlTextParser.prototype.parseInit","shaka.media.TtmlTextParser.prototype.parseMedia","shaka.util.Error.Code.INVALID_XML","tt","tts","subFrameRate","frameRateMultiplier","tickRate","spaceStyle","whitespaceTrim","rateInfo","shaka.media.TtmlTextParser.RateInfo_","styles","shaka.media.TtmlTextParser.getLeafNodes_","regions","textNodes","cueElement","hasAttribute","shaka.media.TtmlTextParser.addNewLines_","shaka.media.TtmlTextParser.parseTime_","shaka.util.Error.Code.INVALID_TEXT_CUE","shaka.media.TtmlTextParser.getElementFromCollection_","extent","shaka.media.TtmlTextParser.getStyleAttribute_","shaka.media.TtmlTextParser.percentValues_.exec","writingMode","isVerticalText","vertical","origin","snapToLines","align","positionAlign","shaka.media.TtmlTextParser.textAlignToPositionAlign_","lineAlign","shaka.media.TtmlTextParser.textAlignToLineAlign_","shaka.media.TtmlTextParser.timeColonFormatFrames_","shaka.media.TtmlTextParser.timeColonFormat_","shaka.media.TtmlTextParser.timeColonFormatMilliseconds_","shaka.media.TtmlTextParser.timeFramesFormat_","shaka.media.TtmlTextParser.timeTickFormat_","shaka.media.TtmlTextParser.timeHMSFormat_","shaka.media.TtmlTextParser.percentValues_","isSpanChildOfP","nodeName","ELEMENT_NODE","leafChildren","trimmed","regionChildren","getElementFromCollection_","style","collection","parentNode","Element","itemName","shaka.media.TtmlTextParser.timeColonFormatFrames_.test","shaka.media.TtmlTextParser.timeColonFormatFrames_.exec","frames","shaka.media.TtmlTextParser.timeColonFormat_.test","shaka.media.TtmlTextParser.parseTimeFromRegex_","shaka.media.TtmlTextParser.timeColonFormatMilliseconds_.test","shaka.media.TtmlTextParser.timeFramesFormat_.test","shaka.media.TtmlTextParser.timeFramesFormat_.exec","shaka.media.TtmlTextParser.timeTickFormat_.test","shaka.media.TtmlTextParser.timeTickFormat_.exec","ticks","shaka.media.TtmlTextParser.timeHMSFormat_.test","multiplierResults","numerator","denominator","shaka.media.Mp4TtmlParser","shaka.media.Mp4TtmlParser.prototype.parseInit","sawSTPP","shaka.util.Error.Code.INVALID_MP4_TTML","shaka.media.Mp4TtmlParser.prototype.parseMedia","sawMDAT","shaka.media.VttTextParser","shaka.media.VttTextParser.prototype.parseInit","shaka.media.VttTextParser.prototype.parseMedia","shaka.util.Error.Code.INVALID_TEXT_HEADER","cueTimeMatch","mpegTimeMatch","cueTime","shaka.media.VttTextParser.parseTime_","mpegTime","shaka.media.VttTextParser.MPEG_TIMESCALE_","expect","readRegexReturnCapture_","shaka.media.VttTextParser.parseSetting","miliseconds","shaka.media.Mp4VttParser","timescale_","shaka.media.Mp4VttParser.prototype.parseInit","sawWVTT","shaka.util.Error.Code.INVALID_MP4_VTT","shaka.media.Mp4VttParser.prototype.parseMedia","baseTime","presentations","payloads","sawTFDT","sawTRUN","sampleCount","samples","sampleIndex","presentation","shaka.media.Mp4VttParser.parseVTTC_","shaka.media.Mp4VttParser.assembleCue_","shaka.media.Playhead","onSeek","onEvent","startTime_","onSeek_","onEvent_","playbackRate_","gapJumpIntervalId_","trickPlayIntervalId_","prevReadyState_","readyState","didFireLargeGap_","stallPlayheadTime_","stallWallTime_","hadSegmentAppended_","onLoadedMetadata_","pollGap","onPollGapJump_","onRateChange_","shaka$media$Playhead.prototype","shaka.media.Playhead.prototype","shaka.media.Playhead.prototype.destroy","shaka.media.Playhead.prototype.setStartTime","clampTime_","shaka.media.Playhead.prototype.getTime","getStartTime_","shaka.media.Playhead.prototype.getStartTime_","getPlaybackRate","shaka.media.Playhead.prototype.getPlaybackRate","shaka.media.Playhead.prototype.setPlaybackRate","rate","onSegmentAppended","shaka.media.Playhead.prototype.onSegmentAppended","shaka.media.Playhead.prototype.onRateChange_","expectedRate","setPlaybackRate","shaka.media.Playhead.prototype.onLoadedMetadata_","targetTime","onSeeking_","onPlaying_","onSeekingToStartTime_","shaka.media.Playhead.prototype.onSeekingToStartTime_","shaka.media.Playhead.prototype.onPollGapJump_","smallGapLimit","threshold","gapIndex","jumpTo","seekEnd","jumpSize","isGapSmall","jumpLargeGap","jumpLargeGaps","movePlayhead_","shaka.media.Playhead.prototype.onSeeking_","reposition_","shaka.media.Playhead.prototype.onPlaying_","shaka.media.Playhead.prototype.reposition_","isBuffered","shaka.media.TimeRangesUtils.isBuffered.bind","rebufferingGoal","scaleFactor","safe","seekStart","seekSafe","shaka.media.Playhead.prototype.movePlayhead_","tries","recheck","shaka.media.Playhead.prototype.clampTime_","shaka.media.PlayheadObserver","onBuffering","onChangePeriod","onBuffering_","onChangePeriod_","timelineRegions_","curPeriodIndex_","watchdogTimer_","startWatchdogTimer_","shaka.media.PlayheadObserver.prototype.destroy","cancelWatchdogTimer_","addTimelineRegion","shaka.media.PlayheadObserver.prototype.addTimelineRegion","regionInfo","hasExistingRegion","existing","FUTURE_REGION","detail","shaka.media.PlayheadObserver.cloneTimelineInfo_","updateTimelineRegion_","copy","shaka.media.PlayheadObserver.prototype.updateTimelineRegion_","isSeek","newStatus","PAST_REGION","INSIDE","wasInside","isInside","shaka.media.PlayheadObserver.prototype.startWatchdogTimer_","onWatchdogTimer_","shaka.media.PlayheadObserver.prototype.cancelWatchdogTimer_","shaka.media.PlayheadObserver.prototype.onWatchdogTimer_","newPeriod","bufferedAhead","bufferEnd","shaka.media.PlayheadObserver.FUDGE_FACTOR_","buffering","setBuffering_","shaka.media.PlayheadObserver.UNDERFLOW_THRESHOLD_","shaka.media.StreamingEngine","bufferingGoalScale_","setupPeriodPromise_","canSwitchPeriod_","canSwitchStream_","mediaStates_","fatalError_","shaka$media$StreamingEngine.prototype","shaka.media.StreamingEngine.prototype","shaka.media.StreamingEngine.prototype.destroy","cancelUpdate_","shaka.media.StreamingEngine.prototype.configure","shaka.media.StreamingEngine.prototype.init","streamsByType","onChooseStreams","needPeriodIndex","findPeriodContainingTime_","playheadTime","playhead","shaka.util.Error.Category.STREAMING","shaka.util.Error.Code.INVALID_STREAMS_CHOSEN","initStreams_","onInitialStreamsSetup","shaka.media.StreamingEngine.prototype.getCurrentPeriod","shaka.media.StreamingEngine.prototype.getActiveStreams","restoreStreamAfterTrickPlay","shaka.media.StreamingEngine.prototype.notifyNewTextStream","shaka.media.StreamingEngine.prototype.setTrickPlay","normalVideo","mediaState","switch","shaka.media.StreamingEngine.prototype.switch","clearBuffer","ignoreTextStreamFailures","notifyNewTextStream","periodIndex","findPeriodContainingStream_","clearAllBuffers_","mediaSourceEngine","canSwitchRecord","resolved","needInitSegment","clearingBuffer","waitingToFlushBuffer","performingUpdate","waitingToClearBuffer","clearBuffer_","shaka.media.StreamingEngine.prototype.seeked","isAllBuffered","getBuffered_","shaka.media.StreamingEngine.prototype.clearAllBuffers_","bufferStart","updateTimer","scheduleUpdate_","shaka.media.StreamingEngine.prototype.initStreams_","opt_resumeAt","setDuration_","setupStreams_","lastStream","lastSegmentReference","recovering","hasError","resumeAt","shaka.media.StreamingEngine.prototype.setupPeriod_","shaka.media.StreamingEngine.prototype.setupStreams_","shaka.media.StreamingEngine.prototype.setDuration_","shaka_media_StreamingEngine_prototype$onUpdate_","shaka.media.StreamingEngine.prototype.onUpdate_","update_","mediaStates","handlePeriodTransition_","ms","shaka.media.StreamingEngine.prototype.update_","timeNeeded","getTimeNeeded_","lastPeriod","lastPeriodIndex","currentPeriodIndex","bufferingGoal","getBufferingGoal_","getSegmentReferenceIfAvailable_","getSegmentReferenceNeeded_","lookupTime","currentPeriod","reference","optimalPosition","fetchAndAppend_","shaka.media.StreamingEngine.prototype.getSegmentReferenceIfAvailable_","availabilityEnd","availabilityStart","shaka.media.StreamingEngine.prototype.fetchAndAppend_","followingPeriod","initSourceBuffer","initSourceBuffer_","fetchSegment","fetch_","handleStartup_","infiniteRetriesForLiveStreams","shaka.util.Error.Code.BAD_HTTP_STATUS","shaka.util.Error.Code.HTTP_ERROR","shaka.util.Error.Code.TIMEOUT","handleNetworkError_","handleQuotaExceeded_","shaka.media.StreamingEngine.prototype.handleQuotaExceeded_","waitingForAnotherStreamToRecover","percentBefore","shaka.media.StreamingEngine.prototype.initSourceBuffer_","setStreamProperties","appendInit","fetchInit","initSegment","shaka.media.StreamingEngine.prototype.append_","parseEMSG_","evict_","shaka.media.StreamingEngine.prototype.parseEMSG_","presentationTimeDelta","eventDuration","messageData","onManifestUpdate","emsg","shaka.media.StreamingEngine.prototype.evict_","overflow","bufferBehind","shaka.media.StreamingEngine.prototype.handleStartup_","setupPeriod_","onCanSwitch","onStartupComplete","shaka.media.StreamingEngine.prototype.handlePeriodTransition_","needSamePeriod","allAreIdle","shaka.media.StreamingEngine.isIdle_","allReady","needPeriod","shaka.media.StreamingEngine.prototype.fetch_","shaka.media.StreamingEngine.prototype.clearBuffer_","flush","clear","shaka.media.StreamingEngine.prototype.scheduleUpdate_","shaka.media.StreamingEngine.prototype.cancelUpdate_","shaka.net.HttpPlugin","xhr","XMLHttpRequest","responseType","withCredentials","onload","xhr.onload","getAllResponseHeaders","header","responseURL","responseText","onerror","xhr.onerror","ontimeout","xhr.ontimeout","setRequestHeader","HttpPlugin","shaka.offline.DBEngine","db_","operations_","currentIdMap_","shaka$offline$DBEngine.prototype","shaka.offline.DBEngine.prototype","shaka.offline.DBEngine.prototype.init","storeMap","opt_retryCount","createConnection_","stores","getNextId_","shaka.offline.DBEngine.prototype.destroy","op","transaction","shaka.offline.DBEngine.prototype.get","storeName","createTransaction_","shaka.offline.DBEngine.prototype.forEach","openCursor","onsuccess","request.onsuccess","cursor","continue","shaka.offline.DBEngine.prototype.insert","put","shaka.offline.DBEngine.prototype.remove","delete","shaka.offline.DBEngine.prototype.removeKeys","opt_onKeyRemoved","shaka.offline.DBEngine.prototype.getNextId_","shaka.offline.DBEngine.prototype.createTransaction_","oncomplete","closeOperation_","onabort","shaka.offline.DBEngine.onError_","objectStore","shaka.offline.DBEngine.prototype.createConnection_","indexedDB","shaka.offline.DBEngine.DB_NAME_","shaka.offline.DBEngine.DB_VERSION_","upgraded","createPromise","onupgradeneeded","request.onupgradeneeded","db","createObjectStore","keyPath","shaka.offline.DBEngine.onError_.bind","errorSource","shaka.util.Error.Category.STORAGE","shaka.util.Error.Code.INDEXED_DB_ERROR","shaka.util.Error.Code.OPERATION_ABORTED","shaka.offline.OfflineUtils.DB_SCHEME","shaka.offline.OfflineUtils.getStoredContent","shaka.offline.OfflineUtils.reconstructPeriod","offlineUri","originalManifestUri","appMetadata","textStreamsDb","streamDb","audioStreamsDb","videoStreamsDb","shaka.offline.OfflineUtils.createVariants_","shaka.offline.OfflineUtils.createStream_","refs","shaka.offline.OfflineUtils.getSegmentReferences_","audios","videos","shaka.offline.OfflineUtils.areCompatible_","stream1","stream2","variantIds","containsId","initSegmentUri","initRef","shaka.offline.OfflineUtils.createStorageEngine","shaka.offline.DownloadManager","storageEngine","segments_","storedSegments_","storageEngine_","netEngine_","retryParams_","promise_","bandwidthBytesDownloaded_","bandwidthBytesTotal_","givenBytesDownloaded_","givenBytesTotal_","shaka.offline.DownloadManager.prototype.destroy","storage","removeKeys","shaka.offline.DownloadManager.prototype.addSegment","bandwidthSize","segmentDb","shaka.offline.DownloadManager.prototype.downloadAndStore","downloadNext","downloadSegment_","insert","shaka.offline.DownloadManager.prototype.downloadSegment_","byteCount","progress","updateProgress_","progressCallback","shaka.offline.OfflineManifestParser","manifestId_","shaka$offline$OfflineManifestParser.prototype","shaka.offline.OfflineManifestParser.prototype","shaka.offline.OfflineManifestParser.prototype.configure","shaka.offline.OfflineManifestParser.prototype.start","shaka.util.Error.Code.MALFORMED_OFFLINE_URI","manifestId","shaka.util.Error.Code.REQUESTED_ITEM_NOT_FOUND","shaka.offline.OfflineManifestParser.reconstructManifest","shaka.util.Error.Code.STORAGE_NOT_SUPPORTED","shaka.offline.OfflineManifestParser.prototype.stop","shaka.offline.OfflineManifestParser.prototype.update","shaka.offline.OfflineManifestParser.prototype.onExpirationUpdated","sessionIds","shaka.offline.OfflineScheme","manifestParts","segmentParts","OfflineScheme","shaka.util.CancelableChain","canceled_","complete_","final_","cancelPromise_","onCancelComplete_","shaka.util.CancelableChain.prototype.then","rejectionValue_","shaka.util.CancelableChain.prototype.finalize","shaka.util.CancelableChain.prototype.cancel","reason","shaka.Player","opt_dependencyInjector","defaultAbrManager_","streamingEngine_","playheadObserver_","playhead_","mediaSourceOpen_","mediaSourceEngine_","drmEngine_","nextExternalStreamId_","loadingTextStreamIds_","switchingPeriods_","unloadChain_","loadChain_","deferredSwitches_","pendingTimelineRegions_","activeStreamsByPeriod_","defaultConfig_","maxHwRes_","stats_","getCleanStats_","lastTimeStatsUpdateTimestamp_","currentAudioLanguage_","preferredAudioLanguage","currentTextLanguage_","preferredTextLanguage","currentTextRole_","currentVariantRole_","createNetworkingEngine","initialize_","createMediaSource","shaka.Player.TextTrackLabel_","addTextTrack","onVideoError_","shaka.Player.prototype.destroy","cancelation","destroyStreaming_","GIT_VERSION","shaka.Player.supportPlugins_","shaka.Player.registerSupportPlugin","shaka.Player.isBrowserSupported","MediaKeys","MediaKeySystemAccess","shaka.Player.probeSupport","drm","shaka.Player.prototype.load","opt_startTime","unloadPromise","loadChain","finalize","updateState_","filterPeriod_","onTimelineRegionAdded_","shaka.util.Error.Code.NO_PERIODS","createDrmEngine","attach","createPlayhead","streaming","createPlayheadObserver","createMediaSourceEngine","createStreamingEngine","onChooseStreams_","canSwitch_","onManifestUpdate_","onSegmentAppended_","chooseCodecsAndFilterManifest_","startAtSegmentBoundary","adjustStartTime_","setStartTime","onTracksChanged_","onAdaptation_","getCurrentPeriod","loadLatency","shaka.Player.prototype.chooseCodecsAndFilterManifest_","variantCodecs","baseVideoCodec","baseAudioCodec","variantsByCodecs","bestCodecs","lowestAverageBandwidth","sum","num","averageBandwidth","shaka.Player.prototype.createMediaSource","src","URL","createObjectURL","shaka.Player.prototype.configure","configOverrides_","applyConfig_","shaka.Player.prototype.applyConfig_","chooseStreamsAndSwitch_","defaultBandwidthEstimate","shaka.Player.prototype.getConfiguration","resetConfiguration","shaka.Player.prototype.resetConfiguration","getMediaElement","shaka.Player.prototype.getMediaElement","shaka.Player.prototype.getNetworkingEngine","getManifestUri","shaka.Player.prototype.getManifestUri","shaka.Player.prototype.isLive","shaka.Player.prototype.isInProgress","seekRange","shaka.Player.prototype.seekRange","shaka.Player.prototype.keySystem","shaka.Player.prototype.drmInfo","shaka.Player.prototype.getExpiration","isBuffering","shaka.Player.prototype.isBuffering","shaka.Player.prototype.unload","interrupt","resetStreaming_","shaka.Player.prototype.getPlaybackRate","trickPlay","shaka.Player.prototype.trickPlay","setTrickPlay","cancelTrickPlay","shaka.Player.prototype.cancelTrickPlay","shaka.Player.prototype.getTracks","selectTrack","shaka.Player.prototype.selectTrack","opt_clearBuffer","selectTextTrack","shaka.Player.prototype.getVariantTracks","shaka.Player.prototype.getTextTracks","shaka.Player.prototype.selectTextTrack","addToSwitchHistory_","streamsToSwitch","deferredSwitch_","shaka.Player.prototype.selectVariantTrack","getActiveStreams","updateActiveStreams_","currentTextStream","getAudioLanguages","shaka.Player.prototype.getAudioLanguages","getTextLanguages","shaka.Player.prototype.getTextLanguages","shaka.Player.prototype.selectAudioLanguage","shaka.Player.prototype.selectTextLanguage","isTextTrackVisible","shaka.Player.prototype.isTextTrackVisible","setTextTrackVisibility","shaka.Player.prototype.setTextTrackVisibility","onTextTrackVisibility_","getPlayheadTimeAsDate","shaka.Player.prototype.getPlayheadTimeAsDate","getStats","shaka.Player.prototype.getStats","updateTimeStats_","videoInfo","getVideoPlaybackQuality","streamBandwidth","decodedFrames","totalVideoFrames","droppedFrames","droppedVideoFrames","estimatedBandwidth","playTime","bufferingTime","switchHistory","stateHistory","shaka.Player.prototype.addTextTrack","mime","opt_codec","opt_label","curPeriodIdx","shaka.Player.prototype.setMaxHardwareResolution","shaka.Player.prototype.addToSwitchHistory_","fromAdaptation","timestamp","shaka.Player.prototype.updateActiveStreams_","shaka.Player.prototype.destroyStreaming_","shaka.Player.prototype.resetStreaming_","shaka.Player.prototype.configOverrides_","shaka.Player.prototype.defaultConfig_","shaka.Player.prototype.getCleanStats_","shaka$Player.prototype","shaka.Player.prototype","shaka_Player_prototype$filterPeriod_","shaka.Player.prototype.filterPeriod_","hasPlayableVariants","allVariantsRestricted","shaka.util.Error.Code.UNPLAYABLE_PERIOD","shaka.Player.prototype.deferredSwitch_","shaka.Player.prototype.updateTimeStats_","shaka.Player.prototype.adjustStartTime_","getAdjustedTime","idx","videoStartTime","audioStartTime","shaka_Player_prototype$onSegmentDownloaded_","shaka.Player.prototype.onSegmentDownloaded_","shaka_Player_prototype$onBuffering_","shaka.Player.prototype.onBuffering_","shaka_Player_prototype$onChangePeriod_","shaka.Player.prototype.onChangePeriod_","shaka.Player.prototype.updateState_","newState","lastEntry","shaka_Player_prototype$onSeek_","shaka.Player.prototype.onSeek_","seeked","shaka.Player.prototype.chooseStreams_","opt_chooseAll","needsUpdate","anyMediaState","activeVariant","activePeriod","shaka.Player.prototype.chooseStreamsAndSwitch_","languageMatches","chooseStreams_","shaka.Player.prototype.onChooseStreams_","shaka.Player.prototype.canSwitch_","shaka.Player.prototype.onManifestUpdate_","shaka.Player.prototype.onSegmentAppended_","shaka_Player_prototype$switch_","shaka.Player.prototype.switch_","oldActive","shaka.Player.prototype.onAdaptation_","shaka.Player.prototype.onTracksChanged_","shaka.Player.prototype.onTextTrackVisibility_","shaka_Player_prototype$onError_","shaka.Player.prototype.onError_","shaka.Player.prototype.onTimelineRegionAdded_","shaka_Player_prototype$onEvent_","shaka.Player.prototype.onEvent_","shaka.Player.prototype.onVideoError_","extended","msExtendedCode","shaka.util.Error.Code.VIDEO_ERROR","shaka_Player_prototype$onKeyStatus_","shaka.Player.prototype.onKeyStatus_","keyStatusMap","restrictedStatuses","keyStatus","shaka_Player_prototype$onExpirationUpdated_","shaka.Player.prototype.onExpirationUpdated_","shaka.offline.Storage","shaka.util.Error.Code.LOCAL_PLAYER_INSTANCE_REQUIRED","storeInProgress_","firstPeriodTracks_","downloadManager_","Storage","shaka.offline.Storage.support","shaka.offline.Storage.prototype.destroy","shaka.offline.Storage.prototype.configure","shaka.offline.Storage.prototype.store","shaka.util.Error.Code.STORE_ALREADY_IN_PROGRESS","manifestDb","initIfNeeded_","checkDestroyed_","loadInternal","shaka.util.Error.Code.CANNOT_STORE_LIVE_OFFLINE","createOfflineManifest_","getSessionIds","shaka.util.Error.Code.NO_INIT_DATA_FOR_OFFLINE","downloadAndStore","cleanup_","shaka.offline.Storage.prototype.remove","content","removeSessions","deleteCount","segmentCount","shaka.offline.Storage.prototype.list","storedContents","shaka.offline.Storage.prototype.loadInternal","onKeyStatusChange","manifestParser","createSegmentIndex_","defaultTrackSelect_","shaka.offline.Storage.prototype.defaultTrackSelect_","selectedTracks","audioLangPref","matchTypes","allVariantTracks","tracksByMatchType","primaryTracks","languages","tracksByHeight","shaka.offline.Storage.prototype.defaultConfig_","trackSelectionCallback","storedContent","percent","shaka.offline.Storage.prototype.initIfNeeded_","shaka.offline.Storage.prototype.filterPeriod_","shaka.offline.Storage.prototype.cleanup_","shaka.offline.Storage.prototype.createSegmentIndex_","variantStreams","shaka.offline.Storage.prototype.createPeriod_","chosenTracks","allTracks","foundSimilarTracks","bandwidthEstimation","createStream_","shaka.offline.Storage.prototype.createStream_","estimatedStreamBandwidth","opt_variantId","segmentsDb","addSegment","segmentDataDb","manifestKey","streamNumber","segmentNumber","initDataDb","shaka.offline.Storage.prototype.checkDestroyed_","shaka.polyfill.installAll","shaka.polyfill.polyfills_.length","shaka.polyfill.polyfills_","shaka.polyfill.register","shaka.polyfill.polyfills_.push","register","shaka.polyfill.Fullscreen.proxyEvent_","eventType","newEvent","createEvent","initEvent","shaka.polyfill.Fullscreen.install","Document","proto","requestFullscreen","mozRequestFullScreen","msRequestFullscreen","mozCancelFullScreen","msExitFullscreen","webkitExitFullscreen","mozFullScreenElement","msFullscreenElement","webkitFullscreenElement","mozFullScreenEnabled","msFullscreenEnabled","webkitFullscreenEnabled","shaka.polyfill.IndexedDB.install","agent","shaka.polyfill.MathRound.install","testNumber","original_mathRound","Math.round","shaka.polyfill.MathRound.MAX_ACCURATE_INPUT_","shaka.util.Pssh","psshBox","systemIds","cencKeyIds","dataBoundaries","parseBox_","shaka.util.Pssh.prototype.parseBox_","systemId","numKeyIds","dataSize","shaka.polyfill.PatchedMediaKeysMs.requestMediaKeySystemAccess","supportedConfigurations","shaka.polyfill.PatchedMediaKeysMs.MediaKeySystemAccess","success","cfg","newCfg","initDataTypes","ranAnyTests","cap","MSMediaKeys","configuration_","unsupportedKeySystemError","DOMException","NOT_SUPPORTED_ERR","shaka.polyfill.PatchedMediaKeysMs.MediaKeySystemAccess.prototype.createMediaKeys","shaka.polyfill.PatchedMediaKeysMs.MediaKeys","shaka.polyfill.PatchedMediaKeysMs.MediaKeySystemAccess.prototype.getConfiguration","shaka.polyfill.PatchedMediaKeysMs.setMediaKeys","oldMediaKeys","setMedia","nativeMediaKeys_","shaka.polyfill.PatchedMediaKeysMs.MediaKeys.prototype.createSession","opt_sessionType","TypeError","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession","shaka.polyfill.PatchedMediaKeysMs.MediaKeys.prototype.setServerCertificate","shaka.polyfill.PatchedMediaKeysMs.MediaKeys.prototype.setMedia","setMediaKeysDeferred","msSetMediaKeys","shaka.polyfill.PatchedMediaKeysMs.onMsNeedKey_","nativeMediaKeys","nativeMediaKeySession_","updatePromise_","generateRequestPromise_","closed","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap","shaka$polyfill$PatchedMediaKeysMs$MediaKeySession.prototype","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.generateRequest","onMsKeyMessage_","onMsKeyAdded_","onMsKeyError_","updateKeyStatus_","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.load","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.update","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.close","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.remove","event2","initCustomEvent","unfilteredInitDatas","currPssh","dedupedInitDatas","shaka.polyfill.PatchedMediaKeysMs.compareInitDatas_","targetLength","normalisedInitData","initDataA","initDataB","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.onMsKeyMessage_","messageType","getStatus","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.onMsKeyAdded_","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.onMsKeyError_","errorCode","MSMediaKeyError","MS_MEDIA_KEYERR_OUTPUT","MS_MEDIA_KEYERR_HARDWARECHANGE","shaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.updateKeyStatus_","setStatus","status_","shaka$polyfill$PatchedMediaKeysMs$MediaKeyStatusMap.prototype","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.setStatus","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.getStatus","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.forEach","fn","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.KEY_ID_","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.get","has","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.has","fakeKeyId","entries","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.entries","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.keys","values","shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.values","shaka.polyfill.PatchedMediaKeysNop.requestMediaKeySystemAccess","shaka.polyfill.PatchedMediaKeysNop.setMediaKeys","shaka.polyfill.PatchedMediaKeysNop.MediaKeys","shaka.polyfill.PatchedMediaKeysNop.MediaKeys.prototype.createSession","shaka.polyfill.PatchedMediaKeysNop.MediaKeys.prototype.setServerCertificate","shaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess","shaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess.prototype.getConfiguration","shaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess.prototype.createMediaKeys","shaka.polyfill.PatchedMediaKeysWebkit.prefix_","shaka.polyfill.PatchedMediaKeysWebkit.install","prefix","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.KEY_ID_","shaka.polyfill.PatchedMediaKeysWebkit.requestMediaKeySystemAccess","HTMLMediaElement","shaka.polyfill.PatchedMediaKeysWebkit.setMediaKeys","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess","shaka.polyfill.PatchedMediaKeysWebkit.prefixApi_","api","toUpperCase","internalKeySystem_","allowPersistentState","tmpVideo","createElement","unsupportedError","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.createMediaKeys","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.getConfiguration","keySystem_","media_","newSessions_","sessionMap_","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setMedia","onWebkitNeedKey_","onWebkitKeyMessage_","onWebkitKeyAdded_","onWebkitKeyError_","shaka$polyfill$PatchedMediaKeysWebkit$MediaKeys.prototype","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.createSession","sessionType","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setServerCertificate","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitNeedKey_","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyMessage_","findSession_","generatePromise_","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyAdded_","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyError_","systemCode","MediaKeyError","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.findSession_","type_","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generate_","offlineSessionId","mangledInitData","generateKeyRequestName","shaka$polyfill$PatchedMediaKeysWebkit$MediaKeySession.prototype","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype","shaka_polyfill_PatchedMediaKeysWebkit_MediaKeySession_prototype$update_","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update_","licenseString","addKeyName","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.updateKeyStatus_","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generateRequest","generate_","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.load","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update","nextUpdatePromise","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.close","cancelKeyRequestName","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.remove","shaka$polyfill$PatchedMediaKeysWebkit$MediaKeyStatusMap.prototype","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.setStatus","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.getStatus","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.forEach","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.get","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.has","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.entries","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.keys","shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.values","shaka.polyfill.MediaKeys.install","HTMLVideoElement","webkitGenerateKeyRequest","generateKeyRequest","shaka.polyfill.MediaSource.stubAbort_","MediaSource.prototype.addSourceBuffer","sourceBuffer.abort","shaka.polyfill.MediaSource.patchEndOfStreamEvents_","MediaSource.prototype.endOfStream","newDuration","sourceBuffers","ignoreUpdateEnd_","eventSuppressed_","shaka.polyfill.MediaSource.ignoreUpdateEnd_","cleanUpHandlerInstalled_","shaka.polyfill.MediaSource.cleanUpListeners_","shaka.polyfill.MediaSource.install","vendor","appVersion","shaka.polyfill.Promise","opt_callback","thens_","catches_","state_","shaka.polyfill.Promise.State.PENDING","resolve_","reject_","PENDING","shaka.polyfill.Promise.resolve","shaka.polyfill.Promise.reject","shaka.polyfill.Promise.all","others","newValue","shaka.polyfill.Promise.race","shaka.polyfill.Promise.prototype.then","opt_successCallback","opt_failCallback","RESOLVED","schedule_","REJECTED","shaka.polyfill.Promise.prototype.catch","shaka.polyfill.Promise.prototype.resolve_","value_","shaka.polyfill.Promise.prototype.reject_","shaka.polyfill.Promise.prototype.schedule_","shaka.polyfill.Promise.q_.push","wrapper","shaka.polyfill.Promise.handleThenable_","shaka.polyfill.Promise.flushTimer_","shaka.polyfill.Promise.setImmediate_","shaka.polyfill.Promise.flush","thenable","sealed","nextThen","shaka.polyfill.Promise.q_.length","shaka.polyfill.Promise.clearImmediate_","shaka.polyfill.Promise.q_","shaka.polyfill.Promise.install","opt_force","setImmediate","clearImmediate","race","shaka.polyfill.VideoPlayPromise.install","originalPlay","HTMLMediaElement.prototype.play","shaka.polyfill.VideoPlaybackQuality.webkit_","webkitDroppedFrameCount","webkitDecodedFrameCount","shaka.polyfill.VideoPlaybackQuality.install","shaka.polyfill.VTTCue.from3ArgsTextTrackCue_","TextTrackCue","shaka.polyfill.VTTCue.from6ArgsTextTrackCue_","shaka.polyfill.VTTCue.install","constructorLength","loadPlayer","SOURCE_SELECTED","selectedSource","provider","partnerId","getConfig","entryId","_generateGUID","S4","substring","_addSessionId","delimiter","primaryGUID","secondGUID","_replaceSecondGUID","secondGUIDRegex","newSessionId","handleSessionId","sessionIdRegex"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;AC7DA,0DACA;+GACA,2BACA,uBACA,yEACA;AAAA;AAAA;AAAA,qLACA,+BAEA,iCACA;AAAC;AACD,S;;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,uDAA2C;eAAc;;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACK;AACL;;AACA;;;AAEA;AACA;AACA;AACA,sCAA2B;wBAA0B;AAAE;AACvD,4CAAiC;iBAAe;;AAChD;AACA;AACA;;;AAEA;AACA,kEAAsD;4DAA+D;;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9DA;;;;UAIqB;;eAqCnB;;AAfA;;;;;;AAdA;;;;;;;;;;;;;8BAmCE;mBAAO,KACR;AAED;;AAjBA;;;;;;AAdA;;;;;;;AAdA;;;;;;;;;;;;;;;;8BAmDE;mBAAO,KACR;AAED;;;;;;;;8BAKW,OACT;iBAAK,UACN;AAED;;;;;;;;;;8BAME;mBAAO,KACR;AAED;;;;;;;;;;8BAME;mBAAO,KACR;AAED;;;;;;;;;;8BAME;mBAAO,KACR;AAED;;AAIA;;;;;;;yBAAmC;cAAA;;gCACjC;;eAAK,MAAM,SACX;eAAK,UAAU,SACf;eAAK,SAAS,SACd;eAAK,YAAY,SACjB;eAAK,SAAS,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AEA,0DACA;iCACA;8BACA;yBACA;iBACA;AAEA;;wDACA;wCACA;oEACA;uEACA;AAEA;;2EACA;AAEA;;8BACA;;;AAEA;AACA,oCACA;AACA;qEACA;mBAAkE,iEAElE;;+BACA;;;;;;;;AC3EA,yEAIA;;;;;yBAEA;AAEA;;AACA;;qBAEA;;AACA;yBAEA;;AACA;YAEA;;AACA;yCAEA;;AACA;8CACA;6BACA;qCACA;AACA;AAEA;;AACA;qCACA;;;;cACA;mBAAa,YAAiB,aAC9B;iCACA;mEACA;sCACA;AACA;AACA;AACA;iBACA;AAEA;;AACA;kEACA;iBAAU,sBACV;AAEA;;AACA;yCACA;wCACA;wCACA;wCACA;yCACA;wCAEA;;AACA;AACA;;yBAEA;uCACA;0BAAuB,KAFvB,CAGA;AAEA;;;AAEA;gDACA;AACA;iDACA;yCACA;AACA;AAEA;;AACA;+CACA;2CACA;4CACA;AAEA;;kCACA;sCACA;AAEA;;gCACA;qCACA;AAEA;;gCACA;qCACA;AAEA;;kCACA;sCACA;AAEA;;qCACA;+DACA;+CACA;AACA;AAEA;;2CACA;+DACA;+CACA;AACA;AAEA;;AACA;kDACA;sDACA;wCAA+B,SAAe,cAC9C;AACA;AAGA;AAlDA;;AAmDA;gDAA0C,sBAE1C;;AACA;qBACA;AACA;kBAEA;;yDACA;oDACA;mDACA;sDACA;mDACA;mDACA;oDAEA;;AACA;oBACA;AAEA;;AACA;AACA;AACA;4CACA;uBACA;AAEA;;AACA;AACA;2CACA;AACA;gCAEA;;AACA;sDACA;gEACA;uDACA;AACA;AACA;AAEA;;AACA;AACA;qCACA;AACA;4CACA,wEAAmE,QAAa,qBAChF;AAEA;;AACA;AACA;AACA;yDACA;+BAEA;;uGACA;AACA;8BACA;oDACA;AACA;AAEA;;AACA;AACA;yCAEA;;AACA;iFACA;yDACA;AAEA;;AACA;8CACA;+BAAuB,iBACvB;AAEA;;8CACA;AACA;kDAEA;;+BACA;gBAEA;;+CACA;sFAEA;;2CACA;kCACA;+BACA;AACA,uBACA;oEACA;AACA;AACA,qBACA;qCACA;kCACA;AACA,uBACA;0DACA,uEACA;AACA;AACA;AACA,mBACA;AACA;iEACA;+BACA;AAAK,0EACL;+BACA;AAAK,wEACL;+BACA;AAEA;;0CACA;wCACA;AACA;AACA;AAEA;;AACA;AACA;gDACA;oEACA;wDACA;AAEA;;AACA;kBACA;6CAAA,qRACA;AACA,oEACA;2BACA;AACA,eACA;sCAEA;;0CACA;mCACA;mBACA;AAEA;;0BACA;AACA;AAAC,cA3PD;;;;;;;ACLA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBACA;AACA;6BACA;gGACA;qCACA;sFACA;mBACA;AACA;AACA;AACA;uCAAgC;AAAU;AAC1C;;;;;;;;ACtBA;;;;;AAEA;;AAEA,yCACA;YAEA;;2BACA;iEACA;iBACA;AACA;;;AAEA,wCACA;AACA;AACA;AACA;AACA;AACA;6DACA;AAAC;;AAED,qCACA;mBAEA;;mCACA;qDACA;2CACA;AAEA;;sBACA;AACA;AAAC,0BACD;sCACA;AAAC;;AAED;AACA;AACA;;AAEA;;AAEA,gDACA;mDACA;iHACA;AAEA;;6BAEA;;+EAEA;;AACA;AACA;oDAEA;;AACA;sDAEA;;AACA;kDAEA;;wCAEA;;+BAEA;;wCACA;0BAEA;;uBAAiB,cAAmB,aACpC;8BACA;4CAEA;;qBACA;2BACA;AAEA;;uBACA;kDACA;sCACA;AAEA;;uBAAiB,iBAAsB,aACvC;qCAEA;;qCACA;2BAAmB,sBAA2B;+BAE9C;2CACA;AACA;AACA;AACA;;;AAEA,+CACA;qBAAgB,cAAmB,aACnC;4BACA;0CAEA;;wBACA;qBAEA;;yBAAiB,sBAA2B,aAC5C;2CACA;AAEA;;AAAQ,kCAAuB,aAC/B;0DACA;AACA;AAAG,iBACH;wBAEA;;yBAAiB,kBAAuB,aACxC;iDACA;AAEA;;qCAA2B,6BAC3B;AACA;AACA;;;AAEA,2CACA;qBACA;wBAEA;;qBAAgB,YAAiB,aACjC;0BACA;gEACA;yBACA;2BACA;+BACA;uBAAc,mCAEd;;4DAAkD,gBAClD,uCACA;AAEA;;eACA;;;AAEA,kDACA;wCAEA;;qBACA;0BACA;AAEA;;6FAEA;;wCACA;8CACA;8CACA;AAAG,gEACH;qEACA;AAAG,iBACH;+BACA;AACA;mCACA;AAAE,kDACF;6BACA;AAAE,eACF;0BACA;AACA;;;AAEA,yCACA;8CACA;qCAEA;;8CACA;sBACA;0CACA;AACA;;;AAEA,2CACA;2CAEA;;6BAEA;;gCACA;oCAEA;;eACA;;;AAEA,0CACA;0CAEA;;6BACA;4BAEA;;+BACA;oCAEA;;eACA;;;AAEA,mCACA;kDACA;qCACA;AACA;;;AAEA,sCACA;mCAEA;;AACA;0CACA;yCAEA;;sBACA;AACA;AACA;sBACA;AAAM,iBACN;AACA;AACA;+BACA;AACA;AACA;AACA;AAEA;;+BACA;2BAEA;;+DAEA;;qEACA;qEAEA;AAAE,uBAEF,4BACA,6CACA,6CACA,8BACA,8BACA,YACA;oCACA;gDACA;qCACA;+BAEA;;sDACA;AACA;AAAE,SAdF,MAeA;qCACA;yCACA;qCACA;+BACA;AACA;AAEA;;eAEA;;4CACA;sBACA;AACA,mCACA,4BACA,kCACA,WACA;AACA;AAEA;;yBACA;AAAG,iBACH;AACA;AACA;AACA;;;AAEA,oCACA;wBAEA;;6CACA;6BAEA;;gDACA;AACA;AAAC;;AAED,8DACA;oCAEA;;8BACA;wDACA;AAAE,eACF;gDACA;iCAEA;;8DAEA;;iCACA;mDACA;AAAG,iBACH;8BACA;AACA;AACA;;;AAEA,sCACA;sBACA;wBAEA;;mBACA;sCACA;AAEA;;8BACA;qCACA;AAAE,eACF;mCACA;oCACA;AAEA;;oDACA;AACA;;;AAEA,8CACA;sBACA;4BAEA;;AAMA;;;;;;yEAEA;;0DACA;wBACA;AAEA;;uBACA;AACA;iBAAuD,yHACvD;AAEA;;mCAA6B,QAE7B;;0BAEA;;wCAEA;;wCACA;;;;;;;;ACpVA;;;;;;;;;;;;;AAEA,sCACA;AACA;+DAEA;;uBACA;0BACA;AAEA;;AACA;6CACA;iBACA;AAEA;;0DACA;0EAEA;;AACA;AAyBA;;;;;;;;;;;;;;;;;;;;;;;wHACA;AACA;wCAE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AIqB,2BAoBnB;;AAbA;;;;AAgBA;;;;;gCAAc;gCACZ;;eAAK,cACL;eAAK,OACL;eAAK,MACN;AAED;;AAhBA;;;;;;;AAZA;;;;;;;;;;;;;;8BAkCI,QAAqB,aACvB;gBAAI,aACF;sBAAQ,YACN;qBACE;uBAAK,YAAY,KACjB;AACF;qBACE;uBAAK,KAAK,KACV;AACF;qBACE;uBAAK,IAAI,KACT;AACF;AACE;AAEL;;AACF;;;;;;;wBAnDkB;;;;;;;AfRrB,yEAIA;;;;;yBAEA;AAEA;;AACA;;qBAEA;;AACA;yBAEA;;AACA;YAEA;;AACA;yCAEA;;AACA;8CACA;6BACA;qCACA;AACA;AAEA;;AACA;qCACA;;;;cACA;mBAAa,YAAiB,aAC9B;iCACA;mEACA;sCACA;AACA;AACA;AACA;iBACA;AAEA;;AACA;kEACA;iBAAU,sBACV;AAEA;;AACA;yCACA;wCACA;wCACA;wCACA;yCACA;wCAEA;;AACA;AACA;;yBAEA;uCACA;0BAAuB,KAFvB,CAGA;AAEA;;;AAEA;gDACA;AACA;iDACA;yCACA;AACA;AAEA;;AACA;+CACA;2CACA;4CACA;AAEA;;kCACA;sCACA;AAEA;;gCACA;qCACA;AAEA;;gCACA;qCACA;AAEA;;kCACA;sCACA;AAEA;;qCACA;+DACA;+CACA;AACA;AAEA;;2CACA;+DACA;+CACA;AACA;AAEA;;AACA;kDACA;sDACA;wCAA+B,SAAe,cAC9C;AACA;AAGA;AAlDA;;AAmDA;gDAA0C,sBAE1C;;AACA;qBACA;AACA;kBAEA;;yDACA;oDACA;mDACA;sDACA;mDACA;mDACA;oDAEA;;AACA;oBACA;AAEA;;AACA;AACA;AACA;4CACA;uBACA;AAEA;;AACA;AACA;2CACA;AACA;gCAEA;;AACA;sDACA;gEACA;uDACA;AACA;AACA;AAEA;;AACA;AACA;qCACA;AACA;4CACA,wEAAmE,QAAa,qBAChF;AAEA;;AACA;AACA;AACA;yDACA;+BAEA;;uGACA;AACA;8BACA;oDACA;AACA;AAEA;;AACA;AACA;yCAEA;;AACA;iFACA;yDACA;AAEA;;AACA;8CACA;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B;;IAAYA,O;;AAGZ;;;;AAGA;;;;AACA;;AAGA;;AACA;;AAEA;;;;;;;;AACA;;AAZA;QAcQA,O,GAAAA,O;QAASC,W;QAAaC,S;QAAWC,K;;AAPzC;;;AAJA;;;AANA,c;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AC7DA;AACA;AACA;AACA;AACA;AACA,kCAAkC,SAAS;AAC3C;AACA;AACA;AACA;AACA,sGAAsG,KAAK,wBAAwB;AACnI;AACA,sFAAsF,0DAA0D;AAChJ,6EAA6E,4DAA4D;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uHAAuH;AACvH;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,SAAS,mEAAmE;AAC5E;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,aAAa;AACb,uCAAuC;AACvC,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA,kIAAkI,iCAAiC,6HAA6H;AAChS;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAqF;AACrF;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,6FAA6F;AAC7F,sCAAsC,SAAS;AAC/C;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,uCAAuC,UAAU;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,oDAAoD,iBAAiB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,gHAAgH;AAC7L;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,2CAA2C,KAAK;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8IAA8I;AAC9I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8IAA8I;AAC9I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE;AACzE;AACA;AACA;AACA;AACA,uJAAuJ;AACvJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAA8D;AAC9D,CAAC;AACD,kC;;;;;;AC/YA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA;;;;;;;;;;AAUA;AACA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;;;;AAUA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;;AAIA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,qBAAqB,sBAAsB;AAC3C;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,CAAC;;AAED;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qEAAqE;;AAErE;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,wCAAwC;AACxC,kDAAkD;;AAElD;AACA;;AAEA;;AAEA;;AAEA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,yBAAyB;AACzB;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uFAAuF,gBAAgB;AACvG;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,YAAY;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,QAAQ;AACrB;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,YAAY;AACZ,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA,oBAAoB;AACpB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oCAAoC,QAAQ;AAC5C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,qEAAqE;;AAErE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wEAAwE;;AAExE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;;;;;;;;;;;;;;;;AChmCA;;AACA;;;;AACA;;;;;;;;;;;;IAEMC,a;;;AAMJ,2BAAmD;AAAA,QAAvCC,GAAuC,uEAAhB,EAAEC,QAAQ,EAAV,EAAgB;;AAAA;;AAAA;;AAGjD,UAAKC,IAAL,GAAYF,IAAIE,IAAhB;AACA,UAAKC,MAAL,GAAcH,IAAIG,MAAlB;AACA,UAAKF,MAAL,GAAcD,IAAIC,MAAlB;AACA,UAAKG,MAAL,GAAc,iBAAcC,SAAd,SAA8B,MAAKH,IAAnC,CAAd;AACA,UAAKE,MAAL,CAAY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f;AACE,SAAKC,MAAMe,WAAX;AACE,0BACKT,KADL;AAEEU,mBAAWT,OAAOS;AAFpB;;AAKF;AACE,aAAOV,KAAP;AARJ;AAUD,C;;AAEM,IAAMX,4BAAU;AACrBsB,mBAAiB,yBAACD,SAAD;AAAA,WAAyB,EAAEjB,MAAMC,MAAMe,WAAd,EAA2BC,oBAA3B,EAAzB;AAAA;AADI,CAAhB,C;;;;;;;;;;;;;;;ACrBA,IAAMhB,wBAAQ;AACnBkB,wBAAsB;AADH,CAAd;;AAIA,IAAMd,sCAAe;AAC1Be,eAAa;AADa,CAArB;;kBAIQ,YAAkC;AAAA,MAAjCb,KAAiC,uEAAzBF,YAAyB;AAAA,MAAXG,MAAW;;AAC/C,UAAQA,OAAOR,IAAf;AACE,SAAKC,MAAMkB,oBAAX;AACE,0BACKZ,KADL;AAEEa,qBAAaZ,OAAOa;AAFtB;;AAKF;AACE,aAAOd,KAAP;AARJ;AAUD,C;;AAEM,IAAMX,4BAAU;AACrB0B,sBAAoB,4BAACD,IAAD;AAAA,WAAoB,EAAErB,MAAMC,MAAMkB,oBAAd,EAAoCE,UAApC,EAApB;AAAA;AADC,CAAhB,C;;;;;;ACvBP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,QAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,WAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAqC;;AAErC;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,4BAA4B,UAAU;;;;;;;;;;;;;ACvLtC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACsB;AACtB;AACA;AACA,QAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA,eAAe,MAAM;AACrB;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,IAAI;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACsB;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACK;AACL;AACA;;AAEA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAsB;AACtB,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAuC;AACvC;;AAEA;AACA;AAC0B;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACwB;AACxB;AACA,mBAAmB,aAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAgB;AAChB;AACA,KAAK;AACL;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,WAAqC;;AAErC;AACA;AACA;AACA;AACA;AACA,GAAG;;;;;;;;;;;ACtPH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;AC7DA;;AAEA;AACA;;AAEA;;;;;;;ACLA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;ACpBA;AAAA;AACA;AACA;AACA;AACA;AACuB;AACvB,aAAa,SAAS;AACtB;AACA;AACA;;AAEA;AAC+E;AAC/E;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH,C;;;;;;;;;;;;;;;AC9BO,IAAMpB,IAAQ;AACnBsB,uBAAqB,4BADF;AAEnBC,qBAAmB,0BAFA;AAGnBC,uBAAqB,4BAHF;AAIn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;AAEA;AACA;;AAEA;AACA;;AAEA;;;;;;;;ACRA;AACA;;AAEA;;;;;;;;;;ACHA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACa;AACb,SAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACK;AACL;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;AC7CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACa;AACb,SAAoB;AACpB;AACA;AACA;AACA;;AAEA;;;;;;;;;ACrBA;;AAEA;AACA;;AAEA;;;;;;;;ACLA;AACA;AACA;AACA;AACA,WAAW,QAAS;AACpB,SAAoB;AACpB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAa;AACb,aAAa,GAAQ;AACrB;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;AC5BA;;;;;;;;eCAA;;AAEA;AACA;AACA,CAAC;;AAED;;AAEA;;AAE+F;;AAEtF;;;AAGT;AACA;AACA,CAAC;AACD;AACC;AACD;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA;;AAEA;AACA,gB;;;;;;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;ACrBA;;AAEA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA,E;;;;;;;;;;;ACtBsB;AACtB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yCAAmE;AACnE;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAoE;;AAEpE;AACA;AACA;;AAEA;AACA,mCAAmC,aAAa;AAChD;AACA;AACG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,iBAAiB,wBAAwB;AACzC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;ACjIA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B;AACA;AACA;AACA,QAAoB;AACpB;AACA;AACA,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,C;;;;;;;;AClDA;AAAA,mDAAmD,gBAAgB,IAA2L;;AAE9P;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,YAAY;AACvB,QAAsB;AACtB;AACA;AACA,QAAqF;AACrF;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA,wBAAwB;AACxB;AACA,OAAO;AACP;AACA;AACA,C;;;;;;;;;;;;;;;;;;;AC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AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA;;AAEA;AACA,0CAA0C,eAA0B;;AAEpE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mEAAgF;AAChF;;AAEA;AACA,aAAsD;AACtD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAuB;AACvB;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;;;;;;;;;;;;;;;;;AC/PD;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;AAEwB;AAAA,SAAU;AAAA;AAEhCtF,kBAAc3B,MAAM8F,MAAN,CAAapE,WAAb,CAAyBC,GAFP;AAAA;AAIhCtB,cAAUL,MAAM4H,KAAN,CAAYvH;AAJA;AAAA,CAAxB;;IAQMwH,K,WADL,0BAAQC,eAAR,EAAyB,6CAAzB,C;;;AAEe;AAAA;;AAAA;AAEb;;;;QAEmB;AAClB;AACD;;;0BAEa;AACZ,UAAI/H,gBAAgB,aAApB;AACA;;AAEA,SAA+BA;AACA;;AAE/B,aACE;AAAA;AAAA,UAAK,WAAWA,aAAhB;AACIP,WAAMkF;AADV,OADF;AAKD;;;;;kBAGYmD,K;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AAK,UAAU,2BAA2B,mBAAmB,GAAG,UAAU,2BAA2B,oBAAoB,6BAA6B,KAAK,UAAU,2BAA2B,mBAAmB,GAAG,UAAU,2BAA2B,oBAAoB,cAAc,kBAAkB,MAAM,OAAO,WAAW,YAAY,uBAAuB,0DAA0D,kDAAkD,oBAAoB,YAAY,aAAa,UAAU,kBAAkB,QAAQ,SAAS,uBAAuB,UAAU;;AAE/mmB;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAmC,gBAAgB;AACnD,IAAI;AACJ;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA,YAAY,oBAAoB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,oDAAoD,cAAc;;AAElE;AACA;;;;;;;AC3EA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;AACA,CAAC;;AAED;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,iBAAiB,mBAAmB;AACpC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA,mBAAmB,2BAA2B;;AAE9C;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,mBAAmB;AACnC;AACA;;AAEA;AACA;;AAEA,iBAAiB,2BAA2B;AAC5C;AACA;;AAEA,QAAQ,uBAAuB;AAC/B;AACA;AACA,GAAG;AACH;;AAEA,iBAAiB,uBAAuB;AACxC;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,cAAc;;AAEd,kDAAkD,sBAAsB;AACxE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD;;AAEA,6BAA6B,mBAAmB;;AAEhD;;AAEA;;AAEA;AACA;;;;;;;;AC/VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,WAAW,EAAE;AACrD,wCAAwC,WAAW,EAAE;;AAErD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,sCAAsC;AACtC,GAAG;AACH;AACA,8DAA8D;AAC9D;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;;;;;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;AC5DA;;;;AACA;;;;;;;;;;AAGA;;;;IAIqBU,U;;;;;;;AAmDnB;;;;;;;;AArBA;;;;;;AAMA;;;;;;;AAOA;;;;;;;AAnCA;;;;;;gCAkDmBC,Q,EAA2B;AAC5C,UAAIC,iBAAkB,OAAOD,QAAP,KAAoB,QAArB,GAAiCD,WAAWG,aAAX,CAAyBC,QAAzB,CAAkCH,SAASI,WAAT,EAAlC,CAAjC,GAA6F,KAAlH;AACAL,iBAAWM,OAAX,CAAmB7O,KAAnB,CAAyB,qCAAqCwO,QAArC,GAAgD,MAAhD,GAAyDC,eAAeK,QAAf,EAAlF;AACA,aAAOL,cAAP;AACD;;AAED;;;;;;;AAjDA;;;;;;;AAdA;;;;;;;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CAqBZG,a,GAA+B,CACpC,uBADoC,EAEpC,+BAFoC,EAGpC,eAHoC,EAIpC,iBAJoC,EAKpC,iBALoC,EAMpC,eANoC,EAOpC,qBAPoC,C;kBArBnBH,U;AAmYrB,IAAIA,WAAWS,WAAX,EAAJ,EAA8B;AAC5B,6CAA2BT,UAA3B;AACD,C;;;;;;AC9YD,+C;;;;;;ACAA,+C;;;;;;;;;;;YCAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;;;AAGA;;;;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAGA;;;;AACA;;;;AAIA;;;;AACA;;;;AACA;;;;AACA;;;;;;AACA;;AAPA;;AAEA;;AANA;AACA;AAYO,IAAI,8CAAmB;AACxB,qBAAe,IADS,EACgB;AACxC,qBAAe,CAAC,CAFQ,EAEgB;AACxC,yBAAmB,SAHK,EAGgB;AACxC,aAAO,KAJiB,EAIgB;AACxC,yBAAmB,KALK,EAKgB;AACxC,4BAAsB,KANE,EAMgB;AACxC,+BAAyB,CAPD,EAOgB;AACxC,uBAAiB,EARO,EAQgB;AACxC,qBAAe,KAAK,IAAL,GAAY,IATH,EASgB;AACxC,qBAAe,GAVS,EAUgB;AACxC,mBAAa,CAXW,EAWgB;AACxC,+BAAyB,GAZD,EAYgB;AACxC,gCAA0B,CAbF,EAagB;AACxC,mBAAa,GAdW,EAcgB;AACxC,qBAAgB,CAfQ,EAegB;AACxC,8BAAwB,IAhBA,EAgBgB;AACxC,6BAAsB,CAjBE,EAiBgB;AACxC,mCAA6B,QAlBL,EAkBgB;AACxC,wBAAkB,SAnBM,EAmBg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","file":"kaltura-player.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"KalturaPlayer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"KalturaPlayer\"] = factory();\n\telse\n\t\troot[\"KalturaPlayer\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d30cd46ad570d42c093d","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Playkit\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Playkit\"] = factory();\n\telse\n\t\troot[\"Playkit\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition\n\n\n// WEBPACK FOOTER //\n// webpack:///core/webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 21);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f0d05eef2d0b0c7d87a0\n\n\n// WEBPACK FOOTER //\n// webpack:/core/webpack/bootstrap f0d05eef2d0b0c7d87a0","//@flow\n\n/**\n * General track representation of the player.\n * @classdesc\n */\nexport default class Track {\n  /**\n   * The id of the track.\n   * @member\n   * @type {string}\n   * @private\n   */\n  _id: ?string;\n  /**\n   * The active mode of the track.\n   * @member\n   * @type {boolean}\n   * @private\n   */\n  _active: boolean;\n  /**\n   * The label of the track.\n   * @member\n   * @type {string}\n   * @private\n   */\n  _label: string;\n  /**\n   * The language of the track.\n   * @member\n   * @type {string}\n   * @private\n   */\n  _language: string;\n  /**\n   * The index of the track.\n   * @member\n   * @type {number}\n   * @private\n   */\n  _index: number;\n\n  /**\n   * Getter for the track id.\n   * @public\n   * @returns {?string} - The track id.\n   */\n  get id(): ?string {\n    return this._id;\n  }\n\n  /**\n   * Getter for the active mode of the track.\n   * @public\n   * @returns {boolean} - The active mode of the track.\n   */\n  get active(): boolean {\n    return this._active;\n  }\n\n  /**\n   * Setter for the active mode of the track.\n   * @public\n   * @param {boolean} value - Whether the track is active or not.\n   */\n  set active(value: boolean) {\n    this._active = value;\n  }\n\n  /**\n   * Getter for the label of the track.\n   * @public\n   * @returns {string} - The label of the track.\n   */\n  get label(): string {\n    return this._label;\n  }\n\n  /**\n   * Getter for the language of the track.\n   * @public\n   * @returns {string} - The language of the track.\n   */\n  get language(): string {\n    return this._language;\n  }\n\n  /**\n   * Getter for the index of the track.\n   * @public\n   * @returns {number} - The index of the track.\n   */\n  get index(): number {\n    return this._index;\n  }\n\n  /**\n   * @constructor\n   * @param {Object} settings - The track settings object.\n   */\n  constructor(settings: Object = {}) {\n    this._id = settings.id;\n    this._active = settings.active;\n    this._label = settings.label;\n    this._language = settings.language;\n    this._index = settings.index;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./track/track.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/track/track.js","//@flow\nimport * as JsLogger from 'js-logger';\n\nconst LOG_LEVEL: { [level: string]: Object } = {\n  \"DEBUG\": JsLogger.DEBUG,\n  \"INFO\": JsLogger.INFO,\n  \"TIME\": JsLogger.TIME,\n  \"WARN\": JsLogger.WARN,\n  \"ERROR\": JsLogger.ERROR,\n  \"OFF\": JsLogger.OFF\n};\n\nclass LoggerFactory {\n  constructor(options?: Object) {\n    JsLogger.useDefaults(options || {});\n  }\n\n  getLogger(name?: string) {\n    if (!name) {\n      return JsLogger;\n    }\n    return JsLogger.get(name);\n  }\n}\n\nconst lf = new LoggerFactory({defaultLevel: JsLogger.DEBUG});\n\nexport default lf;\nexport {LOG_LEVEL};\n\n\n\n// WEBPACK FOOTER //\n// ./utils/logger.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/utils/logger.js","//@flow\n/**\n * Create an Event work-alike object based on the dictionary.\n * The event should contain all of the same properties from the dict.\n * @param {string} type -\n * @param {Object=} opt_dict -\n * @constructor\n * @extends {Event}\n */\nclass FakeEvent {\n  /** @const {boolean} */\n  bubbles: boolean;\n\n  /** @const {boolean} */\n  cancelable: boolean;\n\n  /** @const {boolean} */\n  defaultPrevented: boolean;\n\n  /**\n   * According to MDN, Chrome uses high-res timers instead of epoch time.\n   * Follow suit so that timeStamps on FakeEvents use the same base as\n   * on native Events.\n   * @const {number}\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Event/timeStamp\n   */\n  timeStamp: number | Date;\n\n  /** @const {string} */\n  type: string;\n\n  /** @const {boolean} */\n  isTrusted: boolean;\n\n  /** @type {EventTarget} */\n  currentTarget: any;\n\n  /** @type {EventTarget} */\n  target: any;\n\n  /**\n   * Non-standard property read by FakeEventTarget to stop processing listeners.\n   * @type {boolean}\n   */\n  stopped: boolean;\n\n  payload: any;\n\n  constructor(type: string, payload: any) {\n    // These Properties below cannot be set by dict.  They are all provided for\n    // compatibility with native events.\n\n    /** @const {boolean} */\n    this.bubbles = false;\n\n    /** @const {boolean} */\n    this.cancelable = false;\n\n    /** @const {boolean} */\n    this.defaultPrevented = false;\n\n    /**\n     * According to MDN, Chrome uses high-res timers instead of epoch time.\n     * Follow suit so that timeStamps on FakeEvents use the same base as\n     * on native Events.\n     * @const {number}\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Event/timeStamp\n     */\n    this.timeStamp = window.performance ? window.performance.now() : Date.now();\n\n    /** @const {string} */\n    this.type = type;\n\n    /** @const {boolean} */\n    this.isTrusted = false;\n\n    /** @type {EventTarget} */\n    this.currentTarget = null;\n\n    /** @type {EventTarget} */\n    this.target = null;\n\n\n    /**\n     * Non-standard property read by FakeEventTarget to stop processing listeners.\n     * @type {boolean}\n     */\n    this.stopped = false;\n\n    this.payload = payload;\n  }\n\n  /**\n   * Does nothing, since FakeEvents have no default.  Provided for compatibility\n   * with native Events.\n   * @override\n   */\n  preventDefault() {\n  }\n\n  /**\n   * Stops processing event listeners for this event.  Provided for compatibility\n   * with native Events.\n   * @override\n   */\n  stopImmediatePropagation() {\n    this.stopped = true;\n  }\n\n  /**\n   * Does nothing, since FakeEvents do not bubble.  Provided for compatibility\n   * with native Events.\n   * @override\n   */\n  stopPropagation() {\n  }\n}\n\nexport default FakeEvent;\n\n\n\n// WEBPACK FOOTER //\n// ./event/fake-event.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/event/fake-event.js","//@flow\nimport Track from './track'\n\n/**\n * Audio track representation of the player.\n * @classdesc\n */\nexport default class AudioTrack extends Track {}\n\n\n\n// WEBPACK FOOTER //\n// ./track/audio-track.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/track/audio-track.js","//@flow\nimport Track from './track'\n\n/**\n * Text track representation of the player.\n * @classdesc\n */\nexport default class TextTrack extends Track {\n  /**\n   * The kind of the text track:\n   * subtitles/captions/metadata.\n   * @member\n   * @type {string}\n   * @private\n   */\n  _kind: string;\n\n  /**\n   * Getter for the kind of the text track.\n   * @public\n   * @returns {string} - The kind of the text track.\n   */\n  get kind(): string {\n    return this._kind;\n  }\n\n  /**\n   * @constructor\n   * @param {Object} settings - The track settings object.\n   */\n  constructor(settings: Object = {}) {\n    super(settings);\n    this._kind = settings.kind;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./track/text-track.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/track/text-track.js","//@flow\nimport Track from './track'\n\n/**\n * Video track representation of the player.\n * @classdesc\n */\nexport default class VideoTrack extends Track {\n  /**\n   * The kind of the text track:\n   * subtitles/captions/metadata.\n   * @member\n   * @type {string}\n   * @private\n   */\n  _bandwidth: string;\n\n  /**\n   * Getter for the kind of the text track.\n   * @public\n   * @returns {string} - The kind of the text track.\n   */\n  get bandwidth(): string {\n    return this._bandwidth;\n  }\n\n  /**\n   * @constructor\n   * @param {Object} settings - The track settings object.\n   */\n  constructor(settings: Object = {}) {\n    super(settings);\n    this._bandwidth = settings.bandwidth;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./track/video-track.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/track/video-track.js","//@flow\nimport MultiMap from '../utils/multi-map'\nimport FakeEvent from './fake-event'\n\n/**\n * Creates a new EventManager. An EventManager maintains a collection of \"event\n * bindings\" between event targets and event listeners.\n *\n * @struct\n * @constructor\n * @implements {IDestroyable}\n */\nclass EventManager {\n  _bindingMap: MultiMap<Binding_> | null;\n\n  constructor() {\n    /**\n     * Maps an event type to an array of event bindings.\n     * @private {MultiMap.<!EventManager.Binding_>}\n     */\n    this._bindingMap = new MultiMap();\n  }\n\n  /**\n   * Detaches all event listeners.\n   * @override\n   */\n  destroy() {\n    this.removeAll();\n    this._bindingMap = null;\n    return Promise.resolve();\n  }\n\n\n  /**\n   * Attaches an event listener to an event target.\n   * @param {EventTarget} target The event target.\n   * @param {string} type The event type.\n   * @param {EventManager.ListenerType} listener The event listener.\n   * @returns {void}\n   */\n  listen(target: any, type: string, listener: ListenerType): void {\n    let binding = new Binding_(target, type, listener);\n    if (this._bindingMap) {\n      this._bindingMap.push(type, binding);\n    }\n  }\n\n\n  /**\n   * Detaches an event listener from an event target.\n   * @param {EventTarget} target The event target.\n   * @param {string} type The event type.\n   * @returns {void}\n   */\n  unlisten(target: any, type: string): void {\n    if (this._bindingMap) {\n      let list = this._bindingMap.get(type);\n\n      for (let i = 0; i < list.length; ++i) {\n        let binding = list[i];\n\n        if (binding.target == target) {\n          binding.unlisten();\n          if (this._bindingMap) {\n            this._bindingMap.remove(type, binding);\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Detaches all event listeners from all targets.\n   * @returns {void}\n   */\n  removeAll(): void {\n    if (this._bindingMap) {\n      let listeners = this._bindingMap.getAll();\n\n      for (let listener of listeners) {\n        listener.unlisten();\n      }\n      if (this._bindingMap) {\n        this._bindingMap.clear();\n      }\n    }\n  }\n}\n\n/**\n * @typedef {function(!Event)}\n */\ntype ListenerType = (event: FakeEvent) => any;\n\n/**\n * Creates a new Binding_ and attaches the event listener to the event target.\n * @param {EventTarget} target The event target.\n * @param {string} type The event type.\n * @param {EventManager.ListenerType} listener The event listener.\n * @constructor\n * @private\n */\nclass Binding_ {\n  target: any;\n  type: string;\n  listener: ?ListenerType;\n\n  constructor(target, type, listener) {\n    /** @type {EventTarget} */\n    this.target = target;\n\n    /** @type {string} */\n    this.type = type;\n\n    /** @type {?EventManager.ListenerType} */\n    this.listener = listener;\n\n    this.target.addEventListener(type, listener, false);\n  }\n\n\n  /**\n   * Detaches the event listener from the event target. This does nothing if the\n   * event listener is already detached.\n   * @returns {void}\n   */\n  unlisten(): void {\n    if (!this.target)\n      return;\n\n    this.target.removeEventListener(this.type, this.listener, false);\n\n    this.target = null;\n    this.listener = null;\n  }\n}\n\nexport default EventManager;\n\n\n\n// WEBPACK FOOTER //\n// ./event/event-manager.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/event/event-manager.js","//@flow\nimport {merge} from '../utils/util'\n\nconst HTML5_EVENTS: { [event: string]: string } = {\n  /**\n   * Fires when the loading of an audio/video is aborted\n   */\n  ABORT: 'abort',\n  /**\n   * Fires when the browser can start playing the audio/video\n   */\n  CAN_PLAY: 'canplay',\n  /**\n   * Fires when the browser can play through the audio/video without stopping for buffering\n   */\n  CAN_PLAY_THROUGH: 'canplaythrough',\n  /**\n   * Fires when the duration of the audio/video is changed\n   */\n  DURATION_CHANGE: 'durationchange',\n  /**\n   * Fires when the current playlist is empty\n   */\n  EMPTIED: 'emptied',\n  /**\n   * Fires when the current playlist is ended\n   */\n  ENDED: 'ended',\n  /**\n   * Fires when an error occurred during the loading of an audio/video\n   */\n  ERROR: 'error',\n  /**\n   * Fires when the browser has loaded the current frame of the audio/video\n   */\n  LOADED_DATA: 'loadeddata',\n  /**\n   * Fires when the browser has loaded meta data for the audio/video\n   */\n  LOADED_METADATA: 'loadedmetadata',\n  /**\n   * Fires when the browser starts looking for the audio/video\n   */\n  LOAD_START: 'loadstart',\n  /**\n   * Fires when the audio/video has been paused\n   */\n  PAUSE: 'pause',\n  /**\n   * Fires when the audio/video has been started or is no longer paused\n   */\n  PLAY: 'play',\n  /**\n   * Fires when the audio/video is playing after having been paused or stopped for buffering\n   */\n  PLAYING: 'playing',\n  /**\n   * Fires when the browser is downloading the audio/video\n   */\n  PROGRESS: 'progress',\n  /**\n   * Fires when the playing speed of the audio/video is changed\n   */\n  RATE_CHANGE: 'ratechange',\n  /**\n   * Fires when the user is finished moving/skipping to a new position in the audio/video\n   */\n  SEEKED: 'seeked',\n  /**\n   * Fires when the user starts moving/skipping to a new position in the audio/video\n   */\n  SEEKING: 'seeking',\n  /**\n   * Fires when the browser is trying to get media data, but data is not available\n   */\n  STALLED: 'stalled',\n  /**\n   * Fires when the browser is intentionally not getting media data\n   */\n  SUSPEND: 'suspend',\n  /**\n   * Fires when the current playback position has changed\n   */\n  TIME_UPDATE: 'timeupdate',\n  /**\n   * Fires when the volume has been changed\n   */\n  VOLUME_CHANGE: 'volumechange',\n  /**\n   * Fires when the video stops because it needs to buffer the next frame\n   */\n  WAITING: 'waiting',\n};\n\nconst CUSTOM_EVENTS: { [event: string]: string } = {\n  /**\n   * Fires when the active video track has been changed\n   */\n  VIDEO_TRACK_CHANGED: 'videotrackchanged',\n  /**\n   * Fires when the active audio track has been changed\n   */\n  AUDIO_TRACK_CHANGED: 'audiotrackchanged',\n  /**\n   * Fires when the active text track has been changed\n   */\n  TEXT_TRACK_CHANGED: 'texttrackchanged',\n  /**\n   * Fires when the player tracks have been changed\n   */\n  TRACKS_CHANGED: 'trackschanged',\n  /**\n   * Fires when the player state has been changed\n   */\n  PLAYER_STATE_CHANGED: 'playerstatechanged',\n  /**\n   * Fires on the first play\n   */\n  FIRST_PLAY: 'firstplay',\n  /**\n   * Fires when the player has selected the source to play\n   */\n  SOURCE_SELECTED: 'sourceselected'\n};\n\nconst PLAYER_EVENTS: { [event: string]: string } = merge([HTML5_EVENTS, CUSTOM_EVENTS]);\n\nexport {PLAYER_EVENTS, HTML5_EVENTS, CUSTOM_EVENTS};\n\n\n\n// WEBPACK FOOTER //\n// ./event/events.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/event/events.js","//@flow\nimport EventManager from './event/event-manager'\nimport FakeEvent from './event/fake-event'\nimport FakeEventTarget from './event/fake-event-target'\nimport {PLAYER_EVENTS as PlayerEvents, HTML5_EVENTS as Html5Events, CUSTOM_EVENTS as CustomEvents} from './event/events'\nimport PlayerStates from './state/state-types'\nimport {isNumber, isFloat, mergeDeep, copyDeep, id, isEmptyObject} from './utils/util'\nimport LoggerFactory from './utils/logger'\nimport Html5 from './engines/html5/html5'\nimport PluginManager from './plugin/plugin-manager'\nimport StateManager from './state/state-manager'\nimport TrackTypes from './track/track-types'\nimport Track from './track/track'\nimport VideoTrack from './track/video-track'\nimport AudioTrack from './track/audio-track'\nimport TextTrack from './track/text-track'\nimport DefaultPlayerConfig from './player-config.json'\nimport './assets/style.css'\n\n/**\n * The player container class name.\n * @type {string}\n * @const\n */\nconst CONTAINER_CLASS_NAME: string = 'playkit-container';\n\n/**\n * The HTML5 player class.\n * @classdesc\n */\nexport default class Player extends FakeEventTarget {\n  /**\n   * The player class logger.\n   * @type {any}\n   * @static\n   * @private\n   */\n  static _logger: any = LoggerFactory.getLogger('Player');\n  /**\n   * The available engines of the player.\n   * @type {Array<typeof IEngine>}\n   * @private\n   * @static\n   */\n  static _engines: Array<typeof IEngine> = [Html5];\n  /**\n   * The plugin manager of the player.\n   * @type {PluginManager}\n   * @private\n   */\n  _pluginManager: PluginManager;\n  /**\n   * The event manager of the player.\n   * @type {EventManager}\n   * @private\n   */\n  _eventManager: EventManager;\n  /**\n   * The runtime configuration of the player.\n   * @type {Object}\n   * @private\n   */\n  _config: Object;\n  /**\n   * The playback engine.\n   * @type {IEngine}\n   * @private\n   */\n  _engine: IEngine;\n  /**\n   * The state manager of the player.\n   * @type {StateManager}\n   * @private\n   */\n  _stateManager: StateManager;\n  /**\n   * The tracks of the player.\n   * @type {Array<Track>}\n   * @private\n   */\n  _tracks: Array<Track>;\n  /**\n   * The player ready promise\n   * @type {Promise<*>}\n   * @private\n   */\n  _readyPromise: ?Promise<*>;\n  /**\n   * Whether the play is the first or not\n   * @type {boolean}\n   * @private\n   */\n  _firstPlay: boolean;\n  /**\n   * The player DOM element container.\n   * @type {HTMLElement}\n   * @private\n   */\n  _el: HTMLElement;\n\n  /**\n   * @param {string} targetId - The target div id to append the player.\n   * @param {Object} config - The configuration for the player instance.\n   * @constructor\n   */\n  constructor(targetId: string, config: Object) {\n    super();\n    this._tracks = [];\n    this._config = {};\n    this._firstPlay = true;\n    this._stateManager = new StateManager(this);\n    this._pluginManager = new PluginManager();\n    this._eventManager = new EventManager();\n    this._createReadyPromise();\n    this._appendPlayerContainer(targetId);\n    this.configure(config);\n  }\n\n  /**\n   * Configures the player according to given configuration.\n   * @param {Object} config - The configuration for the player instance.\n   * @returns {void}\n   */\n  configure(config: Object): void {\n    // Destroy current engine (if exists) on new sources\n    if (this._engine && config.sources) {\n      this._reset();\n    }\n    // Merge new config\n    this._config = mergeDeep(isEmptyObject(this._config) ? Player._defaultConfig : this._config, config);\n    // Create engine\n    if (this._selectEngine()) {\n      this._appendEngineEl();\n      this._attachMedia();\n      this._loadPlugins();\n      this._handlePlaybackConfig();\n    }\n  }\n\n  /**\n   * Reset the necessary components before change media.\n   * @private\n   * @returns {void}\n   */\n  _reset(): void {\n    if (this._engine) {\n      this._engine.destroy();\n    }\n    this._config = {};\n    this._tracks = [];\n    this._firstPlay = true;\n    this._eventManager.removeAll();\n    this._createReadyPromise();\n  }\n\n  /**\n   * Creates the ready promise.\n   * @private\n   * @returns {void}\n   */\n  _createReadyPromise(): void {\n    this._readyPromise = new Promise((resolve, reject) => {\n      this._eventManager.listen(this, CustomEvents.TRACKS_CHANGED, () => {\n        resolve();\n      });\n      this._eventManager.listen(this, Html5Events.ERROR, reject);\n    });\n  }\n\n  /**\n   * Destroys the player.\n   * @returns {void}\n   * @public\n   */\n  destroy(): void {\n    if (this._engine) {\n      this._engine.destroy();\n    }\n    this._eventManager.destroy();\n    this._pluginManager.destroy();\n    this._stateManager.destroy();\n    this._config = {};\n    this._tracks = [];\n    this._readyPromise = null;\n    this._firstPlay = true;\n  }\n\n  /**\n   * @returns {Object} - The default configuration of the player.\n   * @private\n   * @static\n   */\n  static get _defaultConfig(): Object {\n    return copyDeep(DefaultPlayerConfig);\n  }\n\n  /**\n   * Loads the configured plugins.\n   * @private\n   * @returns {void}\n   */\n  _loadPlugins(): void {\n    let plugins = this._config.plugins;\n    for (let name in plugins) {\n      this._pluginManager.load(name, this, plugins[name]);\n    }\n  }\n\n  /**\n   * Selects the engine to create based on a given configuration.\n   * @private\n   * @returns {boolean} - Whether a proper engine was found.\n   */\n  _selectEngine(): boolean {\n    if (this._config.sources && this._config.playback && this._config.playback.streamPriority) {\n      return this._selectEngineByPriority();\n    }\n    return false;\n  }\n\n  /**\n   * Selects an engine to play a source according to a given stream priority.\n   * @return {boolean} - Whether a proper engine was found to play the given sources\n   * according to the priority.\n   * @private\n   */\n  _selectEngineByPriority(): boolean {\n    let streamPriority = this._config.playback.streamPriority;\n    let sources = this._config.sources;\n    for (let priority of streamPriority) {\n      let engineId = (typeof priority.engine === 'string') ? priority.engine.toLowerCase() : '';\n      let format = (typeof priority.format === 'string') ? priority.format.toLowerCase() : '';\n      let engine = Player._engines.find((engine) => engine.id === engineId);\n      if (engine) {\n        let formatSources = sources[format];\n        if (formatSources && formatSources.length > 0) {\n          let source = formatSources[0];\n          if (engine.canPlayType(source.mimetype)) {\n            this._loadEngine(engine, source);\n            return true;\n          }\n        }\n      }\n    }\n    Player._logger.warn(\"No playable engines was found to play the given sources\");\n    return false;\n  }\n\n  /**\n   * Loads the selected engine.\n   * @param {IEngine} engine - The selected engine.\n   * @param {Source} source - The selected source object.\n   * @private\n   * @returns {void}\n   */\n  _loadEngine(engine: typeof IEngine, source: Source): void {\n    this.dispatchEvent(new FakeEvent(CustomEvents.SOURCE_SELECTED, {selectedSource: source}));\n    this._engine = engine.createEngine(source, this._config);\n  }\n\n  /**\n   * Listen to all HTML5 defined events and trigger them on the player\n   * @private\n   * @returns {void}\n   */\n  _attachMedia(): void {\n    if (this._engine) {\n      for (let playerEvent in Html5Events) {\n        this._eventManager.listen(this._engine, Html5Events[playerEvent], (event: FakeEvent) => {\n          return this.dispatchEvent(event);\n        });\n      }\n      this._eventManager.listen(this._engine, CustomEvents.VIDEO_TRACK_CHANGED, (event: FakeEvent) => {\n        this._markActiveTrack(event.payload.selectedVideoTrack);\n        return this.dispatchEvent(event);\n      });\n      this._eventManager.listen(this._engine, CustomEvents.AUDIO_TRACK_CHANGED, (event: FakeEvent) => {\n        this._markActiveTrack(event.payload.selectedAudioTrack);\n        return this.dispatchEvent(event);\n      });\n      this._eventManager.listen(this._engine, CustomEvents.TEXT_TRACK_CHANGED, (event: FakeEvent) => {\n        this._markActiveTrack(event.payload.selectedTextTrack);\n        return this.dispatchEvent(event);\n      });\n      this._eventManager.listen(this, Html5Events.PLAY, this._onPlay.bind(this));\n    }\n  }\n\n  _handlePlaybackConfig(): void {\n    if (this._config.playback) {\n      if (this._config.playback.muted) {\n        this.muted = true;\n      }\n      if (this._config.playback.preload === \"auto\") {\n        this.load();\n      }\n      if (this._config.playback.autoplay) {\n        this.play();\n      }\n    }\n  }\n\n  /**\n   * Creates the player container\n   * @param {string} targetId - The target div id to append the player.\n   * @private\n   * @returns {void}\n   */\n  _appendPlayerContainer(targetId: string): void {\n    if (targetId) {\n      if (this._el === undefined) {\n        this._createPlayerContainer();\n        let parentNode = document.getElementById(targetId);\n        if ((parentNode != null) && (this._el != null)) {\n          parentNode.appendChild(this._el);\n        }\n      }\n    } else {\n      throw new Error(\"targetId is not found, it must be pass on initialization\");\n    }\n  }\n\n  /**\n   * Creates the player container.\n   * @private\n   * @returns {void}\n   */\n  _createPlayerContainer(): void {\n    this._el = document.createElement(\"div\");\n    this._el.id = id(5);\n    this._el.className = CONTAINER_CLASS_NAME;\n    this._el.setAttribute('tabindex', '-1');\n  }\n\n  /**\n   * Appends the engine's video element to the player's div container.\n   * @private\n   * @returns {void}\n   */\n  _appendEngineEl(): void {\n    if ((this._el != null) && (this._engine != null)) {\n      this._el.appendChild(this._engine.getVideoElement())\n    }\n  }\n\n  /**\n   * Returns the tracks according to the filter. if no filter given returns the all tracks.\n   * @function getTracks\n   * @param {string} [type] - a tracks filter, should be 'video', 'audio' or 'text'.\n   * @returns {Array<Track>} - The parsed tracks.\n   * @public\n   */\n  getTracks(type?: string): Array<Track> {\n    return this._getTracksByType(type);\n  }\n\n  /**\n   * Returns the tracks according to the filter. if no filter given returns the all tracks.\n   * @function _getTracksByType\n   * @param {string} [type] - a tracks filter, should be 'video', 'audio' or 'text'.\n   * @returns {Array<Track>} - The parsed tracks.\n   * @private\n   */\n  _getTracksByType(type?: string): Array<Track> {\n    return !type ? this._tracks : this._tracks.filter((track: Track) => {\n      if (type === TrackTypes.VIDEO) {\n        return track instanceof VideoTrack;\n      } else if (type === TrackTypes.AUDIO) {\n        return track instanceof AudioTrack;\n      } else if (type === TrackTypes.TEXT) {\n        return track instanceof TextTrack;\n      } else {\n        return true;\n      }\n    });\n  }\n\n  /**\n   * Select a track\n   * @function selectTrack\n   * @param {Track} track - the track to select\n   * @returns {void}\n   * @public\n   */\n  selectTrack(track: Track): void {\n    if (this._engine) {\n      if (track instanceof VideoTrack) {\n        this._engine.selectVideoTrack(track);\n      } else if (track instanceof AudioTrack) {\n        this._engine.selectAudioTrack(track);\n      } else if (track instanceof TextTrack) {\n        this._engine.selectTextTrack(track);\n      }\n    }\n  }\n\n  /**\n   * Hide the text track\n   * @function hideTextTrack\n   * @returns {void}\n   * @public\n   */\n  hideTextTrack(): void {\n    if (this._engine) {\n      this._engine.hideTextTrack();\n      this._getTracksByType(TrackTypes.TEXT).map(track => track.active = false);\n    }\n  }\n\n  /**\n   * Enables adaptive bitrate switching.\n   * @function enableAdaptiveBitrate\n   * @returns {void}\n   * @public\n   */\n  enableAdaptiveBitrate(): void {\n    if (this._engine) {\n      this._engine.enableAdaptiveBitrate();\n    }\n  }\n\n  /**\n   * Mark the selected track as active\n   * @function _markActiveTrack\n   * @param {Track} track - the track to mark\n   * @returns {void}\n   * @private\n   */\n  _markActiveTrack(track: Track) {\n    let type;\n    if (track instanceof VideoTrack) {\n      type = TrackTypes.VIDEO;\n    } else if (track instanceof AudioTrack) {\n      type = TrackTypes.AUDIO;\n    } else if (track instanceof TextTrack) {\n      type = TrackTypes.TEXT;\n    }\n    if (type) {\n      let tracks = this.getTracks(type);\n      for (let i = 0; i < tracks.length; i++) {\n        tracks[i].active = track.index === i;\n      }\n    }\n  }\n\n  /**\n   * @function _onPlay\n   * @return {void}\n   * @private\n   */\n  _onPlay(): void {\n    if (this._firstPlay) {\n      this._firstPlay = false;\n      this.dispatchEvent(new FakeEvent(CustomEvents.FIRST_PLAY));\n    }\n  }\n\n  /**\n   * Get the player config.\n   * @returns {Object} - The player configuration.\n   * @public\n   */\n  get config(): Object {\n    return this._config;\n  }\n\n  /**\n   * Set player session id\n   * @param {string} sessionId - the player session id to set\n   * @returns {void}\n   * @public\n   */\n  set sessionId(sessionId: string): void {\n    this._config.session = this._config.session || {};\n    this._config.session.id = sessionId;\n  }\n\n  //  <editor-fold desc=\"Playback Interface\">\n  /**\n   * The player readiness\n   * @public\n   * @returns {Promise<*>} - The ready promise\n   */\n  ready(): Promise<*> {\n    return this._readyPromise ? this._readyPromise : Promise.resolve();\n  }\n\n  /**\n   * Load media\n   * @public\n   * @returns {void}\n   */\n  load(): void {\n    if (this._engine) {\n      this._engine.load().then((data) => {\n        this._tracks = data.tracks;\n        this.dispatchEvent(new FakeEvent(CustomEvents.TRACKS_CHANGED, {tracks: this._tracks}));\n      }).catch((error) => {\n        this.dispatchEvent(new FakeEvent(Html5Events.ERROR, error));\n      });\n    }\n  }\n\n  /**\n   * Start/resume playback.\n   * @returns {void}\n   * @public\n   */\n  play(): void {\n    if (this._engine) {\n      if (this._engine.src) {\n        this._engine.play();\n      } else {\n        this.load();\n        this.ready().then(() => {\n          this._engine.play();\n        });\n      }\n    }\n  }\n\n  /**\n   * Pause playback.\n   * @returns {void}\n   * @public\n   */\n  pause(): void {\n    if (this._engine) {\n      return this._engine.pause();\n    }\n  }\n\n  /**\n   * Set the current time in seconds.\n   * @param {Number} to - The number to set in seconds.\n   * @public\n   */\n  set currentTime(to: number): void {\n    if (this._engine) {\n      if (isNumber(to)) {\n        let boundedTo = to;\n        if (to < 0) {\n          boundedTo = 0;\n        }\n        if (boundedTo > this._engine.duration) {\n          boundedTo = this._engine.duration;\n        }\n        this._engine.currentTime = boundedTo;\n      }\n    }\n  }\n\n  /**\n   * Get the current time in seconds.\n   * @returns {?Number} - The playback current time.\n   * @public\n   */\n  get currentTime(): ?number {\n    if (this._engine) {\n      return this._engine.currentTime;\n    }\n  }\n\n  /**\n   * Get the duration in seconds.\n   * @returns {?Number} - The playback duration.\n   * @public\n   */\n  get duration(): ?number {\n    if (this._engine) {\n      return this._engine.duration;\n    }\n  }\n\n  /**\n   * Set playback volume.\n   * @param {Number} vol - The volume to set.\n   * @returns {void}\n   * @public\n   */\n  set volume(vol: number): void {\n    if (this._engine) {\n      if (isFloat(vol)) {\n        let boundedVol = vol;\n        if (boundedVol < 0) {\n          boundedVol = 0;\n        }\n        if (boundedVol > 1) {\n          boundedVol = 1;\n        }\n        this._engine.volume = boundedVol;\n      }\n    }\n  }\n\n  /**\n   * Get playback volume.\n   * @returns {?Number} - The playback volume.\n   * @public\n   */\n  get volume(): ?number {\n    if (this._engine) {\n      return this._engine.volume;\n    }\n  }\n\n  // </editor-fold>\n\n  // <editor-fold desc=\"State\">\n  /**\n   * Get paused state.\n   * @returns {?boolean} - Whether the video is paused or not.\n   * @public\n   */\n  get paused(): ?boolean {\n    if (this._engine) {\n      return this._engine.paused;\n    }\n  }\n\n  /**\n   * Get seeking state.\n   * @returns {?boolean} - Whether the video is seeking or not.\n   * @public\n   */\n  get seeking(): ?boolean {\n    if (this._engine) {\n      return this._engine.seeking;\n    }\n  }\n\n  buffered() {\n  }\n\n  /**\n   * Set player muted state.\n   * @param {boolean} mute - The mute value.\n   * @returns {void}\n   * @public\n   */\n  set muted(mute: boolean): void {\n    if (this._engine) {\n      this._engine.muted = mute;\n    }\n  }\n\n  /**\n   * Get player muted state.\n   * @returns {?boolean} - Whether the video is muted or not.\n   * @public\n   */\n  get muted(): ?boolean {\n    if (this._engine) {\n      return this._engine.muted;\n    }\n  }\n\n  /**\n   * Get the player source.\n   * @returns {?string} - The current source of the player.\n   * @public\n   */\n  get src(): ?string {\n    if (this._engine) {\n      return this._engine.src;\n    }\n  }\n\n  /**\n   * Get the player events.\n   * @returns {Object} - The events of the player.\n   * @public\n   */\n  get Event(): { [event: string]: string } {\n    return PlayerEvents;\n  }\n\n  /**\n   * Get the player states.\n   * @returns {Object} - The states of the player.\n   * @public\n   */\n  get State(): { [state: string]: string } {\n    return PlayerStates;\n  }\n\n  /**\n   * Get the player tracks types.\n   * @returns {Object} - The tracks types of the player.\n   * @public\n   */\n  get Track(): { [track: string]: string } {\n    return TrackTypes;\n  }\n\n// </editor-fold>\n}\n\n\n\n// WEBPACK FOOTER //\n// ./player.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/player.js","//@flow\n\"use strict\";\n\n/**\n * @param {number} n - A certain number\n * @returns {boolean} - If the input is a number\n */\nfunction isNumber(n: number): boolean {\n  return Number(n) === n;\n}\n\n/**\n * @param {number} n - A certain number\n * @returns {boolean} - If the input is an integer\n */\nfunction isInt(n: number): boolean {\n  return isNumber(n) && n % 1 === 0;\n}\n\n/**\n * @param {number} n - A certain number\n * @returns {boolean} - If the input is a float\n */\nfunction isFloat(n: number): boolean {\n  return isNumber(n) && n % 1 !== 0;\n}\n\n/**\n * @param {Array<Object>} objects - The objects to merge\n * @returns {Object} - The merged object.\n */\nfunction merge(objects: Array<Object>): Object {\n  let target = {};\n  for (let obj of objects) {\n    Object.assign(target, obj);\n  }\n  return target;\n}\n\n/**\n * @param {any} item - The item to check.\n * @returns {boolean} - Whether the item is an object.\n */\nfunction isObject(item: any) {\n  return (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n/**\n * @param {any} target - The target object.\n * @param {any} sources - The objects to merge.\n * @returns {Object} - The merged object.\n */\nfunction mergeDeep(target: any, ...sources: any): Object {\n  if (!sources.length) {\n    return target;\n  }\n  const source = sources.shift();\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) Object.assign(target, {[key]: {}});\n        mergeDeep(target[key], source[key]);\n      } else {\n        Object.assign(target, {[key]: source[key]});\n      }\n    }\n  }\n  return mergeDeep(target, ...sources);\n}\n\n/**\n * @param {any} data - The data to copy.\n * @returns {any} - The copied data.\n */\nfunction copyDeep(data: any): any {\n  let node;\n  if (Array.isArray(data)) {\n    node = data.length > 0 ? data.slice(0) : [];\n    node.forEach((e, i) => {\n      if (\n        (typeof e === \"object\" && e !== {}) ||\n        (Array.isArray(e) && e.length > 0)\n      ) {\n        node[i] = copyDeep(e);\n      }\n    });\n  } else if (typeof data === \"object\") {\n    node = Object.assign({}, data);\n    Object.keys(node).forEach((key) => {\n      if (\n        (typeof node[key] === \"object\" && node[key] !== {}) ||\n        (Array.isArray(node[key]) && node[key].length > 0)\n      ) {\n        node[key] = copyDeep(node[key]);\n      }\n    });\n  } else {\n    node = data;\n  }\n  return node;\n}\n\n/**\n * Generates unique id.\n * @param {number} length - The length of the id.\n * @returns {string} - The generated id.\n */\nfunction id(length: ?number) {\n  let from = 2;\n  let to = from + (length ? length - 2 : 0);\n  return '_' + Math.random().toString(36).substr(from, to);\n}\n\n/**\n * Checks if an object is an empy object.\n * @param {Object} obj - The object to check\n * @returns {boolean} - Whether the object is empty.\n */\nfunction isEmptyObject(obj: Object): boolean {\n  for (let key in obj) {\n    if (obj.hasOwnProperty(key))\n      return false;\n  }\n  return true;\n}\n\nexport {isNumber, isInt, isFloat, isObject, merge, mergeDeep, copyDeep, id, isEmptyObject};\n\n\n\n// WEBPACK FOOTER //\n// ./utils/util.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/utils/util.js","//@flow\nimport FakeEvent from './fake-event'\nimport MultiMap from '../utils/multi-map'\n\n/**\n * A work-alike for EventTarget.  Only DOM elements may be true EventTargets,\n * but this can be used as a base class to provide event dispatch to non-DOM\n * classes.  Only FakeEvents should be dispatched.\n *\n * @struct\n * @constructor\n * @implements {EventTarget}\n * @export\n */\nclass FakeEventTarget {\n  _listeners: MultiMap<ListenerType>;\n  dispatchTarget: FakeEventTarget;\n\n  constructor() {\n    /**\n     * @private {!MultiMap.<FakeEventTarget.ListenerType>}\n     */\n    this._listeners = new MultiMap();\n\n    /**\n     * The target of all dispatched events.  Defaults to |this|.\n     * @type {EventTarget}\n     */\n    this.dispatchTarget = this;\n  }\n\n  /**\n   * Add an event listener to this object.\n   *\n   * @param {string} type The event type to listen for.\n   * @param {FakeEventTarget.ListenerType} listener The callback or\n   *   listener object to invoke.\n   * @param {boolean=} opt_capturing Ignored.  FakeEventTargets do not have\n   *   parents, so events neither capture nor bubble.\n   * @override\n   * @export\n   */\n  addEventListener(type: string, listener: ListenerType) {\n    this._listeners.push(type, listener);\n  }\n\n  /**\n   * Remove an event listener from this object.\n   *\n   * @param {string} type The event type for which you wish to remove a listener.\n   * @param {FakeEventTarget.ListenerType} listener The callback or\n   *   listener object to remove.\n   * @param {boolean=} opt_capturing Ignored.  FakeEventTargets do not have\n   *   parents, so events neither capture nor bubble.\n   * @override\n   * @export\n   */\n  removeEventListener(type: string, listener: ListenerType) {\n    this._listeners.remove(type, listener);\n  }\n\n  /**\n   * Dispatch an event from this object.\n   *\n   * @param {!Event} event The event to be dispatched from this object.\n   * @return {boolean} True if the default action was prevented.\n   * @override\n   * @export\n   */\n  dispatchEvent(event: FakeEvent) {\n    // In many browsers, it is complex to overwrite properties of actual Events.\n    // Here we expect only to dispatch FakeEvents, which are simpler.\n    //goog.asserts.assert(event instanceof FakeEvent,\n    //    'FakeEventTarget can only dispatch FakeEvents!');\n\n    let list = this._listeners.get(event.type) || [];\n\n    for (let i = 0; i < list.length; ++i) {\n      // Do this every time, since events can be re-dispatched from handlers.\n      event.target = this.dispatchTarget;\n      event.currentTarget = this.dispatchTarget;\n\n      let listener = list[i];\n      try {\n        if (listener.handleEvent) {\n          listener.handleEvent(event);\n        } else {\n          listener.call(this, event);\n        }\n      } catch (exception) {\n        // Exceptions during event handlers should not affect the caller,\n        // but should appear on the console as uncaught, according to MDN:\n        // http://goo.gl/N6Ff27\n        // TODO: add log\n      }\n\n      if (event.stopped) {\n        break;\n      }\n    }\n\n    return event.defaultPrevented;\n  }\n}\n\n/**\n * These are the listener types defined in the closure extern for EventTarget.\n * @typedef {EventListener|function(!Event):(boolean|undefined)}\n */\ndeclare function ListenerType(event: FakeEvent): (boolean | void);\n\nexport default FakeEventTarget;\n\n\n\n// WEBPACK FOOTER //\n// ./event/fake-event-target.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/event/fake-event-target.js","//@flow\nexport default class PlayerError {\n  static TYPE: {[name: string]: Object} = {\n    NOT_REGISTERED_PLUGIN: {\n      name: \"PluginNotRegisteredException\",\n      message: function (name) {\n        return `Cannot load ${name} plugin. Name not found in the registry`;\n      }\n    },\n    NOT_VALID_HANDLER: {\n      name: \"PluginHandlerIsNotValidException\",\n      message: function () {\n        return \"To activate plugin you must provide a class derived from BasePlugin\";\n      }\n    },\n    NOT_IMPLEMENTED_METHOD: {\n      name: \"NotImplementedException\",\n      message: function (method) {\n        return `${method} method not implemented`;\n      }\n    }\n  };\n\n  name: string;\n  message: string;\n\n  constructor(error: Object, param?: any) {\n    this.name = error.name;\n    this.message = error.message(param);\n  }\n\n  getError() {\n    return {\n      name: this.name,\n      message: this.message\n    };\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./utils/player-error.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/utils/player-error.js","//@flow\n/* eslint-disable no-unused-vars */\nimport FakeEvent from '../../../event/fake-event'\nimport FakeEventTarget from '../../../event/fake-event-target'\nimport PlayerError from '../../../utils/player-error'\nimport {CUSTOM_EVENTS} from '../../../event/events'\nimport LoggerFactory from '../../../utils/logger'\nimport Track from '../../../track/track'\nimport VideoTrack from '../../../track/video-track'\nimport AudioTrack from '../../../track/audio-track'\nimport TextTrack from '../../../track/text-track'\n\nexport default class BaseMediaSourceAdapter extends FakeEventTarget implements IMediaSourceAdapter {\n  /**\n   * Passing the custom events to the actual media source adapter.\n   * @static\n   */\n  static CustomEvents: { [event: string]: string } = CUSTOM_EVENTS;\n\n  /**\n   * Passing the getLogger function to the actual media source adapter.\n   * @type {Function}\n   * @static\n   */\n  static getLogger: Function = LoggerFactory.getLogger;\n\n  /**\n   * The adapter config.\n   * @member {Object} _config\n   * @private\n   */\n  _config: ?Object;\n\n  /**\n   * The source object.\n   * @member {Source} _sourceObj\n   * @private\n   */\n  _sourceObj: ?Source;\n\n  /**\n   * The dom video element.\n   * @member {HTMLVideoElement} _videoElement\n   * @private\n   */\n  _videoElement: HTMLVideoElement;\n\n  /**\n   * Checks if the media source adapter is supported.\n   * @function isSupported\n   * @returns {boolean} - Whether the media source adapter is supported.\n   * @static\n   */\n  static isSupported(): boolean {\n    return true;\n  }\n\n  /**\n   * Factory method to create media source adapter.\n   * @function createAdapter\n   * @param {HTMLVideoElement} videoElement - The video element that the media source adapter work with.\n   * @param {Object} source - The source Object.\n   * @param {Object} config - The media source adapter configuration.\n   * @returns {IMediaSourceAdapter} - New instance of the run time media source adapter.\n   * @static\n   */\n  static createAdapter(videoElement: HTMLVideoElement, source: Source, config: Object): IMediaSourceAdapter {\n    return new this(videoElement, source, config);\n  }\n\n  /**\n   * @constructor\n   * @param {HTMLVideoElement} videoElement - The video element which bind to media source adapter.\n   * @param {Source} source - The source object.\n   * @param {Object} config - The media source adapter configuration.\n   */\n  constructor(videoElement: HTMLVideoElement, source: Source, config: Object) {\n    super();\n    this._videoElement = videoElement;\n    this._sourceObj = source;\n    this._config = config;\n  }\n\n  /**\n   * Destroys the media source adapter.\n   * @function destroy\n   * @returns {void}\n   */\n  destroy(): void {\n    this._sourceObj = null;\n    this._config = null;\n  }\n\n  /**\n   * Triggers the appropriate track changed event.\n   * @param {Track} track - The selected track.\n   * @private\n   * @returns {void}\n   */\n  _onTrackChanged(track: Track): void {\n    if (track instanceof VideoTrack) {\n      this._trigger(BaseMediaSourceAdapter.CustomEvents.VIDEO_TRACK_CHANGED, {selectedVideoTrack: track});\n    } else if (track instanceof AudioTrack) {\n      this._trigger(BaseMediaSourceAdapter.CustomEvents.AUDIO_TRACK_CHANGED, {selectedAudioTrack: track});\n    } else if (track instanceof TextTrack) {\n      this._trigger(BaseMediaSourceAdapter.CustomEvents.TEXT_TRACK_CHANGED, {selectedTextTrack: track});\n    }\n  }\n\n  /**\n   * Dispatch an adapter event forward.\n   * @param {string} name - The name of the event.\n   * @param {Object} payload - The event payload.\n   * @returns {void}\n   */\n  _trigger(name: string, payload: Object): void {\n    this.dispatchEvent(new FakeEvent(name, payload));\n  }\n\n  /** Must implemented methods by the derived media source adapter **/\n\n  static canPlayType(mimeType: string): boolean {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'static canPlayType').getError();\n  }\n\n  load(): Promise<Object> {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'load').getError();\n  }\n\n  selectVideoTrack(videoTrack: VideoTrack): void {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'selectVideoTrack').getError();\n  }\n\n  selectAudioTrack(audioTrack: AudioTrack): void {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'selectAudioTrack').getError();\n  }\n\n  selectTextTrack(textTrack: TextTrack): void {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'selectTextTrack').getError();\n  }\n\n  hideTextTrack(): void {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'hideTextTrack').getError();\n  }\n\n  enableAdaptiveBitrate(): void {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'enableAdaptiveBitrate').getError();\n  }\n\n  get src(): string {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'get src').getError();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./engines/html5/media-source/base-media-source-adapter.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/engines/html5/media-source/base-media-source-adapter.js","//@flow\nimport NativeAdapter from './adapters/native-adapter'\nimport LoggerFactory from '../../../utils/logger'\n\n/**\n * Media source provider\n * @classdesc\n */\nexport default class MediaSourceProvider {\n  /**\n   * The logger of the media source provider.\n   * @member {any} _logger\n   * @static\n   * @private\n   */\n  static _logger: any = LoggerFactory.getLogger('MediaSourceProvider');\n  /**\n   * The media source adapter registry.\n   * @member {Array<IMediaSourceAdapter>} _mediaSourceAdapters\n   * @static\n   * @private\n   */\n  static _mediaSourceAdapters: Array<typeof IMediaSourceAdapter> = [NativeAdapter];\n  /**\n   * The selected adapter for playback.\n   * @type {null|IMediaSourceAdapter}\n   * @static\n   * @private\n   */\n  static _selectedAdapter: ?(typeof IMediaSourceAdapter) = null;\n\n  /**\n   * Add a media source adapter to the registry.\n   * @function register\n   * @param {IMediaSourceAdapter} mediaSourceAdapter - The media source adapter to register.\n   * @static\n   * @returns {void}\n   */\n  static register(mediaSourceAdapter: typeof IMediaSourceAdapter): void {\n    if (mediaSourceAdapter) {\n      if (!MediaSourceProvider._mediaSourceAdapters.includes(mediaSourceAdapter)) {\n        MediaSourceProvider._logger.debug(`Adapter <${mediaSourceAdapter.id}> has been registered successfully`);\n        MediaSourceProvider._mediaSourceAdapters.push(mediaSourceAdapter);\n      } else {\n        MediaSourceProvider._logger.debug(`Adapter <${mediaSourceAdapter.id}> is already registered, do not register again`);\n      }\n    }\n  }\n\n  /**\n   * Remove a media source adapter from the registry.\n   * @function unRegister\n   * @param {IMediaSourceAdapter} mediaSourceAdapter - The media source adapter to unRegister.\n   * @static\n   * @returns {void}\n   */\n  static unRegister(mediaSourceAdapter: typeof IMediaSourceAdapter): void {\n    let index = MediaSourceProvider._mediaSourceAdapters.indexOf(mediaSourceAdapter);\n    if (index > -1) {\n      MediaSourceProvider._logger.debug(`Unregistered <${mediaSourceAdapter.id}> adapter`);\n      MediaSourceProvider._mediaSourceAdapters.splice(index, 1);\n    }\n  }\n\n  /**\n   * Checks if one of the registered media source adapters can play a given mime type.\n   * @function canPlayType\n   * @param {string} mimeType - The mime type to check.\n   * @static\n   * @returns {boolean} - If one of the adapters can play the specific mime type.\n   */\n  static canPlayType(mimeType: string): boolean {\n    let mediaSourceAdapters = MediaSourceProvider._mediaSourceAdapters;\n    for (let i = 0; i < mediaSourceAdapters.length; i++) {\n      if (mediaSourceAdapters[i].canPlayType(mimeType)) {\n        MediaSourceProvider._selectedAdapter = mediaSourceAdapters[i];\n        MediaSourceProvider._logger.debug(`Selected adapter is <${MediaSourceProvider._selectedAdapter.id}>`);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Get the appropriate media source adapter to the video source.\n   * @function getMediaSourceAdapter\n   * @param {HTMLVideoElement} videoElement - The video element which requires adapter for a given mimeType.\n   * @param {Source} source - The selected source object.\n   * @param {Object} config - The player configuration.\n   * @returns {IMediaSourceAdapter|null} - The selected media source adapter, or null if such doesn't exists.\n   * @static\n   */\n  static getMediaSourceAdapter(videoElement: HTMLVideoElement, source: Source, config: Object): ?IMediaSourceAdapter {\n    if (videoElement && source && config) {\n      if (!MediaSourceProvider._selectedAdapter) {\n        MediaSourceProvider.canPlayType(source.mimetype);\n      }\n      return MediaSourceProvider._selectedAdapter ? MediaSourceProvider._selectedAdapter.createAdapter(videoElement, source, config) : null;\n    }\n    return null;\n  }\n\n  /**\n   * Destroys the media source adapter provider necessary props.\n   * @static\n   * @returns {void}\n   */\n  static destroy(): void {\n    MediaSourceProvider._selectedAdapter = null;\n  }\n}\n\nconst registerMediaSourceAdapter = MediaSourceProvider.register;\nexport {registerMediaSourceAdapter};\n\n\n\n\n// WEBPACK FOOTER //\n// ./engines/html5/media-source/media-source-provider.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/engines/html5/media-source/media-source-provider.js","//@flow\nimport Player from '../player'\nimport LoggerFactory from '../utils/logger'\nimport {merge} from '../utils/util'\nimport EventManager from '../event/event-manager'\nimport PlayerError from '../utils/player-error'\n\n/** The BasePlugin responsible to implement the plugin interface.\n * Contains several default implementations.\n * Other plugins should extend this class.\n * @classdesc\n */\nexport default class BasePlugin implements IPlugin {\n  /**\n   * The runtime configuration of the plugin.\n   * @member\n   */\n  config: Object;\n  /**\n   * The name of the plugin.\n   * @member\n   */\n  name: string;\n  /**\n   * The logger of the plugin.\n   * @member\n   */\n  logger: any;\n  /**\n   * Reference to the actual player.\n   * @member\n   */\n  player: Player;\n  /**\n   * The event manager of the plugin.\n   * @member\n   */\n  eventManager: EventManager;\n  /**\n   * The default configuration of the plugin.\n   * Inherited plugins should override this property.\n   * @type {Object}\n   * @static\n   * @member\n   */\n  static defaultConfig: Object = {};\n\n  /**\n   * Factory method to create the actual plugin.\n   * @param {string} name - The plugin name\n   * @param {Player} player - The player reference\n   * @param {Object} config - The plugin configuration\n   * @returns {BasePlugin} - New runtime plugin instance\n   * @static\n   * @public\n   */\n  static createPlugin(name: string, player: Player, config: Object = {}): BasePlugin {\n    return new this(name, player, config);\n  }\n\n  /**\n   * Returns under what conditions the plugin is valid.\n   * Plugin must implement this method.\n   * @returns {boolean} - Whether the plugin is valid and can be initiated. Default implementation is true\n   * @static\n   * @public\n   * @abstract\n   */\n  static isValid(): boolean {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'isValid()').getError();\n  }\n\n  /**\n   * constructor\n   * @param {string} name - The plugin name\n   * @param {Player} player - The player reference\n   * @param {Object} config - The plugin configuration\n   * @constructor\n   * @private\n   */\n  constructor(name: string, player: Player, config: Object) {\n    this.name = name;\n    this.player = player;\n    this.eventManager = new EventManager();\n    this.logger = LoggerFactory.getLogger(this.name);\n    this.config = merge([this.constructor.defaultConfig, config]);\n  }\n\n  /**\n   * Getter for the configuration of the plugin.\n   * @param {string} attr - The key in the plugin configuration (optional).\n   * @returns {*} - If attribute is provided, returns its value. Else, Returns the config of the plugin.\n   * @public\n   */\n  getConfig(attr?: string): any {\n    if (attr) {\n      return this.config[attr];\n    }\n    return this.config;\n  }\n\n  /**\n   * Updates the config of the plugin.\n   * @param {Object} update - The updated configuration.\n   * @public\n   * @returns {void}\n   */\n  updateConfig(update: Object): void {\n    this.config = merge([this.config, update]);\n  }\n\n  /**\n   * Runs the destroy logic of the plugin.\n   * plugin must implement this method.\n   * @public\n   * @abstract\n   * @returns {void}\n   */\n  destroy(): void {\n    throw new PlayerError(PlayerError.TYPE.NOT_IMPLEMENTED_METHOD, 'destroy()').getError();\n  }\n\n  /**\n   * Getter for the plugin's name.\n   * @returns {string} - The name of the plugin.\n   * @public\n   */\n  getName(): string {\n    return this.name;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./plugin/base-plugin.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/plugin/base-plugin.js","//@flow\nimport BasePlugin from './base-plugin'\nimport PlayerError from '../utils/player-error'\nimport Player from '../player'\nimport LoggerFactory from '../utils/logger'\n\n/**\n * The logger of the PluginManager class.\n * @private\n * @const\n */\nconst logger = LoggerFactory.getLogger(\"PluginManager\");\n\n/** The PluginManager responsible for register plugins definitions and store plugins instances.\n * @classdesc\n */\nexport default class PluginManager {\n  /**\n   * The registry of the plugins.\n   * Maps plugin's name to his class.\n   * @type {Map}\n   * @static\n   * @private\n   */\n  static _registry: Map<string, Function> = new Map();\n  /**\n   * The active plugins in the player.\n   * Maps plugin's name to his instance.\n   * @type {Map}\n   * @private\n   */\n  _plugins: Map<string, BasePlugin> = new Map();\n\n  /**\n   * Writes the plugin in the registry.\n   * Maps: plugin name -> plugin class.\n   * @param {string} name - The plugin name\n   * @param {Function} handler - The plugin class\n   * @returns {boolean} - If the registration request succeeded\n   * @static\n   * @public\n   */\n  static register(name: string, handler: Function): boolean {\n    if (typeof handler !== 'function' || handler.prototype instanceof BasePlugin === false) {\n      throw new PlayerError(PlayerError.TYPE.NOT_VALID_HANDLER).getError();\n    }\n    if (!PluginManager._registry.has(name)) {\n      PluginManager._registry.set(name, handler);\n      logger.debug(`Plugin <${name}> has been registered successfully`);\n      return true;\n    }\n    logger.debug(`Plugin <${name}> is already registered, do not register again`);\n    return false;\n  }\n\n  /**\n   * Removes the plugin from the registry.\n   * @param {string} name - The plugin name\n   * @static\n   * @public\n   * @returns {void}\n   */\n  static unRegister(name: string): void {\n    if (PluginManager._registry.has(name)) {\n      PluginManager._registry.delete(name);\n      logger.debug(`Unregistered <${name}> plugin.`);\n    }\n  }\n\n  /**\n   * Creates and store new instance of the plugin in case isValid() of the plugin returns true.\n   * @param {string} name - The plugin name\n   * @param {Player} player - The player reference\n   * @param {Object} [config={}] - The plugin configuration\n   * @returns {boolean} - Whether the plugin load was successful\n   * @public\n   */\n  load(name: string, player: Player, config: Object = {}): boolean {\n    if (!PluginManager._registry.has(name)) {\n      throw new PlayerError(PlayerError.TYPE.NOT_REGISTERED_PLUGIN, name).getError();\n    }\n    let pluginClass = PluginManager._registry.get(name);\n    if (pluginClass != null && pluginClass.isValid()) {\n      this._plugins.set(name, pluginClass.createPlugin(name, player, config));\n      logger.debug(`Plugin <${name}> has been loaded`);\n      return true;\n    }\n    logger.debug(`Plugin <${name}> isn\\'t loaded, isValid()=false`);\n    return false;\n  }\n\n  /**\n   * Iterates over all the plugins and calls private _destroy.\n   * @public\n   * @returns {void}\n   */\n  destroy(): void {\n    this._plugins.forEach(this._destroy.bind(this));\n  }\n\n  /**\n   * Calls destroy() method of the plugin's impl.\n   * @param {BasePlugin} plugin - The plugin instance\n   * @param {string} name - The plugin name\n   * @private\n   * @returns {void}\n   */\n  _destroy(plugin: BasePlugin, name: string): void {\n    plugin.destroy();\n    this._plugins.delete(name);\n  }\n\n  /**\n   * Returns the plugin's instance.\n   * @param {string} name - The plugin name\n   * @returns {BasePlugin} - The plugin instance\n   * @public\n   */\n  get(name: string): ?BasePlugin {\n    return this._plugins.get(name);\n  }\n}\n\n/**\n * Export the register method.\n * @type {function}\n * @constant\n */\nconst registerPlugin = PluginManager.register;\nexport {registerPlugin};\n\n\n\n// WEBPACK FOOTER //\n// ./plugin/plugin-manager.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/plugin/plugin-manager.js","//@flow\n\n/**\n * The possible player state types.\n * @const\n * @type {{IDLE: string, LOADING: string, PLAYING: string, PAUSED: string, BUFFERING: string}}\n */\nconst PLAYER_STATE_TYPES: { [state: string]: string } = {\n  IDLE: \"idle\",\n  LOADING: \"loading\",\n  PLAYING: \"playing\",\n  PAUSED: \"paused\",\n  BUFFERING: \"buffering\"\n};\n\nexport default PLAYER_STATE_TYPES;\n\n\n\n// WEBPACK FOOTER //\n// ./state/state-types.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/state/state-types.js","//@flow\n\n/**\n * A simple multimap template.\n * @constructor\n * @struct\n * @template T\n */\nclass MultiMap<T> {\n  _map: Map<string, T[]>;\n\n  constructor() {\n    /** @private {!Object.<string, !Array.<T>>} */\n    this._map = new Map();\n  }\n\n  /**\n   * Add a key, value pair to the map.\n   * @param {string} key -\n   * @param {T} value  -\n   * @returns {void}\n   */\n  push(key: string, value: T): void {\n    if (this._map.has(key)) {\n      let list = this._map.get(key);\n      if (Array.isArray(list)) {\n        list.push(value);\n        this._map.set(key, list);\n      }\n    } else {\n      this._map.set(key, [value]);\n    }\n  }\n\n  /**\n   * Set an array of values for the key, overwriting any previous data.\n   * @param {string} key -\n   * @param {!Array.<T>} values -\n   * @returns {void}\n   */\n  set(key: string, values: T[]): void {\n    this._map.set(key, values);\n  }\n\n  /**\n   * Check for a key.\n   * @param {string} key -\n   * @return {boolean} true if the key exists.\n   */\n  has(key: string): boolean {\n    return this._map.has(key);\n  }\n\n  /**\n   * Get a list of values by key.\n   * @param {string} key -\n   * @return {Array.<T>} or null if no suZch key exists.\n   */\n  get(key: string): Array<T> {\n    let list = this._map.get(key);\n    // slice() clones the list so that it and the map can each be modified\n    // without affecting the other.\n    return list ? list.slice() : [];\n  }\n\n  /**\n   * Get a list of all values.\n   * @returns {!Array.<T>} -\n   */\n  getAll(): T[] {\n    let list: T[] = [];\n    for (var value of this._map.values()) {\n      list = list.concat(value);\n    }\n    return list;\n  }\n\n  /**\n   * Remove a specific value, if it exists.\n   * @param {string} key -\n   * @param {T} value -\n   * @returns {void}\n   */\n  remove(key: string, value: T): void {\n    if (!this._map.has(key)) return;\n    let list = this._map.get(key);\n    if (Array.isArray(list)) {\n      for (let i = 0; i < list.length; ++i) {\n        if (list[i] == value) {\n          list.splice(i, 1);\n          --i;\n        }\n      }\n    }\n  }\n\n  /**\n   * Get all keys from the multimap.\n   * @return {!Array.<string>}\n   */\n  // eslint-disable-next-line no-undef\n  keys(): Iterator<string> {\n    return this._map.keys();\n  }\n\n\n  /**\n   * Clear all keys and values from the multimap.\n   * @returns {void}\n   */\n  clear(): void {\n    this._map.clear();\n  }\n}\n\nexport default MultiMap;\n\n\n\n// WEBPACK FOOTER //\n// ./utils/multi-map.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/utils/multi-map.js","module.exports = {\n\t\"name\": \"playkit-js\",\n\t\"version\": \"0.2.0\",\n\t\"main\": \"dist/playkit.js\",\n\t\"scripts\": {\n\t\t\"clean\": \"rm -rf ./dist\",\n\t\t\"prebuild\": \"npm run clean\",\n\t\t\"build:prod\": \"NODE_ENV=production webpack\",\n\t\t\"build\": \"webpack\",\n\t\t\"dev\": \"webpack --progress --colors --watch\",\n\t\t\"test\": \"NODE_ENV=test karma start --color\",\n\t\t\"test:chrome\": \"NODE_ENV=test karma start --color --browsers Chrome\",\n\t\t\"test:chrome:dots\": \"NODE_ENV=test karma start --color --browsers Chrome --reporters dots\",\n\t\t\"test:firefox\": \"NODE_ENV=test karma start --color --browsers Firefox\",\n\t\t\"test:safari\": \"NODE_ENV=test karma start --color --browsers Safari\",\n\t\t\"test:watch\": \"NODE_ENV=test karma start --color --auto-watch\",\n\t\t\"start\": \"webpack-dev-server\",\n\t\t\"release\": \"npm run build:prod && npm run commit:dist && standard-version\",\n\t\t\"publish\": \"git push --follow-tags --no-verify origin develop\",\n\t\t\"eslint\": \"eslint . --color\",\n\t\t\"flow\": \"flow check\",\n\t\t\"eslint:flow:test\": \"npm run eslint && npm run flow && npm run test\",\n\t\t\"commit:dist\": \"git add --all dist && (git commit -m 'chore: update dist' || exit 0)\",\n\t\t\"prepush-msg:build\": \"echo '\\nRunning build before push...\\n' && exit 0\",\n\t\t\"prepush-msg:dist\": \"echo '\\nAdding dist files to a seperate commit...\\n' && exit 0\",\n\t\t\"prepush-msg:done\": \"echo '\\nPre push tasks are done.\\n' && exit 0\"\n\t},\n\t\"pre-push\": [\n\t\t\"prepush-msg:build\",\n\t\t\"prebuild\",\n\t\t\"build\",\n\t\t\"build:prod\",\n\t\t\"prepush-msg:dist\",\n\t\t\"commit:dist\",\n\t\t\"prepush-msg:done\"\n\t],\n\t\"devDependencies\": {\n\t\t\"babel-cli\": \"^6.18.0\",\n\t\t\"babel-core\": \"^6.18.2\",\n\t\t\"babel-eslint\": \"^7.1.1\",\n\t\t\"babel-loader\": \"^6.2.7\",\n\t\t\"babel-plugin-istanbul\": \"^4.0.0\",\n\t\t\"babel-plugin-transform-class-properties\": \"^6.22.0\",\n\t\t\"babel-plugin-transform-flow-strip-types\": \"^6.22.0\",\n\t\t\"babel-preset-es2015\": \"^6.18.0\",\n\t\t\"babel-register\": \"^6.23.0\",\n\t\t\"chai\": \"^3.5.0\",\n\t\t\"cross-env\": \"^3.1.4\",\n\t\t\"css-loader\": \"^0.28.4\",\n\t\t\"eslint\": \"^3.10.0\",\n\t\t\"eslint-loader\": \"^1.6.1\",\n\t\t\"eslint-plugin-flowtype\": \"^2.30.0\",\n\t\t\"eslint-plugin-import\": \"^2.2.0\",\n\t\t\"eslint-plugin-mocha-no-only\": \"^0.0.5\",\n\t\t\"flow-bin\": \"latest\",\n\t\t\"istanbul\": \"^0.4.5\",\n\t\t\"karma\": \"^1.5.0\",\n\t\t\"karma-chai\": \"^0.1.0\",\n\t\t\"karma-chrome-launcher\": \"^2.0.0\",\n\t\t\"karma-cli\": \"^1.0.1\",\n\t\t\"karma-coverage\": \"^1.1.1\",\n\t\t\"karma-firefox-launcher\": \"^1.0.1\",\n\t\t\"karma-ie-launcher\": \"^1.0.0\",\n\t\t\"karma-mocha\": \"^1.3.0\",\n\t\t\"karma-safari-launcher\": \"^1.0.0\",\n\t\t\"karma-sourcemap-loader\": \"^0.3.7\",\n\t\t\"karma-webpack\": \"^2.0.2\",\n\t\t\"mocha\": \"^3.2.0\",\n\t\t\"mocha-cli\": \"^1.0.1\",\n\t\t\"pre-push\": \"^0.1.1\",\n\t\t\"sinon\": \"^2.0.0\",\n\t\t\"sinon-chai\": \"^2.8.0\",\n\t\t\"standard-version\": \"^4.0.0\",\n\t\t\"style-loader\": \"^0.18.2\",\n\t\t\"uglifyjs-webpack-plugin\": \"^0.4.3\",\n\t\t\"webpack\": \"latest\",\n\t\t\"webpack-dev-server\": \"latest\"\n\t},\n\t\"repository\": {\n\t\t\"type\": \"git\",\n\t\t\"url\": \"https://github.com/kaltura/playkit-js\"\n\t},\n\t\"keywords\": [\n\t\t\"kaltura\",\n\t\t\"player\",\n\t\t\"html5 player\"\n\t],\n\t\"license\": \"AGPLV3\",\n\t\"bugs\": {\n\t\t\"url\": \"https://github.com/kaltura/playkit-js/issues\"\n\t},\n\t\"homepage\": \"https://github.com/kaltura/playkit-js\",\n\t\"dependencies\": {\n\t\t\"js-logger\": \"^1.3.0\"\n\t}\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../package.json\n// module id = 18\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///package.json","//@flow\nimport FakeEventTarget from '../../event/fake-event-target'\nimport FakeEvent from '../../event/fake-event'\nimport EventManager from '../../event/event-manager'\nimport {HTML5_EVENTS as Html5Events, CUSTOM_EVENTS as CustomEvents} from '../../event/events'\nimport MediaSourceProvider from './media-source/media-source-provider'\nimport VideoTrack from '../../track/video-track'\nimport AudioTrack from '../../track/audio-track'\nimport TextTrack from '../../track/text-track'\nimport {id} from '../../utils/util'\n\n/**\n * The engine video element class name.\n * @type {string}\n * @const\n */\nconst VIDEO_ELEMENT_CLASS_NAME: string = 'playkit-engine-html5';\n\n/**\n * Html5 engine for playback.\n * @classdesc\n */\nexport default class Html5 extends FakeEventTarget implements IEngine {\n  /**\n   * The video element.\n   * @type {HTMLVideoElement}\n   * @private\n   */\n  _el: HTMLVideoElement;\n  /**\n   * The event manager of the engine.\n   * @type {EventManager}\n   * @private\n   */\n  _eventManager: EventManager;\n  /**\n   * The selected media source adapter of the engine.\n   * @type {IMediaSourceAdapter}\n   * @private\n   */\n  _mediaSourceAdapter: ?IMediaSourceAdapter;\n\n  /**\n   * @type {string} - The engine id.\n   */\n  static id: string = \"html5\";\n\n  /**\n   * Factory method to create an engine.\n   * @param {Source} source - The selected source object.\n   * @param {Object} config - The player configuration.\n   * @returns {IEngine} - New instance of the run time engine.\n   * @public\n   * @static\n   */\n  static createEngine(source: Source, config: Object): IEngine {\n    return new this(source, config);\n  }\n\n  /**\n   * Checks if the engine can play a given mime type.\n   * @param {string} mimeType - The mime type to check.\n   * @returns {boolean} - Whether the engine can play the mime type.\n   * @public\n   * @static\n   */\n  static canPlayType(mimeType): boolean {\n    return MediaSourceProvider.canPlayType(mimeType);\n  }\n\n  /**\n   * @constructor\n   * @param {Source} source - The selected source object.\n   * @param {Object} config - The player configuration.\n   */\n  constructor(source: Source, config: Object) {\n    super();\n    this._eventManager = new EventManager();\n    this._createVideoElement();\n    this._loadMediaSourceAdapter(source, config);\n    this.attach();\n  }\n\n  /**\n   * Destroys the engine.\n   * @public\n   * @returns {void}\n   */\n  destroy(): void {\n    this.detach();\n    if (this._mediaSourceAdapter) {\n      this._mediaSourceAdapter.destroy();\n      MediaSourceProvider.destroy();\n    }\n    if (this._el) {\n      this.pause();\n      this._el.removeAttribute('src');\n      if (this._el.parentNode) {\n        this._el.parentNode.removeChild(this._el);\n      }\n    }\n    this._eventManager.destroy();\n  }\n\n  /**\n   * Get the engine's id\n   * @public\n   * @returns {string} the engine's id\n   */\n  get id(): string {\n    return Html5.id;\n  }\n\n  /**\n   * Listen to the video element events and triggers them from the engine.\n   * @public\n   * @returns {void}\n   */\n  attach(): void {\n    for (let playerEvent in Html5Events) {\n      this._eventManager.listen(this._el, Html5Events[playerEvent], () => {\n        this.dispatchEvent(new FakeEvent(Html5Events[playerEvent]));\n      });\n    }\n    if (this._mediaSourceAdapter) {\n      this._eventManager.listen(this._mediaSourceAdapter, CustomEvents.VIDEO_TRACK_CHANGED, (event: FakeEvent) => {\n        this.dispatchEvent(event);\n      });\n      this._eventManager.listen(this._mediaSourceAdapter, CustomEvents.AUDIO_TRACK_CHANGED, (event: FakeEvent) => {\n        return this.dispatchEvent(event);\n      });\n      this._eventManager.listen(this._mediaSourceAdapter, CustomEvents.TEXT_TRACK_CHANGED, (event: FakeEvent) => {\n        return this.dispatchEvent(event);\n      });\n    }\n  }\n\n  /**\n   * Remove the listeners of the video element events.\n   * @public\n   * @returns {void}\n   */\n  detach(): void {\n    for (let playerEvent in Html5Events) {\n      this._eventManager.unlisten(this._el, Html5Events[playerEvent]);\n    }\n    if (this._mediaSourceAdapter) { // unlisten to adaptive bitrate changed\n      this._eventManager.unlisten(this._mediaSourceAdapter, CustomEvents.VIDEO_TRACK_CHANGED);\n      this._eventManager.unlisten(this._mediaSourceAdapter, CustomEvents.AUDIO_TRACK_CHANGED);\n      this._eventManager.unlisten(this._mediaSourceAdapter, CustomEvents.TEXT_TRACK_CHANGED);\n    }\n  }\n\n  /**\n   * @returns {HTMLVideoElement} - The video element.\n   * @public\n   */\n  getVideoElement(): HTMLVideoElement {\n    return this._el;\n  }\n\n  /**\n   * Creates a video element dom object.\n   * @private\n   * @returns {void}\n   */\n  _createVideoElement(): void {\n    this._el = document.createElement(\"video\");\n    this._el.id = id(5);\n    this._el.className = VIDEO_ELEMENT_CLASS_NAME;\n    this._el.controls = false;\n  }\n\n  /**\n   * Loads the appropriate media source extension adapter.\n   * @param {Source} source - The selected source object.\n   * @param {Object} config - The media source extension configuration.\n   * @private\n   * @returns {void}\n   */\n  _loadMediaSourceAdapter(source: Source, config: Object): void {\n    this._mediaSourceAdapter = MediaSourceProvider.getMediaSourceAdapter(this.getVideoElement(), source, config);\n  }\n\n  /**\n   * Select a new video track.\n   * @param {VideoTrack} videoTrack - The video track object to set.\n   * @returns {void}\n   */\n  selectVideoTrack(videoTrack: VideoTrack): void {\n    if (this._mediaSourceAdapter) {\n      this._mediaSourceAdapter.selectVideoTrack(videoTrack);\n    }\n  }\n\n  /**\n   * Select a new audio track.\n   * @param {AudioTrack} audioTrack - The video track object to set.\n   * @returns {void}\n   */\n  selectAudioTrack(audioTrack: AudioTrack): void {\n    if (this._mediaSourceAdapter) {\n      this._mediaSourceAdapter.selectAudioTrack(audioTrack);\n    }\n  }\n\n  /**\n   * Select a new text track.\n   * @param {TextTrack} textTrack - The text track object to set.\n   * @returns {void}\n   */\n  selectTextTrack(textTrack: TextTrack): void {\n    if (this._mediaSourceAdapter) {\n      this._mediaSourceAdapter.selectTextTrack(textTrack);\n    }\n  }\n\n  /**\n   * Hide the text track\n   * @function hideTextTrack\n   * @returns {void}\n   * @public\n   */\n  hideTextTrack(): void {\n    if (this._mediaSourceAdapter) {\n      this._mediaSourceAdapter.hideTextTrack();\n    }\n  }\n\n  /**\n   * Enables adaptive bitrate switching according to the media source extension logic.\n   * @function enableAdaptiveBitrate\n   * @returns {void}\n   * @public\n   */\n  enableAdaptiveBitrate(): void {\n    if (this._mediaSourceAdapter) {\n      this._mediaSourceAdapter.enableAdaptiveBitrate();\n    }\n  }\n\n  /**\n   * Set a source.\n   * @param {string} source - Source to set.\n   * @public\n   * @returns {void}\n   */\n  set src(source: string): void {\n    this._el.src = source;\n  }\n\n  /**\n   * Get the source url.\n   * @returns {string} - The source url.\n   * @public\n   */\n  get src(): string {\n    if (this._mediaSourceAdapter) {\n      return this._mediaSourceAdapter.src;\n    }\n    return \"\";\n  }\n\n  //playback interface\n  /**\n   * Start/resume playback.\n   * @public\n   * @returns {void}\n   */\n  play(): void {\n    return this._el.play();\n  }\n\n  /**\n   * Pause playback.\n   * @public\n   * @returns {void}\n   */\n  pause(): void {\n    return this._el.pause();\n  }\n\n  /**\n   * Load media.\n   * @public\n   * @returns {Promise<Object>} - The loaded data\n   */\n  load(): Promise<Object> {\n    return this._mediaSourceAdapter ? this._mediaSourceAdapter.load() : Promise.resolve({});\n  }\n\n  /**\n   * Get the current time in seconds.\n   * @returns {Number} - The current playback time.\n   * @public\n   */\n  get currentTime(): number {\n    return this._el.currentTime;\n  }\n\n  /**\n   * Set the current time in seconds.\n   * @param {Number} to - The number to set in seconds.\n   * @public\n   * @returns {void}\n   */\n  set currentTime(to: number): void {\n    this._el.currentTime = to;\n  }\n\n  /**\n   * Get the duration in seconds.\n   * @returns {Number} - The playback duration.\n   * @public\n   */\n  get duration(): number {\n    return this._el.duration;\n  }\n\n  /**\n   * Set playback volume.\n   * @param {Number} vol - The volume to set.\n   * @public\n   * @returns {void}\n   */\n  set volume(vol: number): void {\n    this._el.volume = vol;\n  }\n\n  /**\n   * Get playback volume.\n   * @returns {Number} - The volume value of the video element.\n   * @public\n   */\n  get volume(): number {\n    return this._el.volume;\n  }\n\n  ready() {\n  }\n\n  /**\n   * Get paused state.\n   * @returns {boolean} - The paused value of the video element.\n   * @public\n   */\n  get paused(): boolean {\n    return this._el.paused;\n  }\n\n  /**\n   * Get seeking state.\n   * @returns {boolean} - The seeking value of the video element.\n   * @public\n   */\n  get seeking(): boolean {\n    return this._el.seeking;\n  }\n\n  /**\n   * Get the first seekable range (part) of the video in seconds.\n   * @returns {TimeRanges} - First seekable range (part) of the video in seconds.\n   * @public\n   */\n  get seekable(): TimeRanges {\n    return this._el.seekable;\n  }\n\n  /**\n   * Get the first played range (part) of the video in seconds.\n   * @returns {TimeRanges} - First played range (part) of the video in seconds.\n   * @public\n   */\n  get played(): TimeRanges {\n    return this._el.played;\n  }\n\n  /**\n   * Get the first buffered range (part) of the video in seconds.\n   * @returns {TimeRanges} - First buffered range (part) of the video in seconds.\n   * @public\n   */\n  get buffered(): TimeRanges {\n    return this._el.buffered;\n  }\n\n  /**\n   * Set player muted state.\n   * @param {boolean} mute - The new mute value.\n   * @public\n   * @returns {void}\n   */\n  set muted(mute: boolean): void {\n    this._el.muted = mute;\n  }\n\n  /**\n   * Get player muted state.\n   * @returns {boolean} - The muted value of the video element.\n   * @public\n   */\n  get muted(): boolean {\n    return this._el.muted;\n  }\n\n  /**\n   * Get the default mute value.\n   * @returns {boolean} - The defaultMuted of the video element.\n   * @public\n   */\n  get defaultMuted(): boolean {\n    return this._el.defaultMuted;\n  }\n\n  /**\n   * Sets an image to be shown while the video is downloading, or until the user hits the play button.\n   * @param {string} poster - The image url to be shown.\n   * @returns {void}\n   * @public\n   */\n  set poster(poster: string): void {\n    this._el.poster = poster;\n  }\n\n  /**\n   * Gets an image to be shown while the video is downloading, or until the user hits the play button.\n   * @returns {poster} - The image url.\n   * @public\n   */\n  get poster(): string {\n    return this._el.poster;\n  }\n\n  /**\n   * Specifies if and how the author thinks that the video should be loaded when the page loads.\n   * @param {string} preload - The preload value.\n   * @public\n   * @returns {void}\n   */\n  set preload(preload: string): void {\n    this._el.preload = preload;\n  }\n\n  /**\n   * Gets the preload value of the video element.\n   * @returns {string} - The preload value.\n   * @public\n   */\n  get preload(): string {\n    return this._el.preload;\n  }\n\n  /**\n   * Set if the video will automatically start playing as soon as it can do so without stopping.\n   * @param {boolean} autoplay - The autoplay value.\n   * @public\n   * @returns {void}\n   */\n  set autoplay(autoplay: boolean): void {\n    this._el.autoplay = autoplay;\n  }\n\n  /**\n   * Gets the autoplay value of the video element.\n   * @returns {boolean} - The autoplay value.\n   * @public\n   */\n  get autoplay(): boolean {\n    return this._el.autoplay;\n  }\n\n  /**\n   * Set to specifies that the video will start over again, every time it is finished.\n   * @param {boolean} loop - the loop value.\n   * @public\n   * @returns {void}\n   */\n  set loop(loop: boolean) {\n    this._el.loop = loop;\n  }\n\n  /**\n   * Gets the loop value of the video element.\n   * @returns {boolean} - The loop value.\n   * @public\n   */\n  get loop(): boolean {\n    return this._el.loop;\n  }\n\n  /**\n   * Set to specifies that video controls should be displayed.\n   * @param {boolean} controls - the controls value.\n   * @public\n   * @returns {void}\n   */\n  set controls(controls: boolean): void {\n    this._el.controls = controls;\n  }\n\n  /**\n   * Gets the controls value of the video element.\n   * @returns {boolean} - The controls value.\n   * @public\n   */\n  get controls(): boolean {\n    return this._el.controls;\n  }\n\n  /**\n   * Sets the current playback speed of the audio/video.\n   * @param {Number} playbackRate - The playback speed value.\n   * @public\n   * @returns {void}\n   */\n  set playbackRate(playbackRate: number): void {\n    this._el.playbackRate = playbackRate;\n  }\n\n  /**\n   * Gets the current playback speed of the audio/video.\n   * @returns {Number} - The current playback speed value.\n   * @public\n   */\n  get playbackRate(): number {\n    return this._el.playbackRate;\n  }\n\n  /**\n   * Sets the default playback speed of the audio/video.\n   * @param {Number} defaultPlaybackRate - The default playback speed value.\n   * @public\n   * @returns {void}\n   */\n  set defaultPlaybackRate(defaultPlaybackRate: number) {\n    this._el.defaultPlaybackRate = defaultPlaybackRate;\n  }\n\n  /**\n   * Gets the default playback speed of the audio/video.\n   * @returns {Number} - The default playback speed value.\n   * @public\n   */\n  get defaultPlaybackRate(): number {\n    return this._el.defaultPlaybackRate;\n  }\n\n  /**\n   * The ended property returns whether the playback of the audio/video has ended.\n   * @returns {boolean} - The ended value.\n   * @public\n   */\n  get ended(): boolean {\n    return this._el.ended;\n  }\n\n  /**\n   * The error property returns a MediaError object.\n   * @returns {MediaError} - The MediaError object has a code property containing the error state of the audio/video.\n   * @public\n   */\n  get error(): ?MediaError {\n    return this._el.error;\n  }\n\n  /**\n   * @returns {Number} - The current network state (activity) of the audio/video.\n   * @public\n   */\n  get networkState(): number {\n    return this._el.networkState;\n  }\n\n  /**\n   * Indicates if the audio/video is ready to play or not.\n   * @returns {Number} - The current ready state of the audio/video.\n   * 0 = HAVE_NOTHING - no information whether or not the audio/video is ready.\n   * 1 = HAVE_METADATA - metadata for the audio/video is ready.\n   * 2 = HAVE_CURRENT_DATA - data for the current playback position is available, but not enough data to play next frame/millisecond.\n   * 3 = HAVE_FUTURE_DATA - data for the current and at least the next frame is available.\n   * 4 = HAVE_ENOUGH_DATA - enough data available to start playing.\n   */\n  get readyState(): number {\n    return this._el.readyState;\n  }\n\n  /**\n   * @returns {Number} - The height of the video player, in pixels.\n   * @public\n   */\n  get videoHeight(): number {\n    return this._el.videoHeight;\n  }\n\n  /**\n   * @returns {Number} - The width of the video player, in pixels.\n   * @public\n   */\n  get videoWidth(): number {\n    return this._el.videoWidth;\n  }\n\n  /**\n   * Test video element to check if html5 engine is supported.\n   */\n  static TEST_VID: HTMLVideoElement;\n\n  /**\n   * Checks if the html5 engine is supported.\n   * @returns {boolean} - The isSupported result.\n   * @static\n   * @public\n   */\n  static isSupported() {\n    try {\n      Html5.TEST_VID = document.createElement('video');\n      Html5.TEST_VID.volume = 0.5;\n    } catch (e) {\n      return false;\n    }\n    return !!Html5.TEST_VID.canPlayType;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./engines/html5/html5.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/engines/html5/html5.js","//@flow\nimport EventManager from '../../../../event/event-manager'\nimport {HTML5_EVENTS as Html5Events} from '../../../../event/events'\nimport Track from '../../../../track/track'\nimport VideoTrack from '../../../../track/video-track'\nimport AudioTrack from '../../../../track/audio-track'\nimport TextTrack from '../../../../track/text-track'\nimport BaseMediaSourceAdapter from '../base-media-source-adapter'\n\n/**\n * An illustration of media source extension for progressive download\n * @classdesc\n * @implements {IMediaSourceAdapter}\n */\nexport default class NativeAdapter extends BaseMediaSourceAdapter {\n  /**\n   * The id of the Adapter\n   * @member {string} id\n   * @static\n   * @public\n   */\n  static id: string = 'NativeAdapter';\n\n  /**\n   * The adapter logger\n   * @member {any} _logger\n   * @private\n   * @static\n   */\n  static _logger = BaseMediaSourceAdapter.getLogger(NativeAdapter.id);\n  /**\n   * The event manager of the class.\n   * @member {EventManager} - _eventManager\n   * @type {EventManager}\n   * @private\n   */\n  _eventManager: EventManager;\n  /**\n   * The load promise\n   * @member {Promise<Object>} - _loadPromise\n   * @type {Promise<Object>}\n   * @private\n   */\n  _loadPromise: ?Promise<Object>;\n\n  /**\n   * Checks if NativeAdapter can play a given mime type.\n   * @function canPlayType\n   * @param {string} mimeType - The mime type to check\n   * @returns {boolean} - Whether the native adapter can play a specific mime type\n   * @static\n   */\n  static canPlayType(mimeType: string): boolean {\n    let canPlayType = (typeof mimeType === 'string') ? !!(document.createElement(\"video\").canPlayType(mimeType.toLowerCase())) : false;\n    NativeAdapter._logger.debug('canPlayType result for mimeType:' + mimeType + ' is ' + canPlayType.toString());\n    return canPlayType;\n  }\n\n  /**\n   * @constructor\n   * @param {HTMLVideoElement} videoElement - The video element which bind to NativeAdapter\n   * @param {Source} source - The source object\n   * @param {Object} config - The media source adapter configuration\n   */\n  constructor(videoElement: HTMLVideoElement, source: Source, config: Object) {\n    NativeAdapter._logger.debug('Creating adapter');\n    super(videoElement, source, config);\n    this._eventManager = new EventManager();\n  }\n\n  /**\n   * Load the video source\n   * @function load\n   * @returns {Promise<Object>} - The loaded data\n   */\n  load(): Promise<Object> {\n    if (!this._loadPromise) {\n      this._loadPromise = new Promise((resolve, reject) => {\n        // We're using 'loadeddata' event for native hls (on 'loadedmetadata' native hls doesn't have tracks yet).\n        this._eventManager.listen(this._videoElement, Html5Events.LOADED_DATA, () => {\n          this._eventManager.unlisten(this._videoElement, Html5Events.LOADED_DATA);\n          let data = {tracks: this._getParsedTracks()};\n          NativeAdapter._logger.debug('The source has been loaded successfully');\n          resolve(data);\n        });\n        this._eventManager.listen(this._videoElement, Html5Events.ERROR, (error) => {\n          this._eventManager.unlisten(this._videoElement, Html5Events.ERROR);\n          NativeAdapter._logger.error(error);\n          reject(error);\n        });\n        if (this._sourceObj && this._sourceObj.url) {\n          this._videoElement.src = this._sourceObj.url;\n        }\n      });\n    }\n    return this._loadPromise;\n  }\n\n  /**\n   * Destroys the native adapter.\n   * @function destroy\n   * @returns {void}\n   */\n  destroy(): void {\n    NativeAdapter._logger.debug('destroy');\n    super.destroy();\n    this._eventManager.destroy();\n    this._loadPromise = null;\n  }\n\n  /**\n   * Get the parsed tracks\n   * @function _getParsedTracks\n   * @returns {Array<Track>} - The parsed tracks\n   * @private\n   */\n  _getParsedTracks(): Array<Track> {\n    let videoTracks = this._getParsedVideoTracks();\n    let audioTracks = this._getParsedAudioTracks();\n    let textTracks = this._getParsedTextTracks();\n    return videoTracks.concat(audioTracks).concat(textTracks);\n  }\n\n  /**\n   * Get the parsed video tracks\n   * @function _getParsedVideoTracks\n   * @returns {Array<Track>} - The parsed video tracks\n   * @private\n   */\n  _getParsedVideoTracks(): Array<Track> {\n    let videoTracks = this._videoElement.videoTracks;\n    let parsedTracks = [];\n    if (videoTracks) {\n      for (let i = 0; i < videoTracks.length; i++) {\n        let settings = {\n          id: videoTracks[i].id,\n          active: videoTracks[i].selected,\n          label: videoTracks[i].label,\n          language: videoTracks[i].language,\n          index: i\n        };\n        parsedTracks.push(new VideoTrack(settings));\n      }\n    }\n    return parsedTracks;\n  }\n\n  /**\n   * Get the parsed audio tracks\n   * @function _getParsedAudioTracks\n   * @returns {Array<Track>} - The parsed audio tracks\n   * @private\n   */\n  _getParsedAudioTracks(): Array<Track> {\n    let audioTracks = this._videoElement.audioTracks;\n    let parsedTracks = [];\n    if (audioTracks) {\n      for (let i = 0; i < audioTracks.length; i++) {\n        let settings = {\n          id: audioTracks[i].id,\n          active: audioTracks[i].enabled,\n          label: audioTracks[i].label,\n          language: audioTracks[i].language,\n          index: i\n        };\n        parsedTracks.push(new AudioTrack(settings));\n      }\n    }\n    return parsedTracks;\n  }\n\n  /**\n   * Get the parsed text tracks\n   * @function _getParsedTextTracks\n   * @returns {Array<Track>} - The parsed text tracks\n   * @private\n   */\n  _getParsedTextTracks(): Array<Track> {\n    let textTracks = this._videoElement.textTracks;\n    let parsedTracks = [];\n    if (textTracks) {\n      for (let i = 0; i < textTracks.length; i++) {\n        let settings = {\n          kind: textTracks[i].kind,\n          active: textTracks[i].mode === 'showing',\n          label: textTracks[i].label,\n          language: textTracks[i].language,\n          index: i\n        };\n        parsedTracks.push(new TextTrack(settings));\n      }\n    }\n    return parsedTracks;\n  }\n\n  /**\n   * Select a video track\n   * @function selectVideoTrack\n   * @param {VideoTrack} videoTrack - the track to select\n   * @returns {void}\n   * @public\n   */\n  selectVideoTrack(videoTrack: VideoTrack): void {\n    let videoTracks = this._videoElement.videoTracks;\n    if ((videoTrack instanceof VideoTrack) && videoTracks && videoTracks[videoTrack.index]) {\n      this._disableVideoTracks();\n      videoTracks[videoTrack.index].selected = true;\n      this._onTrackChanged(videoTrack);\n    }\n  }\n\n  /**\n   * Select an audio track\n   * @function selectAudioTrack\n   * @param {AudioTrack} audioTrack - the  audio track to select\n   * @returns {void}\n   * @public\n   */\n  selectAudioTrack(audioTrack: AudioTrack): void {\n    let audioTracks = this._videoElement.audioTracks;\n    if ((audioTrack instanceof AudioTrack) && audioTracks && audioTracks[audioTrack.index]) {\n      this._disableAudioTracks();\n      audioTracks[audioTrack.index].enabled = true;\n      this._onTrackChanged(audioTrack);\n    }\n  }\n\n  /**\n   * Select a text track\n   * @function selectTextTrack\n   * @param {TextTrack} textTrack - the track to select\n   * @returns {void}\n   * @public\n   */\n  selectTextTrack(textTrack: TextTrack): void {\n    let textTracks = this._videoElement.textTracks;\n    if ((textTrack instanceof TextTrack) && (textTrack.kind === 'subtitles' || textTrack.kind === 'captions') && textTracks && textTracks[textTrack.index]) {\n      this._disableTextTracks();\n      textTracks[textTrack.index].mode = 'showing';\n      this._onTrackChanged(textTrack);\n    }\n  }\n\n  /**\n   * Hide the text track\n   * @function hideTextTrack\n   * @returns {void}\n   * @public\n   */\n  hideTextTrack(): void {\n    this._disableTextTracks();\n  }\n\n  /**\n   * Enables adaptive bitrate\n   * @function enableAdaptiveBitrate\n   * @returns {void}\n   * @public\n   */\n  enableAdaptiveBitrate(): void {\n    NativeAdapter._logger.debug('Enabling adaptive bitrate not supported');\n  }\n\n  /**\n   * Disables all the existing video tracks.\n   * @private\n   * @returns {void}\n   */\n  _disableVideoTracks(): void {\n    let videoTracks = this._videoElement.videoTracks;\n    if (videoTracks) {\n      for (let i = 0; i < videoTracks.length; i++) {\n        videoTracks[i].selected = false;\n      }\n    }\n  }\n\n  /**\n   * Disables all the existing audio tracks.\n   * @private\n   * @returns {void}\n   */\n  _disableAudioTracks(): void {\n    let audioTracks = this._videoElement.audioTracks;\n    if (audioTracks) {\n      for (let i = 0; i < audioTracks.length; i++) {\n        audioTracks[i].enabled = false;\n      }\n    }\n  }\n\n  /**\n   * Disables all the existing text tracks.\n   * @private\n   * @returns {void}\n   */\n  _disableTextTracks(): void {\n    let textTracks = this._videoElement.textTracks;\n    if (textTracks) {\n      for (let i = 0; i < textTracks.length; i++) {\n        textTracks[i].mode = 'disabled';\n      }\n    }\n  }\n\n  /**\n   * Getter for the src that the adapter plays on the video element.\n   * @public\n   * @returns {string} - The src url.\n   */\n  get src(): string {\n    return this._videoElement.src;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./engines/html5/media-source/adapters/native-adapter.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/engines/html5/media-source/adapters/native-adapter.js","//@flow\nimport Player from './player'\nimport LoggerFactory from './utils/logger'\nimport * as packageData from '../package.json'\nimport BaseMediaSourceAdapter from './engines/html5/media-source/base-media-source-adapter'\nimport {registerMediaSourceAdapter} from './engines/html5/media-source/media-source-provider'\nimport {registerPlugin} from './plugin/plugin-manager'\nimport BasePlugin from './plugin/base-plugin'\nimport Track from './track/track'\nimport VideoTrack from './track/video-track'\nimport AudioTrack from './track/audio-track'\nimport TextTrack from './track/text-track'\n\n// Playkit version\nlet VERSION = packageData.version;\n\nLoggerFactory.getLogger().log(\"%c Playkit \" + VERSION, \"color: yellow; font-size: large\");\nLoggerFactory.getLogger().log(\"%c For more details see https://github.com/kaltura/playkit-js\", \"color: yellow;\");\n\n/**\n * @param {string} targetId - The target div id to append the player.\n * @param {Object} config - The configuration of the player\n * @returns {Player} - The player instance\n */\nexport function loadPlayer(targetId: string, config: ?Object) {\n  return new Player(targetId, config || {});\n}\n\n// Export the media source adapters necessary utils\nexport {registerMediaSourceAdapter, BaseMediaSourceAdapter};\n\n// Export the plugin framework\nexport {registerPlugin, BasePlugin};\n\n// Export the tracks classes\nexport {Track, VideoTrack, AudioTrack, TextTrack};\n\n//export version\nexport {VERSION};\nexport default loadPlayer;\n\n\n\n// WEBPACK FOOTER //\n// ./playkit.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/playkit.js","//@flow\nimport Player from '../player'\nimport EventManager from '../event/event-manager'\nimport State from './state'\nimport PlayerStates from './state-types'\nimport {HTML5_EVENTS as Html5Events, CUSTOM_EVENTS as CustomEvents} from '../event/events'\nimport FakeEvent from '../event/fake-event'\nimport LoggerFactory from '../utils/logger'\n\n/**\n * Define a transition object.\n */\ntype Transition = {\n  [state: string]: {\n    [event: string]: Function\n  }\n}\n\n/**\n * This class responsible to manage all the state machine of the player.\n * @classdesc\n */\nexport default class StateManager {\n  /**\n   * The logger of the class.\n   * @member\n   * @type {any}\n   * @private\n   */\n  _logger: any;\n  /**\n   * Reference to the actual player.\n   * @member\n   * @type {Player}\n   * @private\n   */\n  _player: Player;\n  /**\n   * The event manager of the class.\n   * @member\n   * @type {EventManager}\n   * @private\n   */\n  _eventManager: EventManager;\n  /**\n   * Holds the current state of the player.\n   * @member\n   * @type {State}\n   * @private\n   */\n  _curState: State;\n  /**\n   * Holds the previous state of the player.\n   * @member\n   * @type {State | null}\n   * @private\n   */\n  _prevState: State | null;\n  /**\n   * Holds the state history of the player.\n   * @member\n   * @type {Array<State>}\n   * @private\n   */\n  _history: Array<State>;\n  /**\n   * The possible transitions from one state to another.\n   * @type {Array<Transition>}\n   * @private\n   */\n  _transitions: Transition = {\n    [PlayerStates.IDLE]: {\n      [Html5Events.LOAD_START]: () => {\n        this._updateState(PlayerStates.LOADING);\n        this._dispatchEvent();\n      },\n      [Html5Events.PLAY]: () => {\n        this._updateState(PlayerStates.BUFFERING);\n        this._dispatchEvent();\n      }\n    },\n    [PlayerStates.LOADING]: {\n      [Html5Events.LOADED_METADATA]: () => {\n        if (this._player.config.autoplay) {\n          this._updateState(PlayerStates.PLAYING);\n        } else {\n          this._updateState(PlayerStates.PAUSED);\n        }\n        this._dispatchEvent();\n      },\n      [Html5Events.ERROR]: () => {\n        this._updateState(PlayerStates.IDLE);\n        this._dispatchEvent();\n      }\n    },\n    [PlayerStates.PAUSED]: {\n      [Html5Events.PLAY]: () => {\n        this._updateState(PlayerStates.PLAYING);\n        this._dispatchEvent();\n      },\n      [Html5Events.PLAYING]: () => {\n        this._updateState(PlayerStates.PLAYING);\n        this._dispatchEvent();\n      },\n      [Html5Events.ENDED]: () => {\n        this._updateState(PlayerStates.IDLE);\n        this._dispatchEvent();\n      }\n    },\n    [PlayerStates.PLAYING]: {\n      [Html5Events.PAUSE]: () => {\n        this._updateState(PlayerStates.PAUSED);\n        this._dispatchEvent();\n      },\n      [Html5Events.WAITING]: () => {\n        this._updateState(PlayerStates.BUFFERING);\n        this._dispatchEvent();\n      },\n      [Html5Events.ENDED]: () => {\n        this._updateState(PlayerStates.IDLE);\n        this._dispatchEvent();\n      },\n      [Html5Events.ERROR]: () => {\n        this._updateState(PlayerStates.IDLE);\n        this._dispatchEvent();\n      }\n    },\n    [PlayerStates.BUFFERING]: {\n      [Html5Events.PLAYING]: () => {\n        this._updateState(PlayerStates.PLAYING);\n        this._dispatchEvent();\n      },\n      [Html5Events.PAUSE]: () => {\n        this._updateState(PlayerStates.PAUSED);\n        this._dispatchEvent();\n      }\n    }\n  };\n\n  /**\n   * @constructor\n   * @param {Player} player - Reference to the player.\n   */\n  constructor(player: Player) {\n    this._player = player;\n    this._logger = LoggerFactory.getLogger(\"StateManager\");\n    this._eventManager = new EventManager();\n    this._history = [];\n    this._prevState = null;\n    this._curState = new State(PlayerStates.IDLE);\n    this._attachListeners();\n  }\n\n  /**\n   * Register to all necessary events which impacts on the player state.\n   * @private\n   * @returns {void}\n   */\n  _attachListeners(): void {\n    this._eventManager.listen(this._player, Html5Events.ERROR, this._doTransition.bind(this));\n    this._eventManager.listen(this._player, Html5Events.ENDED, this._doTransition.bind(this));\n    this._eventManager.listen(this._player, Html5Events.PLAY, this._doTransition.bind(this));\n    this._eventManager.listen(this._player, Html5Events.LOAD_START, this._doTransition.bind(this));\n    this._eventManager.listen(this._player, Html5Events.PLAYING, this._doTransition.bind(this));\n    this._eventManager.listen(this._player, Html5Events.LOADED_METADATA, this._doTransition.bind(this));\n    this._eventManager.listen(this._player, Html5Events.PAUSE, this._doTransition.bind(this));\n    this._eventManager.listen(this._player, Html5Events.WAITING, this._doTransition.bind(this));\n  }\n\n  /**\n   * Performs a state transition depends on the event which occurs in the player system.\n   * @param {FakeEvent} event - The event occurs in the player system.\n   * @private\n   * @returns {void}\n   */\n  _doTransition(event: FakeEvent): void {\n    this._logger.debug('Do transition request', event);\n    let transition = this._transitions[this._curState.type];\n    if (typeof transition[event.type] === 'function') {\n      transition[event.type]();\n    }\n  }\n\n  /**\n   * Updates the player's state.\n   * @param {string} type - The type of the new state.\n   * @private\n   * @returns {void}\n   */\n  _updateState(type: string): void {\n    if (this._curState.type !== type) {\n      this._curState.duration = Date.now() / 1000;\n      this._history.push(this._curState);\n      this._prevState = this._curState;\n      this._curState = new State(type);\n      this._logger.debug(`Switch player state: from ${this._prevState.type} to ${this._curState.type}`)\n    }\n  }\n\n  /**\n   * Fires the playerStateChanged event after state has been changed.\n   * @private\n   * @returns {void}\n   */\n  _dispatchEvent(): void {\n    let event = new FakeEvent(CustomEvents.PLAYER_STATE_CHANGED, {\n      'oldState': this._prevState,\n      'newState': this._curState\n    });\n    this._player.dispatchEvent(event);\n  }\n\n  /**\n   * Destroys the state manager.\n   * @public\n   * @returns {void}\n   */\n  destroy(): void {\n    this._history = [];\n    this._eventManager.destroy();\n  }\n\n  /**\n   * Getter to the current state of the player.\n   * @public\n   * @returns {State} - The current state object\n   */\n  get currentState(): State {\n    return this._curState;\n  }\n\n  /**\n   * Getter to the previous state of the player.\n   * @public\n   * @returns {State|null} - The previous state object, or null if such doesn't exists\n   */\n  get previousState(): State | null {\n    return this._prevState;\n  }\n\n  /**\n   * Getter to the state history of the player.\n   * @public\n   * @returns {Array.<State>} - The full states history objects\n   */\n  get history(): Array<State> {\n    return this._history;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./state/state-manager.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/state/state-manager.js","//@flow\n\n/**\n * This class describes a player state.\n * @classdesc\n */\nexport default class State {\n  /**\n   * The type of the state.\n   * Can be one of those describes in states.js\n   * @member\n   * @type {string}\n   * @public\n   */\n  type: string;\n  /**\n   * The duration that the player was in this state.\n   * @member\n   * @type {number}\n   * @private\n   */\n  _duration: number;\n  /**\n   * The timestamp that this state started.\n   * @member\n   * @type {number}\n   * @private\n   */\n  _timestamp: number;\n\n  /**\n   * @constructor\n   * @param {string} type - The type of the state.\n   */\n  constructor(type: string) {\n    this.type = type;\n    this._duration = 0;\n    this._timestamp = Date.now() / 1000;\n  }\n\n  /**\n   * Getter for the duration of the state.\n   * @returns {number} - The duration of the state\n   */\n  get duration(): number {\n    return this._duration;\n  }\n\n  /**\n   * Setter for the duration of the state.\n   * @param {number} endTime - The timestamp of the next state.\n   */\n  set duration(endTime: number): void {\n    this._duration = endTime - this._timestamp;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./state/state.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/state/state.js","//@flow\nconst TRACK_TYPES: {[track: string]: string} = {\n  VIDEO: \"video\",\n  AUDIO: \"audio\",\n  TEXT: \"text\"\n};\n\nexport default TRACK_TYPES;\n\n\n\n// WEBPACK FOOTER //\n// ./track/track-types.js\n\n\n// WEBPACK FOOTER //\n// webpack:///core/track/track-types.js","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".playkit-container {\\n  width: 100%;\\n  height: 100%;\\n  background-color: #000;\\n  color: #fff;\\n  outline: none;\\n  -webkit-touch-callout: none;\\n  -webkit-user-select: none;\\n  -moz-user-select: none;\\n  -ms-user-select: none;\\n  user-select: none;\\n  -webkit-tap-highlight-color: transparent;\\n}\\n\\n*[class^=\\\"playkit-engine-\\\"] {\\n  width: 100%;\\n  height: 100%;\\n  background-color: #000;\\n}\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/css-loader!./assets/style.css\n// module id = 25\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///core/assets/style.css","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/css-loader/lib/css-base.js\n// module id = 26\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///~/css-loader/lib/css-base.js","/*!\r\n * js-logger - http://github.com/jonnyreeves/js-logger\r\n * Jonny Reeves, http://jonnyreeves.co.uk/\r\n * js-logger may be freely distributed under the MIT license.\r\n */\r\n(function (global) {\r\n\t\"use strict\";\r\n\r\n\t// Top level module for the global, static logger instance.\r\n\tvar Logger = { };\r\n\r\n\t// For those that are at home that are keeping score.\r\n\tLogger.VERSION = \"1.3.0\";\r\n\r\n\t// Function which handles all incoming log messages.\r\n\tvar logHandler;\r\n\r\n\t// Map of ContextualLogger instances by name; used by Logger.get() to return the same named instance.\r\n\tvar contextualLoggersByNameMap = {};\r\n\r\n\t// Polyfill for ES5's Function.bind.\r\n\tvar bind = function(scope, func) {\r\n\t\treturn function() {\r\n\t\t\treturn func.apply(scope, arguments);\r\n\t\t};\r\n\t};\r\n\r\n\t// Super exciting object merger-matron 9000 adding another 100 bytes to your download.\r\n\tvar merge = function () {\r\n\t\tvar args = arguments, target = args[0], key, i;\r\n\t\tfor (i = 1; i < args.length; i++) {\r\n\t\t\tfor (key in args[i]) {\r\n\t\t\t\tif (!(key in target) && args[i].hasOwnProperty(key)) {\r\n\t\t\t\t\ttarget[key] = args[i][key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn target;\r\n\t};\r\n\r\n\t// Helper to define a logging level object; helps with optimisation.\r\n\tvar defineLogLevel = function(value, name) {\r\n\t\treturn { value: value, name: name };\r\n\t};\r\n\r\n\t// Predefined logging levels.\r\n\tLogger.DEBUG = defineLogLevel(1, 'DEBUG');\r\n\tLogger.INFO = defineLogLevel(2, 'INFO');\r\n\tLogger.TIME = defineLogLevel(3, 'TIME');\r\n\tLogger.WARN = defineLogLevel(4, 'WARN');\r\n\tLogger.ERROR = defineLogLevel(8, 'ERROR');\r\n\tLogger.OFF = defineLogLevel(99, 'OFF');\r\n\r\n\t// Inner class which performs the bulk of the work; ContextualLogger instances can be configured independently\r\n\t// of each other.\r\n\tvar ContextualLogger = function(defaultContext) {\r\n\t\tthis.context = defaultContext;\r\n\t\tthis.setLevel(defaultContext.filterLevel);\r\n\t\tthis.log = this.info;  // Convenience alias.\r\n\t};\r\n\r\n\tContextualLogger.prototype = {\r\n\t\t// Changes the current logging level for the logging instance.\r\n\t\tsetLevel: function (newLevel) {\r\n\t\t\t// Ensure the supplied Level object looks valid.\r\n\t\t\tif (newLevel && \"value\" in newLevel) {\r\n\t\t\t\tthis.context.filterLevel = newLevel;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Is the logger configured to output messages at the supplied level?\r\n\t\tenabledFor: function (lvl) {\r\n\t\t\tvar filterLevel = this.context.filterLevel;\r\n\t\t\treturn lvl.value >= filterLevel.value;\r\n\t\t},\r\n\r\n\t\tdebug: function () {\r\n\t\t\tthis.invoke(Logger.DEBUG, arguments);\r\n\t\t},\r\n\r\n\t\tinfo: function () {\r\n\t\t\tthis.invoke(Logger.INFO, arguments);\r\n\t\t},\r\n\r\n\t\twarn: function () {\r\n\t\t\tthis.invoke(Logger.WARN, arguments);\r\n\t\t},\r\n\r\n\t\terror: function () {\r\n\t\t\tthis.invoke(Logger.ERROR, arguments);\r\n\t\t},\r\n\r\n\t\ttime: function (label) {\r\n\t\t\tif (typeof label === 'string' && label.length > 0) {\r\n\t\t\t\tthis.invoke(Logger.TIME, [ label, 'start' ]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttimeEnd: function (label) {\r\n\t\t\tif (typeof label === 'string' && label.length > 0) {\r\n\t\t\t\tthis.invoke(Logger.TIME, [ label, 'end' ]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Invokes the logger callback if it's not being filtered.\r\n\t\tinvoke: function (level, msgArgs) {\r\n\t\t\tif (logHandler && this.enabledFor(level)) {\r\n\t\t\t\tlogHandler(msgArgs, merge({ level: level }, this.context));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Protected instance which all calls to the to level `Logger` module will be routed through.\r\n\tvar globalLogger = new ContextualLogger({ filterLevel: Logger.OFF });\r\n\r\n\t// Configure the global Logger instance.\r\n\t(function() {\r\n\t\t// Shortcut for optimisers.\r\n\t\tvar L = Logger;\r\n\r\n\t\tL.enabledFor = bind(globalLogger, globalLogger.enabledFor);\r\n\t\tL.debug = bind(globalLogger, globalLogger.debug);\r\n\t\tL.time = bind(globalLogger, globalLogger.time);\r\n\t\tL.timeEnd = bind(globalLogger, globalLogger.timeEnd);\r\n\t\tL.info = bind(globalLogger, globalLogger.info);\r\n\t\tL.warn = bind(globalLogger, globalLogger.warn);\r\n\t\tL.error = bind(globalLogger, globalLogger.error);\r\n\r\n\t\t// Don't forget the convenience alias!\r\n\t\tL.log = L.info;\r\n\t}());\r\n\r\n\t// Set the global logging handler.  The supplied function should expect two arguments, the first being an arguments\r\n\t// object with the supplied log messages and the second being a context object which contains a hash of stateful\r\n\t// parameters which the logging function can consume.\r\n\tLogger.setHandler = function (func) {\r\n\t\tlogHandler = func;\r\n\t};\r\n\r\n\t// Sets the global logging filter level which applies to *all* previously registered, and future Logger instances.\r\n\t// (note that named loggers (retrieved via `Logger.get`) can be configured independently if required).\r\n\tLogger.setLevel = function(level) {\r\n\t\t// Set the globalLogger's level.\r\n\t\tglobalLogger.setLevel(level);\r\n\r\n\t\t// Apply this level to all registered contextual loggers.\r\n\t\tfor (var key in contextualLoggersByNameMap) {\r\n\t\t\tif (contextualLoggersByNameMap.hasOwnProperty(key)) {\r\n\t\t\t\tcontextualLoggersByNameMap[key].setLevel(level);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Retrieve a ContextualLogger instance.  Note that named loggers automatically inherit the global logger's level,\r\n\t// default context and log handler.\r\n\tLogger.get = function (name) {\r\n\t\t// All logger instances are cached so they can be configured ahead of use.\r\n\t\treturn contextualLoggersByNameMap[name] ||\r\n\t\t\t(contextualLoggersByNameMap[name] = new ContextualLogger(merge({ name: name }, globalLogger.context)));\r\n\t};\r\n\r\n\t// CreateDefaultHandler returns a handler function which can be passed to `Logger.setHandler()` which will\r\n\t// write to the window's console object (if present); the optional options object can be used to customise the\r\n\t// formatter used to format each log message.\r\n\tLogger.createDefaultHandler = function (options) {\r\n\t\toptions = options || {};\r\n\r\n\t\toptions.formatter = options.formatter || function defaultMessageFormatter(messages, context) {\r\n\t\t\t// Prepend the logger's name to the log message for easy identification.\r\n\t\t\tif (context.name) {\r\n\t\t\t\tmessages.unshift(\"[\" + context.name + \"]\");\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Map of timestamps by timer labels used to track `#time` and `#timeEnd()` invocations in environments\r\n\t\t// that don't offer a native console method.\r\n\t\tvar timerStartTimeByLabelMap = {};\r\n\r\n\t\t// Support for IE8+ (and other, slightly more sane environments)\r\n\t\tvar invokeConsoleMethod = function (hdlr, messages) {\r\n\t\t\tFunction.prototype.apply.call(hdlr, console, messages);\r\n\t\t};\r\n\r\n\t\t// Check for the presence of a logger.\r\n\t\tif (typeof console === \"undefined\") {\r\n\t\t\treturn function () { /* no console */ };\r\n\t\t}\r\n\r\n\t\treturn function(messages, context) {\r\n\t\t\t// Convert arguments object to Array.\r\n\t\t\tmessages = Array.prototype.slice.call(messages);\r\n\r\n\t\t\tvar hdlr = console.log;\r\n\t\t\tvar timerLabel;\r\n\r\n\t\t\tif (context.level === Logger.TIME) {\r\n\t\t\t\ttimerLabel = (context.name ? '[' + context.name + '] ' : '') + messages[0];\r\n\r\n\t\t\t\tif (messages[1] === 'start') {\r\n\t\t\t\t\tif (console.time) {\r\n\t\t\t\t\t\tconsole.time(timerLabel);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttimerStartTimeByLabelMap[timerLabel] = new Date().getTime();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (console.timeEnd) {\r\n\t\t\t\t\t\tconsole.timeEnd(timerLabel);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tinvokeConsoleMethod(hdlr, [ timerLabel + ': ' +\r\n\t\t\t\t\t\t\t(new Date().getTime() - timerStartTimeByLabelMap[timerLabel]) + 'ms' ]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Delegate through to custom warn/error loggers if present on the console.\r\n\t\t\t\tif (context.level === Logger.WARN && console.warn) {\r\n\t\t\t\t\thdlr = console.warn;\r\n\t\t\t\t} else if (context.level === Logger.ERROR && console.error) {\r\n\t\t\t\t\thdlr = console.error;\r\n\t\t\t\t} else if (context.level === Logger.INFO && console.info) {\r\n\t\t\t\t\thdlr = console.info;\r\n\t\t\t\t}\r\n\r\n\t\t\t\toptions.formatter(messages, context);\r\n\t\t\t\tinvokeConsoleMethod(hdlr, messages);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\t// Configure and example a Default implementation which writes to the `window.console` (if present).  The\r\n\t// `options` hash can be used to configure the default logLevel and provide a custom message formatter.\r\n\tLogger.useDefaults = function(options) {\r\n\t\tLogger.setLevel(options && options.defaultLevel || Logger.DEBUG);\r\n\t\tLogger.setHandler(Logger.createDefaultHandler(options));\r\n\t};\r\n\r\n\t// Export to popular environments boilerplate.\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine(Logger);\r\n\t}\r\n\telse if (typeof module !== 'undefined' && module.exports) {\r\n\t\tmodule.exports = Logger;\r\n\t}\r\n\telse {\r\n\t\tLogger._prevLogger = global.Logger;\r\n\r\n\t\tLogger.noConflict = function () {\r\n\t\t\tglobal.Logger = Logger._prevLogger;\r\n\t\t\treturn Logger;\r\n\t\t};\r\n\r\n\t\tglobal.Logger = Logger;\r\n\t}\r\n}(this));\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/js-logger/src/logger.js\n// module id = 8\n// module chunks = 0 1\n\n\n// WEBPACK FOOTER //\n// webpack:///~/js-logger/src/logger.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js!./style.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!./style.css\", function() {\n\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!./style.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./assets/style.css\n// module id = 28\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///assets/style.css?460c","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(selector) {\n\t\tif (typeof memo[selector] === \"undefined\") {\n\t\t\tmemo[selector] = fn.call(this, selector);\n\t\t}\n\n\t\treturn memo[selector]\n\t};\n})(function (target) {\n\treturn document.querySelector(target)\n});\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton) options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n\tif (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\toptions.attrs.type = \"text/css\";\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/style-loader/lib/addStyles.js\n// module id = 29\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///~/style-loader/lib/addStyles.js","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/style-loader/lib/urls.js\n// module id = 30\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///~/style-loader/lib/urls.js","module.exports = {\n\t\"playback\": {\n\t\t\"preload\": \"none\",\n\t\t\"autoplay\": false,\n\t\t\"muted\": false,\n\t\t\"streamPriority\": [\n\t\t\t{\n\t\t\t\t\"engine\": \"html5\",\n\t\t\t\t\"format\": \"hls\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"engine\": \"html5\",\n\t\t\t\t\"format\": \"dash\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"engine\": \"html5\",\n\t\t\t\t\"format\": \"progressive\"\n\t\t\t}\n\t\t]\n\t}\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./player-config.json\n// module id = 31\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///core/player-config.json","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/webpack/buildin/module.js\n// module id = 1\n// module chunks = 0","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PlaykitJsProviders\"] = factory();\n\telse\n\t\troot[\"PlaykitJsProviders\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 25);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 638014c152c6bb21e972\n\n\n// WEBPACK FOOTER //\n// webpack:/providers/webpack/bootstrap 638014c152c6bb21e972","//@flow\n\n/**\n * Request builder\n * @classdesc\n */\nexport default class RequestBuilder {\n\n  /**\n   * @member - Service name\n   * @type {string}\n   */\n  service: string;\n  /**\n   * @member - Service action\n   * @type {string}\n   */\n  action: string;\n  /**\n   * @member - Service params\n   * @type {any}\n   */\n  params: any;\n  /**\n   * @member - Service headers\n   * @type {Map<string, string>}\n   */\n  headers: Map<string, string>;\n  /**\n   * @member - Service base url\n   * @type {Map<string, string>}\n   */\n  baseUrl: string;\n  /**\n   * @member - Service method (POST,GET,DELETE etc..)\n   * @type {string}\n   */\n  method: string;\n  /**\n   * @member - Service tag\n   * @type {string}\n   */\n  tag: string;\n\n  /**\n   * @constructor\n   * @param {Map<string, string>} headers The request headers\n   */\n  constructor(headers: Map<string, string> = new Map()) {\n    this.headers = headers;\n    this.headers.set(\"Content-Type\", \"application/json\");\n  }\n\n  /**\n   * Builds restful service URL\n   * @function getUrl\n   * @returns {string} The service URL\n   */\n  getUrl(): string {\n    if (!this.baseUrl) {\n      throw new Error(\"baseUrl is mandatory for request builder\");\n    }\n    let url = this.baseUrl + '/service/' + this.service + (this.action ? '/action/' + this.action : '');\n    return url;\n  }\n\n  /**\n   * Executes service\n   * @function doHttpRequest\n   * @returns {Promise.<any>} Service response as promise\n   */\n  doHttpRequest(): Promise<any> {\n    let request = new XMLHttpRequest();\n    return new Promise((resolve, reject) => {\n      request.onreadystatechange = function () {\n        if (request.readyState === 4) {\n          if (request.status === 200) {\n            let jsonResponse = JSON.parse(request.responseText);\n            if (jsonResponse && typeof(jsonResponse) === 'object' && jsonResponse.code && jsonResponse.message)\n              reject(jsonResponse);\n            else\n              resolve(jsonResponse);\n          } else {\n            reject(request.responseText);\n          }\n        }\n      };\n      request.open(this.method, this.getUrl());\n      this.headers.forEach((value, key) => {\n        request.setRequestHeader(key, value);\n      });\n      request.send(this.params);\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/request-builder.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/request-builder.js","//@flow\n\nconst defaultConfig: Object = {\n  beUrl: \"http://www.kaltura.com/api_v3\",\n  baseUrl: \"https://cdnapisec.kaltura.com\",\n  serviceParams: {\n    clientTag: \"playkit-js\",\n    apiVersion: '3.3.0',\n    format: 1\n  }\n};\n\nexport default class Configuration {\n\n  static set(clientConfig?: Object) {\n    if (clientConfig) {\n      Object.assign(defaultConfig, clientConfig);\n    }\n  }\n\n  static get(): Object {\n    return defaultConfig;\n  }\n}\n\nexport {Configuration};\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/config.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/config.js","//@flow\n\nimport {Enum} from 'enumify';\n\nexport class Scheme extends Enum {\n}\nScheme.initEnum({\n  PLAYREADY_CENC: \"drm.PLAYREADY_CENC\",\n  WIDEVINE_CENC: \"drm.WIDEVINE_CENC\",\n  FAIRPLAY: \"fairplay.FAIRPLAY\",\n  PLAYREADY: \"playReady.PLAYREADY\",\n  WIDEVINE: \"widevine.WIDEVINE\"\n});\n\n\nexport class KalturaRuleActionType extends Enum {\n}\nKalturaRuleActionType.initEnum({\n  DRM_POLICY: \"drm.DRM_POLICY\",\n  BLOCK: 1,\n  PREVIEW: 2,\n  LIMIT_FLAVORS: 3,\n  ADD_TO_STORAGE: 4,\n  LIMIT_DELIVERY_PROFILES: 5,\n  SERVE_FROM_REMOTE_SERVER: 6,\n  REQUEST_HOST_REGEX: 7,\n  LIMIT_THUMBNAIL_CAPTURE: 8\n});\n\nexport class Status extends Enum {\n}\nStatus.initEnum({\n  ERROR: -1,\n  QUEUED: 0,\n  CONVERTING: 1,\n  READY: 2,\n  DELETED: 3,\n  NOT_APPLICABLE: 4,\n  TEMP: 5,\n  WAIT_FOR_CONVERT: 6,\n  IMPORTING: 7,\n  VALIDATING: 8,\n  EXPORTING: 9\n});\n\nexport class MetadataObjectType extends Enum {\n}\nMetadataObjectType.initEnum({\n  AD_CUE_POINT: \"adCuePointMetadata.AdCuePoint\",\n  ANNOTATION: \"annotationMetadata.Annotation\",\n  CODE_CUE_POINT: \"codeCuePointMetadata.CodeCuePoint\",\n  THUMB_CUE_POINT: \"thumbCuePointMetadata.thumbCuePoint\",\n  ENTRY: 1,\n  CATEGORY: 2,\n  USER: 3,\n  PARTNER: 4,\n  DYNAMIC_OBJECT: 5\n});\n\nexport class MetadataStatus extends Enum {\n}\nMetadataStatus.initEnum({\n  VALID: 1,\n  INVALID: 2,\n  DELETED: 3\n});\n\n\nexport class EntryStatus extends Enum {\n}\nEntryStatus.initEnum({\n  ERROR_IMPORTING: -2,\n  ERROR_CONVERTING: -1,\n  SCAN_FAILURE: \"virusScan.ScanFailure\",\n  IMPORT: 0,\n  INFECTED: \"virusScan.Infected\",\n  PRECONVERT: 1,\n  READY: 2,\n  DELETED: 3,\n  PENDING: 4,\n  MODERATE: 5,\n  BLOCKED: 6,\n  NO_CONTENT: 7\n});\n\nexport class EntryModerationStatus extends Enum {\n}\nEntryModerationStatus.initEnum({\n  PENDING_MODERATION: 1,\n  APPROVED: 2,\n  REJECTED: 3,\n  FLAGGED_FOR_REVIEW: 4,\n  MODERATE: 5,\n  AUTO_APPROVED: 6\n});\n\nexport class EntryType extends Enum {\n}\nEntryType.initEnum({\n  AUTOMATIC: {value: -1},\n  EXTERNAL_MEDIA: {value: \"externalMedia.externalMedia\"},\n  MEDIA_CLIP: {value: 1},\n  MIX: {value: 2},\n  PLAYLIST: {value: 5},\n  DATA: {value: 6},\n  LIVE_STREAM: {value: 7},\n  LIVE_CHANNEL: {value: 8},\n  DOCUMENT: {value: 10}\n});\n\nexport class MediaType extends Enum {\n}\nMediaType.initEnum({\n  VIDEO: {value: 1},\n  IMAGE: {value: 2},\n  AUDIO: {value: 5},\n  LIVE_STREAM_FLASH: {value: 201},\n  LIVE_STREAM_WINDOWS_MEDIA: {value: 202},\n  LIVE_STREAM_REAL_MEDIA: {value: 203},\n  LIVE_STREAM_QUICKTIME: {value: 204}\n});\n\n\nexport class MediaEntryType extends Enum {\n}\nMediaEntryType.initEnum(['Vod', 'Live', 'Image', 'Audio', 'Unknown']);\n\nexport class UIConfType extends Enum {\n}\nUIConfType.initEnum({\n  PLAYER: 1,\n  CONTRIBUTION_WIZARD: 2,\n  SIMPLE_EDITOR: 3,\n  ADVANCED_EDITOR: 4,\n  PLAYLIST: 5,\n  APP_STUDIO: 6,\n  KRECORD: 7,\n  PLAYER_V3: 8,\n  KMC_ACCOUNT: 9,\n  KMC_ANALYTICS: 10,\n  KMC_CONTENT: 11,\n  KMC_DASHBOARD: 12,\n  KMC_LOGIN: 13,\n  PLAYER_SL: 14,\n  CLIENTSIDE_ENCODER: 15,\n  KMC_GENERAL: 16,\n  KMC_ROLES_AND_PERMISSIONS: 17,\n  CLIPPER: 18,\n  KSR: 19,\n  KUPLOAD: 20,\n  WEBCASTING: 21\n});\n\nexport class UIConfCreationMode extends Enum {\n}\nUIConfCreationMode.initEnum({\n  WIZARD: 2,\n  ADVANCED: 3\n});\n\n\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/enums.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/enums.js","//@flow\nimport MultiRequestBuilder from '../../multi-request-builder'\nimport Configuration from '../config'\n\nconst config = Configuration.get();\nconst SERVICE_NAME: string = \"multirequest\";\n\n/**\n * Base for all ovp services\n * @classdesc\n */\nexport default class OvpService {\n  /**\n   * Gets a new instance of MultiRequestBuilder with ovp params\n   * @function getMultirequest\n   * @param {string} ks The ks\n   * @param {string} partnerId The partner ID\n   * @returns {MultiRequestBuilder} The multi request builder\n   * @static\n   */\n  static getMultirequest(ks: string, partnerId?: number): MultiRequestBuilder {\n    let ovpParams = config.serviceParams;\n    Object.assign(ovpParams, {ks: ks});\n    if (partnerId) {\n      Object.assign(ovpParams, {partnerId: partnerId});\n    }\n    let multiReq = new MultiRequestBuilder();\n    multiReq.method = \"POST\";\n    multiReq.service = SERVICE_NAME;\n    multiReq.baseUrl = config.beUrl;\n    multiReq.params = ovpParams;\n    return multiReq;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/services/ovp-service.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/services/ovp-service.js","//@flow\n\n/**\n * Base service result\n * @classdesc\n */\nexport default class ServiceResult {\n\n  /**\n   * @member - Is service returned an error\n   * @type {boolean}\n   */\n  hasError: boolean = false;\n  /**\n   * @member - The service error\n   * @type {ServiceError}\n   */\n  error: ServiceError;\n  /**\n   * @member - The service result data\n   * @type {Object}\n   */\n  data: Object;\n\n  /**\n   * @constructor\n   * @param {Object} response - Service response\n   */\n  constructor(response: Object) {\n    if (response.objectType === \"KalturaAPIException\") {\n      this.hasError = true;\n      this.error = new ServiceError(response.code, response.message);\n    }\n    else {\n      this.data = response;\n    }\n  }\n}\n\n/**\n * Service error\n * @classdesc\n */\nclass ServiceError {\n  /**\n   * @member - The error code\n   * @type {string}\n   */\n  code: string;\n  /**\n   * @member - The error message\n   * @type {string}\n   */\n  message: string;\n\n  /**\n   * @constructor\n   * @param {string} code - The result code\n   * @param {string} message - The result message\n   */\n  constructor(code: string, message: string) {\n    this.code = code;\n    this.message = message;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/base-service-result.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/base-service-result.js","//@flow\nimport * as JsLogger from 'js-logger';\n\nclass LoggerFactory {\n  constructor(options?: Object) {\n    JsLogger.useDefaults(options || {});\n  }\n\n  get(name?: string) {\n    if (!name) {\n      return JsLogger;\n    }\n    return JsLogger.get(name);\n  }\n}\n\nlet Logger = new LoggerFactory({defaultLevel: JsLogger.DEBUG});\nconst LOG_LEVEL: {[level: string]: Object} = {\n  \"DEBUG\": JsLogger.DEBUG,\n  \"INFO\": JsLogger.INFO,\n  \"TIME\": JsLogger.TIME,\n  \"WARN\": JsLogger.WARN,\n  \"ERROR\": JsLogger.ERROR,\n  \"OFF\": JsLogger.OFF\n};\n\nexport default Logger;\nexport {LOG_LEVEL};\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./util/logger.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/util/logger.js","//@flow\nimport RequestBuilder from './request-builder'\nimport ServiceResult from './base-service-result'\nimport Logger from \"../util/logger\";\n/**\n * @constant\n */\nconst logger = Logger.get(\"OvpProvider\");\n\n/**\n * Multi Request builder\n * @classdesc\n */\nexport default class MultiRequestBuilder extends RequestBuilder {\n\n  /**\n   * @member - Array of requests\n   * @type {Array<RequestBuilder>}\n   */\n  requests: Array<RequestBuilder> = [];\n\n  /**\n   * @constructor\n   */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Adds request to requests array\n   * @function add\n   * @param {RequestBuilder} request The request\n   * @returns {MultiRequestBuilder} The multiRequest\n   */\n  add(request: RequestBuilder): MultiRequestBuilder {\n    this.requests.push(request);\n    let requestParams = {};\n    let serviceDef: Object = {service: request.service, action: request.action};\n    Object.assign(requestParams, {[this.requests.length]: Object.assign(serviceDef, request.params)});\n    Object.assign(requestParams, this.params);\n    this.params = requestParams;\n    return this;\n  }\n\n  /**\n   * Executes a multi request\n   * @function execute\n   * @returns {Promise} The multirequest execution promisie\n   */\n  execute(): Promise<Object> {\n    try {\n      this.params = JSON.stringify(this.params);\n    }\n    catch (err) {\n      logger.error(`${err.message}`);\n    }\n    return new Promise((resolve, reject) => {\n      this.doHttpRequest().then(data => {\n          resolve(new MultiRequestResult(data));\n        },\n        err => {\n          let errorText: string = `Error on multiRequest execution, error <${err}>.`;\n          reject(errorText);\n\n        });\n    });\n  }\n\n}\n\n/**\n * Multi Request result object\n * @classdesc\n */\nexport class MultiRequestResult {\n\n  /**\n   * @member - Is success\n   * @type {boolean}\n   */\n  success: boolean;\n  /**\n   * @member - Multi request response data\n   * @type {Object}\n   */\n  results: Array<ServiceResult> = [];\n\n  /**\n   * @constructor\n   * @param {Object}  response data\n   */\n  constructor(response: Object) {\n    this.success = true;\n    response.forEach((result) => {\n      let serviceResult: ServiceResult = new ServiceResult(result);\n      this.results.push(serviceResult);\n      if (serviceResult.hasError) {\n        logger.error(`Service returned an error with error code: ${serviceResult.error.code} and message: ${serviceResult.error.message}.`);\n        this.success = false;\n        return;\n      }\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/multi-request-builder.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/multi-request-builder.js","// @flow\nimport MediaSource from './media-source'\nimport {MediaFormat} from './media-format'\n\n/**\n * Container for the media sources aggregated by stream format.\n * @classdesc\n */\nexport default class MediaSources {\n  /**\n   * Progressive download media sources container.\n   * @type {Array<MediaSource>}\n   * @public\n   */\n  progressive: Array<MediaSource>;\n  /**\n   * Dash media sources container.\n   * @type {Array<MediaSource>}\n   * @public\n   */\n  dash: Array<MediaSource>;\n  /**\n   * Hls media sources container.\n   * @type {Array<MediaSource>}\n   * @public\n   */\n  hls: Array<MediaSource>;\n\n  /**\n   * @constructor\n   */\n  constructor() {\n    this.progressive = [];\n    this.dash = [];\n    this.hls = [];\n  }\n\n  /**\n   * Maps the source to one of the containers according to his media format.\n   * @param {MediaSource} source - The source to add to one of the containers.\n   * @param {MediaFormat} mediaFormat - The media format of the source.\n   * @returns {void}\n   */\n  map(source: MediaSource, mediaFormat: ?MediaFormat) {\n    if (mediaFormat) {\n      switch (mediaFormat.name) {\n        case 'mp4':\n          this.progressive.push(source);\n          break;\n        case 'dash':\n          this.dash.push(source);\n          break;\n        case 'hls':\n          this.hls.push(source);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./entities/media-sources.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/entities/media-sources.js","//@flow\nimport {MediaEntryType} from '../k-provider/enums'\nimport MediaSources from './media-sources'\n\n/**\n * Media entry\n * @classdesc\n */\nexport default class MediaEntry {\n\n  /**\n   * @member - entry ID\n   * @type {string}\n   */\n  id: string;\n  /**\n   * @member - entry sources\n   * @type {MediaSources}\n   */\n  sources: MediaSources;\n  /**\n   * @member - entry duration\n   * @type {number}\n   */\n  duration: number;\n  /**\n   * @member - entry type\n   * @type {MediaEntryType}\n   */\n  type: MediaEntryType;\n  /**\n   * @member - entry metadata\n   * @type {Map<string,string>}\n   */\n  metaData: Map<string, string>;\n\n  /**\n   * @constructor\n   */\n  constructor() {\n    this.metaData = new Map();\n    this.type = MediaEntryType.Unknown;\n  }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./entities/media-entry.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/entities/media-entry.js","//@flow\n\nimport {Scheme} from '../k-provider/enums';\n\n/**\n * Drm data\n * @classdesc\n */\nexport default class Drm {\n\n  /**\n   * @member - license URL\n   * @type {string}\n   */\n  licenseUrl: string;\n  /**\n   * @member - drm scheme\n   * @type {Scheme}\n   */\n  scheme: Scheme;\n\n  /**\n   * @constructor\n   * @param {string} licenseUrl - the license URL\n   * @param {Scheme} scheme - the drm scheme\n   */\n  constructor(licenseUrl: string, scheme: Scheme) {\n    this.licenseUrl = licenseUrl;\n    this.scheme = scheme;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./entities/drm.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/entities/drm.js","//@flow\nimport {Enum} from 'enumify';\n\nexport class MediaFormat extends Enum {\n}\nMediaFormat.initEnum({\n  dash: {\n    get mimeType() {\n      return \"application/dash+xml\";\n    },\n    get pathExt() {\n      return \"mpd\";\n    }\n  },\n  hls: {\n    get mimeType() {\n      return \"application/x-mpegURL\";\n    },\n    get pathExt() {\n      return \"m3u8\";\n    }\n  },\n  wvm: {\n    get mimeType() {\n      return \"video/wvm\";\n    },\n    get pathExt() {\n      return \"wvm\";\n    }\n  },\n  mp4: {\n    get mimeType() {\n      return \"video/mp4\";\n    },\n    get pathExt() {\n      return \"mp4\";\n    }\n  },\n  mp3: {\n    get mimeType() {\n      return \"audio/mpeg\";\n    },\n    get pathExt() {\n      return \"mp3\";\n    }\n  }\n});\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./entities/media-format.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/entities/media-format.js","//@flow\nimport Drm from '../entities/drm'\n\n/**\n * Media source\n * @classdesc\n */\nexport default class MediaSource {\n  /**\n   * @member - media source ID\n   * @type {string}\n   */\n  id: string;\n  /**\n   * @member - media source URL\n   * @type {string}\n   */\n  url: string;\n  /**\n   * @member - media source mimetype\n   * @type {string}\n   */\n  mimetype: string;\n  /**\n   * @member - media source drm data\n   * @type {Array<Drm>}\n   */\n  drmData: Array<Drm>;\n\n  /**\n   * @constructor\n   */\n  constructor(){}\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./entities/media-source.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/entities/media-source.js","//@flow\nimport {Status} from '../../enums'\n\n/**\n * Ovp BE FlavorAsset\n * @classdesc\n */\nexport default class KalturaFlavorAsset {\n  /**\n   * @member - The ID of the Flavor Asset\n   * @type {string}\n   */\n  id: string;\n  /**\n   * @member -The Flavor Params used to create this Flavor Asset\n   * @type {string}\n   */\n  flavorParamsId: string;\n  /**\n   * @member -The file extension\n   * @type {string}\n   */\n  fileExt: string;\n  /**\n   * @member - The overall bitrate (in KBits) of the Flavor Asset\n   *  @type {string}\n   */\n  bitrate: number;\n  /**\n   * @member - The width of the Flavor Asset\n   * @type {number}\n   */\n  width: number;\n  /**\n   * @member - The height of the Flavor Asset\n   * @type {number}\n   */\n  height: number;\n  /**\n   * @member - The frame rate (in FPS) of the Flavor Asset\n   * @type {number}\n   */\n  frameRate: number;\n  /**\n   * @member - True if this Flavor Asset is the original source\n   * @type {number}\n   */\n  isOriginal: boolean;\n  /**\n   * @member - True if this Flavor Asset is playable in KDP\n   * @type {boolean}\n   */\n  isWeb: boolean;\n  /**\n   * @member - The container format\n   * @type {boolean}\n   */\n  containerFormat: string;\n  /**\n   *@member - The video codec\n   * @type {boolean}\n   */\n  videoCodecId: string;\n  /**\n   * @member - The status of the Flavor Asset\n   * @type {string}\n   */\n  status: Status;\n  /**\n   * @member - The language of the flavor asset\n   * @type {Status}\n   */\n  language: string;\n  /**\n   * @member - The label of the flavor asset\n   * @type {string}\n   */\n  label: string;\n\n  /**\n   * @constructor\n   * @param {Object} data The json response\n   */\n  constructor(data: any) {\n    this.id = data.id;\n    this.flavorParamsId = data.flavorParamsId;\n    this.fileExt = data.fileExt;\n    this.bitrate = data.bitrate;\n    this.width = data.width;\n    this.height = data.height;\n    this.id = data.id;\n    this.frameRate = data.frameRate;\n    this.isOriginal = data.isOriginal;\n    this.isWeb = data.isWeb;\n    this.containerFormat = data.containerFormat;\n    this.videoCodecId = data.videoCodecId;\n    this.status = data.status;\n    this.language = data.language;\n    this.label = data.label;\n  }\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-flavor-asset.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-flavor-asset.js","//@flow\nimport {EntryType, MediaType} from '../../enums'\n\n/**\n * Ovp BE MediaEntry\n * @classdesc\n */\nexport default class KalturaMediaEntry {\n  /**\n   * @member - The entry id\n   * @type {string}\n   */\n  id: string;\n  /**\n   * @member - Entry name (Min 1 chars)\n   * @type {string}\n   */\n  name: string;\n  /**\n   * @member - The URL used for playback. This is not the download URL.\n   * @type {string}\n   */\n  dataUrl: string;\n  /**\n   * @member - Comma separated flavor params ids that exists for this media entry\n   * @type {string}\n   */\n  flavorParamsIds: string;\n  /**\n   * @member - The entry duration\n   * @type {number}\n   */\n  duration: number;\n  /**\n   * @member - The type of the entry, this is auto filled by the derived entry object\n   * @type {EntryType}\n   */\n  type: EntryType;\n  /**\n   * @member - The type of the entry, this is auto filled by the derived entry object (Image, Audio etc.)\n   * @type {MediaType}\n   */\n  entryType: MediaType;\n\n  /**\n   * @constructor\n   * @param {Object} entry The json response\n   */\n  constructor(entry: Object) {\n    this.id = entry.id;\n    this.name = entry.name;\n    this.dataUrl = entry.dataUrl;\n    this.type = entry.type;\n    this.entryType = entry.mediaType;\n    this.flavorParamsIds = entry.flavorParamsIds;\n    this.duration = entry.duration;\n  }\n}\n\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-media-entry.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-media-entry.js","//@flow\nimport ServiceResult from '../../base-service-result'\nimport KalturaMetadata from './kaltura-metadata'\n\n/**\n * Ovp BE Metadata list response\n * @classdesc\n */\nexport default class KalturaMetadataListResponse extends ServiceResult {\n  totalCount: number;\n  /**\n   * @member -The mata data array\n   * @type {Array<KalturaMetadata>}\n   */\n  metas: Array<KalturaMetadata>;\n\n  /**\n   * @constructor\n   * @param {Object} responseObj The response\n   */\n  constructor(responseObj: Object) {\n    super(responseObj);\n    if (!this.hasError) {\n      this.totalCount = responseObj.totalCount;\n      if (this.totalCount > 0) {\n        this.metas = [];\n        responseObj.objects.map(meta => this.metas.push(new KalturaMetadata(meta)));\n      }\n\n    }\n  }\n}\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-metadata-list-response.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-metadata-list-response.js","//@flow\nimport ServiceResult from '../../base-service-result'\nimport KalturaAccessControlMessage from './kaltura-access-control-message'\nimport KalturaPlaybackSource from './kaltura-playback-source'\nimport KalturaRuleAction from './kaltura-rule-action'\nimport KalturaFlavorAsset from './kaltura-flavor-asset'\n\n/**\n * Ovp BE playback context response\n * @classdesc\n */\nexport default class KalturaPlaybackContext extends ServiceResult {\n  /**\n   * @member - The playback sources\n   * @type {Array<KalturaPlaybackSource>}\n   */\n  sources: Array<KalturaPlaybackSource> = [];\n  /**\n   * @member - Array of actions as received from the rules that invalidated\n   * @type {Array<KalturaRuleAction>}\n   */\n  actions: Array<KalturaRuleAction> = [];\n  /**\n   * @member - Array of actions as received from the rules that invalidated\n   * @type {Array<KalturaAccessControlMessage>}\n   */\n  messages: Array<KalturaAccessControlMessage> = [];\n  /**\n   * @member - The flavor assets\n   * @type {Array<KalturaFlavorAsset>}\n   */\n  flavorAssets: Array<KalturaFlavorAsset> = [];\n\n  /**\n   * @constructor\n   * @param {Object} response The response\n   */\n  constructor(response: Object) {\n    super(response);\n    if (!this.hasError) {\n\n      let messages = response.messages;\n      if (messages) {\n        messages.map(message => this.messages.push(new KalturaAccessControlMessage(message)));\n      }\n\n      let actions = response.actions;\n      if (actions) {\n        actions.map(action => this.actions.push(new KalturaRuleAction(action)));\n      }\n\n      let sources = response.sources;\n      if (sources) {\n        sources.map(source => this.sources.push(new KalturaPlaybackSource(source)));\n      }\n\n      let flavorAssets = response.flavorAssets;\n      if (flavorAssets) {\n        flavorAssets.map(flavor => this.flavorAssets.push(new KalturaFlavorAsset(flavor)));\n      }\n    }\n\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-playback-context.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-playback-context.js","//@flow\nimport KalturaDrmPlaybackPluginData from './kaltura-drm-playback-plugin-data'\n\n/**\n * Ovp BE playback source\n * @classdesc\n */\nexport default class KalturaPlaybackSource {\n  /**\n   * @member - source format according to delivery profile streamer type (applehttp, mpegdash etc.)\n   * @type {string}\n   */\n  format: string;\n  /**\n   * @member - delivery profile Id\n   * @type {string}\n   */\n  deliveryProfileId: string;\n  /**\n   * @member - The source URL\n   * @type {string}\n   */\n  url: string;\n  /**\n   * @member - comma separated string according to deliveryProfile media protocols ('http,https' etc.)\n   * @type {string}\n   */\n  protocols: string;\n  /**\n   * @member - comma separated string of flavor ids\n   * @type {string}\n   */\n  flavorIds: string;\n  /**\n   * @member - drm data object containing relevant license url ,scheme name and certificate\n   * @type {Array<KalturaDrmPlaybackPluginData>}\n   */\n  drm: Array<KalturaDrmPlaybackPluginData> = [];\n\n  /**\n   * @constructor\n   * @param {Object} source The response\n   */\n  constructor(source: Object) {\n    this.format = source.format;\n    this.deliveryProfileId = source.deliveryProfileId;\n    this.url = source.url;\n    this.protocols = source.protocols;\n    this.flavorIds = source.flavorIds;\n\n    if (source.drm) {\n      source.drm.map(drm => this.drm.push(new KalturaDrmPlaybackPluginData(drm)));\n    }\n\n\n  }\n\n  /**\n   * Checks if source has DRM data\n   * @function hasDrmData\n   * @returns {boolean} Is source has DRM\n   */\n  hasDrmData(): boolean {\n    return this.drm && this.drm.length > 0;\n  }\n\n  /**\n   * Checks if source has flavor IDs\n   * @function hasFlavorIds\n   * @returns {boolean} Is source ha flavor IDs\n   */\n  hasFlavorIds(): boolean {\n    return !!this.flavorIds && this.flavorIds.length > 0;\n  }\n\n  /**\n   * Returns source desired protocol if supported\n   * @param {string} protocol - the desired protocol for the source (base play url protocol)\n   * @returns {string} - protocol if protocol is in the protocols list - if not empty string returned\n   */\n  getProtocol(protocol: string): string {\n    let returnValue: string = \"\";\n    if (this.protocols && this.protocols.length > 0) {\n      let protocolsArr: Array<string> = this.protocols.split(\",\");\n      protocolsArr.forEach((p) => {\n        if (p == protocol) {\n          returnValue = p;\n        }\n      });\n    }\n    else if (protocol == \"http\") {\n      return protocol;\n    }\n    return returnValue;\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-playback-source.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-playback-source.js","'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.copyProperties = copyProperties;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar INITIALIZED = Symbol();\n\n/**\n * This is an abstract class that is not intended to be\n * used directly. Extend it to turn your class into an enum\n * (initialization is performed via `MyClass.initEnum()`).\n */\n\nvar Enum = exports.Enum = function () {\n    /**\n     * `initEnum()` closes the class. Then calling this constructor\n     * throws an exception.\n     * \n     * If your subclass has a constructor then you can control\n     * what properties are added to `this` via the argument you\n     * pass to `super()`. No arguments are fine, too.\n     */\n\n    function Enum() {\n        var instanceProperties = arguments.length <= 0 || arguments[0] === undefined ? undefined : arguments[0];\n\n        _classCallCheck(this, Enum);\n\n        // new.target would be better than this.constructor,\n        // but isn’t supported by Babel\n        if ({}.hasOwnProperty.call(this.constructor, INITIALIZED)) {\n            throw new Error('Enum classes can’t be instantiated');\n        }\n        if ((typeof instanceProperties === 'undefined' ? 'undefined' : _typeof(instanceProperties)) === 'object' && instanceProperties !== null) {\n            copyProperties(this, instanceProperties);\n        }\n    }\n    /**\n     * Set up the enum, close the class.\n     * \n     * @param arg Either an object whose properties provide the names\n     * and values (which must be mutable objects) of the enum constants.\n     * Or an Array whose elements are used as the names of the enum constants\n     * The values are create by instantiating the current class.\n     */\n\n    _createClass(Enum, [{\n        key: 'toString',\n\n        /**\n         * Default `toString()` method for enum constant.\n         */\n        value: function toString() {\n            return this.constructor.name + '.' + this.name;\n        }\n    }], [{\n        key: 'initEnum',\n        value: function initEnum(arg) {\n            Object.defineProperty(this, 'enumValues', {\n                value: [],\n                configurable: false,\n                writable: false,\n                enumerable: true\n            });\n            if (Array.isArray(arg)) {\n                this._enumValuesFromArray(arg);\n            } else {\n                this._enumValuesFromObject(arg);\n            }\n            Object.freeze(this.enumValues);\n            this[INITIALIZED] = true;\n            return this;\n        }\n    }, {\n        key: '_enumValuesFromArray',\n        value: function _enumValuesFromArray(arr) {\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = arr[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var key = _step.value;\n\n                    this._pushEnumValue(new this(), key);\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_enumValuesFromObject',\n        value: function _enumValuesFromObject(obj) {\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = Object.keys(obj)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var key = _step2.value;\n\n                    var value = new this(obj[key]);\n                    this._pushEnumValue(value, key);\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_pushEnumValue',\n        value: function _pushEnumValue(enumValue, name) {\n            enumValue.name = name;\n            enumValue.ordinal = this.enumValues.length;\n            Object.defineProperty(this, name, {\n                value: enumValue,\n                configurable: false,\n                writable: false,\n                enumerable: true\n            });\n            this.enumValues.push(enumValue);\n        }\n\n        /**\n         * Given the name of an enum constant, return its value.\n         */\n\n    }, {\n        key: 'enumValueOf',\n        value: function enumValueOf(name) {\n            return this.enumValues.find(function (x) {\n                return x.name === name;\n            });\n        }\n\n        /**\n         * Make enum classes iterable\n         */\n\n    }, {\n        key: Symbol.iterator,\n        value: function value() {\n            return this.enumValues[Symbol.iterator]();\n        }\n    }]);\n\n    return Enum;\n}();\n\nfunction copyProperties(target, source) {\n    // Ideally, we’d use Reflect.ownKeys() here,\n    // but I don’t want to depend on a polyfill\n    var _iteratorNormalCompletion3 = true;\n    var _didIteratorError3 = false;\n    var _iteratorError3 = undefined;\n\n    try {\n        for (var _iterator3 = Object.getOwnPropertyNames(source)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n            var key = _step3.value;\n\n            var desc = Object.getOwnPropertyDescriptor(source, key);\n            Object.defineProperty(target, key, desc);\n        }\n    } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                _iterator3.return();\n            }\n        } finally {\n            if (_didIteratorError3) {\n                throw _iteratorError3;\n            }\n        }\n    }\n\n    return target;\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/enumify/lib/enumify.js\n// module id = 18\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///~/enumify/lib/enumify.js","//@flow\nimport OvpService from '../services/ovp-service'\nimport MultiRequestBuilder from '../../multi-request-builder'\nimport {MultiRequestResult} from '../../multi-request-builder'\n\n/**\n * Data loaders manager\n * @classdesc\n */\nexport default class DataLoaderManager {\n  /**\n   * @member - Lodaers response map index\n   * @type {Map<string,Array<number>>}\n   * @private\n   * @static\n   */\n  static _loadersResponseMap: Map<string, Array<number>> = new Map();\n  /**\n   * @member - Loaders multi request\n   * @type {MultiRequestBuilder}\n   * @private\n   */\n  _multiRequest: MultiRequestBuilder;\n  /**\n   * @member - Loaders multi response\n   * @type {MultiRequestResult}\n   * @private\n   */\n  _multiResponse: MultiRequestResult;\n  /**\n   * @member - Loaders to execute\n   * @type {Map<string,Function>}\n   * @private\n   */\n  _loaders: Map<string, ILoader> = new Map();\n\n  /**\n   * @constructor\n   * @param {string} partnerID Then partner ID\n   * @param {string} ks The ks\n   */\n  constructor(partnerID: number, ks: string = \"\") {\n    this._multiRequest = OvpService.getMultirequest(ks, partnerID);\n  }\n\n  /**\n   * Add loader too execution loaders map\n   * @function\n   * @param {Function} loader Loader to add\n   * @param {Object} params Loader params\n   * @returns {void}\n   */\n  add(loader: typeof ILoader, params: Object): void {\n    let execution_loader = new loader(params);\n    if (execution_loader.isValid()) {\n      this._loaders.set(loader.name, execution_loader);\n      //Get the start index from the multiReqeust before adding current execution_loader requests\n      let startIndex = this._multiRequest.requests.length;\n      //Get the requests\n      let requests = execution_loader.requests;\n      //Add requests to muktiRequest queue\n      requests.forEach((request) => {\n        this._multiRequest.add(request);\n      });\n      //Create range array of current execution_loader requests\n      let executionLoaderResponseMap = Array.from(new Array(requests.length), (val, index) => index + startIndex);\n      //Add to map\n      DataLoaderManager._loadersResponseMap.set(loader.name, executionLoaderResponseMap);\n    }\n  }\n\n  /**\n   * Get data from all loaders using multi request\n   * @function\n   * @returns {Promise} Promise\n   */\n  fetchData(): Promise<any> {\n    return new Promise((resolve, reject) => {\n      this._multiRequest.execute()\n        .then(response => {\n            this._multiResponse = response;\n            if (!response.success) {\n              reject(response);\n            }\n            else {\n              let preparedData: Object = this.prepareData(response);\n              if (preparedData.success) {\n                resolve(this._loaders);\n              }\n              else {\n                reject({success: false, data: preparedData.error});\n              }\n            }\n          },\n          err => {\n            reject(err);\n          });\n    });\n  }\n\n  prepareData(response: MultiRequestResult): Object {\n    this._loaders.forEach(function (loader, name) {\n      let loaderDataIndexes = DataLoaderManager._loadersResponseMap.get(name);\n      try {\n        if (loaderDataIndexes != null) {\n          loader.response = (response.results.slice(loaderDataIndexes[0], loaderDataIndexes[loaderDataIndexes.length - 1] + 1));\n        }\n      }\n      catch (err) {\n        return {success: false, error: err};\n      }\n    });\n    return {success: true, data: this._loaders};\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/loaders/data-loader-manager.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/loaders/data-loader-manager.js","//@flow\n\nimport RequestBuilder from '../../request-builder'\nimport BaseEntryService from '../services/base-entry-service'\nimport MetaDataService from '../services/meta-data-service'\nimport Configuration from '../config'\nimport KalturaPlaybackContext from '../response-types/kaltura-playback-context'\nimport KalturaMetadataListResponse from '../response-types/kaltura-metadata-list-response'\nimport KalturaBaseEntryListResponse from '../response-types/kaltura-base-entry-list-response'\n\nconst config = Configuration.get();\n\n/**\n * Media entry loader\n * @classdesc\n */\nexport default class MediaEntryLoader implements ILoader {\n  static get name(): string {\n    return \"media\";\n  }\n\n  _entryId: string;\n  _requests: Array<RequestBuilder>;\n  _response: any = {};\n\n  /**\n   * @constructor\n   * @param {Object} params loader params\n   */\n  constructor(params: Object) {\n    this.requests = this.buildRequests(params);\n    this._entryId = params.entryId;\n  }\n\n  set requests(requests: Array<RequestBuilder>) {\n    this._requests = requests;\n  }\n\n  get requests(): Array<RequestBuilder> {\n    return this._requests;\n  }\n\n  set response(response: any) {\n    let mediaEntryResponse: KalturaBaseEntryListResponse = new KalturaBaseEntryListResponse(response[0].data);\n    this._response.entry = mediaEntryResponse.entries[0];\n    this._response.playBackContextResult = new KalturaPlaybackContext(response[1].data);\n    this._response.metadataListResult = new KalturaMetadataListResponse(response[2].data);\n  }\n\n  get response(): any {\n    return this._response;\n  }\n\n  /**\n   * Builds loader requests\n   * @function\n   * @param {Object} params Requests parameters\n   * @returns {RequestBuilder} The request builder\n   * @static\n   */\n  buildRequests(params: Object): Array<RequestBuilder> {\n    let requests: Array<RequestBuilder> = [];\n    requests.push(BaseEntryService.list(config.beUrl, params.ks, params.entryId));\n    requests.push(BaseEntryService.getPlaybackContext(config.beUrl, params.ks, params.entryId));\n    requests.push(MetaDataService.list(config.beUrl, params.ks, params.entryId));\n    return requests;\n  }\n\n  /**\n   * Loader validation function\n   * @function\n   * @returns {boolean} Is valid\n   */\n  isValid(): boolean {\n    return !!this._entryId;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/loaders/media-entry-loader.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/loaders/media-entry-loader.js","//@flow\nimport SessionService from '../services/session-service'\nimport Configuration from '../config'\nimport RequestBuilder from '../../request-builder'\n\nconst config = Configuration.get();\n/**\n * Media entry loader\n * @classdesc\n */\nexport default class SessionLoader implements ILoader {\n  static get name(): string {\n    return \"session\";\n  }\n\n  /**\n   * @member - partner ID\n   * @type {number}\n   * @private\n   */\n  _partnerId: number;\n  _requests: Array<RequestBuilder>;\n  _response: any = {};\n\n  /**\n   * @constructor\n   * @param {Object} params loader params\n   */\n  constructor(params: Object) {\n    this.requests = this.buildRequests(params);\n    this._partnerId = params.partnerId;\n  }\n\n  set requests(requests: Array<RequestBuilder>) {\n    this._requests = requests;\n  }\n\n  get requests(): Array<RequestBuilder> {\n    return this._requests;\n  }\n\n  set response(response: any) {\n    this._response.ks = response[0].data.ks;\n  }\n\n  get response(): any {\n    return this._response.ks;\n  }\n\n  /**\n   * Builds loader requests\n   * @function\n   * @param {Object} params Requests parameters\n   * @returns {RequestBuilder} The request builder\n   * @static\n   */\n  buildRequests(params: Object): Array<RequestBuilder> {\n    let requests: Array<RequestBuilder> = [];\n    requests.push(SessionService.anonymousSession(config.beUrl, params.partnerId));\n    return requests;\n  }\n\n  /**\n   * Loader validation function\n   * @function\n   * @returns {boolean} Is valid\n   */\n  isValid(): boolean {\n    return !!this._partnerId;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/loaders/session-loader.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/loaders/session-loader.js","//@flow\nimport UiConfService from '../services/ui-conf-service'\nimport KalturaUiConfResponse from '../response-types/kaltura-ui-conf-response'\nimport Configuration from '../config'\nimport RequestBuilder from '../../request-builder'\n\nconst config = Configuration.get();\n\nexport default class UiConfigLoader implements ILoader {\n  static get name(): string {\n    return \"uiConf\";\n  }\n\n  /**\n   * @member - uiConf ID\n   * @type {number}\n   * @private\n   */\n  _uiConfId: number;\n  _requests: Array<RequestBuilder>;\n  _response: any = {};\n\n  /**\n   * @constructor\n   * @param {Object} params loader params\n   */\n  constructor(params: Object) {\n    this.requests = this.buildRequests(params);\n    this._uiConfId = params.uiConfId;\n  }\n\n  set requests(requests: Array<RequestBuilder>) {\n    this._requests = requests;\n  }\n\n  get requests(): Array<RequestBuilder> {\n    return this._requests;\n  }\n\n  set response(response: any) {\n    this._response.uiConf = new KalturaUiConfResponse(response[0].data);\n  }\n\n  get response(): any {\n    if (this._response != null && this._response.uiConf != null && this._response.uiConf.config != null)\n      try {\n        return JSON.parse(this._response.uiConf.config).plugins;\n      }\n      catch (err) {\n        return null;\n      }\n    else\n      return null;\n  }\n\n  /**\n   * Builds loader requests\n   * @function\n   * @param {Object} params Requests parameters\n   * @returns {RequestBuilder} The request builder\n   * @static\n   */\n  buildRequests(params: Object): Array<RequestBuilder> {\n    let requests: Array<RequestBuilder> = [];\n    requests.push(UiConfService.get(config.beUrl, params.ks, params.uiConfId));\n    return requests;\n  }\n\n  /**\n   * Loader validation function\n   * @function\n   * @returns {boolean} Is valid\n   */\n  isValid(): boolean {\n    return !!this._uiConfId;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/loaders/ui-config-loader.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/loaders/ui-config-loader.js","//@flow\nimport KalturaMediaEntry from './response-types/kaltura-media-entry'\nimport KalturaPlaybackContext from './response-types/kaltura-playback-context'\nimport KalturaPlaybackSource from './response-types/kaltura-playback-source'\nimport KalturaFlavorAsset from './response-types/kaltura-flavor-asset'\nimport KalturaMetadataListResponse from './response-types/kaltura-metadata-list-response'\nimport PlaySourceUrlBuilder from \"./play-source-url-builder\"\nimport XmlParser from '../xml-parser'\nimport {MediaEntryType, EntryType, MediaType} from '../enums'\nimport Logger from '../../util/logger'\nimport Configuration from './config'\nimport {MediaFormat} from '../../entities/media-format'\nimport MediaEntry from '../../entities/media-entry'\nimport Drm from '../../entities/drm'\nimport MediaSource from '../../entities/media-source'\nimport MediaSources from '../../entities/media-sources'\n\nconst config = Configuration.get();\n/**\n * @constant\n */\nconst logger = Logger.get(\"OvpProvider\");\n\n/**\n * @constant\n * @type {Map<string, MediaFormat>}\n */\nconst SUPPORTED_FORMATS: Map<string, MediaFormat> = new Map([\n  [\"mpegdash\", MediaFormat.dash],\n  [\"applehttp\", MediaFormat.hls],\n  [\"url\", MediaFormat.mp4]\n]);\n\n/**\n * Ovp provider parser\n * @classdesc\n */\nexport default class ProviderParser {\n\n  /**\n   * Returns parsed media entry by given OVP response objects\n   * @function getMediaEntry\n   * @param {string} ks The ks\n   * @param {number} partnerID The partner ID\n   * @param {number} uiConfId The uiConf ID\n   * @param {any} mediaEntryResponse The media entry response\n   * @returns {MediaEntry} The media entry\n   * @static\n   */\n  static getMediaEntry(ks: string, partnerID: number, uiConfId: number, mediaEntryResponse: any): MediaEntry {\n    let mediaEntry: MediaEntry = new MediaEntry();\n    let entry = mediaEntryResponse.entry;\n    let playbackContext = mediaEntryResponse.playBackContextResult;\n    let metadataList = mediaEntryResponse.metadataListResult;\n    let kalturaSources: Array<KalturaPlaybackSource> = playbackContext.sources;\n    let sources: MediaSources = new MediaSources();\n    if (kalturaSources && kalturaSources.length > 0) {\n      kalturaSources.forEach((source) => {\n        let parsedSource = this.parseSource(source, ks, partnerID, uiConfId, entry, playbackContext);\n        let mediaFormat = SUPPORTED_FORMATS.get(source.format);\n        sources.map(parsedSource, mediaFormat);\n      });\n    }\n\n    mediaEntry.sources = sources;\n\n    let metadata: Map<string, string> = this.parseMetaData(metadataList);\n    mediaEntry.metaData = metadata;\n    mediaEntry.id = entry.id;\n    mediaEntry.duration = entry.duration;\n\n    let type: MediaEntryType = MediaEntryType.Unknown;\n\n    switch (entry.entryType) {\n      case MediaType.IMAGE.value:\n        type = MediaEntryType.Image;\n        break;\n      case MediaType.AUDIO.value:\n        type = MediaEntryType.Audio;\n        break;\n      default:\n        switch (entry.type) {\n          case EntryType.MEDIA_CLIP.value:\n            type = MediaEntryType.Vod;\n            break;\n          case EntryType.LIVE_STREAM.value:\n          case EntryType.LIVE_CHANNEL.value:\n            type = MediaEntryType.Live;\n            break;\n          default:\n            type = MediaEntryType.Unknown;\n        }\n    }\n    mediaEntry.type = type;\n\n    return mediaEntry;\n  }\n\n  /**\n   *\n   * @param {KalturaPlaybackSource} source The source\n   * @param {string} ks The ks\n   * @param {number} partnerID The partner ID\n   * @param {number} uiConfId The uiConf ID\n   * @param {KalturaMediaEntry} entry The entry\n   * @param {KalturaPlaybackContext} playbackContext The playback context\n   * @returns {MediaSource}  The parsed media source\n   * @static\n   */\n  static parseSource(source: KalturaPlaybackSource, ks: string, partnerID: number, uiConfId: number, entry: KalturaMediaEntry, playbackContext: KalturaPlaybackContext): MediaSource {\n    let playUrl: string = \"\";\n    let mediaFormat = SUPPORTED_FORMATS.get(source.format);\n    let mediaSource: MediaSource = new MediaSource();\n    // in case playbackSource doesn't have flavors we don't need to build the url and we'll use the provided one.\n    if (source.hasFlavorIds()) {\n      let splittedUrl: Array<string> = config.baseUrl.split(\"/\");\n      let baseProtocol: string;\n      if (splittedUrl && splittedUrl.length > 0) {\n        baseProtocol = splittedUrl[0].substring(0, splittedUrl[0].length - 1);\n      }\n      else {\n        baseProtocol = \"http\";\n      }\n\n      let extension: string = \"\";\n      if (!mediaFormat) {\n        let flavorIdsArr = source.flavorIds.split(\",\");\n        let flavors: Array<KalturaFlavorAsset> = playbackContext.flavorAssets.filter(flavor => flavorIdsArr.indexOf(flavor.id) != -1);\n        if (flavors && flavors.length > 0) {\n          extension = flavors[0].fileExt;\n        }\n      }\n      else {\n        extension = mediaFormat.pathExt;\n        mediaSource.mimetype = mediaFormat.mimeType;\n      }\n\n      playUrl = PlaySourceUrlBuilder.build({\n        entryId: entry.id,\n        flavorIds: source.flavorIds,\n        format: source.format,\n        ks: ks,\n        partnerId: partnerID,\n        uiConfId: uiConfId,\n        extension: extension,\n        protocol: source.getProtocol(baseProtocol)\n      });\n\n    }\n    else {\n      playUrl = source.url;\n    }\n\n    if (playUrl == \"\") {\n      logger.error(`failed to create play url from source, discarding source: (${entry.id}_${source.deliveryProfileId}), ${source.format}.`);\n      return mediaSource;\n    }\n\n    mediaSource.url = playUrl;\n    mediaSource.id = entry.id + \"_\" + source.deliveryProfileId + \",\" + source.format;\n    if (source.hasDrmData()) {\n      let drmParams: Array<Drm> = [];\n      source.drm.forEach((drm) => {\n        drmParams.push(new Drm(drm.licenseURL, drm.scheme));\n      });\n      mediaSource.drmData = drmParams;\n    }\n    return mediaSource;\n  }\n\n  /**\n   * Ovp metadata parser\n   * @function parseMetaData\n   * @param {KalturaMetadataListResponse} metadataList The metadata list\n   * @returns {Map<string,string>} Parsed metadata\n   * @static\n   */\n  static parseMetaData(metadataList: KalturaMetadataListResponse): Map<string, string> {\n    let metadata: Object = {};\n    if (metadataList && metadataList.metas && metadataList.metas.length > 0) {\n      metadataList.metas.forEach((meta) => {\n        let metaXml: Object;\n        let domParser: DOMParser = new DOMParser();\n        meta.xml = meta.xml.replace(/\\r?\\n|\\r/g, \"\");\n        meta.xml = meta.xml.replace(/>\\s*/g, '>');\n        meta.xml = meta.xml.replace(/>\\s*/g, '>');\n        metaXml = domParser.parseFromString(meta.xml, 'text/xml');\n        let metasObj: Object = XmlParser.xmlToJson(metaXml);\n        let metaKeys = Object.keys(metasObj.metadata);\n        metaKeys.forEach((key) => {\n          metadata[key] = metasObj.metadata[key][\"#text\"];\n        })\n\n      })\n    }\n    return metadata;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/provider-parser.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/provider-parser.js","//@flow\nimport Logger from '../../util/logger'\nimport ProviderParser from './provider-parser'\nimport DataLoaderManager from './loaders/data-loader-manager'\nimport MediaEntryLoader from './loaders/media-entry-loader'\nimport SessionLoader from './loaders/session-loader'\nimport UiConfigLoader from './loaders/ui-config-loader'\nimport Configuration from './config'\nimport MediaEntry from '../../entities/media-entry'\nimport MediaSources from '../../entities/media-sources'\n/**\n * @constant\n */\nconst logger = Logger.get(\"OvpProvider\");\n\ntype playerConfig = {\n  id: string,\n  session: Object,\n  sources: MediaSources,\n  duration: number,\n  type: string,\n  metadata: Object,\n  plugins: Object\n};\n\n/**\n * Ovp provider\n * @classdesc\n */\nexport class OvpProvider {\n  /**\n   * @member - ks\n   * @type {string}\n   */\n  ks: string;\n  /**\n   * @member - partner ID\n   * @type {number}\n   */\n  partnerID: number;\n  /**\n   * @member - is anonymous\n   * @type {boolean}\n   * @private\n   */\n  _isAnonymous: boolean;\n  /**\n   * @member - uiConf ID\n   * @type {number}\n   * @private\n   */\n  _uiConfId: number;\n  /**\n   * @member - Data loader\n   * @type {DataLoaderManager}\n   * @private\n   */\n  _dataLoader: DataLoaderManager;\n\n  /**\n   * @constructor\n   * @param {number} partnerID The partner ID\n   * @param {string} [ks=\"\"]  The provider ks (has empty string as default value)\n   * @param {Object} [config]  The provider config(optional)\n   */\n  constructor(partnerID: number, ks: string = \"\", config?: Object) {\n    this.partnerID = partnerID;\n    this.ks = ks;\n    this._isAnonymous = !this.ks;\n    Configuration.set(config);\n  }\n\n  /**\n   * Returns player json configuration\n   * @function getConfig\n   * @param {string} entryId The entry ID\n   * @param {number} uiConfId The uiConf ID\n   * @returns {Promise} The provider config object as promise\n   */\n  getConfig(entryId?: string, uiConfId?: number): Promise<Object> {\n    if (uiConfId != null) {\n      this._uiConfId = uiConfId;\n    }\n    this._dataLoader = new DataLoaderManager(this.partnerID, this.ks);\n    return new Promise((resolve, reject) => {\n      if (this.validateParams(entryId, uiConfId)) {\n        let ks: string = this.ks;\n        if (this._isAnonymous) {\n          ks = \"{1:result:ks}\";\n          this._dataLoader.add(SessionLoader, {partnerId: this.partnerID});\n        }\n        this._dataLoader.add(MediaEntryLoader, {entryId: entryId, ks: ks});\n        this._dataLoader.add(UiConfigLoader, {uiConfId: uiConfId, ks: ks});\n        this._dataLoader.fetchData()\n          .then(response => {\n              resolve(this.parseDataFromResponse(response));\n            },\n            err => {\n              reject(err);\n            });\n      }\n      else {\n        reject({success: false, data: \"Missing mandatory parameter\"});\n      }\n    });\n  }\n\n  /**\n   * Parses BE data to json configuration object\n   * @function parseDataFromResponse\n   * @param {Map<string,Function>} data The data to parse\n   * @returns {Object} The parsed config object\n   */\n  parseDataFromResponse(data: Map<string, Function>): Object {\n    logger.debug(\"Data parsing started\");\n    let config: playerConfig = {\n      id: \"\",\n      session: {\n        partnerID: this.partnerID,\n        uiConfID: this._uiConfId,\n      },\n      sources: new MediaSources(),\n      duration: 0,\n      type: \"Unknown\",\n      metadata: {},\n      plugins: {}\n    };\n    if (data != null) {\n      if (data.has(SessionLoader.name)) {\n        let sessionLoader = data.get(SessionLoader.name);\n        if (sessionLoader != null && sessionLoader.response != null) {\n          this.ks = sessionLoader.response;\n          this._isAnonymous = !this.ks;\n          config.session.ks = this.ks;\n        }\n      }\n      if (data.has(UiConfigLoader.name)) {\n        let uiConfLoader = data.get(UiConfigLoader.name);\n        let pluginsJson: Object = {};\n        if (uiConfLoader != null) {\n          pluginsJson = uiConfLoader.response;\n        }\n        config.plugins = pluginsJson;\n      }\n      if (data.has(MediaEntryLoader.name)) {\n        let mediaLoader = data.get(MediaEntryLoader.name);\n        if (mediaLoader != null && mediaLoader.response != null) {\n          let mediaEntry: MediaEntry = ProviderParser.getMediaEntry(this.ks, this.partnerID, this._uiConfId, mediaLoader.response);\n          config.id = mediaEntry.id;\n          config.sources = mediaEntry.sources;\n          config.duration = mediaEntry.duration;\n          config.type = mediaEntry.type.name;\n          config.metadata = mediaEntry.metaData;\n        }\n      }\n    }\n    logger.debug(\"Data parsing finished\", config);\n    return (config);\n  }\n\n  /**\n   * Parameters validation function\n   * @param {string} entryId The entry ID\n   * @param {number} uiConfId The uiConfID\n   * @returns {boolean} Is valid params\n   */\n  validateParams(entryId?: string, uiConfId?: number): boolean {\n    return !!entryId || !!uiConfId;\n  }\n\n}\n\nexport default OvpProvider;\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/ovp-provider.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/ovp-provider.js","//@flow\nimport Configuration from './config'\n\nconst config = Configuration.get();\n\n/**\n * Media source url builder\n * @classdesc\n */\nexport default class PlaySourceUrlBuilder {\n\n  /**\n   * Returns source url by given url params\n   * @function build\n   * @param {Object} urlParams The params\n   * @returns {string} The URL\n   * @static\n   */\n  static build(urlParams: Object): string {\n    let baseUrl: string = config.baseUrl;\n    let partnerId: string = urlParams.partnerId;\n    let entryId: string = urlParams.entryId;\n    let ks: string = urlParams.ks;\n    let uiConfId: string = urlParams.uiConfId;\n    let format: string = urlParams.format;\n    let protocol: string = urlParams.protocol;\n    let extension: string = urlParams.extension;\n    let flavorIds: string = urlParams.flavorIds;\n\n    if (baseUrl == \"\" && partnerId == \"\" && entryId == \"\" && extension == \"\" && format == \"\") {\n      return \"\";\n    }\n\n    let playUrl = baseUrl;\n    if (!PlaySourceUrlBuilder.endsWith(baseUrl, \"/\")) {\n      playUrl += \"/\";\n    }\n    playUrl += \"p/\" + partnerId + \"/sp/\" + partnerId + \"00\" + \"/playManifest/entryId/\" + entryId + \"/protocol/\" + protocol + \"/format/\" + format;\n\n    if (flavorIds != \"\") {\n      playUrl += \"/falvorIds/\" + flavorIds;\n    }\n    else if (uiConfId != \"\") {\n      playUrl += \"/uiConfId/\" + uiConfId;\n    }\n\n    if (this.ks != \"\") {\n      playUrl += \"/ks/\" + ks;\n    }\n\n    playUrl += \"/a.\" + extension;\n\n    if (uiConfId && flavorIds != \"\") {\n      playUrl += \"?uiConfId=.\" + uiConfId;\n    }\n\n    return playUrl;\n  }\n\n  /**\n   * Checks if given string end with search string\n   * @param {string} string The given string\n   * @param {string} searchString The string to search\n   * @returns {boolean} Is  given string end with search string\n   */\n  static endsWith(string: string, searchString: string): boolean {\n    if (typeof string !== 'string') {\n      return false;\n    }\n    if (typeof searchString !== 'string') {\n      return false;\n    }\n\n    return string.indexOf(searchString, string.length - searchString.length) != -1;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/play-source-url-builder.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/play-source-url-builder.js","//@flow\n\n/**\n * Ovp BE access control message\n * @classdesc\n */\nexport default class KalturaAccessControlMessage {\n  /**\n   * @member - The access control message\n   * @type {string}\n   */\n  message: string;\n  /**\n   *  @member - The access control message code\n   * @@type {string}\n   */\n  code: string;\n\n  /**\n   * @constructor\n   * @param {Object} data The json response\n   */\n  constructor(data: Object) {\n    this.message = data.message;\n    this.code = data.code\n  }\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-access-control-message.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-access-control-message.js","//@flow\nimport ServiceResult from '../../base-service-result'\nimport KalturaMediaEntry from './kaltura-media-entry'\n\n/**\n * Ovp BE BaseEntryList service response\n * @classdesc\n */\nexport default class KalturaBaseEntryListResponse extends ServiceResult {\n  /**\n   * @member - The total count\n   * @type {number}\n   */\n  totalCount: number;\n  /**\n   * @member - The entries\n   * @type {Array<KalturaMediaEntry>}\n   */\n  entries: Array<KalturaMediaEntry>;\n\n  /**\n   * @constructor\n   * @param {Object} responseObj The json response\n   */\n  constructor(responseObj: Object) {\n    super(responseObj);\n    if (!this.hasError) {\n      this.totalCount = responseObj.totalCount;\n      if (this.totalCount > 0) {\n        this.entries = [];\n        responseObj.objects.map(entry => this.entries.push(new KalturaMediaEntry(entry)));\n      }\n    }\n  }\n}\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-base-entry-list-response.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-base-entry-list-response.js","//@flow\nimport {Scheme} from '../../enums'\n\n/**\n * Ovp BE DrmPlaybackPluginData\n * @classdesc\n */\nexport default class KalturaDrmPlaybackPluginData {\n  /**\n   * @member - The drm scheme\n   * @type {Scheme}\n   */\n  scheme: Scheme;\n\n  /**\n   * @member - The license URL\n   * @type {string}\n   */\n  licenseURL: string;\n\n  /**\n   * @constructor\n   * @param {Object} drm The json response\n   */\n  constructor(drm: any) {\n    this.scheme = drm.scheme;\n    this.licenseURL = drm.licenseURL;\n  }\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-drm-playback-plugin-data.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-drm-playback-plugin-data.js","//@flow\nimport {MetadataObjectType, MetadataStatus} from '../../enums'\n\n/**\n * Ovp BE Metadata\n * @classdesc\n */\nexport default class KalturaMetadata {\n  id: number;\n  metadataProfileId: number;\n  metadataProfileVersion: number;\n  metadataObjectType: MetadataObjectType;\n  objectId: string;\n  version: number;\n  created: Date;\n  updated: Date;\n  status: MetadataStatus;\n  /**\n   * @member - The Metadata xml - represented as XML string\n   * @type {string}\n   */\n  xml: string;\n\n  /**\n   * @constructor\n   * @param {Object} data The response\n   */\n  constructor(data: Object) {\n    this.id = data.id;\n    this.metadataProfileId = data.metadataProfileId;\n    this.metadataProfileVersion = data.metadataProfileVersion;\n    this.metadataProfileId = data.metadataProfileId;\n    this.metadataObjectType = data.metadataObjectType;\n    this.objectId = data.objectId;\n    this.version = data.version;\n    this.created = new Date(0);\n    this.created.setUTCSeconds(data.createdAt);\n    this.updated = new Date(0);\n    this.updated.setUTCSeconds(data.updatedAt);\n    this.status = data.status;\n    this.xml = data.xml;\n\n  }\n}\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-metadata.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-metadata.js","//@flow\nimport {KalturaRuleActionType} from '../../enums'\n\n/**\n * Ovp BE rule action\n * @classdesc\n */\nexport default class KalturaRuleAction {\n  /**\n   * @member - The type of the action\n   * @type {KalturaRuleActionType}\n   */\n  type: KalturaRuleActionType;\n\n  /**\n   * @constructor\n   * @param {Object} data The response\n   */\n  constructor(data: Object) {\n    this.type = data.type;\n  }\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-rule-action.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-rule-action.js","//@flow\nimport ServiceResult from '../../base-service-result'\nimport {UIConfType, UIConfCreationMode} from '../../enums';\n\n/**\n * Ovp BE Ui config response\n * @classdesc\n */\nexport default class KalturaUiConfResponse extends ServiceResult {\n  /**\n   * @member -Name of the uiConf, this is not a primary key\n   * @type {string}\n   */\n  name: string;\n  /**\n   * @member -Name of the uiConf, this is not a primary key\n   * @type {string}\n   */\n  description: string;\n  objTypeAsString: string;\n  width: number;\n  height: number;\n  htmlParams: string;\n  swfUrl: string;\n  confFilePath: string;\n  confFile: string;\n  confFileFeatures: string;\n  name: string;\n  /**\n   * @member -plugins configuration represented as Json string\n   * @type {string}\n   */\n  config: string;\n  confVars: string;\n  useCdn: boolean;\n  tags: string;\n  swfUrlVersion: string;\n  created: Date;\n  updated: Date;\n  html5Url: string;\n  version: string;\n  partnerTags: string;\n  objType: UIConfType;\n  creationMode: UIConfCreationMode;\n\n  /**\n   * @constructor\n   * @param {Object} data The json response\n   */\n  constructor(data: Object) {\n    super(data);\n    if (!this.hasError) {\n      this.name = data.name;\n\n      this.description = data.description;\n      this.objTypeAsString = data.objTypeAsString;\n      this.width = data.width;\n      this.height = data.height;\n      this.htmlParams = data.htmlParams;\n      this.swfUrl = data.swfUrl;\n      this.confFilePath = data.confFilePath;\n      this.confFile = data.confFile;\n      this.confFileFeatures = data.confFileFeatures;\n      this.config = data.config;\n      this.confVars = data.confVars;\n      this.useCdn = data.useCdn;\n      this.tags = data.tags;\n      this.swfUrlVersion = data.swfUrlVersion;\n      this.created = new Date(0);\n      this.created.setUTCSeconds(data.createdAt);\n      this.updated = new Date(0);\n      this.updated.setUTCSeconds(data.updatedAt);\n      this.html5Url = data.description;\n      this.version = data.description;\n      this.partnerTags = data.description;\n      this.objType = data.description;\n      this.creationMode = data.description;\n\n    }\n  }\n}\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/response-types/kaltura-ui-conf-response.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/response-types/kaltura-ui-conf-response.js","//@flow\nimport OvpService from './ovp-service'\nimport RequestBuilder from '../../request-builder'\n\nconst SERVICE_NAME: string = \"baseEntry\";\n\n/**\n * Ovp BaseEntry service methods\n * @classdesc\n */\nexport default class BaseEntryService extends OvpService {\n\n  /**\n   * Creates an instance of RequestBuilder for baseentry.getPlaybackContext\n   * @function getPlaybackContext\n   * @param {string} baseUrl The service base URL\n   * @param {string} ks The ks\n   * @param {string} entryId The entry ID\n   * @returns {RequestBuilder} The request builder\n   * @static\n   */\n  static getPlaybackContext(baseUrl: string, ks: string, entryId: string): RequestBuilder {\n    let request = new RequestBuilder();\n    request.service = SERVICE_NAME;\n    request.action = \"getPlaybackContext\";\n    request.method = \"POST\";\n    request.baseUrl = baseUrl;\n    request.tag = \"baseEntry-getPlaybackContext\";\n    let contextDataParams = {objectType: \"KalturaContextDataParams\", flavorTags: \"all\"};\n    let params = {entryId: entryId, ks: ks, contextDataParams: contextDataParams};\n    request.params = params;\n    return request;\n  }\n\n  /**\n   * Creates an instance of RequestBuilder for baseentry.list\n   * @function list\n   * @param {string} baseUrl The base URL\n   * @param {string} ks The ks\n   * @param {string} entryId The entry ID\n   * @returns {RequestBuilder} The request builder\n   * @static\n   */\n  static list(baseUrl: string, ks: string, entryId: string): RequestBuilder {\n    let request = new RequestBuilder();\n    request.service = SERVICE_NAME;\n    request.action = \"list\";\n    request.method = \"POST\";\n    request.baseUrl = baseUrl;\n    request.tag = \"list\";\n    request.params = BaseEntryService.getEntryListReqParams(entryId, ks);\n    return request;\n  }\n\n  /**\n   * Gets  baseentry.list service params\n   * @function getEntryListReqParams\n   * @param {string} entryId The entry ID\n   * @param {string} ks The ks\n   * @returns {{ks: string, filter: {redirectFromEntryId: string}, responseProfile: {fields: string, type: number}}} The service params object\n   * @static\n   */\n  static getEntryListReqParams(entryId: string, ks: string): any {\n    let filterParams = {redirectFromEntryId: entryId};\n    let responseProfileParams = {\n      fields: \"id,name,dataUrl,duration,msDuration,flavorParamsIds,mediaType,type,tags\",\n      type: 1\n    };\n    return {ks: ks, filter: filterParams, responseProfile: responseProfileParams};\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/services/base-entry-service.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/services/base-entry-service.js","//@flow\n\nimport OvpService from './ovp-service'\nimport RequestBuilder from '../../request-builder'\n\nconst SERVICE_NAME: string = \"metadata_metadata\";\n\n/**\n * Ovp metadata_metadata service methods\n * @classdesc\n */\nexport default class MetaDataService extends OvpService {\n  /**\n   * Creates an instance of RequestBuilder for metadata_metadata.list\n   * @function getPlaybackContext\n   * @param {string} baseUrl The service base URL\n   * @param {string} ks The ks\n   * @param {string} entryId The entry ID\n   * @returns {RequestBuilder} The request builder\n   * @static\n   */\n  static list(baseUrl: string, ks: string, entryId: string) {\n    let request = new RequestBuilder();\n    request.service = SERVICE_NAME;\n    request.action = \"list\";\n    request.method = \"POST\";\n    request.baseUrl = baseUrl;\n    request.tag = \"metadata_metadata-list\";\n    let filter = {objectType: \"KalturaMetadataFilter\", objectIdEqual: entryId, metadataObjectTypeEqual: \"1\"};\n    let params = {filter: filter, ks: ks};\n    request.params = params;\n    return request;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/services/meta-data-service.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/services/meta-data-service.js","//@flow\n\nimport OvpService from './ovp-service'\nimport RequestBuilder from '../../request-builder'\n\nconst SERVICE_NAME: string = \"session\";\n\n/**\n * Ovp session service methods\n * @classdesc\n */\nexport default class SessionService extends OvpService {\n  /**\n   * Creates an instance of RequestBuilder for session.startWidgetSession\n   * @function anonymousSession\n   * @param {string} baseUrl The service base URL\n   * @param {string} partnerId The partner ID\n   * @returns {RequestBuilder} The request builder\n   * @static\n   */\n  static anonymousSession(baseUrl: string, partnerId: number) {\n    let request = new RequestBuilder();\n    request.service = SERVICE_NAME;\n    request.action = \"startWidgetSession\";\n    request.method = \"POST\";\n    request.baseUrl = baseUrl;\n    request.tag = \"session-startWidget\";\n    request.params = {widgetId: \"_\" + partnerId};\n    return request;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/services/session-service.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/services/session-service.js","//@flow\n\nimport OvpService from './ovp-service'\nimport RequestBuilder from '../../request-builder'\n\nconst SERVICE_NAME: string = \"uiconf\";\n\n/**\n * Ovp uiconf service methods\n * @classdesc\n */\nexport default class UiConfService extends OvpService {\n  /**\n   * Creates an instance of RequestBuilder for uiconf.get\n   * @function get\n   * @param {string} baseUrl The service base URL\n   * @param {string} ks The ks\n   * @param {string} uiConfID The uiConf ID\n   * @returns {RequestBuilder} The request builder\n   * @static\n   */\n  static get(baseUrl: string, ks: string, uiConfID: number) {\n    let request = new RequestBuilder();\n    request.service = SERVICE_NAME;\n    request.action = \"get\";\n    request.method = \"POST\";\n    request.baseUrl = baseUrl;\n    request.tag = \"uiconf-get\";\n    let responseProfileParams = {\n      fields: \"config\",\n      type: 1\n    };\n    request.params = {id: uiConfID, responseProfile: responseProfileParams, ks: ks};\n    return request;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/ovp/services/ui-conf-service.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/ovp/services/ui-conf-service.js","//@flow\n\n/**\n * Xml parser\n * @classdesc\n */\nexport default class XmlParser {\n  /**\n   * Parses xml string to json object\n   * @param {string} xml The xml to parse\n   * @returns {{}} The parsed xml as Json object\n   * @static\n   */\n  static xmlToJson(xml: Object) {\n    let obj = {};\n    if (xml.nodeType == 1) {\n      if (xml.attributes.length > 0) {\n        obj[\"@attributes\"] = {};\n        for (let j = 0; j < xml.attributes.length; j++) {\n          let attribute = xml.attributes.item(j);\n          obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\n        }\n      }\n    }\n    else if (xml.nodeType == 3) {\n      obj = xml.nodeValue;\n    }\n    if (xml.hasChildNodes()) {\n      for (let i = 0; i < xml.childNodes.length; i++) {\n        let item = xml.childNodes.item(i);\n        let nodeName = item.nodeName;\n        if (typeof (obj[nodeName]) == \"undefined\") {\n          obj[nodeName] = this.xmlToJson(item);\n        }\n        else {\n          if (typeof (obj[nodeName].push) == \"undefined\") {\n            let old = obj[nodeName];\n            obj[nodeName] = [];\n            obj[nodeName].push(old);\n          }\n          obj[nodeName].push(this.xmlToJson(item));\n        }\n      }\n    }\n    return obj;\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./k-provider/xml-parser.js\n\n\n// WEBPACK FOOTER //\n// webpack:///providers/k-provider/xml-parser.js","// @flow\n\n// Import core\nimport * as Playkit from 'playkit-js';\n\n// Import OVP and OTT providers\nimport OvpProvider from 'playkit-js-providers/dist/ovpProvider';\n\n// Import UI\nimport PlaykitUI from 'playkit-js-ui';\nimport '../node_modules/playkit-js-ui/src/styles/style.css';\n\n// Import media source adapters\nimport 'playkit-js-hls';\nimport 'playkit-js-dash';\n\nimport setup from './setup'\n// TODO: Import plugins\n\nexport {Playkit, OvpProvider, PlaykitUI, setup};\n\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"playkit-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"playkit-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PlaykitJsUi\"] = factory(require(\"playkit-js\"));\n\telse\n\t\troot[\"PlaykitJsUi\"] = factory(root[\"Playkit\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_48__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 28);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 22c3c46a80b1c7885159\n\n\n// WEBPACK FOOTER //\n// webpack:/ui/webpack/bootstrap 22c3c46a80b1c7885159","!function() {\n    'use strict';\n    function VNode() {}\n    function h(nodeName, attributes) {\n        var lastSimple, child, simple, i, children = EMPTY_CHILDREN;\n        for (i = arguments.length; i-- > 2; ) stack.push(arguments[i]);\n        if (attributes && null != attributes.children) {\n            if (!stack.length) stack.push(attributes.children);\n            delete attributes.children;\n        }\n        while (stack.length) if ((child = stack.pop()) && void 0 !== child.pop) for (i = child.length; i--; ) stack.push(child[i]); else {\n            if (child === !0 || child === !1) child = null;\n            if (simple = 'function' != typeof nodeName) if (null == child) child = ''; else if ('number' == typeof child) child = String(child); else if ('string' != typeof child) simple = !1;\n            if (simple && lastSimple) children[children.length - 1] += child; else if (children === EMPTY_CHILDREN) children = [ child ]; else children.push(child);\n            lastSimple = simple;\n        }\n        var p = new VNode();\n        p.nodeName = nodeName;\n        p.children = children;\n        p.attributes = null == attributes ? void 0 : attributes;\n        p.key = null == attributes ? void 0 : attributes.key;\n        if (void 0 !== options.vnode) options.vnode(p);\n        return p;\n    }\n    function extend(obj, props) {\n        for (var i in props) obj[i] = props[i];\n        return obj;\n    }\n    function cloneElement(vnode, props) {\n        return h(vnode.nodeName, extend(extend({}, vnode.attributes), props), arguments.length > 2 ? [].slice.call(arguments, 2) : vnode.children);\n    }\n    function enqueueRender(component) {\n        if (!component.__d && (component.__d = !0) && 1 == items.push(component)) (options.debounceRendering || setTimeout)(rerender);\n    }\n    function rerender() {\n        var p, list = items;\n        items = [];\n        while (p = list.pop()) if (p.__d) renderComponent(p);\n    }\n    function isSameNodeType(node, vnode, hydrating) {\n        if ('string' == typeof vnode || 'number' == typeof vnode) return void 0 !== node.splitText;\n        if ('string' == typeof vnode.nodeName) return !node._componentConstructor && isNamedNode(node, vnode.nodeName); else return hydrating || node._componentConstructor === vnode.nodeName;\n    }\n    function isNamedNode(node, nodeName) {\n        return node.__n === nodeName || node.nodeName.toLowerCase() === nodeName.toLowerCase();\n    }\n    function getNodeProps(vnode) {\n        var props = extend({}, vnode.attributes);\n        props.children = vnode.children;\n        var defaultProps = vnode.nodeName.defaultProps;\n        if (void 0 !== defaultProps) for (var i in defaultProps) if (void 0 === props[i]) props[i] = defaultProps[i];\n        return props;\n    }\n    function createNode(nodeName, isSvg) {\n        var node = isSvg ? document.createElementNS('http://www.w3.org/2000/svg', nodeName) : document.createElement(nodeName);\n        node.__n = nodeName;\n        return node;\n    }\n    function removeNode(node) {\n        if (node.parentNode) node.parentNode.removeChild(node);\n    }\n    function setAccessor(node, name, old, value, isSvg) {\n        if ('className' === name) name = 'class';\n        if ('key' === name) ; else if ('ref' === name) {\n            if (old) old(null);\n            if (value) value(node);\n        } else if ('class' === name && !isSvg) node.className = value || ''; else if ('style' === name) {\n            if (!value || 'string' == typeof value || 'string' == typeof old) node.style.cssText = value || '';\n            if (value && 'object' == typeof value) {\n                if ('string' != typeof old) for (var i in old) if (!(i in value)) node.style[i] = '';\n                for (var i in value) node.style[i] = 'number' == typeof value[i] && IS_NON_DIMENSIONAL.test(i) === !1 ? value[i] + 'px' : value[i];\n            }\n        } else if ('dangerouslySetInnerHTML' === name) {\n            if (value) node.innerHTML = value.__html || '';\n        } else if ('o' == name[0] && 'n' == name[1]) {\n            var useCapture = name !== (name = name.replace(/Capture$/, ''));\n            name = name.toLowerCase().substring(2);\n            if (value) {\n                if (!old) node.addEventListener(name, eventProxy, useCapture);\n            } else node.removeEventListener(name, eventProxy, useCapture);\n            (node.__l || (node.__l = {}))[name] = value;\n        } else if ('list' !== name && 'type' !== name && !isSvg && name in node) {\n            setProperty(node, name, null == value ? '' : value);\n            if (null == value || value === !1) node.removeAttribute(name);\n        } else {\n            var ns = isSvg && name !== (name = name.replace(/^xlink\\:?/, ''));\n            if (null == value || value === !1) if (ns) node.removeAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase()); else node.removeAttribute(name); else if ('function' != typeof value) if (ns) node.setAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase(), value); else node.setAttribute(name, value);\n        }\n    }\n    function setProperty(node, name, value) {\n        try {\n            node[name] = value;\n        } catch (e) {}\n    }\n    function eventProxy(e) {\n        return this.__l[e.type](options.event && options.event(e) || e);\n    }\n    function flushMounts() {\n        var c;\n        while (c = mounts.pop()) {\n            if (options.afterMount) options.afterMount(c);\n            if (c.componentDidMount) c.componentDidMount();\n        }\n    }\n    function diff(dom, vnode, context, mountAll, parent, componentRoot) {\n        if (!diffLevel++) {\n            isSvgMode = null != parent && void 0 !== parent.ownerSVGElement;\n            hydrating = null != dom && !('__preactattr_' in dom);\n        }\n        var ret = idiff(dom, vnode, context, mountAll, componentRoot);\n        if (parent && ret.parentNode !== parent) parent.appendChild(ret);\n        if (!--diffLevel) {\n            hydrating = !1;\n            if (!componentRoot) flushMounts();\n        }\n        return ret;\n    }\n    function idiff(dom, vnode, context, mountAll, componentRoot) {\n        var out = dom, prevSvgMode = isSvgMode;\n        if (null == vnode) vnode = '';\n        if ('string' == typeof vnode) {\n            if (dom && void 0 !== dom.splitText && dom.parentNode && (!dom._component || componentRoot)) {\n                if (dom.nodeValue != vnode) dom.nodeValue = vnode;\n            } else {\n                out = document.createTextNode(vnode);\n                if (dom) {\n                    if (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n                    recollectNodeTree(dom, !0);\n                }\n            }\n            out.__preactattr_ = !0;\n            return out;\n        }\n        if ('function' == typeof vnode.nodeName) return buildComponentFromVNode(dom, vnode, context, mountAll);\n        isSvgMode = 'svg' === vnode.nodeName ? !0 : 'foreignObject' === vnode.nodeName ? !1 : isSvgMode;\n        if (!dom || !isNamedNode(dom, String(vnode.nodeName))) {\n            out = createNode(String(vnode.nodeName), isSvgMode);\n            if (dom) {\n                while (dom.firstChild) out.appendChild(dom.firstChild);\n                if (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n                recollectNodeTree(dom, !0);\n            }\n        }\n        var fc = out.firstChild, props = out.__preactattr_ || (out.__preactattr_ = {}), vchildren = vnode.children;\n        if (!hydrating && vchildren && 1 === vchildren.length && 'string' == typeof vchildren[0] && null != fc && void 0 !== fc.splitText && null == fc.nextSibling) {\n            if (fc.nodeValue != vchildren[0]) fc.nodeValue = vchildren[0];\n        } else if (vchildren && vchildren.length || null != fc) innerDiffNode(out, vchildren, context, mountAll, hydrating || null != props.dangerouslySetInnerHTML);\n        diffAttributes(out, vnode.attributes, props);\n        isSvgMode = prevSvgMode;\n        return out;\n    }\n    function innerDiffNode(dom, vchildren, context, mountAll, isHydrating) {\n        var j, c, vchild, child, originalChildren = dom.childNodes, children = [], keyed = {}, keyedLen = 0, min = 0, len = originalChildren.length, childrenLen = 0, vlen = vchildren ? vchildren.length : 0;\n        if (0 !== len) for (var i = 0; i < len; i++) {\n            var _child = originalChildren[i], props = _child.__preactattr_, key = vlen && props ? _child._component ? _child._component.__k : props.key : null;\n            if (null != key) {\n                keyedLen++;\n                keyed[key] = _child;\n            } else if (props || (void 0 !== _child.splitText ? isHydrating ? _child.nodeValue.trim() : !0 : isHydrating)) children[childrenLen++] = _child;\n        }\n        if (0 !== vlen) for (var i = 0; i < vlen; i++) {\n            vchild = vchildren[i];\n            child = null;\n            var key = vchild.key;\n            if (null != key) {\n                if (keyedLen && void 0 !== keyed[key]) {\n                    child = keyed[key];\n                    keyed[key] = void 0;\n                    keyedLen--;\n                }\n            } else if (!child && min < childrenLen) for (j = min; j < childrenLen; j++) if (void 0 !== children[j] && isSameNodeType(c = children[j], vchild, isHydrating)) {\n                child = c;\n                children[j] = void 0;\n                if (j === childrenLen - 1) childrenLen--;\n                if (j === min) min++;\n                break;\n            }\n            child = idiff(child, vchild, context, mountAll);\n            if (child && child !== dom) if (i >= len) dom.appendChild(child); else if (child !== originalChildren[i]) if (child === originalChildren[i + 1]) removeNode(originalChildren[i]); else dom.insertBefore(child, originalChildren[i] || null);\n        }\n        if (keyedLen) for (var i in keyed) if (void 0 !== keyed[i]) recollectNodeTree(keyed[i], !1);\n        while (min <= childrenLen) if (void 0 !== (child = children[childrenLen--])) recollectNodeTree(child, !1);\n    }\n    function recollectNodeTree(node, unmountOnly) {\n        var component = node._component;\n        if (component) unmountComponent(component); else {\n            if (null != node.__preactattr_ && node.__preactattr_.ref) node.__preactattr_.ref(null);\n            if (unmountOnly === !1 || null == node.__preactattr_) removeNode(node);\n            removeChildren(node);\n        }\n    }\n    function removeChildren(node) {\n        node = node.lastChild;\n        while (node) {\n            var next = node.previousSibling;\n            recollectNodeTree(node, !0);\n            node = next;\n        }\n    }\n    function diffAttributes(dom, attrs, old) {\n        var name;\n        for (name in old) if ((!attrs || null == attrs[name]) && null != old[name]) setAccessor(dom, name, old[name], old[name] = void 0, isSvgMode);\n        for (name in attrs) if (!('children' === name || 'innerHTML' === name || name in old && attrs[name] === ('value' === name || 'checked' === name ? dom[name] : old[name]))) setAccessor(dom, name, old[name], old[name] = attrs[name], isSvgMode);\n    }\n    function collectComponent(component) {\n        var name = component.constructor.name;\n        (components[name] || (components[name] = [])).push(component);\n    }\n    function createComponent(Ctor, props, context) {\n        var inst, list = components[Ctor.name];\n        if (Ctor.prototype && Ctor.prototype.render) {\n            inst = new Ctor(props, context);\n            Component.call(inst, props, context);\n        } else {\n            inst = new Component(props, context);\n            inst.constructor = Ctor;\n            inst.render = doRender;\n        }\n        if (list) for (var i = list.length; i--; ) if (list[i].constructor === Ctor) {\n            inst.__b = list[i].__b;\n            list.splice(i, 1);\n            break;\n        }\n        return inst;\n    }\n    function doRender(props, state, context) {\n        return this.constructor(props, context);\n    }\n    function setComponentProps(component, props, opts, context, mountAll) {\n        if (!component.__x) {\n            component.__x = !0;\n            if (component.__r = props.ref) delete props.ref;\n            if (component.__k = props.key) delete props.key;\n            if (!component.base || mountAll) {\n                if (component.componentWillMount) component.componentWillMount();\n            } else if (component.componentWillReceiveProps) component.componentWillReceiveProps(props, context);\n            if (context && context !== component.context) {\n                if (!component.__c) component.__c = component.context;\n                component.context = context;\n            }\n            if (!component.__p) component.__p = component.props;\n            component.props = props;\n            component.__x = !1;\n            if (0 !== opts) if (1 === opts || options.syncComponentUpdates !== !1 || !component.base) renderComponent(component, 1, mountAll); else enqueueRender(component);\n            if (component.__r) component.__r(component);\n        }\n    }\n    function renderComponent(component, opts, mountAll, isChild) {\n        if (!component.__x) {\n            var rendered, inst, cbase, props = component.props, state = component.state, context = component.context, previousProps = component.__p || props, previousState = component.__s || state, previousContext = component.__c || context, isUpdate = component.base, nextBase = component.__b, initialBase = isUpdate || nextBase, initialChildComponent = component._component, skip = !1;\n            if (isUpdate) {\n                component.props = previousProps;\n                component.state = previousState;\n                component.context = previousContext;\n                if (2 !== opts && component.shouldComponentUpdate && component.shouldComponentUpdate(props, state, context) === !1) skip = !0; else if (component.componentWillUpdate) component.componentWillUpdate(props, state, context);\n                component.props = props;\n                component.state = state;\n                component.context = context;\n            }\n            component.__p = component.__s = component.__c = component.__b = null;\n            component.__d = !1;\n            if (!skip) {\n                rendered = component.render(props, state, context);\n                if (component.getChildContext) context = extend(extend({}, context), component.getChildContext());\n                var toUnmount, base, childComponent = rendered && rendered.nodeName;\n                if ('function' == typeof childComponent) {\n                    var childProps = getNodeProps(rendered);\n                    inst = initialChildComponent;\n                    if (inst && inst.constructor === childComponent && childProps.key == inst.__k) setComponentProps(inst, childProps, 1, context, !1); else {\n                        toUnmount = inst;\n                        component._component = inst = createComponent(childComponent, childProps, context);\n                        inst.__b = inst.__b || nextBase;\n                        inst.__u = component;\n                        setComponentProps(inst, childProps, 0, context, !1);\n                        renderComponent(inst, 1, mountAll, !0);\n                    }\n                    base = inst.base;\n                } else {\n                    cbase = initialBase;\n                    toUnmount = initialChildComponent;\n                    if (toUnmount) cbase = component._component = null;\n                    if (initialBase || 1 === opts) {\n                        if (cbase) cbase._component = null;\n                        base = diff(cbase, rendered, context, mountAll || !isUpdate, initialBase && initialBase.parentNode, !0);\n                    }\n                }\n                if (initialBase && base !== initialBase && inst !== initialChildComponent) {\n                    var baseParent = initialBase.parentNode;\n                    if (baseParent && base !== baseParent) {\n                        baseParent.replaceChild(base, initialBase);\n                        if (!toUnmount) {\n                            initialBase._component = null;\n                            recollectNodeTree(initialBase, !1);\n                        }\n                    }\n                }\n                if (toUnmount) unmountComponent(toUnmount);\n                component.base = base;\n                if (base && !isChild) {\n                    var componentRef = component, t = component;\n                    while (t = t.__u) (componentRef = t).base = base;\n                    base._component = componentRef;\n                    base._componentConstructor = componentRef.constructor;\n                }\n            }\n            if (!isUpdate || mountAll) mounts.unshift(component); else if (!skip) {\n                flushMounts();\n                if (component.componentDidUpdate) component.componentDidUpdate(previousProps, previousState, previousContext);\n                if (options.afterUpdate) options.afterUpdate(component);\n            }\n            if (null != component.__h) while (component.__h.length) component.__h.pop().call(component);\n            if (!diffLevel && !isChild) flushMounts();\n        }\n    }\n    function buildComponentFromVNode(dom, vnode, context, mountAll) {\n        var c = dom && dom._component, originalComponent = c, oldDom = dom, isDirectOwner = c && dom._componentConstructor === vnode.nodeName, isOwner = isDirectOwner, props = getNodeProps(vnode);\n        while (c && !isOwner && (c = c.__u)) isOwner = c.constructor === vnode.nodeName;\n        if (c && isOwner && (!mountAll || c._component)) {\n            setComponentProps(c, props, 3, context, mountAll);\n            dom = c.base;\n        } else {\n            if (originalComponent && !isDirectOwner) {\n                unmountComponent(originalComponent);\n                dom = oldDom = null;\n            }\n            c = createComponent(vnode.nodeName, props, context);\n            if (dom && !c.__b) {\n                c.__b = dom;\n                oldDom = null;\n            }\n            setComponentProps(c, props, 1, context, mountAll);\n            dom = c.base;\n            if (oldDom && dom !== oldDom) {\n                oldDom._component = null;\n                recollectNodeTree(oldDom, !1);\n            }\n        }\n        return dom;\n    }\n    function unmountComponent(component) {\n        if (options.beforeUnmount) options.beforeUnmount(component);\n        var base = component.base;\n        component.__x = !0;\n        if (component.componentWillUnmount) component.componentWillUnmount();\n        component.base = null;\n        var inner = component._component;\n        if (inner) unmountComponent(inner); else if (base) {\n            if (base.__preactattr_ && base.__preactattr_.ref) base.__preactattr_.ref(null);\n            component.__b = base;\n            removeNode(base);\n            collectComponent(component);\n            removeChildren(base);\n        }\n        if (component.__r) component.__r(null);\n    }\n    function Component(props, context) {\n        this.__d = !0;\n        this.context = context;\n        this.props = props;\n        this.state = this.state || {};\n    }\n    function render(vnode, parent, merge) {\n        return diff(merge, vnode, {}, !1, parent, !1);\n    }\n    var options = {};\n    var stack = [];\n    var EMPTY_CHILDREN = [];\n    var IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n    var items = [];\n    var mounts = [];\n    var diffLevel = 0;\n    var isSvgMode = !1;\n    var hydrating = !1;\n    var components = {};\n    extend(Component.prototype, {\n        setState: function(state, callback) {\n            var s = this.state;\n            if (!this.__s) this.__s = extend({}, s);\n            extend(s, 'function' == typeof state ? state(s, this.props) : state);\n            if (callback) (this.__h = this.__h || []).push(callback);\n            enqueueRender(this);\n        },\n        forceUpdate: function(callback) {\n            if (callback) (this.__h = this.__h || []).push(callback);\n            renderComponent(this, 2);\n        },\n        render: function() {}\n    });\n    var preact = {\n        h: h,\n        createElement: h,\n        cloneElement: cloneElement,\n        Component: Component,\n        render: render,\n        rerender: rerender,\n        options: options\n    };\n    if ('undefined' != typeof module) module.exports = preact; else self.preact = preact;\n}();\n//# sourceMappingURL=preact.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/preact/dist/preact.js\n// module id = 0\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/preact/dist/preact.js","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('preact'), require('redux')) :\n\ttypeof define === 'function' && define.amd ? define(['preact', 'redux'], factory) :\n\t(global.preactRedux = factory(global.preact,global.Redux));\n}(this, (function (preact,redux) {\n\nvar Children = {\n\tonly: function only(children) {\n\t\treturn children && children[0] || null;\n\t}\n};\n\nfunction proptype() {}\nproptype.isRequired = proptype;\n\nvar PropTypes = {\n\telement: proptype,\n\tfunc: proptype,\n\tshape: function shape() {\n\t\treturn proptype;\n\t},\n\tinstanceOf: function instanceOf() {\n\t\treturn proptype;\n\t}\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n};\n\n\n\n\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\n\n\n\n\n\n\n\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n\n\n\n\n\n\n\nvar objectWithoutProperties = function (obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n};\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n\nvar set = function set(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\n// encapsulates the subscription logic for connecting a component to the redux store, as\n// well as nesting subscriptions of descendant components, so that we can ensure the\n// ancestor components re-render before descendants\n\nvar CLEARED = null;\nvar nullListeners = {\n  notify: function notify() {}\n};\n\nfunction createListenerCollection() {\n  // the current/next pattern is copied from redux's createStore code.\n  // TODO: refactor+expose that code to be reusable here?\n  var current = [];\n  var next = [];\n\n  return {\n    clear: function clear() {\n      next = CLEARED;\n      current = CLEARED;\n    },\n    notify: function notify() {\n      var listeners = current = next;\n      for (var i = 0; i < listeners.length; i++) {\n        listeners[i]();\n      }\n    },\n    subscribe: function subscribe(listener) {\n      var isSubscribed = true;\n      if (next === current) next = current.slice();\n      next.push(listener);\n\n      return function unsubscribe() {\n        if (!isSubscribed || current === CLEARED) return;\n        isSubscribed = false;\n\n        if (next === current) next = current.slice();\n        next.splice(next.indexOf(listener), 1);\n      };\n    }\n  };\n}\n\nvar Subscription = function () {\n  function Subscription(store, parentSub) {\n    classCallCheck(this, Subscription);\n\n    this.store = store;\n    this.parentSub = parentSub;\n    this.unsubscribe = null;\n    this.listeners = nullListeners;\n  }\n\n  Subscription.prototype.addNestedSub = function addNestedSub(listener) {\n    this.trySubscribe();\n    return this.listeners.subscribe(listener);\n  };\n\n  Subscription.prototype.notifyNestedSubs = function notifyNestedSubs() {\n    this.listeners.notify();\n  };\n\n  Subscription.prototype.isSubscribed = function isSubscribed() {\n    return Boolean(this.unsubscribe);\n  };\n\n  Subscription.prototype.trySubscribe = function trySubscribe() {\n    if (!this.unsubscribe) {\n      // this.onStateChange is set by connectAdvanced.initSubscription()\n      this.unsubscribe = this.parentSub ? this.parentSub.addNestedSub(this.onStateChange) : this.store.subscribe(this.onStateChange);\n\n      this.listeners = createListenerCollection();\n    }\n  };\n\n  Subscription.prototype.tryUnsubscribe = function tryUnsubscribe() {\n    if (this.unsubscribe) {\n      this.unsubscribe();\n      this.unsubscribe = null;\n      this.listeners.clear();\n      this.listeners = nullListeners;\n    }\n  };\n\n  return Subscription;\n}();\n\nvar storeShape = PropTypes.shape({\n  subscribe: PropTypes.func.isRequired,\n  dispatch: PropTypes.func.isRequired,\n  getState: PropTypes.func.isRequired\n});\n\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n    /* eslint-disable no-empty */\n  } catch (e) {}\n  /* eslint-enable no-empty */\n}\n\nvar didWarnAboutReceivingStore = false;\nfunction warnAboutReceivingStore() {\n  if (didWarnAboutReceivingStore) {\n    return;\n  }\n  didWarnAboutReceivingStore = true;\n\n  warning('<Provider> does not support changing `store` on the fly. ' + 'It is most likely that you see this error because you updated to ' + 'Redux 2.x and React Redux 2.x which no longer hot reload reducers ' + 'automatically. See https://github.com/reactjs/react-redux/releases/' + 'tag/v2.0.0 for the migration instructions.');\n}\n\nvar Provider = function (_Component) {\n  inherits(Provider, _Component);\n\n  Provider.prototype.getChildContext = function getChildContext() {\n    return { store: this.store, storeSubscription: null };\n  };\n\n  function Provider(props, context) {\n    classCallCheck(this, Provider);\n\n    var _this = possibleConstructorReturn(this, _Component.call(this, props, context));\n\n    _this.store = props.store;\n    return _this;\n  }\n\n  Provider.prototype.render = function render() {\n    return Children.only(this.props.children);\n  };\n\n  return Provider;\n}(preact.Component);\n\n{\n  Provider.prototype.componentWillReceiveProps = function (nextProps) {\n    var store = this.store;\n    var nextStore = nextProps.store;\n\n\n    if (store !== nextStore) {\n      warnAboutReceivingStore();\n    }\n  };\n}\n\nProvider.childContextTypes = {\n  store: storeShape.isRequired,\n  storeSubscription: PropTypes.instanceOf(Subscription)\n};\nProvider.displayName = 'Provider';\n\n/**\n * Copyright 2015, Yahoo! Inc.\n * Copyrights licensed under the New BSD License. See the accompanying LICENSE file for terms.\n */\nvar REACT_STATICS = {\n    childContextTypes: true,\n    contextTypes: true,\n    defaultProps: true,\n    displayName: true,\n    getDefaultProps: true,\n    mixins: true,\n    propTypes: true,\n    type: true\n};\n\nvar KNOWN_STATICS = {\n    name: true,\n    length: true,\n    prototype: true,\n    caller: true,\n    arguments: true,\n    arity: true\n};\n\nvar isGetOwnPropertySymbolsAvailable = typeof Object.getOwnPropertySymbols === 'function';\n\nvar index = function hoistNonReactStatics(targetComponent, sourceComponent, customStatics) {\n    if (typeof sourceComponent !== 'string') {\n        // don't hoist over string (html) components\n        var keys = Object.getOwnPropertyNames(sourceComponent);\n\n        /* istanbul ignore else */\n        if (isGetOwnPropertySymbolsAvailable) {\n            keys = keys.concat(Object.getOwnPropertySymbols(sourceComponent));\n        }\n\n        for (var i = 0; i < keys.length; ++i) {\n            if (!REACT_STATICS[keys[i]] && !KNOWN_STATICS[keys[i]] && (!customStatics || !customStatics[keys[i]])) {\n                try {\n                    targetComponent[keys[i]] = sourceComponent[keys[i]];\n                } catch (error) {}\n            }\n        }\n    }\n\n    return targetComponent;\n};\n\nvar invariant = function () {}\n\nvar hotReloadingVersion = 0;\nfunction connectAdvanced(\n/*\n  selectorFactory is a func that is responsible for returning the selector function used to\n  compute new props from state, props, and dispatch. For example:\n     export default connectAdvanced((dispatch, options) => (state, props) => ({\n      thing: state.things[props.thingId],\n      saveThing: fields => dispatch(actionCreators.saveThing(props.thingId, fields)),\n    }))(YourComponent)\n   Access to dispatch is provided to the factory so selectorFactories can bind actionCreators\n  outside of their selector as an optimization. Options passed to connectAdvanced are passed to\n  the selectorFactory, along with displayName and WrappedComponent, as the second argument.\n   Note that selectorFactory is responsible for all caching/memoization of inbound and outbound\n  props. Do not use connectAdvanced directly without memoizing results between calls to your\n  selector, otherwise the Connect component will re-render on every state or props change.\n*/\nselectorFactory) {\n  var _contextTypes, _childContextTypes;\n\n  var _ref = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n  var _ref$getDisplayName = _ref.getDisplayName;\n  var getDisplayName = _ref$getDisplayName === undefined ? function (name) {\n    return 'ConnectAdvanced(' + name + ')';\n  } : _ref$getDisplayName;\n  var _ref$methodName = _ref.methodName;\n  var methodName = _ref$methodName === undefined ? 'connectAdvanced' : _ref$methodName;\n  var _ref$renderCountProp = _ref.renderCountProp;\n  var renderCountProp = _ref$renderCountProp === undefined ? undefined : _ref$renderCountProp;\n  var _ref$shouldHandleStat = _ref.shouldHandleStateChanges;\n  var shouldHandleStateChanges = _ref$shouldHandleStat === undefined ? true : _ref$shouldHandleStat;\n  var _ref$storeKey = _ref.storeKey;\n  var storeKey = _ref$storeKey === undefined ? 'store' : _ref$storeKey;\n  var _ref$withRef = _ref.withRef;\n  var withRef = _ref$withRef === undefined ? false : _ref$withRef;\n  var connectOptions = objectWithoutProperties(_ref, ['getDisplayName', 'methodName', 'renderCountProp', 'shouldHandleStateChanges', 'storeKey', 'withRef']);\n\n  var subscriptionKey = storeKey + 'Subscription';\n  var version = hotReloadingVersion++;\n\n  var contextTypes = (_contextTypes = {}, _contextTypes[storeKey] = storeShape, _contextTypes[subscriptionKey] = PropTypes.instanceOf(Subscription), _contextTypes);\n  var childContextTypes = (_childContextTypes = {}, _childContextTypes[subscriptionKey] = PropTypes.instanceOf(Subscription), _childContextTypes);\n\n  return function wrapWithConnect(WrappedComponent) {\n    invariant(typeof WrappedComponent == 'function', 'You must pass a component to the function returned by ' + ('connect. Instead received ' + WrappedComponent));\n\n    var wrappedComponentName = WrappedComponent.displayName || WrappedComponent.name || 'Component';\n\n    var displayName = getDisplayName(wrappedComponentName);\n\n    var selectorFactoryOptions = _extends({}, connectOptions, {\n      getDisplayName: getDisplayName,\n      methodName: methodName,\n      renderCountProp: renderCountProp,\n      shouldHandleStateChanges: shouldHandleStateChanges,\n      storeKey: storeKey,\n      withRef: withRef,\n      displayName: displayName,\n      wrappedComponentName: wrappedComponentName,\n      WrappedComponent: WrappedComponent\n    });\n\n    var Connect = function (_Component) {\n      inherits(Connect, _Component);\n\n      function Connect(props, context) {\n        classCallCheck(this, Connect);\n\n        var _this = possibleConstructorReturn(this, _Component.call(this, props, context));\n\n        _this.version = version;\n        _this.state = {};\n        _this.renderCount = 0;\n        _this.store = _this.props[storeKey] || _this.context[storeKey];\n        _this.parentSub = props[subscriptionKey] || context[subscriptionKey];\n\n        _this.setWrappedInstance = _this.setWrappedInstance.bind(_this);\n\n        invariant(_this.store, 'Could not find \"' + storeKey + '\" in either the context or ' + ('props of \"' + displayName + '\". ') + 'Either wrap the root component in a <Provider>, ' + ('or explicitly pass \"' + storeKey + '\" as a prop to \"' + displayName + '\".'));\n\n        // make sure `getState` is properly bound in order to avoid breaking\n        // custom store implementations that rely on the store's context\n        _this.getState = _this.store.getState.bind(_this.store);\n\n        _this.initSelector();\n        _this.initSubscription();\n        return _this;\n      }\n\n      Connect.prototype.getChildContext = function getChildContext() {\n        var _ref2;\n\n        return _ref2 = {}, _ref2[subscriptionKey] = this.subscription || this.parentSub, _ref2;\n      };\n\n      Connect.prototype.componentDidMount = function componentDidMount() {\n        if (!shouldHandleStateChanges) return;\n\n        // componentWillMount fires during server side rendering, but componentDidMount and\n        // componentWillUnmount do not. Because of this, trySubscribe happens during ...didMount.\n        // Otherwise, unsubscription would never take place during SSR, causing a memory leak.\n        // To handle the case where a child component may have triggered a state change by\n        // dispatching an action in its componentWillMount, we have to re-run the select and maybe\n        // re-render.\n        this.subscription.trySubscribe();\n        this.selector.run(this.props);\n        if (this.selector.shouldComponentUpdate) this.forceUpdate();\n      };\n\n      Connect.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n        this.selector.run(nextProps);\n      };\n\n      Connect.prototype.shouldComponentUpdate = function shouldComponentUpdate() {\n        return this.selector.shouldComponentUpdate;\n      };\n\n      Connect.prototype.componentWillUnmount = function componentWillUnmount() {\n        if (this.subscription) this.subscription.tryUnsubscribe();\n        // these are just to guard against extra memory leakage if a parent element doesn't\n        // dereference this instance properly, such as an async callback that never finishes\n        this.subscription = null;\n        this.store = null;\n        this.parentSub = null;\n        this.selector.run = function () {};\n      };\n\n      Connect.prototype.getWrappedInstance = function getWrappedInstance() {\n        invariant(withRef, 'To access the wrapped instance, you need to specify ' + ('{ withRef: true } in the options argument of the ' + methodName + '() call.'));\n        return this.wrappedInstance;\n      };\n\n      Connect.prototype.setWrappedInstance = function setWrappedInstance(ref) {\n        this.wrappedInstance = ref;\n      };\n\n      Connect.prototype.initSelector = function initSelector() {\n        var dispatch = this.store.dispatch;\n        var getState = this.getState;\n\n        var sourceSelector = selectorFactory(dispatch, selectorFactoryOptions);\n\n        // wrap the selector in an object that tracks its results between runs\n        var selector = this.selector = {\n          shouldComponentUpdate: true,\n          props: sourceSelector(getState(), this.props),\n          run: function runComponentSelector(props) {\n            try {\n              var nextProps = sourceSelector(getState(), props);\n              if (selector.error || nextProps !== selector.props) {\n                selector.shouldComponentUpdate = true;\n                selector.props = nextProps;\n                selector.error = null;\n              }\n            } catch (error) {\n              selector.shouldComponentUpdate = true;\n              selector.error = error;\n            }\n          }\n        };\n      };\n\n      Connect.prototype.initSubscription = function initSubscription() {\n        var _this2 = this;\n\n        if (shouldHandleStateChanges) {\n          (function () {\n            var subscription = _this2.subscription = new Subscription(_this2.store, _this2.parentSub);\n            var dummyState = {};\n\n            subscription.onStateChange = function onStateChange() {\n              this.selector.run(this.props);\n\n              if (!this.selector.shouldComponentUpdate) {\n                subscription.notifyNestedSubs();\n              } else {\n                this.componentDidUpdate = function componentDidUpdate() {\n                  this.componentDidUpdate = undefined;\n                  subscription.notifyNestedSubs();\n                };\n\n                this.setState(dummyState);\n              }\n            }.bind(_this2);\n          })();\n        }\n      };\n\n      Connect.prototype.isSubscribed = function isSubscribed() {\n        return Boolean(this.subscription) && this.subscription.isSubscribed();\n      };\n\n      Connect.prototype.addExtraProps = function addExtraProps(props) {\n        if (!withRef && !renderCountProp) return props;\n        // make a shallow copy so that fields added don't leak to the original selector.\n        // this is especially important for 'ref' since that's a reference back to the component\n        // instance. a singleton memoized selector would then be holding a reference to the\n        // instance, preventing the instance from being garbage collected, and that would be bad\n        var withExtras = _extends({}, props);\n        if (withRef) withExtras.ref = this.setWrappedInstance;\n        if (renderCountProp) withExtras[renderCountProp] = this.renderCount++;\n        return withExtras;\n      };\n\n      Connect.prototype.render = function render() {\n        var selector = this.selector;\n        selector.shouldComponentUpdate = false;\n\n        if (selector.error) {\n          throw selector.error;\n        } else {\n          return preact.h(WrappedComponent, this.addExtraProps(selector.props));\n        }\n      };\n\n      return Connect;\n    }(preact.Component);\n\n    Connect.WrappedComponent = WrappedComponent;\n    Connect.displayName = displayName;\n    Connect.childContextTypes = childContextTypes;\n    Connect.contextTypes = contextTypes;\n\n\n    {\n      Connect.prototype.componentWillUpdate = function componentWillUpdate() {\n        // We are hot reloading!\n        if (this.version !== version) {\n          this.version = version;\n          this.initSelector();\n\n          if (this.subscription) this.subscription.tryUnsubscribe();\n          this.initSubscription();\n          if (shouldHandleStateChanges) this.subscription.trySubscribe();\n        }\n      };\n    }\n\n    return index(Connect, WrappedComponent);\n  };\n}\n\nvar hasOwn = Object.prototype.hasOwnProperty;\n\nfunction shallowEqual(a, b) {\n  if (a === b) return true;\n\n  var countA = 0;\n  var countB = 0;\n\n  for (var key in a) {\n    if (hasOwn.call(a, key) && a[key] !== b[key]) return false;\n    countA++;\n  }\n\n  for (var _key in b) {\n    if (hasOwn.call(b, _key)) countB++;\n  }\n\n  return countA === countB;\n}\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetPrototype = Object.getPrototypeOf;\n\n/**\n * Gets the `[[Prototype]]` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {null|Object} Returns the `[[Prototype]]`.\n */\nfunction getPrototype(value) {\n  return nativeGetPrototype(Object(value));\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) == 'object';\n}\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = Function.prototype.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object,\n *  else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || objectToString.call(value) != objectTag || isHostObject(value)) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor && funcToString.call(Ctor) == objectCtorString;\n}\n\nfunction verifyPlainObject(value, displayName, methodName) {\n  if (!isPlainObject(value)) {\n    warning(methodName + '() in ' + displayName + ' must return a plain object. Instead received ' + value + '.');\n  }\n}\n\nfunction wrapMapToPropsConstant(getConstant) {\n  return function initConstantSelector(dispatch, options) {\n    var constant = getConstant(dispatch, options);\n\n    function constantSelector() {\n      return constant;\n    }\n    constantSelector.dependsOnOwnProps = false;\n    return constantSelector;\n  };\n}\n\n// dependsOnOwnProps is used by createMapToPropsProxy to determine whether to pass props as args\n// to the mapToProps function being wrapped. It is also used by makePurePropsSelector to determine\n// whether mapToProps needs to be invoked when props have changed.\n// \n// A length of one signals that mapToProps does not depend on props from the parent component.\n// A length of zero is assumed to mean mapToProps is getting args via arguments or ...args and\n// therefore not reporting its length accurately..\nfunction getDependsOnOwnProps(mapToProps) {\n  return mapToProps.dependsOnOwnProps !== null && mapToProps.dependsOnOwnProps !== undefined ? Boolean(mapToProps.dependsOnOwnProps) : mapToProps.length !== 1;\n}\n\n// Used by whenMapStateToPropsIsFunction and whenMapDispatchToPropsIsFunction,\n// this function wraps mapToProps in a proxy function which does several things:\n// \n//  * Detects whether the mapToProps function being called depends on props, which\n//    is used by selectorFactory to decide if it should reinvoke on props changes.\n//    \n//  * On first call, handles mapToProps if returns another function, and treats that\n//    new function as the true mapToProps for subsequent calls.\n//    \n//  * On first call, verifies the first result is a plain object, in order to warn\n//    the developer that their mapToProps function is not returning a valid result.\n//    \nfunction wrapMapToPropsFunc(mapToProps, methodName) {\n  return function initProxySelector(dispatch, _ref) {\n    var displayName = _ref.displayName;\n\n    var proxy = function mapToPropsProxy(stateOrDispatch, ownProps) {\n      return proxy.dependsOnOwnProps ? proxy.mapToProps(stateOrDispatch, ownProps) : proxy.mapToProps(stateOrDispatch);\n    };\n\n    proxy.dependsOnOwnProps = getDependsOnOwnProps(mapToProps);\n\n    proxy.mapToProps = function detectFactoryAndVerify(stateOrDispatch, ownProps) {\n      proxy.mapToProps = mapToProps;\n      var props = proxy(stateOrDispatch, ownProps);\n\n      if (typeof props === 'function') {\n        proxy.mapToProps = props;\n        proxy.dependsOnOwnProps = getDependsOnOwnProps(props);\n        props = proxy(stateOrDispatch, ownProps);\n      }\n\n      verifyPlainObject(props, displayName, methodName);\n\n      return props;\n    };\n\n    return proxy;\n  };\n}\n\nfunction whenMapDispatchToPropsIsFunction(mapDispatchToProps) {\n  return typeof mapDispatchToProps === 'function' ? wrapMapToPropsFunc(mapDispatchToProps, 'mapDispatchToProps') : undefined;\n}\n\nfunction whenMapDispatchToPropsIsMissing(mapDispatchToProps) {\n  return !mapDispatchToProps ? wrapMapToPropsConstant(function (dispatch) {\n    return { dispatch: dispatch };\n  }) : undefined;\n}\n\nfunction whenMapDispatchToPropsIsObject(mapDispatchToProps) {\n  return mapDispatchToProps && (typeof mapDispatchToProps === 'undefined' ? 'undefined' : _typeof(mapDispatchToProps)) === 'object' ? wrapMapToPropsConstant(function (dispatch) {\n    return redux.bindActionCreators(mapDispatchToProps, dispatch);\n  }) : undefined;\n}\n\nvar defaultMapDispatchToPropsFactories = [whenMapDispatchToPropsIsFunction, whenMapDispatchToPropsIsMissing, whenMapDispatchToPropsIsObject];\n\nfunction whenMapStateToPropsIsFunction(mapStateToProps) {\n  return typeof mapStateToProps === 'function' ? wrapMapToPropsFunc(mapStateToProps, 'mapStateToProps') : undefined;\n}\n\nfunction whenMapStateToPropsIsMissing(mapStateToProps) {\n  return !mapStateToProps ? wrapMapToPropsConstant(function () {\n    return {};\n  }) : undefined;\n}\n\nvar defaultMapStateToPropsFactories = [whenMapStateToPropsIsFunction, whenMapStateToPropsIsMissing];\n\nfunction defaultMergeProps(stateProps, dispatchProps, ownProps) {\n  return _extends({}, ownProps, stateProps, dispatchProps);\n}\n\nfunction wrapMergePropsFunc(mergeProps) {\n  return function initMergePropsProxy(dispatch, _ref) {\n    var displayName = _ref.displayName;\n    var pure = _ref.pure;\n    var areMergedPropsEqual = _ref.areMergedPropsEqual;\n\n    var hasRunOnce = false;\n    var mergedProps = void 0;\n\n    return function mergePropsProxy(stateProps, dispatchProps, ownProps) {\n      var nextMergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n\n      if (hasRunOnce) {\n        if (!pure || !areMergedPropsEqual(nextMergedProps, mergedProps)) mergedProps = nextMergedProps;\n      } else {\n        hasRunOnce = true;\n        mergedProps = nextMergedProps;\n\n        verifyPlainObject(mergedProps, displayName, 'mergeProps');\n      }\n\n      return mergedProps;\n    };\n  };\n}\n\nfunction whenMergePropsIsFunction(mergeProps) {\n  return typeof mergeProps === 'function' ? wrapMergePropsFunc(mergeProps) : undefined;\n}\n\nfunction whenMergePropsIsOmitted(mergeProps) {\n  return !mergeProps ? function () {\n    return defaultMergeProps;\n  } : undefined;\n}\n\nvar defaultMergePropsFactories = [whenMergePropsIsFunction, whenMergePropsIsOmitted];\n\nfunction verify(selector, methodName, displayName) {\n  if (!selector) {\n    throw new Error('Unexpected value for ' + methodName + ' in ' + displayName + '.');\n  } else if (methodName === 'mapStateToProps' || methodName === 'mapDispatchToProps') {\n    if (!selector.hasOwnProperty('dependsOnOwnProps')) {\n      warning('The selector for ' + methodName + ' of ' + displayName + ' did not specify a value for dependsOnOwnProps.');\n    }\n  }\n}\n\nfunction verifySubselectors(mapStateToProps, mapDispatchToProps, mergeProps, displayName) {\n  verify(mapStateToProps, 'mapStateToProps', displayName);\n  verify(mapDispatchToProps, 'mapDispatchToProps', displayName);\n  verify(mergeProps, 'mergeProps', displayName);\n}\n\nfunction impureFinalPropsSelectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch) {\n  return function impureFinalPropsSelector(state, ownProps) {\n    return mergeProps(mapStateToProps(state, ownProps), mapDispatchToProps(dispatch, ownProps), ownProps);\n  };\n}\n\nfunction pureFinalPropsSelectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch, _ref) {\n  var areStatesEqual = _ref.areStatesEqual;\n  var areOwnPropsEqual = _ref.areOwnPropsEqual;\n  var areStatePropsEqual = _ref.areStatePropsEqual;\n\n  var hasRunAtLeastOnce = false;\n  var state = void 0;\n  var ownProps = void 0;\n  var stateProps = void 0;\n  var dispatchProps = void 0;\n  var mergedProps = void 0;\n\n  function handleFirstCall(firstState, firstOwnProps) {\n    state = firstState;\n    ownProps = firstOwnProps;\n    stateProps = mapStateToProps(state, ownProps);\n    dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    hasRunAtLeastOnce = true;\n    return mergedProps;\n  }\n\n  function handleNewPropsAndNewState() {\n    stateProps = mapStateToProps(state, ownProps);\n\n    if (mapDispatchToProps.dependsOnOwnProps) dispatchProps = mapDispatchToProps(dispatch, ownProps);\n\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleNewProps() {\n    if (mapStateToProps.dependsOnOwnProps) stateProps = mapStateToProps(state, ownProps);\n\n    if (mapDispatchToProps.dependsOnOwnProps) dispatchProps = mapDispatchToProps(dispatch, ownProps);\n\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleNewState() {\n    var nextStateProps = mapStateToProps(state, ownProps);\n    var statePropsChanged = !areStatePropsEqual(nextStateProps, stateProps);\n    stateProps = nextStateProps;\n\n    if (statePropsChanged) mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n\n    return mergedProps;\n  }\n\n  function handleSubsequentCalls(nextState, nextOwnProps) {\n    var propsChanged = !areOwnPropsEqual(nextOwnProps, ownProps);\n    var stateChanged = !areStatesEqual(nextState, state);\n    state = nextState;\n    ownProps = nextOwnProps;\n\n    if (propsChanged && stateChanged) return handleNewPropsAndNewState();\n    if (propsChanged) return handleNewProps();\n    if (stateChanged) return handleNewState();\n    return mergedProps;\n  }\n\n  return function pureFinalPropsSelector(nextState, nextOwnProps) {\n    return hasRunAtLeastOnce ? handleSubsequentCalls(nextState, nextOwnProps) : handleFirstCall(nextState, nextOwnProps);\n  };\n}\n\n// TODO: Add more comments\n\n// If pure is true, the selector returned by selectorFactory will memoize its results,\n// allowing connectAdvanced's shouldComponentUpdate to return false if final\n// props have not changed. If false, the selector will always return a new\n// object and shouldComponentUpdate will always return true.\n\nfunction finalPropsSelectorFactory(dispatch, _ref2) {\n  var initMapStateToProps = _ref2.initMapStateToProps;\n  var initMapDispatchToProps = _ref2.initMapDispatchToProps;\n  var initMergeProps = _ref2.initMergeProps;\n  var options = objectWithoutProperties(_ref2, ['initMapStateToProps', 'initMapDispatchToProps', 'initMergeProps']);\n\n  var mapStateToProps = initMapStateToProps(dispatch, options);\n  var mapDispatchToProps = initMapDispatchToProps(dispatch, options);\n  var mergeProps = initMergeProps(dispatch, options);\n\n  {\n    verifySubselectors(mapStateToProps, mapDispatchToProps, mergeProps, options.displayName);\n  }\n\n  var selectorFactory = options.pure ? pureFinalPropsSelectorFactory : impureFinalPropsSelectorFactory;\n\n  return selectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch, options);\n}\n\n/*\n  connect is a facade over connectAdvanced. It turns its args into a compatible\n  selectorFactory, which has the signature:\n\n    (dispatch, options) => (nextState, nextOwnProps) => nextFinalProps\n  \n  connect passes its args to connectAdvanced as options, which will in turn pass them to\n  selectorFactory each time a Connect component instance is instantiated or hot reloaded.\n\n  selectorFactory returns a final props selector from its mapStateToProps,\n  mapStateToPropsFactories, mapDispatchToProps, mapDispatchToPropsFactories, mergeProps,\n  mergePropsFactories, and pure args.\n\n  The resulting final props selector is called by the Connect component instance whenever\n  it receives new props or store state.\n */\n\nfunction match(arg, factories, name) {\n  for (var i = factories.length - 1; i >= 0; i--) {\n    var result = factories[i](arg);\n    if (result) return result;\n  }\n\n  return function (dispatch, options) {\n    throw new Error('Invalid value of type ' + (typeof arg === 'undefined' ? 'undefined' : _typeof(arg)) + ' for ' + name + ' argument when connecting component ' + options.wrappedComponentName + '.');\n  };\n}\n\nfunction strictEqual(a, b) {\n  return a === b;\n}\n\n// createConnect with default args builds the 'official' connect behavior. Calling it with\n// different options opens up some testing and extensibility scenarios\nfunction createConnect() {\n  var _ref = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n  var _ref$connectHOC = _ref.connectHOC;\n  var connectHOC = _ref$connectHOC === undefined ? connectAdvanced : _ref$connectHOC;\n  var _ref$mapStateToPropsF = _ref.mapStateToPropsFactories;\n  var mapStateToPropsFactories = _ref$mapStateToPropsF === undefined ? defaultMapStateToPropsFactories : _ref$mapStateToPropsF;\n  var _ref$mapDispatchToPro = _ref.mapDispatchToPropsFactories;\n  var mapDispatchToPropsFactories = _ref$mapDispatchToPro === undefined ? defaultMapDispatchToPropsFactories : _ref$mapDispatchToPro;\n  var _ref$mergePropsFactor = _ref.mergePropsFactories;\n  var mergePropsFactories = _ref$mergePropsFactor === undefined ? defaultMergePropsFactories : _ref$mergePropsFactor;\n  var _ref$selectorFactory = _ref.selectorFactory;\n  var selectorFactory = _ref$selectorFactory === undefined ? finalPropsSelectorFactory : _ref$selectorFactory;\n\n  return function connect(mapStateToProps, mapDispatchToProps, mergeProps) {\n    var _ref2 = arguments.length <= 3 || arguments[3] === undefined ? {} : arguments[3];\n\n    var _ref2$pure = _ref2.pure;\n    var pure = _ref2$pure === undefined ? true : _ref2$pure;\n    var _ref2$areStatesEqual = _ref2.areStatesEqual;\n    var areStatesEqual = _ref2$areStatesEqual === undefined ? strictEqual : _ref2$areStatesEqual;\n    var _ref2$areOwnPropsEqua = _ref2.areOwnPropsEqual;\n    var areOwnPropsEqual = _ref2$areOwnPropsEqua === undefined ? shallowEqual : _ref2$areOwnPropsEqua;\n    var _ref2$areStatePropsEq = _ref2.areStatePropsEqual;\n    var areStatePropsEqual = _ref2$areStatePropsEq === undefined ? shallowEqual : _ref2$areStatePropsEq;\n    var _ref2$areMergedPropsE = _ref2.areMergedPropsEqual;\n    var areMergedPropsEqual = _ref2$areMergedPropsE === undefined ? shallowEqual : _ref2$areMergedPropsE;\n    var extraOptions = objectWithoutProperties(_ref2, ['pure', 'areStatesEqual', 'areOwnPropsEqual', 'areStatePropsEqual', 'areMergedPropsEqual']);\n\n    var initMapStateToProps = match(mapStateToProps, mapStateToPropsFactories, 'mapStateToProps');\n    var initMapDispatchToProps = match(mapDispatchToProps, mapDispatchToPropsFactories, 'mapDispatchToProps');\n    var initMergeProps = match(mergeProps, mergePropsFactories, 'mergeProps');\n\n    return connectHOC(selectorFactory, _extends({\n      // used in error messages\n      methodName: 'connect',\n\n      // used to compute Connect's displayName from the wrapped component's displayName.\n      getDisplayName: function getDisplayName(name) {\n        return 'Connect(' + name + ')';\n      },\n\n      // if mapStateToProps is falsy, the Connect component doesn't subscribe to store state changes\n      shouldHandleStateChanges: Boolean(mapStateToProps),\n\n      // passed through to selectorFactory\n      initMapStateToProps: initMapStateToProps,\n      initMapDispatchToProps: initMapDispatchToProps,\n      initMergeProps: initMergeProps,\n      pure: pure,\n      areStatesEqual: areStatesEqual,\n      areOwnPropsEqual: areOwnPropsEqual,\n      areStatePropsEqual: areStatePropsEqual,\n      areMergedPropsEqual: areMergedPropsEqual\n\n    }, extraOptions));\n  };\n}\n\nvar connect$1 = createConnect();\n\n\n\nvar lib$1 = {\n\tProvider: Provider,\n\tconnect: connect$1,\n\tconnectAdvanced: connectAdvanced\n};\n\nreturn lib$1;\n\n})));\n//# sourceMappingURL=preact-redux.js.map\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/preact-redux/dist/preact-redux.js\n// module id = 1\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/preact-redux/dist/preact-redux.js","//@flow\nimport { Component } from 'preact';\nimport Player from 'playkit-js';\nimport LoggerFactory from '../utils/logger';\n\nclass BaseComponent extends Component {\n  player: Player;\n  name: string;\n  config: Object;\n  logger: any;\n\n  constructor(obj?: IControlParams = { config: {} }) {\n    super();\n\n    this.name = obj.name;\n    this.player = obj.player;\n    this.config = obj.config;\n    this.logger = LoggerFactory.getLogger(`UI ${this.name}`);\n    this.logger.debug(`Initialized`);\n  }\n\n  getConfig(attr?: string): any {\n    if (attr) {\n      return this.config[attr];\n    }\n    return this.config;\n  }\n\n  get defaultConfig() {\n    return {}\n  }\n}\n\nexport default BaseComponent;\n\n\n\n// WEBPACK FOOTER //\n// ./components/base.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/base.js","//@flow\nimport { bindActionCreators } from 'redux';\n\nexport function bindActions(actions) {\n\treturn dispatch => ({\n\t\t...bindActionCreators(actions, dispatch)\n\t});\n}\n\n\n\n// WEBPACK FOOTER //\n// ./utils/bind-actions.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/utils/bind-actions.js","import { h, Component } from 'preact';\n\nclass Icon extends Component {\n\n  render(props) {\n    switch (props.type) {\n      case 'maximize':\n        return (\n          <svg className='icon icon-maximize' viewBox='0 0 1024 1024'>\n            <path d='M800 269.255v114.745c0 17.673 14.327 32 32 32s32-14.327 32-32v-192c0-17.673-14.327-32-32-32h-192c-17.673 0-32 14.327-32 32s14.327 32 32 32h114.745l-137.373 137.373c-12.497 12.497-12.497 32.758 0 45.255s32.758 12.497 45.255 0l137.373-137.373z' />\n            <path d='M224 754.745v-114.745c0-17.673-14.327-32-32-32s-32 14.327-32 32v192c0 17.673 14.327 32 32 32h192c17.673 0 32-14.327 32-32s-14.327-32-32-32h-114.745l137.373-137.373c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0l-137.373 137.373z' />\n          </svg>\n        )\n      case 'minimize':\n        return (\n          <svg className='icon icon-minimize' viewBox='0 0 1024 1024'>\n            <path d='M672 306.745v-114.745c0-17.673-14.327-32-32-32s-32 14.327-32 32v192c0 17.673 14.327 32 32 32h192c17.673 0 32-14.327 32-32s-14.327-32-32-32h-114.745l137.373-137.373c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0l-137.373 137.373z' />\n            <path d='M352 717.255v114.745c0 17.673 14.327 32 32 32s32-14.327 32-32v-192c0-17.673-14.327-32-32-32h-192c-17.673 0-32 14.327-32 32s14.327 32 32 32h114.745l-137.373 137.373c-12.497 12.497-12.497 32.758 0 45.255s32.758 12.497 45.255 0l137.373-137.373z' />\n          </svg>\n        )\n\n      case 'play':\n        return (\n          <svg className='icon icon-play' viewBox='0 0 1024 1024'>\n            <path d='M796.806 461.202c44.919 28.075 44.739 73.706 0 101.668l-459.472 287.171c-44.919 28.075-81.334 7.915-81.334-45.305v-585.4c0-53.096 36.595-73.266 81.334-45.305l459.472 287.171z' />\n          </svg>\n        )\n\n      case 'pause':\n        return (\n          <svg className='icon icon-pause' viewBox='0 0 1024 1024'>\n            <path d='M256 287.843c0-35.259 28.407-63.843 64-63.843 35.346 0 64 28.564 64 63.843v448.314c0 35.259-28.407 63.843-64 63.843-35.346 0-64-28.564-64-63.843v-448.314zM640 287.843c0-35.259 28.407-63.843 64-63.843 35.346 0 64 28.564 64 63.843v448.314c0 35.259-28.407 63.843-64 63.843-35.346 0-64-28.564-64-63.843v-448.314z' />\n          </svg>\n        )\n\n      case 'volume-base':\n        return (\n          <svg className='icon volume-base' viewBox='0 0 1024 1024'>\n            <path d='M224 352l234.504-156.336c29.545-19.697 53.496-7.194 53.496 28.053v576.566c0 35.19-24.059 47.677-53.496 28.053l-234.504-156.336h-127.906c-17.725 0-32.094-14.581-32.094-31.853v-256.295c0-17.592 14.012-31.853 32.094-31.853h127.906zM288 637.748l160 106.667v-464.83l-160 106.667v251.496zM128 416v192h96v-192h-96z' />\n          </svg>\n        )\n\n      case 'volume-waves':\n        return (\n          <svg className='icon volume-waves' viewBox='0 0 1024 1024'>\n            <path d='M802.017 837.177c82.359-86.627 129.183-201.774 129.183-324.26 0-123.976-47.976-240.409-132.127-327.329-12.293-12.697-32.552-13.025-45.249-0.732s-13.025 32.552-0.732 45.249c72.692 75.084 114.109 175.597 114.109 282.812 0 105.928-40.422 205.331-111.566 280.162-12.177 12.808-11.666 33.063 1.143 45.24s33.063 11.666 45.24-1.143z' />\n            <path d='M667.436 743.221c67.761-60.884 107.273-147.888 107.273-241.233 0-87.318-34.552-169.203-94.836-229.446-12.501-12.493-32.762-12.486-45.255 0.015s-12.486 32.762 0.015 45.255c48.375 48.342 76.075 113.989 76.075 184.176 0 75.021-31.679 144.776-86.048 193.627-13.146 11.812-14.227 32.044-2.416 45.19s32.044 14.227 45.19 2.416z' />\n          </svg>\n        )\n\n      case 'volume-mute':\n        return (\n          <svg className='icon volume-mute' viewBox='0 0 1024 1024'>\n            <path d='M768 466.745l-67.986-67.986c-12.213-12.213-32.654-12.393-45.151 0.104-12.584 12.584-12.543 32.711-0.104 45.151l67.986 67.986-67.986 67.986c-12.213 12.213-12.393 32.654 0.104 45.151 12.584 12.584 32.711 12.543 45.151 0.104l67.986-67.986 67.986 67.986c12.213 12.213 32.654 12.393 45.151-0.104 12.584-12.584 12.543-32.711 0.104-45.151l-67.986-67.986 67.986-67.986c12.213-12.213 12.393-32.654-0.104-45.151-12.584-12.584-32.711-12.543-45.151-0.104l-67.986 67.986z' />\n          </svg>\n        )\n\n      case 'close':\n        return (\n          <svg className='icon icon-close' viewBox='0 0 1024 1024'>\n            <path d='M573.162 512l214.269-214.269c16.772-16.772 16.688-44.071-0.202-60.96-17.007-17.007-44.182-16.98-60.96-0.202l-214.269 214.269-214.269-214.269c-16.772-16.772-44.071-16.688-60.96 0.202-17.007 17.007-16.98 44.182-0.202 60.96l214.269 214.269-214.269 214.269c-16.772 16.772-16.688 44.071 0.202 60.96 17.007 17.007 44.182 16.98 60.96 0.202l214.269-214.269 214.269 214.269c16.772 16.772 44.071 16.688 60.96-0.202 17.007-17.007 16.98-44.182 0.202-60.96l-214.269-214.269z' />\n          </svg>\n        )\n\n      case 'share':\n        return (\n          <svg className='icon icon-share' viewBox='0 0 1024 1024'>\n            <path d='M318.641 446.219l236.155-142.257c-0.086-1.754-0.129-3.52-0.129-5.295 0-58.91 47.756-106.667 106.667-106.667s106.667 47.756 106.667 106.667c0 58.91-47.756 106.667-106.667 106.667-33.894 0-64.095-15.808-83.633-40.454l-236.467 142.445c-0.132-3.064-0.394-6.095-0.779-9.087l7.271-12.835-0.117 53.333-7.183-12.743c0.399-3.046 0.67-6.131 0.806-9.252l236.467 142.383c19.538-24.648 49.741-40.457 83.636-40.457 58.91 0 106.667 47.756 106.667 106.667s-47.756 106.667-106.667 106.667c-58.91 0-106.667-47.756-106.667-106.667 0-1.775 0.043-3.539 0.129-5.293l-236.19-142.216c-19.528 24.867-49.868 40.841-83.939 40.841-58.91 0-106.667-47.756-106.667-106.667s47.756-106.667 106.667-106.667c34.091 0 64.447 15.993 83.974 40.886zM234.667 554.667c23.564 0 42.667-19.103 42.667-42.667s-19.103-42.667-42.667-42.667c-23.564 0-42.667 19.103-42.667 42.667s19.103 42.667 42.667 42.667zM661.333 341.333c23.564 0 42.667-19.103 42.667-42.667s-19.103-42.667-42.667-42.667c-23.564 0-42.667 19.103-42.667 42.667s19.103 42.667 42.667 42.667zM661.333 768c23.564 0 42.667-19.103 42.667-42.667s-19.103-42.667-42.667-42.667c-23.564 0-42.667 19.103-42.667 42.667s19.103 42.667 42.667 42.667z' />\n          </svg>\n        )\n\n      case 'settings':\n        return (\n          <svg className='icon icon-share' viewBox='0 0 1024 1024'>\n            <path d='M829.945 549.126c2.784-24.116 2.784-48.445 0.269-70.702-1.182-6.772-7.090-11.696-13.674-11.641-33.039 0.582-62.975-19.389-75.126-50.118s-3.971-65.772 20.504-87.92c4.293-3.894 4.818-10.455 1.003-15.228-14.831-18.927-31.796-36.079-50.521-51.087-4.614-3.687-11.301-3.148-16.127 2.145-15.732 16.059-37.322 25.023-59.382 24.831-9.828 0.044-19.574-1.802-29.307-5.686-30.997-13.082-50.429-44.232-48.535-78.046 0.365-5.803-3.87-10.878-9.583-11.551-23.919-2.769-48.074-2.831-71.958-0.192-5.836 0.654-10.191 5.68-10.009 11.47 1.121 33.146-18.329 63.547-49.925 76.834-8.987 3.423-18.538 5.129-27.498 5.028-22.472 0.224-44.067-8.707-60.526-25.487-2.197-2.386-5.29-3.748-8.24-3.758-2.663 0.016-5.248 0.905-7.105 2.334-19.136 15.052-36.496 32.233-51.558 50.977-3.729 4.732-3.187 11.536 1.058 15.449 24.89 22.573 32.935 58.34 19.426 90.928-14.22 29.886-44.875 48.43-77.941 47.151-5.576-0.215-10.363 3.934-11.003 10.013-2.916 24.025-2.916 48.315-0.231 70.764 1.178 6.84 7.155 11.808 14.518 11.713l2.428 0.007c31.565 0.659 59.701 20.063 71.6 49.499 12.239 30.769 4.278 65.898-20.252 88.586-4.217 3.829-4.736 10.275-0.976 14.991 14.777 18.932 31.665 36.115 50.227 51.128 4.694 3.762 11.505 3.223 16.349-2.081 15.725-16.101 37.337-25.092 59.378-24.895 9.894-0.057 19.705 1.819 29.5 5.78 30.753 13.169 50.063 44.084 48.378 77.965-0.373 5.795 3.857 10.867 9.602 11.539 23.908 2.78 48.053 2.842 71.923 0.192 5.851-0.659 10.215-5.702 10.027-11.562-1.088-33.118 18.371-63.473 49.584-76.583 9.014-3.552 18.622-5.354 27.841-5.307 22.555-0.225 44.218 8.804 60.434 25.505 2.224 2.395 5.343 3.76 8.371 3.769 2.474-0.012 4.874-0.847 6.896-2.43 19.227-14.971 36.653-32.121 51.726-50.848 3.737-4.743 3.194-11.563-0.941-15.379-24.391-21.907-32.789-56.564-21.134-87.207s40.964-50.957 73.904-51.116h5.704c5.586-0.028 10.269-4.227 10.905-9.777zM893.526 556.438c-4.321 37.715-36.171 66.271-74.323 66.464h-5.711c-6.33 0.031-11.99 3.953-14.24 9.87s-0.629 12.609 4.385 17.116c29.020 26.748 32.567 71.325 7.936 102.582-18.378 22.837-39.342 43.468-62.397 61.42-13.128 10.284-29.303 15.909-46.22 15.991-21.004-0.056-41.043-8.825-54.839-23.692-3.514-3.616-8.356-5.634-13.867-5.583-1.555-0.007-3.097 0.282-3.877 0.581-6.088 2.559-9.967 8.609-9.749 15.235 1.257 39.227-27.828 72.841-66.88 77.241-28.725 3.189-57.719 3.114-86.45-0.227-39.585-4.631-68.615-39.444-66.083-78.749 0.331-6.679-3.529-12.859-9.057-15.234-1.449-0.585-2.998-0.881-5.025-0.873-5.074-0.045-9.947 1.982-12.693 4.763-26.775 29.494-71.875 33.067-103.071 8.066-22.458-18.164-42.771-38.831-60.335-61.337-24.602-30.847-21.012-75.5 7.982-101.818 4.881-4.515 6.479-11.568 4.088-17.58-2.239-5.538-7.562-9.209-12.866-9.327-39.748 0.506-72.828-26.991-79.581-66.425-3.538-29.147-3.538-58.616-0.060-87.234 4.085-39.084 37.791-68.296 77.064-66.784 7.502 0.29 14.456-3.916 17.001-9.164 2.519-6.098 0.94-13.122-4.133-17.724-29.022-26.738-32.57-71.311-7.956-102.538 18.292-22.765 39.115-43.375 62.322-61.626 13.199-10.169 29.368-15.731 46.323-15.833 21.063 0.065 41.146 8.908 54.704 23.656 3.559 3.623 8.44 5.642 14.175 5.592 1.605 0.017 3.199-0.268 3.668-0.426 6.11-2.574 9.998-8.651 9.771-15.356-1.228-39.209 27.864-72.786 66.897-77.161 28.715-3.173 57.697-3.098 86.456 0.231 39.539 4.653 68.54 39.409 66.051 78.92-0.369 6.596 3.446 12.713 8.931 15.035 1.507 0.6 3.114 0.905 5.156 0.898 5.087 0.044 9.973-1.985 12.671-4.704 26.66-29.444 71.625-33.068 102.694-8.244 22.604 18.117 43.043 38.781 60.715 61.337 24.728 30.927 21.142 75.751-8.215 102.378-4.724 4.275-6.301 11.031-3.958 16.955s8.114 9.775 14.774 9.659c38.18-0.325 70.992 27.018 77.822 66.463 3.343 28.966 3.343 58.22 0 87.185zM511.951 597.037c47.144-0.118 85.24-38.367 85.169-85.511 0-34.617-20.872-65.819-52.867-79.034s-68.802-5.836-93.231 18.69c-24.429 24.527-31.66 61.363-18.317 93.305s44.628 52.688 79.245 52.55zM512.158 661.036c-60.477 0.242-115.178-36.032-138.507-91.881s-10.686-120.254 32.026-163.138c42.712-42.884 107.066-55.785 163.008-32.679s92.434 77.661 92.434 138.139c0.124 82.417-66.545 149.353-148.962 149.559z' />\n          </svg>\n        )\n\n      case 'check':\n        return (\n          <svg className='icon check-icon' viewBox='0 0 1024 1024'>\n            <path d='M342.481 563.894c-12.577-12.416-32.838-12.285-45.254 0.292s-12.285 32.838 0.292 45.254l118.857 117.333c13.275 13.105 34.901 12.123 46.933-2.131l297.143-352c11.4-13.505 9.694-33.694-3.811-45.094s-33.694-9.694-45.094 3.811l-274.828 325.566-94.238-93.030z' />\n          </svg>\n        )\n      case 'language':\n        return (\n          <svg className='icon language-icon' viewBox='0 0 1024 1024'>\n            <path d='M625.773 808.031c29.752-39.944 63.443-97.069 83.311-168.977 41.798-3.715 74.872-8.022 98.271-11.57-32.456 82.71-98.638 148.558-181.582 180.547zM216.562 627.283c23.516 3.506 56.799 7.797 98.279 11.528 19.868 72.017 53.601 129.224 83.378 169.219-83.002-32.014-149.226-97.945-181.657-180.747zM400.147 215.201c-29.835 40.32-64.161 98.037-84.572 169.695-42.123 3.731-75.423 8.072-98.938 11.629 32.698-83.353 99.656-149.61 183.51-181.323zM807.438 396.725c-23.641-3.523-57.158-7.847-98.947-11.587-20.402-71.766-54.778-129.567-84.639-169.937 83.912 31.73 150.912 98.070 183.585 181.523zM720.095 436.644c48.952 4.817 84.472 10.209 102.995 13.331 3.99 20.068 6.127 40.796 6.127 62.024 0 21.262-2.137 42.031-6.152 62.141-18.248 3.172-53.376 8.615-102.753 13.448 3.84-23.908 6.069-49.102 6.069-75.59 0-26.296-2.304-51.431-6.286-75.356zM537.043 597.206v-170.396c48.576 0.551 92.653 2.646 131.178 5.426 5.050 25.119 8.072 51.74 8.072 79.763 0 28.216-2.913 54.87-7.789 79.939-38.283 2.713-82.343 4.742-131.462 5.267zM486.957 195.859v180.856c-43.175 0.442-82.443 1.995-117.429 4.149 31.939-95.382 89.99-161.656 112.237-184.612 1.72-0.159 3.464-0.259 5.192-0.392zM542.286 196.26c22.297 22.906 80.456 89.080 112.345 184.771-35.261-2.229-74.646-3.848-117.587-4.307v-180.864c1.745 0.142 3.506 0.234 5.242 0.401zM347.706 512c0-28.074 3.047-54.762 8.156-79.955 38.191-2.696 82.134-4.708 131.094-5.234v170.387c-48.71-0.551-92.895-2.655-131.495-5.443-4.858-25.018-7.755-51.606-7.755-79.755zM194.783 512c0-21.262 2.137-42.031 6.144-62.125 18.282-3.181 53.501-8.64 103.012-13.482-4.007 24-6.319 49.219-6.319 75.606 0 26.396 2.221 51.506 6.027 75.339-48.826-4.808-84.246-10.184-102.737-13.306-3.99-20.068-6.127-40.804-6.127-62.033zM481.338 827.706c-22.389-22.314-81.016-87.469-112.662-184.779 35.437 2.262 75.047 3.898 118.28 4.366v180.839c-1.87-0.142-3.757-0.25-5.618-0.426zM542.653 827.706c-1.862 0.175-3.74 0.284-5.61 0.426v-180.839c43.509-0.442 83.044-2.012 118.222-4.199-31.672 97.244-90.265 162.349-112.612 184.612zM512 128c-211.734 0-384 172.257-384 384 0 211.734 172.266 384 384 384s384-172.266 384-384c0-211.743-172.266-384-384-384z' />\n          </svg>\n        )\n\n      default:\n        break;\n    }\n  }\n}\n\nexport default Icon;\n\n\n\n// WEBPACK FOOTER //\n// ./components/icon/icon.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/icon/icon.js","function n(n){return n&&\"object\"==typeof n&&\"default\"in n?n.default:n}function t(n){return null!==n&&void 0!==n}function r(n,t){var o=e({},n);for(var i in t)t.hasOwnProperty(i)&&(o[i]=n[i]&&t[i]&&\"object\"==typeof n[i]&&\"object\"==typeof t[i]?r(n[i],t[i]):n[i]||t[i]);return o}function e(n,t){for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function o(n){if(n=n||{},\"string\"==typeof n&&(n=n.split(\",\")),\"join\"in n){for(var t={},r=0;r<n.length;r++){var e=n[r].trim();e&&(t[e.split(\".\").pop()]=e)}return t}return n}function i(n,t){return v=t||h,n&&n.replace(/\\{\\{([\\w.-]+)\\}\\}/g,u)}function u(n,t){for(var r=t.split(\".\"),e=v,o=0;o<r.length;o++)if(null==(e=e[r[o]]))return\"\";return\"string\"==typeof e&&e.match(/\\{\\{/)&&(e=i(e,v)),e}function c(n,r,e,o,u,c){r&&(n=r+\".\"+n);var a=e&&f(e,n);return(u||0===u)&&a&&\"object\"==typeof a&&(a=a.splice?a[u]||a[0]:0===u&&t(a.none)?a.none:1===u&&t(a.one||a.singular)?a.one||a.singular:a.some||a.many||a.plural||a.other||a),a&&i(a,o)||c||null}function a(n,t,r){var i={};t=t||{},n=o(n);for(var u in n)if(n.hasOwnProperty(u)&&n[u]){var a=n[u];r||\"string\"!=typeof a?a.nodeName===g&&(a=e({fallback:a.children&&a.children[0]},a.attributes),i[u]=c(a.id,t.scope,t.dictionary,a.fields,a.plural,a.fallback)):i[u]=c(a,t.scope,t.dictionary)}return i}var l=require(\"preact\"),f=n(require(\"dlv\")),p=/[?&#]intl=show/,s=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.getChildContext=function(){var n=this.props,t=n.scope,o=n.definition,i=n.mark,u=e({},this.context.intl||{});return t&&(u.scope=t),o&&(u.dictionary=r(u.dictionary||{},o)),(i||\"undefined\"!=typeof location&&String(location).match(p))&&(u.mark=!0),{intl:u}},t.prototype.render=function(n){var t=n.children;return t&&t[0]||null},t}(l.Component),d=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];if(n.length>1){return y(n[0],n[1])}var r=n[0];return function(n){return y(n,r)}},y=function(n,t){return function(r){return l.h(s,t||{},l.h(n,r))}},h={},v,g=function(n,t){var r=n.id,e=n.children,o=n.plural,i=n.fields,u=t.intl,a=e&&e[0],p=c(r,u&&u.scope,u&&u.dictionary,i,o,a);if(u&&u.mark){var s=\"dictionary\"+(u&&u.scope?\".\"+u.scope:\"\")+\".\"+r;return l.h(\"mark\",{style:\"background: \"+(p?f(u,s)?\"rgba(119,231,117,.5)\":\"rgba(229,226,41,.5)\":\"rgba(228,147,51,.5)\"),title:r},p)}return p},b=function(n,t){var r=n.children,e=t.intl,o=r&&r[0];return o&&l.cloneElement(o,a(o.attributes,e,!0))},m=function(n){return function(t){return function(r,e){var o=\"function\"==typeof n?n(r):n,i=a(o,e.intl);return l.h(t,assign({},r,i))}}};d.intl=d,d.IntlProvider=s,d.Text=g,d.Localizer=b,d.withText=m,module.exports=d;\n//# sourceMappingURL=preact-i18n.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/preact-i18n/dist/preact-i18n.js\n// module id = 5\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/preact-i18n/dist/preact-i18n.js","import createStore from './createStore';\nimport combineReducers from './combineReducers';\nimport bindActionCreators from './bindActionCreators';\nimport applyMiddleware from './applyMiddleware';\nimport compose from './compose';\nimport warning from './utils/warning';\n\n/*\n* This is a dummy function to check if the function name has been altered by minification.\n* If the function has been minified and NODE_ENV !== 'production', warn the user.\n*/\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \\'production\\'. ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) ' + 'to ensure you have the correct code for your production build.');\n}\n\nexport { createStore, combineReducers, bindActionCreators, applyMiddleware, compose };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/redux/es/index.js\n// module id = 6\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/redux/es/index.js","/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nexport default function warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n    /* eslint-disable no-empty */\n  } catch (e) {}\n  /* eslint-enable no-empty */\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/redux/es/utils/warning.js\n// module id = 7\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/redux/es/utils/warning.js","//@flow\n\nexport const types = {\n  ADD_PLAYER_CLASS: 'shell/ADD_PLAYER_CLASS',\n  REMOVE_PLAYER_CLASS: 'shell/REMOVE_PLAYER_CLASS',\n  UPDATE_IS_MOBILE: 'shell/UPDATE_IS_MOBILE'\n}\n\nexport const initialState = {\n  playerClasses: []\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.ADD_PLAYER_CLASS:\n      return {\n        ...state,\n        playerClasses: [...state.playerClasses, action.className]\n      }\n\n    case types.REMOVE_PLAYER_CLASS:\n      return {\n        ...state,\n        playerClasses: state.playerClasses.filter(c => c !== action.className)\n      }\n\n    case types.UPDATE_IS_MOBILE:\n      return {\n        ...state,\n        isMobile: action.isMobile\n      }\n\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  addPlayerClass: (className: string) => ({ type: types.ADD_PLAYER_CLASS, className }),\n  removePlayerClass: (className: string) => ({ type: types.REMOVE_PLAYER_CLASS, className }),\n  updateIsMobile: (isMobile: boolean) => ({ type: types.UPDATE_IS_MOBILE, isMobile })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/shell.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/shell.js","//@flow\n\nexport const types = {\n  TOGGLE_PLAY: 'play-pause/TOGGLE_PLAY'\n}\n\nexport const initialState = {\n  isPlaying: false\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.TOGGLE_PLAY:\n      return {\n        ...state,\n        isPlaying: action.isPlaying\n      }\n\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  toggleIsPlaying: (isPlaying: boolean) => ({ type: types.TOGGLE_PLAY, isPlaying })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/play-pause.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/play-pause.js","//@flow\n\nexport const types = {\n  TOGGLE_SHARE_OVERLAY: 'share/TOGGLE_SHARE_OVERLAY'\n}\n\nexport const initialState = {\n  overlayOpen: false\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.TOGGLE_SHARE_OVERLAY:\n      return {\n        ...state,\n        overlayOpen: action.show\n      }\n\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  toggleShareOverlay: (show: boolean) => ({ type: types.TOGGLE_SHARE_OVERLAY, show })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/share.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/share.js","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/process/browser.js\n// module id = 11\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/process/browser.js","import isPlainObject from 'lodash-es/isPlainObject';\nimport $$observable from 'symbol-observable';\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nexport var ActionTypes = {\n  INIT: '@@redux/INIT'\n\n  /**\n   * Creates a Redux store that holds the state tree.\n   * The only way to change the data in the store is to call `dispatch()` on it.\n   *\n   * There should only be a single store in your app. To specify how different\n   * parts of the state tree respond to actions, you may combine several reducers\n   * into a single reducer function by using `combineReducers`.\n   *\n   * @param {Function} reducer A function that returns the next state tree, given\n   * the current state tree and the action to handle.\n   *\n   * @param {any} [preloadedState] The initial state. You may optionally specify it\n   * to hydrate the state from the server in universal apps, or to restore a\n   * previously serialized user session.\n   * If you use `combineReducers` to produce the root reducer function, this must be\n   * an object with the same shape as `combineReducers` keys.\n   *\n   * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n   * to enhance the store with third-party capabilities such as middleware,\n   * time travel, persistence, etc. The only store enhancer that ships with Redux\n   * is `applyMiddleware()`.\n   *\n   * @returns {Store} A Redux store that lets you read the state, dispatch actions\n   * and subscribe to changes.\n   */\n};export default function createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error('Expected the enhancer to be a function.');\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Expected the reducer to be a function.');\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n  function getState() {\n    return currentState;\n  }\n\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Expected listener to be a function.');\n    }\n\n    var isSubscribed = true;\n\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      isSubscribed = false;\n\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n    };\n  }\n\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Actions may not have an undefined \"type\" property. ' + 'Have you misspelled a constant?');\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error('Expected the nextReducer to be a function.');\n    }\n\n    currentReducer = nextReducer;\n    dispatch({ type: ActionTypes.INIT });\n  }\n\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object') {\n          throw new TypeError('Expected the observer to be an object.');\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return { unsubscribe: unsubscribe };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  }\n\n  // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n  dispatch({ type: ActionTypes.INIT });\n\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/redux/es/createStore.js\n// module id = 12\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/redux/es/createStore.js","import baseGetTag from './_baseGetTag.js';\nimport getPrototype from './_getPrototype.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nexport default isPlainObject;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/isPlainObject.js\n// module id = 13\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/isPlainObject.js","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/_Symbol.js\n// module id = 14\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/_Symbol.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/webpack/buildin/global.js\n// module id = 15\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/webpack/buildin/global.js","/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\n\nexport default function compose() {\n  for (var _len = arguments.length, funcs = Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(undefined, arguments));\n    };\n  });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/redux/es/compose.js\n// module id = 16\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/redux/es/compose.js","//@flow\nexport const types = {\n  UPDATE_PLAYER_STATE: 'engine/UPDATE_PLAYER_STATE',\n  UPDATE_IS_PLAYING: 'engine/UPDATE_IS_PLAYING',\n  UPDATE_CURRENT_TIME: 'engine/UPDATE_CURRENT_TIME',\n  UPDATE_DURATION: 'engine/UPDATE_DURATION',\n  UPDATE_VOLUME: 'engine/UPDATE_VOLUME',\n  UPDATE_MUTED: 'engine/UPDATE_MUTED',\n  UPDATE_METADATA_LOADING_STATUS: 'engine/UPDATE_METADATA_LOADING_STATUS',\n  UPDATE_AUDIO_TRACKS: 'engine/UPDATE_AUDIO_TRACKS',\n  UPDATE_VIDEO_TRACKS: 'engine/UPDATE_VIDEO_TRACKS',\n  UPDATE_TEXT_TRACKS: 'engine/UPDATE_TEXT_TRACKS'\n}\n\nexport const initialState = {\n\tisPlaying: false,\n  metadataLoaded: false,\n  playerState: {\n    previousState: '',\n    currentState: ''\n  },\n  currentTime: 0,\n  duration: 0,\n  volume: 1,\n  muted: false,\n  videoTracks: [],\n  audioTracks: [],\n  textTracks: []\n}\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.UPDATE_PLAYER_STATE:\n      return {\n        ...state,\n        playerState: action.playerState\n      }\n\n    case types.UPDATE_IS_PLAYING:\n      return {\n        ...state,\n        isPlaying: action.isPlaying\n      }\n\n    case types.UPDATE_CURRENT_TIME:\n      return {\n        ...state,\n        currentTime: action.currentTime\n      }\n\n    case types.UPDATE_DURATION:\n      return {\n        ...state,\n        duration: action.duration\n      }\n\n    case types.UPDATE_VOLUME:\n      return {\n        ...state,\n        volume: action.volume\n      }\n\n    case types.UPDATE_MUTED:\n      return {\n        ...state,\n        muted: action.muted\n      }\n\n    case types.UPDATE_METADATA_LOADING_STATUS:\n      return {\n        ...state,\n        metadataLoaded: action.metadataLoaded\n      }\n\n    case types.UPDATE_AUDIO_TRACKS:\n      return {\n        ...state,\n        audioTracks: action.tracks\n      }\n\n    case types.UPDATE_VIDEO_TRACKS:\n      return {\n        ...state,\n        videoTracks: action.tracks\n      }\n\n    case types.UPDATE_TEXT_TRACKS:\n      return {\n        ...state,\n        textTracks: action.tracks\n      }\n\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  updatePlayerState: (prevoiusState: string, currentState: string) => ({ type: types.UPDATE_PLAYER_STATE, playerState: {prevoiusState, currentState} }),\n  updateIsPlaying: (isPlaying: boolean) => ({ type: types.UPDATE_IS_PLAYING, isPlaying }),\n  updateCurrentTime: (currentTime: number) => ({ type: types.UPDATE_CURRENT_TIME, currentTime }),\n  updateDuration: (duration: number) => ({ type: types.UPDATE_DURATION, duration }),\n  updateVolume: (volume: number) => ({ type: types.UPDATE_VOLUME, volume }),\n  updateMuted: (muted: boolean) => ({ type: types.UPDATE_MUTED, muted }),\n  updateMetadataLoadingStatus: (metadataLoaded: boolean) => ({ type: types.UPDATE_METADATA_LOADING_STATUS, metadataLoaded }),\n  updateAudioTracks: (tracks) => ({ type: types.UPDATE_AUDIO_TRACKS, tracks }),\n  updateVideoTracks: (tracks) => ({ type: types.UPDATE_VIDEO_TRACKS, tracks }),\n  updateTextTracks: (tracks) => ({ type: types.UPDATE_TEXT_TRACKS, tracks })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/engine.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/engine.js","//@flow\n\nexport const types = {\n  UPDATE_SEEKBAR_DRAGGING_STATUS: 'seekbar/UPDATE_SEEKBAR_DRAGGING_STATUS',\n  UPDATE_CURRENT_TIME: 'seekbar/UPDATE_CURRENT_TIME',\n  UPDATE_DURATION: 'seekbar/UPDATE_DURATION'\n}\n\nexport const initialState = {\n\tcurrentTime: 0,\n  duration: 0,\n  draggingActive: false\n}\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.UPDATE_SEEKBAR_DRAGGING_STATUS:\n      return {\n        ...state,\n        draggingActive: action.draggingActive\n      }\n\n    case types.UPDATE_CURRENT_TIME:\n      return {\n        ...state,\n        currentTime: action.currentTime\n      }\n\n    case types.UPDATE_DURATION:\n      return {\n        ...state,\n        duration: action.duration\n      }\n\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  updateSeekbarDraggingStatus: (draggingActive: boolean) => ({ type: types.UPDATE_SEEKBAR_DRAGGING_STATUS, draggingActive }),\n  updateDuration: (duration: number) => ({ type: types.UPDATE_DURATION, duration }),\n  updateCurrentTime: (currentTime: number) => ({ type: types.UPDATE_CURRENT_TIME, currentTime })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/seekbar.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/seekbar.js","//@flow\n\nexport const types = {\n  UPDATE_VOLUME: 'volume/UPDATE_VOLUME',\n  UPDATE_VOLUME_DRAGGING_STATUS: 'volume/UPDATE_VOLUME_DRAGGING_STATUS',\n  UPDATE_MUTED: 'volume/UPDATE_MUTED'\n}\n\nexport const initialState = {\n  draggingActive: false,\n  volume: 1,\n  muted: false\n}\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.UPDATE_VOLUME:\n      return {\n        ...state,\n        volume: action.volume\n      }\n\n    case types.UPDATE_VOLUME_DRAGGING_STATUS:\n      return {\n        ...state,\n        draggingActive: action.draggingActive\n      }\n\n    case types.UPDATE_MUTED:\n      return {\n        ...state,\n        muted: action.muted\n      }\n\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  updateVolume: (volume: number) => ({ type: types.UPDATE_VOLUME, volume }),\n  updateVolumeDraggingStatus: (draggingActive: boolean) => ({ type: types.UPDATE_VOLUME_DRAGGING_STATUS, draggingActive }),\n  updateMuted: (muted: boolean) => ({ type: types.UPDATE_MUTED, muted })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/volume.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/volume.js","//@flow\nexport const types = {\n  UPDATE_FULLSCREEN: 'fullscreen/UPDATE_FULLSCREEN'\n}\n\nexport const initialState = {\n  fullscreen: false\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.UPDATE_FULLSCREEN:\n      return {\n        ...state,\n        fullscreen: action.fullscreen\n      }\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  updateFullscreen: (fullscreen: boolean) => ({ type: types.UPDATE_FULLSCREEN, fullscreen })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/fullscreen.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/fullscreen.js","//@flow\n\nexport const types = {\n  UPDATE_LOADING_SPINNER_STATE: 'loading/UPDATE_LOADING_SPINNER_STATE'\n}\n\nexport const initialState = {\n  showLoadingSpinner: false\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.UPDATE_LOADING_SPINNER_STATE:\n      return {\n        ...state,\n        show: action.show\n      }\n\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  updateLoadingSpinnerState: (show: boolean) => ({ type: types.UPDATE_LOADING_SPINNER_STATE, show })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/loading.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/loading.js","//@flow\n\nexport const types = {\n  TOGGLE_CVAA_OVERLAY: 'share/TOGGLE_CVAA_OVERLAY'\n}\n\nexport const initialState = {\n  overlayOpen: false\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.TOGGLE_CVAA_OVERLAY:\n      return {\n        ...state,\n        overlayOpen: action.show\n      }\n\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  toggleCVAAOverlay: (show: boolean) => ({ type: types.TOGGLE_CVAA_OVERLAY, show })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/cvaa.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/cvaa.js","//@flow\n\nexport const types = {\n  UPDATE_QUALITY: 'settings/UPDATE_QUALITY',\n  UPDATE_SPEED: 'settings/UPDATE_SPEED'\n}\n\nexport const initialState = {\n  quality: 1,\n  speed: 2\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case types.UPDATE_QUALITY:\n      return {\n        ...state,\n        quality: action.quality\n      }\n\n    case types.UPDATE_SPEED:\n      return {\n        ...state,\n        speed: action.speed\n      }\n\n    default:\n      return state;\n  }\n}\n\nexport const actions = {\n  updateQuality: (quality: string) => ({ type: types.UPDATE_QUALITY, quality }),\n  updateSpeed: (speed: string) => ({ type: types.UPDATE_SPEED, speed })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./reducers/settings.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/reducers/settings.js","//@flow\n\nfunction toHHMMSS(input) {\n  var sec_num = parseInt(input, 10);\n  var hours   = Math.floor(sec_num / 3600);\n  var minutes = Math.floor((sec_num - (hours * 3600)) / 60);\n  var seconds = sec_num - (hours * 3600) - (minutes * 60);\n\n  if (hours   < 10) {hours   = \"0\"+hours;}\n  if (minutes < 10) {minutes = \"0\"+minutes;}\n  if (seconds < 10) {seconds = \"0\"+seconds;}\n\n  return `${minutes}:${seconds}`;\n}\n\nexport {toHHMMSS};\n\n\n\n// WEBPACK FOOTER //\n// ./utils/time-format.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/utils/time-format.js","//@flow\nimport { h, Component } from 'preact';\n\nclass SmartContainer extends Component {\n  render(props) {\n    return (\n      <div className='smart-container top left'>\n        {props.children}\n      </div>\n    )\n  }\n}\n\nexport default SmartContainer;\n\n\n\n// WEBPACK FOOTER //\n// ./components/smart-container/smart-container.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/smart-container/smart-container.js","//@flow\nimport { h, Component } from 'preact';\nimport DropDownMenu from '../dropdown-menu/dropdown-menu';\n\nclass SmartContainer extends Component {\n  render(props) {\n    return (\n      <div className='smart-container-item select-menu-item'>\n        <label htmlFor='quality'>{props.label}</label>\n        <DropDownMenu onSelect={o => props.onSelect(o)} options={props.options} />\n      </div>\n    )\n  }\n}\n\nexport default SmartContainer;\n\n\n\n// WEBPACK FOOTER //\n// ./components/smart-container/smart-container-item.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/smart-container/smart-container-item.js","//@flow\nimport { h, Component } from 'preact';\nimport { Localizer, Text } from 'preact-i18n';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/shell';\nimport Icon from '../icon/icon';\n\n@connect(null, bindActions(actions))\nclass Overlay extends Component {\n\n  componentDidUpdate() {\n    this.props.open ? this.props.addPlayerClass('overlay-active') : this.props.removePlayerClass('overlay-active');\n  }\n\n  render(props) {\n    var overlayClass = 'overlay';\n    if (props.type) overlayClass += ` ${props.type}-overlay`;\n    if (props.open) overlayClass += ' active'\n\n    return (\n      <div className={overlayClass} role='dialog'>\n        <Localizer>\n          <a onClick={() => props.onClose()} aria-label={<Text id='core.close' />} className='close-overlay'><Icon type='close' /></a>\n        </Localizer>\n        { props.children }\n      </div>\n    )\n  }\n}\n\nexport default Overlay;\n\n\n\n// WEBPACK FOOTER //\n// ./components/overlay/overlay.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/overlay/overlay.js","//@flow\nimport {h, render} from 'preact';\nimport {Provider} from 'preact-redux';\nimport {IntlProvider} from 'preact-i18n';\nimport { createStore } from 'redux';\n\nimport reducer from './store';\nimport definition from './fr.json';\n\nimport EngineConnector from './components/engine-connector/engine-connector';\nimport Shell from './components/shell/shell';\nimport OverlayPlay from './components/overlay-play/overlay-play';\nimport Loading from './components/loading/loading';\nimport PlayPauseControl from './components/play-pause/play-pause';\nimport SeekBarControl from './components/seekbar/seekbar';\nimport VolumeControl from './components/volume/volume';\nimport ShareControl from './components/share/share'\nimport SettingsControl from './components/settings/settings';\nimport LanguageControl from './components/language/language';\nimport FullscreenControl from './components/fullscreen/fullscreen';\nimport TimeDisplay from './components/time-display/time-display';\nimport TopBar from './components/top-bar/top-bar';\nimport BottomBar from './components/bottom-bar/bottom-bar';\nimport ShareOverlay from './components/share-overlay/share-overlay';\nimport CVAAOverlay from './components/cvaa-overlay/cvaa-overlay';\nimport KeyboardControl from './components/keyboard';\n\nclass UIManager {\n  player: any;\n  config: any;\n\n  constructor(player, config) {\n    this.player = player;\n    this.config = config;\n    this.config.ui = {\n      \"translations\": {\n        \"controls\": {\n          \"language\": \"שפה\"\n        }\n      },\n      \"components\": {\n        \"Loading\": {\n          \"enabled\": true\n        },\n        \"OverlayPlay\": {\n          \"enabled\": true\n        }\n      }\n    }\n  }\n\n  buildCustomUI(template): void {\n    this._buildUI(template);\n  }\n\n  buildDefaultUI(): void {\n    const store = createStore(reducer, window.devToolsExtension && window.devToolsExtension({ name: `playkit #${this.config.target}`, instanceId: this.config.target }));\n\n    let template = (\n      <Provider store={store}>\n        <IntlProvider definition={definition}>\n          <Shell>\n            <div className='player-holder' />\n            <EngineConnector player={this.player} />\n            <KeyboardControl player={this.player} />\n            <Loading player={this.player} />\n            <div className='player-gui'>\n              <OverlayPlay player={this.player} />\n              <TopBar>\n                <div className='left-controls'>\n                  <div className='video-playing-title'>L21 Earth Time Lapse View from Space, ISS</div>\n                </div>\n                <div className='right-controls'>\n                  <ShareControl player={this.player} />\n                </div>\n              </TopBar>\n              <BottomBar>\n                <SeekBarControl showFramePreview showTimeBubble player={this.player} />\n                <div className='left-controls'>\n                  <PlayPauseControl player={this.player} />\n                  <TimeDisplay format='current / total' player={this.player} />\n                </div>\n                <div className='right-controls'>\n                  <VolumeControl player={this.player} />\n                  <LanguageControl player={this.player} />\n                  <SettingsControl player={this.player} />\n                  <FullscreenControl player={this.player} />\n                </div>\n              </BottomBar>\n              <ShareOverlay />\n              <CVAAOverlay />\n            </div>\n          </Shell>\n        </IntlProvider>\n      </Provider>\n    );\n    this._buildUI(template);\n  }\n\n  _buildUI(template) {\n    if (!this.player) return;\n\n    let playerWrapper = document.createElement('div');\n    document.body.appendChild(playerWrapper);\n    render(template, playerWrapper);\n\n    let playerElement = document.getElementsByTagName('video')[this.config.target === 'player1' ? 0 : 1];\n    // let playerElement = document.getElementById(this.config.target); // the right way\n    playerElement.removeAttribute('style');\n    playerWrapper.getElementsByClassName('player-holder')[0].appendChild(playerElement);\n  }\n\n  release(): void { }\n\n}\n\nexport default UIManager;\n\n\n\n\n// WEBPACK FOOTER //\n// ./ui-manager.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/ui-manager.js","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/_baseGetTag.js\n// module id = 29\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/_baseGetTag.js","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/_root.js\n// module id = 30\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/_root.js","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/_freeGlobal.js\n// module id = 31\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/_freeGlobal.js","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/_getRawTag.js\n// module id = 32\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/_getRawTag.js","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/_objectToString.js\n// module id = 33\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/_objectToString.js","import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/_getPrototype.js\n// module id = 34\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/_getPrototype.js","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/_overArg.js\n// module id = 35\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/_overArg.js","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/lodash-es/isObjectLike.js\n// module id = 36\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/lodash-es/isObjectLike.js","module.exports = require('./lib/index');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/symbol-observable/index.js\n// module id = 37\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/symbol-observable/index.js","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ponyfill = require('./ponyfill');\n\nvar _ponyfill2 = _interopRequireDefault(_ponyfill);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar root; /* global window */\n\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (typeof module !== 'undefined') {\n  root = module;\n} else {\n  root = Function('return this')();\n}\n\nvar result = (0, _ponyfill2['default'])(root);\nexports['default'] = result;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/symbol-observable/lib/index.js\n// module id = 38\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/symbol-observable/lib/index.js","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/webpack/buildin/module.js\n// module id = 39\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/webpack/buildin/module.js","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports['default'] = symbolObservablePonyfill;\nfunction symbolObservablePonyfill(root) {\n\tvar result;\n\tvar _Symbol = root.Symbol;\n\n\tif (typeof _Symbol === 'function') {\n\t\tif (_Symbol.observable) {\n\t\t\tresult = _Symbol.observable;\n\t\t} else {\n\t\t\tresult = _Symbol('observable');\n\t\t\t_Symbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/symbol-observable/lib/ponyfill.js\n// module id = 40\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/symbol-observable/lib/ponyfill.js","import { ActionTypes } from './createStore';\nimport isPlainObject from 'lodash-es/isPlainObject';\nimport warning from './utils/warning';\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  var actionType = action && action.type;\n  var actionName = actionType && '\"' + actionType.toString() + '\"' || 'an action';\n\n  return 'Given action ' + actionName + ', reducer \"' + key + '\" returned undefined. ' + 'To ignore an action, you must explicitly return the previous state. ' + 'If you want this reducer to hold no value, you can return null instead of undefined.';\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return 'The ' + argumentName + ' has unexpected type of \"' + {}.toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + '\". Expected argument to be an object with the following ' + ('keys: \"' + reducerKeys.join('\", \"') + '\"');\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n\n  if (unexpectedKeys.length > 0) {\n    return 'Unexpected ' + (unexpectedKeys.length > 1 ? 'keys' : 'key') + ' ' + ('\"' + unexpectedKeys.join('\", \"') + '\" found in ' + argumentName + '. ') + 'Expected to find one of the known reducer keys instead: ' + ('\"' + reducerKeys.join('\", \"') + '\". Unexpected keys will be ignored.');\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, { type: ActionTypes.INIT });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined during initialization. ' + 'If the state passed to the reducer is undefined, you must ' + 'explicitly return the initial state. The initial state may ' + 'not be undefined. If you don\\'t want to set a value for this reducer, ' + 'you can use null instead of undefined.');\n    }\n\n    var type = '@@redux/PROBE_UNKNOWN_ACTION_' + Math.random().toString(36).substring(7).split('').join('.');\n    if (typeof reducer(undefined, { type: type }) === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined when probed with a random type. ' + ('Don\\'t try to handle ' + ActionTypes.INIT + ' or other actions in \"redux/*\" ') + 'namespace. They are considered private. Instead, you must return the ' + 'current state for any unknown actions, unless it is undefined, ' + 'in which case you must return the initial state, regardless of the ' + 'action type. The initial state may not be undefined, but can be null.');\n    }\n  });\n}\n\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\nexport default function combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof reducers[key] === 'undefined') {\n        warning('No reducer provided for key \"' + key + '\"');\n      }\n    }\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n  var finalReducerKeys = Object.keys(finalReducers);\n\n  var unexpectedKeyCache = void 0;\n  if (process.env.NODE_ENV !== 'production') {\n    unexpectedKeyCache = {};\n  }\n\n  var shapeAssertionError = void 0;\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination() {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var action = arguments[1];\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var nextState = {};\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n      if (typeof nextStateForKey === 'undefined') {\n        var errorMessage = getUndefinedStateErrorMessage(_key, action);\n        throw new Error(errorMessage);\n      }\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n    return hasChanged ? nextState : state;\n  };\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/redux/es/combineReducers.js\n// module id = 41\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/redux/es/combineReducers.js","import warning from './utils/warning';\n\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(undefined, arguments));\n  };\n}\n\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass a single function as the first argument,\n * and get a function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\nexport default function bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null) {\n    throw new Error('bindActionCreators expected an object or a function, instead received ' + (actionCreators === null ? 'null' : typeof actionCreators) + '. ' + 'Did you write \"import ActionCreators from\" instead of \"import * as ActionCreators from\"?');\n  }\n\n  var keys = Object.keys(actionCreators);\n  var boundActionCreators = {};\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var actionCreator = actionCreators[key];\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    } else {\n      warning('bindActionCreators expected a function actionCreator for key \\'' + key + '\\', instead received type \\'' + typeof actionCreator + '\\'.');\n    }\n  }\n  return boundActionCreators;\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/redux/es/bindActionCreators.js\n// module id = 42\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/redux/es/bindActionCreators.js","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport compose from './compose';\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\nexport default function applyMiddleware() {\n  for (var _len = arguments.length, middlewares = Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function (reducer, preloadedState, enhancer) {\n      var store = createStore(reducer, preloadedState, enhancer);\n      var _dispatch = store.dispatch;\n      var chain = [];\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch(action) {\n          return _dispatch(action);\n        }\n      };\n      chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(undefined, chain)(store.dispatch);\n\n      return _extends({}, store, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/redux/es/applyMiddleware.js\n// module id = 43\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/redux/es/applyMiddleware.js","//@flow\nimport { combineReducers } from 'redux';\nimport engine from './reducers/engine';\nimport shell from './reducers/shell';\nimport playPause from './reducers/play-pause';\nimport seekbar from './reducers/seekbar';\nimport volume from './reducers/volume';\nimport fullscreen from './reducers/fullscreen';\nimport loading from './reducers/loading';\nimport share from './reducers/share';\nimport cvaa from './reducers/cvaa';\nimport settings from './reducers/settings';\n\nconst reducer = combineReducers({\n  engine,\n  shell,\n  seekbar,\n  volume,\n  fullscreen,\n  loading,\n  playPause,\n  share,\n  cvaa,\n  settings\n});\n\nexport default reducer;\n\n\n\n// WEBPACK FOOTER //\n// ./store.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/store.js","module.exports = {\n\t\"core\": {\n\t\t\"disable\": \"Disable\",\n\t\t\"auto\": \"Auto\",\n\t\t\"close\": \"Close\"\n\t},\n\t\"controls\": {\n\t\t\"play\": \"Play\",\n\t\t\"pause\": \"Pause\",\n\t\t\"share\": \"Share\",\n\t\t\"language\": \"Language\",\n\t\t\"settings\": \"Settings\",\n\t\t\"fullscreen\": \"Fullscreen\"\n\t},\n\t\"settings\": {\n\t\t\"quality\": \"Quality\",\n\t\t\"speed\": \"Speed\"\n\t},\n\t\"language\": {\n\t\t\"audio\": \"Audio\",\n\t\t\"captions\": \"Captions\",\n\t\t\"advanced_captions_settings\": \"Advanced captions settings\"\n\t},\n\t\"share\": {\n\t\t\"share_title\": \"Partager\",\n\t\t\"link_options\": \"Options de lien\"\n\t}\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./fr.json\n// module id = 46\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/fr.json","//@flow\nimport { h } from 'preact';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { default as reduce, actions } from '../../reducers/engine';\nimport BaseComponent from '../base';\n\n@connect(reduce, bindActions(actions))\nclass EngineConnector extends BaseComponent {\n\n  constructor(obj: IControlParams) {\n    super({name: 'EngineConnector', player: obj.player});\n  }\n\n  componentDidMount() {\n    this.player.addEventListener(this.player.Event.PLAYER_STATE_CHANGED, (e) => {\n      this.props.updatePlayerState(e.payload.oldState.type, e.payload.newState.type);\n    });\n\n    this.player.addEventListener(this.player.Event.TIME_UPDATE, () => {\n      this.props.updateCurrentTime(this.player.currentTime);\n    });\n\n    this.player.addEventListener(this.player.Event.LOADED_METADATA, () => {\n      this.props.updateDuration(this.player.duration);\n      this.props.updateMetadataLoadingStatus(true);\n\n      const TrackType = this.player.Track;\n      let audioTracks = this.player.getTracks(TrackType.AUDIO);\n      let videoTracks = this.player.getTracks(TrackType.VIDEO);\n      let textTracks = this.player.getTracks(TrackType.TEXT);\n      this.props.updateAudioTracks(audioTracks);\n      this.props.updateVideoTracks(videoTracks);\n      this.props.updateTextTracks(textTracks);\n    });\n\n    this.player.addEventListener(this.player.Event.VOLUME_CHANGE, () => {\n      this.props.updateVolume(this.player.volume);\n    });\n\n    this.player.addEventListener(this.player.Event.PLAY, () => {\n      this.props.updateIsPlaying(true);\n    });\n\n    this.player.addEventListener(this.player.Event.PAUSE, () => {\n      this.props.updateIsPlaying(false);\n    });\n  }\n\n  shouldComponentUpdate() { return false; }\n\n  render() {\n    return <span />\n  }\n}\n\nexport default EngineConnector;\n\n\n\n// WEBPACK FOOTER //\n// ./components/engine-connector/engine-connector.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/engine-connector/engine-connector.js","module.exports = __WEBPACK_EXTERNAL_MODULE_48__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}\n// module id = 48\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:/ui/external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}","//@flow\nimport * as JsLogger from 'js-logger';\n\nconst LOG_LEVEL: { [level: string]: Object } = {\n  \"DEBUG\": JsLogger.DEBUG,\n  \"INFO\": JsLogger.INFO,\n  \"TIME\": JsLogger.TIME,\n  \"WARN\": JsLogger.WARN,\n  \"ERROR\": JsLogger.ERROR,\n  \"OFF\": JsLogger.OFF\n};\n\nclass LoggerFactory {\n  constructor(options?: Object) {\n    JsLogger.useDefaults(options || {});\n  }\n\n  getLogger(name?: string) {\n    if (!name) {\n      return JsLogger;\n    }\n    return JsLogger.get(name);\n  }\n}\n\nconst lf = new LoggerFactory({defaultLevel: JsLogger.DEBUG});\n\nexport default lf;\nexport {LOG_LEVEL};\n\n\n\n// WEBPACK FOOTER //\n// ./utils/logger.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/utils/logger.js","/*!\r\n * js-logger - http://github.com/jonnyreeves/js-logger\r\n * Jonny Reeves, http://jonnyreeves.co.uk/\r\n * js-logger may be freely distributed under the MIT license.\r\n */\r\n(function (global) {\r\n\t\"use strict\";\r\n\r\n\t// Top level module for the global, static logger instance.\r\n\tvar Logger = { };\r\n\r\n\t// For those that are at home that are keeping score.\r\n\tLogger.VERSION = \"1.3.0\";\r\n\r\n\t// Function which handles all incoming log messages.\r\n\tvar logHandler;\r\n\r\n\t// Map of ContextualLogger instances by name; used by Logger.get() to return the same named instance.\r\n\tvar contextualLoggersByNameMap = {};\r\n\r\n\t// Polyfill for ES5's Function.bind.\r\n\tvar bind = function(scope, func) {\r\n\t\treturn function() {\r\n\t\t\treturn func.apply(scope, arguments);\r\n\t\t};\r\n\t};\r\n\r\n\t// Super exciting object merger-matron 9000 adding another 100 bytes to your download.\r\n\tvar merge = function () {\r\n\t\tvar args = arguments, target = args[0], key, i;\r\n\t\tfor (i = 1; i < args.length; i++) {\r\n\t\t\tfor (key in args[i]) {\r\n\t\t\t\tif (!(key in target) && args[i].hasOwnProperty(key)) {\r\n\t\t\t\t\ttarget[key] = args[i][key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn target;\r\n\t};\r\n\r\n\t// Helper to define a logging level object; helps with optimisation.\r\n\tvar defineLogLevel = function(value, name) {\r\n\t\treturn { value: value, name: name };\r\n\t};\r\n\r\n\t// Predefined logging levels.\r\n\tLogger.DEBUG = defineLogLevel(1, 'DEBUG');\r\n\tLogger.INFO = defineLogLevel(2, 'INFO');\r\n\tLogger.TIME = defineLogLevel(3, 'TIME');\r\n\tLogger.WARN = defineLogLevel(4, 'WARN');\r\n\tLogger.ERROR = defineLogLevel(8, 'ERROR');\r\n\tLogger.OFF = defineLogLevel(99, 'OFF');\r\n\r\n\t// Inner class which performs the bulk of the work; ContextualLogger instances can be configured independently\r\n\t// of each other.\r\n\tvar ContextualLogger = function(defaultContext) {\r\n\t\tthis.context = defaultContext;\r\n\t\tthis.setLevel(defaultContext.filterLevel);\r\n\t\tthis.log = this.info;  // Convenience alias.\r\n\t};\r\n\r\n\tContextualLogger.prototype = {\r\n\t\t// Changes the current logging level for the logging instance.\r\n\t\tsetLevel: function (newLevel) {\r\n\t\t\t// Ensure the supplied Level object looks valid.\r\n\t\t\tif (newLevel && \"value\" in newLevel) {\r\n\t\t\t\tthis.context.filterLevel = newLevel;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Is the logger configured to output messages at the supplied level?\r\n\t\tenabledFor: function (lvl) {\r\n\t\t\tvar filterLevel = this.context.filterLevel;\r\n\t\t\treturn lvl.value >= filterLevel.value;\r\n\t\t},\r\n\r\n\t\tdebug: function () {\r\n\t\t\tthis.invoke(Logger.DEBUG, arguments);\r\n\t\t},\r\n\r\n\t\tinfo: function () {\r\n\t\t\tthis.invoke(Logger.INFO, arguments);\r\n\t\t},\r\n\r\n\t\twarn: function () {\r\n\t\t\tthis.invoke(Logger.WARN, arguments);\r\n\t\t},\r\n\r\n\t\terror: function () {\r\n\t\t\tthis.invoke(Logger.ERROR, arguments);\r\n\t\t},\r\n\r\n\t\ttime: function (label) {\r\n\t\t\tif (typeof label === 'string' && label.length > 0) {\r\n\t\t\t\tthis.invoke(Logger.TIME, [ label, 'start' ]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttimeEnd: function (label) {\r\n\t\t\tif (typeof label === 'string' && label.length > 0) {\r\n\t\t\t\tthis.invoke(Logger.TIME, [ label, 'end' ]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Invokes the logger callback if it's not being filtered.\r\n\t\tinvoke: function (level, msgArgs) {\r\n\t\t\tif (logHandler && this.enabledFor(level)) {\r\n\t\t\t\tlogHandler(msgArgs, merge({ level: level }, this.context));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Protected instance which all calls to the to level `Logger` module will be routed through.\r\n\tvar globalLogger = new ContextualLogger({ filterLevel: Logger.OFF });\r\n\r\n\t// Configure the global Logger instance.\r\n\t(function() {\r\n\t\t// Shortcut for optimisers.\r\n\t\tvar L = Logger;\r\n\r\n\t\tL.enabledFor = bind(globalLogger, globalLogger.enabledFor);\r\n\t\tL.debug = bind(globalLogger, globalLogger.debug);\r\n\t\tL.time = bind(globalLogger, globalLogger.time);\r\n\t\tL.timeEnd = bind(globalLogger, globalLogger.timeEnd);\r\n\t\tL.info = bind(globalLogger, globalLogger.info);\r\n\t\tL.warn = bind(globalLogger, globalLogger.warn);\r\n\t\tL.error = bind(globalLogger, globalLogger.error);\r\n\r\n\t\t// Don't forget the convenience alias!\r\n\t\tL.log = L.info;\r\n\t}());\r\n\r\n\t// Set the global logging handler.  The supplied function should expect two arguments, the first being an arguments\r\n\t// object with the supplied log messages and the second being a context object which contains a hash of stateful\r\n\t// parameters which the logging function can consume.\r\n\tLogger.setHandler = function (func) {\r\n\t\tlogHandler = func;\r\n\t};\r\n\r\n\t// Sets the global logging filter level which applies to *all* previously registered, and future Logger instances.\r\n\t// (note that named loggers (retrieved via `Logger.get`) can be configured independently if required).\r\n\tLogger.setLevel = function(level) {\r\n\t\t// Set the globalLogger's level.\r\n\t\tglobalLogger.setLevel(level);\r\n\r\n\t\t// Apply this level to all registered contextual loggers.\r\n\t\tfor (var key in contextualLoggersByNameMap) {\r\n\t\t\tif (contextualLoggersByNameMap.hasOwnProperty(key)) {\r\n\t\t\t\tcontextualLoggersByNameMap[key].setLevel(level);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Retrieve a ContextualLogger instance.  Note that named loggers automatically inherit the global logger's level,\r\n\t// default context and log handler.\r\n\tLogger.get = function (name) {\r\n\t\t// All logger instances are cached so they can be configured ahead of use.\r\n\t\treturn contextualLoggersByNameMap[name] ||\r\n\t\t\t(contextualLoggersByNameMap[name] = new ContextualLogger(merge({ name: name }, globalLogger.context)));\r\n\t};\r\n\r\n\t// CreateDefaultHandler returns a handler function which can be passed to `Logger.setHandler()` which will\r\n\t// write to the window's console object (if present); the optional options object can be used to customise the\r\n\t// formatter used to format each log message.\r\n\tLogger.createDefaultHandler = function (options) {\r\n\t\toptions = options || {};\r\n\r\n\t\toptions.formatter = options.formatter || function defaultMessageFormatter(messages, context) {\r\n\t\t\t// Prepend the logger's name to the log message for easy identification.\r\n\t\t\tif (context.name) {\r\n\t\t\t\tmessages.unshift(\"[\" + context.name + \"]\");\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Map of timestamps by timer labels used to track `#time` and `#timeEnd()` invocations in environments\r\n\t\t// that don't offer a native console method.\r\n\t\tvar timerStartTimeByLabelMap = {};\r\n\r\n\t\t// Support for IE8+ (and other, slightly more sane environments)\r\n\t\tvar invokeConsoleMethod = function (hdlr, messages) {\r\n\t\t\tFunction.prototype.apply.call(hdlr, console, messages);\r\n\t\t};\r\n\r\n\t\t// Check for the presence of a logger.\r\n\t\tif (typeof console === \"undefined\") {\r\n\t\t\treturn function () { /* no console */ };\r\n\t\t}\r\n\r\n\t\treturn function(messages, context) {\r\n\t\t\t// Convert arguments object to Array.\r\n\t\t\tmessages = Array.prototype.slice.call(messages);\r\n\r\n\t\t\tvar hdlr = console.log;\r\n\t\t\tvar timerLabel;\r\n\r\n\t\t\tif (context.level === Logger.TIME) {\r\n\t\t\t\ttimerLabel = (context.name ? '[' + context.name + '] ' : '') + messages[0];\r\n\r\n\t\t\t\tif (messages[1] === 'start') {\r\n\t\t\t\t\tif (console.time) {\r\n\t\t\t\t\t\tconsole.time(timerLabel);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttimerStartTimeByLabelMap[timerLabel] = new Date().getTime();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (console.timeEnd) {\r\n\t\t\t\t\t\tconsole.timeEnd(timerLabel);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tinvokeConsoleMethod(hdlr, [ timerLabel + ': ' +\r\n\t\t\t\t\t\t\t(new Date().getTime() - timerStartTimeByLabelMap[timerLabel]) + 'ms' ]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Delegate through to custom warn/error loggers if present on the console.\r\n\t\t\t\tif (context.level === Logger.WARN && console.warn) {\r\n\t\t\t\t\thdlr = console.warn;\r\n\t\t\t\t} else if (context.level === Logger.ERROR && console.error) {\r\n\t\t\t\t\thdlr = console.error;\r\n\t\t\t\t} else if (context.level === Logger.INFO && console.info) {\r\n\t\t\t\t\thdlr = console.info;\r\n\t\t\t\t}\r\n\r\n\t\t\t\toptions.formatter(messages, context);\r\n\t\t\t\tinvokeConsoleMethod(hdlr, messages);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\t// Configure and example a Default implementation which writes to the `window.console` (if present).  The\r\n\t// `options` hash can be used to configure the default logLevel and provide a custom message formatter.\r\n\tLogger.useDefaults = function(options) {\r\n\t\tLogger.setLevel(options && options.defaultLevel || Logger.DEBUG);\r\n\t\tLogger.setHandler(Logger.createDefaultHandler(options));\r\n\t};\r\n\r\n\t// Export to popular environments boilerplate.\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine(Logger);\r\n\t}\r\n\telse if (typeof module !== 'undefined' && module.exports) {\r\n\t\tmodule.exports = Logger;\r\n\t}\r\n\telse {\r\n\t\tLogger._prevLogger = global.Logger;\r\n\r\n\t\tLogger.noConflict = function () {\r\n\t\t\tglobal.Logger = Logger._prevLogger;\r\n\t\t\treturn Logger;\r\n\t\t};\r\n\r\n\t\tglobal.Logger = Logger;\r\n\t}\r\n}(this));\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/js-logger/src/logger.js\n// module id = 50\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///node_modules/js-logger/src/logger.js","//@flow\nimport { h } from 'preact';\nimport BaseComponent from '../base';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/shell';\nimport { isMobile } from '../../utils/is-mobile';\n\nconst mapStateToProps = state => ({\n  metadataLoaded: state.engine.metadataLoaded,\n  currentState: state.engine.playerState.currentState,\n  playerClasses: state.shell.playerClasses,\n  isMobile: state.shell.isMobile\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass Shell extends BaseComponent {\n  constructor() {\n    super({name: 'Shell'});\n  }\n\n  componentDidMount() {\n    this.props.updateIsMobile(isMobile());\n  }\n\n  render(props) {\n    var playerClasses = 'player skin-default';\n    playerClasses += ` ${props.playerClasses.join(' ')}`;\n\n    if (this.props.metadataLoaded) playerClasses += ` metadata-loaded`;\n    if (this.props.metadataLoaded) playerClasses += ` state-${this.props.currentState}`;\n\n    return (\n      <div className={playerClasses}>\n        { props.children }\n      </div>\n    )\n  }\n}\n\nexport default Shell;\n\n\n\n// WEBPACK FOOTER //\n// ./components/shell/shell.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/shell/shell.js","//@flow\n\nfunction isMobile() {\n  return typeof window.orientation !== \"undefined\" || navigator.userAgent.indexOf(\"IEMobile\") !== -1;\n}\n\nexport {isMobile}\n\n\n\n// WEBPACK FOOTER //\n// ./utils/is-mobile.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/utils/is-mobile.js","//@flow\nimport { h } from 'preact';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/play-pause';\nimport BaseComponent from '../base';\nimport Icon from '../icon/icon';\n\nconst mapStateToProps = state => ({\n  isPlaying: state.engine.isPlaying\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass OverlayPlay extends BaseComponent {\n\n  constructor(obj: IControlParams) {\n    super({name: 'OverlayPlay', player: obj.player});\n  }\n\n  togglePlayPause() {\n    this.logger.debug('Toggle play');\n    this.setState({animation: true});\n    setTimeout(() => {\n      this.setState({animation: false});\n    }, 400);\n    if (this.player.paused) {\n      this.player.play();\n    }\n    else {\n      this.player.pause();\n    }\n  }\n\n  render(props) {\n    return (\n      <div className={`overlay-play ${this.state.animation ? 'in' : ''}`} onClick={() => this.togglePlayPause()}>\n        { props.isPlaying ? <Icon type='play' /> : <Icon type='pause' /> }\n      </div>\n    )\n  }\n}\n\nexport default OverlayPlay;\n\n\n\n// WEBPACK FOOTER //\n// ./components/overlay-play/overlay-play.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/overlay-play/overlay-play.js","//@flow\nimport { h } from 'preact';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/loading';\nimport BaseComponent from '../base';\n\nconst mapStateToProps = state => ({\n  show: state.loading.show\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass Loading extends BaseComponent {\n  constructor(obj: IControlParams) {\n    super({name: 'Loading', player: obj.player});\n  }\n\n  componentDidMount() {\n    this.player.addEventListener(this.player.Event.PLAYER_STATE_CHANGED, e => {\n      if (e.payload.newState.type === 'idle' || e.payload.newState.type === 'playing' || e.payload.newState.type === 'paused') {\n        this.props.updateLoadingSpinnerState(false);\n      }\n      else {\n        this.props.updateLoadingSpinnerState(true);\n      }\n    });\n  }\n\n  render(props) {\n    return (\n      <div className={props.show ? 'loading-backdrop show' : 'loading-backdrop'}>\n        <div className='spinner-container'>\n          <div className='spinner'>\n            {[...Array(8)].map(() => <span />)}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n\nexport default Loading;\n\n\n\n// WEBPACK FOOTER //\n// ./components/loading/loading.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/loading/loading.js","//@flow\nimport { h } from 'preact';\nimport { Localizer, Text } from 'preact-i18n';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/play-pause';\nimport BaseComponent from '../base';\nimport Icon from '../icon/icon';\n\nconst mapStateToProps = state => ({\n  isPlaying: state.engine.isPlaying\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass PlayPauseControl extends BaseComponent {\n\n  constructor(obj: IControlParams) {\n    super({name: 'PlayPause', player: obj.player});\n  }\n\n  togglePlayPause() {\n    this.logger.debug('Toggle play');\n    if (this.player.paused) {\n      this.player.play();\n    }\n    else {\n      this.player.pause();\n    }\n  }\n\n  render() {\n    var controlButtonClass = this.props.isPlaying ? 'control-button is-playing' : 'control-button';\n\n    return (\n      <div className='control-button-container control-play-pause'>\n        <Localizer>\n          <button aria-label={<Text id={this.props.isPlaying ? 'controls.pause' : 'controls.play'} />} className={controlButtonClass} onClick={() => this.togglePlayPause()}>\n            <Icon type='play' />\n            <Icon type='pause' />\n          </button>\n        </Localizer>\n      </div>\n    )\n  }\n}\n\nexport default PlayPauseControl;\n\n\n\n// WEBPACK FOOTER //\n// ./components/play-pause/play-pause.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/play-pause/play-pause.js","//@flow\nimport { h } from 'preact';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/seekbar';\nimport BaseComponent from '../base';\nimport { toHHMMSS } from '../../utils/time-format';\n\nconst mapStateToProps = state => ({\n  virtualProgress: state.seekbar.virtualTime,\n  currentTime: state.seekbar.currentTime,\n  duration: state.engine.duration,\n  isDraggingActive: state.seekbar.draggingActive\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass SeekBarControl extends BaseComponent {\n  _seekBarElement: HTMLElement;\n  _playerElement: HTMLElement;\n\n  constructor(obj: IControlParams) {\n    super({name: 'SeekBar', player: obj.player});\n  }\n\n  componentDidMount() {\n    this._playerElement = document.getElementsByClassName('player')[0];\n    this._seekBarElement = document.getElementsByClassName('seek-bar')[0];\n\n    this.setState({virtualTime: 0});\n\n    this.player.addEventListener(this.player.Event.TIME_UPDATE, () => {\n      this.props.updateCurrentTime(this.player.currentTime);\n    });\n  }\n\n  onSeekbarMouseDown = e => {\n    this.props.updateSeekbarDraggingStatus(true);\n    if (this.props.isDraggingActive) {\n      let time = this.getTime(e);\n      this.updateSeekBarProgress(time, this.player.duration);\n    }\n  }\n\n  onSeekbarMouseUp = e => {\n    let time = this.getTime(e);\n    this.player.currentTime = time;\n    this.updateSeekBarProgress(time, this.player.duration);\n    this.props.updateSeekbarDraggingStatus(false);\n    this.logger.debug(`Seek to ${time}s`);\n  }\n\n  onSeekbarMouseMove = e => {\n    let time = this.getTime(e);\n    this.updateSeekBarProgress(time, this.player.duration, true);\n\n    if (this.props.isDraggingActive) {\n      this.updateSeekBarProgress(time, this.player.duration);\n    }\n  }\n\n  updateSeekBarProgress(currentTime: number, duration: number, virtual: boolean = false) {\n    if (virtual) {\n      this.setState({virtualTime: currentTime});\n    }\n    else {\n      this.props.updateCurrentTime(currentTime);\n    }\n  }\n\n  getTime(e: Event): Number {\n    let time = this.player.duration * ((e.clientX - this._seekBarElement.offsetLeft - this._playerElement.offsetLeft) / this._seekBarElement.clientWidth);\n    time = parseFloat(time.toFixed(2));\n    if (time < 0) return 0;\n    if (time > this.player.duration) return this.player.duration;\n    return time;\n  }\n\n  getThumbSpriteOffset() {\n    return - (Math.ceil(100 * this.state.virtualTime / this.player.duration) * 160) + 'px 0px';\n  }\n\n  render(props) {\n    var virtualProgressWidth = `${this.state.virtualTime / props.duration * 100}%`;\n    var progressWidth = `${props.currentTime / props.duration * 100}%`;\n    var framePreviewStyle = 'background-image: url(http://cfvod.kaltura.com/p/1914121/sp/191412100/thumbnail/entry_id/1_fet8ffop/version/100001/width/160/vid_slices/100); ';\n    framePreviewStyle += `background-position: ${this.getThumbSpriteOffset()}`\n\n    return (\n      <div className='seek-bar' role='slider'\n        aria-label='Seek slider' aria-valuemin='0' aria-valuemax={Math.round(this.player.duration)} aria-valuenow={Math.round(this.player.currentTime)}\n        aria-valuetext={`${toHHMMSS(this.player.currentTime)} of ${toHHMMSS(this.player.duration)}`}\n        onMouseMove={e => this.onSeekbarMouseMove(e)} onMouseDown={e => this.onSeekbarMouseDown(e)} onMouseUp={e => this.onSeekbarMouseUp(e)}>\n        <div className='progress-bar'>\n          <div className='progress' style={{width: progressWidth}}>\n            <a className='scrubber' />\n          </div>\n          <div className='virtual-progress' style={{width: virtualProgressWidth}}>\n            {\n              props.showFramePreview ?\n                (<div className='frame-preview'>\n                  <div className='frame-preview-img' style={framePreviewStyle} />\n                </div>) : ''\n            }\n            { this.props.showTimeBubble ? <div className='time-preview'>{ toHHMMSS(this.state.virtualTime)}</div> : '' }\n          </div>\n          <div className='buffered' style='width: 60%;' />\n        </div>\n      </div>\n    )\n  }\n\n}\nexport default SeekBarControl;\n\n\n\n// WEBPACK FOOTER //\n// ./components/seekbar/seekbar.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/seekbar/seekbar.js","//@flow\nimport { h } from 'preact';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/volume';\nimport BaseComponent from '../base';\nimport Icon from '../icon/icon';\n\nconst mapStateToProps = state => ({\n  isDraggingActive: state.volume.isDraggingActive,\n  volume: state.volume.volume,\n  muted: state.volume.muted,\n  isMobile: state.shell.isMobile\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass VolumeControl extends BaseComponent {\n  _volumeControlElement: HTMLElement;\n  _volumeProgressBarElement: HTMLElement;\n\n  constructor(obj: IControlParams) {\n    super({name: 'Volume', player: obj.player});\n  }\n\n  componentDidMount() {\n    this._volumeControlElement = document.getElementsByClassName('volume-control')[0];\n    this._volumeProgressBarElement = this._volumeControlElement.getElementsByClassName('bar')[0];\n\n    this.player.addEventListener(this.player.Event.LOADED_METADATA, () => {\n      this.props.updateVolume(this.player.volume);\n    })\n\n    this.player.addEventListener(this.player.Event.VOLUME_CHANGE, () => {\n      this.props.updateVolume(this.player.volume);\n    });\n  }\n\n  getVolumeProgessHeight(): string {\n    return this.props.muted ? '0%' : Math.round(this.props.volume * 100) + '%';\n  }\n\n  onVolumeProgressBarMouseDown() {\n    this.props.updateVolumeDraggingStatus(true);\n  }\n\n  onVolumeProgressBarClick(e: Event) {\n    this.changeVolume(e);\n  }\n\n  onVolumeControlButtonClick() {\n    this.logger.debug(`Toggle mute. ${this.player.muted} => ${!this.player.muted}`);\n    this.props.updateMuted(!this.props.muted);\n    this.player.muted = !this.player.muted;\n  }\n\n  changeVolume(e: Event) {\n    let barHeight = this._volumeProgressBarElement.clientHeight;\n    let topY = this.getCoords(this._volumeProgressBarElement).top;\n    let clickY = e.clientY;\n    let volume = 1 - ((clickY - topY) / barHeight);\n    volume = parseFloat(volume.toFixed(2));\n    this.logger.debug(`Change volume from ${this.player.volume} => ${volume}`);\n    this.player.volume = volume;\n    if (this.props.muted) {\n      this.player.muted = false;\n      this.props.updateMuted(false);\n    }\n  }\n\n  getCoords(el: HTMLElement): {top: number, left: number} {\n    let box = el.getBoundingClientRect();\n\n    return {\n      top: box.top + pageYOffset,\n      left: box.left + pageXOffset\n    }\n  }\n\n  render() {\n      var controlButtonClass = 'control-button-container volume-control';\n      if (this.props.isDraggingActive) controlButtonClass += ' dragging-active';\n      if (this.props.muted || this.props.volume === 0) controlButtonClass += ' is-muted';\n\n      if (!this.props.isMobile) return false;\n\n      return (\n        <div className={controlButtonClass}>\n          <button className='control-button' onClick={() => this.onVolumeControlButtonClick()} aria-label='Volume'>\n            <Icon type='volume-base' />\n            <Icon type='volume-waves' />\n            <Icon type='volume-mute' />\n          </button>\n          <div className='volume-control-bar' role='slider'\n            aria-valuemin='0' aria-valuemaz='100' aria-valuenow={this.player.volume * 100}\n            aria-valuetext={`${this.player.volume * 100}% volume ${this.player.muted ? 'muted' : ''}`}>\n            <div className='bar' onMouseDown={() => this.onVolumeProgressBarMouseDown()} onClick={e => this.onVolumeProgressBarClick(e)}>\n              <div className='progress' style={{height: this.getVolumeProgessHeight()}} />\n            </div>\n          </div>\n        </div>\n      )\n  }\n}\n\nexport default VolumeControl;\n\n\n\n// WEBPACK FOOTER //\n// ./components/volume/volume.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/volume/volume.js","//@flow\nimport { h } from 'preact';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/share';\nimport BaseComponent from '../base';\nimport Icon from '../icon/icon';\n\nconst mapStateToProps = state => ({\n  overlayOpen: state.share.overlayOpen\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass ShareControl extends BaseComponent {\n\n  constructor(obj: IControlParams) {\n    super({name: 'Share', player: obj.player});\n  }\n\n  render(props) {\n    return (\n      <div className='control-button-container control-share'>\n        <button className='control-button control-button-rounded' onClick={() => props.toggleShareOverlay(!props.overlayOpen)} aria-label='Share'>\n          <Icon type='share' />\n        </button>\n      </div>\n    )\n  }\n}\n\nexport default ShareControl;\n\n\n\n// WEBPACK FOOTER //\n// ./components/share/share.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/share/share.js","//@flow\nimport { h } from 'preact';\nimport { Localizer, Text } from 'preact-i18n';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/settings';\nimport BaseComponent from '../base';\nimport SmartContainer from '../smart-container/smart-container';\nimport SmartContainerItem from '../smart-container/smart-container-item';\nimport Icon from '../icon/icon';\n\nconst mapStateToProps = state => ({\n  videoTracks: state.engine.videoTracks\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass SettingsControl extends BaseComponent {\n\n  constructor(obj: IControlParams) {\n    super({name: 'Settings', player: obj.player});\n  }\n\n  componentDidMount() {\n    this.setState({smartContainerOpen: false});\n  }\n\n  onControlButtonClick() {\n    this.setState({smartContainerOpen: !this.state.smartContainerOpen});\n  }\n\n  onSpeedChange(o) {\n    this.props.updateSpeed(o.value);\n  }\n\n  onQualityChange(o) {\n    this.props.updateQuality(o.value);\n  }\n\n  render(props) {\n    var speedOptions = [\n      { value: 1, label: 'Auto (360)', active: true },\n      { value: 2, label: '240' },\n      { value: 3, label: '144' }\n    ]\n    return (\n      <div className='control-button-container control-settings'>\n        <Localizer>\n          <button aria-label={<Text id='controls.settings' />} className={this.state.smartContainerOpen ? 'control-button active' : 'control-button'} onClick={() => this.onControlButtonClick()}>\n            <Icon type='settings' />\n          </button>\n        </Localizer>\n        { !this.state.smartContainerOpen ? '' :\n        <SmartContainer>\n          {\n            props.videoTracks.length <= 0 ? '' :\n            <Localizer>\n              <SmartContainerItem label={<Text id='settings.quality' />} options={qualityOptions} onSelect={(o) => this.onQualityChange(o)} />\n            </Localizer>\n          }\n          <Localizer>\n            <SmartContainerItem label={<Text id='settings.speed' />} options={speedOptions} onSelect={(o) => this.onSpeedChange(o)} />\n          </Localizer>\n        </SmartContainer>\n        }\n      </div>\n    )\n  }\n}\n\nexport default SettingsControl;\n\n\n\n// WEBPACK FOOTER //\n// ./components/settings/settings.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/settings/settings.js","//@flow\nimport { h, Component } from 'preact';\nimport Icon from '../icon/icon';\n\nclass DropDownMenu extends Component {\n\n  componentWillMount() {\n    this.setState({dropMenuActive: false});\n  }\n\n  isSelected(o): boolean {\n    return o.active;\n  }\n\n  onSelect(o) {\n    this.props.onSelect(o);\n    this.setState({dropMenuActive: false});\n  }\n\n  render(props) {\n    return (\n      <div className='dropdown top left'>\n        <div className='dropdown-button' onClick={() => this.setState({dropMenuActive: !this.state.dropMenuActive})}>\n          {props.options.filter(t => t.active).length > 0 ? props.options.filter(t => t.active)[0].label : ''}\n        </div>\n        {\n          !this.state.dropMenuActive ? '' :\n          <div className='dropdown-menu'>\n            {\n              props.options.map(o => (\n                <div className={this.isSelected(o) ? 'dropdown-menu-item active' : 'dropdown-menu-item'} onClick={() => this.onSelect(o)}>\n                  <span>{o.label}</span>\n                  { this.isSelected(o) ? <Icon type='check' /> : '' }\n                </div>\n              ))\n            }\n          </div>\n        }\n      </div>\n    )\n  }\n}\n\nexport default DropDownMenu;\n\n\n\n// WEBPACK FOOTER //\n// ./components/dropdown-menu/dropdown-menu.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/dropdown-menu/dropdown-menu.js","//@flow\nimport { h } from 'preact';\nimport { Localizer, Text } from 'preact-i18n';\nimport { connect } from 'preact-redux';\nimport BaseComponent from '../base';\nimport SmartContainer from '../smart-container/smart-container';\nimport SmartContainerItem from '../smart-container/smart-container-item';\nimport Icon from '../icon/icon';\n\nconst mapStateToProps = state => ({\n  audioTracks: state.engine.audioTracks,\n  textTracks: state.engine.textTracks\n});\n\n@connect(mapStateToProps)\nclass LanguageControl extends BaseComponent {\n  constructor(obj: IControlParams) {\n    super({name: 'LanguageControl', player: obj.player});\n  }\n\n  componentDidMount() {\n    this.setState({smartContainerOpen: false});\n  }\n\n  onControlButtonClick() {\n    this.setState({smartContainerOpen: !this.state.smartContainerOpen});\n  }\n\n  onAudioChange(audioTrack) {\n    // this.player.selectTrack(audioTrack);\n    this.player._engine.selectTextTrack(audioTrack); // workaround untill bug fixed in playkit-js\n  }\n\n  onCaptionsChange(textTrack) {\n    // this.player.selectTrack(textTrack);\n    this.player._engine.selectTextTrack(textTrack); // workaround untill bug fixed in playkit-js\n  }\n\n  render(props) {\n    return props.audioTracks.length === 0 && props.audioTracks.length === 0 ? false : (\n      <div className='control-button-container control-language'>\n        <Localizer>\n          <button aria-label={<Text id='controls.language' />} className={this.state.smartContainerOpen ? 'control-button active' : 'control-button'} onClick={() => this.onControlButtonClick()}>\n            <Icon type='language' />\n          </button>\n        </Localizer>\n        { !this.state.smartContainerOpen ? '' :\n        <SmartContainer>\n          {\n            props.audioTracks.length <= 0 ? '' :\n            <Localizer>\n              <SmartContainerItem label={<Text id='language.audio' />} options={props.audioTracks} onSelect={audioTrack => this.onAudioChange(audioTrack)} />\n            </Localizer>\n          }\n          {\n            props.textTracks.length <= 0 ? '' :\n            <Localizer>\n              <SmartContainerItem label={<Text id='language.captions' />} options={props.textTracks} onSelect={textTrack => this.onCaptionsChange(textTrack)} />\n            </Localizer>\n          }\n          {\n            props.textTracks.length <= 0 ? '' :\n            <div className='smart-container-item'>\n              <a href='#'><Text id='language.advanced_captions_settings'>Advanced captions settings</Text></a>\n            </div>\n          }\n        </SmartContainer>\n        }\n      </div>\n    )\n  }\n}\n\nexport default LanguageControl;\n\n\n\n// WEBPACK FOOTER //\n// ./components/language/language.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/language/language.js","//@flow\nimport { h } from 'preact';\nimport { Localizer, Text } from 'preact-i18n';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/fullscreen';\nimport BaseComponent from '../base';\nimport Icon from '../icon/icon';\n\nconst mapStateToProps = state => ({\n  fullscreen: state.fullscreen.fullscreen\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass FullscreenControl extends BaseComponent {\n  _playerElement: HTMLElement;\n\n  constructor() {\n    super({name: 'Fullscreen'});\n  }\n\n  componentDidMount() {\n    this._playerElement = document.getElementsByClassName('player')[0];\n\n    document.addEventListener('webkitfullscreenchange', () => {\n      this.props.updateFullscreen(document.webkitIsFullScreen);\n    });\n  }\n\n  enterFullscreen() {\n    this._playerElement.webkitRequestFullscreen();\n  }\n  exitFullscreen() {\n    document.webkitCancelFullScreen();\n  }\n\n  toggleFullscreen() {\n    this.logger.debug(`Toggle fullscreen`);\n    this.props.fullscreen ? this.exitFullscreen() : this.enterFullscreen();\n  }\n\n  render() {\n    return (\n      <div className='control-button-container control-fullscreen'>\n        <Localizer>\n          <button aria-label={<Text id='controls.fullscreen' />} className={this.props.fullscreen ? 'control-button is-fullscreen' : 'control-button'} onClick={() => this.toggleFullscreen()}>\n            <Icon type='maximize' />\n            <Icon type='minimize' />\n          </button>\n        </Localizer>\n      </div>\n    )\n  }\n}\n\nexport default FullscreenControl;\n\n\n\n// WEBPACK FOOTER //\n// ./components/fullscreen/fullscreen.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/fullscreen/fullscreen.js","//@flow\nimport { h } from 'preact';\nimport { connect } from 'preact-redux';\nimport BaseComponent from '../base';\nimport { toHHMMSS } from '../../utils/time-format';\n\nconst mapStateToProps = state => ({\n  currentTime: state.seekbar.currentTime,\n  duration: state.engine.duration\n});\n\n@connect(mapStateToProps)\nclass TimeDisplay extends BaseComponent {\n  constructor(obj: IControlParams) {\n    super({name: 'TimeDisplay', player: obj.player, config: obj.config});\n  }\n\n  getTimeDisplay(): string {\n    var result = this.props.format ? this.props.format : 'current / total',\n        current = toHHMMSS(this.props.currentTime),\n        total = toHHMMSS(this.props.duration),\n        left = toHHMMSS(this.props.duration - this.props.currentTime);\n\n    result = result.replace(/current/g, current);\n    result = result.replace(/total/g, total);\n    result = result.replace(/left/g, left);\n\n    return result;\n  }\n\n  render() {\n    return (\n      <div className='time-display'>\n        <span>{this.getTimeDisplay()}</span>\n      </div>\n    )\n  }\n}\n\nexport default TimeDisplay;\n\n\n\n// WEBPACK FOOTER //\n// ./components/time-display/time-display.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/time-display/time-display.js","import { h, Component } from 'preact';\n\nclass TopBar extends Component {\n  render(props) {\n    return (\n      <div className='top-bar'>{ props.children }</div>\n    )\n  }\n}\n\nexport default TopBar;\n\n\n\n// WEBPACK FOOTER //\n// ./components/top-bar/top-bar.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/top-bar/top-bar.js","import { h, Component } from 'preact';\n\nclass BottomBar extends Component {\n  render(props) {\n    return (\n      <div className='bottom-bar'>{ props.children }</div>\n    )\n  }\n}\n\nexport default BottomBar;\n\n\n\n// WEBPACK FOOTER //\n// ./components/bottom-bar/bottom-bar.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/bottom-bar/bottom-bar.js","//@flow\nimport { h } from 'preact';\nimport { Text } from 'preact-i18n';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/share';\nimport BaseComponent from '../base';\nimport Overlay from '../overlay/overlay';\n\nconst mapStateToProps = state => ({\n  open: state.share.overlayOpen\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass ShareOverlay extends BaseComponent {\n  constructor() {\n    super({name: 'ShareOverlay'});\n  }\n\n  render(props) {\n    return !props.open ? '' : (\n      <Overlay open={props.open} onClose={() => props.toggleShareOverlay(false)} type='share'>\n        <div className='title'>\n          <Text id='share.share_title' />\n        </div>\n        <div className='share-icons'>\n          <a className='share-btn facebook-share-btn'>\n            <svg style='width:32px;height:32px' viewBox='0 0 1024 1024'>\n              <path fill='#fff' d='M432 405.333h-80v106.667h80v320h133.333v-320h97.12l9.547-106.667h-106.667v-44.453c0-25.467 5.12-35.547 29.733-35.547h76.933v-133.333h-101.547c-95.893 0-138.453 42.213-138.453 123.067v90.267z' />\n            </svg>\n          </a>\n          <a className='share-btn twitter-share-btn'>\n            <svg style='width:32px;height:32px' viewBox='0 0 1024 1024'>\n              <path fill='#fff' d='M832 316.614c-23.547 10.29-48.853 17.221-75.413 20.345 27.12-15.987 47.947-41.319 57.733-71.508-25.36 14.806-53.467 25.568-83.387 31.37-23.92-25.122-58.080-40.82-95.84-40.82-84.773 0-147.067 77.861-127.92 158.687-109.093-5.381-205.84-56.833-270.613-135.035-34.4 58.094-17.84 134.090 40.613 172.574-21.493-0.683-41.76-6.484-59.44-16.171-1.44 59.879 42.16 115.898 105.307 128.368-18.48 4.935-38.72 6.090-59.307 2.205 16.693 51.347 65.173 88.702 122.667 89.752-55.2 42.605-124.747 61.637-194.4 53.552 58.107 36.673 127.147 58.067 201.28 58.067 243.787 0 381.52-202.684 373.2-384.473 25.653-18.244 47.92-41.004 65.52-66.914v0z' />\n            </svg>\n          </a>\n          <a className='share-btn google-plus-share-btn'>\n            <svg style='width:32px;height:32px' viewBox='0 0 1024 1024'>\n              <path fill='#fff' d='M352 556.8h127.040c-5.12 32.928-38.4 96.64-127.040 96.64-76.48 0-138.88-63.328-138.88-141.44 0-78.080 62.4-141.44 138.88-141.44 43.52 0 72.64 18.56 89.28 34.56l60.8-58.56c-39.040-36.48-89.6-58.56-150.080-58.56-123.84 0-224 100.16-224 224s100.16 224 224 224c129.28 0 215.072-90.88 215.072-218.88 0-14.72-1.632-25.92-3.552-37.12h-211.52v76.8zM800 544v96h-64v-96h-96v-64h96v-96h64v96h96v64h-96z' />\n            </svg>\n          </a>\n          <a className='share-btn linkedin-share-btn'>\n            <svg style='width:32px;height:32px' viewBox='0 0 1024 1024'>\n              <path fill='#fff' d='M324.8 290.087c0 36.506-29.6 66.087-66.133 66.087s-66.133-29.581-66.133-66.087c0-36.48 29.6-66.087 66.133-66.087s66.133 29.607 66.133 66.087zM325.333 409.043h-133.333v422.957h133.333v-422.957zM538.187 409.043h-132.48v422.957h132.507v-222.026c0-123.45 160.773-133.549 160.773 0v222.026h133.013v-267.811c0-208.306-237.92-200.719-293.813-98.179v-56.967z' />\n            </svg>\n          </a>\n          <a className='share-btn email-share-btn'>\n            <svg style='width:32px;height:32px' viewBox='0 0 1024 1024'>\n              <path fill='#fff' d='M256 768c-35.346 0-64-28.654-64-64v-352c0-35.346 28.654-64 64-64h512c35.346 0 64 28.654 64 64v352c0 35.346-28.654 64-64 64h-512zM512 467.488l147.52-115.488h-295.040l147.52 115.488zM748.48 352l-211.2 179.2c-0.713 1.308-1.572 2.532-2.56 3.648-12.707 12.158-32.733 12.158-45.44 0-0.988-1.116-1.847-2.34-2.56-3.648l-211.2-179.2h-19.52v352h512v-352h-19.52z' />\n            </svg>\n          </a>\n          <a className='share-btn embed-share-btn'>\n            <svg style='width:32px;height:32px' viewBox='0 0 1024 1024'>\n              <path fill='#fff' d='M377.989 579.335c12.669 12.904 12.669 33.777 0 46.68-12.733 12.969-33.427 12.969-46.16 0l-104.727-106.667c-12.669-12.904-12.669-33.777 0-46.68l104.727-106.667c12.733-12.969 33.427-12.969 46.16 0 12.669 12.904 12.669 33.777 0 46.68l-81.812 83.327 81.812 83.327zM646.011 412.68c-12.669-12.904-12.669-33.777 0-46.68 12.733-12.969 33.427-12.969 46.16 0l104.727 106.667c12.669 12.904 12.669 33.777 0 46.68l-104.727 106.667c-12.733 12.969-33.427 12.969-46.16 0-12.669-12.904-12.669-33.777 0-46.68l81.812-83.327-81.812-83.327zM572.293 250.6c17.455 4.445 28.025 22.388 23.686 40.066l-104.727 426.669c-4.349 17.719-22.048 28.535-39.545 24.079-17.455-4.445-28.025-22.388-23.686-40.066l104.727-426.669c4.349-17.719 22.048-28.535 39.545-24.079z' />\n            </svg>\n          </a>\n        </div>\n        <div>\n          <div className='form-group has-icon' style='width: 300px;'>\n            <input type='text' placeholder='Share URL' className='form-control' value='https://cdnapisec.kaltura.com/index.php?assetId=123456' readOnly />\n            <svg className='icon' style='width:32px;height:32px;' viewBox='0 0 1024 1024'>\n              <path d='M355.028 445.537c12.497 12.497 12.497 32.758 0 45.255s-32.758 12.497-45.255 0l-24.141-24.141c-49.92-49.92-49.832-130.999 0.094-180.925 49.984-49.984 130.995-50.025 180.955-0.064l113.266 113.266c49.964 49.964 49.935 130.955-0.064 180.955-12.497 12.497-32.758 12.497-45.255 0s-12.497-32.758 0-45.255c25.013-25.013 25.027-65.482 0.064-90.445l-113.266-113.266c-24.957-24.957-65.445-24.936-90.445 0.064-24.955 24.955-24.998 65.511-0.094 90.416l24.141 24.141zM668.972 578.463c-12.497-12.497-12.497-32.758 0-45.255s32.758-12.497 45.255 0l24.141 24.141c49.92 49.92 49.832 130.999-0.094 180.925-49.984 49.984-130.995 50.025-180.955 0.064l-113.266-113.266c-49.964-49.964-49.935-130.955 0.064-180.955 12.497-12.497 32.758-12.497 45.255 0s12.497 32.758 0 45.255c-25.013 25.013-25.027 65.482-0.064 90.445l113.266 113.266c24.957 24.957 65.445 24.936 90.445-0.064 24.955-24.955 24.998-65.511 0.094-90.416l-24.141-24.141z' />\n            </svg>\n          </div>\n        </div>\n        <a><Text id='share.link_options' /></a>\n      </Overlay>\n    )\n  }\n}\n\nexport default ShareOverlay;\n\n\n\n// WEBPACK FOOTER //\n// ./components/share-overlay/share-overlay.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/share-overlay/share-overlay.js","//@flow\nimport { h } from 'preact';\nimport { connect } from 'preact-redux';\nimport { bindActions } from '../../utils/bind-actions';\nimport { actions } from '../../reducers/cvaa';\nimport BaseComponent from '../base';\nimport Overlay from '../overlay/overlay';\n\nconst mapStateToProps = state => ({\n  open: state.cvaa.overlayOpen\n});\n\n@connect(mapStateToProps, bindActions(actions))\nclass CVAAOverlay extends BaseComponent {\n  constructor() {\n    super({name: 'CVAAOverlay'});\n  }\n\n  render(props) {\n    return !props.open ? '' : (\n      <Overlay type='cvaa'>\n        <div className='title'>\n          Advanced captions settings\n        </div>\n        <div className='sample'>Sample</div>\n        <div className='sample black-bg'>Sample</div>\n        <div className='sample yellow-text'>Sample</div>\n      </Overlay>\n    )\n  }\n}\n\nexport default CVAAOverlay;\n\n\n\n// WEBPACK FOOTER //\n// ./components/cvaa-overlay/cvaa-overlay.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/cvaa-overlay/cvaa-overlay.js","//@flow\nimport BaseComponent from './base';\n\nclass KeyboardControl extends BaseComponent {\n  // _playerElement: HTMLElement;\n\n  constructor(obj: IControlParams) {\n    super({name: 'Keyboard', player: obj.player});\n\n    // this._playerElement = document.getElementsByClassName('player')[0];\n\n    document.body.onkeydown = (e) => {\n      let time, newVolume;\n      switch(e.which) {\n        case 32: // space\n        this.logger.debug(\"Keydown space\");\n        this.player.paused ? this.player.play() : this.player.pause();\n        break;\n\n        case 38: // up\n        this.logger.debug(\"Keydown up\");\n        newVolume = Math.round(this.player.volume * 100) + 5;\n        this.logger.debug(`Changing volume. ${this.player.volume} => ${newVolume}`);\n        if (this.player.muted) {\n          this.player.muted = false;\n        }\n        this.player.volume = newVolume / 100;\n        break;\n\n        case 40: // down\n        this.logger.debug(\"Keydown down\");\n        newVolume = Math.round(this.player.volume * 100) - 5;\n        if (newVolume < 5) {\n          this.player.muted = true;\n          return;\n        }\n        this.logger.debug(`Changing volume. ${this.player.volume} => ${newVolume}`);\n        this.player.volume = newVolume / 100;\n        break;\n\n        case 37: // left\n        this.logger.debug(\"Keydown left\");\n        time = (this.player.currentTime - 5) > 0 ? this.player.currentTime - 5 : 0;\n        this.player.currentTime = time;\n        break;\n\n        case 39: // right\n        this.logger.debug(\"Keydown right\");\n        time = (this.player.currentTime + 5) > this.player.duration ? this.player.duration : this.player.currentTime + 5;\n        this.player.currentTime = time;\n        break;\n\n        default: return;\n      }\n    }\n\n    this.disableKeyboardCommandsOnControls();\n  }\n\n  disableKeyboardCommandsOnControls() {\n    let controlButtonsElements = Array.from(document.getElementsByClassName('control-button'));\n    controlButtonsElements.forEach((element) => {\n      element.onkeydown = (e) => e.preventDefault();\n    });\n  }\n}\n\nexport default KeyboardControl;\n\n\n\n// WEBPACK FOOTER //\n// ./components/keyboard.js\n\n\n// WEBPACK FOOTER //\n// webpack:///ui/components/keyboard.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../css-loader/index.js!./style.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../css-loader/index.js!./style.css\", function() {\n\t\t\tvar newContent = require(\"!!../../../css-loader/index.js!./style.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/playkit-js-ui/src/styles/style.css\n// module id = 5\n// module chunks = 0","exports = module.exports = require(\"../../../css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".row{display:block}.row:after{content:'';clear:both;display:block}.form-group{margin:10px auto;position:relative;max-width:100%}.form-group.has-error .form-control{border-color:#db1f26}.form-group.has-error .form-control:focus{border-color:#fff}.form-group.has-icon .form-control{padding-left:34px}.form-group .icon{position:absolute;top:2px;left:2px;fill:rgba(255,255,255,0.4)}.form-control{height:36px;width:100%;min-width:72px;border:2px solid rgba(255,255,255,0.2);border-radius:4px;background-color:rgba(0,0,0,0.4);font-size:15px;line-height:18px;color:#fff;padding:8px 10px;text-overflow:ellipsis}.form-control::-webkit-input-placeholder{color:rgba(255,255,255,0.6)}.form-control:focus{background-color:#fff;border-color:#fff;color:#333}.form-control:focus::-webkit-input-placeholder{color:#ccc}.form-control:focus+.icon{fill:#999}textarea.form-control{min-height:72px}@-webkit-keyframes openDropmenu{from{opacity:0;-webkit-transform:translateY(10px);transform:translateY(10px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes openDropmenu{from{opacity:0;-webkit-transform:translateY(10px);transform:translateY(10px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}.dropdown{position:relative}.dropdown.active .dropdown-menu{display:block;opacity:1}.dropdown.top .dropdown-menu{margin-bottom:10px;bottom:100%}.dropdown.bottom .dropdown-menu{margin-top:10px;top:100%}.dropdown.right .dropdown-menu{left:0}.dropdown.left .dropdown-menu{right:0}.dropdown .dropdown-button{font-size:15px;font-weight:bold;line-height:18px;color:#fff;cursor:pointer}.dropdown .dropdown-menu{display:block;opacity:1;position:absolute;background-color:#333333;box-shadow:0 2px 8px 0 rgba(0,0,0,0.3);border-radius:4px;padding:6px 0;z-index:5;-webkit-animation:openDropmenu 100ms ease-out forwards;animation:openDropmenu 100ms ease-out forwards;max-height:173px;overflow-y:auto}.dropdown .dropdown-menu .dropdown-menu-item{padding:2px 10px 2px 16px;white-space:nowrap;min-height:30px;cursor:pointer}.dropdown .dropdown-menu .dropdown-menu-item:hover{color:#fff}.dropdown .dropdown-menu .dropdown-menu-item.active{color:#01ACCD;fill:#01ACCD}.dropdown .dropdown-menu .dropdown-menu-item .check-icon{display:inline-block;margin-left:16px;vertical-align:middle;width:24px;height:24px}.dropdown .dropdown-menu .dropdown-menu-item span{vertical-align:middle;line-height:26px}.tooltip{display:inline-block;height:22px;border-radius:4px;background-color:#FFFFFF;padding:3px 13px;color:#333333;font-size:13px;font-weight:bold;line-height:16px;box-shadow:0 0 8px 0 rgba(0,0,0,0.3)}.player .control-button{width:32px;height:32px;background:transparent;display:inline-block;opacity:0.8;border:none;padding:0;cursor:pointer;fill:#fff}.player .control-button svg{width:32px;height:32px}.player .control-button:hover,.player .control-button.active{opacity:1}.player .control-button.control-button-rounded{width:36px;height:36px;padding:2px}.player .control-button.control-button-rounded:hover{background-color:rgba(0,0,0,0.4);border-radius:18px}.player .control-button-container{display:inline-block;position:relative;vertical-align:top}a{color:#01ACCD;text-decoration:underline;font-size:15px;line-height:18px}a:hover{color:#01819a}a:active{opacity:0.7}.player{position:relative;max-width:854px;width:100%;background-color:#000;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.player:-webkit-full-screen{width:100%;height:100%;max-width:none}.player *{box-sizing:border-box;outline:none}.player ::-moz-selection{background-color:rgba(0,0,0,0.1)}.player ::selection{background-color:rgba(0,0,0,0.1)}.player video{width:100%}.player .player-gui{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;overflow:hidden;font-size:0;font-family:\\\"Lato\\\",sans-serif}.player .player-gui input,.player .player-gui textarea{font-family:\\\"Lato\\\",sans-serif}.player.metadata-loaded .player-gui,.player.state-paused .player-gui,.player.overlay-active .player-gui,.player.menu-active .player-gui{opacity:1}video::-webkit-media-controls{display:none !important}video::-webkit-media-controls-start-playback-button{display:none !important;-webkit-appearance:none}@-webkit-keyframes openOverlay{from{opacity:0}to{opacity:1}}@keyframes openOverlay{from{opacity:0}to{opacity:1}}.overlay{position:absolute;display:none;opacity:0;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.42);z-index:4;text-align:center;color:#fff;padding:80px 20px 0;-webkit-animation:openOverlay 100ms ease-in-out forwards;animation:openOverlay 100ms ease-in-out forwards}.overlay.active{display:block;opacity:1}.overlay .title{font-size:24px;font-weight:bold;line-height:29px;margin-bottom:60px}.overlay .close-overlay{position:absolute;top:48px;right:48px;z-index:5;fill:#fff;cursor:pointer}.overlay .close-overlay .icon-close{width:24px;height:24px}@media screen and (max-width: 768px){.overlay{padding:36px 20px 0}.overlay .close-overlay{top:38px}.overlay .title{margin-bottom:24px}}@media screen and (max-width: 480px){.overlay{padding:16px 24px 0}.overlay .close-overlay{top:15px;right:24px}.overlay .title{font-size:16px;line-height:19px;margin-bottom:36px}}@-webkit-keyframes openSmartContainer{from{opacity:0;-webkit-transform:translateY(10px);transform:translateY(10px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes openSmartContainer{from{opacity:0;-webkit-transform:translateY(10px);transform:translateY(10px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}.smart-container{background-color:#222222;box-shadow:0 2px 8px 0 rgba(0,0,0,0.3);border-radius:4px;position:absolute;right:0px;min-width:193px;font-size:15px;z-index:5;display:block;-webkit-animation:openSmartContainer 100ms ease-out forwards;animation:openSmartContainer 100ms ease-out forwards}.smart-container.top{bottom:100%;margin-bottom:6px}.smart-container.top:before{display:block;content:' ';position:absolute;bottom:-6px;left:0;width:100%;height:6px}.smart-container.bottom{top:100%;margin-top:6px}.smart-container.right{left:0px}.smart-container.left{right:0px}.smart-container .smart-container-item{margin:16px;color:rgba(244,244,244,0.8);white-space:nowrap}.smart-container .smart-container-item:after{display:block;content:' ';clear:both}.smart-container .smart-container-item.select-menu-item label{float:left}.smart-container .smart-container-item.select-menu-item .dropdown{float:right}.overlay.share-overlay .share-icons{margin:60px 0}.overlay.share-overlay .share-btn{height:36px;width:36px;border-radius:18px;background-color:rgba(0,0,0,0.4);display:inline-block;margin:0 8px;-webkit-transition:-webkit-transform 100ms;transition:transform 100ms;will-change:transform;padding:2px}.overlay.share-overlay .share-btn:hover{-webkit-transform:scale(1.1667);-ms-transform:scale(1.1667);transform:scale(1.1667)}.overlay.share-overlay .share-btn.facebook-share-btn{background-color:#3B5998}.overlay.share-overlay .share-btn.twitter-share-btn{background-color:#1DA1F2}.overlay.share-overlay .share-btn.google-plus-share-btn{background-color:#DD4B39}.overlay.share-overlay .share-btn.linkedin-share-btn{background-color:#00A0DC}@media screen and (max-width: 768px){.overlay.share-overlay .share-icons{margin:40px 0}}@media screen and (max-width: 480px){.overlay.share-overlay .share-icons{margin:20px 0}}.overlay.cvaa-overlay .sample{border:2px solid rgba(255,255,255,0.2);border-radius:4px;font-size:16px;font-weight:bold;line-height:36px;text-align:center;padding:0 28px;display:inline-block;margin:0 12px;cursor:pointer}.overlay.cvaa-overlay .sample.black-bg{background-color:#000}.overlay.cvaa-overlay .sample.yellow-text{color:#FAFF00}@-webkit-keyframes kaltura-spinner{0%{-webkit-transform:rotate(0deg) scale(0.7);transform:rotate(0deg) scale(0.7);opacity:1}70%{-webkit-transform:rotate(360deg) scale(0.7);transform:rotate(360deg) scale(0.7);opacity:1}82%{-webkit-transform:rotate(360deg) scale(0);transform:rotate(360deg) scale(0);opacity:0}87%{-webkit-transform:rotate(360deg) scale(0.9);transform:rotate(360deg) scale(0.9);opacity:1}100%{-webkit-transform:rotate(360deg) scale(0.7);transform:rotate(360deg) scale(0.7);opacity:1}}@keyframes kaltura-spinner{0%{-webkit-transform:rotate(0deg) scale(0.7);transform:rotate(0deg) scale(0.7);opacity:1}70%{-webkit-transform:rotate(360deg) scale(0.7);transform:rotate(360deg) scale(0.7);opacity:1}82%{-webkit-transform:rotate(360deg) scale(0);transform:rotate(360deg) scale(0);opacity:0}87%{-webkit-transform:rotate(360deg) scale(0.9);transform:rotate(360deg) scale(0.9);opacity:1}100%{-webkit-transform:rotate(360deg) scale(0.7);transform:rotate(360deg) scale(0.7);opacity:1}}.loading-backdrop{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.3);-webkit-transition:100ms opacity;transition:100ms opacity;opacity:0}.loading-backdrop.show{opacity:1}.loading-backdrop.show .spinner-container{display:block}.loading-backdrop .spinner-container{display:none;position:absolute;top:50%;left:50%;-webkit-transform:translate3d(-50px, -50px, 0);transform:translate3d(-50px, -50px, 0)}.spinner{width:100px;height:100px;position:relative;-webkit-animation:kaltura-spinner 2.5s infinite;animation:kaltura-spinner 2.5s infinite}.spinner span{width:8px;height:8px;background-color:#fff;display:block;border-radius:8px;position:absolute;top:50%;left:50%;margin-top:-4px;margin-left:-4px}.spinner span:nth-child(1){-webkit-transform:rotate(45deg) translateX(-25px) translateY(-25px);-ms-transform:rotate(45deg) translateX(-25px) translateY(-25px);transform:rotate(45deg) translateX(-25px) translateY(-25px);background-color:#da1f26}.spinner span:nth-child(2){-webkit-transform:rotate(90deg) translateX(-25px) translateY(-25px);-ms-transform:rotate(90deg) translateX(-25px) translateY(-25px);transform:rotate(90deg) translateX(-25px) translateY(-25px);background-color:#06a885}.spinner span:nth-child(3){-webkit-transform:rotate(135deg) translateX(-25px) translateY(-25px);-ms-transform:rotate(135deg) translateX(-25px) translateY(-25px);transform:rotate(135deg) translateX(-25px) translateY(-25px);background-color:#009344}.spinner span:nth-child(4){-webkit-transform:rotate(180deg) translateX(-25px) translateY(-25px);-ms-transform:rotate(180deg) translateX(-25px) translateY(-25px);transform:rotate(180deg) translateX(-25px) translateY(-25px);background-color:#f8a61a}.spinner span:nth-child(5){-webkit-transform:rotate(225deg) translateX(-25px) translateY(-25px);-ms-transform:rotate(225deg) translateX(-25px) translateY(-25px);transform:rotate(225deg) translateX(-25px) translateY(-25px);background-color:#1b4a97}.spinner span:nth-child(6){-webkit-transform:rotate(270deg) translateX(-25px) translateY(-25px);-ms-transform:rotate(270deg) translateX(-25px) translateY(-25px);transform:rotate(270deg) translateX(-25px) translateY(-25px);background-color:#00abcc}.spinner span:nth-child(7){-webkit-transform:rotate(315deg) translateX(-25px) translateY(-25px);-ms-transform:rotate(315deg) translateX(-25px) translateY(-25px);transform:rotate(315deg) translateX(-25px) translateY(-25px);background-color:#b1d238}.spinner span:nth-child(8){-webkit-transform:rotate(360deg) translateX(-25px) translateY(-25px);-ms-transform:rotate(360deg) translateX(-25px) translateY(-25px);transform:rotate(360deg) translateX(-25px) translateY(-25px);background-color:#fcd203}.control-button-container.control-play-pause .control-button{-webkit-transition:400ms -webkit-transform;transition:400ms transform}.control-button-container.control-play-pause .control-button .icon-pause{-webkit-transition:400ms opacity;transition:400ms opacity;opacity:0;display:none}.control-button-container.control-play-pause .control-button .icon-play{-webkit-transition:400ms opacity;transition:400ms opacity;opacity:1;display:block}.control-button-container.control-play-pause .control-button.is-playing{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg)}.control-button-container.control-play-pause .control-button.is-playing .icon-pause{opacity:1;display:block}.control-button-container.control-play-pause .control-button.is-playing .icon-play{opacity:0;display:none}@media screen and (max-width: 480px){.control-button-container.control-play-pause{display:none}}.control-button-container.volume-control:hover .volume-control-bar{display:block !important}.control-button-container.volume-control.is-muted .volume-waves{opacity:0;-webkit-transform:translateX(-5px);-ms-transform:translateX(-5px);transform:translateX(-5px)}.control-button-container.volume-control.is-muted .volume-mute{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.control-button-container.volume-control.dragging-active .volume-control-bar{display:block}.control-button-container.volume-control .volume-waves{-webkit-transform:translateX(0px);-ms-transform:translateX(0px);transform:translateX(0px)}.control-button-container.volume-control .volume-mute{opacity:1;-webkit-transform:scale(0);-ms-transform:scale(0);transform:scale(0)}.control-button-container.volume-control .volume-waves,.control-button-container.volume-control .volume-mute{-webkit-transition:300ms -webkit-transform, 300ms opacity;transition:300ms transform, 300ms opacity}.control-button-container.volume-control svg{position:absolute;top:0;left:0}.volume-control-bar{position:absolute;z-index:2;bottom:38px;left:0px;display:block;height:112px;width:34px;border-radius:4px;box-shadow:0 2px 8px 0 rgba(0,0,0,0.3);background-color:#333333;padding:6px;display:none}.volume-control-bar:before{position:absolute;width:34px;height:14px;bottom:-8px;left:0;content:' ';display:block}.volume-control-bar .bar{background-color:#424242;height:100%;position:relative;cursor:ns-resize}.volume-control-bar .progress{position:absolute;bottom:0px;left:0px;width:100%;border-radius:0 0 2px 2px;background-color:#01ACCD}.control-button-container.control-fullscreen .control-button{-webkit-transition:100ms -webkit-transform;transition:100ms transform;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.control-button-container.control-fullscreen .control-button .icon-minimize{display:none}.control-button-container.control-fullscreen .control-button:hover{-webkit-transform:scale(1.1);-ms-transform:scale(1.1);transform:scale(1.1)}.control-button-container.control-fullscreen .control-button.is-fullscreen .icon-maximize{display:none}.control-button-container.control-fullscreen .control-button.is-fullscreen .icon-minimize{display:block}.player .seek-bar{padding:6px 0;cursor:pointer}.player .seek-bar:hover .progress-bar .scrubber,.player .seek-bar.dragging-active .progress-bar .scrubber{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.player .seek-bar:hover .progress-bar .virtual-progress,.player .seek-bar.dragging-active .progress-bar .virtual-progress{display:block}.player .seek-bar .progress-bar{height:4px;background-color:rgba(255,255,255,0.3);border-radius:2px;position:relative}.player .seek-bar .progress-bar .progress{position:absolute;top:0;left:0;height:100%;z-index:2;border-radius:2px 0 0 2px;background-color:#01ACCD}.player .seek-bar .progress-bar .virtual-progress{display:none}.player .seek-bar .progress-bar .buffered,.player .seek-bar .progress-bar .virtual-progress{position:absolute;top:0;left:0;height:100%;z-index:1;border-radius:2px 0 0 2px;background-color:rgba(255,255,255,0.3)}.player .seek-bar .progress-bar .buffered .frame-preview-img,.player .seek-bar .progress-bar .virtual-progress .frame-preview-img{background-size:auto 100%;width:100%;height:100%;position:relative}.player .seek-bar .progress-bar .buffered .frame-preview,.player .seek-bar .progress-bar .virtual-progress .frame-preview{position:absolute;bottom:16px;right:0;-webkit-transform:translateX(50%);-ms-transform:translateX(50%);transform:translateX(50%);height:94px;width:164px;border:2px solid rgba(255,255,255,0.2);border-radius:4px}.player .seek-bar .progress-bar .buffered .time-preview,.player .seek-bar .progress-bar .virtual-progress .time-preview{position:absolute;bottom:22px;right:0;-webkit-transform:translateX(50%);-ms-transform:translateX(50%);transform:translateX(50%);height:22px;min-width:48px;padding:0 3px;text-align:center;border-radius:3px;background-color:rgba(0,0,0,0.7);font-size:13px;font-weight:bold;line-height:22px;color:#fff}.player .seek-bar .progress-bar .scrubber{position:absolute;z-index:3;cursor:pointer;display:block;top:-6px;right:-8px;border-radius:8px;height:16px;width:16px;background-color:#FFFFFF;box-shadow:0 0 31px 0 rgba(0,0,0,0.3);-webkit-transform:scale(0);-ms-transform:scale(0);transform:scale(0);-webkit-transition:100ms -webkit-transform;transition:100ms transform}.player .seek-bar .progress-bar .scrubber:active{opacity:1;cursor:-webkit-grabbing;cursor:grabbing}@media screen and (max-width: 480px){.virtual-progress{display:none}}.player .time-display{display:inline-block;line-height:32px;vertical-align:top;font-size:14px;padding:0 23px;font-weight:bold}@media screen and (max-width: 480px){.player .time-display{padding:0 12px 0 0}}.player .video-playing-title{font-size:15px;font-weight:bold;line-height:18px;padding:6px 0}.player .bottom-bar{position:absolute;bottom:0;left:0;width:100%;background:-webkit-linear-gradient(270deg, transparent 0%, rgba(0,0,0,0.6) 100%);background:linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.6) 100%);padding:6px 16px;color:#fff;opacity:0;-webkit-transition:100ms opacity;transition:100ms opacity}.player .bottom-bar .left-controls{float:left;text-align:left}.player .bottom-bar .right-controls{float:right;text-align:left}.player .bottom-bar .right-controls .control-button-container{margin:0 6px}.player .bottom-bar .right-controls .control-button-container:last-child{margin-right:0}.player:hover .bottom-bar,.player.hover .bottom-bar,.player.state-paused .bottom-bar,.player.menu-active .bottom-bar{opacity:1}.player.overlay-active .bottom-bar{opacity:0}@media screen and (max-width: 480px){.player .bottom-bar{padding:6px 8px}}.player .top-bar{position:absolute;top:0;left:0;width:100%;background:-webkit-linear-gradient(90deg, transparent 0%, rgba(0,0,0,0.6) 100%);background:linear-gradient(0deg, transparent 0%, rgba(0,0,0,0.6) 100%);padding:14px 16px;color:#fff;opacity:0;-webkit-transition:100ms opacity;transition:100ms opacity}.player .top-bar .left-controls{float:left;text-align:left}.player .top-bar .right-controls{float:right;text-align:left}.player .top-bar .right-controls .control-button-container{margin:0 6px}.player .top-bar .right-controls .control-button-container:last-child{margin-right:0}.player:hover .top-bar,.player.hover .top-bar,.player.state-paused .top-bar,.player.menu-active .top-bar{opacity:1}.player.overlay-active .top-bar{opacity:0}@media screen and (max-width: 480px){.player .top-bar{padding:8px 8px 20px 8px}}@-webkit-keyframes overlayPlayIconIn{from{opacity:1;-webkit-transform:scale(0);transform:scale(0)}to{opacity:0;-webkit-transform:scale(1);transform:scale(1)}}@keyframes overlayPlayIconIn{from{opacity:1;-webkit-transform:scale(0);transform:scale(0)}to{opacity:0;-webkit-transform:scale(1);transform:scale(1)}}.overlay-play{position:absolute;top:0;left:0;width:100%;height:100%}.overlay-play.in .icon{-webkit-animation:overlayPlayIconIn 400ms linear forwards;animation:overlayPlayIconIn 400ms linear forwards}.overlay-play .icon{width:144px;height:144px;fill:#fff;position:absolute;top:50%;left:50%;margin:-72px 0 0 -72px;opacity:0}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader!../node_modules/playkit-js-ui/src/styles/style.css\n// module id = 6\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader/lib/css-base.js\n// module id = 7\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(selector) {\n\t\tif (typeof memo[selector] === \"undefined\") {\n\t\t\tmemo[selector] = fn.call(this, selector);\n\t\t}\n\n\t\treturn memo[selector]\n\t};\n})(function (target) {\n\treturn document.querySelector(target)\n});\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton) options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n\tif (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\toptions.attrs.type = \"text/css\";\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/style-loader/lib/addStyles.js\n// module id = 8\n// module chunks = 0","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/style-loader/lib/urls.js\n// module id = 9\n// module chunks = 0","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"hls.js\"), require(\"playkit-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"hls.js\", \"playkit-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PlaykitJsHls\"] = factory(require(\"hls.js\"), require(\"playkit-js\"));\n\telse\n\t\troot[\"PlaykitJsHls\"] = factory(root[\"Hls\"], root[\"Playkit\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition\n\n\n// WEBPACK FOOTER //\n// webpack:///hls/webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3d553f6cfbde57d4496a\n\n\n// WEBPACK FOOTER //\n// webpack:/hls/webpack/bootstrap 3d553f6cfbde57d4496a","//@flow\nimport Hlsjs from 'hls.js'\nimport {registerMediaSourceAdapter, BaseMediaSourceAdapter} from 'playkit-js'\nimport {Track, VideoTrack, AudioTrack, TextTrack} from 'playkit-js'\n\n/**\n * Adapter of hls.js lib for hls content\n * @classdesc\n */\nexport default class HlsAdapter extends BaseMediaSourceAdapter {\n  /**\n   * The id of the adapter.\n   * @member {string} id\n   * @static\n   * @private\n   */\n  static id: string = 'HlsAdapter';\n  /**\n   * The adapter logger.\n   * @member {any} _logger\n   * @static\n   * @private\n   */\n  static _logger = BaseMediaSourceAdapter.getLogger(HlsAdapter.id);\n  /**\n   * The supported mime types by the hls adapter.\n   * @member {Array<string>} _hlsMimeType\n   * @static\n   * @private\n   */\n  static _hlsMimeTypes: Array<string> = [\n    'application/x-mpegurl',\n    'application/vnd.apple.mpegurl',\n    'audio/mpegurl',\n    'audio/x-mpegurl',\n    'video/x-mpegurl',\n    'video/mpegurl',\n    'application/mpegurl'\n  ];\n  /**\n   * The hls player instance.\n   * @member {any} _hls\n   * @private\n   */\n  _hls: any;\n  /**\n   * The load promise\n   * @member {Promise<Object>} - _loadPromise\n   * @type {Promise<Object>}\n   * @private\n   */\n  _loadPromise: ?Promise<Object>;\n  /**\n   * Reference to the player tracks.\n   * @member {Array<Track>} - _playerTracks\n   * @type {Array<Track>}\n   * @private\n   */\n  _playerTracks: Array<Track>;\n\n  /**\n   * Checks if hls adapter can play a given mime type.\n   * @function canPlayType\n   * @param {string} mimeType - The mime type to check.\n   * @returns {boolean} - Whether the hls adapter can play a specific mime type.\n   * @static\n   */\n  static canPlayType(mimeType: string): boolean {\n    let canHlsPlayType = (typeof mimeType === 'string') ? HlsAdapter._hlsMimeTypes.includes(mimeType.toLowerCase()) : false;\n    HlsAdapter._logger.debug('canPlayType result for mimeType:' + mimeType + ' is ' + canHlsPlayType.toString());\n    return canHlsPlayType;\n  }\n\n  /**\n   * Checks if the hls adapter is supported.\n   * @function isSupported\n   * @returns {boolean} - Whether hls is supported.\n   * @static\n   */\n  static isSupported(): boolean {\n    let isHlsSupported = Hlsjs.isSupported();\n    HlsAdapter._logger.debug('isSupported:' + isHlsSupported);\n    return isHlsSupported;\n  }\n\n  /**\n   * @constructor\n   * @param {HTMLVideoElement} videoElement - The video element which will bind to the hls adapter\n   * @param {Object} source - The source object\n   * @param {Object} config - The media source adapter configuration\n   */\n  constructor(videoElement: HTMLVideoElement, source: Source, config: Object) {\n    HlsAdapter._logger.debug('Creating adapter. Hls version: ' + Hlsjs.version);\n    super(videoElement, source, config);\n    this._hls = new Hlsjs(this._config);\n    this._addBindings();\n  }\n\n  /**\n   * Adds the required bindings with hls.js.\n   * @function _addBindings\n   * @private\n   * @returns {void}\n   */\n  _addBindings(): void {\n    this._hls.on(Hlsjs.Events.ERROR, this._onError.bind(this));\n    this._hls.on(Hlsjs.Events.LEVEL_SWITCHED, this._onLevelSwitched.bind(this));\n    this._hls.on(Hlsjs.Events.AUDIO_TRACK_SWITCHED, this._onAudioTrackSwitched.bind(this));\n  }\n\n  /**\n   * Load the video source\n   * @function load\n   * @returns {Promise<Object>} - The loaded data\n   * @override\n   */\n  load(): Promise<Object> {\n    if (!this._loadPromise) {\n      this._loadPromise = new Promise((resolve) => {\n        this._hls.on(Hlsjs.Events.MANIFEST_LOADED, (event: string, data: any) => {\n          HlsAdapter._logger.debug('The source has been loaded successfully');\n          this._playerTracks = this._parseTracks(data);\n          resolve({tracks: this._playerTracks});\n        });\n        if (this._sourceObj && this._sourceObj.url) {\n          this._hls.loadSource(this._sourceObj.url);\n          this._hls.attachMedia(this._videoElement);\n        }\n      });\n    }\n    return this._loadPromise;\n  }\n\n  /**\n   * Destroying the hls adapter.\n   * @function destroy\n   * @override\n   */\n  destroy(): void {\n    HlsAdapter._logger.debug('destroy');\n    super.destroy();\n    this._loadPromise = null;\n    this._removeBindings();\n    this._hls.detachMedia();\n    this._hls.destroy();\n  }\n\n  /**\n   * Parse the hls tracks into player tracks.\n   * @param {any} data - The event data.\n   * @returns {Array<Track>} - The parsed tracks.\n   * @private\n   */\n  _parseTracks(data: any): Array<Track> {\n    let audioTracks = this._parseAudioTracks(data.audioTracks || []);\n    let videoTracks = this._parseVideoTracks(data.levels || []);\n    let textTracks = this._parseTextTracks(this._videoElement.textTracks || []);\n    return audioTracks.concat(videoTracks).concat(textTracks);\n  }\n\n  /**\n   * Parse hls audio tracks into player audio tracks.\n   * @param {Array<Object>} hlsAudioTracks - The hls audio tracks.\n   * @returns {Array<AudioTrack>} - The parsed audio tracks.\n   * @private\n   */\n  _parseAudioTracks(hlsAudioTracks: Array<Object>): Array<AudioTrack> {\n    let audioTracks = [];\n    for (let i = 0; i < hlsAudioTracks.length; i++) {\n      // Create audio tracks\n      let settings = {\n        id: hlsAudioTracks[i].id,\n        active: this._hls.audioTrack === hlsAudioTracks[i].id,\n        label: hlsAudioTracks[i].name,\n        language: hlsAudioTracks[i].lang,\n        index: i\n      };\n      audioTracks.push(new AudioTrack(settings));\n    }\n    return audioTracks;\n  }\n\n  /**\n   * Parse hls video tracks into player video tracks.\n   * @param {Array<Object>} hlsVideoTracks - The hls video tracks.\n   * @returns {Array<VideoTrack>} - The parsed video tracks.\n   * @private\n   */\n  _parseVideoTracks(hlsVideoTracks: Array<Object>): Array<VideoTrack> {\n    let videoTracks = [];\n    for (let i = 0; i < hlsVideoTracks.length; i++) {\n      // Create video tracks\n      let settings = {\n        active: this._hls.startLevel === i,\n        label: hlsVideoTracks[i].name,\n        bandwidth: hlsVideoTracks[i].bitrate,\n        language: '',\n        index: i\n      };\n      videoTracks.push(new VideoTrack(settings));\n    }\n    return videoTracks;\n  }\n\n  /**\n   * Parse native video tag text tracks into player text tracks.\n   * @param {TextTrackList} vidTextTracks - The native video tag text tracks.\n   * @returns {Array<TextTrack>} - The parsed text tracks.\n   * @private\n   */\n  _parseTextTracks(vidTextTracks: TextTrackList | Array<Object>): Array<TextTrack> {\n    let textTracks = [];\n    for (let i = 0; i < vidTextTracks.length; i++) {\n      // Create text tracks\n      let settings = {\n        active: vidTextTracks[i].mode === 'showing',\n        label: vidTextTracks[i].label,\n        kind: vidTextTracks[i].kind,\n        language: vidTextTracks[i].language,\n        index: i\n      };\n      textTracks.push(new TextTrack(settings));\n    }\n    return textTracks;\n  }\n\n  /**\n   * Select an audio track.\n   * @function selectAudioTrack\n   * @param {AudioTrack} audioTrack - the audio track to select.\n   * @returns {void}\n   * @public\n   */\n  selectAudioTrack(audioTrack: AudioTrack): void {\n    if (audioTrack instanceof AudioTrack && !audioTrack.active && this._hls.audioTracks) {\n      this._hls.audioTrack = audioTrack.id;\n    }\n  }\n\n  /**\n   * Select a video track.\n   * @function selectVideoTrack\n   * @param {VideoTrack} videoTrack - the track to select.\n   * @returns {void}\n   * @public\n   */\n  selectVideoTrack(videoTrack: VideoTrack): void {\n    if (videoTrack instanceof VideoTrack && (!videoTrack.active || this._hls.autoLevelEnabled) && this._hls.levels) {\n      this._hls.nextLevel = videoTrack.index;\n    }\n  }\n\n  /**\n   * Select a text track.\n   * @function selectTextTrack\n   * @param {TextTrack} textTrack - the track to select.\n   * @returns {void}\n   * @public\n   */\n  selectTextTrack(textTrack: TextTrack): void {\n    if (textTrack instanceof TextTrack && !textTrack.active && this._videoElement.textTracks) {\n      this._disableAllTextTracks();\n      this._videoElement.textTracks[textTrack.index].mode = 'showing';\n      HlsAdapter._logger.debug('Text track changed', textTrack);\n      this._onTrackChanged(textTrack);\n    }\n  }\n\n  /**\n   * Enables adaptive bitrate switching according to hls.js logic.\n   * @function enableAdaptiveBitrate\n   * @returns {void}\n   * @public\n   */\n  enableAdaptiveBitrate(): void {\n    this._hls.nextLevel = -1;\n  }\n\n  /**\n   * Triggers on video track selection (auto or manually) the 'videotrackchanged' event forward.\n   * @function _onLevelSwitched\n   * @param {string} event - The event name.\n   * @param {any} data - The event data object.\n   * @private\n   * @returns {void}\n   */\n  _onLevelSwitched(event: string, data: any): void {\n    let videoTrack = this._playerTracks.find((track) => {\n      return (track instanceof VideoTrack && track.index === data.level);\n    });\n    HlsAdapter._logger.debug('Video track changed', videoTrack);\n    this._onTrackChanged(videoTrack);\n  }\n\n  /**\n   * Triggers on audio track selection (auto or manually) the 'audiotrackchanged' event forward.\n   * @function _onAudioTrackSwitched\n   * @param {string} event - The event name.\n   * @param {any} data - The event data object.\n   * @private\n   * @returns {void}\n   */\n  _onAudioTrackSwitched(event: string, data: any): void {\n    let audioTrack = this._playerTracks.find((track) => {\n      return (track instanceof AudioTrack && track.id === data.id);\n    });\n    HlsAdapter._logger.debug('Audio track changed', audioTrack);\n    this._onTrackChanged(audioTrack);\n  }\n\n  /**\n   * Disables all the video tag text tracks.\n   * @returns {void}\n   * @private\n   */\n  _disableAllTextTracks() {\n    let vidTextTracks = this._videoElement.textTracks;\n    for (let i = 0; i < vidTextTracks.length; i++) {\n      vidTextTracks[i].mode = 'hidden';\n    }\n  }\n\n  /**\n   * Handles hls errors.\n   * @param {string} event - The event name.\n   * @param {any} data - The event data object.\n   * @private\n   * @returns {void}\n   */\n  _onError(event: string, data: any): void {\n    let errorType = data.type;\n    let errorDetails = data.details;\n    let errorFatal = data.fatal;\n    if (errorFatal) {\n      switch (errorType) {\n        case Hlsjs.ErrorTypes.NETWORK_ERROR:\n          HlsAdapter._logger.error(\"fatal network error encountered, try to recover\");\n          this._hls.startLoad();\n          break;\n        case Hlsjs.ErrorTypes.MEDIA_ERROR:\n          HlsAdapter._logger.error(\"fatal media error encountered, try to recover\");\n          this._hls.recoverMediaError();\n          break;\n        default:\n          HlsAdapter._logger.error(\"fatal error, cannot recover\");\n          this.destroy();\n          break;\n      }\n    } else {\n      switch (errorDetails) {\n        case Hlsjs.ErrorDetails.MANIFEST_LOAD_ERROR:\n        case Hlsjs.ErrorDetails.MANIFEST_LOAD_TIMEOUT:\n        case Hlsjs.ErrorDetails.MANIFEST_PARSING_ERROR:\n        case Hlsjs.ErrorDetails.LEVEL_LOAD_ERROR:\n        case Hlsjs.ErrorDetails.LEVEL_LOAD_TIMEOUT:\n        case Hlsjs.ErrorDetails.LEVEL_SWITCH_ERROR:\n        case Hlsjs.ErrorDetails.FRAG_LOAD_ERROR:\n        case Hlsjs.ErrorDetails.FRAG_LOOP_LOADING_ERROR:\n        case Hlsjs.ErrorDetails.FRAG_LOAD_TIMEOUT:\n        case Hlsjs.ErrorDetails.FRAG_PARSING_ERROR:\n        case Hlsjs.ErrorDetails.BUFFER_APPEND_ERROR:\n        case Hlsjs.ErrorDetails.BUFFER_APPENDING_ERROR:\n          HlsAdapter._logger.error(errorType, errorDetails);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  /**\n   * Removes hls.js bindings.\n   * @returns {void}\n   * @private\n   */\n  _removeBindings(): void {\n    this._hls.off(Hlsjs.Events.ERROR, this._onError);\n    this._hls.off(Hlsjs.Events.LEVEL_SWITCHED, this._onLevelSwitched);\n    this._hls.off(Hlsjs.Events.AUDIO_TRACK_SWITCHED, this._onAudioTrackSwitched);\n  }\n\n  /**\n   * Getter for the src that the adapter plays on the video element.\n   * In case the adapter preformed a load it will return the manifest url.\n   * @public\n   * @returns {string} - The src url.\n   */\n  get src(): string {\n    if (this._loadPromise && this._sourceObj) {\n      return this._sourceObj.url;\n    }\n    return \"\";\n  }\n}\n\n// Register hls adapter to the media source adapter provider.\nif (HlsAdapter.isSupported()) {\n  registerMediaSourceAdapter(HlsAdapter);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./hls-adapter.js\n\n\n// WEBPACK FOOTER //\n// webpack:///hls/hls-adapter.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"hls.js\",\"commonjs2\":\"hls.js\",\"amd\":\"hls.js\",\"root\":\"Hls\"}\n// module id = 1\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:/hls/external {\"commonjs\":\"hls.js\",\"commonjs2\":\"hls.js\",\"amd\":\"hls.js\",\"root\":\"Hls\"}","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}\n// module id = 2\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:/hls/external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})\n\n\n// WEBPACK FOOTER //\n// node_modules/browser-pack/_prelude.js","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n\n// WEBPACK FOOTER //\n// node_modules/events/events.js","// see https://tools.ietf.org/html/rfc1808\r\n\r\n/* jshint ignore:start */\r\n(function(root) { \r\n/* jshint ignore:end */\r\n\r\n  var URL_REGEX = /^((?:[^\\/;?#]+:)?)(\\/\\/[^\\/\\;?#]*)?(.*?)??(;.*?)?(\\?.*?)?(#.*?)?$/;\r\n  var FIRST_SEGMENT_REGEX = /^([^\\/;?#]*)(.*)$/;\r\n  var SLASH_DOT_REGEX = /(?:\\/|^)\\.(?=\\/)/g;\r\n  var SLASH_DOT_DOT_REGEX = /(?:\\/|^)\\.\\.\\/(?!\\.\\.\\/).*?(?=\\/)/g;\r\n\r\n  var URLToolkit = { // jshint ignore:line\r\n    // If opts.alwaysNormalize is true then the path will always be normalized even when it starts with / or //\r\n    // E.g\r\n    // With opts.alwaysNormalize = false (default, spec compliant)\r\n    // http://a.com/b/cd + /e/f/../g => http://a.com/e/f/../g\r\n    // With opts.alwaysNormalize = true (default, not spec compliant)\r\n    // http://a.com/b/cd + /e/f/../g => http://a.com/e/g\r\n    buildAbsoluteURL: function(baseURL, relativeURL, opts) {\r\n      opts = opts || {};\r\n      // remove any remaining space and CRLF\r\n      baseURL = baseURL.trim();\r\n      relativeURL = relativeURL.trim();\r\n      if (!relativeURL) {\r\n        // 2a) If the embedded URL is entirely empty, it inherits the\r\n        // entire base URL (i.e., is set equal to the base URL)\r\n        // and we are done.\r\n        if (!opts.alwaysNormalize) {\r\n          return baseURL;\r\n        }\r\n        var basePartsForNormalise = this.parseURL(baseURL);\r\n        if (!baseParts) {\r\n          throw new Error('Error trying to parse base URL.');\r\n        }\r\n        basePartsForNormalise.path = URLToolkit.normalizePath(basePartsForNormalise.path);\r\n        return URLToolkit.buildURLFromParts(basePartsForNormalise);\r\n      }\r\n      var relativeParts = this.parseURL(relativeURL);\r\n      if (!relativeParts) {\r\n        throw new Error('Error trying to parse relative URL.');\r\n      }\r\n      if (relativeParts.scheme) {\r\n        // 2b) If the embedded URL starts with a scheme name, it is\r\n        // interpreted as an absolute URL and we are done.\r\n        if (!opts.alwaysNormalize) {\r\n          return relativeURL;\r\n        }\r\n        relativeParts.path = URLToolkit.normalizePath(relativeParts.path);\r\n        return URLToolkit.buildURLFromParts(relativeParts);\r\n      }\r\n      var baseParts = this.parseURL(baseURL);\r\n      if (!baseParts) {\r\n        throw new Error('Error trying to parse base URL.');\r\n      }\r\n      if (!baseParts.netLoc && baseParts.path && baseParts.path[0] !== '/') {\r\n        // If netLoc missing and path doesn't start with '/', assume everthing before the first '/' is the netLoc\r\n        // This causes 'example.com/a' to be handled as '//example.com/a' instead of '/example.com/a'\r\n        var pathParts = FIRST_SEGMENT_REGEX.exec(baseParts.path);\r\n        baseParts.netLoc = pathParts[1];\r\n        baseParts.path = pathParts[2];\r\n      }\r\n      if (baseParts.netLoc && !baseParts.path) {\r\n        baseParts.path = '/';\r\n      }\r\n      var builtParts = {\r\n        // 2c) Otherwise, the embedded URL inherits the scheme of\r\n        // the base URL.\r\n        scheme: baseParts.scheme,\r\n        netLoc: relativeParts.netLoc,\r\n        path: null,\r\n        params: relativeParts.params,\r\n        query: relativeParts.query,\r\n        fragment: relativeParts.fragment\r\n      };\r\n      if (!relativeParts.netLoc) {\r\n        // 3) If the embedded URL's <net_loc> is non-empty, we skip to\r\n        // Step 7.  Otherwise, the embedded URL inherits the <net_loc>\r\n        // (if any) of the base URL.\r\n        builtParts.netLoc = baseParts.netLoc;\r\n        // 4) If the embedded URL path is preceded by a slash \"/\", the\r\n        // path is not relative and we skip to Step 7.\r\n        if (relativeParts.path[0] !== '/') {\r\n          if (!relativeParts.path) {\r\n            // 5) If the embedded URL path is empty (and not preceded by a\r\n            // slash), then the embedded URL inherits the base URL path\r\n            builtParts.path = baseParts.path;\r\n            // 5a) if the embedded URL's <params> is non-empty, we skip to\r\n            // step 7; otherwise, it inherits the <params> of the base\r\n            // URL (if any) and\r\n            if (!relativeParts.params) {\r\n              builtParts.params = baseParts.params;\r\n              // 5b) if the embedded URL's <query> is non-empty, we skip to\r\n              // step 7; otherwise, it inherits the <query> of the base\r\n              // URL (if any) and we skip to step 7.\r\n              if (!relativeParts.query) {\r\n                builtParts.query = baseParts.query;\r\n              }\r\n            }\r\n          } else {\r\n            // 6) The last segment of the base URL's path (anything\r\n            // following the rightmost slash \"/\", or the entire path if no\r\n            // slash is present) is removed and the embedded URL's path is\r\n            // appended in its place.\r\n            var baseURLPath = baseParts.path;\r\n            var newPath = baseURLPath.substring(0, baseURLPath.lastIndexOf('/') + 1) + relativeParts.path;\r\n            builtParts.path = URLToolkit.normalizePath(newPath);\r\n          }\r\n        }\r\n      }\r\n      if (builtParts.path === null) {\r\n        builtParts.path = opts.alwaysNormalize ? URLToolkit.normalizePath(relativeParts.path) : relativeParts.path;\r\n      }\r\n      return URLToolkit.buildURLFromParts(builtParts);\r\n    },\r\n    parseURL: function(url) {\r\n      var parts = URL_REGEX.exec(url);\r\n      if (!parts) {\r\n        return null;\r\n      }\r\n      return {\r\n        scheme: parts[1] || '',\r\n        netLoc: parts[2] || '',\r\n        path: parts[3] || '',\r\n        params: parts[4] || '',\r\n        query: parts[5] || '',\r\n        fragment: parts[6] || ''\r\n      };\r\n    },\r\n    normalizePath: function(path) {\r\n      // The following operations are\r\n      // then applied, in order, to the new path:\r\n      // 6a) All occurrences of \"./\", where \".\" is a complete path\r\n      // segment, are removed.\r\n      // 6b) If the path ends with \".\" as a complete path segment,\r\n      // that \".\" is removed.\r\n      path = path.split('').reverse().join('').replace(SLASH_DOT_REGEX, '');\r\n      // 6c) All occurrences of \"<segment>/../\", where <segment> is a\r\n      // complete path segment not equal to \"..\", are removed.\r\n      // Removal of these path segments is performed iteratively,\r\n      // removing the leftmost matching pattern on each iteration,\r\n      // until no matching pattern remains.\r\n      // 6d) If the path ends with \"<segment>/..\", where <segment> is a\r\n      // complete path segment not equal to \"..\", that\r\n      // \"<segment>/..\" is removed.\r\n      while (path.length !== (path = path.replace(SLASH_DOT_DOT_REGEX, '')).length) {} // jshint ignore:line\r\n      return path.split('').reverse().join('');\r\n    },\r\n    buildURLFromParts: function(parts) {\r\n      return parts.scheme + parts.netLoc + parts.path + parts.params + parts.query + parts.fragment;\r\n    }\r\n  };\r\n\r\n/* jshint ignore:start */\r\n  if(typeof exports === 'object' && typeof module === 'object')\r\n    module.exports = URLToolkit;\r\n  else if(typeof define === 'function' && define.amd)\r\n    define([], function() { return URLToolkit; });\r\n  else if(typeof exports === 'object')\r\n    exports[\"URLToolkit\"] = URLToolkit;\r\n  else\r\n    root[\"URLToolkit\"] = URLToolkit;\r\n})(this);\r\n/* jshint ignore:end */\r\n\n\n\n// WEBPACK FOOTER //\n// node_modules/url-toolkit/src/url-toolkit.js","var bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            Function(['require','module','exports'], '(' + fn + ')(self)'),\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        Function(['require'], (\n            // try to call default if defined to also support babel esmodule\n            // exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);'\n        )),\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n\n\n// WEBPACK FOOTER //\n// node_modules/webworkify/index.js","/**\n * HLS config\n */\n'use strict';\n\nimport AbrController from    './controller/abr-controller';\nimport BufferController from  './controller/buffer-controller';\nimport CapLevelController from  './controller/cap-level-controller';\nimport FPSController from './controller/fps-controller';\nimport XhrLoader from './utils/xhr-loader';\n//import FetchLoader from './utils/fetch-loader';\n//#if altaudio\nimport AudioTrackController from './controller/audio-track-controller';\nimport AudioStreamController from  './controller/audio-stream-controller';\n//#endif\n\n//#if subtitle\nimport Cues from './utils/cues';\nimport TimelineController from './controller/timeline-controller';\nimport SubtitleTrackController from './controller/subtitle-track-controller';\nimport SubtitleStreamController from  './controller/subtitle-stream-controller';\n//#endif\n\nexport var hlsDefaultConfig = {\n      autoStartLoad: true,                    // used by stream-controller\n      startPosition: -1,                      // used by stream-controller\n      defaultAudioCodec: undefined,           // used by stream-controller\n      debug: false,                           // used by logger\n      capLevelOnFPSDrop: false,               // used by fps-controller\n      capLevelToPlayerSize: false,            // used by cap-level-controller\n      initialLiveManifestSize: 1,             // used by stream-controller\n      maxBufferLength: 30,                    // used by stream-controller\n      maxBufferSize: 60 * 1000 * 1000,        // used by stream-controller\n      maxBufferHole: 0.5,                     // used by stream-controller\n      maxSeekHole: 2,                         // used by stream-controller\n      lowBufferWatchdogPeriod: 0.5,           // used by stream-controller\n      highBufferWatchdogPeriod: 3,            // used by stream-controller\n      nudgeOffset: 0.1,                       // used by stream-controller\n      nudgeMaxRetry : 3,                      // used by stream-controller\n      maxFragLookUpTolerance: 0.25,           // used by stream-controller\n      liveSyncDurationCount:3,                // used by stream-controller\n      liveMaxLatencyDurationCount: Infinity,  // used by stream-controller\n      liveSyncDuration: undefined,            // used by stream-controller\n      liveMaxLatencyDuration: undefined,      // used by stream-controller\n      maxMaxBufferLength: 600,                // used by stream-controller\n      enableWorker: true,                     // used by demuxer\n      enableSoftwareAES: true,                // used by decrypter\n      manifestLoadingTimeOut: 10000,          // used by playlist-loader\n      manifestLoadingMaxRetry: 1,             // used by playlist-loader\n      manifestLoadingRetryDelay: 1000,        // used by playlist-loader\n      manifestLoadingMaxRetryTimeout: 64000,  // used by playlist-loader\n      startLevel: undefined,                  // used by level-controller\n      levelLoadingTimeOut: 10000,             // used by playlist-loader\n      levelLoadingMaxRetry: 4,                // used by playlist-loader\n      levelLoadingRetryDelay: 1000,           // used by playlist-loader\n      levelLoadingMaxRetryTimeout: 64000,     // used by playlist-loader\n      fragLoadingTimeOut: 20000,              // used by fragment-loader\n      fragLoadingMaxRetry: 6,                 // used by fragment-loader\n      fragLoadingRetryDelay: 1000,            // used by fragment-loader\n      fragLoadingMaxRetryTimeout: 64000,      // used by fragment-loader\n      fragLoadingLoopThreshold: 3,            // used by stream-controller\n      startFragPrefetch: false,               // used by stream-controller\n      fpsDroppedMonitoringPeriod: 5000,       // used by fps-controller\n      fpsDroppedMonitoringThreshold: 0.2,     // used by fps-controller\n      appendErrorMaxRetry: 3,                 // used by buffer-controller\n      loader: XhrLoader,\n      //loader: FetchLoader,\n      fLoader: undefined,\n      pLoader: undefined,\n      xhrSetup: undefined,\n      fetchSetup: undefined,\n      abrController: AbrController,\n      bufferController: BufferController,\n      capLevelController: CapLevelController,\n      fpsController: FPSController,\n//#if altaudio\n      audioStreamController: AudioStreamController,\n      audioTrackController : AudioTrackController,\n//#endif\n//#if subtitle\n      subtitleStreamController: SubtitleStreamController,\n      subtitleTrackController: SubtitleTrackController,\n      timelineController: TimelineController,\n      cueHandler: Cues,\n      enableCEA708Captions: true,               // used by timeline-controller\n      enableWebVTT: true,                       // used by timeline-controller\n      captionsTextTrack1Label: 'English',       // used by timeline-controller\n      captionsTextTrack1LanguageCode: 'en',      // used by timeline-controller\n      captionsTextTrack2Label: 'Spanish',       // used by timeline-controller\n      captionsTextTrack2LanguageCode: 'es',     // used by timeline-controller\n//#endif\n      stretchShortVideoTrack: false,            // used by mp4-remuxer\n      forceKeyFrameOnDiscontinuity: true,       // used by ts-demuxer\n      abrEwmaFastLive: 3,                       // used by abr-controller\n      abrEwmaSlowLive: 9,                       // used by abr-controller\n      abrEwmaFastVoD: 3,                        // used by abr-controller\n      abrEwmaSlowVoD: 9,                        // used by abr-controller\n      abrEwmaDefaultEstimate: 5e5, // 500 kbps  // used by abr-controller\n      abrBandWidthFactor : 0.95,                // used by abr-controller\n      abrBandWidthUpFactor : 0.7,               // used by abr-controller\n      abrMaxWithRealBitrate : false,            // used by abr-controller\n      maxStarvationDelay : 4,                   // used by abr-controller\n      maxLoadingDelay : 4,                      // used by abr-controller\n      minAutoBitrate: 0                         // used by hls\n    };\n\n\n\n// WEBPACK FOOTER //\n// src/config.js","/*\n * simple ABR Controller\n *  - compute next level based on last fragment bw heuristics\n *  - implement an abandon rules triggered if we have less than 2 frag buffered and if computed bw shows that we risk buffer stalling\n */\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport BufferHelper from '../helper/buffer-helper';\nimport {ErrorDetails} from '../errors';\nimport {logger} from '../utils/logger';\nimport EwmaBandWidthEstimator from '../utils/ewma-bandwidth-estimator';\n\nclass AbrController extends EventHandler {\n\n  constructor(hls) {\n    super(hls, Event.FRAG_LOADING,\n               Event.FRAG_LOADED,\n               Event.FRAG_BUFFERED,\n               Event.ERROR);\n    this.lastLoadedFragLevel = 0;\n    this._nextAutoLevel = -1;\n    this.hls = hls;\n    this.onCheck = this._abandonRulesCheck.bind(this);\n  }\n\n  destroy() {\n    this.clearTimer();\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onFragLoading(data) {\n    let frag = data.frag;\n    if (frag.type === 'main') {\n      if (!this.timer) {\n        this.timer = setInterval(this.onCheck, 100);\n      }\n      // lazy init of bw Estimator, rationale is that we use different params for Live/VoD\n      // so we need to wait for stream manifest / playlist type to instantiate it.\n      if (!this._bwEstimator) {\n        let hls = this.hls,\n            level = data.frag.level,\n            isLive = hls.levels[level].details.live,\n            config = hls.config,\n            ewmaFast, ewmaSlow;\n\n        if (isLive) {\n          ewmaFast = config.abrEwmaFastLive;\n          ewmaSlow = config.abrEwmaSlowLive;\n        } else {\n          ewmaFast = config.abrEwmaFastVoD;\n          ewmaSlow = config.abrEwmaSlowVoD;\n        }\n        this._bwEstimator = new EwmaBandWidthEstimator(hls,ewmaSlow,ewmaFast,config.abrEwmaDefaultEstimate);\n      }\n      this.fragCurrent = frag;\n    }\n  }\n\n  _abandonRulesCheck() {\n    /*\n      monitor fragment retrieval time...\n      we compute expected time of arrival of the complete fragment.\n      we compare it to expected time of buffer starvation\n    */\n    let hls = this.hls, v = hls.media,frag = this.fragCurrent, loader = frag.loader, minAutoLevel = hls.minAutoLevel;\n\n    // if loader has been destroyed or loading has been aborted, stop timer and return\n    if(!loader || ( loader.stats && loader.stats.aborted)) {\n      logger.warn('frag loader destroy or aborted, disarm abandonRules');\n      this.clearTimer();\n      return;\n    }\n    let stats = loader.stats;\n    /* only monitor frag retrieval time if\n    (video not paused OR first fragment being loaded(ready state === HAVE_NOTHING = 0)) AND autoswitching enabled AND not lowest level (=> means that we have several levels) */\n    if (v && ((!v.paused && (v.playbackRate !== 0)) || !v.readyState) && frag.autoLevel && frag.level) {\n      let requestDelay = performance.now() - stats.trequest,\n          playbackRate = Math.abs(v.playbackRate);\n      // monitor fragment load progress after half of expected fragment duration,to stabilize bitrate\n      if (requestDelay > (500 * frag.duration / playbackRate)) {\n        let levels = hls.levels,\n            loadRate = Math.max(1, stats.bw ? stats.bw / 8 : stats.loaded * 1000 / requestDelay), // byte/s; at least 1 byte/s to avoid division by zero\n            // compute expected fragment length using frag duration and level bitrate. also ensure that expected len is gte than already loaded size\n            level = levels[frag.level],\n            levelBitrate = level.realBitrate ? Math.max(level.realBitrate,level.bitrate) : level.bitrate,\n            expectedLen = stats.total ? stats.total : Math.max(stats.loaded, Math.round(frag.duration * levelBitrate / 8)),\n            pos = v.currentTime,\n            fragLoadedDelay = (expectedLen - stats.loaded) / loadRate,\n            bufferStarvationDelay = (BufferHelper.bufferInfo(v,pos,hls.config.maxBufferHole).end - pos) / playbackRate;\n        // consider emergency switch down only if we have less than 2 frag buffered AND\n        // time to finish loading current fragment is bigger than buffer starvation delay\n        // ie if we risk buffer starvation if bw does not increase quickly\n        if ((bufferStarvationDelay < (2 * frag.duration / playbackRate)) && (fragLoadedDelay > bufferStarvationDelay)) {\n          let fragLevelNextLoadedDelay, nextLoadLevel;\n          // lets iterate through lower level and try to find the biggest one that could avoid rebuffering\n          // we start from current level - 1 and we step down , until we find a matching level\n          for (nextLoadLevel = frag.level - 1 ; nextLoadLevel > minAutoLevel ; nextLoadLevel--) {\n            // compute time to load next fragment at lower level\n            // 0.8 : consider only 80% of current bw to be conservative\n            // 8 = bits per byte (bps/Bps)\n            let levelNextBitrate = levels[nextLoadLevel].realBitrate ? Math.max(levels[nextLoadLevel].realBitrate,levels[nextLoadLevel].bitrate) : levels[nextLoadLevel].bitrate;\n            fragLevelNextLoadedDelay = frag.duration * levelNextBitrate / (8 * 0.8 * loadRate);\n            if (fragLevelNextLoadedDelay < bufferStarvationDelay) {\n              // we found a lower level that be rebuffering free with current estimated bw !\n              break;\n            }\n          }\n          // only emergency switch down if it takes less time to load new fragment at lowest level instead\n          // of finishing loading current one ...\n          if (fragLevelNextLoadedDelay < fragLoadedDelay) {\n            logger.warn(`loading too slow, abort fragment loading and switch to level ${nextLoadLevel}:fragLoadedDelay[${nextLoadLevel}]<fragLoadedDelay[${frag.level-1}];bufferStarvationDelay:${fragLevelNextLoadedDelay.toFixed(1)}<${fragLoadedDelay.toFixed(1)}:${bufferStarvationDelay.toFixed(1)}`);\n            // force next load level in auto mode\n            hls.nextLoadLevel = nextLoadLevel;\n            // update bw estimate for this fragment before cancelling load (this will help reducing the bw)\n            this._bwEstimator.sample(requestDelay,stats.loaded);\n            //abort fragment loading\n            loader.abort();\n            // stop abandon rules timer\n            this.clearTimer();\n            hls.trigger(Event.FRAG_LOAD_EMERGENCY_ABORTED, {frag: frag, stats: stats });\n          }\n        }\n      }\n    }\n  }\n\n  onFragLoaded(data) {\n    let frag = data.frag;\n    if (frag.type === 'main' && !isNaN(frag.sn)) {\n      // stop monitoring bw once frag loaded\n      this.clearTimer();\n      // store level id after successful fragment load\n      this.lastLoadedFragLevel = frag.level;\n      // reset forced auto level value so that next level will be selected\n      this._nextAutoLevel = -1;\n\n      // compute level average bitrate\n      if (this.hls.config.abrMaxWithRealBitrate) {\n        const level = this.hls.levels[frag.level];\n        let loadedBytes = (level.loaded ? level.loaded.bytes : 0) + data.stats.loaded;\n        let loadedDuration = (level.loaded ? level.loaded.duration : 0) + data.frag.duration;\n        level.loaded = { bytes : loadedBytes, duration : loadedDuration };\n        level.realBitrate = Math.round(8*loadedBytes/loadedDuration);\n      }\n      // if fragment has been loaded to perform a bitrate test,\n      if (data.frag.bitrateTest) {\n        let stats = data.stats;\n        stats.tparsed = stats.tbuffered = stats.tload;\n        this.onFragBuffered(data);\n      }\n    }\n  }\n\n  onFragBuffered(data) {\n    var stats = data.stats, frag = data.frag;\n    // only update stats on first frag buffering\n    // if same frag is loaded multiple times, it might be in browser cache, and loaded quickly\n    // and leading to wrong bw estimation\n    // on bitrate test, also only update stats once (if tload = tbuffered == on FRAG_LOADED)\n    if (stats.aborted !== true && frag.loadCounter === 1 && frag.type === 'main' && !isNaN(frag.sn) && ((!frag.bitrateTest || stats.tload === stats.tbuffered))) {\n      // use tparsed-trequest instead of tbuffered-trequest to compute fragLoadingProcessing; rationale is that  buffer appending only happens once media is attached\n      // in case we use config.startFragPrefetch while media is not attached yet, fragment might be parsed while media not attached yet, but it will only be buffered on media attached\n      // as a consequence it could happen really late in the process. meaning that appending duration might appears huge ... leading to underestimated throughput estimation\n      let fragLoadingProcessingMs = stats.tparsed - stats.trequest;\n      logger.log(`latency/loading/parsing/append/kbps:${Math.round(stats.tfirst-stats.trequest)}/${Math.round(stats.tload-stats.tfirst)}/${Math.round(stats.tparsed-stats.tload)}/${Math.round(stats.tbuffered-stats.tparsed)}/${Math.round(8*stats.loaded/(stats.tbuffered-stats.trequest))}`);\n      this._bwEstimator.sample(fragLoadingProcessingMs,stats.loaded);\n      stats.bwEstimate = this._bwEstimator.getEstimate();\n      // if fragment has been loaded to perform a bitrate test, (hls.startLevel = -1), store bitrate test delay duration\n      if (frag.bitrateTest) {\n        this.bitrateTestDelay = fragLoadingProcessingMs/1000;\n      } else {\n        this.bitrateTestDelay = 0;\n      }\n    }\n  }\n\n  onError(data) {\n    // stop timer in case of frag loading error\n    switch(data.details) {\n      case ErrorDetails.FRAG_LOAD_ERROR:\n      case ErrorDetails.FRAG_LOAD_TIMEOUT:\n        this.clearTimer();\n        break;\n      default:\n        break;\n    }\n  }\n\n clearTimer() {\n    if (this.timer) {\n      clearInterval(this.timer);\n      this.timer = null;\n    }\n }\n\n  // return next auto level\n  get nextAutoLevel() {\n    const forcedAutoLevel = this._nextAutoLevel;\n    const bwEstimator = this._bwEstimator;\n    // in case next auto level has been forced, and bw not available or not reliable, return forced value\n    if (forcedAutoLevel !== -1 && (!bwEstimator || !bwEstimator.canEstimate())) {\n      return forcedAutoLevel;\n    }\n    // compute next level using ABR logic\n    let nextABRAutoLevel = this._nextABRAutoLevel;\n    // if forced auto level has been defined, use it to cap ABR computed quality level\n    if (forcedAutoLevel !== -1) {\n      nextABRAutoLevel = Math.min(forcedAutoLevel,nextABRAutoLevel);\n    }\n    return nextABRAutoLevel;\n  }\n  get _nextABRAutoLevel() {\n    var hls = this.hls, maxAutoLevel = hls.maxAutoLevel, levels = hls.levels, config = hls.config, minAutoLevel = hls.minAutoLevel;\n    const v = hls.media,\n          currentLevel = this.lastLoadedFragLevel,\n          currentFragDuration = this.fragCurrent ? this.fragCurrent.duration : 0,\n          pos = (v ? v.currentTime : 0),\n          // playbackRate is the absolute value of the playback rate; if v.playbackRate is 0, we use 1 to load as\n          // if we're playing back at the normal rate.\n          playbackRate = ((v && (v.playbackRate !== 0)) ? Math.abs(v.playbackRate) : 1.0),\n          avgbw = this._bwEstimator ? this._bwEstimator.getEstimate() : config.abrEwmaDefaultEstimate,\n          // bufferStarvationDelay is the wall-clock time left until the playback buffer is exhausted.\n          bufferStarvationDelay = (BufferHelper.bufferInfo(v, pos, config.maxBufferHole).end - pos) / playbackRate;\n\n    // First, look to see if we can find a level matching with our avg bandwidth AND that could also guarantee no rebuffering at all\n    let bestLevel = this._findBestLevel(currentLevel,currentFragDuration,avgbw,minAutoLevel,maxAutoLevel,bufferStarvationDelay,config.abrBandWidthFactor,config.abrBandWidthUpFactor,levels);\n    if (bestLevel >= 0) {\n      return bestLevel;\n    } else {\n      logger.trace('rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering');\n      // not possible to get rid of rebuffering ... let's try to find level that will guarantee less than maxStarvationDelay of rebuffering\n      // if no matching level found, logic will return 0\n      let maxStarvationDelay = currentFragDuration ? Math.min(currentFragDuration,config.maxStarvationDelay) : config.maxStarvationDelay,\n          bwFactor = config.abrBandWidthFactor,\n          bwUpFactor = config.abrBandWidthUpFactor;\n      if (bufferStarvationDelay === 0) {\n        // in case buffer is empty, let's check if previous fragment was loaded to perform a bitrate test\n        let bitrateTestDelay = this.bitrateTestDelay;\n        if (bitrateTestDelay) {\n          // if it is the case, then we need to adjust our max starvation delay using maxLoadingDelay config value\n          // max video loading delay used in  automatic start level selection :\n          // in that mode ABR controller will ensure that video loading time (ie the time to fetch the first fragment at lowest quality level +\n          // the time to fetch the fragment at the appropriate quality level is less than ```maxLoadingDelay``` )\n          // cap maxLoadingDelay and ensure it is not bigger 'than bitrate test' frag duration\n          const maxLoadingDelay = currentFragDuration ? Math.min(currentFragDuration,config.maxLoadingDelay) : config.maxLoadingDelay;\n          maxStarvationDelay = maxLoadingDelay - bitrateTestDelay;\n          logger.trace(`bitrate test took ${Math.round(1000*bitrateTestDelay)}ms, set first fragment max fetchDuration to ${Math.round(1000*maxStarvationDelay)} ms`);\n          // don't use conservative factor on bitrate test\n          bwFactor = bwUpFactor = 1;\n        }\n      }\n      bestLevel = this._findBestLevel(currentLevel,currentFragDuration,avgbw,minAutoLevel,maxAutoLevel,bufferStarvationDelay+maxStarvationDelay,bwFactor,bwUpFactor,levels);\n      return Math.max(bestLevel,0);\n    }\n  }\n\n  _findBestLevel(currentLevel,currentFragDuration,currentBw,minAutoLevel,maxAutoLevel,maxFetchDuration,bwFactor,bwUpFactor,levels) {\n    for (let i = maxAutoLevel; i >= minAutoLevel; i--) {\n      let levelInfo = levels[i],\n          levelDetails = levelInfo.details,\n          avgDuration = levelDetails ? levelDetails.totalduration/levelDetails.fragments.length : currentFragDuration,\n          live = levelDetails ? levelDetails.live : false,\n          adjustedbw;\n    // follow algorithm captured from stagefright :\n    // https://android.googlesource.com/platform/frameworks/av/+/master/media/libstagefright/httplive/LiveSession.cpp\n    // Pick the highest bandwidth stream below or equal to estimated bandwidth.\n    // consider only 80% of the available bandwidth, but if we are switching up,\n    // be even more conservative (70%) to avoid overestimating and immediately\n    // switching back.\n      if (i <= currentLevel) {\n        adjustedbw = bwFactor * currentBw;\n      } else {\n        adjustedbw = bwUpFactor * currentBw;\n      }\n      const bitrate = levels[i].realBitrate ? Math.max(levels[i].realBitrate,levels[i].bitrate) : levels[i].bitrate,\n            fetchDuration = bitrate * avgDuration / adjustedbw;\n\n    logger.trace(`level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: ${i}/${Math.round(adjustedbw)}/${bitrate}/${avgDuration}/${maxFetchDuration}/${fetchDuration}`);\n      // if adjusted bw is greater than level bitrate AND\n      if (adjustedbw > bitrate &&\n      // fragment fetchDuration unknown OR live stream OR fragment fetchDuration less than max allowed fetch duration, then this level matches\n      // we don't account for max Fetch Duration for live streams, this is to avoid switching down when near the edge of live sliding window ...\n      // special case to support startLevel = -1 (bitrateTest) on live streams : in that case we should not exit loop so that _findBestLevel will return -1\n        (!fetchDuration || (live  && !this.bitrateTestDelay) || fetchDuration < maxFetchDuration) ) {\n        // as we are looping from highest to lowest, this will return the best achievable quality level\n        return i;\n      }\n    }\n    // not enough time budget even with quality level 0 ... rebuffering might happen\n    return -1;\n  }\n\n  set nextAutoLevel(nextLevel) {\n    this._nextAutoLevel = nextLevel;\n  }\n}\n\nexport default AbrController;\n\n\n\n\n// WEBPACK FOOTER //\n// src/controller/abr-controller.js","/*\n * Audio Stream Controller\n*/\n\nimport BinarySearch from '../utils/binary-search';\nimport BufferHelper from '../helper/buffer-helper';\nimport Demuxer from '../demux/demuxer';\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport LevelHelper from '../helper/level-helper';\nimport TimeRanges from '../utils/timeRanges';\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport {logger} from '../utils/logger';\n\nconst State = {\n  STOPPED : 'STOPPED',\n  STARTING : 'STARTING',\n  IDLE : 'IDLE',\n  PAUSED : 'PAUSED',\n  KEY_LOADING : 'KEY_LOADING',\n  FRAG_LOADING : 'FRAG_LOADING',\n  FRAG_LOADING_WAITING_RETRY : 'FRAG_LOADING_WAITING_RETRY',\n  WAITING_TRACK : 'WAITING_TRACK',\n  PARSING : 'PARSING',\n  PARSED : 'PARSED',\n  BUFFER_FLUSHING : 'BUFFER_FLUSHING',\n  ENDED : 'ENDED',\n  ERROR : 'ERROR',\n  WAITING_INIT_PTS : 'WAITING_INIT_PTS'\n};\n\nclass AudioStreamController extends EventHandler {\n\n  constructor(hls) {\n    super(hls,\n      Event.MEDIA_ATTACHED,\n      Event.MEDIA_DETACHING,\n      Event.AUDIO_TRACKS_UPDATED,\n      Event.AUDIO_TRACK_SWITCHING,\n      Event.AUDIO_TRACK_LOADED,\n      Event.KEY_LOADED,\n      Event.FRAG_LOADED,\n      Event.FRAG_PARSING_INIT_SEGMENT,\n      Event.FRAG_PARSING_DATA,\n      Event.FRAG_PARSED,\n      Event.ERROR,\n      Event.BUFFER_CREATED,\n      Event.BUFFER_APPENDED,\n      Event.BUFFER_FLUSHED,\n      Event.INIT_PTS_FOUND);\n\n    this.config = hls.config;\n    this.audioCodecSwap = false;\n    this.ticks = 0;\n    this._state = State.STOPPED;\n    this.ontick = this.tick.bind(this);\n    this.initPTS=[];\n    this.waitingFragment=null;\n  }\n\n  destroy() {\n    this.stopLoad();\n    if (this.timer) {\n      clearInterval(this.timer);\n      this.timer = null;\n    }\n    EventHandler.prototype.destroy.call(this);\n    this.state = State.STOPPED;\n  }\n\n  //Signal that video PTS was found\n  onInitPtsFound(data) {\n    var demuxerId=data.id, cc = data.frag.cc, initPTS = data.initPTS;\n    if(demuxerId === 'main') {\n      //Always update the new INIT PTS\n      //Can change due level switch\n      this.initPTS[cc] = initPTS;\n      logger.log(`InitPTS for cc:${cc} found from video track:${initPTS}`);\n\n      //If we are waiting we need to demux/remux the waiting frag\n      //With the new initPTS\n      if (this.state === State.WAITING_INIT_PTS) {\n        logger.log('sending pending audio frag to demuxer');\n        this.state = State.FRAG_LOADING;\n        //We have audio frag waiting or video pts\n        //Let process it\n        this.onFragLoaded(this.waitingFragment);\n        //Lets clean the waiting frag\n        this.waitingFragment = null;\n      }\n    }\n  }\n\n  startLoad(startPosition) {\n    if (this.tracks) {\n      var lastCurrentTime = this.lastCurrentTime;\n      this.stopLoad();\n      if (!this.timer) {\n        this.timer = setInterval(this.ontick, 100);\n      }\n      this.fragLoadError = 0;\n      if (lastCurrentTime > 0 && startPosition === -1) {\n        logger.log(`audio:override startPosition with lastCurrentTime @${lastCurrentTime.toFixed(3)}`);\n        this.state = State.IDLE;\n      } else {\n        this.lastCurrentTime = this.startPosition ? this.startPosition : startPosition;\n        this.state = State.STARTING;\n      }\n      this.nextLoadPosition = this.startPosition = this.lastCurrentTime;\n      this.tick();\n    } else {\n      this.startPosition = startPosition;\n      this.state = State.STOPPED;\n    }\n  }\n\n  stopLoad() {\n    var frag = this.fragCurrent;\n    if (frag) {\n      if (frag.loader) {\n        frag.loader.abort();\n      }\n      this.fragCurrent = null;\n    }\n    this.fragPrevious = null;\n    if (this.demuxer) {\n      this.demuxer.destroy();\n      this.demuxer = null;\n    }\n    this.state = State.STOPPED;\n  }\n\n  set state(nextState) {\n    if (this.state !== nextState) {\n      const previousState = this.state;\n      this._state = nextState;\n      logger.log(`audio stream:${previousState}->${nextState}`);\n    }\n  }\n\n  get state() {\n    return this._state;\n  }\n\n  tick() {\n    this.ticks++;\n    if (this.ticks === 1) {\n      this.doTick();\n      if (this.ticks > 1) {\n        setTimeout(this.tick, 1);\n      }\n      this.ticks = 0;\n    }\n  }\n\n  doTick() {\n    var pos, track, trackDetails, hls = this.hls, config = hls.config;\n    //logger.log('audioStream:' + this.state);\n    switch(this.state) {\n      case State.ERROR:\n        //don't do anything in error state to avoid breaking further ...\n      case State.PAUSED:\n        //don't do anything in paused state either ...\n      case State.BUFFER_FLUSHING:\n        break;\n      case State.STARTING:\n        this.state = State.WAITING_TRACK;\n        this.loadedmetadata = false;\n        break;\n      case State.IDLE:\n        const tracks = this.tracks;\n        // audio tracks not received => exit loop\n        if (!tracks) {\n          break;\n        }\n        // if video not attached AND\n        // start fragment already requested OR start frag prefetch disable\n        // exit loop\n        // => if media not attached but start frag prefetch is enabled and start frag not requested yet, we will not exit loop\n        if (!this.media &&\n          (this.startFragRequested || !config.startFragPrefetch)) {\n          break;\n        }\n        // determine next candidate fragment to be loaded, based on current position and\n        //  end of buffer position\n        // if we have not yet loaded any fragment, start loading from start position\n        if (this.loadedmetadata) {\n          pos = this.media.currentTime;\n        } else {\n          pos = this.nextLoadPosition;\n        }\n        let media = this.mediaBuffer ? this.mediaBuffer : this.media,\n            bufferInfo = BufferHelper.bufferInfo(media,pos,config.maxBufferHole),\n            bufferLen = bufferInfo.len,\n            bufferEnd = bufferInfo.end,\n            fragPrevious = this.fragPrevious,\n            maxBufLen = config.maxMaxBufferLength,\n            audioSwitch = this.audioSwitch,\n            trackId = this.trackId;\n\n        // if buffer length is less than maxBufLen try to load a new fragment\n        if ((bufferLen < maxBufLen || audioSwitch) && trackId < tracks.length) {\n          trackDetails = tracks[trackId].details;\n          // if track info not retrieved yet, switch state and wait for track retrieval\n          if (typeof trackDetails === 'undefined') {\n            this.state = State.WAITING_TRACK;\n            break;\n          }\n\n          // we just got done loading the final fragment, check if we need to finalize media stream\n          if (!audioSwitch && !trackDetails.live && fragPrevious && fragPrevious.sn === trackDetails.endSN) {\n              // if we are not seeking or if we are seeking but everything (almost) til the end is buffered, let's signal eos\n              // we don't compare exactly media.duration === bufferInfo.end as there could be some subtle media duration difference when switching\n              // between different renditions. using half frag duration should help cope with these cases.\n              if (!this.media.seeking || (this.media.duration-bufferEnd) < fragPrevious.duration/2) {\n              // Finalize the media stream\n              this.hls.trigger(Event.BUFFER_EOS,{ type : 'audio'});\n              this.state = State.ENDED;\n              break;\n            }\n          }\n\n          // find fragment index, contiguous with end of buffer position\n          let fragments = trackDetails.fragments,\n              fragLen = fragments.length,\n              start = fragments[0].start,\n              end = fragments[fragLen-1].start + fragments[fragLen-1].duration,\n              frag;\n\n          // When switching audio track, reload audio as close as possible to currentTime\n          if(audioSwitch){\n            if (trackDetails.live && !trackDetails.PTSKnown) {\n              logger.log(`switching audiotrack, live stream, unknown PTS,load first fragment`);\n              bufferEnd = 0;\n            } else {\n              bufferEnd = pos;\n              // if currentTime (pos) is less than alt audio playlist start time, it means that alt audio is ahead of currentTime\n              if (trackDetails.PTSKnown && pos < start) {\n                // if everything is buffered from pos to start or if audio buffer upfront, let's seek to start\n                if (bufferInfo.end > start || bufferInfo.nextStart) {\n                  logger.log('alt audio track ahead of main track, seek to start of alt audio track');\n                  this.media.currentTime = start + 0.05;\n                } else {\n                  return;\n                }\n              }\n            }\n          }\n          if (trackDetails.initSegment && !trackDetails.initSegment.data) {\n              frag = trackDetails.initSegment;\n           }\n          // if bufferEnd before start of playlist, load first fragment\n          else if (bufferEnd <= start) {\n            frag = fragments[0];\n            if (trackDetails.live && frag.loadIdx && frag.loadIdx === this.fragLoadIdx) {\n              // we just loaded this first fragment, and we are still lagging behind the start of the live playlist\n              // let's force seek to start\n              const nextBuffered = bufferInfo.nextStart ? bufferInfo.nextStart : start;\n              logger.log(`no alt audio available @currentTime:${this.media.currentTime}, seeking @${nextBuffered + 0.05}`);\n              this.media.currentTime = nextBuffered + 0.05;\n              return;\n            }\n          } else {\n            let foundFrag;\n            let maxFragLookUpTolerance = config.maxFragLookUpTolerance;\n            const fragNext = fragPrevious ? fragments[fragPrevious.sn - fragments[0].sn + 1] : undefined;\n            let fragmentWithinToleranceTest = (candidate) => {\n              // offset should be within fragment boundary - config.maxFragLookUpTolerance\n              // this is to cope with situations like\n              // bufferEnd = 9.991\n              // frag[Ø] : [0,10]\n              // frag[1] : [10,20]\n              // bufferEnd is within frag[0] range ... although what we are expecting is to return frag[1] here\n              //              frag start               frag start+duration\n              //                  |-----------------------------|\n              //              <--->                         <--->\n              //  ...--------><-----------------------------><---------....\n              // previous frag         matching fragment         next frag\n              //  return -1             return 0                 return 1\n              //logger.log(`level/sn/start/end/bufEnd:${level}/${candidate.sn}/${candidate.start}/${(candidate.start+candidate.duration)}/${bufferEnd}`);\n              // Set the lookup tolerance to be small enough to detect the current segment - ensures we don't skip over very small segments\n              let candidateLookupTolerance = Math.min(maxFragLookUpTolerance, candidate.duration);\n              if ((candidate.start + candidate.duration - candidateLookupTolerance) <= bufferEnd) {\n                return 1;\n              }// if maxFragLookUpTolerance will have negative value then don't return -1 for first element\n              else if (candidate.start - candidateLookupTolerance > bufferEnd && candidate.start) {\n                return -1;\n              }\n              return 0;\n            };\n\n            if (bufferEnd < end) {\n              if (bufferEnd > end - maxFragLookUpTolerance) {\n                maxFragLookUpTolerance = 0;\n              }\n              // Prefer the next fragment if it's within tolerance\n              if (fragNext && !fragmentWithinToleranceTest(fragNext)) {\n                foundFrag = fragNext;\n              } else {\n                foundFrag = BinarySearch.search(fragments, fragmentWithinToleranceTest);\n              }\n            } else {\n              // reach end of playlist\n              foundFrag = fragments[fragLen-1];\n            }\n            if (foundFrag) {\n              frag = foundFrag;\n              start = foundFrag.start;\n              //logger.log('find SN matching with pos:' +  bufferEnd + ':' + frag.sn);\n              if (fragPrevious && frag.level === fragPrevious.level && frag.sn === fragPrevious.sn) {\n                if (frag.sn < trackDetails.endSN) {\n                  frag = fragments[frag.sn + 1 - trackDetails.startSN];\n                  logger.log(`SN just loaded, load next one: ${frag.sn}`);\n                } else {\n                  frag = null;\n                }\n              }\n            }\n          }\n          if(frag) {\n            //logger.log('      loading frag ' + i +',pos/bufEnd:' + pos.toFixed(3) + '/' + bufferEnd.toFixed(3));\n            if (frag.decryptdata && (frag.decryptdata.uri != null) && (frag.decryptdata.key == null)) {\n              logger.log(`Loading key for ${frag.sn} of [${trackDetails.startSN} ,${trackDetails.endSN}],track ${trackId}`);\n              this.state = State.KEY_LOADING;\n              hls.trigger(Event.KEY_LOADING, {frag: frag});\n            } else {\n              logger.log(`Loading ${frag.sn} of [${trackDetails.startSN} ,${trackDetails.endSN}],track ${trackId}, currentTime:${pos},bufferEnd:${bufferEnd.toFixed(3)}`);\n              // ensure that we are not reloading the same fragments in loop ...\n              if (this.fragLoadIdx !== undefined) {\n                this.fragLoadIdx++;\n              } else {\n                this.fragLoadIdx = 0;\n              }\n              if (frag.loadCounter) {\n                frag.loadCounter++;\n                let maxThreshold = config.fragLoadingLoopThreshold;\n                // if this frag has already been loaded 3 times, and if it has been reloaded recently\n                if (frag.loadCounter > maxThreshold && (Math.abs(this.fragLoadIdx - frag.loadIdx) < maxThreshold)) {\n                  hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_LOOP_LOADING_ERROR, fatal: false, frag: frag});\n                  return;\n                }\n              } else {\n                frag.loadCounter = 1;\n              }\n              frag.loadIdx = this.fragLoadIdx;\n              this.fragCurrent = frag;\n              this.startFragRequested = true;\n              if (!isNaN(frag.sn)) {\n                this.nextLoadPosition = frag.start + frag.duration;\n              }\n              hls.trigger(Event.FRAG_LOADING, {frag: frag});\n              this.state = State.FRAG_LOADING;\n            }\n          }\n        }\n        break;\n      case State.WAITING_TRACK:\n        track = this.tracks[this.trackId];\n        // check if playlist is already loaded\n        if (track && track.details) {\n          this.state = State.IDLE;\n        }\n        break;\n      case State.FRAG_LOADING_WAITING_RETRY:\n        var now = performance.now();\n        var retryDate = this.retryDate;\n        media = this.media;\n        var isSeeking = media && media.seeking;\n        // if current time is gt than retryDate, or if media seeking let's switch to IDLE state to retry loading\n        if(!retryDate || (now >= retryDate) || isSeeking) {\n          logger.log(`audioStreamController: retryDate reached, switch back to IDLE state`);\n          this.state = State.IDLE;\n        }\n        break;\n      case State.WAITING_INIT_PTS:\n      case State.STOPPED:\n      case State.FRAG_LOADING:\n      case State.PARSING:\n      case State.PARSED:\n      case State.ENDED:\n        break;\n      default:\n        break;\n    }\n  }\n\n  onMediaAttached(data) {\n    var media = this.media = this.mediaBuffer = data.media;\n    this.onvseeking = this.onMediaSeeking.bind(this);\n    this.onvended = this.onMediaEnded.bind(this);\n    media.addEventListener('seeking', this.onvseeking);\n    media.addEventListener('ended', this.onvended);\n    let config = this.config;\n    if(this.tracks && config.autoStartLoad) {\n      this.startLoad(config.startPosition);\n    }\n  }\n\n  onMediaDetaching() {\n    var media = this.media;\n    if (media && media.ended) {\n      logger.log('MSE detaching and video ended, reset startPosition');\n      this.startPosition = this.lastCurrentTime = 0;\n    }\n\n    // reset fragment loading counter on MSE detaching to avoid reporting FRAG_LOOP_LOADING_ERROR after error recovery\n    var tracks = this.tracks;\n    if (tracks) {\n      // reset fragment load counter\n        tracks.forEach(track => {\n          if(track.details) {\n            track.details.fragments.forEach(fragment => {\n              fragment.loadCounter = undefined;\n            });\n          }\n      });\n    }\n    // remove video listeners\n    if (media) {\n      media.removeEventListener('seeking', this.onvseeking);\n      media.removeEventListener('ended', this.onvended);\n      this.onvseeking = this.onvseeked  = this.onvended = null;\n    }\n    this.media = this.mediaBuffer = null;\n    this.loadedmetadata = false;\n    this.stopLoad();\n  }\n\n  onMediaSeeking() {\n    if (this.state === State.ENDED) {\n        // switch to IDLE state to check for potential new fragment\n        this.state = State.IDLE;\n    }\n    if (this.media) {\n      this.lastCurrentTime = this.media.currentTime;\n    }\n    // avoid reporting fragment loop loading error in case user is seeking several times on same position\n    if (this.fragLoadIdx !== undefined) {\n      this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n    }\n    // tick to speed up processing\n    this.tick();\n  }\n\n  onMediaEnded() {\n    // reset startPosition and lastCurrentTime to restart playback @ stream beginning\n    this.startPosition = this.lastCurrentTime = 0;\n  }\n\n\n  onAudioTracksUpdated(data) {\n    logger.log('audio tracks updated');\n    this.tracks = data.audioTracks;\n  }\n\n  onAudioTrackSwitching(data) {\n    // if any URL found on new audio track, it is an alternate audio track\n    var altAudio = !!data.url;\n    this.trackId = data.id;\n    this.state = State.IDLE;\n\n    this.fragCurrent = null;\n    this.state = State.PAUSED;\n    this.waitingFragment=null;\n    // destroy useless demuxer when switching audio to main\n    if (!altAudio) {\n      if (this.demuxer) {\n        this.demuxer.destroy();\n        this.demuxer = null;\n      }\n    } else {\n      // switching to audio track, start timer if not already started\n      if (!this.timer) {\n        this.timer = setInterval(this.ontick, 100);\n      }\n    }\n\n    //should we switch tracks ?\n    if(altAudio){\n      this.audioSwitch = true;\n      //main audio track are handled by stream-controller, just do something if switching to alt audio track\n      this.state=State.IDLE;\n      // increase fragment load Index to avoid frag loop loading error after buffer flush\n      if (this.fragLoadIdx !== undefined) {\n        this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n      }\n    }\n    this.tick();\n  }\n\n  onAudioTrackLoaded(data) {\n    var newDetails = data.details,\n        trackId = data.id,\n        track = this.tracks[trackId],\n        duration = newDetails.totalduration,\n        sliding = 0;\n\n    logger.log(`track ${trackId} loaded [${newDetails.startSN},${newDetails.endSN}],duration:${duration}`);\n\n    if (newDetails.live) {\n      var curDetails = track.details;\n      if (curDetails && newDetails.fragments.length > 0) {\n        // we already have details for that level, merge them\n        LevelHelper.mergeDetails(curDetails,newDetails);\n        sliding = newDetails.fragments[0].start;\n        // TODO\n        //this.liveSyncPosition = this.computeLivePosition(sliding, curDetails);\n        if (newDetails.PTSKnown) {\n          logger.log(`live audio playlist sliding:${sliding.toFixed(3)}`);\n        } else {\n          logger.log('live audio playlist - outdated PTS, unknown sliding');\n        }\n      } else {\n        newDetails.PTSKnown = false;\n        logger.log('live audio playlist - first load, unknown sliding');\n      }\n    } else {\n      newDetails.PTSKnown = false;\n    }\n    track.details = newDetails;\n\n    // compute start position\n    if (!this.startFragRequested) {\n    // compute start position if set to -1. use it straight away if value is defined\n      if (this.startPosition === -1) {\n        // first, check if start time offset has been set in playlist, if yes, use this value\n        let startTimeOffset = newDetails.startTimeOffset;\n        if(!isNaN(startTimeOffset)) {\n          logger.log(`start time offset found in playlist, adjust startPosition to ${startTimeOffset}`);\n          this.startPosition = startTimeOffset;\n        } else {\n          this.startPosition = 0;\n        }\n      }\n      this.nextLoadPosition = this.startPosition;\n    }\n    // only switch batck to IDLE state if we were waiting for track to start downloading a new fragment\n    if (this.state === State.WAITING_TRACK) {\n      this.state = State.IDLE;\n    }\n    //trigger handler right now\n    this.tick();\n  }\n\n  onKeyLoaded() {\n    if (this.state === State.KEY_LOADING) {\n      this.state = State.IDLE;\n      this.tick();\n    }\n  }\n\n  onFragLoaded(data) {\n    var fragCurrent = this.fragCurrent,\n        fragLoaded = data.frag;\n    if (this.state === State.FRAG_LOADING &&\n        fragCurrent &&\n        fragLoaded.type === 'audio' &&\n        fragLoaded.level === fragCurrent.level &&\n        fragLoaded.sn === fragCurrent.sn) {\n        var track = this.tracks[this.trackId],\n            details = track.details,\n            duration = details.totalduration,\n            trackId = fragCurrent.level,\n            sn = fragCurrent.sn,\n            cc = fragCurrent.cc,\n            audioCodec = this.config.defaultAudioCodec || track.audioCodec || 'mp4a.40.2',\n            stats = this.stats = data.stats;\n      if (sn === 'initSegment') {\n        this.state = State.IDLE;\n\n        stats.tparsed = stats.tbuffered = performance.now();\n        details.initSegment.data = data.payload;\n        this.hls.trigger(Event.FRAG_BUFFERED, {stats: stats, frag: fragCurrent, id : 'audio'});\n        this.tick();\n      } else {\n        this.state = State.PARSING;\n        // transmux the MPEG-TS data to ISO-BMFF segments\n        this.appended = false;\n        if(!this.demuxer) {\n          this.demuxer = new Demuxer(this.hls,'audio');\n        }\n        //Check if we have video initPTS\n        // If not we need to wait for it\n        let initPTS = this.initPTS[cc];\n        let initSegmentData = details.initSegment ? details.initSegment.data : [];\n        if (details.initSegment || initPTS !== undefined){\n          this.pendingBuffering = true;\n          logger.log(`Demuxing ${sn} of [${details.startSN} ,${details.endSN}],track ${trackId}`);\n          // time Offset is accurate if level PTS is known, or if playlist is not sliding (not live)\n          let accurateTimeOffset = false; //details.PTSKnown || !details.live;\n          this.demuxer.push(data.payload, initSegmentData, audioCodec, null, fragCurrent, duration, accurateTimeOffset, initPTS);\n        } else {\n          logger.log(`unknown video PTS for continuity counter ${cc}, waiting for video PTS before demuxing audio frag ${sn} of [${details.startSN} ,${details.endSN}],track ${trackId}`);\n          this.waitingFragment=data;\n          this.state=State.WAITING_INIT_PTS;\n        }\n      }\n    }\n    this.fragLoadError = 0;\n  }\n\n  onFragParsingInitSegment(data) {\n    const fragCurrent = this.fragCurrent;\n    const fragNew = data.frag;\n    if (fragCurrent &&\n        data.id === 'audio' &&\n        fragNew.sn === fragCurrent.sn &&\n        fragNew.level === fragCurrent.level &&\n        this.state === State.PARSING) {\n      let tracks = data.tracks, track;\n\n      // delete any video track found on audio demuxer\n      if (tracks.video) {\n        delete tracks.video;\n      }\n\n      // include levelCodec in audio and video tracks\n      track = tracks.audio;\n      if(track) {\n        track.levelCodec = 'mp4a.40.2';\n        track.id = data.id;\n        this.hls.trigger(Event.BUFFER_CODECS,tracks);\n        logger.log(`audio track:audio,container:${track.container},codecs[level/parsed]=[${track.levelCodec}/${track.codec}]`);\n        let initSegment = track.initSegment;\n        if (initSegment) {\n          let appendObj = {type: 'audio', data: initSegment, parent : 'audio',content : 'initSegment'};\n          if (this.audioSwitch) {\n            this.pendingData = [appendObj];\n          } else {\n            this.appended = true;\n            // arm pending Buffering flag before appending a segment\n            this.pendingBuffering = true;\n            this.hls.trigger(Event.BUFFER_APPENDING, appendObj);\n          }\n        }\n        //trigger handler right now\n        this.tick();\n      }\n    }\n  }\n\n  onFragParsingData(data) {\n    const fragCurrent = this.fragCurrent;\n    const fragNew = data.frag;\n    if (fragCurrent &&\n        data.id === 'audio' &&\n        data.type === 'audio' &&\n        fragNew.sn === fragCurrent.sn &&\n        fragNew.level === fragCurrent.level &&\n        this.state === State.PARSING) {\n      let trackId= this.trackId,\n          track = this.tracks[trackId],\n          hls = this.hls;\n\n      if (isNaN(data.endPTS)) {\n        data.endPTS = data.startPTS + fragCurrent.duration;\n        data.endDTS = data.startDTS + fragCurrent.duration;\n      }\n\n      logger.log(`parsed ${data.type},PTS:[${data.startPTS.toFixed(3)},${data.endPTS.toFixed(3)}],DTS:[${data.startDTS.toFixed(3)}/${data.endDTS.toFixed(3)}],nb:${data.nb}`);\n      LevelHelper.updateFragPTSDTS(track.details,fragCurrent,data.startPTS,data.endPTS);\n\n      let audioSwitch = this.audioSwitch, media = this.media, appendOnBufferFlush = false;\n      //Only flush audio from old audio tracks when PTS is known on new audio track\n      if(audioSwitch && media) {\n        if (media.readyState) {\n          let currentTime = media.currentTime;\n          logger.log('switching audio track : currentTime:'+ currentTime);\n          if (currentTime >= data.startPTS) {\n            logger.log('switching audio track : flushing all audio');\n            this.state = State.BUFFER_FLUSHING;\n            hls.trigger(Event.BUFFER_FLUSHING, {startOffset: 0 , endOffset: Number.POSITIVE_INFINITY, type : 'audio'});\n            appendOnBufferFlush = true;\n            //Lets announce that the initial audio track switch flush occur\n            this.audioSwitch = false;\n            hls.trigger(Event.AUDIO_TRACK_SWITCHED, {id : trackId});\n          }\n        } else {\n          //Lets announce that the initial audio track switch flush occur\n          this.audioSwitch=false;\n          hls.trigger(Event.AUDIO_TRACK_SWITCHED, {id : trackId});\n        }\n      }\n\n\n      let pendingData = this.pendingData;\n      if(!this.audioSwitch) {\n        [data.data1, data.data2].forEach(buffer => {\n          if (buffer && buffer.length) {\n            pendingData.push({type: data.type, data: buffer, parent : 'audio',content : 'data'});\n          }\n        });\n      if (!appendOnBufferFlush && pendingData.length) {\n          pendingData.forEach(appendObj => {\n            // only append in PARSING state (rationale is that an appending error could happen synchronously on first segment appending)\n            // in that case it is useless to append following segments\n            if (this.state === State.PARSING) {\n              // arm pending Buffering flag before appending a segment\n              this.pendingBuffering = true;\n              this.hls.trigger(Event.BUFFER_APPENDING, appendObj);\n            }\n          });\n          this.pendingData = [];\n          this.appended = true;\n        }\n      }\n      //trigger handler right now\n      this.tick();\n    }\n  }\n\n  onFragParsed(data) {\n    const fragCurrent = this.fragCurrent;\n    const fragNew = data.frag;\n    if (fragCurrent &&\n        data.id === 'audio' &&\n        fragNew.sn === fragCurrent.sn &&\n        fragNew.level === fragCurrent.level &&\n        this.state === State.PARSING) {\n      this.stats.tparsed = performance.now();\n      this.state = State.PARSED;\n      this._checkAppendedParsed();\n    }\n  }\n\n\n  onBufferCreated(data) {\n    let audioTrack = data.tracks.audio;\n    if (audioTrack) {\n      this.mediaBuffer = audioTrack.buffer;\n      this.loadedmetadata = true;\n    }\n  }\n\n  onBufferAppended(data) {\n    if (data.parent === 'audio') {\n      const state = this.state;\n      if (state === State.PARSING || state === State.PARSED) {\n        // check if all buffers have been appended\n        this.pendingBuffering = (data.pending > 0);\n        this._checkAppendedParsed();\n      }\n    }\n  }\n\n  _checkAppendedParsed() {\n    //trigger handler right now\n    if (this.state === State.PARSED && (!this.appended || !this.pendingBuffering))   {\n      let frag = this.fragCurrent, stats = this.stats, hls = this.hls;\n      if (frag) {\n        this.fragPrevious = frag;\n        stats.tbuffered = performance.now();\n        hls.trigger(Event.FRAG_BUFFERED, {stats: stats, frag: frag, id : 'audio'});\n        let media = this.mediaBuffer ? this.mediaBuffer : this.media;\n        logger.log(`audio buffered : ${TimeRanges.toString(media.buffered)}`);\n        if (this.audioSwitch && this.appended) {\n          this.audioSwitch = false;\n          hls.trigger(Event.AUDIO_TRACK_SWITCHED, {id : this.trackId});\n        }\n        this.state = State.IDLE;\n      }\n      this.tick();\n    }\n  }\n\n  onError(data) {\n    let frag = data.frag;\n    // don't handle frag error not related to audio fragment\n    if (frag && frag.type !== 'audio') {\n      return;\n    }\n    switch(data.details) {\n      case ErrorDetails.FRAG_LOAD_ERROR:\n      case ErrorDetails.FRAG_LOAD_TIMEOUT:\n        if(!data.fatal) {\n          var loadError = this.fragLoadError;\n          if(loadError) {\n            loadError++;\n          } else {\n            loadError=1;\n          }\n          let config = this.config;\n          if (loadError <= config.fragLoadingMaxRetry) {\n            this.fragLoadError = loadError;\n            // reset load counter to avoid frag loop loading error\n            frag.loadCounter = 0;\n            // exponential backoff capped to config.fragLoadingMaxRetryTimeout\n            var delay = Math.min(Math.pow(2,loadError-1)*config.fragLoadingRetryDelay,config.fragLoadingMaxRetryTimeout);\n            logger.warn(`audioStreamController: frag loading failed, retry in ${delay} ms`);\n            this.retryDate = performance.now() + delay;\n            // retry loading state\n            this.state = State.FRAG_LOADING_WAITING_RETRY;\n          } else {\n            logger.error(`audioStreamController: ${data.details} reaches max retry, redispatch as fatal ...`);\n            // switch error to fatal\n            data.fatal = true;\n            this.state = State.ERROR;\n          }\n        }\n        break;\n      case ErrorDetails.FRAG_LOOP_LOADING_ERROR:\n      case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:\n      case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:\n      case ErrorDetails.KEY_LOAD_ERROR:\n      case ErrorDetails.KEY_LOAD_TIMEOUT:\n        //  when in ERROR state, don't switch back to IDLE state in case a non-fatal error is received\n        if(this.state !== State.ERROR) {\n            // if fatal error, stop processing, otherwise move to IDLE to retry loading\n            this.state = data.fatal ? State.ERROR : State.IDLE;\n            logger.warn(`audioStreamController: ${data.details} while loading frag,switch to ${this.state} state ...`);\n        }\n        break;\n      case ErrorDetails.BUFFER_FULL_ERROR:\n        // if in appending state\n        if (data.parent === 'audio' && (this.state === State.PARSING || this.state === State.PARSED)) {\n          const media = this.mediaBuffer,\n                currentTime = this.media.currentTime,\n                mediaBuffered = media && BufferHelper.isBuffered(media,currentTime) && BufferHelper.isBuffered(media,currentTime+0.5);\n          // reduce max buf len if current position is buffered\n          if (mediaBuffered) {\n            const config = this.config;\n            if(config.maxMaxBufferLength >= config.maxBufferLength) {\n              // reduce max buffer length as it might be too high. we do this to avoid loop flushing ...\n              config.maxMaxBufferLength/=2;\n              logger.warn(`audio:reduce max buffer length to ${config.maxMaxBufferLength}s`);\n              // increase fragment load Index to avoid frag loop loading error after buffer flush\n              this.fragLoadIdx += 2 * config.fragLoadingLoopThreshold;\n            }\n            this.state = State.IDLE;\n          } else {\n            // current position is not buffered, but browser is still complaining about buffer full error\n            // this happens on IE/Edge, refer to https://github.com/video-dev/hls.js/pull/708\n            // in that case flush the whole audio buffer to recover\n            logger.warn('buffer full error also media.currentTime is not buffered, flush audio buffer');\n            this.fragCurrent = null;\n            // flush everything\n            this.state = State.BUFFER_FLUSHING;\n            this.hls.trigger(Event.BUFFER_FLUSHING, {startOffset: 0 , endOffset: Number.POSITIVE_INFINITY, type : 'audio'});\n          }\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  onBufferFlushed() {\n    let pendingData = this.pendingData;\n    if (pendingData && pendingData.length) {\n      logger.log('appending pending audio data on Buffer Flushed');\n      pendingData.forEach(appendObj => {\n        this.hls.trigger(Event.BUFFER_APPENDING, appendObj);\n      });\n      this.appended = true;\n      this.pendingData = [];\n      this.state = State.PARSED;\n    } else {\n      // move to IDLE once flush complete. this should trigger new fragment loading\n      this.state = State.IDLE;\n      // reset reference to frag\n      this.fragPrevious = null;\n      this.tick();\n    }\n  }\n}\nexport default AudioStreamController;\n\n\n\n\n// WEBPACK FOOTER //\n// src/controller/audio-stream-controller.js","/*\n * audio track controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport {logger} from '../utils/logger';\n\nclass AudioTrackController extends EventHandler {\n\n  constructor(hls) {\n    super(hls, Event.MANIFEST_LOADING,\n               Event.MANIFEST_LOADED,\n               Event.AUDIO_TRACK_LOADED);\n    this.ticks = 0;\n    this.ontick = this.tick.bind(this);\n  }\n\n  destroy() {\n    EventHandler.prototype.destroy.call(this);\n  }\n  tick() {\n    this.ticks++;\n    if (this.ticks === 1) {\n      this.doTick();\n      if (this.ticks > 1) {\n        setTimeout(this.tick, 1);\n      }\n      this.ticks = 0;\n    }\n  }\n  doTick() {\n    this.updateTrack(this.trackId);\n  }\n  onManifestLoading() {\n    // reset audio tracks on manifest loading\n    this.tracks = [];\n    this.trackId = -1;\n  }\n\n  onManifestLoaded(data) {\n    let tracks = data.audioTracks || [];\n    let defaultFound = false;\n    this.tracks = tracks;\n    this.hls.trigger(Event.AUDIO_TRACKS_UPDATED, {audioTracks : tracks});\n    // loop through available audio tracks and autoselect default if needed\n    let id = 0;\n    tracks.forEach(track => {\n      if(track.default) {\n        this.audioTrack = id;\n        defaultFound = true;\n        return;\n      }\n      id++;\n    });\n    if (defaultFound === false && tracks.length) {\n      logger.log('no default audio track defined, use first audio track as default');\n      this.audioTrack = 0;\n    }\n  }\n\n  onAudioTrackLoaded(data) {\n    if (data.id < this.tracks.length) {\n      logger.log(`audioTrack ${data.id} loaded`);\n      this.tracks[data.id].details = data.details;\n      // check if current playlist is a live playlist\n      if (data.details.live && !this.timer) {\n        // if live playlist we will have to reload it periodically\n        // set reload period to playlist target duration\n        this.timer = setInterval(this.ontick, 1000 * data.details.targetduration);\n      }\n      if (!data.details.live && this.timer) {\n        // playlist is not live and timer is armed : stopping it\n        clearInterval(this.timer);\n        this.timer = null;\n      }\n    }\n  }\n\n  /** get alternate audio tracks list from playlist **/\n  get audioTracks() {\n    return this.tracks;\n  }\n\n  /** get index of the selected audio track (index in audio track lists) **/\n  get audioTrack() {\n   return this.trackId;\n  }\n\n  /** select an audio track, based on its index in audio track lists**/\n  set audioTrack(audioTrackId) {\n    if (this.trackId !== audioTrackId || this.tracks[audioTrackId].details === undefined) {\n      this.setAudioTrackInternal(audioTrackId);\n    }\n  }\n\n setAudioTrackInternal(newId) {\n    // check if level idx is valid\n    if (newId >= 0 && newId < this.tracks.length) {\n      // stopping live reloading timer if any\n      if (this.timer) {\n       clearInterval(this.timer);\n       this.timer = null;\n      }\n      this.trackId = newId;\n      logger.log(`switching to audioTrack ${newId}`);\n      let audioTrack = this.tracks[newId],\n          hls = this.hls,\n          type = audioTrack.type,\n          url = audioTrack.url,\n          eventObj = {id: newId, type : type, url : url};\n      // keep AUDIO_TRACK_SWITCH for legacy reason\n      hls.trigger(Event.AUDIO_TRACK_SWITCH, eventObj);\n      hls.trigger(Event.AUDIO_TRACK_SWITCHING, eventObj);\n       // check if we need to load playlist for this audio Track\n       let details = audioTrack.details;\n      if (url && (details === undefined || details.live === true)) {\n        // track not retrieved yet, or live playlist we need to (re)load it\n        logger.log(`(re)loading playlist for audioTrack ${newId}`);\n        hls.trigger(Event.AUDIO_TRACK_LOADING, {url: url, id: newId});\n      }\n    }\n  }\n\n  updateTrack(newId) {\n    // check if level idx is valid\n    if (newId >= 0 && newId < this.tracks.length) {\n      // stopping live reloading timer if any\n      if (this.timer) {\n       clearInterval(this.timer);\n       this.timer = null;\n      }\n      this.trackId = newId;\n      logger.log(`updating audioTrack ${newId}`);\n      let audioTrack = this.tracks[newId], url = audioTrack.url;\n       // check if we need to load playlist for this audio Track\n       let details = audioTrack.details;\n      if (url && (details === undefined || details.live === true)) {\n        // track not retrieved yet, or live playlist we need to (re)load it\n        logger.log(`(re)loading playlist for audioTrack ${newId}`);\n        this.hls.trigger(Event.AUDIO_TRACK_LOADING, {url: url, id: newId});\n      }\n    }\n  }\n}\n\nexport default AudioTrackController;\n\n\n\n// WEBPACK FOOTER //\n// src/controller/audio-track-controller.js","/*\n * Buffer Controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport {logger} from '../utils/logger';\nimport {ErrorTypes, ErrorDetails} from '../errors';\n\n\nclass BufferController extends EventHandler {\n\n  constructor(hls) {\n    super(hls,\n      Event.MEDIA_ATTACHING,\n      Event.MEDIA_DETACHING,\n      Event.MANIFEST_PARSED,\n      Event.BUFFER_RESET,\n      Event.BUFFER_APPENDING,\n      Event.BUFFER_CODECS,\n      Event.BUFFER_EOS,\n      Event.BUFFER_FLUSHING,\n      Event.LEVEL_PTS_UPDATED,\n      Event.LEVEL_UPDATED);\n\n    // the value that we have set mediasource.duration to\n    // (the actual duration may be tweaked slighly by the browser)\n    this._msDuration = null;\n    // the value that we want to set mediaSource.duration to\n    this._levelDuration = null;\n\n    // Source Buffer listeners\n    this.onsbue = this.onSBUpdateEnd.bind(this);\n    this.onsbe  = this.onSBUpdateError.bind(this);\n    this.pendingTracks = {};\n    this.tracks = {};\n  }\n\n  destroy() {\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onLevelPtsUpdated(data) {\n    let type = data.type;\n    let audioTrack = this.tracks.audio;\n\n    // Adjusting `SourceBuffer.timestampOffset` (desired point in the timeline where the next frames should be appended)\n    // in Chrome browser when we detect MPEG audio container and time delta between level PTS and `SourceBuffer.timestampOffset`\n    // is greater than 100ms (this is enough to handle seek for VOD or level change for LIVE videos). At the time of change we issue\n    // `SourceBuffer.abort()` and adjusting `SourceBuffer.timestampOffset` if `SourceBuffer.updating` is false or awaiting `updateend`\n    // event if SB is in updating state.\n    // More info here: https://github.com/video-dev/hls.js/issues/332#issuecomment-257986486\n\n    if (type === 'audio' && audioTrack && audioTrack.container === 'audio/mpeg') { // Chrome audio mp3 track\n      let audioBuffer = this.sourceBuffer.audio;\n      let delta = Math.abs(audioBuffer.timestampOffset - data.start);\n\n      // adjust timestamp offset if time delta is greater than 100ms\n      if (delta > 0.1) {\n        let updating = audioBuffer.updating;\n\n        try {\n          audioBuffer.abort();\n        } catch (err) {\n          updating = true;\n          logger.warn('can not abort audio buffer: ' + err);\n        }\n\n        if (!updating) {\n          logger.warn('change mpeg audio timestamp offset from ' + audioBuffer.timestampOffset + ' to ' + data.start);\n          audioBuffer.timestampOffset = data.start;\n        } else {\n          this.audioTimestampOffset = data.start;\n        }\n      }\n    }\n  }\n\n  onManifestParsed(data) {\n    let audioExpected = data.audio,\n        videoExpected = data.video,\n        sourceBufferNb = 0;\n    // in case of alt audio 2 BUFFER_CODECS events will be triggered, one per stream controller\n    // sourcebuffers will be created all at once when the expected nb of tracks will be reached\n    // in case alt audio is not used, only one BUFFER_CODEC event will be fired from main stream controller\n    // it will contain the expected nb of source buffers, no need to compute it\n    if (data.altAudio && (audioExpected || videoExpected)) {\n      sourceBufferNb = (audioExpected ? 1 : 0) + (videoExpected ? 1 : 0);\n      logger.log(`${sourceBufferNb} sourceBuffer(s) expected`);\n    }\n    this.sourceBufferNb = sourceBufferNb;\n  }\n\n  onMediaAttaching(data) {\n    let media = this.media = data.media;\n    if (media) {\n      // setup the media source\n      var ms = this.mediaSource = new MediaSource();\n      //Media Source listeners\n      this.onmso = this.onMediaSourceOpen.bind(this);\n      this.onmse = this.onMediaSourceEnded.bind(this);\n      this.onmsc = this.onMediaSourceClose.bind(this);\n      ms.addEventListener('sourceopen', this.onmso);\n      ms.addEventListener('sourceended', this.onmse);\n      ms.addEventListener('sourceclose', this.onmsc);\n      // link video and media Source\n      media.src = URL.createObjectURL(ms);\n    }\n  }\n\n  onMediaDetaching() {\n    logger.log('media source detaching');\n    var ms = this.mediaSource;\n    if (ms) {\n      if (ms.readyState === 'open') {\n        try {\n          // endOfStream could trigger exception if any sourcebuffer is in updating state\n          // we don't really care about checking sourcebuffer state here,\n          // as we are anyway detaching the MediaSource\n          // let's just avoid this exception to propagate\n          ms.endOfStream();\n        } catch(err) {\n          logger.warn(`onMediaDetaching:${err.message} while calling endOfStream`);\n        }\n      }\n      ms.removeEventListener('sourceopen', this.onmso);\n      ms.removeEventListener('sourceended', this.onmse);\n      ms.removeEventListener('sourceclose', this.onmsc);\n\n      // Detach properly the MediaSource from the HTMLMediaElement as\n      // suggested in https://github.com/w3c/media-source/issues/53.\n      if (this.media) {\n        URL.revokeObjectURL(this.media.src);\n        this.media.removeAttribute('src');\n        this.media.load();\n      }\n\n      this.mediaSource = null;\n      this.media = null;\n      this.pendingTracks = {};\n      this.tracks = {};\n      this.sourceBuffer = {};\n      this.flushRange = [];\n      this.segments = [];\n      this.appended = 0;\n    }\n    this.onmso = this.onmse = this.onmsc = null;\n    this.hls.trigger(Event.MEDIA_DETACHED);\n  }\n\n  onMediaSourceOpen() {\n    logger.log('media source opened');\n    this.hls.trigger(Event.MEDIA_ATTACHED, { media : this.media });\n    let mediaSource = this.mediaSource;\n    if (mediaSource) {\n      // once received, don't listen anymore to sourceopen event\n      mediaSource.removeEventListener('sourceopen', this.onmso);\n    }\n    this.checkPendingTracks();\n  }\n\n  checkPendingTracks() {\n    // if any buffer codecs pending, check if we have enough to create sourceBuffers\n    let pendingTracks = this.pendingTracks,\n        pendingTracksNb = Object.keys(pendingTracks).length;\n    // if any pending tracks and (if nb of pending tracks gt or equal than expected nb or if unknown expected nb)\n    if (pendingTracksNb && (\n        this.sourceBufferNb <= pendingTracksNb ||\n        this.sourceBufferNb === 0)) {\n      // ok, let's create them now !\n      this.createSourceBuffers(pendingTracks);\n      this.pendingTracks = {};\n      // append any pending segments now !\n      this.doAppending();\n    }\n  }\n\n  onMediaSourceClose() {\n    logger.log('media source closed');\n  }\n\n  onMediaSourceEnded() {\n    logger.log('media source ended');\n  }\n\n\n  onSBUpdateEnd() {\n    // update timestampOffset\n    if (this.audioTimestampOffset) {\n      let audioBuffer = this.sourceBuffer.audio;\n      logger.warn('change mpeg audio timestamp offset from ' + audioBuffer.timestampOffset + ' to ' + this.audioTimestampOffset);\n      audioBuffer.timestampOffset = this.audioTimestampOffset;\n      delete this.audioTimestampOffset;\n    }\n\n    if (this._needsFlush) {\n      this.doFlush();\n    }\n\n    if (this._needsEos) {\n      this.checkEos();\n    }\n    this.appending = false;\n    let parent = this.parent;\n    // count nb of pending segments waiting for appending on this sourcebuffer\n    let pending = this.segments.reduce( (counter, segment) => (segment.parent === parent) ? counter + 1 : counter , 0);\n    this.hls.trigger(Event.BUFFER_APPENDED, { parent : parent, pending : pending });\n\n    // don't append in flushing mode\n    if (!this._needsFlush) {\n      this.doAppending();\n    }\n\n    this.updateMediaElementDuration();\n  }\n\n  onSBUpdateError(event) {\n    logger.error('sourceBuffer error:', event);\n    // according to http://www.w3.org/TR/media-source/#sourcebuffer-append-error\n    // this error might not always be fatal (it is fatal if decode error is set, in that case\n    // it will be followed by a mediaElement error ...)\n    this.hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_APPENDING_ERROR, fatal: false});\n    // we don't need to do more than that, as accordin to the spec, updateend will be fired just after\n  }\n\n  onBufferReset() {\n    var sourceBuffer = this.sourceBuffer;\n    for(var type in sourceBuffer) {\n      var sb = sourceBuffer[type];\n      try {\n        this.mediaSource.removeSourceBuffer(sb);\n        sb.removeEventListener('updateend', this.onsbue);\n        sb.removeEventListener('error', this.onsbe);\n      } catch(err) {\n      }\n    }\n    this.sourceBuffer = {};\n    this.flushRange = [];\n    this.segments = [];\n    this.appended = 0;\n  }\n\n  onBufferCodecs(tracks) {\n    // if source buffer(s) not created yet, appended buffer tracks in this.pendingTracks\n    // if sourcebuffers already created, do nothing ...\n    if (Object.keys(this.sourceBuffer).length === 0) {\n      for (var trackName in tracks) { this.pendingTracks[trackName] = tracks[trackName]; }\n      let mediaSource = this.mediaSource;\n      if (mediaSource && mediaSource.readyState === 'open') {\n        // try to create sourcebuffers if mediasource opened\n        this.checkPendingTracks();\n      }\n    }\n  }\n\n\n  createSourceBuffers(tracks) {\n    var sourceBuffer = this.sourceBuffer,mediaSource = this.mediaSource;\n\n    for (let trackName in tracks) {\n      if(!sourceBuffer[trackName]) {\n        let track = tracks[trackName];\n        // use levelCodec as first priority\n        let codec = track.levelCodec || track.codec;\n        let mimeType = `${track.container};codecs=${codec}`;\n        logger.log(`creating sourceBuffer(${mimeType})`);\n        try {\n          let sb = sourceBuffer[trackName] = mediaSource.addSourceBuffer(mimeType);\n          sb.addEventListener('updateend', this.onsbue);\n          sb.addEventListener('error', this.onsbe);\n          this.tracks[trackName] = {codec: codec, container: track.container};\n          track.buffer = sb;\n        } catch(err) {\n          logger.error(`error while trying to add sourceBuffer:${err.message}`);\n          this.hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_ADD_CODEC_ERROR, fatal: false, err: err, mimeType : mimeType});\n        }\n      }\n    }\n    this.hls.trigger(Event.BUFFER_CREATED, { tracks : tracks } );\n  }\n\n  onBufferAppending(data) {\n    if (!this._needsFlush) {\n      if (!this.segments) {\n        this.segments = [ data ];\n      } else {\n        this.segments.push(data);\n      }\n      this.doAppending();\n    }\n  }\n\n  onBufferAppendFail(data) {\n    logger.error('sourceBuffer error:',data.event);\n    // according to http://www.w3.org/TR/media-source/#sourcebuffer-append-error\n    // this error might not always be fatal (it is fatal if decode error is set, in that case\n    // it will be followed by a mediaElement error ...)\n    this.hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_APPENDING_ERROR, fatal: false});\n  }\n\n  // on BUFFER_EOS mark matching sourcebuffer(s) as ended and trigger checkEos()\n  onBufferEos(data) {\n    var sb = this.sourceBuffer;\n    let dataType = data.type;\n    for(let type in sb) {\n      if (!dataType || type === dataType) {\n        if (!sb[type].ended) {\n          sb[type].ended = true;\n          logger.log(`${type} sourceBuffer now EOS`);\n        }\n      }\n    }\n    this.checkEos();\n  }\n\n // if all source buffers are marked as ended, signal endOfStream() to MediaSource.\n checkEos() {\n    var sb = this.sourceBuffer, mediaSource = this.mediaSource;\n    if (!mediaSource || mediaSource.readyState !== 'open') {\n      this._needsEos = false;\n      return;\n    }\n    for(let type in sb) {\n      let sbobj = sb[type];\n      if (!sbobj.ended) {\n        return;\n      }\n      if(sbobj.updating) {\n        this._needsEos = true;\n        return;\n      }\n    }\n    logger.log('all media data available, signal endOfStream() to MediaSource and stop loading fragment');\n    //Notify the media element that it now has all of the media data\n    try {\n      mediaSource.endOfStream();\n    } catch(e) {\n      logger.warn('exception while calling mediaSource.endOfStream()');\n    }\n    this._needsEos = false;\n }\n\n\n  onBufferFlushing(data) {\n    this.flushRange.push({start: data.startOffset, end: data.endOffset, type : data.type});\n    // attempt flush immediatly\n    this.flushBufferCounter = 0;\n    this.doFlush();\n  }\n\n  onLevelUpdated(event) {\n    let details = event.details;\n    if (details.fragments.length === 0) {\n      return;\n    }\n    this._levelDuration = details.totalduration + details.fragments[0].start;\n    this.updateMediaElementDuration();\n  }\n\n  // https://github.com/video-dev/hls.js/issues/355\n  updateMediaElementDuration() {\n    let media = this.media,\n        mediaSource = this.mediaSource,\n        sourceBuffer = this.sourceBuffer,\n        levelDuration = this._levelDuration;\n    if (levelDuration === null || !media || !mediaSource || !sourceBuffer || media.readyState === 0 || mediaSource.readyState !== 'open') {\n      return;\n    }\n    for (let type in sourceBuffer) {\n      if (sourceBuffer[type].updating) {\n        // can't set duration whilst a buffer is updating\n        return;\n      }\n    }\n    if (this._msDuration === null) {\n      // initialise to the value that the media source is reporting\n      this._msDuration = mediaSource.duration;\n    }\n    let duration = media.duration;\n    // levelDuration was the last value we set.\n    // not using mediaSource.duration as the browser may tweak this value\n    // only update mediasource duration if its value increase, this is to avoid\n    // flushing already buffered portion when switching between quality level\n    if ((levelDuration > this._msDuration && levelDuration > duration) || (duration === Infinity || isNaN(duration) )) {\n      logger.log(`Updating mediasource duration to ${levelDuration.toFixed(3)}`);\n      this._msDuration = mediaSource.duration = levelDuration;\n    }\n  }\n\n  doFlush() {\n    // loop through all buffer ranges to flush\n    while(this.flushRange.length) {\n      var range = this.flushRange[0];\n      // flushBuffer will abort any buffer append in progress and flush Audio/Video Buffer\n      if (this.flushBuffer(range.start, range.end, range.type)) {\n        // range flushed, remove from flush array\n        this.flushRange.shift();\n        this.flushBufferCounter = 0;\n      } else {\n        this._needsFlush = true;\n        // avoid looping, wait for SB update end to retrigger a flush\n        return;\n      }\n    }\n    if (this.flushRange.length === 0) {\n      // everything flushed\n      this._needsFlush = false;\n\n      // let's recompute this.appended, which is used to avoid flush looping\n      var appended = 0;\n      var sourceBuffer = this.sourceBuffer;\n      try {\n        for (var type in sourceBuffer) {\n          appended += sourceBuffer[type].buffered.length;\n        }\n      } catch(error) {\n        // error could be thrown while accessing buffered, in case sourcebuffer has already been removed from MediaSource\n        // this is harmess at this stage, catch this to avoid reporting an internal exception\n        logger.error('error while accessing sourceBuffer.buffered');\n      }\n      this.appended = appended;\n      this.hls.trigger(Event.BUFFER_FLUSHED);\n    }\n  }\n\n  doAppending() {\n    var hls = this.hls, sourceBuffer = this.sourceBuffer, segments = this.segments;\n    if (Object.keys(sourceBuffer).length) {\n      if (this.media.error) {\n        this.segments = [];\n        logger.error('trying to append although a media error occured, flush segment and abort');\n        return;\n      }\n      if (this.appending) {\n        //logger.log(`sb appending in progress`);\n        return;\n      }\n      if (segments && segments.length) {\n        let segment = segments.shift();\n        try {\n          let type = segment.type, sb = sourceBuffer[type];\n          if(sb) {\n            if(!sb.updating) {\n              // reset sourceBuffer ended flag before appending segment\n              sb.ended = false;\n              //logger.log(`appending ${segment.content} ${type} SB, size:${segment.data.length}, ${segment.parent}`);\n              this.parent = segment.parent;\n              sb.appendBuffer(segment.data);\n              this.appendError = 0;\n              this.appended++;\n              this.appending = true;\n            } else {\n              segments.unshift(segment);\n            }\n          } else {\n            // in case we don't have any source buffer matching with this segment type,\n            // it means that Mediasource fails to create sourcebuffer\n            // discard this segment, and trigger update end\n            this.onSBUpdateEnd();\n          }\n        } catch(err) {\n          // in case any error occured while appending, put back segment in segments table\n          logger.error(`error while trying to append buffer:${err.message}`);\n          segments.unshift(segment);\n          var event = {type: ErrorTypes.MEDIA_ERROR, parent : segment.parent};\n          if(err.code !== 22) {\n            if (this.appendError) {\n              this.appendError++;\n            } else {\n              this.appendError = 1;\n            }\n            event.details = ErrorDetails.BUFFER_APPEND_ERROR;\n            /* with UHD content, we could get loop of quota exceeded error until\n              browser is able to evict some data from sourcebuffer. retrying help recovering this\n            */\n            if (this.appendError > hls.config.appendErrorMaxRetry) {\n              logger.log(`fail ${hls.config.appendErrorMaxRetry} times to append segment in sourceBuffer`);\n              segments = [];\n              event.fatal = true;\n              hls.trigger(Event.ERROR, event);\n              return;\n            } else {\n              event.fatal = false;\n              hls.trigger(Event.ERROR, event);\n            }\n          } else {\n            // QuotaExceededError: http://www.w3.org/TR/html5/infrastructure.html#quotaexceedederror\n            // let's stop appending any segments, and report BUFFER_FULL_ERROR error\n            this.segments = [];\n            event.details = ErrorDetails.BUFFER_FULL_ERROR;\n            event.fatal = false;\n            hls.trigger(Event.ERROR,event);\n            return;\n          }\n        }\n      }\n    }\n  }\n\n  /*\n    flush specified buffered range,\n    return true once range has been flushed.\n    as sourceBuffer.remove() is asynchronous, flushBuffer will be retriggered on sourceBuffer update end\n  */\n  flushBuffer(startOffset, endOffset, typeIn) {\n    var sb, i, bufStart, bufEnd, flushStart, flushEnd, sourceBuffer = this.sourceBuffer;\n    if (Object.keys(sourceBuffer).length) {\n      logger.log(`flushBuffer,pos/start/end: ${this.media.currentTime.toFixed(3)}/${startOffset}/${endOffset}`);\n      // safeguard to avoid infinite looping : don't try to flush more than the nb of appended segments\n      if (this.flushBufferCounter < this.appended) {\n        for (var type in sourceBuffer) {\n          // check if sourcebuffer type is defined (typeIn): if yes, let's only flush this one\n          // if no, let's flush all sourcebuffers\n          if (typeIn && type !== typeIn) {\n            continue;\n          }\n          sb = sourceBuffer[type];\n          // we are going to flush buffer, mark source buffer as 'not ended'\n          sb.ended = false;\n          if (!sb.updating) {\n            try {\n              for (i = 0; i < sb.buffered.length; i++) {\n                bufStart = sb.buffered.start(i);\n                bufEnd = sb.buffered.end(i);\n                // workaround firefox not able to properly flush multiple buffered range.\n                if (navigator.userAgent.toLowerCase().indexOf('firefox') !== -1 && endOffset === Number.POSITIVE_INFINITY) {\n                  flushStart = startOffset;\n                  flushEnd = endOffset;\n                } else {\n                  flushStart = Math.max(bufStart, startOffset);\n                  flushEnd = Math.min(bufEnd, endOffset);\n                }\n                /* sometimes sourcebuffer.remove() does not flush\n                   the exact expected time range.\n                   to avoid rounding issues/infinite loop,\n                   only flush buffer range of length greater than 500ms.\n                */\n                if (Math.min(flushEnd,bufEnd) - flushStart > 0.5 ) {\n                  this.flushBufferCounter++;\n                  logger.log(`flush ${type} [${flushStart},${flushEnd}], of [${bufStart},${bufEnd}], pos:${this.media.currentTime}`);\n                  sb.remove(flushStart, flushEnd);\n                  return false;\n                }\n              }\n            } catch(e) {\n              logger.warn('exception while accessing sourcebuffer, it might have been removed from MediaSource');\n            }\n          } else {\n            //logger.log('abort ' + type + ' append in progress');\n            // this will abort any appending in progress\n            //sb.abort();\n            logger.warn('cannot flush, sb updating in progress');\n            return false;\n          }\n        }\n      } else {\n        logger.warn('abort flushing too many retries');\n      }\n      logger.log('buffer flushed');\n    }\n    // everything flushed !\n    return true;\n  }\n}\n\nexport default BufferController;\n\n\n\n// WEBPACK FOOTER //\n// src/controller/buffer-controller.js","/*\n * cap stream level to media size dimension controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\n\nclass CapLevelController extends EventHandler {\n\tconstructor(hls) {\n    super(hls,\n      Event.FPS_DROP_LEVEL_CAPPING,\n      Event.MEDIA_ATTACHING,\n      Event.MANIFEST_PARSED);\n\t}\n\n\tdestroy() {\n    if (this.hls.config.capLevelToPlayerSize) {\n      this.media = this.restrictedLevels = null;\n      this.autoLevelCapping = Number.POSITIVE_INFINITY;\n      if (this.timer) {\n        this.timer = clearInterval(this.timer);\n      }\n    }\n  }\n\n  onFpsDropLevelCapping(data) {\n    if (!this.restrictedLevels) {\n      this.restrictedLevels = [];\n    }\n    if (!this.isLevelRestricted(data.droppedLevel)) {\n      this.restrictedLevels.push(data.droppedLevel);\n    }\n  }\n\n\tonMediaAttaching(data) {\n    this.media = data.media instanceof HTMLVideoElement ? data.media : null;\n  }\n\n  onManifestParsed(data) {\n    const hls = this.hls;\n    if (hls.config.capLevelToPlayerSize) {\n      this.autoLevelCapping = Number.POSITIVE_INFINITY;\n      this.levels = data.levels;\n      hls.firstLevel = this.getMaxLevel(data.firstLevel);\n      clearInterval(this.timer);\n      this.timer = setInterval(this.detectPlayerSize.bind(this), 1000);\n      this.detectPlayerSize();\n    }\n  }\n\n  detectPlayerSize() {\n    if (this.media) {\n      let levelsLength = this.levels ? this.levels.length : 0;\n      if (levelsLength) {\n        const hls = this.hls;\n        hls.autoLevelCapping = this.getMaxLevel(levelsLength - 1);\n        if (hls.autoLevelCapping > this.autoLevelCapping) {\n          // if auto level capping has a higher value for the previous one, flush the buffer using nextLevelSwitch\n          // usually happen when the user go to the fullscreen mode.\n          hls.streamController.nextLevelSwitch();\n        }\n        this.autoLevelCapping = hls.autoLevelCapping;\n      }\n    }\n  }\n\n  /*\n  * returns level should be the one with the dimensions equal or greater than the media (player) dimensions (so the video will be downscaled)\n  */\n  getMaxLevel(capLevelIndex) {\n    let result = 0,\n        i,\n        level,\n        mWidth = this.mediaWidth,\n        mHeight = this.mediaHeight,\n        lWidth = 0,\n        lHeight = 0;\n\n    for (i = 0; i <= capLevelIndex; i++) {\n      level = this.levels[i];\n      if (this.isLevelRestricted(i)) {\n        break;\n      }\n      result = i;\n      lWidth = level.width;\n      lHeight = level.height;\n      if (mWidth <= lWidth || mHeight <= lHeight) {\n        break;\n      }\n    }\n    return result;\n  }\n\n  isLevelRestricted(level) {\n    return (this.restrictedLevels && this.restrictedLevels.indexOf(level) !== -1) ? true : false;\n  }\n\n  get contentScaleFactor() {\n    let pixelRatio = 1;\n    try {\n      pixelRatio =  window.devicePixelRatio;\n    } catch(e) {}\n    return pixelRatio;\n  }\n\n  get mediaWidth() {\n    let width;\n    const media = this.media;\n    if (media) {\n      width = media.width || media.clientWidth || media.offsetWidth;\n      width *= this.contentScaleFactor;\n    }\n    return width;\n  }\n\n  get mediaHeight() {\n    let height;\n    const media = this.media;\n    if (media) {\n      height = media.height || media.clientHeight || media.offsetHeight;\n      height *= this.contentScaleFactor;\n    }\n    return height;\n  }\n}\n\nexport default CapLevelController;\n\n\n\n// WEBPACK FOOTER //\n// src/controller/cap-level-controller.js","/*\n * FPS Controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport {logger} from '../utils/logger';\n\nclass FPSController extends EventHandler{\n\n  constructor(hls) {\n    super(hls, Event.MEDIA_ATTACHING);\n  }\n\n  destroy() {\n    if (this.timer) {\n      clearInterval(this.timer);\n    }\n    this.isVideoPlaybackQualityAvailable = false;\n  }\n\n  onMediaAttaching(data) {\n    const config = this.hls.config;\n    if (config.capLevelOnFPSDrop) {\n      const video = this.video = data.media instanceof HTMLVideoElement ? data.media : null;\n      if (typeof video.getVideoPlaybackQuality === 'function') {\n        this.isVideoPlaybackQualityAvailable = true;\n      }\n      clearInterval(this.timer);\n      this.timer = setInterval(this.checkFPSInterval.bind(this), config.fpsDroppedMonitoringPeriod);\n    }\n  }\n\n  checkFPS(video, decodedFrames, droppedFrames) {\n    let currentTime = performance.now();\n    if (decodedFrames) {\n      if (this.lastTime) {\n        let currentPeriod = currentTime - this.lastTime,\n            currentDropped = droppedFrames - this.lastDroppedFrames,\n            currentDecoded = decodedFrames - this.lastDecodedFrames,\n            droppedFPS = 1000 * currentDropped / currentPeriod,\n            hls = this.hls;\n        hls.trigger(Event.FPS_DROP, {currentDropped: currentDropped, currentDecoded: currentDecoded, totalDroppedFrames: droppedFrames});\n        if (droppedFPS > 0) {\n          //logger.log('checkFPS : droppedFPS/decodedFPS:' + droppedFPS/(1000 * currentDecoded / currentPeriod));\n          if (currentDropped > hls.config.fpsDroppedMonitoringThreshold * currentDecoded) {\n            let currentLevel = hls.currentLevel;\n            logger.warn('drop FPS ratio greater than max allowed value for currentLevel: ' + currentLevel);\n            if (currentLevel > 0 && (hls.autoLevelCapping === -1 || hls.autoLevelCapping >= currentLevel)) {\n              currentLevel = currentLevel - 1;\n              hls.trigger(Event.FPS_DROP_LEVEL_CAPPING, {level: currentLevel, droppedLevel: hls.currentLevel});\n              hls.autoLevelCapping = currentLevel;\n              hls.streamController.nextLevelSwitch();\n            }\n          }\n        }\n      }\n      this.lastTime = currentTime;\n      this.lastDroppedFrames = droppedFrames;\n      this.lastDecodedFrames = decodedFrames;\n    }\n  }\n\n  checkFPSInterval() {\n    const video = this.video;\n    if (video) {\n      if (this.isVideoPlaybackQualityAvailable) {\n        let videoPlaybackQuality = video.getVideoPlaybackQuality();\n        this.checkFPS(video, videoPlaybackQuality.totalVideoFrames, videoPlaybackQuality.droppedVideoFrames);\n      } else {\n        this.checkFPS(video, video.webkitDecodedFrameCount, video.webkitDroppedFrameCount);\n      }\n    }\n  }\n}\n\nexport default FPSController;\n\n\n\n\n// WEBPACK FOOTER //\n// src/controller/fps-controller.js","/*\n * id3 metadata track controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\n\nclass ID3TrackController extends EventHandler {\n\n  constructor(hls) {\n    super(hls,\n               Event.MEDIA_ATTACHED,\n               Event.MEDIA_DETACHING,\n               Event.FRAG_PARSING_METADATA);\n    this.id3Track = undefined;\n    this.media = undefined;\n  }\n\n  destroy() {\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  // Add ID3 metatadata text track.\n  onMediaAttached(data) {\n    this.media = data.media;\n    if (!this.media) {\n      return;\n    }\n\n    this.id3Track = this.media.addTextTrack('metadata', 'id3');\n    this.id3Track.mode = 'hidden';\n  }\n\n  onMediaDetaching() {\n    this.media = undefined;\n  }\n\n  onFragParsingMetadata(data) {\n    const fragment = data.frag;\n    const samples = data.samples;\n    const startTime = fragment.start;\n    let endTime = fragment.start + fragment.duration;\n    // Give a slight bump to the endTime if it's equal to startTime to avoid a SyntaxError in IE\n    if (startTime === endTime) {\n      endTime += 0.0001;\n    }\n\n    // Attempt to recreate Safari functionality by creating\n    // WebKitDataCue objects when available and store the decoded\n    // ID3 data in the value property of the cue\n    let Cue = window.WebKitDataCue || window.VTTCue || window.TextTrackCue;\n\n    for (let i = 0; i < samples.length; i++) {\n      let id3Frame = this.parseID3Frame(samples[i].data);\n      let frame = this.decodeID3Frame(id3Frame);\n      if (frame) {\n        let cue = new Cue(startTime, endTime, '');\n        cue.value = frame;\n        this.id3Track.addCue(cue);\n      }\n    }\n  }\n\n  parseID3Frame(data) {\n    if (data.length < 21) {\n      return undefined;\n    }\n\n    /* http://id3.org/id3v2.3.0\n    [0]     = 'I'\n    [1]     = 'D'\n    [2]     = '3'\n    [3,4]   = {Version}\n    [5]     = {Flags}\n    [6-9]   = {ID3 Size}\n    [10-13] = {Frame ID}\n    [14-17] = {Frame Size}\n    [18,19] = {Frame Flags}\n    */\n    if (data[0] === 73 &&  // I\n        data[1] === 68 &&  // D\n        data[2] === 51) {  // 3\n\n      let type = String.fromCharCode(data[10], data[11], data[12], data[13]);\n      data = data.subarray(20);\n      return { type, data };\n    }\n  }\n\n  decodeID3Frame(frame) {\n    if (frame.type === 'TXXX') {\n      return this.decodeTxxxFrame(frame);\n    } else if (frame.type === 'PRIV') {\n      return this.decodePrivFrame(frame);\n    } else if (frame.type[0] === 'T') {\n      return this.decodeTextFrame(frame);\n    } else {\n      return undefined;\n    }\n  }\n\n  decodeTxxxFrame(frame) {\n    /*\n    Format:\n    [0]   = {Text Encoding}\n    [1-?] = {Description}\\0{Value}\n    */\n\n    if (frame.size < 2) {\n      return undefined;\n    }\n\n    if (frame.data[0] !== 3) {\n      //only support UTF-8\n      return undefined;\n    }\n\n    let index = 1;\n    let description = this.utf8ArrayToStr(frame.data.subarray(index));\n\n    index += description.length + 1;\n    let value = this.utf8ArrayToStr(frame.data.subarray(index));\n\n    return { key: 'TXXX', description, data: value };\n  }\n\n  decodeTextFrame(frame) {\n    /*\n    Format:\n    [0]   = {Text Encoding}\n    [1-?] = {Value}\n    */\n\n    if (frame.size < 2) {\n      return undefined;\n    }\n\n    if (frame.data[0] !== 3) {\n      //only support UTF-8\n      return undefined;\n    }\n\n    let data = frame.data.subarray(1);\n    return { key: frame.type, data: this.utf8ArrayToStr(data) };\n  }\n\n  decodePrivFrame(frame) {\n    /*\n    Format: <text string>\\0<binary data>\n    */\n\n    if (frame.size < 2) {\n      return undefined;\n    }\n\n    let owner = this.utf8ArrayToStr(frame.data);\n    let privateData = frame.data.subarray(owner.length + 1);\n\n    return { key: 'PRIV', info: owner, data: privateData.buffer };\n  }\n\n  // http://stackoverflow.com/questions/8936984/uint8array-to-string-in-javascript/22373197\n  // http://www.onicos.com/staff/iz/amuse/javascript/expert/utf.txt\n  /* utf.js - UTF-8 <=> UTF-16 convertion\n   *\n   * Copyright (C) 1999 Masanao Izumo <iz@onicos.co.jp>\n   * Version: 1.0\n   * LastModified: Dec 25 1999\n   * This library is free.  You can redistribute it and/or modify it.\n   */\n  utf8ArrayToStr(array) {\n\n    let char2;\n    let char3;\n    let out = '';\n    let i = 0;\n    let length = array.length;\n\n    while (i < length) {\n      let c = array[i++];\n      switch (c >> 4) {\n        case 0:\n          return out;\n        case 1: case 2: case 3: case 4: case 5: case 6: case 7:\n          // 0xxxxxxx\n          out += String.fromCharCode(c);\n          break;\n        case 12: case 13:\n          // 110x xxxx   10xx xxxx\n          char2 = array[i++];\n          out += String.fromCharCode(((c & 0x1F) << 6) | (char2 & 0x3F));\n          break;\n        case 14:\n          // 1110 xxxx  10xx xxxx  10xx xxxx\n          char2 = array[i++];\n          char3 = array[i++];\n          out += String.fromCharCode(((c & 0x0F) << 12) |\n            ((char2 & 0x3F) << 6) |\n            ((char3 & 0x3F) << 0));\n          break;\n      }\n    }\n\n    return out;\n  }\n}\n\nexport default ID3TrackController;\n\n\n\n// WEBPACK FOOTER //\n// src/controller/id3-track-controller.js","/*\n * Level Controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport {logger} from '../utils/logger';\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport BufferHelper from '../helper/buffer-helper';\n\nclass LevelController extends EventHandler {\n\n  constructor(hls) {\n    super(hls,\n      Event.MANIFEST_LOADED,\n      Event.LEVEL_LOADED,\n      Event.FRAG_LOADED,\n      Event.ERROR);\n    this.ontick = this.tick.bind(this);\n    this._manualLevel = -1;\n  }\n\n  destroy() {\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n    this._manualLevel = -1;\n  }\n\n  startLoad() {\n    this.canload = true;\n    let levels = this._levels;\n    // clean up live level details to force reload them, and reset load errors\n    if(levels) {\n      levels.forEach(level => {\n        level.loadError = 0;\n        const levelDetails = level.details;\n        if (levelDetails && levelDetails.live) {\n          level.details = undefined;\n        }\n      });\n    }\n    // speed up live playlist refresh if timer exists\n    if (this.timer) {\n      this.tick();\n    }\n  }\n\n  stopLoad() {\n    this.canload = false;\n  }\n\n  onManifestLoaded(data) {\n    var levels0 = [],\n        levels = [],\n        bitrateStart,\n        bitrateSet = {},\n        videoCodecFound = false,\n        audioCodecFound = false,\n        hls = this.hls,\n        brokenmp4inmp3 = /chrome|firefox/.test(navigator.userAgent.toLowerCase()),\n        checkSupported = function(type,codec) { return MediaSource.isTypeSupported(`${type}/mp4;codecs=${codec}`);};\n\n    // regroup redundant level together\n    data.levels.forEach(level => {\n      if(level.videoCodec) {\n        videoCodecFound = true;\n      }\n      // erase audio codec info if browser does not support mp4a.40.34. demuxer will autodetect codec and fallback to mpeg/audio\n      if(brokenmp4inmp3 && level.audioCodec && level.audioCodec.indexOf('mp4a.40.34') !== -1) {\n        level.audioCodec = undefined;\n      }\n      if(level.audioCodec || (level.attrs && level.attrs.AUDIO)) {\n        audioCodecFound = true;\n      }\n      let redundantLevelId = bitrateSet[level.bitrate];\n      if (redundantLevelId === undefined) {\n        bitrateSet[level.bitrate] = levels0.length;\n        level.url = [level.url];\n        level.urlId = 0;\n        levels0.push(level);\n      } else {\n        levels0[redundantLevelId].url.push(level.url);\n      }\n    });\n\n    // remove audio-only level if we also have levels with audio+video codecs signalled\n    if(videoCodecFound && audioCodecFound) {\n      levels0.forEach(level => {\n        if(level.videoCodec) {\n          levels.push(level);\n        }\n      });\n    } else {\n      levels = levels0;\n    }\n    // only keep level with supported audio/video codecs\n    levels = levels.filter(function(level) {\n    let audioCodec = level.audioCodec, videoCodec = level.videoCodec;\n      return (!audioCodec || checkSupported('audio',audioCodec)) &&\n             (!videoCodec || checkSupported('video',videoCodec));\n    });\n\n    if(levels.length) {\n      // start bitrate is the first bitrate of the manifest\n      bitrateStart = levels[0].bitrate;\n      // sort level on bitrate\n      levels.sort(function (a, b) {\n        return a.bitrate - b.bitrate;\n      });\n      this._levels = levels;\n      // find index of first level in sorted levels\n      for (let i = 0; i < levels.length; i++) {\n        if (levels[i].bitrate === bitrateStart) {\n          this._firstLevel = i;\n          logger.log(`manifest loaded,${levels.length} level(s) found, first bitrate:${bitrateStart}`);\n          break;\n        }\n      }\n      hls.trigger(Event.MANIFEST_PARSED, {levels: levels, firstLevel: this._firstLevel, stats: data.stats, audio : audioCodecFound, video : videoCodecFound, altAudio : data.audioTracks.length > 0});\n    } else {\n      hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR, fatal: true, url: hls.url, reason: 'no level with compatible codecs found in manifest'});\n    }\n    return;\n  }\n\n  get levels() {\n    return this._levels;\n  }\n\n  get level() {\n    return this._level;\n  }\n\n  set level(newLevel) {\n    let levels = this._levels;\n    if (levels && levels.length > newLevel) {\n      if (this._level !== newLevel || levels[newLevel].details === undefined) {\n        this.setLevelInternal(newLevel);\n      }\n    }\n  }\n\n setLevelInternal(newLevel) {\n    const levels = this._levels;\n    const hls = this.hls;\n    // check if level idx is valid\n    if (newLevel >= 0 && newLevel < levels.length) {\n      // stopping live reloading timer if any\n      if (this.timer) {\n       clearTimeout(this.timer);\n       this.timer = null;\n      }\n      if (this._level !== newLevel) {\n        logger.log(`switching to level ${newLevel}`);\n        this._level = newLevel;\n        var levelProperties = levels[newLevel];\n        levelProperties.level = newLevel;\n        // LEVEL_SWITCH to be deprecated in next major release\n        hls.trigger(Event.LEVEL_SWITCH, levelProperties);\n        hls.trigger(Event.LEVEL_SWITCHING, levelProperties);\n      }\n      var level = levels[newLevel], levelDetails = level.details;\n       // check if we need to load playlist for this level\n      if (!levelDetails || levelDetails.live === true) {\n        // level not retrieved yet, or live playlist we need to (re)load it\n        var urlId = level.urlId;\n        hls.trigger(Event.LEVEL_LOADING, {url: level.url[urlId], level: newLevel, id: urlId});\n      }\n    } else {\n      // invalid level id given, trigger error\n      hls.trigger(Event.ERROR, {type : ErrorTypes.OTHER_ERROR, details: ErrorDetails.LEVEL_SWITCH_ERROR, level: newLevel, fatal: false, reason: 'invalid level idx'});\n    }\n }\n\n  get manualLevel() {\n    return this._manualLevel;\n  }\n\n  set manualLevel(newLevel) {\n    this._manualLevel = newLevel;\n    if (this._startLevel === undefined) {\n      this._startLevel = newLevel;\n    }\n    if (newLevel !== -1) {\n      this.level = newLevel;\n    }\n  }\n\n  get firstLevel() {\n    return this._firstLevel;\n  }\n\n  set firstLevel(newLevel) {\n    this._firstLevel = newLevel;\n  }\n\n  get startLevel() {\n    // hls.startLevel takes precedence over config.startLevel\n    // if none of these values are defined, fallback on this._firstLevel (first quality level appearing in variant manifest)\n    if (this._startLevel === undefined) {\n      let configStartLevel = this.hls.config.startLevel;\n      if (configStartLevel !== undefined) {\n        return configStartLevel;\n      } else {\n        return this._firstLevel;\n      }\n    } else {\n      return this._startLevel;\n    }\n  }\n\n  set startLevel(newLevel) {\n    this._startLevel = newLevel;\n  }\n\n  onError(data) {\n    if(data.fatal) {\n      return;\n    }\n\n    let details = data.details, hls = this.hls, levelId, level, levelError = false;\n    // try to recover not fatal errors\n    switch(details) {\n      case ErrorDetails.FRAG_LOAD_ERROR:\n      case ErrorDetails.FRAG_LOAD_TIMEOUT:\n      case ErrorDetails.FRAG_LOOP_LOADING_ERROR:\n      case ErrorDetails.KEY_LOAD_ERROR:\n      case ErrorDetails.KEY_LOAD_TIMEOUT:\n         levelId = data.frag.level;\n         break;\n      case ErrorDetails.LEVEL_LOAD_ERROR:\n      case ErrorDetails.LEVEL_LOAD_TIMEOUT:\n        levelId = data.context.level;\n        levelError = true;\n        break;\n      case ErrorDetails.REMUX_ALLOC_ERROR:\n        levelId = data.level;\n        break;\n      default:\n        break;\n    }\n    /* try to switch to a redundant stream if any available.\n     * if no redundant stream available, emergency switch down (if in auto mode and current level not 0)\n     * otherwise, we cannot recover this network error ...\n     */\n    if (levelId !== undefined) {\n      level = this._levels[levelId];\n      if(!level.loadError) {\n        level.loadError = 1;\n      } else {\n        level.loadError++;\n      }\n      // if any redundant streams available and if we haven't try them all (level.loadError is reseted on successful frag/level load.\n      // if level.loadError reaches nbRedundantLevel it means that we tried them all, no hope  => let's switch down\n      const nbRedundantLevel = level.url.length;\n     if (nbRedundantLevel > 1 && level.loadError < nbRedundantLevel) {\n        level.urlId = (level.urlId + 1) % nbRedundantLevel;\n        level.details = undefined;\n        logger.warn(`level controller,${details} for level ${levelId}: switching to redundant stream id ${level.urlId}`);\n      } else {\n        // we could try to recover if in auto mode and current level not lowest level (0)\n        let recoverable = ((this._manualLevel === -1) && levelId);\n        if (recoverable) {\n          logger.warn(`level controller,${details}: switch-down for next fragment`);\n          hls.nextAutoLevel = Math.max(0,levelId-1);\n        } else if(level && level.details && level.details.live) {\n          logger.warn(`level controller,${details} on live stream, discard`);\n          if (levelError) {\n            // reset this._level so that another call to set level() will retrigger a frag load\n            this._level = undefined;\n          }\n          // other errors are handled by stream controller\n        } else if (details === ErrorDetails.LEVEL_LOAD_ERROR ||\n                   details === ErrorDetails.LEVEL_LOAD_TIMEOUT) {\n          let media = hls.media,\n            // 0.5 : tolerance needed as some browsers stalls playback before reaching buffered end\n              mediaBuffered = media && BufferHelper.isBuffered(media,media.currentTime) && BufferHelper.isBuffered(media,media.currentTime+0.5);\n          if (mediaBuffered) {\n            let retryDelay = hls.config.levelLoadingRetryDelay;\n            logger.warn(`level controller,${details}, but media buffered, retry in ${retryDelay}ms`);\n            this.timer = setTimeout(this.ontick,retryDelay);\n            // boolean used to inform stream controller not to switch back to IDLE on non fatal error\n            data.levelRetry = true;\n          } else {\n            logger.error(`cannot recover ${details} error`);\n            this._level = undefined;\n            // stopping live reloading timer if any\n            if (this.timer) {\n              clearTimeout(this.timer);\n              this.timer = null;\n            }\n            // switch error to fatal\n            data.fatal = true;\n          }\n        }\n      }\n    }\n  }\n\n  // reset level load error counter on successful frag loaded\n  onFragLoaded(data) {\n    const fragLoaded = data.frag;\n    if (fragLoaded && fragLoaded.type === 'main') {\n      const level = this._levels[fragLoaded.level];\n      if (level) {\n        level.loadError = 0;\n      }\n    }\n  }\n\n  onLevelLoaded(data) {\n    const levelId = data.level;\n     // only process level loaded events matching with expected level\n    if (levelId === this._level) {\n      let curLevel = this._levels[levelId];\n      // reset level load error counter on successful level loaded\n      curLevel.loadError = 0;\n      let newDetails = data.details;\n      // if current playlist is a live playlist, arm a timer to reload it\n      if (newDetails.live) {\n        let reloadInterval = 1000*( newDetails.averagetargetduration ? newDetails.averagetargetduration : newDetails.targetduration),\n            curDetails = curLevel.details;\n        if (curDetails && newDetails.endSN === curDetails.endSN) {\n          // follow HLS Spec, If the client reloads a Playlist file and finds that it has not\n          // changed then it MUST wait for a period of one-half the target\n          // duration before retrying.\n          reloadInterval /=2;\n          logger.log(`same live playlist, reload twice faster`);\n        }\n        // decrement reloadInterval with level loading delay\n        reloadInterval -= performance.now() - data.stats.trequest;\n        // in any case, don't reload more than every second\n        reloadInterval = Math.max(1000,Math.round(reloadInterval));\n        logger.log(`live playlist, reload in ${reloadInterval} ms`);\n        this.timer = setTimeout(this.ontick,reloadInterval);\n      } else {\n        this.timer = null;\n      }\n    }\n  }\n\n  tick() {\n    var levelId = this._level;\n    if (levelId !== undefined && this.canload) {\n      var level = this._levels[levelId];\n      if (level && level.url) {\n        var urlId = level.urlId;\n        this.hls.trigger(Event.LEVEL_LOADING, {url: level.url[urlId], level: levelId, id: urlId});\n      }\n    }\n  }\n\n  get nextLoadLevel() {\n    if (this._manualLevel !== -1) {\n      return this._manualLevel;\n    } else {\n     return this.hls.nextAutoLevel;\n    }\n  }\n\n  set nextLoadLevel(nextLevel) {\n    this.level = nextLevel;\n    if (this._manualLevel === -1) {\n      this.hls.nextAutoLevel = nextLevel;\n    }\n  }\n}\n\nexport default LevelController;\n\n\n\n\n// WEBPACK FOOTER //\n// src/controller/level-controller.js","/*\n * Stream Controller\n*/\n\nimport BinarySearch from '../utils/binary-search';\nimport BufferHelper from '../helper/buffer-helper';\nimport Demuxer from '../demux/demuxer';\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport LevelHelper from '../helper/level-helper';\nimport TimeRanges from '../utils/timeRanges';\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport {logger} from '../utils/logger';\n\nconst State = {\n  STOPPED : 'STOPPED',\n  IDLE : 'IDLE',\n  KEY_LOADING : 'KEY_LOADING',\n  FRAG_LOADING : 'FRAG_LOADING',\n  FRAG_LOADING_WAITING_RETRY : 'FRAG_LOADING_WAITING_RETRY',\n  WAITING_LEVEL : 'WAITING_LEVEL',\n  PARSING : 'PARSING',\n  PARSED : 'PARSED',\n  BUFFER_FLUSHING : 'BUFFER_FLUSHING',\n  ENDED : 'ENDED',\n  ERROR : 'ERROR'\n};\n\nclass StreamController extends EventHandler {\n\n  constructor(hls) {\n    super(hls,\n      Event.MEDIA_ATTACHED,\n      Event.MEDIA_DETACHING,\n      Event.MANIFEST_LOADING,\n      Event.MANIFEST_PARSED,\n      Event.LEVEL_LOADED,\n      Event.KEY_LOADED,\n      Event.FRAG_LOADED,\n      Event.FRAG_LOAD_EMERGENCY_ABORTED,\n      Event.FRAG_PARSING_INIT_SEGMENT,\n      Event.FRAG_PARSING_DATA,\n      Event.FRAG_PARSED,\n      Event.ERROR,\n      Event.AUDIO_TRACK_SWITCHING,\n      Event.AUDIO_TRACK_SWITCHED,\n      Event.BUFFER_CREATED,\n      Event.BUFFER_APPENDED,\n      Event.BUFFER_FLUSHED);\n\n    this.config = hls.config;\n    this.audioCodecSwap = false;\n    this.ticks = 0;\n    this._state = State.STOPPED;\n    this.ontick = this.tick.bind(this);\n  }\n\n  destroy() {\n    this.stopLoad();\n    if (this.timer) {\n      clearInterval(this.timer);\n      this.timer = null;\n    }\n    EventHandler.prototype.destroy.call(this);\n    this.state = State.STOPPED;\n  }\n\n  startLoad(startPosition) {\n    if (this.levels) {\n      let lastCurrentTime = this.lastCurrentTime, hls = this.hls;\n      this.stopLoad();\n      if (!this.timer) {\n        this.timer = setInterval(this.ontick, 100);\n      }\n      this.level = -1;\n      this.fragLoadError = 0;\n      if (!this.startFragRequested) {\n        // determine load level\n        let startLevel = hls.startLevel;\n        if (startLevel === -1) {\n          // -1 : guess start Level by doing a bitrate test by loading first fragment of lowest quality level\n          startLevel = 0;\n          this.bitrateTest = true;\n        }\n        // set new level to playlist loader : this will trigger start level load\n        // hls.nextLoadLevel remains until it is set to a new value or until a new frag is successfully loaded\n        this.level = hls.nextLoadLevel = startLevel;\n        this.loadedmetadata = false;\n      }\n      // if startPosition undefined but lastCurrentTime set, set startPosition to last currentTime\n      if (lastCurrentTime > 0 && startPosition === -1) {\n        logger.log(`override startPosition with lastCurrentTime @${lastCurrentTime.toFixed(3)}`);\n        startPosition = lastCurrentTime;\n      }\n      this.state = State.IDLE;\n      this.nextLoadPosition = this.startPosition = this.lastCurrentTime = startPosition;\n      this.tick();\n    } else {\n      this.forceStartLoad = true;\n      this.state = State.STOPPED;\n    }\n  }\n\n  stopLoad() {\n    var frag = this.fragCurrent;\n    if (frag) {\n      if (frag.loader) {\n        frag.loader.abort();\n      }\n      this.fragCurrent = null;\n    }\n    this.fragPrevious = null;\n    if (this.demuxer) {\n      this.demuxer.destroy();\n      this.demuxer = null;\n    }\n    this.state = State.STOPPED;\n    this.forceStartLoad = false;\n  }\n\n  tick() {\n    this.ticks++;\n    if (this.ticks === 1) {\n      this.doTick();\n      if (this.ticks > 1) {\n        setTimeout(this.tick, 1);\n      }\n      this.ticks = 0;\n    }\n  }\n\n  doTick() {\n    switch(this.state) {\n      case State.ERROR:\n        //don't do anything in error state to avoid breaking further ...\n        break;\n      case State.BUFFER_FLUSHING:\n      // in buffer flushing state, reset fragLoadError counter\n        this.fragLoadError = 0;\n        break;\n      case State.IDLE:\n        this._doTickIdle();\n        break;\n      case State.WAITING_LEVEL:\n        var level = this.levels[this.level];\n        // check if playlist is already loaded\n        if (level && level.details) {\n          this.state = State.IDLE;\n        }\n        break;\n      case State.FRAG_LOADING_WAITING_RETRY:\n        var now = performance.now();\n        var retryDate = this.retryDate;\n        // if current time is gt than retryDate, or if media seeking let's switch to IDLE state to retry loading\n        if(!retryDate || (now >= retryDate) || (this.media && this.media.seeking)) {\n          logger.log(`mediaController: retryDate reached, switch back to IDLE state`);\n          this.state = State.IDLE;\n        }\n        break;\n      case State.ERROR:\n      case State.STOPPED:\n      case State.FRAG_LOADING:\n      case State.PARSING:\n      case State.PARSED:\n      case State.ENDED:\n        break;\n      default:\n        break;\n    }\n    // check buffer\n    this._checkBuffer();\n    // check/update current fragment\n    this._checkFragmentChanged();\n  }\n\n  // Ironically the \"idle\" state is the on we do the most logic in it seems ....\n  // NOTE: Maybe we could rather schedule a check for buffer length after half of the currently\n  //       played segment, or on pause/play/seek instead of naively checking every 100ms?\n  _doTickIdle() {\n    const hls = this.hls,\n          config = hls.config,\n          media = this.media;\n\n    // if video not attached AND\n    // start fragment already requested OR start frag prefetch disable\n    // exit loop\n    // => if start level loaded and media not attached but start frag prefetch is enabled and start frag not requested yet, we will not exit loop\n    if (this.levelLastLoaded !== undefined && !media &&\n      (this.startFragRequested || !config.startFragPrefetch)) {\n      return;\n    }\n\n    // if we have not yet loaded any fragment, start loading from start position\n    let pos;\n    if (this.loadedmetadata) {\n      pos = media.currentTime;\n    } else {\n      pos = this.nextLoadPosition;\n    }\n    // determine next load level\n    let level = hls.nextLoadLevel,\n        levelInfo = this.levels[level];\n\n    if (!levelInfo) {\n      return;\n    }\n\n    let levelBitrate = levelInfo.bitrate,\n        maxBufLen;\n\n    // compute max Buffer Length that we could get from this load level, based on level bitrate. don't buffer more than 60 MB and more than 30s\n    if (levelBitrate) {\n      maxBufLen = Math.max(8 * config.maxBufferSize / levelBitrate, config.maxBufferLength);\n    } else {\n      maxBufLen = config.maxBufferLength;\n    }\n    maxBufLen = Math.min(maxBufLen, config.maxMaxBufferLength);\n\n    // determine next candidate fragment to be loaded, based on current position and end of buffer position\n    // ensure up to `config.maxMaxBufferLength` of buffer upfront\n\n    const bufferInfo = BufferHelper.bufferInfo(this.mediaBuffer ? this.mediaBuffer : media, pos, config.maxBufferHole),\n          bufferLen = bufferInfo.len;\n    // Stay idle if we are still with buffer margins\n    if (bufferLen >= maxBufLen) {\n      return;\n    }\n\n    // if buffer length is less than maxBufLen try to load a new fragment ...\n    logger.trace(`buffer length of ${bufferLen.toFixed(3)} is below max of ${maxBufLen.toFixed(3)}. checking for more payload ...`);\n\n    // set next load level : this will trigger a playlist load if needed\n    this.level = hls.nextLoadLevel = level;\n\n    const levelDetails = levelInfo.details;\n    // if level info not retrieved yet, switch state and wait for level retrieval\n    // if live playlist, ensure that new playlist has been refreshed to avoid loading/try to load\n    // a useless and outdated fragment (that might even introduce load error if it is already out of the live playlist)\n    if (typeof levelDetails === 'undefined' || levelDetails.live && this.levelLastLoaded !== level) {\n      this.state = State.WAITING_LEVEL;\n      return;\n    }\n\n    // we just got done loading the final fragment, check if we need to finalize media stream\n    let fragPrevious = this.fragPrevious;\n    if (!levelDetails.live && fragPrevious && fragPrevious.sn === levelDetails.endSN) {\n        // fragPrevious is last fragment. retrieve level duration using last frag start offset + duration\n        // real duration might be lower than initial duration if there are drifts between real frag duration and playlist signaling\n        const duration = Math.min(media.duration,fragPrevious.start + fragPrevious.duration);\n        // if everything (almost) til the end is buffered, let's signal eos\n        // we don't compare exactly media.duration === bufferInfo.end as there could be some subtle media duration difference (audio/video offsets...)\n        // tolerate up to one frag duration to cope with these cases.\n        // also cope with almost zero last frag duration (max last frag duration with 200ms) refer to https://github.com/video-dev/hls.js/pull/657\n        if (duration - Math.max(bufferInfo.end,fragPrevious.start) <= Math.max(0.2,fragPrevious.duration)) {\n        // Finalize the media stream\n        let data = {};\n        if (this.altAudio) {\n          data.type = 'video';\n        }\n        this.hls.trigger(Event.BUFFER_EOS,data);\n        this.state = State.ENDED;\n        return;\n      }\n    }\n\n    // if we have the levelDetails for the selected variant, lets continue enrichen our stream (load keys/fragments or trigger EOS, etc..)\n    this._fetchPayloadOrEos(pos, bufferInfo, levelDetails);\n  }\n\n  _fetchPayloadOrEos(pos, bufferInfo, levelDetails) {\n    const fragPrevious = this.fragPrevious,\n          level = this.level,\n          fragments = levelDetails.fragments,\n          fragLen = fragments.length;\n\n    // empty playlist\n    if (fragLen === 0) {\n      return;\n    }\n\n    // find fragment index, contiguous with end of buffer position\n    let start = fragments[0].start,\n        end = fragments[fragLen-1].start + fragments[fragLen-1].duration,\n        bufferEnd = bufferInfo.end,\n        frag;\n\n    if (levelDetails.initSegment && !levelDetails.initSegment.data) {\n      frag = levelDetails.initSegment;\n    } else {\n      // in case of live playlist we need to ensure that requested position is not located before playlist start\n      if (levelDetails.live) {\n        let initialLiveManifestSize = this.config.initialLiveManifestSize;\n        if(fragLen < initialLiveManifestSize){\n          logger.warn(`Can not start playback of a level, reason: not enough fragments ${fragLen} < ${initialLiveManifestSize}`);\n          return;\n        }\n\n        frag = this._ensureFragmentAtLivePoint(levelDetails, bufferEnd, start, end, fragPrevious, fragments, fragLen);\n        // if it explicitely returns null don't load any fragment and exit function now\n        if (frag === null) {\n          return;\n        }\n\n      } else {\n        // VoD playlist: if bufferEnd before start of playlist, load first fragment\n        if (bufferEnd < start) {\n          frag = fragments[0];\n        }\n      }\n    }\n    if (!frag) {\n      frag = this._findFragment(start, fragPrevious, fragLen, fragments, bufferEnd, end, levelDetails);\n    }\n    if(frag) {\n      this._loadFragmentOrKey(frag, level, levelDetails, pos, bufferEnd);\n    }\n    return;\n  }\n\n  _ensureFragmentAtLivePoint(levelDetails, bufferEnd, start, end, fragPrevious, fragments, fragLen) {\n    const config = this.hls.config, media = this.media;\n\n    let frag;\n\n    // check if requested position is within seekable boundaries :\n    //logger.log(`start/pos/bufEnd/seeking:${start.toFixed(3)}/${pos.toFixed(3)}/${bufferEnd.toFixed(3)}/${this.media.seeking}`);\n    let maxLatency = config.liveMaxLatencyDuration !== undefined ? config.liveMaxLatencyDuration : config.liveMaxLatencyDurationCount*levelDetails.targetduration;\n\n    if (bufferEnd < Math.max(start-config.maxFragLookUpTolerance, end - maxLatency)) {\n        let liveSyncPosition = this.liveSyncPosition = this.computeLivePosition(start, levelDetails);\n        logger.log(`buffer end: ${bufferEnd.toFixed(3)} is located too far from the end of live sliding playlist, reset currentTime to : ${liveSyncPosition.toFixed(3)}`);\n        bufferEnd = liveSyncPosition;\n        if (media && media.readyState && media.duration > liveSyncPosition) {\n          media.currentTime = liveSyncPosition;\n        }\n    }\n\n    // if end of buffer greater than live edge, don't load any fragment\n    // this could happen if live playlist intermittently slides in the past.\n    // level 1 loaded [182580161,182580167]\n    // level 1 loaded [182580162,182580169]\n    // Loading 182580168 of [182580162 ,182580169],level 1 ..\n    // Loading 182580169 of [182580162 ,182580169],level 1 ..\n    // level 1 loaded [182580162,182580168] <============= here we should have bufferEnd > end. in that case break to avoid reloading 182580168\n    // level 1 loaded [182580164,182580171]\n    //\n    // don't return null in case media not loaded yet (readystate === 0)\n    if (levelDetails.PTSKnown && bufferEnd > end && media && media.readyState) {\n      return null;\n    }\n\n    if (this.startFragRequested && !levelDetails.PTSKnown) {\n      /* we are switching level on live playlist, but we don't have any PTS info for that quality level ...\n         try to load frag matching with next SN.\n         even if SN are not synchronized between playlists, loading this frag will help us\n         compute playlist sliding and find the right one after in case it was not the right consecutive one */\n      if (fragPrevious) {\n        var targetSN = fragPrevious.sn + 1;\n        if (targetSN >= levelDetails.startSN && targetSN <= levelDetails.endSN) {\n          frag = fragments[targetSN - levelDetails.startSN];\n          logger.log(`live playlist, switching playlist, load frag with next SN: ${frag.sn}`);\n        }\n      }\n      if (!frag) {\n        /* we have no idea about which fragment should be loaded.\n           so let's load mid fragment. it will help computing playlist sliding and find the right one\n        */\n        frag = fragments[Math.min(fragLen - 1, Math.round(fragLen / 2))];\n        logger.log(`live playlist, switching playlist, unknown, load middle frag : ${frag.sn}`);\n      }\n    }\n    return frag;\n  }\n\n  _findFragment(start, fragPrevious, fragLen, fragments, bufferEnd, end, levelDetails) {\n    const config = this.hls.config;\n    let frag;\n    let foundFrag;\n    let maxFragLookUpTolerance = config.maxFragLookUpTolerance;\n    const fragNext = fragPrevious ? fragments[fragPrevious.sn - fragments[0].sn + 1] : undefined;\n    let fragmentWithinToleranceTest = (candidate) => {\n      // offset should be within fragment boundary - config.maxFragLookUpTolerance\n      // this is to cope with situations like\n      // bufferEnd = 9.991\n      // frag[Ø] : [0,10]\n      // frag[1] : [10,20]\n      // bufferEnd is within frag[0] range ... although what we are expecting is to return frag[1] here\n      //              frag start               frag start+duration\n      //                  |-----------------------------|\n      //              <--->                         <--->\n      //  ...--------><-----------------------------><---------....\n      // previous frag         matching fragment         next frag\n      //  return -1             return 0                 return 1\n      //logger.log(`level/sn/start/end/bufEnd:${level}/${candidate.sn}/${candidate.start}/${(candidate.start+candidate.duration)}/${bufferEnd}`);\n      // Set the lookup tolerance to be small enough to detect the current segment - ensures we don't skip over very small segments\n      let candidateLookupTolerance = Math.min(maxFragLookUpTolerance, candidate.duration);\n      if (candidate.start + candidate.duration - candidateLookupTolerance <= bufferEnd) {\n        return 1;\n      } // if maxFragLookUpTolerance will have negative value then don't return -1 for first element\n      else if (candidate.start - candidateLookupTolerance > bufferEnd && candidate.start) {\n        return -1;\n      }\n      return 0;\n    };\n\n    if (bufferEnd < end) {\n      if (bufferEnd > end - maxFragLookUpTolerance) {\n        maxFragLookUpTolerance = 0;\n      }\n      // Prefer the next fragment if it's within tolerance\n      if (fragNext && !fragmentWithinToleranceTest(fragNext)) {\n        foundFrag = fragNext;\n      } else {\n        foundFrag = BinarySearch.search(fragments, fragmentWithinToleranceTest);\n      }\n    } else {\n      // reach end of playlist\n      foundFrag = fragments[fragLen-1];\n    }\n    if (foundFrag) {\n      frag = foundFrag;\n      const curSNIdx = frag.sn - levelDetails.startSN;\n      const sameLevel = fragPrevious && frag.level === fragPrevious.level;\n      const prevFrag = fragments[curSNIdx - 1];\n      const nextFrag = fragments[curSNIdx + 1];\n      //logger.log('find SN matching with pos:' +  bufferEnd + ':' + frag.sn);\n      if (fragPrevious && frag.sn === fragPrevious.sn) {\n        if (sameLevel && !frag.backtracked) {\n          if (frag.sn < levelDetails.endSN) {\n            let deltaPTS = fragPrevious.deltaPTS;\n            // if there is a significant delta between audio and video, larger than max allowed hole,\n            // and if previous remuxed fragment did not start with a keyframe. (fragPrevious.dropped)\n            // let's try to load previous fragment again to get last keyframe\n            // then we will reload again current fragment (that way we should be able to fill the buffer hole ...)\n            if (deltaPTS && deltaPTS > config.maxBufferHole && fragPrevious.dropped && curSNIdx) {\n              frag = prevFrag;\n              logger.warn(`SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this`);\n              // decrement previous frag load counter to avoid frag loop loading error when next fragment will get reloaded\n              fragPrevious.loadCounter--;\n            } else {\n              frag = nextFrag;\n              logger.log(`SN just loaded, load next one: ${frag.sn}`);\n            }\n          } else {\n            frag = null;\n          }\n        } else if (frag.backtracked) {\n          // Only backtrack a max of 1 consecutive fragment to prevent sliding back too far when little or no frags start with keyframes\n          if (nextFrag && nextFrag.backtracked) {\n            logger.warn(`Already backtracked from fragment ${nextFrag.sn}, will not backtrack to fragment ${frag.sn}. Loading fragment ${nextFrag.sn}`);\n            frag = nextFrag;\n          } else {\n            // If a fragment has dropped frames and it's in a same level/sequence, load the previous fragment to try and find the keyframe\n            // Reset the dropped count now since it won't be reset until we parse the fragment again, which prevents infinite backtracking on the same segment\n            logger.warn('Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe');\n            frag.dropped = 0;\n            if (prevFrag) {\n              if (prevFrag.loadCounter) {\n                prevFrag.loadCounter--;\n              }\n              frag = prevFrag;\n              frag.backtracked = true;\n            } else {\n              frag = null;\n            }\n          }\n        }\n      }\n    }\n    return frag;\n  }\n\n  _loadFragmentOrKey(frag, level, levelDetails, pos, bufferEnd) {\n    const hls = this.hls,\n          config = hls.config;\n\n    //logger.log('loading frag ' + i +',pos/bufEnd:' + pos.toFixed(3) + '/' + bufferEnd.toFixed(3));\n    if ((frag.decryptdata && frag.decryptdata.uri != null) && (frag.decryptdata.key == null)) {\n      logger.log(`Loading key for ${frag.sn} of [${levelDetails.startSN} ,${levelDetails.endSN}],level ${level}`);\n      this.state = State.KEY_LOADING;\n      hls.trigger(Event.KEY_LOADING, {frag: frag});\n    } else {\n      logger.log(`Loading ${frag.sn} of [${levelDetails.startSN} ,${levelDetails.endSN}],level ${level}, currentTime:${pos.toFixed(3)},bufferEnd:${bufferEnd.toFixed(3)}`);\n      // ensure that we are not reloading the same fragments in loop ...\n      if (this.fragLoadIdx !== undefined) {\n        this.fragLoadIdx++;\n      } else {\n        this.fragLoadIdx = 0;\n      }\n      if (frag.loadCounter) {\n        frag.loadCounter++;\n        let maxThreshold = config.fragLoadingLoopThreshold;\n        // if this frag has already been loaded 3 times, and if it has been reloaded recently\n        if (frag.loadCounter > maxThreshold && (Math.abs(this.fragLoadIdx - frag.loadIdx) < maxThreshold)) {\n          hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_LOOP_LOADING_ERROR, fatal: false, frag: frag});\n          return;\n        }\n      } else {\n        frag.loadCounter = 1;\n      }\n      frag.loadIdx = this.fragLoadIdx;\n      this.fragCurrent = frag;\n      this.startFragRequested = true;\n      if (!isNaN(frag.sn)) {\n        this.nextLoadPosition = frag.start + frag.duration;\n      }\n      frag.autoLevel = hls.autoLevelEnabled;\n      frag.bitrateTest = this.bitrateTest;\n      hls.trigger(Event.FRAG_LOADING, {frag: frag});\n      // lazy demuxer init, as this could take some time ... do it during frag loading\n      if (!this.demuxer) {\n        this.demuxer = new Demuxer(hls,'main');\n      }\n      this.state = State.FRAG_LOADING;\n      return;\n    }\n  }\n\n  set state(nextState) {\n    if (this.state !== nextState) {\n      const previousState = this.state;\n      this._state = nextState;\n      logger.log(`main stream:${previousState}->${nextState}`);\n      this.hls.trigger(Event.STREAM_STATE_TRANSITION, {previousState, nextState});\n    }\n  }\n\n  get state() {\n    return this._state;\n  }\n\n  getBufferedFrag(position) {\n    return BinarySearch.search(this._bufferedFrags, function(frag) {\n      if (position < frag.startPTS) {\n        return -1;\n      } else if (position > frag.endPTS) {\n        return 1;\n      }\n      return 0;\n    });\n  }\n\n  get currentLevel() {\n    let media = this.media;\n    if (media) {\n      const frag = this.getBufferedFrag(media.currentTime);\n      if (frag) {\n        return frag.level;\n      }\n    }\n    return -1;\n  }\n\n  get nextBufferedFrag() {\n    let media = this.media;\n    if (media) {\n      // first get end range of current fragment\n      return this.followingBufferedFrag(this.getBufferedFrag(media.currentTime));\n    } else {\n      return null;\n    }\n  }\n\n  followingBufferedFrag(frag) {\n    if (frag) {\n      // try to get range of next fragment (500ms after this range)\n      return this.getBufferedFrag(frag.endPTS + 0.5);\n    }\n    return null;\n  }\n\n  get nextLevel() {\n    const frag = this.nextBufferedFrag;\n    if (frag) {\n      return frag.level;\n    } else {\n      return -1;\n    }\n  }\n\n  _checkFragmentChanged() {\n    var fragPlayingCurrent, currentTime, video = this.media;\n    if (video && video.readyState && video.seeking === false) {\n      currentTime = video.currentTime;\n      /* if video element is in seeked state, currentTime can only increase.\n        (assuming that playback rate is positive ...)\n        As sometimes currentTime jumps back to zero after a\n        media decode error, check this, to avoid seeking back to\n        wrong position after a media decode error\n      */\n      if(currentTime > video.playbackRate*this.lastCurrentTime) {\n        this.lastCurrentTime = currentTime;\n      }\n      if (BufferHelper.isBuffered(video,currentTime)) {\n        fragPlayingCurrent = this.getBufferedFrag(currentTime);\n      } else if (BufferHelper.isBuffered(video,currentTime + 0.1)) {\n        /* ensure that FRAG_CHANGED event is triggered at startup,\n          when first video frame is displayed and playback is paused.\n          add a tolerance of 100ms, in case current position is not buffered,\n          check if current pos+100ms is buffered and use that buffer range\n          for FRAG_CHANGED event reporting */\n        fragPlayingCurrent = this.getBufferedFrag(currentTime + 0.1);\n      }\n      if (fragPlayingCurrent) {\n        var fragPlaying = fragPlayingCurrent;\n        if (fragPlaying !== this.fragPlaying) {\n          this.hls.trigger(Event.FRAG_CHANGED, {frag: fragPlaying});\n          const fragPlayingLevel = fragPlaying.level;\n          if (!this.fragPlaying || this.fragPlaying.level !== fragPlayingLevel) {\n            this.hls.trigger(Event.LEVEL_SWITCHED, {level: fragPlayingLevel});\n          }\n          this.fragPlaying = fragPlaying;\n        }\n      }\n    }\n  }\n\n  /*\n    on immediate level switch :\n     - pause playback if playing\n     - cancel any pending load request\n     - and trigger a buffer flush\n  */\n  immediateLevelSwitch() {\n    logger.log('immediateLevelSwitch');\n    if (!this.immediateSwitch) {\n      this.immediateSwitch = true;\n      let media = this.media, previouslyPaused;\n      if (media) {\n        previouslyPaused = media.paused;\n        media.pause();\n      } else {\n        // don't restart playback after instant level switch in case media not attached\n        previouslyPaused = true;\n      }\n      this.previouslyPaused = previouslyPaused;\n    }\n    var fragCurrent = this.fragCurrent;\n    if (fragCurrent && fragCurrent.loader) {\n      fragCurrent.loader.abort();\n    }\n    this.fragCurrent = null;\n    // increase fragment load Index to avoid frag loop loading error after buffer flush\n    this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n    // flush everything\n    this.flushMainBuffer(0,Number.POSITIVE_INFINITY);\n  }\n\n  /*\n     on immediate level switch end, after new fragment has been buffered :\n      - nudge video decoder by slightly adjusting video currentTime (if currentTime buffered)\n      - resume the playback if needed\n  */\n  immediateLevelSwitchEnd() {\n    let media = this.media;\n    if (media && media.buffered.length) {\n      this.immediateSwitch = false;\n      if(BufferHelper.isBuffered(media,media.currentTime)) {\n        // only nudge if currentTime is buffered\n        media.currentTime -= 0.0001;\n      }\n      if (!this.previouslyPaused) {\n        media.play();\n      }\n    }\n  }\n\n  nextLevelSwitch() {\n    /* try to switch ASAP without breaking video playback :\n       in order to ensure smooth but quick level switching,\n      we need to find the next flushable buffer range\n      we should take into account new segment fetch time\n    */\n    let media = this.media;\n    // ensure that media is defined and that metadata are available (to retrieve currentTime)\n    if (media && media.readyState) {\n      let fetchdelay, fragPlayingCurrent, nextBufferedFrag;\n      // increase fragment load Index to avoid frag loop loading error after buffer flush\n      this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n      fragPlayingCurrent = this.getBufferedFrag(media.currentTime);\n      if (fragPlayingCurrent && fragPlayingCurrent.startPTS > 1) {\n        // flush buffer preceding current fragment (flush until current fragment start offset)\n        // minus 1s to avoid video freezing, that could happen if we flush keyframe of current video ...\n        this.flushMainBuffer(0,fragPlayingCurrent.startPTS - 1);\n      }\n      if (!media.paused) {\n        // add a safety delay of 1s\n        var nextLevelId = this.hls.nextLoadLevel,nextLevel = this.levels[nextLevelId], fragLastKbps = this.fragLastKbps;\n        if (fragLastKbps && this.fragCurrent) {\n          fetchdelay = this.fragCurrent.duration * nextLevel.bitrate / (1000 * fragLastKbps) + 1;\n        } else {\n          fetchdelay = 0;\n        }\n      } else {\n        fetchdelay = 0;\n      }\n      //logger.log('fetchdelay:'+fetchdelay);\n      // find buffer range that will be reached once new fragment will be fetched\n      nextBufferedFrag = this.getBufferedFrag(media.currentTime + fetchdelay);\n      if (nextBufferedFrag) {\n        // we can flush buffer range following this one without stalling playback\n        nextBufferedFrag = this.followingBufferedFrag(nextBufferedFrag);\n        if (nextBufferedFrag) {\n          // if we are here, we can also cancel any loading/demuxing in progress, as they are useless\n          var fragCurrent = this.fragCurrent;\n          if (fragCurrent && fragCurrent.loader) {\n            fragCurrent.loader.abort();\n          }\n          this.fragCurrent = null;\n          // flush position is the start position of this new buffer\n          this.flushMainBuffer(nextBufferedFrag.startPTS , Number.POSITIVE_INFINITY);\n        }\n      }\n    }\n  }\n\n  flushMainBuffer(startOffset,endOffset) {\n    this.state = State.BUFFER_FLUSHING;\n    let flushScope = {startOffset: startOffset, endOffset: endOffset};\n    // if alternate audio tracks are used, only flush video, otherwise flush everything\n    if (this.altAudio) {\n      flushScope.type = 'video';\n    }\n    this.hls.trigger(Event.BUFFER_FLUSHING, flushScope);\n  }\n\n  onMediaAttached(data) {\n    var media = this.media = this.mediaBuffer = data.media;\n    this.onvseeking = this.onMediaSeeking.bind(this);\n    this.onvseeked = this.onMediaSeeked.bind(this);\n    this.onvended = this.onMediaEnded.bind(this);\n    media.addEventListener('seeking', this.onvseeking);\n    media.addEventListener('seeked', this.onvseeked);\n    media.addEventListener('ended', this.onvended);\n    let config = this.config;\n    if(this.levels && config.autoStartLoad) {\n      this.hls.startLoad(config.startPosition);\n    }\n  }\n\n  onMediaDetaching() {\n    var media = this.media;\n    if (media && media.ended) {\n      logger.log('MSE detaching and video ended, reset startPosition');\n      this.startPosition = this.lastCurrentTime = 0;\n    }\n\n    // reset fragment loading counter on MSE detaching to avoid reporting FRAG_LOOP_LOADING_ERROR after error recovery\n    var levels = this.levels;\n    if (levels) {\n      // reset fragment load counter\n        levels.forEach(level => {\n          if(level.details) {\n            level.details.fragments.forEach(fragment => {\n              fragment.loadCounter = undefined;\n              fragment.backtracked = undefined;\n            });\n          }\n      });\n    }\n    // remove video listeners\n    if (media) {\n      media.removeEventListener('seeking', this.onvseeking);\n      media.removeEventListener('seeked', this.onvseeked);\n      media.removeEventListener('ended', this.onvended);\n      this.onvseeking = this.onvseeked  = this.onvended = null;\n    }\n    this.media = this.mediaBuffer = null;\n    this.loadedmetadata = false;\n    this.stopLoad();\n  }\n\n  onMediaSeeking() {\n    let media = this.media, currentTime = media ? media.currentTime : undefined, config = this.config;\n    if (!isNaN(currentTime)) {\n      logger.log(`media seeking to ${currentTime.toFixed(3)}`);\n    }\n    let mediaBuffer = this.mediaBuffer ? this.mediaBuffer : media;\n    let bufferInfo = BufferHelper.bufferInfo(mediaBuffer,currentTime,this.config.maxBufferHole);\n    if (this.state === State.FRAG_LOADING) {\n      let fragCurrent = this.fragCurrent;\n      // check if we are seeking to a unbuffered area AND if frag loading is in progress\n      if (bufferInfo.len === 0 && fragCurrent) {\n        let tolerance = config.maxFragLookUpTolerance,\n            fragStartOffset = fragCurrent.start - tolerance,\n            fragEndOffset = fragCurrent.start + fragCurrent.duration + tolerance;\n        // check if we seek position will be out of currently loaded frag range : if out cancel frag load, if in, don't do anything\n        if (currentTime < fragStartOffset || currentTime > fragEndOffset) {\n          if (fragCurrent.loader) {\n            logger.log('seeking outside of buffer while fragment load in progress, cancel fragment load');\n            fragCurrent.loader.abort();\n          }\n          this.fragCurrent = null;\n          this.fragPrevious = null;\n          // switch to IDLE state to load new fragment\n          this.state = State.IDLE;\n        } else {\n          logger.log('seeking outside of buffer but within currently loaded fragment range');\n        }\n      }\n    } else if (this.state === State.ENDED) {\n        // if seeking to unbuffered area, clean up fragPrevious\n        if (bufferInfo.len === 0) {\n          this.fragPrevious = 0;\n        }\n        // switch to IDLE state to check for potential new fragment\n        this.state = State.IDLE;\n    }\n    if (media) {\n      this.lastCurrentTime = currentTime;\n    }\n    // avoid reporting fragment loop loading error in case user is seeking several times on same position\n    if (this.state !== State.FRAG_LOADING && this.fragLoadIdx !== undefined) {\n      this.fragLoadIdx += 2 * config.fragLoadingLoopThreshold;\n    }\n    // in case seeking occurs although no media buffered, adjust startPosition and nextLoadPosition to seek target\n    if(!this.loadedmetadata) {\n      this.nextLoadPosition = this.startPosition = currentTime;\n    }\n    // tick to speed up processing\n    this.tick();\n  }\n\n  onMediaSeeked() {\n    const media = this.media, currentTime = media ? media.currentTime : undefined;\n    if (!isNaN(currentTime)) {\n      logger.log(`media seeked to ${currentTime.toFixed(3)}`);\n    }\n    // tick to speed up FRAGMENT_PLAYING triggering\n    this.tick();\n  }\n\n  onMediaEnded() {\n    logger.log('media ended');\n    // reset startPosition and lastCurrentTime to restart playback @ stream beginning\n    this.startPosition = this.lastCurrentTime = 0;\n  }\n\n\n  onManifestLoading() {\n    // reset buffer on manifest loading\n    logger.log('trigger BUFFER_RESET');\n    this.hls.trigger(Event.BUFFER_RESET);\n    this._bufferedFrags = [];\n    this.stalled = false;\n    this.startPosition = this.lastCurrentTime = 0;\n  }\n\n  onManifestParsed(data) {\n    var aac = false, heaac = false, codec;\n    data.levels.forEach(level => {\n      // detect if we have different kind of audio codecs used amongst playlists\n      codec = level.audioCodec;\n      if (codec) {\n        if (codec.indexOf('mp4a.40.2') !== -1) {\n          aac = true;\n        }\n        if (codec.indexOf('mp4a.40.5') !== -1) {\n          heaac = true;\n        }\n      }\n    });\n    this.audioCodecSwitch = (aac && heaac);\n    if (this.audioCodecSwitch) {\n      logger.log('both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC');\n    }\n    this.levels = data.levels;\n    this.startLevelLoaded = false;\n    this.startFragRequested = false;\n    let config = this.config;\n    if (config.autoStartLoad || this.forceStartLoad) {\n      this.hls.startLoad(config.startPosition);\n    }\n  }\n\n  onLevelLoaded(data) {\n    var newDetails = data.details,\n        newLevelId = data.level,\n        curLevel = this.levels[newLevelId],\n        duration = newDetails.totalduration,\n        sliding = 0;\n\n    logger.log(`level ${newLevelId} loaded [${newDetails.startSN},${newDetails.endSN}],duration:${duration}`);\n    this.levelLastLoaded = newLevelId;\n\n    if (newDetails.live) {\n      var curDetails = curLevel.details;\n      if (curDetails && newDetails.fragments.length > 0) {\n        // we already have details for that level, merge them\n        LevelHelper.mergeDetails(curDetails,newDetails);\n        sliding = newDetails.fragments[0].start;\n        this.liveSyncPosition = this.computeLivePosition(sliding, curDetails);\n        if (newDetails.PTSKnown) {\n          logger.log(`live playlist sliding:${sliding.toFixed(3)}`);\n        } else {\n          logger.log('live playlist - outdated PTS, unknown sliding');\n        }\n      } else {\n        newDetails.PTSKnown = false;\n        logger.log('live playlist - first load, unknown sliding');\n      }\n    } else {\n      newDetails.PTSKnown = false;\n    }\n    // override level info\n    curLevel.details = newDetails;\n    this.hls.trigger(Event.LEVEL_UPDATED, { details: newDetails, level: newLevelId });\n\n    if (this.startFragRequested === false) {\n    // compute start position if set to -1. use it straight away if value is defined\n      if (this.startPosition === -1 || this.lastCurrentTime === -1) {\n        // first, check if start time offset has been set in playlist, if yes, use this value\n        let startTimeOffset = newDetails.startTimeOffset;\n        if(!isNaN(startTimeOffset)) {\n          if (startTimeOffset < 0) {\n            logger.log(`negative start time offset ${startTimeOffset}, count from end of last fragment`);\n            startTimeOffset = sliding + duration + startTimeOffset;\n          }\n          logger.log(`start time offset found in playlist, adjust startPosition to ${startTimeOffset}`);\n          this.startPosition = startTimeOffset;\n        } else {\n          // if live playlist, set start position to be fragment N-this.config.liveSyncDurationCount (usually 3)\n          if (newDetails.live) {\n            this.startPosition = this.computeLivePosition(sliding, newDetails);\n            logger.log(`configure startPosition to ${this.startPosition}`);\n          } else {\n            this.startPosition = 0;\n          }\n        }\n        this.lastCurrentTime = this.startPosition;\n      }\n      this.nextLoadPosition = this.startPosition;\n    }\n    // only switch batck to IDLE state if we were waiting for level to start downloading a new fragment\n    if (this.state === State.WAITING_LEVEL) {\n      this.state = State.IDLE;\n    }\n    //trigger handler right now\n    this.tick();\n  }\n\n  onKeyLoaded() {\n    if (this.state === State.KEY_LOADING) {\n      this.state = State.IDLE;\n      this.tick();\n    }\n  }\n\n  onFragLoaded(data) {\n    var fragCurrent = this.fragCurrent,\n        fragLoaded = data.frag;\n    if (this.state === State.FRAG_LOADING &&\n        fragCurrent &&\n        fragLoaded.type === 'main' &&\n        fragLoaded.level === fragCurrent.level &&\n        fragLoaded.sn === fragCurrent.sn) {\n      let stats = data.stats,\n          currentLevel = this.levels[fragCurrent.level],\n          details = currentLevel.details;\n      logger.log(`Loaded  ${fragCurrent.sn} of [${details.startSN} ,${details.endSN}],level ${fragCurrent.level}`);\n      // reset frag bitrate test in any case after frag loaded event\n      this.bitrateTest = false;\n      this.stats = stats;\n      // if this frag was loaded to perform a bitrate test AND if hls.nextLoadLevel is greater than 0\n      // then this means that we should be able to load a fragment at a higher quality level\n      if (fragLoaded.bitrateTest === true && this.hls.nextLoadLevel) {\n        // switch back to IDLE state ... we just loaded a fragment to determine adequate start bitrate and initialize autoswitch algo\n        this.state = State.IDLE;\n        this.startFragRequested = false;\n        stats.tparsed = stats.tbuffered = performance.now();\n        this.hls.trigger(Event.FRAG_BUFFERED, {stats: stats, frag: fragCurrent, id : 'main'});\n        this.tick();\n      } else if (fragLoaded.sn === 'initSegment') {\n        this.state = State.IDLE;\n        stats.tparsed = stats.tbuffered = performance.now();\n        details.initSegment.data = data.payload;\n        this.hls.trigger(Event.FRAG_BUFFERED, {stats: stats, frag: fragCurrent, id : 'main'});\n        this.tick();\n      } else {\n        this.state = State.PARSING;\n        // transmux the MPEG-TS data to ISO-BMFF segments\n        let duration = details.totalduration,\n            level = fragCurrent.level,\n            sn = fragCurrent.sn,\n            audioCodec = this.config.defaultAudioCodec || currentLevel.audioCodec;\n        if(this.audioCodecSwap) {\n          logger.log('swapping playlist audio codec');\n          if(audioCodec === undefined) {\n            audioCodec = this.lastAudioCodec;\n          }\n          if(audioCodec) {\n            if(audioCodec.indexOf('mp4a.40.5') !==-1) {\n              audioCodec = 'mp4a.40.2';\n            } else {\n              audioCodec = 'mp4a.40.5';\n            }\n          }\n        }\n        this.pendingBuffering = true;\n        this.appended = false;\n        logger.log(`Parsing ${sn} of [${details.startSN} ,${details.endSN}],level ${level}, cc ${fragCurrent.cc}`);\n        let demuxer = this.demuxer;\n        if (!demuxer) {\n          demuxer = this.demuxer = new Demuxer(this.hls,'main');\n        }\n        // time Offset is accurate if level PTS is known, or if playlist is not sliding (not live) and if media is not seeking (this is to overcome potential timestamp drifts between playlists and fragments)\n        let media = this.media;\n        let mediaSeeking = media && media.seeking;\n        let accurateTimeOffset = !mediaSeeking && (details.PTSKnown || !details.live);\n        let initSegmentData = details.initSegment ? details.initSegment.data : [];\n        demuxer.push(data.payload, initSegmentData,audioCodec, currentLevel.videoCodec, fragCurrent, duration, accurateTimeOffset,undefined);\n      }\n    }\n    this.fragLoadError = 0;\n  }\n\n  onFragParsingInitSegment(data) {\n    const fragCurrent = this.fragCurrent;\n    const fragNew = data.frag;\n    if (fragCurrent &&\n        data.id === 'main' &&\n        fragNew.sn === fragCurrent.sn &&\n        fragNew.level === fragCurrent.level &&\n        this.state === State.PARSING) {\n      var tracks = data.tracks, trackName, track;\n\n      // if audio track is expected to come from audio stream controller, discard any coming from main\n      if (tracks.audio && this.altAudio) {\n        delete tracks.audio;\n      }\n      // include levelCodec in audio and video tracks\n      track = tracks.audio;\n      if(track) {\n        var audioCodec = this.levels[this.level].audioCodec,\n            ua = navigator.userAgent.toLowerCase();\n        if(audioCodec && this.audioCodecSwap) {\n          logger.log('swapping playlist audio codec');\n          if(audioCodec.indexOf('mp4a.40.5') !==-1) {\n            audioCodec = 'mp4a.40.2';\n          } else {\n            audioCodec = 'mp4a.40.5';\n          }\n        }\n        // in case AAC and HE-AAC audio codecs are signalled in manifest\n        // force HE-AAC , as it seems that most browsers prefers that way,\n        // except for mono streams OR on FF\n        // these conditions might need to be reviewed ...\n        if (this.audioCodecSwitch) {\n            // don't force HE-AAC if mono stream\n           if(track.metadata.channelCount !== 1 &&\n            // don't force HE-AAC if firefox\n            ua.indexOf('firefox') === -1) {\n              audioCodec = 'mp4a.40.5';\n          }\n        }\n        // HE-AAC is broken on Android, always signal audio codec as AAC even if variant manifest states otherwise\n        if(ua.indexOf('android') !== -1 && track.container !== 'audio/mpeg') { // Exclude mpeg audio\n          audioCodec = 'mp4a.40.2';\n          logger.log(`Android: force audio codec to ${audioCodec}`);\n        }\n        track.levelCodec = audioCodec;\n        track.id = data.id;\n      }\n      track = tracks.video;\n      if(track) {\n        track.levelCodec = this.levels[this.level].videoCodec;\n        track.id = data.id;\n      }\n      this.hls.trigger(Event.BUFFER_CODECS,tracks);\n      // loop through tracks that are going to be provided to bufferController\n      for (trackName in tracks) {\n        track = tracks[trackName];\n        logger.log(`main track:${trackName},container:${track.container},codecs[level/parsed]=[${track.levelCodec}/${track.codec}]`);\n        var initSegment = track.initSegment;\n        if (initSegment) {\n          this.appended = true;\n          // arm pending Buffering flag before appending a segment\n          this.pendingBuffering = true;\n          this.hls.trigger(Event.BUFFER_APPENDING, {type: trackName, data: initSegment, parent : 'main', content : 'initSegment'});\n        }\n      }\n      //trigger handler right now\n      this.tick();\n    }\n  }\n\n  onFragParsingData(data) {\n    const fragCurrent = this.fragCurrent;\n    const fragNew = data.frag;\n    if (fragCurrent &&\n        data.id === 'main' &&\n        fragNew.sn === fragCurrent.sn &&\n        fragNew.level === fragCurrent.level &&\n        !(data.type === 'audio' && this.altAudio) && // filter out main audio if audio track is loaded through audio stream controller\n        this.state === State.PARSING) {\n      var level = this.levels[this.level],\n          frag = fragCurrent;\n          if (isNaN(data.endPTS)) {\n            data.endPTS = data.startPTS + fragCurrent.duration;\n            data.endDTS = data.startDTS + fragCurrent.duration;\n          }\n\n      logger.log(`Parsed ${data.type},PTS:[${data.startPTS.toFixed(3)},${data.endPTS.toFixed(3)}],DTS:[${data.startDTS.toFixed(3)}/${data.endDTS.toFixed(3)}],nb:${data.nb},dropped:${data.dropped || 0}`);\n\n      // Detect gaps in a fragment  and try to fix it by finding a keyframe in the previous fragment (see _findFragments)\n      if(data.type === 'video') {\n        frag.dropped = data.dropped;\n        if (frag.dropped) {\n          if (!frag.backtracked) {\n            logger.warn('missing video frame(s), backtracking fragment');\n            // Return back to the IDLE state without appending to buffer\n            // Causes findFragments to backtrack a segment and find the keyframe\n            // Audio fragments arriving before video sets the nextLoadPosition, causing _findFragments to skip the backtracked fragment\n            frag.backtracked = true;\n            this.nextLoadPosition = data.startPTS;\n            this.state = State.IDLE;\n            this.fragPrevious = frag;\n            this.tick();\n            return;\n          } else {\n            logger.warn('Already backtracked on this fragment, appending with the gap');\n          }\n        } else {\n          // Only reset the backtracked flag if we've loaded the frag without any dropped frames\n          frag.backtracked = false;\n        }\n      }\n\n      var drift = LevelHelper.updateFragPTSDTS(level.details,frag,data.startPTS,data.endPTS,data.startDTS,data.endDTS),\n          hls = this.hls;\n      hls.trigger(Event.LEVEL_PTS_UPDATED, {details: level.details, level: this.level, drift: drift, type: data.type, start: data.startPTS, end: data.endPTS});\n\n      // has remuxer dropped video frames located before first keyframe ?\n      [data.data1, data.data2].forEach(buffer => {\n        // only append in PARSING state (rationale is that an appending error could happen synchronously on first segment appending)\n        // in that case it is useless to append following segments\n        if (buffer && buffer.length && this.state === State.PARSING) {\n          this.appended = true;\n          // arm pending Buffering flag before appending a segment\n          this.pendingBuffering = true;\n          hls.trigger(Event.BUFFER_APPENDING, {type: data.type, data: buffer, parent : 'main',content : 'data'});\n        }\n      });\n      //trigger handler right now\n      this.tick();\n    }\n  }\n\n  onFragParsed(data) {\n    const fragCurrent = this.fragCurrent;\n    const fragNew = data.frag;\n    if (fragCurrent &&\n        data.id === 'main' &&\n        fragNew.sn === fragCurrent.sn &&\n        fragNew.level === fragCurrent.level &&\n        this.state === State.PARSING) {\n      this.stats.tparsed = performance.now();\n      this.state = State.PARSED;\n      this._checkAppendedParsed();\n    }\n  }\n\n  onAudioTrackSwitching(data) {\n    // if any URL found on new audio track, it is an alternate audio track\n    var altAudio = !!data.url,\n        trackId = data.id;\n    // if we switch on main audio, ensure that main fragment scheduling is synced with media.buffered\n    // don't do anything if we switch to alt audio: audio stream controller is handling it.\n    // we will just have to change buffer scheduling on audioTrackSwitched\n    if (!altAudio) {\n      if (this.mediaBuffer !== this.media) {\n        logger.log(`switching on main audio, use media.buffered to schedule main fragment loading`);\n        this.mediaBuffer = this.media;\n        let fragCurrent = this.fragCurrent;\n        // we need to refill audio buffer from main: cancel any frag loading to speed up audio switch\n        if (fragCurrent.loader) {\n          logger.log('switching to main audio track, cancel main fragment load');\n          fragCurrent.loader.abort();\n        }\n        this.fragCurrent = null;\n        this.fragPrevious = null;\n        // destroy demuxer to force init segment generation (following audio switch)\n        if (this.demuxer) {\n          this.demuxer.destroy();\n          this.demuxer = null;\n        }\n        // switch to IDLE state to load new fragment\n        this.state = State.IDLE;\n      }\n      let hls = this.hls;\n      // switching to main audio, flush all audio and trigger track switched\n      hls.trigger(Event.BUFFER_FLUSHING, {startOffset: 0 , endOffset: Number.POSITIVE_INFINITY, type : 'audio'});\n      hls.trigger(Event.AUDIO_TRACK_SWITCHED, {id : trackId});\n      this.altAudio = false;\n    }\n  }\n\n  onAudioTrackSwitched(data) {\n    var trackId = data.id,\n    altAudio = !!this.hls.audioTracks[trackId].url;\n    if (altAudio) {\n      let videoBuffer = this.videoBuffer;\n      // if we switched on alternate audio, ensure that main fragment scheduling is synced with video sourcebuffer buffered\n      if (videoBuffer && this.mediaBuffer !== videoBuffer) {\n        logger.log(`switching on alternate audio, use video.buffered to schedule main fragment loading`);\n        this.mediaBuffer = videoBuffer;\n      }\n    }\n    this.altAudio = altAudio;\n    this.tick();\n  }\n\n\n\n  onBufferCreated(data) {\n    let tracks = data.tracks, mediaTrack, name, alternate = false;\n    for(var type in tracks) {\n      let track = tracks[type];\n      if (track.id === 'main') {\n        name = type;\n        mediaTrack = track;\n        // keep video source buffer reference\n        if (type === 'video') {\n          this.videoBuffer = tracks[type].buffer;\n        }\n      } else {\n        alternate = true;\n      }\n    }\n    if (alternate && mediaTrack) {\n      logger.log(`alternate track found, use ${name}.buffered to schedule main fragment loading`);\n      this.mediaBuffer = mediaTrack.buffer;\n    } else {\n      this.mediaBuffer = this.media;\n    }\n  }\n\n  onBufferAppended(data) {\n    if (data.parent === 'main') {\n      const state = this.state;\n      if (state === State.PARSING || state === State.PARSED) {\n        // check if all buffers have been appended\n        this.pendingBuffering = (data.pending > 0);\n        this._checkAppendedParsed();\n      }\n    }\n  }\n\n  _checkAppendedParsed() {\n    //trigger handler right now\n    if (this.state === State.PARSED && (!this.appended || !this.pendingBuffering)) {\n      const frag = this.fragCurrent;\n      if (frag) {\n        const media = this.mediaBuffer ? this.mediaBuffer : this.media;\n        logger.log(`main buffered : ${TimeRanges.toString(media.buffered)}`);\n        // filter fragments potentially evicted from buffer. this is to avoid memleak on live streams\n        let bufferedFrags = this._bufferedFrags.filter(frag => {return BufferHelper.isBuffered(media,(frag.startPTS + frag.endPTS) / 2);});\n        // push new range\n        bufferedFrags.push(frag);\n        // sort frags, as we use BinarySearch for lookup in getBufferedFrag ...\n        this._bufferedFrags = bufferedFrags.sort(function(a,b) {return (a.startPTS - b.startPTS);});\n        this.fragPrevious = frag;\n        const stats = this.stats;\n        stats.tbuffered = performance.now();\n        // we should get rid of this.fragLastKbps\n        this.fragLastKbps = Math.round(8 * stats.total / (stats.tbuffered - stats.tfirst));\n        this.hls.trigger(Event.FRAG_BUFFERED, {stats: stats, frag: frag, id : 'main'});\n        this.state = State.IDLE;\n      }\n      this.tick();\n    }\n  }\n\n  onError(data) {\n    let frag = data.frag || this.fragCurrent;\n    // don't handle frag error not related to main fragment\n    if (frag && frag.type !== 'main') {\n      return;\n    }\n    let media = this.media,\n        // 0.5 : tolerance needed as some browsers stalls playback before reaching buffered end\n        mediaBuffered = media && BufferHelper.isBuffered(media,media.currentTime) && BufferHelper.isBuffered(media,media.currentTime+0.5);\n    switch(data.details) {\n      case ErrorDetails.FRAG_LOAD_ERROR:\n      case ErrorDetails.FRAG_LOAD_TIMEOUT:\n      case ErrorDetails.KEY_LOAD_ERROR:\n      case ErrorDetails.KEY_LOAD_TIMEOUT:\n        if(!data.fatal) {\n          var loadError = this.fragLoadError;\n          if(loadError) {\n            loadError++;\n          } else {\n            loadError=1;\n          }\n          let config = this.config;\n          // keep retrying / don't raise fatal network error if current position is buffered or if in automode with current level not 0\n          if (loadError <= config.fragLoadingMaxRetry || mediaBuffered || (frag.autoLevel && frag.level)) {\n            this.fragLoadError = loadError;\n            // reset load counter to avoid frag loop loading error\n            frag.loadCounter = 0;\n            // exponential backoff capped to config.fragLoadingMaxRetryTimeout\n            var delay = Math.min(Math.pow(2,loadError-1)*config.fragLoadingRetryDelay,config.fragLoadingMaxRetryTimeout);\n            logger.warn(`mediaController: frag loading failed, retry in ${delay} ms`);\n            this.retryDate = performance.now() + delay;\n            // retry loading state\n            // if loadedmetadata is not set, it means that we are emergency switch down on first frag\n            // in that case, reset startFragRequested flag\n            if(!this.loadedmetadata) {\n              this.startFragRequested = false;\n              this.nextLoadPosition = this.startPosition;\n            }\n            this.state = State.FRAG_LOADING_WAITING_RETRY;\n          } else {\n            logger.error(`mediaController: ${data.details} reaches max retry, redispatch as fatal ...`);\n            // switch error to fatal\n            data.fatal = true;\n            this.state = State.ERROR;\n          }\n        }\n        break;\n      case ErrorDetails.FRAG_LOOP_LOADING_ERROR:\n        if(!data.fatal) {\n          // if buffer is not empty\n          if (mediaBuffered) {\n            // try to reduce max buffer length : rationale is that we could get\n            // frag loop loading error because of buffer eviction\n            this._reduceMaxBufferLength(frag.duration);\n            this.state = State.IDLE;\n          } else {\n            // buffer empty. report as fatal if in manual mode or if lowest level.\n            // level controller takes care of emergency switch down logic\n            if (!frag.autoLevel || frag.level === 0) {\n              // switch error to fatal\n              data.fatal = true;\n              this.state = State.ERROR;\n            }\n          }\n        }\n        break;\n      case ErrorDetails.LEVEL_LOAD_ERROR:\n      case ErrorDetails.LEVEL_LOAD_TIMEOUT:\n        if(this.state !== State.ERROR) {\n          if (data.fatal) {\n           // if fatal error, stop processing\n            this.state = State.ERROR;\n            logger.warn(`streamController: ${data.details},switch to ${this.state} state ...`);\n          } else {\n            // in case of non fatal error while loading level, if level controller is not retrying to load level , switch back to IDLE\n            if (!data.levelRetry && this.state === State.WAITING_LEVEL) {\n              this.state = State.IDLE;\n            }\n          }\n        }\n        break;\n      case ErrorDetails.BUFFER_FULL_ERROR:\n        // if in appending state\n        if (data.parent === 'main' && (this.state === State.PARSING || this.state === State.PARSED)) {\n          // reduce max buf len if current position is buffered\n          if (mediaBuffered) {\n            this._reduceMaxBufferLength(this.config.maxBufferLength);\n            this.state = State.IDLE;\n          } else {\n            // current position is not buffered, but browser is still complaining about buffer full error\n            // this happens on IE/Edge, refer to https://github.com/video-dev/hls.js/pull/708\n            // in that case flush the whole buffer to recover\n            logger.warn('buffer full error also media.currentTime is not buffered, flush everything');\n            this.fragCurrent = null;\n            // flush everything\n            this.flushMainBuffer(0,Number.POSITIVE_INFINITY);\n          }\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  _reduceMaxBufferLength(minLength) {\n    let config = this.config;\n    if (config.maxMaxBufferLength >= minLength) {\n      // reduce max buffer length as it might be too high. we do this to avoid loop flushing ...\n      config.maxMaxBufferLength/=2;\n      logger.warn(`main:reduce max buffer length to ${config.maxMaxBufferLength}s`);\n      // increase fragment load Index to avoid frag loop loading error after buffer flush\n      this.fragLoadIdx += 2 * config.fragLoadingLoopThreshold;\n    }\n  }\n\n_checkBuffer() {\n    var media = this.media;\n    // if ready state different from HAVE_NOTHING (numeric value 0), we are allowed to seek\n    if(media && media.readyState) {\n        let currentTime = media.currentTime,\n            mediaBuffer = this.mediaBuffer ? this.mediaBuffer : media,\n             buffered = mediaBuffer.buffered;\n      // adjust currentTime to start position on loaded metadata\n      if(!this.loadedmetadata && buffered.length) {\n        this.loadedmetadata = true;\n        // only adjust currentTime if different from startPosition or if startPosition not buffered\n        // at that stage, there should be only one buffered range, as we reach that code after first fragment has been buffered\n        let startPosition = media.seeking ? currentTime : this.startPosition,\n            startPositionBuffered = BufferHelper.isBuffered(mediaBuffer,startPosition);\n        // if currentTime not matching with expected startPosition or startPosition not buffered\n        if (currentTime !== startPosition || !startPositionBuffered) {\n          logger.log(`target start position:${startPosition}`);\n          // if startPosition not buffered, let's seek to buffered.start(0)\n          if(!startPositionBuffered) {\n            startPosition = buffered.start(0);\n            logger.log(`target start position not buffered, seek to buffered.start(0) ${startPosition}`);\n          }\n          logger.log(`adjust currentTime from ${currentTime} to ${startPosition}`);\n          media.currentTime = startPosition;\n        }\n      } else if (this.immediateSwitch) {\n        this.immediateLevelSwitchEnd();\n      } else {\n        let bufferInfo = BufferHelper.bufferInfo(media,currentTime,0),\n            expectedPlaying = !(media.paused || // not playing when media is paused\n                                media.ended  || // not playing when media is ended\n                                media.buffered.length === 0), // not playing if nothing buffered\n            jumpThreshold = 0.5, // tolerance needed as some browsers stalls playback before reaching buffered range end\n            playheadMoving = currentTime !== this.lastCurrentTime,\n            config = this.config;\n\n        if (playheadMoving) {\n          // played moving, but was previously stalled => now not stuck anymore\n          if (this.stallReported) {\n            logger.warn(`playback not stuck anymore @${currentTime}, after ${Math.round(performance.now()-this.stalled)}ms`);\n            this.stallReported = false;\n          }\n          this.stalled = undefined;\n          this.nudgeRetry = 0;\n        } else {\n          // playhead not moving\n          if(expectedPlaying) {\n            // playhead not moving BUT media expected to play\n            const tnow = performance.now();\n            const hls = this.hls;\n            if(!this.stalled) {\n              // stall just detected, store current time\n              this.stalled = tnow;\n              this.stallReported = false;\n            } else {\n              // playback already stalled, check stalling duration\n              // if stalling for more than a given threshold, let's try to recover\n              const stalledDuration = tnow - this.stalled;\n              const bufferLen = bufferInfo.len;\n              let nudgeRetry = this.nudgeRetry || 0;\n              // have we reached stall deadline ?\n              if (bufferLen <= jumpThreshold && stalledDuration > config.lowBufferWatchdogPeriod * 1000) {\n                // report stalled error once\n                if (!this.stallReported) {\n                  this.stallReported = true;\n                  logger.warn(`playback stalling in low buffer @${currentTime}`);\n                  hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_STALLED_ERROR, fatal: false, buffer : bufferLen});\n                }\n                // if buffer len is below threshold, try to jump to start of next buffer range if close\n                // no buffer available @ currentTime, check if next buffer is close (within a config.maxSeekHole second range)\n                var nextBufferStart = bufferInfo.nextStart, delta = nextBufferStart-currentTime;\n                if(nextBufferStart &&\n                   (delta < config.maxSeekHole) &&\n                   (delta > 0)) {\n                  this.nudgeRetry = ++nudgeRetry;\n                  const nudgeOffset = nudgeRetry * config.nudgeOffset;\n                  // next buffer is close ! adjust currentTime to nextBufferStart\n                  // this will ensure effective video decoding\n                  logger.log(`adjust currentTime from ${media.currentTime} to next buffered @ ${nextBufferStart} + nudge ${nudgeOffset}`);\n                  media.currentTime = nextBufferStart + nudgeOffset;\n                  // reset stalled so to rearm watchdog timer\n                  this.stalled = undefined;\n                  hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_SEEK_OVER_HOLE, fatal: false, hole : nextBufferStart + nudgeOffset - currentTime});\n                }\n              } else if (bufferLen > jumpThreshold && stalledDuration > config.highBufferWatchdogPeriod * 1000) {\n                // report stalled error once\n                if (!this.stallReported) {\n                  this.stallReported = true;\n                  logger.warn(`playback stalling in high buffer @${currentTime}`);\n                  hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_STALLED_ERROR, fatal: false, buffer : bufferLen});\n                }\n                // reset stalled so to rearm watchdog timer\n                this.stalled = undefined;\n                this.nudgeRetry = ++nudgeRetry;\n                if (nudgeRetry < config.nudgeMaxRetry) {\n                  const currentTime = media.currentTime;\n                  const targetTime = currentTime + nudgeRetry * config.nudgeOffset;\n                  logger.log(`adjust currentTime from ${currentTime} to ${targetTime}`);\n                  // playback stalled in buffered area ... let's nudge currentTime to try to overcome this\n                  media.currentTime = targetTime;\n                  hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_NUDGE_ON_STALL, fatal: false});\n                } else {\n                  logger.error(`still stuck in high buffer @${currentTime} after ${config.nudgeMaxRetry}, raise fatal error`);\n                  hls.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.BUFFER_STALLED_ERROR, fatal: true});\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  onFragLoadEmergencyAborted() {\n    this.state = State.IDLE;\n    // if loadedmetadata is not set, it means that we are emergency switch down on first frag\n    // in that case, reset startFragRequested flag\n    if(!this.loadedmetadata) {\n      this.startFragRequested = false;\n      this.nextLoadPosition = this.startPosition;\n    }\n    this.tick();\n  }\n\n  onBufferFlushed() {\n    /* after successful buffer flushing, filter flushed fragments from bufferedFrags\n      use mediaBuffered instead of media (so that we will check against video.buffered ranges in case of alt audio track)\n    */\n    const media = this.mediaBuffer ? this.mediaBuffer : this.media;\n    this._bufferedFrags = this._bufferedFrags.filter(frag => {return BufferHelper.isBuffered(media,(frag.startPTS + frag.endPTS) / 2);});\n\n    // increase fragment load Index to avoid frag loop loading error after buffer flush\n    this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n    // move to IDLE once flush complete. this should trigger new fragment loading\n    this.state = State.IDLE;\n    // reset reference to frag\n    this.fragPrevious = null;\n  }\n\n  swapAudioCodec() {\n    this.audioCodecSwap = !this.audioCodecSwap;\n  }\n\n  computeLivePosition(sliding, levelDetails) {\n    let targetLatency = this.config.liveSyncDuration !== undefined ? this.config.liveSyncDuration : this.config.liveSyncDurationCount * levelDetails.targetduration;\n    return sliding + Math.max(0, levelDetails.totalduration - targetLatency);\n  }\n\n  get liveSyncPosition() {\n    return this._liveSyncPosition;\n  }\n\n  set liveSyncPosition(value) {\n    this._liveSyncPosition = value;\n  }\n}\nexport default StreamController;\n\n\n\n\n// WEBPACK FOOTER //\n// src/controller/stream-controller.js","/*\n * Subtitle Stream Controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport {logger} from '../utils/logger';\n\nclass SubtitleStreamController extends EventHandler {\n\n  constructor(hls) {\n    super(hls,\n      Event.ERROR,\n      Event.SUBTITLE_TRACKS_UPDATED,\n      Event.SUBTITLE_TRACK_SWITCH,\n      Event.SUBTITLE_TRACK_LOADED,\n      Event.SUBTITLE_FRAG_PROCESSED);\n    this.config = hls.config;\n    this.vttFragSNsProcessed = {};\n    this.vttFragQueues = undefined;\n    this.currentlyProcessing = null;\n    this.currentTrackId = -1;\n  }\n\n  destroy() {\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  // Remove all queued items and create a new, empty queue for each track.\n  clearVttFragQueues() {\n    this.vttFragQueues = {};\n    this.tracks.forEach(track => {\n      this.vttFragQueues[track.id] = [];\n    });\n  }\n\n  // If no frag is being processed and queue isn't empty, initiate processing of next frag in line.\n  nextFrag() {\n    if(this.currentlyProcessing === null && this.currentTrackId > -1 && this.vttFragQueues[this.currentTrackId].length) {\n      let frag = this.currentlyProcessing = this.vttFragQueues[this.currentTrackId].shift();\n      this.hls.trigger(Event.FRAG_LOADING, {frag});\n    }\n  }\n\n  // When fragment has finished processing, add sn to list of completed if successful.\n  onSubtitleFragProcessed(data) {\n    if(data.success) {\n      this.vttFragSNsProcessed[data.frag.trackId].push(data.frag.sn);\n    }\n    this.currentlyProcessing = null;\n    this.nextFrag();\n  }\n\n  // If something goes wrong, procede to next frag, if we were processing one.\n  onError(data) {\n    let frag = data.frag;\n    // don't handle frag error not related to subtitle fragment\n    if (frag && frag.type !== 'subtitle') {\n      return;\n    }\n    if(this.currentlyProcessing) {\n      this.currentlyProcessing = null;\n      this.nextFrag();\n    }\n  }\n\n  // Got all new subtitle tracks.\n  onSubtitleTracksUpdated(data) {\n    logger.log('subtitle tracks updated');\n    this.tracks = data.subtitleTracks;\n    this.clearVttFragQueues();\n    this.vttFragSNsProcessed = {};\n    this.tracks.forEach(track => {\n      this.vttFragSNsProcessed[track.id] = [];\n    });\n  }\n\n  onSubtitleTrackSwitch(data) {\n    this.currentTrackId = data.id;\n    this.clearVttFragQueues();\n  }\n\n  // Got a new set of subtitle fragments.\n  onSubtitleTrackLoaded(data) {\n    const processedFragSNs = this.vttFragSNsProcessed[data.id],\n        fragQueue = this.vttFragQueues[data.id],\n        currentFragSN = !!this.currentlyProcessing ? this.currentlyProcessing.sn : -1;\n\n    const alreadyProcessed = function(frag) {\n      return processedFragSNs.indexOf(frag.sn) > -1;\n    };\n\n    const alreadyInQueue = function(frag) {\n      return fragQueue.some(fragInQueue => {return fragInQueue.sn === frag.sn;});\n    };\n\n    // Add all fragments that haven't been, aren't currently being and aren't waiting to be processed, to queue.\n    data.details.fragments.forEach(frag => {\n      if(!(alreadyProcessed(frag) || frag.sn === currentFragSN || alreadyInQueue(frag))) {\n        // Frags don't know their subtitle track ID, so let's just add that...\n        frag.trackId = data.id;\n        fragQueue.push(frag);\n      }\n    });\n\n    this.nextFrag();\n  }\n}\nexport default SubtitleStreamController;\n\n\n\n\n// WEBPACK FOOTER //\n// src/controller/subtitle-stream-controller.js","/*\n * audio track controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport {logger} from '../utils/logger';\n\nfunction filterSubtitleTracks(textTrackList) {\n  let tracks = [];\n  for (let i = 0; i < textTrackList.length; i++) {\n    if (textTrackList[i].kind === 'subtitles') {\n      tracks.push(textTrackList[i]);\n    }\n  }\n  return tracks;\n}\n\nclass SubtitleTrackController extends EventHandler {\n\n  constructor(hls) {\n    super(hls,\n               Event.MEDIA_ATTACHED,\n               Event.MEDIA_DETACHING,\n               Event.MANIFEST_LOADING,\n               Event.MANIFEST_LOADED,\n               Event.SUBTITLE_TRACK_LOADED);\n    this.tracks = [];\n    this.trackId = -1;\n    this.media = undefined;\n  }\n\n  destroy() {\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  // Listen for subtitle track change, then extract the current track ID.\n  onMediaAttached(data) {\n    this.media = data.media;\n    if (!this.media) {\n      return;\n    }\n\n    this.media.textTracks.addEventListener('change', () => {\n      // Media is undefined when switching streams via loadSource()\n      if (!this.media) {\n        return;\n      }\n\n      let trackId = -1;\n      let tracks = filterSubtitleTracks(this.media.textTracks);\n      for (let id = 0; id < tracks.length; id++) {\n        if (tracks[id].mode === 'showing') {\n          trackId = id;\n        }\n      }\n      // Setting current subtitleTrack will invoke code.\n      this.subtitleTrack = trackId;\n    });\n  }\n\n  onMediaDetaching() {\n    // TODO: Remove event listeners.\n    this.media = undefined;\n  }\n\n  // Reset subtitle tracks on manifest loading\n  onManifestLoading() {\n    this.tracks = [];\n    this.trackId = -1;\n  }\n\n  // Fired whenever a new manifest is loaded.\n  onManifestLoaded(data) {\n    let tracks = data.subtitles || [];\n    let defaultFound = false;\n    this.tracks = tracks;\n    this.trackId = -1;\n    this.hls.trigger(Event.SUBTITLE_TRACKS_UPDATED, {subtitleTracks : tracks});\n\n    // loop through available subtitle tracks and autoselect default if needed\n    // TODO: improve selection logic to handle forced, etc\n    tracks.forEach(track => {\n      if (track.default) {\n        this.subtitleTrack = track.id;\n        defaultFound = true;\n      }\n    });\n  }\n\n  // Trigger subtitle track playlist reload.\n  onTick() {\n    const trackId = this.trackId;\n    const subtitleTrack = this.tracks[trackId];\n    if (!subtitleTrack) {\n      return;\n    }\n\n    const details = subtitleTrack.details;\n    // check if we need to load playlist for this subtitle Track\n    if (details === undefined || details.live === true) {\n      // track not retrieved yet, or live playlist we need to (re)load it\n      logger.log(`(re)loading playlist for subtitle track ${trackId}`);\n      this.hls.trigger(Event.SUBTITLE_TRACK_LOADING, {url: subtitleTrack.url, id: trackId});\n    }\n  }\n\n  onSubtitleTrackLoaded(data) {\n    if (data.id < this.tracks.length) {\n      logger.log(`subtitle track ${data.id} loaded`);\n      this.tracks[data.id].details = data.details;\n      // check if current playlist is a live playlist\n      if (data.details.live && !this.timer) {\n        // if live playlist we will have to reload it periodically\n        // set reload period to playlist target duration\n        this.timer = setInterval(() => {\n          this.onTick();\n        }, 1000 * data.details.targetduration, this);\n      }\n      if (!data.details.live && this.timer) {\n        // playlist is not live and timer is armed : stopping it\n        clearInterval(this.timer);\n        this.timer = null;\n      }\n    }\n  }\n\n  /** get alternate subtitle tracks list from playlist **/\n  get subtitleTracks() {\n    return this.tracks;\n  }\n\n  /** get index of the selected subtitle track (index in subtitle track lists) **/\n  get subtitleTrack() {\n   return this.trackId;\n  }\n\n  /** select a subtitle track, based on its index in subtitle track lists**/\n  set subtitleTrack(subtitleTrackId) {\n    if (this.trackId !== subtitleTrackId) {// || this.tracks[subtitleTrackId].details === undefined) {\n      this.setSubtitleTrackInternal(subtitleTrackId);\n    }\n  }\n\n setSubtitleTrackInternal(newId) {\n    // check if level idx is valid\n    if (newId >= 0 && newId < this.tracks.length) {\n      // stopping live reloading timer if any\n      if (this.timer) {\n       clearInterval(this.timer);\n       this.timer = null;\n      }\n      this.trackId = newId;\n      logger.log(`switching to subtitle track ${newId}`);\n      let subtitleTrack = this.tracks[newId];\n      this.hls.trigger(Event.SUBTITLE_TRACK_SWITCH, {id: newId});\n       // check if we need to load playlist for this subtitle Track\n      let details = subtitleTrack.details;\n      if (details === undefined || details.live === true) {\n        // track not retrieved yet, or live playlist we need to (re)load it\n        logger.log(`(re)loading playlist for subtitle track ${newId}`);\n        this.hls.trigger(Event.SUBTITLE_TRACK_LOADING, {url: subtitleTrack.url, id: newId});\n      }\n    }\n  }\n}\n\nexport default SubtitleTrackController;\n\n\n\n// WEBPACK FOOTER //\n// src/controller/subtitle-track-controller.js","/*\n * Timeline Controller\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport Cea608Parser from '../utils/cea-608-parser';\nimport WebVTTParser from '../utils/webvtt-parser';\nimport {logger} from '../utils/logger';\n\nfunction clearCurrentCues(track) {\n  if (track && track.cues) {\n    while (track.cues.length > 0) {\n      track.removeCue(track.cues[0]);\n    }\n  }\n}\n\nfunction reuseVttTextTrack(inUseTrack, manifestTrack) {\n  return inUseTrack && inUseTrack.label === manifestTrack.name && !(inUseTrack.textTrack1 || inUseTrack.textTrack2);\n}\n\nfunction intersection(x1, x2, y1, y2) {\n  return Math.min(x2, y2) - Math.max(x1, y1);\n}\n\nclass TimelineController extends EventHandler {\n\n  constructor(hls) {\n    super(hls, Event.MEDIA_ATTACHING,\n                Event.MEDIA_DETACHING,\n                Event.FRAG_PARSING_USERDATA,\n                Event.MANIFEST_LOADING,\n                Event.MANIFEST_LOADED,\n                Event.FRAG_LOADED,\n                Event.LEVEL_SWITCHING,\n                Event.INIT_PTS_FOUND);\n\n    this.hls = hls;\n    this.config = hls.config;\n    this.enabled = true;\n    this.Cues = hls.config.cueHandler;\n    this.textTracks = [];\n    this.tracks = [];\n    this.unparsedVttFrags = [];\n    this.initPTS = undefined;\n    this.cueRanges = [];\n\n    if (this.config.enableCEA708Captions)\n    {\n      var self = this;\n      var sendAddTrackEvent = function (track, media)\n      {\n        var e = null;\n        try {\n          e = new window.Event('addtrack');\n        } catch (err) {\n          //for IE11\n          e = document.createEvent('Event');\n          e.initEvent('addtrack', false, false);\n        }\n        e.track = track;\n        media.dispatchEvent(e);\n      };\n\n      var channel1 =\n      {\n        'newCue': function(startTime, endTime, screen)\n        {\n          if (!self.textTrack1)\n          {\n            //Enable reuse of existing text track.\n            var existingTrack1 = self.getExistingTrack('1');\n            if (!existingTrack1)\n            {\n              const textTrack1 = self.createTextTrack('captions', self.config.captionsTextTrack1Label, self.config.captionsTextTrack1LanguageCode);\n              if (textTrack1) {\n                textTrack1.textTrack1 = true;\n                self.textTrack1 = textTrack1;\n              }\n            }\n            else\n            {\n              self.textTrack1 = existingTrack1;\n              clearCurrentCues(self.textTrack1);\n\n              sendAddTrackEvent(self.textTrack1, self.media);\n            }\n          }\n          self.addCues('textTrack1', startTime, endTime, screen);\n        }\n      };\n\n      var channel2 =\n      {\n        'newCue': function(startTime, endTime, screen)\n        {\n          if (!self.textTrack2)\n          {\n            //Enable reuse of existing text track.\n            var existingTrack2 = self.getExistingTrack('2');\n            if (!existingTrack2)\n            {\n              const textTrack2 = self.createTextTrack('captions', self.config.captionsTextTrack2Label, self.config.captionsTextTrack1LanguageCode);\n              if (textTrack2) {\n                textTrack2.textTrack2 = true;\n                self.textTrack2 = textTrack2;\n              }\n            }\n            else\n            {\n              self.textTrack2 = existingTrack2;\n              clearCurrentCues(self.textTrack2);\n\n              sendAddTrackEvent(self.textTrack2, self.media);\n            }\n          }\n          self.addCues('textTrack2', startTime, endTime, screen);\n        }\n      };\n\n      this.cea608Parser = new Cea608Parser(0, channel1, channel2);\n    }\n  }\n\n  addCues(channel, startTime, endTime, screen) {\n    // skip cues which overlap more than 50% with previously parsed time ranges\n    const ranges = this.cueRanges;\n    let merged = false;\n    for (let i = ranges.length; i--;) {\n      let cueRange = ranges[i];\n      let overlap = intersection(cueRange[0], cueRange[1], startTime, endTime);\n      if (overlap >= 0) {\n        cueRange[0] = Math.min(cueRange[0], startTime);\n        cueRange[1] = Math.max(cueRange[1], endTime);\n        merged = true;\n        if ((overlap / (endTime - startTime)) > 0.5) {\n          return;\n        }\n      }\n    }\n    if (!merged) {\n      ranges.push([startTime, endTime]);\n    }\n    this.Cues.newCue(this[channel], startTime, endTime, screen);\n  }\n\n  // Triggered when an initial PTS is found; used for synchronisation of WebVTT.\n  onInitPtsFound(data) {\n    if (typeof this.initPTS === 'undefined') {\n      this.initPTS = data.initPTS;\n    }\n\n    // Due to asynchrony, initial PTS may arrive later than the first VTT fragments are loaded.\n    // Parse any unparsed fragments upon receiving the initial PTS.\n    if (this.unparsedVttFrags.length) {\n      this.unparsedVttFrags.forEach(frag => {\n        this.onFragLoaded(frag);\n      });\n      this.unparsedVttFrags = [];\n    }\n  }\n\n  getExistingTrack(channelNumber) {\n    const media = this.media;\n    if (media) {\n      for (let i = 0; i < media.textTracks.length; i++) {\n        let textTrack = media.textTracks[i];\n        let propName = 'textTrack' + channelNumber;\n        if (textTrack[propName] === true) {\n          return textTrack;\n        }\n      }\n    }\n    return null;\n  }\n\n  createTextTrack(kind, label, lang) {\n    const media = this.media;\n    if (media)\n    {\n      return media.addTextTrack(kind, label, lang);\n    }\n  }\n\n  destroy() {\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onMediaAttaching(data) {\n    this.media = data.media;\n  }\n\n  onMediaDetaching() {\n    clearCurrentCues(this.textTrack1);\n    clearCurrentCues(this.textTrack2);\n  }\n\n  onManifestLoading()\n  {\n    this.lastSn = -1; // Detect discontiguity in fragment parsing\n    this.prevCC = -1;\n    this.vttCCs = {ccOffset: 0, presentationOffset: 0}; // Detect discontinuity in subtitle manifests\n\n    // clear outdated subtitles\n    const media = this.media;\n    if (media) {\n      const textTracks = media.textTracks;\n      if (textTracks) {\n        for (let i = 0; i < textTracks.length; i++) {\n          clearCurrentCues(textTracks[i]);\n        }\n      }\n    }\n  }\n\n  onManifestLoaded(data) {\n    this.textTracks = [];\n    this.unparsedVttFrags = this.unparsedVttFrags || [];\n    this.initPTS = undefined;\n    this.cueRanges = [];\n\n    if (this.config.enableWebVTT) {\n      this.tracks = data.subtitles || [];\n      const inUseTracks = this.media ? this.media.textTracks : [];\n\n      this.tracks.forEach((track, index) => {\n        let textTrack;\n        if (index < inUseTracks.length) {\n          const inUseTrack = inUseTracks[index];\n          // Reuse tracks with the same label, but do not reuse 608/708 tracks\n          if (reuseVttTextTrack(inUseTrack, track)) {\n            textTrack = inUseTrack;\n          }\n        }\n        if (!textTrack) {\n            textTrack = this.createTextTrack('subtitles', track.name, track.lang);\n        }\n        textTrack.mode = track.default ? 'showing' : 'hidden';\n        this.textTracks.push(textTrack);\n      });\n    }\n  }\n\n  onLevelSwitching() {\n    this.enabled = this.hls.currentLevel.closedCaptions !== 'NONE';\n  }\n\n  onFragLoaded(data) {\n    let frag = data.frag,\n      payload = data.payload;\n    if (frag.type === 'main') {\n      var sn = frag.sn;\n      // if this frag isn't contiguous, clear the parser so cues with bad start/end times aren't added to the textTrack\n      if (sn !== this.lastSn + 1) {\n        const cea608Parser = this.cea608Parser;\n        if (cea608Parser) {\n          cea608Parser.reset();\n        }\n      }\n      this.lastSn = sn;\n    }\n    // If fragment is subtitle type, parse as WebVTT.\n    else if (frag.type === 'subtitle') {\n      if (payload.byteLength) {\n        // We need an initial synchronisation PTS. Store fragments as long as none has arrived.\n        if (typeof this.initPTS === 'undefined') {\n          this.unparsedVttFrags.push(data);\n          return;\n        }\n        let vttCCs = this.vttCCs;\n        if (!vttCCs[frag.cc]) {\n          vttCCs[frag.cc] = { start: frag.start, prevCC: this.prevCC, new: true };\n          this.prevCC = frag.cc;\n        }\n        let textTracks = this.textTracks,\n          hls = this.hls;\n\n        // Parse the WebVTT file contents.\n        WebVTTParser.parse(payload, this.initPTS, vttCCs, frag.cc, function (cues) {\n            const currentTrack = textTracks[frag.trackId];\n            // Add cues and trigger event with success true.\n            cues.forEach(cue => {\n              // Sometimes there are cue overlaps on segmented vtts so the same\n              // cue can appear more than once in different vtt files.\n              // This avoid showing duplicated cues with same timecode and text.\n              if (!currentTrack.cues.getCueById(cue.id)) {\n                currentTrack.addCue(cue);\n              }\n            });\n            hls.trigger(Event.SUBTITLE_FRAG_PROCESSED, {success: true, frag: frag});\n          },\n          function (e) {\n            // Something went wrong while parsing. Trigger event with success false.\n            logger.log(`Failed to parse VTT cue: ${e}`);\n            hls.trigger(Event.SUBTITLE_FRAG_PROCESSED, {success: false, frag: frag});\n          });\n      }\n      else {\n        // In case there is no payload, finish unsuccessfully.\n        this.hls.trigger(Event.SUBTITLE_FRAG_PROCESSED, {success: false, frag: frag});\n      }\n    }\n  }\n\n  onFragParsingUserdata(data) {\n    // push all of the CEA-708 messages into the interpreter\n    // immediately. It will create the proper timestamps based on our PTS value\n    if (this.enabled && this.config.enableCEA708Captions) {\n      for (var i=0; i<data.samples.length; i++) {\n        var ccdatas = this.extractCea608Data(data.samples[i].bytes);\n        this.cea608Parser.addData(data.samples[i].pts, ccdatas);\n      }\n    }\n  }\n\n  extractCea608Data(byteArray) {\n    var count = byteArray[0] & 31;\n    var position = 2;\n    var tmpByte, ccbyte1, ccbyte2, ccValid, ccType;\n    var actualCCBytes = [];\n\n    for (var j = 0; j < count; j++) {\n      tmpByte = byteArray[position++];\n      ccbyte1 = 0x7F & byteArray[position++];\n      ccbyte2 = 0x7F & byteArray[position++];\n      ccValid = (4 & tmpByte) !== 0;\n      ccType = 3 & tmpByte;\n\n      if (ccbyte1 === 0 && ccbyte2 === 0) {\n        continue;\n      }\n\n      if (ccValid) {\n        if (ccType === 0) // || ccType === 1\n        {\n          actualCCBytes.push(ccbyte1);\n          actualCCBytes.push(ccbyte2);\n        }\n      }\n    }\n    return actualCCBytes;\n  }\n}\n\nexport default TimelineController;\n\n\n\n// WEBPACK FOOTER //\n// src/controller/timeline-controller.js","export default class AESCrypto {\n  constructor(subtle,iv) {\n    this.subtle = subtle;\n    this.aesIV = iv;\n  }\n\n  decrypt(data, key) {\n    return this.subtle.decrypt({name: 'AES-CBC', iv: this.aesIV}, key, data);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// src/crypt/aes-crypto.js","class AESDecryptor {\n  constructor() {\n    // Static after running initTable\n    this.rcon = [0x0, 0x1, 0x2, 0x4, 0x8, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36];\n    this.subMix = [new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];\n    this.invSubMix = [new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];\n    this.sBox = new Uint32Array(256);\n    this.invSBox = new Uint32Array(256);\n\n    // Changes during runtime\n    this.key = new Uint32Array(0);\n\n    this.initTable();\n  }\n\n  // Using view.getUint32() also swaps the byte order.\n  uint8ArrayToUint32Array_(arrayBuffer) {\n    let view = new DataView(arrayBuffer);\n    let newArray = new Uint32Array(4);\n    for (let i = 0; i < 4; i++) {\n      newArray[i] = view.getUint32(i * 4);\n    }\n    return newArray;\n  }\n\n  initTable() {\n    let sBox = this.sBox;\n    let invSBox = this.invSBox;\n    let subMix = this.subMix;\n    let subMix0 = subMix[0];\n    let subMix1 = subMix[1];\n    let subMix2 = subMix[2];\n    let subMix3 = subMix[3];\n    let invSubMix  = this.invSubMix;\n    let invSubMix0 = invSubMix[0];\n    let invSubMix1 = invSubMix[1];\n    let invSubMix2 = invSubMix[2];\n    let invSubMix3 = invSubMix[3];\n\n    let d = new Uint32Array(256);\n    let x = 0;\n    let xi = 0;\n    let i = 0;\n    for (i = 0; i < 256; i++) {\n      if (i < 128) {\n        d[i] = i << 1;\n      } else {\n        d[i] = (i << 1) ^ 0x11b;\n      }\n    }\n\n    for (i = 0; i < 256; i++) {\n      let sx = xi ^ (xi << 1) ^ (xi << 2) ^ (xi << 3) ^ (xi << 4);\n      sx = (sx >>> 8) ^ (sx & 0xff) ^ 0x63;\n      sBox[x] = sx;\n      invSBox[sx] = x;\n\n      // Compute multiplication\n      let x2 = d[x];\n      let x4 = d[x2];\n      let x8 = d[x4];\n\n      // Compute sub/invSub bytes, mix columns tables\n      let t = (d[sx] * 0x101) ^ (sx * 0x1010100);\n      subMix0[x] = (t << 24) | (t >>> 8);\n      subMix1[x] = (t << 16) | (t >>> 16);\n      subMix2[x] = (t << 8) | (t >>> 24);\n      subMix3[x] = t;\n\n      // Compute inv sub bytes, inv mix columns tables\n      t = (x8 * 0x1010101) ^ (x4 * 0x10001) ^ (x2 * 0x101) ^ (x * 0x1010100);\n      invSubMix0[sx] = (t << 24) | (t >>> 8);\n      invSubMix1[sx] = (t << 16) | (t >>> 16);\n      invSubMix2[sx] = (t << 8) | (t >>> 24);\n      invSubMix3[sx] = t;\n\n      // Compute next counter\n      if (!x) {\n        x = xi = 1;\n      } else {\n        x = x2 ^ d[d[d[x8 ^ x2]]];\n        xi ^= d[d[xi]];\n      }\n    }\n  }\n\n  expandKey(keyBuffer) {\n    // convert keyBuffer to Uint32Array\n    let key = this.uint8ArrayToUint32Array_(keyBuffer);\n    let sameKey = true;\n    let offset = 0;\n\n    while (offset < key.length && sameKey) {\n      sameKey = (key[offset] === this.key[offset]);\n      offset++;\n    }\n\n    if (sameKey) {\n      return;\n    }\n\n    this.key = key;\n    let keySize = this.keySize = key.length;\n\n    if (keySize !== 4 && keySize !== 6 && keySize !== 8) {\n      throw new Error('Invalid aes key size=' + keySize);\n    }\n\n    let ksRows = this.ksRows = (keySize + 6 + 1) * 4;\n    let ksRow;\n    let invKsRow;\n\n    let keySchedule = this.keySchedule = new Uint32Array(ksRows);\n    let invKeySchedule = this.invKeySchedule = new Uint32Array(ksRows);\n    let sbox = this.sBox;\n    let rcon = this.rcon;\n\n    let invSubMix  = this.invSubMix;\n    let invSubMix0 = invSubMix[0];\n    let invSubMix1 = invSubMix[1];\n    let invSubMix2 = invSubMix[2];\n    let invSubMix3 = invSubMix[3];\n\n    let prev;\n    let t;\n\n    for (ksRow = 0; ksRow < ksRows; ksRow++) {\n      if (ksRow < keySize) {\n        prev = keySchedule[ksRow] = key[ksRow];\n        continue;\n      }\n      t = prev;\n\n      if (ksRow % keySize === 0) {\n        // Rot word\n        t = (t << 8) | (t >>> 24);\n\n        // Sub word\n        t = (sbox[t >>> 24] << 24) | (sbox[(t >>> 16) & 0xff] << 16) | (sbox[(t >>> 8) & 0xff] << 8) | sbox[t & 0xff];\n\n        // Mix Rcon\n        t ^= rcon[(ksRow / keySize) | 0] << 24;\n      } else if (keySize > 6 && ksRow % keySize === 4)  {\n        // Sub word\n        t = (sbox[t >>> 24] << 24) | (sbox[(t >>> 16) & 0xff] << 16) | (sbox[(t >>> 8) & 0xff] << 8) | sbox[t & 0xff];\n      }\n\n      keySchedule[ksRow] = prev = (keySchedule[ksRow - keySize] ^ t) >>> 0;\n    }\n\n    for (invKsRow = 0; invKsRow < ksRows; invKsRow++) {\n      ksRow = ksRows - invKsRow;\n      if (invKsRow & 3) {\n        t = keySchedule[ksRow];\n      } else {\n        t = keySchedule[ksRow - 4];\n      }\n\n      if (invKsRow < 4 || ksRow <= 4) {\n        invKeySchedule[invKsRow] = t;\n      } else {\n        invKeySchedule[invKsRow] = invSubMix0[sbox[t >>> 24]] ^ invSubMix1[sbox[(t >>> 16) & 0xff]] ^ invSubMix2[sbox[(t >>> 8) & 0xff]] ^ invSubMix3[sbox[t & 0xff]];\n      }\n\n      invKeySchedule[invKsRow] = invKeySchedule[invKsRow] >>> 0;\n    }\n  }\n\n  // Adding this as a method greatly improves performance.\n  networkToHostOrderSwap(word) {\n    return (word << 24) | ((word & 0xff00) << 8) | ((word & 0xff0000) >> 8) | (word >>> 24);\n  }\n\n  decrypt(inputArrayBuffer, offset, aesIV) {\n    let nRounds = this.keySize + 6;\n    let invKeySchedule = this.invKeySchedule;\n    let invSBOX = this.invSBox;\n\n    let invSubMix  = this.invSubMix;\n    let invSubMix0 = invSubMix[0];\n    let invSubMix1 = invSubMix[1];\n    let invSubMix2 = invSubMix[2];\n    let invSubMix3 = invSubMix[3];\n\n    let initVector = this.uint8ArrayToUint32Array_(aesIV);\n    let initVector0 = initVector[0];\n    let initVector1 = initVector[1];\n    let initVector2 = initVector[2];\n    let initVector3 = initVector[3];\n\n    let inputInt32 = new Int32Array(inputArrayBuffer);\n    let outputInt32 = new Int32Array(inputInt32.length);\n\n    let t0, t1, t2, t3;\n    let s0, s1, s2, s3;\n    let inputWords0, inputWords1, inputWords2, inputWords3;\n\n    var ksRow, i;\n    let swapWord = this.networkToHostOrderSwap;\n\n    while (offset < inputInt32.length) {\n      inputWords0 = swapWord(inputInt32[offset]);\n      inputWords1 = swapWord(inputInt32[offset + 1]);\n      inputWords2 = swapWord(inputInt32[offset + 2]);\n      inputWords3 = swapWord(inputInt32[offset + 3]);\n\n      s0 = inputWords0 ^ invKeySchedule[0];\n      s1 = inputWords3 ^ invKeySchedule[1];\n      s2 = inputWords2 ^ invKeySchedule[2];\n      s3 = inputWords1 ^ invKeySchedule[3];\n\n      ksRow = 4;\n\n      // Iterate through the rounds of decryption\n      for (i = 1; i < nRounds; i++) {\n        t0 = invSubMix0[s0 >>> 24] ^ invSubMix1[(s1 >> 16) & 0xff] ^ invSubMix2[(s2 >> 8) & 0xff] ^ invSubMix3[s3 & 0xff] ^ invKeySchedule[ksRow];\n        t1 = invSubMix0[s1 >>> 24] ^ invSubMix1[(s2 >> 16) & 0xff] ^ invSubMix2[(s3 >> 8) & 0xff] ^ invSubMix3[s0 & 0xff] ^ invKeySchedule[ksRow + 1];\n        t2 = invSubMix0[s2 >>> 24] ^ invSubMix1[(s3 >> 16) & 0xff] ^ invSubMix2[(s0 >> 8) & 0xff] ^ invSubMix3[s1 & 0xff] ^ invKeySchedule[ksRow + 2];\n        t3 = invSubMix0[s3 >>> 24] ^ invSubMix1[(s0 >> 16) & 0xff] ^ invSubMix2[(s1 >> 8) & 0xff] ^ invSubMix3[s2 & 0xff] ^ invKeySchedule[ksRow + 3];\n        // Update state\n        s0 = t0;\n        s1 = t1;\n        s2 = t2;\n        s3 = t3;\n\n        ksRow = ksRow + 4;\n      }\n\n      // Shift rows, sub bytes, add round key\n      t0 = ((invSBOX[s0 >>> 24] << 24) ^ (invSBOX[(s1 >> 16) & 0xff] << 16) ^ (invSBOX[(s2 >> 8) & 0xff] << 8) ^ invSBOX[s3 & 0xff]) ^ invKeySchedule[ksRow];\n      t1 = ((invSBOX[s1 >>> 24] << 24) ^ (invSBOX[(s2 >> 16) & 0xff] << 16) ^ (invSBOX[(s3 >> 8) & 0xff] << 8) ^ invSBOX[s0 & 0xff]) ^ invKeySchedule[ksRow + 1];\n      t2 = ((invSBOX[s2 >>> 24] << 24) ^ (invSBOX[(s3 >> 16) & 0xff] << 16) ^ (invSBOX[(s0 >> 8) & 0xff] << 8) ^ invSBOX[s1 & 0xff]) ^ invKeySchedule[ksRow + 2];\n      t3 = ((invSBOX[s3 >>> 24] << 24) ^ (invSBOX[(s0 >> 16) & 0xff] << 16) ^ (invSBOX[(s1 >> 8) & 0xff] << 8) ^ invSBOX[s2 & 0xff]) ^ invKeySchedule[ksRow + 3];\n      ksRow = ksRow + 3;\n\n      // Write\n      outputInt32[offset] = swapWord(t0 ^ initVector0);\n      outputInt32[offset + 1] = swapWord(t3 ^ initVector1);\n      outputInt32[offset + 2] = swapWord(t2 ^ initVector2);\n      outputInt32[offset + 3] = swapWord(t1 ^ initVector3);\n\n      // reset initVector to last 4 unsigned int\n      initVector0 = inputWords0;\n      initVector1 = inputWords1;\n      initVector2 = inputWords2;\n      initVector3 = inputWords3;\n\n      offset = offset + 4;\n    }\n\n    return outputInt32.buffer;\n  }\n\n  destroy() {\n    this.key = undefined;\n    this.keySize = undefined;\n    this.ksRows = undefined;\n\n    this.sBox = undefined;\n    this.invSBox = undefined;\n    this.subMix = undefined;\n    this.invSubMix = undefined;\n    this.keySchedule = undefined;\n    this.invKeySchedule = undefined;\n\n    this.rcon = undefined;\n  }\n}\n\nexport default AESDecryptor;\n\n\n\n// WEBPACK FOOTER //\n// src/crypt/aes-decryptor.js","import AESCrypto from './aes-crypto';\nimport FastAESKey from './fast-aes-key';\nimport AESDecryptor from './aes-decryptor';\n\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport {logger} from '../utils/logger';\n\n/*globals self: false */\n\nclass Decrypter {\n  constructor(observer,config) {\n    this.observer = observer;\n    this.config = config;\n    this.logEnabled = true;\n    try {\n      const browserCrypto = crypto ? crypto : self.crypto;\n      this.subtle = browserCrypto.subtle || browserCrypto.webkitSubtle;\n    } catch (e) {}\n    this.disableWebCrypto = !this.subtle;\n  }\n\n  isSync() {\n    return (this.disableWebCrypto && this.config.enableSoftwareAES);\n  }\n\n  decrypt(data, key, iv, callback) {\n    if (this.disableWebCrypto && this.config.enableSoftwareAES) {\n      if (this.logEnabled) {\n        logger.log('JS AES decrypt');\n        this.logEnabled = false;\n      }\n      let decryptor = this.decryptor;\n      if (!decryptor) {\n        this.decryptor = decryptor = new AESDecryptor();\n      }\n      decryptor.expandKey(key);\n      callback(decryptor.decrypt(data, 0, iv));\n    }\n    else {\n      if (this.logEnabled) {\n        logger.log('WebCrypto AES decrypt');\n        this.logEnabled = false;\n      }\n      const subtle = this.subtle;\n      if (this.key !== key) {\n        this.key = key;\n        this.fastAesKey = new FastAESKey(subtle,key);\n      }\n\n      this.fastAesKey.expandKey().\n        then((aesKey) => {\n          // decrypt using web crypto\n          let crypto = new AESCrypto(subtle,iv);\n          crypto.decrypt(data, aesKey).\n          catch ((err) => {\n            this.onWebCryptoError(err, data, key, iv, callback);\n          }).\n          then((result) => {\n            callback(result);\n          });\n        }).\n        catch ((err) => {\n          this.onWebCryptoError(err, data, key, iv, callback);\n        });\n    }\n  }\n\n  onWebCryptoError(err, data, key, iv, callback) {\n    if (this.config.enableSoftwareAES) {\n      logger.log('WebCrypto Error, disable WebCrypto API');\n      this.disableWebCrypto = true;\n      this.logEnabled = true;\n      this.decrypt(data, key, iv, callback);\n    }\n    else {\n      logger.error(`decrypting error : ${err.message}`);\n      this.observer.trigger(Event.ERROR, {type : ErrorTypes.MEDIA_ERROR, details : ErrorDetails.FRAG_DECRYPT_ERROR, fatal : true, reason : err.message});\n    }\n  }\n\n  destroy() {\n    let decryptor = this.decryptor;\n    if (decryptor) {\n      decryptor.destroy();\n      this.decryptor = undefined;\n    }\n  }\n}\n\nexport default Decrypter;\n\n\n\n// WEBPACK FOOTER //\n// src/crypt/decrypter.js","class FastAESKey {\n  constructor(subtle,key) {\n    this.subtle = subtle;\n    this.key = key;\n  }\n\n  expandKey() {\n    return this.subtle.importKey('raw', this.key, {name: 'AES-CBC'}, false, ['encrypt', 'decrypt']);\n  }\n}\n\nexport default FastAESKey;\n\n\n\n// WEBPACK FOOTER //\n// src/crypt/fast-aes-key.js","/**\n * AAC demuxer\n */\nimport ADTS from './adts';\nimport {logger} from '../utils/logger';\nimport ID3 from '../demux/id3';\n\n class AACDemuxer {\n\n  constructor(observer, remuxer, config) {\n    this.observer = observer;\n    this.config = config;\n    this.remuxer = remuxer;\n  }\n\n  resetInitSegment(initSegment,audioCodec,videoCodec, duration) {\n    this._audioTrack = {container : 'audio/adts', type: 'audio', id :-1, sequenceNumber: 0, isAAC : true , samples : [], len : 0, manifestCodec : audioCodec, duration : duration, inputTimeScale : 90000};\n  }\n\n  resetTimeStamp() {\n  }\n\n  static probe(data) {\n    // check if data contains ID3 timestamp and ADTS sync word\n    var id3 = new ID3(data), offset, length;\n    if(id3.hasTimeStamp) {\n      // Look for ADTS header | 1111 1111 | 1111 X00X | where X can be either 0 or 1\n      // Layer bits (position 14 and 15) in header should be always 0 for ADTS\n      // More info https://wiki.multimedia.cx/index.php?title=ADTS\n      for (offset = id3.length, length = Math.min(data.length - 1, offset + 100); offset < length; offset++) {\n        if ((data[offset] === 0xff) && (data[offset+1] & 0xf6) === 0xf0) {\n          //logger.log('ADTS sync word found !');\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n\n  // feed incoming data to the front of the parsing pipeline\n  append(data, timeOffset, contiguous,accurateTimeOffset) {\n    var track,\n        id3 = new ID3(data),\n        pts = 90*id3.timeStamp,\n        config, frameLength, frameDuration, frameIndex, offset, headerLength, stamp, length, aacSample;\n\n    track = this._audioTrack;\n\n    // Look for ADTS header\n    for (offset = id3.length, length = data.length; offset < length - 1; offset++) {\n      if ((data[offset] === 0xff) && (data[offset+1] & 0xf6) === 0xf0) {\n        break;\n      }\n    }\n\n    if (!track.samplerate) {\n      config = ADTS.getAudioConfig(this.observer,data, offset, track.manifestCodec);\n      track.config = config.config;\n      track.samplerate = config.samplerate;\n      track.channelCount = config.channelCount;\n      track.codec = config.codec;\n      logger.log(`parsed codec:${track.codec},rate:${config.samplerate},nb channel:${config.channelCount}`);\n    }\n    frameIndex = 0;\n    frameDuration = 1024 * 90000 / track.samplerate;\n    while ((offset + 5) < length) {\n      // The protection skip bit tells us if we have 2 bytes of CRC data at the end of the ADTS header\n      headerLength = (!!(data[offset + 1] & 0x01) ? 7 : 9);\n      // retrieve frame size\n      frameLength = ((data[offset + 3] & 0x03) << 11) |\n                     (data[offset + 4] << 3) |\n                    ((data[offset + 5] & 0xE0) >>> 5);\n      frameLength  -= headerLength;\n      //stamp = pes.pts;\n\n      if ((frameLength > 0) && ((offset + headerLength + frameLength) <= length)) {\n        stamp = pts + frameIndex * frameDuration;\n        //logger.log(`AAC frame, offset/length/total/pts:${offset+headerLength}/${frameLength}/${data.byteLength}/${(stamp/90).toFixed(0)}`);\n        aacSample = {unit: data.subarray(offset + headerLength, offset + headerLength + frameLength), pts: stamp, dts: stamp};\n        track.samples.push(aacSample);\n        track.len += frameLength;\n        offset += frameLength + headerLength;\n        frameIndex++;\n        // look for ADTS header (0xFFFx)\n        for ( ; offset < (length - 1); offset++) {\n          if ((data[offset] === 0xff) && ((data[offset + 1] & 0xf6) === 0xf0)) {\n            break;\n          }\n        }\n      } else {\n        break;\n      }\n    }\n    this.remuxer.remux(track,\n                        {samples : []},\n                        {samples : [ { pts: pts, dts : pts, data : id3.payload}], inputTimeScale : 90000},\n                        {samples : []},\n                        timeOffset,\n                        contiguous,\n                        accurateTimeOffset);\n  }\n\n  destroy() {\n  }\n\n}\n\nexport default AACDemuxer;\n\n\n\n// WEBPACK FOOTER //\n// src/demux/aacdemuxer.js","/**\n *  ADTS parser helper\n */\nimport {logger} from '../utils/logger';\nimport {ErrorTypes, ErrorDetails} from '../errors';\n\n const ADTS = {\n  getAudioConfig : function(observer, data, offset, audioCodec) {\n    var adtsObjectType, // :int\n        adtsSampleingIndex, // :int\n        adtsExtensionSampleingIndex, // :int\n        adtsChanelConfig, // :int\n        config,\n        userAgent = navigator.userAgent.toLowerCase(),\n        manifestCodec = audioCodec,\n        adtsSampleingRates = [\n            96000, 88200,\n            64000, 48000,\n            44100, 32000,\n            24000, 22050,\n            16000, 12000,\n            11025, 8000,\n            7350];\n    // byte 2\n    adtsObjectType = ((data[offset + 2] & 0xC0) >>> 6) + 1;\n    adtsSampleingIndex = ((data[offset + 2] & 0x3C) >>> 2);\n    if(adtsSampleingIndex > adtsSampleingRates.length-1) {\n      observer.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: true, reason: `invalid ADTS sampling index:${adtsSampleingIndex}`});\n      return;\n    }\n    adtsChanelConfig = ((data[offset + 2] & 0x01) << 2);\n    // byte 3\n    adtsChanelConfig |= ((data[offset + 3] & 0xC0) >>> 6);\n    logger.log(`manifest codec:${audioCodec},ADTS data:type:${adtsObjectType},sampleingIndex:${adtsSampleingIndex}[${adtsSampleingRates[adtsSampleingIndex]}Hz],channelConfig:${adtsChanelConfig}`);\n    // firefox: freq less than 24kHz = AAC SBR (HE-AAC)\n    if (/firefox/i.test(userAgent)) {\n      if (adtsSampleingIndex >= 6) {\n        adtsObjectType = 5;\n        config = new Array(4);\n        // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n        // there is a factor 2 between frame sample rate and output sample rate\n        // multiply frequency by 2 (see table below, equivalent to substract 3)\n        adtsExtensionSampleingIndex = adtsSampleingIndex - 3;\n      } else {\n        adtsObjectType = 2;\n        config = new Array(2);\n        adtsExtensionSampleingIndex = adtsSampleingIndex;\n      }\n      // Android : always use AAC\n    } else if (userAgent.indexOf('android') !== -1) {\n      adtsObjectType = 2;\n      config = new Array(2);\n      adtsExtensionSampleingIndex = adtsSampleingIndex;\n    } else {\n      /*  for other browsers (Chrome/Vivaldi/Opera ...)\n          always force audio type to be HE-AAC SBR, as some browsers do not support audio codec switch properly (like Chrome ...)\n      */\n      adtsObjectType = 5;\n      config = new Array(4);\n      // if (manifest codec is HE-AAC or HE-AACv2) OR (manifest codec not specified AND frequency less than 24kHz)\n      if ((audioCodec && ((audioCodec.indexOf('mp4a.40.29') !== -1) ||\n                          (audioCodec.indexOf('mp4a.40.5') !== -1))) ||\n          (!audioCodec && adtsSampleingIndex >= 6)) {\n        // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n        // there is a factor 2 between frame sample rate and output sample rate\n        // multiply frequency by 2 (see table below, equivalent to substract 3)\n        adtsExtensionSampleingIndex = adtsSampleingIndex - 3;\n      } else {\n        // if (manifest codec is AAC) AND (frequency less than 24kHz AND nb channel is 1) OR (manifest codec not specified and mono audio)\n        // Chrome fails to play back with low frequency AAC LC mono when initialized with HE-AAC.  This is not a problem with stereo.\n        if (audioCodec && audioCodec.indexOf('mp4a.40.2') !== -1 && (adtsSampleingIndex >= 6 && adtsChanelConfig === 1) ||\n            (!audioCodec && adtsChanelConfig === 1)) {\n          adtsObjectType = 2;\n          config = new Array(2);\n        }\n        adtsExtensionSampleingIndex = adtsSampleingIndex;\n      }\n    }\n    /* refer to http://wiki.multimedia.cx/index.php?title=MPEG-4_Audio#Audio_Specific_Config\n        ISO 14496-3 (AAC).pdf - Table 1.13 — Syntax of AudioSpecificConfig()\n      Audio Profile / Audio Object Type\n      0: Null\n      1: AAC Main\n      2: AAC LC (Low Complexity)\n      3: AAC SSR (Scalable Sample Rate)\n      4: AAC LTP (Long Term Prediction)\n      5: SBR (Spectral Band Replication)\n      6: AAC Scalable\n     sampling freq\n      0: 96000 Hz\n      1: 88200 Hz\n      2: 64000 Hz\n      3: 48000 Hz\n      4: 44100 Hz\n      5: 32000 Hz\n      6: 24000 Hz\n      7: 22050 Hz\n      8: 16000 Hz\n      9: 12000 Hz\n      10: 11025 Hz\n      11: 8000 Hz\n      12: 7350 Hz\n      13: Reserved\n      14: Reserved\n      15: frequency is written explictly\n      Channel Configurations\n      These are the channel configurations:\n      0: Defined in AOT Specifc Config\n      1: 1 channel: front-center\n      2: 2 channels: front-left, front-right\n    */\n    // audioObjectType = profile => profile, the MPEG-4 Audio Object Type minus 1\n    config[0] = adtsObjectType << 3;\n    // samplingFrequencyIndex\n    config[0] |= (adtsSampleingIndex & 0x0E) >> 1;\n    config[1] |= (adtsSampleingIndex & 0x01) << 7;\n    // channelConfiguration\n    config[1] |= adtsChanelConfig << 3;\n    if (adtsObjectType === 5) {\n      // adtsExtensionSampleingIndex\n      config[1] |= (adtsExtensionSampleingIndex & 0x0E) >> 1;\n      config[2] = (adtsExtensionSampleingIndex & 0x01) << 7;\n      // adtsObjectType (force to 2, chrome is checking that object type is less than 5 ???\n      //    https://chromium.googlesource.com/chromium/src.git/+/master/media/formats/mp4/aac.cc\n      config[2] |= 2 << 2;\n      config[3] = 0;\n    }\n    return {config: config, samplerate: adtsSampleingRates[adtsSampleingIndex], channelCount: adtsChanelConfig, codec: ('mp4a.40.' + adtsObjectType), manifestCodec : manifestCodec};\n  }\n};\n\nmodule.exports = ADTS;\n\n\n\n// WEBPACK FOOTER //\n// src/demux/adts.js","/*  inline demuxer.\n *   probe fragments and instantiate appropriate demuxer depending on content type (TSDemuxer, AACDemuxer, ...)\n */\n\nimport Event from '../events';\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport Decrypter from '../crypt/decrypter';\nimport AACDemuxer from '../demux/aacdemuxer';\nimport MP4Demuxer from '../demux/mp4demuxer';\nimport TSDemuxer from '../demux/tsdemuxer';\nimport MP3Demuxer from '../demux/mp3demuxer';\nimport MP4Remuxer from '../remux/mp4-remuxer';\nimport PassThroughRemuxer from '../remux/passthrough-remuxer';\n\nclass DemuxerInline {\n\n  constructor(observer,typeSupported, config, vendor) {\n    this.observer = observer;\n    this.typeSupported = typeSupported;\n    this.config = config;\n    this.vendor = vendor;\n  }\n\n  destroy() {\n    var demuxer = this.demuxer;\n    if (demuxer) {\n      demuxer.destroy();\n    }\n  }\n\n  push(data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS) {\n    if ((data.byteLength > 0) && (decryptdata != null) && (decryptdata.key != null) && (decryptdata.method === 'AES-128')) {\n      let decrypter = this.decrypter;\n      if (decrypter == null) {\n        decrypter = this.decrypter = new Decrypter(this.observer, this.config);\n      }\n      var localthis = this;\n      // performance.now() not available on WebWorker, at least on Safari Desktop\n      var startTime;\n      try {\n        startTime = performance.now();\n      } catch(error) {\n        startTime = Date.now();\n      }\n      decrypter.decrypt(data, decryptdata.key.buffer, decryptdata.iv.buffer, function (decryptedData) {\n        var endTime;\n        try {\n          endTime = performance.now();\n        } catch(error) {\n          endTime = Date.now();\n        }\n        localthis.observer.trigger(Event.FRAG_DECRYPTED, { stats: { tstart: startTime, tdecrypt: endTime } });\n        localthis.pushDecrypted(new Uint8Array(decryptedData), decryptdata, new Uint8Array(initSegment), audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset,defaultInitPTS);\n      });\n    } else {\n      this.pushDecrypted(new Uint8Array(data), decryptdata, new Uint8Array(initSegment), audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration,accurateTimeOffset,defaultInitPTS);\n    }\n  }\n\n  pushDecrypted(data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration,accurateTimeOffset,defaultInitPTS) {\n    var demuxer = this.demuxer;\n    if (!demuxer || \n       // in case of continuity change, we might switch from content type (AAC container to TS container for example)\n       // so let's check that current demuxer is still valid\n        (discontinuity && !this.probe(data))) {\n      const observer = this.observer;\n      const typeSupported = this.typeSupported;\n      const config = this.config;\n      const muxConfig = [ {demux : TSDemuxer,  remux : MP4Remuxer},\n                          {demux : MP3Demuxer, remux : MP4Remuxer},\n                          {demux : AACDemuxer, remux : MP4Remuxer},\n                          {demux : MP4Demuxer, remux : PassThroughRemuxer}];\n\n      // probe for content type\n      for (let i in muxConfig) {\n        const mux = muxConfig[i];\n        const probe = mux.demux.probe;\n        if(probe(data)) {\n          const remuxer = this.remuxer = new mux.remux(observer,config,typeSupported, this.vendor);\n          demuxer = new mux.demux(observer,remuxer,config,typeSupported);\n          this.probe = probe;\n          break;\n        }\n      }\n      if(!demuxer) {\n        observer.trigger(Event.ERROR, {type : ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: true, reason: 'no demux matching with content found'});\n        return;\n      }\n      this.demuxer = demuxer;\n    }\n    const remuxer = this.remuxer;\n\n    if (discontinuity || trackSwitch) {\n      demuxer.resetInitSegment(initSegment,audioCodec,videoCodec,duration);\n      remuxer.resetInitSegment();\n    }\n    if (discontinuity) {\n      demuxer.resetTimeStamp();\n      remuxer.resetTimeStamp(defaultInitPTS);\n    }\n    if (typeof demuxer.setDecryptData === 'function') {\n      demuxer.setDecryptData(decryptdata);\n    }\n    demuxer.append(data,timeOffset,contiguous,accurateTimeOffset);\n  }\n}\n\nexport default DemuxerInline;\n\n\n\n// WEBPACK FOOTER //\n// src/demux/demuxer-inline.js","/* demuxer web worker.\n *  - listen to worker message, and trigger DemuxerInline upon reception of Fragments.\n *  - provides MP4 Boxes back to main thread using [transferable objects](https://developers.google.com/web/updates/2011/12/Transferable-Objects-Lightning-Fast) in order to minimize message passing overhead.\n */\n\n import DemuxerInline from '../demux/demuxer-inline';\n import Event from '../events';\n import {enableLogs} from '../utils/logger';\n import EventEmitter from 'events';\n\nvar DemuxerWorker = function (self) {\n  // observer setup\n  var observer = new EventEmitter();\n  observer.trigger = function trigger (event, ...data) {\n    observer.emit(event, event, ...data);\n  };\n\n  observer.off = function off (event, ...data) {\n    observer.removeListener(event, ...data);\n  };\n\n  var forwardMessage = function(ev,data) {\n    self.postMessage({event: ev, data:data });\n  };\n\n  self.addEventListener('message', function (ev) {\n    var data = ev.data;\n    //console.log('demuxer cmd:' + data.cmd);\n    switch (data.cmd) {\n      case 'init':\n        let config = JSON.parse(data.config);\n        self.demuxer = new DemuxerInline(observer, data.typeSupported, config, data.vendor);\n        try {\n          enableLogs(config.debug === true);\n        } catch(err) {\n          console.warn('demuxerWorker: unable to enable logs');\n        }\n        // signal end of worker init\n        forwardMessage('init',null);\n        break;\n      case 'demux':\n        self.demuxer.push(data.data, data.decryptdata, data.initSegment, data.audioCodec, data.videoCodec, data.timeOffset,data.discontinuity, data.trackSwitch,data.contiguous,data.duration,data.accurateTimeOffset,data.defaultInitPTS);\n        break;\n      default:\n        break;\n    }\n  });\n\n  // forward events to main thread\n  observer.on(Event.FRAG_DECRYPTED, forwardMessage);\n  observer.on(Event.FRAG_PARSING_INIT_SEGMENT, forwardMessage);\n  observer.on(Event.FRAG_PARSED, forwardMessage);\n  observer.on(Event.ERROR, forwardMessage);\n  observer.on(Event.FRAG_PARSING_METADATA, forwardMessage);\n  observer.on(Event.FRAG_PARSING_USERDATA, forwardMessage);\n  observer.on(Event.INIT_PTS_FOUND, forwardMessage);\n\n  // special case for FRAG_PARSING_DATA: pass data1/data2 as transferable object (no copy)\n  observer.on(Event.FRAG_PARSING_DATA, function(ev, data) {\n    let transferable = [];\n    let message = {event: ev, data:data};\n    if (data.data1) {\n      message.data1 = data.data1.buffer;\n      transferable.push(data.data1.buffer);\n      delete data.data1;\n    }\n    if (data.data2) {\n      message.data2 = data.data2.buffer;\n      transferable.push(data.data2.buffer);\n      delete data.data2;\n    }\n    self.postMessage(message,transferable);\n  });\n};\n\nexport default DemuxerWorker;\n\n\n\n\n// WEBPACK FOOTER //\n// src/demux/demuxer-worker.js","import Event from '../events';\nimport DemuxerInline from '../demux/demuxer-inline';\nimport DemuxerWorker from '../demux/demuxer-worker';\nimport {logger} from '../utils/logger';\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport EventEmitter from 'events';\n\nclass Demuxer {\n\n  constructor(hls, id) {\n    this.hls = hls;\n    this.id = id;\n    // observer setup\n    const observer = this.observer = new EventEmitter();\n    const config = hls.config;\n    observer.trigger = function trigger (event, ...data) {\n      observer.emit(event, event, ...data);\n    };\n\n    observer.off = function off (event, ...data) {\n      observer.removeListener(event, ...data);\n    };\n\n    var forwardMessage = function(ev,data) {\n      data = data || {};\n      data.frag = this.frag;\n      data.id = this.id;\n      hls.trigger(ev,data);\n    }.bind(this);\n\n    // forward events to main thread\n    observer.on(Event.FRAG_DECRYPTED, forwardMessage);\n    observer.on(Event.FRAG_PARSING_INIT_SEGMENT, forwardMessage);\n    observer.on(Event.FRAG_PARSING_DATA, forwardMessage);\n    observer.on(Event.FRAG_PARSED, forwardMessage);\n    observer.on(Event.ERROR, forwardMessage);\n    observer.on(Event.FRAG_PARSING_METADATA, forwardMessage);\n    observer.on(Event.FRAG_PARSING_USERDATA, forwardMessage);\n    observer.on(Event.INIT_PTS_FOUND, forwardMessage);\n\n    const typeSupported = {\n      mp4 : MediaSource.isTypeSupported('video/mp4'),\n      mpeg: MediaSource.isTypeSupported('audio/mpeg'),\n      mp3: MediaSource.isTypeSupported('audio/mp4; codecs=\"mp3\"')\n    };\n    // navigator.vendor is not always available in Web Worker\n    // refer to https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope/navigator\n    const vendor = navigator.vendor;\n    if (config.enableWorker && (typeof(Worker) !== 'undefined')) {\n        logger.log('demuxing in webworker');\n        let w;\n        try {\n          let work = require('webworkify');\n          w = this.w = work(DemuxerWorker);\n          this.onwmsg = this.onWorkerMessage.bind(this);\n          w.addEventListener('message', this.onwmsg);\n          w.onerror = function(event) { hls.trigger(Event.ERROR, {type: ErrorTypes.OTHER_ERROR, details: ErrorDetails.INTERNAL_EXCEPTION, fatal: true, event : 'demuxerWorker', err : { message : event.message + ' (' + event.filename + ':' + event.lineno + ')' }});};\n          w.postMessage({cmd: 'init', typeSupported : typeSupported, vendor : vendor, id : id, config: JSON.stringify(config)});\n        } catch(err) {\n          logger.error('error while initializing DemuxerWorker, fallback on DemuxerInline');\n          if (w) {\n            // revoke the Object URL that was used to create demuxer worker, so as not to leak it\n            URL.revokeObjectURL(w.objectURL);\n          }\n          this.demuxer = new DemuxerInline(observer,typeSupported,config,vendor);\n          this.w = undefined;\n        }\n      } else {\n        this.demuxer = new DemuxerInline(observer,typeSupported,config, vendor);\n      }\n  }\n\n  destroy() {\n    let w = this.w;\n    if (w) {\n      w.removeEventListener('message', this.onwmsg);\n      w.terminate();\n      this.w = null;\n    } else {\n      let demuxer = this.demuxer;\n      if (demuxer) {\n        demuxer.destroy();\n        this.demuxer = null;\n      }\n    }\n    let observer = this.observer;\n    if (observer) {\n      observer.removeAllListeners();\n      this.observer = null;\n    }\n  }\n\n  push(data, initSegment, audioCodec, videoCodec, frag, duration,accurateTimeOffset,defaultInitPTS) {\n    const w = this.w;\n    const timeOffset = !isNaN(frag.startDTS) ? frag.startDTS  : frag.start;\n    const decryptdata = frag.decryptdata;\n    const lastFrag = this.frag;\n    const discontinuity = !(lastFrag && (frag.cc === lastFrag.cc));\n    const trackSwitch = !(lastFrag && (frag.level === lastFrag.level));\n    const nextSN = lastFrag && (frag.sn === (lastFrag.sn+1));\n    const contiguous = !trackSwitch && nextSN;\n    if (discontinuity) {\n      logger.log(`${this.id}:discontinuity detected`);\n    }\n    if (trackSwitch) {\n      logger.log(`${this.id}:switch detected`);\n    }\n    this.frag = frag;\n    if (w) {\n      // post fragment payload as transferable objects (no copy)\n      w.postMessage({cmd: 'demux', data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset,defaultInitPTS}, [data]);\n    } else {\n      let demuxer = this.demuxer;\n      if (demuxer) {\n        demuxer.push(data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset,defaultInitPTS);\n      }\n    }\n  }\n\n  onWorkerMessage(ev) {\n    let data = ev.data,\n        hls = this.hls;\n    //console.log('onWorkerMessage:' + data.event);\n    switch(data.event) {\n      case 'init':\n        // revoke the Object URL that was used to create demuxer worker, so as not to leak it\n        URL.revokeObjectURL(this.w.objectURL);\n        break;\n      // special case for FRAG_PARSING_DATA: data1 and data2 are transferable objects\n      case Event.FRAG_PARSING_DATA:\n        data.data.data1 = new Uint8Array(data.data1);\n        if (data.data2) {\n          data.data.data2 = new Uint8Array(data.data2);\n        }\n        /* falls through */\n      default:\n        data.data = data.data || {};\n        data.data.frag = this.frag;\n        data.data.id = this.id;\n        hls.trigger(data.event, data.data);\n        break;\n    }\n  }\n}\n\nexport default Demuxer;\n\n\n\n\n// WEBPACK FOOTER //\n// src/demux/demuxer.js","/**\n * Parser for exponential Golomb codes, a variable-bitwidth number encoding scheme used by h264.\n*/\n\nimport {logger} from '../utils/logger';\n\nclass ExpGolomb {\n\n  constructor(data) {\n    this.data = data;\n    // the number of bytes left to examine in this.data\n    this.bytesAvailable = data.byteLength;\n    // the current word being examined\n    this.word = 0; // :uint\n    // the number of bits left to examine in the current word\n    this.bitsAvailable = 0; // :uint\n  }\n\n  // ():void\n  loadWord() {\n    var\n      data = this.data,\n      bytesAvailable = this.bytesAvailable,\n      position = data.byteLength - bytesAvailable,\n      workingBytes = new Uint8Array(4),\n      availableBytes = Math.min(4, bytesAvailable);\n    if (availableBytes === 0) {\n      throw new Error('no bytes available');\n    }\n    workingBytes.set(data.subarray(position, position + availableBytes));\n    this.word = new DataView(workingBytes.buffer).getUint32(0);\n    // track the amount of this.data that has been processed\n    this.bitsAvailable = availableBytes * 8;\n    this.bytesAvailable -= availableBytes;\n  }\n\n  // (count:int):void\n  skipBits(count) {\n    var skipBytes; // :int\n    if (this.bitsAvailable > count) {\n      this.word <<= count;\n      this.bitsAvailable -= count;\n    } else {\n      count -= this.bitsAvailable;\n      skipBytes = count >> 3;\n      count -= (skipBytes >> 3);\n      this.bytesAvailable -= skipBytes;\n      this.loadWord();\n      this.word <<= count;\n      this.bitsAvailable -= count;\n    }\n  }\n\n  // (size:int):uint\n  readBits(size) {\n    var\n      bits = Math.min(this.bitsAvailable, size), // :uint\n      valu = this.word >>> (32 - bits); // :uint\n    if (size > 32) {\n      logger.error('Cannot read more than 32 bits at a time');\n    }\n    this.bitsAvailable -= bits;\n    if (this.bitsAvailable > 0) {\n      this.word <<= bits;\n    } else if (this.bytesAvailable > 0) {\n      this.loadWord();\n    }\n    bits = size - bits;\n    if (bits > 0 && this.bitsAvailable) {\n      return valu << bits | this.readBits(bits);\n    } else {\n      return valu;\n    }\n  }\n\n  // ():uint\n  skipLZ() {\n    var leadingZeroCount; // :uint\n    for (leadingZeroCount = 0; leadingZeroCount < this.bitsAvailable; ++leadingZeroCount) {\n      if (0 !== (this.word & (0x80000000 >>> leadingZeroCount))) {\n        // the first bit of working word is 1\n        this.word <<= leadingZeroCount;\n        this.bitsAvailable -= leadingZeroCount;\n        return leadingZeroCount;\n      }\n    }\n    // we exhausted word and still have not found a 1\n    this.loadWord();\n    return leadingZeroCount + this.skipLZ();\n  }\n\n  // ():void\n  skipUEG() {\n    this.skipBits(1 + this.skipLZ());\n  }\n\n  // ():void\n  skipEG() {\n    this.skipBits(1 + this.skipLZ());\n  }\n\n  // ():uint\n  readUEG() {\n    var clz = this.skipLZ(); // :uint\n    return this.readBits(clz + 1) - 1;\n  }\n\n  // ():int\n  readEG() {\n    var valu = this.readUEG(); // :int\n    if (0x01 & valu) {\n      // the number is odd if the low order bit is set\n      return (1 + valu) >>> 1; // add 1 to make it even, and divide by 2\n    } else {\n      return -1 * (valu >>> 1); // divide by two then make it negative\n    }\n  }\n\n  // Some convenience functions\n  // :Boolean\n  readBoolean() {\n    return 1 === this.readBits(1);\n  }\n\n  // ():int\n  readUByte() {\n    return this.readBits(8);\n  }\n\n  // ():int\n  readUShort() {\n    return this.readBits(16);\n  }\n    // ():int\n  readUInt() {\n    return this.readBits(32);\n  }\n\n  /**\n   * Advance the ExpGolomb decoder past a scaling list. The scaling\n   * list is optionally transmitted as part of a sequence parameter\n   * set and is not relevant to transmuxing.\n   * @param count {number} the number of entries in this scaling list\n   * @see Recommendation ITU-T H.264, Section 7.3.2.1.1.1\n   */\n  skipScalingList(count) {\n    var\n      lastScale = 8,\n      nextScale = 8,\n      j,\n      deltaScale;\n    for (j = 0; j < count; j++) {\n      if (nextScale !== 0) {\n        deltaScale = this.readEG();\n        nextScale = (lastScale + deltaScale + 256) % 256;\n      }\n      lastScale = (nextScale === 0) ? lastScale : nextScale;\n    }\n  }\n\n  /**\n   * Read a sequence parameter set and return some interesting video\n   * properties. A sequence parameter set is the H264 metadata that\n   * describes the properties of upcoming video frames.\n   * @param data {Uint8Array} the bytes of a sequence parameter set\n   * @return {object} an object with configuration parsed from the\n   * sequence parameter set, including the dimensions of the\n   * associated video frames.\n   */\n  readSPS() {\n    var\n      frameCropLeftOffset = 0,\n      frameCropRightOffset = 0,\n      frameCropTopOffset = 0,\n      frameCropBottomOffset = 0,\n      profileIdc,profileCompat,levelIdc,\n      numRefFramesInPicOrderCntCycle, picWidthInMbsMinus1,\n      picHeightInMapUnitsMinus1,\n      frameMbsOnlyFlag,\n      scalingListCount,\n      i,\n      readUByte = this.readUByte.bind(this),\n      readBits = this.readBits.bind(this),\n      readUEG = this.readUEG.bind(this),\n      readBoolean = this.readBoolean.bind(this),\n      skipBits = this.skipBits.bind(this),\n      skipEG = this.skipEG.bind(this),\n      skipUEG = this.skipUEG.bind(this),\n      skipScalingList = this.skipScalingList.bind(this);\n\n    readUByte();\n    profileIdc = readUByte(); // profile_idc\n    profileCompat = readBits(5); // constraint_set[0-4]_flag, u(5)\n    skipBits(3); // reserved_zero_3bits u(3),\n    levelIdc = readUByte(); //level_idc u(8)\n    skipUEG(); // seq_parameter_set_id\n    // some profiles have more optional data we don't need\n    if (profileIdc === 100 ||\n        profileIdc === 110 ||\n        profileIdc === 122 ||\n        profileIdc === 244 ||\n        profileIdc === 44  ||\n        profileIdc === 83  ||\n        profileIdc === 86  ||\n        profileIdc === 118 ||\n        profileIdc === 128) {\n      var chromaFormatIdc = readUEG();\n      if (chromaFormatIdc === 3) {\n        skipBits(1); // separate_colour_plane_flag\n      }\n      skipUEG(); // bit_depth_luma_minus8\n      skipUEG(); // bit_depth_chroma_minus8\n      skipBits(1); // qpprime_y_zero_transform_bypass_flag\n      if (readBoolean()) { // seq_scaling_matrix_present_flag\n        scalingListCount = (chromaFormatIdc !== 3) ? 8 : 12;\n        for (i = 0; i < scalingListCount; i++) {\n          if (readBoolean()) { // seq_scaling_list_present_flag[ i ]\n            if (i < 6) {\n              skipScalingList(16);\n            } else {\n              skipScalingList(64);\n            }\n          }\n        }\n      }\n    }\n    skipUEG(); // log2_max_frame_num_minus4\n    var picOrderCntType = readUEG();\n    if (picOrderCntType === 0) {\n      readUEG(); //log2_max_pic_order_cnt_lsb_minus4\n    } else if (picOrderCntType === 1) {\n      skipBits(1); // delta_pic_order_always_zero_flag\n      skipEG(); // offset_for_non_ref_pic\n      skipEG(); // offset_for_top_to_bottom_field\n      numRefFramesInPicOrderCntCycle = readUEG();\n      for(i = 0; i < numRefFramesInPicOrderCntCycle; i++) {\n        skipEG(); // offset_for_ref_frame[ i ]\n      }\n    }\n    skipUEG(); // max_num_ref_frames\n    skipBits(1); // gaps_in_frame_num_value_allowed_flag\n    picWidthInMbsMinus1 = readUEG();\n    picHeightInMapUnitsMinus1 = readUEG();\n    frameMbsOnlyFlag = readBits(1);\n    if (frameMbsOnlyFlag === 0) {\n      skipBits(1); // mb_adaptive_frame_field_flag\n    }\n    skipBits(1); // direct_8x8_inference_flag\n    if (readBoolean()) { // frame_cropping_flag\n      frameCropLeftOffset = readUEG();\n      frameCropRightOffset = readUEG();\n      frameCropTopOffset = readUEG();\n      frameCropBottomOffset = readUEG();\n    }\n    let pixelRatio = [1,1];\n    if (readBoolean()) {\n      // vui_parameters_present_flag\n      if (readBoolean()) {\n        // aspect_ratio_info_present_flag\n        const aspectRatioIdc = readUByte();\n        switch (aspectRatioIdc) {\n          case 1: pixelRatio = [1,1]; break;\n          case 2: pixelRatio = [12,11]; break;\n          case 3: pixelRatio = [10,11]; break;\n          case 4: pixelRatio = [16,11]; break;\n          case 5: pixelRatio = [40,33]; break;\n          case 6: pixelRatio = [24,11]; break;\n          case 7: pixelRatio = [20,11]; break;\n          case 8: pixelRatio = [32,11]; break;\n          case 9: pixelRatio = [80,33]; break;\n          case 10: pixelRatio = [18,11]; break;\n          case 11: pixelRatio = [15,11]; break;\n          case 12: pixelRatio = [64,33]; break;\n          case 13: pixelRatio = [160,99]; break;\n          case 14: pixelRatio = [4,3]; break;\n          case 15: pixelRatio = [3,2]; break;\n          case 16: pixelRatio = [2,1]; break;\n          case 255: {\n            pixelRatio = [readUByte() << 8 | readUByte(), readUByte() << 8 | readUByte()];\n            break;\n          }\n        }\n      }\n    }\n    return {\n      width: Math.ceil((((picWidthInMbsMinus1 + 1) * 16) - frameCropLeftOffset * 2 - frameCropRightOffset * 2)),\n      height: ((2 - frameMbsOnlyFlag) * (picHeightInMapUnitsMinus1 + 1) * 16) - ((frameMbsOnlyFlag? 2 : 4) * (frameCropTopOffset + frameCropBottomOffset)),\n      pixelRatio : pixelRatio\n    };\n  }\n\n  readSliceType() {\n    // skip NALu type\n    this.readUByte();\n    // discard first_mb_in_slice\n    this.readUEG();\n    // return slice_type\n    return this.readUEG();\n  }\n}\n\nexport default ExpGolomb;\n\n\n\n// WEBPACK FOOTER //\n// src/demux/exp-golomb.js","/**\n * ID3 parser\n */\nimport {logger} from '../utils/logger';\n//import Hex from '../utils/hex';\n\n class ID3 {\n\n  constructor(data) {\n    this._hasTimeStamp = false;\n    this._length = 0;\n    var offset = 0, byte1,byte2,byte3,byte4,tagSize,endPos,header,len;\n      do {\n        header = this.readUTF(data,offset,3);\n        offset+=3;\n          // first check for ID3 header\n          if (header === 'ID3') {\n              // skip 24 bits\n              offset += 3;\n              // retrieve tag(s) length\n              byte1 = data[offset++] & 0x7f;\n              byte2 = data[offset++] & 0x7f;\n              byte3 = data[offset++] & 0x7f;\n              byte4 = data[offset++] & 0x7f;\n              tagSize = (byte1 << 21) + (byte2 << 14) + (byte3 << 7) + byte4;\n              endPos = offset + tagSize;\n              //logger.log(`ID3 tag found, size/end: ${tagSize}/${endPos}`);\n\n              // read ID3 tags\n              this._parseID3Frames(data, offset,endPos);\n              offset = endPos;\n          } else if (header === '3DI') {\n              // http://id3.org/id3v2.4.0-structure chapter 3.4.   ID3v2 footer\n              offset += 7;\n                  logger.log(`3DI footer found, end: ${offset}`);\n          } else {\n              offset -= 3;\n              len = offset;\n                  if (len) {\n                      //logger.log(`ID3 len: ${len}`);\n                      if (!this.hasTimeStamp) {\n                          logger.warn('ID3 tag found, but no timestamp');\n                      }\n                      this._length = len;\n                      this._payload = data.subarray(0,len);\n                  }\n              return;\n          }\n      } while (true);\n  }\n\n  readUTF(data,start,len) {\n\n    var result = '',offset = start, end = start + len;\n    do {\n      result += String.fromCharCode(data[offset++]);\n    } while(offset < end);\n    return result;\n  }\n\n  _parseID3Frames(data,offset,endPos) {\n    var tagId,tagLen,tagStart,tagFlags,timestamp;\n    while(offset + 8 <= endPos) {\n      tagId = this.readUTF(data,offset,4);\n      offset +=4;\n\n      tagLen = data[offset++] << 24 +\n                data[offset++] << 16 +\n                data[offset++] << 8 +\n                data[offset++];\n\n      tagFlags = data[offset++] << 8 +\n                  data[offset++];\n\n      tagStart = offset;\n      //logger.log(\"ID3 tag id:\" + tagId);\n      switch(tagId) {\n        case 'PRIV':\n            //logger.log('parse frame:' + Hex.hexDump(data.subarray(offset,endPos)));\n            // owner should be \"com.apple.streaming.transportStreamTimestamp\"\n            if (this.readUTF(data,offset,44) === 'com.apple.streaming.transportStreamTimestamp') {\n                offset+=44;\n                // smelling even better ! we found the right descriptor\n                // skip null character (string end) + 3 first bytes\n                offset+= 4;\n\n                // timestamp is 33 bit expressed as a big-endian eight-octet number, with the upper 31 bits set to zero.\n                var pts33Bit  = data[offset++] & 0x1;\n                this._hasTimeStamp = true;\n\n                timestamp = ((data[offset++] << 23) +\n                             (data[offset++] << 15) +\n                             (data[offset++] <<  7) +\n                             data[offset++]) /45;\n\n                if (pts33Bit) {\n                    timestamp   += 47721858.84; // 2^32 / 90\n                }\n                timestamp = Math.round(timestamp);\n                logger.trace(`ID3 timestamp found: ${timestamp}`);\n                this._timeStamp = timestamp;\n            }\n            break;\n        default:\n            break;\n      }\n    }\n  }\n\n  get hasTimeStamp() {\n    return this._hasTimeStamp;\n  }\n\n  get timeStamp() {\n    return this._timeStamp;\n  }\n\n  get length() {\n    return this._length;\n  }\n\n  get payload() {\n    return this._payload;\n  }\n\n}\n\nexport default ID3;\n\n\n\n\n// WEBPACK FOOTER //\n// src/demux/id3.js","/**\n * MP3 demuxer\n */\nimport ID3 from '../demux/id3';\nimport MpegAudio from './mpegaudio';\n\n class MP3Demuxer {\n\n  constructor(observer, remuxer, config) {\n    this.observer = observer;\n    this.config = config;\n    this.remuxer = remuxer;\n  }\n\n  resetInitSegment(initSegment,audioCodec,videoCodec, duration) {\n    this._audioTrack = {container : 'audio/mpeg', type: 'audio', id :-1, sequenceNumber: 0, isAAC : false , samples : [], len : 0, manifestCodec : audioCodec, duration : duration, inputTimeScale : 90000};\n  }\n\n  resetTimeStamp() {\n  }\n\n  static probe(data) {\n    // check if data contains ID3 timestamp and MPEG sync word\n    var id3 = new ID3(data), offset, length;\n    if (id3.hasTimeStamp) {\n      // Look for MPEG header | 1111 1111 | 111X XYZX | where X can be either 0 or 1 and Y or Z should be 1\n      // Layer bits (position 14 and 15) in header should be always different from 0 (Layer I or Layer II or Layer III)\n      // More info http://www.mp3-tech.org/programmer/frame_header.html\n      for (offset = id3.length, length = Math.min(data.length - 1, offset + 100); offset < length; offset++) {\n        if ((data[offset] === 0xff) && (data[offset+1] & 0xe0) === 0xe0 && (data[offset+1] & 0x06) !== 0x00) {\n          //logger.log('MPEG sync word found !');\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n\n  // feed incoming data to the front of the parsing pipeline\n  append(data, timeOffset,contiguous,accurateTimeOffset) {\n    var id3 = new ID3(data);\n    var pts = 90*id3.timeStamp;\n    var afterID3 = id3.length;\n    var offset, length;\n\n    // Look for MPEG header\n    for (offset = afterID3, length = data.length; offset < length - 1; offset++) {\n      if ((data[offset] === 0xff) && (data[offset+1] & 0xe0) === 0xe0 && (data[offset+1] & 0x06) !== 0x00) {\n        break;\n      }\n    }\n\n    MpegAudio.parse(this._audioTrack, data, id3.length, pts);\n\n    this.remuxer.remux(this._audioTrack,\n                        {samples : []},\n                        {samples : [ { pts: pts, dts : pts, data : id3.payload}], inputTimeScale : 90000},\n                        {samples : []},\n                        timeOffset,\n                        contiguous,\n                        accurateTimeOffset);\n  }\n\n  destroy() {\n  }\n}\n\nexport default MP3Demuxer;\n\n\n\n// WEBPACK FOOTER //\n// src/demux/mp3demuxer.js","/**\n * MP4 demuxer\n */\n//import {logger} from '../utils/logger';\nimport Event from '../events';\n\n\n class MP4Demuxer {\n\n  constructor(observer, remuxer) {\n    this.observer = observer;\n    this.remuxer = remuxer;\n  }\n\n  resetTimeStamp() {\n\n  }\n\n  resetInitSegment(initSegment,audioCodec,videoCodec, duration) {\n    //jshint unused:false\n    const initData = this.initData = MP4Demuxer.parseInitSegment(initSegment);\n    var tracks = {};\n    if (initData.audio) {\n      tracks.audio = { container : 'audio/mp4', codec : audioCodec, initSegment : initSegment};\n    }\n    if (initData.video) {\n      tracks.video = { container : 'video/mp4', codec : videoCodec, initSegment : initSegment};\n    }\n    this.observer.trigger(Event.FRAG_PARSING_INIT_SEGMENT,{ tracks : tracks });\n  }\n\n  static probe(data) {\n    if (data.length >= 8) {\n      const dataType = MP4Demuxer.bin2str(data.subarray(4,8));\n      return (['moof','ftyp','styp'].indexOf(dataType) >= 0);\n    }\n    return false;\n  }\n\n\n  static bin2str(buffer) {\n    return String.fromCharCode.apply(null, buffer);\n  }\n\n  static readUint32(buffer, offset) {\n    const val = buffer[offset] << 24 |\n                buffer[offset + 1] << 16 |\n                buffer[offset + 2] << 8 |\n                buffer[offset + 3];\n    return val < 0 ? 4294967296 + val : val;\n  }\n\n  // Find the data for a box specified by its path\n  static findBox(data, path) {\n    var results = [],\n        i, size, type, end, subresults;\n\n    if (!path.length) {\n      // short-circuit the search for empty paths\n      return null;\n    }\n\n    for (i = 0; i < data.byteLength;) {\n      size = MP4Demuxer.readUint32(data, i);\n      type = MP4Demuxer.bin2str(data.subarray(i + 4, i + 8));\n\n      end = size > 1 ? i + size : data.byteLength;\n\n      if (type === path[0]) {\n        if (path.length === 1) {\n          // this is the end of the path and we've found the box we were\n          // looking for\n          results.push(data.subarray(i + 8, end));\n        } else {\n          // recursively search for the next box along the path\n          subresults = MP4Demuxer.findBox(data.subarray(i + 8, end), path.slice(1));\n          if (subresults.length) {\n            results = results.concat(subresults);\n          }\n        }\n      }\n      i = end;\n    }\n\n    // we've finished searching all of data\n    return results;\n  }\n\n\n\n/**\n * Parses an MP4 initialization segment and extracts stream type and\n * timescale values for any declared tracks. Timescale values indicate the\n * number of clock ticks per second to assume for time-based values\n * elsewhere in the MP4.\n *\n * To determine the start time of an MP4, you need two pieces of\n * information: the timescale unit and the earliest base media decode\n * time. Multiple timescales can be specified within an MP4 but the\n * base media decode time is always expressed in the timescale from\n * the media header box for the track:\n * ```\n * moov > trak > mdia > mdhd.timescale\n * moov > trak > mdia > hdlr\n * ```\n * @param init {Uint8Array} the bytes of the init segment\n * @return {object} a hash of track type to timescale values or null if\n * the init segment is malformed.\n */\n  static parseInitSegment(initSegment) {\n    var result = [];\n    var traks = MP4Demuxer.findBox(initSegment, ['moov', 'trak']);\n\n    traks.forEach(trak => {\n      const tkhd = MP4Demuxer.findBox(trak, ['tkhd'])[0];\n      if (tkhd) {\n        let version = tkhd[0];\n        let index = version === 0 ? 12 : 20;\n        let trackId = MP4Demuxer.readUint32(tkhd, index);\n\n        const mdhd = MP4Demuxer.findBox(trak, ['mdia', 'mdhd'])[0];\n        if (mdhd) {\n          version = mdhd[0];\n          index = version === 0 ? 12 : 20;\n          const timescale = MP4Demuxer.readUint32(mdhd, index);\n\n          const hdlr = MP4Demuxer.findBox(trak, ['mdia', 'hdlr'])[0];\n          if (hdlr) {\n            const hdlrType = MP4Demuxer.bin2str(hdlr.subarray(8, 12));\n            let type = { 'soun' : 'audio', 'vide' : 'video'}[hdlrType];\n            if (type) {\n              result[trackId] = { timescale : timescale , type : type};\n              result[type] = { timescale : timescale , id : trackId};\n            }\n          }\n        }\n      }\n    });\n    return result;\n  }\n\n\n/**\n * Determine the base media decode start time, in seconds, for an MP4\n * fragment. If multiple fragments are specified, the earliest time is\n * returned.\n *\n * The base media decode time can be parsed from track fragment\n * metadata:\n * ```\n * moof > traf > tfdt.baseMediaDecodeTime\n * ```\n * It requires the timescale value from the mdhd to interpret.\n *\n * @param timescale {object} a hash of track ids to timescale values.\n * @return {number} the earliest base media decode start time for the\n * fragment, in seconds\n */\nstatic startDTS(initData, fragment) {\n  var trafs, baseTimes, result;\n\n  // we need info from two childrend of each track fragment box\n  trafs = MP4Demuxer.findBox(fragment, ['moof', 'traf']);\n\n  // determine the start times for each track\n  baseTimes = [].concat.apply([], trafs.map(function(traf) {\n    return MP4Demuxer.findBox(traf, ['tfhd']).map(function(tfhd) {\n      var id, scale, baseTime;\n\n      // get the track id from the tfhd\n      id = MP4Demuxer.readUint32(tfhd, 4);\n      // assume a 90kHz clock if no timescale was specified\n      scale = initData[id].timescale || 90e3;\n\n      // get the base media decode time from the tfdt\n      baseTime = MP4Demuxer.findBox(traf, ['tfdt']).map(function(tfdt) {\n        var version, result;\n\n        version = tfdt[0];\n        result = MP4Demuxer.readUint32(tfdt, 4);\n        if (version ===  1) {\n          result *= Math.pow(2, 32);\n\n          result += MP4Demuxer.readUint32(tfdt, 8);\n        }\n        return result;\n      })[0];\n      baseTime = baseTime || Infinity;\n\n      // convert base time to seconds\n      return baseTime / scale;\n    });\n  }));\n\n  // return the minimum\n  result = Math.min.apply(null, baseTimes);\n  return isFinite(result) ? result : 0;\n}\n\n  // feed incoming data to the front of the parsing pipeline\n  append(data, timeOffset,contiguous,accurateTimeOffset) {\n    const initData = this.initData;\n    const startDTS = MP4Demuxer.startDTS(initData,data);\n    this.remuxer.remux(initData.audio, initData.video, null, null, startDTS, contiguous,accurateTimeOffset,data);\n  }\n\n  destroy() {\n  }\n\n}\n\nexport default MP4Demuxer;\n\n\n\n// WEBPACK FOOTER //\n// src/demux/mp4demuxer.js","/**\n *  MPEG parser helper\n */\nimport {logger} from '../utils/logger';\n\nconst MpegAudio = {\n\n  onFrame: function(track, data, bitRate, sampleRate, channelCount, frameIndex, pts) {\n    var frameDuration = 1152 * 90000 / sampleRate;\n    var stamp = pts + frameIndex * frameDuration;\n\n    track.config = [];\n    track.channelCount = channelCount;\n    track.samplerate = sampleRate;\n    track.samples.push({unit: data, pts: stamp, dts: stamp});\n    track.len += data.length;\n  },\n\n  onNoise: function(data) {\n    logger.warn('mpeg audio has noise: ' + data.length + ' bytes');\n  },\n\n  parseFrames: function(track, data, start, end, frameIndex, pts) {\n    var BitratesMap = [\n        32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448,\n        32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384,\n        32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320,\n        32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256,\n        8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160];\n    var SamplingRateMap = [44100, 48000, 32000, 22050, 24000, 16000, 11025, 12000, 8000];\n\n    if (start + 2 > end) {\n        return -1; // we need at least 2 bytes to detect sync pattern\n    }\n    if (data[start] === 0xFF || (data[start + 1] & 0xE0) === 0xE0) {\n        // Using http://www.datavoyage.com/mpgscript/mpeghdr.htm as a reference\n        if (start + 24 > end) {\n            return -1;\n        }\n        var headerB = (data[start + 1] >> 3) & 3;\n        var headerC = (data[start + 1] >> 1) & 3;\n        var headerE = (data[start + 2] >> 4) & 15;\n        var headerF = (data[start + 2] >> 2) & 3;\n        var headerG = !!(data[start + 2] & 2);\n        if (headerB !== 1 && headerE !== 0 && headerE !== 15 && headerF !== 3) {\n            var columnInBitrates = headerB === 3 ? (3 - headerC) : (headerC === 3 ? 3 : 4);\n            var bitRate = BitratesMap[columnInBitrates * 14 + headerE - 1] * 1000;\n            var columnInSampleRates = headerB === 3 ? 0 : headerB === 2 ? 1 : 2;\n            var sampleRate = SamplingRateMap[columnInSampleRates * 3 + headerF];\n            var padding = headerG ? 1 : 0;\n            var channelCount = data[start + 3] >> 6 === 3 ? 1 : 2; // If bits of channel mode are `11` then it is a single channel (Mono)\n            var frameLength = headerC === 3 ?\n                ((headerB === 3 ? 12 : 6) * bitRate / sampleRate + padding) << 2 :\n                ((headerB === 3 ? 144 : 72) * bitRate / sampleRate + padding) | 0;\n            if (start + frameLength > end) {\n                return -1;\n            }\n\n            this.onFrame(track, data.subarray(start, start + frameLength), bitRate, sampleRate, channelCount, frameIndex, pts);\n\n            return frameLength;\n        }\n    }\n    // noise or ID3, trying to skip\n    var offset = start + 2;\n    while (offset < end) {\n        if (data[offset - 1] === 0xFF && (data[offset] & 0xE0) === 0xE0) {\n            // sync pattern is found\n            this.onNoise(data.subarray(start, offset - 1));\n\n            return offset - start - 1;\n        }\n        offset++;\n    }\n    return -1;\n  },\n\n  parse: function(track, data, offset, pts) {\n    var length = data.length;\n    var frameIndex = 0;\n    var parsed;\n\n    while (offset < length &&\n        (parsed = this.parseFrames(track, data, offset, length, frameIndex++, pts)) > 0) {\n        offset += parsed;\n    }\n  }\n};\n\nmodule.exports = MpegAudio;\n\n\n\n// WEBPACK FOOTER //\n// src/demux/mpegaudio.js","/**\n * SAMPLE-AES decrypter\n*/\n\n import Decrypter from '../crypt/decrypter';\n\n class SampleAesDecrypter {\n\n  constructor(observer, config, decryptdata, discardEPB) {\n    this.decryptdata = decryptdata;\n    this.discardEPB = discardEPB;\n    this.decrypter = new Decrypter(observer, config);\n  }\n\n  decryptBuffer(encryptedData, callback) {\n    this.decrypter.decrypt(encryptedData, this.decryptdata.key.buffer, this.decryptdata.iv.buffer, callback);\n  }\n\n  // AAC - encrypt all full 16 bytes blocks starting from offset 16\n  decryptAacSample(samples, sampleIndex, callback, sync) {\n    let curUnit = samples[sampleIndex].unit;\n    let encryptedData = curUnit.subarray(16, curUnit.length - curUnit.length % 16);\n    let encryptedBuffer = encryptedData.buffer.slice(\n       encryptedData.byteOffset,\n       encryptedData.byteOffset + encryptedData.length);\n\n    let localthis = this;\n    this.decryptBuffer(encryptedBuffer, function (decryptedData) {\n      decryptedData = new Uint8Array(decryptedData);\n      curUnit.set(decryptedData, 16);\n\n      if (!sync) {\n        localthis.decryptAacSamples(samples, sampleIndex + 1, callback);\n      }\n    });\n  }\n\n  decryptAacSamples(samples, sampleIndex, callback) {\n    for (;; sampleIndex++) {\n      if (sampleIndex >= samples.length) {\n        callback();\n        return;\n      }\n\n      if (samples[sampleIndex].unit.length < 32) {\n        continue;\n      }\n\n      let sync = this.decrypter.isSync();\n\n      this.decryptAacSample(samples, sampleIndex, callback, sync);\n\n      if (!sync) {\n        return;\n      }\n    }\n  }\n\n  // AVC - encrypt one 16 bytes block out of ten, starting from offset 32\n  getAvcEncryptedData(decodedData) {\n    let encryptedDataLen = Math.floor((decodedData.length - 48) / 160) * 16 + 16;\n    let encryptedData = new Int8Array(encryptedDataLen);\n    let outputPos = 0;\n    for (let inputPos = 32; inputPos <= decodedData.length - 16; inputPos += 160, outputPos += 16) {\n      encryptedData.set(decodedData.subarray(inputPos, inputPos + 16), outputPos);\n    }\n    return encryptedData;\n  }\n\n  getAvcDecryptedUnit(decodedData, decryptedData) {\n    decryptedData = new Uint8Array(decryptedData);\n    let inputPos = 0;\n    for (let outputPos = 32; outputPos <= decodedData.length - 16; outputPos += 160, inputPos += 16) {\n      decodedData.set(decryptedData.subarray(inputPos, inputPos + 16), outputPos);\n    }\n    return decodedData;\n  }\n\n  decryptAvcSample(samples, sampleIndex, unitIndex, callback, curUnit, sync) {\n    let decodedData = this.discardEPB(curUnit.data);\n    let encryptedData = this.getAvcEncryptedData(decodedData);\n    let localthis = this;\n\n    this.decryptBuffer(encryptedData.buffer, function (decryptedData) {\n      curUnit.data = localthis.getAvcDecryptedUnit(decodedData, decryptedData);\n\n      if (!sync) {\n        localthis.decryptAvcSamples(samples, sampleIndex, unitIndex + 1, callback);\n      }\n    });\n  }\n\n  decryptAvcSamples(samples, sampleIndex, unitIndex, callback) {\n    for (;; sampleIndex++, unitIndex = 0) {\n      if (sampleIndex >= samples.length) {\n        callback();\n        return;\n      }\n\n      let curUnits = samples[sampleIndex].units;\n      for (;; unitIndex++) {\n        if (unitIndex >= curUnits.length) {\n          break;\n        }\n\n        let curUnit = curUnits[unitIndex];\n        if (curUnit.length <= 48 || (curUnit.type !== 1 && curUnit.type !== 5)) {\n          continue;\n        }\n\n        let sync = this.decrypter.isSync();\n\n        this.decryptAvcSample(samples, sampleIndex, unitIndex, callback, curUnit, sync);\n\n        if (!sync) {\n          return;\n        }\n      }\n    }\n  }\n }\n\n export default SampleAesDecrypter;\n\n\n\n// WEBPACK FOOTER //\n// src/demux/sample-aes.js","/**\n * highly optimized TS demuxer:\n * parse PAT, PMT\n * extract PES packet from audio and video PIDs\n * extract AVC/H264 NAL units and AAC/ADTS samples from PES packet\n * trigger the remuxer upon parsing completion\n * it also tries to workaround as best as it can audio codec switch (HE-AAC to AAC and vice versa), without having to restart the MediaSource.\n * it also controls the remuxing process :\n * upon discontinuity or level switch detection, it will also notifies the remuxer so that it can reset its state.\n*/\n\n import ADTS from './adts';\n import MpegAudio from './mpegaudio';\n import Event from '../events';\n import ExpGolomb from './exp-golomb';\n import SampleAesDecrypter from './sample-aes';\n// import Hex from '../utils/hex';\n import {logger} from '../utils/logger';\n import {ErrorTypes, ErrorDetails} from '../errors';\n\n class TSDemuxer {\n\n  constructor(observer, remuxer, config, typeSupported) {\n    this.observer = observer;\n    this.config = config;\n    this.typeSupported = typeSupported;\n    this.remuxer = remuxer;\n    this.sampleAes = null;\n  }\n\n  setDecryptData(decryptdata) {\n    if ((decryptdata != null) && (decryptdata.key != null) && (decryptdata.method === 'SAMPLE-AES')) {\n      this.sampleAes = new SampleAesDecrypter(this.observer, this.config, decryptdata, this.discardEPB);\n    } else {\n      this.sampleAes = null;\n    }\n  }\n\n  static probe(data) {\n    // a TS fragment should contain at least 3 TS packets, a PAT, a PMT, and one PID, each starting with 0x47\n    if (data.length >= 3*188 && data[0] === 0x47 && data[188] === 0x47 && data[2*188] === 0x47) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  resetInitSegment(initSegment,audioCodec,videoCodec, duration) {\n    this.pmtParsed = false;\n    this._pmtId = -1;\n    this._avcTrack = {container : 'video/mp2t', type: 'video', id :-1, inputTimeScale : 90000, sequenceNumber: 0, samples : [], len : 0, dropped : 0};\n    this._audioTrack = {container : 'video/mp2t', type: 'audio', id :-1, inputTimeScale : 90000, duration: duration, sequenceNumber: 0, samples : [], len : 0, isAAC: true};\n    this._id3Track = {type: 'id3', id :-1, inputTimeScale : 90000, sequenceNumber: 0, samples : [], len : 0};\n    this._txtTrack = {type: 'text', id: -1, inputTimeScale : 90000, sequenceNumber: 0, samples : [], len : 0};\n    // flush any partial content\n    this.aacOverFlow = null;\n    this.aacLastPTS = null;\n    this.avcSample = null;\n    this.audioCodec = audioCodec;\n    this.videoCodec = videoCodec;\n    this._duration = duration;\n  }\n\n  resetTimeStamp() {\n  }\n\n  // feed incoming data to the front of the parsing pipeline\n  append(data, timeOffset, contiguous,accurateTimeOffset) {\n    var start, len = data.length, stt, pid, atf, offset,pes,\n        unknownPIDs = false;\n    this.contiguous = contiguous;\n    var pmtParsed = this.pmtParsed,\n        avcTrack = this._avcTrack,\n        audioTrack = this._audioTrack,\n        id3Track = this._id3Track,\n        avcId = avcTrack.id,\n        audioId = audioTrack.id,\n        id3Id = id3Track.id,\n        pmtId = this._pmtId,\n        avcData = avcTrack.pesData,\n        audioData = audioTrack.pesData,\n        id3Data = id3Track.pesData,\n        parsePAT = this._parsePAT,\n        parsePMT = this._parsePMT,\n        parsePES = this._parsePES,\n        parseAVCPES = this._parseAVCPES.bind(this),\n        parseAACPES = this._parseAACPES.bind(this),\n        parseMPEGPES = this._parseMPEGPES.bind(this),\n        parseID3PES  = this._parseID3PES.bind(this);\n\n    // don't parse last TS packet if incomplete\n    len -= len % 188;\n    // loop through TS packets\n    for (start = 0; start < len; start += 188) {\n      if (data[start] === 0x47) {\n        stt = !!(data[start + 1] & 0x40);\n        // pid is a 13-bit field starting at the last bit of TS[1]\n        pid = ((data[start + 1] & 0x1f) << 8) + data[start + 2];\n        atf = (data[start + 3] & 0x30) >> 4;\n        // if an adaption field is present, its length is specified by the fifth byte of the TS packet header.\n        if (atf > 1) {\n          offset = start + 5 + data[start + 4];\n          // continue if there is only adaptation field\n          if (offset === (start + 188)) {\n            continue;\n          }\n        } else {\n          offset = start + 4;\n        }\n        switch(pid) {\n          case avcId:\n            if (stt) {\n              if (avcData && (pes = parsePES(avcData))) {\n                parseAVCPES(pes,false);\n              }\n              avcData = {data: [], size: 0};\n            }\n            if (avcData) {\n              avcData.data.push(data.subarray(offset, start + 188));\n              avcData.size += start + 188 - offset;\n            }\n            break;\n          case audioId:\n            if (stt) {\n              if (audioData && (pes = parsePES(audioData))) {\n                if (audioTrack.isAAC) {\n                  parseAACPES(pes);\n                } else {\n                  parseMPEGPES(pes);\n                }\n              }\n              audioData = {data: [], size: 0};\n            }\n            if (audioData) {\n              audioData.data.push(data.subarray(offset, start + 188));\n              audioData.size += start + 188 - offset;\n            }\n            break;\n          case id3Id:\n            if (stt) {\n              if (id3Data && (pes = parsePES(id3Data))) {\n                parseID3PES(pes);\n              }\n              id3Data = {data: [], size: 0};\n            }\n            if (id3Data) {\n              id3Data.data.push(data.subarray(offset, start + 188));\n              id3Data.size += start + 188 - offset;\n            }\n            break;\n          case 0:\n            if (stt) {\n              offset += data[offset] + 1;\n            }\n            pmtId = this._pmtId = parsePAT(data, offset);\n            break;\n          case pmtId:\n            if (stt) {\n              offset += data[offset] + 1;\n            }\n            let parsedPIDs = parsePMT(data, offset, this.typeSupported.mpeg === true || this.typeSupported.mp3 === true, this.sampleAes != null);\n\n            // only update track id if track PID found while parsing PMT\n            // this is to avoid resetting the PID to -1 in case\n            // track PID transiently disappears from the stream\n            // this could happen in case of transient missing audio samples for example\n            avcId = parsedPIDs.avc;\n            if (avcId > 0) {\n              avcTrack.id = avcId;\n            }\n            audioId = parsedPIDs.audio;\n            if (audioId > 0) {\n              audioTrack.id = audioId;\n              audioTrack.isAAC = parsedPIDs.isAAC;\n            }\n            id3Id = parsedPIDs.id3;\n            if (id3Id > 0) {\n              id3Track.id = id3Id;\n            }\n            if (unknownPIDs && !pmtParsed) {\n              logger.log('reparse from beginning');\n              unknownPIDs = false;\n              // we set it to -188, the += 188 in the for loop will reset start to 0\n              start = -188;\n            }\n            pmtParsed = this.pmtParsed = true;\n            break;\n          case 17:\n          case 0x1fff:\n            break;\n          default:\n            unknownPIDs = true;\n            break;\n        }\n      } else {\n        this.observer.trigger(Event.ERROR, {type : ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: false, reason: 'TS packet did not start with 0x47'});\n      }\n    }\n    // try to parse last PES packets\n    if (avcData && (pes = parsePES(avcData))) {\n      parseAVCPES(pes,true);\n      avcTrack.pesData = null;\n    } else {\n      // either avcData null or PES truncated, keep it for next frag parsing\n      avcTrack.pesData = avcData;\n    }\n\n    if (audioData && (pes = parsePES(audioData))) {\n      if (audioTrack.isAAC) {\n        parseAACPES(pes);\n      } else {\n        parseMPEGPES(pes);\n      }\n      audioTrack.pesData = null;\n    } else {\n      if (audioData && audioData.size) {\n        logger.log('last AAC PES packet truncated,might overlap between fragments');\n      }\n     // either audioData null or PES truncated, keep it for next frag parsing\n      audioTrack.pesData = audioData;\n    }\n\n    if (id3Data && (pes = parsePES(id3Data))) {\n      parseID3PES(pes);\n      id3Track.pesData = null;\n    } else {\n      // either id3Data null or PES truncated, keep it for next frag parsing\n      id3Track.pesData = id3Data;\n    }\n\n    if (this.sampleAes == null) {\n      this.remuxer.remux(audioTrack, avcTrack, id3Track, this._txtTrack, timeOffset, contiguous, accurateTimeOffset);\n    } else {\n      this.decryptAndRemux(audioTrack, avcTrack, id3Track, this._txtTrack, timeOffset, contiguous, accurateTimeOffset);\n    }\n  }\n\n  decryptAndRemux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset) {\n    if (audioTrack.samples && audioTrack.isAAC) {\n      let localthis = this;\n      this.sampleAes.decryptAacSamples(audioTrack.samples, 0, function() {\n        localthis.decryptAndRemuxAvc(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n      });\n    } else {\n      this.decryptAndRemuxAvc(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n    }\n  }\n\n  decryptAndRemuxAvc(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset) {\n    if (videoTrack.samples) {\n      let localthis = this;\n      this.sampleAes.decryptAvcSamples(videoTrack.samples, 0, 0, function () {\n        localthis.remuxer.remux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n      });\n    } else {\n      this.remuxer.remux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n    }\n  }\n\n  destroy() {\n    this._initPTS = this._initDTS = undefined;\n    this._duration = 0;\n  }\n\n  _parsePAT(data, offset) {\n    // skip the PSI header and parse the first PMT entry\n    return (data[offset + 10] & 0x1F) << 8 | data[offset + 11];\n    //logger.log('PMT PID:'  + this._pmtId);\n  }\n\n  _parsePMT(data, offset, mpegSupported, isSampleAes) {\n    var sectionLength, tableEnd, programInfoLength, pid, result = { audio : -1, avc : -1, id3 : -1, isAAC : true};\n    sectionLength = (data[offset + 1] & 0x0f) << 8 | data[offset + 2];\n    tableEnd = offset + 3 + sectionLength - 4;\n    // to determine where the table is, we have to figure out how\n    // long the program info descriptors are\n    programInfoLength = (data[offset + 10] & 0x0f) << 8 | data[offset + 11];\n    // advance the offset to the first entry in the mapping table\n    offset += 12 + programInfoLength;\n    while (offset < tableEnd) {\n      pid = (data[offset + 1] & 0x1F) << 8 | data[offset + 2];\n      switch(data[offset]) {\n        case 0xcf:     // SAMPLE-AES AAC\n          if (!isSampleAes) {\n            logger.log('unkown stream type:'  + data[offset]);\n            break;\n          }\n          /* falls through */\n\n        // ISO/IEC 13818-7 ADTS AAC (MPEG-2 lower bit-rate audio)\n        case 0x0f:\n          //logger.log('AAC PID:'  + pid);\n          if (result.audio === -1) {\n            result.audio = pid;\n          }\n          break;\n\n        // Packetized metadata (ID3)\n        case 0x15:\n          //logger.log('ID3 PID:'  + pid);\n          if (result.id3 === -1) {\n            result.id3 = pid;\n          }\n          break;\n\n        case 0xdb:     // SAMPLE-AES AVC\n          if (!isSampleAes) {\n            logger.log('unkown stream type:'  + data[offset]);\n            break;\n          }\n          /* falls through */\n\n        // ITU-T Rec. H.264 and ISO/IEC 14496-10 (lower bit-rate video)\n        case 0x1b:\n          //logger.log('AVC PID:'  + pid);\n          if (result.avc === -1) {\n            result.avc = pid;\n          }\n          break;\n\n        // ISO/IEC 11172-3 (MPEG-1 audio)\n        // or ISO/IEC 13818-3 (MPEG-2 halved sample rate audio)\n        case 0x03:\n        case 0x04:\n          //logger.log('MPEG PID:'  + pid);\n          if (!mpegSupported) {\n            logger.log('MPEG audio found, not supported in this browser for now');\n          } else if (result.audio === -1) {\n            result.audio = pid;\n            result.isAAC = false;\n          }\n          break;\n\n        case 0x24:\n          logger.warn('HEVC stream type found, not supported for now');\n          break;\n\n        default:\n          logger.log('unkown stream type:'  + data[offset]);\n          break;\n      }\n      // move to the next table entry\n      // skip past the elementary stream descriptors, if present\n      offset += ((data[offset + 3] & 0x0F) << 8 | data[offset + 4]) + 5;\n    }\n    return result;\n  }\n\n  _parsePES(stream) {\n    var i = 0, frag, pesFlags, pesPrefix, pesLen, pesHdrLen, pesData, pesPts, pesDts, payloadStartOffset, data = stream.data;\n    // safety check\n    if (!stream || stream.size === 0) {\n      return null;\n    }\n\n    // we might need up to 19 bytes to read PES header\n    // if first chunk of data is less than 19 bytes, let's merge it with following ones until we get 19 bytes\n    // usually only one merge is needed (and this is rare ...)\n    while(data[0].length < 19 && data.length > 1) {\n      let newData = new Uint8Array(data[0].length + data[1].length);\n      newData.set(data[0]);\n      newData.set(data[1], data[0].length);\n      data[0] = newData;\n      data.splice(1,1);\n    }\n    //retrieve PTS/DTS from first fragment\n    frag = data[0];\n    pesPrefix = (frag[0] << 16) + (frag[1] << 8) + frag[2];\n    if (pesPrefix === 1) {\n      pesLen = (frag[4] << 8) + frag[5];\n      // if PES parsed length is not zero and greater than total received length, stop parsing. PES might be truncated\n      // minus 6 : PES header size\n      if (pesLen && pesLen > stream.size - 6) {\n        return null;\n      }\n      pesFlags = frag[7];\n      if (pesFlags & 0xC0) {\n        /* PES header described here : http://dvd.sourceforge.net/dvdinfo/pes-hdr.html\n            as PTS / DTS is 33 bit we cannot use bitwise operator in JS,\n            as Bitwise operators treat their operands as a sequence of 32 bits */\n        pesPts = (frag[9] & 0x0E) * 536870912 +// 1 << 29\n          (frag[10] & 0xFF) * 4194304 +// 1 << 22\n          (frag[11] & 0xFE) * 16384 +// 1 << 14\n          (frag[12] & 0xFF) * 128 +// 1 << 7\n          (frag[13] & 0xFE) / 2;\n          // check if greater than 2^32 -1\n          if (pesPts > 4294967295) {\n            // decrement 2^33\n            pesPts -= 8589934592;\n          }\n        if (pesFlags & 0x40) {\n          pesDts = (frag[14] & 0x0E ) * 536870912 +// 1 << 29\n            (frag[15] & 0xFF ) * 4194304 +// 1 << 22\n            (frag[16] & 0xFE ) * 16384 +// 1 << 14\n            (frag[17] & 0xFF ) * 128 +// 1 << 7\n            (frag[18] & 0xFE ) / 2;\n          // check if greater than 2^32 -1\n          if (pesDts > 4294967295) {\n            // decrement 2^33\n            pesDts -= 8589934592;\n          }\n          if (pesPts - pesDts > 60*90000) {\n            logger.warn(`${Math.round((pesPts - pesDts)/90000)}s delta between PTS and DTS, align them`);\n            pesPts = pesDts;\n          }\n        } else {\n          pesDts = pesPts;\n        }\n      }\n      pesHdrLen = frag[8];\n      // 9 bytes : 6 bytes for PES header + 3 bytes for PES extension\n      payloadStartOffset = pesHdrLen + 9;\n\n      stream.size -= payloadStartOffset;\n      //reassemble PES packet\n      pesData = new Uint8Array(stream.size);\n      for( let j = 0, dataLen = data.length; j < dataLen ; j++) {\n        frag = data[j];\n        let len = frag.byteLength;\n        if (payloadStartOffset) {\n          if (payloadStartOffset > len) {\n            // trim full frag if PES header bigger than frag\n            payloadStartOffset-=len;\n            continue;\n          } else {\n            // trim partial frag if PES header smaller than frag\n            frag = frag.subarray(payloadStartOffset);\n            len-=payloadStartOffset;\n            payloadStartOffset = 0;\n          }\n        }\n        pesData.set(frag, i);\n        i+=len;\n      }\n      if (pesLen) {\n        // payload size : remove PES header + PES extension\n        pesLen -= pesHdrLen+3;\n      }\n      return {data: pesData, pts: pesPts, dts: pesDts, len: pesLen};\n    } else {\n      return null;\n    }\n  }\n\n  pushAccesUnit(avcSample,avcTrack) {\n    if (avcSample.units.length && avcSample.frame) {\n      const samples = avcTrack.samples;\n      const nbSamples = samples.length;\n      // only push AVC sample if starting with a keyframe is not mandatory OR\n      //    if keyframe already found in this fragment OR\n      //       keyframe found in last fragment (track.sps) AND\n      //          samples already appended (we already found a keyframe in this fragment) OR fragment is contiguous\n      if (!this.config.forceKeyFrameOnDiscontinuity ||\n          avcSample.key === true ||\n          (avcTrack.sps && (nbSamples || this.contiguous))) {\n        avcSample.id = nbSamples;\n        samples.push(avcSample);\n      } else {\n        // dropped samples, track it\n        avcTrack.dropped++;\n      }\n    }\n    if(avcSample.debug.length) {\n      logger.log(avcSample.pts + '/' + avcSample.dts + ':' + avcSample.debug);\n    }\n  }\n\n  _parseAVCPES(pes,last) {\n    //logger.log('parse new PES');\n    var track = this._avcTrack,\n        units = this._parseAVCNALu(pes.data),\n        debug = false,\n        expGolombDecoder,\n        avcSample = this.avcSample,\n        push,\n        i;\n    //free pes.data to save up some memory\n    pes.data = null;\n\n    units.forEach(unit => {\n      switch(unit.type) {\n        //NDR\n         case 1:\n           push = true;\n           if(debug && avcSample) {\n            avcSample.debug += 'NDR ';\n           }\n           avcSample.frame = true;\n           // retrieve slice type by parsing beginning of NAL unit (follow H264 spec, slice_header definition) to detect keyframe embedded in NDR\n           let data = unit.data;\n           if (data.length > 4) {\n             let sliceType = new ExpGolomb(data).readSliceType();\n             // 2 : I slice, 4 : SI slice, 7 : I slice, 9: SI slice\n             // SI slice : A slice that is coded using intra prediction only and using quantisation of the prediction samples.\n             // An SI slice can be coded such that its decoded samples can be constructed identically to an SP slice.\n             // I slice: A slice that is not an SI slice that is decoded using intra prediction only.\n             //if (sliceType === 2 || sliceType === 7) {\n             if (sliceType === 2 || sliceType === 4 || sliceType === 7 || sliceType === 9) {\n                avcSample.key = true;\n             }\n           }\n           break;\n        //IDR\n        case 5:\n          push = true;\n          // handle PES not starting with AUD\n          if (!avcSample) {\n            avcSample = this.avcSample = this._createAVCSample(true,pes.pts,pes.dts,'');\n          }\n          if(debug) {\n            avcSample.debug += 'IDR ';\n          }\n          avcSample.key = true;\n          avcSample.frame = true;\n          break;\n        //SEI\n        case 6:\n          push = true;\n          if(debug && avcSample) {\n            avcSample.debug += 'SEI ';\n          }\n          expGolombDecoder = new ExpGolomb(this.discardEPB(unit.data));\n\n          // skip frameType\n          expGolombDecoder.readUByte();\n\n          var payloadType = 0;\n          var payloadSize = 0;\n          var endOfCaptions = false;\n          var b = 0;\n\n          while (!endOfCaptions && expGolombDecoder.bytesAvailable > 1) {\n            payloadType = 0;\n            do {\n                b = expGolombDecoder.readUByte();\n                payloadType += b;\n            } while (b === 0xFF);\n\n            // Parse payload size.\n            payloadSize = 0;\n            do {\n                b = expGolombDecoder.readUByte();\n                payloadSize += b;\n            } while (b === 0xFF);\n\n            // TODO: there can be more than one payload in an SEI packet...\n            // TODO: need to read type and size in a while loop to get them all\n            if (payloadType === 4 && expGolombDecoder.bytesAvailable !== 0) {\n\n              endOfCaptions = true;\n\n              var countryCode = expGolombDecoder.readUByte();\n\n              if (countryCode === 181) {\n                var providerCode = expGolombDecoder.readUShort();\n\n                if (providerCode === 49) {\n                  var userStructure = expGolombDecoder.readUInt();\n\n                  if (userStructure === 0x47413934) {\n                    var userDataType = expGolombDecoder.readUByte();\n\n                    // Raw CEA-608 bytes wrapped in CEA-708 packet\n                    if (userDataType === 3) {\n                      var firstByte = expGolombDecoder.readUByte();\n                      var secondByte = expGolombDecoder.readUByte();\n\n                      var totalCCs = 31 & firstByte;\n                      var byteArray = [firstByte, secondByte];\n\n                      for (i = 0; i < totalCCs; i++) {\n                        // 3 bytes per CC\n                        byteArray.push(expGolombDecoder.readUByte());\n                        byteArray.push(expGolombDecoder.readUByte());\n                        byteArray.push(expGolombDecoder.readUByte());\n                      }\n\n                      this._insertSampleInOrder(this._txtTrack.samples, { type: 3, pts: pes.pts, bytes: byteArray });\n                    }\n                  }\n                }\n              }\n            }\n            else if (payloadSize < expGolombDecoder.bytesAvailable)\n            {\n              for (i = 0; i<payloadSize; i++)\n              {\n                expGolombDecoder.readUByte();\n              }\n            }\n          }\n          break;\n        //SPS\n        case 7:\n          push = true;\n          if(debug && avcSample) {\n            avcSample.debug += 'SPS ';\n          }\n          if(!track.sps) {\n            expGolombDecoder = new ExpGolomb(unit.data);\n            var config = expGolombDecoder.readSPS();\n            track.width = config.width;\n            track.height = config.height;\n            track.pixelRatio = config.pixelRatio;\n            track.sps = [unit.data];\n            track.duration = this._duration;\n            var codecarray = unit.data.subarray(1, 4);\n            var codecstring = 'avc1.';\n            for (i = 0; i < 3; i++) {\n              var h = codecarray[i].toString(16);\n              if (h.length < 2) {\n                h = '0' + h;\n              }\n              codecstring += h;\n            }\n            track.codec = codecstring;\n          }\n          break;\n        //PPS\n        case 8:\n          push = true;\n          if(debug && avcSample) {\n            avcSample.debug += 'PPS ';\n          }\n          if (!track.pps) {\n            track.pps = [unit.data];\n          }\n          break;\n        // AUD\n        case 9:\n          push = false;\n          if (avcSample) {\n            this.pushAccesUnit(avcSample,track);\n          }\n          avcSample = this.avcSample = this._createAVCSample(false,pes.pts,pes.dts,debug ? 'AUD ': '');\n          break;\n        // Filler Data\n        case 12:\n          push = false;\n          break;\n        default:\n          push = false;\n          if (avcSample) {\n            avcSample.debug += 'unknown NAL ' + unit.type + ' ';\n          }\n          break;\n      }\n      if(avcSample && push) {\n        let units = avcSample.units;\n        units.push(unit);\n      }\n    });\n    // if last PES packet, push samples\n    if (last && avcSample) {\n      this.pushAccesUnit(avcSample,track);\n      this.avcSample = null;\n    }\n  }\n\n  _createAVCSample(key,pts,dts,debug) {\n    return { key : key, pts : pts, dts : dts, units : [], debug : debug};\n  }\n\n  _insertSampleInOrder(arr, data) {\n    var len = arr.length;\n    if (len > 0) {\n      if (data.pts >= arr[len-1].pts)\n      {\n        arr.push(data);\n      }\n      else {\n        for (var pos = len - 1; pos >= 0; pos--) {\n          if (data.pts < arr[pos].pts) {\n            arr.splice(pos, 0, data);\n            break;\n          }\n        }\n      }\n    }\n    else {\n      arr.push(data);\n    }\n  }\n\n  _getLastNalUnit() {\n    let avcSample = this.avcSample, lastUnit;\n    // try to fallback to previous sample if current one is empty\n    if (!avcSample || avcSample.units.length === 0) {\n      let track = this._avcTrack, samples = track.samples;\n      avcSample = samples[samples.length-1];\n    }\n    if (avcSample) {\n      let units = avcSample.units;\n      lastUnit = units[units.length - 1];\n    }\n    return lastUnit;\n  }\n\n  _parseAVCNALu(array) {\n    var i = 0, len = array.byteLength, value, overflow, track = this._avcTrack, state = track.naluState || 0, lastState = state;\n    var units = [], unit, unitType, lastUnitStart = -1, lastUnitType;\n    //logger.log('PES:' + Hex.hexDump(array));\n\n    if (state === -1) {\n    // special use case where we found 3 or 4-byte start codes exactly at the end of previous PES packet\n      lastUnitStart = 0;\n      // NALu type is value read from offset 0\n      lastUnitType = array[0] & 0x1f;\n      state = 0;\n      i = 1;\n    }\n\n    while (i < len) {\n      value = array[i++];\n      // optimization. state 0 and 1 are the predominant case. let's handle them outside of the switch/case\n      if (!state) {\n        state = value ? 0 : 1;\n        continue;\n      }\n      if (state === 1) {\n        state = value ? 0 : 2;\n        continue;\n      }\n      // here we have state either equal to 2 or 3\n      if(!value) {\n        state = 3;\n      } else if (value === 1) {\n        if (lastUnitStart >=0) {\n          unit = {data: array.subarray(lastUnitStart, i - state - 1), type: lastUnitType};\n          //logger.log('pushing NALU, type/size:' + unit.type + '/' + unit.data.byteLength);\n          units.push(unit);\n        } else {\n          // lastUnitStart is undefined => this is the first start code found in this PES packet\n          // first check if start code delimiter is overlapping between 2 PES packets,\n          // ie it started in last packet (lastState not zero)\n          // and ended at the beginning of this PES packet (i <= 4 - lastState)\n          let lastUnit = this._getLastNalUnit();\n          if (lastUnit) {\n            if(lastState &&  (i <= 4 - lastState)) {\n              // start delimiter overlapping between PES packets\n              // strip start delimiter bytes from the end of last NAL unit\n                // check if lastUnit had a state different from zero\n              if (lastUnit.state) {\n                // strip last bytes\n                lastUnit.data = lastUnit.data.subarray(0,lastUnit.data.byteLength - lastState);\n              }\n            }\n            // If NAL units are not starting right at the beginning of the PES packet, push preceding data into previous NAL unit.\n            overflow  = i - state - 1;\n            if (overflow > 0) {\n              //logger.log('first NALU found with overflow:' + overflow);\n              let tmp = new Uint8Array(lastUnit.data.byteLength + overflow);\n              tmp.set(lastUnit.data, 0);\n              tmp.set(array.subarray(0, overflow), lastUnit.data.byteLength);\n              lastUnit.data = tmp;\n            }\n          }\n        }\n        // check if we can read unit type\n        if (i < len) {\n          unitType = array[i] & 0x1f;\n          //logger.log('find NALU @ offset:' + i + ',type:' + unitType);\n          lastUnitStart = i;\n          lastUnitType = unitType;\n          state = 0;\n        } else {\n          // not enough byte to read unit type. let's read it on next PES parsing\n          state = -1;\n        }\n      } else {\n        state = 0;\n      }\n    }\n    if (lastUnitStart >=0 && state >=0) {\n      unit = {data: array.subarray(lastUnitStart, len), type: lastUnitType, state : state};\n      units.push(unit);\n      //logger.log('pushing NALU, type/size/state:' + unit.type + '/' + unit.data.byteLength + '/' + state);\n    }\n    // no NALu found\n    if (units.length === 0) {\n      // append pes.data to previous NAL unit\n      let  lastUnit = this._getLastNalUnit();\n      if (lastUnit) {\n        let tmp = new Uint8Array(lastUnit.data.byteLength + array.byteLength);\n        tmp.set(lastUnit.data, 0);\n        tmp.set(array, lastUnit.data.byteLength);\n        lastUnit.data = tmp;\n      }\n    }\n    track.naluState = state;\n    return units;\n  }\n\n  /**\n   * remove Emulation Prevention bytes from a RBSP\n   */\n  discardEPB(data) {\n    var length = data.byteLength,\n        EPBPositions = [],\n        i = 1,\n        newLength, newData;\n\n    // Find all `Emulation Prevention Bytes`\n    while (i < length - 2) {\n      if (data[i] === 0 &&\n          data[i + 1] === 0 &&\n          data[i + 2] === 0x03) {\n        EPBPositions.push(i + 2);\n        i += 2;\n      } else {\n        i++;\n      }\n    }\n\n    // If no Emulation Prevention Bytes were found just return the original\n    // array\n    if (EPBPositions.length === 0) {\n      return data;\n    }\n\n    // Create a new array to hold the NAL unit data\n    newLength = length - EPBPositions.length;\n    newData = new Uint8Array(newLength);\n    var sourceIndex = 0;\n\n    for (i = 0; i < newLength; sourceIndex++, i++) {\n      if (sourceIndex === EPBPositions[0]) {\n        // Skip this byte\n        sourceIndex++;\n        // Remove this position index\n        EPBPositions.shift();\n      }\n      newData[i] = data[sourceIndex];\n    }\n    return newData;\n  }\n\n  _parseAACPES(pes) {\n    var track = this._audioTrack,\n        data = pes.data,\n        pts = pes.pts,\n        startOffset = 0,\n        aacOverFlow = this.aacOverFlow,\n        aacLastPTS = this.aacLastPTS,\n        config, frameLength, frameDuration, frameIndex, offset, headerLength, stamp, len, aacSample;\n    if (aacOverFlow) {\n      var tmp = new Uint8Array(aacOverFlow.byteLength + data.byteLength);\n      tmp.set(aacOverFlow, 0);\n      tmp.set(data, aacOverFlow.byteLength);\n      //logger.log(`AAC: append overflowing ${aacOverFlow.byteLength} bytes to beginning of new PES`);\n      data = tmp;\n    }\n    // look for ADTS header (0xFFFx)\n    for (offset = startOffset, len = data.length; offset < len - 1; offset++) {\n      if ((data[offset] === 0xff) && (data[offset+1] & 0xf0) === 0xf0) {\n        break;\n      }\n    }\n    // if ADTS header does not start straight from the beginning of the PES payload, raise an error\n    if (offset) {\n      var reason, fatal;\n      if (offset < len - 1) {\n        reason = `AAC PES did not start with ADTS header,offset:${offset}`;\n        fatal = false;\n      } else {\n        reason = 'no ADTS header found in AAC PES';\n        fatal = true;\n      }\n      logger.warn(`parsing error:${reason}`);\n      this.observer.trigger(Event.ERROR, {type: ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: fatal, reason: reason});\n      if (fatal) {\n        return;\n      }\n    }\n    if (!track.samplerate) {\n      const audioCodec = this.audioCodec;\n      config = ADTS.getAudioConfig(this.observer,data, offset, audioCodec);\n      track.config = config.config;\n      track.samplerate = config.samplerate;\n      track.channelCount = config.channelCount;\n      track.codec = config.codec;\n      track.manifestCodec = config.manifestCodec;\n      logger.log(`parsed codec:${track.codec},rate:${config.samplerate},nb channel:${config.channelCount}`);\n    }\n    frameIndex = 0;\n    frameDuration = 1024 * 90000 / track.samplerate;\n\n    // if last AAC frame is overflowing, we should ensure timestamps are contiguous:\n    // first sample PTS should be equal to last sample PTS + frameDuration\n    if(aacOverFlow && aacLastPTS) {\n      var newPTS = aacLastPTS+frameDuration;\n      if(Math.abs(newPTS-pts) > 1) {\n        logger.log(`AAC: align PTS for overlapping frames by ${Math.round((newPTS-pts)/90)}`);\n        pts=newPTS;\n      }\n    }\n\n    while ((offset + 5) < len) {\n      // The protection skip bit tells us if we have 2 bytes of CRC data at the end of the ADTS header\n      headerLength = (!!(data[offset + 1] & 0x01) ? 7 : 9);\n      // retrieve frame size\n      frameLength = ((data[offset + 3] & 0x03) << 11) |\n                     (data[offset + 4] << 3) |\n                    ((data[offset + 5] & 0xE0) >>> 5);\n      frameLength  -= headerLength;\n      //stamp = pes.pts;\n\n      if ((frameLength > 0) && ((offset + headerLength + frameLength) <= len)) {\n        stamp = pts + frameIndex * frameDuration;\n        //logger.log(`AAC frame, offset/length/total/pts:${offset+headerLength}/${frameLength}/${data.byteLength}/${(stamp/90).toFixed(0)}`);\n        aacSample = {unit: data.subarray(offset + headerLength, offset + headerLength + frameLength), pts: stamp, dts: stamp};\n        track.samples.push(aacSample);\n        track.len += frameLength;\n        offset += frameLength + headerLength;\n        frameIndex++;\n        // look for ADTS header (0xFFFx)\n        for ( ; offset < (len - 1); offset++) {\n          if ((data[offset] === 0xff) && ((data[offset + 1] & 0xf0) === 0xf0)) {\n            break;\n          }\n        }\n      } else {\n        break;\n      }\n    }\n    if (offset < len) {\n      aacOverFlow = data.subarray(offset, len);\n      //logger.log(`AAC: overflow detected:${len-offset}`);\n    } else {\n      aacOverFlow = null;\n    }\n    this.aacOverFlow = aacOverFlow;\n    this.aacLastPTS = stamp;\n  }\n\n  _parseMPEGPES(pes) {\n    MpegAudio.parse(this._audioTrack, pes.data, 0, pes.pts);\n  }\n\n  _parseID3PES(pes) {\n    this._id3Track.samples.push(pes);\n  }\n}\n\nexport default TSDemuxer;\n\n\n\n// WEBPACK FOOTER //\n// src/demux/tsdemuxer.js","export const ErrorTypes = {\n  // Identifier for a network error (loading error / timeout ...)\n  NETWORK_ERROR: 'networkError',\n  // Identifier for a media Error (video/parsing/mediasource error)\n  MEDIA_ERROR: 'mediaError',\n  // Identifier for a mux Error (demuxing/remuxing)\n  MUX_ERROR: 'muxError',\n  // Identifier for all other errors\n  OTHER_ERROR: 'otherError'\n};\n\nexport const ErrorDetails = {\n  // Identifier for a manifest load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  MANIFEST_LOAD_ERROR: 'manifestLoadError',\n  // Identifier for a manifest load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  MANIFEST_LOAD_TIMEOUT: 'manifestLoadTimeOut',\n  // Identifier for a manifest parsing error - data: { url : faulty URL, reason : error reason}\n  MANIFEST_PARSING_ERROR: 'manifestParsingError',\n  // Identifier for a manifest with only incompatible codecs error - data: { url : faulty URL, reason : error reason}\n  MANIFEST_INCOMPATIBLE_CODECS_ERROR: 'manifestIncompatibleCodecsError',\n  // Identifier for a level load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  LEVEL_LOAD_ERROR: 'levelLoadError',\n  // Identifier for a level load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  LEVEL_LOAD_TIMEOUT: 'levelLoadTimeOut',\n  // Identifier for a level switch error - data: { level : faulty level Id, event : error description}\n  LEVEL_SWITCH_ERROR: 'levelSwitchError',\n  // Identifier for an audio track load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  AUDIO_TRACK_LOAD_ERROR: 'audioTrackLoadError',\n  // Identifier for an audio track load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  AUDIO_TRACK_LOAD_TIMEOUT: 'audioTrackLoadTimeOut',\n  // Identifier for fragment load error - data: { frag : fragment object, response : { code: error code, text: error text }}\n  FRAG_LOAD_ERROR: 'fragLoadError',\n  // Identifier for fragment loop loading error - data: { frag : fragment object}\n  FRAG_LOOP_LOADING_ERROR: 'fragLoopLoadingError',\n  // Identifier for fragment load timeout error - data: { frag : fragment object}\n  FRAG_LOAD_TIMEOUT: 'fragLoadTimeOut',\n  // Identifier for a fragment decryption error event - data: {id : demuxer Id,frag: fragment object, reason : parsing error description }\n  FRAG_DECRYPT_ERROR: 'fragDecryptError',\n  // Identifier for a fragment parsing error event - data: { id : demuxer Id, reason : parsing error description }\n  // will be renamed DEMUX_PARSING_ERROR and switched to MUX_ERROR in the next major release\n  FRAG_PARSING_ERROR: 'fragParsingError',\n  // Identifier for a remux alloc error event - data: { id : demuxer Id, frag : fragment object, bytes : nb of bytes on which allocation failed , reason : error text }\n  REMUX_ALLOC_ERROR : 'remuxAllocError',\n  // Identifier for decrypt key load error - data: { frag : fragment object, response : { code: error code, text: error text }}\n  KEY_LOAD_ERROR: 'keyLoadError',\n  // Identifier for decrypt key load timeout error - data: { frag : fragment object}\n  KEY_LOAD_TIMEOUT: 'keyLoadTimeOut',\n  // Triggered when an exception occurs while adding a sourceBuffer to MediaSource - data : {  err : exception , mimeType : mimeType }\n  BUFFER_ADD_CODEC_ERROR: 'bufferAddCodecError',\n  // Identifier for a buffer append error - data: append error description\n  BUFFER_APPEND_ERROR: 'bufferAppendError',\n  // Identifier for a buffer appending error event - data: appending error description\n  BUFFER_APPENDING_ERROR: 'bufferAppendingError',\n  // Identifier for a buffer stalled error event\n  BUFFER_STALLED_ERROR: 'bufferStalledError',\n  // Identifier for a buffer full event\n  BUFFER_FULL_ERROR: 'bufferFullError',\n  // Identifier for a buffer seek over hole event\n  BUFFER_SEEK_OVER_HOLE: 'bufferSeekOverHole',\n  // Identifier for a buffer nudge on stall (playback is stuck although currentTime is in a buffered area)\n  BUFFER_NUDGE_ON_STALL : 'bufferNudgeOnStall',\n  // Identifier for an internal exception happening inside hls.js while handling an event\n  INTERNAL_EXCEPTION: 'internalException',\n  // Malformed WebVTT contents\n  WEBVTT_EXCEPTION: 'webVTTException'\n};\n\n\n\n// WEBPACK FOOTER //\n// src/errors.js","/*\n*\n* All objects in the event handling chain should inherit from this class\n*\n*/\n\nimport {logger} from './utils/logger';\nimport {ErrorTypes, ErrorDetails} from './errors';\nimport Event from './events';\n\nclass EventHandler {\n\n  constructor(hls, ...events) {\n    this.hls = hls;\n    this.onEvent = this.onEvent.bind(this);\n    this.handledEvents = events;\n    this.useGenericHandler = true;\n\n    this.registerListeners();\n  }\n\n  destroy() {\n    this.unregisterListeners();\n  }\n\n  isEventHandler() {\n    return typeof this.handledEvents === 'object' && this.handledEvents.length && typeof this.onEvent === 'function';\n  }\n\n  registerListeners() {\n    if (this.isEventHandler()) {\n      this.handledEvents.forEach(function(event) {\n        if (event === 'hlsEventGeneric') {\n          throw new Error('Forbidden event name: ' + event);\n        }\n        this.hls.on(event, this.onEvent);\n      }.bind(this));\n    }\n  }\n\n  unregisterListeners() {\n    if (this.isEventHandler()) {\n      this.handledEvents.forEach(function(event) {\n        this.hls.off(event, this.onEvent);\n      }.bind(this));\n    }\n  }\n\n  /**\n   * arguments: event (string), data (any)\n   */\n  onEvent(event, data) {\n    this.onEventGeneric(event, data);\n  }\n\n  onEventGeneric(event, data) {\n    var eventToFunction = function(event, data) {\n      var funcName = 'on' + event.replace('hls', '');\n      if (typeof this[funcName] !== 'function') {\n        throw new Error(`Event ${event} has no generic handler in this ${this.constructor.name} class (tried ${funcName})`);\n      }\n      return this[funcName].bind(this, data);\n    };\n    try {\n      eventToFunction.call(this, event, data).call();\n    } catch (err) {\n      logger.error(`internal error happened while processing ${event}:${err.message}`);\n      this.hls.trigger(Event.ERROR, {type: ErrorTypes.OTHER_ERROR, details: ErrorDetails.INTERNAL_EXCEPTION, fatal: false, event : event, err : err});\n    }\n  }\n}\n\nexport default EventHandler;\n\n\n\n// WEBPACK FOOTER //\n// src/event-handler.js","module.exports = {\n  // fired before MediaSource is attaching to media element - data: { media }\n  MEDIA_ATTACHING: 'hlsMediaAttaching',\n  // fired when MediaSource has been succesfully attached to media element - data: { }\n  MEDIA_ATTACHED: 'hlsMediaAttached',\n  // fired before detaching MediaSource from media element - data: { }\n  MEDIA_DETACHING: 'hlsMediaDetaching',\n  // fired when MediaSource has been detached from media element - data: { }\n  MEDIA_DETACHED: 'hlsMediaDetached',\n  // fired when we buffer is going to be reset - data: { }\n  BUFFER_RESET: 'hlsBufferReset',\n  // fired when we know about the codecs that we need buffers for to push into - data: {tracks : { container, codec, levelCodec, initSegment, metadata }}\n  BUFFER_CODECS: 'hlsBufferCodecs',\n  // fired when sourcebuffers have been created - data: { tracks : tracks }\n  BUFFER_CREATED: 'hlsBufferCreated',\n  // fired when we append a segment to the buffer - data: { segment: segment object }\n  BUFFER_APPENDING: 'hlsBufferAppending',\n  // fired when we are done with appending a media segment to the buffer - data : { parent : segment parent that triggered BUFFER_APPENDING, pending : nb of segments waiting for appending for this segment parent}\n  BUFFER_APPENDED: 'hlsBufferAppended',\n  // fired when the stream is finished and we want to notify the media buffer that there will be no more data - data: { }\n  BUFFER_EOS: 'hlsBufferEos',\n  // fired when the media buffer should be flushed - data { startOffset, endOffset }\n  BUFFER_FLUSHING: 'hlsBufferFlushing',\n  // fired when the media buffer has been flushed - data: { }\n  BUFFER_FLUSHED: 'hlsBufferFlushed',\n  // fired to signal that a manifest loading starts - data: { url : manifestURL}\n  MANIFEST_LOADING: 'hlsManifestLoading',\n  // fired after manifest has been loaded - data: { levels : [available quality levels], audioTracks : [ available audio tracks], url : manifestURL, stats : { trequest, tfirst, tload, mtime}}\n  MANIFEST_LOADED: 'hlsManifestLoaded',\n  // fired after manifest has been parsed - data: { levels : [available quality levels], firstLevel : index of first quality level appearing in Manifest}\n  MANIFEST_PARSED: 'hlsManifestParsed',\n  // fired when a level switch is requested - data: { level : id of new level } // deprecated in favor LEVEL_SWITCHING\n  LEVEL_SWITCH: 'hlsLevelSwitch',\n  // fired when a level switch is requested - data: { level : id of new level }\n  LEVEL_SWITCHING: 'hlsLevelSwitching',\n  // fired when a level switch is effective - data: { level : id of new level }\n  LEVEL_SWITCHED: 'hlsLevelSwitched',\n  // fired when a level playlist loading starts - data: { url : level URL, level : id of level being loaded}\n  LEVEL_LOADING: 'hlsLevelLoading',\n  // fired when a level playlist loading finishes - data: { details : levelDetails object, level : id of loaded level, stats : { trequest, tfirst, tload, mtime} }\n  LEVEL_LOADED: 'hlsLevelLoaded',\n  // fired when a level's details have been updated based on previous details, after it has been loaded - data: { details : levelDetails object, level : id of updated level }\n  LEVEL_UPDATED: 'hlsLevelUpdated',\n  // fired when a level's PTS information has been updated after parsing a fragment - data: { details : levelDetails object, level : id of updated level, drift: PTS drift observed when parsing last fragment }\n  LEVEL_PTS_UPDATED: 'hlsLevelPtsUpdated',\n  // fired to notify that audio track lists has been updated - data: { audioTracks : audioTracks }\n  AUDIO_TRACKS_UPDATED: 'hlsAudioTracksUpdated',\n  // fired when an audio track switch occurs - data: { id : audio track id } // deprecated in favor AUDIO_TRACK_SWITCHING\n  AUDIO_TRACK_SWITCH: 'hlsAudioTrackSwitch',\n  // fired when an audio track switching is requested - data: { id : audio track id }\n  AUDIO_TRACK_SWITCHING: 'hlsAudioTrackSwitching',\n  // fired when an audio track switch actually occurs - data: { id : audio track id }\n  AUDIO_TRACK_SWITCHED: 'hlsAudioTrackSwitched',\n  // fired when an audio track loading starts - data: { url : audio track URL, id : audio track id }\n  AUDIO_TRACK_LOADING: 'hlsAudioTrackLoading',\n  // fired when an audio track loading finishes - data: { details : levelDetails object, id : audio track id, stats : { trequest, tfirst, tload, mtime } }\n  AUDIO_TRACK_LOADED: 'hlsAudioTrackLoaded',\n  // fired to notify that subtitle track lists has been updated - data: { subtitleTracks : subtitleTracks }\n  SUBTITLE_TRACKS_UPDATED: 'hlsSubtitleTracksUpdated',\n  // fired when an subtitle track switch occurs - data: { id : subtitle track id }\n  SUBTITLE_TRACK_SWITCH: 'hlsSubtitleTrackSwitch',\n  // fired when a subtitle track loading starts - data: { url : subtitle track URL, id : subtitle track id }\n  SUBTITLE_TRACK_LOADING: 'hlsSubtitleTrackLoading',\n  // fired when a subtitle track loading finishes - data: { details : levelDetails object, id : subtitle track id, stats : { trequest, tfirst, tload, mtime } }\n  SUBTITLE_TRACK_LOADED: 'hlsSubtitleTrackLoaded',\n  // fired when a subtitle fragment has been processed - data: { success : boolean, frag : the processed frag }\n  SUBTITLE_FRAG_PROCESSED: 'hlsSubtitleFragProcessed',\n  // fired when the first timestamp is found - data: { id : demuxer id, initPTS: initPTS, frag : fragment object }\n  INIT_PTS_FOUND: 'hlsInitPtsFound',\n  // fired when a fragment loading starts - data: { frag : fragment object }\n  FRAG_LOADING: 'hlsFragLoading',\n  // fired when a fragment loading is progressing - data: { frag : fragment object, { trequest, tfirst, loaded } }\n  FRAG_LOAD_PROGRESS: 'hlsFragLoadProgress',\n  // Identifier for fragment load aborting for emergency switch down - data: { frag : fragment object }\n  FRAG_LOAD_EMERGENCY_ABORTED: 'hlsFragLoadEmergencyAborted',\n  // fired when a fragment loading is completed - data: { frag : fragment object, payload : fragment payload, stats : { trequest, tfirst, tload, length } }\n  FRAG_LOADED: 'hlsFragLoaded',\n  // fired when a fragment has finished decrypting - data: { id : demuxer id, frag: fragment object, stats : { tstart, tdecrypt } }\n  FRAG_DECRYPTED: 'hlsFragDecrypted',\n  // fired when Init Segment has been extracted from fragment - data: { id : demuxer id, frag: fragment object, moov : moov MP4 box, codecs : codecs found while parsing fragment }\n  FRAG_PARSING_INIT_SEGMENT: 'hlsFragParsingInitSegment',\n  // fired when parsing sei text is completed - data: { id : demuxer id, frag: fragment object, samples : [ sei samples pes ] }\n  FRAG_PARSING_USERDATA: 'hlsFragParsingUserdata',\n  // fired when parsing id3 is completed - data: { id : demuxer id, frag: fragment object, samples : [ id3 samples pes ] }\n  FRAG_PARSING_METADATA: 'hlsFragParsingMetadata',\n  // fired when data have been extracted from fragment - data: { id : demuxer id, frag: fragment object, data1 : moof MP4 box or TS fragments, data2 : mdat MP4 box or null}\n  FRAG_PARSING_DATA: 'hlsFragParsingData',\n  // fired when fragment parsing is completed - data: { id : demuxer id, frag: fragment object }\n  FRAG_PARSED: 'hlsFragParsed',\n  // fired when fragment remuxed MP4 boxes have all been appended into SourceBuffer - data: { id : demuxer id, frag : fragment object, stats : { trequest, tfirst, tload, tparsed, tbuffered, length, bwEstimate } }\n  FRAG_BUFFERED: 'hlsFragBuffered',\n  // fired when fragment matching with current media position is changing - data : { id : demuxer id, frag : fragment object }\n  FRAG_CHANGED: 'hlsFragChanged',\n  // Identifier for a FPS drop event - data: { curentDropped, currentDecoded, totalDroppedFrames }\n  FPS_DROP: 'hlsFpsDrop',\n  //triggered when FPS drop triggers auto level capping - data: { level, droppedlevel }\n  FPS_DROP_LEVEL_CAPPING: 'hlsFpsDropLevelCapping',\n  // Identifier for an error event - data: { type : error type, details : error details, fatal : if true, hls.js cannot/will not try to recover, if false, hls.js will try to recover,other error specific data }\n  ERROR: 'hlsError',\n  // fired when hls.js instance starts destroying. Different from MEDIA_DETACHED as one could want to detach and reattach a media to the instance of hls.js to handle mid-rolls for example - data: { }\n  DESTROYING: 'hlsDestroying',\n  // fired when a decrypt key loading starts - data: { frag : fragment object }\n  KEY_LOADING: 'hlsKeyLoading',\n  // fired when a decrypt key loading is completed - data: { frag : fragment object, payload : key payload, stats : { trequest, tfirst, tload, length } }\n  KEY_LOADED: 'hlsKeyLoaded',\n  // fired upon stream controller state transitions - data: { previousState, nextState }\n  STREAM_STATE_TRANSITION: 'hlsStreamStateTransition'\n};\n\n\n\n// WEBPACK FOOTER //\n// src/events.js","/**\n *  AAC helper\n */\n\nclass AAC {\n  static getSilentFrame(codec,channelCount) {\n    switch(codec) {\n      case 'mp4a.40.2':\n        if (channelCount === 1) {\n          return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x23, 0x80]);\n        } else if (channelCount === 2) {\n          return new Uint8Array([0x21, 0x00, 0x49, 0x90, 0x02, 0x19, 0x00, 0x23, 0x80]);\n        } else if (channelCount === 3) {\n          return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x8e]);\n        } else if (channelCount === 4) {\n          return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x80, 0x2c, 0x80, 0x08, 0x02, 0x38]);\n        } else if (channelCount === 5) {\n          return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x38]);\n        } else if (channelCount === 6) {\n          return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x00, 0xb2, 0x00, 0x20, 0x08, 0xe0]);\n        }\n        break;\n    // handle HE-AAC below (mp4a.40.5 / mp4a.40.29)\n      default:\n        if (channelCount === 1) {\n          // ffmpeg -y -f lavfi -i \"aevalsrc=0:d=0.05\" -c:a libfdk_aac -profile:a aac_he -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n          return new Uint8Array([0x1,0x40,0x22,0x80,0xa3,0x4e,0xe6,0x80,0xba,0x8,0x0,0x0,0x0,0x1c,0x6,0xf1,0xc1,0xa,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5e]);\n        } else if (channelCount === 2) {\n          // ffmpeg -y -f lavfi -i \"aevalsrc=0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n          return new Uint8Array([0x1,0x40,0x22,0x80,0xa3,0x5e,0xe6,0x80,0xba,0x8,0x0,0x0,0x0,0x0,0x95,0x0,0x6,0xf1,0xa1,0xa,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5e]);\n        } else if (channelCount === 3) {\n          // ffmpeg -y -f lavfi -i \"aevalsrc=0|0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n          return new Uint8Array([0x1,0x40,0x22,0x80,0xa3,0x5e,0xe6,0x80,0xba,0x8,0x0,0x0,0x0,0x0,0x95,0x0,0x6,0xf1,0xa1,0xa,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5a,0x5e]);\n        }\n        break;\n    }\n    return null;\n  }\n}\n\nexport default AAC;\n\n\n\n// WEBPACK FOOTER //\n// src/helper/aac.js","/**\n * Buffer Helper utils, providing methods dealing buffer length retrieval\n*/\n\nconst BufferHelper = {\n  isBuffered : function(media,position) {\n    if (media) {\n      let buffered = media.buffered;\n      for (let i = 0; i < buffered.length; i++) {\n        if (position >= buffered.start(i) && position <= buffered.end(i)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  },\n\n  bufferInfo : function(media, pos,maxHoleDuration) {\n    if (media) {\n      var vbuffered = media.buffered, buffered = [],i;\n      for (i = 0; i < vbuffered.length; i++) {\n        buffered.push({start: vbuffered.start(i), end: vbuffered.end(i)});\n      }\n      return this.bufferedInfo(buffered,pos,maxHoleDuration);\n    } else {\n      return {len: 0, start: pos, end: pos, nextStart : undefined} ;\n    }\n  },\n\n  bufferedInfo : function(buffered,pos,maxHoleDuration) {\n    var buffered2 = [],\n        // bufferStart and bufferEnd are buffer boundaries around current video position\n        bufferLen,bufferStart, bufferEnd,bufferStartNext,i;\n    // sort on buffer.start/smaller end (IE does not always return sorted buffered range)\n    buffered.sort(function (a, b) {\n      var diff = a.start - b.start;\n      if (diff) {\n        return diff;\n      } else {\n        return b.end - a.end;\n      }\n    });\n    // there might be some small holes between buffer time range\n    // consider that holes smaller than maxHoleDuration are irrelevant and build another\n    // buffer time range representations that discards those holes\n    for (i = 0; i < buffered.length; i++) {\n      var buf2len = buffered2.length;\n      if(buf2len) {\n        var buf2end = buffered2[buf2len - 1].end;\n        // if small hole (value between 0 or maxHoleDuration ) or overlapping (negative)\n        if((buffered[i].start - buf2end) < maxHoleDuration) {\n          // merge overlapping time ranges\n          // update lastRange.end only if smaller than item.end\n          // e.g.  [ 1, 15] with  [ 2,8] => [ 1,15] (no need to modify lastRange.end)\n          // whereas [ 1, 8] with  [ 2,15] => [ 1,15] ( lastRange should switch from [1,8] to [1,15])\n          if(buffered[i].end > buf2end) {\n            buffered2[buf2len - 1].end = buffered[i].end;\n          }\n        } else {\n          // big hole\n          buffered2.push(buffered[i]);\n        }\n      } else {\n        // first value\n        buffered2.push(buffered[i]);\n      }\n    }\n    for (i = 0, bufferLen = 0, bufferStart = bufferEnd = pos; i < buffered2.length; i++) {\n      var start =  buffered2[i].start,\n          end = buffered2[i].end;\n      //logger.log('buf start/end:' + buffered.start(i) + '/' + buffered.end(i));\n      if ((pos + maxHoleDuration) >= start && pos < end) {\n        // play position is inside this buffer TimeRange, retrieve end of buffer position and buffer length\n        bufferStart = start;\n        bufferEnd = end;\n        bufferLen = bufferEnd - pos;\n      } else if ((pos + maxHoleDuration) < start) {\n        bufferStartNext = start;\n        break;\n      }\n    }\n    return {len: bufferLen, start: bufferStart, end: bufferEnd, nextStart : bufferStartNext};\n  }\n};\n\nmodule.exports = BufferHelper;\n\n\n\n// WEBPACK FOOTER //\n// src/helper/buffer-helper.js","/**\n * Level Helper class, providing methods dealing with playlist sliding and drift\n*/\n\nimport {logger} from '../utils/logger';\n\nconst LevelHelper = {\n\n  mergeDetails : function(oldDetails,newDetails) {\n    var start = Math.max(oldDetails.startSN,newDetails.startSN)-newDetails.startSN,\n        end = Math.min(oldDetails.endSN,newDetails.endSN)-newDetails.startSN,\n        delta = newDetails.startSN - oldDetails.startSN,\n        oldfragments = oldDetails.fragments,\n        newfragments = newDetails.fragments,\n        ccOffset =0,\n        PTSFrag;\n\n    // check if old/new playlists have fragments in common\n    if ( end < start) {\n      newDetails.PTSKnown = false;\n      return;\n    }\n    // loop through overlapping SN and update startPTS , cc, and duration if any found\n    for(var i = start ; i <= end ; i++) {\n      var oldFrag = oldfragments[delta+i],\n          newFrag = newfragments[i];\n      if (newFrag && oldFrag) {\n        ccOffset = oldFrag.cc - newFrag.cc;\n        if (!isNaN(oldFrag.startPTS)) {\n          newFrag.start = newFrag.startPTS = oldFrag.startPTS;\n          newFrag.endPTS = oldFrag.endPTS;\n          newFrag.duration = oldFrag.duration;\n          newFrag.backtracked = oldFrag.backtracked;\n          newFrag.dropped = oldFrag.dropped;\n          PTSFrag = newFrag;\n        }\n      }\n    }\n\n    if(ccOffset) {\n      logger.log(`discontinuity sliding from playlist, take drift into account`);\n      for(i = 0 ; i < newfragments.length ; i++) {\n        newfragments[i].cc += ccOffset;\n      }\n    }\n\n    // if at least one fragment contains PTS info, recompute PTS information for all fragments\n    if(PTSFrag) {\n      LevelHelper.updateFragPTSDTS(newDetails,PTSFrag,PTSFrag.startPTS,PTSFrag.endPTS,PTSFrag.startDTS,PTSFrag.endDTS);\n    } else {\n      // ensure that delta is within oldfragments range\n      // also adjust sliding in case delta is 0 (we could have old=[50-60] and new=old=[50-61])\n      // in that case we also need to adjust start offset of all fragments\n      if (delta >= 0 && delta < oldfragments.length) {\n        // adjust start by sliding offset\n        var sliding = oldfragments[delta].start;\n        for(i = 0 ; i < newfragments.length ; i++) {\n          newfragments[i].start += sliding;\n        }\n      }\n    }\n    // if we are here, it means we have fragments overlapping between\n    // old and new level. reliable PTS info is thus relying on old level\n    newDetails.PTSKnown = oldDetails.PTSKnown;\n    return;\n  },\n\n  updateFragPTSDTS : function(details,frag,startPTS,endPTS,startDTS,endDTS) {\n    // update frag PTS/DTS\n    if(!isNaN(frag.startPTS)) {\n      // delta PTS between audio and video\n      let deltaPTS = Math.abs(frag.startPTS-startPTS);\n      if (isNaN(frag.deltaPTS)) {\n        frag.deltaPTS = deltaPTS;\n      } else {\n        frag.deltaPTS = Math.max(deltaPTS,frag.deltaPTS);\n      }\n      startPTS = Math.min(startPTS,frag.startPTS);\n      endPTS = Math.max(endPTS, frag.endPTS);\n      startDTS = Math.min(startDTS,frag.startDTS);\n      endDTS = Math.max(endDTS, frag.endDTS);\n    }\n\n    const drift = startPTS - frag.start;\n    frag.start = frag.startPTS = startPTS;\n    frag.endPTS = endPTS;\n    frag.startDTS = startDTS;\n    frag.endDTS = endDTS;\n    frag.duration = endPTS - startPTS;\n\n    const sn = frag.sn;\n    // exit if sn out of range\n    if (!details || sn < details.startSN || sn > details.endSN) {\n      return 0;\n    }\n    var fragIdx, fragments, i;\n    fragIdx = sn - details.startSN;\n    fragments = details.fragments;\n    frag = fragments[fragIdx];\n    // adjust fragment PTS/duration from seqnum-1 to frag 0\n    for(i = fragIdx ; i > 0 ; i--) {\n      LevelHelper.updatePTS(fragments,i,i-1);\n    }\n\n    // adjust fragment PTS/duration from seqnum to last frag\n    for(i = fragIdx ; i < fragments.length - 1 ; i++) {\n      LevelHelper.updatePTS(fragments,i,i+1);\n    }\n    details.PTSKnown = true;\n    //logger.log(`                                            frag start/end:${startPTS.toFixed(3)}/${endPTS.toFixed(3)}`);\n\n    return drift;\n  },\n\n  updatePTS : function(fragments,fromIdx, toIdx) {\n    var fragFrom = fragments[fromIdx],fragTo = fragments[toIdx], fragToPTS = fragTo.startPTS;\n    // if we know startPTS[toIdx]\n    if(!isNaN(fragToPTS)) {\n      // update fragment duration.\n      // it helps to fix drifts between playlist reported duration and fragment real duration\n      if (toIdx > fromIdx) {\n        fragFrom.duration = fragToPTS-fragFrom.start;\n        if(fragFrom.duration < 0) {\n          logger.warn(`negative duration computed for frag ${fragFrom.sn},level ${fragFrom.level}, there should be some duration drift between playlist and fragment!`);\n        }\n      } else {\n        fragTo.duration = fragFrom.start - fragToPTS;\n        if(fragTo.duration < 0) {\n          logger.warn(`negative duration computed for frag ${fragTo.sn},level ${fragTo.level}, there should be some duration drift between playlist and fragment!`);\n        }\n      }\n    } else {\n      // we dont know startPTS[toIdx]\n      if (toIdx > fromIdx) {\n        fragTo.start = fragFrom.start + fragFrom.duration;\n      } else {\n        fragTo.start = Math.max(fragFrom.start - fragTo.duration, 0);\n      }\n    }\n  }\n};\n\nmodule.exports = LevelHelper;\n\n\n\n// WEBPACK FOOTER //\n// src/helper/level-helper.js","/**\n * HLS interface\n */\n'use strict';\n\nimport URLToolkit from 'url-toolkit';\nimport Event from './events';\nimport {ErrorTypes, ErrorDetails} from './errors';\nimport PlaylistLoader from './loader/playlist-loader';\nimport FragmentLoader from './loader/fragment-loader';\nimport KeyLoader from './loader/key-loader';\n\nimport StreamController from  './controller/stream-controller';\nimport LevelController from  './controller/level-controller';\nimport ID3TrackController from './controller/id3-track-controller';\n\nimport {logger, enableLogs} from './utils/logger';\nimport EventEmitter from 'events';\nimport {hlsDefaultConfig} from './config';\n\nclass Hls {\n\n  static get version() {\n    // replaced with browserify-versionify transform\n    return '0.7.9';\n  }\n\n  static isSupported() {\n    const mediaSource = window.MediaSource = window.MediaSource || window.WebKitMediaSource;\n    const sourceBuffer = window.SourceBuffer = window.SourceBuffer || window.WebKitSourceBuffer;\n    const isTypeSupported = mediaSource &&\n                            typeof mediaSource.isTypeSupported === 'function' &&\n                            mediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\n\n    // if SourceBuffer is exposed ensure its API is valid\n    // safari and old version of Chrome doe not expose SourceBuffer globally so checking SourceBuffer.prototype is impossible\n    const sourceBufferValidAPI = !sourceBuffer ||\n                                 (sourceBuffer.prototype &&\n                                 typeof sourceBuffer.prototype.appendBuffer === 'function' &&\n                                 typeof sourceBuffer.prototype.remove === 'function');\n    return isTypeSupported && sourceBufferValidAPI;\n  }\n\n  static get Events() {\n    return Event;\n  }\n\n  static get ErrorTypes() {\n    return ErrorTypes;\n  }\n\n  static get ErrorDetails() {\n    return ErrorDetails;\n  }\n\n  static get DefaultConfig() {\n    if(!Hls.defaultConfig) {\n      return hlsDefaultConfig;\n    }\n    return Hls.defaultConfig;\n  }\n\n  static set DefaultConfig(defaultConfig) {\n    Hls.defaultConfig = defaultConfig;\n  }\n\n  constructor(config = {}) {\n    var defaultConfig = Hls.DefaultConfig;\n\n    if ((config.liveSyncDurationCount || config.liveMaxLatencyDurationCount) && (config.liveSyncDuration || config.liveMaxLatencyDuration)) {\n      throw new Error('Illegal hls.js config: don\\'t mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration');\n    }\n\n    for (var prop in defaultConfig) {\n        if (prop in config) { continue; }\n        config[prop] = defaultConfig[prop];\n    }\n\n    if (config.liveMaxLatencyDurationCount !== undefined && config.liveMaxLatencyDurationCount <= config.liveSyncDurationCount) {\n      throw new Error('Illegal hls.js config: \"liveMaxLatencyDurationCount\" must be gt \"liveSyncDurationCount\"');\n    }\n\n    if (config.liveMaxLatencyDuration !== undefined && (config.liveMaxLatencyDuration <= config.liveSyncDuration || config.liveSyncDuration === undefined)) {\n      throw new Error('Illegal hls.js config: \"liveMaxLatencyDuration\" must be gt \"liveSyncDuration\"');\n    }\n\n    enableLogs(config.debug);\n    this.config = config;\n    this._autoLevelCapping = -1;\n    // observer setup\n    var observer = this.observer = new EventEmitter();\n    observer.trigger = function trigger (event, ...data) {\n      observer.emit(event, event, ...data);\n    };\n\n    observer.off = function off (event, ...data) {\n      observer.removeListener(event, ...data);\n    };\n    this.on = observer.on.bind(observer);\n    this.off = observer.off.bind(observer);\n    this.trigger = observer.trigger.bind(observer);\n\n    // core controllers and network loaders\n    const abrController = this.abrController = new config.abrController(this);\n    const bufferController  = new config.bufferController(this);\n    const capLevelController = new config.capLevelController(this);\n    const fpsController = new config.fpsController(this);\n    const playListLoader = new PlaylistLoader(this);\n    const fragmentLoader = new FragmentLoader(this);\n    const keyLoader = new KeyLoader(this);\n    const id3TrackController = new ID3TrackController(this);\n\n    // network controllers\n    const levelController = this.levelController = new LevelController(this);\n    const streamController = this.streamController = new StreamController(this);\n    let networkControllers = [levelController, streamController];\n\n    // optional audio stream controller\n    let Controller = config.audioStreamController;\n    if (Controller) {\n      networkControllers.push(new Controller(this));\n    }\n    this.networkControllers = networkControllers;\n\n    let coreComponents = [ playListLoader, fragmentLoader, keyLoader, abrController, bufferController, capLevelController, fpsController, id3TrackController ];\n\n    // optional audio track and subtitle controller\n    Controller = config.audioTrackController;\n    if (Controller) {\n      let audioTrackController = new Controller(this);\n      this.audioTrackController = audioTrackController;\n      coreComponents.push(audioTrackController);\n    }\n\n    Controller = config.subtitleTrackController;\n    if (Controller) {\n      let subtitleTrackController = new Controller(this);\n      this.subtitleTrackController = subtitleTrackController;\n      coreComponents.push(subtitleTrackController);\n    }\n\n    // optional subtitle controller\n    [config.subtitleStreamController, config.timelineController].forEach(Controller => {\n      if (Controller) {\n        coreComponents.push(new Controller(this));\n      }\n    });\n    this.coreComponents = coreComponents;\n  }\n\n  destroy() {\n    logger.log('destroy');\n    this.trigger(Event.DESTROYING);\n    this.detachMedia();\n    this.coreComponents.concat(this.networkControllers).forEach(component => {component.destroy();});\n    this.url = null;\n    this.observer.removeAllListeners();\n    this._autoLevelCapping = -1;\n  }\n\n  attachMedia(media) {\n    logger.log('attachMedia');\n    this.media = media;\n    this.trigger(Event.MEDIA_ATTACHING, {media: media});\n  }\n\n  detachMedia() {\n    logger.log('detachMedia');\n    this.trigger(Event.MEDIA_DETACHING);\n    this.media = null;\n  }\n\n  loadSource(url) {\n    url = URLToolkit.buildAbsoluteURL(window.location.href, url, { alwaysNormalize: true });\n    logger.log(`loadSource:${url}`);\n    this.url = url;\n    // when attaching to a source URL, trigger a playlist load\n    this.trigger(Event.MANIFEST_LOADING, {url: url});\n  }\n\n  startLoad(startPosition=-1) {\n    logger.log(`startLoad(${startPosition})`);\n    this.networkControllers.forEach(controller => {controller.startLoad(startPosition);});\n  }\n\n  stopLoad() {\n    logger.log('stopLoad');\n    this.networkControllers.forEach(controller => {controller.stopLoad();});\n  }\n\n  swapAudioCodec() {\n    logger.log('swapAudioCodec');\n    this.streamController.swapAudioCodec();\n  }\n\n  recoverMediaError() {\n    logger.log('recoverMediaError');\n    var media = this.media;\n    this.detachMedia();\n    this.attachMedia(media);\n  }\n\n  /** Return all quality levels **/\n  get levels() {\n    return this.levelController.levels;\n  }\n\n  /** Return current playback quality level **/\n  get currentLevel() {\n    return this.streamController.currentLevel;\n  }\n\n  /* set quality level immediately (-1 for automatic level selection) */\n  set currentLevel(newLevel) {\n    logger.log(`set currentLevel:${newLevel}`);\n    this.loadLevel = newLevel;\n    this.streamController.immediateLevelSwitch();\n  }\n\n  /** Return next playback quality level (quality level of next fragment) **/\n  get nextLevel() {\n    return this.streamController.nextLevel;\n  }\n\n  /* set quality level for next fragment (-1 for automatic level selection) */\n  set nextLevel(newLevel) {\n    logger.log(`set nextLevel:${newLevel}`);\n    this.levelController.manualLevel = newLevel;\n    this.streamController.nextLevelSwitch();\n  }\n\n  /** Return the quality level of current/last loaded fragment **/\n  get loadLevel() {\n    return this.levelController.level;\n  }\n\n  /* set quality level for current/next loaded fragment (-1 for automatic level selection) */\n  set loadLevel(newLevel) {\n    logger.log(`set loadLevel:${newLevel}`);\n    this.levelController.manualLevel = newLevel;\n  }\n\n  /** Return the quality level of next loaded fragment **/\n  get nextLoadLevel() {\n    return this.levelController.nextLoadLevel;\n  }\n\n  /** set quality level of next loaded fragment **/\n  set nextLoadLevel(level) {\n    this.levelController.nextLoadLevel = level;\n  }\n\n  /** Return first level (index of first level referenced in manifest)\n  **/\n  get firstLevel() {\n    return Math.max(this.levelController.firstLevel, this.minAutoLevel);\n  }\n\n  /** set first level (index of first level referenced in manifest)\n  **/\n  set firstLevel(newLevel) {\n    logger.log(`set firstLevel:${newLevel}`);\n    this.levelController.firstLevel = newLevel;\n  }\n\n  /** Return start level (level of first fragment that will be played back)\n      if not overrided by user, first level appearing in manifest will be used as start level\n      if -1 : automatic start level selection, playback will start from level matching download bandwidth (determined from download of first segment)\n  **/\n  get startLevel() {\n    return this.levelController.startLevel;\n  }\n\n  /** set  start level (level of first fragment that will be played back)\n      if not overrided by user, first level appearing in manifest will be used as start level\n      if -1 : automatic start level selection, playback will start from level matching download bandwidth (determined from download of first segment)\n  **/\n  set startLevel(newLevel) {\n    logger.log(`set startLevel:${newLevel}`);\n    const hls = this;\n    // if not in automatic start level detection, ensure startLevel is greater than minAutoLevel\n    if (newLevel !== -1) {\n      newLevel = Math.max(newLevel,hls.minAutoLevel);\n    }\n    hls.levelController.startLevel = newLevel;\n  }\n\n  /** Return the capping/max level value that could be used by automatic level selection algorithm **/\n  get autoLevelCapping() {\n    return this._autoLevelCapping;\n  }\n\n  /** set the capping/max level value that could be used by automatic level selection algorithm **/\n  set autoLevelCapping(newLevel) {\n    logger.log(`set autoLevelCapping:${newLevel}`);\n    this._autoLevelCapping = newLevel;\n  }\n\n  /* check if we are in automatic level selection mode */\n  get autoLevelEnabled() {\n    return (this.levelController.manualLevel === -1);\n  }\n\n  /* return manual level */\n  get manualLevel() {\n    return this.levelController.manualLevel;\n  }\n\n  /* return min level selectable in auto mode according to config.minAutoBitrate */\n  get minAutoLevel() {\n    let hls = this, levels = hls.levels, minAutoBitrate = hls.config.minAutoBitrate, len = levels ? levels.length : 0;\n    for (let i = 0; i < len; i++) {\n      const levelNextBitrate = levels[i].realBitrate ? Math.max(levels[i].realBitrate,levels[i].bitrate) : levels[i].bitrate;\n      if (levelNextBitrate > minAutoBitrate) {\n        return i;\n      }\n    }\n    return 0;\n  }\n\n  /* return max level selectable in auto mode according to autoLevelCapping */\n  get maxAutoLevel() {\n    const hls = this;\n    const levels = hls.levels;\n    const autoLevelCapping = hls.autoLevelCapping;\n    let maxAutoLevel;\n    if (autoLevelCapping=== -1 && levels && levels.length) {\n      maxAutoLevel = levels.length - 1;\n    } else {\n      maxAutoLevel = autoLevelCapping;\n    }\n    return maxAutoLevel;\n  }\n\n  // return next auto level\n  get nextAutoLevel() {\n    const hls = this;\n    // ensure next auto level is between  min and max auto level\n    return Math.min(Math.max(hls.abrController.nextAutoLevel,hls.minAutoLevel),hls.maxAutoLevel);\n  }\n\n  // this setter is used to force next auto level\n  // this is useful to force a switch down in auto mode : in case of load error on level N, hls.js can set nextAutoLevel to N-1 for example)\n  // forced value is valid for one fragment. upon succesful frag loading at forced level, this value will be resetted to -1 by ABR controller\n  set nextAutoLevel(nextLevel) {\n    const hls = this;\n    hls.abrController.nextAutoLevel = Math.max(hls.minAutoLevel,nextLevel);\n  }\n\n  /** get alternate audio tracks list from playlist **/\n  get audioTracks() {\n    const audioTrackController = this.audioTrackController;\n    return audioTrackController ? audioTrackController.audioTracks : [];\n  }\n\n  /** get index of the selected audio track (index in audio track lists) **/\n  get audioTrack() {\n    const audioTrackController = this.audioTrackController;\n    return audioTrackController ? audioTrackController.audioTrack : -1;\n  }\n\n  /** select an audio track, based on its index in audio track lists**/\n  set audioTrack(audioTrackId) {\n    const audioTrackController = this.audioTrackController;\n    if (audioTrackController) {\n      audioTrackController.audioTrack = audioTrackId;\n    }\n  }\n\n  get liveSyncPosition() {\n    return this.streamController.liveSyncPosition;\n  }\n\n  /** get alternate subtitle tracks list from playlist **/\n  get subtitleTracks() {\n    const subtitleTrackController = this.subtitleTrackController;\n    return subtitleTrackController ? subtitleTrackController.subtitleTracks : [];\n  }\n\n  /** get index of the selected subtitle track (index in subtitle track lists) **/\n  get subtitleTrack() {\n    const subtitleTrackController = this.subtitleTrackController;\n    return subtitleTrackController ? subtitleTrackController.subtitleTrack : -1;\n  }\n\n  /** select an subtitle track, based on its index in subtitle track lists**/\n  set subtitleTrack(subtitleTrackId) {\n    const subtitleTrackController = this.subtitleTrackController;\n    if (subtitleTrackController) {\n      subtitleTrackController.subtitleTrack = subtitleTrackId;\n    }\n  }\n}\n\nexport default Hls;\n\n\n\n// WEBPACK FOOTER //\n// src/hls.js","// This is mostly for support of the es6 module export\n// syntax with the babel compiler, it looks like it doesnt support\n// function exports like we are used to in node/commonjs\nmodule.exports = require('./hls.js').default;\n\n\n\n// WEBPACK FOOTER //\n// src/index.js","/*\n * Fragment Loader\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport {logger} from '../utils/logger';\n\nclass FragmentLoader extends EventHandler {\n\n  constructor(hls) {\n    super(hls, Event.FRAG_LOADING);\n    this.loaders = {};\n  }\n\n  destroy() {\n    let loaders = this.loaders;\n    for (let loaderName in loaders) {\n      let loader = loaders[loaderName];\n      if (loader) {\n        loader.destroy();\n      }\n    }\n    this.loaders = {};\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onFragLoading(data) {\n    let frag = data.frag,\n        type = frag.type,\n        loader = this.loaders[type],\n        config = this.hls.config;\n\n    frag.loaded = 0;\n    if (loader) {\n      logger.warn(`abort previous fragment loader for type:${type}`);\n      loader.abort();\n    }\n    loader  = this.loaders[type] = frag.loader = typeof(config.fLoader) !== 'undefined' ? new config.fLoader(config) : new config.loader(config);\n\n    let loaderContext, loaderConfig, loaderCallbacks;\n    loaderContext = { url : frag.url, frag : frag, responseType : 'arraybuffer', progressData : false};\n    let start = frag.byteRangeStartOffset, end = frag.byteRangeEndOffset;\n    if (!isNaN(start) && !isNaN(end)) {\n      loaderContext.rangeStart = start;\n      loaderContext.rangeEnd = end;\n    }\n    loaderConfig = { timeout : config.fragLoadingTimeOut, maxRetry : 0 , retryDelay : 0, maxRetryDelay : config.fragLoadingMaxRetryTimeout};\n    loaderCallbacks = { onSuccess : this.loadsuccess.bind(this), onError :this.loaderror.bind(this), onTimeout : this.loadtimeout.bind(this), onProgress: this.loadprogress.bind(this)};\n    loader.load(loaderContext,loaderConfig,loaderCallbacks);\n  }\n\n  loadsuccess(response, stats, context) {\n    let payload = response.data, frag = context.frag;\n    // detach fragment loader on load success\n    frag.loader = undefined;\n    this.loaders[frag.type] = undefined;\n    this.hls.trigger(Event.FRAG_LOADED, {payload: payload, frag: frag, stats: stats});\n  }\n\n  loaderror(response, context) {\n    let loader = context.loader;\n    if (loader) {\n      loader.abort();\n    }\n    this.loaders[context.type] = undefined;\n    this.hls.trigger(Event.ERROR, {type: ErrorTypes.NETWORK_ERROR, details: ErrorDetails.FRAG_LOAD_ERROR, fatal: false, frag: context.frag, response: response});\n  }\n\n  loadtimeout(stats, context) {\n    let loader = context.loader;\n    if (loader) {\n      loader.abort();\n    }\n    this.loaders[context.type] = undefined;\n    this.hls.trigger(Event.ERROR, {type: ErrorTypes.NETWORK_ERROR, details: ErrorDetails.FRAG_LOAD_TIMEOUT, fatal: false, frag: context.frag});\n  }\n\n  // data will be used for progressive parsing\n  loadprogress(stats, context, data) { // jshint ignore:line\n    let frag = context.frag;\n    frag.loaded = stats.loaded;\n    this.hls.trigger(Event.FRAG_LOAD_PROGRESS, {frag: frag, stats: stats});\n  }\n}\n\nexport default FragmentLoader;\n\n\n\n// WEBPACK FOOTER //\n// src/loader/fragment-loader.js","/*\n * Decrypt key Loader\n*/\n\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport {logger} from '../utils/logger';\n\nclass KeyLoader extends EventHandler {\n\n  constructor(hls) {\n    super(hls, Event.KEY_LOADING);\n    this.loaders = {};\n    this.decryptkey = null;\n    this.decrypturl = null;\n  }\n\n  destroy() {\n    for (let loaderName in this.loaders) {\n      let loader = this.loaders[loaderName];\n      if (loader) {\n        loader.destroy();\n      }\n    }\n    this.loaders = {};\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onKeyLoading(data) {\n    let frag = data.frag,\n        type = frag.type,\n        loader = this.loaders[type],\n        decryptdata = frag.decryptdata,\n        uri = decryptdata.uri;\n        // if uri is different from previous one or if decrypt key not retrieved yet\n      if (uri !== this.decrypturl || this.decryptkey === null) {\n        let config = this.hls.config;\n\n        if (loader) {\n          logger.warn(`abort previous key loader for type:${type}`);\n          loader.abort();\n        }\n        frag.loader = this.loaders[type] = new config.loader(config);\n        this.decrypturl = uri;\n        this.decryptkey = null;\n\n        let loaderContext, loaderConfig, loaderCallbacks;\n        loaderContext = { url : uri, frag : frag, responseType : 'arraybuffer'};\n        loaderConfig = { timeout : config.fragLoadingTimeOut, maxRetry : config.fragLoadingMaxRetry , retryDelay : config.fragLoadingRetryDelay, maxRetryDelay : config.fragLoadingMaxRetryTimeout};\n        loaderCallbacks = { onSuccess : this.loadsuccess.bind(this), onError :this.loaderror.bind(this), onTimeout : this.loadtimeout.bind(this)};\n        frag.loader.load(loaderContext,loaderConfig,loaderCallbacks);\n      } else if (this.decryptkey) {\n        // we already loaded this key, return it\n        decryptdata.key = this.decryptkey;\n        this.hls.trigger(Event.KEY_LOADED, {frag: frag});\n      }\n  }\n\n  loadsuccess(response, stats, context) {\n    let frag = context.frag;\n    this.decryptkey = frag.decryptdata.key = new Uint8Array(response.data);\n    // detach fragment loader on load success\n    frag.loader = undefined;\n    this.loaders[frag.type] = undefined;\n    this.hls.trigger(Event.KEY_LOADED, {frag: frag});\n  }\n\n  loaderror(response, context) {\n    let frag = context.frag,\n        loader = frag.loader;\n    if (loader) {\n      loader.abort();\n    }\n    this.loaders[context.type] = undefined;\n    this.hls.trigger(Event.ERROR, {type: ErrorTypes.NETWORK_ERROR, details: ErrorDetails.KEY_LOAD_ERROR, fatal: false, frag: frag, response: response});\n  }\n\n  loadtimeout(stats, context) {\n    let frag = context.frag,\n        loader = frag.loader;\n    if (loader) {\n      loader.abort();\n    }\n    this.loaders[context.type] = undefined;\n    this.hls.trigger(Event.ERROR, {type: ErrorTypes.NETWORK_ERROR, details: ErrorDetails.KEY_LOAD_TIMEOUT, fatal: false, frag: frag});\n  }\n}\n\nexport default KeyLoader;\n\n\n\n// WEBPACK FOOTER //\n// src/loader/key-loader.js","/**\n * Playlist Loader\n*/\n\nimport URLToolkit from 'url-toolkit';\nimport Event from '../events';\nimport EventHandler from '../event-handler';\nimport {ErrorTypes, ErrorDetails} from '../errors';\nimport AttrList from '../utils/attr-list';\nimport {logger} from '../utils/logger';\n\n// https://regex101.com is your friend\nconst MASTER_PLAYLIST_REGEX = /#EXT-X-STREAM-INF:([^\\n\\r]*)[\\r\\n]+([^\\r\\n]+)/g;\nconst MASTER_PLAYLIST_MEDIA_REGEX = /#EXT-X-MEDIA:(.*)/g;\nconst LEVEL_PLAYLIST_REGEX_FAST = /#EXTINF:(\\d*(?:\\.\\d+)?)(?:,(.*))?|(?!#)(\\S.+)|#EXT-X-BYTERANGE: *(.+)|#EXT-X-PROGRAM-DATE-TIME:(.+)|#.*/g;\nconst LEVEL_PLAYLIST_REGEX_SLOW = /(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\\d+))|(?:#EXT-X-(TARGETDURATION): *(\\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\\r?\\n?/;\n\nclass LevelKey {\n\n  constructor() {\n    this.method = null;\n    this.key = null;\n    this.iv = null;\n    this._uri = null;\n  }\n\n  get uri() {\n    if (!this._uri && this.reluri) {\n      this._uri = URLToolkit.buildAbsoluteURL(this.baseuri, this.reluri, { alwaysNormalize: true });\n    }\n    return this._uri;\n  }\n\n}\n\nclass Fragment {\n\n  constructor() {\n    this._url = null;\n    this._byteRange = null;\n    this._decryptdata = null;\n    this.tagList = [];\n  }\n\n  get url() {\n    if (!this._url && this.relurl) {\n      this._url = URLToolkit.buildAbsoluteURL(this.baseurl, this.relurl, { alwaysNormalize: true });\n    }\n    return this._url;\n  }\n\n  set url(value) {\n    this._url = value;\n  }\n\n  get programDateTime() {\n    if (!this._programDateTime && this.rawProgramDateTime) {\n      this._programDateTime = new Date(Date.parse(this.rawProgramDateTime));\n    }\n    return this._programDateTime;\n  }\n\n  get byteRange() {\n    if (!this._byteRange) {\n      let byteRange = this._byteRange = [];\n      if (this.rawByteRange) {\n        const params = this.rawByteRange.split('@', 2);\n        if (params.length === 1) {\n          const lastByteRangeEndOffset = this.lastByteRangeEndOffset;\n          byteRange[0] = lastByteRangeEndOffset ? lastByteRangeEndOffset : 0;\n        } else {\n          byteRange[0] = parseInt(params[1]);\n        }\n        byteRange[1] = parseInt(params[0]) + byteRange[0];\n      }\n    }\n    return this._byteRange;\n  }\n\n  get byteRangeStartOffset() {\n    return this.byteRange[0];\n  }\n\n  get byteRangeEndOffset() {\n    return this.byteRange[1];\n  }\n\n  get decryptdata() {\n    if (!this._decryptdata) {\n      this._decryptdata = this.fragmentDecryptdataFromLevelkey(this.levelkey, this.sn);\n    }\n    return this._decryptdata;\n  }\n\n  /**\n   * Utility method for parseLevelPlaylist to create an initialization vector for a given segment\n   * @returns {Uint8Array}\n   */\n  createInitializationVector(segmentNumber) {\n    var uint8View = new Uint8Array(16);\n\n    for (var i = 12; i < 16; i++) {\n      uint8View[i] = (segmentNumber >> 8 * (15 - i)) & 0xff;\n    }\n\n    return uint8View;\n  }\n\n  /**\n   * Utility method for parseLevelPlaylist to get a fragment's decryption data from the currently parsed encryption key data\n   * @param levelkey - a playlist's encryption info\n   * @param segmentNumber - the fragment's segment number\n   * @returns {*} - an object to be applied as a fragment's decryptdata\n   */\n  fragmentDecryptdataFromLevelkey(levelkey, segmentNumber) {\n    var decryptdata = levelkey;\n\n    if (levelkey && levelkey.method && levelkey.uri && !levelkey.iv) {\n      decryptdata = new LevelKey();\n      decryptdata.method = levelkey.method;\n      decryptdata.baseuri = levelkey.baseuri;\n      decryptdata.reluri = levelkey.reluri;\n      decryptdata.iv = this.createInitializationVector(segmentNumber);\n    }\n\n    return decryptdata;\n  }\n\n  cloneObj(obj) {\n    return JSON.parse(JSON.stringify(obj));\n  }\n}\n\nclass PlaylistLoader extends EventHandler {\n\n  constructor(hls) {\n    super(hls,\n      Event.MANIFEST_LOADING,\n      Event.LEVEL_LOADING,\n      Event.AUDIO_TRACK_LOADING,\n      Event.SUBTITLE_TRACK_LOADING);\n    this.loaders = {};\n  }\n\n  destroy() {\n    for (let loaderName in this.loaders) {\n      let loader = this.loaders[loaderName];\n      if (loader) {\n        loader.destroy();\n      }\n    }\n    this.loaders = {};\n    EventHandler.prototype.destroy.call(this);\n  }\n\n  onManifestLoading(data) {\n    this.load(data.url, { type : 'manifest'});\n  }\n\n  onLevelLoading(data) {\n    this.load(data.url, { type : 'level', level : data.level, id : data.id});\n  }\n\n  onAudioTrackLoading(data) {\n    this.load(data.url, { type : 'audioTrack', id : data.id});\n  }\n\n  onSubtitleTrackLoading(data) {\n    this.load(data.url, { type : 'subtitleTrack', id : data.id});\n  }\n\n  load(url, context) {\n    let loader = this.loaders[context.type];\n    if (loader) {\n      let loaderContext = loader.context;\n      if (loaderContext && loaderContext.url === url) {\n        logger.trace(`playlist request ongoing`);\n        return;\n      } else {\n        logger.warn(`abort previous loader for type:${context.type}`);\n        loader.abort();\n      }\n    }\n    let config = this.hls.config,\n        retry,\n        timeout,\n        retryDelay,\n        maxRetryDelay;\n    if(context.type === 'manifest') {\n      retry = config.manifestLoadingMaxRetry;\n      timeout = config.manifestLoadingTimeOut;\n      retryDelay = config.manifestLoadingRetryDelay;\n      maxRetryDelay = config.manifestLoadingMaxRetryTimeout;\n    } else {\n      retry = config.levelLoadingMaxRetry;\n      timeout = config.levelLoadingTimeOut;\n      retryDelay = config.levelLoadingRetryDelay;\n      maxRetryDelay = config.levelLoadingMaxRetryTimeout;\n      logger.log(`loading playlist for ${context.type} ${context.level || context.id}`);\n    }\n    loader  = this.loaders[context.type] = context.loader = typeof(config.pLoader) !== 'undefined' ? new config.pLoader(config) : new config.loader(config);\n    context.url = url;\n    context.responseType = '';\n\n    let loaderConfig, loaderCallbacks;\n    loaderConfig = { timeout : timeout, maxRetry : retry , retryDelay : retryDelay, maxRetryDelay : maxRetryDelay};\n    loaderCallbacks = { onSuccess : this.loadsuccess.bind(this), onError :this.loaderror.bind(this), onTimeout : this.loadtimeout.bind(this)};\n    loader.load(context,loaderConfig,loaderCallbacks);\n  }\n\n  resolve(url, baseUrl) {\n    return URLToolkit.buildAbsoluteURL(baseUrl, url, { alwaysNormalize: true });\n  }\n\n  parseMasterPlaylist(string, baseurl) {\n    let levels = [], result;\n    MASTER_PLAYLIST_REGEX.lastIndex = 0;\n    while ((result = MASTER_PLAYLIST_REGEX.exec(string)) != null){\n      const level = {};\n\n      var attrs = level.attrs = new AttrList(result[1]);\n      level.url = this.resolve(result[2], baseurl);\n\n      var resolution = attrs.decimalResolution('RESOLUTION');\n      if(resolution) {\n        level.width = resolution.width;\n        level.height = resolution.height;\n      }\n      level.bitrate = attrs.decimalInteger('AVERAGE-BANDWIDTH') || attrs.decimalInteger('BANDWIDTH');\n      level.name = attrs.NAME;\n\n      var codecs = attrs.CODECS;\n      if(codecs) {\n        codecs = codecs.split(/[ ,]+/);\n        for (let i = 0; i < codecs.length; i++) {\n          const codec = codecs[i];\n          if (codec.indexOf('avc1') !== -1) {\n            level.videoCodec = this.avc1toavcoti(codec);\n          } else {\n            level.audioCodec = codec;\n          }\n        }\n      }\n\n      levels.push(level);\n    }\n    return levels;\n  }\n\n  parseMasterPlaylistMedia(string, baseurl, type) {\n    let result, medias = [], id = 0;\n    MASTER_PLAYLIST_MEDIA_REGEX.lastIndex = 0;\n    while ((result = MASTER_PLAYLIST_MEDIA_REGEX.exec(string)) != null){\n      const media = {};\n      var attrs = new AttrList(result[1]);\n      if(attrs.TYPE === type) {\n        media.groupId = attrs['GROUP-ID'];\n        media.name = attrs.NAME;\n        media.type = type;\n        media.default = (attrs.DEFAULT === 'YES');\n        media.autoselect = (attrs.AUTOSELECT === 'YES');\n        media.forced = (attrs.FORCED === 'YES');\n        if (attrs.URI) {\n          media.url = this.resolve(attrs.URI, baseurl);\n        }\n        media.lang = attrs.LANGUAGE;\n        if(!media.name) {\n            media.name = media.lang;\n        }\n        media.id = id++;\n        medias.push(media);\n      }\n    }\n    return medias;\n  }\n\n  avc1toavcoti(codec) {\n    var result, avcdata = codec.split('.');\n    if (avcdata.length > 2) {\n      result = avcdata.shift() + '.';\n      result += parseInt(avcdata.shift()).toString(16);\n      result += ('000' + parseInt(avcdata.shift()).toString(16)).substr(-4);\n    } else {\n      result = codec;\n    }\n    return result;\n  }\n\n  parseLevelPlaylist(string, baseurl, id, type) {\n    var currentSN = 0,\n        totalduration = 0,\n        level = {type: null, version: null, url: baseurl, fragments: [], live: true, startSN: 0},\n        levelkey = new LevelKey(),\n        cc = 0,\n        prevFrag = null,\n        frag = new Fragment(),\n        result,\n        i;\n\n    LEVEL_PLAYLIST_REGEX_FAST.lastIndex = 0;\n\n    while ((result = LEVEL_PLAYLIST_REGEX_FAST.exec(string)) !== null) {\n      const duration = result[1];\n      if (duration) { // INF\n        frag.duration = parseFloat(duration);\n        // avoid sliced strings    https://github.com/video-dev/hls.js/issues/939\n        const title = (' ' + result[2]).slice(1);\n        frag.title = title ? title : null;\n        frag.tagList.push(title ? [ 'INF',duration,title ] : [ 'INF',duration ]);\n      } else if (result[3]) { // url\n        if (!isNaN(frag.duration)) {\n          const sn = currentSN++;\n          frag.type = type;\n          frag.start = totalduration;\n          frag.levelkey = levelkey;\n          frag.sn = sn;\n          frag.level = id;\n          frag.cc = cc;\n          frag.baseurl = baseurl;\n          // avoid sliced strings    https://github.com/video-dev/hls.js/issues/939\n          frag.relurl = (' ' + result[3]).slice(1);\n\n          level.fragments.push(frag);\n          prevFrag = frag;\n          totalduration += frag.duration;\n\n          frag = new Fragment();\n        }\n      } else if (result[4]) { // X-BYTERANGE\n        frag.rawByteRange = (' ' + result[4]).slice(1);\n        if (prevFrag) {\n          const lastByteRangeEndOffset = prevFrag.byteRangeEndOffset;\n          if (lastByteRangeEndOffset) {\n            frag.lastByteRangeEndOffset = lastByteRangeEndOffset;\n          }\n        }\n      } else if (result[5]) { // PROGRAM-DATE-TIME\n        // avoid sliced strings    https://github.com/video-dev/hls.js/issues/939\n        frag.rawProgramDateTime = (' ' + result[5]).slice(1);\n        frag.tagList.push(['PROGRAM-DATE-TIME', frag.rawProgramDateTime]);\n      } else {\n        result = result[0].match(LEVEL_PLAYLIST_REGEX_SLOW);\n        for (i = 1; i < result.length; i++) {\n          if (result[i] !== undefined) {\n            break;\n          }\n        }\n\n        // avoid sliced strings    https://github.com/video-dev/hls.js/issues/939\n        const value1 = (' ' + result[i+1]).slice(1);\n        const value2 = (' ' + result[i+2]).slice(1);\n\n        switch (result[i]) {\n          case '#':\n            frag.tagList.push(value2 ? [ value1,value2 ] : [ value1 ]);\n            break;\n          case 'PLAYLIST-TYPE':\n            level.type = value1.toUpperCase();\n            break;\n          case 'MEDIA-SEQUENCE':\n            currentSN = level.startSN = parseInt(value1);\n            break;\n          case 'TARGETDURATION':\n            level.targetduration = parseFloat(value1);\n            break;\n          case 'VERSION':\n            level.version = parseInt(value1);\n            break;\n          case 'EXTM3U':\n            break;\n          case 'ENDLIST':\n            level.live = false;\n            break;\n          case 'DIS':\n            cc++;\n            frag.tagList.push(['DIS']);\n            break;\n          case 'DISCONTINUITY-SEQ':\n            cc = parseInt(value1);\n            break;\n          case 'KEY':\n            // https://tools.ietf.org/html/draft-pantos-http-live-streaming-08#section-3.4.4\n            var decryptparams = value1;\n            var keyAttrs = new AttrList(decryptparams);\n            var decryptmethod = keyAttrs.enumeratedString('METHOD'),\n                decrypturi = keyAttrs.URI,\n                decryptiv = keyAttrs.hexadecimalInteger('IV');\n            if (decryptmethod) {\n              levelkey = new LevelKey();\n              if ((decrypturi) && (['AES-128', 'SAMPLE-AES'].indexOf(decryptmethod) >= 0)) {\n                levelkey.method = decryptmethod;\n                // URI to get the key\n                levelkey.baseuri = baseurl;\n                levelkey.reluri = decrypturi;\n                levelkey.key = null;\n                // Initialization Vector (IV)\n                levelkey.iv = decryptiv;\n              }\n            }\n            break;\n          case 'START':\n            let startParams = value1;\n            let startAttrs = new AttrList(startParams);\n            let startTimeOffset = startAttrs.decimalFloatingPoint('TIME-OFFSET');\n            //TIME-OFFSET can be 0\n            if ( !isNaN(startTimeOffset) ) {\n              level.startTimeOffset = startTimeOffset;\n            }\n            break;\n          case 'MAP':\n            let mapAttrs = new AttrList(value1);\n            frag.relurl = mapAttrs.URI;\n            frag.rawByteRange = mapAttrs.BYTERANGE;\n            frag.baseurl = baseurl;\n            frag.level = id;\n            frag.type = type;\n            frag.sn = 'initSegment';\n            level.initSegment = frag;\n            frag = new Fragment();\n            break;\n          default:\n            logger.warn(`line parsed but not handled: ${result}`);\n            break;\n        }\n      }\n    }\n    frag = prevFrag;\n    //logger.log('found ' + level.fragments.length + ' fragments');\n    if(frag && !frag.relurl) {\n      level.fragments.pop();\n      totalduration-=frag.duration;\n    }\n    level.totalduration = totalduration;\n    level.averagetargetduration = totalduration / level.fragments.length;\n    level.endSN = currentSN - 1;\n    return level;\n  }\n\n  loadsuccess(response, stats, context) {\n    var string = response.data,\n        url = response.url,\n        type = context.type,\n        id = context.id,\n        level = context.level,\n        hls = this.hls;\n\n    this.loaders[type] = undefined;\n    // responseURL not supported on some browsers (it is used to detect URL redirection)\n    // data-uri mode also not supported (but no need to detect redirection)\n    if (url === undefined || url.indexOf('data:') === 0) {\n      // fallback to initial URL\n      url = context.url;\n    }\n    stats.tload = performance.now();\n    //stats.mtime = new Date(target.getResponseHeader('Last-Modified'));\n    if (string.indexOf('#EXTM3U') === 0) {\n      if (string.indexOf('#EXTINF:') > 0) {\n        let isLevel = (type !== 'audioTrack' && type !== 'subtitleTrack'),\n            levelId = !isNaN(level) ? level : !isNaN(id) ? id : 0,\n            levelDetails = this.parseLevelPlaylist(string, url, levelId, (type === 'audioTrack' ? 'audio' : (type === 'subtitleTrack' ? 'subtitle' : 'main') ));\n            levelDetails.tload = stats.tload;\n        if (type === 'manifest') {\n        // first request, stream manifest (no master playlist), fire manifest loaded event with level details\n          hls.trigger(Event.MANIFEST_LOADED, {levels: [{url: url, details : levelDetails}], audioTracks : [], url: url, stats: stats});\n        }\n        stats.tparsed = performance.now();\n        if (levelDetails.targetduration) {\n          if (isLevel) {\n            hls.trigger(Event.LEVEL_LOADED, {details: levelDetails, level: level || 0, id: id || 0, stats: stats});\n          } else {\n            if (type === 'audioTrack') {\n              hls.trigger(Event.AUDIO_TRACK_LOADED, {details: levelDetails, id: id, stats: stats});\n            }\n            else if (type === 'subtitleTrack') {\n              hls.trigger(Event.SUBTITLE_TRACK_LOADED, {details: levelDetails, id: id, stats: stats});\n            }\n          }\n        } else {\n          hls.trigger(Event.ERROR, {type: ErrorTypes.NETWORK_ERROR, details: ErrorDetails.MANIFEST_PARSING_ERROR, fatal: true, url: url, reason: 'invalid targetduration'});\n        }\n      } else {\n        let levels = this.parseMasterPlaylist(string, url);\n        // multi level playlist, parse level info\n        if (levels.length) {\n          let audioTracks = this.parseMasterPlaylistMedia(string, url, 'AUDIO');\n          let subtitles = this.parseMasterPlaylistMedia(string, url, 'SUBTITLES');\n          if (audioTracks.length) {\n            // check if we have found an audio track embedded in main playlist (audio track without URI attribute)\n            let embeddedAudioFound = false;\n            audioTracks.forEach(audioTrack => {\n              if(!audioTrack.url) {\n                embeddedAudioFound = true;\n              }\n            });\n            // if no embedded audio track defined, but audio codec signaled in quality level, we need to signal this main audio track\n            // this could happen with playlists with alt audio rendition in which quality levels (main) contains both audio+video. but with mixed audio track not signaled\n            if (embeddedAudioFound === false && levels[0].audioCodec && !levels[0].attrs.AUDIO) {\n              logger.log('audio codec signaled in quality level, but no embedded audio track signaled, create one');\n              audioTracks.unshift({ type : 'main', name : 'main'});\n            }\n          }\n          hls.trigger(Event.MANIFEST_LOADED, {levels, audioTracks, subtitles, url, stats});\n        } else {\n          hls.trigger(Event.ERROR, {type: ErrorTypes.NETWORK_ERROR, details: ErrorDetails.MANIFEST_PARSING_ERROR, fatal: true, url: url, reason: 'no level found in manifest'});\n        }\n      }\n    } else {\n      hls.trigger(Event.ERROR, {type: ErrorTypes.NETWORK_ERROR, details: ErrorDetails.MANIFEST_PARSING_ERROR, fatal: true, url: url, reason: 'no EXTM3U delimiter'});\n    }\n  }\n\n  loaderror(response, context) {\n    var details, fatal,loader = context.loader;\n    switch(context.type) {\n      case 'manifest':\n        details = ErrorDetails.MANIFEST_LOAD_ERROR;\n        fatal = true;\n        break;\n      case 'level':\n        details = ErrorDetails.LEVEL_LOAD_ERROR;\n        fatal = false;\n        break;\n      case 'audioTrack':\n        details = ErrorDetails.AUDIO_TRACK_LOAD_ERROR;\n        fatal = false;\n        break;\n    }\n    if (loader) {\n      loader.abort();\n      this.loaders[context.type] = undefined;\n    }\n    this.hls.trigger(Event.ERROR, {type: ErrorTypes.NETWORK_ERROR, details: details, fatal: fatal, url: loader.url, loader: loader, response: response, context : context});\n  }\n\n  loadtimeout(stats, context) {\n    var details, fatal, loader = context.loader;\n    switch(context.type) {\n      case 'manifest':\n        details = ErrorDetails.MANIFEST_LOAD_TIMEOUT;\n        fatal = true;\n        break;\n      case 'level':\n        details = ErrorDetails.LEVEL_LOAD_TIMEOUT;\n        fatal = false;\n        break;\n      case 'audioTrack':\n        details = ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT;\n        fatal = false;\n        break;\n    }\n    if (loader) {\n      loader.abort();\n      this.loaders[context.type] = undefined;\n    }\n    this.hls.trigger(Event.ERROR, {type: ErrorTypes.NETWORK_ERROR, details: details, fatal: fatal, url: loader.url, loader: loader, context : context});\n  }\n}\n\nexport default PlaylistLoader;\n\n\n\n// WEBPACK FOOTER //\n// src/loader/playlist-loader.js","/**\n * Generate MP4 Box\n*/\n\n//import Hex from '../utils/hex';\n\nconst UINT32_MAX = Math.pow(2, 32) - 1;\n\nclass MP4 {\n  static init() {\n    MP4.types = {\n      avc1: [], // codingname\n      avcC: [],\n      btrt: [],\n      dinf: [],\n      dref: [],\n      esds: [],\n      ftyp: [],\n      hdlr: [],\n      mdat: [],\n      mdhd: [],\n      mdia: [],\n      mfhd: [],\n      minf: [],\n      moof: [],\n      moov: [],\n      mp4a: [],\n      '.mp3': [],\n      mvex: [],\n      mvhd: [],\n      pasp: [],\n      sdtp: [],\n      stbl: [],\n      stco: [],\n      stsc: [],\n      stsd: [],\n      stsz: [],\n      stts: [],\n      tfdt: [],\n      tfhd: [],\n      traf: [],\n      trak: [],\n      trun: [],\n      trex: [],\n      tkhd: [],\n      vmhd: [],\n      smhd: []\n    };\n\n    var i;\n    for (i in MP4.types) {\n      if (MP4.types.hasOwnProperty(i)) {\n        MP4.types[i] = [\n          i.charCodeAt(0),\n          i.charCodeAt(1),\n          i.charCodeAt(2),\n          i.charCodeAt(3)\n        ];\n      }\n    }\n\n    var videoHdlr = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // pre_defined\n      0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x56, 0x69, 0x64, 0x65,\n      0x6f, 0x48, 0x61, 0x6e,\n      0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'VideoHandler'\n    ]);\n\n    var audioHdlr = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // pre_defined\n      0x73, 0x6f, 0x75, 0x6e, // handler_type: 'soun'\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x53, 0x6f, 0x75, 0x6e,\n      0x64, 0x48, 0x61, 0x6e,\n      0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'SoundHandler'\n    ]);\n\n    MP4.HDLR_TYPES = {\n      'video': videoHdlr,\n      'audio': audioHdlr\n    };\n\n    var dref = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x01, // entry_count\n      0x00, 0x00, 0x00, 0x0c, // entry_size\n      0x75, 0x72, 0x6c, 0x20, // 'url' type\n      0x00, // version 0\n      0x00, 0x00, 0x01 // entry_flags\n    ]);\n\n    var stco = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00 // entry_count\n    ]);\n\n    MP4.STTS = MP4.STSC = MP4.STCO = stco;\n\n    MP4.STSZ = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // sample_size\n      0x00, 0x00, 0x00, 0x00, // sample_count\n    ]);\n    MP4.VMHD = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x01, // flags\n      0x00, 0x00, // graphicsmode\n      0x00, 0x00,\n      0x00, 0x00,\n      0x00, 0x00 // opcolor\n    ]);\n    MP4.SMHD = new Uint8Array([\n      0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, // balance\n      0x00, 0x00 // reserved\n    ]);\n\n    MP4.STSD = new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x01]);// entry_count\n\n    var majorBrand = new Uint8Array([105,115,111,109]); // isom\n    var avc1Brand = new Uint8Array([97,118,99,49]); // avc1\n    var minorVersion = new Uint8Array([0, 0, 0, 1]);\n\n    MP4.FTYP = MP4.box(MP4.types.ftyp, majorBrand, minorVersion, majorBrand, avc1Brand);\n    MP4.DINF = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, dref));\n  }\n\n  static box(type) {\n  var\n    payload = Array.prototype.slice.call(arguments, 1),\n    size = 8,\n    i = payload.length,\n    len = i,\n    result;\n    // calculate the total size we need to allocate\n    while (i--) {\n      size += payload[i].byteLength;\n    }\n    result = new Uint8Array(size);\n    result[0] = (size >> 24) & 0xff;\n    result[1] = (size >> 16) & 0xff;\n    result[2] = (size >> 8) & 0xff;\n    result[3] = size  & 0xff;\n    result.set(type, 4);\n    // copy the payload into the result\n    for (i = 0, size = 8; i < len; i++) {\n      // copy payload[i] array @ offset size\n      result.set(payload[i], size);\n      size += payload[i].byteLength;\n    }\n    return result;\n  }\n\n  static hdlr(type) {\n    return MP4.box(MP4.types.hdlr, MP4.HDLR_TYPES[type]);\n  }\n\n  static mdat(data) {\n    return MP4.box(MP4.types.mdat, data);\n  }\n\n  static mdhd(timescale, duration) {\n    duration *= timescale;\n    const upperWordDuration = Math.floor(duration / (UINT32_MAX + 1));\n    const lowerWordDuration = Math.floor(duration % (UINT32_MAX + 1));\n    return MP4.box(MP4.types.mdhd, new Uint8Array([\n      0x01, // version 1\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, // creation_time\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, // modification_time\n      (timescale >> 24) & 0xFF,\n      (timescale >> 16) & 0xFF,\n      (timescale >>  8) & 0xFF,\n      timescale & 0xFF, // timescale\n      (upperWordDuration >> 24),\n      (upperWordDuration >> 16) & 0xFF,\n      (upperWordDuration >>  8) & 0xFF,\n      upperWordDuration & 0xFF,\n      (lowerWordDuration >> 24),\n      (lowerWordDuration >> 16) & 0xFF,\n      (lowerWordDuration >>  8) & 0xFF,\n      lowerWordDuration & 0xFF,\n      0x55, 0xc4, // 'und' language (undetermined)\n      0x00, 0x00\n    ]));\n  }\n\n  static mdia(track) {\n    return MP4.box(MP4.types.mdia, MP4.mdhd(track.timescale, track.duration), MP4.hdlr(track.type), MP4.minf(track));\n  }\n\n  static mfhd(sequenceNumber) {\n    return MP4.box(MP4.types.mfhd, new Uint8Array([\n      0x00,\n      0x00, 0x00, 0x00, // flags\n      (sequenceNumber >> 24),\n      (sequenceNumber >> 16) & 0xFF,\n      (sequenceNumber >>  8) & 0xFF,\n      sequenceNumber & 0xFF, // sequence_number\n    ]));\n  }\n\n  static minf(track) {\n    if (track.type === 'audio') {\n      return MP4.box(MP4.types.minf, MP4.box(MP4.types.smhd, MP4.SMHD), MP4.DINF, MP4.stbl(track));\n    } else {\n      return MP4.box(MP4.types.minf, MP4.box(MP4.types.vmhd, MP4.VMHD), MP4.DINF, MP4.stbl(track));\n    }\n  }\n\n  static moof(sn, baseMediaDecodeTime, track) {\n    return MP4.box(MP4.types.moof, MP4.mfhd(sn), MP4.traf(track,baseMediaDecodeTime));\n  }\n/**\n * @param tracks... (optional) {array} the tracks associated with this movie\n */\n  static moov(tracks) {\n    var\n      i = tracks.length,\n      boxes = [];\n\n    while (i--) {\n      boxes[i] = MP4.trak(tracks[i]);\n    }\n\n    return MP4.box.apply(null, [MP4.types.moov, MP4.mvhd(tracks[0].timescale, tracks[0].duration)].concat(boxes).concat(MP4.mvex(tracks)));\n  }\n\n  static mvex(tracks) {\n    var\n      i = tracks.length,\n      boxes = [];\n\n    while (i--) {\n      boxes[i] = MP4.trex(tracks[i]);\n    }\n    return MP4.box.apply(null, [MP4.types.mvex].concat(boxes));\n  }\n\n  static mvhd(timescale,duration) {\n    duration*=timescale;\n    const upperWordDuration = Math.floor(duration / (UINT32_MAX + 1));\n    const lowerWordDuration = Math.floor(duration % (UINT32_MAX + 1));\n    var\n      bytes = new Uint8Array([\n        0x01, // version 1\n        0x00, 0x00, 0x00, // flags\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, // creation_time\n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, // modification_time\n        (timescale >> 24) & 0xFF,\n        (timescale >> 16) & 0xFF,\n        (timescale >>  8) & 0xFF,\n        timescale & 0xFF, // timescale\n        (upperWordDuration >> 24),\n        (upperWordDuration >> 16) & 0xFF,\n        (upperWordDuration >>  8) & 0xFF,\n        upperWordDuration & 0xFF,\n        (lowerWordDuration >> 24),\n        (lowerWordDuration >> 16) & 0xFF,\n        (lowerWordDuration >>  8) & 0xFF,\n        lowerWordDuration & 0xFF,\n        0x00, 0x01, 0x00, 0x00, // 1.0 rate\n        0x01, 0x00, // 1.0 volume\n        0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x01, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x01, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00, // pre_defined\n        0xff, 0xff, 0xff, 0xff // next_track_ID\n      ]);\n    return MP4.box(MP4.types.mvhd, bytes);\n  }\n\n  static sdtp(track) {\n    var\n      samples = track.samples || [],\n      bytes = new Uint8Array(4 + samples.length),\n      flags,\n      i;\n    // leave the full box header (4 bytes) all zero\n    // write the sample table\n    for (i = 0; i < samples.length; i++) {\n      flags = samples[i].flags;\n      bytes[i + 4] = (flags.dependsOn << 4) |\n        (flags.isDependedOn << 2) |\n        (flags.hasRedundancy);\n    }\n\n    return MP4.box(MP4.types.sdtp, bytes);\n  }\n\n  static stbl(track) {\n    return MP4.box(MP4.types.stbl, MP4.stsd(track), MP4.box(MP4.types.stts, MP4.STTS), MP4.box(MP4.types.stsc, MP4.STSC), MP4.box(MP4.types.stsz, MP4.STSZ), MP4.box(MP4.types.stco, MP4.STCO));\n  }\n\n  static avc1(track) {\n    var sps = [], pps = [], i, data, len;\n    // assemble the SPSs\n\n    for (i = 0; i < track.sps.length; i++) {\n      data = track.sps[i];\n      len = data.byteLength;\n      sps.push((len >>> 8) & 0xFF);\n      sps.push((len & 0xFF));\n      sps = sps.concat(Array.prototype.slice.call(data)); // SPS\n    }\n\n    // assemble the PPSs\n    for (i = 0; i < track.pps.length; i++) {\n      data = track.pps[i];\n      len = data.byteLength;\n      pps.push((len >>> 8) & 0xFF);\n      pps.push((len & 0xFF));\n      pps = pps.concat(Array.prototype.slice.call(data));\n    }\n\n    var avcc = MP4.box(MP4.types.avcC, new Uint8Array([\n            0x01,   // version\n            sps[3], // profile\n            sps[4], // profile compat\n            sps[5], // level\n            0xfc | 3, // lengthSizeMinusOne, hard-coded to 4 bytes\n            0xE0 | track.sps.length // 3bit reserved (111) + numOfSequenceParameterSets\n          ].concat(sps).concat([\n            track.pps.length // numOfPictureParameterSets\n          ]).concat(pps))), // \"PPS\"\n        width = track.width,\n        height = track.height,\n        hSpacing = track.pixelRatio[0],\n        vSpacing = track.pixelRatio[1];\n    //console.log('avcc:' + Hex.hexDump(avcc));\n    return MP4.box(MP4.types.avc1, new Uint8Array([\n        0x00, 0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, // reserved\n        0x00, 0x01, // data_reference_index\n        0x00, 0x00, // pre_defined\n        0x00, 0x00, // reserved\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00, // pre_defined\n        (width >> 8) & 0xFF,\n        width & 0xff, // width\n        (height >> 8) & 0xFF,\n        height & 0xff, // height\n        0x00, 0x48, 0x00, 0x00, // horizresolution\n        0x00, 0x48, 0x00, 0x00, // vertresolution\n        0x00, 0x00, 0x00, 0x00, // reserved\n        0x00, 0x01, // frame_count\n        0x12,\n        0x64, 0x61, 0x69, 0x6C, //dailymotion/hls.js\n        0x79, 0x6D, 0x6F, 0x74,\n        0x69, 0x6F, 0x6E, 0x2F,\n        0x68, 0x6C, 0x73, 0x2E,\n        0x6A, 0x73, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, // compressorname\n        0x00, 0x18,   // depth = 24\n        0x11, 0x11]), // pre_defined = -1\n          avcc,\n          MP4.box(MP4.types.btrt, new Uint8Array([\n            0x00, 0x1c, 0x9c, 0x80, // bufferSizeDB\n            0x00, 0x2d, 0xc6, 0xc0, // maxBitrate\n            0x00, 0x2d, 0xc6, 0xc0])), // avgBitrate\n          MP4.box(MP4.types.pasp, new Uint8Array([\n            (hSpacing >> 24),         // hSpacing\n            (hSpacing >> 16) & 0xFF,\n            (hSpacing >>  8) & 0xFF,\n            hSpacing & 0xFF,\n            (vSpacing >> 24),         // vSpacing\n            (vSpacing >> 16) & 0xFF,\n            (vSpacing >>  8) & 0xFF,\n            vSpacing & 0xFF]))\n          );\n  }\n\n  static esds(track) {\n    var configlen = track.config.length;\n    return new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n\n      0x03, // descriptor_type\n      0x17+configlen, // length\n      0x00, 0x01, //es_id\n      0x00, // stream_priority\n\n      0x04, // descriptor_type\n      0x0f+configlen, // length\n      0x40, //codec : mpeg4_audio\n      0x15, // stream_type\n      0x00, 0x00, 0x00, // buffer_size\n      0x00, 0x00, 0x00, 0x00, // maxBitrate\n      0x00, 0x00, 0x00, 0x00, // avgBitrate\n\n      0x05 // descriptor_type\n      ].concat([configlen]).concat(track.config).concat([0x06, 0x01, 0x02])); // GASpecificConfig)); // length + audio config descriptor\n  }\n\n  static mp4a(track) {\n    var samplerate = track.samplerate;\n      return MP4.box(MP4.types.mp4a, new Uint8Array([\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // data_reference_index\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, track.channelCount, // channelcount\n      0x00, 0x10, // sampleSize:16bits\n      0x00, 0x00, 0x00, 0x00, // reserved2\n      (samplerate >> 8) & 0xFF,\n      samplerate & 0xff, //\n      0x00, 0x00]),\n      MP4.box(MP4.types.esds, MP4.esds(track)));\n  }\n\n  static mp3(track) {\n    var samplerate = track.samplerate;\n      return MP4.box(MP4.types['.mp3'], new Uint8Array([\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // data_reference_index\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, track.channelCount, // channelcount\n      0x00, 0x10, // sampleSize:16bits\n      0x00, 0x00, 0x00, 0x00, // reserved2\n      (samplerate >> 8) & 0xFF,\n      samplerate & 0xff, //\n      0x00, 0x00]));\n  }\n\n  static stsd(track) {\n    if (track.type === 'audio') {\n      if (!track.isAAC && track.codec === 'mp3') {\n        return MP4.box(MP4.types.stsd, MP4.STSD, MP4.mp3(track));\n      }\n      return MP4.box(MP4.types.stsd, MP4.STSD, MP4.mp4a(track));\n    } else {\n      return MP4.box(MP4.types.stsd, MP4.STSD, MP4.avc1(track));\n    }\n  }\n\n  static tkhd(track) {\n    var id = track.id,\n        duration = track.duration*track.timescale,\n        width = track.width,\n        height = track.height,\n        upperWordDuration = Math.floor(duration / (UINT32_MAX + 1)),\n        lowerWordDuration = Math.floor(duration % (UINT32_MAX + 1));\n    return MP4.box(MP4.types.tkhd, new Uint8Array([\n      0x01, // version 1\n      0x00, 0x00, 0x07, // flags\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, // creation_time\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, // modification_time\n      (id >> 24) & 0xFF,\n      (id >> 16) & 0xFF,\n      (id >> 8) & 0xFF,\n      id & 0xFF, // track_ID\n      0x00, 0x00, 0x00, 0x00, // reserved\n      (upperWordDuration >> 24),\n      (upperWordDuration >> 16) & 0xFF,\n      (upperWordDuration >>  8) & 0xFF,\n      upperWordDuration & 0xFF,\n      (lowerWordDuration >> 24),\n      (lowerWordDuration >> 16) & 0xFF,\n      (lowerWordDuration >>  8) & 0xFF,\n      lowerWordDuration & 0xFF,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, // layer\n      0x00, 0x00, // alternate_group\n      0x00, 0x00, // non-audio track volume\n      0x00, 0x00, // reserved\n      0x00, 0x01, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x01, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x00, 0x00, 0x00, 0x00,\n      0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n      (width >> 8) & 0xFF,\n      width & 0xFF,\n      0x00, 0x00, // width\n      (height >> 8) & 0xFF,\n      height & 0xFF,\n      0x00, 0x00 // height\n    ]));\n  }\n\n  static traf(track,baseMediaDecodeTime) {\n    var sampleDependencyTable = MP4.sdtp(track),\n        id = track.id,\n        upperWordBaseMediaDecodeTime = Math.floor(baseMediaDecodeTime / (UINT32_MAX + 1)),\n        lowerWordBaseMediaDecodeTime = Math.floor(baseMediaDecodeTime % (UINT32_MAX + 1));\n    return MP4.box(MP4.types.traf,\n               MP4.box(MP4.types.tfhd, new Uint8Array([\n                 0x00, // version 0\n                 0x00, 0x00, 0x00, // flags\n                 (id >> 24),\n                 (id >> 16) & 0XFF,\n                 (id >> 8) & 0XFF,\n                 (id & 0xFF) // track_ID\n               ])),\n               MP4.box(MP4.types.tfdt, new Uint8Array([\n                 0x01, // version 1\n                 0x00, 0x00, 0x00, // flags\n                 (upperWordBaseMediaDecodeTime >>24),\n                 (upperWordBaseMediaDecodeTime >> 16) & 0XFF,\n                 (upperWordBaseMediaDecodeTime >> 8) & 0XFF,\n                 (upperWordBaseMediaDecodeTime & 0xFF),\n                 (lowerWordBaseMediaDecodeTime >>24),\n                 (lowerWordBaseMediaDecodeTime >> 16) & 0XFF,\n                 (lowerWordBaseMediaDecodeTime >> 8) & 0XFF,\n                 (lowerWordBaseMediaDecodeTime & 0xFF)\n               ])),\n               MP4.trun(track,\n                    sampleDependencyTable.length +\n                    16 + // tfhd\n                    20 + // tfdt\n                    8 +  // traf header\n                    16 + // mfhd\n                    8 +  // moof header\n                    8),  // mdat header\n               sampleDependencyTable);\n  }\n\n  /**\n   * Generate a track box.\n   * @param track {object} a track definition\n   * @return {Uint8Array} the track box\n   */\n  static trak(track) {\n    track.duration = track.duration || 0xffffffff;\n    return MP4.box(MP4.types.trak, MP4.tkhd(track), MP4.mdia(track));\n  }\n\n  static trex(track) {\n    var id = track.id;\n    return MP4.box(MP4.types.trex, new Uint8Array([\n      0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n     (id >> 24),\n     (id >> 16) & 0XFF,\n     (id >> 8) & 0XFF,\n     (id & 0xFF), // track_ID\n      0x00, 0x00, 0x00, 0x01, // default_sample_description_index\n      0x00, 0x00, 0x00, 0x00, // default_sample_duration\n      0x00, 0x00, 0x00, 0x00, // default_sample_size\n      0x00, 0x01, 0x00, 0x01 // default_sample_flags\n    ]));\n  }\n\n  static trun(track, offset) {\n    var samples= track.samples || [],\n        len = samples.length,\n        arraylen = 12 + (16 * len),\n        array = new Uint8Array(arraylen),\n        i,sample,duration,size,flags,cts;\n    offset += 8 + arraylen;\n    array.set([\n      0x00, // version 0\n      0x00, 0x0f, 0x01, // flags\n      (len >>> 24) & 0xFF,\n      (len >>> 16) & 0xFF,\n      (len >>> 8) & 0xFF,\n      len & 0xFF, // sample_count\n      (offset >>> 24) & 0xFF,\n      (offset >>> 16) & 0xFF,\n      (offset >>> 8) & 0xFF,\n      offset & 0xFF // data_offset\n    ],0);\n    for (i = 0; i < len; i++) {\n      sample = samples[i];\n      duration = sample.duration;\n      size = sample.size;\n      flags = sample.flags;\n      cts = sample.cts;\n      array.set([\n        (duration >>> 24) & 0xFF,\n        (duration >>> 16) & 0xFF,\n        (duration >>> 8) & 0xFF,\n        duration & 0xFF, // sample_duration\n        (size >>> 24) & 0xFF,\n        (size >>> 16) & 0xFF,\n        (size >>> 8) & 0xFF,\n        size & 0xFF, // sample_size\n        (flags.isLeading << 2) | flags.dependsOn,\n        (flags.isDependedOn << 6) |\n          (flags.hasRedundancy << 4) |\n          (flags.paddingValue << 1) |\n          flags.isNonSync,\n        flags.degradPrio & 0xF0 << 8,\n        flags.degradPrio & 0x0F, // sample_flags\n        (cts >>> 24) & 0xFF,\n        (cts >>> 16) & 0xFF,\n        (cts >>> 8) & 0xFF,\n        cts & 0xFF // sample_composition_time_offset\n      ],12+16*i);\n    }\n    return MP4.box(MP4.types.trun, array);\n  }\n\n  static initSegment(tracks) {\n    if (!MP4.types) {\n      MP4.init();\n    }\n    var movie = MP4.moov(tracks), result;\n    result = new Uint8Array(MP4.FTYP.byteLength + movie.byteLength);\n    result.set(MP4.FTYP);\n    result.set(movie, MP4.FTYP.byteLength);\n    return result;\n  }\n}\n\nexport default MP4;\n\n\n\n// WEBPACK FOOTER //\n// src/remux/mp4-generator.js"," /**\n * fMP4 remuxer\n*/\n\n\nimport AAC from '../helper/aac';\nimport Event from '../events';\nimport {logger} from '../utils/logger';\nimport MP4 from '../remux/mp4-generator';\nimport {ErrorTypes, ErrorDetails} from '../errors';\n\n// 10 seconds\nconst MAX_SILENT_FRAME_DURATION = 10 * 1000;\n\nclass MP4Remuxer {\n  constructor(observer, config, typeSupported, vendor) {\n    this.observer = observer;\n    this.config = config;\n    this.typeSupported = typeSupported;\n    const userAgent = navigator.userAgent;\n    this.isSafari = vendor && vendor.indexOf('Apple') > -1 && userAgent && !userAgent.match('CriOS');\n    this.ISGenerated = false;\n  }\n\n  destroy() {\n  }\n\n  resetTimeStamp(defaultTimeStamp) {\n    this._initPTS = this._initDTS = defaultTimeStamp;\n  }\n\n  resetInitSegment() {\n    this.ISGenerated = false;\n  }\n\n  remux(audioTrack,videoTrack,id3Track,textTrack,timeOffset, contiguous,accurateTimeOffset) {\n    // generate Init Segment if needed\n    if (!this.ISGenerated) {\n      this.generateIS(audioTrack,videoTrack,timeOffset);\n    }\n\n    if (this.ISGenerated) {\n      // Purposefully remuxing audio before video, so that remuxVideo can use nextAudioPts, which is\n      // calculated in remuxAudio.\n      //logger.log('nb AAC samples:' + audioTrack.samples.length);\n      if (audioTrack.samples.length) {\n        // if initSegment was generated without video samples, regenerate it again\n        if (!audioTrack.timescale) {\n          logger.warn('regenerate InitSegment as audio detected');\n          this.generateIS(audioTrack,videoTrack,timeOffset);\n        }\n        let audioData = this.remuxAudio(audioTrack,timeOffset,contiguous,accurateTimeOffset);\n        //logger.log('nb AVC samples:' + videoTrack.samples.length);\n        if (videoTrack.samples.length) {\n          let audioTrackLength;\n          if (audioData) {\n            audioTrackLength = audioData.endPTS - audioData.startPTS;\n          }\n          // if initSegment was generated without video samples, regenerate it again\n          if (!videoTrack.timescale) {\n            logger.warn('regenerate InitSegment as video detected');\n            this.generateIS(audioTrack,videoTrack,timeOffset);\n          }\n          this.remuxVideo(videoTrack,timeOffset,contiguous,audioTrackLength, accurateTimeOffset);\n        }\n      } else {\n        let videoData;\n        //logger.log('nb AVC samples:' + videoTrack.samples.length);\n        if (videoTrack.samples.length) {\n          videoData = this.remuxVideo(videoTrack,timeOffset,contiguous, accurateTimeOffset);\n        }\n        if (videoData && audioTrack.codec) {\n          this.remuxEmptyAudio(audioTrack, timeOffset, contiguous, videoData);\n        }\n      }\n    }\n    //logger.log('nb ID3 samples:' + audioTrack.samples.length);\n    if (id3Track.samples.length) {\n      this.remuxID3(id3Track,timeOffset);\n    }\n    //logger.log('nb ID3 samples:' + audioTrack.samples.length);\n    if (textTrack.samples.length) {\n      this.remuxText(textTrack,timeOffset);\n    }\n    //notify end of parsing\n    this.observer.trigger(Event.FRAG_PARSED);\n  }\n\n  generateIS(audioTrack,videoTrack,timeOffset) {\n    var observer = this.observer,\n        audioSamples = audioTrack.samples,\n        videoSamples = videoTrack.samples,\n        typeSupported = this.typeSupported,\n        container = 'audio/mp4',\n        tracks = {},\n        data = { tracks : tracks },\n        computePTSDTS = (this._initPTS === undefined),\n        initPTS, initDTS;\n\n    if (computePTSDTS) {\n      initPTS = initDTS = Infinity;\n    }\n    if (audioTrack.config && audioSamples.length) {\n      // let's use audio sampling rate as MP4 time scale.\n      // rationale is that there is a integer nb of audio frames per audio sample (1024 for AAC)\n      // using audio sampling rate here helps having an integer MP4 frame duration\n      // this avoids potential rounding issue and AV sync issue\n      audioTrack.timescale = audioTrack.samplerate;\n      logger.log (`audio sampling rate : ${audioTrack.samplerate}`);\n      if (!audioTrack.isAAC) {\n        if (typeSupported.mpeg) { // Chrome and Safari\n          container = 'audio/mpeg';\n          audioTrack.codec = '';\n        } else if (typeSupported.mp3) { // Firefox\n          audioTrack.codec = 'mp3';\n        }\n      }\n      tracks.audio = {\n        container : container,\n        codec :  audioTrack.codec,\n        initSegment : !audioTrack.isAAC && typeSupported.mpeg ? new Uint8Array() : MP4.initSegment([audioTrack]),\n        metadata : {\n          channelCount : audioTrack.channelCount\n        }\n      };\n      if (computePTSDTS) {\n        // remember first PTS of this demuxing context. for audio, PTS = DTS\n        initPTS = initDTS = audioSamples[0].pts - audioTrack.inputTimeScale * timeOffset;\n      }\n    }\n\n    if (videoTrack.sps && videoTrack.pps && videoSamples.length) {\n      // let's use input time scale as MP4 video timescale\n      // we use input time scale straight away to avoid rounding issues on frame duration / cts computation\n      const inputTimeScale = videoTrack.inputTimeScale;\n      videoTrack.timescale = inputTimeScale;\n      tracks.video = {\n        container : 'video/mp4',\n        codec :  videoTrack.codec,\n        initSegment : MP4.initSegment([videoTrack]),\n        metadata : {\n          width : videoTrack.width,\n          height : videoTrack.height\n        }\n      };\n      if (computePTSDTS) {\n        initPTS = Math.min(initPTS,videoSamples[0].pts - inputTimeScale * timeOffset);\n        initDTS = Math.min(initDTS,videoSamples[0].dts - inputTimeScale * timeOffset);\n        this.observer.trigger(Event.INIT_PTS_FOUND, { initPTS: initPTS});\n      }\n    }\n\n    if(Object.keys(tracks).length) {\n      observer.trigger(Event.FRAG_PARSING_INIT_SEGMENT,data);\n      this.ISGenerated = true;\n      if (computePTSDTS) {\n        this._initPTS = initPTS;\n        this._initDTS = initDTS;\n      }\n    } else {\n      observer.trigger(Event.ERROR, {type : ErrorTypes.MEDIA_ERROR, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: false, reason: 'no audio/video samples found'});\n    }\n  }\n\n  remuxVideo(track, timeOffset, contiguous, audioTrackLength, accurateTimeOffset) {\n    var offset = 8,\n        timeScale = track.timescale,\n        mp4SampleDuration,\n        mdat, moof,\n        firstPTS, firstDTS,\n        nextDTS,\n        lastPTS, lastDTS,\n        inputSamples = track.samples,\n        outputSamples = [],\n        nbSamples = inputSamples.length,\n        ptsNormalize = this._PTSNormalize,\n        initDTS = this._initDTS;\n\n  // for (let i = 0; i < track.samples.length; i++) {\n  //   let avcSample = track.samples[i];\n  //   let units = avcSample.units;\n  //   let unitsString = '';\n  //   for (let j = 0; j < units.length ; j++) {\n  //     unitsString += units[j].type + ',';\n  //     if (units[j].data.length < 500) {\n  //       unitsString += Hex.hexDump(units[j].data);\n  //     }\n  //   }\n  //   logger.log(avcSample.pts + '/' + avcSample.dts + ',' + unitsString + avcSample.units.length);\n  // }\n\n    // if parsed fragment is contiguous with last one, let's use last DTS value as reference\n    let nextAvcDts = this.nextAvcDts;\n\n    const isSafari = this.isSafari;\n\n    // Safari does not like overlapping DTS on consecutive fragments. let's use nextAvcDts to overcome this if fragments are consecutive\n    if (isSafari) {\n      // also consider consecutive fragments as being contiguous (even if a level switch occurs),\n      // for sake of clarity:\n      // consecutive fragments are frags with\n      //  - less than 100ms gaps between new time offset (if accurate) and next expected PTS OR\n      //  - less than 200 ms PTS gaps (timeScale/5)\n      contiguous |= (inputSamples.length && nextAvcDts &&\n                     ((accurateTimeOffset && Math.abs(timeOffset-nextAvcDts/timeScale) < 0.1) ||\n                      Math.abs((inputSamples[0].pts-nextAvcDts-initDTS)) < timeScale/5)\n                      );\n    }\n\n    if (!contiguous) {\n      // if not contiguous, let's use target timeOffset\n      nextAvcDts = timeOffset*timeScale;\n    }\n\n  // PTS is coded on 33bits, and can loop from -2^32 to 2^32\n  // ptsNormalize will make PTS/DTS value monotonic, we use last known DTS value as reference value\n    inputSamples.forEach(function(sample) {\n      sample.pts = ptsNormalize(sample.pts-initDTS, nextAvcDts);\n      sample.dts = ptsNormalize(sample.dts-initDTS, nextAvcDts);\n    });\n\n    // sort video samples by DTS then PTS then demux id order\n    inputSamples.sort(function(a, b) {\n      const deltadts = a.dts - b.dts;\n      const deltapts = a.pts - b.pts;\n      return deltadts ? deltadts : deltapts ? deltapts : (a.id - b.id);\n    });\n\n    // handle broken streams with PTS < DTS, tolerance up 200ms (18000 in 90kHz timescale)\n    let PTSDTSshift = inputSamples.reduce( (prev, curr) => Math.max(Math.min(prev,curr.pts-curr.dts),-18000),0);\n    if (PTSDTSshift < 0) {\n      logger.warn(`PTS < DTS detected in video samples, shifting DTS by ${Math.round(PTSDTSshift/90)} ms to overcome this issue`);\n      for (let i = 0; i < inputSamples.length; i++) {\n        inputSamples[i].dts += PTSDTSshift;\n      }\n    }\n\n    // compute first DTS and last DTS, normalize them against reference value\n    let sample = inputSamples[0];\n    firstDTS =  Math.max(sample.dts,0);\n    firstPTS =  Math.max(sample.pts,0);\n\n    // check timestamp continuity accross consecutive fragments (this is to remove inter-fragment gap/hole)\n    let delta = Math.round((firstDTS - nextAvcDts) / 90);\n    // if fragment are contiguous, detect hole/overlapping between fragments\n    if (contiguous) {\n      if (delta) {\n        if (delta > 1) {\n          logger.log(`AVC:${delta} ms hole between fragments detected,filling it`);\n        } else if (delta < -1) {\n          logger.log(`AVC:${(-delta)} ms overlapping between fragments detected`);\n        }\n        // remove hole/gap : set DTS to next expected DTS\n        firstDTS = nextAvcDts;\n        inputSamples[0].dts = firstDTS;\n        // offset PTS as well, ensure that PTS is smaller or equal than new DTS\n        firstPTS = Math.max(firstPTS - delta, nextAvcDts);\n        inputSamples[0].pts = firstPTS;\n        logger.log(`Video/PTS/DTS adjusted: ${Math.round(firstPTS/90)}/${Math.round(firstDTS/90)},delta:${delta} ms`);\n      }\n    }\n    nextDTS = firstDTS;\n\n    // compute lastPTS/lastDTS\n    sample = inputSamples[inputSamples.length-1];\n    lastDTS =  Math.max(sample.dts,0);\n    lastPTS =  Math.max(sample.pts,0,lastDTS);\n\n      // on Safari let's signal the same sample duration for all samples\n      // sample duration (as expected by trun MP4 boxes), should be the delta between sample DTS\n      // set this constant duration as being the avg delta between consecutive DTS.\n    if (isSafari) {\n      mp4SampleDuration = Math.round((lastDTS-firstDTS)/(inputSamples.length-1));\n    }\n\n    let nbNalu = 0, naluLen = 0;\n    for (let i = 0 ; i < nbSamples; i++) {\n      // compute total/avc sample length and nb of NAL units\n      let sample = inputSamples[i], units = sample.units, nbUnits = units.length, sampleLen = 0;\n      for (let j = 0; j < nbUnits; j++) {\n        sampleLen += units[j].data.length;\n      }\n      naluLen += sampleLen;\n      nbNalu += nbUnits;\n      sample.length = sampleLen;\n\n      // normalize PTS/DTS\n      if (isSafari) {\n        // sample DTS is computed using a constant decoding offset (mp4SampleDuration) between samples\n        sample.dts = firstDTS + i*mp4SampleDuration;\n      } else {\n        // ensure sample monotonic DTS\n        sample.dts = Math.max(sample.dts,firstDTS);\n      }\n      // ensure that computed value is greater or equal than sample DTS\n      sample.pts = Math.max(sample.pts , sample.dts);\n    }\n\n    /* concatenate the video data and construct the mdat in place\n      (need 8 more bytes to fill length and mpdat type) */\n    let mdatSize = naluLen + (4 * nbNalu) + 8;\n    try {\n      mdat = new Uint8Array(mdatSize);\n    } catch(err) {\n      this.observer.trigger(Event.ERROR, {type : ErrorTypes.MUX_ERROR, details: ErrorDetails.REMUX_ALLOC_ERROR, fatal: false, bytes : mdatSize, reason: `fail allocating video mdat ${mdatSize}`});\n      return;\n    }\n    let view = new DataView(mdat.buffer);\n    view.setUint32(0, mdatSize);\n    mdat.set(MP4.types.mdat, 4);\n\n    for (let i = 0 ; i < nbSamples; i++) {\n      let avcSample = inputSamples[i],\n          avcSampleUnits = avcSample.units,\n          mp4SampleLength = 0,\n          compositionTimeOffset;\n      // convert NALU bitstream to MP4 format (prepend NALU with size field)\n      for(let j = 0, nbUnits = avcSampleUnits.length; j < nbUnits ; j++) {\n        let unit = avcSampleUnits[j],\n            unitData = unit.data,\n            unitDataLen = unit.data.byteLength;\n        view.setUint32(offset, unitDataLen);\n        offset += 4;\n        mdat.set(unitData, offset);\n        offset += unitDataLen;\n        mp4SampleLength += 4 + unitDataLen;\n      }\n\n      if(!isSafari) {\n        // expected sample duration is the Decoding Timestamp diff of consecutive samples\n        if (i < nbSamples - 1) {\n          mp4SampleDuration = inputSamples[i+1].dts - avcSample.dts;\n        } else {\n          let config = this.config,\n              lastFrameDuration = avcSample.dts - inputSamples[i > 0 ? i-1 : i].dts;\n          if (config.stretchShortVideoTrack) {\n            // In some cases, a segment's audio track duration may exceed the video track duration.\n            // Since we've already remuxed audio, and we know how long the audio track is, we look to\n            // see if the delta to the next segment is longer than the minimum of maxBufferHole and\n            // maxSeekHole. If so, playback would potentially get stuck, so we artificially inflate\n            // the duration of the last frame to minimize any potential gap between segments.\n            let maxBufferHole = config.maxBufferHole,\n                maxSeekHole = config.maxSeekHole,\n                gapTolerance = Math.floor(Math.min(maxBufferHole, maxSeekHole) * timeScale),\n                deltaToFrameEnd = (audioTrackLength ? firstPTS + audioTrackLength * timeScale : this.nextAudioPts) - avcSample.pts;\n            if (deltaToFrameEnd > gapTolerance) {\n              // We subtract lastFrameDuration from deltaToFrameEnd to try to prevent any video\n              // frame overlap. maxBufferHole/maxSeekHole should be >> lastFrameDuration anyway.\n              mp4SampleDuration = deltaToFrameEnd - lastFrameDuration;\n              if (mp4SampleDuration < 0) {\n                mp4SampleDuration = lastFrameDuration;\n              }\n              logger.log(`It is approximately ${deltaToFrameEnd/90} ms to the next segment; using duration ${mp4SampleDuration/90} ms for the last video frame.`);\n            } else {\n              mp4SampleDuration = lastFrameDuration;\n            }\n          } else {\n            mp4SampleDuration = lastFrameDuration;\n          }\n        }\n        compositionTimeOffset = Math.round(avcSample.pts - avcSample.dts);\n      } else {\n        compositionTimeOffset = Math.max(0,mp4SampleDuration*Math.round((avcSample.pts - avcSample.dts)/mp4SampleDuration));\n      }\n\n\n      //console.log('PTS/DTS/initDTS/normPTS/normDTS/relative PTS : ${avcSample.pts}/${avcSample.dts}/${initDTS}/${ptsnorm}/${dtsnorm}/${(avcSample.pts/4294967296).toFixed(3)}');\n      outputSamples.push({\n        size: mp4SampleLength,\n         // constant duration\n        duration: mp4SampleDuration,\n        cts: compositionTimeOffset,\n        flags: {\n          isLeading: 0,\n          isDependedOn: 0,\n          hasRedundancy: 0,\n          degradPrio: 0,\n          dependsOn : avcSample.key ? 2 : 1,\n          isNonSync : avcSample.key ? 0 : 1\n        }\n      });\n    }\n    // next AVC sample DTS should be equal to last sample DTS + last sample duration (in PES timescale)\n    this.nextAvcDts = lastDTS + mp4SampleDuration;\n    let dropped = track.dropped;\n    track.len = 0;\n    track.nbNalu = 0;\n    track.dropped = 0;\n    if(outputSamples.length && navigator.userAgent.toLowerCase().indexOf('chrome') > -1) {\n      let flags = outputSamples[0].flags;\n    // chrome workaround, mark first sample as being a Random Access Point to avoid sourcebuffer append issue\n    // https://code.google.com/p/chromium/issues/detail?id=229412\n      flags.dependsOn = 2;\n      flags.isNonSync = 0;\n    }\n    track.samples = outputSamples;\n    moof = MP4.moof(track.sequenceNumber++, firstDTS , track);\n    track.samples = [];\n\n    let data = {\n      data1: moof,\n      data2: mdat,\n      startPTS: firstPTS / timeScale,\n      endPTS: (lastPTS +  mp4SampleDuration) / timeScale,\n      startDTS: firstDTS / timeScale,\n      endDTS: this.nextAvcDts / timeScale,\n      type: 'video',\n      nb: outputSamples.length,\n      dropped : dropped\n    };\n    this.observer.trigger(Event.FRAG_PARSING_DATA, data);\n    return data;\n  }\n\n  remuxAudio(track, timeOffset, contiguous,accurateTimeOffset) {\n    const inputTimeScale = track.inputTimeScale,\n          mp4timeScale = track.timescale,\n          scaleFactor = inputTimeScale/mp4timeScale,\n          mp4SampleDuration = track.isAAC ? 1024 : 1152,\n          inputSampleDuration = mp4SampleDuration * scaleFactor,\n          ptsNormalize = this._PTSNormalize,\n          initDTS = this._initDTS,\n          rawMPEG = !track.isAAC && this.typeSupported.mpeg;\n\n    var offset,\n        mp4Sample,\n        fillFrame,\n        mdat, moof,\n        firstPTS, lastPTS,\n        inputSamples = track.samples,\n        outputSamples = [],\n        nextAudioPts = this.nextAudioPts;\n\n    // for audio samples, also consider consecutive fragments as being contiguous (even if a level switch occurs),\n    // for sake of clarity:\n    // consecutive fragments are frags with\n    //  - less than 100ms gaps between new time offset (if accurate) and next expected PTS OR\n    //  - less than 20 audio frames distance\n    // contiguous fragments are consecutive fragments from same quality level (same level, new SN = old SN + 1)\n    // this helps ensuring audio continuity\n    // and this also avoids audio glitches/cut when switching quality, or reporting wrong duration on first audio frame\n    contiguous |= (inputSamples.length && nextAudioPts &&\n                   ((accurateTimeOffset && Math.abs(timeOffset-nextAudioPts/inputTimeScale) < 0.1) ||\n                    Math.abs((inputSamples[0].pts-nextAudioPts-initDTS)) < 20*inputSampleDuration)\n                    );\n\n    if (!contiguous) {\n      // if fragments are not contiguous, let's use timeOffset to compute next Audio PTS\n      nextAudioPts = timeOffset*inputTimeScale;\n    }\n\n    // compute normalized PTS\n    inputSamples.forEach(function(sample) {\n      sample.pts = sample.dts = ptsNormalize(sample.pts - initDTS, nextAudioPts);\n    });\n\n    // sort based on normalized PTS (this is to avoid sorting issues in case timestamp\n    // reloop in the middle of our samples array)\n    inputSamples.sort(function(a, b) {\n      return a.pts - b.pts;\n    });\n\n    // If the audio track is missing samples, the frames seem to get \"left-shifted\" within the\n    // resulting mp4 segment, causing sync issues and leaving gaps at the end of the audio segment.\n    // In an effort to prevent this from happening, we inject frames here where there are gaps.\n    // When possible, we inject a silent frame; when that's not possible, we duplicate the last\n    // frame.\n\n    // only inject/drop audio frames in case time offset is accurate\n    if (accurateTimeOffset && track.isAAC) {\n      for (let i = 0, nextPts = nextAudioPts; i < inputSamples.length; ) {\n        // First, let's see how far off this frame is from where we expect it to be\n        var sample = inputSamples[i], delta;\n        let pts = sample.pts;\n        delta = pts - nextPts;\n\n        const duration = Math.abs(1000*delta/inputTimeScale);\n\n        // If we're overlapping by more than a duration, drop this sample\n        if (delta <= -inputSampleDuration) {\n          logger.warn(`Dropping 1 audio frame @ ${(nextPts/inputTimeScale).toFixed(3)}s due to ${duration} ms overlap.`);\n          inputSamples.splice(i, 1);\n          track.len -= sample.unit.length;\n          // Don't touch nextPtsNorm or i\n        }\n\n        // Insert missing frames if:\n        // 1: We're more than one frame away\n        // 2: Not more than MAX_SILENT_FRAME_DURATION away\n        // 3: currentTime (aka nextPtsNorm) is not 0\n        else if (delta >= inputSampleDuration && duration < MAX_SILENT_FRAME_DURATION && nextPts) {\n          var missing = Math.round(delta / inputSampleDuration);\n          logger.warn(`Injecting ${missing} audio frame @ ${(nextPts/inputTimeScale).toFixed(3)}s due to ${Math.round(1000*delta/inputTimeScale)} ms gap.`);\n          for (var j = 0; j < missing; j++) {\n            let newStamp = Math.max(nextPts,0);\n            fillFrame = AAC.getSilentFrame(track.manifestCodec || track.codec,track.channelCount);\n            if (!fillFrame) {\n              logger.log('Unable to get silent frame for given audio codec; duplicating last frame instead.');\n              fillFrame = sample.unit.subarray();\n            }\n            inputSamples.splice(i, 0, {unit: fillFrame, pts: newStamp, dts: newStamp});\n            track.len += fillFrame.length;\n            nextPts += inputSampleDuration;\n            i++;\n          }\n\n          // Adjust sample to next expected pts\n          sample.pts = sample.dts = nextPts;\n          nextPts += inputSampleDuration;\n          i++;\n        } else {\n        // Otherwise, just adjust pts\n          if (Math.abs(delta) > (0.1 * inputSampleDuration)) {\n            //logger.log(`Invalid frame delta ${Math.round(delta + inputSampleDuration)} at PTS ${Math.round(pts / 90)} (should be ${Math.round(inputSampleDuration)}).`);\n          }\n          sample.pts = sample.dts = nextPts;\n          nextPts += inputSampleDuration;\n          i++;\n        }\n      }\n    }\n\n\n    for (let j =0 , nbSamples = inputSamples.length; j < nbSamples ; j++) {\n      let audioSample = inputSamples[j];\n      let unit = audioSample.unit;\n      let pts = audioSample.pts;\n      //logger.log(`Audio/PTS:${Math.round(pts/90)}`);\n      // if not first sample\n      if (lastPTS !== undefined) {\n        mp4Sample.duration = Math.round((pts - lastPTS) / scaleFactor);\n      } else {\n        let delta = Math.round(1000 * (pts - nextAudioPts) / inputTimeScale),\n            numMissingFrames = 0;\n        // if fragment are contiguous, detect hole/overlapping between fragments\n        // contiguous fragments are consecutive fragments from same quality level (same level, new SN = old SN + 1)\n        if (contiguous && track.isAAC) {\n          // log delta\n          if (delta) {\n            if (delta > 0 && delta < MAX_SILENT_FRAME_DURATION) {\n              numMissingFrames = Math.round((pts - nextAudioPts) / inputSampleDuration);\n              logger.log(`${delta} ms hole between AAC samples detected,filling it`);\n              if (numMissingFrames > 0) {\n                fillFrame = AAC.getSilentFrame(track.manifestCodec || track.codec,track.channelCount);\n                if (!fillFrame) {\n                  fillFrame = unit.subarray();\n                }\n                track.len += numMissingFrames * fillFrame.length;\n              }\n              // if we have frame overlap, overlapping for more than half a frame duraion\n            } else if (delta < -12) {\n              // drop overlapping audio frames... browser will deal with it\n              logger.log(`drop overlapping AAC sample, expected/parsed/delta:${(nextAudioPts/inputTimeScale).toFixed(3)}s/${(pts/inputTimeScale).toFixed(3)}s/${(-delta)}ms`);\n              track.len -= unit.byteLength;\n              continue;\n            }\n            // set PTS/DTS to expected PTS/DTS\n            pts = nextAudioPts;\n          }\n        }\n        // remember first PTS of our audioSamples, ensure value is positive\n        firstPTS = Math.max(0, pts);\n        if(track.len > 0) {\n          /* concatenate the audio data and construct the mdat in place\n            (need 8 more bytes to fill length and mdat type) */\n          let mdatSize = rawMPEG ? track.len : track.len + 8;\n          offset = rawMPEG ? 0 : 8;\n          try {\n            mdat = new Uint8Array(mdatSize);\n          } catch(err) {\n            this.observer.trigger(Event.ERROR, {type : ErrorTypes.MUX_ERROR, details: ErrorDetails.REMUX_ALLOC_ERROR, fatal: false, bytes : mdatSize, reason: `fail allocating audio mdat ${mdatSize}`});\n            return;\n          }\n          if (!rawMPEG) {\n            const view = new DataView(mdat.buffer);\n            view.setUint32(0, mdatSize);\n            mdat.set(MP4.types.mdat, 4);\n          }\n        } else {\n          // no audio samples\n          return;\n        }\n        for (let i = 0; i < numMissingFrames; i++) {\n          fillFrame = AAC.getSilentFrame(track.manifestCodec || track.codec,track.channelCount);\n          if (!fillFrame) {\n            logger.log('Unable to get silent frame for given audio codec; duplicating this frame instead.');\n            fillFrame = unit.subarray();\n          }\n          mdat.set(fillFrame, offset);\n          offset += fillFrame.byteLength;\n          mp4Sample = {\n            size: fillFrame.byteLength,\n            cts: 0,\n            duration: 1024,\n            flags: {\n              isLeading: 0,\n              isDependedOn: 0,\n              hasRedundancy: 0,\n              degradPrio: 0,\n              dependsOn: 1,\n            }\n          };\n          outputSamples.push(mp4Sample);\n        }\n      }\n      mdat.set(unit, offset);\n      let unitLen = unit.byteLength;\n      offset += unitLen;\n      //console.log('PTS/DTS/initDTS/normPTS/normDTS/relative PTS : ${audioSample.pts}/${audioSample.dts}/${initDTS}/${ptsnorm}/${dtsnorm}/${(audioSample.pts/4294967296).toFixed(3)}');\n      mp4Sample = {\n        size: unitLen,\n        cts: 0,\n        duration: 0,\n        flags: {\n          isLeading: 0,\n          isDependedOn: 0,\n          hasRedundancy: 0,\n          degradPrio: 0,\n          dependsOn: 1,\n        }\n      };\n      outputSamples.push(mp4Sample);\n      lastPTS = pts;\n    }\n    var lastSampleDuration = 0;\n    var nbSamples = outputSamples.length;\n    //set last sample duration as being identical to previous sample\n    if (nbSamples >= 2) {\n      lastSampleDuration = outputSamples[nbSamples - 2].duration;\n      mp4Sample.duration = lastSampleDuration;\n    }\n    if (nbSamples) {\n      // next audio sample PTS should be equal to last sample PTS + duration\n      this.nextAudioPts = nextAudioPts = lastPTS + scaleFactor * lastSampleDuration;\n      //logger.log('Audio/PTS/PTSend:' + audioSample.pts.toFixed(0) + '/' + this.nextAacDts.toFixed(0));\n      track.len = 0;\n      track.samples = outputSamples;\n      if (rawMPEG) {\n        moof = new Uint8Array();\n      } else {\n        moof = MP4.moof(track.sequenceNumber++, firstPTS / scaleFactor, track);\n      }\n      track.samples = [];\n      const start = firstPTS / inputTimeScale;\n      const end = nextAudioPts / inputTimeScale;\n      const audioData = {\n        data1: moof,\n        data2: mdat,\n        startPTS: start,\n        endPTS: end,\n        startDTS: start,\n        endDTS: end,\n        type: 'audio',\n        nb: nbSamples\n      };\n      this.observer.trigger(Event.FRAG_PARSING_DATA, audioData);\n      return audioData;\n    }\n    return null;\n  }\n\n  remuxEmptyAudio(track, timeOffset, contiguous, videoData) {\n    let inputTimeScale = track.inputTimeScale,\n        mp4timeScale = track.samplerate ? track.samplerate : inputTimeScale,\n        scaleFactor = inputTimeScale/mp4timeScale,\n        nextAudioPts = this.nextAudioPts,\n\n        // sync with video's timestamp\n        startDTS = (nextAudioPts !== undefined ? nextAudioPts : videoData.startDTS * inputTimeScale) + this._initDTS,\n        endDTS = videoData.endDTS * inputTimeScale + this._initDTS,\n        // one sample's duration value\n        sampleDuration = 1024,\n        frameDuration = scaleFactor * sampleDuration,\n\n        // samples count of this segment's duration\n        nbSamples = Math.ceil((endDTS - startDTS) / frameDuration),\n\n        // silent frame\n        silentFrame = AAC.getSilentFrame(track.manifestCodec || track.codec,track.channelCount);\n\n        logger.warn('remux empty Audio');\n    // Can't remux if we can't generate a silent frame...\n    if (!silentFrame) {\n      logger.trace('Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!');\n      return;\n    }\n\n    let samples = [];\n    for(var i = 0; i < nbSamples; i++) {\n      var stamp = startDTS + i * frameDuration;\n      samples.push({unit: silentFrame, pts: stamp, dts: stamp});\n      track.len += silentFrame.length;\n    }\n    track.samples = samples;\n\n    this.remuxAudio(track, timeOffset, contiguous);\n  }\n\n  remuxID3(track,timeOffset) {\n    var length = track.samples.length, sample;\n    const inputTimeScale = track.inputTimeScale;\n    const initPTS = this._initPTS;\n    const initDTS = this._initDTS;\n    // consume samples\n    if(length) {\n      for(var index = 0; index < length; index++) {\n        sample = track.samples[index];\n        // setting id3 pts, dts to relative time\n        // using this._initPTS and this._initDTS to calculate relative time\n        sample.pts = ((sample.pts - initPTS) / inputTimeScale);\n        sample.dts = ((sample.dts - initDTS) / inputTimeScale);\n      }\n      this.observer.trigger(Event.FRAG_PARSING_METADATA, {\n        samples:track.samples\n      });\n    }\n\n    track.samples = [];\n    timeOffset = timeOffset;\n  }\n\n  remuxText(track,timeOffset) {\n    track.samples.sort(function(a, b) {\n      return (a.pts-b.pts);\n    });\n\n    var length = track.samples.length, sample;\n    const inputTimeScale = track.inputTimeScale;\n    const initPTS = this._initPTS;\n    // consume samples\n    if(length) {\n      for(var index = 0; index < length; index++) {\n        sample = track.samples[index];\n        // setting text pts, dts to relative time\n        // using this._initPTS and this._initDTS to calculate relative time\n        sample.pts = ((sample.pts - initPTS) / inputTimeScale);\n      }\n      this.observer.trigger(Event.FRAG_PARSING_USERDATA, {\n        samples:track.samples\n      });\n    }\n\n    track.samples = [];\n    timeOffset = timeOffset;\n  }\n\n  _PTSNormalize(value, reference) {\n    var offset;\n    if (reference === undefined) {\n      return value;\n    }\n    if (reference < value) {\n      // - 2^33\n      offset = -8589934592;\n    } else {\n      // + 2^33\n      offset = 8589934592;\n    }\n    /* PTS is 33bit (from 0 to 2^33 -1)\n      if diff between value and reference is bigger than half of the amplitude (2^32) then it means that\n      PTS looping occured. fill the gap */\n    while (Math.abs(value - reference) > 4294967296) {\n        value += offset;\n    }\n    return value;\n  }\n\n}\n\nexport default MP4Remuxer;\n\n\n\n// WEBPACK FOOTER //\n// src/remux/mp4-remuxer.js","/**\n * passthrough remuxer\n*/\nimport Event from '../events';\n\nclass PassThroughRemuxer {\n  constructor(observer) {\n    this.observer = observer;\n  }\n\n  destroy() {\n  }\n\n  resetTimeStamp() {\n  }\n\n  resetInitSegment() {\n  }\n\n  remux(audioTrack,videoTrack,id3Track,textTrack,timeOffset, contiguous,accurateTimeOffset,rawData) {\n    var observer = this.observer;\n    var streamType = '';\n    if (audioTrack) {\n      streamType += 'audio';\n    }\n    if (videoTrack) {\n      streamType += 'video';\n    }\n    observer.trigger(Event.FRAG_PARSING_DATA, {\n      data1: rawData,\n      startPTS: timeOffset,\n      startDTS: timeOffset,\n      type: streamType,\n      nb: 1,\n      dropped : 0\n    });\n    //notify end of parsing\n    observer.trigger(Event.FRAG_PARSED);\n  }\n}\n\nexport default PassThroughRemuxer;\n\n\n\n// WEBPACK FOOTER //\n// src/remux/passthrough-remuxer.js","const DECIMAL_RESOLUTION_REGEX = /^(\\d+)x(\\d+)$/;\nconst ATTR_LIST_REGEX = /\\s*(.+?)\\s*=((?:\\\".*?\\\")|.*?)(?:,|$)/g;\n\n// adapted from https://github.com/kanongil/node-m3u8parse/blob/master/attrlist.js\nclass AttrList {\n\n  constructor(attrs) {\n    if (typeof attrs === 'string') {\n      attrs = AttrList.parseAttrList(attrs);\n    }\n    for(var attr in attrs){\n      if(attrs.hasOwnProperty(attr)) {\n        this[attr] = attrs[attr];\n      }\n    }\n  }\n\n  decimalInteger(attrName) {\n    const intValue = parseInt(this[attrName], 10);\n    if (intValue > Number.MAX_SAFE_INTEGER) {\n      return Infinity;\n    }\n    return intValue;\n  }\n\n  hexadecimalInteger(attrName) {\n    if(this[attrName]) {\n      let stringValue = (this[attrName] || '0x').slice(2);\n      stringValue = ((stringValue.length & 1) ? '0' : '') + stringValue;\n\n      const value = new Uint8Array(stringValue.length / 2);\n      for (let i = 0; i < stringValue.length / 2; i++) {\n        value[i] = parseInt(stringValue.slice(i * 2, i * 2 + 2), 16);\n      }\n      return value;\n    } else {\n      return null;\n    }\n  }\n\n  hexadecimalIntegerAsNumber(attrName) {\n    const intValue = parseInt(this[attrName], 16);\n    if (intValue > Number.MAX_SAFE_INTEGER) {\n      return Infinity;\n    }\n    return intValue;\n  }\n\n  decimalFloatingPoint(attrName) {\n    return parseFloat(this[attrName]);\n  }\n\n  enumeratedString(attrName) {\n    return this[attrName];\n  }\n\n  decimalResolution(attrName) {\n    const res = DECIMAL_RESOLUTION_REGEX.exec(this[attrName]);\n    if (res === null) {\n      return undefined;\n    }\n    return {\n      width: parseInt(res[1], 10),\n      height: parseInt(res[2], 10)\n    };\n  }\n\n  static parseAttrList(input) {\n    var match, attrs = {};\n    ATTR_LIST_REGEX.lastIndex = 0;\n    while ((match = ATTR_LIST_REGEX.exec(input)) !== null) {\n      var value = match[2], quote = '\"';\n\n      if (value.indexOf(quote) === 0 &&\n          value.lastIndexOf(quote) === (value.length-1)) {\n        value = value.slice(1, -1);\n      }\n      attrs[match[1]] = value;\n    }\n    return attrs;\n  }\n\n}\n\nexport default AttrList;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/attr-list.js","var BinarySearch = {\n    /**\n     * Searches for an item in an array which matches a certain condition.\n     * This requires the condition to only match one item in the array,\n     * and for the array to be ordered.\n     *\n     * @param {Array} list The array to search.\n     * @param {Function} comparisonFunction\n     *      Called and provided a candidate item as the first argument.\n     *      Should return:\n     *          > -1 if the item should be located at a lower index than the provided item.\n     *          > 1 if the item should be located at a higher index than the provided item.\n     *          > 0 if the item is the item you're looking for.\n     *\n     * @return {*} The object if it is found or null otherwise.\n     */\n    search: function(list, comparisonFunction) {\n        var minIndex = 0;\n        var maxIndex = list.length - 1;\n        var currentIndex = null;\n        var currentElement = null;\n     \n        while (minIndex <= maxIndex) {\n            currentIndex = (minIndex + maxIndex) / 2 | 0;\n            currentElement = list[currentIndex];\n            \n            var comparisonResult = comparisonFunction(currentElement);\n            if (comparisonResult > 0) {\n                minIndex = currentIndex + 1;\n            }\n            else if (comparisonResult < 0) {\n                maxIndex = currentIndex - 1;\n            }\n            else {\n                return currentElement;\n            }\n        }\n     \n        return null;\n    }\n};\n\nmodule.exports = BinarySearch;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/binary-search.js","/**\n *\n * This code was ported from the dash.js project at:\n *   https://github.com/Dash-Industry-Forum/dash.js/blob/development/externals/cea608-parser.js\n *   https://github.com/Dash-Industry-Forum/dash.js/commit/8269b26a761e0853bb21d78780ed945144ecdd4d#diff-71bc295a2d6b6b7093a1d3290d53a4b2\n *\n * The original copyright appears below:\n *\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2015-2016, DASH Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  1. Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  2. Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n    /**\n     *  Exceptions from regular ASCII. CodePoints are mapped to UTF-16 codes\n     */\n\nvar specialCea608CharsCodes = {\n    0x2a : 0xe1, // lowercase a, acute accent\n    0x5c : 0xe9, // lowercase e, acute accent\n    0x5e : 0xed, // lowercase i, acute accent\n    0x5f : 0xf3, // lowercase o, acute accent\n    0x60 : 0xfa, // lowercase u, acute accent\n    0x7b : 0xe7, // lowercase c with cedilla\n    0x7c : 0xf7, // division symbol\n    0x7d : 0xd1, // uppercase N tilde\n    0x7e : 0xf1, // lowercase n tilde\n    0x7f : 0x2588, // Full block\n    // THIS BLOCK INCLUDES THE 16 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n    // THAT COME FROM HI BYTE=0x11 AND LOW BETWEEN 0x30 AND 0x3F\n    // THIS MEANS THAT \\x50 MUST BE ADDED TO THE VALUES\n    0x80 : 0xae, // Registered symbol (R)\n    0x81 : 0xb0, // degree sign\n    0x82 : 0xbd, // 1/2 symbol\n    0x83 : 0xbf, // Inverted (open) question mark\n    0x84 : 0x2122, // Trademark symbol (TM)\n    0x85 : 0xa2, // Cents symbol\n    0x86 : 0xa3, // Pounds sterling\n    0x87 : 0x266a, // Music 8'th note\n    0x88 : 0xe0, // lowercase a, grave accent\n    0x89 : 0x20, // transparent space (regular)\n    0x8a : 0xe8, // lowercase e, grave accent\n    0x8b : 0xe2, // lowercase a, circumflex accent\n    0x8c : 0xea, // lowercase e, circumflex accent\n    0x8d : 0xee, // lowercase i, circumflex accent\n    0x8e : 0xf4, // lowercase o, circumflex accent\n    0x8f : 0xfb, // lowercase u, circumflex accent\n    // THIS BLOCK INCLUDES THE 32 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n    // THAT COME FROM HI BYTE=0x12 AND LOW BETWEEN 0x20 AND 0x3F\n    0x90 : 0xc1, // capital letter A with acute\n    0x91 : 0xc9, // capital letter E with acute\n    0x92 : 0xd3, // capital letter O with acute\n    0x93 : 0xda, // capital letter U with acute\n    0x94 : 0xdc, // capital letter U with diaresis\n    0x95 : 0xfc, // lowercase letter U with diaeresis\n    0x96 : 0x2018, // opening single quote\n    0x97 : 0xa1, // inverted exclamation mark\n    0x98 : 0x2a, // asterisk\n    0x99 : 0x2019, // closing single quote\n    0x9a : 0x2501, // box drawings heavy horizontal\n    0x9b : 0xa9, // copyright sign\n    0x9c : 0x2120, // Service mark\n    0x9d : 0x2022, // (round) bullet\n    0x9e : 0x201c, // Left double quotation mark\n    0x9f : 0x201d, // Right double quotation mark\n    0xa0 : 0xc0, // uppercase A, grave accent\n    0xa1 : 0xc2, // uppercase A, circumflex\n    0xa2 : 0xc7, // uppercase C with cedilla\n    0xa3 : 0xc8, // uppercase E, grave accent\n    0xa4 : 0xca, // uppercase E, circumflex\n    0xa5 : 0xcb, // capital letter E with diaresis\n    0xa6 : 0xeb, // lowercase letter e with diaresis\n    0xa7 : 0xce, // uppercase I, circumflex\n    0xa8 : 0xcf, // uppercase I, with diaresis\n    0xa9 : 0xef, // lowercase i, with diaresis\n    0xaa : 0xd4, // uppercase O, circumflex\n    0xab : 0xd9, // uppercase U, grave accent\n    0xac : 0xf9, // lowercase u, grave accent\n    0xad : 0xdb, // uppercase U, circumflex\n    0xae : 0xab, // left-pointing double angle quotation mark\n    0xaf : 0xbb, // right-pointing double angle quotation mark\n    // THIS BLOCK INCLUDES THE 32 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n    // THAT COME FROM HI BYTE=0x13 AND LOW BETWEEN 0x20 AND 0x3F\n    0xb0 : 0xc3, // Uppercase A, tilde\n    0xb1 : 0xe3, // Lowercase a, tilde\n    0xb2 : 0xcd, // Uppercase I, acute accent\n    0xb3 : 0xcc, // Uppercase I, grave accent\n    0xb4 : 0xec, // Lowercase i, grave accent\n    0xb5 : 0xd2, // Uppercase O, grave accent\n    0xb6 : 0xf2, // Lowercase o, grave accent\n    0xb7 : 0xd5, // Uppercase O, tilde\n    0xb8 : 0xf5, // Lowercase o, tilde\n    0xb9 : 0x7b, // Open curly brace\n    0xba : 0x7d, // Closing curly brace\n    0xbb : 0x5c, // Backslash\n    0xbc : 0x5e, // Caret\n    0xbd : 0x5f, // Underscore\n    0xbe : 0x7c, // Pipe (vertical line)\n    0xbf : 0x223c, // Tilde operator\n    0xc0 : 0xc4, // Uppercase A, umlaut\n    0xc1 : 0xe4, // Lowercase A, umlaut\n    0xc2 : 0xd6, // Uppercase O, umlaut\n    0xc3 : 0xf6, // Lowercase o, umlaut\n    0xc4 : 0xdf, // Esszett (sharp S)\n    0xc5 : 0xa5, // Yen symbol\n    0xc6 : 0xa4, // Generic currency sign\n    0xc7 : 0x2503, // Box drawings heavy vertical\n    0xc8 : 0xc5, // Uppercase A, ring\n    0xc9 : 0xe5, // Lowercase A, ring\n    0xca : 0xd8, // Uppercase O, stroke\n    0xcb : 0xf8, // Lowercase o, strok\n    0xcc : 0x250f, // Box drawings heavy down and right\n    0xcd : 0x2513, // Box drawings heavy down and left\n    0xce : 0x2517, // Box drawings heavy up and right\n    0xcf : 0x251b // Box drawings heavy up and left\n};\n\n/**\n * Utils\n */\nvar getCharForByte = function(byte) {\n    var charCode = byte;\n    if (specialCea608CharsCodes.hasOwnProperty(byte)) {\n        charCode = specialCea608CharsCodes[byte];\n    }\n    return String.fromCharCode(charCode);\n};\n\nvar NR_ROWS = 15,\n    NR_COLS = 100;\n// Tables to look up row from PAC data\nvar rowsLowCh1 = {0x11 : 1, 0x12 : 3, 0x15 : 5, 0x16 : 7, 0x17 : 9, 0x10 : 11, 0x13 : 12, 0x14 : 14};\nvar rowsHighCh1 = {0x11 : 2, 0x12 : 4, 0x15 : 6, 0x16 : 8, 0x17 : 10, 0x13 : 13, 0x14 : 15};\nvar rowsLowCh2 = {0x19 : 1, 0x1A : 3, 0x1D : 5, 0x1E : 7, 0x1F : 9, 0x18 : 11, 0x1B : 12, 0x1C : 14};\nvar rowsHighCh2 = {0x19 : 2, 0x1A : 4, 0x1D : 6, 0x1E : 8, 0x1F : 10, 0x1B : 13, 0x1C : 15};\n\nvar backgroundColors = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta', 'black', 'transparent'];\n\n/**\n * Simple logger class to be able to write with time-stamps and filter on level.\n */\nvar logger = {\n    verboseFilter : {'DATA' : 3, 'DEBUG' : 3, 'INFO' : 2, 'WARNING' : 2, 'TEXT' : 1, 'ERROR' : 0},\n    time : null,\n    verboseLevel : 0, // Only write errors\n    setTime : function(newTime) {\n        this.time = newTime;\n    },\n    log : function(severity, msg) {\n        var minLevel = this.verboseFilter[severity];\n        if (this.verboseLevel >= minLevel) {\n            console.log(this.time + ' [' + severity + '] ' + msg);\n        }\n    }\n};\n\nvar numArrayToHexArray = function(numArray) {\n    var hexArray = [];\n    for (var j = 0; j < numArray.length; j++) {\n        hexArray.push(numArray[j].toString(16));\n    }\n    return hexArray;\n};\n\nclass PenState {\n\n    constructor(foreground, underline, italics, background, flash) {\n        this.foreground = foreground || 'white';\n        this.underline = underline || false;\n        this.italics = italics || false;\n        this.background = background || 'black';\n        this.flash = flash || false;\n    }\n\n    reset() {\n        this.foreground = 'white';\n        this.underline = false;\n        this.italics = false;\n        this.background = 'black';\n        this.flash = false;\n    }\n\n    setStyles(styles) {\n        var attribs = ['foreground', 'underline', 'italics', 'background', 'flash'];\n        for (var i = 0 ; i < attribs.length; i++) {\n            var style = attribs[i];\n            if (styles.hasOwnProperty(style)) {\n                this[style] = styles[style];\n            }\n        }\n    }\n\n    isDefault() {\n        return (this.foreground === 'white' && !this.underline && !this.italics &&\n                this.background === 'black' && !this.flash);\n    }\n\n    equals(other) {\n        return ( (this.foreground === other.foreground) &&\n                 (this.underline === other.underline) &&\n                 (this.italics === other.italics) &&\n                 (this.background === other.background) &&\n                 (this.flash === other.flash) );\n    }\n\n    copy(newPenState) {\n        this.foreground = newPenState.foreground;\n        this.underline = newPenState.underline;\n        this.italics = newPenState.italics;\n        this.background = newPenState.background;\n        this.flash = newPenState.flash;\n    }\n\n    toString() {\n        return ('color=' + this.foreground + ', underline=' + this.underline + ', italics=' + this.italics +\n            ', background=' + this.background + ', flash=' + this.flash);\n    }\n}\n\n/**\n * Unicode character with styling and background.\n * @constructor\n */\nclass StyledUnicodeChar\n{\n\n    constructor(uchar, foreground, underline, italics, background, flash) {\n        this.uchar = uchar || ' '; // unicode character\n        this.penState = new PenState(foreground, underline,italics, background, flash);\n    }\n\n    reset() {\n        this.uchar = ' ';\n        this.penState.reset();\n    }\n\n    setChar(uchar, newPenState) {\n        this.uchar = uchar;\n        this.penState.copy(newPenState);\n    }\n\n    setPenState(newPenState) {\n        this.penState.copy(newPenState);\n    }\n\n    equals(other) {\n        return this.uchar === other.uchar && this.penState.equals(other.penState);\n    }\n\n    copy(newChar) {\n        this.uchar = newChar.uchar;\n        this.penState.copy(newChar.penState);\n    }\n\n    isEmpty() {\n        return this.uchar === ' ' && this.penState.isDefault();\n    }\n}\n\n/**\n * CEA-608 row consisting of NR_COLS instances of StyledUnicodeChar.\n * @constructor\n */\nclass Row {\n    constructor() {\n        this.chars = [];\n        for (var i = 0 ; i < NR_COLS ; i++) {\n            this.chars.push(new StyledUnicodeChar());\n        }\n        this.pos = 0;\n        this.currPenState = new PenState();\n    }\n\n    equals(other) {\n        var equal = true;\n        for (var i = 0 ; i < NR_COLS; i ++) {\n            if (!this.chars[i].equals(other.chars[i])) {\n                equal = false;\n                break;\n            }\n        }\n        return equal;\n    }\n\n    copy(other) {\n        for (var i = 0 ; i < NR_COLS; i ++) {\n            this.chars[i].copy(other.chars[i]);\n        }\n    }\n\n    isEmpty() {\n        var empty = true;\n        for (var i = 0 ; i < NR_COLS; i ++) {\n            if (!this.chars[i].isEmpty()) {\n                empty = false;\n                break;\n            }\n        }\n        return empty;\n    }\n\n    /**\n     *  Set the cursor to a valid column.\n     */\n    setCursor(absPos) {\n        if (this.pos !== absPos) {\n            this.pos = absPos;\n        }\n        if (this.pos < 0) {\n            logger.log('ERROR', 'Negative cursor position ' + this.pos);\n            this.pos = 0;\n        } else if (this.pos > NR_COLS) {\n            logger.log('ERROR', 'Too large cursor position ' + this.pos);\n            this.pos = NR_COLS;\n        }\n    }\n\n    /**\n     * Move the cursor relative to current position.\n     */\n    moveCursor(relPos) {\n        var newPos = this.pos + relPos;\n        if (relPos > 1) {\n            for (var i = this.pos+1; i < newPos+1 ; i++) {\n                this.chars[i].setPenState(this.currPenState);\n            }\n        }\n        this.setCursor(newPos);\n    }\n\n    /**\n     * Backspace, move one step back and clear character.\n     */\n    backSpace() {\n        this.moveCursor(-1);\n        this.chars[this.pos].setChar(' ', this.currPenState);\n    }\n\n    insertChar(byte) {\n        if (byte >= 0x90) { //Extended char\n            this.backSpace();\n        }\n        var char = getCharForByte(byte);\n        if (this.pos >= NR_COLS) {\n            logger.log('ERROR', 'Cannot insert ' + byte.toString(16) +\n                        ' (' + char + ') at position ' + this.pos + '. Skipping it!');\n            return;\n        }\n        this.chars[this.pos].setChar(char, this.currPenState);\n        this.moveCursor(1);\n    }\n\n    clearFromPos(startPos) {\n        var i;\n        for (i = startPos ; i < NR_COLS ; i++) {\n            this.chars[i].reset();\n        }\n    }\n\n    clear() {\n        this.clearFromPos(0);\n        this.pos = 0;\n        this.currPenState.reset();\n    }\n\n    clearToEndOfRow() {\n        this.clearFromPos(this.pos);\n    }\n\n    getTextString() {\n        var chars = [];\n        var empty = true;\n        for (var i = 0 ; i < NR_COLS ; i++) {\n            var char = this.chars[i].uchar;\n            if (char !== ' ') {\n                empty = false;\n            }\n            chars.push(char);\n        }\n        if (empty) {\n            return '';\n        } else {\n            return chars.join('');\n        }\n    }\n\n    setPenStyles(styles) {\n        this.currPenState.setStyles(styles);\n        var currChar = this.chars[this.pos];\n        currChar.setPenState(this.currPenState);\n    }\n}\n\n/**\n * Keep a CEA-608 screen of 32x15 styled characters\n * @constructor\n*/\nclass CaptionScreen {\n\n    constructor() {\n        this.rows = [];\n        for (var i = 0 ; i <  NR_ROWS; i++) {\n            this.rows.push(new Row()); // Note that we use zero-based numbering (0-14)\n        }\n        this.currRow = NR_ROWS - 1;\n        this.nrRollUpRows = null;\n        this.reset();\n    }\n\n    reset() {\n        for (var i = 0 ; i < NR_ROWS ; i++) {\n            this.rows[i].clear();\n        }\n        this.currRow = NR_ROWS - 1;\n    }\n\n    equals(other) {\n        var equal = true;\n        for (var i = 0 ; i < NR_ROWS ; i++) {\n            if (!this.rows[i].equals(other.rows[i])) {\n                equal = false;\n                break;\n            }\n        }\n        return equal;\n    }\n\n    copy(other) {\n        for (var i = 0 ; i < NR_ROWS ; i++) {\n            this.rows[i].copy(other.rows[i]);\n        }\n    }\n\n    isEmpty() {\n        var empty = true;\n        for (var i = 0 ; i < NR_ROWS ; i++) {\n            if (!this.rows[i].isEmpty()) {\n                empty = false;\n                break;\n            }\n        }\n        return empty;\n    }\n\n    backSpace() {\n        var row = this.rows[this.currRow];\n        row.backSpace();\n    }\n\n    clearToEndOfRow() {\n        var row = this.rows[this.currRow];\n        row.clearToEndOfRow();\n    }\n\n    /**\n     * Insert a character (without styling) in the current row.\n     */\n    insertChar(char) {\n        var row = this.rows[this.currRow];\n        row.insertChar(char);\n    }\n\n    setPen(styles) {\n        var row = this.rows[this.currRow];\n        row.setPenStyles(styles);\n    }\n\n    moveCursor(relPos) {\n        var row = this.rows[this.currRow];\n        row.moveCursor(relPos);\n    }\n\n    setCursor(absPos) {\n        logger.log('INFO', 'setCursor: ' + absPos);\n        var row = this.rows[this.currRow];\n        row.setCursor(absPos);\n    }\n\n    setPAC(pacData) {\n        logger.log('INFO', 'pacData = ' + JSON.stringify(pacData));\n        var newRow = pacData.row - 1;\n        if (this.nrRollUpRows  && newRow < this.nrRollUpRows - 1) {\n                newRow = this.nrRollUpRows-1;\n        }\n\n        //Make sure this only affects Roll-up Captions by checking this.nrRollUpRows\n        if (this.nrRollUpRows && this.currRow !== newRow) {\n          //clear all rows first\n          for (let i = 0; i < NR_ROWS; i++) {\n            this.rows[i].clear();\n          }\n\n          //Copy this.nrRollUpRows rows from lastOutputScreen and place it in the newRow location\n          //topRowIndex - the start of rows to copy (inclusive index)\n          var topRowIndex = this.currRow + 1 - (this.nrRollUpRows);\n          //We only copy if the last position was already shown.\n          //We use the cueStartTime value to check this.\n          const lastOutputScreen = this.lastOutputScreen;\n          if (lastOutputScreen) {\n            var prevLineTime = lastOutputScreen.rows[topRowIndex].cueStartTime;\n            if(prevLineTime && prevLineTime < logger.time) {\n              for (let i = 0; i < this.nrRollUpRows; i++) {\n                this.rows[newRow-this.nrRollUpRows+i+1].copy(lastOutputScreen.rows[topRowIndex+i]);\n              }\n            }\n          }\n        }\n\n        this.currRow = newRow;\n        var row = this.rows[this.currRow];\n        if (pacData.indent !== null) {\n            var indent = pacData.indent;\n            var prevPos = Math.max(indent-1, 0);\n            row.setCursor(pacData.indent);\n            pacData.color = row.chars[prevPos].penState.foreground;\n        }\n        var styles = {foreground : pacData.color, underline : pacData.underline, italics : pacData.italics, background : 'black', flash : false};\n        this.setPen(styles);\n    }\n\n    /**\n     * Set background/extra foreground, but first do back_space, and then insert space (backwards compatibility).\n     */\n    setBkgData(bkgData) {\n\n        logger.log('INFO', 'bkgData = ' + JSON.stringify(bkgData));\n        this.backSpace();\n        this.setPen(bkgData);\n        this.insertChar(0x20); //Space\n    }\n\n    setRollUpRows(nrRows) {\n        this.nrRollUpRows = nrRows;\n    }\n\n    rollUp() {\n        if (this.nrRollUpRows === null) {\n            logger.log('DEBUG', 'roll_up but nrRollUpRows not set yet');\n            return; //Not properly setup\n        }\n        logger.log('TEXT', this.getDisplayText());\n        var topRowIndex = this.currRow + 1 - this.nrRollUpRows;\n        var topRow = this.rows.splice(topRowIndex, 1)[0];\n        topRow.clear();\n        this.rows.splice(this.currRow, 0, topRow);\n        logger.log('INFO', 'Rolling up');\n        //logger.log('TEXT', this.get_display_text())\n    }\n\n   /**\n    * Get all non-empty rows with as unicode text.\n    */\n    getDisplayText(asOneRow) {\n        asOneRow = asOneRow || false;\n        var displayText = [];\n        var text = '';\n        var rowNr = -1;\n        for (var i = 0 ; i < NR_ROWS ; i++) {\n            var rowText = this.rows[i].getTextString();\n            if (rowText) {\n                rowNr = i+1;\n                if (asOneRow) {\n                    displayText.push('Row ' + rowNr + ': \\'' + rowText + '\\'');\n                } else {\n                    displayText.push(rowText.trim());\n                }\n            }\n        }\n        if (displayText.length > 0) {\n            if (asOneRow) {\n                text = '[' + displayText.join(' | ') + ']';\n            } else {\n                text = displayText.join('\\n');\n            }\n        }\n        return text;\n    }\n\n    getTextAndFormat() {\n        return this.rows;\n    }\n}\n\n//var modes = ['MODE_ROLL-UP', 'MODE_POP-ON', 'MODE_PAINT-ON', 'MODE_TEXT'];\n\nclass Cea608Channel\n{\n    constructor(channelNumber, outputFilter) {\n\n        this.chNr = channelNumber;\n        this.outputFilter = outputFilter;\n        this.mode = null;\n        this.verbose = 0;\n        this.displayedMemory = new CaptionScreen();\n        this.nonDisplayedMemory = new CaptionScreen();\n        this.lastOutputScreen = new CaptionScreen();\n        this.currRollUpRow = this.displayedMemory.rows[NR_ROWS-1];\n        this.writeScreen = this.displayedMemory;\n        this.mode = null;\n        this.cueStartTime = null; // Keeps track of where a cue started.\n    }\n\n    reset() {\n        this.mode = null;\n        this.displayedMemory.reset();\n        this.nonDisplayedMemory.reset();\n        this.lastOutputScreen.reset();\n        this.currRollUpRow = this.displayedMemory.rows[NR_ROWS-1];\n        this.writeScreen = this.displayedMemory;\n        this.mode = null;\n        this.cueStartTime = null;\n        this.lastCueEndTime = null;\n    }\n\n    getHandler() {\n        return this.outputFilter;\n    }\n\n    setHandler(newHandler) {\n        this.outputFilter = newHandler;\n    }\n\n    setPAC(pacData) {\n        this.writeScreen.setPAC(pacData);\n    }\n\n    setBkgData(bkgData) {\n        this.writeScreen.setBkgData(bkgData);\n    }\n\n    setMode(newMode) {\n        if (newMode === this.mode) {\n            return;\n        }\n        this.mode = newMode;\n        logger.log('INFO', 'MODE=' + newMode);\n        if (this.mode === 'MODE_POP-ON') {\n            this.writeScreen = this.nonDisplayedMemory;\n        } else {\n            this.writeScreen = this.displayedMemory;\n            this.writeScreen.reset();\n        }\n        if (this.mode !== 'MODE_ROLL-UP') {\n            this.displayedMemory.nrRollUpRows = null;\n            this.nonDisplayedMemory.nrRollUpRows = null;\n        }\n        this.mode = newMode;\n    }\n\n    insertChars(chars) {\n        for (var i = 0 ; i < chars.length ; i++) {\n            this.writeScreen.insertChar(chars[i]);\n        }\n        var screen = this.writeScreen === this.displayedMemory ? 'DISP' : 'NON_DISP';\n        logger.log('INFO', screen + ': ' + this.writeScreen.getDisplayText(true));\n        if (this.mode === 'MODE_PAINT-ON' || this.mode === 'MODE_ROLL-UP') {\n            logger.log('TEXT', 'DISPLAYED: ' + this.displayedMemory.getDisplayText(true));\n            this.outputDataUpdate();\n        }\n    }\n\n    ccRCL() { // Resume Caption Loading (switch mode to Pop On)\n        logger.log('INFO', 'RCL - Resume Caption Loading');\n        this.setMode('MODE_POP-ON');\n    }\n\n    ccBS() { // BackSpace\n        logger.log('INFO', 'BS - BackSpace');\n        if (this.mode === 'MODE_TEXT') {\n            return;\n        }\n        this.writeScreen.backSpace();\n        if (this.writeScreen === this.displayedMemory) {\n            this.outputDataUpdate();\n        }\n    }\n\n    ccAOF() { // Reserved (formerly Alarm Off)\n        return;\n    }\n\n    ccAON() { // Reserved (formerly Alarm On)\n        return;\n    }\n\n    ccDER() { // Delete to End of Row\n        logger.log('INFO', 'DER- Delete to End of Row');\n        this.writeScreen.clearToEndOfRow();\n        this.outputDataUpdate();\n    }\n\n    ccRU(nrRows) { //Roll-Up Captions-2,3,or 4 Rows\n        logger.log('INFO', 'RU(' + nrRows +') - Roll Up');\n        this.writeScreen = this.displayedMemory;\n        this.setMode('MODE_ROLL-UP');\n        this.writeScreen.setRollUpRows(nrRows);\n    }\n\n    ccFON() { //Flash On\n        logger.log('INFO', 'FON - Flash On');\n        this.writeScreen.setPen({flash : true});\n    }\n\n    ccRDC() { // Resume Direct Captioning (switch mode to PaintOn)\n        logger.log('INFO', 'RDC - Resume Direct Captioning');\n        this.setMode('MODE_PAINT-ON');\n    }\n\n    ccTR() { // Text Restart in text mode (not supported, however)\n        logger.log('INFO', 'TR');\n        this.setMode('MODE_TEXT');\n    }\n\n    ccRTD() { // Resume Text Display in Text mode (not supported, however)\n        logger.log('INFO', 'RTD');\n        this.setMode('MODE_TEXT');\n    }\n\n    ccEDM() { // Erase Displayed Memory\n        logger.log('INFO', 'EDM - Erase Displayed Memory');\n        this.displayedMemory.reset();\n        this.outputDataUpdate();\n    }\n\n    ccCR() { // Carriage Return\n        logger.log('CR - Carriage Return');\n        this.writeScreen.rollUp();\n        this.outputDataUpdate();\n    }\n\n    ccENM() { //Erase Non-Displayed Memory\n        logger.log('INFO', 'ENM - Erase Non-displayed Memory');\n        this.nonDisplayedMemory.reset();\n    }\n\n    ccEOC() { //End of Caption (Flip Memories)\n        logger.log('INFO', 'EOC - End Of Caption');\n        if (this.mode === 'MODE_POP-ON') {\n            var tmp = this.displayedMemory;\n            this.displayedMemory = this.nonDisplayedMemory;\n            this.nonDisplayedMemory = tmp;\n            this.writeScreen = this.nonDisplayedMemory;\n            logger.log('TEXT', 'DISP: ' + this.displayedMemory.getDisplayText());\n        }\n        this.outputDataUpdate();\n    }\n\n    ccTO(nrCols) { // Tab Offset 1,2, or 3 columns\n        logger.log('INFO', 'TO(' + nrCols + ') - Tab Offset');\n        this.writeScreen.moveCursor(nrCols);\n    }\n\n    ccMIDROW(secondByte) { // Parse MIDROW command\n        var styles = {flash : false};\n        styles.underline = secondByte % 2 === 1;\n        styles.italics = secondByte >= 0x2e;\n        if (!styles.italics) {\n            var colorIndex = Math.floor(secondByte/2) - 0x10;\n            var colors = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta'];\n            styles.foreground = colors[colorIndex];\n        } else {\n            styles.foreground = 'white';\n        }\n        logger.log('INFO', 'MIDROW: ' + JSON.stringify(styles));\n        this.writeScreen.setPen(styles);\n    }\n\n    outputDataUpdate() {\n        var t = logger.time;\n        if (t === null) {\n            return;\n        }\n        if (this.outputFilter) {\n            if (this.outputFilter.updateData) {\n                this.outputFilter.updateData(t, this.displayedMemory);\n            }\n            if (this.cueStartTime === null && !this.displayedMemory.isEmpty()) { // Start of a new cue\n                this.cueStartTime = t;\n            } else {\n                if (!this.displayedMemory.equals(this.lastOutputScreen)) {\n                    if (this.outputFilter.newCue) {\n                        this.outputFilter.newCue(this.cueStartTime, t, this.lastOutputScreen);\n                    }\n                    this.cueStartTime = this.displayedMemory.isEmpty() ? null : t;\n                }\n            }\n            this.lastOutputScreen.copy(this.displayedMemory);\n        }\n    }\n\n    cueSplitAtTime(t) {\n        if (this.outputFilter) {\n            if (!this.displayedMemory.isEmpty()) {\n                if (this.outputFilter.newCue) {\n                    this.outputFilter.newCue(this.cueStartTime, t, this.displayedMemory);\n                }\n                this.cueStartTime = t;\n            }\n        }\n    }\n}\n\nclass Cea608Parser {\n\n    constructor(field, out1, out2) {\n        this.field = field || 1;\n        this.outputs = [out1, out2];\n        this.channels = [new Cea608Channel(1, out1), new Cea608Channel(2, out2)];\n        this.currChNr = -1; // Will be 1 or 2\n        this.lastCmdA = null; // First byte of last command\n        this.lastCmdB = null; // Second byte of last command\n        this.bufferedData = [];\n        this.startTime = null;\n        this.lastTime = null;\n        this.dataCounters = {'padding' : 0, 'char' : 0, 'cmd' : 0, 'other' : 0};\n    }\n\n    getHandler(index) {\n        return this.channels[index].getHandler();\n    }\n\n    setHandler(index, newHandler) {\n        this.channels[index].setHandler(newHandler);\n    }\n\n    /**\n     * Add data for time t in forms of list of bytes (unsigned ints). The bytes are treated as pairs.\n     */\n    addData(t, byteList) {\n        var cmdFound, a, b,\n        charsFound = false;\n\n        this.lastTime = t;\n        logger.setTime(t);\n\n        for (var i = 0 ; i < byteList.length ; i+=2) {\n            a = byteList[i] & 0x7f;\n            b = byteList[i+1] & 0x7f;\n            if (a === 0 && b === 0) {\n                this.dataCounters.padding += 2;\n                continue;\n            } else {\n                logger.log('DATA', '[' + numArrayToHexArray([byteList[i], byteList[i+1]]) +'] -> (' + numArrayToHexArray([a, b]) + ')');\n            }\n            cmdFound = this.parseCmd(a, b);\n            if (!cmdFound) {\n                cmdFound = this.parseMidrow(a, b);\n            }\n            if (!cmdFound) {\n                cmdFound = this.parsePAC(a, b);\n            }\n            if (!cmdFound) {\n                cmdFound = this.parseBackgroundAttributes(a, b);\n            }\n            if (!cmdFound) {\n                charsFound = this.parseChars(a, b);\n                if (charsFound) {\n                    if (this.currChNr && this.currChNr >=0) {\n                        var channel = this.channels[this.currChNr-1];\n                        channel.insertChars(charsFound);\n                    } else {\n                        logger.log('WARNING', 'No channel found yet. TEXT-MODE?');\n                    }\n                }\n            }\n            if (cmdFound) {\n                this.dataCounters.cmd += 2;\n            } else if (charsFound) {\n                this.dataCounters.char += 2;\n            } else {\n                this.dataCounters.other += 2;\n                logger.log('WARNING', 'Couldn\\'t parse cleaned data ' + numArrayToHexArray([a, b]) +\n                            ' orig: ' + numArrayToHexArray([byteList[i], byteList[i+1]]));\n            }\n        }\n    }\n\n    /**\n     * Parse Command.\n     * @returns {Boolean} Tells if a command was found\n     */\n    parseCmd(a, b) {\n        var chNr = null;\n\n        var cond1 = (a === 0x14 || a === 0x1C) && (0x20 <= b && b <= 0x2F);\n        var cond2 = (a === 0x17 || a === 0x1F) && (0x21 <= b && b <= 0x23);\n        if (!(cond1 || cond2)) {\n            return false;\n        }\n\n        if (a === this.lastCmdA && b === this.lastCmdB) {\n            this.lastCmdA = null;\n            this.lastCmdB = null; // Repeated commands are dropped (once)\n            logger.log('DEBUG', 'Repeated command (' + numArrayToHexArray([a, b]) + ') is dropped');\n            return true;\n        }\n\n        if (a === 0x14 || a === 0x17) {\n            chNr = 1;\n        } else {\n            chNr = 2; // (a === 0x1C || a=== 0x1f)\n        }\n\n        var channel = this.channels[chNr - 1];\n\n        if (a === 0x14 || a === 0x1C) {\n            if (b === 0x20) {\n                channel.ccRCL();\n            } else if (b === 0x21) {\n                channel.ccBS();\n            } else if (b === 0x22) {\n                channel.ccAOF();\n            } else if (b === 0x23) {\n                channel.ccAON();\n            } else if (b === 0x24) {\n                channel.ccDER();\n            } else if (b === 0x25) {\n                channel.ccRU(2);\n            } else if (b === 0x26) {\n                channel.ccRU(3);\n            } else if (b === 0x27) {\n                channel.ccRU(4);\n            } else if (b === 0x28) {\n                channel.ccFON();\n            } else if (b === 0x29) {\n                channel.ccRDC();\n            } else if (b === 0x2A) {\n                channel.ccTR();\n            } else if (b === 0x2B) {\n                channel.ccRTD();\n            } else if (b === 0x2C) {\n                channel.ccEDM();\n            } else if (b === 0x2D) {\n                channel.ccCR();\n            } else if (b === 0x2E) {\n                channel.ccENM();\n            } else if (b === 0x2F) {\n                channel.ccEOC();\n            }\n        } else { //a == 0x17 || a == 0x1F\n            channel.ccTO(b - 0x20);\n        }\n        this.lastCmdA = a;\n        this.lastCmdB = b;\n        this.currChNr = chNr;\n        return true;\n    }\n\n    /**\n     * Parse midrow styling command\n     * @returns {Boolean}\n     */\n    parseMidrow(a, b) {\n        var chNr = null;\n\n        if ( ((a === 0x11) || (a === 0x19)) && 0x20 <= b && b <= 0x2f) {\n            if (a === 0x11) {\n                chNr = 1;\n            } else  {\n                chNr = 2;\n            }\n            if (chNr !== this.currChNr) {\n                logger.log('ERROR', 'Mismatch channel in midrow parsing');\n                return false;\n            }\n            var channel = this.channels[chNr-1];\n            channel.ccMIDROW(b);\n            logger.log('DEBUG', 'MIDROW (' + numArrayToHexArray([a, b]) + ')');\n            return true;\n        }\n        return false;\n    }\n    /**\n     * Parse Preable Access Codes (Table 53).\n     * @returns {Boolean} Tells if PAC found\n     */\n    parsePAC(a, b) {\n\n       var chNr = null;\n       var row = null;\n\n        var case1 = ((0x11 <= a  && a <= 0x17) || (0x19 <= a && a <= 0x1F)) && (0x40 <= b && b <= 0x7F);\n        var case2 = (a === 0x10 || a === 0x18) && (0x40 <= b && b <= 0x5F);\n        if (! (case1 || case2)) {\n            return false;\n        }\n\n        if (a === this.lastCmdA && b === this.lastCmdB) {\n            this.lastCmdA = null;\n            this.lastCmdB = null;\n            return true; // Repeated commands are dropped (once)\n        }\n\n        chNr = (a <= 0x17) ? 1 : 2;\n\n        if (0x40 <= b && b <= 0x5F) {\n            row = (chNr === 1) ? rowsLowCh1[a] : rowsLowCh2[a];\n        } else { // 0x60 <= b <= 0x7F\n            row = (chNr === 1) ? rowsHighCh1[a] : rowsHighCh2[a];\n        }\n        var pacData = this.interpretPAC(row, b);\n        var channel = this.channels[chNr-1];\n        channel.setPAC(pacData);\n        this.lastCmdA = a;\n        this.lastCmdB = b;\n        this.currChNr = chNr;\n        return true;\n    }\n\n    /**\n     * Interpret the second byte of the pac, and return the information.\n     * @returns {Object} pacData with style parameters.\n     */\n    interpretPAC(row, byte) {\n        var pacIndex = byte;\n        var pacData = {color : null, italics : false, indent : null, underline : false, row : row};\n\n        if (byte > 0x5F) {\n            pacIndex = byte - 0x60;\n        } else {\n            pacIndex = byte - 0x40;\n        }\n        pacData.underline = (pacIndex & 1) === 1;\n        if (pacIndex <= 0xd) {\n            pacData.color = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta', 'white'][Math.floor(pacIndex/2)];\n        } else if (pacIndex <= 0xf) {\n            pacData.italics = true;\n            pacData.color = 'white';\n        } else {\n            pacData.indent = (Math.floor((pacIndex-0x10)/2))*4;\n        }\n        return pacData; // Note that row has zero offset. The spec uses 1.\n    }\n\n    /**\n     * Parse characters.\n     * @returns An array with 1 to 2 codes corresponding to chars, if found. null otherwise.\n     */\n    parseChars(a, b) {\n\n       var  channelNr = null,\n            charCodes = null,\n            charCode1 = null;\n\n        if (a >= 0x19) {\n            channelNr = 2;\n            charCode1 = a - 8;\n        } else {\n            channelNr = 1;\n            charCode1 = a;\n        }\n        if (0x11 <= charCode1 && charCode1 <= 0x13) {\n            // Special character\n            var oneCode = b;\n            if (charCode1 === 0x11) {\n                oneCode = b + 0x50;\n            } else if (charCode1 === 0x12) {\n                oneCode = b + 0x70;\n            } else {\n                oneCode = b + 0x90;\n            }\n            logger.log('INFO', 'Special char \\'' + getCharForByte(oneCode) + '\\' in channel ' + channelNr);\n            charCodes = [oneCode];\n        } else if (0x20 <= a && a <= 0x7f) {\n            charCodes = (b === 0) ? [a] : [a, b];\n        }\n        if (charCodes) {\n            var hexCodes = numArrayToHexArray(charCodes);\n            logger.log('DEBUG', 'Char codes =  ' + hexCodes.join(','));\n            this.lastCmdA = null;\n            this.lastCmdB = null;\n        }\n        return charCodes;\n    }\n\n    /**\n    * Parse extended background attributes as well as new foreground color black.\n    * @returns{Boolean} Tells if background attributes are found\n    */\n    parseBackgroundAttributes(a, b) {\n       var  bkgData,\n            index,\n            chNr,\n            channel;\n\n        var case1 = (a === 0x10 || a === 0x18) && (0x20 <= b && b <= 0x2f);\n        var case2 = (a === 0x17 || a === 0x1f) && (0x2d <=b && b <= 0x2f);\n        if (!(case1 || case2)) {\n            return false;\n        }\n        bkgData = {};\n        if (a  === 0x10 || a === 0x18) {\n            index = Math.floor((b-0x20)/2);\n            bkgData.background = backgroundColors[index];\n            if (b % 2 === 1) {\n                bkgData.background = bkgData.background + '_semi';\n            }\n        } else if (b === 0x2d) {\n            bkgData.background = 'transparent';\n        } else {\n            bkgData.foreground = 'black';\n            if (b === 0x2f) {\n                bkgData.underline = true;\n            }\n        }\n        chNr = (a < 0x18) ? 1 : 2;\n        channel = this.channels[chNr-1];\n        channel.setBkgData(bkgData);\n        this.lastCmdA = null;\n        this.lastCmdB = null;\n        return true;\n    }\n\n    /**\n     * Reset state of parser and its channels.\n     */\n    reset() {\n        for (var i=0 ; i < this.channels.length ; i++) {\n            if (this.channels[i]) {\n                this.channels[i].reset();\n            }\n        }\n        this.lastCmdA = null;\n        this.lastCmdB = null;\n    }\n\n    /**\n     * Trigger the generation of a cue, and the start of a new one if displayScreens are not empty.\n     */\n    cueSplitAtTime(t) {\n        for (var i=0 ; i < this.channels.length ; i++) {\n            if (this.channels[i]) {\n                this.channels[i].cueSplitAtTime(t);\n            }\n        }\n    }\n}\n\nexport default Cea608Parser;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/cea-608-parser.js","import { fixLineBreaks } from './vttparser';\n\nconst Cues = {\n\n  newCue: function(track, startTime, endTime, captionScreen) {\n    var row;\n    var cue;\n    var indenting;\n    var indent;\n    var text;\n    var VTTCue = window.VTTCue || window.TextTrackCue;\n\n    for (var r=0; r<captionScreen.rows.length; r++)\n    {\n      row = captionScreen.rows[r];\n      indenting = true;\n      indent = 0;\n      text = '';\n\n      if (!row.isEmpty())\n      {\n        for (var c=0; c<row.chars.length; c++)\n        {\n          if (row.chars[c].uchar.match(/\\s/) && indenting)\n          {\n            indent++;\n          }\n          else\n          {\n            text += row.chars[c].uchar;\n            indenting = false;\n          }\n        }\n        //To be used for cleaning-up orphaned roll-up captions\n        row.cueStartTime = startTime;\n\n        // Give a slight bump to the endTime if it's equal to startTime to avoid a SyntaxError in IE\n        if (startTime === endTime)\n        {\n          endTime += 0.0001;\n        }\n\n        cue = new VTTCue(startTime, endTime, fixLineBreaks(text.trim()));\n\n        if (indent >= 16)\n        {\n          indent--;\n        }\n        else\n        {\n          indent++;\n        }\n\n        // VTTCue.line get's flakey when using controls, so let's now include line 13&14\n        // also, drop line 1 since it's to close to the top\n        if (navigator.userAgent.match(/Firefox\\//))\n        {\n          cue.line = r + 1;\n        }\n        else\n        {\n          cue.line = (r > 7 ? r - 2 : r + 1);\n        }\n        cue.align = 'left';\n        // Clamp the position between 0 and 100 - if out of these bounds, Firefox throws an exception and captions break\n        cue.position = Math.max(0, Math.min(100, 100 * (indent / 32) + (navigator.userAgent.match(/Firefox\\//) ? 50 : 0)));\n        track.addCue(cue);\n      }\n    }\n  }\n\n};\n\nmodule.exports = Cues;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/cues.js","/*\n * EWMA Bandwidth Estimator\n *  - heavily inspired from shaka-player\n * Tracks bandwidth samples and estimates available bandwidth.\n * Based on the minimum of two exponentially-weighted moving averages with\n * different half-lives.\n */\n\nimport EWMA from '../utils/ewma';\n\n\nclass EwmaBandWidthEstimator {\n\n  constructor(hls,slow,fast,defaultEstimate) {\n    this.hls = hls;\n    this.defaultEstimate_ = defaultEstimate;\n    this.minWeight_ = 0.001;\n    this.minDelayMs_ = 50;\n    this.slow_ = new EWMA(slow);\n    this.fast_ = new EWMA(fast);\n  }\n\n  sample(durationMs,numBytes) {\n    durationMs = Math.max(durationMs, this.minDelayMs_);\n    var bandwidth = 8000* numBytes / durationMs,\n    //console.log('instant bw:'+ Math.round(bandwidth));\n    // we weight sample using loading duration....\n        weight = durationMs / 1000;\n    this.fast_.sample(weight,bandwidth);\n    this.slow_.sample(weight,bandwidth);\n  }\n\n  canEstimate() {\n    let fast = this.fast_;\n    return (fast && fast.getTotalWeight() >= this.minWeight_);\n  }\n\n\n  getEstimate() {\n    if (this.canEstimate()) {\n      //console.log('slow estimate:'+ Math.round(this.slow_.getEstimate()));\n      //console.log('fast estimate:'+ Math.round(this.fast_.getEstimate()));\n      // Take the minimum of these two estimates.  This should have the effect of\n      // adapting down quickly, but up more slowly.\n      return Math.min(this.fast_.getEstimate(),this.slow_.getEstimate());\n    } else {\n      return this.defaultEstimate_;\n    }\n  }\n\n  destroy() {\n  }\n}\nexport default EwmaBandWidthEstimator;\n\n\n\n\n// WEBPACK FOOTER //\n// src/utils/ewma-bandwidth-estimator.js","/*\n * compute an Exponential Weighted moving average\n * - https://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average\n *  - heavily inspired from shaka-player\n */\n\nclass EWMA {\n\n //  About half of the estimated value will be from the last |halfLife| samples by weight.\n  constructor(halfLife) {\n    // Larger values of alpha expire historical data more slowly.\n    this.alpha_ = halfLife ? Math.exp(Math.log(0.5) / halfLife) : 0;\n    this.estimate_ = 0;\n    this.totalWeight_ = 0;\n  }\n\n  sample(weight,value) {\n    var adjAlpha = Math.pow(this.alpha_, weight);\n    this.estimate_ = value * (1 - adjAlpha) + adjAlpha * this.estimate_;\n    this.totalWeight_ += weight;\n  }\n\n  getTotalWeight() {\n    return this.totalWeight_;\n  }\n\n  getEstimate() {\n    if (this.alpha_) {\n      var zeroFactor = 1 - Math.pow(this.alpha_, this.totalWeight_);\n      return this.estimate_ / zeroFactor;\n    } else {\n      return this.estimate_;\n    }\n  }\n}\n\nexport default EWMA;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/ewma.js","'use strict';\n\nfunction noop() {}\n\nconst fakeLogger = {\n  trace: noop,\n  debug: noop,\n  log: noop,\n  warn: noop,\n  info: noop,\n  error: noop\n};\n\nlet exportedLogger = fakeLogger;\n\n/*globals self: false */\n\n//let lastCallTime;\n// function formatMsgWithTimeInfo(type, msg) {\n//   const now = Date.now();\n//   const diff = lastCallTime ? '+' + (now - lastCallTime) : '0';\n//   lastCallTime = now;\n//   msg = (new Date(now)).toISOString() + ' | [' +  type + '] > ' + msg + ' ( ' + diff + ' ms )';\n//   return msg;\n// }\n\nfunction formatMsg(type, msg) {\n  msg = '[' +  type + '] > ' + msg;\n  return msg;\n}\n\nfunction consolePrintFn(type) {\n  const func = self.console[type];\n  if (func) {\n    return function(...args) {\n      if(args[0]) {\n        args[0] = formatMsg(type, args[0]);\n      }\n      func.apply(self.console, args);\n    };\n  }\n  return noop;\n}\n\nfunction exportLoggerFunctions(debugConfig, ...functions) {\n  functions.forEach(function(type) {\n    exportedLogger[type] = debugConfig[type] ? debugConfig[type].bind(debugConfig) : consolePrintFn(type);\n  });\n}\n\nexport var enableLogs = function(debugConfig) {\n  if (debugConfig === true || typeof debugConfig === 'object') {\n    exportLoggerFunctions(debugConfig,\n      // Remove out from list here to hard-disable a log-level\n      //'trace',\n      'debug',\n      'log',\n      'info',\n      'warn',\n      'error'\n    );\n    // Some browsers don't allow to use bind on console object anyway\n    // fallback to default if needed\n    try {\n     exportedLogger.log();\n    } catch (e) {\n      exportedLogger = fakeLogger;\n    }\n  }\n  else {\n    exportedLogger = fakeLogger;\n  }\n};\n\nexport var logger = exportedLogger;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/logger.js","/**\n *  TimeRanges to string helper\n */\n\nconst TimeRanges = {\n  toString : function(r) {\n    var log = '', len = r.length;\n    for (var i=0; i<len; i++) {\n      log += '[' + r.start(i).toFixed(3) + ',' + r.end(i).toFixed(3) + ']';\n    }\n    return log;\n  }\n};\n\nmodule.exports = TimeRanges;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/timeRanges.js","/**\n * Copyright 2013 vtt.js Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default (function() {\n  if (typeof window !== 'undefined' && window.VTTCue) {\n    return window.VTTCue;\n  }\n\n  var autoKeyword = 'auto';\n  var directionSetting = {\n    '': true,\n    lr: true,\n    rl: true\n  };\n  var alignSetting = {\n    start: true,\n    middle: true,\n    end: true,\n    left: true,\n    right: true\n  };\n\n  function findDirectionSetting(value) {\n    if (typeof value !== 'string') {\n      return false;\n    }\n    var dir = directionSetting[value.toLowerCase()];\n    return dir ? value.toLowerCase() : false;\n  }\n\n  function findAlignSetting(value) {\n    if (typeof value !== 'string') {\n      return false;\n    }\n    var align = alignSetting[value.toLowerCase()];\n    return align ? value.toLowerCase() : false;\n  }\n\n  function extend(obj) {\n    var i = 1;\n    for (; i < arguments.length; i++) {\n      var cobj = arguments[i];\n      for (var p in cobj) {\n        obj[p] = cobj[p];\n      }\n    }\n\n    return obj;\n  }\n\n  function VTTCue(startTime, endTime, text) {\n    var cue = this;\n    var isIE8 = (function () {\n      if (typeof navigator === 'undefined') {\n        return;\n      }\n      return (/MSIE\\s8\\.0/).test(navigator.userAgent);\n    })();\n    var baseObj = {};\n\n    if (isIE8) {\n      cue = document.createElement('custom');\n    } else {\n      baseObj.enumerable = true;\n    }\n\n    /**\n     * Shim implementation specific properties. These properties are not in\n     * the spec.\n     */\n\n    // Lets us know when the VTTCue's data has changed in such a way that we need\n    // to recompute its display state. This lets us compute its display state\n    // lazily.\n    cue.hasBeenReset = false;\n\n    /**\n     * VTTCue and TextTrackCue properties\n     * http://dev.w3.org/html5/webvtt/#vttcue-interface\n     */\n\n    var _id = '';\n    var _pauseOnExit = false;\n    var _startTime = startTime;\n    var _endTime = endTime;\n    var _text = text;\n    var _region = null;\n    var _vertical = '';\n    var _snapToLines = true;\n    var _line = 'auto';\n    var _lineAlign = 'start';\n    var _position = 50;\n    var _positionAlign = 'middle';\n    var _size = 50;\n    var _align = 'middle';\n\n    Object.defineProperty(cue, 'id', extend({}, baseObj, {\n      get: function () {\n        return _id;\n      },\n      set: function (value) {\n        _id = '' + value;\n      }\n    }));\n\n    Object.defineProperty(cue, 'pauseOnExit', extend({}, baseObj, {\n      get: function () {\n        return _pauseOnExit;\n      },\n      set: function (value) {\n        _pauseOnExit = !!value;\n      }\n    }));\n\n    Object.defineProperty(cue, 'startTime', extend({}, baseObj, {\n      get: function () {\n        return _startTime;\n      },\n      set: function (value) {\n        if (typeof value !== 'number') {\n          throw new TypeError('Start time must be set to a number.');\n        }\n        _startTime = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'endTime', extend({}, baseObj, {\n      get: function () {\n        return _endTime;\n      },\n      set: function (value) {\n        if (typeof value !== 'number') {\n          throw new TypeError('End time must be set to a number.');\n        }\n        _endTime = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'text', extend({}, baseObj, {\n      get: function () {\n        return _text;\n      },\n      set: function (value) {\n        _text = '' + value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'region', extend({}, baseObj, {\n      get: function () {\n        return _region;\n      },\n      set: function (value) {\n        _region = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'vertical', extend({}, baseObj, {\n      get: function () {\n        return _vertical;\n      },\n      set: function (value) {\n        var setting = findDirectionSetting(value);\n        // Have to check for false because the setting an be an empty string.\n        if (setting === false) {\n          throw new SyntaxError('An invalid or illegal string was specified.');\n        }\n        _vertical = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'snapToLines', extend({}, baseObj, {\n      get: function () {\n        return _snapToLines;\n      },\n      set: function (value) {\n        _snapToLines = !!value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'line', extend({}, baseObj, {\n      get: function () {\n        return _line;\n      },\n      set: function (value) {\n        if (typeof value !== 'number' && value !== autoKeyword) {\n          throw new SyntaxError('An invalid number or illegal string was specified.');\n        }\n        _line = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'lineAlign', extend({}, baseObj, {\n      get: function () {\n        return _lineAlign;\n      },\n      set: function (value) {\n        var setting = findAlignSetting(value);\n        if (!setting) {\n          throw new SyntaxError('An invalid or illegal string was specified.');\n        }\n        _lineAlign = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'position', extend({}, baseObj, {\n      get: function () {\n        return _position;\n      },\n      set: function (value) {\n        if (value < 0 || value > 100) {\n          throw new Error('Position must be between 0 and 100.');\n        }\n        _position = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'positionAlign', extend({}, baseObj, {\n      get: function () {\n        return _positionAlign;\n      },\n      set: function (value) {\n        var setting = findAlignSetting(value);\n        if (!setting) {\n          throw new SyntaxError('An invalid or illegal string was specified.');\n        }\n        _positionAlign = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'size', extend({}, baseObj, {\n      get: function () {\n        return _size;\n      },\n      set: function (value) {\n        if (value < 0 || value > 100) {\n          throw new Error('Size must be between 0 and 100.');\n        }\n        _size = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'align', extend({}, baseObj, {\n      get: function () {\n        return _align;\n      },\n      set: function (value) {\n        var setting = findAlignSetting(value);\n        if (!setting) {\n          throw new SyntaxError('An invalid or illegal string was specified.');\n        }\n        _align = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    /**\n     * Other <track> spec defined properties\n     */\n\n    // http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#text-track-cue-display-state\n    cue.displayState = undefined;\n\n    if (isIE8) {\n      return cue;\n    }\n  }\n\n  /**\n   * VTTCue methods\n   */\n\n  VTTCue.prototype.getCueAsHTML = function () {\n    // Assume WebVTT.convertCueToDOMTree is on the global.\n    var WebVTT = window.WebVTT;\n    return WebVTT.convertCueToDOMTree(window, this.text);\n  };\n\n  return VTTCue;\n})();\n\n\n\n// WEBPACK FOOTER //\n// src/utils/vttcue.js","/*\n * Source: https://github.com/mozilla/vtt.js/blob/master/dist/vtt.js#L1716\n */\n\nimport VTTCue from './vttcue';\n\nconst StringDecoder = function StringDecoder() {\n  return {\n    decode: function(data) {\n      if (!data) {\n        return '';\n      }\n      if (typeof data !== 'string') {\n        throw new Error('Error - expected string data.');\n      }\n      return decodeURIComponent(encodeURIComponent(data));\n        },\n    };\n  };\n\nfunction VTTParser() {\n    this.window = window;\n    this.state = 'INITIAL';\n    this.buffer = '';\n    this.decoder = new StringDecoder();\n    this.regionList = [];\n}\n\n\n// Try to parse input as a time stamp.\nfunction parseTimeStamp(input) {\n\n  function computeSeconds(h, m, s, f) {\n    return (h | 0) * 3600 + (m | 0) * 60 + (s | 0) + (f | 0) / 1000;\n  }\n\n  var m = input.match(/^(\\d+):(\\d{2})(:\\d{2})?\\.(\\d{3})/);\n  if (!m) {\n    return null;\n  }\n\n  if (m[3]) {\n    // Timestamp takes the form of [hours]:[minutes]:[seconds].[milliseconds]\n    return computeSeconds(m[1], m[2], m[3].replace(':', ''), m[4]);\n  } else if (m[1] > 59) {\n    // Timestamp takes the form of [hours]:[minutes].[milliseconds]\n    // First position is hours as it's over 59.\n    return computeSeconds(m[1], m[2], 0, m[4]);\n  } else {\n    // Timestamp takes the form of [minutes]:[seconds].[milliseconds]\n    return computeSeconds(0, m[1], m[2], m[4]);\n  }\n}\n\n// A settings object holds key/value pairs and will ignore anything but the first\n// assignment to a specific key.\nfunction Settings() {\n  this.values = Object.create(null);\n}\n\nSettings.prototype = {\n  // Only accept the first assignment to any key.\n  set: function(k, v) {\n    if (!this.get(k) && v !== '') {\n      this.values[k] = v;\n    }\n  },\n  // Return the value for a key, or a default value.\n  // If 'defaultKey' is passed then 'dflt' is assumed to be an object with\n  // a number of possible default values as properties where 'defaultKey' is\n  // the key of the property that will be chosen; otherwise it's assumed to be\n  // a single value.\n  get: function(k, dflt, defaultKey) {\n    if (defaultKey) {\n      return this.has(k) ? this.values[k] : dflt[defaultKey];\n    }\n    return this.has(k) ? this.values[k] : dflt;\n  },\n  // Check whether we have a value for a key.\n  has: function(k) {\n    return k in this.values;\n  },\n  // Accept a setting if its one of the given alternatives.\n  alt: function(k, v, a) {\n    for (var n = 0; n < a.length; ++n) {\n      if (v === a[n]) {\n        this.set(k, v);\n        break;\n      }\n    }\n  },\n  // Accept a setting if its a valid (signed) integer.\n  integer: function(k, v) {\n    if (/^-?\\d+$/.test(v)) { // integer\n      this.set(k, parseInt(v, 10));\n    }\n  },\n  // Accept a setting if its a valid percentage.\n  percent: function(k, v) {\n    var m;\n    if ((m = v.match(/^([\\d]{1,3})(\\.[\\d]*)?%$/))) {\n      v = parseFloat(v);\n      if (v >= 0 && v <= 100) {\n        this.set(k, v);\n        return true;\n      }\n    }\n    return false;\n  }\n};\n\n// Helper function to parse input into groups separated by 'groupDelim', and\n// interprete each group as a key/value pair separated by 'keyValueDelim'.\nfunction parseOptions(input, callback, keyValueDelim, groupDelim) {\n  var groups = groupDelim ? input.split(groupDelim) : [input];\n  for (var i in groups) {\n    if (typeof groups[i] !== 'string') {\n      continue;\n    }\n    var kv = groups[i].split(keyValueDelim);\n    if (kv.length !== 2) {\n      continue;\n    }\n    var k = kv[0];\n    var v = kv[1];\n    callback(k, v);\n  }\n}\n\nvar defaults = new VTTCue(0, 0, 0);\n// 'middle' was changed to 'center' in the spec: https://github.com/w3c/webvtt/pull/244\n// Chrome and Safari don't yet support this change, but FF does\nvar center = defaults.align === 'middle' ? 'middle' : 'center';\n\nfunction parseCue(input, cue, regionList) {\n  // Remember the original input if we need to throw an error.\n  var oInput = input;\n  // 4.1 WebVTT timestamp\n  function consumeTimeStamp() {\n    var ts = parseTimeStamp(input);\n    if (ts === null) {\n      throw new Error('Malformed timestamp: ' + oInput);\n    }\n    // Remove time stamp from input.\n    input = input.replace(/^[^\\sa-zA-Z-]+/, '');\n    return ts;\n  }\n\n  // 4.4.2 WebVTT cue settings\n  function consumeCueSettings(input, cue) {\n    var settings = new Settings();\n\n    parseOptions(input, function(k, v) {\n      switch (k) {\n        case 'region':\n          // Find the last region we parsed with the same region id.\n          for (var i = regionList.length - 1; i >= 0; i--) {\n            if (regionList[i].id === v) {\n              settings.set(k, regionList[i].region);\n              break;\n            }\n          }\n          break;\n        case 'vertical':\n          settings.alt(k, v, ['rl', 'lr']);\n          break;\n        case 'line':\n          var vals = v.split(','),\n            vals0 = vals[0];\n          settings.integer(k, vals0);\n          if (settings.percent(k, vals0)) {\n            settings.set('snapToLines', false);\n          }\n          settings.alt(k, vals0, ['auto']);\n          if (vals.length === 2) {\n            settings.alt('lineAlign', vals[1], ['start', center, 'end']);\n          }\n          break;\n        case 'position':\n          vals = v.split(',');\n          settings.percent(k, vals[0]);\n          if (vals.length === 2) {\n            settings.alt('positionAlign', vals[1], ['start', center, 'end', 'line-left', 'line-right', 'auto']);\n          }\n          break;\n        case 'size':\n          settings.percent(k, v);\n          break;\n        case 'align':\n          settings.alt(k, v, ['start', center, 'end', 'left', 'right']);\n          break;\n      }\n    }, /:/, /\\s/);\n\n    // Apply default values for any missing fields.\n    cue.region = settings.get('region', null);\n    cue.vertical = settings.get('vertical', '');\n    var line = settings.get('line', 'auto');\n    if (line === 'auto' && defaults.line === -1) {\n      // set numeric line number for Safari\n      line = -1;\n    }\n    cue.line = line;\n    cue.lineAlign = settings.get('lineAlign', 'start');\n    cue.snapToLines = settings.get('snapToLines', true);\n    cue.size = settings.get('size', 100);\n    cue.align = settings.get('align', center);\n    var position = settings.get('position', 'auto');\n    if (position === 'auto' && defaults.position === 50) {\n      // set numeric position for Safari\n      position = cue.align === 'start' || cue.align === 'left' ? 0 : cue.align === 'end' || cue.align === 'right' ? 100 : 50;\n    }\n    cue.position = position;\n  }\n\n  function skipWhitespace() {\n    input = input.replace(/^\\s+/, '');\n  }\n\n  // 4.1 WebVTT cue timings.\n  skipWhitespace();\n  cue.startTime = consumeTimeStamp();   // (1) collect cue start time\n  skipWhitespace();\n  if (input.substr(0, 3) !== '-->') {     // (3) next characters must match '-->'\n    throw new Error('Malformed time stamp (time stamps must be separated by \\'-->\\'): ' +\n      oInput);\n  }\n  input = input.substr(3);\n  skipWhitespace();\n  cue.endTime = consumeTimeStamp();     // (5) collect cue end time\n\n  // 4.1 WebVTT cue settings list.\n  skipWhitespace();\n  consumeCueSettings(input, cue);\n}\n\nfunction fixLineBreaks(input) {\n  return input.replace(/<br(?: \\/)?>/gi, '\\n');\n}\n\nVTTParser.prototype = {\n  parse: function(data) {\n    var self = this;\n\n    // If there is no data then we won't decode it, but will just try to parse\n    // whatever is in buffer already. This may occur in circumstances, for\n    // example when flush() is called.\n    if (data) {\n      // Try to decode the data that we received.\n      self.buffer += self.decoder.decode(data, {stream: true});\n    }\n\n    function collectNextLine() {\n      var buffer = self.buffer;\n      var pos = 0;\n\n      buffer = fixLineBreaks(buffer);\n\n      while (pos < buffer.length && buffer[pos] !== '\\r' && buffer[pos] !== '\\n') {\n        ++pos;\n      }\n      var line = buffer.substr(0, pos);\n      // Advance the buffer early in case we fail below.\n      if (buffer[pos] === '\\r') {\n        ++pos;\n      }\n      if (buffer[pos] === '\\n') {\n        ++pos;\n      }\n      self.buffer = buffer.substr(pos);\n      return line;\n    }\n\n    // 3.2 WebVTT metadata header syntax\n    function parseHeader(input) {\n      parseOptions(input, function(k, v) {\n        switch (k) {\n          case 'Region':\n            // 3.3 WebVTT region metadata header syntax\n            console.log('parse region', v);\n            //parseRegion(v);\n            break;\n        }\n      }, /:/);\n    }\n\n    // 5.1 WebVTT file parsing.\n    try {\n      var line;\n      if (self.state === 'INITIAL') {\n        // We can't start parsing until we have the first line.\n        if (!/\\r\\n|\\n/.test(self.buffer)) {\n          return this;\n        }\n\n        line = collectNextLine();\n\n        var m = line.match(/^WEBVTT([ \\t].*)?$/);\n        if (!m || !m[0]) {\n          throw new Error('Malformed WebVTT signature.');\n        }\n\n        self.state = 'HEADER';\n      }\n\n      var alreadyCollectedLine = false;\n      while (self.buffer) {\n        // We can't parse a line until we have the full line.\n        if (!/\\r\\n|\\n/.test(self.buffer)) {\n          return this;\n        }\n\n        if (!alreadyCollectedLine) {\n          line = collectNextLine();\n        } else {\n          alreadyCollectedLine = false;\n        }\n\n        switch (self.state) {\n          case 'HEADER':\n            // 13-18 - Allow a header (metadata) under the WEBVTT line.\n            if (/:/.test(line)) {\n              parseHeader(line);\n            } else if (!line) {\n              // An empty line terminates the header and starts the body (cues).\n              self.state = 'ID';\n            }\n            continue;\n          case 'NOTE':\n            // Ignore NOTE blocks.\n            if (!line) {\n              self.state = 'ID';\n            }\n            continue;\n          case 'ID':\n            // Check for the start of NOTE blocks.\n            if (/^NOTE($|[ \\t])/.test(line)) {\n              self.state = 'NOTE';\n              break;\n            }\n            // 19-29 - Allow any number of line terminators, then initialize new cue values.\n            if (!line) {\n              continue;\n            }\n            self.cue = new VTTCue(0, 0, '');\n            self.state = 'CUE';\n            // 30-39 - Check if self line contains an optional identifier or timing data.\n            if (line.indexOf('-->') === -1) {\n              self.cue.id = line;\n              continue;\n            }\n          // Process line as start of a cue.\n          /*falls through*/\n          case 'CUE':\n            // 40 - Collect cue timings and settings.\n            try {\n              parseCue(line, self.cue, self.regionList);\n            } catch (e) {\n              // In case of an error ignore rest of the cue.\n              self.cue = null;\n              self.state = 'BADCUE';\n              continue;\n            }\n            self.state = 'CUETEXT';\n            continue;\n          case 'CUETEXT':\n            var hasSubstring = line.indexOf('-->') !== -1;\n            // 34 - If we have an empty line then report the cue.\n            // 35 - If we have the special substring '-->' then report the cue,\n            // but do not collect the line as we need to process the current\n            // one as a new cue.\n            if (!line || hasSubstring && (alreadyCollectedLine = true)) {\n              // We are done parsing self cue.\n              if (self.oncue) {\n                self.oncue(self.cue);\n              }\n              self.cue = null;\n              self.state = 'ID';\n              continue;\n            }\n            if (self.cue.text) {\n              self.cue.text += '\\n';\n            }\n            self.cue.text += line;\n            continue;\n          case 'BADCUE': // BADCUE\n            // 54-62 - Collect and discard the remaining cue.\n            if (!line) {\n              self.state = 'ID';\n            }\n            continue;\n        }\n      }\n    } catch (e) {\n\n      // If we are currently parsing a cue, report what we have.\n      if (self.state === 'CUETEXT' && self.cue && self.oncue) {\n        self.oncue(self.cue);\n      }\n      self.cue = null;\n      // Enter BADWEBVTT state if header was not parsed correctly otherwise\n      // another exception occurred so enter BADCUE state.\n      self.state = self.state === 'INITIAL' ? 'BADWEBVTT' : 'BADCUE';\n    }\n    return this;\n  },\n  flush: function() {\n    var self = this;\n    try {\n      // Finish decoding the stream.\n      self.buffer += self.decoder.decode();\n      // Synthesize the end of the current cue or region.\n      if (self.cue || self.state === 'HEADER') {\n        self.buffer += '\\n\\n';\n        self.parse();\n      }\n      // If we've flushed, parsed, and we're still on the INITIAL state then\n      // that means we don't have enough of the stream to parse the first\n      // line.\n      if (self.state === 'INITIAL') {\n        throw new Error('Malformed WebVTT signature.');\n      }\n    } catch (e) {\n      throw e;\n    }\n    if (self.onflush) {\n      self.onflush();\n    }\n    return this;\n  }\n};\n\nexport { fixLineBreaks };\n\nexport default VTTParser;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/vttparser.js","import VTTParser from './vttparser';\n\n// String.prototype.startsWith is not supported in IE11\nconst startsWith = function(inputString, searchString, position) {\n  return inputString.substr(position || 0, searchString.length) === searchString;\n};\n\nconst cueString2millis = function(timeString) {\n    let ts = parseInt(timeString.substr(-3));\n    let secs = parseInt(timeString.substr(-6,2));\n    let mins = parseInt(timeString.substr(-9,2));\n    let hours = timeString.length > 9 ? parseInt(timeString.substr(0, timeString.indexOf(':'))) : 0;\n\n    if (isNaN(ts) || isNaN(secs) || isNaN(mins) || isNaN(hours)) {\n        return -1;\n    }\n\n    ts += 1000 * secs;\n    ts += 60*1000 * mins;\n    ts += 60*60*1000 * hours;\n\n    return ts;\n};\n\n// From https://github.com/darkskyapp/string-hash\nconst hash = function(text) {\n    let hash = 5381;\n    let i = text.length;\n    while (i) {\n        hash = (hash * 33) ^ text.charCodeAt(--i);\n    }\n    return (hash >>> 0).toString();\n};\n\nconst calculateOffset = function(vttCCs, cc, presentationTime) {\n    let currCC = vttCCs[cc];\n    let prevCC = vttCCs[currCC.prevCC];\n\n    // This is the first discontinuity or cues have been processed since the last discontinuity\n    // Offset = current discontinuity time\n    if (!prevCC || (!prevCC.new && currCC.new)) {\n        vttCCs.ccOffset = vttCCs.presentationOffset = currCC.start;\n        currCC.new = false;\n        return;\n    }\n\n    // There have been discontinuities since cues were last parsed.\n    // Offset = time elapsed\n    while (prevCC && prevCC.new) {\n        vttCCs.ccOffset += currCC.start - prevCC.start;\n        currCC.new = false;\n        currCC = prevCC;\n        prevCC = vttCCs[currCC.prevCC];\n    }\n\n    vttCCs.presentationOffset = presentationTime;\n};\n\nconst WebVTTParser = {\n    parse: function(vttByteArray, syncPTS, vttCCs, cc, callBack, errorCallBack) {\n        // Convert byteArray into string, replacing any somewhat exotic linefeeds with \"\\n\", then split on that character.\n        let re = /\\r\\n|\\n\\r|\\n|\\r/g;\n        let vttLines = String.fromCharCode.apply(null, new Uint8Array(vttByteArray)).trim().replace(re, '\\n').split('\\n');\n        let cueTime = '00:00.000';\n        let mpegTs = 0;\n        let localTime = 0;\n        let presentationTime = 0;\n        let cues = [];\n        let parsingError;\n        let inHeader = true;\n        // let VTTCue = VTTCue || window.TextTrackCue;\n\n        // Create parser object using VTTCue with TextTrackCue fallback on certain browsers.\n        let parser = new VTTParser();\n\n        parser.oncue = function(cue) {\n            // Adjust cue timing; clamp cues to start no earlier than - and drop cues that don't end after - 0 on timeline.\n            let currCC = vttCCs[cc];\n            let cueOffset = vttCCs.ccOffset;\n\n            // Update offsets for new discontinuities\n            if (currCC && currCC.new) {\n                if (localTime !== undefined) {\n                    // When local time is provided, offset = discontinuity start time - local time\n                    cueOffset = vttCCs.ccOffset = currCC.start;\n                } else {\n                    calculateOffset(vttCCs, cc, presentationTime);\n                }\n            }\n\n            if (presentationTime) {\n                // If we have MPEGTS, offset = presentation time + discontinuity offset\n                cueOffset = presentationTime + vttCCs.ccOffset - vttCCs.presentationOffset;\n            }\n\n            cue.startTime += cueOffset - localTime;\n            cue.endTime += cueOffset - localTime;\n\n            // Create a unique hash id for a cue based on start/end times and text.\n            // This helps timeline-controller to avoid showing repeated captions.\n            cue.id = hash(cue.startTime) + hash(cue.endTime) + hash(cue.text);\n\n            // Fix encoding of special characters. TODO: Test with all sorts of weird characters.\n            cue.text = decodeURIComponent(escape(cue.text));\n            if (cue.endTime > 0) {\n              cues.push(cue);\n            }\n        };\n\n        parser.onparsingerror = function(e) {\n            parsingError = e;\n        };\n\n        parser.onflush = function() {\n            if (parsingError && errorCallBack) {\n                errorCallBack(parsingError);\n                return;\n            }\n            callBack(cues);\n        };\n\n        // Go through contents line by line.\n        vttLines.forEach(line => {\n            if (inHeader) {\n                // Look for X-TIMESTAMP-MAP in header.\n                if (startsWith(line, 'X-TIMESTAMP-MAP=')) {\n                    // Once found, no more are allowed anyway, so stop searching.\n                    inHeader = false;\n                    // Extract LOCAL and MPEGTS.\n                    line.substr(16).split(',').forEach(timestamp => {\n                        if (startsWith(timestamp, 'LOCAL:')) {\n                          cueTime = timestamp.substr(6);\n                        } else if (startsWith(timestamp, 'MPEGTS:')) {\n                          mpegTs = parseInt(timestamp.substr(7));\n                        }\n                    });\n                    try {\n                        // Calculate subtitle offset in milliseconds.\n                        // If sync PTS is less than zero, we have a 33-bit wraparound, which is fixed by adding 2^33 = 8589934592.\n                        syncPTS = syncPTS < 0 ? syncPTS + 8589934592 : syncPTS;\n                        // Adjust MPEGTS by sync PTS.\n                        mpegTs -= syncPTS;\n                        // Convert cue time to seconds\n                        localTime = cueString2millis(cueTime) / 1000;\n                        // Convert MPEGTS to seconds from 90kHz.\n                        presentationTime = mpegTs / 90000;\n\n                        if (localTime === -1) {\n                            parsingError = new Error(`Malformed X-TIMESTAMP-MAP: ${line}`);\n                        }\n                    }\n                    catch(e) {\n                        parsingError = new Error(`Malformed X-TIMESTAMP-MAP: ${line}`);\n                    }\n                    // Return without parsing X-TIMESTAMP-MAP line.\n                    return;\n                } else if (line === '') {\n                  inHeader = false;\n                }\n            }\n            // Parse line by default.\n            parser.parse(line+'\\n');\n        });\n\n        parser.flush();\n    }\n};\n\n\nmodule.exports = WebVTTParser;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/webvtt-parser.js","/**\n * XHR based logger\n*/\n\nimport {logger} from '../utils/logger';\n\nclass XhrLoader {\n\n  constructor(config) {\n    if (config && config.xhrSetup) {\n      this.xhrSetup = config.xhrSetup;\n    }\n  }\n\n  destroy() {\n    this.abort();\n    this.loader = null;\n  }\n\n  abort() {\n    var loader = this.loader;\n    if (loader && loader.readyState !== 4) {\n      this.stats.aborted = true;\n      loader.abort();\n    }\n\n    window.clearTimeout(this.requestTimeout);\n    this.requestTimeout = null;\n    window.clearTimeout(this.retryTimeout);\n    this.retryTimeout = null;\n  }\n\n  load(context, config, callbacks) {\n    this.context = context;\n    this.config = config;\n    this.callbacks = callbacks;\n    this.stats = {trequest: performance.now(), retry: 0};\n    this.retryDelay = config.retryDelay;\n    this.loadInternal();\n  }\n\n  loadInternal() {\n    var xhr, context = this.context;\n\n    if (typeof XDomainRequest !== 'undefined') {\n       xhr = this.loader = new XDomainRequest();\n    } else {\n       xhr = this.loader = new XMLHttpRequest();\n    }\n    let stats = this.stats;\n    stats.tfirst = 0;\n    stats.loaded = 0;\n    const xhrSetup = this.xhrSetup;\n\n    try {\n      if (xhrSetup) {\n        try {\n          xhrSetup(xhr, context.url);\n        } catch (e) {\n          // fix xhrSetup: (xhr, url) => {xhr.setRequestHeader(\"Content-Language\", \"test\");}\n          // not working, as xhr.setRequestHeader expects xhr.readyState === OPEN\n          xhr.open('GET', context.url, true);\n          xhrSetup(xhr, context.url);\n        }\n      }\n      if (!xhr.readyState) {\n        xhr.open('GET', context.url, true);\n      }\n    } catch (e) {\n      // IE11 throws an exception on xhr.open if attempting to access an HTTP resource over HTTPS\n      this.callbacks.onError({ code : xhr.status, text: e.message }, context);\n      return;\n    }\n\n    if (context.rangeEnd) {\n      xhr.setRequestHeader('Range','bytes=' + context.rangeStart + '-' + (context.rangeEnd-1));\n    }\n    xhr.onreadystatechange = this.readystatechange.bind(this);\n    xhr.onprogress = this.loadprogress.bind(this);\n    xhr.responseType = context.responseType;\n\n    // setup timeout before we perform request\n    this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), this.config.timeout);\n    xhr.send();\n  }\n\n  readystatechange(event) {\n    var xhr = event.currentTarget,\n        readyState = xhr.readyState,\n        stats = this.stats,\n        context = this.context,\n        config = this.config;\n\n    // don't proceed if xhr has been aborted\n    if (stats.aborted) {\n      return;\n    }\n\n    // >= HEADERS_RECEIVED\n    if (readyState >=2) {\n      // clear xhr timeout and rearm it if readyState less than 4\n      window.clearTimeout(this.requestTimeout);\n      if (stats.tfirst === 0) {\n        stats.tfirst = Math.max(performance.now(), stats.trequest);\n      }\n      if (readyState === 4) {\n        let status = xhr.status;\n        // http status between 200 to 299 are all successful\n        if (status >= 200 && status < 300)  {\n          stats.tload = Math.max(stats.tfirst,performance.now());\n          let data,len;\n          if (context.responseType === 'arraybuffer') {\n            data = xhr.response;\n            len = data.byteLength;\n          } else {\n            data = xhr.responseText;\n            len = data.length;\n          }\n          stats.loaded = stats.total = len;\n          let response = { url : xhr.responseURL, data : data };\n          this.callbacks.onSuccess(response, stats, context);\n        } else {\n            // if max nb of retries reached or if http status between 400 and 499 (such error cannot be recovered, retrying is useless), return error\n          if (stats.retry >= config.maxRetry || (status >= 400 && status < 499)) {\n            logger.error(`${status} while loading ${context.url}` );\n            this.callbacks.onError({ code : status, text : xhr.statusText}, context);\n          } else {\n            // retry\n            logger.warn(`${status} while loading ${context.url}, retrying in ${this.retryDelay}...`);\n            // aborts and resets internal state\n            this.destroy();\n            // schedule retry\n            this.retryTimeout = window.setTimeout(this.loadInternal.bind(this), this.retryDelay);\n            // set exponential backoff\n            this.retryDelay = Math.min(2 * this.retryDelay, config.maxRetryDelay);\n            stats.retry++;\n          }\n        }\n      } else {\n        // readyState >= 2 AND readyState !==4 (readyState = HEADERS_RECEIVED || LOADING) rearm timeout as xhr not finished yet\n        this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), config.timeout);\n      }\n    }\n  }\n\n  loadtimeout() {\n    logger.warn(`timeout while loading ${this.context.url}` );\n    this.callbacks.onTimeout(this.stats, this.context);\n  }\n\n  loadprogress(event) {\n    var stats = this.stats;\n    stats.loaded = event.loaded;\n    if (event.lengthComputable) {\n      stats.total = event.total;\n    }\n    let onProgress = this.callbacks.onProgress;\n    if (onProgress) {\n      // last args is to provide on progress data\n      onProgress(stats, this.context, null);\n    }\n  }\n}\n\nexport default XhrLoader;\n\n\n\n// WEBPACK FOOTER //\n// src/utils/xhr-loader.js","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"shaka-player\"), require(\"playkit-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"shaka-player\", \"playkit-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PlaykitJsDash\"] = factory(require(\"shaka-player\"), require(\"playkit-js\"));\n\telse\n\t\troot[\"PlaykitJsDash\"] = factory(root[\"shaka\"], root[\"Playkit\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition\n\n\n// WEBPACK FOOTER //\n// webpack:///dash/webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 37792bb50222e2c929fb\n\n\n// WEBPACK FOOTER //\n// webpack:/dash/webpack/bootstrap 37792bb50222e2c929fb","// @flow\nimport shaka from 'shaka-player';\nimport {registerMediaSourceAdapter, BaseMediaSourceAdapter} from 'playkit-js'\nimport {Track, VideoTrack, AudioTrack, TextTrack} from 'playkit-js'\n\n/**\n * Adapter of shaka lib for dash content\n * @classdesc\n */\nexport default class DashAdapter extends BaseMediaSourceAdapter {\n  /**\n   * The id of Adapter\n   * @member {string} id\n   * @static\n   * @public\n   */\n  static id = 'DashAdapter';\n  /**\n   * The adapter logger\n   * @member {any} _logger\n   * @private\n   * @static\n   */\n  static _logger = BaseMediaSourceAdapter.getLogger(DashAdapter.id);\n  /**\n   * The supported mime type by the dash adapter\n   * @member {string} _dashMimeType\n   * @static\n   * @private\n   */\n  static _dashMimeType = 'application/dash+xml';\n  /**\n   * The shaka player instance\n   * @member {any} _shaka\n   * @private\n   */\n  _shaka: any;\n  /**\n   * The load promise\n   * @member {Promise<Object>} - _loadPromise\n   * @type {Promise<Object>}\n   * @private\n   */\n  _loadPromise: ?Promise<Object>;\n\n  /**\n   * Checks if dash adapter can play a given mime type\n   * @function canPlayType\n   * @param {string} mimeType - The mime type to check\n   * @returns {boolean} - Whether the dash adapter can play a specific mime type\n   * @static\n   */\n  static canPlayType(mimeType: string): boolean {\n    let canPlayType = typeof mimeType === 'string' ? mimeType.toLowerCase() === DashAdapter._dashMimeType : false;\n    DashAdapter._logger.debug('canPlayType result for mimeType: ' + mimeType + ' is ' + canPlayType.toString());\n    return canPlayType;\n  }\n\n  /**\n   * Checks if the dash adapter is supported\n   * @function isSupported\n   * @returns {boolean} -  Whether dash is supported.\n   * @static\n   */\n  static isSupported(): boolean {\n    shaka.polyfill.installAll();\n    let isSupported = shaka.Player.isBrowserSupported();\n    DashAdapter._logger.debug('isSupported:' + isSupported);\n    return isSupported;\n  }\n\n  /**\n   * @constructor\n   * @param {HTMLVideoElement} videoElement - The video element which bind to the dash adapter\n   * @param {Object} source - The source object\n   * @param {Object} config - The media source adapter configuration\n   */\n  constructor(videoElement: HTMLVideoElement, source: Object, config: Object = {}) {\n    DashAdapter._logger.debug('Creating adapter. Shaka version: ' + shaka.Player.version);\n    super(videoElement, source, config);\n    this._shaka = new shaka.Player(videoElement);\n    this._shaka.configure(config);\n    this._addBindings();\n  }\n\n  /**\n   * Add the required bindings to shaka.\n   * @function _addBindings\n   * @private\n   * @returns {void}\n   */\n  _addBindings(): void {\n    this._shaka.addEventListener('adaptation', this._onAdaptation.bind(this));\n    this._shaka.addEventListener('error', this._onError.bind(this));\n  }\n\n  /**\n   * Remove the bindings to shaka.\n   * @function _removeBindings\n   * @private\n   * @returns {void}\n   */\n  _removeBindings(): void {\n    this._shaka.removeEventListener('adaptation', this._onAdaptation);\n    this._shaka.removeEventListener('error', this._onError);\n  }\n\n  /**\n   * Load the video source\n   * @function load\n   * @override\n   */\n  load(): Promise<Object> {\n    if (!this._loadPromise) {\n      this._loadPromise = new Promise((resolve, reject) => {\n        if (this._sourceObj && this._sourceObj.url) {\n          this._shaka.load(this._sourceObj.url).then(() => {\n            let data = {tracks: this._getParsedTracks()};\n            DashAdapter._logger.debug('The source has been loaded successfully');\n            resolve(data);\n          }).catch((error) => {\n            reject(error);\n            this._onError(error);\n          });\n        }\n      });\n    }\n    return this._loadPromise;\n  }\n\n  /**\n   * Destroying the dash adapter\n   * @function destroy\n   * @override\n   */\n  destroy(): void {\n    DashAdapter._logger.debug('destroy');\n    super.destroy();\n    this._loadPromise = null;\n    this._removeBindings();\n    this._shaka.destroy();\n  }\n\n  /**\n   * Get the original video tracks\n   * @function _getVideoTracks\n   * @returns {Array<Object>} - The original video tracks\n   * @private\n   */\n  _getVideoTracks(): Array<Object> {\n    let variantTracks = this._shaka.getVariantTracks();\n    let activeVariantTrack = variantTracks.filter((variantTrack) => {\n      return variantTrack.active;\n    })[0];\n    let videoTracks = variantTracks.filter((variantTrack) => {\n      return variantTrack.audioId === activeVariantTrack.audioId;\n    });\n    return videoTracks;\n  }\n\n  /**\n   * Get the original audio tracks\n   * @function _getAudioTracks\n   * @returns {Array<Object>} - The original audio tracks\n   * @private\n   */\n  _getAudioTracks(): Array<Object> {\n    let variantTracks = this._shaka.getVariantTracks();\n    let activeVariantTrack = variantTracks.filter((variantTrack) => {\n      return variantTrack.active;\n    })[0];\n    let audioTracks = variantTracks.filter((variantTrack) => {\n      return variantTrack.videoId === activeVariantTrack.videoId;\n    });\n    return audioTracks;\n  }\n\n  /**\n   * Get the parsed tracks\n   * @function _getParsedTracks\n   * @returns {Array<Track>} - The parsed tracks\n   * @private\n   */\n  _getParsedTracks(): Array<Track> {\n    let videoTracks = this._getParsedVideoTracks();\n    let audioTracks = this._getParsedAudioTracks();\n    let textTracks = this._getParsedTextTracks();\n    return videoTracks.concat(audioTracks).concat(textTracks);\n  }\n\n  /**\n   * Get the parsed video tracks\n   * @function _getParsedVideoTracks\n   * @returns {Array<VideoTrack>} - The parsed video tracks\n   * @private\n   */\n  _getParsedVideoTracks(): Array<VideoTrack> {\n    let videoTracks = this._getVideoTracks();\n    let parsedTracks = [];\n    if (videoTracks) {\n      for (let i = 0; i < videoTracks.length; i++) {\n        let settings = {\n          id: videoTracks[i].id,\n          bandwidth: videoTracks[i].bandwidth,\n          active: videoTracks[i].active,\n          label: videoTracks[i].label,\n          index: i\n        };\n        parsedTracks.push(new VideoTrack(settings));\n      }\n    }\n    return parsedTracks;\n  }\n\n  /**\n   * Get the parsed audio tracks\n   * @function _getParsedAudioTracks\n   * @returns {Array<AudioTrack>} - The parsed audio tracks\n   * @private\n   */\n  _getParsedAudioTracks(): Array<AudioTrack> {\n    let audioTracks = this._getAudioTracks();\n    let parsedTracks = [];\n    if (audioTracks) {\n      for (let i = 0; i < audioTracks.length; i++) {\n        let settings = {\n          id: audioTracks[i].id,\n          active: audioTracks[i].active,\n          label: audioTracks[i].label,\n          language: audioTracks[i].language,\n          index: i\n        };\n        parsedTracks.push(new AudioTrack(settings));\n      }\n    }\n    return parsedTracks;\n  }\n\n  /**\n   * Get the parsed text tracks\n   * @function _getParsedTextTracks\n   * @returns {Array<TextTrack>} - The parsed text tracks\n   * @private\n   */\n  _getParsedTextTracks(): Array<TextTrack> {\n    let textTracks = this._shaka.getTextTracks();\n    let parsedTracks = [];\n    if (textTracks) {\n      for (let i = 0; i < textTracks.length; i++) {\n        let settings = {\n          kind: textTracks[i].kind ? textTracks[i].kind + 's' : \"\",\n          active: textTracks[i].active,\n          label: textTracks[i].label,\n          language: textTracks[i].language,\n          index: i\n        };\n        parsedTracks.push(new TextTrack(settings));\n      }\n    }\n    return parsedTracks;\n  }\n\n  /**\n   * Select a video track\n   * @function selectVideoTrack\n   * @param {VideoTrack} videoTrack - the video track to select\n   * @returns {void}\n   * @public\n   */\n  selectVideoTrack(videoTrack: VideoTrack): void {\n    let videoTracks = this._getVideoTracks();\n    if ((videoTrack instanceof VideoTrack) && videoTracks) {\n      let selectedVideoTrack = videoTracks[videoTrack.index];\n      if (selectedVideoTrack) {\n        this._shaka.configure({abr:{enabled: false}});\n        if (!selectedVideoTrack.active) {\n          this._shaka.selectVariantTrack(videoTracks[videoTrack.index], true);\n          this._onTrackChanged(videoTrack);\n        }\n      }\n    }\n  }\n\n  /**\n   * Select an audio track\n   * @function selectAudioTrack\n   * @param {AudioTrack} audioTrack - the audio track to select\n   * @returns {void}\n   * @public\n   */\n  selectAudioTrack(audioTrack: AudioTrack): void {\n    if ((audioTrack instanceof AudioTrack) && !audioTrack.active) {\n      this._shaka.selectAudioLanguage(audioTrack.language);\n      this._onTrackChanged(audioTrack);\n    }\n  }\n\n  /**\n   * Select a text track\n   * @function selectTextTrack\n   * @param {TextTrack} textTrack - the track to select\n   * @returns {void}\n   * @public\n   */\n  selectTextTrack(textTrack: TextTrack): void {\n    if ((textTrack instanceof TextTrack) && !textTrack.active && (textTrack.kind === 'subtitles' || textTrack.kind === 'captions')) {\n      this._shaka.selectTextLanguage(textTrack.language);\n      this._onTrackChanged(textTrack);\n    }\n  }\n\n  /**\n   * Enables adaptive bitrate switching\n   * @function enableAdaptiveBitrate\n   * @returns {void}\n   * @public\n   */\n  enableAdaptiveBitrate(): void {\n    this._shaka.configure({abr:{enabled: true}});\n  }\n\n  /**\n   * An handler to shaka adaptation event\n   * @function _onAdaptation\n   * @returns {void}\n   * @private\n   */\n  _onAdaptation(): void {\n    let selectedVideoTrack = this._getParsedVideoTracks().filter(function (videoTrack) {\n      return videoTrack.active;\n    })[0];\n    this._onTrackChanged(selectedVideoTrack);\n  }\n\n  /**\n   * An handler to shaka error event\n   * @function _onError\n   * @param {any} error - the error\n   * @returns {void}\n   * @private\n   */\n  _onError(error: any): void {\n    DashAdapter._logger.error(error);\n  }\n\n  /**\n   * Getter for the src that the adapter plays on the video element.\n   * In case the adapter preformed a load it will return the manifest url.\n   * @public\n   * @returns {string} - The src url.\n   */\n  get src(): string {\n    if (this._loadPromise && this._sourceObj) {\n      return this._sourceObj.url;\n    }\n    return \"\";\n  }\n}\n\n// Register DashAdapter to the media source adapter manager\nif (DashAdapter.isSupported()) {\n  registerMediaSourceAdapter(DashAdapter);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./dash-adapter.js\n\n\n// WEBPACK FOOTER //\n// webpack:///dash/dash-adapter.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"shaka-player\",\"commonjs2\":\"shaka-player\",\"amd\":\"shaka-player\",\"root\":\"shaka\"}\n// module id = 1\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:/dash/external {\"commonjs\":\"shaka-player\",\"commonjs2\":\"shaka-player\",\"amd\":\"shaka-player\",\"root\":\"shaka\"}","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}\n// module id = 2\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:/dash/external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Bootstrap for the Google JS Library (Closure).\n *\n * In uncompiled mode base.js will write out Closure's deps file, unless the\n * global <code>CLOSURE_NO_DEPS</code> is set to true.  This allows projects to\n * include their own deps file(s) from different locations.\n *\n *\n * @provideGoog\n */\n\n\n/**\n * @define {boolean} Overridden to true by the compiler when --closure_pass\n *     or --mark_as_compiled is specified.\n */\nvar COMPILED = false;\n\n\n/**\n * Base namespace for the Closure library.  Checks to see goog is already\n * defined in the current scope before assigning to prevent clobbering if\n * base.js is loaded more than once.\n *\n * @const\n */\nvar goog = goog || {};\n\n\n/**\n * Reference to the global context.  In most cases this will be 'window'.\n */\ngoog.global = this;\n\n\n/**\n * A hook for overriding the define values in uncompiled mode.\n *\n * In uncompiled mode, {@code CLOSURE_UNCOMPILED_DEFINES} may be defined before\n * loading base.js.  If a key is defined in {@code CLOSURE_UNCOMPILED_DEFINES},\n * {@code goog.define} will use the value instead of the default value.  This\n * allows flags to be overwritten without compilation (this is normally\n * accomplished with the compiler's \"define\" flag).\n *\n * Example:\n * <pre>\n *   var CLOSURE_UNCOMPILED_DEFINES = {'goog.DEBUG': false};\n * </pre>\n *\n * @type {Object.<string, (string|number|boolean)>|undefined}\n */\ngoog.global.CLOSURE_UNCOMPILED_DEFINES;\n\n\n/**\n * A hook for overriding the define values in uncompiled or compiled mode,\n * like CLOSURE_UNCOMPILED_DEFINES but effective in compiled code.  In\n * uncompiled code CLOSURE_UNCOMPILED_DEFINES takes precedence.\n *\n * Also unlike CLOSURE_UNCOMPILED_DEFINES the values must be number, boolean or\n * string literals or the compiler will emit an error.\n *\n * While any @define value may be set, only those set with goog.define will be\n * effective for uncompiled code.\n *\n * Example:\n * <pre>\n *   var CLOSURE_DEFINES = {'goog.DEBUG': false};\n * </pre>\n *\n * @type {Object.<string, (string|number|boolean)>|undefined}\n */\ngoog.global.CLOSURE_DEFINES;\n\n\n/**\n * Returns true if the specified value is not undefined.\n * WARNING: Do not use this to test if an object has a property. Use the in\n * operator instead.\n *\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is defined.\n */\ngoog.isDef = function(val) {\n  // void 0 always evaluates to undefined and hence we do not need to depend on\n  // the definition of the global variable named 'undefined'.\n  return val !== void 0;\n};\n\n\n/**\n * Builds an object structure for the provided namespace path, ensuring that\n * names that already exist are not overwritten. For example:\n * \"a.b.c\" -> a = {};a.b={};a.b.c={};\n * Used by goog.provide and goog.exportSymbol.\n * @param {string} name name of the object that this file defines.\n * @param {*=} opt_object the object to expose at the end of the path.\n * @param {Object=} opt_objectToExportTo The object to add the path to; default\n *     is |goog.global|.\n * @private\n */\ngoog.exportPath_ = function(name, opt_object, opt_objectToExportTo) {\n  var parts = name.split('.');\n  var cur = opt_objectToExportTo || goog.global;\n\n  // Internet Explorer exhibits strange behavior when throwing errors from\n  // methods externed in this manner.  See the testExportSymbolExceptions in\n  // base_test.html for an example.\n  if (!(parts[0] in cur) && cur.execScript) {\n    cur.execScript('var ' + parts[0]);\n  }\n\n  // Certain browsers cannot parse code in the form for((a in b); c;);\n  // This pattern is produced by the JSCompiler when it collapses the\n  // statement above into the conditional loop below. To prevent this from\n  // happening, use a for-loop and reserve the init logic as below.\n\n  // Parentheses added to eliminate strict JS warning in Firefox.\n  for (var part; parts.length && (part = parts.shift());) {\n    if (!parts.length && goog.isDef(opt_object)) {\n      // last part and we have an object; use it\n      cur[part] = opt_object;\n    } else if (cur[part]) {\n      cur = cur[part];\n    } else {\n      cur = cur[part] = {};\n    }\n  }\n};\n\n\n/**\n * Defines a named value. In uncompiled mode, the value is retreived from\n * CLOSURE_DEFINES or CLOSURE_UNCOMPILED_DEFINES if the object is defined and\n * has the property specified, and otherwise used the defined defaultValue.\n * When compiled, the default can be overridden using compiler command-line\n * options.\n *\n * @param {string} name The distinguished name to provide.\n * @param {string|number|boolean} defaultValue\n */\ngoog.define = function(name, defaultValue) {\n  var value = defaultValue;\n  if (!COMPILED) {\n    if (goog.global.CLOSURE_UNCOMPILED_DEFINES &&\n        Object.prototype.hasOwnProperty.call(\n            goog.global.CLOSURE_UNCOMPILED_DEFINES, name)) {\n      value = goog.global.CLOSURE_UNCOMPILED_DEFINES[name];\n    } else if (goog.global.CLOSURE_DEFINES &&\n        Object.prototype.hasOwnProperty.call(\n            goog.global.CLOSURE_DEFINES, name)) {\n      value = goog.global.CLOSURE_DEFINES[name];\n    }\n  }\n  goog.exportPath_(name, value);\n};\n\n\n/**\n * @define {boolean} DEBUG is provided as a convenience so that debugging code\n * that should not be included in a production js_binary can be easily stripped\n * by specifying --define goog.DEBUG=false to the JSCompiler. For example, most\n * toString() methods should be declared inside an \"if (goog.DEBUG)\" conditional\n * because they are generally used for debugging purposes and it is difficult\n * for the JSCompiler to statically determine whether they are used.\n */\ngoog.DEBUG = true;\n\n\n/**\n * @define {string} LOCALE defines the locale being used for compilation. It is\n * used to select locale specific data to be compiled in js binary. BUILD rule\n * can specify this value by \"--define goog.LOCALE=<locale_name>\" as JSCompiler\n * option.\n *\n * Take into account that the locale code format is important. You should use\n * the canonical Unicode format with hyphen as a delimiter. Language must be\n * lowercase, Language Script - Capitalized, Region - UPPERCASE.\n * There are few examples: pt-BR, en, en-US, sr-Latin-BO, zh-Hans-CN.\n *\n * See more info about locale codes here:\n * http://www.unicode.org/reports/tr35/#Unicode_Language_and_Locale_Identifiers\n *\n * For language codes you should use values defined by ISO 693-1. See it here\n * http://www.w3.org/WAI/ER/IG/ert/iso639.htm. There is only one exception from\n * this rule: the Hebrew language. For legacy reasons the old code (iw) should\n * be used instead of the new code (he), see http://wiki/Main/IIISynonyms.\n */\ngoog.define('goog.LOCALE', 'en');  // default to en\n\n\n/**\n * @define {boolean} Whether this code is running on trusted sites.\n *\n * On untrusted sites, several native functions can be defined or overridden by\n * external libraries like Prototype, Datejs, and JQuery and setting this flag\n * to false forces closure to use its own implementations when possible.\n *\n * If your JavaScript can be loaded by a third party site and you are wary about\n * relying on non-standard implementations, specify\n * \"--define goog.TRUSTED_SITE=false\" to the JSCompiler.\n */\ngoog.define('goog.TRUSTED_SITE', true);\n\n\n/**\n * @define {boolean} Whether a project is expected to be running in strict mode.\n *\n * This define can be used to trigger alternate implementations compatible with\n * running in EcmaScript Strict mode or warn about unavailable functionality.\n * See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/Strict_mode\n */\ngoog.define('goog.STRICT_MODE_COMPATIBLE', false);\n\n\n/**\n * Creates object stubs for a namespace.  The presence of one or more\n * goog.provide() calls indicate that the file defines the given\n * objects/namespaces.  Provided objects must not be null or undefined.\n * Build tools also scan for provide/require statements\n * to discern dependencies, build dependency files (see deps.js), etc.\n * @see goog.require\n * @param {string} name Namespace provided by this file in the form\n *     \"goog.package.part\".\n */\ngoog.provide = function(name) {\n  if (!COMPILED) {\n    // Ensure that the same namespace isn't provided twice.\n    // A goog.module/goog.provide maps a goog.require to a specific file\n    if (goog.isProvided_(name)) {\n      throw Error('Namespace \"' + name + '\" already declared.');\n    }\n    delete goog.implicitNamespaces_[name];\n\n    var namespace = name;\n    while ((namespace = namespace.substring(0, namespace.lastIndexOf('.')))) {\n      if (goog.getObjectByName(namespace)) {\n        break;\n      }\n      goog.implicitNamespaces_[namespace] = true;\n    }\n  }\n\n  goog.exportPath_(name);\n};\n\n\n/**\n * Forward declares a symbol. This is an indication to the compiler that the\n * symbol may be used in the source yet is not required and may not be provided\n * in compilation.\n *\n * The most common usage of forward declaration is code that takes a type as a\n * function parameter but does not need to require it. By forward declaring\n * instead of requiring, no hard dependency is made, and (if not required\n * elsewhere) the namespace may never be required and thus, not be pulled\n * into the JavaScript binary. If it is required elsewhere, it will be type\n * checked as normal.\n *\n *\n * @param {string} name The namespace to forward declare in the form of\n *     \"goog.package.part\".\n */\ngoog.forwardDeclare = function(name) {};\n\n\nif (!COMPILED) {\n\n  /**\n   * Check if the given name has been goog.provided. This will return false for\n   * names that are available only as implicit namespaces.\n   * @param {string} name name of the object to look for.\n   * @return {boolean} Whether the name has been provided.\n   * @private\n   */\n  goog.isProvided_ = function(name) {\n    return (!goog.implicitNamespaces_[name] &&\n        goog.isDefAndNotNull(goog.getObjectByName(name)));\n  };\n\n  /**\n   * Namespaces implicitly defined by goog.provide. For example,\n   * goog.provide('goog.events.Event') implicitly declares that 'goog' and\n   * 'goog.events' must be namespaces.\n   *\n   * @type {Object.<string, (boolean|undefined)>}\n   * @private\n   */\n  goog.implicitNamespaces_ = {};\n}\n\n\n/**\n * Returns an object based on its fully qualified external name.  The object\n * is not found if null or undefined.  If you are using a compilation pass that\n * renames property names beware that using this function will not find renamed\n * properties.\n *\n * @param {string} name The fully qualified name.\n * @param {Object=} opt_obj The object within which to look; default is\n *     |goog.global|.\n * @return {?} The value (object or primitive) or, if not found, null.\n */\ngoog.getObjectByName = function(name, opt_obj) {\n  var parts = name.split('.');\n  var cur = opt_obj || goog.global;\n  for (var part; part = parts.shift(); ) {\n    if (goog.isDefAndNotNull(cur[part])) {\n      cur = cur[part];\n    } else {\n      return null;\n    }\n  }\n  return cur;\n};\n\n\n/**\n * Globalizes a whole namespace, such as goog or goog.lang.\n *\n * @param {Object} obj The namespace to globalize.\n * @param {Object=} opt_global The object to add the properties to.\n * @deprecated Properties may be explicitly exported to the global scope, but\n *     this should no longer be done in bulk.\n */\ngoog.globalize = function(obj, opt_global) {\n  var global = opt_global || goog.global;\n  for (var x in obj) {\n    global[x] = obj[x];\n  }\n};\n\n\n/**\n * Adds a dependency from a file to the files it requires.\n * @param {string} relPath The path to the js file.\n * @param {Array} provides An array of strings with the names of the objects\n *                         this file provides.\n * @param {Array} requires An array of strings with the names of the objects\n *                         this file requires.\n */\ngoog.addDependency = function(relPath, provides, requires) {\n  if (goog.DEPENDENCIES_ENABLED) {\n    var provide, require;\n    var path = relPath.replace(/\\\\/g, '/');\n    var deps = goog.dependencies_;\n    for (var i = 0; provide = provides[i]; i++) {\n      deps.nameToPath[provide] = path;\n    }\n    for (var j = 0; require = requires[j]; j++) {\n      if (!(path in deps.requires)) {\n        deps.requires[path] = {};\n      }\n      deps.requires[path][require] = true;\n    }\n  }\n};\n\n\n\n\n// NOTE(nnaze): The debug DOM loader was included in base.js as an original way\n// to do \"debug-mode\" development.  The dependency system can sometimes be\n// confusing, as can the debug DOM loader's asynchronous nature.\n//\n// With the DOM loader, a call to goog.require() is not blocking -- the script\n// will not load until some point after the current script.  If a namespace is\n// needed at runtime, it needs to be defined in a previous script, or loaded via\n// require() with its registered dependencies.\n// User-defined namespaces may need their own deps file.  See http://go/js_deps,\n// http://go/genjsdeps, or, externally, DepsWriter.\n// https://developers.google.com/closure/library/docs/depswriter\n//\n// Because of legacy clients, the DOM loader can't be easily removed from\n// base.js.  Work is being done to make it disableable or replaceable for\n// different environments (DOM-less JavaScript interpreters like Rhino or V8,\n// for example). See bootstrap/ for more information.\n\n\n/**\n * @define {boolean} Whether to enable the debug loader.\n *\n * If enabled, a call to goog.require() will attempt to load the namespace by\n * appending a script tag to the DOM (if the namespace has been registered).\n *\n * If disabled, goog.require() will simply assert that the namespace has been\n * provided (and depend on the fact that some outside tool correctly ordered\n * the script).\n */\ngoog.define('goog.ENABLE_DEBUG_LOADER', true);\n\n\n/**\n * @param {string} msg\n * @private\n */\ngoog.logToConsole_ = function(msg) {\n  if (goog.global.console) {\n    goog.global.console['error'](msg);\n  }\n};\n\n\n/**\n * Implements a system for the dynamic resolution of dependencies that works in\n * parallel with the BUILD system. Note that all calls to goog.require will be\n * stripped by the JSCompiler when the --closure_pass option is used.\n * @see goog.provide\n * @param {string} name Namespace to include (as was given in goog.provide()) in\n *     the form \"goog.package.part\".\n * @return {?} If called within a goog.module file, the associated namespace or\n *     module otherwise null.\n */\ngoog.require = function(name) {\n\n  // If the object already exists we do not need do do anything.\n  if (!COMPILED) {\n    if (goog.isProvided_(name)) {\n      return null;\n    }\n\n    if (goog.ENABLE_DEBUG_LOADER) {\n      var path = goog.getPathFromDeps_(name);\n      if (path) {\n        goog.included_[path] = true;\n        goog.writeScripts_();\n        return null;\n      }\n    }\n\n    var errorMessage = 'goog.require could not find: ' + name;\n    goog.logToConsole_(errorMessage);\n\n    throw Error(errorMessage);\n  }\n};\n\n\n/**\n * Path for included scripts.\n * @type {string}\n */\ngoog.basePath = '';\n\n\n/**\n * A hook for overriding the base path.\n * @type {string|undefined}\n */\ngoog.global.CLOSURE_BASE_PATH;\n\n\n/**\n * Whether to load Closure's deps file automatically.\n * Shaka sets this to true since we are placing deps.js in a non-standard\n * location.  Running Shaka in uncompiled mode will require loading deps.js\n * explicitly.\n * @type {boolean|undefined}\n */\ngoog.global.CLOSURE_NO_DEPS = true;\n\n\n/**\n * A function to import a single script. This is meant to be overridden when\n * Closure is being run in non-HTML contexts, such as web workers. It's defined\n * in the global scope so that it can be set before base.js is loaded, which\n * allows deps.js to be imported properly.\n *\n * The function is passed the script source, which is a relative URI. It should\n * return true if the script was imported, false otherwise.\n * @type {(function(string): boolean)|undefined}\n */\ngoog.global.CLOSURE_IMPORT_SCRIPT;\n\n\n/**\n * True if goog.dependencies_ is available.\n * @const {boolean}\n */\ngoog.DEPENDENCIES_ENABLED = !COMPILED && goog.ENABLE_DEBUG_LOADER;\n\n\nif (goog.DEPENDENCIES_ENABLED) {\n  /**\n   * Object used to keep track of urls that have already been added. This record\n   * allows the prevention of circular dependencies.\n   * @type {Object}\n   * @private\n   */\n  goog.included_ = {};\n\n\n  /**\n   * This object is used to keep track of dependencies and other data that is\n   * used for loading scripts.\n   * @private\n   * @type {Object}\n   */\n  goog.dependencies_ = {\n    nameToPath: {}, // many to 1\n    requires: {}, // 1 to many\n    // Used when resolving dependencies to prevent us from visiting file twice.\n    visited: {},\n    written: {} // Used to keep track of script files we have written.\n  };\n\n\n  /**\n   * Tries to detect whether is in the context of an HTML document.\n   * @return {boolean} True if it looks like HTML document.\n   * @private\n   */\n  goog.inHtmlDocument_ = function() {\n    var doc = goog.global.document;\n    return typeof doc != 'undefined' &&\n           'write' in doc;  // XULDocument misses write.\n  };\n\n\n  /**\n   * Tries to detect the base path of base.js script that bootstraps Closure.\n   * @private\n   */\n  goog.findBasePath_ = function() {\n    if (goog.global.CLOSURE_BASE_PATH) {\n      goog.basePath = goog.global.CLOSURE_BASE_PATH;\n      return;\n    } else if (!goog.inHtmlDocument_()) {\n      return;\n    }\n    var doc = goog.global.document;\n    var scripts = doc.getElementsByTagName('script');\n    // Search backwards since the current script is in almost all cases the one\n    // that has base.js.\n    for (var i = scripts.length - 1; i >= 0; --i) {\n      var src = scripts[i].src;\n      var qmark = src.lastIndexOf('?');\n      var l = qmark == -1 ? src.length : qmark;\n      if (src.substr(l - 7, 7) == 'base.js') {\n        goog.basePath = src.substr(0, l - 7);\n        return;\n      }\n    }\n  };\n\n\n  /**\n   * Imports a script if, and only if, that script hasn't already been imported.\n   * (Must be called at execution time)\n   * @param {string} src Script source.\n   * @param {string=} opt_sourceText The optionally source text to evaluate\n   * @private\n   */\n  goog.importScript_ = function(src, opt_sourceText) {\n    var importScript = goog.global.CLOSURE_IMPORT_SCRIPT ||\n        goog.writeScriptTag_;\n    if (importScript(src, opt_sourceText)) {\n      goog.dependencies_.written[src] = true;\n    }\n  };\n\n\n  /**\n   * The default implementation of the import function. Writes a script tag to\n   * import the script.\n   *\n   * @param {string} src The script url.\n   * @param {string=} opt_sourceText The optionally source text to evaluate\n   * @return {boolean} True if the script was imported, false otherwise.\n   * @private\n   */\n  goog.writeScriptTag_ = function(src, opt_sourceText) {\n    if (goog.inHtmlDocument_()) {\n      var doc = goog.global.document;\n\n      // If the user tries to require a new symbol after document load,\n      // something has gone terribly wrong. Doing a document.write would\n      // wipe out the page.\n      if (doc.readyState == 'complete') {\n        // Certain test frameworks load base.js multiple times, which tries\n        // to write deps.js each time. If that happens, just fail silently.\n        // These frameworks wipe the page between each load of base.js, so this\n        // is OK.\n        var isDeps = /\\bdeps.js$/.test(src);\n        if (isDeps) {\n          return false;\n        } else {\n          throw Error('Cannot write \"' + src + '\" after document load');\n        }\n      }\n\n      if (opt_sourceText === undefined) {\n        doc.write(\n            '<script type=\"text/javascript\" src=\"' +\n                src + '\"></' + 'script>');\n      } else {\n        doc.write(\n            '<script type=\"text/javascript\">' +\n              opt_sourceText + '</' + 'script>');\n      }\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n\n  /**\n   * Resolves dependencies based on the dependencies added using addDependency\n   * and calls importScript_ in the correct order.\n   * @private\n   */\n  goog.writeScripts_ = function() {\n    // The scripts we need to write this time.\n    var scripts = [];\n    var seenScript = {};\n    var deps = goog.dependencies_;\n\n    function visitNode(path) {\n      if (path in deps.written) {\n        return;\n      }\n\n      // We have already visited this one. We can get here if we have cyclic\n      // dependencies.\n      if (path in deps.visited) {\n        if (!(path in seenScript)) {\n          seenScript[path] = true;\n          scripts.push(path);\n        }\n        return;\n      }\n\n      deps.visited[path] = true;\n\n      if (path in deps.requires) {\n        for (var requireName in deps.requires[path]) {\n          // If the required name is defined, we assume that it was already\n          // bootstrapped by other means.\n          if (!goog.isProvided_(requireName)) {\n            if (requireName in deps.nameToPath) {\n              visitNode(deps.nameToPath[requireName]);\n            } else {\n              throw Error('Undefined nameToPath for ' + requireName);\n            }\n          }\n        }\n      }\n\n      if (!(path in seenScript)) {\n        seenScript[path] = true;\n        scripts.push(path);\n      }\n    }\n\n    for (var path in goog.included_) {\n      if (!deps.written[path]) {\n        visitNode(path);\n      }\n    }\n\n    // record that we are going to load all these scripts.\n    for (var i = 0; i < scripts.length; i++) {\n      var path = scripts[i];\n      goog.dependencies_.written[path] = true;\n    }\n\n    for (var i = 0; i < scripts.length; i++) {\n      var path = scripts[i];\n      if (path) {\n        goog.importScript_(goog.basePath + path);\n      }\n    }\n  };\n\n\n  /**\n   * Looks at the dependency rules and tries to determine the script file that\n   * fulfills a particular rule.\n   * @param {string} rule In the form goog.namespace.Class or project.script.\n   * @return {?string} Url corresponding to the rule, or null.\n   * @private\n   */\n  goog.getPathFromDeps_ = function(rule) {\n    if (rule in goog.dependencies_.nameToPath) {\n      return goog.dependencies_.nameToPath[rule];\n    } else {\n      return null;\n    }\n  };\n\n  goog.findBasePath_();\n\n  // Allow projects to manage the deps files themselves.\n  if (!goog.global.CLOSURE_NO_DEPS) {\n    goog.importScript_(goog.basePath + 'deps.js');\n  }\n}\n\n\n\n//==============================================================================\n// Language Enhancements\n//==============================================================================\n\n\n/**\n * Returns true if the specified value is defined and not null.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is defined and not null.\n */\ngoog.isDefAndNotNull = function(val) {\n  // Note that undefined == null.\n  return val != null;\n};\n\n\n/**\n * Returns true if the specified value is a string.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is a string.\n */\ngoog.isString = function(val) {\n  return typeof val == 'string';\n};\n\n\n/**\n * Exposes an unobfuscated global namespace path for the given object.\n * Note that fields of the exported object *will* be obfuscated, unless they are\n * exported in turn via this function or goog.exportProperty.\n *\n * Also handy for making public items that are defined in anonymous closures.\n *\n * ex. goog.exportSymbol('public.path.Foo', Foo);\n *\n * ex. goog.exportSymbol('public.path.Foo.staticFunction', Foo.staticFunction);\n *     public.path.Foo.staticFunction();\n *\n * ex. goog.exportSymbol('public.path.Foo.prototype.myMethod',\n *                       Foo.prototype.myMethod);\n *     new public.path.Foo().myMethod();\n *\n * @param {string} publicPath Unobfuscated name to export.\n * @param {*} object Object the name should point to.\n * @param {Object=} opt_objectToExportTo The object to add the path to; default\n *     is goog.global.\n */\ngoog.exportSymbol = function(publicPath, object, opt_objectToExportTo) {\n  goog.exportPath_(publicPath, object, opt_objectToExportTo);\n};\n\n\n/**\n * Exports a property unobfuscated into the object's namespace.\n * ex. goog.exportProperty(Foo, 'staticFunction', Foo.staticFunction);\n * ex. goog.exportProperty(Foo.prototype, 'myMethod', Foo.prototype.myMethod);\n * @param {Object} object Object whose static property is being exported.\n * @param {string} publicName Unobfuscated name to export.\n * @param {*} symbol Object the name should point to.\n */\ngoog.exportProperty = function(object, publicName, symbol) {\n  object[publicName] = symbol;\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * Usage:\n * <pre>\n * function ParentClass(a, b) { }\n * ParentClass.prototype.foo = function(a) { };\n *\n * function ChildClass(a, b, c) {\n *   ChildClass.base(this, 'constructor', a, b);\n * }\n * goog.inherits(ChildClass, ParentClass);\n *\n * var child = new ChildClass('a', 'b', 'see');\n * child.foo(); // This works.\n * </pre>\n *\n * @param {Function} childCtor Child class.\n * @param {Function} parentCtor Parent class.\n */\ngoog.inherits = function(childCtor, parentCtor) {\n  /** @constructor */\n  function tempCtor() {}\n  tempCtor.prototype = parentCtor.prototype;\n  childCtor.superClass_ = parentCtor.prototype;\n  childCtor.prototype = new tempCtor();\n  /** @override */\n  childCtor.prototype.constructor = childCtor;\n\n  /**\n   * Calls superclass constructor/method.\n   *\n   * This function is only available if you use goog.inherits to\n   * express inheritance relationships between classes.\n   *\n   * NOTE: This is a replacement for goog.base and for superClass_\n   * property defined in childCtor.\n   *\n   * @param {!Object} me Should always be \"this\".\n   * @param {string} methodName The method name to call. Calling\n   *     superclass constructor can be done with the special string\n   *     'constructor'.\n   * @param {...*} var_args The arguments to pass to superclass\n   *     method/constructor.\n   * @return {*} The return value of the superclass method/constructor.\n   */\n  childCtor.base = function(me, methodName, var_args) {\n    var args = Array.prototype.slice.call(arguments, 2);\n    return parentCtor.prototype[methodName].apply(me, args);\n  };\n};\n\n\n/*\n * To support uncompiled, strict mode bundles that use eval to divide source\n * like so:\n *    eval('someSource;//# sourceUrl sourcefile.js');\n * We need to export the globally defined symbols \"goog\" and \"COMPILED\".\n * Exporting \"goog\" breaks the compiler optimizations, so we required that\n * be defined externally.\n * NOTE: We don't use goog.exportSymbol here because we don't want to trigger\n * extern generation when that compiler option is enabled.\n */\nif (!COMPILED) {\n  goog.global['COMPILED'] = COMPILED;\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/third_party/closure/goog/base.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.cast.CastProxy');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.cast.CastSender');\ngoog.require('shaka.cast.CastUtils');\ngoog.require('shaka.log');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.EventManager');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.FakeEventTarget');\ngoog.require('shaka.util.IDestroyable');\n\n\n\n/**\n * A proxy to switch between local and remote playback for Chromecast in a way\n * that is transparent to the app's controls.\n *\n * @constructor\n * @struct\n * @param {!HTMLMediaElement} video The local video element associated with the\n *   local Player instance.\n * @param {!shaka.Player} player A local Player instance.\n * @param {string} receiverAppId The ID of the cast receiver application.\n * @implements {shaka.util.IDestroyable}\n * @extends {shaka.util.FakeEventTarget}\n * @export\n */\nshaka.cast.CastProxy = function(video, player, receiverAppId) {\n  shaka.util.FakeEventTarget.call(this);\n\n  /** @private {HTMLMediaElement} */\n  this.localVideo_ = video;\n\n  /** @private {shaka.Player} */\n  this.localPlayer_ = player;\n\n  /** @private {Object} */\n  this.videoProxy_ = null;\n\n  /** @private {Object} */\n  this.playerProxy_ = null;\n\n  /** @private {shaka.util.FakeEventTarget} */\n  this.videoEventTarget_ = null;\n\n  /** @private {shaka.util.FakeEventTarget} */\n  this.playerEventTarget_ = null;\n\n  /** @private {shaka.util.EventManager} */\n  this.eventManager_ = null;\n\n  /** @private {shaka.cast.CastSender} */\n  this.sender_ = new shaka.cast.CastSender(\n      receiverAppId,\n      this.onCastStatusChanged_.bind(this),\n      this.onRemoteEvent_.bind(this),\n      this.onResumeLocal_.bind(this),\n      this.getInitState_.bind(this));\n\n  this.init_();\n};\ngoog.inherits(shaka.cast.CastProxy, shaka.util.FakeEventTarget);\n\n\n/**\n * Destroys the proxy and the underlying local Player.\n *\n * @param {boolean=} opt_forceDisconnect If true, force the receiver app to shut\n *   down by disconnecting.  Does nothing if not connected.\n * @override\n * @export\n */\nshaka.cast.CastProxy.prototype.destroy = function(opt_forceDisconnect) {\n  if (opt_forceDisconnect && this.sender_) {\n    this.sender_.forceDisconnect();\n  }\n\n  var async = [\n    this.eventManager_ ? this.eventManager_.destroy() : null,\n    this.localPlayer_ ? this.localPlayer_.destroy() : null,\n    this.sender_ ? this.sender_.destroy() : null\n  ];\n\n  this.localVideo_ = null;\n  this.localPlayer_ = null;\n  this.videoProxy_ = null;\n  this.playerProxy_ = null;\n  this.eventManager_ = null;\n  this.sender_ = null;\n\n  return Promise.all(async);\n};\n\n\n/**\n * @event shaka.cast.CastProxy.CastStatusChangedEvent\n * @description Fired when cast status changes.  The status change will be\n *   reflected in canCast() and isCasting().\n * @property {string} type\n *   'caststatuschanged'\n * @exportDoc\n */\n\n\n/**\n * Get a proxy for the video element that delegates to local and remote video\n * elements as appropriate.\n *\n * @suppress {invalidCasts} to cast proxy Objects to unrelated types\n * @return {HTMLMediaElement}\n * @export\n */\nshaka.cast.CastProxy.prototype.getVideo = function() {\n  return /** @type {HTMLMediaElement} */(this.videoProxy_);\n};\n\n\n/**\n * Get a proxy for the Player that delegates to local and remote Player objects\n * as appropriate.\n *\n * @suppress {invalidCasts} to cast proxy Objects to unrelated types\n * @return {shaka.Player}\n * @export\n */\nshaka.cast.CastProxy.prototype.getPlayer = function() {\n  return /** @type {shaka.Player} */(this.playerProxy_);\n};\n\n\n/**\n * @return {boolean} True if the cast API is available and there are receivers.\n * @export\n */\nshaka.cast.CastProxy.prototype.canCast = function() {\n  return this.sender_ ?\n      this.sender_.apiReady() && this.sender_.hasReceivers() :\n      false;\n};\n\n\n/**\n * @return {boolean} True if we are currently casting.\n * @export\n */\nshaka.cast.CastProxy.prototype.isCasting = function() {\n  return this.sender_ ? this.sender_.isCasting() : false;\n};\n\n\n/**\n * @return {string} The name of the Cast receiver device, if isCasting().\n * @export\n */\nshaka.cast.CastProxy.prototype.receiverName = function() {\n  return this.sender_ ? this.sender_.receiverName() : '';\n};\n\n\n/**\n * @return {!Promise} Resolved when connected to a receiver.  Rejected if the\n *   connection fails or is canceled by the user.\n * @export\n */\nshaka.cast.CastProxy.prototype.cast = function() {\n  var initState = this.getInitState_();\n\n  // TODO: transfer manually-selected tracks?\n  // TODO: transfer side-loaded text tracks?\n\n  return this.sender_.cast(initState).then(function() {\n    // Unload the local manifest when casting succeeds.\n    return this.localPlayer_.unload();\n  }.bind(this));\n};\n\n\n/**\n * Set application-specific data.\n *\n * @param {Object} appData Application-specific data to relay to the receiver.\n * @export\n */\nshaka.cast.CastProxy.prototype.setAppData = function(appData) {\n  this.sender_.setAppData(appData);\n};\n\n\n/**\n * Show a dialog where user can choose to disconnect from the cast connection.\n * @export\n */\nshaka.cast.CastProxy.prototype.suggestDisconnect = function() {\n  this.sender_.showDisconnectDialog();\n};\n\n\n/**\n * Force the receiver app to shut down by disconnecting.\n * @export\n */\nshaka.cast.CastProxy.prototype.forceDisconnect = function() {\n  this.sender_.forceDisconnect();\n};\n\n\n/**\n * Initialize the Proxies and the Cast sender.\n * @private\n */\nshaka.cast.CastProxy.prototype.init_ = function() {\n  this.sender_.init();\n\n  this.eventManager_ = new shaka.util.EventManager();\n\n  shaka.cast.CastUtils.VideoEvents.forEach(function(name) {\n    this.eventManager_.listen(this.localVideo_, name,\n        this.videoProxyLocalEvent_.bind(this));\n  }.bind(this));\n\n  shaka.cast.CastUtils.PlayerEvents.forEach(function(name) {\n    this.eventManager_.listen(this.localPlayer_, name,\n        this.playerProxyLocalEvent_.bind(this));\n  }.bind(this));\n\n  // We would like to use Proxy here, but it is not supported on IE11 or Safari.\n  this.videoProxy_ = {};\n  for (var k in this.localVideo_) {\n    Object.defineProperty(this.videoProxy_, k, {\n      configurable: false,\n      enumerable: true,\n      get: this.videoProxyGet_.bind(this, k),\n      set: this.videoProxySet_.bind(this, k)\n    });\n  }\n\n  this.playerProxy_ = {};\n  for (var k in /** @type {Object} */(this.localPlayer_)) {\n    Object.defineProperty(this.playerProxy_, k, {\n      configurable: false,\n      enumerable: true,\n      get: this.playerProxyGet_.bind(this, k)\n    });\n  }\n\n  this.videoEventTarget_ = new shaka.util.FakeEventTarget();\n  this.videoEventTarget_.dispatchTarget =\n      /** @type {EventTarget} */(this.videoProxy_);\n\n  this.playerEventTarget_ = new shaka.util.FakeEventTarget();\n  this.playerEventTarget_.dispatchTarget =\n      /** @type {EventTarget} */(this.playerProxy_);\n};\n\n\n/**\n * @return {shaka.cast.CastUtils.InitStateType} initState Video and player state\n *   to be sent to the receiver.\n * @private\n */\nshaka.cast.CastProxy.prototype.getInitState_ = function() {\n  var initState = {\n    'video': {},\n    'player': {},\n    'playerAfterLoad': {},\n    'manifest': this.localPlayer_.getManifestUri(),\n    'startTime': null\n  };\n\n  // Pause local playback before capturing state.\n  this.localVideo_.pause();\n\n  shaka.cast.CastUtils.VideoInitStateAttributes.forEach(function(name) {\n    initState['video'][name] = this.localVideo_[name];\n  }.bind(this));\n\n  // If the video is still playing, set the startTime.\n  // Has no effect if nothing is loaded.\n  if (!this.localVideo_.ended) {\n    initState['startTime'] = this.localVideo_.currentTime;\n  }\n\n  shaka.cast.CastUtils.PlayerInitState.forEach(function(pair) {\n    var getter = pair[0];\n    var setter = pair[1];\n    var value = /** @type {Object} */(this.localPlayer_)[getter]();\n\n    initState['player'][setter] = value;\n  }.bind(this));\n\n  shaka.cast.CastUtils.PlayerInitAfterLoadState.forEach(function(pair) {\n    var getter = pair[0];\n    var setter = pair[1];\n    var value = /** @type {Object} */(this.localPlayer_)[getter]();\n\n    initState['playerAfterLoad'][setter] = value;\n  }.bind(this));\n\n  return initState;\n};\n\n\n/**\n * Dispatch an event to notify the app that the status has changed.\n * @private\n */\nshaka.cast.CastProxy.prototype.onCastStatusChanged_ = function() {\n  var event = new shaka.util.FakeEvent('caststatuschanged');\n  this.dispatchEvent(event);\n};\n\n\n/**\n * Transfer remote state back and resume local playback.\n * @private\n */\nshaka.cast.CastProxy.prototype.onResumeLocal_ = function() {\n  // Transfer back the player state.\n  shaka.cast.CastUtils.PlayerInitState.forEach(function(pair) {\n    var getter = pair[0];\n    var setter = pair[1];\n    var value = this.sender_.get('player', getter)();\n    /** @type {Object} */(this.localPlayer_)[setter](value);\n  }.bind(this));\n\n  // Get the most recent manifest URI and ended state.\n  var manifestUri = this.sender_.get('player', 'getManifestUri')();\n  var ended = this.sender_.get('video', 'ended');\n\n  var manifestReady = Promise.resolve();\n  var autoplay = this.localVideo_.autoplay;\n\n  var startTime = null;\n\n  // If the video is still playing, set the startTime.\n  // Has no effect if nothing is loaded.\n  if (!ended) {\n    startTime = this.sender_.get('video', 'currentTime');\n  }\n\n  // Now load the manifest, if present.\n  if (manifestUri) {\n    // Don't autoplay the content until we finish setting up initial state.\n    this.localVideo_.autoplay = false;\n    manifestReady = this.localPlayer_.load(manifestUri, startTime);\n    // Pass any errors through to the app.\n    manifestReady.catch(function(error) {\n      goog.asserts.assert(error instanceof shaka.util.Error,\n                          'Wrong error type!');\n      var event = new shaka.util.FakeEvent('error', { 'detail': error });\n      this.localPlayer_.dispatchEvent(event);\n    }.bind(this));\n  }\n\n  // Get the video state into a temp variable since we will apply it async.\n  var videoState = {};\n  shaka.cast.CastUtils.VideoInitStateAttributes.forEach(function(name) {\n    videoState[name] = this.sender_.get('video', name);\n  }.bind(this));\n\n  // Finally, take on video state and player's \"after load\" state.\n  manifestReady.then(function() {\n    shaka.cast.CastUtils.VideoInitStateAttributes.forEach(function(name) {\n      this.localVideo_[name] = videoState[name];\n    }.bind(this));\n\n    shaka.cast.CastUtils.PlayerInitAfterLoadState.forEach(function(pair) {\n      var getter = pair[0];\n      var setter = pair[1];\n      var value = this.sender_.get('player', getter)();\n      /** @type {Object} */(this.localPlayer_)[setter](value);\n    }.bind(this));\n\n    // Restore original autoplay setting.\n    this.localVideo_.autoplay = autoplay;\n    if (manifestUri) {\n      // Resume playback with transferred state.\n      this.localVideo_.play();\n    }\n  }.bind(this));\n};\n\n\n/**\n * @param {string} name\n * @return {?}\n * @private\n */\nshaka.cast.CastProxy.prototype.videoProxyGet_ = function(name) {\n  if (name == 'addEventListener') {\n    return this.videoEventTarget_.addEventListener.bind(\n        this.videoEventTarget_);\n  }\n  if (name == 'removeEventListener') {\n    return this.videoEventTarget_.removeEventListener.bind(\n        this.videoEventTarget_);\n  }\n\n  // If we are casting, but the first update has not come in yet, use local\n  // values, but not local methods.\n  if (this.sender_.isCasting() && !this.sender_.hasRemoteProperties()) {\n    var value = this.localVideo_[name];\n    if (typeof value != 'function') {\n      return value;\n    }\n  }\n\n  // Use local values and methods if we are not casting.\n  if (!this.sender_.isCasting()) {\n    var value = this.localVideo_[name];\n    if (typeof value == 'function') {\n      value = value.bind(this.localVideo_);\n    }\n    return value;\n  }\n\n  return this.sender_.get('video', name);\n};\n\n\n/**\n * @param {string} name\n * @param {?} value\n * @private\n */\nshaka.cast.CastProxy.prototype.videoProxySet_ = function(name, value) {\n  if (!this.sender_.isCasting()) {\n    this.localVideo_[name] = value;\n    return;\n  }\n\n  this.sender_.set('video', name, value);\n};\n\n\n/**\n * @param {!Event} event\n * @private\n */\nshaka.cast.CastProxy.prototype.videoProxyLocalEvent_ = function(event) {\n  if (this.sender_.isCasting()) {\n    // Ignore any unexpected local events while casting.  Events can still be\n    // fired by the local video and Player when we unload() after the Cast\n    // connection is complete.\n    return;\n  }\n\n  // Convert this real Event into a FakeEvent for dispatch from our\n  // FakeEventListener.\n  var fakeEvent = new shaka.util.FakeEvent(event.type, event);\n  this.videoEventTarget_.dispatchEvent(fakeEvent);\n};\n\n\n/**\n * @param {string} name\n * @return {?}\n * @private\n */\nshaka.cast.CastProxy.prototype.playerProxyGet_ = function(name) {\n  if (name == 'addEventListener') {\n    return this.playerEventTarget_.addEventListener.bind(\n        this.playerEventTarget_);\n  }\n  if (name == 'removeEventListener') {\n    return this.playerEventTarget_.removeEventListener.bind(\n        this.playerEventTarget_);\n  }\n\n  if (name == 'getNetworkingEngine') {\n    // Always returns a local instance, in case you need to make a request.\n    // Issues a warning, in case you think you are making a remote request\n    // or affecting remote filters.\n    if (this.sender_.isCasting()) {\n      shaka.log.warning('NOTE: getNetworkingEngine() is always local!');\n    }\n    return this.localPlayer_.getNetworkingEngine.bind(this.localPlayer_);\n  }\n\n  // If we are casting, but the first update has not come in yet, use local\n  // getters, but not local methods.\n  if (this.sender_.isCasting() && !this.sender_.hasRemoteProperties()) {\n    if (shaka.cast.CastUtils.PlayerGetterMethods.indexOf(name) >= 0) {\n      var value = /** @type {Object} */(this.localPlayer_)[name];\n      goog.asserts.assert(typeof value == 'function', 'only methods on Player');\n      return value.bind(this.localPlayer_);\n    }\n  }\n\n  // Use local getters and methods if we are not casting.\n  if (!this.sender_.isCasting()) {\n    var value = /** @type {Object} */(this.localPlayer_)[name];\n    goog.asserts.assert(typeof value == 'function', 'only methods on Player');\n    return value.bind(this.localPlayer_);\n  }\n\n  return this.sender_.get('player', name);\n};\n\n\n/**\n * @param {!Event} event\n * @private\n */\nshaka.cast.CastProxy.prototype.playerProxyLocalEvent_ = function(event) {\n  if (this.sender_.isCasting()) {\n    // Ignore any unexpected local events while casting.\n    return;\n  }\n\n  this.playerEventTarget_.dispatchEvent(event);\n};\n\n\n/**\n * @param {string} targetName\n * @param {!shaka.util.FakeEvent} event\n * @private\n */\nshaka.cast.CastProxy.prototype.onRemoteEvent_ = function(targetName, event) {\n  goog.asserts.assert(this.sender_.isCasting(),\n                      'Should only receive remote events while casting');\n  if (!this.sender_.isCasting()) {\n    // Ignore any unexpected remote events.\n    return;\n  }\n\n  if (targetName == 'video') {\n    this.videoEventTarget_.dispatchEvent(event);\n  } else if (targetName == 'player') {\n    this.playerEventTarget_.dispatchEvent(event);\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/cast/cast_proxy.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.abr.Ewma');\n\ngoog.require('goog.asserts');\n\n\n\n/**\n * Computes an exponentionally-weighted moving average.\n *\n * @param {number} halfLife About half of the estimated value will be from the\n *   last |halfLife| samples by weight.\n * @struct\n * @constructor\n */\nshaka.abr.Ewma = function(halfLife) {\n  goog.asserts.assert(halfLife > 0, 'expected halfLife to be positive');\n\n  /**\n   * Larger values of alpha expire historical data more slowly.\n   * @private {number}\n   */\n  this.alpha_ = Math.exp(Math.log(0.5) / halfLife);\n\n  /** @private {number} */\n  this.estimate_ = 0;\n\n  /** @private {number} */\n  this.totalWeight_ = 0;\n};\n\n\n/**\n * Takes a sample.\n *\n * @param {number} weight\n * @param {number} value\n */\nshaka.abr.Ewma.prototype.sample = function(weight, value) {\n  var adjAlpha = Math.pow(this.alpha_, weight);\n  var newEstimate = value * (1 - adjAlpha) + adjAlpha * this.estimate_;\n\n  if (!isNaN(newEstimate)) {\n    this.estimate_ = newEstimate;\n    this.totalWeight_ += weight;\n  }\n};\n\n\n/**\n * @return {number}\n */\nshaka.abr.Ewma.prototype.getEstimate = function() {\n  var zeroFactor = 1 - Math.pow(this.alpha_, this.totalWeight_);\n  return this.estimate_ / zeroFactor;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/abr/ewma.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.abr.EwmaBandwidthEstimator');\n\ngoog.require('shaka.abr.Ewma');\n\n\n\n/**\n * Tracks bandwidth samples and estimates available bandwidth.\n * Based on the minimum of two exponentially-weighted moving averages with\n * different half-lives.\n *\n * @constructor\n * @struct\n */\nshaka.abr.EwmaBandwidthEstimator = function() {\n  /**\n   * A fast-moving average.\n   * Half of the estimate is based on the last 2 seconds of sample history.\n   * @private {!shaka.abr.Ewma}\n   */\n  this.fast_ = new shaka.abr.Ewma(2);\n\n  /**\n   * A slow-moving average.\n   * Half of the estimate is based on the last 5 seconds of sample history.\n   * @private {!shaka.abr.Ewma}\n   */\n  this.slow_ = new shaka.abr.Ewma(5);\n\n  /**\n   * Number of bytes sampled.\n   * @private {number}\n   */\n  this.bytesSampled_ = 0;\n\n  /**\n   * Initial estimate used when there is not enough data.\n   * @see shaka.abr.EwmaBandwidthEstimator.DEFAULT_ESTIMATE\n   * @private {number}\n   */\n  this.defaultEstimate_ = shaka.abr.EwmaBandwidthEstimator.DEFAULT_ESTIMATE;\n\n  /**\n   * Minimum number of bytes sampled before we trust the estimate.  If we have\n   * not sampled much data, our estimate may not be accurate enough to trust.\n   * If bytesSampled_ is less than minTotalBytes_, we use defaultEstimate_.\n   * This specific value is based on experimentation.\n   *\n   * @private {number}\n   * @const\n   */\n  this.minTotalBytes_ = 128e3;  // 128kB\n\n  /**\n   * Minimum number of bytes, under which samples are discarded.  Our models do\n   * not include latency information, so connection startup time (time to first\n   * byte) is considered part of the download time.  Because of this, we should\n   * ignore very small downloads which would cause our estimate to be too low.\n   * This specific value is based on experimentation.\n   *\n   * @private {number}\n   * @const\n   */\n  this.minBytes_ = 16e3;  // 16kB\n};\n\n\n/**\n * Contains the default estimate to use when there is not enough data.\n * This is a relatively safe default, since 3G cell connections are faster than\n * this.  For slower connections, such as 2G, the default estimate may be too\n * high.  This default can be changed at runtime using\n * {@link shaka.Player#configure} and {@link shakaExtern.AbrConfiguration}.\n * @const {number}\n */\nshaka.abr.EwmaBandwidthEstimator.DEFAULT_ESTIMATE = 500e3;  // 500kbps\n\n\n/**\n * Takes a bandwidth sample.\n *\n * @param {number} durationMs The amount of time, in milliseconds, for a\n *   particular request.\n * @param {number} numBytes The total number of bytes transferred in that\n *   request.\n */\nshaka.abr.EwmaBandwidthEstimator.prototype.sample = function(\n    durationMs, numBytes) {\n  if (numBytes < this.minBytes_) {\n    return;\n  }\n\n  var bandwidth = 8000 * numBytes / durationMs;\n  var weight = durationMs / 1000;\n\n  this.bytesSampled_ += numBytes;\n  this.fast_.sample(weight, bandwidth);\n  this.slow_.sample(weight, bandwidth);\n};\n\n\n/**\n * Sets the default bandwidth estimate to use if there is not enough data.\n *\n * @param {number} estimate The default bandwidth estimate, in bit/sec.\n */\nshaka.abr.EwmaBandwidthEstimator.prototype.setDefaultEstimate = function(\n    estimate) {\n  this.defaultEstimate_ = estimate;\n};\n\n\n/**\n * Gets the current bandwidth estimate.\n *\n * @return {number} The bandwidth estimate in bits per second.\n */\nshaka.abr.EwmaBandwidthEstimator.prototype.getBandwidthEstimate = function() {\n  if (this.bytesSampled_ < this.minTotalBytes_) {\n    return this.defaultEstimate_;\n  }\n\n  // Take the minimum of these two estimates.  This should have the effect of\n  // adapting down quickly, but up more slowly.\n  return Math.min(this.fast_.getEstimate(), this.slow_.getEstimate());\n};\n\n\n/**\n * @return {boolean} True if there is enough data to produce a meaningful\n *   estimate.\n */\nshaka.abr.EwmaBandwidthEstimator.prototype.hasGoodEstimate = function() {\n  return this.bytesSampled_ >= this.minTotalBytes_;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/abr/ewma_bandwidth_estimator.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.log');\n\n\n/**\n * @namespace shaka.log\n * @summary\n * A console logging framework which is compiled out for deployment.  This is\n * only available when using the uncompiled version.\n * @exportDoc\n */\n\n\n/**\n * Log levels.\n * @enum {number}\n * @exportDoc\n */\nshaka.log.Level = {\n  NONE: 0,\n  ERROR: 1,\n  WARNING: 2,\n  INFO: 3,\n  DEBUG: 4,\n  V1: 5,\n  V2: 6\n};\n\n\n/**\n * @define {number} the maximum log level.\n */\ngoog.define('shaka.log.MAX_LOG_LEVEL', 3);\n\n\n/** @type {function(*, ...*)} */\nshaka.log.error = function() {};\n\n\n/** @type {function(*, ...*)} */\nshaka.log.warning = function() {};\n\n\n/** @type {function(*, ...*)} */\nshaka.log.info = function() {};\n\n\n/** @type {function(*, ...*)} */\nshaka.log.debug = function() {};\n\n\n/** @type {function(*, ...*)} */\nshaka.log.v1 = function() {};\n\n\n/** @type {function(*, ...*)} */\nshaka.log.v2 = function() {};\n\n\n// IE8 has no console unless it is opened in advance.\n// IE9 console methods are not Functions and have no bind.\nif (window.console && window.console.log.bind) {\n  if (!COMPILED) {\n    /** @type {number} */\n    shaka.log.currentLevel;\n\n    /**\n     * Change the log level.  Useful for debugging in uncompiled mode.\n     *\n     * @param {number} level\n     * @exportDoc\n     */\n    shaka.log.setLevel = function(level) {\n      var nop = function() {};\n      var log = shaka.log;\n      var Level = shaka.log.Level;\n\n      shaka.log.currentLevel = level;\n\n      log.error = (level >= Level.ERROR) ? console.error.bind(console) : nop;\n      log.warning = (level >= Level.WARNING) ? console.warn.bind(console) : nop;\n      log.info = (level >= Level.INFO) ? console.info.bind(console) : nop;\n      log.debug = (level >= Level.DEBUG) ? console.log.bind(console) : nop;\n      log.v1 = (level >= Level.V1) ? console.debug.bind(console) : nop;\n      log.v2 = (level >= Level.V2) ? console.debug.bind(console) : nop;\n    };\n\n    shaka.log.setLevel(shaka.log.MAX_LOG_LEVEL);\n  } else {\n    if (shaka.log.MAX_LOG_LEVEL >= shaka.log.Level.ERROR) {\n      shaka.log.error = console.error.bind(console);\n    }\n    if (shaka.log.MAX_LOG_LEVEL >= shaka.log.Level.WARNING) {\n      shaka.log.warning = console.warn.bind(console);\n    }\n    if (shaka.log.MAX_LOG_LEVEL >= shaka.log.Level.INFO) {\n      shaka.log.info = console.info.bind(console);\n    }\n    if (shaka.log.MAX_LOG_LEVEL >= shaka.log.Level.DEBUG) {\n      shaka.log.debug = console.log.bind(console);\n    }\n    if (shaka.log.MAX_LOG_LEVEL >= shaka.log.Level.V1) {\n      shaka.log.v1 = console.debug.bind(console);\n    }\n    if (shaka.log.MAX_LOG_LEVEL >= shaka.log.Level.V2) {\n      shaka.log.v2 = console.debug.bind(console);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/debug/log.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.Error');\n\n\n\n/**\n * Creates a new Error.\n *\n * @param {shaka.util.Error.Severity} severity\n * @param {shaka.util.Error.Category} category\n * @param {shaka.util.Error.Code} code\n * @param {...*} var_args\n *\n * @constructor\n * @struct\n * @export\n * @extends {Error}\n */\nshaka.util.Error = function(severity, category, code, var_args) {\n  this.severity = severity;\n  this.category = category;\n  this.code = code;\n  this.data = Array.prototype.slice.call(arguments, 3);\n\n  // This improves formatting of Errors in failure messages in the tests.\n  if (!COMPILED) {\n    var categoryName = 'UNKNOWN';\n    var codeName = 'UNKNOWN';\n\n    for (var k in shaka.util.Error.Category) {\n      if (shaka.util.Error.Category[k] == this.category)\n        categoryName = k;\n    }\n    for (var k in shaka.util.Error.Code) {\n      if (shaka.util.Error.Code[k] == this.code)\n        codeName = k;\n    }\n\n    /**\n     * A human-readable version of the category and code.\n     * <i>(Only available in uncompiled mode.)</i>\n     *\n     * @const {string}\n     * @exportDoc\n     */\n    this.message = 'Shaka Error ' + categoryName + '.' + codeName +\n                   ' (' + this.data.toString() + ')';\n    try {\n      throw new Error(this.message);\n    } catch (e) {\n      /**\n       * A stack-trace showing where the error occurred.\n       * <i>(Only available in uncompiled mode.)</i>\n       *\n       * @const {string}\n       * @exportDoc\n       */\n      this.stack = e.stack;\n    }\n  }\n};\n\n\n/**\n * @type {shaka.util.Error.Severity}\n * @expose\n */\nshaka.util.Error.prototype.severity;\n\n\n/**\n * @const {shaka.util.Error.Category}\n * @expose\n */\nshaka.util.Error.prototype.category;\n\n\n/**\n * @const {shaka.util.Error.Code}\n * @expose\n */\nshaka.util.Error.prototype.code;\n\n\n/**\n * @const {!Array.<*>}\n * @expose\n */\nshaka.util.Error.prototype.data;\n\n\n/**\n * @return {string}\n * @override\n */\nshaka.util.Error.prototype.toString = function() {\n  return 'shaka.util.Error ' + JSON.stringify(this, null, '  ');\n};\n\n\n/**\n * @enum {number}\n * @export\n */\nshaka.util.Error.Severity = {\n  /**\n   * An error occurred, but the Player is attempting to recover from the error.\n   *\n   * If the Player cannot ultimately recover, it still may not throw a CRITICAL\n   * error.  For example, retrying for a media segment will never result in\n   * a CRITICAL error (the Player will just retry forever).\n   */\n  'RECOVERABLE': 1,\n\n  /**\n   * A critical error that the library cannot recover from.  These usually cause\n   * the Player to stop loading or updating.  A new manifest must be loaded\n   * to reset the library.\n   */\n  'CRITICAL': 2\n};\n\n\n/**\n * @enum {number}\n * @export\n */\nshaka.util.Error.Category = {\n  /** Errors from the network stack. */\n  'NETWORK': 1,\n\n  /** Errors parsing text streams. */\n  'TEXT': 2,\n\n  /** Errors parsing or processing audio or video streams. */\n  'MEDIA': 3,\n\n  /** Errors parsing the Manifest. */\n  'MANIFEST': 4,\n\n  /** Errors related to streaming. */\n  'STREAMING': 5,\n\n  /** Errors related to DRM. */\n  'DRM': 6,\n\n  /** Miscellaneous errors from the player. */\n  'PLAYER': 7,\n\n  /** Errors related to cast. */\n  'CAST': 8,\n\n  /** Errors in the database storage (offline). */\n  'STORAGE': 9\n};\n\n\n/**\n * @enum {number}\n * @export\n */\nshaka.util.Error.Code = {\n  /**\n   * A network request was made using an unsupported URI scheme.\n   * <br> error.data[0] is the URI.\n   */\n  'UNSUPPORTED_SCHEME': 1000,\n\n  /**\n   * An HTTP network request returned an HTTP status that indicated a failure.\n   * <br> error.data[0] is the URI.\n   * <br> error.data[1] is the status code.\n   * <br> error.data[2] is the response text, or null if the response could not\n   *   be interpretted as text.\n   * <br> error.data[3] is the map of response headers.\n   */\n  'BAD_HTTP_STATUS': 1001,\n\n  /**\n   * An HTTP network request failed with an error, but not from the server.\n   * <br> error.data[0] is the URI.\n   */\n  'HTTP_ERROR': 1002,\n\n  /**\n   * A network request timed out.\n   * <br> error.data[0] is the URI.\n   */\n  'TIMEOUT': 1003,\n\n  /**\n   * A network request was made with a malformed data URI.\n   * <br> error.data[0] is the URI.\n   */\n  'MALFORMED_DATA_URI': 1004,\n\n  /**\n   * A network request was made with a data URI using an unknown encoding.\n   * <br> error.data[0] is the URI.\n   */\n  'UNKNOWN_DATA_URI_ENCODING': 1005,\n\n  /**\n   * A request filter threw an error.\n   * <br> error.data[0] is the original error.\n   */\n  'REQUEST_FILTER_ERROR': 1006,\n\n  /**\n   * A response filter threw an error.\n   * <br> error.data[0] is the original error.\n   */\n  'RESPONSE_FILTER_ERROR': 1007,\n\n\n  /** The text parser failed to parse a text stream due to an invalid header. */\n  'INVALID_TEXT_HEADER': 2000,\n\n  /** The text parser failed to parse a text stream due to an invalid cue. */\n  'INVALID_TEXT_CUE': 2001,\n\n  // RETIRED: 'INVALID_TEXT_SETTINGS': 2002,\n\n  /**\n   * Was unable to detect the encoding of the response text.  Suggest adding\n   * byte-order-markings to the response data.\n   */\n  'UNABLE_TO_DETECT_ENCODING': 2003,\n\n  /** The response data contains invalid Unicode character encoding. */\n  'BAD_ENCODING': 2004,\n\n  /**\n   * The XML parser failed to parse an xml stream, or the XML lacks mandatory\n   * elements for TTML.\n   */\n  'INVALID_XML': 2005,\n\n  // RETIRED: 'INVALID_TTML': 2006,\n\n  /**\n   * MP4 segment does not contain TTML.\n   */\n  'INVALID_MP4_TTML': 2007,\n\n  /**\n   * MP4 segment does not contain VTT.\n   */\n  'INVALID_MP4_VTT': 2008,\n\n\n  /**\n   * Some component tried to read past the end of a buffer.  The segment index,\n   * init segment, or PSSH may be malformed.\n   */\n  'BUFFER_READ_OUT_OF_BOUNDS': 3000,\n\n  /**\n   * Some component tried to parse an integer that was too large to fit in a\n   * JavaScript number without rounding error.  JavaScript can only natively\n   * represent integers up to 53 bits.\n   */\n  'JS_INTEGER_OVERFLOW': 3001,\n\n  /**\n   * The EBML parser used to parse the WebM container encountered an integer,\n   * ID, or other field larger than the maximum supported by the parser.\n   */\n  'EBML_OVERFLOW': 3002,\n\n  /**\n   * The EBML parser used to parse the WebM container encountered a floating-\n   * point field of a size not supported by the parser.\n   */\n  'EBML_BAD_FLOATING_POINT_SIZE': 3003,\n\n  /**\n   * The MP4 SIDX parser found the wrong box type.\n   * Either the segment index range is incorrect or the data is corrupt.\n   */\n  'MP4_SIDX_WRONG_BOX_TYPE': 3004,\n\n  /**\n   * The MP4 SIDX parser encountered an invalid timescale.\n   * The segment index data may be corrupt.\n   */\n  'MP4_SIDX_INVALID_TIMESCALE': 3005,\n\n  /** The MP4 SIDX parser encountered a type of SIDX that is not supported. */\n  'MP4_SIDX_TYPE_NOT_SUPPORTED': 3006,\n\n  /**\n   * The WebM Cues parser was unable to locate the Cues element.\n   * The segment index data may be corrupt.\n   */\n  'WEBM_CUES_ELEMENT_MISSING': 3007,\n\n  /**\n   * The WebM header parser was unable to locate the Ebml element.\n   * The init segment data may be corrupt.\n   */\n  'WEBM_EBML_HEADER_ELEMENT_MISSING': 3008,\n\n  /**\n   * The WebM header parser was unable to locate the Segment element.\n   * The init segment data may be corrupt.\n   */\n  'WEBM_SEGMENT_ELEMENT_MISSING': 3009,\n\n  /**\n   * The WebM header parser was unable to locate the Info element.\n   * The init segment data may be corrupt.\n   */\n  'WEBM_INFO_ELEMENT_MISSING': 3010,\n\n  /**\n   * The WebM header parser was unable to locate the Duration element.\n   * The init segment data may be corrupt or may have been incorrectly encoded.\n   * Shaka requires a duration in WebM DASH content.\n   */\n  'WEBM_DURATION_ELEMENT_MISSING': 3011,\n\n  /**\n   * The WebM Cues parser was unable to locate the Cue Track Positions element.\n   * The segment index data may be corrupt.\n   */\n  'WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING': 3012,\n\n  /**\n   * The WebM Cues parser was unable to locate the Cue Time element.\n   * The segment index data may be corrupt.\n   */\n  'WEBM_CUE_TIME_ELEMENT_MISSING': 3013,\n\n  /**\n   * A MediaSource operation failed.\n   * <br> error.data[0] is a MediaError code from the video element.\n   */\n  'MEDIA_SOURCE_OPERATION_FAILED': 3014,\n\n  /**\n   * A MediaSource operation threw an exception.\n   * <br> error.data[0] is the exception that was thrown.\n   */\n  'MEDIA_SOURCE_OPERATION_THREW': 3015,\n\n  /**\n   * The video element reported an error.\n   * <br> error.data[0] is a MediaError code from the video element.\n   * <br> On Edge & IE, error.data[1] is a Microsoft extended error code in hex.\n   */\n  'VIDEO_ERROR': 3016,\n\n  /**\n   * A MediaSource operation threw QuotaExceededError and recovery failed. The\n   * content cannot be played correctly because the segments are too large for\n   * the browser/platform. This may occur when attempting to play very high\n   * quality, very high bitrate content on low-end devices.\n   * <br> error.data[0] is the type of content which caused the error.\n   */\n  'QUOTA_EXCEEDED_ERROR': 3017,\n\n\n  /**\n   * The Player was unable to guess the manifest type based on file extension\n   * or MIME type.  To fix, try one of the following:\n   * <br><ul>\n   *   <li>Rename the manifest so that the URI ends in a well-known extension.\n   *   <li>Configure the server to send a recognizable Content-Type header.\n   *   <li>Configure the server to accept a HEAD request for the manifest.\n   * </ul>\n   * <br> error.data[0] is the manifest URI.\n   */\n  'UNABLE_TO_GUESS_MANIFEST_TYPE': 4000,\n\n  /** The DASH Manifest contained invalid XML markup. */\n  'DASH_INVALID_XML': 4001,\n\n  /**\n   * The DASH Manifest contained a Representation with insufficient segment\n   * information.\n   */\n  'DASH_NO_SEGMENT_INFO': 4002,\n\n  /** The DASH Manifest contained an AdaptationSet with no Representations. */\n  'DASH_EMPTY_ADAPTATION_SET': 4003,\n\n  /** The DASH Manifest contained an Period with no AdaptationSets. */\n  'DASH_EMPTY_PERIOD': 4004,\n\n  /**\n   * The DASH Manifest does not specify an init segment with a WebM container.\n   */\n  'DASH_WEBM_MISSING_INIT': 4005,\n\n  /** The DASH Manifest contained an unsupported container format. */\n  'DASH_UNSUPPORTED_CONTAINER': 4006,\n\n  /** The embedded PSSH data has invalid encoding. */\n  'DASH_PSSH_BAD_ENCODING': 4007,\n\n  /**\n   * There is an AdaptationSet whose Representations do not have any common\n   * key-systems.\n   */\n  'DASH_NO_COMMON_KEY_SYSTEM': 4008,\n\n  /** Having multiple key IDs per Representation is not supported. */\n  'DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED': 4009,\n\n  /** The DASH Manifest specifies conflicting key IDs. */\n  'DASH_CONFLICTING_KEY_IDS': 4010,\n\n  /**\n   * The manifest contains a period with no playable streams.\n   * Either the period was originally empty, or the streams within cannot be\n   * played on this browser or platform.\n   */\n  'UNPLAYABLE_PERIOD': 4011,\n\n  /**\n   * There exist some streams that could be decoded, but restrictions imposed\n   * by the application or the key system prevent us from playing.  This may\n   * happen under the following conditions:\n   * <ul>\n   *   <li>The application has given restrictions to the Player that restrict\n   *       at least one content type completely (e.g. no playable audio).\n   *   <li>The key system has imposed output restrictions that cannot be met\n   *       (such as HDCP) and there are no unrestricted alternatives.\n   * </ul>\n   */\n  'RESTRICTIONS_CANNOT_BE_MET': 4012,\n\n  // RETIRED: 'INTERNAL_ERROR_KEY_STATUS': 4013,\n\n  /**\n   * No valid periods were found in the manifest.  Please check that your\n   * manifest is correct and free of typos.\n   */\n  'NO_PERIODS': 4014,\n\n  /**\n   * HLS playlist doesn't start with a mandory #EXTM3U tag.\n   */\n  'HLS_PLAYLIST_HEADER_MISSING': 4015,\n\n  /**\n   * HLS tag has an invalid name that doesn't start with '#EXT'\n   */\n  'INVALID_HLS_TAG': 4016,\n\n  /**\n   * HLS playlist has both Master and Media/Segment tags.\n   */\n  'HLS_INVALID_PLAYLIST_HIERARCHY': 4017,\n\n  /**\n   * A Representation has an id that is the same as another Representation in\n   * the same Period.  This makes manifest updates impossible since we cannot\n   * map the updated Representation to the old one.\n   */\n  'DASH_DUPLICATE_REPRESENTATION_ID': 4018,\n\n  // RETIRED: 'HLS_MEDIA_INIT_SECTION_INFO_MISSING': 4019,\n\n  /**\n   * HLS manifest has several #EXT-X-MAP tags. We can only\n   * support one at the moment.\n   */\n  'HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND': 4020,\n\n  /**\n   * HLS parser was unable to guess mime type of a stream.\n   * <br> error.data[0] is the stream file's extension.\n   */\n  'HLS_COULD_NOT_GUESS_MIME_TYPE': 4021,\n\n  /**\n   * No Master Playlist has been provided. Master playlist provides\n   * vital information about the streams (like codecs) that is\n   * required for MediaSource. We don't support directly providing\n   * a Media Playlist.\n   */\n  'HLS_MASTER_PLAYLIST_NOT_PROVIDED': 4022,\n\n  /**\n   * One of the required attributes was not provided.\n   * HLS manifest is invalid.\n   * <br> error.data[0] is the missing attribute's name.\n   */\n  'HLS_REQUIRED_ATTRIBUTE_MISSING': 4023,\n\n  /**\n   * One of the required tags was not provided.\n   * HLS manifest is invalid.\n   * <br> error.data[0] is the missing tag's name.\n   */\n  'HLS_REQUIRED_TAG_MISSING': 4024,\n\n  /**\n   * HLS parser was unable to guess codecs of a stream.\n   * <br> error.data[0] is the list of all codecs for the variant.\n   */\n  'HLS_COULD_NOT_GUESS_CODECS': 4025,\n\n  /**\n   * HLS parser has encountered encrypted content with unsupported\n   * KEYFORMAT attributes.\n   */\n  'HLS_KEYFORMATS_NOT_SUPPORTED': 4026,\n\n\n  // RETIRED: 'INCONSISTENT_BUFFER_STATE': 5000,\n  // RETIRED: 'INVALID_SEGMENT_INDEX': 5001,\n  // RETIRED: 'SEGMENT_DOES_NOT_EXIST': 5002,\n  // RETIRED: 'CANNOT_SATISFY_BYTE_LIMIT': 5003,\n  // RETIRED: 'BAD_SEGMENT': 5004,\n\n  /**\n   * The StreamingEngine called onChooseStreams() but the callback receiver\n   * did not return the correct number or type of Streams.\n   *\n   * This can happen when there is multi-Period content where one Period is\n   * video+audio and another is video-only or audio-only.  We don't support this\n   * case because it is incompatible with MSE.  When the browser reaches the\n   * transition, it will pause, waiting for the audio stream.\n   */\n  'INVALID_STREAMS_CHOSEN': 5005,\n\n\n  /**\n   * The manifest indicated protected content, but the manifest parser was\n   * unable to determine what key systems should be used.\n   */\n  'NO_RECOGNIZED_KEY_SYSTEMS': 6000,\n\n  /**\n   * None of the requested key system configurations are available.  This may\n   * happen under the following conditions:\n   * <ul>\n   *   <li> The key system is not supported.\n   *   <li> The key system does not support the features requested (e.g.\n   *        persistent state).\n   *   <li> A user prompt was shown and the user denied access.\n   *   <li> The key system is not available from unsecure contexts. (ie.\n            requires HTTPS) See https://goo.gl/EEhZqT.\n   * </ul>\n   */\n  'REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE': 6001,\n\n  /**\n   * The browser found one of the requested key systems, but it failed to\n   * create an instance of the CDM for some unknown reason.\n   * <br> error.data[0] is an error message string from the browser.\n   */\n  'FAILED_TO_CREATE_CDM': 6002,\n\n  /**\n   * The browser found one of the requested key systems and created an instance\n   * of the CDM, but it failed to attach the CDM to the video for some unknown\n   * reason.\n   * <br> error.data[0] is an error message string from the browser.\n   */\n  'FAILED_TO_ATTACH_TO_VIDEO': 6003,\n\n  /**\n   * The CDM rejected the server certificate supplied by the application.\n   * The certificate may be malformed or in an unsupported format.\n   * <br> error.data[0] is an error message string from the browser.\n   */\n  'INVALID_SERVER_CERTIFICATE': 6004,\n\n  /**\n   * The CDM refused to create a session for some unknown reason.\n   * <br> error.data[0] is an error message string from the browser.\n   */\n  'FAILED_TO_CREATE_SESSION': 6005,\n\n  /**\n   * The CDM was unable to generate a license request for the init data it was\n   * given.  The init data may be malformed or in an unsupported format.\n   * <br> error.data[0] is an error message string from the browser.\n   */\n  'FAILED_TO_GENERATE_LICENSE_REQUEST': 6006,\n\n  /**\n   * The license request failed.  This could be a timeout, a network failure, or\n   * a rejection by the server.\n   * <br> error.data[0] is a shaka.util.Error from the networking engine.\n   */\n  'LICENSE_REQUEST_FAILED': 6007,\n\n  /**\n   * The license response was rejected by the CDM.  The server's response may be\n   * invalid or malformed for this CDM.\n   * <br> error.data[0] is an error message string from the browser.\n   */\n  'LICENSE_RESPONSE_REJECTED': 6008,\n\n  // RETIRED: 'NO_LICENSE_SERVER_SPECIFIED': 6009,\n\n  /**\n   * The manifest does not specify any DRM info, but the content is encrypted.\n   * Either the manifest or the manifest parser are broken.\n   */\n  'ENCRYPTED_CONTENT_WITHOUT_DRM_INFO': 6010,\n\n  // RETIRED: 'WRONG_KEYS': 6011,\n\n  /**\n   * No license server was given for the key system signaled by the manifest.\n   * A license server URI is required for every key system.\n   */\n  'NO_LICENSE_SERVER_GIVEN': 6012,\n\n  /**\n   * A required offline session was removed.  The content is not playable.\n   */\n  'OFFLINE_SESSION_REMOVED': 6013,\n\n  /**\n   * The license has expired.  This is triggered when playback is stalled on a\n   * 'waitingforkeys' event and there are any expired keys in the key status map\n   * of any active session.\n   */\n  'EXPIRED': 6014,\n\n\n  /**\n   * The call to Player.load() was interrupted by a call to Player.unload()\n   * or another call to Player.load().\n   */\n  'LOAD_INTERRUPTED': 7000,\n\n\n  /**\n   * The Cast API is unavailable.  This may be because of one of the following:\n   * - The browser may not have Cast support\n   * - The browser may be missing a necessary Cast extension\n   * - The Cast sender library may not be loaded in your app\n   */\n  'CAST_API_UNAVAILABLE': 8000,\n\n  /**\n   * No cast receivers are available at this time.\n   */\n  'NO_CAST_RECEIVERS': 8001,\n\n  /**\n   * The library is already casting.\n   */\n  'ALREADY_CASTING': 8002,\n\n  /**\n   * A Cast SDK error that we did not explicitly plan for has occurred.\n   * Check data[0] and refer to the Cast SDK documentation for details.\n   * <br> error.data[0] is an error object from the Cast SDK.\n   */\n  'UNEXPECTED_CAST_ERROR': 8003,\n\n  /**\n   * The cast operation was canceled by the user.\n   * <br> error.data[0] is an error object from the Cast SDK.\n   */\n  'CAST_CANCELED_BY_USER': 8004,\n\n  /**\n   * The cast connection timed out.\n   * <br> error.data[0] is an error object from the Cast SDK.\n   */\n  'CAST_CONNECTION_TIMED_OUT': 8005,\n\n  /**\n   * The requested receiver app ID does not exist or is unavailable.\n   * Check the requested app ID for typos.\n   * <br> error.data[0] is an error object from the Cast SDK.\n   */\n  'CAST_RECEIVER_APP_UNAVAILABLE': 8006,\n\n\n  /**\n   * Offline storage is not supported on this browser; it is required for\n   * offline support.\n   */\n  'STORAGE_NOT_SUPPORTED': 9000,\n\n  /**\n   * An unknown error occurred in the IndexedDB.\n   * <br> On Firefox, one common source for UnknownError calls is reverting\n   * Firefox to an old version. This makes the indexedDB storage inaccessible\n   * for older versions. The only way to fix this is to delete the storage\n   * data in your profile. See https://goo.gl/eKVPPe.\n   * <br> error.data[0] is the error object.\n   */\n  'INDEXED_DB_ERROR': 9001,\n\n  /**\n   * The operation was aborted.  For example, by a call to destroy().\n   */\n  'OPERATION_ABORTED': 9002,\n\n  /**\n   * The specified item was not found in the IndexedDB.\n   * <br> error.data[0] is the offline URI.\n   */\n  'REQUESTED_ITEM_NOT_FOUND': 9003,\n\n  /**\n   * A network request was made with a malformed offline URI.\n   * <br> error.data[0] is the URI.\n   */\n  'MALFORMED_OFFLINE_URI': 9004,\n\n  /**\n   * The specified content is live or in-progress.\n   * Live and in-progress streams cannot be stored offline.\n   * <br> error.data[0] is the URI.\n   */\n  'CANNOT_STORE_LIVE_OFFLINE': 9005,\n\n  /**\n   * There is already a store operation in-progress, wait until it completes\n   * before starting another.\n   */\n  'STORE_ALREADY_IN_PROGRESS': 9006,\n\n  /**\n   * The specified manifest is encrypted but does not specify any init data.\n   * Without init data specified in the manifest, the content will not be\n   * playable offline.\n   * <br> error.data[0] is the URI.\n   */\n  'NO_INIT_DATA_FOR_OFFLINE': 9007,\n\n  /**\n   * shaka.offline.Storage was constructed with a Player proxy instead of a\n   * local player instance.  To fix this, use Player directly with Storage\n   * instead of the results of CastProxy.prototype.getPlayer().\n   */\n  'LOCAL_PLAYER_INSTANCE_REQUIRED': 9008\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/error.js","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Simple utilities for splitting URI strings.\n *\n * Uses features of RFC 3986 for parsing/formatting URIs:\n *   http://www.ietf.org/rfc/rfc3986.txt\n *\n * @author gboyer@google.com (Garrett Boyer) - The \"lightened\" design.\n * @author msamuel@google.com (Mike Samuel) - Domain knowledge and regexes.\n */\n\ngoog.provide('goog.uri.utils');\ngoog.provide('goog.uri.utils.ComponentIndex');\n\n\n/**\n * A regular expression for breaking a URI into its component parts.\n *\n * {@link http://www.ietf.org/rfc/rfc3986.txt} says in Appendix B\n * As the \"first-match-wins\" algorithm is identical to the \"greedy\"\n * disambiguation method used by POSIX regular expressions, it is natural and\n * commonplace to use a regular expression for parsing the potential five\n * components of a URI reference.\n *\n * The following line is the regular expression for breaking-down a\n * well-formed URI reference into its components.\n *\n * <pre>\n * ^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?\n *  12            3  4          5       6  7        8 9\n * </pre>\n *\n * The numbers in the second line above are only to assist readability; they\n * indicate the reference points for each subexpression (i.e., each paired\n * parenthesis). We refer to the value matched for subexpression <n> as $<n>.\n * For example, matching the above expression to\n * <pre>\n *     http://www.ics.uci.edu/pub/ietf/uri/#Related\n * </pre>\n * results in the following subexpression matches:\n * <pre>\n *    $1 = http:\n *    $2 = http\n *    $3 = //www.ics.uci.edu\n *    $4 = www.ics.uci.edu\n *    $5 = /pub/ietf/uri/\n *    $6 = <undefined>\n *    $7 = <undefined>\n *    $8 = #Related\n *    $9 = Related\n * </pre>\n * where <undefined> indicates that the component is not present, as is the\n * case for the query component in the above example. Therefore, we can\n * determine the value of the five components as\n * <pre>\n *    scheme    = $2\n *    authority = $4\n *    path      = $5\n *    query     = $7\n *    fragment  = $9\n * </pre>\n *\n * The regular expression has been modified slightly to expose the\n * userInfo, domain, and port separately from the authority.\n * The modified version yields\n * <pre>\n *    $1 = http              scheme\n *    $2 = <undefined>       userInfo -\\\n *    $3 = www.ics.uci.edu   domain     | authority\n *    $4 = <undefined>       port     -/\n *    $5 = /pub/ietf/uri/    path\n *    $6 = <undefined>       query without ?\n *    $7 = Related           fragment without #\n * </pre>\n * @type {!RegExp}\n * @private\n */\ngoog.uri.utils.splitRe_ = new RegExp(\n    '^' +\n    '(?:' +\n        '([^:/?#.]+)' +                  // scheme - ignore special characters\n                                         // used by other URL parts such as :,\n                                         // ?, /, #, and .\n    ':)?' +\n    '(?://' +\n        '(?:([^/?#]*)@)?' +              // userInfo\n        '([^/#?]*?)' +                   // domain\n        '(?::([0-9]+))?' +               // port\n        '(?=[/#?]|$)' +                  // authority-terminating character\n    ')?' +\n    '([^?#]+)?' +                        // path\n    '(?:\\\\?([^#]*))?' +                  // query\n    '(?:#(.*))?' +                       // fragment\n    '$');\n\n\n/**\n * The index of each URI component in the return value of goog.uri.utils.split.\n * @enum {number}\n */\ngoog.uri.utils.ComponentIndex = {\n  SCHEME: 1,\n  USER_INFO: 2,\n  DOMAIN: 3,\n  PORT: 4,\n  PATH: 5,\n  QUERY_DATA: 6,\n  FRAGMENT: 7\n};\n\n\n/**\n * Splits a URI into its component parts.\n *\n * Each component can be accessed via the component indices; for example:\n * <pre>\n * goog.uri.utils.split(someStr)[goog.uri.utils.CompontentIndex.QUERY_DATA];\n * </pre>\n *\n * @param {string} uri The URI string to examine.\n * @return {!Array.<string|undefined>} Each component still URI-encoded.\n *     Each component that is present will contain the encoded value, whereas\n *     components that are not present will be undefined or empty, depending\n *     on the browser's regular expression implementation.  Never null, since\n *     arbitrary strings may still look like path names.\n */\ngoog.uri.utils.split = function(uri) {\n  // See @return comment -- never null.\n  return /** @type {!Array.<string|undefined>} */ (\n      uri.match(goog.uri.utils.splitRe_));\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/third_party/closure/goog/uri/utils.js","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Class for parsing and formatting URIs.\n *\n * Use new goog.Uri(string) to parse a URI string.\n *\n * e.g: <code>var myUri = new goog.Uri(window.location);</code>\n *\n * Implements RFC 3986 for parsing/formatting URIs.\n * http://www.ietf.org/rfc/rfc3986.txt\n *\n * Some changes have been made to the interface (more like .NETs), though the\n * internal representation is now of un-encoded parts, this will change the\n * behavior slightly.\n *\n */\n\ngoog.provide('goog.Uri');\ngoog.provide('goog.Uri.QueryData');\n\ngoog.require('goog.uri.utils');\ngoog.require('goog.uri.utils.ComponentIndex');\n\n\n\n/**\n * This class contains setters and getters for the parts of the URI.\n * The <code>getXyz</code>/<code>setXyz</code> methods return the decoded part\n * -- so<code>new goog.Uri('/foo%20bar').getPath()</code> will return the\n * decoded path, <code>/foo bar</code>.\n *\n * Reserved characters (see RFC 3986 section 2.2) can be present in\n * their percent-encoded form in scheme, domain, and path URI components and\n * will not be auto-decoded. For example:\n * <code>new goog.Uri('rel%61tive/path%2fto/resource').getPath()</code> will\n * return <code>relative/path%2fto/resource</code>.\n *\n * The constructor accepts an optional unparsed, raw URI string.  The parser\n * is relaxed, so special characters that aren't escaped but don't cause\n * ambiguities will not cause parse failures.\n *\n * All setters return <code>this</code> and so may be chained, a la\n * <code>new goog.Uri('/foo').setFragment('part').toString()</code>.\n *\n * @param {*=} opt_uri Optional string URI to parse, or if a goog.Uri is\n *        passed, a clone is created.\n *\n * @constructor\n */\ngoog.Uri = function(opt_uri) {\n  // Parse in the uri string\n  var m;\n  if (opt_uri instanceof goog.Uri) {\n    this.setScheme(opt_uri.getScheme());\n    this.setUserInfo(opt_uri.getUserInfo());\n    this.setDomain(opt_uri.getDomain());\n    this.setPort(opt_uri.getPort());\n    this.setPath(opt_uri.getPath());\n    this.setQueryData(opt_uri.getQueryData().clone());\n    this.setFragment(opt_uri.getFragment());\n  } else if (opt_uri && (m = goog.uri.utils.split(String(opt_uri)))) {\n    // Set the parts -- decoding as we do so.\n    // COMPATABILITY NOTE - In IE, unmatched fields may be empty strings,\n    // whereas in other browsers they will be undefined.\n    this.setScheme(m[goog.uri.utils.ComponentIndex.SCHEME] || '', true);\n    this.setUserInfo(m[goog.uri.utils.ComponentIndex.USER_INFO] || '', true);\n    this.setDomain(m[goog.uri.utils.ComponentIndex.DOMAIN] || '', true);\n    this.setPort(m[goog.uri.utils.ComponentIndex.PORT]);\n    this.setPath(m[goog.uri.utils.ComponentIndex.PATH] || '', true);\n    this.setQueryData(m[goog.uri.utils.ComponentIndex.QUERY_DATA] || '', true);\n    this.setFragment(m[goog.uri.utils.ComponentIndex.FRAGMENT] || '', true);\n  } else {\n    this.queryData_ = new goog.Uri.QueryData(null, null);\n  }\n};\n\n\n/**\n * Scheme such as \"http\".\n * @type {string}\n * @private\n */\ngoog.Uri.prototype.scheme_ = '';\n\n\n/**\n * User credentials in the form \"username:password\".\n * @type {string}\n * @private\n */\ngoog.Uri.prototype.userInfo_ = '';\n\n\n/**\n * Domain part, e.g. \"www.google.com\".\n * @type {string}\n * @private\n */\ngoog.Uri.prototype.domain_ = '';\n\n\n/**\n * Port, e.g. 8080.\n * @type {?number}\n * @private\n */\ngoog.Uri.prototype.port_ = null;\n\n\n/**\n * Path, e.g. \"/tests/img.png\".\n * @type {string}\n * @private\n */\ngoog.Uri.prototype.path_ = '';\n\n\n/**\n * Object representing query data.\n * @type {!goog.Uri.QueryData}\n * @private\n */\ngoog.Uri.prototype.queryData_;\n\n\n/**\n * The fragment without the #.\n * @type {string}\n * @private\n */\ngoog.Uri.prototype.fragment_ = '';\n\n\n/**\n * @return {string} The string form of the url.\n * @override\n */\ngoog.Uri.prototype.toString = function() {\n  var out = [];\n\n  var scheme = this.getScheme();\n  if (scheme) {\n    out.push(goog.Uri.encodeSpecialChars_(\n        scheme, goog.Uri.reDisallowedInSchemeOrUserInfo_, true), ':');\n  }\n\n  var domain = this.getDomain();\n  if (domain) {\n    out.push('//');\n\n    var userInfo = this.getUserInfo();\n    if (userInfo) {\n      out.push(goog.Uri.encodeSpecialChars_(\n          userInfo, goog.Uri.reDisallowedInSchemeOrUserInfo_, true), '@');\n    }\n\n    out.push(goog.Uri.removeDoubleEncoding_(encodeURIComponent(domain)));\n\n    var port = this.getPort();\n    if (port != null) {\n      out.push(':', String(port));\n    }\n  }\n\n  var path = this.getPath();\n  if (path) {\n    if (this.hasDomain() && path.charAt(0) != '/') {\n      out.push('/');\n    }\n    out.push(goog.Uri.encodeSpecialChars_(\n        path,\n        path.charAt(0) == '/' ?\n            goog.Uri.reDisallowedInAbsolutePath_ :\n            goog.Uri.reDisallowedInRelativePath_,\n        true));\n  }\n\n  var query = this.getEncodedQuery();\n  if (query) {\n    out.push('?', query);\n  }\n\n  var fragment = this.getFragment();\n  if (fragment) {\n    out.push('#', goog.Uri.encodeSpecialChars_(\n        fragment, goog.Uri.reDisallowedInFragment_));\n  }\n  return out.join('');\n};\n\n\n/**\n * Resolves the given relative URI (a goog.Uri object), using the URI\n * represented by this instance as the base URI.\n *\n * There are several kinds of relative URIs:<br>\n * 1. foo - replaces the last part of the path, the whole query and fragment<br>\n * 2. /foo - replaces the the path, the query and fragment<br>\n * 3. //foo - replaces everything from the domain on.  foo is a domain name<br>\n * 4. ?foo - replace the query and fragment<br>\n * 5. #foo - replace the fragment only\n *\n * Additionally, if relative URI has a non-empty path, all \"..\" and \".\"\n * segments will be resolved, as described in RFC 3986.\n *\n * @param {goog.Uri} relativeUri The relative URI to resolve.\n * @return {!goog.Uri} The resolved URI.\n */\ngoog.Uri.prototype.resolve = function(relativeUri) {\n\n  var absoluteUri = this.clone();\n  if (absoluteUri.scheme_ === 'data') {\n    // Cannot have a relative URI to a data URI.\n    absoluteUri = new goog.Uri();\n  }\n\n  // we satisfy these conditions by looking for the first part of relativeUri\n  // that is not blank and applying defaults to the rest\n\n  var overridden = relativeUri.hasScheme();\n\n  if (overridden) {\n    absoluteUri.setScheme(relativeUri.getScheme());\n  } else {\n    overridden = relativeUri.hasUserInfo();\n  }\n\n  if (overridden) {\n    absoluteUri.setUserInfo(relativeUri.getUserInfo());\n  } else {\n    overridden = relativeUri.hasDomain();\n  }\n\n  if (overridden) {\n    absoluteUri.setDomain(relativeUri.getDomain());\n  } else {\n    overridden = relativeUri.hasPort();\n  }\n\n  var path = relativeUri.getPath();\n  if (overridden) {\n    absoluteUri.setPort(relativeUri.getPort());\n  } else {\n    overridden = relativeUri.hasPath();\n    if (overridden) {\n      // resolve path properly\n      if (path.charAt(0) != '/') {\n        // path is relative\n        if (this.hasDomain() && !this.hasPath()) {\n          // RFC 3986, section 5.2.3, case 1\n          path = '/' + path;\n        } else {\n          // RFC 3986, section 5.2.3, case 2\n          var lastSlashIndex = absoluteUri.getPath().lastIndexOf('/');\n          if (lastSlashIndex != -1) {\n            path = absoluteUri.getPath().substr(0, lastSlashIndex + 1) + path;\n          }\n        }\n      }\n      path = goog.Uri.removeDotSegments(path);\n    }\n  }\n\n  if (overridden) {\n    absoluteUri.setPath(path);\n  } else {\n    overridden = relativeUri.hasQuery();\n  }\n\n  if (overridden) {\n    absoluteUri.setQueryData(relativeUri.getQueryData().clone());\n  } else {\n    overridden = relativeUri.hasFragment();\n  }\n\n  if (overridden) {\n    absoluteUri.setFragment(relativeUri.getFragment());\n  }\n\n  return absoluteUri;\n};\n\n\n/**\n * Clones the URI instance.\n * @return {!goog.Uri} New instance of the URI object.\n */\ngoog.Uri.prototype.clone = function() {\n  return new goog.Uri(this);\n};\n\n\n/**\n * @return {string} The encoded scheme/protocol for the URI.\n */\ngoog.Uri.prototype.getScheme = function() {\n  return this.scheme_;\n};\n\n\n/**\n * Sets the scheme/protocol.\n * @param {string} newScheme New scheme value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setScheme = function(newScheme, opt_decode) {\n  this.scheme_ = opt_decode ? goog.Uri.decodeOrEmpty_(newScheme, true) :\n      newScheme;\n\n  // remove an : at the end of the scheme so somebody can pass in\n  // window.location.protocol\n  if (this.scheme_) {\n    this.scheme_ = this.scheme_.replace(/:$/, '');\n  }\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the scheme has been set.\n */\ngoog.Uri.prototype.hasScheme = function() {\n  return !!this.scheme_;\n};\n\n\n/**\n * @return {string} The decoded user info.\n */\ngoog.Uri.prototype.getUserInfo = function() {\n  return this.userInfo_;\n};\n\n\n/**\n * Sets the userInfo.\n * @param {string} newUserInfo New userInfo value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setUserInfo = function(newUserInfo, opt_decode) {\n  this.userInfo_ = opt_decode ? goog.Uri.decodeOrEmpty_(newUserInfo) :\n                   newUserInfo;\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the user info has been set.\n */\ngoog.Uri.prototype.hasUserInfo = function() {\n  return !!this.userInfo_;\n};\n\n\n/**\n * @return {string} The decoded domain.\n */\ngoog.Uri.prototype.getDomain = function() {\n  return this.domain_;\n};\n\n\n/**\n * Sets the domain.\n * @param {string} newDomain New domain value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setDomain = function(newDomain, opt_decode) {\n  this.domain_ = opt_decode ? goog.Uri.decodeOrEmpty_(newDomain, true) :\n      newDomain;\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the domain has been set.\n */\ngoog.Uri.prototype.hasDomain = function() {\n  return !!this.domain_;\n};\n\n\n/**\n * @return {?number} The port number.\n */\ngoog.Uri.prototype.getPort = function() {\n  return this.port_;\n};\n\n\n/**\n * Sets the port number.\n * @param {*} newPort Port number. Will be explicitly casted to a number.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setPort = function(newPort) {\n  if (newPort) {\n    newPort = Number(newPort);\n    if (isNaN(newPort) || newPort < 0) {\n      throw Error('Bad port number ' + newPort);\n    }\n    this.port_ = newPort;\n  } else {\n    this.port_ = null;\n  }\n\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the port has been set.\n */\ngoog.Uri.prototype.hasPort = function() {\n  return this.port_ != null;\n};\n\n\n/**\n  * @return {string} The decoded path.\n */\ngoog.Uri.prototype.getPath = function() {\n  return this.path_;\n};\n\n\n/**\n * Sets the path.\n * @param {string} newPath New path value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setPath = function(newPath, opt_decode) {\n  this.path_ = opt_decode ? goog.Uri.decodeOrEmpty_(newPath, true) : newPath;\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the path has been set.\n */\ngoog.Uri.prototype.hasPath = function() {\n  return !!this.path_;\n};\n\n\n/**\n * @return {boolean} Whether the query string has been set.\n */\ngoog.Uri.prototype.hasQuery = function() {\n  return this.queryData_.toString() !== '';\n};\n\n\n/**\n * Sets the query data.\n * @param {goog.Uri.QueryData|string|undefined} queryData QueryData object.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n *     Applies only if queryData is a string.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setQueryData = function(queryData, opt_decode) {\n  if (queryData instanceof goog.Uri.QueryData) {\n    this.queryData_ = queryData;\n  } else {\n    if (!opt_decode) {\n      // QueryData accepts encoded query string, so encode it if\n      // opt_decode flag is not true.\n      queryData = goog.Uri.encodeSpecialChars_(queryData,\n                                               goog.Uri.reDisallowedInQuery_);\n    }\n    this.queryData_ = new goog.Uri.QueryData(queryData, null);\n  }\n\n  return this;\n};\n\n\n/**\n * @return {string} The encoded URI query, not including the ?.\n */\ngoog.Uri.prototype.getEncodedQuery = function() {\n  return this.queryData_.toString();\n};\n\n\n/**\n * @return {string} The decoded URI query, not including the ?.\n */\ngoog.Uri.prototype.getDecodedQuery = function() {\n  return this.queryData_.toDecodedString();\n};\n\n\n/**\n * Returns the query data.\n * @return {!goog.Uri.QueryData} QueryData object.\n */\ngoog.Uri.prototype.getQueryData = function() {\n  return this.queryData_;\n};\n\n\n/**\n * @return {string} The URI fragment, not including the #.\n */\ngoog.Uri.prototype.getFragment = function() {\n  return this.fragment_;\n};\n\n\n/**\n * Sets the URI fragment.\n * @param {string} newFragment New fragment value.\n * @param {boolean=} opt_decode Optional param for whether to decode new value.\n * @return {!goog.Uri} Reference to this URI object.\n */\ngoog.Uri.prototype.setFragment = function(newFragment, opt_decode) {\n  this.fragment_ = opt_decode ? goog.Uri.decodeOrEmpty_(newFragment) :\n                   newFragment;\n  return this;\n};\n\n\n/**\n * @return {boolean} Whether the URI has a fragment set.\n */\ngoog.Uri.prototype.hasFragment = function() {\n  return !!this.fragment_;\n};\n\n\n//==============================================================================\n// Static members\n//==============================================================================\n\n\n/**\n * Removes dot segments in given path component, as described in\n * RFC 3986, section 5.2.4.\n *\n * @param {string} path A non-empty path component.\n * @return {string} Path component with removed dot segments.\n */\ngoog.Uri.removeDotSegments = function(path) {\n  if (path == '..' || path == '.') {\n    return '';\n\n  } else if (path.indexOf('./') == -1 &&\n             path.indexOf('/.') == -1) {\n    // This optimization detects uris which do not contain dot-segments,\n    // and as a consequence do not require any processing.\n    return path;\n\n  } else {\n    var leadingSlash = (path.lastIndexOf('/', 0) == 0);\n    var segments = path.split('/');\n    var out = [];\n\n    for (var pos = 0; pos < segments.length; ) {\n      var segment = segments[pos++];\n\n      if (segment == '.') {\n        if (leadingSlash && pos == segments.length) {\n          out.push('');\n        }\n      } else if (segment == '..') {\n        if (out.length > 1 || out.length == 1 && out[0] != '') {\n          out.pop();\n        }\n        if (leadingSlash && pos == segments.length) {\n          out.push('');\n        }\n      } else {\n        out.push(segment);\n        leadingSlash = true;\n      }\n    }\n\n    return out.join('/');\n  }\n};\n\n\n/**\n * Decodes a value or returns the empty string if it isn't defined or empty.\n * @param {string|undefined} val Value to decode.\n * @param {boolean=} opt_preserveReserved If true, restricted characters will\n *     not be decoded.\n * @return {string} Decoded value.\n * @private\n */\ngoog.Uri.decodeOrEmpty_ = function(val, opt_preserveReserved) {\n  // Don't use UrlDecode() here because val is not a query parameter.\n  if (!val) {\n    return '';\n  }\n\n  return opt_preserveReserved ? decodeURI(val) : decodeURIComponent(val);\n};\n\n\n/**\n * If unescapedPart is non null, then escapes any characters in it that aren't\n * valid characters in a url and also escapes any special characters that\n * appear in extra.\n *\n * @param {*} unescapedPart The string to encode.\n * @param {RegExp} extra A character set of characters in [\\01-\\177].\n * @param {boolean=} opt_removeDoubleEncoding If true, remove double percent\n *     encoding.\n * @return {?string} null iff unescapedPart == null.\n * @private\n */\ngoog.Uri.encodeSpecialChars_ = function(unescapedPart, extra,\n    opt_removeDoubleEncoding) {\n  if (goog.isString(unescapedPart)) {\n    var encoded = encodeURI(unescapedPart).\n        replace(extra, goog.Uri.encodeChar_);\n    if (opt_removeDoubleEncoding) {\n      // encodeURI double-escapes %XX sequences used to represent restricted\n      // characters in some URI components, remove the double escaping here.\n      encoded = goog.Uri.removeDoubleEncoding_(encoded);\n    }\n    return encoded;\n  }\n  return null;\n};\n\n\n/**\n * Converts a character in [\\01-\\177] to its unicode character equivalent.\n * @param {string} ch One character string.\n * @return {string} Encoded string.\n * @private\n */\ngoog.Uri.encodeChar_ = function(ch) {\n  var n = ch.charCodeAt(0);\n  return '%' + ((n >> 4) & 0xf).toString(16) + (n & 0xf).toString(16);\n};\n\n\n/**\n * Removes double percent-encoding from a string.\n * @param  {string} doubleEncodedString String\n * @return {string} String with double encoding removed.\n * @private\n */\ngoog.Uri.removeDoubleEncoding_ = function(doubleEncodedString) {\n  return doubleEncodedString.replace(/%25([0-9a-fA-F]{2})/g, '%$1');\n};\n\n\n/**\n * Regular expression for characters that are disallowed in the scheme or\n * userInfo part of the URI.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInSchemeOrUserInfo_ = /[#\\/\\?@]/g;\n\n\n/**\n * Regular expression for characters that are disallowed in a relative path.\n * Colon is included due to RFC 3986 3.3.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInRelativePath_ = /[\\#\\?:]/g;\n\n\n/**\n * Regular expression for characters that are disallowed in an absolute path.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInAbsolutePath_ = /[\\#\\?]/g;\n\n\n/**\n * Regular expression for characters that are disallowed in the query.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInQuery_ = /[\\#\\?@]/g;\n\n\n/**\n * Regular expression for characters that are disallowed in the fragment.\n * @type {RegExp}\n * @private\n */\ngoog.Uri.reDisallowedInFragment_ = /#/g;\n\n\n\n/**\n * Class used to represent URI query parameters.  It is essentially a hash of\n * name-value pairs, though a name can be present more than once.\n *\n * Has the same interface as the collections in goog.structs.\n *\n * @param {?string=} opt_query Optional encoded query string to parse into\n *     the object.\n * @param {goog.Uri=} opt_uri Optional uri object that should have its\n *     cache invalidated when this object updates. Deprecated -- this\n *     is no longer required.\n * @constructor\n * @final\n */\ngoog.Uri.QueryData = function(opt_query, opt_uri) {\n  /**\n   * Encoded query string, or null if it requires computing from the key map.\n   * @type {?string}\n   * @private\n   */\n  this.encodedQuery_ = opt_query || null;\n};\n\n\n/**\n * If the underlying key map is not yet initialized, it parses the\n * query string and fills the map with parsed data.\n * @private\n */\ngoog.Uri.QueryData.prototype.ensureKeyMapInitialized_ = function() {\n  if (!this.keyMap_) {\n    this.keyMap_ = {};\n    this.count_ = 0;\n\n    if (this.encodedQuery_) {\n      var pairs = this.encodedQuery_.split('&');\n      for (var i = 0; i < pairs.length; i++) {\n        var indexOfEquals = pairs[i].indexOf('=');\n        var name = null;\n        var value = null;\n        if (indexOfEquals >= 0) {\n          name = pairs[i].substring(0, indexOfEquals);\n          value = pairs[i].substring(indexOfEquals + 1);\n        } else {\n          name = pairs[i];\n        }\n        name = decodeURIComponent(name.replace(/\\+/g, ' '));\n        value = value || '';\n        this.add(name, decodeURIComponent(value.replace(/\\+/g, ' ')));\n      }\n    }\n  }\n};\n\n\n/**\n * The map containing name/value or name/array-of-values pairs.\n * May be null if it requires parsing from the query string.\n *\n * We need to use a Map because we cannot guarantee that the key names will\n * not be problematic for IE.\n *\n * @type {Object.<string, !Array.<string>>}\n * @private\n */\ngoog.Uri.QueryData.prototype.keyMap_ = null;\n\n\n/**\n * The number of params, or null if it requires computing.\n * @type {?number}\n * @private\n */\ngoog.Uri.QueryData.prototype.count_ = null;\n\n\n/**\n * @return {?number} The number of parameters.\n */\ngoog.Uri.QueryData.prototype.getCount = function() {\n  this.ensureKeyMapInitialized_();\n  return this.count_;\n};\n\n\n/**\n * Adds a key value pair.\n * @param {string} key Name.\n * @param {*} value Value.\n * @return {!goog.Uri.QueryData} Instance of this object.\n */\ngoog.Uri.QueryData.prototype.add = function(key, value) {\n  this.ensureKeyMapInitialized_();\n  // Invalidate the cache.\n  this.encodedQuery_ = null;\n\n  var values = this.keyMap_.hasOwnProperty(key) && this.keyMap_[key];\n  if (!values) {\n    this.keyMap_[key] = (values = []);\n  }\n  values.push(value);\n  this.count_++;\n  return this;\n};\n\n\n/**\n * @return {string} Encoded query string.\n * @override\n */\ngoog.Uri.QueryData.prototype.toString = function() {\n  if (this.encodedQuery_) {\n    return this.encodedQuery_;\n  }\n\n  if (!this.keyMap_) {\n    return '';\n  }\n\n  var sb = [];\n\n  for (var key in this.keyMap_) {\n    var encodedKey = encodeURIComponent(key);\n    var val = this.keyMap_[key];\n    for (var j = 0; j < val.length; j++) {\n      var param = encodedKey;\n      // Ensure that null and undefined are encoded into the url as\n      // literal strings.\n      if (val[j] !== '') {\n        param += '=' + encodeURIComponent(val[j]);\n      }\n      sb.push(param);\n    }\n  }\n\n  return this.encodedQuery_ = sb.join('&');\n};\n\n\n/**\n * @return {string} Decoded query string.\n */\ngoog.Uri.QueryData.prototype.toDecodedString = function() {\n  return goog.Uri.decodeOrEmpty_(this.toString());\n};\n\n\n/**\n * Clone the query data instance.\n * @return {!goog.Uri.QueryData} New instance of the QueryData object.\n */\ngoog.Uri.QueryData.prototype.clone = function() {\n  var rv = new goog.Uri.QueryData();\n  rv.encodedQuery_ = this.encodedQuery_;\n  if (this.keyMap_) {\n    var cloneMap = {};\n    for (var key in this.keyMap_) {\n      cloneMap[key] = this.keyMap_[key].concat();\n    }\n    rv.keyMap_ = cloneMap;\n    rv.count_ = this.count_;\n  }\n  return rv;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/third_party/closure/goog/uri/uri.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.Functional');\n\n\n/**\n * @namespace shaka.util.Functional\n * @summary A set of functional utility functions.\n */\n\n\n/**\n * Creates a promise chain that calls the given callback for each element in\n * the array in a catch of a promise.\n *\n * e.g.:\n * Promise.reject().catch(callback(array[0])).catch(callback(array[1]));\n *\n * @param {!Array.<ELEM>} array\n * @param {function(ELEM):!Promise.<RESULT>} callback\n * @return {!Promise.<RESULT>}\n * @template ELEM,RESULT\n */\nshaka.util.Functional.createFallbackPromiseChain = function(array, callback) {\n  return array.reduce(function(callback, promise, elem) {\n    return promise.catch(callback.bind(null, elem));\n  }.bind(null, callback), Promise.reject());\n};\n\n\n/**\n * Returns the first array concatenated to the second; used to collapse an\n * array of arrays into a single array.\n *\n * @param {!Array.<T>} all\n * @param {!Array.<T>} part\n * @return {!Array.<T>}\n * @template T\n */\nshaka.util.Functional.collapseArrays = function(all, part) {\n  return all.concat(part);\n};\n\n\n/**\n * A no-op function.  Useful in promise chains.\n */\nshaka.util.Functional.noop = function() {};\n\n\n/**\n * Returns if the given value is not null; useful for filtering out null values.\n *\n * @param {T} value\n * @return {boolean}\n * @template T\n */\nshaka.util.Functional.isNotNull = function(value) {\n  return value != null;\n};\n\n\n/**\n * Creates a function that returns whether the given value is equal to the given\n * value.\n *\n * @param {T} compare\n * @return {function(T):boolean}\n * @template T\n */\nshaka.util.Functional.isEqualFunc = function(compare) {\n  return function(a) { return a == compare; };\n};\n\n\n/**\n * Creates a function that returns whether the given value is not equal to the\n * given value.\n *\n * @param {T} compare\n * @return {function(T):boolean}\n * @template T\n */\nshaka.util.Functional.isNotEqualFunc = function(compare) {\n  return function(a) { return a != compare; };\n};\n\n\n/**\n * Used to filter out duplicates in an array.\n * Returns true the first time the element is encountered. Returns false\n * for all the subsequent encounters.\n *\n * @param {T} item\n * @param {number} position\n * @param {!Array.<T>} self\n * @return {boolean}\n * @template T\n * @example [1, 1, 2].filter(shaka.util.Functional.isNotDuplicate) -> [1, 2]\n */\nshaka.util.Functional.isNotDuplicate = function(item, position, self) {\n  return self.indexOf(item) == position;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/functional.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.ManifestParserUtils');\n\ngoog.require('goog.Uri');\ngoog.require('shaka.util.Functional');\n\n\n/**\n * @namespace shaka.util.ManifestParserUtils\n * @summary Utility functions for manifest parsing.\n */\n\n\n/**\n * Resolves an array of relative URIs to the given base URIs. This will result\n * in M*N number of URIs.\n *\n * @param {!Array.<string>} baseUris\n * @param {!Array.<string>} relativeUris\n * @return {!Array.<string>}\n */\nshaka.util.ManifestParserUtils.resolveUris = function(baseUris, relativeUris) {\n  var Functional = shaka.util.Functional;\n  if (relativeUris.length == 0)\n    return baseUris;\n\n  var relativeAsGoog =\n      relativeUris.map(function(uri) { return new goog.Uri(uri); });\n  // Resolve each URI relative to each base URI, creating an Array of Arrays.\n  // Then flatten the Arrays into a single Array.\n  return baseUris.map(function(uri) { return new goog.Uri(uri); })\n    .map(function(base) { return relativeAsGoog.map(base.resolve.bind(base)); })\n    .reduce(Functional.collapseArrays, [])\n    .map(function(uri) { return uri.toString(); });\n};\n\n\n/**\n * Creates a DrmInfo object from the given info.\n *\n * @param {string} keySystem\n * @param {Array.<shakaExtern.InitDataOverride>} initData\n * @return {shakaExtern.DrmInfo}\n */\nshaka.util.ManifestParserUtils.createDrmInfo = function(keySystem, initData) {\n  return {\n    keySystem: keySystem,\n    licenseServerUri: '',\n    distinctiveIdentifierRequired: false,\n    persistentStateRequired: false,\n    audioRobustness: '',\n    videoRobustness: '',\n    serverCertificate: null,\n    initData: initData || [],\n    keyIds: []\n  };\n};\n\n\n/**\n * @enum {string}\n */\nshaka.util.ManifestParserUtils.ContentType = {\n  VIDEO: 'video',\n  AUDIO: 'audio',\n  TEXT: 'text',\n  APPLICATION: 'application'\n};\n\n\n/**\n * @enum {string}\n */\nshaka.util.ManifestParserUtils.TextStreamKind = {\n  SUBTITLE: 'subtitle',\n  CLOSED_CAPTION: 'caption'\n};\n\n\n/**\n * Specifies how tolerant the player is to inaccurate segment start times and\n * end times within a manifest. For example, gaps or overlaps between segments\n * in a SegmentTimeline which are greater than or equal to this value will\n * result in a warning message.\n *\n * @const {number}\n */\nshaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS = 1 / 15;\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/manifest_parser_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.ConfigUtils');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\n\n\n/**\n * @param {!Object} destination\n * @param {!Object} source\n * @param {!Object} template supplies default values\n * @param {!Object} overrides\n *   Supplies override type checking.  When the current path matches the key in\n *   this object, each sub-value must match the type in this object.  If this\n *   contains an Object, it is used as the template.\n * @param {string} path to this part of the config\n */\nshaka.util.ConfigUtils.mergeConfigObjects =\n    function(destination, source, template, overrides, path) {\n  goog.asserts.assert(destination, 'Destination config must not be null!');\n\n  /**\n   * @type {boolean}\n   * If true, don't validate the keys in the next level.\n   */\n  var ignoreKeys = path in overrides;\n\n  for (var k in source) {\n    var subPath = path + '.' + k;\n    var subTemplate = ignoreKeys ? overrides[path] : template[k];\n\n    /**\n     * @type {boolean}\n     * If true, simply copy the object over and don't verify.\n     */\n    var copyObject = !!({\n      '.abr.manager': true\n    })[subPath] || !!({\n      'serverCertificate': true\n    })[k];\n\n    // The order of these checks is important.\n    if (!ignoreKeys && !(k in destination)) {\n      shaka.log.error('Invalid config, unrecognized key ' + subPath);\n    } else if (source[k] === undefined) {\n      // An explicit 'undefined' value causes the key to be deleted from the\n      // destination config and replaced with a default from the template if\n      // possible.\n      if (subTemplate === undefined || ignoreKeys) {\n        delete destination[k];\n      } else {\n        destination[k] = subTemplate;\n      }\n    } else if (copyObject) {\n      destination[k] = source[k];\n    } else if (typeof destination[k] == 'object' &&\n               typeof source[k] == 'object') {\n      shaka.util.ConfigUtils.mergeConfigObjects(\n          destination[k], source[k], subTemplate, overrides, subPath);\n    } else if (typeof source[k] != typeof subTemplate) {\n      shaka.log.error('Invalid config, wrong type for ' + subPath);\n    } else if (typeof destination[k] == 'function' &&\n               destination[k].length != source[k].length) {\n      shaka.log.warning(\n          'Invalid config, wrong number of arguments for ' + subPath);\n      destination[k] = source[k];\n    } else {\n      destination[k] = source[k];\n    }\n  }\n};\n\n\n/**\n * Performs a deep clone of the given simple object.  This does not copy\n * prototypes, custom properties (e.g. read-only), or multiple references to\n * the same object.  This uses JSON to clone.\n *\n * @template T\n * @param {T} arg\n * @return {T}\n */\nshaka.util.ConfigUtils.cloneObject = function(arg) {\n  return JSON.parse(JSON.stringify(arg));\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/config_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.PublicPromise');\n\n\n\n/**\n * A utility to create Promises with convenient public resolve and reject\n * methods.\n *\n * @constructor\n * @struct\n * @extends {Promise.<T>}\n * @return {Promise.<T>}\n * @template T\n */\nshaka.util.PublicPromise = function() {\n  var resolvePromise;\n  var rejectPromise;\n\n  // Promise.call causes an error.  It seems that inheriting from a native\n  // Promise is not permitted by JavaScript interpreters.\n\n  // The work-around is to construct a Promise object, modify it to look like\n  // the compiler's picture of PublicPromise, then return it.  The caller of\n  // new PublicPromise will receive |promise| instead of |this|, and the\n  // compiler will be aware of the additional properties |resolve| and\n  // |reject|.\n\n  var promise = new Promise(function(resolve, reject) {\n    resolvePromise = resolve;\n    rejectPromise = reject;\n  });\n\n  promise.resolve = resolvePromise;\n  promise.reject = rejectPromise;\n\n  return promise;\n};\n\n\n/** @type {function(T=)} */\nshaka.util.PublicPromise.prototype.resolve;\n\n\n/** @type {function(*=)} */\nshaka.util.PublicPromise.prototype.reject;\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/public_promise.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.net.NetworkingEngine');\n\ngoog.require('goog.Uri');\ngoog.require('goog.asserts');\ngoog.require('shaka.util.ConfigUtils');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.PublicPromise');\n\n\n\n/**\n * NetworkingEngine wraps all networking operations.  This accepts plugins that\n * handle the actual request.  A plugin is registered using registerScheme.\n * Each scheme has at most one plugin to handle the request.\n *\n * @param {function(number, number)=} opt_onSegmentDownloaded Called\n *   when a segment is downloaded. Passed the duration, in milliseconds, that\n *   the request took; and the total number of bytes transferred.\n *\n * @struct\n * @constructor\n * @implements {shaka.util.IDestroyable}\n * @export\n */\nshaka.net.NetworkingEngine = function(opt_onSegmentDownloaded) {\n  /** @private {boolean} */\n  this.destroyed_ = false;\n\n  /** @private {!Array.<!Promise>} */\n  this.requests_ = [];\n\n  /** @private {!Array.<shakaExtern.RequestFilter>} */\n  this.requestFilters_ = [];\n\n  /** @private {!Array.<shakaExtern.ResponseFilter>} */\n  this.responseFilters_ = [];\n\n  /** @private {?function(number, number)} */\n  this.onSegmentDownloaded_ = opt_onSegmentDownloaded || null;\n};\n\n\n/**\n * Request types.  Allows a filter to decide which requests to read/alter.\n *\n * @enum {number}\n * @export\n */\nshaka.net.NetworkingEngine.RequestType = {\n  'MANIFEST': 0,\n  'SEGMENT': 1,\n  'LICENSE': 2,\n  'APP': 3\n};\n\n\n/**\n * Contains the scheme plugins.\n *\n * @private {!Object.<string, ?shakaExtern.SchemePlugin>}\n */\nshaka.net.NetworkingEngine.schemes_ = {};\n\n\n/**\n * Registers a scheme plugin.  This plugin will handle all requests with the\n * given scheme.  If a plugin with the same scheme already exists, it is\n * replaced.\n *\n * @param {string} scheme\n * @param {shakaExtern.SchemePlugin} plugin\n * @export\n */\nshaka.net.NetworkingEngine.registerScheme = function(scheme, plugin) {\n  shaka.net.NetworkingEngine.schemes_[scheme] = plugin;\n};\n\n\n/**\n * Removes a scheme plugin.\n *\n * @param {string} scheme\n * @export\n */\nshaka.net.NetworkingEngine.unregisterScheme = function(scheme) {\n  delete shaka.net.NetworkingEngine.schemes_[scheme];\n};\n\n\n/**\n * Registers a new request filter.  All filters are applied in the order they\n * are registered.\n *\n * @param {shakaExtern.RequestFilter} filter\n * @export\n */\nshaka.net.NetworkingEngine.prototype.registerRequestFilter = function(filter) {\n  this.requestFilters_.push(filter);\n};\n\n\n/**\n * Removes a request filter.\n *\n * @param {shakaExtern.RequestFilter} filter\n * @export\n */\nshaka.net.NetworkingEngine.prototype.unregisterRequestFilter =\n    function(filter) {\n  var filters = this.requestFilters_;\n  var i = filters.indexOf(filter);\n  if (i >= 0) {\n    filters.splice(i, 1);\n  }\n};\n\n\n/**\n * Clear all request filters.\n *\n * @export\n */\nshaka.net.NetworkingEngine.prototype.clearAllRequestFilters = function() {\n  this.requestFilters_ = [];\n};\n\n\n/**\n * Registers a new response filter.  All filters are applied in the order they\n * are registered.\n *\n * @param {shakaExtern.ResponseFilter} filter\n * @export\n */\nshaka.net.NetworkingEngine.prototype.registerResponseFilter = function(filter) {\n  this.responseFilters_.push(filter);\n};\n\n\n/**\n * Removes a response filter.\n *\n * @param {shakaExtern.ResponseFilter} filter\n * @export\n */\nshaka.net.NetworkingEngine.prototype.unregisterResponseFilter =\n    function(filter) {\n  var filters = this.responseFilters_;\n  var i = filters.indexOf(filter);\n  if (i >= 0) {\n    filters.splice(i, 1);\n  }\n};\n\n\n/**\n * Clear all response filters.\n *\n * @export\n */\nshaka.net.NetworkingEngine.prototype.clearAllResponseFilters = function() {\n  this.responseFilters_ = [];\n};\n\n\n/**\n * Gets a copy of the default retry parameters.\n *\n * @return {shakaExtern.RetryParameters}\n */\nshaka.net.NetworkingEngine.defaultRetryParameters = function() {\n  // Use a function rather than a constant member so the calling code can\n  // modify the values without affecting other call results.\n  return {\n    maxAttempts: 2,\n    baseDelay: 1000,\n    backoffFactor: 2,\n    fuzzFactor: 0.5,\n    timeout: 0\n  };\n};\n\n\n/**\n * Makes a simple network request for the given URIs.\n *\n * @param {!Array.<string>} uris\n * @param {shakaExtern.RetryParameters} retryParams\n * @return {shakaExtern.Request}\n */\nshaka.net.NetworkingEngine.makeRequest = function(\n    uris, retryParams) {\n  return {\n    uris: uris,\n    method: 'GET',\n    body: null,\n    headers: {},\n    allowCrossSiteCredentials: false,\n    retryParameters: retryParams\n  };\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.net.NetworkingEngine.prototype.destroy = function() {\n  var Functional = shaka.util.Functional;\n  this.destroyed_ = true;\n  this.requestFilters_ = [];\n  this.responseFilters_ = [];\n\n  var cleanup = [];\n  for (var i = 0; i < this.requests_.length; ++i) {\n    cleanup.push(this.requests_[i].catch(Functional.noop));\n  }\n  return Promise.all(cleanup);\n};\n\n\n/**\n * Makes a network request and returns the resulting data.\n *\n * @param {shaka.net.NetworkingEngine.RequestType} type\n * @param {shakaExtern.Request} request\n * @return {!Promise.<shakaExtern.Response>}\n * @export\n */\nshaka.net.NetworkingEngine.prototype.request = function(type, request) {\n  var cloneObject = shaka.util.ConfigUtils.cloneObject;\n\n  // New requests made after destroy is called are rejected.\n  if (this.destroyed_)\n    return Promise.reject();\n\n  goog.asserts.assert(request.uris && request.uris.length,\n                      'Request without URIs!');\n\n  // If a request comes from outside the library, some parameters may be left\n  // undefined.  To make it easier for application developers, we will fill them\n  // in with defaults if necessary.\n  //\n  // We clone retryParameters and uris so that if a filter modifies the request,\n  // then it doesn't contaminate future requests.\n  request.method = request.method || 'GET';\n  request.headers = request.headers || {};\n  request.retryParameters = request.retryParameters ?\n      cloneObject(request.retryParameters) :\n      shaka.net.NetworkingEngine.defaultRetryParameters();\n  request.uris = cloneObject(request.uris);\n\n  var filterStartMs = Date.now();\n\n  // Send to the filter first, in-case they change the URI.\n  var p = Promise.resolve();\n  this.requestFilters_.forEach(function(requestFilter) {\n    // Request filters are resolved sequentially.\n    p = p.then(requestFilter.bind(null, type, request));\n  });\n\n  // Catch any errors thrown by request filters, and substitute\n  // them with a Shaka-native error.\n  p = p.catch(function(e) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.NETWORK,\n        shaka.util.Error.Code.REQUEST_FILTER_ERROR, e);\n  });\n\n  // Send out the request, and get a response.\n  // The entire code is inside a then clause; thus, if a filter\n  // rejects or errors, the networking engine will never send.\n  p = p.then(function() {\n    var filterTimeMs = (Date.now() - filterStartMs);\n\n    var retry = request.retryParameters || {};\n    var maxAttempts = retry.maxAttempts || 1;\n    var backoffFactor = retry.backoffFactor || 2.0;\n    var delay = (retry.baseDelay == null ? 1000 : retry.baseDelay);\n\n    var p = this.send_(type, request, 0, filterTimeMs);\n    for (var i = 1; i < maxAttempts; i++) {\n      var index = i % request.uris.length;\n      p = p.catch(function(delay, index, err) {\n        if (err && err.severity == shaka.util.Error.Severity.RECOVERABLE)\n          return this.resend_(type, request, delay, index, filterTimeMs);\n        throw err;\n      }.bind(this, delay, index));\n      delay *= backoffFactor;\n    }\n\n    return p;\n  }.bind(this));\n\n  // Add the request to the array.\n  this.requests_.push(p);\n  return p.then(function(response) {\n    if (this.requests_.indexOf(p) >= 0) {\n      this.requests_.splice(this.requests_.indexOf(p), 1);\n    }\n    if (this.onSegmentDownloaded_ && !response.fromCache &&\n        type == shaka.net.NetworkingEngine.RequestType.SEGMENT) {\n      this.onSegmentDownloaded_(response.timeMs, response.data.byteLength);\n    }\n    return response;\n  }.bind(this)).catch(function(e) {\n    // Ignore if using |Promise.reject()| to signal destroy.\n    if (e) {\n      goog.asserts.assert(e instanceof shaka.util.Error, 'Wrong error type');\n      e.severity = shaka.util.Error.Severity.CRITICAL;\n    }\n\n    if (this.requests_.indexOf(p) >= 0) {\n      this.requests_.splice(this.requests_.indexOf(p), 1);\n    }\n    return Promise.reject(e);\n  }.bind(this));\n};\n\n\n/**\n * Sends the given request to the correct plugin.  This does not handle retry.\n *\n * @param {shaka.net.NetworkingEngine.RequestType} type\n * @param {shakaExtern.Request} request\n * @param {number} index\n * @param {number} requestFilterTime\n * @return {!Promise.<shakaExtern.Response>}\n * @private\n */\nshaka.net.NetworkingEngine.prototype.send_ = function(\n    type, request, index, requestFilterTime) {\n  // Retries sent after destroy is called are rejected.\n  if (this.destroyed_)\n    return Promise.reject();\n\n  var uri = new goog.Uri(request.uris[index]);\n  var scheme = uri.getScheme();\n\n  if (!scheme) {\n    // If there is no scheme, infer one from the location.\n    scheme = shaka.net.NetworkingEngine.getLocationProtocol_();\n    goog.asserts.assert(scheme[scheme.length - 1] == ':',\n                        'location.protocol expected to end with a colon!');\n    // Drop the colon.\n    scheme = scheme.slice(0, -1);\n\n    // Override the original URI to make the scheme explicit.\n    uri.setScheme(scheme);\n    request.uris[index] = uri.toString();\n  }\n\n  var plugin = shaka.net.NetworkingEngine.schemes_[scheme];\n  if (!plugin) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.NETWORK,\n        shaka.util.Error.Code.UNSUPPORTED_SCHEME,\n        uri));\n  }\n\n  var startTimeMs = Date.now();\n  return plugin(request.uris[index], request, type).then(function(response) {\n    if (response.timeMs == undefined)\n      response.timeMs = Date.now() - startTimeMs;\n    var filterStartMs = Date.now();\n\n    var p = Promise.resolve();\n    this.responseFilters_.forEach(function(responseFilter) {\n      // Response filters are resolved sequentially.\n      p = p.then(function() {\n        return Promise.resolve(responseFilter(type, response));\n      }.bind(this));\n    });\n\n    // Catch any errors thrown by response filters, and substitute\n    // them with a Shaka-native error.\n    p = p.catch(function(e) {\n      var severity = shaka.util.Error.Severity.CRITICAL;\n      if (e instanceof shaka.util.Error)\n        severity = e.severity;\n\n      throw new shaka.util.Error(\n          severity,\n          shaka.util.Error.Category.NETWORK,\n          shaka.util.Error.Code.RESPONSE_FILTER_ERROR, e);\n    });\n\n    return p.then(function() {\n      response.timeMs += Date.now() - filterStartMs;\n      response.timeMs += requestFilterTime;\n\n      return response;\n    });\n  }.bind(this));\n};\n\n\n/**\n * Resends the request after applying a delay.  This does not handle retry.\n *\n * @param {shaka.net.NetworkingEngine.RequestType} type\n * @param {shakaExtern.Request} request\n * @param {number} delayMs The current base delay.\n * @param {number} index\n * @param {number} requestFilterTime\n * @return {!Promise.<shakaExtern.Response>}\n * @private\n */\nshaka.net.NetworkingEngine.prototype.resend_ =\n    function(type, request, delayMs, index, requestFilterTime) {\n  var p = new shaka.util.PublicPromise();\n\n  // Fuzz the delay to avoid tons of clients hitting the server at once\n  // after it recovers from whatever is causing it to fail.\n  var retry = request.retryParameters || {};\n  var fuzzFactor = (retry.fuzzFactor == null ? 0.5 : retry.fuzzFactor);\n  var negToPosOne = (Math.random() * 2.0) - 1.0;\n  var negToPosFuzzFactor = negToPosOne * fuzzFactor;\n  var fuzzedDelay = delayMs * (1.0 + negToPosFuzzFactor);\n  shaka.net.NetworkingEngine.setTimeout_(p.resolve, fuzzedDelay);\n\n  return p.then(this.send_.bind(this, type, request, index, requestFilterTime));\n};\n\n\n/**\n * This is here only for testability.  We can't mock location in our tests on\n * all browsers, so instead we mock this.\n *\n * @return {string} The value of location.protocol.\n * @private\n */\nshaka.net.NetworkingEngine.getLocationProtocol_ = function() {\n  return location.protocol;\n};\n\n\n/**\n * This is here only for testability.  Mocking global setTimeout can lead to\n * unintended interactions with other tests.  So instead, we mock this.\n *\n * @param {Function} fn The callback to invoke when the timeout expires.\n * @param {number} timeoutMs The timeout in milliseconds.\n * @return {number} The timeout ID.\n * @private\n */\nshaka.net.NetworkingEngine.setTimeout_ = function(fn, timeoutMs) {\n  return window.setTimeout(fn, timeoutMs);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/net/networking_engine.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.ArrayUtils');\n\n\n/**\n * @namespace shaka.util.ArrayUtils\n * @summary Array utility functions.\n */\n\n\n/**\n * Remove duplicate entries from an array.  Order N^2, so use with caution.\n * @param {!Array.<T>} array\n * @param {function(T, T): boolean=} opt_compareFn An optional function which\n *   will be used to compare items in the array.\n * @return {!Array.<T>}\n * @template T\n */\nshaka.util.ArrayUtils.removeDuplicates = function(array, opt_compareFn) {\n  var result = [];\n  for (var i = 0; i < array.length; ++i) {\n    var matchFound = false;\n    for (var j = 0; j < result.length; ++j) {\n      matchFound = opt_compareFn ? opt_compareFn(array[i], result[j]) :\n                                   array[i] === result[j];\n      if (matchFound) break;\n    }\n    if (!matchFound) {\n      result.push(array[i]);\n    }\n  }\n  return result;\n};\n\n\n/**\n * Find an item in an array.  For use when comparison of entries via == will\n * not suffice.\n * @param {!Array.<T>} array\n * @param {T} value\n * @param {function(T, T): boolean} compareFn A function which will be used to\n *   compare items in the array.\n * @return {number} The index, or -1 if not found.\n * @template T\n */\nshaka.util.ArrayUtils.indexOf = function(array, value, compareFn) {\n  for (var i = 0; i < array.length; ++i) {\n    if (compareFn(array[i], value)) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/array_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.MultiMap');\n\n\n\n/**\n * A simple multimap template.\n * @constructor\n * @struct\n * @template T\n */\nshaka.util.MultiMap = function() {\n  /** @private {!Object.<string, !Array.<T>>} */\n  this.map_ = {};\n};\n\n\n/**\n * Add a key, value pair to the map.\n * @param {string} key\n * @param {T} value\n */\nshaka.util.MultiMap.prototype.push = function(key, value) {\n  if (this.map_.hasOwnProperty(key)) {\n    this.map_[key].push(value);\n  } else {\n    this.map_[key] = [value];\n  }\n};\n\n\n/**\n * Get a list of values by key.\n * @param {string} key\n * @return {Array.<T>} or null if no such key exists.\n */\nshaka.util.MultiMap.prototype.get = function(key) {\n  var list = this.map_[key];\n  // slice() clones the list so that it and the map can each be modified\n  // without affecting the other.\n  return list ? list.slice() : null;\n};\n\n\n/**\n * Get a list of all values.\n * @return {!Array.<T>}\n */\nshaka.util.MultiMap.prototype.getAll = function() {\n  var list = [];\n  for (var key in this.map_) {\n    list.push.apply(list, this.map_[key]);\n  }\n  return list;\n};\n\n\n/**\n * Remove a specific value, if it exists.\n * @param {string} key\n * @param {T} value\n */\nshaka.util.MultiMap.prototype.remove = function(key, value) {\n  var list = this.map_[key];\n  if (!list) return;\n  for (var i = 0; i < list.length; ++i) {\n    if (list[i] == value) {\n      list.splice(i, 1);\n      --i;\n    }\n  }\n};\n\n\n/**\n * Clear all keys and values from the multimap.\n */\nshaka.util.MultiMap.prototype.clear = function() {\n  this.map_ = {};\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/multi_map.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.EventManager');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.MultiMap');\n\n\n\n/**\n * Creates a new EventManager. An EventManager maintains a collection of \"event\n * bindings\" between event targets and event listeners.\n *\n * @struct\n * @constructor\n * @implements {shaka.util.IDestroyable}\n */\nshaka.util.EventManager = function() {\n  /**\n   * Maps an event type to an array of event bindings.\n   * @private {shaka.util.MultiMap.<!shaka.util.EventManager.Binding_>}\n   */\n  this.bindingMap_ = new shaka.util.MultiMap();\n};\n\n\n/**\n * @typedef {function(!Event)}\n */\nshaka.util.EventManager.ListenerType;\n\n\n/**\n * Detaches all event listeners.\n * @override\n */\nshaka.util.EventManager.prototype.destroy = function() {\n  this.removeAll();\n  this.bindingMap_ = null;\n  return Promise.resolve();\n};\n\n\n/**\n * Attaches an event listener to an event target.\n * @param {EventTarget} target The event target.\n * @param {string} type The event type.\n * @param {shaka.util.EventManager.ListenerType} listener The event listener.\n */\nshaka.util.EventManager.prototype.listen = function(target, type, listener) {\n  if (!this.bindingMap_) return;\n\n  var binding = new shaka.util.EventManager.Binding_(target, type, listener);\n  this.bindingMap_.push(type, binding);\n};\n\n\n/**\n * Attaches an event listener to an event target.  The listener will be removed\n * when the first instance of the event is fired.\n * @param {EventTarget} target The event target.\n * @param {string} type The event type.\n * @param {shaka.util.EventManager.ListenerType} listener The event listener.\n */\nshaka.util.EventManager.prototype.listenOnce =\n    function(target, type, listener) {\n  // Install a shim listener that will stop listening after the first event.\n  this.listen(target, type, function(event) {\n    // Stop listening to this event.\n    this.unlisten(target, type);\n    // Call the original listener.\n    listener(event);\n  }.bind(this));\n};\n\n\n/**\n * Detaches an event listener from an event target.\n * @param {EventTarget} target The event target.\n * @param {string} type The event type.\n */\nshaka.util.EventManager.prototype.unlisten = function(target, type) {\n  if (!this.bindingMap_) return;\n\n  var list = this.bindingMap_.get(type) || [];\n\n  for (var i = 0; i < list.length; ++i) {\n    var binding = list[i];\n\n    if (binding.target == target) {\n      binding.unlisten();\n      this.bindingMap_.remove(type, binding);\n    }\n  }\n};\n\n\n/**\n * Detaches all event listeners from all targets.\n */\nshaka.util.EventManager.prototype.removeAll = function() {\n  if (!this.bindingMap_) return;\n\n  var list = this.bindingMap_.getAll();\n\n  for (var i = 0; i < list.length; ++i) {\n    list[i].unlisten();\n  }\n\n  this.bindingMap_.clear();\n};\n\n\n\n/**\n * Creates a new Binding_ and attaches the event listener to the event target.\n * @param {EventTarget} target The event target.\n * @param {string} type The event type.\n * @param {shaka.util.EventManager.ListenerType} listener The event listener.\n * @constructor\n * @private\n */\nshaka.util.EventManager.Binding_ = function(target, type, listener) {\n  /** @type {EventTarget} */\n  this.target = target;\n\n  /** @type {string} */\n  this.type = type;\n\n  /** @type {?shaka.util.EventManager.ListenerType} */\n  this.listener = listener;\n\n  this.target.addEventListener(type, listener, false);\n};\n\n\n/**\n * Detaches the event listener from the event target. This does nothing if the\n * event listener is already detached.\n */\nshaka.util.EventManager.Binding_.prototype.unlisten = function() {\n  goog.asserts.assert(this.target, 'Missing target');\n  this.target.removeEventListener(this.type, this.listener, false);\n\n  this.target = null;\n  this.listener = null;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/event_manager.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.MapUtils');\n\n\n/**\n * @namespace shaka.util.MapUtils\n * @summary A set of map/object utility functions.\n */\n\n\n/**\n * Returns true if the map is empty; otherwise, returns false.\n *\n * @param {Object.<KEY, VALUE>} object\n * @return {boolean}\n * @template KEY,VALUE\n */\nshaka.util.MapUtils.empty = function(object) {\n  return !object || Object.keys(object).length == 0;\n};\n\n\n/**\n * Gets the map's values.\n *\n * @param {!Object.<KEY, VALUE>} object\n * @return {!Array.<VALUE>}\n * @template KEY,VALUE\n */\nshaka.util.MapUtils.values = function(object) {\n  return Object.keys(object).map(function(key) { return object[key]; });\n};\n\n\n/**\n * Converts the values in the given Map to a different value.\n *\n * @param {!Object.<KEY, VALUE>} object\n * @param {function(VALUE, KEY=):OUTPUT} callback\n * @return {!Object.<KEY, OUTPUT>}\n * @template KEY,VALUE,OUTPUT\n */\nshaka.util.MapUtils.map = function(object, callback) {\n  return Object.keys(object).reduce(function(ret, key) {\n    var value = object[key];\n    ret[key] = callback(value, key);\n    return ret;\n  }, {});\n};\n\n\n/**\n * Returns true if every entry matches the predicate.\n *\n * @param {!Object.<KEY, VALUE>} object\n * @param {function(KEY, VALUE):boolean} callback\n * @return {boolean}\n * @template KEY,VALUE\n */\nshaka.util.MapUtils.every = function(object, callback) {\n  return Object.keys(object).every(function(key) {\n    return callback(key, object[key]);\n  });\n};\n\n\n/**\n * Invokes the callback for each entry in the map.\n *\n * @param {!Object.<KEY, VALUE>} object\n * @param {function(KEY, VALUE)} callback\n * @template KEY,VALUE\n */\nshaka.util.MapUtils.forEach = function(object, callback) {\n  Object.keys(object).forEach(function(key) {\n    callback(key, object[key]);\n  });\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/map_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.StringUtils');\n\ngoog.require('shaka.log');\ngoog.require('shaka.util.Error');\n\n\n/**\n * @namespace shaka.util.StringUtils\n * @summary A set of string utility functions.\n * @exportDoc\n */\n\n\n/**\n * Creates a string from the given buffer as UTF-8 encoding.\n *\n * @param {?BufferSource} data\n * @return {string}\n * @throws {shaka.util.Error}\n * @export\n */\nshaka.util.StringUtils.fromUTF8 = function(data) {\n  if (!data) return '';\n\n  var uint8 = new Uint8Array(data);\n  // If present, strip off the UTF-8 BOM.\n  if (uint8[0] == 0xef && uint8[1] == 0xbb && uint8[2] == 0xbf) {\n    uint8 = uint8.subarray(3);\n  }\n\n  // http://stackoverflow.com/a/13691499\n  var utf8 = shaka.util.StringUtils.fromCharCode_(uint8);\n  // This converts each character in the string to an escape sequence.  If the\n  // character is in the ASCII range, it is not converted; otherwise it is\n  // converted to a URI escape sequence.\n  // Example: '\\x67\\x35\\xe3\\x82\\xac' -> 'g#%E3%82%AC'\n  var escaped = escape(utf8);\n  // Decode the escaped sequence.  This will interpret UTF-8 sequences into the\n  // correct character.\n  // Example: 'g#%E3%82%AC' -> 'g#€'\n  try {\n    return decodeURIComponent(escaped);\n  } catch (e) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL, shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.BAD_ENCODING);\n  }\n};\n\n\n/**\n * Creates a string from the given buffer as UTF-16 encoding.\n *\n * @param {?BufferSource} data\n * @param {boolean} littleEndian true to read little endian, false to read big.\n * @param {boolean=} opt_noThrow true to avoid throwing in cases where we may\n *     expect invalid input.  If noThrow is true and the data has an odd length,\n *     it will be truncated.\n * @return {string}\n * @throws {shaka.util.Error}\n * @export\n */\nshaka.util.StringUtils.fromUTF16 = function(data, littleEndian, opt_noThrow) {\n  if (!data) return '';\n\n  if (!opt_noThrow && data.byteLength % 2 != 0) {\n    shaka.log.error('Data has an incorrect length, must be even.');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL, shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.BAD_ENCODING);\n  }\n\n  /** @type {ArrayBuffer} */\n  var buffer;\n  if (data instanceof ArrayBuffer) {\n    buffer = data;\n  } else {\n    // Have to create a new buffer because the argument may be a smaller\n    // view on a larger ArrayBuffer.  We cannot use an ArrayBufferView in\n    // a DataView.\n    var temp = new Uint8Array(data.byteLength);\n    temp.set(new Uint8Array(data));\n    buffer = temp.buffer;\n  }\n\n  // Use a DataView to ensure correct endianness.\n  var length = Math.floor(data.byteLength / 2);\n  var arr = new Uint16Array(length);\n  var dataView = new DataView(buffer);\n  for (var i = 0; i < length; i++) {\n    arr[i] = dataView.getUint16(i * 2, littleEndian);\n  }\n  return shaka.util.StringUtils.fromCharCode_(arr);\n};\n\n\n/**\n * Creates a string from the given buffer, auto-detecting the encoding that is\n * being used.  If it cannot detect the encoding, it will throw an exception.\n *\n * @param {?BufferSource} data\n * @return {string}\n * @throws {shaka.util.Error}\n * @export\n */\nshaka.util.StringUtils.fromBytesAutoDetect = function(data) {\n  var StringUtils = shaka.util.StringUtils;\n\n  var uint8 = new Uint8Array(data);\n  if (uint8[0] == 0xef && uint8[1] == 0xbb && uint8[2] == 0xbf)\n    return StringUtils.fromUTF8(uint8);\n  else if (uint8[0] == 0xfe && uint8[1] == 0xff)\n    return StringUtils.fromUTF16(uint8.subarray(2), false /* littleEndian */);\n  else if (uint8[0] == 0xff && uint8[1] == 0xfe)\n    return StringUtils.fromUTF16(uint8.subarray(2), true /* littleEndian */);\n\n  var isAscii = (function(arr, i) {\n    // arr[i] >= ' ' && arr[i] <= '~';\n    return arr.byteLength <= i || (arr[i] >= 0x20 && arr[i] <= 0x7e);\n  }.bind(null, uint8));\n\n  shaka.log.debug('Unable to find byte-order-mark, making an educated guess.');\n  if (uint8[0] == 0 && uint8[2] == 0)\n    return StringUtils.fromUTF16(data, false /* littleEndian */);\n  else if (uint8[1] == 0 && uint8[3] == 0)\n    return StringUtils.fromUTF16(data, true /* littleEndian */);\n  else if (isAscii(0) && isAscii(1) && isAscii(2) && isAscii(3))\n    return StringUtils.fromUTF8(data);\n\n  throw new shaka.util.Error(\n      shaka.util.Error.Severity.CRITICAL,\n      shaka.util.Error.Category.TEXT,\n      shaka.util.Error.Code.UNABLE_TO_DETECT_ENCODING);\n};\n\n\n/**\n * Creates a ArrayBuffer from the given string, converting to UTF-8 encoding.\n *\n * @param {string} str\n * @return {!ArrayBuffer}\n * @export\n */\nshaka.util.StringUtils.toUTF8 = function(str) {\n  // http://stackoverflow.com/a/13691499\n  // Converts the given string to a URI encoded string.  If a character falls\n  // in the ASCII range, it is not converted; otherwise it will be converted to\n  // a series of URI escape sequences according to UTF-8.\n  // Example: 'g#€' -> 'g#%E3%82%AC'\n  var encoded = encodeURIComponent(str);\n  // Convert each escape sequence individually into a character.  Each escape\n  // sequence is interpreted as a code-point, so if an escape sequence happens\n  // to be part of a multi-byte sequence, each byte will be converted to a\n  // single character.\n  // Example: 'g#%E3%82%AC' -> '\\x67\\x35\\xe3\\x82\\xac'\n  var utf8 = unescape(encoded);\n\n  var result = new Uint8Array(utf8.length);\n  for (var i = 0; i < utf8.length; ++i) {\n    result[i] = utf8.charCodeAt(i);\n  }\n  return result.buffer;\n};\n\n\n/**\n * Creates a new string from the given array of char codes.\n *\n * @param {!TypedArray} args\n * @return {string}\n * @private\n */\nshaka.util.StringUtils.fromCharCode_ = function(args) {\n  var max = 16000;\n  var ret = '';\n  for (var i = 0; i < args.length; i += max) {\n    var subArray = args.subarray(i, i + max);\n    ret += String.fromCharCode.apply(null, subArray);\n  }\n\n  return ret;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/string_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.Timer');\n\n\n\n/**\n * A simple cancelable timer.\n * @param {Function} callback\n * @constructor\n * @struct\n */\nshaka.util.Timer = function(callback) {\n  /** @private {?number} */\n  this.id_ = null;\n\n  /** @private {Function} */\n  this.callback_ = (function() {\n    this.id_ = null;\n    callback();\n  }.bind(this));\n};\n\n\n/**\n * Cancel the timer, if it's running.\n */\nshaka.util.Timer.prototype.cancel = function() {\n  if (this.id_ != null) {\n    clearTimeout(this.id_);\n    this.id_ = null;\n  }\n};\n\n\n/**\n * Schedule the timer, canceling any previous scheduling.\n * @param {number} seconds\n */\nshaka.util.Timer.prototype.schedule = function(seconds) {\n  this.cancel();\n  this.id_ = setTimeout(this.callback_, seconds * 1000);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/timer.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.Uint8ArrayUtils');\n\n\n/**\n * @namespace shaka.util.Uint8ArrayUtils\n * @summary A set of Uint8Array utility functions.\n * @exportDoc\n */\n\n\n/**\n * Convert a Uint8Array to a base64 string.  The output will always use the\n * alternate encoding/alphabet also known as \"base64url\".\n * @param {!Uint8Array} arr\n * @param {boolean=} opt_padding If true, pad the output with equals signs.\n *   Defaults to true.\n * @return {string}\n * @export\n */\nshaka.util.Uint8ArrayUtils.toBase64 = function(arr, opt_padding) {\n  // btoa expects a \"raw string\" where each character is interpreted as a byte.\n  var bytes = String.fromCharCode.apply(null, arr);\n  var padding = (opt_padding == undefined) ? true : opt_padding;\n  var base64 = window.btoa(bytes).replace(/\\+/g, '-').replace(/\\//g, '_');\n  return padding ? base64 : base64.replace(/=*$/, '');\n};\n\n\n/**\n * Convert a base64 string to a Uint8Array.  Accepts either the standard\n * alphabet or the alternate \"base64url\" alphabet.\n * @param {string} str\n * @return {!Uint8Array}\n * @export\n */\nshaka.util.Uint8ArrayUtils.fromBase64 = function(str) {\n  // atob creates a \"raw string\" where each character is interpreted as a byte.\n  var bytes = window.atob(str.replace(/-/g, '+').replace(/_/g, '/'));\n  var result = new Uint8Array(bytes.length);\n  for (var i = 0; i < bytes.length; ++i) {\n    result[i] = bytes.charCodeAt(i);\n  }\n  return result;\n};\n\n\n/**\n * Convert a hex string to a Uint8Array.\n * @param {string} str\n * @return {!Uint8Array}\n * @export\n */\nshaka.util.Uint8ArrayUtils.fromHex = function(str) {\n  var arr = new Uint8Array(str.length / 2);\n  for (var i = 0; i < str.length; i += 2) {\n    arr[i / 2] = window.parseInt(str.substr(i, 2), 16);\n  }\n  return arr;\n};\n\n\n/**\n * Convert a Uint8Array to a hex string.\n * @param {!Uint8Array} arr\n * @return {string}\n * @export\n */\nshaka.util.Uint8ArrayUtils.toHex = function(arr) {\n  var hex = '';\n  for (var i = 0; i < arr.length; ++i) {\n    var value = arr[i].toString(16);\n    if (value.length == 1) value = '0' + value;\n    hex += value;\n  }\n  return hex;\n};\n\n\n/**\n * Compare two Uint8Arrays for equality.\n * @param {Uint8Array} arr1\n * @param {Uint8Array} arr2\n * @return {boolean}\n * @export\n */\nshaka.util.Uint8ArrayUtils.equal = function(arr1, arr2) {\n  if (!arr1 && !arr2) return true;\n  if (!arr1 || !arr2) return false;\n  if (arr1.length != arr2.length) return false;\n  for (var i = 0; i < arr1.length; ++i) {\n    if (arr1[i] != arr2[i]) return false;\n  }\n  return true;\n};\n\n\n/**\n * Concatenate Uint8Arrays.\n * @param {...Uint8Array} var_args\n * @return {Uint8Array}\n * @export\n */\nshaka.util.Uint8ArrayUtils.concat = function(var_args) {\n  var totalLength = 0;\n  for (var i = 0; i < arguments.length; ++i) {\n    totalLength += arguments[i].length;\n  }\n\n  var result = new Uint8Array(totalLength);\n  var offset = 0;\n  for (var i = 0; i < arguments.length; ++i) {\n    result.set(arguments[i], offset);\n    offset += arguments[i].length;\n  }\n  return result;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/uint8array_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.DrmEngine');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.util.ArrayUtils');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.EventManager');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.MapUtils');\ngoog.require('shaka.util.PublicPromise');\ngoog.require('shaka.util.StringUtils');\ngoog.require('shaka.util.Timer');\ngoog.require('shaka.util.Uint8ArrayUtils');\n\n\n\n/**\n * @constructor\n * @param {!shaka.net.NetworkingEngine} networkingEngine\n * @param {function(!shaka.util.Error)} onError Called when an error occurs.\n * @param {function(!Object.<string, string>)} onKeyStatus Called when key\n *   status changes.  Argument is a map of hex key IDs to statuses.\n * @param {function(string, number)} onExpirationUpdated\n * @struct\n * @implements {shaka.util.IDestroyable}\n */\nshaka.media.DrmEngine = function(\n    networkingEngine, onError, onKeyStatus, onExpirationUpdated) {\n  /** @private {Array.<string>} */\n  this.supportedTypes_ = null;\n\n  /** @private {MediaKeys} */\n  this.mediaKeys_ = null;\n\n  /** @private {HTMLMediaElement} */\n  this.video_ = null;\n\n  /** @private {boolean} */\n  this.initialized_ = false;\n\n  /** @private {?shakaExtern.DrmInfo} */\n  this.currentDrmInfo_ = null;\n\n  /** @private {shaka.util.EventManager} */\n  this.eventManager_ = new shaka.util.EventManager();\n\n  /** @private {!Array.<shaka.media.DrmEngine.ActiveSession>} */\n  this.activeSessions_ = [];\n\n  /** @private {!Array.<string>} */\n  this.offlineSessionIds_ = [];\n\n  /** @private {!shaka.util.PublicPromise} */\n  this.allSessionsLoaded_ = new shaka.util.PublicPromise();\n\n  /** @private {shaka.net.NetworkingEngine} */\n  this.networkingEngine_ = networkingEngine;\n\n  /** @private {?shakaExtern.DrmConfiguration} */\n  this.config_ = null;\n\n  /** @private {?function(!shaka.util.Error)} */\n  this.onError_ = (function(err) {\n    this.allSessionsLoaded_.reject(err);\n    onError(err);\n  }.bind(this));\n\n  /** @private {!Object.<string, string>} */\n  this.keyStatusByKeyId_ = {};\n\n  /** @private {?function(!Object.<string, string>)} */\n  this.onKeyStatus_ = onKeyStatus;\n\n  /** @private {?function(string, number)} */\n  this.onExpirationUpdated_ = onExpirationUpdated;\n\n  /** @private {shaka.util.Timer} */\n  this.keyStatusTimer_ = new shaka.util.Timer(\n      this.processKeyStatusChanges_.bind(this));\n\n  /** @private {boolean} */\n  this.destroyed_ = false;\n\n  /** @private {boolean} */\n  this.isOffline_ = false;\n\n  /** @private {!Array.<!MediaKeyMessageEvent>} */\n  this.mediaKeyMessageEvents_ = [];\n\n  /** @private {boolean} */\n  this.initialRequestsSent_ = false;\n\n  /** @private {?number} */\n  this.expirationInterval_ = setInterval(this.pollExpiration_.bind(this), 1000);\n\n  // Add a catch to the Promise to avoid console logs about uncaught errors.\n  this.allSessionsLoaded_.catch(function() {});\n};\n\n\n/**\n * @typedef {{\n *   loaded: boolean,\n *   initData: Uint8Array,\n *   session: !MediaKeySession,\n *   oldExpiration: number,\n *   updatePromise: shaka.util.PublicPromise\n * }}\n *\n * @description A record to track sessions and suppress duplicate init data.\n * @property {boolean} loaded\n *   True once the key status has been updated (to a non-pending state).  This\n *   does not mean the session is 'usable'.\n * @property {Uint8Array} initData\n *   The init data used to create the session.\n * @property {!MediaKeySession} session\n *   The session object.\n * @property {number} oldExpiration\n *   The expiration of the session on the last check.  This is used to fire\n *   an event when it changes.\n * @property {shaka.util.PublicPromise} updatePromise\n *   An optional Promise that will be resolved/rejected on the next update()\n *   call.  This is used to track the 'license-release' message when calling\n *   remove().\n */\nshaka.media.DrmEngine.ActiveSession;\n\n\n/** @override */\nshaka.media.DrmEngine.prototype.destroy = function() {\n  var Functional = shaka.util.Functional;\n  this.destroyed_ = true;\n\n  var async = this.activeSessions_.map(function(activeSession) {\n    // Ignore any errors when closing the sessions.  One such error would be\n    // an invalid state error triggered by closing a session which has not\n    // generated any key requests.\n    // Chrome sometimes returns |undefined|: https://crbug.com/690664\n    var p = activeSession.session.close() || Promise.resolve();\n    return p.catch(Functional.noop);\n  });\n  this.allSessionsLoaded_.reject();\n\n  if (this.eventManager_)\n    async.push(this.eventManager_.destroy());\n\n  if (this.video_) {\n    goog.asserts.assert(!this.video_.src, 'video src must be removed first!');\n    async.push(this.video_.setMediaKeys(null).catch(Functional.noop));\n  }\n\n  if (this.expirationInterval_) {\n    clearInterval(this.expirationInterval_);\n    this.expirationInterval_ = null;\n  }\n\n  if (this.keyStatusTimer_) {\n    this.keyStatusTimer_.cancel();\n  }\n  this.keyStatusTimer_ = null;\n\n  this.currentDrmInfo_ = null;\n  this.supportedTypes_ = null;\n  this.mediaKeys_ = null;\n  this.video_ = null;\n  this.eventManager_ = null;\n  this.activeSessions_ = [];\n  this.offlineSessionIds_ = [];\n  this.networkingEngine_ = null;  // We don't own it, don't destroy() it.\n  this.config_ = null;\n  this.onError_ = null;\n  this.onExpirationUpdated_ = null;\n\n  return Promise.all(async);\n};\n\n\n/**\n * Called by the Player to provide an updated configuration any time it changes.\n * Must be called at least once before init().\n *\n * @param {shakaExtern.DrmConfiguration} config\n */\nshaka.media.DrmEngine.prototype.configure = function(config) {\n  this.config_ = config;\n};\n\n\n/**\n * Negotiate for a key system and set up MediaKeys.\n * @param {!shakaExtern.Manifest} manifest The manifest is read for MIME type\n *   and DRM information to query EME. If the 'clearKeys' configuration is\n *   used, the manifest will be modified to force the use of Clear Key.\n * @param {boolean} offline True if we are storing or loading offline content.\n * @return {!Promise} Resolved if/when a key system has been chosen.\n */\nshaka.media.DrmEngine.prototype.init = function(manifest, offline) {\n  goog.asserts.assert(this.config_,\n      'DrmEngine configure() must be called before init()!');\n\n  /** @type {!Object.<string, MediaKeySystemConfiguration>} */\n  var configsByKeySystem = {};\n\n  /** @type {!Array.<string>} */\n  var keySystemsInOrder = [];\n\n  // |isOffline_| determines what kind of session to create.  The argument to\n  // |prepareMediaKeyConfigs_| determines the kind of CDM to query for.  So\n  // we still need persistent state when we are loading offline sessions.\n  this.isOffline_ = offline;\n  this.offlineSessionIds_ = manifest.offlineSessionIds;\n  this.prepareMediaKeyConfigs_(\n      manifest, offline || manifest.offlineSessionIds.length > 0,\n      configsByKeySystem, keySystemsInOrder);\n\n  if (!keySystemsInOrder.length) {\n    // Unencrypted.\n    this.initialized_ = true;\n    return Promise.resolve();\n  }\n\n  return this.queryMediaKeys_(configsByKeySystem, keySystemsInOrder);\n};\n\n\n/**\n * Attach MediaKeys to the video element and start processing events.\n * @param {HTMLMediaElement} video\n * @return {!Promise}\n */\nshaka.media.DrmEngine.prototype.attach = function(video) {\n  if (!this.mediaKeys_) {\n    // Unencrypted, or so we think.  We listen for encrypted events in order to\n    // warn when the stream is encrypted, even though the manifest does not know\n    // it.\n    // Don't complain about this twice, so just listenOnce().\n    this.eventManager_.listenOnce(video, 'encrypted', function(event) {\n      this.onError_(new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.DRM,\n          shaka.util.Error.Code.ENCRYPTED_CONTENT_WITHOUT_DRM_INFO));\n    }.bind(this));\n    return Promise.resolve();\n  }\n\n  this.video_ = video;\n\n  this.eventManager_.listenOnce(this.video_, 'play', this.onPlay_.bind(this));\n\n  var setMediaKeys = this.video_.setMediaKeys(this.mediaKeys_);\n  setMediaKeys = setMediaKeys.catch(function(exception) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.DRM,\n        shaka.util.Error.Code.FAILED_TO_ATTACH_TO_VIDEO,\n        exception.message));\n  });\n\n  var setServerCertificate = null;\n  if (this.currentDrmInfo_.serverCertificate) {\n    setServerCertificate = this.mediaKeys_.setServerCertificate(\n        this.currentDrmInfo_.serverCertificate).then(function(supported) {\n      if (!supported) {\n        shaka.log.warning('Server certificates are not supported by the key' +\n                          ' system.  The server certificate has been ignored.');\n      }\n    }).catch(function(exception) {\n      return Promise.reject(new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.DRM,\n          shaka.util.Error.Code.INVALID_SERVER_CERTIFICATE,\n          exception.message));\n    });\n  }\n\n  return Promise.all([setMediaKeys, setServerCertificate]).then(function() {\n    if (this.destroyed_) return Promise.reject();\n\n    this.createOrLoad();\n    if (!this.currentDrmInfo_.initData.length &&\n        !this.offlineSessionIds_.length) {\n      // Explicit init data for any one stream or an offline session is\n      // sufficient to suppress 'encrypted' events for all streams.\n      var onEncrypted = /** @type {shaka.util.EventManager.ListenerType} */(\n          this.onEncrypted_.bind(this));\n      this.eventManager_.listen(this.video_, 'encrypted', onEncrypted);\n    }\n  }.bind(this)).catch(function(error) {\n    if (this.destroyed_) return Promise.resolve();  // Ignore destruction errors\n    return Promise.reject(error);\n  }.bind(this));\n};\n\n\n/**\n * Removes the given offline sessions and deletes their data.  Must call init()\n * before this.  This will wait until the 'license-release' message is handled\n * and the resulting Promise will be rejected if there is an error with that.\n *\n * @param {!Array.<string>} sessions\n * @return {!Promise}\n */\nshaka.media.DrmEngine.prototype.removeSessions = function(sessions) {\n  goog.asserts.assert(this.mediaKeys_ || !sessions.length,\n                      'Must call init() before removeSessions');\n  return Promise.all(sessions.map(function(sessionId) {\n    return this.loadOfflineSession_(sessionId).then(function(session) {\n      // This will be null on error, such as session not found.\n      if (session) {\n        var p = new shaka.util.PublicPromise();\n        // TODO: Consider adding a timeout to get the 'message' event.\n        // Note that the 'message' event will get raised after the remove()\n        // promise resolves.\n\n        for (var i = 0; i < this.activeSessions_.length; i++) {\n          if (this.activeSessions_[i].session == session) {\n            this.activeSessions_[i].updatePromise = p;\n            break;\n          }\n        }\n        return Promise.all([session.remove(), p]);\n      }\n    }.bind(this));\n  }.bind(this)));\n};\n\n\n/**\n * Creates the sessions for the init data and waits for them to become ready.\n *\n * @return {!Promise}\n */\nshaka.media.DrmEngine.prototype.createOrLoad = function() {\n  var initDatas = this.currentDrmInfo_ ? this.currentDrmInfo_.initData : [];\n  initDatas.forEach(function(initDataOverride) {\n    this.createTemporarySession_(\n        initDataOverride.initDataType, initDataOverride.initData);\n  }.bind(this));\n  this.offlineSessionIds_.forEach(function(sessionId) {\n    this.loadOfflineSession_(sessionId);\n  }.bind(this));\n\n  if (!initDatas.length && !this.offlineSessionIds_.length)\n    this.allSessionsLoaded_.resolve();\n  return this.allSessionsLoaded_;\n};\n\n\n/** @return {boolean} */\nshaka.media.DrmEngine.prototype.initialized = function() {\n  return this.initialized_;\n};\n\n\n/** @return {string} */\nshaka.media.DrmEngine.prototype.keySystem = function() {\n  return this.currentDrmInfo_ ? this.currentDrmInfo_.keySystem : '';\n};\n\n\n/**\n * Returns an array of the media types supported by the current key system.\n * These will be full mime types (e.g. 'video/webm; codecs=\"vp8\"').\n *\n * @return {Array.<string>}\n */\nshaka.media.DrmEngine.prototype.getSupportedTypes = function() {\n  return this.supportedTypes_;\n};\n\n\n/**\n * Returns the ID of the sessions currently active.\n *\n * @return {!Array.<string>}\n */\nshaka.media.DrmEngine.prototype.getSessionIds = function() {\n  return this.activeSessions_.map(function(session) {\n    return session.session.sessionId;\n  });\n};\n\n\n/**\n * Returns the next expiration time, or Infinity.\n * @return {number}\n */\nshaka.media.DrmEngine.prototype.getExpiration = function() {\n  var expirations = this.activeSessions_.map(function(session) {\n    var expiration = session.session.expiration;\n    return isNaN(expiration) ? Infinity : expiration;\n  });\n  // This will equal Infinity if there are no entries.\n  return Math.min.apply(Math, expirations);\n};\n\n\n/**\n * Returns the DrmInfo that was used to initialize the current key system.\n *\n * @return {?shakaExtern.DrmInfo}\n */\nshaka.media.DrmEngine.prototype.getDrmInfo = function() {\n  return this.currentDrmInfo_;\n};\n\n\n/**\n * @param {!shakaExtern.Manifest} manifest\n * @param {boolean} offline True if we are storing or loading offline content.\n * @param {!Object.<string, MediaKeySystemConfiguration>} configsByKeySystem\n *   (Output parameter.)  A dictionary of configs, indexed by key system.\n * @param {!Array.<string>} keySystemsInOrder\n *   (Output parameter.)  A list of key systems in the order in which we\n *   encounter them.\n * @see https://goo.gl/nwdYnY for MediaKeySystemConfiguration spec\n * @private\n */\nshaka.media.DrmEngine.prototype.prepareMediaKeyConfigs_ =\n    function(manifest, offline, configsByKeySystem, keySystemsInOrder) {\n  var clearKeyDrmInfo = this.configureClearKey_();\n\n  manifest.periods.forEach(function(period) {\n    period.variants.forEach(function(variant) {\n      // clearKey config overrides manifest DrmInfo if present.\n      // The manifest is modified so that filtering in Player still works.\n      if (clearKeyDrmInfo) {\n        variant.drmInfos = [clearKeyDrmInfo];\n      }\n\n      variant.drmInfos.forEach(function(drmInfo) {\n        this.fillInDrmInfoDefaults_(drmInfo);\n\n        // Chromecast has a variant of PlayReady that uses a different key\n        // system ID.  Since manifest parsers convert the standard PlayReady\n        // UUID to the standard PlayReady key system ID, here we will switch\n        // to the Chromecast version if we are running on that platform.\n        // Note that this must come after fillInDrmInfoDefaults_, since the\n        // player config uses the standard PlayReady ID for license server\n        // configuration.\n        if (window.cast && window.cast.__platform__) {\n          if (drmInfo.keySystem == 'com.microsoft.playready') {\n            drmInfo.keySystem = 'com.chromecast.playready';\n          }\n        }\n\n        var config = configsByKeySystem[drmInfo.keySystem];\n        if (!config) {\n          config = {\n            // ignore initDataTypes\n            audioCapabilities: [],\n            videoCapabilities: [],\n            distinctiveIdentifier: 'optional',\n            persistentState: offline ? 'required' : 'optional',\n            sessionTypes: [offline ? 'persistent-license' : 'temporary'],\n            label: drmInfo.keySystem,\n            drmInfos: []  // tracked by us, ignored by EME\n          };\n          configsByKeySystem[drmInfo.keySystem] = config;\n          keySystemsInOrder.push(drmInfo.keySystem);\n        }\n\n        config.drmInfos.push(drmInfo);\n\n        if (drmInfo.distinctiveIdentifierRequired)\n          config.distinctiveIdentifier = 'required';\n\n        if (drmInfo.persistentStateRequired)\n          config.persistentState = 'required';\n\n        var streams = [];\n        if (variant.video) streams.push(variant.video);\n        if (variant.audio) streams.push(variant.audio);\n\n        streams.forEach(function(stream) {\n          var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n          /** @type {!Array.<!MediaKeySystemMediaCapability>} */\n          var capabilities = (stream.type == ContentType.VIDEO) ?\n              config.videoCapabilities : config.audioCapabilities;\n          /** @type {string} */\n          var robustness = ((stream.type == ContentType.VIDEO) ?\n              drmInfo.videoRobustness : drmInfo.audioRobustness) || '';\n\n          var fullMimeType = stream.mimeType;\n          if (stream.codecs) {\n            fullMimeType += '; codecs=\"' + stream.codecs + '\"';\n          }\n\n          capabilities.push({\n            robustness: robustness,\n            contentType: fullMimeType\n          });\n        }.bind(this)); // streams.forEach (variant.video, variant.audio)\n      }.bind(this)); // variant.drmInfos.forEach\n    }.bind(this));  // periods.variants.forEach\n  }.bind(this));  // manifest.perios.forEach\n};\n\n\n/**\n * @param {!Object.<string, MediaKeySystemConfiguration>} configsByKeySystem\n *   A dictionary of configs, indexed by key system.\n * @param {!Array.<string>} keySystemsInOrder\n *   A list of key systems in the order in which we should query them.\n *   On a browser which supports multiple key systems, the order may indicate\n *   a real preference for the application.\n * @return {!Promise} Resolved if/when a key system has been chosen.\n * @private\n */\nshaka.media.DrmEngine.prototype.queryMediaKeys_ =\n    function(configsByKeySystem, keySystemsInOrder) {\n  if (keySystemsInOrder.length == 1 && keySystemsInOrder[0] == '') {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.DRM,\n        shaka.util.Error.Code.NO_RECOGNIZED_KEY_SYSTEMS));\n  }\n\n  // Wait to reject this initial Promise until we have built the entire chain.\n  var instigator = new shaka.util.PublicPromise();\n  var p = instigator;\n\n  // Try key systems with configured license servers first.  We only have to try\n  // key systems without configured license servers for diagnostic reasons, so\n  // that we can differentiate between \"none of these key systems are available\"\n  // and \"some are available, but you did not configure them properly.\"  The\n  // former takes precedence.\n  [true, false].forEach(function(shouldHaveLicenseServer) {\n    keySystemsInOrder.forEach(function(keySystem) {\n      var config = configsByKeySystem[keySystem];\n\n      var hasLicenseServer = config.drmInfos.some(function(info) {\n        return !!info.licenseServerUri;\n      });\n      if (hasLicenseServer != shouldHaveLicenseServer) return;\n\n      // If there are no tracks of a type, these should be not present.\n      // Otherwise the query will fail.\n      if (config.audioCapabilities.length == 0) {\n        delete config.audioCapabilities;\n      }\n      if (config.videoCapabilities.length == 0) {\n        delete config.videoCapabilities;\n      }\n\n      p = p.catch(function() {\n        if (this.destroyed_) return Promise.reject();\n        return navigator.requestMediaKeySystemAccess(keySystem, [config]);\n      }.bind(this));\n    }.bind(this));\n  }.bind(this));\n\n  p = p.catch(function() {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.DRM,\n        shaka.util.Error.Code.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE));\n  });\n\n  p = p.then(function(mediaKeySystemAccess) {\n    if (this.destroyed_) return Promise.reject();\n\n    // TODO: Remove once Edge has released a fix for https://goo.gl/qMeV7v\n    var isEdge = navigator.userAgent.indexOf('Edge/') >= 0;\n\n    // Store the capabilities of the key system.\n    var realConfig = mediaKeySystemAccess.getConfiguration();\n    var audioCaps = realConfig.audioCapabilities || [];\n    var videoCaps = realConfig.videoCapabilities || [];\n    var caps = audioCaps.concat(videoCaps);\n    this.supportedTypes_ = caps.map(function(c) { return c.contentType; });\n    if (isEdge) {\n      // Edge 14 does not report correct capabilities.  It will only report the\n      // first MIME type even if the others are supported.  To work around this,\n      // set the supported types to null, which Player will use as a signal that\n      // the information is not available.\n      // See: https://goo.gl/qMeV7v\n      this.supportedTypes_ = null;\n    }\n    goog.asserts.assert(!this.supportedTypes_ || this.supportedTypes_.length,\n                        'We should get at least one supported MIME type');\n\n    var originalConfig = configsByKeySystem[mediaKeySystemAccess.keySystem];\n    this.createCurrentDrmInfo_(\n        mediaKeySystemAccess.keySystem, originalConfig,\n        originalConfig.drmInfos);\n\n    if (!this.currentDrmInfo_.licenseServerUri) {\n      return Promise.reject(new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.DRM,\n          shaka.util.Error.Code.NO_LICENSE_SERVER_GIVEN));\n    }\n\n    return mediaKeySystemAccess.createMediaKeys();\n  }.bind(this)).then(function(mediaKeys) {\n    if (this.destroyed_) return Promise.reject();\n\n    this.mediaKeys_ = mediaKeys;\n    this.initialized_ = true;\n  }.bind(this)).catch(function(exception) {\n    if (this.destroyed_) return Promise.resolve();  // Ignore destruction errors\n\n    // Don't rewrap a shaka.util.Error from earlier in the chain:\n    this.currentDrmInfo_ = null;\n    this.supportedTypes_ = null;\n    if (exception instanceof shaka.util.Error) {\n      return Promise.reject(exception);\n    }\n\n    // We failed to create MediaKeys.  This generally shouldn't happen.\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.DRM,\n        shaka.util.Error.Code.FAILED_TO_CREATE_CDM,\n        exception.message));\n  }.bind(this));\n\n  instigator.reject();\n  return p;\n};\n\n\n/**\n * Use this.config_ to fill in missing values in drmInfo.\n * @param {shakaExtern.DrmInfo} drmInfo\n * @private\n */\nshaka.media.DrmEngine.prototype.fillInDrmInfoDefaults_ = function(drmInfo) {\n  var keySystem = drmInfo.keySystem;\n\n  if (!keySystem) {\n    // This is a placeholder from the manifest parser for an unrecognized key\n    // system.  Skip this entry, to avoid logging nonsensical errors.\n    return;\n  }\n\n  if (!drmInfo.licenseServerUri) {\n    var server = this.config_.servers[keySystem];\n    if (server) {\n      drmInfo.licenseServerUri = server;\n    } else {\n      shaka.log.error('No license server configured for ' + keySystem);\n    }\n  }\n\n  if (!drmInfo.keyIds) {\n    drmInfo.keyIds = [];\n  }\n\n  var advanced = this.config_.advanced[keySystem];\n  if (advanced) {\n    if (!drmInfo.distinctiveIdentifierRequired) {\n      drmInfo.distinctiveIdentifierRequired =\n          advanced.distinctiveIdentifierRequired;\n    }\n\n    if (!drmInfo.persistentStateRequired) {\n      drmInfo.persistentStateRequired = advanced.persistentStateRequired;\n    }\n\n    if (!drmInfo.videoRobustness) {\n      drmInfo.videoRobustness = advanced.videoRobustness;\n    }\n\n    if (!drmInfo.audioRobustness) {\n      drmInfo.audioRobustness = advanced.audioRobustness;\n    }\n\n    if (!drmInfo.serverCertificate) {\n      drmInfo.serverCertificate = advanced.serverCertificate;\n    }\n  }\n};\n\n\n/**\n * Create a DrmInfo using configured clear keys.\n * The server URI will be a data URI which decodes to a clearkey license.\n * @return {?shakaExtern.DrmInfo} or null if clear keys are not configured.\n * @private\n * @see https://goo.gl/6nPdhF for the spec on the clearkey license format.\n */\nshaka.media.DrmEngine.prototype.configureClearKey_ = function() {\n  var hasClearKeys = !shaka.util.MapUtils.empty(this.config_.clearKeys);\n  if (!hasClearKeys) return null;\n\n  var StringUtils = shaka.util.StringUtils;\n  var Uint8ArrayUtils = shaka.util.Uint8ArrayUtils;\n  var keys = [];\n  var keyIds = [];\n\n  for (var keyIdHex in this.config_.clearKeys) {\n    var keyHex = this.config_.clearKeys[keyIdHex];\n\n    var keyId = Uint8ArrayUtils.fromHex(keyIdHex);\n    var key = Uint8ArrayUtils.fromHex(keyHex);\n    var keyObj = {\n      kty: 'oct',\n      kid: Uint8ArrayUtils.toBase64(keyId, false),\n      k: Uint8ArrayUtils.toBase64(key, false)\n    };\n\n    keys.push(keyObj);\n    keyIds.push(keyObj.kid);\n  }\n\n  var jwkSet = {keys: keys};\n  var license = JSON.stringify(jwkSet);\n\n  // Use the keyids init data since is suggested by EME.\n  // Suggestion: https://goo.gl/R72xp4\n  // Format: https://goo.gl/75RCP6\n  var initDataStr = JSON.stringify({'kids': keyIds});\n  var initData = new Uint8Array(StringUtils.toUTF8(initDataStr));\n  var initDatas = [{initData: initData, initDataType: 'keyids'}];\n\n  return {\n    keySystem: 'org.w3.clearkey',\n    licenseServerUri: 'data:application/json;base64,' + window.btoa(license),\n    distinctiveIdentifierRequired: false,\n    persistentStateRequired: false,\n    audioRobustness: '',\n    videoRobustness: '',\n    serverCertificate: null,\n    initData: initDatas,\n    keyIds: []\n  };\n};\n\n\n/**\n * Creates a DrmInfo object describing the settings used to initialize the\n * engine.\n *\n * @param {string} keySystem\n * @param {MediaKeySystemConfiguration} config\n * @param {!Array.<shakaExtern.DrmInfo>} drmInfos\n * @private\n */\nshaka.media.DrmEngine.prototype.createCurrentDrmInfo_ = function(\n    keySystem, config, drmInfos) {\n  /** @type {!Array.<string>} */\n  var licenseServers = [];\n\n  /** @type {!Array.<!Uint8Array>} */\n  var serverCerts = [];\n\n  /** @type {!Array.<!shakaExtern.InitDataOverride>} */\n  var initDatas = [];\n\n  /** @type {!Array.<string>} */\n  var keyIds = [];\n\n  this.processDrmInfos_(drmInfos, licenseServers, serverCerts, initDatas,\n      keyIds);\n\n  if (serverCerts.length > 1) {\n    shaka.log.warning('Multiple unique server certificates found! ' +\n                      'Only the first will be used.');\n  }\n\n  if (licenseServers.length > 1) {\n    shaka.log.warning('Multiple unique license server URIs found! ' +\n                      'Only the first will be used.');\n  }\n\n  // TODO: This only works when all DrmInfo have the same robustness.\n  var audioRobustness =\n      config.audioCapabilities ? config.audioCapabilities[0].robustness : '';\n  var videoRobustness =\n      config.videoCapabilities ? config.videoCapabilities[0].robustness : '';\n  this.currentDrmInfo_ = {\n    keySystem: keySystem,\n    licenseServerUri: licenseServers[0],\n    distinctiveIdentifierRequired: (config.distinctiveIdentifier == 'required'),\n    persistentStateRequired: (config.persistentState == 'required'),\n    audioRobustness: audioRobustness,\n    videoRobustness: videoRobustness,\n    serverCertificate: serverCerts[0],\n    initData: initDatas,\n    keyIds: keyIds\n  };\n};\n\n\n/**\n * Extract license server, server cert, and init data from DrmInfos, taking\n * care to eliminate duplicates.\n *\n * @param {!Array.<shakaExtern.DrmInfo>} drmInfos\n * @param {!Array.<string>} licenseServers\n * @param {!Array.<!Uint8Array>} serverCerts\n * @param {!Array.<!shakaExtern.InitDataOverride>} initDatas\n * @param {!Array.<string>} keyIds\n * @private\n */\nshaka.media.DrmEngine.prototype.processDrmInfos_ =\n    function(drmInfos, licenseServers, serverCerts, initDatas, keyIds) {\n  /**\n   * @param {shakaExtern.InitDataOverride} a\n   * @param {shakaExtern.InitDataOverride} b\n   * @return {boolean}\n   */\n  function initDataOverrideEqual(a, b) {\n    if (a.keyId && a.keyId == b.keyId) {\n      // Two initDatas with the same keyId are considered to be the same,\n      // unless that \"same keyId\" is null.\n      return true;\n    }\n    return a.initDataType == b.initDataType &&\n           shaka.util.Uint8ArrayUtils.equal(a.initData, b.initData);\n  }\n\n  drmInfos.forEach(function(drmInfo) {\n    // Aliases:\n    var ArrayUtils = shaka.util.ArrayUtils;\n    var Uint8ArrayUtils = shaka.util.Uint8ArrayUtils;\n\n    // Build an array of unique license servers.\n    if (licenseServers.indexOf(drmInfo.licenseServerUri) == -1) {\n      licenseServers.push(drmInfo.licenseServerUri);\n    }\n\n    // Build an array of unique server certs.\n    if (drmInfo.serverCertificate) {\n      if (ArrayUtils.indexOf(serverCerts, drmInfo.serverCertificate,\n                             Uint8ArrayUtils.equal) == -1) {\n        serverCerts.push(drmInfo.serverCertificate);\n      }\n    }\n\n    // Build an array of unique init datas.\n    if (drmInfo.initData) {\n      drmInfo.initData.forEach(function(initDataOverride) {\n        if (ArrayUtils.indexOf(initDatas, initDataOverride,\n                               initDataOverrideEqual) == -1) {\n          initDatas.push(initDataOverride);\n        }\n      });\n    }\n\n    if (drmInfo.keyIds) {\n      for (var i = 0; i < drmInfo.keyIds.length; ++i) {\n        if (keyIds.indexOf(drmInfo.keyIds[i]) == -1) {\n          keyIds.push(drmInfo.keyIds[i]);\n        }\n      }\n    }\n  });\n};\n\n\n/**\n * @param {!MediaEncryptedEvent} event\n * @private\n */\nshaka.media.DrmEngine.prototype.onEncrypted_ = function(event) {\n  // Aliases:\n  var Uint8ArrayUtils = shaka.util.Uint8ArrayUtils;\n\n  var initData = new Uint8Array(event.initData);\n\n  // Suppress duplicate init data.\n  // Note that some init data are extremely large and can't portably be used as\n  // keys in a dictionary.\n  for (var i = 0; i < this.activeSessions_.length; ++i) {\n    if (Uint8ArrayUtils.equal(initData, this.activeSessions_[i].initData)) {\n      shaka.log.debug('Ignoring duplicate init data.');\n      return;\n    }\n  }\n\n  this.createTemporarySession_(event.initDataType, initData);\n};\n\n\n/**\n * @param {string} sessionId\n * @return {!Promise.<MediaKeySession>}\n * @private\n */\nshaka.media.DrmEngine.prototype.loadOfflineSession_ = function(sessionId) {\n  var session;\n  try {\n    session = this.mediaKeys_.createSession('persistent-license');\n  } catch (exception) {\n    var error = new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.DRM,\n        shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,\n        exception.message);\n    this.onError_(error);\n    return Promise.reject(error);\n  }\n\n  this.eventManager_.listen(session, 'message',\n      /** @type {shaka.util.EventManager.ListenerType} */(\n          this.onSessionMessage_.bind(this)));\n  this.eventManager_.listen(session, 'keystatuseschange',\n      this.onKeyStatusesChange_.bind(this));\n\n  var activeSession = {\n    initData: null,\n    session: session,\n    loaded: false,\n    oldExpiration: Infinity,\n    updatePromise: null\n  };\n  this.activeSessions_.push(activeSession);\n\n  return session.load(sessionId).then(function(present) {\n    if (this.destroyed_) return;\n\n    if (!present) {\n      var i = this.activeSessions_.indexOf(activeSession);\n      goog.asserts.assert(i >= 0, 'Session must be in the array');\n      this.activeSessions_.splice(i, 1);\n\n      this.onError_(new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.DRM,\n          shaka.util.Error.Code.OFFLINE_SESSION_REMOVED));\n      return;\n    }\n\n    // TODO: We should get a key status change event.  Remove once Chrome CDM\n    // is fixed.\n    activeSession.loaded = true;\n    if (this.activeSessions_.every(function(s) { return s.loaded; }))\n      this.allSessionsLoaded_.resolve();\n\n    return session;\n  }.bind(this), function(error) {\n    if (this.destroyed_) return;\n\n    var i = this.activeSessions_.indexOf(activeSession);\n    goog.asserts.assert(i >= 0, 'Session must be in the array');\n    this.activeSessions_.splice(i, 1);\n\n    this.onError_(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.DRM,\n        shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,\n        error.message));\n  }.bind(this));\n};\n\n\n/**\n * @param {string} initDataType\n * @param {!Uint8Array} initData\n * @private\n */\nshaka.media.DrmEngine.prototype.createTemporarySession_ =\n    function(initDataType, initData) {\n  var session;\n  try {\n    if (this.isOffline_) {\n      session = this.mediaKeys_.createSession('persistent-license');\n    } else {\n      session = this.mediaKeys_.createSession();\n    }\n  } catch (exception) {\n    this.onError_(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.DRM,\n        shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,\n        exception.message));\n    return;\n  }\n\n  this.eventManager_.listen(session, 'message',\n      /** @type {shaka.util.EventManager.ListenerType} */(\n          this.onSessionMessage_.bind(this)));\n  this.eventManager_.listen(session, 'keystatuseschange',\n      this.onKeyStatusesChange_.bind(this));\n  this.activeSessions_.push({\n    initData: initData,\n    session: session,\n    loaded: false,\n    oldExpiration: Infinity,\n    updatePromise: null\n  });\n\n  session.generateRequest(initDataType, initData.buffer).catch(function(error) {\n    if (this.destroyed_) return;\n\n    for (var i = 0; i < this.activeSessions_.length; ++i) {\n      if (this.activeSessions_[i].session == session) {\n        this.activeSessions_.splice(i, 1);\n        break;\n      }\n    }\n    this.onError_(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.DRM,\n        shaka.util.Error.Code.FAILED_TO_GENERATE_LICENSE_REQUEST,\n        error.message));\n  }.bind(this));\n};\n\n\n/**\n * @param {!MediaKeyMessageEvent} event\n * @private\n */\nshaka.media.DrmEngine.prototype.onSessionMessage_ = function(event) {\n  if (this.delayLicenseRequest_())\n    this.mediaKeyMessageEvents_.push(event);\n  else\n    this.sendLicenseRequest_(event);\n};\n\n\n/**\n * @return {boolean}\n * @private\n */\nshaka.media.DrmEngine.prototype.delayLicenseRequest_ = function() {\n  return (this.config_.delayLicenseRequestUntilPlayed &&\n          this.video_.paused && !this.initialRequestsSent_);\n};\n\n\n/**\n * Sends a license request.\n * @param {!MediaKeyMessageEvent} event\n * @private\n */\nshaka.media.DrmEngine.prototype.sendLicenseRequest_ = function(event) {\n  /** @type {!MediaKeySession} */\n  var session = event.target;\n\n  var updatePromise;\n  for (var i = 0; i < this.activeSessions_.length; i++) {\n    if (this.activeSessions_[i].session == session) {\n      updatePromise = this.activeSessions_[i].updatePromise;\n      break;\n    }\n  }\n\n  var requestType = shaka.net.NetworkingEngine.RequestType.LICENSE;\n  var request = shaka.net.NetworkingEngine.makeRequest(\n      [this.currentDrmInfo_.licenseServerUri], this.config_.retryParameters);\n  request.body = event.message;\n  request.method = 'POST';\n  // NOTE: allowCrossSiteCredentials can be set in a request filter.\n\n  if (this.currentDrmInfo_.keySystem == 'com.microsoft.playready' ||\n      this.currentDrmInfo_.keySystem == 'com.chromecast.playready') {\n    this.unpackPlayReadyRequest_(request);\n  }\n\n  this.networkingEngine_.request(requestType, request)\n      .then(function(response) {\n        if (this.destroyed_) return Promise.reject();\n\n        // Request succeeded, now pass the response to the CDM.\n        return session.update(response.data).then(function() {\n          if (updatePromise)\n            updatePromise.resolve();\n        });\n      }.bind(this), function(error) {\n        // Ignore destruction errors\n        if (this.destroyed_) return Promise.resolve();\n\n        // Request failed!\n        goog.asserts.assert(error instanceof shaka.util.Error,\n                            'Wrong NetworkingEngine error type!');\n        var shakaErr = new shaka.util.Error(\n            shaka.util.Error.Severity.CRITICAL,\n            shaka.util.Error.Category.DRM,\n            shaka.util.Error.Code.LICENSE_REQUEST_FAILED,\n            error);\n        this.onError_(shakaErr);\n        if (updatePromise)\n          updatePromise.reject(shakaErr);\n      }.bind(this)).catch(function(error) {\n        // Ignore destruction errors\n        if (this.destroyed_) return Promise.resolve();\n\n        // Session update failed!\n        var shakaErr = new shaka.util.Error(\n            shaka.util.Error.Severity.CRITICAL,\n            shaka.util.Error.Category.DRM,\n            shaka.util.Error.Code.LICENSE_RESPONSE_REJECTED,\n            error.message);\n        this.onError_(shakaErr);\n        if (updatePromise)\n          updatePromise.reject(shakaErr);\n      }.bind(this));\n};\n\n\n/**\n * Unpack PlayReady license requests.  Modifies the request object.\n * @param {shakaExtern.Request} request\n * @private\n */\nshaka.media.DrmEngine.prototype.unpackPlayReadyRequest_ = function(request) {\n  // On IE and Edge, the raw license message is UTF-16-encoded XML.  We need to\n  // unpack the Challenge element (base64-encoded string containing the actual\n  // license request) and any HttpHeader elements (sent as request headers).\n\n  // Example XML:\n\n  // <PlayReadyKeyMessage type=\"LicenseAcquisition\">\n  //   <LicenseAcquisition Version=\"1\">\n  //     <Challenge encoding=\"base64encoded\">{Base64Data}</Challenge>\n  //     <HttpHeaders>\n  //       <HttpHeader>\n  //         <name>Content-Type</name>\n  //         <value>text/xml; charset=utf-8</value>\n  //       </HttpHeader>\n  //       <HttpHeader>\n  //         <name>SOAPAction</name>\n  //         <value>http://schemas.microsoft.com/DRM/etc/etc</value>\n  //       </HttpHeader>\n  //     </HttpHeaders>\n  //   </LicenseAcquisition>\n  // </PlayReadyKeyMessage>\n\n  var xml = shaka.util.StringUtils.fromUTF16(\n      request.body, true /* littleEndian */, true /* noThrow */);\n  if (xml.indexOf('PlayReadyKeyMessage') == -1) {\n    // This does not appear to be a wrapped message as on IE and Edge.  Some\n    // clients do not need this unwrapping, so we will assume this is one of\n    // them.  Note that \"xml\" at this point probably looks like random garbage,\n    // since we interpreted UTF-8 as UTF-16.\n    shaka.log.debug('PlayReady request is already unwrapped.');\n    request.headers['Content-Type'] = 'text/xml; charset=utf-8';\n    return;\n  }\n  shaka.log.debug('Unwrapping PlayReady request.');\n  var dom = new DOMParser().parseFromString(xml, 'application/xml');\n\n  // Set request headers.\n  var headers = dom.getElementsByTagName('HttpHeader');\n  for (var i = 0; i < headers.length; ++i) {\n    var name = headers[i].querySelector('name');\n    var value = headers[i].querySelector('value');\n    goog.asserts.assert(name && value, 'Malformed PlayReady headers!');\n    request.headers[name.textContent] = value.textContent;\n  }\n\n  // Unpack the base64-encoded challenge.\n  var challenge = dom.querySelector('Challenge');\n  goog.asserts.assert(challenge, 'Malformed PlayReady challenge!');\n  goog.asserts.assert(challenge.getAttribute('encoding') == 'base64encoded',\n                      'Unexpected PlayReady challenge encoding!');\n  request.body =\n      shaka.util.Uint8ArrayUtils.fromBase64(challenge.textContent).buffer;\n};\n\n\n/**\n * @param {!Event} event\n * @private\n * @suppress {invalidCasts} to swap keyId and status\n */\nshaka.media.DrmEngine.prototype.onKeyStatusesChange_ = function(event) {\n  var session = /** @type {!MediaKeySession} */(event.target);\n\n  // Locate the session in the active sessions list.\n  var i;\n  for (i = 0; i < this.activeSessions_.length; ++i) {\n    if (this.activeSessions_[i].session == session) {\n      break;\n    }\n  }\n  goog.asserts.assert(i < this.activeSessions_.length,\n                      'Key status change for inactive session!');\n  if (i == this.activeSessions_.length) return;\n\n  var keyStatusMap = session.keyStatuses;\n  var hasExpiredKeys = false;\n\n  keyStatusMap.forEach(function(status, keyId) {\n    // The spec has changed a few times on the exact order of arguments here.\n    // As of 2016-06-30, Edge has the order reversed compared to the current\n    // EME spec.  Given the back and forth in the spec, it may not be the only\n    // one.  Try to detect this and compensate:\n    if (typeof keyId == 'string') {\n      var tmp = keyId;\n      keyId = /** @type {ArrayBuffer} */(status);\n      status = /** @type {string} */(tmp);\n    }\n\n    // Microsoft's implementation in Edge seems to present key IDs as\n    // little-endian UUIDs, rather than big-endian or just plain array of bytes.\n    // standard: 6e 5a 1d 26 - 27 57 - 47 d7 - 80 46 ea a5 d1 d3 4b 5a\n    // on Edge:  26 1d 5a 6e - 57 27 - d7 47 - 80 46 ea a5 d1 d3 4b 5a\n    // Bug filed: https://goo.gl/gnRSkJ\n\n    // NOTE that we skip this if byteLength != 16.  This is used for the IE11\n    // and Edge 12 EME polyfill, which uses single-byte dummy key IDs.\n    if (this.currentDrmInfo_.keySystem == 'com.microsoft.playready' &&\n        keyId.byteLength == 16) {\n      // Read out some fields in little-endian:\n      var dataView = new DataView(keyId);\n      var part0 = dataView.getUint32(0, true /* LE */);\n      var part1 = dataView.getUint16(4, true /* LE */);\n      var part2 = dataView.getUint16(6, true /* LE */);\n      // Write it back in big-endian:\n      dataView.setUint32(0, part0, false /* BE */);\n      dataView.setUint16(4, part1, false /* BE */);\n      dataView.setUint16(6, part2, false /* BE */);\n    }\n\n    // Microsoft's implementation in IE11 and Edge seems to never set key\n    // status to 'usable'.  It is stuck forever at 'status-pending'.  In spite\n    // of this, the keys do seem to be usable and content plays correctly.\n    // Bug filed: https://goo.gl/fcXEy1\n    if (this.currentDrmInfo_.keySystem == 'com.microsoft.playready' &&\n        status == 'status-pending') {\n      status = 'usable';\n    }\n\n    if (status != 'status-pending') {\n      this.activeSessions_[i].loaded = true;\n      if (this.activeSessions_.every(function(s) { return s.loaded; }))\n        this.allSessionsLoaded_.resolve();\n    }\n\n    if (status == 'expired') {\n      hasExpiredKeys = true;\n    }\n\n    var keyIdHex = shaka.util.Uint8ArrayUtils.toHex(new Uint8Array(keyId));\n\n    this.keyStatusByKeyId_[keyIdHex] = status;\n  }.bind(this));\n\n  // If the session has expired, close it.\n  // Some CDMs do not have sub-second time resolution, so the key status may\n  // fire with hundreds of milliseconds left until the stated expiration time.\n  var msUntilExpiration = session.expiration - Date.now();\n  if (msUntilExpiration < 0 || (hasExpiredKeys && msUntilExpiration < 1000)) {\n    // If this is part of a remove(), we don't want to close the session until\n    // the update is complete.  Otherwise, we will orphan the session.\n    if (!this.activeSessions_[i].updatePromise) {\n      shaka.log.debug('Session has expired', session);\n      this.activeSessions_.splice(i, 1);\n      session.close();\n    }\n  }\n\n  // Batch up key status changes before checking them or notifying Player.\n  // This handles cases where the statuses of multiple sessions are set\n  // simultaneously by the browser before dispatching key status changes for\n  // each of them.  By batching these up, we only send one status change event\n  // and at most one EXPIRED error on expiration.\n  this.keyStatusTimer_.schedule(0.5);\n};\n\n\n/**\n * @private\n */\nshaka.media.DrmEngine.prototype.processKeyStatusChanges_ = function() {\n  // If all keys are expired, fire an error.\n  function isExpired(keyId, status) {\n    return status == 'expired';\n  }\n  var MapUtils = shaka.util.MapUtils;\n  // Note that every() is always true for an empty map,\n  // but we shouldn't fire an error for a lack of key status info.\n  var allExpired = !MapUtils.empty(this.keyStatusByKeyId_) &&\n                   MapUtils.every(this.keyStatusByKeyId_, isExpired);\n\n  if (allExpired) {\n    this.onError_(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.DRM,\n        shaka.util.Error.Code.EXPIRED));\n  }\n\n  this.onKeyStatus_(this.keyStatusByKeyId_);\n};\n\n\n/**\n * Returns true if the browser has recent EME APIs.\n *\n * @return {boolean}\n */\nshaka.media.DrmEngine.isBrowserSupported = function() {\n  var basic =\n      !!window.MediaKeys &&\n      !!window.navigator &&\n      !!window.navigator.requestMediaKeySystemAccess &&\n      !!window.MediaKeySystemAccess &&\n      !!window.MediaKeySystemAccess.prototype.getConfiguration;\n\n  return basic;\n};\n\n\n/**\n * Returns a Promise to a map of EME support for well-known key systems.\n *\n * @return {!Promise.<!Object.<string, ?shakaExtern.DrmSupportType>>}\n */\nshaka.media.DrmEngine.probeSupport = function() {\n  goog.asserts.assert(shaka.media.DrmEngine.isBrowserSupported(),\n                      'Must have basic EME support');\n\n  var tests = [];\n  var testKeySystems = [\n    'org.w3.clearkey',\n    'com.widevine.alpha',\n    'com.microsoft.playready',\n    'com.apple.fps.2_0',\n    'com.apple.fps.1_0',\n    'com.apple.fps',\n    'com.adobe.primetime'\n  ];\n\n  var basicVideoCapabilities = [\n    { contentType: 'video/mp4; codecs=\"avc1.42E01E\"' },\n    { contentType: 'video/webm; codecs=\"vp8\"' }\n  ];\n\n  var basicConfig = {\n    videoCapabilities: basicVideoCapabilities\n  };\n  var offlineConfig = {\n    videoCapabilities: basicVideoCapabilities,\n    persistentState: 'required',\n    sessionTypes: ['persistent-license']\n  };\n\n  // Try the offline config first, then fall back to the basic config.\n  var configs = [offlineConfig, basicConfig];\n\n  var support = {};\n  testKeySystems.forEach(function(keySystem) {\n    var p = navigator.requestMediaKeySystemAccess(keySystem, configs)\n        .then(function(access) {\n          // Edge doesn't return supported session types, but current versions\n          // do not support persistent-license.  If sessionTypes is missing,\n          // assume no support for persistent-license.\n          // TODO: polyfill Edge to return known supported session types.\n          // Edge bug: https://goo.gl/z0URJ0\n          // Firefox does return supported session types, but will still let you\n          // create a session even if the type is unsupported.\n          // Firefox bug: https://goo.gl/lB4H3i\n          var sessionTypes = access.getConfiguration().sessionTypes;\n          var persistentState = sessionTypes ?\n              sessionTypes.indexOf('persistent-license') >= 0 : false;\n          support[keySystem] = {persistentState: persistentState};\n          return access.createMediaKeys();\n        }).catch(function() {\n          // Either the request failed or createMediaKeys failed.\n          // Either way, write null to the support object.\n          support[keySystem] = null;\n        });\n    tests.push(p);\n  });\n\n  return Promise.all(tests).then(function() {\n    return support;\n  });\n};\n\n\n/**\n * @private\n */\nshaka.media.DrmEngine.prototype.onPlay_ = function() {\n  for (var i = 0; i < this.mediaKeyMessageEvents_.length; i++) {\n    this.sendLicenseRequest_(this.mediaKeyMessageEvents_[i]);\n  }\n\n  this.initialRequestsSent_ = true;\n  this.mediaKeyMessageEvents_ = [];\n};\n\n\n/**\n * Checks if a variant is compatible with the key system.\n * @param {!shakaExtern.Variant} variant\n * @return {boolean}\n**/\nshaka.media.DrmEngine.prototype.isSupportedByKeySystem = function(variant) {\n  var keySystem = this.keySystem();\n  return variant.drmInfos.length == 0 ||\n      variant.drmInfos.some(function(drmInfo) {\n        return drmInfo.keySystem == keySystem;\n      });\n};\n\n\n/**\n * Checks if two DrmInfos can be decrypted using the\n * same key system. Clear content is considered compatible\n * with every key system.\n *\n * @param {!Array.<!shakaExtern.DrmInfo>} drms1\n * @param {!Array.<!shakaExtern.DrmInfo>} drms2\n * @return {boolean}\n */\nshaka.media.DrmEngine.areDrmCompatible = function(drms1, drms2) {\n  if (!drms1.length || !drms2.length) return true;\n\n  return shaka.media.DrmEngine.getCommonDrmInfos(\n      drms1, drms2).length > 0;\n};\n\n\n/**\n * Returns an array of drm infos that are present in both input arrays.\n * If one of the arrays is empty, returns the other one since clear\n * content is considered compatible with every drm info.\n *\n * @param {!Array.<!shakaExtern.DrmInfo>} drms1\n * @param {!Array.<!shakaExtern.DrmInfo>} drms2\n * @return {!Array.<!shakaExtern.DrmInfo>}\n */\nshaka.media.DrmEngine.getCommonDrmInfos = function(drms1, drms2) {\n  if (!drms1.length) return drms2;\n  if (!drms2.length) return drms1;\n\n  var commonDrms = [];\n\n  for (var i = 0; i < drms1.length; i++) {\n    for (var j = 0; j < drms2.length; j++) {\n      // This method is only called to compare drmInfos of a video\n      // and an audio adaptations, so we shouldn't have to worry about\n      // checking robustness.\n      if (drms1[i].keySystem == drms2[j].keySystem) {\n        var drm1 = drms1[i];\n        var drm2 = drms2[j];\n        var initData = [];\n        initData = initData.concat(drm1.initData || []);\n        initData = initData.concat(drm2.initData || []);\n        var keyIds = [];\n        keyIds = keyIds.concat(drm1.keyIds);\n        keyIds = keyIds.concat(drm2.keyIds);\n        var mergedDrm = {\n          keySystem: drm1.keySystem,\n          licenseServerUri: drm1.licenseServerUri || drm2.licenseServerUri,\n          distinctiveIdentifierRequired: drm1.distinctiveIdentifierRequired ||\n              drm2.distinctiveIdentifierRequired,\n          persistentStateRequired: drm1.persistentStateRequired ||\n              drm2.persistentStateRequired,\n          videoRobustness: drm1.videoRobustness || drm2.videoRobustness,\n          audioRobustness: drm1.audioRobustness || drm2.audioRobustness,\n          serverCertificate: drm1.serverCertificate || drm2.serverCertificate,\n          initData: initData,\n          keyIds: keyIds\n        };\n        commonDrms.push(mergedDrm);\n        break;\n      }\n    }\n  }\n\n  return commonDrms;\n};\n\n\n/**\n * Called in an interval timer to poll the expiration times of the sessions.  We\n * don't get an event from EME when the expiration updates, so we poll it so we\n * can fire an event when it happens.\n * @private\n */\nshaka.media.DrmEngine.prototype.pollExpiration_ = function() {\n  this.activeSessions_.forEach(function(session) {\n    var old = session.oldExpiration;\n    var new_ = session.session.expiration;\n    if (isNaN(new_))\n      new_ = Infinity;\n\n    if (new_ != old) {\n      this.onExpirationUpdated_(session.session.sessionId, new_);\n      session.oldExpiration = new_;\n    }\n  }.bind(this));\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/drm_engine.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.TextEngine');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.util.IDestroyable');\n\n\n\n/**\n * Manages text parsers and cues.\n *\n * @struct\n * @constructor\n * @param {TextTrack} track\n * @implements {shaka.util.IDestroyable}\n */\nshaka.media.TextEngine = function(track) {\n  /** @private {shakaExtern.TextParser} */\n  this.parser_ = null;\n\n  /** @private {TextTrack} */\n  this.track_ = track;\n\n  /** @private {number} */\n  this.timestampOffset_ = 0;\n\n  /** @private {number} */\n  this.appendWindowEnd_ = Infinity;\n\n  /** @private {?number} */\n  this.bufferStart_ = null;\n\n  /** @private {?number} */\n  this.bufferEnd_ = null;\n};\n\n\n/** @private {!Object.<string, !shakaExtern.TextParserPlugin>} */\nshaka.media.TextEngine.parserMap_ = {};\n\n\n/**\n * @param {string} mimeType\n * @param {!shakaExtern.TextParserPlugin} plugin\n * @export\n */\nshaka.media.TextEngine.registerParser = function(mimeType, plugin) {\n  // Assume that if the function is expecting no parameters, it must be\n  // a stateful text parser factory. Otherwise, assume that it is a\n  // stateless text parser.\n  if (plugin.length == 0) {\n    shaka.media.TextEngine.parserMap_[mimeType] = plugin;\n  } else {\n    shaka.log.warning('The use of stateless text parsers is deprecated.');\n    shaka.media.TextEngine.parserMap_[mimeType] =\n        shaka.media.TextEngine.TextParserWrapper_.bind(null, plugin);\n  }\n};\n\n\n/**\n * @param {string} mimeType\n * @export\n */\nshaka.media.TextEngine.unregisterParser = function(mimeType) {\n  delete shaka.media.TextEngine.parserMap_[mimeType];\n};\n\n\n/**\n * @param {string} mimeType\n * @return {boolean}\n */\nshaka.media.TextEngine.isTypeSupported = function(mimeType) {\n  return !!shaka.media.TextEngine.parserMap_[mimeType];\n};\n\n\n/**\n * Creates a cue using the best platform-specific interface available.\n *\n * @param {number} startTime\n * @param {number} endTime\n * @param {string} payload\n * @return {TextTrackCue} or null if the parameters were invalid.\n * @export\n */\nshaka.media.TextEngine.makeCue = function(startTime, endTime, payload) {\n  if (startTime >= endTime) {\n    // IE/Edge will throw in this case.\n    // See issue #501\n    shaka.log.warning('Invalid cue times: ' + startTime + ' - ' + endTime);\n    return null;\n  }\n\n  return new VTTCue(startTime, endTime, payload);\n};\n\n\n/** @override */\nshaka.media.TextEngine.prototype.destroy = function() {\n  if (this.track_) {\n    this.removeWhere_(function(cue) { return true; });\n  }\n\n  this.parser_ = null;\n  this.track_ = null;\n\n  return Promise.resolve();\n};\n\n\n/**\n * Initialize the parser.  This can be called multiple times, but must be called\n * at least once before appendBuffer.\n *\n * @param {string} mimeType\n */\nshaka.media.TextEngine.prototype.initParser = function(mimeType) {\n  var factory = shaka.media.TextEngine.parserMap_[mimeType];\n  goog.asserts.assert(\n      factory,\n      'Text type negotiation should have happened already');\n  this.parser_ = new factory();\n};\n\n\n/**\n * @param {!ArrayBuffer} buffer\n * @param {?number} startTime\n * @param {?number} endTime\n * @return {!Promise}\n */\nshaka.media.TextEngine.prototype.appendBuffer =\n    function(buffer, startTime, endTime) {\n  goog.asserts.assert(this.parser_, 'The parser should already be initialized');\n\n  // Start the operation asynchronously to avoid blocking the caller.\n  return Promise.resolve().then(function() {\n    // Check that TextEngine hasn't been destroyed.\n    if (!this.track_) return;\n\n    if (startTime == null || endTime == null) {\n      this.parser_.parseInit(buffer);\n      return;\n    }\n\n    /** @type {shakaExtern.TextParser.TimeContext} **/\n    var time = {\n      periodStart: this.timestampOffset_,\n      segmentStart: startTime,\n      segmentEnd: endTime\n    };\n\n    // Parse the buffer and add the new cues.\n    var cues = this.parser_.parseMedia(buffer, time);\n\n    for (var i = 0; i < cues.length; ++i) {\n      if (cues[i].startTime >= this.appendWindowEnd_) break;\n      this.track_.addCue(cues[i]);\n    }\n\n    // NOTE: We update the buffered range from the start and end times passed\n    // down from the segment reference, not with the start and end times of the\n    // parsed cues.  This is important because some segments may contain no\n    // cues, but we must still consider those ranges buffered.\n    if (this.bufferStart_ == null) {\n      this.bufferStart_ = startTime;\n    } else {\n      // We already had something in buffer, and we assume we are extending the\n      // range from the end.\n      goog.asserts.assert((startTime - this.bufferEnd_) <= 1,\n                          'There should not be a gap in text references >1s');\n    }\n    this.bufferEnd_ = Math.min(endTime, this.appendWindowEnd_);\n  }.bind(this));\n};\n\n\n/**\n * @param {number} start\n * @param {number} end\n * @return {!Promise}\n */\nshaka.media.TextEngine.prototype.remove = function(start, end) {\n  // Start the operation asynchronously to avoid blocking the caller.\n  return Promise.resolve().then(function() {\n    // Check that TextEngine hasn't been destroyed.\n    if (!this.track_) return;\n\n    this.removeWhere_(function(cue) {\n      if (cue.startTime >= end || cue.endTime <= start) {\n        // Outside the remove range.  Hang on to it.\n        return false;\n      }\n      return true;\n    });\n\n    if (this.bufferStart_ == null) {\n      goog.asserts.assert(this.bufferEnd_ == null,\n                          'end must be null if start is null');\n    } else {\n      goog.asserts.assert(this.bufferEnd_ != null,\n                          'end must be non-null if start is non-null');\n\n      // Update buffered range.\n      if (end <= this.bufferStart_ || start >= this.bufferEnd_) {\n        // No intersection.  Nothing was removed.\n      } else if (start <= this.bufferStart_ && end >= this.bufferEnd_) {\n        // We wiped out everything.\n        goog.asserts.assert(\n            this.track_.cues.length == 0, 'should be no cues left');\n        this.bufferStart_ = this.bufferEnd_ = null;\n      } else if (start <= this.bufferStart_ && end < this.bufferEnd_) {\n        // We removed from the beginning of the range.\n        this.bufferStart_ = end;\n      } else if (start > this.bufferStart_ && end >= this.bufferEnd_) {\n        // We removed from the end of the range.\n        this.bufferEnd_ = start;\n      } else {\n        // We removed from the middle?  StreamingEngine isn't supposed to.\n        goog.asserts.assert(\n            false, 'removal from the middle is not supported by TextEngine');\n      }\n    }\n  }.bind(this));\n};\n\n\n/** @param {number} timestampOffset */\nshaka.media.TextEngine.prototype.setTimestampOffset =\n    function(timestampOffset) {\n  this.timestampOffset_ = timestampOffset;\n};\n\n\n/** @param {number} windowEnd */\nshaka.media.TextEngine.prototype.setAppendWindowEnd =\n    function(windowEnd) {\n  this.appendWindowEnd_ = windowEnd;\n};\n\n\n/**\n * @return {?number} Time in seconds of the beginning of the buffered range,\n *   or null if nothing is buffered.\n */\nshaka.media.TextEngine.prototype.bufferStart = function() {\n  return this.bufferStart_;\n};\n\n\n/**\n * @return {?number} Time in seconds of the end of the buffered range,\n *   or null if nothing is buffered.\n */\nshaka.media.TextEngine.prototype.bufferEnd = function() {\n  return this.bufferEnd_;\n};\n\n\n/**\n * @param {number} t A timestamp\n * @return {boolean}\n */\nshaka.media.TextEngine.prototype.isBuffered = function(t) {\n  return t >= this.bufferStart_ && t < this.bufferEnd_;\n};\n\n\n/**\n * @param {number} t A timestamp\n * @return {number} Number of seconds ahead of 't' we have buffered\n */\nshaka.media.TextEngine.prototype.bufferedAheadOf = function(t) {\n  if (this.bufferEnd_ == null || this.bufferEnd_ < t) return 0;\n\n  goog.asserts.assert(\n      this.bufferStart_ != null, 'start should not be null if end is not null');\n\n  return this.bufferEnd_ - Math.max(t, this.bufferStart_);\n};\n\n\n/**\n * Remove all cues for which the matching function returns true.\n *\n * @param {function(!TextTrackCue):boolean} predicate\n * @private\n */\nshaka.media.TextEngine.prototype.removeWhere_ = function(predicate) {\n  var cues = this.track_.cues;\n  var removeMe = [];\n\n  // Remove these in another loop to avoid mutating the TextTrackCueList\n  // while iterating over it.  This allows us to avoid making assumptions\n  // about whether or not this.track_.remove() will alter that list.\n  for (var i = 0; i < cues.length; ++i) {\n    if (predicate(cues[i])) {\n      removeMe.push(cues[i]);\n    }\n  }\n\n  for (var i = 0; i < removeMe.length; ++i) {\n    this.track_.removeCue(removeMe[i]);\n  }\n};\n\n\n\n/**\n * @param {Function} parser\n * @constructor\n * @implements {shakaExtern.TextParser}\n * @private\n */\nshaka.media.TextEngine.TextParserWrapper_ = function(parser) {\n  this.parser = parser;\n};\n\n\n/** @override **/\nshaka.media.TextEngine.TextParserWrapper_.prototype.parseInit = function(data) {\n  this.parser(data, 0, null, null);\n};\n\n\n/** @override **/\nshaka.media.TextEngine.TextParserWrapper_.prototype.parseMedia = function(\n    data, time) {\n  return this.parser(data,\n                     time.periodStart,\n                     time.segmentStart,\n                     time.segmentEnd);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/text_engine.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.TimeRangesUtils');\n\n\n/**\n * @namespace shaka.media.TimeRangesUtils\n * @summary A set of utility functions for dealing with TimeRanges objects.\n */\n\n\n/**\n * Gets the first timestamp in buffer.\n *\n * @param {TimeRanges} b\n * @return {?number} The first buffered timestamp, in seconds, if |buffered|\n *   is non-empty; otherwise, return null.\n */\nshaka.media.TimeRangesUtils.bufferStart = function(b) {\n  if (!b) return null;\n  // Workaround Safari bug: https://goo.gl/EDRCoZ\n  if (b.length == 1 && b.end(0) - b.start(0) < 1e-6) return null;\n  // Workaround Edge bug: https://goo.gl/BtxKgb\n  if (b.length == 1 && b.start(0) < 0) return 0;\n  return b.length ? b.start(0) : null;\n};\n\n\n/**\n * Gets the last timestamp in buffer.\n *\n * @param {TimeRanges} b\n * @return {?number} The last buffered timestamp, in seconds, if |buffered|\n *   is non-empty; otherwise, return null.\n */\nshaka.media.TimeRangesUtils.bufferEnd = function(b) {\n  if (!b) return null;\n  // Workaround Safari bug: https://goo.gl/EDRCoZ\n  if (b.length == 1 && b.end(0) - b.start(0) < 1e-6) return null;\n  return b.length ? b.end(b.length - 1) : null;\n};\n\n\n/**\n * Determines if the given time is inside a buffered range.  This includes gaps,\n * meaning if the playhead is in a gap, it is considered buffered.\n *\n * @param {TimeRanges} b\n * @param {number} time\n * @return {boolean}\n */\nshaka.media.TimeRangesUtils.isBuffered = function(b, time) {\n  if (!b || !b.length) return false;\n  // Workaround Safari bug: https://goo.gl/EDRCoZ\n  if (b.length == 1 && b.end(0) - b.start(0) < 1e-6) return false;\n\n  return time >= b.start(0) && time <= b.end(b.length - 1);\n};\n\n\n/**\n * Computes how far ahead of the given timestamp is buffered.  To provide smooth\n * playback while jumping gaps, we don't include the gaps when calculating this.\n * This only includes the amount of content that is buffered.\n *\n * @param {TimeRanges} b\n * @param {number} time\n * @return {number} The number of seconds buffered, in seconds, ahead of the\n *   given time.\n */\nshaka.media.TimeRangesUtils.bufferedAheadOf = function(b, time) {\n  if (!b || !b.length) return 0;\n  // Workaround Safari bug: https://goo.gl/EDRCoZ\n  if (b.length == 1 && b.end(0) - b.start(0) < 1e-6) return 0;\n\n  // NOTE: On IE11, buffered ranges may show appended data before the associated\n  // append operation is complete.\n\n  // We calculate buffered amount by ONLY accounting for the content buffered\n  // (i.e. we ignore the times of the gaps).  We also buffer through all gaps.\n  // So start at the end and add up all buffers until |time|.\n  var result = 0;\n  for (var i = b.length - 1; i >= 0 && b.end(i) > time; --i) {\n    result += b.end(i) - Math.max(b.start(i), time);\n  }\n\n  return result;\n};\n\n\n/**\n * Determines if the given time is inside a gap between buffered ranges.  If it\n * is, this returns the index of the buffer that is *ahead* of the gap.\n *\n * @param {TimeRanges} b\n * @param {number} time\n * @return {?number} The index of the buffer after the gap, or null if not in a\n *   gap.\n */\nshaka.media.TimeRangesUtils.getGapIndex = function(b, time) {\n  if (!b || !b.length) return null;\n  // Workaround Safari bug: https://goo.gl/EDRCoZ\n  if (b.length == 1 && b.end(0) - b.start(0) < 1e-6) return null;\n\n  // IE/Edge stops 0.5 seconds before a gap, so it needs a much larger\n  // threshold, but we don't want to punish other browsers that stop closer.\n  // See: https://goo.gl/cuAcYd\n  var threshold = 0.1;\n  if (/(Edge|Trident)\\//.test(navigator.userAgent))\n    threshold = 0.5;\n\n  for (var i = 0; i < b.length; i++) {\n    if (b.start(i) > time && (i == 0 || b.end(i - 1) - time <= threshold)) {\n      return i;\n    }\n  }\n\n  return null;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/time_ranges_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.MediaSourceEngine');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.TextEngine');\ngoog.require('shaka.media.TimeRangesUtils');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.EventManager');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.PublicPromise');\n\n\n\n/**\n * MediaSourceEngine wraps all operations on MediaSource and SourceBuffers.\n * All asynchronous operations return a Promise, and all operations are\n * internally synchronized and serialized as needed.  Operations that can\n * be done in parallel will be done in parallel.\n *\n * @param {HTMLMediaElement} video The video element, used to read error codes\n *   when MediaSource operations fail.\n * @param {MediaSource} mediaSource The MediaSource, which must be in the\n *   'open' state.\n * @param {TextTrack} textTrack The TextTrack to use for subtitles/captions.\n *\n * @struct\n * @constructor\n * @implements {shaka.util.IDestroyable}\n */\nshaka.media.MediaSourceEngine = function(video, mediaSource, textTrack) {\n  goog.asserts.assert(mediaSource.readyState == 'open',\n                      'The MediaSource should be in the \\'open\\' state.');\n\n  /** @private {HTMLMediaElement} */\n  this.video_ = video;\n\n  /** @private {MediaSource} */\n  this.mediaSource_ = mediaSource;\n\n  /** @private {TextTrack} */\n  this.textTrack_ = textTrack;\n\n  /** @private {!Object.<shaka.util.ManifestParserUtils.ContentType,\n                         SourceBuffer>} */\n  this.sourceBuffers_ = {};\n\n  /** @private {shaka.media.TextEngine} */\n  this.textEngine_ = null;\n\n  /**\n   * @private {!Object.<string,\n   *                    !Array.<shaka.media.MediaSourceEngine.Operation>>}\n   */\n  this.queues_ = {};\n\n  /** @private {shaka.util.EventManager} */\n  this.eventManager_ = new shaka.util.EventManager();\n\n  /** @private {boolean} */\n  this.destroyed_ = false;\n};\n\n\n/**\n * @typedef {{\n *   start: function(),\n *   p: !shaka.util.PublicPromise\n * }}\n *\n * @summary An operation in queue.\n * @property {function()} start\n *   The function which starts the operation.\n * @property {!shaka.util.PublicPromise} p\n *   The PublicPromise which is associated with this operation.\n */\nshaka.media.MediaSourceEngine.Operation;\n\n\n/**\n * Checks if a certain type is supported.\n *\n * @param {string} mimeType\n * @return {boolean}\n */\nshaka.media.MediaSourceEngine.isTypeSupported = function(mimeType) {\n  return shaka.media.TextEngine.isTypeSupported(mimeType) ||\n         MediaSource.isTypeSupported(mimeType);\n};\n\n\n/**\n * Returns true if the browser has the basic APIs we need.\n *\n * @return {boolean}\n */\nshaka.media.MediaSourceEngine.isBrowserSupported = function() {\n  return !!window.MediaSource && !!window.MediaSource.isTypeSupported;\n};\n\n\n/**\n * Returns a map of MediaSource support for well-known types.\n *\n * @return {!Object.<string, boolean>}\n */\nshaka.media.MediaSourceEngine.probeSupport = function() {\n  goog.asserts.assert(shaka.media.MediaSourceEngine.isBrowserSupported(),\n                      'Requires basic support');\n  var support = {};\n  var testMimeTypes = [\n    // MP4 types\n    'video/mp4; codecs=\"avc1.42E01E\"',\n    'video/mp4; codecs=\"avc3.42E01E\"',\n    'video/mp4; codecs=\"hvc1.1.6.L93.90\"',\n    'audio/mp4; codecs=\"mp4a.40.2\"',\n    'audio/mp4; codecs=\"ac-3\"',\n    'audio/mp4; codecs=\"ec-3\"',\n    // WebM types\n    'video/webm; codecs=\"vp8\"',\n    'video/webm; codecs=\"vp9\"',\n    'video/webm; codecs=\"av1\"',\n    'audio/webm; codecs=\"vorbis\"',\n    'audio/webm; codecs=\"opus\"',\n    // MPEG2 TS types (video/ is also used for audio: http://goo.gl/tYHXiS)\n    'video/mp2t; codecs=\"avc1.42E01E\"',\n    'video/mp2t; codecs=\"avc3.42E01E\"',\n    'video/mp2t; codecs=\"hvc1.1.6.L93.90\"',\n    'video/mp2t; codecs=\"mp4a.40.2\"',\n    'video/mp2t; codecs=\"ac-3\"',\n    'video/mp2t; codecs=\"ec-3\"',\n    'video/mp2t; codecs=\"mp4a.40.2\"',\n    // WebVTT types\n    'text/vtt',\n    'application/mp4; codecs=\"wvtt\"',\n    // TTML types\n    'application/ttml+xml',\n    'application/mp4; codecs=\"stpp\"'\n  ];\n\n  testMimeTypes.forEach(function(type) {\n    support[type] = shaka.media.MediaSourceEngine.isTypeSupported(type);\n    var basicType = type.split(';')[0];\n    support[basicType] = support[basicType] || support[type];\n  });\n\n  return support;\n};\n\n\n/**\n * @override\n */\nshaka.media.MediaSourceEngine.prototype.destroy = function() {\n  var Functional = shaka.util.Functional;\n  this.destroyed_ = true;\n\n  var cleanup = [];\n\n  for (var contentType in this.queues_) {\n    // Make a local copy of the queue and the first item.\n    var q = this.queues_[contentType];\n    var inProgress = q[0];\n\n    // Drop everything else out of the queue.\n    this.queues_[contentType] = q.slice(0, 1);\n\n    // We will wait for this item to complete/fail.\n    if (inProgress) {\n      cleanup.push(inProgress.p.catch(Functional.noop));\n    }\n\n    // The rest will be rejected silently if possible.\n    for (var i = 1; i < q.length; ++i) {\n      q[i].p.catch(Functional.noop);\n      q[i].p.reject();\n    }\n  }\n\n  if (this.textEngine_) {\n    cleanup.push(this.textEngine_.destroy());\n  }\n\n  return Promise.all(cleanup).then(function() {\n    this.eventManager_.destroy();\n    this.eventManager_ = null;\n    this.video_ = null;\n    this.mediaSource_ = null;\n    this.textTrack_ = null;\n    this.textEngine_ = null;\n    this.sourceBuffers_ = {};\n    if (!COMPILED) {\n      for (var contentType in this.queues_) {\n        goog.asserts.assert(\n            this.queues_[contentType].length == 0,\n            contentType + ' queue should be empty after destroy!');\n      }\n    }\n    this.queues_ = {};\n  }.bind(this));\n};\n\n\n/**\n * Initialize MediaSourceEngine.\n *\n * Note that it is not valid to call this multiple times, except to add or\n * reinitialize text streams.\n *\n * @param {!Object.<shaka.util.ManifestParserUtils.ContentType, string>}\n *   typeConfig A map of content types to full MIME types.\n *   For example: { 'audio': 'audio/webm; codecs=\"vorbis\"',\n *   'video': 'video/webm; codecs=\"vp9\"', 'text': 'text/vtt' }.\n *   All types given must be supported.\n *\n * @throws InvalidAccessError if blank MIME types are given\n * @throws NotSupportedError if unsupported MIME types are given\n * @throws QuotaExceededError if the browser can't support that many buffers\n */\nshaka.media.MediaSourceEngine.prototype.init = function(typeConfig) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  for (var contentType in typeConfig) {\n    var mimeType = typeConfig[contentType];\n    goog.asserts.assert(\n        shaka.media.MediaSourceEngine.isTypeSupported(mimeType),\n        'Type negotiation should happen before MediaSourceEngine.init!');\n\n    if (contentType == ContentType.TEXT) {\n      this.reinitText(mimeType);\n    } else {\n      var sourceBuffer = this.mediaSource_.addSourceBuffer(mimeType);\n      this.eventManager_.listen(\n          sourceBuffer, 'error', this.onError_.bind(this, contentType));\n      this.eventManager_.listen(\n          sourceBuffer, 'updateend', this.onUpdateEnd_.bind(this, contentType));\n      this.sourceBuffers_[contentType] = sourceBuffer;\n      this.queues_[contentType] = [];\n    }\n  }\n};\n\n\n/**\n * Reinitialize the TextEngine for a new text type.\n * @param {string} mimeType\n */\nshaka.media.MediaSourceEngine.prototype.reinitText = function(mimeType) {\n  if (!this.textEngine_) {\n    this.textEngine_ = new shaka.media.TextEngine(this.textTrack_);\n  }\n  this.textEngine_.initParser(mimeType);\n};\n\n\n/**\n * Gets the first timestamp in buffer for the given content type.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @return {?number} The timestamp in seconds, or null if nothing is buffered.\n */\nshaka.media.MediaSourceEngine.prototype.bufferStart = function(contentType) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    return this.textEngine_.bufferStart();\n  }\n  return shaka.media.TimeRangesUtils.bufferStart(\n      this.getBuffered_(contentType));\n};\n\n\n/**\n * Gets the last timestamp in buffer for the given content type.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @return {?number} The timestamp in seconds, or null if nothing is buffered.\n */\nshaka.media.MediaSourceEngine.prototype.bufferEnd = function(contentType) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    return this.textEngine_.bufferEnd();\n  }\n  return shaka.media.TimeRangesUtils.bufferEnd(this.getBuffered_(contentType));\n};\n\n\n/**\n * Determines if the given time is inside the buffered range of the given\n * content type.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {number} time\n * @return {boolean}\n */\nshaka.media.MediaSourceEngine.prototype.isBuffered = function(\n    contentType, time) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    return this.textEngine_.isBuffered(time);\n  } else {\n    var buffered = this.getBuffered_(contentType);\n    return shaka.media.TimeRangesUtils.isBuffered(buffered, time);\n  }\n};\n\n\n/**\n * Computes how far ahead of the given timestamp is buffered for the given\n * content type.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {number} time\n * @return {number} The amount of time buffered ahead in seconds.\n */\nshaka.media.MediaSourceEngine.prototype.bufferedAheadOf =\n    function(contentType, time) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    return this.textEngine_.bufferedAheadOf(time);\n  } else {\n    var buffered = this.getBuffered_(contentType);\n    return shaka.media.TimeRangesUtils.bufferedAheadOf(buffered, time);\n  }\n};\n\n\n/**\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @return {TimeRanges} The buffered ranges for the given content type, or\n *   null if the buffered ranges could not be obtained.\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.getBuffered_ = function(contentType) {\n  try {\n    return this.sourceBuffers_[contentType].buffered;\n  } catch (exception) {\n    // Note: previous MediaSource errors may cause access to |buffered| to\n    // throw.\n    shaka.log.error('failed to get buffered range for ' + contentType,\n                    exception);\n    return null;\n  }\n};\n\n\n/**\n * Enqueue an operation to append data to the SourceBuffer.\n * Start and end times are needed for TextEngine, but not for MediaSource.\n * Start and end times may be null for initialization segments, if present they\n * are relative to the presentation timeline.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {!ArrayBuffer} data\n * @param {?number} startTime\n * @param {?number} endTime\n * @return {!Promise}\n */\nshaka.media.MediaSourceEngine.prototype.appendBuffer =\n    function(contentType, data, startTime, endTime) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    return this.textEngine_.appendBuffer(data, startTime, endTime);\n  }\n  return this.enqueueOperation_(\n      contentType,\n      this.append_.bind(this, contentType, data));\n};\n\n\n/**\n * Enqueue an operation to remove data from the SourceBuffer.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {number} startTime\n * @param {number} endTime\n * @return {!Promise}\n */\nshaka.media.MediaSourceEngine.prototype.remove =\n    function(contentType, startTime, endTime) {\n  // On IE11, this operation would be permitted, but would have no effect!\n  // See https://github.com/google/shaka-player/issues/251\n  goog.asserts.assert(endTime < Number.MAX_VALUE,\n      'remove() with MAX_VALUE or Infinity is not IE-compatible!');\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    return this.textEngine_.remove(startTime, endTime);\n  }\n  return this.enqueueOperation_(\n      contentType,\n      this.remove_.bind(this, contentType, startTime, endTime));\n};\n\n\n/**\n * Enqueue an operation to clear the SourceBuffer.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @return {!Promise}\n */\nshaka.media.MediaSourceEngine.prototype.clear = function(contentType) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    return this.textEngine_.remove(0, Infinity);\n  }\n  // Note that not all platforms allow clearing to Infinity.\n  return this.enqueueOperation_(\n      contentType,\n      this.remove_.bind(this, contentType, 0, this.mediaSource_.duration));\n};\n\n\n/**\n * Enqueue an operation to flush the SourceBuffer.\n * This is a workaround for what we believe is a Chromecast bug.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @return {!Promise}\n */\nshaka.media.MediaSourceEngine.prototype.flush = function(contentType) {\n  // Flush the pipeline.  Necessary on Chromecast, even though we have removed\n  // everything.\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    // Nothing to flush for text.\n    return Promise.resolve();\n  }\n  return this.enqueueOperation_(\n      contentType,\n      this.flush_.bind(this, contentType));\n};\n\n\n/**\n * Sets the timestamp offset and append window end for the given content type.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {number} timestampOffset The timestamp offset. Segments which start\n *   at time t will be inserted at time t + timestampOffset instead. This\n *   value does not affect segments which have already been inserted.\n * @param {?number} appendWindowEnd The timestamp to set the append window end\n *   to. Media beyond this value will be truncated.\n * @return {!Promise}\n */\nshaka.media.MediaSourceEngine.prototype.setStreamProperties = function(\n    contentType, timestampOffset, appendWindowEnd) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    this.textEngine_.setTimestampOffset(timestampOffset);\n    if (appendWindowEnd != null)\n      this.textEngine_.setAppendWindowEnd(appendWindowEnd);\n    return Promise.resolve();\n  }\n\n  if (appendWindowEnd == null)\n    appendWindowEnd = Infinity;\n\n  return Promise.all([\n    // Queue an abort() to help MSE splice together overlapping segments.\n    // We set appendWindowEnd when we change periods in DASH content, and the\n    // period transition may result in overlap.\n    //\n    // An abort() also helps with MPEG2-TS.  When we append a TS segment, we\n    // always enter a PARSING_MEDIA_SEGMENT state and we can't change the\n    // timestamp offset.  By calling abort(), we reset the state so we can\n    // set it.\n    //\n    // Note that abort() resets both appendWindowStart and appendWindowEnd;\n    // however, we don't use appendWindowStart.\n    this.enqueueOperation_(\n        contentType,\n        this.abort_.bind(this, contentType)),\n    this.enqueueOperation_(\n        contentType,\n        this.setTimestampOffset_.bind(this, contentType, timestampOffset)),\n    this.enqueueOperation_(\n        contentType,\n        this.setAppendWindowEnd_.bind(this, contentType, appendWindowEnd))\n  ]);\n};\n\n\n/**\n * @param {string=} opt_reason Valid reasons are 'network' and 'decode'.\n * @return {!Promise}\n * @see http://w3c.github.io/media-source/#idl-def-EndOfStreamError\n */\nshaka.media.MediaSourceEngine.prototype.endOfStream = function(opt_reason) {\n  return this.enqueueBlockingOperation_(function() {\n    // Chrome won't let me pass undefined, but it will let me omit the\n    // argument.  Firefox does not have this problem.\n    // TODO: File a bug about this.\n    if (opt_reason) {\n      this.mediaSource_.endOfStream(opt_reason);\n    } else {\n      this.mediaSource_.endOfStream();\n    }\n  }.bind(this));\n};\n\n\n/**\n * We only support increasing duration at this time.  Decreasing duration\n * causes the MSE removal algorithm to run, which results in an 'updateend'\n * event.  Supporting this scenario would be complicated, and is not currently\n * needed.\n *\n * @param {number} duration\n * @return {!Promise}\n */\nshaka.media.MediaSourceEngine.prototype.setDuration = function(duration) {\n  goog.asserts.assert(\n      isNaN(this.mediaSource_.duration) ||\n          this.mediaSource_.duration <= duration,\n      'duration cannot decrease: ' + this.mediaSource_.duration + ' -> ' +\n          duration);\n  return this.enqueueBlockingOperation_(function() {\n    this.mediaSource_.duration = duration;\n  }.bind(this));\n};\n\n\n/**\n * Get the current MediaSource duration.\n *\n * @return {number}\n */\nshaka.media.MediaSourceEngine.prototype.getDuration = function() {\n  return this.mediaSource_.duration;\n};\n\n\n/**\n * Append data to the SourceBuffer.\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {!ArrayBuffer} data\n * @throws QuotaExceededError if the browser's buffer is full\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.append_ =\n    function(contentType, data) {\n  // This will trigger an 'updateend' event.\n  this.sourceBuffers_[contentType].appendBuffer(data);\n};\n\n\n/**\n * Remove data from the SourceBuffer.\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {number} startTime\n * @param {number} endTime\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.remove_ =\n    function(contentType, startTime, endTime) {\n  if (endTime <= startTime) {\n    // Ignore removal of inverted or empty ranges.\n    // Fake 'updateend' event to resolve the operation.\n    this.onUpdateEnd_(contentType);\n    return;\n  }\n\n  // This will trigger an 'updateend' event.\n  this.sourceBuffers_[contentType].remove(startTime, endTime);\n};\n\n\n/**\n * Call abort() on the SourceBuffer.\n * This resets MSE's last_decode_timestamp on all track buffers, which should\n * trigger the splicing logic for overlapping segments.\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.abort_ = function(contentType) {\n  // Save the append window end, which is reset on abort().\n  var appendWindowEnd = this.sourceBuffers_[contentType].appendWindowEnd;\n\n  // This will not trigger an 'updateend' event, since nothing is happening.\n  // This is only to reset MSE internals, not to abort an actual operation.\n  this.sourceBuffers_[contentType].abort();\n\n  // Restore the append window end.\n  this.sourceBuffers_[contentType].appendWindowEnd = appendWindowEnd;\n\n  // Fake 'updateend' event to resolve the operation.\n  this.onUpdateEnd_(contentType);\n};\n\n\n/**\n * Nudge the playhead to force the media pipeline to be flushed.\n * This seems to be necessary on Chromecast to get new content to replace old\n * content.\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.flush_ = function(contentType) {\n  // Never use flush_ if there's data.  It causes a hiccup in playback.\n  goog.asserts.assert(\n      this.video_.buffered.length == 0,\n      'MediaSourceEngine.flush_ should only be used after clearing all data!');\n\n  // Seeking forces the pipeline to be flushed.\n  this.video_.currentTime -= 0.001;\n\n  // Fake 'updateend' event to resolve the operation.\n  this.onUpdateEnd_(contentType);\n};\n\n\n/**\n * Set the SourceBuffer's timestamp offset.\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {number} timestampOffset\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.setTimestampOffset_ =\n    function(contentType, timestampOffset) {\n  this.sourceBuffers_[contentType].timestampOffset = timestampOffset;\n\n  // Fake 'updateend' event to resolve the operation.\n  this.onUpdateEnd_(contentType);\n};\n\n\n/**\n * Set the SourceBuffer's append window end.\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {number} appendWindowEnd\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.setAppendWindowEnd_ =\n    function(contentType, appendWindowEnd) {\n  var fudge = 1 / 25;  // one frame, assuming a low framerate\n  this.sourceBuffers_[contentType].appendWindowEnd = appendWindowEnd + fudge;\n\n  // Fake 'updateend' event to resolve the operation.\n  this.onUpdateEnd_(contentType);\n};\n\n\n/**\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {!Event} event\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.onError_ =\n    function(contentType, event) {\n  var operation = this.queues_[contentType][0];\n  goog.asserts.assert(operation, 'Spurious error event!');\n  goog.asserts.assert(!this.sourceBuffers_[contentType].updating,\n                      'SourceBuffer should not be updating on error!');\n  var code = this.video_.error ? this.video_.error.code : 0;\n  operation.p.reject(new shaka.util.Error(\n      shaka.util.Error.Severity.CRITICAL,\n      shaka.util.Error.Category.MEDIA,\n      shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_FAILED,\n      code));\n  // Do not pop from queue.  An 'updateend' event will fire next, and to avoid\n  // synchronizing these two event handlers, we will allow that one to pop from\n  // the queue as normal.  Note that because the operation has already been\n  // rejected, the call to resolve() in the 'updateend' handler will have no\n  // effect.\n};\n\n\n/**\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.onUpdateEnd_ = function(contentType) {\n  var operation = this.queues_[contentType][0];\n  goog.asserts.assert(operation, 'Spurious updateend event!');\n  if (!operation) return;\n  goog.asserts.assert(!this.sourceBuffers_[contentType].updating,\n                      'SourceBuffer should not be updating on updateend!');\n  operation.p.resolve();\n  this.popFromQueue_(contentType);\n};\n\n\n/**\n * Enqueue an operation and start it if appropriate.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @param {function()} start\n * @return {!Promise}\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.enqueueOperation_ =\n    function(contentType, start) {\n  if (this.destroyed_) return Promise.reject();\n\n  var operation = {\n    start: start,\n    p: new shaka.util.PublicPromise()\n  };\n  this.queues_[contentType].push(operation);\n\n  if (this.queues_[contentType].length == 1) {\n    try {\n      operation.start();\n    } catch (exception) {\n      if (exception.name == 'QuotaExceededError') {\n        operation.p.reject(new shaka.util.Error(\n            shaka.util.Error.Severity.CRITICAL,\n            shaka.util.Error.Category.MEDIA,\n            shaka.util.Error.Code.QUOTA_EXCEEDED_ERROR,\n            contentType));\n      } else {\n        operation.p.reject(new shaka.util.Error(\n            shaka.util.Error.Severity.CRITICAL,\n            shaka.util.Error.Category.MEDIA,\n            shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,\n            exception));\n      }\n      this.popFromQueue_(contentType);\n    }\n  }\n  return operation.p;\n};\n\n\n/**\n * Enqueue an operation which must block all other operations on all\n * SourceBuffers.\n *\n * @param {function()} run\n * @return {!Promise}\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.enqueueBlockingOperation_ =\n    function(run) {\n  if (this.destroyed_) return Promise.reject();\n\n  var allWaiters = [];\n\n  // Enqueue a 'wait' operation onto each queue.\n  // This operation signals its readiness when it starts.\n  // When all wait operations are ready, the real operation takes place.\n  for (var contentType in this.sourceBuffers_) {\n    var ready = new shaka.util.PublicPromise();\n    var operation = {\n      start: function(ready) { ready.resolve(); }.bind(null, ready),\n      p: ready\n    };\n\n    this.queues_[contentType].push(operation);\n    allWaiters.push(ready);\n\n    if (this.queues_[contentType].length == 1) {\n      operation.start();\n    }\n  }\n\n  // Return a Promise to the real operation, which waits to begin until there\n  // are no other in-progress operations on any SourceBuffers.\n  return Promise.all(allWaiters).then(function() {\n    if (!COMPILED) {\n      // If we did it correctly, nothing is updating.\n      for (var contentType in this.sourceBuffers_) {\n        goog.asserts.assert(\n            this.sourceBuffers_[contentType].updating == false,\n            'SourceBuffers should not be updating after a blocking op!');\n      }\n    }\n\n    var ret;\n    // Run the real operation, which is synchronous.\n    try {\n      run();\n    } catch (exception) {\n      ret = Promise.reject(new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.MEDIA,\n          shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,\n          exception));\n    }\n\n    // Unblock the queues.\n    for (var contentType in this.sourceBuffers_) {\n      this.popFromQueue_(contentType);\n    }\n\n    return ret;\n  }.bind(this), function() {\n    // One of the waiters failed, which means we've been destroyed.\n    goog.asserts.assert(this.destroyed_, 'Should be destroyed by now');\n    // We haven't popped from the queue.  Canceled waiters have been removed by\n    // destroy.  What's left now should just be resolved waiters.  In uncompiled\n    // mode, we will maintain good hygiene and make sure the assert at the end\n    // of destroy passes.  In compiled mode, the queues are wiped in destroy.\n    if (!COMPILED) {\n      for (var contentType in this.sourceBuffers_) {\n        if (this.queues_[contentType].length) {\n          goog.asserts.assert(\n              this.queues_[contentType].length == 1,\n              'Should be at most one item in queue!');\n          goog.asserts.assert(\n              allWaiters.indexOf(this.queues_[contentType][0].p) != -1,\n              'The item in queue should be one of our waiters!');\n          this.queues_[contentType].shift();\n        }\n      }\n    }\n    return Promise.reject();\n  }.bind(this));\n};\n\n\n/**\n * Pop from the front of the queue and start a new operation.\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n * @private\n */\nshaka.media.MediaSourceEngine.prototype.popFromQueue_ = function(contentType) {\n  // Remove the in-progress operation, which is now complete.\n  this.queues_[contentType].shift();\n  // Retrieve the next operation, if any, from the queue and start it.\n  var next = this.queues_[contentType][0];\n  if (next) {\n    try {\n      next.start();\n    } catch (exception) {\n      next.p.reject(new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.MEDIA,\n          shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,\n          exception));\n      this.popFromQueue_(contentType);\n    }\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/media_source_engine.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.LanguageUtils');\n\ngoog.require('goog.asserts');\n\n\n/**\n * @namespace shaka.util.LanguageUtils\n * @summary A set of language utility functions.\n */\n\n\n/**\n * Compares two language tags as defined by RFC 5646 and ISO 639.  The\n * comparison takes sublanguages into account via the |fuzz| parameter.\n * The caller is expected to normalize the inputs first.\n *\n * @see shaka.util.LanguageUtils.normalize()\n * @see IETF RFC 5646\n * @see ISO 639\n *\n * @param {shaka.util.LanguageUtils.MatchType} fuzz What kind of match is\n *   acceptable.\n * @param {string} preference The user's preferred language tag.\n * @param {string} candidate An available language tag.\n * @return {boolean}\n */\nshaka.util.LanguageUtils.match = function(fuzz, preference, candidate) {\n  // Alias.\n  var LanguageUtils = shaka.util.LanguageUtils;\n\n  goog.asserts.assert(preference == LanguageUtils.normalize(preference),\n                      'Language pref should be normalized first');\n  goog.asserts.assert(candidate == LanguageUtils.normalize(candidate),\n                      'Language candidate should be normalized first');\n\n  if (candidate == preference) {\n    return true;\n  }\n\n  if (fuzz >= shaka.util.LanguageUtils.MatchType.BASE_LANGUAGE_OKAY &&\n      candidate == preference.split('-')[0]) {\n    return true;\n  }\n\n  if (fuzz >= shaka.util.LanguageUtils.MatchType.OTHER_SUB_LANGUAGE_OKAY &&\n      candidate.split('-')[0] == preference.split('-')[0]) {\n    return true;\n  }\n\n  return false;\n};\n\n\n/**\n * A match type for fuzzy-matching logic.\n *\n * @enum {number}\n */\nshaka.util.LanguageUtils.MatchType = {\n  /** Accepts an exact match. */\n  EXACT: 0,\n  /** Accepts a less-specific version of the preferred sublanguage. */\n  BASE_LANGUAGE_OKAY: 1,\n  /** Accepts a different sublanguage of the preferred base language. */\n  OTHER_SUB_LANGUAGE_OKAY: 2\n};\n\n\n/**\n * Normalize the language tag.\n *\n * RFC 5646 specifies that language tags are case insensitive and that the\n * shortest representation of the base language should always be used.\n * This will convert the tag to lower-case and map 3-letter codes (ISO 639-2)\n * to 2-letter codes (ISO 639-1) whenever possible.\n *\n * @param {string} lang\n * @return {string}\n *\n * @see IETF RFC 5646\n * @see ISO 639\n */\nshaka.util.LanguageUtils.normalize = function(lang) {\n  var fields = lang.toLowerCase().split('-');\n  var base = fields[0];\n  var replacement = shaka.util.LanguageUtils.isoMap_[base];\n  if (replacement) {\n    fields[0] = replacement;\n  }\n  return fields.join('-');\n};\n\n\n/**\n * A map from 3-letter language codes (ISO 639-2) to 2-letter language codes\n * (ISO 639-1) for all languages which have both in the registry.\n *\n * @const {!Object.<string, string>}\n * @private\n */\nshaka.util.LanguageUtils.isoMap_ = {\n  'aar': 'aa', 'abk': 'ab', 'afr': 'af', 'aka': 'ak', 'alb': 'sq', 'amh': 'am',\n  'ara': 'ar', 'arg': 'an', 'arm': 'hy', 'asm': 'as', 'ava': 'av', 'ave': 'ae',\n  'aym': 'ay', 'aze': 'az', 'bak': 'ba', 'bam': 'bm', 'baq': 'eu', 'bel': 'be',\n  'ben': 'bn', 'bih': 'bh', 'bis': 'bi', 'bod': 'bo', 'bos': 'bs', 'bre': 'br',\n  'bul': 'bg', 'bur': 'my', 'cat': 'ca', 'ces': 'cs', 'cha': 'ch', 'che': 'ce',\n  'chi': 'zh', 'chu': 'cu', 'chv': 'cv', 'cor': 'kw', 'cos': 'co', 'cre': 'cr',\n  'cym': 'cy', 'cze': 'cs', 'dan': 'da', 'deu': 'de', 'div': 'dv', 'dut': 'nl',\n  'dzo': 'dz', 'ell': 'el', 'eng': 'en', 'epo': 'eo', 'est': 'et', 'eus': 'eu',\n  'ewe': 'ee', 'fao': 'fo', 'fas': 'fa', 'fij': 'fj', 'fin': 'fi', 'fra': 'fr',\n  'fre': 'fr', 'fry': 'fy', 'ful': 'ff', 'geo': 'ka', 'ger': 'de', 'gla': 'gd',\n  'gle': 'ga', 'glg': 'gl', 'glv': 'gv', 'gre': 'el', 'grn': 'gn', 'guj': 'gu',\n  'hat': 'ht', 'hau': 'ha', 'heb': 'he', 'her': 'hz', 'hin': 'hi', 'hmo': 'ho',\n  'hrv': 'hr', 'hun': 'hu', 'hye': 'hy', 'ibo': 'ig', 'ice': 'is', 'ido': 'io',\n  'iii': 'ii', 'iku': 'iu', 'ile': 'ie', 'ina': 'ia', 'ind': 'id', 'ipk': 'ik',\n  'isl': 'is', 'ita': 'it', 'jav': 'jv', 'jpn': 'ja', 'kal': 'kl', 'kan': 'kn',\n  'kas': 'ks', 'kat': 'ka', 'kau': 'kr', 'kaz': 'kk', 'khm': 'km', 'kik': 'ki',\n  'kin': 'rw', 'kir': 'ky', 'kom': 'kv', 'kon': 'kg', 'kor': 'ko', 'kua': 'kj',\n  'kur': 'ku', 'lao': 'lo', 'lat': 'la', 'lav': 'lv', 'lim': 'li', 'lin': 'ln',\n  'lit': 'lt', 'ltz': 'lb', 'lub': 'lu', 'lug': 'lg', 'mac': 'mk', 'mah': 'mh',\n  'mal': 'ml', 'mao': 'mi', 'mar': 'mr', 'may': 'ms', 'mkd': 'mk', 'mlg': 'mg',\n  'mlt': 'mt', 'mon': 'mn', 'mri': 'mi', 'msa': 'ms', 'mya': 'my', 'nau': 'na',\n  'nav': 'nv', 'nbl': 'nr', 'nde': 'nd', 'ndo': 'ng', 'nep': 'ne', 'nld': 'nl',\n  'nno': 'nn', 'nob': 'nb', 'nor': 'no', 'nya': 'ny', 'oci': 'oc', 'oji': 'oj',\n  'ori': 'or', 'orm': 'om', 'oss': 'os', 'pan': 'pa', 'per': 'fa', 'pli': 'pi',\n  'pol': 'pl', 'por': 'pt', 'pus': 'ps', 'que': 'qu', 'roh': 'rm', 'ron': 'ro',\n  'rum': 'ro', 'run': 'rn', 'rus': 'ru', 'sag': 'sg', 'san': 'sa', 'sin': 'si',\n  'slk': 'sk', 'slo': 'sk', 'slv': 'sl', 'sme': 'se', 'smo': 'sm', 'sna': 'sn',\n  'snd': 'sd', 'som': 'so', 'sot': 'st', 'spa': 'es', 'sqi': 'sq', 'srd': 'sc',\n  'srp': 'sr', 'ssw': 'ss', 'sun': 'su', 'swa': 'sw', 'swe': 'sv', 'tah': 'ty',\n  'tam': 'ta', 'tat': 'tt', 'tel': 'te', 'tgk': 'tg', 'tgl': 'tl', 'tha': 'th',\n  'tib': 'bo', 'tir': 'ti', 'ton': 'to', 'tsn': 'tn', 'tso': 'ts', 'tuk': 'tk',\n  'tur': 'tr', 'twi': 'tw', 'uig': 'ug', 'ukr': 'uk', 'urd': 'ur', 'uzb': 'uz',\n  'ven': 've', 'vie': 'vi', 'vol': 'vo', 'wel': 'cy', 'wln': 'wa', 'wol': 'wo',\n  'xho': 'xh', 'yid': 'yi', 'yor': 'yo', 'zha': 'za', 'zho': 'zh', 'zul': 'zu'\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/language_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.StreamUtils');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.DrmEngine');\ngoog.require('shaka.media.MediaSourceEngine');\ngoog.require('shaka.media.TextEngine');\ngoog.require('shaka.util.ArrayUtils');\ngoog.require('shaka.util.LanguageUtils');\ngoog.require('shaka.util.ManifestParserUtils');\n\n\n/**\n * @param {shakaExtern.Variant} variant\n * @param {shakaExtern.Restrictions} restrictions\n *   Configured restrictions from the user.\n * @param {{width: number, height: number}} maxHwRes\n *   The maximum resolution the hardware can handle.\n *   This is applied separately from user restrictions because the setting\n *   should not be easily replaced by the user's configuration.\n * @return {boolean}\n */\nshaka.util.StreamUtils.meetsRestrictions = function(\n    variant, restrictions, maxHwRes) {\n  var video = variant.video;\n  if (video) {\n    if (video.width < restrictions.minWidth ||\n        video.width > restrictions.maxWidth || video.width > maxHwRes.width ||\n        video.height < restrictions.minHeight ||\n        video.height > restrictions.maxHeight ||\n        video.height > maxHwRes.height ||\n        (video.width * video.height) < restrictions.minPixels ||\n        (video.width * video.height) > restrictions.maxPixels) {\n      return false;\n    }\n  }\n\n  if (variant.bandwidth < restrictions.minBandwidth ||\n      variant.bandwidth > restrictions.maxBandwidth) {\n    return false;\n  }\n\n  return true;\n};\n\n\n/**\n * @param {shakaExtern.Period} period\n * @param {shakaExtern.Restrictions} restrictions\n * @param {{width: number, height: number}} maxHwRes\n * @return {boolean} Whether the tracks changed.\n */\nshaka.util.StreamUtils.applyRestrictions =\n    function(period, restrictions, maxHwRes) {\n  var tracksChanged = false;\n\n  period.variants.forEach(function(variant) {\n    var originalAllowed = variant.allowedByApplication;\n    variant.allowedByApplication = shaka.util.StreamUtils.meetsRestrictions(\n        variant, restrictions, maxHwRes);\n\n    if (originalAllowed != variant.allowedByApplication) {\n      tracksChanged = true;\n    }\n  });\n\n  return tracksChanged;\n};\n\n\n/**\n * Alters the given Period to filter out any unplayable streams.\n *\n * @param {shaka.media.DrmEngine} drmEngine\n * @param {!Object.<string, shakaExtern.Stream>} activeStreams\n * @param {shakaExtern.Period} period\n */\nshaka.util.StreamUtils.filterPeriod = function(\n    drmEngine, activeStreams, period) {\n  var StreamUtils = shaka.util.StreamUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  var activeVideo = activeStreams[ContentType.VIDEO];\n  var activeAudio = activeStreams[ContentType.AUDIO];\n\n  // Filter variants\n  for (var i = 0; i < period.variants.length; ++i) {\n    var variant = period.variants[i];\n    if (!StreamUtils.variantIsCompatible_(\n        variant, drmEngine, activeAudio, activeVideo)) {\n      shaka.log.debug('Dropping Variant (not compatible with key system, ' +\n                      'platform, or active Variant)', variant);\n      period.variants.splice(i, 1);\n      --i;\n      continue;\n    }\n  }\n\n  // Filter text streams\n  for (var i = 0; i < period.textStreams.length; ++i) {\n    var stream = period.textStreams[i];\n    var fullMimeType = StreamUtils.getFullMimeType(\n        stream.mimeType, stream.codecs);\n    if (!shaka.media.TextEngine.isTypeSupported(fullMimeType)) {\n      shaka.log.debug('Dropping text stream. Is not supported by the ' +\n                      'platform.', stream);\n      period.textStreams.splice(i, 1);\n      --i;\n    }\n  }\n};\n\n\n/**\n * Checks if a stream is compatible with the key system, platform,\n * and active stream.\n *\n * @param {?shakaExtern.Stream} stream\n * @param {shaka.media.DrmEngine} drmEngine\n * @param {?shakaExtern.Stream} activeStream\n * @return {boolean}\n * @private\n */\nshaka.util.StreamUtils.streamIsCompatible_ =\n    function(stream, drmEngine, activeStream) {\n  if (!stream) return true;\n\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  goog.asserts.assert(stream.type != ContentType.TEXT,\n      'Should not be called on a text stream!');\n\n  var drmSupportedMimeTypes = null;\n  if (drmEngine && drmEngine.initialized()) {\n    drmSupportedMimeTypes = drmEngine.getSupportedTypes();\n  }\n\n  // Check if stream can be played by the platform\n  var fullMimeType = shaka.util.StreamUtils.getFullMimeType(\n      stream.mimeType, stream.codecs);\n\n  if (!shaka.media.MediaSourceEngine.isTypeSupported(fullMimeType))\n    return false;\n\n  // Check if stream can be handled by the key system.\n  // There's no need to check that the stream is supported by the\n  // chosen key system since the caller has already verified that.\n  if (drmSupportedMimeTypes && stream.encrypted &&\n      drmSupportedMimeTypes.indexOf(fullMimeType) < 0) {\n    return false;\n  }\n\n  // Lastly, check if active stream can switch to the stream\n  // Basic mime types and basic codecs need to match.\n  // For example, we can't adapt between WebM and MP4,\n  // nor can we adapt between mp4a.* to ec-3.\n  // We can switch between text types on the fly,\n  // so don't run this check on text.\n  if (activeStream) {\n    if (stream.mimeType != activeStream.mimeType ||\n        stream.codecs.split('.')[0] != activeStream.codecs.split('.')[0]) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\n\n/**\n * Checks if a variant is compatible with the key system, platform,\n * and active stream.\n *\n * @param {!shakaExtern.Variant} variant\n * @param {shaka.media.DrmEngine} drmEngine\n * @param {shakaExtern.Stream} activeAudio\n * @param {shakaExtern.Stream} activeVideo\n * @return {boolean}\n * @private\n */\nshaka.util.StreamUtils.variantIsCompatible_ =\n    function(variant, drmEngine, activeAudio, activeVideo) {\n  var StreamUtils = shaka.util.StreamUtils;\n  if (drmEngine && drmEngine.initialized()) {\n    if (!drmEngine.isSupportedByKeySystem(variant)) return false;\n  }\n\n  return StreamUtils.streamIsCompatible_(variant.audio,\n                                         drmEngine,\n                                         activeAudio) &&\n         StreamUtils.streamIsCompatible_(variant.video, drmEngine, activeVideo);\n};\n\n\n/**\n * Gets an array of Track objects for the given Period\n *\n * @param {shakaExtern.Period} period\n * @param {?number} activeAudioId\n * @param {?number} activeVideoId\n * @return {!Array.<shakaExtern.Track>}\n */\nshaka.util.StreamUtils.getVariantTracks =\n    function(period, activeAudioId, activeVideoId) {\n  var StreamUtils = shaka.util.StreamUtils;\n  var variants = StreamUtils.getPlayableVariants(period.variants);\n  var label = null;\n  var tracks = variants.map(function(variant) {\n    var isActive;\n    if (variant.video && variant.audio) {\n      isActive = activeVideoId == variant.video.id &&\n                 activeAudioId == variant.audio.id;\n    } else {\n      isActive = (variant.video && activeVideoId == variant.video.id) ||\n                 (variant.audio && activeAudioId == variant.audio.id);\n    }\n    var codecs = '';\n    if (variant.video) codecs += variant.video.codecs;\n    if (variant.audio) {\n      if (codecs != '') codecs += ', ';\n      codecs += variant.audio.codecs;\n      label = variant.audio.label;\n    }\n\n    var audioCodec = variant.audio ? variant.audio.codecs : null;\n    var videoCodec = variant.video ? variant.video.codecs : null;\n    var mimeType = null;\n    if (variant.video) mimeType = variant.video.mimeType;\n    else if (variant.audio) mimeType = variant.audio.mimeType;\n\n    var kind = null;\n    if (variant.audio) kind = variant.audio.kind;\n    else if (variant.video) kind = variant.video.kind;\n\n    var audioRoles = variant.audio ? variant.audio.roles : [];\n    var videoRoles = variant.video ? variant.video.roles : [];\n    var roles = shaka.util.ArrayUtils.removeDuplicates(\n        audioRoles.concat(videoRoles));\n    return {\n      id: variant.id,\n      active: isActive,\n      type: 'variant',\n      bandwidth: variant.bandwidth,\n      language: variant.language,\n      label: label,\n      kind: kind || null,\n      width: variant.video ? variant.video.width : null,\n      height: variant.video ? variant.video.height : null,\n      frameRate: variant.video ? variant.video.frameRate : undefined,\n      mimeType: mimeType,\n      codecs: codecs,\n      audioCodec: audioCodec,\n      videoCodec: videoCodec,\n      primary: variant.primary,\n      roles: roles,\n      videoId: variant.video ? variant.video.id : null,\n      audioId: variant.audio ? variant.audio.id : null\n    };\n  });\n\n  return tracks;\n};\n\n\n/**\n * Gets an array of text Track objects for the given Period.\n *\n * @param {shakaExtern.Period} period\n * @param {?number} activeStreamId\n * @return {!Array.<shakaExtern.Track>}\n */\nshaka.util.StreamUtils.getTextTracks = function(period, activeStreamId) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  return period.textStreams.map(function(stream) {\n    return {\n      id: stream.id,\n      active: activeStreamId == stream.id,\n      type: ContentType.TEXT,\n      language: stream.language,\n      label: stream.label,\n      kind: stream.kind,\n      mimeType: stream.mimeType,\n      codecs: stream.codecs || null,\n      audioCodec: null,\n      videoCodec: null,\n      primary: stream.primary,\n      roles: stream.roles\n    };\n  });\n};\n\n\n/**\n * Find the Variant for the given track.\n *\n * @param {shakaExtern.Period} period\n * @param {shakaExtern.Track} track\n * @return {?shakaExtern.Variant}\n */\nshaka.util.StreamUtils.findVariantForTrack = function(period, track) {\n  for (var i = 0; i < period.variants.length; i++) {\n    if (period.variants[i].id == track.id)\n      return period.variants[i];\n  }\n  return null;\n};\n\n\n/**\n * Find the text stream for the given track.\n *\n * @param {shakaExtern.Period} period\n * @param {shakaExtern.Track} track\n * @return {?shakaExtern.Stream}\n */\nshaka.util.StreamUtils.findTextStreamForTrack = function(period, track) {\n  for (var i = 0; i < period.textStreams.length; i++) {\n    if (period.textStreams[i].id == track.id)\n      return period.textStreams[i];\n  }\n  return null;\n};\n\n\n/**\n * Determines if the given variant is playable.\n * @param {!shakaExtern.Variant} variant\n * @return {boolean}\n */\nshaka.util.StreamUtils.isPlayable = function(variant) {\n  return variant.allowedByApplication && variant.allowedByKeySystem;\n};\n\n\n/**\n * Filters out not playable variants.\n * @param {!Array.<!shakaExtern.Variant>} variants\n * @return {!Array.<!shakaExtern.Variant>}\n */\nshaka.util.StreamUtils.getPlayableVariants = function(variants) {\n  return variants.filter(function(variant) {\n    return shaka.util.StreamUtils.isPlayable(variant);\n  });\n};\n\n\n/**\n * Chooses variants according to the given config.\n *\n * @param {shakaExtern.Period} period\n * @param {string} preferredLanguage\n * @param {!Object=} opt_languageMatches\n * @param {string=} opt_role\n * @return {!Array.<!shakaExtern.Variant>}\n */\nshaka.util.StreamUtils.filterVariantsByRoleAndLanguage = function(\n    period, preferredLanguage, opt_languageMatches, opt_role) {\n  var LanguageUtils = shaka.util.LanguageUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var variants = shaka.util.StreamUtils.getPlayableVariants(period.variants);\n\n  // Initially choose the first language in the list.\n  /** @type {!Array.<!shakaExtern.Variant>} */\n  var chosen = variants.filter(function(variant) {\n    return variant.language == variants[0].language;\n  });\n\n  // Prefer primary variants.\n  var primaryVariants = variants.filter(function(variant) {\n    return variant.primary;\n  });\n  if (primaryVariants.length) chosen = primaryVariants;\n\n  // Choose based on language preference.  Favor exact matches, then\n  // base matches, finally different subtags.  Execute in reverse order so\n  // the later steps override the previous ones.\n  if (preferredLanguage) {\n    var pref = LanguageUtils.normalize(preferredLanguage);\n    [LanguageUtils.MatchType.OTHER_SUB_LANGUAGE_OKAY,\n     LanguageUtils.MatchType.BASE_LANGUAGE_OKAY,\n     LanguageUtils.MatchType.EXACT]\n        .forEach(function(matchType) {\n          var betterLangMatchFound = false;\n          variants.forEach(function(variant) {\n            pref = LanguageUtils.normalize(pref);\n            var lang = LanguageUtils.normalize(variant.language);\n            if (LanguageUtils.match(matchType, pref, lang)) {\n              if (betterLangMatchFound) {\n                chosen.push(variant);\n              } else {\n                chosen = [variant];\n                betterLangMatchFound = true;\n              }\n              if (opt_languageMatches) {\n                opt_languageMatches[ContentType.AUDIO] = true;\n              }\n            }\n          }); // forEach(variant)\n        }); // forEach(matchType)\n  } // if (preferredLanguage)\n\n  // Choose based on role preference. If there's no exact match, return\n  // what was chosen based on the language preference.\n  var role = opt_role || '';\n  if (role) {\n    var chosenWithRoles = chosen.filter(function(variant) {\n      return (variant.audio && (variant.audio.roles.indexOf(role) > - 1)) ||\n             (variant.video && (variant.video.roles.indexOf(role) > - 1));\n    });\n    if (chosenWithRoles.length) return chosenWithRoles;\n    else {\n      shaka.log.warning(\n          'No exact match for the role is found. Returning the selection ' +\n          'based on language preference.');\n    }\n  }\n  return chosen;\n};\n\n\n/**\n * Chooses text streams according to the given config.\n *\n * @param {shakaExtern.Period} period\n * @param {string} preferredLanguage\n * @param {!Object=} opt_languageMatches\n * @param {string=} opt_role\n * @return {!Array.<!shakaExtern.Stream>}\n */\nshaka.util.StreamUtils.filterTextStreamsByRoleAndLanguage = function(\n    period, preferredLanguage, opt_languageMatches, opt_role) {\n  var LanguageUtils = shaka.util.LanguageUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var streams = period.textStreams;\n\n  // Choose all the streams.\n  /** @type {!Array.<!shakaExtern.Stream>} */\n  var chosen = streams;\n\n  // Prefer primary text streams.\n  var primaryStreams = streams.filter(function(stream) {\n    return stream.primary;\n  });\n  if (primaryStreams.length) chosen = primaryStreams;\n\n  // Override based on language preference.  Favor exact matches, then\n  // base matches, finally different subtags.  Execute in reverse order so\n  // the later steps override the previous ones.\n  if (preferredLanguage) {\n    var pref = LanguageUtils.normalize(preferredLanguage);\n    [LanguageUtils.MatchType.OTHER_SUB_LANGUAGE_OKAY,\n     LanguageUtils.MatchType.BASE_LANGUAGE_OKAY,\n     LanguageUtils.MatchType.EXACT]\n        .forEach(function(matchType) {\n          var betterLangMatchFound = false;\n          streams.forEach(function(stream) {\n            var lang = LanguageUtils.normalize(stream.language);\n            if (LanguageUtils.match(matchType, pref, lang)) {\n              if (betterLangMatchFound) {\n                chosen.push(stream);\n              } else {\n                chosen = [stream];\n                betterLangMatchFound = true;\n              }\n              if (opt_languageMatches)\n                opt_languageMatches[ContentType.TEXT] = true;\n            }\n          }); // forEach(stream)\n        }); // forEach(matchType)\n  } // if (preferredLanguage)\n  // Choose based on role preference. If there's no exact match, return\n  // what was chosen based on the language preference.\n  var role = opt_role || '';\n  if (role) {\n    var chosenWithRoles = chosen.filter(function(stream) {\n      return (stream && (stream.roles.indexOf(role) > - 1));\n    });\n    if (chosenWithRoles.length) return chosenWithRoles;\n    else {\n      shaka.log.warning(\n          'No exact match for the role is found. Returning the selection ' +\n          'based on language preference.');\n    }\n  }\n  return chosen;\n};\n\n\n/**\n * Finds a Variant with given audio and video streams.\n * Returns null if none was found.\n *\n * @param {?shakaExtern.Stream} audio\n * @param {?shakaExtern.Stream} video\n * @param {!Array.<!shakaExtern.Variant>} variants\n * @return {?shakaExtern.Variant}\n */\nshaka.util.StreamUtils.getVariantByStreams = function(audio, video, variants) {\n  for (var i = 0; i < variants.length; i++) {\n    if (variants[i].audio == audio && variants[i].video == video)\n      return variants[i];\n  }\n\n  return null;\n};\n\n\n/**\n * Finds a Variant with the given video and audio streams, by stream ID.\n * Returns null if none were found.\n *\n * @param {?number} audioId\n * @param {?number} videoId\n * @param {!Array.<shakaExtern.Variant>} variants\n * @return {?shakaExtern.Variant}\n */\nshaka.util.StreamUtils.getVariantByStreamIds = function(\n    audioId, videoId, variants) {\n  function matchesId(id, stream) {\n    if (id == null)\n      return stream == null;\n    else\n      return stream.id == id;\n  }\n\n  for (var i = 0; i < variants.length; i++) {\n    if (matchesId(audioId, variants[i].audio) &&\n        matchesId(videoId, variants[i].video)) {\n      return variants[i];\n    }\n  }\n\n  return null;\n};\n\n\n/**\n * Takes a MIME type and optional codecs string and produces the full MIME type.\n *\n * @param {string} mimeType\n * @param {string=} opt_codecs\n * @return {string}\n */\nshaka.util.StreamUtils.getFullMimeType = function(mimeType, opt_codecs) {\n  var fullMimeType = mimeType;\n  if (opt_codecs) {\n    fullMimeType += '; codecs=\"' + opt_codecs + '\"';\n  }\n  return fullMimeType;\n};\n\n\n/**\n * Gets the index of the Period that contains the given time.\n * @param {shakaExtern.Manifest} manifest\n * @param {number} time The time in seconds from the start of the presentation.\n * @return {number}\n */\nshaka.util.StreamUtils.findPeriodContainingTime = function(manifest, time) {\n  for (var i = manifest.periods.length - 1; i > 0; --i) {\n    var period = manifest.periods[i];\n    if (time >= period.startTime)\n      return i;\n  }\n  return 0;\n};\n\n\n/**\n * @param {shakaExtern.Manifest} manifest\n * @param {shakaExtern.Stream} stream\n * @return {number} The index of the Period which contains |stream|, or -1 if\n *   no Period contains |stream|.\n */\nshaka.util.StreamUtils.findPeriodContainingStream = function(manifest, stream) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  for (var periodIdx = 0; periodIdx < manifest.periods.length; ++periodIdx) {\n    var period = manifest.periods[periodIdx];\n    if (stream.type == ContentType.TEXT) {\n      for (var j = 0; j < period.textStreams.length; ++j) {\n        var textStream = period.textStreams[j];\n        if (textStream == stream)\n          return periodIdx;\n      }\n    } else {\n      for (var j = 0; j < period.variants.length; ++j) {\n        var variant = period.variants[j];\n        if (variant.audio == stream || variant.video == stream ||\n            (variant.video && variant.video.trickModeVideo == stream)) {\n          return periodIdx;\n        }\n      }\n    }\n  }\n  return -1;\n};\n\n\n/**\n * Gets the rebuffering goal from the manifest and configuration.\n *\n * @param {shakaExtern.Manifest} manifest\n * @param {shakaExtern.StreamingConfiguration} config\n * @param {number} scaleFactor\n *\n * @return {number}\n */\nshaka.util.StreamUtils.getRebufferingGoal = function(\n    manifest, config, scaleFactor) {\n  return scaleFactor *\n         Math.max(manifest.minBufferTime || 0, config.rebufferingGoal);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/stream_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.abr.SimpleAbrManager');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.abr.EwmaBandwidthEstimator');\ngoog.require('shaka.log');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.StreamUtils');\n\n\n\n/**\n * <p>\n * This defines the default ABR manager for the Player.  An instance of this\n * class is used when no ABR manager is given.\n * </p>\n * <p>\n * The behavior of this class is to take throughput samples using\n * segmentDownloaded to estimate the current network bandwidth.  Then it will\n * use that to choose the streams that best fit the current bandwidth.  It will\n * always pick the highest bandwidth variant it thinks can be played.\n * </p>\n * <p>\n * After the initial choice (in chooseStreams), this class will call\n * switchCallback() when there is a better choice.  switchCallback() will not\n * be called more than once per\n * ({@link shaka.abr.SimpleAbrManager.SWITCH_INTERVAL_MS}).\n * </p>\n * <p>\n * This does not adapt for text streams, it will always select the first one.\n * </p>\n *\n * @constructor\n * @struct\n * @implements {shakaExtern.AbrManager}\n * @export\n */\nshaka.abr.SimpleAbrManager = function() {\n  /** @private {?shakaExtern.AbrManager.SwitchCallback} */\n  this.switch_ = null;\n\n  /** @private {boolean} */\n  this.enabled_ = false;\n\n  /** @private {shaka.abr.EwmaBandwidthEstimator} */\n  this.bandwidthEstimator_ = new shaka.abr.EwmaBandwidthEstimator();\n\n  /**\n   * A filtered list of Variants to choose from.\n   * @private {!Array.<!shakaExtern.Variant>}\n   */\n  this.variants_ = [];\n\n  /**\n   * A filtered list of text streams to choose from.\n   * @private {!Array.<!shakaExtern.Stream>}\n   */\n  this.textStreams_ = [];\n\n  /** @private {boolean} */\n  this.startupComplete_ = false;\n\n  /**\n   * The last wall-clock time, in milliseconds, when Streams were chosen via\n   * chooseStreams() or switch_().\n   *\n   * @private {?number}\n   */\n  this.lastTimeChosenMs_ = null;\n\n  /** @private {shakaExtern.Restrictions} */\n  this.restrictions_ = {\n    minWidth: 0,\n    maxWidth: Infinity,\n    minHeight: 0,\n    maxHeight: Infinity,\n    minPixels: 0,\n    maxPixels: Infinity,\n    minBandwidth: 0,\n    maxBandwidth: Infinity\n  };\n};\n\n\n/**\n * The minimum amount of time that must pass between switches, in milliseconds.\n * This keeps us from changing too often and annoying the user.\n *\n * @const {number}\n */\nshaka.abr.SimpleAbrManager.SWITCH_INTERVAL_MS = 8000;\n\n\n/**\n * The fraction of the estimated bandwidth which we should try to use when\n * upgrading.\n *\n * @private\n * @const {number}\n */\nshaka.abr.SimpleAbrManager.BANDWIDTH_UPGRADE_TARGET_ = 0.85;\n\n\n/**\n * The largest fraction of the estimated bandwidth we should use. We should\n * downgrade to avoid this.\n *\n * @private\n * @const {number}\n */\nshaka.abr.SimpleAbrManager.BANDWIDTH_DOWNGRADE_TARGET_ = 0.95;\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.stop = function() {\n  this.switch_ = null;\n  this.enabled_ = false;\n  this.variants_ = [];\n  this.textStreams_ = [];\n  this.lastTimeChosenMs_ = null;\n\n  // Don't reset |startupComplete_|: if we've left the startup interval then we\n  // can start using bandwidth estimates right away if init() is called again.\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.init = function(switchCallback) {\n  this.switch_ = switchCallback;\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.chooseStreams = function(\n    mediaTypesToUpdate) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  // Choose streams for the specific types requested.\n  var chosen = {};\n\n  if (mediaTypesToUpdate.indexOf(ContentType.AUDIO) > -1 ||\n      mediaTypesToUpdate.indexOf(ContentType.VIDEO) > -1) {\n    // Choose a new Variant\n    var variant = this.chooseVariant_(this.variants_);\n    if (variant && variant.video)\n      chosen[ContentType.VIDEO] = variant.video;\n\n    if (variant && variant.audio)\n      chosen[ContentType.AUDIO] = variant.audio;\n  }\n\n  if (mediaTypesToUpdate.indexOf(ContentType.TEXT) > -1) {\n    // We don't adapt text, so just choose stream 0.\n    chosen[ContentType.TEXT] = this.textStreams_[0];\n  }\n\n  this.lastTimeChosenMs_ = Date.now();\n  return chosen;\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.enable = function() {\n  this.enabled_ = true;\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.disable = function() {\n  this.enabled_ = false;\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.segmentDownloaded = function(\n    deltaTimeMs, numBytes) {\n  shaka.log.v2('Segment downloaded:',\n               'deltaTimeMs=' + deltaTimeMs,\n               'numBytes=' + numBytes);\n  goog.asserts.assert(deltaTimeMs >= 0, 'expected a non-negative duration');\n  this.bandwidthEstimator_.sample(deltaTimeMs, numBytes);\n\n  if ((this.lastTimeChosenMs_ != null) && this.enabled_)\n    this.suggestStreams_();\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.getBandwidthEstimate = function() {\n  return this.bandwidthEstimator_.getBandwidthEstimate();\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.setDefaultEstimate = function(estimate) {\n  this.bandwidthEstimator_.setDefaultEstimate(estimate);\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.setRestrictions = function(restrictions) {\n  this.restrictions_ = restrictions;\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.setVariants = function(variants) {\n  this.variants_ = variants;\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.abr.SimpleAbrManager.prototype.setTextStreams = function(streams) {\n  this.textStreams_ = streams;\n};\n\n\n/**\n * Calls switch_() with which Streams to switch to.\n *\n * @private\n */\nshaka.abr.SimpleAbrManager.prototype.suggestStreams_ = function() {\n  shaka.log.v2('Suggesting Streams...');\n  goog.asserts.assert(this.lastTimeChosenMs_ != null,\n                      'lastTimeChosenMs_ should not be null');\n\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  if (!this.startupComplete_) {\n    // Check if we've got enough data yet.\n    if (!this.bandwidthEstimator_.hasGoodEstimate()) {\n      shaka.log.v2('Still waiting for a good estimate...');\n      return;\n    }\n    this.startupComplete_ = true;\n  } else {\n    // Check if we've left the switch interval.\n    var now = Date.now();\n    var delta = now - this.lastTimeChosenMs_;\n    if (delta < shaka.abr.SimpleAbrManager.SWITCH_INTERVAL_MS) {\n      shaka.log.v2('Still within switch interval...');\n      return;\n    }\n  }\n\n  var chosen = this.chooseStreams([ContentType.AUDIO, ContentType.VIDEO]);\n  var currentBandwidthKbps =\n      Math.round(this.bandwidthEstimator_.getBandwidthEstimate() / 1000.0);\n  shaka.log.debug(\n      'Calling switch_(), bandwidth=' + currentBandwidthKbps + ' kbps');\n  // If any of these chosen streams are already chosen, Player will filter them\n  // out before passing the choices on to StreamingEngine.\n  this.switch_(chosen);\n};\n\n\n/**\n * Chooses a Variant with an optimal bandwidth.\n *\n * @param {!Array.<shakaExtern.Variant>} variants\n * @return {shakaExtern.Variant}\n * @private\n */\nshaka.abr.SimpleAbrManager.prototype.chooseVariant_ = function(variants) {\n  // Alias.\n  var SimpleAbrManager = shaka.abr.SimpleAbrManager;\n\n  // Get sorted Streams.\n  var sortedVariants = SimpleAbrManager.filterAndSortVariants_(\n      this.restrictions_, variants);\n  var currentBandwidth = this.bandwidthEstimator_.getBandwidthEstimate();\n\n  if (variants.length && !sortedVariants.length) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.RESTRICTIONS_CANNOT_BE_MET);\n  }\n\n  // Start by assuming that we will use the first Stream.\n  var chosen = sortedVariants[0];\n\n  for (var i = 0; i < sortedVariants.length; ++i) {\n    var variant = sortedVariants[i];\n    var nextVariant = sortedVariants[i + 1] || {bandwidth: Infinity};\n\n    var minBandwidth = variant.bandwidth /\n                       SimpleAbrManager.BANDWIDTH_DOWNGRADE_TARGET_;\n    var maxBandwidth = nextVariant.bandwidth /\n                       SimpleAbrManager.BANDWIDTH_UPGRADE_TARGET_;\n    shaka.log.v2('Bandwidth ranges:',\n                 (variant.bandwidth / 1e6).toFixed(3),\n                 (minBandwidth / 1e6).toFixed(3),\n                 (maxBandwidth / 1e6).toFixed(3));\n\n    if (currentBandwidth >= minBandwidth && currentBandwidth <= maxBandwidth)\n      chosen = variant;\n  }\n\n  return chosen;\n};\n\n\n/**\n * @param {shakaExtern.Restrictions} restrictions\n * @param {!Array.<shakaExtern.Variant>} variants\n * @return {!Array.<shakaExtern.Variant>} variants filtered according to\n *   |restrictions| and sorted in ascending order of bandwidth.\n * @private\n */\nshaka.abr.SimpleAbrManager.filterAndSortVariants_ = function(\n    restrictions, variants) {\n  return variants\n      .filter(function(variant) {\n        return shaka.util.StreamUtils.meetsRestrictions(\n            variant, restrictions,\n            /* maxHwRes */ {width: Infinity, height: Infinity});\n      })\n      .sort(function(v1, v2) {\n        return v1.bandwidth - v2.bandwidth;\n      });\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/abr/simple_abr_manager.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.FakeEvent');\n\n\n\n/**\n * Create an Event work-alike object based on the dictionary.\n * The event should contain all of the same properties from the dict.\n *\n * @param {string} type\n * @param {Object=} opt_dict\n * @constructor\n * @extends {Event}\n */\nshaka.util.FakeEvent = function(type, opt_dict) {\n  // Take properties from dict if present.\n  var dict = opt_dict || {};\n  for (var key in dict) {\n    this[key] = dict[key];\n  }\n\n\n  // These Properties below cannot be set by dict.  They are all provided for\n  // compatibility with native events.\n\n  /** @const {boolean} */\n  this.bubbles = false;\n\n  /** @type {boolean} */\n  this.cancelable = false;\n\n  /** @type {boolean} */\n  this.defaultPrevented = false;\n\n  /**\n   * According to MDN, Chrome uses high-res timers instead of epoch time.\n   * Follow suit so that timeStamps on FakeEvents use the same base as\n   * on native Events.\n   * @const {number}\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Event/timeStamp\n   */\n  this.timeStamp = window.performance && window.performance.now ?\n      window.performance.now() : Date.now();\n\n  /** @const {string} */\n  this.type = type;\n\n  /** @const {boolean} */\n  this.isTrusted = false;\n\n  /** @type {EventTarget} */\n  this.currentTarget = null;\n\n  /** @type {EventTarget} */\n  this.target = null;\n\n\n  /**\n   * Non-standard property read by FakeEventTarget to stop processing listeners.\n   * @type {boolean}\n   */\n  this.stopped = false;\n};\n\n\n/**\n * Prevents the default action of the event.  Has no effect if the event isn't\n * cancellable.\n * @override\n */\nshaka.util.FakeEvent.prototype.preventDefault = function() {\n  if (this.cancelable)\n    this.defaultPrevented = true;\n};\n\n\n/**\n * Stops processing event listeners for this event.  Provided for compatibility\n * with native Events.\n * @override\n */\nshaka.util.FakeEvent.prototype.stopImmediatePropagation = function() {\n  this.stopped = true;\n};\n\n\n/**\n * Does nothing, since FakeEvents do not bubble.  Provided for compatibility\n * with native Events.\n * @override\n */\nshaka.util.FakeEvent.prototype.stopPropagation = function() {};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/fake_event.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.cast.CastUtils');\n\ngoog.require('shaka.util.FakeEvent');\n\n\n/**\n * @namespace shaka.cast.CastUtils\n * @summary A set of cast utility functions and variables shared between sender\n *   and receiver.\n */\n\n\n/**\n * HTMLMediaElement events that are proxied while casting.\n * @const {!Array.<string>}\n */\nshaka.cast.CastUtils.VideoEvents = [\n  'ended',\n  'play',\n  'playing',\n  'pause',\n  'pausing',\n  'ratechange',\n  'seeked',\n  'seeking',\n  'timeupdate',\n  'volumechange'\n];\n\n\n/**\n * HTMLMediaElement attributes that are proxied while casting.\n * @const {!Array.<string>}\n */\nshaka.cast.CastUtils.VideoAttributes = [\n  'buffered',\n  'currentTime',\n  'duration',\n  'ended',\n  'loop',\n  'muted',\n  'paused',\n  'playbackRate',\n  'seeking',\n  'videoHeight',\n  'videoWidth',\n  'volume'\n];\n\n\n/**\n * HTMLMediaElement attributes that are transferred when casting begins.\n * @const {!Array.<string>}\n */\nshaka.cast.CastUtils.VideoInitStateAttributes = [\n  'loop',\n  'playbackRate'\n];\n\n\n/**\n * HTMLMediaElement methods with no return value that are proxied while casting.\n * @const {!Array.<string>}\n */\nshaka.cast.CastUtils.VideoVoidMethods = [\n  'pause',\n  'play'\n];\n\n\n/**\n * Player events that are proxied while casting.\n * @const {!Array.<string>}\n */\nshaka.cast.CastUtils.PlayerEvents = [\n  'adaptation',\n  'buffering',\n  'emsg',\n  'error',\n  'loading',\n  'unloading',\n  'texttrackvisibility',\n  'timelineregionadded',\n  'timelineregionenter',\n  'timelineregionexit',\n  'trackschanged'\n];\n\n\n/**\n * Player getter methods that are proxied while casting.\n * @const {!Array.<string>}\n */\nshaka.cast.CastUtils.PlayerGetterMethods = [\n  'drmInfo',\n  'getAudioLanguages',\n  'getConfiguration',\n  'getExpiration',\n  'getManifestUri',\n  'getPlaybackRate',\n  'getPlayheadTimeAsDate',\n  'getTextLanguages',\n  'getTextTracks',\n  'getTracks',\n  'getStats',\n  'getVariantTracks',\n  'isBuffering',\n  'isInProgress',\n  'isLive',\n  'isTextTrackVisible',\n  'keySystem',\n  'seekRange'\n];\n\n\n/**\n * Player getter and setter methods that are used to transfer state when casting\n * begins.\n * @const {!Array.<!Array.<string>>}\n */\nshaka.cast.CastUtils.PlayerInitState = [\n  ['getConfiguration', 'configure']\n];\n\n\n/**\n * Player getter and setter methods that are used to transfer state after\n * after load() is resolved.\n * @const {!Array.<!Array.<string>>}\n */\nshaka.cast.CastUtils.PlayerInitAfterLoadState = [\n  ['isTextTrackVisible', 'setTextTrackVisibility']\n];\n\n\n/**\n * Player methods with no return value that are proxied while casting.\n * @const {!Array.<string>}\n */\nshaka.cast.CastUtils.PlayerVoidMethods = [\n  'addTextTrack',\n  'cancelTrickPlay',\n  'configure',\n  'resetConfiguration',\n  'selectAudioLanguage',\n  'selectTextLanguage',\n  'selectTextTrack',\n  'selectTrack',\n  'selectVariantTrack',\n  'setTextTrackVisibility',\n  'trickPlay'\n];\n\n\n/**\n * Player methods returning a Promise that are proxied while casting.\n * @const {!Array.<string>}\n */\nshaka.cast.CastUtils.PlayerPromiseMethods = [\n  // The opt_manifestFactory method is not supported.\n  'load',\n  'unload'\n];\n\n\n/**\n * @typedef {{\n *   video: Object,\n *   player: Object,\n *   manifest: ?string,\n *   startTime: ?number\n * }}\n * @property {Object} video\n *   Dictionary of video properties to be set.\n * @property {Object} player\n *   Dictionary of player setters to be called.\n * @property {?string} manifest\n *   The currently-selected manifest, if present.\n * @property {?number} startTime\n *   The playback start time, if currently playing.\n */\nshaka.cast.CastUtils.InitStateType;\n\n\n/**\n * The namespace for Shaka messages on the cast bus.\n * @const {string}\n */\nshaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE = 'urn:x-cast:com.google.shaka.v2';\n\n\n/**\n * The namespace for generic messages on the cast bus.\n * @const {string}\n */\nshaka.cast.CastUtils.GENERIC_MESSAGE_NAMESPACE =\n    'urn:x-cast:com.google.cast.media';\n\n\n/**\n * Serialize as JSON, but specially encode things JSON will not otherwise\n * represent.\n * @param {?} thing\n * @return {string}\n */\nshaka.cast.CastUtils.serialize = function(thing) {\n  return JSON.stringify(thing, function(key, value) {\n    if (key == 'manager') {\n      // ABR manager can't be serialized.\n      return undefined;\n    }\n    if (typeof value == 'function') {\n      // Functions can't be (safely) serialized.\n      return undefined;\n    }\n    if (value instanceof Event || value instanceof shaka.util.FakeEvent) {\n      // Events don't serialize to JSON well because of the DOM objects\n      // and other complex objects they contain.  So we strip these out.\n      // Note that using Object.keys or JSON.stringify directly on the event\n      // will not capture its properties.  We must use a for loop.\n      var simpleEvent = {};\n      for (var eventKey in value) {\n        var eventValue = value[eventKey];\n        if (eventValue && typeof eventValue == 'object') {\n          // Strip out non-null object types because they are complex and we\n          // don't need them.\n        } else if (eventKey in Event) {\n          // Strip out keys that are found on Event itself because they are\n          // class-level constants we don't need, like Event.MOUSEMOVE == 16.\n        } else {\n          simpleEvent[eventKey] = eventValue;\n        }\n      }\n      return simpleEvent;\n    }\n    if (value instanceof TimeRanges) {\n      // TimeRanges must be unpacked into plain data for serialization.\n      return shaka.cast.CastUtils.unpackTimeRanges_(value);\n    }\n    if (typeof value == 'number') {\n      // NaN and infinity cannot be represented directly in JSON.\n      if (isNaN(value)) return 'NaN';\n      if (isFinite(value)) return value;\n      if (value < 0) return '-Infinity';\n      return 'Infinity';\n    }\n    return value;\n  });\n};\n\n\n/**\n * Deserialize JSON using our special encodings.\n * @param {string} str\n * @return {?}\n */\nshaka.cast.CastUtils.deserialize = function(str) {\n  return JSON.parse(str, function(key, value) {\n    if (value == 'NaN') {\n      return NaN;\n    } else if (value == '-Infinity') {\n      return -Infinity;\n    } else if (value == 'Infinity') {\n      return Infinity;\n    } else if (value && typeof value == 'object' &&\n               value['__type__'] == 'TimeRanges') {\n      // TimeRanges objects have been unpacked and sent as plain data.\n      // Simulate the original TimeRanges object.\n      return shaka.cast.CastUtils.simulateTimeRanges_(value);\n    }\n    return value;\n  });\n};\n\n\n/**\n * @param {!TimeRanges} ranges\n * @return {Object}\n * @private\n */\nshaka.cast.CastUtils.unpackTimeRanges_ = function(ranges) {\n  var obj = {\n    '__type__': 'TimeRanges',  // a signal to deserialize\n    'length': ranges.length,\n    'start': [],\n    'end': []\n  };\n\n  for (var i = 0; i < ranges.length; ++i) {\n    obj['start'].push(ranges.start(i));\n    obj['end'].push(ranges.end(i));\n  }\n\n  return obj;\n};\n\n\n/**\n * Creates a simulated TimeRanges object from data sent by the cast receiver.\n * @param {?} obj\n * @return {{\n *   length: number,\n *   start: function(number): number,\n *   end: function(number): number\n * }}\n * @private\n */\nshaka.cast.CastUtils.simulateTimeRanges_ = function(obj) {\n  return {\n    length: obj.length,\n    // NOTE: a more complete simulation would throw when |i| was out of range,\n    // but for simplicity we will assume a well-behaved application that uses\n    // length instead of catch to stop iterating.\n    start: function(i) { return obj.start[i]; },\n    end: function(i) { return obj.end[i]; }\n  };\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/cast/cast_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.cast.CastSender');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.cast.CastUtils');\ngoog.require('shaka.log');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.PublicPromise');\n\n\n\n/**\n * @constructor\n * @struct\n * @param {string} receiverAppId The ID of the cast receiver application.\n * @param {function()} onStatusChanged A callback invoked when the cast status\n *   changes.\n * @param {function(string, !shaka.util.FakeEvent)} onRemoteEvent A callback\n *   invoked with target name and event when a remote event is received.\n * @param {function()} onResumeLocal A callback invoked when the local player\n *   should resume playback. Called before cached remote state is wiped.\n * @param {function()} onInitStateRequired A callback to get local player's.\n *   state. Invoked when casting is initiated from Chrome's cast button.\n * @implements {shaka.util.IDestroyable}\n */\nshaka.cast.CastSender =\n    function(receiverAppId, onStatusChanged, onRemoteEvent, onResumeLocal,\n             onInitStateRequired) {\n  /** @private {string} */\n  this.receiverAppId_ = receiverAppId;\n\n  /** @private {?function()} */\n  this.onStatusChanged_ = onStatusChanged;\n\n  /** @private {?function(string, !shaka.util.FakeEvent)} */\n  this.onRemoteEvent_ = onRemoteEvent;\n\n  /** @private {?function()} */\n  this.onResumeLocal_ = onResumeLocal;\n\n  /** @private {?function()} */\n  this.onInitStateRequired_ = onInitStateRequired;\n\n  /** @private {boolean} */\n  this.apiReady_ = false;\n\n  /** @private {boolean} */\n  this.hasReceivers_ = false;\n\n  /** @private {boolean} */\n  this.isCasting_ = false;\n\n  /** @private {string} */\n  this.receiverName_ = '';\n\n  /** @private {Object} */\n  this.appData_ = null;\n\n  /** @private {chrome.cast.Session} */\n  this.session_ = null;\n\n  /** @private {Object} */\n  this.cachedProperties_ = {\n    'video': {},\n    'player': {}\n  };\n\n  /** @private {number} */\n  this.nextAsyncCallId_ = 0;\n\n  /** @private {Object.<string, !shaka.util.PublicPromise>} */\n  this.asyncCallPromises_ = {};\n\n  /** @private {shaka.util.PublicPromise} */\n  this.castPromise_ = null;\n};\n\n\n/** @override */\nshaka.cast.CastSender.prototype.destroy = function() {\n  this.rejectAllPromises_();\n  if (this.session_) {\n    this.session_.leave(function() {}, function() {});\n    this.session_ = null;\n  }\n\n  this.onStatusChanged_ = null;\n  this.onRemoteEvent_ = null;\n  this.onResumeLocal_ = null;\n  this.apiReady_ = false;\n  this.hasReceivers_ = false;\n  this.isCasting_ = false;\n  this.appData_ = null;\n  this.cachedProperties_ = null;\n  this.asyncCallPromises_ = null;\n  this.castPromise_ = null;\n\n  return Promise.resolve();\n};\n\n\n/**\n * @return {boolean} True if the cast API is available.\n */\nshaka.cast.CastSender.prototype.apiReady = function() {\n  return this.apiReady_;\n};\n\n\n/**\n * @return {boolean} True if there are receivers.\n */\nshaka.cast.CastSender.prototype.hasReceivers = function() {\n  return this.hasReceivers_;\n};\n\n\n/**\n * @return {boolean} True if we are currently casting.\n */\nshaka.cast.CastSender.prototype.isCasting = function() {\n  return this.isCasting_;\n};\n\n\n/**\n * @return {string} The name of the Cast receiver device, if isCasting().\n */\nshaka.cast.CastSender.prototype.receiverName = function() {\n  return this.receiverName_;\n};\n\n\n/**\n * @return {boolean} True if we have a cache of remote properties from the\n *   receiver.\n */\nshaka.cast.CastSender.prototype.hasRemoteProperties = function() {\n  return Object.keys(this.cachedProperties_['video']).length != 0;\n};\n\n\n/**\n * Initialize the Cast API.\n */\nshaka.cast.CastSender.prototype.init = function() {\n  // Check for the cast extension.\n  if (!window.chrome || !chrome.cast || !chrome.cast.isAvailable) {\n    // Not available yet, so wait to be notified if/when it is available.\n    window.__onGCastApiAvailable = (function(loaded) {\n      if (loaded) {\n        this.init();\n      }\n    }).bind(this);\n    return;\n  }\n\n  // The API is now available.\n  delete window.__onGCastApiAvailable;\n  this.apiReady_ = true;\n  this.onStatusChanged_();\n\n  var sessionRequest = new chrome.cast.SessionRequest(this.receiverAppId_);\n  var apiConfig = new chrome.cast.ApiConfig(sessionRequest,\n      this.onExistingSessionJoined_.bind(this),\n      this.onReceiverStatusChanged_.bind(this),\n      'origin_scoped');\n\n  // TODO: have never seen this fail.  when would it and how should we react?\n  chrome.cast.initialize(apiConfig,\n      function() { shaka.log.debug('CastSender: init'); },\n      function(error) { shaka.log.error('CastSender: init error', error); });\n};\n\n\n/**\n * Set application-specific data.\n *\n * @param {Object} appData Application-specific data to relay to the receiver.\n */\nshaka.cast.CastSender.prototype.setAppData = function(appData) {\n  this.appData_ = appData;\n  if (this.isCasting_) {\n    this.sendMessage_({\n      'type': 'appData',\n      'appData': this.appData_\n    });\n  }\n};\n\n\n/**\n * @param {shaka.cast.CastUtils.InitStateType} initState Video and player state\n *   to be sent to the receiver.\n * @return {!Promise} Resolved when connected to a receiver.  Rejected if the\n *   connection fails or is canceled by the user.\n */\nshaka.cast.CastSender.prototype.cast = function(initState) {\n  if (!this.apiReady_) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.RECOVERABLE,\n        shaka.util.Error.Category.CAST,\n        shaka.util.Error.Code.CAST_API_UNAVAILABLE));\n  }\n  if (!this.hasReceivers_) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.RECOVERABLE,\n        shaka.util.Error.Category.CAST,\n        shaka.util.Error.Code.NO_CAST_RECEIVERS));\n  }\n  if (this.isCasting_) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.RECOVERABLE,\n        shaka.util.Error.Category.CAST,\n        shaka.util.Error.Code.ALREADY_CASTING));\n  }\n\n  this.castPromise_ = new shaka.util.PublicPromise();\n  chrome.cast.requestSession(\n      this.onSessionInitiated_.bind(this, initState),\n      this.onConnectionError_.bind(this));\n  return this.castPromise_;\n};\n\n\n/**\n * Shows user a cast dialog where they can choose to stop\n * casting. Relies on Chrome to perform disconnect if they do.\n * Doesn't do anything if not connected.\n */\nshaka.cast.CastSender.prototype.showDisconnectDialog = function() {\n  if (!this.isCasting_) {\n    return;\n  }\n  var initState = this.onInitStateRequired_();\n\n  chrome.cast.requestSession(\n      this.onSessionInitiated_.bind(this, initState),\n      this.onConnectionError_.bind(this));\n};\n\n\n/**\n * Forces the receiver app to shut down by disconnecting.  Does nothing if not\n * connected.\n */\nshaka.cast.CastSender.prototype.forceDisconnect = function() {\n  if (!this.isCasting_) {\n    return;\n  }\n\n  this.rejectAllPromises_();\n  if (this.session_) {\n    this.session_.stop(function() {}, function() {});\n    this.session_ = null;\n  }\n};\n\n\n/**\n * Getter for properties of remote objects.\n * @param {string} targetName\n * @param {string} property\n * @return {?}\n */\nshaka.cast.CastSender.prototype.get = function(targetName, property) {\n  goog.asserts.assert(targetName == 'video' || targetName == 'player',\n                      'Unexpected target name');\n  if (targetName == 'video') {\n    if (shaka.cast.CastUtils.VideoVoidMethods.indexOf(property) >= 0) {\n      return this.remoteCall_.bind(this, targetName, property);\n    }\n  } else if (targetName == 'player') {\n    if (shaka.cast.CastUtils.PlayerVoidMethods.indexOf(property) >= 0) {\n      return this.remoteCall_.bind(this, targetName, property);\n    }\n    if (shaka.cast.CastUtils.PlayerPromiseMethods.indexOf(property) >= 0) {\n      return this.remoteAsyncCall_.bind(this, targetName, property);\n    }\n    if (shaka.cast.CastUtils.PlayerGetterMethods.indexOf(property) >= 0) {\n      return this.propertyGetter_.bind(this, targetName, property);\n    }\n  }\n\n  return this.propertyGetter_(targetName, property);\n};\n\n\n/**\n * Setter for properties of remote objects.\n * @param {string} targetName\n * @param {string} property\n * @param {?} value\n */\nshaka.cast.CastSender.prototype.set = function(targetName, property, value) {\n  goog.asserts.assert(targetName == 'video' || targetName == 'player',\n                      'Unexpected target name');\n\n  this.cachedProperties_[targetName][property] = value;\n  this.sendMessage_({\n    'type': 'set',\n    'targetName': targetName,\n    'property': property,\n    'value': value\n  });\n};\n\n\n/**\n * @param {shaka.cast.CastUtils.InitStateType} initState\n * @param {chrome.cast.Session} session\n * @private\n */\nshaka.cast.CastSender.prototype.onSessionInitiated_ =\n    function(initState, session) {\n  shaka.log.debug('CastSender: onSessionInitiated');\n  this.onSessionCreated_(session);\n\n  this.sendMessage_({\n    'type': 'init',\n    'initState': initState,\n    'appData': this.appData_\n  });\n\n  this.castPromise_.resolve();\n};\n\n\n/**\n * @param {chrome.cast.Error} error\n * @private\n */\nshaka.cast.CastSender.prototype.onConnectionError_ = function(error) {\n  // Default error code:\n  var code = shaka.util.Error.Code.UNEXPECTED_CAST_ERROR;\n\n  switch (error.code) {\n    case 'cancel':\n      code = shaka.util.Error.Code.CAST_CANCELED_BY_USER;\n      break;\n    case 'timeout':\n      code = shaka.util.Error.Code.CAST_CONNECTION_TIMED_OUT;\n      break;\n    case 'receiver_unavailable':\n      code = shaka.util.Error.Code.CAST_RECEIVER_APP_UNAVAILABLE;\n      break;\n  }\n\n  this.castPromise_.reject(new shaka.util.Error(\n      shaka.util.Error.Severity.CRITICAL,\n      shaka.util.Error.Category.CAST,\n      code,\n      error));\n};\n\n\n/**\n * @param {string} targetName\n * @param {string} property\n * @return {?}\n * @private\n */\nshaka.cast.CastSender.prototype.propertyGetter_ =\n    function(targetName, property) {\n  goog.asserts.assert(targetName == 'video' || targetName == 'player',\n                      'Unexpected target name');\n  return this.cachedProperties_[targetName][property];\n};\n\n\n/**\n * @param {string} targetName\n * @param {string} methodName\n * @private\n */\nshaka.cast.CastSender.prototype.remoteCall_ =\n    function(targetName, methodName) {\n  goog.asserts.assert(targetName == 'video' || targetName == 'player',\n                      'Unexpected target name');\n  var args = Array.prototype.slice.call(arguments, 2);\n  this.sendMessage_({\n    'type': 'call',\n    'targetName': targetName,\n    'methodName': methodName,\n    'args': args\n  });\n};\n\n\n/**\n * @param {string} targetName\n * @param {string} methodName\n * @return {!Promise}\n * @private\n */\nshaka.cast.CastSender.prototype.remoteAsyncCall_ =\n    function(targetName, methodName) {\n  goog.asserts.assert(targetName == 'video' || targetName == 'player',\n                      'Unexpected target name');\n  var args = Array.prototype.slice.call(arguments, 2);\n\n  var p = new shaka.util.PublicPromise();\n  var id = this.nextAsyncCallId_.toString();\n  this.nextAsyncCallId_++;\n  this.asyncCallPromises_[id] = p;\n\n  this.sendMessage_({\n    'type': 'asyncCall',\n    'targetName': targetName,\n    'methodName': methodName,\n    'args': args,\n    'id': id\n  });\n  return p;\n};\n\n\n/**\n * @param {chrome.cast.Session} session\n * @private\n */\nshaka.cast.CastSender.prototype.onExistingSessionJoined_ = function(session) {\n  shaka.log.debug('CastSender: onExistingSessionJoined');\n\n  var initState = this.onInitStateRequired_();\n\n  this.castPromise_ = new shaka.util.PublicPromise();\n\n  this.onSessionInitiated_(initState, session);\n};\n\n\n/**\n * @param {string} availability\n * @private\n */\nshaka.cast.CastSender.prototype.onReceiverStatusChanged_ =\n    function(availability) {\n  // The cast extension is telling us whether there are any cast receiver\n  // devices available.\n  shaka.log.debug('CastSender: receiver status', availability);\n  this.hasReceivers_ = availability == 'available';\n  this.onStatusChanged_();\n};\n\n\n/**\n * @param {chrome.cast.Session} session\n * @private\n */\nshaka.cast.CastSender.prototype.onSessionCreated_ = function(session) {\n  this.session_ = session;\n  this.session_.addUpdateListener(this.onConnectionStatusChanged_.bind(this));\n  this.session_.addMessageListener(\n      shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,\n      this.onMessageReceived_.bind(this));\n  this.onConnectionStatusChanged_();\n};\n\n\n/**\n * @private\n */\nshaka.cast.CastSender.prototype.onConnectionStatusChanged_ = function() {\n  var connected = this.session_ ? this.session_.status == 'connected' : false;\n  shaka.log.debug('CastSender: connection status', connected);\n  if (this.isCasting_ && !connected) {\n    // Tell CastProxy to transfer state back to local player.\n    this.onResumeLocal_();\n\n    // Clear whatever we have cached.\n    for (var targetName in this.cachedProperties_) {\n      this.cachedProperties_[targetName] = {};\n    }\n\n    this.rejectAllPromises_();\n  }\n\n  this.isCasting_ = connected;\n  this.receiverName_ = connected ? this.session_.receiver.friendlyName : '';\n  this.onStatusChanged_();\n};\n\n\n/**\n * Reject any async call promises that are still pending.\n * @private\n */\nshaka.cast.CastSender.prototype.rejectAllPromises_ = function() {\n  for (var id in this.asyncCallPromises_) {\n    var p = this.asyncCallPromises_[id];\n    delete this.asyncCallPromises_[id];\n\n    // Reject pending async operations as if they were interrupted.\n    // At the moment, load() is the only async operation we are worried\n    // about.\n    p.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.RECOVERABLE,\n        shaka.util.Error.Category.PLAYER,\n        shaka.util.Error.Code.LOAD_INTERRUPTED));\n  }\n};\n\n\n/**\n * Since this method is in the compiled library, make sure all messages are\n * read with quoted properties.\n * @param {string} namespace\n * @param {string} serialized\n * @private\n */\nshaka.cast.CastSender.prototype.onMessageReceived_ =\n    function(namespace, serialized) {\n  var message = shaka.cast.CastUtils.deserialize(serialized);\n  shaka.log.v2('CastSender: message', message);\n\n  switch (message['type']) {\n    case 'event':\n      var targetName = message['targetName'];\n      var event = message['event'];\n      var fakeEvent = new shaka.util.FakeEvent(event['type'], event);\n      this.onRemoteEvent_(targetName, fakeEvent);\n      break;\n    case 'update':\n      var update = message['update'];\n      for (var targetName in update) {\n        var target = this.cachedProperties_[targetName] || {};\n        for (var property in update[targetName]) {\n          target[property] = update[targetName][property];\n        }\n      }\n      break;\n    case 'asyncComplete':\n      var id = message['id'];\n      var error = message['error'];\n      var p = this.asyncCallPromises_[id];\n      delete this.asyncCallPromises_[id];\n\n      goog.asserts.assert(p, 'Unexpected async id');\n      if (!p) break;\n\n      if (error) {\n        // This is a hacky way to reconstruct the serialized error.\n        var reconstructedError = new shaka.util.Error(\n            error.severity, error.category, error.code);\n        for (var k in error) {\n          (/** @type {Object} */(reconstructedError))[k] = error[k];\n        }\n        p.reject(reconstructedError);\n      } else {\n        p.resolve();\n      }\n      break;\n  }\n};\n\n\n/**\n * Since this method is in the compiled library, make sure all messages passed\n * in here were created with quoted property names.\n * @param {!Object} message\n * @private\n */\nshaka.cast.CastSender.prototype.sendMessage_ = function(message) {\n  var serialized = shaka.cast.CastUtils.serialize(message);\n  // TODO: have never seen this fail.  When would it and how should we react?\n  this.session_.sendMessage(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,\n                            serialized,\n                            function() {},  // success callback\n                            shaka.log.error);  // error callback\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/cast/cast_sender.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.FakeEventTarget');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.MultiMap');\n\n\n\n/**\n * A work-alike for EventTarget.  Only DOM elements may be true EventTargets,\n * but this can be used as a base class to provide event dispatch to non-DOM\n * classes.  Only FakeEvents should be dispatched.\n *\n * @struct\n * @constructor\n * @implements {EventTarget}\n * @exportInterface\n */\nshaka.util.FakeEventTarget = function() {\n  /**\n   * @private {!shaka.util.MultiMap.<shaka.util.FakeEventTarget.ListenerType>}\n   */\n  this.listeners_ = new shaka.util.MultiMap();\n\n  /**\n   * The target of all dispatched events.  Defaults to |this|.\n   * @type {EventTarget}\n   */\n  this.dispatchTarget = this;\n};\n\n\n/**\n * These are the listener types defined in the closure extern for EventTarget.\n * @typedef {EventListener|function(!Event):(boolean|undefined)}\n * @exportInterface\n */\nshaka.util.FakeEventTarget.ListenerType;\n\n\n/**\n * Add an event listener to this object.\n *\n * @param {string} type The event type to listen for.\n * @param {shaka.util.FakeEventTarget.ListenerType} listener The callback or\n *   listener object to invoke.\n * @param {(EventListenerOptions|boolean)=} opt_options Ignored.\n * @override\n * @exportInterface\n */\nshaka.util.FakeEventTarget.prototype.addEventListener =\n    function(type, listener, opt_options) {\n  this.listeners_.push(type, listener);\n};\n\n\n/**\n * Remove an event listener from this object.\n *\n * @param {string} type The event type for which you wish to remove a listener.\n * @param {shaka.util.FakeEventTarget.ListenerType} listener The callback or\n *   listener object to remove.\n * @param {(EventListenerOptions|boolean)=} opt_options Ignored.\n * @override\n * @exportInterface\n */\nshaka.util.FakeEventTarget.prototype.removeEventListener =\n    function(type, listener, opt_options) {\n  this.listeners_.remove(type, listener);\n};\n\n\n/**\n * Dispatch an event from this object.\n *\n * @param {!Event} event The event to be dispatched from this object.\n * @return {boolean} True if the default action was prevented.\n * @override\n * @exportInterface\n */\nshaka.util.FakeEventTarget.prototype.dispatchEvent = function(event) {\n  // In many browsers, it is complex to overwrite properties of actual Events.\n  // Here we expect only to dispatch FakeEvents, which are simpler.\n  goog.asserts.assert(event instanceof shaka.util.FakeEvent,\n                      'FakeEventTarget can only dispatch FakeEvents!');\n\n  var list = this.listeners_.get(event.type) || [];\n\n  for (var i = 0; i < list.length; ++i) {\n    // Do this every time, since events can be re-dispatched from handlers.\n    event.target = this.dispatchTarget;\n    event.currentTarget = this.dispatchTarget;\n\n    var listener = list[i];\n    try {\n      if (listener.handleEvent) {\n        listener.handleEvent(event);\n      } else {\n        listener.call(this, event);\n      }\n    } catch (exception) {\n      // Exceptions during event handlers should not affect the caller,\n      // but should appear on the console as uncaught, according to MDN:\n      // http://goo.gl/N6Ff27\n      shaka.log.error('Uncaught exception in event handler', exception);\n    }\n\n    if (event.stopped) {\n      break;\n    }\n  }\n\n  return event.defaultPrevented;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/fake_event_target.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.Player');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.abr.EwmaBandwidthEstimator');\ngoog.require('shaka.abr.SimpleAbrManager');\ngoog.require('shaka.log');\ngoog.require('shaka.media.DrmEngine');\ngoog.require('shaka.media.ManifestParser');\ngoog.require('shaka.media.MediaSourceEngine');\ngoog.require('shaka.media.Playhead');\ngoog.require('shaka.media.PlayheadObserver');\ngoog.require('shaka.media.SegmentReference');\ngoog.require('shaka.media.StreamingEngine');\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.util.CancelableChain');\ngoog.require('shaka.util.ConfigUtils');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.EventManager');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.FakeEventTarget');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.MapUtils');\ngoog.require('shaka.util.PublicPromise');\ngoog.require('shaka.util.StreamUtils');\n\n\n\n/**\n * Construct a Player.\n *\n * @param {!HTMLMediaElement} video Any existing TextTracks attached to this\n *   element that were not created by Shaka will be disabled.  A new TextTrack\n *   may be created to display captions or subtitles.\n * @param {function(shaka.Player)=} opt_dependencyInjector Optional callback\n *   which is called to inject mocks into the Player. Used for testing.\n *\n * @constructor\n * @struct\n * @implements {shaka.util.IDestroyable}\n * @extends {shaka.util.FakeEventTarget}\n * @export\n */\nshaka.Player = function(video, opt_dependencyInjector) {\n  shaka.util.FakeEventTarget.call(this);\n\n  /** @private {boolean} */\n  this.destroyed_ = false;\n\n  /** @private {HTMLMediaElement} */\n  this.video_ = video;\n\n  /** @private {TextTrack} */\n  this.textTrack_ = null;\n\n  /** @private {shaka.util.EventManager} */\n  this.eventManager_ = new shaka.util.EventManager();\n\n  /** @private {shakaExtern.AbrManager} */\n  this.defaultAbrManager_ = new shaka.abr.SimpleAbrManager();\n\n  /** @private {shaka.net.NetworkingEngine} */\n  this.networkingEngine_ = null;\n\n  /** @private {shaka.media.DrmEngine} */\n  this.drmEngine_ = null;\n\n  /** @private {MediaSource} */\n  this.mediaSource_ = null;\n\n  /** @private {shaka.media.MediaSourceEngine} */\n  this.mediaSourceEngine_ = null;\n\n  /** @private {Promise} */\n  this.mediaSourceOpen_ = null;\n\n  /** @private {shaka.media.Playhead} */\n  this.playhead_ = null;\n\n  /** @private {shaka.media.PlayheadObserver} */\n  this.playheadObserver_ = null;\n\n  /** @private {shaka.media.StreamingEngine} */\n  this.streamingEngine_ = null;\n\n  /** @private {shakaExtern.ManifestParser} */\n  this.parser_ = null;\n\n  /** @private {?shakaExtern.Manifest} */\n  this.manifest_ = null;\n\n  /** @private {?string} */\n  this.manifestUri_ = null;\n\n  /**\n   * Contains an ID for use with creating streams.  The manifest parser should\n   * start with small IDs, so this starts with a large one.\n   * @private {number}\n   */\n  this.nextExternalStreamId_ = 1e9;\n\n  /** @private {!Array.<number>} */\n  this.loadingTextStreamIds_ = [];\n\n  /** @private {boolean} */\n  this.buffering_ = false;\n\n  /** @private {boolean} */\n  this.switchingPeriods_ = true;\n\n  /** @private {shaka.util.CancelableChain} */\n  this.loadChain_ = null;\n\n  /** @private {Promise} */\n  this.unloadChain_ = null;\n\n  /**\n   * @private {!Object.<shaka.util.ManifestParserUtils.ContentType, {\n   *   stream: shakaExtern.Stream,\n   *   clearBuffer: boolean\n   * }>}\n   */\n  this.deferredSwitches_ = {};\n\n  /** @private {!Array.<shakaExtern.TimelineRegionInfo>} */\n  this.pendingTimelineRegions_ = [];\n\n  /**\n   * A map of Period number to a map of content type to stream id.\n   * @private {!Object.<number, !Object.<string, number>>}\n   */\n  this.activeStreamsByPeriod_ = {};\n\n  /** @private {?shakaExtern.PlayerConfiguration} */\n  this.config_ = this.defaultConfig_();\n\n  /** @private {{width: number, height: number}} */\n  this.maxHwRes_ = { width: Infinity, height: Infinity };\n\n  /** @private {shakaExtern.Stats} */\n  this.stats_ = this.getCleanStats_();\n\n  /** @private {number} */\n  this.lastTimeStatsUpdateTimestamp_ = 0;\n\n  /** @private {string} */\n  this.currentAudioLanguage_ = this.config_.preferredAudioLanguage;\n\n  /** @private {string} */\n  this.currentTextLanguage_ = this.config_.preferredTextLanguage;\n\n  /** @private {string} */\n  this.currentVariantRole_ = '';\n\n  /** @private {string} */\n  this.currentTextRole_ = '';\n\n  if (opt_dependencyInjector)\n    opt_dependencyInjector(this);\n\n  this.networkingEngine_ = this.createNetworkingEngine();\n  this.initialize_();\n};\ngoog.inherits(shaka.Player, shaka.util.FakeEventTarget);\n\n\n/**\n * After destruction, a Player object cannot be used again.\n *\n * @override\n * @export\n */\nshaka.Player.prototype.destroy = function() {\n  this.destroyed_ = true;\n\n  var cancelation = Promise.resolve();\n  if (this.loadChain_) {\n    // A load is in progress.  Cancel it.\n    cancelation = this.loadChain_.cancel(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.PLAYER,\n        shaka.util.Error.Code.LOAD_INTERRUPTED));\n  }\n\n  return cancelation.then(function() {\n    var p = Promise.all([\n      // We need to destroy the current fields as well as waiting for an\n      // existing unload to complete.  It is fine to call destroyStreaming_ if\n      // there is an unload since it resets the fields immediately.\n      this.unloadChain_,\n      this.destroyStreaming_(),\n      this.eventManager_ ? this.eventManager_.destroy() : null,\n      this.networkingEngine_ ? this.networkingEngine_.destroy() : null\n    ]);\n\n    this.video_ = null;\n    this.textTrack_ = null;\n    this.eventManager_ = null;\n    this.defaultAbrManager_ = null;\n    this.networkingEngine_ = null;\n    this.config_ = null;\n\n    return p;\n  }.bind(this));\n};\n\n\n/**\n * @define {string} A version number taken from git at compile time.\n */\ngoog.define('GIT_VERSION', 'v2.1.4-debug');\n\n\n/**\n * @const {string}\n * @export\n */\nshaka.Player.version = GIT_VERSION;\n\n\n/**\n * @event shaka.Player.ErrorEvent\n * @description Fired when a playback error occurs.\n * @property {string} type\n *   'error'\n * @property {!shaka.util.Error} detail\n *   An object which contains details on the error.  The error's 'category' and\n *   'code' properties will identify the specific error that occured.  In an\n *   uncompiled build, you can also use the 'message' and 'stack' properties\n *   to debug.\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.EmsgEvent\n * @description Fired when a non-typical emsg is found in a segment.\n * @property {string} type\n *   'emsg'\n * @property {shakaExtern.EmsgInfo} detail\n *   An object which contains the content of the emsg box.\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.TimelineRegionAdded\n * @description Fired when a media timeline region is added.\n * @property {string} type\n *   'timelineregionadded'\n * @property {shakaExtern.TimelineRegionInfo} detail\n *   An object which contains a description of the region.\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.TimelineRegionEnter\n * @description Fired when the playhead enters a timeline region.\n * @property {string} type\n *   'timelineregionenter'\n * @property {shakaExtern.TimelineRegionInfo} detail\n *   An object which contains a description of the region.\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.TimelineRegionExit\n * @description Fired when the playhead exits a timeline region.\n * @property {string} type\n *   'timelineregionexit'\n * @property {shakaExtern.TimelineregionInfo} detail\n *   An object which contains a description of the region.\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.BufferingEvent\n * @description Fired when the player's buffering state changes.\n * @property {string} type\n *   'buffering'\n * @property {boolean} buffering\n *   True when the Player enters the buffering state.\n *   False when the Player leaves the buffering state.\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.LoadingEvent\n * @description Fired when the player begins loading.\n *   Used by the Cast receiver to determine idle state.\n * @property {string} type\n *   'loading'\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.UnloadingEvent\n * @description Fired when the player unloads or fails to load.\n *   Used by the Cast receiver to determine idle state.\n * @property {string} type\n *   'unloading'\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.TextTrackVisibilityEvent\n * @description Fired when text track visibility changes.\n * @property {string} type\n *   'texttrackvisibility'\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.TracksChangedEvent\n * @description Fired when the list of tracks changes.  For example, this will\n *   happen when changing periods or when track restrictions change.\n * @property {string} type\n *   'trackschanged'\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.AdaptationEvent\n * @description Fired when an automatic adaptation causes the active tracks\n *   to change.  Does not fire when the application calls selectVariantTrack()\n *   selectTextTrack(), selectAudioLanguage() or selectTextLanguage().\n * @property {string} type\n *   'adaptation'\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.ExpirationUpdatedEvent\n * @description Fired when there is a change in the expiration times of an\n *   EME session.\n * @property {string} type\n *   'expirationupdated'\n * @exportDoc\n */\n\n\n/**\n * @event shaka.Player.LargeGapEvent\n * @description Fired when the playhead enters a large gap.  If\n *   |config.streaming.jumpLargeGaps| is set, the default action of this event\n *   is to jump the gap; this can be prevented by calling preventDefault() on\n *   the event object.\n * @property {string} type\n *   'largegap'\n * @property {number} currentTime\n *   The current time of the playhead.\n * @property {number} gapSize\n *   The size of the gap, in seconds.\n * @exportDoc\n */\n\n\n/** @private {!Object.<string, function():*>} */\nshaka.Player.supportPlugins_ = {};\n\n\n/**\n * Registers a plugin callback that will be called with support().  The\n * callback will return the value that will be stored in the return value from\n * support().\n *\n * @param {string} name\n * @param {function():*} callback\n * @export\n */\nshaka.Player.registerSupportPlugin = function(name, callback) {\n  shaka.Player.supportPlugins_[name] = callback;\n};\n\n\n/**\n * Return whether the browser provides basic support. If this returns false,\n * Shaka Player cannot be used at all. In this case, do not construct a Player\n * instance and do not use the library.\n *\n * @return {boolean}\n * @export\n */\nshaka.Player.isBrowserSupported = function() {\n  // Basic features needed for the library to be usable.\n  var basic = !!window.Promise && !!window.Uint8Array &&\n              !!Array.prototype.forEach;\n\n  return basic &&\n      shaka.media.MediaSourceEngine.isBrowserSupported() &&\n      shaka.media.DrmEngine.isBrowserSupported();\n};\n\n\n/**\n * Probes the browser to determine what features are supported.  This makes a\n * number of requests to EME/MSE/etc which may result in user prompts.  This\n * should only be used for diagnostics.\n *\n * NOTE: This may show a request to the user for permission.\n *\n * @see https://goo.gl/ovYLvl\n * @return {!Promise.<shakaExtern.SupportType>}\n * @export\n */\nshaka.Player.probeSupport = function() {\n  goog.asserts.assert(shaka.Player.isBrowserSupported(),\n                      'Must have basic support');\n  return shaka.media.DrmEngine.probeSupport().then(function(drm) {\n    var manifest = shaka.media.ManifestParser.probeSupport();\n    var media = shaka.media.MediaSourceEngine.probeSupport();\n    var ret = {\n      manifest: manifest,\n      media: media,\n      drm: drm\n    };\n\n    var plugins = shaka.Player.supportPlugins_;\n    for (var name in plugins) {\n      ret[name] = plugins[name]();\n    }\n\n    return ret;\n  });\n};\n\n\n/**\n * Load a manifest.\n *\n * @param {string} manifestUri\n * @param {number=} opt_startTime Optional start time, in seconds, to begin\n *   playback.  Defaults to 0 for VOD and to the live edge for live.\n * @param {shakaExtern.ManifestParser.Factory=} opt_manifestParserFactory\n *   Optional manifest parser factory to override auto-detection or use an\n *   unregistered parser.\n * @return {!Promise} Resolved when the manifest has been loaded and playback\n *   has begun; rejected when an error occurs or the call was interrupted by\n *   destroy(), unload() or another call to load().\n * @export\n */\nshaka.Player.prototype.load = function(manifestUri, opt_startTime,\n                                       opt_manifestParserFactory) {\n  var unloadPromise = this.unload();\n  var loadChain = new shaka.util.CancelableChain();\n  this.loadChain_ = loadChain;\n  this.dispatchEvent(new shaka.util.FakeEvent('loading'));\n\n  var startTime = Date.now();\n\n  return loadChain.then(function() {\n    return unloadPromise;\n  }).then(function() {\n    // Not tracked in stats because it should be insignificant.\n    // Logged in case it is not.\n    shaka.log.debug('Unload latency:', (Date.now() - startTime) / 1000);\n\n    this.stats_ = this.getCleanStats_();\n\n    this.eventManager_.listen(this.video_, 'playing',\n                              this.updateState_.bind(this));\n    this.eventManager_.listen(this.video_, 'pause',\n                              this.updateState_.bind(this));\n    this.eventManager_.listen(this.video_, 'ended',\n                              this.updateState_.bind(this));\n\n    goog.asserts.assert(this.networkingEngine_, 'Must not be destroyed');\n    return shaka.media.ManifestParser.getFactory(\n        manifestUri,\n        this.networkingEngine_,\n        this.config_.manifest.retryParameters,\n        opt_manifestParserFactory);\n  }.bind(this)).then(function(factory) {\n\n    this.parser_ = new factory();\n    this.parser_.configure(this.config_.manifest);\n    goog.asserts.assert(this.networkingEngine_, 'Must not be destroyed');\n    var playerInterface = {\n      networkingEngine: this.networkingEngine_,\n      filterPeriod: this.filterPeriod_.bind(this),\n      onTimelineRegionAdded: this.onTimelineRegionAdded_.bind(this),\n      onEvent: this.onEvent_.bind(this),\n      onError: this.onError_.bind(this)\n    };\n\n    if (this.parser_.start.length > 2) {\n      goog.asserts.assert(false, 'Old ManifestParser interface is deprecated');\n      shaka.log.warning(\n          'The ManifestParser interface has changed. Please upgrade your ' +\n          'plugin to accept the PlayerInterface structure. See the ' +\n          'ManifestParser documentation for details.');\n      // Use a string index here so the compiler doesn't complain about the\n      // incorrect arguments.\n      return this.parser_['start'](\n          manifestUri, this.networkingEngine_, playerInterface.filterPeriod,\n          playerInterface.onError, playerInterface.onEvent);\n    }\n\n    return this.parser_.start(manifestUri, playerInterface);\n  }.bind(this)).then(function(manifest) {\n\n    if (manifest.periods.length == 0) {\n      throw new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.MANIFEST,\n          shaka.util.Error.Code.NO_PERIODS);\n    }\n\n    this.manifest_ = manifest;\n    this.manifestUri_ = manifestUri;\n    this.drmEngine_ = this.createDrmEngine();\n    this.drmEngine_.configure(this.config_.drm);\n    return this.drmEngine_.init(manifest, false /* isOffline */);\n  }.bind(this)).then(function() {\n\n    // Re-filter the manifest after DRM has been initialized.\n    this.manifest_.periods.forEach(this.filterPeriod_.bind(this));\n\n    this.lastTimeStatsUpdateTimestamp_ = Date.now() / 1000;\n\n    // Copy preferred languages from the config again, in case the config was\n    // changed between construction and playback.\n    this.currentAudioLanguage_ = this.config_.preferredAudioLanguage;\n    this.currentTextLanguage_ = this.config_.preferredTextLanguage;\n\n    // Wait for MediaSource to open before continuing.\n    return Promise.all([\n      this.drmEngine_.attach(this.video_),\n      this.mediaSourceOpen_\n    ]);\n  }.bind(this)).then(function() {\n    this.config_.abr.manager.init(this.switch_.bind(this));\n\n    // MediaSource is open, so create the Playhead, MediaSourceEngine, and\n    // StreamingEngine.\n    this.playhead_ = this.createPlayhead(opt_startTime);\n    this.playheadObserver_ = this.createPlayheadObserver();\n    this.mediaSourceEngine_ = this.createMediaSourceEngine();\n\n    this.streamingEngine_ = this.createStreamingEngine();\n    this.streamingEngine_.configure(this.config_.streaming);\n\n    // If the content is multi-codec and the browser can play more than one of\n    // them, choose codecs now before we initialize streaming.\n    this.chooseCodecsAndFilterManifest_();\n\n    return this.streamingEngine_.init();\n  }.bind(this)).then(function() {\n    if (this.config_.streaming.startAtSegmentBoundary) {\n      var time = this.adjustStartTime_(this.playhead_.getTime());\n      this.playhead_.setStartTime(time);\n    }\n\n    // Re-filter the manifest after streams have been chosen.\n    this.manifest_.periods.forEach(this.filterPeriod_.bind(this));\n    // Dispatch a 'trackschanged' event now that all initial filtering is done.\n    this.onTracksChanged_();\n    // Since the first streams just became active, send an adaptation event.\n    this.onAdaptation_();\n\n    // Now that we've filtered out variants that aren't compatible with the\n    // active one, update abr manager with filtered variants for the current\n    // period.\n    var currentPeriod = this.streamingEngine_.getCurrentPeriod();\n    var variants = shaka.util.StreamUtils.filterVariantsByRoleAndLanguage(\n        currentPeriod, this.currentAudioLanguage_);\n    this.config_.abr.manager.setVariants(variants);\n\n    var hasPrimary = currentPeriod.variants.some(function(variant) {\n      return variant.primary;\n    });\n    if (!this.currentAudioLanguage_ && !hasPrimary) {\n      shaka.log.warning('No preferred audio language set.  We will choose an ' +\n                        'arbitrary language initially');\n    }\n\n    this.pendingTimelineRegions_.forEach(\n        this.playheadObserver_.addTimelineRegion.bind(this.playheadObserver_));\n    this.pendingTimelineRegions_ = [];\n\n    // Wait for the 'loadeddata' event to measure load() latency.\n    this.eventManager_.listenOnce(this.video_, 'loadeddata', function() {\n      // Compute latency in seconds (Date.now() gives ms):\n      var latency = (Date.now() - startTime) / 1000;\n      this.stats_.loadLatency = latency;\n      shaka.log.debug('Load latency:', latency);\n    }.bind(this));\n\n    this.loadChain_ = null;\n  }.bind(this)).finalize().catch(function(error) {\n    goog.asserts.assert(error instanceof shaka.util.Error,\n                        'Wrong error type!');\n    shaka.log.debug('load() failed:', error);\n\n    // If we haven't started another load, clear the loadChain_ member.\n    if (this.loadChain_ == loadChain) {\n      this.loadChain_ = null;\n      this.dispatchEvent(new shaka.util.FakeEvent('unloading'));\n    }\n    return Promise.reject(error);\n  }.bind(this));\n};\n\n\n/**\n * In case of multiple usable codecs, choose one based on lowest average\n * bandwidth and filter out the rest.\n * @private\n */\nshaka.Player.prototype.chooseCodecsAndFilterManifest_ = function() {\n  function variantCodecs(variant) {\n    // Only consider the base of the codec string.  For example, these should\n    // both be considered the same codec: avc1.42c01e, avc1.4d401f\n    var baseVideoCodec =\n        variant.video ? variant.video.codecs.split('.')[0] : '';\n    var baseAudioCodec =\n        variant.audio ? variant.audio.codecs.split('.')[0] : '';\n    return baseVideoCodec + '-' + baseAudioCodec;\n  }\n\n  // Organize variants into buckets by codecs.\n  var variantsByCodecs = {};\n  this.manifest_.periods.forEach(function(period) {\n    period.variants.forEach(function(variant) {\n      var codecs = variantCodecs(variant);\n      if (!(codecs in variantsByCodecs)) {\n        variantsByCodecs[codecs] = [];\n      }\n      variantsByCodecs[codecs].push(variant);\n    });\n  });\n\n  // Compute the average bandwidth for each group of variants.\n  // Choose the lowest-bandwidth codecs.\n  var bestCodecs = null;\n  var lowestAverageBandwidth = Infinity;\n  shaka.util.MapUtils.forEach(variantsByCodecs, function(codecs, variants) {\n    var sum = 0;\n    var num = 0;\n    variants.forEach(function(variant) {\n      sum += variant.bandwidth;\n      ++num;\n    });\n    var averageBandwidth = sum / num;\n    shaka.log.debug('codecs', codecs, 'avg bandwidth', averageBandwidth);\n\n    if (averageBandwidth < lowestAverageBandwidth) {\n      bestCodecs = codecs;\n      lowestAverageBandwidth = averageBandwidth;\n    }\n  });\n  goog.asserts.assert(bestCodecs != null, 'Should have chosen codecs!');\n  goog.asserts.assert(!isNaN(lowestAverageBandwidth),\n      'Bandwidth should be a number!');\n\n  // Filter out any variants that don't match, forcing AbrManager to choose from\n  // the most efficient variants possible.\n  this.manifest_.periods.forEach(function(period) {\n    period.variants = period.variants.filter(function(variant) {\n      var codecs = variantCodecs(variant);\n      if (codecs == bestCodecs) return true;\n\n      shaka.log.debug('Dropping Variant (better codec available)', variant);\n      return false;\n    });\n  });\n};\n\n\n/**\n * Creates a new instance of DrmEngine.  This can be replaced by tests to\n * create fake instances instead.\n *\n * @return {!shaka.media.DrmEngine}\n */\nshaka.Player.prototype.createDrmEngine = function() {\n  goog.asserts.assert(this.networkingEngine_, 'Must not be destroyed');\n  return new shaka.media.DrmEngine(\n      this.networkingEngine_,\n      this.onError_.bind(this),\n      this.onKeyStatus_.bind(this),\n      this.onExpirationUpdated_.bind(this));\n};\n\n\n/**\n * Creates a new instance of NetworkingEngine.  This can be replaced by tests\n * to create fake instances instead.\n *\n * @return {!shaka.net.NetworkingEngine}\n */\nshaka.Player.prototype.createNetworkingEngine = function() {\n  return new shaka.net.NetworkingEngine(this.onSegmentDownloaded_.bind(this));\n};\n\n\n/**\n * Creates a new instance of Playhead.  This can be replaced by tests to create\n * fake instances instead.\n *\n * @param {number=} opt_startTime\n * @return {!shaka.media.Playhead}\n */\nshaka.Player.prototype.createPlayhead = function(opt_startTime) {\n  goog.asserts.assert(this.manifest_, 'Must have manifest');\n  return new shaka.media.Playhead(\n      this.video_, this.manifest_, this.config_.streaming,\n      opt_startTime || null, this.onSeek_.bind(this), this.onEvent_.bind(this));\n};\n\n\n/**\n * Creates a new instance of PlayheadOvserver.  This can be replaced by tests to\n * create fake instances instead.\n *\n * @return {!shaka.media.PlayheadObserver}\n */\nshaka.Player.prototype.createPlayheadObserver = function() {\n  goog.asserts.assert(this.manifest_, 'Must have manifest');\n  return new shaka.media.PlayheadObserver(\n      this.video_, this.manifest_, this.config_.streaming,\n      this.onBuffering_.bind(this), this.onEvent_.bind(this),\n      this.onChangePeriod_.bind(this));\n};\n\n\n/**\n * Create and open MediaSource.  Potentially slow.\n *\n * @return {!Promise}\n */\nshaka.Player.prototype.createMediaSource = function() {\n  this.mediaSource_ = new MediaSource();\n  var ret = new shaka.util.PublicPromise();\n  this.eventManager_.listen(this.mediaSource_, 'sourceopen', ret.resolve);\n  this.video_.src = window.URL.createObjectURL(this.mediaSource_);\n  return ret;\n};\n\n\n/**\n * Creates a new instance of MediaSourceEngine.  This can be replaced by tests\n * to create fake instances instead.\n *\n * @return {!shaka.media.MediaSourceEngine}\n */\nshaka.Player.prototype.createMediaSourceEngine = function() {\n  return new shaka.media.MediaSourceEngine(\n      this.video_, this.mediaSource_, this.textTrack_);\n};\n\n\n/**\n * Creates a new instance of StreamingEngine.  This can be replaced by tests\n * to create fake instances instead.\n *\n * @return {!shaka.media.StreamingEngine}\n */\nshaka.Player.prototype.createStreamingEngine = function() {\n  goog.asserts.assert(\n      this.playhead_ && this.playheadObserver_ && this.mediaSourceEngine_ &&\n          this.manifest_,\n      'Must not be destroyed');\n\n  var playerInterface = {\n    playhead: this.playhead_,\n    mediaSourceEngine: this.mediaSourceEngine_,\n    netEngine: this.networkingEngine_,\n    onChooseStreams: this.onChooseStreams_.bind(this),\n    onCanSwitch: this.canSwitch_.bind(this),\n    onError: this.onError_.bind(this),\n    onEvent: this.onEvent_.bind(this),\n    onManifestUpdate: this.onManifestUpdate_.bind(this),\n    onSegmentAppended: this.onSegmentAppended_.bind(this)\n  };\n  return new shaka.media.StreamingEngine(this.manifest_, playerInterface);\n};\n\n\n/**\n * Configure the Player instance.\n *\n * The config object passed in need not be complete.  It will be merged with\n * the existing Player configuration.\n *\n * Config keys and types will be checked.  If any problems with the config\n * object are found, errors will be reported through logs.\n *\n * @param {!Object} config This should follow the form of\n *   {@link shakaExtern.PlayerConfiguration}, but you may omit any field you do\n *   not wish to change.\n * @export\n */\nshaka.Player.prototype.configure = function(config) {\n  goog.asserts.assert(this.config_, 'Config must not be null!');\n\n  if (config.abr && config.abr.manager &&\n      config.abr.manager != this.config_.abr.manager) {\n    this.config_.abr.manager.stop();\n    config.abr.manager.init(this.switch_.bind(this));\n  }\n\n  shaka.util.ConfigUtils.mergeConfigObjects(\n      this.config_, config, this.defaultConfig_(), this.configOverrides_(), '');\n\n  this.applyConfig_();\n};\n\n\n/**\n * Apply config changes.\n * @private\n */\nshaka.Player.prototype.applyConfig_ = function() {\n  if (this.parser_) {\n    this.parser_.configure(this.config_.manifest);\n  }\n  if (this.drmEngine_) {\n    this.drmEngine_.configure(this.config_.drm);\n  }\n  if (this.streamingEngine_) {\n    this.streamingEngine_.configure(this.config_.streaming);\n\n    // Need to apply the restrictions to every period.\n    try {\n      // this.filterPeriod_() may throw.\n      this.manifest_.periods.forEach(this.filterPeriod_.bind(this));\n    } catch (error) {\n      this.onError_(error);\n    }\n\n    // May need to choose new streams.\n    shaka.log.debug('Choosing new streams after changing configuration');\n    var period = this.streamingEngine_.getCurrentPeriod();\n    this.chooseStreamsAndSwitch_(period);\n  }\n\n  // Simply enable/disable ABR with each call, since multiple calls to these\n  // methods have no effect.\n  if (this.config_.abr.enabled && !this.switchingPeriods_) {\n    this.config_.abr.manager.enable();\n  } else {\n    this.config_.abr.manager.disable();\n  }\n\n  this.config_.abr.manager.setDefaultEstimate(\n      this.config_.abr.defaultBandwidthEstimate);\n  this.config_.abr.manager.setRestrictions(this.config_.abr.restrictions);\n};\n\n\n/**\n * Return a copy of the current configuration.  Modifications of the returned\n * value will not affect the Player's active configuration.  You must call\n * player.configure() to make changes.\n *\n * @return {shakaExtern.PlayerConfiguration}\n * @export\n */\nshaka.Player.prototype.getConfiguration = function() {\n  goog.asserts.assert(this.config_, 'Config must not be null!');\n\n  var ret = this.defaultConfig_();\n  shaka.util.ConfigUtils.mergeConfigObjects(\n      ret, this.config_, this.defaultConfig_(), this.configOverrides_(), '');\n  return ret;\n};\n\n\n/**\n * Reset configuration to default.\n * @export\n */\nshaka.Player.prototype.resetConfiguration = function() {\n  var config = this.defaultConfig_();\n\n  if (config.abr && config.abr.manager &&\n      config.abr.manager != this.config_.abr.manager) {\n    this.config_.abr.manager.stop();\n    config.abr.manager.init(this.switch_.bind(this));\n  }\n\n  // Don't call mergeConfigObjects_(), since that would not reset open-ended\n  // dictionaries like drm.servers.\n  this.config_ = this.defaultConfig_();\n\n  this.applyConfig_();\n};\n\n\n/**\n * @return {HTMLMediaElement} A reference to the HTML Media Element passed\n *     in during initialization.\n * @export\n */\nshaka.Player.prototype.getMediaElement = function() {\n  return this.video_;\n};\n\n\n/**\n * @return {shaka.net.NetworkingEngine} A reference to the Player's networking\n *     engine.  Applications may use this to make requests through Shaka's\n *     networking plugins.\n * @export\n */\nshaka.Player.prototype.getNetworkingEngine = function() {\n  return this.networkingEngine_;\n};\n\n\n/**\n * @return {?string} If a manifest is loaded, returns the manifest URI given in\n *   the last call to load().  Otherwise, returns null.\n * @export\n */\nshaka.Player.prototype.getManifestUri = function() {\n  return this.manifestUri_;\n};\n\n\n/**\n * @return {boolean} True if the current stream is live.  False otherwise.\n * @export\n */\nshaka.Player.prototype.isLive = function() {\n  return this.manifest_ ?\n         this.manifest_.presentationTimeline.isLive() :\n         false;\n};\n\n\n/**\n * @return {boolean} True if the current stream is in-progress VOD.\n *   False otherwise.\n * @export\n */\nshaka.Player.prototype.isInProgress = function() {\n  return this.manifest_ ?\n         this.manifest_.presentationTimeline.isInProgress() :\n         false;\n};\n\n\n/**\n * Get the seekable range for the current stream.\n * @return {{start: number, end: number}}\n * @export\n */\nshaka.Player.prototype.seekRange = function() {\n  var start = 0;\n  var end = 0;\n  if (this.manifest_) {\n    var timeline = this.manifest_.presentationTimeline;\n    start = timeline.getSegmentAvailabilityStart();\n    end = timeline.getSeekRangeEnd();\n  }\n  return {'start': start, 'end': end};\n};\n\n\n/**\n * Get the key system currently being used by EME.  This returns the empty\n * string if not using EME.\n *\n * @return {string}\n * @export\n */\nshaka.Player.prototype.keySystem = function() {\n  return this.drmEngine_ ? this.drmEngine_.keySystem() : '';\n};\n\n\n/**\n * Get the DrmInfo used to initialize EME.  This returns null when not using\n * EME.\n *\n * @return {?shakaExtern.DrmInfo}\n * @export\n */\nshaka.Player.prototype.drmInfo = function() {\n  return this.drmEngine_ ? this.drmEngine_.getDrmInfo() : null;\n};\n\n\n/**\n * The next known expiration time for any EME session.  If the sessions never\n * expire, or there are no EME sessions, this returns Infinity.\n *\n * @return {number}\n * @export\n */\nshaka.Player.prototype.getExpiration = function() {\n  return this.drmEngine_ ? this.drmEngine_.getExpiration() : Infinity;\n};\n\n\n/**\n * @return {boolean} True if the Player is in a buffering state.\n * @export\n */\nshaka.Player.prototype.isBuffering = function() {\n  return this.buffering_;\n};\n\n\n/**\n * Unload the current manifest and make the Player available for re-use.\n *\n * @return {!Promise} Resolved when streaming has stopped and the previous\n *     content, if any, has been unloaded.\n * @export\n */\nshaka.Player.prototype.unload = function() {\n  if (this.destroyed_) return Promise.resolve();\n  this.dispatchEvent(new shaka.util.FakeEvent('unloading'));\n\n  var p = Promise.resolve();\n  if (this.loadChain_) {\n    // A load is in progress, cancel it.\n    var interrupt = new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.PLAYER,\n        shaka.util.Error.Code.LOAD_INTERRUPTED);\n    p = this.loadChain_.cancel(interrupt);\n  }\n\n  return p.then(function() {\n    // If there is an existing unload operation, use that.\n    if (!this.unloadChain_) {\n      this.unloadChain_ = this.resetStreaming_().then(function() {\n        this.unloadChain_ = null;\n      }.bind(this));\n    }\n    return this.unloadChain_;\n  }.bind(this));\n};\n\n\n/**\n * Gets the current effective playback rate.  If using trick play, it will\n * return the current trick play rate; otherwise, it will return the video\n * playback rate.\n * @return {number}\n * @export\n */\nshaka.Player.prototype.getPlaybackRate = function() {\n  return this.playhead_ ? this.playhead_.getPlaybackRate() : 0;\n};\n\n\n/**\n * Skip through the content without playing.  Simulated using repeated seeks.\n *\n * Trick play will be canceled automatically if the playhead hits the beginning\n * or end of the seekable range for the content.\n *\n * @param {number} rate The playback rate to simulate.  For example, a rate of\n *     2.5 would result in 2.5 seconds of content being skipped every second.\n *     To trick-play backward, use a negative rate.\n * @export\n */\nshaka.Player.prototype.trickPlay = function(rate) {\n  shaka.log.debug('Trick play rate', rate);\n  if (this.playhead_)\n    this.playhead_.setPlaybackRate(rate);\n\n  if (this.streamingEngine_)\n    this.streamingEngine_.setTrickPlay(rate != 1);\n};\n\n\n/**\n * Cancel trick-play.\n * @export\n */\nshaka.Player.prototype.cancelTrickPlay = function() {\n  shaka.log.debug('Trick play canceled');\n  if (this.playhead_)\n    this.playhead_.setPlaybackRate(1);\n\n  if (this.streamingEngine_)\n    this.streamingEngine_.setTrickPlay(false);\n};\n\n\n/**\n * Return a list of variant and text tracks available for the current Period.\n * If there are multiple Periods, then you must seek to the Period before\n * being able to switch.\n *\n * @return {!Array.<shakaExtern.Track>}\n * @export\n * @deprecated Use getVariantTracks() or getTextTracks()\n */\nshaka.Player.prototype.getTracks = function() {\n  shaka.log.warning('shaka.Player.getTracks() is being deprecated and will ' +\n                    'be removed in v2.2. Use getVariantTracks() to get a ' +\n                    'list of variant tracks or getTextTracks() for text.');\n\n  var tracks = this.getVariantTracks();\n  return tracks.concat(this.getTextTracks());\n};\n\n\n/**\n * Select a specific track.  For variant tracks, this disables adaptation.\n * Note that AdaptationEvents are not fired for manual track selections.\n *\n * @param {shakaExtern.Track} track\n * @param {boolean=} opt_clearBuffer\n * @export\n * @deprecated Use selectVariantTrack() or selectTextTrack()\n */\nshaka.Player.prototype.selectTrack = function(track, opt_clearBuffer) {\n  shaka.log.warning('shaka.Player.selectTrack() is being deprecated and will ' +\n                    'be removed in v2.2. Use selectVariantTrack() to select ' +\n                    'a new variant track or selectTextTrack() for text.');\n\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (track.type == ContentType.TEXT) {\n    this.selectTextTrack(track);\n  } else {\n    // Disable ABR for variant track changes.\n    var config = {abr: {enabled: false}};\n    this.configure(config);\n    this.selectVariantTrack(track, opt_clearBuffer);\n  }\n};\n\n\n/**\n * Return a list of variant tracks available for the current\n * Period.  If there are multiple Periods, then you must seek to the Period\n * before being able to switch.\n *\n * @return {!Array.<shakaExtern.Track>}\n * @export\n */\nshaka.Player.prototype.getVariantTracks = function() {\n  if (!this.manifest_)\n    return [];\n  this.assertCorrectActiveStreams_();\n\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  var currentPeriod = shaka.util.StreamUtils.findPeriodContainingTime(\n      this.manifest_, this.playhead_.getTime());\n  var activeStreams = this.activeStreamsByPeriod_[currentPeriod] || {};\n  return shaka.util.StreamUtils.getVariantTracks(\n      this.manifest_.periods[currentPeriod], activeStreams[ContentType.AUDIO],\n      activeStreams[ContentType.VIDEO]);\n};\n\n\n/**\n * Return a list of text tracks available for the current\n * Period.  If there are multiple Periods, then you must seek to the Period\n * before being able to switch.\n *\n * @return {!Array.<shakaExtern.Track>}\n * @export\n */\nshaka.Player.prototype.getTextTracks = function() {\n  if (!this.manifest_)\n    return [];\n  this.assertCorrectActiveStreams_();\n\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var currentPeriod = shaka.util.StreamUtils.findPeriodContainingTime(\n      this.manifest_, this.playhead_.getTime());\n  var activeStreams = this.activeStreamsByPeriod_[currentPeriod] || {};\n  return shaka.util.StreamUtils\n      .getTextTracks(\n          this.manifest_.periods[currentPeriod],\n          activeStreams[ContentType.TEXT])\n      .filter(function(track) {\n        // Don't show any tracks that are being loaded still.\n        return this.loadingTextStreamIds_.indexOf(track.id) < 0;\n      }.bind(this));\n};\n\n\n/**\n * Select a specific text track. Note that AdaptationEvents are not\n * fired for manual track selections.\n *\n * @param {shakaExtern.Track} track\n * @export\n */\nshaka.Player.prototype.selectTextTrack = function(track) {\n  if (!this.streamingEngine_)\n    return;\n\n  var StreamUtils = shaka.util.StreamUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  var period = this.streamingEngine_.getCurrentPeriod();\n  var stream = StreamUtils.findTextStreamForTrack(period, track);\n\n  if (!stream) {\n    shaka.log.error('Unable to find the track with id \"' + track.id +\n                    '\"; did we change Periods?');\n    return;\n  }\n\n  this.addToSwitchHistory_(stream, /* fromAdaptation */ false);\n\n  // Create empty object first and initialize the fields through\n  // [] to allow field names to be expressions.\n  var streamsToSwitch = {};\n  streamsToSwitch[ContentType.TEXT] = stream;\n  this.deferredSwitch_(streamsToSwitch, /* opt_clearBuffer */ true);\n};\n\n\n/**\n * Select a specific track. Note that AdaptationEvents are not fired for manual\n * track selections.\n *\n * @param {shakaExtern.Track} track\n * @param {boolean=} opt_clearBuffer\n * @export\n */\nshaka.Player.prototype.selectVariantTrack = function(track, opt_clearBuffer) {\n  if (!this.streamingEngine_)\n    return;\n\n  if (this.config_.abr.enabled) {\n    shaka.log.warning('Changing tracks while abr manager is enabled will ' +\n                      'likely result in the selected track being overriden. ' +\n                      'Consider disabling abr before calling ' +\n                      'selectVariantTrack().');\n  }\n\n  var StreamUtils = shaka.util.StreamUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var streamsToSwitch = {};\n\n  var period = this.streamingEngine_.getCurrentPeriod();\n  var variant = StreamUtils.findVariantForTrack(period, track);\n  var activeStreams = this.streamingEngine_.getActiveStreams();\n  if (variant) {\n    // Double check that the track is allowed to be played.\n    // The track list should only contain playable variants,\n    // but if resctrictions change and selectVariantTrack()\n    // is called before the track list is updated, we could\n    // get a now-restricted variant.\n    var variantIsPlayable = StreamUtils.isPlayable(variant);\n    if (!variantIsPlayable) {\n      shaka.log.error('Unable to switch to track with id \"' + track.id +\n                      '\" because it is restricted.');\n      return;\n    }\n\n    if (variant.audio) {\n      // Update active streams even if we're not switching\n      // in case active streams haven't been set up yet.\n      this.updateActiveStreams_(variant.audio);\n      if (variant.audio != activeStreams[ContentType.AUDIO])\n        streamsToSwitch[ContentType.AUDIO] = variant.audio;\n    }\n    if (variant.video) {\n      this.updateActiveStreams_(variant.video);\n      if (variant.video != activeStreams[ContentType.VIDEO])\n        streamsToSwitch[ContentType.VIDEO] = variant.video;\n    }\n  }\n\n  // Add entries to the history.\n  shaka.util.MapUtils.values(streamsToSwitch).forEach(function(stream) {\n    this.addToSwitchHistory_(stream, /* fromAdaptation */ false);\n  }.bind(this));\n\n  // Save current text stream to ensure that it doesn't get overridden\n  // by a default one inside shaka.Player.configure()\n  var currentTextStream = activeStreams[ContentType.TEXT];\n\n  if (currentTextStream) {\n    streamsToSwitch[ContentType.TEXT] = currentTextStream;\n  }\n\n  this.deferredSwitch_(streamsToSwitch, opt_clearBuffer);\n};\n\n\n/**\n * Return a list of audio languages available for the current\n * Period.\n *\n * @return {!Array.<string>}\n * @export\n */\nshaka.Player.prototype.getAudioLanguages = function() {\n  if (!this.streamingEngine_) {\n    return [];\n  }\n\n  var StreamUtils = shaka.util.StreamUtils;\n  var period = this.streamingEngine_.getCurrentPeriod();\n  var variants = StreamUtils.getPlayableVariants(period.variants);\n  return variants.map(function(variant) {\n    return variant.language;\n  }).filter(shaka.util.Functional.isNotDuplicate);\n};\n\n\n/**\n * Return a list of text languages available for the current\n * Period.\n *\n * @return {!Array.<string>}\n * @export\n */\nshaka.Player.prototype.getTextLanguages = function() {\n  if (!this.streamingEngine_) {\n    return [];\n  }\n\n  var period = this.streamingEngine_.getCurrentPeriod();\n  return period.textStreams.map(function(stream) {\n    return stream.language;\n  }).filter(shaka.util.Functional.isNotDuplicate);\n};\n\n\n/**\n * Sets currentAudioLanguage to the selected language and chooses\n * new variant in that language if need be.\n *\n * @param {!string} language\n * @param {string=} opt_role\n * @export\n */\nshaka.Player.prototype.selectAudioLanguage = function(language, opt_role) {\n  if (!this.streamingEngine_) return;\n  var period = this.streamingEngine_.getCurrentPeriod();\n  this.currentAudioLanguage_ = language;\n  this.currentVariantRole_ = opt_role || '';\n  this.chooseStreamsAndSwitch_(period);\n};\n\n\n/**\n * Sets currentTextLanguage to the selected language and chooses\n * new text stream in that language if need be.\n *\n * @param {!string} language\n * @param {string=} opt_role\n * @export\n */\nshaka.Player.prototype.selectTextLanguage = function(language, opt_role) {\n  if (!this.streamingEngine_) return;\n  var period = this.streamingEngine_.getCurrentPeriod();\n  this.currentTextLanguage_ = language;\n  this.currentTextRole_ = opt_role || '';\n  this.chooseStreamsAndSwitch_(period);\n};\n\n\n/**\n * @return {boolean} True if the current text track is visible.\n * @export\n */\nshaka.Player.prototype.isTextTrackVisible = function() {\n  return this.textTrack_.mode == 'showing';\n};\n\n\n/**\n * Set the visibility of the current text track, if any.\n *\n * @param {boolean} on\n * @export\n */\nshaka.Player.prototype.setTextTrackVisibility = function(on) {\n  this.textTrack_.mode = on ? 'showing' : 'hidden';\n  this.onTextTrackVisibility_();\n};\n\n\n/**\n * Returns current playhead time as a Date.\n *\n * @return {Date}\n * @export\n */\nshaka.Player.prototype.getPlayheadTimeAsDate = function() {\n  if (!this.manifest_) return null;\n  goog.asserts.assert(this.isLive(),\n      'getPlayheadTimeInUTC should be called on a live stream!');\n  var time =\n      this.manifest_.presentationTimeline.getPresentationStartTime() * 1000 +\n      this.video_.currentTime * 1000;\n\n  return new Date(time);\n};\n\n\n/**\n * Return playback and adaptation stats.\n *\n * @return {shakaExtern.Stats}\n * @export\n */\nshaka.Player.prototype.getStats = function() {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  this.updateTimeStats_();\n  this.updateState_();\n\n  var video = null;\n  var variant = null;\n  var videoInfo = this.video_ && this.video_.getVideoPlaybackQuality ?\n      this.video_.getVideoPlaybackQuality() : {};\n\n  if (this.playhead_ && this.manifest_) {\n    var periodIdx = shaka.util.StreamUtils.findPeriodContainingTime(\n        this.manifest_, this.playhead_.getTime());\n    var period = this.manifest_.periods[periodIdx];\n    var activeStreams = this.activeStreamsByPeriod_[periodIdx];\n\n    variant = shaka.util.StreamUtils.getVariantByStreamIds(\n        activeStreams[ContentType.AUDIO],\n        activeStreams[ContentType.VIDEO],\n        period.variants);\n\n    video = variant.video || {};\n  }\n\n  if (!video) video = {};\n  if (!variant) variant = {};\n\n  // Clone the internal object so our state cannot be tampered with.\n  var cloneObject = shaka.util.ConfigUtils.cloneObject;\n  return {\n    // Not tracked in this.stats_:\n    width: video.width || 0,\n    height: video.height || 0,\n    streamBandwidth: variant.bandwidth || 0,\n    decodedFrames: Number(videoInfo.totalVideoFrames),\n    droppedFrames: Number(videoInfo.droppedVideoFrames),\n    estimatedBandwidth: this.config_.abr.manager.getBandwidthEstimate(),\n\n    loadLatency: this.stats_.loadLatency,\n    playTime: this.stats_.playTime,\n    bufferingTime: this.stats_.bufferingTime,\n    // Deep-clone the objects as well as the arrays that contain them:\n    switchHistory: cloneObject(this.stats_.switchHistory),\n    stateHistory: cloneObject(this.stats_.stateHistory)\n  };\n};\n\n\n/**\n * Adds the given text track to the current Period.  Load() must resolve before\n * calling.  The current Period or the presentation must have a duration.  This\n * returns a Promise that will resolve when the track can be switched to and\n * will resolve with the track that was created.\n *\n * @param {string} uri\n * @param {string} language\n * @param {string} kind\n * @param {string} mime\n * @param {string=} opt_codec\n * @param {string=} opt_label\n * @return {!Promise.<shakaExtern.Track>}\n * @export\n */\nshaka.Player.prototype.addTextTrack = function(\n    uri, language, kind, mime, opt_codec, opt_label) {\n  if (!this.streamingEngine_) {\n    shaka.log.error(\n        'Must call load() and wait for it to resolve before adding text ' +\n        'tracks.');\n    return Promise.reject();\n  }\n\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  // Get the Period duration.\n  var period = this.streamingEngine_.getCurrentPeriod();\n  /** @type {number} */\n  var periodDuration;\n  for (var i = 0; i < this.manifest_.periods.length; i++) {\n    if (this.manifest_.periods[i] == period) {\n      if (i == this.manifest_.periods.length - 1) {\n        periodDuration = this.manifest_.presentationTimeline.getDuration() -\n            period.startTime;\n        if (periodDuration == Infinity) {\n          shaka.log.error(\n              'The current Period or the presentation must have a duration ' +\n              'to add external text tracks.');\n          return Promise.reject();\n        }\n      } else {\n        var nextPeriod = this.manifest_.periods[i + 1];\n        periodDuration = nextPeriod.startTime - period.startTime;\n      }\n      break;\n    }\n  }\n\n  /** @type {shakaExtern.Stream} */\n  var stream = {\n    id: this.nextExternalStreamId_++,\n    createSegmentIndex: Promise.resolve.bind(Promise),\n    findSegmentPosition: function(time) { return 1; },\n    getSegmentReference: function(ref) {\n      if (ref != 1) return null;\n      return new shaka.media.SegmentReference(\n          1, 0, periodDuration, function() { return [uri]; }, 0, null);\n    },\n    initSegmentReference: null,\n    presentationTimeOffset: 0,\n    mimeType: mime,\n    codecs: opt_codec || '',\n    kind: kind,\n    encrypted: false,\n    keyId: null,\n    language: language,\n    label: opt_label || null,\n    type: ContentType.TEXT,\n    primary: false,\n    trickModeVideo: null,\n    containsEmsgBoxes: false,\n    roles: []\n  };\n\n  // Add the stream to the loading list to ensure it isn't switched to while it\n  // is initializing.\n  this.loadingTextStreamIds_.push(stream.id);\n  period.textStreams.push(stream);\n\n  return this.streamingEngine_.notifyNewTextStream(stream).then(function() {\n    if (this.destroyed_) return;\n\n    // If this was the first text stream, StreamingEngine will start streaming\n    // it in notifyNewTextStream.  So update the active stream.\n    var curPeriodIdx = this.manifest_.periods.indexOf(period);\n    var activeStreams = this.streamingEngine_.getActiveStreams();\n    if (activeStreams[ContentType.TEXT]) {\n      this.activeStreamsByPeriod_[curPeriodIdx][ContentType.TEXT] =\n          activeStreams[ContentType.TEXT].id;\n    }\n\n    // Remove the stream from the loading list.\n    this.loadingTextStreamIds_.splice(\n        this.loadingTextStreamIds_.indexOf(stream.id), 1);\n\n    shaka.log.debug('Choosing new streams after adding a text stream');\n    this.chooseStreamsAndSwitch_(period);\n    this.onTracksChanged_();\n\n    return {\n      id: stream.id,\n      active: false,\n      type: ContentType.TEXT,\n      bandwidth: 0,\n      language: language,\n      label: opt_label || null,\n      kind: kind,\n      width: null,\n      height: null\n    };\n  }.bind(this));\n};\n\n\n/**\n * Set the maximum resolution that the platform's hardware can handle.\n * This will be called automatically by shaka.cast.CastReceiver to enforce\n * limitations of the Chromecast hardware.\n *\n * @param {number} width\n * @param {number} height\n * @export\n */\nshaka.Player.prototype.setMaxHardwareResolution = function(width, height) {\n  this.maxHwRes_.width = width;\n  this.maxHwRes_.height = height;\n};\n\n\n/**\n * Initialize the Player.\n * @private\n */\nshaka.Player.prototype.initialize_ = function() {\n  // Start the (potentially slow) process of opening MediaSource now.\n  this.mediaSourceOpen_ = this.createMediaSource();\n\n  // If the video element has TextTracks, disable them.  If we see one that\n  // was created by a previous instance of Shaka Player, reuse it.\n  for (var i = 0; i < this.video_.textTracks.length; ++i) {\n    var track = this.video_.textTracks[i];\n    track.mode = 'disabled';\n\n    if (track.label == shaka.Player.TextTrackLabel_) {\n      this.textTrack_ = track;\n    }\n  }\n\n  if (!this.textTrack_) {\n    // As far as I can tell, there is no observable difference between setting\n    // kind to 'subtitles' or 'captions' when creating the TextTrack object.\n    // The individual text tracks from the manifest will still have their own\n    // kinds which can be displayed in the app's UI.\n    this.textTrack_ = this.video_.addTextTrack(\n        'subtitles', shaka.Player.TextTrackLabel_);\n  }\n  this.textTrack_.mode = 'hidden';\n\n  // TODO: test that in all cases, the built-in CC controls in the video element\n  // are toggling our TextTrack.\n\n  // Listen for video errors.\n  this.eventManager_.listen(this.video_, 'error',\n      this.onVideoError_.bind(this));\n};\n\n\n/**\n * @param {!shakaExtern.Stream} stream\n * @param {boolean} fromAdaptation\n * @private\n */\nshaka.Player.prototype.addToSwitchHistory_ = function(stream, fromAdaptation) {\n  this.stats_.switchHistory.push({\n    timestamp: Date.now() / 1000,\n    id: stream.id,\n    type: stream.type,\n    fromAdaptation: fromAdaptation\n  });\n\n  this.updateActiveStreams_(stream);\n};\n\n\n/**\n * @param {!shakaExtern.Stream} stream\n * @private\n */\nshaka.Player.prototype.updateActiveStreams_ = function(stream) {\n  goog.asserts.assert(this.manifest_, 'Must not be destroyed');\n  var periodIndex =\n      shaka.util.StreamUtils.findPeriodContainingStream(this.manifest_, stream);\n  if (!this.activeStreamsByPeriod_[periodIndex])\n    this.activeStreamsByPeriod_[periodIndex] = {};\n  this.activeStreamsByPeriod_[periodIndex][stream.type] = stream.id;\n};\n\n\n/**\n * Destroy members responsible for streaming.\n *\n * @return {!Promise}\n * @private\n */\nshaka.Player.prototype.destroyStreaming_ = function() {\n  if (this.eventManager_) {\n    this.eventManager_.unlisten(this.mediaSource_, 'sourceopen');\n    this.eventManager_.unlisten(this.video_, 'loadeddata');\n    this.eventManager_.unlisten(this.video_, 'playing');\n    this.eventManager_.unlisten(this.video_, 'pause');\n    this.eventManager_.unlisten(this.video_, 'ended');\n  }\n\n  if (this.video_) {\n    this.video_.removeAttribute('src');\n    this.video_.load();\n  }\n\n  var p = Promise.all([\n    this.config_ ? this.config_.abr.manager.stop() : null,\n    this.drmEngine_ ? this.drmEngine_.destroy() : null,\n    this.mediaSourceEngine_ ? this.mediaSourceEngine_.destroy() : null,\n    this.playhead_ ? this.playhead_.destroy() : null,\n    this.playheadObserver_ ? this.playheadObserver_.destroy() : null,\n    this.streamingEngine_ ? this.streamingEngine_.destroy() : null,\n    this.parser_ ? this.parser_.stop() : null\n  ]);\n\n  this.drmEngine_ = null;\n  this.mediaSourceEngine_ = null;\n  this.playhead_ = null;\n  this.playheadObserver_ = null;\n  this.streamingEngine_ = null;\n  this.parser_ = null;\n  this.manifest_ = null;\n  this.manifestUri_ = null;\n  this.mediaSourceOpen_ = null;\n  this.mediaSource_ = null;\n  this.pendingTimelineRegions_ = [];\n  this.activeStreamsByPeriod_ = {};\n  this.deferredSwitches_ = {};\n  this.stats_ = this.getCleanStats_();\n\n  return p;\n};\n\n\n/**\n * Reset the streaming system.\n * @return {!Promise}\n * @private\n */\nshaka.Player.prototype.resetStreaming_ = function() {\n  if (!this.parser_) {\n    // Nothing is playing, so this is effectively a no-op.\n    return Promise.resolve();\n  }\n\n  // Destroy the streaming system before we recreate everything.\n  return this.destroyStreaming_().then(function() {\n    if (this.destroyed_) return;\n\n    // Force an exit from the buffering state.\n    this.onBuffering_(false);\n\n    // Start the (potentially slow) process of opening MediaSource now.\n    this.mediaSourceOpen_ = this.createMediaSource();\n  }.bind(this));\n};\n\n\n/**\n * @const {string}\n * @private\n */\nshaka.Player.TextTrackLabel_ = 'Shaka Player TextTrack';\n\n\n/**\n * @return {!Object}\n * @private\n */\nshaka.Player.prototype.configOverrides_ = function() {\n  return {\n    '.drm.servers': '',\n    '.drm.clearKeys': '',\n    '.drm.advanced': {\n      distinctiveIdentifierRequired: false,\n      persistentStateRequired: false,\n      videoRobustness: '',\n      audioRobustness: '',\n      serverCertificate: null\n    }\n  };\n};\n\n\n/**\n * @return {shakaExtern.PlayerConfiguration}\n * @private\n */\nshaka.Player.prototype.defaultConfig_ = function() {\n  return {\n    drm: {\n      retryParameters: shaka.net.NetworkingEngine.defaultRetryParameters(),\n      // These will all be verified by special cases in mergeConfigObjects_():\n      servers: {},    // key is arbitrary key system ID, value must be string\n      clearKeys: {},  // key is arbitrary key system ID, value must be string\n      advanced: {},    // key is arbitrary key system ID, value is a record type\n      delayLicenseRequestUntilPlayed: false\n    },\n    manifest: {\n      retryParameters: shaka.net.NetworkingEngine.defaultRetryParameters(),\n      dash: {\n        customScheme: function(node) {\n          // Reference node to keep closure from removing it.\n          // If the argument is removed, it breaks our function length check\n          // in mergeConfigObjects_().\n          // TODO: Find a better solution if possible.\n          // NOTE: Chrome App Content Security Policy prohibits usage of new\n          // Function()\n\n          if (node) return null;\n        },\n        clockSyncUri: '',\n        ignoreDrmInfo: false\n      },\n      hls: {\n        defaultTimeOffset: 0\n      }\n    },\n    streaming: {\n      retryParameters: shaka.net.NetworkingEngine.defaultRetryParameters(),\n      infiniteRetriesForLiveStreams: true,\n      rebufferingGoal: 2,\n      bufferingGoal: 10,\n      bufferBehind: 30,\n      ignoreTextStreamFailures: false,\n      startAtSegmentBoundary: false,\n      smallGapLimit: 0.5,\n      jumpLargeGaps: false\n    },\n    abr: {\n      manager: this.defaultAbrManager_,\n      enabled: true,\n      defaultBandwidthEstimate:\n          shaka.abr.EwmaBandwidthEstimator.DEFAULT_ESTIMATE,\n      restrictions: {\n        minWidth: 0,\n        maxWidth: Infinity,\n        minHeight: 0,\n        maxHeight: Infinity,\n        minPixels: 0,\n        maxPixels: Infinity,\n        minBandwidth: 0,\n        maxBandwidth: Infinity\n      }\n    },\n    preferredAudioLanguage: '',\n    preferredTextLanguage: '',\n    restrictions: {\n      minWidth: 0,\n      maxWidth: Infinity,\n      minHeight: 0,\n      maxHeight: Infinity,\n      minPixels: 0,\n      maxPixels: Infinity,\n      minBandwidth: 0,\n      maxBandwidth: Infinity\n    }\n  };\n};\n\n\n/**\n * @return {shakaExtern.Stats}\n * @private\n */\nshaka.Player.prototype.getCleanStats_ = function() {\n  return {\n    // These are not tracked in the private stats structure and are only here to\n    // satisfy the compiler.\n    width: NaN,\n    height: NaN,\n    streamBandwidth: NaN,\n    decodedFrames: NaN,\n    droppedFrames: NaN,\n    estimatedBandwidth: NaN,\n\n    // These are tracked in the private stats structure to avoid the need for\n    // many private member variables.\n    loadLatency: NaN,\n    playTime: 0,\n    bufferingTime: 0,\n    switchHistory: [],\n    stateHistory: []\n  };\n};\n\n\n/**\n * @param {shakaExtern.Period} period\n * @private\n */\nshaka.Player.prototype.filterPeriod_ = function(period) {\n  goog.asserts.assert(this.video_, 'Must not be destroyed');\n  var StreamUtils = shaka.util.StreamUtils;\n\n  var activeStreams =\n      this.streamingEngine_ ? this.streamingEngine_.getActiveStreams() : {};\n  StreamUtils.filterPeriod(this.drmEngine_, activeStreams, period);\n\n  // Check for playable variants before restrictions to give a different error\n  // if we have restricted all the tracks rather than there being none.\n  var hasPlayableVariants =\n      StreamUtils.getPlayableVariants(period.variants).length > 0;\n\n  var tracksChanged = shaka.util.StreamUtils.applyRestrictions(\n      period, this.config_.restrictions, this.maxHwRes_);\n  if (tracksChanged && this.streamingEngine_ &&\n      this.streamingEngine_.getCurrentPeriod() == period) {\n    this.onTracksChanged_();\n  }\n\n  // Check for playable variants again. If the first check found variants, but\n  // not the second, then all variants are restricted.\n  var allVariantsRestricted =\n      StreamUtils.getPlayableVariants(period.variants).length < 1;\n\n  if (!hasPlayableVariants) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.UNPLAYABLE_PERIOD);\n  } else if (allVariantsRestricted) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.RESTRICTIONS_CANNOT_BE_MET);\n  }\n};\n\n\n/**\n * Switches to the given streams, deferring switches if needed.\n * @param {!Object.<shaka.util.ManifestParserUtils.ContentType,\n                    shakaExtern.Stream>} streamsByType\n * @param {boolean=} opt_clearBuffer\n * @private\n */\nshaka.Player.prototype.deferredSwitch_ = function(\n    streamsByType, opt_clearBuffer) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  for (var type in streamsByType) {\n    var stream = streamsByType[type];\n    var clearBuffer = opt_clearBuffer || false;\n    // TODO: consider adding a cue replacement algorithm to TextEngine to remove\n    // this special case for text:\n    if (type == ContentType.TEXT) clearBuffer = true;\n    if (this.switchingPeriods_) {\n      this.deferredSwitches_[type] = {stream: stream, clearBuffer: clearBuffer};\n    } else {\n      this.streamingEngine_.switch(type, stream, clearBuffer);\n    }\n  }\n};\n\n\n/**\n * Verifies that the active streams according to the player match those in\n * StreamingEngine.\n * @private\n */\nshaka.Player.prototype.assertCorrectActiveStreams_ = function() {\n  if (!this.streamingEngine_ || !this.manifest_ || COMPILED) return;\n  var StreamUtils = shaka.util.StreamUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  var streamingActive = this.streamingEngine_.getActiveStreams();\n  var mainStream =\n      streamingActive[ContentType.VIDEO] || streamingActive[ContentType.AUDIO];\n  if (!mainStream)\n    return;\n\n  var streamingPeriodIndex =\n      StreamUtils.findPeriodContainingStream(this.manifest_, mainStream);\n  var currentPeriodIndex =\n      this.manifest_.periods.indexOf(this.streamingEngine_.getCurrentPeriod());\n  if (streamingPeriodIndex < 0 || streamingPeriodIndex != currentPeriodIndex)\n    return;\n\n  var playerActive = this.activeStreamsByPeriod_[currentPeriodIndex] || {};\n  for (var type in streamingActive) {\n    var activeId = streamingActive[type].id;\n    if (this.deferredSwitches_[type])\n      activeId = this.deferredSwitches_[type].stream.id;\n    goog.asserts.assert(activeId == playerActive[type],\n                        'Inconsistent active stream');\n  }\n};\n\n\n/** @private */\nshaka.Player.prototype.updateTimeStats_ = function() {\n  // Only count while we're loaded.\n  if (!this.manifest_)\n    return;\n\n  var now = Date.now() / 1000;\n  if (this.buffering_)\n    this.stats_.bufferingTime += (now - this.lastTimeStatsUpdateTimestamp_);\n  else\n    this.stats_.playTime += (now - this.lastTimeStatsUpdateTimestamp_);\n\n  this.lastTimeStatsUpdateTimestamp_ = now;\n};\n\n\n/**\n * @param {number} time\n * @return {number}\n * @private\n */\nshaka.Player.prototype.adjustStartTime_ = function(time) {\n  var activeStreams = this.streamingEngine_.getActiveStreams();\n  var period = this.streamingEngine_.getCurrentPeriod();\n\n  // This method is called after StreamingEngine.init resolves, this means that\n  // all the active streams have had createSegmentIndex called.\n  function getAdjustedTime(stream, time) {\n    if (!stream) return null;\n    var idx = stream.findSegmentPosition(time - period.startTime);\n    if (idx == null) return null;\n    var ref = stream.getSegmentReference(idx);\n    if (!ref) return null;\n    var refTime = ref.startTime + period.startTime;\n    goog.asserts.assert(refTime <= time, 'Segment should start before time');\n    return refTime;\n  }\n\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var videoStartTime = getAdjustedTime(activeStreams[ContentType.VIDEO], time);\n  var audioStartTime = getAdjustedTime(activeStreams[ContentType.AUDIO], time);\n\n  // If we have both video and audio times, pick the larger one.  If we picked\n  // the smaller one, that one will download an entire segment to buffer the\n  // difference.\n  if (videoStartTime != null && audioStartTime != null)\n    return Math.max(videoStartTime, audioStartTime);\n  else if (videoStartTime != null)\n    return videoStartTime;\n  else if (audioStartTime != null)\n    return audioStartTime;\n  else\n    return time;\n};\n\n\n/**\n * Callback from NetworkingEngine.\n *\n * @param {number} deltaTimeMs\n * @param {number} numBytes\n * @private\n */\nshaka.Player.prototype.onSegmentDownloaded_ = function(deltaTimeMs, numBytes) {\n  this.config_.abr.manager.segmentDownloaded(deltaTimeMs, numBytes);\n};\n\n\n/**\n * Callback from PlayheadObserver.\n *\n * @param {boolean} buffering\n * @private\n */\nshaka.Player.prototype.onBuffering_ = function(buffering) {\n  // Before setting |buffering_|, update the time spent in the previous state.\n  this.updateTimeStats_();\n  this.buffering_ = buffering;\n  this.updateState_();\n\n  if (this.playhead_)\n    this.playhead_.setBuffering(buffering);\n\n  var event = new shaka.util.FakeEvent('buffering', { 'buffering': buffering });\n  this.dispatchEvent(event);\n};\n\n\n/**\n * Callback from PlayheadObserver.\n * @private\n */\nshaka.Player.prototype.onChangePeriod_ = function() {\n  this.onTracksChanged_();\n};\n\n\n/**\n * Called from potential initiators of state change, or before returning stats\n * to the user.\n *\n * This method decides if state has actually changed, updates the last entry,\n * and adds a new one if needed.\n *\n * @private\n */\nshaka.Player.prototype.updateState_ = function() {\n  if (this.destroyed_) return;\n\n  var newState;\n  if (this.buffering_) {\n    newState = 'buffering';\n  } else if (this.video_.ended) {\n    newState = 'ended';\n  } else if (this.video_.paused) {\n    newState = 'paused';\n  } else {\n    newState = 'playing';\n  }\n\n  var now = Date.now() / 1000;\n  if (this.stats_.stateHistory.length) {\n    var lastIndex = this.stats_.stateHistory.length - 1;\n    var lastEntry = this.stats_.stateHistory[lastIndex];\n    lastEntry.duration = now - lastEntry.timestamp;\n\n    if (newState == lastEntry.state) {\n      // The state has not changed, so do not add anything to the history.\n      return;\n    }\n  }\n\n  this.stats_.stateHistory.push({\n    timestamp: now,\n    state: newState,\n    duration: 0\n  });\n};\n\n\n/**\n * Callback from Playhead.\n *\n * @private\n */\nshaka.Player.prototype.onSeek_ = function() {\n  if (this.playheadObserver_)\n    this.playheadObserver_.seeked();\n  if (this.streamingEngine_)\n    this.streamingEngine_.seeked();\n};\n\n\n/**\n * Chooses streams from the given Period.\n *\n * @param {!shakaExtern.Period} period\n * @param {!Array.<!shakaExtern.Variant>} variants\n * @param {!Array.<!shakaExtern.Stream>} textStreams\n * @param {boolean=} opt_chooseAll If true, choose streams of every type.\n * @return {!Object.<string, !shakaExtern.Stream>} A map of stream types to\n *   chosen streams.\n * @private\n */\nshaka.Player.prototype.chooseStreams_ =\n    function(period, variants, textStreams, opt_chooseAll) {\n  goog.asserts.assert(this.config_, 'Must not be destroyed');\n\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  // Issue an error if there are no playable variants\n  if (!variants || variants.length < 1) {\n    this.onError_(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.RESTRICTIONS_CANNOT_BE_MET));\n    return {};\n  }\n\n  // Update abr manager with newly filtered streams and variants.\n  this.config_.abr.manager.setVariants(variants);\n  this.config_.abr.manager.setTextStreams(textStreams);\n\n  var needsUpdate = [];\n  if (opt_chooseAll) {\n    needsUpdate = [ContentType.VIDEO, ContentType.AUDIO];\n    if (period.textStreams.length) needsUpdate.push(ContentType.TEXT);\n  }\n\n  // Check if any of the active streams is no longer available\n  // or is using the wrong language.\n  var activeStreams = this.streamingEngine_.getActiveStreams();\n  // activePeriod may reasonably be null before StreamingEngine is streaming.\n  var activePeriod = this.streamingEngine_.getActivePeriod();\n  var activeVariant = shaka.util.StreamUtils.getVariantByStreams(\n      activeStreams[ContentType.AUDIO],\n      activeStreams[ContentType.VIDEO],\n      activePeriod ? activePeriod.variants : period.variants);\n\n  if (activeVariant) {\n    if (!activeVariant.allowedByApplication ||\n        !activeVariant.allowedByKeySystem) {\n      needsUpdate.push(ContentType.AUDIO);\n      needsUpdate.push(ContentType.VIDEO);\n    }\n\n    for (var type in activeStreams) {\n      var stream = activeStreams[type];\n      if (stream.type == ContentType.AUDIO &&\n          stream.language != variants[0].language) {\n        needsUpdate.push(type);\n      } else if (stream.type == ContentType.TEXT && textStreams.length > 0 &&\n                 stream.language != textStreams[0].language) {\n        needsUpdate.push(type);\n      }\n    }\n  }\n\n  needsUpdate = needsUpdate.filter(shaka.util.Functional.isNotDuplicate);\n\n  if (needsUpdate.length > 0) {\n    shaka.log.debug('Choosing new streams for', needsUpdate);\n    var chosen = {};\n    try {\n      chosen = this.config_.abr.manager.chooseStreams(needsUpdate);\n    } catch (err) {\n      this.onError_(err);\n    }\n\n    return chosen;\n  } else {\n    shaka.log.debug('No new streams need to be chosen.');\n    return {};\n  }\n};\n\n\n/**\n * Chooses streams from the given Period and switches to them.\n * Called after a config change, a new text stream, or a key status event.\n *\n * @param {!shakaExtern.Period} period\n * @private\n */\nshaka.Player.prototype.chooseStreamsAndSwitch_ = function(period) {\n  goog.asserts.assert(this.config_, 'Must not be destroyed');\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  // Create empty object first and initialize the fields through\n  // [] to allow field names to be expressions.\n  var languageMatches = {};\n  languageMatches[ContentType.AUDIO] = false;\n  languageMatches[ContentType.TEXT] = false;\n\n  var variants = shaka.util.StreamUtils.filterVariantsByRoleAndLanguage(\n      period, this.currentAudioLanguage_, languageMatches,\n      this.currentVariantRole_);\n  var textStreams = shaka.util.StreamUtils.filterTextStreamsByRoleAndLanguage(\n      period, this.currentTextLanguage_, languageMatches,\n      this.currentTextRole_);\n\n  // chooseStreams_ filters out choices which are already active.\n  var chosen = this.chooseStreams_(period, variants, textStreams);\n\n  for (var type in chosen) {\n    this.addToSwitchHistory_(chosen[type], /* fromAdaptation */ true);\n  }\n\n  // Because we're running this after a config change (manual language change),\n  // a new text stream, or a key status event, and because active streams have\n  // been filtered out already, it is always okay to clear the buffer for what\n  // remains.\n  this.deferredSwitch_(chosen, /* opt_clearBuffer */ true);\n\n  // Send an adaptation event so that the UI can show the new language/tracks.\n  this.onAdaptation_();\n\n  if (chosen[ContentType.TEXT]) {\n    // If audio and text tracks have different languages, and the text track\n    // matches the user's preference, then show the captions.\n    if (chosen[ContentType.AUDIO] &&\n        languageMatches[ContentType.TEXT] &&\n        chosen[ContentType.TEXT].language !=\n            chosen[ContentType.AUDIO].language) {\n      this.textTrack_.mode = 'showing';\n      this.onTextTrackVisibility_();\n    }\n  }\n};\n\n\n/**\n * Callback from StreamingEngine.\n *\n * @param {!shakaExtern.Period} period\n * @return {!Object.<string, !shakaExtern.Stream>} A map of stream types to\n *   chosen streams.\n * @private\n */\nshaka.Player.prototype.onChooseStreams_ = function(period) {\n  shaka.log.debug('onChooseStreams_', period);\n  goog.asserts.assert(this.config_, 'Must not be destroyed');\n\n  // We are switching Periods, so the AbrManager will be disabled.  But if we\n  // want to abr.enabled, we do not want to call AbrManager.enable before\n  // canSwitch_ is called.\n  this.switchingPeriods_ = true;\n  this.config_.abr.manager.disable();\n\n  shaka.log.debug('Choosing new streams after period changed');\n  var variants = shaka.util.StreamUtils.filterVariantsByRoleAndLanguage(\n      period, this.currentAudioLanguage_, /* opt_languageMatches */ undefined,\n      this.currentVariantRole_);\n\n  var textStreams = shaka.util.StreamUtils.filterTextStreamsByRoleAndLanguage(\n      period, this.currentTextLanguage_, /* opt_languageMatches */ undefined,\n      this.currentTextRole_);\n\n  shaka.log.v2('onChooseStreams_, variants and text streams: ',\n               variants, textStreams);\n\n  var chosen = this.chooseStreams_(\n      period, variants, textStreams, /* opt_chooseAll */ true);\n  shaka.log.v2('onChooseStreams_, chosen=', chosen);\n\n  // Override the chosen streams with the ones picked in\n  // selectVariant/TextTrack. NOTE: The apparent race between\n  // selectVariant/TextTrack and period transition is handled by\n  // StreamingEngine, which will re-request tracks for thetransition if any\n  // of these deferred selections are from the wrong period.\n  for (var type in this.deferredSwitches_) {\n    // We are choosing initial tracks, so no segments from this Period have\n    // been downloaded yet.  Therefore, it is okay to ignore the .clearBuffer\n    // member of this structure.\n    chosen[type] = this.deferredSwitches_[type].stream;\n  }\n  this.deferredSwitches_ = {};\n\n  for (var type in chosen) {\n    this.addToSwitchHistory_(chosen[type], /* fromAdaptation */ true);\n  }\n\n  // Don't fire a tracks-changed event since we aren't inside the new Period\n  // yet.\n\n  return chosen;\n};\n\n\n/**\n * Callback from StreamingEngine.\n *\n * @private\n */\nshaka.Player.prototype.canSwitch_ = function() {\n  shaka.log.debug('canSwitch_');\n  this.switchingPeriods_ = false;\n  if (this.config_.abr.enabled)\n    this.config_.abr.manager.enable();\n\n  // If we still have deferred switches, switch now.\n  for (var type in this.deferredSwitches_) {\n    var info = this.deferredSwitches_[type];\n    this.streamingEngine_.switch(type, info.stream, info.clearBuffer);\n  }\n  this.deferredSwitches_ = {};\n};\n\n\n/**\n * Callback from StreamingEngine.\n *\n * @private\n */\nshaka.Player.prototype.onManifestUpdate_ = function() {\n  if (this.parser_ && this.parser_.update)\n    this.parser_.update();\n};\n\n\n/**\n * Callback from StreamingEngine.\n *\n * @private\n */\nshaka.Player.prototype.onSegmentAppended_ = function() {\n  if (this.playhead_)\n    this.playhead_.onSegmentAppended();\n};\n\n\n/**\n * Callback from AbrManager.\n *\n * @param {!Object.<shaka.util.ManifestParserUtils.ContentType,\n *                  !shakaExtern.Stream>} streamsByType\n * @param {boolean=} opt_clearBuffer\n * @private\n */\nshaka.Player.prototype.switch_ = function(streamsByType, opt_clearBuffer) {\n  shaka.log.debug('switch_');\n  goog.asserts.assert(this.config_.abr.enabled,\n      'AbrManager should not call switch while disabled!');\n  goog.asserts.assert(!this.switchingPeriods_,\n      'AbrManager should not call switch while transitioning between Periods!');\n\n  // We have adapted to a new stream, record it in the history.  Only add if\n  // we are actually switching the stream.\n  var oldActive = this.streamingEngine_.getActiveStreams();\n  for (var type in streamsByType) {\n    var stream = streamsByType[type];\n    if (oldActive[type] != stream) {\n      this.addToSwitchHistory_(stream, /* fromAdaptation */ true);\n    } else {\n      // If it's the same, remove it from the map.\n      // This allows us to avoid onAdaptation_() when nothing has changed.\n      delete streamsByType[type];\n    }\n  }\n\n  if (shaka.util.MapUtils.empty(streamsByType)) {\n    // There's nothing to change.\n    return;\n  }\n\n  if (!this.streamingEngine_) {\n    // There's no way to change it.\n    return;\n  }\n\n  for (var type in streamsByType) {\n    var clearBuffer = opt_clearBuffer || false;\n    this.streamingEngine_.switch(type, streamsByType[type], clearBuffer);\n  }\n  this.onAdaptation_();\n};\n\n\n/**\n * Dispatches a 'adaptation' event.\n * @private\n */\nshaka.Player.prototype.onAdaptation_ = function() {\n  // In the next frame, dispatch a 'adaptation' event.\n  // This gives StreamingEngine time to absorb the changes before the user\n  // tries to query them.\n  Promise.resolve().then(function() {\n    if (this.destroyed_) return;\n    var event = new shaka.util.FakeEvent('adaptation');\n    this.dispatchEvent(event);\n  }.bind(this));\n};\n\n\n/**\n * Dispatches a 'trackschanged' event.\n * @private\n */\nshaka.Player.prototype.onTracksChanged_ = function() {\n  // In the next frame, dispatch a 'trackschanged' event.\n  // This gives StreamingEngine time to absorb the changes before the user\n  // tries to query them.\n  Promise.resolve().then(function() {\n    if (this.destroyed_) return;\n    var event = new shaka.util.FakeEvent('trackschanged');\n    this.dispatchEvent(event);\n  }.bind(this));\n};\n\n\n/** @private */\nshaka.Player.prototype.onTextTrackVisibility_ = function() {\n  var event = new shaka.util.FakeEvent('texttrackvisibility');\n  this.dispatchEvent(event);\n};\n\n\n/**\n * @param {!shaka.util.Error} error\n * @private\n */\nshaka.Player.prototype.onError_ = function(error) {\n  // Errors dispatched after destroy is called are irrelevant.\n  if (this.destroyed_) return;\n\n  goog.asserts.assert(error instanceof shaka.util.Error, 'Wrong error type!');\n\n  var event = new shaka.util.FakeEvent('error', { 'detail': error });\n  this.dispatchEvent(event);\n};\n\n\n/**\n * @param {shakaExtern.TimelineRegionInfo} region\n * @private\n */\nshaka.Player.prototype.onTimelineRegionAdded_ = function(region) {\n  if (this.playheadObserver_) {\n    this.playheadObserver_.addTimelineRegion(region);\n  } else {\n    this.pendingTimelineRegions_.push(region);\n  }\n};\n\n\n/**\n * @param {!Event} event\n * @private\n */\nshaka.Player.prototype.onEvent_ = function(event) {\n  this.dispatchEvent(event);\n};\n\n\n/**\n * @param {!Event} event\n * @private\n */\nshaka.Player.prototype.onVideoError_ = function(event) {\n  if (!this.video_.error) return;\n\n  var code = this.video_.error.code;\n  if (code == 1 /* MEDIA_ERR_ABORTED */) {\n    // Ignore this error code, which should only occur when navigating away or\n    // deliberately stopping playback of HTTP content.\n    return;\n  }\n\n  // Extra error information from MS Edge and IE11:\n  var extended = this.video_.error.msExtendedCode;\n  if (extended) {\n    // Convert to unsigned:\n    if (extended < 0) {\n      extended += Math.pow(2, 32);\n    }\n    // Format as hex:\n    extended = extended.toString(16);\n  }\n\n  this.onError_(new shaka.util.Error(\n      shaka.util.Error.Severity.CRITICAL,\n      shaka.util.Error.Category.MEDIA,\n      shaka.util.Error.Code.VIDEO_ERROR,\n      code, extended));\n};\n\n\n/**\n * @param {!Object.<string, string>} keyStatusMap A map of hex key IDs to\n *   statuses.\n * @private\n */\nshaka.Player.prototype.onKeyStatus_ = function(keyStatusMap) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  goog.asserts.assert(this.streamingEngine_, 'Should have been initialized.');\n  // 'usable', 'released', 'output-downscaled', 'status-pending' are statuses\n  // of the usable keys.\n  // 'expired' status is being handled separately in DrmEngine.\n  var restrictedStatuses = ['output-restricted', 'internal-error'];\n\n  var period = this.streamingEngine_.getCurrentPeriod();\n  var tracksChanged = false;\n\n  period.variants.forEach(function(variant) {\n    var streams = [];\n    if (variant.audio) streams.push(variant.audio);\n    if (variant.video) streams.push(variant.video);\n\n    streams.forEach(function(stream) {\n      var originalAllowed = variant.allowedByKeySystem;\n\n      // Only update if we have a key ID for the stream.  If the key isn't\n      // present, then we don't have that key and it should be restricted.\n      if (stream.keyId) {\n        var keyStatus = keyStatusMap[stream.keyId];\n        variant.allowedByKeySystem =\n            !!keyStatus && restrictedStatuses.indexOf(keyStatus) < 0;\n      }\n\n      if (originalAllowed != variant.allowedByKeySystem) {\n        tracksChanged = true;\n      }\n    });\n  });\n\n  var activeStreams = this.streamingEngine_.getActiveStreams();\n  var activeVariant = shaka.util.StreamUtils.getVariantByStreams(\n      activeStreams[ContentType.AUDIO], activeStreams[ContentType.VIDEO],\n      period.variants);\n  if (activeVariant && !activeVariant.allowedByKeySystem) {\n    shaka.log.debug('Choosing new streams after key status changed');\n    this.chooseStreamsAndSwitch_(period);\n  }\n\n  if (tracksChanged)\n    this.onTracksChanged_();\n};\n\n\n/**\n * Callback from DrmEngine\n * @param {string} keyId\n * @param {number} expiration\n * @private\n */\nshaka.Player.prototype.onExpirationUpdated_ = function(keyId, expiration) {\n  if (this.parser_ && this.parser_.onExpirationUpdated)\n    this.parser_.onExpirationUpdated(keyId, expiration);\n\n  var event = new shaka.util.FakeEvent('expirationupdated');\n  this.dispatchEvent(event);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/player.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.cast.CastReceiver');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.cast.CastUtils');\ngoog.require('shaka.log');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.FakeEventTarget');\ngoog.require('shaka.util.IDestroyable');\n\n\n\n/**\n * A receiver to communicate between the Chromecast-hosted player and the\n * sender application.\n *\n * @constructor\n * @struct\n * @param {!HTMLMediaElement} video The local video element associated with the\n *   local Player instance.\n * @param {!shaka.Player} player A local Player instance.\n * @param {function(Object)=} opt_appDataCallback A callback to handle\n *   application-specific data passed from the sender.\n  * @param {function(string):string=} opt_contentIdCallback A callback to\n *   retrieve manifest URI from the provided content id.\n * @implements {shaka.util.IDestroyable}\n * @extends {shaka.util.FakeEventTarget}\n * @export\n */\nshaka.cast.CastReceiver =\n    function(video, player, opt_appDataCallback, opt_contentIdCallback) {\n  shaka.util.FakeEventTarget.call(this);\n\n  /** @private {HTMLMediaElement} */\n  this.video_ = video;\n\n  /** @private {shaka.Player} */\n  this.player_ = player;\n\n  /** @private {Object} */\n  this.targets_ = {\n    'video': video,\n    'player': player\n  };\n\n  /** @private {?function(Object)} */\n  this.appDataCallback_ = opt_appDataCallback || function() {};\n\n  /** @private {?function(string):string} */\n  this.opt_contentIdCallback_ = opt_contentIdCallback ||\n                            /** @param {string} contentId\n                                @return {string} */\n                            function(contentId) { return contentId; };\n\n  /** @private {boolean} */\n  this.isConnected_ = false;\n\n  /** @private {boolean} */\n  this.isIdle_ = true;\n\n  /** @private {cast.receiver.CastMessageBus} */\n  this.shakaBus_ = null;\n\n  /** @private {cast.receiver.CastMessageBus} */\n  this.genericBus_ = null;\n\n  /** @private {?number} */\n  this.pollTimerId_ = null;\n\n  this.init_();\n};\ngoog.inherits(shaka.cast.CastReceiver, shaka.util.FakeEventTarget);\n\n\n/**\n * @return {boolean} True if the cast API is available and there are receivers.\n * @export\n */\nshaka.cast.CastReceiver.prototype.isConnected = function() {\n  return this.isConnected_;\n};\n\n\n/**\n * @return {boolean} True if the receiver is not currently doing loading or\n *   playing anything.\n * @export\n */\nshaka.cast.CastReceiver.prototype.isIdle = function() {\n  return this.isIdle_;\n};\n\n\n/**\n * Destroys the underlying Player, then terminates the cast receiver app.\n *\n * @override\n * @export\n */\nshaka.cast.CastReceiver.prototype.destroy = function() {\n  var p = this.player_ ? this.player_.destroy() : Promise.resolve();\n\n  if (this.pollTimerId_ != null) {\n    window.clearTimeout(this.pollTimerId_);\n  }\n\n  this.video_ = null;\n  this.player_ = null;\n  this.targets_ = null;\n  this.appDataCallback_ = null;\n  this.isConnected_ = false;\n  this.isIdle_ = true;\n  this.shakaBus_ = null;\n  this.genericBus_ = null;\n  this.pollTimerId_ = null;\n\n  return p.then(function() {\n    var manager = cast.receiver.CastReceiverManager.getInstance();\n    manager.stop();\n  });\n};\n\n\n/** @private */\nshaka.cast.CastReceiver.prototype.init_ = function() {\n  var manager = cast.receiver.CastReceiverManager.getInstance();\n  manager.onSenderConnected = this.onSendersChanged_.bind(this);\n  manager.onSenderDisconnected = this.onSendersChanged_.bind(this);\n  manager.onSystemVolumeChanged = this.fakeVolumeChangeEvent_.bind(this);\n\n  this.genericBus_ = manager.getCastMessageBus(\n      shaka.cast.CastUtils.GENERIC_MESSAGE_NAMESPACE);\n  this.genericBus_.onMessage = this.onGenericMessage_.bind(this);\n\n  this.shakaBus_ = manager.getCastMessageBus(\n      shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE);\n  this.shakaBus_.onMessage = this.onShakaMessage_.bind(this);\n\n  if (!COMPILED) {\n    // Sometimes it is useful to load the receiver app in Chrome to work on the\n    // UI.  To avoid log spam caused by the SDK trying to connect to web sockets\n    // that don't exist, in uncompiled mode we check if the hosting browser is a\n    // Chromecast before starting the receiver manager.  We wouldn't do browser\n    // detection except for debugging, so only do this in uncompiled mode.\n    var isChromecast = navigator.userAgent.indexOf('CrKey') >= 0;\n    if (isChromecast) {\n      manager.start();\n    }\n  } else {\n    manager.start();\n  }\n\n  shaka.cast.CastUtils.VideoEvents.forEach(function(name) {\n    this.video_.addEventListener(name, this.proxyEvent_.bind(this, 'video'));\n  }.bind(this));\n\n  shaka.cast.CastUtils.PlayerEvents.forEach(function(name) {\n    this.player_.addEventListener(name, this.proxyEvent_.bind(this, 'player'));\n  }.bind(this));\n\n  // In our tests, the original Chromecast seems to have trouble decoding above\n  // 1080p.  It would be a waste to select a higher res anyway, given that the\n  // device only outputs 1080p to begin with.\n\n  // Chromecast has an extension to query the device/display's resolution.\n  if (cast.__platform__ && cast.__platform__.canDisplayType(\n      'video/mp4; codecs=\"avc1.640028\"; width=3840; height=2160')) {\n    // The device & display can both do 4k.  Assume a 4k limit.\n    this.player_.setMaxHardwareResolution(3840, 2160);\n  } else {\n    // Chromecast has always been able to do 1080p.  Assume a 1080p limit.\n    this.player_.setMaxHardwareResolution(1920, 1080);\n  }\n\n  // Maintain idle state.\n  this.player_.addEventListener('loading', function() {\n    // No longer idle once loading.  This allows us to show the spinner during\n    // the initial buffering phase.\n    this.isIdle_ = false;\n    this.onCastStatusChanged_();\n  }.bind(this));\n  this.video_.addEventListener('playing', function() {\n    // No longer idle once playing.  This allows us to replay a video without\n    // reloading.\n    this.isIdle_ = false;\n    this.onCastStatusChanged_();\n  }.bind(this));\n  this.video_.addEventListener('pause', function() {\n    this.onCastStatusChanged_();\n  }.bind(this));\n  this.player_.addEventListener('unloading', function() {\n    // Go idle when unloading content.\n    this.isIdle_ = true;\n    this.onCastStatusChanged_();\n  }.bind(this));\n  this.video_.addEventListener('ended', function() {\n    // Go idle 5 seconds after 'ended', assuming we haven't started again or\n    // been destroyed.\n    window.setTimeout(function() {\n      if (this.video_ && this.video_.ended) {\n        this.isIdle_ = true;\n        this.onCastStatusChanged_();\n      }\n    }.bind(this), 5000);\n  }.bind(this));\n\n  // Do not start polling until after the sender's 'init' message is handled.\n};\n\n\n/** @private */\nshaka.cast.CastReceiver.prototype.onSendersChanged_ = function() {\n  var manager = cast.receiver.CastReceiverManager.getInstance();\n  this.isConnected_ = manager.getSenders().length != 0;\n  this.onCastStatusChanged_();\n};\n\n\n/**\n * Dispatch an event to notify the receiver app that the status has changed.\n * @private\n */\nshaka.cast.CastReceiver.prototype.onCastStatusChanged_ = function() {\n  // Do this asynchronously so that synchronous changes to idle state (such as\n  // Player calling unload() as part of load()) are coalesced before the event\n  // goes out.\n  Promise.resolve().then(function() {\n    var event = new shaka.util.FakeEvent('caststatuschanged');\n    this.dispatchEvent(event);\n    this.sendMediaStatus_(0);\n  }.bind(this));\n};\n\n\n/**\n * Take on initial state from the sender.\n * @param {shaka.cast.CastUtils.InitStateType} initState\n * @param {Object} appData\n * @private\n */\nshaka.cast.CastReceiver.prototype.initState_ = function(initState, appData) {\n  // Take on player state first.\n  for (var k in initState['player']) {\n    var v = initState['player'][k];\n    // All player state vars are setters to be called.\n    /** @type {Object} */(this.player_)[k](v);\n  }\n\n  // Now process custom app data, which may add additional player configs:\n  this.appDataCallback_(appData);\n\n  var manifestReady = Promise.resolve();\n  var autoplay = this.video_.autoplay;\n\n  // Now load the manifest, if present.\n  if (initState['manifest']) {\n    // Don't autoplay the content until we finish setting up initial state.\n    this.video_.autoplay = false;\n    manifestReady = this.player_.load(\n        initState['manifest'], initState['startTime']);\n    // Pass any errors through to the app.\n    manifestReady.catch(function(error) {\n      goog.asserts.assert(error instanceof shaka.util.Error,\n                          'Wrong error type!');\n      var event = new shaka.util.FakeEvent('error', { 'detail': error });\n      this.player_.dispatchEvent(event);\n    }.bind(this));\n  }\n\n  // Finally, take on video state and player's \"after load\" state.\n  manifestReady.then(function() {\n    for (var k in initState['video']) {\n      var v = initState['video'][k];\n      this.video_[k] = v;\n    }\n\n    for (var k in initState['playerAfterLoad']) {\n      var v = initState['playerAfterLoad'][k];\n      // All player state vars are setters to be called.\n      /** @type {Object} */(this.player_)[k](v);\n    }\n\n    // Restore original autoplay setting.\n    this.video_.autoplay = autoplay;\n    if (initState['manifest']) {\n      // Resume playback with transferred state.\n      this.video_.play();\n      // Notify generic controllers of the state change.\n      this.sendMediaStatus_(0);\n    }\n  }.bind(this));\n};\n\n\n/**\n * @param {string} targetName\n * @param {!Event} event\n * @private\n */\nshaka.cast.CastReceiver.prototype.proxyEvent_ = function(targetName, event) {\n  // Poll and send an update right before we send the event.  Some events\n  // indicate an attribute change, so that change should be visible when the\n  // event is handled.\n  this.pollAttributes_();\n\n  this.sendMessage_({\n    'type': 'event',\n    'targetName': targetName,\n    'event': event\n  }, this.shakaBus_);\n};\n\n\n/** @private */\nshaka.cast.CastReceiver.prototype.pollAttributes_ = function() {\n  // The poll timer may have been pre-empted by an event.\n  // To avoid polling too often, we clear it here.\n  if (this.pollTimerId_ != null) {\n    window.clearTimeout(this.pollTimerId_);\n  }\n  // Since we know the timer has been cleared, start a new one now.\n  // This will be preempted by events, including 'timeupdate'.\n  this.pollTimerId_ = window.setTimeout(this.pollAttributes_.bind(this), 500);\n\n  var update = {\n    'video': {},\n    'player': {}\n  };\n\n  shaka.cast.CastUtils.VideoAttributes.forEach(function(name) {\n    update['video'][name] = this.video_[name];\n  }.bind(this));\n\n  shaka.cast.CastUtils.PlayerGetterMethods.forEach(function(name) {\n    update['player'][name] = /** @type {Object} */(this.player_)[name]();\n  }.bind(this));\n\n  // Volume attributes are tied to the system volume.\n  var manager = cast.receiver.CastReceiverManager.getInstance();\n  var systemVolume = manager.getSystemVolume();\n  if (systemVolume) {\n    update['video']['volume'] = systemVolume.level;\n    update['video']['muted'] = systemVolume.muted;\n  }\n\n  this.sendMessage_({\n    'type': 'update',\n    'update': update\n  }, this.shakaBus_);\n};\n\n\n/**\n * Dispatch a fake 'volumechange' event to mimic the video element, since volume\n * changes are routed to the system volume on the receiver.\n * @private\n */\nshaka.cast.CastReceiver.prototype.fakeVolumeChangeEvent_ = function() {\n  // Volume attributes are tied to the system volume.\n  var manager = cast.receiver.CastReceiverManager.getInstance();\n  var systemVolume = manager.getSystemVolume();\n  goog.asserts.assert(systemVolume, 'System volume should not be null!');\n\n  if (systemVolume) {\n    // Send an update message with just the latest volume level and muted state.\n    this.sendMessage_({\n      'type': 'update',\n      'update': {\n        'video': {\n          'volume': systemVolume.level,\n          'muted': systemVolume.muted\n        }\n      }\n    }, this.shakaBus_);\n  }\n\n  // Send another message with a 'volumechange' event to update the sender's UI.\n  this.sendMessage_({\n    'type': 'event',\n    'targetName': 'video',\n    'event': {'type': 'volumechange'}\n  }, this.shakaBus_);\n};\n\n\n/**\n * Since this method is in the compiled library, make sure all messages are\n * read with quoted properties.\n * @param {cast.receiver.CastMessageBus.Event} event\n * @private\n */\nshaka.cast.CastReceiver.prototype.onShakaMessage_ = function(event) {\n  var message = shaka.cast.CastUtils.deserialize(event.data);\n  shaka.log.debug('CastReceiver: message', message);\n\n  switch (message['type']) {\n    case 'init':\n      this.initState_(message['initState'], message['appData']);\n      // The sender is supposed to reflect the cast system volume after\n      // connecting.  Using fakeVolumeChangeEvent_() would create a race on the\n      // sender side, since it would have volume properties, but no others.\n      // This would lead to hasRemoteProperties() being true, even though a\n      // complete set had never been sent.\n      // Now that we have init state, this is a good time for the first update\n      // message anyway.\n      this.pollAttributes_();\n      break;\n    case 'appData':\n      this.appDataCallback_(message['appData']);\n      break;\n    case 'set':\n      var targetName = message['targetName'];\n      var property = message['property'];\n      var value = message['value'];\n\n      if (targetName == 'video') {\n        // Volume attributes must be rerouted to the system.\n        var manager = cast.receiver.CastReceiverManager.getInstance();\n        if (property == 'volume') {\n          manager.setSystemVolumeLevel(value);\n          break;\n        } else if (property == 'muted') {\n          manager.setSystemVolumeMuted(value);\n          break;\n        }\n      }\n\n      this.targets_[targetName][property] = value;\n      break;\n    case 'call':\n      var targetName = message['targetName'];\n      var methodName = message['methodName'];\n      var args = message['args'];\n      var target = this.targets_[targetName];\n      target[methodName].apply(target, args);\n      break;\n    case 'asyncCall':\n      var targetName = message['targetName'];\n      var methodName = message['methodName'];\n      var args = message['args'];\n      var id = message['id'];\n      var senderId = event.senderId;\n      var target = this.targets_[targetName];\n      var p = target[methodName].apply(target, args);\n      // Replies must go back to the specific sender who initiated, so that we\n      // don't have to deal with conflicting IDs between senders.\n      p.then(this.sendAsyncComplete_.bind(this, senderId, id, /* error */ null),\n             this.sendAsyncComplete_.bind(this, senderId, id));\n      break;\n  }\n};\n\n\n/**\n * @param {cast.receiver.CastMessageBus.Event} event\n * @private\n */\nshaka.cast.CastReceiver.prototype.onGenericMessage_ = function(event) {\n  var message = shaka.cast.CastUtils.deserialize(event.data);\n  shaka.log.debug('CastReceiver: message', message);\n  // TODO(ismena): error message on duplicate request id from the same sender\n  switch (message['type']) {\n    case 'PLAY':\n      this.video_.play();\n      // Notify generic controllers that the player state changed.\n      // requestId=0 (the parameter) means that the message was not\n      // triggered by a GET_STATUS request.\n      this.sendMediaStatus_(0);\n      break;\n    case 'PAUSE':\n      this.video_.pause();\n      this.sendMediaStatus_(0);\n      break;\n    case 'SEEK':\n      var currentTime = message['currentTime'];\n      var resumeState = message['resumeState'];\n      if (currentTime != null)\n        this.video_.currentTime = Number(currentTime);\n      if (resumeState && resumeState == 'PLAYBACK_START') {\n        this.video_.play();\n        this.sendMediaStatus_(0);\n      } else if (resumeState && resumeState == 'PLAYBACK_PAUSE') {\n        this.video_.pause();\n        this.sendMediaStatus_(0);\n      }\n      break;\n    case 'STOP':\n      this.player_.unload().then(function() {\n        this.sendMediaStatus_(0);\n      }.bind(this));\n      break;\n    case 'GET_STATUS':\n      // TODO(ismena): According to the SDK this is supposed to be a\n      // unicast message to the sender that requested the status,\n      // but it doesn't appear to be working.\n      // Look into what's going on there and change this to be a\n      // unicast.\n      this.sendMediaStatus_(Number(message['requestId']));\n      break;\n    case 'VOLUME':\n      var volumeObject = message['volume'];\n      var level = volumeObject['level'];\n      var muted = volumeObject['muted'];\n      var oldVolumeLevel = this.video_.volume;\n      var oldVolumeMuted = this.video_.muted;\n      if (level != null)\n        this.video_.volume = Number(level);\n      if (muted != null)\n        this.video_.muted = muted;\n      // Notify generic controllers if the volume changed.\n      if (oldVolumeLevel != this.video_.volume ||\n          oldVolumeMuted != this.video_.muted) {\n        this.sendMediaStatus_(0);\n      }\n      break;\n    case 'LOAD':\n      var mediaInfo = message['media'];\n      var contentId = mediaInfo['contentId'];\n      var currentTime = message['currentTime'];\n      var manifestUri = this.opt_contentIdCallback_(contentId);\n      var autoplay = message['autoplay'] || true;\n      if (autoplay)\n        this.video_.autoplay = true;\n      this.player_.load(manifestUri, currentTime).then(function() {\n        // Notify generic controllers that the media has changed.\n        var media = {\n          'contentId': manifestUri,\n          'streamType': this.player_.isLive() ? 'LIVE' : 'BUFFERED',\n          // TODO: Is there a use case when this would be required?\n          // Sending an empty string for now since it's a mandatory\n          // field.\n          'contentType': ''\n        };\n        this.sendMediaStatus_(0, media);\n      }.bind(this)).catch(function(error) {\n        // Load failed. Dispatch the error message to the sender.\n        var type = 'LOAD_FAILED';\n        if (error.category == shaka.util.Error.Category.PLAYER &&\n            error.code == shaka.util.Error.Code.LOAD_INTERRUPTED) {\n          type = 'LOAD_CANCELLED';\n        }\n\n        this.sendMessage_({\n          'requestId': Number(message['requestId']),\n          'type': type\n        }, this.genericBus_);\n      }.bind(this));\n      break;\n    default:\n      shaka.log.warning(\n          'Unrecognized message type from the generic Chromecast controller!',\n          message['type']);\n      // Dispatch an error to the sender.\n      this.sendMessage_({\n        'requestId': Number(message['requestId']),\n        'type': 'INVALID_REQUEST',\n        'reason': 'INVALID_COMMAND'\n      }, this.genericBus_);\n      break;\n  }\n};\n\n\n/**\n * Tell the sender that the async operation is complete.\n * @param {string} senderId\n * @param {string} id\n * @param {shaka.util.Error} error\n * @private\n */\nshaka.cast.CastReceiver.prototype.sendAsyncComplete_ =\n    function(senderId, id, error) {\n  this.sendMessage_({\n    'type': 'asyncComplete',\n    'id': id,\n    'error': error\n  }, this.shakaBus_, senderId);\n};\n\n\n/**\n * Since this method is in the compiled library, make sure all messages passed\n * in here were created with quoted property names.\n * @param {!Object} message\n * @param {cast.receiver.CastMessageBus} bus\n * @param {string=} opt_senderId\n * @private\n */\nshaka.cast.CastReceiver.prototype.sendMessage_ =\n    function(message, bus, opt_senderId) {\n  // Cuts log spam when debugging the receiver UI in Chrome.\n  if (!this.isConnected_) return;\n\n  var serialized = shaka.cast.CastUtils.serialize(message);\n  if (opt_senderId) {\n    bus.getCastChannel(opt_senderId).send(serialized);\n  } else {\n    bus.broadcast(serialized);\n  }\n};\n\n\n/**\n * @return {string}\n * @private\n */\nshaka.cast.CastReceiver.prototype.getPlayState_ = function() {\n  var playState = shaka.cast.CastReceiver.PLAY_STATE;\n  if (this.isIdle_)\n    return playState.IDLE;\n  else if (this.player_.isBuffering())\n    return playState.BUFFERING;\n  else if (this.video_.paused)\n    return playState.PAUSED;\n  else\n    return playState.PLAYING;\n};\n\n\n/**\n * @param {number} requestId\n * @param {Object=} opt_media\n * @private\n */\nshaka.cast.CastReceiver.prototype.sendMediaStatus_ =\n    function(requestId, opt_media) {\n  var mediaStatus = {\n    // mediaSessionId is a unique ID for the playback of this specific session.\n    // It's used to identify a specific instance of a playback.\n    // We don't support multiple playbacks, so just return 0.\n    'mediaSessionId': 0,\n    'playbackRate': this.video_.playbackRate,\n    'playerState': this.getPlayState_(),\n    'currentTime': this.video_.currentTime,\n    // supportedMediaCommands is a sum of all the flags of commands that the\n    // player supports.\n    // The list of comands with respective flags is:\n    // 1 - Pause\n    // 2 - Seek\n    // 4 - Stream volume\n    // 8 - Stream mute\n    // 16 - Skip forward\n    // 32 - Skip backward\n    // We support pause, seek, volume and mute which gives a value of\n    // 1+2+4+8=15\n    'supportedMediaCommands': 15,\n    'volume': {\n      'level': this.video_.volume,\n      'muted': this.video_.muted\n    }\n  };\n\n  if (opt_media)\n    mediaStatus['media'] = opt_media;\n\n  var ret = {\n    'requestId': requestId,\n    'type': 'MEDIA_STATUS',\n    'status': [mediaStatus]\n  };\n\n  this.sendMessage_(ret, this.genericBus_);\n};\n\n\n/**\n * @enum {string}\n */\nshaka.cast.CastReceiver.PLAY_STATE = {\n  IDLE: 'IDLE',\n  PLAYING: 'PLAYING',\n  BUFFERING: 'BUFFERING',\n  PAUSED: 'PAUSED'\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/cast/cast_receiver.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.XmlUtils');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\n\n\n/**\n * @namespace shaka.util.XmlUtils\n * @summary A set of XML utility functions.\n */\n\n\n/**\n * Finds a child XML element.\n * @param {!Element} elem The parent XML element.\n * @param {string} name The child XML element's tag name.\n * @return {Element} The child XML element, or null if a child XML element does\n *   not exist with the given tag name OR if there exists more than one\n *   child XML element with the given tag name.\n */\nshaka.util.XmlUtils.findChild = function(elem, name) {\n  var children = shaka.util.XmlUtils.findChildren(elem, name);\n  if (children.length != 1)\n    return null;\n  return children[0];\n};\n\n\n/**\n * Finds child XML elements.\n * @param {!Element} elem The parent XML element.\n * @param {string} name The child XML element's tag name.\n * @return {!Array.<!Element>} The child XML elements.\n */\nshaka.util.XmlUtils.findChildren = function(elem, name) {\n  return Array.prototype.filter.call(elem.childNodes, function(child) {\n    goog.asserts.assert(\n        child.tagName != name || child instanceof Element,\n        'child element should be an Element');\n    return child.tagName == name;\n  });\n};\n\n\n/**\n * Gets the text contents of a node.\n * @param {!Element} elem The XML element.\n * @return {?string} The text contents, or null if there are none.\n */\nshaka.util.XmlUtils.getContents = function(elem) {\n  var contents = elem.firstChild;\n\n  // check content\n  if (!contents || contents.nodeType != Node.TEXT_NODE)\n    return null;\n\n  // read merged text content from all text nodes (fixes MSIE 11 bug)\n  return elem.textContent.trim();\n};\n\n\n/**\n * Parses an attribute by its name.\n * @param {!Element} elem The XML element.\n * @param {string} name The attribute name.\n * @param {function(string): (T|null)} parseFunction A function that parses\n *   the attribute.\n * @param {(T|null)=} opt_defaultValue The attribute's default value, if not\n *   specified, the attibute's default value is null.\n * @return {(T|null)} The parsed attribute on success, or the attribute's\n *   default value if the attribute does not exist or could not be parsed.\n * @template T\n */\nshaka.util.XmlUtils.parseAttr = function(\n    elem, name, parseFunction, opt_defaultValue) {\n  var parsedValue = null;\n\n  var value = elem.getAttribute(name);\n  if (value != null)\n    parsedValue = parseFunction(value);\n\n  if (parsedValue == null)\n    return opt_defaultValue != undefined ? opt_defaultValue : null;\n\n  return parsedValue;\n};\n\n\n/**\n * Parses an XML date string.\n * @param {string} dateString\n * @return {?number} The parsed date in seconds on success; otherwise, return\n *   null.\n */\nshaka.util.XmlUtils.parseDate = function(dateString) {\n  if (!dateString)\n    return null;\n\n  var result = Date.parse(dateString);\n  return (!isNaN(result) ? Math.floor(result / 1000.0) : null);\n};\n\n\n/**\n * Parses an XML duration string.\n * Negative values are not supported. Years and months are treated as exactly\n * 365 and 30 days respectively.\n * @param {string} durationString The duration string, e.g., \"PT1H3M43.2S\",\n *   which means 1 hour, 3 minutes, and 43.2 seconds.\n * @return {?number} The parsed duration in seconds on success; otherwise,\n *   return null.\n * @see {@link http://www.datypic.com/sc/xsd/t-xsd_duration.html}\n */\nshaka.util.XmlUtils.parseDuration = function(durationString) {\n  if (!durationString)\n    return null;\n\n  var re = '^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?' +\n           '(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$';\n  var matches = new RegExp(re).exec(durationString);\n\n  if (!matches) {\n    shaka.log.warning('Invalid duration string:', durationString);\n    return null;\n  }\n\n  // Note: Number(null) == 0 but Number(undefined) == NaN.\n  var years = Number(matches[1] || null);\n  var months = Number(matches[2] || null);\n  var days = Number(matches[3] || null);\n  var hours = Number(matches[4] || null);\n  var minutes = Number(matches[5] || null);\n  var seconds = Number(matches[6] || null);\n\n  // Assume a year always has 365 days and a month always has 30 days.\n  var d = (60 * 60 * 24 * 365) * years +\n          (60 * 60 * 24 * 30) * months +\n          (60 * 60 * 24) * days +\n          (60 * 60) * hours +\n          60 * minutes +\n          seconds;\n  return isFinite(d) ? d : null;\n};\n\n\n/**\n * Parses a range string.\n * @param {string} rangeString The range string, e.g., \"101-9213\".\n * @return {?{start: number, end: number}} The parsed range on success;\n *   otherwise, return null.\n */\nshaka.util.XmlUtils.parseRange = function(rangeString) {\n  var matches = /([0-9]+)-([0-9]+)/.exec(rangeString);\n\n  if (!matches)\n    return null;\n\n  var start = Number(matches[1]);\n  if (!isFinite(start))\n    return null;\n\n  var end = Number(matches[2]);\n  if (!isFinite(end))\n    return null;\n\n  return {start: start, end: end};\n};\n\n\n/**\n * Parses an integer.\n * @param {string} intString The integer string.\n * @return {?number} The parsed integer on success; otherwise, return null.\n */\nshaka.util.XmlUtils.parseInt = function(intString) {\n  var n = Number(intString);\n  return (n % 1 === 0) ? n : null;\n};\n\n\n/**\n * Parses a positive integer.\n * @param {string} intString The integer string.\n * @return {?number} The parsed positive integer on success; otherwise,\n *   return null.\n */\nshaka.util.XmlUtils.parsePositiveInt = function(intString) {\n  var n = Number(intString);\n  return (n % 1 === 0) && (n > 0) ? n : null;\n};\n\n\n/**\n * Parses a non-negative integer.\n * @param {string} intString The integer string.\n * @return {?number} The parsed non-negative integer on success; otherwise,\n *   return null.\n */\nshaka.util.XmlUtils.parseNonNegativeInt = function(intString) {\n  var n = Number(intString);\n  return (n % 1 === 0) && (n >= 0) ? n : null;\n};\n\n\n/**\n * Parses a floating point number.\n * @param {string} floatString The floating point number string.\n * @return {?number} The parsed floating point number on success; otherwise,\n *   return null. May return -Infinity or Infinity.\n */\nshaka.util.XmlUtils.parseFloat = function(floatString) {\n  var n = Number(floatString);\n  return !isNaN(n) ? n : null;\n};\n\n\n/**\n * Evaluate a division expressed as a string\n * @param {string} exprString\n *   The expression to evaluate, e.g. \"200/2\". Can also be a single number\n * @return {?number} The evaluated expression as floating point number on\n *   success; otherwise return null.\n */\nshaka.util.XmlUtils.evalDivision = function(exprString) {\n  var res;\n  var n;\n  if (res = exprString.match(/^(\\d+)\\/(\\d+)$/)) {\n    n = Number(res[1] / res[2]);\n  } else {\n    n = Number(exprString);\n  }\n  return !isNaN(n) ? n : null;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/xml_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.dash.ContentProtection');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.MapUtils');\ngoog.require('shaka.util.Uint8ArrayUtils');\ngoog.require('shaka.util.XmlUtils');\n\n\n/**\n * @namespace shaka.dash.ContentProtection\n * @summary A set of functions for parsing and interpreting ContentProtection\n *   elements.\n */\n\n\n/**\n * @typedef {{\n *   defaultKeyId: ?string,\n *   defaultInit: Array.<shakaExtern.InitDataOverride>,\n *   drmInfos: !Array.<shakaExtern.DrmInfo>,\n *   firstRepresentation: boolean\n * }}\n *\n * @description\n * Contains information about the ContentProtection elements found at the\n * AdaptationSet level.\n *\n * @property {?string} defaultKeyId\n *   The default key ID to use.  This is used by parseKeyIds as a default.  This\n *   can be null to indicate that there is no default.\n * @property {Array.<shakaExtern.InitDataOverride>} defaultInit\n *   The default init data override.  This can be null to indicate that there\n *   is no default.\n * @property {!Array.<shakaExtern.DrmInfo>} drmInfos\n *   The DrmInfo objects.\n * @property {boolean} firstRepresentation\n *   True when first parsed; changed to false after the first call to\n *   parseKeyIds.  This is used to determine if a dummy key-system should be\n *   overwritten; namely that the first representation can replace the dummy\n *   from the AdaptationSet.\n */\nshaka.dash.ContentProtection.Context;\n\n\n/**\n * @typedef {{\n *   node: !Element,\n *   schemeUri: string,\n *   keyId: ?string,\n *   init: Array.<shakaExtern.InitDataOverride>\n * }}\n *\n * @description\n * The parsed result of a single ContentProtection element.\n *\n * @property {!Element} node\n *   The ContentProtection XML element.\n * @property {string} schemeUri\n *   The scheme URI.\n * @property {?string} keyId\n *   The default key ID, if present.\n * @property {Array.<shakaExtern.InitDataOverride>} init\n *   The init data, if present.  If there is no init data, it will be null.  If\n *   this is non-null, there is at least one element.\n */\nshaka.dash.ContentProtection.Element;\n\n\n/**\n * A map of scheme URI to key system name.\n *\n * @const {!Object.<string, string>}\n * @private\n */\nshaka.dash.ContentProtection.defaultKeySystems_ = {\n  'urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b': 'org.w3.clearkey',\n  'urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed': 'com.widevine.alpha',\n  'urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95': 'com.microsoft.playready',\n  'urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb': 'com.adobe.primetime'\n};\n\n\n/**\n * @const {string}\n * @private\n */\nshaka.dash.ContentProtection.MP4Protection_ =\n    'urn:mpeg:dash:mp4protection:2011';\n\n\n/**\n * Parses info from the ContentProtection elements at the AdaptationSet level.\n *\n * @param {!Array.<!Element>} elems\n * @param {shakaExtern.DashContentProtectionCallback} callback\n * @param {boolean} ignoreDrmInfo\n * @return {shaka.dash.ContentProtection.Context}\n */\nshaka.dash.ContentProtection.parseFromAdaptationSet = function(\n    elems, callback, ignoreDrmInfo) {\n  var ContentProtection = shaka.dash.ContentProtection;\n  var Functional = shaka.util.Functional;\n  var MapUtils = shaka.util.MapUtils;\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n  var parsed = ContentProtection.parseElements_(elems);\n  /** @type {Array.<shakaExtern.InitDataOverride>} */\n  var defaultInit = null;\n  /** @type {?string} */\n  var defaultKeyId = null;\n  /** @type {!Array.<shakaExtern.DrmInfo>} */\n  var drmInfos = [];\n  var parsedNonCenc = [];\n\n  // Get the default key ID; if there are multiple, they must all match.\n  var keyIds = parsed.map(function(elem) { return elem.keyId; })\n    .filter(Functional.isNotNull);\n  if (keyIds.length > 0) {\n    defaultKeyId = keyIds[0];\n    if (keyIds.some(Functional.isNotEqualFunc(defaultKeyId))) {\n      throw new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.MANIFEST,\n          shaka.util.Error.Code.DASH_CONFLICTING_KEY_IDS);\n    }\n  }\n\n  if (!ignoreDrmInfo) {\n    // Find the default key ID and init data.  Create a new array of all the\n    // non-CENC elements.\n    parsedNonCenc = parsed.filter(function(elem) {\n      if (elem.schemeUri == ContentProtection.MP4Protection_) {\n        goog.asserts.assert(!elem.init || elem.init.length,\n                            'Init data must be null or non-empty.');\n        defaultInit = elem.init || defaultInit;\n        return false;\n      } else {\n        return true;\n      }\n    });\n\n    if (parsedNonCenc.length > 0) {\n      drmInfos = ContentProtection.convertElements_(\n          defaultInit, callback, parsedNonCenc);\n\n      // If there are no drmInfos after parsing, then add a dummy entry.\n      // This may be removed in parseKeyIds.\n      if (drmInfos.length == 0) {\n        drmInfos = [ManifestParserUtils.createDrmInfo('', defaultInit)];\n      }\n    }\n  }\n\n  // If there are only CENC element(s) or ignoreDrmInfo flag is set, assume all\n  // key-systems are supported.\n  if (parsed.length > 0 && (ignoreDrmInfo || !parsedNonCenc.length)) {\n    var keySystems = ContentProtection.defaultKeySystems_;\n    drmInfos =\n        MapUtils.values(keySystems)\n            .map(function(keySystem) {\n              return ManifestParserUtils.createDrmInfo(keySystem, defaultInit);\n            });\n  }\n\n  // attach the default keyId, if it exists, to every initData\n  if (defaultKeyId) {\n    drmInfos.forEach(function(drmInfo) {\n      drmInfo.initData.forEach(function(initData) {\n        initData.keyId = defaultKeyId;\n      });\n    });\n  }\n\n  return {\n    defaultKeyId: defaultKeyId,\n    defaultInit: defaultInit,\n    drmInfos: drmInfos,\n    firstRepresentation: true\n  };\n};\n\n\n/**\n * Parses the given ContentProtection elements found at the Representation\n * level.  This may update the |context|.\n *\n * @param {!Array.<!Element>} elems\n * @param {shakaExtern.DashContentProtectionCallback} callback\n * @param {shaka.dash.ContentProtection.Context} context\n * @param {boolean} ignoreDrmInfo\n * @return {?string} The parsed key ID\n */\nshaka.dash.ContentProtection.parseFromRepresentation = function(\n    elems, callback, context, ignoreDrmInfo) {\n  var ContentProtection = shaka.dash.ContentProtection;\n  var repContext = ContentProtection.parseFromAdaptationSet(\n      elems, callback, ignoreDrmInfo);\n\n  if (context.firstRepresentation) {\n    var asUnknown = context.drmInfos.length == 1 &&\n        !context.drmInfos[0].keySystem;\n    var asUnencrypted = context.drmInfos.length == 0;\n    var repUnencrypted = repContext.drmInfos.length == 0;\n\n    // There are two cases when we need to replace the |drmInfos| in the context\n    // with those in the Representation:\n    // * The AdaptationSet does not list any ContentProtection.\n    // * The AdaptationSet only lists unknown key-systems.\n    if (asUnencrypted || (asUnknown && !repUnencrypted)) {\n      context.drmInfos = repContext.drmInfos;\n    }\n    context.firstRepresentation = false;\n  } else if (repContext.drmInfos.length > 0) {\n    // If this is not the first Representation, then we need to remove entries\n    // from the context that do not appear in this Representation.\n    context.drmInfos = context.drmInfos.filter(function(asInfo) {\n      return repContext.drmInfos.some(function(repInfo) {\n        return repInfo.keySystem == asInfo.keySystem;\n      });\n    });\n    // If we have filtered out all key-systems, throw an error.\n    if (context.drmInfos.length == 0) {\n      throw new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.MANIFEST,\n          shaka.util.Error.Code.DASH_NO_COMMON_KEY_SYSTEM);\n    }\n  }\n\n  return repContext.defaultKeyId || context.defaultKeyId;\n};\n\n\n/**\n * Creates DrmInfo objects from the given element.\n *\n * @param {Array.<shakaExtern.InitDataOverride>} defaultInit\n * @param {shakaExtern.DashContentProtectionCallback} callback\n * @param {!Array.<shaka.dash.ContentProtection.Element>} elements\n * @return {!Array.<shakaExtern.DrmInfo>}\n * @private\n */\nshaka.dash.ContentProtection.convertElements_ = function(\n    defaultInit, callback, elements) {\n  var Functional = shaka.util.Functional;\n  return elements.map(\n      /**\n       * @param {shaka.dash.ContentProtection.Element} element\n       * @return {!Array.<shakaExtern.DrmInfo>}\n       */\n      function(element) {\n        var ManifestParserUtils = shaka.util.ManifestParserUtils;\n        var ContentProtection = shaka.dash.ContentProtection;\n        var keySystem = ContentProtection.defaultKeySystems_[element.schemeUri];\n        if (keySystem) {\n          goog.asserts.assert(!element.init || element.init.length,\n                              'Init data must be null or non-empty.');\n          var initData = element.init || defaultInit;\n          return [ManifestParserUtils.createDrmInfo(keySystem, initData)];\n        } else {\n          goog.asserts.assert(\n              callback, 'ContentProtection callback is required');\n          return callback(element.node) || [];\n        }\n      }).reduce(Functional.collapseArrays, []);\n};\n\n\n/**\n * Parses the given ContentProtection elements.  If there is an error, it\n * removes those elements.\n *\n * @param {!Array.<!Element>} elems\n * @return {!Array.<shaka.dash.ContentProtection.Element>}\n * @private\n */\nshaka.dash.ContentProtection.parseElements_ = function(elems) {\n  var Functional = shaka.util.Functional;\n  return elems.map(\n      /**\n       * @param {!Element} elem\n       * @return {?shaka.dash.ContentProtection.Element}\n       */\n      function(elem) {\n        /** @type {?string} */\n        var schemeUri = elem.getAttribute('schemeIdUri');\n        /** @type {?string} */\n        var keyId = elem.getAttribute('cenc:default_KID');\n        /** @type {!Array.<string>} */\n        var psshs = shaka.util.XmlUtils.findChildren(elem, 'cenc:pssh')\n                        .map(shaka.util.XmlUtils.getContents);\n\n        if (!schemeUri) {\n          shaka.log.error('Missing required schemeIdUri attribute on',\n                          'ContentProtection element', elem);\n          return null;\n        }\n\n        schemeUri = schemeUri.toLowerCase();\n        if (keyId) {\n          keyId = keyId.replace(/-/g, '').toLowerCase();\n          if (keyId.indexOf(' ') >= 0) {\n            throw new shaka.util.Error(\n                shaka.util.Error.Severity.CRITICAL,\n                shaka.util.Error.Category.MANIFEST,\n                shaka.util.Error.Code.DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED);\n          }\n        }\n\n        /** @type {!Array.<shakaExtern.InitDataOverride>} */\n        var init = [];\n        try {\n          init = psshs.map(function(pssh) {\n            /** @type {shakaExtern.InitDataOverride} */\n            var ret = {\n              initDataType: 'cenc',\n              initData: shaka.util.Uint8ArrayUtils.fromBase64(pssh),\n              keyId: null\n            };\n            return ret;\n          });\n        } catch (e) {\n          throw new shaka.util.Error(\n              shaka.util.Error.Severity.CRITICAL,\n              shaka.util.Error.Category.MANIFEST,\n              shaka.util.Error.Code.DASH_PSSH_BAD_ENCODING);\n        }\n\n        /** @type {shaka.dash.ContentProtection.Element} */\n        var element = {\n          node: elem,\n          schemeUri: schemeUri,\n          keyId: keyId,\n          init: (init.length > 0 ? init : null)\n        };\n        return element;\n      }).filter(Functional.isNotNull);\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/dash/content_protection.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.dash.MpdUtils');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.XmlUtils');\n\n\n/**\n * @namespace shaka.dash.MpdUtils\n * @summary MPD processing utility functions.\n */\n\n\n/**\n * @typedef {{\n *   start: number,\n *   unscaledStart: number,\n *   end: number\n * }}\n *\n * @description\n * Defines a time range of a media segment.  Times are in seconds.\n *\n * @property {number} start\n *   The start time of the range.\n * @property {number} unscaledStart\n *   The start time of the range in representation timescale units.\n * @property {number} end\n *   The end time (exclusive) of the range.\n */\nshaka.dash.MpdUtils.TimeRange;\n\n\n/**\n * @typedef {{\n *   timescale: number,\n *   segmentDuration: ?number,\n *   startNumber: number,\n *   presentationTimeOffset: number,\n *   unscaledPresentationTimeOffset: number,\n *   timeline: Array.<shaka.dash.MpdUtils.TimeRange>\n * }}\n *\n * @description\n * Contains common information between SegmentList and SegmentTemplate items.\n *\n * @property {number} timescale\n *   The time-scale of the representation.\n * @property {?number} segmentDuration\n *   The duration of the segments in seconds, if given.\n * @property {number} startNumber\n *   The start number of the segments; 1 or greater.\n * @property {number} presentationTimeOffset\n *   The presentationTimeOffset of the representation, in seconds.\n * @property {number} unscaledPresentationTimeOffset\n *   The presentationTimeOffset of the representation, in timescale units.\n * @property {Array.<shaka.dash.MpdUtils.TimeRange>} timeline\n *   The timeline of the representation, if given.  Times in seconds.\n */\nshaka.dash.MpdUtils.SegmentInfo;\n\n\n/**\n * Fills a SegmentTemplate URI template. This function does not validate the\n * resulting URI.\n *\n * @param {string} uriTemplate\n * @param {?string} representationId\n * @param {?number} number\n * @param {?number} bandwidth\n * @param {?number} time\n * @return {string} A URI string.\n * @see ISO/IEC 23009-1:2014 section 5.3.9.4.4\n */\nshaka.dash.MpdUtils.fillUriTemplate = function(\n    uriTemplate, representationId, number, bandwidth, time) {\n  if (time != null) {\n    goog.asserts.assert(Math.abs(time - Math.round(time)) < 0.2,\n                        'Calculated $Time$ values must be close to integers!');\n    time = Math.round(time);\n  }\n\n  /** @type {!Object.<string, ?number|?string>} */\n  var valueTable = {\n    'RepresentationID': representationId,\n    'Number': number,\n    'Bandwidth': bandwidth,\n    'Time': time\n  };\n\n  var re = /\\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\\$/g;\n  var uri = uriTemplate.replace(re, function(match, name, widthString) {\n    if (match == '$$') {\n      return '$';\n    }\n\n    var value = valueTable[name];\n    goog.asserts.assert(value !== undefined, 'Unrecognized identifier');\n\n    // Note that |value| may be 0 or ''.\n    if (value == null) {\n      shaka.log.warning(\n          'URL template does not have an available substitution for identifier',\n          '\"' + name + '\":',\n          uriTemplate);\n      return match;\n    }\n\n    if (name == 'RepresentationID' && widthString) {\n      shaka.log.warning(\n          'URL template should not contain a width specifier for identifier',\n          '\"RepresentationID\":',\n          uriTemplate);\n      widthString = undefined;\n    }\n\n    var valueString = value.toString();\n\n    // Create padding string.\n    var width = window.parseInt(widthString, 10) || 1;\n    var paddingSize = Math.max(0, width - valueString.length);\n    var padding = (new Array(paddingSize + 1)).join('0');\n\n    return padding + valueString;\n  });\n\n  return uri;\n};\n\n\n/**\n * Expands a SegmentTimeline into an array-based timeline.  The results are in\n * seconds.\n *\n * @param {!Element} segmentTimeline\n * @param {number} timescale\n * @param {number} presentationTimeOffset\n * @param {number} periodDuration The Period's duration in seconds.\n *   Infinity indicates that the Period continues indefinitely.\n * @return {!Array.<shaka.dash.MpdUtils.TimeRange>}\n */\nshaka.dash.MpdUtils.createTimeline = function(\n    segmentTimeline, timescale, presentationTimeOffset, periodDuration) {\n  goog.asserts.assert(\n      timescale > 0 && timescale < Infinity,\n      'timescale must be a positive, finite integer');\n  goog.asserts.assert(periodDuration > 0,\n                      'period duration must be a positive integer');\n\n  // Alias.\n  var XmlUtils = shaka.util.XmlUtils;\n\n  var timePoints = XmlUtils.findChildren(segmentTimeline, 'S');\n\n  /** @type {!Array.<shaka.dash.MpdUtils.TimeRange>} */\n  var timeline = [];\n  var lastEndTime = 0;\n\n  for (var i = 0; i < timePoints.length; ++i) {\n    var timePoint = timePoints[i];\n    var t = XmlUtils.parseAttr(timePoint, 't', XmlUtils.parseNonNegativeInt);\n    var d = XmlUtils.parseAttr(timePoint, 'd', XmlUtils.parseNonNegativeInt);\n    var r = XmlUtils.parseAttr(timePoint, 'r', XmlUtils.parseInt);\n\n    // Adjust start considering the presentation time offset\n    if (t != null)\n      t -= presentationTimeOffset;\n\n    if (!d) {\n      shaka.log.warning(\n          '\"S\" element must have a duration:',\n          'ignoring the remaining \"S\" elements.',\n          timePoint);\n      return timeline;\n    }\n\n    var startTime = t != null ? t : lastEndTime;\n\n    var repeat = r || 0;\n    if (repeat < 0) {\n      if (i + 1 < timePoints.length) {\n        var nextTimePoint = timePoints[i + 1];\n        var nextStartTime = XmlUtils.parseAttr(\n            nextTimePoint, 't', XmlUtils.parseNonNegativeInt);\n        if (nextStartTime == null) {\n          shaka.log.warning(\n              '\"S\" element cannot have a negative repeat',\n              'if the next \"S\" element does not have a valid start time:',\n              'ignoring the remaining \"S\" elements.',\n              timePoint);\n          return timeline;\n        } else if (startTime >= nextStartTime) {\n          shaka.log.warning(\n              '\"S\" element cannot have a negative repeat',\n              'if its start time exceeds the next \"S\" element\\'s start time:',\n              'ignoring the remaining \"S\" elements.',\n              timePoint);\n          return timeline;\n        }\n        repeat = Math.ceil((nextStartTime - startTime) / d) - 1;\n      } else {\n        if (periodDuration == Infinity) {\n          // The DASH spec. actually allows the last \"S\" element to have a\n          // negative repeat value even when the Period has an infinite\n          // duration. No one uses this feature and no one ever should, ever.\n          shaka.log.warning(\n              'The last \"S\" element cannot have a negative repeat',\n              'if the Period has an infinite duration:',\n              'ignoring the last \"S\" element.',\n              timePoint);\n          return timeline;\n        } else if (startTime / timescale >= periodDuration) {\n          shaka.log.warning(\n              'The last \"S\" element cannot have a negative repeat',\n              'if its start time exceeds the Period\\'s duration:',\n              'igoring the last \"S\" element.',\n              timePoint);\n          return timeline;\n        }\n        repeat = Math.ceil((periodDuration * timescale - startTime) / d) - 1;\n      }\n    }\n\n    // The end of the last segment may end before the start of the current\n    // segment (a gap) or may end after the start of the current segment (an\n    // overlap). If there is a gap/overlap then stretch/compress the end of\n    // the last segment to the start of the current segment.\n    //\n    // Note: it is possible to move the start of the current segment to the\n    // end of the last segment, but this would complicate the computation of\n    // the $Time$ placeholder later on.\n    if ((timeline.length > 0) && (startTime != lastEndTime)) {\n      var delta = startTime - lastEndTime;\n\n      if (Math.abs(delta / timescale) >=\n          shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS) {\n        shaka.log.warning(\n            'SegmentTimeline contains a large gap/overlap:',\n            'the content may have errors in it.',\n            timePoint);\n      }\n\n      timeline[timeline.length - 1].end = startTime / timescale;\n    }\n\n    for (var j = 0; j <= repeat; ++j) {\n      var endTime = startTime + d;\n      var item = {\n        start: startTime / timescale,\n        end: endTime / timescale,\n        unscaledStart: startTime\n      };\n      timeline.push(item);\n\n      startTime = endTime;\n      lastEndTime = endTime;\n    }\n  }\n\n  return timeline;\n};\n\n\n/**\n * Parses common segment info for SegmentList and SegmentTemplate.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {function(?shaka.dash.DashParser.InheritanceFrame):Element} callback\n *   Gets the element that contains the segment info.\n * @return {shaka.dash.MpdUtils.SegmentInfo}\n */\nshaka.dash.MpdUtils.parseSegmentInfo = function(context, callback) {\n  goog.asserts.assert(\n      callback(context.representation),\n      'There must be at least one element of the given type.');\n  var MpdUtils = shaka.dash.MpdUtils;\n  var XmlUtils = shaka.util.XmlUtils;\n\n  var timescaleStr = MpdUtils.inheritAttribute(context, callback, 'timescale');\n  var timescale = 1;\n  if (timescaleStr) {\n    timescale = XmlUtils.parsePositiveInt(timescaleStr) || 1;\n  }\n\n  var durationStr = MpdUtils.inheritAttribute(context, callback, 'duration');\n  var segmentDuration = XmlUtils.parsePositiveInt(durationStr || '');\n  if (segmentDuration) {\n    segmentDuration /= timescale;\n  }\n\n  var startNumberStr =\n      MpdUtils.inheritAttribute(context, callback, 'startNumber');\n  var presentationTimeOffset =\n      MpdUtils.inheritAttribute(context, callback, 'presentationTimeOffset');\n  var startNumber = XmlUtils.parseNonNegativeInt(startNumberStr || '');\n  if (startNumberStr == null || startNumber == null)\n    startNumber = 1;\n\n  var timelineNode =\n      MpdUtils.inheritChild(context, callback, 'SegmentTimeline');\n  /** @type {Array.<shaka.dash.MpdUtils.TimeRange>} */\n  var timeline = null;\n  if (timelineNode) {\n    timeline = MpdUtils.createTimeline(\n        timelineNode, timescale, Number(presentationTimeOffset),\n        context.periodInfo.duration || Infinity);\n  }\n\n  var pto = (Number(presentationTimeOffset) / timescale) || 0;\n  return {\n    timescale: timescale,\n    segmentDuration: segmentDuration,\n    startNumber: startNumber,\n    presentationTimeOffset: pto,\n    unscaledPresentationTimeOffset: Number(presentationTimeOffset),\n    timeline: timeline\n  };\n};\n\n\n/**\n * Searches the inheritance for a Segment* with the given attribute.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {function(?shaka.dash.DashParser.InheritanceFrame):Element} callback\n *   Gets the Element that contains the attribute to inherit.\n * @param {string} attribute\n * @return {?string}\n */\nshaka.dash.MpdUtils.inheritAttribute = function(context, callback, attribute) {\n  var Functional = shaka.util.Functional;\n  goog.asserts.assert(\n      callback(context.representation),\n      'There must be at least one element of the given type');\n\n  /** @type {!Array.<!Element>} */\n  var nodes = [\n    callback(context.representation),\n    callback(context.adaptationSet),\n    callback(context.period)\n  ].filter(Functional.isNotNull);\n\n  return nodes\n      .map(function(s) { return s.getAttribute(attribute); })\n      .reduce(function(all, part) { return all || part; });\n};\n\n\n/**\n * Searches the inheritance for a Segment* with the given child.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {function(?shaka.dash.DashParser.InheritanceFrame):Element} callback\n *   Gets the Element that contains the child to inherit.\n * @param {string} child\n * @return {Element}\n */\nshaka.dash.MpdUtils.inheritChild = function(context, callback, child) {\n  var Functional = shaka.util.Functional;\n  goog.asserts.assert(\n      callback(context.representation),\n      'There must be at least one element of the given type');\n\n  /** @type {!Array.<!Element>} */\n  var nodes = [\n    callback(context.representation),\n    callback(context.adaptationSet),\n    callback(context.period)\n  ].filter(Functional.isNotNull);\n\n  var XmlUtils = shaka.util.XmlUtils;\n  return nodes\n      .map(function(s) { return XmlUtils.findChild(s, child); })\n      .reduce(function(all, part) { return all || part; });\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/dash/mpd_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.InitSegmentReference');\ngoog.provide('shaka.media.SegmentReference');\n\ngoog.require('goog.asserts');\n\n\n\n/**\n * Creates an InitSegmentReference, which provides the location to an\n * initialization segment.\n *\n * @param {function():!Array.<string>} uris\n *   A function that creates the URIs of the resource containing the segment.\n * @param {number} startByte The offset from the start of the resource to the\n *   start of the segment.\n * @param {?number} endByte The offset from the start of the resource to the\n *   end of the segment, inclusive. null indicates that the segment extends\n *   to the end of the resource.\n *\n * @constructor\n * @struct\n * @export\n */\nshaka.media.InitSegmentReference = function(uris, startByte, endByte) {\n  /** @type {function():!Array.<string>} */\n  this.getUris = uris;\n\n  /** @const {number} */\n  this.startByte = startByte;\n\n  /** @const {?number} */\n  this.endByte = endByte;\n};\n\n\n\n/**\n * Creates a SegmentReference, which provides the start time, end time, and\n * location to a media segment.\n *\n * @param {number} position The segment's position within a particular Period.\n *   The following should hold true between any two SegmentReferences from the\n *   same Period, r1 and r2:\n *   IF r2.position > r1.position THEN\n *     [ (r2.startTime > r1.startTime) OR\n *       (r2.startTime == r1.startTime AND r2.endTime >= r1.endTime) ]\n * @param {number} startTime The segment's start time in seconds, relative to\n *   the start of a particular Period.\n * @param {number} endTime The segment's end time in seconds, relative to\n *   the start of a particular Period. The segment ends the instant before\n *   this time, so |endTime| must be strictly greater than |startTime|.\n * @param {function():!Array.<string>} uris\n *   A function that creates the URIs of the resource containing the segment.\n * @param {number} startByte The offset from the start of the resource to the\n *   start of the segment.\n * @param {?number} endByte The offset from the start of the resource to the\n *   end of the segment, inclusive. null indicates that the segment extends\n *   to the end of the resource.\n *\n * @constructor\n * @struct\n * @export\n */\nshaka.media.SegmentReference = function(\n    position, startTime, endTime, uris, startByte, endByte) {\n  goog.asserts.assert(startTime < endTime,\n                      'startTime must be less than endTime');\n  goog.asserts.assert((startByte < endByte) || (endByte == null),\n                      'startByte must be < endByte');\n  /** @const {number} */\n  this.position = position;\n\n  /** @const {number} */\n  this.startTime = startTime;\n\n  /** @const {number} */\n  this.endTime = endTime;\n\n  /** @type {function():!Array.<string>} */\n  this.getUris = uris;\n\n  /** @const {number} */\n  this.startByte = startByte;\n\n  /** @const {?number} */\n  this.endByte = endByte;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/segment_reference.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.DataViewReader');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.StringUtils');\n\n\n\n/**\n * Creates a DataViewReader, which abstracts a DataView object.\n *\n * @param {!DataView} dataView The DataView.\n * @param {shaka.util.DataViewReader.Endianness} endianness The endianness.\n *\n * @struct\n * @constructor\n * @export\n */\nshaka.util.DataViewReader = function(dataView, endianness) {\n  /** @private {!DataView} */\n  this.dataView_ = dataView;\n\n  /** @private {boolean} */\n  this.littleEndian_ =\n      endianness == shaka.util.DataViewReader.Endianness.LITTLE_ENDIAN;\n\n  /** @private {number} */\n  this.position_ = 0;\n};\n\n\n/**\n * Endianness.\n * @enum {number}\n * @export\n */\nshaka.util.DataViewReader.Endianness = {\n  BIG_ENDIAN: 0,\n  LITTLE_ENDIAN: 1\n};\n\n\n/**\n * @return {boolean} True if the reader has more data, false otherwise.\n * @export\n */\nshaka.util.DataViewReader.prototype.hasMoreData = function() {\n  return this.position_ < this.dataView_.byteLength;\n};\n\n\n/**\n * Gets the current byte position.\n * @return {number}\n * @export\n */\nshaka.util.DataViewReader.prototype.getPosition = function() {\n  return this.position_;\n};\n\n\n/**\n * Gets the byte length of the DataView.\n * @return {number}\n * @export\n */\nshaka.util.DataViewReader.prototype.getLength = function() {\n  return this.dataView_.byteLength;\n};\n\n\n/**\n * Reads an unsigned 8 bit integer, and advances the reader.\n * @return {number} The integer.\n * @throws {shaka.util.Error} when reading past the end of the data view.\n * @export\n */\nshaka.util.DataViewReader.prototype.readUint8 = function() {\n  try {\n    var value = this.dataView_.getUint8(this.position_);\n  } catch (exception) {\n    this.throwOutOfBounds_();\n  }\n  this.position_ += 1;\n  return value;\n};\n\n\n/**\n * Reads an unsigned 16 bit integer, and advances the reader.\n * @return {number} The integer.\n * @throws {shaka.util.Error} when reading past the end of the data view.\n * @export\n */\nshaka.util.DataViewReader.prototype.readUint16 = function() {\n  try {\n    var value = this.dataView_.getUint16(this.position_, this.littleEndian_);\n  } catch (exception) {\n    this.throwOutOfBounds_();\n  }\n  this.position_ += 2;\n  return value;\n};\n\n\n/**\n * Reads an unsigned 32 bit integer, and advances the reader.\n * @return {number} The integer.\n * @throws {shaka.util.Error} when reading past the end of the data view.\n * @export\n */\nshaka.util.DataViewReader.prototype.readUint32 = function() {\n  try {\n    var value = this.dataView_.getUint32(this.position_, this.littleEndian_);\n  } catch (exception) {\n    this.throwOutOfBounds_();\n  }\n  this.position_ += 4;\n  return value;\n};\n\n\n/**\n * Reads a signed 32 bit integer, and advances the reader.\n * @return {number} The integer.\n * @throws {shaka.util.Error} when reading past the end of the data view.\n * @export\n */\nshaka.util.DataViewReader.prototype.readInt32 = function() {\n  try {\n    var value = this.dataView_.getInt32(this.position_, this.littleEndian_);\n  } catch (exception) {\n    this.throwOutOfBounds_();\n  }\n  this.position_ += 4;\n  return value;\n};\n\n\n/**\n * Reads an unsigned 64 bit integer, and advances the reader.\n * @return {number} The integer.\n * @throws {shaka.util.Error} when reading past the end of the data view or\n *   when reading an integer too large to store accurately in JavaScript.\n * @export\n */\nshaka.util.DataViewReader.prototype.readUint64 = function() {\n  var low, high;\n\n  try {\n    if (this.littleEndian_) {\n      low = this.dataView_.getUint32(this.position_, true);\n      high = this.dataView_.getUint32(this.position_ + 4, true);\n    } else {\n      high = this.dataView_.getUint32(this.position_, false);\n      low = this.dataView_.getUint32(this.position_ + 4, false);\n    }\n  } catch (exception) {\n    this.throwOutOfBounds_();\n  }\n\n  if (high > 0x1FFFFF) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.JS_INTEGER_OVERFLOW);\n  }\n\n  this.position_ += 8;\n\n  // NOTE: This is subtle, but in JavaScript you can't shift left by 32 and get\n  // the full range of 53-bit values possible.  You must multiply by 2^32.\n  return (high * Math.pow(2, 32)) + low;\n};\n\n\n/**\n * Reads the specified number of raw bytes.\n * @param {number} bytes The number of bytes to read.\n * @return {!Uint8Array}\n * @throws {shaka.util.Error} when reading past the end of the data view.\n * @export\n */\nshaka.util.DataViewReader.prototype.readBytes = function(bytes) {\n  goog.asserts.assert(bytes > 0, 'Bad call to DataViewReader.readBytes');\n  if (this.position_ + bytes > this.dataView_.byteLength) {\n    this.throwOutOfBounds_();\n  }\n  var value = this.dataView_.buffer.slice(\n      this.position_, this.position_ + bytes);\n  this.position_ += bytes;\n  return new Uint8Array(value);\n};\n\n\n/**\n * Skips the specified number of bytes.\n * @param {number} bytes The number of bytes to skip.\n * @throws {shaka.util.Error} when skipping past the end of the data view.\n * @export\n */\nshaka.util.DataViewReader.prototype.skip = function(bytes) {\n  goog.asserts.assert(bytes >= 0, 'Bad call to DataViewReader.skip');\n  if (this.position_ + bytes > this.dataView_.byteLength) {\n    this.throwOutOfBounds_();\n  }\n  this.position_ += bytes;\n};\n\n\n/**\n * Keeps reading until it reaches a byte that equals to zero.  The text is\n * assumed to be UTF-8.\n * @return {string}\n * @export\n */\nshaka.util.DataViewReader.prototype.readTerminatedString = function() {\n  var start = this.position_;\n  while (this.hasMoreData()) {\n    var value = this.dataView_.getUint8(this.position_);\n    if (value == 0) break;\n    this.position_ += 1;\n  }\n\n  var ret = this.dataView_.buffer.slice(start, this.position_);\n  // skip string termination\n  this.position_ += 1;\n  return shaka.util.StringUtils.fromUTF8(ret);\n};\n\n\n/**\n * @throws {shaka.util.Error}\n * @private\n */\nshaka.util.DataViewReader.prototype.throwOutOfBounds_ = function() {\n  throw new shaka.util.Error(\n      shaka.util.Error.Severity.CRITICAL,\n      shaka.util.Error.Category.MEDIA,\n      shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/data_view_reader.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.Mp4Parser');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.util.DataViewReader');\n\n\n\n/**\n * Create a new MP4 Parser\n * @struct\n * @constructor\n * @export\n */\nshaka.util.Mp4Parser = function() {\n  /**\n   * @type {!Object.<number, shaka.util.Mp4Parser.BoxType_>}\n   * @private\n   */\n  this.headers_ = [];\n\n  /**\n   * @type {!Object.<number, !shaka.util.Mp4Parser.CallbackType>}\n   * @private\n   */\n  this.boxDefinitions_ = [];\n};\n\n\n/**\n * @typedef {{\n *    parser: !shaka.util.Mp4Parser,\n *    start: number,\n *    size: number,\n *    version: ?number,\n *    flags: ?number,\n *    reader: !shaka.util.DataViewReader\n * }}\n *\n * @property {!shaka.util.Mp4Parser} parser\n *    The parser that parsed this box. The parser can be used to parse child\n *    boxes where the configuration of the current parser is needed to parsed\n *    other boxes.\n * @property {number} start\n *    The start of this box (before the header) in the original buffer. This\n *    start position is the absolute position.\n * @property {number} size\n *    The size of this box (including the header).\n * @property {?number} version\n *    The version for a full box, null for basic boxes.\n * @property {?number} flags\n *    The flags for a full box, null for basic boxes.\n * @property {!shaka.util.DataViewReader} reader\n *    The reader for this box is only for this box. Reading or not reading to\n *    the end will have no affect on the parser reading other sibling boxes.\n * @exportInterface\n */\nshaka.util.Mp4Parser.ParsedBox;\n\n\n/**\n * @typedef {function(!shaka.util.Mp4Parser.ParsedBox)}\n * @exportInterface\n */\nshaka.util.Mp4Parser.CallbackType;\n\n\n/**\n * An enum used to track the type of box so that the correct values can be\n * read from the header.\n *\n * @enum {number}\n * @private\n */\nshaka.util.Mp4Parser.BoxType_ = {\n  BASIC_BOX: 0,\n  FULL_BOX: 1\n};\n\n\n/**\n * Delcare a box type as a Box.\n *\n * @param {string} type\n * @param {!shaka.util.Mp4Parser.CallbackType} definition\n * @return {!shaka.util.Mp4Parser}\n * @export\n */\nshaka.util.Mp4Parser.prototype.box = function(type, definition) {\n  var typeCode = shaka.util.Mp4Parser.typeFromString_(type);\n  this.headers_[typeCode] = shaka.util.Mp4Parser.BoxType_.BASIC_BOX;\n  this.boxDefinitions_[typeCode] = definition;\n  return this;\n};\n\n\n/**\n * Declare a box type as a Full Box.\n *\n * @param {string} type\n * @param {!shaka.util.Mp4Parser.CallbackType} definition\n * @return {!shaka.util.Mp4Parser}\n * @export\n */\nshaka.util.Mp4Parser.prototype.fullBox = function(type, definition) {\n  var typeCode = shaka.util.Mp4Parser.typeFromString_(type);\n  this.headers_[typeCode] = shaka.util.Mp4Parser.BoxType_.FULL_BOX;\n  this.boxDefinitions_[typeCode] = definition;\n  return this;\n};\n\n\n/**\n * Parse the given data using the added callbacks.\n *\n * @param {!ArrayBuffer} data\n * @export\n */\nshaka.util.Mp4Parser.prototype.parse = function(data) {\n  var reader = new shaka.util.DataViewReader(\n      new DataView(data),\n      shaka.util.DataViewReader.Endianness.BIG_ENDIAN);\n\n  while (reader.hasMoreData()) {\n    this.parseNext(0, reader);\n  }\n};\n\n\n/**\n * Parse the next box on the current level.\n *\n * @param {number} absStart The absolute start position in the original\n *    byte array\n * @param {!shaka.util.DataViewReader} reader\n * @export\n */\nshaka.util.Mp4Parser.prototype.parseNext = function(absStart, reader) {\n  var start = reader.getPosition();\n\n  var size = reader.readUint32();\n  var type = reader.readUint32();\n\n  switch (size) {\n    case 0:\n      size = reader.getLength() - start;\n      break;\n    case 1:\n      size = reader.readUint64();\n      break;\n  }\n\n  var boxDefinition = this.boxDefinitions_[type];\n\n  if (boxDefinition) {\n    var version = null;\n    var flags = null;\n\n    if (this.headers_[type] == shaka.util.Mp4Parser.BoxType_.FULL_BOX) {\n      var versionAndFlags = reader.readUint32();\n      version = versionAndFlags >>> 24;\n      flags = versionAndFlags & 0xFFFFFF;\n    }\n\n    // Read the whole payload so that the current level can be safely read\n    // regardless of how the payload is parsed.\n    var payloadSize = start + size - reader.getPosition();\n    var payload = (payloadSize > 0) ?\n                  reader.readBytes(payloadSize).buffer :\n                  new ArrayBuffer(0);\n\n    var payloadReader = new shaka.util.DataViewReader(\n        new DataView(payload),\n        shaka.util.DataViewReader.Endianness.BIG_ENDIAN);\n\n    /** @type {shaka.util.Mp4Parser.ParsedBox } */\n    var box = {\n      parser: this,\n      version: version,\n      flags: flags,\n      reader: payloadReader,\n      size: size,\n      start: start + absStart\n    };\n\n    boxDefinition(box);\n  } else {\n    // Move the read head to be at the end of the box.\n    reader.skip(start + size - reader.getPosition());\n  }\n};\n\n\n/**\n * A callback that tells the Mp4 parser to treat the body of a box as a series\n * of boxes. The number of boxes is limited by the size of the parent box.\n *\n * @param {!shaka.util.Mp4Parser.ParsedBox} box\n * @export\n */\nshaka.util.Mp4Parser.children = function(box) {\n  while (box.reader.hasMoreData()) {\n    box.parser.parseNext(box.start, box.reader);\n  }\n};\n\n\n/**\n * A callback that tells the Mp4 parser to treat the body of a box as a sample\n * description. A sample description box has a fixed number of children. The\n * number of children is represented by a 4 byte unsigned integer. Each child\n * is a box.\n *\n * @param {!shaka.util.Mp4Parser.ParsedBox} box\n * @export\n */\nshaka.util.Mp4Parser.sampleDescription = function(box) {\n  for (var count = box.reader.readUint32(); count > 0; count -= 1) {\n    box.parser.parseNext(box.start, box.reader);\n  }\n};\n\n\n/**\n * Create a callback that tells the Mp4 parser to treat the body of a box as a\n * binary blob and how to handle it.\n *\n * @param {!function(!Uint8Array)} callback\n * @return {!shaka.util.Mp4Parser.CallbackType}\n * @export\n */\nshaka.util.Mp4Parser.allData = function(callback) {\n  return function(box) {\n    var all = box.reader.getLength() - box.reader.getPosition();\n    callback(box.reader.readBytes(all));\n  };\n};\n\n\n/**\n * Convert an ascii string name to the integer type for a box.\n *\n * @param {string} name The name of the box. The name must be four\n *                      characters long.\n * @return {number}\n * @private\n */\nshaka.util.Mp4Parser.typeFromString_ = function(name) {\n  goog.asserts.assert(\n      name.length == 4,\n      'Mp4 box names must be 4 characters long');\n\n  var code = 0;\n  for (var i = 0; i < name.length; i++) {\n    code = (code << 8) | name.charCodeAt(i);\n  }\n  return code;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/mp4_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.Mp4SegmentIndexParser');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.SegmentReference');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Mp4Parser');\n\n\n/**\n * Parses SegmentReferences from an ISO BMFF SIDX structure.\n * @param {!ArrayBuffer} sidxData The MP4's container's SIDX.\n * @param {number} sidxOffset The SIDX's offset, in bytes, from the start of\n *   the MP4 container.\n * @param {!Array.<string>} uris The possible locations of the MP4 file that\n *   contains the segments.\n * @param {number} presentationTimeOffset\n * @return {!Array.<!shaka.media.SegmentReference>}\n * @throws {shaka.util.Error}\n */\nshaka.media.Mp4SegmentIndexParser = function(\n    sidxData, sidxOffset, uris, presentationTimeOffset) {\n\n  var Mp4SegmentIndexParser = shaka.media.Mp4SegmentIndexParser;\n\n  var references;\n\n  var parser = new shaka.util.Mp4Parser()\n      .fullBox('sidx', function(box) {\n        references = Mp4SegmentIndexParser.parseSIDX_(\n            sidxOffset,\n            presentationTimeOffset,\n            uris,\n            box);\n      });\n\n  if (sidxData) {\n    parser.parse(sidxData);\n  }\n\n  if (references) {\n    return references;\n  } else {\n    shaka.log.error('Invalid box type, expected \"sidx\".');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.MP4_SIDX_WRONG_BOX_TYPE);\n  }\n};\n\n\n/**\n * Parse a SIDX box from the given reader.\n *\n * @param {number} sidxOffset\n * @param {number} presentationTimeOffset\n * @param {!Array.<string>} uris The possible locations of the MP4 file that\n *   contains the segments.\n * @param {!shaka.util.Mp4Parser.ParsedBox} box\n * @return {!Array.<!shaka.media.SegmentReference>}\n * @private\n */\nshaka.media.Mp4SegmentIndexParser.parseSIDX_ = function(\n    sidxOffset,\n    presentationTimeOffset,\n    uris,\n    box) {\n\n  goog.asserts.assert(\n      box.version != null,\n      'SIDX is a full box and should have a valid version.');\n\n  var references = [];\n\n  // Parse the SIDX structure.\n  // Skip reference_ID (32 bits).\n  box.reader.skip(4);\n\n  var timescale = box.reader.readUint32();\n\n  if (timescale == 0) {\n    shaka.log.error('Invalid timescale.');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.MP4_SIDX_INVALID_TIMESCALE);\n  }\n\n  var earliestPresentationTime;\n  var firstOffset;\n\n  if (box.version == 0) {\n    earliestPresentationTime = box.reader.readUint32();\n    firstOffset = box.reader.readUint32();\n  } else {\n    earliestPresentationTime = box.reader.readUint64();\n    firstOffset = box.reader.readUint64();\n  }\n\n  // Skip reserved (16 bits).\n  box.reader.skip(2);\n\n  // Add references.\n  var referenceCount = box.reader.readUint16();\n\n  // Substract the presentationTimeOffset\n  var unscaledStartTime = earliestPresentationTime - presentationTimeOffset;\n  var startByte = sidxOffset + box.size + firstOffset;\n\n  for (var i = 0; i < referenceCount; i++) {\n    // |chunk| is 1 bit for |referenceType|, and 31 bits for |referenceSize|.\n    var chunk = box.reader.readUint32();\n    var referenceType = (chunk & 0x80000000) >>> 31;\n    var referenceSize = chunk & 0x7FFFFFFF;\n\n    var subsegmentDuration = box.reader.readUint32();\n\n    // Skipping 1 bit for |startsWithSap|, 3 bits for |sapType|, and 28 bits\n    // for |sapDelta|.\n    box.reader.skip(4);\n\n    // If |referenceType| is 1 then the reference is to another SIDX.\n    // We do not support this.\n    if (referenceType == 1) {\n      shaka.log.error('Heirarchical SIDXs are not supported.');\n      throw new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.MEDIA,\n          shaka.util.Error.Code.MP4_SIDX_TYPE_NOT_SUPPORTED);\n    }\n\n    references.push(\n        new shaka.media.SegmentReference(\n            references.length,\n            unscaledStartTime / timescale,\n            (unscaledStartTime + subsegmentDuration) / timescale,\n            function() { return uris; },\n            startByte,\n            startByte + referenceSize - 1));\n\n    unscaledStartTime += subsegmentDuration;\n    startByte += referenceSize;\n  }\n\n  return references;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/mp4_segment_index_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.SegmentIndex');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.SegmentReference');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.ManifestParserUtils');\n\n\n\n/**\n * Creates a SegmentIndex.\n *\n * @param {!Array.<!shaka.media.SegmentReference>} references The list of\n *   SegmentReferences, which must be sorted first by their start times\n *   (ascending) and second by their end times (ascending), and have\n *   continuous, increasing positions.\n *\n * @constructor\n * @struct\n * @implements {shaka.util.IDestroyable}\n * @export\n */\nshaka.media.SegmentIndex = function(references) {\n  if (!COMPILED) {\n    shaka.media.SegmentIndex.assertCorrectReferences_(references);\n  }\n\n  /** @private {Array.<!shaka.media.SegmentReference>} */\n  this.references_ = references;\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.media.SegmentIndex.prototype.destroy = function() {\n  this.references_ = null;\n  return Promise.resolve();\n};\n\n\n/**\n * Finds the position of the segment for the given time, in seconds, relative\n * to the start of a particular Period. Returns the position of the segment\n * with the largest end time if more than one segment is known for the given\n * time.\n *\n * @param {number} time\n * @return {?number} The position of the segment, or null\n *   if the position of the segment could not be determined.\n * @export\n */\nshaka.media.SegmentIndex.prototype.find = function(time) {\n  // For live streams, searching from the end is faster. For VOD, it balances\n  // out either way. In both cases, references_.length is small enough that the\n  // difference isn't huge.\n  for (var i = this.references_.length - 1; i >= 0; --i) {\n    var r = this.references_[i];\n    // Note that a segment ends immediately before the end time.\n    if ((time >= r.startTime) && (time < r.endTime)) {\n      return r.position;\n    }\n  }\n  if (this.references_.length && time < this.references_[0].startTime)\n    return this.references_[0].position;\n\n  return null;\n};\n\n\n/**\n * Gets the SegmentReference for the segment at the given position.\n *\n * @param {number} position The position of the segment.\n * @return {shaka.media.SegmentReference} The SegmentReference, or null if\n *   no such SegmentReference exists.\n * @export\n */\nshaka.media.SegmentIndex.prototype.get = function(position) {\n  if (this.references_.length == 0)\n    return null;\n\n  var index = position - this.references_[0].position;\n  if (index < 0 || index >= this.references_.length)\n    return null;\n\n  return this.references_[index];\n};\n\n\n/**\n * Merges the given SegmentReferences.  Supports extending the original\n * references only.  Will not replace old references or interleave new ones.\n *\n * @param {!Array.<!shaka.media.SegmentReference>} references The list of\n *   SegmentReferences, which must be sorted first by their start times\n *   (ascending) and second by their end times (ascending), and have\n *   continuous, increasing positions.\n * @export\n */\nshaka.media.SegmentIndex.prototype.merge = function(references) {\n  if (!COMPILED) {\n    shaka.media.SegmentIndex.assertCorrectReferences_(references);\n  }\n\n  var newReferences = [];\n  var i = 0;\n  var j = 0;\n\n  while ((i < this.references_.length) && (j < references.length)) {\n    var r1 = this.references_[i];\n    var r2 = references[j];\n\n    if (r1.startTime < r2.startTime) {\n      newReferences.push(r1);\n      i++;\n    } else if (r1.startTime > r2.startTime) {\n      // Drop the new reference if it would have to be interleaved with the\n      // old one.  Issue a warning, since this is not a supported update.\n      shaka.log.warning('Refusing to rewrite original references on update!');\n      j++;\n    } else {\n      // When period is changed, fitSegmentReference will expand the last\n      // segment to the start of the next period.  So, it is valid to have end\n      // time updated to the last segment reference in a period\n      if (Math.abs(r1.endTime - r2.endTime) > 0.1) {\n        goog.asserts.assert(r2.endTime > r1.endTime &&\n            i == this.references_.length - 1 &&\n            j == references.length - 1,\n            'This should be an update of the last segment in a period');\n        newReferences.push(r2);\n      } else {\n        // Drop the new reference if there's an old reference with the\n        // same time.\n        newReferences.push(r1);\n      }\n      i++;\n      j++;\n    }\n  }\n\n  while (i < this.references_.length) {\n    newReferences.push(this.references_[i++]);\n  }\n\n  if (newReferences.length) {\n    // The rest of these refs may need to be renumbered.\n    var nextPosition = newReferences[newReferences.length - 1].position + 1;\n    while (j < references.length) {\n      var r = references[j++];\n      var r2 = new shaka.media.SegmentReference(nextPosition++,\n          r.startTime, r.endTime, r.getUris, r.startByte, r.endByte);\n      newReferences.push(r2);\n    }\n  } else {\n    newReferences = references;\n  }\n\n  if (!COMPILED) {\n    shaka.media.SegmentIndex.assertCorrectReferences_(newReferences);\n  }\n\n  this.references_ = newReferences;\n};\n\n\n/**\n * Removes all SegmentReferences that end before the given time.\n *\n * @param {number} time The time in seconds.\n * @export\n */\nshaka.media.SegmentIndex.prototype.evict = function(time) {\n  for (var i = 0; i < this.references_.length; ++i) {\n    if (this.references_[i].endTime > time)\n      break;\n  }\n  this.references_.splice(0, i);\n};\n\n\n/**\n * Expands the first SegmentReference so it begins at the start of its Period\n * if it already begins close to the start of its Period, and expands or\n * contracts the last SegmentReference so it ends at the end of its Period for\n * VOD presentations.\n *\n * @param {?number} periodDuration\n */\nshaka.media.SegmentIndex.prototype.fit = function(periodDuration) {\n  if (this.references_.length == 0)\n    return;\n\n  /** @const {number} */\n  var tolerance = shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS;\n\n  goog.asserts.assert(periodDuration != null,\n                      'Period duration must be known for static content!');\n  goog.asserts.assert(periodDuration != Infinity,\n                      'Period duration must be finite for static content!');\n\n  var lastReference = this.references_[this.references_.length - 1];\n\n  // Sanity check.\n  goog.asserts.assert(\n      lastReference.startTime < periodDuration,\n      'lastReference cannot begin after the end of the Period');\n  if (lastReference.startTime > periodDuration) return;\n\n  // Log warning if necessary.\n  if (lastReference.endTime <= periodDuration - tolerance) {\n    shaka.log.warning(\n        'The last segment should not end before the end of the Period.',\n        lastReference);\n  } else if (lastReference.endTime >= periodDuration + tolerance) {\n    shaka.log.warning(\n        'The last segment should not end after the end of the Period.',\n        lastReference);\n  }\n\n  // Adjust the last SegmentReference.\n  this.references_[this.references_.length - 1] =\n      new shaka.media.SegmentReference(\n          lastReference.position,\n          lastReference.startTime, periodDuration,\n          lastReference.getUris,\n          lastReference.startByte, lastReference.endByte);\n};\n\n\nif (!COMPILED) {\n  /**\n   * Asserts that the given SegmentReferences are sorted and have continuous,\n   * increasing positions.\n   *\n   * @param {!Array.<shaka.media.SegmentReference>} references\n   * @private\n   */\n  shaka.media.SegmentIndex.assertCorrectReferences_ = function(references) {\n    goog.asserts.assert(references.every(function(r2, i) {\n      if (i == 0) return true;\n      var r1 = references[i - 1];\n      if (r2.position != r1.position + 1) return false;\n      if (r1.startTime < r2.startTime) {\n        return true;\n      } else if (r1.startTime > r2.startTime) {\n        return false;\n      } else {\n        if (r1.endTime <= r2.endTime) {\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }), 'SegmentReferences are incorrect');\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/segment_index.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.EbmlElement');\ngoog.provide('shaka.util.EbmlParser');\n\ngoog.require('shaka.util.DataViewReader');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Uint8ArrayUtils');\n\n\n\n/**\n * Creates an Extensible Binary Markup Language (EBML) parser.\n * @param {!DataView} dataView The EBML data.\n * @constructor\n * @struct\n */\nshaka.util.EbmlParser = function(dataView) {\n  /** @private {!DataView} */\n  this.dataView_ = dataView;\n\n  /** @private {!shaka.util.DataViewReader} */\n  this.reader_ = new shaka.util.DataViewReader(\n      dataView,\n      shaka.util.DataViewReader.Endianness.BIG_ENDIAN);\n\n  // If not already constructed, build a list of EBML dynamic size constants.\n  // This is not done at load-time to avoid exceptions on unsupported browsers.\n  if (!shaka.util.EbmlParser.DYNAMIC_SIZES) {\n    shaka.util.EbmlParser.DYNAMIC_SIZES = [\n      new Uint8Array([0xff]),\n      new Uint8Array([0x7f, 0xff]),\n      new Uint8Array([0x3f, 0xff, 0xff]),\n      new Uint8Array([0x1f, 0xff, 0xff, 0xff]),\n      new Uint8Array([0x0f, 0xff, 0xff, 0xff, 0xff]),\n      new Uint8Array([0x07, 0xff, 0xff, 0xff, 0xff, 0xff]),\n      new Uint8Array([0x03, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff]),\n      new Uint8Array([0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff])\n    ];\n  }\n};\n\n\n/** @const {!Array.<!Uint8Array>} */\nshaka.util.EbmlParser.DYNAMIC_SIZES;\n\n\n/**\n * @return {boolean} True if the parser has more data, false otherwise.\n */\nshaka.util.EbmlParser.prototype.hasMoreData = function() {\n  return this.reader_.hasMoreData();\n};\n\n\n/**\n * Parses an EBML element from the parser's current position, and advances\n * the parser.\n * @return {!shaka.util.EbmlElement} The EBML element.\n * @throws {shaka.util.Error}\n * @see http://matroska.org/technical/specs/rfc/index.html\n */\nshaka.util.EbmlParser.prototype.parseElement = function() {\n  var id = this.parseId_();\n\n  // Parse the element's size.\n  var vint = this.parseVint_();\n  var size;\n  if (shaka.util.EbmlParser.isDynamicSizeValue_(vint)) {\n    // If this has an unknown size, assume that it takes up the rest of the\n    // data.\n    size = this.dataView_.byteLength - this.reader_.getPosition();\n  } else {\n    size = shaka.util.EbmlParser.getVintValue_(vint);\n  }\n\n  // Note that if the element's size is larger than the buffer then we are\n  // parsing a \"partial element\". This may occur if for example we are\n  // parsing the beginning of some WebM container data, but our buffer does\n  // not contain the entire WebM container data.\n  var elementSize =\n      this.reader_.getPosition() + size <= this.dataView_.byteLength ?\n      size :\n      this.dataView_.byteLength - this.reader_.getPosition();\n\n  var dataView = new DataView(\n      this.dataView_.buffer,\n      this.dataView_.byteOffset + this.reader_.getPosition(), elementSize);\n\n  this.reader_.skip(elementSize);\n\n  return new shaka.util.EbmlElement(id, dataView);\n};\n\n\n/**\n * Parses an EBML ID from the parser's current position, and advances the\n * parser.\n * @throws {shaka.util.Error}\n * @return {number} The EBML ID.\n * @private\n */\nshaka.util.EbmlParser.prototype.parseId_ = function() {\n  var vint = this.parseVint_();\n\n  if (vint.length > 7) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.EBML_OVERFLOW);\n  }\n\n  var id = 0;\n  for (var i = 0; i < vint.length; i++) {\n    // Note that we cannot use << since |value| may exceed 32 bits.\n    id = (256 * id) + vint[i];\n  }\n\n  return id;\n};\n\n\n/**\n * Parses a variable sized integer from the parser's current position, and\n * advances the parser.\n * For example:\n *   1 byte  wide: 1xxx xxxx\n *   2 bytes wide: 01xx xxxx xxxx xxxx\n *   3 bytes wide: 001x xxxx xxxx xxxx xxxx xxxx\n * @throws {shaka.util.Error}\n * @return {!Uint8Array} The variable sized integer.\n * @private\n */\nshaka.util.EbmlParser.prototype.parseVint_ = function() {\n  var firstByte = this.reader_.readUint8();\n  var numBytes;\n\n  // Determine the byte width of the variable sized integer.\n  for (numBytes = 1; numBytes <= 8; numBytes++) {\n    var mask = 0x1 << (8 - numBytes);\n    if (firstByte & mask) {\n      break;\n    }\n  }\n\n  if (numBytes > 8) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.EBML_OVERFLOW);\n  }\n\n  var vint = new Uint8Array(numBytes);\n  vint[0] = firstByte;\n\n  // Include the remaining bytes.\n  for (var i = 1; i < numBytes; i++) {\n    vint[i] = this.reader_.readUint8();\n  }\n\n  return vint;\n};\n\n\n/**\n * Gets the value of a variable sized integer.\n * For example, the x's below are part of the vint's value.\n *    7-bit value: 1xxx xxxx\n *   14-bit value: 01xx xxxx xxxx xxxx\n *   21-bit value: 001x xxxx xxxx xxxx xxxx xxxx\n * @param {!Uint8Array} vint The variable sized integer.\n * @throws {shaka.util.Error}\n * @return {number} The value of the variable sized integer.\n * @private\n */\nshaka.util.EbmlParser.getVintValue_ = function(vint) {\n  // If |vint| is 8 bytes wide then we must ensure that it does not have more\n  // than 53 meaningful bits. For example, assume |vint| is 8 bytes wide,\n  // so it has the following structure,\n  // 0000 0001 | xxxx xxxx ...\n  // Thus, the first 3 bits following the first byte of |vint| must be 0.\n  if ((vint.length == 8) && (vint[1] & 0xe0)) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.JS_INTEGER_OVERFLOW);\n  }\n\n  // Mask out the first few bits of |vint|'s first byte to get the most\n  // significant bits of |vint|'s value. If |vint| is 8 bytes wide then |value|\n  // will be set to 0.\n  var mask = 0x1 << (8 - vint.length);\n  var value = vint[0] & (mask - 1);\n\n  // Add the remaining bytes.\n  for (var i = 1; i < vint.length; i++) {\n    // Note that we cannot use << since |value| may exceed 32 bits.\n    value = (256 * value) + vint[i];\n  }\n\n  return value;\n};\n\n\n/**\n * Checks if the given variable sized integer represents a dynamic size value.\n * @param {!Uint8Array} vint The variable sized integer.\n * @return {boolean} true if |vint| represents a dynamic size value,\n *   false otherwise.\n * @private\n */\nshaka.util.EbmlParser.isDynamicSizeValue_ = function(vint) {\n  var EbmlParser = shaka.util.EbmlParser;\n  var uint8ArrayEqual = shaka.util.Uint8ArrayUtils.equal;\n\n  for (var i = 0; i < EbmlParser.DYNAMIC_SIZES.length; i++) {\n    if (uint8ArrayEqual(vint, EbmlParser.DYNAMIC_SIZES[i])) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\n\n\n/**\n * Creates an EbmlElement.\n * @param {number} id The ID.\n * @param {!DataView} dataView The DataView.\n * @constructor\n */\nshaka.util.EbmlElement = function(id, dataView) {\n  /** @type {number} */\n  this.id = id;\n\n  /** @private {!DataView} */\n  this.dataView_ = dataView;\n};\n\n\n/**\n * Gets the element's offset from the beginning of the buffer.\n * @return {number}\n */\nshaka.util.EbmlElement.prototype.getOffset = function() {\n  return this.dataView_.byteOffset;\n};\n\n\n/**\n * Interpret the element's data as a list of sub-elements.\n * @throws {shaka.util.Error}\n * @return {!shaka.util.EbmlParser} A parser over the sub-elements.\n */\nshaka.util.EbmlElement.prototype.createParser = function() {\n  return new shaka.util.EbmlParser(this.dataView_);\n};\n\n\n/**\n * Interpret the element's data as an unsigned integer.\n * @throws {shaka.util.Error}\n * @return {number}\n */\nshaka.util.EbmlElement.prototype.getUint = function() {\n  if (this.dataView_.byteLength > 8) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.EBML_OVERFLOW);\n  }\n\n  // Ensure we have at most 53 meaningful bits.\n  if ((this.dataView_.byteLength == 8) && (this.dataView_.getUint8(0) & 0xe0)) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.JS_INTEGER_OVERFLOW);\n  }\n\n  var value = 0;\n\n  for (var i = 0; i < this.dataView_.byteLength; i++) {\n    var chunk = this.dataView_.getUint8(i);\n    value = (256 * value) + chunk;\n  }\n\n  return value;\n};\n\n\n/**\n * Interpret the element's data as a floating point number (32 bits or 64 bits).\n * 80-bit floating point numbers are not supported.\n * @throws {shaka.util.Error}\n * @return {number}\n */\nshaka.util.EbmlElement.prototype.getFloat = function() {\n  if (this.dataView_.byteLength == 4) {\n    return this.dataView_.getFloat32(0);\n  } else if (this.dataView_.byteLength == 8) {\n    return this.dataView_.getFloat64(0);\n  } else {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.EBML_BAD_FLOATING_POINT_SIZE);\n  }\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/ebml_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.WebmSegmentIndexParser');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.SegmentReference');\ngoog.require('shaka.util.EbmlElement');\ngoog.require('shaka.util.EbmlParser');\ngoog.require('shaka.util.Error');\n\n\n\n/**\n * Creates a WebM Cues element parser.\n *\n * @constructor\n * @struct\n */\nshaka.media.WebmSegmentIndexParser = function() {};\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.EBML_ID = 0x1a45dfa3;\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.SEGMENT_ID = 0x18538067;\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.INFO_ID = 0x1549a966;\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.TIMECODE_SCALE_ID = 0x2ad7b1;\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.DURATION_ID = 0x4489;\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.CUES_ID = 0x1c53bb6b;\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.CUE_POINT_ID = 0xbb;\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.CUE_TIME_ID = 0xb3;\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.CUE_TRACK_POSITIONS_ID = 0xb7;\n\n\n/** @const {number} */\nshaka.media.WebmSegmentIndexParser.CUE_CLUSTER_POSITION = 0xf1;\n\n\n/**\n * Parses SegmentReferences from a WebM container.\n * @param {!ArrayBuffer} cuesData The WebM container's \"Cueing Data\" section.\n * @param {!ArrayBuffer} initData The WebM container's headers.\n * @param {!Array.<string>} uris The possible locations of the WebM file that\n *   contains the segments.\n * @param {number} presentationTimeOffset\n\n * @return {!Array.<!shaka.media.SegmentReference>}\n * @throws {shaka.util.Error}\n * @see http://www.matroska.org/technical/specs/index.html\n * @see http://www.webmproject.org/docs/container/\n */\nshaka.media.WebmSegmentIndexParser.prototype.parse = function(\n    cuesData, initData, uris, presentationTimeOffset) {\n  var tuple = this.parseWebmContainer_(initData);\n  var parser = new shaka.util.EbmlParser(new DataView(cuesData));\n  var cuesElement = parser.parseElement();\n  if (cuesElement.id != shaka.media.WebmSegmentIndexParser.CUES_ID) {\n    shaka.log.error('Not a Cues element.');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.WEBM_CUES_ELEMENT_MISSING);\n  }\n\n  return this.parseCues_(\n      cuesElement, tuple.segmentOffset, tuple.timecodeScale, tuple.duration,\n      uris, presentationTimeOffset);\n};\n\n\n/**\n * Parses a WebM container to get the segment's offset, timecode scale, and\n * duration.\n *\n * @param {!ArrayBuffer} initData\n * @return {{segmentOffset: number, timecodeScale: number, duration: number}}\n *   The segment's offset in bytes, the segment's timecode scale in seconds,\n *   and the duration in seconds.\n * @throws {shaka.util.Error}\n * @private\n */\nshaka.media.WebmSegmentIndexParser.prototype.parseWebmContainer_ = function(\n    initData) {\n  var parser = new shaka.util.EbmlParser(new DataView(initData));\n\n  // Check that the WebM container data starts with the EBML header, but\n  // skip its contents.\n  var ebmlElement = parser.parseElement();\n  if (ebmlElement.id != shaka.media.WebmSegmentIndexParser.EBML_ID) {\n    shaka.log.error('Not an EBML element.');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.WEBM_EBML_HEADER_ELEMENT_MISSING);\n  }\n\n  var segmentElement = parser.parseElement();\n  if (segmentElement.id != shaka.media.WebmSegmentIndexParser.SEGMENT_ID) {\n    shaka.log.error('Not a Segment element.');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.WEBM_SEGMENT_ELEMENT_MISSING);\n  }\n\n  // This value is used as the initial offset to the first referenced segment.\n  var segmentOffset = segmentElement.getOffset();\n\n  // Parse the Segment element to get the segment info.\n  var segmentInfo = this.parseSegment_(segmentElement);\n  return {\n    segmentOffset: segmentOffset,\n    timecodeScale: segmentInfo.timecodeScale,\n    duration: segmentInfo.duration\n  };\n};\n\n\n/**\n * Parses a WebM Info element to get the segment's timecode scale and duration.\n * @param {!shaka.util.EbmlElement} segmentElement\n * @return {{timecodeScale: number, duration: number}} The segment's timecode\n *   scale in seconds and duration in seconds.\n * @throws {shaka.util.Error}\n * @private\n */\nshaka.media.WebmSegmentIndexParser.prototype.parseSegment_ = function(\n    segmentElement) {\n  var parser = segmentElement.createParser();\n\n  // Find the Info element.\n  var infoElement = null;\n  while (parser.hasMoreData()) {\n    var elem = parser.parseElement();\n    if (elem.id != shaka.media.WebmSegmentIndexParser.INFO_ID) {\n      continue;\n    }\n\n    infoElement = elem;\n\n    break;\n  }\n\n  if (!infoElement) {\n    shaka.log.error('Not an Info element.');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.WEBM_INFO_ELEMENT_MISSING);\n  }\n\n  return this.parseInfo_(infoElement);\n};\n\n\n/**\n * Parses a WebM Info element to get the segment's timecode scale and duration.\n * @param {!shaka.util.EbmlElement} infoElement\n * @return {{timecodeScale: number, duration: number}} The segment's timecode\n *   scale in seconds and duration in seconds.\n * @throws {shaka.util.Error}\n * @private\n */\nshaka.media.WebmSegmentIndexParser.prototype.parseInfo_ = function(\n    infoElement) {\n  var parser = infoElement.createParser();\n\n  // The timecode scale factor in units of [nanoseconds / T], where [T] are the\n  // units used to express all other time values in the WebM container. By\n  // default it's assumed that [T] == [milliseconds].\n  var timecodeScaleNanoseconds = 1000000;\n  /** @type {?number} */\n  var durationScale = null;\n\n  while (parser.hasMoreData()) {\n    var elem = parser.parseElement();\n    if (elem.id == shaka.media.WebmSegmentIndexParser.TIMECODE_SCALE_ID) {\n      timecodeScaleNanoseconds = elem.getUint();\n    } else if (elem.id == shaka.media.WebmSegmentIndexParser.DURATION_ID) {\n      durationScale = elem.getFloat();\n    }\n  }\n  if (durationScale == null) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.WEBM_DURATION_ELEMENT_MISSING);\n  }\n\n  // The timecode scale factor in units of [seconds / T].\n  var timecodeScale = timecodeScaleNanoseconds / 1000000000;\n  // The duration is stored in units of [T]\n  var durationSeconds = durationScale * timecodeScale;\n\n  return {timecodeScale: timecodeScale, duration: durationSeconds};\n};\n\n\n/**\n * Parses a WebM CuesElement.\n * @param {!shaka.util.EbmlElement} cuesElement\n * @param {number} segmentOffset\n * @param {number} timecodeScale\n * @param {number} duration\n * @param {!Array.<string>} uris\n * @param {number} presentationTimeOffset\n * @return {!Array.<!shaka.media.SegmentReference>}\n * @throws {shaka.util.Error}\n * @private\n */\nshaka.media.WebmSegmentIndexParser.prototype.parseCues_ = function(\n    cuesElement, segmentOffset, timecodeScale, duration, uris,\n    presentationTimeOffset) {\n  var references = [];\n  var getUris = function() { return uris; };\n\n  var parser = cuesElement.createParser();\n\n  var lastTime = -1;\n  var lastOffset = -1;\n\n  while (parser.hasMoreData()) {\n    var elem = parser.parseElement();\n    if (elem.id != shaka.media.WebmSegmentIndexParser.CUE_POINT_ID) {\n      continue;\n    }\n\n    var tuple = this.parseCuePoint_(elem);\n    if (!tuple) {\n      continue;\n    }\n\n    // Substract presentationTimeOffset from unscalled time\n    var currentTime = timecodeScale *\n        (tuple.unscaledTime - presentationTimeOffset);\n    var currentOffset = segmentOffset + tuple.relativeOffset;\n\n    if (lastTime >= 0) {\n      goog.asserts.assert(lastOffset >= 0, 'last offset cannot be 0');\n\n      references.push(\n          new shaka.media.SegmentReference(\n              references.length,\n              lastTime, currentTime,\n              getUris,\n              lastOffset, currentOffset - 1));\n    }\n\n    lastTime = currentTime;\n    lastOffset = currentOffset;\n  }\n\n  if (lastTime >= 0) {\n    goog.asserts.assert(lastOffset >= 0, 'last offset cannot be 0');\n\n    references.push(\n        new shaka.media.SegmentReference(\n            references.length, lastTime, duration, getUris, lastOffset, null));\n  }\n\n  return references;\n};\n\n\n/**\n * Parses a WebM CuePointElement to get an \"unadjusted\" segment reference.\n * @param {shaka.util.EbmlElement} cuePointElement\n * @return {{unscaledTime: number, relativeOffset: number}} The referenced\n *   segment's start time in units of [T] (see parseInfo_()), and the\n *   referenced segment's offset in bytes, relative to a WebM Segment\n *   element.\n * @throws {shaka.util.Error}\n * @private\n */\nshaka.media.WebmSegmentIndexParser.prototype.parseCuePoint_ = function(\n    cuePointElement) {\n  var parser = cuePointElement.createParser();\n\n  // Parse CueTime element.\n  var cueTimeElement = parser.parseElement();\n  if (cueTimeElement.id != shaka.media.WebmSegmentIndexParser.CUE_TIME_ID) {\n    shaka.log.warning('Not a CueTime element.');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.WEBM_CUE_TIME_ELEMENT_MISSING);\n  }\n  var unscaledTime = cueTimeElement.getUint();\n\n  // Parse CueTrackPositions element.\n  var cueTrackPositionsElement = parser.parseElement();\n  if (cueTrackPositionsElement.id !=\n      shaka.media.WebmSegmentIndexParser.CUE_TRACK_POSITIONS_ID) {\n    shaka.log.warning('Not a CueTrackPositions element.');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MEDIA,\n        shaka.util.Error.Code.WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING);\n  }\n\n  var cueTrackParser = cueTrackPositionsElement.createParser();\n  var relativeOffset = 0;\n\n  while (cueTrackParser.hasMoreData()) {\n    var elem = cueTrackParser.parseElement();\n    if (elem.id != shaka.media.WebmSegmentIndexParser.CUE_CLUSTER_POSITION) {\n      continue;\n    }\n\n    relativeOffset = elem.getUint();\n    break;\n  }\n\n  return { unscaledTime: unscaledTime, relativeOffset: relativeOffset };\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/webm_segment_index_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.dash.SegmentBase');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.dash.MpdUtils');\ngoog.require('shaka.log');\ngoog.require('shaka.media.InitSegmentReference');\ngoog.require('shaka.media.Mp4SegmentIndexParser');\ngoog.require('shaka.media.SegmentIndex');\ngoog.require('shaka.media.WebmSegmentIndexParser');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.XmlUtils');\n\n\n/**\n * @namespace shaka.dash.SegmentBase\n * @summary A set of functions for parsing SegmentBase elements.\n */\n\n\n/**\n * Creates an init segment reference from a Context object.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {function(?shaka.dash.DashParser.InheritanceFrame):Element} callback\n * @return {shaka.media.InitSegmentReference}\n */\nshaka.dash.SegmentBase.createInitSegment = function(context, callback) {\n  var MpdUtils = shaka.dash.MpdUtils;\n  var XmlUtils = shaka.util.XmlUtils;\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n\n  var initialization =\n      MpdUtils.inheritChild(context, callback, 'Initialization');\n  if (!initialization)\n    return null;\n\n  var resolvedUris = context.representation.baseUris;\n  var uri = initialization.getAttribute('sourceURL');\n  if (uri) {\n    resolvedUris =\n        ManifestParserUtils.resolveUris(context.representation.baseUris, [uri]);\n  }\n\n  var startByte = 0;\n  var endByte = null;\n  var range = XmlUtils.parseAttr(initialization, 'range', XmlUtils.parseRange);\n  if (range) {\n    startByte = range.start;\n    endByte = range.end;\n  }\n\n  var getUris = function() { return resolvedUris; };\n  return new shaka.media.InitSegmentReference(getUris, startByte, endByte);\n};\n\n\n/**\n * Creates a new Stream object.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.DashParser.RequestInitSegmentCallback} requestInitSegment\n * @throws shaka.util.Error When there is a parsing error.\n * @return {shaka.dash.DashParser.StreamInfo}\n */\nshaka.dash.SegmentBase.createStream = function(context, requestInitSegment) {\n  goog.asserts.assert(context.representation.segmentBase,\n                      'Should only be called with SegmentBase');\n  // Since SegmentBase does not need updates, simply treat any call as\n  // the initial parse.\n  var MpdUtils = shaka.dash.MpdUtils;\n  var SegmentBase = shaka.dash.SegmentBase;\n\n  var presentationTimeOffset = MpdUtils.inheritAttribute(\n      context, SegmentBase.fromInheritance_, 'presentationTimeOffset');\n\n  var init =\n      SegmentBase.createInitSegment(context, SegmentBase.fromInheritance_);\n  var index = SegmentBase.createSegmentIndex_(\n      context, requestInitSegment, init, Number(presentationTimeOffset));\n\n  return {\n    createSegmentIndex: index.createSegmentIndex,\n    findSegmentPosition: index.findSegmentPosition,\n    getSegmentReference: index.getSegmentReference,\n    initSegmentReference: init,\n    presentationTimeOffset: Number(presentationTimeOffset) || 0\n  };\n};\n\n\n/**\n * Creates segment index info for the given info.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.DashParser.RequestInitSegmentCallback} requestInitSegment\n * @param {shaka.media.InitSegmentReference} init\n * @param {!Array.<string>} uris\n * @param {number} startByte\n * @param {?number} endByte\n * @param {string} containerType\n * @param {number} presentationTimeOffset\n * @return {shaka.dash.DashParser.SegmentIndexFunctions}\n */\nshaka.dash.SegmentBase.createSegmentIndexFromUris = function(\n    context, requestInitSegment, init, uris,\n    startByte, endByte, containerType, presentationTimeOffset) {\n  var presentationTimeline = context.presentationTimeline;\n  var fitLast = !context.dynamic || !context.periodInfo.isLastPeriod;\n  var periodStartTime = context.periodInfo.start;\n  var periodDuration = context.periodInfo.duration;\n\n  // Create a local variable to bind to so we can set to null to help the GC.\n  var localRequest = requestInitSegment;\n  var segmentIndex = null;\n  var create = function() {\n    var async = [\n      localRequest(uris, startByte, endByte),\n      containerType == 'webm' ?\n          localRequest(init.getUris(), init.startByte, init.endByte) :\n          null\n    ];\n\n    localRequest = null;\n    return Promise.all(async).then(function(results) {\n      var indexData = results[0];\n      var initData = results[1] || null;\n      var references = null;\n\n      if (containerType == 'mp4') {\n        references = shaka.media.Mp4SegmentIndexParser(\n            indexData, startByte, uris, presentationTimeOffset);\n      } else {\n        goog.asserts.assert(initData, 'WebM requires init data');\n        var parser = new shaka.media.WebmSegmentIndexParser();\n        references = parser.parse(indexData, initData, uris,\n            presentationTimeOffset);\n      }\n\n      presentationTimeline.notifySegments(periodStartTime, references);\n\n      // Since containers are never updated, we don't need to store the\n      // segmentIndex in the map.\n      goog.asserts.assert(!segmentIndex,\n                          'Should not call createSegmentIndex twice');\n\n      segmentIndex = new shaka.media.SegmentIndex(references);\n      if (fitLast)\n        segmentIndex.fit(periodDuration);\n    });\n  };\n  var get = function(i) {\n    goog.asserts.assert(segmentIndex, 'Must call createSegmentIndex first');\n    return segmentIndex.get(i);\n  };\n  var find = function(t) {\n    goog.asserts.assert(segmentIndex, 'Must call createSegmentIndex first');\n    return segmentIndex.find(t);\n  };\n\n  return {\n    createSegmentIndex: create,\n    findSegmentPosition: find,\n    getSegmentReference: get\n  };\n};\n\n\n/**\n * @param {?shaka.dash.DashParser.InheritanceFrame} frame\n * @return {Element}\n * @private\n */\nshaka.dash.SegmentBase.fromInheritance_ = function(frame) {\n  return frame.segmentBase;\n};\n\n\n/**\n * Creates segment index info from a Context object.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.DashParser.RequestInitSegmentCallback} requestInitSegment\n * @param {shaka.media.InitSegmentReference} init\n * @param {number} presentationTimeOffset\n * @return {shaka.dash.DashParser.SegmentIndexFunctions}\n * @throws shaka.util.Error When there is a parsing error.\n * @private\n */\nshaka.dash.SegmentBase.createSegmentIndex_ = function(\n    context, requestInitSegment, init, presentationTimeOffset) {\n  var MpdUtils = shaka.dash.MpdUtils;\n  var SegmentBase = shaka.dash.SegmentBase;\n  var XmlUtils = shaka.util.XmlUtils;\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  var contentType = context.representation.contentType;\n  var containerType = context.representation.mimeType.split('/')[1];\n  if (contentType != ContentType.TEXT && containerType != 'mp4' &&\n      containerType != 'webm') {\n    shaka.log.error(\n        'SegmentBase specifies an unsupported container type.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_UNSUPPORTED_CONTAINER);\n  }\n\n  if ((containerType == 'webm') && !init) {\n    shaka.log.error(\n        'SegmentBase does not contain sufficient segment information:',\n        'the SegmentBase uses a WebM container,',\n        'but does not contain an Initialization element.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_WEBM_MISSING_INIT);\n  }\n\n  var representationIndex = MpdUtils.inheritChild(\n      context, SegmentBase.fromInheritance_, 'RepresentationIndex');\n  var indexRangeElem = MpdUtils.inheritAttribute(\n      context, SegmentBase.fromInheritance_, 'indexRange');\n\n  var indexUris = context.representation.baseUris;\n  var indexRange = XmlUtils.parseRange(indexRangeElem || '');\n  if (representationIndex) {\n    var representationUri = representationIndex.getAttribute('sourceURL');\n    if (representationUri) {\n      indexUris = ManifestParserUtils.resolveUris(\n          context.representation.baseUris, [representationUri]);\n    }\n\n    indexRange = XmlUtils.parseAttr(\n        representationIndex, 'range', XmlUtils.parseRange, indexRange);\n  }\n\n  if (!indexRange) {\n    shaka.log.error(\n        'SegmentBase does not contain sufficient segment information:',\n        'the SegmentBase does not contain @indexRange',\n        'or a RepresentationIndex element.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);\n  }\n\n  return shaka.dash.SegmentBase.createSegmentIndexFromUris(\n      context, requestInitSegment, init, indexUris, indexRange.start,\n      indexRange.end, containerType, presentationTimeOffset);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/dash/segment_base.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.dash.SegmentList');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.dash.MpdUtils');\ngoog.require('shaka.dash.SegmentBase');\ngoog.require('shaka.log');\ngoog.require('shaka.media.SegmentIndex');\ngoog.require('shaka.media.SegmentReference');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.XmlUtils');\n\n\n/**\n * @namespace shaka.dash.SegmentList\n * @summary A set of functions for parsing SegmentList elements.\n */\n\n\n/**\n * Creates a new Stream object or updates the Stream in the manifest.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {!Object.<string, !shaka.media.SegmentIndex>} segmentIndexMap\n * @return {shaka.dash.DashParser.StreamInfo}\n */\nshaka.dash.SegmentList.createStream = function(context, segmentIndexMap) {\n  goog.asserts.assert(context.representation.segmentList,\n                      'Should only be called with SegmentList');\n  var SegmentList = shaka.dash.SegmentList;\n\n  var init = shaka.dash.SegmentBase.createInitSegment(\n      context, SegmentList.fromInheritance_);\n  var info = SegmentList.parseSegmentListInfo_(context);\n\n  SegmentList.checkSegmentListInfo_(context, info);\n\n  /** @type {shaka.media.SegmentIndex} */\n  var segmentIndex = null;\n  var id = null;\n  if (context.period.id && context.representation.id) {\n    // Only check/store the index if period and representation IDs are set.\n    id = context.period.id + ',' + context.representation.id;\n    segmentIndex = segmentIndexMap[id];\n  }\n\n  var references = SegmentList.createSegmentReferences_(\n      context.periodInfo.duration, info.startNumber,\n      context.representation.baseUris, info);\n\n  if (segmentIndex) {\n    segmentIndex.merge(references);\n    var start = context.presentationTimeline.getSegmentAvailabilityStart();\n    segmentIndex.evict(start - context.periodInfo.start);\n  } else {\n    context.presentationTimeline.notifySegments(\n        context.periodInfo.start, references);\n    segmentIndex = new shaka.media.SegmentIndex(references);\n    if (id && context.dynamic)\n      segmentIndexMap[id] = segmentIndex;\n  }\n\n  if (!context.dynamic || !context.periodInfo.isLastPeriod)\n    segmentIndex.fit(context.periodInfo.duration);\n\n  return {\n    createSegmentIndex: Promise.resolve.bind(Promise),\n    findSegmentPosition: segmentIndex.find.bind(segmentIndex),\n    getSegmentReference: segmentIndex.get.bind(segmentIndex),\n    initSegmentReference: init,\n    presentationTimeOffset: info.presentationTimeOffset\n  };\n};\n\n\n/**\n * @typedef {{\n *   mediaUri: string,\n *   start: number,\n *   end: ?number\n * }}\n *\n * @property {string} mediaUri\n *   The URI of the segment.\n * @property {number} start\n *   The start byte of the segment.\n * @property {?number} end\n *   The end byte of the segment, or null.\n */\nshaka.dash.SegmentList.MediaSegment;\n\n\n/**\n * @typedef {{\n *   segmentDuration: ?number,\n *   startTime: number,\n *   startNumber: number,\n *   presentationTimeOffset: number,\n *   timeline: Array.<shaka.dash.MpdUtils.TimeRange>,\n *   mediaSegments: !Array.<shaka.dash.SegmentList.MediaSegment>\n * }}\n * @private\n *\n * @description\n * Contains information about a SegmentList.\n *\n * @property {?number} segmentDuration\n *   The duration of the segments, if given.\n * @property {number} startTime\n *   The start time of the first segment, in seconds.\n * @property {number} startNumber\n *   The start number of the segments; 1 or greater.\n * @property {number} presentationTimeOffset\n *   The presentationTimeOffset of the representation, in seconds.\n * @property {Array.<shaka.dash.MpdUtils.TimeRange>} timeline\n *   The timeline of the representation, if given.  Times in seconds.\n * @property {!Array.<shaka.dash.SegmentList.MediaSegment>} mediaSegments\n *   The URI and byte-ranges of the media segments.\n */\nshaka.dash.SegmentList.SegmentListInfo;\n\n\n/**\n * @param {?shaka.dash.DashParser.InheritanceFrame} frame\n * @return {Element}\n * @private\n */\nshaka.dash.SegmentList.fromInheritance_ = function(frame) {\n  return frame.segmentList;\n};\n\n\n/**\n * Parses the SegmentList items to create an info object.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @return {shaka.dash.SegmentList.SegmentListInfo}\n * @private\n */\nshaka.dash.SegmentList.parseSegmentListInfo_ = function(context) {\n  var SegmentList = shaka.dash.SegmentList;\n  var MpdUtils = shaka.dash.MpdUtils;\n\n  var mediaSegments = SegmentList.parseMediaSegments_(context);\n  var segmentInfo =\n      MpdUtils.parseSegmentInfo(context, SegmentList.fromInheritance_);\n\n  var startNumber = segmentInfo.startNumber;\n  if (startNumber == 0) {\n    shaka.log.warning('SegmentList@startNumber must be > 0');\n    startNumber = 1;\n  }\n\n  var startTime = 0;\n  if (segmentInfo.segmentDuration) {\n    // See DASH sec. 5.3.9.5.3\n    // Don't use presentationTimeOffset for @duration.\n    startTime = segmentInfo.segmentDuration * (startNumber - 1);\n  } else if (segmentInfo.timeline && segmentInfo.timeline.length > 0) {\n    // The presentationTimeOffset was considered in timeline creation\n    startTime = segmentInfo.timeline[0].start;\n  }\n\n  return {\n    segmentDuration: segmentInfo.segmentDuration,\n    startTime: startTime,\n    startNumber: startNumber,\n    presentationTimeOffset: segmentInfo.presentationTimeOffset,\n    timeline: segmentInfo.timeline,\n    mediaSegments: mediaSegments\n  };\n};\n\n\n/**\n * Checks whether a SegmentListInfo object is valid.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.SegmentList.SegmentListInfo} info\n * @throws shaka.util.Error When there is a parsing error.\n * @private\n */\nshaka.dash.SegmentList.checkSegmentListInfo_ = function(context, info) {\n  if (!info.segmentDuration && !info.timeline &&\n      info.mediaSegments.length > 1) {\n    shaka.log.warning(\n        'SegmentList does not contain sufficient segment information:',\n        'the SegmentList specifies multiple segments,',\n        'but does not specify a segment duration or timeline.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);\n  }\n\n  if (!info.segmentDuration && !context.periodInfo.duration && !info.timeline &&\n      info.mediaSegments.length == 1) {\n    shaka.log.warning(\n        'SegmentList does not contain sufficient segment information:',\n        'the SegmentList specifies one segment,',\n        'but does not specify a segment duration, period duration,',\n        'or timeline.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);\n  }\n\n  if (info.timeline && info.timeline.length == 0) {\n    shaka.log.warning(\n        'SegmentList does not contain sufficient segment information:',\n        'the SegmentList has an empty timeline.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);\n  }\n};\n\n\n/**\n * Creates an array of segment references for the given data.\n *\n * @param {?number} periodDuration in seconds.\n * @param {number} startNumber\n * @param {!Array.<string>} baseUris\n * @param {shaka.dash.SegmentList.SegmentListInfo} info\n * @return {!Array.<!shaka.media.SegmentReference>}\n * @private\n */\nshaka.dash.SegmentList.createSegmentReferences_ = function(\n    periodDuration, startNumber, baseUris, info) {\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n\n  var max = info.mediaSegments.length;\n  if (info.timeline && info.timeline.length != info.mediaSegments.length) {\n    max = Math.min(info.timeline.length, info.mediaSegments.length);\n    shaka.log.warning(\n        'The number of items in the segment timeline and the number of segment',\n        'URLs do not match, truncating', info.mediaSegments.length, 'to', max);\n  }\n\n  /** @type {!Array.<!shaka.media.SegmentReference>} */\n  var references = [];\n  var prevEndTime = info.startTime;\n  for (var i = 0; i < max; i++) {\n    var segment = info.mediaSegments[i];\n    var mediaUri = ManifestParserUtils.resolveUris(\n        baseUris, [segment.mediaUri]);\n\n    var startTime = prevEndTime;\n    var endTime;\n\n    if (info.segmentDuration != null) {\n      endTime = startTime + info.segmentDuration;\n    } else if (info.timeline) {\n      // Ignore the timepoint start since they are continuous.\n      endTime = info.timeline[i].end;\n    } else {\n      // If segmentDuration and timeline are null then there must\n      // only be one segment.\n      goog.asserts.assert(\n          info.mediaSegments.length == 1 && periodDuration,\n          'There should only be one segment with a Period duration.');\n      endTime = startTime + periodDuration;\n    }\n\n    var getUris = (function(uris) { return uris; }.bind(null, mediaUri));\n    references.push(\n        new shaka.media.SegmentReference(\n            i + startNumber, startTime, endTime, getUris, segment.start,\n            segment.end));\n    prevEndTime = endTime;\n  }\n\n  return references;\n};\n\n\n/**\n * Parses the media URIs from the context.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @return {!Array.<shaka.dash.SegmentList.MediaSegment>}\n * @private\n */\nshaka.dash.SegmentList.parseMediaSegments_ = function(context) {\n  var Functional = shaka.util.Functional;\n  /** @type {!Array.<!Element>} */\n  var segmentLists = [\n    context.representation.segmentList,\n    context.adaptationSet.segmentList,\n    context.period.segmentList\n  ].filter(Functional.isNotNull);\n\n  var XmlUtils = shaka.util.XmlUtils;\n  // Search each SegmentList for one with at least one SegmentURL element,\n  // select the first one, and convert each SegmentURL element to a tuple.\n  return segmentLists\n      .map(function(node) { return XmlUtils.findChildren(node, 'SegmentURL'); })\n      .reduce(function(all, part) { return all.length > 0 ? all : part; })\n      .map(function(urlNode) {\n        if (urlNode.getAttribute('indexRange') &&\n            !context.indexRangeWarningGiven) {\n          context.indexRangeWarningGiven = true;\n          shaka.log.warning(\n              'We do not support the SegmentURL@indexRange attribute on ' +\n              'SegmentList.  We only use the SegmentList@duration attribute ' +\n              'or SegmentTimeline, which must be accurate.');\n        }\n\n        var uri = urlNode.getAttribute('media');\n        var range = XmlUtils.parseAttr(\n            urlNode, 'mediaRange', XmlUtils.parseRange, {start: 0, end: null});\n        return {mediaUri: uri, start: range.start, end: range.end};\n      });\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/dash/segment_list.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.dash.SegmentTemplate');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.dash.MpdUtils');\ngoog.require('shaka.dash.SegmentBase');\ngoog.require('shaka.log');\ngoog.require('shaka.media.InitSegmentReference');\ngoog.require('shaka.media.SegmentIndex');\ngoog.require('shaka.media.SegmentReference');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.ManifestParserUtils');\n\n\n/**\n * @namespace shaka.dash.SegmentTemplate\n * @summary A set of functions for parsing SegmentTemplate elements.\n */\n\n\n/**\n * Creates a new Stream object or updates the Stream in the manifest.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.DashParser.RequestInitSegmentCallback} requestInitSegment\n * @param {!Object.<string, !shaka.media.SegmentIndex>} segmentIndexMap\n * @param {boolean} isUpdate True if the manifest is being updated.\n * @throws shaka.util.Error When there is a parsing error.\n * @return {shaka.dash.DashParser.StreamInfo}\n */\nshaka.dash.SegmentTemplate.createStream = function(\n    context, requestInitSegment, segmentIndexMap, isUpdate) {\n  goog.asserts.assert(context.representation.segmentTemplate,\n                      'Should only be called with SegmentTemplate');\n  var SegmentTemplate = shaka.dash.SegmentTemplate;\n\n  var init = SegmentTemplate.createInitSegment_(context);\n  var info = SegmentTemplate.parseSegmentTemplateInfo_(context);\n\n  SegmentTemplate.checkSegmentTemplateInfo_(context, info);\n\n  /** @type {?shaka.dash.DashParser.SegmentIndexFunctions} */\n  var segmentIndexFunctions = null;\n  if (info.indexTemplate) {\n    segmentIndexFunctions = SegmentTemplate.createFromIndexTemplate_(\n        context, requestInitSegment, init, info);\n  } else if (info.segmentDuration) {\n    if (!isUpdate) {\n      context.presentationTimeline.notifyMaxSegmentDuration(\n          info.segmentDuration);\n    }\n    segmentIndexFunctions = SegmentTemplate.createFromDuration_(context, info);\n  } else {\n    /** @type {shaka.media.SegmentIndex} */\n    var segmentIndex = null;\n    var id = null;\n    if (context.period.id && context.representation.id) {\n      // Only check/store the index if period and representation IDs are set.\n      id = context.period.id + ',' + context.representation.id;\n      segmentIndex = segmentIndexMap[id];\n    }\n\n    var references = SegmentTemplate.createFromTimeline_(context, info);\n\n    if (segmentIndex) {\n      segmentIndex.merge(references);\n      var start = context.presentationTimeline.getSegmentAvailabilityStart();\n      segmentIndex.evict(start - context.periodInfo.start);\n    } else {\n      context.presentationTimeline.notifySegments(\n          context.periodInfo.start, references);\n      segmentIndex = new shaka.media.SegmentIndex(references);\n      if (id && context.dynamic)\n        segmentIndexMap[id] = segmentIndex;\n    }\n\n    if (!context.dynamic || !context.periodInfo.isLastPeriod)\n      segmentIndex.fit(context.periodInfo.duration);\n\n    segmentIndexFunctions = {\n      createSegmentIndex: Promise.resolve.bind(Promise),\n      findSegmentPosition: segmentIndex.find.bind(segmentIndex),\n      getSegmentReference: segmentIndex.get.bind(segmentIndex)\n    };\n  }\n\n  return {\n    createSegmentIndex: segmentIndexFunctions.createSegmentIndex,\n    findSegmentPosition: segmentIndexFunctions.findSegmentPosition,\n    getSegmentReference: segmentIndexFunctions.getSegmentReference,\n    initSegmentReference: init,\n    presentationTimeOffset: info.presentationTimeOffset\n  };\n};\n\n\n/**\n * @typedef {{\n *   timescale: number,\n *   segmentDuration: ?number,\n *   startNumber: number,\n *   presentationTimeOffset: number,\n *   unscaledPresentationTimeOffset: number,\n *   timeline: Array.<shaka.dash.MpdUtils.TimeRange>,\n *   mediaTemplate: ?string,\n *   indexTemplate: ?string\n * }}\n * @private\n *\n * @description\n * Contains information about a SegmentTemplate.\n *\n * @property {number} timescale\n *   The time-scale of the representation.\n * @property {?number} segmentDuration\n *   The duration of the segments in seconds, if given.\n * @property {number} startNumber\n *   The start number of the segments; 1 or greater.\n * @property {number} presentationTimeOffset\n *   The presentationTimeOffset of the representation, in seconds.\n * @property {number} unscaledPresentationTimeOffset\n *   The presentationTimeOffset of the representation, in timescale units.\n * @property {Array.<shaka.dash.MpdUtils.TimeRange>} timeline\n *   The timeline of the representation, if given.  Times in seconds.\n * @property {?string} mediaTemplate\n *   The media URI template, if given.\n * @property {?string} indexTemplate\n *   The index URI template, if given.\n */\nshaka.dash.SegmentTemplate.SegmentTemplateInfo;\n\n\n/**\n * @param {?shaka.dash.DashParser.InheritanceFrame} frame\n * @return {Element}\n * @private\n */\nshaka.dash.SegmentTemplate.fromInheritance_ = function(frame) {\n  return frame.segmentTemplate;\n};\n\n\n/**\n * Parses a SegmentTemplate element into an info object.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @return {shaka.dash.SegmentTemplate.SegmentTemplateInfo}\n * @private\n */\nshaka.dash.SegmentTemplate.parseSegmentTemplateInfo_ = function(context) {\n  var SegmentTemplate = shaka.dash.SegmentTemplate;\n  var MpdUtils = shaka.dash.MpdUtils;\n  var segmentInfo =\n      MpdUtils.parseSegmentInfo(context, SegmentTemplate.fromInheritance_);\n\n  var media = MpdUtils.inheritAttribute(\n      context, SegmentTemplate.fromInheritance_, 'media');\n  var index = MpdUtils.inheritAttribute(\n      context, SegmentTemplate.fromInheritance_, 'index');\n\n  return {\n    segmentDuration: segmentInfo.segmentDuration,\n    timescale: segmentInfo.timescale,\n    startNumber: segmentInfo.startNumber,\n    presentationTimeOffset: segmentInfo.presentationTimeOffset,\n    unscaledPresentationTimeOffset: segmentInfo.unscaledPresentationTimeOffset,\n    timeline: segmentInfo.timeline,\n    mediaTemplate: media,\n    indexTemplate: index\n  };\n};\n\n\n/**\n * Verifies a SegmentTemplate info object.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.SegmentTemplate.SegmentTemplateInfo} info\n * @throws shaka.util.Error When there is a parsing error.\n * @private\n */\nshaka.dash.SegmentTemplate.checkSegmentTemplateInfo_ = function(context, info) {\n  var n = 0;\n  n += info.indexTemplate ? 1 : 0;\n  n += info.timeline ? 1 : 0;\n  n += info.segmentDuration ? 1 : 0;\n\n  if (n == 0) {\n    shaka.log.error(\n        'SegmentTemplate does not contain any segment information:',\n        'the SegmentTemplate must contain either an index URL template',\n        'a SegmentTimeline, or a segment duration.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);\n  } else if (n != 1) {\n    shaka.log.warning(\n        'SegmentTemplate containes multiple segment information sources:',\n        'the SegmentTemplate should only contain an index URL template,',\n        'a SegmentTimeline or a segment duration.',\n        context.representation);\n    if (info.indexTemplate) {\n      shaka.log.info('Using the index URL template by default.');\n      info.timeline = null;\n      info.segmentDuration = null;\n    } else {\n      goog.asserts.assert(info.timeline, 'There should be a timeline');\n      shaka.log.info('Using the SegmentTimeline by default.');\n      info.segmentDuration = null;\n    }\n  }\n\n  if (!info.indexTemplate && !info.mediaTemplate) {\n    shaka.log.error(\n        'SegmentTemplate does not contain sufficient segment information:',\n        'the SegmentTemplate\\'s media URL template is missing.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);\n  }\n};\n\n\n/**\n * Creates segment index functions from a index URL template.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.DashParser.RequestInitSegmentCallback} requestInitSegment\n * @param {shaka.media.InitSegmentReference} init\n * @param {shaka.dash.SegmentTemplate.SegmentTemplateInfo} info\n * @throws shaka.util.Error When there is a parsing error.\n * @return {shaka.dash.DashParser.SegmentIndexFunctions}\n * @private\n */\nshaka.dash.SegmentTemplate.createFromIndexTemplate_ = function(\n    context, requestInitSegment, init, info) {\n  var MpdUtils = shaka.dash.MpdUtils;\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n\n  // Determine the container type.\n  var containerType = context.representation.mimeType.split('/')[1];\n  if ((containerType != 'mp4') && (containerType != 'webm')) {\n    shaka.log.error(\n        'SegmentTemplate specifies an unsupported container type.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_UNSUPPORTED_CONTAINER);\n  }\n\n  if ((containerType == 'webm') && !init) {\n    shaka.log.error(\n        'SegmentTemplate does not contain sufficient segment information:',\n        'the SegmentTemplate uses a WebM container,',\n        'but does not contain an initialization URL template.',\n        context.representation);\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_WEBM_MISSING_INIT);\n  }\n\n  goog.asserts.assert(info.indexTemplate, 'must be using index template');\n  var filledTemplate = MpdUtils.fillUriTemplate(\n      info.indexTemplate, context.representation.id,\n      null, context.bandwidth || null, null);\n\n  var resolvedUris = ManifestParserUtils.resolveUris(\n      context.representation.baseUris, [filledTemplate]);\n\n  return shaka.dash.SegmentBase.createSegmentIndexFromUris(\n      context, requestInitSegment, init, resolvedUris, 0, null, containerType,\n      info.presentationTimeOffset);\n};\n\n\n/**\n * Creates segment index functions from a segment duration.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.SegmentTemplate.SegmentTemplateInfo} info\n * @return {shaka.dash.DashParser.SegmentIndexFunctions}\n * @private\n */\nshaka.dash.SegmentTemplate.createFromDuration_ = function(context, info) {\n  goog.asserts.assert(info.mediaTemplate,\n                      'There should be a media template with duration');\n  var MpdUtils = shaka.dash.MpdUtils;\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n\n  var periodDuration = context.periodInfo.duration;\n  var segmentDuration = info.segmentDuration;\n  var startNumber = info.startNumber;\n  var timescale = info.timescale;\n\n  var template = info.mediaTemplate;\n  var bandwidth = context.bandwidth || null;\n  var id = context.representation.id;\n  var baseUris = context.representation.baseUris;\n\n  var find = function(periodTime) {\n    if (periodTime < 0)\n      return null;\n    else if (periodDuration && periodTime >= periodDuration)\n      return null;\n\n    return Math.floor(periodTime / segmentDuration);\n  };\n  var get = function(position) {\n    var segmentStart = position * segmentDuration;\n\n    // Do not construct segments references that should not exist.\n    if (segmentStart < 0)\n      return null;\n    else if (periodDuration && segmentStart >= periodDuration)\n      return null;\n\n    var getUris = function() {\n      var mediaUri = MpdUtils.fillUriTemplate(\n          template, id, position + startNumber, bandwidth,\n          segmentStart * timescale);\n      return ManifestParserUtils.resolveUris(baseUris, [mediaUri]);\n    };\n\n    return new shaka.media.SegmentReference(\n        position, segmentStart, segmentStart + segmentDuration, getUris, 0,\n        null);\n  };\n\n  return {\n    createSegmentIndex: Promise.resolve.bind(Promise),\n    findSegmentPosition: find,\n    getSegmentReference: get\n  };\n};\n\n\n/**\n * Creates segment references from a timeline.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.SegmentTemplate.SegmentTemplateInfo} info\n * @return {!Array.<!shaka.media.SegmentReference>}\n * @private\n */\nshaka.dash.SegmentTemplate.createFromTimeline_ = function(context, info) {\n  goog.asserts.assert(info.mediaTemplate,\n                      'There should be a media template with a timeline');\n  var MpdUtils = shaka.dash.MpdUtils;\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n\n  /** @type {!Array.<!shaka.media.SegmentReference>} */\n  var references = [];\n  for (var i = 0; i < info.timeline.length; i++) {\n    var start = info.timeline[i].start;\n    var unscaledStart = info.timeline[i].unscaledStart;\n    var end = info.timeline[i].end;\n\n    // Note: i = k - 1, where k indicates the k'th segment listed in the MPD.\n    // (See section 5.3.9.5.3 of the DASH spec.)\n    var segmentReplacement = i + info.startNumber;\n\n    // Consider the presentation time offset in segment uri computation\n    var timeReplacement = unscaledStart +\n        info.unscaledPresentationTimeOffset;\n    var createUris = (function(\n            template, repId, bandwidth, baseUris, segmentId, time) {\n          var mediaUri = MpdUtils.fillUriTemplate(\n              template, repId, segmentId, bandwidth, time);\n          return ManifestParserUtils.resolveUris(baseUris, [mediaUri])\n              .map(function(g) { return g.toString(); });\n        }.bind(null, info.mediaTemplate, context.representation.id,\n               context.bandwidth || null, context.representation.baseUris,\n               segmentReplacement, timeReplacement));\n\n    references.push(new shaka.media.SegmentReference(\n        segmentReplacement, start, end, createUris, 0, null));\n  }\n\n  return references;\n};\n\n\n/**\n * Creates an init segment reference from a context object.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @return {shaka.media.InitSegmentReference}\n * @private\n */\nshaka.dash.SegmentTemplate.createInitSegment_ = function(context) {\n  var MpdUtils = shaka.dash.MpdUtils;\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n  var SegmentTemplate = shaka.dash.SegmentTemplate;\n\n  var initialization = MpdUtils.inheritAttribute(\n      context, SegmentTemplate.fromInheritance_, 'initialization');\n  if (!initialization)\n    return null;\n\n  var repId = context.representation.id;\n  var bandwidth = context.bandwidth || null;\n  var baseUris = context.representation.baseUris;\n  var getUris = function() {\n    goog.asserts.assert(initialization, 'Should have returned earler');\n    var filledTemplate = MpdUtils.fillUriTemplate(\n        initialization, repId, null, bandwidth, null);\n    var resolvedUris = ManifestParserUtils.resolveUris(\n        baseUris, [filledTemplate]);\n    return resolvedUris;\n  };\n\n  return new shaka.media.InitSegmentReference(getUris, 0, null);\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/dash/segment_template.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.ManifestParser');\n\ngoog.require('goog.Uri');\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.util.Error');\n\n\n/**\n * @namespace shaka.media.ManifestParser\n * @summary An interface to register manifest parsers.\n * @exportDoc\n */\n\n\n/**\n * Contains the parser factory functions indexed by MIME type.\n *\n * @type {!Object.<string, shakaExtern.ManifestParser.Factory>}\n */\nshaka.media.ManifestParser.parsersByMime = {};\n\n\n/**\n * Contains the parser factory functions indexed by file extension.\n *\n * @type {!Object.<string, shakaExtern.ManifestParser.Factory>}\n */\nshaka.media.ManifestParser.parsersByExtension = {};\n\n\n/**\n * Registers a manifest parser by file extension.\n *\n * @param {string} extension The file extension of the manifest.\n * @param {shakaExtern.ManifestParser.Factory} parserFactory The factory\n *   used to create parser instances.\n * @export\n */\nshaka.media.ManifestParser.registerParserByExtension = function(\n    extension, parserFactory) {\n  shaka.media.ManifestParser.parsersByExtension[extension] = parserFactory;\n};\n\n\n/**\n * Registers a manifest parser by MIME type.\n *\n * @param {string} mimeType The MIME type of the manifest.\n * @param {shakaExtern.ManifestParser.Factory} parserFactory The factory\n *   used to create parser instances.\n * @export\n */\nshaka.media.ManifestParser.registerParserByMime = function(\n    mimeType, parserFactory) {\n  shaka.media.ManifestParser.parsersByMime[mimeType] = parserFactory;\n};\n\n\n/**\n * Returns a map of manifest support for well-known types.\n *\n * @return {!Object.<string, boolean>}\n */\nshaka.media.ManifestParser.probeSupport = function() {\n  // Make sure all registered parsers are shown.\n  var support = {};\n  for (var type in shaka.media.ManifestParser.parsersByMime) {\n    support[type] = true;\n  }\n  for (var type in shaka.media.ManifestParser.parsersByExtension) {\n    support[type] = true;\n  }\n\n  // Make sure all well-known types are tested as well, just to show an explicit\n  // false for things people might be expecting.\n  var testMimeTypes = [\n    // DASH\n    'application/dash+xml',\n    // HLS\n    'application/x-mpegurl',\n    'application/vnd.apple.mpegurl',\n    // SmoothStreaming\n    'application/vnd.ms-sstr+xml'\n  ];\n  var testExtensions = [\n    // DASH\n    'mpd',\n    // HLS\n    'm3u8',\n    // SmoothStreaming\n    'ism'\n  ];\n\n  testMimeTypes.forEach(function(type) {\n    support[type] = !!shaka.media.ManifestParser.parsersByMime[type];\n  });\n  testExtensions.forEach(function(type) {\n    support[type] = !!shaka.media.ManifestParser.parsersByExtension[type];\n  });\n\n  return support;\n};\n\n\n/**\n * Finds a manifest parser factory to parse the given manifest.\n *\n * @param {string} manifestUri\n * @param {!shaka.net.NetworkingEngine} netEngine\n * @param {shakaExtern.RetryParameters} retryParams\n * @param {shakaExtern.ManifestParser.Factory=} opt_manifestParserFactory\n * @return {!Promise.<shakaExtern.ManifestParser.Factory>}\n */\nshaka.media.ManifestParser.getFactory = function(\n    manifestUri, netEngine, retryParams, opt_manifestParserFactory) {\n  var factory = opt_manifestParserFactory;\n  var extension;\n\n  if (!factory) {\n    // Try to choose a manifest parser by file extension.\n    var uriObj = new goog.Uri(manifestUri);\n    var uriPieces = uriObj.getPath().split('/');\n    var uriFilename = uriPieces.pop();\n    var filenamePieces = uriFilename.split('.');\n    // Only one piece means there is no extension.\n    if (filenamePieces.length > 1) {\n      extension = filenamePieces.pop().toLowerCase();\n      factory = shaka.media.ManifestParser.parsersByExtension[extension];\n    }\n  }\n\n  if (factory)\n    return Promise.resolve(factory);\n\n  // Try to choose a manifest parser by MIME type.\n  var headRequest =\n      shaka.net.NetworkingEngine.makeRequest([manifestUri], retryParams);\n  headRequest.method = 'HEAD';\n  var type = shaka.net.NetworkingEngine.RequestType.MANIFEST;\n\n  return netEngine.request(type, headRequest).then(\n      function(response) {\n        var mimeType = response.headers['content-type'];\n        // https://goo.gl/yzKDRx says this header should always be available,\n        // but just to be safe:\n        if (mimeType) {\n          mimeType = mimeType.toLowerCase();\n        }\n        factory = shaka.media.ManifestParser.parsersByMime[mimeType];\n        if (!factory) {\n          shaka.log.error(\n              'Unable to guess manifest type by file extension ' +\n              'or by MIME type.', extension, mimeType);\n          return Promise.reject(new shaka.util.Error(\n              shaka.util.Error.Severity.CRITICAL,\n              shaka.util.Error.Category.MANIFEST,\n              shaka.util.Error.Code.UNABLE_TO_GUESS_MANIFEST_TYPE,\n              manifestUri));\n        }\n        return factory;\n      }, function(error) {\n        goog.asserts.assert(error instanceof shaka.util.Error,\n                            'Incorrect error type');\n        shaka.log.error('HEAD request to guess manifest type failed!', error);\n        error.severity = shaka.util.Error.Severity.CRITICAL;\n        return Promise.reject(error);\n      });\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/manifest_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.PresentationTimeline');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.SegmentReference');\n\n\n\n/**\n * Creates a PresentationTimeline.\n *\n * @param {?number} presentationStartTime The wall-clock time, in seconds,\n *   when the presentation started or will start. Only required for live.\n * @param {number} presentationDelay The delay to give the presentation, in\n *   seconds.  Only required for live.\n *\n * @see {shakaExtern.Manifest}\n * @see {@tutorial architecture}\n *\n * @constructor\n * @struct\n * @export\n */\nshaka.media.PresentationTimeline = function(\n    presentationStartTime, presentationDelay) {\n  /** @private {?number} */\n  this.presentationStartTime_ = presentationStartTime;\n\n  /** @private {number} */\n  this.presentationDelay_ = presentationDelay;\n\n  /** @private {number} */\n  this.duration_ = Infinity;\n\n  /** @private {number} */\n  this.segmentAvailabilityDuration_ = Infinity;\n\n  /** @private {?number} */\n  this.maxSegmentDuration_ = 1;\n\n  /** @private {number} */\n  this.clockOffset_ = 0;\n\n  /** @private {boolean} */\n  this.static_ = true;\n};\n\n\n/**\n * @return {number} The presentation's duration in seconds.\n *   Infinity indicates that the presentation continues indefinitely.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.getDuration = function() {\n  return this.duration_;\n};\n\n\n/**\n * Sets the presentation's duration.\n *\n * @param {number} duration The presentation's duration in seconds.\n *   Infinity indicates that the presentation continues indefinitely.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.setDuration = function(duration) {\n  goog.asserts.assert(duration > 0, 'duration must be > 0');\n  this.duration_ = duration;\n};\n\n\n/**\n * @return {?number} The presentation's start time in seconds.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.getPresentationStartTime =\n    function() {\n  return this.presentationStartTime_;\n};\n\n\n/**\n * Sets the clock offset, which is the the difference between the client's clock\n * and the server's clock, in milliseconds (i.e., serverTime = Date.now() +\n * clockOffset).\n *\n * @param {number} offset The clock offset, in ms.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.setClockOffset = function(offset) {\n  this.clockOffset_ = offset;\n};\n\n\n/**\n * Sets the presentation's static flag.\n *\n * @param {boolean} isStatic If true, the presentation is static, meaning all\n *   segments are available at once.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.setStatic = function(isStatic) {\n  // NOTE: the argument name is not \"static\" because that's a keyword in ES6\n  this.static_ = isStatic;\n};\n\n\n/**\n * Gets the presentation's segment availability duration, which is the amount\n * of time, in seconds, that the start of a segment remains available after the\n * live-edge moves past the end of that segment. Infinity indicates that\n * segments remain available indefinitely. For example, if your live\n * presentation has a 5 minute DVR window and your segments are 10 seconds long\n * then the segment availability duration should be 4 minutes and 50 seconds.\n *\n * @return {number} The presentation's segment availability duration.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.getSegmentAvailabilityDuration =\n    function() {\n  return this.segmentAvailabilityDuration_;\n};\n\n\n/**\n * Sets the presentation's segment availability duration. The segment\n * availability duration should only be set for live.\n *\n * @param {number} segmentAvailabilityDuration The presentation's new segment\n *   availability duration in seconds.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.setSegmentAvailabilityDuration =\n    function(segmentAvailabilityDuration) {\n  goog.asserts.assert(segmentAvailabilityDuration >= 0,\n                      'segmentAvailabilityDuration must be >= 0');\n  this.segmentAvailabilityDuration_ = segmentAvailabilityDuration;\n};\n\n\n/**\n * Gives PresentationTimeline a Stream's segments so it can size and position\n * the segment availability window, and account for missing segment\n * information. This function should be called once for each Stream (no more,\n * no less).\n *\n * @param {number} periodStartTime\n * @param {!Array.<!shaka.media.SegmentReference>} references\n * @export\n */\nshaka.media.PresentationTimeline.prototype.notifySegments = function(\n    periodStartTime, references) {\n  if (references.length == 0)\n    return;\n\n  this.maxSegmentDuration_ = references.reduce(\n      function(max, r) { return Math.max(max, r.endTime - r.startTime); },\n      this.maxSegmentDuration_);\n\n  shaka.log.v1('notifySegments:',\n               'maxSegmentDuration=' + this.maxSegmentDuration_);\n};\n\n\n/**\n * Gives PresentationTimeline a Stream's maximum segment duration so it can\n * size and position the segment availability window. This function should be\n * called once for each Stream (no more, no less), but does not have to be\n * called if notifySegments() is called instead for a particular stream.\n *\n * @param {number} maxSegmentDuration The maximum segment duration for a\n *   particular stream.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.notifyMaxSegmentDuration = function(\n    maxSegmentDuration) {\n  this.maxSegmentDuration_ = Math.max(\n      this.maxSegmentDuration_, maxSegmentDuration);\n\n  shaka.log.v1('notifyNewSegmentDuration:',\n               'maxSegmentDuration=' + this.maxSegmentDuration_);\n};\n\n\n/**\n * @return {boolean} True if the presentation is live; otherwise, return\n *   false.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.isLive = function() {\n  return this.duration_ == Infinity &&\n         !this.static_;\n};\n\n\n/**\n * @return {boolean} True if the presentation is in progress (meaning not live,\n *   but also not completely available); otherwise, return false.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.isInProgress = function() {\n  return this.duration_ != Infinity &&\n         !this.static_;\n};\n\n\n/**\n * Gets the presentation's current segment availability start time. Segments\n * ending at or before this time should be assumed to be unavailable.\n *\n * @return {number} The current segment availability start time, in seconds,\n *   relative to the start of the presentation.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.getSegmentAvailabilityStart =\n    function() {\n  return this.getSafeAvailabilityStart(0 /* delay */);\n};\n\n\n/**\n * Gets the presentation's current segment availability start time, offset by\n * the given amount.  This is used to ensure that we don't \"fall\" back out of\n * the availability window while we are buffering.\n *\n * @param {number} offset The offset to add to the start time.\n * @return {number} The current segment availability start time, in seconds,\n *   relative to the start of the presentation.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.getSafeAvailabilityStart =\n    function(offset) {\n  if (this.segmentAvailabilityDuration_ == Infinity)\n    return 0;\n\n  var end = this.getSegmentAvailabilityEnd();\n  var start = Math.min(end - this.segmentAvailabilityDuration_ + offset, end);\n  return Math.max(0, start);\n};\n\n\n/**\n * Gets the presentation's current segment availability end time. Segments\n * starting after this time should be assumed to be unavailable.\n *\n * @return {number} The current segment availability end time, in seconds,\n *   relative to the start of the presentation. Always returns the\n *   presentation's duration for video-on-demand.\n * @export\n */\nshaka.media.PresentationTimeline.prototype.getSegmentAvailabilityEnd =\n    function() {\n  if (!this.isLive() && !this.isInProgress())\n    return this.duration_;\n\n  return Math.min(this.getLiveEdge_(), this.duration_);\n};\n\n\n/**\n * Gets the seek range end.\n *\n * @return {number}\n * @export\n */\nshaka.media.PresentationTimeline.prototype.getSeekRangeEnd = function() {\n  var useDelay = this.isLive() || this.isInProgress();\n  var delay = useDelay ? this.presentationDelay_ : 0;\n  return Math.max(0, this.getSegmentAvailabilityEnd() - delay);\n};\n\n\n/**\n * @return {number} The current presentation time in seconds.\n * @private\n */\nshaka.media.PresentationTimeline.prototype.getLiveEdge_ = function() {\n  goog.asserts.assert(this.presentationStartTime_ != null,\n                      'Cannot compute timeline live edge without start time');\n  var now = (Date.now() + this.clockOffset_) / 1000.0;\n  return Math.max(\n      0, now - this.maxSegmentDuration_ - this.presentationStartTime_);\n};\n\n\nif (!COMPILED) {\n  /**\n   * Debug only: assert that the timeline parameters make sense for the type of\n   *   presentation (VOD, IPR, live).\n   */\n  shaka.media.PresentationTimeline.prototype.assertIsValid = function() {\n    if (this.isLive()) {\n      // Implied by isLive(): infinite and dynamic.\n      // Live streams should have a start time.\n      goog.asserts.assert(this.presentationStartTime_ != null,\n          'Detected as live stream, but does not match our model of live!');\n    } else if (this.isInProgress()) {\n      // Implied by isInProgress(): finite and dynamic.\n      // IPR streams should have a start time, and segments should not expire.\n      goog.asserts.assert(this.presentationStartTime_ != null &&\n                          this.segmentAvailabilityDuration_ == Infinity,\n          'Detected as IPR stream, but does not match our model of IPR!');\n    } else {  // VOD\n      // VOD segments should not expire and the presentation should be finite\n      // and static.\n      goog.asserts.assert(this.segmentAvailabilityDuration_ == Infinity &&\n                          this.duration_ != Infinity &&\n                          this.static_,\n          'Detected as VOD stream, but does not match our model of VOD!');\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/presentation_timeline.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.dash.DashParser');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.dash.ContentProtection');\ngoog.require('shaka.dash.SegmentBase');\ngoog.require('shaka.dash.SegmentList');\ngoog.require('shaka.dash.SegmentTemplate');\ngoog.require('shaka.log');\ngoog.require('shaka.media.DrmEngine');\ngoog.require('shaka.media.ManifestParser');\ngoog.require('shaka.media.PresentationTimeline');\ngoog.require('shaka.media.SegmentReference');\ngoog.require('shaka.media.TextEngine');\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.LanguageUtils');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.StreamUtils');\ngoog.require('shaka.util.StringUtils');\ngoog.require('shaka.util.XmlUtils');\n\n\n\n/**\n * Creates a new DASH parser.\n *\n * @struct\n * @constructor\n * @implements {shakaExtern.ManifestParser}\n * @export\n */\nshaka.dash.DashParser = function() {\n  /** @private {?shakaExtern.ManifestConfiguration} */\n  this.config_ = null;\n\n  /** @private {?shakaExtern.ManifestParser.PlayerInterface} */\n  this.playerInterface_ = null;\n\n  /** @private {!Array.<string>} */\n  this.manifestUris_ = [];\n\n  /** @private {?shakaExtern.Manifest} */\n  this.manifest_ = null;\n\n  /** @private {!Array.<string>} */\n  this.periodIds_ = [];\n\n  /** @private {number} */\n  this.globalId_ = 1;\n\n  /**\n   * A map of IDs to SegmentIndex objects.\n   * ID: Period@id,AdaptationSet@id,@Representation@id\n   * e.g.: '1,5,23'\n   * @private {!Object.<string, !shaka.media.SegmentIndex>}\n   */\n  this.segmentIndexMap_ = {};\n\n  /**\n   * The update period in seconds; or 0 for no updates.\n   * @private {number}\n   */\n  this.updatePeriod_ = 0;\n\n  /** @private {?number} */\n  this.updateTimer_ = null;\n};\n\n\n/**\n * Contains the minimum amount of time, in seconds, between manifest update\n * requests.\n *\n * @private\n * @const {number}\n */\nshaka.dash.DashParser.MIN_UPDATE_PERIOD_ = 3;\n\n\n/**\n * The default MPD@suggestedPresentationDelay in seconds.\n *\n * @private\n * @const {number}\n */\nshaka.dash.DashParser.DEFAULT_SUGGESTED_PRESENTATION_DELAY_ = 10;\n\n\n/**\n * @typedef {\n *   !function(!Array.<string>, ?number, ?number):!Promise.<!ArrayBuffer>\n * }\n */\nshaka.dash.DashParser.RequestInitSegmentCallback;\n\n\n/**\n * @typedef {{\n *   segmentBase: Element,\n *   segmentList: Element,\n *   segmentTemplate: Element,\n *   baseUris: !Array.<string>,\n *   width: (number|undefined),\n *   height: (number|undefined),\n *   contentType: string,\n *   mimeType: string,\n *   codecs: string,\n *   frameRate: (number|undefined),\n *   containsEmsgBoxes: boolean,\n *   id: string\n * }}\n *\n * @description\n * A collection of elements and properties which are inherited across levels\n * of a DASH manifest.\n *\n * @property {Element} segmentBase\n *   The XML node for SegmentBase.\n * @property {Element} segmentList\n *   The XML node for SegmentList.\n * @property {Element} segmentTemplate\n *   The XML node for SegmentTemplate.\n * @property {!Array.<string>} baseUris\n *   An array of absolute base URIs for the frame.\n * @property {(number|undefined)} width\n *   The inherited width value.\n * @property {(number|undefined)} height\n *   The inherited height value.\n * @property {string} contentType\n *   The inherited media type.\n * @property {string} mimeType\n *   The inherited MIME type value.\n * @property {string} codecs\n *   The inherited codecs value.\n * @property {(number|undefined)} frameRate\n *   The inherited framerate value.\n * @property {boolean} containsEmsgBoxes\n *   Whether there are 'emsg' boxes.\n * @property {string} id\n *   The ID of the element.\n */\nshaka.dash.DashParser.InheritanceFrame;\n\n\n/**\n * @typedef {{\n *   dynamic: boolean,\n *   presentationTimeline: !shaka.media.PresentationTimeline,\n *   period: ?shaka.dash.DashParser.InheritanceFrame,\n *   periodInfo: ?shaka.dash.DashParser.PeriodInfo,\n *   adaptationSet: ?shaka.dash.DashParser.InheritanceFrame,\n *   representation: ?shaka.dash.DashParser.InheritanceFrame,\n *   bandwidth: (number|undefined),\n *   indexRangeWarningGiven: boolean\n * }}\n *\n * @description\n * Contains context data for the streams.\n *\n * @property {boolean} dynamic\n *   True if the MPD is dynamic (not all segments available at once)\n * @property {!shaka.media.PresentationTimeline} presentationTimeline\n *   The PresentationTimeline.\n * @property {?shaka.dash.DashParser.InheritanceFrame} period\n *   The inheritance from the Period element.\n * @property {?shaka.dash.DashParser.PeriodInfo} periodInfo\n *   The Period info for the current Period.\n * @property {?shaka.dash.DashParser.InheritanceFrame} adaptationSet\n *   The inheritance from the AdaptationSet element.\n * @property {?shaka.dash.DashParser.InheritanceFrame} representation\n *   The inheritance from the Representation element.\n * @property {(number|undefined)} bandwidth\n *   The bandwidth of the Representation.\n * @property {boolean} indexRangeWarningGiven\n *   True if the warning about SegmentURL@indexRange has been printed.\n */\nshaka.dash.DashParser.Context;\n\n\n/**\n * @typedef {{\n *   start: number,\n *   duration: ?number,\n *   node: !Element,\n *   isLastPeriod: boolean\n * }}\n *\n * @description\n * Contains information about a Period element.\n *\n * @property {number} start\n *   The start time of the period.\n * @property {?number} duration\n *   The duration of the period; or null if the duration is not given.  This\n *   will be non-null for all periods except the last.\n * @property {!Element} node\n *   The XML Node for the Period.\n * @property {boolean} isLastPeriod\n *   Whether this Period is the last one in the manifest.\n */\nshaka.dash.DashParser.PeriodInfo;\n\n\n/**\n * @typedef {{\n *   id: string,\n *   contentType: ?string,\n *   language: string,\n *   main: boolean,\n *   streams: !Array.<shakaExtern.Stream>,\n *   drmInfos: !Array.<shakaExtern.DrmInfo>,\n *   trickModeFor: ?string,\n *   representationIds: !Array.<string>\n * }}\n *\n * @description\n * Contains information about an AdaptationSet element.\n *\n * @property {string} id\n *   The unique ID of the adaptation set.\n * @property {?string} contentType\n *   The content type of the AdaptationSet.\n * @property {string} language\n *   The language of the AdaptationSet.\n * @property {boolean} main\n *   Whether the AdaptationSet has the 'main' type.\n * @property {!Array.<shakaExtern.Stream>} streams\n *   The streams this AdaptationSet contains.\n * @property {!Array.<shakaExtern.DrmInfo>} drmInfos\n *   The DRM info for the AdaptationSet.\n * @property {?string} trickModeFor\n *   If non-null, this AdaptationInfo represents trick mode tracks.  This\n *   property is the ID of the normal AdaptationSet these tracks should be\n *   associated with.\n * @property {!Array.<string>} representationIds\n *   An array of the IDs of the Representations this AdaptationSet contains.\n */\nshaka.dash.DashParser.AdaptationInfo;\n\n\n/**\n * @typedef {{\n *   createSegmentIndex: shakaExtern.CreateSegmentIndexFunction,\n *   findSegmentPosition: shakaExtern.FindSegmentPositionFunction,\n *   getSegmentReference: shakaExtern.GetSegmentReferenceFunction\n * }}\n *\n * @description\n * Contains functions used to create and find segment references.\n *\n * @property {shakaExtern.CreateSegmentIndexFunction} createSegmentIndex\n *   The createSegmentIndex function.\n * @property {shakaExtern.FindSegmentPositionFunction} findSegmentPosition\n *   The findSegmentPosition function.\n * @property {shakaExtern.GetSegmentReferenceFunction} getSegmentReference\n *   The getSegmentReference function.\n */\nshaka.dash.DashParser.SegmentIndexFunctions;\n\n\n/**\n * @typedef {{\n *   createSegmentIndex: shakaExtern.CreateSegmentIndexFunction,\n *   findSegmentPosition: shakaExtern.FindSegmentPositionFunction,\n *   getSegmentReference: shakaExtern.GetSegmentReferenceFunction,\n *   initSegmentReference: shaka.media.InitSegmentReference,\n *   presentationTimeOffset: (number|undefined)\n * }}\n *\n * @description\n * Contains information about a Stream.  This is passed from the createStream\n * methods.\n *\n * @property {shakaExtern.CreateSegmentIndexFunction} createSegmentIndex\n *   The createSegmentIndex function for the stream.\n * @property {shakaExtern.FindSegmentPositionFunction} findSegmentPosition\n *   The findSegmentPosition function for the stream.\n * @property {shakaExtern.GetSegmentReferenceFunction} getSegmentReference\n *   The getSegmentReference function for the stream.\n * @property {shaka.media.InitSegmentReference} initSegmentReference\n *   The init segment for the stream.\n * @property {(number|undefined)} presentationTimeOffset\n *   The presentationTimeOffset for the stream.\n */\nshaka.dash.DashParser.StreamInfo;\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.dash.DashParser.prototype.configure = function(config) {\n  goog.asserts.assert(config.dash != null,\n                      'DashManifestConfiguration should not be null!');\n\n  this.config_ = config;\n};\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.dash.DashParser.prototype.start = function(uri, playerInterface) {\n  goog.asserts.assert(this.config_, 'Must call configure() before start()!');\n  this.manifestUris_ = [uri];\n  this.playerInterface_ = playerInterface;\n  return this.requestManifest_().then(function() {\n    if (this.playerInterface_)\n      this.setUpdateTimer_(0);\n    return this.manifest_;\n  }.bind(this));\n};\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.dash.DashParser.prototype.stop = function() {\n  this.playerInterface_ = null;\n  this.config_ = null;\n\n  this.manifestUris_ = [];\n  this.manifest_ = null;\n  this.periodIds_ = [];\n  this.segmentIndexMap_ = {};\n  if (this.updateTimer_ != null) {\n    window.clearTimeout(this.updateTimer_);\n    this.updateTimer_ = null;\n  }\n\n  return Promise.resolve();\n};\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.dash.DashParser.prototype.update = function() {\n  this.requestManifest_().catch(function(error) {\n    if (!this.playerInterface_) return;\n    this.playerInterface_.onError(error);\n  }.bind(this));\n};\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.dash.DashParser.prototype.onExpirationUpdated = function(\n    sessionId, expiration) {\n  // No-op\n};\n\n\n/**\n * Makes a network request for the manifest and parses the resulting data.\n *\n * @return {!Promise}\n * @private\n */\nshaka.dash.DashParser.prototype.requestManifest_ = function() {\n  var requestType = shaka.net.NetworkingEngine.RequestType.MANIFEST;\n  var request = shaka.net.NetworkingEngine.makeRequest(\n      this.manifestUris_, this.config_.retryParameters);\n  return this.playerInterface_.networkingEngine.request(requestType, request)\n      .then(function(response) {\n        // Detect calls to stop().\n        if (!this.playerInterface_)\n          return;\n\n        // This may throw; but it will result in a failed promise.\n        return this.parseManifest_(response.data, response.uri);\n      }.bind(this));\n};\n\n\n/**\n * Parses the manifest XML.  This also handles updates and will update the\n * stored manifest.\n *\n * @param {!ArrayBuffer} data\n * @param {string} finalManifestUri The final manifest URI, which may\n *   differ from this.manifestUri_ if there has been a redirect.\n * @return {!Promise}\n * @throws shaka.util.Error When there is a parsing error.\n * @private\n */\nshaka.dash.DashParser.prototype.parseManifest_ =\n    function(data, finalManifestUri) {\n  var Error = shaka.util.Error;\n  var Functional = shaka.util.Functional;\n  var XmlUtils = shaka.util.XmlUtils;\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n\n  var string = shaka.util.StringUtils.fromUTF8(data);\n  var parser = new DOMParser();\n  var xml = null;\n  var mpd = null;\n\n  try {\n    xml = parser.parseFromString(string, 'text/xml');\n  } catch (exception) {}\n  if (xml) {\n    // parseFromString returns a Document object.  A Document is a Node but not\n    // an Element, so it cannot be used in XmlUtils (technically it can but the\n    // types don't match).  The |documentElement| member defines the top-level\n    // element in the document.\n    if (xml.documentElement.tagName == 'MPD')\n      mpd = xml.documentElement;\n  }\n  if (mpd && mpd.getElementsByTagName('parsererror').length > 0)\n    mpd = null; // It had a parser error in it.\n  if (!mpd) {\n    throw new Error(\n        Error.Severity.CRITICAL, Error.Category.MANIFEST,\n        Error.Code.DASH_INVALID_XML);\n  }\n\n  // Get any Location elements.  This will update the manifest location and\n  // the base URI.\n  /** @type {!Array.<string>} */\n  var manifestBaseUris = [finalManifestUri];\n  /** @type {!Array.<string>} */\n  var locations = XmlUtils.findChildren(mpd, 'Location')\n                      .map(XmlUtils.getContents)\n                      .filter(Functional.isNotNull);\n  if (locations.length > 0) {\n    this.manifestUris_ = locations;\n    manifestBaseUris = locations;\n  }\n\n  var uris = XmlUtils.findChildren(mpd, 'BaseURL').map(XmlUtils.getContents);\n  var baseUris = ManifestParserUtils.resolveUris(manifestBaseUris, uris);\n\n  var minBufferTime =\n      XmlUtils.parseAttr(mpd, 'minBufferTime', XmlUtils.parseDuration);\n  this.updatePeriod_ = /** @type {number} */ (XmlUtils.parseAttr(\n      mpd, 'minimumUpdatePeriod', XmlUtils.parseDuration, -1));\n\n  var presentationStartTime = XmlUtils.parseAttr(\n      mpd, 'availabilityStartTime', XmlUtils.parseDate);\n  var segmentAvailabilityDuration = XmlUtils.parseAttr(\n      mpd, 'timeShiftBufferDepth', XmlUtils.parseDuration);\n  var suggestedPresentationDelay = XmlUtils.parseAttr(\n      mpd, 'suggestedPresentationDelay', XmlUtils.parseDuration);\n  var maxSegmentDuration = XmlUtils.parseAttr(\n      mpd, 'maxSegmentDuration', XmlUtils.parseDuration);\n  var mpdType = mpd.getAttribute('type') || 'static';\n\n  var presentationTimeline;\n  if (this.manifest_) {\n    presentationTimeline = this.manifest_.presentationTimeline;\n  } else {\n    // DASH IOP v3.0 suggests using a default delay between minBufferTime and\n    // timeShiftBufferDepth.  This is literally the range of all feasible\n    // choices for the value.  Nothing older than timeShiftBufferDepth is still\n    // available, and anything less than minBufferTime will cause buffering\n    // issues.\n    //\n    // We have decided that our default will be 1.5 * minBufferTime, or 10s,\n    // whichever is larger.  This is fairly conservative.  Content providers\n    // should provide a suggestedPresentationDelay whenever possible to optimize\n    // the live streaming experience.\n    var defaultPresentationDelay = Math.max(\n        shaka.dash.DashParser.DEFAULT_SUGGESTED_PRESENTATION_DELAY_,\n        minBufferTime * 1.5);\n    var presentationDelay = suggestedPresentationDelay != null ?\n        suggestedPresentationDelay : defaultPresentationDelay;\n    presentationTimeline = new shaka.media.PresentationTimeline(\n        presentationStartTime, presentationDelay);\n  }\n\n  /** @type {shaka.dash.DashParser.Context} */\n  var context = {\n    // Don't base on updatePeriod_ since emsg boxes can cause manifest updates.\n    dynamic: mpdType != 'static',\n    presentationTimeline: presentationTimeline,\n    period: null,\n    periodInfo: null,\n    adaptationSet: null,\n    representation: null,\n    bandwidth: undefined,\n    indexRangeWarningGiven: false\n  };\n\n  var periodsAndDuration = this.parsePeriods_(context, baseUris, mpd);\n  var duration = periodsAndDuration.duration;\n  var periods = periodsAndDuration.periods;\n\n  presentationTimeline.setStatic(mpdType == 'static');\n  presentationTimeline.setDuration(duration || Infinity);\n  presentationTimeline.setSegmentAvailabilityDuration(\n      segmentAvailabilityDuration != null ?\n      segmentAvailabilityDuration :\n      Infinity);\n  // Use @maxSegmentDuration to override smaller, derived values.\n  presentationTimeline.notifyMaxSegmentDuration(maxSegmentDuration || 1);\n  if (!COMPILED) presentationTimeline.assertIsValid();\n\n  if (this.manifest_) {\n    // This is a manifest update, so we're done.\n    return Promise.resolve();\n  }\n\n  // This is the first manifest parse, so we cannot return until we calculate\n  // the clock offset.\n  var timingElements = XmlUtils.findChildren(mpd, 'UTCTiming');\n\n  var isLive = presentationTimeline.isLive();\n\n  return this.parseUtcTiming_(\n      baseUris, timingElements, isLive).then(function(offset) {\n    // Detect calls to stop().\n    if (!this.playerInterface_)\n      return;\n\n    presentationTimeline.setClockOffset(offset);\n\n    this.manifest_ = {\n      presentationTimeline: presentationTimeline,\n      periods: periods,\n      offlineSessionIds: [],\n      minBufferTime: minBufferTime || 0\n    };\n  }.bind(this));\n};\n\n\n/**\n * Reads and parses the periods from the manifest.  This first does some\n * partial parsing so the start and duration is available when parsing children.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {!Array.<string>} baseUris\n * @param {!Element} mpd\n * @return {{periods: !Array.<shakaExtern.Period>, duration: ?number}}\n * @private\n */\nshaka.dash.DashParser.prototype.parsePeriods_ = function(\n    context, baseUris, mpd) {\n  var Functional = shaka.util.Functional;\n  var XmlUtils = shaka.util.XmlUtils;\n  var presentationDuration = XmlUtils.parseAttr(\n      mpd, 'mediaPresentationDuration', XmlUtils.parseDuration);\n\n  var periods = [];\n  var prevEnd = 0;\n  var periodNodes = XmlUtils.findChildren(mpd, 'Period');\n  for (var i = 0; i < periodNodes.length; i++) {\n    var elem = periodNodes[i];\n    var start = /** @type {number} */ (\n        XmlUtils.parseAttr(elem, 'start', XmlUtils.parseDuration, prevEnd));\n    var givenDuration =\n        XmlUtils.parseAttr(elem, 'duration', XmlUtils.parseDuration);\n\n    var periodDuration = null;\n    if (i != periodNodes.length - 1) {\n      // \"The difference between the start time of a Period and the start time\n      // of the following Period is the duration of the media content\n      // represented by this Period.\"\n      var nextPeriod = periodNodes[i + 1];\n      var nextStart =\n          XmlUtils.parseAttr(nextPeriod, 'start', XmlUtils.parseDuration);\n      if (nextStart != null)\n        periodDuration = nextStart - start;\n    } else if (presentationDuration != null) {\n      // \"The Period extends until the Period.start of the next Period, or\n      // until the end of the Media Presentation in the case of the last\n      // Period.\"\n      periodDuration = presentationDuration - start;\n    }\n\n    if (periodDuration && givenDuration && periodDuration != givenDuration) {\n      shaka.log.warning('There is a gap/overlap between Periods', elem);\n    }\n    // Only use the @duration in the MPD if we can't calculate it.  We should\n    // favor the @start of the following Period.  This ensures that there aren't\n    // gaps between Periods.\n    if (periodDuration == null)\n      periodDuration = givenDuration;\n\n\n    // Parse child nodes.\n    var info = {\n      start: start,\n      duration: periodDuration,\n      node: elem,\n      isLastPeriod: periodDuration == null || i == periodNodes.length - 1\n    };\n    var period = this.parsePeriod_(context, baseUris, info);\n    periods.push(period);\n\n    // If there are any new periods, call the callback and add them to the\n    // manifest.  If this is the first parse, it will see all of them as new.\n    var periodId = context.period.id;\n    if (this.periodIds_.every(Functional.isNotEqualFunc(periodId))) {\n      this.playerInterface_.filterPeriod(period);\n      this.periodIds_.push(periodId);\n      if (this.manifest_)\n        this.manifest_.periods.push(period);\n    }\n\n\n    if (periodDuration == null) {\n      if (i != periodNodes.length - 1) {\n        // If the duration is still null and we aren't at the end, then we will\n        // skip any remaining periods.\n        shaka.log.warning(\n            'Skipping Period', i + 1, 'and any subsequent Periods:', 'Period',\n            i + 1, 'does not have a valid start time.', periods[i + 1]);\n      }\n\n      // The duration is unknown, so the end is unknown.\n      prevEnd = null;\n      break;\n    }\n\n    prevEnd = start + periodDuration;\n  }\n\n  if (presentationDuration != null) {\n    if (prevEnd != presentationDuration) {\n      shaka.log.warning(\n          '@mediaPresentationDuration does not match the total duration of all',\n          'Periods.');\n      // Assume @mediaPresentationDuration is correct.\n    }\n    return {\n      periods: periods,\n      duration: presentationDuration\n    };\n  } else {\n    return {\n      periods: periods,\n      duration: prevEnd\n    };\n  }\n};\n\n\n/**\n * Parses a Period XML element.  Unlike the other parse methods, this is not\n * given the Node; it is given a PeriodInfo structure.  Also, partial parsing\n * was done before this was called so start and duration are valid.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {!Array.<string>} baseUris\n * @param {shaka.dash.DashParser.PeriodInfo} periodInfo\n * @return {shakaExtern.Period}\n * @throws shaka.util.Error When there is a parsing error.\n * @private\n */\nshaka.dash.DashParser.prototype.parsePeriod_ = function(\n    context, baseUris, periodInfo) {\n  var Functional = shaka.util.Functional;\n  var XmlUtils = shaka.util.XmlUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  context.period = this.createFrame_(periodInfo.node, null, baseUris);\n  context.periodInfo = periodInfo;\n\n  // If the period doesn't have an ID, give it one based on its start time.\n  if (!context.period.id) {\n    shaka.log.info(\n        'No Period ID given for Period with start time ' + periodInfo.start +\n        ',  Assigning a default');\n    context.period.id = '__shaka_period_' + periodInfo.start;\n  }\n\n  var eventStreamNodes = XmlUtils.findChildren(periodInfo.node, 'EventStream');\n  eventStreamNodes.forEach(\n      this.parseEventStream_.bind(this, periodInfo.start, periodInfo.duration));\n\n  var adaptationSetNodes =\n      XmlUtils.findChildren(periodInfo.node, 'AdaptationSet');\n  var adaptationSets = adaptationSetNodes\n      .map(this.parseAdaptationSet_.bind(this, context))\n      .filter(Functional.isNotNull);\n\n  var representationIds = adaptationSets\n      .map(function(as) { return as.representationIds; })\n      .reduce(Functional.collapseArrays, []);\n  var uniqueRepIds = representationIds.filter(Functional.isNotDuplicate);\n  if (context.dynamic && representationIds.length != uniqueRepIds.length) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_DUPLICATE_REPRESENTATION_ID);\n  }\n\n  var normalAdaptationSets = adaptationSets\n      .filter(function(as) { return !as.trickModeFor; });\n\n  var trickModeAdaptationSets = adaptationSets\n      .filter(function(as) { return as.trickModeFor; });\n\n  // Attach trick mode tracks to normal tracks.\n  trickModeAdaptationSets.forEach(function(trickModeSet) {\n    // There may be multiple trick mode streams, but we do not currently\n    // support that.  Just choose one.\n    var trickModeVideo = trickModeSet.streams[0];\n    var targetId = trickModeSet.trickModeFor;\n    normalAdaptationSets.forEach(function(normalSet) {\n      if (normalSet.id == targetId) {\n        normalSet.streams.forEach(function(stream) {\n          stream.trickModeVideo = trickModeVideo;\n        });\n      }\n    });\n  });\n\n  var videoSets = this.getSetsOfType_(normalAdaptationSets, ContentType.VIDEO);\n  var audioSets = this.getSetsOfType_(normalAdaptationSets, ContentType.AUDIO);\n\n  if (!videoSets.length && !audioSets.length) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_EMPTY_PERIOD);\n  }\n\n  // In case of audio-only or video-only content, we create an array of one item\n  // containing a null.  This way, the double-loop works for all kinds of\n  // content.\n  if (!audioSets.length) {\n    audioSets = [null];\n  }\n  if (!videoSets.length) {\n    videoSets = [null];\n  }\n\n  // TODO: Limit number of combinations. Come up with a heuristic\n  // to decide which audio tracks to combine with which video tracks.\n  var variants = [];\n  for (var i = 0; i < audioSets.length; i++) {\n    for (var j = 0; j < videoSets.length; j++) {\n      var audioSet = audioSets[i];\n      var videoSet = videoSets[j];\n      this.createVariants_(audioSet, videoSet, variants);\n    }\n  }\n\n  var textSets = this.getSetsOfType_(normalAdaptationSets, ContentType.TEXT);\n  var textStreams = [];\n  for (var i = 0; i < textSets.length; i++) {\n    textStreams.push.apply(textStreams, textSets[i].streams);\n  }\n\n  return {\n    startTime: periodInfo.start,\n    textStreams: textStreams,\n    variants: variants\n  };\n};\n\n\n/**\n * @param {!Array.<!shaka.dash.DashParser.AdaptationInfo>} adaptationSets\n * @param {string} type\n * @return {!Array.<!shaka.dash.DashParser.AdaptationInfo>}\n * @private\n */\nshaka.dash.DashParser.prototype.getSetsOfType_ = function(\n    adaptationSets, type) {\n  return adaptationSets.filter(function(as) {\n    return as.contentType == type;\n  });\n};\n\n\n/**\n * Combines Streams into Variants\n *\n * @param {?shaka.dash.DashParser.AdaptationInfo} audio\n * @param {?shaka.dash.DashParser.AdaptationInfo} video\n * @param {!Array.<shakaExtern.Variant>} variants New variants are pushed onto\n *   this array.\n * @private\n */\nshaka.dash.DashParser.prototype.createVariants_ =\n    function(audio, video, variants) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  // Since both audio and video are of the same type, this assertion will catch\n  // certain mistakes at runtime that the compiler would miss.\n  goog.asserts.assert(!audio || audio.contentType == ContentType.AUDIO,\n                      'Audio parameter mismatch!');\n  goog.asserts.assert(!video || video.contentType == ContentType.VIDEO,\n                      'Video parameter mismatch!');\n\n  /** @type {number} */\n  var bandwidth;\n  /** @type {shakaExtern.Variant} */\n  var variant;\n\n  if (!audio && !video) {\n    return;\n  } else if (audio && video) {\n    // Audio+video variants\n    var DrmEngine = shaka.media.DrmEngine;\n    if (DrmEngine.areDrmCompatible(audio.drmInfos, video.drmInfos)) {\n      var drmInfos = DrmEngine.getCommonDrmInfos(audio.drmInfos,\n                                                 video.drmInfos);\n\n      for (var i = 0; i < audio.streams.length; i++) {\n        for (var j = 0; j < video.streams.length; j++) {\n          // Explicit cast, followed by assertion.  These should both be defined\n          // in the case of DASH, but the type of Stream.bandwidth allows for\n          // undefined in order to support HLS.\n          bandwidth = /** @type {number} */(\n              video.streams[j].bandwidth +\n              audio.streams[i].bandwidth);\n          goog.asserts.assert(bandwidth,\n              'Bandwidth must be defined and non-zero!');\n          variant = {\n            id: this.globalId_++,\n            language: audio.language,\n            primary: audio.main || video.main,\n            audio: audio.streams[i],\n            video: video.streams[j],\n            bandwidth: bandwidth,\n            drmInfos: drmInfos,\n            allowedByApplication: true,\n            allowedByKeySystem: true\n          };\n\n          variants.push(variant);\n        }\n      }\n    }\n  } else {\n    // Audio or video only variants\n    var set = audio || video;\n    for (var i = 0; i < set.streams.length; i++) {\n      // Explicit cast, followed by assertion.  These should both be defined\n      // in the case of DASH, but the type allows for undefined in order to\n      // support HLS.\n      bandwidth = /** @type {number} */(set.streams[i].bandwidth);\n      goog.asserts.assert(bandwidth,\n          'Bandwidth must be defined and non-zero!');\n      variant = {\n        id: this.globalId_++,\n        language: set.language || 'und',\n        primary: set.main,\n        audio: audio ? set.streams[i] : null,\n        video: video ? set.streams[i] : null,\n        bandwidth: bandwidth,\n        drmInfos: set.drmInfos,\n        allowedByApplication: true,\n        allowedByKeySystem: true\n      };\n\n      variants.push(variant);\n    }\n  }\n};\n\n\n/**\n * Parses an AdaptationSet XML element.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {!Element} elem The AdaptationSet element.\n * @return {?shaka.dash.DashParser.AdaptationInfo}\n * @throws shaka.util.Error When there is a parsing error.\n * @private\n */\nshaka.dash.DashParser.prototype.parseAdaptationSet_ = function(context, elem) {\n  var XmlUtils = shaka.util.XmlUtils;\n  var Functional = shaka.util.Functional;\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n  var ContentType = ManifestParserUtils.ContentType;\n\n  context.adaptationSet = this.createFrame_(elem, context.period, null);\n\n  var main = false;\n  var roleElements = XmlUtils.findChildren(elem, 'Role');\n  var roleValues = roleElements.map(function(role) {\n    return role.getAttribute('value');\n  }).filter(Functional.isNotNull);\n\n  // Default kind for text streams is 'subtitle' if unspecified in the manifest.\n  var kind = undefined;\n  if (context.adaptationSet.contentType == ManifestParserUtils.ContentType.TEXT)\n    kind = ManifestParserUtils.TextStreamKind.SUBTITLE;\n\n  for (var i = 0; i < roleElements.length; i++) {\n    var scheme = roleElements[i].getAttribute('schemeIdUri');\n    if (scheme == null || scheme == 'urn:mpeg:dash:role:2011') {\n      // These only apply for the given scheme, but allow them to be specified\n      // if there is no scheme specified.\n      // See: DASH section 5.8.5.5\n      var value = roleElements[i].getAttribute('value');\n      switch (value) {\n        case 'main':\n          main = true;\n          break;\n        case 'caption':\n        case 'subtitle':\n          kind = value;\n          break;\n      }\n    }\n  }\n\n  var essentialProperties = XmlUtils.findChildren(elem, 'EssentialProperty');\n  // ID of real AdaptationSet if this is a trick mode set:\n  var trickModeFor = null;\n  var unrecognizedEssentialProperty = false;\n  essentialProperties.forEach(function(prop) {\n    var schemeId = prop.getAttribute('schemeIdUri');\n    if (schemeId == 'http://dashif.org/guidelines/trickmode') {\n      trickModeFor = prop.getAttribute('value');\n    } else {\n      unrecognizedEssentialProperty = true;\n    }\n  });\n\n  // According to DASH spec (2014) section 5.8.4.8, \"the successful processing\n  // of the descriptor is essential to properly use the information in the\n  // parent element\".  According to DASH IOP v3.3, section 3.3.4, \"if the scheme\n  // or the value\" for EssentialProperty is not recognized, \"the DASH client\n  // shall ignore the parent element.\"\n  if (unrecognizedEssentialProperty) {\n    // Stop parsing this AdaptationSet and let the caller filter out the nulls.\n    return null;\n  }\n\n  var contentProtectionElems = XmlUtils.findChildren(elem, 'ContentProtection');\n  var contentProtection = shaka.dash.ContentProtection.parseFromAdaptationSet(\n      contentProtectionElems, this.config_.dash.customScheme,\n      this.config_.dash.ignoreDrmInfo);\n\n  var language =\n      shaka.util.LanguageUtils.normalize(elem.getAttribute('lang') || 'und');\n\n  // non-standard attribute(yet) supported by Kaltura\n  var label = elem.getAttribute('label');\n\n  // Parse Representations into Streams.\n  var representations = XmlUtils.findChildren(elem, 'Representation');\n  var streams = representations\n      .map(this.parseRepresentation_.bind(this, context, contentProtection,\n          kind, language, label, main, roleValues))\n      .filter(function(s) { return !!s; });\n\n  if (streams.length == 0) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.DASH_EMPTY_ADAPTATION_SET);\n  }\n\n  // If AdaptationSet's type is unknown or is ambiguously \"application\",\n  // guess based on the information in the first stream.  If the attributes\n  // mimeType and codecs are split across levels, they will both be inherited\n  // down to the stream level by this point, so the stream will have all the\n  // necessary information.\n  if (!context.adaptationSet.contentType ||\n      context.adaptationSet.contentType == ContentType.APPLICATION) {\n    var mimeType = streams[0].mimeType;\n    var codecs = streams[0].codecs;\n    context.adaptationSet.contentType =\n        shaka.dash.DashParser.guessContentType_(mimeType, codecs);\n\n    streams.forEach(function(stream) {\n      stream.type = context.adaptationSet.contentType;\n    });\n  }\n\n  streams.forEach(function(stream) {\n    // Some DRM license providers require that we have a default\n    // key ID from the manifest in the wrapped license request.\n    // Thus, it should be put in drmInfo to be accessible to request filters.\n    contentProtection.drmInfos.forEach(function(drmInfo) {\n      if (stream.keyId) {\n        drmInfo.keyIds.push(stream.keyId);\n      }\n    });\n  });\n\n  var repIds = representations\n      .map(function(node) { return node.getAttribute('id'); })\n      .filter(shaka.util.Functional.isNotNull);\n\n  return {\n    id: context.adaptationSet.id || ('__fake__' + this.globalId_++),\n    contentType: context.adaptationSet.contentType,\n    language: language,\n    main: main,\n    streams: streams,\n    drmInfos: contentProtection.drmInfos,\n    trickModeFor: trickModeFor,\n    representationIds: repIds\n  };\n};\n\n\n/**\n * Parses a Representation XML element.\n *\n * @param {shaka.dash.DashParser.Context} context\n * @param {shaka.dash.ContentProtection.Context} contentProtection\n * @param {(string|undefined)} kind\n * @param {string} language\n * @param {string} label\n * @param {boolean} isPrimary\n * @param {!Array.<string>} roles\n * @param {!Element} node\n * @return {?shakaExtern.Stream} The Stream, or null when there is a\n *   non-critical parsing error.\n * @throws shaka.util.Error When there is a parsing error.\n * @private\n */\nshaka.dash.DashParser.prototype.parseRepresentation_ = function(\n    context, contentProtection, kind, language, label, isPrimary, roles, node) {\n  var XmlUtils = shaka.util.XmlUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  context.representation = this.createFrame_(node, context.adaptationSet, null);\n  if (!this.verifyRepresentation_(context.representation)) {\n    shaka.log.warning('Skipping Representation', context.representation);\n    return null;\n  }\n\n  context.bandwidth =\n      XmlUtils.parseAttr(node, 'bandwidth', XmlUtils.parsePositiveInt) ||\n      undefined;\n\n  /** @type {?shaka.dash.DashParser.StreamInfo} */\n  var streamInfo;\n  var requestInitSegment = this.requestInitSegment_.bind(this);\n  if (context.representation.segmentBase) {\n    streamInfo = shaka.dash.SegmentBase.createStream(\n        context, requestInitSegment);\n  } else if (context.representation.segmentList) {\n    streamInfo = shaka.dash.SegmentList.createStream(\n        context, this.segmentIndexMap_);\n  } else if (context.representation.segmentTemplate) {\n    streamInfo = shaka.dash.SegmentTemplate.createStream(\n        context, requestInitSegment, this.segmentIndexMap_, !!this.manifest_);\n  } else {\n    goog.asserts.assert(\n        context.representation.contentType == ContentType.TEXT ||\n        context.representation.contentType == ContentType.APPLICATION,\n        'Must have Segment* with non-text streams.');\n\n    var baseUris = context.representation.baseUris;\n    var duration = context.periodInfo.duration || 0;\n    streamInfo = {\n      createSegmentIndex: Promise.resolve.bind(Promise),\n      findSegmentPosition:\n          /** @return {?number} */ function(/** number */ time) {\n            if (time >= 0 && time < duration)\n              return 1;\n            else\n              return null;\n          },\n      getSegmentReference:\n          /** @return {shaka.media.SegmentReference} */\n          function(/** number */ ref) {\n            if (ref != 1)\n              return null;\n\n            return new shaka.media.SegmentReference(\n                1, 0, duration, function() { return baseUris; }, 0, null);\n          },\n      initSegmentReference: null,\n      presentationTimeOffset: 0\n    };\n  }\n\n  var contentProtectionElems = XmlUtils.findChildren(node, 'ContentProtection');\n  var keyId = shaka.dash.ContentProtection.parseFromRepresentation(\n      contentProtectionElems, this.config_.dash.customScheme,\n      contentProtection, this.config_.dash.ignoreDrmInfo);\n\n  return {\n    id: this.globalId_++,\n    createSegmentIndex: streamInfo.createSegmentIndex,\n    findSegmentPosition: streamInfo.findSegmentPosition,\n    getSegmentReference: streamInfo.getSegmentReference,\n    initSegmentReference: streamInfo.initSegmentReference,\n    presentationTimeOffset: streamInfo.presentationTimeOffset,\n    mimeType: context.representation.mimeType,\n    codecs: context.representation.codecs,\n    frameRate: context.representation.frameRate,\n    bandwidth: context.bandwidth,\n    width: context.representation.width,\n    height: context.representation.height,\n    kind: kind,\n    encrypted: contentProtection.drmInfos.length > 0,\n    keyId: keyId,\n    language: language,\n    label: label,\n    type: context.adaptationSet.contentType,\n    primary: isPrimary,\n    trickModeVideo: null,\n    containsEmsgBoxes: context.representation.containsEmsgBoxes,\n    roles: roles\n  };\n};\n\n\n/**\n * Called when the update timer ticks.\n *\n * @private\n */\nshaka.dash.DashParser.prototype.onUpdate_ = function() {\n  goog.asserts.assert(this.updateTimer_, 'Should only be called by timer');\n  goog.asserts.assert(this.updatePeriod_ >= 0,\n                      'There should be an update period');\n\n  shaka.log.info('Updating manifest...');\n\n  this.updateTimer_ = null;\n  var startTime = Date.now();\n\n  this.requestManifest_().then(function() {\n    // Detect a call to stop()\n    if (!this.playerInterface_)\n      return;\n\n    // Ensure the next update occurs within |updatePeriod_| seconds by taking\n    // into account the time it took to update the manifest.\n    var endTime = Date.now();\n    this.setUpdateTimer_((endTime - startTime) / 1000.0);\n  }.bind(this)).catch(function(error) {\n    goog.asserts.assert(error instanceof shaka.util.Error,\n                        'Should only receive a Shaka error');\n\n    // Try updating again, but ensure we haven't been destroyed.\n    if (this.playerInterface_) {\n      // We will retry updating, so override the severity of the error.\n      error.severity = shaka.util.Error.Severity.RECOVERABLE;\n      this.playerInterface_.onError(error);\n\n      this.setUpdateTimer_(0);\n    }\n  }.bind(this));\n};\n\n\n/**\n * Sets the update timer.  Does nothing if the manifest does not specify an\n * update period.\n *\n * @param {number} offset An offset, in seconds, to apply to the manifest's\n *   update period.\n * @private\n */\nshaka.dash.DashParser.prototype.setUpdateTimer_ = function(offset) {\n  // NOTE: An updatePeriod_ of -1 means the attribute was missing.\n  // An attribute which is present and set to 0 should still result in periodic\n  // updates. For more, see: https://github.com/google/shaka-player/issues/331\n  if (this.updatePeriod_ < 0)\n    return;\n  goog.asserts.assert(this.updateTimer_ == null,\n                      'Timer should not be already set');\n\n  var period =\n      Math.max(shaka.dash.DashParser.MIN_UPDATE_PERIOD_, this.updatePeriod_);\n  var interval = Math.max(period - offset, 0);\n  shaka.log.debug('updateInterval', interval);\n\n  var callback = this.onUpdate_.bind(this);\n  this.updateTimer_ = window.setTimeout(callback, 1000 * interval);\n};\n\n\n/**\n * Creates a new inheritance frame for the given element.\n *\n * @param {!Element} elem\n * @param {?shaka.dash.DashParser.InheritanceFrame} parent\n * @param {Array.<string>} baseUris\n * @return {shaka.dash.DashParser.InheritanceFrame}\n * @private\n */\nshaka.dash.DashParser.prototype.createFrame_ = function(\n    elem, parent, baseUris) {\n  goog.asserts.assert(parent || baseUris,\n                      'Must provide either parent or baseUris');\n  var ManifestParserUtils = shaka.util.ManifestParserUtils;\n  var XmlUtils = shaka.util.XmlUtils;\n  parent = parent || /** @type {shaka.dash.DashParser.InheritanceFrame} */ ({\n    contentType: '',\n    mimeType: '',\n    codecs: '',\n    containsEmsgBoxes: false,\n    frameRate: undefined\n  });\n  baseUris = baseUris || parent.baseUris;\n\n  var parseNumber = XmlUtils.parseNonNegativeInt;\n  var evalDivision = XmlUtils.evalDivision;\n  var uris = XmlUtils.findChildren(elem, 'BaseURL').map(XmlUtils.getContents);\n\n  var contentType = elem.getAttribute('contentType') || parent.contentType;\n  var mimeType = elem.getAttribute('mimeType') || parent.mimeType;\n  var codecs = elem.getAttribute('codecs') || parent.codecs;\n  var frameRate =\n      XmlUtils.parseAttr(elem, 'frameRate', evalDivision) || parent.frameRate;\n  var containsEmsgBoxes =\n      !!XmlUtils.findChildren(elem, 'InbandEventStream').length;\n\n  if (!contentType) {\n    contentType = shaka.dash.DashParser.guessContentType_(mimeType, codecs);\n  }\n\n  return {\n    baseUris: ManifestParserUtils.resolveUris(baseUris, uris),\n    segmentBase: XmlUtils.findChild(elem, 'SegmentBase') || parent.segmentBase,\n    segmentList: XmlUtils.findChild(elem, 'SegmentList') || parent.segmentList,\n    segmentTemplate:\n        XmlUtils.findChild(elem, 'SegmentTemplate') || parent.segmentTemplate,\n    width: XmlUtils.parseAttr(elem, 'width', parseNumber) || parent.width,\n    height: XmlUtils.parseAttr(elem, 'height', parseNumber) || parent.height,\n    contentType: contentType,\n    mimeType: mimeType,\n    codecs: codecs,\n    frameRate: frameRate,\n    containsEmsgBoxes: containsEmsgBoxes || parent.containsEmsgBoxes,\n    id: elem.getAttribute('id')\n  };\n};\n\n\n/**\n * Verifies that a Representation has exactly one Segment* element.  Prints\n * warnings if there is a problem.\n *\n * @param {shaka.dash.DashParser.InheritanceFrame} frame\n * @return {boolean} True if the Representation is usable; otherwise return\n *   false.\n * @private\n */\nshaka.dash.DashParser.prototype.verifyRepresentation_ = function(frame) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  var n = 0;\n  n += frame.segmentBase ? 1 : 0;\n  n += frame.segmentList ? 1 : 0;\n  n += frame.segmentTemplate ? 1 : 0;\n\n  if (n == 0) {\n    // TODO: extend with the list of MIME types registered to TextEngine.\n    if (frame.contentType == ContentType.TEXT ||\n        frame.contentType == ContentType.APPLICATION) {\n      return true;\n    } else {\n      shaka.log.warning(\n          'Representation does not contain a segment information source:',\n          'the Representation must contain one of SegmentBase, SegmentList,',\n          'SegmentTemplate, or explicitly indicate that it is \"text\".',\n          frame);\n      return false;\n    }\n  }\n\n  if (n != 1) {\n    shaka.log.warning(\n        'Representation contains multiple segment information sources:',\n        'the Representation should only contain one of SegmentBase,',\n        'SegmentList, or SegmentTemplate.',\n        frame);\n    if (frame.segmentBase) {\n      shaka.log.info('Using SegmentBase by default.');\n      frame.segmentList = null;\n      frame.segmentTemplate = null;\n    } else {\n      goog.asserts.assert(frame.segmentList, 'There should be a SegmentList');\n      shaka.log.info('Using SegmentList by default.');\n      frame.segmentTemplate = null;\n    }\n  }\n\n  return true;\n};\n\n\n/**\n * Makes a request to the given URI and calculates the clock offset.\n *\n * @param {!Array.<string>} baseUris\n * @param {string} uri\n * @param {string} method\n * @return {!Promise.<number>}\n * @private\n */\nshaka.dash.DashParser.prototype.requestForTiming_ =\n    function(baseUris, uri, method) {\n  var requestUris = shaka.util.ManifestParserUtils.resolveUris(baseUris, [uri]);\n  var request = shaka.net.NetworkingEngine.makeRequest(\n      requestUris, this.config_.retryParameters);\n  request.method = method;\n  var type = shaka.net.NetworkingEngine.RequestType.MANIFEST;\n  return this.playerInterface_.networkingEngine.request(type, request)\n      .then(function(response) {\n        var text;\n        if (method == 'HEAD') {\n          if (!response.headers || !response.headers['date']) return 0;\n\n          text = response.headers['date'];\n        } else {\n          text = shaka.util.StringUtils.fromUTF8(response.data);\n        }\n\n        var date = Date.parse(text);\n        return isNaN(date) ? 0 : (date - Date.now());\n      });\n};\n\n\n/**\n * Parses an array of UTCTiming elements.\n *\n * @param {!Array.<string>} baseUris\n * @param {!Array.<!Element>} elems\n * @param {boolean} isLive\n * @return {!Promise.<number>}\n * @private\n */\nshaka.dash.DashParser.prototype.parseUtcTiming_ =\n    function(baseUris, elems, isLive) {\n  var schemesAndValues = elems.map(function(elem) {\n    return {\n      scheme: elem.getAttribute('schemeIdUri'),\n      value: elem.getAttribute('value')\n    };\n  });\n\n  // If there's nothing specified in the manifest, but we have a default from\n  // the config, use that.\n  var clockSyncUri = this.config_.dash.clockSyncUri;\n  if (isLive && !schemesAndValues.length && clockSyncUri) {\n    schemesAndValues.push({\n      scheme: 'urn:mpeg:dash:utc:http-head:2014',\n      value: clockSyncUri\n    });\n  }\n\n  var Functional = shaka.util.Functional;\n  return Functional.createFallbackPromiseChain(schemesAndValues, function(sv) {\n    var scheme = sv.scheme;\n    var value = sv.value;\n    switch (scheme) {\n      // See DASH IOP Guidelines Section 4.7\n      // http://goo.gl/CQFNJT\n      case 'urn:mpeg:dash:utc:http-head:2014':\n      // Some old ISO23009-1 drafts used 2012.\n      case 'urn:mpeg:dash:utc:http-head:2012':\n        return this.requestForTiming_(baseUris, value, 'HEAD');\n      case 'urn:mpeg:dash:utc:http-xsdate:2014':\n      case 'urn:mpeg:dash:utc:http-iso:2014':\n      case 'urn:mpeg:dash:utc:http-xsdate:2012':\n      case 'urn:mpeg:dash:utc:http-iso:2012':\n        return this.requestForTiming_(baseUris, value, 'GET');\n      case 'urn:mpeg:dash:utc:direct:2014':\n      case 'urn:mpeg:dash:utc:direct:2012':\n        var date = Date.parse(value);\n        return isNaN(date) ? 0 : (date - Date.now());\n\n      case 'urn:mpeg:dash:utc:http-ntp:2014':\n      case 'urn:mpeg:dash:utc:ntp:2014':\n      case 'urn:mpeg:dash:utc:sntp:2014':\n        shaka.log.warning('NTP UTCTiming scheme is not supported');\n        return Promise.reject();\n      default:\n        shaka.log.warning(\n            'Unrecognized scheme in UTCTiming element', scheme);\n        return Promise.reject();\n    }\n  }.bind(this)).catch(function() {\n    if (isLive) {\n      shaka.log.warning(\n          'A UTCTiming element should always be given in live manifests! ' +\n          'This content may not play on clients with bad clocks!');\n    }\n    return 0;\n  });\n};\n\n\n/**\n * Parses an EventStream element.\n *\n * @param {number} periodStart\n * @param {?number} periodDuration\n * @param {!Element} elem\n * @private\n */\nshaka.dash.DashParser.prototype.parseEventStream_ = function(\n    periodStart, periodDuration, elem) {\n  var XmlUtils = shaka.util.XmlUtils;\n  var parseNumber = XmlUtils.parseNonNegativeInt;\n\n  var schemeIdUri = elem.getAttribute('schemeIdUri') || '';\n  var value = elem.getAttribute('value') || '';\n  var timescale = XmlUtils.parseAttr(elem, 'timescale', parseNumber) || 1;\n\n  XmlUtils.findChildren(elem, 'Event').forEach(function(eventNode) {\n    var presentationTime =\n        XmlUtils.parseAttr(eventNode, 'presentationTime', parseNumber) || 0;\n    var duration = XmlUtils.parseAttr(eventNode, 'duration', parseNumber) || 0;\n\n    var startTime = presentationTime / timescale + periodStart;\n    var endTime = startTime + (duration / timescale);\n    if (periodDuration != null) {\n      // An event should not go past the Period, even if the manifest says so.\n      // See: Dash sec. 5.10.2.1\n      startTime = Math.min(startTime, periodStart + periodDuration);\n      endTime = Math.min(endTime, periodStart + periodDuration);\n    }\n\n    /** @type {shakaExtern.TimelineRegionInfo} */\n    var region = {\n      schemeIdUri: schemeIdUri,\n      value: value,\n      startTime: startTime,\n      endTime: endTime,\n      id: eventNode.getAttribute('id') || '',\n      eventElement: eventNode\n    };\n\n    this.playerInterface_.onTimelineRegionAdded(region);\n  }.bind(this));\n};\n\n\n/**\n * Makes a network request on behalf of SegmentBase.createStream.\n *\n * @param {!Array.<string>} uris\n * @param {?number} startByte\n * @param {?number} endByte\n * @return {!Promise.<!ArrayBuffer>}\n * @private\n */\nshaka.dash.DashParser.prototype.requestInitSegment_ = function(\n    uris, startByte, endByte) {\n  var requestType = shaka.net.NetworkingEngine.RequestType.SEGMENT;\n  var request = shaka.net.NetworkingEngine.makeRequest(\n      uris, this.config_.retryParameters);\n  if (startByte != null) {\n    var end = (endByte != null ? endByte : '');\n    request.headers['Range'] = 'bytes=' + startByte + '-' + end;\n  }\n\n  return this.playerInterface_.networkingEngine.request(requestType, request)\n      .then(function(response) { return response.data; });\n};\n\n\n/**\n * Guess the content type based on MIME type and codecs.\n *\n * @param {string} mimeType\n * @param {string} codecs\n * @return {string}\n * @private\n */\nshaka.dash.DashParser.guessContentType_ = function(mimeType, codecs) {\n  var fullMimeType = shaka.util.StreamUtils.getFullMimeType(mimeType, codecs);\n\n  if (shaka.media.TextEngine.isTypeSupported(fullMimeType)) {\n    // If it's supported by TextEngine, it's definitely text.\n    // We don't check MediaSourceEngine, because that would report support\n    // for platform-supported video and audio types as well.\n    return shaka.util.ManifestParserUtils.ContentType.TEXT;\n  }\n\n  // Otherwise, just split the MIME type.  This handles video and audio\n  // types well.\n  return mimeType.split('/')[0];\n};\n\n\nshaka.media.ManifestParser.registerParserByExtension(\n    'mpd', shaka.dash.DashParser);\nshaka.media.ManifestParser.registerParserByMime(\n    'application/dash+xml', shaka.dash.DashParser);\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/dash/dash_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.hls.Attribute');\ngoog.provide('shaka.hls.Playlist');\ngoog.provide('shaka.hls.PlaylistType');\ngoog.provide('shaka.hls.Segment');\ngoog.provide('shaka.hls.Tag');\n\ngoog.require('goog.asserts');\n\n\n\n/**\n * Creates an HLS playlist object.\n *\n * @param {!string} uri\n * @param {!shaka.hls.PlaylistType} type\n * @param {!Array.<shaka.hls.Tag>} tags\n * @param {!Array.<shaka.hls.Segment>=} opt_segments\n *\n * @constructor\n * @struct\n */\nshaka.hls.Playlist = function(uri, type, tags, opt_segments) {\n  /** @const {!string} */\n  this.uri = uri;\n\n  /** @const {shaka.hls.PlaylistType} */\n  this.type = type;\n\n  /** @const {!Array.<!shaka.hls.Tag>} */\n  this.tags = tags;\n\n  /** @const {Array.<!shaka.hls.Segment>} */\n  this.segments = opt_segments || null;\n};\n\n\n/**\n * @enum {number}\n */\nshaka.hls.PlaylistType = {\n  MASTER: 0,\n  MEDIA: 1\n};\n\n\n\n/**\n * Creates an HLS tag object.\n *\n * @param {number} id\n * @param {!string} name\n * @param {!Array.<shaka.hls.Attribute>} attributes\n * @param {?string=} opt_value\n *\n * @constructor\n * @struct\n */\nshaka.hls.Tag = function(id, name, attributes, opt_value) {\n\n  goog.asserts.assert(\n      (attributes.length == 0 && opt_value) ||\n      (attributes.length > 0 && !opt_value) ||\n      (attributes.length == 0 && !opt_value),\n      'Tags can only take the form ' +\n      '(1) <NAME>:<VALUE> ' +\n      '(2) <NAME>:<ATTRIBUTE_LIST> ' +\n      ' (3) <NAME>');\n\n  /** @const {number} */\n  this.id = id;\n\n  /** @const {!string} */\n  this.name = name;\n\n  /** @const {Array.<shaka.hls.Attribute>} */\n  this.attributes = attributes;\n\n  /** @const {?string} */\n  this.value = opt_value || null;\n};\n\n\n/**\n * Create the string representation of the tag.\n *\n * For the DRM system - the full tag needs to be passed down to the CDM. There\n * are two ways of doing this (1) save the original tag or (2) recreate the tag.\n * As with some cases (like in tests) the tag never existed in string form, it\n * is far easier to recreate the tag from the parsed form.\n *\n * @return {string}\n * @override\n */\nshaka.hls.Tag.prototype.toString = function() {\n\n  /**\n   * @param {shaka.hls.Attribute} attr\n   * @return {!string}\n   */\n  var attr_to_str = function(attr) {\n    return attr.name + '=\"' + attr.value + '\"';\n  };\n\n\n  // A valid tag can only follow 1 of 3 patterns.\n  //  1) <NAME>:<VALUE>\n  //  2) <NAME>:<ATTRIBUTE LIST>\n  //  3) <NAME>\n\n  if (this.value) {\n    return '#' + this.name + ':' + this.value;\n  }\n\n  if (this.attributes.length > 0) {\n    return '#' + this.name + ':' + this.attributes.map(attr_to_str).join(',');\n  }\n\n  return '#' + this.name;\n};\n\n\n\n/**\n * Creates an HLS attribute object.\n *\n * @param {!string} name\n * @param {!string} value\n *\n * @constructor\n * @struct\n */\nshaka.hls.Attribute = function(name, value) {\n  /** @const {!string} */\n  this.name = name;\n\n  /** @const {!string} */\n  this.value = value;\n};\n\n\n/**\n * Adds an attribute to an HLS Tag.\n *\n * @param {!shaka.hls.Attribute} attribute\n */\nshaka.hls.Tag.prototype.addAttribute = function(attribute) {\n  this.attributes.push(attribute);\n};\n\n\n/**\n * Gets the first attribute of the tag with a specified name.\n *\n * @param {!string} name\n * @return {?shaka.hls.Attribute} attribute\n */\nshaka.hls.Tag.prototype.getAttribute = function(name) {\n  var attributes = this.attributes.filter(function(attr) {\n    return attr.name == name;\n  });\n\n  goog.asserts.assert(attributes.length < 2,\n                      'A tag should not have multiple attributes ' +\n                      'with the same name!');\n\n  if (attributes.length)\n    return attributes[0];\n  else\n    return null;\n};\n\n\n/**\n * Gets the value of the first attribute of the tag with a specified name.\n * If not found, returns an optional default value.\n *\n * @param {!string} name\n * @param {string=} opt_defaultValue\n * @return {?string}\n */\nshaka.hls.Tag.prototype.getAttributeValue = function(name, opt_defaultValue) {\n  var defaultValue = opt_defaultValue || null;\n  var attribute = this.getAttribute(name);\n  return attribute ? attribute.value : defaultValue;\n};\n\n\n\n/**\n * Creates an HLS segment object.\n *\n * @param {!string} uri\n * @param {!Array.<shaka.hls.Tag>} tags\n *\n * @constructor\n * @struct\n */\nshaka.hls.Segment = function(uri, tags) {\n  /** @const {!Array.<shaka.hls.Tag>} */\n  this.tags = tags;\n\n  /** @const {!string} */\n  this.uri = uri;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/hls/hls_classes.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.hls.Utils');\n\ngoog.require('shaka.util.ManifestParserUtils');\n\n\n/**\n *\n * @param {!Array.<!shaka.hls.Tag>} tags\n * @param {!string} name\n * @return {!Array.<!shaka.hls.Tag>}\n */\nshaka.hls.Utils.filterTagsByName = function(tags, name) {\n  return tags.filter(function(tag) {\n    return tag.name == name;\n  });\n};\n\n\n/**\n *\n * @param {!Array.<!shaka.hls.Tag>} tags\n * @param {!string} name\n * @return {?shaka.hls.Tag}\n */\nshaka.hls.Utils.getFirstTagWithName = function(tags, name) {\n  var tagsWithName = shaka.hls.Utils.filterTagsByName(tags, name);\n  if (!tagsWithName.length) return null;\n\n  return tagsWithName[0];\n};\n\n\n/**\n * Expects an array of EXT-X-MEDIA tags. Returns the first tag that\n * has given media type and group id.\n *\n * @param {!Array.<!shaka.hls.Tag>} tags\n * @param {!string} type\n * @param {!string} groupId\n * @return {!Array<!shaka.hls.Tag>}\n */\nshaka.hls.Utils.findMediaTags = function(tags, type, groupId) {\n  return tags.filter(function(tag) {\n    var typeAttr = tag.getAttribute('TYPE');\n    var groupIdAttr = tag.getAttribute('GROUP-ID');\n    return typeAttr.value == type && groupIdAttr.value == groupId;\n  });\n};\n\n\n/**\n * @param {!string} parentAbsoluteUri\n * @param {!string} uri\n * @return {!string}\n */\nshaka.hls.Utils.constructAbsoluteUri = function(parentAbsoluteUri, uri) {\n  var uris = shaka.util.ManifestParserUtils.resolveUris(\n      [parentAbsoluteUri], [uri]);\n\n  return uris[0];\n};\n\n\n/**\n * Matches a string to an HLS comment format and returns the result.\n *\n * @param {!string} line\n * @return {boolean}\n */\nshaka.hls.Utils.isComment = function(line) {\n  return /^#(?!EXT)/m.test(line);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/hls/hls_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.TextParser');\n\ngoog.require('goog.asserts');\n\n\n\n/**\n * Reads elements from strings.\n *\n * @param {string} data\n * @constructor\n * @struct\n */\nshaka.util.TextParser = function(data) {\n  /**\n   * @const\n   * @private {string}\n   */\n  this.data_ = data;\n\n  /** @private {number} */\n  this.position_ = 0;\n};\n\n\n/** @return {boolean} Whether it is at the end of the string. */\nshaka.util.TextParser.prototype.atEnd = function() {\n  return this.position_ == this.data_.length;\n};\n\n\n/**\n * Reads a line from the parser.  This will read but not return the newline.\n * Returns null at the end.\n *\n * @return {?string}\n */\nshaka.util.TextParser.prototype.readLine = function() {\n  return this.readRegexReturnCapture_(/(.*?)(\\n|$)/gm, 1);\n};\n\n\n/**\n * Reads a word from the parser.  This will not read or return any whitespace\n * before or after the word (including newlines).  Returns null at the end.\n *\n * @return {?string}\n */\nshaka.util.TextParser.prototype.readWord = function() {\n  return this.readRegexReturnCapture_(/[^ \\t\\n]*/gm, 0);\n};\n\n\n/**\n * Skips any continuous whitespace from the parser.  Returns null at the end.\n */\nshaka.util.TextParser.prototype.skipWhitespace = function() {\n  this.readRegex(/[ \\t]+/gm);\n};\n\n\n/**\n * Reads the given regular expression from the parser.  This requires the match\n * to be at the current position; there is no need to include a head anchor.\n * This requires that the regex have the global flag to be set so that it can\n * set lastIndex to start the search at the current position.  Returns null at\n * the end or if the regex does not match the current position.\n *\n * @param {!RegExp} regex\n * @return {Array.<string>}\n */\nshaka.util.TextParser.prototype.readRegex = function(regex) {\n  var index = this.indexOf_(regex);\n  if (this.atEnd() || index == null || index.position != this.position_)\n    return null;\n\n  this.position_ += index.length;\n  return index.results;\n};\n\n\n/**\n * Reads a regex from the parser and returns the given capture.\n *\n * @param {!RegExp} regex\n * @param {number} index\n * @return {?string}\n * @private\n */\nshaka.util.TextParser.prototype.readRegexReturnCapture_ =\n    function(regex, index) {\n  if (this.atEnd())\n    return null;\n\n  var ret = this.readRegex(regex);\n  if (!ret)\n    return null;\n  else\n    return ret[index];\n};\n\n\n/**\n * Returns the index info about a regular expression match.\n *\n * @param {!RegExp} regex\n * @return {?{position: number, length: number, results: !Array.<string>}}\n * @private\n */\nshaka.util.TextParser.prototype.indexOf_ = function(regex) {\n  // The global flag is required to use lastIndex.\n  goog.asserts.assert(regex.global, 'global flag should be set');\n\n  regex.lastIndex = this.position_;\n  var results = regex.exec(this.data_);\n  if (results == null)\n    return null;\n  else\n    return {\n      position: results.index,\n      length: results[0].length,\n      results: results\n    };\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/text_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.hls.ManifestTextParser');\n\ngoog.require('shaka.hls.Attribute');\ngoog.require('shaka.hls.Playlist');\ngoog.require('shaka.hls.PlaylistType');\ngoog.require('shaka.hls.Segment');\ngoog.require('shaka.hls.Tag');\ngoog.require('shaka.hls.Utils');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.StringUtils');\ngoog.require('shaka.util.TextParser');\n\n\n\n/**\n * Creates a new ManifestTextParser.\n *\n * @constructor\n * @struct\n */\nshaka.hls.ManifestTextParser = function() {\n  /** @private {number} */\n  this.globalId_ = 0;\n};\n\n\n/**\n * @param {!ArrayBuffer} data\n * @param {!string} uri\n * @return {!shaka.hls.Playlist}\n * @throws {shaka.util.Error}\n */\nshaka.hls.ManifestTextParser.prototype.parsePlaylist = function(data, uri) {\n  // Get the input as a string.  Normalize newlines to \\n.\n  var str = shaka.util.StringUtils.fromUTF8(data);\n  str = str.replace(/\\r\\n|\\r(?=[^\\n]|$)/gm, '\\n').trim();\n\n  var lines = str.split(/\\n+/m);\n\n  if (!/^#EXTM3U($|[ \\t\\n])/m.test(lines[0])) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.HLS_PLAYLIST_HEADER_MISSING);\n  }\n\n  /** shaka.hls.PlaylistType */\n  var playlistType = shaka.hls.PlaylistType.MASTER;\n\n  /** {Array.<shaka.hls.Tag>} */\n  var tags = [];\n  var i = 1;\n  while (i < lines.length) {\n    // Skip comments\n    if (shaka.hls.Utils.isComment(lines[i])) {\n      i += 1;\n      continue;\n    }\n\n    var tag = this.parseTag_(lines[i]);\n\n    if (shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS\n                                    .indexOf(tag.name) >= 0) {\n      playlistType = shaka.hls.PlaylistType.MEDIA;\n    } else if (shaka.hls.ManifestTextParser.SEGMENT_TAGS\n                                           .indexOf(tag.name) >= 0) {\n      if (playlistType != shaka.hls.PlaylistType.MEDIA) {\n        // Only media playlist should contain segment tags\n        throw new shaka.util.Error(\n            shaka.util.Error.Severity.CRITICAL,\n            shaka.util.Error.Category.MANIFEST,\n            shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);\n      }\n\n      var segmentsData = lines.splice(i, lines.length - i);\n      var segments = this.parseSegments_(segmentsData);\n      return new shaka.hls.Playlist(uri, playlistType, tags, segments);\n    }\n\n    tags.push(tag);\n    i += 1;\n\n    // EXT-X-STREAM-INF tag is followed by a uri of a media playlist.\n    // Add uri to the tag object.\n    if (tag.name == 'EXT-X-STREAM-INF') {\n      var tagUri = new shaka.hls.Attribute('URI', lines[i]);\n      tag.addAttribute(tagUri);\n      i += 1;\n    }\n  }\n\n  return new shaka.hls.Playlist(uri, playlistType, tags);\n};\n\n\n/**\n * Parses an array of strings into an HLS Segment objects.\n *\n * @param {!Array.<string>} lines\n * @return {!Array.<shaka.hls.Segment>}\n * @private\n * @throws {shaka.util.Error}\n */\nshaka.hls.ManifestTextParser.prototype.parseSegments_ = function(lines) {\n  var segments = [];\n  var tags = [];\n  lines.forEach(function(line) {\n    if (/^(#EXT)/.test(line)) {\n      var tag = this.parseTag_(line);\n      tags.push(tag);\n    } else if (shaka.hls.Utils.isComment(line)) {\n      // Skip comments\n      return;\n    } else {\n      var uri = line.trim();\n      // Uri appears after all the tags describing the segment.\n      var segment = new shaka.hls.Segment(uri, tags);\n      segments.push(segment);\n      tags = [];\n    }\n  }.bind(this));\n\n  return segments;\n};\n\n\n/**\n * Parses a string into an HLS Tag object while tracking what id to use next.\n *\n * @param {!string} word\n * @return {!shaka.hls.Tag}\n * @throws {shaka.util.Error}\n * @private\n */\nshaka.hls.ManifestTextParser.prototype.parseTag_ = function(word) {\n  return shaka.hls.ManifestTextParser.parseTag(this.globalId_++, word);\n};\n\n\n/**\n * Parses a string into an HLS Tag object.\n *\n * @param {number} id\n * @param {!string} word\n * @return {!shaka.hls.Tag}\n * @throws {shaka.util.Error}\n */\nshaka.hls.ManifestTextParser.parseTag = function(id, word) {\n  /* HLS tags start with '#EXT'. A tag can have a set of attributes\n    (#EXT-<tagname>:<attribute list>) or a value (#EXT-<tagname>:<value>).\n    Attributes' format is 'AttributeName=AttributeValue'.\n    The parsing logic goes like this:\n     1) Everything before ':' is a name (we ignore '#').\n     2) Everything after should be parsed as attributes if it contains '='.\n     3) Otherwise, this is a value.\n     4) If there is no \":\", it's a simple tag with no attributes and no value */\n  var blocks = word.match(/^#(EXT[^:]*)(?::(.*))?$/);\n  if (!blocks) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.INVALID_HLS_TAG);\n  }\n  var name = blocks[1];\n  var data = blocks[2];\n  var attributes = [];\n\n  if (data && data.indexOf('=') >= 0) {\n    var parser = new shaka.util.TextParser(data);\n    var blockAttrs;\n\n    // Regex:\n    // 1. Key name ([1])\n    // 2. Equals sign\n    // 3. Either:\n    //   a. A quoted string (everything up to the next quote, [2])\n    //   b. An unquoted string\n    //    (everything up to the next comma or end of line, [3])\n    // 4. Either:\n    //   a. A comma\n    //   b. End of line\n    var regex = /([^=]+)=(?:\"([^\"]*)\"|([^\",]*))(?:,|$)/g;\n    while (blockAttrs = parser.readRegex(regex)) {\n      var attrName = blockAttrs[1];\n      var attrValue = blockAttrs[2] || blockAttrs[3];\n      var attribute = new shaka.hls.Attribute(attrName, attrValue);\n      attributes.push(attribute);\n    }\n  } else if (data) {\n    return new shaka.hls.Tag(id, name, attributes, data);\n  }\n\n  return new shaka.hls.Tag(id, name, attributes);\n};\n\n\n/**\n * HLS tags that only appear on Media Playlists.\n * Used to determine a playlist type.\n *\n * @const {!Array<!string>}\n */\nshaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS = [\n  'EXT-X-TARGETDURATION',\n  'EXT-X-MEDIA-SEQUENCE',\n  'EXT-X-DISCONTINUITY-SEQUENCE',\n  'EXT-X-PLAYLIST-TYPE',\n  'EXT-X-MAP',\n  'EXT-X-I-FRAMES-ONLY'\n];\n\n\n/**\n * HLS tags that only appear on Segments in a Media Playlists.\n * Used to determine the start of the segments info.\n *\n * @const {!Array<!string>}\n */\nshaka.hls.ManifestTextParser.SEGMENT_TAGS = [\n  'EXTINF',\n  'EXT-X-BYTERANGE',\n  'EXT-X-DISCONTINUITY',\n  'EXT-X-PROGRAM-DATE-TIME',\n  'EXT-X-KEY',\n  'EXT-X-DATERANGE'\n];\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/hls/manifest_text_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.net.DataUriPlugin');\n\ngoog.require('shaka.log');\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.StringUtils');\ngoog.require('shaka.util.Uint8ArrayUtils');\n\n\n/**\n * @namespace\n * @summary A networking plugin to handle data URIs.\n * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/data_URIs\n * @param {string} uri\n * @param {shakaExtern.Request} request\n * @return {!Promise.<shakaExtern.Response>}\n * @export\n */\nshaka.net.DataUriPlugin = function(uri, request) {\n  return new Promise(function(resolve, reject) {\n    var parsed = shaka.net.DataUriPlugin.parse(uri);\n\n    /** @type {shakaExtern.Response} */\n    var response = {\n      uri: uri,\n      data: parsed.data,\n      headers: {\n        'content-type': parsed.contentType\n      }\n    };\n\n    resolve(response);\n  });\n};\n\n\n/**\n * @param {string} uri\n * @return {{data: ArrayBuffer, contentType: string}}\n */\nshaka.net.DataUriPlugin.parse = function(uri) {\n  // Extract the scheme.\n  var parts = uri.split(':');\n  if (parts.length < 2 || parts[0] != 'data') {\n    shaka.log.error('Bad data URI, failed to parse scheme');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.NETWORK,\n        shaka.util.Error.Code.MALFORMED_DATA_URI,\n        uri);\n  }\n  var path = parts.slice(1).join(':');\n\n  // Extract the encoding and MIME type (required but can be empty).\n  var infoAndData = path.split(',');\n  if (infoAndData.length < 2) {\n    shaka.log.error('Bad data URI, failed to extract encoding and MIME type');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.NETWORK,\n        shaka.util.Error.Code.MALFORMED_DATA_URI,\n        uri);\n  }\n  var info = infoAndData[0];\n  var dataStr = window.decodeURIComponent(infoAndData.slice(1).join(','));\n\n  // Extract the encoding (optional).\n  var typeAndEncoding = info.split(';');\n  var encoding = null;\n  if (typeAndEncoding.length > 1)\n    encoding = typeAndEncoding[1];\n\n  // Convert the data.\n  /** @type {ArrayBuffer} */\n  var data;\n  if (encoding == 'base64') {\n    data = shaka.util.Uint8ArrayUtils.fromBase64(dataStr).buffer;\n  } else if (encoding) {\n    shaka.log.error('Bad data URI, unknown encoding');\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.NETWORK,\n        shaka.util.Error.Code.UNKNOWN_DATA_URI_ENCODING,\n        uri);\n  } else {\n    data = shaka.util.StringUtils.toUTF8(dataStr);\n  }\n\n  return {data: data, contentType: typeAndEncoding[0]};\n};\n\n\nshaka.net.NetworkingEngine.registerScheme('data', shaka.net.DataUriPlugin);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/net/data_uri_plugin.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\ngoog.provide('shaka.hls.HlsParser');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.hls.ManifestTextParser');\ngoog.require('shaka.hls.Playlist');\ngoog.require('shaka.hls.PlaylistType');\ngoog.require('shaka.hls.Tag');\ngoog.require('shaka.hls.Utils');\ngoog.require('shaka.log');\ngoog.require('shaka.media.DrmEngine');\ngoog.require('shaka.media.InitSegmentReference');\ngoog.require('shaka.media.ManifestParser');\ngoog.require('shaka.media.PresentationTimeline');\ngoog.require('shaka.media.SegmentIndex');\ngoog.require('shaka.media.SegmentReference');\ngoog.require('shaka.net.DataUriPlugin');\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.ManifestParserUtils');\n\n\n\n/**\n * Creates a new HLS parser.\n *\n * @struct\n * @constructor\n * @implements {shakaExtern.ManifestParser}\n * @export\n */\nshaka.hls.HlsParser = function() {\n  /** @private {?shakaExtern.ManifestParser.PlayerInterface} */\n  this.playerInterface_ = null;\n\n  /** @private {?shakaExtern.ManifestConfiguration} */\n  this.config_ = null;\n\n  /** @private {number} */\n  this.globalId_ = 1;\n\n  /** @private {!Object.<number, shaka.hls.HlsParser.StreamInfo>} */\n  this.mediaTagsToStreamInfosMap_ = {};\n\n  /** @private {!Object.<number, !shaka.media.SegmentIndex>} */\n  this.streamsToIndexMap_ = {};\n\n  /** @private {?shaka.media.PresentationTimeline} */\n  this.presentationTimeline_ = null;\n\n  /** @private {string} */\n  this.manifestUri_ = '';\n\n  /** @private {shaka.hls.ManifestTextParser} */\n  this.manifestTextParser_ = new shaka.hls.ManifestTextParser();\n};\n\n\n/**\n * @typedef {{\n *   stream: !shakaExtern.Stream,\n *   segmentIndex: !shaka.media.SegmentIndex,\n *   drmInfos: !Array.<shakaExtern.DrmInfo>\n * }}\n *\n * @description\n * Contains a stream and information about it.\n *\n * @property {!shakaExtern.Stream} stream\n *   The Stream itself.\n * @property {!shaka.media.SegmentIndex} segmentIndex\n *   SegmentIndex of the stream.\n * @property {!Array.<shakaExtern.DrmInfo>} drmInfos\n *   DrmInfos of the stream.  There may be multiple for multi-DRM content.\n */\nshaka.hls.HlsParser.StreamInfo;\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.hls.HlsParser.prototype.configure = function(config) {\n  this.config_ = config;\n};\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.hls.HlsParser.prototype.start = function(uri, playerInterface) {\n  goog.asserts.assert(this.config_, 'Must call configure() before start()!');\n  this.playerInterface_ = playerInterface;\n  this.manifestUri_ = uri;\n  return this.requestManifest_(uri).then(function(response) {\n    return this.parseManifest_(response.data, uri);\n  }.bind(this));\n};\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.hls.HlsParser.prototype.stop = function() {\n  this.playerInterface_ = null;\n  this.config_ = null;\n  this.mediaTagsToStreamInfosMap_ = {};\n\n  return Promise.resolve();\n};\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.hls.HlsParser.prototype.update = function() {\n  // TODO: Implement support for live content.\n};\n\n\n/**\n * @override\n * @exportInterface\n */\nshaka.hls.HlsParser.prototype.onExpirationUpdated = function(\n    sessionId, expiration) {\n  // No-op\n};\n\n\n/**\n * Parses the manifest.\n *\n * @param {!ArrayBuffer} data\n * @param {string} uri\n * @return {!Promise.<!shakaExtern.Manifest>}\n * @throws shaka.util.Error When there is a parsing error.\n * @private\n */\nshaka.hls.HlsParser.prototype.parseManifest_ = function(data, uri) {\n  var playlist = this.manifestTextParser_.parsePlaylist(data, uri);\n\n  // We don't support directly providing a Media Playlist.\n  // See error code for details.\n  if (playlist.type != shaka.hls.PlaylistType.MASTER) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.HLS_MASTER_PLAYLIST_NOT_PROVIDED);\n  }\n\n  // TODO: Implement support for live content.\n  this.presentationTimeline_ = new shaka.media.PresentationTimeline(null, 0);\n  return this.createPeriod_(playlist).then(function(period) {\n    // HLS has no notion of periods. We're treating the whole presentation as\n    // one period.\n    this.playerInterface_.filterPeriod(period);\n    return {\n      presentationTimeline: this.presentationTimeline_,\n      periods: [period],\n      offlineSessionIds: [],\n      minBufferTime: 0\n    };\n  }.bind(this));\n};\n\n\n/**\n * Parses a playlist into a Period object.\n *\n * @param {!shaka.hls.Playlist} playlist\n * @return {!Promise.<!shakaExtern.Period>}\n * @private\n */\nshaka.hls.HlsParser.prototype.createPeriod_ = function(playlist) {\n  var Utils = shaka.hls.Utils;\n  var Functional = shaka.util.Functional;\n  var tags = playlist.tags;\n\n  // Create Variants for every 'EXT-X-STREAM-INF' tag.\n  var variantTags = Utils.filterTagsByName(tags, 'EXT-X-STREAM-INF');\n  var variantsPromises = variantTags.map(function(tag) {\n    return this.createVariantsForTag_(tag, playlist);\n  }.bind(this));\n\n  var mediaTags = Utils.filterTagsByName(playlist.tags, 'EXT-X-MEDIA');\n  var textStreamTags = mediaTags.filter(function(tag) {\n    var type = shaka.hls.HlsParser.getRequiredAttributeValue_(tag, 'TYPE');\n    return type == 'SUBTITLES';\n  }.bind(this));\n\n  // TODO: CLOSED-CAPTIONS requires the parsing of CEA-608 from the video.\n  var textStreamPromises = textStreamTags.map(function(tag) {\n    return this.createTextStream_(tag, playlist);\n  }.bind(this));\n\n  return Promise.all(variantsPromises).then(function(allVariants) {\n    return Promise.all(textStreamPromises).then(function(textStreams) {\n      var variants = allVariants.reduce(Functional.collapseArrays, []);\n      this.fitSegments_(variants);\n      return {\n        startTime: 0,\n        variants: variants,\n        textStreams: textStreams\n      };\n    }.bind(this));\n  }.bind(this));\n};\n\n\n/**\n * @param {!shaka.hls.Tag} tag\n * @param {!shaka.hls.Playlist} playlist\n * @return {!Promise.<!Array.<!shakaExtern.Variant>>}\n * @private\n */\nshaka.hls.HlsParser.prototype.createVariantsForTag_ = function(tag, playlist) {\n  goog.asserts.assert(tag.name == 'EXT-X-STREAM-INF',\n                      'Should only be called on variant tags!');\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var HlsParser = shaka.hls.HlsParser;\n  var Utils = shaka.hls.Utils;\n  var bandwidth =\n      Number(HlsParser.getRequiredAttributeValue_(tag, 'BANDWIDTH'));\n\n  // These are the default codecs to assume if none are specified.\n  //\n  // The video codec is H.264, with baseline profile and level 3.0.\n  // http://blog.pearce.org.nz/2013/11/what-does-h264avc1-codecs-parameters.html\n  //\n  // The audio codec is \"low-complexity\" AAC.\n  var defaultCodecs = 'avc1.42E01E,mp4a.40.2';\n\n  var codecs = tag.getAttributeValue('CODECS', defaultCodecs).split(',');\n  var resolutionAttr = tag.getAttribute('RESOLUTION');\n  var width = null;\n  var height = null;\n  var frameRate = tag.getAttributeValue('FRAME-RATE');\n\n  if (resolutionAttr) {\n    var resBlocks = resolutionAttr.value.split('x');\n    width = resBlocks[0];\n    height = resBlocks[1];\n  }\n\n  var timeOffset = this.getTimeOffset_(playlist);\n\n  var mediaTags = Utils.filterTagsByName(playlist.tags, 'EXT-X-MEDIA');\n\n  var audioGroupId = tag.getAttributeValue('AUDIO');\n  var videoGroupId = tag.getAttributeValue('VIDEO');\n  goog.asserts.assert(audioGroupId == null || videoGroupId == null,\n      'Unexpected: both video and audio described by media tags!');\n\n  // Find any associated audio or video groups and create streams for them.\n  if (audioGroupId) {\n    mediaTags = Utils.findMediaTags(mediaTags, 'AUDIO', audioGroupId);\n  } else if (videoGroupId) {\n    mediaTags = Utils.findMediaTags(mediaTags, 'VIDEO', videoGroupId);\n  }\n  var promises = mediaTags.map(function(tag) {\n    return this.createStreamInfoFromMediaTag_(tag, codecs, timeOffset);\n  }.bind(this));\n\n  var audioStreamInfos = [];\n  var videoStreamInfos = [];\n\n  return Promise.all(promises).then(function(data) {\n    if (audioGroupId) {\n      audioStreamInfos = data;\n    } else if (videoGroupId) {\n      videoStreamInfos = data;\n    }\n\n    // Make an educated guess about the stream type.\n    shaka.log.debug('Guessing stream type for', tag.toString());\n    var type;\n    if (!audioStreamInfos.length && !videoStreamInfos.length) {\n      // There are no associated streams.  This is either an audio-only stream,\n      // a video-only stream, or a multiplexed stream.\n\n      if (codecs.length == 1) {\n        // There is only one codec, so it shouldn't be multiplexed.\n        if (resolutionAttr || frameRate) {\n          // Assume video-only.\n          shaka.log.debug('Guessing video-only.');\n          type = ContentType.VIDEO;\n        } else {\n          // Assume audio-only.\n          shaka.log.debug('Guessing audio-only.');\n          type = ContentType.AUDIO;\n        }\n      } else {\n        // There are multiple codecs, so assume multiplexed content.\n        // Note that the default used when CODECS is missing assumes multiple\n        // (and therefore multiplexed).\n        // Recombine the codec strings into one so that MediaSource isn't\n        // lied to later.  (That would trigger an error in Chrome.)\n        shaka.log.debug('Guessing multiplexed audio+video.');\n        type = ContentType.VIDEO;\n        codecs = [codecs.join(',')];\n      }\n    } else if (audioStreamInfos.length) {\n      // There are associated audio streams.  Assume this is video.\n      shaka.log.debug('Guessing video.');\n      type = ContentType.VIDEO;\n    } else {\n      // There are associated video streams.  Assume this is audio.\n      goog.asserts.assert(videoStreamInfos.length,\n          'No video streams!  This should have been handled already!');\n      shaka.log.debug('Guessing audio.');\n      type = ContentType.AUDIO;\n    }\n\n    goog.asserts.assert(type, 'Type should have been set by now!');\n    return this.createStreamInfoFromVariantTag_(tag, codecs, type, timeOffset);\n  }.bind(this)).then(function(streamInfo) {\n    goog.asserts.assert(streamInfo, 'We should have created a stream!');\n    if (streamInfo.stream.type == ContentType.AUDIO) {\n      audioStreamInfos = [streamInfo];\n    } else {\n      videoStreamInfos = [streamInfo];\n    }\n\n    return this.createVariants_(\n        audioStreamInfos,\n        videoStreamInfos,\n        bandwidth,\n        width,\n        height,\n        frameRate);\n  }.bind(this));\n};\n\n\n/**\n * @param {!Array.<!shaka.hls.HlsParser.StreamInfo>} audioInfos\n * @param {!Array.<!shaka.hls.HlsParser.StreamInfo>} videoInfos\n * @param {number} bandwidth\n * @param {?string} width\n * @param {?string} height\n * @param {?string} frameRate\n * @return {!Array.<!shakaExtern.Variant>}\n * @private\n */\nshaka.hls.HlsParser.prototype.createVariants_ =\n    function(audioInfos, videoInfos, bandwidth, width, height, frameRate) {\n  var DrmEngine = shaka.media.DrmEngine;\n\n  videoInfos.forEach(function(info) {\n    this.addVideoAttributes_(info.stream, width, height, frameRate);\n  }.bind(this));\n\n  // In case of audio-only or video-only content, we create an array of\n  // one item containing a null. This way, the double-loop works for all\n  // kinds of content.\n  // NOTE: we currently don't have support for audio-only content.\n  if (!audioInfos.length)\n    audioInfos = [null];\n  if (!videoInfos.length)\n    videoInfos = [null];\n\n  var variants = [];\n  for (var i = 0; i < audioInfos.length; i++) {\n    for (var j = 0; j < videoInfos.length; j++) {\n      var audioStream = audioInfos[i] ? audioInfos[i].stream : null;\n      var videoStream = videoInfos[j] ? videoInfos[j].stream : null;\n      var audioDrmInfos = audioInfos[i] ? audioInfos[i].drmInfos : null;\n      var videoDrmInfos = videoInfos[j] ? videoInfos[j].drmInfos : null;\n\n      var drmInfos;\n      if (audioStream && videoStream) {\n        if (DrmEngine.areDrmCompatible(audioDrmInfos, videoDrmInfos)) {\n          drmInfos = DrmEngine.getCommonDrmInfos(audioDrmInfos, videoDrmInfos);\n        } else {\n          shaka.log.warning('Incompatible DRM info in HLS variant.  Skipping.');\n          continue;\n        }\n      } else if (audioStream) {\n        drmInfos = audioDrmInfos;\n      } else if (videoStream) {\n        drmInfos = videoDrmInfos;\n      }\n\n      variants.push(this.createVariant_(\n          audioStream, videoStream, bandwidth, drmInfos));\n    }\n  }\n  return variants;\n};\n\n\n/**\n * @param {shakaExtern.Stream} audio\n * @param {shakaExtern.Stream} video\n * @param {number} bandwidth\n * @param {!Array.<shakaExtern.DrmInfo>} drmInfos\n * @return {!shakaExtern.Variant}\n * @private\n */\nshaka.hls.HlsParser.prototype.createVariant_ =\n    function(audio, video, bandwidth, drmInfos) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  // Since both audio and video are of the same type, this assertion will catch\n  // certain mistakes at runtime that the compiler would miss.\n  goog.asserts.assert(!audio || audio.type == ContentType.AUDIO,\n                      'Audio parameter mismatch!');\n  goog.asserts.assert(!video || video.type == ContentType.VIDEO,\n                      'Video parameter mismatch!');\n\n  return {\n    id: this.globalId_++,\n    language: audio ? audio.language : 'und',\n    primary: (!!audio && audio.primary) || (!!video && video.primary),\n    audio: audio,\n    video: video,\n    bandwidth: bandwidth,\n    drmInfos: drmInfos,\n    allowedByApplication: true,\n    allowedByKeySystem: true\n  };\n};\n\n\n/**\n * Parses an EXT-X-MEDIA tag with TYPE=\"SUBTITLES\" into a text stream.\n *\n * @param {!shaka.hls.Tag} tag\n * @param {!shaka.hls.Playlist} playlist\n * @return {!Promise.<?shakaExtern.Stream>}\n * @private\n */\nshaka.hls.HlsParser.prototype.createTextStream_ = function(tag, playlist) {\n  goog.asserts.assert(tag.name == 'EXT-X-MEDIA',\n                      'Should only be called on media tags!');\n\n  var type = shaka.hls.HlsParser.getRequiredAttributeValue_(tag, 'TYPE');\n  goog.asserts.assert(type == 'SUBTITLES',\n                      'Should only be called on tags with TYPE=\"SUBTITLES\"!');\n\n  var timeOffset = this.getTimeOffset_(playlist);\n  return this.createStreamInfoFromMediaTag_(tag, [], timeOffset)\n    .then(function(streamInfo) {\n        return streamInfo.stream;\n      });\n};\n\n\n/**\n * Parse EXT-X-MEDIA media tag into a Stream object.\n *\n * @param {shaka.hls.Tag} tag\n * @param {!Array.<!string>} allCodecs\n * @param {?number} timeOffset\n * @return {!Promise.<shaka.hls.HlsParser.StreamInfo>}\n * @private\n */\nshaka.hls.HlsParser.prototype.createStreamInfoFromMediaTag_ =\n    function(tag, allCodecs, timeOffset) {\n  goog.asserts.assert(tag.name == 'EXT-X-MEDIA',\n                      'Should only be called on media tags!');\n\n  // Check if the stream has already been created as part of another Variant\n  // and return it if it has.\n  if (this.mediaTagsToStreamInfosMap_[tag.id]) {\n    return Promise.resolve().then(function() {\n      return this.mediaTagsToStreamInfosMap_[tag.id];\n    }.bind(this));\n  }\n\n  var HlsParser = shaka.hls.HlsParser;\n  var type = HlsParser.getRequiredAttributeValue_(tag, 'TYPE').toLowerCase();\n  // Shaka recognizes content types 'audio', 'video' and 'text'.\n  // HLS 'subtitles' type needs to be mapped to 'text'.\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (type == 'subtitles') type = ContentType.TEXT;\n\n  var LanguageUtils = shaka.util.LanguageUtils;\n  var language = LanguageUtils.normalize(/** @type {string} */(\n      tag.getAttributeValue('LANGUAGE', 'und')));\n  var label = tag.getAttributeValue('NAME');\n\n  var defaultAttr = tag.getAttribute('DEFAULT');\n  var autoselectAttr = tag.getAttribute('AUTOSELECT');\n  // TODO: Should we take into account some of the currently ignored attributes:\n  // FORCED, INSTREAM-ID, CHARACTERISTICS, CHANNELS?\n  // Attribute descriptions:\n  // https://tools.ietf.org/html/draft-pantos-http-live-streaming-20#section-4.3.4.1\n\n  var uri = HlsParser.getRequiredAttributeValue_(tag, 'URI');\n  var primary = !!defaultAttr || !!autoselectAttr;\n  return this.createStreamInfo_(uri, allCodecs, type, timeOffset, language,\n                                primary, label).then(function(streamInfo) {\n    this.mediaTagsToStreamInfosMap_[tag.id] = streamInfo;\n    return streamInfo;\n  }.bind(this));\n};\n\n\n/**\n * Parse EXT-X-STREAM-INF media tag into a Stream object.\n *\n * @param {!shaka.hls.Tag} tag\n * @param {!Array.<!string>} allCodecs\n * @param {!string} type\n * @param {?number} timeOffset\n * @return {!Promise.<shaka.hls.HlsParser.StreamInfo>}\n * @private\n */\nshaka.hls.HlsParser.prototype.createStreamInfoFromVariantTag_ =\n    function(tag, allCodecs, type, timeOffset) {\n  goog.asserts.assert(tag.name == 'EXT-X-STREAM-INF',\n                      'Should only be called on media tags!');\n\n  var uri = shaka.hls.HlsParser.getRequiredAttributeValue_(tag, 'URI');\n  return this.createStreamInfo_(uri, allCodecs, type, timeOffset,\n                                /* language */ 'und', /* primary */ false,\n                                /* label */ null);\n};\n\n\n/**\n * @param {!string} uri\n * @param {!Array.<!string>} allCodecs\n * @param {!string} type\n * @param {?number} timeOffset\n * @param {!string} language\n * @param {boolean} primary\n * @param {?string} label\n * @return {!Promise.<shaka.hls.HlsParser.StreamInfo>}\n * @throws shaka.util.Error\n * @private\n */\nshaka.hls.HlsParser.prototype.createStreamInfo_ =\n    function(uri, allCodecs, type, timeOffset, language, primary, label) {\n  var Utils = shaka.hls.Utils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var HlsParser = shaka.hls.HlsParser;\n  uri = Utils.constructAbsoluteUri(this.manifestUri_, uri);\n\n  return this.requestManifest_(uri).then(function(response) {\n    var playlistData = response.data;\n    var playlist = this.manifestTextParser_.parsePlaylist(playlistData,\n                                                          response.uri);\n    if (playlist.type != shaka.hls.PlaylistType.MEDIA) {\n      // EXT-X-MEDIA tags should point to media playlists.\n      throw new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.MANIFEST,\n          shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);\n    }\n\n    goog.asserts.assert(playlist.segments != null,\n                        'Media playlist should have segments!');\n\n    // Time offset can be specified on either Master or Media Playlist.\n    // If Media Playlist provides it's own value, use that.\n    // Otherwise, use value from the Master Playlist. If no offset\n    // has been provided it will default to\n    // this.config_.hls.defaultTimeOffset.\n    var mediaPlaylistTimeOffset = this.getTimeOffset_(playlist);\n    timeOffset = mediaPlaylistTimeOffset || timeOffset;\n\n    var initSegmentReference = null;\n    if (type != ContentType.TEXT) {\n      initSegmentReference = this.createInitSegmentReference_(playlist);\n    }\n    var mediaSequenceTag = Utils.getFirstTagWithName(playlist.tags,\n                                                     'EXT-X-MEDIA-SEQUENCE');\n\n    var startPosition = mediaSequenceTag ? Number(mediaSequenceTag.value) : 0;\n    var segments = this.createSegments_(playlist, startPosition);\n\n    this.presentationTimeline_.notifySegments(0, segments);\n    var duration =\n        segments[segments.length - 1].endTime - segments[0].startTime;\n    var presentationDuration = this.presentationTimeline_.getDuration();\n    if (presentationDuration == Infinity || presentationDuration < duration) {\n      this.presentationTimeline_.setDuration(duration);\n    }\n    var codecs = this.guessCodecs_(type, allCodecs);\n\n    var kind = undefined;\n\n    var ManifestParserUtils = shaka.util.ManifestParserUtils;\n    if (type == ManifestParserUtils.ContentType.TEXT)\n      kind = ManifestParserUtils.TextStreamKind.SUBTITLE;\n    // TODO: CLOSED-CAPTIONS requires the parsing of CEA-608 from the video.\n\n    var segmentIndex = new shaka.media.SegmentIndex(segments);\n\n    var drmTags = [];\n    playlist.segments.forEach(function(segment) {\n      var segmentKeyTags = Utils.filterTagsByName(segment.tags, 'EXT-X-KEY');\n      drmTags.push.apply(drmTags, segmentKeyTags);\n    });\n\n    var encrypted = false;\n    var drmInfos = [];\n    var keyId = null;\n\n    // TODO: may still need changes to support key rotation\n    drmTags.forEach(function(drmTag) {\n      var method = HlsParser.getRequiredAttributeValue_(drmTag, 'METHOD');\n      if (method != 'NONE') {\n        encrypted = true;\n\n        var keyFormat =\n            HlsParser.getRequiredAttributeValue_(drmTag, 'KEYFORMAT');\n        var drmParser =\n            shaka.hls.HlsParser.KEYFORMATS_TO_DRM_PARSERS_[keyFormat];\n\n        var drmInfo = drmParser ? drmParser(drmTag) : null;\n        if (drmInfo) {\n          if (drmInfo.keyIds.length) {\n            keyId = drmInfo.keyIds[0];\n          }\n          drmInfos.push(drmInfo);\n        } else {\n          shaka.log.warning('Unsupported HLS KEYFORMAT', keyFormat);\n        }\n      }\n    });\n\n    if (encrypted && !drmInfos.length) {\n      throw new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.MANIFEST,\n          shaka.util.Error.Code.HLS_KEYFORMATS_NOT_SUPPORTED);\n    }\n\n    return this.guessMimeType_(type, segments[0].getUris()[0])\n        .then(function(mimeType) {\n          var stream = {\n            id: this.globalId_++,\n            createSegmentIndex: Promise.resolve.bind(Promise),\n            findSegmentPosition: segmentIndex.find.bind(segmentIndex),\n            getSegmentReference: segmentIndex.get.bind(segmentIndex),\n            initSegmentReference: initSegmentReference,\n            presentationTimeOffset: timeOffset || 0,\n            mimeType: mimeType,\n            codecs: codecs,\n            kind: kind,\n            encrypted: encrypted,\n            keyId: keyId,\n            language: language,\n            label: label || null,\n            type: type,\n            primary: primary,\n            // TODO: trick mode\n            trickModeVideo: null,\n            containsEmsgBoxes: false,\n            frameRate: undefined,\n            width: undefined,\n            height: undefined,\n            bandwidth: undefined,\n            roles: []\n          };\n\n          this.streamsToIndexMap_[stream.id] = segmentIndex;\n\n          return {\n            stream: stream,\n            segmentIndex: segmentIndex,\n            drmInfos: drmInfos\n          };\n        }.bind(this));\n  }.bind(this));\n\n};\n\n\n/**\n * @param {!shaka.hls.Playlist} playlist\n * @return {shaka.media.InitSegmentReference}\n * @private\n * @throws {shaka.util.Error}\n */\nshaka.hls.HlsParser.prototype.createInitSegmentReference_ = function(playlist) {\n  var Utils = shaka.hls.Utils;\n  var mapTags = Utils.filterTagsByName(playlist.tags, 'EXT-X-MAP');\n  // TODO: Support multiple map tags?\n  // For now, we don't support multiple map tags and will throw an error.\n  if (!mapTags.length) {\n    return null;\n  } else if (mapTags.length > 1) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND);\n  }\n\n  // Map tag example: #EXT-X-MAP:URI=\"main.mp4\",BYTERANGE=\"720@0\"\n  var mapTag = mapTags[0];\n  var initUri = shaka.hls.HlsParser.getRequiredAttributeValue_(mapTag, 'URI');\n  var uri = Utils.constructAbsoluteUri(playlist.uri, initUri);\n  var startByte = 0;\n  var endByte = null;\n  var byterange = mapTag.getAttributeValue('BYTERANGE');\n  // If BYTERANGE attribute is not specified, the segment consists\n  // of the entire resourse.\n  if (byterange) {\n    var blocks = byterange.split('@');\n    var byteLength = Number(blocks[0]);\n    startByte = Number(blocks[1]);\n    endByte = startByte + byteLength - 1;\n  }\n\n  return new shaka.media.InitSegmentReference(function() { return [uri]; },\n                                              startByte,\n                                              endByte);\n};\n\n\n/**\n * Parses shaka.hls.Segment objects into shaka.media.SegmentReferences.\n *\n * @param {!shaka.hls.Playlist} playlist\n * @param {number} startPosition\n * @return {!Array.<!shaka.media.SegmentReference>}\n * @private\n */\nshaka.hls.HlsParser.prototype.createSegments_ =\n    function(playlist, startPosition) {\n  var hlsSegments = playlist.segments;\n  var segments = [];\n\n  hlsSegments.forEach(function(segment) {\n    var Utils = shaka.hls.Utils;\n    var tags = segment.tags;\n    var uri = Utils.constructAbsoluteUri(playlist.uri, segment.uri);\n\n    // Start and end times\n    var extinfTag = this.getRequiredTag_(tags, 'EXTINF');\n    // EXTINF tag format is '#EXTINF:<duration>,[<title>]'.\n    // We're interested in the duration part.\n    var extinfValues = extinfTag.value.split(',');\n    var duration = Number(extinfValues[0]);\n    var startTime;\n    var index = hlsSegments.indexOf(segment);\n    if (index == 0) {\n      startTime = 0;\n    } else {\n      startTime = segments[index - 1].endTime;\n    }\n    var endTime = startTime + duration;\n\n    // StartByte and EndByte\n    var startByte = 0;\n    var endByte = null;\n    var byterange = Utils.getFirstTagWithName(tags, 'EXT-X-BYTERANGE');\n    // If BYTERANGE is not specified, the segment consists of the\n    // entire resourse.\n    if (byterange) {\n      var blocks = byterange.value.split('@');\n      var byteLength = Number(blocks[0]);\n      if (blocks[1]) {\n        startByte = Number(blocks[1]);\n      } else {\n        startByte = segments[index - 1].endByte;\n      }\n      endByte = startByte + byteLength - 1;\n\n      // Last segment has endByte of null to indicate that it extends\n      // to the end of the resource.\n      if (index == hlsSegments.length - 1)\n        endByte = null;\n    }\n    segments.push(new shaka.media.SegmentReference(startPosition + index,\n                                                   startTime,\n                                                   endTime,\n                                                   function() { return [uri]; },\n                                                   startByte,\n                                                   endByte));\n  }.bind(this));\n\n  return segments;\n};\n\n\n/**\n * Adjusts segment references of every stream of every variant to the\n * timeline of the presentation.\n * @param {!Array.<!shakaExtern.Variant>} variants\n * @private\n */\nshaka.hls.HlsParser.prototype.fitSegments_ = function(variants) {\n  variants.forEach(function(variant) {\n    var duration = this.presentationTimeline_.getDuration();\n    var video = variant.video;\n    var audio = variant.audio;\n    if (video && this.streamsToIndexMap_[video.id]) {\n      this.streamsToIndexMap_[video.id].fit(duration);\n    }\n    if (audio && this.streamsToIndexMap_[audio.id]) {\n      this.streamsToIndexMap_[audio.id].fit(duration);\n    }\n  }.bind(this));\n};\n\n\n/**\n * Attempts to guess which codecs from the codecs list belong\n * to a given content type.\n *\n * @param {!string} contentType\n * @param {!Array.<!string>} codecs\n * @return {string}\n * @private\n * @throws {shaka.util.Error}\n */\nshaka.hls.HlsParser.prototype.guessCodecs_ = function(contentType, codecs) {\n  if (codecs.length == 1) {\n    return codecs[0];\n  }\n\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (contentType == ContentType.TEXT) {\n    return '';\n  }\n\n  var HlsParser = shaka.hls.HlsParser;\n  var formats = HlsParser.VIDEO_CODEC_FORMATS_;\n  if (contentType == ContentType.AUDIO)\n    formats = HlsParser.AUDIO_CODEC_FORMATS_;\n\n  for (var i = 0; i < formats.length; i++) {\n    for (var j = 0; j < codecs.length; j++) {\n      if (formats[i].test(codecs[j].trim())) {\n        return codecs[j].trim();\n      }\n    }\n  }\n\n  // Unable to guess codecs.\n  throw new shaka.util.Error(\n      shaka.util.Error.Severity.CRITICAL,\n      shaka.util.Error.Category.MANIFEST,\n      shaka.util.Error.Code.HLS_COULD_NOT_GUESS_CODECS,\n      codecs);\n};\n\n\n/**\n * Attempts to guess stream's mime type based on content type and uri.\n *\n * @param {!string} contentType\n * @param {!string} uri\n * @return {!Promise.<!string>}\n * @private\n * @throws {shaka.util.Error}\n */\nshaka.hls.HlsParser.prototype.guessMimeType_ = function(contentType, uri) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var blocks = uri.split('.');\n  var extension = blocks[blocks.length - 1];\n\n  if (contentType == ContentType.TEXT) {\n    // HLS only supports vtt at the moment.\n    return Promise.resolve('text/vtt');\n  }\n\n  var HlsParser = shaka.hls.HlsParser;\n  var map = HlsParser.AUDIO_EXTENSIONS_TO_MIME_TYPES_;\n  if (contentType == ContentType.VIDEO)\n    map = HlsParser.VIDEO_EXTENSIONS_TO_MIME_TYPES_;\n\n  var mimeType = map[extension];\n  if (mimeType)\n    return Promise.resolve(mimeType);\n\n  // If unable to guess mime type, request a segment and try getting it\n  // from the response.\n  var headRequest = shaka.net.NetworkingEngine.makeRequest(\n      [uri], this.config_.retryParameters);\n  headRequest.method = 'HEAD';\n  var requestType = shaka.net.NetworkingEngine.RequestType.SEGMENT;\n  return this.playerInterface_.networkingEngine.request(\n      requestType, headRequest)\n    .then(function(response) {\n        var mimeType = response.headers['content-type'];\n        if (!mimeType) {\n          throw new shaka.util.Error(\n              shaka.util.Error.Severity.CRITICAL,\n              shaka.util.Error.Category.MANIFEST,\n              shaka.util.Error.Code.HLS_COULD_NOT_GUESS_MIME_TYPE,\n              extension);\n        }\n\n        return mimeType;\n      });\n};\n\n\n/**\n * Get presentation time offset of the playlist if it has been specified.\n * Return null otherwise.\n *\n * @param {!shaka.hls.Playlist} playlist\n * @return {?number}\n * @private\n */\nshaka.hls.HlsParser.prototype.getTimeOffset_ = function(playlist) {\n  var Utils = shaka.hls.Utils;\n  var startTag = Utils.getFirstTagWithName(playlist.tags, 'EXT-X-START');\n  // TODO: Should we respect the PRECISE flag?\n  // https://tools.ietf.org/html/draft-pantos-http-live-streaming-20#section-4.3.5.2\n  if (startTag)\n    return Number(shaka.hls.HlsParser.getRequiredAttributeValue_(\n        startTag, 'TIME-OFFSET'));\n\n  return this.config_.hls.defaultTimeOffset;\n};\n\n\n/**\n * Find the attribute and returns its value.\n * Throws an error if attribute was not found.\n *\n * @param {shaka.hls.Tag} tag\n * @param {!string} attributeName\n * @return {!string}\n * @private\n * @throws {shaka.util.Error}\n */\nshaka.hls.HlsParser.getRequiredAttributeValue_ =\n    function(tag, attributeName) {\n  var attribute = tag.getAttribute(attributeName);\n  if (!attribute) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.HLS_REQUIRED_ATTRIBUTE_MISSING,\n        attributeName);\n  }\n\n  return attribute.value;\n};\n\n\n/**\n * Returns a tag with a given name.\n * Throws an error if tag was not found.\n *\n * @param {!Array.<shaka.hls.Tag>} tags\n * @param {!string} tagName\n * @return {!shaka.hls.Tag}\n * @private\n * @throws {shaka.util.Error}\n */\nshaka.hls.HlsParser.prototype.getRequiredTag_ = function(tags, tagName) {\n  var Utils = shaka.hls.Utils;\n  var tag = Utils.getFirstTagWithName(tags, tagName);\n  if (!tag) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.MANIFEST,\n        shaka.util.Error.Code.HLS_REQUIRED_TAG_MISSING, tagName);\n  }\n\n  return tag;\n};\n\n\n/**\n * @param {shakaExtern.Stream} stream\n * @param {?string} width\n * @param {?string} height\n * @param {?string} frameRate\n * @private\n */\nshaka.hls.HlsParser.prototype.addVideoAttributes_ =\n    function(stream, width, height, frameRate) {\n  if (stream) {\n    stream.width = Number(width) || undefined;\n    stream.height = Number(height) || undefined;\n    stream.frameRate = Number(frameRate) || undefined;\n  }\n};\n\n\n/**\n * Makes a network request for the manifest and returns a Promise\n * with the resulting data.\n *\n * @param {!string} uri\n * @return {!Promise.<!shakaExtern.Response>}\n * @private\n */\nshaka.hls.HlsParser.prototype.requestManifest_ = function(uri) {\n  var requestType = shaka.net.NetworkingEngine.RequestType.MANIFEST;\n  var request = shaka.net.NetworkingEngine.makeRequest(\n      [uri], this.config_.retryParameters);\n  return this.playerInterface_.networkingEngine.request(requestType, request);\n};\n\n\n/**\n * A list of well-known video codecs formats.\n *\n * @const {!Array<!RegExp>}\n * @private\n */\nshaka.hls.HlsParser.VIDEO_CODEC_FORMATS_ = [\n  /^(avc)/,\n  /^(hvc)/,\n  /^(vp[8-9])$/,\n  /^(av1)$/,\n  /^(mp4v)/\n];\n\n\n/**\n * A list of well-known audio codecs formats.\n *\n * @const {!Array<!RegExp>}\n * @private\n */\nshaka.hls.HlsParser.AUDIO_CODEC_FORMATS_ = [\n  /^(vorbis)/,\n  /^(opus)/,\n  /^(mp4a)/,\n  /^(ac-3)$/,\n  /^(ec-3)$/\n];\n\n\n/**\n * @const {!Object<string, string>}\n * @private\n */\nshaka.hls.HlsParser.AUDIO_EXTENSIONS_TO_MIME_TYPES_ = {\n  'mp4': 'audio/mp4',\n  'm4s': 'audio/mp4',\n  'm4i': 'audio/mp4',\n  'm4a': 'audio/mp4',\n  // mpeg2 ts aslo uses video/ for audio: http://goo.gl/tYHXiS\n  'ts': 'video/mp2t'\n};\n\n\n/**\n * @const {!Object<string, string>}\n * @private\n */\nshaka.hls.HlsParser.VIDEO_EXTENSIONS_TO_MIME_TYPES_ = {\n  'mp4': 'video/mp4',\n  'm4s': 'video/mp4',\n  'm4i': 'video/mp4',\n  'm4v': 'video/mp4',\n  'ts': 'video/mp2t'\n};\n\n\n/**\n * @typedef {function(!shaka.hls.Tag):?shakaExtern.DrmInfo}\n * @private\n */\nshaka.hls.HlsParser.DrmParser_;\n\n\n/**\n * @param {!shaka.hls.Tag} drmTag\n * @return {?shakaExtern.DrmInfo}\n * @private\n */\nshaka.hls.HlsParser.widevineDrmParser_ = function(drmTag) {\n  var HlsParser = shaka.hls.HlsParser;\n  var method = HlsParser.getRequiredAttributeValue_(drmTag, 'METHOD');\n  if (method != 'SAMPLE-AES-CENC') {\n    shaka.log.error(\n        'Widevine in HLS is only supported with SAMPLE-AES-CENC, not', method);\n    return null;\n  }\n\n  var uri = HlsParser.getRequiredAttributeValue_(drmTag, 'URI');\n  var parsedData = shaka.net.DataUriPlugin.parse(uri);\n\n  // The data encoded in the URI is a PSSH box to be used as init data.\n  var pssh = new Uint8Array(parsedData.data);\n  var drmInfo = shaka.util.ManifestParserUtils.createDrmInfo(\n      'com.widevine.alpha', [\n        {initDataType: 'cenc', initData: pssh}\n      ]);\n\n  var keyId = drmTag.getAttributeValue('KEYID');\n  if (keyId) {\n    // This value begins with '0x':\n    goog.asserts.assert(keyId.substr(0, 2) == '0x',\n                        'Incorrect KEYID format!');\n    // But the output does not contain the '0x':\n    drmInfo.keyIds = [keyId.substr(2).toLowerCase()];\n  }\n  return drmInfo;\n};\n\n\n/**\n * @const {!Object.<string, shaka.hls.HlsParser.DrmParser_>}\n * @private\n */\nshaka.hls.HlsParser.KEYFORMATS_TO_DRM_PARSERS_ = {\n  /* TODO: https://github.com/google/shaka-player/issues/382\n  'com.apple.streamingkeydelivery':\n      shaka.hls.HlsParser.fairplayDrmParser_,\n  */\n  'urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed':\n      shaka.hls.HlsParser.widevineDrmParser_\n};\n\n\nshaka.media.ManifestParser.registerParserByExtension(\n    'm3u8', shaka.hls.HlsParser);\nshaka.media.ManifestParser.registerParserByMime(\n    'application/x-mpegurl', shaka.hls.HlsParser);\nshaka.media.ManifestParser.registerParserByMime(\n    'application/vnd.apple.mpegurl', shaka.hls.HlsParser);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/hls/hls_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.TtmlTextParser');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.media.TextEngine');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.StringUtils');\n\n\n\n/**\n * @constructor\n * @implements {shakaExtern.TextParser}\n */\nshaka.media.TtmlTextParser = function() {};\n\n\n/** @override */\nshaka.media.TtmlTextParser.prototype.parseInit = function(data) {\n  goog.asserts.assert(false, 'TTML does not have init segments');\n};\n\n\n/** @override */\nshaka.media.TtmlTextParser.prototype.parseMedia = function(data, time) {\n  var str = shaka.util.StringUtils.fromUTF8(data);\n  var ret = [];\n  var parser = new DOMParser();\n  var xml = null;\n\n  try {\n    xml = parser.parseFromString(str, 'text/xml');\n  } catch (exception) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.INVALID_XML);\n  }\n\n  if (xml) {\n    // Try to get the framerate, subFrameRate and frameRateMultiplier\n    // if applicable\n    var frameRate = null;\n    var subFrameRate = null;\n    var frameRateMultiplier = null;\n    var tickRate = null;\n    var spaceStyle = null;\n    var tts = xml.getElementsByTagName('tt');\n    var tt = tts[0];\n    // TTML should always have tt element\n    if (!tt) {\n      throw new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.TEXT,\n          shaka.util.Error.Code.INVALID_XML);\n    } else {\n      frameRate = tt.getAttribute('ttp:frameRate');\n      subFrameRate = tt.getAttribute('ttp:subFrameRate');\n      frameRateMultiplier = tt.getAttribute('ttp:frameRateMultiplier');\n      tickRate = tt.getAttribute('ttp:tickRate');\n      spaceStyle = tt.getAttribute('xml:space') || 'default';\n    }\n\n    if (spaceStyle != 'default' && spaceStyle != 'preserve') {\n      throw new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.TEXT,\n          shaka.util.Error.Code.INVALID_XML);\n    }\n    var whitespaceTrim = spaceStyle == 'default';\n\n    var rateInfo = new shaka.media.TtmlTextParser.RateInfo_(\n        frameRate, subFrameRate, frameRateMultiplier, tickRate);\n\n    var styles = shaka.media.TtmlTextParser.getLeafNodes_(\n        tt.getElementsByTagName('styling')[0]);\n    var regions = shaka.media.TtmlTextParser.getLeafNodes_(\n        tt.getElementsByTagName('layout')[0]);\n    var textNodes = shaka.media.TtmlTextParser.getLeafNodes_(\n        tt.getElementsByTagName('body')[0]);\n\n    for (var i = 0; i < textNodes.length; i++) {\n      var cue = shaka.media.TtmlTextParser.parseCue_(textNodes[i],\n                                                     time.periodStart,\n                                                     rateInfo,\n                                                     styles,\n                                                     regions,\n                                                     whitespaceTrim);\n      if (cue)\n        ret.push(cue);\n    }\n  }\n\n  return ret;\n};\n\n\n/**\n * @const\n * @private {!RegExp}\n * @example 00:00:40:07 (7 frames) or 00:00:40:07.1 (7 frames, 1 subframe)\n */\nshaka.media.TtmlTextParser.timeColonFormatFrames_ =\n    /^(\\d{2,}):(\\d{2}):(\\d{2}):(\\d{2})\\.?(\\d+)?$/;\n\n\n/**\n * @const\n * @private {!RegExp}\n * @example 00:00:40 or 00:40\n */\nshaka.media.TtmlTextParser.timeColonFormat_ =\n    /^(?:(\\d{2,}):)?(\\d{2}):(\\d{2})$/;\n\n\n/**\n * @const\n * @private {!RegExp}\n * example 01:02:43.0345555 or 02:43.03\n */\nshaka.media.TtmlTextParser.timeColonFormatMilliseconds_ =\n    /^(?:(\\d{2,}):)?(\\d{2}):(\\d{2}\\.\\d{2,})$/;\n\n\n/**\n * @const\n * @private {!RegExp}\n * @example 75f or 75.5f\n */\nshaka.media.TtmlTextParser.timeFramesFormat_ = /^(\\d*\\.?\\d*)f$/;\n\n\n/**\n * @const\n * @private {!RegExp}\n * @example 50t or 50.5t\n */\nshaka.media.TtmlTextParser.timeTickFormat_ = /^(\\d*\\.?\\d*)t$/;\n\n\n/**\n * @const\n * @private {!RegExp}\n * @example 3.45h, 3m or 4.20s\n */\nshaka.media.TtmlTextParser.timeHMSFormat_ =\n    /^(?:(\\d*\\.?\\d*)h)?(?:(\\d*\\.?\\d*)m)?(?:(\\d*\\.?\\d*)s)?(?:(\\d*\\.?\\d*)ms)?$/;\n\n\n/**\n * @const\n * @private {!RegExp}\n * @example 50% 10%\n */\nshaka.media.TtmlTextParser.percentValues_ = /^(\\d{1,2}|100)% (\\d{1,2}|100)%$/;\n\n\n/**\n * @const\n * @private {!Object}\n */\nshaka.media.TtmlTextParser.textAlignToLineAlign_ = {\n  'left': 'start',\n  'center': 'center',\n  'right': 'end',\n  'start': 'start',\n  'end': 'end'\n};\n\n\n/**\n * @const\n * @private {!Object}\n */\nshaka.media.TtmlTextParser.textAlignToPositionAlign_ = {\n  'left': 'line-left',\n  'center': 'center',\n  'right': 'line-right'\n};\n\n\n/**\n * Gets leaf nodes of the xml node tree. Ignores the text, br elements\n * and the spans positioned inside paragraphs\n *\n * @param {Element} element\n * @return {!Array.<!Element>}\n * @private\n */\nshaka.media.TtmlTextParser.getLeafNodes_ = function(element) {\n  var result = [];\n  if (!element)\n    return result;\n\n  var childNodes = element.childNodes;\n  for (var i = 0; i < childNodes.length; i++) {\n    // Currently we don't support styles applicable to span\n    // elements, so they are ignored\n    var isSpanChildOfP = childNodes[i].nodeName == 'span' &&\n        element.nodeName == 'p';\n    if (childNodes[i].nodeType == Node.ELEMENT_NODE &&\n        childNodes[i].nodeName != 'br' && !isSpanChildOfP) {\n      // Get the leafs the child might contain\n      goog.asserts.assert(childNodes[i] instanceof Element,\n                          'Node should be Element!');\n      var leafChildren = shaka.media.TtmlTextParser.getLeafNodes_(\n          /** @type {Element} */(childNodes[i]));\n      goog.asserts.assert(leafChildren.length > 0,\n                          'Only a null Element should return no leaves!');\n      result = result.concat(leafChildren);\n    }\n  }\n\n  // if no result at this point, the element itself must be a leaf\n  if (!result.length) {\n    result.push(element);\n  }\n  return result;\n};\n\n\n/**\n * Insert \\n where <br> tags are found\n *\n * @param {!Node} element\n * @param {boolean} whitespaceTrim\n * @private\n */\nshaka.media.TtmlTextParser.addNewLines_ = function(element, whitespaceTrim) {\n  var childNodes = element.childNodes;\n\n  for (var i = 0; i < childNodes.length; i++) {\n    if (childNodes[i].nodeName == 'br' && i > 0) {\n      childNodes[i - 1].textContent += '\\n';\n    } else if (childNodes[i].childNodes.length > 0) {\n      shaka.media.TtmlTextParser.addNewLines_(childNodes[i], whitespaceTrim);\n    } else if (whitespaceTrim) {\n      // Trim leading and trailing whitespace.\n      var trimmed = childNodes[i].textContent.trim();\n      // Collapse multiple spaces into one.\n      trimmed = trimmed.replace(/\\s+/g, ' ');\n\n      childNodes[i].textContent = trimmed;\n    }\n  }\n};\n\n\n/**\n * Parses an Element into a TextTrackCue or VTTCue.\n *\n * @param {!Element} cueElement\n * @param {number} offset\n * @param {!shaka.media.TtmlTextParser.RateInfo_} rateInfo\n * @param {!Array.<!Element>} styles\n * @param {!Array.<!Element>} regions\n * @param {boolean} whitespaceTrim\n * @return {TextTrackCue}\n * @private\n */\nshaka.media.TtmlTextParser.parseCue_ = function(\n    cueElement, offset, rateInfo, styles, regions, whitespaceTrim) {\n\n  // Disregard empty elements:\n  // TTML allows for empty elements like <div></div>.\n  // If cueElement has neither time attributes, nor\n  // non-whitespace text, don't try to make a cue out of it.\n  if (!cueElement.hasAttribute('begin') &&\n      !cueElement.hasAttribute('end') &&\n      /^\\s*$/.test(cueElement.textContent))\n    return null;\n\n  shaka.media.TtmlTextParser.addNewLines_(cueElement, whitespaceTrim);\n\n  // Get time\n  var start = shaka.media.TtmlTextParser.parseTime_(\n      cueElement.getAttribute('begin'), rateInfo);\n  var end = shaka.media.TtmlTextParser.parseTime_(\n      cueElement.getAttribute('end'), rateInfo);\n  var duration = shaka.media.TtmlTextParser.parseTime_(\n      cueElement.getAttribute('dur'), rateInfo);\n  var payload = cueElement.textContent;\n\n  if (end == null && duration != null)\n    end = start + duration;\n\n  if (start == null || end == null) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.INVALID_TEXT_CUE);\n  }\n\n  start += offset;\n  end += offset;\n\n  var cue = shaka.media.TextEngine.makeCue(start, end, payload);\n  if (!cue)\n    return null;\n\n  // Get other properties if available\n  var region = shaka.media.TtmlTextParser.getElementFromCollection_(\n      cueElement, 'region', regions);\n  shaka.media.TtmlTextParser.addStyle_(cue, cueElement, region, styles);\n\n  return cue;\n};\n\n\n/**\n * Adds applicable style properties to a cue.\n *\n * @param {!TextTrackCue} cue\n * @param {!Element} cueElement\n * @param {Element} region\n * @param {!Array.<!Element>} styles\n * @private\n */\nshaka.media.TtmlTextParser.addStyle_ = function(\n    cue, cueElement, region, styles) {\n  var TtmlTextParser = shaka.media.TtmlTextParser;\n  var results = null;\n\n\n  var extent = TtmlTextParser.getStyleAttribute_(\n      cueElement, region, styles, 'tts:extent');\n  if (extent) {\n    results = TtmlTextParser.percentValues_.exec(extent);\n    if (results != null) {\n      // Use width value of the extent attribute for size.\n      // Height value is ignored.\n      cue.size = Number(results[1]);\n    }\n  }\n\n  var writingMode = TtmlTextParser.getStyleAttribute_(\n      cueElement, region, styles, 'tts:writingMode');\n  var isVerticalText = true;\n  if (writingMode == 'tb' || writingMode == 'tblr')\n    cue.vertical = 'lr';\n  else if (writingMode == 'tbrl')\n    cue.vertical = 'rl';\n  else\n    isVerticalText = false;\n\n  var origin = TtmlTextParser.getStyleAttribute_(\n      cueElement, region, styles, 'tts:origin');\n  if (origin) {\n    results = TtmlTextParser.percentValues_.exec(origin);\n    if (results != null) {\n      // for vertical text use first coordinate of tts:origin\n      // to represent line of the cue and second - for position.\n      // Otherwise (horizontal), use them the other way around.\n      if (isVerticalText) {\n        cue.position = Number(results[2]);\n        cue.line = Number(results[1]);\n      } else {\n        cue.position = Number(results[1]);\n        cue.line = Number(results[2]);\n      }\n      // A boolean indicating whether the line is an integer\n      // number of lines (using the line dimensions of the first\n      // line of the cue), or whether it is a percentage of the\n      // dimension of the video. The flag is set to true when lines\n      // are counted, and false otherwise.\n      cue.snapToLines = false;\n    }\n  }\n\n  var align = TtmlTextParser.getStyleAttribute_(\n      cueElement, region, styles, 'tts:textAlign');\n  if (align) {\n    cue.align = align;\n    if (align == 'center') {\n      if (cue.align != 'center') {\n        // Workaround for a Chrome bug http://crbug.com/663797\n        // Chrome does not support align = 'center'\n        cue.align = 'middle';\n      }\n      cue.position = 'auto';\n    }\n    cue.positionAlign = TtmlTextParser.textAlignToPositionAlign_[align];\n    cue.lineAlign = TtmlTextParser.textAlignToLineAlign_[align];\n  }\n};\n\n\n/**\n * Finds a specified attribute on either the original cue element or its\n * associated region and returns the value if the attribute was found.\n *\n * @param {!Element} cueElement\n * @param {Element} region\n * @param {!Array.<!Element>} styles\n * @param {string} attribute\n * @return {?string}\n * @private\n */\nshaka.media.TtmlTextParser.getStyleAttribute_ = function(\n    cueElement, region, styles, attribute) {\n\n  // An attribute can be specified on region level or in a styling block\n  // associated with the region or original element.\n  var regionChildren = shaka.media.TtmlTextParser.getLeafNodes_(region);\n  for (var i = 0; i < regionChildren.length; i++) {\n    var attr = regionChildren[i].getAttribute(attribute);\n    if (attr)\n      return attr;\n  }\n\n  var getElementFromCollection_ =\n      shaka.media.TtmlTextParser.getElementFromCollection_;\n  var style = getElementFromCollection_(region, 'style', styles) ||\n              getElementFromCollection_(cueElement, 'style', styles);\n  if (style)\n    return style.getAttribute(attribute);\n  return null;\n};\n\n\n/**\n * Selects an item from |collection| whose id matches |attributeName|\n * from |element|.\n *\n * @param {Element} element\n * @param {string} attributeName\n * @param {!Array.<Element>} collection\n * @return {Element}\n * @private\n */\nshaka.media.TtmlTextParser.getElementFromCollection_ = function(\n    element, attributeName, collection) {\n  if (!element || collection.length < 1) {\n    return null;\n  }\n  var item = null;\n  var itemName = shaka.media.TtmlTextParser.getInheritedAttribute_(\n      element, attributeName);\n  if (itemName) {\n    for (var i = 0; i < collection.length; i++) {\n      if (collection[i].getAttribute('xml:id') == itemName) {\n        item = collection[i];\n        break;\n      }\n    }\n  }\n\n  return item;\n};\n\n\n/**\n * Traverses upwards from a given node until a given attribute is found.\n *\n * @param {!Element} element\n * @param {string} attributeName\n * @return {?string}\n * @private\n */\nshaka.media.TtmlTextParser.getInheritedAttribute_ = function(\n    element, attributeName) {\n  var ret = null;\n  while (element) {\n    ret = element.getAttribute(attributeName);\n    if (ret) {\n      break;\n    }\n\n    // Element.parentNode can lead to XMLDocument, which is not an Element and\n    // has no getAttribute().\n    var parentNode = element.parentNode;\n    if (parentNode instanceof Element) {\n      element = parentNode;\n    } else {\n      break;\n    }\n  }\n  return ret;\n};\n\n\n/**\n * Parses a TTML time from the given word.\n *\n * @param {string} text\n * @param {!shaka.media.TtmlTextParser.RateInfo_} rateInfo\n * @return {?number}\n * @private\n */\nshaka.media.TtmlTextParser.parseTime_ = function(text, rateInfo) {\n  var ret = null;\n  var TtmlTextParser = shaka.media.TtmlTextParser;\n\n  if (TtmlTextParser.timeColonFormatFrames_.test(text)) {\n    ret = TtmlTextParser.parseColonTimeWithFrames_(rateInfo, text);\n  } else if (TtmlTextParser.timeColonFormat_.test(text)) {\n    ret = TtmlTextParser.parseTimeFromRegex_(\n        TtmlTextParser.timeColonFormat_, text);\n  } else if (TtmlTextParser.timeColonFormatMilliseconds_.test(text)) {\n    ret = TtmlTextParser.parseTimeFromRegex_(\n        TtmlTextParser.timeColonFormatMilliseconds_, text);\n  } else if (TtmlTextParser.timeFramesFormat_.test(text)) {\n    ret = TtmlTextParser.parseFramesTime_(rateInfo, text);\n  } else if (TtmlTextParser.timeTickFormat_.test(text)) {\n    ret = TtmlTextParser.parseTickTime_(rateInfo, text);\n  } else if (TtmlTextParser.timeHMSFormat_.test(text)) {\n    ret = TtmlTextParser.parseTimeFromRegex_(\n        TtmlTextParser.timeHMSFormat_, text);\n  }\n\n  return ret;\n};\n\n\n/**\n * Parses a TTML time in frame format\n *\n * @param {!shaka.media.TtmlTextParser.RateInfo_} rateInfo\n * @param {string} text\n * @return {?number}\n * @private\n */\nshaka.media.TtmlTextParser.parseFramesTime_ = function(rateInfo, text) {\n\n  // 75f or 75.5f\n  var results = shaka.media.TtmlTextParser.timeFramesFormat_.exec(text);\n  var frames = Number(results[1]);\n\n  return frames / rateInfo.frameRate;\n};\n\n\n/**\n * Parses a TTML time in tick format\n *\n * @param {!shaka.media.TtmlTextParser.RateInfo_} rateInfo\n * @param {string} text\n * @return {?number}\n * @private\n */\nshaka.media.TtmlTextParser.parseTickTime_ = function(rateInfo, text) {\n\n  // 50t or 50.5t\n  var results = shaka.media.TtmlTextParser.timeTickFormat_.exec(text);\n  var ticks = Number(results[1]);\n\n  return ticks / rateInfo.tickRate;\n};\n\n\n/**\n * Parses a TTML colon formatted time containing frames\n *\n * @param {!shaka.media.TtmlTextParser.RateInfo_} rateInfo\n * @param {string} text\n * @return {?number}\n * @private\n */\nshaka.media.TtmlTextParser.parseColonTimeWithFrames_ = function(\n    rateInfo, text) {\n\n  // 01:02:43:07 ('07' is frames) or 01:02:43:07.1 (subframes)\n  var results = shaka.media.TtmlTextParser.timeColonFormatFrames_.exec(text);\n\n  var hours = Number(results[1]);\n  var minutes = Number(results[2]);\n  var seconds = Number(results[3]);\n  var frames = Number(results[4]);\n  var subframes = Number(results[5]) || 0;\n\n  frames += subframes / rateInfo.subFrameRate;\n  seconds += frames / rateInfo.frameRate;\n\n  return seconds + (minutes * 60) + (hours * 3600);\n};\n\n\n/**\n * Parses a TTML time with a given regex. Expects regex to be some\n * sort of a time-matcher to match hours, minutes, seconds and milliseconds\n *\n * @param {!RegExp} regex\n * @param {string} text\n * @return {?number}\n * @private\n */\nshaka.media.TtmlTextParser.parseTimeFromRegex_ = function(regex, text) {\n  var results = regex.exec(text);\n  if (results == null || results[0] == '')\n    return null;\n  // This capture is optional, but will still be in the array as undefined,\n  // default to 0.\n  var hours = Number(results[1]) || 0;\n  var minutes = Number(results[2]) || 0;\n  var seconds = Number(results[3]) || 0;\n  var miliseconds = Number(results[4]) || 0;\n\n  return (miliseconds / 1000) + seconds + (minutes * 60) + (hours * 3600);\n};\n\n\n\n/**\n * Contains information about frame/subframe rate\n * and frame rate multiplier for time in frame format.\n * ex. 01:02:03:04(4 frames) or 01:02:03:04.1(4 frames, 1 subframe)\n *\n * @param {?string} frameRate\n * @param {?string} subFrameRate\n * @param {?string} frameRateMultiplier\n * @param {?string} tickRate\n * @constructor\n * @struct\n * @private\n */\nshaka.media.TtmlTextParser.RateInfo_ = function(\n    frameRate, subFrameRate, frameRateMultiplier, tickRate) {\n\n  /**\n   * @type {number}\n   */\n  this.frameRate = Number(frameRate) || 30;\n\n  /**\n   * @type {number}\n   */\n  this.subFrameRate = Number(subFrameRate) || 1;\n\n  /**\n   * @type {number}\n   */\n  this.tickRate = Number(tickRate);\n  if (this.tickRate == 0) {\n    if (frameRate)\n      this.tickRate = this.frameRate * this.subFrameRate;\n    else\n      this.tickRate = 1;\n  }\n\n  if (frameRateMultiplier) {\n    var multiplierResults = /^(\\d+) (\\d+)$/g.exec(frameRateMultiplier);\n    if (multiplierResults) {\n      var numerator = multiplierResults[1];\n      var denominator = multiplierResults[2];\n      var multiplierNum = numerator / denominator;\n      this.frameRate *= multiplierNum;\n    }\n  }\n};\n\n\nshaka.media.TextEngine.registerParser(\n    'application/ttml+xml',\n    shaka.media.TtmlTextParser);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/ttml_text_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.Mp4TtmlParser');\n\ngoog.require('shaka.media.TextEngine');\ngoog.require('shaka.media.TtmlTextParser');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Mp4Parser');\n\n\n\n/**\n * @struct\n * @constructor\n * @implements {shakaExtern.TextParser}\n */\nshaka.media.Mp4TtmlParser = function() {\n  /**\n   * @type {!shakaExtern.TextParser}\n   * @private\n   */\n  this.parser_ = new shaka.media.TtmlTextParser();\n};\n\n\n/** @override **/\nshaka.media.Mp4TtmlParser.prototype.parseInit = function(data) {\n  var Mp4Parser = shaka.util.Mp4Parser;\n\n  var sawSTPP = false;\n\n  new Mp4Parser()\n      .box('moov', Mp4Parser.children)\n      .box('trak', Mp4Parser.children)\n      .box('mdia', Mp4Parser.children)\n      .box('minf', Mp4Parser.children)\n      .box('stbl', Mp4Parser.children)\n      .fullBox('stsd', Mp4Parser.sampleDescription)\n      .box('stpp', function(box) {\n        sawSTPP = true;\n      }).parse(data);\n\n  if (!sawSTPP) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.INVALID_MP4_TTML);\n  }\n};\n\n\n/** @override **/\nshaka.media.Mp4TtmlParser.prototype.parseMedia = function(data, time) {\n  var Mp4Parser = shaka.util.Mp4Parser;\n\n  var sawMDAT = false;\n  var payload = [];\n\n  new Mp4Parser()\n      .box('mdat', Mp4Parser.allData(function(data) {\n        sawMDAT = true;\n        payload = this.parser_.parseMedia(data.buffer, time);\n      }.bind(this))).parse(data);\n\n  if (!sawMDAT) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.INVALID_MP4_TTML);\n  }\n\n  return payload;\n};\n\n\nshaka.media.TextEngine.registerParser(\n    'application/mp4; codecs=\"stpp\"',\n    shaka.media.Mp4TtmlParser);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/mp4_ttml_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.VttTextParser');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.TextEngine');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.StringUtils');\ngoog.require('shaka.util.TextParser');\n\n\n\n/**\n * @constructor\n * @implements {shakaExtern.TextParser}\n */\nshaka.media.VttTextParser = function() { };\n\n\n/** @override */\nshaka.media.VttTextParser.prototype.parseInit = function(data) {\n  goog.asserts.assert(false, 'VTT does not have init segments');\n};\n\n\n/**\n * @override\n * @throws {shaka.util.Error}\n */\nshaka.media.VttTextParser.prototype.parseMedia = function(data, time) {\n  var VttTextParser = shaka.media.VttTextParser;\n  // Get the input as a string.  Normalize newlines to \\n.\n  var str = shaka.util.StringUtils.fromUTF8(data);\n  str = str.replace(/\\r\\n|\\r(?=[^\\n]|$)/gm, '\\n');\n  var blocks = str.split(/\\n{2,}/m);\n\n  if (!/^WEBVTT($|[ \\t\\n])/m.test(blocks[0])) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.INVALID_TEXT_HEADER);\n  }\n\n  var offset = time.segmentStart;\n  // Parse X-TIMESTAMP-MAP metadata header if it's present to get\n  // time offset information.\n  // https://tools.ietf.org/html/draft-pantos-http-live-streaming-20#section-3.5\n  if (blocks[0].indexOf('X-TIMESTAMP-MAP') >= 0) {\n    // 'X-TIMESTAMP-MAP' header is used in HLS to align text with\n    // the rest of the media.\n    // The header format is 'X-TIMESTAMP-MAP=MPEGTS:n,LOCAL:m'\n    // (the attributes can go in any order)\n    // where n is MPEG-2 time and m is cue time it maps to.\n    // For example 'X-TIMESTAMP-MAP=LOCAL:00:00:00.000,MPEGTS:900000'\n    // means an offset of 10 seconds\n    // 900000/MPEG_TIMESCALE - cue time.\n    var cueTimeMatch =\n        blocks[0].match(/LOCAL:((?:(\\d{1,}):)?(\\d{2}):(\\d{2})\\.(\\d{3}))/m);\n\n    var mpegTimeMatch = blocks[0].match(/MPEGTS:(\\d+)/m);\n    if (cueTimeMatch && mpegTimeMatch) {\n      var parser = new shaka.util.TextParser(cueTimeMatch[1]);\n      var cueTime = shaka.media.VttTextParser.parseTime_(parser);\n      var mpegTime = Number(mpegTimeMatch[1]);\n      var mpegTimescale = shaka.media.VttTextParser.MPEG_TIMESCALE_;\n      // Apple-encoded HLS content uses absolute timestamps, so assume\n      // the presence of the map tag means the content uses absolute\n      // timestamps.\n      offset = time.periodStart + (mpegTime / mpegTimescale - cueTime);\n    }\n  }\n\n  var ret = [];\n  for (var i = 1; i < blocks.length; i++) {\n    var lines = blocks[i].split('\\n');\n    var cue = VttTextParser.parseCue_(lines, offset);\n    if (cue)\n      ret.push(cue);\n  }\n\n  return ret;\n};\n\n\n/**\n * Parses a text block into a Cue object.\n *\n * @param {!Array.<string>} text\n * @param {number} timeOffset\n * @return {?TextTrackCue}\n * @private\n */\nshaka.media.VttTextParser.parseCue_ = function(text, timeOffset) {\n  // Skip empty blocks.\n  if (text.length == 1 && !text[0])\n    return null;\n\n  // Skip comment blocks.\n  if (/^NOTE($|[ \\t])/.test(text[0]))\n    return null;\n\n  var id = null;\n  var index = text[0].indexOf('-->');\n  if (index < 0) {\n    id = text[0];\n    text.splice(0, 1);\n  }\n\n  // Parse the times.\n  var parser = new shaka.util.TextParser(text[0]);\n  var start = shaka.media.VttTextParser.parseTime_(parser);\n  var expect = parser.readRegex(/[ \\t]+-->[ \\t]+/g);\n  var end = shaka.media.VttTextParser.parseTime_(parser);\n\n  if (start == null || expect == null || end == null) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.INVALID_TEXT_CUE);\n  }\n\n  start += timeOffset;\n  end += timeOffset;\n\n  // Get the payload.\n  var payload = text.slice(1).join('\\n').trim();\n\n  var cue = shaka.media.TextEngine.makeCue(start, end, payload);\n  if (!cue)\n    return null;\n\n  // Parse optional settings.\n  parser.skipWhitespace();\n  var word = parser.readWord();\n  while (word) {\n    if (!shaka.media.VttTextParser.parseSetting(cue, word)) {\n      shaka.log.warning('VTT parser encountered an invalid VTT setting: ',\n                        word,\n                        ' The setting will be ignored.');\n    }\n    parser.skipWhitespace();\n    word = parser.readWord();\n  }\n\n  if (id != null)\n    cue.id = id;\n  return cue;\n};\n\n\n/**\n * Parses a WebVTT setting from the given word.\n *\n * @param {!TextTrackCue} cue\n * @param {string} word\n * @return {boolean} True on success.\n */\nshaka.media.VttTextParser.parseSetting = function(cue, word) {\n  // NOTE: positionAlign and lineAlign settings are not supported by Chrome\n  // at the moment, so setting them will have no effect.\n  // The bug on chromium to implement them:\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=633690\n\n  var results = null;\n  if ((results = /^align:(start|middle|center|end|left|right)$/.exec(word))) {\n    cue.align = results[1];\n    if (results[1] == 'center' && cue.align != 'center') {\n      // Workaround for a Chrome bug http://crbug.com/663797\n      // Chrome does not support align = 'center'\n      cue.position = 'auto';\n      cue.align = 'middle';\n    }\n  } else if ((results = /^vertical:(lr|rl)$/.exec(word))) {\n    cue.vertical = results[1];\n  } else if ((results = /^size:(\\d{1,2}|100)%$/.exec(word))) {\n    cue.size = Number(results[1]);\n  }\n  // There was a disagreement between a working draft and an editor draft of\n  // the WebVTT spec. According to the former, optional position alignment\n  // options are 'start', 'end' and 'center'. According to the latter -\n  // 'line-left', 'center' and 'line-right'.\n  // We are going to support both options for now.\n  else if ((results =\n      /^position:(\\d{1,2}|100)%(?:,(line-left|line-right|center|start|end))?$/\n      .exec(word))) {\n    cue.position = Number(results[1]);\n    if (results[2])\n      cue.positionAlign = results[2];\n  } else if ((results =\n      /^line:(\\d{1,2}|100)%(?:,(start|end|center))?$/.exec(word))) {\n    cue.snapToLines = false;\n    cue.line = Number(results[1]);\n    if (results[2])\n      cue.lineAlign = results[2];\n  } else if ((results = /^line:(-?\\d+)(?:,(start|end|center))?$/.exec(word))) {\n    cue.snapToLines = true;\n    cue.line = Number(results[1]);\n    if (results[2])\n      cue.lineAlign = results[2];\n  } else {\n    return false;\n  }\n\n  return true;\n};\n\n\n/**\n * Parses a WebVTT time from the given parser.\n *\n * @param {!shaka.util.TextParser} parser\n * @return {?number}\n * @private\n */\nshaka.media.VttTextParser.parseTime_ = function(parser) {\n  // 00:00.000 or 00:00:00.000 or 0:00:00.000\n  var results = parser.readRegex(/(?:(\\d{1,}):)?(\\d{2}):(\\d{2})\\.(\\d{3})/g);\n  if (results == null)\n    return null;\n  // This capture is optional, but will still be in the array as undefined,\n  // default to 0.\n  var hours = Number(results[1]) || 0;\n  var minutes = Number(results[2]);\n  var seconds = Number(results[3]);\n  var miliseconds = Number(results[4]);\n  if (minutes > 59 || seconds > 59)\n    return null;\n\n  return (miliseconds / 1000) + seconds + (minutes * 60) + (hours * 3600);\n};\n\n\n/**\n * @const {number}\n * @private\n */\nshaka.media.VttTextParser.MPEG_TIMESCALE_ = 90000;\n\nshaka.media.TextEngine.registerParser(\n    'text/vtt',\n    shaka.media.VttTextParser);\n\nshaka.media.TextEngine.registerParser(\n    'text/vtt; codecs=\"vtt\"',\n    shaka.media.VttTextParser);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/vtt_text_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.Mp4VttParser');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.TextEngine');\ngoog.require('shaka.media.VttTextParser');\ngoog.require('shaka.util.DataViewReader');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Mp4Parser');\ngoog.require('shaka.util.StringUtils');\ngoog.require('shaka.util.TextParser');\n\n\n\n/**\n * @struct\n * @constructor\n * @implements {shakaExtern.TextParser}\n */\nshaka.media.Mp4VttParser = function() {\n  /**\n   * The current time scale used by the VTT parser.\n   *\n   * @type {?number}\n   * @private\n   */\n  this.timescale_ = null;\n};\n\n\n/** @override */\nshaka.media.Mp4VttParser.prototype.parseInit = function(data) {\n  var Mp4Parser = shaka.util.Mp4Parser;\n\n  var sawWVTT = false;\n\n  new Mp4Parser()\n      .box('moov', Mp4Parser.children)\n      .box('trak', Mp4Parser.children)\n      .box('mdia', Mp4Parser.children)\n      .fullBox('mdhd', function(box) {\n        goog.asserts.assert(\n            box.version == 0 || box.version == 1,\n            'MDHD version can only be 0 or 1');\n        if (box.version == 0) {\n          box.reader.skip(4); // skip \"creation_time\"\n          box.reader.skip(4); // skip \"modification_time\"\n          this.timescale_ = box.reader.readUint32();\n          box.reader.skip(4); // skip \"duration\"\n        } else {\n          box.reader.skip(8); // skip \"creation_time\"\n          box.reader.skip(8); // skip \"modification_time\"\n          this.timescale_ = box.reader.readUint32();\n          box.reader.skip(8); // skip \"duration\"\n        }\n        box.reader.skip(4); // skip \"pad\", \"language\", and \"pre-defined\"\n      }.bind(this))\n      .box('minf', Mp4Parser.children)\n      .box('stbl', Mp4Parser.children)\n      .fullBox('stsd', Mp4Parser.sampleDescription)\n      .box('wvtt', function(box) {\n        // A valid vtt init segment, no actual subtitles yet\n        sawWVTT = true;\n      }).parse(data);\n\n  if (!this.timescale_) {\n    // Missing timescale for VTT content. Should be located in the MDHD\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.INVALID_MP4_VTT);\n  }\n\n  if (!sawWVTT) {\n    // A WVTT box should have been seen (a valid vtt init segment with no\n    // actual subtitles).\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.INVALID_MP4_VTT);\n  }\n};\n\n\n/** @override */\nshaka.media.Mp4VttParser.prototype.parseMedia = function(data, time) {\n  var Mp4VttParser = shaka.media.Mp4VttParser;\n  var Mp4Parser = shaka.util.Mp4Parser;\n\n  var baseTime = 0;\n  var presentations = [];\n  var payloads = [];\n  var cues = [];\n\n  var sawTFDT = false;\n  var sawTRUN = false;\n  var sawMDAT = false;\n\n  new Mp4Parser()\n      .box('moof', Mp4Parser.children)\n      .box('traf', Mp4Parser.children)\n      .fullBox('tfdt', function(box) {\n        sawTFDT = true;\n        goog.asserts.assert(\n            box.version == 0 || box.version == 1,\n            'TFDT version can only be 0 or 1');\n        baseTime = (box.version == 0) ?\n            box.reader.readUint32() :\n            box.reader.readUint64();\n      })\n      .fullBox('trun', function(box) {\n        sawTRUN = true;\n        goog.asserts.assert(\n            box.version != null,\n            'A TRUN box should have a valid version value');\n        goog.asserts.assert(\n            box.flags != null,\n            'A TRUN box should have a valid flags value');\n        presentations = Mp4VttParser.parseTRUN_(\n            box.version, box.flags, box.reader);\n      })\n      .box('vtte', function(box) {\n        // VTTE are empty cues, so there is no need to do any more than insert\n        // a place-holder. We must add something or else the ordering between\n        // the payloads and presentation times would fall out of order.\n        payloads.push(null);\n      })\n      .box('vttc', Mp4Parser.allData(function(data) {\n        payloads.push(data.buffer);\n      }))\n      .box('mdat', function(box) {\n        sawMDAT = true;\n        Mp4Parser.children(box);\n      }).parse(data);\n\n  if (!sawMDAT && !sawTFDT && !sawTRUN) {\n    // A required box is missing\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.TEXT,\n        shaka.util.Error.Code.INVALID_MP4_VTT);\n  }\n\n  goog.asserts.assert(\n      presentations.length == payloads.length,\n      'The number of presentations should equal the number of payloads');\n\n  var currentTime = baseTime;\n\n  for (var i = 0; i < presentations.length; i++) {\n    var presentation = presentations[i];\n    var payload = payloads[i];\n\n    if (presentation.duration) {\n      var startTime = presentation.timeOffset ?\n                      baseTime + presentation.timeOffset :\n                      currentTime;\n\n      currentTime = startTime + presentation.duration;\n\n      // The payload can be null as that would mean that it was a VTTE and\n      // was only inserted to keep the presentation times in sync with the\n      // payloads.\n      if (payload) {\n        cues.push(shaka.media.Mp4VttParser.parseVTTC_(\n            payload,\n            time.periodStart + startTime / this.timescale_,\n            time.periodStart + currentTime / this.timescale_));\n      }\n    }\n  }\n\n  return cues;\n};\n\n\n/**\n * @typedef {{\n *    duration: ?number,\n *    timeOffset: ?number\n *  }}\n *\n * @property {?number} duration\n *    The length of the segment in timescale units.\n * @property {?number} timeOffset\n *    The time since the start of the segment in timescale units. Time\n *    offset is based of the start of the segment. If this value is\n *    missing, the accumated durations preceeding this time segment will\n *    be used to create the start time.\n */\nshaka.media.Mp4VttParser.TimeSegment;\n\n\n/**\n * @param {number} version\n * @param {number} flags\n * @param {!shaka.util.DataViewReader} reader\n * @return {!Array.<shaka.media.Mp4VttParser.TimeSegment>}\n * @private\n */\nshaka.media.Mp4VttParser.parseTRUN_ = function(version, flags, reader) {\n  var sampleCount = reader.readUint32();\n\n  // skip \"data_offset\" if present\n  if (flags & 0x000001) { reader.skip(4); }\n\n  // skip \"first_sample_flags\" if present\n  if (flags & 0x000004) { reader.skip(4); }\n\n  var samples = [];\n\n  for (var sampleIndex = 0; sampleIndex < sampleCount; sampleIndex++) {\n\n    /** @type {shaka.media.Mp4VttParser.TimeSegment} */\n    var sample = {\n      duration: null,\n      timeOffset: null\n    };\n\n    // read \"sample duration\" if present\n    if (flags & 0x000100) { sample.duration = reader.readUint32(); }\n\n    // skip \"sample_size\" if present\n    if (flags & 0x000200) { reader.skip(4); }\n\n    // skip \"sample_flags\" if present\n    if (flags & 0x000400) {reader.skip(4); }\n\n    // read \"sample_time_offset\" if present\n    if (flags & 0x000800) {\n      sample.timeOffset = version == 0 ?\n          reader.readUint32() :\n          reader.readInt32();\n    }\n\n    samples.push(sample);\n  }\n\n  return samples;\n};\n\n\n/**\n * Parses a vttc box into a cue.\n *\n * @param {!ArrayBuffer} data\n * @param {number} startTime\n * @param {number} endTime\n * @return {TextTrackCue}\n * @private\n */\nshaka.media.Mp4VttParser.parseVTTC_ = function(data, startTime, endTime) {\n  var payload;\n  var id;\n  var settings;\n\n  new shaka.util.Mp4Parser()\n      .box('payl', shaka.util.Mp4Parser.allData(function(data) {\n        payload = shaka.util.StringUtils.fromUTF8(data);\n      }))\n      .box('iden', shaka.util.Mp4Parser.allData(function(data) {\n        id = shaka.util.StringUtils.fromUTF8(data);\n      }))\n      .box('sttg', shaka.util.Mp4Parser.allData(function(data) {\n        settings = shaka.util.StringUtils.fromUTF8(data);\n      }))\n      .parse(data);\n\n  if (payload) {\n    return shaka.media.Mp4VttParser.assembleCue_(payload,\n                                                 id,\n                                                 settings,\n                                                 startTime,\n                                                 endTime);\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * Take the individual components that make a cue and create a vttc cue.\n *\n * @param {string} payload\n * @param {?string} id\n * @param {?string} settings\n * @param {number} startTime\n * @param {number} endTime\n * @return {TextTrackCue}\n * @private\n */\nshaka.media.Mp4VttParser.assembleCue_ = function(payload,\n                                                 id,\n                                                 settings,\n                                                 startTime,\n                                                 endTime) {\n  var cue = shaka.media.TextEngine.makeCue(\n      startTime,\n      endTime,\n      payload);\n\n  if (cue && id) {\n    cue.id = id;\n  }\n\n  if (cue && settings) {\n    var parser = new shaka.util.TextParser(settings);\n\n    var word = parser.readWord();\n\n    while (word) {\n\n      if (!shaka.media.VttTextParser.parseSetting(cue, word)) {\n        shaka.log.warning('VTT parser encountered an invalid VTT setting: ',\n                          word,\n                          ' The setting will be ignored.');\n      }\n\n      parser.skipWhitespace();\n      word = parser.readWord();\n    }\n  }\n\n  return cue;\n};\n\n\nshaka.media.TextEngine.registerParser(\n    'application/mp4; codecs=\"wvtt\"',\n    shaka.media.Mp4VttParser);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/mp4_vtt_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.Playhead');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.TimeRangesUtils');\ngoog.require('shaka.util.EventManager');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.StreamUtils');\n\n\n\n/**\n * Creates a Playhead, which manages the video's current time.\n *\n * The Playhead provides mechanisms for setting the presentation's start time,\n * restricting seeking to valid time ranges, and stopping playback for startup\n * and re- buffering.\n *\n * @param {HTMLMediaElement} video\n * @param {shakaExtern.Manifest} manifest\n * @param {shakaExtern.StreamingConfiguration} config\n * @param {?number} startTime The playhead's initial position in seconds. If\n *   null, defaults to the start of the presentation for VOD and the live-edge\n *   for live.\n * @param {function()} onSeek Called when the user agent seeks to a time within\n *   the presentation timeline.\n * @param {function(!Event)} onEvent Called when an event is raised to be sent\n *   to the application.\n *\n * @constructor\n * @struct\n * @implements {shaka.util.IDestroyable}\n */\nshaka.media.Playhead = function(\n    video, manifest, config, startTime, onSeek, onEvent) {\n  /** @private {HTMLMediaElement} */\n  this.video_ = video;\n\n  /** @private {?shakaExtern.Manifest} */\n  this.manifest_ = manifest;\n\n  /** @private {?shakaExtern.StreamingConfiguration} */\n  this.config_ = config;\n\n  /**\n   * The playhead's initial position in seconds, or null if it should\n   * automatically be calculated later.\n   * @private {?number}\n   */\n  this.startTime_ = startTime;\n\n  /** @private {?function()} */\n  this.onSeek_ = onSeek;\n\n  /** @private {?function(!Event)} */\n  this.onEvent_ = onEvent;\n\n  /** @private {shaka.util.EventManager} */\n  this.eventManager_ = new shaka.util.EventManager();\n\n  /** @private {boolean} */\n  this.buffering_ = false;\n\n  /** @private {number} */\n  this.playbackRate_ = 1;\n\n  /** @private {?number} */\n  this.trickPlayIntervalId_ = null;\n\n  /** @private {?number} */\n  this.gapJumpIntervalId_ = null;\n\n  /** @private {number} */\n  this.prevReadyState_ = video.readyState;\n\n  /** @private {boolean} */\n  this.didFireLargeGap_ = false;\n\n  /**\n   * The wall-clock time (in milliseconds) that the stall occurred.  This is\n   * used to ensure we don't flush the pipeline too often.\n   * @private {number}\n   */\n  this.stallWallTime_ = -1;\n\n  /**\n   * The playhead time where we think a stall occurred.  When the ready state\n   * says we don't have enough data and the playhead stops too long, we assume\n   * we have stalled.\n   * @private {number}\n   */\n  this.stallPlayheadTime_ = -1;\n\n  /** @private {boolean} */\n  this.hadSegmentAppended_ = false;\n\n\n  // Check if the video has already loaded some metadata.\n  if (video.readyState > 0) {\n    this.onLoadedMetadata_();\n  } else {\n    this.eventManager_.listenOnce(\n        video, 'loadedmetadata', this.onLoadedMetadata_.bind(this));\n  }\n\n  var pollGap = this.onPollGapJump_.bind(this);\n  this.eventManager_.listen(video, 'ratechange', this.onRateChange_.bind(this));\n  this.eventManager_.listen(video, 'waiting', pollGap);\n\n  // We can't trust readyState or 'waiting' events on all platforms.  So poll\n  // the current time and if we are in a gap, jump it.\n  // See: https://goo.gl/sbSHp9 and https://goo.gl/cuAcYd\n  this.gapJumpIntervalId_ = setInterval(pollGap, 250);\n};\n\n\n/** @override */\nshaka.media.Playhead.prototype.destroy = function() {\n  var p = this.eventManager_.destroy();\n  this.eventManager_ = null;\n\n  if (this.trickPlayIntervalId_ != null) {\n    window.clearInterval(this.trickPlayIntervalId_);\n    this.trickPlayIntervalId_ = null;\n  }\n\n  if (this.gapJumpIntervalId_ != null) {\n    window.clearInterval(this.gapJumpIntervalId_);\n    this.gapJumpIntervalId_ = null;\n  }\n\n  this.video_ = null;\n  this.manifest_ = null;\n  this.config_ = null;\n  this.onSeek_ = null;\n  this.onEvent_ = null;\n\n  return p;\n};\n\n\n/** @param {number} startTime */\nshaka.media.Playhead.prototype.setStartTime = function(startTime) {\n  if (this.video_.readyState > 0)\n    this.video_.currentTime = this.clampTime_(startTime);\n  else\n    this.startTime_ = startTime;\n};\n\n\n/**\n * Gets the playhead's current (logical) position.\n *\n * @return {number}\n */\nshaka.media.Playhead.prototype.getTime = function() {\n  if (this.video_.readyState > 0) {\n    // Although we restrict the video's currentTime elsewhere, clamp it here to\n    // ensure any timing issues (e.g., the user agent seeks and calls this\n    // function before we receive the 'seeking' event) don't cause us to return\n    // a time outside the segment availability window.\n    return this.clampTime_(this.video_.currentTime);\n  }\n\n  return this.getStartTime_();\n};\n\n\n/**\n * Gets the playhead's initial position in seconds.\n *\n * @return {number}\n * @private\n */\nshaka.media.Playhead.prototype.getStartTime_ = function() {\n  if (this.startTime_) {\n    return this.clampTime_(this.startTime_);\n  }\n\n  var startTime;\n  var timeline = this.manifest_.presentationTimeline;\n  if (timeline.getDuration() < Infinity) {\n    // If the presentation is VOD, or if the presentation is live but has\n    // finished broadcasting, then start from the beginning.\n    startTime = timeline.getSegmentAvailabilityStart();\n  } else {\n    // Otherwise, start near the live-edge.\n    startTime = timeline.getSeekRangeEnd();\n  }\n  return startTime;\n};\n\n\n/**\n * Stops the playhead for buffering, or resumes the playhead after buffering.\n *\n * @param {boolean} buffering True to stop the playhead; false to allow it to\n *   continue.\n */\nshaka.media.Playhead.prototype.setBuffering = function(buffering) {\n  if (buffering != this.buffering_) {\n    this.buffering_ = buffering;\n    this.setPlaybackRate(this.playbackRate_);\n  }\n};\n\n\n/**\n * Gets the current effective playback rate.  This may be negative even if the\n * browser does not directly support rewinding.\n * @return {number}\n */\nshaka.media.Playhead.prototype.getPlaybackRate = function() {\n  return this.playbackRate_;\n};\n\n\n/**\n * Sets the playback rate.\n * @param {number} rate\n */\nshaka.media.Playhead.prototype.setPlaybackRate = function(rate) {\n  if (this.trickPlayIntervalId_ != null) {\n    window.clearInterval(this.trickPlayIntervalId_);\n    this.trickPlayIntervalId_ = null;\n  }\n\n  this.playbackRate_ = rate;\n  // All major browsers support playback rates above zero.  Only need fake\n  // trick play for negative rates.\n  this.video_.playbackRate = (this.buffering_ || rate < 0) ? 0 : rate;\n\n  if (!this.buffering_ && rate < 0) {\n    // Defer creating the timer until we stop buffering.  This function will be\n    // called again from setBuffering().\n    this.trickPlayIntervalId_ = window.setInterval(function() {\n      this.video_.currentTime += rate / 4;\n    }.bind(this), 250);\n  }\n};\n\n\n/**\n * Called when a segment is appended by StreamingEngine, but not when a clear is\n * pending.  This means StreamingEngine will continue buffering forward from\n * what is buffered. So we know about any gaps before the start.\n */\nshaka.media.Playhead.prototype.onSegmentAppended = function() {\n  this.hadSegmentAppended_ = true;\n  this.onPollGapJump_();\n};\n\n\n/**\n * Handles a 'ratechange' event.\n *\n * @private\n */\nshaka.media.Playhead.prototype.onRateChange_ = function() {\n  // NOTE: This will not allow explicitly setting the playback rate to 0 while\n  // the playback rate is negative.  Pause will still work.\n  var expectedRate =\n      this.buffering_ || this.playbackRate_ < 0 ? 0 : this.playbackRate_;\n  if (this.video_.playbackRate != expectedRate) {\n    shaka.log.debug('Video playback rate changed to', this.video_.playbackRate);\n    this.setPlaybackRate(this.video_.playbackRate);\n  }\n};\n\n\n/**\n * Handles a 'loadedmetadata' event.\n *\n * @private\n */\nshaka.media.Playhead.prototype.onLoadedMetadata_ = function() {\n  // Move the real playhead to the start time.\n  var targetTime = this.getStartTime_();\n  if (Math.abs(this.video_.currentTime - targetTime) < 0.001) {\n    this.eventManager_.listen(\n        this.video_, 'seeking', this.onSeeking_.bind(this));\n    this.eventManager_.listen(\n        this.video_, 'playing', this.onPlaying_.bind(this));\n  } else {\n    this.eventManager_.listenOnce(\n        this.video_, 'seeking', this.onSeekingToStartTime_.bind(this));\n    this.video_.currentTime = targetTime;\n  }\n};\n\n\n/**\n * Handles the 'seeking' event from the initial jump to the start time (if\n * there is one).\n *\n * @private\n */\nshaka.media.Playhead.prototype.onSeekingToStartTime_ = function() {\n  goog.asserts.assert(this.video_.readyState > 0,\n                      'readyState should be greater than 0');\n  this.eventManager_.listen(this.video_, 'seeking', this.onSeeking_.bind(this));\n  this.eventManager_.listen(this.video_, 'playing', this.onPlaying_.bind(this));\n};\n\n\n/**\n * Called on a recurring timer to check for gaps in the media.  This is also\n * called in a 'waiting' event.\n *\n * @private\n */\nshaka.media.Playhead.prototype.onPollGapJump_ = function() {\n  if (this.video_.readyState == 0)\n    return;\n\n  // When the ready state changes, we have moved on, so we should fire the large\n  // gap event if we see one.\n  if (this.video_.readyState != this.prevReadyState_) {\n    this.didFireLargeGap_ = false;\n    this.prevReadyState_ = this.video_.readyState;\n  }\n\n  var smallGapLimit = this.config_.smallGapLimit;\n  var currentTime = this.video_.currentTime;\n  var buffered = this.video_.buffered;\n\n  var gapIndex = shaka.media.TimeRangesUtils.getGapIndex(buffered, currentTime);\n\n  // The current time is unbuffered or is too far from a gap.\n  if (gapIndex == null) {\n    if (this.video_.readyState < 3 && this.video_.playbackRate > 0) {\n      // Some platforms/browsers can get stuck in the middle of a buffered range\n      // (e.g. when seeking in a background tab).  Flush the media pipeline to\n      // help.\n      //\n      // Flush once we have stopped for more than 1 second inside a buffered\n      // range.  Note that Chromecast takes a few seconds to start playing\n      // after any kind of seek, so wait 5 seconds between repeated flushes.\n      if (this.stallPlayheadTime_ != currentTime) {\n        this.stallPlayheadTime_ = currentTime;\n        this.stallWallTime_ = Date.now();\n      } else if (this.stallWallTime_ < Date.now() - 1000) {\n        // Make the stall appear in the future so we don't flush for 5 seconds.\n        this.stallWallTime_ = Date.now() + 5000;\n\n        for (var i = 0; i < buffered.length; i++) {\n          // Ignore the end of the buffered range since it may not play anymore\n          // on all platforms.\n          if (currentTime >= buffered.start(i) &&\n              currentTime < buffered.end(i) - 0.5) {\n            shaka.log.debug(\n                'Flushing media pipeline due to stall inside buffered range');\n            this.video_.currentTime = this.video_.currentTime;\n            break;\n          }\n        }\n      }\n    }\n    return;\n  }\n  // If we are before the first buffered range, this could be an unbuffered\n  // seek.  So wait until a segment is appended so we are sure it is a gap.\n  if (gapIndex == 0 && !this.hadSegmentAppended_)\n    return;\n\n  // StreamingEngine can buffer past the seek end, but still don't allow seeking\n  // past it.\n  var jumpTo = buffered.start(gapIndex);\n  var seekEnd = this.manifest_.presentationTimeline.getSeekRangeEnd();\n  if (jumpTo >= seekEnd)\n    return;\n\n  var jumpSize = jumpTo - currentTime;\n  var isGapSmall = jumpSize <= smallGapLimit;\n  var jumpLargeGap = false;\n\n  if (!isGapSmall && !this.didFireLargeGap_) {\n    this.didFireLargeGap_ = true;\n\n    // Event firing is synchronous.\n    var event = new shaka.util.FakeEvent(\n        'largegap', {'currentTime': currentTime, 'gapSize': jumpSize});\n    event.cancelable = true;\n    this.onEvent_(event);\n\n    if (this.config_.jumpLargeGaps && !event.defaultPrevented)\n      jumpLargeGap = true;\n    else\n      shaka.log.info('Ignoring large gap at', currentTime);\n  }\n\n  if (isGapSmall || jumpLargeGap) {\n    if (gapIndex == 0) {\n      shaka.log.info(\n          'Jumping forward', jumpSize,\n          'seconds because of gap before start time of', jumpTo);\n    } else {\n      shaka.log.info(\n          'Jumping forward', jumpSize, 'seconds because of gap starting at',\n          buffered.end(gapIndex - 1), 'and ending at', jumpTo);\n    }\n\n    this.movePlayhead_(currentTime, jumpTo);\n  }\n};\n\n\n/**\n * Handles a 'seeking' event.\n *\n * @private\n */\nshaka.media.Playhead.prototype.onSeeking_ = function() {\n  goog.asserts.assert(this.video_.readyState > 0,\n                      'readyState should be greater than 0');\n\n  this.hadSegmentAppended_ = false;\n  var currentTime = this.video_.currentTime;\n  var targetTime = this.reposition_(currentTime);\n\n  if (Math.abs(targetTime - currentTime) > 0.001) {\n    this.movePlayhead_(currentTime, targetTime);\n    return;\n  }\n\n  shaka.log.v1('Seek to ' + currentTime);\n  this.didFireLargeGap_ = false;\n  this.onSeek_();\n};\n\n\n/**\n * Handles a 'playing' event.\n *\n * @private\n */\nshaka.media.Playhead.prototype.onPlaying_ = function() {\n  goog.asserts.assert(this.video_.readyState > 0,\n                      'readyState should be greater than 0');\n\n  var currentTime = this.video_.currentTime;\n  var targetTime = this.reposition_(currentTime);\n\n  if (Math.abs(targetTime - currentTime) > 0.001)\n    this.movePlayhead_(currentTime, targetTime);\n};\n\n\n/**\n * Computes a new playhead position that's within the presentation timeline.\n *\n * @param {number} currentTime\n * @return {number} The time to reposition the playhead to.\n * @private\n */\nshaka.media.Playhead.prototype.reposition_ = function(currentTime) {\n  goog.asserts.assert(this.manifest_ && this.config_, 'Must not be destroyed');\n\n  /** @type {function(number)} */\n  var isBuffered =\n      shaka.media.TimeRangesUtils.isBuffered.bind(null, this.video_.buffered);\n\n  var rebufferingGoal = shaka.util.StreamUtils.getRebufferingGoal(\n      this.manifest_, this.config_, 1 /* scaleFactor */);\n\n  var timeline = this.manifest_.presentationTimeline;\n  var start = timeline.getSafeAvailabilityStart(0);\n  var end = timeline.getSegmentAvailabilityEnd();\n\n  // With live content, the beginning of the availability window is moving\n  // forward.  This means we cannot seek to it since we will \"fall\" outside the\n  // window while we buffer.  So we define a \"safe\" region that is far enough\n  // away.  For VOD, |safe == start|.\n  var safe = timeline.getSafeAvailabilityStart(rebufferingGoal);\n\n  // These are the times to seek to rather than the exact destinations.  When\n  // we seek, we will get another event (after a slight delay) and these steps\n  // will run again.  So if we seeked directly to |start|, |start| would move\n  // on the next call and we would loop forever.\n  //\n  // Offset by 5 seconds since Chromecast takes a few seconds to start playing\n  // after a seek, even when buffered.\n  var seekStart = timeline.getSafeAvailabilityStart(5);\n  var seekSafe = timeline.getSafeAvailabilityStart(rebufferingGoal + 5);\n\n\n  if (currentTime > end) {\n    shaka.log.v1('Playhead past end.');\n    return end;\n  }\n\n  if (currentTime < start) {\n    if (isBuffered(seekStart)) {\n      shaka.log.v1('Playhead before start & start is buffered');\n      return seekStart;\n    } else {\n      shaka.log.v1('Playhead before start & start is unbuffered');\n      return seekSafe;\n    }\n  }\n\n  if (currentTime >= safe || isBuffered(currentTime)) {\n    shaka.log.v1('Playhead in safe region or in buffered region.');\n    return currentTime;\n  } else {\n    shaka.log.v1('Playhead outside safe region & in unbuffered region.');\n    return seekSafe;\n  }\n};\n\n\n/**\n * Moves the playhead to the target time, triggering a call to onSeeking_().\n *\n * @param {number} currentTime\n * @param {number} targetTime\n * @private\n */\nshaka.media.Playhead.prototype.movePlayhead_ = function(\n    currentTime, targetTime) {\n  shaka.log.debug('Moving playhead...',\n                  'currentTime=' + currentTime,\n                  'targetTime=' + targetTime);\n  this.video_.currentTime = targetTime;\n\n  // Sometimes, IE and Edge ignore re-seeks.  Check every 100ms and try\n  // again if need be, up to 10 tries.\n  // Delay stats over 100 runs of a re-seeking integration test:\n  // IE     -   0ms -  47%\n  // IE     - 100ms -  63%\n  // Edge   -   0ms -   2%\n  // Edge   - 100ms -  40%\n  // Edge   - 200ms -  32%\n  // Edge   - 300ms -  24%\n  // Edge   - 400ms -   2%\n  // Chrome -   0ms - 100%\n  // TODO: File a bug on IE/Edge about this.\n  var tries = 0;\n  var recheck = (function() {\n    if (!this.video_) return;\n    if (tries++ >= 10) return;\n\n    if (this.video_.currentTime == currentTime) {\n      // Sigh.  Try again.\n      this.video_.currentTime = targetTime;\n      setTimeout(recheck, 100);\n    }\n  }).bind(this);\n  setTimeout(recheck, 100);\n};\n\n\n/**\n * Clamps the given time to the segment availability window.\n *\n * @param {number} time The time in seconds.\n * @return {number} The clamped time in seconds.\n * @private\n */\nshaka.media.Playhead.prototype.clampTime_ = function(time) {\n  var start = this.manifest_.presentationTimeline.getSegmentAvailabilityStart();\n  if (time < start) return start;\n\n  var end = this.manifest_.presentationTimeline.getSegmentAvailabilityEnd();\n  if (time > end) return end;\n\n  return time;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/playhead.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.PlayheadObserver');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.media.TimeRangesUtils');\ngoog.require('shaka.util.ConfigUtils');\ngoog.require('shaka.util.EventManager');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.StreamUtils');\n\n\n\n/**\n * This observes the current playhead position to raise events.  This will only\n * observe the playhead, {@link shaka.media.Playhead} will modify it. This will:\n * <ul>\n *   <li>Track buffering state and call |onBuffering|.</li>\n *   <li>Track current Period and call |onChangePeriod|.</li>\n *   <li>Track timeline regions and raise respective events.</li>\n * </ul>\n *\n * @param {HTMLMediaElement} video\n * @param {shakaExtern.Manifest} manifest\n * @param {shakaExtern.StreamingConfiguration} config\n * @param {function(boolean)} onBuffering Called and passed true when stopped\n *   for buffering; called and passed false when proceeding after buffering.\n *   If passed true, the callback should not set the video's playback rate.\n * @param {function(!Event)} onEvent Called when an event is raised to be sent\n *   to the application.\n * @param {function()} onChangePeriod Called when the playhead moves to a\n *   different Period.\n *\n * @constructor\n * @struct\n * @implements {shaka.util.IDestroyable}\n */\nshaka.media.PlayheadObserver = function(\n    video, manifest, config, onBuffering, onEvent, onChangePeriod) {\n  /** @private {HTMLMediaElement} */\n  this.video_ = video;\n\n  /** @private {?shakaExtern.Manifest} */\n  this.manifest_ = manifest;\n\n  /** @private {?shakaExtern.StreamingConfiguration} */\n  this.config_ = config;\n\n  /** @private {?function(boolean)} */\n  this.onBuffering_ = onBuffering;\n\n  /** @private {?function(!Event)} */\n  this.onEvent_ = onEvent;\n\n  /** @private {?function()} */\n  this.onChangePeriod_ = onChangePeriod;\n\n  /** @private {!Array.<shaka.media.PlayheadObserver.TimelineRegion>} */\n  this.timelineRegions_ = [];\n\n  /** @private {shaka.util.EventManager} */\n  this.eventManager_ = new shaka.util.EventManager();\n\n  /** @private {boolean} */\n  this.buffering_ = false;\n\n  /** @private {number} */\n  this.curPeriodIndex_ = -1;\n\n  /** @private {?number} */\n  this.watchdogTimer_ = null;\n\n\n  this.startWatchdogTimer_();\n};\n\n\n/**\n * The threshold for underflow, in seconds.  If there is less than this amount\n * of data buffered, we will consider the player to be out of data.\n *\n * @private {number}\n * @const\n */\nshaka.media.PlayheadObserver.UNDERFLOW_THRESHOLD_ = 0.5;\n\n\n/**\n * A fudge factor used when comparing buffered ranges to the duration to\n * determine if we have buffered all available content.\n *\n * @private {number}\n * @const\n */\nshaka.media.PlayheadObserver.FUDGE_FACTOR_ = 0.1;\n\n\n/**\n * @enum {number}\n * @private\n */\nshaka.media.PlayheadObserver.RegionLocation_ = {\n  FUTURE_REGION: 1,\n  INSIDE: 2,\n  PAST_REGION: 3\n};\n\n\n/**\n * @typedef {{\n *   info: shakaExtern.TimelineRegionInfo,\n *   status: shaka.media.PlayheadObserver.RegionLocation_\n * }}\n *\n * @property {shakaExtern.TimelineRegionInfo} info\n *   The info for this timeline region.\n * @property {shaka.media.PlayheadObserver.RegionLocation_} status\n *   This tracks where the region is relative to the playhead. This tracks\n *   whether we are before or after the region so we can raise events if we pass\n *   it.\n */\nshaka.media.PlayheadObserver.TimelineRegion;\n\n\n/** @override */\nshaka.media.PlayheadObserver.prototype.destroy = function() {\n  var p = this.eventManager_ ? this.eventManager_.destroy() : Promise.resolve();\n\n  this.eventManager_ = null;\n  this.cancelWatchdogTimer_();\n\n  this.video_ = null;\n  this.manifest_ = null;\n  this.config_ = null;\n  this.onBuffering_ = null;\n  this.onEvent_ = null;\n  this.onChangePeriod_ = null;\n  this.timelineRegions_ = [];\n\n  return p;\n};\n\n\n/** Called when a seek completes. */\nshaka.media.PlayheadObserver.prototype.seeked = function() {\n  this.timelineRegions_.forEach(\n      this.updateTimelineRegion_.bind(this, /* isSeek */ true));\n};\n\n\n/**\n * Adds a new timeline region.  Events will be raised whenever the playhead\n * enters or exits the given region.  This method will raise a\n * 'timelineregionadded' event.\n * @param {shakaExtern.TimelineRegionInfo} regionInfo\n */\nshaka.media.PlayheadObserver.prototype.addTimelineRegion = function(\n    regionInfo) {\n  // Check there isn't an existing event with the same scheme ID and time range.\n  // This ensures that the manifest parser doesn't need to also track which\n  // events have already been added.\n  var hasExistingRegion = this.timelineRegions_.some(function(existing) {\n    return existing.info.schemeIdUri == regionInfo.schemeIdUri &&\n        existing.info.startTime == regionInfo.startTime &&\n        existing.info.endTime == regionInfo.endTime;\n  });\n  if (hasExistingRegion) return;\n\n  var region = {\n    info: regionInfo,\n    status: shaka.media.PlayheadObserver.RegionLocation_.FUTURE_REGION\n  };\n  this.timelineRegions_.push(region);\n\n  var cloneTimelineInfo_ = shaka.media.PlayheadObserver.cloneTimelineInfo_;\n  var event = new shaka.util.FakeEvent(\n      'timelineregionadded', {detail: cloneTimelineInfo_(regionInfo)});\n  this.onEvent_(event);\n\n  // Pretend this is a seek so it will ignore if it should be PAST_REGION but\n  // still fire an event if it should be INSIDE.\n  this.updateTimelineRegion_(/* isSeek */ true, region);\n};\n\n\n/**\n * Clones the given TimelineRegionInfo so the app can modify it without\n * modifying our internal objects.\n * @param {shakaExtern.TimelineRegionInfo} source\n * @return {shakaExtern.TimelineRegionInfo}\n * @private\n */\nshaka.media.PlayheadObserver.cloneTimelineInfo_ = function(source) {\n  var copy = shaka.util.ConfigUtils.cloneObject(source);\n  // cloneObject uses JSON to clone, which won't copy the DOM element.\n  copy.eventElement = source.eventElement;\n  return copy;\n};\n\n\n/**\n * Updates the status of a timeline region and fires any enter/exit events.\n * @param {boolean} isSeek\n * @param {shaka.media.PlayheadObserver.TimelineRegion} region\n * @private\n */\nshaka.media.PlayheadObserver.prototype.updateTimelineRegion_ = function(\n    isSeek, region) {\n  var RegionLocation = shaka.media.PlayheadObserver.RegionLocation_;\n  var cloneTimelineInfo_ = shaka.media.PlayheadObserver.cloneTimelineInfo_;\n\n  // The events are fired when the playhead enters a region.  We fire both\n  // events when passing over a region and not seeking since the playhead was\n  // in the region but left before we saw it.  We don't fire both when seeking\n  // since the playhead was never in the region.\n  //\n  // |--------------------------------------|\n  // | From \\ To |  FUTURE | INSIDE | PAST  |\n  // |   FUTURE  |         |  enter | both* |\n  // |   INSIDE  |   exit  |        | exit  |\n  // |    PAST   |   both* |  enter |       |\n  // |--------------------------------------|\n  // * Only when not seeking.\n  var newStatus = region.info.startTime > this.video_.currentTime ?\n      RegionLocation.FUTURE_REGION :\n      (region.info.endTime < this.video_.currentTime ?\n           RegionLocation.PAST_REGION :\n           RegionLocation.INSIDE);\n  var wasInside = region.status == RegionLocation.INSIDE;\n  var isInside = newStatus == RegionLocation.INSIDE;\n\n  if (newStatus != region.status) {\n    var passedRegion = !wasInside && !isInside;\n    if (!(isSeek && passedRegion)) {\n      if (!wasInside) {\n        this.onEvent_(new shaka.util.FakeEvent(\n            'timelineregionenter',\n            {'detail': cloneTimelineInfo_(region.info)}));\n      }\n      if (!isInside) {\n        this.onEvent_(new shaka.util.FakeEvent(\n            'timelineregionexit', {'detail': cloneTimelineInfo_(region.info)}));\n      }\n    }\n    region.status = newStatus;\n  }\n};\n\n\n/**\n * Starts the watchdog timer.\n * @private\n */\nshaka.media.PlayheadObserver.prototype.startWatchdogTimer_ = function() {\n  this.cancelWatchdogTimer_();\n  this.watchdogTimer_ =\n      window.setTimeout(this.onWatchdogTimer_.bind(this), 250);\n};\n\n\n/**\n * Cancels the watchdog timer, if any.\n * @private\n */\nshaka.media.PlayheadObserver.prototype.cancelWatchdogTimer_ = function() {\n  if (this.watchdogTimer_) {\n    window.clearTimeout(this.watchdogTimer_);\n    this.watchdogTimer_ = null;\n  }\n};\n\n\n/**\n * Called on a recurring timer to detect buffering events and Period changes.\n * @private\n */\nshaka.media.PlayheadObserver.prototype.onWatchdogTimer_ = function() {\n  this.watchdogTimer_ = null;\n  this.startWatchdogTimer_();\n\n  goog.asserts.assert(this.manifest_ && this.config_, 'Must not be destroyed');\n  var newPeriod = shaka.util.StreamUtils.findPeriodContainingTime(\n      this.manifest_, this.video_.currentTime);\n  if (newPeriod != this.curPeriodIndex_) {\n    // Ignore seek to start time, the first 'trackschanged' event is handled\n    // during player.load().\n    if (this.curPeriodIndex_ != -1)\n      this.onChangePeriod_();\n    this.curPeriodIndex_ = newPeriod;\n  }\n\n  // This uses an intersection of buffered ranges for both audio and video, so\n  // it's an accurate way to determine if we are buffering or not.\n  var bufferedAhead = shaka.media.TimeRangesUtils.bufferedAheadOf(\n      this.video_.buffered, this.video_.currentTime);\n  var bufferEnd = shaka.media.TimeRangesUtils.bufferEnd(this.video_.buffered);\n\n  var fudgeFactor = shaka.media.PlayheadObserver.FUDGE_FACTOR_;\n  var threshold = shaka.media.PlayheadObserver.UNDERFLOW_THRESHOLD_;\n\n  var timeline = this.manifest_.presentationTimeline;\n  var duration = timeline.getSegmentAvailabilityEnd() - fudgeFactor;\n\n  var atEnd = (bufferEnd >= duration) || (this.video_.ended);\n  if (!this.buffering_) {\n    // If there are no buffered ranges but the playhead is at the end of\n    // the video then we shouldn't enter a buffering state.\n    if (!atEnd && bufferedAhead < threshold) {\n      this.setBuffering_(true);\n    }\n  } else {\n    var rebufferingGoal = shaka.util.StreamUtils.getRebufferingGoal(\n        this.manifest_, this.config_, 1 /* scaleFactor */);\n    if (atEnd || bufferedAhead >= rebufferingGoal) {\n      this.setBuffering_(false);\n    }\n  }\n\n  this.timelineRegions_.forEach(\n      this.updateTimelineRegion_.bind(this, /* isSeek */ false));\n};\n\n\n/**\n * Stops the playhead for buffering, or resumes the playhead after buffering.\n *\n * @param {boolean} buffering True to stop the playhead; false to allow it to\n *   continue.\n * @private\n */\nshaka.media.PlayheadObserver.prototype.setBuffering_ = function(buffering) {\n  if (buffering != this.buffering_) {\n    this.buffering_ = buffering;\n    this.onBuffering_(buffering);\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/playhead_observer.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.media.StreamingEngine');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.MediaSourceEngine');\ngoog.require('shaka.media.Playhead');\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.MapUtils');\ngoog.require('shaka.util.Mp4Parser');\ngoog.require('shaka.util.PublicPromise');\ngoog.require('shaka.util.StreamUtils');\n\n\n\n/**\n * Creates a StreamingEngine.\n *\n * The StreamingEngine is responsible for setting up the Manifest's Streams\n * (i.e., for calling each Stream's createSegmentIndex() function), for\n * downloading segments, for co-ordinating audio, video, and text buffering,\n * and for handling Period transitions. The StreamingEngine provides an\n * interface to switch between Streams, but it does not choose which Streams to\n * switch to.\n *\n * The StreamingEngine notifies its owner when it needs to buffer a new Period,\n * so its owner can choose which Streams within that Period to initially\n * buffer. Moreover, the StreamingEngine also notifies its owner when any\n * Stream within the current Period may be switched to, so its owner can switch\n * bitrates, resolutions, or languages.\n *\n * The StreamingEngine does not need to be notified about changes to the\n * Manifest's SegmentIndexes; however, it does need to be notified when new\n * Periods are added to the Manifest, so it can set up that Period's Streams.\n *\n * To start the StreamingEngine the owner must first call configure() followed\n * by init(). The StreamingEngine will then call onChooseStreams(p) when it\n * needs to buffer Period p; it will then switch to the Streams returned from\n * that function. The StreamingEngine will call onCanSwitch() when any\n * Stream within the current Period may be switched to.\n *\n * The owner must call seeked() each time the playhead moves to a new location\n * within the presentation timeline; however, the owner may forego calling\n * seeked() when the playhead moves outside the presentation timeline.\n *\n * @param {shakaExtern.Manifest} manifest\n * @param {shaka.media.StreamingEngine.PlayerInterface} playerInterface\n *\n * @constructor\n * @struct\n * @implements {shaka.util.IDestroyable}\n */\nshaka.media.StreamingEngine = function(manifest, playerInterface) {\n  /** @private {?shaka.media.StreamingEngine.PlayerInterface} */\n  this.playerInterface_ = playerInterface;\n\n  /** @private {?shakaExtern.Manifest} */\n  this.manifest_ = manifest;\n\n  /** @private {?shakaExtern.StreamingConfiguration} */\n  this.config_ = null;\n\n  /** @private {number} */\n  this.bufferingGoalScale_ = 1;\n\n  /** @private {Promise} */\n  this.setupPeriodPromise_ = Promise.resolve();\n\n  /**\n   * Maps a Period's index to an object that indicates that either\n   *   1. the Period has not been set up (undefined)\n   *   2. the Period is being set up ([a PublicPromise, false]),\n   *   3. the Period is set up (i.e., all Streams within the Period are set up)\n   *      and can be switched to ([a PublicPromise, true]).\n   *\n   * @private {Array.<?{promise: shaka.util.PublicPromise, resolved: boolean}>}\n   */\n  this.canSwitchPeriod_ = [];\n\n  /**\n   * Maps a Stream's ID to an object that indicates that either\n   *   1. the Stream has not been set up (undefined)\n   *   2. the Stream is being set up ([a Promise instance, false]),\n   *   3. the Stream is set up and can be switched to\n   *      ([a Promise instance, true]).\n   *\n   * @private {Object.<number,\n   *                   ?{promise: shaka.util.PublicPromise, resolved: boolean}>}\n   */\n  this.canSwitchStream_ = {};\n\n  /**\n   * Maps a content type, e.g., 'audio', 'video', or 'text', to a MediaState.\n   *\n   * @private {Object.<shaka.util.ManifestParserUtils.ContentType,\n                       !shaka.media.StreamingEngine.MediaState_>}\n   */\n  this.mediaStates_ = {};\n\n  /**\n   * Set to true once one segment of each content type has been buffered.\n   *\n   * @private {boolean}\n   */\n  this.startupComplete_ = false;\n\n  /**\n   * Set to true on fatal error.  Interrupts fetchAndAppend_().\n   *\n   * @private {boolean}\n   */\n  this.fatalError_ = false;\n\n  /** @private {boolean} */\n  this.destroyed_ = false;\n};\n\n\n/**\n * @typedef {{\n *   playhead: !shaka.media.Playhead,\n *   mediaSourceEngine: !shaka.media.MediaSourceEngine,\n *   netEngine: shaka.net.NetworkingEngine,\n *   onChooseStreams: function(!shakaExtern.Period):\n *                        !Object.<shaka.util.ManifestParserUtils.ContentType,\n *                                 shakaExtern.Stream>,\n *   onCanSwitch: function(),\n *   onError: function(!shaka.util.Error),\n *   onEvent: function(!Event),\n *   onManifestUpdate: function(),\n *   onSegmentAppended: function(),\n *   onInitialStreamsSetup: (function()|undefined),\n *   onStartupComplete: (function()|undefined)}\n * }}\n *\n * @property {!shaka.media.Playhead} playhead\n *   The Playhead. The caller retains ownership.\n * @property {!shaka.media.MediaSourceEngine} mediaSourceEngine\n *   The MediaSourceEngine. The caller retains ownership.\n * @property {shaka.net.NetworkingEngine} netEngine\n *   The NetworkingEngine instance to use. The caller retains ownership.\n * @property {function(!shakaExtern.Period):\n *                !Object.<shaka.util.ManifestParserUtils.ContentType,\n *                         shakaExtern.Stream>} onChooseStreams\n *   Called when the given Period needs to be buffered. The\n *   StreamingEngine will switch to the Streams returned from this function.\n *   The caller cannot call switch() directly until the StreamingEngine calls\n *   onCanSwitch()\n * @property {function()} onCanSwitch\n *   Called when any Stream within the current Period may be switched to.\n * @property {function(!shaka.util.Error)} onError\n *   Called when an error occurs. If the error is recoverable (see\n *   @link{shaka.util.Error}) then the caller may invoke either\n *   StreamingEngine.switch() or StreamingEngine.seeked() to attempt recovery.\n * @property {function(!Event)} onEvent\n *   Called when an event occurs that should be sent to the app.\n * @property {function()} onManifestUpdate\n *   Called when an embedded 'emsg' box should trigger a manifest update.\n * @property {function()} onSegmentAppended\n *   Called after a segment is successfully appended to a MediaSource.\n * @property {(function()|undefined)} onInitialStreamsSetup\n *   Optional callback which is called when the initial set of Streams have been\n *   setup. Intended to be used by tests.\n * @property {(function()|undefined)} onStartupComplete\n *   Optional callback which is called when startup has completed. Intended to\n *   be used by tests.\n */\nshaka.media.StreamingEngine.PlayerInterface;\n\n\n/**\n * @typedef {{\n *   type: shaka.util.ManifestParserUtils.ContentType,\n *   stream: shakaExtern.Stream,\n *   lastStream: ?shakaExtern.Stream,\n *   lastSegmentReference: shaka.media.SegmentReference,\n *   restoreStreamAfterTrickPlay: ?shakaExtern.Stream,\n *   needInitSegment: boolean,\n *   needPeriodIndex: number,\n *   endOfStream: boolean,\n *   performingUpdate: boolean,\n *   updateTimer: ?number,\n *   waitingToClearBuffer: boolean,\n *   waitingToFlushBuffer: boolean,\n *   clearingBuffer: boolean,\n *   recovering: boolean,\n *   hasError: boolean,\n *   resumeAt: number\n * }}\n *\n * @description\n * Contains the state of a logical stream, i.e., a sequence of segmented data\n * for a particular content type. At any given time there is a Stream object\n * associated with the state of the logical stream.\n *\n * @property {shaka.util.ManifestParserUtils.ContentType} type\n *   The stream's content type, e.g., 'audio', 'video', or 'text'.\n * @property {shakaExtern.Stream} stream\n *   The current Stream.\n * @property {?shakaExtern.Stream} lastStream\n *   The Stream of the last segment that was appended.\n * @property {shaka.media.SegmentReference} lastSegmentReference\n *   The SegmentReference of the last segment that was appended.\n * @property {?shakaExtern.Stream} restoreStreamAfterTrickPlay\n *   The Stream to restore after trick play mode is turned off.\n * @property {boolean} needInitSegment\n *   True indicates that |stream|'s init segment must be inserted before the\n *   next media segment is appended.\n * @property {boolean} endOfStream\n *   True indicates that the end of the buffer has hit the end of the\n *   presentation.\n * @property {number} needPeriodIndex\n *   The index of the Period which needs to be buffered.\n * @property {boolean} performingUpdate\n *   True indicates that an update is in progress.\n * @property {?number} updateTimer\n *   A non-null value indicates that an update is scheduled.\n * @property {boolean} waitingToClearBuffer\n *   True indicates that the buffer must be cleared after the current update\n *   finishes.\n * @property {boolean} waitingToFlushBuffer\n *   True indicates that the buffer must be flushed after it is cleared.\n * @property {boolean} clearingBuffer\n *   True indicates that the buffer is being cleared.\n * @property {boolean} recovering\n *   True indicates that the last segment was not appended because it could not\n *   fit in the buffer.\n * @property {boolean} hasError\n *   True indicates that the stream has encountered an error and has stopped\n *   updates.\n * @property {number} resumeAt\n *   An override for the time to start performing updates at.  If the playhead\n *   is behind this time, update_() will still start fetching segments from\n *   this time.  If the playhead is ahead of the time, this field is ignored.\n */\nshaka.media.StreamingEngine.MediaState_;\n\n\n/**\n * The minimum number seconds that will remain buffered after evicting media.\n *\n * @const {number}\n */\nshaka.media.StreamingEngine.prototype.MIN_BUFFER_LENGTH = 2;\n\n\n/** @override */\nshaka.media.StreamingEngine.prototype.destroy = function() {\n  for (var type in this.mediaStates_) {\n    this.cancelUpdate_(this.mediaStates_[type]);\n  }\n\n  this.playerInterface_ = null;\n  this.manifest_ = null;\n  this.setupPeriodPromise_ = null;\n  this.canSwitchPeriod_ = null;\n  this.canSwitchStream_ = null;\n  this.mediaStates_ = null;\n  this.config_ = null;\n\n  this.destroyed_ = true;\n\n  return Promise.resolve();\n};\n\n\n/**\n * Called by the Player to provide an updated configuration any time it changes.\n * Will be called at least once before init().\n *\n * @param {shakaExtern.StreamingConfiguration} config\n */\nshaka.media.StreamingEngine.prototype.configure = function(config) {\n  this.config_ = config;\n};\n\n\n/**\n * Initializes the StreamingEngine.\n *\n * After this function is called the StreamingEngine will call\n * onChooseStreams(p) when it needs to buffer Period p and onCanSwitch() when\n * any Stream within that Period may be switched to.\n *\n * After the StreamingEngine calls onChooseStreams(p) for the first time, it\n * will begin setting up the Streams returned from that function and\n * subsequently switch to them. However, the StreamingEngine will not begin\n * setting up any other Streams until at least one segment from each of the\n * initial set of Streams has been buffered (this reduces startup latency).\n * After the StreamingEngine completes this startup phase it will begin setting\n * up each Period's Streams (while buffering in parrallel).\n *\n * When the StreamingEngine needs to buffer the next Period it will have\n * already set up that Period's Streams. So, when the StreamingEngine calls\n * onChooseStreams(p) after the first time, the StreamingEngine will\n * immediately switch to the Streams returned from that function.\n *\n * @return {!Promise}\n */\nshaka.media.StreamingEngine.prototype.init = function() {\n  var MapUtils = shaka.util.MapUtils;\n  goog.asserts.assert(this.config_,\n      'StreamingEngine configure() must be called before init()!');\n\n  // Determine which Period we must buffer.\n  var playheadTime = this.playerInterface_.playhead.getTime();\n  var needPeriodIndex = this.findPeriodContainingTime_(playheadTime);\n\n  // Get the initial set of Streams.\n  var streamsByType = this.playerInterface_.onChooseStreams(\n      this.manifest_.periods[needPeriodIndex]);\n  if (MapUtils.empty(streamsByType)) {\n    shaka.log.error('init: no Streams chosen');\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.STREAMING,\n        shaka.util.Error.Code.INVALID_STREAMS_CHOSEN));\n  }\n\n  // Setup the initial set of Streams and then begin each update cycle. After\n  // startup completes onUpdate_() will set up the remaining Periods.\n  return this.initStreams_(streamsByType).then(function() {\n    shaka.log.debug('init: completed initial Stream setup');\n\n    // Subtlety: onInitialStreamsSetup() may call switch() or seeked(), so we\n    // must schedule an update beforehand so |updateTimer| is set.\n    if (this.playerInterface_ && this.playerInterface_.onInitialStreamsSetup) {\n      shaka.log.v1('init: calling onInitialStreamsSetup()...');\n      this.playerInterface_.onInitialStreamsSetup();\n    }\n  }.bind(this));\n};\n\n\n/**\n * Gets the current Period the stream is in.  This Period may not be initialized\n * yet if canSwitch(period) has not been called yet.\n * @return {shakaExtern.Period}\n */\nshaka.media.StreamingEngine.prototype.getCurrentPeriod = function() {\n  var playheadTime = this.playerInterface_.playhead.getTime();\n  var needPeriodIndex = this.findPeriodContainingTime_(playheadTime);\n  return this.manifest_.periods[needPeriodIndex];\n};\n\n\n/**\n * Gets the Period in which we are currently buffering.  This may be different\n * from the Period which contains the Playhead.\n * @return {?shakaExtern.Period}\n */\nshaka.media.StreamingEngine.prototype.getActivePeriod = function() {\n  goog.asserts.assert(this.mediaStates_, 'Must be initialized');\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var anyMediaState = this.mediaStates_[ContentType.VIDEO] ||\n                      this.mediaStates_[ContentType.AUDIO];\n  return anyMediaState ?\n         this.manifest_.periods[anyMediaState.needPeriodIndex] : null;\n};\n\n\n/**\n * Gets a map of all the active streams.\n * @return {!Object.<shaka.util.ManifestParserUtils.ContentType,\n *                   shakaExtern.Stream>}\n */\nshaka.media.StreamingEngine.prototype.getActiveStreams = function() {\n  goog.asserts.assert(this.mediaStates_, 'Must be initialized');\n  var MapUtils = shaka.util.MapUtils;\n  return MapUtils.map(\n      this.mediaStates_, function(state) {\n        // Don't tell the caller about trick play streams.  If we're in trick\n        // play, return the stream we will go back to after we exit trick play.\n        return state.restoreStreamAfterTrickPlay || state.stream;\n      });\n};\n\n\n/**\n * Notifies StreamingEngine that a new text stream was added to the manifest.\n * This initializes the given stream.  This returns a Promise that resolves when\n * the stream has been set up.\n *\n * @param {shakaExtern.Stream} stream\n * @return {!Promise}\n */\nshaka.media.StreamingEngine.prototype.notifyNewTextStream = function(stream) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  // Create empty object first and initialize the fields through\n  // [] to allow field names to be expressions.\n  /** @type {!Object.<string, shakaExtern.Stream>} */\n  var streamsByType = {};\n  streamsByType[ContentType.TEXT] = stream;\n  return this.initStreams_(streamsByType);\n};\n\n\n/**\n * Set trick play on or off.\n * If trick play is on, related trick play streams will be used when possible.\n * @param {boolean} on\n */\nshaka.media.StreamingEngine.prototype.setTrickPlay = function(on) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  var mediaState = this.mediaStates_[ContentType.VIDEO];\n  if (!mediaState) return;\n\n  var stream = mediaState.stream;\n  if (!stream) return;\n\n  shaka.log.debug('setTrickPlay', on);\n  if (on) {\n    var trickModeVideo = stream.trickModeVideo;\n    if (!trickModeVideo) return;  // Can't engage trick play.\n\n    var normalVideo = mediaState.restoreStreamAfterTrickPlay;\n    if (normalVideo) return;  // Already in trick play.\n\n    shaka.log.debug('Engaging trick mode stream', trickModeVideo);\n    this.switch(ContentType.VIDEO, trickModeVideo, false);\n    mediaState.restoreStreamAfterTrickPlay = stream;\n  } else {\n    var normalVideo = mediaState.restoreStreamAfterTrickPlay;\n    if (!normalVideo) return;\n\n    shaka.log.debug('Restoring non-trick-mode stream', normalVideo);\n    mediaState.restoreStreamAfterTrickPlay = null;\n    this.switch(ContentType.VIDEO, normalVideo, true);\n  }\n};\n\n\n/**\n * Switches to the given Stream. |stream| may be from any Variant or any\n * Period.\n *\n * @param {shaka.util.ManifestParserUtils.ContentType} contentType\n *  |stream|'s content type.\n * @param {shakaExtern.Stream} stream\n * @param {boolean} clearBuffer\n */\nshaka.media.StreamingEngine.prototype.switch = function(\n    contentType, stream, clearBuffer) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var mediaState = this.mediaStates_[contentType];\n  if (!mediaState && contentType == ContentType.TEXT &&\n      this.config_.ignoreTextStreamFailures) {\n    this.notifyNewTextStream(stream);\n    return;\n  }\n  goog.asserts.assert(mediaState, 'switch: expected mediaState to exist');\n  if (!mediaState) return;\n\n  // If we are selecting a stream from a different Period, then we need to\n  // handle a Period transition.  Simply ignore the given stream, assuming that\n  // Player will select the same track in onChooseStreams.\n  var periodIndex = this.findPeriodContainingStream_(stream);\n  if (clearBuffer && periodIndex != mediaState.needPeriodIndex) {\n    shaka.log.debug('switch: switching to stream in another Period; clearing ' +\n                    'buffer and changing Periods');\n    // handlePeriodTransition_ will be called on the next update because the\n    // current Period won't match the playhead Period.\n    this.clearAllBuffers_();\n    return;\n  }\n\n  if (mediaState.restoreStreamAfterTrickPlay) {\n    shaka.log.debug('switch during trick play mode', stream);\n\n    // Already in trick play mode, so stick with trick mode tracks if possible.\n    if (stream.trickModeVideo) {\n      // Use the trick mode stream, but revert to the new selection later.\n      mediaState.restoreStreamAfterTrickPlay = stream;\n      stream = stream.trickModeVideo;\n      shaka.log.debug('switch found trick play stream', stream);\n    } else {\n      // No special trick mode video for this stream!\n      mediaState.restoreStreamAfterTrickPlay = null;\n      shaka.log.debug('switch found no special trick play stream');\n    }\n  }\n\n  if (contentType == ContentType.TEXT) {\n    // Mime types are allowed to change for text streams.\n    // Reinitialize the text parser.\n    var fullMimeType = shaka.util.StreamUtils.getFullMimeType(\n        stream.mimeType, stream.codecs);\n    this.playerInterface_.mediaSourceEngine.reinitText(fullMimeType);\n  }\n\n  // Ensure the Period is ready.\n  var canSwitchRecord = this.canSwitchPeriod_[periodIndex];\n  goog.asserts.assert(\n      canSwitchRecord && canSwitchRecord.resolved,\n      'switch: expected Period ' + periodIndex + ' to be ready');\n  if (!canSwitchRecord || !canSwitchRecord.resolved) return;\n\n  // Sanity check. If the Period is ready then the Stream should be ready too.\n  canSwitchRecord = this.canSwitchStream_[stream.id];\n  goog.asserts.assert(canSwitchRecord && canSwitchRecord.resolved,\n                      'switch: expected Stream ' + stream.id + ' to be ready');\n  if (!canSwitchRecord || !canSwitchRecord.resolved) return;\n\n  if (mediaState.stream == stream) {\n    var streamTag = shaka.media.StreamingEngine.logPrefix_(mediaState);\n    shaka.log.debug('switch: Stream ' + streamTag + ' already active');\n    return;\n  }\n\n  mediaState.stream = stream;\n  mediaState.needInitSegment = true;\n\n  var streamTag = shaka.media.StreamingEngine.logPrefix_(mediaState);\n  shaka.log.debug('switch: switching to Stream ' + streamTag);\n\n  if (clearBuffer) {\n    if (mediaState.clearingBuffer) {\n      // We are already going to clear the buffer, but make sure it is also\n      // flushed.\n      mediaState.waitingToFlushBuffer = true;\n    } else if (mediaState.performingUpdate) {\n      // We are performing an update, so we have to wait until it's finished.\n      // onUpdate_() will call clearBuffer_() when the update has\n      // finished.\n      mediaState.waitingToClearBuffer = true;\n      mediaState.waitingToFlushBuffer = true;\n    } else {\n      // Cancel the update timer, if any.\n      this.cancelUpdate_(mediaState);\n      // Clear right away.\n      this.clearBuffer_(mediaState, /* flush */ true);\n    }\n  }\n};\n\n\n/**\n * Notifies the StreamingEngine that the playhead has moved to a valid time\n * within the presentation timeline.\n */\nshaka.media.StreamingEngine.prototype.seeked = function() {\n  goog.asserts.assert(this.mediaStates_, 'Must not be destroyed');\n\n  var playheadTime = this.playerInterface_.playhead.getTime();\n  var isAllBuffered = Object.keys(this.mediaStates_).every(function(type) {\n    return this.playerInterface_.mediaSourceEngine.isBuffered(\n        type, playheadTime);\n  }.bind(this));\n\n  // Only treat as a buffered seek if every media state has a buffer.  For\n  // example, if we have buffered text but not video, we should still clear\n  // every buffer so all media states need the same Period.\n  if (isAllBuffered) {\n    shaka.log.debug(\n        '(all): seeked: buffered seek: playheadTime=' + playheadTime);\n    return;\n  }\n\n  // This was an unbuffered seek (for at least one stream), clear all buffers.\n  // Don't clear only some of the buffers because we can become stalled since\n  // the media states are waiting for different Periods.\n  shaka.log.debug('(all): seeked: unbuffered seek: clearing all buffers');\n  this.clearAllBuffers_();\n};\n\n\n/**\n * Clears the buffer for every stream.  Unlike clearBuffer_, this will handle\n * cases where a MediaState is performing an update.  After this runs, every\n * MediaState will have a pending update.\n * @private\n */\nshaka.media.StreamingEngine.prototype.clearAllBuffers_ = function() {\n  for (var type in this.mediaStates_) {\n    var mediaState = this.mediaStates_[type];\n    var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n\n    if (mediaState.clearingBuffer) {\n      // We're already clearing the buffer, so we don't need to clear the\n      // buffer again.\n      shaka.log.debug(logPrefix, 'clear: already clearing the buffer');\n      continue;\n    }\n\n    if (mediaState.waitingToClearBuffer) {\n      // May not be performing an update, but an update will still happen.\n      // See: https://github.com/google/shaka-player/issues/334\n      shaka.log.debug(logPrefix, 'clear: already waiting');\n      continue;\n    }\n\n    if (mediaState.performingUpdate) {\n      // We are performing an update, so we have to wait until it's finished.\n      // onUpdate_() will call clearBuffer_() when the update has\n      // finished.\n      shaka.log.debug(logPrefix, 'clear: currently updating');\n      mediaState.waitingToClearBuffer = true;\n      continue;\n    }\n\n    if (this.playerInterface_.mediaSourceEngine.bufferStart(type) == null) {\n      // Nothing buffered.\n      shaka.log.debug(logPrefix, 'clear: nothing buffered');\n      if (mediaState.updateTimer == null) {\n        // Note: an update cycle stops when we buffer to the end of the\n        // presentation or Period, or when we raise an error.\n        this.scheduleUpdate_(mediaState, 0);\n      }\n      continue;\n    }\n\n    // An update may be scheduled, but we can just cancel it and clear the\n    // buffer right away. Note: clearBuffer_() will schedule the next update.\n    shaka.log.debug(logPrefix, 'clear: handling right now');\n    this.cancelUpdate_(mediaState);\n    this.clearBuffer_(mediaState, /* flush */ false);\n  }\n};\n\n\n/**\n * Initializes the given streams and media states if required.  This will\n * schedule updates for the given types.\n *\n * @param {!Object.<shaka.util.ManifestParserUtils.ContentType,\n                    shakaExtern.Stream>} streamsByType\n * @param {number=} opt_resumeAt\n * @return {!Promise}\n * @private\n */\nshaka.media.StreamingEngine.prototype.initStreams_ = function(\n    streamsByType, opt_resumeAt) {\n  var MapUtils = shaka.util.MapUtils;\n  goog.asserts.assert(this.config_,\n      'StreamingEngine configure() must be called before init()!');\n\n  // Determine which Period we must buffer.\n  var playheadTime = this.playerInterface_.playhead.getTime();\n  var needPeriodIndex = this.findPeriodContainingTime_(playheadTime);\n\n  // Init MediaSourceEngine.\n  var typeConfig = MapUtils.map(streamsByType, function(stream) {\n    return shaka.util.StreamUtils.getFullMimeType(\n        stream.mimeType, stream.codecs);\n  });\n\n  this.playerInterface_.mediaSourceEngine.init(typeConfig);\n  this.setDuration_();\n\n  // Setup the initial set of Streams and then begin each update cycle. After\n  // startup completes onUpdate_() will set up the remaining Periods.\n  var streams = MapUtils.values(streamsByType);\n  return this.setupStreams_(streams).then(function() {\n    if (this.destroyed_) return;\n\n    for (var type in streamsByType) {\n      var stream = streamsByType[type];\n      if (!this.mediaStates_[type]) {\n        this.mediaStates_[type] = {\n          stream: stream,\n          type: type,\n          lastStream: null,\n          lastSegmentReference: null,\n          restoreStreamAfterTrickPlay: null,\n          needInitSegment: true,\n          needPeriodIndex: needPeriodIndex,\n          endOfStream: false,\n          performingUpdate: false,\n          updateTimer: null,\n          waitingToClearBuffer: false,\n          waitingToFlushBuffer: false,\n          clearingBuffer: false,\n          recovering: false,\n          hasError: false,\n          resumeAt: opt_resumeAt || 0\n        };\n        this.scheduleUpdate_(this.mediaStates_[type], 0);\n      }\n    }\n  }.bind(this));\n};\n\n\n/**\n * Sets up the given Period if necessary. Calls onError() if an error\n * occurs.\n *\n * @param {number} periodIndex The Period's index.\n * @return {!Promise} A Promise which is resolved when the given Period is\n *   setup.\n * @private\n */\nshaka.media.StreamingEngine.prototype.setupPeriod_ = function(periodIndex) {\n  var Functional = shaka.util.Functional;\n  var canSwitchRecord = this.canSwitchPeriod_[periodIndex];\n  if (canSwitchRecord) {\n    shaka.log.debug(\n        '(all) Period ' + periodIndex + ' is being or has been set up');\n    goog.asserts.assert(canSwitchRecord.promise, 'promise must not be null');\n    return canSwitchRecord.promise;\n  }\n\n  shaka.log.debug('(all) setting up Period ' + periodIndex);\n  canSwitchRecord = {\n    promise: new shaka.util.PublicPromise(),\n    resolved: false\n  };\n  this.canSwitchPeriod_[periodIndex] = canSwitchRecord;\n\n  var streams = this.manifest_.periods[periodIndex].variants\n      .map(function(variant) {\n        var result = [];\n        if (variant.audio)\n          result.push(variant.audio);\n        if (variant.video)\n          result.push(variant.video);\n        if (variant.video && variant.video.trickModeVideo)\n          result.push(variant.video.trickModeVideo);\n        return result;\n      })\n      .reduce(Functional.collapseArrays, [])\n      .filter(Functional.isNotDuplicate);\n\n  // Add text streams\n  streams.push.apply(streams, this.manifest_.periods[periodIndex].textStreams);\n\n  // Serialize Period set up.\n  this.setupPeriodPromise_ = this.setupPeriodPromise_.then(function() {\n    if (this.destroyed_) return;\n    return this.setupStreams_(streams);\n  }.bind(this)).then(function() {\n    if (this.destroyed_) return;\n    this.canSwitchPeriod_[periodIndex].promise.resolve();\n    this.canSwitchPeriod_[periodIndex].resolved = true;\n    shaka.log.v1('(all) setup Period ' + periodIndex);\n  }.bind(this)).catch(function(error) {\n    if (this.destroyed_) return;\n    this.canSwitchPeriod_[periodIndex].promise.reject();\n    delete this.canSwitchPeriod_[periodIndex];\n    shaka.log.warning('(all) failed to setup Period ' + periodIndex);\n    this.playerInterface_.onError(error);\n    // Don't stop other Periods from being set up.\n  }.bind(this));\n\n  return canSwitchRecord.promise;\n};\n\n\n/**\n * Sets up the given Streams if necessary. Does NOT call onError() if an\n * error occurs.\n *\n * @param {!Array.<!shakaExtern.Stream>} streams\n * @return {!Promise}\n * @private\n */\nshaka.media.StreamingEngine.prototype.setupStreams_ = function(streams) {\n  // Make sure that all the streams have unique ids.\n  // (Duplicate ids will cause the player to hang).\n  var uniqueStreamIds = streams.map(function(s) { return s.id; })\n                               .filter(shaka.util.Functional.isNotDuplicate);\n\n  goog.asserts.assert(uniqueStreamIds.length == streams.length,\n                      'streams should have unique ids');\n  // Parallelize Stream set up.\n  var async = [];\n\n  for (var i = 0; i < streams.length; ++i) {\n    var stream = streams[i];\n    var canSwitchRecord = this.canSwitchStream_[stream.id];\n\n    if (canSwitchRecord) {\n      shaka.log.debug(\n          '(all) Stream ' + stream.id + ' is being or has been set up');\n      async.push(canSwitchRecord.promise);\n    } else {\n      shaka.log.v1('(all) setting up Stream ' + stream.id);\n      this.canSwitchStream_[stream.id] = {\n        promise: new shaka.util.PublicPromise(),\n        resolved: false\n      };\n      async.push(stream.createSegmentIndex());\n    }\n  }\n\n  return Promise.all(async).then(function() {\n    if (this.destroyed_) return;\n\n    for (var i = 0; i < streams.length; ++i) {\n      var stream = streams[i];\n      var canSwitchRecord = this.canSwitchStream_[stream.id];\n      if (!canSwitchRecord.resolved) {\n        canSwitchRecord.promise.resolve();\n        canSwitchRecord.resolved = true;\n        shaka.log.v1('(all) setup Stream ' + stream.id);\n      }\n    }\n  }.bind(this)).catch(function(error) {\n    if (this.destroyed_) return;\n    this.canSwitchStream_[stream.id].promise.reject();\n    delete this.canSwitchStream_[stream.id];\n    return Promise.reject(error);\n  }.bind(this));\n};\n\n\n/**\n * Sets the MediaSource's duration.\n * @private\n */\nshaka.media.StreamingEngine.prototype.setDuration_ = function() {\n  var duration = this.manifest_.presentationTimeline.getDuration();\n  if (duration < Infinity) {\n    this.playerInterface_.mediaSourceEngine.setDuration(duration);\n  } else {\n    // Not all platforms support infinite durations, so set a finite duration\n    // so we can append segments and so the user agent can seek.\n    this.playerInterface_.mediaSourceEngine.setDuration(Math.pow(2, 32));\n  }\n};\n\n\n/**\n * Called when |mediaState|'s update timer has expired.\n *\n * @param {!shaka.media.StreamingEngine.MediaState_} mediaState\n * @private\n */\nshaka.media.StreamingEngine.prototype.onUpdate_ = function(mediaState) {\n  var MapUtils = shaka.util.MapUtils;\n  if (this.destroyed_) return;\n\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n\n  // Sanity check.\n  goog.asserts.assert(\n      !mediaState.performingUpdate && (mediaState.updateTimer != null),\n      logPrefix + ' unexpected call to onUpdate_()');\n  if (mediaState.performingUpdate || (mediaState.updateTimer == null)) return;\n\n  goog.asserts.assert(\n      !mediaState.clearingBuffer,\n      logPrefix + ' onUpdate_() should not be called when clearing the buffer');\n  if (mediaState.clearingBuffer) return;\n\n  mediaState.updateTimer = null;\n\n  // Handle pending buffer clears.\n  if (mediaState.waitingToClearBuffer) {\n    // Note: clearBuffer_() will schedule the next update.\n    shaka.log.debug(logPrefix, 'skipping update and clearing the buffer');\n    this.clearBuffer_(mediaState, mediaState.waitingToFlushBuffer);\n    return;\n  }\n\n  // Update the MediaState.\n  try {\n    var delay = this.update_(mediaState);\n    if (delay != null) {\n      this.scheduleUpdate_(mediaState, delay);\n      mediaState.hasError = false;\n    }\n  } catch (error) {\n    this.playerInterface_.onError(error);\n    return;\n  }\n\n  goog.asserts.assert(this.mediaStates_, 'must not be destroyed');\n\n  var mediaStates = MapUtils.values(this.mediaStates_);\n\n  // Check if we've buffered to the end of the Period.\n  this.handlePeriodTransition_(mediaState);\n\n  // Check if we've buffered to the end of the presentation.\n  if (mediaStates.every(function(ms) { return ms.endOfStream; })) {\n    shaka.log.v1(logPrefix, 'calling endOfStream()...');\n    this.playerInterface_.mediaSourceEngine.endOfStream().then(function() {\n      // If the media segments don't reach the end, then we need to update the\n      // timeline duration to match the final media duration to avoid buffering\n      // forever at the end.\n      var duration = this.playerInterface_.mediaSourceEngine.getDuration();\n      this.manifest_.presentationTimeline.setDuration(duration);\n    }.bind(this));\n  }\n};\n\n\n/**\n * Updates the given MediaState.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @return {?number} The number of seconds to wait until updating again or\n *   null if another update does not need to be scheduled.\n * @throws {!shaka.util.Error} if an error occurs.\n * @private\n */\nshaka.media.StreamingEngine.prototype.update_ = function(mediaState) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n\n  // Compute how far we've buffered ahead of the playhead.\n  var playheadTime = this.playerInterface_.playhead.getTime();\n\n  // Get the next timestamp we need.\n  var timeNeeded = this.getTimeNeeded_(mediaState, playheadTime);\n  shaka.log.v2(logPrefix, 'timeNeeded=' + timeNeeded);\n  mediaState.resumeAt = 0;\n\n  var currentPeriodIndex = this.findPeriodContainingStream_(mediaState.stream);\n  var needPeriodIndex = this.findPeriodContainingTime_(timeNeeded);\n\n  // Get the amount of content we have buffered, accounting for drift.  This\n  // is only used to determine if we have meet the buffering goal.  This should\n  // be the same way that PlayheadObserver uses.\n  var bufferedAhead = this.playerInterface_.mediaSourceEngine.bufferedAheadOf(\n      mediaState.type, playheadTime);\n\n  shaka.log.v2(logPrefix,\n               'update_:',\n               'playheadTime=' + playheadTime,\n               'bufferedAhead=' + bufferedAhead);\n\n  var bufferingGoal = this.getBufferingGoal_();\n\n  // Check if we've buffered to the end of the presentation.\n  if (timeNeeded >= this.manifest_.presentationTimeline.getDuration()) {\n    // We shouldn't rebuffer if the playhead is close to the end of the\n    // presentation.\n    shaka.log.debug(logPrefix, 'buffered to end of presentation');\n    mediaState.endOfStream = true;\n    return null;\n  }\n  mediaState.endOfStream = false;\n\n  // Check if we've buffered to the end of the Period. This should be done\n  // before checking segment availability because the new Period may become\n  // available once it's switched to. Note that we don't use the non-existence\n  // of SegmentReferences as an indicator to determine Period boundaries\n  // because SegmentIndexes can provide SegmentReferences outside its Period.\n  mediaState.needPeriodIndex = needPeriodIndex;\n  if (needPeriodIndex != currentPeriodIndex) {\n    shaka.log.debug(logPrefix,\n                    'need Period ' + needPeriodIndex,\n                    'playheadTime=' + playheadTime,\n                    'timeNeeded=' + timeNeeded,\n                    'currentPeriodIndex=' + currentPeriodIndex);\n    return null;\n  }\n\n  // If we've buffered to the buffering goal then schedule an update.\n  if (bufferedAhead >= bufferingGoal) {\n    shaka.log.v2(logPrefix, 'buffering goal met');\n\n    // Do not try to predict the next update.  Just poll twice every second.\n    // The playback rate can change at any time, so any prediction we make now\n    // could be terribly invalid soon.\n    return 0.5;\n  }\n\n  var bufferEnd =\n      this.playerInterface_.mediaSourceEngine.bufferEnd(mediaState.type);\n  var reference = this.getSegmentReferenceNeeded_(\n      mediaState, playheadTime, bufferEnd, currentPeriodIndex);\n  if (!reference) {\n    // The segment could not be found, does not exist, or is not available.  In\n    // any case just try again... if the manifest is incomplete or is not being\n    // updated then we'll idle forever; otherwise, we'll end up getting a\n    // SegmentReference eventually.\n    return 1;\n  }\n\n  this.fetchAndAppend_(mediaState, playheadTime, currentPeriodIndex, reference);\n  return null;\n};\n\n\n/**\n * Computes buffering goal.\n *\n * @return {number}\n * @private\n */\nshaka.media.StreamingEngine.prototype.getBufferingGoal_ = function() {\n  goog.asserts.assert(this.manifest_, 'manifest_ should not be null');\n  goog.asserts.assert(this.config_, 'config_ should not be null');\n\n  var rebufferingGoal = shaka.util.StreamUtils.getRebufferingGoal(\n      this.manifest_, this.config_, this.bufferingGoalScale_);\n\n  return Math.max(\n      rebufferingGoal,\n      this.bufferingGoalScale_ * this.config_.bufferingGoal);\n};\n\n\n/**\n * Gets the next timestamp needed. Returns the playhead's position if the\n * buffer is empty; otherwise, returns the time at which the last segment\n * appended ends.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {number} playheadTime\n * @return {number} The next timestamp needed.\n * @throws {!shaka.util.Error} if the buffer is inconsistent with our\n *   expectations.\n * @private\n */\nshaka.media.StreamingEngine.prototype.getTimeNeeded_ = function(\n    mediaState, playheadTime) {\n  // Get the next timestamp we need. We must use |lastSegmentReference|\n  // to determine this and not the actual buffer for two reasons:\n  //   1. actual segments end slightly before their advertised end times, so\n  //      the next timestamp we need is actually larger than |bufferEnd|; and\n  //   2. there may be drift (the timestamps in the segments are ahead/behind\n  //      of the timestamps in the manifest), but we need drift free times when\n  //      comparing times against presentation and Period boundaries.\n  if (!mediaState.lastStream || !mediaState.lastSegmentReference) {\n    return Math.max(playheadTime, mediaState.resumeAt);\n  }\n\n  var lastPeriodIndex =\n      this.findPeriodContainingStream_(mediaState.lastStream);\n  var lastPeriod = this.manifest_.periods[lastPeriodIndex];\n  return lastPeriod.startTime + mediaState.lastSegmentReference.endTime;\n};\n\n\n/**\n * Gets the SegmentReference of the next segment needed.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {number} playheadTime\n * @param {?number} bufferEnd\n * @param {number} currentPeriodIndex\n * @return {shaka.media.SegmentReference} The SegmentReference of the\n *   next segment needed, or null if a segment could not be found, does not\n *   exist, or is not available.\n * @private\n */\nshaka.media.StreamingEngine.prototype.getSegmentReferenceNeeded_ = function(\n    mediaState, playheadTime, bufferEnd, currentPeriodIndex) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n\n  if (mediaState.lastSegmentReference &&\n      mediaState.stream == mediaState.lastStream) {\n    // Something is buffered from the same Stream.\n    var position = mediaState.lastSegmentReference.position + 1;\n    shaka.log.v2(logPrefix, 'next position known:', 'position=' + position);\n\n    return this.getSegmentReferenceIfAvailable_(\n        mediaState, currentPeriodIndex, position);\n  }\n\n  var position;\n\n  if (mediaState.lastSegmentReference) {\n    // Something is buffered from another Stream.\n    goog.asserts.assert(mediaState.lastStream, 'lastStream should not be null');\n    shaka.log.v1(logPrefix, 'next position unknown: another Stream buffered');\n    var lastPeriodIndex =\n        this.findPeriodContainingStream_(mediaState.lastStream);\n    var lastPeriod = this.manifest_.periods[lastPeriodIndex];\n    position = this.lookupSegmentPosition_(\n        mediaState,\n        lastPeriod.startTime + mediaState.lastSegmentReference.endTime,\n        currentPeriodIndex);\n  } else {\n    // Either nothing is buffered, or we have cleared part of the buffer.  If\n    // we still have some buffered, use that time to find the segment, otherwise\n    // start at the playhead time.\n    goog.asserts.assert(!mediaState.lastStream, 'lastStream should be null');\n    shaka.log.v1(logPrefix, 'next position unknown: nothing buffered');\n    position = this.lookupSegmentPosition_(\n        mediaState, bufferEnd || playheadTime, currentPeriodIndex);\n  }\n\n  if (position == null)\n    return null;\n\n  var reference = null;\n  if (bufferEnd == null) {\n    // If there's positive drift then we need to get the previous segment;\n    // however, we don't actually know how much drift there is, so we must\n    // unconditionally get the previous segment. If it turns out that there's\n    // non-positive drift then we'll just end up buffering beind the playhead a\n    // little more than we needed.\n    var optimalPosition = Math.max(0, position - 1);\n    reference = this.getSegmentReferenceIfAvailable_(\n        mediaState, currentPeriodIndex, optimalPosition);\n  }\n  return reference ||\n      this.getSegmentReferenceIfAvailable_(\n          mediaState, currentPeriodIndex, position);\n};\n\n\n/**\n * Looks up the position of the segment containing the given timestamp.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {number} presentationTime The timestamp needed, relative to the\n *   start of the presentation.\n * @param {number} currentPeriodIndex\n * @return {?number} A segment position, or null if a segment was not be found.\n * @private\n */\nshaka.media.StreamingEngine.prototype.lookupSegmentPosition_ = function(\n    mediaState, presentationTime, currentPeriodIndex) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n  var currentPeriod = this.manifest_.periods[currentPeriodIndex];\n\n  shaka.log.debug(logPrefix,\n                  'looking up segment:',\n                  'presentationTime=' + presentationTime,\n                  'currentPeriod.startTime=' + currentPeriod.startTime);\n\n  var lookupTime = Math.max(0, presentationTime - currentPeriod.startTime);\n  var position = mediaState.stream.findSegmentPosition(lookupTime);\n\n  if (position == null) {\n    shaka.log.warning(logPrefix,\n                      'cannot find segment:',\n                      'currentPeriod.startTime=' + currentPeriod.startTime,\n                      'lookupTime=' + lookupTime);\n  }\n\n  return position;\n};\n\n\n/**\n * Gets the SegmentReference at the given position if it's available.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {number} currentPeriodIndex\n * @param {number} position\n * @return {shaka.media.SegmentReference}\n *\n * @private\n */\nshaka.media.StreamingEngine.prototype.getSegmentReferenceIfAvailable_ =\n    function(mediaState, currentPeriodIndex, position) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n  var currentPeriod = this.manifest_.periods[currentPeriodIndex];\n\n  var reference = mediaState.stream.getSegmentReference(position);\n  if (!reference) {\n    shaka.log.v1(logPrefix,\n                 'segment does not exist:',\n                 'currentPeriod.startTime=' + currentPeriod.startTime,\n                 'position=' + position);\n    return null;\n  }\n\n  var timeline = this.manifest_.presentationTimeline;\n  var availabilityStart = timeline.getSegmentAvailabilityStart();\n  var availabilityEnd = timeline.getSegmentAvailabilityEnd();\n\n  if ((currentPeriod.startTime + reference.endTime < availabilityStart) ||\n      (currentPeriod.startTime + reference.startTime > availabilityEnd)) {\n    shaka.log.v2(logPrefix,\n                 'segment is not available:',\n                 'currentPeriod.startTime=' + currentPeriod.startTime,\n                 'reference.startTime=' + reference.startTime,\n                 'reference.endTime=' + reference.endTime,\n                 'availabilityStart=' + availabilityStart,\n                 'availabilityEnd=' + availabilityEnd);\n    return null;\n  }\n\n  return reference;\n};\n\n\n/**\n * Fetches and appends the given segment; sets up the given MediaState's\n * associated SourceBuffer and evicts segments if either are required\n * beforehand. Schedules another update after completing successfully.\n *\n * @param {!shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {number} playheadTime\n * @param {number} currentPeriodIndex The index of the current Period.\n * @param {!shaka.media.SegmentReference} reference\n * @private\n */\nshaka.media.StreamingEngine.prototype.fetchAndAppend_ = function(\n    mediaState, playheadTime, currentPeriodIndex, reference) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var currentPeriod = this.manifest_.periods[currentPeriodIndex];\n\n  shaka.log.v1(logPrefix,\n               'fetchAndAppend_:',\n               'playheadTime=' + playheadTime,\n               'currentPeriod.startTime=' + currentPeriod.startTime,\n               'reference.position=' + reference.position,\n               'reference.startTime=' + reference.startTime,\n               'reference.endTime=' + reference.endTime);\n\n  // Subtlety: The playhead may move while asynchronous update operations are\n  // in progress, so we should avoid calling playhead.getTime() in any\n  // callbacks. Furthermore, switch() may be called at any time, so we should\n  // also avoid using mediaState.stream or mediaState.needInitSegment in any\n  // callbacks too.\n  var stream = mediaState.stream;\n\n  // Compute the append window end.\n  var followingPeriod = this.manifest_.periods[currentPeriodIndex + 1];\n  var appendWindowEnd = null;\n  if (followingPeriod) {\n    appendWindowEnd = followingPeriod.startTime;\n  } else {\n    appendWindowEnd = this.manifest_.presentationTimeline.getDuration();\n  }\n  goog.asserts.assert(\n      (appendWindowEnd == null) || (reference.startTime <= appendWindowEnd),\n      logPrefix + ' segment should start before append window end');\n\n  var initSourceBuffer =\n      this.initSourceBuffer_(mediaState, currentPeriodIndex, appendWindowEnd);\n\n  mediaState.performingUpdate = true;\n\n  // We may set |needInitSegment| to true in switch(), so set it to false here,\n  // since we want it to remain true if switch() is called.\n  mediaState.needInitSegment = false;\n\n  shaka.log.v2(logPrefix, 'fetching segment');\n  var fetchSegment = this.fetch_(reference);\n\n  Promise.all([initSourceBuffer, fetchSegment]).then(function(results) {\n    if (this.destroyed_ || this.fatalError_) return;\n    return this.append_(mediaState,\n                        playheadTime,\n                        currentPeriod,\n                        stream,\n                        reference,\n                        results[1]);\n  }.bind(this)).then(function() {\n    if (this.destroyed_ || this.fatalError_) return;\n\n    mediaState.performingUpdate = false;\n    mediaState.recovering = false;\n\n    if (!mediaState.waitingToClearBuffer)\n      this.playerInterface_.onSegmentAppended();\n\n    // Update right away.\n    this.scheduleUpdate_(mediaState, 0);\n\n    // Subtlety: handleStartup_() calls onStartupComplete() which may call\n    // switch() or seeked(), so we must schedule an update beforehand so\n    // |updateTimer| is set.\n    this.handleStartup_(mediaState, stream);\n\n    shaka.log.v1(logPrefix, 'finished fetch and append');\n  }.bind(this)).catch(function(error) {\n    if (this.destroyed_ || this.fatalError_) return;\n    goog.asserts.assert(error instanceof shaka.util.Error,\n                        'Should only receive a Shaka error');\n\n    mediaState.performingUpdate = false;\n\n    if (this.manifest_.presentationTimeline.isLive() &&\n        this.config_.infiniteRetriesForLiveStreams &&\n        (error.code == shaka.util.Error.Code.BAD_HTTP_STATUS ||\n        error.code == shaka.util.Error.Code.HTTP_ERROR ||\n        error.code == shaka.util.Error.Code.TIMEOUT)) {\n      this.handleNetworkError_(mediaState, error);\n    } else if (error.code == shaka.util.Error.Code.QUOTA_EXCEEDED_ERROR) {\n      this.handleQuotaExceeded_(mediaState, error);\n    } else {\n      shaka.log.error(logPrefix, 'failed fetch and append: code=' + error.code);\n      if (mediaState.type == ContentType.TEXT &&\n          this.config_.ignoreTextStreamFailures) {\n        shaka.log.warning(logPrefix,\n            'Text stream failed to parse. Proceeding without it.');\n        delete this.mediaStates_[ContentType.TEXT];\n      } else {\n        mediaState.hasError = true;\n        error.severity = shaka.util.Error.Severity.CRITICAL;\n        this.playerInterface_.onError(error);\n      }\n    }\n  }.bind(this));\n};\n\n\n/**\n * Handles a network error.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {!shaka.util.Error} error\n * @private\n */\nshaka.media.StreamingEngine.prototype.handleNetworkError_ = function(\n    mediaState, error) {\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n  if (mediaState.type == ContentType.TEXT &&\n      this.config_.ignoreTextStreamFailures &&\n      error.code == shaka.util.Error.Code.BAD_HTTP_STATUS) {\n    shaka.log.warning(logPrefix,\n        'Text stream failed to download. Proceeding without it.');\n    delete this.mediaStates_[ContentType.TEXT];\n  } else {\n    error.severity = shaka.util.Error.Severity.RECOVERABLE;\n    this.playerInterface_.onError(error);\n\n    shaka.log.warning(logPrefix, 'Network error. Retrying...');\n    this.scheduleUpdate_(mediaState, 4);\n  }\n};\n\n\n/**\n * Handles a QUOTA_EXCEEDED_ERROR.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {!shaka.util.Error} error\n * @private\n */\nshaka.media.StreamingEngine.prototype.handleQuotaExceeded_ = function(\n    mediaState, error) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n\n  // The segment cannot fit into the SourceBuffer. Ideally, MediaSource would\n  // have evicted old data to accommodate the segment; however, it may have\n  // failed to do this if the segment is very large, or if it could not find\n  // a suitable time range to remove.\n  //\n  // We can overcome the latter by trying to append the segment again;\n  // however, to avoid continuous QuotaExceededErrors we must reduce the size\n  // of the buffer going forward.\n  //\n  // If we've recently reduced the buffering goals, wait until the stream\n  // which caused the first QuotaExceededError recovers. Doing this ensures\n  // we don't reduce the buffering goals too quickly.\n\n  goog.asserts.assert(this.mediaStates_, 'must not be destroyed');\n  var mediaStates = shaka.util.MapUtils.values(this.mediaStates_);\n  var waitingForAnotherStreamToRecover = mediaStates.some(function(ms) {\n    return ms != mediaState && ms.recovering;\n  });\n\n  if (!waitingForAnotherStreamToRecover) {\n    // Reduction schedule: 80%, 60%, 40%, 20%, 16%, 12%, 8%, 4%, fail.\n    // Note: percentages are used for comparisons to avoid rounding errors.\n    var percentBefore = Math.round(100 * this.bufferingGoalScale_);\n    if (percentBefore > 20) {\n      this.bufferingGoalScale_ -= 0.2;\n    } else if (percentBefore > 4) {\n      this.bufferingGoalScale_ -= 0.04;\n    } else {\n      shaka.log.error(\n          logPrefix, 'MediaSource threw QuotaExceededError too many times');\n      mediaState.hasError = true;\n      this.fatalError_ = true;\n      this.playerInterface_.onError(error);\n      return;\n    }\n    var percentAfter = Math.round(100 * this.bufferingGoalScale_);\n    shaka.log.warning(\n        logPrefix,\n        'MediaSource threw QuotaExceededError:',\n        'reducing buffering goals by ' + (100 - percentAfter) + '%');\n    mediaState.recovering = true;\n  } else {\n    shaka.log.debug(\n        logPrefix,\n        'MediaSource threw QuotaExceededError:',\n        'waiting for another stream to recover...');\n  }\n\n  // QuotaExceededError gets thrown if evication didn't help to make room\n  // for a segment. We want to wait for a while (4 seconds is just an\n  // arbitrary number) before updating to give the playhead a chance to\n  // advance, so we don't immidiately throw again.\n  this.scheduleUpdate_(mediaState, 4);\n};\n\n\n/**\n * Sets the given MediaState's associated SourceBuffer's timestamp offset and\n * init segment if either are required. If an error occurs then neither the\n * timestamp offset or init segment are unset, since another call to switch()\n * will end up superseding them.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {number} currentPeriodIndex\n * @param {?number} appendWindowEnd\n * @return {!Promise}\n * @private\n */\nshaka.media.StreamingEngine.prototype.initSourceBuffer_ = function(\n    mediaState, currentPeriodIndex, appendWindowEnd) {\n  if (!mediaState.needInitSegment)\n    return Promise.resolve();\n\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n  var currentPeriod = this.manifest_.periods[currentPeriodIndex];\n\n  // If we need an init segment then the Stream switched, so we've either\n  // changed bitrates, Periods, or both. If we've changed Periods then we must\n  // set a new timestamp offset and append window end. Note that by setting\n  // these values here, we avoid having to co-ordinate ongoing updates, which\n  // we would have to do if we instead set them in switch().\n  var timestampOffset =\n      currentPeriod.startTime - mediaState.stream.presentationTimeOffset;\n  shaka.log.v1(logPrefix, 'setting timestamp offset to ' + timestampOffset);\n  shaka.log.v1(logPrefix, 'setting append window end to ' + appendWindowEnd);\n  var setStreamProperties =\n      this.playerInterface_.mediaSourceEngine.setStreamProperties(\n          mediaState.type, timestampOffset, appendWindowEnd);\n\n  if (!mediaState.stream.initSegmentReference) {\n    // The Stream is self initializing.\n    return setStreamProperties;\n  }\n\n  shaka.log.v1(logPrefix, 'fetching init segment');\n  var fetchInit = this.fetch_(mediaState.stream.initSegmentReference);\n  var appendInit = fetchInit.then(function(initSegment) {\n    if (this.destroyed_) return;\n    shaka.log.v1(logPrefix, 'appending init segment');\n\n    return this.playerInterface_.mediaSourceEngine.appendBuffer(\n        mediaState.type, initSegment, null /* startTime */, null /* endTime */);\n  }.bind(this)).catch(function(error) {\n    mediaState.needInitSegment = true;\n    return Promise.reject(error);\n  });\n\n  return Promise.all([setStreamProperties, appendInit]);\n};\n\n\n/**\n * Appends the given segment and evicts content if required to append.\n *\n * @param {!shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {number} playheadTime\n * @param {shakaExtern.Period} period\n * @param {shakaExtern.Stream} stream\n * @param {!shaka.media.SegmentReference} reference\n * @param {!ArrayBuffer} segment\n * @return {!Promise}\n * @private\n */\nshaka.media.StreamingEngine.prototype.append_ = function(\n    mediaState, playheadTime, period, stream, reference, segment) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n\n  if (stream.containsEmsgBoxes) {\n    new shaka.util.Mp4Parser()\n        .fullBox('emsg', this.parseEMSG_.bind(this, period, reference))\n        .parse(segment);\n  }\n\n  return this.evict_(mediaState, playheadTime).then(function() {\n    if (this.destroyed_) return;\n    shaka.log.v1(logPrefix, 'appending media segment');\n\n    return this.playerInterface_.mediaSourceEngine.appendBuffer(\n        mediaState.type, segment, reference.startTime + period.startTime,\n        reference.endTime + period.startTime);\n  }.bind(this)).then(function() {\n    if (this.destroyed_) return;\n    shaka.log.v2(logPrefix, 'appended media segment');\n\n    // We must use |stream| because switch() may have been called.\n    mediaState.lastStream = stream;\n    mediaState.lastSegmentReference = reference;\n\n    return Promise.resolve();\n  }.bind(this));\n};\n\n\n/**\n * Parse the EMSG box from a MP4 container.\n *\n * @param {!shakaExtern.Period} period\n * @param {!shaka.media.SegmentReference} reference\n * @param {!shaka.util.Mp4Parser.ParsedBox} box\n * @private\n */\nshaka.media.StreamingEngine.prototype.parseEMSG_ = function(\n    period, reference, box) {\n\n  var schemeId = box.reader.readTerminatedString();\n  // read rest of the data and dispatch event to the application\n  var value = box.reader.readTerminatedString();\n  var timescale = box.reader.readUint32();\n  var presentationTimeDelta = box.reader.readUint32();\n  var eventDuration = box.reader.readUint32();\n  var id = box.reader.readUint32();\n  var messageData = box.reader.readBytes(\n      box.reader.getLength() - box.reader.getPosition());\n\n  var startTime = period.startTime + reference.startTime +\n      (presentationTimeDelta / timescale);\n\n  // See DASH sec. 5.10.4.1\n  // A special scheme in DASH used to signal manifest updates.\n  if (schemeId == 'urn:mpeg:dash:event:2012') {\n    this.playerInterface_.onManifestUpdate();\n  } else {\n    /** @type {shakaExtern.EmsgInfo} */\n    var emsg = {\n      startTime: startTime,\n      endTime: startTime + (eventDuration / timescale),\n      schemeIdUri: schemeId,\n      value: value,\n      timescale: timescale,\n      presentationTimeDelta: presentationTimeDelta,\n      eventDuration: eventDuration,\n      id: id,\n      messageData: messageData\n    };\n\n    var event = new shaka.util.FakeEvent('emsg', {'detail': emsg});\n    this.playerInterface_.onEvent(event);\n  }\n};\n\n\n/**\n * Evicts media to meet the max buffer behind limit.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {number} playheadTime\n * @return {!Promise}\n * @private\n */\nshaka.media.StreamingEngine.prototype.evict_ = function(\n    mediaState, playheadTime) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n  shaka.log.v2(logPrefix, 'checking buffer length');\n\n  var startTime =\n      this.playerInterface_.mediaSourceEngine.bufferStart(mediaState.type);\n  if (startTime == null) {\n    shaka.log.v2(logPrefix,\n                 'buffer behind okay because nothing buffered:',\n                 'playheadTime=' + playheadTime,\n                 'bufferBehind=' + this.config_.bufferBehind);\n    return Promise.resolve();\n  }\n  var bufferedBehind = playheadTime - startTime;\n\n  var overflow = bufferedBehind - this.config_.bufferBehind;\n  if (overflow <= 0) {\n    shaka.log.v2(logPrefix,\n                 'buffer behind okay:',\n                 'playheadTime=' + playheadTime,\n                 'bufferedBehind=' + bufferedBehind,\n                 'bufferBehind=' + this.config_.bufferBehind,\n                 'underflow=' + (-overflow));\n    return Promise.resolve();\n  }\n\n  shaka.log.v1(logPrefix,\n               'buffer behind too large:',\n               'playheadTime=' + playheadTime,\n               'bufferedBehind=' + bufferedBehind,\n               'bufferBehind=' + this.config_.bufferBehind,\n               'overflow=' + overflow);\n\n  return this.playerInterface_.mediaSourceEngine.remove(\n      mediaState.type, startTime, startTime + overflow).then(function() {\n    if (this.destroyed_) return;\n    shaka.log.v1(logPrefix, 'evicted ' + overflow + ' seconds');\n  }.bind(this));\n};\n\n\n/**\n * Sets up all known Periods when startup completes; otherwise, does nothing.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState The last\n *   MediaState updated.\n * @param {shakaExtern.Stream} stream\n * @private\n */\nshaka.media.StreamingEngine.prototype.handleStartup_ = function(\n    mediaState, stream) {\n  var Functional = shaka.util.Functional;\n  var MapUtils = shaka.util.MapUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  if (this.startupComplete_)\n    return;\n\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n\n  goog.asserts.assert(this.mediaStates_, 'must not be destroyed');\n  var mediaStates = MapUtils.values(this.mediaStates_);\n  this.startupComplete_ = mediaStates.every(function(ms) {\n    // Startup completes once we have buffered at least one segment from each\n    // MediaState, not counting text.\n    if (ms.type == ContentType.TEXT) return true;\n    return !ms.waitingToClearBuffer &&\n           !ms.clearingBuffer &&\n           ms.lastSegmentReference;\n  });\n\n  if (!this.startupComplete_)\n    return;\n\n  shaka.log.debug(logPrefix, 'startup complete');\n\n  // We must use |stream| because switch() may have been called.\n  var currentPeriodIndex = this.findPeriodContainingStream_(stream);\n\n  goog.asserts.assert(\n      mediaStates.every(function(ms) {\n        // It is possible for one stream (usually text) to buffer the whole\n        // Period and need the next one.\n        return ms.needPeriodIndex == currentPeriodIndex ||\n            ms.needPeriodIndex == currentPeriodIndex + 1;\n      }),\n      logPrefix + ' expected all MediaStates to need same Period');\n\n  // Setup the current Period if necessary, which is likely since the current\n  // Period is probably the initial one.\n  if (!this.canSwitchPeriod_[currentPeriodIndex]) {\n    this.setupPeriod_(currentPeriodIndex).then(function() {\n      shaka.log.v1(logPrefix, 'calling onCanSwitch()...');\n      this.playerInterface_.onCanSwitch();\n    }.bind(this)).catch(Functional.noop);\n  }\n\n  // Now setup all known Periods.\n  for (var i = 0; i < this.manifest_.periods.length; ++i) {\n    this.setupPeriod_(i).catch(Functional.noop);\n  }\n\n  if (this.playerInterface_.onStartupComplete) {\n    shaka.log.v1(logPrefix, 'calling onStartupComplete()...');\n    this.playerInterface_.onStartupComplete();\n  }\n};\n\n\n/**\n * Calls onChooseStreams() when necessary.\n *\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState The last\n *   MediaState updated.\n * @private\n */\nshaka.media.StreamingEngine.prototype.handlePeriodTransition_ = function(\n    mediaState) {\n  var Functional = shaka.util.Functional;\n  var MapUtils = shaka.util.MapUtils;\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  var currentPeriodIndex = this.findPeriodContainingStream_(mediaState.stream);\n  if (mediaState.needPeriodIndex == currentPeriodIndex)\n    return;\n\n  var needPeriodIndex = mediaState.needPeriodIndex;\n\n  goog.asserts.assert(this.mediaStates_, 'must not be destroyed');\n  var mediaStates = MapUtils.values(this.mediaStates_);\n\n  // For a Period transition to work, all media states must need the same\n  // Period.  If a stream needs a different Period than the one it currently\n  // has, it will try to transition or stop updates assuming that another stream\n  // will handle it.  This only works when all streams either need the same\n  // Period or are still performing updates.\n  goog.asserts.assert(\n      mediaStates.every(function(ms) {\n        return ms.needPeriodIndex == needPeriodIndex || ms.hasError ||\n            !shaka.media.StreamingEngine.isIdle_(ms);\n      }),\n      'All MediaStates should need the same Period or be performing updates.');\n\n  // Only call onChooseStreams() when all MediaStates need the same Period.\n  var needSamePeriod = mediaStates.every(function(ms) {\n    return ms.needPeriodIndex == needPeriodIndex;\n  });\n  if (!needSamePeriod) {\n    shaka.log.debug(\n        logPrefix, 'not all MediaStates need Period ' + needPeriodIndex);\n    return;\n  }\n\n  // Only call onChooseStreams() once per Period transition.\n  var allAreIdle = mediaStates.every(shaka.media.StreamingEngine.isIdle_);\n  if (!allAreIdle) {\n    shaka.log.debug(\n        logPrefix,\n        'all MediaStates need Period ' + needPeriodIndex + ', ' +\n        'but not all MediaStates are idle');\n    return;\n  }\n\n  shaka.log.debug(logPrefix, 'all need Period ' + needPeriodIndex);\n\n  // Ensure the Period which we need to buffer is setup and then call\n  // onChooseStreams().\n  this.setupPeriod_(needPeriodIndex).then(function() {\n    if (this.destroyed_) return;\n\n    // If we seek during a Period transition, we can start another transition.\n    // So we need to verify that:\n    // - We are still in need of the same Period.\n    // - All streams are still idle.\n    // - The current stream is not in the needed Period (another transition\n    //   handled it).\n    var allReady = mediaStates.every(function(ms) {\n      var isIdle = shaka.media.StreamingEngine.isIdle_(ms);\n      var currentPeriodIndex = this.findPeriodContainingStream_(ms.stream);\n      return isIdle && ms.needPeriodIndex == needPeriodIndex &&\n          currentPeriodIndex != needPeriodIndex;\n    }.bind(this));\n    if (!allReady) {\n      // TODO: Write unit tests for this case.\n      shaka.log.debug(logPrefix, 'ignoring transition to Period',\n                      needPeriodIndex, 'since another is happening');\n      return;\n    }\n\n    var needPeriod = this.manifest_.periods[needPeriodIndex];\n\n    shaka.log.v1(logPrefix, 'calling onChooseStreams()...');\n    var streamsByType = this.playerInterface_.onChooseStreams(needPeriod);\n\n    // Vet |streamsByType| before switching.\n    for (var type in this.mediaStates_) {\n      if (streamsByType[type] || type == ContentType.TEXT) continue;\n\n      shaka.log.error(logPrefix,\n                      'invalid Streams chosen: missing ' + type + ' Stream');\n      this.playerInterface_.onError(new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.STREAMING,\n          shaka.util.Error.Code.INVALID_STREAMS_CHOSEN));\n      return;\n    }\n\n    for (var type in streamsByType) {\n      if (this.mediaStates_[type]) continue;\n      if (type == ContentType.TEXT) {\n        // initStreams_ will switch streams and schedule an update.\n        this.initStreams_(\n            {text: streamsByType[ContentType.TEXT]}, needPeriod.startTime);\n        delete streamsByType[type];\n        continue;\n      }\n\n      shaka.log.error(logPrefix,\n                      'invalid Streams chosen: unusable ' + type + ' Stream');\n      this.playerInterface_.onError(new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.STREAMING,\n          shaka.util.Error.Code.INVALID_STREAMS_CHOSEN));\n      return;\n    }\n\n    for (var type in this.mediaStates_) {\n      var stream = streamsByType[type];\n      if (stream) {\n        this.switch(type, stream, /* clearBuffer */ false);\n        this.scheduleUpdate_(this.mediaStates_[type], 0);\n      } else {\n        goog.asserts.assert(type == ContentType.TEXT, 'Invalid streams chosen');\n        delete this.mediaStates_[type];\n      }\n    }\n\n    // We've already set up the Period so call onCanSwitch() right now.\n    shaka.log.v1(logPrefix, 'calling onCanSwitch()...');\n    this.playerInterface_.onCanSwitch();\n  }.bind(this)).catch(Functional.noop);\n};\n\n\n/**\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @return {boolean} True if the given MediaState is idle; otherwise, return\n *   false.\n * @private\n */\nshaka.media.StreamingEngine.isIdle_ = function(mediaState) {\n  return !mediaState.performingUpdate &&\n         (mediaState.updateTimer == null) &&\n         !mediaState.waitingToClearBuffer &&\n         !mediaState.clearingBuffer;\n};\n\n\n/**\n * @param {number} time The time, in seconds, relative to the start of the\n *   presentation.\n * @return {number} The index of the Period which starts after |time|\n * @private\n */\nshaka.media.StreamingEngine.prototype.findPeriodContainingTime_ = function(\n    time) {\n  goog.asserts.assert(this.manifest_, 'Must not be destroyed');\n  return shaka.util.StreamUtils.findPeriodContainingTime(this.manifest_, time);\n};\n\n\n/**\n * @param {!shakaExtern.Stream} stream\n * @return {number} The index of the Period which contains |stream|, or -1 if\n *   no Period contains |stream|.\n * @private\n */\nshaka.media.StreamingEngine.prototype.findPeriodContainingStream_ = function(\n    stream) {\n  goog.asserts.assert(this.manifest_, 'Must not be destroyed');\n  return shaka.util.StreamUtils.findPeriodContainingStream(\n      this.manifest_, stream);\n};\n\n\n/**\n * Fetches the given segment.\n *\n * @param {(!shaka.media.InitSegmentReference|!shaka.media.SegmentReference)}\n *   reference\n *\n * @return {!Promise.<!ArrayBuffer>}\n * @private\n */\nshaka.media.StreamingEngine.prototype.fetch_ = function(reference) {\n  var requestType = shaka.net.NetworkingEngine.RequestType.SEGMENT;\n  var request = shaka.net.NetworkingEngine.makeRequest(\n      reference.getUris(), this.config_.retryParameters);\n\n  // Set Range header. Note that some web servers don't accept Range headers,\n  // so don't set one if it's not strictly required.\n  if ((reference.startByte != 0) || (reference.endByte != null)) {\n    var range = 'bytes=' + reference.startByte + '-';\n    if (reference.endByte != null) range += reference.endByte;\n    request.headers['Range'] = range;\n  }\n\n  shaka.log.v2('fetching: reference=' + reference);\n  var p = this.playerInterface_.netEngine.request(requestType, request);\n  return p.then(function(response) {\n    return response.data;\n  });\n};\n\n\n/**\n * Clears the buffer and schedules another update.\n *\n * @param {!shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {boolean} flush\n * @private\n */\nshaka.media.StreamingEngine.prototype.clearBuffer_ =\n    function(mediaState, flush) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n\n  goog.asserts.assert(\n      !mediaState.performingUpdate && (mediaState.updateTimer == null),\n      logPrefix + ' unexpected call to clearBuffer_()');\n\n  mediaState.waitingToClearBuffer = false;\n  mediaState.waitingToFlushBuffer = false;\n  mediaState.clearingBuffer = true;\n\n  shaka.log.debug(logPrefix, 'clearing buffer');\n  var p = this.playerInterface_.mediaSourceEngine.clear(mediaState.type);\n  p.then(function() {\n    if (!this.destroyed_ && flush) {\n      return this.playerInterface_.mediaSourceEngine.flush(mediaState.type);\n    }\n  }.bind(this)).then(function() {\n    if (this.destroyed_) return;\n    shaka.log.debug(logPrefix, 'cleared buffer');\n    mediaState.lastStream = null;\n    mediaState.lastSegmentReference = null;\n    mediaState.clearingBuffer = false;\n    mediaState.endOfStream = false;\n    this.scheduleUpdate_(mediaState, 0);\n  }.bind(this));\n};\n\n\n/**\n * Schedules |mediaState|'s next update.\n *\n * @param {!shaka.media.StreamingEngine.MediaState_} mediaState\n * @param {number} delay The delay in seconds.\n * @private\n */\nshaka.media.StreamingEngine.prototype.scheduleUpdate_ = function(\n    mediaState, delay) {\n  var logPrefix = shaka.media.StreamingEngine.logPrefix_(mediaState);\n  shaka.log.v2(logPrefix, 'updating in ' + delay + ' seconds');\n  goog.asserts.assert(mediaState.updateTimer == null,\n                      logPrefix + ' did not expect update to be scheduled');\n  mediaState.updateTimer = window.setTimeout(\n      this.onUpdate_.bind(this, mediaState), delay * 1000);\n};\n\n\n/**\n * Cancels |mediaState|'s next update if one exists.\n *\n * @param {!shaka.media.StreamingEngine.MediaState_} mediaState\n * @private\n */\nshaka.media.StreamingEngine.prototype.cancelUpdate_ = function(mediaState) {\n  if (mediaState.updateTimer != null) {\n    window.clearTimeout(mediaState.updateTimer);\n    mediaState.updateTimer = null;\n  }\n};\n\n\n/**\n * @param {shaka.media.StreamingEngine.MediaState_} mediaState\n * @return {string} A log prefix of the form ($CONTENT_TYPE:$STREAM_ID), e.g.,\n *   \"(audio:5)\" or \"(video:hd)\".\n * @private\n */\nshaka.media.StreamingEngine.logPrefix_ = function(mediaState) {\n  return '(' + mediaState.type + ':' + mediaState.stream.id + ')';\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/media/streaming_engine.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.net.HttpPlugin');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.StringUtils');\n\n\n/**\n * @namespace\n * @summary A networking plugin to handle http and https URIs via XHR.\n * @param {string} uri\n * @param {shakaExtern.Request} request\n * @return {!Promise.<shakaExtern.Response>}\n * @export\n */\nshaka.net.HttpPlugin = function(uri, request) {\n  return new Promise(function(resolve, reject) {\n    var xhr = new XMLHttpRequest();\n\n    xhr.open(request.method, uri, true);\n    xhr.responseType = 'arraybuffer';\n    xhr.timeout = request.retryParameters.timeout;\n    xhr.withCredentials = request.allowCrossSiteCredentials;\n\n    xhr.onload = function(event) {\n      var target = event.target;\n      goog.asserts.assert(target, 'XHR onload has no target!');\n\n      var headers = target.getAllResponseHeaders().split('\\r\\n').reduce(\n          function(all, part) {\n            var header = part.split(': ');\n            all[header[0].toLowerCase()] = header.slice(1).join(': ');\n            return all;\n          },\n          {});\n      if (target.status >= 200 && target.status <= 299 &&\n          target.status != 202) {\n        // Most 2xx HTTP codes are success cases.\n        if (target.responseURL) {\n          uri = target.responseURL;\n        }\n        /** @type {shakaExtern.Response} */\n        var response = {\n          uri: uri,\n          data: target.response,\n          headers: headers,\n          fromCache: !!headers['x-shaka-from-cache']\n        };\n        resolve(response);\n      } else {\n        var responseText = null;\n        try {\n          responseText = shaka.util.StringUtils.fromBytesAutoDetect(\n              target.response);\n        } catch (exception) {}\n        shaka.log.debug('HTTP error text:', responseText);\n\n        var severity = target.status == 401 || target.status == 403 ?\n            shaka.util.Error.Severity.CRITICAL :\n            shaka.util.Error.Severity.RECOVERABLE;\n        reject(new shaka.util.Error(\n            severity,\n            shaka.util.Error.Category.NETWORK,\n            shaka.util.Error.Code.BAD_HTTP_STATUS,\n            uri,\n            target.status,\n            responseText,\n            headers));\n      }\n    };\n    xhr.onerror = function(event) {\n      reject(new shaka.util.Error(\n          shaka.util.Error.Severity.RECOVERABLE,\n          shaka.util.Error.Category.NETWORK,\n          shaka.util.Error.Code.HTTP_ERROR,\n          uri));\n    };\n    xhr.ontimeout = function(event) {\n      reject(new shaka.util.Error(\n          shaka.util.Error.Severity.RECOVERABLE,\n          shaka.util.Error.Category.NETWORK,\n          shaka.util.Error.Code.TIMEOUT,\n          uri));\n    };\n\n    for (var k in request.headers) {\n      xhr.setRequestHeader(k, request.headers[k]);\n    }\n    xhr.send(request.body);\n  });\n};\n\n\nshaka.net.NetworkingEngine.registerScheme('http', shaka.net.HttpPlugin);\nshaka.net.NetworkingEngine.registerScheme('https', shaka.net.HttpPlugin);\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/net/http_plugin.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.offline.DBEngine');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.offline.IStorageEngine');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.PublicPromise');\n\n\n\n/**\n * This manages all operations on an IndexedDB.  This wraps all operations\n * in Promises.  All Promises will resolve once the transaction has completed.\n * Depending on the browser, this may or may not be after the data is flushed\n * to disk.  https://goo.gl/zMOeJc\n *\n * @struct\n * @constructor\n * @implements {shaka.offline.IStorageEngine}\n */\nshaka.offline.DBEngine = function() {\n  goog.asserts.assert(\n      shaka.offline.DBEngine.isSupported(),\n      'DBEngine should not be called when DBEngine is not supported');\n\n  /** @private {IDBDatabase} */\n  this.db_ = null;\n\n  /** @private {!Array.<shaka.offline.DBEngine.Operation>} */\n  this.operations_ = [];\n\n  /** @private {!Object.<string, number>} */\n  this.currentIdMap_ = {};\n};\n\n\n/**\n * @typedef {{\n *   transaction: !IDBTransaction,\n *   promise: !shaka.util.PublicPromise\n * }}\n *\n * @property {!IDBTransaction} transaction\n *   The transaction that this operation is using.\n * @property {!shaka.util.PublicPromise} promise\n *   The promise associated with the operation.\n */\nshaka.offline.DBEngine.Operation;\n\n\n/** @private {string} */\nshaka.offline.DBEngine.DB_NAME_ = 'shaka_offline_db';\n\n\n/** @private @const {number} */\nshaka.offline.DBEngine.DB_VERSION_ = 1;\n\n\n/**\n * Determines if the browsers supports IndexedDB.\n * @return {boolean}\n */\nshaka.offline.DBEngine.isSupported = function() {\n  return window.indexedDB != null;\n};\n\n\n/**\n * Delete the database.  There must be no open connections to the database.\n * @return {!Promise}\n */\nshaka.offline.DBEngine.deleteDatabase = function() {\n  if (!window.indexedDB)\n    return Promise.resolve();\n  var request =\n      window.indexedDB.deleteDatabase(shaka.offline.DBEngine.DB_NAME_);\n\n  var p = new shaka.util.PublicPromise();\n  request.onsuccess = function(event) {\n    goog.asserts.assert(event.newVersion == null, 'Unexpected database update');\n    p.resolve();\n  };\n  request.onerror = shaka.offline.DBEngine.onError_.bind(null, request, p);\n  return p;\n};\n\n\n/** @override */\nshaka.offline.DBEngine.prototype.initialized = function() {\n  return this.db_ != null;\n};\n\n\n/** @override */\nshaka.offline.DBEngine.prototype.init = function(storeMap, opt_retryCount) {\n  goog.asserts.assert(!this.db_, 'Already initialized');\n\n  return this.createConnection_(storeMap, opt_retryCount).then(function() {\n    // For each store, get the next ID and store in the map.\n    var stores = Object.keys(storeMap);\n    return Promise.all(stores.map(function(store) {\n      return this.getNextId_(store).then(function(id) {\n        this.currentIdMap_[store] = id;\n      }.bind(this));\n    }.bind(this)));\n  }.bind(this));\n};\n\n\n/** @override */\nshaka.offline.DBEngine.prototype.destroy = function() {\n  return Promise.all(this.operations_.map(function(op) {\n    try {\n      // If the transaction is considered finished but has not called the\n      // callbacks yet, it will still be in the list and this call will fail.\n      // Simply ignore errors.\n      op.transaction.abort();\n    } catch (e) {}\n\n    var Functional = shaka.util.Functional;\n    return op.promise.catch(Functional.noop);\n  })).then(function() {\n    goog.asserts.assert(this.operations_.length == 0,\n                        'All operations should have been closed');\n    if (this.db_) {\n      this.db_.close();\n      this.db_ = null;\n    }\n  }.bind(this));\n};\n\n\n/** @override */\nshaka.offline.DBEngine.prototype.get = function(storeName, key) {\n  var request;\n  return this.createTransaction_(storeName, 'readonly', function(store) {\n    request = store.get(key);\n  }).then(function() { return request.result; });\n};\n\n\n/** @override */\nshaka.offline.DBEngine.prototype.forEach = function(storeName, callback) {\n  return this.createTransaction_(storeName, 'readonly', function(store) {\n    var request = store.openCursor();\n    request.onsuccess = function(event) {\n      var cursor = event.target.result;\n      if (cursor) {\n        callback(cursor.value);\n        cursor.continue();\n      }\n    };\n  });\n};\n\n\n/** @override */\nshaka.offline.DBEngine.prototype.insert = function(storeName, value) {\n  return this.createTransaction_(storeName, 'readwrite', function(store) {\n    store.put(value);\n  });\n};\n\n\n/** @override */\nshaka.offline.DBEngine.prototype.remove = function(storeName, key) {\n  return this.createTransaction_(storeName, 'readwrite', function(store) {\n    store.delete(key);\n  });\n};\n\n\n/** @override */\nshaka.offline.DBEngine.prototype.removeKeys = function(storeName,\n                                                       keys,\n                                                       opt_onKeyRemoved) {\n  return this.createTransaction_(storeName, 'readwrite', function(store) {\n    for (var i = 0; i < keys.length; i++) {\n      var request = store.delete(keys[i]);\n      request.onsuccess = opt_onKeyRemoved || function(event) { };\n    }\n  });\n};\n\n\n/** @override */\nshaka.offline.DBEngine.prototype.reserveId = function(storeName) {\n  goog.asserts.assert(storeName in this.currentIdMap_,\n                      'Store name must be passed to init()');\n  return this.currentIdMap_[storeName]++;\n};\n\n\n/**\n * Gets the ID to start at.\n *\n * @param {string} storeName\n * @return {!Promise.<number>}\n * @private\n */\nshaka.offline.DBEngine.prototype.getNextId_ = function(storeName) {\n  var id = 0;\n  return this.createTransaction_(storeName, 'readonly', function(store) {\n    var request = store.openCursor(null, 'prev');\n    request.onsuccess = function(event) {\n      var cursor = event.target.result;\n      if (cursor) {\n        id = cursor.key + 1;\n      }\n    };\n  }).then(function() { return id; });\n};\n\n\n/**\n * Creates a new transaction for the given store name and calls |action| to\n * modify the store. The transaction will resolve or reject the promise\n * returned by this function.\n *\n * @param {string} storeName\n * @param {string} type\n * @param {!function(IDBObjectStore)} action\n *\n * @return {!Promise}\n * @private\n */\nshaka.offline.DBEngine.prototype.createTransaction_ = function(storeName,\n                                                               type,\n                                                               action) {\n\n  goog.asserts.assert(this.db_, 'Must not be destroyed');\n  goog.asserts.assert(type == 'readonly' || type == 'readwrite',\n                      'Type must be \"readonly\" or \"readwrite\"');\n\n  var op = {\n    transaction: this.db_.transaction([storeName], type),\n    promise: new shaka.util.PublicPromise()\n  };\n\n  op.transaction.oncomplete = (function(event) {\n    this.closeOperation_(op);\n    op.promise.resolve();\n  }.bind(this));\n\n  // We will see an onabort call via:\n  //   1. request error -> transaction error -> transaction abort\n  //   2. transaction commit fail -> transaction abort\n  // As any transaction error will result in an abort, it is better to listen\n  // for an abort so that we will catch all failed transaction operations.\n  op.transaction.onabort = (function(event) {\n    this.closeOperation_(op);\n    shaka.offline.DBEngine.onError_(op.transaction, op.promise, event);\n  }.bind(this));\n\n  // We need to prevent default on the onerror event or else Firefox will\n  // raise an error which will cause a karma failure. This will not stop the\n  // onabort callback from firing.\n  op.transaction.onerror = (function(event) {\n    event.preventDefault();\n  }.bind(this));\n\n  var store = op.transaction.objectStore(storeName);\n  action(store);\n\n  this.operations_.push(op);\n\n  return op.promise;\n};\n\n\n/**\n * Close an open operation.\n *\n * @param {!shaka.offline.DBEngine.Operation} op\n * @private\n */\nshaka.offline.DBEngine.prototype.closeOperation_ = function(op) {\n  var i = this.operations_.indexOf(op);\n  goog.asserts.assert(i >= 0, 'Operation must be in the list.');\n  this.operations_.splice(i, 1);\n};\n\n\n/**\n * Creates a new connection to the database.\n *\n * On IE/Edge, it is possible for the database to not be deleted when the\n * success callback is fired.  This means that when we delete the database and\n * immediately create a new connection, we will connect to the old database.\n * If this happens, we need to close the connection and retry.\n *\n * @see https://goo.gl/hOYJvN\n *\n * @param {!Object.<string, string>} storeMap\n * @param {number=} opt_retryCount\n * @return {!Promise}\n * @private\n */\nshaka.offline.DBEngine.prototype.createConnection_ = function(\n    storeMap, opt_retryCount) {\n  var DBEngine = shaka.offline.DBEngine;\n\n  var indexedDB = window.indexedDB;\n  var request = indexedDB.open(DBEngine.DB_NAME_, DBEngine.DB_VERSION_);\n\n  var upgraded = false;\n  var createPromise = new shaka.util.PublicPromise();\n  request.onupgradeneeded = function(event) {\n    upgraded = true;\n    var db = event.target.result;\n    goog.asserts.assert(event.oldVersion == 0,\n                        'Must be upgrading from version 0');\n    goog.asserts.assert(db.objectStoreNames.length == 0,\n                        'Version 0 database should be empty');\n    for (var name in storeMap) {\n      db.createObjectStore(name, {keyPath: storeMap[name]});\n    }\n  };\n  request.onsuccess = (function(event) {\n    if (opt_retryCount && !upgraded) {\n      event.target.result.close();\n\n      shaka.log.info('Didn\\'t get an upgrade event... trying again.');\n      setTimeout(function() {\n        var p = this.createConnection_(storeMap, opt_retryCount - 1);\n        p.then(createPromise.resolve, createPromise.reject);\n      }.bind(this), 1000);\n      return;\n    }\n\n\n    goog.asserts.assert(opt_retryCount == undefined || upgraded,\n                        'Should get upgrade event');\n    this.db_ = event.target.result;\n    createPromise.resolve();\n  }.bind(this));\n  request.onerror = DBEngine.onError_.bind(null, request, createPromise);\n\n  return createPromise;\n};\n\n\n/**\n * Rejects the given Promise using the error fromt the transaction.\n *\n * @param {!IDBTransaction|!IDBRequest} errorSource\n * @param {!shaka.util.PublicPromise} promise\n * @param {Event} event\n * @private\n */\nshaka.offline.DBEngine.onError_ = function(errorSource, promise, event) {\n\n  if (errorSource.error) {\n    promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.STORAGE,\n        shaka.util.Error.Code.INDEXED_DB_ERROR, errorSource.error));\n  } else {\n    promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.STORAGE,\n        shaka.util.Error.Code.OPERATION_ABORTED));\n  }\n\n  // Firefox will raise an error which will cause a karma failure.\n  event.preventDefault();\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/offline/db_engine.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.offline.DownloadManager');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.offline.OfflineUtils');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.MapUtils');\n\n\n\n/**\n * This manages downloading segments and notifying the app of progress.\n *\n * @param {shaka.offline.IStorageEngine} storageEngine\n * @param {!shaka.net.NetworkingEngine} netEngine\n * @param {shakaExtern.RetryParameters} retryParams\n * @param {shakaExtern.OfflineConfiguration} config\n *\n * @struct\n * @constructor\n * @implements {shaka.util.IDestroyable}\n */\nshaka.offline.DownloadManager = function(\n    storageEngine, netEngine, retryParams, config) {\n  /**\n   * @private {!Object.<\n   *     string, !Array.<shaka.offline.DownloadManager.Segment>>}\n   */\n  this.segments_ = {};\n\n  /**\n   * The IDs of the segments that have been stored for an in-progress\n   * download().  This is used to cleanup in destroy().\n   * @private {!Array.<number>}\n   */\n  this.storedSegments_ = [];\n\n  /** @private {?shakaExtern.OfflineConfiguration} */\n  this.config_ = config;\n\n  /** @private {shaka.offline.IStorageEngine} */\n  this.storageEngine_ = storageEngine;\n\n  /** @private {shaka.net.NetworkingEngine} */\n  this.netEngine_ = netEngine;\n\n  /** @private {?shakaExtern.RetryParameters} */\n  this.retryParams_ = retryParams;\n\n  /** @private {?shakaExtern.ManifestDB} */\n  this.manifest_ = null;\n\n  /** @private {Promise} */\n  this.promise_ = null;\n\n  /**\n   * The total number of bytes for segments that include a byte range.\n   * @private {number}\n   */\n  this.givenBytesTotal_ = 0;\n\n  /**\n   * The number of bytes downloaded for segments that include a byte range.\n   * @private {number}\n   */\n  this.givenBytesDownloaded_ = 0;\n\n  /**\n   * The total number of bytes estimated based on bandwidth for segments that\n   * do not include a byte range.\n   * @private {number}\n   */\n  this.bandwidthBytesTotal_ = 0;\n\n  /**\n   * The estimated number of bytes downloaded for segments that do not have\n   * a byte range.\n   * @private {number}\n   */\n  this.bandwidthBytesDownloaded_ = 0;\n};\n\n\n/**\n * @typedef {{\n *   uris: !Array.<string>,\n *   startByte: number,\n *   endByte: ?number,\n *   bandwidthSize: number,\n *   segmentDb: shakaExtern.SegmentDataDB\n * }}\n *\n * @property {!Array.<string>} uris\n *   The URIs to download the segment.\n * @property {number} startByte\n *   The byte index the segment starts at.\n * @property {?number} endByte\n *   The byte index the segment ends at, if present.\n * @property {number} bandwidthSize\n *   The size of the segment as estimated by the bandwidth and segment duration.\n * @property {shakaExtern.SegmentDataDB} segmentDb\n *   The data to store in the database.\n */\nshaka.offline.DownloadManager.Segment;\n\n\n/** @override */\nshaka.offline.DownloadManager.prototype.destroy = function() {\n  var storage = this.storageEngine_;\n  var segments = this.storedSegments_;\n  var p = this.promise_ || Promise.resolve();\n  p = p.then(function() { return storage.removeKeys('segment', segments); });\n\n  // Don't destroy() storageEngine since it is owned by Storage.\n\n  this.segments_ = {};\n  this.storedSegments_ = [];\n  this.config_ = null;\n  this.storageEngine_ = null;\n  this.netEngine_ = null;\n  this.retryParams_ = null;\n  this.manifest_ = null;\n  this.promise_ = null;\n  return p;\n};\n\n\n/**\n * Adds a segment to the list to be downloaded.\n *\n * @param {string} type\n * @param {!shaka.media.SegmentReference|!shaka.media.InitSegmentReference} ref\n * @param {number} bandwidthSize\n * @param {shakaExtern.SegmentDataDB} segmentDb\n *   The data to store in the database with the data.  The |data| field of this\n *   object will contain the downloaded data.\n */\nshaka.offline.DownloadManager.prototype.addSegment = function(\n    type, ref, bandwidthSize, segmentDb) {\n  this.segments_[type] = this.segments_[type] || [];\n  this.segments_[type].push({\n    uris: ref.getUris(),\n    startByte: ref.startByte,\n    endByte: ref.endByte,\n    bandwidthSize: bandwidthSize,\n    segmentDb: segmentDb\n  });\n};\n\n\n/**\n * Downloads all the segments, stores them in the database, and stores the given\n * manifest object.\n *\n * @param {shakaExtern.ManifestDB} manifest\n * @return {!Promise}\n */\nshaka.offline.DownloadManager.prototype.downloadAndStore = function(manifest) {\n  var MapUtils = shaka.util.MapUtils;\n  // Calculate progress estimates.\n  this.givenBytesTotal_ = 0;\n  this.givenBytesDownloaded_ = 0;\n  this.bandwidthBytesTotal_ = 0;\n  this.bandwidthBytesDownloaded_ = 0;\n  MapUtils.values(this.segments_).forEach(function(segments) {\n    segments.forEach(function(segment) {\n      if (segment.endByte != null)\n        this.givenBytesTotal_ += (segment.endByte - segment.startByte + 1);\n      else\n        this.bandwidthBytesTotal_ += segment.bandwidthSize;\n    }.bind(this));\n  }.bind(this));\n\n  this.manifest_ = manifest;\n  // Will be updated as we download for segments without a byte-range.\n  this.manifest_.size = this.givenBytesTotal_;\n\n  // Create separate download chains for different content types.  This will\n  // allow audio and video to be downloaded in parallel.\n  var async = MapUtils.values(this.segments_).map(function(segments) {\n    var i = 0;\n    var downloadNext = (function() {\n      if (!this.config_) {\n        return Promise.reject(new shaka.util.Error(\n            shaka.util.Error.Severity.CRITICAL,\n            shaka.util.Error.Category.STORAGE,\n            shaka.util.Error.Code.OPERATION_ABORTED));\n      }\n      if (i >= segments.length) return Promise.resolve();\n      var segment = segments[i++];\n      return this.downloadSegment_(segment).then(downloadNext);\n    }.bind(this));\n    return downloadNext();\n  }.bind(this));\n  this.segments_ = {};\n\n  this.promise_ = Promise.all(async).then(function() {\n    return this.storageEngine_.insert('manifest', manifest);\n  }.bind(this)).then(function() {\n    this.storedSegments_ = [];\n  }.bind(this));\n  return this.promise_;\n};\n\n\n/**\n * Downloads the given segment and calls the callback.\n *\n * @param {shaka.offline.DownloadManager.Segment} segment\n * @return {!Promise}\n * @private\n */\nshaka.offline.DownloadManager.prototype.downloadSegment_ = function(segment) {\n  goog.asserts.assert(this.retryParams_, 'Must not be destroyed');\n  var type = shaka.net.NetworkingEngine.RequestType.SEGMENT;\n  var request =\n      shaka.net.NetworkingEngine.makeRequest(segment.uris, this.retryParams_);\n  if (segment.startByte != 0 || segment.endByte != null) {\n    var end = segment.endByte == null ? '' : segment.endByte;\n    request.headers['Range'] = 'bytes=' + segment.startByte + '-' + end;\n  }\n\n  var byteCount;\n  return this.netEngine_.request(type, request)\n      .then(function(response) {\n        if (!this.manifest_) {\n          return Promise.reject(new shaka.util.Error(\n              shaka.util.Error.Severity.CRITICAL,\n              shaka.util.Error.Category.STORAGE,\n              shaka.util.Error.Code.OPERATION_ABORTED));\n        }\n        byteCount = response.data.byteLength;\n\n        this.storedSegments_.push(segment.segmentDb.key);\n        segment.segmentDb.data = response.data;\n        return this.storageEngine_.insert('segment', segment.segmentDb);\n      }.bind(this))\n      .then(function() {\n        if (!this.manifest_) {\n          return Promise.reject(new shaka.util.Error(\n              shaka.util.Error.Severity.CRITICAL,\n              shaka.util.Error.Category.STORAGE,\n              shaka.util.Error.Code.OPERATION_ABORTED));\n        }\n        if (segment.endByte == null) {\n          // We didn't know the size, so it was an estimate.\n          this.manifest_.size += byteCount;\n          this.bandwidthBytesDownloaded_ += segment.bandwidthSize;\n        } else {\n          goog.asserts.assert(\n              byteCount == (segment.endByte - segment.startByte + 1),\n              'Incorrect download size');\n          this.givenBytesDownloaded_ += byteCount;\n        }\n        this.updateProgress_();\n      }.bind(this));\n};\n\n\n/**\n * Calls the progress callback.\n * @private\n */\nshaka.offline.DownloadManager.prototype.updateProgress_ = function() {\n  var progress = (this.givenBytesDownloaded_ + this.bandwidthBytesDownloaded_) /\n      (this.givenBytesTotal_ + this.bandwidthBytesTotal_);\n\n  goog.asserts.assert(this.manifest_, 'Must not be destroyed');\n  var manifest = shaka.offline.OfflineUtils.getStoredContent(this.manifest_);\n  this.config_.progressCallback(manifest, progress);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/offline/download_manager.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.offline.OfflineUtils');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.media.InitSegmentReference');\ngoog.require('shaka.media.PresentationTimeline');\ngoog.require('shaka.media.SegmentIndex');\ngoog.require('shaka.media.SegmentReference');\ngoog.require('shaka.offline.DBEngine');\ngoog.require('shaka.offline.IStorageEngine');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.StreamUtils');\n\n\n/** @const {!Object.<string, string>} */\nshaka.offline.OfflineUtils.DB_SCHEME = {'manifest': 'key', 'segment': 'key'};\n\n\n/**\n * Converts the given database manifest to a storedContent structure.\n *\n * @param {shakaExtern.ManifestDB} manifest\n * @return {shakaExtern.StoredContent}\n */\nshaka.offline.OfflineUtils.getStoredContent = function(manifest) {\n  goog.asserts.assert(manifest.periods.length > 0,\n                      'Must be at least one Period.');\n\n  // Reconstruct the first period to get the variants\n  var timeline = new shaka.media.PresentationTimeline(null, 0);\n  var period = shaka.offline.OfflineUtils.reconstructPeriod(\n      manifest.periods[0], [], timeline);\n\n  var tracks = shaka.util.StreamUtils.getVariantTracks(period, null, null);\n  var textTracks = shaka.util.StreamUtils.getTextTracks(period, null);\n\n  tracks.push.apply(tracks, textTracks);\n\n  return {\n    offlineUri: 'offline:' + manifest.key,\n    originalManifestUri: manifest.originalManifestUri,\n    duration: manifest.duration,\n    size: manifest.size,\n    expiration: manifest.expiration == undefined ? Infinity :\n                                                   manifest.expiration,\n    tracks: tracks,\n    appMetadata: manifest.appMetadata\n  };\n};\n\n\n/**\n * Reconstructs a period object from the given database period.\n *\n * @param {shakaExtern.PeriodDB} period\n * @param {!Array.<shakaExtern.DrmInfo>} drmInfos\n * @param {shaka.media.PresentationTimeline} timeline\n * @return {shakaExtern.Period}\n */\nshaka.offline.OfflineUtils.reconstructPeriod = function(\n    period, drmInfos, timeline) {\n  var OfflineUtils = shaka.offline.OfflineUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var textStreamsDb = period.streams.filter(function(streamDb) {\n    return streamDb.contentType == ContentType.TEXT;\n  });\n\n  var audioStreamsDb = period.streams.filter(function(streamDb) {\n    return streamDb.contentType == ContentType.AUDIO;\n  });\n\n  var videoStreamsDb = period.streams.filter(function(streamDb) {\n    return streamDb.contentType == ContentType.VIDEO;\n  });\n\n  var variants =\n      OfflineUtils.createVariants_(audioStreamsDb, videoStreamsDb, drmInfos);\n  var textStreams = textStreamsDb.map(OfflineUtils.createStream_);\n\n  period.streams.forEach(function(streamDb) {\n    var refs = OfflineUtils.getSegmentReferences_(streamDb);\n    timeline.notifySegments(period.startTime, refs);\n  });\n\n  return {\n    startTime: period.startTime,\n    variants: variants,\n    textStreams: textStreams\n  };\n};\n\n\n/**\n * @param {!shakaExtern.StreamDB} streamDb\n * @return {!Array.<!shaka.media.SegmentReference>}\n * @private\n */\nshaka.offline.OfflineUtils.getSegmentReferences_ = function(streamDb) {\n  return streamDb.segments.map(function(segment, i) {\n    var getUris = function() { return [segment.uri]; };\n    return new shaka.media.SegmentReference(\n        i, segment.startTime, segment.endTime, getUris, 0, null);\n  });\n};\n\n\n/**\n * Creates Variants from audio and video StreamDB collections.\n *\n * @param {!Array.<!shakaExtern.StreamDB>} audios\n * @param {!Array.<!shakaExtern.StreamDB>} videos\n * @param {!Array.<!shakaExtern.DrmInfo>} drmInfos\n * @return {!Array.<!shakaExtern.Variant>}\n * @private\n */\nshaka.offline.OfflineUtils.createVariants_ = function(\n    audios, videos, drmInfos) {\n  var variants = [];\n  if (!audios.length && !videos.length) return variants;\n\n  // Create a single null element so the double loop will work for audio-only or\n  // video-only variants.\n  if (!audios.length) {\n    audios = [null];\n  } else if (!videos.length) {\n    videos = [null];\n  }\n\n  var OfflineUtils = shaka.offline.OfflineUtils;\n  var id = 0;\n  for (var i = 0; i < audios.length; i++) {\n    for (var j = 0; j < videos.length; j++) {\n      if (OfflineUtils.areCompatible_(audios[i], videos[j])) {\n        var variant =\n            OfflineUtils.createVariant_(audios[i], videos[j], drmInfos, id++);\n        variants.push(variant);\n      }\n    }\n  }\n\n  return variants;\n};\n\n\n/**\n * Checks if two streams can be combined into a variant.\n *\n * @param {?shakaExtern.StreamDB} stream1\n * @param {?shakaExtern.StreamDB} stream2\n * @return {boolean}\n * @private\n */\nshaka.offline.OfflineUtils.areCompatible_ = function(stream1, stream2) {\n  // Treat content that doesn't have variantIds as compatible\n  // with anything for compatibility with content stored before\n  // the variants were introduced.\n  if (!stream1 || !stream2 || !stream1.variantIds || !stream2.variantIds)\n    return true;\n\n  for (var i = 0; i < stream1.variantIds.length; i++) {\n    var containsId = stream2.variantIds.some(function(id) {\n      return id == stream1.variantIds[i];\n    });\n    if (containsId) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\n\n/**\n * Creates a Variant from an audio and a video StreamDBs.\n * If one of the streams is null, it creates a Variant from the other.\n *\n * @param {?shakaExtern.StreamDB} audio\n * @param {?shakaExtern.StreamDB} video\n * @param {!Array.<!shakaExtern.DrmInfo>} drmInfos\n * @param {number} id\n * @return {!shakaExtern.Variant}\n * @private\n */\nshaka.offline.OfflineUtils.createVariant_ = function(\n    audio, video, drmInfos, id) {\n  return {\n    id: id,\n    language: audio ? audio.language : '',\n    // Use !! to get the compiler to use a boolean type. Otherwise it will\n    // deduce the type as {boolean|shakaExtern.StreamDB} even though |audio|\n    // will only be returned if it is falsy, so the type would be {boolean|null}\n    primary: (!!audio && audio.primary) || (!!video && video.primary),\n    audio: shaka.offline.OfflineUtils.createStream_(audio),\n    video: shaka.offline.OfflineUtils.createStream_(video),\n    bandwidth: 0,\n    drmInfos: drmInfos,\n    allowedByApplication: true,\n    allowedByKeySystem: true\n  };\n};\n\n\n/**\n * Creates a shakaExtern.Stream from a StreamDB.\n *\n * @param {?shakaExtern.StreamDB} streamDb\n * @return {?shakaExtern.Stream}\n * @private\n */\nshaka.offline.OfflineUtils.createStream_ = function(streamDb) {\n  if (!streamDb) return null;\n\n  var refs =\n      shaka.offline.OfflineUtils.getSegmentReferences_(streamDb);\n\n  var segmentIndex = new shaka.media.SegmentIndex(refs);\n\n  var initRef = streamDb.initSegmentUri ?\n      new shaka.media.InitSegmentReference(\n          function() { return [streamDb.initSegmentUri]; }, 0, null) :\n      null;\n  return {\n    id: streamDb.id,\n    createSegmentIndex: Promise.resolve.bind(Promise),\n    findSegmentPosition: segmentIndex.find.bind(segmentIndex),\n    getSegmentReference: segmentIndex.get.bind(segmentIndex),\n    initSegmentReference: initRef,\n    presentationTimeOffset: streamDb.presentationTimeOffset,\n    mimeType: streamDb.mimeType,\n    codecs: streamDb.codecs,\n    width: streamDb.width || undefined,\n    height: streamDb.height || undefined,\n    frameRate: streamDb.frameRate || undefined,\n    kind: streamDb.kind,\n    encrypted: streamDb.encrypted,\n    keyId: streamDb.keyId,\n    language: streamDb.language,\n    label: streamDb.label || null,\n    type: streamDb.contentType,\n    primary: streamDb.primary,\n    trickModeVideo: null,\n    // TODO(modmaker): Store offline?\n    containsEmsgBoxes: false,\n    roles: []\n  };\n};\n\n\n/**\n * Determines if this platform supports any form of storage engine.\n * @return {boolean}\n */\nshaka.offline.OfflineUtils.isStorageEngineSupported = function() {\n  return shaka.offline.DBEngine.isSupported();\n};\n\n\n/**\n * Create a new instance of the supported storage engine. The created instance\n * will be uninitialized. If this platform does not support any storage\n * engines, this function will return null.\n * @return {shaka.offline.IStorageEngine}\n */\nshaka.offline.OfflineUtils.createStorageEngine = function() {\n  return shaka.offline.DBEngine.isSupported() ?\n      new shaka.offline.DBEngine() :\n      null;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/offline/offline_utils.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.offline.OfflineManifestParser');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.media.ManifestParser');\ngoog.require('shaka.media.PresentationTimeline');\ngoog.require('shaka.offline.OfflineUtils');\ngoog.require('shaka.util.Error');\n\n\n\n/**\n * Creates a new offline manifest parser.\n * @struct\n * @constructor\n * @implements {shakaExtern.ManifestParser}\n */\nshaka.offline.OfflineManifestParser = function() {\n  /** @private {number} */\n  this.manifestId_ = -1;\n};\n\n\n/** @override */\nshaka.offline.OfflineManifestParser.prototype.configure = function(config) {\n  // No-op\n};\n\n\n/** @override */\nshaka.offline.OfflineManifestParser.prototype.start =\n    function(uri, playerInterface) {\n  var parts = /^offline:([0-9]+)$/.exec(uri);\n  if (!parts) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.NETWORK,\n        shaka.util.Error.Code.MALFORMED_OFFLINE_URI, uri));\n  }\n  var manifestId = Number(parts[1]);\n  var storageEngine = shaka.offline.OfflineUtils.createStorageEngine();\n  this.manifestId_ = manifestId;\n\n  if (!storageEngine) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.STORAGE,\n        shaka.util.Error.Code.STORAGE_NOT_SUPPORTED));\n  }\n\n  return storageEngine.init(shaka.offline.OfflineUtils.DB_SCHEME)\n      .then(function() { return storageEngine.get('manifest', manifestId); })\n      .then(function(manifest) {\n        if (!manifest) {\n          throw new shaka.util.Error(\n              shaka.util.Error.Severity.CRITICAL,\n              shaka.util.Error.Category.STORAGE,\n              shaka.util.Error.Code.REQUESTED_ITEM_NOT_FOUND, manifestId);\n        }\n\n        var OfflineManifestParser = shaka.offline.OfflineManifestParser;\n        return OfflineManifestParser.reconstructManifest(manifest);\n      })\n      .then(\n          function(ret) {\n            return storageEngine.destroy().then(function() { return ret; });\n          },\n          function(err) {\n            return storageEngine.destroy().then(function() { throw err; });\n          });\n};\n\n\n/** @override */\nshaka.offline.OfflineManifestParser.prototype.stop = function() {\n  return Promise.resolve();\n};\n\n\n/** @override */\nshaka.offline.OfflineManifestParser.prototype.update = function() {\n  // No-op\n};\n\n\n/** @override */\nshaka.offline.OfflineManifestParser.prototype.onExpirationUpdated = function(\n    sessionId, expiration) {\n  var storageEngine = shaka.offline.OfflineUtils.createStorageEngine();\n  goog.asserts.assert(storageEngine, 'Must support offline storage');\n\n  storageEngine.init(shaka.offline.OfflineUtils.DB_SCHEME)\n      .then(function() {\n        return storageEngine.get('manifest', this.manifestId_);\n      }.bind(this))\n      .then(function(manifest) {\n        if (!manifest) {\n          // Manifest was deleted, ignore update.\n          return;\n        }\n        if (manifest.sessionIds.indexOf(sessionId) < 0) {\n          shaka.log.debug('Ignoring updated expiration for unknown session');\n          return;\n        }\n\n        if (manifest.expiration == undefined ||\n            manifest.expiration > expiration) {\n          shaka.log.debug('Updating expiration for stored content');\n          manifest.expiration = expiration;\n          return storageEngine.insert('manifest', manifest);\n        }\n      })\n      .catch(function(error) {\n        shaka.log.error('Error updating offline manifest expiration', error);\n      })\n      .then(function() {\n        return storageEngine.destroy();\n      });\n};\n\n\n/**\n * Reconstructs a manifest object from the given database manifest.\n *\n * @param {shakaExtern.ManifestDB} manifest\n * @return {shakaExtern.Manifest}\n */\nshaka.offline.OfflineManifestParser.reconstructManifest = function(manifest) {\n  var timeline = new shaka.media.PresentationTimeline(null, 0);\n  timeline.setDuration(manifest.duration);\n  var drmInfos = manifest.drmInfo ? [manifest.drmInfo] : [];\n  return {\n    presentationTimeline: timeline,\n    minBufferTime: 10,\n    offlineSessionIds: manifest.sessionIds,\n    periods: manifest.periods.map(function(period) {\n      return shaka.offline.OfflineUtils.reconstructPeriod(period,\n                                                          drmInfos,\n                                                          timeline);\n    })\n  };\n};\n\n\nshaka.media.ManifestParser.registerParserByMime(\n    'application/x-offline-manifest', shaka.offline.OfflineManifestParser);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/offline/offline_manifest_parser.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.offline.OfflineScheme');\n\ngoog.require('shaka.net.NetworkingEngine');\ngoog.require('shaka.offline.OfflineUtils');\ngoog.require('shaka.util.Error');\n\n\n/**\n * @namespace\n * @summary A plugin that handles requests for offline content.\n * @param {string} uri\n * @param {shakaExtern.Request} request\n * @return {!Promise.<shakaExtern.Response>}\n * @export\n */\nshaka.offline.OfflineScheme = function(uri, request) {\n  var manifestParts = /^offline:([0-9]+)$/.exec(uri);\n  if (manifestParts) {\n    /** @type {shakaExtern.Response} */\n    var response = {\n      uri: uri,\n      data: new ArrayBuffer(0),\n      headers: {'content-type': 'application/x-offline-manifest'}\n    };\n    return Promise.resolve(response);\n  }\n\n  var segmentParts = /^offline:[0-9]+\\/[0-9]+\\/([0-9]+)$/.exec(uri);\n  if (segmentParts) {\n    var segmentId = Number(segmentParts[1]);\n    var scheme = shaka.offline.OfflineUtils.DB_SCHEME;\n    var storageEngine = shaka.offline.OfflineUtils.createStorageEngine();\n\n    if (!storageEngine) {\n      return Promise.reject(new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL,\n          shaka.util.Error.Category.STORAGE,\n          shaka.util.Error.Code.STORAGE_NOT_SUPPORTED));\n    }\n\n    return storageEngine.init(scheme)\n        .then(function() { return storageEngine.get('segment', segmentId); })\n        .then(function(segment) {\n          return storageEngine.destroy().then(function() {\n            if (!segment) {\n              throw new shaka.util.Error(\n                  shaka.util.Error.Severity.CRITICAL,\n                  shaka.util.Error.Category.STORAGE,\n                  shaka.util.Error.Code.REQUESTED_ITEM_NOT_FOUND, segmentId);\n            }\n            return {uri: uri, data: segment.data, headers: {}};\n          });\n        });\n  }\n\n  return Promise.reject(new shaka.util.Error(\n      shaka.util.Error.Severity.CRITICAL,\n      shaka.util.Error.Category.NETWORK,\n      shaka.util.Error.Code.MALFORMED_OFFLINE_URI, uri));\n};\n\n\nshaka.net.NetworkingEngine.registerScheme(\n    'offline', shaka.offline.OfflineScheme);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/offline/offline_scheme.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.CancelableChain');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.util.Error');\n\n\n\n/**\n * A Promise-based abstraction that creates cancelable Promise chains.\n * When canceled, subsequent stages of the internal Promise chain will stop.\n * A canceled chain is rejected with a user-specified value.\n *\n * A CancelableChain only supports linear Promise chains.  Chains which branch\n * (more than one then() handler chained to a particular stage) are not\n * supported.  You will not be prevented from treating this as if branching\n * were supported, but everything will be serialized into a linear chain.\n * Be careful!\n *\n * @constructor\n * @struct\n */\nshaka.util.CancelableChain = function() {\n  /** @private {!Promise} */\n  this.promise_ = Promise.resolve();\n\n  /** @private {boolean} */\n  this.final_ = false;\n\n  /** @private {boolean} */\n  this.complete_ = false;\n\n  /** @private {boolean} */\n  this.canceled_ = false;\n\n  /** @private {shaka.util.Error} */\n  this.rejectionValue_;\n\n  /** @private {function()} */\n  this.onCancelComplete_;\n\n  /** @private {!Promise} */\n  this.cancelPromise_ = new Promise(function(resolve) {\n    this.onCancelComplete_ = resolve;\n  }.bind(this));\n};\n\n\n/**\n * @param {function(*)} callback\n * @return {!shaka.util.CancelableChain} the chain itself.\n */\nshaka.util.CancelableChain.prototype.then = function(callback) {\n  goog.asserts.assert(!this.final_, 'Chain should not be final!');\n\n  this.promise_ = this.promise_.then(callback).then(function(data) {\n    if (this.canceled_) {\n      this.onCancelComplete_();\n      return Promise.reject(this.rejectionValue_);\n    }\n    return Promise.resolve(data);\n  }.bind(this));\n  return this;\n};\n\n\n/**\n * Finalize the chain.\n * Converts the chain into a simple Promise and stops accepting new stages.\n *\n * @return {!Promise}\n */\nshaka.util.CancelableChain.prototype.finalize = function() {\n  if (!this.final_) {\n    this.promise_ = this.promise_.then(function(data) {\n      this.complete_ = true;\n      return Promise.resolve(data);\n    }.bind(this), function(error) {\n      this.complete_ = true;\n      if (this.canceled_) {\n        this.onCancelComplete_();\n        return Promise.reject(this.rejectionValue_);\n      }\n\n      return Promise.reject(error);\n    }.bind(this));\n  }\n  this.final_ = true;\n  return this.promise_;\n};\n\n\n/**\n * Cancel the Promise chain and reject with the given value.\n *\n * @param {!shaka.util.Error} reason\n * @return {!Promise} resolved when the cancelation has been processed by the\n *   the chain and no more stages will execute.  Note that this may be before\n *   the owner of the finalized chain has seen the rejection.\n */\nshaka.util.CancelableChain.prototype.cancel = function(reason) {\n  if (this.complete_) return Promise.resolve();\n\n  this.canceled_ = true;\n  this.rejectionValue_ = reason;\n  return this.cancelPromise_;\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/cancelable_chain.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.offline.Storage');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.Player');\ngoog.require('shaka.log');\ngoog.require('shaka.media.DrmEngine');\ngoog.require('shaka.media.ManifestParser');\ngoog.require('shaka.offline.DownloadManager');\ngoog.require('shaka.offline.IStorageEngine');\ngoog.require('shaka.offline.OfflineManifestParser');\ngoog.require('shaka.offline.OfflineUtils');\ngoog.require('shaka.util.ConfigUtils');\ngoog.require('shaka.util.Error');\ngoog.require('shaka.util.Functional');\ngoog.require('shaka.util.IDestroyable');\ngoog.require('shaka.util.LanguageUtils');\ngoog.require('shaka.util.ManifestParserUtils');\ngoog.require('shaka.util.StreamUtils');\n\n\n\n/**\n * This manages persistent offline data including storage, listing, and deleting\n * stored manifests.  Playback of offline manifests are done using Player\n * using the special URI (e.g. 'offline:12').\n *\n * First, check support() to see if offline is supported by the platform.\n * Second, configure() the storage object with callbacks to your application.\n * Third, call store(), remove(), or list() as needed.\n * When done, call destroy().\n *\n * @param {shaka.Player} player\n *   The player instance to pull configuration data from.\n *\n * @struct\n * @constructor\n * @implements {shaka.util.IDestroyable}\n * @export\n */\nshaka.offline.Storage = function(player) {\n  // It is an easy mistake to make to pass a Player proxy from CastProxy.\n  // Rather than throw a vague exception later, throw an explicit and clear one\n  // now.\n  if (!player || player.constructor != shaka.Player) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.STORAGE,\n        shaka.util.Error.Code.LOCAL_PLAYER_INSTANCE_REQUIRED);\n  }\n\n  /** @private {shaka.offline.IStorageEngine} */\n  this.storageEngine_ = shaka.offline.OfflineUtils.createStorageEngine();\n\n  /** @private {shaka.Player} */\n  this.player_ = player;\n\n  /** @private {?shakaExtern.OfflineConfiguration} */\n  this.config_ = this.defaultConfig_();\n\n  /** @private {shaka.media.DrmEngine} */\n  this.drmEngine_ = null;\n\n  /** @private {boolean} */\n  this.storeInProgress_ = false;\n\n  /** @private {Array.<shakaExtern.Track>} */\n  this.firstPeriodTracks_ = null;\n\n  /** @private {number} */\n  this.manifestId_ = -1;\n\n  /** @private {number} */\n  this.duration_ = 0;\n\n  /** @private {?shakaExtern.Manifest} */\n  this.manifest_ = null;\n\n  var netEngine = player.getNetworkingEngine();\n  goog.asserts.assert(netEngine, 'Player must not be destroyed');\n\n  /** @private {shaka.offline.DownloadManager} */\n  this.downloadManager_ = new shaka.offline.DownloadManager(\n      this.storageEngine_, netEngine,\n      player.getConfiguration().streaming.retryParameters, this.config_);\n};\n\n\n/**\n * Gets whether offline storage is supported.  Returns true if offline storage\n * is supported for clear content.  Support for offline storage of encrypted\n * content will not be determined until storage is attempted.\n *\n * @return {boolean}\n * @export\n */\nshaka.offline.Storage.support = function() {\n  return shaka.offline.OfflineUtils.isStorageEngineSupported();\n};\n\n\n/**\n * @override\n * @export\n */\nshaka.offline.Storage.prototype.destroy = function() {\n  var storageEngine = this.storageEngine_;\n  // Destroy the download manager first since it needs the StorageEngine to\n  // clean up old segments.\n  var ret = !this.downloadManager_ ?\n      Promise.resolve() :\n      this.downloadManager_.destroy()\n          .catch(function() {})\n          .then(function() {\n            if (storageEngine) return storageEngine.destroy();\n          });\n\n  this.storageEngine_ = null;\n  this.downloadManager_ = null;\n  this.player_ = null;\n  this.config_ = null;\n  return ret;\n};\n\n\n/**\n * Sets configuration values for Storage.  This is not associated with\n * Player.configure and will not change Player.\n *\n * There are two important callbacks configured here: one for download progress,\n * and one to decide which tracks to store.\n *\n * The default track selection callback will store the largest SD video track.\n * Provide your own callback to choose the tracks you want to store.\n *\n * @param {shakaExtern.OfflineConfiguration} config\n * @export\n */\nshaka.offline.Storage.prototype.configure = function(config) {\n  goog.asserts.assert(this.config_, 'Must not be destroyed');\n  shaka.util.ConfigUtils.mergeConfigObjects(\n      this.config_, config, this.defaultConfig_(), {}, '');\n};\n\n\n/**\n * Stores the given manifest.  If the content is encrypted, and encrypted\n * content cannot be stored on this platform, the Promise will be rejected with\n * error code 6001, REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE.\n *\n * @param {string} manifestUri The URI of the manifest to store.\n * @param {!Object} appMetadata An arbitrary object from the application that\n *   will be stored along-side the offline content.  Use this for any\n *   application-specific metadata you need associated with the stored content.\n *   For details on the data types that can be stored here, please refer to\n *   https://goo.gl/h62coS\n * @param {!shakaExtern.ManifestParser.Factory=} opt_manifestParserFactory\n * @return {!Promise.<shakaExtern.StoredContent>}  A Promise to a structure\n *   representing what was stored.  The \"offlineUri\" member is the URI that\n *   should be given to Player.load() to play this piece of content offline.\n *   The \"appMetadata\" member is the appMetadata argument you passed to store().\n * @export\n */\nshaka.offline.Storage.prototype.store = function(\n    manifestUri, appMetadata, opt_manifestParserFactory) {\n  if (this.storeInProgress_) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.STORAGE,\n        shaka.util.Error.Code.STORE_ALREADY_IN_PROGRESS));\n  }\n  this.storeInProgress_ = true;\n\n  /** @type {shakaExtern.ManifestDB} */\n  var manifestDb;\n\n  var error = null;\n  var onError = function(e) { error = e; };\n  return this.initIfNeeded_()\n      .then(function() {\n        this.checkDestroyed_();\n        return this.loadInternal(\n            manifestUri, onError, opt_manifestParserFactory);\n      }.bind(this)).then((\n          /**\n           * @param {{manifest: shakaExtern.Manifest,\n           *          drmEngine: !shaka.media.DrmEngine}} data\n           * @return {!Promise}\n           */\n          function(data) {\n            this.checkDestroyed_();\n            this.manifest_ = data.manifest;\n            this.drmEngine_ = data.drmEngine;\n\n            if (this.manifest_.presentationTimeline.isLive() ||\n                this.manifest_.presentationTimeline.isInProgress()) {\n              throw new shaka.util.Error(\n                  shaka.util.Error.Severity.CRITICAL,\n                  shaka.util.Error.Category.STORAGE,\n                  shaka.util.Error.Code.CANNOT_STORE_LIVE_OFFLINE, manifestUri);\n            }\n\n            // Re-filter now that DrmEngine is initialized.\n            this.manifest_.periods.forEach(this.filterPeriod_.bind(this));\n\n            this.manifestId_ = this.storageEngine_.reserveId('manifest');\n            this.duration_ = 0;\n            manifestDb = this.createOfflineManifest_(manifestUri, appMetadata);\n            return this.downloadManager_.downloadAndStore(manifestDb);\n          })\n      .bind(this))\n      .then(function() {\n        this.checkDestroyed_();\n        // Throw any errors from the manifest parser or DrmEngine.\n        if (error)\n          throw error;\n\n        return this.cleanup_();\n      }.bind(this))\n      .then(function() {\n        return shaka.offline.OfflineUtils.getStoredContent(manifestDb);\n      }.bind(this))\n      .catch(function(err) {\n        var Functional = shaka.util.Functional;\n        return this.cleanup_().catch(Functional.noop).then(function() {\n          throw err;\n        });\n      }.bind(this));\n};\n\n\n/**\n * Removes the given stored content.\n *\n * @param {shakaExtern.StoredContent} content\n * @return {!Promise}\n * @export\n */\nshaka.offline.Storage.prototype.remove = function(content) {\n  var uri = content.offlineUri;\n  var parts = /^offline:([0-9]+)$/.exec(uri);\n  if (!parts) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.STORAGE,\n        shaka.util.Error.Code.MALFORMED_OFFLINE_URI, uri));\n  }\n\n  var error = null;\n  var onError = function(e) {\n    // Ignore errors if the session was already removed.\n    if (e.code != shaka.util.Error.Code.OFFLINE_SESSION_REMOVED)\n      error = e;\n  };\n\n  /** @type {shakaExtern.ManifestDB} */\n  var manifestDb;\n  /** @type {!shaka.media.DrmEngine} */\n  var drmEngine;\n  var manifestId = Number(parts[1]);\n  return this.initIfNeeded_().then(function() {\n    this.checkDestroyed_();\n    return this.storageEngine_.get('manifest', manifestId);\n  }.bind(this)).then((\n      /**\n       * @param {?shakaExtern.ManifestDB} data\n       * @return {!Promise}\n       */\n      function(data) {\n        this.checkDestroyed_();\n        if (!data) {\n          throw new shaka.util.Error(\n              shaka.util.Error.Severity.CRITICAL,\n              shaka.util.Error.Category.STORAGE,\n              shaka.util.Error.Code.REQUESTED_ITEM_NOT_FOUND, uri);\n        }\n        manifestDb = data;\n        var manifest =\n            shaka.offline.OfflineManifestParser.reconstructManifest(manifestDb);\n        var netEngine = this.player_.getNetworkingEngine();\n        goog.asserts.assert(netEngine, 'Player must not be destroyed');\n        drmEngine = new shaka.media.DrmEngine(\n            netEngine, onError, function() {}, function() {});\n        drmEngine.configure(this.player_.getConfiguration().drm);\n        return drmEngine.init(manifest, true /* isOffline */);\n      })\n  .bind(this)).then(function() {\n    return drmEngine.removeSessions(manifestDb.sessionIds);\n  }.bind(this)).then(function() {\n    return drmEngine.destroy();\n  }.bind(this)).then(function() {\n    this.checkDestroyed_();\n    if (error) throw error;\n    var Functional = shaka.util.Functional;\n    // Get every segment for every stream in the manifest.\n    /** @type {!Array.<number>} */\n    var segments = manifestDb.periods.map(function(period) {\n      return period.streams.map(function(stream) {\n        var segments = stream.segments.map(function(segment) {\n          var parts = /^offline:[0-9]+\\/[0-9]+\\/([0-9]+)$/.exec(segment.uri);\n          goog.asserts.assert(parts, 'Invalid offline URI');\n          return Number(parts[1]);\n        });\n        if (stream.initSegmentUri) {\n          var parts = /^offline:[0-9]+\\/[0-9]+\\/([0-9]+)$/.exec(\n              stream.initSegmentUri);\n          goog.asserts.assert(parts, 'Invalid offline URI');\n          segments.push(Number(parts[1]));\n        }\n        return segments;\n      }).reduce(Functional.collapseArrays, []);\n    }).reduce(Functional.collapseArrays, []);\n\n    // Delete all the segments.\n    var deleteCount = 0;\n    var segmentCount = segments.length;\n    var callback = this.config_.progressCallback;\n\n    return this.storageEngine_.removeKeys('segment', segments, function() {\n      deleteCount++;\n      callback(content, deleteCount / segmentCount);\n    });\n\n  }.bind(this)).then(function() {\n    this.checkDestroyed_();\n    this.config_.progressCallback(content, 1);\n    return this.storageEngine_.remove('manifest', manifestId);\n  }.bind(this));\n};\n\n\n/**\n * Lists all the stored content available.\n *\n * @return {!Promise.<!Array.<shakaExtern.StoredContent>>}  A Promise to an\n *   array of structures representing all stored content.  The \"offlineUri\"\n *   member of the structure is the URI that should be given to Player.load()\n *   to play this piece of content offline.  The \"appMetadata\" member is the\n *   appMetadata argument you passed to store().\n * @export\n */\nshaka.offline.Storage.prototype.list = function() {\n  /** @type {!Array.<shakaExtern.StoredContent>} */\n  var storedContents = [];\n  return this.initIfNeeded_()\n      .then(function() {\n        this.checkDestroyed_();\n        return this.storageEngine_.forEach(\n            'manifest', function(/** shakaExtern.ManifestDB */ manifest) {\n              storedContents.push(\n                  shaka.offline.OfflineUtils.getStoredContent(manifest));\n            });\n      }.bind(this))\n      .then(function() { return storedContents; });\n};\n\n\n/**\n * Loads the given manifest, parses it, and constructs the DrmEngine.  This\n * stops the manifest parser.  This may be replaced by tests.\n *\n * @param {string} manifestUri\n * @param {function(*)} onError\n * @param {!shakaExtern.ManifestParser.Factory=} opt_manifestParserFactory\n * @return {!Promise.<{\n *   manifest: shakaExtern.Manifest,\n *   drmEngine: !shaka.media.DrmEngine\n * }>}\n */\nshaka.offline.Storage.prototype.loadInternal = function(\n    manifestUri, onError, opt_manifestParserFactory) {\n\n  var netEngine = /** @type {!shaka.net.NetworkingEngine} */ (\n      this.player_.getNetworkingEngine());\n  var config = this.player_.getConfiguration();\n\n  /** @type {shakaExtern.Manifest} */\n  var manifest;\n  /** @type {!shaka.media.DrmEngine} */\n  var drmEngine;\n  /** @type {!shakaExtern.ManifestParser} */\n  var manifestParser;\n\n  var onKeyStatusChange = function() {};\n  return shaka.media.ManifestParser\n      .getFactory(\n          manifestUri, netEngine, config.manifest.retryParameters,\n          opt_manifestParserFactory)\n      .then(function(factory) {\n        this.checkDestroyed_();\n        manifestParser = new factory();\n        manifestParser.configure(config.manifest);\n\n        var playerInterface = {\n          networkingEngine: netEngine,\n          filterPeriod: this.filterPeriod_.bind(this),\n          onTimelineRegionAdded: function() {},\n          onEvent: function() {},\n          onError: onError\n        };\n        return manifestParser.start(manifestUri, playerInterface);\n      }.bind(this))\n      .then(function(data) {\n        this.checkDestroyed_();\n        manifest = data;\n        drmEngine = new shaka.media.DrmEngine(\n            netEngine, onError, onKeyStatusChange, function() {});\n        drmEngine.configure(config.drm);\n        return drmEngine.init(manifest, true /* isOffline */);\n      }.bind(this))\n      .then(function() {\n        this.checkDestroyed_();\n        return this.createSegmentIndex_(manifest);\n      }.bind(this))\n      .then(function() {\n        this.checkDestroyed_();\n        return drmEngine.createOrLoad();\n      }.bind(this))\n      .then(function() {\n        this.checkDestroyed_();\n        return manifestParser.stop();\n      }.bind(this))\n      .then(function() {\n        this.checkDestroyed_();\n        return {manifest: manifest, drmEngine: drmEngine};\n      }.bind(this))\n      .catch(function(error) {\n        if (manifestParser)\n          return manifestParser.stop().then(function() { throw error; });\n        else\n          throw error;\n      });\n};\n\n\n/**\n * The default track selection function.\n *\n * @param {!Array.<shakaExtern.Track>} tracks\n * @return {!Array.<shakaExtern.Track>}\n * @private\n */\nshaka.offline.Storage.prototype.defaultTrackSelect_ = function(tracks) {\n  var LanguageUtils = shaka.util.LanguageUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n\n  var selectedTracks = [];\n\n  // Select variants with best language match.\n  var audioLangPref = LanguageUtils.normalize(\n      this.player_.getConfiguration().preferredAudioLanguage);\n  var matchTypes = [\n    LanguageUtils.MatchType.EXACT,\n    LanguageUtils.MatchType.BASE_LANGUAGE_OKAY,\n    LanguageUtils.MatchType.OTHER_SUB_LANGUAGE_OKAY\n  ];\n  var allVariantTracks =\n      tracks.filter(function(track) { return track.type == 'variant'; });\n  // For each match type, get the tracks that match the audio preference for\n  // that match type.\n  var tracksByMatchType = matchTypes.map(function(match) {\n    return allVariantTracks.filter(function(track) {\n      var lang = LanguageUtils.normalize(track.language);\n      return LanguageUtils.match(match, audioLangPref, lang);\n    });\n  });\n\n  // Find the best match type that has any matches.\n  var variantTracks;\n  for (var i = 0; i < tracksByMatchType.length; i++) {\n    if (tracksByMatchType[i].length) {\n      variantTracks = tracksByMatchType[i];\n      break;\n    }\n  }\n\n  // Fall back to \"primary\" audio tracks, if present.\n  if (!variantTracks) {\n    var primaryTracks = allVariantTracks.filter(function(track) {\n      return track.primary;\n    });\n    if (primaryTracks.length)\n      variantTracks = primaryTracks;\n  }\n\n  // Otherwise, there is no good way to choose the language, so we don't choose\n  // a language at all.\n  if (!variantTracks) {\n    variantTracks = allVariantTracks;\n    // Issue a warning, but only if the content has multiple languages.\n    // Otherwise, this warning would just be noise.\n    var languages = allVariantTracks\n        .map(function(track) { return track.language; })\n        .filter(shaka.util.Functional.isNotDuplicate);\n    if (languages.length > 1) {\n      shaka.log.warning('Could not choose a good audio track based on ' +\n                        'language preferences or primary tracks.  An ' +\n                        'arbitrary language will be stored!');\n    }\n  }\n\n  // From previously selected variants, choose the SD ones (height <= 480).\n  var tracksByHeight = variantTracks.filter(function(track) {\n    return track.height && track.height <= 480;\n  });\n\n  // If variants don't have video or no video with height <= 480 was\n  // found, proceed with the previously selected tracks.\n  if (tracksByHeight.length) {\n    // Sort by resolution, then select all variants which match the height\n    // of the highest SD res.  There may be multiple audio bitrates for the\n    // same video resolution.\n    tracksByHeight.sort(function(a, b) { return b.height - a.height; });\n    variantTracks = tracksByHeight.filter(function(track) {\n      return track.height == tracksByHeight[0].height;\n    });\n  }\n\n  // Now sort by bandwidth.\n  variantTracks.sort(function(a, b) { return a.bandwidth - b.bandwidth; });\n\n  // In case there are multiple matches at different audio bitrates, select the\n  // middle bandwidth one.\n  if (variantTracks.length)\n    selectedTracks.push(variantTracks[Math.floor(variantTracks.length / 2)]);\n\n  // Since this default callback is used primarily by our own demo app and by\n  // app developers who haven't thought about which tracks they want, we should\n  // select all text tracks, regardless of language.  This makes for a better\n  // demo for us, and does not rely on user preferences for the unconfigured\n  // app.\n  selectedTracks.push.apply(selectedTracks, tracks.filter(function(track) {\n    return track.type == ContentType.TEXT;\n  }));\n\n  return selectedTracks;\n};\n\n\n/**\n * @return {shakaExtern.OfflineConfiguration}\n * @private\n */\nshaka.offline.Storage.prototype.defaultConfig_ = function() {\n  return {\n    trackSelectionCallback: this.defaultTrackSelect_.bind(this),\n    progressCallback: function(storedContent, percent) {\n      // Reference arguments to keep closure from removing it.\n      // If the argument is removed, it breaks our function length check\n      // in mergeConfigObjects_().\n      // NOTE: Chrome App Content Security Policy prohibits usage of new\n      // Function().\n      if (storedContent || percent) return null;\n    }\n  };\n};\n\n\n/**\n * Initializes the IStorageEngine if it is not already.\n *\n * @return {!Promise}\n * @private\n */\nshaka.offline.Storage.prototype.initIfNeeded_ = function() {\n  if (!this.storageEngine_) {\n    return Promise.reject(new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.STORAGE,\n        shaka.util.Error.Code.STORAGE_NOT_SUPPORTED));\n  } else if (this.storageEngine_.initialized()) {\n    return Promise.resolve();\n  } else {\n    var scheme = shaka.offline.OfflineUtils.DB_SCHEME;\n    return this.storageEngine_.init(scheme);\n  }\n};\n\n\n/**\n * @param {shakaExtern.Period} period\n * @private\n */\nshaka.offline.Storage.prototype.filterPeriod_ = function(period) {\n  var StreamUtils = shaka.util.StreamUtils;\n  var ContentType = shaka.util.ManifestParserUtils.ContentType;\n  var activeStreams = {};\n  if (this.firstPeriodTracks_) {\n    var variantTracks = this.firstPeriodTracks_.filter(function(track) {\n      return track.type == 'variant';\n    });\n    var variant = null;\n    if (variantTracks.length)\n      variant = StreamUtils.findVariantForTrack(period, variantTracks[0]);\n\n    if (variant) {\n      // Use the first variant as the container of \"active streams\".  This\n      // is then used to filter out the streams that are not compatible with it.\n      // This ensures that in multi-Period content, all Periods have streams\n      // with compatible MIME types.\n      if (variant.video) activeStreams[ContentType.VIDEO] = variant.video;\n      if (variant.audio) activeStreams[ContentType.AUDIO] = variant.audio;\n    }\n  }\n  StreamUtils.filterPeriod(this.drmEngine_, activeStreams, period);\n  StreamUtils.applyRestrictions(\n      period, this.player_.getConfiguration().restrictions,\n      /* maxHwRes */ { width: Infinity, height: Infinity });\n};\n\n\n/**\n * Cleans up the current store and destroys any objects.  This object is still\n * usable after this.\n *\n * @return {!Promise}\n * @private\n */\nshaka.offline.Storage.prototype.cleanup_ = function() {\n  var ret = this.drmEngine_ ? this.drmEngine_.destroy() : Promise.resolve();\n  this.drmEngine_ = null;\n  this.manifest_ = null;\n  this.storeInProgress_ = false;\n  this.firstPeriodTracks_ = null;\n  this.manifestId_ = -1;\n  return ret;\n};\n\n\n/**\n * Calls createSegmentIndex for all streams in the manifest.\n *\n * @param {shakaExtern.Manifest} manifest\n * @return {!Promise}\n * @private\n */\nshaka.offline.Storage.prototype.createSegmentIndex_ = function(manifest) {\n  var Functional = shaka.util.Functional;\n  var streams = manifest.periods\n      .map(function(period) { return period.variants; })\n      .reduce(Functional.collapseArrays, [])\n      .map(function(variant) {\n        var variantStreams = [];\n        if (variant.audio) variantStreams.push(variant.audio);\n        if (variant.video) variantStreams.push(variant.video);\n        return variantStreams;\n      })\n      .reduce(Functional.collapseArrays, [])\n      .filter(Functional.isNotDuplicate);\n\n  var textStreams = manifest.periods\n      .map(function(period) { return period.textStreams; })\n      .reduce(Functional.collapseArrays, []);\n\n  streams.push.apply(streams, textStreams);\n  return Promise.all(\n      streams.map(function(stream) { return stream.createSegmentIndex(); }));\n};\n\n\n/**\n * Creates an offline 'manifest' for the real manifest.  This does not store\n * the segments yet, only adds them to the download manager through\n * createPeriod_.\n *\n * @param {string} originalManifestUri\n * @param {!Object} appMetadata\n * @return {shakaExtern.ManifestDB}\n * @private\n */\nshaka.offline.Storage.prototype.createOfflineManifest_ = function(\n    originalManifestUri, appMetadata) {\n  var periods = this.manifest_.periods.map(this.createPeriod_.bind(this));\n  var drmInfo = this.drmEngine_.getDrmInfo();\n  var sessions = this.drmEngine_.getSessionIds();\n  if (drmInfo) {\n    if (!sessions.length) {\n      throw new shaka.util.Error(\n          shaka.util.Error.Severity.CRITICAL, shaka.util.Error.Category.STORAGE,\n          shaka.util.Error.Code.NO_INIT_DATA_FOR_OFFLINE, originalManifestUri);\n    }\n    // Don't store init data since we have stored sessions.\n    drmInfo.initData = [];\n  }\n\n  return {\n    key: this.manifestId_,\n    originalManifestUri: originalManifestUri,\n    duration: this.duration_,\n    size: 0,\n    expiration: this.drmEngine_.getExpiration(),\n    periods: periods,\n    sessionIds: sessions,\n    drmInfo: drmInfo,\n    appMetadata: appMetadata\n  };\n};\n\n\n/**\n * Converts a manifest Period to a database Period.  This will use the current\n * configuration to get the tracks to use, then it will search each segment\n * index and add all the segments to the download manager through createStream_.\n *\n * @param {shakaExtern.Period} period\n * @return {shakaExtern.PeriodDB}\n * @private\n */\nshaka.offline.Storage.prototype.createPeriod_ = function(period) {\n  var StreamUtils = shaka.util.StreamUtils;\n\n  var variantTracks = StreamUtils.getVariantTracks(period, null, null);\n  var textTracks = StreamUtils.getTextTracks(period, null);\n  var allTracks = variantTracks.concat(textTracks);\n\n  var chosenTracks = this.config_.trackSelectionCallback(allTracks);\n\n  if (this.firstPeriodTracks_ == null) {\n    this.firstPeriodTracks_ = chosenTracks;\n    // Now that the first tracks are chosen, filter again.  This ensures all\n    // Periods have compatible content types.\n    this.manifest_.periods.forEach(this.filterPeriod_.bind(this));\n  }\n\n  for (var i = chosenTracks.length - 1; i > 0; --i) {\n    var foundSimilarTracks = false;\n    for (var j = i - 1; j >= 0; --j) {\n      if (chosenTracks[i].type == chosenTracks[j].type &&\n          chosenTracks[i].kind == chosenTracks[j].kind &&\n          chosenTracks[i].language == chosenTracks[j].language) {\n        shaka.log.warning(\n            'Multiple tracks of the same type/kind/language given.');\n        foundSimilarTracks = true;\n        break;\n      }\n    }\n    if (foundSimilarTracks) break;\n  }\n\n  var streams = [];\n\n  for (var i = 0; i < chosenTracks.length; i++) {\n    var variant = StreamUtils.findVariantForTrack(period, chosenTracks[i]);\n    if (variant) {\n      // Make a rough estimation of the streams' bandwidth so download manager\n      // can track the progress of the download.\n      var bandwidthEstimation;\n      if (variant.audio) {\n        // If the audio stream has already been added to the DB\n        // as part of another variant, add the ID to the list.\n        // Otherwise, add it to the DB.\n        var stream = streams.filter(function(s) {\n          return s.id == variant.audio.id;\n        })[0];\n        if (stream) {\n          stream.variantIds.push(variant.id);\n        } else {\n          // If variant has both audio and video, roughly estimate them\n          // both to be 1/2 of the variant's bandwidth.\n          // If variant only has one stream, it's bandwidth equals to\n          // the bandwidth of the variant.\n          bandwidthEstimation =\n              variant.video ? variant.bandwidth / 2 : variant.bandwidth;\n          streams.push(this.createStream_(period,\n                                          variant.audio,\n                                          bandwidthEstimation,\n                                          variant.id));\n        }\n      }\n      if (variant.video) {\n        var stream = streams.filter(function(s) {\n          return s.id == variant.video.id;\n        })[0];\n        if (stream) {\n          stream.variantIds.push(variant.id);\n        } else {\n          bandwidthEstimation =\n              variant.audio ? variant.bandwidth / 2 : variant.bandwidth;\n          streams.push(this.createStream_(period,\n                                          variant.video,\n                                          bandwidthEstimation,\n                                          variant.id));\n        }\n      }\n    } else {\n      var textStream =\n          StreamUtils.findTextStreamForTrack(period, chosenTracks[i]);\n      goog.asserts.assert(\n          textStream, 'Could not find track with id ' + chosenTracks[i].id);\n      streams.push(this.createStream_(\n          period, textStream, 0 /* estimatedStreamBandwidth */));\n    }\n  }\n\n  return {\n    startTime: period.startTime,\n    streams: streams\n  };\n};\n\n\n/**\n * Converts a manifest stream to a database stream.  This will search the\n * segment index and add all the segments to the download manager.\n *\n * @param {shakaExtern.Period} period\n * @param {shakaExtern.Stream} stream\n * @param {number} estimatedStreamBandwidth\n * @param {number=} opt_variantId\n * @return {shakaExtern.StreamDB}\n * @private\n */\nshaka.offline.Storage.prototype.createStream_ = function(\n    period, stream, estimatedStreamBandwidth, opt_variantId) {\n  /** @type {!Array.<shakaExtern.SegmentDB>} */\n  var segmentsDb = [];\n  var startTime =\n      this.manifest_.presentationTimeline.getSegmentAvailabilityStart();\n  var endTime = startTime;\n  var i = stream.findSegmentPosition(startTime);\n  var ref = (i != null ? stream.getSegmentReference(i) : null);\n  while (ref) {\n    var id = this.storageEngine_.reserveId('segment');\n    var bandwidthSize =\n        (ref.endTime - ref.startTime) * estimatedStreamBandwidth / 8;\n\n    /** @type {shakaExtern.SegmentDataDB} */\n    var segmentDataDb = {\n      key: id,\n      data: null,\n      manifestKey: this.manifestId_,\n      streamNumber: stream.id,\n      segmentNumber: id\n    };\n    this.downloadManager_.addSegment(\n        stream.type, ref, bandwidthSize, segmentDataDb);\n\n    segmentsDb.push({\n      startTime: ref.startTime,\n      endTime: ref.endTime,\n      uri: 'offline:' + this.manifestId_ + '/' + stream.id + '/' + id\n    });\n\n    endTime = ref.endTime + period.startTime;\n    ref = stream.getSegmentReference(++i);\n  }\n\n  this.duration_ = Math.max(this.duration_, (endTime - startTime));\n  var initUri = null;\n  if (stream.initSegmentReference) {\n    var id = this.storageEngine_.reserveId('segment');\n    initUri = 'offline:' + this.manifestId_ + '/' + stream.id + '/' + id;\n\n    /** @type {shakaExtern.SegmentDataDB} */\n    var initDataDb = {\n      key: id,\n      data: null,\n      manifestKey: this.manifestId_,\n      streamNumber: stream.id,\n      segmentNumber: -1\n    };\n\n    this.downloadManager_.addSegment(\n        stream.contentType, stream.initSegmentReference, 0, initDataDb);\n  }\n\n  var variantIds = [];\n  if (opt_variantId != null) variantIds.push(opt_variantId);\n\n  return {\n    id: stream.id,\n    primary: stream.primary,\n    presentationTimeOffset: stream.presentationTimeOffset || 0,\n    contentType: stream.type,\n    mimeType: stream.mimeType,\n    codecs: stream.codecs,\n    frameRate: stream.frameRate,\n    kind: stream.kind,\n    language: stream.language,\n    label: stream.label,\n    width: stream.width || null,\n    height: stream.height || null,\n    initSegmentUri: initUri,\n    encrypted: stream.encrypted,\n    keyId: stream.keyId,\n    segments: segmentsDb,\n    variantIds: variantIds\n  };\n};\n\n\n/**\n * Throws an error if the object is destroyed.\n * @private\n */\nshaka.offline.Storage.prototype.checkDestroyed_ = function() {\n  if (!this.player_) {\n    throw new shaka.util.Error(\n        shaka.util.Error.Severity.CRITICAL,\n        shaka.util.Error.Category.STORAGE,\n        shaka.util.Error.Code.OPERATION_ABORTED);\n  }\n};\n\n\nshaka.Player.registerSupportPlugin('offline', shaka.offline.Storage.support);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/offline/storage.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.installAll');\ngoog.provide('shaka.polyfill.register');\n\n\n/**\n * @namespace shaka.polyfill\n * @summary A one-stop installer for all polyfills.\n * @see http://enwp.org/polyfill\n * @exportDoc\n */\n\n\n/**\n * Install all polyfills.\n * @export\n */\nshaka.polyfill.installAll = function() {\n  for (var i = 0; i < shaka.polyfill.polyfills_.length; ++i) {\n    shaka.polyfill.polyfills_[i]();\n  }\n};\n\n\n/**\n * Contains the polyfills that will be installed.\n * @private {!Array.<function()>}\n */\nshaka.polyfill.polyfills_ = [];\n\n\n/**\n * Registers a new polyfill to be installed.\n *\n * @param {function()} polyfill\n * @export\n */\nshaka.polyfill.register = function(polyfill) {\n  shaka.polyfill.polyfills_.push(polyfill);\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/all.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.Fullscreen');\n\ngoog.require('shaka.polyfill.register');\n\n\n/**\n * @namespace shaka.polyfill.Fullscreen\n *\n * @summary A polyfill to unify fullscreen APIs across browsers.\n * Many browsers have prefixed fullscreen methods on Element and document.\n * See {@link http://goo.gl/n7TYl0 Using fullscreen mode} on MDN for more\n * information.\n */\n\n\n/**\n * Install the polyfill if needed.\n */\nshaka.polyfill.Fullscreen.install = function() {\n  if (!window.Document) {\n    // Avoid errors on very old browsers.\n    return;\n  }\n\n  var proto = Element.prototype;\n  proto.requestFullscreen = proto.requestFullscreen ||\n                            proto.mozRequestFullScreen ||\n                            proto.msRequestFullscreen ||\n                            proto.webkitRequestFullscreen;\n\n  proto = Document.prototype;\n  proto.exitFullscreen = proto.exitFullscreen ||\n                         proto.mozCancelFullScreen ||\n                         proto.msExitFullscreen ||\n                         proto.webkitExitFullscreen;\n\n  if (!('fullscreenElement' in document)) {\n    Object.defineProperty(document, 'fullscreenElement', {\n      get: function() {\n        return document.mozFullScreenElement ||\n               document.msFullscreenElement ||\n               document.webkitFullscreenElement;\n      }\n    });\n    Object.defineProperty(document, 'fullscreenEnabled', {\n      get: function() {\n        return document.mozFullScreenEnabled ||\n               document.msFullscreenEnabled ||\n               document.webkitFullscreenEnabled;\n      }\n    });\n  }\n\n  var proxy = shaka.polyfill.Fullscreen.proxyEvent_;\n  document.addEventListener('webkitfullscreenchange', proxy);\n  document.addEventListener('webkitfullscreenerror', proxy);\n  document.addEventListener('mozfullscreenchange', proxy);\n  document.addEventListener('mozfullscreenerror', proxy);\n  document.addEventListener('MSFullscreenChange', proxy);\n  document.addEventListener('MSFullscreenError', proxy);\n};\n\n\n/**\n * Proxy fullscreen events after changing their name.\n * @param {!Event} event\n * @private\n */\nshaka.polyfill.Fullscreen.proxyEvent_ = function(event) {\n  var eventType = event.type.replace(/^(webkit|moz|MS)/, '').toLowerCase();\n\n  var newEvent;\n  // IE 11 does not have an Event constructor\n  if (typeof(Event) === 'function') {\n    newEvent = new Event(eventType, /** @type {EventInit} */(event));\n  } else {\n    newEvent = document.createEvent('Event');\n    newEvent.initEvent(eventType, event.bubbles, event.cancelable);\n  }\n\n  event.target.dispatchEvent(newEvent);\n};\n\n\nshaka.polyfill.register(shaka.polyfill.Fullscreen.install);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/fullscreen.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.IndexedDB');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.polyfill.register');\n\n\n/**\n * @namespace shaka.polyfill.IndexedDB\n *\n * @summary A polyfill to patch indexed db bugs.\n */\n\n\n/**\n * Install the polyfill if needed.\n */\nshaka.polyfill.IndexedDB.install = function() {\n  shaka.log.debug('IndexedDB.install');\n\n  var agent = navigator.userAgent;\n  if (agent && agent.indexOf('CrKey') >= 0) {\n    shaka.log.debug('Removing IndexedDB from ChromeCast');\n    delete window.indexedDB;\n    goog.asserts.assert(\n        !window.indexedDB, 'Failed to override window.indexedDB');\n  }\n};\n\nshaka.polyfill.register(shaka.polyfill.IndexedDB.install);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/indexed_db.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\ngoog.provide('shaka.polyfill.MathRound');\n\ngoog.require('shaka.log');\ngoog.require('shaka.polyfill.register');\n\n/**\n * @namespace shaka.polyfill.MathRound\n *\n * @summary A polyfill to patch math round bug on some browsers.\n */\n\n\n/**\n @const {number}\n @private\n */\nshaka.polyfill.MathRound.MAX_ACCURATE_INPUT_ = 0x10000000000000;\n\n\n/**\n * Install the polyfill if needed.\n */\nshaka.polyfill.MathRound.install = function() {\n  shaka.log.debug('mathRound.install');\n\n  var testNumber = shaka.polyfill.MathRound.MAX_ACCURATE_INPUT_ + 1;\n  if (Math.round(testNumber) != testNumber) {\n    shaka.log.debug('polyfill Math.round');\n    var original_mathRound = Math.round;\n    Math.round = function(number) {\n      var result = number;\n      // https://stackoverflow.com/questions/12830742/javascript-math-round-bug-in-ie\n      // Due to the precision of JavaScript numbers, the number must be integer\n      if (number <= shaka.polyfill.MathRound.MAX_ACCURATE_INPUT_) {\n        result = original_mathRound(number);\n      }\n      return result;\n    };\n  }\n};\n\nshaka.polyfill.register(shaka.polyfill.MathRound.install);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/mathround.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.util.Pssh');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.util.Mp4Parser');\ngoog.require('shaka.util.Uint8ArrayUtils');\n\n\n\n/**\n * Parse a PSSH box and extract the system IDs.\n *\n * @param {!Uint8Array} psshBox\n * @constructor\n * @struct\n * @throws {shaka.util.Error} if a PSSH box is truncated or contains a size\n *   field over 53 bits.\n */\nshaka.util.Pssh = function(psshBox) {\n  /**\n   * In hex.\n   * @type {!Array.<string>}\n   */\n  this.systemIds = [];\n\n  /**\n   * In hex.\n   * @type {!Array.<string>}\n   */\n  this.cencKeyIds = [];\n\n  /*\n  * Array of tuples that define the startIndex + size for each\n  * discrete pssh within |psshBox|\n  * */\n  this.dataBoundaries = [];\n\n  new shaka.util.Mp4Parser()\n      .fullBox('pssh', this.parseBox_.bind(this)).parse(psshBox.buffer);\n\n  if (this.dataBoundaries.length == 0) {\n    shaka.log.warning('No pssh box found!');\n  }\n};\n\n\n/**\n * @param {!shaka.util.Mp4Parser.ParsedBox} box\n * @private\n */\nshaka.util.Pssh.prototype.parseBox_ = function(box) {\n  goog.asserts.assert(\n      box.version != null,\n      'PSSH boxes are full boxes and must have a valid version');\n\n  goog.asserts.assert(\n      box.flags != null,\n      'PSSH boxes are full boxes and must have a valid flag');\n\n  if (box.version > 1) {\n    shaka.log.warning('Unrecognized PSSH version found!');\n    return;\n  }\n\n  var systemId = shaka.util.Uint8ArrayUtils.toHex(box.reader.readBytes(16));\n  var keyIds = [];\n  if (box.version > 0) {\n    var numKeyIds = box.reader.readUint32();\n    for (var i = 0; i < numKeyIds; ++i) {\n      var keyId = shaka.util.Uint8ArrayUtils.toHex(box.reader.readBytes(16));\n      keyIds.push(keyId);\n    }\n  }\n\n  var dataSize = box.reader.readUint32();\n  box.reader.skip(dataSize);  // Ignore the data section.\n\n  // Now that everything has been succesfully parsed from this box,\n  // update member variables.\n  this.cencKeyIds.push.apply(this.cencKeyIds, keyIds);\n  this.systemIds.push(systemId);\n  this.dataBoundaries.push({\n    start: box.start,\n    end: box.start + box.size - 1\n  });\n\n  if (box.reader.getPosition() != box.reader.getLength()) {\n    shaka.log.warning('Mismatch between box size and data size!');\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/util/pssh.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.PatchedMediaKeysMs');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.util.ArrayUtils');\ngoog.require('shaka.util.EventManager');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.FakeEventTarget');\ngoog.require('shaka.util.Pssh');\ngoog.require('shaka.util.PublicPromise');\ngoog.require('shaka.util.Uint8ArrayUtils');\n\n\n/**\n * Install a polyfill to implement {@link http://goo.gl/blgtZZ EME draft\n * 12 March 2015} on top of ms-prefixed\n * {@link http://www.w3.org/TR/2014/WD-encrypted-media-20140218/ EME v20140218}.\n */\nshaka.polyfill.PatchedMediaKeysMs.install = function() {\n  shaka.log.debug('PatchedMediaKeysMs.install');\n\n  // Alias\n  var PatchedMediaKeysMs = shaka.polyfill.PatchedMediaKeysMs;\n\n  // Construct fake key ID.  This is not done at load-time to avoid exceptions\n  // on unsupported browsers.  This particular fake key ID was suggested in\n  // w3c/encrypted-media#32.\n  PatchedMediaKeysMs.MediaKeyStatusMap.KEY_ID_ = (new Uint8Array([0])).buffer;\n\n  // Delete mediaKeys to work around strict mode compatibility issues.\n  delete HTMLMediaElement.prototype['mediaKeys'];\n  // Work around read-only declaration for mediaKeys by using a string.\n  HTMLMediaElement.prototype['mediaKeys'] = null;\n  HTMLMediaElement.prototype.setMediaKeys = PatchedMediaKeysMs.setMediaKeys;\n\n  // Install patches\n  window.MediaKeys = PatchedMediaKeysMs.MediaKeys;\n  window.MediaKeySystemAccess = PatchedMediaKeysMs.MediaKeySystemAccess;\n  navigator.requestMediaKeySystemAccess =\n      PatchedMediaKeysMs.requestMediaKeySystemAccess;\n};\n\n\n/**\n * An implementation of navigator.requestMediaKeySystemAccess.\n * Retrieve a MediaKeySystemAccess object.\n *\n * @this {!Navigator}\n * @param {string} keySystem\n * @param {!Array.<!MediaKeySystemConfiguration>} supportedConfigurations\n * @return {!Promise.<!MediaKeySystemAccess>}\n */\nshaka.polyfill.PatchedMediaKeysMs.requestMediaKeySystemAccess =\n    function(keySystem, supportedConfigurations) {\n  shaka.log.debug('PatchedMediaKeysMs.requestMediaKeySystemAccess');\n  goog.asserts.assert(this == navigator,\n                      'bad \"this\" for requestMediaKeySystemAccess');\n\n  // Alias.\n  var PatchedMediaKeysMs = shaka.polyfill.PatchedMediaKeysMs;\n  try {\n    var access = new PatchedMediaKeysMs.MediaKeySystemAccess(\n        keySystem, supportedConfigurations);\n    return Promise.resolve(/** @type {!MediaKeySystemAccess} */ (access));\n  } catch (exception) {\n    return Promise.reject(exception);\n  }\n};\n\n\n\n/**\n * An implementation of MediaKeySystemAccess.\n *\n * @constructor\n * @struct\n * @param {string} keySystem\n * @param {!Array.<!MediaKeySystemConfiguration>} supportedConfigurations\n * @implements {MediaKeySystemAccess}\n * @throws {Error} if the key system is not supported.\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySystemAccess =\n    function(keySystem, supportedConfigurations) {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeySystemAccess');\n\n  /** @type {string} */\n  this.keySystem = keySystem;\n\n  /** @private {!MediaKeySystemConfiguration} */\n  this.configuration_;\n\n  var allowPersistentState = true;\n\n  var success = false;\n  for (var i = 0; i < supportedConfigurations.length; ++i) {\n    var cfg = supportedConfigurations[i];\n\n    // Create a new config object and start adding in the pieces which we\n    // find support for.  We will return this from getConfiguration() if\n    // asked.\n    /** @type {!MediaKeySystemConfiguration} */\n    var newCfg = {\n      'audioCapabilities': [],\n      'videoCapabilities': [],\n      // It is technically against spec to return these as optional, but we\n      // don't truly know their values from the prefixed API:\n      'persistentState': 'optional',\n      'distinctiveIdentifier': 'optional',\n      // Pretend the requested init data types are supported, since we don't\n      // really know that either:\n      'initDataTypes': cfg.initDataTypes,\n      'sessionTypes': ['temporary'],\n      'label': cfg.label\n    };\n\n    // PatchedMediaKeysMs tests for key system availability through\n    // MSMediaKeys.isTypeSupported\n    var ranAnyTests = false;\n    if (cfg.audioCapabilities) {\n      for (var j = 0; j < cfg.audioCapabilities.length; ++j) {\n        var cap = cfg.audioCapabilities[j];\n        if (cap.contentType) {\n          ranAnyTests = true;\n          var contentType = cap.contentType.split(';')[0];\n          if (MSMediaKeys.isTypeSupported(this.keySystem, contentType)) {\n            newCfg.audioCapabilities.push(cap);\n            success = true;\n          }\n        }\n      }\n    }\n    if (cfg.videoCapabilities) {\n      for (var j = 0; j < cfg.videoCapabilities.length; ++j) {\n        var cap = cfg.videoCapabilities[j];\n        if (cap.contentType) {\n          ranAnyTests = true;\n          var contentType = cap.contentType.split(';')[0];\n          if (MSMediaKeys.isTypeSupported(this.keySystem, contentType)) {\n            newCfg.videoCapabilities.push(cap);\n            success = true;\n          }\n        }\n      }\n    }\n\n    if (!ranAnyTests) {\n      // If no specific types were requested, we check all common types to find\n      // out if the key system is present at all.\n      success = MSMediaKeys.isTypeSupported(this.keySystem, 'video/mp4');\n    }\n    if (cfg.persistentState == 'required') {\n      if (allowPersistentState) {\n        newCfg.persistentState = 'required';\n        newCfg.sessionTypes = ['persistent-license'];\n      } else {\n        success = false;\n      }\n    }\n\n    if (success) {\n      this.configuration_ = newCfg;\n      return;\n    }\n  }  // for each cfg in supportedConfigurations\n\n  // As per the spec, this should be a DOMException, but\n  // there is not a public constructor for this\n  var unsupportedKeySystemError = new Error('Unsupported keySystem');\n  unsupportedKeySystemError.name = 'NotSupportedError';\n  unsupportedKeySystemError.code = DOMException.NOT_SUPPORTED_ERR;\n  throw unsupportedKeySystemError;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySystemAccess.prototype.\n    createMediaKeys = function() {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys');\n\n  // Alias\n  var PatchedMediaKeysMs = shaka.polyfill.PatchedMediaKeysMs;\n\n  var mediaKeys = new PatchedMediaKeysMs.MediaKeys(this.keySystem);\n  return Promise.resolve(/** @type {!MediaKeys} */ (mediaKeys));\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySystemAccess.prototype.\n    getConfiguration = function() {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration');\n  return this.configuration_;\n};\n\n\n/**\n * An implementation of HTMLMediaElement.prototype.setMediaKeys.\n * Attach a MediaKeys object to the media element.\n *\n * @this {!HTMLMediaElement}\n * @param {MediaKeys} mediaKeys\n * @return {!Promise}\n */\nshaka.polyfill.PatchedMediaKeysMs.setMediaKeys = function(mediaKeys) {\n  shaka.log.debug('PatchedMediaKeysMs.setMediaKeys');\n  goog.asserts.assert(this instanceof HTMLMediaElement,\n                      'bad \"this\" for setMediaKeys');\n\n  // Alias\n  var PatchedMediaKeysMs = shaka.polyfill.PatchedMediaKeysMs;\n\n  var newMediaKeys =\n      /** @type {shaka.polyfill.PatchedMediaKeysMs.MediaKeys} */ (\n      mediaKeys);\n  var oldMediaKeys =\n      /** @type {shaka.polyfill.PatchedMediaKeysMs.MediaKeys} */ (\n      this.mediaKeys);\n\n  if (oldMediaKeys && oldMediaKeys != newMediaKeys) {\n    goog.asserts.assert(oldMediaKeys instanceof PatchedMediaKeysMs.MediaKeys,\n                        'non-polyfill instance of oldMediaKeys');\n    // Have the old MediaKeys stop listening to events on the video tag.\n    oldMediaKeys.setMedia(null);\n  }\n\n  delete this['mediaKeys'];  // in case there is an existing getter\n  this['mediaKeys'] = mediaKeys;  // work around read-only declaration\n\n  if (newMediaKeys) {\n    goog.asserts.assert(newMediaKeys instanceof PatchedMediaKeysMs.MediaKeys,\n                        'non-polyfill instance of newMediaKeys');\n    return newMediaKeys.setMedia(this);\n  }\n\n  return Promise.resolve();\n};\n\n\n\n/**\n * An implementation of MediaKeys.\n *\n * @constructor\n * @struct\n * @param {string} keySystem\n * @implements {MediaKeys}\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeys = function(keySystem) {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeys');\n\n  /** @private {!MSMediaKeys} */\n  this.nativeMediaKeys_ = new MSMediaKeys(keySystem);\n\n  /** @private {!shaka.util.EventManager} */\n  this.eventManager_ = new shaka.util.EventManager();\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeys.prototype.\n    createSession = function(opt_sessionType) {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeys.createSession');\n\n  var sessionType = opt_sessionType || 'temporary';\n  // For now, only 'temporary' type is supported\n  if (sessionType != 'temporary') {\n    throw new TypeError('Session type ' + opt_sessionType +\n        ' is unsupported on this platform.');\n  }\n\n  // Alias\n  var PatchedMediaKeysMs = shaka.polyfill.PatchedMediaKeysMs;\n\n  return new PatchedMediaKeysMs.MediaKeySession(\n      this.nativeMediaKeys_, sessionType);\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeys.prototype.\n    setServerCertificate = function(serverCertificate) {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeys.setServerCertificate');\n\n  // There is no equivalent in PatchedMediaKeysMs, so return failure.\n  return Promise.resolve(false);\n};\n\n\n/**\n * @param {HTMLMediaElement} media\n * @protected\n * @return {!Promise}\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeys.prototype.\n    setMedia = function(media) {\n\n  // Alias\n  var PatchedMediaKeysMs = shaka.polyfill.PatchedMediaKeysMs;\n\n  // Remove any old listeners.\n  this.eventManager_.removeAll();\n\n  // It is valid for media to be null, it's used to flag that event handlers\n  // need to be cleaned up\n  if (!media) {\n    return Promise.resolve();\n  }\n\n  // Intercept and translate these prefixed EME events.\n  this.eventManager_.listen(media, 'msneedkey',\n      /** @type {shaka.util.EventManager.ListenerType} */\n      (PatchedMediaKeysMs.onMsNeedKey_));\n\n  var self = this;\n  function setMediaKeysDeferred() {\n    media.msSetMediaKeys(self.nativeMediaKeys_);\n    media.removeEventListener('loadedmetadata', setMediaKeysDeferred);\n  }\n\n  // Wrap native HTMLMediaElement.msSetMediaKeys with Promise\n  try {\n    // IE11/Edge requires that readyState >=1 before mediaKeys can be set, so\n    // check this and wait for loadedmetadata if we are not in the correct state\n    if (media.readyState >= 1) {\n      media.msSetMediaKeys(this.nativeMediaKeys_);\n    } else {\n      media.addEventListener('loadedmetadata', setMediaKeysDeferred);\n    }\n\n    return Promise.resolve();\n\n  } catch (exception) {\n    return Promise.reject(exception);\n  }\n};\n\n\n\n/**\n * An implementation of MediaKeySession.\n *\n * @constructor\n * @struct\n * @param {MSMediaKeys} nativeMediaKeys\n * @param {string} sessionType\n * @implements {MediaKeySession}\n * @extends {shaka.util.FakeEventTarget}\n */\nshaka.polyfill.PatchedMediaKeysMs.\n    MediaKeySession = function(nativeMediaKeys, sessionType) {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeySession');\n  shaka.util.FakeEventTarget.call(this);\n\n  // Native MediaKeySession, which will be created in generateRequest\n  /** @private {MSMediaKeySession} */\n  this.nativeMediaKeySession_ = null;\n\n  /** @private {MSMediaKeys} */\n  this.nativeMediaKeys_ = nativeMediaKeys;\n\n  // Promises that are resolved later\n  /** @private {Promise} */\n  this.generateRequestPromise_ = null;\n\n  /** @private {Promise} */\n  this.updatePromise_ = null;\n\n  /** @private {!shaka.util.EventManager} */\n  this.eventManager_ = new shaka.util.EventManager();\n\n  /** @type {string} */\n  this.sessionId = '';\n\n  /** @type {number} */\n  this.expiration = NaN;\n\n  /** @type {!shaka.util.PublicPromise} */\n  this.closed = new shaka.util.PublicPromise();\n\n  /** @type {!MediaKeyStatusMap} */\n  this.keyStatuses =\n      new shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap();\n};\ngoog.inherits(shaka.polyfill.PatchedMediaKeysMs.MediaKeySession,\n    shaka.util.FakeEventTarget);\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.\n    generateRequest = function(initDataType, initData) {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeySession.generateRequest');\n\n  this.generateRequestPromise_ = new shaka.util.PublicPromise();\n\n  try {\n    // This EME spec version requires a MIME content type as the 1st param\n    // to createSession, but doesn't seem to matter what the value is.\n\n    // NOTE: IE11 takes either Uint8Array or ArrayBuffer, but Edge 12 only\n    // accepts Uint8Array.\n    this.nativeMediaKeySession_ = this.nativeMediaKeys_\n        .createSession('video/mp4', new Uint8Array(initData), null);\n\n    // Attach session event handlers here\n    this.eventManager_.listen(this.nativeMediaKeySession_, 'mskeymessage',\n        /** @type {shaka.util.EventManager.ListenerType} */\n        (this.onMsKeyMessage_.bind(this)));\n    this.eventManager_.listen(this.nativeMediaKeySession_, 'mskeyadded',\n        /** @type {shaka.util.EventManager.ListenerType} */\n        (this.onMsKeyAdded_.bind(this)));\n    this.eventManager_.listen(this.nativeMediaKeySession_, 'mskeyerror',\n        /** @type {shaka.util.EventManager.ListenerType} */\n        (this.onMsKeyError_.bind(this)));\n\n    this.updateKeyStatus_('status-pending');\n  } catch (exception) {\n    this.generateRequestPromise_.reject(exception);\n  }\n\n  return this.generateRequestPromise_;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.\n    load = function() {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeySession.load');\n\n  return Promise.reject(new Error('MediaKeySession.load not yet supported'));\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.\n    update = function(response) {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeySession.update');\n\n  this.updatePromise_ = new shaka.util.PublicPromise();\n\n  try {\n    // Pass through to the native session.\n    // NOTE: IE11 takes either Uint8Array or ArrayBuffer, but Edge 12 only\n    // accepts Uint8Array.\n    this.nativeMediaKeySession_.update(new Uint8Array(response));\n  } catch (exception) {\n    this.updatePromise_.reject(exception);\n  }\n\n  return this.updatePromise_;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.\n    close = function() {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeySession.close');\n\n  try {\n    // Pass through to the native session\n    // NOTE: IE seems to have spec discrepancy here - v2010218 should have\n    // MediaKeySession.release, but actually uses \"close\". The next version\n    // of the spec is the initial Promise based one, so it's not the target spec\n    // either.\n    this.nativeMediaKeySession_.close();\n\n    this.closed.resolve();\n    this.eventManager_.removeAll();\n  } catch (exception) {\n    this.closed.reject(exception);\n  }\n\n  return this.closed;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.\n    remove = function() {\n  shaka.log.debug('PatchedMediaKeysMs.MediaKeySession.remove');\n\n  return Promise.reject(new Error('MediaKeySession.remove is only ' +\n      'applicable for persistent licenses, which are not supported on ' +\n      'this platform'));\n};\n\n\n/**\n * Handler for the native media elements msNeedKey event.\n *\n * @this {!HTMLMediaElement}\n * @param {!MediaKeyEvent} event\n * @private\n */\nshaka.polyfill.PatchedMediaKeysMs.onMsNeedKey_ = function(event) {\n  shaka.log.debug('PatchedMediaKeysMs.onMsNeedKey_', event);\n\n  // Alias\n  var PatchedMediaKeysMs = shaka.polyfill.PatchedMediaKeysMs;\n\n  // NOTE: Because \"this\" is a real EventTarget, on IE, the event we dispatch\n  // here must also be a real Event.\n  var event2 = /** @type {!CustomEvent} */(document.createEvent('CustomEvent'));\n  event2.initCustomEvent('encrypted', false, false, null);\n  event2.initDataType = 'cenc';\n  event2.initData = PatchedMediaKeysMs.NormaliseInitData_(event.initData);\n\n  this.dispatchEvent(event2);\n};\n\n\n/**\n * Normalise the initData array. This is to apply browser specific work-arounds,\n * e.g. removing duplicates which appears to occur intermittently when the\n * native msneedkey event fires (i.e. event.initData contains dupes).\n *\n * @param {?Uint8Array} initData\n * @private\n * @return {?Uint8Array}\n */\nshaka.polyfill.PatchedMediaKeysMs.\n    NormaliseInitData_ = function(initData) {\n  if (!initData) {\n    return initData;\n  }\n\n  var pssh = new shaka.util.Pssh(initData);\n\n  // If there is only a single pssh, return the original array\n  if (pssh.dataBoundaries.length <= 1) {\n    return initData;\n  }\n\n  var unfilteredInitDatas = [];\n  for (var i = 0; i < pssh.dataBoundaries.length; i++) {\n    var currPssh = initData.subarray(\n        pssh.dataBoundaries[i].start,\n        pssh.dataBoundaries[i].end + 1); // end is exclusive, hence the +1\n\n    unfilteredInitDatas.push(currPssh);\n  }\n\n  // Dedupe psshData\n  var dedupedInitDatas = shaka.util.ArrayUtils.removeDuplicates(\n      unfilteredInitDatas,\n      shaka.polyfill.PatchedMediaKeysMs.compareInitDatas_);\n\n  var targetLength = 0;\n  for (var i = 0; i < dedupedInitDatas.length; i++) {\n    targetLength += dedupedInitDatas[i].length;\n  }\n\n  // Concat array of Uint8Arrays back into a single Uint8Array\n  var normalisedInitData = new Uint8Array(targetLength);\n  var offset = 0;\n  for (var i = 0; i < dedupedInitDatas.length; i++) {\n    normalisedInitData.set(dedupedInitDatas[i], offset);\n    offset += dedupedInitDatas[i].length;\n  }\n\n  return normalisedInitData;\n};\n\n\n/**\n * @param {!Uint8Array} initDataA\n * @param {!Uint8Array} initDataB\n * @return {boolean}\n * @private\n */\nshaka.polyfill.PatchedMediaKeysMs.compareInitDatas_ =\n    function(initDataA, initDataB) {\n  return shaka.util.Uint8ArrayUtils.equal(initDataA, initDataB);\n};\n\n\n/**\n * Handler for the native keymessage event on MSMediaKeySession.\n *\n * @param {!MediaKeyEvent} event\n * @private\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.\n    onMsKeyMessage_ = function(event) {\n  shaka.log.debug('PatchedMediaKeysMs.onMsKeyMessage_', event);\n\n  // We can now resolve this.generateRequestPromise (it should be non-null)\n  goog.asserts.assert(this.generateRequestPromise_,\n                      'generateRequestPromise_ not set in onMsKeyMessage_');\n  if (this.generateRequestPromise_) {\n    this.generateRequestPromise_.resolve();\n    this.generateRequestPromise_ = null;\n  }\n\n  var isNew = this.keyStatuses.getStatus() == undefined;\n\n  var event2 = new shaka.util.FakeEvent('message', {\n    messageType: isNew ? 'licenserequest' : 'licenserenewal',\n    message: event.message.buffer\n  });\n\n  this.dispatchEvent(event2);\n};\n\n\n/**\n * Handler for the native keyadded event on MSMediaKeySession.\n *\n * @param {!MediaKeyEvent} event\n * @private\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.\n    onMsKeyAdded_ = function(event) {\n  shaka.log.debug('PatchedMediaKeysMs.onMsKeyAdded_', event);\n\n  // PlayReady's concept of persistent licenses makes emulation difficult here.\n  // A license policy can say that the license persists, which causes the CDM to\n  // store it for use in a later session.  The result is that in IE11, the CDM\n  // fires 'mskeyadded' without ever firing 'mskeymessage'.\n  if (this.generateRequestPromise_) {\n    shaka.log.debug('Simulating completion for a PR persistent license.');\n    goog.asserts.assert(!this.updatePromise_,\n        'updatePromise_ and generateRequestPromise_ set in onMsKeyAdded_');\n    this.updateKeyStatus_('usable');\n    this.generateRequestPromise_.resolve();\n    this.generateRequestPromise_ = null;\n    return;\n  }\n\n  // We can now resolve this.updatePromise (it should be non-null)\n  goog.asserts.assert(this.updatePromise_,\n                      'updatePromise_ not set in onMsKeyAdded_');\n  if (this.updatePromise_) {\n    this.updateKeyStatus_('usable');\n    this.updatePromise_.resolve();\n    this.updatePromise_ = null;\n  }\n};\n\n\n/**\n * Handler for the native keyerror event on MSMediaKeySession.\n *\n * @param {!MediaKeyEvent} event\n * @private\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.\n    onMsKeyError_ = function(event) {\n  shaka.log.debug('PatchedMediaKeysMs.onMsKeyError_', event);\n\n  var error = new Error('EME PatchedMediaKeysMs key error');\n  error.errorCode = this.nativeMediaKeySession_.error;\n\n  if (this.generateRequestPromise_ != null) {\n    this.generateRequestPromise_.reject(error);\n    this.generateRequestPromise_ = null;\n  } else if (this.updatePromise_ != null) {\n    this.updatePromise_.reject(error);\n    this.updatePromise_ = null;\n  } else {\n    /*\n    Unexpected error - map native codes to standardised key statuses.\n    Possible values of this.nativeMediaKeySession_.error.code\n\n    MS_MEDIA_KEYERR_UNKNOWN        = 1\n    MS_MEDIA_KEYERR_CLIENT         = 2\n    MS_MEDIA_KEYERR_SERVICE        = 3\n    MS_MEDIA_KEYERR_OUTPUT         = 4\n    MS_MEDIA_KEYERR_HARDWARECHANGE = 5\n    MS_MEDIA_KEYERR_DOMAIN         = 6\n    */\n\n    switch (this.nativeMediaKeySession_.error.code) {\n      case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:\n      case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:\n        this.updateKeyStatus_('output-not-allowed');\n      default:\n        this.updateKeyStatus_('internal-error');\n    }\n  }\n};\n\n\n/**\n * Update key status and dispatch a 'keystatuseschange' event.\n *\n * @param {string} status\n * @private\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeySession.prototype.\n    updateKeyStatus_ = function(status) {\n  this.keyStatuses.setStatus(status);\n  var event = new shaka.util.FakeEvent('keystatuseschange');\n  this.dispatchEvent(event);\n};\n\n\n\n/**\n * An implementation of MediaKeyStatusMap.\n * This fakes a map with a single key ID.\n *\n * @constructor\n * @struct\n * @implements {MediaKeyStatusMap}\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap = function() {\n  /**\n   * @type {number}\n   */\n  this.size = 0;\n\n  /**\n   * @private {string|undefined}\n   */\n  this.status_ = undefined;\n};\n\n\n/**\n * @const {!ArrayBuffer}\n * @private\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.KEY_ID_;\n\n\n/**\n * An internal method used by the session to set key status.\n * @param {string|undefined} status\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.\n    setStatus = function(status) {\n  this.size = status == undefined ? 0 : 1;\n  this.status_ = status;\n};\n\n\n/**\n * An internal method used by the session to get key status.\n * @return {string|undefined}\n */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.\n    getStatus = function() {\n  return this.status_;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.\n    forEach = function(fn) {\n  if (this.status_) {\n    var fakeKeyId =\n        shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.KEY_ID_;\n    fn(this.status_, fakeKeyId);\n  }\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.\n    get = function(keyId) {\n  if (this.has(keyId)) {\n    return this.status_;\n  }\n  return undefined;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.\n    has = function(keyId) {\n  var fakeKeyId =\n      shaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.KEY_ID_;\n  if (this.status_ &&\n      shaka.util.Uint8ArrayUtils.equal(\n          new Uint8Array(keyId), new Uint8Array(fakeKeyId))) {\n    return true;\n  }\n  return false;\n};\n\n\n/** @suppress {missingReturn} */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.\n    entries = function() {\n  goog.asserts.assert(false, 'Not used!  Provided only for compiler.');\n};\n\n\n/** @suppress {missingReturn} */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.\n    keys = function() {\n  goog.asserts.assert(false, 'Not used!  Provided only for compiler.');\n};\n\n\n/** @suppress {missingReturn} */\nshaka.polyfill.PatchedMediaKeysMs.MediaKeyStatusMap.prototype.\n    values = function() {\n  goog.asserts.assert(false, 'Not used!  Provided only for compiler.');\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/patchedmediakeys_ms.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.PatchedMediaKeysNop');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\n\n\n/**\n * Install a polyfill to stub out {@link http://goo.gl/blgtZZ EME draft\n * 12 March 2015} on browsers without EME.  All methods will fail.\n */\nshaka.polyfill.PatchedMediaKeysNop.install = function() {\n  shaka.log.debug('PatchedMediaKeysNop.install');\n\n  // Alias.\n  var PatchedMediaKeysNop = shaka.polyfill.PatchedMediaKeysNop;\n\n  // Install patches.\n  navigator.requestMediaKeySystemAccess =\n      PatchedMediaKeysNop.requestMediaKeySystemAccess;\n  // Delete mediaKeys to work around strict mode compatibility issues.\n  delete HTMLMediaElement.prototype['mediaKeys'];\n  // Work around read-only declaration for mediaKeys by using a string.\n  HTMLMediaElement.prototype['mediaKeys'] = null;\n  HTMLMediaElement.prototype.setMediaKeys = PatchedMediaKeysNop.setMediaKeys;\n  // These are not usable, but allow Player.isBrowserSupported to pass.\n  window.MediaKeys = PatchedMediaKeysNop.MediaKeys;\n  window.MediaKeySystemAccess = PatchedMediaKeysNop.MediaKeySystemAccess;\n};\n\n\n/**\n * An implementation of navigator.requestMediaKeySystemAccess.\n * Retrieve a MediaKeySystemAccess object.\n *\n * @this {!Navigator}\n * @param {string} keySystem\n * @param {!Array.<!MediaKeySystemConfiguration>} supportedConfigurations\n * @return {!Promise.<!MediaKeySystemAccess>}\n */\nshaka.polyfill.PatchedMediaKeysNop.requestMediaKeySystemAccess =\n    function(keySystem, supportedConfigurations) {\n  shaka.log.debug('PatchedMediaKeysNop.requestMediaKeySystemAccess');\n  goog.asserts.assert(this == navigator,\n                      'bad \"this\" for requestMediaKeySystemAccess');\n\n\n  return Promise.reject(new Error(\n      'The key system specified is not supported.'));\n};\n\n\n/**\n * An implementation of HTMLMediaElement.prototype.setMediaKeys.\n * Attach a MediaKeys object to the media element.\n *\n * @this {!HTMLMediaElement}\n * @param {MediaKeys} mediaKeys\n * @return {!Promise}\n */\nshaka.polyfill.PatchedMediaKeysNop.setMediaKeys = function(mediaKeys) {\n  shaka.log.debug('PatchedMediaKeysNop.setMediaKeys');\n  goog.asserts.assert(this instanceof HTMLMediaElement,\n                      'bad \"this\" for setMediaKeys');\n\n  if (mediaKeys == null) {\n    return Promise.resolve();\n  }\n\n  return Promise.reject(new Error('MediaKeys not supported.'));\n};\n\n\n\n/**\n * An unusable constructor for MediaKeys.\n * @constructor\n * @struct\n * @implements {MediaKeys}\n */\nshaka.polyfill.PatchedMediaKeysNop.MediaKeys = function() {\n  throw new TypeError('Illegal constructor.');\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysNop.MediaKeys.prototype.createSession =\n    function() {};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysNop.MediaKeys.prototype.setServerCertificate =\n    function() {};\n\n\n\n/**\n * An unusable constructor for MediaKeySystemAccess.\n * @constructor\n * @struct\n * @implements {MediaKeySystemAccess}\n */\nshaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess = function() {\n  throw new TypeError('Illegal constructor.');\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess.prototype.\n    getConfiguration = function() {};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess.prototype.\n    createMediaKeys = function() {};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess.prototype.\n    keySystem;\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/patchedmediakeys_nop.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.PatchedMediaKeysWebkit');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.util.EventManager');\ngoog.require('shaka.util.FakeEvent');\ngoog.require('shaka.util.FakeEventTarget');\ngoog.require('shaka.util.PublicPromise');\ngoog.require('shaka.util.StringUtils');\ngoog.require('shaka.util.Uint8ArrayUtils');\n\n\n/**\n * Store api prefix.\n *\n * @private {string}\n */\nshaka.polyfill.PatchedMediaKeysWebkit.prefix_ = '';\n\n\n/**\n * Install a polyfill to implement {@link http://goo.gl/blgtZZ EME draft\n * 12 March 2015} on top of webkit-prefixed\n * {@link http://goo.gl/FSpoAo EME v0.1b}.\n *\n * @param {string} prefix\n */\nshaka.polyfill.PatchedMediaKeysWebkit.install = function(prefix) {\n  shaka.log.debug('PatchedMediaKeysWebkit.install');\n\n  // Alias.\n  var PatchedMediaKeysWebkit = shaka.polyfill.PatchedMediaKeysWebkit;\n  PatchedMediaKeysWebkit.prefix_ = prefix;\n  var prefixApi = PatchedMediaKeysWebkit.prefixApi_;\n\n  goog.asserts.assert(\n      HTMLMediaElement.prototype[prefixApi('generateKeyRequest')],\n                      'PatchedMediaKeysWebkit APIs not available!');\n\n  // Construct fake key ID.  This is not done at load-time to avoid exceptions\n  // on unsupported browsers.  This particular fake key ID was suggested in\n  // w3c/encrypted-media#32.\n  PatchedMediaKeysWebkit.MediaKeyStatusMap.KEY_ID_ =\n      (new Uint8Array([0])).buffer;\n\n  // Install patches.\n  navigator.requestMediaKeySystemAccess =\n      PatchedMediaKeysWebkit.requestMediaKeySystemAccess;\n  // Delete mediaKeys to work around strict mode compatibility issues.\n  delete HTMLMediaElement.prototype['mediaKeys'];\n  // Work around read-only declaration for mediaKeys by using a string.\n  HTMLMediaElement.prototype['mediaKeys'] = null;\n  HTMLMediaElement.prototype.setMediaKeys = PatchedMediaKeysWebkit.setMediaKeys;\n  window.MediaKeys = PatchedMediaKeysWebkit.MediaKeys;\n  window.MediaKeySystemAccess = PatchedMediaKeysWebkit.MediaKeySystemAccess;\n};\n\n\n/**\n * Prefix api by stored prefix.\n *\n * @param {string} api\n * @return {string}\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.prefixApi_ = function(api) {\n  var prefix = shaka.polyfill.PatchedMediaKeysWebkit.prefix_;\n  if (prefix) {\n    return prefix + api.charAt(0).toUpperCase() + api.slice(1);\n  }\n  return api;\n};\n\n\n/**\n * An implementation of navigator.requestMediaKeySystemAccess.\n * Retrieve a MediaKeySystemAccess object.\n *\n * @this {!Navigator}\n * @param {string} keySystem\n * @param {!Array.<!MediaKeySystemConfiguration>} supportedConfigurations\n * @return {!Promise.<!MediaKeySystemAccess>}\n */\nshaka.polyfill.PatchedMediaKeysWebkit.requestMediaKeySystemAccess =\n    function(keySystem, supportedConfigurations) {\n  shaka.log.debug('PatchedMediaKeysWebkit.requestMediaKeySystemAccess');\n  goog.asserts.assert(this == navigator,\n                      'bad \"this\" for requestMediaKeySystemAccess');\n\n  // Alias.\n  var PatchedMediaKeysWebkit = shaka.polyfill.PatchedMediaKeysWebkit;\n  try {\n    var access = new PatchedMediaKeysWebkit.MediaKeySystemAccess(\n        keySystem, supportedConfigurations);\n    return Promise.resolve(/** @type {!MediaKeySystemAccess} */ (access));\n  } catch (exception) {\n    return Promise.reject(exception);\n  }\n};\n\n\n/**\n * An implementation of HTMLMediaElement.prototype.setMediaKeys.\n * Attach a MediaKeys object to the media element.\n *\n * @this {!HTMLMediaElement}\n * @param {MediaKeys} mediaKeys\n * @return {!Promise}\n */\nshaka.polyfill.PatchedMediaKeysWebkit.setMediaKeys = function(mediaKeys) {\n  shaka.log.debug('PatchedMediaKeysWebkit.setMediaKeys');\n  goog.asserts.assert(this instanceof HTMLMediaElement,\n                      'bad \"this\" for setMediaKeys');\n\n  // Alias.\n  var PatchedMediaKeysWebkit = shaka.polyfill.PatchedMediaKeysWebkit;\n\n  var newMediaKeys =\n      /** @type {shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys} */ (\n          mediaKeys);\n  var oldMediaKeys =\n      /** @type {shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys} */ (\n          this.mediaKeys);\n\n  if (oldMediaKeys && oldMediaKeys != newMediaKeys) {\n    goog.asserts.assert(\n        oldMediaKeys instanceof PatchedMediaKeysWebkit.MediaKeys,\n        'non-polyfill instance of oldMediaKeys');\n    // Have the old MediaKeys stop listening to events on the video tag.\n    oldMediaKeys.setMedia(null);\n  }\n\n  delete this['mediaKeys'];  // in case there is an existing getter\n  this['mediaKeys'] = mediaKeys;  // work around read-only declaration\n\n  if (newMediaKeys) {\n    goog.asserts.assert(\n        newMediaKeys instanceof PatchedMediaKeysWebkit.MediaKeys,\n        'non-polyfill instance of newMediaKeys');\n    newMediaKeys.setMedia(this);\n  }\n\n  return Promise.resolve();\n};\n\n\n/**\n * For some of this polyfill's implementation, we need to query a video element.\n * But for some embedded systems, it is memory-expensive to create multiple\n * video elements.  Therefore, we check the document to see if we can borrow one\n * to query before we fall back to creating one temporarily.\n *\n * @return {!HTMLVideoElement}\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.getVideoElement_ = function() {\n  var videos = document.getElementsByTagName('video');\n  var tmpVideo = videos.length ? videos[0] : document.createElement('video');\n  return /** @type {!HTMLVideoElement} */(tmpVideo);\n};\n\n\n\n/**\n * An implementation of MediaKeySystemAccess.\n *\n * @constructor\n * @struct\n * @param {string} keySystem\n * @param {!Array.<!MediaKeySystemConfiguration>} supportedConfigurations\n * @implements {MediaKeySystemAccess}\n * @throws {Error} if the key system is not supported.\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess =\n    function(keySystem, supportedConfigurations) {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySystemAccess');\n\n  /** @type {string} */\n  this.keySystem = keySystem;\n\n  /** @private {string} */\n  this.internalKeySystem_ = keySystem;\n\n  /** @private {!MediaKeySystemConfiguration} */\n  this.configuration_;\n\n  // This is only a guess, since we don't really know from the prefixed API.\n  var allowPersistentState = true;\n\n  if (keySystem == 'org.w3.clearkey') {\n    // ClearKey's string must be prefixed in v0.1b.\n    this.internalKeySystem_ = 'webkit-org.w3.clearkey';\n    // ClearKey doesn't support persistence.\n    allowPersistentState = false;\n  }\n\n  var success = false;\n  var tmpVideo = shaka.polyfill.PatchedMediaKeysWebkit.getVideoElement_();\n  for (var i = 0; i < supportedConfigurations.length; ++i) {\n    var cfg = supportedConfigurations[i];\n\n    // Create a new config object and start adding in the pieces which we\n    // find support for.  We will return this from getConfiguration() if\n    // asked.\n    /** @type {!MediaKeySystemConfiguration} */\n    var newCfg = {\n      'audioCapabilities': [],\n      'videoCapabilities': [],\n      // It is technically against spec to return these as optional, but we\n      // don't truly know their values from the prefixed API:\n      'persistentState': 'optional',\n      'distinctiveIdentifier': 'optional',\n      // Pretend the requested init data types are supported, since we don't\n      // really know that either:\n      'initDataTypes': cfg.initDataTypes,\n      'sessionTypes': ['temporary'],\n      'label': cfg.label\n    };\n\n    // v0.1b tests for key system availability with an extra argument on\n    // canPlayType.\n    var ranAnyTests = false;\n    if (cfg.audioCapabilities) {\n      for (var j = 0; j < cfg.audioCapabilities.length; ++j) {\n        var cap = cfg.audioCapabilities[j];\n        if (cap.contentType) {\n          ranAnyTests = true;\n          // In Chrome <= 40, if you ask about Widevine-encrypted audio support,\n          // you get a false-negative when you specify codec information.\n          // Work around this by stripping codec info for audio types.\n          var contentType = cap.contentType.split(';')[0];\n          if (tmpVideo.canPlayType(contentType, this.internalKeySystem_)) {\n            newCfg.audioCapabilities.push(cap);\n            success = true;\n          }\n        }\n      }\n    }\n    if (cfg.videoCapabilities) {\n      for (var j = 0; j < cfg.videoCapabilities.length; ++j) {\n        var cap = cfg.videoCapabilities[j];\n        if (cap.contentType) {\n          ranAnyTests = true;\n          if (tmpVideo.canPlayType(cap.contentType, this.internalKeySystem_)) {\n            newCfg.videoCapabilities.push(cap);\n            success = true;\n          }\n        }\n      }\n    }\n\n    if (!ranAnyTests) {\n      // If no specific types were requested, we check all common types to find\n      // out if the key system is present at all.\n      success = tmpVideo.canPlayType('video/mp4', this.internalKeySystem_) ||\n                tmpVideo.canPlayType('video/webm', this.internalKeySystem_);\n    }\n    if (cfg.persistentState == 'required') {\n      if (allowPersistentState) {\n        newCfg.persistentState = 'required';\n        newCfg.sessionTypes = ['persistent-license'];\n      } else {\n        success = false;\n      }\n    }\n\n    if (success) {\n      this.configuration_ = newCfg;\n      return;\n    }\n  }  // for each cfg in supportedConfigurations\n\n  var message = 'Unsupported keySystem';\n  if (keySystem == 'org.w3.clearkey' || keySystem == 'com.widevine.alpha') {\n    message = 'None of the requested configurations were supported.';\n  }\n  var unsupportedError = new Error(message);\n  unsupportedError.name = 'NotSupportedError';\n  unsupportedError.code = DOMException.NOT_SUPPORTED_ERR;\n  throw unsupportedError;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.\n    createMediaKeys = function() {\n  shaka.log.debug(\n      'PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys');\n\n  // Alias.\n  var PatchedMediaKeysWebkit = shaka.polyfill.PatchedMediaKeysWebkit;\n  var mediaKeys = new PatchedMediaKeysWebkit.MediaKeys(this.internalKeySystem_);\n  return Promise.resolve(/** @type {!MediaKeys} */ (mediaKeys));\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.\n    getConfiguration = function() {\n  shaka.log.debug(\n      'PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration');\n  return this.configuration_;\n};\n\n\n\n/**\n * An implementation of MediaKeys.\n *\n * @constructor\n * @struct\n * @param {string} keySystem\n * @implements {MediaKeys}\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeys = function(keySystem) {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeys');\n\n  /** @private {string} */\n  this.keySystem_ = keySystem;\n\n  /** @private {HTMLMediaElement} */\n  this.media_ = null;\n\n  /** @private {!shaka.util.EventManager} */\n  this.eventManager_ = new shaka.util.EventManager();\n\n  /**\n   * @private {!Array.<!shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession>}\n   */\n  this.newSessions_ = [];\n\n  /**\n   * @private {!Object.<string,\n   *                    !shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession>}\n   */\n  this.sessionMap_ = {};\n};\n\n\n/**\n * @param {HTMLMediaElement} media\n * @protected\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setMedia =\n    function(media) {\n  this.media_ = media;\n\n  // Remove any old listeners.\n  this.eventManager_.removeAll();\n\n  var prefix = shaka.polyfill.PatchedMediaKeysWebkit.prefix_;\n  if (media) {\n    // Intercept and translate these prefixed EME events.\n    this.eventManager_.listen(media, prefix + 'needkey',\n        /** @type {shaka.util.EventManager.ListenerType} */ (\n            this.onWebkitNeedKey_.bind(this)));\n\n    this.eventManager_.listen(media, prefix + 'keymessage',\n        /** @type {shaka.util.EventManager.ListenerType} */ (\n            this.onWebkitKeyMessage_.bind(this)));\n\n    this.eventManager_.listen(media, prefix + 'keyadded',\n        /** @type {shaka.util.EventManager.ListenerType} */ (\n            this.onWebkitKeyAdded_.bind(this)));\n\n    this.eventManager_.listen(media, prefix + 'keyerror',\n        /** @type {shaka.util.EventManager.ListenerType} */ (\n            this.onWebkitKeyError_.bind(this)));\n  }\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.createSession =\n    function(opt_sessionType) {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeys.createSession');\n\n  var sessionType = opt_sessionType || 'temporary';\n  // TODO: Consider adding support for persistent-release once Chrome has\n  // implemented it natively.  http://crbug.com/448888\n  // This is a non-issue if we've deprecated the polyfill by then, since\n  // prefixed EME is on its way out.\n  if (sessionType != 'temporary' && sessionType != 'persistent-license') {\n    throw new TypeError('Session type ' + opt_sessionType +\n                        ' is unsupported on this platform.');\n  }\n\n  // Alias.\n  var PatchedMediaKeysWebkit = shaka.polyfill.PatchedMediaKeysWebkit;\n\n  // Unprefixed EME allows for session creation without a video tag or src.\n  // Prefixed EME requires both a valid HTMLMediaElement and a src.\n  var media = this.media_ || /** @type {!HTMLMediaElement} */(\n      document.createElement('video'));\n  if (!media.src) media.src = 'about:blank';\n\n  var session = new PatchedMediaKeysWebkit.MediaKeySession(\n      media, this.keySystem_, sessionType);\n  this.newSessions_.push(session);\n  return session;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setServerCertificate =\n    function(serverCertificate) {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeys.setServerCertificate');\n\n  // There is no equivalent in v0.1b, so return failure.\n  return Promise.resolve(false);\n};\n\n\n/**\n * @param {!MediaKeyEvent} event\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitNeedKey_ =\n    function(event) {\n  shaka.log.debug('PatchedMediaKeysWebkit.onWebkitNeedKey_', event);\n  goog.asserts.assert(this.media_, 'media_ not set in onWebkitNeedKey_');\n\n  var event2 = document.createEvent('CustomEvent');\n  event2.initCustomEvent('encrypted', false, false, null);\n\n  // not used by v0.1b EME, but given a valid value\n  event2.initDataType = 'webm';\n  event2.initData = event.initData;\n\n  this.media_.dispatchEvent(event2);\n};\n\n\n/**\n * @param {!MediaKeyEvent} event\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyMessage_ =\n    function(event) {\n  shaka.log.debug('PatchedMediaKeysWebkit.onWebkitKeyMessage_', event);\n\n  var session = this.findSession_(event.sessionId);\n  if (!session) {\n    shaka.log.error('Session not found', event.sessionId);\n    return;\n  }\n\n  var isNew = session.keyStatuses.getStatus() == undefined;\n\n  var event2 = new shaka.util.FakeEvent('message', {\n    messageType: isNew ? 'licenserequest' : 'licenserenewal',\n    message: event.message\n  });\n\n  session.generated();\n  session.dispatchEvent(event2);\n};\n\n\n/**\n * @param {!MediaKeyEvent} event\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyAdded_ =\n    function(event) {\n  shaka.log.debug('PatchedMediaKeysWebkit.onWebkitKeyAdded_', event);\n\n  var session = this.findSession_(event.sessionId);\n  goog.asserts.assert(session, 'unable to find session in onWebkitKeyAdded_');\n  if (session) {\n    session.ready();\n  }\n};\n\n\n/**\n * @param {!MediaKeyEvent} event\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyError_ =\n    function(event) {\n  shaka.log.debug('PatchedMediaKeysWebkit.onWebkitKeyError_', event);\n\n  var session = this.findSession_(event.sessionId);\n  goog.asserts.assert(session, 'unable to find session in onWebkitKeyError_');\n  if (session) {\n    session.handleError(event);\n  }\n};\n\n\n/**\n * @param {string} sessionId\n * @return {shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession}\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.findSession_ =\n    function(sessionId) {\n  var session = this.sessionMap_[sessionId];\n  if (session) {\n    shaka.log.debug('PatchedMediaKeysWebkit.MediaKeys.findSession_', session);\n    return session;\n  }\n\n  session = this.newSessions_.shift();\n  if (session) {\n    session.sessionId = sessionId;\n    this.sessionMap_[sessionId] = session;\n    shaka.log.debug('PatchedMediaKeysWebkit.MediaKeys.findSession_', session);\n    return session;\n  }\n\n  return null;\n};\n\n\n\n/**\n * An implementation of MediaKeySession.\n *\n * @param {!HTMLMediaElement} media\n * @param {string} keySystem\n * @param {string} sessionType\n *\n * @constructor\n * @struct\n * @implements {MediaKeySession}\n * @extends {shaka.util.FakeEventTarget}\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession =\n    function(media, keySystem, sessionType) {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySession');\n  shaka.util.FakeEventTarget.call(this);\n\n  /** @private {!HTMLMediaElement} */\n  this.media_ = media;\n\n  /** @private {boolean} */\n  this.initialized_ = false;\n\n  /** @private {shaka.util.PublicPromise} */\n  this.generatePromise_ = null;\n\n  /** @private {shaka.util.PublicPromise} */\n  this.updatePromise_ = null;\n\n  /** @private {string} */\n  this.keySystem_ = keySystem;\n\n  /** @private {string} */\n  this.type_ = sessionType;\n\n  /** @type {string} */\n  this.sessionId = '';\n\n  /** @type {number} */\n  this.expiration = NaN;\n\n  /** @type {!shaka.util.PublicPromise} */\n  this.closed = new shaka.util.PublicPromise();\n\n  /** @type {!MediaKeyStatusMap} */\n  this.keyStatuses =\n      new shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap();\n};\ngoog.inherits(shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession,\n              shaka.util.FakeEventTarget);\n\n\n/**\n * Signals that the license request has been generated.  This resolves the\n * 'generateRequest' promise.\n *\n * @protected\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generated =\n    function() {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySession.generated');\n\n  if (this.generatePromise_) {\n    this.generatePromise_.resolve();\n    this.generatePromise_ = null;\n  }\n};\n\n\n/**\n * Signals that the session is 'ready', which is the terminology used in older\n * versions of EME.  The new signal is to resolve the 'update' promise.  This\n * translates between the two.\n *\n * @protected\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.ready =\n    function() {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySession.ready');\n\n  this.updateKeyStatus_('usable');\n\n  if (this.updatePromise_) {\n    this.updatePromise_.resolve();\n  }\n  this.updatePromise_ = null;\n};\n\n\n/**\n * Either rejects a promise, or dispatches an error event, as appropriate.\n *\n * @param {!MediaKeyEvent} event\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.handleError =\n    function(event) {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySession.handleError', event);\n\n  // This does not match the DOMException we get in current WD EME, but it will\n  // at least provide some information which can be used to look into the\n  // problem.\n  var error = new Error('EME v0.1b key error');\n  error.errorCode = event.errorCode;\n  error.errorCode.systemCode = event.systemCode;\n\n  // The presence or absence of sessionId indicates whether this corresponds to\n  // generateRequest() or update().\n  if (!event.sessionId && this.generatePromise_) {\n    error.method = 'generateRequest';\n    if (event.systemCode == 45) {\n      error.message = 'Unsupported session type.';\n    }\n    this.generatePromise_.reject(error);\n    this.generatePromise_ = null;\n  } else if (event.sessionId && this.updatePromise_) {\n    error.method = 'update';\n    this.updatePromise_.reject(error);\n    this.updatePromise_ = null;\n  } else {\n    // This mapping of key statuses is imperfect at best.\n    var code = event.errorCode.code;\n    var systemCode = event.systemCode;\n    if (code == MediaKeyError['MEDIA_KEYERR_OUTPUT']) {\n      this.updateKeyStatus_('output-restricted');\n    } else if (systemCode == 1) {\n      this.updateKeyStatus_('expired');\n    } else {\n      this.updateKeyStatus_('internal-error');\n    }\n  }\n};\n\n\n/**\n * Logic which is shared between generateRequest() and load(), both of which\n * are ultimately implemented with webkitGenerateKeyRequest in prefixed EME.\n *\n * @param {?BufferSource} initData\n * @param {?string} offlineSessionId\n * @return {!Promise}\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generate_ =\n    function(initData, offlineSessionId) {\n  if (this.initialized_) {\n    return Promise.reject(new Error('The session is already initialized.'));\n  }\n\n  this.initialized_ = true;\n\n  /** @type {!Uint8Array} */\n  var mangledInitData;\n\n  try {\n    if (this.type_ == 'persistent-license') {\n      var StringUtils = shaka.util.StringUtils;\n      if (!offlineSessionId) {\n        // Persisting the initial license.\n        // Prefix the init data with a tag to indicate persistence.\n        var prefix = StringUtils.toUTF8('PERSISTENT|');\n        var result = new Uint8Array(prefix.byteLength + initData.byteLength);\n        result.set(new Uint8Array(prefix), 0);\n        result.set(new Uint8Array(initData), prefix.byteLength);\n        mangledInitData = result;\n      } else {\n        // Loading a stored license.\n        // Prefix the init data (which is really a session ID) with a tag to\n        // indicate that we are loading a persisted session.\n        mangledInitData = new Uint8Array(\n            StringUtils.toUTF8('LOAD_SESSION|' + offlineSessionId));\n      }\n    } else {\n      // Streaming.\n      goog.asserts.assert(this.type_ == 'temporary',\n                          'expected temporary session');\n      goog.asserts.assert(!offlineSessionId,\n                          'unexpected offline session ID');\n      mangledInitData = new Uint8Array(initData);\n    }\n\n    goog.asserts.assert(mangledInitData,\n                        'init data not set!');\n  } catch (exception) {\n    return Promise.reject(exception);\n  }\n\n  goog.asserts.assert(this.generatePromise_ == null,\n                      'generatePromise_ should be null');\n  this.generatePromise_ = new shaka.util.PublicPromise();\n\n  // Because we are hacking media.src in createSession to better emulate\n  // unprefixed EME's ability to create sessions and license requests without a\n  // video tag, we can get ourselves into trouble.  It seems that sometimes,\n  // the setting of media.src hasn't been processed by some other thread, and\n  // GKR can throw an exception.  If this occurs, wait 10 ms and try again at\n  // most once.  This situation should only occur when init data is available\n  // ahead of the 'needkey' event.\n\n  var prefixApi = shaka.polyfill.PatchedMediaKeysWebkit.prefixApi_;\n  var generateKeyRequestName = prefixApi('generateKeyRequest');\n  try {\n    this.media_[generateKeyRequestName](this.keySystem_, mangledInitData);\n  } catch (exception) {\n    if (exception.name != 'InvalidStateError') {\n      this.generatePromise_ = null;\n      return Promise.reject(exception);\n    }\n\n    setTimeout(function() {\n      try {\n        this.media_[generateKeyRequestName](this.keySystem_, mangledInitData);\n      } catch (exception) {\n        this.generatePromise_.reject(exception);\n        this.generatePromise_ = null;\n      }\n    }.bind(this), 10);\n  }\n\n  return this.generatePromise_;\n};\n\n\n/**\n * An internal version of update which defers new calls while old ones are in\n * progress.\n *\n * @param {!shaka.util.PublicPromise} promise  The promise associated with this\n *   call.\n * @param {?BufferSource} response\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update_ =\n    function(promise, response) {\n  if (this.updatePromise_) {\n    // We already have an update in-progress, so defer this one until after the\n    // old one is resolved.  Execute this whether the original one succeeds or\n    // fails.\n    this.updatePromise_.then(\n        this.update_.bind(this, promise, response)\n    ).catch(\n        this.update_.bind(this, promise, response)\n    );\n    return;\n  }\n\n  this.updatePromise_ = promise;\n\n  var key;\n  var keyId;\n\n  if (this.keySystem_ == 'webkit-org.w3.clearkey') {\n    // The current EME version of clearkey wants a structured JSON response.\n    // The v0.1b version wants just a raw key.  Parse the JSON response and\n    // extract the key and key ID.\n    var StringUtils = shaka.util.StringUtils;\n    var Uint8ArrayUtils = shaka.util.Uint8ArrayUtils;\n    var licenseString = StringUtils.fromUTF8(response);\n    var jwkSet = /** @type {JWKSet} */ (JSON.parse(licenseString));\n    var kty = jwkSet.keys[0].kty;\n    if (kty != 'oct') {\n      // Reject the promise.\n      var error = new Error('Response is not a valid JSON Web Key Set.');\n      this.updatePromise_.reject(error);\n      this.updatePromise_ = null;\n    }\n    key = Uint8ArrayUtils.fromBase64(jwkSet.keys[0].k);\n    keyId = Uint8ArrayUtils.fromBase64(jwkSet.keys[0].kid);\n  } else {\n    // The key ID is not required.\n    key = new Uint8Array(response);\n    keyId = null;\n  }\n\n  var prefixApi = shaka.polyfill.PatchedMediaKeysWebkit.prefixApi_;\n  var addKeyName = prefixApi('addKey');\n  try {\n    this.media_[addKeyName](this.keySystem_, key, keyId, this.sessionId);\n  } catch (exception) {\n    // Reject the promise.\n    this.updatePromise_.reject(exception);\n    this.updatePromise_ = null;\n  }\n};\n\n\n/**\n * Update key status and dispatch a 'keystatuseschange' event.\n *\n * @param {string} status\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.\n    updateKeyStatus_ = function(status) {\n  this.keyStatuses.setStatus(status);\n  var event = new shaka.util.FakeEvent('keystatuseschange');\n  this.dispatchEvent(event);\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.\n    generateRequest = function(initDataType, initData) {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySession.generateRequest');\n  return this.generate_(initData, null);\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.load =\n    function(sessionId) {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySession.load');\n  if (this.type_ == 'persistent-license') {\n    return this.generate_(null, sessionId);\n  } else {\n    return Promise.reject(new Error('Not a persistent session.'));\n  }\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update =\n    function(response) {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySession.update', response);\n  goog.asserts.assert(this.sessionId, 'update without session ID');\n\n  var nextUpdatePromise = new shaka.util.PublicPromise();\n  this.update_(nextUpdatePromise, response);\n  return nextUpdatePromise;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.close =\n    function() {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySession.close');\n\n  // This will remove a persistent session, but it's also the only way to\n  // free CDM resources on v0.1b.\n  if (this.type_ != 'persistent-license') {\n    // sessionId may reasonably be null if no key request has been generated\n    // yet.  Unprefixed EME will return a rejected promise in this case.\n    // We will use the same error message that Chrome 41 uses in its EME\n    // implementation.\n    if (!this.sessionId) {\n      this.closed.reject(new Error('The session is not callable.'));\n      return this.closed;\n    }\n\n    // This may throw an exception, but we ignore it because we are only using\n    // it to clean up resources in v0.1b.  We still consider the session closed.\n    // We can't let the exception propagate because MediaKeySession.close()\n    // should not throw.\n    var prefixApi = shaka.polyfill.PatchedMediaKeysWebkit.prefixApi_;\n    var cancelKeyRequestName = prefixApi('cancelKeyRequest');\n    try {\n      this.media_[cancelKeyRequestName](this.keySystem_, this.sessionId);\n    } catch (exception) {}\n  }\n\n  // Resolve the 'closed' promise and return it.\n  this.closed.resolve();\n  return this.closed;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.remove =\n    function() {\n  shaka.log.debug('PatchedMediaKeysWebkit.MediaKeySession.remove');\n\n  if (this.type_ != 'persistent-license') {\n    return Promise.reject(new Error('Not a persistent session.'));\n  }\n\n  return this.close();\n};\n\n\n\n/**\n * An implementation of MediaKeyStatusMap.\n * This fakes a map with a single key ID.\n *\n * @constructor\n * @struct\n * @implements {MediaKeyStatusMap}\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap = function() {\n  /**\n   * @type {number}\n   */\n  this.size = 0;\n\n  /**\n   * @private {string|undefined}\n   */\n  this.status_ = undefined;\n};\n\n\n/**\n * @const {!ArrayBuffer}\n * @private\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.KEY_ID_;\n\n\n/**\n * An internal method used by the session to set key status.\n * @param {string|undefined} status\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.setStatus =\n    function(status) {\n  this.size = status == undefined ? 0 : 1;\n  this.status_ = status;\n};\n\n\n/**\n * An internal method used by the session to get key status.\n * @return {string|undefined}\n */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.getStatus =\n    function() {\n  return this.status_;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.forEach =\n    function(fn) {\n  if (this.status_) {\n    var fakeKeyId =\n        shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.KEY_ID_;\n    fn(this.status_, fakeKeyId);\n  }\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.get =\n    function(keyId) {\n  if (this.has(keyId)) {\n    return this.status_;\n  }\n  return undefined;\n};\n\n\n/** @override */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.has =\n    function(keyId) {\n  var fakeKeyId =\n      shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.KEY_ID_;\n  if (this.status_ &&\n      shaka.util.Uint8ArrayUtils.equal(\n          new Uint8Array(keyId), new Uint8Array(fakeKeyId))) {\n    return true;\n  }\n  return false;\n};\n\n\n/** @suppress {missingReturn} */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.\n    entries = function() {\n  goog.asserts.assert(false, 'Not used!  Provided only for compiler.');\n};\n\n\n/** @suppress {missingReturn} */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.\n    keys = function() {\n  goog.asserts.assert(false, 'Not used!  Provided only for compiler.');\n};\n\n\n/** @suppress {missingReturn} */\nshaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.\n    values = function() {\n  goog.asserts.assert(false, 'Not used!  Provided only for compiler.');\n};\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/patchedmediakeys_webkit.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.MediaKeys');\n\ngoog.require('shaka.log');\ngoog.require('shaka.polyfill.PatchedMediaKeysMs');\ngoog.require('shaka.polyfill.PatchedMediaKeysNop');\ngoog.require('shaka.polyfill.PatchedMediaKeysWebkit');\ngoog.require('shaka.polyfill.register');\n\n\n/**\n * @namespace shaka.polyfill.MediaKeys\n *\n * @summary A polyfill to unify EME APIs across browser versions.\n *\n * The {@link https://w3c.github.io/encrypted-media/ EME spec} is still a\n * work-in-progress.  As such, we need to provide a consistent API to the Shaka\n * Player.  Until the spec is completely stable, the API provided by this\n * polyfill may lag behind the latest spec developments.\n */\n\n\n/**\n * Install the polyfill if needed.\n */\nshaka.polyfill.MediaKeys.install = function() {\n  shaka.log.debug('MediaKeys.install');\n\n  if (!window.HTMLVideoElement) {\n    // Avoid errors on very old browsers.\n    return;\n  }\n\n  if (navigator.requestMediaKeySystemAccess &&\n      MediaKeySystemAccess.prototype.getConfiguration) {\n    shaka.log.info('Using native EME as-is.');\n  } else if (HTMLMediaElement.prototype.webkitGenerateKeyRequest) {\n    shaka.log.info('Using webkit-prefixed EME v0.1b');\n    shaka.polyfill.PatchedMediaKeysWebkit.install('webkit');\n  } else if (HTMLMediaElement.prototype.generateKeyRequest) {\n    shaka.log.info('Using nonprefixed EME v0.1b');\n    shaka.polyfill.PatchedMediaKeysWebkit.install('');\n  } else if (window.MSMediaKeys) {\n    shaka.log.info('Using ms-prefixed EME v20140218');\n    shaka.polyfill.PatchedMediaKeysMs.install();\n  } else {\n    shaka.log.info('EME not available.');\n    shaka.polyfill.PatchedMediaKeysNop.install();\n  }\n};\n\n\nshaka.polyfill.register(shaka.polyfill.MediaKeys.install);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/mediakeys.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.MediaSource');\n\ngoog.require('shaka.log');\ngoog.require('shaka.polyfill.register');\n\n\n/**\n * @namespace shaka.polyfill.MediaSource\n *\n * @summary A polyfill to patch MSE bugs.\n */\n\n\n/**\n * Install the polyfill if needed.\n */\nshaka.polyfill.MediaSource.install = function() {\n  shaka.log.debug('MediaSource.install');\n\n  if (!window.MediaSource) {\n    shaka.log.info('No MSE implementation available.');\n    return;\n  }\n\n  // Detection is complicated by the fact that Safari does not expose\n  // SourceBuffer on window.  So we can't detect missing features by accessing\n  // SourceBuffer.prototype.  That is why we use navigator to detect Safari and\n  // particular versions of it.\n  var vendor = navigator.vendor;\n  var version = navigator.appVersion;\n  if (!vendor || !version || vendor.indexOf('Apple') < 0) {\n    shaka.log.info('Using native MSE as-is.');\n    return;\n  }\n\n  if (version.indexOf('Version/8') >= 0) {\n    // Safari 8 does not implement appendWindowEnd.  If we ignore the\n    // incomplete MSE implementation, some content (especially multi-period)\n    // will fail to play correctly.  The best we can do is blacklist Safari 8.\n    shaka.log.info('Blacklisting Safari 8 MSE.');\n    shaka.polyfill.MediaSource.blacklist_();\n  } else if (version.indexOf('Version/9') >= 0) {\n    shaka.log.info('Patching Safari 9 MSE bugs.');\n    // Safari 9 does not correctly implement abort() on SourceBuffer.\n    // Calling abort() causes a decoder failure, rather than resetting the\n    // decode timestamp as called for by the spec.\n    // Bug filed: http://goo.gl/UZ2rPp\n    shaka.polyfill.MediaSource.stubAbort_();\n  } else if (version.indexOf('Version/10') >= 0) {\n    shaka.log.info('Patching Safari 10 MSE bugs.');\n    // Safari 10 does not correctly implement abort() on SourceBuffer.\n    // Calling abort() before appending a segment causes that segment to be\n    // incomplete in buffer.\n    // Bug filed: https://goo.gl/rC3CLj\n    shaka.polyfill.MediaSource.stubAbort_();\n    // Safari 10 fires spurious 'updateend' events after endOfStream().\n    // Bug filed: https://goo.gl/qCeTZr\n    shaka.polyfill.MediaSource.patchEndOfStreamEvents_();\n  } else {\n    shaka.log.info('Using native MSE as-is.');\n  }\n};\n\n\n/**\n * Blacklist the current browser by making MediaSourceEngine.isBrowserSupported\n * fail later.\n *\n * @private\n */\nshaka.polyfill.MediaSource.blacklist_ = function() {\n  window['MediaSource'] = null;\n};\n\n\n/**\n * Stub out abort().  On some buggy MSE implementations, calling abort() causes\n * various problems.\n *\n * @private\n */\nshaka.polyfill.MediaSource.stubAbort_ = function() {\n  var addSourceBuffer = MediaSource.prototype.addSourceBuffer;\n  MediaSource.prototype.addSourceBuffer = function() {\n    var sourceBuffer = addSourceBuffer.apply(this, arguments);\n    sourceBuffer.abort = function() {};  // Stub out for buggy implementations.\n    return sourceBuffer;\n  };\n};\n\n\n/**\n * Patch endOfStream() to get rid of 'updateend' events that should not fire.\n * These extra events confuse MediaSourceEngine, which relies on correct events\n * to manage SourceBuffer state.\n *\n * @private\n */\nshaka.polyfill.MediaSource.patchEndOfStreamEvents_ = function() {\n  var endOfStream = MediaSource.prototype.endOfStream;\n  MediaSource.prototype.endOfStream = function() {\n    // This bug manifests only when endOfStream() results in the truncation\n    // of the MediaSource's duration.  So first we must calculate what the\n    // new duration will be.\n    var newDuration = 0;\n    for (var i = 0; i < this.sourceBuffers.length; ++i) {\n      var buffer = this.sourceBuffers[i];\n      var bufferEnd = buffer.buffered.end(buffer.buffered.length - 1);\n      newDuration = Math.max(newDuration, bufferEnd);\n    }\n\n    // If the duration is going to be reduced, suppress the next 'updateend'\n    // event on each SourceBuffer.\n    if (!isNaN(this.duration) &&\n        newDuration < this.duration) {\n      this.ignoreUpdateEnd_ = true;\n      for (var i = 0; i < this.sourceBuffers.length; ++i) {\n        var buffer = this.sourceBuffers[i];\n        buffer.eventSuppressed_ = false;\n      }\n    }\n\n    return endOfStream.apply(this, arguments);\n  };\n\n  var addSourceBuffer = MediaSource.prototype.addSourceBuffer;\n  MediaSource.prototype.addSourceBuffer = function() {\n    // After adding a new source buffer, add an event listener to allow us to\n    // suppress events.\n    var sourceBuffer = addSourceBuffer.apply(this, arguments);\n    sourceBuffer.mediaSource_ = this;\n    sourceBuffer.addEventListener('updateend',\n        shaka.polyfill.MediaSource.ignoreUpdateEnd_, false);\n\n    if (!this.cleanUpHandlerInstalled_) {\n      // If we haven't already, install an event listener to allow us to clean\n      // up listeners when MediaSource is torn down.\n      this.addEventListener('sourceclose',\n          shaka.polyfill.MediaSource.cleanUpListeners_, false);\n      this.cleanUpHandlerInstalled_ = true;\n    }\n    return sourceBuffer;\n  };\n};\n\n\n/**\n * An event listener for 'updateend' which selectively suppresses the events.\n *\n * @see shaka.polyfill.MediaSource.patchEndOfStreamEvents_\n *\n * @param {Event} event\n * @private\n */\nshaka.polyfill.MediaSource.ignoreUpdateEnd_ = function(event) {\n  var sourceBuffer = event.target;\n  var mediaSource = sourceBuffer.mediaSource_;\n\n  if (mediaSource.ignoreUpdateEnd_) {\n    event.preventDefault();\n    event.stopPropagation();\n    event.stopImmediatePropagation();\n    sourceBuffer.eventSuppressed_ = true;\n\n    for (var i = 0; i < mediaSource.sourceBuffers.length; ++i) {\n      var buffer = mediaSource.sourceBuffers[i];\n      if (buffer.eventSuppressed_ == false) {\n        // More events need to be suppressed.\n        return;\n      }\n    }\n\n    // All events have been suppressed, all buffers are out of 'updating'\n    // mode.  Stop suppressing events.\n    mediaSource.ignoreUpdateEnd_ = false;\n  }\n};\n\n\n/**\n * An event listener for 'sourceclose' which cleans up listeners for 'updateend'\n * to avoid memory leaks.\n *\n * @see shaka.polyfill.MediaSource.patchEndOfStreamEvents_\n * @see shaka.polyfill.MediaSource.ignoreUpdateEnd_\n *\n * @param {Event} event\n * @private\n */\nshaka.polyfill.MediaSource.cleanUpListeners_ = function(event) {\n  var mediaSource = event.target;\n  for (var i = 0; i < mediaSource.sourceBuffers.length; ++i) {\n    var buffer = mediaSource.sourceBuffers[i];\n    buffer.removeEventListener('updateend',\n        shaka.polyfill.MediaSource.ignoreUpdateEnd_, false);\n  }\n  mediaSource.removeEventListener('sourceclose',\n      shaka.polyfill.MediaSource.cleanUpListeners_, false);\n};\n\n\nshaka.polyfill.register(shaka.polyfill.MediaSource.install);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/mediasource.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.Promise');\n\ngoog.require('goog.asserts');\ngoog.require('shaka.log');\ngoog.require('shaka.polyfill.register');\n\n\n\n/**\n * @summary A polyfill to implement Promises, primarily for IE.\n * Only partially supports thenables, but otherwise passes the A+ conformance\n * tests.\n * Note that Promise.all() and Promise.race() are not tested by that suite.\n *\n * @constructor\n * @struct\n * @param {function(function(*), function(*))=} opt_callback\n * @template T\n */\nshaka.polyfill.Promise = function(opt_callback) {\n  /** @private {!Array.<shaka.polyfill.Promise.Child>} */\n  this.thens_ = [];\n\n  /** @private {!Array.<shaka.polyfill.Promise.Child>} */\n  this.catches_ = [];\n\n  /** @private {shaka.polyfill.Promise.State} */\n  this.state_ = shaka.polyfill.Promise.State.PENDING;\n\n  /** @private {*} */\n  this.value_;\n\n  // External callers must supply the callback.  Internally, we may construct\n  // child Promises without it, since we can directly access their resolve_ and\n  // reject_ methods when convenient.\n  if (opt_callback) {\n    try {\n      opt_callback(this.resolve_.bind(this), this.reject_.bind(this));\n    } catch (e) {\n      this.reject_(e);\n    }\n  }\n};\n\n\n/**\n * @typedef {{\n *   promise: !shaka.polyfill.Promise,\n *   callback: (function(*)|undefined)\n * }}\n *\n * @summary A child promise, used for chaining.\n * @description\n *   Only exists in the context of a then or catch chain.\n * @property {!shaka.polyfill.Promise} promise\n *   The child promise.\n * @property {(function(*)|undefined)} callback\n *   The then or catch callback to be invoked as part of this chain.\n */\nshaka.polyfill.Promise.Child;\n\n\n/**\n * @enum {number}\n */\nshaka.polyfill.Promise.State = {\n  PENDING: 0,\n  RESOLVED: 1,\n  REJECTED: 2\n};\n\n\n/**\n * Install the polyfill if needed.\n * @param {boolean=} opt_force If true, force the polyfill to be installed.\n *   Used in some unit tests.\n */\nshaka.polyfill.Promise.install = function(opt_force) {\n  // Decide on the best way to invoke a callback as soon as possible.\n  // Precompute the setImmediate/clearImmediate convenience methods to avoid the\n  // overhead of this switch every time a callback has to be invoked.\n  if (window.setImmediate) {\n    // For IE and node.js:\n    shaka.polyfill.Promise.setImmediate_ = function(callback) {\n      return window.setImmediate(callback);\n    };\n    shaka.polyfill.Promise.clearImmediate_ = function(id) {\n      return window.clearImmediate(id);\n    };\n  } else {\n    // For everyone else:\n    shaka.polyfill.Promise.setImmediate_ = function(callback) {\n      return window.setTimeout(callback, 0);\n    };\n    shaka.polyfill.Promise.clearImmediate_ = function(id) {\n      return window.clearTimeout(id);\n    };\n  }\n\n  if (window.Promise && !opt_force) {\n    shaka.log.info('Using native Promises.');\n    return;\n  }\n\n  shaka.log.info('Using Promises polyfill.');\n  // Quoted to work around type-checking, since our then() signature doesn't\n  // exactly match that of a native Promise.\n  window['Promise'] = shaka.polyfill.Promise;\n\n  // Explicitly installed because the compiler won't necessarily attach them\n  // to the compiled constructor.  Exporting them will only attach them to\n  // their original namespace, which isn't the same as attaching them to the\n  // constructor unless you also export the constructor.\n  window['Promise'].resolve = shaka.polyfill.Promise.resolve;\n  window['Promise'].reject = shaka.polyfill.Promise.reject;\n  window['Promise'].all = shaka.polyfill.Promise.all;\n  window['Promise'].race = shaka.polyfill.Promise.race;\n\n  // These are manually exported as well, because allowing the compiler to\n  // export them for us will cause the polyfill to end up in our generated\n  // externs.  Since nobody should be accessing this directly using the\n  // shaka.polyfill namespace, it is okay not to @export these methods.\n  window['Promise']['prototype']['then'] =\n      shaka.polyfill.Promise.prototype.then;\n  window['Promise']['prototype']['catch'] =\n      shaka.polyfill.Promise.prototype.catch;\n};\n\n\n/**\n * Uninstall the polyfill.  Used in some unit tests.\n */\nshaka.polyfill.Promise.uninstall = function() {\n  // Do nothing if there is no native implementation.\n  if (shaka.polyfill.Promise.nativePromise_) {\n    shaka.log.info('Removing Promise polyfill.');\n    window['Promise'] = shaka.polyfill.Promise.nativePromise_;\n    shaka.polyfill.Promise.q_ = [];\n  }\n};\n\n\n/**\n * @param {*} value\n * @return {!shaka.polyfill.Promise}\n */\nshaka.polyfill.Promise.resolve = function(value) {\n  var p = new shaka.polyfill.Promise();\n  p.resolve_(undefined);\n  return p.then(function() {\n    return value;\n  });\n};\n\n\n/**\n * @param {*} reason\n * @return {!shaka.polyfill.Promise}\n */\nshaka.polyfill.Promise.reject = function(reason) {\n  var p = new shaka.polyfill.Promise();\n  p.reject_(reason);\n  return p;\n};\n\n\n/**\n * @param {!Array.<!shaka.polyfill.Promise>} others\n * @return {!shaka.polyfill.Promise}\n */\nshaka.polyfill.Promise.all = function(others) {\n  var p = new shaka.polyfill.Promise();\n  if (!others.length) {\n    p.resolve_([]);\n    return p;\n  }\n\n  // The array of results must be in the same order as the array of Promises\n  // passed to all().  So we pre-allocate the array and keep a count of how\n  // many have resolved.  Only when all have resolved is the returned Promise\n  // itself resolved.\n  var count = 0;\n  var values = new Array(others.length);\n  var resolve = function(p, i, newValue) {\n    goog.asserts.assert(p.state_ != shaka.polyfill.Promise.State.RESOLVED,\n                        'Invalid Promise state in Promise.all');\n    // If one of the Promises in the array was rejected, this Promise was\n    // rejected and new values are ignored.  In such a case, the values array\n    // and its contents continue to be alive in memory until all of the Promises\n    // in the array have completed.\n    if (p.state_ == shaka.polyfill.Promise.State.PENDING) {\n      values[i] = newValue;\n      count++;\n      if (count == values.length) {\n        p.resolve_(values);\n      }\n    }\n  };\n\n  var reject = p.reject_.bind(p);\n  for (var i = 0; i < others.length; ++i) {\n    if (others[i] && others[i].then) {\n      others[i].then(resolve.bind(null, p, i), reject);\n    } else {\n      resolve(p, i, others[i]);\n    }\n  }\n  return p;\n};\n\n\n/**\n * @param {!Array.<!shaka.polyfill.Promise>} others\n * @return {!shaka.polyfill.Promise}\n */\nshaka.polyfill.Promise.race = function(others) {\n  var p = new shaka.polyfill.Promise();\n\n  // The returned Promise is resolved or rejected as soon as one of the others\n  // is.\n  var resolve = p.resolve_.bind(p);\n  var reject = p.reject_.bind(p);\n  for (var i = 0; i < others.length; ++i) {\n    if (others[i] && others[i].then) {\n      others[i].then(resolve, reject);\n    } else {\n      resolve(others[i]);\n    }\n  }\n  return p;\n};\n\n\n/**\n * @param {function(*)=} opt_successCallback\n * @param {function(*)=} opt_failCallback\n * @return {!shaka.polyfill.Promise}\n */\nshaka.polyfill.Promise.prototype.then = function(opt_successCallback,\n                                                 opt_failCallback) {\n  // then() returns a child Promise which is chained onto this one.\n  var child = new shaka.polyfill.Promise();\n  switch (this.state_) {\n    case shaka.polyfill.Promise.State.RESOLVED:\n      // This is already resolved, so we can chain to the child ASAP.\n      this.schedule_(child, opt_successCallback);\n      break;\n    case shaka.polyfill.Promise.State.REJECTED:\n      // This is already rejected, so we can chain to the child ASAP.\n      this.schedule_(child, opt_failCallback);\n      break;\n    case shaka.polyfill.Promise.State.PENDING:\n      // This is pending, so we have to track both callbacks and the child\n      // in order to chain later.\n      this.thens_.push({ promise: child, callback: opt_successCallback});\n      this.catches_.push({ promise: child, callback: opt_failCallback});\n      break;\n  }\n\n  return child;\n};\n\n\n/**\n * @param {function(*)=} opt_callback\n * @return {!shaka.polyfill.Promise}\n */\nshaka.polyfill.Promise.prototype.catch = function(opt_callback) {\n  // Devolves into a two-argument call to 'then'.\n  return this.then(undefined, opt_callback);\n};\n\n\n/**\n * @param {*} value\n * @private\n */\nshaka.polyfill.Promise.prototype.resolve_ = function(value) {\n  // Ignore resolve calls if we aren't still pending.\n  if (this.state_ == shaka.polyfill.Promise.State.PENDING) {\n    this.value_ = value;\n    this.state_ = shaka.polyfill.Promise.State.RESOLVED;\n    // Schedule calls to all of the chained callbacks.\n    for (var i = 0; i < this.thens_.length; ++i) {\n      this.schedule_(this.thens_[i].promise, this.thens_[i].callback);\n    }\n    this.thens_ = [];\n    this.catches_ = [];\n  }\n};\n\n\n/**\n * @param {*} reason\n * @private\n */\nshaka.polyfill.Promise.prototype.reject_ = function(reason) {\n  // Ignore reject calls if we aren't still pending.\n  if (this.state_ == shaka.polyfill.Promise.State.PENDING) {\n    this.value_ = reason;\n    this.state_ = shaka.polyfill.Promise.State.REJECTED;\n    // Schedule calls to all of the chained callbacks.\n    for (var i = 0; i < this.catches_.length; ++i) {\n      this.schedule_(this.catches_[i].promise, this.catches_[i].callback);\n    }\n    this.thens_ = [];\n    this.catches_ = [];\n  }\n};\n\n\n/**\n * @param {!shaka.polyfill.Promise} child\n * @param {function(*)|undefined} callback\n * @private\n */\nshaka.polyfill.Promise.prototype.schedule_ = function(child, callback) {\n  goog.asserts.assert(this.state_ != shaka.polyfill.Promise.State.PENDING,\n                      'Invalid Promise state in Promise.schedule_');\n  var Promise = shaka.polyfill.Promise;\n\n  var wrapper = function() {\n    if (callback && typeof callback == 'function') {\n      // Wrap around the callback.  Exceptions thrown by the callback are\n      // converted to failures.\n      try {\n        var value = callback(this.value_);\n      } catch (exception) {\n        child.reject_(exception);\n        return;\n      }\n\n      // According to the spec, 'then' in a thenable may only be accessed once\n      // and any thrown exceptions in the getter must cause the Promise chain\n      // to fail.\n      var then;\n      try {\n        then = value && value.then;\n      } catch (exception) {\n        child.reject_(exception);\n        return;\n      }\n\n      if (value instanceof Promise) {\n        // If the returned value is a Promise, we bind it's state to the child.\n        if (value == child) {\n          // Without this, a bad calling pattern can cause an infinite loop.\n          child.reject_(new TypeError('Chaining cycle detected'));\n        } else {\n          value.then(child.resolve_.bind(child), child.reject_.bind(child));\n        }\n      } else if (then) {\n        // If the returned value is thenable, chain it to the child.\n        Promise.handleThenable_(value, then, child);\n      } else {\n        // If the returned value is not a Promise, the child is resolved with\n        // that value.\n        child.resolve_(value);\n      }\n    } else if (this.state_ == Promise.State.RESOLVED) {\n      // No callback for this state, so just chain on down the line.\n      child.resolve_(this.value_);\n    } else {\n      // No callback for this state, so just chain on down the line.\n      child.reject_(this.value_);\n    }\n  };\n\n  // Enqueue a call to the wrapper.\n  Promise.q_.push(wrapper.bind(this));\n  if (Promise.flushTimer_ == null) {\n    Promise.flushTimer_ = Promise.setImmediate_(Promise.flush);\n  }\n};\n\n\n/**\n * @param {!Object} thenable\n * @param {Function} then\n * @param {!shaka.polyfill.Promise} child\n * @private\n */\nshaka.polyfill.Promise.handleThenable_ = function(thenable, then, child) {\n  var Promise = shaka.polyfill.Promise;\n  try {\n    var sealed = false;\n    then.call(thenable, function(value) {\n      if (sealed) return;\n      sealed = true;\n\n      var nextThen;\n      try {\n        nextThen = value && value.then;\n      } catch (exception) {\n        child.reject_(exception);\n        return;\n      }\n\n      if (nextThen) {\n        Promise.handleThenable_(value, nextThen, child);\n      } else {\n        child.resolve_(value);\n      }\n    }, child.reject_.bind(child));\n  } catch (exception) {\n    child.reject_(exception);\n  }\n};\n\n\n/**\n * Flush the queue of callbacks.\n * Used directly by some unit tests.\n */\nshaka.polyfill.Promise.flush = function() {\n  var Promise = shaka.polyfill.Promise;\n\n  // Flush as long as we have callbacks.  This means we can finish a chain more\n  // quickly, since we avoid the overhead of multiple calls to setTimeout, each\n  // of which has a minimum resolution of as much as 15ms on IE11.\n  // This helps to fix the out-of-order task bug on IE:\n  //   https://github.com/google/shaka-player/issues/251#issuecomment-178146242\n  while (Promise.q_.length) {\n    // Callbacks may enqueue other callbacks, so clear the timer ID and swap the\n    // queue before we do anything else.\n    if (Promise.flushTimer_ != null) {\n      Promise.clearImmediate_(Promise.flushTimer_);\n      Promise.flushTimer_ = null;\n    }\n    var q = Promise.q_;\n    Promise.q_ = [];\n\n    for (var i = 0; i < q.length; ++i) {\n      q[i]();\n    }\n  }\n};\n\n\n/**\n * @param {function()} callback\n * @return {number}\n * Schedule a callback as soon as possible.\n * Bound in shaka.polyfill.Promise.install() to a specific implementation.\n * @private\n */\nshaka.polyfill.Promise.setImmediate_ = function(callback) { return 0; };\n\n\n/**\n * @param {number} id\n * Clear a scheduled callback.\n * Bound in shaka.polyfill.Promise.install() to a specific implementation.\n * @private\n */\nshaka.polyfill.Promise.clearImmediate_ = function(id) {};\n\n\n/**\n * A timer ID to flush the queue.\n * @private {?number}\n */\nshaka.polyfill.Promise.flushTimer_ = null;\n\n\n/**\n * A queue of callbacks to be invoked ASAP in the next frame.\n * @private {!Array.<function()>}\n */\nshaka.polyfill.Promise.q_ = [];\n\n\n/** @private {?} */\nshaka.polyfill.Promise.nativePromise_ = window.Promise;\n\n\nshaka.polyfill.register(shaka.polyfill.Promise.install);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/promise.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.VideoPlayPromise');\n\ngoog.require('shaka.log');\ngoog.require('shaka.polyfill.register');\n\n\n/**\n * @namespace shaka.polyfill.VideoPlayPromise\n *\n * @summary A polyfill to silence the play() Promise in HTML5 video.\n */\n\n\n/**\n * Install the polyfill if needed.\n */\nshaka.polyfill.VideoPlayPromise.install = function() {\n  shaka.log.debug('VideoPlayPromise.install');\n\n  if (window.HTMLMediaElement) {\n    var originalPlay = HTMLMediaElement.prototype.play;\n    HTMLMediaElement.prototype.play = function() {\n      var p = originalPlay.apply(this, arguments);\n      if (p) {\n        // This browser is returning a Promise from play().\n        // If the play() call fails or is interrupted, the Promise will be\n        // rejected.  Some apps, however, don't listen to this Promise,\n        // especially since it is not available cross-browser.  If the Promise\n        // is rejected without anyone listening for the failure, an error will\n        // appear in the JS console.\n        // To avoid confusion over this innocuous \"error\", we will install a\n        // catch handler on the Promise.  This does not prevent the app from\n        // also catching failures and handling them.  It only prevents the\n        // console message.\n        p.catch(function() {});\n      }\n      return p;\n    };\n  }\n};\n\nshaka.polyfill.register(shaka.polyfill.VideoPlayPromise.install);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/video_play_promise.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.VideoPlaybackQuality');\n\ngoog.require('shaka.polyfill.register');\n\n\n/**\n * @namespace shaka.polyfill.VideoPlaybackQuality\n *\n * @summary A polyfill to provide MSE VideoPlaybackQuality metrics.\n * Many browsers do not yet provide this API, and Chrome currently provides\n * similar data through individual prefixed attributes on HTMLVideoElement.\n */\n\n\n/**\n * Install the polyfill if needed.\n */\nshaka.polyfill.VideoPlaybackQuality.install = function() {\n  if (!window.HTMLVideoElement) {\n    // Avoid errors on very old browsers.\n    return;\n  }\n\n  var proto = HTMLVideoElement.prototype;\n  if (proto.getVideoPlaybackQuality) {\n    // No polyfill needed.\n    return;\n  }\n\n  if ('webkitDroppedFrameCount' in proto) {\n    proto.getVideoPlaybackQuality =\n        shaka.polyfill.VideoPlaybackQuality.webkit_;\n  }\n};\n\n\n/**\n * @this {HTMLVideoElement}\n * @return {!VideoPlaybackQuality}\n * @private\n */\nshaka.polyfill.VideoPlaybackQuality.webkit_ = function() {\n  return {\n    'droppedVideoFrames': this.webkitDroppedFrameCount,\n    'totalVideoFrames': this.webkitDecodedFrameCount,\n    // Not provided by this polyfill:\n    'corruptedVideoFrames': 0,\n    'creationTime': NaN,\n    'totalFrameDelay': 0\n  };\n};\n\n\nshaka.polyfill.register(shaka.polyfill.VideoPlaybackQuality.install);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/videoplaybackquality.js","/**\n * @license\n * Copyright 2016 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ngoog.provide('shaka.polyfill.VTTCue');\n\ngoog.require('shaka.log');\ngoog.require('shaka.polyfill.register');\n\n\n/**\n * @namespace shaka.polyfill.VTTCue\n *\n * @summary A polyfill to provide VTTCue.\n */\n\n\n/**\n * Install the polyfill if needed.\n */\nshaka.polyfill.VTTCue.install = function() {\n  if (window.VTTCue) {\n    shaka.log.info('Using native VTTCue.');\n    return;\n  }\n\n  if (!window.TextTrackCue) {\n    shaka.log.error('VTTCue not available.');\n    return;\n  }\n\n  var constructorLength = TextTrackCue.length;\n  if (constructorLength == 3) {\n    shaka.log.info('Using VTTCue polyfill from 3 argument TextTrackCue.');\n    window.VTTCue = shaka.polyfill.VTTCue.from3ArgsTextTrackCue_;\n  } else if (constructorLength == 6) {\n    shaka.log.info('Using VTTCue polyfill from 6 argument TextTrackCue.');\n    window.VTTCue = shaka.polyfill.VTTCue.from6ArgsTextTrackCue_;\n  } else if (shaka.polyfill.VTTCue.canUse3ArgsTextTrackCue_()) {\n    shaka.log.info('Using VTTCue polyfill from 3 argument TextTrackCue.');\n    window.VTTCue = shaka.polyfill.VTTCue.from3ArgsTextTrackCue_;\n  }\n};\n\n\n/**\n * Draft spec TextTrackCue with 3 constructor arguments.\n * See {@link https://goo.gl/ZXBWZi W3C Working Draft 25 October 2012}.\n *\n * @param {number} startTime\n * @param {number} endTime\n * @param {string} text\n * @return {TextTrackCue}\n * @private\n */\nshaka.polyfill.VTTCue.from3ArgsTextTrackCue_ = function(startTime, endTime,\n    text) {\n  return new window.TextTrackCue(startTime, endTime, text);\n};\n\n\n/**\n * Draft spec TextTrackCue with 6 constructor arguments (5th & 6th are\n * optional).\n * See {@link https://goo.gl/AYFqUh W3C Working Draft 29 March 2012}.\n * Quoting the access to the TextTrackCue object to avoid the compiler\n * complaining.\n *\n * @param {number} startTime\n * @param {number} endTime\n * @param {string} text\n * @return {TextTrackCue}\n * @private\n */\nshaka.polyfill.VTTCue.from6ArgsTextTrackCue_ = function(startTime, endTime,\n    text) {\n  var id = startTime + '-' + endTime + '-' + text;\n  return new window['TextTrackCue'](id, startTime, endTime, text);\n};\n\n\n/**\n * IE10, IE11 and Edge returns TextTrackCue.length = 0 although it accepts 3\n * constructor arguments.\n *\n * @return {boolean}\n * @private\n */\nshaka.polyfill.VTTCue.canUse3ArgsTextTrackCue_ = function() {\n  try {\n    return !!shaka.polyfill.VTTCue.from3ArgsTextTrackCue_(1, 2, '');\n  } catch (error) {\n    return false;\n  }\n};\n\n\nshaka.polyfill.register(shaka.polyfill.VTTCue.install);\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/shaka-player/lib/polyfill/vttcue.js","//@flow\nimport * as Playkit from 'playkit-js';\nimport OvpProvider from 'playkit-js-providers/dist/ovpProvider';\nimport handleSessionId from './session-id'\n\n/**\n * Setup the kaltura player.\n * @param {string} targetId - The target id of the dom element which we append the player to.\n * @param {Object} config - Fully config which includes partnerId and entryId.\n * @return {Promise<*>} - The player promise.\n */\nexport default function setup(targetId: string, config: Object): Promise<*> {\n  let player = Playkit.loadPlayer(targetId);\n  player.addEventListener(player.Event.SOURCE_SELECTED, (event) => {\n    handleSessionId(event.payload.selectedSource, player);\n  });\n  if (config) {\n    let provider = new OvpProvider(config.partnerId);\n    return provider.getConfig(config.entryId)\n      .then(data => {\n        player.configure(data);\n        return Promise.resolve(player);\n      }).catch(error => {\n        return Promise.reject(error);\n      });\n  } else {\n    return Promise.resolve(player);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./setup.js","//@flow\n/**\n * @return {string} - GUID\n * @private\n */\nfunction _generateGUID(): string {\n  let S4 = () => {\n    return (((1+Math.random())*0x10000)|0).toString(16).substring(1);\n  };\n  return (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());\n}\n\n/**\n * @param {Object} selectedSource - selected source\n * @param {Player} player - player\n * @return {void}\n * @private\n */\nfunction _addSessionId(selectedSource: Object, player: Player): void {\n  let delimiter = selectedSource.url.indexOf('?') === -1 ? '?' : '&';\n  let primaryGUID = _generateGUID();\n  let secondGUID = _generateGUID();\n  let sessionId = primaryGUID + ':' + secondGUID;\n  selectedSource.url += delimiter + 'playSessionId=' + sessionId;\n  player.sessionId = sessionId;\n}\n\n/**\n * @param {Object} selectedSource - selected source\n * @param {string} sessionId - session id\n * @param {Player} player - player\n * @return {void}\n * @private\n */\nfunction _replaceSecondGUID(selectedSource: Object, sessionId: string, player: Player): void {\n  let secondGUIDRegex = /:((?:[a-z0-9]|-)*)/i;\n  let secondGUID = secondGUIDRegex.exec(sessionId);\n  if (secondGUID && secondGUID[1]) {\n    let newSessionId = sessionId.replace(secondGUID[1], _generateGUID());\n    selectedSource.url = selectedSource.url.replace(sessionId, newSessionId);\n    player.sessionId = newSessionId;\n  }\n}\n\n/**\n * @param {Object} selectedSource - selected source\n * @param {Player} player - player\n * @return {void}\n * @public\n */\nfunction handleSessionId(selectedSource: Object = {}, player: Player): void {\n  if (typeof selectedSource.url === 'string' && selectedSource.url.toLowerCase().indexOf('playmanifest/') !== -1) {\n    let sessionIdRegex = /playSessionId=((?:[a-z0-9]|-|:)*)/i;\n    let sessionId = sessionIdRegex.exec(selectedSource.url);\n    if (sessionId && sessionId[1]) {\n      _replaceSecondGUID(selectedSource, sessionId[1], player);\n    } else {\n      _addSessionId(selectedSource, player);\n    }\n  }\n}\n\nexport default handleSessionId\n\n\n\n// WEBPACK FOOTER //\n// ./session-id.js"],"sourceRoot":""}