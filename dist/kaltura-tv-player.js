var KalturaPlayer=function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=324)}([function(e,t,r){window,e.exports=function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=9)}([function(e,t,r){var a;!function(n,i){"use strict";var o="model",s="name",l="type",u="vendor",c="version",d="mobile",p="tablet",h="smarttv",f=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},g=function(e,t){return"string"==typeof e&&-1!==y(t).indexOf(y(e))},y=function(e){return e.toLowerCase()},m=function(e,t){if("string"==typeof e)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),void 0===t?e:e.substring(0,255)},v=function(e,t){for(var r,a,n,i,o,s,l=0;l<t.length&&!o;){var u=t[l],c=t[l+1];for(r=a=0;r<u.length&&!o;)if(o=u[r++].exec(e))for(n=0;n<c.length;n++)s=o[++a],"object"==typeof(i=c[n])&&i.length>0?2===i.length?"function"==typeof i[1]?this[i[0]]=i[1].call(this,s):this[i[0]]=i[1]:3===i.length?"function"!=typeof i[1]||i[1].exec&&i[1].test?this[i[0]]=s?s.replace(i[1],i[2]):void 0:this[i[0]]=s?i[1].call(this,s,i[2]):void 0:4===i.length&&(this[i[0]]=s?i[3].call(this,s.replace(i[1],i[2])):void 0):this[i]=s||void 0;l+=2}},_=function(e,t){for(var r in t)if("object"==typeof t[r]&&t[r].length>0){for(var a=0;a<t[r].length;a++)if(g(t[r][a],e))return"?"===r?void 0:r}else if(g(t[r],e))return"?"===r?void 0:r;return e},k={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},E={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[c,[s,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[c,[s,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[s,c],[/opios[\/ ]+([\w\.]+)/i],[c,[s,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[c,[s,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[s,c],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[c,[s,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[c,[s,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[c,[s,"WeChat"]],[/konqueror\/([\w\.]+)/i],[c,[s,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[c,[s,"IE"]],[/yabrowser\/([\w\.]+)/i],[c,[s,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[s,/(.+)/,"$1 Secure Browser"],c],[/\bfocus\/([\w\.]+)/i],[c,[s,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[c,[s,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[c,[s,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[c,[s,"Dolphin"]],[/coast\/([\w\.]+)/i],[c,[s,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[c,[s,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[c,[s,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[s,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[s,/(.+)/,"$1 Browser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],c],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[s,c],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[s],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[s,"Facebook"],c],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[s,c],[/\bgsa\/([\w\.]+) .*safari\//i],[c,[s,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[c,[s,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[s,"Chrome WebView"],c],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[c,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[s,c],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[c,[s,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[c,s],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[s,[c,_,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[s,c],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[s,"Netscape"],c],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[c,[s,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[s,c]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",y]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",y]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",y]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[o,[u,"Samsung"],[l,p]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[o,[u,"Samsung"],[l,d]],[/\((ip(?:hone|od)[\w ]*);/i],[o,[u,"Apple"],[l,d]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[o,[u,"Apple"],[l,p]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[o,[u,"Huawei"],[l,p]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[o,[u,"Huawei"],[l,d]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[o,/_/g," "],[u,"Xiaomi"],[l,d]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[o,/_/g," "],[u,"Xiaomi"],[l,p]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[o,[u,"OPPO"],[l,d]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[o,[u,"Vivo"],[l,d]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[o,[u,"Realme"],[l,d]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[o,[u,"Motorola"],[l,d]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[o,[u,"Motorola"],[l,p]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[o,[u,"LG"],[l,p]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[o,[u,"LG"],[l,d]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[o,[u,"Lenovo"],[l,p]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[o,/_/g," "],[u,"Nokia"],[l,d]],[/(pixel c)\b/i],[o,[u,"Google"],[l,p]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[o,[u,"Google"],[l,d]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[u,"Sony"],[l,d]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[o,"Xperia Tablet"],[u,"Sony"],[l,p]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[o,[u,"OnePlus"],[l,d]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[o,[u,"Amazon"],[l,p]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[o,/(.+)/g,"Fire Phone $1"],[u,"Amazon"],[l,d]],[/(playbook);[-\w\),; ]+(rim)/i],[o,u,[l,p]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[o,[u,"BlackBerry"],[l,d]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[o,[u,"ASUS"],[l,p]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[o,[u,"ASUS"],[l,d]],[/(nexus 9)/i],[o,[u,"HTC"],[l,p]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[u,[o,/_/g," "],[l,d]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[o,[u,"Acer"],[l,p]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[o,[u,"Meizu"],[l,d]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[o,[u,"Sharp"],[l,d]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[u,o,[l,d]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[u,o,[l,p]],[/(surface duo)/i],[o,[u,"Microsoft"],[l,p]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[o,[u,"Fairphone"],[l,d]],[/(u304aa)/i],[o,[u,"AT&T"],[l,d]],[/\bsie-(\w*)/i],[o,[u,"Siemens"],[l,d]],[/\b(rct\w+) b/i],[o,[u,"RCA"],[l,p]],[/\b(venue[\d ]{2,7}) b/i],[o,[u,"Dell"],[l,p]],[/\b(q(?:mv|ta)\w+) b/i],[o,[u,"Verizon"],[l,p]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[o,[u,"Barnes & Noble"],[l,p]],[/\b(tm\d{3}\w+) b/i],[o,[u,"NuVision"],[l,p]],[/\b(k88) b/i],[o,[u,"ZTE"],[l,p]],[/\b(nx\d{3}j) b/i],[o,[u,"ZTE"],[l,d]],[/\b(gen\d{3}) b.+49h/i],[o,[u,"Swiss"],[l,d]],[/\b(zur\d{3}) b/i],[o,[u,"Swiss"],[l,p]],[/\b((zeki)?tb.*\b) b/i],[o,[u,"Zeki"],[l,p]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[u,"Dragon Touch"],o,[l,p]],[/\b(ns-?\w{0,9}) b/i],[o,[u,"Insignia"],[l,p]],[/\b((nxa|next)-?\w{0,9}) b/i],[o,[u,"NextBook"],[l,p]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[u,"Voice"],o,[l,d]],[/\b(lvtel\-)?(v1[12]) b/i],[[u,"LvTel"],o,[l,d]],[/\b(ph-1) /i],[o,[u,"Essential"],[l,d]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[o,[u,"Envizen"],[l,p]],[/\b(trio[-\w\. ]+) b/i],[o,[u,"MachSpeed"],[l,p]],[/\btu_(1491) b/i],[o,[u,"Rotor"],[l,p]],[/(shield[\w ]+) b/i],[o,[u,"Nvidia"],[l,p]],[/(sprint) (\w+)/i],[u,o,[l,d]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[u,"Microsoft"],[l,d]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[o,[u,"Zebra"],[l,p]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[o,[u,"Zebra"],[l,d]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[u,o,[l,"console"]],[/droid.+; (shield) bui/i],[o,[u,"Nvidia"],[l,"console"]],[/(playstation [345portablevi]+)/i],[o,[u,"Sony"],[l,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[o,[u,"Microsoft"],[l,"console"]],[/smart-tv.+(samsung)/i],[u,[l,h]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[u,"Samsung"],[l,h]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[u,"LG"],[l,h]],[/(apple) ?tv/i],[u,[o,"Apple TV"],[l,h]],[/crkey/i],[[o,"Chromecast"],[u,"Google"],[l,h]],[/droid.+aft(\w)( bui|\))/i],[o,[u,"Amazon"],[l,h]],[/\(dtv[\);].+(aquos)/i],[o,[u,"Sharp"],[l,h]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[u,m],[o,m],[l,h]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[l,h]],[/((pebble))app/i],[u,o,[l,"wearable"]],[/droid.+; (glass) \d/i],[o,[u,"Google"],[l,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[o,[u,"Zebra"],[l,"wearable"]],[/(quest( 2)?)/i],[o,[u,"Facebook"],[l,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[u,[l,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[o,[l,d]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[o,[l,p]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,p]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[l,d]],[/(android[-\w\. ]{0,9});.+buil/i],[o,[u,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[c,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[c,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[s,c],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[c,s]],os:[[/microsoft (windows) (vista|xp)/i],[s,c],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[s,[c,_,k]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[s,"Windows"],[c,_,k]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[c,/_/g,"."],[s,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[s,"Mac OS"],[c,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[c,s],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[s,c],[/\(bb(10);/i],[c,[s,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[c,[s,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[c,[s,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[c,[s,"webOS"]],[/crkey\/([\d\.]+)/i],[c,[s,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[s,"Chromium OS"],c],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[s,c],[/(sunos) ?([\w\.\d]*)/i],[[s,"Solaris"],c],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[s,c]]},T=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof T))return new T(e,t).getResult();var r=e||(void 0!==n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:""),a=t?function(e,t){var r={};for(var a in e)t[a]&&t[a].length%2==0?r[a]=t[a].concat(e[a]):r[a]=e[a];return r}(E,t):E;return this.getBrowser=function(){var e,t={name:void 0,version:void 0};return v.call(t,r,a.browser),t.major="string"==typeof(e=t.version)?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0,t},this.getCPU=function(){var e={architecture:void 0};return v.call(e,r,a.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return v.call(e,r,a.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return v.call(e,r,a.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return v.call(e,r,a.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r="string"==typeof e&&e.length>255?m(e,255):e,this},this.setUA(r),this};T.VERSION="1.0.2",T.BROWSER=f([s,c,"major"]),T.CPU=f(["architecture"]),T.DEVICE=f([o,u,l,"console",d,h,p,"wearable","embedded"]),T.ENGINE=T.OS=f([s,c]),void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=T),t.UAParser=T):r(4)?void 0===(a=function(){return T}.call(t,r,t,e))||(e.exports=a):void 0!==n&&(n.UAParser=T);var b=void 0!==n&&(n.jQuery||n.Zepto);if(b&&!b.ua){var S=new T;b.ua=S.getResult(),b.ua.get=function(){return S.getUA()},b.ua.set=function(e){S.setUA(e);var t=S.getResult();for(var r in t)b.ua[r]=t[r]}}}("object"==typeof window?window:this)},function(e,t,r){var a,n;
/*!
 * js-logger - http://github.com/jonnyreeves/js-logger
 * Jonny Reeves, http://jonnyreeves.co.uk/
 * js-logger may be freely distributed under the MIT license.
 */!function(i){"use strict";var o,s={VERSION:"1.6.0"},l={},u=function(e,t){return function(){return t.apply(e,arguments)}},c=function(){var e,t,r=arguments,a=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in a)&&r[t].hasOwnProperty(e)&&(a[e]=r[t][e]);return a},d=function(e,t){return{value:e,name:t}};s.TRACE=d(1,"TRACE"),s.DEBUG=d(2,"DEBUG"),s.INFO=d(3,"INFO"),s.TIME=d(4,"TIME"),s.WARN=d(5,"WARN"),s.ERROR=d(8,"ERROR"),s.OFF=d(99,"OFF");var p=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};p.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(s.TRACE,arguments)},debug:function(){this.invoke(s.DEBUG,arguments)},info:function(){this.invoke(s.INFO,arguments)},warn:function(){this.invoke(s.WARN,arguments)},error:function(){this.invoke(s.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"end"])},invoke:function(e,t){o&&this.enabledFor(e)&&o(t,c({level:e},this.context))}};var h,f=new p({filterLevel:s.OFF});(h=s).enabledFor=u(f,f.enabledFor),h.trace=u(f,f.trace),h.debug=u(f,f.debug),h.time=u(f,f.time),h.timeEnd=u(f,f.timeEnd),h.info=u(f,f.info),h.warn=u(f,f.warn),h.error=u(f,f.error),h.log=h.info,s.setHandler=function(e){o=e},s.setLevel=function(e){for(var t in f.setLevel(e),l)l.hasOwnProperty(t)&&l[t].setLevel(e)},s.getLevel=function(){return f.getLevel()},s.get=function(e){return l[e]||(l[e]=new p(c({name:e},f.context)))},s.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(a,n){a=Array.prototype.slice.call(a);var i,o=console.log;n.level===s.TIME?(i=(n.name?"["+n.name+"] ":"")+a[0],"start"===a[1]?console.time?console.time(i):t[i]=(new Date).getTime():console.timeEnd?console.timeEnd(i):r(o,[i+": "+((new Date).getTime()-t[i])+"ms"])):(n.level===s.WARN&&console.warn?o=console.warn:n.level===s.ERROR&&console.error?o=console.error:n.level===s.INFO&&console.info?o=console.info:n.level===s.DEBUG&&console.debug?o=console.debug:n.level===s.TRACE&&console.trace&&(o=console.trace),e.formatter(a,n),r(o,a))}},s.useDefaults=function(e){s.setLevel(e&&e.defaultLevel||s.DEBUG),s.setHandler(s.createDefaultHandler(e))},void 0===(n="function"==typeof(a=s)?a.call(t,r,t,e):a)||(e.exports=n)}()},function(e){e.exports=JSON.parse('{"heartbeatTimeout":30000}')},function(e){e.exports=JSON.parse('{"a":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="}')},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,r){var a=r(6),n=r(7);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]),a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,r){"use strict";var a,n=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),i=[];function o(e){for(var t=-1,r=0;r<i.length;r++)if(i[r].identifier===e){t=r;break}return t}function s(e,t){for(var r={},a=[],n=0;n<e.length;n++){var s=e[n],l=t.base?s[0]+t.base:s[0],u=r[l]||0,c="".concat(l," ").concat(u);r[l]=u+1;var d=o(c),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(i[d].references++,i[d].updater(p)):i.push({identifier:c,updater:g(p,t),references:1}),a.push(c)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var i=r.nc;i&&(a.nonce=i)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=n(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,r,a){var n=r?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,n);else{var i=document.createTextNode(n),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function p(e,t,r){var a=r.css,n=r.media,i=r.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),i&&btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var h=null,f=0;function g(e,t){var r,a,n;if(t.singleton){var i=f++;r=h||(h=l(t)),a=d.bind(null,r,i,!1),n=d.bind(null,r,i,!0)}else r=l(t),a=p.bind(null,r,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var r=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<r.length;a++){var n=o(r[a]);i[n].references--}for(var l=s(e,t),u=0;u<r.length;u++){var c=o(r[u]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}r=l}}}},function(e,t,r){(t=r(8)(!1)).push([e.i,".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: #000;\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n",""]),e.exports=t},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r,a,n,i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"==typeof btoa){var s=(r=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(n," */")),l=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[i].concat(l).concat([s]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,a){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(a)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(n[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&n[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},function(e,t,r){"use strict";r.r(t),r.d(t,"loadPlayer",(function(){return Br})),r.d(t,"registerMediaSourceAdapter",(function(){return Ot})),r.d(t,"BaseMediaSourceAdapter",(function(){return yt})),r.d(t,"BaseMiddleware",(function(){return at})),r.d(t,"Track",(function(){return ae})),r.d(t,"VideoTrack",(function(){return ie})),r.d(t,"AudioTrack",(function(){return oe})),r.d(t,"TextTrack",(function(){return Xe})),r.d(t,"ImageTrack",(function(){return dt})),r.d(t,"TextStyle",(function(){return ye})),r.d(t,"Cue",(function(){return je})),r.d(t,"TimedMetadata",(function(){return Lt})),r.d(t,"createTextTrackCue",(function(){return Nt})),r.d(t,"createTimedMetadata",(function(){return Ut})),r.d(t,"Utils",(function(){return a})),r.d(t,"utils",(function(){return a})),r.d(t,"Error",(function(){return O})),r.d(t,"FakeEvent",(function(){return v})),r.d(t,"FakeEventTarget",(function(){return P})),r.d(t,"EventManager",(function(){return M})),r.d(t,"VERSION",(function(){return Ur})),r.d(t,"NAME",(function(){return Fr})),r.d(t,"Env",(function(){return g})),r.d(t,"State",(function(){return J})),r.d(t,"getCapabilities",(function(){return jr})),r.d(t,"setCapabilities",(function(){return Vr})),r.d(t,"EngineDecoratorProvider",(function(){return Lr})),r.d(t,"registerEngine",(function(){return Jt})),r.d(t,"unRegisterEngine",(function(){return Zt})),r.d(t,"AdBreakType",(function(){return ir})),r.d(t,"AdTagType",(function(){return or})),r.d(t,"AdEventType",(function(){return K})),r.d(t,"filterTracksByRestriction",(function(){return vt})),r.d(t,"Html5EventType",(function(){return W})),r.d(t,"CustomEventType",(function(){return z})),r.d(t,"EventType",(function(){return q})),r.d(t,"StateType",(function(){return Z})),r.d(t,"TrackType",(function(){return Qe})),r.d(t,"EngineType",(function(){return Ze})),r.d(t,"MediaType",(function(){return et})),r.d(t,"StreamType",(function(){return Je})),r.d(t,"AbrMode",(function(){return tt})),r.d(t,"LogLevelType",(function(){return E})),r.d(t,"CorsType",(function(){return rt})),r.d(t,"DrmScheme",(function(){return _t})),r.d(t,"MimeType",(function(){return Nr})),r.d(t,"RequestType",(function(){return ut})),r.d(t,"ScreenOrientationType",(function(){return ot})),r.d(t,"AutoPlayType",(function(){return mr})),r.d(t,"ThumbnailInfo",(function(){return ht})),r.d(t,"getLogger",(function(){return C})),r.d(t,"LogLevel",(function(){return k})),r.d(t,"getLogLevel",(function(){return S})),r.d(t,"setLogLevel",(function(){return A})),r.d(t,"setLogHandler",(function(){return T}));var a={};r.r(a),r.d(a,"Number",(function(){return N})),r.d(a,"String",(function(){return U})),r.d(a,"Object",(function(){return F})),r.d(a,"Generator",(function(){return B})),r.d(a,"Dom",(function(){return j})),r.d(a,"Http",(function(){return V})),r.d(a,"VERSION",(function(){return $})),r.d(a,"ResizeWatcher",(function(){return sr})),r.d(a,"MultiMap",(function(){return m})),r.d(a,"binarySearch",(function(){return ur}));var n=r(0),i=r.n(n),o=/^.*(web0s).*(smarttv).*$/i,s=/^.*(smart-tv).*(tizen).*$/i,l=/^.*(vidaa).*(smarttv).*$/i,u=[[s],[[i.a.BROWSER.NAME,"SAMSUNG_TV_BROWSER"],[i.a.BROWSER.MAJOR,""],[i.a.BROWSER.VERSION,""]]],c=[[o],[i.a.OS.NAME],[l],[i.a.OS.NAME]],d=[[o],[[i.a.DEVICE.VENDOR,"LG"],[i.a.DEVICE.TYPE,i.a.DEVICE.SMARTTV]],[s],[[i.a.DEVICE.VENDOR,"SAMSUNG"],[i.a.DEVICE.TYPE,i.a.DEVICE.SMARTTV]],[l],[[i.a.DEVICE.VENDOR,"HISENSE"],[i.a.DEVICE.TYPE,i.a.DEVICE.SMARTTV]],[/^.*(smart-tv|smarttv).*$/i],[[i.a.DEVICE.TYPE,i.a.DEVICE.SMARTTV]]],p=[[/(edg)\/((\d+)?[\w.]+)/i],[[i.a.BROWSER.NAME,"Edge"],i.a.BROWSER.VERSION,i.a.BROWSER.MAJOR]],h=[].concat(p,u),f=new i.a(void 0,{browser:h,device:d,os:c}).getResult();f.isConsole=f.device.type===i.a.DEVICE.CONSOLE,f.isSmartTV=f.device.type===i.a.DEVICE.SMARTTV,f.isMobile=f.device.type===i.a.DEVICE.MOBILE,f.isTablet=f.device.type===i.a.DEVICE.TABLET,f.isWearable=f.device.type===i.a.DEVICE.WEARABLE,f.isEmbedded=f.device.type===i.a.DEVICE.EMBEDDED,f.isIPadOS="Mac OS"===f.os.name&&"ontouchend"in document,f.isSafari=f.browser.name.includes("Safari"),f.isIOS="iOS"===f.os.name,f.isMacOS="Mac OS"===f.os.name;var g=f;function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var m=function(){function e(){this._map=new Map}var t=e.prototype;return t.push=function(e,t){if(this._map.has(e)){var r=this._map.get(e);Array.isArray(r)&&(r.push(t),this._map.set(e,r))}else this._map.set(e,[t])},t.set=function(e,t){this._map.set(e,t)},t.has=function(e){return this._map.has(e)},t.get=function(e){var t=this._map.get(e);return t?t.slice():[]},t.getAll=function(){for(var e,t=[],r=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(this._map.values());!(e=r()).done;){var a=e.value;t=t.concat(a)}return t},t.remove=function(e,t){if(this._map.has(e)){var r=this._map.get(e);if(Array.isArray(r)){for(var a=0;a<r.length;++a)r[a]==t&&(r.splice(a,1),--a);0===r.length&&this._map.delete(e)}}},t.keys=function(){return this._map.keys()},t.clear=function(){this._map.clear()},e}(),v=function(){function e(e,t){this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance?window.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1,this.payload=t}var t=e.prototype;return t.preventDefault=function(){},t.stopImmediatePropagation=function(){this.stopped=!0},t.stopPropagation=function(){},e}(),_=r(1),k={DEBUG:_.DEBUG,INFO:_.INFO,TIME:_.TIME,WARN:_.WARN,ERROR:_.ERROR,OFF:_.OFF},E={};function T(e){_.setHandler((function(t,r){return e(t,r)}))}function b(e){return e?_.get(e):_}function S(e){return b(e).getLevel()}function A(e,t){b(t).setLevel(e)}Object.keys(k).forEach((function(e){E[e]=e})),_.useDefaults({defaultLevel:_.ERROR});var C=b,P=function(){function e(){this._listeners=new m,this.dispatchTarget=this,this.__logger=C("FakeEventTarget")}var t=e.prototype;return t.addEventListener=function(e,t){this._listeners.push(e,t)},t.removeEventListener=function(e,t){this._listeners.remove(e,t)},t.dispatchEvent=function(e){for(var t=this._listeners.get(e.type)||[],r=0;r<t.length;++r){e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;var a=t[r];try{a.handleEvent?a.handleEvent(e):a.call(this,e)}catch(t){this.__logger.error("Error occurred when handling event: "+e.type+".",t)}if(e.stopped)break}return e.defaultPrevented},e}();function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var x=function(){function e(){this._bindingMap=new m}var t=e.prototype;return t.destroy=function(){return this.removeAll(),this._bindingMap=null,Promise.resolve()},t.listenOnce=function(e,t,r,a){var n=this;this.listen(e,t,(function a(i){n.unlisten(e,t,a),r.call(n,i)}),a)},t.listen=function(e,t,r,a){var n=new I(e,t,r,a);this._bindingMap&&this._bindingMap.push(t,n)},t.unlisten=function(e,t,r){if(this._bindingMap)for(var a=this._bindingMap.get(t),n=0;n<a.length;++n){var i=a[n];i.target!==e||i.listener!==r&&r||(i.unlisten(),this._bindingMap&&this._bindingMap.remove(t,i))}},t.removeAll=function(){if(this._bindingMap){for(var e,t=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(this._bindingMap.getAll());!(e=t()).done;)e.value.unlisten();this._bindingMap&&this._bindingMap.clear()}},e}(),I=function(){function e(e,t,r,a){this.target=e,this.type=t,this.listener=r,this.options=a,this.target.addEventListener(t,r,!1)}return e.prototype.unlisten=function(){this.target&&(this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=null)},e}(),M=x,D={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,LIVE_MANIFEST_REFRESH_ERROR:1008,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_CREATE_TEXT_CUE:2009,DASH_ADAPTER_ERROR_PARSE_ISSUE:2010,UNKNOWN_FILE_TYPE:2011,UNKNOWN_LANGUAGE:2012,INVALID_VTT_THUMBNAILS_FILE:2013,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,HLS_FATAL_MEDIA_ERROR:3018,HLS_FRAG_PARSING_ERROR:3019,HLS_BUFFER_APPEND_ISSUE:3020,HLS_BUFFER_APPENDING_ISSUE:3021,NATIVE_ADAPTER_LOAD_FAILED:3022,HLS_BUFFER_STALLED_ERROR:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_LIVE_CONTENT_NOT_SUPPORTED:4029,HLSJS_CANNOT_PARSE:4030,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,BAD_FAIRPLAY_RESPONSE:6015,COULD_NOT_CREATE_MEDIA_KEYS:6016,COULD_NOT_CREATE_KEY_SESSION:6017,LOAD_INTERRUPTED:7e3,BITRATE_SWITCH_ISSUE:7001,LOAD_FAILED:7002,RUNTIME_ERROR_NOT_REGISTERED_PLUGIN:7003,RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED:7004,RUNTIME_ERROR_NOT_VALID_HANDLER:7005,NO_SOURCE_PROVIDED:7006,NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE:7007,ENTER_PICTURE_IN_PICTURE_FAILED:7008,EXIT_PICTURE_IN_PICTURE_FAILED:7009,PLUGIN_LOAD_FAILED:7010,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,CONTENT_UNSUPPORTED_BY_BROWSER:9009,CANNOT_ADD_ITEM:9010,DOWNLOAD_FAILED:9011,COULD_NOT_GET_INFO_FROM_MEDIA_PROVIDER:9012,ENTRY_DOES_NOT_EXIST:9013,PAUSE_FAILED:9014,RESUME_FAILED:9015,RENEW_LICENSE_FAILED:9016,ENTRY_ALREADY_EXISTS:9017,REMOVE_FAILED:9018,CAST_LOAD_MEDIA_FAILED:10001,CAST_CUSTOM_MESSAGE_PARSING_ERROR:10002,CAST_EDIT_TRACKS_INFO_ERROR:10003,VR_NOT_SUPPORTED:11e3};function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.assign(D,{XML_PARSING_ERROR:8100,VAST_SCHEMA_VALIDATION_ERROR:8101,VAST_RESPONSE_VERSION_NOT_SUPPORTED:8102,TRAFFICKING_ERROR:8200,VAST_UNEXPECTED_LINEARITY:8201,VAST_UNEXPECTED_DURATION_ERROR:8202,VAST_UNEXPECTED_SIZE_ERROR:8203,VAST_WRAPPER_ERROR:8300,VAST_URI_ERROR:8301,VAST_TOO_MANY_REDIRECTS:8302,NO_ADS_VAST_RESPONSE:8303,GENERAL_LINEAR_ERROR:8400,FILE_NOT_FOUND:8401,VAST_MEDIA_LOAD_TIMEOUT:8402,MEDIA_FILE_NOT_FOUND:8403,MEDIA_FILE_DISPLAY_ERROR:8405,MEZZANINE_FILE_NOT_PROVIDED:8406,MEZZANINE_DOWNLOADED_FOR_THE_FIRST_TIME:8407,VAST_RESPONSE_AD_REJECTED:8408,CREATIVE_WAS_NOT_EXECUTED:8409,CODE_REFERENCED_NOT_EXECUTED:8410,GENERAL_NON_LINEAR_AD_ERROR:8500,NON_LINEAR_CREATIVE_DIMENSIONS_NOT_ALIGN_ERROR:8501,NON_LINEAR_FETCH_ERROR:8502,NON_LINEAR_RESOURCE_NOT_FOUND:8503,GENERAL_COMPANION_ADS_ERROR:8600,COMPANION_DIMENSIONS_NOT_FIT:8601,COMPANION_CANNOT_BE_DISPLAY:8602,COMPANION_CANNOT_BE_FETCHED:8603,COMPANION_TYPE_NOT_FOUND:8604,AD_UNDEFINED_ERROR:8900,GENERAL_VPAID_ERROR:8901});var O=function e(t,r,a,n){void 0===n&&(n={}),this.severity=t,this.category=r,this.code=a,this.data=n,S("Error")!==k.OFF&&e._logger.error("Category:"+r+" | Code:"+a+" |",n)};function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}R(O,"Severity",{RECOVERABLE:1,CRITICAL:2}),R(O,"Category",{NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,ADS:8,STORAGE:9,CAST:10,VR:11}),R(O,"Code",D),R(O,"_logger",C("Error"));var N={isNumber:function(e){return Number(e)===e},isInt:function(e){return this.isNumber(e)&&e%1==0},isFloat:function(e){return this.isNumber(e)&&e%1!=0}},U={capitlize:function(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)},endsWith:function(e,t){return"string"==typeof e&&"string"==typeof t&&-1!=e.indexOf(t,e.length-t.length)}},F={merge:function(e){for(var t,r={},a=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(e);!(t=a()).done;){var n=t.value;Object.assign(r,n)}return r},isObject:function(e){return e&&"object"==typeof e&&!Array.isArray(e)},isClassInstance:function(e){return e&&e.constructor&&e.constructor.name&&"Object"!==e.constructor.name},mergeDeep:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];if(!r.length)return e;var n=r.shift();if(this.isObject(e)&&this.isObject(n))for(var i in n){var o,s;this.isObject(n[i])&&!this.isClassInstance(n[i])?(e[i]||Object.assign(e,((o={})[i]={},o)),this.mergeDeep(e[i],n[i])):Object.assign(e,((s={})[i]=n[i],s))}return this.mergeDeep.apply(this,[e].concat(r))},copyDeep:function(e){var t,r=this;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach((function(e,a){("object"==typeof e&&e!=={}||Array.isArray(e)&&e.length>0)&&(t[a]=r.copyDeep(e))})):null!==e&&"object"==typeof e?e.clone&&"function"==typeof e.clone?t=e.clone():(t=Object.assign({__proto__:e.__proto__},e),Object.keys(t).forEach((function(e){("object"==typeof t[e]&&t[e]!=={}||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=r.copyDeep(t[e]))}))):t=e,t},isEmptyObject:function(e){for(var t in e)if(window.Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},getPropertyPath:function(e,t){return t.split(".").reduce((function(e,t){return null==e?e:e[t]}),e)},hasPropertyPath:function(e,t){if(!t)return!1;for(var r=t.split("."),a=0;a<r.length;a++){var n=r[a];if(!e||!window.Object.prototype.hasOwnProperty.call(e,n))return!1;e=e[n]}return!0},createPropertyPath:function(e,t,r){void 0===r&&(r=null);for(var a=t.split("."),n=e;a.length>1;){var i=a,o=i[0];a=i.slice(1),void 0===n[o]&&(n[o]={}),n=n[o]}return n[a[0]]=r,e},deletePropertyPath:function(e,t){if(e&&t){for(var r=t.split("."),a=0;a<r.length-1;a++)if(void 0===(e=e[r[a]]))return;delete e[r.pop()]}},defer:function(){var e,t,r=new Promise((function(r,a){e=r,t=a}));return r.resolve=e,r.reject=t,r},bind:function(e,t){return function(){t.apply(e,arguments)}}},B={uniqueId:function(e){var t=2+(!e||e<0?0:e-2);return"_"+Math.random().toString(36).substr(2,t)},guid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},j={addClassName:function(e,t){e&&(e.classList?e.classList.add(t):j.hasClassName(e,t)||(e.className+=t))},removeClassName:function(e,t){e&&(e.classList?e.classList.remove(t):j.hasClassName(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,"")))},hasClassName:function(e,t){return e&&e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},setAttribute:function(e,t,r){e.setAttribute(t,r)},removeAttribute:function(e,t){e.removeAttribute(t)},setStyle:function(e,t,r){void 0!==e.style.getPropertyValue(t)&&e.style.setProperty(t,r)},appendChild:function(e,t){e&&t&&e.appendChild&&e.appendChild(t)},removeChild:function(e,t){e&&t&&e.removeChild&&e.removeChild(t)},prependTo:function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},getElementById:function(e){return document.getElementById(e)},getElementsByTagName:function(e){return document.getElementsByTagName(e)},createElement:function(e){return document.createElement(e)},loadStyleSheetAsync:function(e){var t=this;return new Promise((function(r,a){var n=!1,i=t.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,i.async=!0,i.onload=i.onreadystatechange=function(){n||this.readyState&&"complete"!==this.readyState||(n=!0,r(this))},i.onerror=i.onabort=a,j.appendChild(document.head,i)}))},loadScriptAsync:function(e){var t=this;return new Promise((function(r,a){var n=!1,i=document.getElementsByTagName("script")[0],o=t.createElement("script");o.type="text/javascript",o.src=e,o.async=!0,o.onload=o.onreadystatechange=function(){n||this.readyState&&"complete"!==this.readyState||(n=!0,r(this))},o.onerror=o.onabort=a,i&&i.parentNode&&i.parentNode.insertBefore(o,i)}))},getElementBySelector:function(e){try{return document.querySelector(e)}catch(e){return}},insertBefore:function(e,t,r){try{return e.insertBefore(t,r)}catch(e){return null}}},V={protocol:/^(https?:)/i.test(document.location.protocol)?document.location.protocol:"https:",execute:function(e,t,r,a,n,i){void 0===r&&(r="POST");var o=new XMLHttpRequest;return new Promise((function(s,l){o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status)try{var e=JSON.parse(o.responseText);s(e)}catch(e){s(o.responseText)}else l(o.responseText)},o.open(r,e),a&&a.forEach((function(e,t){o.setRequestHeader(t,e)})),n&&(o.timeout=n),i&&(o.ontimeout=function(e){i(),l(e)}),o.send(t)}))},jsonp:function(e,t,r){var a,n=(r=r||{}).timeout?r.timeout:5e3,i=document.createElement("script"),o="jsonpcallback"+Math.round(Date.now()+1000001*Math.random()),s=e,l=function(){i&&i.parentNode&&i.parentNode.removeChild(i),window[o]=function(){},a&&clearTimeout(a)};return new Promise((function(r,u){n&&(a=setTimeout((function(){l(),u(new O(O.Severity.CRITICAL,O.Category.NETWORK,O.Code.TIMEOUT,e))}),n)),window[o]=function(a){var n=t(a,e);l(),r(n)},s.match(/\?/)?s+="&responseFormat=jsonp&callback="+o:s+="?responseFormat=jsonp&callback="+o,i.type="text/javascript",i.src=s,document.getElementsByTagName("head")[0].appendChild(i)}))},convertHeadersToDictionary:function(e){var t={};try{e.trim().split(/[\r\n]+/).forEach((function(e){var r=e.split(": "),a=r.shift().toLowerCase(),n=r.join(": ");t[a]=n}))}catch(e){}return t}},$={compare:function(e,t,r){void 0===r&&(r={});var a=(r=F.merge([{lexicographical:!1,zeroExtend:!0},r])).lexicographical,n=r.zeroExtend,i=(e||"0").split("."),o=(t||"0").split("."),s=function(e){return(a?/^\d+[A-Za-zαß]*$/:/^\d+[A-Za-zαß]?$/).test(e)},l=function(e){return e.map((function(e){var t=/[A-Za-zαß]/.exec(e);return Number(t?e.replace(t[0],"."+e.charCodeAt(t.index)):e)}))};if(!i.every(s)||!o.every(s))return NaN;if(n){for(;i.length<o.length;)i.push("0");for(;o.length<i.length;)o.push("0")}a||(i=l(i),o=l(o));for(var u=0;u<i.length;++u){if(o.length===u)return 1;if(i[u]!==o[u])return i[u]>o[u]?1:-1}return i.length!==o.length?-1:0}};function H(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var G=function(){function e(){this._createEl()}var t,r,a=e.prototype;return a.setSrc=function(e){e&&(this._posterUrl=e,j.setStyle(this._el,"background-image",'url("'+this._posterUrl+'")'),this.hide())},a.getElement=function(){return this._el},a._createEl=function(){if(!this._el){var e=this._el=j.createElement("div");j.setAttribute(e,"id",B.uniqueId(5)),j.setAttribute(e,"tabindex","-1")}},a._removeEl=function(){this._el&&j.removeChild(this._el.parentNode,this._el)},a.show=function(){j.setStyle(this._el,"display","")},a.hide=function(){j.setStyle(this._el,"display","none")},a.reset=function(){this._posterUrl="",j.setStyle(this._el,"background-image","")},a.destroy=function(){this.reset(),this._removeEl()},t=e,(r=[{key:"src",get:function(){return this._posterUrl}}])&&H(t.prototype,r),e}(),K={AD_CAN_SKIP:"adcanskip",AD_MANIFEST_LOADED:"admanifestloaded",AD_LOADED:"adloaded",AD_STARTED:"adstarted",AD_RESUMED:"adresumed",AD_PAUSED:"adpaused",AD_CLICKED:"adclicked",AD_SKIPPED:"adskipped",AD_COMPLETED:"adcompleted",AD_ERROR:"aderror",ADS_COMPLETED:"adscompleted",ALL_ADS_COMPLETED:"alladscompleted",AD_BREAK_START:"adbreakstart",AD_BREAK_END:"adbreakend",AD_FIRST_QUARTILE:"adfirstquartile",AD_MIDPOINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",USER_CLOSED_AD:"userclosedad",AD_VOLUME_CHANGED:"advolumechanged",AD_MUTED:"admuted",AD_PROGRESS:"adprogress",AD_BUFFERING:"adbuffering",AD_WATERFALLING:"adwaterfalling",AD_WATERFALLING_FAILED:"adwaterfallingfailed",AD_AUTOPLAY_FAILED:"adautoplayfailed"},W={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},z={MEDIA_LOADED:"medialoaded",PLAYER_RESET:"playerreset",PLAYER_DESTROY:"playerdestroy",ENTER_FULLSCREEN:"enterfullscreen",EXIT_FULLSCREEN:"exitfullscreen",PLAY_FAILED:"playfailed",AUTOPLAY_FAILED:"autoplayfailed",FALLBACK_TO_MUTED_AUTOPLAY:"fallbacktomutedautoplay",CHANGE_SOURCE_STARTED:"changesourcestarted",CHANGE_SOURCE_ENDED:"changesourceended",MUTE_CHANGE:"mutechange",VIDEO_TRACK_CHANGED:"videotrackchanged",AUDIO_TRACK_CHANGED:"audiotrackchanged",TEXT_TRACK_CHANGED:"texttrackchanged",IMAGE_TRACK_CHANGED:"imagetrackchanged",TEXT_TRACK_ADDED:"texttrackadded",TEXT_CUE_CHANGED:"textcuechanged",TRACKS_CHANGED:"trackschanged",ABR_MODE_CHANGED:"abrmodechanged",PLAYER_STATE_CHANGED:"playerstatechanged",PLAYBACK_START:"playbackstart",FIRST_PLAY:"firstplay",FIRST_PLAYING:"firstplaying",PLAYBACK_ENDED:"playbackended",SOURCE_SELECTED:"sourceselected",TEXT_STYLE_CHANGED:"textstylechanged",MEDIA_RECOVERED:"mediarecovered",VR_STEREO_MODE_CHANGED:"vrstereomodechanged",FPS_DROP:"fpsdrop",BOOKMARK_ERROR:"bookmarkerror",CONCURRENCY_LIMIT:"concurrencylimit",RESIZE:"resize",TIMED_METADATA:"timedmetadata",TIMED_METADATA_CHANGE:"timedmetadatachange",TIMED_METADATA_ADDED:"timedmetadataadded",FRAG_LOADED:"fragloaded",MANIFEST_LOADED:"manifestloaded",USER_GESTURE:"usergesture",DRM_LICENSE_LOADED:"drmlicenseloaded",SOURCE_URL_SWITCHED:"sourceurlswitched"},q=F.merge([W,z,K]);function Y(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var X=function(){function e(){}var t,r;return t=e,(r=[{key:"language",get:function(){var e;return(e=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage?navigator.userLanguage:navigator.language)&&e.match("-")&&(e=e.split("-")[0]),e}}])&&Y(t,r),e}();function Q(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var J=function(){function e(e){this.type=e,this._duration=0,this._timestamp=Date.now()/1e3}var t,r;return t=e,(r=[{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e-this._timestamp}}])&&Q(t.prototype,r),e}(),Z={IDLE:"idle",LOADING:"loading",PLAYING:"playing",PAUSED:"paused",BUFFERING:"buffering"};function ee(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var te=function(){function e(e){var t,r,a,n,i,o,s,l,u,c=this;s=this,l="_transitions",(o={})[Z.IDLE]=((t={})[W.LOAD_START]=function(){return c._updateState(Z.LOADING)},t[W.PLAY]=function(){return c._updateState(Z.BUFFERING)},t[W.SEEKED]=function(){return c._updateState(Z.PAUSED)},t),o[Z.LOADING]=((r={})[W.LOADED_METADATA]=function(){return c._updateState(Z.PAUSED)},r[W.ERROR]=function(e){return e.payload.severity===O.Severity.CRITICAL&&c._updateState(Z.IDLE)},r[W.SEEKED]=function(){c._prevState&&c._prevState.type===Z.PLAYING&&c._updateState(Z.PLAYING)},r),o[Z.PAUSED]=((a={})[W.PLAY]=function(){return c._updateState(Z.PLAYING)},a[W.PLAYING]=function(){return c._updateState(Z.PLAYING)},a[W.ENDED]=function(){return c._updateState(Z.IDLE)},a),o[Z.PLAYING]=((n={})[W.PAUSE]=function(){return c._updateState(Z.PAUSED)},n[W.WAITING]=function(){c._player.seeking?c._updateState(Z.LOADING):(c._updateState(Z.BUFFERING),c._lastWaitingTime=c._player.currentTime)},n[W.ENDED]=function(){return c._updateState(Z.IDLE)},n[W.ERROR]=function(e){return e.payload.severity===O.Severity.CRITICAL&&c._updateState(Z.IDLE)},n),o[Z.BUFFERING]=((i={})[W.PLAYING]=function(){return c._updateState(Z.PLAYING)},i[W.PAUSE]=function(){return c._updateState(Z.PAUSED)},i[W.TIME_UPDATE]=function(){"IE"===g.browser.name&&c._player.currentTime!==c._lastWaitingTime&&c._prevState&&c._prevState.type===Z.PLAYING&&(c._lastWaitingTime=null,c._updateState(Z.PLAYING))},i),u=o,l in s?Object.defineProperty(s,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[l]=u,this._player=e,this._logger=C("StateManager"),this._eventManager=new M,this._history=[],this._prevState=null,this._curState=new J(Z.IDLE),this._attachListeners()}var t,r,a=e.prototype;return a._attachListeners=function(){this._eventManager.listen(this._player,W.ERROR,this._doTransition.bind(this)),this._eventManager.listen(this._player,W.ENDED,this._doTransition.bind(this)),this._eventManager.listen(this._player,W.PLAY,this._doTransition.bind(this)),this._eventManager.listen(this._player,W.LOAD_START,this._doTransition.bind(this)),this._eventManager.listen(this._player,W.PLAYING,this._doTransition.bind(this)),this._eventManager.listen(this._player,W.LOADED_METADATA,this._doTransition.bind(this)),this._eventManager.listen(this._player,W.PAUSE,this._doTransition.bind(this)),this._eventManager.listen(this._player,W.WAITING,this._doTransition.bind(this)),this._eventManager.listen(this._player,W.SEEKED,this._doTransition.bind(this)),this._eventManager.listen(this._player,W.TIME_UPDATE,this._doTransition.bind(this))},a._doTransition=function(e){(e.type!==W.TIME_UPDATE||this._curState===Z.BUFFERING&&e.type===W.TIME_UPDATE)&&this._logger.debug("Do transition request",e.type);var t=this._transitions[this._curState.type];"function"==typeof t[e.type]&&t[e.type](e)},a._updateState=function(e){this._curState.type!==e&&(this._curState.duration=Date.now()/1e3,this._history.push(this._curState),this._prevState=this._curState,this._curState=new J(e),this._logger.debug("Switch player state: from "+this._prevState.type+" to "+this._curState.type),this._dispatchEvent())},a._dispatchEvent=function(){var e=new v(z.PLAYER_STATE_CHANGED,{oldState:this._prevState,newState:this._curState});this._player.dispatchEvent(e)},a.destroy=function(){this._history=[],this._eventManager.destroy()},a.reset=function(){this._history=[]},t=e,(r=[{key:"currentState",get:function(){return this._curState}},{key:"previousState",get:function(){return this._prevState}},{key:"history",get:function(){return this._history}}])&&ee(t.prototype,r),e}();function re(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var ae=function(){var e,t;function r(e){void 0===e&&(e={}),this._id=e.id,this._active=e.active,this._label=e.label,this._language=e.language,this._index=e.index,this._available="boolean"!=typeof e.available||e.available,this.clone=r.clone.bind(null,this)}return r.langComparer=function(e,t,r,a){try{return e=e.toLowerCase(),t=t.toLowerCase(),r&&(r=r.toLowerCase()),a?e===t||r===t:!!e&&(e.startsWith(t)||t.startsWith(e))}catch(e){return!1}},r.clone=function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)},e=r,(t=[{key:"id",get:function(){return this._id}},{key:"active",get:function(){return this._active},set:function(e){this._active=e}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"language",get:function(){return this._language}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"available",get:function(){return this._available},set:function(e){this._available=e}}])&&re(e.prototype,t),r}();function ne(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var ie=function(e){var t,r,a,n;function i(t){var r;return void 0===t&&(t={}),(r=e.call(this,t)||this)._bandwidth=t.bandwidth,r._width=t.width,r._height=t.height,r._label=t.label?t.label:r._height?r._height+"p":void 0,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a=i,(n=[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}])&&ne(a.prototype,n),i}(ae),oe=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(ae);function se(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ue={"":!0,up:!0};function ce(e){return"number"==typeof e&&e>=0&&e<=100}var de,pe=function(){function e(){le(this,"_width",100),le(this,"_lines",3),le(this,"_regionAnchorX",0),le(this,"_regionAnchorY",100),le(this,"_viewportAnchorX",0),le(this,"_viewportAnchorY",100),le(this,"_scroll","")}var t,r;return t=e,(r=[{key:"width",get:function(){return this._width},set:function(e){if(!ce(e))throw new Error("Width must be between 0 and 100.");this._width=e}},{key:"scroll",get:function(){return this._scroll},set:function(e){var t=function(e){return"string"==typeof e&&!!ue[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");this._scroll=t}},{key:"viewportAnchorY",get:function(){return this._viewportAnchorY},set:function(e){if(!ce(e))throw new Error("ViewportAnchorY must be between 0 and 100.");this._viewportAnchorY=e}},{key:"viewportAnchorX",get:function(){return this._viewportAnchorX},set:function(e){if(!ce(e))throw new Error("ViewportAnchorX must be between 0 and 100.");this._viewportAnchorX=e}},{key:"regionAnchorX",get:function(){return this._regionAnchorX},set:function(e){if(!ce(e))throw new Error("RegionAnchorY must be between 0 and 100.");this._regionAnchorX=e}},{key:"lines",get:function(){return this._lines},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");this._lines=e}},{key:"regionAnchorY",get:function(){return this._regionAnchorY},set:function(e){if(!ce(e))throw new Error("RegionAnchorX must be between 0 and 100.");this._regionAnchorY=e}}])&&se(t.prototype,r),e}();function he(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}de="undefined"!=typeof window&&window.VTTRegion?window.VTTRegion:pe;var ge=function(){function e(){fe(this,"_fontSizeIndex",2),fe(this,"fontFamily",e.FontFamily.SANS_SERIF),fe(this,"fontColor",e.StandardColors.WHITE),fe(this,"fontOpacity",e.StandardOpacities.OPAQUE),fe(this,"backgroundColor",e.StandardColors.BLACK),fe(this,"backgroundOpacity",e.StandardOpacities.OPAQUE),fe(this,"fontEdge",e.EdgeStyles.NONE)}e.toRGBA=function(e,t){return"rgba("+e.concat(t).join(",")+")"},e.fromJson=function(t){var r=function(e,t){return null!=e?e:t},a=new e;return a.fontEdge=r(t.fontEdge,a.fontEdge),a.fontSize=r(t.fontSize,a.fontSize),a.fontScale=r(t.fontScale,a.fontScale),a.fontColor=r(t.fontColor,a.fontColor),a.fontOpacity=r(t.fontOpacity,a.fontOpacity),a.backgroundColor=r(t.backgroundColor,a.backgroundColor),a.backgroundOpacity=r(t.backgroundOpacity,a.backgroundOpacity),a.fontFamily=r(t.fontFamily,a.fontFamily),a},e.toJson=function(e){return{fontEdge:e.fontEdge,fontSize:e.fontSize,fontScale:e.fontScale,fontColor:e.fontColor,fontOpacity:e.fontOpacity,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity,fontFamily:e.fontFamily}};var t,r,a=e.prototype;return a.getTextShadow=function(){for(var t=[],r=0;r<this.fontEdge.length;r++){var a=this.fontEdge[r].slice(0,3),n=this.fontEdge[r].slice(3,6);t.push(e.toRGBA(a,this.fontOpacity)+" "+n.join("px ")+"px")}return t.join(",")},a.toCSS=function(){var t=[];return t.push("font-family: "+this.fontFamily),t.push("color: "+e.toRGBA(this.fontColor,this.fontOpacity)),t.push("background-color: "+e.toRGBA(this.backgroundColor,this.backgroundOpacity)),t.push("text-shadow: "+this.getTextShadow()),t.join("!important; ")},a.clone=function(){return e.fromJson(e.toJson(this))},a.isEqual=function(t){return JSON.stringify(e.toJson(this))===JSON.stringify(e.toJson(t))},t=e,(r=[{key:"fontSize",set:function(t){var r=e.FontSizes.findIndex((function(e){return e.label===t}));-1!==r&&(this._fontSizeIndex=r)},get:function(){return e.FontSizes[this._fontSizeIndex].label}},{key:"fontScale",set:function(t){var r=e.FontSizes.findIndex((function(e){return e.value===t}));-1!==r&&(this._fontSizeIndex=r)},get:function(){return e.FontSizes[this._fontSizeIndex].value}},{key:"implicitFontScale",get:function(){return.25*e.FontSizes[this._fontSizeIndex].value+1}}])&&he(t.prototype,r),e}();fe(ge,"FontFamily",{ARIAL:"Arial",HELVETICA:"Helvetica",VERDANA:"Verdana",SANS_SERIF:"sans-serif"}),fe(ge,"StandardColors",{WHITE:[255,255,255],BLACK:[0,0,0],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]}),fe(ge,"StandardOpacities",{OPAQUE:1,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0}),fe(ge,"EdgeStyles",{NONE:[],RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]}),fe(ge,"FontSizes",[{value:-2,label:"50%"},{value:-1,label:"75%"},{value:0,label:"100%"},{value:2,label:"200%"},{value:3,label:"300%"},{value:4,label:"400%"}]);var ye=ge;function me(e){function t(e,t,r,a){return 3600*(0|e)+60*(0|t)+(0|r)+(0|a)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}var ve={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},_e={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},ke={v:"title",lang:"lang"},Ee={rt:"ruby"};function Te(){this.values=Re(null)}function be(e,t,r,a){var n=a?e.split(a):[e];for(var i in n)if("string"==typeof n[i]){var o=n[i].split(r);2===o.length&&t(o[0],o[1])}}function Se(e,t,r){var a=e;function n(){var t=me(e);if(null===t)throw new Oe(Oe.Errors.BadTimeStamp,"Malformed timestamp: "+a);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){e=e.replace(/^\s+/,"")}if(i(),t.startTime=n(),i(),"--\x3e"!==e.substr(0,3))throw new Oe(Oe.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+a);e=e.substr(3),i(),t.endTime=n(),i(),function(e,t){var a=new Te;be(e,(function(e,t){switch(e){case"region":for(var n=r.length-1;n>=0;n--)if(r[n].id===t){a.set(e,r[n].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),o=i[0];a.integer(e,o),a.percent(e,o)&&a.set("snapToLines",!1),a.alt(e,o,["auto"]),2===i.length&&a.alt("lineAlign",i[1],["start","center","end"]);break;case"position":i=t.split(","),a.percent(e,i[0]),2===i.length&&a.alt("positionAlign",i[1],["start","center","end"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=a.get("region",null),t.vertical=a.get("vertical",""),t.line=a.get("line",t.line||"auto"),t.lineAlign=a.get("lineAlign","start"),t.snapToLines=a.get("snapToLines",!0),t.size=a.get("size",100);try{t.align=a.get("align","center")}catch(e){t.align=a.get("align","middle")}t.position=a.get("position",t.position||"auto"),t.positionAlign=a.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}function Ae(e,t){function r(){if(!t)return null;var e,r=t.match(/^([^<]*)(<[^>]+>?)?/);return e=r[1]?r[1]:r[2],t=t.substr(e.length),e}function a(e){return ve[e]}function n(e){for(var t;t=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(t[0],a);return e}function i(e,t){return!Ee[t.localName]||Ee[t.localName]===e.localName}function o(t,r){var a=_e[t];if(!a)return null;var n=e.document.createElement(a),i=ke[t];return i&&r&&(n[i]=r.trim()),n}for(var s,l=e.document.createElement("div"),u=l,c=[];null!==(s=r());)if("<"!==s[0])u.appendChild(e.document.createTextNode(n(s)));else{if("/"===s[1]){c.length&&c[c.length-1]===s.substr(2).replace(">","")&&(c.pop(),u=u.parentNode);continue}var d=me(s.substr(1,s.length-2)),p=void 0;if(d){p=e.document.createProcessingInstruction("timestamp",d),u.appendChild(p);continue}var h=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!h)continue;if(!(p=o(h[1],h[3])))continue;if(!i(u,p))continue;h[2]&&(p.className=h[2].substr(1).replace("."," ")),c.push(h[1]),u.appendChild(p),u=p}return l}Te.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var a=0;a<r.length;++a)if(t===r[a]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var Ce=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Pe(e){for(var t=0;t<Ce.length;t++){var r=Ce[t];if(e>=r[0]&&e<=r[1])return!0}return!1}var we=function(e){var t,r;function a(t,r,a){var n;n=e.call(this)||this;var i="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent);"undefined"!=typeof WebVTTSet&&(WebVTTSet.fontSet,WebVTTSet.backgroundSet,WebVTTSet.edgeSet),n.cue=r,n.cueDiv=Ae(t,r.text);var o={color:a.color,backgroundColor:a.backgroundColor,textShadow:a.textShadow,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};i||(o.writingMode=""===r.vertical?"horizontal-tb":"lr"===r.vertical?"vertical-lr":"vertical-rl",o.unicodeBidi="plaintext"),n.applyStyles(o,n.cueDiv),n.div=t.document.createElement("div"),o={textAlign:"middle"===r.align?"center":r.align,font:a.font,whiteSpace:"pre-line",position:"absolute"},i||(o.direction=function(e){var t=[],r="";if(!e||!e.childNodes)return"ltr";function a(e,t){for(var r=t.childNodes.length-1;r>=0;r--)e.push(t.childNodes[r])}function n(e){if(!e||!e.length)return null;var t=e.pop(),r=t.textContent||t.innerText;if(r){var i=r.match(/^.*(\n|\r)/);return i?(e.length=0,i[0]):r}return"ruby"===t.tagName?n(e):t.childNodes?(a(e,t),n(e)):void 0}for(a(t,e);r=n(t);)for(var i=0;i<r.length;i++)if(Pe(r.charCodeAt(i)))return"rtl";return"ltr"}(n.cueDiv),o.writingMode=""===r.vertical?"horizontal-tb":"lr"===r.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),n.applyStyles(o),n.div.appendChild(n.cueDiv);var s=0;switch(r.positionAlign||r.align){case"start":case"left":case"line-left":s=r.position;break;case"center":s=r.position-r.size/2;break;case"end":case"right":case"line-right":s=r.position-r.size}return""===r.vertical?n.applyStyles({left:n.formatStyle(s,"%"),width:n.formatStyle(Math.min(r.size,100-s)||r.size,"%")}):n.applyStyles({top:n.formatStyle(s,"%"),height:n.formatStyle(Math.min(r.size,100-s)||r.size,"%")}),n.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})},n}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(function(){function e(){}var t=e.prototype;return t.applyStyles=function(e,t){for(var r in t=t||this.div,e)e.hasOwnProperty(r)&&(t.style[r]=e[r])},t.formatStyle=function(e,t){return 0===e?0:e+t},e}()),xe=function(){function e(e){var t,r,a,n;if(function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"overlaps",(function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top})),e.div){r=e.div.offsetHeight,a=e.div.offsetWidth,n=e.div.offsetTop;var i=(i=e.div.childNodes)&&(i=i[0])&&i.getClientRects&&i.getClientRects();e=e.div.getBoundingClientRect(),t=i?Math.max(i[0]&&i[0].height||0,e.height/i.length):0}this.left=e.left,this.right=e.right,this.top=e.top||n,this.height=e.height||r,this.bottom=e.bottom||n+(e.height||r),this.width=e.width||a,this.lineHeight=t||e.lineHeight||13}var t=e.prototype;return t.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},t.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},t.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},t.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},t.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},t.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},e.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,r=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,a=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||a,height:e.height||t,bottom:e.bottom||a+(e.height||t),width:e.width||r}},e}();function Ie(e,t,r,a){var n=new xe(t),i=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,r=t.textTrackList,a=0,n=0;n<r.length&&r[n]!==t;n++)r[n].mode===Xe.MODE.SHOWING&&a++;return-1*++a}(i),s=[];if(i.snapToLines){var l;switch(i.vertical){case"":s=["+y","-y"],l="height";break;case"rl":s=["+x","-x"],l="width";break;case"lr":s=["-x","+x"],l="width"}var u=n.lineHeight,c=u*Math.round(o),d=r[l]+u,p=s[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/u)*u),o<0&&(c+=""===i.vertical?r.height:r.width,s=s.reverse()),n.move(p,c)}else{var h=n.lineHeight/r.height*100;switch(i.lineAlign){case"center":o-=h/2;break;case"end":o-=h}switch(i.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],n=new xe(t)}var f=function(e,t){for(var n,i=new xe(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(r,t[s])||e.within(r)&&e.overlapsAny(a);)e.move(t[s]);if(e.within(r))return e;var l=e.intersectPercentage(r);o>l&&(n=new xe(e),o=l),e=new xe(i)}return n||i}(n,s);t.move(f.toCSSCompatValues(r))}var Me=function(e,t){this.window=e,this.state="INITIAL",this.buffer="",this.decoder=t||new TextDecoder("utf8"),this.regionList=[]},De=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},Re=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function Oe(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function Le(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Oe.prototype=Re(Error.prototype),Oe.prototype.constructor=Oe,Oe.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Me.prototype={reportOrThrowError:function(e){if(!(e instanceof Oe))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function r(){for(var e=t.buffer,r=0;r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var a=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),a}function a(e){be(e,(function(e,r){switch(e){case"Region":!function(e){var r=new Te;if(be(e,(function(e,t){switch(e){case"id":r.set(e,t);break;case"width":r.percent(e,t);break;case"lines":r.integer(e,t);break;case"regionanchor":case"viewportanchor":var a=t.split(",");if(2!==a.length)break;var n=new Te;if(n.percent("x",a[0]),n.percent("y",a[1]),!n.has("x")||!n.has("y"))break;r.set(e+"X",n.get("x")),r.set(e+"Y",n.get("y"));break;case"scroll":r.alt(e,t,["up"])}}),/=/,/\s/),r.has("id")){var a=new de;a.width=r.get("width",100),a.lines=r.get("lines",3),a.regionAnchorX=r.get("regionanchorX",0),a.regionAnchorY=r.get("regionanchorY",100),a.viewportAnchorX=r.get("viewportanchorX",0),a.viewportAnchorY=r.get("viewportanchorY",100),a.scroll=r.get("scroll",""),t.onregion&&t.onregion(a),t.regionList.push({id:r.get("id"),region:a})}}(r)}}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var i=(n=r()).match(/^WEBVTT([ \t].*)?$/);if(!i||!i[0])throw new Oe(Oe.Errors.BadSignature);t.state="HEADER"}for(var o=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:n=r(),t.state){case"HEADER":/:/.test(n)?a(n):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new je(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":try{Se(n,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==n.indexOf("--\x3e");if(!n||s&&(o=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Oe(Oe.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}};var Ue={"":!0,lr:!0,rl:!0},Fe={start:!0,center:!0,end:!0,left:!0,right:!0};function Be(e){return"string"==typeof e&&!!Fe[e.toLowerCase()]&&e.toLowerCase()}var je,Ve,$e,He=function(){function e(e,t,r){Ne(this,"hasBeenReset",!1),Ne(this,"displayState",void 0),Ne(this,"_id",""),Ne(this,"_pauseOnExit",!1),Ne(this,"_region",null),Ne(this,"_vertical",""),Ne(this,"_snapToLines",!0),Ne(this,"_line","auto"),Ne(this,"_lineAlign","start"),Ne(this,"_position",50),Ne(this,"_positionAlign","center"),Ne(this,"_size",50),Ne(this,"_align","center"),this._startTime=e,this._endTime=t,this._text=r}var t,r,a=e.prototype;return a.resetCue=function(){this.hasBeenReset=!0},a.getCueAsHTML=function(){return function(e,t){return e&&t?Ae(e,t):null}(window,this.text)},t=e,(r=[{key:"id",get:function(){return this._id},set:function(e){this._id=""+e}},{key:"pauseOnExit",get:function(){return this._pauseOnExit},set:function(e){this._pauseOnExit=e}},{key:"startTime",get:function(){return this._startTime},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");this._startTime=e,this.resetCue()}},{key:"endTime",get:function(){return this._endTime},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");this._endTime=e,this.resetCue()}},{key:"text",get:function(){return this._text},set:function(e){this._text=""+e,this.resetCue()}},{key:"region",get:function(){return this._region},set:function(e){this._region=e,this.resetCue()}},{key:"vertical",get:function(){return this._vertical},set:function(e){var t=function(e){return"string"==typeof e&&!!Ue[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._vertical=t,this.resetCue())}},{key:"snapToLines",get:function(){return this._snapToLines},set:function(e){this._snapToLines=e,this.resetCue()}},{key:"line",get:function(){return this._line},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");this._line=e,this.resetCue()}},{key:"lineAlign",get:function(){return this._lineAlign},set:function(e){var t=Be(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._lineAlign=t,this.resetCue())}},{key:"position",get:function(){return this._position},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");this._position=e,this.resetCue()}},{key:"positionAlign",get:function(){return this._positionAlign},set:function(e){var t=Be(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._positionAlign=t,this.resetCue())}},{key:"size",get:function(){return this._size},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");this._size=e,this.resetCue()}},{key:"align",get:function(){return this._align},set:function(e){var t=Be(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._align=t,this.resetCue())}}])&&Le(t.prototype,r),e}();function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Ke(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}je="undefined"!=typeof window&&window.VTTCue?window.VTTCue:He;var We,ze,qe=($e=Ve=function(e){var t,r,a,n;function i(t){var r;return void 0===t&&(t={}),(r=e.call(this,t)||this)._label=r.label||r.language,r._kind=t.kind,r._external=t.external,r._index=i._generateIndex(),r._default=t.default||!1,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i._generateIndex=function(){return i._tracksCount++},i.reset=function(){i._tracksCount=0},a=i,(n=[{key:"kind",get:function(){return this._kind}},{key:"external",get:function(){return this._external}},{key:"default",get:function(){return this._default}}])&&Ke(a.prototype,n),i}(ae),(ze="_tracksCount")in(We=Ve)?Object.defineProperty(We,ze,{value:0,enumerable:!0,configurable:!0,writable:!0}):We[ze]=0,$e);function Ye(e){for(var t,r=[],a=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ge(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(e);!(t=a()).done;){var n=t.value;if(window.VTTCue&&n instanceof window.VTTCue||window.DataCue&&n instanceof window.DataCue)r.push(n);else if(window.TextTrackCue&&n instanceof window.TextTrackCue)try{r.push(new je(n.startTime,n.endTime,n.text))}catch(e){new O(O.Severity.RECOVERABLE,O.Category.TEXT,O.Code.UNABLE_TO_CREATE_TEXT_CUE,e)}}return r}qe.MODE={DISABLED:"disabled",SHOWING:"showing",HIDDEN:"hidden"},qe.KIND={METADATA:"metadata",SUBTITLES:"subtitles",CAPTIONS:"captions"},qe.EXTERNAL_TRACK_ID="playkit-external-track",qe.isMetaDataTrack=function(e){return e&&e.kind===qe.KIND.METADATA},qe.isNativeTextTrack=function(e){return e&&[qe.KIND.SUBTITLES,qe.KIND.CAPTIONS].includes(e.kind)},qe.isExternalTrack=function(e){return e&&[e.language,e.label].includes(qe.EXTERNAL_TRACK_ID)};var Xe=qe,Qe=Object.freeze({VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"}),Je={DASH:"dash",HLS:"hls",PROGRESSIVE:"progressive",IMAGE:"image"},Ze={HTML5:"html5",FLASH:"flash",SILVERLIGHT:"silverlight",CAST:"cast",YOUTUBE:"youtube",IMAGE:"image"},et={VOD:"Vod",LIVE:"Live",AUDIO:"Audio",IMAGE:"Image",UNKNOWN:"Unknown"},tt={MANUAL:"manual",AUTO:"auto"},rt={ANONYMOUS:"anonymous",USE_CREDENTIALS:"use-credentials"},at=function(){function e(){}return e.prototype.callNext=function(e){e&&e()},e}(),nt=function(){function e(e){this._actions=e,this._middlewares=new m,this._logger=C("Middleware")}var t=e.prototype;return t.use=function(e){for(var t in this._actions){var r=this._actions[t];"function"==typeof e[r]&&(this._logger.debug("Register <"+e.id+"> for action "+r),this._middlewares.push(r,e[r].bind(e)))}},t.run=function(e,t){var r=this;this._logger.debug("Start middleware chain for action "+e);for(var a=this._middlewares.get(e),n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];this._executeMiddleware(a,(function(){r._logger.debug("Finish middleware chain for action "+e),t.apply(void 0,arguments)}),i)},t._executeMiddleware=function(e,t,r){var a=r,n=function(e,t,r){var n;(null==t?void 0:t.length)&&(a=t),(null==(n=a)?void 0:n.length)?e.apply(void 0,a.concat([r])):e(r)};e.reduceRight((function(e,t){return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];n(t,a,e)}}),(function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];n(t,r)}))()},e}(),it=function(){function e(){this._middleware=new nt(e.Actions)}var t=e.prototype;return t.use=function(e){this._middleware.use(e)},t.load=function(t){this._middleware.run(e.Actions.LOAD,t)},t.play=function(t){this._middleware.run(e.Actions.PLAY,t)},t.pause=function(t){this._middleware.run(e.Actions.PAUSE,t)},t.setCurrentTime=function(t,r){this._middleware.run(e.Actions.SET_CURRENT_TIME,r,t)},e}();!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(it,"Actions",{LOAD:"load",PLAY:"play",PAUSE:"pause",SET_CURRENT_TIME:"setCurrentTime"});var ot={NONE:"none",ANY:"any",NATURAL:"natural",LANDSCAPE:"landscape",PORTRAIT:"portrait",PORTRAIT_PRIMARY:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary",LANDSCAPE_PRIMARY:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary"},st={log:{level:"ERROR"},text:{enableCEA708Captions:!0,useNativeTextTrack:!1,forceCenter:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},playback:{audioLanguage:"",textLanguage:"",volume:1,playsinline:!0,preload:"none",autoplay:!1,loop:!1,autopause:!1,allowMutedAutoPlay:!0,muted:!1,pictureInPicture:!0,options:{html5:{hls:{},dash:{},native:{}}},preferNative:{hls:!1,dash:!1},inBrowserFullscreen:!1,screenLockOrientionMode:ot.NONE,playAdsWithMSE:!1,streamPriority:[{engine:"html5",format:"hls"},{engine:"html5",format:"dash"},{engine:"html5",format:"progressive"},{engine:"flash",format:"hls"}]},streaming:{forceBreakStall:!1},abr:{enabled:!0,fpsDroppedFramesInterval:5e3,fpsDroppedMonitoringThreshold:.2,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,restrictions:{minHeight:0,maxHeight:1/0,minWidth:0,maxWidth:1/0,minBitrate:0,maxBitrate:1/0}},drm:{keySystem:""},network:{maxStaleLevelReloads:20}},lt={options:{},metadata:{}},ut=(r(5),{MANIFEST:0,SEGMENT:1,LICENSE:2});function ct(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var dt=function(e){var t,r,a,n;function i(t){var r;r=e.call(this,t)||this;var a=t.url,n=t.width,i=t.height,o=t.duration,s=t.rows,l=t.cols,u=t.customData;return r._url=a,r._width=n,r._height=i,r._duration=o,r._customData=u,r._rows=s||1,r._cols=l||1,r}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a=i,(n=[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"duration",get:function(){return this._duration}},{key:"rows",get:function(){return this._rows}},{key:"cols",get:function(){return this._cols}},{key:"customData",get:function(){return this._customData}},{key:"sliceWidth",get:function(){return this._width/this._cols}},{key:"sliceHeight",get:function(){return this._height/this._rows}}])&&ct(a.prototype,n),i}(ae);function pt(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var ht=function(){function e(e){var t=e.url,r=e.width,a=e.height,n=e.x,i=e.y;this._url=t,this._width=r,this._height=a,this._x=n,this._y=i}var t,r;return t=e,(r=[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}])&&pt(t.prototype,r),e}();function ft(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var yt=function(e){var t,r;function a(t,r,a){var n;return void 0===a&&(a={}),gt(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n=e.call(this)||this),"_capabilities",{fpsControl:!1}),n._videoElement=t,n._sourceObj=r,n._config=a,n._onDurationChanged=function(){n.isLive()&&n._videoElement.paused&&n._trigger(W.TIME_UPDATE)},n._eventManager=new M,n._handleLiveTimeUpdate(),n}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.isSupported=function(){return!0},a.isMSESupported=function(){var e=window.MediaSource||window.WebKitMediaSource;return!!e&&"function"==typeof e.isTypeSupported};var n,i,o=a.prototype;return o.destroy=function(){return this._sourceObj=null,this._config={},this.disableNativeTextTracks(),this._videoElement.removeEventListener(W.DURATION_CHANGE,this._onDurationChanged),this._eventManager.destroy(),Promise.resolve()},o._onTrackChanged=function(e){e instanceof ie?(a._logger.debug("Video track changed",e),this._trigger(z.VIDEO_TRACK_CHANGED,{selectedVideoTrack:e})):e instanceof oe?(a._logger.debug("Audio track changed",e),this._trigger(z.AUDIO_TRACK_CHANGED,{selectedAudioTrack:e})):e instanceof Xe?(a._logger.debug("Text track changed",e),this._trigger(z.TEXT_TRACK_CHANGED,{selectedTextTrack:e})):e instanceof dt&&(a._logger.debug("Image track changed",e),this._trigger(z.IMAGE_TRACK_CHANGED,{selectedImageTrack:e}))},o._trigger=function(e,t){this.dispatchEvent(new v(e,t))},a.canPlayType=function(e,t){return a._throwNotImplementedError("static canPlayType")},o.load=function(){return a._throwNotImplementedError("load")},o.selectVideoTrack=function(e){return a._throwNotImplementedError("selectVideoTrack")},o.selectAudioTrack=function(e){a._throwNotImplementedError("selectAudioTrack")},o.selectTextTrack=function(e){a._throwNotImplementedError("selectTextTrack")},o.selectImageTrack=function(e){},o.hideTextTrack=function(){a._throwNotImplementedError("hideTextTrack")},o.enableAdaptiveBitrate=function(){a._throwNotImplementedError("enableAdaptiveBitrate")},o.isAdaptiveBitrateEnabled=function(){return a._throwNotImplementedError("isAdaptiveBitrateEnabled")},o.applyABRRestriction=function(e){return a._throwNotImplementedError("applyABRRestriction")},o._getLiveEdge=function(){return a._throwNotImplementedError("_getLiveEdge")},o.seekToLiveEdge=function(){a._throwNotImplementedError("seekToLiveEdge")},o.isLive=function(){return a._throwNotImplementedError("isLive")},o.isOnLiveEdge=function(){return this.liveDuration-this._videoElement.currentTime<=2*this.getSegmentDuration()},o.setMaxBitrate=function(e){},o.attachMediaSource=function(){},o.detachMediaSource=function(){},o._handleLiveTimeUpdate=function(){this._videoElement.addEventListener(W.DURATION_CHANGE,this._onDurationChanged)},o.disableNativeTextTracks=function(){Array.from(this._videoElement.textTracks).forEach((function(e){Xe.isNativeTextTrack(e)&&!Xe.isExternalTrack(e)&&(e.mode=Xe.MODE.DISABLED)}))},o.handleMediaError=function(e){return!1},o.getStartTimeOfDvrWindow=function(){return a._throwNotImplementedError("getStartTimeOfDvrWindow")},o.getThumbnail=function(e){return null},o.getSegmentDuration=function(){return a._throwNotImplementedError("getSegmentDuration")},a._throwNotImplementedError=function(e){throw new O(O.Severity.CRITICAL,O.Category.PLAYER,O.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,e)},o.getDrmInfo=function(){return null},n=a,(i=[{key:"liveDuration",get:function(){return a._throwNotImplementedError("liveDuration")}},{key:"src",get:function(){return this._loadPromise&&this._sourceObj?this._sourceObj.url:""},set:function(e){!this._loadPromise&&this._sourceObj&&(this._sourceObj.url=e)}},{key:"capabilities",get:function(){return this._capabilities}},{key:"targetBuffer",get:function(){return NaN}}])&&ft(n.prototype,i),a}(P);function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function vt(e,t){var r=function(e,t){var r=function(e,t,r){return e>=(t||0)&&e<=(r||1/0)},a=t.maxHeight,n=t.minHeight,i=t.maxWidth,o=t.minWidth;if(0!==n||0!==o||a!==1/0||i!==1/0)return e.filter((function(e){return r(e.height,n,a)})).filter((function(e){return r(e.width,o,i)}));var s=t.maxBitrate,l=t.minBitrate;return 0!==l||s!==1/0?e.filter((function(e){return r(e.bandwidth,l,s)})):e}(e,t);return r.length?r:[]}gt(yt,"id","BaseAdapter"),gt(yt,"getLogger",C),gt(yt,"_logger",yt.getLogger(yt.id));var _t={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"},kt=C("FairPlay"),Et=function(){function e(){}return e.isConfigured=function(e,t){return _t.FAIRPLAY===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))},e.canPlayDrm=function(e){var t=e.some((function(e){return e.scheme===_t.FAIRPLAY}))&&!!window.WebKitMediaKeys;return kt.debug("Can play DRM scheme of: "+_t.FAIRPLAY+" is "+t.toString()),t},e.setDrmPlayback=function(e,t){kt.debug("Sets drm playback");var r=t.find((function(e){return e.scheme===_t.FAIRPLAY}));r&&(e.licenseUrl=r.licenseUrl,e.certificate=r.certificate)},e}(),Tt=r(2);function bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var St={NEED_KEY:"webkitneedkey",KEY_MESSAGE:"webkitkeymessage",KEY_ADDED:"webkitkeyadded",KEY_ERROR:"webkitkeyerror"},At=function(){function e(t,r,a,n){var i=this;bt(this,"_logger",C("FairPlayDrmHandler")),bt(this,"_retryLicenseRequest",4),bt(this,"_defaultConfig",{licenseUrl:"",certificate:"",network:{responseFilter:function(t,r){var a={};try{var n=new DataView(r.data),o=(new TextDecoder).decode(n).trim();a=JSON.parse(o)}catch(e){return void i._onError(O.Code.BAD_FAIRPLAY_RESPONSE,{error:e,responseText:r.data})}var s=e._validateResponse(a);s.valid?r.data=e._base64DecodeUint8Array(a.ckc):i._onError(O.Code.BAD_FAIRPLAY_RESPONSE,s)}}}),this._config=F.mergeDeep({},this._defaultConfig,r),this._errorCallback=a,this._drmResponseCallback=n,this._videoElement=t,this._onWebkitNeedKeyHandler=function(e){return i._onWebkitNeedKey(e)},this._eventManager=new M,this._eventManager.listen(this._videoElement,St.NEED_KEY,this._onWebkitNeedKeyHandler)}var t=e.prototype;return t._onWebkitNeedKey=function(t){var r=this;this._logger.debug("Webkit need key triggered");var a=t.target,n=t.initData,i=e._extractContentId(n),o=e._base64DecodeUint8Array(this._config.certificate);if(n=e._concatInitDataIdAndCertificate(n,i,o),!a.webkitKeys){var s=this._selectKeySystem();this._logger.debug("Sets media keys"),a.webkitSetMediaKeys(new window.WebKitMediaKeys(s))}a.webkitKeys||this._onError(O.Code.COULD_NOT_CREATE_MEDIA_KEYS),this._logger.debug("Creates session"),this._keySession=a.webkitKeys.createSession("video/mp4",n),this._keySession||this._onError(O.Code.COULD_NOT_CREATE_KEY_SESSION),this._keySession.contentId=i,this._eventManager.listen(this._keySession,St.KEY_MESSAGE,(function(e){return r._onWebkitKeyMessage(e)})),this._eventManager.listen(this._keySession,St.KEY_ADDED,(function(){return r._onWebkitKeyAdded()})),this._eventManager.listen(this._keySession,St.KEY_ERROR,(function(e){return r._onWebkitKeyError(e)}))},t.getDrmInfo=function(){var e=this._config;return{certificate:e.certificate,licenseUrl:e.licenseUrl,scheme:_t.FAIRPLAY}},t.destroy=function(){this._eventManager.destroy(),this._keySession.close(),this._keySession=null},t._onWebkitKeyMessage=function(t){var r=this;this._logger.debug("Webkit key message triggered");var a=t.message,n=new XMLHttpRequest;n.responseType="arraybuffer",this._eventManager.listenOnce(n,"load",(function(e){return r._licenseRequestLoaded(e)}));var i,o={url:this._config.licenseUrl,body:e._base64EncodeUint8Array(a),headers:{}},s=this._config.network.requestFilter;if(s){this._logger.debug("Apply request filter");try{i=s(ut.LICENSE,o)}catch(e){i=Promise.reject(e)}}(i=i||Promise.resolve(o)).then((function(e){n.open("POST",e.url,!0);var t=!0;e.headers&&Object.entries(e.headers).forEach((function(e){var r=e[0],a=e[1];"string"==typeof a&&n.setRequestHeader(r,a),t&&(t="content-type"!==r.toLowerCase())})),"boolean"==typeof e.withCredentials&&(n.withCredentials=e.withCredentials),t&&n.setRequestHeader("Content-type","application/json"),r._logger.debug("Ready for license request"),n.onerror=function(){r._onError(O.Code.LICENSE_REQUEST_FAILED,{status:n.status,responseText:n.responseText})},r._licenseRequestTime=Date.now(),n.send(e.body)})).catch((function(e){r._errorCallback(new O(O.Severity.CRITICAL,O.Category.NETWORK,O.Code.REQUEST_FILTER_ERROR,e)),r.destroy()}))},t._onWebkitKeyAdded=function(){this._logger.debug("Decryption key was added to session")},t._onWebkitKeyError=function(e){this._logger.error("A decryption key error was encountered",e),this._retryLicenseRequest<=0&&this._onError(O.Code.LICENSE_REQUEST_FAILED,e.target.error),this._retryLicenseRequest--},t._licenseRequestLoaded=function(e){var t=this;this._logger.debug("License request loaded");var r=e.target;if(r.status>299)this._onError(O.Code.LICENSE_REQUEST_FAILED,{status:r.status,error:r.responseText});else{if(this._drmResponseCallback){var a=Date.now()-this._licenseRequestTime;this._drmResponseCallback({licenseTime:a/1e3,scheme:_t.FAIRPLAY})}var n,i=r.responseURL,o=r.response,s={url:i,originalUrl:this._config.licenseUrl,data:o,headers:V.convertHeadersToDictionary(r.getAllResponseHeaders())};this._logger.debug("Apply response filter");try{n=this._config.network.responseFilter(ut.LICENSE,s)}catch(e){n=Promise.reject(e)}(n=n||Promise.resolve(s)).then((function(e){t._keySession.update(e.data)})).catch((function(e){t._errorCallback(new O(O.Severity.CRITICAL,O.Category.NETWORK,O.Code.RESPONSE_FILTER_ERROR,e)),t.destroy()}))}},t._onError=function(e,t){this._errorCallback(new O(O.Severity.CRITICAL,O.Category.DRM,e,t))},e._validateResponse=function(e){return e.message&&e.message.indexOf("error")>0||null===e.reference||500===e.status_code?{valid:!1,details:"internal server error"}:""===e.ckc?{valid:!1,details:"ckc is missing"}:{valid:!0}},t._selectKeySystem=function(){var e=null;return window.WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4")?e="com.apple.fps.1_0":this._logger.warn("Key System not supported"),e},e._extractContentId=function(t){var r=document.createElement("a");return r.href=e._arrayToString(t),r.hostname},e._arrayToString=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},e._base64DecodeUint8Array=function(e){for(var t=window.atob(e),r=t.length,a=new Uint8Array(new ArrayBuffer(r)),n=0;n<r;n++)a[n]=t.charCodeAt(n);return a},e._concatInitDataIdAndCertificate=function(t,r,a){"string"==typeof r&&(r=e._stringToArray(r));var n=0,i=new ArrayBuffer(t.byteLength+4+r.byteLength+4+a.byteLength),o=new DataView(i);new Uint8Array(i,n,t.byteLength).set(t),n+=t.byteLength,o.setUint32(n,r.byteLength,!0),n+=4;var s=new Uint8Array(i,n,r.byteLength);return s.set(r),n+=s.byteLength,o.setUint32(n,a.byteLength,!0),n+=4,new Uint8Array(i,n,a.byteLength).set(a),new Uint8Array(i,0,i.byteLength)},e._stringToArray=function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),a=0,n=e.length;a<n;a++)r[a]=e.charCodeAt(a);return r},e._base64EncodeUint8Array=function(e){for(var t,r,a,n,i,o,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;c<e.length;)n=(t=e[c++])>>2,i=(3&t)<<4|(r=c<e.length?e[c++]:Number.NaN)>>4,o=(15&r)<<2|(a=c<e.length?e[c++]:Number.NaN)>>6,s=63&a,isNaN(r)?o=s=64:isNaN(a)&&(s=64),u+=l.charAt(n)+l.charAt(i)+l.charAt(o)+l.charAt(s);return u},e}();function Ct(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Pt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function wt(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function xt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function It(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}bt(At,"WebkitEvents",St),At.WebkitEvents=St;var Mt=function(e){var t,r;function a(t,r,n){var i;return a._logger.debug("Creating adapter"),It(xt(i=e.call(this,t,r,n)||this),"_lastTimeUpdate",0),It(xt(i),"_waitingEventTriggered",!1),It(xt(i),"_segmentDuration",0),It(xt(i),"_mediaErrorRecoveryAttempts",0),It(xt(i),"_lastTimeDetach",NaN),It(xt(i),"_startTimeAttach",NaN),It(xt(i),"_nativeTextTracksMap",{}),It(xt(i),"_captionsHidden",!1),i._config=F.mergeDeep({},Tt,i._config),i._progressiveSources=n.progressiveSources,i._liveEdge=0,i}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.canPlayType=function(e){var t=!1;return"string"==typeof e&&(t=!!a.TEST_VIDEO.canPlayType(e.toLowerCase())),a._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t},a.canPlayDrm=function(e,t){a._drmProtocol=null;for(var r,n=Ct(a._drmProtocols);!(r=n()).done;){var i=r.value;if(i.isConfigured(e,t)){a._drmProtocol=i;break}}if(!a._drmProtocol)for(var o,s=Ct(a._drmProtocols);!(o=s()).done;){var l=o.value;l.canPlayDrm(e)&&(a._drmProtocol=l)}return!!a._drmProtocol},a.createAdapter=function(e,t,r){a._logger.debug("createAdapter");var n={displayTextTrack:!1,progressiveSources:[]};if(F.hasPropertyPath(r,"text.useNativeTextTrack")&&(n.displayTextTrack=F.getPropertyPath(r,"text.useNativeTextTrack")),F.hasPropertyPath(r,"sources.progressive")&&(n.progressiveSources=F.getPropertyPath(r,"sources.progressive")),F.hasPropertyPath(r,"text")&&(n.enableCEA708Captions=r.text.enableCEA708Captions,n.captionsTextTrack1Label=r.text.captionsTextTrack1Label,n.captionsTextTrack1LanguageCode=r.text.captionsTextTrack1LanguageCode,n.captionsTextTrack2Label=r.text.captionsTextTrack2Label,n.captionsTextTrack2LanguageCode=r.text.captionsTextTrack2LanguageCode),F.hasPropertyPath(r,"playback")&&F.hasPropertyPath(r.playback,"options.html5.native")&&F.mergeDeep(n,r.playback.options.html5.native),F.hasPropertyPath(r,"abr")){var i=r.abr;i.restrictions&&F.createPropertyPath(n,"abr.restrictions",i.restrictions)}return n.network=r.network,new this(e,t,n)};var n,i,o=a.prototype;return o._dispatchErrorCallback=function(e){this._trigger(W.ERROR,e)},o._dispatchDRMLicenseLoaded=function(e){this._trigger(z.DRM_LICENSE_LOADED,e)},o._maybeSetDrmPlayback=function(){var e=this;if(a._drmProtocol&&this._sourceObj&&this._sourceObj.drmData){var t={licenseUrl:"",certificate:"",network:this._config.network};a._drmProtocol.setDrmPlayback(t,this._sourceObj.drmData),this._drmHandler=new At(this._videoElement,t,(function(t){return e._dispatchErrorCallback(t)}),(function(t){return e._dispatchDRMLicenseLoaded(t)}))}},o._setProgressiveSource=function(){var e=function(e,t,r){var a=null;if(r&&e){for(var n,i=[],o=1/0,s=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return mt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(e);!(n=s()).done;){var l=n.value,u=Math.abs(l.width-t);u<o?(o=u,i=[l]):u===o&&i.push(l)}for(var c=t/r,d=i,p=1/0,h=0,f=i;h<f.length;h++){var g=f[h];if(g.height){var y=Math.abs(g.width/g.height-c);y<p?(p=y,d=[g]):y===p&&d.push(g)}}for(var m=0,v=0,_=d;v<_.length;v++){var k=_[v];(k.bandwidth>m||!k.bandwidth)&&(m=k.bandwidth||m,a=k)}}return a}(this._progressiveSources,this._videoElement.offsetWidth,this._videoElement.offsetHeight);e&&(this._sourceObj=e)},o._isProgressivePlayback=function(){return!!this._sourceObj&&a._progressiveMimeTypes.includes(this._sourceObj.mimetype.toLowerCase())},o.load=function(e){var t=this;return this._wasCurrentTimeSetSuccessfully=!1,this._maybeSetDrmPlayback(),this._loadPromise||(this._loadPromise=new Promise((function(r,a){t._lastTimeUpdate=e||0;var n=t._startTimeAttach||e||0;t._loadPromiseReject=a,t._eventManager.listenOnce(t._videoElement,W.LOADED_DATA,(function(){return t._onLoadedData(r,n)})),t._eventManager.listenOnce(t._videoElement,W.PLAYING,(function(){return t._onPlaying(n)})),t._eventManager.listen(t._videoElement,W.TIME_UPDATE,(function(){return t._onTimeUpdate()})),t._eventManager.listen(t._videoElement,W.PLAY,(function(){return t._resetHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,W.PAUSE,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,W.ENDED,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,W.ABORT,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,W.SEEKED,(function(){return t._syncCurrentTime()})),t._eventManager.listen(t._videoElement,W.WAITING,(function(){return t._waitingEventTriggered=!0})),t._eventManager.listen(t._videoElement,W.PLAYING,(function(){return t._waitingEventTriggered=!1})),t._eventManager.listen(window,"focus",(function(){setTimeout((function(){g.isIOS&&(t._videoElement.currentTime=t._videoElement.currentTime>.1?t._videoElement.currentTime-.1:0),t._syncCurrentTime()}),1e3)})),t._isProgressivePlayback()&&t._setProgressiveSource(),t._sourceObj&&t._sourceObj.url?t._setSrc().then((function(){t._trigger(z.ABR_MODE_CHANGED,{mode:t._isProgressivePlayback()?"manual":"auto"}),t._videoElement.load()})):t._videoElement.load()}))),this._loadPromise},o._handleDecodeError=function(e){var t=this;a._logger.debug("handleDecodeError",e);var r=this._videoElement.currentTime,n=this._getActivePKAudioTrack(),i=this._getActivePKTextTrack();this._videoElement.load(),this._eventManager.listenOnce(this._videoElement,W.PLAYING,(function(){t._mediaErrorRecoveryAttempts=0})),this._eventManager.listenOnce(this._videoElement,W.CAN_PLAY,(function(){a._logger.debug("CAN_PLAY"),t._videoElement.currentTime=r,t._videoElement.play(),t._videoElement.pause(),n&&t.selectAudioTrack(n),i?t.selectTextTrack(i):t.disableNativeTextTracks()}))},o.handleMediaError=function(e){return this._loadPromiseReject?(this._loadPromiseReject(new O(O.Severity.CRITICAL,O.Category.MEDIA,O.Code.NATIVE_ADAPTER_LOAD_FAILED,e)),!0):!!(e&&e.code===window.MediaError.MEDIA_ERR_DECODE&&(this._mediaErrorRecoveryAttempts++,this._mediaErrorRecoveryAttempts<=3))&&(this._handleDecodeError(e),!0)},o.attachMediaSource=function(){this._startTimeAttach=this._lastTimeDetach,this._lastTimeDetach=NaN},o.detachMediaSource=function(){this._lastTimeDetach=this._videoElement.currentTime,this._videoElement&&this._videoElement.src&&(j.setAttribute(this._videoElement,"src",""),j.removeAttribute(this._videoElement,"src")),this._loadPromise=null},o._setSrc=function(){var e,t=this,r={url:this._sourceObj?this._sourceObj.url:"",body:null,headers:{}};if("function"==typeof F.getPropertyPath(this._config,"network.requestFilter"))try{a._logger.debug("Apply request filter"),e=this._config.network.requestFilter(ut.MANIFEST,r)}catch(t){e=Promise.reject(t)}return(e=e||Promise.resolve(r)).then((function(e){t._videoElement.src=e.url})).catch((function(e){t._trigger(W.ERROR,new O(O.Severity.CRITICAL,O.Category.NETWORK,O.Code.REQUEST_FILTER_ERROR,e))})),e},o._onPlaying=function(e){this.isLive()&&this._setStartTime(e)},o._onLoadedData=function(e,t){var r=this,n=function(){r._playerTracks=r._getParsedTracks(),r._addNativeAudioTrackChangeListener(),r._addNativeTextTrackChangeListener(),r._addNativeTextTrackAddedListener(),a._logger.debug("The source has been loaded successfully"),r._loadPromiseReject=null,e({tracks:r._playerTracks}),r.isLive()&&r._handleLiveDurationChange()};this.isLive()||this._setStartTime(t),this._videoElement.textTracks.length>0?n():this._eventManager.listenOnce(this._videoElement,W.CAN_PLAY,n.bind(this)),this._startTimeAttach=NaN},o._setStartTime=function(e){e&&e>-1&&(this._videoElement.currentTime=e),this._wasCurrentTimeSetSuccessfully=!0},o._onTimeUpdate=function(){this._videoElement.paused||(this._videoElement.currentTime>this._lastTimeUpdate?(this._waitingEventTriggered&&(this._waitingEventTriggered=!1,this._trigger(W.PLAYING)),this._resetHeartbeatTimeout()):this._videoElement.currentTime<this._lastTimeUpdate?this._syncCurrentTime():(this._waitingEventTriggered=!0,this._trigger(W.WAITING))),this._handleVideoTracksChange()},o._syncCurrentTime=function(){this._lastTimeUpdate=this._videoElement.currentTime},o._resetHeartbeatTimeout=function(){var e=this;this._lastTimeUpdate=this._videoElement.currentTime,this._clearHeartbeatTimeout(),this._heartbeatTimeoutId=setTimeout((function(){e._clearHeartbeatTimeout(),e._trigger(W.ERROR,new O(O.Severity.CRITICAL,O.Category.NETWORK,O.Code.TIMEOUT,"The player exceeded max buffer time of "+e._config.heartbeatTimeout+" ms. No progress has been done during this time."))}),this._config.heartbeatTimeout)},o._clearHeartbeatTimeout=function(){this._heartbeatTimeoutId&&(clearTimeout(this._heartbeatTimeoutId),this._heartbeatTimeoutId=null)},o._handleVideoTracksChange=function(){if(!this._isProgressivePlayback()){var e=this._videoElement,t=e.videoHeight,r=e.videoWidth,a=e.videoTracks;if(!this._videoDimensions||t!==this._videoDimensions.videoHeight||r!==this._videoDimensions.videoWidth){this._videoDimensions={videoHeight:t,videoWidth:r};var n={language:"",height:t,width:r,active:!0,index:Array.from(a).findIndex((function(e){return e.selected}))};this._onTrackChanged(new ie(n))}}},o.destroy=function(){var t=this;return a._logger.debug("destroy"),new Promise((function(r,a){e.prototype.destroy.call(t).then((function(){t._drmHandler&&t._drmHandler.destroy(),t._waitingEventTriggered=!1,t._progressiveSources=[],t._loadPromise=null,t._nativeTextTracksMap={},t._loadPromiseReject=null,t._liveEdge=0,t._lastTimeUpdate=0,t._lastTimeDetach=NaN,t._startTimeAttach=NaN,t._videoDimensions=null,t._clearHeartbeatTimeout(),t._liveDurationChangeInterval&&(clearInterval(t._liveDurationChangeInterval),t._liveDurationChangeInterval=null),r()}),(function(){return a}))}))},o._getParsedTracks=function(){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),r=this._getParsedTextTracks();return e.concat(t).concat(r)},o._getParsedVideoTracks=function(){return this._isProgressivePlayback()?this._getParsedProgressiveVideoTracks():this._getParsedAdaptiveVideoTracks()},o._getParsedProgressiveVideoTracks=function(){var e=this._progressiveSources,t=[];if(e)for(var r=0;r<e.length;r++){var a={id:e[r].id,bandwidth:e[r].bandwidth,width:e[r].width,height:e[r].height,active:!!this._sourceObj&&e[r].id===this._sourceObj.id,index:r};t.push(new ie(a))}return t},o._getParsedAdaptiveVideoTracks=function(){var e=this._videoElement.videoTracks,t=[];if(e)for(var r=0;r<e.length;r++){var a={id:e[r].id,active:e[r].selected,label:e[r].label,language:e[r].language,index:r};t.push(new ie(a))}return t},o._getParsedAudioTracks=function(){var e=this._videoElement.audioTracks,t=[];if(e)for(var r=0;r<e.length;r++){var a={id:e[r].id,active:e[r].enabled,label:e[r].label,language:e[r].language,index:r};t.push(new oe(a))}return t},o._getParsedTextTracks=function(){var e=[this._config.captionsTextTrack1Label,this._config.captionsTextTrack2Label],t=[this._config.captionsTextTrack1LanguageCode,this._config.captionsTextTrack2LanguageCode],r=this._videoElement.textTracks,a=[];if(r){for(var n=0;n<r.length;n++)if(!Xe.isExternalTrack(r[n])){var i={kind:r[n].kind,active:r[n].mode===Xe.MODE.SHOWING,label:r[n].label,language:r[n].language,available:!0};if(i.kind===Xe.KIND.SUBTITLES){var o=new Xe(i);a.push(o),this._nativeTextTracksMap[o.index]=r[n]}else if(i.kind===Xe.KIND.CAPTIONS&&this._config.enableCEA708Captions){i.label=i.label||e.shift(),i.language=i.language||t.shift(),i.available=this._captionsHidden;var s=new Xe(i);a.push(s),this._nativeTextTracksMap[s.index]=r[n]}}this._captionsHidden||this._maybeShow708Captions()}return a},o._maybeShow708Captions=function(){var e=this,t=Array.from(this._videoElement.textTracks).filter((function(e){return e.kind===Xe.KIND.CAPTIONS})),r=t.find((function(e){return e.mode===Xe.MODE.SHOWING||e.mode===Xe.MODE.HIDDEN}))||t[0];r&&(r.mode=Xe.MODE.HIDDEN,this._captionsHidden=!0,this._eventManager.listenOnce(r,"cuechange",(function(){e._getPKTextTracks().forEach((function(e){return(e.available=!0)&&(e.mode=Xe.MODE.DISABLED)})),e._trigger(z.TRACKS_CHANGED,{tracks:e._playerTracks})})))},o.selectVideoTrack=function(e){this._isProgressivePlayback()?this._selectProgressiveVideoTrack(e):this.selectAdaptiveVideoTrack(e)},o._selectProgressiveVideoTrack=function(e){var t=this,r=this._progressiveSources;if(e instanceof ie&&r&&r[e.index]){var a=this._videoElement.currentTime,n=this._videoElement.paused;e.active=!0,this._sourceObj=r[e.index],this._eventManager.listenOnce(this._videoElement,W.LOADED_DATA,(function(){"Android Browser"===g.browser.name?(t._eventManager.listenOnce(t._videoElement,W.DURATION_CHANGE,(function(){t._videoElement.currentTime=a})),t._eventManager.listenOnce(t._videoElement,W.SEEKED,(function(){t._onTrackChanged(e),n&&t._videoElement.pause()})),t._videoElement.play()):(t._eventManager.listenOnce(t._videoElement,W.SEEKED,(function(){t._onTrackChanged(e)})),t._videoElement.currentTime=a,n||t._videoElement.play())})),this._setSrc()}},o.selectAdaptiveVideoTrack=function(e){var t=this._videoElement.videoTracks;e instanceof ie&&t&&t[e.index]&&(this._disableVideoTracks(),t[e.index].selected=!0,this._onTrackChanged(e))},o.selectAudioTrack=function(e){a._logger.debug("selectAudioTrack");var t=this._videoElement.audioTracks;e instanceof oe&&t&&t[e.index]&&(this._removeNativeAudioTrackChangeListener(),this._switchAudioTrack(e.index),this._onTrackChanged(e),this._addNativeAudioTrackChangeListener())},o._removeNativeAudioTrackChangeListener=function(){this._videoElement.audioTracks&&this._eventManager.unlisten(this._videoElement.audioTracks,"change")},o._addNativeAudioTrackChangeListener=function(){var e=this;this._videoElement.audioTracks&&this._eventManager.listen(this._videoElement.audioTracks,"change",(function(){return e._onNativeAudioTrackChange()}))},o._getPKAudioTracks=function(){return this._playerTracks.filter((function(e){return e instanceof oe}))},o._getActivePKAudioTrack=function(){return this._getPKAudioTracks().find((function(e){return!0===e.active}))},o._onNativeAudioTrackChange=function(){var e=this,t=function(){for(var t=0;t<e._videoElement.audioTracks.length;t++)if(e._videoElement.audioTracks[t].enabled)return t;return-1}(),r=this._getActivePKAudioTrack(),n=r?r.index:-1;if(t!==n){var i=this._getPKAudioTracks().find((function(e){return e.index===t}));i&&(a._logger.debug("Native selection of track, update the player audio track ("+n+" -> "+t+")"),this._onTrackChanged(i))}},o.selectTextTrack=function(e){if(e instanceof Xe&&Xe.isNativeTextTrack(e)){this._removeNativeTextTrackChangeListener();var t=this._nativeTextTracksMap[e.index];t&&(this.disableNativeTextTracks(),t.mode=this._getDisplayTextTrackModeString(),this._onTrackChanged(e),this._addNativeTextTrackChangeListener())}},o._removeNativeTextTrackChangeListener=function(){this._videoElement.textTracks&&this._eventManager.unlisten(this._videoElement.textTracks,"change")},o._addNativeTextTrackChangeListener=function(){var e=this;this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"change",(function(){return e._onNativeTextTrackChange()}))},o._getPKTextTracks=function(){return this._playerTracks.filter((function(e){return e instanceof Xe}))},o._getActivePKTextTrack=function(){return this._getPKTextTracks().find((function(e){return!0===e.active}))},o._onNativeTextTrackChange=function(){var e=this,t=this._getPKTextTracks(),r=t.find((function(e){return"off"===e.language})),n=function(){for(var t in e._nativeTextTracksMap)if(e._getDisplayTextTrackModeString()===e._nativeTextTracksMap[t].mode)return Number(t);return-1}(),i=this._getActivePKTextTrack(),o=i?i.index:-1;if(n!==o)if(-1==n)r&&(a._logger.debug("Native selection of track, update the player text track ("+o+" -> off)"),this._onTrackChanged(r));else{var s=t.find((function(e){return e.index===n}));s&&(a._logger.debug("Native selection of track, update the player text track ("+o+" -> "+n+")"),this._onTrackChanged(s))}},o._getDisplayTextTrackModeString=function(){return this._config.displayTextTrack?Xe.MODE.SHOWING:Xe.MODE.HIDDEN},o._addNativeTextTrackAddedListener=function(){var e=this;!this._config.displayTextTrack&&this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"addtrack",(function(){return e._onNativeTextTrackAdded()}))},o._onNativeTextTrackAdded=function(){this._playerTracks=this._getParsedTracks(),this._trigger(z.TRACKS_CHANGED,{tracks:this._playerTracks})},o.hideTextTrack=function(){this.disableNativeTextTracks()},o.enableAdaptiveBitrate=function(){a._logger.warn("Enabling adaptive bitrate is not supported for native playback")},o.isAdaptiveBitrateEnabled=function(){return!this._isProgressivePlayback()},o.applyABRRestriction=function(e){F.createPropertyPath(this._config,"abr.restrictions",e),this._maybeApplyAbrRestrictions(e)},o._maybeApplyAbrRestrictions=function(e){if(this._isProgressivePlayback()){var t=vt(this._playerTracks.filter((function(e){return e instanceof ie})),e);!t.find((function(e){return e.active}))&&t.length?this.selectVideoTrack(t[0]):a._logger.warn("Invalid restrictions, there are not tracks within the restriction range")}},o._disableVideoTracks=function(){var e=this._videoElement.videoTracks;if(e)for(var t=0;t<e.length;t++)e[t].selected=!1},o._switchAudioTrack=function(e){a._logger.debug("_switchAudioTracks");var t=this._videoElement.audioTracks;if(t)for(var r=0;r<t.length;r++)t[r].enabled=r==e},o._getLiveEdge=function(){return this._videoElement.seekable.length?this._videoElement.seekable.end(this._videoElement.seekable.length-1):this._videoElement.buffered.length?this._videoElement.buffered.end(this._videoElement.buffered.length-1):this._videoElement.duration},o.seekToLiveEdge=function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}},o.getSegmentDuration=function(){return this._segmentDuration},o.isLive=function(){return this._videoElement.duration===1/0},o.isOnLiveEdge=function(){return!!this._wasCurrentTimeSetSuccessfully&&e.prototype.isOnLiveEdge.call(this)},o._handleLiveDurationChange=function(){var e=this;this._liveDurationChangeInterval=setInterval((function(){e._calculateSegmentDuration();var t=e._getLiveEdge();e._liveEdge!==t&&(e._liveEdge=t,e._videoElement.dispatchEvent(new window.Event(W.DURATION_CHANGE)))}),1e3)},o._calculateSegmentDuration=function(){if(0===this._videoElement.seekable.start(0)){var e=this._videoElement,t=e.buffered,r=e.seekable;t.length&&r.length&&(this._segmentDuration=(t.end(t.length-1)-r.end(r.length-1))/3)}else{var a=this._getLiveEdge();this._liveEdge&&this._liveEdge!==a&&(this._segmentDuration=a-this._liveEdge)}},o.getStartTimeOfDvrWindow=function(){return this.isLive()&&this._videoElement.seekable.length?this._videoElement.seekable.start(0):0},o.getDrmInfo=function(){return this._drmHandler?this._drmHandler.getDrmInfo():null},n=a,(i=[{key:"liveDuration",get:function(){return this._getLiveEdge()}}])&&wt(n.prototype,i),a}(yt);function Dt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}It(Mt,"id","NativeAdapter"),It(Mt,"_logger",yt.getLogger(Mt.id)),It(Mt,"TEST_VIDEO",j.createElement("video")),It(Mt,"_drmProtocols",[Et]),It(Mt,"_drmProtocol",null),It(Mt,"_progressiveMimeTypes",["video/mp4","audio/mp3"]);var Rt=function(){function e(){}return e.register=function(t){t&&(e._mediaSourceAdapters.includes(t)?e._logger.debug("Adapter <"+t.id+"> is already registered, do not register again"):(e._logger.debug("Adapter <"+t.id+"> has been registered successfully"),e._mediaSourceAdapters.push(t)))},e.unRegister=function(t){var r=e._mediaSourceAdapters.indexOf(t);r>-1&&(e._logger.debug("Unregistered <"+t.id+"> adapter"),e._mediaSourceAdapters.splice(r,1))},e.canPlaySource=function(t,r,a){void 0===r&&(r=!0),e._orderMediaSourceAdapters(r);var n=e._mediaSourceAdapters;if(t&&t.mimetype)for(var i=0;i<n.length;i++)if(n[i].canPlayType(t.mimetype)&&(!t.drmData||n[i].canPlayDrm(t.drmData,a)))return e._selectedAdapter=n[i],e._logger.debug("Selected adapter is <"+e._selectedAdapter.id+">"),!0;return!1},e._orderMediaSourceAdapters=function(t){e._mediaSourceAdapters=e._mediaSourceAdapters.filter((function(e){return"NativeAdapter"!==e.id})),t?e._mediaSourceAdapters.unshift(Mt):e._mediaSourceAdapters.push(Mt)},e.getMediaSourceAdapter=function(t,r,a){return t&&r&&a?(e._selectedAdapter||e.canPlaySource(r,!0,a.drm),e._selectedAdapter?e._selectedAdapter.createAdapter(t,r,a):null):null},e.destroy=function(){e._selectedAdapter=null},e}();Dt(Rt,"_logger",C("MediaSourceProvider")),Dt(Rt,"_mediaSourceAdapters",[Mt]),Dt(Rt,"_selectedAdapter",null);var Ot=Rt.register,Lt=function(e,t,r,a,n){this.startTime=e,this.endTime=t,this.id=r,this.type=a,this.metadata=n};function Nt(e){try{var t=e.startTime,r=e.endTime,a=e.id,n=e.type,i=e.metadata,o={};window.VTTCue?o=new window.VTTCue(t,r,""):window.TextTrackCue&&(o=new window.TextTrackCue(t,r,""));var s={key:n,data:i};return o.id=a,o.value=s,o}catch(e){return null}}function Ut(e){if(e){var t=e.startTime,r=e.endTime,a=e.id;if(Ft(e)){var n=Ft(e),i=n.type,o=n.metadata;return new Lt(t,r,a,i,o)}}return null}function Ft(e){if(e){var t=e.type,r=e.value,a=e.track;if(r){var n=r.key,i=r.data,o="org.id3"===t||"id3"===(a&&a.label),s=Object.values(Lt.TYPE).find((function(e){return e===n}));return s||(s=o?Lt.TYPE.ID3:Lt.TYPE.CUSTOM),{type:s,metadata:o||!i?r:i}}}return null}Lt.TYPE={ID3:"id3",EMSG:"emsg",CUE_POINT:"cuepoint",CUSTOM:"custom"};var Bt,jt,Vt=r(3);function $t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ht=(jt=Bt=function(){function e(){}return e.runCapability=function(){e._capabilities.autoplay||"boolean"==typeof e._capabilities.autoplay&&"boolean"==typeof e._capabilities.mutedAutoPlay?e._playPromiseResult=Promise.resolve(e._capabilities):(e._vid||(e._vid=j.createElement("video"),e._vid.src=Vt.a,e._vid.setAttribute("playsinline","")),e._playPromiseResult=new Promise((function(t){e._setMuted(!1),e._getPlayPromise().then((function(){return t({autoplay:!0,mutedAutoPlay:!0})})).catch((function(){e._setMuted(!0),e._getPlayPromise().then((function(){return t({autoplay:!1,mutedAutoPlay:!0})})).catch((function(){return t({autoplay:!1,mutedAutoPlay:!1})}))}))})))},e.getCapability=function(){return e._playPromiseResult.then((function(t){var r;return t.autoplay?r=Promise.resolve(t):(e.runCapability(),r=e._playPromiseResult),r.then((function(t){return F.mergeDeep(t,e._capabilities)}))}))},e.setCapabilities=function(t){e._logger.debug("Set player capabilities",t);var r=t.autoplay,a=t.mutedAutoPlay;"boolean"==typeof r&&(e._capabilities.autoplay=r),"boolean"==typeof a&&(e._capabilities.mutedAutoPlay=a)},e._getPlayPromise=function(){return e._vid.play()||e._forcePromiseReturnValue()},e._setMuted=function(t){t?(e._vid.muted=!0,e._vid.setAttribute("muted","")):(e._vid.muted=!1,e._vid.removeAttribute("muted"))},e._forcePromiseReturnValue=function(){return new Promise((function(t,r){e._vid.addEventListener(W.ERROR,(function(){r()}));var a=setTimeout((function(){e._logger.debug("Timeout 500 ms has been reached"),r()}),500);!0===e._vid.paused?(clearTimeout(a),r()):(clearTimeout(a),t())}))},e}(),$t(Bt,"_logger",C("Html5AutoPlayCapability")),$t(Bt,"_capabilities",{}),jt);function Gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Wt=function(e){var t,r;function a(t,r,n){var i;return Kt(Gt(i=e.call(this)||this),"_droppedFramesInterval",null),Kt(Gt(i),"_lastDroppedFrames",0),Kt(Gt(i),"_lastDecodedFrames",0),Kt(Gt(i),"_lastTime",0),Kt(Gt(i),"_currentBitrate",0),i._eventManager=new M,i._mediaSourceAdapter=t,i._config=r,i._videoElement=n,i._mediaSourceAdapter.capabilities.fpsControl?(i._eventManager.listen(i._mediaSourceAdapter,z.FPS_DROP,(function(e){return i._triggerFPSDrop(e.payload.data)})),Gt(i)):(-1===i._getDroppedAndDecodedFrames()[0]?a._logger.debug("Dropped frame watcher is not supported"):i._config.capLevelOnFPSDrop?(a._logger.debug("Initialized capLevelOnFPSDrop = true"),i._init()):a._logger.debug("Not Initialized"),i)}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n._init=function(){var e=this;this._eventManager.listen(this._mediaSourceAdapter,z.VIDEO_TRACK_CHANGED,(function(t){return e._currentBitrate=t.payload.selectedVideoTrack.bandwidth})),this._droppedFramesInterval=setInterval((function(){return e._checkFPS()}),this._config.fpsDroppedFramesInterval)},n._triggerFPSDrop=function(e){this.dispatchEvent(new v(z.FPS_DROP,e))},n._getDroppedAndDecodedFrames=function(){if("function"==typeof this._videoElement.getVideoPlaybackQuality){var e=this._videoElement.getVideoPlaybackQuality();return[e.droppedVideoFrames,e.totalVideoFrames]}return"number"==typeof this._videoElement.webkitDroppedFrameCount&&"number"==typeof this._videoElement.webkitDecodedFrameCount?[this._videoElement.webkitDroppedFrameCount,this._videoElement.webkitDecodedFrameCount]:[-1,-1]},n._checkFPS=function(){var e=this._getDroppedAndDecodedFrames(),t=e[0],r=e[1];try{var n=performance.now();if(r){if(this._lastTime){var i=n-this._lastTime,o=t-this._lastDroppedFrames,s=r-this._lastDecodedFrames,l=1e3*o/i;l>0&&(a._logger.debug("checkFPS : droppedFPS/decodedFPS:"+l/(1e3*s/i)),o>this._config.fpsDroppedMonitoringThreshold*s&&(this._mediaSourceAdapter.setMaxBitrate(this._currentBitrate-1),this._triggerFPSDrop({currentDropped:o,currentDecoded:s,totalDroppedFrames:l})))}this._lastTime=n,this._lastDroppedFrames=t,this._lastDecodedFrames=r}}catch(e){a._logger.error("Error occur while trying to check dropFrames: ",e)}},n.destroy=function(){this._droppedFramesInterval&&clearInterval(this._droppedFramesInterval),this._droppedFramesInterval=null,this._eventManager.destroy()},a}(P);function zt(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function qt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Kt(Wt,"_logger",C("droppedFramesWatcher"));var Yt=function(e){var t,r;function a(t,r,a){var n;return qt(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n=e.call(this)||this),"_reset",!1),n._eventManager=new M,n._canLoadMediaSourceAdapterPromise=Promise.resolve(),n._createVideoElement(a),n._init(t,r),n}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.isSupported=function(){try{var e=j.createElement("video");return e.volume=.5,!!e.canPlayType}catch(e){return!1}},a.createEngine=function(e,t,r){return new this(e,t,r)},a.canPlaySource=function(e,t,r){return Rt.canPlaySource(e,t,r)},a.runCapabilities=function(){a._capabilities.forEach((function(e){return e.runCapability()}))},a.getCapabilities=function(){var e=[];return a._capabilities.forEach((function(t){return e.push(t.getCapability())})),Promise.all(e).then((function(e){var t,r={};return e.forEach((function(e){return Object.assign(r,e)})),(t={})[a.id]=r,t}))},a.setCapabilities=function(e){a._capabilities.forEach((function(t){return t.setCapabilities(e)}))},a.prepareVideoElement=function(e){if(!a.videoElementStore[e]){a._logger.debug("Create the video element for playing "+e);var t=j.createElement("video");a.videoElementStore[e]=t}a._logger.debug("Prepare the video element for playing "+e),a.videoElementStore[e].load()};var n,i,o=a.prototype;return o.restore=function(e,t){this.reset(),this._init(e,t)},o.reset=function(){var e=this;this._reset||(this._reset=!0,this._eventManager.removeAll(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=null),this._canLoadMediaSourceAdapterPromise=new Promise((function(t,r){var a=e._mediaSourceAdapter?e._mediaSourceAdapter.destroy():Promise.resolve();e._el&&e._el.src?a.then((function(){j.setAttribute(e._el,"src",""),j.removeAttribute(e._el,"src"),t()}),r):a.then(t,r)})),this._mediaSourceAdapter=null)},o.destroy=function(){this.detach(),this._el&&(this.pause(),j.removeAttribute(this._el,"src"),j.removeChild(this._el.parentNode,this._el)),this._eventManager.destroy(),Rt.destroy(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=null),this._mediaSourceAdapter&&(this._mediaSourceAdapter.destroy(),this._mediaSourceAdapter=null)},o.attachMediaSource=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.attachMediaSource()},o.detachMediaSource=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.detachMediaSource()},o.attach=function(){var e=this;Object.keys(W).forEach((function(t){[W.ERROR,W.WAITING].includes(W[t])||e._eventManager.listen(e._el,W[t],(function(){return e.dispatchEvent(new v(W[t]))}))})),this._eventManager.listen(this._el,W.ERROR,(function(){return e._handleVideoError()})),this._eventManager.listen(this._el,W.WAITING,(function(){return e._handleWaiting()})),this._handleMetadataTrackEvents(),this._eventManager.listen(this._el.textTracks,"addtrack",(function(t){Xe.isNativeTextTrack(t.track)&&e.dispatchEvent(new v(z.TEXT_TRACK_ADDED,{track:t.track}))}));var t=this._mediaSourceAdapter;t&&(this._eventManager.listen(t,z.VIDEO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.AUDIO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.TEXT_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.TEXT_CUE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.TRACKS_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,W.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,W.TIME_UPDATE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,W.PLAYING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,W.WAITING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,z.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,"hlsFragParsingMetadata",(function(t){return e.dispatchEvent(t)})),this._droppedFramesWatcher&&this._eventManager.listen(this._droppedFramesWatcher,z.FPS_DROP,(function(t){return e.dispatchEvent(t)})))},o.detach=function(){var e=this;Object.keys(W).forEach((function(t){e._eventManager.unlisten(e._el,W[t])})),this._mediaSourceAdapter&&(this._eventManager.unlisten(this._mediaSourceAdapter,z.VIDEO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,z.AUDIO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,z.TEXT_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,z.TEXT_CUE_CHANGED))},o.getVideoElement=function(){return this._el},o.selectVideoTrack=function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectVideoTrack(e)},o.selectAudioTrack=function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectAudioTrack(e)},o.selectTextTrack=function(e){this._removeCueChangeListeners(),this._mediaSourceAdapter&&this._mediaSourceAdapter.selectTextTrack(e),this.resetAllCues(),this._addCueChangeListener()},o.selectImageTrack=function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectImageTrack(e)},o.hideTextTrack=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.hideTextTrack(),this._removeCueChangeListeners()},o.enableAdaptiveBitrate=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.enableAdaptiveBitrate()},o.isAdaptiveBitrateEnabled=function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isAdaptiveBitrateEnabled()},o.applyABRRestriction=function(e){if(this._mediaSourceAdapter)return this._mediaSourceAdapter.applyABRRestriction(e)},o.seekToLiveEdge=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.seekToLiveEdge()},o.isOnLiveEdge=function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isOnLiveEdge()},o.getStartTimeOfDvrWindow=function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getStartTimeOfDvrWindow():0},o.isLive=function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isLive()},o.play=function(){var e=this,t=this._el.play();return t&&t.catch((function(t){return e.dispatchEvent(new v(z.PLAY_FAILED,{error:t}))})),t},o.pause=function(){return this._el.pause()},o.load=function(e){var t=this;return this._el.load(),this._canLoadMediaSourceAdapterPromise.then((function(){return t._mediaSourceAdapter?t._mediaSourceAdapter.load(e):Promise.resolve({})})).catch((function(e){return t.dispatchEvent(new v(W.ERROR,e)),Promise.reject(e)}))},o.enterPictureInPicture=function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof this._el.requestPictureInPicture?this._el.requestPictureInPicture().catch((function(t){e.dispatchEvent(new v(W.ERROR,new O(O.Severity.RECOVERABLE,O.Category.PLAYER,O.Code.ENTER_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&(this._el.webkitSetPresentationMode("picture-in-picture"),setTimeout((function(){return e.dispatchEvent(new v(W.ENTER_PICTURE_IN_PICTURE))}),0))}catch(e){this.dispatchEvent(new v(W.ERROR,new O(O.Severity.RECOVERABLE,O.Category.PLAYER,O.Code.ENTER_PICTURE_IN_PICTURE_FAILED,e)))}},o.exitPictureInPicture=function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof document.exitPictureInPicture&&this._el===document.pictureInPictureElement?document.exitPictureInPicture().catch((function(t){e.dispatchEvent(new v(W.ERROR,new O(O.Severity.RECOVERABLE,O.Category.PLAYER,O.Code.EXIT_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&this._el.webkitSetPresentationMode("inline")}catch(e){this.dispatchEvent(new v(W.ERROR,new O(O.Severity.RECOVERABLE,O.Category.PLAYER,O.Code.EXIT_PICTURE_IN_PICTURE_FAILED,e)))}},o.isPictureInPictureSupported=function(){return"function"==typeof this._el.webkitSupportsPresentationMode?this._el.webkitSupportsPresentationMode("picture-in-picture"):!!document.pictureInPictureEnabled},o.getThumbnail=function(e){if(this._mediaSourceAdapter)return this._mediaSourceAdapter.getThumbnail(e)},o._init=function(e,t){this._config=t,this._reset=!1,this._loadMediaSourceAdapter(e),this.attach()},o._createVideoElement=function(e){this._el=a.videoElementStore[e]||j.createElement("video"),this._el.id=B.uniqueId(5),this._el.controls=!1},o._loadMediaSourceAdapter=function(e){this._mediaSourceAdapter=Rt.getMediaSourceAdapter(this.getVideoElement(),e,this._config),this._mediaSourceAdapter&&(this._droppedFramesWatcher=new Wt(this._mediaSourceAdapter,this._config.abr,this._el))},o._addCueChangeListener=function(){var e=this,t=Array.from(this._el.textTracks).find((function(e){return Xe.isNativeTextTrack(e)&&e.mode!==Xe.MODE.DISABLED}));t&&this._eventManager.listen(t,"cuechange",(function(t){return e._onCueChange(t)}))},o._removeCueChangeListeners=function(){var e=this;Array.from(this._el.textTracks).filter((function(e){return!Xe.isMetaDataTrack(e)})).forEach((function(t){e._eventManager.unlisten(t,"cuechange")}))},o._onCueChange=function(e){var t=Ye(e.currentTarget.activeCues);this.dispatchEvent(new v(z.TEXT_CUE_CHANGED,{cues:t}))},o.resetAllCues=function(){var e=Array.from(this._el.textTracks).find((function(e){return Xe.isNativeTextTrack(e)&&e.mode!==Xe.MODE.DISABLED}));if(e)for(var t=0;t<e.cues.length;t++)e.cues[t].hasBeenReset=!0},o._handleVideoError=function(){if(this._el.error){var e=this._el.error.code;if(e!==window.MediaError.MEDIA_ERR_ABORTED){var t=this._getMsExtendedError(),r=this._el.error.message;if(this._mediaSourceAdapter&&!this._mediaSourceAdapter.handleMediaError(this._el.error)){var a=new O(O.Severity.CRITICAL,O.Category.MEDIA,O.Code.VIDEO_ERROR,{code:e,extended:t,message:r});this.dispatchEvent(new v(W.ERROR,a))}}}},o._handleWaiting=function(){var e=this,t=!1;this._eventManager.listenOnce(this._el,W.PLAYING,(function(){return t=!0})),setTimeout((function(){t||e.dispatchEvent(new v(W.WAITING))}),200)},o._getMsExtendedError=function(){var e=this._el.error.msExtendedCode;return e&&(e<0&&(e+=Math.pow(2,32)),e=e.toString(16)),e},o._handleMetadataTrackEvents=function(){var e=this,t=function(t){t.mode=Xe.MODE.HIDDEN,e._eventManager.listen(t,"cuechange",(function(){var t=[];Array.from(e._el.textTracks).forEach((function(e){Xe.isMetaDataTrack(e)&&(t=t.concat(Ye(e.activeCues)))})),t=t.sort((function(e,t){return e.startTime-t.startTime})),e.dispatchEvent(new v(z.TIMED_METADATA,{cues:t})),e.dispatchEvent(new v(z.TIMED_METADATA_CHANGE,{cues:t.map((function(e){return Ut(e)}))}))}))};Array.from(this._el.textTracks).forEach((function(e){Xe.isMetaDataTrack(e)&&t(e)})),this._eventManager.listen(this._el.textTracks,"addtrack",(function(e){Xe.isMetaDataTrack(e.track)&&t(e.track)})),this._eventManager.listen(this._el.textTracks,"change",(function(){Array.from(e._el.textTracks).forEach((function(e){Xe.isMetaDataTrack(e)&&e.mode!==Xe.MODE.HIDDEN&&(e.mode=Xe.MODE.HIDDEN)}))}))},o.addTextTrack=function(e,t,r){return this._el.addTextTrack(e,t,r)},o.getNativeTextTracks=function(){return Array.from(this._el.textTracks)},o.getDrmInfo=function(){var e;return null==(e=this._mediaSourceAdapter)?void 0:e.getDrmInfo()},n=a,(i=[{key:"id",get:function(){return a.id}},{key:"src",set:function(e){this._mediaSourceAdapter&&(this._mediaSourceAdapter.src=e)},get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.src:""}},{key:"currentTime",get:function(){return this._el?this._el.currentTime:0},set:function(e){this._el&&(this._el.currentTime=e)}},{key:"duration",get:function(){return this._el.duration}},{key:"liveDuration",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.liveDuration:-1}},{key:"volume",set:function(e){this._el.volume=e},get:function(){return this._el.volume}},{key:"paused",get:function(){return this._el.paused}},{key:"seeking",get:function(){return this._el.seeking}},{key:"seekable",get:function(){return this._el.seekable}},{key:"played",get:function(){return this._el.played}},{key:"buffered",get:function(){return this._el.buffered}},{key:"muted",set:function(e){this._el.muted=e},get:function(){return this._el.muted}},{key:"defaultMuted",get:function(){return this._el.defaultMuted}},{key:"poster",set:function(e){this._el.poster=e},get:function(){return this._el.poster}},{key:"preload",set:function(e){this._el.preload=e},get:function(){return this._el.preload}},{key:"autoplay",set:function(e){this._el.autoplay=e},get:function(){return this._el.autoplay}},{key:"loop",set:function(e){this._el.loop=e},get:function(){return this._el.loop}},{key:"controls",set:function(e){this._el.controls=e},get:function(){return this._el.controls}},{key:"playbackRate",set:function(e){this._el.playbackRate=e},get:function(){return this._el.playbackRate}},{key:"defaultPlaybackRate",set:function(e){this._el.defaultPlaybackRate=e},get:function(){return this._el.defaultPlaybackRate}},{key:"ended",get:function(){return this._el.ended}},{key:"error",get:function(){return this._el.error}},{key:"networkState",get:function(){return this._el.networkState}},{key:"readyState",get:function(){return this._el.readyState}},{key:"videoHeight",get:function(){return this._el.videoHeight}},{key:"videoWidth",get:function(){return this._el.videoWidth}},{key:"playsinline",set:function(e){e?this._el.setAttribute("playsinline",""):this._el.removeAttribute("playsinline")},get:function(){return""===this._el.getAttribute("playsinline")}},{key:"crossOrigin",set:function(e){"string"==typeof e?this._el.setAttribute("crossorigin",e):this._el.removeAttribute("crossorigin")},get:function(){return this._el.getAttribute("crossorigin")}},{key:"playbackRates",get:function(){return a.PLAYBACK_RATES}},{key:"isInPictureInPicture",get:function(){return!!document.pictureInPictureElement&&null!=document.pictureInPictureElement&&this._el===document.pictureInPictureElement||!!this._el.webkitPresentationMode&&"picture-in-picture"===this._el.webkitPresentationMode}},{key:"targetBuffer",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.targetBuffer:NaN}},{key:"availableBuffer",get:function(){var e=0;if(this.buffered)for(var t=0;t<this.buffered.length;t++)this.buffered.start(t)<=this._el.currentTime&&this._el.currentTime<=this.buffered.end(t)&&(e=this.buffered.end(t)-this._el.currentTime);return e}}])&&zt(n.prototype,i),a}(P);function Xt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}qt(Yt,"_logger",C("Html5")),qt(Yt,"_capabilities",[Ht]),qt(Yt,"id","html5"),qt(Yt,"videoElementStore",{}),qt(Yt,"PLAYBACK_RATES",[.5,1,1.5,2]);var Qt=function(){function e(){}return e.register=function(t,r){t&&!e._engineProviders[t]?(e._logger.debug("Engine <"+t+"> has been registered successfully"),e._engineProviders[t]=r):e._logger.debug("Engine <"+t+"> is already registered, do not register again")},e.unRegister=function(t){e._engineProviders[t]&&(e._logger.debug("Unregistered <"+t+"> Engine"),delete e._engineProviders[t])},e.getEngines=function(){return Object.keys(e._engineProviders).map((function(t){return e._engineProviders[t]}))},e.destroy=function(){e._engineProviders={}},e}();Xt(Qt,"_logger",C("EngineProvider")),Xt(Qt,"_engineProviders",{}),Yt.isSupported()&&Qt.register(Yt.id,Yt);var Jt=Qt.register,Zt=Qt.unRegister;function er(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var rr="srt",ar="vtt",nr=function(e){var t,r;function a(t){var r;return tr(er(r=e.call(this)||this),"_externalCueIndex",0),tr(er(r),"_textTrackModel",{}),tr(er(r),"_activeTextCues",[]),tr(er(r),"_isTextTrackActive",!1),tr(er(r),"_lastTimeUpdate",0),r._player=t,r._eventManager=new M,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.hideTextTrack=function(){this._player.config.text.useNativeTextTrack?(this._removeCueChangeListeners(),this._resetExternalNativeTextTrack()):this._isTextTrackActive&&(this._eventManager.unlisten(this._player,W.TIME_UPDATE),this.dispatchEvent(new v(z.TEXT_CUE_CHANGED,{cues:[]})),this._resetCurrentTrack())},n.getExternalTracks=function(e){var t=this,r=this._player.sources.captions;if(!r)return[];this._player.config.text.useNativeTextTrack&&this._addNativeTextTrack();var a=e.filter((function(e){return e instanceof Xe})),n=[];return r.forEach((function(e){if(e.language){var r=t._createTextTrack(e);t._maybeAddTrack(r,e,a,n)}else{var i=new O(O.Severity.RECOVERABLE,O.Category.TEXT,O.Code.UNKNOWN_LANGUAGE,{caption:e});t.dispatchEvent(new v(W.ERROR,i))}})),n},n._maybeAddTrack=function(e,t,r,n){var i=r.find((function(e){return e.available&&ae.langComparer(t.language,e.language)}));i?a._logger.warn("duplicated language, taking the inband option. Language: ",i.language):(n.push(e),this._updateTextTracksModel(t))},n._createTextTrack=function(e){return new Xe({active:!!e.default,kind:Xe.KIND.SUBTITLES,label:e.label,language:e.language,external:!0})},n._updateTextTracksModel=function(e){this._textTrackModel[e.language]={cuesStatus:1,cues:[],url:e.url,type:e.type}},n.selectTextTrack=function(e){var t=this;this._textTrackModel[e.language]&&(3===this._textTrackModel[e.language].cuesStatus?this._selectTextTrack(e):1===this._textTrackModel[e.language].cuesStatus&&this._downloadAndParseCues(e).then((function(){t._textTrackModel[e.language].cuesStatus=3,t._selectTextTrack(e)})).catch((function(e){return t.dispatchEvent(new v(W.ERROR,e))})))},n._selectTextTrack=function(e){this.hideTextTrack(),this._player.config.text.useNativeTextTrack?(this._addCuesToNativeTextTrack(this._textTrackModel[e.language].cues),this._addCueChangeListener()):this._setTextTrack(e),e.active=!0,this.dispatchEvent(new v(z.TEXT_TRACK_CHANGED,{selectedTextTrack:e}))},n.resetAllCues=function(){for(var e in this._textTrackModel)this._textTrackModel[e].cues.forEach((function(e){e.hasBeenReset=!0}))},n._addCueChangeListener=function(){var e=this,t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return Xe.isNativeTextTrack(e)&&e.mode===Xe.MODE.SHOWING}));r&&this._eventManager.listen(r,"cuechange",(function(t){return e._onCueChange(t)}))}},n._removeCueChangeListeners=function(){var e=this._player.getVideoElement();if(e&&e.textTracks)for(var t=0;t<e.textTracks.length;t++)this._eventManager.unlisten(e.textTracks[t],"cuechange")},n._onCueChange=function(e){var t=Ye(e.currentTarget.activeCues);this.dispatchEvent(new v(z.TEXT_CUE_CHANGED,{cues:t}))},n.reset=function(){this._resetCurrentTrack(),this._textTrackModel={},this._resetExternalNativeTextTrack(),this._eventManager.removeAll()},n.destroy=function(){this._textTrackModel={},this._eventManager.destroy(),this._activeTextCues=[]},n._resetCurrentTrack=function(){this._activeTextCues=[],this._isTextTrackActive=!1,this._maybeSetExternalCueIndex()},n._getCuesString=function(e){var t=this;return new Promise((function(r,a){var n=t._textTrackModel[e.language],i=n.type||t._getFileType(n.url);[rr,ar].includes(i)||(t._textTrackModel[e.language].cuesStatus=1,a(new O(O.Severity.RECOVERABLE,O.Category.TEXT,O.Code.UNKNOWN_FILE_TYPE,{captionType:i}))),V.execute(n.url,{},"GET").then((function(e){r(i===rr?t._convertSrtToVtt(e):e)})).catch((function(){t._textTrackModel[e.language].cuesStatus=1,a(new O(O.Severity.RECOVERABLE,O.Category.TEXT,O.Code.HTTP_ERROR,{url:n.url}))}))}))},n._parseCues=function(e){return new Promise((function(t,r){var n=new Me(window,De()),i=[];n.oncue=function(e){return i.push(e)},n.onflush=function(){a._logger.debug("finished parsing external cues"),t(i)},n.parse(e),n.flush(),n.onparsingerror((function(e){return r(e)}))}))},n._convertSrtToVtt=function(e){return"WEBVTT\n\n"+e.replace(/(\d\d:\d\d:\d\d),(\d\d\d) --> (\d\d:\d\d:\d\d),(\d\d\d)/g,(function(e,t,r,a,n){return t+"."+r+" --\x3e "+a+"."+n}))},n._downloadAndParseCues=function(e){var t=this;return this._textTrackModel[e.language].cuesStatus=2,new Promise((function(r,a){t._getCuesString(e).then((function(e){return t._parseCues(e)})).then((function(a){t._textTrackModel[e.language].cues=a,r()})).catch((function(e){return a(e)}))}))},n._getFileType=function(e){return e.split(/[#?]/)[0].split(".").pop().trim()},n._handleCaptionOnTimeUpdate=function(e){var t=this._player.currentTime;if(t){var r=!1;this._hadSeeked()&&(this._activeTextCues=[],r=this._maybeSetExternalCueIndex());var a=this._maybeRemoveActiveCues(),n=this._maybeAddToActiveCues(e);(r||n||a)&&this.dispatchEvent(new v(z.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._lastTimeUpdate=t}},n._hadSeeked=function(){return!!this._player.currentTime&&Math.abs(this._player.currentTime-this._lastTimeUpdate)>1},n._maybeRemoveActiveCues=function(){var e=this._player.currentTime;if(!e)return!1;var t=this._activeTextCues.filter((function(t){return t.startTime<e&&e<t.endTime})),r=this._activeTextCues.length!==t.length;return this._activeTextCues=t,r},n._maybeAddToActiveCues=function(e){var t=this._player.currentTime;if(!t)return!1;for(var r=!1,a=this._textTrackModel[e.language].cues;this._externalCueIndex<a.length&&t>a[this._externalCueIndex].startTime;)t<a[this._externalCueIndex].endTime&&this._activeTextCues.push(a[this._externalCueIndex]),this._externalCueIndex++,r=!0;return r},n._maybeSetExternalCueIndex=function(){var e=this._player._getTextTracks().find((function(e){return e.active&&e.external}));if(e&&e.external){for(var t=this._textTrackModel[e.language]?this._textTrackModel[e.language].cues:[],r=0;r<t.length&&!(t[r].startTime<this._player.currentTime&&this._player.currentTime<t[r].endTime)&&!(t[r].endTime>this._player.currentTime&&t[r].startTime>this._player.currentTime);r++);return this._externalCueIndex=r,!0}return!1},n._resetExternalNativeTextTrack=function(){var e=this._player.getVideoElement();if(e&&e.textTracks){var t=Array.from(e.textTracks).find((function(e){return!!e&&Xe.isExternalTrack(e)}));t&&(t.cues&&Object.values(t.cues).forEach((function(e){return t.removeCue(e)})),t.mode=Xe.MODE.DISABLED)}},n._addCuesToNativeTextTrack=function(e){var t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return!!e&&Xe.isExternalTrack(e)}));r&&(r.mode=Xe.MODE.SHOWING,void 0===window.VTTCue?this._convertCues(e).forEach((function(e){return r.addCue(e)})):e.forEach((function(e){return r.addCue(e)})))}},n._convertCues=function(e){return e.map((function(e){return new window.TextTrackCue(e.startTime,e.endTime,e.text)}))},n._addNativeTextTrack=function(){var e=this._player.getVideoElement();e&&e.textTracks&&(Array.from(e.textTracks).findIndex((function(e){return!!e&&Xe.isExternalTrack(e)}))>-1?this._resetExternalNativeTextTrack():e.addTextTrack(Xe.KIND.SUBTITLES,Xe.EXTERNAL_TRACK_ID,Xe.EXTERNAL_TRACK_ID))},n._setTextTrack=function(e){var t=this;this._player.config.text.useNativeTextTrack||(this._isTextTrackActive=!0,a._logger.debug("External text track changed",e),this._activeTextCues=[],this._externalCueIndex=0,this.dispatchEvent(new v(z.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._eventManager.listen(this._player,W.TIME_UPDATE,(function(){return t._handleCaptionOnTimeUpdate(e)})))},a}(P);tr(nr,"_logger",C("ExternalCaptionsHandler"));var ir={PRE:"preroll",MID:"midroll",POST:"postroll",OVERLAY:"overlay"},or={VAST:"vast",VMAP:"vmap"},sr=function(e){var t,r;function a(){return e.call(this)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.destroy=function(){this._observer&&this._observer.disconnect(),this._observer=null,this._el=null},n.init=function(e){this._observer||(this._el=e,window.ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))},n._createNativeObserver=function(){var e=this;this._observer=new window.ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))},n._createIframeObserver=function(){this._observer=new lr(this._triggerResize.bind(this))},n._triggerResize=function(){this.dispatchEvent(new v(z.RESIZE))},a}(P),lr=function(){function e(e){!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"_observersStore",{}),this._onChangeCallback=e}var t=e.prototype;return t.observe=function(e){var t=this,r=this._createIframe(),a=e.getAttribute("id");this._observersStore[a]=r,e.appendChild(r),r.contentWindow.onresize=function(){return t._onChangeCallback()}},t.disconnect=function(){for(var e in this._observersStore){var t=document.getElementById(e),r=this._observersStore[e];r.onresize=null,t&&(t.removeChild(r),delete this._observersStore[t.getAttribute("id")])}},t._createIframe=function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e},e}();function ur(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=function(){return 1}),0===e.length||1===e.length&&0!==t(e[0]))return null;var r=Math.floor(e.length/2);return 0===t(e[r])?e[r]:t(e[r])>0?ur(e.slice(0,r),t):ur(e.slice(r+1),t)}function cr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var dr=function(){function e(e){cr(this,"_isElementInFullscreen",!1),cr(this,"_isScreenLocked",!1),cr(this,"_isScreenOrientationSupport",!!screen&&!!screen.orientation&&"function"==typeof screen.orientation.unlock&&"function"==typeof screen.orientation.lock),cr(this,"_isFullscreenEventDispatched",!1),this._player=e,this._isInBrowserFullscreen=!1,this._eventManager=new M}var t=e.prototype;return t._isNativeDocumentFullscreen=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)},t._isIOSFullscreen=function(){var e="function"==typeof this._player.getVideoElement?this._player.getVideoElement():null;return"iOS"===this._player.env.os.name&&!!e&&("fullscreen"===e.webkitPresentationMode||!e.webkitPresentationMode&&e.webkitDisplayingFullscreen)},t.isFullscreen=function(){return this._isNativeDocumentFullscreen()&&this._isElementInFullscreen||this._isIOSFullscreen()||this._isInBrowserFullscreen},t.enterFullscreen=function(e){if(!this.isFullscreen()){this.registerFullScreenEvents();var t=e&&j.getElementById(e),r=this._player.config.playback;if(t||(t=this._player.getView()),"iOS"===this._player.env.os.name)if(r.inBrowserFullscreen&&r.playsinline||this._player._engineType===Ze.YOUTUBE)this._enterInBrowserFullscreen(t);else{var a=this._player.getVideoElement();a&&"function"==typeof a.webkitEnterFullScreen&&(this._player.isInPictureInPicture()?(setTimeout((function(){return a.webkitEnterFullScreen()}),1e3),this._player.exitPictureInPicture()):a.webkitEnterFullScreen())}else this._requestFullscreen(t)}},t.exitFullscreen=function(){if(this.isFullscreen())if("iOS"===this._player.env.os.name)if(this._isInBrowserFullscreen||this._player._engineType===Ze.YOUTUBE)this._exitInBrowserFullscreen();else{var e=this._player.getVideoElement();e&&"function"==typeof e.webkitExitFullscreen&&e.webkitExitFullscreen()}else this._requestExitFullscreen()},t._nativeEnterFullScreen=function(e){return"function"==typeof e.requestFullscreen?e.requestFullscreen():"function"==typeof e.mozRequestFullScreen?e.mozRequestFullScreen():"function"==typeof e.webkitRequestFullScreen?e.webkitRequestFullScreen():"function"==typeof e.msRequestFullscreen?e.msRequestFullscreen():void 0},t._requestFullscreen=function(e){var t=this;this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),Promise.resolve(this._nativeEnterFullScreen(e)).then((function(){t._isElementInFullscreen=!0;var e=F.getPropertyPath(t._player,"config.playback.screenLockOrientionMode"),r=e!==ot.NONE&&Object.values(ot).includes(e);t._isScreenOrientationSupport&&r&&screen.orientation.lock(e).then((function(){return t._isScreenLocked=!0})).catch((function(){return t._isScreenLocked=!1}))}),(function(){}))},t._nativeExitFullScreen=function(){return"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.msExitFullscreen?document.msExitFullscreen():void 0},t._requestExitFullscreen=function(){var e=this;Promise.resolve(this._nativeExitFullScreen()).then((function(){e._isElementInFullscreen=!1,e._isScreenOrientationSupport&&e._isScreenLocked&&(screen.orientation.unlock(),e._isScreenLocked=!1)}),(function(){}))},t._enterInBrowserFullscreen=function(e){this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),j.addClassName(e,"playkit-in-browser-fullscreen-mode"),this._isInBrowserFullscreen=!0,this._fullscreenEnterHandler(),this._player.dispatchEvent(new v(this._player.Event.RESIZE))},t._exitInBrowserFullscreen=function(){var e=j.getElementBySelector(".playkit-in-browser-fullscreen-mode");e&&j.removeClassName(e,"playkit-in-browser-fullscreen-mode"),this._isInBrowserFullscreen=!1,this._fullscreenExitHandler(),this._player.dispatchEvent(new v(this._player.Event.RESIZE))},t.registerFullScreenEvents=function(){var e=this;"iOS"===this._player.env.os.name?this._handleIosFullscreen():(this._eventManager.listen(document,"webkitfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"mozfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"fullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"MSFullscreenChange",(function(){return e._fullscreenChangeHandler()})))},t._handleIosFullscreen=function(){var e=this,t=function(){var t=e._player.getVideoElement();t&&(e._eventManager.listen(t,"webkitbeginfullscreen",(function(){return e._fullscreenEnterHandler()})),e._eventManager.listen(t,"webkitendfullscreen",(function(){return e._fullscreenExitHandler()})))};this._player.getVideoElement()?t():this._eventManager.listenOnce(this._player,this._player.Event.SOURCE_SELECTED,(function(){return t()}))},t._fullscreenChangeHandler=function(){this.isFullscreen()?this._fullscreenEnterHandler():this._fullscreenExitHandler()},t._fullscreenEnterHandler=function(){this.isFullscreen()&&!this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!0,this._player.dispatchEvent(new v(this._player.Event.ENTER_FULLSCREEN)))},t._fullscreenExitHandler=function(){!this.isFullscreen()&&this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!1,this._eventManager.removeAll(),this._player.dispatchEvent(new v(this._player.Event.EXIT_FULLSCREEN)))},t.destroy=function(){this._eventManager.destroy()},e}();function pr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var hr=function(){function e(){pr(this,"_decoratorProviders",new Map),pr(this,"_logger",C("EngineDecoratorManager"))}var t=e.prototype;return t.register=function(e){this._decoratorProviders.has(e.getName())?this._logger.warn("decorator already registered for "+e.getName()):this._decoratorProviders.set(e.getName(),e)},t.createDecorators=function(e,t){return this._logger.debug("decorators created for "+Array.from(this._decoratorProviders.keys()).toString()),Array.from(this._decoratorProviders.values(),(function(r){return r.getEngineDecorator(e,t)}))},t.destroy=function(){this._logger.debug("decorators destroyed"),this._decoratorProviders.clear()},e}();function fr(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var yr=function(e){var t,r;function a(t,r){var a;return(a=e.call(this)||this)._eventManager=new M,a._pluginDecorators=r.createDecorators(t,e.prototype.dispatchEvent.bind(gr(a))),Object.values(q).forEach((function(e){return a._eventManager.listen(t,e,(function(e){return a.dispatchEvent(e)}))})),new Proxy(t,{get:function(e,t){"destroy"===t&&a._destroy();var r,n=a._pluginDecorators.find((function(e){return e.active}));return(r="addEventListener"===t||"removeEventListener"===t?gr(a):n&&t in n?n:e)[t]&&"function"==typeof r[t].bind?r[t].bind(r):r[t]},set:function(e,t,r){var n=a._pluginDecorators.find((function(e){return t in e&&e.active}));return n&&t in n?n[t]=r:e[t]=r,!0}})||gr(a)}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n,i,o=a.prototype;return o.dispatchEvent=function(t){var r=this._pluginDecorators.find((function(e){return e.active}));return r&&r.dispatchEvent?r.dispatchEvent(t):e.prototype.dispatchEvent.call(this,t)},o._destroy=function(){this._pluginDecorators=[],this._eventManager.destroy()},n=a,(i=[{key:"active",get:function(){return!0}}])&&fr(n.prototype,i),a}(P),mr={TRUE:!0,FALSE:!1,IN_VIEW:"inview"};function vr(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return _r(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function _r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function kr(){return(kr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Er(e,t,r,a,n,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function Tr(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var i=e.apply(t,r);function o(e){Er(i,a,n,o,s,"next",e)}function s(e){Er(i,a,n,o,s,"throw",e)}o(void 0)}))}}function br(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Sr=/#wh=/i,Ar=/#xywh=/i,Cr=new RegExp("^/[^/].+"),Pr=function(e){var t,r;function a(){var t;return br(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t=e.call(this)||this),"_cues",[]),t._eventManager=new M,t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.load=function(){var e=Tr(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return a._logger.debug("start loading the vtt thumbnails"),e.next=5,this._downloadAndParseCues(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getThumbnail=function(e){var t=this._findCue(e,this._cues);if(t){var r=t.size,a=t.coordinates,n=kr({url:t.imgUrl},r=r||this._naturalImgSize,a=a||{x:0,y:0});return new ht(n)}return null},n.isUsingVttThumbnails=function(){var e;return!!(null==(e=this._cues)?void 0:e.length)},n._downloadAndParseCues=function(){var e=Tr(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._downloadVttFile(t);case 3:return r=e.sent,e.next=6,this._processVtt(r);case 6:return a=e.sent,e.next=9,this._formatIntoThumbnailCues(a,t);case 9:this._cues=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.dispatchEvent(new v(W.ERROR,e.t0));case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),n._downloadVttFile=function(){var e=Tr(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V.execute(t.vttUrl,{},"GET");case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),new O(O.Severity.RECOVERABLE,O.Category.TEXT,O.Code.HTTP_ERROR,e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),n._processVtt=function(){var e=Tr(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new Me(window,De()),i=[];n.oncue=function(e){return i.push(e)},n.onflush=function(){a._logger.debug("finished parsing thumbnails cues"),e(i)},n.parse(t),n.flush(),n.onparsingerror((function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n._formatIntoThumbnailCues=function(){var e=Tr(regeneratorRuntime.mark((function e(t,r){var a,n,i,o,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validateThumbnailsVTTFormat(t)){e.next=4;break}throw new O(O.Severity.RECOVERABLE,O.Category.TEXT,O.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"invalid thumbnail vtt format",vttUrl:r.vttUrl});case 4:return a=this._extractCueMetadata(t[0],r),e.next=7,this.validateImgUrl(a.imgUrl);case 7:if(e.sent){e.next=11;break}throw new O(O.Severity.RECOVERABLE,O.Category.TEXT,O.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"failed loading the image - invalid image url",imgUrl:a.imgUrl});case 11:return e.next=13,this.extractImgNaturalDimensions(a.imgUrl);case 13:for(this._naturalImgSize=e.sent,n=[],i=vr(t);!(o=i()).done;)s=o.value,l=this._extractCueMetadata(s,r),n.push(l);return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),n.validateThumbnailsVTTFormat=function(e){return e.length&&e[0]instanceof je},n.extractImgNaturalDimensions=function(e){var t=this;return new Promise((function(r){var a=new Image;a.src=e,t._eventManager.listenOnce(a,"load",(function(){r({height:a.naturalHeight,width:a.naturalWidth})})),t._eventManager.listenOnce(a,"error",(function(){return r(null)}))}))},n.validateImgUrl=function(e){var t=this;return new Promise((function(r){var a=new Image;a.src=e,t._eventManager.listenOnce(a,"load",(function(){r(!0)})),t._eventManager.listenOnce(a,"error",(function(){return r(!1)}))}))},n._extractCueMetadata=function(e,t){var r,n=e.startTime,i=e.endTime,o=e.text,s=t.vttUrl.substring(0,t.vttUrl.lastIndexOf("/")),l=Sr.test(o),u=Ar.test(o),c=!1,d=null,p=null;if(l)r=o.split(Sr)[0],a._logger.warn('vtt thumbnails in "'+Sr+'" form - is supported but the width and height options are ignored and The images will be displayed in their natural dimensions'),c=void 0!==r;else if(u){var h=o.split(Ar);r=h[0];var f=h[1].split(",").map(Number),g=f[0],y=f[1],m=f[2],v=f[3];d={x:g,y:y},p={width:m,height:v},c=[g,y,m,v,r].every((function(e){return void 0!==e}))}else r=o,c=!!o;if(0!==r.indexOf("http://")&&0!==r.indexOf("https://")&&(r=s+"/"+(r=Cr.test(r)?r.substring(1):r)),c)return{startTime:n,endTime:i,imgUrl:r,size:p,coordinates:d};throw new O(O.Severity.RECOVERABLE,O.Category.TEXT,O.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"error while parsing the vtt cues - invalid cue",parsedCue:{startTime:n,endTime:i,options:o}})},n._findCue=function(e,t){for(var r=0,a=t.length-1;r<=a;){var n=Math.floor((r+a)/2),i=t[n];if(e>=i.startTime&&e<i.endTime)return t[n];e<i.startTime?a=n-1:r=n+1}return null},n.reset=function(){this._cues=[],this._eventManager.removeAll(),this._naturalImgSize={}},n.destroy=function(){this.reset(),this._eventManager.destroy()},a}(P);function wr(){return(wr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Ir(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Mr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}br(Pr,"_logger",C("ExternalThumbnailsHandler"));var Rr="off",Or=function(e){var t,r;function a(t){var r;return void 0===t&&(t={}),Dr(Mr(r=e.call(this)||this),"_sources",{}),Dr(Mr(r),"_activeTextCues",[]),Dr(Mr(r),"_textDisplaySettings",{}),Dr(Mr(r),"_playbackAttributesState",{muted:void 0,volume:void 0,rate:void 0,videoTrack:void 0,audioLanguage:"",textLanguage:""}),Dr(Mr(r),"_hasUserInteracted",!1),Dr(Mr(r),"_isOnLiveEdge",!1),Dr(Mr(r),"_shouldLoadAfterAttach",!1),r._setConfigLogLevel(t),r._playerId=B.uniqueId(5),r._prepareVideoElement(),a.runCapabilities(),r._env=g,r._tracks=[],r._firstPlay=!0,r._loadingMedia=!1,r._loading=!1,r._playbackStart=!1,r._firstPlaying=!1,r._reset=!0,r._destroyed=!1,r._fallbackToMutedAutoPlay=!1,r._config=a._defaultConfig,r._sources=F.copyDeep(lt),r._eventManager=new M,r._posterManager=new G,r._stateManager=new te(Mr(r)),r._resizeWatcher=new sr,r._playbackMiddleware=new it,r._textStyle=new ye,r._createReadyPromise(),r._createPlayerContainer(),r._appendDomElements(),r._externalCaptionsHandler=new nr(Mr(r)),r._externalThumbnailsHandler=new Pr,r._fullscreenController=new dr(Mr(r)),r.configure(t),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.runCapabilities=function(){a._logger.debug("Running player capabilities"),Qt.getEngines().forEach((function(e){return e.runCapabilities()}))},a.getCapabilities=function(e){a._logger.debug("Get player capabilities",e);var t=[];return Qt.getEngines().forEach((function(e){return t.push(e.getCapabilities())})),Promise.all(t).then((function(t){var r={};return t.forEach((function(e){return Object.assign(r,e)})),e?r[e]:r}))},a.setCapabilities=function(e,t){a._logger.debug("Set player capabilities",e,t);var r=Qt.getEngines().find((function(t){return t.id===e}));r&&r.setCapabilities(t)};var n,i,o,s=a.prototype;return s.configure=function(e){void 0===e&&(e={}),this._setConfigLogLevel(e),F.mergeDeep(this._config,e),this._applyTextTrackConfig(e),this._applyABRRestriction(e)},s.setSourcesMetadata=function(e){this._sources&&(this._sources.metadata||(this._sources.metadata={}),F.mergeDeep(this._sources.metadata,e))},s.setSources=function(e){this._hasSources(e)?(this.reset(),F.mergeDeep(this._sources,e),this._resizeWatcher.init(j.getElementById(this._playerId)),a._logger.debug("Change source started"),this.dispatchEvent(new v(z.CHANGE_SOURCE_STARTED)),this._reset=!1,this._selectEngineByPriority()?(this.dispatchEvent(new v(z.SOURCE_SELECTED,{selectedSource:this._sources[this._streamType]})),this._attachMedia(),this._handlePlaybackOptions(),this._posterManager.setSrc(this._sources.poster),this._handleDimensions(),this._handlePreload(),this._handleAutoPlay(),a._logger.debug("Change source ended"),this.dispatchEvent(new v(z.CHANGE_SOURCE_ENDED))):(a._logger.warn("No playable engines was found to play the given sources"),this.dispatchEvent(new v(W.ERROR,new O(O.Severity.CRITICAL,O.Category.PLAYER,O.Code.NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE,"No Engine Found To Play The Source"))))):F.mergeDeep(this._sources,e)},s.ready=function(){return this._readyPromise?this._readyPromise:Promise.resolve()},s.load=function(){var e=this;this.src?a._logger.debug("The source has already been loaded. load request ignored"):this._playbackMiddleware.load((function(){e._engine?e._load():e._eventManager.listenOnce(e,z.SOURCE_SELECTED,(function(){return e._load()}))}))},s.play=function(e){var t=this;e&&e.programmatic?this._autoPlay():(this._playbackStart||(this._playbackStart=!0,this.dispatchEvent(new v(z.PLAYBACK_START)),this.src||this._prepareVideoElement(),this.load()),this._engine?this._playbackMiddleware.play((function(){return t._play()})):this._loadingMedia?this._playbackMiddleware.play((function(){return t._playAfterAsyncMiddleware()})):this.dispatchEvent(new v(W.ERROR,new O(O.Severity.CRITICAL,O.Category.PLAYER,O.Code.NO_SOURCE_PROVIDED,"No Source Provided"))))},s.pause=function(){this._engine&&this._playbackMiddleware.pause(this._pause.bind(this))},s.getView=function(){return this._el},s.getVideoElement=function(){if(this._engine)return this._engine.getVideoElement()},s.reset=function(e){void 0===e&&(e=!1),this._reset||(this.pause(),this._externalCaptionsHandler.reset(),this._externalThumbnailsHandler.reset(),this._posterManager.reset(),this._stateManager.reset(),this._sources=F.copyDeep(lt),this._activeTextCues=[],this._updateTextDisplay([]),this._tracks=[],Xe.reset(),this._resetStateFlags(),this._engineType="",this._streamType="",this._pendingSelectedVideoTrack=null,this._engine&&this._engine.reset(),this.showBlackCover(),this._reset=!0,this.dispatchEvent(new v(z.PLAYER_RESET,{isChangeMedia:e})),this._eventManager.removeAll(),this._resizeWatcher.init(j.getElementById(this._playerId)),this._createReadyPromise(),this._isOnLiveEdge=!1,this._shouldLoadAfterAttach=!1)},s.destroy=function(){this._destroyed||(this._externalCaptionsHandler.destroy(),this._posterManager.destroy(),this._stateManager.destroy(),this._fullscreenController.destroy(),this._activeTextCues=[],this._textDisplaySettings={},this._config={},this._tracks=[],this._engineType="",this._streamType="",this._readyPromise=null,this._pendingSelectedVideoTrack=null,this._resetStateFlags(),this._playbackAttributesState={},this._engine&&this._engine.destroy(),this._engineDecoratorManager&&this._engineDecoratorManager.destroy(),this._resizeWatcher.destroy(),this._el&&j.removeChild(this._el.parentNode,this._el),this._destroyed=!0,this.dispatchEvent(new v(z.PLAYER_DESTROY)),this._eventManager.destroy())},s.hideBlackCover=function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="hidden")},s.showBlackCover=function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="visible")},s.attachMediaSource=function(){var e=this;this._engine&&(this._shouldLoadAfterAttach=!0,this._engine.attachMediaSource(),this._eventManager.listenOnce(this,W.CAN_PLAY,(function(){"number"==typeof e._playbackAttributesState.rate&&(e.playbackRate=e._playbackAttributesState.rate)})))},s.detachMediaSource=function(){this._engine&&(this.pause(),this.hideTextTrack(),this._shouldLoadAfterAttach=!1,this._createReadyPromise(),this._engine.detachMediaSource())},s.registerEngineDecoratorProvider=function(e){this._engineDecoratorManager||(this._engineDecoratorManager=new hr),e&&this._engineDecoratorManager.register(e)},s._getTargetElement=function(){return j.getElementById(this._config.targetId)},s.isLive=function(){return!(this._sources.type===et.VOD||!(this._sources.type===et.LIVE||this._engine&&this._engine.isLive()))},s.isAudio=function(){return this._sources.type===et.AUDIO},s.isOnLiveEdge=function(){return this._engine&&"function"==typeof this._engine.isOnLiveEdge?this._engine.isOnLiveEdge():this._isOnLiveEdge},s.isDvr=function(){return this.isLive()&&this._sources.dvr},s.seekToLiveEdge=function(){this._engine&&this.isLive()&&(this._engine.seekToLiveEdge(),this._isOnLiveEdge=!0)},s.getStartTimeOfDvrWindow=function(){return this._engine?this._engine.getStartTimeOfDvrWindow():0},s.getTracks=function(e){switch(e){case Qe.VIDEO:return F.copyDeep(this._getVideoTracks());case Qe.AUDIO:return F.copyDeep(this._getAudioTracks());case Qe.TEXT:return F.copyDeep(this._getTextTracks());case Qe.IMAGE:return F.copyDeep(this._getImageTracks());default:return F.copyDeep(this._tracks)}},s.getActiveTracks=function(){return F.copyDeep({video:this._getVideoTracks().find((function(e){return e.active})),audio:this._getAudioTracks().find((function(e){return e.active})),text:this._getTextTracks().find((function(e){return e.active}))})},s.selectTrack=function(e){this._engine&&(e instanceof ie?(this._playbackAttributesState.videoTrack=e,this._stateManager.currentState.type===Z.IDLE?this._pendingSelectedVideoTrack=e:this._engine.selectVideoTrack(e)):e instanceof oe?this._engine.selectAudioTrack(e):e instanceof Xe?(this._resetTextDisplay(),e.language===Rr?(this.hideTextTrack(),this._externalCaptionsHandler.hideTextTrack(),this._playbackAttributesState.textLanguage=Rr):e.external?(this._engine.hideTextTrack(),this._externalCaptionsHandler.selectTextTrack(e)):(this._externalCaptionsHandler.hideTextTrack(),this._engine.selectTextTrack(e))):e instanceof dt&&this._engine.selectImageTrack(e))},s.hideTextTrack=function(){if(this._engine){this._engine.hideTextTrack(),this._resetTextDisplay();var e=this._getTextTracks(),t=e.find((function(e){return!0===e.active}));t&&t.external&&this._externalCaptionsHandler.hideTextTrack(),e.map((function(e){return e.active=!1}));var r=e.find((function(e){return e.language===Rr}));r&&(r.active=!0,this.dispatchEvent(new v(z.TEXT_TRACK_CHANGED,{selectedTextTrack:r}))),this._playbackAttributesState.textLanguage=Rr}},s.showTextTrack=function(){var e=this._getTextTracks(),t=this._playbackAttributesState.textLanguage!==Rr&&this._playbackAttributesState.textLanguage||this._getLanguage(e,"auto",e.find((function(e){return e.default})));this._setDefaultTrack(e,t)},s.addTextTrack=function(e,t,r){if(this._engine&&"function"==typeof this._engine.addTextTrack)return this._engine.addTextTrack(e,t,r)},s.getNativeTextTracks=function(){return this._engine&&"function"==typeof this._engine.getNativeTextTracks?this._engine.getNativeTextTracks():[]},s.enableAdaptiveBitrate=function(){this._engine&&this._engine.enableAdaptiveBitrate(),this._playbackAttributesState.videoTrack=void 0},s.isAdaptiveBitrateEnabled=function(){return!!this._engine&&this._engine.isAdaptiveBitrateEnabled()},s._applyABRRestriction=function(e){if(F.hasPropertyPath(e,"abr.restrictions")&&this._engine&&this._tracks.length){var t=this._config.abr.restrictions,r=vt(this._tracks.filter((function(e){return e instanceof ie})),t);if(r.length){var n=this._tracks.filter((function(e){return e instanceof ie&&e.available}));(n.length!==r.length||!n.every((function(e,t){return e.bandwidth===r[t].bandwidth})))&&(this._engine.applyABRRestriction(t),this._tracks.forEach((function(e){!r.includes(e)&&e instanceof ie?(e.available=!1,e.active=!1):e.available=!0})),this.getActiveTracks().video||(r[0].active=!0),this.dispatchEvent(new v(z.TRACKS_CHANGED,{tracks:this._tracks.filter((function(e){return e.available}))})))}else a._logger.warn("Invalid restriction, Nothing has changed values do not meet the restriction")}},s._applyTextTrackConfig=function(e){if(F.hasPropertyPath(e,"text.textTrackDisplaySetting")||F.getPropertyPath(e,"text.forceCenter")){var t={};F.hasPropertyPath(this._config,"text.textTrackDisplaySetting")&&(t=F.mergeDeep(t,this._config.text.textTrackDisplaySetting)),F.getPropertyPath(this._config,"text.forceCenter")&&(t=F.mergeDeep(t,{position:"auto",align:"center",size:"100"})),this.setTextDisplaySettings(t)}try{F.hasPropertyPath(e,"text.textStyle")&&(this.textStyle=ye.fromJson(this._config.text.textStyle))}catch(e){a._logger.warn(e)}},s.getThumbnail=function(e){return this._externalThumbnailsHandler.isUsingVttThumbnails()?this._externalThumbnailsHandler.getThumbnail(e):this._engine?this._engine.getThumbnail(e):null},s.setTextDisplaySettings=function(e){this._textDisplaySettings=F.mergeDeep(this._textDisplaySettings,e),this._updateCueDisplaySettings();for(var t=0;t<this._activeTextCues.length;t++)this._activeTextCues[t].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)},s.isFullscreen=function(){return this._fullscreenController.isFullscreen()},s.notifyEnterFullscreen=function(){this.isFullscreen()&&this.dispatchEvent(new v(z.ENTER_FULLSCREEN))},s.notifyExitFullscreen=function(){this.isFullscreen()||this.dispatchEvent(new v(z.EXIT_FULLSCREEN))},s.enterFullscreen=function(e){this._fullscreenController.enterFullscreen(e)},s.exitFullscreen=function(){this._fullscreenController.exitFullscreen()},s.enterPictureInPicture=function(){this.isFullscreen()&&this.exitFullscreen(),this._engine&&!this._engine.isInPictureInPicture&&this._engine.enterPictureInPicture()},s.exitPictureInPicture=function(){this._engine&&this._engine.isInPictureInPicture&&this._engine.exitPictureInPicture()},s.isInPictureInPicture=function(){return!!this._engine&&this._engine.isInPictureInPicture},s.isPictureInPictureSupported=function(){return!!this._config.playback.pictureInPicture&&this._engine.isPictureInPictureSupported()},s.isVr=function(){return!!this._sources.vr},s.getLogLevel=function(e){return S(e)},s.setLogLevel=function(e,t){A(e,t)},s.getDrmInfo=function(){var e;return null==(e=this._engine)?void 0:e.getDrmInfo()},s._resetTextDisplay=function(){this._activeTextCues=[],this._updateTextDisplay([])},s._prepareVideoElement=function(){var e=this;Qt.getEngines().forEach((function(t){t.prepareVideoElement(e._playerId)}))},s._setConfigLogLevel=function(e){e.log&&e.log.level&&k[e.log.level]&&A(k[e.log.level]),e.log&&"function"==typeof e.log.handler&&T(e.log.handler)},s._hasSources=function(e){return!!e&&!!Object.values(Je).find((function(t){return e[t]&&e[t].length>0}))},s._createPlayerContainer=function(){var e=this._el=j.createElement("div");j.addClassName(e,"playkit-container"),j.setAttribute(e,"id",this._playerId),j.setAttribute(e,"tabindex","-1")},s._appendEngineEl=function(){if(this._el){var e=this._engine.getVideoElement();j.addClassName(e,"playkit-engine");var t="playkit-engine-"+this._engine.id;j.addClassName(e,t),j.prependTo(e,this._el),"youtube"===this._engine.id&&(this._el.style.zIndex=1)}},s._appendDomElements=function(){this._blackCoverEl=j.createElement("div"),j.addClassName(this._blackCoverEl,"playkit-black-cover"),j.appendChild(this._el,this._blackCoverEl);var e=this._posterManager.getElement();j.addClassName(e,"playkit-poster"),j.appendChild(this._el,e),this._textDisplayEl=j.createElement("div"),j.addClassName(this._textDisplayEl,"playkit-subtitles"),j.appendChild(this._el,this._textDisplayEl)},s._createReadyPromise=function(){var e=this;this._readyPromise=new Promise((function(t,r){e._eventManager.listenOnce(e,z.TRACKS_CHANGED,(function(){e.dispatchEvent(new v(z.MEDIA_LOADED)),t()})),e._eventManager.listen(e,W.ERROR,(function(e){e.payload.severity===O.Severity.CRITICAL&&r()}))})).catch((function(){}))},s._selectEngineByPriority=function(){for(var e,t=this,r=this._config.playback.streamPriority,n=this._config.playback.preferNative,i=this._sources,o=function(){var r=e.value,o="string"==typeof r.engine?r.engine.toLowerCase():"",s="string"==typeof r.format?r.format.toLowerCase():"",l=Qt.getEngines().find((function(e){return e.id===o}));if(l){var u=i[s];if(u&&u.length>0){var c=u[0];if(l.canPlaySource(c,n[s],t._config.drm))return a._logger.debug("Source selected: ",u),t._loadEngine(l,c),t._engineType=o,t._streamType=s,{v:!0}}}},s=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return xr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(r);!(e=s()).done;){var l=o();if("object"==typeof l)return l.v}return!1},s._loadEngine=function(e,t){this._engine?this._engine.id===e.id?this._engine.restore(t,wr({},this._config,{sources:this._sources})):(this._engine.destroy(),this._createEngine(e,t),this._appendEngineEl()):(this._createEngine(e,t),this._appendEngineEl())},s._createEngine=function(e,t){var r=e.createEngine(t,wr({},this._config,{sources:this._sources}),this._playerId);this._engine=this._engineDecoratorManager?new yr(r,this._engineDecoratorManager):r},s._attachMedia=function(){var e=this;if(this._engine){Object.keys(W).forEach((function(t){e._eventManager.listen(e._engine,W[t],(function(t){return e.dispatchEvent(t)}))})),this._eventManager.listen(this._engine,W.SEEKING,(function(){e.isLive()&&(e._isOnLiveEdge=!(!e.duration||!e.currentTime)&&e.currentTime>=e.duration-1&&!e.paused)})),this._eventManager.listen(this._engine,W.SEEKED,(function(){var t=e._env.browser.name;"Edge"!==t&&"IE"!==t||e._removeTextCuePatch()})),this._eventManager.listen(this._engine,z.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.TEXT_TRACK_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.VIDEO_TRACK_CHANGED,(function(t){return e._markActiveTrack(t.payload.selectedVideoTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.AUDIO_TRACK_CHANGED,(function(t){e.ready().then((function(){return e._playbackAttributesState.audioLanguage=t.payload.selectedAudioTrack.language})),e._markActiveTrack(t.payload.selectedAudioTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._engine,z.TRACKS_CHANGED,(function(t){return e._onTracksChanged(t)})),this._eventManager.listen(this._engine,z.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._engine,z.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.TIMED_METADATA,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.TIMED_METADATA_CHANGE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.PLAY_FAILED,(function(t){e._onPlayFailed(t),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.FPS_DROP,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,z.MEDIA_RECOVERED,(function(){return e._handleRecovered()})),this._eventManager.listen(this,W.PLAY,this._onPlay.bind(this)),this._eventManager.listen(this,W.PAUSE,this._onPause.bind(this)),this._eventManager.listen(this,W.PLAYING,this._onPlaying.bind(this)),this._eventManager.listen(this,W.ENDED,this._onEnded.bind(this)),this._eventManager.listen(this,z.MUTE_CHANGE,(function(){e._playbackAttributesState.muted=e.muted})),this._eventManager.listen(this,W.VOLUME_CHANGE,(function(){e._playbackAttributesState.volume=e.volume})),this._eventManager.listen(this,W.RATE_CHANGE,(function(){e._playbackAttributesState.rate=e.playbackRate})),this._eventManager.listen(this,z.ENTER_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this,z.EXIT_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this._resizeWatcher,z.RESIZE,(function(t){e._resetTextCuesAndReposition(),e.dispatchEvent(t)})),this._eventManager.listen(this._externalCaptionsHandler,z.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._externalCaptionsHandler,z.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._externalCaptionsHandler,W.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._externalThumbnailsHandler,W.ERROR,(function(t){return e.dispatchEvent(t)}));var t=j.getElementBySelector("#"+this.config.targetId);t&&this._eventManager.listen(t,"click",(function(){e._hasUserInteracted=!0,e.dispatchEvent(new v(z.USER_GESTURE))}),{capture:!0})}},s._handleRecovered=function(){this._stateManager.currentState.type===Z.PLAYING&&this.play()},s._onTextTrackChanged=function(e){var t=this;this.ready().then((function(){return t._playbackAttributesState.textLanguage=e.payload.selectedTextTrack.language})),this._markActiveTrack(e.payload.selectedTextTrack),this.dispatchEvent(e)},s._resetTextCuesAndReposition=function(){this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay([]);for(var e=0;e<this._activeTextCues.length;e++)this._activeTextCues[e].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)},s._removeTextCuePatch=function(){var e=this,t=this._activeTextCues.filter((function(t){var r=t._endTime,a=t._startTime,n=e.currentTime;if(n<r&&n>a)return t}));this._updateTextDisplay(t)},s._handlePlaybackOptions=function(){if(this._config.playback=this._config.playback||{},"boolean"==typeof this._playbackAttributesState.muted?this.muted=this._playbackAttributesState.muted:"boolean"==typeof this._config.playback.muted&&(this.muted=this._config.playback.muted),"number"==typeof this._playbackAttributesState.volume?this.volume=this._playbackAttributesState.volume:"number"==typeof this._config.playback.volume&&(this.volume=this._config.playback.volume),"boolean"==typeof this._config.playback.playsinline&&(this.playsinline=this._config.playback.playsinline),"string"==typeof this._config.playback.crossOrigin&&(this.crossOrigin=this._config.playback.crossOrigin),Array.isArray(this._config.playback.playbackRates)){var e=this._config.playback.playbackRates.filter((function(e,t,r){return e>0&&e<=16&&r.indexOf(e)===t})).sort((function(e,t){return e-t}));e&&(this._playbackRates=e)}},s._handlePreload=function(){"auto"!==this._config.playback.preload||this._config.playback.autoplay||this.load()},s._autoPlay=function(){var e=this,t=this._config.playback.allowMutedAutoPlay;a.getCapabilities(this.engineType).then((function(a){a.autoplay?r():a.mutedAutoPlay?e.muted&&!e._fallbackToMutedAutoPlay?n():t?i():o():o()}));var r=function(){a._logger.debug("Start autoplay"),e._fallbackToMutedAutoPlay&&(e._fallbackToMutedAutoPlay=!1,e.muted=!1),e.play()},n=function(){a._logger.debug("Start muted autoplay"),e.play()},i=function(){a._logger.debug("Fallback to muted autoplay"),e._fallbackToMutedAutoPlay=!0,e.muted=!0,e.dispatchEvent(new v(z.FALLBACK_TO_MUTED_AUTOPLAY)),e.play()},o=function(){a._logger.warn("Autoplay failed, pause player"),e._posterManager.show(),e.load(),e.dispatchEvent(new v(z.AUTOPLAY_FAILED))}},s._handleAutoPlay=function(){(this.isAudio()||this._config.playback.autoplay!==mr.TRUE)&&this._posterManager.show(),this._config.playback.autoplay===mr.TRUE&&this._autoPlay()},s._playAfterAsyncMiddleware=function(){var e=this;this._engine?this._play():this._eventManager.listenOnce(this,z.SOURCE_SELECTED,(function(){return e._play()}))},s._load=function(){var e=this;if(this._engine&&!this.src&&!this._loading){this._loading=!0;var t=this._sources.startTime;this._engine.load(t).then((function(r){e.isLive()&&(-1===t||Number(t)>=Number(e.duration))&&(e._isOnLiveEdge=!0),e._updateTracks(r.tracks),e.dispatchEvent(new v(z.TRACKS_CHANGED,{tracks:e._tracks})),e._externalThumbnailsHandler.load(e.sources.thumbnails)})).finally((function(){e._loading=!1,e._reset=!1}))}},s._handleDimensions=function(){var e=this.config.dimensions;F.isObject(e)&&!F.isEmptyObject(e)&&(this.dimensions=e)},s._play=function(){var e=this;this._shouldLoadAfterAttach&&(this._load(),this._shouldLoadAfterAttach=!1),this.ready().then((function(){e._shouldPlayerSeekToLiveEdge()&&e.seekToLiveEdge(),e._engine.play()}))},s._shouldPlayerSeekToLiveEdge=function(){if(this.isLive()){var e=!this.isDvr()||"number"==typeof this.currentTime&&this.currentTime<0;return this._firstPlay?!!this.src&&!this.isOnLiveEdge():e}return!1},s._pause=function(){this._engine.pause()},s._setCurrentTime=function(e){if(this._engine&&N.isNumber(e)){var t=e;e<0&&(t=0);var r=this.isLive()?this._engine.duration:this._engine.duration-.1;t>r&&(t=r),this._engine.currentTime=t}},s._onPause=function(){this._isOnLiveEdge=!1},s._onPlay=function(){this._firstPlay&&(this._firstPlay=!1,this.dispatchEvent(new v(z.FIRST_PLAY)),this.hideBlackCover(),"number"==typeof this._playbackAttributesState.rate&&(this.playbackRate=this._playbackAttributesState.rate))},s._onPlaying=function(){this._firstPlaying||(this._firstPlaying=!0,this.isAudio()||this._posterManager.hide(),this.dispatchEvent(new v(z.FIRST_PLAYING))),this._engine&&this._pendingSelectedVideoTrack&&(this._engine.selectVideoTrack(this._pendingSelectedVideoTrack),this._pendingSelectedVideoTrack=null)},s._onPlayFailed=function(e){this._firstPlay&&this._config.playback.autoplay&&(this._posterManager.show(),this.dispatchEvent(new v(z.AUTOPLAY_FAILED,e.payload)))},s._onEnded=function(){this.paused||this._pause()},s._resetStateFlags=function(){this._loading=!1,this._firstPlay=!0,this._loadingMedia=!1,this._playbackStart=!1,this._firstPlaying=!1},s._calcRatio=function(e,t){if(void 0!==t.ratio&&(this._aspectRatio=t.ratio),this._aspectRatio){var r=this._aspectRatio.split(":").map((function(e){return Number(e)})),a=r[0],n=r[1];if(t.width||!t.width&&!t.height){var i=n/a*e.clientWidth;e.style.height=i+"px"}else if(t.height&&!t.width){var o=a/n*e.clientHeight;e.style.width=o+"px"}}},s._onTracksChanged=function(e){this._updateTracks(e.payload.tracks),this.dispatchEvent(e)},s._updateTracks=function(e){a._logger.debug("Tracks changed",e),this._tracks=e.concat(this._externalCaptionsHandler.getExternalTracks(e)),this._applyABRRestriction(this._config),this._addTextTrackOffOption(),this._maybeSetTracksLabels(),this._setDefaultTracks()},s._getTracksByType=function(e){return this._tracks.reduce((function(t,r){return r instanceof e&&r.available&&t.push(r),t}),[])},s._getImageTracks=function(){return this._getTracksByType(dt)},s._getTextTracks=function(){return this._getTracksByType(Xe)},s._getVideoTracks=function(){return this._getTracksByType(ie)},s._getAudioTracks=function(){return this._getTracksByType(oe)},s._markActiveTrack=function(e){var t;if(e instanceof ie?t=this._getVideoTracks():e instanceof oe?t=this._getAudioTracks():e instanceof Xe&&(t=this._getTextTracks()),t)for(var r=0;r<t.length;r++)t[r].active=e.index===t[r].index},s._onCueChange=function(e){a._logger.debug("Text cue changed",e.payload.cues);try{this._activeTextCues=e.payload.cues.filter((function(e,t,r){var a=r[t-1];return!a||!(e.startTime===a.startTime&&e.endTime===a.endTime&&e.text.trim()===a.text.trim())}))}catch(t){this._activeTextCues=e.payload.cues}this._updateCueDisplaySettings(),this._updateTextDisplay(this._activeTextCues),this.dispatchEvent(e)},s._updateCueDisplaySettings=function(){for(var e=this._activeTextCues,t=this._textDisplaySettings,r=0;r<e.length;r++){var a=e[r];for(var n in t)t[n]&&(a[n]=t[n])}},s._updateTextDisplay=function(e){this._config.text.useNativeTextTrack||this._config.text.useShakaTextTrackDisplay||function(e,t,r,a){if(!e||!t||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var n=e.document.createElement("div");if(n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.margin="1.5%",r.appendChild(n),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var i=[],o=xe.getSimpleBoxPosition(n),s=o.height<o.width?o.height:o.width,l={font:Math.round(.058*s*100)/100*1*a.implicitFontScale+"px "+a.fontFamily,color:ye.toRGBA(a.fontColor,a.fontOpacity),backgroundColor:ye.toRGBA(a.backgroundColor,a.backgroundOpacity),textShadow:a.getTextShadow()};!function(){for(var r,a,s=0;s<t.length;s++)a=t[s],r=new we(e,a,l),n.appendChild(r.div),Ie(0,r,o,i),a.displayState=r.div,i.push(xe.getSimpleBoxPosition(r))}()}else for(var u=0;u<t.length;u++)n.appendChild(t[u].displayState)}(window,e,this._textDisplayEl,this._textStyle)},s._addTextTrackOffOption=function(){var e=this._getTextTracks();e&&e.length&&this._tracks.push(new Xe({active:!1,kind:Xe.KIND.SUBTITLES,label:"Off",language:Rr}))},s._setDefaultTracks=function(){var e=this.getActiveTracks(),t=this._getTextTracks().find((function(e){return e.default})),r=this.config.playback,a=this._getTextTracks().find((function(e){return Xe.langComparer(Rr,e.language)})),n=this._getLanguage(this._getTextTracks(),r.textLanguage,t),i=this._playbackAttributesState.textLanguage&&this._playbackAttributesState.textLanguage!==Rr?this._playbackAttributesState.textLanguage:n,o=this._playbackAttributesState.audioLanguage||this._getLanguage(this._getAudioTracks(),r.audioLanguage,e.audio);i===r.textLanguage?this._setDefaultTrack(this._getTextTracks(),i,a,r.additionalTextLanguage):this._setDefaultTrack(this._getTextTracks(),i,a),o===r.audioLanguage?this._setDefaultTrack(this._getAudioTracks(),o,e.audio,r.additionalAudioLanguage):this._setDefaultTrack(this._getAudioTracks(),o,e.audio),this._setDefaultVideoTrack()},s._getLanguage=function(e,t,r){var a=t;if("auto"===a){var n=e.find((function(e){return ae.langComparer(X.language,e.language)}));n?a=n.language:r&&r.language!==Rr?a=r.language:e&&e.length>0&&(a=e[0].language)}return a},s._setDefaultTrack=function(e,t,r,a){var n=this,i=function(e){n.selectTrack(e),n._markActiveTrack(e)},o=e.find((function(e){return ae.langComparer(t,e.language,a,!0)}));if(o)i(o);else{var s=e.find((function(e){return ae.langComparer(t,e.language,a,!1)}));s?i(s):r&&!r.active&&this.selectTrack(r)}},s._setDefaultVideoTrack=function(){var e=this,t=this._getVideoTracks().sort((function(e,t){return t.bandwidth-e.bandwidth})),r=t.find((function(t){var r;return t.label&&t.label===(null==(r=e._playbackAttributesState.videoTrack)?void 0:r.label)}));r||(r=t.find((function(t){var r;return t.height&&t.height===(null==(r=e._playbackAttributesState.videoTrack)?void 0:r.height)}))),r&&this.selectTrack(r)},s._maybeSetTracksLabels=function(){var e=this._config.customLabels;if(e)for(var t in e){if(!Object.prototype.hasOwnProperty.call(e,t))return;switch(t){case"qualities":this._setTracksCustomLabels(this._getVideoTracks(),e[t]);break;case"audio":this._setTracksCustomLabels(this._getAudioTracks(),e[t]);break;case"captions":this._setTracksCustomLabels(this._getTextTracks(),e[t])}}},s._setTracksCustomLabels=function(e,t){e.forEach((function(e){var r=t(F.copyDeep(e));r&&(e.label=r)}))},n=a,o=[{key:"_defaultConfig",get:function(){return F.copyDeep(st)}}],(i=[{key:"videoHeight",get:function(){return this._engine?this._engine.videoHeight:null}},{key:"videoWidth",get:function(){return this._engine?this._engine.videoWidth:null}},{key:"buffered",get:function(){return this._engine?this._engine.buffered:null}},{key:"stats",get:function(){var e={targetBuffer:NaN,availableBuffer:NaN};return this._engine&&(e.targetBuffer=this._engine.targetBuffer,e.availableBuffer=this._engine.availableBuffer),e}},{key:"currentTime",set:function(e){this._playbackMiddleware.setCurrentTime(e,this._setCurrentTime.bind(this))},get:function(){return this._engine?this._engine.currentTime:null}},{key:"duration",get:function(){return this._engine?this._engine.duration:null}},{key:"liveDuration",get:function(){return this._engine?this._engine.liveDuration:null}},{key:"volume",set:function(e){if(this._engine&&(N.isFloat(e)||0===e||1===e)){var t=e;t<0&&(t=0),t>1&&(t=1),this._engine.volume=t}},get:function(){return this._engine?this._engine.volume:null}},{key:"paused",get:function(){return this._engine?this._engine.paused:null}},{key:"seeking",get:function(){return this._engine?this._engine.seeking:null}},{key:"playsinline",set:function(e){this._engine&&(this._engine.playsinline=e)},get:function(){return this._engine?this._engine.playsinline:null}},{key:"muted",set:function(e){this._engine&&(this._engine.muted=e,this.dispatchEvent(new v(z.MUTE_CHANGE,{mute:e})),!1===e&&(this._fallbackToMutedAutoPlay=e))},get:function(){return this._engine?this._engine.muted:null}},{key:"src",get:function(){return this._engine?this._engine.src:null}},{key:"dimensions",set:function(e){var t=this._getTargetElement();if(!e||F.isEmptyObject(e))this._aspectRatio=null,t.style.width=null,t.style.height=null;else{var r=F.mergeDeep(this.dimensions,e),a=r.height,n=r.width;t.style.width="number"==typeof n?n+"px":n,t.style.height="number"==typeof a?a+"px":a,this._calcRatio(t,e)}},get:function(){return{width:this._el.clientWidth,height:this._el.clientHeight}}},{key:"poster",get:function(){return this._posterManager.src}},{key:"playbackRate",set:function(e){this._engine&&(this._engine.playbackRate=e)},get:function(){return this._engine?this._engine.playbackRate:null}},{key:"playbackRates",get:function(){return this._playbackRates?this._playbackRates:this._engine?this._engine.playbackRates:[]}},{key:"defaultPlaybackRate",get:function(){return this._engine?this._engine.defaultPlaybackRate:1}},{key:"engineType",get:function(){return this._engineType}},{key:"streamType",get:function(){return this._streamType}},{key:"env",get:function(){return this._env}},{key:"config",get:function(){return F.mergeDeep({},this._config)}},{key:"sources",get:function(){return F.mergeDeep({},this._sources)}},{key:"hasUserInteracted",get:function(){return this._hasUserInteracted}},{key:"loadingMedia",set:function(e){this._loadingMedia=e}},{key:"crossOrigin",set:function(e){this._engine&&(this._engine.crossOrigin=e)},get:function(){return this._engine?this._engine.crossOrigin:null}},{key:"ended",get:function(){return this._engine?this._engine.ended:null}},{key:"playbackMiddleware",get:function(){return this._playbackMiddleware}},{key:"posterManager",get:function(){return this._posterManager}},{key:"textDisplaySetting",get:function(){return F.copyDeep(this._textDisplaySettings)}},{key:"textStyle",set:function(e){if(!(e instanceof ye))throw new Error("Style must be instance of TextStyle");var t=j.getElementBySelector("."+this._playerId+".playkit-subtitles-style");t||(t=j.createElement("style"),j.addClassName(t,this._playerId),j.addClassName(t,"playkit-subtitles-style"),j.appendChild(document.head,t));for(var r=t.sheet;r.cssRules.length;)r.deleteRule(0);try{this._textStyle=e,this._config.text.useNativeTextTrack?r.insertRule("#"+this._playerId+" video.playkit-engine::cue { "+e.toCSS()+" }",0):this._engine&&(this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay(this._activeTextCues)),this.dispatchEvent(new v(z.TEXT_STYLE_CHANGED))}catch(e){a._logger.error(e.message)}},get:function(){return this._textStyle.clone()}},{key:"Event",get:function(){return q}},{key:"TextStyle",get:function(){return ye}},{key:"State",get:function(){return Z}},{key:"Track",get:function(){return Qe}},{key:"LogLevelType",get:function(){return E}},{key:"LogLevel",get:function(){return k}},{key:"AbrMode",get:function(){return tt}},{key:"MediaType",get:function(){return et}},{key:"StreamType",get:function(){return Je}},{key:"EngineType",get:function(){return Ze}},{key:"CorsType",get:function(){return rt}},{key:"AdBreakType",get:function(){return ir}},{key:"AdTagType",get:function(){return or}},{key:"Error",get:function(){return O}}])&&Ir(n.prototype,i),o&&Ir(n,o),a}(P);Dr(Or,"_logger",C("Player"));var Lr=function(){function e(e){this._name=e.getName(),this._getEngineDecorator=e.getEngineDecorator.bind(e)}var t=e.prototype;return t.getEngineDecorator=function(e,t){return this._getEngineDecorator(e,t)},t.getName=function(){return this._name},e}(),Nr={HLS:["application/x-mpegurl","application/vnd.apple.mpegurl"],DASH:["application/dash+xml"],PROGRESSIVE:["video/mp4"],SMOOTH_STREAMING:["application/vnd.ms-sstr+xml"]},Ur="0.82.1",Fr="@playkit-js/playkit-js";function Br(e){return new Or(e||{})}var jr=Or.getCapabilities,Vr=Or.setCapabilities;t.default=Br}])},function(e,t,r){var a=r(2),n=r(8),i=r(16),o=r(12),s=r(19),l=function(e,t,r){var u,c,d,p,h=e&l.F,f=e&l.G,g=e&l.S,y=e&l.P,m=e&l.B,v=f?a:g?a[t]||(a[t]={}):(a[t]||{}).prototype,_=f?n:n[t]||(n[t]={}),k=_.prototype||(_.prototype={});for(u in f&&(r=t),r)d=((c=!h&&v&&void 0!==v[u])?v:r)[u],p=m&&c?s(d,a):y&&"function"==typeof d?s(Function.call,d):d,v&&o(v,u,d,e&l.U),_[u]!=d&&i(_,u,p),y&&k[u]!=d&&(k[u]=d)};a.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){var a=r(5);e.exports=function(e){if(!a(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){var a=r(51)("wks"),n=r(31),i=r(2).Symbol,o="function"==typeof i;(e.exports=function(e){return a[e]||(a[e]=o&&i[e]||(o?i:n)("Symbol."+e))}).store=a},function(e,t,r){var a=r(21),n=Math.min;e.exports=function(e){return e>0?n(a(e),9007199254740991):0}},function(e,t){var r=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=r)},function(e,t,r){e.exports=!r(3)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,r){var a=r(4),n=r(93),i=r(28),o=Object.defineProperty;t.f=r(9)?Object.defineProperty:function(e,t,r){if(a(e),t=i(t,!0),a(r),n)try{return o(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var a=r(26);e.exports=function(e){return Object(a(e))}},function(e,t,r){var a=r(2),n=r(16),i=r(15),o=r(31)("src"),s=r(130),l=(""+s).split("toString");r(8).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,r,s){var u="function"==typeof r;u&&(i(r,"name")||n(r,"name",t)),e[t]!==r&&(u&&(i(r,o)||n(r,o,e[t]?""+e[t]:l.join(String(t)))),e===a?e[t]=r:s?e[t]?e[t]=r:n(e,t,r):(delete e[t],n(e,t,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[o]||s.call(this)}))},function(e,t,r){var a=r(1),n=r(3),i=r(26),o=/"/g,s=function(e,t,r,a){var n=String(i(e)),s="<"+t;return""!==r&&(s+=" "+r+'="'+String(a).replace(o,"&quot;")+'"'),s+">"+n+"</"+t+">"};e.exports=function(e,t){var r={};r[e]=t(s),a(a.P+a.F*n((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",r)}},function(e,t,r){window,e.exports=function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=16)}([function(e,t,r){var a=r(13),n=r(14);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]),a(n,{attributes:{id:"@playkit-js/playkit-js-ui"},insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,r){"use strict";e.exports=r(10)},function(e,t,r){"use strict";var a=r(1),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return a.isMemo(e)?o:s[e.$$typeof]||n}s[a.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[a.Memo]=o;var u=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,r,a){if("string"!=typeof r){if(f){var n=h(r);n&&n!==f&&e(t,n,a)}var o=c(r);d&&(o=o.concat(d(r)));for(var s=l(t),g=l(r),y=0;y<o.length;++y){var m=o[y];if(!(i[m]||a&&a[m]||g&&g[m]||s&&s[m])){var v=p(r,m);try{u(t,m,v)}catch(e){}}}}return t}},function(e,t,r){"use strict";(function(e,a){var n,i=r(5);n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:a;var o=Object(i.a)(n);t.a=o}).call(this,r(11),r(12)(e))},function(e,t,r){e.exports=function(e,t,r,a,n){for(t=t.split?t.split("."):t,a=0;a<t.length;a++)e=e?e[t[a]]:n;return e===n?r:e}},function(e,t,r){"use strict";function a(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",(function(){return a}))},function(e){e.exports=JSON.parse('{"en":{"controls":{"play":"Play","pause":"Pause","language":"Language","settings":"Settings","fullscreen":"Fullscreen","fullscreenExit":"Exit fullscreen","rewind":"Seek backwards","forward":"Seek forward","vrStereo":"vrStereo","closedCaptionsOn":"Disable Captions","closedCaptionsOff":"Enable Captions","live":"Live","mute":"Mute","unmute":"Unmute","next":"Next","prev":"Prev","startOver":"Start over","pictureInPicture":"Picture in picture","pictureInPictureExit":"Exit picture in picture","pictureInPictureExpand":"Expand","logo":"Logo","seekBarSlider":"Seek slider"},"unmute":{"unmute":"Unmute"},"volume":{"muted":"Muted. Click to unmute","unmuted":"{{vol}}% volume. Click to mute"},"copy":{"button":"Copy URL"},"settings":{"title":"Settings","quality":"Quality","speed":"Speed","speedNormal":"Normal","qualityAuto":"Auto"},"language":{"title":"Language","audio":"Audio","captions":"Captions","advanced_captions_settings":"Advanced captions settings"},"overlay":{"close":"Close"},"error":{"default_error":"Something went wrong","default_session_text":"Session ID","retry":"Retry"},"ads":{"ad_notice":"Advertisement","learn_more":"Learn more","skip_ad":"Skip ad","skip_in":"Skip in"},"cvaa":{"title":"Advanced captions settings","sample_caption_tag":"Sample {{number}}","sample_custom_caption_tag":"Custom captions","set_custom_caption":"Set custom caption","edit_caption":"Edit caption","size_label":"Size","font_color_label":"Font color","font_family_label":"Font family","font_style_label":"Font style","font_opacity_label":"Font opacity","background_color_label":"Background color","background_opacity_label":"Background opacity","apply":"Apply","caption_preview":"This is your caption preview"},"cast":{"play_on_tv":"Play on TV","disconnect_from_tv":"Disconnect from TV","status":{"connecting_to":"Connecting to","connected_to":"Connected to","playing_on":"Playing on"}},"playlist":{"prev":"Previous","next":"Next","up_next":"Up Next","up_next_in":"Up next in","cancel":"Cancel"},"pictureInPicture":{"overlay_text":"Playing in Picture In Picture mode"}}}')},function(e,t,r){e.exports=r(8)()},function(e,t,r){"use strict";var a=r(9);function n(){}function i(){}i.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,i,o){if(o!==a){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:n};return r.PropTypes=r,r}},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a="function"==typeof Symbol&&Symbol.for,n=a?Symbol.for("react.element"):60103,i=a?Symbol.for("react.portal"):60106,o=a?Symbol.for("react.fragment"):60107,s=a?Symbol.for("react.strict_mode"):60108,l=a?Symbol.for("react.profiler"):60114,u=a?Symbol.for("react.provider"):60109,c=a?Symbol.for("react.context"):60110,d=a?Symbol.for("react.async_mode"):60111,p=a?Symbol.for("react.concurrent_mode"):60111,h=a?Symbol.for("react.forward_ref"):60112,f=a?Symbol.for("react.suspense"):60113,g=a?Symbol.for("react.suspense_list"):60120,y=a?Symbol.for("react.memo"):60115,m=a?Symbol.for("react.lazy"):60116,v=a?Symbol.for("react.block"):60121,_=a?Symbol.for("react.fundamental"):60117,k=a?Symbol.for("react.responder"):60118,E=a?Symbol.for("react.scope"):60119;function T(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case d:case p:case o:case l:case s:case f:return e;default:switch(e=e&&e.$$typeof){case c:case h:case m:case y:case u:return e;default:return t}}case i:return t}}}function b(e){return T(e)===p}t.AsyncMode=d,t.ConcurrentMode=p,t.ContextConsumer=c,t.ContextProvider=u,t.Element=n,t.ForwardRef=h,t.Fragment=o,t.Lazy=m,t.Memo=y,t.Portal=i,t.Profiler=l,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return b(e)||T(e)===d},t.isConcurrentMode=b,t.isContextConsumer=function(e){return T(e)===c},t.isContextProvider=function(e){return T(e)===u},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return T(e)===h},t.isFragment=function(e){return T(e)===o},t.isLazy=function(e){return T(e)===m},t.isMemo=function(e){return T(e)===y},t.isPortal=function(e){return T(e)===i},t.isProfiler=function(e){return T(e)===l},t.isStrictMode=function(e){return T(e)===s},t.isSuspense=function(e){return T(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===p||e===l||e===s||e===f||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===y||e.$$typeof===u||e.$$typeof===c||e.$$typeof===h||e.$$typeof===_||e.$$typeof===k||e.$$typeof===E||e.$$typeof===v)},t.typeOf=T},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";var a,n=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),i=[];function o(e){for(var t=-1,r=0;r<i.length;r++)if(i[r].identifier===e){t=r;break}return t}function s(e,t){for(var r={},a=[],n=0;n<e.length;n++){var s=e[n],l=t.base?s[0]+t.base:s[0],u=r[l]||0,c="".concat(l," ").concat(u);r[l]=u+1;var d=o(c),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(i[d].references++,i[d].updater(p)):i.push({identifier:c,updater:g(p,t),references:1}),a.push(c)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var i=r.nc;i&&(a.nonce=i)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=n(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,r,a){var n=r?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,n);else{var i=document.createTextNode(n),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function p(e,t,r){var a=r.css,n=r.media,i=r.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),i&&btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var h=null,f=0;function g(e,t){var r,a,n;if(t.singleton){var i=f++;r=h||(h=l(t)),a=d.bind(null,r,i,!1),n=d.bind(null,r,i,!0)}else r=l(t),a=p.bind(null,r,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var r=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<r.length;a++){var n=o(r[a]);i[n].references--}for(var l=s(e,t),u=0;u<r.length;u++){var c=o(r[u]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}r=l}}}},function(e,t,r){(t=r(15)(!1)).push([e.i,".playkit-player{--playkit-primary-hsl-hue: 215deg;--playkit-secondary-hsl-hue: 40deg;--playkit-success-hsl-hue: 136deg;--playkit-danger-hsl-hue: 355deg;--playkit-warning-hsl-hue: 21deg;--playkit-primary-hsl-saturation: 100%;--playkit-secondary-hsl-saturation: 100%;--playkit-success-hsl-saturation: 100%;--playkit-danger-hsl-saturation: 100%;--playkit-warning-hsl-saturation: 100%;--playkit-primary-hsl-lightness: 50%;--playkit-secondary-hsl-lightness: 50%;--playkit-success-hsl-lightness: 50%;--playkit-danger-hsl-lightness: 50%;--playkit-warning-hsl-lightness: 50%;--playkit-primary-color: hsl(var(--playkit-primary-hsl-hue) var(--playkit-primary-hsl-saturation) var(--playkit-primary-hsl-lightness));--playkit-primary-darker-color: hsl(var(--playkit-primary-hsl-hue) var(--playkit-primary-hsl-saturation) calc(var(--playkit-primary-hsl-lightness) - 15%));--playkit-primary-brighter-color: hsl(var(--playkit-primary-hsl-hue) var(--playkit-primary-hsl-saturation) calc(var(--playkit-primary-hsl-lightness) + 15%));--playkit-primary-text-contrast-color: #ffffff;--playkit-secondary-color: hsl(var(--playkit-secondary-hsl-hue) var(--playkit-secondary-hsl-saturation) var(--playkit-secondary-hsl-lightness));--playkit-secondary-darker-color: hsl(var(--playkit-secondary-hsl-hue) var(--playkit-secondary-hsl-saturation) calc(var(--playkit-secondary-hsl-lightness) - 15%));--playkit-secondary-brighter-color: hsl(var(--playkit-secondary-hsl-hue) var(--playkit-secondary-hsl-saturation) calc(var(--playkit-secondary-hsl-lightness) + 15%));--playkit-secondary-text-contrast-color: #ffffff;--playkit-success-color: hsl(var(--playkit-success-hsl-hue) var(--playkit-success-hsl-saturation) var(--playkit-success-hsl-lightness));--playkit-success-darker-color: hsl(var(--playkit-success-hsl-hue) var(--playkit-success-hsl-saturation) calc(var(--playkit-success-hsl-lightness) - 15%));--playkit-success-brighter-color: hsl(var(--playkit-success-hsl-hue) var(--playkit-success-hsl-saturation) calc(var(--playkit-success-hsl-lightness) + 15%));--playkit-success-text-contrast-color: #ffffff;--playkit-danger-color: hsl(var(--playkit-danger-hsl-hue) var(--playkit-danger-hsl-saturation) var(--playkit-danger-hsl-lightness));--playkit-danger-darker-color: hsl(var(--playkit-danger-hsl-hue) var(--playkit-danger-hsl-saturation) calc(var(--playkit-danger-hsl-lightness) - 15%));--playkit-danger-brighter-color: hsl(var(--playkit-danger-hsl-hue) var(--playkit-danger-hsl-saturation) calc(var(--playkit-danger-hsl-lightness) + 15%));--playkit-danger-text-contrast-color: #ffffff;--playkit-warning-color: hsl(var(--playkit-warning-hsl-hue) var(--playkit-warning-hsl-saturation) var(--playkit-warning-hsl-lightness));--playkit-warning-darker-color: hsl(var(--playkit-warning-hsl-hue) var(--playkit-warning-hsl-saturation) calc(var(--playkit-warning-hsl-lightness) - 15%));--playkit-warning-brighter-color: hsl(var(--playkit-warning-hsl-hue) var(--playkit-warning-hsl-saturation) calc(var(--playkit-warning-hsl-lightness) + 15%));--playkit-warning-text-contrast-color: #ffffff;--playkit-tone-1-color: #ffffff;--playkit-tone-2-color: #cccccc;--playkit-tone-3-color: #999999;--playkit-tone-4-color: #888888;--playkit-tone-5-color: #666666;--playkit-tone-6-color: #444444;--playkit-tone-7-color: #222222;--playkit-tone-8-color: #000000;--playkit-live-color: #e12536;--playkit-player-background-color: #000000;--playkit-tab-focus-color: var(--playkit-primary-color);--playkit-tooltip-background-color: var(--playkit-tone-1-color);--playkit-tooltip-color: var(--playkit-tone-7-color);--playkit-ads-color: var(--playkit-secondary-color)}.playkit-row{display:block}.playkit-row:after{content:'';clear:both;display:block}.playkit-d-inline-block{display:inline-block}.playkit-mobile-hidden-select{display:block;opacity:0;position:absolute;top:0;left:0px;width:100%;height:100%}.playkit-font-size-base,.playkit-ad-notice{font-size:15px}.playkit-player .playkit-form-group{margin:10px 0;position:relative;max-width:100%}.playkit-player .playkit-form-group.playkit-has-error .playkit-form-control{border-color:var(--playkit-danger-color)}.playkit-player .playkit-form-group.playkit-has-error .playkit-form-control:focus{border-color:#fff}.playkit-player .playkit-form-group.playkit-has-icon .playkit-form-control{padding-left:34px}.playkit-player .playkit-form-group .playkit-icon{position:absolute;top:2px;left:2px;width:32px;height:32px;fill:rgba(255,255,255,0.4)}.playkit-player .playkit-form-control{height:32px;width:100%;min-width:72px;border:2px solid rgba(255,255,255,0.2);border-radius:4px;background-color:rgba(0,0,0,0.4);font-size:15px;line-height:18px;color:#fff;padding:8px 10px;text-overflow:ellipsis}.playkit-player .playkit-form-control::-webkit-input-placeholder{color:rgba(255,255,255,0.6)}.playkit-player .playkit-form-control:focus{background-color:#fff;border-color:#fff;color:var(--playkit-tone-7-color)}.playkit-player .playkit-form-control:focus::-webkit-input-placeholder{color:var(--playkit-tone-2-color)}.playkit-player .playkit-form-control:focus+.playkit-icon{fill:var(--playkit-tone-3-color)}.playkit-player textarea.playkit-form-control{min-height:72px}.playkit-player select{font-size:15px;color:#fff;-webkit-appearance:none;border:0;background:url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23FFFFFF' viewBox='0 0 1024 1024'><path d='M301.255 338.745c-24.994-24.994-65.516-24.994-90.51 0s-24.994 65.516 0 90.51l256 256c24.994 24.994 65.516 24.994 90.51 0l256-256c24.994-24.994 24.994-65.516 0-90.51s-65.516-24.994-90.51 0l-210.745 210.745-210.745-210.745z' /></svg>\") no-repeat;background-size:16px;background-position:100% center;background-repeat:no-repeat;padding-right:24px}.playkit-checkbox{font-size:15px;position:relative}.playkit-checkbox input{display:none}.playkit-checkbox label:before{height:16px;width:16px;border:1px solid rgba(255,255,255,0.2);border-radius:4px;background-color:rgba(0,0,0,0.4);margin-right:8px;display:inline-block;content:'';vertical-align:middle}.playkit-checkbox input:checked+label:before{content:'✔';text-align:center;font-size:14px}.playkit-form-group-row{font-size:15px;margin:24px 0}.playkit-form-group-row:after{clear:both;content:' ';display:block}.playkit-form-group-row label{float:left;color:rgba(244,244,244,0.8)}.playkit-form-group-row .playkit-dropdown{float:right}.playkit-btn{text-decoration:none;height:36px;border-radius:18px;color:#fff;line-height:36px;font-weight:bold;cursor:pointer;display:inline-block;padding:0 24px}.playkit-btn.playkit-btn-block{display:block}.playkit-btn.playkit-btn-dark-transparent{background-color:rgba(0,0,0,0.5);border:2px solid rgba(255,255,255,0.2);line-height:32px}.playkit-btn.playkit-btn-dark-transparent:hover{color:#fff;border:2px solid rgba(255,255,255,0.4)}.playkit-btn.playkit-btn-branded{background-color:var(--playkit-primary-color)}.playkit-btn.playkit-btn-branded:hover{color:#fff}.playkit-btn-rounded{height:36px;width:36px;min-width:36px;min-height:36px;border-radius:18px;background-color:rgba(0,0,0,0.4);display:inline-block;padding:2px}.playkit-player button:focus{outline:none}.playkit-btn-borderless{display:flex;flex-direction:row;justify-content:center;align-items:center;border-radius:4px;border:none;padding:8px 12px 8px 8px;width:82px;height:40px;background-color:transparent;cursor:pointer}.playkit-btn-borderless.playkit-only-icon{padding:4px;width:40px;height:40px}.playkit-btn-borderless.playkit-only-label{padding:8px;width:50px;height:40px}.playkit-btn-borderless i{width:32px;height:32px}.playkit-btn-borderless label{color:var(--playkit-tone-1-color)}.playkit-btn-borderless:hover{background-color:var(--playkit-tone-4-color)}.playkit-player.playkit-size-sm .playkit-btn-borderless,.playkit-player.playkit-size-xs .playkit-btn-borderless{height:32px}.playkit-player.playkit-size-sm .playkit-btn-borderless i,.playkit-player.playkit-size-xs .playkit-btn-borderless i{width:24px;height:24px}.playkit-player.playkit-size-sm .playkit-btn-borderless.playkit-only-icon,.playkit-player.playkit-size-xs .playkit-btn-borderless.playkit-only-icon{padding:4px;width:32px;height:32px}.playkit-player.playkit-size-sm .playkit-btn-borderless.playkit-only-label,.playkit-player.playkit-size-xs .playkit-btn-borderless.playkit-only-label{padding:8px;width:50px;height:32px}.playkit-icon{display:inline-block;font-size:0;width:100%;height:100%;margin:0 auto;background-size:cover;background-repeat:no-repeat;background-position:50% 50%}.playkit-badge-icon:after{content:'';position:absolute;height:16px;width:16px;background-size:cover;background-repeat:no-repeat;background-position:50% 50%}.playkit-player{--playkit-icon-vr-stereo-full-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M864 255.996c53.019 0 96 42.981 96 96v384.004c0 53.019-42.981 96-96 96h-219.764c-33.721 0-64.97-17.693-82.319-46.608l-49.917-83.195-49.917 83.195c-17.349 28.916-48.598 46.608-82.319 46.608h-219.764c-53.019 0-96-42.981-96-96v-384.003c0-53.019 42.981-96 96-96h704zM304 624c44.183 0 80-35.817 80-80s-35.817-80-80-80c-44.183 0-80 35.817-80 80s35.817 80 80 80zM720 624c44.183 0 80-35.817 80-80s-35.817-80-80-80c-44.183 0-80 35.817-80 80s35.817 80 80 80z'%3E%3C/path%3E%3C/svg%3E\");--playkit-icon-chromecast-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M160 704v96h96c0-53.12-42.88-96-96-96zM160 576v64c88.32 0 160 71.68 160 160h64c0-123.84-100.16-224-224-224zM736 352h-448v52.16c126.72 40.96 226.88 141.12 267.84 267.84h180.16v-320zM160 448v64c159.040 0 288 128.96 288 288h64c0-194.56-157.76-352-352-352zM800 224h-576c-35.2 0-64 28.8-64 64v96h64v-96h576v448h-224v64h224c35.2 0 64-28.8 64-64v-448c0-35.2-28.8-64-64-64z'%3E%3C/path%3E%3C/svg%3E\");--playkit-icon-quality-HD-active-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M3.73939861,5 L2,5 L2,11 L3.73939861,11 L3.73918396,8.56940659 L5.96845644,8.56940659 L5.9691596,11 L7.69930609,11 L7.69930609,5 L5.9691596,5 L5.96845644,7.32457143 L3.73918396,7.32457143 L3.73939861,5 Z M10.849653,5 L8.65690054,5 L8.65690054,11 L10.8774094,11 L11.1387878,10.9921562 C11.5670397,10.9660102 11.9583976,10.8744992 12.3128614,10.7176232 L12.3128614,10.7176232 L12.4919044,10.6311813 L12.686671,10.5199596 C13.0639309,10.2858264 13.3675515,9.98155416 13.5975328,9.60714286 C13.827514,9.23273155 13.9589319,8.81088809 13.9917864,8.34161247 L13.9917864,8.34161247 L14,8.10302198 L14,7.9010989 L13.9917864,7.66145717 C13.9589319,7.19033135 13.827514,6.76815149 13.5975328,6.39491758 C13.3292213,5.95947802 12.9583655,5.61813187 12.4849653,5.37087912 C12.0791937,5.15894819 11.6207417,5.03784481 11.1096093,5.00756896 L11.1096093,5.00756896 L10.849653,5 Z M10.849653,6.24862637 C11.154973,6.24862637 11.4101773,6.30906593 11.615266,6.42994505 C11.8203547,6.55082418 11.9745567,6.73282967 12.077872,6.97596154 C12.1605243,7.17046703 12.2101157,7.40497253 12.2266461,7.67947802 L12.2266461,7.67947802 L12.232845,7.89285714 L12.232845,8.10302198 L12.2265536,8.31796703 C12.2097764,8.59445055 12.1594449,8.83049451 12.075559,9.0260989 C11.9707016,9.2706044 11.8180416,9.4532967 11.617579,9.57417582 C11.4572089,9.67087912 11.2672321,9.7289011 11.0476484,9.74824176 L11.0476484,9.74824176 L10.8774094,9.75549451 L10.3957366,9.75600879 L10.3957366,6.24937143 Z'%3E%3C/path%3E%3C/svg%3E\");--playkit-icon-quality-4K-active-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M6.52117789,5 L4.77853973,5 L4.7778117,5.01381978 L2,8.80769231 L2.10649455,9.76785714 L4.7778117,9.76866813 L4.77853973,11 L6.52117789,11 L6.52063574,9.76866813 L7.19402985,9.76785714 L7.19402985,8.5728022 L6.52063574,8.57362637 L6.52117789,5 Z M9.81282775,5 L7.99273901,5 L7.99273901,11 L9.81282775,11 L9.8119758,9.5061978 L10.4712352,8.88589011 L11.8313836,11 L13.9806374,11 L11.6856603,7.6629978 L14,5 L11.7587737,5 L10.3549818,6.78434066 L9.8119758,7.5229011 L9.81282775,5 Z M4.7778117,7.01905934 L4.7778117,8.57362637 L3.65066559,8.5728022 L4.69624849,7.13873626 L4.7778117,7.01905934 Z'%3E%3C/path%3E%3C/svg%3E\");--playkit-icon-quality-8K-active-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M4.5,5 C4.04427083,5 3.6389974,5.06279225 3.28417969,5.18837675 C2.92936198,5.31396126 2.65104167,5.499666 2.44921875,5.74549098 C2.24739583,5.99131597 2.14648438,6.29458918 2.14648438,6.65531062 C2.14648438,6.96259185 2.24820964,7.23112892 2.45166016,7.46092184 C2.58729384,7.61411712 2.75692636,7.74445187 2.96055773,7.85192607 L2.96055773,7.85192607 L3.07972656,7.90981323 L3.04817708,7.92134269 L2.87890625,8.000668 C2.71614583,8.08483634 2.57291667,8.18353373 2.44921875,8.29676019 L2.44921875,8.29676019 L2.33203125,8.41482966 L2.24394133,8.52320968 C2.08131378,8.74602266 2,9.00515316 2,9.3006012 C2,9.67735471 2.10986328,9.99131597 2.32958984,10.242485 C2.54931641,10.493654 2.84879557,10.6826987 3.22802734,10.8096192 C3.60725911,10.9365397 4.03613281,11 4.51464844,11 C4.99641927,11 5.42366536,10.9365397 5.79638672,10.8096192 C6.16910807,10.6826987 6.46289063,10.493654 6.67773438,10.242485 C6.89257813,9.99131597 7,9.67735471 7,9.3006012 C7,8.95591182 6.89176432,8.66065464 6.67529297,8.41482966 L6.67529297,8.41482966 L6.56041124,8.29676019 C6.3983742,8.14579158 6.20089157,8.02065242 5.96796332,7.92134269 L5.96796332,7.92134269 L5.94,7.911 L6.06141493,7.85192607 L6.20532227,7.76703407 C6.29701063,7.70758183 6.38019929,7.64241446 6.45488824,7.57153195 L6.45488824,7.57153195 L6.56054688,7.46092184 L6.65155707,7.3427967 C6.78945132,7.14054034 6.85839844,6.91137831 6.85839844,6.65531062 C6.85839844,6.29458918 6.75830078,5.99131597 6.55810547,5.74549098 C6.35791016,5.499666 6.08121745,5.31396126 5.72802734,5.18837675 C5.37483724,5.06279225 4.96549479,5 4.5,5 Z M9.8178888,5 L8,5 L8,11 L9.8178888,11 L9.81771088,9.5061978 L10.4751832,8.88673407 L11.8340048,11 L13.9806608,11 L11.6891307,7.6629978 L14,5 L11.7614827,5 L10.3593876,6.78434066 L9.81771088,7.5229011 L9.8178888,5 Z M4.50488281,8.51903808 C4.6546224,8.51903808 4.78401693,8.54375418 4.89306641,8.59318637 C5.00211589,8.64261857 5.0867513,8.71543086 5.14697266,8.81162325 C5.20719401,8.90781563 5.23730469,9.02805611 5.23730469,9.17234469 C5.23730469,9.30861723 5.20800781,9.4261857 5.14941406,9.5250501 C5.09082031,9.6239145 5.0069987,9.7007348 4.89794922,9.75551102 C4.78889974,9.81028724 4.66113281,9.83767535 4.51464844,9.83767535 C4.36490885,9.83767535 4.23388672,9.81028724 4.12158203,9.75551102 C4.00927734,9.7007348 3.92220052,9.6239145 3.86035156,9.5250501 C3.7985026,9.4261857 3.76757812,9.30861723 3.76757812,9.17234469 C3.76757812,9.02805611 3.7985026,8.90781563 3.86035156,8.81162325 C3.92220052,8.71543086 4.00846354,8.64261857 4.11914062,8.59318637 C4.22981771,8.54375418 4.35839844,8.51903808 4.50488281,8.51903808 Z M4.5,6.16232465 C4.63671875,6.16232465 4.74902344,6.18570474 4.83691406,6.23246493 C4.92480469,6.27922512 4.99072266,6.34535738 5.03466797,6.43086172 C5.07861328,6.51636607 5.10058594,6.62057448 5.10058594,6.74348697 C5.10058594,6.86372745 5.08024089,6.96993988 5.03955078,7.06212425 C4.99886068,7.15430862 4.93538411,7.22645291 4.84912109,7.27855711 C4.76285807,7.33066132 4.65136719,7.35671343 4.51464844,7.35671343 C4.37792969,7.35671343 4.2648112,7.33066132 4.17529297,7.27855711 C4.08577474,7.22645291 4.01985677,7.15430862 3.97753906,7.06212425 C3.93522135,6.96993988 3.9140625,6.86372745 3.9140625,6.74348697 C3.9140625,6.62057448 3.93522135,6.51636607 3.97753906,6.43086172 C4.01985677,6.34535738 4.08496094,6.27922512 4.17285156,6.23246493 C4.26074219,6.18570474 4.36979167,6.16232465 4.5,6.16232465 Z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-maximize{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M800 269.255v114.745c0 17.673 14.327 32 32 32s32-14.327 32-32v-192c0-17.673-14.327-32-32-32h-192c-17.673 0-32 14.327-32 32s14.327 32 32 32h114.745l-137.373 137.373c-12.497 12.497-12.497 32.758 0 45.255s32.758 12.497 45.255 0l137.373-137.373z' /%3E %3Cpath fill='%23fff' d='M224 754.745v-114.745c0-17.673-14.327-32-32-32s-32 14.327-32 32v192c0 17.673 14.327 32 32 32h192c17.673 0 32-14.327 32-32s-14.327-32-32-32h-114.745l137.373-137.373c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0l-137.373 137.373z' /%3E%3C/svg%3E\")}.playkit-icon-minimize{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M672 306.745v-114.745c0-17.673-14.327-32-32-32s-32 14.327-32 32v192c0 17.673 14.327 32 32 32h192c17.673 0 32-14.327 32-32s-14.327-32-32-32h-114.745l137.373-137.373c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0l-137.373 137.373z' /%3E%3Cpath fill='%23fff' d='M352 717.255v114.745c0 17.673 14.327 32 32 32s32-14.327 32-32v-192c0-17.673-14.327-32-32-32h-192c-17.673 0-32 14.327-32 32s14.327 32 32 32h114.745l-137.373 137.373c-12.497 12.497-12.497 32.758 0 45.255s32.758 12.497 45.255 0l137.373-137.373z' /%3E%3C/svg%3E\")}.playkit-icon-play{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M796.806 461.202c44.919 28.075 44.739 73.706 0 101.668l-459.472 287.171c-44.919 28.075-81.334 7.915-81.334-45.305v-585.4c0-53.096 36.595-73.266 81.334-45.305l459.472 287.171z' /%3E%3C/svg%3E\")}.playkit-icon-pause{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M256 287.843c0-35.259 28.407-63.843 64-63.843 35.346 0 64 28.564 64 63.843v448.314c0 35.259-28.407 63.843-64 63.843-35.346 0-64-28.564-64-63.843v-448.314zM640 287.843c0-35.259 28.407-63.843 64-63.843 35.346 0 64 28.564 64 63.843v448.314c0 35.259-28.407 63.843-64 63.843-35.346 0-64-28.564-64-63.843v-448.314z' /%3E%3C/svg%3E\")}.playkit-icon-volume-base{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M128 416v192h96v-192h-96zM64 383.853c0-17.592 14.012-31.853 32.094-31.853h159.813c17.725 0 32.094 14.581 32.094 31.853v256.295c0 17.592-14.012 31.853-32.094 31.853h-159.813c-17.725 0-32.094-14.581-32.094-31.853v-256.295z' /%3E%3Cpath fill='%23fff' d='M288 634.342l160 88.889v-422.462l-160 88.889v244.684zM224 352l231.787-128.771c31.046-17.248 56.213-2.487 56.213 32.476v512.589c0 35.184-25.054 49.786-56.213 32.476l-231.787-128.771v-320z' /%3E%3C/svg%3E\")}.playkit-icon-volume-waves{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M802.017 837.177c82.359-86.627 129.183-201.774 129.183-324.26 0-123.976-47.976-240.409-132.127-327.329-12.293-12.697-32.552-13.025-45.249-0.732s-13.025 32.552-0.732 45.249c72.692 75.084 114.109 175.597 114.109 282.812 0 105.928-40.422 205.331-111.566 280.162-12.177 12.808-11.666 33.063 1.143 45.24s33.063 11.666 45.24-1.143z' /%3E%3Cpath fill='%23fff' d='M667.436 743.221c67.761-60.884 107.273-147.888 107.273-241.233 0-87.318-34.552-169.203-94.836-229.446-12.501-12.493-32.762-12.486-45.255 0.015s-12.486 32.762 0.015 45.255c48.375 48.342 76.075 113.989 76.075 184.176 0 75.021-31.679 144.776-86.048 193.627-13.146 11.812-14.227 32.044-2.416 45.19s32.044 14.227 45.19 2.416z' /%3E%3C/svg%3E\")}.playkit-icon-volume-wave{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M667.436 743.221c67.761-60.884 107.273-147.888 107.273-241.233 0-87.318-34.552-169.203-94.836-229.446-12.501-12.493-32.762-12.486-45.255 0.015s-12.486 32.762 0.015 45.255c48.375 48.342 76.075 113.989 76.075 184.176 0 75.021-31.679 144.776-86.048 193.627-13.146 11.812-14.227 32.044-2.416 45.19s32.044 14.227 45.19 2.416z'/%3E%3C/svg%3E\")}.playkit-icon-volume-mute{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M768 466.745l-67.986-67.986c-12.213-12.213-32.654-12.393-45.151 0.104-12.584 12.584-12.543 32.711-0.104 45.151l67.986 67.986-67.986 67.986c-12.213 12.213-12.393 32.654 0.104 45.151 12.584 12.584 32.711 12.543 45.151 0.104l67.986-67.986 67.986 67.986c12.213 12.213 32.654 12.393 45.151-0.104 12.584-12.584 12.543-32.711 0.104-45.151l-67.986-67.986 67.986-67.986c12.213-12.213 12.393-32.654-0.104-45.151-12.584-12.584-32.711-12.543-45.151-0.104l-67.986 67.986z' /%3E%3C/svg%3E\")}.playkit-icon-close{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M573.162 512l214.269-214.269c16.772-16.772 16.688-44.071-0.202-60.96-17.007-17.007-44.182-16.98-60.96-0.202l-214.269 214.269-214.269-214.269c-16.772-16.772-44.071-16.688-60.96 0.202-17.007 17.007-16.98 44.182-0.202 60.96l214.269 214.269-214.269 214.269c-16.772 16.772-16.688 44.071 0.202 60.96 17.007 17.007 44.182 16.98 60.96 0.202l214.269-214.269 214.269 214.269c16.772 16.772 44.071 16.688 60.96-0.202 17.007-17.007 16.98-44.182 0.202-60.96l-214.269-214.269z' /%3E%3C/svg%3E\")}.playkit-icon-settings{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M803.451 546.033c2.552-22.107 2.552-44.408 0.246-64.81-1.084-6.208-6.499-10.721-12.535-10.671-30.286 0.533-57.727-17.773-68.866-45.941s-3.64-60.291 18.795-80.593c3.935-3.569 4.416-9.583 0.92-13.959-13.595-17.35-29.146-33.073-46.311-46.83-4.23-3.38-10.359-2.886-14.783 1.966-14.421 14.721-34.212 22.938-54.434 22.761-9.009 0.041-17.942-1.652-26.865-5.212-28.414-11.992-46.226-40.546-44.49-71.542 0.335-5.319-3.547-9.972-8.785-10.588-21.926-2.538-44.068-2.595-65.961-0.176-5.349 0.6-9.341 5.207-9.175 10.514 1.027 30.384-16.802 58.251-45.764 70.431-8.238 3.138-16.993 4.701-25.207 4.609-20.599 0.206-40.395-7.982-55.482-23.363-2.014-2.187-4.849-3.435-7.553-3.445-2.441 0.015-4.811 0.83-6.513 2.139-17.541 13.798-33.455 29.547-47.262 46.729-3.418 4.337-2.922 10.575 0.97 14.162 22.816 20.692 30.19 53.479 17.807 83.351-13.035 27.396-41.135 44.394-71.446 43.222-5.112-0.197-9.499 3.606-10.086 9.179-2.673 22.023-2.673 44.289-0.212 64.867 1.080 6.27 6.559 10.824 13.309 10.737l2.225 0.006c28.935 0.604 54.726 18.391 65.634 45.374 11.22 28.205 3.921 60.407-18.565 81.204-3.866 3.509-4.341 9.418-0.895 13.742 13.545 17.354 29.027 33.106 46.042 46.867 4.303 3.449 10.547 2.954 14.986-1.907 14.414-14.76 34.226-23.001 54.43-22.82 9.070-0.052 18.063 1.668 27.041 5.299 28.19 12.071 45.891 40.41 44.347 71.468-0.342 5.312 3.536 9.962 8.802 10.578 21.915 2.548 44.049 2.605 65.929 0.176 5.364-0.604 9.364-5.227 9.191-10.598-0.997-30.358 16.84-58.183 45.452-70.201 8.263-3.256 17.070-4.908 25.521-4.865 20.676-0.206 40.533 8.070 55.398 23.38 2.039 2.195 4.898 3.446 7.673 3.455 2.268-0.011 4.468-0.776 6.321-2.228 17.625-13.724 33.599-29.444 47.415-46.611 3.426-4.348 2.928-10.6-0.863-14.097-22.358-20.082-30.057-51.85-19.372-79.939s37.55-46.71 67.745-46.857h5.229c5.12-0.026 9.413-3.875 9.996-8.962zM861.733 552.735c-3.961 34.572-33.157 60.748-68.129 60.926h-5.235c-5.803 0.028-10.991 3.624-13.054 9.048s-0.577 11.558 4.020 15.69c26.602 24.519 29.853 65.381 7.275 94.034-16.847 20.934-36.063 39.845-57.197 56.302-12.034 9.427-26.861 14.584-42.368 14.658-19.254-0.051-37.623-8.090-50.269-21.718-3.221-3.315-7.66-5.165-12.712-5.118-1.425-0.007-2.839 0.258-3.554 0.532-5.581 2.346-9.136 7.892-8.937 13.966 1.152 35.958-25.509 66.771-61.307 70.804-26.332 2.923-52.909 2.854-79.246-0.208-36.286-4.245-62.897-36.157-60.576-72.186 0.304-6.123-3.235-11.788-8.302-13.964-1.328-0.536-2.748-0.808-4.606-0.8-4.651-0.041-9.118 1.817-11.635 4.367-24.544 27.036-65.886 30.311-94.481 7.394-20.587-16.65-39.207-35.595-55.308-56.226-22.552-28.277-19.261-69.208 7.317-93.334 4.474-4.138 5.939-10.604 3.748-16.115-2.052-5.076-6.932-8.442-11.794-8.55-36.436 0.464-66.759-24.741-72.949-60.89-3.243-26.718-3.243-53.731-0.055-79.964 3.744-35.827 34.642-62.605 70.642-61.219 6.877 0.266 13.251-3.59 15.584-8.401 2.309-5.59 0.861-12.028-3.789-16.247-26.603-24.51-29.856-65.368-7.293-93.994 16.767-20.868 35.856-39.76 57.129-56.491 12.099-9.322 26.921-14.42 42.463-14.513 19.308 0.059 37.717 8.166 50.145 21.684 3.263 3.322 7.737 5.172 12.994 5.126 1.471 0.015 2.933-0.245 3.363-0.39 5.601-2.359 9.165-7.93 8.957-14.077-1.126-35.941 25.542-66.721 61.322-70.731 26.322-2.909 52.889-2.84 79.251 0.212 36.244 4.265 62.828 36.125 60.546 72.343-0.339 6.047 3.159 11.654 8.186 13.782 1.381 0.55 2.855 0.829 4.726 0.823 4.663 0.040 9.142-1.819 11.615-4.312 24.439-26.99 65.656-30.312 94.137-7.557 20.721 16.607 39.456 35.549 55.655 56.225 22.667 28.35 19.38 69.439-7.531 93.846-4.33 3.918-5.776 10.112-3.628 15.542s7.438 8.96 13.543 8.854c34.999-0.298 65.076 24.766 71.337 60.925 3.065 26.552 3.065 53.368 0 79.92zM511.956 589.951c43.215-0.108 78.137-35.17 78.072-78.385 0-31.732-19.132-60.334-48.461-72.448s-63.068-5.35-85.461 17.133c-22.393 22.483-29.022 56.249-16.791 85.529s40.909 48.298 72.641 48.171zM512.146 648.617c-55.438 0.221-105.58-33.029-126.965-84.224s-9.796-110.233 29.358-149.543c39.153-39.31 98.144-51.136 149.424-29.956s84.731 71.189 84.732 126.627c0.114 75.549-60.999 136.907-136.548 137.096z' /%3E%3C/svg%3E\")}.playkit-icon-check{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M342.481 563.894c-12.577-12.416-32.838-12.285-45.254 0.292s-12.285 32.838 0.292 45.254l118.857 117.333c13.275 13.105 34.901 12.123 46.933-2.131l297.143-352c11.4-13.505 9.694-33.694-3.811-45.094s-33.694-9.694-45.094 3.811l-274.828 325.566-94.238-93.030z' /%3E%3C/svg%3E\")}.playkit-icon-check-active{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M342.481 563.894c-12.577-12.416-32.838-12.285-45.254 0.292s-12.285 32.838 0.292 45.254l118.857 117.333c13.275 13.105 34.901 12.123 46.933-2.131l297.143-352c11.4-13.505 9.694-33.694-3.811-45.094s-33.694-9.694-45.094 3.811l-274.828 325.566-94.238-93.030z' /%3E%3C/svg%3E\")}.playkit-icon-language{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 800c159.058 0 288-128.942 288-288s-128.942-288-288-288c-159.058 0-288 128.942-288 288s128.942 288 288 288zM512 864c-194.404 0-352-157.596-352-352s157.596-352 352-352c194.404 0 352 157.596 352 352s-157.596 352-352 352z' /%3E%3Cpath fill='%23fff' d='M441.231 173.324c-76.632 84.62-121.231 207.208-121.231 338.676 0 134.304 46.556 259.282 126.083 343.936l46.646-43.82c-68.041-72.429-108.728-181.651-108.728-300.116 0-116.001 39.001-223.203 104.669-295.716l-47.438-42.96z' /%3E%3Cpath fill='%23fff' d='M584.297 173.324c76.632 84.62 121.231 207.208 121.231 338.676 0 134.304-46.556 259.282-126.083 343.936l-46.646-43.82c68.041-72.429 108.728-181.651 108.728-300.116 0-116.001-39.001-223.203-104.669-295.716l47.438-42.96z' /%3E%3Cpath fill='%23fff' d='M840.432 419.786c-81.65-22.637-200.551-35.786-328.432-35.786-128.056 0-247.103 13.185-328.758 35.876l17.136 61.663c75.47-20.972 188.938-33.539 311.622-33.539 122.521 0 235.854 12.533 311.334 33.459l17.099-61.674z' /%3E%3Cpath fill='%23fff' d='M840.432 605.754c-81.65 22.637-200.551 35.786-328.432 35.786-128.056 0-247.103-13.185-328.758-35.876l17.136-61.663c75.47 20.972 188.938 33.539 311.622 33.539 122.521 0 235.854-12.533 311.334-33.459l17.099 61.674z' /%3E%3Cpath fill='%23fff' d='M480 192h64v640h-64v-640z' /%3E%3C/svg%3E\")}.playkit-icon-quality{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M159.904 192h288.234c17.277 0 31.862 14.323 31.862 31.992 0 17.792-14.261 31.993-31.853 31.994l-288.147 0.014v544.174c-0.017-0.18 704-0.174 704-0.174v-128.006c0-17.795 14.327-31.994 32-31.994 17.796 0 32 14.34 32 32.029v128.145c0 35.25-28.639 63.826-63.904 63.826h-704.192c-35.293 0-63.904-28.875-63.904-63.826v-544.348c0-35.25 28.639-63.826 63.904-63.826zM501.818 378.182c108.449 0 196.364-87.915 196.364-196.364 0-29.091 43.636-29.091 43.636 0 0 108.449 87.915 196.364 196.364 196.364 29.091 0 29.091 43.636 0 43.636-108.449 0-196.364 87.915-196.364 196.364 0 29.091-43.636 29.091-43.636 0 0-108.449-87.915-196.364-196.364-196.364-29.091 0-29.091-43.636 0-43.636z' /%3E%3C/svg%3E\")}.playkit-icon-captions{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M160 771.213c-0.017-0.172 704-0.166 704-0.166v-518.261c0.017 0.172-704 0.166-704 0.166v518.261zM96 252.787c0-33.572 28.639-60.787 63.904-60.787h704.192c35.293 0 63.904 27.5 63.904 60.787v518.427c0 33.572-28.639 60.787-63.904 60.787h-704.192c-35.293 0-63.904-27.5-63.904-60.787v-518.427z' /%3E%3Cpath fill='%23fff' d='M490.583 568.655c0 7.729-2.311 15.987-6.933 24.777s-11.668 17.162-21.14 25.118c-9.471 7.956-21.405 14.358-35.801 19.208s-30.611 7.274-48.644 7.274c-38.34 0-68.268-11.176-89.787-33.528s-32.278-52.319-32.278-89.901c0-25.459 4.925-47.962 14.775-67.511s24.095-34.665 42.734-45.348c18.639-10.684 40.916-16.025 66.829-16.025 16.063 0 30.8 2.349 44.212 7.047s24.777 10.759 34.096 18.185c9.32 7.425 16.442 15.343 21.367 23.754s7.388 16.253 7.388 23.527c0 7.425-2.766 13.714-8.297 18.867s-12.237 7.729-20.117 7.729c-5.152 0-9.433-1.326-12.843-3.978s-7.236-6.933-11.479-12.843c-7.577-11.517-15.495-20.155-23.754-25.913s-18.753-8.638-31.482-8.638c-18.336 0-33.111 7.16-44.325 21.481s-16.821 33.907-16.821 58.759c0 11.669 1.44 22.39 4.319 32.164s7.047 18.109 12.502 25.004c5.455 6.895 12.047 12.123 19.776 15.684s16.215 5.342 25.459 5.342c12.426 0 23.072-2.879 31.937-8.638s16.707-14.548 23.527-26.368c3.789-6.971 7.88-12.426 12.275-16.366s9.774-5.91 16.139-5.91c7.577 0 13.866 2.879 18.867 8.638s7.501 11.896 7.501 18.412zM767.219 568.655c0 7.729-2.311 15.987-6.933 24.777s-11.668 17.162-21.14 25.118c-9.471 7.956-21.405 14.358-35.801 19.208s-30.611 7.274-48.644 7.274c-38.34 0-68.268-11.176-89.787-33.528s-32.278-52.319-32.278-89.901c0-25.459 4.925-47.962 14.775-67.511s24.095-34.665 42.734-45.348c18.639-10.684 40.916-16.025 66.829-16.025 16.063 0 30.8 2.349 44.212 7.047s24.777 10.759 34.096 18.185c9.32 7.425 16.442 15.343 21.367 23.754s7.388 16.253 7.388 23.527c0 7.425-2.766 13.714-8.297 18.867s-12.237 7.729-20.117 7.729c-5.152 0-9.433-1.326-12.843-3.978s-7.236-6.933-11.479-12.843c-7.577-11.517-15.495-20.155-23.754-25.913s-18.753-8.638-31.482-8.638c-18.336 0-33.111 7.16-44.325 21.481s-16.821 33.907-16.821 58.759c0 11.669 1.44 22.39 4.319 32.164s7.047 18.109 12.502 25.004c5.455 6.895 12.047 12.123 19.776 15.684s16.215 5.342 25.459 5.342c12.426 0 23.072-2.879 31.937-8.638s16.707-14.548 23.527-26.368c3.789-6.971 7.88-12.426 12.275-16.366s9.774-5.91 16.139-5.91c7.577 0 13.866 2.879 18.867 8.638s7.501 11.896 7.501 18.412z' /%3E%3C/svg%3E\")}.playkit-icon-speed{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 832c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM480.239 643.971c-0.158-1.272-0.239-2.566-0.239-3.876v-192.19c0-17.621 14.204-31.905 32-31.905 17.673 0 32 14.497 32 31.905v192.19c0 1.313-0.079 2.607-0.232 3.878 55.325 14.128 96.232 64.301 96.232 124.027 0 70.692-57.308 128-128 128s-128-57.308-128-128c0-59.729 40.91-109.903 96.239-124.029zM928 576c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-194.404-157.596-352-352-352s-352 157.596-352 352c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-229.75 186.25-416 416-416s416 186.25 416 416z' /%3E%3C/svg%3E\")}.playkit-icon-speed-down{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM401.852 670.758c-1.056-0.826-2.077-1.728-3.055-2.706l-113.005-113.005c-12.533-12.533-12.65-32.737-0.066-45.321 12.497-12.497 32.536-12.719 45.321 0.066l113.005 113.005c0.976 0.976 1.876 1.998 2.701 3.059 19.106-11.343 41.416-17.855 65.248-17.855 70.692 0 128 57.308 128 128s-57.308 128-128 128c-70.692 0-128-57.308-128-128 0-23.829 6.511-46.137 17.852-65.242zM928 576c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-194.404-157.596-352-352-352s-352 157.596-352 352c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-229.75 186.25-416 416-416s416 186.25 416 416z'/%3E%3C/svg%3E\")}.playkit-icon-speed-up{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM546.516 612.708c0.524-1.23 1.129-2.446 1.819-3.64l79.906-138.402c8.862-15.35 28.348-20.692 43.76-11.794 15.305 8.837 20.707 28.135 11.666 43.794l-79.906 138.402c-0.693 1.201-1.451 2.34-2.268 3.416 23.761 23.238 38.508 55.655 38.508 91.516 0 70.692-57.308 128-128 128s-128-57.308-128-128c0-70.692 57.308-128 128-128 11.959 0 23.535 1.64 34.516 4.708zM928 576c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-194.404-157.596-352-352-352s-352 157.596-352 352c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-229.75 186.25-416 416-416s416 186.25 416 416z'/%3E%3C/svg%3E\")}.playkit-icon-audio{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M768 625.124v-354.531l-352 135.385v330.022c0 70.692-57.308 128-128 128s-128-57.308-128-128c0-70.692 57.308-128 128-128 23.314 0 45.173 6.233 64 17.124v-241.124c0-13.241 8.155-25.114 20.513-29.867l416-160c20.96-8.062 43.487 7.41 43.487 29.867v512c0 70.692-57.308 128-128 128s-128-57.308-128-128c0-70.692 57.308-128 128-128 23.314 0 45.173 6.233 64 17.124zM288 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM704 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64z' /%3E%3C/svg%3E\")}.playkit-icon-arrow-down{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M301.255 338.745c-24.994-24.994-65.516-24.994-90.51 0s-24.994 65.516 0 90.51l256 256c24.994 24.994 65.516 24.994 90.51 0l256-256c24.994-24.994 24.994-65.516 0-90.51s-65.516-24.994-90.51 0l-210.745 210.745-210.745-210.745z' /%3E%3C/svg%3E\")}.playkit-icon-start-over{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M255.271 339.053c94.182-126.513 270.298-165.203 410.222-84.418 150.758 87.040 202.411 279.813 115.371 430.571s-279.813 202.411-430.571 115.371c-61.424-35.463-107.948-89.4-134.169-153.673-7.677-18.818-29.156-27.85-47.974-20.173s-27.85 29.156-20.173 47.974c32.339 79.269 89.818 145.906 165.517 189.611 185.96 107.364 423.747 43.649 531.111-142.311s43.649-423.747-142.311-531.111c-172.433-99.554-389.428-52.014-505.682 103.69l-27.226-78.49c-6.66-19.202-27.626-29.368-46.828-22.708s-29.368 27.626-22.708 46.828l52.434 151.164c5.36 15.452 20.275 25.513 36.61 24.694l159.799-8.011c20.299-1.018 35.929-18.298 34.911-38.596s-18.298-35.929-38.596-34.911l-89.738 4.499z' /%3E%3C/svg%3E\")}.playkit-icon-seek-end{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M742.494 323.053c-94.182-126.513-270.298-165.203-410.222-84.418-150.758 87.040-202.411 279.813-115.371 430.571s279.813 202.411 430.571 115.371c61.424-35.463 107.948-89.4 134.169-153.673 7.677-18.818 29.156-27.85 47.974-20.173s27.85 29.156 20.173 47.974c-32.339 79.269-89.818 145.906-165.517 189.611-185.96 107.364-423.747 43.649-531.111-142.311s-43.649-423.747 142.311-531.111c172.433-99.554 389.428-52.014 505.682 103.69l27.226-78.49c6.66-19.202 27.626-29.368 46.828-22.708s29.368 27.626 22.708 46.828l-52.434 151.164c-5.36 15.452-20.275 25.513-36.61 24.694l-159.799-8.011c-20.299-1.018-35.929-18.298-34.911-38.596s18.298-35.929 38.596-34.911l89.738 4.499z'/%3E%3C/svg%3E\")}.playkit-icon-rewind{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' opacity='0.5' d='M258.471 323.053c94.182-126.513 270.298-165.203 410.222-84.418 150.758 87.040 202.411 279.813 115.371 430.571s-279.813 202.411-430.571 115.371c-61.424-35.463-107.948-89.4-134.169-153.673-7.677-18.818-29.156-27.85-47.974-20.173s-27.85 29.156-20.173 47.974c32.339 79.269 89.818 145.906 165.517 189.611 185.96 107.364 423.747 43.649 531.111-142.311s43.649-423.747-142.311-531.111c-172.433-99.554-389.428-52.014-505.682 103.69l-27.226-78.49c-6.66-19.202-27.626-29.368-46.828-22.708s-29.368 27.626-22.708 46.828l52.434 151.164c5.36 15.452 20.275 25.513 36.61 24.694l159.799-8.011c20.299-1.018 35.929-18.298 34.911-38.596s-18.298-35.929-38.596-34.911l-89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M816.068 431.974c-20.553-78.699-71.369-149.456-147.375-193.338-139.923-80.785-316.040-42.095-410.222 84.418l89.738-4.499c20.299-1.018 37.579 14.613 38.596 34.911s-14.613 37.579-34.911 38.596l-159.799 8.011c-16.335 0.819-31.25-9.242-36.61-24.694l-52.434-151.164c-6.66-19.202 3.506-40.167 22.708-46.828s40.167 3.506 46.828 22.708l27.226 78.49c116.254-155.703 333.248-203.244 505.682-103.69 91.184 52.645 152.976 136.648 179.618 230.523l-69.044 26.555z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-rewind-10{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M258.471 323.053c94.182-126.513 270.298-165.203 410.222-84.418 150.758 87.040 202.411 279.813 115.371 430.571s-279.813 202.411-430.571 115.371c-61.424-35.463-107.948-89.4-134.169-153.673-7.677-18.818-29.156-27.85-47.974-20.173s-27.85 29.156-20.173 47.974c32.339 79.269 89.818 145.906 165.517 189.611 185.96 107.364 423.747 43.649 531.111-142.311s43.649-423.747-142.311-531.111c-172.433-99.554-389.428-52.014-505.682 103.69l-27.226-78.49c-6.66-19.202-27.626-29.368-46.828-22.708s-29.368 27.626-22.708 46.828l52.434 151.164c5.36 15.452 20.275 25.513 36.61 24.694l159.799-8.011c20.299-1.018 35.929-18.298 34.911-38.596s-18.298-35.929-38.596-34.911l-89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M413.327 636.083h67.358v-252.083h-48.527c-2.173 7.358-4.949 13.589-8.329 18.693s-7.726 9.139-13.037 12.106c-5.311 2.967-11.709 5.103-19.193 6.409s-16.417 1.958-26.798 1.958v41.302h48.527v171.616zM596.807 554.192c0 17.803 1.569 29.849 4.708 36.139s8.208 9.435 15.21 9.435c7.001 0 12.071-3.145 15.21-9.435s4.708-18.336 4.708-36.139v-83.316c0-17.803-1.569-29.849-4.708-36.139s-8.208-9.435-15.21-9.435c-7.001 0-12.071 3.145-15.21 9.435s-4.708 18.336-4.708 36.139v83.316zM529.449 512.534c0-25.398 1.75-46.405 5.251-63.021s8.812-29.789 15.934-39.522c7.122-9.732 16.176-16.497 27.16-20.295s23.962-5.697 38.93-5.697c14.969 0 27.945 1.899 38.93 5.697s20.038 10.563 27.16 20.295c7.122 9.732 12.433 22.906 15.934 39.522s5.251 37.622 5.251 63.021c0 25.636-1.75 46.702-5.251 63.199s-8.812 29.552-15.934 39.166c-7.122 9.613-16.176 16.2-27.16 19.761s-23.962 5.341-38.93 5.341c-14.969 0-27.945-1.78-38.93-5.341s-20.038-10.147-27.16-19.761c-7.122-9.613-12.433-22.668-15.934-39.166s-5.251-37.563-5.251-63.199z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-forward{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' opacity='0.5' d='M765.529 323.053c-94.182-126.513-270.298-165.203-410.222-84.418-150.758 87.040-202.411 279.813-115.371 430.571s279.813 202.411 430.571 115.371c61.424-35.463 107.948-89.4 134.169-153.673 7.677-18.818 29.156-27.85 47.974-20.173s27.85 29.156 20.173 47.974c-32.339 79.269-89.818 145.906-165.517 189.611-185.96 107.364-423.747 43.649-531.111-142.311s-43.649-423.747 142.311-531.111c172.433-99.554 389.428-52.014 505.682 103.69l27.226-78.49c6.66-19.202 27.626-29.368 46.828-22.708s29.368 27.626 22.708 46.828l-52.434 151.164c-5.36 15.452-20.275 25.513-36.61 24.694l-159.799-8.011c-20.299-1.018-35.929-18.298-34.911-38.596s18.298-35.929 38.596-34.911l89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M207.932 431.974c20.553-78.699 71.369-149.456 147.375-193.338 139.923-80.785 316.040-42.095 410.222 84.418l-89.738-4.499c-20.299-1.018-37.579 14.613-38.596 34.911s14.613 37.579 34.911 38.596l159.799 8.011c16.335 0.819 31.25-9.242 36.61-24.694l52.434-151.164c6.66-19.202-3.506-40.167-22.708-46.828s-40.167 3.506-46.828 22.708l-27.226 78.49c-116.254-155.703-333.248-203.244-505.682-103.69-91.184 52.645-152.976 136.648-179.618 230.523l69.044 26.555z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-forward-10{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M765.529 323.053c-94.182-126.513-270.298-165.203-410.222-84.418-150.758 87.040-202.411 279.813-115.371 430.571s279.813 202.411 430.571 115.371c61.424-35.463 107.948-89.4 134.169-153.673 7.677-18.818 29.156-27.85 47.974-20.173s27.85 29.156 20.173 47.974c-32.339 79.269-89.818 145.906-165.517 189.611-185.96 107.364-423.747 43.649-531.111-142.311s-43.649-423.747 142.311-531.111c172.433-99.554 389.428-52.014 505.682 103.69l27.226-78.49c6.66-19.202 27.626-29.368 46.828-22.708s29.368 27.626 22.708 46.828l-52.434 151.164c-5.36 15.452-20.275 25.513-36.61 24.694l-159.799-8.011c-20.299-1.018-35.929-18.298-34.911-38.596s18.298-35.929 38.596-34.911l89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M365.327 636.083h67.358v-252.083h-48.527c-2.173 7.358-4.949 13.589-8.329 18.693s-7.726 9.139-13.037 12.106c-5.311 2.967-11.709 5.103-19.193 6.409s-16.417 1.958-26.798 1.958v41.302h48.527v171.616zM548.807 554.192c0 17.803 1.569 29.849 4.708 36.139s8.208 9.435 15.21 9.435c7.001 0 12.071-3.145 15.21-9.435s4.708-18.336 4.708-36.139v-83.316c0-17.803-1.569-29.849-4.708-36.139s-8.208-9.435-15.21-9.435c-7.001 0-12.071 3.145-15.21 9.435s-4.708 18.336-4.708 36.139v83.316zM481.449 512.534c0-25.398 1.75-46.405 5.251-63.021s8.812-29.789 15.934-39.522c7.122-9.732 16.176-16.497 27.16-20.295s23.962-5.697 38.93-5.697c14.969 0 27.945 1.899 38.93 5.697s20.038 10.563 27.16 20.295c7.122 9.732 12.433 22.906 15.934 39.522s5.251 37.622 5.251 63.021c0 25.636-1.75 46.702-5.251 63.199s-8.812 29.552-15.934 39.166c-7.122 9.613-16.176 16.2-27.16 19.761s-23.962 5.341-38.93 5.341c-14.969 0-27.945-1.78-38.93-5.341s-20.038-10.147-27.16-19.761c-7.122-9.613-12.433-22.668-15.934-39.166s-5.251-37.563-5.251-63.199z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-vr-stereo{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M864 255.996c53.019 0 96 42.981 96 96v384.004c0 53.019-42.981 96-96 96h-219.764c-33.721 0-64.97-17.693-82.319-46.608l-49.917-83.195-49.917 83.195c-17.349 28.916-48.598 46.608-82.319 46.608h-219.764c-53.019 0-96-42.981-96-96v-384.003c0-53.019 42.981-96 96-96h704zM128 351.997v384.003c0 17.673 14.327 32 32 32h219.764c11.24 0 21.657-5.898 27.44-15.536l49.917-83.195c5.405-9.008 12.944-16.547 21.952-21.952 30.309-18.185 69.622-8.357 87.807 21.952l49.917 83.195c5.783 9.639 16.199 15.536 27.44 15.536h219.764c17.673 0 32-14.327 32-32v-384.004c0-17.673-14.327-32-32-32h-704c-17.673 0-32 14.327-32 32zM304 624c-44.183 0-80-35.817-80-80s35.817-80 80-80c44.183 0 80 35.817 80 80s-35.817 80-80 80zM720 624c-44.183 0-80-35.817-80-80s35.817-80 80-80c44.183 0 80 35.817 80 80s-35.817 80-80 80z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-vr-stereo-full{background-image:var(--playkit-icon-vr-stereo-full-url)}.playkit-icon-chromecast{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M160 704v96h96c0-53.12-42.88-96-96-96zM160 576v64c88.32 0 160 71.68 160 160h64c0-123.84-100.16-224-224-224zM736 352h-448v52.16c126.72 40.96 226.88 141.12 267.84 267.84h180.16v-320zM160 448v64c159.040 0 288 128.96 288 288h64c0-194.56-157.76-352-352-352zM800 224h-576c-35.2 0-64 28.8-64 64v96h64v-96h576v448h-224v64h224c35.2 0 64-28.8 64-64v-448c0-35.2-28.8-64-64-64z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-chromecast-brand{background-image:var(--playkit-icon-chromecast-url)}.playkit-icon-next{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M640 549.333l-264.982 154.573c-30.386 17.725-55.018 3.388-55.018-32.094v-319.625c0-35.45 24.605-49.835 55.018-32.094l264.982 154.573v-154.448c0-17.794 14.204-32.219 32-32.219 17.673 0 32 14.398 32 32.219v383.562c0 17.794-14.204 32.219-32 32.219-17.673 0-32-14.398-32-32.219v-154.448z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-prev{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M384 549.333l264.982 154.573c30.386 17.725 55.018 3.388 55.018-32.094v-319.625c0-35.45-24.605-49.835-55.018-32.094l-264.982 154.573v-154.448c0-17.794-14.204-32.219-32-32.219-17.673 0-32 14.398-32 32.219v383.562c0 17.794 14.204 32.219 32 32.219 17.673 0 32-14.398 32-32.219v-154.448z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-picture-in-picture-start{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M224 256c-17.673 0-32 14.327-32 32v448c0 17.673 14.327 32 32 32h576c17.673 0 32-14.327 32-32v-448c0-17.673-14.327-32-32-32h-576zM224 192h576c53.019 0 96 42.981 96 96v448c0 53.019-42.981 96-96 96h-576c-53.019 0-96-42.981-96-96v-448c0-53.019 42.981-96 96-96z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M544 512h192c17.673 0 32 14.327 32 32v128c0 17.673-14.327 32-32 32h-192c-17.673 0-32-14.327-32-32v-128c0-17.673 14.327-32 32-32z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-picture-in-picture-stop{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M800 192c51.126 0 92.917 39.965 95.837 90.359l0.163 5.641v448c0 51.126-39.965 92.917-90.359 95.837l-5.641 0.163h-576c-51.126 0-92.917-39.965-95.837-90.359l-0.163-5.641v-64c0-17.673 14.327-32 32-32 16.411 0 29.936 12.353 31.785 28.268l0.215 3.732v64c0 16.411 12.353 29.936 28.268 31.785l3.732 0.215h576c16.411 0 29.936-12.353 31.785-28.268l0.215-3.732v-448c0-16.411-12.353-29.936-28.268-31.785l-3.732-0.215h-192c-17.673 0-32-14.327-32-32 0-16.411 12.353-29.936 28.268-31.785l3.732-0.215h192z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M416 192c17.673 0 32 14.327 32 32 0 16.411-12.353 29.936-28.268 31.785l-3.732 0.215-178.752-0.032 202.711 202.736c12.497 12.497 12.497 32.758 0 45.255-11.535 11.535-29.687 12.423-42.24 2.662l-3.015-2.662-202.704-202.679v178.72c0 16.411-12.353 29.936-28.268 31.785l-3.732 0.215c-16.411 0-29.936-12.353-31.785-28.268l-0.215-3.732v-256l0.005-0.588c0.014-0.757 0.054-1.514 0.122-2.268l-0.127 2.856c0-1.62 0.12-3.212 0.353-4.767 0.083-0.544 0.182-1.101 0.295-1.656 0.141-0.705 0.307-1.399 0.495-2.084 0.14-0.5 0.288-0.992 0.449-1.482 0.204-0.629 0.434-1.262 0.684-1.885 0.227-0.568 0.466-1.121 0.722-1.669 0.311-0.661 0.644-1.314 0.998-1.954 0.212-0.388 0.439-0.779 0.676-1.166 0.503-0.818 1.040-1.614 1.61-2.382 0.174-0.238 0.351-0.47 0.532-0.7 1.588-2.021 3.42-3.854 5.45-5.446l-2.891 2.563c1.133-1.133 2.329-2.163 3.578-3.090 0.774-0.571 1.569-1.108 2.389-1.609 0.386-0.239 0.777-0.466 1.171-0.685 0.633-0.348 1.285-0.681 1.951-0.993 0.544-0.255 1.098-0.495 1.656-0.718 0.632-0.253 1.265-0.483 1.907-0.694 0.476-0.154 0.969-0.302 1.464-0.438 0.69-0.192 1.384-0.359 2.086-0.502 0.557-0.111 1.115-0.209 1.674-0.293 0.327-0.051 0.672-0.097 1.019-0.137l0.876-0.088c0.755-0.067 1.511-0.108 2.268-0.122l0.588-0.005h256z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-quality-hd:after{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M3.73939861,5 L2,5 L2,11 L3.73939861,11 L3.73918396,8.56940659 L5.96845644,8.56940659 L5.9691596,11 L7.69930609,11 L7.69930609,5 L5.9691596,5 L5.96845644,7.32457143 L3.73918396,7.32457143 L3.73939861,5 Z M10.849653,5 L8.65690054,5 L8.65690054,11 L10.8774094,11 L11.1387878,10.9921562 C11.5670397,10.9660102 11.9583976,10.8744992 12.3128614,10.7176232 L12.3128614,10.7176232 L12.4919044,10.6311813 L12.686671,10.5199596 C13.0639309,10.2858264 13.3675515,9.98155416 13.5975328,9.60714286 C13.827514,9.23273155 13.9589319,8.81088809 13.9917864,8.34161247 L13.9917864,8.34161247 L14,8.10302198 L14,7.9010989 L13.9917864,7.66145717 C13.9589319,7.19033135 13.827514,6.76815149 13.5975328,6.39491758 C13.3292213,5.95947802 12.9583655,5.61813187 12.4849653,5.37087912 C12.0791937,5.15894819 11.6207417,5.03784481 11.1096093,5.00756896 L11.1096093,5.00756896 L10.849653,5 Z M10.849653,6.24862637 C11.154973,6.24862637 11.4101773,6.30906593 11.615266,6.42994505 C11.8203547,6.55082418 11.9745567,6.73282967 12.077872,6.97596154 C12.1605243,7.17046703 12.2101157,7.40497253 12.2266461,7.67947802 L12.2266461,7.67947802 L12.232845,7.89285714 L12.232845,8.10302198 L12.2265536,8.31796703 C12.2097764,8.59445055 12.1594449,8.83049451 12.075559,9.0260989 C11.9707016,9.2706044 11.8180416,9.4532967 11.617579,9.57417582 C11.4572089,9.67087912 11.2672321,9.7289011 11.0476484,9.74824176 L11.0476484,9.74824176 L10.8774094,9.75549451 L10.3957366,9.75600879 L10.3957366,6.24937143 Z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-quality-hd-active:after{background-image:var(--playkit-icon-quality-HD-active-url)}.playkit-icon-quality-4k:after{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M6.52117789,5 L4.77853973,5 L4.7778117,5.01381978 L2,8.80769231 L2.10649455,9.76785714 L4.7778117,9.76866813 L4.77853973,11 L6.52117789,11 L6.52063574,9.76866813 L7.19402985,9.76785714 L7.19402985,8.5728022 L6.52063574,8.57362637 L6.52117789,5 Z M9.81282775,5 L7.99273901,5 L7.99273901,11 L9.81282775,11 L9.8119758,9.5061978 L10.4712352,8.88589011 L11.8313836,11 L13.9806374,11 L11.6856603,7.6629978 L14,5 L11.7587737,5 L10.3549818,6.78434066 L9.8119758,7.5229011 L9.81282775,5 Z M4.7778117,7.01905934 L4.7778117,8.57362637 L3.65066559,8.5728022 L4.69624849,7.13873626 L4.7778117,7.01905934 Z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-quality-4k-active:after{background-image:var(--playkit-icon-quality-4K-active-url)}.playkit-icon-quality-8k:after{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M4.5,5 C4.04427083,5 3.6389974,5.06279225 3.28417969,5.18837675 C2.92936198,5.31396126 2.65104167,5.499666 2.44921875,5.74549098 C2.24739583,5.99131597 2.14648438,6.29458918 2.14648438,6.65531062 C2.14648438,6.96259185 2.24820964,7.23112892 2.45166016,7.46092184 C2.58729384,7.61411712 2.75692636,7.74445187 2.96055773,7.85192607 L2.96055773,7.85192607 L3.07972656,7.90981323 L3.04817708,7.92134269 L2.87890625,8.000668 C2.71614583,8.08483634 2.57291667,8.18353373 2.44921875,8.29676019 L2.44921875,8.29676019 L2.33203125,8.41482966 L2.24394133,8.52320968 C2.08131378,8.74602266 2,9.00515316 2,9.3006012 C2,9.67735471 2.10986328,9.99131597 2.32958984,10.242485 C2.54931641,10.493654 2.84879557,10.6826987 3.22802734,10.8096192 C3.60725911,10.9365397 4.03613281,11 4.51464844,11 C4.99641927,11 5.42366536,10.9365397 5.79638672,10.8096192 C6.16910807,10.6826987 6.46289063,10.493654 6.67773438,10.242485 C6.89257813,9.99131597 7,9.67735471 7,9.3006012 C7,8.95591182 6.89176432,8.66065464 6.67529297,8.41482966 L6.67529297,8.41482966 L6.56041124,8.29676019 C6.3983742,8.14579158 6.20089157,8.02065242 5.96796332,7.92134269 L5.96796332,7.92134269 L5.94,7.911 L6.06141493,7.85192607 L6.20532227,7.76703407 C6.29701063,7.70758183 6.38019929,7.64241446 6.45488824,7.57153195 L6.45488824,7.57153195 L6.56054688,7.46092184 L6.65155707,7.3427967 C6.78945132,7.14054034 6.85839844,6.91137831 6.85839844,6.65531062 C6.85839844,6.29458918 6.75830078,5.99131597 6.55810547,5.74549098 C6.35791016,5.499666 6.08121745,5.31396126 5.72802734,5.18837675 C5.37483724,5.06279225 4.96549479,5 4.5,5 Z M9.8178888,5 L8,5 L8,11 L9.8178888,11 L9.81771088,9.5061978 L10.4751832,8.88673407 L11.8340048,11 L13.9806608,11 L11.6891307,7.6629978 L14,5 L11.7614827,5 L10.3593876,6.78434066 L9.81771088,7.5229011 L9.8178888,5 Z M4.50488281,8.51903808 C4.6546224,8.51903808 4.78401693,8.54375418 4.89306641,8.59318637 C5.00211589,8.64261857 5.0867513,8.71543086 5.14697266,8.81162325 C5.20719401,8.90781563 5.23730469,9.02805611 5.23730469,9.17234469 C5.23730469,9.30861723 5.20800781,9.4261857 5.14941406,9.5250501 C5.09082031,9.6239145 5.0069987,9.7007348 4.89794922,9.75551102 C4.78889974,9.81028724 4.66113281,9.83767535 4.51464844,9.83767535 C4.36490885,9.83767535 4.23388672,9.81028724 4.12158203,9.75551102 C4.00927734,9.7007348 3.92220052,9.6239145 3.86035156,9.5250501 C3.7985026,9.4261857 3.76757812,9.30861723 3.76757812,9.17234469 C3.76757812,9.02805611 3.7985026,8.90781563 3.86035156,8.81162325 C3.92220052,8.71543086 4.00846354,8.64261857 4.11914062,8.59318637 C4.22981771,8.54375418 4.35839844,8.51903808 4.50488281,8.51903808 Z M4.5,6.16232465 C4.63671875,6.16232465 4.74902344,6.18570474 4.83691406,6.23246493 C4.92480469,6.27922512 4.99072266,6.34535738 5.03466797,6.43086172 C5.07861328,6.51636607 5.10058594,6.62057448 5.10058594,6.74348697 C5.10058594,6.86372745 5.08024089,6.96993988 5.03955078,7.06212425 C4.99886068,7.15430862 4.93538411,7.22645291 4.84912109,7.27855711 C4.76285807,7.33066132 4.65136719,7.35671343 4.51464844,7.35671343 C4.37792969,7.35671343 4.2648112,7.33066132 4.17529297,7.27855711 C4.08577474,7.22645291 4.01985677,7.15430862 3.97753906,7.06212425 C3.93522135,6.96993988 3.9140625,6.86372745 3.9140625,6.74348697 C3.9140625,6.62057448 3.93522135,6.51636607 3.97753906,6.43086172 C4.01985677,6.34535738 4.08496094,6.27922512 4.17285156,6.23246493 C4.26074219,6.18570474 4.36979167,6.16232465 4.5,6.16232465 Z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-quality-8k-active:after{background-image:var(--playkit-icon-quality-8K-active-url)}.playkit-icon-closed-captions-on{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M15.114 18.545c0.144-0.275 0.217-0.533 0.217-0.774 0-0.204-0.078-0.395-0.234-0.575s-0.353-0.27-0.59-0.27c-0.199 0-0.367 0.061-0.504 0.185s-0.265 0.294-0.384 0.511c-0.213 0.369-0.458 0.644-0.735 0.824s-0.61 0.27-0.998 0.27c-0.289 0-0.554-0.056-0.796-0.167s-0.447-0.275-0.618-0.49c-0.171-0.215-0.301-0.476-0.391-0.781s-0.135-0.64-0.135-1.005c0-0.777 0.175-1.389 0.526-1.836s0.812-0.671 1.385-0.671c0.398 0 0.726 0.090 0.984 0.27s0.505 0.45 0.742 0.81c0.133 0.185 0.252 0.318 0.359 0.401s0.24 0.124 0.401 0.124c0.246 0 0.456-0.081 0.629-0.242s0.259-0.357 0.259-0.59c0-0.227-0.077-0.472-0.231-0.735s-0.377-0.51-0.668-0.742c-0.291-0.232-0.646-0.421-1.066-0.568s-0.88-0.22-1.382-0.22c-0.81 0-1.506 0.167-2.088 0.501s-1.028 0.806-1.335 1.417-0.462 1.314-0.462 2.11c0 1.174 0.336 2.111 1.009 2.809s1.608 1.048 2.806 1.048c0.564 0 1.070-0.076 1.52-0.227s0.823-0.352 1.119-0.6c0.296-0.249 0.516-0.51 0.661-0.785z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M23.759 18.545c0.145-0.275 0.217-0.533 0.217-0.774 0-0.204-0.078-0.395-0.234-0.575s-0.353-0.27-0.59-0.27c-0.199 0-0.367 0.061-0.504 0.185s-0.265 0.294-0.384 0.511c-0.213 0.369-0.458 0.644-0.735 0.824s-0.61 0.27-0.998 0.27c-0.289 0-0.554-0.056-0.796-0.167s-0.448-0.275-0.618-0.49c-0.17-0.215-0.301-0.476-0.391-0.781s-0.135-0.64-0.135-1.005c0-0.777 0.175-1.389 0.526-1.836s0.812-0.671 1.385-0.671c0.398 0 0.726 0.090 0.984 0.27s0.506 0.45 0.742 0.81c0.133 0.185 0.252 0.318 0.359 0.401s0.24 0.124 0.401 0.124c0.246 0 0.456-0.081 0.629-0.242s0.259-0.357 0.259-0.59c0-0.227-0.077-0.472-0.231-0.735s-0.377-0.51-0.668-0.742c-0.291-0.232-0.646-0.421-1.066-0.568s-0.88-0.22-1.382-0.22c-0.81 0-1.506 0.167-2.088 0.501s-1.028 0.806-1.335 1.417-0.462 1.314-0.462 2.11c0 1.174 0.336 2.111 1.009 2.809s1.608 1.048 2.806 1.048c0.564 0 1.070-0.076 1.52-0.227s0.823-0.352 1.119-0.6 0.516-0.51 0.661-0.785z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M3 7.9c0-1.049 0.895-1.9 1.997-1.9h22.006c1.103 0 1.997 0.859 1.997 1.9v16.201c0 1.049-0.895 1.9-1.997 1.9h-22.006c-1.103 0-1.997-0.859-1.997-1.9v-16.201zM5 24.1c-0.001-0.005 22-0.005 22-0.005v-16.196c0 0.005-22 0.005-22 0.005v16.196z'%3E%3C/path%3E%3C/svg%3E\")}.playkit-icon-closed-captions-off{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M30.133 6.838l-1.143 0.863c0.007 0.065 0.011 0.131 0.011 0.198v16.201c0 1.049-0.895 1.9-1.997 1.9h-22.006c-0.080 0-0.159-0.005-0.236-0.013l-1.128 0.851c-0.463 0.349-1.121 0.257-1.471-0.206s-0.257-1.121 0.206-1.471l26.5-20c0.463-0.349 1.121-0.257 1.471 0.206s0.257 1.121-0.206 1.471zM27 9.202l-4.619 3.486c0.222 0.109 0.421 0.233 0.596 0.373 0.291 0.232 0.514 0.479 0.668 0.742s0.231 0.508 0.231 0.735c0 0.232-0.086 0.429-0.259 0.59s-0.382 0.242-0.629 0.242c-0.161 0-0.295-0.041-0.401-0.124s-0.226-0.217-0.359-0.401c-0.237-0.36-0.484-0.63-0.742-0.81-0.164-0.114-0.357-0.193-0.578-0.234l-2.249 1.697c-0.045 0.237-0.068 0.495-0.068 0.774 0 0.365 0.045 0.7 0.135 1.005s0.22 0.566 0.391 0.781c0.171 0.215 0.377 0.379 0.618 0.49s0.507 0.167 0.796 0.167c0.388 0 0.721-0.090 0.998-0.27s0.522-0.455 0.735-0.824c0.118-0.218 0.246-0.388 0.384-0.511s0.305-0.185 0.504-0.185c0.237 0 0.433 0.090 0.59 0.27s0.234 0.372 0.234 0.575c0 0.241-0.072 0.5-0.217 0.774s-0.365 0.536-0.661 0.785-0.669 0.449-1.119 0.6c-0.45 0.152-0.957 0.227-1.52 0.227-1.198 0-2.133-0.349-2.806-1.048-0.536-0.557-0.858-1.265-0.967-2.123l-1.382 1.043c-0.033 0.165-0.096 0.337-0.19 0.516-0.145 0.275-0.365 0.536-0.661 0.785s-0.669 0.449-1.119 0.6c-0.246 0.083-0.508 0.143-0.788 0.18l-5.283 3.987c5.615-0.003 19.737-0.003 19.737-0.003v-14.893z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M4.997 6h19.546l-2.492 1.903c-6.487 0.002-17.051 0.002-17.051 0.002v13.019l-2 1.527v-14.551c0-1.049 0.895-1.9 1.997-1.9z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M12.841 14.034c0.179 0.125 0.353 0.293 0.521 0.504l1.399-1.068c-0.121-0.141-0.264-0.277-0.428-0.409-0.291-0.232-0.646-0.421-1.066-0.568s-0.88-0.22-1.382-0.22c-0.81 0-1.506 0.167-2.088 0.501s-1.028 0.806-1.335 1.417-0.462 1.314-0.462 2.11c0 0.77 0.144 1.437 0.433 2.002l1.598-1.22c-0.056-0.252-0.085-0.522-0.085-0.81 0-0.777 0.175-1.389 0.526-1.836s0.812-0.671 1.385-0.671c0.398 0 0.726 0.090 0.984 0.27z'%3E%3C/path%3E%3C/svg%3E\")}@keyframes playkit-openDropmenu{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.playkit-dropdown{position:relative;font-size:15px}.playkit-dropdown .playkit-label-badge{position:relative}.playkit-dropdown .playkit-label-badge:after{top:-5px;right:-18px}.playkit-dropdown.playkit-active .playkit-dropdown-menu{display:block;opacity:1}.playkit-dropdown.playkit-active .playkit-dropdown-button .playkit-icon-arrow-down{transform:rotate(180deg)}.playkit-dropdown .playkit-dropdown-button{font-weight:bold;line-height:18px;color:#fff;cursor:pointer;padding-left:20px;display:flex}.playkit-dropdown .playkit-dropdown-button .playkit-icon{width:16px;height:16px;vertical-align:middle;margin-left:6px;transition:150ms transform;will-change:transform}.playkit-dropdown .playkit-dropdown-button>.playkit-label-badge.playkit-badge-icon{margin-right:13px}.playkit-dropdown-menu{display:block;opacity:1;position:absolute;background-color:#333333;box-shadow:0 2px 8px 0 rgba(0,0,0,0.3);border-radius:4px;padding:6px 0;z-index:5;animation:playkit-openDropmenu 100ms ease-out forwards;max-height:220px;overflow-y:auto;font-size:15px;text-align:left;font-weight:normal}.playkit-dropdown-menu.playkit-top{margin-bottom:10px;bottom:100%}.playkit-dropdown-menu.playkit-bottom{margin-top:10px;top:100%}.playkit-dropdown-menu.playkit-right{left:0}.playkit-dropdown-menu.playkit-left{right:0}.playkit-dropdown-menu.playkit-stick-bottom{bottom:-95px;margin:5px 0}.playkit-dropdown-menu .playkit-dropdown-menu-item{display:flex;justify-content:space-between;align-items:center;padding:2px 10px 2px 16px;white-space:nowrap;min-height:30px;cursor:pointer}.playkit-dropdown-menu .playkit-dropdown-menu-item:hover{color:#fff}.playkit-dropdown-menu .playkit-dropdown-menu-item.playkit-active .playkit-menu-icon-container{opacity:1}.playkit-dropdown-menu .playkit-dropdown-menu-item .playkit-icon-check-active{display:inline-block;margin-left:16px;vertical-align:middle;width:24px;height:24px}.playkit-dropdown-menu .playkit-dropdown-menu-item .playkit-menu-icon-container{opacity:0}.playkit-dropdown-menu .playkit-dropdown-menu-item>.playkit-label-badge.playkit-badge-icon{margin-right:5px}.playkit-player .playkit-control-button{width:32px;height:32px;background:transparent;display:inline-block;opacity:0.8;border:none;padding:0;cursor:pointer}.playkit-player .playkit-control-button.playkit-button-badge{position:relative}.playkit-player .playkit-control-button.playkit-button-badge:after{top:-4px;right:-1px}.playkit-player .playkit-control-button i{width:32px;height:32px}.playkit-player .playkit-control-button.playkit-active{opacity:1}.playkit-player .playkit-control-button:disabled{opacity:0.4;cursor:default}.playkit-player .playkit-control-button.playkit-control-button-rounded{width:36px;height:36px;padding:2px}.playkit-player:not(.playkit-touch) .playkit-control-button:not(:disabled):hover{opacity:1}.playkit-player:not(.playkit-touch) .playkit-control-button:not(:disabled).playkit-control-button-rounded:hover{background-color:rgba(0,0,0,0.4);border-radius:18px}.playkit-player .playkit-control-button-container{display:inline-block;position:relative;vertical-align:top}.playkit-player.playkit-touch .playkit-player .playkit-control-button-container{position:static}.playkit-player.playkit-touch .playkit-control-button{position:relative}.playkit-player.playkit-state-idle .playkit-no-idle-control{display:none}.playkit-rotate{-moz-animation:playkit-spin 0.3s 1 linear;-o-animation:playkit-spin 0.3s 1 linear;-webkit-animation:playkit-spin 0.3s 1 linear;animation:playkit-spin 0.3s 1 linear}.playkit-reverse-rotate{-moz-animation:playkit-reverse-spin 0.3s 1 linear;-o-animation:playkit-reverse-spin 0.3s 1 linear;-webkit-animation:playkit-reverse-spin 0.3s 1 linear;animation:playkit-reverse-spin 0.3s 1 linear}@-webkit-keyframes playkit-spin{0%{-webkit-transform:rotate(359deg)}100%{-webkit-transform:rotate(0deg)}}@-moz-keyframes playkit-spin{0%{-moz-transform:rotate(359deg)}100%{-moz-transform:rotate(0deg)}}@-o-keyframes playkit-spin{0%{-o-transform:rotate(359deg)}100%{-o-transform:rotate(0deg)}}@-ms-keyframes playkit-spin{0%{-ms-transform:rotate(359deg)}100%{-ms-transform:rotate(0deg)}}@keyframes playkit-spin{0%{transform:rotate(359deg)}100%{transform:rotate(0deg)}}@-webkit-keyframes playkit-reverse-spin{0%{transform:rotate(0deg)}100%{transform:rotate(359deg)}}@-moz-keyframes playkit-reverse-spin{0%{transform:rotate(0deg)}100%{transform:rotate(359deg)}}@-o-keyframes playkit-reverse-spin{0%{transform:rotate(0deg)}100%{transform:rotate(359deg)}}@-ms-keyframes playkit-reverse-spin{0%{transform:rotate(0deg)}100%{transform:rotate(359deg)}}@keyframes playkit-reverse-spin{0%{transform:rotate(0deg)}100%{transform:rotate(359deg)}}.playkit-upper-bar-icon{width:36px;height:36px;border-radius:4px;padding:2px;cursor:pointer;color:var(--playkit-tone-1-color);display:flex;align-items:center;justify-content:center;opacity:0.8;border:none;background-color:transparent;margin:0 4px}.playkit-upper-bar-icon:hover{background-color:var(--playkit-tone-4-color);opacity:1}.playkit-upper-bar-icon:active{background-color:var(--playkit-tone-6-color);opacity:1}.playkit-upper-bar-icon:disabled{opacity:0.4}.playkit-player a{font-size:15px;line-height:18px;cursor:pointer;--primary-hover-color: hsl(var(--playkit-primary-hsl-hue) var(--playkit-hsl-saturation) calc(var(--playkit-hsl-lightness) - 10%))}.playkit-player a:hover{color:var(--primary-hover-color)}.playkit-player a:active{opacity:0.7}.playkit-emptyUrl a{cursor:auto;pointer-events:none}.playkit-player{overflow:hidden;user-select:none;width:100%;height:100%;position:relative;outline:none;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;cursor:none;font-family:Lato,Helvetica Neue,Segoe UI,sans-serif}.playkit-player:-webkit-full-screen{width:100%;height:100%;max-width:none}.playkit-player *{box-sizing:border-box;outline:none}.playkit-player ::selection{background-color:rgba(0,0,0,0.1)}.playkit-player video{width:100%;left:0}.playkit-player video::-webkit-media-controls-panel-container,.playkit-player video::-webkit-media-controls{display:none !important;-webkit-appearance:none}.playkit-player video::-webkit-media-controls-start-playback-button{display:none !important;-webkit-appearance:none}.playkit-player .playkit-player-gui{overflow:hidden;font-size:0}.playkit-player .playkit-player-gui label{margin-bottom:0}.playkit-player .overlay-portal{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.playkit-player.playkit-overlay-active .overlay-portal{z-index:11;pointer-events:initial}.playkit-player.playkit-nav *:focus{outline:1px solid var(--playkit-tab-focus-color) !important}.playkit-player [id^='playkit-ads-container']{transition:transform 100ms}.playkit-player [id^='playkit-ads-container'][data-adtype='overlay']{z-index:1}.playkit-player:not(.playkit-ad-break).playkit-metadata-loaded.playkit-hover [id^='playkit-ads-container'],.playkit-player:not(.playkit-ad-break).playkit-metadata-loaded.playkit-state-paused [id^='playkit-ads-container'],.playkit-player:not(.playkit-ad-break).playkit-metadata-loaded.playkit-state-idle [id^='playkit-ads-container']{transform:translateY(-60px);-webkit-transform:translateY(-60px);-ms-transform:translateY(-60px)}.playkit-player.playkit-pre-playback,.playkit-player.playkit-casting,.playkit-player.playkit-metadata-loaded.playkit-hover,.playkit-player.playkit-state-paused,.playkit-player.playkit-state-idle,.playkit-player.playkit-ad-break,.playkit-player.playkit-menu-active,.playkit-player.playkit-overlay-active{cursor:auto}.playkit-player video::-webkit-media-text-track-container{max-height:none}.playkit-player.playkit-iOS video::-webkit-media-text-track-container{position:absolute;top:0;bottom:0;left:0;right:0}.playkit-player.playkit-state-paused video::-webkit-media-text-track-container,.playkit-player.playkit-state-idle video::-webkit-media-text-track-container,.playkit-player.playkit-hover video::-webkit-media-text-track-container{padding:0 0 50px 0}.playkit-player.playkit-state-paused.playkit-Safari video::-webkit-media-text-track-container,.playkit-player.playkit-state-paused.playkit-iOS video::-webkit-media-text-track-container,.playkit-player.playkit-state-idle.playkit-Safari video::-webkit-media-text-track-container,.playkit-player.playkit-state-idle.playkit-iOS video::-webkit-media-text-track-container,.playkit-player.playkit-hover.playkit-Safari video::-webkit-media-text-track-container,.playkit-player.playkit-hover.playkit-iOS video::-webkit-media-text-track-container{padding:initial;max-height:calc(100% - 50px)}.playkit-player.playkit-state-paused.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-display,.playkit-player.playkit-state-idle.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-display,.playkit-player.playkit-hover.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-display{transform:translateY(-50px);-webkit-transform:translateY(-50px);-ms-transform:translateY(-50px)}.playkit-player.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-container{max-height:none}.playkit-player.playkit-overlay-active .playkit-subtitles{visibility:hidden}.playkit-player .playkit-subtitles{top:50px;transform:translateY(0px);-webkit-transform:translateY(0px);-ms-transform:translateY(0px);transition:ease-in 100ms}.playkit-player:not(.playkit-overlay-active).playkit-state-paused .playkit-subtitles,.playkit-player:not(.playkit-overlay-active).playkit-state-idle .playkit-subtitles,.playkit-player:not(.playkit-overlay-active).playkit-hover .playkit-subtitles{transform:translateY(-50px);-webkit-transform:translateY(-50px);-ms-transform:translateY(-50px)}.playkit-player:not(.playkit-overlay-active).playkit-fullscreen.playkit-iOS .playkit-subtitles{transform:translateY(0px);-webkit-transform:translateY(0px);-ms-transform:translateY(0px)}.playkit-video-player{position:absolute;top:0;left:0;width:100%;height:100%;background:var(--playkit-player-background-color);transition:all 500ms;transition-property:left, right, bottom, top, width, height;display:flex}.playkit-overlay-active .playkit-video-player{filter:blur(16px)}@keyframes playkit-openOverlay{from{opacity:0}to{opacity:1}}.playkit-overlay{position:absolute;width:100%;height:100%;display:none;opacity:0;animation:playkit-openOverlay 100ms ease-in-out forwards;z-index:11}.playkit-overlay.playkit-active{display:block;opacity:1}.playkit-overlay .playkit-overlay-contents{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);z-index:4;text-align:center;color:#fff;padding:60px 20px 30px 20px;overflow-y:auto}.playkit-overlay .playkit-title{font-size:24px;font-weight:bold;line-height:29px;margin-bottom:60px}.playkit-overlay .playkit-close-overlay{position:absolute;top:48px;right:48px;z-index:5;cursor:pointer}.playkit-overlay .playkit-close-overlay .playkit-icon-close{width:24px;height:24px}.playkit-overlay .playkit-overlay-screen{display:none}.playkit-overlay .playkit-overlay-screen.playkit-active{display:block}.playkit-player.playkit-size-md .playkit-overlay .playkit-overlay-contents{padding:36px 20px}.playkit-player.playkit-size-md .playkit-overlay .playkit-close-overlay{top:38px}.playkit-player.playkit-size-md .playkit-overlay .playkit-title{margin-bottom:24px}.playkit-player.playkit-size-sm .playkit-overlay .playkit-overlay-contents,.playkit-player.playkit-size-xs .playkit-overlay .playkit-overlay-contents{padding:16px 24px}.playkit-player.playkit-size-sm .playkit-overlay .playkit-close-overlay,.playkit-player.playkit-size-xs .playkit-overlay .playkit-close-overlay{top:15px;right:24px}.playkit-player.playkit-size-sm .playkit-overlay .playkit-title,.playkit-player.playkit-size-xs .playkit-overlay .playkit-title{font-size:20px;line-height:19px;margin-bottom:24px}@keyframes playkit-openSmartContainer{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes playkit-closeSmartContainer{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(10px)}}.playkit-player:not(.playkit-touch) .playkit-smart-container{background-color:#222222;box-shadow:0 2px 8px 0 rgba(0,0,0,0.3);border-radius:4px;position:absolute;right:0px;min-width:193px;font-size:15px;z-index:10;display:block;animation:playkit-openSmartContainer 100ms ease-out forwards}.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-leaving{animation:playkit-closeSmartContainer 100ms ease-out forwards}.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-top{bottom:100%;margin-bottom:6px}.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-top:before{display:block;content:' ';position:absolute;bottom:-6px;left:0;width:100%;height:6px}.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-bottom{top:100%;margin-top:6px}.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-right{left:0px}.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-left{right:0px}.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item{margin:16px;color:rgba(244,244,244,0.8);white-space:nowrap;display:flex;justify-content:space-between}.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon{display:none}.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item select{align-self:flex-end}.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown span:not(.playkit-badge-icon){overflow:hidden;text-overflow:ellipsis;vertical-align:middle}.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item select{text-align-last:right}.playkit-player.playkit-touch .playkit-smart-container-item,.playkit-player.playkit-size-sm .playkit-smart-container-item,.playkit-player.playkit-size-xs .playkit-smart-container-item{width:300px;max-width:100%;margin:16px auto;color:rgba(244,244,244,0.8);white-space:nowrap;text-align:left;display:flex;justify-content:space-between}.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item label,.playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item label,.playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item label{font-size:16px;color:rgba(255,255,255,0.8);margin-right:20px}.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon,.playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon,.playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon{width:24px;height:24px;display:inline-block;vertical-align:middle;margin-right:16px}.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item select,.playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,.playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item select,.playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,.playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item select{align-self:flex-end}.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item select,.playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item select,.playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item select{text-align-last:right;min-width:1px;line-height:24px}.playkit-player.playkit-touch.playkit-Windows select option,.playkit-player.playkit-size-sm.playkit-Windows select option,.playkit-player.playkit-size-xs.playkit-Windows select option{color:black;background-color:white}.playkit-overlay.playkit-cvaa-overlay .playkit-sample{border:2px solid rgba(255,255,255,0.2);border-radius:4px;font-size:16px;font-weight:bold;line-height:36px;text-align:center;padding:0 31px;display:inline-block;margin:0 12px;position:relative}.playkit-overlay.playkit-cvaa-overlay .playkit-sample:not(.playkit-custom){cursor:pointer}.playkit-overlay.playkit-cvaa-overlay .playkit-sample.playkit-black-bg{background-color:#000}.playkit-overlay.playkit-cvaa-overlay .playkit-sample.playkit-yellow-text{color:#faff00}.playkit-overlay.playkit-cvaa-overlay .playkit-sample .playkit-active-tick{height:16px;width:16px;border-radius:8px;background-color:var(--playkit-primary-color);position:absolute;top:-5px;right:-5px}.playkit-overlay.playkit-cvaa-overlay .playkit-sample .playkit-active-tick .playkit-icon{vertical-align:top}.playkit-overlay.playkit-cvaa-overlay .playkit-sample span{font-size:16px !important;line-height:1;vertical-align:middle}.playkit-overlay.playkit-cvaa-overlay .playkit-button-save-cvaa{margin-top:50px;height:40px;width:400px;max-width:100%;border:2px solid rgba(255,255,255,0.2);border-radius:4px;font-size:16px;font-weight:bold;line-height:38px;text-align:center;display:inline-block;color:#fff;text-decoration:none;cursor:pointer}.playkit-overlay.playkit-cvaa-overlay .playkit-custom-captions-applied{margin-top:50px}.playkit-overlay.playkit-cvaa-overlay .playkit-custom-captions-applied a{color:var(--playkit-primary-brighter-color)}.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form{width:300px;max-width:100%;margin:0 auto}.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form a{color:white;line-height:36px;text-decoration:none}.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form a:hover,.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form a:focus{text-decoration:underline}.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form .playkit-slider{float:right;width:100px;margin-top:5px}.playkit-overlay.playkit-cvaa-overlay .playkit-preview-container{width:100%;text-align:center;font-size:16px}.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample{width:30%;margin:2.33%;padding:0}.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample:first-child{margin-left:0}.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample:last-child{margin-right:0}.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample.playkit-custom{width:auto;padding:0 10px}.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-button-save-cvaa,.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-custom-captions-applied{margin-top:20px}.playkit-font-size,.playkit-font-color,.playkit-font-family,.playkit-font-style,.playkit-font-opacity,.playkit-background-color,.playkit-background-opacity{background:initial}.playkit-loading-backdrop{position:absolute;top:50%;left:50%;transition:100ms opacity;opacity:0;z-index:5}.playkit-loading-backdrop.playkit-show{opacity:1}.playkit-loading-backdrop.playkit-show .playkit-spinner-container{display:block}.playkit-loading-backdrop .playkit-spinner-container{display:none;position:absolute;top:50%;left:50%;transform:translate3d(-50%, -50%, 0)}.playkit-control-button-container.playkit-control-play-pause .playkit-control-button{transition:400ms transform}.playkit-control-button-container.playkit-control-play-pause .playkit-control-button .playkit-icon-pause{transition:400ms opacity;opacity:0;display:none}.playkit-control-button-container.playkit-control-play-pause .playkit-control-button .playkit-icon-play{transition:400ms opacity;opacity:1;display:block}.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing{transform:rotate(360deg)}.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing .playkit-icon-pause{opacity:1;display:block}.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing .playkit-icon-play{opacity:0;display:none}.playkit-control-button-container.playkit-control-volume,.playkit-control-button-container.playkit-volume-control{display:inline-block !important}.playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-volume-control-bar,.playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-volume-control-bar{display:block !important}.playkit-control-button-container.playkit-control-volume.playkit-is-muted .playkit-icon-volume-waves,.playkit-control-button-container.playkit-volume-control.playkit-is-muted .playkit-icon-volume-waves{opacity:0;-webkit-transform:translateX(-5px);-ms-transform:translateX(-5px);transform:translateX(-5px)}.playkit-control-button-container.playkit-control-volume.playkit-is-muted .playkit-icon-volume-mute,.playkit-control-button-container.playkit-volume-control.playkit-is-muted .playkit-icon-volume-mute{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.playkit-control-button-container.playkit-control-volume.playkit-dragging-active .playkit-volume-control-bar,.playkit-control-button-container.playkit-volume-control.playkit-dragging-active .playkit-volume-control-bar{display:block}.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-waves,.playkit-control-button-container.playkit-volume-control .playkit-icon-volume-waves{-webkit-transform:translateX(0px);-ms-transform:translateX(0px);transform:translateX(0px)}.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-mute,.playkit-control-button-container.playkit-volume-control .playkit-icon-volume-mute{opacity:1;-webkit-transform:scale(0);-ms-transform:scale(0);transform:scale(0)}.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-waves,.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-mute,.playkit-control-button-container.playkit-volume-control .playkit-icon-volume-waves,.playkit-control-button-container.playkit-volume-control .playkit-icon-volume-mute{transition:300ms transform, 300ms opacity}.playkit-control-button-container.playkit-control-volume i,.playkit-control-button-container.playkit-volume-control i{position:absolute;top:0;left:0}.playkit-volume-control-bar{position:absolute;z-index:2;bottom:38px;left:0;height:112px;width:34px;border-radius:4px;box-shadow:0 2px 8px 0 rgba(0,0,0,0.3);background-color:#333333;padding:6px;display:none}.playkit-volume-control-bar:before{position:absolute;width:34px;height:14px;bottom:-8px;left:0;content:' ';display:block}.playkit-volume-control-bar .playkit-bar{background-color:#424242;height:100%;position:relative;cursor:pointer}.playkit-volume-control-bar .playkit-progress{position:absolute;bottom:0;left:0;width:100%;border-radius:0 0 2px 2px;background-color:var(--playkit-primary-color)}.playkit-player.playkit-smart-container-open .playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-control-volume-bar,.playkit-player.playkit-smart-container-open .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-control-volume-bar{display:none !important}.playkit-size-ty .playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-control-volume-bar,.playkit-size-ty .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-control-volume-bar{display:none !important}.playkit-touch .playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-control-volume-bar,.playkit-touch .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-control-volume-bar{display:none !important}.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button{transition:100ms transform;transform:scale(1)}.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button .playkit-icon-minimize{display:none}.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-maximize{display:none}.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-minimize{display:block}.playkit-player:not(.playkit-touch) .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button:hover{transform:scale(1.1)}.playkit-player .playkit-seek-bar{padding:12px 0 12px 0;cursor:pointer;position:relative}.playkit-player .playkit-seek-bar:hover .playkit-time-preview,.playkit-player .playkit-seek-bar:hover .playkit-frame-preview:not(.playkit-hide-frame-preview),.playkit-player .playkit-seek-bar.playkit-hover .playkit-time-preview,.playkit-player .playkit-seek-bar.playkit-hover .playkit-frame-preview:not(.playkit-hide-frame-preview){display:block}.playkit-player .playkit-seek-bar:hover .playkit-progress-bar .playkit-scrubber,.playkit-player .playkit-seek-bar.playkit-hover .playkit-progress-bar .playkit-scrubber{transform:scale(1)}.playkit-player .playkit-seek-bar:hover .playkit-progress-bar .playkit-virtual-progress,.playkit-player .playkit-seek-bar.playkit-hover .playkit-progress-bar .playkit-virtual-progress{display:block}.playkit-player .playkit-seek-bar.playkit-ad-break{cursor:initial}.playkit-player .playkit-seek-bar.playkit-ad-break .playkit-progress-bar .playkit-progress{background-color:var(--playkit-ads-color)}.playkit-player .playkit-seek-bar.playkit-live .playkit-progress-bar .playkit-progress{background-color:var(--playkit-live-color)}.playkit-player .playkit-seek-bar .playkit-progress-bar{width:100%;height:4px;background-color:rgba(255,255,255,0.3);border-radius:2px;position:absolute;transition:height 200ms ease, transform 200ms ease}.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-progress{position:absolute;top:0;left:0;height:100%;border-radius:inherit;background-color:var(--playkit-primary-color)}.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress{display:none}.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-buffered,.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress{position:absolute;top:0;left:0;height:100%;border-radius:inherit}.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-buffered{background-color:rgba(255,255,255,0.3)}.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress-indicator{width:1px;height:100%;background-color:var(--playkit-tone-1-color);float:right}.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-scrubber{position:absolute;cursor:pointer;display:block;top:-6px;right:-8px;border-radius:8px;height:16px;width:16px;background-color:var(--playkit-tone-1-color);box-shadow:0 0 31px 0 rgba(0,0,0,0.3);transform:scale(0);transition:100ms transform;z-index:1;pointer-events:none}.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-scrubber:active{opacity:1;cursor:grabbing}.playkit-player .playkit-seek-bar .playkit-frame-preview{position:absolute;bottom:20px;left:0}.playkit-player .playkit-seek-bar .playkit-time-preview{position:absolute;bottom:26px;left:0;height:22px;min-width:48px;padding:0 3px;text-align:center;border-radius:3px;background-color:rgba(0,0,0,0.7);font-size:13px;font-weight:bold;line-height:22px;color:#fff;z-index:1;pointer-events:none}.playkit-player .playkit-seek-bar .playkit-time-preview,.playkit-player .playkit-seek-bar .playkit-frame-preview{display:none}.playkit-player .playkit-seek-bar .playkit-non-sticky:hover{display:none}.playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar:hover .playkit-progress-bar,.playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar.playkit-hover .playkit-progress-bar{height:8px;border-radius:4px;transform:translateY(-2px)}.playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar:hover .playkit-progress-bar .playkit-scrubber,.playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar.playkit-hover .playkit-progress-bar .playkit-scrubber{top:-4px}.playkit-player.playkit-touch .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress,.playkit-player.playkit-touch .playkit-seek-bar .playkit-progress-bar .playkit-time-preview,.playkit-player.playkit-touch .playkit-seek-bar .playkit-progress-bar .playkit-frame-preview{display:none}.playkit-player.playkit-size-ty .playkit-seek-bar{padding:12px 0;cursor:pointer;position:relative;float:left;width:calc(100% - 45px);margin:1px 0}.playkit-player.playkit-size-ty .playkit-seek-bar .playkit-frame-preview{display:none}.playkit-player.playkit-size-ty .playkit-seek-bar .playkit-time-preview{bottom:16px}.playkit-frame-preview .playkit-frame-preview-img-container{border:2px solid rgba(255,255,255,0.2);border-radius:4px}.playkit-frame-preview .playkit-frame-preview-img-container .playkit-frame-preview-img{background-size:auto 100%;width:100%;height:100%;position:relative}.playkit-player .playkit-time-display{display:inline-block;line-height:32px;vertical-align:top;font-size:14px;padding:0 23px;font-weight:bold}.playkit-touch .playkit-time-display{padding-left:0}.playkit-player.playkit-size-md .playkit-time-display{padding:0 12px}.playkit-player.playkit-size-xs .playkit-time-display,.playkit-player.playkit-size-sm .playkit-time-display{padding:0 12px 0 0}.playkit-player .playkit-video-playing-title{font-size:15px;font-weight:bold;line-height:18px;padding:6px 0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.playkit-player .playkit-bottom-bar{background:linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.6) 100%);color:#fff;visibility:hidden;height:auto;max-height:0;transition:100ms max-height ease-in-out,100ms visibility ease-in-out,0ms padding linear 100ms;width:100%;margin-top:auto;bottom:0;left:0;z-index:1;pointer-events:auto;position:relative;padding:0}.playkit-player .playkit-bottom-bar.playkit-hide{display:none}.playkit-player .playkit-bottom-bar .playkit-left-controls{float:left;text-align:left;pointer-events:none}.playkit-player .playkit-bottom-bar .playkit-left-controls .playkit-control-button-container:first-child{margin-left:0px}.playkit-player .playkit-bottom-bar .playkit-bottom-bar-area{position:relative;pointer-events:none}.playkit-player .playkit-bottom-bar .playkit-right-controls{float:right;text-align:left;pointer-events:none}.playkit-player .playkit-bottom-bar .playkit-right-controls .playkit-control-button-container:last-child{margin-right:0px}.playkit-player .playkit-bottom-bar .playkit-control-button-container{margin:0 6px}.playkit-player.playkit-size-ty .playkit-left-controls{display:none}.playkit-player.playkit-size-ty .playkit-control-button-container{display:none;margin:0}.playkit-player.playkit-size-xs .playkit-left-controls .playkit-control-button-container{display:none}.playkit-player.playkit-size-xs .playkit-control-button-container,.playkit-player.playkit-size-sm .playkit-control-button-container{margin:0 3px}.playkit-player.playkit-casting:not(.playkit-overlay-active) .playkit-bottom-bar,.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active) .playkit-bottom-bar,.playkit-player.playkit-state-paused:not(.playkit-overlay-active) .playkit-bottom-bar,.playkit-player.playkit-state-idle:not(.playkit-overlay-active) .playkit-bottom-bar,.playkit-player.playkit-ad-break:not(.playkit-overlay-active) .playkit-bottom-bar,.playkit-player.playkit-menu-active:not(.playkit-overlay-active) .playkit-bottom-bar{visibility:visible;padding:0 16px 4px;max-height:60px;transition:100ms max-height ease-in-out,100ms visibility ease-in-out}.playkit-player.playkit-casting:not(.playkit-overlay-active) .playkit-bottom-bar.playkit-line-break,.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active) .playkit-bottom-bar.playkit-line-break,.playkit-player.playkit-state-paused:not(.playkit-overlay-active) .playkit-bottom-bar.playkit-line-break,.playkit-player.playkit-state-idle:not(.playkit-overlay-active) .playkit-bottom-bar.playkit-line-break,.playkit-player.playkit-ad-break:not(.playkit-overlay-active) .playkit-bottom-bar.playkit-line-break,.playkit-player.playkit-menu-active:not(.playkit-overlay-active) .playkit-bottom-bar.playkit-line-break{max-height:92px}.playkit-player.playkit-size-sm .playkit-bottom-bar{padding:0 8px 4px}.playkit-player.playkit-size-sm .playkit-bottom-bar .playkit-time-display{padding-left:0}.playkit-player .playkit-bottom-bar .playkit-left-controls>*,.playkit-player .playkit-bottom-bar .playkit-right-controls>*,.playkit-player .playkit-bottom-bar .playkit-bottom-bar-area>*{pointer-events:auto}.playkit-player .playkit-top-bar{background:linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.6) 100%);color:#fff;visibility:hidden;position:relative;height:auto;min-height:60px;max-height:60px;margin-top:-60px;transition:100ms visibility ease-in-out,100ms margin-top ease-in-out,100ms min-height ease-in-out;width:100%;top:0;left:0;z-index:1;pointer-events:auto}.playkit-player .playkit-top-bar .playkit-top-bar-area{position:absolute;top:0;left:0;height:calc(100% - 28px);width:calc(100% - 32px);margin:14px 16px;pointer-events:none}.playkit-player .playkit-top-bar .playkit-top-bar-area:empty{margin:0;height:0;width:0}.playkit-player .playkit-top-bar.playkit-disabled{pointer-events:none}.playkit-player .playkit-top-bar.playkit-hide{display:none}.playkit-player .playkit-top-bar .playkit-left-controls{float:left;text-align:left;min-width:0;margin:14px 0 14px 16px;pointer-events:none}.playkit-player .playkit-top-bar .playkit-left-controls:empty{margin:0}.playkit-player .playkit-top-bar .playkit-right-controls{float:right;text-align:left;margin:14px 16px 14px 0;pointer-events:none}.playkit-player .playkit-top-bar .playkit-right-controls:empty{margin:0}.playkit-player .playkit-top-bar .playkit-right-controls .playkit-control-button-container{margin:0 6px}.playkit-player .playkit-top-bar .playkit-right-controls .playkit-control-button-container:last-child{margin-right:0}.playkit-player.playkit-casting:not(.playkit-overlay-active) .playkit-top-bar,.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active) .playkit-top-bar,.playkit-player.playkit-state-paused:not(.playkit-overlay-active) .playkit-top-bar,.playkit-player.playkit-state-idle:not(.playkit-overlay-active) .playkit-top-bar,.playkit-player.playkit-ad-break:not(.playkit-overlay-active) .playkit-top-bar,.playkit-player.playkit-menu-active:not(.playkit-overlay-active) .playkit-top-bar{visibility:visible;margin-top:0;min-height:16px}.playkit-player .playkit-top-bar .playkit-left-controls>*,.playkit-player .playkit-top-bar .playkit-right-controls>*,.playkit-player .playkit-top-bar .playkit-top-bar-area>*{pointer-events:auto}.playkit-player.playkit-size-sm .playkit-top-bar .playkit-left-controls{margin:14px 0 14px 8px}.playkit-player.playkit-size-sm .playkit-top-bar .playkit-left-controls:empty{margin:0}.playkit-player.playkit-size-sm .playkit-top-bar .playkit-right-controls{margin:14px 8px 14px 0}.playkit-player.playkit-size-sm .playkit-top-bar .playkit-right-controls:empty{margin:0}.playkit-player.playkit-size-sm .playkit-top-bar .playkit-top-bar-area{width:calc(100% - 16px);margin:14px 8px}.playkit-player.playkit-size-sm .playkit-top-bar .playkit-top-bar-area:empty{margin:0}@keyframes playkit-overlayActionIconIn{0%{opacity:0;transform:scale(0)}10%{opacity:0.1;transform:scale(0.1)}20%{opacity:0.3;transform:scale(0.2)}30%{opacity:0.5;transform:scale(0.3)}40%{opacity:0.7;transform:scale(0.4)}50%{opacity:0.9;transform:scale(0.5)}60%{opacity:0.9;transform:scale(0.5)}70%{opacity:0.9;transform:scale(0.5)}75%{opacity:0.9;transform:scale(0.5)}80%{opacity:1;transform:scale(0.5)}85%{opacity:1;transform:scale(0.5)}90%{opacity:1;transform:scale(0.5)}93%{opacity:0.7;transform:scale(0.5)}95%{opacity:0.5;transform:scale(0.5)}98%{opacity:0.2;transform:scale(0.5)}100%{opacity:0;transform:scale(0.5)}}.playkit-overlay-action .playkit-icon{width:144px;height:144px;position:absolute;top:50%;left:50%;margin:-72px 0 0 -72px;opacity:0}.playkit-player:not(.playkit-touch):not(.playkit-size-sm) .playkit-overlay-action.playkit-in .playkit-icon{animation:playkit-overlayActionIconIn 300ms linear forwards}.playkit-pre-playback-play-overlay{position:absolute;top:0;left:0;width:100%;height:100%}.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button{z-index:1;position:absolute;top:50%;left:50%;height:108px;width:108px;border:2px solid rgba(255,255,255,0.2);background-color:rgba(0,0,0,0.5);transform:translate(-50%, -50%);-webkit-transform:translate(-50%, -50%);-ms-transform:translate(-50%, -50%);border-radius:54px;padding:20px;cursor:pointer}.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button:hover{border:2px solid rgba(255,255,255,0.4)}.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button:active{opacity:0.7;transform:scale(1) translate(-50%, -50%)}.playkit-pre-playback .playkit-bottom-bar,.playkit-pre-playback .playkit-top-bar{opacity:0;display:none}.playkit-player.playkit-size-ty .playkit-pre-playback-play-button{width:75px;height:75px;padding:12px}.playkit-player.playkit-size-xs .playkit-pre-playback-play-button{width:85px;height:85px;padding:15px}.playkit-player .playkit-btn-skip-ad{font-weight:lighter;position:absolute;bottom:60px;right:16px;line-height:36px}.playkit-player .playkit-skip-ad{color:#fff;font-size:20px;font-weight:lighter;line-height:24px;text-shadow:0 0 6px rgba(0,0,0,0.6);position:absolute;bottom:66px;right:16px}.playkit-row{display:block}.playkit-row:after{content:'';clear:both;display:block}.playkit-d-inline-block{display:inline-block}.playkit-mobile-hidden-select{display:block;opacity:0;position:absolute;top:0;left:0px;width:100%;height:100%}.playkit-font-size-base,.playkit-ad-notice{font-size:15px}.playkit-ad-notice{pointer-events:none}.playkit-live-tag{display:inline-block;background-color:var(--playkit-live-color);color:#FFFFFF;border-radius:4px;padding:3px 4px;margin:5px 10px;text-transform:uppercase;font-size:15px;cursor:default}.playkit-live-tag.playkit-non-live-playhead{background-color:#666666;cursor:pointer}.playkit-player.playkit-size-sm .playkit-live-tag{margin-left:0}.playkit-interactive-area .playkit-unmute-button-container{top:0;left:0}.playkit-unmute-button-container{display:inline-block;position:absolute;top:16px;left:16px;z-index:15}.playkit-unmute-button-container a{color:#fff}.playkit-unmute-button-container.playkit-show-icon-only .playkit-btn.playkit-unmute-button{max-width:64px}.playkit-unmute-button-container.playkit-show-icon-only .playkit-btn.playkit-unmute-button span{transform:translateX(10px);opacity:0}.playkit-btn.playkit-unmute-button{font-size:15px;max-width:200px;transition:max-width 200ms;padding:0 16px;white-space:nowrap}.playkit-btn.playkit-unmute-button span{transform:translateX(0px);opacity:1;transition:transform 100ms, opacity 100ms;display:inline-block;color:#fff}.playkit-btn.playkit-unmute-button.playkit-has-top-bar{transition:100ms transform}.playkit-unmute-icon-container{width:32px;height:32px;display:inline-block;vertical-align:top;position:relative;margin-right:3px}.playkit-unmute-icon-container i{position:absolute;top:0;left:0}.playkit-player.playkit-hover .playkit-unmute-button-container.playkit-has-top-bar,.playkit-player.playkit-state-paused .playkit-unmute-button-container.playkit-has-top-bar,.playkit-player.playkit-state-idle .playkit-unmute-button-container.playkit-has-top-bar,.playkit-player.playkit-menu-active .playkit-unmute-button-container.playkit-has-top-bar{transform:translateY(32px)}.playkit-overlay.playkit-error-overlay{background-color:var(--playkit-tone-7-color);font-size:0em}.playkit-overlay-contents .playkit-error-overlay{padding-top:20px}.playkit-error-overlay{position:relative;display:flex;justify-content:center;align-items:center;flex-direction:column;height:100%}.playkit-error-overlay .playkit-copy-url-row{display:flex;margin-bottom:10px}.playkit-error-overlay .playkit-svg-container{flex:4;display:flex;justify-content:space-around;flex-flow:column}.playkit-error-overlay .playkit-headline{color:var(--playkit-tone-1-color);font-size:18px;margin:10px 0 14px 0;flex:1}.playkit-error-overlay .playkit-error-session{font-size:14px;color:var(--playkit-tone-2-color);margin:auto;user-select:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;max-width:300px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1 1 auto}.playkit-error-overlay .playkit-control-button-container{flex:5}.playkit-error-overlay .playkit-retry-btn{height:36px;width:auto;min-width:120px;padding:0 8px;border:2px solid var(--playkit-tone-7-color);border-radius:18px;background-color:black;color:var(--playkit-tone-1-color);font-size:15px;font-weight:bold;line-height:32px;cursor:pointer}.playkit-error-overlay .playkit-error-text{height:0px;visibility:hidden}.playkit-link-options-container{width:auto}.playkit-link-options-container .playkit-copy-url-row .playkit-input-copy-url{margin:0}.playkit-link-options-container .playkit-copy-url-row .playkit-btn-copy-url{margin-left:8px;height:32px;width:32px}.playkit-link-options-container .playkit-copy-url-row .playkit-btn-copy-url .playkit-icon{height:24px;width:24px;margin-top:-3px}.playkit-slider{height:8px;border-radius:4px;background-color:rgba(255,255,255,0.2)}.playkit-slider .playkit-progress{background-color:var(--playkit-primary-color);height:8px;border-radius:4px;position:relative}.playkit-slider .playkit-progress .playkit-handle{height:12px;width:12px;border-radius:5px;background-color:#ffffff;box-shadow:0 2px 8px 0 rgba(0,0,0,0.3);position:absolute;right:0;top:0px;transform:translate3d(6px, -2px, 0);cursor:pointer}.playkit-player .playkit-learn-more{font-weight:lighter}.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button{transition:100ms transform;transform:scale(1)}.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button .playkit-icon-minimize{display:none}.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-maximize{display:none}.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-minimize{display:block}.playkit-player:not(.playkit-touch) .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button:hover{transform:scale(1.1)}.playkit-player .playkit-watermark{position:absolute;transition:visibility 0s 1s, opacity 1s linear, transform ease-out 100ms}.playkit-player .playkit-watermark.playkit-hide-watermark{visibility:hidden;opacity:0}.playkit-player .playkit-watermark.playkit-top{top:0}.playkit-player .playkit-watermark.playkit-bottom{bottom:0}.playkit-player .playkit-watermark.playkit-right{right:0}.playkit-player .playkit-watermark.playkit-left{left:0}.playkit-player a:not([href]).playkit-advanced-captions-menu-link{color:var(--playkit-tone-1-color);text-decoration:underline}.playkit-control-button-container.playkit-control-vr-stereo .playkit-control-button .playkit-icon-vr-stereo-full{display:none}.playkit-control-button-container.playkit-control-vr-stereo .playkit-control-button.playkit-vr-stereo-mode .playkit-icon-vr-stereo{display:none}.playkit-control-button-container.playkit-control-vr-stereo .playkit-control-button.playkit-vr-stereo-mode .playkit-icon-vr-stereo-full{display:block}.playkit-control-button-container.playkit-control-closed-captions .playkit-control-button .playkit-icon-closed-captions-on{display:none}.playkit-control-button-container.playkit-control-closed-captions .playkit-control-button.playkit-cc-on .playkit-icon-closed-captions-off{display:none}.playkit-control-button-container.playkit-control-closed-captions .playkit-control-button.playkit-cc-on .playkit-icon-closed-captions-on{display:block}.playkit-player .playkit-cast-button{display:block;width:28px;height:30px;background-color:rgba(255,255,255,0);border:none;cursor:pointer;--connected-color: var(--playkit-tone-2-color);--disconnected-color: var(--playkit-tone-2-color)}.playkit-player .playkit-cast-button:hover{--connected-color: #ffffffff;--disconnected-color: #ffffffff}.playkit-player .playkit-cast-button.playkit-cast-button-active{--connected-color: rgba(1, 172, 205, 0.8)}.playkit-player .playkit-cast-button.playkit-cast-button-active:hover{--connected-color: var(--playkit-primary-color)}.playkit-player .playkit-cast-overlay{position:absolute;top:0;left:0;width:100%;height:100%}.playkit-player .playkit-cast-overlay .playkit-cast-poster{all:inherit;background-size:contain;background:black no-repeat center center}.playkit-player .playkit-cast-overlay .playkit-cast-poster.playkit-has-poster{background-color:#000}.playkit-player .playkit-cast-overlay .playkit-cast-black-cover{all:inherit;background:linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0) 72%, rgba(0,0,0,0) 100%)}.playkit-player .playkit-cast-box .playkit-cast-icon{position:absolute;bottom:0;left:46px;height:128px}.playkit-player .playkit-cast-box .playkit-cast-icon .playkit-icon{width:30px;height:22px;color:rgba(255,255,255,0.6);opacity:0.6}.playkit-player .playkit-cast-box .playkit-cast-connecting-spinner{height:21px;width:21px;-webkit-animation:playkit-spin 0.9s infinite linear;border:3px solid rgba(255,255,255,0.4);border-top-color:rgba(255,255,255,0.8);border-radius:100%}.playkit-player .playkit-cast-box .playkit-cast-text{position:absolute;bottom:0;left:89px;height:128px;font-weight:lighter}.playkit-player .playkit-cast-box .playkit-cast-text .playkit-cast-status{display:inline-block;margin-top:3px;font-size:16px;color:rgba(255,255,255,0.6);float:left;font-weight:inherit}.playkit-player .playkit-cast-box .playkit-cast-text .playkit-cast-device{left:0;display:inline-block;font-weight:inherit;font-size:25px;color:#ffffff;line-height:40px}@keyframes playkit-castOnTVAnimation{0%{opacity:0;transform:rotateY(70deg)}33%{opacity:0.3;transform:rotateY(50deg)}66%{opacity:0.6;transform:rotateY(30deg)}100%{opacity:1;transform:rotateY(0)}}.playkit-player .playkit-cast-on-tv-button-container{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0}.playkit-player .playkit-cast-on-tv-button-container span{font-weight:lighter;color:white}.playkit-player .playkit-cast-on-tv-button-container.playkit-show-cast-on-tv{animation:playkit-castOnTVAnimation 300ms linear forwards}.playkit-player .playkit-btn.playkit-cast-on-tv-button{font-size:15px;max-width:200px;transition:max-width 200ms;padding:0 16px;white-space:nowrap;position:absolute;bottom:0;transform:translate(-50%, -50%);left:50%}.playkit-player .playkit-btn.playkit-cast-on-tv-button span{transform:translateX(0px);opacity:1;transition:transform 100ms, opacity 100ms;display:inline-block}.playkit-player .playkit-cast-on-tv-icon-container{width:32px;height:32px;display:inline-block;vertical-align:top;position:relative;margin-right:3px}.playkit-player .playkit-cast-on-tv-icon-container i{position:absolute;top:0;left:0}.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview{position:absolute;bottom:35px;width:280px;height:72px;display:flex;border-radius:4px;box-shadow:0px 0px 0px 1px rgba(0,0,0,0.2),0px 8px 60px -16px rgba(0,0,0,0.2);opacity:0;transition:400ms opacity;pointer-events:none}.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview:hover{opacity:0 !important}.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-img{width:128px;height:inherit;border-radius:4px 0 0 4px;background-size:contain;background-repeat:round}.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-text{width:152px;height:inherit;padding:8px;background-color:rgba(0,0,0,0.7);border-radius:0 4px 4px 0}.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-text .playkit-poster-preview-text-title{font-size:14px;font-weight:400;margin-bottom:3px;opacity:0.7}.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-text .playkit-poster-preview-text-name{font-size:15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:400}.playkit-control-button-container.playkit-control-playlist-button:hover .playkit-poster-preview{opacity:1}.playkit-icon-picture-in-picture-stop{display:none}.playkit-is-in-picture-in-picture .playkit-icon-picture-in-picture-start{display:none}.playkit-is-in-picture-in-picture .playkit-icon-picture-in-picture-stop{display:block}.playkit-player-gui>.playkit-playback-controls,.playkit-center-playback-controls{display:none;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);-webkit-transform:translate(-50%, -50%);-ms-transform:translate(-50%, -50%);white-space:nowrap;z-index:1}.playkit-bottom-bar .playkit-playback-controls{display:inline}.playkit-player.playkit-size-sm.playkit-state-idle .playkit-control-playlist-button,.playkit-player.playkit-size-xs.playkit-state-idle .playkit-control-playlist-button,.playkit-player.playkit-touch.playkit-state-idle .playkit-control-playlist-button{display:none}.playkit-player.playkit-size-sm:not(.playkit-state-idle) .playkit-bottom-bar .playkit-playback-controls,.playkit-player.playkit-size-xs:not(.playkit-state-idle) .playkit-bottom-bar .playkit-playback-controls,.playkit-player.playkit-touch:not(.playkit-state-idle) .playkit-bottom-bar .playkit-playback-controls{display:none}.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-player-gui>.playkit-playback-controls,.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls,.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-player-gui>.playkit-playback-controls,.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls,.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-player-gui>.playkit-playback-controls,.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls{display:block}.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-player-gui>.playkit-playback-controls .playkit-control-button,.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-control-button,.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-player-gui>.playkit-playback-controls .playkit-control-button,.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-control-button,.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-player-gui>.playkit-playback-controls .playkit-control-button,.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-control-button{width:auto;height:auto;padding:0 16px;-webkit-filter:drop-shadow(0px 0px 8px rgba(0,0,0,0.5));filter:drop-shadow(0px 0px 8px rgba(0,0,0,0.5))}.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-player-gui>.playkit-playback-controls .playkit-icon,.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-icon,.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-player-gui>.playkit-playback-controls .playkit-icon,.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-icon,.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-player-gui>.playkit-playback-controls .playkit-icon,.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-icon{width:64px;height:64px}.playkit-player.playkit-overlay-active .playkit-gui-area .playkit-playback-controls{opacity:0;visibility:hidden}@keyframes playkit-slideIn{0%{right:-160px}100%{right:0}}.playkit-player .playkit-playlist-countdown{display:flex;height:72px;position:absolute;right:0;bottom:0;border-radius:4px;transition:opacity 400ms, bottom 300ms;cursor:pointer;box-shadow:0px 0px 0px 1px rgba(0,0,0,0.2),0px 8px 60px -16px rgba(0,0,0,0.2)}.playkit-player .playkit-playlist-countdown.playkit-slideIn{right:-160px;animation:playkit-slideIn 500ms 500ms forwards}.playkit-player .playkit-playlist-countdown.playkit-hidden{pointer-events:none;opacity:0}.playkit-player .playkit-playlist-countdown.playkit-hidden .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background{width:0}.playkit-player .playkit-playlist-countdown.playkit-hidden .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content{opacity:0}.playkit-player .playkit-playlist-countdown.playkit-canceled{bottom:-50px;opacity:0}.playkit-player .playkit-playlist-countdown:hover .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background{background-color:#000000}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-poster{width:128px;height:inherit;border-radius:4px 0 0 4px;background-size:contain;background-repeat:round}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder{width:152px;height:inherit}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background{width:inherit;border-radius:0 4px 3px 0;background-color:rgba(0,0,0,0.7);height:inherit;transition:width 500ms 1000ms}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content{width:inherit;transition:opacity 300ms 1200ms}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text{width:100%;padding:10px;font-size:14px;font-weight:400;text-align:left;color:#fff;float:left;line-height:initial}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title{margin-bottom:12px;opacity:0.7}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title .playkit-playlist-countdown-time-left{display:inline;margin-left:4px}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel{position:absolute;top:5px;right:5px;width:24px;height:24px}.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel *{width:inherit;height:inherit}.playkit-player.playkit-size-md .playkit-playlist-countdown{height:54px}.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-poster{width:96px}.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder{width:152px}.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text{padding:8px}.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title{margin-bottom:4px}.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel{top:3px;right:3px}.playkit-player.playkit-size-sm .playkit-playlist-countdown,.playkit-player.playkit-size-xs .playkit-playlist-countdown,.playkit-player.playkit-size-ty .playkit-playlist-countdown{z-index:1;height:36px;margin:8px}.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-poster,.playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-poster,.playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-poster{display:none}.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder,.playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder,.playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder{width:108px}.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background,.playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background,.playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background{transition:width 500ms;border-radius:2px}.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text,.playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text,.playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text{width:90%;padding:3px 0 0 4px}.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title,.playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title,.playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title{font-size:12px;margin-bottom:0}.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name,.playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name,.playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name{font-size:12px;font-weight:400}.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel,.playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel,.playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel{top:0;right:0}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay{position:absolute;width:100%;height:100%;background-color:rgba(0,0,0,0.5)}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content{position:relative;top:50%;transform:translateY(-50%)}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text{position:absolute;width:100%;top:-90px;font-size:15px;color:#fff;padding:4px 8px 12px 8px;text-align:center}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text .playkit-playlist-next-screen-text-title{padding:4px;font-weight:100}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text .playkit-playlist-next-screen-text-name{padding:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder{position:relative;margin:auto;width:384px}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio{width:100%;padding-top:56%}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster{position:absolute;top:0;left:0;bottom:0;right:0;border:2px solid rgba(255,255,255,0.2);border-radius:4px;cursor:pointer}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img{height:100%;border-radius:3px;background-size:contain;background-repeat:round}.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);width:64px;height:64px}.playkit-player.playkit-state-idle.playkit-size-lg .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder{width:37.5%}.playkit-player.playkit-state-idle.playkit-size-md .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text{top:-58px}.playkit-player.playkit-state-idle.playkit-size-md .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text .playkit-playlist-next-screen-text-name{padding:0}.playkit-player.playkit-state-idle.playkit-size-md .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder{width:42%}.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder,.playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder,.playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder{width:32px}.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster,.playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster,.playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster{border:0}.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img,.playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img,.playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img{display:none}.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon,.playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon,.playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon{width:32px;height:32px}.playkit-picture-in-picture-overlay{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center}.playkit-picture-in-picture-overlay .playkit-picture-in-picture-poster{all:inherit;background-size:contain;background:black no-repeat center center}.playkit-picture-in-picture-overlay .playkit-picture-in-picture-poster.playkit-has-poster{background-color:#000}.playkit-picture-in-picture-overlay .playkit-picture-in-picture-poster .playkit-dark-layer{background-color:rgba(0,0,0,0.4);position:absolute;top:0;left:0;width:100%;height:100%}.playkit-picture-in-picture-overlay .playkit-picture-in-picture-control{position:absolute;display:flex;flex-direction:column;height:100%}.playkit-picture-in-picture-overlay .playkit-picture-in-picture-control::after{content:'';flex:3}.playkit-picture-in-picture-overlay .playkit-picture-in-picture-control::before{content:'';flex:1}.playkit-picture-in-picture-overlay .playkit-picture-in-picture-text{color:var(--playkit-tone-1-color);font-size:18px;white-space:nowrap;overflow:hidden}.playkit-picture-in-picture-overlay .playkit-picture-in-picture-button{height:36px;width:120px;border:2px solid var(--playkit-tone-6-color);border-radius:18px;background-color:var(--playkit-tone-7-color);color:var(--playkit-tone-1-color);font-size:15px;font-weight:bold;line-height:30px;cursor:pointer;margin-top:20px;align-self:center}.playkit-picture-in-picture-overlay .playkit-picture-in-picture-button:hover{background-color:var(--playkit-tone-6-color)}.playkit-copy-url-row .playkit-input-copy-url{margin:0}.playkit-copy-url-row .playkit-btn-copy-url{margin:0 8px}.playkit-copy-url-row .playkit-btn-copy-url .playkit-icon{height:24px;width:24px;margin-top:-3px;display:none}.playkit-copy-url-row .playkit-btn-copy-url .playkit-icon-copy{display:block}.playkit-copy-url-row .playkit-btn-copy-url.playkit-copied .playkit-icon-copy{display:none}.playkit-copy-url-row .playkit-btn-copy-url.playkit-copied .playkit-icon-check{display:block}.playkit-IE.playkit-player .playkit-tooltip .playkit-tooltip-label{white-space:nowrap}.playkit-player .playkit-tooltip{position:relative;display:inline-block;height:100%;width:100%}.playkit-player .playkit-tooltip .playkit-tooltip-label{visibility:hidden;background-color:var(--playkit-tooltip-background-color);color:var(--playkit-tooltip-color);text-align:center;padding:4px 6px;border-radius:4px;position:absolute;line-height:normal;font-weight:bold;font-size:13px;opacity:0;transition:opacity 1s;width:max-content;display:table}.playkit-player .playkit-tooltip .playkit-tooltip-label:after{content:'';position:absolute;border-width:5px;border-style:solid;border-radius:3px;color:var(--playkit-tooltip-background-color);z-index:-1}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top{bottom:calc(100% + 10px);left:50%;transform:translate(-50%)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top:after{bottom:-4px;left:50%;transform:translate(-50%) rotate(45deg) skew(5deg, 5deg)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-left{bottom:calc(100% + 10px);left:50%;transform:translate(-100%);margin-left:16px}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-left:after{bottom:-4px;right:0;margin-right:11px;transform:rotate(45deg) skew(5deg, 5deg)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-right{bottom:calc(100% + 10px);left:50%;transform:translate(-16px)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-right:after{bottom:-4px;left:0;margin-left:11px;transform:rotate(45deg) skew(5deg, 5deg)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom{top:calc(100% + 10px);left:50%;transform:translate(-50%)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom:after{top:-4px;left:50%;margin-left:-5px;transform:rotate(45deg) skew(5deg, 5deg)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-right{top:calc(100% + 10px);left:50%;transform:translate(-16px)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-right:after{top:-4px;left:0;margin-left:11px;transform:rotate(45deg) skew(5deg, 5deg)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-left{top:calc(100% + 10px);transform:translate(-100%);left:50%;margin-left:16px}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-left:after{top:-4px;right:0;margin-right:11px;transform:rotate(45deg) skew(5deg, 5deg)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-left{top:50%;right:calc(100% + 10px);transform:translate(0, -50%)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-left:after{top:50%;left:100%;margin-left:-6px;margin-top:-5px;transform:rotate(135deg) skew(10deg, 10deg)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-right{top:50%;left:calc(100% + 10px);transform:translate(0, -50%)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-right:after{top:50%;right:100%;margin-top:-5px;margin-right:-6px;transform:rotate(135deg) skew(10deg, 10deg)}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-show{visibility:visible;opacity:1}.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-hide{transition:opacity 0.15s ease-in-out}.playkit-side-panel{position:absolute;overflow:hidden;transition:all 500ms;transition-property:left, right, bottom, top, opacity;z-index:1}.playkit-vertical-side-panel{height:100%}.playkit-horizontal-side-panel{height:0;left:0;right:0}.playkit-side-panel-content{width:100%;height:100%}.playkit-player.playkit-overlay-active .playkit-interactive-area{filter:blur(16px)}.playkit-interactive-area{pointer-events:none;position:relative;top:0;margin:16px;transition:margin 100ms ease-in-out;flex:1}.playkit-player.playkit-size-sm .playkit-interactive-area{margin:8px}.playkit-player.playkit-casting:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area,.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area,.playkit-player.playkit-state-paused:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area,.playkit-player.playkit-state-idle:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area,.playkit-player.playkit-ad-break:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area,.playkit-player.playkit-menu-active:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area{margin:0px 8px}.playkit-player.playkit-casting .playkit-interactive-area,.playkit-player.playkit-metadata-loaded.playkit-hover .playkit-interactive-area,.playkit-player.playkit-state-paused .playkit-interactive-area,.playkit-player.playkit-state-idle .playkit-interactive-area,.playkit-player.playkit-ad-break .playkit-interactive-area,.playkit-player.playkit-menu-active .playkit-interactive-area{margin:0px 16px}.playkit-video-area{pointer-events:none;transition:all 500ms;transition-property:left, right, bottom, top, width, height}.playkit-gui-area{pointer-events:none;transition:all 500ms;transition-property:left, right, bottom, top;display:flex;flex-flow:column nowrap}@keyframes playkit-kaltura-spinner{0%{transform:rotate(0deg) scale(0.7);opacity:1}70%{transform:rotate(360deg) scale(0.7);opacity:1}82%{transform:rotate(360deg) scale(0);opacity:0}87%{transform:rotate(360deg) scale(0.9);opacity:1}100%{transform:rotate(360deg) scale(0.7);opacity:1}}.playkit-spinner{width:100px;height:100px;position:relative;animation:playkit-kaltura-spinner 2.5s infinite}.playkit-spinner span{width:8px;height:8px;background-color:#fff;display:block;border-radius:8px;position:absolute;top:50%;left:50%;margin-top:-4px;margin-left:-4px}.playkit-spinner span:nth-child(1){transform:rotate(45deg) translateX(-25px) translateY(-25px);background-color:#da1f26}.playkit-spinner span:nth-child(2){transform:rotate(90deg) translateX(-25px) translateY(-25px);background-color:#06a885}.playkit-spinner span:nth-child(3){transform:rotate(135deg) translateX(-25px) translateY(-25px);background-color:#009344}.playkit-spinner span:nth-child(4){transform:rotate(180deg) translateX(-25px) translateY(-25px);background-color:#f8a61a}.playkit-spinner span:nth-child(5){transform:rotate(225deg) translateX(-25px) translateY(-25px);background-color:#1b4a97}.playkit-spinner span:nth-child(6){transform:rotate(270deg) translateX(-25px) translateY(-25px);background-color:#00abcc}.playkit-spinner span:nth-child(7){transform:rotate(315deg) translateX(-25px) translateY(-25px);background-color:#b1d238}.playkit-spinner span:nth-child(8){transform:rotate(360deg) translateX(-25px) translateY(-25px);background-color:#fcd203}\n",""]),t.locals={primaryColor:"var(--playkit-primary-color)",primaryDarkerColor:"var(--playkit-primary-darker-color)",primaryBrighterColor:"var(--playkit-primary-brighter-color)",primaryTextContrastColor:"var(--playkit-primary-text-contrast-color)",secondaryColor:"var(--playkit-secondary-color)",secondaryDarkerColor:"var(--playkit-secondary-darker-color)",secondaryBrighterColor:"var(--playkit-secondary-brighter-color)",secondaryTextContrastColor:"var(--playkit-secondary-text-contrast-color)",successDarkerColor:"var(--playkit-success-darker-color)",successBrighterColor:"var(--playkit-success-brighter-color)",successTextContrastColor:"var(--playkit-success-text-contrast-color)",dangerColor:"var(--playkit-danger-color)",dangerDarkerColor:"var(--playkit-danger-darker-color)",dangerBrighterColor:"var(--playkit-danger-brighter-color)","danger-text-contrast-color":"var(--playkit-danger-text-contrast-color)",dangerTextContrastColor:"var(--playkit-danger-text-contrast-color)",warningColor:"var(--playkit-warning-color)",warningDarkerColor:"var(--playkit-warning-darker-color)",warningBrighterColor:"var(--playkit-warning-brighter-color)",warningTextContrastColor:"var(--playkit-warning-text-contrast-color)",tone1Color:"var(--playkit-tone-1-color)",tone2Color:"var(--playkit-tone-2-color)",tone3Color:"var(--playkit-tone-3-color)",tone4Color:"var(--playkit-tone-4-color)",tone5Color:"var(--playkit-tone-5-color)",tone6Color:"var(--playkit-tone-6-color)",tone7Color:"var(--playkit-tone-7-color)",tone8Color:"var(--playkit-tone-8-color)",liveColor:"var(--playkit-live-color)",playerBackgroundColor:"var(--playkit-player-background-color)",tabFocusColor:"var(--playkit-tab-focus-color)",tooltipBackgroundColor:"var(--playkit-tooltip-background-color)",tooltipColor:"var(--playkit-tooltip-color)",adsColor:"var(--playkit-ads-color)",progressBarHeight:"4px",progressBarBorderRadius:"2px",defaultTransitionTime:"500",bottomBarMaxHeight:"60",brandColor:"#006bff",white:"#fff",player:"playkit-player",row:"playkit-row","d-inline-block":"playkit-d-inline-block",dInlineBlock:"playkit-d-inline-block","mobile-hidden-select":"playkit-mobile-hidden-select",mobileHiddenSelect:"playkit-mobile-hidden-select","font-size-base":"playkit-font-size-base",fontSizeBase:"playkit-font-size-base","ad-notice":"playkit-ad-notice",adNotice:"playkit-ad-notice","form-group":"playkit-form-group",formGroup:"playkit-form-group","has-error":"playkit-has-error",hasError:"playkit-has-error","form-control":"playkit-form-control",formControl:"playkit-form-control","has-icon":"playkit-has-icon",hasIcon:"playkit-has-icon",icon:"playkit-icon",checkbox:"playkit-checkbox","form-group-row":"playkit-form-group-row",formGroupRow:"playkit-form-group-row",dropdown:"playkit-dropdown",btn:"playkit-btn","btn-block":"playkit-btn-block",btnBlock:"playkit-btn-block","btn-dark-transparent":"playkit-btn-dark-transparent",btnDarkTransparent:"playkit-btn-dark-transparent","btn-branded":"playkit-btn-branded",btnBranded:"playkit-btn-branded","btn-rounded":"playkit-btn-rounded",btnRounded:"playkit-btn-rounded","btn-borderless":"playkit-btn-borderless",btnBorderless:"playkit-btn-borderless","only-icon":"playkit-only-icon",onlyIcon:"playkit-only-icon","only-label":"playkit-only-label",onlyLabel:"playkit-only-label","size-sm":"playkit-size-sm",sizeSm:"playkit-size-sm","size-xs":"playkit-size-xs",sizeXs:"playkit-size-xs","badge-icon":"playkit-badge-icon",badgeIcon:"playkit-badge-icon","icon-maximize":"playkit-icon-maximize",iconMaximize:"playkit-icon-maximize","icon-minimize":"playkit-icon-minimize",iconMinimize:"playkit-icon-minimize","icon-play":"playkit-icon-play",iconPlay:"playkit-icon-play","icon-pause":"playkit-icon-pause",iconPause:"playkit-icon-pause","icon-volume-base":"playkit-icon-volume-base",iconVolumeBase:"playkit-icon-volume-base","icon-volume-waves":"playkit-icon-volume-waves",iconVolumeWaves:"playkit-icon-volume-waves","icon-volume-wave":"playkit-icon-volume-wave",iconVolumeWave:"playkit-icon-volume-wave","icon-volume-mute":"playkit-icon-volume-mute",iconVolumeMute:"playkit-icon-volume-mute","icon-close":"playkit-icon-close",iconClose:"playkit-icon-close","icon-settings":"playkit-icon-settings",iconSettings:"playkit-icon-settings","icon-check":"playkit-icon-check",iconCheck:"playkit-icon-check","icon-check-active":"playkit-icon-check-active",iconCheckActive:"playkit-icon-check-active","icon-language":"playkit-icon-language",iconLanguage:"playkit-icon-language","icon-quality":"playkit-icon-quality",iconQuality:"playkit-icon-quality","icon-captions":"playkit-icon-captions",iconCaptions:"playkit-icon-captions","icon-speed":"playkit-icon-speed",iconSpeed:"playkit-icon-speed","icon-speed-down":"playkit-icon-speed-down",iconSpeedDown:"playkit-icon-speed-down","icon-speed-up":"playkit-icon-speed-up",iconSpeedUp:"playkit-icon-speed-up","icon-audio":"playkit-icon-audio",iconAudio:"playkit-icon-audio","icon-arrow-down":"playkit-icon-arrow-down",iconArrowDown:"playkit-icon-arrow-down","icon-start-over":"playkit-icon-start-over",iconStartOver:"playkit-icon-start-over","icon-seek-end":"playkit-icon-seek-end",iconSeekEnd:"playkit-icon-seek-end","icon-rewind":"playkit-icon-rewind",iconRewind:"playkit-icon-rewind","icon-rewind-10":"playkit-icon-rewind-10",iconRewind10:"playkit-icon-rewind-10","icon-forward":"playkit-icon-forward",iconForward:"playkit-icon-forward","icon-forward-10":"playkit-icon-forward-10",iconForward10:"playkit-icon-forward-10","icon-vr-stereo":"playkit-icon-vr-stereo",iconVrStereo:"playkit-icon-vr-stereo","icon-vr-stereo-full":"playkit-icon-vr-stereo-full",iconVrStereoFull:"playkit-icon-vr-stereo-full","icon-chromecast":"playkit-icon-chromecast",iconChromecast:"playkit-icon-chromecast","icon-chromecast-brand":"playkit-icon-chromecast-brand",iconChromecastBrand:"playkit-icon-chromecast-brand","icon-next":"playkit-icon-next",iconNext:"playkit-icon-next","icon-prev":"playkit-icon-prev",iconPrev:"playkit-icon-prev","icon-picture-in-picture-start":"playkit-icon-picture-in-picture-start",iconPictureInPictureStart:"playkit-icon-picture-in-picture-start","icon-picture-in-picture-stop":"playkit-icon-picture-in-picture-stop",iconPictureInPictureStop:"playkit-icon-picture-in-picture-stop","icon-quality-hd":"playkit-icon-quality-hd",iconQualityHd:"playkit-icon-quality-hd","icon-quality-hd-active":"playkit-icon-quality-hd-active",iconQualityHdActive:"playkit-icon-quality-hd-active","icon-quality-4k":"playkit-icon-quality-4k",iconQuality4K:"playkit-icon-quality-4k","icon-quality-4k-active":"playkit-icon-quality-4k-active",iconQuality4KActive:"playkit-icon-quality-4k-active","icon-quality-8k":"playkit-icon-quality-8k",iconQuality8K:"playkit-icon-quality-8k","icon-quality-8k-active":"playkit-icon-quality-8k-active",iconQuality8KActive:"playkit-icon-quality-8k-active","icon-closed-captions-on":"playkit-icon-closed-captions-on",iconClosedCaptionsOn:"playkit-icon-closed-captions-on","icon-closed-captions-off":"playkit-icon-closed-captions-off",iconClosedCaptionsOff:"playkit-icon-closed-captions-off","label-badge":"playkit-label-badge",labelBadge:"playkit-label-badge",active:"playkit-active","dropdown-menu":"playkit-dropdown-menu",dropdownMenu:"playkit-dropdown-menu","dropdown-button":"playkit-dropdown-button",dropdownButton:"playkit-dropdown-button",openDropmenu:"playkit-openDropmenu",top:"playkit-top",bottom:"playkit-bottom",right:"playkit-right",left:"playkit-left","stick-bottom":"playkit-stick-bottom",stickBottom:"playkit-stick-bottom","dropdown-menu-item":"playkit-dropdown-menu-item",dropdownMenuItem:"playkit-dropdown-menu-item","menu-icon-container":"playkit-menu-icon-container",menuIconContainer:"playkit-menu-icon-container","control-button":"playkit-control-button",controlButton:"playkit-control-button","button-badge":"playkit-button-badge",buttonBadge:"playkit-button-badge","control-button-rounded":"playkit-control-button-rounded",controlButtonRounded:"playkit-control-button-rounded",touch:"playkit-touch","control-button-container":"playkit-control-button-container",controlButtonContainer:"playkit-control-button-container","state-idle":"playkit-state-idle",stateIdle:"playkit-state-idle","no-idle-control":"playkit-no-idle-control",noIdleControl:"playkit-no-idle-control",rotate:"playkit-rotate",spin:"playkit-spin","reverse-rotate":"playkit-reverse-rotate",reverseRotate:"playkit-reverse-rotate","reverse-spin":"playkit-reverse-spin",reverseSpin:"playkit-reverse-spin","upper-bar-icon":"playkit-upper-bar-icon",upperBarIcon:"playkit-upper-bar-icon",emptyUrl:"playkit-emptyUrl","player-gui":"playkit-player-gui",playerGui:"playkit-player-gui","overlay-active":"playkit-overlay-active",overlayActive:"playkit-overlay-active",nav:"playkit-nav","ad-break":"playkit-ad-break",adBreak:"playkit-ad-break","metadata-loaded":"playkit-metadata-loaded",metadataLoaded:"playkit-metadata-loaded",hover:"playkit-hover","state-paused":"playkit-state-paused",statePaused:"playkit-state-paused","pre-playback":"playkit-pre-playback",prePlayback:"playkit-pre-playback",casting:"playkit-casting","menu-active":"playkit-menu-active",menuActive:"playkit-menu-active",iOS:"playkit-iOS",iOs:"playkit-iOS",Safari:"playkit-Safari",safari:"playkit-Safari",fullscreen:"playkit-fullscreen","video-player":"playkit-video-player",videoPlayer:"playkit-video-player",overlay:"playkit-overlay",openOverlay:"playkit-openOverlay","overlay-contents":"playkit-overlay-contents",overlayContents:"playkit-overlay-contents",title:"playkit-title","close-overlay":"playkit-close-overlay",closeOverlay:"playkit-close-overlay","overlay-screen":"playkit-overlay-screen",overlayScreen:"playkit-overlay-screen","size-md":"playkit-size-md",sizeMd:"playkit-size-md","smart-container":"playkit-smart-container",smartContainer:"playkit-smart-container",openSmartContainer:"playkit-openSmartContainer",leaving:"playkit-leaving",closeSmartContainer:"playkit-closeSmartContainer","smart-container-item":"playkit-smart-container-item",smartContainerItem:"playkit-smart-container-item","select-menu-item":"playkit-select-menu-item",selectMenuItem:"playkit-select-menu-item","label-icon":"playkit-label-icon",labelIcon:"playkit-label-icon",Windows:"playkit-Windows",windows:"playkit-Windows","cvaa-overlay":"playkit-cvaa-overlay",cvaaOverlay:"playkit-cvaa-overlay",sample:"playkit-sample",custom:"playkit-custom","black-bg":"playkit-black-bg",blackBg:"playkit-black-bg","yellow-text":"playkit-yellow-text",yellowText:"playkit-yellow-text","active-tick":"playkit-active-tick",activeTick:"playkit-active-tick","button-save-cvaa":"playkit-button-save-cvaa",buttonSaveCvaa:"playkit-button-save-cvaa","custom-captions-applied":"playkit-custom-captions-applied",customCaptionsApplied:"playkit-custom-captions-applied","custom-caption-form":"playkit-custom-caption-form",customCaptionForm:"playkit-custom-caption-form",slider:"playkit-slider","preview-container":"playkit-preview-container",previewContainer:"playkit-preview-container","font-size":"playkit-font-size",fontSize:"playkit-font-size","font-color":"playkit-font-color",fontColor:"playkit-font-color","font-family":"playkit-font-family",fontFamily:"playkit-font-family","font-style":"playkit-font-style",fontStyle:"playkit-font-style","font-opacity":"playkit-font-opacity",fontOpacity:"playkit-font-opacity","background-color":"playkit-background-color",backgroundColor:"playkit-background-color","background-opacity":"playkit-background-opacity",backgroundOpacity:"playkit-background-opacity","loading-backdrop":"playkit-loading-backdrop",loadingBackdrop:"playkit-loading-backdrop",show:"playkit-show","spinner-container":"playkit-spinner-container",spinnerContainer:"playkit-spinner-container","control-play-pause":"playkit-control-play-pause",controlPlayPause:"playkit-control-play-pause","is-playing":"playkit-is-playing",isPlaying:"playkit-is-playing","control-volume":"playkit-control-volume",controlVolume:"playkit-control-volume","volume-control":"playkit-volume-control",volumeControl:"playkit-volume-control","volume-control-bar":"playkit-volume-control-bar",volumeControlBar:"playkit-volume-control-bar","is-muted":"playkit-is-muted",isMuted:"playkit-is-muted","dragging-active":"playkit-dragging-active",draggingActive:"playkit-dragging-active",bar:"playkit-bar",progress:"playkit-progress","smart-container-open":"playkit-smart-container-open",smartContainerOpen:"playkit-smart-container-open","control-volume-bar":"playkit-control-volume-bar",controlVolumeBar:"playkit-control-volume-bar","size-ty":"playkit-size-ty",sizeTy:"playkit-size-ty","control-fullscreen":"playkit-control-fullscreen",controlFullscreen:"playkit-control-fullscreen","is-fullscreen":"playkit-is-fullscreen",isFullscreen:"playkit-is-fullscreen","seek-bar":"playkit-seek-bar",seekBar:"playkit-seek-bar","time-preview":"playkit-time-preview",timePreview:"playkit-time-preview","frame-preview":"playkit-frame-preview",framePreview:"playkit-frame-preview","hide-frame-preview":"playkit-hide-frame-preview",hideFramePreview:"playkit-hide-frame-preview","progress-bar":"playkit-progress-bar",progressBar:"playkit-progress-bar",scrubber:"playkit-scrubber","virtual-progress":"playkit-virtual-progress",virtualProgress:"playkit-virtual-progress",live:"playkit-live",buffered:"playkit-buffered","virtual-progress-indicator":"playkit-virtual-progress-indicator",virtualProgressIndicator:"playkit-virtual-progress-indicator","non-sticky":"playkit-non-sticky",nonSticky:"playkit-non-sticky","frame-preview-img-container":"playkit-frame-preview-img-container",framePreviewImgContainer:"playkit-frame-preview-img-container","frame-preview-img":"playkit-frame-preview-img",framePreviewImg:"playkit-frame-preview-img","time-display":"playkit-time-display",timeDisplay:"playkit-time-display","video-playing-title":"playkit-video-playing-title",videoPlayingTitle:"playkit-video-playing-title","bottom-bar":"playkit-bottom-bar",bottomBar:"playkit-bottom-bar",hide:"playkit-hide","left-controls":"playkit-left-controls",leftControls:"playkit-left-controls","bottom-bar-area":"playkit-bottom-bar-area",bottomBarArea:"playkit-bottom-bar-area","right-controls":"playkit-right-controls",rightControls:"playkit-right-controls","line-break":"playkit-line-break",lineBreak:"playkit-line-break","top-bar":"playkit-top-bar",topBar:"playkit-top-bar","top-bar-area":"playkit-top-bar-area",topBarArea:"playkit-top-bar-area",disabled:"playkit-disabled","overlay-action":"playkit-overlay-action",overlayAction:"playkit-overlay-action",in:"playkit-in",overlayActionIconIn:"playkit-overlayActionIconIn","pre-playback-play-overlay":"playkit-pre-playback-play-overlay",prePlaybackPlayOverlay:"playkit-pre-playback-play-overlay","pre-playback-play-button":"playkit-pre-playback-play-button",prePlaybackPlayButton:"playkit-pre-playback-play-button","btn-skip-ad":"playkit-btn-skip-ad",btnSkipAd:"playkit-btn-skip-ad","skip-ad":"playkit-skip-ad",skipAd:"playkit-skip-ad","live-tag":"playkit-live-tag",liveTag:"playkit-live-tag","non-live-playhead":"playkit-non-live-playhead",nonLivePlayhead:"playkit-non-live-playhead","interactive-area":"playkit-interactive-area",interactiveArea:"playkit-interactive-area","unmute-button-container":"playkit-unmute-button-container",unmuteButtonContainer:"playkit-unmute-button-container","show-icon-only":"playkit-show-icon-only",showIconOnly:"playkit-show-icon-only","unmute-button":"playkit-unmute-button",unmuteButton:"playkit-unmute-button","has-top-bar":"playkit-has-top-bar",hasTopBar:"playkit-has-top-bar","unmute-icon-container":"playkit-unmute-icon-container",unmuteIconContainer:"playkit-unmute-icon-container","error-overlay":"playkit-error-overlay",errorOverlay:"playkit-error-overlay","copy-url-row":"playkit-copy-url-row",copyUrlRow:"playkit-copy-url-row","svg-container":"playkit-svg-container",svgContainer:"playkit-svg-container",headline:"playkit-headline","error-session":"playkit-error-session",errorSession:"playkit-error-session","retry-btn":"playkit-retry-btn",retryBtn:"playkit-retry-btn","error-text":"playkit-error-text",errorText:"playkit-error-text","link-options-container":"playkit-link-options-container",linkOptionsContainer:"playkit-link-options-container","input-copy-url":"playkit-input-copy-url",inputCopyUrl:"playkit-input-copy-url","btn-copy-url":"playkit-btn-copy-url",btnCopyUrl:"playkit-btn-copy-url",handle:"playkit-handle","learn-more":"playkit-learn-more",learnMore:"playkit-learn-more",watermark:"playkit-watermark","hide-watermark":"playkit-hide-watermark",hideWatermark:"playkit-hide-watermark","advanced-captions-menu-link":"playkit-advanced-captions-menu-link",advancedCaptionsMenuLink:"playkit-advanced-captions-menu-link","control-vr-stereo":"playkit-control-vr-stereo",controlVrStereo:"playkit-control-vr-stereo","vr-stereo-mode":"playkit-vr-stereo-mode",vrStereoMode:"playkit-vr-stereo-mode","control-closed-captions":"playkit-control-closed-captions",controlClosedCaptions:"playkit-control-closed-captions","cc-on":"playkit-cc-on",ccOn:"playkit-cc-on","cast-button":"playkit-cast-button",castButton:"playkit-cast-button","cast-button-active":"playkit-cast-button-active",castButtonActive:"playkit-cast-button-active","cast-overlay":"playkit-cast-overlay",castOverlay:"playkit-cast-overlay","cast-poster":"playkit-cast-poster",castPoster:"playkit-cast-poster","has-poster":"playkit-has-poster",hasPoster:"playkit-has-poster","cast-black-cover":"playkit-cast-black-cover",castBlackCover:"playkit-cast-black-cover","cast-box":"playkit-cast-box",castBox:"playkit-cast-box","cast-icon":"playkit-cast-icon",castIcon:"playkit-cast-icon","cast-connecting-spinner":"playkit-cast-connecting-spinner",castConnectingSpinner:"playkit-cast-connecting-spinner","cast-text":"playkit-cast-text",castText:"playkit-cast-text","cast-status":"playkit-cast-status",castStatus:"playkit-cast-status","cast-device":"playkit-cast-device",castDevice:"playkit-cast-device","cast-on-tv-button-container":"playkit-cast-on-tv-button-container",castOnTvButtonContainer:"playkit-cast-on-tv-button-container","show-cast-on-tv":"playkit-show-cast-on-tv",showCastOnTv:"playkit-show-cast-on-tv",castOnTVAnimation:"playkit-castOnTVAnimation",castOnTvAnimation:"playkit-castOnTVAnimation","cast-on-tv-button":"playkit-cast-on-tv-button",castOnTvButton:"playkit-cast-on-tv-button","cast-on-tv-icon-container":"playkit-cast-on-tv-icon-container",castOnTvIconContainer:"playkit-cast-on-tv-icon-container","control-playlist-button":"playkit-control-playlist-button",controlPlaylistButton:"playkit-control-playlist-button","poster-preview":"playkit-poster-preview",posterPreview:"playkit-poster-preview","poster-preview-img":"playkit-poster-preview-img",posterPreviewImg:"playkit-poster-preview-img","poster-preview-text":"playkit-poster-preview-text",posterPreviewText:"playkit-poster-preview-text","poster-preview-text-title":"playkit-poster-preview-text-title",posterPreviewTextTitle:"playkit-poster-preview-text-title","poster-preview-text-name":"playkit-poster-preview-text-name",posterPreviewTextName:"playkit-poster-preview-text-name","is-in-picture-in-picture":"playkit-is-in-picture-in-picture",isInPictureInPicture:"playkit-is-in-picture-in-picture","playback-controls":"playkit-playback-controls",playbackControls:"playkit-playback-controls","center-playback-controls":"playkit-center-playback-controls",centerPlaybackControls:"playkit-center-playback-controls","gui-area":"playkit-gui-area",guiArea:"playkit-gui-area","playlist-countdown":"playkit-playlist-countdown",playlistCountdown:"playkit-playlist-countdown",slideIn:"playkit-slideIn",hidden:"playkit-hidden","playlist-countdown-content-placeholder":"playkit-playlist-countdown-content-placeholder",playlistCountdownContentPlaceholder:"playkit-playlist-countdown-content-placeholder","playlist-countdown-content-background":"playkit-playlist-countdown-content-background",playlistCountdownContentBackground:"playkit-playlist-countdown-content-background","playlist-countdown-content":"playkit-playlist-countdown-content",playlistCountdownContent:"playkit-playlist-countdown-content",canceled:"playkit-canceled","playlist-countdown-poster":"playkit-playlist-countdown-poster",playlistCountdownPoster:"playkit-playlist-countdown-poster","playlist-countdown-text":"playkit-playlist-countdown-text",playlistCountdownText:"playkit-playlist-countdown-text","playlist-countdown-text-title":"playkit-playlist-countdown-text-title",playlistCountdownTextTitle:"playkit-playlist-countdown-text-title","playlist-countdown-time-left":"playkit-playlist-countdown-time-left",playlistCountdownTimeLeft:"playkit-playlist-countdown-time-left","playlist-countdown-text-name":"playkit-playlist-countdown-text-name",playlistCountdownTextName:"playkit-playlist-countdown-text-name","playlist-countdown-cancel":"playkit-playlist-countdown-cancel",playlistCountdownCancel:"playkit-playlist-countdown-cancel","playlist-next-screen-overlay":"playkit-playlist-next-screen-overlay",playlistNextScreenOverlay:"playkit-playlist-next-screen-overlay","playlist-next-screen-content":"playkit-playlist-next-screen-content",playlistNextScreenContent:"playkit-playlist-next-screen-content","playlist-next-screen-text":"playkit-playlist-next-screen-text",playlistNextScreenText:"playkit-playlist-next-screen-text","playlist-next-screen-text-title":"playkit-playlist-next-screen-text-title",playlistNextScreenTextTitle:"playkit-playlist-next-screen-text-title","playlist-next-screen-text-name":"playkit-playlist-next-screen-text-name",playlistNextScreenTextName:"playkit-playlist-next-screen-text-name","playlist-next-screen-poster-placeholder":"playkit-playlist-next-screen-poster-placeholder",playlistNextScreenPosterPlaceholder:"playkit-playlist-next-screen-poster-placeholder","playlist-next-screen-poster-aspect-ratio":"playkit-playlist-next-screen-poster-aspect-ratio",playlistNextScreenPosterAspectRatio:"playkit-playlist-next-screen-poster-aspect-ratio","playlist-next-screen-poster":"playkit-playlist-next-screen-poster",playlistNextScreenPoster:"playkit-playlist-next-screen-poster","playlist-next-screen-poster-img":"playkit-playlist-next-screen-poster-img",playlistNextScreenPosterImg:"playkit-playlist-next-screen-poster-img","size-lg":"playkit-size-lg",sizeLg:"playkit-size-lg","picture-in-picture-overlay":"playkit-picture-in-picture-overlay",pictureInPictureOverlay:"playkit-picture-in-picture-overlay","picture-in-picture-poster":"playkit-picture-in-picture-poster",pictureInPicturePoster:"playkit-picture-in-picture-poster","dark-layer":"playkit-dark-layer",darkLayer:"playkit-dark-layer","picture-in-picture-control":"playkit-picture-in-picture-control",pictureInPictureControl:"playkit-picture-in-picture-control","picture-in-picture-text":"playkit-picture-in-picture-text",pictureInPictureText:"playkit-picture-in-picture-text","picture-in-picture-button":"playkit-picture-in-picture-button",pictureInPictureButton:"playkit-picture-in-picture-button","icon-copy":"playkit-icon-copy",iconCopy:"playkit-icon-copy",copied:"playkit-copied",IE:"playkit-IE",ie:"playkit-IE",tooltip:"playkit-tooltip","tooltip-label":"playkit-tooltip-label",tooltipLabel:"playkit-tooltip-label","tooltip-top":"playkit-tooltip-top",tooltipTop:"playkit-tooltip-top","tooltip-top-left":"playkit-tooltip-top-left",tooltipTopLeft:"playkit-tooltip-top-left","tooltip-top-right":"playkit-tooltip-top-right",tooltipTopRight:"playkit-tooltip-top-right","tooltip-bottom":"playkit-tooltip-bottom",tooltipBottom:"playkit-tooltip-bottom","tooltip-bottom-right":"playkit-tooltip-bottom-right",tooltipBottomRight:"playkit-tooltip-bottom-right","tooltip-bottom-left":"playkit-tooltip-bottom-left",tooltipBottomLeft:"playkit-tooltip-bottom-left","tooltip-left":"playkit-tooltip-left",tooltipLeft:"playkit-tooltip-left","tooltip-right":"playkit-tooltip-right",tooltipRight:"playkit-tooltip-right","side-panel":"playkit-side-panel",sidePanel:"playkit-side-panel","vertical-side-panel":"playkit-vertical-side-panel",verticalSidePanel:"playkit-vertical-side-panel","horizontal-side-panel":"playkit-horizontal-side-panel",horizontalSidePanel:"playkit-horizontal-side-panel","side-panel-content":"playkit-side-panel-content",sidePanelContent:"playkit-side-panel-content","video-area":"playkit-video-area",videoArea:"playkit-video-area",spinner:"playkit-spinner","kaltura-spinner":"playkit-kaltura-spinner",kalturaSpinner:"playkit-kaltura-spinner"},e.exports=t},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r,a,n,i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"==typeof btoa){var s=(r=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(n," */")),l=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[i].concat(l).concat([s]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,a){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(a)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(n[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&n[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},function(e,t,r){"use strict";r.r(t),r.d(t,"Event",(function(){return b})),r.d(t,"EventType",(function(){return Kp})),r.d(t,"h",(function(){return N})),r.d(t,"createPortal",(function(){return Ye})),r.d(t,"preact",(function(){return a})),r.d(t,"redux",(function(){return i})),r.d(t,"preacti18n",(function(){return o})),r.d(t,"preactHooks",(function(){return n})),r.d(t,"style",(function(){return ca.a})),r.d(t,"Reducers",(function(){return T})),r.d(t,"Presets",(function(){return E})),r.d(t,"Components",(function(){return k})),r.d(t,"Utils",(function(){return v})),r.d(t,"reducers",(function(){return T})),r.d(t,"presets",(function(){return E})),r.d(t,"components",(function(){return k})),r.d(t,"utils",(function(){return v})),r.d(t,"UIManager",(function(){return Gp})),r.d(t,"VERSION",(function(){return Wp})),r.d(t,"NAME",(function(){return zp})),r.d(t,"SidePanelPositions",(function(){return Jr})),r.d(t,"SidePanelModes",(function(){return Zr})),r.d(t,"ReservedPresetNames",(function(){return ea})),r.d(t,"ReservedPresetAreas",(function(){return ta}));var a={};r.r(a),r.d(a,"render",(function(){return re})),r.d(a,"hydrate",(function(){return ae})),r.d(a,"createElement",(function(){return N})),r.d(a,"h",(function(){return N})),r.d(a,"Fragment",(function(){return B})),r.d(a,"createRef",(function(){return F})),r.d(a,"isValidElement",(function(){return A})),r.d(a,"Component",(function(){return j})),r.d(a,"cloneElement",(function(){return ne})),r.d(a,"createContext",(function(){return ie})),r.d(a,"toChildArray",(function(){return W})),r.d(a,"__u",(function(){return ee})),r.d(a,"options",(function(){return S}));var n={};r.r(n),r.d(n,"useState",(function(){return ye})),r.d(n,"useReducer",(function(){return me})),r.d(n,"useEffect",(function(){return ve})),r.d(n,"useLayoutEffect",(function(){return _e})),r.d(n,"useRef",(function(){return ke})),r.d(n,"useImperativeHandle",(function(){return Ee})),r.d(n,"useMemo",(function(){return Te})),r.d(n,"useCallback",(function(){return be})),r.d(n,"useContext",(function(){return Se})),r.d(n,"useDebugValue",(function(){return Ae})),r.d(n,"useErrorBoundary",(function(){return Ce}));var i={};r.r(i),r.d(i,"Provider",(function(){return ut})),r.d(i,"connectAdvanced",(function(){return bt})),r.d(i,"ReactReduxContext",(function(){return it})),r.d(i,"connect",(function(){return Xt})),r.d(i,"batch",(function(){return at})),r.d(i,"useDispatch",(function(){return tr})),r.d(i,"createDispatchHook",(function(){return er})),r.d(i,"useSelector",(function(){return nr})),r.d(i,"createSelectorHook",(function(){return ar})),r.d(i,"useStore",(function(){return Zt})),r.d(i,"createStoreHook",(function(){return Jt})),r.d(i,"shallowEqual",(function(){return At}));var o={};r.r(o),r.d(o,"default",(function(){return Sr})),r.d(o,"IntlProvider",(function(){return cr})),r.d(o,"Localizer",(function(){return kr})),r.d(o,"MarkupText",(function(){return Er})),r.d(o,"Text",(function(){return vr})),r.d(o,"intl",(function(){return dr})),r.d(o,"withText",(function(){return br}));var s={};r.r(s),r.d(s,"types",(function(){return Xr})),r.d(s,"SidePanelOrientation",(function(){return Qr})),r.d(s,"SidePanelPositions",(function(){return Jr})),r.d(s,"SidePanelModes",(function(){return Zr})),r.d(s,"ReservedPresetNames",(function(){return ea})),r.d(s,"ReservedPresetAreas",(function(){return ta})),r.d(s,"initialState",(function(){return na})),r.d(s,"default",(function(){return ia})),r.d(s,"actions",(function(){return oa}));var l={};r.r(l),r.d(l,"types",(function(){return fa})),r.d(l,"initialState",(function(){return ga})),r.d(l,"default",(function(){return ya})),r.d(l,"actions",(function(){return ma}));var u={};r.r(u),r.d(u,"types",(function(){return _a})),r.d(u,"initialState",(function(){return ka})),r.d(u,"default",(function(){return Ea})),r.d(u,"actions",(function(){return Ta}));var c={};r.r(c),r.d(c,"types",(function(){return Fn})),r.d(c,"initialState",(function(){return Bn})),r.d(c,"default",(function(){return jn})),r.d(c,"actions",(function(){return Vn}));var d={};r.r(d),r.d(d,"types",(function(){return Hn})),r.d(d,"initialState",(function(){return Gn})),r.d(d,"default",(function(){return Kn})),r.d(d,"actions",(function(){return Wn}));var p={};r.r(p),r.d(p,"types",(function(){return qn})),r.d(p,"initialState",(function(){return Yn})),r.d(p,"default",(function(){return Xn})),r.d(p,"actions",(function(){return Qn}));var h={};r.r(h),r.d(h,"types",(function(){return Zn})),r.d(h,"initialState",(function(){return ei})),r.d(h,"default",(function(){return ti})),r.d(h,"actions",(function(){return ri}));var f={};r.r(f),r.d(f,"types",(function(){return ni})),r.d(f,"initialState",(function(){return ii})),r.d(f,"default",(function(){return oi})),r.d(f,"actions",(function(){return si}));var g={};r.r(g),r.d(g,"types",(function(){return ui})),r.d(g,"initialState",(function(){return ci})),r.d(g,"default",(function(){return di})),r.d(g,"actions",(function(){return pi}));var y={};r.r(y),r.d(y,"types",(function(){return fi})),r.d(y,"initialState",(function(){return gi})),r.d(y,"default",(function(){return yi})),r.d(y,"actions",(function(){return mi}));var m={};r.r(m),r.d(m,"types",(function(){return Ti})),r.d(m,"initialState",(function(){return bi})),r.d(m,"default",(function(){return Si})),r.d(m,"actions",(function(){return Ai}));var v={};r.r(v),r.d(v,"bindActions",(function(){return la})),r.d(v,"KeyMap",(function(){return Rr})),r.d(v,"getLogger",(function(){return Ir})),r.d(v,"withKeyboardA11y",(function(){return Vi})),r.d(v,"toHHMMSS",(function(){return $i})),r.d(v,"toSecondsFromHHMMSS",(function(){return Hi})),r.d(v,"formatOnlyNumbersInput",(function(){return Gi}));var _={};r.r(_),r.d(_,"isPlayingAdOrPlayback",(function(){return To}));var k={};r.r(k),r.d(k,"AdLearnMore",(function(){return $u})),r.d(k,"AdSkip",(function(){return Ku})),r.d(k,"AdNotice",(function(){return Wu})),r.d(k,"BaseComponent",(function(){return nc})),r.d(k,"BottomBar",(function(){return sc})),r.d(k,"CVAAOverlay",(function(){return Wl})),r.d(k,"DropDown",(function(){return yl})),r.d(k,"EngineConnector",(function(){return Di})),r.d(k,"ErrorOverlay",(function(){return Ec})),r.d(k,"EventDispatcherProvider",(function(){return Ja})),r.d(k,"withEventDispatcher",(function(){return hn})),r.d(k,"Keyboard",(function(){return Cs})),r.d(k,"withKeyboardEvent",(function(){return Fs})),r.d(k,"KeyboardEventProvider",(function(){return Is})),r.d(k,"Icon",(function(){return ko})),r.d(k,"IconType",(function(){return mo})),r.d(k,"IconState",(function(){return _o})),r.d(k,"BadgeType",(function(){return vo})),r.d(k,"LiveTag",(function(){return Sc})),r.d(k,"Loading",(function(){return ro})),r.d(k,"Menu",(function(){return dl})),r.d(k,"Overlay",(function(){return al})),r.d(k,"OverlayAction",(function(){return xo})),r.d(k,"OverlayPortal",(function(){return xc})),r.d(k,"PlayerProvider",(function(){return ba})),r.d(k,"withPlayer",(function(){return Aa})),r.d(k,"PrePlaybackPlayOverlay",(function(){return Ho})),r.d(k,"SeekBarLivePlaybackContainer",(function(){return Mc})),r.d(k,"SeekBarPlaybackContainer",(function(){return pp})),r.d(k,"withLogger",(function(){return Fr})),r.d(k,"Shell",(function(){return Tn})),r.d(k,"PLAYER_SIZE",(function(){return En})),r.d(k,"Slider",(function(){return Cl})),r.d(k,"SmartContainer",(function(){return sl})),r.d(k,"SmartContainerItem",(function(){return ml})),r.d(k,"TimeDisplay",(function(){return Rc})),r.d(k,"TimeDisplayAdsContainer",(function(){return Nc})),r.d(k,"TimeDisplayPlaybackContainer",(function(){return Bc})),r.d(k,"Tooltip",(function(){return Ro})),r.d(k,"ToolTipType",(function(){return Do})),r.d(k,"TopBar",(function(){return Hc})),r.d(k,"UnmuteIndication",(function(){return Yc})),r.d(k,"VideoPlayer",(function(){return Li})),r.d(k,"Watermark",(function(){return Zc})),r.d(k,"Logo",(function(){return ad})),r.d(k,"CastOverlay",(function(){return ud})),r.d(k,"CastBeforePlay",(function(){return md})),r.d(k,"CastAfterPlay",(function(){return Ed})),r.d(k,"PlaylistButton",(function(){return xd})),r.d(k,"PrevNext",(function(){return bd})),r.d(k,"PlaylistNextScreen",(function(){return Fd})),r.d(k,"PictureInPicture",(function(){return $d})),r.d(k,"PlaybackControls",(function(){return Gd})),r.d(k,"CopyButton",(function(){return fc})),r.d(k,"ButtonControl",(function(){return ts})),r.d(k,"Button",(function(){return jo})),r.d(k,"PlayerArea",(function(){return zr})),r.d(k,"withPlayerPreset",(function(){return Nn})),r.d(k,"Remove",(function(){return Vr})),r.d(k,"VideoArea",(function(){return Jd})),r.d(k,"GuiArea",(function(){return oo})),r.d(k,"InteractiveArea",(function(){return Zd})),r.d(k,"KeyboardControl",(function(){return Cs})),r.d(k,"Cast",(function(){return qs})),r.d(k,"CastControl",(function(){return qs})),r.d(k,"Fullscreen",(function(){return Js})),r.d(k,"FullscreenControl",(function(){return Js})),r.d(k,"Language",(function(){return ru})),r.d(k,"LanguageControl",(function(){return ru})),r.d(k,"PlayPause",(function(){return hu})),r.d(k,"PlayPauseControl",(function(){return hu})),r.d(k,"Rewind",(function(){return ds})),r.d(k,"RewindControl",(function(){return ds})),r.d(k,"Forward",(function(){return vs})),r.d(k,"ForwardControl",(function(){return vs})),r.d(k,"SeekBar",(function(){return lp})),r.d(k,"SeekBarControl",(function(){return lp})),r.d(k,"Settings",(function(){return Su})),r.d(k,"SettingsControl",(function(){return Su})),r.d(k,"Volume",(function(){return Du})),r.d(k,"VolumeControl",(function(){return Du})),r.d(k,"VrStereo",(function(){return Nu})),r.d(k,"VrStereoControl",(function(){return Nu})),r.d(k,"ClosedCaptions",(function(){return Fu})),r.d(k,"ClosedCaptionsControl",(function(){return Fu}));var E={};r.r(E),r.d(E,"idleUI",(function(){return lo})),r.d(E,"playbackUI",(function(){return bp})),r.d(E,"adsUI",(function(){return Pp})),r.d(E,"errorUI",(function(){return xp})),r.d(E,"liveUI",(function(){return Dp})),r.d(E,"imgUI",(function(){return Lp}));var T={};r.r(T),r.d(T,"config",(function(){return l})),r.d(T,"cvaa",(function(){return h})),r.d(T,"engine",(function(){return u})),r.d(T,"getters",(function(){return _})),r.d(T,"loading",(function(){return p})),r.d(T,"overlayAction",(function(){return g})),r.d(T,"playlist",(function(){return y})),r.d(T,"seekbar",(function(){return c})),r.d(T,"setting",(function(){return f})),r.d(T,"shell",(function(){return s})),r.d(T,"volume",(function(){return d})),r.d(T,"overlay",(function(){return m}));var b={};r.r(b),r.d(b,"withEventManager",(function(){return Ba})),r.d(b,"EventType",(function(){return Dr}));var S,A,C,P,w,x,I,M={},D=[],R=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function O(e,t){for(var r in t)e[r]=t[r];return e}function L(e){var t=e.parentNode;t&&t.removeChild(e)}function N(e,t,r){var a,n=arguments,i={};for(a in t)"key"!==a&&"ref"!==a&&(i[a]=t[a]);if(arguments.length>3)for(r=[r],a=3;a<arguments.length;a++)r.push(n[a]);if(null!=r&&(i.children=r),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===i[a]&&(i[a]=e.defaultProps[a]);return U(e,i,t&&t.key,t&&t.ref,null)}function U(e,t,r,a,n){var i={type:e,props:t,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:n};return null==n&&(i.__v=i),S.vnode&&S.vnode(i),i}function F(){return{current:null}}function B(e){return e.children}function j(e,t){this.props=e,this.context=t}function V(e,t){if(null==t)return e.__?V(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?V(e):null}function $(e){var t,r;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e){e.__e=e.__c.base=r.__e;break}return $(e)}}function H(e){(!e.__d&&(e.__d=!0)&&C.push(e)&&!G.__r++||w!==S.debounceRendering)&&((w=S.debounceRendering)||P)(G)}function G(){for(var e;G.__r=C.length;)e=C.sort((function(e,t){return e.__v.__b-t.__v.__b})),C=[],e.some((function(e){var t,r,a,n,i,o,s;e.__d&&(o=(i=(t=e).__v).__e,(s=t.__P)&&(r=[],(a=O({},i)).__v=a,n=Q(s,i,a,t.__n,void 0!==s.ownerSVGElement,null,r,null==o?V(i):o),J(r,i),n!=o&&$(i)))}))}function K(e,t,r,a,n,i,o,s,l,u){var c,d,p,h,f,g,y,m=a&&a.__k||D,v=m.length;for(l==M&&(l=null!=o?o[0]:v?V(a,0):null),r.__k=[],c=0;c<t.length;c++)if(null!=(h=r.__k[c]=null==(h=t[c])||"boolean"==typeof h?null:"string"==typeof h||"number"==typeof h?U(null,h,null,null,h):Array.isArray(h)?U(B,{children:h},null,null,null):null!=h.__e||null!=h.__c?U(h.type,h.props,h.key,null,h.__v):h)){if(h.__=r,h.__b=r.__b+1,null===(p=m[c])||p&&h.key==p.key&&h.type===p.type)m[c]=void 0;else for(d=0;d<v;d++){if((p=m[d])&&h.key==p.key&&h.type===p.type){m[d]=void 0;break}p=null}f=Q(e,h,p=p||M,n,i,o,s,l,u),(d=h.ref)&&p.ref!=d&&(y||(y=[]),p.ref&&y.push(p.ref,null,h),y.push(d,h.__c||f,h)),null!=f?(null==g&&(g=f),l=z(e,h,p,m,o,f,l),"option"==r.type?e.value="":"function"==typeof r.type&&(r.__d=l)):l&&p.__e==l&&l.parentNode!=e&&(l=V(p))}if(r.__e=g,null!=o&&"function"!=typeof r.type)for(c=o.length;c--;)null!=o[c]&&L(o[c]);for(c=v;c--;)null!=m[c]&&ee(m[c],m[c]);if(y)for(c=0;c<y.length;c++)Z(y[c],y[++c],y[++c])}function W(e){return null==e||"boolean"==typeof e?[]:Array.isArray(e)?D.concat.apply([],e.map(W)):[e]}function z(e,t,r,a,n,i,o){var s,l,u;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(n==r||i!=o||null==i.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(i),s=null;else{for(l=o,u=0;(l=l.nextSibling)&&u<a.length;u+=2)if(l==i)break e;e.insertBefore(i,o),s=o}return void 0!==s?s:i.nextSibling}function q(e,t,r){"-"===t[0]?e.setProperty(t,r):e[t]="number"==typeof r&&!1===R.test(t)?r+"px":null==r?"":r}function Y(e,t,r,a,n){var i,o,s,l,u;if(n?"className"===t&&(t="class"):"class"===t&&(t="className"),"style"===t)if(i=e.style,"string"==typeof r)i.cssText=r;else{if("string"==typeof a&&(i.cssText="",a=null),a)for(l in a)r&&l in r||q(i,l,"");if(r)for(u in r)a&&r[u]===a[u]||q(i,u,r[u])}else"o"===t[0]&&"n"===t[1]?(o=t!==(t=t.replace(/Capture$/,"")),s=t.toLowerCase(),t=(s in e?s:t).slice(2),r?(a||e.addEventListener(t,X,o),(e.l||(e.l={}))[t]=r):e.removeEventListener(t,X,o)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&!n&&t in e?e[t]=null==r?"":r:"function"!=typeof r&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==r||!1===r?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):null==r||!1===r&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,r))}function X(e){this.l[e.type](S.event?S.event(e):e)}function Q(e,t,r,a,n,i,o,s,l){var u,c,d,p,h,f,g,y,m,v,_,k=t.type;if(void 0!==t.constructor)return null;(u=S.__b)&&u(t);try{e:if("function"==typeof k){if(y=t.props,m=(u=k.contextType)&&a[u.__c],v=u?m?m.props.value:u.__:a,r.__c?g=(c=t.__c=r.__c).__=c.__E:("prototype"in k&&k.prototype.render?t.__c=c=new k(y,v):(t.__c=c=new j(y,v),c.constructor=k,c.render=te),m&&m.sub(c),c.props=y,c.state||(c.state={}),c.context=v,c.__n=a,d=c.__d=!0,c.__h=[]),null==c.__s&&(c.__s=c.state),null!=k.getDerivedStateFromProps&&(c.__s==c.state&&(c.__s=O({},c.__s)),O(c.__s,k.getDerivedStateFromProps(y,c.__s))),p=c.props,h=c.state,d)null==k.getDerivedStateFromProps&&null!=c.componentWillMount&&c.componentWillMount(),null!=c.componentDidMount&&c.__h.push(c.componentDidMount);else{if(null==k.getDerivedStateFromProps&&y!==p&&null!=c.componentWillReceiveProps&&c.componentWillReceiveProps(y,v),!c.__e&&null!=c.shouldComponentUpdate&&!1===c.shouldComponentUpdate(y,c.__s,v)||t.__v===r.__v){c.props=y,c.state=c.__s,t.__v!==r.__v&&(c.__d=!1),c.__v=t,t.__e=r.__e,t.__k=r.__k,c.__h.length&&o.push(c),function e(t,r,a){var n,i;for(n=0;n<t.__k.length;n++)(i=t.__k[n])&&(i.__=t,i.__e&&("function"==typeof i.type&&i.__k.length>1&&e(i,r,a),r=z(a,i,i,t.__k,null,i.__e,r),"function"==typeof t.type&&(t.__d=r)))}(t,s,e);break e}null!=c.componentWillUpdate&&c.componentWillUpdate(y,c.__s,v),null!=c.componentDidUpdate&&c.__h.push((function(){c.componentDidUpdate(p,h,f)}))}c.context=v,c.props=y,c.state=c.__s,(u=S.__r)&&u(t),c.__d=!1,c.__v=t,c.__P=e,u=c.render(c.props,c.state,c.context),c.state=c.__s,null!=c.getChildContext&&(a=O(O({},a),c.getChildContext())),d||null==c.getSnapshotBeforeUpdate||(f=c.getSnapshotBeforeUpdate(p,h)),_=null!=u&&u.type==B&&null==u.key?u.props.children:u,K(e,Array.isArray(_)?_:[_],t,r,a,n,i,o,s,l),c.base=t.__e,c.__h.length&&o.push(c),g&&(c.__E=c.__=null),c.__e=!1}else null==i&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=function(e,t,r,a,n,i,o,s){var l,u,c,d,p,h=r.props,f=t.props;if(n="svg"===t.type||n,null!=i)for(l=0;l<i.length;l++)if(null!=(u=i[l])&&((null===t.type?3===u.nodeType:u.localName===t.type)||e==u)){e=u,i[l]=null;break}if(null==e){if(null===t.type)return document.createTextNode(f);e=n?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,f.is&&{is:f.is}),i=null,s=!1}if(null===t.type)h!==f&&e.data!=f&&(e.data=f);else{if(null!=i&&(i=D.slice.call(e.childNodes)),c=(h=r.props||M).dangerouslySetInnerHTML,d=f.dangerouslySetInnerHTML,!s){if(null!=i)for(h={},p=0;p<e.attributes.length;p++)h[e.attributes[p].name]=e.attributes[p].value;(d||c)&&(d&&c&&d.__html==c.__html||(e.innerHTML=d&&d.__html||""))}(function(e,t,r,a,n){var i;for(i in r)"children"===i||"key"===i||i in t||Y(e,i,null,r[i],a);for(i in t)n&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||r[i]===t[i]||Y(e,i,t[i],r[i],a)})(e,f,h,n,s),d?t.__k=[]:(l=t.props.children,K(e,Array.isArray(l)?l:[l],t,r,a,"foreignObject"!==t.type&&n,i,o,M,s)),s||("value"in f&&void 0!==(l=f.value)&&l!==e.value&&Y(e,"value",l,h.value,!1),"checked"in f&&void 0!==(l=f.checked)&&l!==e.checked&&Y(e,"checked",l,h.checked,!1))}return e}(r.__e,t,r,a,n,i,o,l);(u=S.diffed)&&u(t)}catch(e){t.__v=null,S.__e(e,t,r)}return t.__e}function J(e,t){S.__c&&S.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){S.__e(e,t.__v)}}))}function Z(e,t,r){try{"function"==typeof e?e(t):e.current=t}catch(e){S.__e(e,r)}}function ee(e,t,r){var a,n,i;if(S.unmount&&S.unmount(e),(a=e.ref)&&(a.current&&a.current!==e.__e||Z(a,null,t)),r||"function"==typeof e.type||(r=null!=(n=e.__e)),e.__e=e.__d=void 0,null!=(a=e.__c)){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(e){S.__e(e,t)}a.base=a.__P=null}if(a=e.__k)for(i=0;i<a.length;i++)a[i]&&ee(a[i],t,r);null!=n&&L(n)}function te(e,t,r){return this.constructor(e,r)}function re(e,t,r){var a,n,i;S.__&&S.__(e,t),n=(a=r===x)?null:r&&r.__k||t.__k,e=N(B,null,[e]),i=[],Q(t,(a?t:r||t).__k=e,n||M,M,void 0!==t.ownerSVGElement,r&&!a?[r]:n?null:t.childNodes.length?D.slice.call(t.childNodes):null,i,r||M,a),J(i,e)}function ae(e,t){re(e,t,x)}function ne(e,t){var r,a;for(a in t=O(O({},e.props),t),arguments.length>2&&(t.children=D.slice.call(arguments,2)),r={},t)"key"!==a&&"ref"!==a&&(r[a]=t[a]);return U(e.type,r,t.key||e.key,t.ref||e.ref,null)}function ie(e){var t={},r={__c:"__cC"+I++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var a,n=this;return this.getChildContext||(a=[],this.getChildContext=function(){return t[r.__c]=n,t},this.shouldComponentUpdate=function(e){n.props.value!==e.value&&a.some((function(t){t.context=e.value,H(t)}))},this.sub=function(e){a.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){a.splice(a.indexOf(e),1),t&&t.call(e)}}),e.children}};return r.Consumer.contextType=r,r.Provider.__=r,r}S={__e:function(e,t){for(var r,a;t=t.__;)if((r=t.__c)&&!r.__)try{if(r.constructor&&null!=r.constructor.getDerivedStateFromError&&(a=!0,r.setState(r.constructor.getDerivedStateFromError(e))),null!=r.componentDidCatch&&(a=!0,r.componentDidCatch(e)),a)return H(r.__E=r)}catch(t){e=t}throw e}},A=function(e){return null!=e&&void 0===e.constructor},j.prototype.setState=function(e,t){var r;r=this.__s!==this.state?this.__s:this.__s=O({},this.state),"function"==typeof e&&(e=e(r,this.props)),e&&O(r,e),null!=e&&this.__v&&(t&&this.__h.push(t),H(this))},j.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),H(this))},j.prototype.render=B,C=[],P="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,G.__r=0,x=M,I=0;var oe,se,le,ue=0,ce=[],de=S.__r,pe=S.diffed,he=S.__c,fe=S.unmount;function ge(e,t){S.__h&&S.__h(se,e,ue||t),ue=0;var r=se.__H||(se.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function ye(e){return ue=1,me(De,e)}function me(e,t,r){var a=ge(oe++,2);return a.t=e,a.__c||(a.__c=se,a.__=[r?r(t):De(void 0,t),function(e){var t=a.t(a.__[0],e);a.__[0]!==t&&(a.__=[t,a.__[1]],a.__c.setState({}))}]),a.__}function ve(e,t){var r=ge(oe++,3);!S.__s&&Me(r.__H,t)&&(r.__=e,r.__H=t,se.__H.__h.push(r))}function _e(e,t){var r=ge(oe++,4);!S.__s&&Me(r.__H,t)&&(r.__=e,r.__H=t,se.__h.push(r))}function ke(e){return ue=5,Te((function(){return{current:e}}),[])}function Ee(e,t,r){ue=6,_e((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==r?r:r.concat(e))}function Te(e,t){var r=ge(oe++,7);return Me(r.__H,t)?(r.__H=t,r.__h=e,r.__=e()):r.__}function be(e,t){return ue=8,Te((function(){return e}),t)}function Se(e){var t=se.context[e.__c],r=ge(oe++,9);return r.__c=e,t?(null==r.__&&(r.__=!0,t.sub(se)),t.props.value):e.__}function Ae(e,t){S.useDebugValue&&S.useDebugValue(t?t(e):e)}function Ce(e){var t=ge(oe++,10),r=ye();return t.__=e,se.componentDidCatch||(se.componentDidCatch=function(e){t.__&&t.__(e),r[1](e)}),[r[0],function(){r[1](void 0)}]}function Pe(){ce.some((function(e){if(e.__P)try{e.__H.__h.forEach(xe),e.__H.__h.forEach(Ie),e.__H.__h=[]}catch(t){return e.__H.__h=[],S.__e(t,e.__v),!0}})),ce=[]}S.__r=function(e){de&&de(e),oe=0;var t=(se=e.__c).__H;t&&(t.__h.forEach(xe),t.__h.forEach(Ie),t.__h=[])},S.diffed=function(e){pe&&pe(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==ce.push(t)&&le===S.requestAnimationFrame||((le=S.requestAnimationFrame)||function(e){var t,r=function(){clearTimeout(a),we&&cancelAnimationFrame(t),setTimeout(e)},a=setTimeout(r,100);we&&(t=requestAnimationFrame(r))})(Pe))},S.__c=function(e,t){t.some((function(e){try{e.__h.forEach(xe),e.__h=e.__h.filter((function(e){return!e.__||Ie(e)}))}catch(r){t.some((function(e){e.__h&&(e.__h=[])})),t=[],S.__e(r,e.__v)}})),he&&he(e,t)},S.unmount=function(e){fe&&fe(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(xe)}catch(e){S.__e(e,t.__v)}};var we="function"==typeof requestAnimationFrame;function xe(e){"function"==typeof e.u&&e.u()}function Ie(e){e.u=e.__()}function Me(e,t){return!e||t.some((function(t,r){return t!==e[r]}))}function De(e,t){return"function"==typeof t?t(e):t}function Re(e,t){for(var r in t)e[r]=t[r];return e}function Oe(e,t){for(var r in e)if("__source"!==r&&!(r in t))return!0;for(var a in t)if("__source"!==a&&e[a]!==t[a])return!0;return!1}var Le=function(e){var t,r;function a(t){var r;return(r=e.call(this,t)||this).isPureReactComponent=!0,r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.shouldComponentUpdate=function(e,t){return Oe(this.props,e)||Oe(this.state,t)},a}(j),Ne=S.__b;S.__b=function(e){e.type&&e.type.t&&e.ref&&(e.props.ref=e.ref,e.ref=null),Ne&&Ne(e)};var Ue="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Fe(e){function t(t,r){var a=Re({},t);return delete a.ref,e(a,(r=t.ref||r)&&("object"!=typeof r||"current"in r)?r:null)}return t.$$typeof=Ue,t.render=t,t.prototype.isReactComponent=t.t=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var Be=function(e,t){return e?W(e).reduce((function(e,r,a){return e.concat(t(r,a))}),[]):null},je={map:Be,forEach:Be,count:function(e){return e?W(e).length:0},only:function(e){if(1!==(e=W(e)).length)throw new Error("Children.only() expects only one child.");return e[0]},toArray:W},Ve=S.__e;function $e(e){return e&&((e=Re({},e)).__c=null,e.__k=e.__k&&e.__k.map($e)),e}function He(){this.__u=0,this.o=null,this.__b=null}function Ge(e){var t=e.__.__c;return t&&t.u&&t.u(e)}function Ke(){this.i=null,this.l=null}S.__e=function(e,t,r){if(e.then)for(var a,n=t;n=n.__;)if((a=n.__c)&&a.__c)return a.__c(e,t.__c);Ve(e,t,r)},(He.prototype=new j).__c=function(e,t){var r=this;null==r.o&&(r.o=[]),r.o.push(t);var a=Ge(r.__v),n=!1,i=function(){n||(n=!0,a?a(o):o())};t.__c=t.componentWillUnmount,t.componentWillUnmount=function(){i(),t.__c&&t.__c()};var o=function(){var e;if(!--r.__u)for(r.__v.__k[0]=r.state.u,r.setState({u:r.__b=null});e=r.o.pop();)e.forceUpdate()};r.__u++||r.setState({u:r.__b=r.__v.__k[0]}),e.then(i,i)},He.prototype.render=function(e,t){return this.__b&&(this.__v.__k&&(this.__v.__k[0]=$e(this.__b)),this.__b=null),[N(B,null,t.u?null:e.children),t.u&&e.fallback]};var We=function(e,t,r){if(++r[1]===r[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(r=e.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.i=r=r[2]}};(Ke.prototype=new j).u=function(e){var t=this,r=Ge(t.__v),a=t.l.get(e);return a[0]++,function(n){var i=function(){t.props.revealOrder?(a.push(n),We(t,e,a)):n()};r?r(i):i()}},Ke.prototype.render=function(e){this.i=null,this.l=new Map;var t=W(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var r=t.length;r--;)this.l.set(t[r],this.i=[1,0,this.i]);return e.children},Ke.prototype.componentDidUpdate=Ke.prototype.componentDidMount=function(){var e=this;e.l.forEach((function(t,r){We(e,r,t)}))};var ze=function(){function e(){}var t=e.prototype;return t.getChildContext=function(){return this.props.context},t.render=function(e){return e.children},e}();function qe(e){var t=this,r=e.container,a=N(ze,{context:t.context},e.vnode);return t.s&&t.s!==r&&(t.v.parentNode&&t.s.removeChild(t.v),ee(t.h),t.p=!1),e.vnode?t.p?(r.__k=t.__k,re(a,r),t.__k=r.__k):(t.v=document.createTextNode(""),ae("",r),r.appendChild(t.v),t.p=!0,t.s=r,re(a,r,t.v),t.__k=t.v.__k):t.p&&(t.v.parentNode&&t.s.removeChild(t.v),ee(t.h)),t.h=a,t.componentWillUnmount=function(){t.v.parentNode&&t.s.removeChild(t.v),ee(t.h)},null}function Ye(e,t){return N(qe,{vnode:e,container:t})}var Xe=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;j.prototype.isReactComponent={};var Qe="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,Je=S.event;function Ze(e,t){e["UNSAFE_"+t]&&!e[t]&&Object.defineProperty(e,t,{configurable:!1,get:function(){return this["UNSAFE_"+t]},set:function(e){this["UNSAFE_"+t]=e}})}S.event=function(e){Je&&(e=Je(e)),e.persist=function(){};var t=!1,r=!1,a=e.stopPropagation;e.stopPropagation=function(){a.call(e),t=!0};var n=e.preventDefault;return e.preventDefault=function(){n.call(e),r=!0},e.isPropagationStopped=function(){return t},e.isDefaultPrevented=function(){return r},e.nativeEvent=e};var et={configurable:!0,get:function(){return this.class}},tt=S.vnode;function rt(e){return!!e&&e.$$typeof===Qe}S.vnode=function(e){e.$$typeof=Qe;var t=e.type,r=e.props;if(t){if(r.class!=r.className&&(et.enumerable="className"in r,null!=r.className&&(r.class=r.className),Object.defineProperty(r,"className",et)),"function"!=typeof t){var a,n,i;for(i in r.defaultValue&&void 0!==r.value&&(r.value||0===r.value||(r.value=r.defaultValue),delete r.defaultValue),Array.isArray(r.value)&&r.multiple&&"select"===t&&(W(r.children).forEach((function(e){-1!=r.value.indexOf(e.props.value)&&(e.props.selected=!0)})),delete r.value),r)if(a=Xe.test(i))break;if(a)for(i in n=e.props={},r)n[Xe.test(i)?i.replace(/[A-Z0-9]/,"-$&").toLowerCase():i]=r[i]}!function(t){var r=e.type,a=e.props;if(a&&"string"==typeof r){var n={};for(var i in a)/^on(Ani|Tra|Tou)/.test(i)&&(a[i.toLowerCase()]=a[i],delete a[i]),n[i.toLowerCase()]=i;if(n.ondoubleclick&&(a.ondblclick=a[n.ondoubleclick],delete a[n.ondoubleclick]),n.onbeforeinput&&(a.onbeforeinput=a[n.onbeforeinput],delete a[n.onbeforeinput]),n.onchange&&("textarea"===r||"input"===r.toLowerCase()&&!/^fil|che|ra/i.test(a.type))){var o=n.oninput||"oninput";a[o]||(a[o]=a[n.onchange],delete a[n.onchange])}}}(),"function"==typeof t&&!t.m&&t.prototype&&(Ze(t.prototype,"componentWillMount"),Ze(t.prototype,"componentWillReceiveProps"),Ze(t.prototype,"componentWillUpdate"),t.m=!0)}tt&&tt(e)};var at=function(e,t){return e(t)},nt={useState:ye,useReducer:me,useEffect:ve,useLayoutEffect:_e,useRef:ke,useImperativeHandle:Ee,useMemo:Te,useCallback:be,useContext:Se,useDebugValue:Ae,version:"16.8.0",Children:je,render:function(e,t,r){if(null==t.__k)for(;t.firstChild;)t.removeChild(t.firstChild);return re(e,t),"function"==typeof r&&r(),e?e.__c:null},hydrate:function(e,t,r){return ae(e,t),"function"==typeof r&&r(),e?e.__c:null},unmountComponentAtNode:function(e){return!!e.__k&&(re(null,e),!0)},createPortal:Ye,createElement:N,createContext:ie,createFactory:function(e){return N.bind(null,e)},cloneElement:function(e){return rt(e)?ne.apply(null,arguments):e},createRef:F,Fragment:B,isValidElement:rt,findDOMNode:function(e){return e&&(e.base||1===e.nodeType&&e)||null},Component:j,PureComponent:Le,memo:function(e,t){function r(e){var r=this.props.ref,a=r==e.ref;return!a&&r&&(r.call?r(null):r.current=null),t?!t(this.props,e)||!a:Oe(this.props,e)}function a(t){return this.shouldComponentUpdate=r,N(e,t)}return a.prototype.isReactComponent=!0,a.displayName="Memo("+(e.displayName||e.name)+")",a.t=!0,a},forwardRef:Fe,unstable_batchedUpdates:at,StrictMode:B,Suspense:He,SuspenseList:Ke,lazy:function(e){var t,r,a;function n(n){if(t||(t=e()).then((function(e){r=e.default||e}),(function(e){a=e})),a)throw a;if(!r)throw t;return N(r,n)}return n.displayName="Lazy",n.t=!0,n}},it=(r(7),nt.createContext(null)),ot=function(e){e()},st={notify:function(){}},lt=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=st,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=function(){var e=ot,t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],r=t;r;)e.push(r),r=r.next;return e},subscribe:function(e){var a=!0,n=r={callback:e,next:null,prev:r};return n.prev?n.prev.next=n:t=n,function(){a&&null!==t&&(a=!1,n.next?n.next.prev=n.prev:r=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=st)},e}(),ut=function(e){var t=e.store,r=e.context,a=e.children,n=Te((function(){var e=new lt(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),i=Te((function(){return t.getState()}),[t]);ve((function(){var e=n.subscription;return e.trySubscribe(),i!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[n,i]);var o=r||it;return nt.createElement(o.Provider,{value:n},a)};function ct(){return(ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function dt(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}var pt=r(2),ht=r.n(pt),ft=r(1),gt="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?_e:ve,yt=[],mt=[null,null];function vt(e,t){var r=e[1];return[t.payload,r+1]}function _t(e,t,r){gt((function(){return e.apply(void 0,t)}),r)}function kt(e,t,r,a,n,i,o){e.current=a,t.current=n,r.current=!1,i.current&&(i.current=null,o())}function Et(e,t,r,a,n,i,o,s,l,u){if(e){var c=!1,d=null,p=function(){if(!c){var e,r,p=t.getState();try{e=a(p,n.current)}catch(e){r=e,d=e}r||(d=null),e===i.current?o.current||l():(i.current=e,s.current=e,o.current=!0,u({type:"STORE_UPDATED",payload:{error:r}}))}};return r.onStateChange=p,r.trySubscribe(),p(),function(){if(c=!0,r.tryUnsubscribe(),r.onStateChange=null,d)throw d}}}var Tt=function(){return[null,0]};function bt(e,t){void 0===t&&(t={});var r=t,a=r.getDisplayName,n=void 0===a?function(e){return"ConnectAdvanced("+e+")"}:a,i=r.methodName,o=void 0===i?"connectAdvanced":i,s=r.renderCountProp,l=void 0===s?void 0:s,u=r.shouldHandleStateChanges,c=void 0===u||u,d=r.storeKey,p=void 0===d?"store":d,h=(r.withRef,r.forwardRef),f=void 0!==h&&h,g=r.context,y=void 0===g?it:g,m=dt(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]),v=y;return function(t){var r=t.displayName||t.name||"Component",a=n(r),i=ct({},m,{getDisplayName:n,methodName:o,renderCountProp:l,shouldHandleStateChanges:c,storeKey:p,displayName:a,wrappedComponentName:r,WrappedComponent:t}),s=m.pure,u=s?Te:function(e){return e()};function d(r){var a=Te((function(){var e=r.reactReduxForwardedRef,t=dt(r,["reactReduxForwardedRef"]);return[r.context,e,t]}),[r]),n=a[0],o=a[1],s=a[2],l=Te((function(){return n&&n.Consumer&&Object(ft.isContextConsumer)(nt.createElement(n.Consumer,null))?n:v}),[n,v]),d=Se(l),p=Boolean(r.store)&&Boolean(r.store.getState)&&Boolean(r.store.dispatch);Boolean(d)&&Boolean(d.store);var h=p?r.store:d.store,f=Te((function(){return function(t){return e(t.dispatch,i)}(h)}),[h]),g=Te((function(){if(!c)return mt;var e=new lt(h,p?null:d.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[h,p,d]),y=g[0],m=g[1],_=Te((function(){return p?d:ct({},d,{subscription:y})}),[p,d,y]),k=me(vt,yt,Tt),E=k[0][0],T=k[1];if(E&&E.error)throw E.error;var b=ke(),S=ke(s),A=ke(),C=ke(!1),P=u((function(){return A.current&&s===S.current?A.current:f(h.getState(),s)}),[h,E,s]);_t(kt,[S,b,C,s,P,A,m]),_t(Et,[c,h,y,f,S,b,C,A,m,T],[h,y,f]);var w=Te((function(){return nt.createElement(t,ct({},P,{ref:o}))}),[o,t,P]);return Te((function(){return c?nt.createElement(l.Provider,{value:_},w):w}),[l,w,_])}var h=s?nt.memo(d):d;if(h.WrappedComponent=t,h.displayName=a,f){var g=nt.forwardRef((function(e,t){return nt.createElement(h,ct({},e,{reactReduxForwardedRef:t}))}));return g.displayName=a,g.WrappedComponent=t,ht()(g,t)}return ht()(h,t)}}function St(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function At(e,t){if(St(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(var n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(t,r[n])||!St(e[r[n]],t[r[n]]))return!1;return!0}var Ct=r(3),Pt=function(){return Math.random().toString(36).substring(7).split("").join(".")},wt={INIT:"@@redux/INIT"+Pt(),REPLACE:"@@redux/REPLACE"+Pt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Pt()}};function xt(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function It(e,t,r){var a;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(It)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var n=e,i=t,o=[],s=o,l=!1;function u(){s===o&&(s=o.slice())}function c(){if(l)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return i}function d(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(l)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return u(),s.push(e),function(){if(t){if(l)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,u();var r=s.indexOf(e);s.splice(r,1),o=null}}}function p(e){if(!xt(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,i=n(i,e)}finally{l=!1}for(var t=o=s,r=0;r<t.length;r++)(0,t[r])();return e}function h(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");n=e,p({type:wt.REPLACE})}function f(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(c())}return r(),{unsubscribe:t(r)}}})[Ct.a]=function(){return this},e}return p({type:wt.INIT}),(a={dispatch:p,subscribe:d,getState:c,replaceReducer:h})[Ct.a]=f,a}function Mt(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function Dt(e,t){return function(){return t(e.apply(this,arguments))}}function Rt(e,t){if("function"==typeof e)return Dt(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var a in e){var n=e[a];"function"==typeof n&&(r[a]=Dt(n,t))}return r}function Ot(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lt(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function Nt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(r,!0).forEach((function(t){Ot(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ut(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function Ft(e){return function(t,r){var a=e(t,r);function n(){return a}return n.dependsOnOwnProps=!1,n}}function Bt(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function jt(e,t){return function(t,r){r.displayName;var a=function(e,t){return a.dependsOnOwnProps?a.mapToProps(e,t):a.mapToProps(e)};return a.dependsOnOwnProps=!0,a.mapToProps=function(t,r){a.mapToProps=e,a.dependsOnOwnProps=Bt(e);var n=a(t,r);return"function"==typeof n&&(a.mapToProps=n,a.dependsOnOwnProps=Bt(n),n=a(t,r)),n},a}}var Vt=[function(e){return"function"==typeof e?jt(e):void 0},function(e){return e?void 0:Ft((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?Ft((function(t){return Rt(e,t)})):void 0}],$t=[function(e){return"function"==typeof e?jt(e):void 0},function(e){return e?void 0:Ft((function(){return{}}))}];function Ht(e,t,r){return ct({},r,{},e,{},t)}var Gt=[function(e){return"function"==typeof e?function(e){return function(t,r){r.displayName;var a,n=r.pure,i=r.areMergedPropsEqual,o=!1;return function(t,r,s){var l=e(t,r,s);return o?n&&i(l,a)||(a=l):(o=!0,a=l),a}}}(e):void 0},function(e){return e?void 0:function(){return Ht}}];function Kt(e,t,r,a){return function(n,i){return r(e(n,i),t(a,i),i)}}function Wt(e,t,r,a,n){var i,o,s,l,u,c=n.areStatesEqual,d=n.areOwnPropsEqual,p=n.areStatePropsEqual,h=!1;function f(n,h){var f,g,y=!d(h,o),m=!c(n,i);return i=n,o=h,y&&m?(s=e(i,o),t.dependsOnOwnProps&&(l=t(a,o)),u=r(s,l,o)):y?(e.dependsOnOwnProps&&(s=e(i,o)),t.dependsOnOwnProps&&(l=t(a,o)),u=r(s,l,o)):m?(f=e(i,o),g=!p(f,s),s=f,g&&(u=r(s,l,o)),u):u}return function(n,c){return h?f(n,c):(s=e(i=n,o=c),l=t(a,o),u=r(s,l,o),h=!0,u)}}function zt(e,t){var r=t.initMapStateToProps,a=t.initMapDispatchToProps,n=t.initMergeProps,i=dt(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),o=r(e,i),s=a(e,i),l=n(e,i);return(i.pure?Wt:Kt)(o,s,l,e,i)}function qt(e,t,r){for(var a=t.length-1;a>=0;a--){var n=t[a](e);if(n)return n}return function(t,a){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+a.wrappedComponentName+".")}}function Yt(e,t){return e===t}var Xt=function(e){var t=void 0===e?{}:e,r=t.connectHOC,a=void 0===r?bt:r,n=t.mapStateToPropsFactories,i=void 0===n?$t:n,o=t.mapDispatchToPropsFactories,s=void 0===o?Vt:o,l=t.mergePropsFactories,u=void 0===l?Gt:l,c=t.selectorFactory,d=void 0===c?zt:c;return function(e,t,r,n){void 0===n&&(n={});var o=n,l=o.pure,c=void 0===l||l,p=o.areStatesEqual,h=void 0===p?Yt:p,f=o.areOwnPropsEqual,g=void 0===f?At:f,y=o.areStatePropsEqual,m=void 0===y?At:y,v=o.areMergedPropsEqual,_=void 0===v?At:v,k=dt(o,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),E=qt(e,i,"mapStateToProps"),T=qt(t,s,"mapDispatchToProps"),b=qt(r,u,"mergeProps");return a(d,ct({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:E,initMapDispatchToProps:T,initMergeProps:b,pure:c,areStatesEqual:h,areOwnPropsEqual:g,areStatePropsEqual:m,areMergedPropsEqual:_},k))}}();function Qt(){return Se(it)}function Jt(e){void 0===e&&(e=it);var t=e===it?Qt:function(){return Se(e)};return function(){return t().store}}var Zt=Jt();function er(e){void 0===e&&(e=it);var t=e===it?Zt:Jt(e);return function(){return t().dispatch}}var tr=er(),rr=function(e,t){return e===t};function ar(e){void 0===e&&(e=it);var t=e===it?Qt:function(){return Se(e)};return function(e,r){void 0===r&&(r=rr);var a=t(),n=function(e,t,r,a){var n,i=me((function(e){return e+1}),0)[1],o=Te((function(){return new lt(r,a)}),[r,a]),s=ke(),l=ke(),u=ke(),c=ke(),d=r.getState();try{n=e!==l.current||d!==u.current||s.current?e(d):c.current}catch(e){throw s.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+s.current.stack+"\n\n"),e}return gt((function(){l.current=e,u.current=d,c.current=n,s.current=void 0})),gt((function(){function e(){try{var e=l.current(r.getState());if(t(e,c.current))return;c.current=e}catch(e){s.current=e}i()}return o.onStateChange=e,o.trySubscribe(),e(),function(){return o.tryUnsubscribe()}}),[r,o]),n}(e,r,a.store,a.subscription);return Ae(n),n}}var nr=ar();ot=at;var ir=r(4),or=r.n(ir);function sr(e){return null!=e}function lr(e,t){for(var r in t)e[r]=t[r];return e}var ur=/[?&#]intl=show/,cr=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getChildContext=function(){var e=this.props,t=e.scope,r=e.definition,a=e.mark,n=lr({},this.context.intl||{});return t&&(n.scope=t),r&&(n.dictionary=function e(t,r){var a=lr({},t);for(var n in r)r.hasOwnProperty(n)&&(t[n]&&r[n]&&"object"==typeof t[n]&&"object"==typeof r[n]?a[n]=e(t[n],r[n]):a[n]=t[n]||r[n]);return a}(n.dictionary||{},r)),(a||"undefined"!=typeof location&&String(location).match(ur))&&(n.mark=!0),{intl:n}},t.prototype.render=function(e){return e.children},t}(j);function dr(e,t){if(arguments.length<2)return t=e,function(e){return dr(e,t)};function r(r){return N(cr,t||{},N(e,r))}return r.getWrappedComponent=e&&e.getWrappedComponent||function(){return e},r}var pr,hr={};function fr(e,t){return pr=t||hr,e&&e.replace(/\{\{([\w.-]+)\}\}/g,gr)}function gr(e,t){for(var r=t.split("."),a=pr,n=0;n<r.length;n++)if(null==(a=a[r[n]]))return"";return"string"==typeof a&&a.match(/\{\{/)&&(a=fr(a,pr)),a}function yr(e,t,r,a,n,i){t&&(e=t+"."+e);var o=r&&or()(r,e);return(n||0===n)&&o&&"object"==typeof o&&(o=o.splice?o[n]||o[0]:0===n&&sr(o.none)?o.none:1===n&&sr(o.one||o.singular)?o.one||o.singular:o.some||o.many||o.plural||o.other||o),o&&fr(o,a)||i||null}function mr(e,t){var r=e.value,a=e.id,n=t.intl;if(n&&n.mark){var i="dictionary"+(n&&n.scope?"."+n.scope:"")+"."+a;return N("mark",{style:{background:r?or()(n,i)?"rgba(119,231,117,.5)":"rgba(229,226,41,.5)":"rgba(228,147,51,.5)"},title:a},r)}return r}function vr(e,t){var r=e.id,a=e.children,n=e.plural,i=e.fields,o=t.intl;return N(mr,{id:r,value:yr(r,o&&o.scope,o&&o.dictionary,i,n,a)})}function _r(e,t,r){var a={};for(var n in t=t||{},e=function(e){if("string"==typeof(e=e||{})&&(e=e.split(",")),"join"in e){for(var t={},r=0;r<e.length;r++){var a=e[r].trim();a&&(t[a.split(".").pop()]=a)}return t}return e}(e))if(e.hasOwnProperty(n)&&e[n]){var i=e[n];r||"string"!=typeof i?i.type===vr&&(i=lr({fallback:i.props.children},i.props),a[n]=yr(i.id,t.scope,t.dictionary,i.fields,i.plural,i.fallback)):a[n]=yr(i,t.scope,t.dictionary)}return a}function kr(e,t){var r=e.children,a=t.intl;return r&&r.length?r.map((function(e){return ne(e,_r(e.props,a,!0))})):r&&ne(r,_r(r.props,a,!0))}function Er(e){return N(kr,null,N(Tr,{html:N(vr,e),id:e.id}))}function Tr(e){var t=e.html,r=e.id,a=t?"string"==typeof t?N("span",{dangerouslySetInnerHTML:{__html:t}}):N("span",null,t):t;return N(mr,{id:r,value:a})}function br(e){return function(t){function r(r,a){var n=_r("function"==typeof e?e(r,a):e,a.intl);return N(t,lr(lr({},r),n))}return r.getWrappedComponent=t&&t.getWrappedComponent||function(){return t},r}}dr.intl=dr,dr.IntlProvider=cr,dr.Text=vr,dr.MarkupText=Er,dr.Localizer=kr,dr.withText=br;var Sr=dr;function Ar(e){return e&&"object"==typeof e&&!Array.isArray(e)}function Cr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];if(!r.length)return e;var n=r.shift();if(Ar(e)&&Ar(n))for(var i in n){var o,s;Ar(n[i])?(e[i]||Object.assign(e,((o={})[i]={},o)),Cr(e[i],n[i])):Object.assign(e,((s={})[i]=n[i],s))}return Cr.apply(void 0,[e].concat(r))}var Pr={get:function(){return{VERSION:"",DEBUG:{value:"",name:""},ERROR:{value:"",name:""},INFO:{value:"",name:""},OFF:{value:"",name:""},TIME:{value:"",name:""},TRACE:{value:"",name:""},WARN:{value:"",name:""},createDefaultHandler:function(){},debug:function(){},enabledFor:function(){},error:function(){},get:function(){},getLevel:function(){},info:function(){},log:function(){},setHandler:function(){},setLevel:function(){},time:function(){},timeEnd:function(){},trace:function(){},useDefaults:function(){},warn:function(){}}}},wr={};function xr(e){return Pr.get(e)}var Ir=xr,Mr="playkit-ui",Dr={UI_CLICKED:Mr+"-uiclicked",UI_VISIBILITY_CHANGED:Mr+"-uivisibilitychanged",GUI_RESIZE:Mr+"-guiresize",PLAYER_RESIZE:Mr+"-playerresize",VIDEO_RESIZE:Mr+"-videoresize",UI_PRESET_CHANGE:Mr+"-uipresetchange",USER_CLICKED_PLAY:Mr+"-userclickedplay",USER_CLICKED_PAUSE:Mr+"-userclickedpause",USER_CLICKED_REWIND:Mr+"-userclickedrewind",USER_CLICKED_FORWARD:Mr+"-userclickedforward",USER_CLICKED_LIVE_TAG:Mr+"-userclickedlivetag",USER_CLICKED_MUTE:Mr+"-userclickedmute",USER_CLICKED_UNMUTE:Mr+"-userclickedunmute",USER_CHANGED_VOLUME:Mr+"-userchangedvolume",USER_SELECTED_CAPTION_TRACK:Mr+"-userselectedcaptiontrack",USER_SHOWED_CAPTIONS:Mr+"-usershowedcaptions",USER_HID_CAPTIONS:Mr+"-userhidcaptions",USER_SELECTED_AUDIO_TRACK:Mr+"-userselectedaudiotrack",USER_SELECTED_QUALITY_TRACK:Mr+"-userselectedqualitytrack",USER_ENTERED_FULL_SCREEN:Mr+"-userenteredfullscreen",USER_EXITED_FULL_SCREEN:Mr+"-userexitedfullscreen",USER_ENTERED_PICTURE_IN_PICTURE:Mr+"-userenteredpictureinpicture",USER_EXITED_PICTURE_IN_PICTURE:Mr+"-userexitedpictureinpicture",USER_SELECTED_CAPTIONS_STYLE:Mr+"-userselectedcaptionsstyle",USER_SELECTED_SPEED:Mr+"-userselectedspeed",USER_SEEKED:Mr+"-userseeked",RESIZE:Mr+"-resize"},Rr={TAB:9,ENTER:13,ESC:27,SPACE:32,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,P:80,C:67,F:70,M:77,SEMI_COLON:186,COMMA:188,PERIOD:190};function Or(){return(Or=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Lr,Nr,Ur,Fr=function(e){return function(t){return function(r){var a,n;function i(){var t;return(t=r.call(this)||this).logger=Ir("UI "+e),t.logger.debug("Initialized"),t}return n=r,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,a.__proto__=n,i.prototype.render=function(){return N(t,Or({},this.props,{logger:this.logger}))},i}(j)}};function Br(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Vr="remove";function $r(e,t){return e[t]=e[t]||{before:[],after:[],replace:null},e[t]}var Hr,Gr,Kr,Wr={playerAreaComponents:null,hasPositionedComponents:!1,presetComponentsOnlyMode:!0},zr=Fr("PlayerArea")(Lr=Xt((function(e){return{activePresetName:e.shell.activePresetName}}))((Ur=Nr=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return jr(Br(t=e.call.apply(e,[this].concat(a))||this),"_updateAreaComponents",(function(e){var r=t.props,a=r.activePresetName,n=r.name;t.props.logger.debug("Player area '"+n+"' in preset '"+a+"' - update children components");var i={},o={appendedComponents:[],positionedComponentMap:i},s=!1;e.forEach((function(e){e.beforeComponent?($r(i,e.beforeComponent).before.push(e),s=!0):e.afterComponent?($r(i,e.afterComponent).after.push(e),s=!0):e.replaceComponent?($r(i,e.replaceComponent).replace=e,s=!0):o.appendedComponents.push(e)})),t.setState({playerAreaComponents:o,hasPositionedComponents:s,presetComponentsOnlyMode:!1})})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.shouldComponentUpdate=function(e,t){return e.shouldUpdate||this.state.playerAreaComponents!==t.playerAreaComponents||e.activePresetName!==this.props.activePresetName},n.componentDidUpdate=function(e){e.activePresetName!==this.props.activePresetName&&this._registerListener()},n._unregisterListener=function(){this.props.logger.debug("Player area '"+this.props.name+"' - unregister to changes"),"function"==typeof this._unregisterListenerCallback&&(this._unregisterListenerCallback(),this._unregisterListenerCallback=null)},n._registerListener=function(){var e=this.props,t=e.activePresetName,r=e.name;this._unregisterListener(),t&&r&&(this.props.logger.debug("Player area '"+r+"' in preset '"+t+"' - register to changes"),this._unregisterListenerCallback=this.context.playerAreaComponentsStore.listen(t,r,this._updateAreaComponents))},n.componentDidMount=function(){this.props.logger.debug("Player area '"+this.props.name+"' - handle did mount"),this.setState(Wr),this._registerListener(),this._actualChildren=[]},n.componentWillUpdate=function(e){var t=e.children;this._actualChildren=t&&t.type===B?t.props.children:t},n.componentWillUnmount=function(){var e=this.props.name;this.props.logger.debug("Player area '"+e+"' - handle will unmount"),this._unregisterListener()},n._renderUIComponent=function(e){return e.get?N(e.get,e.props):null},n.renderContent=function(e){return N(B,null,e)},n._getPositionedComponents=function(e){var t=this,r=this.state.playerAreaComponents,a=[];return W(e).forEach((function(e){if("div"===e.type||e.type===B)return e.props.children=t._getPositionedComponents(e.props.children),void a.push(e);var n,i=(n=e)&&n.type?n.type.displayName:null;if(i){var o=r.positionedComponentMap[i];if(o){var s=o.replace,l=o.before,u=o.after;if(s){if(s.get===Vr)return;return"string"!=typeof s.get&&(s.props=s.props||{},s.props.replacedComponentProps=e.props),void a.push(t._renderUIComponent(s))}l.length&&l.forEach((function(e){a.push(t._renderUIComponent(e))})),a.push(e),u.length&&u.forEach((function(e){a.push(t._renderUIComponent(e))}))}else a.push(e)}else a.push(e)})),a},n.render=function(){var e,t=this,r=this.props.show,a=this.state,n=a.playerAreaComponents,i=a.hasPositionedComponents;if(a.presetComponentsOnlyMode)return this.renderContent(this._actualChildren);if(!n||!r)return null;var o,s=[];i?s=this._getPositionedComponents(this._actualChildren):(o=s).push.apply(o,W(this._actualChildren));var l=n.appendedComponents.map((function(e){return t._renderUIComponent(e)})),u=s.length;return(e=s).splice.apply(e,[u,0].concat(l)),this.renderContent(s)},a}(j),jr(Nr,"defaultProps",{show:!0}),Lr=Ur))||Lr)||Lr,qr=function(e,t){var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(var n=0;n<r.length;n++)if(e[r[n]]!==t[r[n]])return!1;return!0};function Yr(){return(Yr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Xr={ADD_PLAYER_CLASS:"shell/ADD_PLAYER_CLASS",REMOVE_PLAYER_CLASS:"shell/REMOVE_PLAYER_CLASS",UPDATE_IS_MOBILE:"shell/UPDATE_IS_MOBILE",UPDATE_PLAYER_SIZE:"shell/UPDATE_PLAYER_SIZE",UPDATE_IS_SMALL_SIZE:"shell/UPDATE_IS_SMALL_SIZE",UPDATE_GUI_CLIENT_RECT:"shell/UPDATE_GUI_CLIENT_RECT",UPDATE_PLAYER_CLIENT_RECT:"shell/UPDATE_PLAYER_CLIENT_RECT",UPDATE_VIDEO_CLIENT_RECT:"shell/UPDATE_VIDEO_CLIENT_RECT",UPDATE_DOCUMENT_WIDTH:"shell/UPDATE_DOCUMENT_WIDTH",UPDATE_PLAYER_HOVER_STATE:"shell/UPDATE_PLAYER_HOVER_STATE",UPDATE_PLAYER_NAV_STATE:"shell/UPDATE_PLAYER_NAV_STATE",UPDATE_SMART_CONTAINER_OPEN:"shell/UPDATE_SMART_CONTAINER_OPEN",UPDATE_ACTIVE_PRESET_NAME:"shell/UPDATE_ACTIVE_PRESET_NAME",UPDATE_SIDE_PANEL_MODE:"shell/UPDATE_SIDE_PANEL_MODE",UPDATE_SIDE_PANEL_SIZE:"shell/UPDATE_SIDE_PANEL_SIZE",UPDATE_PRESET_SETTINGS:"shell/UPDATE_PRESET_SETTINGS",UPDATE_LAYOUT_STYLES:"shell/UPDATE_LAYOUT_STYLES"},Qr={VERTICAL:"vertical",HORIZONTAL:"horizontal"},Jr={LEFT:"left",TOP:"top",BOTTOM:"bottom",RIGHT:"right"},Zr={ALONGSIDE:"alongside",HIDDEN:"hidden",OVER:"over"},ea={Playback:"Playback",Live:"Live",Ads:"Ads",Error:"Error",Idle:"Idle"},ta={PlayerArea:"PlayerArea",PresetArea:"PresetArea",InteractiveArea:"InteractiveArea",VideoArea:"VideoArea",GuiArea:"GuiArea",TopBar:"TopBar",BottomBar:"BottomBar",PresetFloating:"PresetFloating",TopBarLeftControls:"TopBarLeftControls",TopBarRightControls:"TopBarRightControls",BottomBarLeftControls:"BottomBarLeftControls",BottomBarRightControls:"BottomBarRightControls",SidePanelTop:"SidePanelTop",SidePanelLeft:"SidePanelLeft",SidePanelRight:"SidePanelRight",SidePanelBottom:"SidePanelBottom",SeekBar:"SeekBar",LoadingSpinner:"LoadingSpinner"},ra={x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0},aa={position:"absolute",left:0,right:0,top:0,bottom:0},na={playerClasses:[],guiClientRect:ra,playerClientRect:ra,videoClientRect:ra,layoutStyles:{video:aa,gui:aa,sidePanels:(Hr={},Hr[Jr.LEFT]={},Hr[Jr.RIGHT]={},Hr[Jr.TOP]={},Hr[Jr.BOTTOM]={},Hr)},playerHover:!1,playerNav:!1,smartContainerOpen:!1,activePresetName:"",sidePanelsModes:(Gr={},Gr[Jr.LEFT]=Zr.HIDDEN,Gr[Jr.RIGHT]=Zr.HIDDEN,Gr[Jr.TOP]=Zr.HIDDEN,Gr[Jr.BOTTOM]=Zr.HIDDEN,Gr),sidePanelsSizes:(Kr={},Kr[Qr.VERTICAL]={min:240,max:480,ratio:.33},Kr[Qr.HORIZONTAL]={min:144,max:288,ratio:.33},Kr),presetSettings:{allowSidePanels:!1,allowPlayerArea:!1}},ia=function(e,t){var r;switch(void 0===e&&(e=na),t.type){case Xr.ADD_PLAYER_CLASS:return e.playerClasses.includes(t.className)?e:Yr({},e,{playerClasses:[].concat(e.playerClasses,[t.className])});case Xr.REMOVE_PLAYER_CLASS:return Yr({},e,{playerClasses:e.playerClasses.filter((function(e){return e!==t.className}))});case Xr.UPDATE_IS_MOBILE:return Yr({},e,{isMobile:t.isMobile});case Xr.UPDATE_PLAYER_SIZE:return Yr({},e,{playerSize:t.playerSize});case Xr.UPDATE_IS_SMALL_SIZE:return Yr({},e,{isSmallSize:t.isSmallSize});case Xr.UPDATE_GUI_CLIENT_RECT:return Yr({},e,{guiClientRect:t.guiClientRect});case Xr.UPDATE_PLAYER_CLIENT_RECT:return Yr({},e,{playerClientRect:t.playerClientRect});case Xr.UPDATE_LAYOUT_STYLES:var a,n=e.layoutStyles,i=n.sidePanels,o=n.video,s=n.gui,l=t.layoutStyles,u=l.sidePanels,c=l.video,d=l.gui;return Yr({},e,{layoutStyles:{sidePanels:(a={},a[Jr.LEFT]=qr(i[Jr.LEFT],u[Jr.LEFT])?i[Jr.LEFT]:u[Jr.LEFT],a[Jr.RIGHT]=qr(i[Jr.RIGHT],u[Jr.RIGHT])?i[Jr.RIGHT]:u[Jr.RIGHT],a[Jr.TOP]=qr(i[Jr.TOP],u[Jr.TOP])?i[Jr.TOP]:u[Jr.TOP],a[Jr.BOTTOM]=qr(i[Jr.BOTTOM],u[Jr.BOTTOM])?i[Jr.BOTTOM]:u[Jr.BOTTOM],a),video:qr(o,c)?o:c,gui:qr(s,d)?s:d}});case Xr.UPDATE_VIDEO_CLIENT_RECT:return Yr({},e,{videoClientRect:t.videoClientRect});case Xr.UPDATE_DOCUMENT_WIDTH:return Yr({},e,{documentWidth:t.documentWidth});case Xr.UPDATE_PLAYER_HOVER_STATE:return Yr({},e,{playerHover:t.hover});case Xr.UPDATE_PLAYER_NAV_STATE:return Yr({},e,{playerNav:t.nav});case Xr.UPDATE_SMART_CONTAINER_OPEN:return Yr({},e,{smartContainerOpen:t.open});case Xr.UPDATE_ACTIVE_PRESET_NAME:return Yr({},e,{activePresetName:t.activePresetName});case Xr.UPDATE_SIDE_PANEL_MODE:return Yr({},e,{sidePanelsModes:Yr({},e.sidePanelsModes,(r={},r[t.position]=t.sidePanelMode,r))});case Xr.UPDATE_SIDE_PANEL_SIZE:var p,h=t.options,f=h.ratio,g=h.min,y=h.max,m=e.sidePanelsSizes[t.orientation],v={ratio:"number"==typeof f&&f<=1?f:m.ratio,min:"number"==typeof g?g:m.min,max:"number"==typeof y?y:m.max};return Yr({},e,{sidePanelsSizes:Yr({},e.sidePanelsSizes,(p={},p[t.orientation]=v,p))});case Xr.UPDATE_PRESET_SETTINGS:return Yr({},e,{presetSettings:Yr({},{allowSidePanels:!1,allowPlayerArea:!1},t.presetSettings||{})});default:return e}},oa={addPlayerClass:function(e){return{type:Xr.ADD_PLAYER_CLASS,className:e}},removePlayerClass:function(e){return{type:Xr.REMOVE_PLAYER_CLASS,className:e}},updateIsMobile:function(e){return{type:Xr.UPDATE_IS_MOBILE,isMobile:e}},updatePlayerSize:function(e){return{type:Xr.UPDATE_PLAYER_SIZE,playerSize:e}},updateIsSmallSize:function(e){return{type:Xr.UPDATE_IS_SMALL_SIZE,isSmallSize:e}},updateGuiClientRect:function(e){return{type:Xr.UPDATE_GUI_CLIENT_RECT,guiClientRect:e}},updatePlayerClientRect:function(e){return{type:Xr.UPDATE_PLAYER_CLIENT_RECT,playerClientRect:e}},updateVideoClientRect:function(e){return{type:Xr.UPDATE_VIDEO_CLIENT_RECT,videoClientRect:e}},updateDocumentWidth:function(e){return{type:Xr.UPDATE_DOCUMENT_WIDTH,documentWidth:e}},updatePlayerHoverState:function(e){return{type:Xr.UPDATE_PLAYER_HOVER_STATE,hover:e}},updatePlayerNavState:function(e){return{type:Xr.UPDATE_PLAYER_NAV_STATE,nav:e}},updateSmartContainerOpen:function(e){return{type:Xr.UPDATE_SMART_CONTAINER_OPEN,open:e}},updateActivePresetName:function(e){return{type:Xr.UPDATE_ACTIVE_PRESET_NAME,activePresetName:e}},updateSidePanelMode:function(e,t){return{type:Xr.UPDATE_SIDE_PANEL_MODE,position:e,sidePanelMode:t}},updateSidePanelSize:function(e,t){return{type:Xr.UPDATE_SIDE_PANEL_SIZE,orientation:e,options:t}},updatePresetSettings:function(e){return{type:Xr.UPDATE_PRESET_SETTINGS,presetSettings:e}},updateLayoutStyles:function(e){return{type:Xr.UPDATE_LAYOUT_STYLES,layoutStyles:e}}};function sa(){return(sa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function la(e){return function(t){return sa({},Rt(e,t))}}var ua=r(0),ca=r.n(ua);function da(e,t,r){var a=r.config.components&&r.config.components[e];return a?Cr(t,a):t}function pa(e,t,r){return r.componentAlias===e?Cr(t,r.config):t}function ha(){return(ha=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var fa={UPDATE:"config/UPDATE",UPDATE_COMPONENT:"config/UPDATE_COMPONENT",RESET:"config/RESET"},ga={forceTouchUI:!1,showCCButton:!1,hoverTimeout:3e3,components:{watermark:{},seekbar:{},vrStereo:{},logo:{},fullscreen:{},sidePanels:{}}},ya=function(e,t){switch(void 0===e&&(e=ga),t.type){case fa.UPDATE:return ha({},e,Cr({},e,t.config));case fa.UPDATE_COMPONENT:var r;return ha({},e,{components:ha({},e.components,(r={},r[t.componentAlias]=Cr({},e.components[t.componentAlias],t.config),r))});default:return e}},ma={updateConfig:function(e){return{type:fa.UPDATE,config:e}},updateComponentConfig:function(e,t){return{type:fa.UPDATE_COMPONENT,componentAlias:e,config:t}}};function va(){return(va=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var _a={UPDATE_PLAYER_STATE:"engine/UPDATE_PLAYER_STATE",UPDATE_PRE_PLAYBACK:"engine/UPDATE_PRE_PLAYBACK",UPDATE_IS_PLAYING:"engine/UPDATE_IS_PLAYING",UPDATE_IS_PAUSED:"engine/UPDATE_IS_PAUSED",UPDATE_IS_SEEKING:"engine/UPDATE_IS_SEEKING",UPDATE_LAST_SEEK_POINT:"engine/UPDATE_LAST_SEEK_POINT",UPDATE_IS_CHANGING_SOURCE:"engine/UPDATE_IS_CHANGING_SOURCE",UPDATE_IS_ENDED:"engine/UPDATE_IS_ENDED",UPDATE_IS_PLAYBACK_STARTED:"engine/UPDATE_IS_PLAYBACK_STARTED",UPDATE_IS_PLAYBACK_ENDED:"engine/UPDATE_IS_PLAYBACK_ENDED",UPDATE_CURRENT_TIME:"engine/UPDATE_CURRENT_TIME",UPDATE_DURATION:"engine/UPDATE_DURATION",UPDATE_VOLUME:"engine/UPDATE_VOLUME",UPDATE_MUTED:"engine/UPDATE_MUTED",UPDATE_METADATA_LOADING_STATUS:"engine/UPDATE_METADATA_LOADING_STATUS",UPDATE_DATA_LOADING_STATUS:"engine/UPDATE_DATA_LOADING_STATUS",UPDATE_AUDIO_TRACKS:"engine/UPDATE_AUDIO_TRACKS",UPDATE_VIDEO_TRACKS:"engine/UPDATE_VIDEO_TRACKS",UPDATE_TEXT_TRACKS:"engine/UPDATE_TEXT_TRACKS",UPDATE_AD_BREAK:"engine/UPDATE_AD_BREAK",UPDATE_AD_BREAK_PROGRESS:"engine/UPDATE_AD_BREAK_PROGRESS",UPDATE_AD_BREAK_COMPLETED:"engine/UPDATE_AD_BREAK_COMPLETED",UPDATE_AD_IS_PLAYING:"engine/UPDATE_AD_IS_PLAYING",UPDATE_AD_SKIP_TIME_OFFSET:"engine/UPDATE_AD_SKIP_TIME_OFFSET",UPDATE_AD_SKIPPABLE_STATE:"engine/UPDATE_AD_SKIPPABLE_STATE",UPDATE_AD_URL:"engine/UPDATE_AD_URL",UPDATE_AD_IS_LINEAR:"engine/UPDATE_AD_IS_LINEAR",UPDATE_AD_IS_BUMPER:"engine/UPDATE_AD_IS_BUMPER",UPDATE_AD_CONTENT_TYPE:"engine/UPDATE_AD_CONTENT_TYPE",UPDATE_PLAYER_POSTER:"engine/UPDATE_PLAYER_POSTER",UPDATE_IS_LIVE:"engine/UPDATE_IS_LIVE",UPDATE_IS_DVR:"engine/UPDATE_IS_DVR",UPDATE_IS_IMG:"engine/UPDATE_IS_IMG",UPDATE_ERROR:"engine/ERROR",UPDATE_IS_IDLE:"engine/UPDATE_IS_IDLE",UPDATE_FALLBACK_TO_MUTED_AUTOPLAY:"engine/UPDATE_FALLBACK_TO_MUTED_AUTOPLAY",UPDATE_IS_VR:"engine/UPDATE_IS_VR",UPDATE_VR_STEREO_MODE:"engine/UPDATE_VR_STEREO_MODE",UPDATE_IS_CASTING:"engine/UPDATE_IS_CASTING",UPDATE_CAST_SESSION:"engine/UPDATE_CAST_SESSION",UPDATE_IS_CAST_AVAILABLE:"engine/UPDATE_IS_CAST_AVAILABLE",UPDATE_PLAYLIST:"engine/UPDATE_PLAYLIST",UPDATE_PICTURE_IN_PICTURE_SUPPORTED:"engine/UPDATE_PICTURE_IN_PICTURE_SUPPORTED",UPDATE_PICTURE_IN_PICTURE_MODE:"engine/UPDATE_PICTURE_IN_PICTURE_MODE",UPDATE_FULLSCREEN:"engine/UPDATE_FULLSCREEN"},ka={isIdle:!1,isPlaying:!1,isPaused:!1,isSeeking:!1,isEnded:!1,isPlaybackStarted:!1,isPlaybackEnded:!1,isChangingSource:!1,prePlayback:!0,metadataLoaded:!1,dataLoaded:!1,playerState:{previousState:"",currentState:""},fallbackToMutedAutoPlay:!1,poster:"",currentTime:0,lastSeekPoint:0,duration:0,volume:1,muted:!1,videoTracks:[],audioTracks:[],textTracks:[],adIsLinear:!1,adBreak:!1,adIsPlaying:!1,adSkipTimeOffset:0,adSkippableState:!1,adIsBumper:!1,adContentType:null,isLive:!1,isDvr:!1,isImg:!1,adProgress:{currentTime:0,duration:0},adUrl:"",hasError:!1,isVr:!1,vrStereoMode:!1,isCasting:!1,castSession:null,isCastAvailable:!1,pictureInPictureSupported:!1,isInPictureInPicture:!1,playlist:null,fullscreen:!1},Ea=function(e,t){switch(void 0===e&&(e=ka),t.type){case fa.UPDATE:return da("engine",e,t);case fa.UPDATE_COMPONENT:return pa("engine",e,t);case _a.UPDATE_ERROR:return va({},e,{hasError:t.hasError});case _a.UPDATE_PLAYER_STATE:return va({},e,{playerState:t.playerState});case _a.UPDATE_PRE_PLAYBACK:return va({},e,{prePlayback:t.prePlayback});case _a.UPDATE_IS_PLAYING:return va({},e,{isPlaying:t.isPlaying});case _a.UPDATE_IS_PAUSED:return va({},e,{isPaused:t.isPaused});case _a.UPDATE_IS_SEEKING:return va({},e,{isSeeking:t.isSeeking});case _a.UPDATE_LAST_SEEK_POINT:return va({},e,{lastSeekPoint:t.lastSeekPoint});case _a.UPDATE_IS_ENDED:return va({},e,{isEnded:t.isEnded});case _a.UPDATE_IS_PLAYBACK_STARTED:return va({},e,{isPlaybackStarted:t.isPlaybackStarted});case _a.UPDATE_IS_PLAYBACK_ENDED:return va({},e,{isPlaybackEnded:t.isPlaybackEnded});case _a.UPDATE_CURRENT_TIME:return va({},e,{currentTime:t.currentTime});case _a.UPDATE_DURATION:return va({},e,{duration:t.duration});case _a.UPDATE_VOLUME:return va({},e,{volume:t.volume});case _a.UPDATE_MUTED:return va({},e,{muted:t.muted});case _a.UPDATE_METADATA_LOADING_STATUS:return va({},e,{metadataLoaded:t.metadataLoaded});case _a.UPDATE_DATA_LOADING_STATUS:return va({},e,{dataLoaded:t.dataLoaded});case _a.UPDATE_AUDIO_TRACKS:return va({},e,{audioTracks:t.tracks});case _a.UPDATE_VIDEO_TRACKS:return va({},e,{videoTracks:t.tracks});case _a.UPDATE_TEXT_TRACKS:return va({},e,{textTracks:t.tracks});case _a.UPDATE_AD_BREAK:return va({},e,{adBreak:t.adBreak});case _a.UPDATE_AD_BREAK_PROGRESS:return va({},e,{adProgress:t.adProgress});case _a.UPDATE_AD_BREAK_COMPLETED:return va({},e,{adProgress:{currentTime:e.adProgress.duration,duration:e.adProgress.duration}});case _a.UPDATE_AD_IS_PLAYING:return va({},e,{adIsPlaying:t.adIsPlaying});case _a.UPDATE_AD_IS_LINEAR:return va({},e,{adIsLinear:t.adIsLinear});case _a.UPDATE_AD_SKIP_TIME_OFFSET:return va({},e,{adSkipTimeOffset:t.adSkipTimeOffset});case _a.UPDATE_AD_SKIPPABLE_STATE:return va({},e,{adSkippableState:t.adSkippableState});case _a.UPDATE_AD_URL:return va({},e,{adUrl:t.adUrl});case _a.UPDATE_AD_IS_BUMPER:return va({},e,{adIsBumper:t.adIsBumper});case _a.UPDATE_AD_CONTENT_TYPE:return va({},e,{adContentType:t.adContentType});case _a.UPDATE_PLAYER_POSTER:return va({},e,{poster:t.poster});case _a.UPDATE_IS_LIVE:return va({},e,{isLive:t.isLive});case _a.UPDATE_IS_DVR:return va({},e,{isDvr:t.isDvr});case _a.UPDATE_IS_IMG:return va({},e,{isImg:t.isImg});case _a.UPDATE_IS_IDLE:return va({},e,{isIdle:t.IsIdle});case _a.UPDATE_FALLBACK_TO_MUTED_AUTOPLAY:return va({},e,{fallbackToMutedAutoPlay:t.fallback});case _a.UPDATE_IS_VR:return va({},e,{isVr:t.isVr});case _a.UPDATE_VR_STEREO_MODE:return va({},e,{vrStereoMode:t.vrStereoMode});case _a.UPDATE_IS_CASTING:return va({},e,{isCasting:t.isCasting});case _a.UPDATE_CAST_SESSION:return va({},e,{castSession:t.castSession});case _a.UPDATE_IS_CAST_AVAILABLE:return va({},e,{isCastAvailable:t.isCastAvailable});case _a.UPDATE_IS_CHANGING_SOURCE:return va({},e,{isChangingSource:t.isChangingSource});case _a.UPDATE_PLAYLIST:return va({},e,{playlist:t.playlist});case _a.UPDATE_PICTURE_IN_PICTURE_SUPPORTED:return va({},e,{isPictureInPictureSupported:t.isPictureInPictureSupported});case _a.UPDATE_PICTURE_IN_PICTURE_MODE:return va({},e,{isInPictureInPicture:t.isInPictureInPicture});case _a.UPDATE_FULLSCREEN:return va({},e,{fullscreen:t.fullscreen});default:return e}},Ta={updateHasError:function(e){return{type:_a.UPDATE_ERROR,hasError:e}},updatePlayerState:function(e,t){return{type:_a.UPDATE_PLAYER_STATE,playerState:{prevoiusState:e,currentState:t}}},updatePrePlayback:function(e){return{type:_a.UPDATE_PRE_PLAYBACK,prePlayback:e}},updateIsPlaying:function(e){return{type:_a.UPDATE_IS_PLAYING,isPlaying:e}},updateIsPaused:function(e){return{type:_a.UPDATE_IS_PAUSED,isPaused:e}},updateIsSeeking:function(e){return{type:_a.UPDATE_IS_SEEKING,isSeeking:e}},updateLastSeekPoint:function(e){return{type:_a.UPDATE_LAST_SEEK_POINT,lastSeekPoint:e}},updateIsEnded:function(e){return{type:_a.UPDATE_IS_ENDED,isEnded:e}},updateIsPlaybackStarted:function(e){return{type:_a.UPDATE_IS_PLAYBACK_STARTED,isPlaybackStarted:e}},updateIsPlaybackEnded:function(e){return{type:_a.UPDATE_IS_PLAYBACK_ENDED,isPlaybackEnded:e}},updateCurrentTime:function(e){return{type:_a.UPDATE_CURRENT_TIME,currentTime:e}},updateDuration:function(e){return{type:_a.UPDATE_DURATION,duration:e}},updateVolume:function(e){return{type:_a.UPDATE_VOLUME,volume:e}},updateMuted:function(e){return{type:_a.UPDATE_MUTED,muted:e}},updateMetadataLoadingStatus:function(e){return{type:_a.UPDATE_METADATA_LOADING_STATUS,metadataLoaded:e}},updateDataLoadingStatus:function(e){return{type:_a.UPDATE_DATA_LOADING_STATUS,dataLoaded:e}},updateAudioTracks:function(e){return{type:_a.UPDATE_AUDIO_TRACKS,tracks:e}},updateVideoTracks:function(e){return{type:_a.UPDATE_VIDEO_TRACKS,tracks:e}},updateTextTracks:function(e){return{type:_a.UPDATE_TEXT_TRACKS,tracks:e}},updateAdBreak:function(e){return{type:_a.UPDATE_AD_BREAK,adBreak:e}},updateAdBreakProgress:function(e,t){return{type:_a.UPDATE_AD_BREAK_PROGRESS,adProgress:{currentTime:e,duration:t}}},updateAdBreakCompleted:function(){return{type:_a.UPDATE_AD_BREAK_COMPLETED}},updateAdIsPlaying:function(e){return{type:_a.UPDATE_AD_IS_PLAYING,adIsPlaying:e}},updateAdSkipTimeOffset:function(e){return{type:_a.UPDATE_AD_SKIP_TIME_OFFSET,adSkipTimeOffset:e}},updateAdSkippableState:function(e){return{type:_a.UPDATE_AD_SKIPPABLE_STATE,adSkippableState:e}},updateAdClickUrl:function(e){return{type:_a.UPDATE_AD_URL,adUrl:e}},updateAdIsLinear:function(e){return{type:_a.UPDATE_AD_IS_LINEAR,adIsLinear:e}},updateAdIsBumper:function(e){return{type:_a.UPDATE_AD_IS_BUMPER,adIsBumper:e}},updateAdContentType:function(e){return{type:_a.UPDATE_AD_CONTENT_TYPE,adContentType:e}},updatePlayerPoster:function(e){return{type:_a.UPDATE_PLAYER_POSTER,poster:e}},updateIsLive:function(e){return{type:_a.UPDATE_IS_LIVE,isLive:e}},updateIsDvr:function(e){return{type:_a.UPDATE_IS_DVR,isDvr:e}},updateIsImg:function(e){return{type:_a.UPDATE_IS_IMG,isImg:e}},updateIsIdle:function(e){return{type:_a.UPDATE_IS_IDLE,IsIdle:e}},updateFallbackToMutedAutoPlay:function(e){return{type:_a.UPDATE_FALLBACK_TO_MUTED_AUTOPLAY,fallback:e}},updateIsVr:function(e){return{type:_a.UPDATE_IS_VR,isVr:e}},updateVrStereoMode:function(e){return{type:_a.UPDATE_VR_STEREO_MODE,vrStereoMode:e}},updateIsCasting:function(e){return{type:_a.UPDATE_IS_CASTING,isCasting:e}},updateCastSession:function(e){return{type:_a.UPDATE_CAST_SESSION,castSession:e}},updateIsCastAvailable:function(e){return{type:_a.UPDATE_IS_CAST_AVAILABLE,isCastAvailable:e}},updateIsChangingSource:function(e){return{type:_a.UPDATE_IS_CHANGING_SOURCE,isChangingSource:e}},updatePlaylist:function(e){return{type:_a.UPDATE_PLAYLIST,playlist:e}},updatePictureInPictureSupport:function(e){return{type:_a.UPDATE_PICTURE_IN_PICTURE_SUPPORTED,isPictureInPictureSupported:e}},updateIsInPictureInPicture:function(e){return{type:_a.UPDATE_PICTURE_IN_PICTURE_MODE,isInPictureInPicture:e}},updateFullscreen:function(e){return{type:_a.UPDATE_FULLSCREEN,fullscreen:e}}},ba=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.getChildContext=function(){return{player:this.props.player}},n.render=function(){return this.props.children&&W(this.props.children)[0]||null},a}(j);function Sa(){return(Sa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Aa=function(e){return function(t){var r,a;function n(){return t.apply(this,arguments)||this}return a=t,(r=n).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a,n.prototype.render=function(){var t=this.context.player;return N(e,Sa({},this.props,{player:t}))},n}(j)};function Ca(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Pa,wa,xa=function(){function e(){this._map=new Map}var t=e.prototype;return t.push=function(e,t){if(this._map.has(e)){var r=this._map.get(e);Array.isArray(r)&&(r.push(t),this._map.set(e,r))}else this._map.set(e,[t])},t.set=function(e,t){this._map.set(e,t)},t.has=function(e){return this._map.has(e)},t.get=function(e){var t=this._map.get(e);return t?t.slice():[]},t.getAll=function(){for(var e,t=[],r=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ca(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ca(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(this._map.values());!(e=r()).done;){var a=e.value;t=t.concat(a)}return t},t.remove=function(e,t){if(this._map.has(e)){var r=this._map.get(e);if(Array.isArray(r))for(var a=0;a<r.length;++a)r[a]===t&&(r.splice(a,1),--a)}},t.keys=function(){return this._map.keys()},t.clear=function(){this._map.clear()},e}(),Ia=function(){function e(e,t){this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance?window.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1,t&&(this.payload=t)}var t=e.prototype;return t.preventDefault=function(){},t.stopImmediatePropagation=function(){this.stopped=!0},t.stopPropagation=function(){},e}();wa=Dr,"Type"in(Pa=Ia)?Object.defineProperty(Pa,"Type",{value:wa,enumerable:!0,configurable:!0,writable:!0}):Pa.Type=wa;var Ma=function(){function e(){this._listeners=new xa,this.dispatchTarget=this,this.__logger=Ir("UI FakeEventTarget")}var t=e.prototype;return t.addEventListener=function(e,t){this._listeners.push(e,t)},t.removeEventListener=function(e,t){this._listeners.remove(e,t)},t.dispatchEvent=function(e){for(var t=this._listeners.get(e.type)||[],r=0;r<t.length;++r){e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;var a=t[r];try{a.handleEvent?a.handleEvent(e):a.call(this,e)}catch(t){this.__logger.error("Error occurred when handling event: "+e.type+".",t)}if(e.stopped)break}return e.defaultPrevented},e}();function Da(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Ra=function(){function e(){this._bindingMap=new xa}var t=e.prototype;return t.destroy=function(){return this.removeAll(),this._bindingMap=null,Promise.resolve()},t.listenOnce=function(e,t,r,a){var n=this;this.listen(e,t,(function a(i){n.unlisten(e,t,a),r.call(n,i)}),a)},t.listen=function(e,t,r,a){var n=new Oa(e,t,r,a);this._bindingMap&&this._bindingMap.push(t,n)},t.unlisten=function(e,t,r){if(this._bindingMap)for(var a=this._bindingMap.get(t),n=0;n<a.length;++n){var i=a[n];i.target!==e||i.listener!==r&&r||(i.unlisten(),this._bindingMap&&this._bindingMap.remove(t,i))}},t.removeAll=function(){if(this._bindingMap){for(var e,t=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Da(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Da(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(this._bindingMap.getAll());!(e=t()).done;)e.value.unlisten();this._bindingMap&&this._bindingMap.clear()}},e}(),Oa=function(){function e(e,t,r,a){this.target=e,this.type=t,this.listener=r,this.options=a,this.target.addEventListener(t,r,!1)}return e.prototype.unlisten=function(){this.target&&(this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=null)},e}();function La(){return(La=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Na(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ua(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Fa,Ba=function(e){return function(t){var r,a;function n(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Ua(Na(e=t.call.apply(t,[this].concat(a))||this),"eventManager",new Ra),e}a=t,(r=n).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a;var i=n.prototype;return i.componentWillUnmount=function(){this.eventManager&&(this.eventManager.destroy(),this.eventManager=null)},i.render=function(){return N(e,La({},this.props,{eventManager:this.eventManager}))},n}(j)},ja=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.USER_SELECTED_AUDIO_TRACK)||this).payload={audioTrack:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),Va=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.USER_SELECTED_CAPTION_TRACK)||this).payload={captionTrack:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),$a=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.USER_SELECTED_CAPTIONS_STYLE)||this).payload={captionsStyle:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),Ha=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.USER_SELECTED_QUALITY_TRACK)||this).payload={qualityTrack:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),Ga=function(e){var t,r;function a(t,r){var a;return(a=e.call(this,Ia.Type.USER_SEEKED)||this).payload={from:t,to:r},a}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),Ka=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.USER_SELECTED_SPEED)||this).payload={speed:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),Wa=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.UI_VISIBILITY_CHANGED)||this).payload={visible:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),za=function(e){var t,r;function a(t,r){var a;return(a=e.call(this,Ia.Type.USER_CLICKED_REWIND)||this).payload={from:t,to:r},a}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),qa=function(e){var t,r;function a(t,r){var a;return(a=e.call(this,Ia.Type.USER_CLICKED_FORWARD)||this).payload={from:t,to:r},a}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),Ya=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.USER_CHANGED_VOLUME)||this).payload={volume:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia);function Xa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ja=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Qa(Xa(t=e.call.apply(e,[this].concat(a))||this),"_notifyClick",(function(e){return tn(t.props.store,e,t.props.player)})),Qa(Xa(t),"_notifyChange",(function(e){return en(t.props.store,e,t.props.player)})),Qa(Xa(t),"_notifyHoverChange",(function(e){return Za(t.props.store,e,t.props.player)})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.getChildContext=function(){return{notifyClick:this._notifyClick,notifyChange:this._notifyChange,notifyHoverChange:this._notifyHoverChange}},n.render=function(){return this.props.children&&W(this.props.children)[0]||null},a}(j);function Za(e,t,r){var a=e.getState().engine,n=e.getState().shell;!a.adBreak&&a.isPlaying&&n.playerHover!==t.payload.hover&&r.dispatchEvent(new Wa(t.payload.hover))}function en(e,t,r){switch(t.name){case"Volume":r.dispatchEvent(new Ya(t.payload.volume));break;case"SeekBarPlaybackContainer":case"SeekBarLivePlaybackContainer":r.dispatchEvent(new Ga(t.payload.from,t.payload.to));break;case"ActivePreset":r.dispatchEvent(new Ia(Ia.Type.UI_PRESET_CHANGE,t.payload))}}function tn(e,t,r){switch(t.name){case"Keyboard":sn[t.payload.key](e,t,r);break;case"OverlayAction":!function(e,t,r){"PlayPause"===t.payload.type?rn(e,0,r):"Fullscreen"===t.payload.type&&nn(0,0,r)}(e,t,r);break;case"Settings":!function(e,t,r){t.payload.type===r.Track.VIDEO?r.dispatchEvent(new Ha(t.payload.track)):r.dispatchEvent(new Ka(t.payload.speed))}(0,t,r);break;case"CVAAOverlay":r.dispatchEvent(new $a(t.payload.textStyle));break;case"Fullscreen":nn(0,0,r);break;case"Language":!function(e,t,r){t.payload.type===r.Track.AUDIO?r.dispatchEvent(new ja(t.payload.track)):t.payload.type===r.Track.TEXT&&r.dispatchEvent(new Va(t.payload.track))}(0,t,r);break;case"Shell":r.dispatchEvent(new Ia(Ia.Type.UI_CLICKED));break;case"Rewind":r.dispatchEvent(new za(t.payload.from,t.payload.to));break;case"Forward":r.dispatchEvent(new qa(t.payload.from,t.payload.to));break;case"LiveTag":r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_LIVE_TAG));break;case"PrePlaybackPlayOverlay":case"PlayPause":rn(e,0,r);break;case"Volume":an(e,0,r);break;case"PictureInPicture":on(0,0,r);break;case"ClosedCaptions":!function(e,t,r){t.payload?r.dispatchEvent(new Ia(Ia.Type.USER_HID_CAPTIONS)):r.dispatchEvent(new Ia(Ia.Type.USER_SHOWED_CAPTIONS))}(0,t,r)}}function rn(e,t,r){var a=e.getState().engine;a.adBreak?a.adIsPlaying?r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_PAUSE)):r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_PLAY)):a.isPlaying?r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_PAUSE)):r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_PLAY))}function an(e,t,r){e.getState().engine.muted?r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_MUTE)):r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_UNMUTE))}function nn(e,t,r){r.isFullscreen()?r.dispatchEvent(new Ia(Ia.Type.USER_EXITED_FULL_SCREEN)):r.dispatchEvent(new Ia(Ia.Type.USER_ENTERED_FULL_SCREEN))}function on(e,t,r){r.isInPictureInPicture()?r.dispatchEvent(new Ia(Ia.Type.USER_EXITED_PICTURE_IN_PICTURE)):r.dispatchEvent(new Ia(Ia.Type.USER_ENTERED_PICTURE_IN_PICTURE))}var sn=((Fa={})[Rr.SPACE]=function(e,t,r){rn(e,0,r)},Fa[Rr.UP]=function(e,t,r){r.dispatchEvent(new Ya(t.payload.volume))},Fa[Rr.DOWN]=function(e,t,r){r.dispatchEvent(new Ya(t.payload.volume))},Fa[Rr.F]=function(e,t,r){nn(0,0,r)},Fa[Rr.P]=function(e,t,r){on(0,0,r)},Fa[Rr.ESC]=function(e,t,r){nn(0,0,r)},Fa[Rr.LEFT]=function(e,t,r){r.dispatchEvent(new Ga(t.payload.from,t.payload.to))},Fa[Rr.RIGHT]=function(e,t,r){r.dispatchEvent(new Ga(t.payload.from,t.payload.to))},Fa[Rr.HOME]=function(e,t,r){r.dispatchEvent(new Ga(t.payload.from,t.payload.to))},Fa[Rr.END]=function(e,t,r){r.dispatchEvent(new Ga(t.payload.from,t.payload.to))},Fa[Rr.M]=function(e,t,r){an(e,0,r)},Fa[Rr.SEMI_COLON]=function(e,t,r){r.dispatchEvent(new Ka(t.payload.speed))},Fa[Rr.PERIOD]=function(e,t,r){r.dispatchEvent(new Ka(t.payload.speed))},Fa[Rr.COMMA]=function(e,t,r){r.dispatchEvent(new Ka(t.payload.speed))},Fa[Rr.C]=function(e,t,r){r.dispatchEvent(new Va(t.payload.track))},Fa);function ln(){return(ln=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var un,cn,dn,pn,hn=function(e){return function(t){return function(r){var a,n;function i(){return r.apply(this,arguments)||this}n=r,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,a.__proto__=n;var o=i.prototype;return o.notifyClick=function(t){this.context.notifyClick({name:e,payload:t})},o.notifyChange=function(t){this.context.notifyChange({name:e,payload:t})},o.notifyHoverChange=function(t){this.context.notifyHoverChange({name:e,payload:t})},o.render=function(){var e=this;return N(t,ln({},this.props,{notifyHoverChange:function(t){return e.notifyHoverChange(t)},notifyChange:function(t){return e.notifyChange(t)},notifyClick:function(t){return e.notifyClick(t)}}))},i}(j)}},fn=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.destroy=function(){this._observer&&this._observer.disconnect(),this._observer=null,this._el=null},n.init=function(e){this._observer||(this._el=e,window.ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))},n._createNativeObserver=function(){var e=this;this._observer=new window.ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))},n._createIframeObserver=function(){this._observer=new gn(this._triggerResize.bind(this))},n._triggerResize=function(){this.dispatchEvent(new Ia(Ia.Type.RESIZE))},a}(Ma),gn=function(){function e(e){!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"_observersStore",{}),this._onChangeCallback=e}var t=e.prototype;return t.observe=function(e){var t=this,r=this._createIframe(),a=e.getAttribute("id");this._observersStore[a]=r,e.appendChild(r),r.contentWindow.onresize=function(){return t._onChangeCallback()}},t.disconnect=function(){for(var e in this._observersStore){var t=document.getElementById(e),r=this._observersStore[e];r.onresize=null,t&&(t.removeChild(r),delete this._observersStore[t.getAttribute("id")])}},t._createIframe=function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e},e}(),yn=function(e,t,r){var a;return void 0===r&&(r=!0),function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var s=void 0;r&&!a&&e.apply(s,i),clearTimeout(a),a=setTimeout((function(){a=null,r||e.apply(s,i)}),t)}};function mn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _n(){return(_n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var kn,En={TINY:"tiny",EXTRA_SMALL:"extrasmall",SMALL:"small",MEDIUM:"medium",LARGE:"large",EXTRA_LARGE:"extralarge"},Tn=(un=Xt((function(e){return{targetId:e.config.targetId,forceTouchUI:e.config.forceTouchUI,hoverTimeout:e.config.hoverTimeout,metadataLoaded:e.engine.metadataLoaded,currentState:e.engine.playerState.currentState,playerClasses:e.shell.playerClasses,isMobile:e.shell.isMobile,playerSize:e.shell.playerSize,isCasting:e.engine.isCasting,guiClientRect:e.shell.guiClientRect,playerHover:e.shell.playerHover,playerNav:e.shell.playerNav,seekbarDraggingActive:e.seekbar.draggingActive,seekbarHoverActive:e.seekbar.hoverActive,volumeHoverActive:e.volume.hover,adBreak:e.engine.adBreak,prePlayback:e.engine.prePlayback,smartContainerOpen:e.shell.smartContainerOpen,fullscreen:e.engine.fullscreen,fallbackToMutedAutoPlay:e.engine.fallbackToMutedAutoPlay,playlist:e.engine.playlist}}),la(_n({},oa,Ta))),cn=Fr("Shell"),dn=hn("Shell"),un(pn=Aa(pn=Ba(pn=cn(pn=dn(pn=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return vn(mn(t=e.call.apply(e,[this].concat(a))||this),"onMouseOver",(function(){t.props.isMobile||t.state.nav&&(t.setState({nav:!1}),t.props.updatePlayerNavState(!1))})),vn(mn(t),"onMouseLeave",(function(e){Object.prototype.hasOwnProperty.call(e,"toElement")&&(t.props.isMobile||t.state.hover&&t._updatePlayerHover(!1))})),vn(mn(t),"onMouseMove",(function(){t.props.isMobile||t._updatePlayerHoverState()})),vn(mn(t),"onMouseUp",(function(){t.unMuteFallback(),t.props.notifyClick(),t._startHoverTimeout()})),vn(mn(t),"onTouchEnd",(function(e){t.props.prePlayback||(t.props.fallbackToMutedAutoPlay&&(t.props.player.muted=!1),t.state.hover||e.stopPropagation(),t._updatePlayerHoverState())})),vn(mn(t),"onKeyDown",(function(e){t.state.nav||e.keyCode!==Rr.TAB||(t.setState({nav:!0}),t.props.updatePlayerNavState(!0)),!t.state.nav||e.keyCode!==Rr.ENTER&&e.keyCode!==Rr.SPACE||(t.unMuteFallback(),e.srcElement.contains(t._playerRef)&&(e.preventDefault(),t.props.player.paused?t.props.player.play():t.props.player.pause()))})),vn(mn(t),"_onWindowResize",(function(){t._updatePlayerClientRect(),document.body&&t.props.updateDocumentWidth(document.body.clientWidth)})),vn(mn(t),"_updatePlayerClientRect",(function(){var e=document.getElementById(t.props.targetId);e&&t.props.updatePlayerClientRect(e.getBoundingClientRect())})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.unMuteFallback=function(){this.props.fallbackToMutedAutoPlay&&(this.props.player.muted=!1)},n.componentWillMount=function(){var e=this.props,t=e.player,r=e.forceTouchUI;this._environmentClasses=["playkit-"+t.env.os.name.replace(/ /g,"-"),"playkit-"+t.env.browser.name.replace(/ /g,"-")];var a=t.env,n=a.isIPadOS,i=a.isTablet,o=a.isMobile;this.props.updateIsMobile(n||i||o||r)},n.componentDidMount=function(){var e=this,t=this.props,r=t.player,a=t.eventManager;a.listen(window,"resize",yn(this._onWindowResize,100)),a.listen(document,"scroll",yn(this._updatePlayerClientRect,100)),this._playerResizeWatcher=new fn,this._playerResizeWatcher.init(document.getElementById(this.props.targetId)),a.listen(this._playerResizeWatcher,Ia.Type.RESIZE,yn(this._onWindowResize,100)),a.listen(r,r.Event.FIRST_PLAY,(function(){return e._onWindowResize()})),this._onWindowResize()},n.componentWillUnmount=function(){this._clearHoverTimeout(),this._playerResizeWatcher.destroy()},n._updatePlayerHoverState=function(){this.props.prePlayback||(this.state.hover||this._updatePlayerHover(!0),this._startHoverTimeout())},n._updatePlayerHover=function(e){this.props.updatePlayerHoverState(e),this.props.notifyHoverChange({hover:e}),this.setState({hover:e})},n._canEndHoverState=function(){return!this.props.seekbarDraggingActive&&!this.props.seekbarHoverActive&&!this.props.volumeHoverActive&&!this.props.smartContainerOpen&&(!this.props.player.paused||this.props.adBreak)},n._startHoverTimeout=function(){var e=this;this._clearHoverTimeout(),this.props.hoverTimeout&&(this.hoverTimeout=setTimeout((function(){e._canEndHoverState()&&e._updatePlayerHover(!1)}),this.props.hoverTimeout))},n._clearHoverTimeout=function(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)},n.componentDidUpdate=function(e){(this.state.hover!==this.props.playerHover||"playing"===this.props.currentState&&"paused"===e.currentState||!this.props.prePlayback&&e.prePlayback||!this.props.adBreak&&e.adBreak||this.props.adBreak&&!e.adBreak)&&(this.state.hover!==this.props.playerHover&&this.props.notifyHoverChange({hover:this.props.playerHover}),this._updatePlayerHoverState())},n.render=function(e){var t=this,r=[ca.a.player,ca.a.skinDefault].concat(this._environmentClasses).concat(e.playerClasses);return this.props.prePlayback&&r.push(ca.a.prePlayback),this.props.isCasting&&r.push("playkit-casting"),this.props.isMobile&&r.push(ca.a.touch),this.props.playerNav&&r.push(ca.a.nav),(this.props.playerHover||this.props.playerNav)&&r.push(ca.a.hover),this.props.metadataLoaded&&r.push(ca.a.metadataLoaded),this.props.adBreak&&r.push(ca.a.adBreak),this.props.metadataLoaded&&r.push(ca.a["state-"+this.props.currentState]),this.props.seekbarDraggingActive&&r.push(ca.a.hover),this.props.fullscreen&&r.push(ca.a.fullscreen),this.props.playlist&&r.push(ca.a.playlist),this.props.guiClientRect&&(this.props.guiClientRect.width<=280?(r.push(ca.a.sizeTy),this.props.updatePlayerSize(En.TINY)):this.props.guiClientRect.width<=380?(r.push(ca.a.sizeXs),this.props.updatePlayerSize(En.EXTRA_SMALL)):this.props.guiClientRect.width<=480?(r.push(ca.a.sizeSm),this.props.updatePlayerSize(En.SMALL)):this.props.guiClientRect.width<=768?(r.push(ca.a.sizeMd),this.props.updatePlayerSize(En.MEDIUM)):this.props.guiClientRect.width<=1024?(r.push(ca.a.sizeLg),this.props.updatePlayerSize(En.LARGE)):this.props.updatePlayerSize(En.EXTRA_LARGE),this.props.updateIsSmallSize([En.SMALL,En.EXTRA_SMALL].includes(this.props.playerSize))),r.push("notranslate"),N("div",{tabIndex:"0",ref:function(e){return t._playerRef=e},"aria-label":"Video Player",className:r=r.join(" "),onTouchEnd:this.onTouchEnd,onMouseUp:this.onMouseUp,onMouseOver:this.onMouseOver,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,onKeyDown:this.onKeyDown},e.children)},a}(j))||pn)||pn)||pn)||pn)||pn);function bn(){return(bn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Sn(e){var t,r=e.sidePanelsSizes,a=e.sidePanelsModes,n=e.playerClientRect,i=e.isVideo,o=r[Qr.VERTICAL],s=n.width,l=Math.max(o.min,Math.min(o.max,s*o.ratio)),u=a[Jr.LEFT],c=a[Jr.RIGHT],d=s-(t=i?u===Zr.ALONGSIDE&&c===Zr.ALONGSIDE?2:1:u!==Zr.HIDDEN&&c!==Zr.HIDDEN?2:1)*l;return s<480&&(d=s,l=s),{verticalPanelWidth:l,videoWidth:d,verticalPanelCount:t}}function An(e){var t,r=e.sidePanelsSizes,a=e.sidePanelsModes,n=e.playerClientRect,i=e.isVideo,o=r[Qr.HORIZONTAL],s=n.height,l=Math.max(o.min,Math.min(o.max,s*o.ratio)),u=a[Jr.TOP],c=a[Jr.BOTTOM],d=s-(t=i?u===Zr.ALONGSIDE&&c===Zr.ALONGSIDE?2:1:u!==Zr.HIDDEN&&c!==Zr.HIDDEN?2:1)*l;return n.width<480&&(d=s,l=s),{horizontalPanelHeight:l,videoHeight:d,horizontalPanelCount:t}}function Cn(e){var t=e.sidePanelsModes,r=e.allowSidePanels,a={position:"absolute",left:0,right:0,top:0,bottom:0},n=r?t[Jr.LEFT]:Zr.HIDDEN,i=r?t[Jr.RIGHT]:Zr.HIDDEN,o=r?t[Jr.TOP]:Zr.HIDDEN,s=r?t[Jr.BOTTOM]:Zr.HIDDEN;if(e.playerClientRect.width>480){if(n===Zr.ALONGSIDE||i===Zr.ALONGSIDE){var l=Sn(bn({},e,{isVideo:!0})),u=l.verticalPanelWidth,c=l.videoWidth;a.left=n===Zr.ALONGSIDE?u:0,a.right=i===Zr.ALONGSIDE?u:0,a.width=c,a.position="absolute"}if(o===Zr.ALONGSIDE||s===Zr.ALONGSIDE){var d=An(bn({},e,{isVideo:!0})),p=d.horizontalPanelHeight,h=d.videoHeight;a.top=o===Zr.ALONGSIDE?p:0,a.bottom=s===Zr.ALONGSIDE?p:0,a.height=h,a.position="absolute"}}return a}function Pn(e){var t=e.position,r=e.sidePanelsModes,a=r[Jr.LEFT],n=r[Jr.RIGHT],i=r[Jr.TOP],o=r[Jr.BOTTOM];if(-1!==[Jr.RIGHT,Jr.LEFT].indexOf(t)){var s={},l=Sn(e).verticalPanelWidth;return s.width=l,t===Jr.RIGHT?(n===Zr.HIDDEN?(s.right=-l,s.opacity=0):(s.right=0,s.opacity=1),s):(a===Zr.HIDDEN?(s.left=-l,s.opacity=0):(s.left=0,s.opacity=1),s)}var u={},c=An(e).horizontalPanelHeight,d=Sn(e).verticalPanelWidth;return u.height=c,a!==Zr.HIDDEN&&(u.left=d),n!==Zr.HIDDEN&&(u.right=d),t===Jr.TOP?(i===Zr.HIDDEN?(u.top=-c,u.opacity=0):(u.top=0,u.opacity=1),u):(o===Zr.HIDDEN?(u.bottom=-c,u.opacity=0):(u.bottom=0,u.opacity=1),u)}function wn(){return(wn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function xn(e){var t,r;return e.allowSidePanels?((t={})[Jr.TOP]=Pn(wn({},e,{position:Jr.TOP})),t[Jr.BOTTOM]=Pn(wn({},e,{position:Jr.BOTTOM})),t[Jr.RIGHT]=Pn(wn({},e,{position:Jr.RIGHT})),t[Jr.LEFT]=Pn(wn({},e,{position:Jr.LEFT})),t):((r={})[Jr.TOP]={},r[Jr.BOTTOM]={},r[Jr.RIGHT]={},r[Jr.LEFT]={},r)}var In,Mn=Xt((function(e){return{sidePanelsModes:e.shell.sidePanelsModes,sidePanelsSizes:e.shell.sidePanelsSizes,allowSidePanels:e.shell.presetSettings.allowSidePanels,playerClientRect:e.shell.playerClientRect}}),la(oa))(kn=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.shouldComponentUpdate=function(e){var t=this.props,r=t.sidePanelsModes,a=t.sidePanelsSizes,n=t.allowSidePanels,i=t.playerClientRect,o=e.sidePanelsModes,s=e.sidePanelsSizes,l=e.allowSidePanels,u=e.playerClientRect;return!(r===o&&a===s&&n===l&&i===u)},n.componentDidUpdate=function(){var e={sidePanelsModes:this.props.sidePanelsModes,sidePanelsSizes:this.props.sidePanelsSizes,playerClientRect:this.props.playerClientRect,allowSidePanels:this.props.allowSidePanels},t=function(e){var t=e.sidePanelsModes,r=e.playerClientRect,a=e.allowSidePanels,n={position:"absolute",left:0,right:0,top:0,bottom:0},i=r.width,o=r.height,s=a?t[Jr.LEFT]:Zr.HIDDEN,l=a?t[Jr.RIGHT]:Zr.HIDDEN,u=a?t[Jr.TOP]:Zr.HIDDEN,c=a?t[Jr.BOTTOM]:Zr.HIDDEN;if(r.width>480){if(s!==Zr.HIDDEN||l!==Zr.HIDDEN){var d=Sn(e).verticalPanelWidth;s!==Zr.HIDDEN&&(n.left=d),l!==Zr.HIDDEN&&(n.right=d)}if(u!==Zr.HIDDEN||c!==Zr.HIDDEN){var p=An(e).horizontalPanelHeight;u!==Zr.HIDDEN&&(n.top=p),c!==Zr.HIDDEN&&(n.bottom=p)}i=i-n.right-n.left,o=o-n.top-n.bottom}var h=r.left+(s!==Zr.HIDDEN?n.left:0),f=r.top+(u!==Zr.HIDDEN?n.top:0);return{style:n,rect:{x:h,y:f,width:i,height:o,top:f,right:r.right+(l!==Zr.HIDDEN?n.right:0),bottom:r.bottom+(c!==Zr.HIDDEN?n.bottom:0),left:h}}}(e),r=t.style,a=t.rect;this.props.updateLayoutStyles({gui:r,video:Cn(e),sidePanels:xn(e)}),this.props.updateGuiClientRect(a)},n.render=function(){return null},a}(j))||kn;function Dn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var On=Fr("PlayerAreaProvider")(In=Xt((function(e){return{activePresetName:e.shell.activePresetName}}))(In=function(e){var t,r;function a(){var t;return Rn(Dn(t=e.call(this)||this),"_validateComponentData",(function(e){var r=e.container||e.area;return!!(e.get&&e.presets&&r)||(t.props.logger.warn("component data with label '"+(e.label||"")+"' is invalid (did you remember to set 'get', 'presets' and 'area'?)"),!1)})),Rn(Dn(t),"_addNewComponentAndUpdateListeners",(function(e){return t._addNewComponent(e,!0)})),Rn(Dn(t),"_addNewComponent",(function(e,r){var a=Object.assign({},e);if(a.container&&(a.area=a.area||a.container,delete a.container),!t._validateComponentData(a))return function(){};var n=a.area;return a.presets.forEach((function(e){if((t._componentsByPreset[e]||(t._componentsByPreset[e]=[])).push(a),r){var i=t._findListeners(n,e);t._emitListeners(i)}})),function(){t._removeNewComponent(a)}})),Rn(Dn(t),"_removeNewComponent",(function(e){t._validateComponentData(e)&&e.presets.forEach((function(r){var a=t._componentsByPreset[r]||[],n=a.indexOf(e);if(-1!==n){a.splice(n,1);var i=t._findListeners(e.area,e.presetName);t._emitListeners(i)}}))})),Rn(Dn(t),"_findListeners",(function(e,r){return e?t._listeners.filter((function(t){return(!r||t.presetName===r)&&t.areaName===e})):[]})),Rn(Dn(t),"_listen",(function(e,r,a){if(!e||!r||!a)return function(){};var n=t._findListeners(r,e);n&&n.length>0&&(t.props.logger.warn("Another component is already registered to updates for player area '"+r+"' in preset '"+e+"'. Unlisten to previous listener"),n.forEach((function(e){t._unlisten(e)})));var i={presetName:e,areaName:r,callback:a};return t._listeners.push(i),t._emitListeners([i]),function(){t._unlisten(i)}})),Rn(Dn(t),"_unlisten",(function(e){var r=t._listeners.indexOf(e);-1!==r&&t._listeners.splice(r,1)})),Rn(Dn(t),"_getAreaComponents",(function(e,r){if(!r||!e)return[];var a=t._componentsByPreset[e];return(a?a.filter((function(e){return e.area===r})):[])||[]})),t._listeners=[],t._componentsByPreset={},t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n._initializePlayerComponents=function(){this.props.uiComponents&&this.props.uiComponents.length>0&&(this.props.uiComponents.forEach(this._addNewComponent),this._emitAllListeners())},n._emitListeners=function(e){var t=this,r=this.props.activePresetName;(e||[]).forEach((function(e){var a=e.presetName===r?t._getAreaComponents(r,e.areaName):[];try{e.callback(a)}catch(r){t.props.logger.error("Error occurred when handling player area "+e.areaName+" of preset "+e.presetName+".",r)}}))},n._emitAllListeners=function(){this._emitListeners(this._listeners)},n.componentDidMount=function(){this.props.setApi(this._addNewComponentAndUpdateListeners),this._initializePlayerComponents()},n.componentDidUpdate=function(e){e.activePresetName!==this.props.activePresetName&&this._emitAllListeners()},n.getChildContext=function(){return{playerAreaComponentsStore:{listen:this._listen,addNewComponent:this._addNewComponentAndUpdateListeners,getAreaComponents:this._getAreaComponents}}},n.render=function(e){return N(B,null,N(Mn,null),e.children)},a}(j))||In)||In,Ln={allowSidePanels:!1,allowPlayerArea:!1},Nn=function(e){return function(t){var r;return Xt(null,la(oa))(r=function(r){var a,n;function i(){return r.apply(this,arguments)||this}n=r,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,a.__proto__=n;var o=i.prototype;return o.componentDidMount=function(){var t=Object.assign({},Ln,e),r=t.allowSidePanels,a=t.allowPlayerArea;this.props.updatePresetSettings({allowSidePanels:r,allowPlayerArea:a})},o.shouldComponentUpdate=function(){return!1},o.render=function(e){return N(t,e)},i}(j))||r}};function Un(){return(Un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Fn={UPDATE_SEEKBAR_DRAGGING_STATUS:"seekbar/UPDATE_SEEKBAR_DRAGGING_STATUS",UPDATE_SEEKBAR_HOVER_ACTIVE:"seekbar/UPDATE_SEEKBAR_HOVER_ACTIVE",UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE:"seekbar/UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE",UPDATE_SEEKBAR_CLIENT_RECT:"seekbar/UPDATE_SEEKBAR_CLIENT_RECT",UPDATE_HIDE_SEEKBAR_PREVIEW:"seekbar/UPDATE_HIDE_SEEKBAR_PREVIEW",UPDATE_HIDE_SEEKBAR_TIME_BUBBLE:"seekbar/UPDATE_HIDE_SEEKBAR_TIME_BUBBLE",UPDATE_CURRENT_TIME:"seekbar/UPDATE_CURRENT_TIME",UPDATE_VIRTUAL_TIME:"seekbar/UPDATE_VIRTUAL_TIME"},Bn={currentTime:0,virtualTime:0,draggingActive:!1,hoverActive:!1,previewHoverActive:!1,clientRect:{x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0},hidePreview:!1,hideTimeBubble:!1},jn=function(e,t){switch(void 0===e&&(e=Bn),t.type){case Fn.UPDATE_SEEKBAR_DRAGGING_STATUS:return Un({},e,{draggingActive:t.draggingActive});case Fn.UPDATE_SEEKBAR_HOVER_ACTIVE:return Un({},e,{hoverActive:t.hoverActive});case Fn.UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE:return Un({},e,{previewHoverActive:t.previewHoverActive});case Fn.UPDATE_SEEKBAR_CLIENT_RECT:return Un({},e,{clientRect:t.clientRect});case Fn.UPDATE_HIDE_SEEKBAR_PREVIEW:return Un({},e,{hidePreview:t.hidePreview});case Fn.UPDATE_HIDE_SEEKBAR_TIME_BUBBLE:return Un({},e,{hideTimeBubble:t.hideTimeBubble});case Fn.UPDATE_CURRENT_TIME:return Un({},e,{currentTime:t.currentTime});case Fn.UPDATE_VIRTUAL_TIME:return Un({},e,{virtualTime:t.virtualTime});default:return e}},Vn={updateSeekbarDraggingStatus:function(e){return{type:Fn.UPDATE_SEEKBAR_DRAGGING_STATUS,draggingActive:e}},updateSeekbarHoverActive:function(e){return{type:Fn.UPDATE_SEEKBAR_HOVER_ACTIVE,hoverActive:e}},updateSeekbarPreviewHoverActive:function(e){return{type:Fn.UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE,previewHoverActive:e}},updateSeekbarClientRect:function(e){return{type:Fn.UPDATE_SEEKBAR_CLIENT_RECT,clientRect:e}},updateHideSeekbarPreview:function(e){return{type:Fn.UPDATE_HIDE_SEEKBAR_PREVIEW,hidePreview:e}},updateHideSeekbarTimeBubble:function(e){return{type:Fn.UPDATE_HIDE_SEEKBAR_TIME_BUBBLE,hideTimeBubble:e}},updateCurrentTime:function(e){return{type:Fn.UPDATE_CURRENT_TIME,currentTime:e}},updateVirtualTime:function(e){return{type:Fn.UPDATE_VIRTUAL_TIME,virtualTime:e}}};function $n(){return($n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Hn={UPDATE_VOLUME_DRAGGING_STATUS:"volume/UPDATE_VOLUME_DRAGGING_STATUS",UPDATE_HOVER:"volume/UPDATE_HOVER"},Gn={draggingActive:!1,hover:!1},Kn=function(e,t){switch(void 0===e&&(e=Gn),t.type){case Hn.UPDATE_VOLUME_DRAGGING_STATUS:return $n({},e,{draggingActive:t.draggingActive});case Hn.UPDATE_HOVER:return $n({},e,{hover:t.hover});default:return e}},Wn={updateVolumeDraggingStatus:function(e){return{type:Hn.UPDATE_VOLUME_DRAGGING_STATUS,draggingActive:e}},updateVolumeHover:function(e){return{type:Hn.UPDATE_HOVER,hover:e}}};function zn(){return(zn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var qn={UPDATE_LOADING_SPINNER_STATE:"loading/UPDATE_LOADING_SPINNER_STATE"},Yn={show:!1},Xn=function(e,t){switch(void 0===e&&(e=Yn),t.type){case fa.UPDATE:return da("loading",e,t);case fa.UPDATE_COMPONENT:return pa("loading",e,t);case qn.UPDATE_LOADING_SPINNER_STATE:return zn({},e,{show:t.show});default:return e}},Qn={updateLoadingSpinnerState:function(e){return{type:qn.UPDATE_LOADING_SPINNER_STATE,show:e}}};function Jn(){return(Jn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Zn={UPDATE_CAPTIONS_STYLE:"cvaa/UPDATE_CAPTIONS_STYLE"},ei={style:"default"},ti=function(e,t){switch(void 0===e&&(e=ei),t.type){case Zn.UPDATE_CAPTIONS_STYLE:return Jn({},e,{style:t.style});default:return e}},ri={updateCaptionsStyle:function(e){return{type:Zn.UPDATE_CAPTIONS_STYLE,style:e}}};function ai(){return(ai=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ni={UPDATE_QUALITY:"settings/UPDATE_QUALITY",UPDATE_SPEED:"settings/UPDATE_SPEED"},ii={quality:1,speed:2},oi=function(e,t){switch(void 0===e&&(e=ii),t.type){case ni.UPDATE_QUALITY:return ai({},e,{quality:t.quality});case ni.UPDATE_SPEED:return ai({},e,{speed:t.speed});default:return e}},si={updateQuality:function(e){return{type:ni.UPDATE_QUALITY,quality:e}},updateSpeed:function(e){return{type:ni.UPDATE_SPEED,speed:e}}};function li(){return(li=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ui={UPDATE_ACTION_ICON:"overlay-action/UPDATE_ACTION_ICON"},ci={iconType:null},di=function(e,t){switch(void 0===e&&(e=ci),t.type){case ui.UPDATE_ACTION_ICON:return li({},e,{iconType:t.iconType});default:return e}},pi={updateOverlayActionIcon:function(e){return{type:ui.UPDATE_ACTION_ICON,iconType:e}}};function hi(){return(hi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var fi={UPDATE_PLAYLIST_COUNTDOWN_CANCELED:"playlist-countdown/UPDATE_PLAYLIST_COUNTDOWN_CANCELED"},gi={countdownCanceled:!1},yi=function(e,t){switch(void 0===e&&(e=gi),t.type){case fi.UPDATE_PLAYLIST_COUNTDOWN_CANCELED:return hi({},e,{countdownCanceled:t.countdownCanceled});default:return e}},mi={updatePlaylistCountdownCanceled:function(e){return{type:fi.UPDATE_PLAYLIST_COUNTDOWN_CANCELED,countdownCanceled:e}}};function vi(){return(vi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var _i,ki,Ei,Ti={UPDATE_OVERLAY:"overlay/UPDATE_OVERLAY"},bi={isOpen:!1},Si=function(e,t){switch(void 0===e&&(e=bi),t.type){case Ti.UPDATE_OVERLAY:return vi({},e,{isOpen:t.isOpen});default:return e}},Ai={updateOverlay:function(e){return{type:Ti.UPDATE_OVERLAY,isOpen:e}}},Ci=function(e){for(var t=Object.keys(e),r={},a=0;a<t.length;a++){var n=t[a];"function"==typeof e[n]&&(r[n]=e[n])}var i,o=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:wt.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:wt.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+wt.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){i=e}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var a=!1,n={},s=0;s<o.length;s++){var l=o[s],u=r[l],c=e[l],d=u(c,t);if(void 0===d){var p=Mt(l,t);throw new Error(p)}n[l]=d,a=a||d!==c}return(a=a||o.length!==Object.keys(e).length)?n:e}}({config:ya,engine:Ea,shell:ia,seekbar:jn,volume:Kn,loading:Xn,cvaa:ti,settings:oi,overlayAction:di,playlist:yi,overlay:Si}),Pi=r(6);function wi(){return(wi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var xi,Ii,Mi=Vn.updateCurrentTime,Di=(_i=Xt(Ea,la(wi({},Ta,Qn,oa,{seekbarUpdateCurrentTime:Mi}))),ki=Fr("EngineConnector"),_i(Ei=Aa(Ei=Ba(Ei=ki(Ei=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this,t=this.props,r=t.player,a=t.eventManager,n=r.Track;this.props.updatePrePlayback(!r.config.playback.autoplay),a.listen(r,r.Event.PLAYER_RESET,(function(t){e.props.updateCurrentTime(0),e.props.seekbarUpdateCurrentTime(0),t.payload.isChangeMedia||e.props.updateIsIdle(!0),e.props.updateIsPlaybackStarted(!1),e.props.updateDataLoadingStatus(!1)})),a.listen(r,r.Event.SOURCE_SELECTED,(function(){e.props.updateIsCastAvailable(r.isCastAvailable()),e.props.updateIsLive(r.isLive()),e.props.updateIsVr(r.isVr()),e.props.updateIsImg(r.isUntimedImg()),e.props.updateIsInPictureInPicture(r.isInPictureInPicture()),r.config.playback.autoplay?e.props.updateLoadingSpinnerState(!0):e.props.updateLoadingSpinnerState(!1)})),a.listen(r,r.Event.CHANGE_SOURCE_STARTED,(function(){e.props.updatePrePlayback(!r.config.playback.autoplay&&!e.props.engine.isPlaybackStarted),e.props.updateIsChangingSource(!0),e.props.updateFallbackToMutedAutoPlay(!1),e.props.updateAdBreak(!1),e.props.updateAdIsPlaying(!1),e.props.updateIsPlaying(!1),e.props.updateIsEnded(!1),e.props.updateIsPlaybackEnded(!1),e.props.updateLastSeekPoint(0),e.props.updateIsPaused(!1),e.props.engine.isCasting&&e.props.updateLoadingSpinnerState(!0)})),a.listen(r,r.Event.CHANGE_SOURCE_ENDED,(function(){e.props.updateIsChangingSource(!1),e.props.updatePlayerPoster(r.poster),e.props.updateIsIdle(!1)})),a.listen(r,r.Event.PLAYER_STATE_CHANGED,(function(t){e.props.updatePlayerState(t.payload.oldState.type,t.payload.newState.type)})),a.listen(r,r.Event.TIME_UPDATE,(function(){e.props.updateCurrentTime(r.currentTime)})),a.listen(r,r.Event.DURATION_CHANGE,(function(){e.props.updateDuration(r.isLive()?r.liveDuration:r.duration)})),a.listen(r,r.Event.LOADED_DATA,(function(){e.props.updateDuration(r.isLive()?r.liveDuration:r.duration),e.props.updatePictureInPictureSupport(r.isPictureInPictureSupported()),e.props.updateDataLoadingStatus(!0)})),a.listen(r,r.Event.LOADED_METADATA,(function(){e.props.updateMuted(r.muted),e.props.updateMetadataLoadingStatus(!0),e.props.updateIsLive(r.isLive()),e.props.updateIsDvr(r.isDvr()),e.props.updatePlayerPoster(r.poster)})),a.listen(r,r.Event.VOLUME_CHANGE,(function(){e.props.updateVolume(r.volume)})),a.listen(r,r.Event.MUTE_CHANGE,(function(){e.props.updateMuted(r.muted),e.props.engine.fallbackToMutedAutoPlay&&e.props.updateFallbackToMutedAutoPlay(r.muted)})),a.listen(r,r.Event.PLAYBACK_START,(function(){e.props.updatePrePlayback(!1),e.props.updateIsPlaybackStarted(!0),e.props.updateLoadingSpinnerState(!0)})),a.listen(r,r.Event.AUTOPLAY_FAILED,(function(){e.props.updatePrePlayback(!0)})),a.listen(r,r.Event.FIRST_PLAY,(function(){e.props.updatePrePlayback(!1)})),a.listen(r,r.Event.PLAY,(function(){e.props.updateIsPlaying(!0),e.props.updateIsEnded(!1),e.props.updateIsPaused(!1),e.props.updateIsPlaybackEnded(!1)})),a.listen(r,r.Event.PAUSE,(function(){e.props.updateIsPlaying(!1),e.props.updateIsPaused(!0)})),a.listen(r,r.Event.SEEKING,(function(){e.props.updateIsSeeking(!0)})),a.listen(r,r.Event.SEEKED,(function(){e.props.updateIsSeeking(!1),e.props.updateLastSeekPoint(r.currentTime),e.props.updateIsPlaybackEnded(!1)})),a.listen(r,r.Event.ENDED,(function(){e.props.updateIsEnded(!0),e.props.updateIsPlaying(!1),e.props.updateIsPaused(!0)})),a.listen(r,r.Event.PLAYBACK_ENDED,(function(){e.props.updateIsPlaybackEnded(!0)})),a.listen(r,r.Event.TRACKS_CHANGED,(function(){var t=r.getTracks(n.AUDIO),a=r.getTracks(n.VIDEO),i=r.getTracks(n.TEXT);e.props.updateAudioTracks(t),e.props.updateVideoTracks(a),e.props.updateTextTracks(i)})),a.listen(r,r.Event.TEXT_TRACK_CHANGED,(function(){var t=r.getTracks(n.TEXT);e.props.updateTextTracks(t)})),a.listen(r,r.Event.AUDIO_TRACK_CHANGED,(function(){var t=r.getTracks(n.AUDIO);e.props.updateAudioTracks(t)})),a.listen(r,r.Event.VIDEO_TRACK_CHANGED,(function(){var t=r.getTracks(n.VIDEO);e.props.updateVideoTracks(t)})),a.listen(r,r.Event.AD_BREAK_START,(function(){e.props.updateHasError(!1),e.props.updateAdBreak(!0)})),a.listen(r,r.Event.AD_BREAK_END,(function(){e.props.updateAdBreak(!1)})),a.listen(r,r.Event.ALL_ADS_COMPLETED,(function(){e.props.updateAdBreak(!1)})),a.listen(r,r.Event.AD_PROGRESS,(function(t){var r=t.payload.adProgress.currentTime,a=t.payload.adProgress.duration;e.props.updateAdBreakProgress(r,a)})),a.listen(r,r.Event.AD_COMPLETED,(function(){e.props.updateAdBreakCompleted()})),a.listen(r,r.Event.AD_STARTED,(function(t){var r=t.payload.ad;e.props.updateLoadingSpinnerState(!1),e.props.updateAdIsPlaying(!0),e.props.updatePrePlayback(!1),e.props.updateAdIsBumper(r.bumper),e.props.updateAdContentType(r.contentType)})),a.listen(r,r.Event.AD_RESUMED,(function(){e.props.updateAdIsPlaying(!0)})),a.listen(r,r.Event.AD_PAUSED,(function(){e.props.updateAdIsPlaying(!1)})),a.listen(r,r.Event.AD_ERROR,(function(t){t.payload.severity===r.Error.Severity.CRITICAL&&e.props.updateAdBreak(!1)})),a.listen(r,r.Event.FALLBACK_TO_MUTED_AUTOPLAY,(function(){e.props.updateFallbackToMutedAutoPlay(!0)})),a.listen(r,r.Event.AD_LOADED,(function(t){var r=t.payload.ad;e.props.updateAdIsLinear(r.linear),e.props.updateAdIsBumper(r.bumper),e.props.updateAdClickUrl(r.clickThroughUrl),e.props.updateAdSkipTimeOffset(r.skipOffset),e.props.updateAdSkippableState(r.skippable)})),a.listen(r,r.Event.VR_STEREO_MODE_CHANGED,(function(t){e.props.updateVrStereoMode(t.payload.mode)})),a.listen(r,r.Event.ERROR,(function(t){t.payload.severity===r.Error.Severity.CRITICAL&&(e.props.updateIsIdle(!1),e.props.updateHasError(!0))})),a.listen(r,r.Event.Cast.CAST_SESSION_STARTED,(function(t){var r=t.payload.session;e.props.updateIsCasting(!0),e.props.updateCastSession(r),r.resuming&&e.props.updateLoadingSpinnerState(!1)})),a.listen(r,r.Event.Cast.CAST_SESSION_ENDED,(function(){e.props.updateIsCasting(!1),e.props.updateCastSession(null)})),a.listen(r,r.Event.Cast.CAST_AVAILABLE,(function(t){var r=t.payload.available;e.props.updateIsCastAvailable(r)})),a.listen(r,r.Event.Playlist.PLAYLIST_ITEM_CHANGED,(function(){e.props.updatePlaylist({next:r.playlist.next,prev:r.playlist.prev})})),a.listen(r,r.Event.ENTER_PICTURE_IN_PICTURE,(function(){e.props.updateIsInPictureInPicture(!0)})),a.listen(r,r.Event.LEAVE_PICTURE_IN_PICTURE,(function(){e.props.updateIsInPictureInPicture(!1)})),a.listen(r,r.Event.PRESENTATION_MODE_CHANGED,(function(){e.props.updateIsInPictureInPicture(r.isInPictureInPicture()),e.props.updateFullscreen(r.isFullscreen())})),a.listen(r,r.Event.ENTER_FULLSCREEN,(function(){e.props.updateFullscreen(!0)})),a.listen(r,r.Event.EXIT_FULLSCREEN,(function(){e.props.updateFullscreen(!1)}))},n.shouldComponentUpdate=function(){return!1},n.render=function(){return N("span",null)},a}(j))||Ei)||Ei)||Ei)||Ei);function Ri(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Di.displayName="EngineConnector";var Li=(xi=Xt((function(e){return{videoStyles:e.shell.layoutStyles.video,targetId:e.config.targetId}}),la(oa)),Aa(Ii=Ba(Ii=xi(Ii=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Oi(Ri(t=e.call.apply(e,[this].concat(a))||this),"_onVideoResize",(function(){var e=t.props.player.getVideoElement();e&&t.props.updateVideoClientRect(e.getBoundingClientRect())})),Oi(Ri(t),"_setRef",(function(e){t._videoResizeWatcher&&(t.props.eventManager.unlisten(t._videoResizeWatcher,Ia.Type.RESIZE,t._onVideoResize),t._videoResizeWatcher.destroy()),e&&(t._el=e),t._el?t._el.appendChild(t.props.player.getView()):t.props.updateVideoClientRect({x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0})})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.shouldComponentUpdate=function(e){return e.videoStyles!==this.props.videoStyles},n.componentDidMount=function(){var e=this,t=this.props,r=t.eventManager,a=t.player;r.listen(a,a.Event.SOURCE_SELECTED,(function(){return e._onVideoResize()}));var n=new fn;n.init(this._el),this._videoResizeWatcher=n,this.props.eventManager.listen(this._videoResizeWatcher,Ia.Type.RESIZE,this._onVideoResize)},n.componentWillUnmount=function(){this._videoResizeWatcher.destroy()},n.render=function(){var e=this.props,t=e.videoStyles;return N("div",{id:e.targetId+"-video",className:ca.a.videoPlayer,style:t,ref:this._setRef},N(zr,{name:"VideoContainer"}))},a}(j))||Ii)||Ii)||Ii);function Ni(){return(Ni=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ui(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Fi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ji,Vi=function(e){return function(t){var r,a;function n(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Bi(Fi(e=t.call.apply(t,[this].concat(a))||this),"_accessibleChildren",[]),Bi(Fi(e),"_isModal",!1),Bi(Fi(e),"onKeyDown",(function(t){switch(t.keyCode){case Rr.ESC:e.props.onClose&&(e.props.onClose(),t.stopPropagation());break;case Rr.DOWN:case Rr.UP:if(document.activeElement&&!e._isModal){var r=e._accessibleChildren.indexOf(document.activeElement);r=(r+(t.keyCode==Rr.DOWN?1:-1)+e._accessibleChildren.length)%e._accessibleChildren.length,e._accessibleChildren[r].focus(),t.preventDefault(),t.stopPropagation()}break;case Rr.TAB:e._isModal?t.shiftKey||document.activeElement!==e._accessibleChildren[e._accessibleChildren.length-1]?t.shiftKey&&document.activeElement===e._accessibleChildren[0]&&(e._accessibleChildren[e._accessibleChildren.length-1].focus(),t.preventDefault(),t.stopPropagation()):(e._accessibleChildren[0].focus(),t.preventDefault(),t.stopPropagation()):(e._previouslyActiveElement=null,e.props.onClose&&e.props.onClose())}})),Bi(Fi(e),"setDefaultFocusedElement",(function(t){t&&(e._defaultFocusedElement=t)})),Bi(Fi(e),"addAccessibleChild",(function(t){t&&-1==e._accessibleChildren.indexOf(t)&&e._accessibleChildren.push(t)})),Bi(Fi(e),"clearAccessibleChildren",(function(){e._accessibleChildren=[]})),Bi(Fi(e),"focusOnDefault",(function(){var t=e._defaultFocusedElement||e._accessibleChildren.length&&e._accessibleChildren[0];t&&(e._previouslyActiveElement=document.activeElement,t.focus())})),Bi(Fi(e),"setIsModel",(function(t){e.isModal=t})),e}a=t,(r=n).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a;var i,o,s=n.prototype;return s.componentDidMount=function(){this.focusOnDefault()},s.componentWillUnmount=function(){this._previouslyActiveElement&&this._previouslyActiveElement.focus()},s.render=function(t){return N(e,Ni({},t,{setDefaultFocusedElement:this.setDefaultFocusedElement,focusOnDefault:this.focusOnDefault,addAccessibleChild:this.addAccessibleChild,clearAccessibleChildren:this.clearAccessibleChildren,handleKeyDown:this.onKeyDown,setIsModal:this.setIsModel}))},i=n,(o=[{key:"isModal",set:function(e){this._isModal=e}}])&&Ui(i.prototype,o),n}(j)};function $i(e){var t=parseInt(e,10),r=Math.floor(t/3600),a=Math.floor((t-3600*r)/60),n=t-3600*r-60*a;return r<10&&(r="0"+r),a<10&&(a="0"+a),n<10&&(n="0"+n),("00"!==r?r+":":"")+a+":"+n}function Hi(e){for(var t=e.split(":"),r=0,a=1,n=t.length-1;n>=0;n--){var i=parseInt(t[n]);if(isNaN(i)||i>59){r=0;break}r+=i*a,a*=60}return r}function Gi(e){var t=parseInt(e);return t<10?"00:0"+e:t<=59?"00:"+e:$i(t)}function Ki(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Wi,zi,qi,Yi,Xi,Qi=hn("ActivePreset")(ji=Xt((function(e){return{state:{shell:e.shell,engine:{adBreak:e.engine.adBreak,isLive:e.engine.isLive,hasError:e.engine.hasError,isIdle:e.engine.isIdle,isVr:e.engine.isVr,isImg:e.engine.isImg,playlist:e.engine.playlist}},config:e.config}}),la(oa))(ji=function(e){var t,r;function a(){var t;return t=e.call(this)||this,a.logger=Ir("ActivePreset"),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.getMatchedUI=function(e,t){for(var r,a,n=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ki(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ki(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(e);!(a=n()).done;){var i=a.value;if(void 0===i.condition||i.condition(t)){r=i;break}}return r},n.render=function(e){var t,r=this.props,n=r.uis,i=r.state.shell.activePresetName;if(n.length>0){var o=(t=this.getMatchedUI(n,e.state))?t.template(e):n[n.length-1].template(e),s=o&&o.type.displayName||"";return i!==s&&(e.notifyChange({from:i,to:s}),e.updateActivePresetName(s),e.updatePresetSettings(null),a.logger.debug("update active preset to '"+i+"' and reset preset settings")),o}},a}(j))||ji)||ji,Ji=Xt((function(e){return{sidePanelsStyles:e.shell.layoutStyles.sidePanels,playerClientRect:e.shell.playerClientRect}}))(Wi=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.shouldComponentUpdate=function(e){var t=this.props,r=t.sidePanelsStyles,a=t.position,n=e.sidePanelsStyles,i=e.position;return r[a]!==n[i]},n.render=function(e){var t=e.position,r=e.sidePanelsStyles,a=-1!==[Jr.RIGHT,Jr.LEFT].indexOf(t)?"verticalSidePanel":"horizontalSidePanel",n=[ca.a.sidePanel,ca.a[a]],i="SidePanel"+(t.charAt(0).toUpperCase()+t.slice(1).toLowerCase());return N("div",{style:r[t],className:n.join(" ")},N("div",{className:ca.a.sidePanelContent},N(zr,{name:i})))},a}(j))||Wi,Zi=Xt((function(e){return{allowSidePanels:e.shell.presetSettings.allowSidePanels,allowPlayerArea:e.shell.presetSettings.allowPlayerArea,sidePanelsConfig:e.config.components.sidePanels}}),la(oa))(zi=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidUpdate=function(){var e=this.props.sidePanelsConfig,t=e.verticalSizes,r=e.horizontalSizes;t&&this.props.updateSidePanelSize(Qr.VERTICAL,t),r&&this.props.updateSidePanelSize(Qr.HORIZONTAL,r)},n.render=function(){var e=this.props,t=e.uis,r=e.playerContainer,a=e.allowSidePanels,n=e.allowPlayerArea;return N(B,null,N(Qi,{uis:t,playerContainer:r}),a?N(B,null,N(Ji,{position:Jr.RIGHT}),N(Ji,{position:Jr.LEFT}),N(Ji,{position:Jr.TOP}),N(Ji,{position:Jr.BOTTOM})):void 0,n?N(zr,{name:"PlayerArea"}):void 0)},a}(j))||zi,eo=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(){return N("div",{className:ca.a.spinner},Array(8).fill(0).map((function(e,t){return N("span",{key:t+1})})))},a}(j);eo.displayName="Spinner";var to,ro=(qi=Xt((function(e){return{show:e.loading.show,isMobile:e.shell.isMobile,adBreak:e.engine.adBreak,adIsLinear:e.engine.adIsLinear}}),la(Qn)),Yi=Fr("Loading"),qi(Xi=Aa(Xi=Ba(Xi=Yi(Xi=function(e){var t,r;function a(){return e.call(this)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this,t=this.props,r=t.player,a=t.eventManager;a.listen(r,r.Event.PLAYER_STATE_CHANGED,(function(t){var a=r.State;t.payload.newState.type===a.IDLE||t.payload.newState.type===a.PLAYING||t.payload.newState.type===a.PAUSED?e.props.updateLoadingSpinnerState(!1):e.props.updateLoadingSpinnerState(!0)})),a.listen(r,r.Event.AD_BREAK_START,(function(){e.props.updateLoadingSpinnerState(!0)})),a.listen(r,r.Event.AD_PROGRESS,(function(){e.props.updateLoadingSpinnerState(!1)})),a.listen(r,r.Event.AD_STARTED,(function(){e.props.adIsLinear&&e.props.updateLoadingSpinnerState(!1)})),a.listen(r,r.Event.ALL_ADS_COMPLETED,(function(){e.props.updateLoadingSpinnerState(!1)})),a.listen(r,r.Event.AUTOPLAY_FAILED,(function(){e.props.updateLoadingSpinnerState(!1)})),a.listen(r,r.Event.PLAYING,(function(){e.props.updateLoadingSpinnerState(!1)}))},n.render=function(e){if(e.show)return N("div",{className:[ca.a.loadingBackdrop,ca.a.show].join(" ")},N("div",{className:ca.a.spinnerContainer},N(zr,{name:ta.LoadingSpinner},N(eo,null))))},a}(j))||Xi)||Xi)||Xi)||Xi);function ao(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function no(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ro.displayName="Loading";var io,oo=Xt((function(e){return{guiStyles:e.shell.layoutStyles.gui}}))(to=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return no(ao(t=e.call.apply(e,[this].concat(a))||this),"_setRef",(function(e){e&&(t._ref=e,t.setState((function(e){return{render:!e.render}})))})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.shouldComponentUpdate=function(e,t){return e.guiStyles!==this.props.guiStyles||t.render!==this.state.render},n.render=function(){var e=this.props,t=e.guiStyles,r=W(e.children),a=r[0],n=r[1];return N("div",{ref:this._setRef,style:t,className:ca.a.guiArea},N("div",{style:{pointerEvents:"auto"}},N(zr,{name:"GuiArea"},a)),"function"==typeof n?n({containerRef:this._ref}):n)},a}(j))||to,so=Nn({allowSidePanels:!0,allowPlayerArea:!0})(io=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(){return N("div",{className:ca.a.playbackGuiWrapper},N(zr,{name:"PresetArea"},N(oo,null,N(ro,null))))},a}(j))||io;function lo(e){return N(so,e)}function uo(){return(uo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function co(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function po(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}so.displayName="Idle";var ho,fo,go,yo,mo={Maximize:"maximize",Minimize:"minimize",Play:"play",Pause:"pause",VolumeBase:"volume-base",VolumeWaves:"volume-waves",VolumeWave:"volume-wave",VolumeMute:"volume-mute",Close:"close",Settings:"settings",Check:"check",CheckActive:"check-active",Language:"language",Quality:"quality",Captions:"captions",Speed:"speed",SpeedDown:"speed-down",SpeedUp:"speed-up",Audio:"audio",ArrowDown:"arrow-down",StartOver:"start-over",SeekEnd:"seek-end",Rewind:"rewind",Rewind10:"rewind10",Forward:"forward",Forward10:"forward10",vrStereo:"vr-stereo",vrStereoFull:"vr-stereo-full",Cast:"cast",CastBrand:"cast-brand",Next:"next",Prev:"prev",PictureInPictureStart:"picture-in-picture-start",PictureInPictureStop:"picture-in-picture-stop",ClosedCaptionsOn:"closed-captions-on",ClosedCaptionsOff:"closed-captions-off"},vo={qualityHd:ca.a.badgeIcon+" "+ca.a.iconQualityHd,qualityHdActive:ca.a.badgeIcon+" "+ca.a.iconQualityHdActive,quality4k:ca.a.badgeIcon+" "+ca.a.iconQuality4K,quality4kActive:ca.a.badgeIcon+" "+ca.a.iconQuality4KActive,quality8k:ca.a.badgeIcon+" "+ca.a.iconQuality8K,quality8kActive:ca.a.badgeIcon+" "+ca.a.iconQuality8KActive},_o={INACTIVE:0,ACTIVE:1},ko=function(e){var t,r;function a(t){var r;po(co(r=e.call(this,t)||this),"_defaultColor",ca.a.white),po(co(r),"_activeColor",ca.a.brandColor),po(co(r),"_className",""),po(co(r),"createDynamicIconClass",(function(e){var t=e.path,a=e.state,n=e.color,i=e.activeColor,o=e.width,s=e.height,l=e.viewBox,u=e.fillRule,c=r.getFillColor(a,n,i),d=r.getPathTag(t,c),p=r.getSVGUrl(d,o,s,l,u),h="."+r._className+" { background-image: "+p+"; }",f=document.getElementById(zp);f&&f.appendChild(document.createTextNode(h))})),po(co(r),"getSVGUrl",(function(e,t,r,a,n){void 0===t&&(t=36),void 0===r&&(r=36),void 0===a&&(a="0 0 1024 1024"),void 0===n&&(n="nonzero");for(var i='<svg xmlns="http://www.w3.org/2000/svg"  xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="'+a+'" width="'+t+'" height="'+r+'" fill-rule="'+n+'">'+e+"</svg>",o=[['"',"'"],["%","%25"],["&","%26"],["#","%23"],["{","%7B"],["}","%7D"],["<","%3C"],[">","%3E"]],s=Math.ceil(i.length/2e3),l=0,u="",c=0;c<s;c++){for(var d=i.slice(l,l+2e3-1),p=0;p<o.length;p++)d=d.split(o[p][0]).join(o[p][1]);u=""+u+d,l+=2e3}return'url("data:image/svg+xml,'+u+'")'})),po(co(r),"getFillColor",(function(e,t,a){return e===_o.ACTIVE?a||r._activeColor:t||r._defaultColor})),po(co(r),"getPathTag",(function(e,t){return Array.isArray(e)||(e=[e]),e.map((function(e){var r="string"==typeof e?{d:e,fill:t}:uo({},e,{fill:t});return"<path "+Object.keys(r).map((function(e){return e+'="'+r[e]+'"'})).join(" ")+" />"})).join(" ")}));var a=t.path,n=t.id;if(a&&n){r._className="playkit-icon-"+n;var i=Array.from(document.styleSheets).find((function(e){return e.ownerNode.id===zp}));i&&Array.from(i.rules).find((function(e){return e.selectorText==="."+r._className}))||r.createDynamicIconClass(t)}return r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentWillUpdate=function(e){this._className&&this.props.state!==e.state&&this.createDynamicIconClass(e)},n.render=function(e){if(this._className)return N("i",{className:[ca.a.icon,this._className].join(" ")});switch(e.type){case mo.Maximize:return N("i",{className:[ca.a.icon,ca.a.iconMaximize].join(" ")});case mo.Minimize:return N("i",{className:[ca.a.icon,ca.a.iconMinimize].join(" ")});case mo.Play:return N("i",{className:[ca.a.icon,ca.a.iconPlay].join(" ")});case mo.Pause:return N("i",{className:[ca.a.icon,ca.a.iconPause].join(" ")});case mo.VolumeBase:return N("i",{className:[ca.a.icon,ca.a.iconVolumeBase].join(" ")});case mo.VolumeWaves:return N("i",{className:[ca.a.icon,ca.a.iconVolumeWaves].join(" ")});case mo.VolumeWave:return N("i",{className:[ca.a.icon,ca.a.iconVolumeWave].join(" ")});case mo.VolumeMute:return N("i",{className:[ca.a.icon,ca.a.iconVolumeMute].join(" ")});case mo.Close:return N("i",{className:[ca.a.icon,ca.a.iconClose].join(" ")});case mo.Settings:return N("i",{className:[ca.a.icon,ca.a.iconSettings].join(" ")});case mo.Check:return N("i",{className:[ca.a.icon,ca.a.iconCheck].join(" ")});case mo.CheckActive:return N("i",{className:[ca.a.icon,ca.a.iconCheckActive].join(" ")});case mo.Language:return N("i",{className:[ca.a.icon,ca.a.iconLanguage].join(" ")});case mo.Quality:return N("i",{className:[ca.a.icon,ca.a.iconQuality].join(" ")});case mo.Captions:return N("i",{className:[ca.a.icon,ca.a.iconCaptions].join(" ")});case mo.Speed:return N("i",{className:[ca.a.icon,ca.a.iconSpeed].join(" ")});case mo.SpeedDown:return N("i",{className:[ca.a.icon,ca.a.iconSpeedDown].join(" ")});case mo.SpeedUp:return N("i",{className:[ca.a.icon,ca.a.iconSpeedUp].join(" ")});case mo.Audio:return N("i",{className:[ca.a.icon,ca.a.iconAudio].join(" ")});case mo.ArrowDown:return N("i",{className:[ca.a.icon,ca.a.iconArrowDown].join(" ")});case mo.StartOver:return N("i",{className:[ca.a.icon,ca.a.iconStartOver].join(" ")});case mo.SeekEnd:return N("i",{className:[ca.a.icon,ca.a.iconSeekEnd].join(" ")});case mo.Rewind:return N("i",{className:[ca.a.icon,ca.a.iconRewind].join(" ")});case mo.Rewind10:return N("i",{className:[ca.a.icon,ca.a.iconRewind10].join(" ")});case mo.Forward:return N("i",{className:[ca.a.icon,ca.a.iconForward].join(" ")});case mo.Forward10:return N("i",{className:[ca.a.icon,ca.a.iconForward10].join(" ")});case mo.vrStereo:return N("i",{className:[ca.a.icon,ca.a.iconVrStereo].join(" ")});case mo.vrStereoFull:return N("i",{className:[ca.a.icon,ca.a.iconVrStereoFull].join(" ")});case mo.Cast:return N("i",{className:[ca.a.icon,ca.a.iconChromecast].join(" ")});case mo.CastBrand:return N("i",{className:[ca.a.icon,ca.a.iconChromecastBrand].join(" ")});case mo.Next:return N("i",{className:[ca.a.icon,ca.a.iconNext].join(" ")});case mo.Prev:return N("i",{className:[ca.a.icon,ca.a.iconPrev].join(" ")});case mo.PictureInPictureStart:return N("i",{className:[ca.a.icon,ca.a.iconPictureInPictureStart].join(" ")});case mo.PictureInPictureStop:return N("i",{className:[ca.a.icon,ca.a.iconPictureInPictureStop].join(" ")});case mo.ClosedCaptionsOn:return N("i",{className:[ca.a.icon,ca.a.iconClosedCaptionsOn].join(" ")});case mo.ClosedCaptionsOff:return N("i",{className:[ca.a.icon,ca.a.iconClosedCaptionsOff].join(" ")})}},a}(j),Eo=ko,To=function(e){return e.adBreak&&e.adIsPlaying||!e.adBreak&&e.isPlaying};function bo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function So(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ao(){return(Ao=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Co,Po,wo,xo=(ho=Xt((function(e){return{isPlayingAdOrPlayback:To(e.engine),iconType:e.overlayAction.iconType,playerHover:e.shell.playerHover,isMobile:e.shell.isMobile,guiStyles:e.shell.layoutStyles.gui,isSmartContainerOpen:e.shell.smartContainerOpen,fullscreenConfig:e.config.components.fullscreen,seekbarDraggingActive:e.seekbar.draggingActive}}),la(Ao({},pi,oa))),fo=Fr("OverlayAction"),go=hn("OverlayAction"),ho(yo=Aa(yo=fo(yo=go(yo=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return So(bo(t=e.call.apply(e,[this].concat(a))||this),"_iconTimeout",null),So(bo(t),"_pointerDownPosX",NaN),So(bo(t),"_pointerDownPosY",NaN),So(bo(t),"_firstClickTime",0),So(bo(t),"_clickTimeout",null),So(bo(t),"togglePlayPause",(function(){t.props.isPlayingAdOrPlayback?(t.props.player.pause(),t.props.updateOverlayActionIcon(mo.Pause)):(t.props.player.play(),t.props.updateOverlayActionIcon(mo.Play)),t.props.updatePlayerHoverState(!0),t.props.notifyClick({type:"PlayPause"})})),So(bo(t),"onOverlayPointerDown",(function(e){t._pointerDownPosX=e.clientX||e.changedTouches&&e.changedTouches[0]&&e.changedTouches[0].clientX,t._pointerDownPosY=e.clientY||e.changedTouches&&e.changedTouches[0]&&e.changedTouches[0].clientY})),So(bo(t),"onOverlayMouseUp",(function(e){t.isDragging(e)||t.overlayClick()})),So(bo(t),"onOverlayTouchEnd",(function(e){e.preventDefault(),t.props.playerHover&&!t.isDragging(e)&&t.togglePlayPause()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentWillUnmount=function(){this.cancelClickTimeout(),this.cancelIconTimeout()},n.toggleFullscreen=function(){this.props.player.isFullscreen()?(this.props.logger.debug("Exit fullscreen"),this.props.player.exitFullscreen()):(this.props.logger.debug("Enter fullscreen"),this.props.player.enterFullscreen()),this.props.notifyClick({type:"Fullscreen"})},n.isDragging=function(e){var t=e.clientX||e.changedTouches&&e.changedTouches[0]&&e.changedTouches[0].clientX,r=e.clientY||e.changedTouches&&e.changedTouches[0]&&e.changedTouches[0].clientY;return this.props.seekbarDraggingActive||Math.abs(t-this._pointerDownPosX)>5||Math.abs(r-this._pointerDownPosY)>5},n.overlayClick=function(){var e=this;if(!this.props.isSmartContainerOpen){if(!this.props.fullscreenConfig.disableDoubleClick){var t=Date.now();if(t-this._firstClickTime<200)return this.cancelClickTimeout(),void this.toggleFullscreen();if(t-this._firstClickTime<500)return this.cancelClickTimeout(),this.togglePlayPause(),this.toggleFullscreen(),void(this._firstClickTime=0);this._firstClickTime=t}this._clickTimeout=setTimeout((function(){e._clickTimeout=null,e.togglePlayPause()}),200)}},n.cancelClickTimeout=function(){this._clickTimeout&&(clearTimeout(this._clickTimeout),this._clickTimeout=null)},n.cancelIconTimeout=function(){this._iconTimeout&&(clearTimeout(this._iconTimeout),this._iconTimeout=null)},n.shouldComponentUpdate=function(e){return e.iconType&&this.toggleOverlayActionIcon(e.iconType),!0},n.toggleOverlayActionIcon=function(e){var t=this,r=function(){t.setState({animation:!0,iconType:e},(function(){t._iconTimeout=setTimeout((function(){t._iconTimeout=null,t.setState({animation:!1})}),300)}))};null!==this._iconTimeout?(this.cancelIconTimeout(),this.setState({animation:!1},(function(){t.forceUpdate(),r()}))):r()},n.render=function(){return N("div",{style:this.props.guiStyles,className:ca.a.overlayAction+" "+(this.state.animation?ca.a.in:""),onMouseDown:this.onOverlayPointerDown,onTouchStart:this.onOverlayPointerDown,onMouseUp:this.onOverlayMouseUp,onTouchEnd:this.onOverlayTouchEnd},this.state.animation?this.renderIcons():void 0)},n.renderIcons=function(){return Array.isArray(this.state.iconType)?this.state.iconType.map((function(e,t){return N(Eo,{key:t,type:e})})):N(Eo,{type:this.state.iconType})},n.componentDidUpdate=function(){this.state.animation&&this.props.updateOverlayActionIcon(null)},a}(j))||yo)||yo)||yo)||yo);function Io(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}xo.displayName="OverlayAction";var Do={Top:"top",Bottom:"bottom",TopRight:"top-right",TopLeft:"top-left",BottomRight:"bottom-right",BottomLeft:"bottom-left",Left:"left",Right:"right"},Ro=Xt((function(e){return{playerClientRect:e.shell.playerClientRect,guiClientRect:e.shell.guiClientRect,isMobile:e.shell.isMobile}}))((wo=Po=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Mo(Io(t=e.call.apply(e,[this].concat(a))||this),"_hoverTimeout",null),Mo(Io(t),"lastAlternativeTypeIndex",-1),Mo(Io(t),"showTooltip",(function(){t.setState({showTooltip:!0})})),Mo(Io(t),"hideTooltip",(function(){t.setState({showTooltip:!1})})),Mo(Io(t),"handleFocusOnChildren",(function(){var e=t.props.children.props.onFocus;t.showTooltip(),e&&e()})),Mo(Io(t),"handleBlurOnChildren",(function(){var e=t.props.children.props.onBlur;t.hideTooltip(),e&&e()})),Mo(Io(t),"onMouseOver",(function(){t._clearHoverTimeout(),t._hoverTimeout=setTimeout((function(){t.showTooltip()}),750)})),Mo(Io(t),"onMouseLeave",(function(){t.hideTooltip(),t._clearHoverTimeout()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n._clearHoverTimeout=function(){this._hoverTimeout&&(clearTimeout(this._hoverTimeout),this._hoverTimeout=null)},n.getAlternateType=function(){var e=this;return Object.values(Do).find((function(t,r){return r>e.lastAlternativeTypeIndex&&t!=e.props.type&&(e.lastAlternativeTypeIndex=r,!0)}))},n.isToolTipInBoundaries=function(){var e=this.textElement.getBoundingClientRect(),t=this.props.playerClientRect;return e.top>t.top+5&&e.bottom<t.bottom-5&&e.right<t.right-5&&e.left>t.left+5},n.componentWillMount=function(){this.setState({valid:!1,type:this.props.type})},n.componentDidUpdate=function(e){if(this.props.guiClientRect!==e.guiClientRect)this.lastAlternativeTypeIndex=-1,this.setState({valid:!1,type:this.props.type});else if(this.state.showTooltip)if(this.isToolTipInBoundaries())this.state.valid||this.setState({valid:!0});else{var t=this.getAlternateType();t&&this.setState({valid:!1,type:t})}},n.componentWillUnmount=function(){this._clearHoverTimeout()},n.render=function(e){var t=this,r=[ca.a.tooltipLabel,ca.a["tooltip-"+this.state.type]];if(this.state.showTooltip&&this.state.valid?r.push(ca.a.show):r.push(ca.a.hide),e.isMobile)return W(e.children)[0];var a=ne(e.children,{onFocus:this.handleFocusOnChildren,onBlur:this.handleBlurOnChildren});return N("div",{className:ca.a.tooltip,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave},a,N("span",{style:{maxWidth:e.maxWidth},ref:function(e){return e?t.textElement=e:void 0},className:r.join(" ")},e.label))},a}(j),Mo(Po,"defaultProps",{type:Do.Top,maxWidth:"240px"}),Co=wo))||Co;function Oo(){return(Oo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Lo,No,Uo,Fo,Bo,jo=Fe((function(e,t){return N("button",Oo({type:"button",ref:t},e))}));function Vo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}jo.displayName="Button";var Ho=(Lo=Xt((function(e){return{prePlayback:e.engine.prePlayback,isPlaybackEnded:e.engine.isPlaybackEnded,playlist:e.engine.playlist,loading:e.loading.show}}),la(Qn)),No=Fr("PrePlaybackPlayOverlay"),Uo=hn("PrePlaybackPlayOverlay"),Fo=br({startOverText:"controls.startOver",playText:"controls.play"}),Lo(Bo=Aa(Bo=No(Bo=Uo(Bo=Fo(Bo=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return $o(Vo(t=e.call.apply(e,[this].concat(a))||this),"handleClick",(function(){t.props.player.getView().focus(),t.props.playlist&&t.props.isPlaybackEnded?t.props.player.playlist.playNext():t.props.player.play(),t.props.notifyClick()})),$o(Vo(t),"onKeyDown",(function(e){e.keyCode===Rr.ENTER&&t.handleClick()})),$o(Vo(t),"onMouseOver",(function(e){e.stopPropagation()})),t}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){var t=e.isPlaybackEnded&&!e.player.config.playback.loop&&!(e.playlist&&e.playlist.next);if((e.prePlayback||t)&&!e.loading){var r=e.isPlaybackEnded?e.startOverText:e.playText;return N("div",{className:ca.a.prePlaybackPlayOverlay,onMouseOver:this.onMouseOver,onClick:this.handleClick},N(jo,{className:ca.a.prePlaybackPlayButton,tabIndex:"0","aria-label":r,onKeyDown:this.onKeyDown},N(Ro,{label:r},e.isPlaybackEnded?N(Eo,{type:mo.StartOver}):N(Eo,{type:mo.Play}))))}},a}(j))||Bo)||Bo)||Bo)||Bo)||Bo);function Go(){return(Go=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ko(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ho.displayName="PrePlaybackPlayOverlay";var zo=function(e){return function(t){return Ba(function(r){var a,n;function i(){for(var t,a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return Wo(Ko(t=r.call.apply(r,[this].concat(n))||this),"ref",{current:null}),Wo(Ko(t),"animate",(function(){t.ref.current&&(t.ref.current.classList.add(e),t.props.eventManager.listenOnce(t.ref.current,"animationend",(function(){t.ref.current.classList.remove(e)})))})),t}return n=r,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,a.__proto__=n,i.prototype.render=function(){return N(t,Go({},this.props,{innerRef:this.ref,animate:this.animate}))},i}(j))}};function qo(){return(qo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Yo,Xo,Qo,Jo,Zo,es,ts=Fe((function(e,t){var r=e.className,a=e.children,n=e.name,i=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,["className","children","name"]),o=[ca.a.controlButtonContainer,"playkit-control-"+rs(n)];if(r){var s=Array.isArray(r)?r:[r];o=o.concat(s)}return N("div",qo({className:o.join(" "),ref:t},i),a)})),rs=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase()};function as(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ns(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var is,os,ss,ls,us,cs,ds=(Yo=Xt((function(e){return{isDvr:e.engine.isDvr,isLive:e.engine.isLive}})),Xo=Fr("Rewind"),Qo=hn("Rewind"),Jo=zo(ca.a.rotate),Zo=br({rewindText:"controls.rewind"}),Yo(es=Aa(es=Xo(es=Qo(es=Jo(es=Zo(es=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return ns(as(t=e.call.apply(e,[this].concat(a))||this),"onClick",(function(){var e,r=t.props.player;t.props.animate();var a=t.props.step||10,n=r.currentTime,i=r.isLive()?r.getStartTimeOfDvrWindow():0;r.currentTime-a<i?t.props.isDvr||(e=i):e=r.currentTime-a,r.currentTime=e,t.props.notifyClick({from:n,to:e})})),t}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){return e.isLive&&!e.isDvr?void 0:N(ts,{name:"Rewind",className:ca.a.noIdleControl},N(Ro,{label:this.props.rewindText},N(jo,{tabIndex:"0","aria-label":this.props.rewindText,className:""+ca.a.controlButton,ref:this.props.innerRef,onClick:this.onClick},N(Eo,{type:e.step&&10!==e.step?mo.Rewind:mo.Rewind10}))))},a}(j))||es)||es)||es)||es)||es)||es);function ps(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ds.displayName="Rewind";var fs,gs,ys,ms,vs=(is=Xt((function(e){return{isDvr:e.engine.isDvr,isLive:e.engine.isLive}})),os=Fr("Forward"),ss=hn("Forward"),ls=zo(ca.a.reverseRotate),us=br({forwardText:"controls.forward"}),is(cs=Aa(cs=os(cs=ss(cs=ls(cs=us(cs=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return hs(ps(t=e.call.apply(e,[this].concat(a))||this),"onClick",(function(){var e,r=t.props.player;t.props.animate();var a=t.props.step||10,n=r.currentTime,i=r.isLive()?r.liveDuration:r.duration;r.currentTime+a>i?r.isOnLiveEdge()||(e=i):e=r.currentTime+a,r.currentTime=e,t.props.notifyClick({from:n,to:e})})),t}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){return e.isLive&&!e.isDvr?void 0:N(ts,{name:"Forward",className:ca.a.noIdleControl},N(Ro,{label:this.props.forwardText},N(jo,{tabIndex:"0","aria-label":this.props.forwardText,className:""+ca.a.controlButton,ref:this.props.innerRef,onClick:this.onClick},N(Eo,{type:e.step&&10!==e.step?mo.Forward:mo.Forward10}))))},a}(j))||cs)||cs)||cs)||cs)||cs)||cs);function _s(){return(_s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ks(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Es(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}vs.displayName="Forward";var Ts,bs,Ss,As={preventDefault:!1,payload:null},Cs=(fs=Xt((function(e){return{isPlayingAdOrPlayback:To(e.engine),playerNav:e.shell.playerNav,textTracks:e.engine.textTracks,overlayOpen:e.overlay.isOpen}}),la(Object.assign({},oa,pi))),gs=Fr("Keyboard"),ys=hn("Keyboard"),fs(ms=Aa(ms=gs(ms=ys(ms=function(e){var t,r;function a(t){var r,a;Es(ks(a=e.call(this)||this),"_lastActiveTextLanguage",""),Es(ks(a),"_hoverTimeout",null),Es(ks(a),"keyboardHandlers",((r={})[Rr.SPACE]=function(){return a.props.isPlayingAdOrPlayback?(a.props.player.pause(),a.props.updateOverlayActionIcon(mo.Pause)):(a.props.player.play(),a.props.updateOverlayActionIcon(mo.Play)),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:!0}},r[Rr.UP]=function(){var e=(Math.round(100*a.props.player.volume)+5)/100;return e=e>1?1:e,a.props.logger.debug("Changing volume. "+a.props.player.volume+" => "+e),a.props.player.muted&&(a.props.player.muted=!1),a.props.player.volume=e,a.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeWaves]),{preventDefault:!0,payload:{volume:a.props.player.volume}}},r[Rr.DOWN]=function(){var e=(Math.round(100*a.props.player.volume)-5)/100;return e=e<0?0:e,a.props.logger.debug("Changing volume. "+a.props.player.volume+" => "+e),a.props.player.volume=e,0===e?(a.props.player.muted=!0,a.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeMute])):a.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeWave]),{preventDefault:!0,payload:{volume:a.props.player.volume}}},r[Rr.F]=function(){return a.props.player.isFullscreen()?{preventDefault:!0,payload:null}:(a.props.logger.debug("Enter fullscreen"),a.props.player.enterFullscreen(),{preventDefault:!0,payload:!0})},r[Rr.P]=function(){return a.props.player.isInPictureInPicture()?(a.props.logger.debug("Exit Picture In Picture"),a.props.player.exitPictureInPicture()):(a.props.logger.debug("Enter Picture In Picture"),a.props.player.enterPictureInPicture()),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:!0}},r[Rr.ESC]=function(){return a.props.player.isFullscreen()?(a.props.logger.debug("Exit fullscreen"),a.props.player.exitFullscreen(),{preventDefault:!0,payload:!0}):{preventDefault:!0,payload:null}},r[Rr.LEFT]=function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime-5,t=a.props.player.currentTime,r=e>0?e:0;return a.props.logger.debug("Seek. "+t+" => "+r),a.props.player.currentTime=r,a.props.updateOverlayActionIcon(mo.Rewind),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:t,to:r}}}return{preventDefault:!0,payload:null}},r[Rr.RIGHT]=function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime+5,t=a.props.player.currentTime,r=e>a.props.player.duration?a.props.player.duration:e;return a.props.logger.debug("Seek. "+t+" => "+r),a.props.player.currentTime=e>a.props.player.duration?a.props.player.duration:e,a.props.updateOverlayActionIcon(mo.Forward),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:t,to:r}}}return{preventDefault:!0,payload:null}},r[Rr.HOME]=function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime;return a.props.logger.debug("Seek. "+e+" => 0"),a.props.player.currentTime=0,a.props.updateOverlayActionIcon(mo.StartOver),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:e,to:0}}}return{preventDefault:!0,payload:null}},r[Rr.END]=function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime,t=a.props.player.duration;return a.props.logger.debug("Seek. "+e+" => "+t),a.props.player.currentTime=t,a.props.updateOverlayActionIcon(mo.SeekEnd),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:e,to:t}}}return{preventDefault:!0,payload:null}},r[Rr.M]=function(){return a.props.logger.debug(a.props.player.muted?"Umnute":"Mute"),a.props.player.muted=!a.props.player.muted,a.props.player.muted?a.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeMute]):a.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeWaves]),{preventDefault:!0,payload:!0}},r[Rr.SEMI_COLON]=function(e){return e.shiftKey?a.props.player.playbackRate!==a.props.player.defaultPlaybackRate?(a.props.logger.debug("Changing playback rate. "+a.props.player.playbackRate+" => "+a.props.player.defaultPlaybackRate),a.props.player.playbackRate=a.props.player.defaultPlaybackRate,a.props.updateOverlayActionIcon(mo.Speed),{preventDefault:!0,payload:{speed:a.props.player.defaultPlaybackRate}}):{preventDefault:!0,payload:null}:As},r[Rr.PERIOD]=function(e){if(e.shiftKey){var t=a.props.player.playbackRate,r=a.props.player.playbackRates.indexOf(t);return r<a.props.player.playbackRates.length-1?(a.props.logger.debug("Changing playback rate. "+t+" => "+a.props.player.playbackRates[r+1]),a.props.player.playbackRate=a.props.player.playbackRates[r+1],a.props.updateOverlayActionIcon(mo.SpeedUp),{preventDefault:!0,payload:{speed:a.props.player.playbackRates[r+1]}}):{preventDefault:!0,payload:null}}return As},r[Rr.COMMA]=function(e){if(e.shiftKey){var t=a.props.player.playbackRate,r=a.props.player.playbackRates.indexOf(t);return r>0?(a.props.logger.debug("Changing playback rate. "+t+" => "+a.props.player.playbackRates[r-1]),a.props.player.playbackRate=a.props.player.playbackRates[r-1],a.props.updateOverlayActionIcon(mo.SpeedDown),{preventDefault:!0,payload:{speed:a.props.player.playbackRates[r-1]}}):{preventDefault:!0,payload:null}}return As},r[Rr.C]=function(e){var t=a.props.player.getActiveTracks().text;if(e.altKey||e.shiftKey||e.ctrlKey||e.metaKey)return As;if(t){if("off"===t.language&&a._lastActiveTextLanguage){a.props.logger.debug("Changing text track to language",a._lastActiveTextLanguage);var r=a.props.player.getTracks("text").find((function(e){return e.language===a._lastActiveTextLanguage}));return a.props.player.selectTrack(r),{preventDefault:!0,payload:{track:r}}}"off"===t.language||a._lastActiveTextLanguage||(a.props.logger.debug("Hiding text track"),a._lastActiveTextLanguage=t.language,a.props.player.hideTextTrack())}return{preventDefault:!0,payload:null}},r));var n=document.getElementById(t.config.targetId);return n?(n.onkeydown=function(e){var t=e.target instanceof Node&&e.target.nodeName||"";if(-1===["INPUT","SELECT","TEXTAREA"].indexOf(t)&&!a.props.overlayOpen&&!a.props.playerNav&&"function"==typeof a.keyboardHandlers[e.keyCode]){a.props.logger.debug("KeyDown -> keyName: "+function(e){for(var t in Rr)if(Rr[t]===e)return t;return"NOT_FOUND"}(e.keyCode)+", shiftKey: "+e.shiftKey.toString());var r=a.keyboardHandlers[e.keyCode](e),n=r.preventDefault,i=r.payload;n&&e.preventDefault(),i&&a.props.notifyClick(_s({key:e.keyCode},i))}},a):ks(a)}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.componentWillReceiveProps=function(e){var t=this.props.textTracks.find((function(e){return e.active})),r=e.textTracks.find((function(e){return e.active}));t&&"off"!==t.language&&r&&"off"===r.language?this._lastActiveTextLanguage=t.language:r&&"off"!==r.language&&(this._lastActiveTextLanguage="")},a}(j))||ms)||ms)||ms)||ms);function Ps(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ws(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var xs=["keydown","keyup"],Is=(Ts=Xt((function(e){return{playerNav:e.shell.playerNav,overlayOpen:e.overlay.isOpen}})),bs=Fr("KEYBOARD_PROVIDER"),Ts(Ss=Ba(Ss=bs(Ss=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return ws(Ps(t=e.call.apply(e,[this].concat(a))||this),"_keyboardListeners",[]),ws(Ps(t),"_isKeyboardEnable",!1),ws(Ps(t),"_componentToHandle",null),ws(Ps(t),"_addKeyboardHandler",(function(e,r,a,n){var i=t._createKeyCode(r,a);t._keyboardListeners[i]?t.props.logger.warn("Combination of key "+a.code+" altKey "+(!!a.altKey).toString()+" ctrlKey "+(!!a.ctrlKey).toString()+"\n      metaKey "+(!!a.metaKey).toString()+" shiftKey "+(!!a.shiftKey).toString()+" already exist"):t._keyboardListeners[i]={callback:n,componentName:e}})),ws(Ps(t),"_removeKeyboardHandler",(function(e,r){var a=t._createKeyCode(e,r);t._keyboardListeners[a]&&delete t._keyboardListeners[a]})),ws(Ps(t),"_updateIsKeyboardEnabled",(function(e){t._isKeyboardEnable=e})),ws(Ps(t),"_setKeyboardEventToScope",(function(e){t._componentToHandle=e})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this,t=this.props,r=t.eventManager,a=t.playerContainer;this.keyEventHandler=this._keyEventHandler.bind(this),xs.forEach((function(t){r.listen(a,t,e.keyEventHandler)}))},n.shouldComponentUpdate=function(){return!1},n._keyEventHandler=function(e){var t=this._createKeyCode(e.type,{code:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey}),r=e.target instanceof Node&&e.target.nodeName||"";-1!==["INPUT","SELECT","TEXTAREA"].indexOf(r)||!this._shouldHandleKeyboardEvents()||!this._keyboardListeners[t]||"function"!=typeof this._keyboardListeners[t].callback||this._componentToHandle&&this._keyboardListeners[t].componentName!==this._componentToHandle||(e.preventDefault(),e.stopPropagation(),this._keyboardListeners[t].callback(e))},n._shouldHandleKeyboardEvents=function(){return this._isKeyboardEnable&&!this.props.playerNav&&!this.props.overlayOpen},n._createKeyCode=function(e,t){var r=xs.indexOf(e),a=t.altKey?1:0,n=t.ctrlKey?1:0,i=t.metaKey?1:0,o=t.shiftKey?1:0;return parseInt(""+r+t.code+a+n+i+o)},n.getChildContext=function(){return{addKeyboardHandler:this._addKeyboardHandler,removeKeyboardHandler:this._removeKeyboardHandler,updateIsKeyboardEnabled:this._updateIsKeyboardEnabled,setKeyboardEventToScope:this._setKeyboardEventToScope}},n.render=function(){return this.props.children&&W(this.props.children)[0]||null},a}(j))||Ss)||Ss)||Ss);function Ms(){return(Ms=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ds(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Os,Ls,Ns,Us,Fs=function(e){return function(t){return function(r){var a,n;function i(){for(var t,a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return Rs(Ds(t=r.call.apply(r,[this].concat(n))||this),"keyboardEventHandlers",[]),Rs(Ds(t),"_updateIsKeyboardEnabled",(function(e){t.context.updateIsKeyboardEnabled(e)})),Rs(Ds(t),"_setKeyboardEventToScope",(function(r){r?t.context.setKeyboardEventToScope(e):t.context.setKeyboardEventToScope(null)})),t}n=r,(a=i).prototype=Object.create(n.prototype),a.prototype.constructor=a,a.__proto__=n;var o=i.prototype;return o.componentDidMount=function(){var t=this;this.keyboardEventHandlers.forEach((function(r){var a=r.eventType?r.eventType:xs[0];t._addKeyboardHandler(e,a,r.key,r.action)}))},o.componentWillUnmount=function(){var e=this;this.keyboardEventHandlers.forEach((function(t){var r=t.eventType?t.eventType:xs[0];e._removeKeyboardHandler(r,t.key)}))},o.registerKeyboardEvents=function(e){this.keyboardEventHandlers=e},o._addKeyboardHandler=function(e,t,r,a){this.context.addKeyboardHandler(e,t,r,a)},o._removeKeyboardHandler=function(e,t){this.context.removeKeyboardHandler(e,t)},o.render=function(){var e=this;return N(t,Ms({},this.props,{setKeyboardEventToScope:function(t){return e._setKeyboardEventToScope(t)},updateIsKeyboardEnabled:function(t){return e._updateIsKeyboardEnabled(t)},registerKeyboardEvents:function(t){return e.registerKeyboardEvents(t)}}))},i}(j)}},Bs="chromecast";function js(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $s,Hs,Gs,Ks,Ws,zs,qs=(Os=Xt((function(e){return{isCasting:e.engine.isCasting,isCastAvailable:e.engine.isCastAvailable}})),Ls=Fr("Cast"),Ns=br({castText:"cast.play_on_tv"}),Os(Us=Aa(Us=Ba(Us=Ls(Us=Ns(Us=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Vs(js(t=e.call.apply(e,[this].concat(a))||this),"onClick",(function(){t.props.player.setIsCastInitiator(Bs,!0),t.props.eventManager.listenOnce(t.props.player,t.props.player.Event.Cast.CAST_SESSION_START_FAILED,(function(){return t.props.player.setIsCastInitiator(Bs,!1)}))})),Vs(js(t),"onKeyDown",(function(e){e.keyCode===Rr.ENTER&&t.props.player.startCasting(Bs)})),t}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){if(e.isCasting||e.isCastAvailable){var t=e.isCasting?ca.a.castButton+" "+ca.a.castButtonActive:ca.a.castButton;return N("div",{role:"button","aria-label":this.props.castText,className:ca.a.controlButtonContainer,onClick:this.onClick,onKeyDown:this.onKeyDown},N(Ro,{label:this.props.castText},N("google-cast-launcher",{className:t,tabIndex:"0"})))}},a}(j))||Us)||Us)||Us)||Us)||Us);function Ys(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}qs.displayName="Cast";var Qs,Js=($s=Xt((function(e){return{isInFullscreen:e.engine.fullscreen,targetId:e.config.targetId}})),Hs=Fr("Fullscreen"),Gs=Fs("Fullscreen"),Ks=hn("Fullscreen"),Ws=br({fullscreenText:"controls.fullscreen",fullscreenExitText:"controls.fullscreenExit"}),$s(zs=Aa(zs=Hs(zs=Gs(zs=Ks(zs=Ws(zs=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Xs(Ys(t=e.call.apply(e,[this].concat(a))||this),"_keyboardEventHandlers",[{key:{code:Rr.F},action:function(e){t.handleKeydown(e)}},{key:{code:Rr.ESC},action:function(e){t.handleKeydown(e)}}]),Xs(Ys(t),"toggleFullscreen",(function(){var e=t.props,r=e.targetId,a=e.logger,n=e.player;a.debug("Toggle fullscreen");var i=document.getElementById(r);n.isFullscreen()?n.exitFullscreen():n.enterFullscreen(),i&&i.focus(),t.props.notifyClick()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){this.props.registerKeyboardEvents(this._keyboardEventHandlers)},n.handleKeydown=function(e){switch(e.keyCode){case Rr.F:this.props.player.isFullscreen()||this.toggleFullscreen();break;case Rr.ESC:this.props.player.isFullscreen()&&this.toggleFullscreen()}},n.render=function(){return N(ts,{name:"Fullscreen"},N(Ro,{label:this.props.isInFullscreen?this.props.fullscreenExitText:this.props.fullscreenText},N(jo,{tabIndex:"0","aria-label":this.props.isInFullscreen?this.props.fullscreenExitText:this.props.fullscreenText,className:this.props.isInFullscreen?[ca.a.controlButton,ca.a.isFullscreen].join(" "):ca.a.controlButton,onClick:this.toggleFullscreen},N(Eo,{type:mo.Maximize}),N(Eo,{type:mo.Minimize}))))},a}(j))||zs)||zs)||zs)||zs)||zs)||zs);function Zs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function el(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tl(){return(tl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}Js.displayName="Fullscreen";var rl,al=Xt((function(e){return{overlayOpen:e.overlay.isOpen}}),la(tl({},oa,Ai)))(Qs=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return el(Zs(t=e.call.apply(e,[this].concat(a))||this),"_timeoutId",null),el(Zs(t),"onCloseButtonKeyDown",(function(e){e.keyCode!==Rr.ENTER&&e.keyCode!==Rr.SPACE||(e.preventDefault(),t.props.onClose())})),el(Zs(t),"onKeyDown",(function(e){t.props.handleKeyDown&&t.props.handleKeyDown(e)})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this;this._timeoutId=setTimeout((function(){return e.props.addPlayerClass(ca.a.overlayActive)}),0)},n.componentWillUnmount=function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),this.props.removePlayerClass(ca.a.overlayActive)},n.renderCloseButton=function(e){return e.permanent?void 0:N(kr,null,N("a",{role:"button",ref:function(t){e.addAccessibleChild&&e.addAccessibleChild(t)},tabIndex:"0",onClick:function(){e.updateOverlay(!1),e.onClose()},onKeyDown:this.onCloseButtonKeyDown,"aria-label":N(vr,{id:"overlay.close"}),className:ca.a.closeOverlay},N(Eo,{type:mo.Close})))},n.render=function(e){var t=[ca.a.overlay];if(e.type){var r=ca.a[e.type+"-overlay"]?ca.a[e.type+"-overlay"]:e.type+"-overlay";t.push(r)}return e.open&&(this.props.updateOverlay(e.open),t.push(ca.a.active)),N("div",{tabIndex:"-1",className:t.join(" "),role:"dialog",onKeyDown:this.onKeyDown},N("div",{className:ca.a.overlayContents},e.children),this.renderCloseButton(e))},a}(j))||Qs;function nl(){return(nl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function il(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}al.displayName="Overlay";var ol,sl=Xt((function(e){return{isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize}}),la(oa))(rl=Vi(rl=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n,i,o=a.prototype;return o.componentWillMount=function(){this.props.addPlayerClass(ca.a.smartContainerOpen),this.props.updateSmartContainerOpen(!0)},o.componentWillUnmount=function(){this.props.removePlayerClass(ca.a.smartContainerOpen),this.props.updateSmartContainerOpen(!1)},o.componentDidMount=function(){this.props.setIsModal(this.isPortal)},o.render=function(e){var t=document.getElementById(this.props.targetId)||document;return e.clearAccessibleChildren(),this.isPortal?Ye(N(al,{open:!0,onClose:e.onClose,handleKeyDown:this.props.handleKeyDown,addAccessibleChild:this.props.addAccessibleChild},N("div",{className:ca.a.title},e.title),this.renderChildren(e)),t.querySelector(".overlay-portal")):N("div",{onKeyDown:e.handleKeyDown,tabIndex:"-1",className:[ca.a.smartContainer,ca.a.top,ca.a.left].join(" ")},this.renderChildren(e))},o.renderChildren=function(e){var t=this;return W(e.children).map((function(r){if(r)return ne(r,nl({pushRef:function(t){e.addAccessibleChild(t)}},t.props))}))},n=a,(i=[{key:"isPortal",get:function(){return this.props.isMobile||this.props.isSmallSize}}])&&il(n.prototype,i),a}(j))||rl)||rl;function ll(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ul(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function cl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}sl.displayName="SmartContainer";var dl=Xt((function(e){return{isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,guiClientRect:e.shell.guiClientRect}}))(ol=Ba(ol=Vi(ol=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return cl(ll(t=e.call.apply(e,[this].concat(a))||this),"handleClickOutside",(function(e){t.props.isMobile||t.props.isSmallSize||!t._menuElement||t._menuElement.contains(e.target)||t.props.onClose()})),cl(ll(t),"onChange",(function(e){t.onSelect(t.props.options[e.target.value])})),t}ul(t,e);var r=t.prototype;return r.componentWillMount=function(){this.setState({position:[ca.a.top,ca.a.left]})},r.componentDidMount=function(){this.props.eventManager.listen(document,"click",this.handleClickOutside),this.props.isMobile||this.props.isSmallSize||this.setState({position:this.getPosition()})},r.getPosition=function(){var e=this._menuElement.getBoundingClientRect(),t=this.props.guiClientRect;return e.top>=t.top?[ca.a.top,ca.a.left]:e.bottom+e.height<t.bottom?[ca.a.bottom,ca.a.left]:(this._menuElement.style.maxHeight=.8*t.height+"px",[ca.a.stickBottom,ca.a.left])},r.isSelected=function(e){return e.active},r.onSelect=function(e){this.props.onMenuChosen(e.value),this.props.options.filter((function(e){return e.active})).forEach((function(e){e.active=!1})),this.props.options.filter((function(t){return t.value===e.value}))[0].active=!0},r.renderNativeSelect=function(e){var t=this,r=this.props.hideSelect?ca.a.mobileHiddenSelect:"";return N("select",{"aria-labelledby":e,role:"listbox",ref:function(e){t.props.pushRef&&t.props.pushRef(e)},className:r+=" "+ca.a.dropdown,onChange:this.onChange},this.props.options.map((function(e,r){return N("option",{role:"option","aria-selected":t.isSelected(e)?"true":"",selected:t.isSelected(e),value:r,key:r},e.label)})))},r.render=function(e){var t=this;return e.clearAccessibleChildren(),e.isMobile||e.isSmallSize?this.renderNativeSelect(e.labelledby):N("div",{role:"menu",onKeyDown:e.handleKeyDown,ref:function(e){return e?t._menuElement=e:void 0},className:[ca.a.dropdownMenu].concat(this.state.position).join(" ")},e.options.map((function(r,a){return N(hl,{setDefaultFocusedElement:e.setDefaultFocusedElement,addAccessibleChild:e.addAccessibleChild,isSelected:t.isSelected,onSelect:function(e){t.onSelect(e)},key:a,data:r})})))},t}(j))||ol)||ol)||ol;dl.displayName="Menu";var pl,hl=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return cl(ll(t=e.call.apply(e,[this].concat(a))||this),"onClick",(function(e){e.stopPropagation(),t.props.onSelect(t.props.data)})),cl(ll(t),"onKeyDown",(function(e){switch(e.keyCode){case Rr.ENTER:t.props.onSelect(t.props.data),e.stopPropagation()}})),t}return ul(t,e),t.prototype.render=function(e){var t=this,r=e.data.badgeType&&!e.isSelected(e.data)?vo[e.data.badgeType]:vo[e.data.badgeType+"Active"];return N("div",{role:"menuitemradio",tabIndex:"-1","aria-checked":e.isSelected(e.data)?"true":"false",ref:function(r){t.props.addAccessibleChild(r),e.isSelected(e.data)&&e.setDefaultFocusedElement(r)},className:e.isSelected(e.data)?[ca.a.dropdownMenuItem,ca.a.active].join(" "):ca.a.dropdownMenuItem,onClick:this.onClick,onKeyDown:this.onKeyDown},N("span",{className:r?[ca.a.labelBadge,r].join(" "):""},e.data.label),N("span",{className:[ca.a.menuIconContainer,ca.a.active].join(" ")},N(Eo,{type:mo.CheckActive})))},t}(j);function fl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var yl=Xt((function(e){return{isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize}}))(pl=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return gl(fl(t=e.call.apply(e,[this].concat(a))||this),"onMenuChosen",(function(e){t.props.onMenuChosen(e),t.setState({dropMenuActive:!1})})),gl(fl(t),"onClick",(function(){t.state.dropMenuActive||setTimeout((function(){return t.toggleDropDown()}))})),gl(fl(t),"onKeyDown",(function(e){switch(e.keyCode){case Rr.ENTER:t.onClick();break;case Rr.SPACE:e.preventDefault(),t.onClick();break;case Rr.ESC:t.state.dropMenuActive&&(t.onClose(),e.stopPropagation())}})),gl(fl(t),"onClose",(function(){t.setState({dropMenuActive:!1})})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentWillMount=function(){this.setState({dropMenuActive:!1})},n.componentDidMount=function(){this.props.registerParentSelectedCallback&&this.props.registerParentSelectedCallback(this.toggleDropDown.bind(this))},n.isSelected=function(e){return e.active},n.getActiveOption=function(){return this.props.options.find((function(e){return e.active}))||this.props.options[0]||{label:"Unlabled"}},n.renderNativeSelect=function(e){return N(dl,{labelledby:e,pushRef:this.props.pushRef,options:this.props.options,onMenuChosen:this.onMenuChosen,onClose:this.onClose})},n.render=function(e){var t,r,a=this,n=e.name+"Active",i=this.getActiveOption(),o=(null==i||null==(t=i.dropdownOptions)?void 0:t.label)||i.label,s=vo[i.badgeType||(null==i||null==(r=i.dropdownOptions)?void 0:r.badgeType)];return e.isMobile||e.isSmallSize?this.renderNativeSelect(e.name):N("div",{name:e.name,className:this.state.dropMenuActive?[ca.a.dropdown,ca.a.active].join(" "):ca.a.dropdown,ref:function(e){return e?a._el=e:void 0}},N("div",{tabIndex:e.tabbable?0:-1,ref:function(t){e.pushRef&&e.pushRef(t)},role:"menuitem","aria-haspopup":"true","aria-expanded":this.state.dropMenuActive?"true":"false","aria-labelledby":[e.name,n].join(" "),className:ca.a.dropdownButton,onClick:this.onClick,onKeyDown:this.onKeyDown},N("span",{id:n,className:s?[ca.a.labelBadge,s].join(" "):""},o),N(Eo,{type:mo.ArrowDown}),this.state.dropMenuActive?N(dl,{parentEl:this._el,options:e.options,onMenuChosen:this.onMenuChosen,onClose:this.onClose}):void 0))},n.toggleDropDown=function(){this.setState((function(e){return{dropMenuActive:!e.dropMenuActive}}))},a}(j))||pl;yl.displayName="DropDown";var ml=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){var t=e.label&&e.label.toLowerCase();return N("div",{className:[ca.a.smartContainerItem,ca.a.selectMenuItem].join(" ")},N("label",{id:t,htmlFor:t},e.icon?N("div",{className:ca.a.labelIcon},N(Eo,{type:e.icon})):void 0,e.label),N(yl,{pushRef:function(t){e.pushRef(t)},name:t,onMenuChosen:function(t){return e.onMenuChosen(t)},options:e.options}))},a}(j);ml.displayName="SmartContainerItem";var vl,_l=function(e){var t=ke(null);return ve((function(){var r;e.isActive&&(null==(r=t)||r.focus())}),[]),N("div",{role:"button",tabIndex:"0",ref:function(r){t=r,e.addAccessibleChild(r)},className:e.classNames.join(" "),onClick:e.changeCaptionsStyle,onKeyDown:function(t){t.keyCode===Rr.ENTER&&e.changeCaptionsStyle()}},e.children,e.isActive?N("div",{className:ca.a.activeTick},N(Eo,{type:mo.Check})):void 0)};function kl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function El(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Tl=Aa(vl=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return El(kl(t=e.call.apply(e,[this].concat(a))||this),"transitionToState",(function(){t.props.transitionToState(t.props.cvaaOverlayState.CustomCaptions)})),El(kl(t),"onKeyDown",(function(e){e.keyCode===Rr.ENTER&&t.transitionToState()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentWillMount=function(){var e=this.props.player;this.captionsStyleDefault=e.TextStyle.fromJson({backgroundOpacity:e.TextStyle.StandardOpacities.TRANSPARENT}),this.captionsStyleYellow=e.TextStyle.fromJson({backgroundOpacity:e.TextStyle.StandardOpacities.TRANSPARENT,fontColor:e.TextStyle.StandardColors.YELLOW}),this.captionsStyleBlackBG=e.TextStyle.fromJson({backgroundColor:e.TextStyle.StandardColors.BLACK,fontColor:e.TextStyle.StandardColors.WHITE})},n.render=function(e){var t=this;return N("div",{className:[ca.a.overlayScreen,ca.a.active].join(" ")},N("div",{className:ca.a.title},N(vr,{id:"cvaa.title"})),N("div",null,N(_l,{addAccessibleChild:e.addAccessibleChild,classNames:[ca.a.sample],changeCaptionsStyle:function(){return e.changeCaptionsStyle(t.captionsStyleDefault)},isActive:e.player.textStyle.isEqual(this.captionsStyleDefault)},N(vr,{id:"cvaa.sample_caption_tag",fields:{number:"1"}})),N(_l,{addAccessibleChild:e.addAccessibleChild,classNames:[ca.a.sample,ca.a.blackBg],changeCaptionsStyle:function(){return e.changeCaptionsStyle(t.captionsStyleBlackBG)},isActive:e.player.textStyle.isEqual(this.captionsStyleBlackBG)},N(vr,{id:"cvaa.sample_caption_tag",fields:{number:"2"}})),N(_l,{addAccessibleChild:e.addAccessibleChild,classNames:[ca.a.sample,ca.a.yellowText],changeCaptionsStyle:function(){return e.changeCaptionsStyle(t.captionsStyleYellow)},isActive:e.player.textStyle.isEqual(this.captionsStyleYellow)},N(vr,{id:"cvaa.sample_caption_tag",fields:{number:"3"}}))),this.isAdvancedStyleApplied()?N("div",{className:ca.a.customCaptionsApplied},N("div",{className:[ca.a.sample,ca.a.custom].join(" "),style:e.customTextStyle.toCSS()},N(vr,{id:"cvaa.sample_custom_caption_tag"}),N("div",{className:ca.a.activeTick},N(Eo,{type:mo.Check}))),N("a",{role:"button",tabIndex:"0","aria-haspopup":"true",onClick:this.transitionToState,ref:function(t){e.addAccessibleChild(t)},onKeyDown:this.onKeyDown},N(vr,{id:"cvaa.edit_caption"}))):N("a",{role:"button","aria-haspopup":"true",tabIndex:"0",className:ca.a.buttonSaveCvaa,onClick:this.transitionToState,ref:function(t){e.addAccessibleChild(t)},onKeyDown:this.onKeyDown},N(vr,{id:"cvaa.set_custom_caption"})))},n.isAdvancedStyleApplied=function(){var e=this.props.player;return!e.textStyle.isEqual(this.captionsStyleDefault)&&!e.textStyle.isEqual(this.captionsStyleBlackBG)&&!e.textStyle.isEqual(this.captionsStyleYellow)},a}(j))||vl,bl=function(e){return N("div",{className:e.classNames.join(" ")},N("label",{id:e.styleName},N(vr,{id:e.labelId})),N(yl,{name:e.styleName,pushRef:function(t){e.addAccessibleChild(t)},tabbable:!0,onMenuChosen:function(t){var r={};r[e.styleName]=t,e.changeCustomStyle(r)},options:e.options}))};function Sl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Al(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Cl=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Al(Sl(t=e.call.apply(e,[this].concat(a))||this),"mouseDownHandler",(function(e){t._sliderElementOffsetLeft=t._sliderElement.getBoundingClientRect().left,t.state.dragging||t.setState((function(r){return{dragging:!0,value:t.mouseEventToValue(e,r)}}),(function(){t.props.onChange(t.mouseEventToValue(e,t.state))}))})),Al(Sl(t),"onKeyDown",(function(e){e.keyCode!==Rr.LEFT&&e.keyCode!==Rr.RIGHT||t.onKeyboardDragging(e)})),Al(Sl(t),"mouseMoveHandler",(function(e){t.state.dragging&&t.setState((function(r){return{value:t.mouseEventToValue(e,r)}}),(function(){t.props.onChange(t.mouseEventToValue(e,t.state))}))})),Al(Sl(t),"mouseUpHandler",(function(e){t.state.dragging&&t.setState((function(r){return{value:t.mouseEventToValue(e,r),dragging:!1}}),(function(){t.props.onChange(t.mouseEventToValue(e,t.state))}))})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentWillMount=function(){this.setState({value:this.props.value||0,min:this.props.min||0,max:this.props.max||100,dragging:!1}),document.addEventListener("mouseup",this.mouseUpHandler),document.addEventListener("mousemove",this.mouseMoveHandler),document.addEventListener("touchend",this.mouseUpHandler),document.addEventListener("touchmove",this.mouseMoveHandler)},n.componentWillUnmount=function(){document.removeEventListener("mouseup",this.mouseUpHandler),document.removeEventListener("mousemove",this.mouseMoveHandler),document.removeEventListener("touchend",this.mouseUpHandler),document.removeEventListener("touchmove",this.mouseMoveHandler)},n.componentDidMount=function(){this.sliderWidth=this._sliderElement.clientWidth,this._sliderElementOffsetLeft=this._sliderElement.getBoundingClientRect().left},n.onKeyboardDragging=function(e){var t=this;e.stopPropagation(),this._sliderElementOffsetLeft=this._sliderElement.getBoundingClientRect().left;var r=this.props.value;switch(e.keyCode){case Rr.RIGHT:(r+=5)>this.state.max&&(r=this.state.max);break;case Rr.LEFT:(r-=5)<this.state.min&&(r=this.state.min)}this.setState({value:r,dragging:!1},(function(){t.props.onChange(r)}))},n.mouseEventToValue=function(e,t){var r=(e.touches&&e.touches.length>0?e.touches[0].clientX:e.changedTouches?e.changedTouches[0].pageX:e.clientX)-this._sliderElement.getBoundingClientRect().left,a=Math.round(r/this._sliderElement.clientWidth*100);return this.getValueByPersentage(a)<t.min?t.min:this.getValueByPersentage(a)>t.max?t.max:this.getValueByPersentage(a)},n.getValueByPersentage=function(e){return this.state.max/100*e},n.getPercentageByValue=function(){return Math.round(this.state.value/this.state.max*100)},n.render=function(e){var t=this;return N("div",{role:"slider","aria-valuemin":this.state.min,"aria-valuenow":this.state.value,"aria-valuemax":this.state.max,"aria-labelledby":e.name,tabIndex:"0",ref:function(r){r&&(t._sliderElement=r,e.pushRef&&e.pushRef(r))},className:ca.a.slider,onMouseDown:this.mouseDownHandler,onTouchStart:this.mouseDownHandler,onKeyDown:this.onKeyDown},N("div",{className:ca.a.progress,style:{width:this.getPercentageByValue()+"%"}},N("div",{className:ca.a.handle,onMouseDown:this.mouseDownHandler,onTouchStart:this.mouseDownHandler})))},a}(j);Cl.displayName="Slider";var Pl,wl=function(e){return N("div",{className:e.classNames.join(" ")},N("label",{id:e.styleName},N(vr,{id:e.labelId})),N(Cl,{name:e.styleName,pushRef:function(t){e.addAccessibleChild(t)},min:0,max:100,value:100*e.value,onChange:function(t){var r={};r[e.styleName]=t/100,e.changeCustomStyle(r)}}))};function xl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Il(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ml,Dl,Rl,Ol,Ll=Aa(Pl=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Il(xl(t=e.call.apply(e,[this].concat(a))||this),"changeCaptionsStyle",(function(){t.props.changeCaptionsStyle(t.props.customTextStyle)})),Il(xl(t),"onKeyDown",(function(e){e.keyCode===Rr.ENTER&&t.changeCaptionsStyle()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){this.props.focusOnDefault()},n.render=function(e){var t=this.props.player,r=t.TextStyle.FontFamily,a=t.TextStyle.EdgeStyles,n=t.TextStyle.StandardColors,i=t.TextStyle.FontSizes.map((function(t){return{value:t.label,label:t.label,active:e.customTextStyle.fontSize===t.label}})),o=Object.keys(n).map((function(t){return{value:n[t],label:t.charAt(0).toUpperCase()+t.toLowerCase().slice(1),active:e.customTextStyle.fontColor.every((function(e,r){return e===n[t][r]}))}})),s=Object.keys(r).map((function(t){return{value:r[t],label:r[t],active:e.customTextStyle.fontFamily===r[t]}})),l=Object.keys(a).map((function(t){return{value:a[t],label:t.charAt(0).toUpperCase()+t.toLowerCase().slice(1),active:e.customTextStyle.fontEdge===a[t]}})),u=Object.keys(n).map((function(t){return{value:n[t],label:t.charAt(0).toUpperCase()+t.toLowerCase().slice(1),active:e.customTextStyle.backgroundColor.every((function(e,r){return e===n[t][r]}))}}));return N("div",{className:[ca.a.overlayScreen,ca.a.active].join(" ")},N("form",{className:[ca.a.form,ca.a.customCaptionForm].join(" ")},N(bl,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.size_label",options:i,classNames:[ca.a.formGroupRow,ca.a.fontSize],styleName:"fontSize",changeCustomStyle:e.changeCustomStyle}),N(bl,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_color_label",options:o,classNames:[ca.a.formGroupRow,ca.a.fontColor],styleName:"fontColor",changeCustomStyle:e.changeCustomStyle}),N(bl,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_family_label",options:s,classNames:[ca.a.formGroupRow,ca.a.fontFamily],styleName:"fontFamily",changeCustomStyle:e.changeCustomStyle}),N(bl,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_style_label",options:l,classNames:[ca.a.formGroupRow,ca.a.fontStyle],styleName:"fontEdge",changeCustomStyle:e.changeCustomStyle}),N(wl,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_opacity_label",value:e.customTextStyle.fontOpacity,classNames:[ca.a.formGroupRow,ca.a.fontOpacity],styleName:"fontOpacity",changeCustomStyle:e.changeCustomStyle}),N(bl,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.background_color_label",options:u,classNames:[ca.a.formGroupRow,ca.a.backgroundColor],styleName:"backgroundColor",changeCustomStyle:e.changeCustomStyle}),N(wl,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.background_opacity_label",value:e.customTextStyle.backgroundOpacity,classNames:[ca.a.formGroupRow,ca.a.backgroundOpacity],styleName:"backgroundOpacity",changeCustomStyle:e.changeCustomStyle}),N("div",{className:ca.a.formGroupRow},N("a",{role:"button",tabIndex:"0",ref:function(t){e.addAccessibleChild(t)},onClick:this.changeCaptionsStyle,onKeyDown:this.onKeyDown,className:[ca.a.btn,ca.a.btnBranded,ca.a.btnBlock].join(" ")},N(vr,{id:"cvaa.apply"}))),N("div",{className:ca.a.previewContainer},N("span",{style:e.getPreviewStyle()},N(vr,{id:"cvaa.caption_preview"})))))},a}(j))||Pl;function Nl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ul(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fl(){return(Fl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Bl,jl,Vl,$l,Hl,Gl,Kl={Main:"main",CustomCaptions:"custom-captions"},Wl=(Ml=Xt((function(e){return{style:e.cvaa.style}}),la(Fl({},ri,oa))),Dl=Fr("CVAAOverlay"),Rl=hn("CVAAOverlay"),Ml(Ol=Aa(Ol=Dl(Ol=Rl(Ol=Vi(Ol=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Ul(Nl(t=e.call.apply(e,[this].concat(a))||this),"transitionToState",(function(e){t.setState({activeWindow:e})})),Ul(Nl(t),"changeCaptionsStyle",(function(e){t.props.updateCaptionsStyle(e),t.props.player.textStyle=e,t.props.onClose(),t.props.notifyClick({textStyle:e})})),Ul(Nl(t),"getPreviewStyle",(function(){return"font-size: "+100*t.state.customTextStyle.implicitFontScale+"%!important; "+t.state.customTextStyle.toCSS()})),Ul(Nl(t),"changeCustomStyle",(function(e){t.setState((function(t){var r=t.customTextStyle.clone();return{customTextStyle:Object.assign(r,e)}}))})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentWillUnmount=function(){this.setState({activeWindow:Kl.Main})},n.componentWillMount=function(){var e=this.props.player;this.setState({activeWindow:Kl.Main,customTextStyle:e.textStyle}),this.props.setIsModal(!0)},n.render=function(e){return e.clearAccessibleChildren(),N(al,{open:!0,handleKeyDown:this.props.handleKeyDown,addAccessibleChild:this.props.addAccessibleChild,onClose:e.onClose,type:"cvaa"},this.state.activeWindow===Kl.Main?N(Tl,{cvaaOverlayState:Kl,addAccessibleChild:e.addAccessibleChild,captionsStyleDefault:this.captionsStyleDefault,captionsStyleBlackBG:this.captionsStyleBlackBG,captionsStyleYellow:this.captionsStyleYellow,changeCaptionsStyle:this.changeCaptionsStyle,transitionToState:this.transitionToState,customTextStyle:this.state.customTextStyle}):N(Ll,{addAccessibleChild:e.addAccessibleChild,focusOnDefault:this.props.focusOnDefault,changeCaptionsStyle:this.changeCaptionsStyle,changeCustomStyle:this.changeCustomStyle,getPreviewStyle:this.getPreviewStyle,customTextStyle:this.state.customTextStyle}))},a}(j))||Ol)||Ol)||Ol)||Ol)||Ol);function zl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ql(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function Yl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Wl.displayName="CVAAOverlay";var Xl,Ql,Jl,Zl,eu,tu,ru=(Bl=Xt((function(e){return{audioTracks:e.engine.audioTracks,textTracks:e.engine.textTracks,isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize}}),la(ri)),jl=Fs("Language"),Vl=Fr("Language"),$l=hn("Language"),Hl=br({audioLabelText:"language.audio",captionsLabelText:"language.captions",buttonLabel:"controls.language"}),Bl(Gl=Aa(Gl=Ba(Gl=jl(Gl=Vl(Gl=$l(Gl=Hl(Gl=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Yl(zl(t=e.call.apply(e,[this].concat(a))||this),"_lastActiveTextLanguage",""),Yl(zl(t),"_keyboardEventHandlers",[{key:{code:Rr.C},action:function(){var e=t.props,r=e.player,a=e.logger,n=r.getActiveTracks().text;if(n)if("off"===n.language&&t._lastActiveTextLanguage){a.debug("Changing text track to language",t._lastActiveTextLanguage);var i=r.getTracks("text").find((function(e){return e.language===t._lastActiveTextLanguage}));r.selectTrack(i)}else"off"===n.language||t._lastActiveTextLanguage||(a.debug("Hiding text track"),t._lastActiveTextLanguage=n.language,r.hideTextTrack())}}]),Yl(zl(t),"toggleSmartContainerOpen",(function(){t.setState((function(e){return{smartContainerOpen:!e.smartContainerOpen}}))})),Yl(zl(t),"toggleCVAAOverlay",(function(){t.setState((function(e){return{cvaaOverlay:!e.cvaaOverlay}}))})),Yl(zl(t),"onCVAAOverlayClose",(function(){t.toggleCVAAOverlay(),t.toggleSmartContainerOpen()})),t}ql(t,e);var r=t.prototype;return r.componentWillMount=function(){this.setState({smartContainerOpen:!1})},r.componentDidMount=function(){var e=this;this.props.eventManager.listen(document,"click",(function(t){return e.handleClickOutside(t)})),this.props.registerKeyboardEvents(this._keyboardEventHandlers)},r.componentWillReceiveProps=function(e){var t=this.props.textTracks.find((function(e){return e.active})),r=e.textTracks.find((function(e){return e.active}));t&&"off"!==t.language&&r&&"off"===r.language?this._lastActiveTextLanguage=t.language:r&&"off"!==r.language&&(this._lastActiveTextLanguage="")},r.handleClickOutside=function(e){!this._controlLanguageElement||this.props.isMobile||this._controlLanguageElement.contains(e.target)||!this.state.smartContainerOpen||this.state.cvaaOverlay||this.props.isSmallSize||this.setState({smartContainerOpen:!1})},r.onAudioChange=function(e){this.props.player.selectTrack(e),this.props.notifyClick({type:this.props.player.Track.AUDIO,track:e})},r.onCaptionsChange=function(e){this.props.player.selectTrack(e),this.props.notifyClick({type:this.props.player.Track.TEXT,track:e})},r.renderAll=function(e,t){var r=this,a=document.getElementById(this.props.player.config.targetId)||document;return N(ts,{name:"Language",ref:function(e){return e?r._controlLanguageElement=e:void 0}},N(Ro,{label:this.props.buttonLabel},N(jo,{tabIndex:"0","aria-haspopup":"true","aria-label":this.props.buttonLabel,className:this.state.smartContainerOpen?[ca.a.controlButton,ca.a.active].join(" "):ca.a.controlButton,onClick:this.toggleSmartContainerOpen},N(Eo,{type:mo.Language}))),!this.state.smartContainerOpen||this.state.cvaaOverlay?void 0:N(sl,{targetId:this.props.player.config.targetId,title:N(vr,{id:"language.title"}),onClose:this.toggleSmartContainerOpen},e.length<=1?void 0:N(ml,{icon:"audio",label:this.props.audioLabelText,options:e,onMenuChosen:function(e){return r.onAudioChange(e)}}),t.length<=1?void 0:N(ml,{icon:"captions",label:this.props.captionsLabelText,options:t,onMenuChosen:function(e){return r.onCaptionsChange(e)}}),t.length<=1?void 0:N(au,{isPortal:this.props.isMobile||this.props.isSmallSize,onMenuChosen:this.toggleCVAAOverlay,onClose:this.toggleSmartContainerOpen})),this.state.cvaaOverlay?Ye(N(Wl,{onClose:this.onCVAAOverlayClose}),a.querySelector(".overlay-portal")):N("div",null))},r.render=function(e){var t=e.audioTracks.filter((function(e){return e.label||e.language})).map((function(e){return{label:e.label||e.language,active:e.active,value:e}})),r=e.textTracks.map((function(e){return{label:e.label||e.language,active:e.active,value:e}}));return t.length>1||r.length>1?this.renderAll(t,r):void 0},t}(j))||Gl)||Gl)||Gl)||Gl)||Gl)||Gl)||Gl),au=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Yl(zl(t=e.call.apply(e,[this].concat(a))||this),"onKeyDown",(function(e){switch(e.keyCode){case Rr.ENTER:t.props.onMenuChosen(),e.preventDefault(),e.stopPropagation()}})),t}return ql(t,e),t.prototype.render=function(e){return N("div",{className:ca.a.smartContainerItem},N("a",{role:"button","aria-haspopup":"true",tabIndex:e.isPortal?"0":"-1",ref:function(t){e.pushRef&&e.pushRef(t)},className:ca.a.advancedCaptionsMenuLink,onClick:this.props.onMenuChosen,onKeyDown:this.onKeyDown},N(vr,{id:"language.advanced_captions_settings"})))},t}(j);function nu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ou(){return(ou=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}ru.displayName="Language";var su,lu,uu,cu,du,pu,hu=(Xl=Xt((function(e){return{isPlayingAdOrPlayback:To(e.engine),isPlaying:e.engine.isPlaying,adBreak:e.engine.adBreak,isPlaybackEnded:e.engine.isPlaybackEnded}}),la(ou({},oa,si,pi))),Ql=Fs("PlayPause"),Jl=Fr("PlayPause"),Zl=hn("PlayPause"),eu=br({startOverText:"controls.startOver",pauseText:"controls.pause",playText:"controls.play"}),Xl(tu=Aa(tu=Ql(tu=Jl(tu=Zl(tu=eu(tu=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return iu(nu(t=e.call.apply(e,[this].concat(a))||this),"_keyboardEventHandlers",[{key:{code:Rr.SPACE},action:function(){t.props.isPlayingAdOrPlayback?t.props.updateOverlayActionIcon(mo.Pause):t.props.updateOverlayActionIcon(mo.Play),t.togglePlayPause(),t.props.updatePlayerHoverState(!0)}}]),iu(nu(t),"togglePlayPause",(function(){t.props.logger.debug("Toggle play"),t.props.isPlayingAdOrPlayback?t.props.player.pause():t.props.player.play(),t.props.notifyClick()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){this.props.registerKeyboardEvents(this._keyboardEventHandlers)},n.render=function(e){var t=this.props.isPlayingAdOrPlayback?[ca.a.controlButton,ca.a.isPlaying].join(" "):ca.a.controlButton,r=e.isPlaybackEnded&&!this.props.adBreak,a=this.props.isPlayingAdOrPlayback?this.props.pauseText:this.props.playText,n=r?this.props.startOverText:a;return N(ts,{name:"PlayPause"},N(Ro,{label:n},N(jo,{tabIndex:"0","aria-label":n,className:t,onClick:this.togglePlayPause},r?N(Eo,{type:mo.StartOver}):N("div",null,N(Eo,{type:mo.Play}),N(Eo,{type:mo.Pause})))))},a}(j))||tu)||tu)||tu)||tu)||tu)||tu);function fu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yu(){return(yu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}hu.displayName="PlayPause";var mu,vu,_u,ku,Eu,Tu,bu=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],Su=(su=Xt((function(e){return{videoTracks:e.engine.videoTracks,isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,isLive:e.engine.isLive}}),la(yu({},si,pi))),lu=br({qualityLabelText:"settings.quality",speedLabelText:"settings.speed",buttonLabel:"controls.settings",speedNormalLabelText:"settings.speedNormal",qualityAutoLabelText:"settings.qualityAuto"}),uu=Fs("Settings"),cu=Fr("Settings"),du=hn("Settings"),su(pu=lu(pu=Aa(pu=Ba(pu=uu(pu=cu(pu=du(pu=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return gu(fu(t=e.call.apply(e,[this].concat(a))||this),"_keyboardEventHandlers",[{key:{code:Rr.PERIOD,shiftKey:!0},action:function(e){t.handleKeydown(e)}},{key:{code:Rr.SEMI_COLON,shiftKey:!0},action:function(e){t.handleKeydown(e)}},{key:{code:Rr.COMMA,shiftKey:!0},action:function(e){t.handleKeydown(e)}}]),gu(fu(t),"onControlButtonClick",(function(){t.setState((function(e){return{smartContainerOpen:!e.smartContainerOpen}}))})),gu(fu(t),"onSpeedChange",(function(e){t.props.updateSpeed(e),t.props.player.playbackRate=e,t.props.notifyClick({speed:e})})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentWillMount=function(){this.setState({smartContainerOpen:!1})},n.componentDidMount=function(){var e=this;this.props.eventManager.listen(document,"click",(function(t){return e.handleClickOutside(t)})),this.props.registerKeyboardEvents(this._keyboardEventHandlers)},n.handleKeydown=function(e){var t,r,a=this.props,n=a.player,i=a.logger;switch(e.keyCode){case Rr.PERIOD:t=n.playbackRate,(r=n.playbackRates.indexOf(t))<n.playbackRates.length-1&&(i.debug("Changing playback rate. "+t+" => "+n.playbackRates[r+1]),n.playbackRate=n.playbackRates[r+1],this.props.updateOverlayActionIcon(mo.SpeedUp),n.dispatchEvent(new Ka(n.playbackRate)));break;case Rr.SEMI_COLON:n.playbackRate!==n.defaultPlaybackRate&&(i.debug("Changing playback rate. "+n.playbackRate+" => "+n.defaultPlaybackRate),n.playbackRate=n.defaultPlaybackRate,this.props.updateOverlayActionIcon(mo.Speed),n.dispatchEvent(new Ka(n.playbackRate)));break;case Rr.COMMA:t=n.playbackRate,(r=n.playbackRates.indexOf(t))>0&&(i.debug("Changing playback rate. "+t+" => "+n.playbackRates[r-1]),n.playbackRate=n.playbackRates[r-1],this.props.updateOverlayActionIcon(mo.SpeedDown),n.dispatchEvent(new Ka(n.playbackRate)))}},n.handleClickOutside=function(e){this.props.isMobile||this.props.isSmallSize||!this._controlSettingsElement||this._controlSettingsElement.contains(e.target)||!this.state.smartContainerOpen||this.setState({smartContainerOpen:!1})},n.onQualityChange=function(e){var t=this.props.player;"auto"===e?t.enableAdaptiveBitrate():t.selectTrack(e),this.props.notifyClick({type:t.Track.VIDEO,track:e})},n.filterUniqueQualities=function(e,t){var r=e.length-1,a=e[r];return r>-1&&t.label===a.label?(t.bandwidth>a.bandwidth&&(e[r]=t),e[r].active=t.active||a.active):e.push(t),e},n.getLabelBadgeType=function(e){var t=Object.keys(vo),r=t[0],a=t[2],n=t[4];return e>=1080&&e<2160?r:e>=2160&&e<4320?a:e>=4320?n:null},n.getButtonBadgeType=function(){var e,t,r=null==(e=this.props.player.getActiveTracks())||null==(t=e.video)?void 0:t.height;return r?this.getLabelBadgeType(r):null},n.render=function(e){var t=this,r=this.props,a=r.player,n=r.isLive,i=a.playbackRates.reduce((function(t,r){var n={value:r,label:1===r?e.speedNormalLabelText:r,active:!1};return r===a.playbackRate&&(n.active=!0),t.push(n),t}),[]),o=e.videoTracks.sort((function(e,t){return e.height<t.height?1:-1})).filter((function(e){return e.bandwidth||e.height})).reduce(this.filterUniqueQualities,[]).map((function(e){return{label:e.label,active:!a.isAdaptiveBitrateEnabled()&&e.active,value:e,badgeType:t.getLabelBadgeType(e.height)}}));if(o.length>1&&"progressive"!==a.streamType){var s,l=o.find((function(e){return!0===e.value.active})).value;s=bu.includes(this.props.player._localPlayer._config.ui.locale)?l.label+" - "+this.props.qualityAutoLabelText:this.props.qualityAutoLabelText+" - "+l.label,o.unshift({label:this.props.qualityAutoLabelText,dropdownOptions:{label:s,badgeType:this.getLabelBadgeType(l.height)},active:a.isAdaptiveBitrateEnabled(),value:"auto"})}if(!(o.length<=1&&i.length<=1||n&&o.length<=1)){var u=this.getButtonBadgeType()||"";return N(ts,{name:"Settings",ref:function(e){return e?t._controlSettingsElement=e:void 0}},N(Ro,{label:e.buttonLabel},N(jo,{tabIndex:"0","aria-label":e.buttonLabel,className:[ca.a.controlButton,ca.a.buttonBadge,vo[u+"Active"],this.state.smartContainerOpen?ca.a.active:""].join(" "),onClick:this.onControlButtonClick},N(Eo,{type:mo.Settings}))),this.state.smartContainerOpen?N(sl,{targetId:a.config.targetId,title:N(vr,{id:"settings.title"}),onClose:this.onControlButtonClick},o.length<=1?"":N(ml,{icon:"quality",label:e.qualityLabelText,options:o,onMenuChosen:function(e){return t.onQualityChange(e)}}),n||i.length<=1?"":N(ml,{icon:"speed",label:e.speedLabelText,options:i,onMenuChosen:this.onSpeedChange})):"")}},a}(j))||pu)||pu)||pu)||pu)||pu)||pu)||pu);function Au(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pu(){return(Pu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}Su.displayName="Settings";var wu,xu,Iu,Mu,Du=(mu=Xt((function(e){return{isDraggingActive:e.volume.draggingActive,volume:e.engine.volume,muted:e.engine.muted,isMobile:e.shell.isMobile}}),la(Pu({},Wn,Ta,pi))),vu=Fs("Volume"),_u=Fr("Volume"),ku=hn("Volume"),Eu=br((function(e){return{tooltipLabel:e.muted?N(vr,{id:"controls.unmute"},"Unmute"):N(vr,{id:"controls.mute"},"Mute"),volBtnAriaLabel:e.muted?N(vr,{id:"volume.muted"},"Muted. Click to unmute"):N(vr,{id:"volume.unmuted",fields:{vol:(100*e.player.volume).toFixed()}},"Click to mute")}})),mu(Tu=Aa(Tu=Ba(Tu=vu(Tu=_u(Tu=ku(Tu=Eu(Tu=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Cu(Au(t=e.call.apply(e,[this].concat(a))||this),"_keyboardEventHandlers",[{key:{code:Rr.UP},action:function(e){t.handleKeydown(e)}},{key:{code:Rr.DOWN},action:function(e){t.handleKeydown(e)}},{key:{code:Rr.M},action:function(e){t.handleKeydown(e)}}]),Cu(Au(t),"onVolumeProgressBarMouseDown",(function(){t.props.updateVolumeDraggingStatus(!0)})),Cu(Au(t),"onVolumeProgressBarMouseMove",(function(e){t.props.isDraggingActive&&t.changeVolume(e)})),Cu(Au(t),"onMouseOver",(function(){t.props.isMobile||(t.props.updateVolumeHover(!0),t.setState({hover:!0}))})),Cu(Au(t),"onMouseOut",(function(){t.props.isMobile||(t.props.updateVolumeHover(!1),t.setState({hover:!1}))})),Cu(Au(t),"onKeyDown",(function(e){switch(e.keyCode){case Rr.UP:case Rr.DOWN:case Rr.ENTER:case Rr.SPACE:e.preventDefault(),e.stopPropagation(),t.handleKeydown(e);break;default:t.setState({hover:!1})}})),Cu(Au(t),"onFocus",(function(){t.state.hover||t.setState({hover:!0})})),Cu(Au(t),"onTouchEnd",(function(e){e.stopImmediatePropagation()})),Cu(Au(t),"onVolumeProgressBarMouseUp",(function(e){t.props.isDraggingActive&&(t.props.updateVolumeDraggingStatus(!1),t.changeVolume(e))})),Cu(Au(t),"toggleMute",(function(){var e=t.props.player;0===e.volume?(t.props.logger.debug("Toggle mute. Volume is 0, set mute to false & volume to 0.5"),e.muted=!1,e.volume=.5):(t.props.logger.debug("Toggle mute. "+e.muted+" => "+!e.muted),e.muted=!e.muted),t.props.notifyClick()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this,t=this.props.player;this.props.eventManager.listen(t,t.Event.LOADED_METADATA,(function(){e.props.updateVolume(t.volume),e.props.updateMuted(t.muted)})),this.props.eventManager.listen(t,t.Event.VOLUME_CHANGE,(function(){e.props.updateMuted(t.muted),e.props.updateVolume(t.volume)})),this.props.eventManager.listen(document,"mouseup",this.onVolumeProgressBarMouseUp),this.props.eventManager.listen(document,"mousemove",this.onVolumeProgressBarMouseMove),this.props.eventManager.listen(document,"click",(function(t){return e.handleClickOutside(t)})),this.props.registerKeyboardEvents(this._keyboardEventHandlers)},n.handleClickOutside=function(e){!this.props.isMobile&&this._volumeControlElement&&!this._volumeControlElement.contains(e.target)&&this.state.hover&&this.setState({hover:!1})},n.getVolumeProgressHeight=function(){return this.props.muted?"0%":Math.round(100*this.props.volume)+"%"},n.handleKeydown=function(e){var t,r=this,a=this.props.player,n=function(e){e===a.volume||e>100||e<0||(a.muted=e<5,a.volume=e/100,r.props.notifyChange({volume:a.volume}))};switch(e.keyCode){case Rr.UP:this.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeWaves]),n(t=Math.min(Math.round(100*a.volume)+5,100));break;case Rr.DOWN:0===(t=Math.max(Math.round(100*a.volume)-5,0))?this.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeMute]):this.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeWave]),n(t);break;case Rr.M:a.muted?this.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeWaves]):this.props.updateOverlayActionIcon([mo.VolumeBase,mo.VolumeMute]),this.toggleMute();break;case Rr.ENTER:case Rr.SPACE:this.toggleMute()}},n.changeVolume=function(e){var t,r=this.props.player,a=this._volumeProgressBarElement.getBoundingClientRect();t=a.height>a.width?this._getVerticalVolume(a,e):this._getHorizontalVolume(a,e),(t=parseFloat(t.toFixed(2)))<=1&&t>=0&&(this.props.logger.debug("Change volume from "+r.volume+" => "+t),r.volume=t,this.props.muted&&(r.muted=!1),this.props.notifyChange({volume:r.volume}))},n._getHorizontalVolume=function(e,t){var r=e.width,a=e.left,n=t.clientX;return 0!=r?(n-a)/r:0},n._getVerticalVolume=function(e,t){var r=e.height,a=e.top,n=t.clientY;return 0!=r?1-(n-a)/r:0},n.render=function(){var e=this;if(!this.props.player.isImage()){var t=this.props,r=t.player,a=t.isDraggingActive,n=t.muted,i=t.volume,o=t.smartContainerOpen,s=[ca.a.volumeControl];return a&&s.push(ca.a.draggingActive),(n||0===i)&&s.push(ca.a.isMuted),this.state.hover&&!o&&s.push(ca.a.hover),N(ts,{role:"application",name:"Volume",ref:function(t){return t?e._volumeControlElement=t:void 0},className:s,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},N(Ro,{label:this.props.tooltipLabel,type:this.props.toolTipType?this.props.toolTipType:Do.Left},N(jo,{tabIndex:"0","aria-live":"polite","aria-label":this.props.volBtnAriaLabel,className:ca.a.controlButton,onMouseUp:this.toggleMute,onTouchEnd:this.onTouchEnd,onKeyDown:this.onKeyDown,onFocus:this.onFocus},N(Eo,{type:mo.VolumeBase}),N(Eo,{type:mo.VolumeWaves}),N(Eo,{type:mo.VolumeMute}))),N("div",{className:ca.a.volumeControlBar,role:"slider","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":100*r.volume,"aria-valuetext":100*r.volume+"% volume "+(r.muted?"muted":"")},N("div",{className:ca.a.bar,ref:function(t){return t?e._volumeProgressBarElement=t:void 0},onMouseDown:this.onVolumeProgressBarMouseDown},N("div",{className:ca.a.progress,style:{height:this.getVolumeProgressHeight()}}))))}},a}(j))||Tu)||Tu)||Tu)||Tu)||Tu)||Tu)||Tu);function Ru(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ou(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lu(){return(Lu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}Du.displayName="Volume";var Nu=(wu=Xt((function(e){return{isVr:e.engine.isVr,vrStereoMode:e.engine.vrStereoMode,config:e.config.components.vrStereo}}),la(Lu({},oa,Ta))),xu=Fr("VrStereo"),Iu=br({vrStereoText:"controls.vrStereo"}),wu(Mu=Aa(Mu=xu(Mu=Iu(Mu=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Ou(Ru(t=e.call.apply(e,[this].concat(a))||this),"onClick",(function(){t.props.player.toggleVrStereoMode(),t.props.updateVrStereoMode(!t.props.vrStereoMode)})),Ou(Ru(t),"onKeyDown",(function(e){e.keyCode===Rr.ENTER&&t.onClick()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n._shouldRender=function(){var e=this.props.config;return this.props.isVr&&!(0===Object.keys(e).length&&e.constructor===Object)},n.componentWillMount=function(){this.props.updateVrStereoMode(this.props.config.vrStereoMode)},n.render=function(){if(this._shouldRender())return N(ts,{name:"VrStereo"},N(Ro,{label:this.props.vrStereoText},N(jo,{tabIndex:"0","aria-label":this.props.vrStereoText,className:this.props.vrStereoMode?[ca.a.controlButton,ca.a.vrStereoMode].join(" "):ca.a.controlButton,onClick:this.onClick,onKeyDown:this.onKeyDown},N(Eo,{type:mo.vrStereo}),N(Eo,{type:mo.vrStereoFull}))))},a}(j))||Mu)||Mu)||Mu)||Mu);Nu.displayName="VrStereo";var Uu,Fu=Xt((function(e){return{textTracks:e.engine.textTracks,showCCButton:e.config.showCCButton}}))(Fr("ClosedCaptions")(hn("ClosedCaptions")(br({closedCaptionsOnText:"controls.closedCaptionsOn",closedCaptionsOffText:"controls.closedCaptionsOff"})((function(e,t){var r,a=ye(!1),n=a[0],i=a[1],o=e.textTracks,s=t.player,l=o.find((function(e){return e.active}));if(ve((function(){i("off"!==(null==l?void 0:l.language))}),[l]),(null==(r=e.textTracks)?void 0:r.length)&&e.showCCButton)return N(ts,{name:"ClosedCaptions"},n?N(Ro,{label:e.closedCaptionsOnText},N(jo,{tabIndex:"0","aria-label":e.closedCaptionsOnText,className:[ca.a.controlButton,ca.a.ccOn].join(" "),onClick:function(){e.notifyClick(!0),s.hideTextTrack()}},N(Eo,{type:mo.ClosedCaptionsOn}))):N(Ro,{label:e.closedCaptionsOffText},N(jo,{tabIndex:"0","aria-label":e.closedCaptionsOffText,className:ca.a.controlButton,onClick:function(){e.notifyClick(!1),s.showTextTrack()}},N(Eo,{type:mo.ClosedCaptionsOff}))))})))));Fu.displayName="ClosedCaptions";var Bu,ju,Vu,$u=Xt((function(e){return{url:e.engine.adUrl}}))(Uu=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){return N("a",{href:e.url,target:"_blank",rel:"noreferrer",className:[ca.a.btn,ca.a.btnDarkTransparent,ca.a.learnMore].join(" ")},N(vr,{id:"ads.learn_more"}))},a}(j))||Uu;function Hu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}$u.displayName="AdLearnMore";var Ku=(Bu=Xt((function(e){return{currentTime:e.engine.adProgress.currentTime,duration:e.engine.adProgress.duration,adSkipTimeOffset:e.engine.adSkipTimeOffset,adSkippableState:e.engine.adSkippableState}})),ju=Fr("AdSkip"),Bu(Vu=Aa(Vu=ju(Vu=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Gu(Hu(t=e.call.apply(e,[this].concat(a))||this),"skipAd",(function(){t.props.player.ads.skipAd()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.getSkipTimeOffset=function(){return Math.ceil(this.props.adSkipTimeOffset-this.props.currentTime)},n.render=function(){return this.props.adSkippableState?this.getSkipTimeOffset()<=0?N(kr,null,N("a",{className:[ca.a.btn,ca.a.btnBranded,ca.a.btnSkipAd].join(" "),onClick:this.skipAd},N(vr,{id:"ads.skip_ad"}))):N(kr,null,N("span",{className:ca.a.skipAd},N(vr,{id:"ads.skip_in"})," "+this.getSkipTimeOffset())):void 0},a}(j))||Vu)||Vu)||Vu);Ku.displayName="AdSkip";var Wu=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(){return N("span",{className:ca.a.adNotice},N(vr,{id:"ads.ad_notice"}))},a}(j);Wu.displayName="AdNotice";var zu,qu=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.PLAYER_RESIZE)||this).payload={playerSize:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),Yu=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.GUI_RESIZE)||this).payload={guiSize:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),Xu=function(e){var t,r;function a(t){var r;return(r=e.call(this,Ia.Type.VIDEO_RESIZE)||this).payload={videoSize:t},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(Ia),Qu="event-dispatcher-middleware/COMPONENT_CLICKED",Ju="event-dispatcher-middleware/COMPONENT_CHANGED";function Zu(e,t,r){var a=e.getState().engine;a.adBreak?a.adIsPlaying?r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_PAUSE)):r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_PLAY)):a.isPlaying?r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_PAUSE)):r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_PLAY))}function ec(e,t,r){e.getState().engine.muted?r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_MUTE)):r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_UNMUTE))}function tc(e,t,r){r.isFullscreen()?r.dispatchEvent(new Ia(Ia.Type.USER_EXITED_FULL_SCREEN)):r.dispatchEvent(new Ia(Ia.Type.USER_ENTERED_FULL_SCREEN))}var rc,ac=((zu={})[Rr.SPACE]=function(e,t,r){Zu(e,0,r)},zu[Rr.UP]=function(e,t,r){r.dispatchEvent(new Ya(t.payload.volume))},zu[Rr.DOWN]=function(e,t,r){r.dispatchEvent(new Ya(t.payload.volume))},zu[Rr.F]=function(e,t,r){tc(0,0,r)},zu[Rr.P]=function(e,t,r){!function(e,t,r){r.isInPictureInPicture()?r.dispatchEvent(new Ia(Ia.Type.USER_EXITED_PICTURE_IN_PICTURE)):r.dispatchEvent(new Ia(Ia.Type.USER_ENTERED_PICTURE_IN_PICTURE))}(0,0,r)},zu[Rr.ESC]=function(e,t,r){tc(0,0,r)},zu[Rr.LEFT]=function(e,t,r){r.dispatchEvent(new Ga(t.payload.from,t.payload.to))},zu[Rr.RIGHT]=function(e,t,r){r.dispatchEvent(new Ga(t.payload.from,t.payload.to))},zu[Rr.HOME]=function(e,t,r){r.dispatchEvent(new Ga(t.payload.from,t.payload.to))},zu[Rr.END]=function(e,t,r){r.dispatchEvent(new Ga(t.payload.from,t.payload.to))},zu[Rr.M]=function(e,t,r){ec(e,0,r)},zu[Rr.SEMI_COLON]=function(e,t,r){r.dispatchEvent(new Ka(t.payload.speed))},zu[Rr.PERIOD]=function(e,t,r){r.dispatchEvent(new Ka(t.payload.speed))},zu[Rr.COMMA]=function(e,t,r){r.dispatchEvent(new Ka(t.payload.speed))},zu[Rr.C]=function(e,t,r){r.dispatchEvent(new Va(t.payload.track))},zu),nc=function(e){var t,r;function a(t){var r;return void 0===t&&(t={config:{}}),(r=e.call(this)||this).name=t.name,r.config=t.config,r.player=t.player,r.eventManager=new Ra,r.logger=Ir("UI "+r.name),r.logger.debug("Initialized"),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.notifyClick=function(e){this.context.store.dispatch({type:Qu,name:this.name,payload:e})},n.notifyChange=function(e){this.context.store.dispatch({type:Ju,name:this.name,payload:e})},n.componentWillUnmount=function(){this.eventManager.removeAll()},a}(j);function ic(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(nc,"defaultProps",{});var sc=Xt((function(e){return{isCasting:e.engine.isCasting,isPlaybackEnded:e.engine.isPlaybackEnded,guiClientRect:e.shell.guiClientRect}}),la(oa))(rc=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return oc(ic(t=e.call.apply(e,[this].concat(a))||this),"_ref",{current:null}),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidUpdate=function(){var e=this._ref.current.scrollHeight>ca.a.bottomBarMaxHeight;this.state.lineBreak!==e&&this.setState({lineBreak:e})},n.render=function(e){var t=e.leftControls,r=e.rightControls,a=[ca.a.bottomBar];return e.isCasting&&e.isPlaybackEnded&&a.push(ca.a.hide),this.state.lineBreak&&a.push(ca.a.lineBreak),N("div",{ref:this._ref,className:a.join(" ")},N("div",{className:ca.a.bottomBarArea},N(zr,{name:"BottomBar"},e.children)),N("div",{className:ca.a.leftControls},N(zr,{name:"BottomBarLeftControls"},t)),N("div",{className:ca.a.rightControls},N(zr,{name:"BottomBarRightControls"},r)))},a}(j))||rc;function lc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}sc.displayName="BottomBar";var cc,dc,pc,hc=[{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7 4C5.89543 4 5 4.89543 5 6V13C5 14.1046 5.89543 15 7 15H11C12.1046 15 13 14.1046 13 13V6C13 4.89543 12.1046 4 11 4H7ZM7 6H11V13H7V6Z"},{d:"M15 11H16V18H12V17.2H10V18.1C10 19.2458 10.9971 20 12 20H16C17.0029 20 18 19.2458 18 18.1V10.9C18 9.75416 17.0029 9 16 9H15V11Z"}],fc=function(e){var t,r;function a(t){var r;return uc(lc(r=e.call(this,t)||this),"_timeoutId",null),uc(lc(r),"copy",(function(){try{r.props.copy(),r.setState({copySuccess:!0}),r._timeoutId=setTimeout((function(){r.setState({copySuccess:!1})}),2e3)}catch(e){r.setState({copySuccess:!1})}})),uc(lc(r),"onKeyDown",(function(e){e.keyCode===Rr.ENTER&&r.copy()})),r.setState({copySuccess:!1}),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentWillUnmount=function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},n.render=function(e){var t=[ca.a.btnCopyUrl,ca.a.btnBorderless,ca.a.onlyIcon].join(" ");return t+=this.state.copySuccess?" "+ca.a.copied:"",N(kr,null,N(ts,{name:"CopyButton"},N(Ro,{label:N(vr,{id:"copy.button"})},N(jo,{tabIndex:"0",ref:function(t){e.addAccessibleChild&&e.addAccessibleChild(t)},className:t,onClick:this.copy,onKeyDown:this.onKeyDown},N(ko,{id:"copy",color:"#fff",path:hc,width:"24",height:"24",viewBox:"0 0 24 24"}),N(ko,{type:mo.Check})))))},a}(j);function gc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}uc(fc,"defaultProps",{icon:mo.Copy}),fc.displayName="CopyButton";var mc,vc,_c,kc,Ec=(cc=Xt((function(e){return{hasError:e.engine.hasError}}),la(Ta)),dc=Fr("ErrorOverlay"),cc(pc=Aa(pc=dc(pc=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return yc(gc(t=e.call.apply(e,[this].concat(a))||this),"copyError",(function(){var e=window.getSelection(),r=document.createRange();r.selectNode(t.sessionEl),e.removeAllRanges(),e.addRange(r),document.execCommand("copy")})),yc(gc(t),"handleClick",(function(){var e=t.props.player.getMediaInfo();t.props.player.loadMedia(e)})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.renderSessionID=function(){var e=this,t=this.props.player,r=t&&t.config&&t.config.session&&t.config.session.id;return r?N("div",{className:ca.a.linkOptionsContainer},N("div",{className:ca.a.copyUrlRow},N("div",{ref:function(t){return t?e.sessionEl=t:void 0},className:ca.a.errorSession},N(vr,{id:"error.default_session_text"})," "," "+r),N(fc,{copy:this.copyError}))):void 0},n.renderRetryButton=function(){if(this.props.player.getMediaInfo())return N("div",{className:ca.a.controlButtonContainer,onClick:this.handleClick},N(jo,{className:[ca.a.controlButton,ca.a.retryBtn].join(" ")},N(vr,{id:"error.retry"})))},n.render=function(){return this.props&&this.props.hasError?N("div",{className:"overlay-portal"},N(al,{open:!0,permanent:!0,type:"error"},N("div",{className:ca.a.errorOverlay},N("p",{className:ca.a.errorText}),N("div",{className:ca.a.svgContainer},N("svg",{width:"124",height:"110",viewBox:"0 0 124 110",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},N("defs",null,N("polygon",{id:"path-1",points:"58.0906294 70 50.7492774 88.8201923 60.1881585 88.8201923 54.22331 107 73.8876457 84.2307692 64.0554779 84.2307692 70.6102564 70"})),N("g",{id:"Player-v3",fill:"none",fillRule:"evenodd"},N("g",{id:"Desktop---Default---Error",transform:"translate(-365 -103)"},N("g",{id:"Cloud",transform:"translate(366 104)"},N("path",{d:"M63.5662942,30.179068 C61.0506558,29.4162424 58.3339083,29 55.5,29 C42.5213084,29 32,37.7304474 32,48.5 C32,48.6497107 32.0020332,48.7990274 32.0060779,48.947932 L32.0060779,48.947932 C20.975194,51.4855427 13,58.8323573 13,67.5 C13,71.2164926 14.4662425,74.6901504 17.0109182,77.6459815 C17.3714483,67.0552274 26.624181,58.1393462 39.3259742,55.0194402 L39.3259742,55.0194402 C39.3212229,54.8326784 39.3188345,54.6453999 39.3188345,54.4576271 C39.3188345,41.956968 49.9040267,31.6467441 63.5662942,30.179068 Z",id:"Combined-Shape",fillOpacity:".08",fill:"#2E2E2E"}),N("path",{d:"M31.0032591,48.1614253 C31.2192187,36.9518144 42.1402046,28 55.5,28 C64.749856,28 73.0886419,32.3249294 77.2653132,39.0733535 C84.8537029,39.7078593 90.7909537,44.3809769 90.9945979,50.1913309 C102.911627,51.5069936 112,59.4322556 112,69 C112,79.5603607 100.981582,88 87.5,88 C84.4639246,88 81.503099,87.5724513 78.7283559,86.7489741 C74.6488476,88.1943213 69.4726739,89 64,89 C58.7323857,89 53.737093,88.2538247 49.7263698,86.9058736 C46.7827225,87.6274324 43.6763865,88 40.5,88 C24.8190401,88 12,78.9101352 12,67.5 C12,58.659353 19.7679337,51.004786 31.0032591,48.1614253 Z",id:"Combined-Shape",stroke:"#666",strokeWidth:"2"}),N("g",{id:"Path-8",strokeLinecap:"round",strokeLinejoin:"round"},N("use",{fill:"#666",xlinkHref:"#path-1"}),N("path",{stroke:"#1D1D1D",strokeWidth:"2",d:"M65.6170644,83.2307692 L76.0725949,83.2307692 L51.7165365,111.432521 L58.8076053,89.8201923 L49.2858112,89.8201923 L57.4073201,69 L72.1718429,69 L65.6170644,83.2307692 Z"})),N("path",{d:"M59.9991166,0 L59.9991166,7.04768642 C59.9991166,7.59997117 60.4468318,8.04768642 60.9991166,8.04768642 C61.5514013,8.04768642 61.9991166,7.59997117 61.9991166,7.04768642 L61.9991166,0 C61.9991166,-0.55228475 61.5514013,-1 60.9991166,-1 C60.4468318,-1 59.9991166,-0.55228475 59.9991166,0 Z M95.3084192,8.85153517 L90.7782537,14.2503762 C90.4232519,14.6734508 90.4784359,15.3042064 90.9015106,15.6592082 C91.3245852,16.01421 91.9553408,15.9590261 92.3103426,15.5359514 L96.8405081,10.1371104 C97.1955099,9.71403572 97.140326,9.08328013 96.7172513,8.72827833 C96.2941766,8.37327654 95.663421,8.4284605 95.3084192,8.85153517 Z M121.628196,36.6783398 L114.687579,37.9021577 C114.143685,37.9980609 113.780517,38.5167193 113.87642,39.0606136 C113.972323,39.6045079 114.490981,39.9676764 115.034876,39.8717732 L121.975492,38.6479553 C122.519386,38.552052 122.882555,38.0333936 122.786652,37.4894993 C122.690748,36.945605 122.17209,36.5824365 121.628196,36.6783398 Z M0.0227411046,38.6479553 L6.96335733,39.8717732 C7.50725163,39.9676764 8.02591002,39.6045079 8.12181326,39.0606136 C8.2177165,38.5167193 7.85454799,37.9980609 7.31065368,37.9021577 L0.37003746,36.6783398 C-0.173856844,36.5824365 -0.69251523,36.945605 -0.788418471,37.4894993 C-0.884321711,38.0333936 -0.521153199,38.552052 0.0227411046,38.6479553 Z M25.157725,10.1371104 L29.6878905,15.5359514 C30.0428923,15.9590261 30.6736479,16.01421 31.0967226,15.6592082 C31.5197972,15.3042064 31.5749812,14.6734508 31.2199794,14.2503762 L26.6898139,8.85153517 C26.3348121,8.4284605 25.7040565,8.37327654 25.2809818,8.72827833 C24.8579072,9.08328013 24.8027232,9.71403572 25.157725,10.1371104 Z",id:"Path-9",fill:"#666",fillRule:"nonzero"})))))),N("div",{className:ca.a.headline},this.props.errorHead?this.props.errorHead:N(vr,{id:"error.default_error"})),this.renderSessionID(),this.renderRetryButton()))):void 0},a}(j))||pc)||pc)||pc);function Tc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ec.displayName="ErrorOverlay";var Sc=(mc=Xt((function(e){return{isLive:e.engine.isLive,isDvr:e.engine.isDvr,currentTime:e.engine.currentTime,duration:e.engine.duration}})),vc=Fr("LiveTag"),_c=hn("LiveTag"),mc(kc=Aa(kc=vc(kc=_c(kc=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return bc(Tc(t=e.call.apply(e,[this].concat(a))||this),"onKeyDown",(function(e){e.keyCode===Rr.ENTER&&t.onClick()})),bc(Tc(t),"onClick",(function(){t.isOnLiveEdge()||(t.props.player.seekToLiveEdge(),t.props.player.paused&&t.props.player.play()),t.props.notifyClick()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.isOnLiveEdge=function(){return this.props.player.isOnLiveEdge()},n.render=function(e){var t=[ca.a.liveTag];return e.isDvr&&!this.isOnLiveEdge()&&t.push(ca.a.nonLivePlayhead),N("div",{tabIndex:"0",className:t.join(" "),onClick:this.onClick,onKeyDown:this.onKeyDown},N(vr,{id:"controls.live"}))},a}(j))||kc)||kc)||kc)||kc);Sc.displayName="LiveTag";var Ac,Cc,Pc,wc,xc=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.shouldComponentUpdate=function(){return!1},n.render=function(e){return N("div",{className:"overlay-portal","aria-live":"polite"},e.children)},a}(j);function Ic(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}xc.displayName="OverlayPortal";var Mc=(Ac=Xt((function(e){return{currentTime:e.seekbar.currentTime,virtualTime:e.seekbar.virtualTime,isDraggingActive:e.seekbar.draggingActive,isMobile:e.shell.isMobile,poster:e.engine.poster,isDvr:e.engine.isDvr,dataLoaded:e.engine.dataLoaded}}),la(Vn)),Cc=hn("SeekBarLivePlaybackContainer"),Pc=Fr("SeekBarLivePlaybackContainer"),Ac(wc=Aa(wc=Ba(wc=Cc(wc=Pc(wc=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n,i,o=a.prototype;return o.componentDidMount=function(){var e=this.props,t=e.eventManager,r=e.player,a=e.isDraggingActive,n=e.updateCurrentTime;t.listen(r,r.Event.TIME_UPDATE,(function(){a||n(Math.max(r.normalizedCurrentTime,0))})),t.listen(r,r.Event.LOADED_DATA,(function(){n(Math.max(r.normalizedCurrentTime,0))}))},o.render=function(e){var t=this;if(e.isDvr)return N(lp,{playerElement:this.props.playerContainer,showFramePreview:this.props.showFramePreview,showTimeBubble:this.props.showTimeBubble,changeCurrentTime:function(e){t.props.player.isOnLiveEdge()&&e===t.duration||(t.props.player.normalizedCurrentTime=e)},playerPoster:this.props.poster,updateSeekbarDraggingStatus:function(e){return t.props.updateSeekbarDraggingStatus(e)},updateSeekbarHoverActive:function(e){return t.props.updateSeekbarHoverActive(e)},updateSeekbarClientRect:function(e){return t.props.updateSeekbarClientRect(e)},updateCurrentTime:function(e){return t.props.updateCurrentTime(e)},updateVirtualTime:function(e){return t.props.updateVirtualTime(e)},isDvr:this.props.isDvr,currentTime:this.currentTime,virtualTime:this.props.virtualTime,duration:this.duration,isDraggingActive:this.props.isDraggingActive,isMobile:this.props.isMobile,notifyChange:function(e){return t.props.notifyChange(e)},forceFullProgress:this.props.player.isOnLiveEdge(),dataLoaded:this.props.dataLoaded})},n=a,(i=[{key:"currentTime",get:function(){return Math.min(this.props.currentTime,this.duration)}},{key:"duration",get:function(){return this.props.player.normalizedDuration}}])&&Ic(n.prototype,i),a}(j))||wc)||wc)||wc)||wc)||wc);Mc.displayName="SeekBarLivePlaybackContainer";var Dc,Rc=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.getTimeDisplay=function(e,t,r){var a=r||"current / total",n=$i(e),i=$i(t),o=$i(t-e);return(a=(a=a.replace(/current/g,n)).replace(/total/g,i)).replace(/left/g,o)},n.render=function(e){return N("div",{className:ca.a.timeDisplay},N("span",null,this.getTimeDisplay(e.currentTime,e.duration,e.format)))},a}(j);function Oc(){return(Oc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}Rc.displayName="TimeDisplay";var Lc,Nc=Xt((function(e){return{adProgress:e.engine.adProgress}}))(Dc=Fr("TimeDisplayAdsContainer")(Dc=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){return N(Rc,Oc({currentTime:Math.round(e.adProgress.currentTime),duration:Math.round(e.adProgress.duration)},e))},a}(j))||Dc)||Dc;function Uc(){return(Uc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}Nc.displayName="TimeDisplayAdsContainer";var Fc,Bc=Xt((function(e){return{currentTime:e.engine.currentTime,duration:e.engine.duration}}))(Lc=Fr("TimeDisplayPlaybackContainer")(Lc=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){return N(Rc,Uc({currentTime:e.currentTime,duration:e.duration},e))},a}(j))||Lc)||Lc;Bc.displayName="TimeDisplayPlaybackContainer";var jc,Vc,$c,Hc=Xt((function(e){return{isCasting:e.engine.isCasting,isPlaybackEnded:e.engine.isPlaybackEnded}}))(Fc=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){var t=e.disabled,r=e.isPlaybackEnded,a=e.isCasting,n=e.leftControls,i=e.rightControls,o=[ca.a.topBar];return t&&o.push(ca.a.disabled),a&&r&&o.push(ca.a.hide),N("div",{className:o.join(" ")},N("div",{className:ca.a.topBarArea},N(zr,{name:"TopBar"})),e.children,N("div",{className:ca.a.leftControls},N(zr,{name:"TopBarLeftControls"},n)),N("div",{className:ca.a.rightControls},N(zr,{name:"TopBarRightControls"},i)))},a}(j))||Fc;function Gc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Hc.displayName="TopBar";var Wc,zc,qc,Yc=(jc=Xt((function(e){return{fallbackToMutedAutoPlay:e.engine.fallbackToMutedAutoPlay}}),null),Vc=Fr("UnmuteIndication"),jc($c=Aa($c=Ba($c=Vc($c=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Kc(Gc(t=e.call.apply(e,[this].concat(a))||this),"_iconTimeout",null),Kc(Gc(t),"onKeyDown",(function(e){e.keyCode===Rr.ENTER&&(t.props.player.muted=!t.props.player.muted)})),Kc(Gc(t),"onMouseOver",(function(){return t.setState({iconOnly:!1})})),Kc(Gc(t),"onMouseOut",(function(){return t.setState({iconOnly:!0})})),Kc(Gc(t),"onMouseUp",(function(){return t.props.player.muted=!t.props.player.muted})),Kc(Gc(t),"onTouchEnd",(function(e){return e.stopImmediatePropagation()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidUpdate=function(e){var t=this;!e.fallbackToMutedAutoPlay&&this.props.fallbackToMutedAutoPlay&&(this.props.eventManager.listenOnce(this.props.player,this.props.player.Event.PLAYING,(function(){return t._iconOnlyTimeout()})),this.props.eventManager.listenOnce(this.props.player,this.props.player.Event.AD_STARTED,(function(){return t._iconOnlyTimeout()})))},n.componentWillUnmount=function(){this._iconTimeout&&(clearTimeout(this._iconTimeout),this._iconTimeout=null)},n._iconOnlyTimeout=function(){var e=this;this._iconTimeout=setTimeout((function(){e.setState({iconOnly:!0})}),3e3)},n.render=function(e){if(this.props.fallbackToMutedAutoPlay){var t=[ca.a.unmuteButtonContainer];return e.hasTopBar&&t.push(ca.a.hasTopBar),this.state.iconOnly&&t.push(ca.a.showIconOnly),N(kr,null,N("div",{tabIndex:"0","aria-label":N(vr,{id:"controls.unmute"}),className:t.join(" "),onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd,onKeyDown:this.onKeyDown},N("a",{className:[ca.a.btn,ca.a.btnDarkTransparent,ca.a.unmuteButton].join(" ")},N("div",{className:ca.a.unmuteIconContainer},N(Eo,{type:mo.VolumeBase}),N(Eo,{type:mo.VolumeMute})),N("span",null,N(vr,{id:"unmute.unmute"})))))}},a}(j))||$c)||$c)||$c)||$c);Yc.displayName="UnmuteIndication";var Xc,Qc,Jc,Zc=(Wc=Xt((function(e){return{config:Object.assign({placement:"top-left",timeout:0},e.config.components.watermark)}})),zc=Fr("Watermark"),Wc(qc=Aa(qc=Ba(qc=zc(qc=function(e){var t,r;function a(){var t;return function(e,t,r){t in e?Object.defineProperty(e,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):e[t]=null}(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t=e.call(this)||this),"_timeoutId"),t.setState({show:!0}),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this,t=function(){e.props.config.timeout>0&&(e._timeoutId=setTimeout((function(){return e.setState({show:!1})}),e.props.config.timeout))},r=this.props.player;this.props.eventManager.listenOnce(r,r.Event.PLAYING,t),this.props.eventManager.listen(r,r.Event.CHANGE_SOURCE_ENDED,(function(){e.setState({show:!0}),e.props.eventManager.listenOnce(r,r.Event.PLAYING,t)}))},n.componentWillUnmount=function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},n.render=function(e){if(e.config.img){var t=[ca.a.watermark];return e.config.placement.split("-").forEach((function(e){t.push(ca.a[e])})),e.config.url||t.push(ca.a.emptyUrl),this.state.show||t.push(ca.a.hideWatermark),N("div",{className:t.join(" ")},N("a",{href:e.config.url,target:"_blank",rel:"noopener noreferrer"},N("img",{src:e.config.img})))}},a}(j))||qc)||qc)||qc)||qc);Zc.displayName="Watermark";var ed,td,rd,ad=(Xc=Xt((function(e){return{isMobile:e.shell.isMobile,playerSize:e.shell.playerSize,config:e.config.components.logo}})),Qc=Fr("Logo"),Xc(Jc=Aa(Jc=Qc(Jc=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n._shouldRender=function(){return!(0===Object.keys(this.props.config).length&&this.props.config.constructor===Object)},n.render=function(e){if(this._shouldRender()){var t=[En.TINY,En.EXTRA_SMALL,En.SMALL].includes(this.props.playerSize);return e.config.img&&!t?N("div",{className:[ca.a.controlButtonContainer,e.config.url?"":ca.a.emptyUrl].join(" "),"aria-label":N(vr,{id:"controls.logo"}),title:e.config.text},N("a",{className:ca.a.controlButton,href:e.config.url,target:"_blank",rel:"noopener noreferrer"},N("img",{className:ca.a.icon,src:e.config.img}))):void 0}},a}(j))||Jc)||Jc)||Jc);ad.displayName="Logo";var nd,id,od,sd,ld,ud=Xt((function(e){return{poster:e.engine.poster,castSession:e.engine.castSession,isIdle:e.engine.isIdle,isPlaying:e.engine.isPlaying,isPlaybackEnded:e.engine.isPlaybackEnded,isPaused:e.engine.isPaused,isChangingSource:e.engine.isChangingSource}}))(ed=Fr("CastOverlay")((rd=td=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.getStatus=function(){return this.props.isPlaying||this.props.isPaused?N(vr,{id:"cast.status.playing_on"}):this.props.isPlaybackEnded||this.props.isChangingSource||this.props.castSession.resuming?N(vr,{id:"cast.status.connected_to"}):N(vr,{id:"cast.status.connecting_to"})},n.getIcon=function(){return this.props.isPlaying||this.props.isPaused||this.props.isPlaybackEnded||this.props.isChangingSource||this.props.castSession.resuming?N(ko,{type:this.props.icon}):N("div",{className:ca.a.castConnectingSpinner})},n.render=function(e){if(e.castSession){var t={},r=[ca.a.castPoster];e.poster&&(t={backgroundImage:e.isChangingSource?"":"url("+e.poster+")",backgroundSize:"contain"},r.push(ca.a.hasPoster));var a=this.getStatus(),n=this.getIcon();return N("div",null,N("div",{className:ca.a.castOverlay},N("div",{className:r.join(" "),style:t,onMouseOver:function(e){return e.stopPropagation()}}),N("div",{className:ca.a.castBlackCover})),N("div",{className:ca.a.castBox},N("div",{className:ca.a.castIcon},n),N("div",{className:ca.a.castText},N(kr,null,N("span",{className:ca.a.castStatus},a)),N("br",null),N("span",{className:ca.a.castDevice},e.castSession.deviceFriendlyName))))}},a}(j),function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(td,"defaultProps",{icon:mo.Cast}),ed=rd))||ed)||ed;function cd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ud.displayName="CastOverlay";var pd,hd,fd,gd,yd,md=(nd=Xt((function(e){return{isPlaybackEnded:e.engine.isPlaybackEnded,prePlayback:e.engine.prePlayback,loading:e.loading.show,isCastAvailable:e.engine.isCastAvailable}})),id=Fr("CastBeforePlay"),nd(od=Aa(od=id((ld=sd=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return dd(cd(t=e.call.apply(e,[this].concat(a))||this),"_timeoutId",null),dd(cd(t),"onClick",(function(){t.props.player.startCasting(Bs)})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this;this._timeoutId=setTimeout((function(){e.setState({show:!0})}),700)},n.componentWillUnmount=function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},n.render=function(e){if(e.isCastAvailable&&!e.loading&&e.prePlayback){var t=[ca.a.castOnTvButtonContainer];return this.state.show&&t.push(ca.a.showCastOnTv),N("div",{className:t.join(" ")},N(kr,null,N(jo,{tabIndex:"0","aria-label":N(vr,{id:"cast.play_on_tv"}),onClick:this.onClick,className:[ca.a.btn,ca.a.btnDarkTransparent,ca.a.castOnTvButton].join(" ")},N("div",{className:ca.a.castOnTvIconContainer},N(ko,{type:e.icon})),N("span",null,N(vr,{id:"cast.play_on_tv"})))))}},a}(j),dd(sd,"defaultProps",{icon:mo.Cast}),od=ld))||od)||od)||od);function vd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}md.displayName="CastBeforePlay";var kd,Ed=(pd=Xt((function(e){return{isPlaybackEnded:e.engine.isPlaybackEnded,isCasting:e.engine.isCasting}}),null),hd=Fr("CastAfterPlay"),pd(fd=Aa(fd=hd((yd=gd=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return _d(vd(t=e.call.apply(e,[this].concat(a))||this),"_timeoutId",null),_d(vd(t),"onClick",(function(e){e.stopPropagation(),t.props.player.stopCasting()})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this;this._timeoutId=setTimeout((function(){e.setState({show:!0})}),700)},n.componentWillUnmount=function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},n.render=function(e){if(e.isCasting&&e.isPlaybackEnded){var t=[ca.a.castOnTvButtonContainer];return this.state.show&&t.push(ca.a.showCastOnTv),N("div",null,N("div",{className:t.join(" "),onClick:this.onClick},N("a",{className:[ca.a.btn,ca.a.btnDarkTransparent,ca.a.castOnTvButton].join(" ")},N("div",{className:ca.a.castOnTvIconContainer},N(ko,{type:e.icon})),N(kr,null,N("span",null,N(vr,{id:"cast.disconnect_from_tv"}))))))}},a}(j),_d(gd,"defaultProps",{icon:mo.CastBrand}),fd=yd))||fd)||fd)||fd);Ed.displayName="CastAfterPlay";var Td,bd=br({prevControlsText:"controls.prev",nextControlsText:"controls.next",playlistPrevText:"playlist.prev",playlistUpNextText:"playlist.up_next"})(kd=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){var t,r,a=e.type,n=e.item,i=e.onClick,o="next"===a?mo.Next:mo.Prev,s=e[e.type+"ControlsText"],l="prev"===a?this.props.playlistPrevText:this.props.playlistUpNextText,u=null==n||null==(t=n.sources)?void 0:t.poster,c=(null==n||null==(r=n.sources)?void 0:r.metadata)?n.sources.metadata.name:"",d=N(jo,{disabled:!n,tabIndex:"0","aria-label":s,className:""+ca.a.controlButton,onClick:i},N("div",null,N(Eo,{type:o})));return N("div",{className:[ca.a.controlButtonContainer,ca.a.controlPlaylistButton].join(" ")},e.showPreview&&(u||c)?N(B,null,N("div",{className:ca.a.posterPreview},u?N("div",{className:ca.a.posterPreviewImg,style:"background-image: url("+u+");"}):void 0,N("div",{className:ca.a.posterPreviewText},N("div",{className:ca.a.posterPreviewTextTitle},l),N("div",{className:ca.a.posterPreviewTextName},""+(c||"")))),d):N(Ro,{label:s},d))},a}(j))||kd;function Sd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ad(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Cd,Pd,wd,xd=Xt((function(e){return{playlist:e.engine.playlist}}))(Td=Aa(Td=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Ad(Sd(t=e.call.apply(e,[this].concat(a))||this),"onClick",(function(){"prev"===t.props.type?t.props.player.playlist.playPrev():t.props.player.playlist.playNext()})),t}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(e){var t=e.playlist[e.type];return N(bd,{type:e.type,item:t,onClick:this.onClick.bind(this),showPreview:e.showPreview})},a}(j))||Td)||Td;function Id(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Md(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}xd.displayName="PlaylistButton";var Dd,Rd,Od,Ld,Nd,Ud,Fd=(Cd=Xt((function(e){return{playlist:e.engine.playlist,isPlaybackEnded:e.engine.isPlaybackEnded}})),Pd=Fr("PlaylistNextScreen"),Cd(wd=Aa(wd=Pd(wd=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return Md(Id(t=e.call.apply(e,[this].concat(a))||this),"onPosterClick",(function(){t.props.player.playlist.playNext()})),Md(Id(t),"onKeyDown",(function(e){e.keyCode!==Rr.ENTER&&e.keyCode!==Rr.SPACE||(e.preventDefault(),t.onPosterClick())})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidUpdate=function(e){!this._shouldRender(e)&&this._shouldRender(this.props)&&this.focusElement&&this.focusElement.focus()},n._shouldRender=function(e){return!(!(e.playlist&&e.playlist.next&&e.playlist.next.sources&&e.isPlaybackEnded)||e.player.playlist.options.autoContinue)},n._getPosterUrl=function(){var e=this.props.playlist.next;return e.sources.poster?e.sources.poster.indexOf("entry_id/"+e.sources.id)>-1&&-1===e.sources.poster.indexOf("/width/")?e.sources.poster+"/width/384":e.sources.poster:""},n.render=function(e){var t=this;if(this._shouldRender(e)){var r=e.playlist.next;return N("div",{className:ca.a.playlistNextScreenOverlay},N("div",{className:ca.a.playlistNextScreenContent},N("div",{id:"playlistNextScreenTextId",className:ca.a.playlistNextScreenText},N(kr,null,N("div",{className:ca.a.playlistNextScreenTextTitle},N(vr,{id:"playlist.next"}))),N("div",{className:ca.a.playlistNextScreenTextName},""+(r.sources.metadata?r.sources.metadata.name:""))),N("div",{className:ca.a.playlistNextScreenPosterPlaceholder},N("div",{className:ca.a.playlistNextScreenPosterAspectRatio},N("div",{role:"button","aria-labelledby":"playlistNextScreenTextId",ref:function(e){return e?t.focusElement=e:void 0},tabIndex:"0",className:ca.a.playlistNextScreenPoster,onClick:this.onPosterClick,onKeyDown:this.onKeyDown},N("div",{className:ca.a.playlistNextScreenPosterImg,style:"background-image: url("+this._getPosterUrl()+");"}),N(Eo,{type:mo.Play}))))))}},a}(j))||wd)||wd)||wd);function Bd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Fd.displayName="PlaylistNextScreen";var Vd,$d=(Dd=Xt((function(e){return{isPictureInPictureSupported:e.engine.isPictureInPictureSupported,isInPictureInPicture:e.engine.isInPictureInPicture,playerSize:e.shell.playerSize}}),la(oa)),Rd=Fs("PictureInPicture"),Od=Fr("PictureInPicture"),Ld=hn("PictureInPicture"),Nd=br({pictureInPictureText:"controls.pictureInPicture",pictureInPictureExitText:"controls.pictureInPictureExit",pictureInPictureExpandText:"controls.pictureInPictureExpand"}),Dd(Ud=Aa(Ud=Rd(Ud=Od(Ud=Ld(Ud=Nd(Ud=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return jd(Bd(t=e.call.apply(e,[this].concat(a))||this),"_keyboardEventHandlers",[{key:{code:Rr.P},action:function(){t.togglePip(),t.props.updatePlayerHoverState(!0)}}]),jd(Bd(t),"togglePip",(function(){var e=t.props.player;e.isInPictureInPicture()?(t.props.logger.debug("Exit Picture In Picture"),t.props.notifyClick(),e.exitPictureInPicture()):(t.props.logger.debug("Enter Picture In Picture"),t.props.notifyClick(),e.enterPictureInPicture())})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){this.props.registerKeyboardEvents(this._keyboardEventHandlers)},n.render=function(){if(this.props.isPictureInPictureSupported&&this.props.playerSize!==En.EXTRA_SMALL)return N(ts,{name:"PictureInPicture"},N(Ro,{label:this.props.isInPictureInPicture?this.props.pictureInPictureExpandText:this.props.pictureInPictureText},N(jo,{tabIndex:"0","aria-label":this.props.isInPictureInPicture?this.props.pictureInPictureExitText:this.props.pictureInPictureText,className:this.props.isInPictureInPicture?[ca.a.controlButton,ca.a.isInPictureInPicture].join(" "):ca.a.controlButton,onClick:this.togglePip},N(Eo,{type:mo.PictureInPictureStart}),N(Eo,{type:mo.PictureInPictureStop}))))},a}(j))||Ud)||Ud)||Ud)||Ud)||Ud)||Ud);$d.displayName="PictureInPicture";var Hd,Gd=Xt((function(e){return{playlist:e.engine.playlist}}))(Vd=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){this.setState({shouldUpdate:!1})},n.componentDidUpdate=function(e){!!e.playlist!=!!this.props.playlist&&this.setState({shouldUpdate:!0})},n.render=function(e){var t=e.name,r=e.className,a=this.state.shouldUpdate;return a&&this.setState({shouldUpdate:!1}),N("div",{className:[ca.a.playbackControls,r].join(" ")},N(zr,{name:t,shouldUpdate:a},e.playlist?N(B,null,N(xd,{type:"prev",showPreview:e.showPreview}),N(hu,null),N(xd,{type:"next",showPreview:e.showPreview})):N(hu,null)))},a}(j))||Vd;Gd.displayName="PlaybackControls";var Kd,Wd,zd,qd,Yd,Xd,Qd,Jd=Xt((function(e){return{videoStyles:e.shell.layoutStyles.video}}))(Hd=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.shouldComponentUpdate=function(e){return e.videoStyles!==this.props.videoStyles},n.render=function(){var e=this.props,t=e.videoStyles,r=e.children;return N("div",{style:t,className:ca.a.videoArea},N("div",{style:{pointerEvents:"auto"}},N(zr,{name:"VideoArea"},r)))},a}(j))||Hd,Zd=Aa(Kd=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.shouldComponentUpdate=function(){return!1},n.render=function(){var e=this.props.children;return N("div",{className:ca.a.interactiveArea},N("div",{style:{pointerEvents:"auto"}},N(zr,{name:"InteractiveArea"},e)))},a}(j))||Kd,ep=(Wd=Xt((function(e){return{duration:e.engine.duration}})),Aa(zd=Wd(zd=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n._getFramePreviewImgStyle=function(e){return"background: url("+e.url+");background-position: -"+e.x+"px -"+e.y+"px;"},n._getFramePreviewImgContainerStyle=function(e){return{height:e.height+4+"px",width:e.width+4+"px"}},n.render=function(){var e=this.props.player.getThumbnail(this.props.virtualTime);if(e)return N("div",{style:this._getFramePreviewImgContainerStyle(e),className:[ca.a.framePreviewImgContainer,ca.a.nonSticky].join(" ")},N("div",{className:ca.a.framePreviewImg,style:this._getFramePreviewImgStyle(e)}))},a}(j))||zd)||zd);function tp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ap(){return(ap=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}ep.displayName="SeekBarPreview";var np,ip,op,sp,lp=(qd=Xt((function(e){return{config:e.config.components.seekbar,isMobile:e.shell.isMobile,previewHoverActive:e.seekbar.previewHoverActive,hidePreview:e.seekbar.hidePreview,hideTimeBubble:e.seekbar.hideTimeBubble}}),la(ap({},oa,pi))),Yd=Fs("SeekBar"),Xd=br({sliderAriaLabel:"controls.seekBarSlider"}),qd(Qd=Aa(Qd=Ba(Qd=Yd(Qd=Xd(Qd=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return rp(tp(t=e.call.apply(e,[this].concat(a))||this),"_keyboardEventHandlers",[{key:{code:Rr.LEFT},action:function(e){t.handleKeydown(e,!1)}},{key:{code:Rr.RIGHT},action:function(e){t.handleKeydown(e,!1)}},{key:{code:Rr.HOME},action:function(e){t.handleKeydown(e,!1)}},{key:{code:Rr.END},action:function(e){t.handleKeydown(e,!1)}}]),rp(tp(t),"onSeekbarMouseDown",(function(e){if(!t.props.isMobile&&!t.props.previewHoverActive&&(e.preventDefault(),e.stopPropagation(),t.props.updateSeekbarDraggingStatus(!0),t.props.isDraggingActive)){var r=t.getTime(e);t.updateSeekBarProgress(r,t.props.duration)}})),rp(tp(t),"onPlayerMouseUp",(function(e){if(!t.props.isMobile&&!t.props.previewHoverActive&&t.props.isDraggingActive){var r=t.props.currentTime,a=t.getTime(e);t.props.changeCurrentTime(a),t.updateSeekBarProgress(a,t.props.duration),t.props.updateSeekbarDraggingStatus(!1),t.props.notifyChange({from:r,to:a})}})),rp(tp(t),"onPlayerMouseMove",(function(e){if(!t.props.isMobile&&t.props.isDraggingActive){var r=t.getTime(e);t.updateSeekBarProgress(r,t.props.duration),t.updateSeekBarProgress(r,t.props.duration,!0)}})),rp(tp(t),"onSeekbarMouseMove",(function(e){if(!t.props.isMobile&&!t.props.previewHoverActive){var r=t.getTime(e);t.updateSeekBarProgress(r,t.props.duration,!0)}})),rp(tp(t),"onSeekbarTouchStart",(function(e){if(t.props.updateSeekbarDraggingStatus(!0),t.props.isDraggingActive){var r=t.getTime(e);t.updateSeekBarProgress(r,t.props.duration)}})),rp(tp(t),"onSeekbarTouchMove",(function(e){var r=t.getTime(e);t.updateSeekBarProgress(r,t.props.duration,!0),t.props.isDraggingActive&&t.updateSeekBarProgress(r,t.props.duration),e.preventDefault()})),rp(tp(t),"onKeyDown",(function(e){switch(e.keyCode){case Rr.LEFT:case Rr.RIGHT:t.handleKeydown(e,!0);break;case Rr.ENTER:case Rr.SPACE:e.preventDefault(),t.togglePlayPause()}})),rp(tp(t),"togglePlayPause",(function(){t.props.player.paused?t.props.player.play():t.props.player.pause()})),rp(tp(t),"onSeekbarTouchEnd",(function(e){if(t.props.isDraggingActive){var r=t.getTime(e),a=t.props.currentTime,n=r;t.props.changeCurrentTime(n),t.updateSeekBarProgress(n,t.props.duration),t.props.notifyChange({from:a,to:n})}t.props.updateSeekbarDraggingStatus(!1)})),rp(tp(t),"onSeekbarMouseOver",(function(){t.props.isMobile||t.props.updateSeekbarHoverActive(!0)})),rp(tp(t),"onSeekbarMouseLeave",(function(){t.props.isMobile||t.props.updateSeekbarHoverActive(!1)})),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this,t=this.props,r=t.player,a=t.eventManager,n=this._seekBarElement.getBoundingClientRect();this.props.updateSeekbarClientRect(n),a.listen(r,Ia.Type.GUI_RESIZE,(function(){e.setState({resizing:!0}),setTimeout((function(){var t=e._seekBarElement.getBoundingClientRect();e.props.updateSeekbarClientRect(t),e.setState({resizing:!1})}),ca.a.defaultTransitionTime)})),document.addEventListener("mouseup",this.onPlayerMouseUp),document.addEventListener("mousemove",this.onPlayerMouseMove),this.props.registerKeyboardEvents(this._keyboardEventHandlers)},n.componentWillUnmount=function(){document.removeEventListener("mouseup",this.onPlayerMouseUp),document.removeEventListener("mousemove",this.onPlayerMouseMove)},n.handleKeydown=function(e,t){var r=this,a=this.props,n=a.duration,i=a.currentTime,o=function(e,t){r.props.changeCurrentTime(t),r.updateSeekBarProgress(t,n,!0),r.props.notifyChange({from:e,to:t})};switch(this.props.updatePlayerHoverState(!0),e.keyCode){case Rr.LEFT:t||this.props.updateOverlayActionIcon(mo.Rewind),o(i,i-5>0?i-5:0);break;case Rr.RIGHT:t||this.props.updateOverlayActionIcon(mo.Forward),o(i,i+5>n?n:i+5);break;case Rr.HOME:t||this.props.updateOverlayActionIcon(mo.StartOver),o(i,0);break;case Rr.END:t||this.props.updateOverlayActionIcon(mo.SeekEnd),o(i,n)}},n.updateSeekBarProgress=function(e,t,r){void 0===r&&(r=!1),r?this.props.updateVirtualTime(e):this.props.updateCurrentTime(e)},n.getOffset=function(e){for(var t=0,r=0;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft-e.scrollLeft+this._getTransformX(e),r+=e.offsetTop-e.scrollTop,e=e.offsetParent;return this.props.player.isFullscreen()&&(t=0),{top:r,left:t}},n._getTransformX=function(e){var t=getComputedStyle(e),r=(t.getPropertyValue("transform")||t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")).match(/-?\d+/g),a=0;return r&&r.length>0&&(a=parseFloat(r[4])),a},n.getTime=function(e){var t,r=("number"==typeof e.clientX?e.clientX:null==e||null==(t=e.changedTouches[0])?void 0:t.clientX)-this._seekBarElement.getBoundingClientRect().left,a=parseFloat((this.props.duration/this._seekBarElement.offsetWidth*r).toFixed(2));return a<0?0:a>this.props.duration?this.props.duration:a},n.getBufferedPercent=function(){var e=this.props.player;if(this.props.duration>0&&e.buffered.length>0){var t=(e.isLive()?e.buffered.end(0)-e.getStartTimeOfDvrWindow():e.buffered.end(0))/this.props.duration*100;return t<100?t:100}return 0},n.getFramePreviewOffset=function(){if(this._seekBarElement&&this._framePreviewElement){var e=this.props.virtualTime/this.props.duration*this._seekBarElement.clientWidth-this._framePreviewElement.clientWidth/2;return e<0?0:e>this._seekBarElement.clientWidth-this._framePreviewElement.clientWidth?this._seekBarElement.clientWidth-this._framePreviewElement.clientWidth:e}return 0},n.getTimeBubbleOffset=function(){if(this._timeBubbleElement){var e=this.props.virtualTime/this.props.duration*this._seekBarElement.clientWidth-this._timeBubbleElement.clientWidth/2;return e<0?0:e>this._seekBarElement.clientWidth-this._timeBubbleElement.clientWidth?this._seekBarElement.clientWidth-this._timeBubbleElement.clientWidth:e}return 0},n.renderFramePreview=function(){var e=this;if(this.props.showFramePreview&&!this.props.isMobile)return N("div",{className:this.props.hidePreview?[ca.a.framePreview,ca.a.hideFramePreview].join(" "):ca.a.framePreview,style:this._getFramePreviewStyle(),ref:function(t){return t?e._framePreviewElement=t:void 0}},N(ep,{virtualTime:this.props.virtualTime}))},n._getFramePreviewStyle=function(){return"left: "+this.getFramePreviewOffset()+"px;"},n.renderTimeBubble=function(){var e=this;if(!this.props.hideTimeBubble&&this.props.showTimeBubble&&!this.props.isMobile){var t="left: "+this.getTimeBubbleOffset()+"px",r=this.props.isDvr?"-"+$i(this.props.duration-this.props.virtualTime):$i(this.props.virtualTime);return N("div",{className:ca.a.timePreview,style:t,ref:function(t){return t?e._timeBubbleElement=t:void 0}},r)}},n.render=function(e,t){var r=this,a=e.virtualTime/e.duration*100+"%",n=(e.forceFullProgress?100:e.currentTime/e.duration*100)+"%",i=Math.round(this.getBufferedPercent())+"%",o=[ca.a.seekBar];return e.adBreak&&o.push(ca.a.adBreak),e.isDvr&&o.push(ca.a.live),e.isMobile&&o.push(ca.a.hover),e.isDraggingActive&&o.push(ca.a.hover),t.resizing&&o.push(ca.a.resizing),N("div",{tabIndex:"0",className:o.join(" "),ref:function(e){return e?r._seekBarElement=e:void 0},role:"slider","aria-label":e.sliderAriaLabel,"aria-valuemin":"0","aria-valuemax":Math.round(this.props.duration),"aria-valuenow":Math.round(this.props.currentTime),"aria-valuetext":$i(this.props.currentTime)+" of "+$i(this.props.duration),onMouseOver:this.onSeekbarMouseOver,onMouseLeave:this.onSeekbarMouseLeave,onMouseMove:this.onSeekbarMouseMove,onMouseDown:this.onSeekbarMouseDown,onTouchStart:this.onSeekbarTouchStart,onTouchMove:this.onSeekbarTouchMove,onTouchEnd:this.onSeekbarTouchEnd,onKeyDown:this.onKeyDown},N("div",{className:ca.a.progressBar},N(zr,{name:"SeekBar",shouldUpdate:!0},this.renderFramePreview(),this.renderTimeBubble(),N("div",{className:ca.a.buffered,style:{width:i}}),e.dataLoaded?N("div",{className:ca.a.progress,style:{width:n}},e.adBreak?void 0:N("a",{className:ca.a.scrubber})):void 0,N("div",{className:ca.a.virtualProgress,style:{width:a}},N("div",{className:ca.a.virtualProgressIndicator})))))},a}(j))||Qd)||Qd)||Qd)||Qd)||Qd);lp.displayName="SeekBar";var up,cp,dp,pp=(np=Xt((function(e){return{currentTime:e.seekbar.currentTime,virtualTime:e.seekbar.virtualTime,duration:e.engine.duration,isDraggingActive:e.seekbar.draggingActive,isMobile:e.shell.isMobile,poster:e.engine.poster,dataLoaded:e.engine.dataLoaded}}),la(Vn)),ip=Fr("SeekBarPlaybackContainer"),op=hn("SeekBarPlaybackContainer"),np(sp=Aa(sp=Ba(sp=ip(sp=op(sp=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){var e=this;this.props.eventManager.listen(this.props.player,this.props.player.Event.TIME_UPDATE,(function(){e.props.isDraggingActive||e.props.updateCurrentTime(e.props.player.currentTime)}))},n.render=function(){var e=this;return N(lp,{playerElement:this.props.playerContainer,showFramePreview:this.props.showFramePreview,showTimeBubble:this.props.showTimeBubble,changeCurrentTime:function(t){return e.props.player.currentTime=t},playerPoster:this.props.poster,updateSeekbarDraggingStatus:function(t){return e.props.updateSeekbarDraggingStatus(t)},updateSeekbarHoverActive:function(t){return e.props.updateSeekbarHoverActive(t)},updateSeekbarClientRect:function(t){return e.props.updateSeekbarClientRect(t)},updateCurrentTime:function(t){return e.props.updateCurrentTime(t)},updateVirtualTime:function(t){return e.props.updateVirtualTime(t)},currentTime:this.props.currentTime,virtualTime:this.props.virtualTime,duration:this.props.duration,isDraggingActive:this.props.isDraggingActive,isMobile:this.props.isMobile,notifyChange:function(t){return e.props.notifyChange(t)},dataLoaded:this.props.dataLoaded})},a}(j))||sp)||sp)||sp)||sp)||sp);function hp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}pp.displayName="SeekBarPlaybackContainer";var gp,yp,mp,vp=(up=Xt((function(e){return{playlist:e.engine.playlist,currentTime:e.engine.currentTime,duration:e.engine.duration,lastSeekPoint:e.engine.lastSeekPoint,isSeeking:e.engine.isSeeking,isPlaybackEnded:e.engine.isPlaybackEnded,countdownCanceled:e.playlist.countdownCanceled}}),la(mi)),cp=Fr("PlaylistCountdown"),up(dp=Aa(dp=Ba(dp=cp(dp=function(e){var t,r;function a(t){var r;return fp(hp(r=e.call(this,t)||this),"onClick",(function(){r.props.player.playlist.playNext()})),fp(hp(r),"cancelNext",(function(e){r.props.logger.debug("Cancel auto play next item"),e.stopPropagation(),r.props.updatePlaylistCountdownCanceled(!0)})),fp(hp(r),"onKeyDown",(function(e){switch(e.keyCode){case Rr.ENTER:r.onClick();break;case Rr.ESC:r.cancelNext(e)}})),fp(hp(r),"onCancelButtonKeyDown",(function(e){e.keyCode===Rr.ENTER&&r.cancelNext(e)})),r.setState({focusable:!1}),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n._shouldRender=function(e){return this.state.timeToShow&&e.playlist&&e.playlist.next&&e.playlist.next.sources&&e.player.playlist.countdown.showing&&(e.player.playlist.options.autoContinue||e.player.playlist.options.loop)},n._getTimeToShow=function(){var e=this.props.player.playlist.countdown,t=this.props.duration-e.duration;return e.timeToShow>=0&&e.timeToShow<=this.props.duration&&(t=Math.max(e.timeToShow,this.props.lastSeekPoint)),Math.max(0,Math.min(t,this.props.duration))},n.componentWillUpdate=function(e){var t=this._getTimeToShow();e.currentTime>=t?this.setState({timeToShow:!0}):(this.setState({timeToShow:!1}),this.props.updatePlaylistCountdownCanceled(!1))},n.isHidden=function(e){return!e.timeToShow||this.props.player.playlist.countdown.duration>=this.props.duration},n.isCanceled=function(){return this.props.countdownCanceled},n.isShown=function(e){return!this.isHidden(e)&&!this.isCanceled()},n.componentDidUpdate=function(e,t){var r=this;if(this._shouldRender(e)){var a=this._getTimeToShow(),n=this.props.player.playlist.countdown;e.isSeeking||this.props.countdownCanceled||!(this.props.isPlaybackEnded||this.props.currentTime>=a+n.duration&&this.props.currentTime<this.props.duration)||this.props.player.playlist.playNext()}!t.shown&&this.state.shown?this.focusElement&&this.props.eventManager.listenOnce(this.focusElement,"animationend",(function(){r.isShown(r.state)&&(r.focusElement.focus(),r.setState({focusable:!0}))})):t.shown&&!this.state.shown&&this.setState({focusable:!1}),this.isShown(this.state)!==this.state.shown&&this.setState((function(e){return{shown:r.isShown(e)}}))},n.shouldComponentUpdate=function(e){return this.props.duration>0&&!e.isSeeking&&!this.props.isPlaybackEnded},n.render=function(e){var t=this;if(this._shouldRender(e)&&(this.isShown(this.state)&&(this.nextShown=e.playlist.next),e.playlist.next&&e.playlist.next.sources&&this.nextShown)){var r=this.props.player.playlist.countdown,a=this._getTimeToShow(),n=e.currentTime-a,i=Math.min(r.duration,e.duration-a),o=Math.ceil(i-(n>0?n:0)),s=[ca.a.playlistCountdown];return this.isHidden(this.state)?s.push(ca.a.hidden):this.isCanceled()?s.push(ca.a.canceled):s.push(ca.a.slideIn),N("div",{role:"button","aria-labelledby":"playlistCountdownTextId",ref:function(e){return e?t.focusElement=e:void 0},tabIndex:this.state.focusable?0:-1,className:s.join(" "),onKeyDown:this.onKeyDown,onClick:this.onClick},N("div",{className:ca.a.playlistCountdownPoster,style:"background-image: url("+this.nextShown.sources.poster+");"}),N("div",{className:ca.a.playlistCountdownContentPlaceholder},N("div",{className:ca.a.playlistCountdownContentBackground},N("div",{className:ca.a.playlistCountdownContent},N(kr,null,N("div",{id:"playlistCountdownTextId",className:ca.a.playlistCountdownText},N("div",{className:ca.a.playlistCountdownTextTitle},N(vr,{id:"playlist.up_next_in"}),N("div",{className:ca.a.playlistCountdownTimeLeft},o)),N("div",{className:ca.a.playlistCountdownTextName},""+(this.nextShown.sources.metadata?this.nextShown.sources.metadata.name:"")))),N("div",{className:[ca.a.controlButtonContainer,ca.a.playlistCountdownCancel].join(" ")},N(kr,null,N(jo,{tabIndex:this.state.focusable?0:-1,"aria-label":N(vr,{id:"playlist.cancel"}),className:[ca.a.controlButton,ca.a.playlistCountdownCancelButton].join(" "),onClick:this.cancelNext,onKeyDown:this.onCancelButtonKeyDown},N(Eo,{type:mo.Close}))))))))}},a}(j))||dp)||dp)||dp)||dp);vp.displayName="PlaylistCountdown";var _p,kp=(gp=Xt((function(e){return{poster:e.engine.poster,isInPictureInPicture:e.engine.isInPictureInPicture,isChangingSource:e.engine.isChangingSource}})),yp=Fr("PictureInPictureOverlay"),gp(mp=Aa(mp=yp(mp=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n._handleClick=function(){this.props.player.exitPictureInPicture()},n.render=function(){if(this.props.isInPictureInPicture){var e={},t=[ca.a.pictureInPicturePoster];return this.props.poster&&(e={backgroundImage:this.props.isChangingSource?"":"url("+this.props.poster+")",backgroundSize:"contain"},t.push(ca.a.hasPoster)),N("div",null,N("div",{className:ca.a.pictureInPictureOverlay},N("div",{className:t.join(" "),style:e,onMouseOver:function(e){return e.stopPropagation()}},N("div",{className:ca.a.darkLayer})),N("div",{className:ca.a.pictureInPictureControl},N(kr,null,N("span",{className:ca.a.pictureInPictureText},N(vr,{id:"pictureInPicture.overlay_text"}))))))}},a}(j))||mp)||mp)||mp);kp.displayName="PictureInPictureOverlay";var Ep,Tp=Nn({allowSidePanels:!0,allowPlayerArea:!0})(_p=Fs("Playback")(_p=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){this.props.updateIsKeyboardEnabled(!0)},n.render=function(){return N("div",{className:ca.a.playbackGuiWrapper},N(zr,{name:"PresetArea"},N("div",{className:ca.a.playerGui,id:"player-gui"},N(xo,null),N(Jd,null),N(oo,null,N(B,null,N(Yc,null),N(ro,null),N(xc,null),N(kp,null),N(Gd,{name:"OverlayPlaybackControls",className:ca.a.centerPlaybackControls}),N(Fd,null),N(Ho,null),N(md,null)),(function(e){var t=e.containerRef;return N(B,null,N(Hc,null),N(Zd,null,N(Zc,null),N(vp,null)),N(sc,{leftControls:N(B,null,N(Gd,{name:"BottomBarPlaybackControls",showPreview:!0}),N(ds,{step:10}),N(vs,{step:10}),N(Bc,{format:"current / total"})),rightControls:N(B,null,N(Nu,null),N(Du,null),N(Fu,null),N(ru,null),N(Su,null),N(qs,null),N($d,null),N(Js,null),N(ad,null))},N(pp,{showFramePreview:!0,showTimeBubble:!0,playerContainer:t})))})))))},a}(j))||_p)||_p;function bp(e){return N(Tp,e)}Tp.displayName="Playback";var Sp=Xt((function(e){return{isBumper:e.engine.adIsBumper}}))(Ep=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(){return this.props.isBumper?null:N(Wu,null)},a}(j))||Ep;Sp.displayName="AdLeftControls";var Ap,Cp=Xt((function(e){return{state:{shell:e.shell,engine:{adIsLinear:e.engine.adIsLinear,adContentType:e.engine.adContentType}}}}))(Fs("Ads")((function(e,t){if(e.updateIsKeyboardEnabled(!0),function(e,t){var r=e.state.shell.isMobile&&!t.player.env.isIPadOS,a=!1;try{var n=t.player.config.plugins.ima.adsRenderingSettings;a=n&&n.useStyledLinearAds}catch(e){}return r||a}(e,t))return N("div",{className:ca.a.adGuiWrapper},N(zr,{name:"PresetArea"},N("div",{className:ca.a.playerGui,id:"player-gui"},N(oo,null,N(B,null,N(ro,null),N(Yc,{hasTopBar:!0})),N(B,null,N(Hc,{disabled:!0,leftControls:N(Sp,null)}))))));var r=!1,a=!1,n=N(sc,{leftControls:N(B,null,N(Gd,{name:"BottomBarPlaybackControls",showPreview:!0}),N(Nc,null)),rightControls:N(B,null,N(Du,null),N(Js,null))}),i=N(sc,{rightControls:N(B,null,N(Js,null))});return N("div",{className:ca.a.adGuiWrapper},N(zr,{name:"PresetArea"},N("div",{className:ca.a.playerGui,id:"player-gui"},N(oo,null,N(B,null,N(ro,null),N(Yc,{hasTopBar:!0}),a?N(Ku,null):void 0,N(Gd,{name:"OverlayPlaybackControls",className:ca.a.centerPlaybackControls})),N(B,null,N(Hc,{disabled:!0,leftControls:N(Sp,null),rightControls:r?N($u,null):void 0}),function(e){var t=e.state.engine,r=t.adIsLinear,a=t.adContentType;return!(r&&a&&!a.startsWith("video"))}(e)?n:i)))))})));function Pp(e){return N(Cp,e)}function wp(){return N("div",{className:ca.a.playbackGuiWrapper},N(zr,{name:"PresetArea"},N(oo,null,N(B,null,N(Ec,null)))))}function xp(e){return N(wp,e)}Cp.displayName="Ads",wp.displayName="Error";var Ip,Mp=Nn({allowSidePanels:!0,allowPlayerArea:!0})(Ap=Fs("Live")(Ap=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){this.props.updateIsKeyboardEnabled(!0)},n.render=function(){return N("div",{className:ca.a.playbackGuiWrapper},N(zr,{name:"PresetArea"},N("div",{className:ca.a.playerGui,id:"player-gui"},N(xo,null),N(Jd,null),N(oo,null,N(B,null,N(ro,null),N(xc,null),N(kp,null),N(Gd,{name:"OverlayPlaybackControls",className:ca.a.centerPlaybackControls}),N(Ho,null),N(md,null)),(function(e){var t=e.containerRef;return N(B,null,N(Hc,null),N(Zd,null,N(Zc,null),N(Yc,null)),N(sc,{leftControls:N(B,null,N(Gd,{name:"BottomBarPlaybackControls",showPreview:!0}),N(ds,{step:10}),N(vs,{step:10}),N(Sc,null)),rightControls:N(B,null,N(Nu,null),N(Du,null),N(Fu,null),N(ru,null),N(Su,null),N(qs,null),N($d,null),N(Js,null),N(ad,null))},N(Mc,{showFramePreview:!0,showTimeBubble:!0,playerContainer:t})))})))))},a}(j))||Ap)||Ap;function Dp(e){return N(Mp,e)}Mp.displayName="Live";var Rp,Op=Nn({allowSidePanels:!0,allowPlayerArea:!0})(Ip=Fs("Img")(Ip=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.componentDidMount=function(){this.props.updateIsKeyboardEnabled(!0)},n.render=function(){return N("div",{className:ca.a.playbackGuiWrapper},N(zr,{name:"PresetArea"},N("div",{className:ca.a.playerGui,id:"player-gui"},N(Jd,null),N(oo,null,N(B,null,N(Yc,null),N(ro,null),N(xc,null),N(Gd,{name:"OverlayPlaybackControls",className:ca.a.centerPlaybackControls}),N(md,null)),(function(){return N(B,null,N(Hc,null),N(Zd,null,N(Zc,null)),N(sc,{rightControls:N(B,null,N(Nu,null),N(qs,null),N(Js,null),N(ad,null))}))})))))},a}(j))||Ip)||Ip;function Lp(e){return N(Op,e)}Op.displayName="Img";var Np=function(e,t){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),a=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},n={getState:r.getState,dispatch:function(){return a.apply(void 0,arguments)}},i=t.map((function(e){return e(n)}));return Nt({},r,{dispatch:a=Ut.apply(void 0,i)(r.dispatch)})}}}(function(e){return function(t){return function(t){return function(r){Rp||(Rp=Ir("UILoggerMiddleware")),e.debugActions&&Rp.debug("Action fired",r),t(r)}}}}(t),function(e){return function(t){return function(r){return function(a){switch(a.type){case Qu:!function(e,t,r){switch(t.name){case"Keyboard":ac[t.payload.key](e,t,r);break;case"OverlayAction":!function(e,t,r){"PlayPause"===t.payload.type?Zu(e,0,r):"Fullscreen"===t.payload.type&&tc(0,0,r)}(e,t,r);break;case"Settings":!function(e,t,r){t.payload.type===r.Track.VIDEO?r.dispatchEvent(new Ha(t.payload.track)):r.dispatchEvent(new Ka(t.payload.speed))}(0,t,r);break;case"CVAAOverlay":r.dispatchEvent(new $a(t.payload.textStyle));break;case"Fullscreen":tc(0,0,r);break;case"Language":!function(e,t,r){t.payload.type===r.Track.AUDIO?r.dispatchEvent(new ja(t.payload.track)):t.payload.type===r.Track.TEXT&&r.dispatchEvent(new Va(t.payload.track))}(0,t,r);break;case"Shell":r.dispatchEvent(new Ia(Ia.Type.UI_CLICKED));break;case"Rewind":r.dispatchEvent(new za(t.payload.from,t.payload.to));break;case"Forward":r.dispatchEvent(new qa(t.payload.from,t.payload.to));break;case"LiveTag":r.dispatchEvent(new Ia(Ia.Type.USER_CLICKED_LIVE_TAG));break;case"PrePlaybackPlayOverlay":case"PlayPause":Zu(e,0,r);break;case"Volume":ec(e,0,r)}}(t,a,e);break;case Ju:!function(e,t,r){switch(t.name){case"Volume":r.dispatchEvent(new Ya(t.payload.volume));break;case"SeekBarPlaybackContainer":r.dispatchEvent(new Ga(t.payload.from,t.payload.to));break;case"ActivePreset":r.dispatchEvent(new Ia(Ia.Type.UI_PRESET_CHANGE,t.payload))}}(0,a,e);break;case Xr.UPDATE_PLAYER_HOVER_STATE:!function(e,t,r){var a=e.getState().engine,n=e.getState().shell;!a.adBreak&&a.isPlaying&&n.playerHover!==t.hover&&r.dispatchEvent(new Wa(t.hover))}(t,a,e)}switch(r(a),a.type){case Xr.UPDATE_GUI_CLIENT_RECT:!function(e,t,r){var a=e.getState().shell.guiClientRect;r.dispatchEvent(new Yu(a))}(t,0,e);break;case Xr.UPDATE_PLAYER_CLIENT_RECT:!function(e,t,r){var a=e.getState().shell.playerClientRect;r.dispatchEvent(new qu(a))}(t,0,e);break;case Xr.UPDATE_VIDEO_CLIENT_RECT:!function(e,t,r){var a=e.getState().shell.videoClientRect;r.dispatchEvent(new Xu(a))}(t,0,e)}}}}}(e))};function Up(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Fp={colors:{live:"--playkit-live-color",playerBackground:"--playkit-player-background-color"}},Bp=["primary","secondary","success","danger","warning"],jp=["--playkit-icon-data-url","--playkit-icon-chromecast-url","--playkit-icon-quality-HD-active-url","--playkit-icon-quality-4K-active-url","--playkit-icon-quality-8K-active-url"],Vp=function(){function e(e,t){this.player=e,this.config=t}var t=e.prototype;return t.applyUserTheme=function(){this.config&&this.setColors(this.config)},t.setColors=function(e){for(var t in e.colors.primary&&this.setSvgFillColor(e.colors.primary),e.colors)Bp.includes(t)?this.setAccentOrAcknowledgementColor(t,e.colors[t]):this.setColor(Fp.colors[t],e.colors[t])},t.setAccentOrAcknowledgementColor=function(e,t){var r,a,n,i,o=function(e){return function(e){var t,r=e[0]/255,a=e[1]/255,n=e[2]/255,i=Math.min(r,a,n),o=Math.max(r,a,n),s=o-i;o===i?t=0:r===o?t=(a-n)/s:a===o?t=2+(n-r)/s:n===o&&(t=4+(r-a)/s),(t=Math.min(60*t,360))<0&&(t+=360);var l=(i+o)/2;return[t,100*(o===i?0:l<=.5?s/(o+i):s/(2-o-i)),100*l]}(function(e){var t=e.toString().match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var r=t[0];3===t[0].length&&(r=r.split("").map((function(e){return e+e})).join(""));var a=parseInt(r,16);return[a>>16&255,a>>8&255,255&a]}(e))}(t),s=o[0],l=o[1],u=o[2];null==(r=document.querySelector("."+ca.a.player))||r.style.setProperty("--playkit-{name}-color".replace("{name}",e),t),null==(a=document.querySelector("."+ca.a.player))||a.style.setProperty("--playkit-{name}-hsl-hue".replace("{name}",e),Math.round(s)+"deg"),null==(n=document.querySelector("."+ca.a.player))||n.style.setProperty("--playkit-{name}-hsl-saturation".replace("{name}",e),Math.round(l)+"%"),null==(i=document.querySelector("."+ca.a.player))||i.style.setProperty("--playkit-{name}-hsl-lightness".replace("{name}",e),Math.round(u)+"%")},t.setColor=function(e,t){var r;null==(r=document.querySelector("."+ca.a.player))||r.style.setProperty(e,t)},t.setSvgFillColor=function(e){for(var t,r=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Up(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Up(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(jp);!(t=r()).done;){var a,n,i=t.value,o=null==(a=getComputedStyle(document.querySelector("."+ca.a.player)))?void 0:a.getPropertyValue(i),s=e.replace("#","%23");null==(n=document.querySelector("."+ca.a.player))||n.style.setProperty(i,o.replace(/fill='%23([a-f0-9]{3}){1,2}\b'/,"fill='"+s+"'"))}},e}();function $p(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Hp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Gp=function(){function e(e,t){var r,a;Hp(this,"_translations",{en:Pi.en}),Hp(this,"_locale","en"),(r=t.logger)&&"function"==typeof r.getLogger&&(Pr.get=r.getLogger),r&&r.LogLevel&&(wr=r.LogLevel),this._uiComponents=[].concat(t.uiComponents||[]),this.player=e,this.targetId=t.targetId,this._createStore(t),this.setConfig(t),this._setLocaleTranslations(t),this._themesManager=new Vp(e,t.userTheme),a=this.player.env,Rr.SEMI_COLON="firefox"===a.browser.name.toLowerCase()?59:186}var t,r,a=e.prototype;return a.setConfig=function(e,t){t?this.store.dispatch(ma.updateComponentConfig(t,e)):this.store.dispatch(ma.updateConfig(e))},a.addComponent=function(e){return function(){}},a.buildDefaultUI=function(){var e=[{template:function(e){return lo(e)},condition:function(e){return e.engine.isIdle}},{template:function(e){return xp(e)},condition:function(e){return e.engine.hasError}},{template:function(e){return Pp(e)},condition:function(e){return e.engine.adBreak}},{template:function(e){return Dp(e)},condition:function(e){return e.engine.isLive}},{template:function(e){return Lp(e)},condition:function(e){return e.engine.isImg}},{template:function(e){return bp(e)}}];this._buildUI(e),this._themesManager.applyUserTheme()},a.buildCustomUI=function(e){if(e.length>0)this._buildUI(e);else{var t=[{template:function(e){return bp(e)}}];this._buildUI(t)}this._themesManager.applyUserTheme()},a._setLocaleTranslations=function(e){var t=this;e.translations&&Object.entries(e.translations).forEach((function(e){var r=e[0],a=e[1];a=Cr({},t._translations.en,a),t._translations[r]=a})),e.locale&&this._translations[e.locale]&&(this._locale=e.locale)},a._createStore=function(e){var t=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ut;this.store=It(Ci,t(Np(this.player,e)))},a._buildUI=function(e){var t=this;this.player&&(this.container=document.getElementById(this.targetId),this.container&&re(N(ut,{store:this.store},N(On,{uiComponents:this._uiComponents,setApi:function(e){e&&(t.addComponent=e)}},N(cr,{definition:this._translations[this._locale]},N(ba,{player:this.player},N(Ja,{player:this.player,store:this.store},N(Is,{playerContainer:this.container},N(Tn,null,N(Di,null),N(Li,null),N(Zi,{uis:e,playerContainer:this.container})))))))),this.container))},a.destroy=function(){this.container&&(this.container.prepend(this.player.getView()),re("",this.container))},a.getLogLevel=function(e){return function(e){return xr(e).getLevel()}(e)},a.setLogLevel=function(e,t){!function(e,t){xr(t).setLevel(e)}(e,t)},t=e,(r=[{key:"config",get:function(){return function e(t){var r;return Array.isArray(t)?(r=t.length>0?t.slice(0):[]).forEach((function(t,a){("object"==typeof t&&t!=={}||Array.isArray(t)&&t.length>0)&&(r[a]=e(t))})):"object"==typeof t?(r=Object.assign({},t),Object.keys(r).forEach((function(t){("object"==typeof r[t]&&r[t]!=={}||Array.isArray(r[t])&&r[t].length>0)&&(r[t]=e(r[t]))}))):r=t,r}(this.store.getState().config)}},{key:"LogLevel",get:function(){return wr}},{key:"Event",get:function(){return Dr}}])&&$p(t.prototype,r),e}(),Kp=Dr,Wp="0.76.1",zp="@playkit-js/playkit-js-ui"}])},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var a=r(10),n=r(30);e.exports=r(9)?function(e,t,r){return a.f(e,t,n(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var a=r(47),n=r(26);e.exports=function(e){return a(n(e))}},function(e,t,r){"use strict";var a=r(3);e.exports=function(e,t){return!!e&&a((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,r){var a=r(20);e.exports=function(e,t,r){if(a(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,a){return e.call(t,r,a)};case 3:return function(r,a,n){return e.call(t,r,a,n)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var r=Math.ceil,a=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?a:r)(e)}},function(e,t,r){var a=r(48),n=r(30),i=r(17),o=r(28),s=r(15),l=r(93),u=Object.getOwnPropertyDescriptor;t.f=r(9)?u:function(e,t){if(e=i(e),t=o(t,!0),l)try{return u(e,t)}catch(e){}if(s(e,t))return n(!a.f.call(e,t),e[t])}},function(e,t,r){var a=r(1),n=r(8),i=r(3);e.exports=function(e,t){var r=(n.Object||{})[e]||Object[e],o={};o[e]=t(r),a(a.S+a.F*i((function(){r(1)})),"Object",o)}},function(e,t,r){var a=r(19),n=r(47),i=r(11),o=r(7),s=r(109);e.exports=function(e,t){var r=1==e,l=2==e,u=3==e,c=4==e,d=6==e,p=5==e||d,h=t||s;return function(t,s,f){for(var g,y,m=i(t),v=n(m),_=a(s,f,3),k=o(v.length),E=0,T=r?h(t,k):l?h(t,0):void 0;k>E;E++)if((p||E in v)&&(y=_(g=v[E],E,m),e))if(r)T[E]=y;else if(y)switch(e){case 3:return!0;case 5:return g;case 6:return E;case 2:T.push(g)}else if(c)return!1;return d?-1:u||c?c:T}}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){"use strict";if(r(9)){var a=r(32),n=r(2),i=r(3),o=r(1),s=r(62),l=r(88),u=r(19),c=r(44),d=r(30),p=r(16),h=r(45),f=r(21),g=r(7),y=r(120),m=r(34),v=r(28),_=r(15),k=r(49),E=r(5),T=r(11),b=r(80),S=r(35),A=r(37),C=r(36).f,P=r(82),w=r(31),x=r(6),I=r(24),M=r(52),D=r(50),R=r(84),O=r(42),L=r(55),N=r(43),U=r(83),F=r(111),B=r(10),j=r(22),V=B.f,$=j.f,H=n.RangeError,G=n.TypeError,K=n.Uint8Array,W=Array.prototype,z=l.ArrayBuffer,q=l.DataView,Y=I(0),X=I(2),Q=I(3),J=I(4),Z=I(5),ee=I(6),te=M(!0),re=M(!1),ae=R.values,ne=R.keys,ie=R.entries,oe=W.lastIndexOf,se=W.reduce,le=W.reduceRight,ue=W.join,ce=W.sort,de=W.slice,pe=W.toString,he=W.toLocaleString,fe=x("iterator"),ge=x("toStringTag"),ye=w("typed_constructor"),me=w("def_constructor"),ve=s.CONSTR,_e=s.TYPED,ke=s.VIEW,Ee=I(1,(function(e,t){return Ce(D(e,e[me]),t)})),Te=i((function(){return 1===new K(new Uint16Array([1]).buffer)[0]})),be=!!K&&!!K.prototype.set&&i((function(){new K(1).set({})})),Se=function(e,t){var r=f(e);if(r<0||r%t)throw H("Wrong offset!");return r},Ae=function(e){if(E(e)&&_e in e)return e;throw G(e+" is not a typed array!")},Ce=function(e,t){if(!E(e)||!(ye in e))throw G("It is not a typed array constructor!");return new e(t)},Pe=function(e,t){return we(D(e,e[me]),t)},we=function(e,t){for(var r=0,a=t.length,n=Ce(e,a);a>r;)n[r]=t[r++];return n},xe=function(e,t,r){V(e,t,{get:function(){return this._d[r]}})},Ie=function(e){var t,r,a,n,i,o,s=T(e),l=arguments.length,c=l>1?arguments[1]:void 0,d=void 0!==c,p=P(s);if(null!=p&&!b(p)){for(o=p.call(s),a=[],t=0;!(i=o.next()).done;t++)a.push(i.value);s=a}for(d&&l>2&&(c=u(c,arguments[2],2)),t=0,r=g(s.length),n=Ce(this,r);r>t;t++)n[t]=d?c(s[t],t):s[t];return n},Me=function(){for(var e=0,t=arguments.length,r=Ce(this,t);t>e;)r[e]=arguments[e++];return r},De=!!K&&i((function(){he.call(new K(1))})),Re=function(){return he.apply(De?de.call(Ae(this)):Ae(this),arguments)},Oe={copyWithin:function(e,t){return F.call(Ae(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return J(Ae(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return U.apply(Ae(this),arguments)},filter:function(e){return Pe(this,X(Ae(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return Z(Ae(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Ae(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Y(Ae(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return re(Ae(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Ae(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ue.apply(Ae(this),arguments)},lastIndexOf:function(e){return oe.apply(Ae(this),arguments)},map:function(e){return Ee(Ae(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return se.apply(Ae(this),arguments)},reduceRight:function(e){return le.apply(Ae(this),arguments)},reverse:function(){for(var e,t=Ae(this).length,r=Math.floor(t/2),a=0;a<r;)e=this[a],this[a++]=this[--t],this[t]=e;return this},some:function(e){return Q(Ae(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ce.call(Ae(this),e)},subarray:function(e,t){var r=Ae(this),a=r.length,n=m(e,a);return new(D(r,r[me]))(r.buffer,r.byteOffset+n*r.BYTES_PER_ELEMENT,g((void 0===t?a:m(t,a))-n))}},Le=function(e,t){return Pe(this,de.call(Ae(this),e,t))},Ne=function(e){Ae(this);var t=Se(arguments[1],1),r=this.length,a=T(e),n=g(a.length),i=0;if(n+t>r)throw H("Wrong length!");for(;i<n;)this[t+i]=a[i++]},Ue={entries:function(){return ie.call(Ae(this))},keys:function(){return ne.call(Ae(this))},values:function(){return ae.call(Ae(this))}},Fe=function(e,t){return E(e)&&e[_e]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Be=function(e,t){return Fe(e,t=v(t,!0))?d(2,e[t]):$(e,t)},je=function(e,t,r){return!(Fe(e,t=v(t,!0))&&E(r)&&_(r,"value"))||_(r,"get")||_(r,"set")||r.configurable||_(r,"writable")&&!r.writable||_(r,"enumerable")&&!r.enumerable?V(e,t,r):(e[t]=r.value,e)};ve||(j.f=Be,B.f=je),o(o.S+o.F*!ve,"Object",{getOwnPropertyDescriptor:Be,defineProperty:je}),i((function(){pe.call({})}))&&(pe=he=function(){return ue.call(this)});var Ve=h({},Oe);h(Ve,Ue),p(Ve,fe,Ue.values),h(Ve,{slice:Le,set:Ne,constructor:function(){},toString:pe,toLocaleString:Re}),xe(Ve,"buffer","b"),xe(Ve,"byteOffset","o"),xe(Ve,"byteLength","l"),xe(Ve,"length","e"),V(Ve,ge,{get:function(){return this[_e]}}),e.exports=function(e,t,r,l){var u=e+((l=!!l)?"Clamped":"")+"Array",d="get"+e,h="set"+e,f=n[u],m=f||{},v=f&&A(f),_=!f||!s.ABV,T={},b=f&&f.prototype,P=function(e,r){V(e,r,{get:function(){return function(e,r){var a=e._d;return a.v[d](r*t+a.o,Te)}(this,r)},set:function(e){return function(e,r,a){var n=e._d;l&&(a=(a=Math.round(a))<0?0:a>255?255:255&a),n.v[h](r*t+n.o,a,Te)}(this,r,e)},enumerable:!0})};_?(f=r((function(e,r,a,n){c(e,f,u,"_d");var i,o,s,l,d=0,h=0;if(E(r)){if(!(r instanceof z||"ArrayBuffer"==(l=k(r))||"SharedArrayBuffer"==l))return _e in r?we(f,r):Ie.call(f,r);i=r,h=Se(a,t);var m=r.byteLength;if(void 0===n){if(m%t)throw H("Wrong length!");if((o=m-h)<0)throw H("Wrong length!")}else if((o=g(n)*t)+h>m)throw H("Wrong length!");s=o/t}else s=y(r),i=new z(o=s*t);for(p(e,"_d",{b:i,o:h,l:o,e:s,v:new q(i)});d<s;)P(e,d++)})),b=f.prototype=S(Ve),p(b,"constructor",f)):i((function(){f(1)}))&&i((function(){new f(-1)}))&&L((function(e){new f,new f(null),new f(1.5),new f(e)}),!0)||(f=r((function(e,r,a,n){var i;return c(e,f,u),E(r)?r instanceof z||"ArrayBuffer"==(i=k(r))||"SharedArrayBuffer"==i?void 0!==n?new m(r,Se(a,t),n):void 0!==a?new m(r,Se(a,t)):new m(r):_e in r?we(f,r):Ie.call(f,r):new m(y(r))})),Y(v!==Function.prototype?C(m).concat(C(v)):C(m),(function(e){e in f||p(f,e,m[e])})),f.prototype=b,a||(b.constructor=f));var w=b[fe],x=!!w&&("values"==w.name||null==w.name),I=Ue.values;p(f,ye,!0),p(b,_e,u),p(b,ke,!0),p(b,me,f),(l?new f(1)[ge]==u:ge in b)||V(b,ge,{get:function(){return u}}),T[u]=f,o(o.G+o.W+o.F*(f!=m),T),o(o.S,u,{BYTES_PER_ELEMENT:t}),o(o.S+o.F*i((function(){m.of.call(f,1)})),u,{from:Ie,of:Me}),"BYTES_PER_ELEMENT"in b||p(b,"BYTES_PER_ELEMENT",t),o(o.P,u,Oe),N(u),o(o.P+o.F*be,u,{set:Ne}),o(o.P+o.F*!x,u,Ue),a||b.toString==pe||(b.toString=pe),o(o.P+o.F*i((function(){new f(1).slice()})),u,{slice:Le}),o(o.P+o.F*(i((function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()}))||!i((function(){b.toLocaleString.call([1,2])}))),u,{toLocaleString:Re}),O[u]=x?w:I,a||x||p(b,fe,I)}}else e.exports=function(){}},function(e,t,r){var a=r(5);e.exports=function(e,t){if(!a(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!a(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!a(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!a(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){var a=r(31)("meta"),n=r(5),i=r(15),o=r(10).f,s=0,l=Object.isExtensible||function(){return!0},u=!r(3)((function(){return l(Object.preventExtensions({}))})),c=function(e){o(e,a,{value:{i:"O"+ ++s,w:{}}})},d=e.exports={KEY:a,NEED:!1,fastKey:function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,a)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[a].i},getWeak:function(e,t){if(!i(e,a)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[a].w},onFreeze:function(e){return u&&d.NEED&&l(e)&&!i(e,a)&&c(e),e}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var r=0,a=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+a).toString(36))}},function(e,t){e.exports=!1},function(e,t,r){var a=r(95),n=r(67);e.exports=Object.keys||function(e){return a(e,n)}},function(e,t,r){var a=r(21),n=Math.max,i=Math.min;e.exports=function(e,t){return(e=a(e))<0?n(e+t,0):i(e,t)}},function(e,t,r){var a=r(4),n=r(96),i=r(67),o=r(66)("IE_PROTO"),s=function(){},l=function(){var e,t=r(64)("iframe"),a=i.length;for(t.style.display="none",r(68).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;a--;)delete l.prototype[i[a]];return l()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=a(e),r=new s,s.prototype=null,r[o]=e):r=l(),void 0===t?r:n(r,t)}},function(e,t,r){var a=r(95),n=r(67).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return a(e,n)}},function(e,t,r){var a=r(15),n=r(11),i=r(66)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=n(e),a(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,r){var a=r(6)("unscopables"),n=Array.prototype;null==n[a]&&r(16)(n,a,{}),e.exports=function(e){n[a][e]=!0}},function(e,t,r){var a=r(5);e.exports=function(e,t){if(!a(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,r){var a=r(10).f,n=r(15),i=r(6)("toStringTag");e.exports=function(e,t,r){e&&!n(e=r?e:e.prototype,i)&&a(e,i,{configurable:!0,value:t})}},function(e,t,r){var a=r(1),n=r(26),i=r(3),o=r(70),s="["+o+"]",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),c=function(e,t,r){var n={},s=i((function(){return!!o[e]()||"​"!="​"[e]()})),l=n[e]=s?t(d):o[e];r&&(n[r]=l),a(a.P+a.F*s,"String",n)},d=c.trim=function(e,t){return e=String(n(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=c},function(e,t){e.exports={}},function(e,t,r){"use strict";var a=r(2),n=r(10),i=r(9),o=r(6)("species");e.exports=function(e){var t=a[e];i&&t&&!t[o]&&n.f(t,o,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,r,a){if(!(e instanceof t)||void 0!==a&&a in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var a=r(12);e.exports=function(e,t,r){for(var n in t)a(e,n,t[n],r);return e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),window._babelPolyfill||r(126);var a,n,i,o=function(){function e(){}return e.register=function(t){e._polyfills.push(t)},e.installAll=function(){for(var t=0;t<e._polyfills.length;t++)e._polyfills[t].install()},e}();a=o,i=[],(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n="_polyfills"))in a?Object.defineProperty(a,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[n]=i},function(e,t,r){var a=r(25);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==a(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){var a=r(25),n=r(6)("toStringTag"),i="Arguments"==a(function(){return arguments}());e.exports=function(e){var t,r,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),n))?r:i?a(t):"Object"==(o=a(t))&&"function"==typeof t.callee?"Arguments":o}},function(e,t,r){var a=r(4),n=r(20),i=r(6)("species");e.exports=function(e,t){var r,o=a(e).constructor;return void 0===o||null==(r=a(o)[i])?t:n(r)}},function(e,t,r){var a=r(8),n=r(2),i=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:a.version,mode:r(32)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,r){var a=r(17),n=r(7),i=r(34);e.exports=function(e){return function(t,r,o){var s,l=a(t),u=n(l.length),c=i(o,u);if(e&&r!=r){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===r)return e||c||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var a=r(25);e.exports=Array.isArray||function(e){return"Array"==a(e)}},function(e,t,r){var a=r(6)("iterator"),n=!1;try{var i=[7][a]();i.return=function(){n=!0},Array.from(i,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!n)return!1;var r=!1;try{var i=[7],o=i[a]();o.next=function(){return{done:r=!0}},i[a]=function(){return o},e(i)}catch(e){}return r}},function(e,t,r){"use strict";var a=r(4);e.exports=function(){var e=a(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,r){"use strict";var a=r(49),n=RegExp.prototype.exec;e.exports=function(e,t){var r=e.exec;if("function"==typeof r){var i=r.call(e,t);if("object"!=typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==a(e))throw new TypeError("RegExp#exec called on incompatible receiver");return n.call(e,t)}},function(e,t,r){"use strict";r(113);var a=r(12),n=r(16),i=r(3),o=r(26),s=r(6),l=r(85),u=s("species"),c=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();e.exports=function(e,t,r){var p=s(e),h=!i((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),f=h?!i((function(){var t=!1,r=/a/;return r.exec=function(){return t=!0,null},"split"===e&&(r.constructor={},r.constructor[u]=function(){return r}),r[p](""),!t})):void 0;if(!h||!f||"replace"===e&&!c||"split"===e&&!d){var g=/./[p],y=r(o,p,""[e],(function(e,t,r,a,n){return t.exec===l?h&&!n?{done:!0,value:g.call(t,r,a)}:{done:!0,value:e.call(r,t,a)}:{done:!1}})),m=y[0],v=y[1];a(String.prototype,e,m),n(RegExp.prototype,p,2==t?function(e,t){return v.call(e,this,t)}:function(e){return v.call(e,this)})}}},function(e,t,r){var a=r(19),n=r(108),i=r(80),o=r(4),s=r(7),l=r(82),u={},c={};(t=e.exports=function(e,t,r,d,p){var h,f,g,y,m=p?function(){return e}:l(e),v=a(r,d,t?2:1),_=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(i(m)){for(h=s(e.length);h>_;_++)if((y=t?v(o(f=e[_])[0],f[1]):v(e[_]))===u||y===c)return y}else for(g=m.call(e);!(f=g.next()).done;)if((y=n(g,v,f.value,t))===u||y===c)return y}).BREAK=u,t.RETURN=c},function(e,t,r){var a=r(2).navigator;e.exports=a&&a.userAgent||""},function(e,t,r){"use strict";var a=r(2),n=r(1),i=r(12),o=r(45),s=r(29),l=r(59),u=r(44),c=r(5),d=r(3),p=r(55),h=r(40),f=r(71);e.exports=function(e,t,r,g,y,m){var v=a[e],_=v,k=y?"set":"add",E=_&&_.prototype,T={},b=function(e){var t=E[e];i(E,e,"delete"==e||"has"==e?function(e){return!(m&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return m&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof _&&(m||E.forEach&&!d((function(){(new _).entries().next()})))){var S=new _,A=S[k](m?{}:-0,1)!=S,C=d((function(){S.has(1)})),P=p((function(e){new _(e)})),w=!m&&d((function(){for(var e=new _,t=5;t--;)e[k](t,t);return!e.has(-0)}));P||((_=t((function(t,r){u(t,_,e);var a=f(new v,t,_);return null!=r&&l(r,y,a[k],a),a}))).prototype=E,E.constructor=_),(C||w)&&(b("delete"),b("has"),y&&b("get")),(w||A)&&b(k),m&&E.clear&&delete E.clear}else _=g.getConstructor(t,e,y,k),o(_.prototype,r),s.NEED=!0;return h(_,e),T[e]=_,n(n.G+n.W+n.F*(_!=v),T),m||g.setStrong(_,e,y),_}},function(e,t,r){for(var a,n=r(2),i=r(16),o=r(31),s=o("typed_array"),l=o("view"),u=!(!n.ArrayBuffer||!n.DataView),c=u,d=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");d<9;)(a=n[p[d++]])?(i(a.prototype,s,!0),i(a.prototype,l,!0)):c=!1;e.exports={ABV:u,CONSTR:c,TYPED:s,VIEW:l}},function(e,t,r){window,e.exports=function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=19)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(2);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=function e(t,r,a,n){void 0===n&&(n={}),this.severity=t,this.category=r,this.code=a,this.data=n,e._logger.error("Category:"+r+" | Code:"+a+" |",n)};n(i,"Severity",{RECOVERABLE:1,CRITICAL:2}),n(i,"Category",{NETWORK:1,SERVICE:2,PROVIDER:3}),n(i,"Code",{UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,BAD_SERVER_RESPONSE:1005,MULTIREQUEST_API_ERROR:1006,API_RESPONSE_MISMATCH:1007,ERROR:2e3,BLOCK_ACTION:2001,MEDIA_STATUS_NOT_READY:2002,MISSING_MANDATORY_PARAMS:3e3,MISSING_PLAY_SOURCE:3001,METHOD_NOT_IMPLEMENTED:3002}),n(i,"_logger",Object(a.b)("Error"))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(8);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=function(){function e(){this.metadata=new Map,this.sources=new a.a,this.type=e.Type.UNKNOWN}return e.prototype.toJSON=function(){return{id:this.id,name:this.name,sources:this.sources.toJSON(),duration:this.duration,dvrStatus:this.dvrStatus,status:this.status,metadata:this.metadata,type:this.type,poster:this.poster,assetReferenceType:this.assetReferenceType}},e}();n(i,"Type",{VOD:"Vod",LIVE:"Live",IMAGE:"Image",AUDIO:"Audio",UNKNOWN:"Unknown"}),n(i,"DvrStatus",{ON:1,OFF:0})},function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return i})),r.d(t,"a",(function(){return n}));var a={get:function(){return{VERSION:"",DEBUG:{value:"",name:""},ERROR:{value:"",name:""},INFO:{value:"",name:""},OFF:{value:"",name:""},TIME:{value:"",name:""},TRACE:{value:"",name:""},WARN:{value:"",name:""},createDefaultHandler:function(){},debug:function(){},enabledFor:function(){},error:function(){},get:function(){},getLevel:function(){},info:function(){},log:function(){},setHandler:function(){},setLevel:function(){},time:function(){},timeEnd:function(){},trace:function(){},useDefaults:function(){},warn:function(){}}}},n={};function i(e){e&&"function"==typeof e.getLogger&&(a.get=e.getLogger),e&&e.LogLevel&&(n=e.LogLevel)}function o(e){return a.get(e)}function s(e){return o(e).getLevel()}function l(e,t){o(t).setLevel(e)}t.b=o},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(0);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=function(){function e(e){void 0===e&&(e=new Map),n(this,"retryConfig",{async:!0,timeout:0,maxAttempts:4}),n(this,"_attemptCounter",1),this.headers=e}var t=e.prototype;return t.getUrl=function(e){return e+"/service/"+this.service+(this.action?"/action/"+this.action:"")},t.doHttpRequest=function(){var e=this,t=new Promise((function(t,r){e._requestPromise={resolve:t,reject:r}}));return this.url||this._requestPromise.reject(new a.a(a.a.Severity.CRITICAL,a.a.Category.NETWORK,a.a.Code.MALFORMED_DATA_URI,{url:this.url})),this._createXHR(),t},t._createXHR=function(){var e=this,t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status)try{var r=JSON.parse(t.responseText);return e.responseHeaders=e._getResponseHeaders(t),e._requestPromise.resolve(r)}catch(r){e._requestPromise.reject(e._createError(t,a.a.Code.BAD_SERVER_RESPONSE,{text:t.responseText}))}},t.open(this.method,this.url,this.retryConfig.async),this.retryConfig.async&&this.retryConfig.timeout&&(t.timeout=this.retryConfig.timeout);var r=performance.now();t.ontimeout=function(){e._handleError(t,a.a.Code.TIMEOUT,{timeout:(performance.now()-r)/1e3,statusText:t.statusText})},t.onerror=t.onabort=function(){e._handleError(t,a.a.Code.HTTP_ERROR,{text:t.responseText,statusText:t.statusText})},this.headers.forEach((function(e,r){t.setRequestHeader(r,e)})),t.send(this.params)},t._getResponseHeaders=function(e){return e.getAllResponseHeaders().split("\n").filter((function(e){return 0===e.toLowerCase().indexOf("x-")}))},t._handleError=function(e,t,r){var a=this._createError(e,t,r);if(e.onreadystatechange=function(){},e.onerror=function(){},e.ontimeout=function(){},e.onabort=function(){},!(this.retryConfig.maxAttempts&&this._attemptCounter<this.retryConfig.maxAttempts))return this._requestPromise.reject(a);this._attemptCounter++,this._createXHR()},t._createError=function(e,t,r){return Object.assign(r,{url:this.url,headers:this._getResponseHeaders(e),attempt:this._attemptCounter}),new a.a(a.a.Severity.CRITICAL,a.a.Category.NETWORK,t,r)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a=function(e){var t;(t="hasError")in this?Object.defineProperty(this,t,{value:!1,enumerable:!0,configurable:!0,writable:!0}):this[t]=!1,"KalturaAPIException"===e.objectType?(this.hasError=!0,this.error=new n(e.code,e.message)):e.error&&"KalturaAPIException"===e.error.objectType?(this.hasError=!0,this.error=new n(e.error.code,e.error.message)):this.data=e},n=function(e,t){this.code=e,this.message=t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i}));var a={DASH:{name:"dash",mimeType:"application/dash+xml",pathExt:"mpd"},HLS:{name:"hls",mimeType:"application/x-mpegURL",pathExt:"m3u8"},WVM:{name:"wvm",mimeType:"video/wvm",pathExt:"wvm"},MP4:{name:"mp4",mimeType:"video/mp4",pathExt:"mp4"},MP3:{name:"mp3",mimeType:"audio/mpeg",pathExt:"mp3"}},n=new Map([["mpegdash",a.DASH],["applehttp",a.HLS],["url",a.MP4]]);function i(e){var t=n.get(e);return!!t&&t.name===a.MP4.name}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a,n,i,o=function(e){this.scheme=e.scheme,this.licenseURL=e.licenseURL,this.certificate=e.certificate};i={"drm.PLAYREADY_CENC":"com.microsoft.playready","drm.WIDEVINE_CENC":"com.widevine.alpha","fairplay.FAIRPLAY":"com.apple.fairplay",WIDEVINE_CENC:"com.widevine.alpha",PLAYREADY_CENC:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"},(n="Scheme")in(a=o)?Object.defineProperty(a,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[n]=i},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a=function(e){this.message=e.message,this.code=e.code}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r(9);var a=r(5),n=(r(13),function(){function e(){this.progressive=[],this.dash=[],this.hls=[],this.image=[]}var t=e.prototype;return t.map=function(e,t){if(t)switch(t.name){case a.a.MP4.name:this.progressive.push(e);break;case a.a.DASH.name:this.dash.push(e);break;case a.a.HLS.name:this.hls.push(e)}},t.toJSON=function(){var e={progressive:[],dash:[],hls:[],image:[]};return this.progressive.forEach((function(t){return e.progressive.push(t.toJSON())})),this.hls.forEach((function(t){return e.hls.push(t.toJSON())})),this.dash.forEach((function(t){return e.dash.push(t.toJSON())})),e.image=this.image,e},e}())},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r(12);var a=function(){function e(){}return e.prototype.toJSON=function(){var e={id:this.id,url:this.url,mimetype:this.mimetype};return this.bandwidth&&(e.bandwidth=this.bandwidth),this.width&&(e.width=this.width),this.height&&(e.height=this.height),this.label&&(e.label=this.label),this.drmData&&this.drmData.length>0&&(e.drmData=[],this.drmData.forEach((function(t){Array.isArray(e.drmData)&&e.drmData.push(t.toJSON())}))),e},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r(11);var a=r(0);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=function(){function e(e){n(this,"_loadersResponseMap",new Map),n(this,"_loaders",new Map),this._networkRetryConfig=e}var t=e.prototype;return t.add=function(e,t,r){var a=this,n=new e(t);if(n.isValid()){this._loaders.set(e.id,n);var i=this._multiRequest.requests.length,o=n.requests;this._multiRequest.retryConfig=this._networkRetryConfig,o.forEach((function(e){e.params=e.params||{},e.params.ks=e.params.ks||r,a._multiRequest.add(e)}));var s=Array.from(new Array(o.length),(function(e,t){return t+i}));this._loadersResponseMap.set(e.id,s)}},t.fetchData=function(e){var t=this;return new Promise((function(r,n){t._multiRequest.execute(e).then((function(e){t._multiResponse=e.response,t.prepareData(e.response).success?r(t._loaders):n(new a.a(a.a.Severity.CRITICAL,a.a.Category.NETWORK,a.a.Code.API_RESPONSE_MISMATCH,{headers:e.headers}))}),(function(e){n(e)}))}))},t.prepareData=function(e){var t=this;return this._loaders.forEach((function(r,a){var n=t._loadersResponseMap.get(a);try{n&&n.length>0&&(r.response=e.results.slice(n[0],n[n.length-1]+1))}catch(e){return{success:!1,error:e}}})),{success:!0,data:this._loaders}},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r(3),n=r(2),i=r(4),o=r(0);function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=function(e){var t,r;function a(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return l(s(t=e.call.apply(e,[this].concat(a))||this),"requests",[]),t}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.add=function(e){var t;this.requests.push(e);var r={},a={service:e.service,action:e.action};return Object.assign(r,((t={})[this.requests.length]=Object.assign(a,e.params),t)),Object.assign(r,this.params),this.params=r,this},n.execute=function(e){var t=this;return new Promise((function(r,n){try{t.params=JSON.stringify(t.params)}catch(e){a._logger.error(""+e.message),n(new o.a(o.a.Severity.CRITICAL,o.a.Category.PROVIDER,o.a.Code.FAILED_PARSING_REQUEST,{error:e,params:t.params}))}t.doHttpRequest().then((function(a){var i=new c(a,e);i.success?r({headers:t.responseHeaders,response:i}):n(new o.a(o.a.Severity.CRITICAL,o.a.Category.NETWORK,o.a.Code.MULTIREQUEST_API_ERROR,{url:t.url,headers:t.responseHeaders,results:i.results}))}),(function(e){n(e)}))}))},a}(a.a);l(u,"_logger",Object(n.b)("MultiRequestBuilder"));var c=function e(t,r){void 0===r&&(r=!0),l(this,"results",[]);var a=t.result?t.result:t,n=(Array.isArray(a)?a:[a]).map((function(e){return new i.a(e)})),o=n.filter((function(e){return e.hasError}));o.forEach((function(t){e._logger.error("Service returned an error with error code: "+t.error.code+" and message: "+t.error.message+".")})),this.results=n,r&&o.length||o.length===this.results.length?this.success=!1:(this.results=this.results.filter((function(e){return!e.hasError})),this.success=!0)};l(c,"_logger",Object(n.b)("MultiRequestResult"))},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a=function(){function e(e,t,r){this.licenseUrl=e,this.scheme=t,r&&(this.certificate=r)}return e.prototype.toJSON=function(){var e={licenseUrl:this.licenseUrl,scheme:this.scheme};return this.certificate&&(e.certificate=this.certificate),e},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a=function(){function e(t){this.id=t.id,this.url=e.extractBaseThumbnailUrl(t.dataUrl),this.mimetype=""}return e.extractBaseThumbnailUrl=function(e){return e.match(".+entry_id/[a-zA-Z0-9_]+/")[0].slice(0,-1)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var a=r(2),n=(r(10),r(0));function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}var s=function(){function e(e,t){var r,n;n={async:!0,timeout:0,maxAttempts:4},(r="_networkRetryConfig")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,Object(a.e)(e.logger),this._partnerId=e.partnerId,this._widgetId=e.widgetId,this._uiConfId=e.uiConfId,this._isAnonymous=!e.ks,this._ks=e.ks||"",this._playerVersion=t}o(e,[{key:"partnerId",get:function(){return this._partnerId}},{key:"widgetId",get:function(){return this._widgetId||this.defaultWidgetId}},{key:"defaultWidgetId",get:function(){return"_"+this._partnerId}},{key:"uiConfId",get:function(){return this._uiConfId}},{key:"ks",get:function(){return this._ks},set:function(e){this._ks=e}},{key:"playerVersion",get:function(){return this._playerVersion}},{key:"isAnonymous",get:function(){return this._isAnonymous}}]);var t=e.prototype;return t.getMediaConfig=function(e){return Promise.reject(new n.a(n.a.Severity.CRITICAL,n.a.Category.PROVIDER,n.a.Code.METHOD_NOT_IMPLEMENTED,{message:"getMediaConfig method must be implement by the derived class"}))},t.getPlaylistConfig=function(e){return Promise.reject(new n.a(n.a.Severity.CRITICAL,n.a.Category.PROVIDER,n.a.Code.METHOD_NOT_IMPLEMENTED,{message:"The provider does not support loading playlist by id"}))},t.getEntryListConfig=function(e){return Promise.reject(new n.a(n.a.Severity.CRITICAL,n.a.Category.PROVIDER,n.a.Code.METHOD_NOT_IMPLEMENTED,{message:"The provider does not support loading entry list"}))},t._verifyHasSources=function(e){if(0===e.hls.concat(e.dash,e.progressive,e.image).length)throw new n.a(n.a.Severity.CRITICAL,n.a.Category.SERVICE,n.a.Code.MISSING_PLAY_SOURCE,{action:"",messages:"No play source for entry id: "+e.id})},t.getLogLevel=function(e){return Object(a.c)(e)},t.setLogLevel=function(e,t){Object(a.d)(e,t)},o(e,[{key:"LogLevel",get:function(){return a.a}}]),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a=function e(t){var r;return Array.isArray(t)?(r=t.length>0?t.slice(0):[]).forEach((function(t,a){("object"==typeof t&&t!=={}||Array.isArray(t)&&t.length>0)&&(r[a]=e(t))})):"object"==typeof t?(r=Object.assign({},t),Object.keys(r).forEach((function(t){("object"==typeof r[t]&&r[t]!=={}||Array.isArray(r[t])&&r[t].length>0)&&(r[t]=e(r[t]))}))):r=t,r}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r(1);var a=function(){this.items=[]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a=function(e){this.url=e.url,this.clickThroughUrl=e.clickThroughUrl}},,function(e,t,r){"use strict";r.r(t),r.d(t,"Provider",(function(){return ee})),r.d(t,"ContextType",(function(){return ae})),r.d(t,"MediaType",(function(){return ne})),r.d(t,"NAME",(function(){return te})),r.d(t,"VERSION",(function(){return re}));var a=r(14),n=r(2),i=r(15),o={serviceParams:{apiVersion:"7.8.1"}},s=function(){function e(){}return e.set=function(e){e&&Object.assign(o,e)},e.get=function(){return Object(i.a)(o)},e}(),l=r(10),u=r(11),c=function(){function e(){}return e.getMultiRequest=function(e,t){var r=s.get(),a=r.serviceParams;e&&Object.assign(a,{ks:e}),t&&Object.assign(a,{partnerId:t});var n=new Map;n.set("Content-Type","application/json");var i=new u.a(n);return i.method="POST",i.service="multirequest",i.url=i.getUrl(r.serviceUrl),i.params=a,i},e}(),d=function(e){var t,r;function a(t,r,a){var n;return void 0===r&&(r=""),(n=e.call(this,a)||this)._multiRequest=c.getMultiRequest(r,t),n}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(l.a),p=r(3),h=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.anonymousLogin=function(e,t,r){var a=new Map;a.set("Content-Type","application/json");var n=new p.a(a);n.service="ottuser",n.action="anonymousLogin",n.method="POST",n.url=n.getUrl(e);var i={partnerId:t};return r&&Object.assign(i,{udid:r}),n.params=i,n},a}(c);function f(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}var y,m,v,_=function(){function e(e){var t,r;r={},(t="_response")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this.requests=this.buildRequests(e),this._partnerId=e.partnerId}g(e,null,[{key:"id",get:function(){return"session"}}]);var t=e.prototype;return t.buildRequests=function(e){var t=s.get(),r=[];return r.push(h.anonymousLogin(t.serviceUrl,e.partnerId,e.udid)),r},t.isValid=function(){return!!this._partnerId},g(e,[{key:"requests",set:function(e){this._requests=e},get:function(){return this._requests}},{key:"response",set:function(e){this._response.ks=e[0].data.ks},get:function(){return this._response.ks}}]),e}(),k=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.getPlaybackContext=function(e,t,r,a,n){var i=new Map;i.set("Content-Type","application/json");var o=new p.a(i);o.service="asset",o.action="getPlaybackContext",o.method="POST",o.url=o.getUrl(e);var s={objectType:"KalturaPlaybackContextOptions"};return Object.assign(s,n),o.params={assetId:r,assetType:a,contextDataParams:s,ks:t},o},a.get=function(e,t,r,a){var n=new Map;n.set("Content-Type","application/json");var i=new p.a(n);return i.service="asset",i.action="get",i.method="POST",i.url=i.getUrl(e),i.params={id:r,assetReferenceType:a,ks:t},i},a}(c),E=r(4),T=r(7),b=function(e){this.type=e.type};v={BLOCK:"BLOCK",START_DATE_OFFSET:"START_DATE_OFFSET",END_DATE_OFFSET:"END_DATE_OFFSET",USER_BLOCK:"USER_BLOCK",ALLOW_PLAYBACK:"ALLOW_PLAYBACK",BLOCK_PLAYBACK:"BLOCK_PLAYBACK",APPLY_DISCOUNT_MODULE:"APPLY_DISCOUNT_MODULE"},(m="Type")in(y=b)?Object.defineProperty(y,m,{value:v,enumerable:!0,configurable:!0,writable:!0}):y[m]=v;var S=r(6),A=function(){function e(e){var t=this;!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e.drm=r}(this,"drm",[]),this.format=e.format,this.adsPolicy=e.adsPolicy,this.adsParam=e.adsParam,this.duration=e.duration,this.url=e.url,this.type=e.type,this.fileId=e.id,this.protocols=e.protocols,e.drm&&e.drm.map((function(e){return t.drm.push(new S.a(e))}))}var t=e.prototype;return t.hasDrmData=function(){return this.drm&&this.drm.length>0},t.getProtocol=function(e){var t="";if(this.protocols&&this.protocols.length>0)this.protocols.split(",").forEach((function(r){r===e&&(t=r)}));else if("http"===e)return e;return t},e}(),C=function(e){this.streamertype=e.streamertype,this.url=e.url};function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(C,"StreamerType",{HLS:"hls",DASH:"dash",PROGRESSIVE:"progressive"});var x=function(e){var t,r;function a(t){var r;if(w(P(r=e.call(this,t)||this),"sources",[]),w(P(r),"actions",[]),w(P(r),"messages",[]),w(P(r),"plugins",[]),!r.hasError){var a=t.messages;a&&a.map((function(e){return r.messages.push(new T.a(e))}));var n=t.actions;n&&n.map((function(e){return r.actions.push(new b(e))}));var i=t.sources;i&&i.map((function(e){return r.sources.push(new A(e))}));var o=t.plugins;o&&o.map((function(e){return r.plugins.push(new C(e))}))}return r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n=a.prototype;return n.hasBlockAction=function(){return void 0!==this.getBlockAction()},n.getBlockAction=function(){return this.actions.find((function(e){return e.type===b.Type.BLOCK}))},n.getErrorMessages=function(){return this.messages},a}(E.a);function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}w(x,"Type",{DOWNLOAD:"DOWNLOAD",TRAILER:"TRAILER",CATCHUP:"CATCHUP",START_OVER:"START_OVER",PLAYBACK:"PLAYBACK"});var D=function(e){var t,r;function a(t){var r;return M(I(r=e.call(this,t)||this),"name",""),M(I(r),"description",""),M(I(r),"tags",[]),M(I(r),"metas",[]),M(I(r),"pictures",[]),r.hasError||(r.id=t.id,r.name=t.name,r.description=t.description,r.metas=r._formatTagsMetas(t.metas),r.tags=r._formatTagsMetas(t.tags),r.pictures=t.images),r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype._formatTagsMetas=function(e){var t=[];return Object.keys(e).forEach((function(r){if(e[r].objects){var a="";e[r].objects.forEach((function(e){a+=e.value+"|"})),t.push({key:r,value:a})}else t.push({key:r,value:e[r].value})})),t},a}(E.a);function R(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function O(e,t,r){return t&&R(e.prototype,t),r&&R(e,r),e}M(D,"Type",{MEDIA:"media",RECORDING:"recording",EPG:"epg"}),M(D,"AssetReferenceType",{MEDIA:"media",EPG_INTERNAL:"epg_internal",EPG_EXTERNAL:"epg_external",NPVR:"nPVR"});var L=function(){function e(e){!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"_response",{}),this.requests=this.buildRequests(e),this._entryId=e.entryId}O(e,null,[{key:"id",get:function(){return"asset"}}]);var t=e.prototype;return t.buildRequests=function(e){var t=s.get(),r=[];return r.push(k.get(t.serviceUrl,e.ks,e.entryId,e.assetReferenceType)),r.push(k.getPlaybackContext(t.serviceUrl,e.ks,e.entryId,e.type,e.playbackContext)),r},t.isValid=function(){return!!this._entryId},O(e,[{key:"requests",set:function(e){this._requests=e},get:function(){return this._requests}},{key:"response",set:function(e){this._response.mediaDataResult=new D(e[0].data),this._response.playBackContextResult=new x(e[1].data)},get:function(){return this._response}}]),e}();function N(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function U(e,t,r){return t&&N(e.prototype,t),r&&N(e,r),e}var F,B,j,V,$=function(){function e(e){!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"_response",{playlistItems:{entries:[]}}),this.requests=this.buildRequests(e),this._entries=e.entries}U(e,null,[{key:"id",get:function(){return"asset_list"}}]);var t=e.prototype;return t.buildRequests=function(e){var t=s.get(),r=[];return e.entries.forEach((function(a){var n=a.assetReferenceType||D.AssetReferenceType.MEDIA;r.push(k.get(t.serviceUrl,e.ks,a.entryId||a,n))})),r},t.isValid=function(){return!(!this._entries||!this._entries.length)},U(e,[{key:"requests",set:function(e){this._requests=e},get:function(){return this._requests}},{key:"response",set:function(e){var t=this;e.forEach((function(e){t._response.playlistItems.entries.push({mediaDataResult:new D(e.data)})}))},get:function(){return this._response}}]),e}(),H=r(1),G=r(12),K=r(9),W=r(8),z=r(16),q=r(17),Y=r(5),X=((V={})[D.Type.MEDIA]=((F={})[x.Type.TRAILER]=function(){return{type:H.a.Type.VOD}},F[x.Type.PLAYBACK]=function(e){return"KalturaLiveAsset"===e.objectType?{type:H.a.Type.LIVE,dvrStatus:e.enableTrickPlay?H.a.DvrStatus.ON:H.a.DvrStatus.OFF}:parseInt(e.externalIds)>0?{type:H.a.Type.LIVE,dvrStatus:H.a.DvrStatus.OFF}:{type:H.a.Type.VOD}},F),V[D.Type.EPG]=((B={})[x.Type.CATCHUP]=function(){return{type:H.a.Type.VOD}},B[x.Type.START_OVER]=function(){return{type:H.a.Type.LIVE,dvrStatus:H.a.DvrStatus.ON}},B),V[D.Type.RECORDING]=((j={})[x.Type.PLAYBACK]=function(){return{type:H.a.Type.VOD}},j),V),Q=function(){function e(){}return e.getMediaEntry=function(t,r){var a=new H.a;e._fillBaseData(a,t,r);var n=t.playBackContextResult,i=t.mediaDataResult,o=n.sources,s=e._filterSourcesByFormats(o,r.formats);a.sources=e._getParsedSources(s);var l=e._getMediaType(i.data,r.mediaType,r.contextType);return a.type=l.type,a.dvrStatus=l.dvrStatus,a.duration=Math.max.apply(Math,o.map((function(e){return e.duration}))),a},e.getEntryList=function(t,r){var a=new z.a;return t.playlistItems.entries.forEach((function(t){var n=new H.a,i=r.find((function(e){return e.entryId===t.mediaDataResult.id}));e._fillBaseData(n,t,i),a.items.push(n)})),a},e.getBumper=function(e){var t=e.playBackContextResult.plugins.find((function(e){return e.streamertype===C.StreamerType.PROGRESSIVE}));if(t)return new q.a(t)},e._fillBaseData=function(t,r,a){var n=r.mediaDataResult,i=e.reconstructMetadata(n);return i.description=n.description,i.name=n.name,n.data.entryId&&(i.entryId=n.data.entryId),n.data.epgId&&(i.epgId=n.data.epgId),n.data.recordingId&&(i.recordingId=n.data.recordingId),a&&a.mediaType&&(i.mediaType=a.mediaType),a&&a.contextType&&(i.contextType=a.contextType),t.metadata=i,t.poster=e._getPoster(n.pictures),t.id=n.id,t},e.reconstructMetadata=function(t){return{metas:e.addToMetaObject(t.metas),tags:e.addToMetaObject(t.tags)}},e.addToMetaObject=function(e){var t={};return e&&e.forEach((function(e){t[e.key]=e.value})),t},e._getPoster=function(e){if(e&&e.length>0){var t=e[0].url;return/.*\/thumbnail\/.*(?:width|height)\/\d+\/(?:height|width)\/\d+/.test(t)?t:e.map((function(e){return{url:e.url,width:e.width,height:e.height}}))}return""},e._getMediaType=function(e,t,r){var a={type:H.a.Type.UNKNOWN};return X[t]&&X[t][r]&&(a=X[t][r](e)),a},e._filterSourcesByFormats=function(e,t){return t.length>0&&(e=e.filter((function(e){return t.includes(e.type)}))),e},e._getParsedSources=function(t){var r=new W.a,a=function(t){var a=e._parseAdaptiveSource(t);if(a){var n=Y.b.get(t.format);r.map(a,n)}};return t&&t.length>0&&(t.filter((function(e){return!Object(Y.c)(e.format)})).forEach(a),t.filter((function(e){return Object(Y.c)(e.format)})).forEach(a)),r},e._parseAdaptiveSource=function(t){var r=new K.a;if(t){var a=t.url,n=Y.b.get(t.format);if(n&&(r.mimetype=n.mimeType),!a)return e._logger.error("failed to create play url from source, discarding source: ("+t.fileId+"), "+t.format+"."),null;if(r.url=a,r.id=t.fileId+","+t.format,t.hasDrmData()){var i=[];t.drm.forEach((function(e){i.push(new G.a(e.licenseURL,S.a.Scheme[e.scheme],e.certificate))})),r.drmData=i}}return r},e.hasBlockAction=function(e){return e.playBackContextResult.hasBlockAction()},e.getBlockAction=function(e){return e.playBackContextResult.getBlockAction()},e.getErrorMessages=function(e){return e.playBackContextResult.getErrorMessages()},e}();!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Q,"_logger",Object(n.b)("OTTProviderParser"));var J=r(0);function Z(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var ee=function(e){var t,r;function a(t,r){var a;return(a=e.call(this,t,r)||this)._logger=Object(n.b)("OTTProvider"),s.set(t.env),a._networkRetryConfig=Object.assign(a._networkRetryConfig,t.networkRetryParameters),a}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i,o,l=a.prototype;return l.getMediaConfig=function(e){var t=this;return e.ks&&(this.ks=e.ks,this._isAnonymous=!1),this._dataLoader=new d(this.partnerId,this.ks,this._networkRetryConfig),new Promise((function(r,a){var n=e.entryId;if(n){var i=t.ks;i||(i="{1:result:ks}",t._dataLoader.add(_,{partnerId:t.partnerId}));var o=e.contextType||x.Type.PLAYBACK,s=e.mediaType||D.Type.MEDIA,l=e.assetReferenceType||D.AssetReferenceType.MEDIA,u={mediaProtocol:e.protocol,assetFileIds:e.fileIds,context:o};e.streamerType&&(u.streamerType=e.streamerType),e.urlType&&(u.urlType=e.urlType),e.adapterData&&(u.adapterData=e.adapterData),t._dataLoader.add(L,{entryId:n,ks:i,type:s,playbackContext:u,assetReferenceType:l});var c={contextType:o,mediaType:s,formats:e.formats||[]};return t._dataLoader.fetchData().then((function(e){try{r(t._parseDataFromResponse(e,c))}catch(e){a(e)}}),(function(e){a(e)}))}a(new J.a(J.a.Severity.CRITICAL,J.a.Category.PROVIDER,J.a.Code.MISSING_MANDATORY_PARAMS,{message:"missing entry id"}))}))},l._parseDataFromResponse=function(e,t){this._logger.debug("Data parsing started");var r={session:{isAnonymous:this._isAnonymous,partnerId:this.partnerId},sources:this._getDefaultSourcesObject(),plugins:{}};if(this.uiConfId&&(r.session.uiConfId=this.uiConfId),e){if(e.has(_.id)){var a=e.get(_.id);a&&a.response&&(r.session.ks=a.response)}else r.session.ks=this.ks;if(e.has(L.id)){var n=e.get(L.id);if(n&&n.response&&Object.keys(n.response).length){var i=n.response;if(Q.hasBlockAction(i))throw new J.a(J.a.Severity.CRITICAL,J.a.Category.SERVICE,J.a.Code.BLOCK_ACTION,{action:Q.getBlockAction(i),messages:Q.getErrorMessages(i)});var o=Q.getMediaEntry(i,t);Object.assign(r.sources,this._getSourcesObject(o)),this._verifyHasSources(r.sources);var s=Q.getBumper(i);s&&Object.assign(r.plugins,{bumper:s})}}}return this._logger.debug("Data parsing finished",r),r},l.getEntryListConfig=function(e){var t=this;return e.ks&&(this.ks=e.ks,this._isAnonymous=!1),this._dataLoader=new d(this.partnerId,this.ks,this._networkRetryConfig),new Promise((function(r,a){var n=e.entries;if(n&&n.length){var i=t.ks;i||(i="{1:result:ks}",t._dataLoader.add(_,{partnerId:t.partnerId})),t._dataLoader.add($,{entries:n,ks:i}),t._dataLoader.fetchData(!1).then((function(e){r(t._parseEntryListDataFromResponse(e,n))}),(function(e){a(e)}))}else a({success:!1,data:"Missing mandatory parameter"})}))},l._parseEntryListDataFromResponse=function(e,t){var r=this;this._logger.debug("Data parsing started");var a={id:"",metadata:{name:"",description:""},poster:"",items:[]};if(e&&e.has($.id)){var n=e.get($.id);n&&n.response&&Q.getEntryList(n.response,t).items.forEach((function(e){return a.items.push({sources:r._getSourcesObject(e)})}))}return this._logger.debug("Data parsing finished",a),a},l._getDefaultSourcesObject=function(){return{hls:[],dash:[],progressive:[],image:[],id:"",duration:0,type:H.a.Type.UNKNOWN,poster:"",dvr:!1,vr:null,metadata:{name:"",description:"",tags:""}}},l._getSourcesObject=function(e){var t=this._getDefaultSourcesObject(),r=e.sources.toJSON();return t.hls=r.hls,t.dash=r.dash,t.progressive=r.progressive,t.id=e.id,t.duration=e.duration,t.type=e.type,t.dvr=!!e.dvrStatus,t.poster=e.poster,e.metadata&&e.metadata.metas&&"string"==typeof e.metadata.metas.tags&&e.metadata.metas.tags.indexOf("360")>-1&&(t.vr={}),Object.assign(t.metadata,e.metadata),t},i=a,(o=[{key:"env",get:function(){return s.get()}}])&&Z(i.prototype,o),a}(a.a),te="playkit-js-providers-ott",re="2.39.0",ae=x.Type,ne=D.Type}])},function(e,t,r){var a=r(5),n=r(2).document,i=a(n)&&a(n.createElement);e.exports=function(e){return i?n.createElement(e):{}}},function(e,t,r){t.f=r(6)},function(e,t,r){var a=r(51)("keys"),n=r(31);e.exports=function(e){return a[e]||(a[e]=n(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var a=r(2).document;e.exports=a&&a.documentElement},function(e,t,r){var a=r(5),n=r(4),i=function(e,t){if(n(e),!a(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,a){try{(a=r(19)(Function.call,r(22).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return i(e,r),t?e.__proto__=r:a(e,r),e}}({},!1):void 0),check:i}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,r){var a=r(5),n=r(69).set;e.exports=function(e,t,r){var i,o=t.constructor;return o!==r&&"function"==typeof o&&(i=o.prototype)!==r.prototype&&a(i)&&n&&n(e,i),e}},function(e,t,r){"use strict";var a=r(21),n=r(26);e.exports=function(e){var t=String(n(this)),r="",i=a(e);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(r+=t);return r}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var r=Math.expm1;e.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:r},function(e,t,r){var a=r(21),n=r(26);e.exports=function(e){return function(t,r){var i,o,s=String(n(t)),l=a(r),u=s.length;return l<0||l>=u?e?"":void 0:(i=s.charCodeAt(l))<55296||i>56319||l+1===u||(o=s.charCodeAt(l+1))<56320||o>57343?e?s.charAt(l):i:e?s.slice(l,l+2):o-56320+(i-55296<<10)+65536}}},function(e,t,r){"use strict";var a=r(32),n=r(1),i=r(12),o=r(16),s=r(42),l=r(107),u=r(40),c=r(37),d=r(6)("iterator"),p=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,r,f,g,y,m){l(r,t,f);var v,_,k,E=function(e){if(!p&&e in A)return A[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},T=t+" Iterator",b="values"==g,S=!1,A=e.prototype,C=A[d]||A["@@iterator"]||g&&A[g],P=C||E(g),w=g?b?E("entries"):P:void 0,x="Array"==t&&A.entries||C;if(x&&(k=c(x.call(new e)))!==Object.prototype&&k.next&&(u(k,T,!0),a||"function"==typeof k[d]||o(k,d,h)),b&&C&&"values"!==C.name&&(S=!0,P=function(){return C.call(this)}),a&&!m||!p&&!S&&A[d]||o(A,d,P),s[t]=P,s[T]=h,g)if(v={values:b?P:E("values"),keys:y?P:E("keys"),entries:w},m)for(_ in v)_ in A||i(A,_,v[_]);else n(n.P+n.F*(p||S),t,v);return v}},function(e,t,r){var a=r(78),n=r(26);e.exports=function(e,t,r){if(a(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(n(e))}},function(e,t,r){var a=r(5),n=r(25),i=r(6)("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==n(e))}},function(e,t,r){var a=r(6)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[a]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,r){var a=r(42),n=r(6)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(a.Array===e||i[n]===e)}},function(e,t,r){"use strict";var a=r(10),n=r(30);e.exports=function(e,t,r){t in e?a.f(e,t,n(0,r)):e[t]=r}},function(e,t,r){var a=r(49),n=r(6)("iterator"),i=r(42);e.exports=r(8).getIteratorMethod=function(e){if(null!=e)return e[n]||e["@@iterator"]||i[a(e)]}},function(e,t,r){"use strict";var a=r(11),n=r(34),i=r(7);e.exports=function(e){for(var t=a(this),r=i(t.length),o=arguments.length,s=n(o>1?arguments[1]:void 0,r),l=o>2?arguments[2]:void 0,u=void 0===l?r:n(l,r);u>s;)t[s++]=e;return t}},function(e,t,r){"use strict";var a=r(38),n=r(112),i=r(42),o=r(17);e.exports=r(76)(Array,"Array",(function(e,t){this._t=o(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,n(1)):n(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),i.Arguments=i.Array,a("keys"),a("values"),a("entries")},function(e,t,r){"use strict";var a,n,i=r(56),o=RegExp.prototype.exec,s=String.prototype.replace,l=o,u=(a=/a/,n=/b*/g,o.call(a,"a"),o.call(n,"a"),0!==a.lastIndex||0!==n.lastIndex),c=void 0!==/()??/.exec("")[1];(u||c)&&(l=function(e){var t,r,a,n,l=this;return c&&(r=new RegExp("^"+l.source+"$(?!\\s)",i.call(l))),u&&(t=l.lastIndex),a=o.call(l,e),u&&a&&(l.lastIndex=l.global?a.index+a[0].length:t),c&&a&&a.length>1&&s.call(a[0],r,(function(){for(n=1;n<arguments.length-2;n++)void 0===arguments[n]&&(a[n]=void 0)})),a}),e.exports=l},function(e,t,r){"use strict";var a=r(75)(!0);e.exports=function(e,t,r){return t+(r?a(e,t).length:1)}},function(e,t,r){var a,n,i,o=r(19),s=r(101),l=r(68),u=r(64),c=r(2),d=c.process,p=c.setImmediate,h=c.clearImmediate,f=c.MessageChannel,g=c.Dispatch,y=0,m={},v=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},_=function(e){v.call(e.data)};p&&h||(p=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return m[++y]=function(){s("function"==typeof e?e:Function(e),t)},a(y),y},h=function(e){delete m[e]},"process"==r(25)(d)?a=function(e){d.nextTick(o(v,e,1))}:g&&g.now?a=function(e){g.now(o(v,e,1))}:f?(i=(n=new f).port2,n.port1.onmessage=_,a=o(i.postMessage,i,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(a=function(e){c.postMessage(e+"","*")},c.addEventListener("message",_,!1)):a="onreadystatechange"in u("script")?function(e){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),v.call(e)}}:function(e){setTimeout(o(v,e,1),0)}),e.exports={set:p,clear:h}},function(e,t,r){"use strict";var a=r(2),n=r(9),i=r(32),o=r(62),s=r(16),l=r(45),u=r(3),c=r(44),d=r(21),p=r(7),h=r(120),f=r(36).f,g=r(10).f,y=r(83),m=r(40),v=a.ArrayBuffer,_=a.DataView,k=a.Math,E=a.RangeError,T=a.Infinity,b=v,S=k.abs,A=k.pow,C=k.floor,P=k.log,w=k.LN2,x=n?"_b":"buffer",I=n?"_l":"byteLength",M=n?"_o":"byteOffset";function D(e,t,r){var a,n,i,o=new Array(r),s=8*r-t-1,l=(1<<s)-1,u=l>>1,c=23===t?A(2,-24)-A(2,-77):0,d=0,p=e<0||0===e&&1/e<0?1:0;for((e=S(e))!=e||e===T?(n=e!=e?1:0,a=l):(a=C(P(e)/w),e*(i=A(2,-a))<1&&(a--,i*=2),(e+=a+u>=1?c/i:c*A(2,1-u))*i>=2&&(a++,i/=2),a+u>=l?(n=0,a=l):a+u>=1?(n=(e*i-1)*A(2,t),a+=u):(n=e*A(2,u-1)*A(2,t),a=0));t>=8;o[d++]=255&n,n/=256,t-=8);for(a=a<<t|n,s+=t;s>0;o[d++]=255&a,a/=256,s-=8);return o[--d]|=128*p,o}function R(e,t,r){var a,n=8*r-t-1,i=(1<<n)-1,o=i>>1,s=n-7,l=r-1,u=e[l--],c=127&u;for(u>>=7;s>0;c=256*c+e[l],l--,s-=8);for(a=c&(1<<-s)-1,c>>=-s,s+=t;s>0;a=256*a+e[l],l--,s-=8);if(0===c)c=1-o;else{if(c===i)return a?NaN:u?-T:T;a+=A(2,t),c-=o}return(u?-1:1)*a*A(2,c-t)}function O(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function L(e){return[255&e]}function N(e){return[255&e,e>>8&255]}function U(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function F(e){return D(e,52,8)}function B(e){return D(e,23,4)}function j(e,t,r){g(e.prototype,t,{get:function(){return this[r]}})}function V(e,t,r,a){var n=h(+r);if(n+t>e[I])throw E("Wrong index!");var i=e[x]._b,o=n+e[M],s=i.slice(o,o+t);return a?s:s.reverse()}function $(e,t,r,a,n,i){var o=h(+r);if(o+t>e[I])throw E("Wrong index!");for(var s=e[x]._b,l=o+e[M],u=a(+n),c=0;c<t;c++)s[l+c]=u[i?c:t-c-1]}if(o.ABV){if(!u((function(){v(1)}))||!u((function(){new v(-1)}))||u((function(){return new v,new v(1.5),new v(NaN),"ArrayBuffer"!=v.name}))){for(var H,G=(v=function(e){return c(this,v),new b(h(e))}).prototype=b.prototype,K=f(b),W=0;K.length>W;)(H=K[W++])in v||s(v,H,b[H]);i||(G.constructor=v)}var z=new _(new v(2)),q=_.prototype.setInt8;z.setInt8(0,2147483648),z.setInt8(1,2147483649),!z.getInt8(0)&&z.getInt8(1)||l(_.prototype,{setInt8:function(e,t){q.call(this,e,t<<24>>24)},setUint8:function(e,t){q.call(this,e,t<<24>>24)}},!0)}else v=function(e){c(this,v,"ArrayBuffer");var t=h(e);this._b=y.call(new Array(t),0),this[I]=t},_=function(e,t,r){c(this,_,"DataView"),c(e,v,"DataView");var a=e[I],n=d(t);if(n<0||n>a)throw E("Wrong offset!");if(n+(r=void 0===r?a-n:p(r))>a)throw E("Wrong length!");this[x]=e,this[M]=n,this[I]=r},n&&(j(v,"byteLength","_l"),j(_,"buffer","_b"),j(_,"byteLength","_l"),j(_,"byteOffset","_o")),l(_.prototype,{getInt8:function(e){return V(this,1,e)[0]<<24>>24},getUint8:function(e){return V(this,1,e)[0]},getInt16:function(e){var t=V(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=V(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return O(V(this,4,e,arguments[1]))},getUint32:function(e){return O(V(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return R(V(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return R(V(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){$(this,1,e,L,t)},setUint8:function(e,t){$(this,1,e,L,t)},setInt16:function(e,t){$(this,2,e,N,t,arguments[2])},setUint16:function(e,t){$(this,2,e,N,t,arguments[2])},setInt32:function(e,t){$(this,4,e,U,t,arguments[2])},setUint32:function(e,t){$(this,4,e,U,t,arguments[2])},setFloat32:function(e,t){$(this,4,e,B,t,arguments[2])},setFloat64:function(e,t){$(this,8,e,F,t,arguments[2])}});m(v,"ArrayBuffer"),m(_,"DataView"),s(_.prototype,o.VIEW,!0),t.ArrayBuffer=v,t.DataView=_},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){e.exports=!r(125)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){e.exports=!r(9)&&!r(3)((function(){return 7!=Object.defineProperty(r(64)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var a=r(2),n=r(8),i=r(32),o=r(65),s=r(10).f;e.exports=function(e){var t=n.Symbol||(n.Symbol=i?{}:a.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,r){var a=r(15),n=r(17),i=r(52)(!1),o=r(66)("IE_PROTO");e.exports=function(e,t){var r,s=n(e),l=0,u=[];for(r in s)r!=o&&a(s,r)&&u.push(r);for(;t.length>l;)a(s,r=t[l++])&&(~i(u,r)||u.push(r));return u}},function(e,t,r){var a=r(10),n=r(4),i=r(33);e.exports=r(9)?Object.defineProperties:function(e,t){n(e);for(var r,o=i(t),s=o.length,l=0;s>l;)a.f(e,r=o[l++],t[r]);return e}},function(e,t,r){var a=r(17),n=r(36).f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==i.call(e)?function(e){try{return n(e)}catch(e){return o.slice()}}(e):n(a(e))}},function(e,t,r){"use strict";var a=r(9),n=r(33),i=r(53),o=r(48),s=r(11),l=r(47),u=Object.assign;e.exports=!u||r(3)((function(){var e={},t={},r=Symbol(),a="abcdefghijklmnopqrst";return e[r]=7,a.split("").forEach((function(e){t[e]=e})),7!=u({},e)[r]||Object.keys(u({},t)).join("")!=a}))?function(e,t){for(var r=s(e),u=arguments.length,c=1,d=i.f,p=o.f;u>c;)for(var h,f=l(arguments[c++]),g=d?n(f).concat(d(f)):n(f),y=g.length,m=0;y>m;)h=g[m++],a&&!p.call(f,h)||(r[h]=f[h]);return r}:u},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,r){"use strict";var a=r(20),n=r(5),i=r(101),o=[].slice,s={},l=function(e,t,r){if(!(t in s)){for(var a=[],n=0;n<t;n++)a[n]="a["+n+"]";s[t]=Function("F,a","return new F("+a.join(",")+")")}return s[t](e,r)};e.exports=Function.bind||function(e){var t=a(this),r=o.call(arguments,1),s=function(){var a=r.concat(o.call(arguments));return this instanceof s?l(t,a.length,a):i(t,a,e)};return n(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t){e.exports=function(e,t,r){var a=void 0===r;switch(t.length){case 0:return a?e():e.call(r);case 1:return a?e(t[0]):e.call(r,t[0]);case 2:return a?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return a?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return a?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var a=r(2).parseInt,n=r(41).trim,i=r(70),o=/^[-+]?0[xX]/;e.exports=8!==a(i+"08")||22!==a(i+"0x16")?function(e,t){var r=n(String(e),3);return a(r,t>>>0||(o.test(r)?16:10))}:a},function(e,t,r){var a=r(2).parseFloat,n=r(41).trim;e.exports=1/a(r(70)+"-0")!=-1/0?function(e){var t=n(String(e),3),r=a(t);return 0===r&&"-"==t.charAt(0)?-0:r}:a},function(e,t,r){var a=r(25);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=a(e))throw TypeError(t);return+e}},function(e,t,r){var a=r(5),n=Math.floor;e.exports=function(e){return!a(e)&&isFinite(e)&&n(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,r){"use strict";var a=r(35),n=r(30),i=r(40),o={};r(16)(o,r(6)("iterator"),(function(){return this})),e.exports=function(e,t,r){e.prototype=a(o,{next:n(1,r)}),i(e,t+" Iterator")}},function(e,t,r){var a=r(4);e.exports=function(e,t,r,n){try{return n?t(a(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&a(i.call(e)),t}}},function(e,t,r){var a=r(220);e.exports=function(e,t){return new(a(e))(t)}},function(e,t,r){var a=r(20),n=r(11),i=r(47),o=r(7);e.exports=function(e,t,r,s,l){a(t);var u=n(e),c=i(u),d=o(u.length),p=l?d-1:0,h=l?-1:1;if(r<2)for(;;){if(p in c){s=c[p],p+=h;break}if(p+=h,l?p<0:d<=p)throw TypeError("Reduce of empty array with no initial value")}for(;l?p>=0:d>p;p+=h)p in c&&(s=t(s,c[p],p,u));return s}},function(e,t,r){"use strict";var a=r(11),n=r(34),i=r(7);e.exports=[].copyWithin||function(e,t){var r=a(this),o=i(r.length),s=n(e,o),l=n(t,o),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?o:n(u,o))-l,o-s),d=1;for(l<s&&s<l+c&&(d=-1,l+=c-1,s+=c-1);c-- >0;)l in r?r[s]=r[l]:delete r[s],s+=d,l+=d;return r}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";var a=r(85);r(1)({target:"RegExp",proto:!0,forced:a!==/./.exec},{exec:a})},function(e,t,r){r(9)&&"g"!=/./g.flags&&r(10).f(RegExp.prototype,"flags",{configurable:!0,get:r(56)})},function(e,t,r){"use strict";var a,n,i,o,s=r(32),l=r(2),u=r(19),c=r(49),d=r(1),p=r(5),h=r(20),f=r(44),g=r(59),y=r(50),m=r(87).set,v=r(240)(),_=r(116),k=r(241),E=r(60),T=r(117),b=l.TypeError,S=l.process,A=S&&S.versions,C=A&&A.v8||"",P=l.Promise,w="process"==c(S),x=function(){},I=n=_.f,M=!!function(){try{var e=P.resolve(1),t=(e.constructor={})[r(6)("species")]=function(e){e(x,x)};return(w||"function"==typeof PromiseRejectionEvent)&&e.then(x)instanceof t&&0!==C.indexOf("6.6")&&-1===E.indexOf("Chrome/66")}catch(e){}}(),D=function(e){var t;return!(!p(e)||"function"!=typeof(t=e.then))&&t},R=function(e,t){if(!e._n){e._n=!0;var r=e._c;v((function(){for(var a=e._v,n=1==e._s,i=0,o=function(t){var r,i,o,s=n?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{s?(n||(2==e._h&&N(e),e._h=1),!0===s?r=a:(c&&c.enter(),r=s(a),c&&(c.exit(),o=!0)),r===t.promise?u(b("Promise-chain cycle")):(i=D(r))?i.call(r,l,u):l(r)):u(a)}catch(e){c&&!o&&c.exit(),u(e)}};r.length>i;)o(r[i++]);e._c=[],e._n=!1,t&&!e._h&&O(e)}))}},O=function(e){m.call(l,(function(){var t,r,a,n=e._v,i=L(e);if(i&&(t=k((function(){w?S.emit("unhandledRejection",n,e):(r=l.onunhandledrejection)?r({promise:e,reason:n}):(a=l.console)&&a.error&&a.error("Unhandled promise rejection",n)})),e._h=w||L(e)?2:1),e._a=void 0,i&&t.e)throw t.v}))},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){m.call(l,(function(){var t;w?S.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},U=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),R(t,!0))},F=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw b("Promise can't be resolved itself");(t=D(e))?v((function(){var a={_w:r,_d:!1};try{t.call(e,u(F,a,1),u(U,a,1))}catch(e){U.call(a,e)}})):(r._v=e,r._s=1,R(r,!1))}catch(e){U.call({_w:r,_d:!1},e)}}};M||(P=function(e){f(this,P,"Promise","_h"),h(e),a.call(this);try{e(u(F,this,1),u(U,this,1))}catch(e){U.call(this,e)}},(a=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(45)(P.prototype,{then:function(e,t){var r=I(y(this,P));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=w?S.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&R(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new a;this.promise=e,this.resolve=u(F,e,1),this.reject=u(U,e,1)},_.f=I=function(e){return e===P||e===o?new i(e):n(e)}),d(d.G+d.W+d.F*!M,{Promise:P}),r(40)(P,"Promise"),r(43)("Promise"),o=r(8).Promise,d(d.S+d.F*!M,"Promise",{reject:function(e){var t=I(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(s||!M),"Promise",{resolve:function(e){return T(s&&this===o?P:this,e)}}),d(d.S+d.F*!(M&&r(55)((function(e){P.all(e).catch(x)}))),"Promise",{all:function(e){var t=this,r=I(t),a=r.resolve,n=r.reject,i=k((function(){var r=[],i=0,o=1;g(e,!1,(function(e){var s=i++,l=!1;r.push(void 0),o++,t.resolve(e).then((function(e){l||(l=!0,r[s]=e,--o||a(r))}),n)})),--o||a(r)}));return i.e&&n(i.v),r.promise},race:function(e){var t=this,r=I(t),a=r.reject,n=k((function(){g(e,!1,(function(e){t.resolve(e).then(r.resolve,a)}))}));return n.e&&a(n.v),r.promise}})},function(e,t,r){"use strict";var a=r(20);function n(e){var t,r;this.promise=new e((function(e,a){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=a})),this.resolve=a(t),this.reject=a(r)}e.exports.f=function(e){return new n(e)}},function(e,t,r){var a=r(4),n=r(5),i=r(116);e.exports=function(e,t){if(a(e),n(t)&&t.constructor===e)return t;var r=i.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){"use strict";var a=r(10).f,n=r(35),i=r(45),o=r(19),s=r(44),l=r(59),u=r(76),c=r(112),d=r(43),p=r(9),h=r(29).fastKey,f=r(39),g=p?"_s":"size",y=function(e,t){var r,a=h(t);if("F"!==a)return e._i[a];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var c=e((function(e,a){s(e,c,t,"_i"),e._t=t,e._i=n(null),e._f=void 0,e._l=void 0,e[g]=0,null!=a&&l(a,r,e[u],e)}));return i(c.prototype,{clear:function(){for(var e=f(this,t),r=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete r[a.i];e._f=e._l=void 0,e[g]=0},delete:function(e){var r=f(this,t),a=y(r,e);if(a){var n=a.n,i=a.p;delete r._i[a.i],a.r=!0,i&&(i.n=n),n&&(n.p=i),r._f==a&&(r._f=n),r._l==a&&(r._l=i),r[g]--}return!!a},forEach:function(e){f(this,t);for(var r,a=o(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(a(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!y(f(this,t),e)}}),p&&a(c.prototype,"size",{get:function(){return f(this,t)[g]}}),c},def:function(e,t,r){var a,n,i=y(e,t);return i?i.v=r:(e._l=i={i:n=h(t,!0),k:t,v:r,p:a=e._l,n:void 0,r:!1},e._f||(e._f=i),a&&(a.n=i),e[g]++,"F"!==n&&(e._i[n]=i)),e},getEntry:y,setStrong:function(e,t,r){u(e,t,(function(e,r){this._t=f(e,t),this._k=r,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?c(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,c(1))}),r?"entries":"values",!r,!0),d(t)}}},function(e,t,r){"use strict";var a=r(45),n=r(29).getWeak,i=r(4),o=r(5),s=r(44),l=r(59),u=r(24),c=r(15),d=r(39),p=u(5),h=u(6),f=0,g=function(e){return e._l||(e._l=new y)},y=function(){this.a=[]},m=function(e,t){return p(e.a,(function(e){return e[0]===t}))};y.prototype={get:function(e){var t=m(this,e);if(t)return t[1]},has:function(e){return!!m(this,e)},set:function(e,t){var r=m(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=h(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,i){var u=e((function(e,a){s(e,u,t,"_i"),e._t=t,e._i=f++,e._l=void 0,null!=a&&l(a,r,e[i],e)}));return a(u.prototype,{delete:function(e){if(!o(e))return!1;var r=n(e);return!0===r?g(d(this,t)).delete(e):r&&c(r,this._i)&&delete r[this._i]},has:function(e){if(!o(e))return!1;var r=n(e);return!0===r?g(d(this,t)).has(e):r&&c(r,this._i)}}),u},def:function(e,t,r){var a=n(i(t),!0);return!0===a?g(e).set(t,r):a[e._i]=r,e},ufstore:g}},function(e,t,r){var a=r(21),n=r(7);e.exports=function(e){if(void 0===e)return 0;var t=a(e),r=n(t);if(t!==r)throw RangeError("Wrong length!");return r}},function(e,t,r){var a=r(36),n=r(53),i=r(4),o=r(2).Reflect;e.exports=o&&o.ownKeys||function(e){var t=a.f(i(e)),r=n.f;return r?t.concat(r(e)):t}},function(e,t,r){var a=r(7),n=r(72),i=r(26);e.exports=function(e,t,r,o){var s=String(i(e)),l=s.length,u=void 0===r?" ":String(r),c=a(t);if(c<=l||""==u)return s;var d=c-l,p=n.call(u,Math.ceil(d/u.length));return p.length>d&&(p=p.slice(0,d)),o?p+s:s+p}},function(e,t,r){var a=r(9),n=r(33),i=r(17),o=r(48).f;e.exports=function(e){return function(t){for(var r,s=i(t),l=n(s),u=l.length,c=0,d=[];u>c;)r=l[c++],a&&!o.call(s,r)||d.push(e?[r,s[r]]:s[r]);return d}}},function(e,t){var r=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=r)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";r(127);var a,n=(a=r(299))&&a.__esModule?a:{default:a};n.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),n.default._babelPolyfill=!0},function(e,t,r){"use strict";r(128),r(271),r(273),r(276),r(278),r(280),r(282),r(284),r(286),r(288),r(290),r(292),r(294),r(298)},function(e,t,r){r(129),r(132),r(133),r(134),r(135),r(136),r(137),r(138),r(139),r(140),r(141),r(142),r(143),r(144),r(145),r(146),r(147),r(148),r(149),r(150),r(151),r(152),r(153),r(154),r(155),r(156),r(157),r(158),r(159),r(160),r(161),r(162),r(163),r(164),r(165),r(166),r(167),r(168),r(169),r(170),r(171),r(172),r(173),r(175),r(176),r(177),r(178),r(179),r(180),r(181),r(182),r(183),r(184),r(185),r(186),r(187),r(188),r(189),r(190),r(191),r(192),r(193),r(194),r(195),r(196),r(197),r(198),r(199),r(200),r(201),r(202),r(203),r(204),r(205),r(206),r(207),r(208),r(210),r(211),r(213),r(214),r(215),r(216),r(217),r(218),r(219),r(221),r(222),r(223),r(224),r(225),r(226),r(227),r(228),r(229),r(230),r(231),r(232),r(233),r(84),r(234),r(113),r(235),r(114),r(236),r(237),r(238),r(239),r(115),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(256),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(266),r(267),r(268),r(269),r(270),e.exports=r(8)},function(e,t,r){"use strict";var a=r(2),n=r(15),i=r(9),o=r(1),s=r(12),l=r(29).KEY,u=r(3),c=r(51),d=r(40),p=r(31),h=r(6),f=r(65),g=r(94),y=r(131),m=r(54),v=r(4),_=r(5),k=r(11),E=r(17),T=r(28),b=r(30),S=r(35),A=r(97),C=r(22),P=r(53),w=r(10),x=r(33),I=C.f,M=w.f,D=A.f,R=a.Symbol,O=a.JSON,L=O&&O.stringify,N=h("_hidden"),U=h("toPrimitive"),F={}.propertyIsEnumerable,B=c("symbol-registry"),j=c("symbols"),V=c("op-symbols"),$=Object.prototype,H="function"==typeof R&&!!P.f,G=a.QObject,K=!G||!G.prototype||!G.prototype.findChild,W=i&&u((function(){return 7!=S(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a}))?function(e,t,r){var a=I($,t);a&&delete $[t],M(e,t,r),a&&e!==$&&M($,t,a)}:M,z=function(e){var t=j[e]=S(R.prototype);return t._k=e,t},q=H&&"symbol"==typeof R.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof R},Y=function(e,t,r){return e===$&&Y(V,t,r),v(e),t=T(t,!0),v(r),n(j,t)?(r.enumerable?(n(e,N)&&e[N][t]&&(e[N][t]=!1),r=S(r,{enumerable:b(0,!1)})):(n(e,N)||M(e,N,b(1,{})),e[N][t]=!0),W(e,t,r)):M(e,t,r)},X=function(e,t){v(e);for(var r,a=y(t=E(t)),n=0,i=a.length;i>n;)Y(e,r=a[n++],t[r]);return e},Q=function(e){var t=F.call(this,e=T(e,!0));return!(this===$&&n(j,e)&&!n(V,e))&&(!(t||!n(this,e)||!n(j,e)||n(this,N)&&this[N][e])||t)},J=function(e,t){if(e=E(e),t=T(t,!0),e!==$||!n(j,t)||n(V,t)){var r=I(e,t);return!r||!n(j,t)||n(e,N)&&e[N][t]||(r.enumerable=!0),r}},Z=function(e){for(var t,r=D(E(e)),a=[],i=0;r.length>i;)n(j,t=r[i++])||t==N||t==l||a.push(t);return a},ee=function(e){for(var t,r=e===$,a=D(r?V:E(e)),i=[],o=0;a.length>o;)!n(j,t=a[o++])||r&&!n($,t)||i.push(j[t]);return i};H||(s((R=function(){if(this instanceof R)throw TypeError("Symbol is not a constructor!");var e=p(arguments.length>0?arguments[0]:void 0),t=function(r){this===$&&t.call(V,r),n(this,N)&&n(this[N],e)&&(this[N][e]=!1),W(this,e,b(1,r))};return i&&K&&W($,e,{configurable:!0,set:t}),z(e)}).prototype,"toString",(function(){return this._k})),C.f=J,w.f=Y,r(36).f=A.f=Z,r(48).f=Q,P.f=ee,i&&!r(32)&&s($,"propertyIsEnumerable",Q,!0),f.f=function(e){return z(h(e))}),o(o.G+o.W+o.F*!H,{Symbol:R});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),re=0;te.length>re;)h(te[re++]);for(var ae=x(h.store),ne=0;ae.length>ne;)g(ae[ne++]);o(o.S+o.F*!H,"Symbol",{for:function(e){return n(B,e+="")?B[e]:B[e]=R(e)},keyFor:function(e){if(!q(e))throw TypeError(e+" is not a symbol!");for(var t in B)if(B[t]===e)return t},useSetter:function(){K=!0},useSimple:function(){K=!1}}),o(o.S+o.F*!H,"Object",{create:function(e,t){return void 0===t?S(e):X(S(e),t)},defineProperty:Y,defineProperties:X,getOwnPropertyDescriptor:J,getOwnPropertyNames:Z,getOwnPropertySymbols:ee});var ie=u((function(){P.f(1)}));o(o.S+o.F*ie,"Object",{getOwnPropertySymbols:function(e){return P.f(k(e))}}),O&&o(o.S+o.F*(!H||u((function(){var e=R();return"[null]"!=L([e])||"{}"!=L({a:e})||"{}"!=L(Object(e))}))),"JSON",{stringify:function(e){for(var t,r,a=[e],n=1;arguments.length>n;)a.push(arguments[n++]);if(r=t=a[1],(_(t)||void 0!==e)&&!q(e))return m(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!q(t))return t}),a[1]=t,L.apply(O,a)}}),R.prototype[U]||r(16)(R.prototype,U,R.prototype.valueOf),d(R,"Symbol"),d(Math,"Math",!0),d(a.JSON,"JSON",!0)},function(e,t,r){e.exports=r(51)("native-function-to-string",Function.toString)},function(e,t,r){var a=r(33),n=r(53),i=r(48);e.exports=function(e){var t=a(e),r=n.f;if(r)for(var o,s=r(e),l=i.f,u=0;s.length>u;)l.call(e,o=s[u++])&&t.push(o);return t}},function(e,t,r){var a=r(1);a(a.S,"Object",{create:r(35)})},function(e,t,r){var a=r(1);a(a.S+a.F*!r(9),"Object",{defineProperty:r(10).f})},function(e,t,r){var a=r(1);a(a.S+a.F*!r(9),"Object",{defineProperties:r(96)})},function(e,t,r){var a=r(17),n=r(22).f;r(23)("getOwnPropertyDescriptor",(function(){return function(e,t){return n(a(e),t)}}))},function(e,t,r){var a=r(11),n=r(37);r(23)("getPrototypeOf",(function(){return function(e){return n(a(e))}}))},function(e,t,r){var a=r(11),n=r(33);r(23)("keys",(function(){return function(e){return n(a(e))}}))},function(e,t,r){r(23)("getOwnPropertyNames",(function(){return r(97).f}))},function(e,t,r){var a=r(5),n=r(29).onFreeze;r(23)("freeze",(function(e){return function(t){return e&&a(t)?e(n(t)):t}}))},function(e,t,r){var a=r(5),n=r(29).onFreeze;r(23)("seal",(function(e){return function(t){return e&&a(t)?e(n(t)):t}}))},function(e,t,r){var a=r(5),n=r(29).onFreeze;r(23)("preventExtensions",(function(e){return function(t){return e&&a(t)?e(n(t)):t}}))},function(e,t,r){var a=r(5);r(23)("isFrozen",(function(e){return function(t){return!a(t)||!!e&&e(t)}}))},function(e,t,r){var a=r(5);r(23)("isSealed",(function(e){return function(t){return!a(t)||!!e&&e(t)}}))},function(e,t,r){var a=r(5);r(23)("isExtensible",(function(e){return function(t){return!!a(t)&&(!e||e(t))}}))},function(e,t,r){var a=r(1);a(a.S+a.F,"Object",{assign:r(98)})},function(e,t,r){var a=r(1);a(a.S,"Object",{is:r(99)})},function(e,t,r){var a=r(1);a(a.S,"Object",{setPrototypeOf:r(69).set})},function(e,t,r){"use strict";var a=r(49),n={};n[r(6)("toStringTag")]="z",n+""!="[object z]"&&r(12)(Object.prototype,"toString",(function(){return"[object "+a(this)+"]"}),!0)},function(e,t,r){var a=r(1);a(a.P,"Function",{bind:r(100)})},function(e,t,r){var a=r(10).f,n=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in n||r(9)&&a(n,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(e){return""}}})},function(e,t,r){"use strict";var a=r(5),n=r(37),i=r(6)("hasInstance"),o=Function.prototype;i in o||r(10).f(o,i,{value:function(e){if("function"!=typeof this||!a(e))return!1;if(!a(this.prototype))return e instanceof this;for(;e=n(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,r){var a=r(1),n=r(102);a(a.G+a.F*(parseInt!=n),{parseInt:n})},function(e,t,r){var a=r(1),n=r(103);a(a.G+a.F*(parseFloat!=n),{parseFloat:n})},function(e,t,r){"use strict";var a=r(2),n=r(15),i=r(25),o=r(71),s=r(28),l=r(3),u=r(36).f,c=r(22).f,d=r(10).f,p=r(41).trim,h=a.Number,f=h,g=h.prototype,y="Number"==i(r(35)(g)),m="trim"in String.prototype,v=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var r,a,n,i=(t=m?t.trim():p(t,3)).charCodeAt(0);if(43===i||45===i){if(88===(r=t.charCodeAt(2))||120===r)return NaN}else if(48===i){switch(t.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+t}for(var o,l=t.slice(2),u=0,c=l.length;u<c;u++)if((o=l.charCodeAt(u))<48||o>n)return NaN;return parseInt(l,a)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof h&&(y?l((function(){g.valueOf.call(r)})):"Number"!=i(r))?o(new f(v(t)),r,h):v(t)};for(var _,k=r(9)?u(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;k.length>E;E++)n(f,_=k[E])&&!n(h,_)&&d(h,_,c(f,_));h.prototype=g,g.constructor=h,r(12)(a,"Number",h)}},function(e,t,r){"use strict";var a=r(1),n=r(21),i=r(104),o=r(72),s=1..toFixed,l=Math.floor,u=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",d=function(e,t){for(var r=-1,a=t;++r<6;)a+=e*u[r],u[r]=a%1e7,a=l(a/1e7)},p=function(e){for(var t=6,r=0;--t>=0;)r+=u[t],u[t]=l(r/e),r=r%e*1e7},h=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var r=String(u[e]);t=""===t?r:t+o.call("0",7-r.length)+r}return t},f=function(e,t,r){return 0===t?r:t%2==1?f(e,t-1,r*e):f(e*e,t/2,r)};a(a.P+a.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(3)((function(){s.call({})}))),"Number",{toFixed:function(e){var t,r,a,s,l=i(this,c),u=n(e),g="",y="0";if(u<0||u>20)throw RangeError(c);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(l*f(2,69,1))-69)<0?l*f(2,-t,1):l/f(2,t,1),r*=4503599627370496,(t=52-t)>0){for(d(0,r),a=u;a>=7;)d(1e7,0),a-=7;for(d(f(10,a,1),0),a=t-1;a>=23;)p(1<<23),a-=23;p(1<<a),d(1,1),p(2),y=h()}else d(0,r),d(1<<-t,0),y=h()+o.call("0",u);return y=u>0?g+((s=y.length)<=u?"0."+o.call("0",u-s)+y:y.slice(0,s-u)+"."+y.slice(s-u)):g+y}})},function(e,t,r){"use strict";var a=r(1),n=r(3),i=r(104),o=1..toPrecision;a(a.P+a.F*(n((function(){return"1"!==o.call(1,void 0)}))||!n((function(){o.call({})}))),"Number",{toPrecision:function(e){var t=i(this,"Number#toPrecision: incorrect invocation!");return void 0===e?o.call(t):o.call(t,e)}})},function(e,t,r){var a=r(1);a(a.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,r){var a=r(1),n=r(2).isFinite;a(a.S,"Number",{isFinite:function(e){return"number"==typeof e&&n(e)}})},function(e,t,r){var a=r(1);a(a.S,"Number",{isInteger:r(105)})},function(e,t,r){var a=r(1);a(a.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,r){var a=r(1),n=r(105),i=Math.abs;a(a.S,"Number",{isSafeInteger:function(e){return n(e)&&i(e)<=9007199254740991}})},function(e,t,r){var a=r(1);a(a.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,r){var a=r(1);a(a.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,r){var a=r(1),n=r(103);a(a.S+a.F*(Number.parseFloat!=n),"Number",{parseFloat:n})},function(e,t,r){var a=r(1),n=r(102);a(a.S+a.F*(Number.parseInt!=n),"Number",{parseInt:n})},function(e,t,r){var a=r(1),n=r(106),i=Math.sqrt,o=Math.acosh;a(a.S+a.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:n(e-1+i(e-1)*i(e+1))}})},function(e,t,r){var a=r(1),n=Math.asinh;a(a.S+a.F*!(n&&1/n(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,r){var a=r(1),n=Math.atanh;a(a.S+a.F*!(n&&1/n(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,r){var a=r(1),n=r(73);a(a.S,"Math",{cbrt:function(e){return n(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,r){var a=r(1);a(a.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,r){var a=r(1),n=Math.exp;a(a.S,"Math",{cosh:function(e){return(n(e=+e)+n(-e))/2}})},function(e,t,r){var a=r(1),n=r(74);a(a.S+a.F*(n!=Math.expm1),"Math",{expm1:n})},function(e,t,r){var a=r(1);a(a.S,"Math",{fround:r(174)})},function(e,t,r){var a=r(73),n=Math.pow,i=n(2,-52),o=n(2,-23),s=n(2,127)*(2-o),l=n(2,-126);e.exports=Math.fround||function(e){var t,r,n=Math.abs(e),u=a(e);return n<l?u*(n/l/o+1/i-1/i)*l*o:(r=(t=(1+o/i)*n)-(t-n))>s||r!=r?u*(1/0):u*r}},function(e,t,r){var a=r(1),n=Math.abs;a(a.S,"Math",{hypot:function(e,t){for(var r,a,i=0,o=0,s=arguments.length,l=0;o<s;)l<(r=n(arguments[o++]))?(i=i*(a=l/r)*a+1,l=r):i+=r>0?(a=r/l)*a:r;return l===1/0?1/0:l*Math.sqrt(i)}})},function(e,t,r){var a=r(1),n=Math.imul;a(a.S+a.F*r(3)((function(){return-5!=n(4294967295,5)||2!=n.length})),"Math",{imul:function(e,t){var r=+e,a=+t,n=65535&r,i=65535&a;return 0|n*i+((65535&r>>>16)*i+n*(65535&a>>>16)<<16>>>0)}})},function(e,t,r){var a=r(1);a(a.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,r){var a=r(1);a(a.S,"Math",{log1p:r(106)})},function(e,t,r){var a=r(1);a(a.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,r){var a=r(1);a(a.S,"Math",{sign:r(73)})},function(e,t,r){var a=r(1),n=r(74),i=Math.exp;a(a.S+a.F*r(3)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(n(e)-n(-e))/2:(i(e-1)-i(-e-1))*(Math.E/2)}})},function(e,t,r){var a=r(1),n=r(74),i=Math.exp;a(a.S,"Math",{tanh:function(e){var t=n(e=+e),r=n(-e);return t==1/0?1:r==1/0?-1:(t-r)/(i(e)+i(-e))}})},function(e,t,r){var a=r(1);a(a.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,r){var a=r(1),n=r(34),i=String.fromCharCode,o=String.fromCodePoint;a(a.S+a.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(e){for(var t,r=[],a=arguments.length,o=0;a>o;){if(t=+arguments[o++],n(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?i(t):i(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}})},function(e,t,r){var a=r(1),n=r(17),i=r(7);a(a.S,"String",{raw:function(e){for(var t=n(e.raw),r=i(t.length),a=arguments.length,o=[],s=0;r>s;)o.push(String(t[s++])),s<a&&o.push(String(arguments[s]));return o.join("")}})},function(e,t,r){"use strict";r(41)("trim",(function(e){return function(){return e(this,3)}}))},function(e,t,r){"use strict";var a=r(75)(!0);r(76)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=a(t,r),this._i+=e.length,{value:e,done:!1})}))},function(e,t,r){"use strict";var a=r(1),n=r(75)(!1);a(a.P,"String",{codePointAt:function(e){return n(this,e)}})},function(e,t,r){"use strict";var a=r(1),n=r(7),i=r(77),o="".endsWith;a(a.P+a.F*r(79)("endsWith"),"String",{endsWith:function(e){var t=i(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,a=n(t.length),s=void 0===r?a:Math.min(n(r),a),l=String(e);return o?o.call(t,l,s):t.slice(s-l.length,s)===l}})},function(e,t,r){"use strict";var a=r(1),n=r(77);a(a.P+a.F*r(79)("includes"),"String",{includes:function(e){return!!~n(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){var a=r(1);a(a.P,"String",{repeat:r(72)})},function(e,t,r){"use strict";var a=r(1),n=r(7),i=r(77),o="".startsWith;a(a.P+a.F*r(79)("startsWith"),"String",{startsWith:function(e){var t=i(this,e,"startsWith"),r=n(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),a=String(e);return o?o.call(t,a,r):t.slice(r,r+a.length)===a}})},function(e,t,r){"use strict";r(13)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t,r){"use strict";r(13)("big",(function(e){return function(){return e(this,"big","","")}}))},function(e,t,r){"use strict";r(13)("blink",(function(e){return function(){return e(this,"blink","","")}}))},function(e,t,r){"use strict";r(13)("bold",(function(e){return function(){return e(this,"b","","")}}))},function(e,t,r){"use strict";r(13)("fixed",(function(e){return function(){return e(this,"tt","","")}}))},function(e,t,r){"use strict";r(13)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},function(e,t,r){"use strict";r(13)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},function(e,t,r){"use strict";r(13)("italics",(function(e){return function(){return e(this,"i","","")}}))},function(e,t,r){"use strict";r(13)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},function(e,t,r){"use strict";r(13)("small",(function(e){return function(){return e(this,"small","","")}}))},function(e,t,r){"use strict";r(13)("strike",(function(e){return function(){return e(this,"strike","","")}}))},function(e,t,r){"use strict";r(13)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t,r){"use strict";r(13)("sup",(function(e){return function(){return e(this,"sup","","")}}))},function(e,t,r){var a=r(1);a(a.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,r){"use strict";var a=r(1),n=r(11),i=r(28);a(a.P+a.F*r(3)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=n(this),r=i(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}})},function(e,t,r){var a=r(1),n=r(209);a(a.P+a.F*(Date.prototype.toISOString!==n),"Date",{toISOString:n})},function(e,t,r){"use strict";var a=r(3),n=Date.prototype.getTime,i=Date.prototype.toISOString,o=function(e){return e>9?e:"0"+e};e.exports=a((function(){return"0385-07-25T07:06:39.999Z"!=i.call(new Date(-50000000000001))}))||!a((function(){i.call(new Date(NaN))}))?function(){if(!isFinite(n.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),a=t<0?"-":t>9999?"+":"";return a+("00000"+Math.abs(t)).slice(a?-6:-4)+"-"+o(e.getUTCMonth()+1)+"-"+o(e.getUTCDate())+"T"+o(e.getUTCHours())+":"+o(e.getUTCMinutes())+":"+o(e.getUTCSeconds())+"."+(r>99?r:"0"+o(r))+"Z"}:i},function(e,t,r){var a=Date.prototype,n=a.toString,i=a.getTime;new Date(NaN)+""!="Invalid Date"&&r(12)(a,"toString",(function(){var e=i.call(this);return e==e?n.call(this):"Invalid Date"}))},function(e,t,r){var a=r(6)("toPrimitive"),n=Date.prototype;a in n||r(16)(n,a,r(212))},function(e,t,r){"use strict";var a=r(4),n=r(28);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return n(a(this),"number"!=e)}},function(e,t,r){var a=r(1);a(a.S,"Array",{isArray:r(54)})},function(e,t,r){"use strict";var a=r(19),n=r(1),i=r(11),o=r(108),s=r(80),l=r(7),u=r(81),c=r(82);n(n.S+n.F*!r(55)((function(e){Array.from(e)})),"Array",{from:function(e){var t,r,n,d,p=i(e),h="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,y=void 0!==g,m=0,v=c(p);if(y&&(g=a(g,f>2?arguments[2]:void 0,2)),null==v||h==Array&&s(v))for(r=new h(t=l(p.length));t>m;m++)u(r,m,y?g(p[m],m):p[m]);else for(d=v.call(p),r=new h;!(n=d.next()).done;m++)u(r,m,y?o(d,g,[n.value,m],!0):n.value);return r.length=m,r}})},function(e,t,r){"use strict";var a=r(1),n=r(81);a(a.S+a.F*r(3)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)n(r,e,arguments[e++]);return r.length=t,r}})},function(e,t,r){"use strict";var a=r(1),n=r(17),i=[].join;a(a.P+a.F*(r(47)!=Object||!r(18)(i)),"Array",{join:function(e){return i.call(n(this),void 0===e?",":e)}})},function(e,t,r){"use strict";var a=r(1),n=r(68),i=r(25),o=r(34),s=r(7),l=[].slice;a(a.P+a.F*r(3)((function(){n&&l.call(n)})),"Array",{slice:function(e,t){var r=s(this.length),a=i(this);if(t=void 0===t?r:t,"Array"==a)return l.call(this,e,t);for(var n=o(e,r),u=o(t,r),c=s(u-n),d=new Array(c),p=0;p<c;p++)d[p]="String"==a?this.charAt(n+p):this[n+p];return d}})},function(e,t,r){"use strict";var a=r(1),n=r(20),i=r(11),o=r(3),s=[].sort,l=[1,2,3];a(a.P+a.F*(o((function(){l.sort(void 0)}))||!o((function(){l.sort(null)}))||!r(18)(s)),"Array",{sort:function(e){return void 0===e?s.call(i(this)):s.call(i(this),n(e))}})},function(e,t,r){"use strict";var a=r(1),n=r(24)(0),i=r(18)([].forEach,!0);a(a.P+a.F*!i,"Array",{forEach:function(e){return n(this,e,arguments[1])}})},function(e,t,r){var a=r(5),n=r(54),i=r(6)("species");e.exports=function(e){var t;return n(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!n(t.prototype)||(t=void 0),a(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},function(e,t,r){"use strict";var a=r(1),n=r(24)(1);a(a.P+a.F*!r(18)([].map,!0),"Array",{map:function(e){return n(this,e,arguments[1])}})},function(e,t,r){"use strict";var a=r(1),n=r(24)(2);a(a.P+a.F*!r(18)([].filter,!0),"Array",{filter:function(e){return n(this,e,arguments[1])}})},function(e,t,r){"use strict";var a=r(1),n=r(24)(3);a(a.P+a.F*!r(18)([].some,!0),"Array",{some:function(e){return n(this,e,arguments[1])}})},function(e,t,r){"use strict";var a=r(1),n=r(24)(4);a(a.P+a.F*!r(18)([].every,!0),"Array",{every:function(e){return n(this,e,arguments[1])}})},function(e,t,r){"use strict";var a=r(1),n=r(110);a(a.P+a.F*!r(18)([].reduce,!0),"Array",{reduce:function(e){return n(this,e,arguments.length,arguments[1],!1)}})},function(e,t,r){"use strict";var a=r(1),n=r(110);a(a.P+a.F*!r(18)([].reduceRight,!0),"Array",{reduceRight:function(e){return n(this,e,arguments.length,arguments[1],!0)}})},function(e,t,r){"use strict";var a=r(1),n=r(52)(!1),i=[].indexOf,o=!!i&&1/[1].indexOf(1,-0)<0;a(a.P+a.F*(o||!r(18)(i)),"Array",{indexOf:function(e){return o?i.apply(this,arguments)||0:n(this,e,arguments[1])}})},function(e,t,r){"use strict";var a=r(1),n=r(17),i=r(21),o=r(7),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;a(a.P+a.F*(l||!r(18)(s)),"Array",{lastIndexOf:function(e){if(l)return s.apply(this,arguments)||0;var t=n(this),r=o(t.length),a=r-1;for(arguments.length>1&&(a=Math.min(a,i(arguments[1]))),a<0&&(a=r+a);a>=0;a--)if(a in t&&t[a]===e)return a||0;return-1}})},function(e,t,r){var a=r(1);a(a.P,"Array",{copyWithin:r(111)}),r(38)("copyWithin")},function(e,t,r){var a=r(1);a(a.P,"Array",{fill:r(83)}),r(38)("fill")},function(e,t,r){"use strict";var a=r(1),n=r(24)(5),i=!0;"find"in[]&&Array(1).find((function(){i=!1})),a(a.P+a.F*i,"Array",{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),r(38)("find")},function(e,t,r){"use strict";var a=r(1),n=r(24)(6),i="findIndex",o=!0;i in[]&&Array(1)[i]((function(){o=!1})),a(a.P+a.F*o,"Array",{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),r(38)(i)},function(e,t,r){r(43)("Array")},function(e,t,r){var a=r(2),n=r(71),i=r(10).f,o=r(36).f,s=r(78),l=r(56),u=a.RegExp,c=u,d=u.prototype,p=/a/g,h=/a/g,f=new u(p)!==p;if(r(9)&&(!f||r(3)((function(){return h[r(6)("match")]=!1,u(p)!=p||u(h)==h||"/a/i"!=u(p,"i")})))){u=function(e,t){var r=this instanceof u,a=s(e),i=void 0===t;return!r&&a&&e.constructor===u&&i?e:n(f?new c(a&&!i?e.source:e,t):c((a=e instanceof u)?e.source:e,a&&i?l.call(e):t),r?this:d,u)};for(var g=function(e){e in u||i(u,e,{configurable:!0,get:function(){return c[e]},set:function(t){c[e]=t}})},y=o(c),m=0;y.length>m;)g(y[m++]);d.constructor=u,u.prototype=d,r(12)(a,"RegExp",u)}r(43)("RegExp")},function(e,t,r){"use strict";r(114);var a=r(4),n=r(56),i=r(9),o=/./.toString,s=function(e){r(12)(RegExp.prototype,"toString",e,!0)};r(3)((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?s((function(){var e=a(this);return"/".concat(e.source,"/","flags"in e?e.flags:!i&&e instanceof RegExp?n.call(e):void 0)})):"toString"!=o.name&&s((function(){return o.call(this)}))},function(e,t,r){"use strict";var a=r(4),n=r(7),i=r(86),o=r(57);r(58)("match",1,(function(e,t,r,s){return[function(r){var a=e(this),n=null==r?void 0:r[t];return void 0!==n?n.call(r,a):new RegExp(r)[t](String(a))},function(e){var t=s(r,e,this);if(t.done)return t.value;var l=a(e),u=String(this);if(!l.global)return o(l,u);var c=l.unicode;l.lastIndex=0;for(var d,p=[],h=0;null!==(d=o(l,u));){var f=String(d[0]);p[h]=f,""===f&&(l.lastIndex=i(u,n(l.lastIndex),c)),h++}return 0===h?null:p}]}))},function(e,t,r){"use strict";var a=r(4),n=r(11),i=r(7),o=r(21),s=r(86),l=r(57),u=Math.max,c=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g;r(58)("replace",2,(function(e,t,r,f){return[function(a,n){var i=e(this),o=null==a?void 0:a[t];return void 0!==o?o.call(a,i,n):r.call(String(i),a,n)},function(e,t){var n=f(r,e,this,t);if(n.done)return n.value;var d=a(e),p=String(this),h="function"==typeof t;h||(t=String(t));var y=d.global;if(y){var m=d.unicode;d.lastIndex=0}for(var v=[];;){var _=l(d,p);if(null===_)break;if(v.push(_),!y)break;""===String(_[0])&&(d.lastIndex=s(p,i(d.lastIndex),m))}for(var k,E="",T=0,b=0;b<v.length;b++){_=v[b];for(var S=String(_[0]),A=u(c(o(_.index),p.length),0),C=[],P=1;P<_.length;P++)C.push(void 0===(k=_[P])?k:String(k));var w=_.groups;if(h){var x=[S].concat(C,A,p);void 0!==w&&x.push(w);var I=String(t.apply(void 0,x))}else I=g(S,p,A,C,w,t);A>=T&&(E+=p.slice(T,A)+I,T=A+S.length)}return E+p.slice(T)}];function g(e,t,a,i,o,s){var l=a+e.length,u=i.length,c=h;return void 0!==o&&(o=n(o),c=p),r.call(s,c,(function(r,n){var s;switch(n.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(l);case"<":s=o[n.slice(1,-1)];break;default:var c=+n;if(0===c)return r;if(c>u){var p=d(c/10);return 0===p?r:p<=u?void 0===i[p-1]?n.charAt(1):i[p-1]+n.charAt(1):r}s=i[c-1]}return void 0===s?"":s}))}}))},function(e,t,r){"use strict";var a=r(4),n=r(99),i=r(57);r(58)("search",1,(function(e,t,r,o){return[function(r){var a=e(this),n=null==r?void 0:r[t];return void 0!==n?n.call(r,a):new RegExp(r)[t](String(a))},function(e){var t=o(r,e,this);if(t.done)return t.value;var s=a(e),l=String(this),u=s.lastIndex;n(u,0)||(s.lastIndex=0);var c=i(s,l);return n(s.lastIndex,u)||(s.lastIndex=u),null===c?-1:c.index}]}))},function(e,t,r){"use strict";var a=r(78),n=r(4),i=r(50),o=r(86),s=r(7),l=r(57),u=r(85),c=r(3),d=Math.min,p=[].push,h="length",f=!c((function(){RegExp(4294967295,"y")}));r(58)("split",2,(function(e,t,r,c){var g;return g="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[h]||2!="ab".split(/(?:ab)*/)[h]||4!=".".split(/(.?)(.?)/)[h]||".".split(/()()/)[h]>1||"".split(/.?/)[h]?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!a(e))return r.call(n,e,t);for(var i,o,s,l=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,f=void 0===t?4294967295:t>>>0,g=new RegExp(e.source,c+"g");(i=u.call(g,n))&&!((o=g.lastIndex)>d&&(l.push(n.slice(d,i.index)),i[h]>1&&i.index<n[h]&&p.apply(l,i.slice(1)),s=i[0][h],d=o,l[h]>=f));)g.lastIndex===i.index&&g.lastIndex++;return d===n[h]?!s&&g.test("")||l.push(""):l.push(n.slice(d)),l[h]>f?l.slice(0,f):l}:"0".split(void 0,0)[h]?function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)}:r,[function(r,a){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n,a):g.call(String(n),r,a)},function(e,t){var a=c(g,e,this,t,g!==r);if(a.done)return a.value;var u=n(e),p=String(this),h=i(u,RegExp),y=u.unicode,m=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(f?"y":"g"),v=new h(f?u:"^(?:"+u.source+")",m),_=void 0===t?4294967295:t>>>0;if(0===_)return[];if(0===p.length)return null===l(v,p)?[p]:[];for(var k=0,E=0,T=[];E<p.length;){v.lastIndex=f?E:0;var b,S=l(v,f?p:p.slice(E));if(null===S||(b=d(s(v.lastIndex+(f?0:E)),p.length))===k)E=o(p,E,y);else{if(T.push(p.slice(k,E)),T.length===_)return T;for(var A=1;A<=S.length-1;A++)if(T.push(S[A]),T.length===_)return T;E=k=b}}return T.push(p.slice(k)),T}]}))},function(e,t,r){var a=r(2),n=r(87).set,i=a.MutationObserver||a.WebKitMutationObserver,o=a.process,s=a.Promise,l="process"==r(25)(o);e.exports=function(){var e,t,r,u=function(){var a,n;for(l&&(a=o.domain)&&a.exit();e;){n=e.fn,e=e.next;try{n()}catch(a){throw e?r():t=void 0,a}}t=void 0,a&&a.enter()};if(l)r=function(){o.nextTick(u)};else if(!i||a.navigator&&a.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);r=function(){c.then(u)}}else r=function(){n.call(a,u)};else{var d=!0,p=document.createTextNode("");new i(u).observe(p,{characterData:!0}),r=function(){p.data=d=!d}}return function(a){var n={fn:a,next:void 0};t&&(t.next=n),e||(e=n,r()),t=n}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){"use strict";var a=r(118),n=r(39);e.exports=r(61)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=a.getEntry(n(this,"Map"),e);return t&&t.v},set:function(e,t){return a.def(n(this,"Map"),0===e?0:e,t)}},a,!0)},function(e,t,r){"use strict";var a=r(118),n=r(39);e.exports=r(61)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return a.def(n(this,"Set"),e=0===e?0:e,e)}},a)},function(e,t,r){"use strict";var a,n=r(2),i=r(24)(0),o=r(12),s=r(29),l=r(98),u=r(119),c=r(5),d=r(39),p=r(39),h=!n.ActiveXObject&&"ActiveXObject"in n,f=s.getWeak,g=Object.isExtensible,y=u.ufstore,m=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(e){if(c(e)){var t=f(e);return!0===t?y(d(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(d(this,"WeakMap"),e,t)}},_=e.exports=r(61)("WeakMap",m,v,u,!0,!0);p&&h&&(l((a=u.getConstructor(m,"WeakMap")).prototype,v),s.NEED=!0,i(["delete","has","get","set"],(function(e){var t=_.prototype,r=t[e];o(t,e,(function(t,n){if(c(t)&&!g(t)){this._f||(this._f=new a);var i=this._f[e](t,n);return"set"==e?this:i}return r.call(this,t,n)}))})))},function(e,t,r){"use strict";var a=r(119),n=r(39);r(61)("WeakSet",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return a.def(n(this,"WeakSet"),e,!0)}},a,!1,!0)},function(e,t,r){"use strict";var a=r(1),n=r(62),i=r(88),o=r(4),s=r(34),l=r(7),u=r(5),c=r(2).ArrayBuffer,d=r(50),p=i.ArrayBuffer,h=i.DataView,f=n.ABV&&c.isView,g=p.prototype.slice,y=n.VIEW;a(a.G+a.W+a.F*(c!==p),{ArrayBuffer:p}),a(a.S+a.F*!n.CONSTR,"ArrayBuffer",{isView:function(e){return f&&f(e)||u(e)&&y in e}}),a(a.P+a.U+a.F*r(3)((function(){return!new p(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(e,t){if(void 0!==g&&void 0===t)return g.call(o(this),e);for(var r=o(this).byteLength,a=s(e,r),n=s(void 0===t?r:t,r),i=new(d(this,p))(l(n-a)),u=new h(this),c=new h(i),f=0;a<n;)c.setUint8(f++,u.getUint8(a++));return i}}),r(43)("ArrayBuffer")},function(e,t,r){var a=r(1);a(a.G+a.W+a.F*!r(62).ABV,{DataView:r(88).DataView})},function(e,t,r){r(27)("Int8",1,(function(e){return function(t,r,a){return e(this,t,r,a)}}))},function(e,t,r){r(27)("Uint8",1,(function(e){return function(t,r,a){return e(this,t,r,a)}}))},function(e,t,r){r(27)("Uint8",1,(function(e){return function(t,r,a){return e(this,t,r,a)}}),!0)},function(e,t,r){r(27)("Int16",2,(function(e){return function(t,r,a){return e(this,t,r,a)}}))},function(e,t,r){r(27)("Uint16",2,(function(e){return function(t,r,a){return e(this,t,r,a)}}))},function(e,t,r){r(27)("Int32",4,(function(e){return function(t,r,a){return e(this,t,r,a)}}))},function(e,t,r){r(27)("Uint32",4,(function(e){return function(t,r,a){return e(this,t,r,a)}}))},function(e,t,r){r(27)("Float32",4,(function(e){return function(t,r,a){return e(this,t,r,a)}}))},function(e,t,r){r(27)("Float64",8,(function(e){return function(t,r,a){return e(this,t,r,a)}}))},function(e,t,r){var a=r(1),n=r(20),i=r(4),o=(r(2).Reflect||{}).apply,s=Function.apply;a(a.S+a.F*!r(3)((function(){o((function(){}))})),"Reflect",{apply:function(e,t,r){var a=n(e),l=i(r);return o?o(a,t,l):s.call(a,t,l)}})},function(e,t,r){var a=r(1),n=r(35),i=r(20),o=r(4),s=r(5),l=r(3),u=r(100),c=(r(2).Reflect||{}).construct,d=l((function(){function e(){}return!(c((function(){}),[],e)instanceof e)})),p=!l((function(){c((function(){}))}));a(a.S+a.F*(d||p),"Reflect",{construct:function(e,t){i(e),o(t);var r=arguments.length<3?e:i(arguments[2]);if(p&&!d)return c(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var a=[null];return a.push.apply(a,t),new(u.apply(e,a))}var l=r.prototype,h=n(s(l)?l:Object.prototype),f=Function.apply.call(e,h,t);return s(f)?f:h}})},function(e,t,r){var a=r(10),n=r(1),i=r(4),o=r(28);n(n.S+n.F*r(3)((function(){Reflect.defineProperty(a.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,r){i(e),t=o(t,!0),i(r);try{return a.f(e,t,r),!0}catch(e){return!1}}})},function(e,t,r){var a=r(1),n=r(22).f,i=r(4);a(a.S,"Reflect",{deleteProperty:function(e,t){var r=n(i(e),t);return!(r&&!r.configurable)&&delete e[t]}})},function(e,t,r){"use strict";var a=r(1),n=r(4),i=function(e){this._t=n(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};r(107)(i,"Object",(function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}})),a(a.S,"Reflect",{enumerate:function(e){return new i(e)}})},function(e,t,r){var a=r(22),n=r(37),i=r(15),o=r(1),s=r(5),l=r(4);o(o.S,"Reflect",{get:function e(t,r){var o,u,c=arguments.length<3?t:arguments[2];return l(t)===c?t[r]:(o=a.f(t,r))?i(o,"value")?o.value:void 0!==o.get?o.get.call(c):void 0:s(u=n(t))?e(u,r,c):void 0}})},function(e,t,r){var a=r(22),n=r(1),i=r(4);n(n.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return a.f(i(e),t)}})},function(e,t,r){var a=r(1),n=r(37),i=r(4);a(a.S,"Reflect",{getPrototypeOf:function(e){return n(i(e))}})},function(e,t,r){var a=r(1);a(a.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,r){var a=r(1),n=r(4),i=Object.isExtensible;a(a.S,"Reflect",{isExtensible:function(e){return n(e),!i||i(e)}})},function(e,t,r){var a=r(1);a(a.S,"Reflect",{ownKeys:r(121)})},function(e,t,r){var a=r(1),n=r(4),i=Object.preventExtensions;a(a.S,"Reflect",{preventExtensions:function(e){n(e);try{return i&&i(e),!0}catch(e){return!1}}})},function(e,t,r){var a=r(10),n=r(22),i=r(37),o=r(15),s=r(1),l=r(30),u=r(4),c=r(5);s(s.S,"Reflect",{set:function e(t,r,s){var d,p,h=arguments.length<4?t:arguments[3],f=n.f(u(t),r);if(!f){if(c(p=i(t)))return e(p,r,s,h);f=l(0)}if(o(f,"value")){if(!1===f.writable||!c(h))return!1;if(d=n.f(h,r)){if(d.get||d.set||!1===d.writable)return!1;d.value=s,a.f(h,r,d)}else a.f(h,r,l(0,s));return!0}return void 0!==f.set&&(f.set.call(h,s),!0)}})},function(e,t,r){var a=r(1),n=r(69);n&&a(a.S,"Reflect",{setPrototypeOf:function(e,t){n.check(e,t);try{return n.set(e,t),!0}catch(e){return!1}}})},function(e,t,r){r(272),e.exports=r(8).Array.includes},function(e,t,r){"use strict";var a=r(1),n=r(52)(!0);a(a.P,"Array",{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),r(38)("includes")},function(e,t,r){r(274),e.exports=r(8).Array.flatMap},function(e,t,r){"use strict";var a=r(1),n=r(275),i=r(11),o=r(7),s=r(20),l=r(109);a(a.P,"Array",{flatMap:function(e){var t,r,a=i(this);return s(e),t=o(a.length),r=l(a,0),n(r,a,a,t,0,1,e,arguments[1]),r}}),r(38)("flatMap")},function(e,t,r){"use strict";var a=r(54),n=r(5),i=r(7),o=r(19),s=r(6)("isConcatSpreadable");e.exports=function e(t,r,l,u,c,d,p,h){for(var f,g,y=c,m=0,v=!!p&&o(p,h,3);m<u;){if(m in l){if(f=v?v(l[m],m,r):l[m],g=!1,n(f)&&(g=void 0!==(g=f[s])?!!g:a(f)),g&&d>0)y=e(t,r,f,i(f.length),y,d-1)-1;else{if(y>=9007199254740991)throw TypeError();t[y]=f}y++}m++}return y}},function(e,t,r){r(277),e.exports=r(8).String.padStart},function(e,t,r){"use strict";var a=r(1),n=r(122),i=r(60),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(i);a(a.P+a.F*o,"String",{padStart:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,r){r(279),e.exports=r(8).String.padEnd},function(e,t,r){"use strict";var a=r(1),n=r(122),i=r(60),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(i);a(a.P+a.F*o,"String",{padEnd:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,r){r(281),e.exports=r(8).String.trimLeft},function(e,t,r){"use strict";r(41)("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart")},function(e,t,r){r(283),e.exports=r(8).String.trimRight},function(e,t,r){"use strict";r(41)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},function(e,t,r){r(285),e.exports=r(65).f("asyncIterator")},function(e,t,r){r(94)("asyncIterator")},function(e,t,r){r(287),e.exports=r(8).Object.getOwnPropertyDescriptors},function(e,t,r){var a=r(1),n=r(121),i=r(17),o=r(22),s=r(81);a(a.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,a=i(e),l=o.f,u=n(a),c={},d=0;u.length>d;)void 0!==(r=l(a,t=u[d++]))&&s(c,t,r);return c}})},function(e,t,r){r(289),e.exports=r(8).Object.values},function(e,t,r){var a=r(1),n=r(123)(!1);a(a.S,"Object",{values:function(e){return n(e)}})},function(e,t,r){r(291),e.exports=r(8).Object.entries},function(e,t,r){var a=r(1),n=r(123)(!0);a(a.S,"Object",{entries:function(e){return n(e)}})},function(e,t,r){"use strict";r(115),r(293),e.exports=r(8).Promise.finally},function(e,t,r){"use strict";var a=r(1),n=r(8),i=r(2),o=r(50),s=r(117);a(a.P+a.R,"Promise",{finally:function(e){var t=o(this,n.Promise||i.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then((function(){return r}))}:e,r?function(r){return s(t,e()).then((function(){throw r}))}:e)}})},function(e,t,r){r(295),r(296),r(297),e.exports=r(8)},function(e,t,r){var a=r(2),n=r(1),i=r(60),o=[].slice,s=/MSIE .\./.test(i),l=function(e){return function(t,r){var a=arguments.length>2,n=!!a&&o.call(arguments,2);return e(a?function(){("function"==typeof t?t:Function(t)).apply(this,n)}:t,r)}};n(n.G+n.B+n.F*s,{setTimeout:l(a.setTimeout),setInterval:l(a.setInterval)})},function(e,t,r){var a=r(1),n=r(87);a(a.G+a.B,{setImmediate:n.set,clearImmediate:n.clear})},function(e,t,r){for(var a=r(84),n=r(33),i=r(12),o=r(2),s=r(16),l=r(42),u=r(6),c=u("iterator"),d=u("toStringTag"),p=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=n(h),g=0;g<f.length;g++){var y,m=f[g],v=h[m],_=o[m],k=_&&_.prototype;if(k&&(k[c]||s(k,c,p),k[d]||s(k,d,m),l[m]=p,v))for(y in a)k[y]||i(k,y,a[y],!0)}},function(e,t,r){var a=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),s=new A(n||[]);return a(o,"_invoke",{value:E(e,r,s)}),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function p(){}function h(){}function f(){}var g={};l(g,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(C([])));m&&m!==t&&r.call(m,i)&&(g=m);var v=f.prototype=p.prototype=Object.create(g);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){var n;a(this,"_invoke",{value:function(a,i){function o(){return new t((function(n,o){!function a(n,i,o,s){var l=c(e[n],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,o,s)}),(function(e){a("throw",e,o,s)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return a("throw",e,o,s)}))}s(l.arg)}(a,i,n,o)}))}return n=n?n.then(o,o):o()}})}function E(e,t,r){var a="suspendedStart";return function(n,i){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===n)throw i;return P()}for(r.method=n,r.arg=i;;){var o=r.delegate;if(o){var s=T(o,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===a)throw a="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a="executing";var l=c(e,t,r);if("normal"===l.type){if(a=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a="completed",r.method="throw",r.arg=l.arg)}}}function T(e,t){var r=t.method,a=e.iterator[r];if(void 0===a)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var n=c(a,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,n=function t(){for(;++a<e.length;)if(r.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=f,a(v,"constructor",{value:f,configurable:!0}),a(f,"constructor",{value:h,configurable:!0}),h.displayName=l(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},_(k.prototype),l(k.prototype,o,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new k(u(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(v),l(v,s,"Generator"),l(v,i,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var a in t)r.push(a);return r.reverse(),function e(){for(;r.length;){var a=r.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},e.values=C,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(r,a){return o.type="throw",o.arg=e,t.next=r,a&&(t.method="next",t.arg=void 0),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],o=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var n=a.arg;S(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}(e.exports);try{regeneratorRuntime=a}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}},function(e,t,r){r(300),e.exports=r(124).global},function(e,t,r){var a=r(301);a(a.G,{global:r(89)})},function(e,t,r){var a=r(89),n=r(124),i=r(302),o=r(304),s=r(311),l=function(e,t,r){var u,c,d,p=e&l.F,h=e&l.G,f=e&l.S,g=e&l.P,y=e&l.B,m=e&l.W,v=h?n:n[t]||(n[t]={}),_=v.prototype,k=h?a:f?a[t]:(a[t]||{}).prototype;for(u in h&&(r=t),r)(c=!p&&k&&void 0!==k[u])&&s(v,u)||(d=c?k[u]:r[u],v[u]=h&&"function"!=typeof k[u]?r[u]:y&&c?i(d,a):m&&k[u]==d?function(e){var t=function(t,r,a){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,a)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):g&&"function"==typeof d?i(Function.call,d):d,g&&((v.virtual||(v.virtual={}))[u]=d,e&l.R&&_&&!_[u]&&o(_,u,d)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,r){var a=r(303);e.exports=function(e,t,r){if(a(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,a){return e.call(t,r,a)};case 3:return function(r,a,n){return e.call(t,r,a,n)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){var a=r(305),n=r(310);e.exports=r(91)?function(e,t,r){return a.f(e,t,n(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var a=r(306),n=r(307),i=r(309),o=Object.defineProperty;t.f=r(91)?Object.defineProperty:function(e,t,r){if(a(e),t=i(t,!0),a(r),n)try{return o(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var a=r(90);e.exports=function(e){if(!a(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){e.exports=!r(91)&&!r(125)((function(){return 7!=Object.defineProperty(r(308)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var a=r(90),n=r(89).document,i=a(n)&&a(n.createElement);e.exports=function(e){return i?n.createElement(e):{}}},function(e,t,r){var a=r(90);e.exports=function(e,t){if(!a(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!a(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!a(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!a(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){"use strict";(function(e){var t=r(46);var a,n,i,o=function(){function t(){}return t.install=function(){if(!e.performance||!e.performance.now){var t=Date.now();e.performance||(e.performance={}),e.performance.now=function(){return Date.now()-t}}},t}();a=o,i="performance.now",(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n="id"))in a?Object.defineProperty(a,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[n]=i,t.a.register(o)}).call(this,r(92))},function(e,t,r){(function(e,t){var r;(r=void 0!==e&&"[object process]"==={}.toString.call(e)||"undefined"!=typeof navigator&&"ReactNative"===navigator.product?t:self).Proxy||(r.Proxy=function(){function e(){return null}function t(e){return!!e&&("object"==typeof e||"function"==typeof e)}function r(e){if(null!==e&&!t(e))throw new TypeError("Object prototype may only be an Object or null: "+e)}var a=null,n=Object,i=!(!n.create&&{__proto__:null}instanceof n),o=n.create||(i?function(e){return r(e),{__proto__:e}}:function(e){function t(){}if(r(e),null===e)throw new SyntaxError("Native Object.create is required to create objects with null prototype");return t.prototype=e,new t}),s=n.getPrototypeOf||([].__proto__===Array.prototype?function(e){return t(e=e.__proto__)?e:null}:e),l=function(u,c){function d(){}if(void 0===(this&&this instanceof l?this.constructor:void 0))throw new TypeError("Constructor Proxy requires 'new'");if(!t(u)||!t(c))throw new TypeError("Cannot create proxy with a non-object as target or handler");a=function(){u=null,d=function(e){throw new TypeError("Cannot perform '"+e+"' on a proxy that has been revoked")}},setTimeout((function(){a=null}),0);var p=c;for(var h in c={get:null,set:null,apply:null,construct:null},p){if(!(h in c))throw new TypeError("Proxy polyfill does not support trap '"+h+"'");c[h]=p[h]}"function"==typeof p&&(c.apply=p.apply.bind(p)),p=s(u);var f=!1,g=!1;if("function"==typeof u){var y=function(){var e=this&&this.constructor===y,t=Array.prototype.slice.call(arguments);return d(e?"construct":"apply"),e&&c.construct?c.construct.call(this,u,t):!e&&c.apply?c.apply(u,this,t):e?(t.unshift(u),new(u.bind.apply(u,t))):u.apply(this,t)};f=!0}else u instanceof Array?(y=[],g=!0):y=i||null!==p?o(p):{};var m=c.get?function(e){return d("get"),c.get(this,e,y)}:function(e){return d("get"),this[e]},v=c.set?function(e,t){d("set"),c.set(this,e,t,y)}:function(e,t){d("set"),this[e]=t},_={};if(n.getOwnPropertyNames(u).forEach((function(e){if(!f&&!g||!(e in y)){var t=n.getOwnPropertyDescriptor(u,e);n.defineProperty(y,e,{enumerable:!!t.enumerable,get:m.bind(u,e),set:v.bind(u,e)}),_[e]=!0}})),h=!0,f||g){var k=n.setPrototypeOf||([].__proto__===Array.prototype?function(e,t){return r(t),e.__proto__=t,e}:e);p&&k(y,p)||(h=!1)}if(c.get||!h)for(var E in u)_[E]||n.defineProperty(y,E,{get:m.bind(u,E)});return n.seal(u),n.seal(y),y};return l.revocable=function(e,t){return{proxy:new l(e,t),revoke:a}},l}(),r.Proxy.revocable=r.Proxy.revocable)}).call(this,r(314),r(92))},function(e,t){var r,a,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var l,u=[],c=!1,d=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&h())}function h(){if(!c){var e=s(p);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||c||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,r){var a,n;window,e.exports=(a=r(0),n=r(316),function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t){e.exports=a},function(e,t){e.exports=n},function(e){e.exports=JSON.parse('{"recoverDecodingErrorDelay":3000,"recoverSwapAudioCodecDelay":3000,"abr":{"enabled":true,"restrictions":{}},"hlsConfig":{"fragLoadingMaxRetry":4,"maxMaxBufferLength":60},"network":{}}')},function(e,t,r){"use strict";r.r(t),r.d(t,"VERSION",(function(){return _})),r.d(t,"NAME",(function(){return k}));var a,n,i,o,s=r(0),l=r(1),u=r.n(l),c=r(2),d=((a={})[u.a.ErrorDetails.MANIFEST_LOAD_ERROR]={category:s.Error.Category.MANIFEST,code:s.Error.Code.HTTP_ERROR},a[u.a.ErrorDetails.MANIFEST_LOAD_TIMEOUT]={category:s.Error.Category.MANIFEST,code:s.Error.Code.TIMEOUT},a[u.a.ErrorDetails.MANIFEST_PARSING_ERROR]={category:s.Error.Category.MANIFEST,code:s.Error.Code.HLSJS_CANNOT_PARSE},a[u.a.ErrorDetails.LEVEL_LOAD_ERROR]={category:s.Error.Category.NETWORK,code:s.Error.Code.HTTP_ERROR},a[u.a.ErrorDetails.LEVEL_LOAD_TIMEOUT]={category:s.Error.Category.NETWORK,code:s.Error.Code.TIMEOUT},a[u.a.ErrorDetails.LEVEL_SWITCH_ERROR]={category:s.Error.Category.PLAYER,code:s.Error.Code.BITRATE_SWITCH_ISSUE},a[u.a.ErrorDetails.FRAG_LOAD_ERROR]={category:s.Error.Category.NETWORK,code:s.Error.Code.HTTP_ERROR},a[u.a.ErrorDetails.FRAG_LOOP_LOADING_ERROR]={category:s.Error.Category.NETWORK,code:s.Error.Code.HTTP_ERROR},a[u.a.ErrorDetails.FRAG_LOAD_TIMEOUT]={category:s.Error.Category.NETWORK,code:s.Error.Code.TIMEOUT},a[u.a.ErrorDetails.FRAG_PARSING_ERROR]={category:s.Error.Category.MEDIA,code:s.Error.Code.HLS_FRAG_PARSING_ERROR},a[u.a.ErrorDetails.BUFFER_APPEND_ERROR]={category:s.Error.Category.MEDIA,code:s.Error.Code.HLS_BUFFER_APPEND_ISSUE},a[u.a.ErrorDetails.BUFFER_APPENDING_ERROR]={category:s.Error.Category.MEDIA,code:s.Error.Code.HLS_BUFFER_APPENDING_ISSUE},a[u.a.ErrorDetails.BUFFER_STALLED_ERROR]={category:s.Error.Category.MEDIA,code:s.Error.Code.HLS_BUFFER_STALLED_ERROR},a),p=function(e){var t,r;function a(t){var r;return r=e.call(this,t)||this,t&&t.readystatechange&&(r.readystatechange=t.readystatechange),r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.loadInternal=function(){var e,t=this,r=this.context;e=this.loader=new XMLHttpRequest;var a=this.stats;a.tfirst=0,a.loaded=0;var n,i=this.xhrSetup;try{if(i)try{n=i(e,r.url,r)}catch(t){e.open("GET",r.url,!0),n=i(e,r.url,r)}e.readyState||e.open("GET",r.url,!0)}catch(e){n=Promise.reject(e)}(n=n||Promise.resolve()).then((function(){r.rangeEnd&&e.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1)),e.onreadystatechange=t.readystatechange.bind(t),e.onprogress=t.loadprogress.bind(t),e.responseType=r.responseType,t.requestTimeout=window.setTimeout(t.loadtimeout.bind(t),t.config.timeout),e.send()})).catch((function(a){t.callbacks.onError({code:e.status,text:a.message},r,e)}))},a}(u.a.DefaultConfig.loader),h=function(e){var t,r;function a(t){var r,n=(r=e.call(this,t)||this).load.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),i=a.redirectExternalStreamsHandler;return r.load=function(e,t,r){var o=e.url;"manifest"===e.type?s.Utils.Http.jsonp(o,i,{timeout:a.redirectExternalStreamsTimeout}).then((function(a){e.url=a,n(e,t,r)})).catch((function(){return n(e,t,r)})):n(e,t,r)},r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a}(p);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function g(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}o=function(e,t){return t},(i="redirectExternalStreamsHandler")in(n=h)?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o;var v=function(e){var t,r;function a(t,r,n){var i,o;return a._logger.debug("Creating adapter. Hls version: "+u.a.version),m(y(o=e.call(this,t,r,n)||this),"_hlsjsLib",u.a),m(y(o),"_triedReloadWithRedirect",!1),m(y(o),"_playerTracks",[]),m(y(o),"_startTime",0),m(y(o),"_requestFilterError",!1),m(y(o),"_responseFilterError",!1),m(y(o),"_nativeTextTracksMap",{}),m(y(o),"_lastLoadedFragSN",-1),m(y(o),"_sameFragSNLoadedCount",0),m(y(o),"_adapterEventsBindings",((i={})[u.a.Events.ERROR]=function(e,t){return o._onError(t)},i[u.a.Events.MANIFEST_LOADED]=function(e,t){return o._onManifestLoaded(t)},i[u.a.Events.LEVEL_SWITCHED]=function(e,t){return o._onLevelSwitched(e,t)},i[u.a.Events.AUDIO_TRACK_SWITCHED]=function(e,t){return o._onAudioTrackSwitched(e,t)},i[u.a.Events.FPS_DROP]=function(e,t){return o._onFpsDrop(t)},i[u.a.Events.FRAG_PARSING_METADATA]=function(e,t){return o._onFragParsingMetadata(t)},i[u.a.Events.FRAG_LOADED]=function(e,t){return o._onFragLoaded(t)},i[u.a.Events.MEDIA_ATTACHED]=function(){return o._onMediaAttached()},i[u.a.Events.LEVEL_LOADED]=function(e,t){return o._onLevelLoaded(e,t)},i)),m(y(o),"_onLevelLoaded",(function(e,t){if(o.isLive()){var r=t.details.endSN;if(o._lastLoadedFragSN===r){if(o._sameFragSNLoadedCount++,a._logger.debug("Same frag SN. Count is: "+o._sameFragSNLoadedCount+", Max is: "+o._config.network.maxStaleLevelReloads),o._sameFragSNLoadedCount>=o._config.network.maxStaleLevelReloads){a._logger.error("Same frag loading reached max count");var n=new s.Error(s.Error.Severity.CRITICAL,s.Error.Category.NETWORK,s.Error.Code.LIVE_MANIFEST_REFRESH_ERROR,{fragSN:r});return o._trigger(s.EventType.ERROR,n),o.destroy()}a._logger.debug("Last frag SN is: "+r)}else o._sameFragSNLoadedCount=0;o._lastLoadedFragSN=r}})),o._config=s.Utils.Object.mergeDeep({},c,o._config),o._init(),o}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.createAdapter=function(e,t,r){var n=s.Utils.Object.copyDeep(c);if(s.Utils.Object.hasPropertyPath(r,"sources.options")){var i=r.sources.options;n.forceRedirectExternalStreams=i.forceRedirectExternalStreams,n.redirectExternalStreamsHandler=i.redirectExternalStreamsHandler,n.redirectExternalStreamsTimeout=i.redirectExternalStreamsTimeout,h.redirectExternalStreamsHandler=n.redirectExternalStreamsHandler,h.redirectExternalStreamsTimeout=n.redirectExternalStreamsTimeout}if(s.Utils.Object.hasPropertyPath(r,"sources.startTime")&&s.Utils.Object.getPropertyPath(r,"sources.startTime")>-1&&(n.hlsConfig.startPosition=r.sources.startTime),s.Utils.Object.hasPropertyPath(r,"text.useNativeTextTrack")&&(n.subtitleDisplay=s.Utils.Object.getPropertyPath(r,"text.useNativeTextTrack")),s.Utils.Object.hasPropertyPath(r,"abr.fpsDroppedFramesInterval")&&(n.hlsConfig.fpsDroppedFramesInterval=r.abr.fpsDroppedFramesInterval),s.Utils.Object.hasPropertyPath(r,"abr.fpsDroppedMonitoringThreshold")&&(n.hlsConfig.fpsDroppedMonitoringThreshold=r.abr.fpsDroppedMonitoringThreshold),s.Utils.Object.hasPropertyPath(r,"abr.capLevelOnFPSDrop")&&(a._logger.debug("capLevelOnFPSDrop = ",r.abr.capLevelOnFPSDrop),n.hlsConfig.capLevelOnFPSDrop=r.abr.capLevelOnFPSDrop),s.Utils.Object.hasPropertyPath(r,"text")&&(n.hlsConfig.enableCEA708Captions=r.text.enableCEA708Captions,n.hlsConfig.captionsTextTrack1Label=r.text.captionsTextTrack1Label,n.hlsConfig.captionsTextTrack1LanguageCode=r.text.captionsTextTrack1LanguageCode,n.hlsConfig.captionsTextTrack2Label=r.text.captionsTextTrack2Label,n.hlsConfig.captionsTextTrack2LanguageCode=r.text.captionsTextTrack2LanguageCode),s.Utils.Object.hasPropertyPath(r,"abr")){var o=r.abr;"boolean"==typeof o.enabled&&(n.abr.enabled=o.enabled),"boolean"==typeof o.capLevelToPlayerSize&&(n.hlsConfig.capLevelToPlayerSize=o.capLevelToPlayerSize),o.defaultBandwidthEstimate&&(n.hlsConfig.abrEwmaDefaultEstimate=o.defaultBandwidthEstimate),o.restrictions&&s.Utils.Object.createPropertyPath(n,"abr.restrictions",o.restrictions)}return s.Utils.Object.hasPropertyPath(r,"streaming.lowLatencyMode")&&(n.hlsConfig.lowLatencyMode=s.Utils.Object.getPropertyPath(r,"streaming.lowLatencyMode")),s.Utils.Object.hasPropertyPath(r,"playback.options.html5.hls")&&s.Utils.Object.mergeDeep(n.hlsConfig,r.playback.options.html5.hls),n.network=r.network,new this(e,t,n)},a.canPlayType=function(e){var t="string"==typeof e&&a._hlsMimeTypes.includes(e.toLowerCase())&&a.isMSESupported();return a._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t},a.canPlayDrm=function(){return a._logger.warn("canPlayDrm result is false"),!1},a.isSupported=function(){var e=u.a.isSupported();return a._logger.debug("isSupported:"+e),e};var n,i,o=a.prototype;return o._init=function(){this._config.forceRedirectExternalStreams&&(this._config.hlsConfig.pLoader=h),this._maybeSetFilters(),this._hls=new u.a(this._config.hlsConfig),this._capabilities.fpsControl=!0,this._hls.subtitleDisplay=this._config.subtitleDisplay,this._addBindings()},o._maybeSetFilters=function(){var e=this;if("function"==typeof s.Utils.Object.getPropertyPath(this._config,"network.requestFilter")&&(a._logger.debug("Register request filter"),s.Utils.Object.mergeDeep(this._config.hlsConfig,{loader:p,xhrSetup:function(t,r,a){var n,i={url:r,body:null,headers:{}};try{"manifest"===a.type&&(n=e._config.network.requestFilter(s.RequestType.MANIFEST,i)),a.frag&&"subtitle"!==a.frag.type&&(n=e._config.network.requestFilter(s.RequestType.SEGMENT,i))}catch(e){n=Promise.reject(e)}return(n=n||Promise.resolve(i)).then((function(e){a.url=e.url,t.open("GET",e.url,!0),Object.entries(e.headers).forEach((function(e){t.setRequestHeader.apply(t,e)})),"boolean"==typeof e.withCredentials&&(t.withCredentials=e.withCredentials)})).catch((function(t){throw e._requestFilterError=!0,t}))}})),"function"==typeof s.Utils.Object.getPropertyPath(this._config,"network.responseFilter")){var t=this;a._logger.debug("Register response filter"),s.Utils.Object.mergeDeep(this._config.hlsConfig,{loader:p,readystatechange:function(e){var r=this,n=e.currentTarget,i=n.readyState,o=this.stats,l=this.context,u=this.config;if(!o.aborted&&i>=2){window.clearTimeout(this.requestTimeout);var c=o.loading;if(0===c.first&&(c.first=Math.max(performance.now(),c.start)),4===i){var d=n.status;if(d>=200&&d<300){var p,h;c.end=Math.max(o.tfirst,performance.now()),h="arraybuffer"===l.responseType?(p=n.response).byteLength:(p=n.responseText).length,o.loaded=o.total=h;var f,g={url:n.responseURL,originalUrl:l.url,data:p,headers:s.Utils.Http.convertHeadersToDictionary(n.getAllResponseHeaders())};try{"manifest"===l.type&&(f=t._config.network.responseFilter(s.RequestType.MANIFEST,g)),l.frag&&"subtitle"!==l.frag.type&&(f=t._config.network.responseFilter(s.RequestType.SEGMENT,g))}catch(e){f=Promise.reject(e)}return(f=f||Promise.resolve(g)).then((function(e){r.callbacks.onSuccess(e,o,l,n)})).catch((function(e){t._responseFilterError=!0,r.callbacks.onError({code:d,text:e.message},l,n)}))}o.retry>=u.maxRetry||d>=400&&d<499?(a._logger.error(d+" while loading "+l.url),this.callbacks.onError({code:d,text:n.statusText},l,n)):(a._logger.warn(d+" while loading "+l.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,u.maxRetryDelay),o.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),u.timeout)}}})}},o._addBindings=function(){var e=this;this._mediaAttachedPromise=new Promise((function(t){return e._onMediaAttached=t}));for(var t=0,r=Object.entries(this._adapterEventsBindings);t<r.length;t++){var a=r[t],n=a[0],i=a[1];this._hls.on(n,i)}this._onRecoveredCallback=function(){return e._onRecovered()},this._onAddTrack=this._onAddTrack.bind(this),this._eventManager.listen(this._videoElement,"addtrack",this._onAddTrack),this._videoElement.textTracks.onaddtrack=this._onAddTrack},o._onFpsDrop=function(e){this._trigger(s.EventType.FPS_DROP,e)},o._onFragParsingMetadata=function(e){var t;this._trigger("hlsFragParsingMetadata",e);var r=Array.from(null==(t=this._videoElement)?void 0:t.textTracks).find((function(e){return"id3"===e.label})),a=Array.from((null==r?void 0:r.cues)||[]),n=[];null==e||e.samples.forEach((function(e){var t=s.Utils.binarySearch(a,(function(t){return t.startTime-e.pts}));if(t){var r=Object(s.createTimedMetadata)(t);n.push(r)}})),n.length&&this._trigger(s.EventType.TIMED_METADATA_ADDED,{cues:n})},o._onAddTrack=function(e){if(!this._hls.subtitleTracks.length){var t=this._parseCEATextTrack(e.track);t&&(a._logger.debug("A CEA 608/708 caption has been found",t),this._playerTracks.push(t),this._trigger(s.EventType.TRACKS_CHANGED,{tracks:this._playerTracks}))}},o.attachMediaSource=function(){this._hls||(this._videoElement&&this._videoElement.src&&(s.Utils.Dom.setAttribute(this._videoElement,"src",""),s.Utils.Dom.removeAttribute(this._videoElement,"src")),this._init())},o.detachMediaSource=function(){var e;this._hls&&(0===Math.floor(this.duration-this.currentTime)?this._config.hlsConfig.startPosition=0:this.currentTime>0&&(this._config.hlsConfig.startPosition=this.currentTime),this._reset(),null==(e=this._loadPromiseHandlers)||e.reject(new s.Error(s.Error.Severity.CRITICAL,s.Error.Category.PLAYER,s.Error.Code.HLS_FATAL_MEDIA_ERROR,"media detached while loading")),this._loadPromiseHandlers=null,this._loadPromise=null,this._hls=null)},o.handleMediaError=function(e){return e.code===e.MEDIA_ERR_DECODE&&(a._logger.debug("The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",e.message),this._handleMediaError(u.a.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR))},o.load=function(e){var t=this;return this._loadPromise||(this._startTime=e,this._loadPromise=new Promise((function(e,r){t._loadPromiseHandlers={resolve:e,reject:r},t._loadInternal()}))),this._loadPromise},o._loadInternal=function(){var e;this._hls&&this._sourceObj&&this._sourceObj.url?(this._hls.loadSource(this._sourceObj.url),this._hls.attachMedia(this._videoElement),this._trigger(s.EventType.ABR_MODE_CHANGED,{mode:this.isAdaptiveBitrateEnabled()?"auto":"manual"})):null==(e=this._loadPromiseHandlers)||e.reject(new s.Error(s.Error.Severity.CRITICAL,s.Error.Category.PLAYER,s.Error.Code.HLS_FATAL_MEDIA_ERROR,"no url provided"))},o._reloadWithDirectManifest=function(){this._triedReloadWithRedirect=!0,this._reset(),this._config.hlsConfig.pLoader=h,this._hls=new u.a(this._config.hlsConfig),this._addBindings(),this._loadInternal()},o.destroy=function(){var t=this;return new Promise((function(r,n){e.prototype.destroy.call(t).then((function(){var e;a._logger.debug("destroy"),t._playerTracks=[],t._nativeTextTracksMap={},t._sameFragSNLoadedCount=0,t._lastLoadedFragSN=-1,null==(e=t._loadPromiseHandlers)||e.reject(new s.Error(s.Error.Severity.CRITICAL,s.Error.Category.PLAYER,s.Error.Code.HLS_FATAL_MEDIA_ERROR,"The adapter has been destroyed while loading")),t._loadPromiseHandlers=null,t._loadPromise=null,t._reset(),r()}),(function(){return n()}))}))},o._reset=function(){this._removeBindings(),this._requestFilterError=!1,this._responseFilterError=!1,this._hls.detachMedia(),this._hls.destroy()},o._parseTracks=function(){var e=this._parseAudioTracks(this._hls.audioTracks||[]),t=this._parseVideoTracks(this._hls.levels||[]),r=this._parseTextTracks(this._hls.subtitleTracks||[]);return e.concat(t).concat(r)},o._parseAudioTracks=function(e){for(var t=[],r=0;r<e.length;r++){var a={id:e[r].id,active:this._hls.audioTrack===e[r].id,label:e[r].name,language:e[r].lang,index:r};t.push(new s.AudioTrack(a))}return t},o._parseVideoTracks=function(e){for(var t=[],r=0;r<e.length;r++){var a={active:this._hls.startLevel===r,bandwidth:e[r].bitrate,width:e[r].width,height:e[r].height,language:"",index:r};t.push(new s.VideoTrack(a))}return t},o._parseTextTracks=function(e){for(var t,r=[],a=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}(e);!(t=a()).done;){var n=t.value,i={id:n.id,active:!1,default:n.default,label:n.name,kind:n.type.toLowerCase(),language:n.lang};r.push(new s.TextTrack(i))}return r},o._parseCEATextTrack=function(e){var t=null;if("captions"===e.kind){var r={id:e.id,active:"showing"===e.mode,label:e.label,kind:e.kind,language:e.language};t=new s.TextTrack(r),this._nativeTextTracksMap[t.index]=e}return t},o.selectAudioTrack=function(e){e instanceof s.AudioTrack&&!e.active&&this._hls.audioTracks&&(this._hls.audioTrack=e.id)},o.selectVideoTrack=function(e){e instanceof s.VideoTrack&&(!e.active||this.isAdaptiveBitrateEnabled())&&this._hls.levels&&(this.isAdaptiveBitrateEnabled()&&this._trigger(s.EventType.ABR_MODE_CHANGED,{mode:"manual"}),this._hls.currentLevel=e.index)},o.selectTextTrack=function(e){e instanceof s.TextTrack&&!e.active&&this._hls&&(this._hls.subtitleTracks.length?(this._hls.subtitleTrack=e.id,this._notifyTrackChanged(e)):this._selectNativeTextTrack(e))},o._selectNativeTextTrack=function(e){var t=this._nativeTextTracksMap[e.index];t&&(this.disableNativeTextTracks(),t.mode=this._config.subtitleDisplay?"showing":"hidden",this._notifyTrackChanged(e))},o._notifyTrackChanged=function(e){this._onTrackChanged(e)},o.hideTextTrack=function(){this._hls&&(this._hls.subtitleTracks.length?this._hls.subtitleTrack=-1:this.disableNativeTextTracks())},o.enableAdaptiveBitrate=function(){this.isAdaptiveBitrateEnabled()||(this._trigger(s.EventType.ABR_MODE_CHANGED,{mode:"auto"}),this._hls.nextLevel=-1)},o.isAdaptiveBitrateEnabled=function(){return!!this._hls&&this._hls.autoLevelEnabled},o.applyABRRestriction=function(e){s.Utils.Object.createPropertyPath(this._config,"abr.restrictions",e),this._hls.capLevelToPlayerSize||this._maybeApplyAbrRestrictions(e)},o._getLevelDetails=function(){var e=this._hls.levels[this._hls.currentLevel]||this._hls.levels[this._hls.nextLevel]||this._hls.levels[this._hls.nextAutoLevel]||this._hls.levels[this._hls.nextLoadLevel];return e&&e.details?e.details:{}},o._getLiveEdge=function(){try{var e;return(e=this._hls.liveSyncPosition?this._hls.liveSyncPosition:this._hls.config.liveSyncDuration?this._videoElement.duration-this._hls.config.liveSyncDuration:this._videoElement.duration-this._hls.config.liveSyncDurationCount*this._getLevelDetails().targetduration)>0?e:this._videoElement.duration}catch(e){return a._logger.debug("Live edge calculation failed, fall back to duration"),this._videoElement.duration}},o.seekToLiveEdge=function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}},o.getSegmentDuration=function(){var e=s.Utils.Object.getPropertyPath(this._hls,"streamController.fragCurrent");return e?e.duration:0},o.isLive=function(){try{return!!this._getLevelDetails().live}catch(e){return!1}},o._onManifestLoaded=function(e){var t=this;a._logger.debug("The source has been loaded successfully"),this._hls.config.autoStartLoad||this._hls.startLoad(this._startTime),this._playerTracks=this._parseTracks(),this._config.abr.enabled||(this._hls.currentLevel=0),this._mediaAttachedPromise.then((function(){var e;null==(e=t._loadPromiseHandlers)||e.resolve({tracks:t._playerTracks}),t._loadPromiseHandlers=null}));var r=e.stats.loading,n=r.end-r.start;this._trigger(s.EventType.MANIFEST_LOADED,{miliSeconds:n})},o._maybeApplyAbrRestrictions=function(e){var t=this._playerTracks.filter((function(e){return e instanceof s.VideoTrack})),r=Object(s.filterTracksByRestriction)(t,e);if(r.length){var n=r[0],i=r.pop();this._hls.config.minAutoBitrate=n.bandwidth,this._hls.autoLevelCapping=i.index;var o=r.some((function(e){return e.active}));this.isAdaptiveBitrateEnabled()||o||this.selectVideoTrack(n)}else a._logger.warn("Invalid restrictions, there are not tracks within the restriction range")},o._onLevelSwitched=function(e,t){var r=this._playerTracks.find((function(e){return e instanceof s.VideoTrack&&e.index===t.level}));this._onTrackChanged(r)},o._onAudioTrackSwitched=function(e,t){var r=this._playerTracks.find((function(e){return e instanceof s.AudioTrack&&e.id===t.id}));this._onTrackChanged(r),this._handleWaitingUponAudioTrackSwitch()},o._handleWaitingUponAudioTrackSwitch=function(){var e=this;["IE","Edge"].includes(s.Env.browser.name)&&this._eventManager.listenOnce(this._videoElement,s.EventType.TIME_UPDATE,(function(){e._trigger(s.EventType.PLAYING)}))},o._getErrorDataObject=function(e){var t={};switch(t.name=e.details,t.name){case u.a.ErrorDetails.MANIFEST_LOAD_ERROR:case u.a.ErrorDetails.LEVEL_LOAD_ERROR:case u.a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:t.url=e.url,t.responseCode=e.response?e.response.code:null;break;case u.a.ErrorDetails.MANIFEST_LOAD_TIMEOUT:case u.a.ErrorDetails.LEVEL_LOAD_TIMEOUT:case u.a.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:t.url=e.url;break;case u.a.ErrorDetails.MANIFEST_PARSING_ERROR:t.url=e.url,t.reason=e.reason;break;case u.a.ErrorDetails.LEVEL_SWITCH_ERROR:t.level=e.level,t.reason=e.reason;break;case u.a.ErrorDetails.FRAG_LOAD_ERROR:t.fragUrl=e.frag?e.frag.url:null,t.responseCode=e.response?e.response.code:null;break;case u.a.ErrorDetails.FRAG_LOAD_TIMEOUT:t.fragUrl=e.frag?e.frag.url:null;break;case u.a.ErrorDetails.FRAG_DECRYPT_ERROR:case u.a.ErrorDetails.FRAG_PARSING_ERROR:t.reason=e.reason;break;case u.a.ErrorDetails.KEY_LOAD_ERROR:t.fragDecryptedDataUri=e.frag&&e.frag.decryptdata?e.frag.decryptdata.uri:null,t.responseCode=e.response?e.response.code:null;break;case u.a.ErrorDetails.KEY_LOAD_TIMEOUT:t.fragDecryptedDataUri=e.frag&&e.frag.decryptdata?e.frag.decryptdata.uri:null;break;case u.a.ErrorDetails.BUFFER_ADD_CODEC_ERROR:t.mimeType=e.mimeType,t.errorMsg=e.err?e.err.message:null;break;case u.a.ErrorDetails.BUFFER_STALLED_ERROR:t.buffer=e.buffer}return(this._requestFilterError||this._responseFilterError)&&(t.reason=e.response.text),t},o._onError=function(e){var t=e.type,r=e.details,n=e.fatal,i=this._getErrorDataObject(e);if(n){var o,l;switch(t){case u.a.ErrorTypes.NETWORK_ERROR:var c;c=this._requestFilterError?s.Error.Code.REQUEST_FILTER_ERROR:this._responseFilterError?s.Error.Code.RESPONSE_FILTER_ERROR:s.Error.Code.HTTP_ERROR,![u.a.ErrorDetails.MANIFEST_LOAD_ERROR,u.a.ErrorDetails.MANIFEST_LOAD_TIMEOUT].includes(r)||this._triedReloadWithRedirect||this._config.forceRedirectExternalStreams||this._requestFilterError||this._responseFilterError?o=new s.Error(s.Error.Severity.CRITICAL,s.Error.Category.NETWORK,c,i):(o=new s.Error(s.Error.Severity.RECOVERABLE,s.Error.Category.NETWORK,c,i),this._reloadWithDirectManifest());break;case u.a.ErrorTypes.MEDIA_ERROR:o=this._handleMediaError(r)?new s.Error(s.Error.Severity.RECOVERABLE,s.Error.Category.MEDIA,s.Error.Code.HLS_FATAL_MEDIA_ERROR,i):new s.Error(s.Error.Severity.CRITICAL,s.Error.Category.MEDIA,s.Error.Code.HLS_FATAL_MEDIA_ERROR,i);break;default:o=new s.Error(s.Error.Severity.CRITICAL,s.Error.Category.PLAYER,s.Error.Code.HLS_FATAL_MEDIA_ERROR,i)}this._trigger(s.EventType.ERROR,o),o&&o.severity===s.Error.Severity.CRITICAL&&(this._loadPromiseHandlers&&(null==(l=this._loadPromiseHandlers)||l.reject(o),this._loadPromiseHandlers=null,this._loadPromise=null),this.destroy())}else{var p=this._requestFilterError||this._responseFilterError?{category:s.Error.Category.NETWORK,code:this._requestFilterError?s.Error.Code.REQUEST_FILTER_ERROR:s.Error.Code.RESPONSE_FILTER_ERROR}:d[r]||{category:0,code:0},h=p.category,f=p.code;a._logger.warn(new s.Error(s.Error.Severity.RECOVERABLE,h,f,i))}this._requestFilterError=!1,this._responseFilterError=!1},o._handleMediaError=function(e){a._logger.error("_handleMediaError mediaErrorName:",e);var t=performance.now(),r=!0;return e===u.a.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR?(a._logger.error("recover aborted due to: MANIFEST_INCOMPATIBLE_CODECS_ERROR"),r=!1):this._checkTimeDeltaHasPassed(t,this._recoverDecodingErrorDate,this._config.recoverDecodingErrorDelay)?(this._eventManager.listen(this._videoElement,s.EventType.LOADED_METADATA,this._onRecoveredCallback),a._logger.debug("try to recover using: _recoverDecodingError()"),this._recoverDecodingError()):this._checkTimeDeltaHasPassed(t,this._recoverSwapAudioCodecDate,this._config.recoverSwapAudioCodecDelay)?(this._eventManager.listen(this._videoElement,s.EventType.LOADED_METADATA,this._onRecoveredCallback),a._logger.debug("try to recover using: _recoverSwapAudioCodec()"),this._recoverSwapAudioCodec()):(a._logger.error("cannot recover, last media error recovery failed error: ",e),r=!1),r},o._onRecovered=function(){this._trigger(s.EventType.MEDIA_RECOVERED),this._videoElement.removeEventListener(s.EventType.LOADED_METADATA,this._onRecoveredCallback)},o._checkTimeDeltaHasPassed=function(e,t,r){return!t||e-t>r},o._recoverDecodingError=function(){this._recoverDecodingErrorDate=performance.now(),a._logger.warn("try to recover media Error"),this._hls.recoverMediaError()},o._recoverSwapAudioCodec=function(){this._recoverSwapAudioCodecDate=performance.now(),a._logger.warn("try to swap Audio Codec and recover media Error"),this._hls.swapAudioCodec(),this._hls.recoverMediaError()},o._removeBindings=function(){for(var e=0,t=Object.entries(this._adapterEventsBindings);e<t.length;e++){var r=t[e],a=r[0],n=r[1];this._hls.off(a,n)}this._videoElement.textTracks.onaddtrack=null,this._onRecoveredCallback=null,this._eventManager&&this._eventManager.removeAll()},o.getStartTimeOfDvrWindow=function(){if(!this.isLive())return 0;try{var e=this._hls.levels[this._hls.nextLoadLevel].details,t=e.fragments,r=t.length,n=t[0].start+t[0].duration,i=t[r-1].start+t[r-1].duration,o=void 0!==this._hls.config.liveMaxLatencyDuration?this._hls.config.liveMaxLatencyDuration:this._hls.config.liveMaxLatencyDurationCount*e.targetduration;return Math.max(n-this._hls.config.maxFragLookUpTolerance,i-o)}catch(e){return a._logger.debug("Unable obtain the start of DVR window"),0}},o._onFragLoaded=function(e){if(s.Utils.Object.hasPropertyPath(e,"frag.stats.loading")){var t=e.frag.stats,r=t.loading.end-t.loading.start;this._trigger(s.EventType.FRAG_LOADED,{miliSeconds:r,bytes:t.loaded,url:e.frag.url})}},o._getLiveTargetBuffer=function(){return this._hls.config.liveSyncDuration?this._hls.config.liveSyncDuration:this._hls.config.liveSyncDurationCount*this._getLevelDetails().targetduration},n=a,(i=[{key:"liveDuration",get:function(){return this._getLiveEdge()+this.getSegmentDuration()}},{key:"targetBuffer",get:function(){var e=NaN;return this._hls?(e=this.isLive()?this._getLiveTargetBuffer()-(this._videoElement.currentTime-this._getLiveEdge()):this._videoElement.duration-this._videoElement.currentTime,e=Math.min(e,this._hls.config.maxMaxBufferLength+this._getLevelDetails().targetduration)):NaN}}])&&g(n.prototype,i),a}(s.BaseMediaSourceAdapter);m(v,"id","HlsAdapter"),m(v,"_logger",s.BaseMediaSourceAdapter.getLogger(v.id)),m(v,"_hlsMimeTypes",["application/x-mpegurl","application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"]);var _="1.32.1",k="@playkit-js/playkit-js-hls";t.default=v,v.isSupported()&&Object(s.registerMediaSourceAdapter)(v)}]))},function(e,t,r){var a;"undefined"!=typeof window&&(a=()=>(()=>{var e={21:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=function(){function e(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),n=function(){function e(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),i=r(145),o=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),a=0;a<4;a++)r[a]=t.getUint32(4*a);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,a=r[0],n=r[1],i=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],p=new Uint32Array(256),h=0,f=0,g=0;for(g=0;g<256;g++)p[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var y=f^f<<1^f<<2^f<<3^f<<4;y=y>>>8^255&y^99,e[h]=y,t[y]=h;var m=p[h],v=p[m],_=p[v],k=257*p[y]^16843008*y;a[h]=k<<24|k>>>8,n[h]=k<<16|k>>>16,i[h]=k<<8|k>>>24,o[h]=k,k=16843009*_^65537*v^257*m^16843008*h,l[y]=k<<24|k>>>8,u[y]=k<<16|k>>>16,c[y]=k<<8|k>>>24,d[y]=k,h?(h=m^p[p[p[_^m]]],f^=p[p[f]]):h=f=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,a=0;a<t.length&&r;)r=t[a]===this.key[a],a++;if(!r){this.key=t;var n=this.keySize=t.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var i,o,s,l,u=this.ksRows=4*(n+6+1),c=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),p=this.sBox,h=this.rcon,f=this.invSubMix,g=f[0],y=f[1],m=f[2],v=f[3];for(i=0;i<u;i++)i<n?s=c[i]=t[i]:(l=s,i%n==0?(l=p[(l=l<<8|l>>>24)>>>24]<<24|p[l>>>16&255]<<16|p[l>>>8&255]<<8|p[255&l],l^=h[i/n|0]<<24):n>6&&i%n==4&&(l=p[l>>>24]<<24|p[l>>>16&255]<<16|p[l>>>8&255]<<8|p[255&l]),c[i]=s=(c[i-n]^l)>>>0);for(o=0;o<u;o++)i=u-o,l=3&o?c[i]:c[i-4],d[o]=o<4||i<=4?l:g[p[l>>>24]]^y[p[l>>>16&255]]^m[p[l>>>8&255]]^v[p[255&l]],d[o]=d[o]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r){for(var a,n,i,o,s,l,u,c,d,p,h,f,g,y,m=this.keySize+6,v=this.invKeySchedule,_=this.invSBox,k=this.invSubMix,E=k[0],T=k[1],b=k[2],S=k[3],A=this.uint8ArrayToUint32Array_(r),C=A[0],P=A[1],w=A[2],x=A[3],I=new Int32Array(e),M=new Int32Array(I.length),D=this.networkToHostOrderSwap;t<I.length;){for(d=D(I[t]),p=D(I[t+1]),h=D(I[t+2]),f=D(I[t+3]),s=d^v[0],l=f^v[1],u=h^v[2],c=p^v[3],g=4,y=1;y<m;y++)a=E[s>>>24]^T[l>>16&255]^b[u>>8&255]^S[255&c]^v[g],n=E[l>>>24]^T[u>>16&255]^b[c>>8&255]^S[255&s]^v[g+1],i=E[u>>>24]^T[c>>16&255]^b[s>>8&255]^S[255&l]^v[g+2],o=E[c>>>24]^T[s>>16&255]^b[l>>8&255]^S[255&u]^v[g+3],s=a,l=n,u=i,c=o,g+=4;a=_[s>>>24]<<24^_[l>>16&255]<<16^_[u>>8&255]<<8^_[255&c]^v[g],n=_[l>>>24]<<24^_[u>>16&255]<<16^_[c>>8&255]<<8^_[255&s]^v[g+1],i=_[u>>>24]<<24^_[c>>16&255]<<16^_[s>>8&255]<<8^_[255&l]^v[g+2],o=_[c>>>24]<<24^_[s>>16&255]<<16^_[l>>8&255]<<8^_[255&u]^v[g+3],M[t]=D(a^C),M[t+1]=D(o^P),M[t+2]=D(i^w),M[t+3]=D(n^x),C=d,P=p,w=h,x=f,t+=4}return M.buffer},e}(),s=r(93),l=r(63),u=function(){function e(e,t){var r=(void 0===t?{}:t).removePKCS7Padding,a=void 0===r||r;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=a,a)try{var n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch(e){}null===this.subtle&&(this.useSoftware=!0)}var t=e.prototype;return t.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},t.isSync=function(){return this.useSoftware},t.flush=function(){var e=this.currentResult,t=this.remainderData;if(!e||t)return this.reset(),null;var r,a,n,o=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?(n=(a=(r=o).byteLength)&&new DataView(r.buffer).getUint8(a-1))?(0,i.sliceUint8)(r,0,a-n):r:o},t.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},t.decrypt=function(e,t,r){var a=this;return this.useSoftware?new Promise((function(n,i){a.softwareDecrypt(new Uint8Array(e),t,r);var o=a.flush();o?n(o.buffer):i(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,r)},t.softwareDecrypt=function(e,t,r){var a=this.currentIV,n=this.currentResult,s=this.remainderData;this.logOnce("JS AES decrypt"),s&&(e=(0,l.appendUint8Array)(s,e),this.remainderData=null);var u=this.getValidChunk(e);if(!u.length)return null;a&&(r=a);var c=this.softwareDecrypter;c||(c=this.softwareDecrypter=new o),c.expandKey(t);var d=n;return this.currentResult=c.decrypt(u.buffer,0,r),this.currentIV=(0,i.sliceUint8)(u,-16).buffer,d||null},t.webCryptoDecrypt=function(e,t,r){var i=this,o=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new n(o,t)),this.fastAesKey.expandKey().then((function(t){return o?(i.logOnce("WebCrypto AES decrypt"),new a(o,new Uint8Array(r)).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized"))})).catch((function(a){return s.logger.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+a.name+": "+a.message),i.onWebCryptoError(e,t,r)}))},t.onWebCryptoError=function(e,t,r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r);var a=this.flush();if(a)return a.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},t.getValidChunk=function(e){var t=e,r=e.length-e.length%16;return r!==e.length&&(t=(0,i.sliceUint8)(e,0,r),this.remainderData=(0,i.sliceUint8)(e,r)),t},t.logOnce=function(e){this.logEnabled&&(s.logger.log("[decrypter]: "+e),this.logEnabled=!1)},e}()},181:(e,t,r)=>{"use strict";r.r(t),r.d(t,{canParse:()=>l,decodeFrame:()=>h,getID3Data:()=>o,getID3Frames:()=>p,getTimeStamp:()=>u,isFooter:()=>i,isHeader:()=>n,isTimeStampFrame:()=>c,testables:()=>_,utf8ArrayToStr:()=>v});var a,n=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},i=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},o=function(e,t){for(var r=t,a=0;n(e,t);)a+=10,a+=s(e,t+6),i(e,t+10)&&(a+=10),t+=a;if(a>0)return e.subarray(r,r+a)},s=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]},l=function(e,t){return n(e,t)&&s(e,t+6)+10<=e.length-t},u=function(e){for(var t=p(e),r=0;r<t.length;r++){var a=t[r];if(c(a))return m(a)}},c=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},d=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=s(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}},p=function(e){for(var t=0,r=[];n(e,t);){for(var a=s(e,t+6),o=(t+=10)+a;t+8<o;){var l=d(e.subarray(t)),u=h(l);u&&r.push(u),t+=l.size+10}i(e,t)&&(t+=10)}return r},h=function(e){return"PRIV"===e.type?f(e):"W"===e.type[0]?y(e):g(e)},f=function(e){if(!(e.size<2)){var t=v(e.data,!0),r=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:r.buffer}}},g=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,r=v(e.data.subarray(t),!0);t+=r.length+1;var a=v(e.data.subarray(t));return{key:e.type,info:r,data:a}}var n=v(e.data.subarray(1));return{key:e.type,data:n}}},y=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,r=v(e.data.subarray(t),!0);t+=r.length+1;var a=v(e.data.subarray(t));return{key:e.type,info:r,data:a}}var n=v(e.data);return{key:e.type,data:n}},m=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],a=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return a/=45,r&&(a+=47721858.84),Math.round(a)}},v=function(e,t){void 0===t&&(t=!1);var r=k();if(r){var a=r.decode(e);if(t){var n=a.indexOf("\0");return-1!==n?a.substring(0,n):a}return a.replace(/\0/g,"")}for(var i,o,s,l=e.length,u="",c=0;c<l;){if(0===(i=e[c++])&&t)return u;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(i);break;case 12:case 13:o=e[c++],u+=String.fromCharCode((31&i)<<6|63&o);break;case 14:o=e[c++],s=e[c++],u+=String.fromCharCode((15&i)<<12|(63&o)<<6|(63&s)<<0)}}return u},_={decodeTextFrame:g};function k(){return a||void 0===self.TextDecoder||(a=new self.TextDecoder("utf-8")),a}},182:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var a=r(544),n=r(851),i=r(93),o=r(729),s=r(973);function l(e){var t=new o.EventEmitter,r=function(t,r){e.postMessage({event:t,data:r})};t.on(n.Events.FRAG_DECRYPTED,r),t.on(n.Events.ERROR,r),e.addEventListener("message",(function(o){var l=o.data;switch(l.cmd){case"init":var c=JSON.parse(l.config);e.transmuxer=new a.default(t,l.typeSupported,c,l.vendor,l.id),(0,i.enableLogs)(c.debug,l.id),function(){var e=function(e){i.logger[e]=function(t){r("workerLog",{logType:e,message:t})}};for(var t in i.logger)e(t)}(),r("init",null);break;case"configure":e.transmuxer.configure(l.config);break;case"demux":var p=e.transmuxer.push(l.data,l.decryptdata,l.chunkMeta,l.state);(0,a.isPromise)(p)?(e.transmuxer.async=!0,p.then((function(t){u(e,t)})).catch((function(e){r(n.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:l.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker push error"})}))):(e.transmuxer.async=!1,u(e,p));break;case"flush":var h=l.chunkMeta,f=e.transmuxer.flush(h);(0,a.isPromise)(f)||e.transmuxer.async?((0,a.isPromise)(f)||(f=Promise.resolve(f)),f.then((function(t){d(e,t,h)})).catch((function(e){r(n.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:l.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker flush error"})}))):d(e,f,h)}}))}function u(e,t){if(!((r=t.remuxResult).audio||r.video||r.text||r.id3||r.initSegment))return!1;var r,a=[],n=t.remuxResult,i=n.audio,o=n.video;return i&&c(a,i),o&&c(a,o),e.postMessage({event:"transmuxComplete",data:t},a),!0}function c(e,t){t.data1&&e.push(t.data1.buffer),t.data2&&e.push(t.data2.buffer)}function d(e,t,r){t.reduce((function(t,r){return u(e,r)||t}),!1)||e.postMessage({event:"transmuxComplete",data:t[0]}),e.postMessage({event:"flush",data:r})}},544:(e,t,r)=>{"use strict";r.r(t),r.d(t,{TransmuxConfig:()=>oe,TransmuxState:()=>se,default:()=>ae,isPromise:()=>ie});var a=r(851),n=r(973),i=r(21),o=r(965),s=r(181),l=r(856);function u(e,t){return void 0===e&&(e=""),void 0===t&&(t=9e4),{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}var c=r(63),d=r(145),p=function(){function e(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var t=e.prototype;return t.resetInitSegment=function(e,t,r,a){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},t.resetTimeStamp=function(e){this.initPTS=e,this.resetContiguity()},t.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},t.canParse=function(e,t){return!1},t.appendFrame=function(e,t,r){},t.demux=function(e,t){this.cachedData&&(e=(0,c.appendUint8Array)(this.cachedData,e),this.cachedData=null);var r,a=s.getID3Data(e,0),n=a?a.length:0,i=this._audioTrack,p=this._id3Track,f=a?s.getTimeStamp(a):void 0,g=e.length;for((null===this.basePTS||0===this.frameIndex&&(0,o.isFiniteNumber)(f))&&(this.basePTS=h(f,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),a&&a.length>0&&p.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:l.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});n<g;){if(this.canParse(e,n)){var y=this.appendFrame(i,e,n);y?(this.frameIndex++,this.lastPTS=y.sample.pts,r=n+=y.length):n=g}else s.canParse(e,n)?(a=s.getID3Data(e,n),p.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:l.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),r=n+=a.length):n++;if(n===g&&r!==g){var m=(0,d.sliceUint8)(e,r);this.cachedData?this.cachedData=(0,c.appendUint8Array)(this.cachedData,m):this.cachedData=m}}return{audioTrack:i,videoTrack:u(),id3Track:p,textTrack:u()}},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},t.flush=function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:u(),id3Track:this._id3Track,textTrack:u()}},t.destroy=function(){},e}(),h=function(e,t,r){return(0,o.isFiniteNumber)(e)?90*e:9e4*t+(r||0)};const f=p;var g=r(93);function y(e,t){return 255===e[t]&&240==(246&e[t+1])}function m(e,t){return 1&e[t+1]?7:9}function v(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function _(e,t){return t+1<e.length&&y(e,t)}function k(e,t){if(_(e,t)){var r=m(e,t);if(t+r>=e.length)return!1;var a=v(e,t);if(a<=r)return!1;var n=t+a;return n===e.length||_(e,n)}return!1}function E(e,t,r,i,o){if(!e.samplerate){var s=function(e,t,r,i){var o,s,l,u,c=navigator.userAgent.toLowerCase(),d=i,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];o=1+((192&t[r+2])>>>6);var h=(60&t[r+2])>>>2;if(!(h>p.length-1))return l=(1&t[r+2])<<2,l|=(192&t[r+3])>>>6,g.logger.log("manifest codec:"+i+", ADTS type:"+o+", samplingIndex:"+h),/firefox/i.test(c)?h>=6?(o=5,u=new Array(4),s=h-3):(o=2,u=new Array(2),s=h):-1!==c.indexOf("android")?(o=2,u=new Array(2),s=h):(o=5,u=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&h>=6?s=h-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(h>=6&&1===l||/vivaldi/i.test(c))||!i&&1===l)&&(o=2,u=new Array(2)),s=h)),u[0]=o<<3,u[0]|=(14&h)>>1,u[1]|=(1&h)<<7,u[1]|=l<<3,5===o&&(u[1]|=(14&s)>>1,u[2]=(1&s)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:p[h],channelCount:l,codec:"mp4a.40."+o,manifestCodec:d};e.trigger(a.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+h})}(t,r,i,o);if(!s)return;e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,g.logger.log("parsed codec:"+e.codec+", rate:"+s.samplerate+", channels:"+s.channelCount)}}function T(e){return 9216e4/e}function b(e,t,r,a,n){var i,o=a+n*T(e.samplerate),s=function(e,t){var r=m(e,t);if(t+r<=e.length){var a=v(e,t)-r;if(a>0)return{headerLength:r,frameLength:a}}}(t,r);if(s){var l=s.frameLength,u=s.headerLength,c=u+l,d=Math.max(0,r+c-t.length);d?(i=new Uint8Array(c-u)).set(t.subarray(r+u,t.length),0):i=t.subarray(r+u,r+c);var p={unit:i,pts:o};return d||e.samples.push(p),{sample:p,length:c,missing:d}}var h=t.length-r;return(i=new Uint8Array(h)).set(t.subarray(r,t.length),0),{sample:{unit:i,pts:o},length:h,missing:-1}}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}const A=function(e){var t,r;function a(t,r){var a;return(a=e.call(this)||this).observer=void 0,a.config=void 0,a.observer=t,a.config=r,a}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,S(t,r);var n=a.prototype;return n.resetInitSegment=function(t,r,a,n){e.prototype.resetInitSegment.call(this,t,r,a,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:r,duration:n,inputTimeScale:9e4,dropped:0}},a.probe=function(e){if(!e)return!1;for(var t=(s.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(k(e,t))return g.logger.log("ADTS sync word found !"),!0;return!1},n.canParse=function(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&y(e,t)&&v(e,t)<=e.length-t}(e,t)},n.appendFrame=function(e,t,r){E(e,this.observer,t,r,e.manifestCodec);var a=b(e,t,r,this.basePTS,this.frameIndex);if(a&&0===a.missing)return a},a}(f);var C=/\/emsg[-/]ID3/i;const P=function(){function e(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}var t=e.prototype;return t.resetTimeStamp=function(){},t.resetInitSegment=function(e,t,r,a){var n=this.videoTrack=u("video",1),i=this.audioTrack=u("audio",1),o=this.txtTrack=u("text",1);if(this.id3Track=u("id3",1),this.timeOffset=0,e&&e.byteLength){var s=(0,c.parseInitSegment)(e);if(s.video){var l=s.video,d=l.id,p=l.timescale,h=l.codec;n.id=d,n.timescale=o.timescale=p,n.codec=h}if(s.audio){var f=s.audio,g=f.id,y=f.timescale,m=f.codec;i.id=g,i.timescale=y,i.codec=m}o.id=c.RemuxerTrackIdConfig.text,n.sampleDuration=0,n.duration=i.duration=a}},t.resetContiguity=function(){},e.probe=function(e){return e=e.length>16384?e.subarray(0,16384):e,(0,c.findBox)(e,["moof"]).length>0},t.demux=function(e,t){this.timeOffset=t;var r=e,a=this.videoTrack,n=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=(0,c.appendUint8Array)(this.remainderData,e));var i=(0,c.segmentValidRange)(r);this.remainderData=i.remainder,a.samples=i.valid||new Uint8Array}else a.samples=r;var o=this.extractID3Track(a,t);return n.samples=(0,c.parseSamples)(t,a),{videoTrack:a,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}},t.flush=function(){var e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;var a=this.extractID3Track(t,this.timeOffset);return r.samples=(0,c.parseSamples)(e,t),{videoTrack:t,audioTrack:u(),id3Track:a,textTrack:u()}},t.extractID3Track=function(e,t){var r=this.id3Track;if(e.samples.length){var a=(0,c.findBox)(e.samples,["emsg"]);a&&a.forEach((function(e){var a=(0,c.parseEmsg)(e);if(C.test(a.schemeIdUri)){var n=(0,o.isFiniteNumber)(a.presentationTime)?a.presentationTime/a.timeScale:t+a.presentationTimeDelta/a.timeScale,i=4294967295===a.eventDuration?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;i<=.001&&(i=Number.POSITIVE_INFINITY);var s=a.payload;r.samples.push({data:s,len:s.byteLength,dts:n,pts:n,type:l.MetadataSchema.emsg,duration:i})}}))}return r},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},t.destroy=function(){},e}();var w=null,x=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],I=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],M=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],D=[0,1,1,4];function R(e,t,r,a,n){if(!(r+24>t.length)){var i=O(t,r);if(i&&r+i.frameLength<=t.length){var o=a+n*(9e4*i.samplesPerFrame/i.sampleRate),s={unit:t.subarray(r,r+i.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=i.channelCount,e.samplerate=i.sampleRate,e.samples.push(s),{sample:s,length:i.frameLength,missing:0}}}}function O(e,t){var r=e[t+1]>>3&3,a=e[t+1]>>1&3,n=e[t+2]>>4&15,i=e[t+2]>>2&3;if(1!==r&&0!==n&&15!==n&&3!==i){var o=e[t+2]>>1&1,s=e[t+3]>>6,l=1e3*x[14*(3===r?3-a:3===a?3:4)+n-1],u=I[3*(3===r?0:2===r?1:2)+i],c=3===s?1:2,d=M[r][a],p=D[a],h=8*d*p,f=Math.floor(d*l/u+o)*p;if(null===w){var g=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);w=g?parseInt(g[1]):0}return!!w&&w<=87&&2===a&&l>=224e3&&0===s&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:f,samplesPerFrame:h}}}function L(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function N(e,t){return t+1<e.length&&L(e,t)}function U(e,t){if(t+1<e.length&&L(e,t)){var r=O(e,t),a=4;null!=r&&r.frameLength&&(a=r.frameLength);var n=t+a;return n===e.length||N(e,n)}return!1}const F=function(){function e(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,a=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw new Error("no bytes available");a.set(e.subarray(r,r+n)),this.word=new DataView(a.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},t.skipBits=function(e){var t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;if(e>32&&g.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){for(var t=8,r=8,a=0;a<e;a++)0!==r&&(r=(t+this.readEG()+256)%256),t=0===r?t:r},t.readSPS=function(){var e,t,r,a=0,n=0,i=0,o=0,s=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),p=this.skipEG.bind(this),h=this.skipUEG.bind(this),f=this.skipScalingList.bind(this);s();var g=s();if(l(5),d(3),s(),h(),100===g||110===g||122===g||244===g||44===g||83===g||86===g||118===g||128===g){var y=u();if(3===y&&d(1),h(),h(),d(1),c())for(t=3!==y?8:12,r=0;r<t;r++)c()&&f(r<6?16:64)}h();var m=u();if(0===m)u();else if(1===m)for(d(1),p(),p(),e=u(),r=0;r<e;r++)p();h(),d(1);var v=u(),_=u(),k=l(1);0===k&&d(1),d(1),c()&&(a=u(),n=u(),i=u(),o=u());var E=[1,1];if(c()&&c())switch(s()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[s()<<8|s(),s()<<8|s()]}return{width:Math.ceil(16*(v+1)-2*a-2*n),height:(2-k)*(_+1)*16-(k?2:4)*(i+o),pixelRatio:E}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),B=function(){function e(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new i.default(t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)},t.decryptAacSample=function(e,t,r){var a=this,n=e[t].unit;if(!(n.length<=16)){var i=n.subarray(16,n.length-n.length%16),o=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(o).then((function(i){var o=new Uint8Array(i);n.set(o,16),a.decrypter.isSync()||a.decryptAacSamples(e,t+1,r)}))}},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,r),this.decrypter.isSync())))return}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),a=0,n=32;n<e.length-16;n+=160,a+=16)r.set(e.subarray(n,n+16),a);return r},t.getAvcDecryptedUnit=function(e,t){for(var r=new Uint8Array(t),a=0,n=32;n<e.length-16;n+=160,a+=16)e.set(r.subarray(a,a+16),n);return e},t.decryptAvcSample=function(e,t,r,a,n){var i=this,o=(0,c.discardEPB)(n.data),s=this.getAvcEncryptedData(o);this.decryptBuffer(s.buffer).then((function(s){n.data=i.getAvcDecryptedUnit(o,s),i.decrypter.isSync()||i.decryptAvcSamples(e,t,r+1,a)}))},t.decryptAvcSamples=function(e,t,r,a){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length)return void a();for(var n=e[t].units;!(r>=n.length);r++){var i=n[r];if(!(i.data.length<=48||1!==i.type&&5!==i.type||(this.decryptAvcSample(e,t,r,a,i),this.decrypter.isSync())))return}}},e}();function j(){return(j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var V=188;function $(e,t,r,a){return{key:e,frame:!1,pts:t,dts:r,units:[],debug:a,length:0}}function H(e,t){return((31&e[t+1])<<8)+e[t+2]}function G(e,t){return(31&e[t+10])<<8|e[t+11]}function K(e,t,r,a){var n={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},i=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<i;){var o=H(e,t);switch(e[t]){case 207:if(!a){g.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===n.audio&&(n.audio=o);break;case 21:-1===n.id3&&(n.id3=o);break;case 219:if(!a){g.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===n.avc&&(n.avc=o);break;case 3:case 4:!0!==r.mpeg&&!0!==r.mp3?g.logger.log("MPEG audio found, not supported in this browser"):-1===n.audio&&(n.audio=o,n.segmentCodec="mp3");break;case 36:g.logger.warn("Unsupported HEVC stream type found")}t+=5+((15&e[t+3])<<8|e[t+4])}return n}function W(e){var t,r,a,n,i,o=0,s=e.data;if(!e||0===e.size)return null;for(;s[0].length<19&&s.length>1;){var l=new Uint8Array(s[0].length+s[1].length);l.set(s[0]),l.set(s[1],s[0].length),s[0]=l,s.splice(1,1)}if(1===((t=s[0])[0]<<16)+(t[1]<<8)+t[2]){if((r=(t[4]<<8)+t[5])&&r>e.size-6)return null;var u=t[7];192&u&&(n=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&u?n-(i=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(g.logger.warn(Math.round((n-i)/9e4)+"s delta between PTS and DTS, align them"),n=i):i=n);var c=(a=t[8])+9;if(e.size<=c)return null;e.size-=c;for(var d=new Uint8Array(e.size),p=0,h=s.length;p<h;p++){var f=(t=s[p]).byteLength;if(c){if(c>f){c-=f;continue}t=t.subarray(c),f-=c,c=0}d.set(t,o),o+=f}return r&&(r-=a+3),{data:d,pts:n,dts:i,len:r}}return null}function z(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var r=t.samples,a=r.length;if(!a)return void t.dropped++;var n=r[a-1];e.pts=n.pts,e.dts=n.dts}t.samples.push(e)}e.debug.length&&g.logger.log(e.pts+"/"+e.dts+":"+e.debug)}const q=function(){function e(e,t,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=r}e.probe=function(t){var r=e.syncOffset(t);return r>0&&g.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r),-1!==r},e.syncOffset=function(e){for(var t=e.length,r=Math.min(940,e.length-V)+1,a=0;a<r;){for(var n=!1,i=a;i<t&&71===e[i];i+=V)if(n||0!==H(e,i)||(n=!0),n&&i+V>r)return a;a++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:c.RemuxerTrackIdConfig[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}};var t=e.prototype;return t.resetInitSegment=function(t,r,a,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video"),this._audioTrack=e.createTrack("audio",n),this._id3Track=e.createTrack("id3"),this._txtTrack=e.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=r,this.videoCodec=a,this._duration=n},t.resetTimeStamp=function(){},t.resetContiguity=function(){var e=this._audioTrack,t=this._avcTrack,r=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},t.demux=function(t,r,i,o){var s;void 0===i&&(i=!1),void 0===o&&(o=!1),i||(this.sampleAes=null);var l=this._avcTrack,u=this._audioTrack,d=this._id3Track,p=this._txtTrack,h=l.pid,f=l.pesData,y=u.pid,m=d.pid,v=u.pesData,_=d.pesData,k=null,E=this.pmtParsed,T=this._pmtId,b=t.length;if(this.remainderData&&(b=(t=(0,c.appendUint8Array)(this.remainderData,t)).length,this.remainderData=null),b<V&&!o)return this.remainderData=t,{audioTrack:u,videoTrack:l,id3Track:d,textTrack:p};var S=Math.max(0,e.syncOffset(t));(b-=(b-S)%V)<t.byteLength&&!o&&(this.remainderData=new Uint8Array(t.buffer,b,t.buffer.byteLength-b));for(var A=0,C=S;C<b;C+=V)if(71===t[C]){var P=!!(64&t[C+1]),w=H(t,C),x=void 0;if((48&t[C+3])>>4>1){if((x=C+5+t[C+4])===C+V)continue}else x=C+4;switch(w){case h:P&&(f&&(s=W(f))&&this.parseAVCPES(l,p,s,!1),f={data:[],size:0}),f&&(f.data.push(t.subarray(x,C+V)),f.size+=C+V-x);break;case y:if(P){if(v&&(s=W(v)))switch(u.segmentCodec){case"aac":this.parseAACPES(u,s);break;case"mp3":this.parseMPEGPES(u,s)}v={data:[],size:0}}v&&(v.data.push(t.subarray(x,C+V)),v.size+=C+V-x);break;case m:P&&(_&&(s=W(_))&&this.parseID3PES(d,s),_={data:[],size:0}),_&&(_.data.push(t.subarray(x,C+V)),_.size+=C+V-x);break;case 0:P&&(x+=t[x]+1),T=this._pmtId=G(t,x);break;case T:P&&(x+=t[x]+1);var I=K(t,x,this.typeSupported,i);(h=I.avc)>0&&(l.pid=h),(y=I.audio)>0&&(u.pid=y,u.segmentCodec=I.segmentCodec),(m=I.id3)>0&&(d.pid=m),null===k||E||(g.logger.warn("MPEG-TS PMT found at "+C+" after unknown PID '"+k+"'. Backtracking to sync byte @"+S+" to parse all TS packets."),k=null,C=S-188),E=this.pmtParsed=!0;break;case 17:case 8191:break;default:k=w}}else A++;A>0&&this.observer.emit(a.Events.ERROR,a.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+A+" TS packet/s that do not start with 0x47"}),l.pesData=f,u.pesData=v,d.pesData=_;var M={audioTrack:u,videoTrack:l,id3Track:d,textTrack:p};return o&&this.extractRemainingSamples(M),M},t.flush=function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e},t.extractRemainingSamples=function(e){var t,r=e.audioTrack,a=e.videoTrack,n=e.id3Track,i=e.textTrack,o=a.pesData,s=r.pesData,l=n.pesData;if(o&&(t=W(o))?(this.parseAVCPES(a,i,t,!0),a.pesData=null):a.pesData=o,s&&(t=W(s))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,t);break;case"mp3":this.parseMPEGPES(r,t)}r.pesData=null}else null!=s&&s.size&&g.logger.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=s;l&&(t=W(l))?(this.parseID3PES(n,t),n.pesData=null):n.pesData=l},t.demuxSampleAes=function(e,t,r){var a=this.demux(e,r,!0,!this.config.progressive),n=this.sampleAes=new B(this.observer,this.config,t);return this.decrypt(a,n)},t.decrypt=function(e,t){return new Promise((function(r){var a=e.audioTrack,n=e.videoTrack;a.samples&&"aac"===a.segmentCodec?t.decryptAacSamples(a.samples,0,(function(){n.samples?t.decryptAvcSamples(n.samples,0,0,(function(){r(e)})):r(e)})):n.samples&&t.decryptAvcSamples(n.samples,0,0,(function(){r(e)}))}))},t.destroy=function(){this._duration=0},t.parseAVCPES=function(e,t,r,a){var n,i=this,o=this.parseAVCNALu(e,r.data),s=this.avcSample,l=!1;r.data=null,s&&o.length&&!e.audFound&&(z(s,e),s=this.avcSample=$(!1,r.pts,r.dts,"")),o.forEach((function(a){switch(a.type){case 1:n=!0,s||(s=i.avcSample=$(!0,r.pts,r.dts,"")),s.frame=!0;var o=a.data;if(l&&o.length>4){var u=new F(o).readSliceType();2!==u&&4!==u&&7!==u&&9!==u||(s.key=!0)}break;case 5:n=!0,s||(s=i.avcSample=$(!0,r.pts,r.dts,"")),s.key=!0,s.frame=!0;break;case 6:n=!0,(0,c.parseSEIMessageFromNALu)(a.data,1,r.pts,t.samples);break;case 7:if(n=!0,l=!0,!e.sps){var d=new F(a.data).readSPS();e.width=d.width,e.height=d.height,e.pixelRatio=d.pixelRatio,e.sps=[a.data],e.duration=i._duration;for(var p=a.data.subarray(1,4),h="avc1.",f=0;f<3;f++){var g=p[f].toString(16);g.length<2&&(g="0"+g),h+=g}e.codec=h}break;case 8:n=!0,e.pps||(e.pps=[a.data]);break;case 9:n=!1,e.audFound=!0,s&&z(s,e),s=i.avcSample=$(!1,r.pts,r.dts,"");break;case 12:n=!0;break;default:n=!1,s&&(s.debug+="unknown NAL "+a.type+" ")}s&&n&&s.units.push(a)})),a&&s&&(z(s,e),this.avcSample=null)},t.getLastNalUnit=function(e){var t,r,a=this.avcSample;if(a&&0!==a.units.length||(a=e[e.length-1]),null!==(t=a)&&void 0!==t&&t.units){var n=a.units;r=n[n.length-1]}return r},t.parseAVCNALu=function(e,t){var r,a,n=t.byteLength,i=e.naluState||0,o=i,s=[],l=0,u=-1,c=0;for(-1===i&&(u=0,c=31&t[0],i=0,l=1);l<n;)if(r=t[l++],i)if(1!==i)if(r)if(1===r){if(u>=0){var d={data:t.subarray(u,l-i-1),type:c};s.push(d)}else{var p=this.getLastNalUnit(e.samples);if(p&&(o&&l<=4-o&&p.state&&(p.data=p.data.subarray(0,p.data.byteLength-o)),(a=l-i-1)>0)){var h=new Uint8Array(p.data.byteLength+a);h.set(p.data,0),h.set(t.subarray(0,a),p.data.byteLength),p.data=h,p.state=0}}l<n?(u=l,c=31&t[l],i=0):i=-1}else i=0;else i=3;else i=r?0:2;else i=r?0:1;if(u>=0&&i>=0){var f={data:t.subarray(u,n),type:c,state:i};s.push(f)}if(0===s.length){var g=this.getLastNalUnit(e.samples);if(g){var y=new Uint8Array(g.data.byteLength+t.byteLength);y.set(g.data,0),y.set(t,g.data.byteLength),g.data=y}}return e.naluState=i,s},t.parseAACPES=function(e,t){var r,i,o,s,l,u=0,c=this.aacOverFlow,d=t.data;if(c){this.aacOverFlow=null;var p=c.missing,h=c.sample.unit.byteLength;if(-1===p){var f=new Uint8Array(h+d.byteLength);f.set(c.sample.unit,0),f.set(d,h),d=f}else{var y=h-p;c.sample.unit.set(d.subarray(0,p),y),e.samples.push(c.sample),u=c.missing}}for(r=u,i=d.length;r<i-1&&!_(d,r);r++);if(r===u||(r<i-1?(o="AAC PES did not start with ADTS header,offset:"+r,s=!1):(o="no ADTS header found in AAC PES",s=!0),g.logger.warn("parsing error:"+o),this.observer.emit(a.Events.ERROR,a.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:s,reason:o}),!s)){if(E(e,this.observer,d,r,this.audioCodec),void 0!==t.pts)l=t.pts;else{if(!c)return void g.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var m=T(e.samplerate);l=c.sample.pts+m}for(var v,k=0;r<i;){if(r+=(v=b(e,d,r,l,k)).length,v.missing){this.aacOverFlow=v;break}for(k++;r<i-1&&!_(d,r);r++);}}},t.parseMPEGPES=function(e,t){var r=t.data,a=r.length,n=0,i=0,o=t.pts;if(void 0!==o)for(;i<a;)if(N(r,i)){var s=R(e,r,i,o,n);if(!s)break;i+=s.length,n++}else i++;else g.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},t.parseID3PES=function(e,t){if(void 0!==t.pts){var r=j({},t,{type:this._avcTrack?l.MetadataSchema.emsg:l.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}else g.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},e}();function Y(e,t){return(Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}const X=function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Y(t,r);var n=a.prototype;return n.resetInitSegment=function(t,r,a,n){e.prototype.resetInitSegment.call(this,t,r,a,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:r,duration:n,inputTimeScale:9e4,dropped:0}},a.probe=function(e){if(!e)return!1;for(var t=(s.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(U(e,t))return g.logger.log("MPEG Audio sync word found !"),!0;return!1},n.canParse=function(e,t){return function(e,t){return L(e,t)&&4<=e.length-t}(e,t)},n.appendFrame=function(e,t,r){if(null!==this.basePTS)return R(e,t,r,this.basePTS,this.frameIndex)},a}(f);var Q=r(524),J=r(923);function Z(e,t){var r=null==e?void 0:e.codec;return r&&r.length>4?r:"hvc1"===r||"hev1"===r?"hvc1.1.c.L120.90":"av01"===r?"av01.0.04M.08":"avc1"===r||t===J.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const ee=function(){function e(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this.initPTS=e,this.lastEndTime=null},t.resetNextTimestamp=function(){this.lastEndTime=null},t.resetInitSegment=function(e,t,r,a){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment((0,c.patchEncyptionData)(e,a)),this.emitInitSegment=!0},t.generateInitSegment=function(e){var t=this.audioCodec,r=this.videoCodec;if(!e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var a=this.initData=(0,c.parseInitSegment)(e);t||(t=Z(a.audio,J.ElementaryStreamTypes.AUDIO)),r||(r=Z(a.video,J.ElementaryStreamTypes.VIDEO));var n={};a.audio&&a.video?n.audiovideo={container:"video/mp4",codec:t+","+r,initSegment:e,id:"main"}:a.audio?n.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:a.video?n.video={container:"video/mp4",codec:r,initSegment:e,id:"main"}:g.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=n},t.remux=function(e,t,r,a,n){var i,s=this.initPTS,l=this.lastEndTime,u={audio:void 0,video:void 0,text:a,id3:r,initSegment:void 0};(0,o.isFiniteNumber)(l)||(l=this.lastEndTime=n||0);var d=t.samples;if(!d||!d.length)return u;var p={initPTS:void 0,timescale:1},h=this.initData;if(h&&h.length||(this.generateInitSegment(d),h=this.initData),!h||!h.length)return g.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),u;this.emitInitSegment&&(p.tracks=this.initTracks,this.emitInitSegment=!1);var f=(0,c.getStartDTS)(h,d);(0,o.isFiniteNumber)(s)||(this.initPTS=p.initPTS=s=f-n);var y=(0,c.getDuration)(d,h),m=e?f-s:l,v=m+y;(0,c.offsetStartDTS)(h,d,s),y>0?this.lastEndTime=v:(g.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var _=!!h.audio,k=!!h.video,E="";_&&(E+="audio"),k&&(E+="video");var T={data1:d,startPTS:m,startDTS:m,endPTS:v,endDTS:v,type:E,hasAudio:_,hasVideo:k,nb:1,dropped:0};u.audio="audio"===T.type?T:void 0,u.video="audio"!==T.type?T:void 0,u.initSegment=p;var b=null!=(i=this.initPTS)?i:0;return u.id3=(0,Q.flushTextTrackMetadataCueSamples)(r,n,b,b),a.samples.length&&(u.text=(0,Q.flushTextTrackUserdataCueSamples)(a,n,b)),u},e}();var te;try{te=self.performance.now.bind(self.performance)}catch(e){g.logger.debug("Unable to use Performance API on this environment"),te=self.Date.now}var re=[{demux:P,remux:ee},{demux:q,remux:Q.default},{demux:A,remux:Q.default},{demux:X,remux:Q.default}],ae=function(){function e(e,t,r,a,n){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.vendor=a,this.id=n}var t=e.prototype;return t.configure=function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()},t.push=function(e,t,r,a){var n=this,i=r.transmuxing;i.executeStart=te();var o=new Uint8Array(e),s=this.currentTransmuxState,l=this.transmuxConfig;a&&(this.currentTransmuxState=a);var u=a||s,c=u.contiguous,d=u.discontinuity,p=u.trackSwitch,h=u.accurateTimeOffset,f=u.timeOffset,g=u.initSegmentChange,y=l.audioCodec,m=l.videoCodec,v=l.defaultInitPts,_=l.duration,k=l.initSegmentData,E=function(e,t){var r=null;return e.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(r=t),r}(o,t);if(E&&"AES-128"===E.method){var T=this.getDecrypter();if(!T.isSync())return this.decryptionPromise=T.webCryptoDecrypt(o,E.key.buffer,E.iv.buffer).then((function(e){var t=n.push(e,null,r);return n.decryptionPromise=null,t})),this.decryptionPromise;var b=T.softwareDecrypt(o,E.key.buffer,E.iv.buffer);if(r.part>-1&&(b=T.flush()),!b)return i.executeEnd=te(),ne(r);o=new Uint8Array(b)}var S=this.needsProbing(d,p);S&&this.configureTransmuxer(o),(d||p||g||S)&&this.resetInitSegment(k,y,m,_,t),(d||g||S)&&this.resetInitialTimestamp(v),c||this.resetContiguity();var A=this.transmux(o,E,f,h,r),C=this.currentTransmuxState;return C.contiguous=!0,C.discontinuity=!1,C.trackSwitch=!1,i.executeEnd=te(),A},t.flush=function(e){var t=this,r=e.transmuxing;r.executeStart=te();var i=this.decrypter,o=this.currentTransmuxState,s=this.decryptionPromise;if(s)return s.then((function(){return t.flush(e)}));var l=[],u=o.timeOffset;if(i){var c=i.flush();c&&l.push(this.push(c,null,e))}var d=this.demuxer,p=this.remuxer;if(!d||!p)return this.observer.emit(a.Events.ERROR,a.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),r.executeEnd=te(),[ne(e)];var h=d.flush(u);return ie(h)?h.then((function(r){return t.flushRemux(l,r,e),l})):(this.flushRemux(l,h,e),l)},t.flushRemux=function(e,t,r){var a=t.audioTrack,n=t.videoTrack,i=t.id3Track,o=t.textTrack,s=this.currentTransmuxState,l=s.accurateTimeOffset,u=s.timeOffset;g.logger.log("[transmuxer.ts]: Flushed fragment "+r.sn+(r.part>-1?" p: "+r.part:"")+" of level "+r.level);var c=this.remuxer.remux(a,n,i,o,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:r}),r.transmuxing.executeEnd=te()},t.resetInitialTimestamp=function(e){var t=this.demuxer,r=this.remuxer;t&&r&&(t.resetTimeStamp(e),r.resetTimeStamp(e))},t.resetContiguity=function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())},t.resetInitSegment=function(e,t,r,a,n){var i=this.demuxer,o=this.remuxer;i&&o&&(i.resetInitSegment(e,t,r,a),o.resetInitSegment(e,t,r,n))},t.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},t.transmux=function(e,t,r,a,n){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,r,a,n):this.transmuxUnencrypted(e,r,a,n)},t.transmuxUnencrypted=function(e,t,r,a){var n=this.demuxer.demux(e,t,!1,!this.config.progressive),i=n.audioTrack,o=n.videoTrack,s=n.id3Track,l=n.textTrack;return{remuxResult:this.remuxer.remux(i,o,s,l,t,r,!1,this.id),chunkMeta:a}},t.transmuxSampleAes=function(e,t,r,a,n){var i=this;return this.demuxer.demuxSampleAes(e,t,r).then((function(e){return{remuxResult:i.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,r,a,!1,i.id),chunkMeta:n}}))},t.configureTransmuxer=function(e){for(var t,r=this.config,a=this.observer,n=this.typeSupported,i=this.vendor,o=0,s=re.length;o<s;o++)if(re[o].demux.probe(e)){t=re[o];break}t||(g.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),t={demux:P,remux:ee});var l=this.demuxer,u=this.remuxer,c=t.remux,d=t.demux;u&&u instanceof c||(this.remuxer=new c(a,r,n,i)),l&&l instanceof d||(this.demuxer=new d(a,r,n),this.probe=d.probe)},t.needsProbing=function(e,t){return!this.demuxer||!this.remuxer||e||t},t.getDecrypter=function(){var e=this.decrypter;return e||(e=this.decrypter=new i.default(this.config)),e},e}(),ne=function(e){return{remuxResult:{},chunkMeta:e}};function ie(e){return"then"in e&&e.then instanceof Function}var oe=function(e,t,r,a,n){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=a,this.defaultInitPts=n},se=function(e,t,r,a,n,i){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=a,this.timeOffset=n,this.initSegmentChange=i}},973:(e,t,r)=>{"use strict";var a,n;r.r(t),r.d(t,{ErrorDetails:()=>n,ErrorTypes:()=>a}),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(a||(a={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown"}(n||(n={}))},851:(e,t,r)=>{"use strict";var a;r.r(t),r.d(t,{Events:()=>a}),function(e){e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached"}(a||(a={}))},76:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Ta});var a,n=r(945),i=r(965),o=r(851),s=r(973),l=r(93),u=/^(\d+)x(\d+)$/,c=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,d=function(){function e(t){for(var r in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),a=0;a<t.length/2;a++)r[a]=parseInt(t.slice(2*a,2*a+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.optionalFloat=function(e,t){var r=this[e];return r?parseFloat(r):t},t.enumeratedString=function(e){return this[e]},t.bool=function(e){return"YES"===this[e]},t.decimalResolution=function(e){var t=u.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,r={};for(c.lastIndex=0;null!==(t=c.exec(e));){var a=t[2];0===a.indexOf('"')&&a.lastIndexOf('"')===a.length-1&&(a=a.slice(1,-1)),r[t[1]]=a}return r},e}();function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}!function(e){e.ID="ID",e.CLASS="CLASS",e.START_DATE="START-DATE",e.DURATION="DURATION",e.END_DATE="END-DATE",e.END_ON_NEXT="END-ON-NEXT",e.PLANNED_DURATION="PLANNED-DURATION",e.SCTE35_OUT="SCTE35-OUT",e.SCTE35_IN="SCTE35-IN"}(a||(a={}));var h,f,g,y=function(){function e(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){var r=t.attr;for(var n in r)if(Object.prototype.hasOwnProperty.call(e,n)&&e[n]!==r[n]){l.logger.warn('DATERANGE tag attribute: "'+n+'" does not match for tags with ID: "'+e.ID+'"'),this._badValueForSameId=n;break}e=p(new d({}),r,e)}if(this.attr=e,this._startDate=new Date(e[a.START_DATE]),a.END_DATE in this.attr){var o=new Date(this.attr[a.END_DATE]);(0,i.isFiniteNumber)(o.getTime())&&(this._endDate=o)}}var t,r;return t=e,(r=[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}},{key:"duration",get:function(){if(a.DURATION in this.attr){var e=this.attr.decimalFloatingPoint(a.DURATION);if((0,i.isFiniteNumber)(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return a.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(a.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(a.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,i.isFiniteNumber)(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),m=r(923),v=function(){function e(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}var t,r;return e.prototype.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay},t=e,(r=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&(0,i.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var e;return null!==(e=this.fragments)&&void 0!==e&&e.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}function k(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(function(e){return e.charCodeAt(0)}))}function E(e){switch(e){case f.FAIRPLAY:return h.FAIRPLAY;case f.PLAYREADY:return h.PLAYREADY;case f.WIDEVINE:return h.WIDEVINE;case f.CLEARKEY:return h.CLEARKEY}}function T(e){switch(e){case h.FAIRPLAY:return f.FAIRPLAY;case h.PLAYREADY:return f.PLAYREADY;case h.WIDEVINE:return f.WIDEVINE;case h.CLEARKEY:return f.CLEARKEY}}function b(e){var t=e.drmSystems,r=e.widevineLicenseUrl,a=t?[h.FAIRPLAY,h.WIDEVINE,h.PLAYREADY,h.CLEARKEY].filter((function(e){return!!t[e]})):[];return!a[h.WIDEVINE]&&r&&a.push(h.WIDEVINE),a}!function(e){e.CLEARKEY="org.w3.clearkey",e.FAIRPLAY="com.apple.fps",e.PLAYREADY="com.microsoft.playready",e.WIDEVINE="com.widevine.alpha"}(h||(h={})),function(e){e.CLEARKEY="org.w3.clearkey",e.FAIRPLAY="com.apple.streamingkeydelivery",e.PLAYREADY="com.microsoft.playready",e.WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"}(f||(f={})),function(e){e.WIDEVINE="edef8ba979d64acea3c827dcd51d21ed"}(g||(g={}));var S="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null,A=r(63),C={},P=function(){function e(e,t,r,a,n){void 0===a&&(a=[1]),void 0===n&&(n=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=a,this.iv=n,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}e.clearKeyUriToKeyIdMap=function(){C={}};var t=e.prototype;return t.isSupported=function(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;switch(this.keyFormat){case"identity":return"SAMPLE-AES"===this.method;case f.FAIRPLAY:case f.WIDEVINE:case f.PLAYREADY:case f.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1},t.getDecryptData=function(t){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof t&&("AES-128"!==this.method||this.iv||l.logger.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),t=0);var r=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}(t);return new e(this.method,this.uri,"identity",this.keyFormatVersions,r)}var a=function(e){var t,r,a=e.split(":"),n=null;if("data"===a[0]&&2===a.length){var i=a[1].split(";"),o=i[i.length-1].split(",");if(2===o.length){var s="base64"===o[0],l=o[1];s?(i.splice(-1,1),n=_(l)):(t=k(l).subarray(0,16),(r=new Uint8Array(16)).set(t,16-t.length),n=r)}}return n}(this.uri);if(a)switch(this.keyFormat){case f.WIDEVINE:this.pssh=a,a.length>=22&&(this.keyId=a.subarray(a.length-22,a.length-6));break;case f.PLAYREADY:var n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=(0,A.mp4pssh)(n,null,a);var i=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2),o=String.fromCharCode.apply(null,Array.from(i)),s=o.substring(o.indexOf("<"),o.length),u=(new DOMParser).parseFromString(s,"text/xml").getElementsByTagName("KID")[0];if(u){var c=u.childNodes[0]?u.childNodes[0].nodeValue:u.getAttribute("VALUE");if(c){var d=_(c).subarray(0,16);!function(e){var t=function(e,t,r){var a=e[t];e[t]=e[r],e[r]=a};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(d),this.keyId=d}}break;default:var p=a.subarray(0,16);if(16!==p.length){var h=new Uint8Array(16);h.set(p,16-p.length),p=h}this.keyId=p}if(!this.keyId||16!==this.keyId.byteLength){var g=C[this.uri];if(!g){var y=Object.keys(C).length%Number.MAX_SAFE_INTEGER;g=new Uint8Array(16),new DataView(g.buffer,12,4).setUint32(0,y),C[this.uri]=g}this.keyId=g}return this},e}(),w={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function x(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}function I(){return(I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var M=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+|#EXT-X-SESSION-KEY:([^\n\r]*)[\r\n]+/g,D=/#EXT-X-MEDIA:(.*)/g,R=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),O=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),L=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var a=e[r];if(a.id===t)return a}},e.convertAVC1ToAVCOTI=function(e){var t=e.split(".");if(t.length>2){var r=t.shift()+".";return(r+=parseInt(t.shift()).toString(16))+("000"+parseInt(t.shift()).toString(16)).slice(-4)}return e},e.resolve=function(e,t){return(0,n.buildAbsoluteURL)(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,r){var a,n=[],i=[],o={},s=[],u=!1;for(M.lastIndex=0;null!=(a=M.exec(t));)if(a[1]){var c,p=new d(a[1]),h={attrs:p,bitrate:p.decimalInteger("AVERAGE-BANDWIDTH")||p.decimalInteger("BANDWIDTH"),name:p.NAME,url:e.resolve(a[2],r)},f=p.decimalResolution("RESOLUTION");f&&(h.width=f.width,h.height=f.height),U((p.CODECS||"").split(/[ ,]+/).filter((function(e){return e})),h),h.videoCodec&&-1!==h.videoCodec.indexOf("avc1")&&(h.videoCodec=e.convertAVC1ToAVCOTI(h.videoCodec)),null!==(c=h.unknownCodecs)&&void 0!==c&&c.length||i.push(h),n.push(h)}else if(a[3]){var g=new d(a[3]);g["DATA-ID"]&&(u=!0,o[g["DATA-ID"]]=g)}else if(a[4]){var y=a[4],m=N(y,r);m.encrypted&&m.isSupported()?s.push(m):l.logger.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+y+'"')}return{levels:i.length>0&&i.length<n.length?i:n,sessionData:u?o:null,sessionKeys:s.length?s:null}},e.parseMasterPlaylistMedia=function(t,r,a,n){var i;void 0===n&&(n=[]);var o=[],s=0;for(D.lastIndex=0;null!==(i=D.exec(t));){var l=new d(i[1]);if(l.TYPE===a){var u={attrs:l,bitrate:0,id:s++,groupId:l["GROUP-ID"],instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE||"",type:a,default:l.bool("DEFAULT"),autoselect:l.bool("AUTOSELECT"),forced:l.bool("FORCED"),lang:l.LANGUAGE,url:l.URI?e.resolve(l.URI,r):""};if(n.length){var c=e.findGroup(n,u.groupId)||n[0];F(u,c,"audioCodec"),F(u,c,"textCodec")}o.push(u)}}return o},e.parseLevelPlaylist=function(e,t,r,a,n){var o,s,u,c=new v(t),p=c.fragments,h=null,f=0,g=0,_=0,k=0,E=null,T=new m.Fragment(a,t),b=-1,S=!1;for(R.lastIndex=0,c.m3u8=e;null!==(o=R.exec(e));){S&&(S=!1,(T=new m.Fragment(a,t)).start=_,T.sn=f,T.cc=k,T.level=r,h&&(T.initSegment=h,T.rawProgramDateTime=h.rawProgramDateTime,h.rawProgramDateTime=null));var A=o[1];if(A){T.duration=parseFloat(A);var C=(" "+o[2]).slice(1);T.title=C||null,T.tagList.push(C?["INF",A,C]:["INF",A])}else if(o[3])(0,i.isFiniteNumber)(T.duration)&&(T.start=_,u&&V(T,u,c),T.sn=f,T.level=r,T.cc=k,T.urlId=n,p.push(T),T.relurl=(" "+o[3]).slice(1),B(T,E),E=T,_+=T.duration,f++,g=0,S=!0);else if(o[4]){var P=(" "+o[4]).slice(1);E?T.setByteRange(P,E):T.setByteRange(P)}else if(o[5])T.rawProgramDateTime=(" "+o[5]).slice(1),T.tagList.push(["PROGRAM-DATE-TIME",T.rawProgramDateTime]),-1===b&&(b=p.length);else{if(!(o=o[0].match(O))){l.logger.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<o.length&&void 0===o[s];s++);var w=(" "+o[s]).slice(1),x=(" "+o[s+1]).slice(1),M=o[s+2]?(" "+o[s+2]).slice(1):"";switch(w){case"PLAYLIST-TYPE":c.type=x.toUpperCase();break;case"MEDIA-SEQUENCE":f=c.startSN=parseInt(x);break;case"SKIP":var D=new d(x),L=D.decimalInteger("SKIPPED-SEGMENTS");if((0,i.isFiniteNumber)(L)){c.skippedSegments=L;for(var U=L;U--;)p.unshift(null);f+=L}var F=D.enumeratedString("RECENTLY-REMOVED-DATERANGES");F&&(c.recentlyRemovedDateranges=F.split("\t"));break;case"TARGETDURATION":c.targetduration=parseFloat(x);break;case"VERSION":c.version=parseInt(x);break;case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"#":(x||M)&&T.tagList.push(M?[x,M]:[x]);break;case"DISCONTINUITY":k++,T.tagList.push(["DIS"]);break;case"GAP":T.tagList.push([w]);break;case"BITRATE":T.tagList.push([w,x]);break;case"DATERANGE":var $=new d(x),H=new y($,c.dateRanges[$.ID]);H.isValid||c.skippedSegments?c.dateRanges[H.id]=H:l.logger.warn('Ignoring invalid DATERANGE tag: "'+x+'"'),T.tagList.push(["EXT-X-DATERANGE",x]);break;case"DISCONTINUITY-SEQUENCE":k=parseInt(x);break;case"KEY":var G=N(x,t);if(G.isSupported()){if("NONE"===G.method){u=void 0;break}u||(u={}),u[G.keyFormat]&&(u=I({},u)),u[G.keyFormat]=G}else l.logger.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+x+'"');break;case"START":var K=new d(x).decimalFloatingPoint("TIME-OFFSET");(0,i.isFiniteNumber)(K)&&(c.startTimeOffset=K);break;case"MAP":var W=new d(x);if(T.duration){var z=new m.Fragment(a,t);j(z,W,r,u),h=z,T.initSegment=h,h.rawProgramDateTime&&!T.rawProgramDateTime&&(T.rawProgramDateTime=h.rawProgramDateTime)}else j(T,W,r,u),h=T,S=!0;break;case"SERVER-CONTROL":var q=new d(x);c.canBlockReload=q.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=q.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&q.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=q.optionalFloat("PART-HOLD-BACK",0),c.holdBack=q.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var Y=new d(x);c.partTarget=Y.decimalFloatingPoint("PART-TARGET");break;case"PART":var X=c.partList;X||(X=c.partList=[]);var Q=g>0?X[X.length-1]:void 0,J=g++,Z=new m.Part(new d(x),T,t,J,Q);X.push(Z),T.duration+=Z.duration;break;case"PRELOAD-HINT":var ee=new d(x);c.preloadHint=ee;break;case"RENDITION-REPORT":var te=new d(x);c.renditionReports=c.renditionReports||[],c.renditionReports.push(te);break;default:l.logger.warn("line parsed but not handled: "+o)}}}E&&!E.relurl?(p.pop(),_-=E.duration,c.partList&&(c.fragmentHint=E)):c.partList&&(B(T,E),T.cc=k,c.fragmentHint=T,u&&V(T,u,c));var re=p.length,ae=p[0],ne=p[re-1];if((_+=c.skippedSegments*c.targetduration)>0&&re&&ne){c.averagetargetduration=_/re;var ie=ne.sn;c.endSN="initSegment"!==ie?ie:0,c.live||(ne.endList=!0),ae&&(c.startCC=ae.cc)}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(_+=c.fragmentHint.duration),c.totalduration=_,c.endCC=k,b>0&&function(e,t){for(var r=e[t],a=t;a--;){var n=e[a];if(!n)return;n.programDateTime=r.programDateTime-1e3*n.duration,r=n}}(p,b),c},e}();function N(e,t){var r,a,n=new d(e),i=null!=(r=n.enumeratedString("METHOD"))?r:"",o=n.URI,s=n.hexadecimalInteger("IV"),u=n.enumeratedString("KEYFORMATVERSIONS"),c=null!=(a=n.enumeratedString("KEYFORMAT"))?a:"identity";o&&n.IV&&!s&&l.logger.error("Invalid IV: "+n.IV);var p=o?L.resolve(o,t):"",h=(u||"1").split("/").map(Number).filter(Number.isFinite);return new P(i,p,c,h,s)}function U(e,t){["video","audio","text"].forEach((function(r){var a=e.filter((function(e){return function(e,t){var r=w[t];return!!r&&!0===r[e.slice(0,4)]}(e,r)}));if(a.length){var n=a.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[r+"Codec"]=n.length>0?n[0]:a[0],e=e.filter((function(e){return-1===a.indexOf(e)}))}})),t.unknownCodecs=e}function F(e,t,r){var a=t[r];a&&(e[r]=a)}function B(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),(0,i.isFiniteNumber)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function j(e,t,r,a){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=r,e.sn="initSegment",a&&(e.levelkeys=a),e.initSegment=null}function V(e,t,r){e.levelkeys=t;var a=r.encryptedFragments;a.length&&a[a.length-1].levelkeys===t||!Object.keys(t).some((function(e){return t[e].isCommonEncryption}))||a.push(e)}var $=r(308);function H(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r}const G=function(){function e(e){this.hls=void 0,this.loaders=Object.create(null),this.hls=e,this.registerListeners()}var t=e.prototype;return t.startLoad=function(e){},t.stopLoad=function(){this.destroyInternalLoaders()},t.registerListeners=function(){var e=this.hls;e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(o.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.unregisterListeners=function(){var e=this.hls;e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(o.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(o.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,a=t.loader,n=new(r||a)(t);return e.loader=n,this.loaders[e.type]=n,n},t.getInternalLoader=function(e){return this.loaders[e.type]},t.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},t.onManifestLoading=function(e,t){var r=t.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:$.PlaylistContextType.MANIFEST,url:r,deliveryDirectives:null})},t.onLevelLoading=function(e,t){var r=t.id,a=t.level,n=t.url,i=t.deliveryDirectives;this.load({id:r,groupId:null,level:a,responseType:"text",type:$.PlaylistContextType.LEVEL,url:n,deliveryDirectives:i})},t.onAudioTrackLoading=function(e,t){var r=t.id,a=t.groupId,n=t.url,i=t.deliveryDirectives;this.load({id:r,groupId:a,level:null,responseType:"text",type:$.PlaylistContextType.AUDIO_TRACK,url:n,deliveryDirectives:i})},t.onSubtitleTrackLoading=function(e,t){var r=t.id,a=t.groupId,n=t.url,i=t.deliveryDirectives;this.load({id:r,groupId:a,level:null,responseType:"text",type:$.PlaylistContextType.SUBTITLE_TRACK,url:n,deliveryDirectives:i})},t.load=function(e){var t,r,a,n,i,o,s=this.hls.config,u=this.getInternalLoader(e);if(u){var c=u.context;if(c&&c.url===e.url)return void l.logger.trace("[playlist-loader]: playlist request ongoing");l.logger.log("[playlist-loader]: aborting previous loader for type: "+e.type),u.abort()}switch(e.type){case $.PlaylistContextType.MANIFEST:r=s.manifestLoadingMaxRetry,a=s.manifestLoadingTimeOut,n=s.manifestLoadingRetryDelay,i=s.manifestLoadingMaxRetryTimeout;break;case $.PlaylistContextType.LEVEL:case $.PlaylistContextType.AUDIO_TRACK:case $.PlaylistContextType.SUBTITLE_TRACK:r=0,a=s.levelLoadingTimeOut;break;default:r=s.levelLoadingMaxRetry,a=s.levelLoadingTimeOut,n=s.levelLoadingRetryDelay,i=s.levelLoadingMaxRetryTimeout}if(u=this.createInternalLoader(e),null!==(t=e.deliveryDirectives)&&void 0!==t&&t.part&&(e.type===$.PlaylistContextType.LEVEL&&null!==e.level?o=this.hls.levels[e.level].details:e.type===$.PlaylistContextType.AUDIO_TRACK&&null!==e.id?o=this.hls.audioTracks[e.id].details:e.type===$.PlaylistContextType.SUBTITLE_TRACK&&null!==e.id&&(o=this.hls.subtitleTracks[e.id].details),o)){var d=o.partTarget,p=o.targetduration;d&&p&&(a=Math.min(1e3*Math.max(3*d,.8*p),a))}var h={timeout:a,maxRetry:r,retryDelay:n,maxRetryDelay:i,highWaterMark:0},f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};u.load(e,h,f)},t.loadsuccess=function(e,t,r,a){void 0===a&&(a=null),this.resetInternalLoader(r.type);var n=e.data;0===n.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),n.indexOf("#EXTINF:")>0||n.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(e,t,r,a):this.handleMasterPlaylist(e,t,r,a)):this.handleManifestParsingError(e,r,"no EXTM3U delimiter",a)},t.loaderror=function(e,t,r){void 0===r&&(r=null),this.handleNetworkError(t,r,!1,e)},t.loadtimeout=function(e,t,r){void 0===r&&(r=null),this.handleNetworkError(t,r,!0)},t.handleMasterPlaylist=function(e,t,r,a){var n=this.hls,i=e.data,s=H(e,r),u=L.parseMasterPlaylist(i,s),c=u.levels,p=u.sessionData,h=u.sessionKeys;if(c.length){var f=c.map((function(e){return{id:e.attrs.AUDIO,audioCodec:e.audioCodec}})),g=c.map((function(e){return{id:e.attrs.SUBTITLES,textCodec:e.textCodec}})),y=L.parseMasterPlaylistMedia(i,s,"AUDIO",f),m=L.parseMasterPlaylistMedia(i,s,"SUBTITLES",g),v=L.parseMasterPlaylistMedia(i,s,"CLOSED-CAPTIONS");y.length&&(y.some((function(e){return!e.url}))||!c[0].audioCodec||c[0].attrs.AUDIO||(l.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),y.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new d({}),bitrate:0,url:""}))),n.trigger(o.Events.MANIFEST_LOADED,{levels:c,audioTracks:y,subtitles:m,captions:v,url:s,stats:t,networkDetails:a,sessionData:p,sessionKeys:h})}else this.handleManifestParsingError(e,r,"no level found in manifest",a)},t.handleTrackOrLevelPlaylist=function(e,t,r,a){var n=this.hls,l=r.id,u=r.level,c=r.type,p=H(e,r),h=(0,i.isFiniteNumber)(l)?l:0,f=(0,i.isFiniteNumber)(u)?u:h,g=function(e){switch(e.type){case $.PlaylistContextType.AUDIO_TRACK:return $.PlaylistLevelType.AUDIO;case $.PlaylistContextType.SUBTITLE_TRACK:return $.PlaylistLevelType.SUBTITLE;default:return $.PlaylistLevelType.MAIN}}(r),y=L.parseLevelPlaylist(e.data,p,f,g,h);if(y.fragments.length){if(c===$.PlaylistContextType.MANIFEST){var m={attrs:new d({}),bitrate:0,details:y,name:"",url:p};n.trigger(o.Events.MANIFEST_LOADED,{levels:[m],audioTracks:[],url:p,stats:t,networkDetails:a,sessionData:null,sessionKeys:null})}t.parsing.end=performance.now(),r.levelDetails=y,this.handlePlaylistLoaded(e,t,r,a)}else n.trigger(o.Events.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:p,reason:"no fragments found in level",level:"number"==typeof r.level?r.level:void 0})},t.handleManifestParsingError=function(e,t,r,a){this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:t.type===$.PlaylistContextType.MANIFEST,url:e.url,reason:r,response:e,context:t,networkDetails:a})},t.handleNetworkError=function(e,t,r,a){void 0===r&&(r=!1),l.logger.warn("[playlist-loader]: A network "+(r?"timeout":"error")+" occurred while loading "+e.type+" level: "+e.level+" id: "+e.id+' group-id: "'+e.groupId+'"');var n=s.ErrorDetails.UNKNOWN,i=!1,u=this.getInternalLoader(e);switch(e.type){case $.PlaylistContextType.MANIFEST:n=r?s.ErrorDetails.MANIFEST_LOAD_TIMEOUT:s.ErrorDetails.MANIFEST_LOAD_ERROR,i=!0;break;case $.PlaylistContextType.LEVEL:n=r?s.ErrorDetails.LEVEL_LOAD_TIMEOUT:s.ErrorDetails.LEVEL_LOAD_ERROR,i=!1;break;case $.PlaylistContextType.AUDIO_TRACK:n=r?s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,i=!1;break;case $.PlaylistContextType.SUBTITLE_TRACK:n=r?s.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:s.ErrorDetails.SUBTITLE_LOAD_ERROR,i=!1}u&&this.resetInternalLoader(e.type);var c={type:s.ErrorTypes.NETWORK_ERROR,details:n,fatal:i,url:e.url,loader:u,context:e,networkDetails:t};a&&(c.response=a),this.hls.trigger(o.Events.ERROR,c)},t.handlePlaylistLoaded=function(e,t,r,a){var n=r.type,i=r.level,s=r.id,l=r.groupId,u=r.loader,c=r.levelDetails,d=r.deliveryDirectives;if(null!=c&&c.targetduration){if(u)switch(c.live&&(u.getCacheAge&&(c.ageHeader=u.getCacheAge()||0),u.getCacheAge&&!isNaN(c.ageHeader)||(c.ageHeader=0)),n){case $.PlaylistContextType.MANIFEST:case $.PlaylistContextType.LEVEL:this.hls.trigger(o.Events.LEVEL_LOADED,{details:c,level:i||0,id:s||0,stats:t,networkDetails:a,deliveryDirectives:d});break;case $.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(o.Events.AUDIO_TRACK_LOADED,{details:c,id:s||0,groupId:l||"",stats:t,networkDetails:a,deliveryDirectives:d});break;case $.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(o.Events.SUBTITLE_TRACK_LOADED,{details:c,id:s||0,groupId:l||"",stats:t,networkDetails:a,deliveryDirectives:d})}}else this.handleManifestParsingError(e,r,"invalid target duration",a)},e}();function K(e,t){var r;try{r=new Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function W(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){l.logger.debug("[texttrack-utils]: "+r);var a=new self.TextTrackCue(t.startTime,t.endTime,t.text);a.id=t.id,e.addCue(a)}"disabled"===r&&(e.mode=r)}function z(e){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(var r=e.cues.length;r--;)e.removeCue(e.cues[r]);"disabled"===t&&(e.mode=t)}function q(e,t,r,a){var n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&e.cues.length>0)for(var i=function(e,t,r){var a=[],n=function(e,t){if(t<e[0].startTime)return 0;var r=e.length-1;if(t>e[r].endTime)return-1;for(var a=0,n=r;a<=n;){var i=Math.floor((n+a)/2);if(t<e[i].startTime)n=i-1;else{if(!(t>e[i].startTime&&a<r))return i;a=i+1}}return e[a].startTime-t<t-e[n].startTime?a:n}(e,t);if(n>-1)for(var i=n,o=e.length;i<o;i++){var s=e[i];if(s.startTime>=t&&s.endTime<=r)a.push(s);else if(s.startTime>r)return a}return a}(e.cues,t,r),o=0;o<i.length;o++)a&&!a(i[o])||e.removeCue(i[o]);"disabled"===n&&(e.mode=n)}var Y=r(181),X=r(856);function Q(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var J=function(){var e=Q();try{new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function Z(e,t){return e.getTime()/1e3-t}const ee=function(){function e(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}var t=e.prototype;return t.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},t._registerListeners=function(){var e=this.hls;e.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(o.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(o.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},t._unregisterListeners=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(o.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(o.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},t.onMediaAttached=function(e,t){this.media=t.media},t.onMediaDetaching=function(){this.id3Track&&(z(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},t.onManifestLoading=function(){this.dateRangeCuesAppended={}},t.createTrack=function(e){var t=this.getID3Track(e.textTracks);return t.mode="hidden",t},t.getID3Track=function(e){if(this.media){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return K(r,this.media),r}return this.media.addTextTrack("metadata","id3")}},t.onFragParsingMetadata=function(e,t){if(this.media){var r=this.hls.config,a=r.enableEmsgMetadataCues,n=r.enableID3MetadataCues;if(a||n){var i=t.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var o=Q(),s=0;s<i.length;s++){var l=i[s].type;if((l!==X.MetadataSchema.emsg||a)&&n){var u=Y.getID3Frames(i[s].data);if(u){var c=i[s].pts,d=c+i[s].duration;d>J&&(d=J),d-c<=0&&(d=c+.25);for(var p=0;p<u.length;p++){var h=u[p];if(!Y.isTimeStampFrame(h)){this.updateId3CueEnds(c);var f=new o(c,d,"");f.value=h,l&&(f.type=l),this.id3Track.addCue(f)}}}}}}}},t.updateId3CueEnds=function(e){var t,r=null===(t=this.id3Track)||void 0===t?void 0:t.cues;if(r)for(var a=r.length;a--;){var n=r[a];n.startTime<e&&n.endTime===J&&(n.endTime=e)}},t.onBufferFlushing=function(e,t){var r=t.startOffset,a=t.endOffset,n=t.type,i=this.id3Track,o=this.hls;if(o){var s=o.config,l=s.enableEmsgMetadataCues,u=s.enableID3MetadataCues;i&&(l||u)&&q(i,r,a,"audio"===n?function(e){return e.type===X.MetadataSchema.audioId3&&u}:"video"===n?function(e){return e.type===X.MetadataSchema.emsg&&l}:function(e){return e.type===X.MetadataSchema.audioId3&&u||e.type===X.MetadataSchema.emsg&&l})}},t.onLevelUpdated=function(e,t){var r=this,n=t.details;if(this.media&&n.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var o=this.dateRangeCuesAppended,s=this.id3Track,l=n.dateRanges,u=Object.keys(l);if(s)for(var c=Object.keys(o).filter((function(e){return!u.includes(e)})),d=function(e){var t=c[e];Object.keys(o[t].cues).forEach((function(e){s.removeCue(o[t].cues[e])})),delete o[t]},p=c.length;p--;)d(p);var h=n.fragments[n.fragments.length-1];if(0!==u.length&&(0,i.isFiniteNumber)(null==h?void 0:h.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var f=h.programDateTime/1e3-h.start,g=Q(),y=function(e){var t=u[e],n=l[t],i=o[t],s=(null==i?void 0:i.cues)||{},c=(null==i?void 0:i.durationKnown)||!1,d=Z(n.startDate,f),p=J,h=n.endDate;if(h)p=Z(h,f),c=!0;else if(n.endOnNext&&!c){var y=u.reduce((function(e,t){var r=l[t];return r.class===n.class&&r.id!==t&&r.startDate>n.startDate&&e.push(r),e}),[]).sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()}))[0];y&&(p=Z(y.startDate,f),c=!0)}for(var m,v=Object.keys(n.attr),_=0;_<v.length;_++){var k=v[_];if(k!==a.ID&&k!==a.CLASS&&k!==a.START_DATE&&k!==a.DURATION&&k!==a.END_DATE&&k!==a.END_ON_NEXT){var E=s[k];if(E)c&&!i.durationKnown&&(E.endTime=p);else{var T=n.attr[k];E=new g(d,p,""),k!==a.SCTE35_OUT&&k!==a.SCTE35_IN||(m=T,T=Uint8Array.from(m.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),E.value={key:k,data:T},E.type=X.MetadataSchema.dateRange,r.id3Track.addCue(E),s[k]=E}}}o[t]={cues:s,dateRange:n,durationKnown:c}},m=0;m<u.length;m++)y(m)}}},e}();var te,re=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return t.timeupdate()},this.hls=e,this.config=e.config,this.registerListeners()}var t,r,a=e.prototype;return a.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},a.registerListeners=function(){this.hls.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(o.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(o.Events.ERROR,this.onError,this)},a.unregisterListeners=function(){this.hls.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(o.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(o.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(o.Events.ERROR,this.onError)},a.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},a.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},a.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},a.onLevelUpdated=function(e,t){var r=t.details;this.levelDetails=r,r.advanced&&this.timeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},a.onError=function(e,t){t.details===s.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,l.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},a.timeupdate=function(){var e=this.media,t=this.levelDetails;if(e&&t){this.currentTime=e.currentTime;var r=this.computeLatency();if(null!==r){this._latency=r;var a=this.config,n=a.lowLatencyMode,i=a.maxLiveSyncPlaybackRate;if(n&&1!==i){var o=this.targetLatency;if(null!==o){var s=r-o,l=s<Math.min(this.maxLatency,o+t.targetduration);if(t.live&&l&&s>.05&&this.forwardBufferLength>1){var u=Math.min(2,Math.max(1,i)),c=Math.round(2/(1+Math.exp(-.75*s-this.edgeStalled))*20)/20;e.playbackRate=Math.min(u,Math.max(1,c))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}}}}},a.estimateLiveEdge=function(){var e=this.levelDetails;return null===e?null:e.edge+e.age},a.computeLatency=function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime},t=e,(r=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config,t=this.levelDetails;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e)return null;var t=e.holdBack,r=e.partHoldBack,a=e.targetduration,n=this.config,i=n.liveSyncDuration,o=n.liveSyncDurationCount,s=n.lowLatencyMode,l=this.hls.userConfig,u=s&&r||t;(l.liveSyncDuration||l.liveSyncDurationCount||0===u)&&(u=void 0!==i?i:o*a);var c=a;return u+Math.min(1*this.stallCount,c)}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency,r=this.levelDetails;if(null===e||null===t||null===r)return null;var a=r.edge,n=e-t-this.edgeStalled,i=a-r.totalduration,o=a-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(i,n),o)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ae=["NONE","TYPE-0","TYPE-1","TYPE-2",null];!function(e){e.No="",e.Yes="YES",e.v2="v2"}(te||(te={}));var ne=function(){function e(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}return e.prototype.addDirectives=function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href},e}(),ie=function(){function e(e){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this.attrs=e.attrs,this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter((function(e){return e})).join(",").replace(/\.[^.,]+/g,"")}var t,r;return t=e,(r=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(e){var t=e%this.url.length;this._urlId!==t&&(this.details=void 0,this._urlId=t)}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function oe(){return(oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function se(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}}function le(e){var t={};e.forEach((function(e){var r=e.groupId||"";e.id=t[r]=t[r]||0,t[r]++}))}function ue(e,t){var r=t.startPTS;if((0,i.isFiniteNumber)(r)){var a,n=0;t.sn>e.sn?(n=r-e.start,a=e):(n=e.start-r,a=t),a.duration!==n&&(a.duration=n)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration:t.start=Math.max(e.start-t.duration,0)}function ce(e,t,r,a,n,o){a-r<=0&&(l.logger.warn("Fragment should have a positive duration",t),a=r+t.duration,o=n+t.duration);var s=r,u=a,c=t.startPTS,d=t.endPTS;if((0,i.isFiniteNumber)(c)){var p=Math.abs(c-r);(0,i.isFiniteNumber)(t.deltaPTS)?t.deltaPTS=Math.max(p,t.deltaPTS):t.deltaPTS=p,s=Math.max(r,c),r=Math.min(r,c),n=Math.min(n,t.startDTS),u=Math.min(a,d),a=Math.max(a,d),o=Math.max(o,t.endDTS)}t.duration=a-r;var h=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.startDTS=n,t.endPTS=a,t.minEndPTS=u,t.endDTS=o;var f,g=t.sn;if(!e||g<e.startSN||g>e.endSN)return 0;var y=g-e.startSN,m=e.fragments;for(m[y]=t,f=y;f>0;f--)ue(m[f],m[f-1]);for(f=y;f<m.length-1;f++)ue(m[f],m[f+1]);return e.fragmentHint&&ue(m[m.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,h}function de(e,t){var r=t.startSN+t.skippedSegments-e.startSN,a=e.fragments;r<0||r>=a.length||pe(t,a[r].start)}function pe(e,t){if(t){for(var r=e.fragments,a=e.skippedSegments;a<r.length;a++)r[a].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}var he=function(){function e(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=l.logger.log.bind(l.logger,t+":"),this.warn=l.logger.warn.bind(l.logger,t+":"),this.hls=e}var t=e.prototype;return t.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},t.onError=function(e,t){!t.fatal||t.type!==s.ErrorTypes.NETWORK_ERROR&&t.type!==s.ErrorTypes.KEY_SYSTEM_ERROR||this.stopLoad()},t.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},t.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.requestScheduled=-1,this.loadPlaylist()},t.stopLoad=function(){this.canLoad=!1,this.clearTimer()},t.switchParams=function(e,t){var r=null==t?void 0:t.renditionReports;if(r)for(var a=0;a<r.length;a++){var n=r[a],i=void 0;try{i=new self.URL(n.URI,t.url).href}catch(e){l.logger.warn("Could not construct new URL for Rendition Report: "+e),i=n.URI||""}if(i===e.slice(-i.length)){var o=parseInt(n["LAST-MSN"])||(null==t?void 0:t.lastPartSn),s=parseInt(n["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){var u=Math.min(t.age-t.partTarget,t.targetduration);s>=0&&u>t.partTarget&&(s+=1)}return new ne(o,s>=0?s:void 0,te.No)}}},t.loadPlaylist=function(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())},t.shouldLoadTrack=function(e){return this.canLoad&&e&&!!e.url&&(!e.details||e.details.live)},t.playlistLoaded=function(e,t,r){var a=this,n=t.details,o=t.stats,s=self.performance.now(),u=o.loading.first?Math.max(0,s-o.loading.first):0;if(n.advancedDateTime=Date.now()-u,n.live||null!=r&&r.live){if(n.reloaded(r),r&&this.log("live playlist "+e+" "+(n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:"MISSED")),r&&n.fragments.length>0&&function(e,t){for(var r=null,a=e.fragments,n=a.length-1;n>=0;n--){var o=a[n].initSegment;if(o){r=o;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;var s,u,c,d,p,h=0;if(function(e,t,r){for(var a=t.skippedSegments,n=Math.max(e.startSN,t.startSN)-t.startSN,i=(e.fragmentHint?1:0)+(a?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=n;u<=i;u++){var c=l[o+u],d=s[u];a&&!d&&u<a&&(d=t.fragments[u]=c),c&&d&&r(c,d)}}(e,t,(function(e,a){e.relurl&&(h=e.cc-a.cc),(0,i.isFiniteNumber)(e.startPTS)&&(0,i.isFiniteNumber)(e.endPTS)&&(a.start=a.startPTS=e.startPTS,a.startDTS=e.startDTS,a.appendedPTS=e.appendedPTS,a.maxStartPTS=e.maxStartPTS,a.endPTS=e.endPTS,a.endDTS=e.endDTS,a.minEndPTS=e.minEndPTS,a.duration=e.endPTS-e.startPTS,a.duration&&(s=a),t.PTSKnown=t.alignedSliding=!0),a.elementaryStreams=e.elementaryStreams,a.loader=e.loader,a.stats=e.stats,a.urlId=e.urlId,e.initSegment&&(a.initSegment=e.initSegment,r=e.initSegment)})),r&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach((function(e){var t;e.initSegment&&e.initSegment.relurl!==(null===(t=r)||void 0===t?void 0:t.relurl)||(e.initSegment=r)})),t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some((function(e){return!e})),t.deltaUpdateFailed){l.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var f=t.skippedSegments;f--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=(u=e.dateRanges,c=t.dateRanges,d=t.recentlyRemovedDateranges,p=oe({},u),d&&d.forEach((function(e){delete p[e]})),Object.keys(c).forEach((function(e){var t=new y(c[e].attr,p[e]);t.isValid?p[e]=t:l.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(c[e].attr)+'"')})),p));var g=t.fragments;if(h){l.logger.warn("discontinuity sliding from playlist, take drift into account");for(var m=0;m<g.length;m++)g[m].cc+=h}t.skippedSegments&&(t.startCC=t.fragments[0].cc),function(e,t,r){if(e&&t)for(var a=0,n=0,i=e.length;n<=i;n++){var o=e[n],s=t[n+a];o&&s&&o.index===s.index&&o.fragment.sn===s.fragment.sn?(l=o,(u=s).elementaryStreams=l.elementaryStreams,u.stats=l.stats):a--}var l,u}(e.partList,t.partList),s?ce(t,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):de(e,t),g.length&&(t.totalduration=t.edge-g[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var v=t.advancedDateTime;if(t.advanced&&v){var _=t.edge;t.driftStart||(t.driftStartTime=v,t.driftStart=_),t.driftEndTime=v,t.driftEnd=_}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}(r,n),!this.canLoad||!n.live)return;var c,d=void 0,p=void 0;if(n.canBlockReload&&n.endSN&&n.advanced){var h=this.hls.config.lowLatencyMode,f=n.lastPartSn,g=n.endSN,m=n.lastPartIndex,v=f===g;-1!==m?(d=v?g+1:f,p=v?h?0:m:m+1):d=g+1;var _=n.age,k=_+n.ageHeader,E=Math.min(k-n.partTarget,1.5*n.targetduration);if(E>0){if(r&&E>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+r.tuneInGoal+" to: "+E+" with playlist age: "+n.age),E=0;else{var T=Math.floor(E/n.targetduration);d+=T,void 0!==p&&(p+=Math.round(E%n.targetduration/n.partTarget)),this.log("CDN Tune-in age: "+n.ageHeader+"s last advanced "+_.toFixed(2)+"s goal: "+E+" skip sn "+T+" to part "+p)}n.tuneInGoal=E}if(c=this.getDeliveryDirectives(n,t.deliveryDirectives,d,p),h||!v)return void this.loadPlaylist(c)}else c=this.getDeliveryDirectives(n,t.deliveryDirectives,d,p);var b=this.hls.mainForwardBufferInfo,S=b?b.end-b.len:0,A=function(e,t){void 0===t&&(t=1/0);var r=1e3*e.targetduration;if(e.updated){var a=e.fragments;if(a.length&&4*r>t){var n=1e3*a[a.length-1].duration;n<r&&(r=n)}}else r/=2;return Math.round(r)}(n,1e3*(n.edge-S));n.updated?s>this.requestScheduled+A&&(this.requestScheduled=o.loading.start):this.requestScheduled=-1,void 0!==d&&n.canBlockReload?this.requestScheduled=o.loading.first+A-(1e3*n.partTarget||1e3):this.requestScheduled=(-1===this.requestScheduled?s:this.requestScheduled)+A;var C=this.requestScheduled-s;C=Math.max(0,C),this.log("reload live playlist "+e+" in "+Math.round(C)+" ms"),this.timer=self.setTimeout((function(){return a.loadPlaylist(c)}),C)}else this.clearTimer()},t.getDeliveryDirectives=function(e,t,r,a){var n=function(e,t){var r=e.canSkipUntil,a=e.canSkipDateRanges,n=e.endSN;return r&&(void 0!==t?t-n:0)<r?a?te.v2:te.Yes:te.No}(e,r);return null!=t&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,a=t.part,n=te.No),new ne(r,a,n)},t.retryLoadingOrFail=function(e){var t,r=this,a=this.hls.config,n=this.retryCount<a.levelLoadingMaxRetry;if(n)if(this.requestScheduled=-1,this.retryCount++,e.details.indexOf("LoadTimeOut")>-1&&null!==(t=e.context)&&void 0!==t&&t.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+e.details+'"'),this.loadPlaylist();else{var i=Math.min(Math.pow(2,this.retryCount)*a.levelLoadingRetryDelay,a.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout((function(){return r.loadPlaylist()}),i),this.warn("retry playlist loading #"+this.retryCount+" in "+i+' ms after "'+e.details+'"')}else this.warn('cannot recover from error "'+e.details+'"'),this.clearTimer(),e.fatal=!0;return n},e}();function fe(){return(fe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ge(e,t){return(ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var ye,me=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),ve=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,"[level-controller]")||this)._levels=[],r._firstLevel=-1,r._startLevel=void 0,r.currentLevelIndex=-1,r.manualLevelIndex=-1,r.onParsedComplete=void 0,r._registerListeners(),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,ge(t,r);var n,i,l=a.prototype;return l._registerListeners=function(){var e=this.hls;e.on(o.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(o.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(o.Events.ERROR,this.onError,this)},l._unregisterListeners=function(){var e=this.hls;e.off(o.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(o.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(o.Events.ERROR,this.onError,this)},l.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,e.prototype.destroy.call(this)},l.startLoad=function(){this._levels.forEach((function(e){e.loadError=0})),e.prototype.startLoad.call(this)},l.onManifestLoaded=function(e,t){var r,a,n=[],i=[],l=[],u={},c=!1,d=!1,p=!1;if(t.levels.forEach((function(e){var t=e.attrs;c=c||!(!e.width||!e.height),d=d||!!e.videoCodec,p=p||!!e.audioCodec,me&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0);var r=e.bitrate+"-"+e.attrs.RESOLUTION+"-"+e.attrs.CODECS;(a=u[r])?a.url.push(e.url):(a=new ie(e),u[r]=a,n.push(a)),t&&(t.AUDIO&&se(a,"audio",t.AUDIO),t.SUBTITLES&&se(a,"text",t.SUBTITLES))})),(c||d)&&p&&(n=n.filter((function(e){var t=e.videoCodec,r=e.width,a=e.height;return!!t||!(!r||!a)}))),n=n.filter((function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||x(t,"audio"))&&(!r||x(r,"video"))})),t.audioTracks&&le(i=t.audioTracks.filter((function(e){return!e.audioCodec||x(e.audioCodec,"audio")}))),t.subtitles&&le(l=t.subtitles),n.length>0){r=n[0].bitrate,n.sort((function(e,t){return e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"]?(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1:e.bitrate!==t.bitrate?e.bitrate-t.bitrate:e.attrs.SCORE!==t.attrs.SCORE?e.attrs.decimalFloatingPoint("SCORE")-t.attrs.decimalFloatingPoint("SCORE"):c&&e.height!==t.height?e.height-t.height:0})),this._levels=n;for(var h=0;h<n.length;h++)if(n[h].bitrate===r){this._firstLevel=h,this.log("manifest loaded, "+n.length+" level(s) found, first bitrate: "+r);break}var f=p&&!d,g={levels:n,audioTracks:i,subtitleTracks:l,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:p,video:d,altAudio:!f&&i.some((function(e){return!!e.url}))};this.hls.trigger(o.Events.MANIFEST_PARSED,g),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,reason:"no level with compatible codecs found in manifest"})},l.onError=function(t,r){var a,n;if(e.prototype.onError.call(this,t,r),!r.fatal){var i=r.context,o=this._levels[this.currentLevelIndex];if(i&&(i.type===$.PlaylistContextType.AUDIO_TRACK&&o.audioGroupIds&&i.groupId===o.audioGroupIds[o.urlId]||i.type===$.PlaylistContextType.SUBTITLE_TRACK&&o.textGroupIds&&i.groupId===o.textGroupIds[o.urlId]))this.redundantFailover(this.currentLevelIndex);else{var l,u=!1,c=!0;switch(r.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:if(r.frag){var d=r.frag.type===$.PlaylistLevelType.MAIN?r.frag.level:this.currentLevelIndex,p=this._levels[d];p?(p.fragmentError++,p.fragmentError>this.hls.config.fragLoadingMaxRetry&&(l=d)):l=d}break;case s.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var h=o.attrs["HDCP-LEVEL"];h&&(this.hls.maxHdcpLevel=ae[ae.indexOf(h)-1],this.warn('Restricting playback to HDCP-LEVEL of "'+this.hls.maxHdcpLevel+'" or lower'));case s.ErrorDetails.FRAG_PARSING_ERROR:case s.ErrorDetails.KEY_SYSTEM_NO_SESSION:l=(null===(a=r.frag)||void 0===a?void 0:a.type)===$.PlaylistLevelType.MAIN?r.frag.level:this.currentLevelIndex,r.levelRetry=!1;break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:i&&(i.deliveryDirectives&&(c=!1),l=i.level),u=!0;break;case s.ErrorDetails.REMUX_ALLOC_ERROR:l=null!=(n=r.level)?n:this.currentLevelIndex,u=!0}void 0!==l&&this.recoverLevel(r,l,u,c)}}},l.recoverLevel=function(e,t,r,a){var n=e.details,i=this._levels[t];if(i.loadError++,r){if(!this.retryLoadingOrFail(e))return void(this.currentLevelIndex=-1);e.levelRetry=!0}if(a){var o=i.url.length;if(o>1&&i.loadError<o)e.levelRetry=!0,this.redundantFailover(t);else if(-1===this.manualLevelIndex){for(var s=-1,l=this._levels,u=l.length;u--;){var c=(u+this.currentLevelIndex)%l.length;if(c!==this.currentLevelIndex&&0===l[c].loadError){s=c;break}}s>-1&&this.currentLevelIndex!==s?(this.warn(n+": switch to "+s),e.levelRetry=!0,this.hls.nextAutoLevel=s):!1===e.levelRetry&&(e.fatal=!0)}}},l.redundantFailover=function(e){var t=this._levels[e],r=t.url.length;if(r>1){var a=(t.urlId+1)%r;this.warn("Switching to redundant URL-id "+a),this._levels.forEach((function(e){e.urlId=a})),this.level=e}},l.onFragLoaded=function(e,t){var r=t.frag;if(void 0!==r&&r.type===$.PlaylistLevelType.MAIN){var a=this._levels[r.level];void 0!==a&&(a.fragmentError=0,a.loadError=0)}},l.onLevelLoaded=function(e,t){var r,a,n=t.level,i=t.details,o=this._levels[n];if(!o)return this.warn("Invalid level index "+n),void(null!==(a=t.deliveryDirectives)&&void 0!==a&&a.skip&&(i.deltaUpdateFailed=!0));n===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0,this.retryCount=0),this.playlistLoaded(n,t,o.details)):null!==(r=t.deliveryDirectives)&&void 0!==r&&r.skip&&(i.deltaUpdateFailed=!0)},l.onAudioTrackSwitched=function(e,t){var r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var a=-1,n=this.hls.audioTracks[t.id].groupId,i=0;i<r.audioGroupIds.length;i++)if(r.audioGroupIds[i]===n){a=i;break}a!==r.urlId&&(r.urlId=a,this.startLoad())}},l.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.currentLevelIndex,a=this._levels[r];if(this.canLoad&&a&&a.url.length>0){var n=a.urlId,i=a.url[n];if(t)try{i=t.addDirectives(i)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("Attempt loading level index "+r+(void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:"")+" with URL-id "+n+" "+i),this.clearTimer(),this.hls.trigger(o.Events.LEVEL_LOADING,{url:i,level:r,id:n,deliveryDirectives:t||null})}},l.removeLevel=function(e,t){var r=function(e,r){return r!==t},a=this._levels.filter((function(a,n){return n!==e||a.url.length>1&&void 0!==t&&(a.url=a.url.filter(r),a.audioGroupIds&&(a.audioGroupIds=a.audioGroupIds.filter(r)),a.textGroupIds&&(a.textGroupIds=a.textGroupIds.filter(r)),a.urlId=0,!0)})).map((function(e,t){var r=e.details;return null!=r&&r.fragments&&r.fragments.forEach((function(e){e.level=t})),e}));this._levels=a,this.hls.trigger(o.Events.LEVELS_UPDATED,{levels:a})},n=a,(i=[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t,r=this._levels;if(0!==r.length&&(this.currentLevelIndex!==e||null===(t=r[e])||void 0===t||!t.details)){if(e<0||e>=r.length){var a=e<0;if(this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:a,reason:"invalid level idx"}),a)return;e=Math.min(e,r.length-1)}this.clearTimer();var n=this.currentLevelIndex,i=r[n],l=r[e];this.log("switching to level "+e+" from "+n),this.currentLevelIndex=e;var u=fe({},l,{level:e,maxBitrate:l.maxBitrate,uri:l.uri,urlId:l.urlId});delete u._urlId,this.hls.trigger(o.Events.LEVEL_SWITCHING,u);var c=l.details;if(!c||c.live){var d=this.switchParams(l.uri,null==i?void 0:i.details);this.loadPlaylist(d)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),a}(he);!function(e){e.NOT_LOADED="NOT_LOADED",e.APPENDING="APPENDING",e.PARTIAL="PARTIAL",e.OK="OK"}(ye||(ye={}));var _e=function(){function e(e){this.activeFragment=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=e,this._registerListeners()}var t=e.prototype;return t._registerListeners=function(){var e=this.hls;e.on(o.Events.BUFFER_APPENDED,this.onBufferAppended,this),e.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(o.Events.FRAG_LOADED,this.onFragLoaded,this)},t._unregisterListeners=function(){var e=this.hls;e.off(o.Events.BUFFER_APPENDED,this.onBufferAppended,this),e.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(o.Events.FRAG_LOADED,this.onFragLoaded,this)},t.destroy=function(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.activeFragment=this.activeParts=null},t.getAppendedFrag=function(e,t){if(t===$.PlaylistLevelType.MAIN){var r=this.activeFragment,a=this.activeParts;if(!r)return null;if(a)for(var n=a.length;n--;){var i=a[n],o=i?i.end:r.appendedPTS;if(i.start<=e&&void 0!==o&&e<=o)return n>9&&(this.activeParts=a.slice(n-9)),i}else if(r.start<=e&&void 0!==r.appendedPTS&&e<=r.appendedPTS)return r}return this.getBufferedFrag(e,t)},t.getBufferedFrag=function(e,t){for(var r=this.fragments,a=Object.keys(r),n=a.length;n--;){var i=r[a[n]];if((null==i?void 0:i.body.type)===t&&i.buffered){var o=i.body;if(o.start<=e&&e<=o.end)return o}}return null},t.detectEvictedFragments=function(e,t,r){var a=this;this.timeRanges&&(this.timeRanges[e]=t),Object.keys(this.fragments).forEach((function(n){var i=a.fragments[n];if(i)if(i.buffered||i.loaded){var o=i.range[e];o&&o.time.some((function(e){var r=!a.isTimeBuffered(e.startPTS,e.endPTS,t);return r&&a.removeFragment(i.body),r}))}else i.body.type===r&&a.removeFragment(i.body)}))},t.detectPartialFragments=function(e){var t=this,r=this.timeRanges,a=e.frag,n=e.part;if(r&&"initSegment"!==a.sn){var i=Ee(a),o=this.fragments[i];o&&(Object.keys(r).forEach((function(e){var i=a.elementaryStreams[e];if(i){var s=r[e],l=null!==n||!0===i.partial;o.range[e]=t.getBufferedTimes(a,n,l,s)}})),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,o.body.endList&&(this.endListFragments[o.body.type]=o)):this.removeFragment(o.body))}},t.fragBuffered=function(e){var t=Ee(e),r=this.fragments[t];r&&(r.loaded=null,r.buffered=!0)},t.getBufferedTimes=function(e,t,r,a){for(var n={time:[],partial:r},i=t?t.start:e.start,o=t?t.end:e.end,s=e.minEndPTS||o,l=e.maxStartPTS||i,u=0;u<a.length;u++){var c=a.start(u)-this.bufferPadding,d=a.end(u)+this.bufferPadding;if(l>=c&&s<=d){n.time.push({startPTS:Math.max(i,a.start(u)),endPTS:Math.min(o,a.end(u))});break}if(i<d&&o>c)n.partial=!0,n.time.push({startPTS:Math.max(i,a.start(u)),endPTS:Math.min(o,a.end(u))});else if(o<=c)break}return n},t.getPartialFragment=function(e){var t,r,a,n=null,i=0,o=this.bufferPadding,s=this.fragments;return Object.keys(s).forEach((function(l){var u=s[l];u&&ke(u)&&(r=u.body.start-o,a=u.body.end+o,e>=r&&e<=a&&(t=Math.min(e-r,a-e),i<=t&&(n=u.body,i=t)))})),n},t.isEndListAppended=function(e){var t=this.endListFragments[e];return void 0!==t&&(t.buffered||ke(t))},t.getState=function(e){var t=Ee(e),r=this.fragments[t];return r?r.buffered?ke(r)?ye.PARTIAL:ye.OK:ye.APPENDING:ye.NOT_LOADED},t.isTimeBuffered=function(e,t,r){for(var a,n,i=0;i<r.length;i++){if(a=r.start(i)-this.bufferPadding,n=r.end(i)+this.bufferPadding,e>=a&&t<=n)return!0;if(t<=a)return!1}return!1},t.onFragLoaded=function(e,t){var r=t.frag,a=t.part;if("initSegment"!==r.sn&&!r.bitrateTest&&!a){var n=Ee(r);this.fragments[n]={body:r,loaded:t,buffered:!1,range:Object.create(null)}}},t.onBufferAppended=function(e,t){var r=this,a=t.frag,n=t.part,i=t.timeRanges;if(a.type===$.PlaylistLevelType.MAIN)if(this.activeFragment!==a&&(this.activeFragment=a,a.appendedPTS=void 0),n){var o=this.activeParts;o||(this.activeParts=o=[]),o.push(n)}else this.activeParts=null;this.timeRanges=i,Object.keys(i).forEach((function(e){var t=i[e];if(r.detectEvictedFragments(e,t),!n&&a.type===$.PlaylistLevelType.MAIN){var o=a.elementaryStreams[e];if(!o)return;for(var s=0;s<t.length;s++){var l=t.end(s);l<=o.endPTS&&l>o.startPTS?a.appendedPTS=Math.max(l,a.appendedPTS||0):a.appendedPTS=o.endPTS}}}))},t.onFragBuffered=function(e,t){this.detectPartialFragments(t)},t.hasFragment=function(e){var t=Ee(e);return!!this.fragments[t]},t.removeFragmentsInRange=function(e,t,r){var a=this;Object.keys(this.fragments).forEach((function(n){var i=a.fragments[n];if(i&&i.buffered){var o=i.body;o.type===r&&o.start<t&&o.end>e&&a.removeFragment(o)}}))},t.removeFragment=function(e){var t=Ee(e);e.stats.loaded=0,e.clearElementaryStreamInfo(),e.appendedPTS=void 0,delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]},t.removeAllFragments=function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activeFragment=null,this.activeParts=null},e}();function ke(e){var t,r;return e.buffered&&((null===(t=e.range.video)||void 0===t?void 0:t.partial)||(null===(r=e.range.audio)||void 0===r?void 0:r.partial))}function Ee(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn}function Te(e){var t="function"==typeof Map?new Map:void 0;return(Te=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return be(e,arguments,Ce(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),Ae(a,e)})(e)}function be(e,t,r){return(be=Se()?Reflect.construct.bind():function(e,t,r){var a=[null];a.push.apply(a,t);var n=new(Function.bind.apply(e,a));return r&&Ae(n,r.prototype),n}).apply(null,arguments)}function Se(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ae(e,t){return(Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pe=Math.pow(2,17),we=function(){function e(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}var t=e.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,t){var r=this,a=e.url;if(!a)return Promise.reject(new Ie({type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,networkDetails:null},"Fragment does not have a "+(a?"part list":"url")));this.abort();var n=this.config,i=n.fLoader,o=n.loader;return new Promise((function(a,l){r.loader&&r.loader.destroy();var u=r.loader=e.loader=i?new i(n):new o(n),c=xe(e),d={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout,highWaterMark:"initSegment"===e.sn?1/0:Pe};e.stats=u.stats,u.load(c,d,{onSuccess:function(t,n,i,o){r.resetLoader(e,u);var s=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),a({frag:e,part:null,payload:s,networkDetails:o})},onError:function(t,a,n){r.resetLoader(e,u),l(new Ie({type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:t,networkDetails:n}))},onAbort:function(t,a,n){r.resetLoader(e,u),l(new Ie({type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,networkDetails:n}))},onTimeout:function(t,a,n){r.resetLoader(e,u),l(new Ie({type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,networkDetails:n}))},onProgress:function(r,a,n,i){t&&t({frag:e,part:null,payload:n,networkDetails:i})}})}))},t.loadPart=function(e,t,r){var a=this;this.abort();var n=this.config,i=n.fLoader,o=n.loader;return new Promise((function(l,u){a.loader&&a.loader.destroy();var c=a.loader=e.loader=i?new i(n):new o(n),d=xe(e,t),p={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout,highWaterMark:Pe};t.stats=c.stats,c.load(d,p,{onSuccess:function(n,i,o,s){a.resetLoader(e,c),a.updateStatsFromPart(e,t);var u={frag:e,part:t,payload:n.data,networkDetails:s};r(u),l(u)},onError:function(r,n,i){a.resetLoader(e,c),u(new Ie({type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:r,networkDetails:i}))},onAbort:function(r,n,i){e.stats.aborted=t.stats.aborted,a.resetLoader(e,c),u(new Ie({type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,networkDetails:i}))},onTimeout:function(r,n,i){a.resetLoader(e,c),u(new Ie({type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,networkDetails:i}))}})}))},t.updateStatsFromPart=function(e,t){var r=e.stats,a=t.stats,n=a.total;if(r.loaded+=a.loaded,n){var i=Math.round(e.duration/t.duration),o=Math.min(Math.round(r.loaded/n),i),s=(i-o)*Math.round(r.loaded/o);r.total=r.loaded+s}else r.total=Math.max(r.loaded,r.total);var l=r.loading,u=a.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end},t.resetLoader=function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()},e}();function xe(e,t){void 0===t&&(t=null);var r=t||e,a={frag:e,part:t,responseType:"arraybuffer",url:r.url,headers:{},rangeStart:0,rangeEnd:0},n=r.byteRangeStartOffset,o=r.byteRangeEndOffset;if((0,i.isFiniteNumber)(n)&&(0,i.isFiniteNumber)(o)){var s,l=n,u=o;if("initSegment"===e.sn&&"AES-128"===(null===(s=e.decryptdata)||void 0===s?void 0:s.method)){var c=o-n;c%16&&(u=o+(16-c%16)),0!==n&&(a.resetIV=!0,l=n-16)}a.rangeStart=l,a.rangeEnd=u}return a}var Ie=function(e){var t,r;function a(t){for(var r,a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];return(r=e.call.apply(e,[this].concat(n))||this).data=void 0,r.data=t,r}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Ae(t,r),a}(Te(Error)),Me=function(){function e(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}var t=e.prototype;return t.abort=function(){for(var e in this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e].loader;t&&t.abort()}},t.detach=function(){for(var e in this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}},t.destroy=function(){for(var e in this.detach(),this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}},t.createKeyLoadError=function(e,t,r,a){return void 0===t&&(t=s.ErrorDetails.KEY_LOAD_ERROR),new Ie({type:s.ErrorTypes.NETWORK_ERROR,details:t,fatal:!1,frag:e,networkDetails:r})},t.loadClear=function(e,t){var r=this;if(this.emeController&&this.config.emeEnabled)for(var a=e.sn,n=e.cc,i=function(e){var i=t[e];if(n<=i.cc&&("initSegment"===a||a<i.sn))return r.emeController.selectKeySystemFormat(i).then((function(e){i.setKeyFormat(e)})),"break"},o=0;o<t.length&&"break"!==i(o);o++);},t.load=function(e){var t=this;return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then((function(r){return t.loadInternal(e,r)})):this.loadInternal(e)},t.loadInternal=function(e,t){var r,a;t&&e.setKeyFormat(t);var n=e.decryptdata;if(!n){var i=t?"Expected frag.decryptdata to be defined after setting format "+t:"Missing decryption data on fragment in onKeyLoading";return Promise.reject(this.createKeyLoadError(e,s.ErrorDetails.KEY_LOAD_ERROR,null,i))}var o=n.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,s.ErrorDetails.KEY_LOAD_ERROR,null,'Invalid key URI: "'+o+'"'));var l,u=this.keyUriToKeyInfo[o];if(null!==(r=u)&&void 0!==r&&r.decryptdata.key)return n.key=u.decryptdata.key,Promise.resolve({frag:e,keyInfo:u});if(null!==(a=u)&&void 0!==a&&a.keyLoadPromise)switch(null===(l=u.mediaKeySessionContext)||void 0===l?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return u.keyLoadPromise.then((function(t){return n.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:u}}))}switch(u=this.keyUriToKeyInfo[o]={decryptdata:n,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},n.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===n.keyFormat?this.loadKeyHTTP(u,e):this.loadKeyEME(u,e);case"AES-128":return this.loadKeyHTTP(u,e);default:return Promise.reject(this.createKeyLoadError(e,s.ErrorDetails.KEY_LOAD_ERROR,null,'Key supplied with unsupported METHOD: "'+n.method+'"'))}},t.loadKeyEME=function(e,t){var r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var a=this.emeController.loadKey(r);if(a)return(e.keyLoadPromise=a.then((function(t){return e.mediaKeySessionContext=t,r}))).catch((function(t){throw e.keyLoadPromise=null,t}))}return Promise.resolve(r)},t.loadKeyHTTP=function(e,t){var r=this,a=this.config,n=new(0,a.loader)(a);return t.keyLoader=e.loader=n,e.keyLoadPromise=new Promise((function(i,o){var l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout,highWaterMark:0},c={onSuccess:function(e,t,a,n){var l=a.frag,u=a.keyInfo,c=a.url;if(!l.decryptdata||u!==r.keyUriToKeyInfo[c])return o(r.createKeyLoadError(l,s.ErrorDetails.KEY_LOAD_ERROR,n,"after key load, decryptdata unset or changed"));u.decryptdata.key=l.decryptdata.key=new Uint8Array(e.data),l.keyLoader=null,u.loader=null,i({frag:l,keyInfo:u})},onError:function(e,a,n){r.resetLoader(a),o(r.createKeyLoadError(t,s.ErrorDetails.KEY_LOAD_ERROR,n))},onTimeout:function(e,a,n){r.resetLoader(a),o(r.createKeyLoadError(t,s.ErrorDetails.KEY_LOAD_TIMEOUT,n))},onAbort:function(e,a,n){r.resetLoader(a),o(r.createKeyLoadError(t,s.ErrorDetails.INTERNAL_ABORTED,n))}};n.load(l,u,c)}))},t.resetLoader=function(e){var t=e.frag,r=e.keyInfo,a=e.url,n=r.loader;t.keyLoader===n&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[a],n&&n.destroy()},e}(),De=function(){function e(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.onHandlerDestroyed=function(){},t.hasInterval=function(){return!!this._tickInterval},t.hasNextTick=function(){return!!this._tickTimer},t.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},t.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},t.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},t.doTick=function(){},e}(),Re={length:0,start:function(){return 0},end:function(){return 0}},Oe=function(){function e(){}return e.isBuffered=function(t,r){try{if(t)for(var a=e.getBuffered(t),n=0;n<a.length;n++)if(r>=a.start(n)&&r<=a.end(n))return!0}catch(e){}return!1},e.bufferInfo=function(t,r,a){try{if(t){var n,i=e.getBuffered(t),o=[];for(n=0;n<i.length;n++)o.push({start:i.start(n),end:i.end(n)});return this.bufferedInfo(o,r,a)}}catch(e){}return{len:0,start:r,end:r,nextStart:void 0}},e.bufferedInfo=function(e,t,r){t=Math.max(0,t),e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var a=[];if(r)for(var n=0;n<e.length;n++){var i=a.length;if(i){var o=a[i-1].end;e[n].start-o<r?e[n].end>o&&(a[i-1].end=e[n].end):a.push(e[n])}else a.push(e[n])}else a=e;for(var s,l=0,u=t,c=t,d=0;d<a.length;d++){var p=a[d].start,h=a[d].end;if(t+r>=p&&t<h)u=p,l=(c=h)-t;else if(t+r<p){s=p;break}}return{len:l,start:u||0,end:c||0,nextStart:s}},e.getBuffered=function(e){try{return e.buffered}catch(e){return l.logger.log("failed to get media.buffered",e),Re}},e}(),Le=function(e,t,r,a,n,i){void 0===a&&(a=0),void 0===n&&(n=-1),void 0===i&&(i=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=r,this.size=a,this.part=n,this.partial=i};function Ne(e,t){for(var r=null,a=0,n=e.length;a<n;a++){var i=e[a];if(i&&i.cc===t){r=i;break}}return r}function Ue(e,t){if(e){var r=e.start+t;e.start=e.startPTS=r,e.endPTS=r+e.duration}}function Fe(e,t){for(var r=t.fragments,a=0,n=r.length;a<n;a++)Ue(r[a],e);t.fragmentHint&&Ue(t.fragmentHint,e),t.alignedSliding=!0}function Be(e,t){if(e.hasProgramDateTime&&t.hasProgramDateTime){var r=e.fragments,a=t.fragments;if(r.length&&a.length){var n=a[Math.round(a.length/2)-1],i=Ne(r,n.cc)||r[Math.round(r.length/2)-1],o=n.programDateTime,s=i.programDateTime;null!==o&&null!==s&&Fe((s-o)/1e3-(i.start-n.start),e)}}}const je=function(e,t){for(var r=0,a=e.length-1,n=null,i=null;r<=a;){var o=t(i=e[n=(r+a)/2|0]);if(o>0)r=n+1;else{if(!(o<0))return i;a=n-1}}return null};function Ve(e,t,r,a){void 0===r&&(r=0),void 0===a&&(a=0);var n=null;if(e?n=t[e.sn-t[0].sn+1]||null:0===r&&0===t[0].start&&(n=t[0]),n&&0===$e(r,a,n))return n;var i=je(t,$e.bind(null,r,a));return!i||i===e&&n?n:i}function $e(e,t,r){if(void 0===e&&(e=0),void 0===t&&(t=0),r.start<=e&&r.start+r.duration>e)return 0;var a=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-a<=e?1:r.start-a>e&&r.start?-1:0}function He(e,t,r){var a=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-a>e}var Ge=r(21);function Ke(e,t){return(Ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var We="STOPPED",ze="IDLE",qe="KEY_LOADING",Ye="FRAG_LOADING",Xe="FRAG_LOADING_WAITING_RETRY",Qe="WAITING_TRACK",Je="PARSING",Ze="PARSED",et="ENDED",tt="ERROR",rt="WAITING_INIT_PTS",at="WAITING_LEVEL",nt=function(e){var t,r;function a(t,r,a,n){var i;return(i=e.call(this)||this).hls=void 0,i.fragPrevious=null,i.fragCurrent=null,i.fragmentTracker=void 0,i.transmuxer=null,i._state=We,i.media=null,i.mediaBuffer=null,i.config=void 0,i.bitrateTest=!1,i.lastCurrentTime=0,i.nextLoadPosition=0,i.startPosition=0,i.loadedmetadata=!1,i.fragLoadError=0,i.retryDate=0,i.levels=null,i.fragmentLoader=void 0,i.keyLoader=void 0,i.levelLastLoaded=null,i.startFragRequested=!1,i.decrypter=void 0,i.initPTS=[],i.onvseeking=null,i.onvended=null,i.logPrefix="",i.log=void 0,i.warn=void 0,i.logPrefix=n,i.log=l.logger.log.bind(l.logger,n+":"),i.warn=l.logger.warn.bind(l.logger,n+":"),i.hls=t,i.fragmentLoader=new we(t.config),i.keyLoader=a,i.fragmentTracker=r,i.config=t.config,i.decrypter=new Ge.default(t.config),t.on(o.Events.LEVEL_SWITCHING,i.onLevelSwitching,function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Ke(t,r);var n,u,c=a.prototype;return c.doTick=function(){this.onTickEnd()},c.onTickEnd=function(){},c.startLoad=function(e){},c.stopLoad=function(){this.fragmentLoader.abort(),this.keyLoader.abort();var e=this.fragCurrent;e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=We},c._streamEnded=function(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;var r=t.partList;if(null!=r&&r.length){var a=r[r.length-1];return Oe.isBuffered(this.media,a.start+a.duration/2)}var n=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(n)},c.getLevelDetails=function(){var e;if(this.levels&&null!==this.levelLastLoaded)return null===(e=this.levels[this.levelLastLoaded])||void 0===e?void 0:e.details},c.onMediaAttached=function(e,t){var r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),r.addEventListener("seeking",this.onvseeking),r.addEventListener("ended",this.onvended);var a=this.config;this.levels&&a.autoStartLoad&&this.state===We&&this.startLoad(a.startPosition)},c.onMediaDetaching=function(){var e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},c.onMediaSeeking=function(){var e=this.config,t=this.fragCurrent,r=this.media,a=this.mediaBuffer,n=this.state,o=r?r.currentTime:0,s=Oe.bufferInfo(a||r,o,e.maxBufferHole);if(this.log("media seeking to "+((0,i.isFiniteNumber)(o)?o.toFixed(3):o)+", state: "+n),this.state===et)this.resetLoadingState();else if(t){var l=e.maxFragLookUpTolerance,u=t.start-l,c=t.start+t.duration+l;if(!s.len||c<s.start||u>s.end){var d=o>c;(o<u||d)&&(d&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests()),this.resetLoadingState())}}r&&(this.lastCurrentTime=o),this.loadedmetadata||s.len||(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()},c.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},c.onLevelSwitching=function(e,t){this.fragLoadError=0},c.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},c.onHandlerDestroyed=function(){this.state=We,this.hls.off(o.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,e.prototype.onHandlerDestroyed.call(this)},c.loadFragment=function(e,t,r){this._loadFragForPlayback(e,t,r)},c._loadFragForPlayback=function(e,t,r){var a=this;this._doFragLoad(e,t,r,(function(t){if(a.fragContextChanged(e))return a.warn("Fragment "+e.sn+(t.part?" p: "+t.part.index:"")+" of level "+e.level+" was dropped during download."),void a.fragmentTracker.removeFragment(e);e.stats.chunkCount++,a._handleFragmentLoadProgress(t)})).then((function(t){if(t){a.fragLoadError=0;var r=a.state;a.fragContextChanged(e)?(r===Ye||!a.fragCurrent&&r===Je)&&(a.fragmentTracker.removeFragment(e),a.state=ze):("payload"in t&&(a.log("Loaded fragment "+e.sn+" of level "+e.level),a.hls.trigger(o.Events.FRAG_LOADED,t)),a._handleFragmentLoadComplete(t))}})).catch((function(t){a.state!==We&&a.state!==tt&&(a.warn(t),a.resetFragmentLoading(e))}))},c.flushMainBuffer=function(e,t,r){if(void 0===r&&(r=null),e-t){var a={startOffset:e,endOffset:t,type:r};this.fragLoadError=0,this.hls.trigger(o.Events.BUFFER_FLUSHING,a)}},c._loadInitSegment=function(e,t){var r=this;this._doFragLoad(e,t).then((function(t){if(!t||r.fragContextChanged(e)||!r.levels)throw new Error("init load aborted");return t})).then((function(t){var a=r.hls,n=t.payload,i=e.decryptdata;if(n&&n.byteLength>0&&i&&i.key&&i.iv&&"AES-128"===i.method){var s=self.performance.now();return r.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).then((function(r){var n=self.performance.now();return a.trigger(o.Events.FRAG_DECRYPTED,{frag:e,payload:r,stats:{tstart:s,tdecrypt:n}}),t.payload=r,t}))}return t})).then((function(t){var a=r.fragCurrent,n=r.hls,i=r.levels;if(!i)throw new Error("init load aborted, missing levels");i[e.level].details;var s=e.stats;r.state=ze,r.fragLoadError=0,e.data=new Uint8Array(t.payload),s.parsing.start=s.buffering.start=self.performance.now(),s.parsing.end=s.buffering.end=self.performance.now(),t.frag===a&&n.trigger(o.Events.FRAG_BUFFERED,{stats:s,frag:a,part:null,id:e.type}),r.tick()})).catch((function(t){r.state!==We&&r.state!==tt&&(r.warn(t),r.resetFragmentLoading(e))}))},c.fragContextChanged=function(e){var t=this.fragCurrent;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId},c.fragBufferedComplete=function(e,t){var r,a,n,i,o=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level+" (frag:["+(null!=(r=e.startPTS)?r:NaN).toFixed(3)+"-"+(null!=(a=e.endPTS)?a:NaN).toFixed(3)+"] > buffer:"+(o?function(e){for(var t="",r=e.length,a=0;a<r;a++)t+="["+e.start(a).toFixed(3)+"-"+e.end(a).toFixed(3)+"]";return t}(Oe.getBuffered(o)):"(detached)")+")"),this.state=ze,o&&(!this.loadedmetadata&&e.type==$.PlaylistLevelType.MAIN&&o.buffered.length&&(null===(n=this.fragCurrent)||void 0===n?void 0:n.sn)===(null===(i=this.fragPrevious)||void 0===i?void 0:i.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},c.seekToStartPos=function(){},c._handleFragmentLoadComplete=function(e){var t=this.transmuxer;if(t){var r=e.frag,a=e.part,n=e.partsLoaded,i=!n||0===n.length||n.some((function(e){return!e})),o=new Le(r.level,r.sn,r.stats.chunkCount+1,0,a?a.index:-1,!i);t.flush(o)}},c._handleFragmentLoadProgress=function(e){},c._doFragLoad=function(e,t,r,a){var n,s=this;if(void 0===r&&(r=null),!this.levels)throw new Error("frag load aborted, missing levels");var l=null;if(!e.encrypted||null!==(n=e.decryptdata)&&void 0!==n&&n.key?!e.encrypted&&t.encryptedFragments.length&&this.keyLoader.loadClear(e,t.encryptedFragments):(this.log("Loading key for "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level),this.state=qe,this.fragCurrent=e,l=this.keyLoader.load(e).then((function(e){if(!s.fragContextChanged(e.frag))return s.hls.trigger(o.Events.KEY_LOADED,e),s.state===qe&&(s.state=ze),e})),this.hls.trigger(o.Events.KEY_LOADING,{frag:e}),this.throwIfFragContextChanged("KEY_LOADING")),r=Math.max(e.start,r||0),this.config.lowLatencyMode&&t){var u=t.partList;if(u&&a){r>e.end&&t.fragmentHint&&(e=t.fragmentHint);var c=this.getNextPart(u,e,r);if(c>-1){var d=u[c];return this.log("Loading part sn: "+e.sn+" p: "+d.index+" cc: "+e.cc+" of playlist ["+t.startSN+"-"+t.endSN+"] parts [0-"+c+"-"+(u.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),this.nextLoadPosition=d.start+d.duration,this.state=Ye,this.hls.trigger(o.Events.FRAG_LOADING,{frag:e,part:u[c],targetBufferTime:r}),this.throwIfFragContextChanged("FRAG_LOADING parts"),l?l.then((function(t){return!t||s.fragContextChanged(t.frag)?null:s.doFragPartsLoad(e,u,c,a)})).catch((function(e){return s.handleFragLoadError(e)})):this.doFragPartsLoad(e,u,c,a).catch((function(e){return s.handleFragLoadError(e)}))}if(!e.url||this.loadedEndOfParts(u,r))return Promise.resolve(null)}}this.log("Loading fragment "+e.sn+" cc: "+e.cc+" "+(t?"of ["+t.startSN+"-"+t.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),(0,i.isFiniteNumber)(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Ye,this.hls.trigger(o.Events.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.throwIfFragContextChanged("FRAG_LOADING");var p=this.config.progressive;return p&&l?l.then((function(t){return!t||s.fragContextChanged(null==t?void 0:t.frag)?null:s.fragmentLoader.load(e,a)})).catch((function(e){return s.handleFragLoadError(e)})):Promise.all([this.fragmentLoader.load(e,p?a:void 0),l]).then((function(e){var t=e[0];return!p&&t&&a&&a(t),t})).catch((function(e){return s.handleFragLoadError(e)}))},c.throwIfFragContextChanged=function(e){if(null===this.fragCurrent)throw new Error("frag load aborted, context changed in "+e)},c.doFragPartsLoad=function(e,t,r,a){var n=this;return new Promise((function(i,s){var l=[];!function r(u){var c=t[u];n.fragmentLoader.loadPart(e,c,a).then((function(a){l[c.index]=a;var s=a.part;n.hls.trigger(o.Events.FRAG_LOADED,a);var d=t[u+1];if(!d||d.fragment!==e)return i({frag:e,part:s,partsLoaded:l});r(u+1)})).catch(s)}(r)}))},c.handleFragLoadError=function(e){if("data"in e){var t=e.data;e.data&&t.details===s.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(o.Events.ERROR,t)}else this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,err:e,fatal:!0});return null},c._handleTransmuxerFlush=function(e){var t=this.getCurrentContext(e);if(t&&this.state===Je){var r=t.frag,a=t.part,n=t.level,i=self.performance.now();r.stats.parsing.end=i,a&&(a.stats.parsing.end=i),this.updateLevelTiming(r,a,n,e.partial)}else this.fragCurrent||this.state===We||this.state===tt||(this.state=ze)},c.getCurrentContext=function(e){var t=this.levels,r=e.level,a=e.sn,n=e.part;if(!t||!t[r])return this.warn("Levels object was unset while buffering fragment "+a+" of level "+r+". The current chunk will not be buffered."),null;var i=t[r],o=n>-1?function(e,t,r){if(!e||!e.details)return null;var a=e.details.partList;if(a)for(var n=a.length;n--;){var i=a[n];if(i.index===r&&i.fragment.sn===t)return i}return null}(i,a,n):null,s=o?o.fragment:function(e,t,r){if(!e||!e.details)return null;var a=e.details,n=a.fragments[t-a.startSN];return n||((n=a.fragmentHint)&&n.sn===t?n:t<a.startSN&&r&&r.sn===t?r:null)}(i,a,this.fragCurrent);return s?{frag:s,part:o,level:i}:null},c.bufferFragmentData=function(e,t,r,a){if(e&&this.state===Je){var n=e.data1,i=e.data2,s=n;if(n&&i&&(s=(0,A.appendUint8Array)(n,i)),s&&s.length){var l={type:e.type,frag:t,part:r,chunkMeta:a,parent:t.type,data:s};this.hls.trigger(o.Events.BUFFER_APPENDING,l),e.dropped&&e.independent&&!r&&this.flushBufferGap(t)}}},c.flushBufferGap=function(e){var t=this.media;if(t)if(Oe.isBuffered(t,t.currentTime)){var r=t.currentTime,a=Oe.bufferInfo(t,r,0),n=e.duration,i=Math.min(2*this.config.maxFragLookUpTolerance,.25*n),o=Math.max(Math.min(e.start-i,a.end-i),r+i);e.start-o>i&&this.flushMainBuffer(o,e.start)}else this.flushMainBuffer(0,e.start)},c.getFwdBufferInfo=function(e,t){var r=this.config,a=this.getLoadPosition();if(!(0,i.isFiniteNumber)(a))return null;var n=Oe.bufferInfo(e,a,r.maxBufferHole);if(0===n.len&&void 0!==n.nextStart){var o=this.fragmentTracker.getBufferedFrag(a,t);if(o&&n.nextStart<o.end)return Oe.bufferInfo(e,a,Math.max(n.nextStart,r.maxBufferHole))}return n},c.getMaxBufferLength=function(e){var t,r=this.config;return t=e?Math.max(8*r.maxBufferSize/e,r.maxBufferLength):r.maxBufferLength,Math.min(t,r.maxMaxBufferLength)},c.reduceMaxBufferLength=function(e){var t=this.config,r=e||t.maxBufferLength;return t.maxMaxBufferLength>=r&&(t.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},c.getNextFragment=function(e,t){var r=t.fragments,a=r.length;if(!a)return null;var n,i=this.config,o=r[0].start;if(t.live){var s=i.initialLiveManifestSize;if(a<s)return this.warn("Not enough fragments to start playback (have: "+a+", need: "+s+")"),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(n=this.getInitialLiveFragment(t,r),this.startPosition=n?this.hls.liveSyncPosition||n.start:e)}else e<=o&&(n=r[0]);if(!n){var l=i.lowLatencyMode?t.partEnd:t.fragmentEnd;n=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(n)},c.mapToInitFragWhenRequired=function(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment},c.getNextPart=function(e,t,r){for(var a=-1,n=!1,i=!0,o=0,s=e.length;o<s;o++){var l=e[o];if(i=i&&!l.independent,a>-1&&r<l.start)break;var u=l.loaded;u?a=-1:(n||l.independent||i)&&l.fragment===t&&(a=o),n=u}return a},c.loadedEndOfParts=function(e,t){var r=e[e.length-1];return r&&t>r.start&&r.loaded},c.getInitialLiveFragment=function(e,t){var r=this.fragPrevious,a=null;if(r){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),a=function(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!(0,i.isFiniteNumber)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;r=r||0;for(var a=0;a<e.length;++a){var n=e[a];if(He(t,r,n))return n}return null}(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!a){var n=r.sn+1;if(n>=e.startSN&&n<=e.endSN){var o=t[n-e.startSN];r.cc===o.cc&&(a=o,this.log("Live playlist, switching playlist, load frag with next SN: "+a.sn))}a||(a=function(e,t){return je(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(t,r.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+a.sn)}}else{var s=this.hls.liveSyncPosition;null!==s&&(a=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return a},c.getFragmentAtPosition=function(e,t,r){var a,n=this.config,i=this.fragPrevious,o=r.fragments,s=r.endSN,l=r.fragmentHint,u=n.maxFragLookUpTolerance,c=!!(n.lowLatencyMode&&r.partList&&l);if(c&&l&&!this.bitrateTest&&(o=o.concat(l),s=l.sn),a=e<t?Ve(i,o,e,e>t-u?0:u):o[o.length-1]){var d=a.sn-r.startSN;if(this.fragmentTracker.getState(a)===ye.OK&&(i=a),i&&a.sn===i.sn&&!c&&i&&a.level===i.level){var p=o[d+1];a.sn<s&&this.fragmentTracker.getState(p)!==ye.OK?(this.log("SN "+a.sn+" just loaded, load next one: "+p.sn),a=p):a=null}}return a},c.synchronizeToLiveEdge=function(e){var t=this.config,r=this.media;if(r){var a=this.hls.liveSyncPosition,n=r.currentTime,i=e.fragments[0].start,o=e.edge,s=n>=i-t.maxFragLookUpTolerance&&n<=o;if(null!==a&&r.duration>a&&(n<a||!s)){var l=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&r.readyState<4||n<o-l)&&(this.loadedmetadata||(this.nextLoadPosition=a),r.readyState&&(this.warn("Playback: "+n.toFixed(3)+" is located too far from the end of live sliding playlist: "+o+", reset currentTime to : "+a.toFixed(3)),r.currentTime=a))}}},c.alignPlaylists=function(e,t){var r=this.levels,a=this.levelLastLoaded,n=this.fragPrevious,o=null!==a?r[a]:null,s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;var u=e.fragments[0].start,c=!t,d=e.alignedSliding&&(0,i.isFiniteNumber)(u);if(c||!d&&!u){!function(e,t,r){t&&(function(e,t,r){if(function(e,t,r){return!(!t.details||!(r.endCC>r.startCC||e&&e.cc<r.startCC))}(e,r,t)){var a=function(e,t,r){void 0===r&&(r=0);var a=e.fragments,n=t.fragments;if(n.length&&a.length){var i=Ne(a,n[0].cc);if(i&&(!i||i.startPTS))return i;l.logger.log("No frag in previous level to align on")}else l.logger.log("No fragments to align")}(r.details,t);a&&(0,i.isFiniteNumber)(a.start)&&(l.logger.log("Adjusting PTS using last level due to CC increase within current level "+t.url),Fe(a.start,t))}}(e,r,t),!r.alignedSliding&&t.details&&function(e,t){if(t.fragments.length&&e.hasProgramDateTime&&t.hasProgramDateTime){var r=t.fragments[0].programDateTime,a=e.fragments[0].programDateTime,n=(a-r)/1e3+t.fragments[0].start;n&&(0,i.isFiniteNumber)(n)&&(l.logger.log("Adjusting PTS using programDateTime delta "+(a-r)+"ms, sliding:"+n.toFixed(3)+" "+e.url+" "),Fe(n,e))}}(r,t.details),r.alignedSliding||!t.details||r.skippedSegments||de(t.details,r))}(n,o,e);var p=e.fragments[0].start;return this.log("Live playlist sliding: "+p.toFixed(2)+" start-sn: "+(t?t.startSN:"na")+"->"+e.startSN+" prev-sn: "+(n?n.sn:"na")+" fragments: "+s),p}return u},c.waitForCdnTuneIn=function(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)},c.setStartPosition=function(e,t){var r=this.startPosition;if(r<t&&(r=-1),-1===r||-1===this.lastCurrentTime){var a=e.startTimeOffset;(0,i.isFiniteNumber)(a)?(r=t+a,a<0&&(r+=e.totalduration),r=Math.min(Math.max(t,r),t+e.totalduration),this.log("Start time offset "+a+" found in playlist, adjust startPosition to "+r),this.startPosition=r):e.live?r=this.hls.liveSyncPosition||t:this.startPosition=r=0,this.lastCurrentTime=r}this.nextLoadPosition=r},c.getLoadPosition=function(){var e=this.media,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t},c.handleFragLoadAborted=function(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn("Fragment "+e.sn+(t?" part"+t.index:"")+" of level "+e.level+" was aborted"),this.resetFragmentLoading(e))},c.resetFragmentLoading=function(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Xe)||(this.state=ze)},c.onFragmentOrKeyLoadError=function(e,t){if(t.fatal)return this.stopLoad(),void(this.state=tt);var r=this.config;if(t.chunkMeta){var a=this.getCurrentContext(t.chunkMeta);a&&(t.frag=a.frag,t.levelRetry=!0,this.fragLoadError=r.fragLoadingMaxRetry)}var n=t.frag;if(n&&n.type===e)if(this.fragCurrent,this.fragLoadError+1<=r.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var i=Math.min(Math.pow(2,this.fragLoadError)*r.fragLoadingRetryDelay,r.fragLoadingMaxRetryTimeout);this.warn("Fragment "+n.sn+" of "+e+" "+n.level+" failed to load, retrying in "+i+"ms"),this.retryDate=self.performance.now()+i,this.fragLoadError++,this.state=Xe}else t.levelRetry?(e===$.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=ze):(l.logger.error(t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.hls.stopLoad(),this.state=tt)},c.afterBufferFlushed=function(e,t,r){if(e){var a=Oe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,a,r),this.state===et&&this.resetLoadingState()}},c.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=ze},c.resetStartWhenNotLoaded=function(e){if(!this.loadedmetadata){this.startFragRequested=!1;var t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},c.updateLevelTiming=function(e,t,r,a){var n=this,i=r.details;Object.keys(e.elementaryStreams).reduce((function(t,s){var l=e.elementaryStreams[s];if(l){var u=l.endPTS-l.startPTS;if(u<=0)return n.warn("Could not parse fragment "+e.sn+" "+s+" duration reliably ("+u+")"),t||!1;var c=a?0:ce(i,e,l.startPTS,l.endPTS,l.startDTS,l.endDTS);return n.hls.trigger(o.Events.LEVEL_PTS_UPDATED,{details:i,level:r,drift:c,type:s,frag:e,start:l.startPTS,end:l.endPTS}),!0}return t}),!1)||(this.warn("Found no media in fragment "+e.sn+" of level "+r.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=Ze,this.hls.trigger(o.Events.FRAG_PARSED,{frag:e,part:t})},c.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},n=a,(u=[{key:"state",get:function(){return this._state},set:function(e){var t=this._state;t!==e&&(this._state=e,this.log(t+"->"+e))}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(n.prototype,u),Object.defineProperty(n,"prototype",{writable:!1}),a}(De);function it(){return self.MediaSource||self.WebKitMediaSource}function ot(){return self.SourceBuffer||self.WebKitSourceBuffer}var st=function(){var e=ENTRY_MODULE,t={},r=function r(a){var n=t[a];if(void 0!==n)return n.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,r),i.exports};r.m=e,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a=r(ENTRY_MODULE);return a.default||a}.toString().split("ENTRY_MODULE"),lt="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function ut(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function ct(e,t,a){var n={};n[a]=[];var i=t.toString().replace(/^"[^"]+"/,"function"),o=i.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||i.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!o)return n;for(var s,l=o[1],u=new RegExp("(\\\\n|\\W)"+ut(l)+lt,"g");s=u.exec(i);)"dll-reference"!==s[3]&&n[a].push(s[3]);for(u=new RegExp("\\("+ut(l)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+lt,"g");s=u.exec(i);)e[s[2]]||(n[a].push(s[1]),e[s[2]]=r(s[1]).m),n[s[2]]=n[s[2]]||[],n[s[2]].push(s[4]);for(var c,d=Object.keys(n),p=0;p<d.length;p++)for(var h=0;h<n[d[p]].length;h++)c=n[d[p]][h],isNaN(1*c)||(n[d[p]][h]=1*n[d[p]][h]);return n}function dt(e){return Object.keys(e).reduce((function(t,r){return t||e[r].length>0}),!1)}function pt(e,t,r,a){var n=e[a].map((function(e){return'"'+e+'": '+t[a][e].toString().replace(/^"[^"]+"/,"function")})).join(",");return st[0]+"{"+n+"}"+st[1]+'"'+r+'"'+st[2]}var ht=r(544),ft=r(729),gt=r.n(ft),yt=it()||{isTypeSupported:function(){return!1}},mt=function(){function e(e,t,a,n){var i=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var u=e.config;this.hls=e,this.id=t,this.useWorker=!!u.enableWorker,this.onTransmuxComplete=a,this.onFlush=n;var c=function(e,t){(t=t||{}).frag=i.frag,t.id=i.id,i.hls.trigger(e,t)};this.observer=new ft.EventEmitter,this.observer.on(o.Events.FRAG_DECRYPTED,c),this.observer.on(o.Events.ERROR,c);var d={mp4:yt.isTypeSupported("video/mp4"),mpeg:yt.isTypeSupported("audio/mpeg"),mp3:yt.isTypeSupported('audio/mp4; codecs="mp3"')},p=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker){var h;l.logger.log("demuxing in webworker");try{h=this.worker=function(e,t){t=t||{};var a={main:r.m},n=t.all?{main:Object.keys(a.main)}:function(e,t){for(var r={main:[182]},a={main:[]},n={main:{}};dt(r);)for(var i=Object.keys(r),o=0;o<i.length;o++){var s=i[o],l=r[s].pop();if(n[s]=n[s]||{},!n[s][l]&&e[s][l]){n[s][l]=!0,a[s]=a[s]||[],a[s].push(l);for(var u=ct(e,e[s][l],s),c=Object.keys(u),d=0;d<c.length;d++)r[c[d]]=r[c[d]]||[],r[c[d]]=r[c[d]].concat(u[c[d]])}}return a}(a),i="";Object.keys(n).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;n[e][t];)t++;n[e].push(t),a[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",i=i+"var "+e+" = ("+pt(n,a,t,modules)+")();\n"})),i=i+"new (("+pt(n,a,182,"main")+")())(self);";var o=new window.Blob([i],{type:"text/javascript"}),s=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(o),l=new window.Worker(s);return l.objectURL=s,l}(),this.onwmsg=this.onWorkerMessage.bind(this),h.addEventListener("message",this.onwmsg),h.onerror=function(e){i.useWorker=!1,l.logger.warn("Exception in webworker, fallback to inline"),i.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(e.message+"  ("+e.filename+":"+e.lineno+")")})},h.postMessage({cmd:"init",typeSupported:d,vendor:p,id:t,config:JSON.stringify(u)})}catch(e){l.logger.warn("Error in worker:",e),l.logger.error("Error while initializing DemuxerWorker, fallback to inline"),h&&self.URL.revokeObjectURL(h.objectURL),this.transmuxer=new ht.default(this.observer,d,u,p,t),this.worker=null}}else this.transmuxer=new ht.default(this.observer,d,u,p,t)}var t=e.prototype;return t.destroy=function(){var e=this.worker;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.worker=null,this.onwmsg=void 0;else{var t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}var r=this.observer;r&&r.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},t.push=function(e,t,r,a,n,i,o,s,u,c){var d,p,h=this;u.transmuxing.start=self.performance.now();var f=this.transmuxer,g=this.worker,y=i?i.start:n.start,m=n.decryptdata,v=this.frag,_=!(v&&n.cc===v.cc),k=!(v&&u.level===v.level),E=v?u.sn-v.sn:-1,T=this.part?u.part-this.part.index:-1,b=0===E&&u.id>1&&u.id===(null==v?void 0:v.stats.chunkCount),S=!k&&(1===E||0===E&&(1===T||b&&T<=0)),A=self.performance.now();(k||E||0===n.stats.parsing.start)&&(n.stats.parsing.start=A),!i||!T&&S||(i.stats.parsing.start=A);var C=!(v&&(null===(d=n.initSegment)||void 0===d?void 0:d.url)===(null===(p=v.initSegment)||void 0===p?void 0:p.url)),P=new ht.TransmuxState(_,S,s,k,y,C);if(!S||_||C){l.logger.log("[transmuxer-interface, "+n.type+"]: Starting new transmux session for sn: "+u.sn+" p: "+u.part+" level: "+u.level+" id: "+u.id+"\n        discontinuity: "+_+"\n        trackSwitch: "+k+"\n        contiguous: "+S+"\n        accurateTimeOffset: "+s+"\n        timeOffset: "+y+"\n        initSegmentChange: "+C);var w=new ht.TransmuxConfig(r,a,t,o,c);this.configureTransmuxer(w)}if(this.frag=n,this.part=i,g)g.postMessage({cmd:"demux",data:e,decryptdata:m,chunkMeta:u,state:P},e instanceof ArrayBuffer?[e]:[]);else if(f){var x=f.push(e,m,u,P);(0,ht.isPromise)(x)?(f.async=!0,x.then((function(e){h.handleTransmuxComplete(e)})).catch((function(e){h.transmuxerError(e,u,"transmuxer-interface push error")}))):(f.async=!1,this.handleTransmuxComplete(x))}},t.flush=function(e){var t=this;e.transmuxing.start=self.performance.now();var r=this.transmuxer,a=this.worker;if(a)a.postMessage({cmd:"flush",chunkMeta:e});else if(r){var n=r.flush(e);(0,ht.isPromise)(n)||r.async?((0,ht.isPromise)(n)||(n=Promise.resolve(n)),n.then((function(r){t.handleFlushResult(r,e)})).catch((function(r){t.transmuxerError(r,e,"transmuxer-interface flush error")}))):this.handleFlushResult(n,e)}},t.transmuxerError=function(e,t,r){this.hls&&this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:r})},t.handleFlushResult=function(e,t){var r=this;e.forEach((function(e){r.handleTransmuxComplete(e)})),this.onFlush(t)},t.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":l.logger[t.data.logType]&&l.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},t.configureTransmuxer=function(e){var t=this.worker,r=this.transmuxer;t?t.postMessage({cmd:"configure",config:e}):r&&r.configure(e)},t.handleTransmuxComplete=function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)},e}(),vt=function(){function e(e,t,r,a){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=r,this.hls=a}var t=e.prototype;return t.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},t.poll=function(e,t){var r=this.config,a=this.media,n=this.stalled;if(null!==a){var i=a.currentTime,o=a.seeking,s=this.seeking&&!o,u=!this.seeking&&o;if(this.seeking=o,i===e){if((u||s)&&(this.stalled=null),!(a.paused&&!o||a.ended||0===a.playbackRate)&&Oe.getBuffered(a).length){var c=Oe.bufferInfo(a,i,0),d=c.len>0,p=c.nextStart||0;if(d||p){if(o){var h=c.len>2,f=!p||t&&t.start<=i||p-i>2&&!this.fragmentTracker.getPartialFragment(i);if(h||f)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var g,y=Math.max(p,c.start||0)-i,m=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,v=(null==m||null===(g=m.details)||void 0===g?void 0:g.live)?2*m.details.targetduration:2;if(y>0&&y<=v)return void this._trySkipBufferHole(null)}var _=self.performance.now();if(null!==n){var k=_-n;if(o||!(k>=250)||(this._reportStall(c),this.media)){var E=Oe.bufferInfo(a,i,r.maxBufferHole);this._tryFixBufferStall(E,k)}}else this.stalled=_}}}else if(this.moved=!0,null!==n){if(this.stallReported){var T=self.performance.now()-n;l.logger.warn("playback not stuck anymore @"+i+", after "+Math.round(T)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}}},t._tryFixBufferStall=function(e,t){var r=this.config,a=this.fragmentTracker,n=this.media;if(null!==n){var i=n.currentTime,o=a.getPartialFragment(i);if(o&&(this._trySkipBufferHole(o)||!this.media))return;e.len>r.maxBufferHole&&t>1e3*r.highBufferWatchdogPeriod&&(l.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},t._reportStall=function(e){var t=this.hls,r=this.media;!this.stallReported&&r&&(this.stallReported=!0,l.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer ("+JSON.stringify(e)+")"),t.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e.len}))},t._trySkipBufferHole=function(e){var t=this.config,r=this.hls,a=this.media;if(null===a)return 0;for(var n=a.currentTime,i=0,u=Oe.getBuffered(a),c=0;c<u.length;c++){var d=u.start(c);if(n+t.maxBufferHole>=i&&n<d){var p=Math.max(d+.05,a.currentTime+.1);return l.logger.warn("skipping hole, adjusting currentTime from "+n+" to "+p),this.moved=!0,this.stalled=null,a.currentTime=p,e&&r.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+p,frag:e}),p}i=u.end(c)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,a=this.nudgeRetry;if(null!==r){var n=r.currentTime;if(this.nudgeRetry++,a<e.nudgeMaxRetry){var i=n+(a+1)*e.nudgeOffset;l.logger.warn("Nudging 'currentTime' from "+n+" to "+i),r.currentTime=i,t.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else l.logger.error("Playhead still not moving while enough data buffered @"+n+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},e}();function _t(e,t){return(_t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var kt=function(e){var t,r;function a(t,r,a){var n;return(n=e.call(this,t,r,a,"[stream-controller]")||this).audioCodecSwap=!1,n.gapController=null,n.level=-1,n._forceStartLoad=!1,n.altAudio=!1,n.audioOnly=!1,n.fragPlaying=null,n.onvplaying=null,n.onvseeked=null,n.fragLastKbps=0,n.couldBacktrack=!1,n.backtrackFragment=null,n.audioCodecSwitch=!1,n.videoBuffer=null,n._registerListeners(),n}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,_t(t,r);var n,l,u=a.prototype;return u._registerListeners=function(){var e=this.hls;e.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(o.Events.ERROR,this.onError,this),e.on(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(o.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(o.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},u._unregisterListeners=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(o.Events.ERROR,this.onError,this),e.off(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(o.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(o.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},u.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},u.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var a=r.startLevel;-1===a&&(r.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=r.nextAutoLevel),this.level=r.nextLoadLevel=a,this.loadedmetadata=!1}t>0&&-1===e&&(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=ze,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=We},u.stopLoad=function(){this._forceStartLoad=!1,e.prototype.stopLoad.call(this)},u.doTick=function(){switch(this.state){case ze:this.doTickIdle();break;case at:var e,t=this.levels,r=this.level,a=null==t||null===(e=t[r])||void 0===e?void 0:e.details;if(a&&(!a.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(a))break;this.state=ze;break}break;case Xe:var n,i=self.performance.now(),o=this.retryDate;(!o||i>=o||null!==(n=this.media)&&void 0!==n&&n.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=ze)}this.onTickEnd()},u.onTickEnd=function(){e.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},u.doTickIdle=function(){var e=this.hls,t=this.levelLastLoaded,r=this.levels,a=this.media,n=e.config,i=e.nextLoadLevel;if(null!==t&&(a||!this.startFragRequested&&n.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&r&&r[i]){var s=r[i],l=this.getMainFwdBufferInfo();if(null!==l){var u=this.getLevelDetails();if(u&&this._streamEnded(l,u)){var c={};return this.altAudio&&(c.type="video"),this.hls.trigger(o.Events.BUFFER_EOS,c),void(this.state=et)}this.level=e.nextLoadLevel=i;var d=s.details;if(!d||this.state===at||d.live&&this.levelLastLoaded!==i)return this.level=i,void(this.state=at);if(!(l.len>=this.getMaxBufferLength(s.maxBitrate))){this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);var p=this.backtrackFragment?this.backtrackFragment.start:l.end,h=this.getNextFragment(p,d);if(this.couldBacktrack&&!this.fragPrevious&&h&&"initSegment"!==h.sn&&this.fragmentTracker.getState(h)!==ye.OK){var f,g=(null!=(f=this.backtrackFragment)?f:h).sn-d.startSN,y=d.fragments[g-1];y&&h.cc===y.cc&&(h=y,this.fragmentTracker.removeFragment(y))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(h&&this.fragmentTracker.getState(h)===ye.OK&&this.nextLoadPosition>p){var v=this.audioOnly&&!this.altAudio?m.ElementaryStreamTypes.AUDIO:m.ElementaryStreamTypes.VIDEO,_=(v===m.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;_&&this.afterBufferFlushed(_,v,$.PlaylistLevelType.MAIN),h=this.getNextFragment(this.nextLoadPosition,d)}h&&(!h.initSegment||h.initSegment.data||this.bitrateTest||(h=h.initSegment),this.loadFragment(h,d,p))}}}},u.loadFragment=function(t,r,a){var n,i=this.fragmentTracker.getState(t);this.fragCurrent=t,i===ye.NOT_LOADED?"initSegment"===t.sn?this._loadInitSegment(t,r):this.bitrateTest?(this.log("Fragment "+t.sn+" of level "+t.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(t,r)):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,r,a)):i===ye.APPENDING?this.reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t):0===(null===(n=this.media)||void 0===n?void 0:n.buffered.length)&&this.fragmentTracker.removeAllFragments()},u.getAppendedFrag=function(e){var t=this.fragmentTracker.getAppendedFrag(e,$.PlaylistLevelType.MAIN);return t&&"fragment"in t?t.fragment:t},u.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,$.PlaylistLevelType.MAIN)},u.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.end+.5):null},u.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},u.nextLevelSwitch=function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var r,a=this.getAppendedFrag(t.currentTime);if(a&&a.start>1&&this.flushMainBuffer(0,a.start-1),!t.paused&&e){var n=e[this.hls.nextLoadLevel],i=this.fragLastKbps;r=i&&this.fragCurrent?this.fragCurrent.duration*n.maxBitrate/(1e3*i)+1:0}else r=0;var o=this.getBufferedFrag(t.currentTime+r);if(o){var s=this.followingBufferedFrag(o);if(s){this.abortCurrentFrag();var l=s.maxStartPTS?s.maxStartPTS:s.start,u=s.duration,c=Math.max(o.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,.5*u),.75*u));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}},u.abortCurrentFrag=function(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&e.abortRequests(),this.state){case qe:case Ye:case Xe:case Je:case Ze:this.state=ze}this.nextLoadPosition=this.getLoadPosition()},u.flushMainBuffer=function(t,r){e.prototype.flushMainBuffer.call(this,t,r,this.altAudio?"video":null)},u.onMediaAttached=function(t,r){e.prototype.onMediaAttached.call(this,t,r);var a=r.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),a.addEventListener("playing",this.onvplaying),a.addEventListener("seeked",this.onvseeked),this.gapController=new vt(this.config,a,this.fragmentTracker,this.hls)},u.onMediaDetaching=function(){var t=this.media;t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),e.prototype.onMediaDetaching.call(this)},u.onMediaPlaying=function(){this.tick()},u.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:null;(0,i.isFiniteNumber)(t)&&this.log("Media seeked to "+t.toFixed(3)),this.tick()},u.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(o.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},u.onManifestParsed=function(e,t){var r,a,n,i=!1,o=!1;t.levels.forEach((function(e){(r=e.audioCodec)&&(-1!==r.indexOf("mp4a.40.2")&&(i=!0),-1!==r.indexOf("mp4a.40.5")&&(o=!0))})),this.audioCodecSwitch=i&&o&&!("function"==typeof(null==(n=ot())||null===(a=n.prototype)||void 0===a?void 0:a.changeType)),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1},u.onLevelLoading=function(e,t){var r=this.levels;if(r&&this.state===ze){var a=r[t.level];(!a.details||a.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(a.details))&&(this.state=at)}},u.onLevelLoaded=function(e,t){var r,a=this.levels,n=t.level,i=t.details,s=i.totalduration;if(a){this.log("Level "+n+" loaded ["+i.startSN+","+i.endSN+"], cc ["+i.startCC+", "+i.endCC+"] duration:"+s);var l=this.fragCurrent;!l||this.state!==Ye&&this.state!==Xe||l.level!==t.level&&l.loader&&(this.state=ze,this.backtrackFragment=null,l.abortRequests());var u=a[n],c=0;if(i.live||null!==(r=u.details)&&void 0!==r&&r.live){if(i.fragments[0]||(i.deltaUpdateFailed=!0),i.deltaUpdateFailed)return;c=this.alignPlaylists(i,u.details)}if(u.details=i,this.levelLastLoaded=n,this.hls.trigger(o.Events.LEVEL_UPDATED,{details:i,level:n}),this.state===at){if(this.waitForCdnTuneIn(i))return;this.state=ze}this.startFragRequested?i.live&&this.synchronizeToLiveEdge(i):this.setStartPosition(i,c),this.tick()}else this.warn("Levels were reset while loading level "+n)},u._handleFragmentLoadProgress=function(e){var t,r=e.frag,a=e.part,n=e.payload,i=this.levels;if(i){var o=i[r.level],s=o.details;if(s){var l=o.videoCodec,u=s.PTSKnown||!s.live,c=null===(t=r.initSegment)||void 0===t?void 0:t.data,d=this._getAudioCodec(o),p=this.transmuxer=this.transmuxer||new mt(this.hls,$.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=a?a.index:-1,f=-1!==h,g=new Le(r.level,r.sn,r.stats.chunkCount,n.byteLength,h,f),y=this.initPTS[r.cc];p.push(n,c,d,l,r,a,s.totalduration,u,g,y)}else this.warn("Dropping fragment "+r.sn+" of level "+r.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},u.onAudioTrackSwitching=function(e,t){var r=this.altAudio,a=!!t.url,n=t.id;if(!a){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i&&(this.log("Switching to main audio track, cancel main fragment load"),i.abortRequests()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var s=this.hls;r&&s.trigger(o.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),s.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:n})}},u.onAudioTrackSwitched=function(e,t){var r=t.id,a=!!this.hls.audioTracks[r].url;if(a){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=a,this.tick()},u.onBufferCreated=function(e,t){var r,a,n=t.tracks,i=!1;for(var o in n){var s=n[o];if("main"===s.id){if(a=o,r=s,"video"===o){var l=n[o];l&&(this.videoBuffer=l.buffer)}}else i=!0}i&&r?(this.log("Alternate track found, use "+a+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},u.onFragBuffered=function(e,t){var r=t.frag,a=t.part;if(!r||r.type===$.PlaylistLevelType.MAIN){if(this.fragContextChanged(r))return this.warn("Fragment "+r.sn+(a?" p: "+a.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===Ze&&(this.state=ze));var n=a?a.stats:r.stats;this.fragLastKbps=Math.round(8*n.total/(n.buffering.end-n.loading.first)),"initSegment"!==r.sn&&(this.fragPrevious=r),this.fragBufferedComplete(r,a)}},u.onError=function(e,t){if(t.type!==s.ErrorTypes.KEY_SYSTEM_ERROR)switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.FRAG_PARSING_ERROR:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError($.PlaylistLevelType.MAIN,t);break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==tt&&(t.fatal?(this.warn(""+t.details),this.state=tt):t.levelRetry||this.state!==at||(this.state=ze));break;case s.ErrorDetails.BUFFER_FULL_ERROR:if("main"===t.parent&&(this.state===Je||this.state===Ze)){var r=!0,a=this.getFwdBufferInfo(this.media,$.PlaylistLevelType.MAIN);a&&a.len>.5&&(r=!this.reduceMaxBufferLength(a.len)),r&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError($.PlaylistLevelType.MAIN,t)},u.checkBuffer=function(){var e=this.media,t=this.gapController;if(e&&t&&e.readyState){if(this.loadedmetadata||!Oe.getBuffered(e).length){var r=this.state!==ze?this.fragCurrent:null;t.poll(this.lastCurrentTime,r)}this.lastCurrentTime=e.currentTime}},u.onFragLoadEmergencyAborted=function(){this.state=ze,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},u.onBufferFlushed=function(e,t){var r=t.type;if(r!==m.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var a=(r===m.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(a,r,$.PlaylistLevelType.MAIN)}},u.onLevelsUpdated=function(e,t){this.levels=t.levels},u.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},u.seekToStartPos=function(){var e=this.media;if(e){var t=e.currentTime,r=this.startPosition;if(r>=0&&t<r){if(e.seeking)return void this.log("could not seek to "+r+", already seeking at "+t);var a=Oe.getBuffered(e),n=(a.length?a.start(0):0)-r;n>0&&(n<this.config.maxBufferHole||n<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+n+" to match buffer start"),r+=n,this.startPosition=r),this.log("seek to target start position "+r+" from current time "+t),e.currentTime=r}}},u._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t},u._loadBitrateTestFrag=function(e,t){var r=this;e.bitrateTest=!0,this._doFragLoad(e,t).then((function(t){var a=r.hls;if(t&&!r.fragContextChanged(e)){r.fragLoadError=0,r.state=ze,r.startFragRequested=!1,r.bitrateTest=!1;var n=e.stats;n.parsing.start=n.parsing.end=n.buffering.start=n.buffering.end=self.performance.now(),a.trigger(o.Events.FRAG_LOADED,t),e.bitrateTest=!1}}))},u._handleTransmuxComplete=function(e){var t,r="main",a=this.hls,n=e.remuxResult,s=e.chunkMeta,l=this.getCurrentContext(s);if(!l)return this.warn("The loading context changed while buffering fragment "+s.sn+" of level "+s.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(s.level);var u=l.frag,c=l.part,d=l.level,p=n.video,h=n.text,f=n.id3,g=n.initSegment,y=d.details,v=this.altAudio?void 0:n.audio;if(!this.fragContextChanged(u)){if(this.state=Je,g){g.tracks&&(this._bufferInitSegment(d,g.tracks,u,s),a.trigger(o.Events.FRAG_PARSING_INIT_SEGMENT,{frag:u,id:r,tracks:g.tracks}));var _=g.initPTS,k=g.timescale;(0,i.isFiniteNumber)(_)&&(this.initPTS[u.cc]=_,a.trigger(o.Events.INIT_PTS_FOUND,{frag:u,id:r,initPTS:_,timescale:k}))}if(p&&!1!==n.independent){if(y){var E=p.startPTS,T=p.endPTS,b=p.startDTS,S=p.endDTS;if(c)c.elementaryStreams[p.type]={startPTS:E,endPTS:T,startDTS:b,endDTS:S};else if(p.firstKeyFrame&&p.independent&&1===s.id&&(this.couldBacktrack=!0),p.dropped&&p.independent){var A=this.getMainFwdBufferInfo();if((A?A.end:this.getLoadPosition())+this.config.maxBufferHole<(p.firstKeyFramePTS?p.firstKeyFramePTS:E)-this.config.maxBufferHole)return void this.backtrack(u);u.setElementaryStreamInfo(p.type,u.start,T,u.start,S,!0)}u.setElementaryStreamInfo(p.type,E,T,b,S),this.backtrackFragment&&(this.backtrackFragment=u),this.bufferFragmentData(p,u,c,s)}}else if(!1===n.independent)return void this.backtrack(u);if(v){var C=v.startPTS,P=v.endPTS,w=v.startDTS,x=v.endDTS;c&&(c.elementaryStreams[m.ElementaryStreamTypes.AUDIO]={startPTS:C,endPTS:P,startDTS:w,endDTS:x}),u.setElementaryStreamInfo(m.ElementaryStreamTypes.AUDIO,C,P,w,x),this.bufferFragmentData(v,u,c,s)}if(y&&null!=f&&null!==(t=f.samples)&&void 0!==t&&t.length){var I={id:r,frag:u,details:y,samples:f.samples};a.trigger(o.Events.FRAG_PARSING_METADATA,I)}if(y&&h){var M={id:r,frag:u,details:y,samples:h.samples};a.trigger(o.Events.FRAG_PARSING_USERDATA,M)}}},u._bufferInitSegment=function(e,t,r,a){var n=this;if(this.state===Je){this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;var i=t.audio,s=t.video,l=t.audiovideo;if(i){var u=e.audioCodec,c=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==i.metadata.channelCount&&-1===c.indexOf("firefox")&&(u="mp4a.40.5")),-1!==c.indexOf("android")&&"audio/mpeg"!==i.container&&(u="mp4a.40.2",this.log("Android: force audio codec to "+u)),e.audioCodec&&e.audioCodec!==u&&this.log('Swapping manifest audio codec "'+e.audioCodec+'" for "'+u+'"'),i.levelCodec=u,i.id="main",this.log("Init audio buffer, container:"+i.container+", codecs[selected/level/parsed]=["+(u||"")+"/"+(e.audioCodec||"")+"/"+i.codec+"]")}s&&(s.levelCodec=e.videoCodec,s.id="main",this.log("Init video buffer, container:"+s.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+s.codec+"]")),l&&this.log("Init audiovideo buffer, container:"+l.container+", codecs[level/parsed]=["+(e.attrs.CODECS||"")+"/"+l.codec+"]"),this.hls.trigger(o.Events.BUFFER_CODECS,t),Object.keys(t).forEach((function(e){var i=t[e].initSegment;null!=i&&i.byteLength&&n.hls.trigger(o.Events.BUFFER_APPENDING,{type:e,data:i,frag:r,part:null,chunkMeta:a,parent:r.type})})),this.tick()}},u.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,$.PlaylistLevelType.MAIN)},u.backtrack=function(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ze},u.checkFragmentChanged=function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var r=e.currentTime;if(Oe.isBuffered(e,r)?t=this.getAppendedFrag(r):Oe.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;var a=this.fragPlaying,n=t.level;a&&t.sn===a.sn&&a.level===n&&t.urlId===a.urlId||(this.fragPlaying=t,this.hls.trigger(o.Events.FRAG_CHANGED,{frag:t}),a&&a.level===n||this.hls.trigger(o.Events.LEVEL_SWITCHED,{level:n}))}}},n=a,(l=[{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function(){var e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}},{key:"currentProgramDateTime",get:function(){var e=this.media;if(e){var t=e.currentTime,r=this.currentFrag;if(r&&(0,i.isFiniteNumber)(t)&&(0,i.isFiniteNumber)(r.programDateTime)){var a=r.programDateTime+1e3*(t-r.start);return new Date(a)}}return null}},{key:"currentLevel",get:function(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(n.prototype,l),Object.defineProperty(n,"prototype",{writable:!1}),a}(nt);const Et=function(){function e(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_},e}(),Tt=function(){function e(e,t,r){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Et(e),this.fast_=new Et(t)}var t=e.prototype;return t.update=function(e,t){var r=this.slow_,a=this.fast_;this.slow_.halfLife!==e&&(this.slow_=new Et(e,r.getEstimate(),r.getTotalWeight())),this.fast_.halfLife!==t&&(this.fast_=new Et(t,a.getEstimate(),a.getTotalWeight()))},t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,a=8*t/r;this.fast_.sample(r,a),this.slow_.sample(r,a)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}(),bt=function(){function e(e){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;var t=e.config;this.bwEstimator=new Tt(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}var t,r,a=e.prototype;return a.registerListeners=function(){var e=this.hls;e.on(o.Events.FRAG_LOADING,this.onFragLoading,this),e.on(o.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.Events.ERROR,this.onError,this)},a.unregisterListeners=function(){var e=this.hls;e.off(o.Events.FRAG_LOADING,this.onFragLoading,this),e.off(o.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.Events.ERROR,this.onError,this)},a.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},a.onFragLoading=function(e,t){var r,a=t.frag;a.type===$.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=a,this.partCurrent=null!=(r=t.part)?r:null,this.timer=self.setInterval(this.onCheck,100)))},a.onLevelLoaded=function(e,t){var r=this.hls.config;t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)},a._abandonRulesCheck=function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls,a=r.autoLevelEnabled,n=r.media;if(e&&n){var s=t?t.stats:e.stats,u=t?t.duration:e.duration;if(s.aborted||s.loaded&&s.loaded===s.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(a&&!n.paused&&n.playbackRate&&n.readyState){var c=r.mainForwardBufferInfo;if(null!==c){var d=performance.now()-s.loading.start,p=Math.abs(n.playbackRate);if(!(d<=500*u/p)){var h=s.loaded&&s.loading.first,f=this.bwEstimator.getEstimate(),g=r.levels,y=r.minAutoLevel,m=g[e.level],v=s.total||Math.max(s.loaded,Math.round(u*m.maxBitrate/8)),_=h?1e3*s.loaded/d:0,k=_?(v-s.loaded)/_:8*v/f,E=c.len/p;if(!(k<=E)){var T,b=Number.POSITIVE_INFINITY;for(T=e.level-1;T>y;T--){var S=g[T].maxBitrate;if((b=_?u*S/(6.4*_):u*S/f)<E)break}b>=k||(l.logger.warn("Fragment "+e.sn+(t?" part "+t.index:"")+" of level "+e.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+T+"\n      Current BW estimate: "+((0,i.isFiniteNumber)(f)?(f/1024).toFixed(3):"Unknown")+" Kb/s\n      Estimated load time for current fragment: "+k.toFixed(3)+" s\n      Estimated load time for the next fragment: "+b.toFixed(3)+" s\n      Time to underbuffer: "+E.toFixed(3)+" s"),r.nextLoadLevel=T,h&&this.bwEstimator.sample(d,s.loaded),this.clearTimer(),(e.loader||e.keyLoader)&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),r.trigger(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:s}))}}}}}},a.onFragLoaded=function(e,t){var r=t.frag,a=t.part;if(r.type===$.PlaylistLevelType.MAIN&&(0,i.isFiniteNumber)(r.sn)){var n=a?a.stats:r.stats,s=a?a.duration:r.duration;if(this.clearTimer(),this.lastLoadedFragLevel=r.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var l=this.hls.levels[r.level],u=(l.loaded?l.loaded.bytes:0)+n.loaded,c=(l.loaded?l.loaded.duration:0)+s;l.loaded={bytes:u,duration:c},l.realBitrate=Math.round(8*u/c)}if(r.bitrateTest){var d={stats:n,frag:r,part:a,id:r.type};this.onFragBuffered(o.Events.FRAG_BUFFERED,d)}}},a.onFragBuffered=function(e,t){var r=t.frag,a=t.part,n=a?a.stats:r.stats;if(!n.aborted&&r.type===$.PlaylistLevelType.MAIN&&"initSegment"!==r.sn){var i=n.parsing.end-n.loading.start;this.bwEstimator.sample(i,n.loaded),n.bwEstimate=this.bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},a.onError=function(e,t){var r;if((null===(r=t.frag)||void 0===r?void 0:r.type)===$.PlaylistLevelType.MAIN){if(t.type===s.ErrorTypes.KEY_SYSTEM_ERROR)return void this.clearTimer();switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:this.clearTimer()}}},a.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},a.getNextABRAutoLevel=function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls,a=r.maxAutoLevel,n=r.config,i=r.minAutoLevel,o=r.media,s=t?t.duration:e?e.duration:0,u=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,c=this.bwEstimator?this.bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,d=r.mainForwardBufferInfo,p=(d?d.len:0)/u,h=this.findBestLevel(c,i,a,p,n.abrBandWidthFactor,n.abrBandWidthUpFactor);if(h>=0)return h;l.logger.trace((p?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var f=s?Math.min(s,n.maxStarvationDelay):n.maxStarvationDelay,g=n.abrBandWidthFactor,y=n.abrBandWidthUpFactor;if(!p){var m=this.bitrateTestDelay;m&&(f=(s?Math.min(s,n.maxLoadingDelay):n.maxLoadingDelay)-m,l.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*f)+" ms"),g=y=1)}return h=this.findBestLevel(c,i,a,p+f,g,y),Math.max(h,0)},a.findBestLevel=function(e,t,r,a,n,o){for(var s,u=this.fragCurrent,c=this.partCurrent,d=this.lastLoadedFragLevel,p=this.hls.levels,h=p[d],f=!(null==h||null===(s=h.details)||void 0===s||!s.live),g=null==h?void 0:h.codecSet,y=c?c.duration:u?u.duration:0,m=r;m>=t;m--){var v=p[m];if(v&&(!g||v.codecSet===g)){var _,k=v.details,E=(c?null==k?void 0:k.partTarget:null==k?void 0:k.averagetargetduration)||y;_=m<=d?n*e:o*e;var T=p[m].maxBitrate,b=T*E/_;if(l.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+m+"/"+Math.round(_)+"/"+T+"/"+E+"/"+a+"/"+b),_>T&&(0===b||!(0,i.isFiniteNumber)(b)||f&&!this.bitrateTestDelay||b<a))return m}}return-1},t=e,(r=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator;if(-1!==e&&!t.canEstimate())return e;var r=this.getNextABRAutoLevel();return-1!==e&&this.hls.levels[r].loadError?e:(-1!==e&&(r=Math.min(e,r)),r)},set:function(e){this._nextAutoLevel=e}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();var St=function(){function e(){this.chunks=[],this.dataLength=0}var t=e.prototype;return t.push=function(e){this.chunks.push(e),this.dataLength+=e.length},t.flush=function(){var e,t=this.chunks,r=this.dataLength;return t.length?(e=1===t.length?t[0]:function(e,t){for(var r=new Uint8Array(t),a=0,n=0;n<e.length;n++){var i=e[n];r.set(i,a),a+=i.length}return r}(t,r),this.reset(),e):new Uint8Array(0)},t.reset=function(){this.chunks.length=0,this.dataLength=0},e}();function At(){return(At=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ct(e,t){return(Ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}const Pt=function(e){var t,r;function a(t,r,a){var n;return(n=e.call(this,t,r,a,"[audio-stream-controller]")||this).videoBuffer=null,n.videoTrackCC=-1,n.waitingVideoCC=-1,n.audioSwitch=!1,n.trackId=-1,n.waitingData=null,n.mainDetails=null,n.bufferFlushed=!1,n.cachedTrackLoadedData=null,n._registerListeners(),n}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Ct(t,r);var n=a.prototype;return n.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},n._registerListeners=function(){var e=this.hls;e.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(o.Events.ERROR,this.onError,this),e.on(o.Events.BUFFER_RESET,this.onBufferReset,this),e.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},n._unregisterListeners=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(o.Events.ERROR,this.onError,this),e.off(o.Events.BUFFER_RESET,this.onBufferReset,this),e.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},n.onInitPtsFound=function(e,t){var r=t.frag,a=t.id,n=t.initPTS;if("main"===a){var i=r.cc;this.initPTS[r.cc]=n,this.log("InitPTS for cc: "+i+" found from main: "+n),this.videoTrackCC=i,this.state===rt&&this.tick()}},n.startLoad=function(e){if(!this.levels)return this.startPosition=e,void(this.state=We);var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t,this.state=ze):(this.loadedmetadata=!1,this.state=Qe),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},n.doTick=function(){switch(this.state){case ze:this.doTickIdle();break;case Qe:var t,r=this.levels,a=this.trackId,n=null==r||null===(t=r[a])||void 0===t?void 0:t.details;if(n){if(this.waitForCdnTuneIn(n))break;this.state=rt}break;case Xe:var i,o=performance.now(),s=this.retryDate;(!s||o>=s||null!==(i=this.media)&&void 0!==i&&i.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=ze);break;case rt:var l=this.waitingData;if(l){var u=l.frag,c=l.part,d=l.cache,p=l.complete;if(void 0!==this.initPTS[u.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=Ye;var h={frag:u,part:c,payload:d.flush(),networkDetails:null};this._handleFragmentLoadProgress(h),p&&e.prototype._handleFragmentLoadComplete.call(this,h)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+u.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var f=this.getLoadPosition(),g=Oe.bufferInfo(this.mediaBuffer,f,this.config.maxBufferHole);$e(g.end,this.config.maxFragLookUpTolerance,u)<0&&(this.log("Waiting fragment cc ("+u.cc+") @ "+u.start+" cancelled because another fragment at "+g.end+" is needed"),this.clearWaitingFragment())}}else this.state=ze}this.onTickEnd()},n.clearWaitingFragment=function(){var e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=ze)},n.resetLoadingState=function(){this.clearWaitingFragment(),e.prototype.resetLoadingState.call(this)},n.onTickEnd=function(){var e=this.media;e&&e.readyState&&(this.lastCurrentTime=e.currentTime)},n.doTickIdle=function(){var e=this.hls,t=this.levels,r=this.media,a=this.trackId,n=e.config;if(t&&t[a]&&(r||!this.startFragRequested&&n.startFragPrefetch)){var i=t[a].details;if(!i||i.live&&this.levelLastLoaded!==a||this.waitForCdnTuneIn(i))this.state=Qe;else{var s=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,m.ElementaryStreamTypes.AUDIO,$.PlaylistLevelType.AUDIO));var l=this.getFwdBufferInfo(s,$.PlaylistLevelType.AUDIO);if(null!==l){var u=this.audioSwitch;if(!u&&this._streamEnded(l,i))return e.trigger(o.Events.BUFFER_EOS,{type:"audio"}),void(this.state=et);var c=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,$.PlaylistLevelType.MAIN);if(!(l.len>=this.getMaxBufferLength(null==c?void 0:c.len))||u){var d=i.fragments[0].start,p=l.end;if(u&&r){var h=this.getLoadPosition();p=h,i.PTSKnown&&h<d&&(l.end>d||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=d+.05)}if(!(c&&p>c.end+i.targetduration)&&(c&&c.len||!l.len)){var f=this.getNextFragment(p,i);f?this.loadFragment(f,i,p):this.bufferFlushed=!0}}}}}},n.getMaxBufferLength=function(t){var r=e.prototype.getMaxBufferLength.call(this);return t?Math.max(r,t):r},n.onMediaDetaching=function(){this.videoBuffer=null,e.prototype.onMediaDetaching.call(this)},n.onAudioTracksUpdated=function(e,t){var r=t.audioTracks;this.resetTransmuxer(),this.levels=r.map((function(e){return new ie(e)}))},n.onAudioTrackSwitching=function(e,t){var r=!!t.url;this.trackId=t.id;var a=this.fragCurrent;a&&a.abortRequests(),this.fragCurrent=null,this.clearWaitingFragment(),r?this.setInterval(100):this.resetTransmuxer(),r?(this.audioSwitch=!0,this.state=ze):this.state=We,this.tick()},n.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},n.onLevelLoaded=function(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(o.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},n.onAudioTrackLoaded=function(e,t){var r;if(null!=this.mainDetails){var a=this.levels,n=t.details,i=t.id;if(a){this.log("Track "+i+" loaded ["+n.startSN+","+n.endSN+"],duration:"+n.totalduration);var o=a[i],s=0;if(n.live||null!==(r=o.details)&&void 0!==r&&r.live){var l=this.mainDetails;if(n.fragments[0]||(n.deltaUpdateFailed=!0),n.deltaUpdateFailed||!l)return;!o.details&&n.hasProgramDateTime&&l.hasProgramDateTime?(Be(n,l),s=n.fragments[0].start):s=this.alignPlaylists(n,o.details)}o.details=n,this.levelLastLoaded=i,this.startFragRequested||!this.mainDetails&&n.live||this.setStartPosition(o.details,s),this.state!==Qe||this.waitForCdnTuneIn(n)||(this.state=ze),this.tick()}else this.warn("Audio tracks were reset while loading level "+i)}else this.cachedTrackLoadedData=t},n._handleFragmentLoadProgress=function(e){var t,r=e.frag,a=e.part,n=e.payload,i=this.config,o=this.trackId,s=this.levels;if(s){var l=s[o],u=l.details,c=i.defaultAudioCodec||l.audioCodec||"mp4a.40.2",d=this.transmuxer;d||(d=this.transmuxer=new mt(this.hls,$.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var p=this.initPTS[r.cc],h=null===(t=r.initSegment)||void 0===t?void 0:t.data;if(void 0!==p){var f=a?a.index:-1,g=-1!==f,y=new Le(r.level,r.sn,r.stats.chunkCount,n.byteLength,f,g);d.push(n,h,c,"",r,a,u.totalduration,!1,y,p)}else this.log("Unknown video PTS for cc "+r.cc+", waiting for video PTS before demuxing audio frag "+r.sn+" of ["+u.startSN+" ,"+u.endSN+"],track "+o),(this.waitingData=this.waitingData||{frag:r,part:a,cache:new St,complete:!1}).cache.push(new Uint8Array(n)),this.waitingVideoCC=this.videoTrackCC,this.state=rt}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},n._handleFragmentLoadComplete=function(t){this.waitingData?this.waitingData.complete=!0:e.prototype._handleFragmentLoadComplete.call(this,t)},n.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},n.onBufferCreated=function(e,t){var r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)},n.onFragBuffered=function(e,t){var r,a=t.frag,n=t.part;a.type===$.PlaylistLevelType.AUDIO?this.fragContextChanged(a)?this.warn("Fragment "+a.sn+(n?" p: "+n.index:"")+" of level "+a.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):("initSegment"!==a.sn&&(this.fragPrevious=a,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(a,n)):this.loadedmetadata||a.type!==$.PlaylistLevelType.MAIN||null!==(r=this.videoBuffer||this.media)&&void 0!==r&&r.buffered.length&&(this.loadedmetadata=!0)},n.onError=function(t,r){if(r.type!==s.ErrorTypes.KEY_SYSTEM_ERROR)switch(r.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.FRAG_PARSING_ERROR:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError($.PlaylistLevelType.AUDIO,r);break;case s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==tt&&this.state!==We&&(this.state=r.fatal?tt:ze,this.warn(r.details+" while loading frag, switching to "+this.state+" state"));break;case s.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===r.parent&&(this.state===Je||this.state===Ze)){var a=!0,n=this.getFwdBufferInfo(this.mediaBuffer,$.PlaylistLevelType.AUDIO);n&&n.len>.5&&(a=!this.reduceMaxBufferLength(n.len)),a&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError($.PlaylistLevelType.AUDIO,r)},n.onBufferFlushed=function(e,t){t.type===m.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===et&&(this.state=ze))},n._handleTransmuxComplete=function(e){var t,r="audio",a=this.hls,n=e.remuxResult,i=e.chunkMeta,s=this.getCurrentContext(i);if(!s)return this.warn("The loading context changed while buffering fragment "+i.sn+" of level "+i.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(i.level);var l=s.frag,u=s.part,c=s.level.details,d=n.audio,p=n.text,h=n.id3,f=n.initSegment;if(!this.fragContextChanged(l)&&c){if(this.state=Je,this.audioSwitch&&d&&this.completeAudioSwitch(),null!=f&&f.tracks&&(this._bufferInitSegment(f.tracks,l,i),a.trigger(o.Events.FRAG_PARSING_INIT_SEGMENT,{frag:l,id:r,tracks:f.tracks})),d){var g=d.startPTS,y=d.endPTS,v=d.startDTS,_=d.endDTS;u&&(u.elementaryStreams[m.ElementaryStreamTypes.AUDIO]={startPTS:g,endPTS:y,startDTS:v,endDTS:_}),l.setElementaryStreamInfo(m.ElementaryStreamTypes.AUDIO,g,y,v,_),this.bufferFragmentData(d,l,u,i)}if(null!=h&&null!==(t=h.samples)&&void 0!==t&&t.length){var k=At({id:r,frag:l,details:c},h);a.trigger(o.Events.FRAG_PARSING_METADATA,k)}if(p){var E=At({id:r,frag:l,details:c},p);a.trigger(o.Events.FRAG_PARSING_USERDATA,E)}}},n._bufferInitSegment=function(e,t,r){if(this.state===Je){e.video&&delete e.video;var a=e.audio;if(a){a.levelCodec=a.codec,a.id="audio",this.log("Init audio buffer, container:"+a.container+", codecs[parsed]=["+a.codec+"]"),this.hls.trigger(o.Events.BUFFER_CODECS,e);var n=a.initSegment;if(null!=n&&n.byteLength){var i={type:"audio",frag:t,part:null,chunkMeta:r,parent:t.type,data:n};this.hls.trigger(o.Events.BUFFER_APPENDING,i)}this.tick()}}},n.loadFragment=function(t,r,a){var n=this.fragmentTracker.getState(t);this.fragCurrent=t,(this.audioSwitch||n===ye.NOT_LOADED||n===ye.PARTIAL)&&("initSegment"===t.sn?this._loadInitSegment(t,r):r.live&&!(0,i.isFiniteNumber)(this.initPTS[t.cc])?(this.log("Waiting for video PTS in continuity counter "+t.cc+" of live stream before loading audio fragment "+t.sn+" of level "+this.trackId),this.state=rt):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,r,a)))},n.completeAudioSwitch=function(){var t=this.hls,r=this.media,a=this.trackId;r&&(this.log("Switching audio track : flushing all audio"),e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,t.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:a})},a}(nt);function wt(e,t){return(wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}const xt=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,"[audio-track-controller]")||this).tracks=[],r.groupId=null,r.tracksInGroup=[],r.trackId=-1,r.trackName="",r.selectDefaultTrack=!0,r.registerListeners(),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,wt(t,r);var n,i,l=a.prototype;return l.registerListeners=function(){var e=this.hls;e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(o.Events.ERROR,this.onError,this)},l.unregisterListeners=function(){var e=this.hls;e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(o.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(o.Events.ERROR,this.onError,this)},l.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,e.prototype.destroy.call(this)},l.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},l.onManifestParsed=function(e,t){this.tracks=t.audioTracks||[]},l.onAudioTrackLoaded=function(e,t){var r=t.id,a=t.details,n=this.tracksInGroup[r];if(n){var i=n.details;n.details=t.details,this.log("audioTrack "+r+" loaded ["+a.startSN+"-"+a.endSN+"]"),r===this.trackId&&(this.retryCount=0,this.playlistLoaded(r,t,i))}else this.warn("Invalid audio track id "+r)},l.onLevelLoading=function(e,t){this.switchLevel(t.level)},l.onLevelSwitching=function(e,t){this.switchLevel(t.level)},l.switchLevel=function(e){var t=this.hls.levels[e];if(null!=t&&t.audioGroupIds){var r=t.audioGroupIds[t.urlId];if(this.groupId!==r){this.groupId=r;var a=this.tracks.filter((function(e){return!r||e.groupId===r}));this.selectDefaultTrack&&!a.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),this.tracksInGroup=a;var n={audioTracks:a};this.log("Updating audio tracks, "+a.length+' track(s) found in "'+r+'" group-id'),this.hls.trigger(o.Events.AUDIO_TRACKS_UPDATED,n),this.selectInitialTrack()}}},l.onError=function(t,r){e.prototype.onError.call(this,t,r),!r.fatal&&r.context&&r.context.type===$.PlaylistContextType.AUDIO_TRACK&&r.context.id===this.trackId&&r.context.groupId===this.groupId&&this.retryLoadingOrFail(r)},l.setAudioTrack=function(e){var t=this.tracksInGroup;if(e<0||e>=t.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var r=t[this.trackId];this.log("Now switching to audio-track index "+e);var a=t[e],n=a.id,i=a.groupId,s=void 0===i?"":i,l=a.name,u=a.type,c=a.url;if(this.trackId=e,this.trackName=l,this.selectDefaultTrack=!1,this.hls.trigger(o.Events.AUDIO_TRACK_SWITCHING,{id:n,groupId:s,name:l,type:u,url:c}),!a.details||a.details.live){var d=this.switchParams(a.url,null==r?void 0:r.details);this.loadPlaylist(d)}}},l.selectInitialTrack=function(){this.tracksInGroup;var e=this.trackName,t=this.findTrackId(e)||this.findTrackId();-1!==t?this.setAudioTrack(t):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},l.findTrackId=function(e){for(var t=this.tracksInGroup,r=0;r<t.length;r++){var a=t[r];if((!this.selectDefaultTrack||a.default)&&(!e||e===a.name))return a.id}return-1},l.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(r)){var a=r.id,n=r.groupId,i=r.url;if(t)try{i=t.addDirectives(i)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("loading audio-track playlist for id: "+a),this.clearTimer(),this.hls.trigger(o.Events.AUDIO_TRACK_LOADING,{url:i,id:a,groupId:n,deliveryDirectives:t||null})}},n=a,(i=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),a}(he);function It(e,t){return(It=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Mt=function(e){var t,r;function a(t,r,a){var n;return(n=e.call(this,t,r,a,"[subtitle-stream-controller]")||this).levels=[],n.currentTrackId=-1,n.tracksBuffered=[],n.mainDetails=null,n._registerListeners(),n}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,It(t,r);var n,i,s=a.prototype;return s.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},s._registerListeners=function(){var e=this.hls;e.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.Events.ERROR,this.onError,this),e.on(o.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(o.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(o.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(o.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(o.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.Events.ERROR,this.onError,this),e.off(o.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(o.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(o.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(o.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(o.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.startLoad=function(e){this.stopLoad(),this.state=ze,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},s.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},s.onLevelLoaded=function(e,t){this.mainDetails=t.details},s.onSubtitleFragProcessed=function(e,t){var r=t.frag,a=t.success;if(this.fragPrevious=r,this.state=ze,a){var n=this.tracksBuffered[this.currentTrackId];if(n){for(var i,o=r.start,s=0;s<n.length;s++)if(o>=n[s].start&&o<=n[s].end){i=n[s];break}var l=r.start+r.duration;i?i.end=l:(i={start:o,end:l},n.push(i)),this.fragmentTracker.fragBuffered(r)}}},s.onBufferFlushing=function(e,t){var r=t.startOffset,a=t.endOffset;if(0===r&&a!==Number.POSITIVE_INFINITY){var n=this.currentTrackId,i=this.levels;if(!i.length||!i[n]||!i[n].details)return;var o=a-i[n].details.targetduration;if(o<=0)return;t.endOffsetSubtitles=Math.max(0,o),this.tracksBuffered.forEach((function(e){for(var t=0;t<e.length;)if(e[t].end<=o)e.shift();else{if(!(e[t].start<o))break;e[t].start=o,t++}})),this.fragmentTracker.removeFragmentsInRange(r,o,$.PlaylistLevelType.SUBTITLE)}},s.onFragBuffered=function(e,t){var r;this.loadedmetadata||t.frag.type!==$.PlaylistLevelType.MAIN||null!==(r=this.media)&&void 0!==r&&r.buffered.length&&(this.loadedmetadata=!0)},s.onError=function(e,t){var r=t.frag;r&&r.type===$.PlaylistLevelType.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state=ze)},s.onSubtitleTracksUpdated=function(e,t){var r=this,a=t.subtitleTracks;this.tracksBuffered=[],this.levels=a.map((function(e){return new ie(e)})),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach((function(e){r.tracksBuffered[e.id]=[]})),this.mediaBuffer=null},s.onSubtitleTrackSwitch=function(e,t){if(this.currentTrackId=t.id,this.levels.length&&-1!==this.currentTrackId){var r=this.levels[this.currentTrackId];null!=r&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(500)}else this.clearInterval()},s.onSubtitleTrackLoaded=function(e,t){var r,a=t.details,n=t.id,i=this.currentTrackId,o=this.levels;if(o.length){var s=o[i];if(!(n>=o.length||n!==i)&&s){this.mediaBuffer=this.mediaBufferTimeRanges;var l=0;if(a.live||null!==(r=s.details)&&void 0!==r&&r.live){var u=this.mainDetails;if(a.deltaUpdateFailed||!u)return;var c=u.fragments[0];s.details?0===(l=this.alignPlaylists(a,s.details))&&c&&pe(a,l=c.start):a.hasProgramDateTime&&u.hasProgramDateTime?(Be(a,u),l=a.fragments[0].start):c&&pe(a,l=c.start)}s.details=a,this.levelLastLoaded=n,this.startFragRequested||!this.mainDetails&&a.live||this.setStartPosition(s.details,l),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===ze&&(Ve(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),s.details=void 0))}}},s._handleFragmentLoadComplete=function(e){var t=this,r=e.frag,a=e.payload,n=r.decryptdata,i=this.hls;if(!this.fragContextChanged(r)&&a&&a.byteLength>0&&n&&n.key&&n.iv&&"AES-128"===n.method){var s=performance.now();this.decrypter.decrypt(new Uint8Array(a),n.key.buffer,n.iv.buffer).then((function(e){var t=performance.now();i.trigger(o.Events.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:s,tdecrypt:t}})})).catch((function(e){t.warn(e.name+": "+e.message),t.state=ze}))}},s.doTick=function(){if(this.media){if(this.state===ze){var e=this.currentTrackId,t=this.levels;if(!t.length||!t[e]||!t[e].details)return;var r=t[e].details,a=r.targetduration,n=this.config,i=this.getLoadPosition(),o=Oe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i-a,n.maxBufferHole),s=o.end,l=o.len,u=this.getFwdBufferInfo(this.media,$.PlaylistLevelType.MAIN);if(l>this.getMaxBufferLength(null==u?void 0:u.len)+a)return;var c=r.fragments,d=c.length,p=r.edge,h=null,f=this.fragPrevious;if(s<p){var g=n.maxFragLookUpTolerance;!(h=Ve(f,c,Math.max(c[0].start,s),g))&&f&&f.start<c[0].start&&(h=c[0])}else h=c[d-1];if(!h)return;h=this.mapToInitFragWhenRequired(h),this.fragmentTracker.getState(h)===ye.NOT_LOADED&&this.loadFragment(h,r,s)}}else this.state=ze},s.getMaxBufferLength=function(t){var r=e.prototype.getMaxBufferLength.call(this);return t?Math.max(r,t):r},s.loadFragment=function(t,r,a){this.fragCurrent=t,"initSegment"===t.sn?this._loadInitSegment(t,r):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,r,a))},n=a,(i=[{key:"mediaBufferTimeRanges",get:function(){return new Dt(this.tracksBuffered[this.currentTrackId]||[])}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),a}(nt),Dt=function(e){this.buffered=void 0;var t=function(t,r,a){if((r>>>=0)>a-1)throw new DOMException("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+r+") is greater than the maximum bound ("+a+")");return e[r][t]};this.buffered={get length(){return e.length},end:function(r){return t("end",r,e.length)},start:function(r){return t("start",r,e.length)}}};function Rt(e,t){return(Rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ot(e){for(var t=[],r=0;r<e.length;r++){var a=e[r];"subtitles"!==a.kind&&"captions"!==a.kind||!a.label||t.push(e[r])}return t}const Lt=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,"[subtitle-track-controller]")||this).media=null,r.tracks=[],r.groupId=null,r.tracksInGroup=[],r.trackId=-1,r.selectDefaultTrack=!0,r.queuedDefaultTrack=-1,r.trackChangeListener=function(){return r.onTextTracksChanged()},r.asyncPollTrackChange=function(){return r.pollTrackChange(0)},r.useTextTrackPolling=!1,r.subtitlePollingInterval=-1,r._subtitleDisplay=!0,r.registerListeners(),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Rt(t,r);var n,i,s=a.prototype;return s.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,e.prototype.destroy.call(this)},s.registerListeners=function(){var e=this.hls;e.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(o.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(o.Events.ERROR,this.onError,this)},s.unregisterListeners=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(o.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(o.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(o.Events.ERROR,this.onError,this)},s.onMediaAttached=function(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},s.pollTrackChange=function(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)},s.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Ot(this.media.textTracks).forEach((function(e){z(e)})),this.subtitleTrack=-1,this.media=null)},s.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},s.onManifestParsed=function(e,t){this.tracks=t.subtitleTracks},s.onSubtitleTrackLoaded=function(e,t){var r=t.id,a=t.details,n=this.trackId,i=this.tracksInGroup[n];if(i){var o=i.details;i.details=t.details,this.log("subtitle track "+r+" loaded ["+a.startSN+"-"+a.endSN+"]"),r===this.trackId&&(this.retryCount=0,this.playlistLoaded(r,t,o))}else this.warn("Invalid subtitle track id "+r)},s.onLevelLoading=function(e,t){this.switchLevel(t.level)},s.onLevelSwitching=function(e,t){this.switchLevel(t.level)},s.switchLevel=function(e){var t=this.hls.levels[e];if(null!=t&&t.textGroupIds){var r=t.textGroupIds[t.urlId];if(this.groupId!==r){var a=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,n=this.tracks.filter((function(e){return!r||e.groupId===r}));this.tracksInGroup=n;var i=this.findTrackId(null==a?void 0:a.name)||this.findTrackId();this.groupId=r;var s={subtitleTracks:n};this.log("Updating subtitle tracks, "+n.length+' track(s) found in "'+r+'" group-id'),this.hls.trigger(o.Events.SUBTITLE_TRACKS_UPDATED,s),-1!==i&&this.setSubtitleTrack(i,a)}}},s.findTrackId=function(e){for(var t=this.tracksInGroup,r=0;r<t.length;r++){var a=t[r];if((!this.selectDefaultTrack||a.default)&&(!e||e===a.name))return a.id}return-1},s.onError=function(t,r){e.prototype.onError.call(this,t,r),!r.fatal&&r.context&&r.context.type===$.PlaylistContextType.SUBTITLE_TRACK&&r.context.id===this.trackId&&r.context.groupId===this.groupId&&this.retryLoadingOrFail(r)},s.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(r)){var a=r.id,n=r.groupId,i=r.url;if(t)try{i=t.addDirectives(i)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("Loading subtitle playlist for id "+a),this.hls.trigger(o.Events.SUBTITLE_TRACK_LOADING,{url:i,id:a,groupId:n,deliveryDirectives:t||null})}},s.toggleTrackModes=function(e){var t=this,r=this.media,a=this.trackId;if(r){var n=Ot(r.textTracks),i=n.filter((function(e){return e.groupId===t.groupId}));if(-1===e)[].slice.call(n).forEach((function(e){e.mode="disabled"}));else{var o=i[a];o&&(o.mode="disabled")}var s=i[e];s&&(s.mode=this.subtitleDisplay?"showing":"hidden")}},s.setSubtitleTrack=function(e,t){var r,a=this.tracksInGroup;if(this.media){if(this.trackId!==e&&this.toggleTrackModes(e),!(this.trackId===e&&(-1===e||null!==(r=a[e])&&void 0!==r&&r.details)||e<-1||e>=a.length)){this.clearTimer();var n=a[e];if(this.log("Switching to subtitle track "+e),this.trackId=e,n){var i=n.id,s=n.groupId,l=void 0===s?"":s,u=n.name,c=n.type,d=n.url;this.hls.trigger(o.Events.SUBTITLE_TRACK_SWITCH,{id:i,groupId:l,name:u,type:c,url:d});var p=this.switchParams(n.url,null==t?void 0:t.details);this.loadPlaylist(p)}else this.hls.trigger(o.Events.SUBTITLE_TRACK_SWITCH,{id:e})}}else this.queuedDefaultTrack=e},s.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=Ot(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},n=a,(i=[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1;var t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),a}(he);var Nt,Ut=function(){function e(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}var t=e.prototype;return t.append=function(e,t){var r=this.queues[t];r.push(e),1===r.length&&this.buffers[t]&&this.executeNext(t)},t.insertAbort=function(e,t){this.queues[t].unshift(e),this.executeNext(t)},t.appendBlocker=function(e){var t,r=new Promise((function(e){t=e})),a={execute:t,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(a,e),r},t.executeNext=function(e){var t=this.buffers,r=this.queues,a=t[e],n=r[e];if(n.length){var i=n[0];try{i.execute()}catch(t){l.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),i.onError(t),a&&a.updating||(n.shift(),this.executeNext(e))}}},t.shiftAndExecuteNext=function(e){this.queues[e].shift(),this.executeNext(e)},t.current=function(e){return this.queues[e][0]},e}(),Ft=it(),Bt=/([ha]vc.)(?:\.[^.,]+)+/,jt=function(){function e(e){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var e=t.media,r=t.mediaSource;l.logger.log("[buffer-controller]: Media source opened"),e&&(e.removeEventListener("emptied",t._onMediaEmptied),t.updateMediaElementDuration(),t.hls.trigger(o.Events.MEDIA_ATTACHED,{media:e})),r&&r.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){l.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){l.logger.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=function(){var e=t.media,r=t._objectUrl;e&&e.src!==r&&l.logger.error("Media element src was set while attaching MediaSource ("+r+" > "+e.src+")")},this.hls=e,this._initSourceBuffer(),this.registerListeners()}var t=e.prototype;return t.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},t.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},t.registerListeners=function(){var e=this.hls;e.on(o.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.Events.BUFFER_RESET,this.onBufferReset,this),e.on(o.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.on(o.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(o.Events.BUFFER_EOS,this.onBufferEos,this),e.on(o.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(o.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(o.Events.FRAG_PARSED,this.onFragParsed,this),e.on(o.Events.FRAG_CHANGED,this.onFragChanged,this)},t.unregisterListeners=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.Events.BUFFER_RESET,this.onBufferReset,this),e.off(o.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.off(o.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(o.Events.BUFFER_EOS,this.onBufferEos,this),e.off(o.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(o.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(o.Events.FRAG_PARSED,this.onFragParsed,this),e.off(o.Events.FRAG_CHANGED,this.onFragChanged,this)},t._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new Ut(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null},t.onManifestParsed=function(e,t){var r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,this.details=null,l.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},t.onMediaAttaching=function(e,t){var r=this.media=t.media;if(r&&Ft){var a=this.mediaSource=new Ft;a.addEventListener("sourceopen",this._onMediaSourceOpen),a.addEventListener("sourceended",this._onMediaSourceEnded),a.addEventListener("sourceclose",this._onMediaSourceClose),r.src=self.URL.createObjectURL(a),this._objectUrl=r.src,r.addEventListener("emptied",this._onMediaEmptied)}},t.onMediaDetaching=function(){var e=this.media,t=this.mediaSource,r=this._objectUrl;if(t){if(l.logger.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){l.logger.warn("[buffer-controller]: onMediaDetaching: "+e.message+" while calling endOfStream")}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),e.src===r?(e.removeAttribute("src"),e.load()):l.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(o.Events.MEDIA_DETACHED,void 0)},t.onBufferReset=function(){var e=this;this.getSourceBufferTypes().forEach((function(t){var r=e.sourceBuffer[t];try{r&&(e.removeBufferListeners(t),e.mediaSource&&e.mediaSource.removeSourceBuffer(r),e.sourceBuffer[t]=void 0)}catch(e){l.logger.warn("[buffer-controller]: Failed to reset the "+t+" buffer",e)}})),this._initSourceBuffer()},t.onBufferCodecs=function(e,t){var r=this,a=this.getSourceBufferTypes().length;Object.keys(t).forEach((function(e){if(a){var n=r.tracks[e];if(n&&"function"==typeof n.buffer.changeType){var i=t[e],o=i.id,s=i.codec,u=i.levelCodec,c=i.container,d=i.metadata,p=(n.levelCodec||n.codec).replace(Bt,"$1"),h=(u||s).replace(Bt,"$1");if(p!==h){var f=c+";codecs="+(u||s);r.appendChangeType(e,f),l.logger.log("[buffer-controller]: switching codec "+p+" to "+h),r.tracks[e]={buffer:n.buffer,codec:s,container:c,levelCodec:u,metadata:d,id:o}}}}else r.pendingTracks[e]=t[e]})),a||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},t.appendChangeType=function(e,t){var r=this,a=this.operationQueue,n={execute:function(){var n=r.sourceBuffer[e];n&&(l.logger.log("[buffer-controller]: changing "+e+" sourceBuffer type to "+t),n.changeType(t)),a.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(t){l.logger.warn("[buffer-controller]: Failed to change "+e+" SourceBuffer type",t)}};a.append(n,e)},t.onBufferAppending=function(e,t){var r=this,a=this.hls,n=this.operationQueue,i=this.tracks,u=t.data,c=t.type,d=t.frag,p=t.part,h=t.chunkMeta,f=h.buffering[c],g=self.performance.now();f.start=g;var y=d.stats.buffering,m=p?p.stats.buffering:null;0===y.start&&(y.start=g),m&&0===m.start&&(m.start=g);var v=i.audio,_=!1;"audio"===c&&"audio/mpeg"===(null==v?void 0:v.container)&&(_=!this.lastMpegAudioChunk||1===h.id||this.lastMpegAudioChunk.sn!==h.sn,this.lastMpegAudioChunk=h);var k=d.start,E={execute:function(){if(f.executeStart=self.performance.now(),_){var e=r.sourceBuffer[c];if(e){var t=k-e.timestampOffset;Math.abs(t)>=.1&&(l.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+k+" (delta: "+t+") sn: "+d.sn+")"),e.timestampOffset=k)}}r.appendExecutor(u,c)},onStart:function(){},onComplete:function(){var e=self.performance.now();f.executeEnd=f.end=e,0===y.first&&(y.first=e),m&&0===m.first&&(m.first=e);var t=r.sourceBuffer,a={};for(var n in t)a[n]=Oe.getBuffered(t[n]);r.appendError=0,r.hls.trigger(o.Events.BUFFER_APPENDED,{type:c,frag:d,part:p,chunkMeta:h,parent:d.type,timeRanges:a})},onError:function(e){l.logger.error("[buffer-controller]: Error encountered while trying to append to the "+c+" SourceBuffer",e);var t={type:s.ErrorTypes.MEDIA_ERROR,parent:d.type,details:s.ErrorDetails.BUFFER_APPEND_ERROR,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=s.ErrorDetails.BUFFER_FULL_ERROR:(r.appendError++,t.details=s.ErrorDetails.BUFFER_APPEND_ERROR,r.appendError>a.config.appendErrorMaxRetry&&(l.logger.error("[buffer-controller]: Failed "+a.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),t.fatal=!0,a.stopLoad())),a.trigger(o.Events.ERROR,t)}};n.append(E,c)},t.onBufferFlushing=function(e,t){var r=this,a=this.operationQueue,n=function(e){return{execute:r.removeExecutor.bind(r,e,t.startOffset,t.endOffset),onStart:function(){},onComplete:function(){r.hls.trigger(o.Events.BUFFER_FLUSHED,{type:e})},onError:function(t){l.logger.warn("[buffer-controller]: Failed to remove from "+e+" SourceBuffer",t)}}};t.type?a.append(n(t.type),t.type):this.getSourceBufferTypes().forEach((function(e){a.append(n(e),e)}))},t.onFragParsed=function(e,t){var r=this,a=t.frag,n=t.part,i=[],s=n?n.elementaryStreams:a.elementaryStreams;s[m.ElementaryStreamTypes.AUDIOVIDEO]?i.push("audiovideo"):(s[m.ElementaryStreamTypes.AUDIO]&&i.push("audio"),s[m.ElementaryStreamTypes.VIDEO]&&i.push("video")),0===i.length&&l.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+a.type+" level: "+a.level+" sn: "+a.sn),this.blockBuffers((function(){var e=self.performance.now();a.stats.buffering.end=e,n&&(n.stats.buffering.end=e);var t=n?n.stats:a.stats;r.hls.trigger(o.Events.FRAG_BUFFERED,{frag:a,part:n,stats:t,id:a.type})}),i)},t.onFragChanged=function(e,t){this.flushBackBuffer()},t.onBufferEos=function(e,t){var r=this;this.getSourceBufferTypes().reduce((function(e,a){var n=r.sourceBuffer[a];return!n||t.type&&t.type!==a||(n.ending=!0,n.ended||(n.ended=!0,l.logger.log("[buffer-controller]: "+a+" sourceBuffer now EOS"))),e&&!(n&&!n.ended)}),!0)&&(l.logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers((function(){r.getSourceBufferTypes().forEach((function(e){var t=r.sourceBuffer[e];t&&(t.ending=!1)}));var e=r.mediaSource;e&&"open"===e.readyState?(l.logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),e.endOfStream()):e&&l.logger.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+e.readyState)})))},t.onLevelUpdated=function(e,t){var r=t.details;r.fragments.length&&(this.details=r,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},t.flushBackBuffer=function(){var e=this.hls,t=this.details,r=this.media,a=this.sourceBuffer;if(r&&null!==t){var n=this.getSourceBufferTypes();if(n.length){var s=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if((0,i.isFiniteNumber)(s)&&!(s<0)){var u=r.currentTime,c=t.levelTargetDuration,d=Math.max(s,c),p=Math.floor(u/c)*c-d;n.forEach((function(r){var n=a[r];if(n){var i=Oe.getBuffered(n);if(i.length>0&&p>i.start(0)){if(e.trigger(o.Events.BACK_BUFFER_REACHED,{bufferEnd:p}),t.live)e.trigger(o.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:p});else if(n.ended&&i.end(i.length-1)-u<2*c)return void l.logger.info("[buffer-controller]: Cannot flush "+r+" back buffer while SourceBuffer is in ended state");e.trigger(o.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:p,type:r})}}}))}}}},t.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var e=this.details,t=this.hls,r=this.media,a=this.mediaSource,n=e.fragments[0].start+e.totalduration,o=r.duration,s=(0,i.isFiniteNumber)(a.duration)?a.duration:0;e.live&&t.config.liveDurationInfinity?(l.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),a.duration=1/0,this.updateSeekableRange(e)):(n>s&&n>o||!(0,i.isFiniteNumber)(o))&&(l.logger.log("[buffer-controller]: Updating Media Source duration to "+n.toFixed(3)),a.duration=n)}},t.updateSeekableRange=function(e){var t=this.mediaSource,r=e.fragments;if(r.length&&e.live&&null!=t&&t.setLiveSeekableRange){var a=Math.max(0,r[0].start),n=Math.max(a,a+e.totalduration);t.setLiveSeekableRange(a,n)}},t.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.operationQueue,r=this.pendingTracks,a=Object.keys(r).length;if(a&&!e||2===a){this.createSourceBuffers(r),this.pendingTracks={};var n=this.getSourceBufferTypes();if(0===n.length)return void this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});n.forEach((function(e){t.executeNext(e)}))}},t.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");var a=0;for(var n in e)if(!t[n]){var i=e[n];if(!i)throw Error("source buffer exists for track "+n+", however track does not");var u=i.levelCodec||i.codec,c=i.container+";codecs="+u;l.logger.log("[buffer-controller]: creating sourceBuffer("+c+")");try{var d=t[n]=r.addSourceBuffer(c),p=n;this.addBufferListener(p,"updatestart",this._onSBUpdateStart),this.addBufferListener(p,"updateend",this._onSBUpdateEnd),this.addBufferListener(p,"error",this._onSBUpdateError),this.tracks[n]={buffer:d,codec:u,container:i.container,levelCodec:i.levelCodec,metadata:i.metadata,id:i.id},a++}catch(e){l.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+e.message),this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:c})}}a&&this.hls.trigger(o.Events.BUFFER_CREATED,{tracks:this.tracks})},t._onSBUpdateStart=function(e){this.operationQueue.current(e).onStart()},t._onSBUpdateEnd=function(e){var t=this.operationQueue;t.current(e).onComplete(),t.shiftAndExecuteNext(e)},t._onSBUpdateError=function(e,t){l.logger.error("[buffer-controller]: "+e+" SourceBuffer error",t),this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var r=this.operationQueue.current(e);r&&r.onError(t)},t.removeExecutor=function(e,t,r){var a=this.media,n=this.mediaSource,o=this.operationQueue,s=this.sourceBuffer[e];if(!a||!n||!s)return l.logger.warn("[buffer-controller]: Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void o.shiftAndExecuteNext(e);var u=(0,i.isFiniteNumber)(a.duration)?a.duration:1/0,c=(0,i.isFiniteNumber)(n.duration)?n.duration:1/0,d=Math.max(0,t),p=Math.min(r,u,c);p>d&&!s.ending?(s.ended=!1,l.logger.log("[buffer-controller]: Removing ["+d+","+p+"] from the "+e+" SourceBuffer"),s.remove(d,p)):o.shiftAndExecuteNext(e)},t.appendExecutor=function(e,t){var r=this.operationQueue,a=this.sourceBuffer[t];if(!a)return l.logger.warn("[buffer-controller]: Attempting to append to the "+t+" SourceBuffer, but it does not exist"),void r.shiftAndExecuteNext(t);a.ended=!1,a.appendBuffer(e)},t.blockBuffers=function(e,t){var r=this;if(void 0===t&&(t=this.getSourceBufferTypes()),!t.length)return l.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);var a=this.operationQueue,n=t.map((function(e){return a.appendBlocker(e)}));Promise.all(n).then((function(){e(),t.forEach((function(e){var t=r.sourceBuffer[e];t&&t.updating||a.shiftAndExecuteNext(e)}))}))},t.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},t.addBufferListener=function(e,t,r){var a=this.sourceBuffer[e];if(a){var n=r.bind(this,e);this.listeners[e].push({event:t,listener:n}),a.addEventListener(t,n)}},t.removeBufferListeners=function(e){var t=this.sourceBuffer[e];t&&this.listeners[e].forEach((function(e){t.removeEventListener(e.event,e.listener)}))},e}(),Vt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},$t=function(e){var t=e;return Vt.hasOwnProperty(e)&&(t=Vt[e]),String.fromCharCode(t)},Ht=100,Gt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Kt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Wt={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},zt={25:2,26:4,29:6,30:8,31:10,27:13,28:15},qt=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(Nt||(Nt={}));var Yt=function(){function e(){this.time=null,this.verboseLevel=Nt.ERROR}return e.prototype.log=function(e,t){if(this.verboseLevel>=e){var r="function"==typeof t?t():t;l.logger.log(this.time+" ["+e+"] "+r)}},e}(),Xt=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},Qt=function(){function e(e,t,r,a,n){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=a||"black",this.flash=n||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var a=t[r];e.hasOwnProperty(a)&&(this[a]=e[a])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),Jt=function(){function e(e,t,r,a,n,i){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new Qt(t,r,a,n,i)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),Zt=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<Ht;t++)this.chars.push(new Jt);this.logger=e,this.pos=0,this.currPenState=new Qt}var t=e.prototype;return t.equals=function(e){for(var t=!0,r=0;r<Ht;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<Ht;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<Ht;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(Nt.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>Ht&&(this.logger.log(Nt.DEBUG,"Too large cursor position "+this.pos),this.pos=Ht)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){var t=this;e>=144&&this.backSpace();var r=$t(e);this.pos>=Ht?this.logger.log(Nt.ERROR,(function(){return"Cannot insert "+e.toString(16)+" ("+r+") at position "+t.pos+". Skipping it!"})):(this.chars[this.pos].setChar(r,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<Ht;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,r=0;r<Ht;r++){var a=this.chars[r].uchar;" "!==a&&(t=!1),e.push(a)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),er=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<15;t++)this.rows.push(new Zt(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(Nt.INFO,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(Nt.INFO,(function(){return"pacData = "+JSON.stringify(e)}));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<15;r++)this.rows[r].clear();var a=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var i=n.rows[a].cueStartTime,o=this.logger.time;if(i&&null!==o&&i<o)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(n.rows[a+s])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,c=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[c].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)},t.setBkgData=function(e){this.logger.log(Nt.INFO,(function(){return"bkgData = "+JSON.stringify(e)})),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){var e=this;if(null!==this.nrRollUpRows){this.logger.log(Nt.TEXT,(function(){return e.getDisplayText()}));var t=this.currRow+1-this.nrRollUpRows,r=this.rows.splice(t,1)[0];r.clear(),this.rows.splice(this.currRow,0,r),this.logger.log(Nt.INFO,"Rolling up")}else this.logger.log(Nt.DEBUG,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],r="",a=-1,n=0;n<15;n++){var i=this.rows[n].getTextString();i&&(a=n+1,e?t.push("Row "+a+": '"+i+"'"):t.push(i.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},t.getTextAndFormat=function(){return this.rows},e}(),tr=function(){function e(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new er(r),this.nonDisplayedMemory=new er(r),this.lastOutputScreen=new er(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(Nt.INFO,(function(){return"MODE="+e})),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=this,r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);var a=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(Nt.INFO,(function(){return a+": "+t.writeScreen.getDisplayText(!0)})),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(Nt.TEXT,(function(){return"DISPLAYED: "+t.displayedMemory.getDisplayText(!0)})),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(Nt.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(Nt.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(Nt.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(Nt.INFO,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(Nt.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(Nt.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(Nt.INFO,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(Nt.INFO,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(Nt.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(Nt.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(Nt.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){var e=this;if(this.logger.log(Nt.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(Nt.TEXT,(function(){return"DISP: "+e.displayedMemory.getDisplayText()}))}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(Nt.INFO,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(Nt.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}();function rr(e,t,r){r.a=e,r.b=t}function ar(e,t,r){return r.a===e&&r.b===t}const nr=function(){function e(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var a=new Yt;this.channels=[null,new tr(e,t,a),new tr(e+1,r,a)],this.cmdHistory={a:null,b:null},this.logger=a}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var r,a,n,i=!1;this.logger.time=e;for(var o=0;o<t.length;o+=2)if(a=127&t[o],n=127&t[o+1],0!==a||0!==n){if(this.logger.log(Nt.DATA,"["+Xt([t[o],t[o+1]])+"] -> ("+Xt([a,n])+")"),(r=this.parseCmd(a,n))||(r=this.parseMidrow(a,n)),r||(r=this.parsePAC(a,n)),r||(r=this.parseBackgroundAttributes(a,n)),!r&&(i=this.parseChars(a,n))){var s=this.currentChannel;s&&s>0?this.channels[s].insertChars(i):this.logger.log(Nt.WARNING,"No channel found yet. TEXT-MODE?")}r||i||this.logger.log(Nt.WARNING,"Couldn't parse cleaned data "+Xt([a,n])+" orig: "+Xt([t[o],t[o+1]]))}},t.parseCmd=function(e,t){var r=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(ar(e,t,r))return rr(null,null,r),this.logger.log(Nt.DEBUG,"Repeated command ("+Xt([e,t])+") is dropped"),!0;var a=20===e||21===e||23===e?1:2,n=this.channels[a];return 20===e||21===e||28===e||29===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),rr(e,t,r),this.currentChannel=a,!0},t.parseMidrow=function(e,t){var r=0;if((17===e||25===e)&&t>=32&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(Nt.ERROR,"Mismatch channel in midrow parsing"),!1;var a=this.channels[r];return!!a&&(a.ccMIDROW(t),this.logger.log(Nt.DEBUG,"MIDROW ("+Xt([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var r,a=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(ar(e,t,a))return rr(null,null,a),!0;var n=e<=23?1:2;r=t>=64&&t<=95?1===n?Gt[e]:Wt[e]:1===n?Kt[e]:zt[e];var i=this.channels[n];return!!i&&(i.setPAC(this.interpretPAC(r,t)),rr(e,t,a),this.currentChannel=n,!0)},t.interpretPAC=function(e,t){var r,a={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,a.underline=1==(1&r),r<=13?a.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(a.italics=!0,a.color="white"):a.indent=4*Math.floor((r-16)/2),a},t.parseChars=function(e,t){var r,a,n=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),i>=17&&i<=19?(a=17===i?t+80:18===i?t+112:t+144,this.logger.log(Nt.INFO,"Special char '"+$t(a)+"' in channel "+r),n=[a]):e>=32&&e<=127&&(n=0===t?[e]:[e,t]),n){var o=Xt(n);this.logger.log(Nt.DEBUG,"Char codes =  "+o.join(",")),rr(e,t,this.cmdHistory)}return n},t.parseBackgroundAttributes=function(e,t){var r;if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;var a={};16===e||24===e?(r=Math.floor((t-32)/2),a.background=qt[r],t%2==1&&(a.background=a.background+"_semi")):45===t?a.background="transparent":(a.foreground="black",47===t&&(a.underline=!0));var n=e<=23?1:2;return this.channels[n].setBkgData(a),rr(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}},e}();var ir=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[],this.startTime=null},e}();const or=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;var e=["","lr","rl"],t=["start","middle","end","left","right"];function r(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;var r=t.toLowerCase();return!!~e.indexOf(r)&&r}function a(e){return r(t,e)}function n(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var o in i)e[o]=i[o]}return e}function i(t,i,o){var s=this,l={enumerable:!0};s.hasBeenReset=!1;var u="",c=!1,d=t,p=i,h=o,f=null,g="",y=!0,m="auto",v="start",_=50,k="middle",E=50,T="middle";Object.defineProperty(s,"id",n({},l,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(s,"pauseOnExit",n({},l,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(s,"startTime",n({},l,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",n({},l,{get:function(){return p},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");p=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",n({},l,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",n({},l,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",n({},l,{get:function(){return g},set:function(t){var a=function(t){return r(e,t)}(t);if(!1===a)throw new SyntaxError("An invalid or illegal string was specified.");g=a,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",n({},l,{get:function(){return y},set:function(e){y=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",n({},l,{get:function(){return m},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",n({},l,{get:function(){return v},set:function(e){var t=a(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",n({},l,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",n({},l,{get:function(){return k},set:function(e){var t=a(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");k=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",n({},l,{get:function(){return E},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",n({},l,{get:function(){return T},set:function(e){var t=a(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");T=t,this.hasBeenReset=!0}})),s.displayState=void 0}return i.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},i}();var sr=function(){function e(){}return e.prototype.decode=function(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))},e}();function lr(e){function t(e,t,r,a){return 3600*(0|e)+60*(0|t)+(0|r)+parseFloat(a||0)}var r=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?t(r[2],r[3],0,r[4]):t(r[1],r[2],r[3],r[4]):null}var ur=function(){function e(){this.values=Object.create(null)}var t=e.prototype;return t.set=function(e,t){this.get(e)||""===t||(this.values[e]=t)},t.get=function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},t.has=function(e){return e in this.values},t.alt=function(e,t,r){for(var a=0;a<r.length;++a)if(t===r[a]){this.set(e,t);break}},t.integer=function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},t.percent=function(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1},e}();function cr(e,t,r,a){var n=a?e.split(a):[e];for(var i in n)if("string"==typeof n[i]){var o=n[i].split(r);2===o.length&&t(o[0],o[1])}}var dr=new or(0,0,""),pr="middle"===dr.align?"middle":"center";function hr(e,t,r){var a=e;function n(){var t=lr(e);if(null===t)throw new Error("Malformed timestamp: "+a);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){e=e.replace(/^\s+/,"")}if(i(),t.startTime=n(),i(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+a);e=e.slice(3),i(),t.endTime=n(),i(),function(e,t){var a=new ur;cr(e,(function(e,t){var n;switch(e){case"region":for(var i=r.length-1;i>=0;i--)if(r[i].id===t){a.set(e,r[i].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":n=t.split(","),a.integer(e,n[0]),a.percent(e,n[0])&&a.set("snapToLines",!1),a.alt(e,n[0],["auto"]),2===n.length&&a.alt("lineAlign",n[1],["start",pr,"end"]);break;case"position":n=t.split(","),a.percent(e,n[0]),2===n.length&&a.alt("positionAlign",n[1],["start",pr,"end","line-left","line-right","auto"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start",pr,"end","left","right"])}}),/:/,/\s/),t.region=a.get("region",null),t.vertical=a.get("vertical","");var n=a.get("line","auto");"auto"===n&&-1===dr.line&&(n=-1),t.line=n,t.lineAlign=a.get("lineAlign","start"),t.snapToLines=a.get("snapToLines",!0),t.size=a.get("size",100),t.align=a.get("align",pr);var i=a.get("position","auto");"auto"===i&&50===dr.position&&(i="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=i}(e,t)}function fr(e){return e.replace(/<br(?: \/)?>/gi,"\n")}var gr=function(){function e(){this.state="INITIAL",this.buffer="",this.decoder=new sr,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var t=e.prototype;return t.parse=function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=fr(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var a=e.slice(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.slice(r),a}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var a="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var n=(a=r()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var i=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:a=r(),t.state){case"HEADER":/:/.test(a)?cr(a,(function(e,t){}),/:/):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new or(0,0,""),t.state="CUE",-1===a.indexOf("--\x3e")){t.cue.id=a;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{hr(a,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==a.indexOf("--\x3e");if(!a||o&&(i=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=a;continue;case"BADCUE":a||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},t.flush=function(){var e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this},e}(),yr=r(673),mr=r(524),vr=/\r\n|\n\r|\n|\r/g,_r=function(e,t,r){return void 0===r&&(r=0),e.slice(r,r+t.length)===t},kr=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()};function Er(e,t,r){return kr(e.toString())+kr(t.toString())+kr(r)}function Tr(){return(Tr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var br="stpp.ttml.im1t",Sr=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ar=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Cr={left:"start",center:"center",right:"end",start:"start",end:"end"};function Pr(e,t,r,a,n){var i=(0,A.findBox)(new Uint8Array(e),["mdat"]);if(0!==i.length){var o=i.map((function(e){return(0,Y.utf8ArrayToStr)(e)})),s=(0,yr.toTimescaleFromScale)(t,1,r);try{o.forEach((function(e){return a(function(e,t){var r=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");var a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},n=Object.keys(a).reduce((function(e,t){return e[t]=r.getAttribute("ttp:"+t)||a[t],e}),{}),i="preserve"!==r.getAttribute("xml:space"),o=xr(wr(r,"styling","style")),s=xr(wr(r,"layout","region")),l=wr(r,"body","[begin]");return[].map.call(l,(function(e){var r=function e(t,r){return[].slice.call(t.childNodes).reduce((function(t,a,n){var i;return"br"===a.nodeName&&n?t+"\n":null!==(i=a.childNodes)&&void 0!==i&&i.length?e(a,r):r?t+a.textContent.trim().replace(/\s+/g," "):t+a.textContent}),"")}(e,i);if(!r||!e.hasAttribute("begin"))return null;var a=Dr(e.getAttribute("begin"),n),l=Dr(e.getAttribute("dur"),n),u=Dr(e.getAttribute("end"),n);if(null===a)throw Mr(e);if(null===u){if(null===l)throw Mr(e);u=a+l}var c=new or(a-t,u-t,r);c.id=Er(c.startTime,c.endTime,c.text);var d=function(e,t,r){var a="http://www.w3.org/ns/ttml#styling",n=null,i=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return i&&r.hasOwnProperty(i)&&(n=r[i]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((function(r,i){var o=Ir(t,a,i)||Ir(e,a,i)||Ir(n,a,i);return o&&(r[i]=o),r}),{})}(s[e.getAttribute("region")],o[e.getAttribute("style")],o),p=d.textAlign;if(p){var h=Cr[p];h&&(c.lineAlign=h),c.align=p}return Tr(c,d),c})).filter((function(e){return null!==e}))}(e,s))}))}catch(e){n(e)}}else n(new Error("Could not parse IMSC1 mdat"))}function wr(e,t,r){var a=e.getElementsByTagName(t)[0];return a?[].slice.call(a.querySelectorAll(r)):[]}function xr(e){return e.reduce((function(e,t){var r=t.getAttribute("xml:id");return r&&(e[r]=t),e}),{})}function Ir(e,t,r){return e&&e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null}function Mr(e){return new Error("Could not parse ttml timestamp "+e)}function Dr(e,t){if(!e)return null;var r=lr(e);return null===r&&(Sr.test(e)?r=function(e,t){var r=Sr.exec(e),a=(0|r[4])+(0|r[5])/t.subFrameRate;return 3600*(0|r[1])+60*(0|r[2])+(0|r[3])+a/t.frameRate}(e,t):Ar.test(e)&&(r=function(e,t){var r=Ar.exec(e),a=Number(r[1]);switch(r[2]){case"h":return 3600*a;case"m":return 60*a;case"ms":return 1e3*a;case"f":return a/t.frameRate;case"t":return a/t.tickRate}return a}(e,t))),r}var Rr=function(){function e(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var t=new ir(this,"textTrack1"),r=new ir(this,"textTrack2"),a=new ir(this,"textTrack3"),n=new ir(this,"textTrack4");this.cea608Parser1=new nr(1,t,r),this.cea608Parser2=new nr(3,a,n)}e.on(o.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(o.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(o.Events.FRAG_LOADING,this.onFragLoading,this),e.on(o.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(o.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(o.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(o.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(o.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=e.prototype;return t.destroy=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(o.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(o.Events.FRAG_LOADING,this.onFragLoading,this),e.off(o.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(o.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(o.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(o.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(o.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},t.addCues=function(e,t,r,a,n){for(var i,s,l,u,c=!1,d=n.length;d--;){var p=n[d],h=(i=p[0],s=p[1],l=t,u=r,Math.min(s,u)-Math.max(i,l));if(h>=0&&(p[0]=Math.min(p[0],t),p[1]=Math.max(p[1],r),c=!0,h/(r-t)>.5))return}if(c||n.push([t,r]),this.config.renderTextTracksNatively){var f=this.captionsTracks[e];this.Cues.newCue(f,t,r,a)}else{var g=this.Cues.newCue(null,t,r,a);this.hls.trigger(o.Events.CUES_PARSED,{type:"captions",cues:g,track:e})}},t.onInitPtsFound=function(e,t){var r=this,a=t.frag,n=t.id,i=t.initPTS,s=t.timescale,l=this.unparsedVttFrags;"main"===n&&(this.initPTS[a.cc]=i,this.timescale[a.cc]=s),l.length&&(this.unparsedVttFrags=[],l.forEach((function(e){r.onFragLoaded(o.Events.FRAG_LOADED,e)})))},t.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var a=t.textTracks[r];if(a[e])return a}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,a=this.media,n=t[e],i=n.label,o=n.languageCode,s=this.getExistingTrack(e);if(s)r[e]=s,z(r[e]),K(r[e],a);else{var l=this.createTextTrack("captions",i,o);l&&(l[e]=!0,r[e]=l)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(o.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},t.createTextTrack=function(e,t,r){var a=this.media;if(a)return a.addTextTrack(e,t,r)},t.onMediaAttaching=function(e,t){this.media=t.media,this._cleanTracks()},t.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){z(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)z(t[r])}},t.onSubtitleTracksUpdated=function(e,t){var r=this;this.textTracks=[];var a=t.subtitleTracks||[],n=a.some((function(e){return e.textCodec===br}));if(this.config.enableWebVTT||n&&this.config.enableIMSC1){var i=this.tracks&&a&&this.tracks.length===a.length;if(this.tracks=a||[],this.config.renderTextTracksNatively){var s=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,t){var a;if(t<s.length){for(var n=null,i=0;i<s.length;i++)if(Or(s[i],e)){n=s[i];break}n&&(a=n)}if(a)z(a);else{var o=r._captionsOrSubtitlesFromCharacteristics(e);(a=r.createTextTrack(o,e.name,e.lang))&&(a.mode="disabled")}a&&(a.groupId=e.groupId,r.textTracks.push(a))}))}else if(!i&&this.tracks&&this.tracks.length){var l=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(o.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}},t._captionsOrSubtitlesFromCharacteristics=function(e){var t;if(null!==(t=e.attrs)&&void 0!==t&&t.CHARACTERISTICS){var r=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),a=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(r&&a)return"captions"}return"subtitles"},t.onManifestLoaded=function(e,t){var r=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var a="textTrack"+t[1],n=r.captionsProperties[a];n&&(n.label=e.name,e.lang&&(n.languageCode=e.lang),n.media=e)}}))},t.closedCaptionsForLevel=function(e){var t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]},t.onFragLoading=function(e,t){var r=this.cea608Parser1,a=this.cea608Parser2,n=this.lastSn,i=this.lastPartIndex;if(this.enabled&&r&&a&&t.frag.type===$.PlaylistLevelType.MAIN){var o,s,l=t.frag.sn,u=null!=(o=null==t||null===(s=t.part)||void 0===s?void 0:s.index)?o:-1;l===n+1||l===n&&u===i+1||(r.reset(),a.reset()),this.lastSn=l,this.lastPartIndex=u}},t.onFragLoaded=function(e,t){var r=t.frag,a=t.payload,n=this.initPTS,s=this.unparsedVttFrags;if(r.type===$.PlaylistLevelType.SUBTITLE)if(a.byteLength){if(!(0,i.isFiniteNumber)(n[r.cc]))return s.push(t),void(n.length&&this.hls.trigger(o.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Missing initial subtitle PTS")}));var l=r.decryptdata,u="stats"in t;if(null==l||!l.encrypted||u){var c=this.tracks[r.level],d=this.vttCCs;d[r.cc]||(d[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),c&&c.textCodec===br?this._parseIMSC1(r,a):this._parseVTTs(r,a,d)}}else this.hls.trigger(o.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(e,t){var r=this,a=this.hls;Pr(t,this.initPTS[e.cc],this.timescale[e.cc],(function(t){r._appendCues(t,e.level),a.trigger(o.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){l.logger.log("Failed to parse IMSC1: "+t),a.trigger(o.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))},t._parseVTTs=function(e,t,r){var a,n=this,s=this.hls;!function(e,t,r,a,n,o,s,l){var u,c=new gr,d=(0,Y.utf8ArrayToStr)(new Uint8Array(e)).trim().replace(vr,"\n").split("\n"),p=[],h=(0,yr.toMpegTsClockFromTimescale)(t,r),f="00:00.000",g=0,y=0,m=!0;c.oncue=function(e){var t=a[n],r=a.ccOffset,i=(g-h)/9e4;null!=t&&t.new&&(void 0!==y?r=a.ccOffset=t.start:function(e,t,r){var a=e[t],n=e[a.prevCC];if(!n||!n.new&&a.new)return e.ccOffset=e.presentationOffset=a.start,void(a.new=!1);for(;null!==(i=n)&&void 0!==i&&i.new;){var i;e.ccOffset+=a.start-n.start,a.new=!1,n=e[(a=n).prevCC]}e.presentationOffset=r}(a,n,i)),i&&(r=i-a.presentationOffset);var s=e.endTime-e.startTime,l=(0,mr.normalizePts)(9e4*(e.startTime+r-y),9e4*o)/9e4;e.startTime=Math.max(l,0),e.endTime=Math.max(l+s,0);var u=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(u)),e.id||(e.id=Er(e.startTime,e.endTime,u)),e.endTime>0&&p.push(e)},c.onparsingerror=function(e){u=e},c.onflush=function(){u?l(u):s(p)},d.forEach((function(e){if(m){if(_r(e,"X-TIMESTAMP-MAP=")){m=!1,e.slice(16).split(",").forEach((function(e){_r(e,"LOCAL:")?f=e.slice(6):_r(e,"MPEGTS:")&&(g=parseInt(e.slice(7)))}));try{y=function(e){var t=parseInt(e.slice(-3)),r=parseInt(e.slice(-6,-4)),a=parseInt(e.slice(-9,-7)),n=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!((0,i.isFiniteNumber)(t)&&(0,i.isFiniteNumber)(r)&&(0,i.isFiniteNumber)(a)&&(0,i.isFiniteNumber)(n)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*r,(t+=6e4*a)+36e5*n}(f)/1e3}catch(e){u=e}return}""===e&&(m=!1)}c.parse(e+"\n")})),c.flush()}(null!==(a=e.initSegment)&&void 0!==a&&a.data?(0,A.appendUint8Array)(e.initSegment.data,new Uint8Array(t)):t,this.initPTS[e.cc],this.timescale[e.cc],r,e.cc,e.start,(function(t){n._appendCues(t,e.level),s.trigger(o.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(r){n._fallbackToIMSC1(e,t),l.logger.log("Failed to parse VTT cue: "+r),s.trigger(o.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})}))},t._fallbackToIMSC1=function(e,t){var r=this,a=this.tracks[e.level];a.textCodec||Pr(t,this.initPTS[e.cc],this.timescale[e.cc],(function(){a.textCodec=br,r._parseIMSC1(e,t)}),(function(){a.textCodec="wvtt"}))},t._appendCues=function(e,t){var r=this.hls;if(this.config.renderTextTracksNatively){var a=this.textTracks[t];if(!a||"disabled"===a.mode)return;e.forEach((function(e){return W(a,e)}))}else{var n=this.tracks[t];if(!n)return;var i=n.default?"default":"subtitles"+t;r.trigger(o.Events.CUES_PARSED,{type:"subtitles",cues:e,track:i})}},t.onFragDecrypted=function(e,t){var r=t.frag;if(r.type===$.PlaylistLevelType.SUBTITLE){if(!(0,i.isFiniteNumber)(this.initPTS[r.cc]))return void this.unparsedVttFrags.push(t);this.onFragLoaded(o.Events.FRAG_LOADED,t)}},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,t){var r=this.cea608Parser1,a=this.cea608Parser2;if(this.enabled&&r&&a){var n=t.frag,i=t.samples;if(n.type!==$.PlaylistLevelType.MAIN||"NONE"!==this.closedCaptionsForLevel(n))for(var o=0;o<i.length;o++){var s=i[o].bytes;if(s){var l=this.extractCea608Data(s);r.addData(i[o].pts,l[0]),a.addData(i[o].pts,l[1])}}}},t.onBufferFlushing=function(e,t){var r=t.startOffset,a=t.endOffset,n=t.endOffsetSubtitles,i=t.type,o=this.media;if(o&&!(o.currentTime<a)){if(!i||"video"===i){var s=this.captionsTracks;Object.keys(s).forEach((function(e){return q(s[e],r,a)}))}if(this.config.renderTextTracksNatively&&0===r&&void 0!==n){var l=this.textTracks;Object.keys(l).forEach((function(e){return q(l[e],r,n)}))}}},t.extractCea608Data=function(e){for(var t=[[],[]],r=31&e[0],a=2,n=0;n<r;n++){var i=e[a++],o=127&e[a++],s=127&e[a++];if((0!==o||0!==s)&&0!=(4&i)){var l=3&i;0!==l&&1!==l||(t[l].push(o),t[l].push(s))}}return t},e}();function Or(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}const Lr=function(){function e(e){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var t,r,a=e.prototype;return a.setStreamController=function(e){this.streamController=e},a.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},a.registerListeners=function(){var e=this.hls;e.on(o.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(o.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},a.unregisterListener=function(){var e=this.hls;e.off(o.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(o.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},a.onFpsDropLevelCapping=function(t,r){e.isLevelAllowed(r.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(r.droppedLevel)},a.onMediaAttaching=function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null},a.onManifestParsed=function(e,t){var r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()},a.onBufferCodecs=function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},a.onMediaDetaching=function(){this.stopCapping()},a.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var e=this.hls.levels;if(e.length){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},a.getMaxLevel=function(t){var r=this,a=this.hls.levels;if(!a.length)return-1;var n=a.filter((function(a,n){return e.isLevelAllowed(n,r.restrictedLevels)&&n<=t}));return this.clientRect=null,e.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)},a.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},a.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},a.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t},e.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},e.getMaxLevelByMediaSize=function(e,t,r){if(!e||!e.length)return-1;for(var a,n,i=e.length-1,o=0;o<e.length;o+=1){var s=e[o];if((s.width>=t||s.height>=r)&&(a=s,!(n=e[o+1])||a.width!==n.width||a.height!==n.height)){i=o;break}}return i},t=e,(r=[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}}])&&function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Nr=function(){function e(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.registerListeners=function(){this.hls.on(o.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},t.unregisterListeners=function(){this.hls.off(o.Events.MEDIA_ATTACHING,this.onMediaAttaching)},t.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},t.onMediaAttaching=function(e,t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var a=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=a,a&&"function"==typeof a.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}},t.checkFPS=function(e,t,r){var a=performance.now();if(t){if(this.lastTime){var n=a-this.lastTime,i=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,u=1e3*i/n,c=this.hls;if(c.trigger(o.Events.FPS_DROP,{currentDropped:i,currentDecoded:s,totalDroppedFrames:r}),u>0&&i>c.config.fpsDroppedMonitoringThreshold*s){var d=c.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=d)&&(d-=1,c.trigger(o.Events.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:c.currentLevel}),c.autoLevelCapping=d,this.streamController.nextLevelSwitch())}}this.lastTime=a,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},t.checkFPSInterval=function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},e}();var Ur=r(300);function Fr(e){var t="function"==typeof Map?new Map:void 0;return(Fr=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return Br(e,arguments,$r(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),Vr(a,e)})(e)}function Br(e,t,r){return(Br=jr()?Reflect.construct.bind():function(e,t,r){var a=[null];a.push.apply(a,t);var n=new(Function.bind.apply(e,a));return r&&Vr(n,r.prototype),n}).apply(null,arguments)}function jr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Vr(e,t){return(Vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function $r(e){return($r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hr="[eme]",Gr=function(){function e(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=e.CDMCleanupPromise?[e.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=l.logger.debug.bind(l.logger,Hr),this.log=l.logger.log.bind(l.logger,Hr),this.warn=l.logger.warn.bind(l.logger,Hr),this.error=l.logger.error.bind(l.logger,Hr),this.hls=t,this.config=t.config,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null},t.registerListeners=function(){this.hls.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(o.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(o.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},t.unregisterListeners=function(){this.hls.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(o.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(o.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},t.getLicenseServerUrl=function(e){var t=this.config,r=t.drmSystems,a=t.widevineLicenseUrl,n=r[e];if(n)return n.licenseUrl;if(e===h.WIDEVINE&&a)return a;throw new Error('no license server URL configured for key-system "'+e+'"')},t.getServerCertificateUrl=function(e){var t=this.config.drmSystems[e];if(t)return t.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+e+'"]')},t.attemptKeySystemAccess=function(e){var t=this,r=this.hls.levels,a=function(e,t,r){return!!e&&r.indexOf(e)===t},n=r.map((function(e){return e.audioCodec})).filter(a),i=r.map((function(e){return e.videoCodec})).filter(a);return n.length+i.length===0&&i.push("avc1.42e01e"),new Promise((function(r,a){!function e(o){var l=o.shift();t.getMediaKeysPromise(l,n,i).then((function(e){return r({keySystem:l,mediaKeys:e})})).catch((function(t){o.length?e(o):a(t instanceof Kr?t:new Kr({type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))}(e)}))},t.requestMediaKeySystemAccess=function(e,t){var r=this.config.requestMediaKeySystemAccessFunc;if("function"!=typeof r){var a="Configured requestMediaKeySystemAccess is not a function "+r;return null===S&&"http:"===self.location.protocol&&(a="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(a))}return r(e,t)},t.getMediaKeysPromise=function(e,t,r){var a=this,n=function(e,t,r,a){var n;switch(e){case h.FAIRPLAY:n=["cenc","sinf"];break;case h.WIDEVINE:case h.PLAYREADY:n=["cenc"];break;case h.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+e)}return function(e,t,r,a){return[{initDataTypes:e,persistentState:a.persistentState||"not-allowed",distinctiveIdentifier:a.distinctiveIdentifier||"not-allowed",sessionTypes:a.sessionTypes||[a.sessionType||"temporary"],audioCapabilities:t.map((function(e){return{contentType:'audio/mp4; codecs="'+e+'"',robustness:a.audioRobustness||"",encryptionScheme:a.audioEncryptionScheme||null}})),videoCapabilities:r.map((function(e){return{contentType:'video/mp4; codecs="'+e+'"',robustness:a.videoRobustness||"",encryptionScheme:a.videoEncryptionScheme||null}}))}]}(n,t,r,a)}(e,t,r,this.config.drmSystemOptions),i=this.keySystemAccessPromises[e],o=null==i?void 0:i.keySystemAccess;if(!o){this.log('Requesting encrypted media "'+e+'" key-system access with config: '+JSON.stringify(n)),o=this.requestMediaKeySystemAccess(e,n);var s=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch((function(t){a.log('Failed to obtain access to key-system "'+e+'": '+t)})),o.then((function(t){a.log('Access for key-system "'+t.keySystem+'" obtained');var r=a.fetchServerCertificate(e);return a.log('Create media-keys for "'+e+'"'),s.mediaKeys=t.createMediaKeys().then((function(t){return a.log('Media-keys created for "'+e+'"'),r.then((function(r){return r?a.setMediaKeysServerCertificate(t,e,r):t}))})),s.mediaKeys.catch((function(t){a.error('Failed to create media-keys for "'+e+'"}: '+t)})),s.mediaKeys}))}return o.then((function(){return i.mediaKeys}))},t.createMediaKeySessionContext=function(e){var t=e.decryptdata,r=e.keySystem,a=e.mediaKeys;this.log('Creating key-system session "'+r+'" keyId: '+Ur.default.hexDump(t.keyId||[]));var n=a.createSession(),i={decryptdata:t,keySystem:r,mediaKeys:a,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i},t.renewKeySession=function(e){var t=e.decryptdata;if(t.pssh){var r=this.createMediaKeySessionContext(e),a=this.getKeyIdString(t);this.keyIdToKeySessionPromise[a]=this.generateRequestWithPreferredKeySession(r,"cenc",t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)},t.getKeyIdString=function(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return Ur.default.hexDump(e.keyId)},t.updateKeySession=function(e,t){var r,a=e.mediaKeysSession;return this.log('Updating key-session "'+a.sessionId+'" for keyID '+Ur.default.hexDump((null===(r=e.decryptdata)||void 0===r?void 0:r.keyId)||[])+"\n      } (data length: "+(t?t.byteLength:t)+")"),a.update(t)},t.selectKeySystemFormat=function(e){var t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+e.sn+" "+e.type+": "+e.level+") key formats "+t.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise},t.getKeyFormatPromise=function(e){var t=this;return new Promise((function(r,a){var n=b(t.config),i=e.map(E).filter((function(e){return!!e&&-1!==n.indexOf(e)}));return t.getKeySystemSelectionPromise(i).then((function(e){var t=e.keySystem,n=T(t);n?r(n):a(new Error('Unable to find format for key-system "'+t+'"'))})).catch(a)}))},t.loadKey=function(e){var t=this,r=e.keyInfo.decryptdata,a=this.getKeyIdString(r),n="(keyId: "+a+' format: "'+r.keyFormat+'" method: '+r.method+" uri: "+r.uri+")";this.log("Starting session for key "+n);var i=this.keyIdToKeySessionPromise[a];return i||(i=this.keyIdToKeySessionPromise[a]=this.getKeySystemForKeyPromise(r).then((function(a){var i=a.keySystem,o=a.mediaKeys;return t.throwIfDestroyed(),t.log("Handle encrypted media sn: "+e.frag.sn+" "+e.frag.type+": "+e.frag.level+" using key "+n),t.attemptSetMediaKeys(i,o).then((function(){t.throwIfDestroyed();var e=t.createMediaKeySessionContext({keySystem:i,mediaKeys:o,decryptdata:r});return t.generateRequestWithPreferredKeySession(e,"cenc",r.pssh,"playlist-key")}))}))).catch((function(e){return t.handleError(e)})),i},t.throwIfDestroyed=function(e){if(void 0===e&&(e="Invalid state"),!this.hls)throw new Error("invalid state")},t.handleError=function(e){this.hls&&(this.error(e.message),e instanceof Kr?this.hls.trigger(o.Events.ERROR,e.data):this.hls.trigger(o.Events.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))},t.getKeySystemForKeyPromise=function(e){var t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){var a=E(e.keyFormat),n=a?[a]:b(this.config);return this.attemptKeySystemAccess(n)}return r},t.getKeySystemSelectionPromise=function(e){if(e.length||(e=b(this.config)),0===e.length)throw new Kr({type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(e)},t._onMediaEncrypted=function(e){var t=this,r=e.initDataType,a=e.initData;if(this.debug('"'+e.type+'" event: init data type: "'+r+'"'),null!==a){var n,i;if("sinf"===r&&this.config.drmSystems[h.FAIRPLAY]){var o=(0,A.bin2str)(new Uint8Array(a));try{var s=_(JSON.parse(o).sinf),l=(0,A.parseSinf)(new Uint8Array(s));if(!l)return;n=l.subarray(8,24),i=h.FAIRPLAY}catch(e){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{var u=(0,A.parsePssh)(a);if(null===u)return;0===u.version&&u.systemId===g.WIDEVINE&&u.data&&(n=u.data.subarray(8,24)),i=function(e){if(e===g.WIDEVINE)return h.WIDEVINE}(u.systemId)}if(i&&n){for(var c=Ur.default.hexDump(n),d=this.keyIdToKeySessionPromise,p=this.mediaKeySessions,f=d[c],y=function(e){var i=p[e],o=i.decryptdata;if(o.pssh||!o.keyId)return"continue";var s=Ur.default.hexDump(o.keyId);return c===s||-1!==o.uri.replace(/-/g,"").indexOf(c)?(f=d[s],delete d[s],o.pssh=new Uint8Array(a),o.keyId=n,f=d[c]=f.then((function(){return t.generateRequestWithPreferredKeySession(i,r,a,"encrypted-event-key-match")})),"break"):void 0},m=0;m<p.length;m++){var v=y(m);if("continue"!==v&&"break"===v)break}f||(f=d[c]=this.getKeySystemSelectionPromise([i]).then((function(e){var i,o=e.keySystem,s=e.mediaKeys;t.throwIfDestroyed();var l=new P("ISO-23001-7",c,null!=(i=T(o))?i:"");return l.pssh=new Uint8Array(a),l.keyId=n,t.attemptSetMediaKeys(o,s).then((function(){t.throwIfDestroyed();var e=t.createMediaKeySessionContext({decryptdata:l,keySystem:o,mediaKeys:s});return t.generateRequestWithPreferredKeySession(e,r,a,"encrypted-event-no-match")}))}))),f.catch((function(e){return t.handleError(e)}))}}},t._onWaitingForKey=function(e){this.log('"'+e.type+'" event')},t.attemptSetMediaKeys=function(e,t){var r=this,a=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+e+'"');var n=Promise.all(a).then((function(){if(!r.media)throw new Error("Attempted to set mediaKeys without media element attached");return r.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(n),n.then((function(){r.log('Media-keys set for "'+e+'"'),a.push(n),r.setMediaKeysQueue=r.setMediaKeysQueue.filter((function(e){return-1===a.indexOf(e)}))}))},t.generateRequestWithPreferredKeySession=function(e,t,r,a){var n,i,o=this,l=null===(n=this.config.drmSystems)||void 0===n||null===(i=n[e.keySystem])||void 0===i?void 0:i.generateRequest;if(l)try{var u=l.call(this.hls,t,r,e);if(!u)throw new Error("Invalid response from configured generateRequest filter");t=u.initDataType,r=e.decryptdata.pssh=u.initData?new Uint8Array(u.initData):null}catch(e){var c;if(this.warn(e.message),null!==(c=this.hls)&&void 0!==c&&c.config.debug)throw e}if(null===r)return this.log('Skipping key-session request for "'+a+'" (no initData)'),Promise.resolve(e);var d=this.getKeyIdString(e.decryptdata);this.log('Generating key-session request for "'+a+'": '+d+" (init data type: "+t+" length: "+(r?r.byteLength:null)+")");var p=new(gt());e.mediaKeysSession.onmessage=function(t){var r=e.mediaKeysSession;if(r){var a=t.messageType,n=t.message;o.log('"'+a+'" message event for session "'+r.sessionId+'" message size: '+n.byteLength),"license-request"===a||"license-renewal"===a?o.renewLicense(e,n).catch((function(e){o.handleError(e),p.emit("error",e)})):"license-release"===a?e.keySystem===h.FAIRPLAY&&(o.updateKeySession(e,k("acknowledged")),o.removeSession(e)):o.warn('unhandled media key message type "'+a+'"')}else p.emit("error",new Error("invalid state"))},e.mediaKeysSession.onkeystatuseschange=function(t){if(e.mediaKeysSession){o.onKeyStatusChange(e);var r=e.keyStatus;p.emit("keyStatus",r),"expired"===r&&(o.warn(e.keySystem+" expired for key "+d),o.renewKeySession(e))}else p.emit("error",new Error("invalid state"))};var f=new Promise((function(e,t){p.on("error",t),p.on("keyStatus",(function(r){r.startsWith("usable")?e():"output-restricted"===r?t(new Kr({type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===r?t(new Kr({type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+r+'"')):"expired"===r?t(new Error("key expired while generating request")):o.warn('unhandled key status change "'+r+'"')}))}));return e.mediaKeysSession.generateRequest(t,r).then((function(){var t;o.log('Request generated for key-session "'+(null===(t=e.mediaKeysSession)||void 0===t?void 0:t.sessionId)+'" keyId: '+d)})).catch((function(e){throw new Kr({type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},"Error generating key-session request: "+e)})).then((function(){return f})).catch((function(t){throw p.removeAllListeners(),o.removeSession(e),t})).then((function(){return p.removeAllListeners(),e}))},t.onKeyStatusChange=function(e){var t=this;e.mediaKeysSession.keyStatuses.forEach((function(r,a){t.log('key status change "'+r+'" for keyStatuses keyId: '+Ur.default.hexDump("buffer"in a?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):new Uint8Array(a))+" session keyId: "+Ur.default.hexDump(new Uint8Array(e.decryptdata.keyId||[]))+" uri: "+e.decryptdata.uri),e.keyStatus=r}))},t.fetchServerCertificate=function(e){var t=this;return new Promise((function(r,a){var n=t.getServerCertificateUrl(e);if(!n)return r();t.log('Fetching serverCertificate for "'+e+'"');var i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType="arraybuffer",i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&(200===i.status?r(i.response):a(new Kr({type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i},'"'+e+'" certificate request XHR failed ('+n+"). Status: "+i.status+" ("+i.statusText+")")))},i.send()}))},t.setMediaKeysServerCertificate=function(e,t,r){var a=this;return new Promise((function(n,i){e.setServerCertificate(r).then((function(i){a.log("setServerCertificate "+(i?"success":"not supported by CDM")+" ("+(null==r?void 0:r.byteLength)+') on "'+t+'"'),n(e)})).catch((function(e){i(new Kr({type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))},t.renewLicense=function(e,t){var r=this;return this.requestLicense(e,new Uint8Array(t)).then((function(t){return r.updateKeySession(e,new Uint8Array(t)).catch((function(e){throw new Kr({type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))}))},t.setupLicenseXHR=function(e,t,r,a){var n=this,i=this.config.licenseXhrSetup;return i?Promise.resolve().then((function(){if(!r.decryptdata)throw new Error("Key removed");return i.call(n.hls,e,t,r,a)})).catch((function(o){if(!r.decryptdata)throw o;return e.open("POST",t,!0),i.call(n.hls,e,t,r,a)})).then((function(r){return e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:r||a}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:a}))},t.requestLicense=function(e,t){var r=this;return new Promise((function(a,n){var i=r.getLicenseServerUrl(e.keySystem);r.log("Sending license request to URL: "+i);var o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=function(){if(!r.hls||!e.mediaKeysSession)return n(new Error("invalid state"));if(4===o.readyState)if(200===o.status){r._requestLicenseFailureCount=0;var l=o.response;r.log("License received "+(l instanceof ArrayBuffer?l.byteLength:l));var u=r.config.licenseResponseCallback;if(u)try{l=u.call(r.hls,o,i,e)}catch(e){r.error(e)}a(l)}else if(r._requestLicenseFailureCount++,r._requestLicenseFailureCount>3||o.status>=400&&o.status<500)n(new Kr({type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o},"License Request XHR failed ("+i+"). Status: "+o.status+" ("+o.statusText+")"));else{var c=3-r._requestLicenseFailureCount+1;r.warn("Retrying license request, "+c+" attempts left"),r.requestLicense(e,t).then(a,n)}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,r.setupLicenseXHR(o,i,e,t).then((function(e){var t=e.xhr,r=e.licenseChallenge;t.send(r)}))}))},t.onMediaAttached=function(e,t){if(this.config.emeEnabled){var r=t.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}},t.onMediaDetached=function(){var t=this,r=this.media,a=this.mediaKeySessions;r&&(r.removeEventListener("encrypted",this.onMediaEncrypted),r.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},P.clearKeyUriToKeyIdMap();var n=a.length;e.CDMCleanupPromise=Promise.all(a.map((function(e){return t.removeSession(e)})).concat(null==r?void 0:r.setMediaKeys(null).catch((function(e){t.log("Could not clear media keys: "+e+". media.src: "+(null==r?void 0:r.src))})))).then((function(){n&&(t.log("finished closing key sessions and clearing media keys"),a.length=0)})).catch((function(e){t.log("Could not close sessions and clear media keys: "+e+". media.src: "+(null==r?void 0:r.src))}))},t.onManifestLoaded=function(e,t){var r=t.sessionKeys;if(r&&this.config.emeEnabled&&!this.keyFormatPromise){var a=r.reduce((function(e,t){return-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e}),[]);this.log("Selecting key-system from session-keys "+a.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(a)}},t.removeSession=function(e){var t=this,r=e.mediaKeysSession,a=e.licenseXhr;if(r){this.log("Remove licenses and keys and close session "+r.sessionId),r.onmessage=null,r.onkeystatuseschange=null,a&&a.readyState!==XMLHttpRequest.DONE&&a.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;var n=this.mediaKeySessions.indexOf(e);return n>-1&&this.mediaKeySessions.splice(n,1),r.remove().catch((function(e){t.log("Could not remove session: "+e)})).then((function(){return r.close()})).catch((function(e){t.log("Could not close session: "+e)}))}},e}();Gr.CDMCleanupPromise=void 0;var Kr=function(e){var t,r;function a(t,r){var a;return(a=e.call(this,r)||this).data=void 0,a.data=t,t.err=t.error,a}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Vr(t,r),a}(Fr(Error));const Wr=Gr;var zr,qr,Yr;function Xr(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}function Qr(e,t,r){return t&&Xr(e.prototype,t),r&&Xr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Zr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ea(){return(ea=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}!function(e){e.MANIFEST="m",e.AUDIO="a",e.VIDEO="v",e.MUXED="av",e.INIT="i",e.CAPTION="c",e.TIMED_TEXT="tt",e.KEY="k",e.OTHER="o"}(zr||(zr={})),function(e){e.DASH="d",e.HLS="h",e.SMOOTH="s",e.OTHER="o"}(qr||(qr={})),function(e){e.VOD="v",e.LIVE="l"}(Yr||(Yr={}));var ta=function(){function e(t){var r=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){r.initialized&&(r.starved=!0),r.buffering=!0},this.onPlaying=function(){r.initialized||(r.initialized=!0),r.buffering=!1},this.applyPlaylistData=function(e){try{r.apply(e,{ot:zr.MANIFEST,su:!r.initialized})}catch(e){l.logger.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=function(e){try{var t=e.frag,a=r.hls.levels[t.level],n=r.getObjectType(t),i={d:1e3*t.duration,ot:n};n!==zr.VIDEO&&n!==zr.AUDIO&&n!=zr.MUXED||(i.br=a.bitrate/1e3,i.tb=r.getTopBandwidth(n)/1e3,i.bl=r.getBufferLength(n)),r.apply(e,i)}catch(e){l.logger.warn("Could not generate segment CMCD data.",e)}},this.hls=t;var a=this.config=t.config,n=a.cmcd;null!=n&&(a.pLoader=this.createPlaylistLoader(),a.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.uuid(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.registerListeners())}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.Events.MEDIA_DETACHED,this.onMediaDetached,this),e.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this)},t.unregisterListeners=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.Events.MEDIA_DETACHED,this.onMediaDetached,this),e.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},t.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},t.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},t.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},t.onBufferCreated=function(e,t){var r,a;this.audioBuffer=null===(r=t.tracks.audio)||void 0===r?void 0:r.buffer,this.videoBuffer=null===(a=t.tracks.video)||void 0===a?void 0:a.buffer},t.createData=function(){var e;return{v:1,sf:qr.HLS,sid:this.sid,cid:this.cid,pr:null===(e=this.media)||void 0===e?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},t.apply=function(t,r){void 0===r&&(r={}),ea(r,this.createData());var a=r.ot===zr.INIT||r.ot===zr.VIDEO||r.ot===zr.MUXED;if(this.starved&&a&&(r.bs=!0,r.su=!0,this.starved=!1),null==r.su&&(r.su=this.buffering),this.useHeaders){var n=e.toHeaders(r);if(!Object.keys(n).length)return;t.headers||(t.headers={}),ea(t.headers,n)}else{var i=e.toQuery(r);if(!i)return;t.url=e.appendQueryToUri(t.url,i)}},t.getObjectType=function(e){var t=e.type;return"subtitle"===t?zr.TIMED_TEXT:"initSegment"===e.sn?zr.INIT:"audio"===t?zr.AUDIO:"main"===t?this.hls.audioTracks.length?zr.VIDEO:zr.MUXED:void 0},t.getTopBandwidth=function(e){var t,r=0,a=this.hls;if(e===zr.AUDIO)t=a.audioTracks;else{var n=a.maxAutoLevel,i=n>-1?n+1:a.levels.length;t=a.levels.slice(0,i)}for(var o,s=Jr(t);!(o=s()).done;){var l=o.value;l.bitrate>r&&(r=l.bitrate)}return r>0?r:NaN},t.getBufferLength=function(e){var t=this.hls.media,r=e===zr.AUDIO?this.audioBuffer:this.videoBuffer;return r&&t?1e3*Oe.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len:NaN},t.createPlaylistLoader=function(){var e=this.config.pLoader,t=this.applyPlaylistData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e)}var a=e.prototype;return a.destroy=function(){this.loader.destroy()},a.abort=function(){this.loader.abort()},a.load=function(e,r,a){t(e),this.loader.load(e,r,a)},Qr(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()},t.createFragmentLoader=function(){var e=this.config.fLoader,t=this.applyFragmentData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e)}var a=e.prototype;return a.destroy=function(){this.loader.destroy()},a.abort=function(){this.loader.abort()},a.load=function(e,r,a){t(e),this.loader.load(e,r,a)},Qr(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()},e.uuid=function(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)},e.serialize=function(e){for(var t,r=[],a=function(e){return!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e},n=function(e){return Math.round(e)},i=function(e){return 100*n(e/100)},o={br:n,d:n,bl:i,dl:i,mtp:i,nor:function(e){return encodeURIComponent(e)},rtp:i,tb:n},s=Jr(Object.keys(e||{}).sort());!(t=s()).done;){var l=t.value,u=e[l];if(a(u)&&!("v"===l&&1===u||"pr"==l&&1===u)){var c=o[l];c&&(u=c(u));var d,p=typeof u;d="ot"===l||"sf"===l||"st"===l?l+"="+u:"boolean"===p?l:"number"===p?l+"="+u:l+"="+JSON.stringify(u),r.push(d)}}return r.join(",")},e.toHeaders=function(t){for(var r={},a=["Object","Request","Session","Status"],n=[{},{},{},{}],i={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},o=0,s=Object.keys(t);o<s.length;o++){var l=s[o];n[null!=i[l]?i[l]:1][l]=t[l]}for(var u=0;u<n.length;u++){var c=e.serialize(n[u]);c&&(r["CMCD-"+a[u]]=c)}return r},e.toQuery=function(t){return"CMCD="+encodeURIComponent(e.serialize(t))},e.appendQueryToUri=function(e,t){if(!t)return e;var r=e.includes("?")?"&":"?";return""+e+r+t},e}(),ra=r(408),aa=/^age:\s*[\d.]+\s*$/m;const na=function(){function e(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e?e.xhrSetup:null,this.stats=new ra.LoadStats,this.retryDelay=0}var t=e.prototype;return t.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},t.abortInternal=function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))},t.abort=function(){var e;this.abortInternal(),null!==(e=this.callbacks)&&void 0!==e&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},t.load=function(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e=this.config,t=this.context;if(e){var r=this.loader=new self.XMLHttpRequest,a=this.stats;a.loading.first=0,a.loaded=0;var n=this.xhrSetup;try{if(n)try{n(r,t.url)}catch(e){r.open("GET",t.url,!0),n(r,t.url)}r.readyState||r.open("GET",t.url,!0);var i=this.context.headers;if(i)for(var o in i)r.setRequestHeader(o,i[o])}catch(e){return void this.callbacks.onError({code:r.status,text:e.message},t,r)}t.rangeEnd&&r.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),r.onreadystatechange=this.readystatechange.bind(this),r.onprogress=this.loadprogress.bind(this),r.responseType=t.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),e.timeout),r.send()}},t.readystatechange=function(){var e=this.context,t=this.loader,r=this.stats;if(e&&t){var a=t.readyState,n=this.config;if(!r.aborted&&a>=2)if(self.clearTimeout(this.requestTimeout),0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start)),4===a){t.onreadystatechange=null,t.onprogress=null;var i=t.status,o="arraybuffer"===t.responseType;if(i>=200&&i<300&&(o&&t.response||null!==t.responseText)){var s,u;if(r.loading.end=Math.max(self.performance.now(),r.loading.first),u=o?(s=t.response).byteLength:(s=t.responseText).length,r.loaded=r.total=u,!this.callbacks)return;var c=this.callbacks.onProgress;if(c&&c(r,e,s,t),!this.callbacks)return;var d={url:t.responseURL,data:s};this.callbacks.onSuccess(d,r,e,t)}else r.retry>=n.maxRetry||i>=400&&i<499?(l.logger.error(i+" while loading "+e.url),this.callbacks.onError({code:i,text:t.statusText},e,t)):(l.logger.warn(i+" while loading "+e.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,n.maxRetryDelay),r.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout)}},t.loadtimeout=function(){l.logger.warn("timeout while loading "+this.context.url);var e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))},t.loadprogress=function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)},t.getCacheAge=function(){var e=null;if(this.loader&&aa.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e},e}();function ia(e){var t="function"==typeof Map?new Map:void 0;return(ia=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return oa(e,arguments,ua(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),la(a,e)})(e)}function oa(e,t,r){return(oa=sa()?Reflect.construct.bind():function(e,t,r){var a=[null];a.push.apply(a,t);var n=new(Function.bind.apply(e,a));return r&&la(n,r.prototype),n}).apply(null,arguments)}function sa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function la(e,t){return(la=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ua(e){return(ua=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ca(){return(ca=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var da=function(){function e(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||pa,this.controller=new self.AbortController,this.stats=new ra.LoadStats}var t=e.prototype;return t.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},t.abortInternal=function(){var e=this.response;e&&e.ok||(this.stats.aborted=!0,this.controller.abort())},t.abort=function(){var e;this.abortInternal(),null!==(e=this.callbacks)&&void 0!==e&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},t.load=function(e,t,r){var a=this,n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();var o=function(e,t){var r={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(ca({},e.headers))};return e.rangeEnd&&r.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),r}(e,this.controller.signal),s=r.onProgress,l="arraybuffer"===e.responseType,u=l?"byteLength":"length";this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,o),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout((function(){a.abortInternal(),r.onTimeout(n,e,a.response)}),t.timeout),self.fetch(this.request).then((function(r){if(a.response=a.loader=r,!r.ok){var o=r.status,u=r.statusText;throw new ha(u||"fetch, bad network response",o,r)}return n.loading.first=Math.max(self.performance.now(),n.loading.start),n.total=parseInt(r.headers.get("Content-Length")||"0"),s&&(0,i.isFiniteNumber)(t.highWaterMark)?a.loadProgressively(r,n,e,t.highWaterMark,s):l?r.arrayBuffer():r.text()})).then((function(o){var l=a.response;self.clearTimeout(a.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);var c=o[u];c&&(n.loaded=n.total=c);var d={url:l.url,data:o};s&&!(0,i.isFiniteNumber)(t.highWaterMark)&&s(n,e,o,l),r.onSuccess(d,n,e,l)})).catch((function(t){if(self.clearTimeout(a.requestTimeout),!n.aborted){var i=t&&t.code||0,o=t?t.message:null;r.onError({code:i,text:o},e,t?t.details:null)}}))},t.getCacheAge=function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null}return e},t.loadProgressively=function(e,t,r,a,n){void 0===a&&(a=0);var i=new St,o=e.body.getReader();return function s(){return o.read().then((function(o){if(o.done)return i.dataLength&&n(t,r,i.flush(),e),Promise.resolve(new ArrayBuffer(0));var l=o.value,u=l.length;return t.loaded+=u,u<a||i.dataLength?(i.push(l),i.dataLength>=a&&n(t,r,i.flush(),e)):n(t,r,l,e),s()})).catch((function(){return Promise.reject()}))}()},e}();function pa(e,t){return new self.Request(e.url,t)}var ha=function(e){var t,r;function a(t,r,a){var n;return(n=e.call(this,t)||this).code=void 0,n.details=void 0,n.code=r,n.details=a,n}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,la(t,r),a}(ia(Error));const fa=da;var ga=/\s/;function ya(){return(ya=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ma(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function va(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ma(Object(r),!0).forEach((function(t){_a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ma(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ka=va(va({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:na,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:bt,bufferController:jt,capLevelController:Lr,fpsController:Nr,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:S,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},{cueHandler:{newCue:function(e,t,r,a){for(var n,i,o,s,l,u=[],c=self.VTTCue||self.TextTrackCue,d=0;d<a.rows.length;d++)if(o=!0,s=0,l="",!(n=a.rows[d]).isEmpty()){for(var p=0;p<n.chars.length;p++)ga.test(n.chars[p].uchar)&&o?s++:(l+=n.chars[p].uchar,o=!1);n.cueStartTime=t,t===r&&(r+=1e-4),s>=16?s--:s++;var h=fr(l.trim()),f=Er(t,r,h);e&&e.cues&&e.cues.getCueById(f)||((i=new c(t,r,h)).id=f,i.line=d+1,i.align="left",i.position=10+Math.min(80,10*Math.floor(8*s/32)),u.push(i))}return e&&u.length&&(u.sort((function(e,t){return"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line})),u.forEach((function(t){return W(e,t)}))),u}},enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Mt,subtitleTrackController:Lt,timelineController:Rr,audioStreamController:Pt,audioTrackController:xt,emeController:Wr,cmcdController:ta});function Ea(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}var Ta=function(){function e(t){void 0===t&&(t={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new ft.EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var r=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return ya({},e,t)}(e.DefaultConfig,t);this.userConfig=t,(0,l.enableLogs)(r.debug,"Hls instance"),this._autoLevelCapping=-1,r.progressive&&function(e){var t=e.loader;t!==fa&&t!==na?(l.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(e.loader=fa,e.progressive=!0,e.enableSoftwareAES=!0,l.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}(r);var a=r.abrController,n=r.bufferController,i=r.capLevelController,o=r.fpsController,s=this.abrController=new a(this),u=this.bufferController=new n(this),c=this.capLevelController=new i(this),d=new o(this),p=new G(this),h=new ee(this),f=this.levelController=new ve(this),g=new _e(this),y=new Me(this.config),m=this.streamController=new kt(this,g,y);c.setStreamController(m),d.setStreamController(m);var v=[p,f,m];this.networkControllers=v;var _=[s,u,c,d,h,g];this.audioTrackController=this.createController(r.audioTrackController,v);var k=r.audioStreamController;k&&v.push(new k(this,g,y)),this.subtitleTrackController=this.createController(r.subtitleTrackController,v);var E=r.subtitleStreamController;E&&v.push(new E(this,g,y)),this.createController(r.timelineController,_),y.emeController=this.emeController=this.createController(r.emeController,_),this.cmcdController=this.createController(r.cmcdController,_),this.latencyController=this.createController(re,_),this.coreComponents=_}e.isSupported=function(){return function(){var e=it();if(!e)return!1;var t=ot(),r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!a}()};var t,r,a,i=e.prototype;return i.createController=function(e,t){if(e){var r=new e(this);return t&&t.push(r),r}return null},i.on=function(e,t,r){void 0===r&&(r=this),this._emitter.on(e,t,r)},i.once=function(e,t,r){void 0===r&&(r=this),this._emitter.once(e,t,r)},i.removeAllListeners=function(e){this._emitter.removeAllListeners(e)},i.off=function(e,t,r,a){void 0===r&&(r=this),this._emitter.off(e,t,r,a)},i.listeners=function(e){return this._emitter.listeners(e)},i.emit=function(e,t,r){return this._emitter.emit(e,t,r)},i.trigger=function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){l.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(o.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1},i.listenerCount=function(e){return this._emitter.listenerCount(e)},i.destroy=function(){l.logger.log("destroy"),this.trigger(o.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((function(e){return e.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(e){return e.destroy()})),this.coreComponents.length=0},i.attachMedia=function(e){l.logger.log("attachMedia"),this._media=e,this.trigger(o.Events.MEDIA_ATTACHING,{media:e})},i.detachMedia=function(){l.logger.log("detachMedia"),this.trigger(o.Events.MEDIA_DETACHING,void 0),this._media=null},i.loadSource=function(e){this.stopLoad();var t=this.media,r=this.url,a=this.url=n.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});l.logger.log("loadSource:"+a),t&&r&&r!==a&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(t)),this.trigger(o.Events.MANIFEST_LOADING,{url:e})},i.startLoad=function(e){void 0===e&&(e=-1),l.logger.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},i.stopLoad=function(){l.logger.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},i.swapAudioCodec=function(){l.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},i.recoverMediaError=function(){l.logger.log("recoverMediaError");var e=this._media;this.detachMedia(),e&&this.attachMedia(e)},i.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},t=e,a=[{key:"version",get:function(){return"1.3.5"}},{key:"Events",get:function(){return o.Events}},{key:"ErrorTypes",get:function(){return s.ErrorTypes}},{key:"ErrorDetails",get:function(){return s.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:ka},set:function(t){e.defaultConfig=t}}],(r=[{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){l.logger.log("set currentLevel:"+e),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){l.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){l.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){l.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){l.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(l.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e)}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(e){ae.indexOf(e)>-1&&(this._maxHdcpLevel=e)}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var r=e.length,a=0;a<r;a++)if(e[a].maxBitrate>=t)return a;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.levels,r=this.autoLevelCapping,a=this.maxHdcpLevel;if(e=-1===r&&t&&t.length?t.length-1:r,a)for(var n=e;n--;){var i=t[n].attrs["HDCP-LEVEL"];if(i&&i<=a)return n}return e}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&Ea(t.prototype,r),a&&Ea(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();Ta.defaultConfig=void 0},923:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BaseSegment:()=>d,ElementaryStreamTypes:()=>a,Fragment:()=>p,Part:()=>h});var a,n=r(965),i=r(945),o=r(408);function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n),a)}var n}function c(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(e){e.AUDIO="audio",e.VIDEO="video",e.AUDIOVIDEO="audiovideo"}(a||(a={}));var d=function(){function e(e){var t;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((t={})[a.AUDIO]=null,t[a.VIDEO]=null,t[a.AUDIOVIDEO]=null,t),this.baseurl=e}return e.prototype.setByteRange=function(e,t){var r=e.split("@",2),a=[];1===r.length?a[0]=t?t.byteRangeEndOffset:0:a[0]=parseInt(r[1]),a[1]=parseInt(r[0])+a[0],this._byteRange=a},c(e,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,i.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),e}(),p=function(e){function t(t,r){var a;return(a=e.call(this,r)||this)._decryptdata=null,a.rawProgramDateTime=null,a.programDateTime=null,a.tagList=[],a.duration=0,a.sn=0,a.levelkeys=void 0,a.type=void 0,a.loader=null,a.keyLoader=null,a.level=-1,a.cc=0,a.startPTS=void 0,a.endPTS=void 0,a.appendedPTS=void 0,a.startDTS=void 0,a.endDTS=void 0,a.start=0,a.deltaPTS=void 0,a.maxStartPTS=void 0,a.minEndPTS=void 0,a.stats=new o.LoadStats,a.urlId=0,a.data=void 0,a.bitrateTest=!1,a.title=null,a.initSegment=null,a.endList=void 0,a.type=t,a}s(t,e);var r=t.prototype;return r.setKeyFormat=function(e){if(this.levelkeys){var t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}},r.abortRequests=function(){var e,t;null===(e=this.loader)||void 0===e||e.abort(),null===(t=this.keyLoader)||void 0===t||t.abort()},r.setElementaryStreamInfo=function(e,t,r,a,n,i){void 0===i&&(i=!1);var o=this.elementaryStreams,s=o[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,r),s.startDTS=Math.min(s.startDTS,a),s.endDTS=Math.max(s.endDTS,n)):o[e]={startPTS:t,endPTS:r,startDTS:a,endDTS:n,partial:i}},r.clearElementaryStreamInfo=function(){var e=this.elementaryStreams;e[a.AUDIO]=null,e[a.VIDEO]=null,e[a.AUDIOVIDEO]=null},c(t,[{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{var t=Object.keys(this.levelkeys);if(1===t.length)return this._decryptdata=this.levelkeys[t[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!(0,n.isFiniteNumber)(this.programDateTime))return null;var e=(0,n.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;if(null!==(e=this._decryptdata)&&void 0!==e&&e.encrypted)return!0;if(this.levelkeys){var t=Object.keys(this.levelkeys),r=t.length;if(r>1||1===r&&this.levelkeys[t[0]].encrypted)return!0}return!1}}]),t}(d),h=function(e){function t(t,r,a,n,i){var s;(s=e.call(this,a)||this).fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.stats=new o.LoadStats,s.duration=t.decimalFloatingPoint("DURATION"),s.gap=t.bool("GAP"),s.independent=t.bool("INDEPENDENT"),s.relurl=t.enumeratedString("URI"),s.fragment=r,s.index=n;var l=t.enumeratedString("BYTERANGE");return l&&s.setByteRange(l,i),i&&(s.fragOffset=i.fragOffset+i.duration),s}return s(t,e),c(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),t}(d)},408:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LoadStats:()=>a});var a=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},965:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MAX_SAFE_INTEGER:()=>n,isFiniteNumber:()=>a});var a=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},n=Number.MAX_SAFE_INTEGER||9007199254740991},524:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y,flushTextTrackMetadataCueSamples:()=>v,flushTextTrackUserdataCueSamples:()=>_,normalizePts:()=>m});var a=r(965);const n=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},e}();var i=Math.pow(2,32)-1,o=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),a=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:a};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=i,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,n))},e.box=function(e){for(var t=8,r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];for(var i=a.length,o=i;i--;)t+=a[i].byteLength;var s=new Uint8Array(t);for(s[0]=t>>24&255,s[1]=t>>16&255,s[2]=t>>8&255,s[3]=255&t,s.set(e,4),i=0,t=8;i<o;i++)s.set(a[i],t),t+=a[i].byteLength;return s},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var a=Math.floor(r/(i+1)),n=Math.floor(r%(i+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,a>>24,a>>16&255,a>>8&255,255&a,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,a){return e.box(e.types.moof,e.mfhd(t),e.traf(a,r))},e.moov=function(t){for(var r=t.length,a=[];r--;)a[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(a).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,a=[];r--;)a[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(a))},e.mvhd=function(t,r){r*=t;var a=Math.floor(r/(i+1)),n=Math.floor(r%(i+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,a>>24,a>>16&255,a>>8&255,255&a,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,o)},e.sdtp=function(t){var r,a,n=t.samples||[],i=new Uint8Array(4+n.length);for(r=0;r<n.length;r++)a=n[r].flags,i[r+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return e.box(e.types.sdtp,i)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,a,n,i=[],o=[];for(r=0;r<t.sps.length;r++)n=(a=t.sps[r]).byteLength,i.push(n>>>8&255),i.push(255&n),i=i.concat(Array.prototype.slice.call(a));for(r=0;r<t.pps.length;r++)n=(a=t.pps[r]).byteLength,o.push(n>>>8&255),o.push(255&n),o=o.concat(Array.prototype.slice.call(a));var s=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(o))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?"mp3"===t.segmentCodec&&"mp3"===t.codec?e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,a=t.duration*t.timescale,n=t.width,o=t.height,s=Math.floor(a/(i+1)),l=Math.floor(a%(i+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,o>>8&255,255&o,0,0]))},e.traf=function(t,r){var a=e.sdtp(t),n=t.id,o=Math.floor(r/(i+1)),s=Math.floor(r%(i+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,a.length+16+20+8+16+8+8),a)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var a,n,i,o,s,l,u=t.samples||[],c=u.length,d=12+16*c,p=new Uint8Array(d);for(r+=8+d,p.set(["video"===t.type?1:0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),a=0;a<c;a++)i=(n=u[a]).duration,o=n.size,s=n.flags,l=n.cts,p.set([i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*a);return e.box(e.types.trun,p)},e.initSegment=function(t){e.types||e.init();var r=e.moov(t),a=new Uint8Array(e.FTYP.byteLength+r.byteLength);return a.set(e.FTYP),a.set(r,e.FTYP.byteLength),a},e}();o.types=void 0,o.HDLR_TYPES=void 0,o.STTS=void 0,o.STSC=void 0,o.STCO=void 0,o.STSZ=void 0,o.VMHD=void 0,o.SMHD=void 0,o.STSD=void 0,o.FTYP=void 0,o.DINF=void 0;const s=o;var l=r(851),u=r(973),c=r(93),d=r(308),p=r(673);function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var f=null,g=null,y=function(){function e(e,t,r,a){if(void 0===a&&(a=""),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,null===f){var n=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);f=n?parseInt(n[1]):0}if(null===g){var i=navigator.userAgent.match(/Safari\/(\d+)/i);g=i?parseInt(i[1]):0}}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){c.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e},t.resetNextTimestamp=function(){c.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},t.resetInitSegment=function(){c.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,r=e.reduce((function(e,r){var a=r.pts-e;return a<-4294967296?(t=!0,m(e,r.pts)):a>0?e:r.pts}),e[0].pts);return t&&c.logger.debug("PTS rollover detected"),r},t.remux=function(e,t,r,a,n,i,o,s){var l,u,p,h,f,g,y=n,k=n,E=e.pid>-1,T=t.pid>-1,b=t.samples.length,S=e.samples.length>0,A=o&&b>0||b>1;if((!E||S)&&(!T||A)||this.ISGenerated||o){this.ISGenerated||(p=this.generateIS(e,t,n));var C,P=this.isVideoContiguous,w=-1;if(A&&(w=function(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!P&&this.config.forceKeyFrameOnDiscontinuity))if(g=!0,w>0){c.logger.warn("[mp4-remuxer]: Dropped "+w+" out of "+b+" video samples due to a missing keyframe");var x=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(w),t.dropped+=w,C=k+=(t.samples[0].pts-x)/t.inputTimeScale}else-1===w&&(c.logger.warn("[mp4-remuxer]: No keyframe found out of "+b+" video samples"),g=!1);if(this.ISGenerated){if(S&&A){var I=this.getVideoStartPts(t.samples),M=(m(e.samples[0].pts,I)-I)/t.inputTimeScale;y+=Math.max(0,M),k+=Math.max(0,-M)}if(S){if(e.samplerate||(c.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),p=this.generateIS(e,t,n)),u=this.remuxAudio(e,y,this.isAudioContiguous,i,T||A||s===d.PlaylistLevelType.AUDIO?k:void 0),A){var D=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(c.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),p=this.generateIS(e,t,n)),l=this.remuxVideo(t,k,P,D)}}else A&&(l=this.remuxVideo(t,k,P,0));l&&(l.firstKeyFrame=w,l.independent=-1!==w,l.firstKeyFramePTS=C)}}return this.ISGenerated&&(r.samples.length&&(f=v(r,n,this._initPTS,this._initDTS)),a.samples.length&&(h=_(a,n,this._initPTS))),{audio:u,video:l,initSegment:p,independent:g,text:h,id3:f}},t.generateIS=function(e,t,r){var n,i,o,l=e.samples,u=t.samples,c=this.typeSupported,d={},p=!(0,a.isFiniteNumber)(this._initPTS),h="audio/mp4";if(p&&(n=i=1/0),e.config&&l.length&&(e.timescale=e.samplerate,"mp3"===e.segmentCodec&&(c.mpeg?(h="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),d.audio={id:"audio",container:h,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&c.mpeg?new Uint8Array(0):s.initSegment([e]),metadata:{channelCount:e.channelCount}},p&&(o=e.inputTimeScale,n=i=l[0].pts-Math.round(o*r))),t.sps&&t.pps&&u.length&&(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:s.initSegment([t]),metadata:{width:t.width,height:t.height}},p)){o=t.inputTimeScale;var f=this.getVideoStartPts(u),g=Math.round(o*r);i=Math.min(i,m(u[0].dts,f)-g),n=Math.min(n,f-g)}if(Object.keys(d).length)return this.ISGenerated=!0,p&&(this._initPTS=n,this._initDTS=i),{tracks:d,initPTS:n,timescale:o}},t.remuxVideo=function(e,t,r,a){var n,i,o=e.inputTimeScale,d=e.samples,y=[],v=d.length,_=this._initPTS,E=this.nextAvcDts,T=8,b=this.videoSampleDuration,S=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,C=!1;r&&null!==E||(E=t*o-(d[0].pts-m(d[0].dts,d[0].pts)));for(var P=0;P<v;P++){var w=d[P];w.pts=m(w.pts-_,E),w.dts=m(w.dts-_,E),w.dts<d[P>0?P-1:P].dts&&(C=!0)}C&&d.sort((function(e,t){var r=e.dts-t.dts,a=e.pts-t.pts;return r||a})),n=d[0].dts;var x=d[d.length-1].dts-n,I=x?Math.round(x/(v-1)):b||e.inputTimeScale/30;if(r){var M=n-E,D=M>I,R=M<-1;if((D||R)&&(D?c.logger.warn("AVC: "+(0,p.toMsFromMpegTsClock)(M,!0)+" ms ("+M+"dts) hole between fragments detected, filling it"):c.logger.warn("AVC: "+(0,p.toMsFromMpegTsClock)(-M,!0)+" ms ("+M+"dts) overlapping between fragments detected"),!R||E>d[0].pts)){n=E;var O=d[0].pts-M;d[0].dts=n,d[0].pts=O,c.logger.log("Video: First PTS/DTS adjusted: "+(0,p.toMsFromMpegTsClock)(O,!0)+"/"+(0,p.toMsFromMpegTsClock)(n,!0)+", delta: "+(0,p.toMsFromMpegTsClock)(M,!0)+" ms")}}n=Math.max(0,n);for(var L=0,N=0,U=0;U<v;U++){for(var F=d[U],B=F.units,j=B.length,V=0,$=0;$<j;$++)V+=B[$].data.length;N+=V,L+=j,F.length=V,F.dts=Math.max(F.dts,n),S=Math.min(F.pts,S),A=Math.max(F.pts,A)}i=d[v-1].dts;var H,G=N+4*L+8;try{H=new Uint8Array(G)}catch(e){return void this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:u.ErrorTypes.MUX_ERROR,details:u.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:G,reason:"fail allocating video mdat "+G})}var K=new DataView(H.buffer);K.setUint32(0,G),H.set(s.types.mdat,4);for(var W=!1,z=Number.POSITIVE_INFINITY,q=Number.POSITIVE_INFINITY,Y=Number.NEGATIVE_INFINITY,X=Number.NEGATIVE_INFINITY,Q=0;Q<v;Q++){for(var J=d[Q],Z=J.units,ee=0,te=0,re=Z.length;te<re;te++){var ae=Z[te],ne=ae.data,ie=ae.data.byteLength;K.setUint32(T,ie),T+=4,H.set(ne,T),T+=ie,ee+=4+ie}var oe=void 0;if(Q<v-1)b=d[Q+1].dts-J.dts,oe=d[Q+1].pts-J.pts;else{var se=this.config,le=Q>0?J.dts-d[Q-1].dts:I;if(oe=Q>0?J.pts-d[Q-1].pts:I,se.stretchShortVideoTrack&&null!==this.nextAudioPts){var ue=Math.floor(se.maxBufferHole*o),ce=(a?S+a*o:this.nextAudioPts)-J.pts;ce>ue?((b=ce-le)<0?b=le:W=!0,c.logger.log("[mp4-remuxer]: It is approximately "+ce/90+" ms to the next segment; using duration "+b/90+" ms for the last video frame.")):b=le}else b=le}var de=Math.round(J.pts-J.dts);z=Math.min(z,b),Y=Math.max(Y,b),q=Math.min(q,oe),X=Math.max(X,oe),y.push(new k(J.key,b,ee,de))}if(y.length)if(f){if(f<70){var pe=y[0].flags;pe.dependsOn=2,pe.isNonSync=0}}else if(g&&X-q<Y-z&&I/Y<.025&&0===y[0].cts){c.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var he=n,fe=0,ge=y.length;fe<ge;fe++){var ye=he+y[fe].duration,me=he+y[fe].cts;if(fe<ge-1){var ve=ye+y[fe+1].cts;y[fe].duration=ve-me}else y[fe].duration=fe?y[fe-1].duration:I;y[fe].cts=0,he=ye}}b=W||!b?I:b,this.nextAvcDts=E=i+b,this.videoSampleDuration=b,this.isVideoContiguous=!0;var _e={data1:s.moof(e.sequenceNumber++,n,h({},e,{samples:y})),data2:H,startPTS:S/o,endPTS:(A+b)/o,startDTS:n/o,endDTS:E/o,type:"video",hasAudio:!1,hasVideo:!0,nb:y.length,dropped:e.dropped};return e.samples=[],e.dropped=0,_e},t.remuxAudio=function(e,t,r,a,i){var o=e.inputTimeScale,d=o/(e.samplerate?e.samplerate:o),p="aac"===e.segmentCodec?1024:1152,f=p*d,g=this._initPTS,y="mp3"===e.segmentCodec&&this.typeSupported.mpeg,v=[],_=void 0!==i,E=e.samples,T=y?0:8,b=this.nextAudioPts||-1,S=t*o;if(this.isAudioContiguous=r=r||E.length&&b>0&&(a&&Math.abs(S-b)<9e3||Math.abs(m(E[0].pts-g,S)-b)<20*f),E.forEach((function(e){e.pts=m(e.pts-g,S)})),!r||b<0){if(!(E=E.filter((function(e){return e.pts>=0}))).length)return;b=0===i?0:a&&!_?Math.max(0,S):E[0].pts}if("aac"===e.segmentCodec)for(var A=this.config.maxAudioFramesDrift,C=0,P=b;C<E.length;C++){var w=E[C],x=w.pts,I=x-P,M=Math.abs(1e3*I/o);if(I<=-A*f&&_)0===C&&(c.logger.warn("Audio frame @ "+(x/o).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*I/o)+" ms."),this.nextAudioPts=b=P=x);else if(I>=A*f&&M<1e4&&_){var D=Math.round(I/f);(P=x-D*f)<0&&(D--,P+=f),0===C&&(this.nextAudioPts=b=P),c.logger.warn("[mp4-remuxer]: Injecting "+D+" audio frame @ "+(P/o).toFixed(3)+"s due to "+Math.round(1e3*I/o)+" ms gap.");for(var R=0;R<D;R++){var O=Math.max(P,0),L=n.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);L||(c.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),L=w.unit.subarray()),E.splice(C,0,{unit:L,pts:O}),P+=f,C++}}w.pts=P,P+=f}for(var N,U=null,F=null,B=0,j=E.length;j--;)B+=E[j].unit.byteLength;for(var V=0,$=E.length;V<$;V++){var H=E[V],G=H.unit,K=H.pts;if(null!==F)v[V-1].duration=Math.round((K-F)/d);else{if(r&&"aac"===e.segmentCodec&&(K=b),U=K,!(B>0))return;B+=T;try{N=new Uint8Array(B)}catch(e){return void this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:u.ErrorTypes.MUX_ERROR,details:u.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating audio mdat "+B})}y||(new DataView(N.buffer).setUint32(0,B),N.set(s.types.mdat,4))}N.set(G,T);var W=G.byteLength;T+=W,v.push(new k(!0,p,W,0)),F=K}var z=v.length;if(z){var q=v[v.length-1];this.nextAudioPts=b=F+d*q.duration;var Y=y?new Uint8Array(0):s.moof(e.sequenceNumber++,U/d,h({},e,{samples:v}));e.samples=[];var X=U/o,Q=b/o,J={data1:Y,data2:N,startPTS:X,endPTS:Q,startDTS:X,endDTS:Q,type:"audio",hasAudio:!0,hasVideo:!1,nb:z};return this.isAudioContiguous=!0,J}},t.remuxEmptyAudio=function(e,t,r,a){var i=e.inputTimeScale,o=i/(e.samplerate?e.samplerate:i),s=this.nextAudioPts,l=(null!==s?s:a.startDTS*i)+this._initDTS,u=a.endDTS*i+this._initDTS,d=1024*o,p=Math.ceil((u-l)/d),h=n.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(c.logger.warn("[mp4-remuxer]: remux empty Audio"),h){for(var f=[],g=0;g<p;g++){var y=l+g*d;f.push({unit:h,pts:y,dts:y})}return e.samples=f,this.remuxAudio(e,t,r,!1)}c.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},e}();function m(e,t){var r;if(null===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}function v(e,t,r,a){var n=e.samples.length;if(n){for(var i=e.inputTimeScale,o=0;o<n;o++){var s=e.samples[o];s.pts=m(s.pts-r,t*i)/i,s.dts=m(s.dts-a,t*i)/i}var l=e.samples;return e.samples=[],{samples:l}}}function _(e,t,r){var a=e.samples.length;if(a){for(var n=e.inputTimeScale,i=0;i<a;i++){var o=e.samples[i];o.pts=m(o.pts-r,t*n)/n}e.samples.sort((function(e,t){return e.pts-t.pts}));var s=e.samples;return e.samples=[],{samples:s}}}var k=function(e,t,r,a){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=r,this.cts=a,this.flags=new E(e)},E=function(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}},856:(e,t,r)=>{"use strict";var a;r.r(t),r.d(t,{MetadataSchema:()=>a}),function(e){e.audioId3="org.id3",e.dateRange="com.apple.quicktime.HLS",e.emsg="https://aomedia.org/emsg/ID3"}(a||(a={}))},308:(e,t,r)=>{"use strict";var a,n;r.r(t),r.d(t,{PlaylistContextType:()=>a,PlaylistLevelType:()=>n}),function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(a||(a={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(n||(n={}))},300:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});const a={hexDump:function(e){for(var t="",r=0;r<e.length;r++){var a=e[r].toString(16);a.length<2&&(a="0"+a),t+=a}return t}}},93:(e,t,r)=>{"use strict";r.r(t),r.d(t,{enableLogs:()=>s,logger:()=>l});var a=function(){},n={trace:a,debug:a,log:a,warn:a,info:a,error:a},i=n;function o(e){var t=self.console[e];return t?t.bind(self.console,"["+e+"] >"):a}function s(e,t){if(self.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];r.forEach((function(t){i[t]=e[t]?e[t].bind(e):o(t)}))}(e,"debug","log","info","warn","error");try{i.log('Debug logs enabled for "'+t+'"')}catch(e){i=n}}else i=n}var l=n},63:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RemuxerTrackIdConfig:()=>c,appendUint8Array:()=>C,bin2str:()=>d,computeRawDurationFromSamples:()=>b,discardEPB:()=>I,findBox:()=>y,getDuration:()=>T,getStartDTS:()=>E,mp4Box:()=>D,mp4pssh:()=>R,offsetStartDTS:()=>S,parseEmsg:()=>M,parseInitSegment:()=>v,parsePssh:()=>O,parseSEIMessageFromNALu:()=>x,parseSamples:()=>P,parseSegmentIndex:()=>m,parseSinf:()=>k,patchEncyptionData:()=>_,readSint32:()=>f,readUint16:()=>p,readUint32:()=>h,segmentValidRange:()=>A,writeUint32:()=>g});var a=r(923),n=r(145),i=r(181),o=r(93),s=r(300),l=Math.pow(2,32)-1,u=[].push,c={video:1,audio:2,id3:3,text:4};function d(e){return String.fromCharCode.apply(null,e)}function p(e,t){var r=e[t]<<8|e[t+1];return r<0?65536+r:r}function h(e,t){var r=f(e,t);return r<0?4294967296+r:r}function f(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function g(e,t,r){e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}function y(e,t){var r=[];if(!t.length)return r;for(var a=e.byteLength,n=0;n<a;){var i=h(e,n),o=i>1?n+i:a;if(d(e.subarray(n+4,n+8))===t[0])if(1===t.length)r.push(e.subarray(n+8,o));else{var s=y(e.subarray(n+8,o),t.slice(1));s.length&&u.apply(r,s)}n=o}return r}function m(e){var t=[],r=e[0],a=8,n=h(e,a);a+=4,a+=0===r?8:16,a+=2;var i=e.length+0,o=p(e,a);a+=2;for(var s=0;s<o;s++){var l=a,u=h(e,l);l+=4;var c=2147483647&u;if(1==(2147483648&u)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;var d=h(e,l);l+=4,t.push({referenceSize:c,subsegmentDuration:d,info:{duration:d/n,start:i,end:i+c-1}}),i+=c,a=l+=4}return{earliestPresentationTime:0,timescale:n,version:r,referencesCount:o,references:t}}function v(e){for(var t=[],r=y(e,["moov","trak"]),n=0;n<r.length;n++){var i=r[n],o=y(i,["tkhd"])[0];if(o){var s=o[0],l=0===s?12:20,u=h(o,l),c=y(i,["mdia","mdhd"])[0];if(c){var p=h(c,l=0===(s=c[0])?12:20),f=y(i,["mdia","hdlr"])[0];if(f){var g=d(f.subarray(8,12)),m={soun:a.ElementaryStreamTypes.AUDIO,vide:a.ElementaryStreamTypes.VIDEO}[g];if(m){var v=y(i,["mdia","minf","stbl","stsd"])[0],_=void 0;v&&(_=d(v.subarray(12,16))),t[u]={timescale:p,type:m},t[m]={timescale:p,id:u,codec:_}}}}}}return y(e,["moov","mvex","trex"]).forEach((function(e){var r=h(e,4),a=t[r];a&&(a.default={duration:h(e,12),flags:h(e,20)})})),t}function _(e,t){if(!e||!t)return e;var r=t.keyId;return r&&t.isCommonEncryption&&y(e,["moov","trak"]).forEach((function(e){var t=y(e,["mdia","minf","stbl","stsd"])[0].subarray(8),a=y(t,["enca"]),n=a.length>0;n||(a=y(t,["encv"])),a.forEach((function(e){y(n?e.subarray(28):e.subarray(78),["sinf"]).forEach((function(e){var t=k(e);if(t){var a=t.subarray(8,24);a.some((function(e){return 0!==e}))||(o.logger.log("[eme] Patching keyId in 'enc"+(n?"a":"v")+">sinf>>tenc' box: "+s.default.hexDump(a)+" -> "+s.default.hexDump(r)),t.set(r,8))}}))}))})),e}function k(e){var t=y(e,["schm"])[0];if(t){var r=d(t.subarray(4,8));if("cbcs"===r||"cenc"===r)return y(e,["schi","tenc"])[0]}return o.logger.error("[eme] missing 'schm' box"),null}function E(e,t){return y(t,["moof","traf"]).reduce((function(t,r){var a=y(r,["tfdt"])[0],n=a[0],i=y(r,["tfhd"]).reduce((function(t,r){var i=h(r,4),o=e[i];if(o){var s=h(a,4);1===n&&(s*=Math.pow(2,32),s+=h(a,8));var l=s/(o.timescale||9e4);if(isFinite(l)&&(null===t||l<t))return l}return t}),null);return null!==i&&isFinite(i)&&(null===t||i<t)?i:t}),null)||0}function T(e,t){for(var r=0,n=0,i=0,o=y(e,["moof","traf"]),s=0;s<o.length;s++){var l=o[s],u=y(l,["tfhd"])[0],c=t[h(u,4)];if(c){var d=c.default,p=h(u,0)|(null==d?void 0:d.flags),f=null==d?void 0:d.duration;8&p&&(f=h(u,2&p?12:8));for(var g=c.timescale||9e4,v=y(l,["trun"]),_=0;_<v.length;_++)!(r=b(v[_]))&&f&&(r=f*h(v[_],4)),c.type===a.ElementaryStreamTypes.VIDEO?n+=r/g:c.type===a.ElementaryStreamTypes.AUDIO&&(i+=r/g)}}if(0===n&&0===i){for(var k=0,E=y(e,["sidx"]),T=0;T<E.length;T++){var S=m(E[T]);null!=S&&S.references&&(k+=S.references.reduce((function(e,t){return e+t.info.duration||0}),0))}return k}return n||i}function b(e){var t=h(e,0),r=8;1&t&&(r+=4),4&t&&(r+=4);for(var a=0,n=h(e,4),i=0;i<n;i++)256&t&&(a+=h(e,r),r+=4),512&t&&(r+=4),1024&t&&(r+=4),2048&t&&(r+=4);return a}function S(e,t,r){y(t,["moof","traf"]).forEach((function(t){y(t,["tfhd"]).forEach((function(a){var n=h(a,4),i=e[n];if(i){var o=i.timescale||9e4;y(t,["tfdt"]).forEach((function(e){var t=e[0],a=h(e,4);if(0===t)a-=r*o,g(e,4,a=Math.max(a,0));else{a*=Math.pow(2,32),a+=h(e,8),a-=r*o,a=Math.max(a,0);var n=Math.floor(a/(l+1)),i=Math.floor(a%(l+1));g(e,4,n),g(e,8,i)}}))}}))}))}function A(e){var t={valid:null,remainder:null},r=y(e,["moof"]);if(!r)return t;if(r.length<2)return t.remainder=e,t;var a=r[r.length-1];return t.valid=(0,n.sliceUint8)(e,0,a.byteOffset-8),t.remainder=(0,n.sliceUint8)(e,a.byteOffset-8),t}function C(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function P(e,t){var r=[],n=t.samples,i=t.timescale,o=t.id,s=!1;return y(n,["moof"]).map((function(l){var u=l.byteOffset-8;y(l,["traf"]).map((function(l){var c=y(l,["tfdt"]).map((function(e){var t=e[0],r=h(e,4);return 1===t&&(r*=Math.pow(2,32),r+=h(e,8)),r/i}))[0];return void 0!==c&&(e=c),y(l,["tfhd"]).map((function(c){var d=h(c,4),p=16777215&h(c,0),g=0,m=0!=(16&p),v=0,_=0!=(32&p),k=8;d===o&&(0!=(1&p)&&(k+=8),0!=(2&p)&&(k+=4),0!=(8&p)&&(g=h(c,k),k+=4),m&&(v=h(c,k),k+=4),_&&(k+=4),"video"===t.type&&(s=function(e){if(!e)return!1;var t=e.indexOf("."),r=t<0?e:e.substring(0,t);return"hvc1"===r||"hev1"===r||"dvh1"===r||"dvhe"===r}(t.codec)),y(l,["trun"]).map((function(o){var l=o[0],c=16777215&h(o,0),d=0!=(1&c),p=0,y=0!=(4&c),m=0!=(256&c),_=0,k=0!=(512&c),E=0,T=0!=(1024&c),b=0!=(2048&c),S=0,A=h(o,4),C=8;d&&(p=h(o,C),C+=4),y&&(C+=4);for(var P=p+u,I=0;I<A;I++){if(m?(_=h(o,C),C+=4):_=g,k?(E=h(o,C),C+=4):E=v,T&&(C+=4),b&&(S=0===l?h(o,C):f(o,C),C+=4),t.type===a.ElementaryStreamTypes.VIDEO)for(var M=0;M<E;){var D=h(n,P);w(s,n[P+=4])&&x(n.subarray(P,P+D),s?2:1,e+S/i,r),P+=D,M+=D+4}e+=_/i}})))}))}))})),r}function w(e,t){if(e){var r=t>>1&63;return 39===r||40===r}return 6==(31&t)}function x(e,t,r,a){var n=I(e),o=0;o+=t;for(var s=0,l=0,u=!1,c=0;o<n.length;){s=0;do{if(o>=n.length)break;s+=c=n[o++]}while(255===c);l=0;do{if(o>=n.length)break;l+=c=n[o++]}while(255===c);var d=n.length-o;if(!u&&4===s&&o<n.length){if(u=!0,181===n[o++]){var f=p(n,o);if(o+=2,49===f){var g=h(n,o);if(o+=4,1195456820===g){var y=n[o++];if(3===y){var m=n[o++],v=64&m,_=v?2+3*(31&m):0,k=new Uint8Array(_);if(v){k[0]=m;for(var E=1;E<_;E++)k[E]=n[o++]}a.push({type:y,payloadType:s,pts:r,bytes:k})}}}}}else if(5===s&&l<d){if(u=!0,l>16){for(var T=[],b=0;b<16;b++){var S=n[o++].toString(16);T.push(1==S.length?"0"+S:S),3!==b&&5!==b&&7!==b&&9!==b||T.push("-")}for(var A=l-16,C=new Uint8Array(A),P=0;P<A;P++)C[P]=n[o++];a.push({payloadType:s,pts:r,uuid:T.join(""),userData:(0,i.utf8ArrayToStr)(C),userDataBytes:C})}}else if(l<d)o+=l;else if(l>d)break}}function I(e){for(var t=e.byteLength,r=[],a=1;a<t-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;var n=t-r.length,i=new Uint8Array(n),o=0;for(a=0;a<n;o++,a++)o===r[0]&&(o++,r.shift()),i[a]=e[o];return i}function M(e){var t=e[0],r="",a="",n=0,i=0,o=0,s=0,l=0,u=0;if(0===t){for(;"\0"!==d(e.subarray(u,u+1));)r+=d(e.subarray(u,u+1)),u+=1;for(r+=d(e.subarray(u,u+1)),u+=1;"\0"!==d(e.subarray(u,u+1));)a+=d(e.subarray(u,u+1)),u+=1;a+=d(e.subarray(u,u+1)),u+=1,n=h(e,12),i=h(e,16),s=h(e,20),l=h(e,24),u=28}else if(1===t){n=h(e,u+=4);var c=h(e,u+=4),p=h(e,u+=4);for(u+=4,o=Math.pow(2,32)*c+p,Number.isSafeInteger(o)||(o=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=h(e,u),l=h(e,u+=4),u+=4;"\0"!==d(e.subarray(u,u+1));)r+=d(e.subarray(u,u+1)),u+=1;for(r+=d(e.subarray(u,u+1)),u+=1;"\0"!==d(e.subarray(u,u+1));)a+=d(e.subarray(u,u+1)),u+=1;a+=d(e.subarray(u,u+1)),u+=1}return{schemeIdUri:r,value:a,timeScale:n,presentationTime:o,presentationTimeDelta:i,eventDuration:s,id:l,payload:e.subarray(u,e.byteLength)}}function D(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];for(var n=r.length,i=8,o=n;o--;)i+=r[o].byteLength;var s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(e,4),o=0,i=8;o<n;o++)s.set(r[o],i),i+=r[o].byteLength;return s}function R(e,t,r){if(16!==e.byteLength)throw new RangeError("Invalid system id");var a,n,i;if(t){a=1,n=new Uint8Array(16*t.length);for(var o=0;o<t.length;o++){var s=t[o];if(16!==s.byteLength)throw new RangeError("Invalid key");n.set(s,16*o)}}else a=0,n=new Uint8Array;a>0?(i=new Uint8Array(4),t.length>0&&new DataView(i.buffer).setUint32(0,t.length,!1)):i=new Uint8Array;var l=new Uint8Array(4);return r&&r.byteLength>0&&new DataView(l.buffer).setUint32(0,r.byteLength,!1),D([112,115,115,104],new Uint8Array([a,0,0,0]),e,i,n,l,r||new Uint8Array)}function O(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;var t={version:0,systemId:"",kids:null,data:null},r=new DataView(e),a=r.getUint32(0);if(e.byteLength!==a&&a>44)return null;if(1886614376!==r.getUint32(4))return null;if(t.version=r.getUint32(8)>>>24,t.version>1)return null;t.systemId=s.default.hexDump(new Uint8Array(e,12,16));var n=r.getUint32(28);if(0===t.version){if(a-32<n)return null;t.data=new Uint8Array(e,32,n)}else if(1===t.version){t.kids=[];for(var i=0;i<n;i++)t.kids.push(new Uint8Array(e,32+16*i,16))}return t}},673:(e,t,r)=>{"use strict";function a(e,t,r,a){void 0===r&&(r=1),void 0===a&&(a=!1);var n=e*t*r;return a?Math.round(n):n}function n(e,t,r,n){return void 0===r&&(r=1),void 0===n&&(n=!1),a(e,t,1/r,n)}function i(e,t){return void 0===t&&(t=!1),a(e,1e3,1/9e4,t)}function o(e,t){return void 0===t&&(t=1),a(e,9e4,1/t)}r.r(t),r.d(t,{toMpegTsClockFromTimescale:()=>o,toMsFromMpegTsClock:()=>i,toTimescaleFromBase:()=>a,toTimescaleFromScale:()=>n})},145:(e,t,r)=>{"use strict";function a(e,t,r){return Uint8Array.prototype.slice?e.slice(t,r):new Uint8Array(Array.prototype.slice.call(e,t,r))}r.r(t),r.d(t,{sliceUint8:()=>a})},729:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function a(){}function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,a,i,o){if("function"!=typeof a)throw new TypeError("The listener must be a function");var s=new n(a,i||e,o),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function s(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,a,n=[];if(0===this._eventsCount)return n;for(a in e=this._events)t.call(e,a)&&n.push(r?a.slice(1):a);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},s.prototype.listeners=function(e){var t=r?r+e:e,a=this._events[t];if(!a)return[];if(a.fn)return[a.fn];for(var n=0,i=a.length,o=new Array(i);n<i;n++)o[n]=a[n].fn;return o},s.prototype.listenerCount=function(e){var t=r?r+e:e,a=this._events[t];return a?a.fn?1:a.length:0},s.prototype.emit=function(e,t,a,n,i,o){var s=r?r+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,a),!0;case 4:return c.fn.call(c.context,t,a,n),!0;case 5:return c.fn.call(c.context,t,a,n,i),!0;case 6:return c.fn.call(c.context,t,a,n,i,o),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var p,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,a);break;case 4:c[u].fn.call(c[u].context,t,a,n);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,a,n){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||n&&!s.once||a&&s.context!==a||o(this,i);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||n&&!s[l].once||a&&s[l].context!==a)&&u.push(s[l]);u.length?this._events[i]=1===u.length?u[0]:u:o(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new a,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},945:function(e){var t,r,a,n,i;t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,n=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,i={buildAbsoluteURL:function(e,t,a){if(a=a||{},e=e.trim(),!(t=t.trim())){if(!a.alwaysNormalize)return e;var n=i.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=i.normalizePath(n.path),i.buildURLFromParts(n)}var o=i.parseURL(t);if(!o)throw new Error("Error trying to parse relative URL.");if(o.scheme)return a.alwaysNormalize?(o.path=i.normalizePath(o.path),i.buildURLFromParts(o)):t;var s=i.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=r.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:o.netLoc,path:null,params:o.params,query:o.query,fragment:o.fragment};if(!o.netLoc&&(u.netLoc=s.netLoc,"/"!==o.path[0]))if(o.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+o.path;u.path=i.normalizePath(d)}else u.path=s.path,o.params||(u.params=s.params,o.query||(u.query=s.query));return null===u.path&&(u.path=a.alwaysNormalize?i.normalizePath(o.path):o.path),i.buildURLFromParts(u)},parseURL:function(e){var r=t.exec(e);return r?{scheme:r[1]||"",netLoc:r[2]||"",path:r[3]||"",params:r[4]||"",query:r[5]||"",fragment:r[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(n,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=i}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,r),i.exports}return r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(76).default})(),e.exports=a())},function(e,t,r){var a,n;window,e.exports=(a=r(0),n=r(318),function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t){e.exports=a},function(e,t){e.exports=n},function(e){e.exports=JSON.parse('{"shakaConfig":{"streaming":{"ignoreTextStreamFailures":true,"bufferingGoal":60,"alwaysStreamText":true},"abr":{"enabled":true,"restrictions":{}}},"forceRedirectExternalStreams":false,"trackEmsgEvents":true,"switchDynamicToStatic":false}')},function(e,t,r){(t=r(5)(!1)).push([e.i,".shaka-text-container {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  width: 100%;\n  min-width: 48px;\n  transition: bottom cubic-bezier(0.4, 0, 0.6, 1) 0.1s;\n  transition-delay: 0s;\n  font-size: 20px;\n  line-height: 1.4;\n  color: #fff;\n  font-family: Roboto-Regular, Roboto, sans-serif, TengwarTelcontar;\n}\n.shaka-text-container span.shaka-text-wrapper {\n  display: inline;\n  background: 0 0;\n  text-align: center;\n}\n\n:fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-webkit-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-moz-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-ms-fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n",""]),e.exports=t},function(e,t,r){"use strict";var a,n=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),i=[];function o(e){for(var t=-1,r=0;r<i.length;r++)if(i[r].identifier===e){t=r;break}return t}function s(e,t){for(var r={},a=[],n=0;n<e.length;n++){var s=e[n],l=t.base?s[0]+t.base:s[0],u=r[l]||0,c="".concat(l," ").concat(u);r[l]=u+1;var d=o(c),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(i[d].references++,i[d].updater(p)):i.push({identifier:c,updater:g(p,t),references:1}),a.push(c)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var i=r.nc;i&&(a.nonce=i)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=n(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,r,a){var n=r?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,n);else{var i=document.createTextNode(n),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function p(e,t,r){var a=r.css,n=r.media,i=r.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var h=null,f=0;function g(e,t){var r,a,n;if(t.singleton){var i=f++;r=h||(h=l(t)),a=d.bind(null,r,i,!1),n=d.bind(null,r,i,!0)}else r=l(t),a=p.bind(null,r,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var r=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<r.length;a++){var n=o(r[a]);i[n].references--}for(var l=s(e,t),u=0;u<r.length;u++){var c=o(r[u]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}r=l}}}},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r,a,n,i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"==typeof btoa){var s=(r=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(n," */")),l=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[i].concat(l).concat([s]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,a){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(a)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(n[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&n[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},function(e,t,r){"use strict";r.r(t),r.d(t,"VERSION",(function(){return Y})),r.d(t,"NAME",(function(){return X}));var a,n,i,o,s,l,u,c=r(0),d=r(1),p=r.n(d),h=(n=a=function(){function e(){}return e.isConfigured=function(e,t){return c.DrmScheme.WIDEVINE===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))},e.canPlayDrm=function(t){return e._logger.debug("Can play DRM scheme of: "+c.DrmScheme.WIDEVINE),!!t.find((function(e){return e.scheme===c.DrmScheme.WIDEVINE}))},e.setDrmPlayback=function(t,r){e._logger.debug("Sets drm playback");var a,n,i=c.Env.browser.name,o=r.find((function(e){return e.scheme===c.DrmScheme.WIDEVINE}));o&&(t.drm={servers:(a={},a[c.DrmScheme.WIDEVINE]=o.licenseUrl,a),advanced:{}},"Chrome"===i&&(t.drm.advanced=((n={})[c.DrmScheme.WIDEVINE]={videoRobustness:"SW_SECURE_CRYPTO",audioRobustness:"SW_SECURE_CRYPTO"},n)))},e}(),i=a,o="_logger",s=Object(c.getLogger)("Widevine"),o in i?Object.defineProperty(i,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[o]=s,n),f=(u=l=function(){function e(){}return e.isConfigured=function(e,t){return c.DrmScheme.PLAYREADY===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))},e.canPlayDrm=function(t){return e._logger.debug("Can play DRM scheme of: "+c.DrmScheme.PLAYREADY),!!t.find((function(e){return e.scheme===c.DrmScheme.PLAYREADY}))},e.setDrmPlayback=function(t,r){e._logger.debug("Sets drm playback");var a,n=r.find((function(e){return e.scheme===c.DrmScheme.PLAYREADY}));n&&(t.drm={servers:(a={},a[c.DrmScheme.PLAYREADY]=n.licenseUrl,a)})},e}(),function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(l,"_logger",Object(c.getLogger)("PlayReady")),u),g=r(2),y=r(4),m=r.n(y),v=r(3),_=r.n(v);function k(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}m()(_.a,{insert:"head",singleton:!1}),_.a.locals;var E=function(){function e(e){this._media=S.parseAttr(e,b.AttributeTypes.MEDIA),this._startNumber=S.parseAttr(e,b.AttributeTypes.START_NUMBER,S.parseInt,1),this._duration=S.parseAttr(e,b.AttributeTypes.DURATION,S.parseFloat),this._timescale=S.parseAttr(e,b.AttributeTypes.TIMESCALE,S.parsePositiveInt,1),this._presentationTimeOffset=S.parseAttr(e,b.AttributeTypes.PRESENTATION_TIME_OFFSET,S.parseInt,0),this._endNumber=S.parseAttr(e,b.AttributeTypes.END_NUMBER,S.parsePositiveInt)}var t,r;return t=e,(r=[{key:"media",get:function(){return this._media}},{key:"startNumber",get:function(){return this._startNumber}},{key:"duration",get:function(){return this._duration}},{key:"timescale",get:function(){return this._timescale}},{key:"presentationTimeOffset",get:function(){return this._presentationTimeOffset}},{key:"endNumber",get:function(){return this._endNumber}}])&&k(t.prototype,r),e}();!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(E,"MediaTemplateType",{REPRESENTATION:"$RepresentationID$",NUMBER:"$Number$",BANDWIDTH:"$Bandwidth$",TIME:"$Time$"});var T=function(e,t){var r=t.id,a=t.index,n=t.bitrate,i=t.time,o=e.match(/\$([a-zA-Z]+)\$/g),s=function(e,t,r){return r?e.replace(t,r):e};return o&&o.forEach((function(t){switch(t){case E.MediaTemplateType.REPRESENTATION:e=s(e,t,r);break;case E.MediaTemplateType.NUMBER:e=s(e,t,a);break;case E.MediaTemplateType.BANDWIDTH:e=s(e,t,n);break;case E.MediaTemplateType.TIME:e=s(e,t,i)}})),e},b={TagTypes:{BASE_URL:"BaseURL",SEGMENT_TEMPLATE:"SegmentTemplate",REPRESENTATION:"Representation",ESSENTIAL_PROPERTY:"EssentialProperty",ADAPTATION_SET:"AdaptationSet"},AttributeTypes:{BASE_URL:"BaseURL",ID:"id",CONTENT_TYPE:"contentType",MIME_TYPE:"mimeType",MEDIA:"media",DURATION:"duration",START_NUMBER:"startNumber",TIMESCALE:"timescale",PRESENTATION_TIME_OFFSET:"presentationTimeOffset",END_NUMBER:"endNumber",BANDWIDTH:"bandwidth",WIDTH:"width",HEIGHT:"height",SCHEME_ID_URI:"schemeIdUri",VALUE:"value"}},S={parseXml:function(e){return(new DOMParser).parseFromString(e,"text/xml")},parseAttr:function(e,t,r,a){var n=null,i=e.getAttribute(t);return null!==i&&(n=r?r(i):i),null==n?a:n},findElements:function(e,t){return e.getElementsByTagName(t)},findChild:function(e,t){var r=this.findChildren(e,t);return 1!==r.length?null:r[0]},findChildren:function(e,t){return Array.from(e.childNodes).filter((function(e){return e instanceof Element&&e.tagName===t}))},parseInt:function(e){var t=Number(e);return t%1==0?t:null},parsePositiveInt:function(e){var t=Number(e);return t%1==0&&t>0?t:null},parseFloat:function(e){var t=Number(e);return isNaN(t)?null:t}};function A(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var C=function(){function e(e){this._schemeIdUri=S.parseAttr(e,b.AttributeTypes.SCHEME_ID_URI),this._value=S.parseAttr(e,b.AttributeTypes.VALUE)}var t,r;return t=e,(r=[{key:"schemeIdUri",get:function(){return this._schemeIdUri}},{key:"value",get:function(){return this._value}}])&&A(t.prototype,r),e}();function P(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var w=function(){function e(e){this._id=S.parseAttr(e,b.AttributeTypes.ID),this._bandwidth=S.parseAttr(e,b.AttributeTypes.BANDWIDTH,parseInt),this._width=S.parseAttr(e,b.AttributeTypes.WIDTH,parseInt),this._height=S.parseAttr(e,b.AttributeTypes.HEIGHT,parseInt);var t=S.findChild(e,b.TagTypes.ESSENTIAL_PROPERTY);t&&(this._essentialProperty=new C(t))}var t,r;return t=e,(r=[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"id",get:function(){return this._id}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"essentialProperty",get:function(){return this._essentialProperty}}])&&P(t.prototype,r),e}();function x(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var I=function(){function e(e){this._id=S.parseAttr(e,b.AttributeTypes.ID),this._mimeType=S.parseAttr(e,b.AttributeTypes.MIME_TYPE),this._contentType=S.parseAttr(e,b.AttributeTypes.CONTENT_TYPE),this._representations=Array.from(S.findChildren(e,b.TagTypes.REPRESENTATION)).map((function(e){return new w(e)}));var t=S.findChild(e,b.TagTypes.SEGMENT_TEMPLATE);t&&(this._segmentTemplate=new E(t));var r=S.findChild(e,b.TagTypes.ESSENTIAL_PROPERTY);r&&(this._essentialProperty=new C(r))}var t,r;return t=e,(r=[{key:"id",get:function(){return this._id}},{key:"mimeType",get:function(){return this._mimeType}},{key:"contentType",get:function(){return this._contentType}},{key:"segmentTemplate",get:function(){return this._segmentTemplate}},{key:"essentialProperty",get:function(){return this._essentialProperty}},{key:"representations",get:function(){return this._representations}}])&&x(t.prototype,r),e}();function M(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(I,"ContentType",{VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"});var R=function(){function e(e){var t,r=this;D(this,"_logger",Object(c.getLogger)("DashManifestParser")),D(this,"_parseAdaptionSets",(function(){var e=S.findElements(r._xmlDoc,b.TagTypes.BASE_URL);e&&e.length>0&&e[0].innerHTML&&(r._baseURL=e[0].textContent);var t=S.findElements(r._xmlDoc,b.TagTypes.ADAPTATION_SET),a=Array.from(t).filter((function(e){return S.parseAttr(e,b.AttributeTypes.CONTENT_TYPE)===I.ContentType.IMAGE}));a.length>0?(r._adaptationSets=a.map((function(e){return new I(e)})),r._logger.debug("Found image adaptation set",r._adaptationSets)):r._logger.debug("No image adaptations were found in manifest")})),this._logger.debug("Initialize manifest parser"),this._adaptationSets=[],(t=e instanceof ArrayBuffer?function(e){return TextDecoder?(new TextDecoder).decode(new Uint8Array(e)):null}(e):e)&&(this._xmlDoc=S.parseXml(t))}e.isValid=function(){return window.TextEncoder&&window.TextDecoder};var t,r,a=e.prototype;return a.parseManifest=function(){try{this._logger.debug("Start parsing dash manifest"),this._parseAdaptionSets(),this._logger.debug("Manifest parsing finished successfully")}catch(e){this._logger.warn("Manifest parsing failed",e)}},a.getBaseUrl=function(){return this._baseURL||""},a.getImageSet=function(){return this._adaptationSets.find((function(e){return e.contentType===I.ContentType.IMAGE}))},a.hasImageSet=function(){return!!this.getImageSet()},t=e,(r=[{key:"adaptationSets",get:function(){return this._adaptationSets}}])&&M(t.prototype,r),e}();function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var L=function(){function e(e,t,r){var a=this;O(this,"_tracks",[]),O(this,"_parseTracks",(function(e,t,r){var n=e.representations,i=e.segmentTemplate,o=e.essentialProperty;n.forEach((function(e,n){var s=e.id,l=e.bandwidth,u=e.width,d=e.height,p=i.startNumber,h=i.duration,f=i.media,g=i.timescale,y=i.presentationTimeOffset,m=a._getEssentialValue(o,e),v=a._getDimensions(m),_=v[0],k=v[1];a._tracks.push(new c.ImageTrack({id:s,index:n,active:!1,width:u,height:d,duration:h,rows:_,cols:k,url:a._buildTemplateUrl(f,s,t,r),customData:{bitrate:l,startNumber:p,timescale:g,presentationTimeOffset:y}}))}))})),O(this,"_getDimensions",(function(e){var t=1,r=1;if(e.includes("x")){var a=e.split("x");r=parseInt(a[0]),t=parseInt(a[1])}return[t,r]})),O(this,"_getEssentialValue",(function(e,t){return e?e.value:t.essentialProperty?t.essentialProperty.value:""})),O(this,"_buildTemplateUrl",(function(e,t,r,a){var n=r.split("/").pop(),i=r.replace(n,"");return(a=a.replace(/^\.\/|^\./,"")).length>0&&!a.endsWith("/")&&(a+="/"),T(""+i+a+e,{id:t})})),O(this,"_buildUrlFromTemplate",(function(e,t){return T(e.url,{index:t,time:(t-1)*e.duration*e.customData.timescale,bitrate:e.customData.bitrate})})),this._parseTracks(e,t,r),this._tracks.length>0&&(this._tracks.sort((function(e,t){return e.customData.bitrate-t.customData.bitrate})),this.selectTrack(this._tracks[this._tracks.length-1]))}var t=e.prototype;return t.selectTrack=function(e){this._tracks.forEach((function(t){return t.index===e.index?t.active=!0:t.active=!1}))},t.getTracks=function(){return this._tracks},t.getActiveTrack=function(){return this._tracks.find((function(e){return e.active}))},t.getThumbnail=function(e){var t=this.getActiveTrack(),r=t.duration,a=t.rows,n=t.cols,i=t.sliceWidth,o=t.sliceHeight,s=t.customData,l=Math.floor(e/r)+s.startNumber,u=e%r,d=Math.floor(u*a*n/r);return new c.ThumbnailInfo({width:Math.floor(i),height:Math.floor(o),x:Math.floor(d%n)*i,y:Math.floor(d/n)*o,url:this._buildUrlFromTemplate(t,l)})},e}();function N(e,t,r,a,n,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function U(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var i=e.apply(t,r);function o(e){N(i,a,n,o,s,"next",e)}function s(e){N(i,a,n,o,s,"throw",e)}o(void 0)}))}}function F(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function j(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var H="error",G="adaptation",K="buffering",W="drmsessionupdate",z="emsg",q=function(e){var t,r;r=e,(t=o).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,o.createAdapter=function(e,t,r){var a=c.Utils.Object.copyDeep(g);if(c.Utils.Object.hasPropertyPath(r,"text.useNativeTextTrack")&&(a.textTrackVisibile=c.Utils.Object.getPropertyPath(r,"text.useNativeTextTrack")),c.Utils.Object.hasPropertyPath(r,"text.useShakaTextTrackDisplay")&&(a.useShakaTextTrackDisplay=c.Utils.Object.getPropertyPath(r,"text.useShakaTextTrackDisplay"),a.textTrackVisibile=a.textTrackVisibile||a.useShakaTextTrackDisplay),c.Utils.Object.hasPropertyPath(r,"streaming")){var n=r.streaming;"boolean"==typeof n.forceBreakStall&&(a.forceBreakStall=n.forceBreakStall),"boolean"==typeof n.lowLatencyMode&&(a.lowLatencyMode=n.lowLatencyMode),"boolean"==typeof n.trackEmsgEvents&&(a.trackEmsgEvents=n.trackEmsgEvents),"boolean"==typeof n.switchDynamicToStatic&&(a.switchDynamicToStatic=n.switchDynamicToStatic)}if(c.Utils.Object.hasPropertyPath(r,"sources.options")){var i=r.sources.options;a.forceRedirectExternalStreams=i.forceRedirectExternalStreams,a.redirectExternalStreamsHandler=i.redirectExternalStreamsHandler,a.redirectExternalStreamsTimeout=i.redirectExternalStreamsTimeout}if(c.Utils.Object.hasPropertyPath(r,"abr")){var o=r.abr;"boolean"==typeof o.enabled&&(a.shakaConfig.abr.enabled=o.enabled),"boolean"==typeof o.capLevelToPlayerSize&&(a.capLevelToPlayerSize=o.capLevelToPlayerSize),o.defaultBandwidthEstimate&&(a.shakaConfig.abr.defaultBandwidthEstimate=o.defaultBandwidthEstimate),o.restrictions&&c.Utils.Object.createPropertyPath(a,"abr.restrictions",o.restrictions)}return c.Utils.Object.hasPropertyPath(r,"playback.options.html5.dash")&&(c.Utils.Object.mergeDeep(a.shakaConfig,r.playback.options.html5.dash),c.Utils.Object.hasPropertyPath(a.shakaConfig,"manifest.dash.defaultPresentationDelay")&&(a.shakaConfig.manifest.defaultPresentationDelay=a.shakaConfig.manifest.dash.defaultPresentationDelay,delete a.shakaConfig.manifest.dash.defaultPresentationDelay)),a.network=r.network,new this(e,t,a)},o.canPlayType=function(e){var t="string"==typeof e&&e.toLowerCase()===o._dashMimeType&&o.isMSESupported();return o._logger.debug("canPlayType result for mimeType: "+e+" is "+t.toString()),t};var a,n,i=o.prototype;function o(t,r,a){var n,i;return void 0===a&&(a={}),o._logger.debug("Creating adapter. Shaka version: "+p.a.Player.version),$(V(i=e.call(this,t,r,a)||this),"_shakaLib",p.a),$(V(i),"_adapterEventsBindings",((n={})[H]=function(e){return i._onError(e)},n[G]=function(){return i._onAdaptation()},n[K]=function(e){return i._onBuffering(e)},n[W]=function(){return i._onDrmSessionUpdate()},n[z]=function(e){return i._onEmsg(e)},n[c.EventType.WAITING]=function(){return i._onWaiting()},n[c.EventType.PLAYING]=function(){return i._onPlaying()},n)),$(V(i),"_buffering",!1),$(V(i),"_waitingSent",!1),$(V(i),"_playingSent",!1),$(V(i),"_videoSizeUpdateTimer",null),$(V(i),"_stallInterval",null),$(V(i),"VIDEO_ERROR_CODE",3016),$(V(i),"_lastTimeDetach",NaN),$(V(i),"_requestFilterError",!1),$(V(i),"_responseFilterError",!1),$(V(i),"_isDestroyInProgress",!1),$(V(i),"_isStartOver",!0),$(V(i),"_seekRangeStart",0),$(V(i),"_isLive",!1),$(V(i),"_isStaticLive",!1),$(V(i),"_selectedVideoTrack",null),i._config=c.Utils.Object.mergeDeep({},g,i._config),i._init(),i}return i.setMaxBitrate=function(e){this._hasLowerOrEqualBitrate(e)&&this._shaka.configure({abr:{restrictions:{maxBandwidth:e}}})},i._getSortedTracks=function(){return this._shaka.getVariantTracks().map((function(e){return{id:e.id,bandwidth:e.bandwidth,active:e.active}})).sort((function(e,t){return e.bandwidth-t.bandwidth}))},i._hasLowerOrEqualBitrate=function(e){return this._getSortedTracks()[0].bandwidth<=e},o.canPlayDrm=function(e,t){o._availableDrmProtocol=[];for(var r,a=F(o._drmProtocols);!(r=a()).done;){var n=r.value;if(n.isConfigured(e,t)){o._availableDrmProtocol.push(n);break}}if(!o._availableDrmProtocol.length)for(var i,s=F(o._drmProtocols);!(i=s()).done;){var l=i.value;l.canPlayDrm(e)&&o._availableDrmProtocol.push(l)}return!!o._availableDrmProtocol.length},o.isSupported=function(){var e=!1;window.VTTCue||(e=!0),p.a.polyfill.installAll();var t=p.a.Player.isBrowserSupported();return e&&(window.VTTCue=void 0),o._logger.debug("isSupported:"+t),t},i._init=function(){p.a.polyfill.installAll(),this._shaka=new p.a.Player,this._config.useShakaTextTrackDisplay&&this._shaka.setVideoContainer(c.Utils.Dom.getElementBySelector(".playkit-subtitles")),this._maybeSetFilters(),this._maybeSetDrmConfig(),this._maybeBreakStalls(),this._shaka.configure(this._config.shakaConfig),this._addBindings()},i._clearStallInterval=function(){this._stallInterval&&(clearInterval(this._stallInterval),this._stallInterval=null)},i._stallHandler=function(){var e=this;this._clearStallInterval();var t=function(){return Date.now()/1e3},r=t(),a=this._videoElement.currentTime;this._stallInterval=setInterval((function(){t()-r>3&&!e._videoElement.paused&&(a===e._videoElement.currentTime&&(o._logger.debug("stall found, break the stall"),e._videoElement.currentTime=parseFloat(e._videoElement.currentTime.toFixed(1))+.1),e._clearStallInterval()),a=e._videoElement.currentTime}),500)},i._maybeBreakStalls=function(){var e=this;this._config.forceBreakStall&&this._eventManager.listen(this._videoElement,c.EventType.SEEKING,(function(){return e._stallHandler()}))},i._maybeGetRedirectedUrl=function(e){var t=this._config.forceRedirectExternalStreams,r=this._config.redirectExternalStreamsTimeout,a=this._config.redirectExternalStreamsHandler;return new Promise((function(n){if(!t)return n(e);c.Utils.Http.jsonp(e,a,{timeout:r}).then((function(e){n(e)})).catch((function(){return n(e)}))}))},i._maybeSetFilters=function(){var e=this;"function"==typeof c.Utils.Object.getPropertyPath(this._config,"network.requestFilter")&&(o._logger.debug("Register request filter"),this._shaka.getNetworkingEngine().registerRequestFilter((function(t,r){if(Object.values(c.RequestType).includes(t)){var a,n={url:r.uris[0],body:r.body,headers:r.headers};try{a=e._config.network.requestFilter(t,n)}catch(e){a=Promise.reject(e)}return(a=a||Promise.resolve(n)).then((function(e){r.uris=[e.url],r.headers=e.headers,"boolean"==typeof e.withCredentials&&(r.allowCrossSiteCredentials=e.withCredentials),"POST"===r.method?r.body=e.body:e.body&&o._logger.warn("Request with "+r.method+" method cannot have body")})).catch((function(t){throw e._requestFilterError=!0,t}))}}))),"function"==typeof c.Utils.Object.getPropertyPath(this._config,"network.responseFilter")&&(o._logger.debug("Register response filter"),this._shaka.getNetworkingEngine().registerResponseFilter((function(t,r){if(Object.values(c.RequestType).includes(t)){var a,n=r.uri,i=r.data,o=r.headers,s={url:n,originalUrl:e._sourceObj.url,data:i,headers:o};try{a=e._config.network.responseFilter(t,s)}catch(e){a=Promise.reject(e)}return(a=a||Promise.resolve(s)).then((function(e){r.data=e.data})).catch((function(t){throw e._responseFilterError=!0,t}))}})))},i._maybeSetDrmConfig=function(){if(this._sourceObj&&this._sourceObj.drmData)for(var e,t={},r=F(o._availableDrmProtocol);!(e=r()).done;)e.value.setDrmPlayback(t,this._sourceObj.drmData),this._config.shakaConfig.drm&&c.Utils.Object.mergeDeep(t.drm,this._config.shakaConfig.drm),c.Utils.Object.mergeDeep(this._config.shakaConfig,t)},i._maybeCapLevelToPlayerSize=function(){var e=this;if(this._config.capLevelToPlayerSize){var t=function(){return{minHeight:0,maxHeight:e._videoHeight,minWidth:0,maxWidth:e._videoWidth,minBitrate:0,maxBitrate:1/0}};this._clearVideoUpdateTimer(),this._videoSizeUpdateTimer=setInterval((function(){return e._updateRestriction(t())}),1e3),this._updateRestriction(t())}},i._maybeApplyAbrRestrictions=function(){this._config.capLevelToPlayerSize||(this._clearVideoUpdateTimer(),c.Utils.Object.hasPropertyPath(this._config,"abr.restrictions")&&this._updateRestriction(this._config.abr.restrictions))},i._updateRestriction=function(e){var t=this._getRestrictionShakaConfig(e);this._shaka.configure({abr:{restrictions:t}})},i._getRestrictionShakaConfig=function(e){var t=this,r=function(e){var r=t._getVideoTracks();return Math.min.apply(null,r.map((function(t){return t[e]})))},a={};if(e){var n=e.maxHeight,i=e.maxWidth,s=e.maxBitrate,l=e.minHeight,u=e.minWidth,c=e.minBitrate,d=Math.max(l,0),p=Math.max(n,r("height"));p>=d?(a.minHeight=d,a.maxHeight=p):o._logger.warn("Invalid maxHeight restriction, maxHeight must be greater than minHeight",l,n);var h=Math.max(u,0),f=Math.max(i,r("width"));f>=h?(a.minWidth=h,a.maxWidth=f):o._logger.warn("Invalid maxWidth restriction, maxWidth must be greater than minWidth",u,i);var g=Math.max(c,0),y=Math.max(s,r("bandwidth"));y>=g?(a.minBandwidth=g,a.maxBandwidth=y):o._logger.warn("Invalid maxBitrate restriction, maxBitrate must be greater than minBitrate",c,s)}return a},i.attachMediaSource=function(){this._shaka||(this._videoElement&&this._videoElement.src&&(c.Utils.Dom.setAttribute(this._videoElement,"src",""),c.Utils.Dom.removeAttribute(this._videoElement,"src")),this._init())},i.detachMediaSource=function(){var e=this;return this._shaka?(0===Math.floor(this.duration-this.currentTime)?this._lastTimeDetach=0:this.currentTime>0&&(this._lastTimeDetach=this.currentTime),this._reset().then((function(){e._shaka=null,e._loadPromise=null}))):Promise.resolve()},i._clearVideoUpdateTimer=function(){this._videoSizeUpdateTimer&&(clearInterval(this._videoSizeUpdateTimer),this._videoSizeUpdateTimer=null)},i._addBindings=function(){var e=this;this._eventManager.listen(this._shaka,G,this._adapterEventsBindings.adaptation),this._eventManager.listen(this._shaka,H,this._adapterEventsBindings.error),this._eventManager.listen(this._shaka,W,this._adapterEventsBindings.drmsessionupdate),this._eventManager.listen(this._videoElement,c.EventType.WAITING,this._adapterEventsBindings.waiting),this._eventManager.listen(this._videoElement,c.EventType.PLAYING,this._adapterEventsBindings.playing),this._eventManager.listen(this._videoElement,c.EventType.LOADED_DATA,(function(){return e._onLoadedData()})),this._eventManager.listenOnce(this._videoElement,c.EventType.PLAYING,(function(){e._eventManager.listen(e._shaka,K,e._adapterEventsBindings.buffering)})),this._config.trackEmsgEvents&&this._eventManager.listen(this._shaka,z,this._adapterEventsBindings.emsg),this._shaka.getNetworkingEngine().registerResponseFilter((function(t,r){switch(t){case p.a.net.NetworkingEngine.RequestType.SEGMENT:e._trigger(c.EventType.FRAG_LOADED,{miliSeconds:r.timeMs,bytes:r.data.byteLength,url:r.uri}),e.isLive()&&e._dispatchNativeEvent(c.EventType.DURATION_CHANGE);break;case p.a.net.NetworkingEngine.RequestType.MANIFEST:e._parseManifest(r.data),e._playbackActualUri=r.uri,e._trigger(c.EventType.MANIFEST_LOADED,{miliSeconds:r.timeMs}),setTimeout((function(){var t,a;e._isLive=e._isLive||(null==(t=e._shaka)?void 0:t.isLive()),e._isLive&&!(null==(a=e._shaka)?void 0:a.isLive())&&!e._isStaticLive&&e._config.switchDynamicToStatic&&(e._sourceObj.url=r.uri,e._switchFromDynamicToStatic())}))}}))},i._onLoadedData=function(){var e=this;this._setLowLatencyMode();var t=this.getSegmentDuration();this._seekRangeStart=this._shaka.seekRange().start,this._startOverTimeout=setTimeout((function(){e._shaka.seekRange().start-e._seekRangeStart>=t&&(e._isStartOver=!1)}),1e3*(t+1))},i._switchFromDynamicToStatic=function(){var e=U(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o._logger.info("Switching from dynamic manifest to static"),this._dispatchNativeEvent(c.EventType.WAITING),t=this._videoElement.currentTime-this._seekRangeStart,r=this.isAdaptiveBitrateEnabled(),a=this._videoElement.paused,e.next=7,this.detachMediaSource();case 7:return this._isStaticLive=!0,this._isLive=!0,this.attachMediaSource(),e.next=12,this.load();case 12:this._videoElement.currentTime=t,a||this._videoElement.play(),r?this._onAdaptation():this._selectedVideoTrack&&this.selectVideoTrack(this._selectedVideoTrack);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._setLowLatencyMode=function(){this._shaka.configure({streaming:{lowLatencyMode:"boolean"==typeof this._config.lowLatencyMode?this._config.lowLatencyMode:this.isLive()}})},i._parseManifest=function(e){!this._manifestParser&&R.isValid()&&(o._logger.debug("Creating parser for the first time"),this._manifestParser=new R(e),this._manifestParser.parseManifest())},i.load=function(){var e=U(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._loadPromise){e.next=5;break}return e.next=3,this._removeMediaKeys();case 3:this._shaka.attach(this._videoElement),this._loadPromise=new Promise((function(e,a){if(r._sourceObj&&r._sourceObj.url){r._trigger(c.EventType.ABR_MODE_CHANGED,{mode:r.isAdaptiveBitrateEnabled()?"auto":"manual"});var n=t&&t>-1?t:void 0;n=isNaN(r._lastTimeDetach)?n:r._lastTimeDetach,r._lastTimeDetach=NaN,r._maybeGetRedirectedUrl(r._sourceObj.url).then((function(e){return r._shaka.load(e,n)})).then((function(){var t={tracks:r._getParsedTracks()};r._maybeCapLevelToPlayerSize(),o._logger.debug("The source has been loaded successfully"),e(t)})).catch((function(e){a(new c.Error(r._isDestroyInProgress?c.Error.Severity.RECOVERABLE:e.severity,e.category,e.code,e.data))}))}}));case 5:return e.abrupt("return",this._loadPromise);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.destroy=function(){var t=this;return this._isDestroyInProgress=!0,new Promise((function(r,a){e.prototype.destroy.call(t).then((function(){o._logger.debug("destroy"),t._loadPromise=null,t._adapterEventsBindings={},t._reset().then((function(e){t._isDestroyInProgress=!1,r(e)})).catch((function(e){t._isDestroyInProgress=!1,a(e)}))}))}))},i.getThumbnail=function(e){if(this._thumbnailController)return this._thumbnailController.getThumbnail(e)},i._reset=function(){return this._buffering=!1,this._waitingSent=!1,this._playingSent=!1,this._isLive=!1,this._isStaticLive=!1,this._requestFilterError=!1,this._responseFilterError=!1,this._manifestParser=null,this._thumbnailController=null,this._clearStallInterval(),this._clearVideoUpdateTimer(),clearTimeout(this._startOverTimeout),this._eventManager&&this._eventManager.removeAll(),this._shaka?this._shaka.destroy():Promise.resolve()},i._removeMediaKeys=function(){var e=U(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._videoElement||!this._videoElement.mediaKeys){e.next=16;break}return e.prev=1,o._logger.debug("Removing mediaKeys from the video element"),e.next=5,this._videoElement.setMediaKeys(null);case 5:o._logger.debug("mediaKeys removed"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this._logger.warn("mediaKeys not cleared");case 11:return e.prev=11,e.abrupt("return",Promise.resolve());case 14:e.next=17;break;case 16:return e.abrupt("return",Promise.resolve());case 17:case"end":return e.stop()}}),e,this,[[1,8,11,14]])})));return function(){return e.apply(this,arguments)}}(),i._getVideoTracks=function(){var e=this._shaka.getVariantTracks(),t=this._getActiveTrack();return e.filter((function(e){return e.audioId===t.audioId}))},i._getActiveTrack=function(){return this._shaka.getVariantTracks().find((function(e){return e.active}))},i._getAudioTracks=function(){var e=this._shaka.getVariantTracks(),t=this._shaka.getAudioLanguagesAndRoles();return t.forEach((function(t){var r=e.filter((function(e){return e.language===t.language})),a=r.map((function(e){return e.id})).join("_"),n=r.some((function(e){return e.active}));t.id=a,t.label=r[0].label,t.active=n})),t},i._getParsedTracks=function(){if(this._shaka){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),r=this._getParsedTextTracks(),a=this._getParsedImageTracks();return e.concat(t).concat(r).concat(a)}return[]},i._getParsedVideoTracks=function(){var e=this._getVideoTracks(),t=[];if(e)for(var r=0;r<e.length;r++){var a={id:e[r].id,bandwidth:e[r].videoBandwidth||e[r].bandwidth,width:e[r].width,height:e[r].height,active:e[r].active,index:r};t.push(new c.VideoTrack(a))}return t},i._getParsedAudioTracks=function(){var e=this._getAudioTracks(),t=[];if(e)for(var r=0;r<e.length;r++){var a={id:e[r].id,active:e[r].active,label:e[r].label,language:e[r].language,index:r};t.push(new c.AudioTrack(a))}return t},i._getParsedTextTracks=function(){for(var e,t=[],r=F(this._shaka.getTextTracks());!(e=r()).done;){var a=e.value,n=a.kind?a.kind+"s":"";n=""===n&&this._config.useShakaTextTrackDisplay?"captions":n;var i={id:a.id,kind:n,active:!1,default:a.primary,label:a.label,language:a.language};t.push(new c.TextTrack(i))}return t},i._getParsedImageTracks=function(){var e,t,r=null==(e=this._manifestParser)?void 0:e.getImageSet(),a=(null==(t=this._manifestParser)?void 0:t.getBaseUrl())||"";return r?(this._thumbnailController=new L(r,this._playbackActualUri,a),this._thumbnailController.getTracks()):[]},i.selectVideoTrack=function(e){if(this._shaka){var t=this._getVideoTracks();if(e instanceof c.VideoTrack&&t){var r=t[e.index];r&&(this.isAdaptiveBitrateEnabled()&&(this._shaka.configure({abr:{enabled:!1}}),this._trigger(c.EventType.ABR_MODE_CHANGED,{mode:"manual"})),r.active||(this._selectedVideoTrack=e,this._shaka.selectVariantTrack(t[e.index],!0),this._onTrackChanged(e)))}}},i.selectAudioTrack=function(e){this._shaka&&e instanceof c.AudioTrack&&!e.active&&(this._shaka.selectAudioLanguage(e.language),this._onTrackChanged(e))},i.selectTextTrack=function(e){this._shaka&&e instanceof c.TextTrack&&!e.active&&("subtitles"===e.kind||"captions"===e.kind)&&(this._shaka.setTextTrackVisibility(this._config.textTrackVisibile),this._shaka.selectTextLanguage(e.language),this._onTrackChanged(e))},i.selectImageTrack=function(e){this._shaka&&this._thumbnailController&&e instanceof c.ImageTrack&&!e.active&&(this._thumbnailController.selectTrack(e),this._onTrackChanged(c.ImageTrack))},i.hideTextTrack=function(){this._shaka&&this._shaka.setTextTrackVisibility(!1)},i.enableAdaptiveBitrate=function(){this._shaka&&!this.isAdaptiveBitrateEnabled()&&(this._trigger(c.EventType.ABR_MODE_CHANGED,{mode:"auto"}),this._shaka.configure({abr:{enabled:!0}}))},i.isAdaptiveBitrateEnabled=function(){return!!this._shaka&&this._shaka.getConfiguration().abr.enabled},i.applyABRRestriction=function(e){if(c.Utils.Object.createPropertyPath(this._config,"abr.restrictions",e),this._maybeApplyAbrRestrictions(),!this.isAdaptiveBitrateEnabled()){var t=this._getParsedVideoTracks(),r=Object(c.filterTracksByRestriction)(t,this._config.abr.restrictions);r.length&&(r.find((function(e){return e.active}))||this.selectVideoTrack(r[0]))}},i._getLiveEdge=function(){return this._shaka?this._shaka.seekRange().end:NaN},i.seekToLiveEdge=function(){this._shaka&&this._videoElement.readyState>0&&(this._videoElement.currentTime=this._getLiveEdge())},i.isLive=function(){var e;return(null==(e=this._shaka)?void 0:e.isLive())||this._isLive},i.getSegmentDuration=function(){return this._shaka?this._shaka.getStats().maxSegmentDuration:0},i._onAdaptation=function(){var e=this._getParsedVideoTracks().find((function(e){return e.active}));this._onTrackChanged(e)},i._onError=function(e){if(e&&e.detail){var t=e.detail;if(t.code===this.VIDEO_ERROR_CODE)return;(this._requestFilterError||this._responseFilterError)&&t.data[0]instanceof p.a.util.Error&&(t=t.data[0],this._requestFilterError?this._requestFilterError=!1:this._responseFilterError=!1),this._trigger(c.EventType.ERROR,new c.Error(t.severity,t.category,t.code,t.data)),o._logger.error(t),t.severity===c.Error.Severity.CRITICAL&&this.destroy()}},i._onBuffering=function(e){e.buffering?this._waitingSent||(this._dispatchNativeEvent(c.EventType.WAITING),this._buffering=!0):(this._buffering=!1,this._videoElement.paused||this._playingSent||this._dispatchNativeEvent(c.EventType.PLAYING))},i._dispatchNativeEvent=function(e){var t;"function"==typeof window.Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),this._videoElement.dispatchEvent(t)},i._onDrmSessionUpdate=function(){this._trigger(c.EventType.DRM_LICENSE_LOADED,{licenseTime:this._shaka.getStats().licenseTime,scheme:this._shaka.drmInfo().keySystem})},i._onEmsg=function(e){var t=e.detail,r=e.type,a=Array.from(this._videoElement.textTracks).find((function(e){return e.label===r}));a||(a=this._videoElement.addTextTrack(c.TextTrack.KIND.METADATA,r));var n=t.startTime,i=t.endTime,o=t.id,s=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(t,["startTime","endTime","id"]),l=new c.TimedMetadata(n,i,o,c.TimedMetadata.TYPE.EMSG,s),u=Object(c.createTextTrackCue)(l);a.addCue(u),this._trigger(c.EventType.TIMED_METADATA_ADDED,{cues:[l]})},i._onWaiting=function(){this._waitingSent=!0,this._playingSent=!1},i._onPlaying=function(){this._playingSent=!0,this._waitingSent=!1,this._buffering&&this._dispatchNativeEvent(c.EventType.WAITING)},i.getStartTimeOfDvrWindow=function(){return this.isLive()&&this._shaka?(this._isStartOver?this._seekRangeStart:this._shaka.seekRange().start)+this._shaka.getConfiguration().streaming.safeSeekOffset:0},i.getDrmInfo=function(){var e=this._shaka.drmInfo();if(e){var t=e.licenseServerUri,r=e.keySystem,a=e.serverCertificateUri,n={licenseUrl:t,scheme:r};return a&&(n.certificate=a),n}return null},a=o,(n=[{key:"_videoWidth",get:function(){var e,t=this._videoElement;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=this._contentScaleFactor),e}},{key:"_videoHeight",get:function(){var e,t=this._videoElement;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=this._contentScaleFactor),e}},{key:"_contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){o._logger.debug("failed reading devicePixelRatio, assume 1")}return e}},{key:"liveDuration",get:function(){return this._getLiveEdge()}},{key:"targetBuffer",get:function(){var e=NaN;return this._shaka?(e=this.isLive()?this._getLiveEdge()-this._videoElement.currentTime:this._videoElement.duration-this._videoElement.currentTime,e=Math.min(e,this._shaka.getConfiguration().streaming.bufferingGoal+this._shaka.getStats().maxSegmentDuration)):NaN}}])&&j(a.prototype,n),o}(c.BaseMediaSourceAdapter);$(q,"id","DashAdapter"),$(q,"_logger",c.BaseMediaSourceAdapter.getLogger(q.id)),$(q,"_dashMimeType","application/dash+xml"),$(q,"_drmProtocols",[h,f]),$(q,"_availableDrmProtocol",[]);var Y="1.33.1",X="@playkit-js/playkit-js-dash";t.default=q,q.isSupported()&&Object(c.registerMediaSourceAdapter)(q)}]))},function(module,exports,__webpack_require__){(function(global){
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
!function(){var innerGlobal="undefined"!=typeof window?window:global,exportTo={};for(var k in function(window,global,module){var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.ISOLATE_POLYFILLS=!1,$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},$jscomp.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},$jscomp.global=$jscomp.getGlobal(this),$jscomp.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE,$jscomp.polyfills={},$jscomp.propertyToPolyfillSymbol={},$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(e,t){var r=$jscomp.propertyToPolyfillSymbol[t];return null==r?e[t]:void 0!==(r=e[r])?r:e[t]};$jscomp.polyfill=function(e,t,r,a){t&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(e,t,r,a):$jscomp.polyfillUnisolated(e,t,r,a))},$jscomp.polyfillUnisolated=function(e,t,r,a){for(r=$jscomp.global,e=e.split("."),a=0;a<e.length-1;a++){var n=e[a];if(!(n in r))return;r=r[n]}(t=t(a=r[e=e[e.length-1]]))!=a&&null!=t&&$jscomp.defineProperty(r,e,{configurable:!0,writable:!0,value:t})},$jscomp.polyfillIsolated=function(e,t,r,a){var n=e.split(".");e=1===n.length,a=n[0],a=!e&&a in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var i=0;i<n.length-1;i++){var o=n[i];if(!(o in a))return;a=a[o]}n=n[n.length-1],null!=(t=t(r=$jscomp.IS_SYMBOL_NATIVE&&"es6"===r?a[n]:null))&&(e?$jscomp.defineProperty($jscomp.polyfills,n,{configurable:!0,writable:!0,value:t}):t!==r&&(void 0===$jscomp.propertyToPolyfillSymbol[n]&&(r=1e9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[n]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(n):$jscomp.POLYFILL_PREFIX+r+"$"+n),$jscomp.defineProperty(a,$jscomp.propertyToPolyfillSymbol[n],{configurable:!0,writable:!0,value:t})))},$jscomp.initSymbol=function(){},$jscomp.polyfill("Symbol",(function(e){if(e)return e;var t=function(e,t){this.$jscomp$symbol$id_=e,$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:t})};t.prototype.toString=function(){return this.$jscomp$symbol$id_};var r="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",a=0,n=function(e){if(this instanceof n)throw new TypeError("Symbol is not a constructor");return new t(r+(e||"")+"_"+a++,e)};return n}),"es6","es3"),$jscomp.polyfill("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<t.length;r++){var a=$jscomp.global[t[r]];"function"==typeof a&&"function"!=typeof a.prototype[e]&&$jscomp.defineProperty(a.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return e}),"es6","es3"),$jscomp.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},$jscomp.createTemplateTagFirstArg=function(e){return e.raw=e},$jscomp.createTemplateTagFirstArgWithRaw=function(e,t){return e.raw=t,e},$jscomp.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):$jscomp.arrayIterator(e)},$jscomp.arrayFromIterator=function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r},$jscomp.arrayFromIterable=function(e){return e instanceof Array?e:$jscomp.arrayFromIterator($jscomp.makeIterator(e))},$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},$jscomp.getConstructImplementation=function(){if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(function(){function e(){}return new e,Reflect.construct(e,[],(function(){})),new e instanceof e}())return Reflect.construct;var e=Reflect.construct;return function(t,r,a){return t=e(t,r),a&&Reflect.setPrototypeOf(t,a.prototype),t}}return function(e,t,r){return void 0===r&&(r=e),r=$jscomp.objectCreate(r.prototype||Object.prototype),Function.prototype.apply.call(e,r,t)||r}},$jscomp.construct=$jscomp.getConstructImplementation(),$jscomp.underscoreProtoCanBeSet=function(){var e={};try{return e.__proto__={a:!0},e.a}catch(e){}return!1},$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,$jscomp.inherits=function(e,t){if(e.prototype=$jscomp.objectCreate(t.prototype),e.prototype.constructor=e,$jscomp.setPrototypeOf){var r=$jscomp.setPrototypeOf;r(e,t)}else for(r in t)if("prototype"!=r)if(Object.defineProperties){var a=Object.getOwnPropertyDescriptor(t,r);a&&Object.defineProperty(e,r,a)}else e[r]=t[r];e.superClass_=t.prototype},$jscomp.generator={},$jscomp.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},$jscomp.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1},$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},$jscomp.generator.Context.prototype.next_=function(e){this.yieldResult=e},$jscomp.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},$jscomp.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},$jscomp.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},$jscomp.generator.Context.prototype.yieldAll=function(e,t){var r=(e=$jscomp.makeIterator(e)).next();if($jscomp.generator.ensureIteratorResultIsObject_(r),!r.done)return this.yieldAllIterator_=e,this.yield(r.value,t);this.yieldResult=r.value,this.nextAddress=t},$jscomp.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,null!=t&&(this.finallyAddress_=t)},$jscomp.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},$jscomp.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},$jscomp.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},$jscomp.generator.Context.prototype.enterFinallyBlock=function(e,t,r){r?this.finallyContexts_[r]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},$jscomp.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();null!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},$jscomp.generator.Context.prototype.forIn=function(e){return new $jscomp.generator.Context.PropertyIterator(e)},$jscomp.generator.Context.PropertyIterator=function(e){for(var t in this.object_=e,this.properties_=[],e)this.properties_.push(t);this.properties_.reverse()},$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null},$jscomp.generator.Engine_=function(e){this.context_=new $jscomp.generator.Context,this.program_=e},$jscomp.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},$jscomp.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(e){return{value:e,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},$jscomp.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},$jscomp.generator.Engine_.prototype.yieldAllStep_=function(e,t,r){try{var a=e.call(this.context_.yieldAllIterator_,t);if($jscomp.generator.ensureIteratorResultIsObject_(a),!a.done)return this.context_.stop_(),a;var n=a.value}catch(e){return this.context_.yieldAllIterator_=null,this.context_.throw_(e),this.nextStep_()}return this.context_.yieldAllIterator_=null,r.call(this.context_,n),this.nextStep_()},$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(e){this.context_.yieldResult=void 0,this.context_.throw_(e)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},$jscomp.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},$jscomp.generator.createGenerator=function(e,t){return t=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(t)),$jscomp.setPrototypeOf&&e.prototype&&$jscomp.setPrototypeOf(t,e.prototype),t},$jscomp.asyncExecutePromiseGenerator=function(e){function t(t){return e.next(t)}function r(t){return e.throw(t)}return new Promise((function(a,n){!function e(i){i.done?a(i.value):Promise.resolve(i.value).then(t,r).then(e,n)}(e.next())}))},$jscomp.asyncExecutePromiseGeneratorFunction=function(e){return $jscomp.asyncExecutePromiseGenerator(e())},$jscomp.asyncExecutePromiseGeneratorProgram=function(e){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(e)))},$jscomp.getRestArguments=function(){for(var e=Number(this),t=[],r=e;r<arguments.length;r++)t[r-e]=arguments[r];return t},$jscomp.polyfill("Reflect",(function(e){return e||{}}),"es6","es3"),$jscomp.polyfill("Reflect.construct",(function(e){return $jscomp.construct}),"es6","es3"),$jscomp.polyfill("Reflect.setPrototypeOf",(function(e){if(e)return e;if($jscomp.setPrototypeOf){var t=$jscomp.setPrototypeOf;return function(e,r){try{return t(e,r),!0}catch(e){return!1}}}return null}),"es6","es5"),$jscomp.polyfill("Promise",(function(e){function t(){this.batch_=null}function r(e){return e instanceof n?e:new n((function(t,r){t(e)}))}if(e&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&void 0===$jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return e;t.prototype.asyncExecute=function(e){if(null==this.batch_){this.batch_=[];var t=this;this.asyncExecuteFunction((function(){t.executeBatch_()}))}this.batch_.push(e)};var a=$jscomp.global.setTimeout;t.prototype.asyncExecuteFunction=function(e){a(e,0)},t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var t=0;t<e.length;++t){var r=e[t];e[t]=null;try{r()}catch(e){this.asyncThrow_(e)}}}this.batch_=null},t.prototype.asyncThrow_=function(e){this.asyncExecuteFunction((function(){throw e}))};var n=function(e){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[],this.isRejectionHandled_=!1;var t=this.createResolveAndReject_();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}};n.prototype.createResolveAndReject_=function(){function e(e){return function(a){r||(r=!0,e.call(t,a))}}var t=this,r=!1;return{resolve:e(this.resolveTo_),reject:e(this.reject_)}},n.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof n)this.settleSameAsPromise_(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}},n.prototype.resolveToNonPromiseObj_=function(e){var t=void 0;try{t=e.then}catch(e){return void this.reject_(e)}"function"==typeof t?this.settleSameAsThenable_(t,e):this.fulfill_(e)},n.prototype.reject_=function(e){this.settle_(2,e)},n.prototype.fulfill_=function(e){this.settle_(1,e)},n.prototype.settle_=function(e,t){if(0!=this.state_)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.state_);this.state_=e,this.result_=t,2===this.state_&&this.scheduleUnhandledRejectionCheck_(),this.executeOnSettledCallbacks_()},n.prototype.scheduleUnhandledRejectionCheck_=function(){var e=this;a((function(){if(e.notifyUnhandledRejection_()){var t=$jscomp.global.console;void 0!==t&&t.error(e.result_)}}),1)},n.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var e=$jscomp.global.CustomEvent,t=$jscomp.global.Event,r=$jscomp.global.dispatchEvent;return void 0===r||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=$jscomp.global.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.result_,r(e))},n.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=0;e<this.onSettledCallbacks_.length;++e)i.asyncExecute(this.onSettledCallbacks_[e]);this.onSettledCallbacks_=null}};var i=new t;return n.prototype.settleSameAsPromise_=function(e){var t=this.createResolveAndReject_();e.callWhenSettled_(t.resolve,t.reject)},n.prototype.settleSameAsThenable_=function(e,t){var r=this.createResolveAndReject_();try{e.call(t,r.resolve,r.reject)}catch(e){r.reject(e)}},n.prototype.then=function(e,t){function r(e,t){return"function"==typeof e?function(t){try{a(e(t))}catch(e){i(e)}}:t}var a,i,o=new n((function(e,t){a=e,i=t}));return this.callWhenSettled_(r(e,a),r(t,i)),o},n.prototype.catch=function(e){return this.then(void 0,e)},n.prototype.callWhenSettled_=function(e,t){function r(){switch(a.state_){case 1:e(a.result_);break;case 2:t(a.result_);break;default:throw Error("Unexpected state: "+a.state_)}}var a=this;null==this.onSettledCallbacks_?i.asyncExecute(r):this.onSettledCallbacks_.push(r),this.isRejectionHandled_=!0},n.resolve=r,n.reject=function(e){return new n((function(t,r){r(e)}))},n.race=function(e){return new n((function(t,a){for(var n=$jscomp.makeIterator(e),i=n.next();!i.done;i=n.next())r(i.value).callWhenSettled_(t,a)}))},n.all=function(e){var t=$jscomp.makeIterator(e),a=t.next();return a.done?r([]):new n((function(e,n){function i(t){return function(r){o[t]=r,0==--s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,r(a.value).callWhenSettled_(i(o.length-1),n),a=t.next()}while(!a.done)}))},n}),"es6","es3"),$jscomp.checkEs6ConformanceViaProxy=function(){try{var e={},t=Object.create(new $jscomp.global.Proxy(e,{get:function(r,a,n){return r==e&&"q"==a&&n==t}}));return!0===t.q}catch(e){return!1}},$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy(),$jscomp.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},$jscomp.polyfill("WeakMap",(function(e){function t(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function a(e){if(!$jscomp.owns(e,i)){var r=new t;$jscomp.defineProperty(e,i,{value:r})}}function n(e){if(!$jscomp.ISOLATE_POLYFILLS){var r=Object[e];r&&(Object[e]=function(e){return e instanceof t?e:(Object.isExtensible(e)&&a(e),r(e))})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),r=Object.seal({}),a=new e([[t,2],[r,3]]);return 2==a.get(t)&&3==a.get(r)&&(a.delete(t),a.set(r,4),!a.has(t)&&4==a.get(r))}catch(e){return!1}}())return e;var i="$jscomp_hidden_"+Math.random();n("freeze"),n("preventExtensions"),n("seal");var o=0,s=function(e){if(this.id_=(o+=Math.random()+1).toString(),e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};return s.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(a(e),!$jscomp.owns(e,i))throw Error("WeakMap key fail: "+e);return e[i][this.id_]=t,this},s.prototype.get=function(e){return r(e)&&$jscomp.owns(e,i)?e[i][this.id_]:void 0},s.prototype.has=function(e){return r(e)&&$jscomp.owns(e,i)&&$jscomp.owns(e[i],this.id_)},s.prototype.delete=function(e){return!!(r(e)&&$jscomp.owns(e,i)&&$jscomp.owns(e[i],this.id_))&&delete e[i][this.id_]},s}),"es6","es3"),$jscomp.MapEntry=function(){},$jscomp.polyfill("Map",(function(e){if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if($jscomp.ASSUME_NO_NATIVE_MAP||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e($jscomp.makeIterator([[t,"s"]]));if("s"!=r.get(t)||1!=r.size||r.get({x:4})||r.set({x:4},"t")!=r||2!=r.size)return!1;var a=r.entries(),n=a.next();return!n.done&&n.value[0]==t&&"s"==n.value[1]&&!((n=a.next()).done||4!=n.value[0].x||"t"!=n.value[1]||!a.next().done)}catch(e){return!1}}())return e;var t=new WeakMap,r=function(e){if(this.data_={},this.head_=i(),this.size=0,e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};r.prototype.set=function(e,t){var r=a(this,e=0===e?0:e);return r.list||(r.list=this.data_[r.id]=[]),r.entry?r.entry.value=t:(r.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:t},r.list.push(r.entry),this.head_.previous.next=r.entry,this.head_.previous=r.entry,this.size++),this},r.prototype.delete=function(e){return!(!(e=a(this,e)).entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.data_[e.id],e.entry.previous.next=e.entry.next,e.entry.next.previous=e.entry.previous,e.entry.head=null,this.size--,!0)},r.prototype.clear=function(){this.data_={},this.head_=this.head_.previous=i(),this.size=0},r.prototype.has=function(e){return!!a(this,e).entry},r.prototype.get=function(e){return(e=a(this,e).entry)&&e.value},r.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},r.prototype.keys=function(){return n(this,(function(e){return e.key}))},r.prototype.values=function(){return n(this,(function(e){return e.value}))},r.prototype.forEach=function(e,t){for(var r,a=this.entries();!(r=a.next()).done;)r=r.value,e.call(t,r[1],r[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var a=function(e,r){var a=r&&typeof r;"object"==a||"function"==a?t.has(r)?a=t.get(r):(a=""+ ++o,t.set(r,a)):a="p_"+r;var n=e.data_[a];if(n&&$jscomp.owns(e.data_,a))for(e=0;e<n.length;e++){var i=n[e];if(r!=r&&i.key!=i.key||r===i.key)return{id:a,list:n,index:e,entry:i}}return{id:a,list:n,index:-1,entry:void 0}},n=function(e,t){var r=e.head_;return $jscomp.iteratorPrototype((function(){if(r){for(;r.head!=e.head_;)r=r.previous;for(;r.next!=r.head;)return r=r.next,{done:!1,value:t(r)};r=null}return{done:!0,value:void 0}}))},i=function(){var e={};return e.previous=e.next=e.head=e},o=0;return r}),"es6","es3"),$jscomp.polyfill("Set",(function(e){if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if($jscomp.ASSUME_NO_NATIVE_SET||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e($jscomp.makeIterator([t]));if(!r.has(t)||1!=r.size||r.add(t)!=r||1!=r.size||r.add({x:4})!=r||2!=r.size)return!1;var a=r.entries(),n=a.next();return!n.done&&n.value[0]==t&&n.value[1]==t&&(!(n=a.next()).done&&n.value[0]!=t&&4==n.value[0].x&&n.value[1]==n.value[0]&&a.next().done)}catch(e){return!1}}())return e;var t=function(e){if(this.map_=new Map,e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.map_.size};return t.prototype.add=function(e){return e=0===e?0:e,this.map_.set(e,e),this.size=this.map_.size,this},t.prototype.delete=function(e){return e=this.map_.delete(e),this.size=this.map_.size,e},t.prototype.clear=function(){this.map_.clear(),this.size=0},t.prototype.has=function(e){return this.map_.has(e)},t.prototype.entries=function(){return this.map_.entries()},t.prototype.values=function(){return this.map_.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var r=this;this.map_.forEach((function(a){return e.call(t,a,a,r)}))},t}),"es6","es3"),$jscomp.findInternal=function(e,t,r){e instanceof String&&(e=String(e));for(var a=e.length,n=0;n<a;n++){var i=e[n];if(t.call(r,i,n,e))return{i:n,v:i}}return{i:-1,v:void 0}},$jscomp.polyfill("Array.prototype.findIndex",(function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).i}}),"es6","es3"),$jscomp.polyfill("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),"es6","es3"),$jscomp.polyfill("Array.prototype.includes",(function(e){return e||function(e,t){var r=this;r instanceof String&&(r=String(r));var a=r.length;for(0>(t=t||0)&&(t=Math.max(t+a,0));t<a;t++){var n=r[t];if(n===e||Object.is(n,e))return!0}return!1}}),"es7","es3"),$jscomp.checkStringArgs=function(e,t,r){if(null==e)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return e+""},$jscomp.polyfill("String.prototype.includes",(function(e){return e||function(e,t){return-1!==$jscomp.checkStringArgs(this,e,"includes").indexOf(e,t||0)}}),"es6","es3"),$jscomp.polyfill("Array.prototype.find",(function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).v}}),"es6","es3"),$jscomp.polyfill("String.prototype.startsWith",(function(e){return e||function(e,t){var r=$jscomp.checkStringArgs(this,e,"startsWith");e+="";var a=r.length,n=e.length;t=Math.max(0,Math.min(0|t,r.length));for(var i=0;i<n&&t<a;)if(r[t++]!=e[i++])return!1;return i>=n}}),"es6","es3"),$jscomp.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var r=0,a=!1,n={next:function(){if(!a&&r<e.length){var n=r++;return{value:t(n,e[n]),done:!1}}return a=!0,{done:!0,value:void 0}}};return n[Symbol.iterator]=function(){return n},n},$jscomp.polyfill("Array.prototype.keys",(function(e){return e||function(){return $jscomp.iteratorFromArray(this,(function(e){return e}))}}),"es6","es3"),$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(e,t){for(var r=1;r<arguments.length;r++){var a=arguments[r];if(a)for(var n in a)$jscomp.owns(a,n)&&(e[n]=a[n])}return e},$jscomp.polyfill("Object.assign",(function(e){return e||$jscomp.assign}),"es6","es3"),$jscomp.polyfill("Array.from",(function(e){return e||function(e,t,r){t=null!=t?t:function(e){return e};var a=[],n="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof n){e=n.call(e);for(var i=0;!(n=e.next()).done;)a.push(t.call(r,n.value,i++))}else for(n=e.length,i=0;i<n;i++)a.push(t.call(r,e[i],i));return a}}),"es6","es3"),$jscomp.polyfill("Array.prototype.values",(function(e){return e||function(){return $jscomp.iteratorFromArray(this,(function(e,t){return t}))}}),"es8","es3"),$jscomp.polyfill("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}}),"es9","es3"),$jscomp.polyfill("Array.prototype.entries",(function(e){return e||function(){return $jscomp.iteratorFromArray(this,(function(e,t){return[e,t]}))}}),"es6","es3"),$jscomp.polyfill("String.prototype.repeat",(function(e){return e||function(e){var t=$jscomp.checkStringArgs(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var r="";e;)1&e&&(r+=t),(e>>>=1)&&(t+=t);return r}}),"es6","es3"),$jscomp.polyfill("Number.isNaN",(function(e){return e||function(e){return"number"==typeof e&&isNaN(e)}}),"es6","es3"),$jscomp.polyfill("Object.values",(function(e){return e||function(e){var t,r=[];for(t in e)$jscomp.owns(e,t)&&r.push(e[t]);return r}}),"es8","es3"),$jscomp.polyfill("Math.log2",(function(e){return e||function(e){return Math.log(e)/Math.LN2}}),"es6","es3"),$jscomp.polyfill("Math.trunc",(function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}}),"es6","es3"),$jscomp.polyfill("Object.entries",(function(e){return e||function(e){var t,r=[];for(t in e)$jscomp.owns(e,t)&&r.push([t,e[t]]);return r}}),"es8","es3");var COMPILED=!0,goog=goog||{};if(goog.global=this||self,goog.exportPath_=function(e,t,r,a){e=e.split("."),a=a||goog.global,e[0]in a||void 0===a.execScript||a.execScript("var "+e[0]);for(var n;e.length&&(n=e.shift());)if(e.length||void 0===t)a=a[n]&&a[n]!==Object.prototype[n]?a[n]:a[n]={};else if(!r&&goog.isObject(t)&&goog.isObject(a[n]))for(var i in t)t.hasOwnProperty(i)&&(a[n][i]=t[i]);else a[n]=t},goog.define=function(e,t){if(!COMPILED){var r=goog.global.CLOSURE_UNCOMPILED_DEFINES,a=goog.global.CLOSURE_DEFINES;r&&void 0===r.nodeType&&Object.prototype.hasOwnProperty.call(r,e)?t=r[e]:a&&void 0===a.nodeType&&Object.prototype.hasOwnProperty.call(a,e)&&(t=a[e])}return t},goog.FEATURESET_YEAR=2012,goog.DEBUG=!0,goog.LOCALE="en",goog.getLocale=function(){return goog.LOCALE},goog.TRUSTED_SITE=!0,goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(e){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");if(!COMPILED&&goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');goog.constructNamespace_(e)},goog.constructNamespace_=function(e,t,r){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var a=e;(a=a.substring(0,a.lastIndexOf(".")))&&!goog.getObjectByName(a);)goog.implicitNamespaces_[a]=!0}goog.exportPath_(e,t,r)},goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/,goog.getScriptNonce_=function(e){return(e=(e=(e||goog.global).document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&goog.NONCE_PATTERN_.test(e)?e:""},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(e){if("string"!=typeof e||!e||-1==e.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");if(goog.moduleLoaderState_.moduleName=e,!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e]}},goog.module.get=function(e){return goog.module.getInternal_(e)},goog.module.getInternal_=function(e){if(!COMPILED){if(e in goog.loadedModules_)return goog.loadedModules_[e].exports;if(!goog.implicitNamespaces_[e])return null!=(e=goog.getObjectByName(e))?e:null}return null},goog.ModuleType={ES6:"es6",GOOG:"goog"},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()},goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG},goog.isInEs6ModuleLoader_=function(){if(goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6)return!0;var e=goog.global.$jscomp;return!!e&&("function"==typeof e.getCurrentModulePath&&!!e.getCurrentModulePath())},goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInGoogModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.declareModuleId=function(e){if(!COMPILED){if(!goog.isInEs6ModuleLoader_())throw Error("goog.declareModuleId may only be called from within an ES6 module");if(goog.moduleLoaderState_&&goog.moduleLoaderState_.moduleName)throw Error("goog.declareModuleId may only be called once per module.");if(e in goog.loadedModules_)throw Error('Module with namespace "'+e+'" already exists.')}if(goog.moduleLoaderState_)goog.moduleLoaderState_.moduleName=e;else{var t=goog.global.$jscomp;if(!t||"function"!=typeof t.getCurrentModulePath)throw Error('Module with namespace "'+e+'" has been loaded incorrectly.');t=t.require(t.getCurrentModulePath()),goog.loadedModules_[e]={exports:t,type:goog.ModuleType.ES6,moduleId:e}}},goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},goog.forwardDeclare=function(e){},COMPILED||(goog.isProvided_=function(e){return e in goog.loadedModules_||!goog.implicitNamespaces_[e]&&null!=goog.getObjectByName(e)},goog.implicitNamespaces_={"goog.module":!0}),goog.getObjectByName=function(e,t){e=e.split("."),t=t||goog.global;for(var r=0;r<e.length;r++)if(null==(t=t[e[r]]))return null;return t},goog.addDependency=function(e,t,r,a){!COMPILED&&goog.DEPENDENCIES_ENABLED&&goog.debugLoader_.addDependency(e,t,r,a)},goog.ENABLE_DEBUG_LOADER=!1,goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)},goog.require=function(e){if(!COMPILED){if(goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_.requested(e),goog.isProvided_(e)){if(goog.isInModuleLoader_())return goog.module.getInternal_(e)}else if(goog.ENABLE_DEBUG_LOADER){var t=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{goog.debugLoader_.load_(e)}finally{goog.moduleLoaderState_=t}}return null}},goog.requireType=function(e){return{}},goog.basePath="",goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.instance_=void 0,e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.TRANSPILE="detect",goog.ASSUME_ES_MODULES_TRANSPILED=!1,goog.TRUSTED_TYPES_POLICY_NAME="goog",goog.hasBadLetScoping=null,goog.loadModule=function(e){var t=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1,type:goog.ModuleType.GOOG};var r={},a=r;if("function"==typeof e)a=e.call(void 0,a);else{if("string"!=typeof e)throw Error("Invalid module definition");a=goog.loadModuleFromSource_.call(void 0,a,e)}var n=goog.moduleLoaderState_.moduleName;if("string"!=typeof n||!n)throw Error('Invalid module name "'+n+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(n,a,r!==a):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof a&&null!=a&&Object.seal(a),goog.loadedModules_[n]={exports:a,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName}}finally{goog.moduleLoaderState_=t}},goog.loadModuleFromSource_=function(a,b){return eval(goog.CLOSURE_EVAL_PREFILTER_.createScript(b)),a},goog.normalizePath_=function(e){e=e.split("/");for(var t=0;t<e.length;)"."==e[t]?e.splice(t,1):t&&".."==e[t]&&e[t-1]&&".."!=e[t-1]?e.splice(--t,2):t++;return e.join("/")},goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);try{var t=new goog.global.XMLHttpRequest;return t.open("get",e,!1),t.send(),0==t.status||200==t.status?t.responseText:null}catch(e){return null}},goog.typeOf=function(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return Object.prototype.hasOwnProperty.call(e,goog.UID_PROPERTY_)&&e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(e){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if("function"==typeof e.clone)return e.clone();if("undefined"!=typeof Map&&e instanceof Map)return new Map(e);if("undefined"!=typeof Set&&e instanceof Set)return new Set(e);for(var r in t="array"==t?[]:{},e)t[r]=goog.cloneObject(e[r]);return t}return e},goog.bindNative_=function(e,t,r){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(e,t,r){if(!e)throw Error();if(2<arguments.length){var a=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,a),e.apply(t,r)}}return function(){return e.apply(t,arguments)}},goog.bind=function(e,t,r){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}},goog.now=function(){return Date.now()},goog.globalEval=function(e){(0,eval)(e)},goog.getCssName=function(e,t){if("."==String(e).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+e);var r=function(e){return goog.cssNameMapping_[e]||e},a=function(e){e=e.split("-");for(var t=[],a=0;a<e.length;a++)t.push(r(e[a]));return t.join("-")};return a=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?r:a:function(e){return e},e=t?e+"-"+a(t):a(e),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(e):e},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.GetMsgOptions=function(){},goog.getMsg=function(e,t,r){return r&&r.html&&(e=e.replace(/</g,"&lt;")),r&&r.unescapeHtmlEntities&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),t&&(e=e.replace(/\{\$([^}]+)}/g,(function(e,r){return null!=t&&r in t?t[r]:e}))),e},goog.getMsgWithFallback=function(e,t){return e},goog.exportSymbol=function(e,t,r){goog.exportPath_(e,t,!0,r)},goog.exportProperty=function(e,t,r){e[t]=r},goog.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.base=function(e,r,a){for(var n=Array(arguments.length-2),i=2;i<arguments.length;i++)n[i-2]=arguments[i];return t.prototype[r].apply(e,n)}},goog.scope=function(e){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a module.");e.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.defineClass=function(e,t){var r=t.constructor,a=t.statics;return r&&r!=Object.prototype.constructor||(r=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),r=goog.defineClass.createSealingConstructor_(r,e),e&&goog.inherits(r,e),delete t.constructor,delete t.statics,goog.defineClass.applyProperties_(r.prototype,t),null!=a&&(a instanceof Function?a(r):goog.defineClass.applyProperties_(r,a)),r},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(e,t){return goog.defineClass.SEAL_CLASS_INSTANCES?function(){var t=e.apply(this,arguments)||this;return t[goog.UID_PROPERTY_]=t[goog.UID_PROPERTY_],t}:e},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);for(var a=0;a<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;a++)r=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[a],Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},goog.identity_=function(e){return e},goog.createTrustedTypesPolicy=function(e){var t=null,r=goog.global.trustedTypes;if(!r||!r.createPolicy)return t;try{t=r.createPolicy(e,{createHTML:goog.identity_,createScript:goog.identity_,createScriptURL:goog.identity_})}catch(e){goog.logToConsole_(e.message)}return t},!COMPILED&&goog.DEPENDENCIES_ENABLED&&(goog.isEdge_=function(){return!!(goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"").match(/Edge\/(\d+)(\.\d)*/i)},goog.inHtmlDocument_=function(){var e=goog.global.document;return null!=e&&"write"in e},goog.isDocumentLoading_=function(){var e=goog.global.document;return e.attachEvent?"complete"!=e.readyState:"loading"==e.readyState},goog.findBasePath_=function(){if(null!=goog.global.CLOSURE_BASE_PATH&&"string"==typeof goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var e=goog.global.document,t=e.currentScript;for(t=(e=t?[t]:e.getElementsByTagName("SCRIPT")).length-1;0<=t;--t){var r=e[t].src,a=r.lastIndexOf("?");if(a=-1==a?r.length:a,"base.js"==r.slice(a-7,a)){goog.basePath=r.slice(0,a-7);break}}}},goog.findBasePath_(),goog.protectScriptTag_=function(e){return e.replace(/<\/(SCRIPT)/gi,"\\x3c/$1")},goog.DebugLoader_=function(){this.dependencies_={},this.idToPath_={},this.written_={},this.loadingDeps_=[],this.depsToLoad_=[],this.paused_=!1,this.factory_=new goog.DependencyFactory,this.deferredCallbacks_={},this.deferredQueue_=[]},goog.DebugLoader_.prototype.bootstrap=function(e,t){function r(){a&&(goog.global.setTimeout(a,0),a=null)}var a=t;if(e.length){t=[];for(var n=0;n<e.length;n++){var i=this.getPathFromDeps_(e[n]);if(!i)throw Error("Unregonized namespace: "+e[n]);t.push(this.dependencies_[i])}i=goog.require;var o=0;for(n=0;n<e.length;n++)i(e[n]),t[n].onLoad((function(){++o==e.length&&r()}))}else r()},goog.DebugLoader_.prototype.loadClosureDeps=function(){this.depsToLoad_.push(this.factory_.createDependency(goog.normalizePath_(goog.basePath+"deps.js"),"deps.js",[],[],{})),this.loadDeps_()},goog.DebugLoader_.prototype.requested=function(e,t){(e=this.getPathFromDeps_(e))&&(t||this.areDepsLoaded_(this.dependencies_[e].requires))&&(t=this.deferredCallbacks_[e])&&(delete this.deferredCallbacks_[e],t())},goog.DebugLoader_.prototype.setDependencyFactory=function(e){this.factory_=e},goog.DebugLoader_.prototype.load_=function(e){if(this.getPathFromDeps_(e)){var t=this,r=[],a=function(e){var n=t.getPathFromDeps_(e);if(!n)throw Error("Bad dependency path or symbol: "+e);if(!t.written_[n]){for(t.written_[n]=!0,e=t.dependencies_[n],n=0;n<e.requires.length;n++)goog.isProvided_(e.requires[n])||a(e.requires[n]);r.push(e)}};a(e),e=!!this.depsToLoad_.length,this.depsToLoad_=this.depsToLoad_.concat(r),this.paused_||e||this.loadDeps_()}else goog.logToConsole_("goog.require could not find: "+e)},goog.DebugLoader_.prototype.loadDeps_=function(){for(var e=this,t=this.paused_;this.depsToLoad_.length&&!t;)!function(){var r=!1,a=e.depsToLoad_.shift(),n=!1;e.loading_(a);var i={pause:function(){if(r)throw Error("Cannot call pause after the call to load.");t=!0},resume:function(){r?e.resume_():t=!1},loaded:function(){if(n)throw Error("Double call to loaded.");n=!0,e.loaded_(a)},pending:function(){for(var t=[],r=0;r<e.loadingDeps_.length;r++)t.push(e.loadingDeps_[r]);return t},setModuleState:function(e){goog.moduleLoaderState_={type:e,moduleName:"",declareLegacyNamespace:!1}},registerEs6ModuleExports:function(e,t,r){r&&(goog.loadedModules_[r]={exports:t,type:goog.ModuleType.ES6,moduleId:r||""})},registerGoogModuleExports:function(e,t){goog.loadedModules_[e]={exports:t,type:goog.ModuleType.GOOG,moduleId:e}},clearModuleState:function(){goog.moduleLoaderState_=null},defer:function(t){if(r)throw Error("Cannot register with defer after the call to load.");e.defer_(a,t)},areDepsLoaded:function(){return e.areDepsLoaded_(a.requires)}};try{a.load(i)}finally{r=!0}}();t&&this.pause_()},goog.DebugLoader_.prototype.pause_=function(){this.paused_=!0},goog.DebugLoader_.prototype.resume_=function(){this.paused_&&(this.paused_=!1,this.loadDeps_())},goog.DebugLoader_.prototype.loading_=function(e){this.loadingDeps_.push(e)},goog.DebugLoader_.prototype.loaded_=function(e){for(var t=0;t<this.loadingDeps_.length;t++)if(this.loadingDeps_[t]==e){this.loadingDeps_.splice(t,1);break}for(t=0;t<this.deferredQueue_.length;t++)if(this.deferredQueue_[t]==e.path){this.deferredQueue_.splice(t,1);break}if(this.loadingDeps_.length==this.deferredQueue_.length&&!this.depsToLoad_.length)for(;this.deferredQueue_.length;)this.requested(this.deferredQueue_.shift(),!0);e.loaded()},goog.DebugLoader_.prototype.areDepsLoaded_=function(e){for(var t=0;t<e.length;t++){var r=this.getPathFromDeps_(e[t]);if(!r||!(r in this.deferredCallbacks_)&&!goog.isProvided_(e[t]))return!1}return!0},goog.DebugLoader_.prototype.getPathFromDeps_=function(e){return e in this.idToPath_?this.idToPath_[e]:e in this.dependencies_?e:null},goog.DebugLoader_.prototype.defer_=function(e,t){this.deferredCallbacks_[e.path]=t,this.deferredQueue_.push(e.path)},goog.LoadController=function(){},goog.LoadController.prototype.pause=function(){},goog.LoadController.prototype.resume=function(){},goog.LoadController.prototype.loaded=function(){},goog.LoadController.prototype.pending=function(){},goog.LoadController.prototype.registerEs6ModuleExports=function(e,t,r){},goog.LoadController.prototype.setModuleState=function(e){},goog.LoadController.prototype.clearModuleState=function(){},goog.LoadController.prototype.defer=function(e){},goog.LoadController.prototype.areDepsLoaded=function(){},goog.Dependency=function(e,t,r,a,n){this.path=e,this.relativePath=t,this.provides=r,this.requires=a,this.loadFlags=n,this.loaded_=!1,this.loadCallbacks_=[]},goog.Dependency.prototype.getPathName=function(){var e=this.path,t=e.indexOf("://");return 0<=t&&(0<=(t=(e=e.substring(t+3)).indexOf("/"))&&(e=e.substring(t+1))),e},goog.Dependency.prototype.onLoad=function(e){this.loaded_?e():this.loadCallbacks_.push(e)},goog.Dependency.prototype.loaded=function(){this.loaded_=!0;var e=this.loadCallbacks_;this.loadCallbacks_=[];for(var t=0;t<e.length;t++)e[t]()},goog.Dependency.defer_=!1,goog.Dependency.callbackMap_={},goog.Dependency.registerCallback_=function(e){var t=Math.random().toString(32);return goog.Dependency.callbackMap_[t]=e,t},goog.Dependency.unregisterCallback_=function(e){delete goog.Dependency.callbackMap_[e]},goog.Dependency.callback_=function(e,t){if(!(e in goog.Dependency.callbackMap_))throw Error("Callback key "+e+" does not exist (was base.js loaded more than once?).");for(var r=goog.Dependency.callbackMap_[e],a=[],n=1;n<arguments.length;n++)a.push(arguments[n]);r.apply(void 0,a)},goog.Dependency.prototype.load=function(e){if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?e.loaded():e.pause();else if(goog.inHtmlDocument_()){var t=goog.global.document;if("complete"==t.readyState&&!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING){if(/\bdeps.js$/.test(this.path))return void e.loaded();throw Error('Cannot write "'+this.path+'" after document load')}var r=goog.getScriptNonce_();if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&goog.isDocumentLoading_()){var a=function(t){t.readyState&&"complete"!=t.readyState?t.onload=a:(goog.Dependency.unregisterCallback_(n),e.loaded())},n=goog.Dependency.registerCallback_(a);r=r?' nonce="'+r+'"':"";var i='<script src="'+this.path+'"'+r+(goog.Dependency.defer_?" defer":"")+' id="script-'+n+'"><\/script>';i+="<script"+r+">",i=goog.Dependency.defer_?i+"document.getElementById('script-"+n+"').onload = function() {\n  goog.Dependency.callback_('"+n+"', this);\n};\n":i+"goog.Dependency.callback_('"+n+"', document.getElementById('script-"+n+"'));",i+="<\/script>",t.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(i):i)}else{var o=t.createElement("script");o.defer=goog.Dependency.defer_,o.async=!1,r&&(o.nonce=r),o.onload=function(){o.onload=null,e.loaded()},o.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(this.path):this.path,t.head.appendChild(o)}}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),"deps.js"==this.relativePath?(goog.logToConsole_("Consider setting CLOSURE_IMPORT_SCRIPT before loading base.js, or setting CLOSURE_NO_DEPS to true."),e.loaded()):e.pause()},goog.Es6ModuleDependency=function(e,t,r,a,n){goog.Dependency.call(this,e,t,r,a,n)},goog.inherits(goog.Es6ModuleDependency,goog.Dependency),goog.Es6ModuleDependency.prototype.load=function(e){if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?e.loaded():e.pause();else if(goog.inHtmlDocument_()){var t=goog.global.document,r=this;if(goog.isDocumentLoading_()){var a=function(e,r){var a="",n=goog.getScriptNonce_();n&&(a=' nonce="'+n+'"'),e=r?'<script type="module" crossorigin'+a+">"+r+"<\/script>":'<script type="module" crossorigin src="'+e+'"'+a+"><\/script>",t.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(e):e)};goog.Dependency.defer_=!0}else a=function(e,r){var a=t.createElement("script");a.defer=!0,a.async=!1,a.type="module",a.setAttribute("crossorigin",!0);var n=goog.getScriptNonce_();n&&(a.nonce=n),r?a.text=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScript(r):r:a.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(e):e,t.head.appendChild(a)};var n=goog.Dependency.registerCallback_((function(){goog.Dependency.unregisterCallback_(n),e.setModuleState(goog.ModuleType.ES6)}));a(void 0,'goog.Dependency.callback_("'+n+'")'),a(this.path,void 0);var i=goog.Dependency.registerCallback_((function(t){goog.Dependency.unregisterCallback_(i),e.registerEs6ModuleExports(r.path,t,goog.moduleLoaderState_.moduleName)}));a(void 0,'import * as m from "'+this.path+'"; goog.Dependency.callback_("'+i+'", m)');var o=goog.Dependency.registerCallback_((function(){goog.Dependency.unregisterCallback_(o),e.clearModuleState(),e.loaded()}));a(void 0,'goog.Dependency.callback_("'+o+'")')}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),e.pause()},goog.TransformedDependency=function(e,t,r,a,n){goog.Dependency.call(this,e,t,r,a,n),this.contents_=null,this.lazyFetch_=!goog.inHtmlDocument_()||!("noModule"in goog.global.document.createElement("script"))},goog.inherits(goog.TransformedDependency,goog.Dependency),goog.TransformedDependency.prototype.load=function(e){function t(){o.contents_=goog.loadFileSync_(o.path),o.contents_&&(o.contents_=o.transform(o.contents_),o.contents_&&(o.contents_+="\n//# sourceURL="+o.path))}function r(){if(o.lazyFetch_&&t(),o.contents_){s&&e.setModuleState(goog.ModuleType.ES6);try{var r=o.contents_;if(o.contents_=null,goog.globalEval(goog.CLOSURE_EVAL_PREFILTER_.createScript(r)),s)var a=goog.moduleLoaderState_.moduleName}finally{s&&e.clearModuleState()}s&&goog.global.$jscomp.require.ensure([o.getPathName()],(function(){e.registerEs6ModuleExports(o.path,goog.global.$jscomp.require(o.getPathName()),a)})),e.loaded()}}var a,n,i,o=this;if(goog.global.CLOSURE_IMPORT_SCRIPT)t(),this.contents_&&goog.global.CLOSURE_IMPORT_SCRIPT("",this.contents_)?(this.contents_=null,e.loaded()):e.pause();else{var s=this.loadFlags.module==goog.ModuleType.ES6;this.lazyFetch_||t();var l=1<e.pending().length;if(goog.Dependency.defer_&&(l||goog.isDocumentLoading_()))e.defer((function(){r()}));else{var u=goog.global.document;if(l=goog.inHtmlDocument_()&&("ActiveXObject"in goog.global||goog.isEdge_()),s&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()&&!l){goog.Dependency.defer_=!0,e.pause();var c=u.onreadystatechange;u.onreadystatechange=function(){"interactive"==u.readyState&&(u.onreadystatechange=c,r(),e.resume()),"function"==typeof c&&c.apply(void 0,arguments)}}else goog.inHtmlDocument_()&&goog.isDocumentLoading_()?(a=goog.global.document,n=goog.Dependency.registerCallback_((function(){goog.Dependency.unregisterCallback_(n),r()})),i="<script"+((i=goog.getScriptNonce_())?' nonce="'+i+'"':"")+">"+goog.protectScriptTag_('goog.Dependency.callback_("'+n+'");')+"<\/script>",a.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(i):i)):r()}}},goog.TransformedDependency.prototype.transform=function(e){},goog.PreTranspiledEs6ModuleDependency=function(e,t,r,a,n){goog.TransformedDependency.call(this,e,t,r,a,n)},goog.inherits(goog.PreTranspiledEs6ModuleDependency,goog.TransformedDependency),goog.PreTranspiledEs6ModuleDependency.prototype.transform=function(e){return e},goog.GoogModuleDependency=function(e,t,r,a,n){goog.TransformedDependency.call(this,e,t,r,a,n)},goog.inherits(goog.GoogModuleDependency,goog.TransformedDependency),goog.GoogModuleDependency.prototype.transform=function(e){return goog.LOAD_MODULE_USING_EVAL&&void 0!==goog.global.JSON?"goog.loadModule("+goog.global.JSON.stringify(e+"\n//# sourceURL="+this.path+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+e+"\n;return exports});\n//# sourceURL="+this.path+"\n"},goog.DebugLoader_.prototype.addDependency=function(e,t,r,a){t=t||[],e=e.replace(/\\/g,"/");var n=goog.normalizePath_(goog.basePath+e);for(a&&"boolean"!=typeof a||(a=a?{module:goog.ModuleType.GOOG}:{}),r=this.factory_.createDependency(n,e,t,r,a),this.dependencies_[n]=r,r=0;r<t.length;r++)this.idToPath_[t[r]]=n;this.idToPath_[e]=n},goog.DependencyFactory=function(){},goog.DependencyFactory.prototype.createDependency=function(e,t,r,a,n){return n.module==goog.ModuleType.GOOG?new goog.GoogModuleDependency(e,t,r,a,n):n.module==goog.ModuleType.ES6?goog.ASSUME_ES_MODULES_TRANSPILED?new goog.PreTranspiledEs6ModuleDependency(e,t,r,a,n):new goog.Es6ModuleDependency(e,t,r,a,n):new goog.Dependency(e,t,r,a,n)},goog.debugLoader_=new goog.DebugLoader_,goog.loadClosureDeps=function(){goog.debugLoader_.loadClosureDeps()},goog.setDependencyFactory=function(e){goog.debugLoader_.setDependencyFactory(e)},goog.TRUSTED_TYPES_POLICY_=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#base"):null,goog.global.CLOSURE_NO_DEPS||goog.debugLoader_.loadClosureDeps(),goog.bootstrap=function(e,t){goog.debugLoader_.bootstrap(e,t)}),!COMPILED){var isChrome87=!1;try{isChrome87=eval(goog.global.trustedTypes.emptyScript)!==goog.global.trustedTypes.emptyScript}catch(e){}goog.CLOSURE_EVAL_PREFILTER_=goog.global.trustedTypes&&isChrome87&&goog.createTrustedTypesPolicy("goog#base#devonly#eval")||{createScript:goog.identity_}}
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
goog.asserts=function(){},goog.asserts.assert=function(e,t){},goog.asserts.ENABLE_ASSERTS=!0,goog.asserts.ENABLE_ASSERTS&&console.assert&&console.assert.bind&&(goog.asserts.assert=console.assert.bind(console));var shaka={abr:{}};if(shaka.abr.Ewma=function(e){goog.asserts.assert(0<e,"expected halfLife to be positive"),this.alpha_=Math.exp(Math.log(.5)/e),this.totalWeight_=this.estimate_=0},shaka.abr.Ewma.prototype.updateAlpha=function(e){goog.asserts.assert(0<e,"expected halfLife to be positive"),this.alpha_=Math.exp(Math.log(.5)/e)},shaka.abr.Ewma.prototype.sample=function(e,t){var r=Math.pow(this.alpha_,e);t=t*(1-r)+r*this.estimate_,isNaN(t)||(this.estimate_=t,this.totalWeight_+=e)},shaka.abr.Ewma.prototype.getEstimate=function(){return this.estimate_/(1-Math.pow(this.alpha_,this.totalWeight_))},shaka.abr.EwmaBandwidthEstimator=function(){this.fast_=new shaka.abr.Ewma(2),this.slow_=new shaka.abr.Ewma(5),this.bytesSampled_=0,this.minTotalBytes_=128e3,this.minBytes_=16e3},shaka.abr.EwmaBandwidthEstimator.prototype.configure=function(e){this.minTotalBytes_=e.minTotalBytes,this.minBytes_=e.minBytes,this.fast_.updateAlpha(e.fastHalfLife),this.slow_.updateAlpha(e.slowHalfLife)},shaka.abr.EwmaBandwidthEstimator.prototype.sample=function(e,t){if(!(t<this.minBytes_)){var r=8e3*t/e;e/=1e3,this.bytesSampled_+=t,this.fast_.sample(e,r),this.slow_.sample(e,r)}},shaka.abr.EwmaBandwidthEstimator.prototype.getBandwidthEstimate=function(e){return this.bytesSampled_<this.minTotalBytes_?e:Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())},shaka.abr.EwmaBandwidthEstimator.prototype.hasGoodEstimate=function(){return this.bytesSampled_>=this.minTotalBytes_},shaka.log=function(){},shaka.log.alwaysError=function(){},shaka.log.alwaysWarn=function(){},shaka.log.warnOnce=function(e){var t=$jscomp.getRestArguments.apply(1,arguments);shaka.log.oneTimeWarningIssued_.has(e)||(shaka.log.oneTimeWarningIssued_.add(e),shaka.log.alwaysWarn.apply(shaka.log,$jscomp.arrayFromIterable(t)))},shaka.log.error=function(){},shaka.log.warning=function(){},shaka.log.info=function(){},shaka.log.debug=function(){},shaka.log.v1=function(){},shaka.log.v2=function(){},shaka.log.Level={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,V1:5,V2:6},shaka.log.MAX_LOG_LEVEL=4,shaka.log.oneTimeWarningIssued_=new Set,window.console&&window.console.log.bind){var $jscomp$compprop0={};shaka.log.logMap_=($jscomp$compprop0[shaka.log.Level.ERROR]=console.error.bind(console),$jscomp$compprop0[shaka.log.Level.WARNING]=console.warn.bind(console),$jscomp$compprop0[shaka.log.Level.INFO]=console.info.bind(console),$jscomp$compprop0[shaka.log.Level.DEBUG]=console.log.bind(console),$jscomp$compprop0[shaka.log.Level.V1]=console.debug.bind(console),$jscomp$compprop0[shaka.log.Level.V2]=console.debug.bind(console),$jscomp$compprop0),shaka.log.alwaysWarn=shaka.log.logMap_[shaka.log.Level.WARNING],shaka.log.alwaysError=shaka.log.logMap_[shaka.log.Level.ERROR],goog.DEBUG?(goog.exportSymbol("shaka.log",shaka.log),shaka.log.setLevel=function(e){var t=function(t){return t<=e?(goog.asserts.assert(shaka.log.logMap_[t],"Unexpected log level"),shaka.log.logMap_[t]):function(){}};shaka.log.currentLevel=e,shaka.log.error=t(shaka.log.Level.ERROR),shaka.log.warning=t(shaka.log.Level.WARNING),shaka.log.info=t(shaka.log.Level.INFO),shaka.log.debug=t(shaka.log.Level.DEBUG),shaka.log.v1=t(shaka.log.Level.V1),shaka.log.v2=t(shaka.log.Level.V2)},shaka.log.setLevel(shaka.log.MAX_LOG_LEVEL)):(shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.ERROR&&(shaka.log.error=shaka.log.logMap_[shaka.log.Level.ERROR]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.WARNING&&(shaka.log.warning=shaka.log.logMap_[shaka.log.Level.WARNING]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.INFO&&(shaka.log.info=shaka.log.logMap_[shaka.log.Level.INFO]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.DEBUG&&(shaka.log.debug=shaka.log.logMap_[shaka.log.Level.DEBUG]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.V1&&(shaka.log.v1=shaka.log.logMap_[shaka.log.Level.V1]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.V2&&(shaka.log.v2=shaka.log.logMap_[shaka.log.Level.V2]))}shaka.media={},shaka.media.Capabilities=function(){},shaka.media.Capabilities.isTypeSupported=function(e){var t=shaka.media.Capabilities.MediaSourceTypeSupportMap;if(t.has(e))return t.get(e);var r=MediaSource.isTypeSupported(e);return t.set(e,r),r},shaka.media.Capabilities.MediaSourceTypeSupportMap=new Map,shaka.util={},shaka.util.ArrayUtils=function(){},shaka.util.ArrayUtils.defaultEquals=function(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t},shaka.util.ArrayUtils.remove=function(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)},shaka.util.ArrayUtils.count=function(e,t){for(var r=0,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())r+=t(a.value)?1:0;return r},shaka.util.ArrayUtils.hasSameElements=function(e,t,r){if(r||(r=shaka.util.ArrayUtils.defaultEquals),e.length!=t.length)return!1;t=t.slice();for(var a={},n=(e=$jscomp.makeIterator(e)).next();!n.done;a={$jscomp$loop$prop$item$626:a.$jscomp$loop$prop$item$626},n=e.next()){if(a.$jscomp$loop$prop$item$626=n.value,-1==(n=t.findIndex(function(e){return function(t){return r(e.$jscomp$loop$prop$item$626,t)}}(a))))return!1;t[n]=t[t.length-1],t.pop()}return 0==t.length},shaka.util.ArrayUtils.equal=function(e,t,r){if(r||(r=shaka.util.ArrayUtils.defaultEquals),e.length!=t.length)return!1;for(var a=0;a<e.length;a++)if(!r(e[a],t[a]))return!1;return!0},shaka.text={},shaka.text.Cue=function(e,t,r){var a=shaka.text.Cue;this.startTime=e,this.direction=a.direction.HORIZONTAL_LEFT_TO_RIGHT,this.endTime=t,this.payload=r,this.region=new shaka.text.CueRegion,this.position=null,this.positionAlign=a.positionAlign.AUTO,this.size=0,this.textAlign=a.textAlign.CENTER,this.writingMode=a.writingMode.HORIZONTAL_TOP_TO_BOTTOM,this.lineInterpretation=a.lineInterpretation.LINE_NUMBER,this.line=null,this.lineHeight="",this.lineAlign=a.lineAlign.START,this.displayAlign=a.displayAlign.AFTER,this.fontSize=this.textStrokeWidth=this.textStrokeColor=this.textShadow=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=a.fontWeight.NORMAL,this.fontStyle=a.fontStyle.NORMAL,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.cellResolution={columns:32,rows:15}},shaka.text.Cue.lineBreak=function(e,t){return(e=new shaka.text.Cue(e,t,"")).lineBreak=!0,e},shaka.text.Cue.prototype.clone=function(){var e,t=new shaka.text.Cue(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t},shaka.text.Cue.equal=function(e,t){if(e.startTime!=t.startTime||e.endTime!=t.endTime||e.payload!=t.payload)return!1;for(var r in e)if("startTime"!=r&&"endTime"!=r&&"payload"!=r)if("nestedCues"==r){if(!shaka.util.ArrayUtils.equal(e.nestedCues,t.nestedCues,shaka.text.Cue.equal))return!1}else if("region"==r||"cellResolution"==r){for(var a in e[r])if(e[r][a]!=t[r][a])return!1}else if(Array.isArray(e[r])){if(!shaka.util.ArrayUtils.equal(e[r],t[r]))return!1}else if(e[r]!=t[r])return!1;return!0},goog.exportSymbol("shaka.text.Cue",shaka.text.Cue),shaka.text.Cue.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:"auto"},goog.exportProperty(shaka.text.Cue,"positionAlign",shaka.text.Cue.positionAlign),shaka.text.Cue.textAlign={LEFT:"left",RIGHT:"right",CENTER:"center",START:"start",END:"end"},goog.exportProperty(shaka.text.Cue,"textAlign",shaka.text.Cue.textAlign),shaka.text.Cue.displayAlign={BEFORE:"before",CENTER:"center",AFTER:"after"},goog.exportProperty(shaka.text.Cue,"displayAlign",shaka.text.Cue.displayAlign),shaka.text.Cue.direction={HORIZONTAL_LEFT_TO_RIGHT:"ltr",HORIZONTAL_RIGHT_TO_LEFT:"rtl"},goog.exportProperty(shaka.text.Cue,"direction",shaka.text.Cue.direction),shaka.text.Cue.writingMode={HORIZONTAL_TOP_TO_BOTTOM:"horizontal-tb",VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"},goog.exportProperty(shaka.text.Cue,"writingMode",shaka.text.Cue.writingMode),shaka.text.Cue.lineInterpretation={LINE_NUMBER:0,PERCENTAGE:1},goog.exportProperty(shaka.text.Cue,"lineInterpretation",shaka.text.Cue.lineInterpretation),shaka.text.Cue.lineAlign={CENTER:"center",START:"start",END:"end"},goog.exportProperty(shaka.text.Cue,"lineAlign",shaka.text.Cue.lineAlign),shaka.text.Cue.defaultTextColor={white:"#FFF",lime:"#0F0",cyan:"#0FF",red:"#F00",yellow:"#FF0",magenta:"#F0F",blue:"#00F",black:"#000"},goog.exportProperty(shaka.text.Cue,"defaultTextColor",shaka.text.Cue.defaultTextColor),shaka.text.Cue.defaultTextBackgroundColor={bg_white:"#FFF",bg_lime:"#0F0",bg_cyan:"#0FF",bg_red:"#F00",bg_yellow:"#FF0",bg_magenta:"#F0F",bg_blue:"#00F",bg_black:"#000"},goog.exportProperty(shaka.text.Cue,"defaultTextBackgroundColor",shaka.text.Cue.defaultTextBackgroundColor),shaka.text.Cue.fontWeight={NORMAL:400,BOLD:700},goog.exportProperty(shaka.text.Cue,"fontWeight",shaka.text.Cue.fontWeight),shaka.text.Cue.fontStyle={NORMAL:"normal",ITALIC:"italic",OBLIQUE:"oblique"},goog.exportProperty(shaka.text.Cue,"fontStyle",shaka.text.Cue.fontStyle),shaka.text.Cue.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},goog.exportProperty(shaka.text.Cue,"textDecoration",shaka.text.Cue.textDecoration),shaka.text.CueRegion=function(){var e=shaka.text.CueRegion;this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=e.units.PERCENTAGE,this.scroll=e.scrollMode.NONE},goog.exportSymbol("shaka.text.CueRegion",shaka.text.CueRegion),shaka.text.CueRegion.units={PX:0,PERCENTAGE:1,LINES:2},goog.exportProperty(shaka.text.CueRegion,"units",shaka.text.CueRegion.units),shaka.text.CueRegion.scrollMode={NONE:"",UP:"up"},goog.exportProperty(shaka.text.CueRegion,"scrollMode",shaka.text.CueRegion.scrollMode),shaka.util.BufferUtils=function(){},shaka.util.BufferUtils.equal=function(e,t){var r=shaka.util.BufferUtils;if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if(r.unsafeGetArrayBuffer_(e)==r.unsafeGetArrayBuffer_(t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;r=shaka.util.BufferUtils.toUint8(e),t=shaka.util.BufferUtils.toUint8(t);for(var a=0;a<e.byteLength;a++)if(r[a]!=t[a])return!1;return!0},shaka.util.BufferUtils.unsafeGetArrayBuffer_=function(e){return e instanceof ArrayBuffer?e:e.buffer},shaka.util.BufferUtils.toArrayBuffer=function(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer},shaka.util.BufferUtils.toUint8=function(e,t,r){return r=void 0===r?1/0:r,shaka.util.BufferUtils.view_(e,void 0===t?0:t,r,Uint8Array)},shaka.util.BufferUtils.toDataView=function(e,t,r){return r=void 0===r?1/0:r,shaka.util.BufferUtils.view_(e,void 0===t?0:t,r,DataView)},shaka.util.BufferUtils.view_=function(e,t,r,a){var n=shaka.util.BufferUtils.unsafeGetArrayBuffer_(e),i=(e.byteOffset||0)+e.byteLength;return new a(n,e=Math.max(0,Math.min((e.byteOffset||0)+t,i)),Math.min(e+Math.max(r,0),i)-e)},goog.exportSymbol("shaka.util.BufferUtils",shaka.util.BufferUtils),goog.exportProperty(shaka.util.BufferUtils,"toDataView",shaka.util.BufferUtils.toDataView),goog.exportProperty(shaka.util.BufferUtils,"toUint8",shaka.util.BufferUtils.toUint8),goog.exportProperty(shaka.util.BufferUtils,"toArrayBuffer",shaka.util.BufferUtils.toArrayBuffer),goog.exportProperty(shaka.util.BufferUtils,"equal",shaka.util.BufferUtils.equal),shaka.util.IDestroyable=function(){},shaka.util.IDestroyable.prototype.destroy=function(){},shaka.util.Error=function(e,t,r){var a=$jscomp.getRestArguments.apply(3,arguments);if(this.severity=e,this.category=t,this.code=r,this.data=a,this.handled=!1,goog.DEBUG){var n,i=a="UNKNOWN";for(n in shaka.util.Error.Category)shaka.util.Error.Category[n]==this.category&&(a=n);for(var o in shaka.util.Error.Code)shaka.util.Error.Code[o]==this.code&&(i=o);if(this.message="Shaka Error "+a+"."+i+" ("+this.data.toString()+")",shaka.util.Error.createStack)try{throw Error(this.message)}catch(e){this.stack=e.stack}}},shaka.util.Error.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},goog.exportSymbol("shaka.util.Error",shaka.util.Error),goog.DEBUG&&(shaka.util.Error.createStack=!0),shaka.util.Error.Severity={RECOVERABLE:1,CRITICAL:2},goog.exportProperty(shaka.util.Error,"Severity",shaka.util.Error.Severity),shaka.util.Error.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},goog.exportProperty(shaka.util.Error,"Category",shaka.util.Error.Category),shaka.util.Error.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_SRC_EQUALS:2016,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,HLS_AES_128_INVALID_IV_LENGTH:4043,HLS_AES_128_INVALID_KEY_LENGTH:4044,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004},goog.exportProperty(shaka.util.Error,"Code",shaka.util.Error.Code),
/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
goog.uri={},goog.uri.utils={},goog.uri.utils.splitRe_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),goog.uri.utils.ComponentIndex={SCHEME:1,USER_INFO:2,DOMAIN:3,PORT:4,PATH:5,QUERY_DATA:6,FRAGMENT:7},goog.uri.utils.split=function(e){return e.match(goog.uri.utils.splitRe_)},
/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
goog.Uri=function(e){var t;e instanceof goog.Uri?(this.setScheme(e.getScheme()),this.setUserInfo(e.getUserInfo()),this.setDomain(e.getDomain()),this.setPort(e.getPort()),this.setPath(e.getPath()),this.setQueryData(e.getQueryData().clone()),this.setFragment(e.getFragment())):e&&(t=goog.uri.utils.split(String(e)))?(this.setScheme(t[goog.uri.utils.ComponentIndex.SCHEME]||"",!0),this.setUserInfo(t[goog.uri.utils.ComponentIndex.USER_INFO]||"",!0),this.setDomain(t[goog.uri.utils.ComponentIndex.DOMAIN]||"",!0),this.setPort(t[goog.uri.utils.ComponentIndex.PORT]),this.setPath(t[goog.uri.utils.ComponentIndex.PATH]||"",!0),this.setQueryData(t[goog.uri.utils.ComponentIndex.QUERY_DATA]||"",!0),this.setFragment(t[goog.uri.utils.ComponentIndex.FRAGMENT]||"",!0)):this.queryData_=new goog.Uri.QueryData(null,null)},goog.Uri.prototype.scheme_="",goog.Uri.prototype.userInfo_="",goog.Uri.prototype.domain_="",goog.Uri.prototype.port_=null,goog.Uri.prototype.path_="",goog.Uri.prototype.fragment_="",goog.Uri.prototype.toString=function(){var e=[],t=this.getScheme();if(t&&e.push(goog.Uri.encodeSpecialChars_(t,goog.Uri.reDisallowedInSchemeOrUserInfo_,!0),":"),t=this.getDomain()){e.push("//");var r=this.getUserInfo();r&&e.push(goog.Uri.encodeSpecialChars_(r,goog.Uri.reDisallowedInSchemeOrUserInfo_,!0),"@"),e.push(goog.Uri.removeDoubleEncoding_(encodeURIComponent(t))),null!=(t=this.getPort())&&e.push(":",String(t))}return(t=this.getPath())&&(this.hasDomain()&&"/"!=t.charAt(0)&&e.push("/"),e.push(goog.Uri.encodeSpecialChars_(t,"/"==t.charAt(0)?goog.Uri.reDisallowedInAbsolutePath_:goog.Uri.reDisallowedInRelativePath_,!0))),(t=this.getEncodedQuery())&&e.push("?",t),(t=this.getFragment())&&e.push("#",goog.Uri.encodeSpecialChars_(t,goog.Uri.reDisallowedInFragment_)),e.join("")},goog.Uri.prototype.resolve=function(e){var t=this.clone();"data"===t.scheme_&&(t=new goog.Uri);var r=e.hasScheme();r?t.setScheme(e.getScheme()):r=e.hasUserInfo(),r?t.setUserInfo(e.getUserInfo()):r=e.hasDomain(),r?t.setDomain(e.getDomain()):r=e.hasPort();var a=e.getPath();if(r)t.setPort(e.getPort());else if(r=e.hasPath()){if("/"!=a.charAt(0))if(this.hasDomain()&&!this.hasPath())a="/"+a;else{var n=t.getPath().lastIndexOf("/");-1!=n&&(a=t.getPath().substr(0,n+1)+a)}a=goog.Uri.removeDotSegments(a)}return r?t.setPath(a):r=e.hasQuery(),r?t.setQueryData(e.getQueryData().clone()):r=e.hasFragment(),r&&t.setFragment(e.getFragment()),t},goog.Uri.prototype.clone=function(){return new goog.Uri(this)},goog.Uri.prototype.getScheme=function(){return this.scheme_},goog.Uri.prototype.setScheme=function(e,t){return(this.scheme_=t?goog.Uri.decodeOrEmpty_(e,!0):e)&&(this.scheme_=this.scheme_.replace(/:$/,"")),this},goog.Uri.prototype.hasScheme=function(){return!!this.scheme_},goog.Uri.prototype.getUserInfo=function(){return this.userInfo_},goog.Uri.prototype.setUserInfo=function(e,t){return this.userInfo_=t?goog.Uri.decodeOrEmpty_(e):e,this},goog.Uri.prototype.hasUserInfo=function(){return!!this.userInfo_},goog.Uri.prototype.getDomain=function(){return this.domain_},goog.Uri.prototype.setDomain=function(e,t){return this.domain_=t?goog.Uri.decodeOrEmpty_(e,!0):e,this},goog.Uri.prototype.hasDomain=function(){return!!this.domain_},goog.Uri.prototype.getPort=function(){return this.port_},goog.Uri.prototype.setPort=function(e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);this.port_=e}else this.port_=null;return this},goog.Uri.prototype.hasPort=function(){return null!=this.port_},goog.Uri.prototype.getPath=function(){return this.path_},goog.Uri.prototype.setPath=function(e,t){return this.path_=t?goog.Uri.decodeOrEmpty_(e,!0):e,this},goog.Uri.prototype.hasPath=function(){return!!this.path_},goog.Uri.prototype.hasQuery=function(){return""!==this.queryData_.toString()},goog.Uri.prototype.setQueryData=function(e,t){return e instanceof goog.Uri.QueryData?this.queryData_=e:(t||(e=goog.Uri.encodeSpecialChars_(e,goog.Uri.reDisallowedInQuery_)),this.queryData_=new goog.Uri.QueryData(e,null)),this},goog.Uri.prototype.getEncodedQuery=function(){return this.queryData_.toString()},goog.Uri.prototype.getDecodedQuery=function(){return this.queryData_.toDecodedString()},goog.Uri.prototype.getQueryData=function(){return this.queryData_},goog.Uri.prototype.getFragment=function(){return this.fragment_},goog.Uri.prototype.setFragment=function(e,t){return this.fragment_=t?goog.Uri.decodeOrEmpty_(e):e,this},goog.Uri.prototype.hasFragment=function(){return!!this.fragment_},goog.Uri.removeDotSegments=function(e){if(".."==e||"."==e)return"";if(-1==e.indexOf("./")&&-1==e.indexOf("/."))return e;var t=0==e.lastIndexOf("/",0);e=e.split("/");for(var r=[],a=0;a<e.length;){var n=e[a++];"."==n?t&&a==e.length&&r.push(""):".."==n?((1<r.length||1==r.length&&""!=r[0])&&r.pop(),t&&a==e.length&&r.push("")):(r.push(n),t=!0)}return r.join("/")},goog.Uri.decodeOrEmpty_=function(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""},goog.Uri.encodeSpecialChars_=function(e,t,r){return null!=e?(e=encodeURI(e).replace(t,goog.Uri.encodeChar_),r&&(e=goog.Uri.removeDoubleEncoding_(e)),e):null},goog.Uri.encodeChar_=function(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)},goog.Uri.removeDoubleEncoding_=function(e){return e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")},goog.Uri.reDisallowedInSchemeOrUserInfo_=/[#\/\?@]/g,goog.Uri.reDisallowedInRelativePath_=/[#\?:]/g,goog.Uri.reDisallowedInAbsolutePath_=/[#\?]/g,goog.Uri.reDisallowedInQuery_=/[#\?@]/g,goog.Uri.reDisallowedInFragment_=/#/g,goog.Uri.QueryData=function(e,t){this.encodedQuery_=e||null},goog.Uri.QueryData.prototype.ensureKeyMapInitialized_=function(){if(!this.keyMap_&&(this.keyMap_={},this.count_=0,this.encodedQuery_))for(var e=this.encodedQuery_.split("&"),t=0;t<e.length;t++){var r=e[t].indexOf("="),a=null;if(0<=r){var n=e[t].substring(0,r);a=e[t].substring(r+1)}else n=e[t];n=decodeURIComponent(n.replace(/\+/g," ")),a=a||"",this.add(n,decodeURIComponent(a.replace(/\+/g," ")))}},goog.Uri.QueryData.prototype.keyMap_=null,goog.Uri.QueryData.prototype.count_=null,goog.Uri.QueryData.prototype.getCount=function(){return this.ensureKeyMapInitialized_(),this.count_},goog.Uri.QueryData.prototype.add=function(e,t){this.ensureKeyMapInitialized_(),this.encodedQuery_=null;var r=this.keyMap_.hasOwnProperty(e)?this.keyMap_[e]:null;return r||(this.keyMap_[e]=r=[]),r.push(t),goog.asserts.assert(null!=this.count_,"Should not be null."),this.count_++,this},goog.Uri.QueryData.prototype.set=function(e,t){return this.ensureKeyMapInitialized_(),this.encodedQuery_=null,this.keyMap_.hasOwnProperty(e)?this.keyMap_[e]=[t]:this.add(e,t),this},goog.Uri.QueryData.prototype.toString=function(){if(this.encodedQuery_)return this.encodedQuery_;if(!this.keyMap_)return"";var e,t=[];for(e in this.keyMap_)for(var r=encodeURIComponent(e),a=this.keyMap_[e],n=0;n<a.length;n++){var i=r;""!==a[n]&&(i+="="+encodeURIComponent(a[n])),t.push(i)}return this.encodedQuery_=t.join("&")},goog.Uri.QueryData.prototype.toDecodedString=function(){return goog.Uri.decodeOrEmpty_(this.toString())},goog.Uri.QueryData.prototype.clone=function(){var e=new goog.Uri.QueryData;if(e.encodedQuery_=this.encodedQuery_,this.keyMap_){var t,r={};for(t in this.keyMap_)r[t]=this.keyMap_[t].concat();e.keyMap_=r,e.count_=this.count_}return e},shaka.util.Functional=function(){},shaka.util.Functional.createFallbackPromiseChain=function(e,t){return e.reduce((function(e,r){return e.catch((function(){return t(r)}))}),Promise.reject())},shaka.util.Functional.collapseArrays=function(e,t){return e.concat(t)},shaka.util.Functional.ignored=function(){},shaka.util.Functional.noop=function(){},shaka.util.Functional.isNotNull=function(e){return null!=e},shaka.util.ManifestParserUtils=function(){},shaka.util.ManifestParserUtils.resolveUris=function(e,t){var r=shaka.util.Functional;if(0==t.length)return e;var a=t.map((function(e){return new goog.Uri(e)}));return e.map((function(e){return new goog.Uri(e)})).map((function(e){return a.map((function(t){return e.resolve(t)}))})).reduce(r.collapseArrays,[]).map((function(e){return e.toString()}))},shaka.util.ManifestParserUtils.createDrmInfo=function(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:t||[],keyIds:new Set}},shaka.util.ManifestParserUtils.guessCodecs=function(e,t){if(1==t.length)return t[0];if(null!=(e=shaka.util.ManifestParserUtils.guessCodecsSafe(e,t)))return e;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_COULD_NOT_GUESS_CODECS,t)},shaka.util.ManifestParserUtils.guessCodecsSafe=function(e,t){for(var r=$jscomp.makeIterator(shaka.util.ManifestParserUtils.CODEC_REGEXPS_BY_CONTENT_TYPE_[e]),a=r.next();!a.done;a=r.next()){a=a.value;for(var n=$jscomp.makeIterator(t),i=n.next();!i.done;i=n.next())if(i=i.value,a.test(i.trim()))return i.trim()}return e==shaka.util.ManifestParserUtils.ContentType.TEXT?"":null},shaka.util.ManifestParserUtils.ContentType={VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image",APPLICATION:"application"},shaka.util.ManifestParserUtils.TextStreamKind={SUBTITLE:"subtitle",CLOSED_CAPTION:"caption"},shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS=1/15,shaka.util.ManifestParserUtils.VIDEO_CODEC_REGEXPS_=[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av01/,/^dvhe/],shaka.util.ManifestParserUtils.AUDIO_CODEC_REGEXPS_=[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4$/,/^dts[cx]$/,/^[du]dts$/],shaka.util.ManifestParserUtils.TEXT_CODEC_REGEXPS_=[/^vtt$/,/^wvtt/,/^stpp/],shaka.util.ManifestParserUtils.CODEC_REGEXPS_BY_CONTENT_TYPE_={audio:shaka.util.ManifestParserUtils.AUDIO_CODEC_REGEXPS_,video:shaka.util.ManifestParserUtils.VIDEO_CODEC_REGEXPS_,text:shaka.util.ManifestParserUtils.TEXT_CODEC_REGEXPS_},shaka.util.PublicPromise=function(){var e,t,r=new Promise((function(r,a){e=r,t=a}));return r.resolve=e,r.reject=t,r},shaka.util.PublicPromise.prototype.resolve=function(e){},shaka.util.PublicPromise.prototype.reject=function(e){},shaka.util.Lazy=function(e){this.gen_=e,this.value_=void 0},shaka.util.Lazy.prototype.value=function(){return null==this.value_&&(this.value_=this.gen_(),goog.asserts.assert(null!=this.value_,"Unable to create lazy value")),this.value_},shaka.util.Lazy.prototype.reset=function(){this.value_=void 0},shaka.util.DelayedTick=function(e){this.onTick_=e,this.cancelPending_=null},shaka.util.DelayedTick.prototype.tickAfter=function(e){var t=this;this.stop();var r=!0,a=null;return this.cancelPending_=function(){window.clearTimeout(a),r=!1},a=window.setTimeout((function(){r&&t.onTick_()}),1e3*e),this},shaka.util.DelayedTick.prototype.stop=function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)},shaka.util.Timer=function(e){this.onTick_=e,this.ticker_=null},shaka.util.Timer.prototype.tickNow=function(){return this.stop(),this.onTick_(),this},shaka.util.Timer.prototype.tickAfter=function(e){var t=this;return this.stop(),this.ticker_=new shaka.util.DelayedTick((function(){t.onTick_()})).tickAfter(e),this},shaka.util.Timer.prototype.tickEvery=function(e){var t=this;return this.stop(),goog.DEBUG&&shaka.util.Timer.activeTimers.set(this,Error("Timer created").stack),this.ticker_=new shaka.util.DelayedTick((function(){t.ticker_.tickAfter(e),t.onTick_()})).tickAfter(e),this},shaka.util.Timer.prototype.stop=function(){this.ticker_&&(this.ticker_.stop(),this.ticker_=null),goog.DEBUG&&shaka.util.Timer.activeTimers.delete(this)},goog.exportSymbol("shaka.util.Timer",shaka.util.Timer),goog.exportProperty(shaka.util.Timer.prototype,"stop",shaka.util.Timer.prototype.stop),goog.exportProperty(shaka.util.Timer.prototype,"tickEvery",shaka.util.Timer.prototype.tickEvery),goog.exportProperty(shaka.util.Timer.prototype,"tickAfter",shaka.util.Timer.prototype.tickAfter),goog.exportProperty(shaka.util.Timer.prototype,"tickNow",shaka.util.Timer.prototype.tickNow),goog.DEBUG&&(shaka.util.Timer.activeTimers=new Map),shaka.util.Platform=function(){},shaka.util.Platform.supportsMediaSource=function(){return!(!window.MediaSource||!MediaSource.isTypeSupported)},shaka.util.Platform.supportsMediaType=function(e){return""!=shaka.util.Platform.anyMediaElement().canPlayType(e)},shaka.util.Platform.isEdge=function(){return!!navigator.userAgent.match(/Edge?\//)},shaka.util.Platform.isLegacyEdge=function(){return!!navigator.userAgent.match(/Edge\//)},shaka.util.Platform.isIE=function(){return shaka.util.Platform.userAgentContains_("Trident/")},shaka.util.Platform.isXboxOne=function(){return shaka.util.Platform.userAgentContains_("Xbox One")},shaka.util.Platform.isTizen=function(){return shaka.util.Platform.userAgentContains_("Tizen")},shaka.util.Platform.isTizen4=function(){return shaka.util.Platform.userAgentContains_("Tizen 4")},shaka.util.Platform.isTizen3=function(){return shaka.util.Platform.userAgentContains_("Tizen 3")},shaka.util.Platform.isTizen2=function(){return shaka.util.Platform.userAgentContains_("Tizen 2")},shaka.util.Platform.isWebOS=function(){return shaka.util.Platform.userAgentContains_("Web0S")},shaka.util.Platform.isWebOS3=function(){return shaka.util.Platform.userAgentContains_("Web0S")&&shaka.util.Platform.userAgentContains_("Chrome/38.0.2125.122 Safari/537.36")},shaka.util.Platform.isChromecast=function(){return shaka.util.Platform.userAgentContains_("CrKey")},shaka.util.Platform.chromeVersion=function(){if(!shaka.util.Platform.isChrome())return null;var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null},shaka.util.Platform.isChrome=function(){return shaka.util.Platform.userAgentContains_("Chrome")&&!shaka.util.Platform.isEdge()},shaka.util.Platform.isApple=function(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!shaka.util.Platform.isTizen()&&!shaka.util.Platform.isEOS()&&!shaka.util.Platform.isVirginMedia()&&!shaka.util.Platform.isPS4()&&!shaka.util.Platform.isAmazonFireTV()},shaka.util.Platform.isPS5=function(){return shaka.util.Platform.userAgentContains_("PlayStation 5")},shaka.util.Platform.isPS4=function(){return shaka.util.Platform.userAgentContains_("PlayStation 4")},shaka.util.Platform.isHisense=function(){return shaka.util.Platform.userAgentContains_("Hisense")||shaka.util.Platform.userAgentContains_("VIDAA")},shaka.util.Platform.isVirginMedia=function(){return shaka.util.Platform.userAgentContains_("VirginMedia")},shaka.util.Platform.isAmazonFireTV=function(){return shaka.util.Platform.userAgentContains_("AFT")},shaka.util.Platform.safariVersion=function(){if(!shaka.util.Platform.isApple())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null},shaka.util.Platform.isSafari=function(){return!!shaka.util.Platform.safariVersion()},shaka.util.Platform.isEOS=function(){return shaka.util.Platform.userAgentContains_("PC=EOS")},shaka.util.Platform.isMobile=function(){return!!/(?:iPhone|iPad|iPod|Android)/.test(navigator.userAgent)||shaka.util.Platform.isApple()&&1<navigator.maxTouchPoints},shaka.util.Platform.userAgentContains_=function(e){return(navigator.userAgent||"").includes(e)},shaka.util.Platform.anyMediaElement=function(){var e=shaka.util.Platform;return e.cachedMediaElement_||(e.cacheExpirationTimer_||(e.cacheExpirationTimer_=new shaka.util.Timer((function(){e.cachedMediaElement_=null}))),e.cachedMediaElement_=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0],e.cachedMediaElement_||(e.cachedMediaElement_=document.createElement("video")),e.cacheExpirationTimer_.tickAfter(1)),e.cachedMediaElement_},shaka.util.Platform.requiresEncryptionInfoInAllInitSegments=function(){var e=shaka.util.Platform;return e.isTizen()||e.isXboxOne()},shaka.util.Platform.isMediaKeysPolyfilled=function(){return!!window.shakaMediaKeysPolyfill},shaka.util.Platform.cacheExpirationTimer_=null,shaka.util.Platform.cachedMediaElement_=null,shaka.util.StringUtils=function(){},shaka.util.StringUtils.fromUTF8=function(e){if(!e)return"";if(239==(e=shaka.util.BufferUtils.toUint8(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),window.TextDecoder&&!shaka.util.Platform.isPS4())return(e=(new TextDecoder).decode(e)).includes("�")&&shaka.log.alwaysError('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),e;for(var t="",r=0;r<e.length;++r){var a=65533;if(0==(128&e[r])?a=e[r]:e.length>=r+2&&192==(224&e[r])&&128==(192&e[r+1])?(a=(31&e[r])<<6|63&e[r+1],r+=1):e.length>=r+3&&224==(240&e[r])&&128==(192&e[r+1])&&128==(192&e[r+2])?(a=(15&e[r])<<12|(63&e[r+1])<<6|63&e[r+2],r+=2):e.length>=r+4&&240==(241&e[r])&&128==(192&e[r+1])&&128==(192&e[r+2])&&128==(192&e[r+3])&&(a=(7&e[r])<<18|(63&e[r+1])<<12|(63&e[r+2])<<6|63&e[r+3],r+=3),65535>=a)t+=String.fromCharCode(a);else{var n=1023&(a-=65536);t+=String.fromCharCode(55296+(a>>10)),t+=String.fromCharCode(56320+n)}}return t},shaka.util.StringUtils.fromUTF16=function(e,t,r){if(!e)return"";if(!r&&0!=e.byteLength%2)throw shaka.log.error("Data has an incorrect length, must be even."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BAD_ENCODING);r=Math.floor(e.byteLength/2);var a=new Uint16Array(r);e=shaka.util.BufferUtils.toDataView(e);for(var n=0;n<r;n++)a[n]=e.getUint16(2*n,t);return shaka.util.StringUtils.fromCharCode(a)},shaka.util.StringUtils.fromBytesAutoDetect=function(e){var t=shaka.util.StringUtils;if(!e)return"";var r=shaka.util.BufferUtils.toUint8(e);if(239==r[0]&&187==r[1]&&191==r[2])return t.fromUTF8(r);if(254==r[0]&&255==r[1])return t.fromUTF16(r.subarray(2),!1);if(255==r[0]&&254==r[1])return t.fromUTF16(r.subarray(2),!0);var a=function(e){return r.byteLength<=e||32<=r[e]&&126>=r[e]};if(shaka.log.debug("Unable to find byte-order-mark, making an educated guess."),0==r[0]&&0==r[2])return t.fromUTF16(e,!1);if(0==r[1]&&0==r[3])return t.fromUTF16(e,!0);if(a(0)&&a(1)&&a(2)&&a(3))return t.fromUTF8(e);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.UNABLE_TO_DETECT_ENCODING)},shaka.util.StringUtils.toUTF8=function(e){if(window.TextEncoder&&!shaka.util.Platform.isPS4()){var t=new TextEncoder;return shaka.util.BufferUtils.toArrayBuffer(t.encode(e))}e=encodeURIComponent(e),e=unescape(e),t=new Uint8Array(e.length);for(var r=0;r<e.length;r++)t[r]=e[r].charCodeAt(0);return shaka.util.BufferUtils.toArrayBuffer(t)},shaka.util.StringUtils.toUTF16=function(e,t){for(var r=new ArrayBuffer(2*e.length),a=new DataView(r),n=0;n<e.length;++n){var i=e.charCodeAt(n);a.setUint16(2*n,i,t)}return r},shaka.util.StringUtils.fromCharCode=function(e){return shaka.util.StringUtils.fromCharCodeImpl_.value()(e)},shaka.util.StringUtils.resetFromCharCode=function(){shaka.util.StringUtils.fromCharCodeImpl_.reset()},goog.exportSymbol("shaka.util.StringUtils",shaka.util.StringUtils),goog.exportProperty(shaka.util.StringUtils,"resetFromCharCode",shaka.util.StringUtils.resetFromCharCode),goog.exportProperty(shaka.util.StringUtils,"toUTF16",shaka.util.StringUtils.toUTF16),goog.exportProperty(shaka.util.StringUtils,"toUTF8",shaka.util.StringUtils.toUTF8),goog.exportProperty(shaka.util.StringUtils,"fromBytesAutoDetect",shaka.util.StringUtils.fromBytesAutoDetect),goog.exportProperty(shaka.util.StringUtils,"fromUTF16",shaka.util.StringUtils.fromUTF16),goog.exportProperty(shaka.util.StringUtils,"fromUTF8",shaka.util.StringUtils.fromUTF8),shaka.util.StringUtils.fromCharCodeImpl_=new shaka.util.Lazy((function(){for(var e=function(e){try{var t=new Uint8Array(e),r=String.fromCharCode.apply(null,t);return goog.asserts.assert(r,"Should get value"),0<r.length}catch(e){return!1}},t={$jscomp$loop$prop$size$628:65536};0<t.$jscomp$loop$prop$size$628;(t={$jscomp$loop$prop$size$628:t.$jscomp$loop$prop$size$628}).$jscomp$loop$prop$size$628/=2)if(e(t.$jscomp$loop$prop$size$628))return function(e){return function(t){for(var r="",a=0;a<t.length;a+=e.$jscomp$loop$prop$size$628){var n=t.subarray(a,a+e.$jscomp$loop$prop$size$628);r+=String.fromCharCode.apply(null,n)}return r}}(t);return goog.asserts.assert(!1,"Unable to create a fromCharCode method"),null})),shaka.util.Uint8ArrayUtils=function(){},shaka.util.Uint8ArrayUtils.toStandardBase64=function(e){return e=shaka.util.StringUtils.fromCharCode(shaka.util.BufferUtils.toUint8(e)),btoa(e)},shaka.util.Uint8ArrayUtils.toBase64=function(e,t){return t=null==t||t,e=shaka.util.Uint8ArrayUtils.toStandardBase64(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")},shaka.util.Uint8ArrayUtils.fromBase64=function(e){e=window.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t},shaka.util.Uint8ArrayUtils.fromHex=function(e){for(var t=e.length/2,r=new Uint8Array(t),a=0;a<t;a++)r[a]=window.parseInt(e.substr(2*a,2),16);return r},shaka.util.Uint8ArrayUtils.toHex=function(e){var t=shaka.util.BufferUtils.toUint8(e);e="";for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())1==(r=(r=r.value).toString(16)).length&&(r="0"+r),e+=r;return e},shaka.util.Uint8ArrayUtils.concat=function(){for(var e=$jscomp.getRestArguments.apply(0,arguments),t=0,r=$jscomp.makeIterator(e),a=r.next();!a.done;a=r.next())t+=a.value.byteLength;for(t=new Uint8Array(t),r=0,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())a=a.value,t.set(shaka.util.BufferUtils.toUint8(a),r),r+=a.byteLength;return t},goog.exportSymbol("shaka.util.Uint8ArrayUtils",shaka.util.Uint8ArrayUtils),goog.exportProperty(shaka.util.Uint8ArrayUtils,"concat",shaka.util.Uint8ArrayUtils.concat),goog.exportProperty(shaka.util.Uint8ArrayUtils,"toHex",shaka.util.Uint8ArrayUtils.toHex),goog.exportProperty(shaka.util.Uint8ArrayUtils,"fromHex",shaka.util.Uint8ArrayUtils.fromHex),goog.exportProperty(shaka.util.Uint8ArrayUtils,"fromBase64",shaka.util.Uint8ArrayUtils.fromBase64),goog.exportProperty(shaka.util.Uint8ArrayUtils,"toBase64",shaka.util.Uint8ArrayUtils.toBase64),goog.exportProperty(shaka.util.Uint8ArrayUtils,"toStandardBase64",shaka.util.Uint8ArrayUtils.toStandardBase64),shaka.dependencies=function(){},shaka.dependencies.add=function(e,t){if(!shaka.dependencies.Allowed[e])throw Error(e+" is not supported");shaka.dependencies.dependencies_.set(e,(function(){return t}))},shaka.dependencies.has=function(e){return shaka.dependencies.dependencies_.has(e)},shaka.dependencies.muxjs=function(){return shaka.dependencies.dependencies_.get(shaka.dependencies.Allowed.muxjs)()},goog.exportSymbol("shaka.dependencies",shaka.dependencies),goog.exportProperty(shaka.dependencies,"has",shaka.dependencies.has),goog.exportProperty(shaka.dependencies,"add",shaka.dependencies.add),shaka.dependencies.Allowed={muxjs:"muxjs"},goog.exportProperty(shaka.dependencies,"Allowed",shaka.dependencies.Allowed),shaka.dependencies.dependencies_=new Map([[shaka.dependencies.Allowed.muxjs,function(){return window.muxjs}]]),shaka.media.Transmuxer=function(e){var t=this;this.originalMimeType_=e,this.muxjs_=shaka.dependencies.muxjs(),this.transmuxPromise_=this.muxTransmuxer_=null,this.transmuxedData_=[],this.captions_=[],this.isTransmuxing_=!1,this.muxjs_&&(this.muxTransmuxer_=new this.muxjs_.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.muxTransmuxer_.on("data",(function(e){return t.onTransmuxed_(e)})),this.muxTransmuxer_.on("done",(function(){return t.onTransmuxDone_()})))},shaka.media.Transmuxer.prototype.destroy=function(){return this.muxTransmuxer_&&this.muxTransmuxer_.dispose(),this.muxTransmuxer_=null,Promise.resolve()},shaka.media.Transmuxer.isSupported=function(e,t){var r=shaka.media.Transmuxer,a=shaka.media.Capabilities,n=r.isTsContainer_(e),i=r.isAacContainer_(e);return!(!shaka.dependencies.muxjs()||!n&&!i)&&(i?a.isTypeSupported(r.convertAacCodecs_()):t?a.isTypeSupported(r.convertTsCodecs_(t,e)):(n=shaka.util.ManifestParserUtils.ContentType,t=r.convertTsCodecs_(n.AUDIO,e),e=r.convertTsCodecs_(n.VIDEO,e),a.isTypeSupported(t)||a.isTypeSupported(e)))},shaka.media.Transmuxer.isAacContainer_=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]},shaka.media.Transmuxer.isTsContainer_=function(e){return"mp2t"==e.toLowerCase().split(";")[0].split("/")[1]},shaka.media.Transmuxer.convertCodecs=function(e,t){var r=shaka.media.Transmuxer;return r.isAacContainer_(t)?r.convertAacCodecs_():r.isTsContainer_(t)?r.convertTsCodecs_(e,t):t},shaka.media.Transmuxer.convertAacCodecs_=function(){return'audio/mp4; codecs="mp4a.40.2"'},shaka.media.Transmuxer.convertTsCodecs_=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType;if(t=t.replace(/mp2t/i,"mp4"),e==r.AUDIO&&(t=t.replace("video","audio")),e=/avc1\.(66|77|100)\.(\d+)/.exec(t)){r="avc1.";var a=e[1];"66"==a?r+="4200":"77"==a?r+="4d00":(goog.asserts.assert("100"==a,"Legacy avc1 parsing code out of sync with regex!"),r+="6400"),a=Number(e[2]),goog.asserts.assert(256>a,"Invalid legacy avc1 level number!"),r+=(a>>4).toString(16),r+=(15&a).toString(16),t=t.replace(e[0],r)}return t},shaka.media.Transmuxer.prototype.getOrginalMimeType=function(){return this.originalMimeType_},shaka.media.Transmuxer.prototype.transmux=function(e){return goog.asserts.assert(this.muxTransmuxer_,"mux.js should be available."),goog.asserts.assert(!this.isTransmuxing_,"No transmuxing should be in progress."),this.isTransmuxing_=!0,this.transmuxPromise_=new shaka.util.PublicPromise,this.transmuxedData_=[],this.captions_=[],e=shaka.util.BufferUtils.toUint8(e),this.muxTransmuxer_.push(e),this.muxTransmuxer_.flush(),this.isTransmuxing_&&this.transmuxPromise_.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED)),this.transmuxPromise_},shaka.media.Transmuxer.prototype.resetCaptions=function(){this.muxTransmuxer_.resetCaptions()},shaka.media.Transmuxer.prototype.onTransmuxed_=function(e){this.captions_=e.captions,this.transmuxedData_.push(shaka.util.Uint8ArrayUtils.concat(e.initSegment,e.data))},shaka.media.Transmuxer.prototype.onTransmuxDone_=function(){var e={data:shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(this.transmuxedData_)),captions:this.captions_};this.transmuxPromise_.resolve(e),this.isTransmuxing_=!1},shaka.util.MimeUtils=function(){},shaka.util.MimeUtils.getFullType=function(e,t){return t&&(e+='; codecs="'+t+'"'),e},shaka.util.MimeUtils.getFullOrConvertedType=function(e,t,r){t=shaka.util.MimeUtils.getFullType(e,t);var a=shaka.util.ManifestParserUtils.ContentType;return shaka.media.Transmuxer.isSupported(t,r)?shaka.media.Transmuxer.convertCodecs(r,t):"video/mp2t"!=e&&r==a.AUDIO?t.replace("video","audio"):t},shaka.util.MimeUtils.getExtendedType=function(e){var t=[e.mimeType];return shaka.util.MimeUtils.EXTENDED_MIME_PARAMETERS_.forEach((function(r,a){(a=e[a])&&t.push(r+'="'+a+'"')})),"PQ"==e.hdr&&t.push('eotf="smpte2084"'),t.join(";")},shaka.util.MimeUtils.getContainerType=function(e){return e.split(";")[0].split("/")[1]},shaka.util.MimeUtils.splitCodecs=function(e){return e.split(",")},shaka.util.MimeUtils.getNormalizedCodec=function(e){var t=shaka.util.MimeUtils.getCodecParts_(e);switch(e=t[0],t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:return"ac-3";case"mp4a"===e&&"a6"===t:return"ec-3";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"dvh1"===e:case"dvhe"===e:return"dovi"}return e},shaka.util.MimeUtils.getCodecBase=function(e){return shaka.util.MimeUtils.getCodecParts_(e)[0]},shaka.util.MimeUtils.getBasicType=function(e){return e.split(";")[0]},shaka.util.MimeUtils.getCodecs=function(e){return(e=e.split(/ *; */)).shift(),(e=e.find((function(e){return e.startsWith("codecs=")})))?e.split("=")[1].replace(/^"|"$/g,""):""},shaka.util.MimeUtils.getCodecParts_=function(e){var t=e.split(".");return e=t[0],t.shift(),[e,t=t.join(".")]},goog.exportSymbol("shaka.util.MimeUtils",shaka.util.MimeUtils),goog.exportProperty(shaka.util.MimeUtils,"getFullType",shaka.util.MimeUtils.getFullType),shaka.util.MimeUtils.EXTENDED_MIME_PARAMETERS_=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE="application/cea-608",shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE="application/cea-708",shaka.text.TextEngine=function(e){this.parser_=null,this.displayer_=e,this.segmentRelativeVttTiming_=!1,this.appendWindowStart_=this.timestampOffset_=0,this.appendWindowEnd_=1/0,this.bufferEnd_=this.bufferStart_=null,this.selectedClosedCaptionId_="",this.closedCaptionsMap_=new Map},shaka.text.TextEngine.registerParser=function(e,t){shaka.text.TextEngine.parserMap_[e]=t},shaka.text.TextEngine.unregisterParser=function(e){delete shaka.text.TextEngine.parserMap_[e]},shaka.text.TextEngine.findParser=function(e){return shaka.text.TextEngine.parserMap_[e]},shaka.text.TextEngine.isTypeSupported=function(e){return!(!shaka.text.TextEngine.parserMap_[e]&&e!=shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE&&e!=shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE)},shaka.text.TextEngine.prototype.destroy=function(){return this.displayer_=this.parser_=null,this.closedCaptionsMap_.clear(),Promise.resolve()},shaka.text.TextEngine.prototype.setDisplayer=function(e){this.displayer_=e},shaka.text.TextEngine.prototype.initParser=function(e,t,r){e!=shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE&&e!=shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE&&(e=shaka.text.TextEngine.parserMap_[e],goog.asserts.assert(e,"Text type negotiation should have happened already"),this.parser_=e(),this.parser_.setSequenceMode?this.parser_.setSequenceMode(t):shaka.log.alwaysWarn('Text parsers should have a "setSequenceMode" method!'),this.segmentRelativeVttTiming_=r)},shaka.text.TextEngine.prototype.appendBuffer=function(e,t,r){var a,n,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return 1==l.nextAddress?(goog.asserts.assert(s.parser_,"The parser should already be initialized"),l.yield(Promise.resolve(),2)):s.parser_&&s.displayer_?null==t||null==r?(s.parser_.parseInit(shaka.util.BufferUtils.toUint8(e)),l.return()):(a=s.segmentRelativeVttTiming_?t:s.timestampOffset_,n={periodStart:s.timestampOffset_,segmentStart:t,segmentEnd:r,vttOffset:a},i=s.parser_.parseMedia(shaka.util.BufferUtils.toUint8(e),n),o=i.filter((function(e){return e.startTime>=s.appendWindowStart_&&e.startTime<s.appendWindowEnd_})),s.displayer_.append(o),null==s.bufferStart_?s.bufferStart_=Math.max(t,s.appendWindowStart_):(goog.asserts.assert(null!=s.bufferEnd_,"There should already be a buffered range end."),goog.asserts.assert(1>=t-s.bufferEnd_,"There should not be a gap in text references >1s")),s.bufferEnd_=Math.min(r,s.appendWindowEnd_),void l.jumpToEnd()):l.return()}))},shaka.text.TextEngine.prototype.remove=function(e,t){var r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return a.yield(Promise.resolve(),2);r.displayer_&&r.displayer_.remove(e,t)&&(null==r.bufferStart_?goog.asserts.assert(null==r.bufferEnd_,"end must be null if startTime is null"):(goog.asserts.assert(null!=r.bufferEnd_,"end must be non-null if startTime is non-null"),t<=r.bufferStart_||e>=r.bufferEnd_||(e<=r.bufferStart_&&t>=r.bufferEnd_?r.bufferStart_=r.bufferEnd_=null:e<=r.bufferStart_&&t<r.bufferEnd_?r.bufferStart_=t:e>r.bufferStart_&&t>=r.bufferEnd_?r.bufferEnd_=e:goog.asserts.assert(!1,"removal from the middle is not supported by TextEngine")))),a.jumpToEnd()}))},shaka.text.TextEngine.prototype.setTimestampOffset=function(e){this.timestampOffset_=e},shaka.text.TextEngine.prototype.setAppendWindow=function(e,t){this.appendWindowStart_=e,this.appendWindowEnd_=t},shaka.text.TextEngine.prototype.bufferStart=function(){return this.bufferStart_},shaka.text.TextEngine.prototype.bufferEnd=function(){return this.bufferEnd_},shaka.text.TextEngine.prototype.isBuffered=function(e){return null!=this.bufferStart_&&null!=this.bufferEnd_&&(e>=this.bufferStart_&&e<this.bufferEnd_)},shaka.text.TextEngine.prototype.bufferedAheadOf=function(e){return null==this.bufferEnd_||this.bufferEnd_<e?0:(goog.asserts.assert(null!=this.bufferStart_,"start should not be null if end is not null"),this.bufferEnd_-Math.max(e,this.bufferStart_))},shaka.text.TextEngine.prototype.setSelectedClosedCaptionId=function(e,t){if(this.selectedClosedCaptionId_=e,e=this.closedCaptionsMap_.get(e))for(var r=$jscomp.makeIterator(e.keys()),a=r.next();!a.done;a=r.next())(a=e.get(a.value).filter((function(e){return e.endTime<=t})))&&this.displayer_.append(a)},shaka.text.TextEngine.prototype.convertMuxjsCaptionsToShakaCaptions=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){r=r.value;var a=new shaka.text.Cue(r.startTime,r.endTime,r.text);t.push({stream:r.stream,cue:a})}return t},shaka.text.TextEngine.prototype.applyVideoTimestampOffsetRecursive_=function(e,t){e.startTime+=t,e.endTime+=t;for(var r=(e=$jscomp.makeIterator(e.nestedCues)).next();!r.done;r=e.next())this.applyVideoTimestampOffsetRecursive_(r.value,t)},shaka.text.TextEngine.prototype.storeAndAppendClosedCaptions=function(e,t,r,a){for(var n=t+" "+r,i=new Map,o=(e=$jscomp.makeIterator(e)).next();!o.done;o=e.next()){var s=o.value;o=s.stream,s=s.cue,i.has(o)||i.set(o,new Map),i.get(o).has(n)||i.get(o).set(n,[]),this.applyVideoTimestampOffsetRecursive_(s,a),s.startTime>=this.appendWindowStart_&&s.startTime<this.appendWindowEnd_&&(i.get(o).get(n).push(s),o==this.selectedClosedCaptionId_&&this.displayer_.append([s]))}for(n=(a=$jscomp.makeIterator(i.keys())).next();!n.done;n=a.next())for(n=n.value,this.closedCaptionsMap_.has(n)||this.closedCaptionsMap_.set(n,new Map),o=(e=$jscomp.makeIterator(i.get(n).keys())).next();!o.done;o=e.next())o=o.value,s=i.get(n).get(o),this.closedCaptionsMap_.get(n).set(o,s);this.bufferStart_=null==this.bufferStart_?Math.max(t,this.appendWindowStart_):Math.min(this.bufferStart_,Math.max(t,this.appendWindowStart_)),this.bufferEnd_=Math.max(this.bufferEnd_,Math.min(r,this.appendWindowEnd_))},shaka.text.TextEngine.prototype.getNumberOfClosedCaptionChannels=function(){return this.closedCaptionsMap_.size},shaka.text.TextEngine.prototype.getNumberOfClosedCaptionsInChannel=function(e){return(e=this.closedCaptionsMap_.get(e))?e.size:0},goog.exportSymbol("shaka.text.TextEngine",shaka.text.TextEngine),goog.exportProperty(shaka.text.TextEngine.prototype,"destroy",shaka.text.TextEngine.prototype.destroy),goog.exportProperty(shaka.text.TextEngine,"findParser",shaka.text.TextEngine.findParser),goog.exportProperty(shaka.text.TextEngine,"unregisterParser",shaka.text.TextEngine.unregisterParser),goog.exportProperty(shaka.text.TextEngine,"registerParser",shaka.text.TextEngine.registerParser),shaka.text.TextEngine.parserMap_={},shaka.util.LanguageUtils=function(){},shaka.util.LanguageUtils.areLocaleCompatible=function(e,t){var r=shaka.util.LanguageUtils;return(e=r.normalize(e))==(t=r.normalize(t))},shaka.util.LanguageUtils.areLanguageCompatible=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),t=r.normalize(t),e=r.disassembleLocale_(e),t=r.disassembleLocale_(t),e[0]==t[0]},shaka.util.LanguageUtils.isParentOf=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),t=r.normalize(t),e=r.disassembleLocale_(e),t=r.disassembleLocale_(t),e[0]==t[0]&&1==e.length&&2==t.length},shaka.util.LanguageUtils.isSiblingOf=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),t=r.normalize(t),e=r.disassembleLocale_(e),t=r.disassembleLocale_(t),2==e.length&&2==t.length&&e[0]==t[0]},shaka.util.LanguageUtils.normalize=function(e){var t=shaka.util.LanguageUtils,r=e.split("-");return e=r[0]||"",r=r[1]||"",e=e.toLowerCase(),e=t.isoMap_.get(e)||e,(r=r.toUpperCase())?e+"-"+r:e},shaka.util.LanguageUtils.areSiblings=function(e,t){var r=shaka.util.LanguageUtils,a=r.getBase(e);return r=r.getBase(t),e!=a&&t!=r&&a==r},shaka.util.LanguageUtils.relatedness=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),(t=r.normalize(t))==e?4:r.isParentOf(t,e)?3:r.isSiblingOf(t,e)?2:r.isParentOf(e,t)?1:0},shaka.util.LanguageUtils.getBase=function(e){var t=shaka.util.LanguageUtils,r=e.indexOf("-");return e=(e=0<=r?e.substring(0,r):e).toLowerCase(),t.isoMap_.get(e)||e},shaka.util.LanguageUtils.getLocaleForText=function(e){var t=shaka.util.LanguageUtils;return goog.asserts.assert(e.type==shaka.util.ManifestParserUtils.ContentType.TEXT,"Can only get language from text streams"),t.normalize(e.language||"und")},shaka.util.LanguageUtils.getLocaleForVariant=function(e){var t=shaka.util.LanguageUtils;return e.language?t.normalize(e.language):e.audio&&e.audio.language?t.normalize(e.audio.language):e.video&&e.video.language?t.normalize(e.video.language):"und"},shaka.util.LanguageUtils.findClosestLocale=function(e,t){var r=shaka.util.LanguageUtils;e=r.normalize(e);var a=new Set,n=$jscomp.makeIterator(t);for(t=n.next();!t.done;t=n.next())a.add(r.normalize(t.value));for(t=(n=$jscomp.makeIterator(a)).next();!t.done;t=n.next())if((t=t.value)==e)return t;for(t=(n=$jscomp.makeIterator(a)).next();!t.done;t=n.next())if(t=t.value,r.isParentOf(t,e))return t;for(t=(n=$jscomp.makeIterator(a)).next();!t.done;t=n.next())if(t=t.value,r.isSiblingOf(t,e))return t;for(t=(a=$jscomp.makeIterator(a)).next();!t.done;t=a.next())if(t=t.value,r.isParentOf(e,t))return t;return null},shaka.util.LanguageUtils.disassembleLocale_=function(e){var t=e.split("-");return goog.asserts.assert(2>=t.length,["Locales should not have more than 2 components. ",e," has too many components."].join()),t},goog.exportSymbol("shaka.util.LanguageUtils",shaka.util.LanguageUtils),goog.exportProperty(shaka.util.LanguageUtils,"findClosestLocale",shaka.util.LanguageUtils.findClosestLocale),goog.exportProperty(shaka.util.LanguageUtils,"getLocaleForVariant",shaka.util.LanguageUtils.getLocaleForVariant),goog.exportProperty(shaka.util.LanguageUtils,"getLocaleForText",shaka.util.LanguageUtils.getLocaleForText),goog.exportProperty(shaka.util.LanguageUtils,"getBase",shaka.util.LanguageUtils.getBase),goog.exportProperty(shaka.util.LanguageUtils,"relatedness",shaka.util.LanguageUtils.relatedness),goog.exportProperty(shaka.util.LanguageUtils,"areSiblings",shaka.util.LanguageUtils.areSiblings),goog.exportProperty(shaka.util.LanguageUtils,"normalize",shaka.util.LanguageUtils.normalize),goog.exportProperty(shaka.util.LanguageUtils,"isSiblingOf",shaka.util.LanguageUtils.isSiblingOf),goog.exportProperty(shaka.util.LanguageUtils,"isParentOf",shaka.util.LanguageUtils.isParentOf),goog.exportProperty(shaka.util.LanguageUtils,"areLanguageCompatible",shaka.util.LanguageUtils.areLanguageCompatible),goog.exportProperty(shaka.util.LanguageUtils,"areLocaleCompatible",shaka.util.LanguageUtils.areLocaleCompatible),shaka.util.LanguageUtils.isoMap_=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),shaka.util.MultiMap=function(){this.map_={}},shaka.util.MultiMap.prototype.push=function(e,t){this.map_.hasOwnProperty(e)?this.map_[e].push(t):this.map_[e]=[t]},shaka.util.MultiMap.prototype.get=function(e){return(e=this.map_[e])?e.slice():null},shaka.util.MultiMap.prototype.getAll=function(){var e,t=[];for(e in this.map_)t.push.apply(t,$jscomp.arrayFromIterable(this.map_[e]));return t},shaka.util.MultiMap.prototype.remove=function(e,t){e in this.map_&&(this.map_[e]=this.map_[e].filter((function(e){return e!=t})),0==this.map_[e].length&&delete this.map_[e])},shaka.util.MultiMap.prototype.clear=function(){this.map_={}},shaka.util.MultiMap.prototype.forEach=function(e){for(var t in this.map_)e(t,this.map_[t])},shaka.util.MultiMap.prototype.size=function(){return Object.keys(this.map_).length},shaka.util.MultiMap.prototype.keys=function(){return Object.keys(this.map_)},shaka.util.StreamUtils=function(){},shaka.util.StreamUtils.chooseCodecsAndFilterManifest=function(e,t,r,a,n){var i=shaka.util.StreamUtils,o=e.variants;(t.length||r.length)&&(o=i.choosePreferredCodecs(o,t,r)),o=i.filterVariantsByAudioChannelCount(o,a),t=i.getVariantsByCodecs_(o),t=i.filterVariantsByDensity_(t);var s=i.chooseCodecsByDecodingAttributes_(t,n);e.variants=e.variants.filter((function(e){return i.getVariantCodecs_(e)==s||(shaka.log.debug("Dropping Variant (better codec available)",e),!1)}))},shaka.util.StreamUtils.getVariantsByCodecs_=function(e){for(var t=new shaka.util.MultiMap,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){r=r.value;var a=shaka.util.StreamUtils.getVariantCodecs_(r);t.push(a,r)}return t},shaka.util.StreamUtils.filterVariantsByDensity_=function(e){var t=0,r=new Map,a=e.size();return e.forEach((function(e,n){for(var i=(n=$jscomp.makeIterator(n)).next();!i.done;i=n.next()){var o=(i=i.value).video;if(o&&o.width&&o.height){o=o.width*o.height*(o.frameRate||1),r.has(o)||r.set(o,new shaka.util.MultiMap);var s=r.get(o);s.push(e,i),s.size()===a&&(t=Math.max(t,o))}}})),t?r.get(t):e},shaka.util.StreamUtils.choosePreferredCodecs=function(e,t,r){for(var a={},n=(t=$jscomp.makeIterator(t)).next();!n.done;a={$jscomp$loop$prop$videoCodec$630:a.$jscomp$loop$prop$videoCodec$630},n=t.next())if(a.$jscomp$loop$prop$videoCodec$630=n.value,(n=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.$jscomp$loop$prop$videoCodec$630)}}(a))).length){e=n;break}for(a={},t=(r=$jscomp.makeIterator(r)).next();!t.done;a={$jscomp$loop$prop$audioCodec$632:a.$jscomp$loop$prop$audioCodec$632},t=r.next())if(a.$jscomp$loop$prop$audioCodec$632=t.value,(t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.$jscomp$loop$prop$audioCodec$632)}}(a))).length){e=t;break}return e},shaka.util.StreamUtils.chooseCodecsByDecodingAttributes_=function(e,t){for(var r=shaka.util.StreamUtils,a=(t=$jscomp.makeIterator(t)).next();!a.done;a=t.next())if((a=a.value)==r.DecodingAttributes.SMOOTH||a==r.DecodingAttributes.POWER){if(1==(e=r.chooseCodecsByMediaCapabilitiesInfo_(e,a)).size())return e.keys()[0]}else if(a==r.DecodingAttributes.BANDWIDTH)break;return r.findCodecsByLowestBandwidth_(e)},shaka.util.StreamUtils.chooseCodecsByMediaCapabilitiesInfo_=function(e,t){var r=0,a=new shaka.util.MultiMap;return e.forEach((function(e,n){for(var i=0,o=0,s=$jscomp.makeIterator(n),l=s.next();!l.done;l=s.next())(l=l.value).decodingInfos.length&&(i+=l.decodingInfos[0][t]?1:0,o++);i/=o,shaka.log.debug("codecs",e,"avg",t,i),i>r?(a.clear(),a.push(e,n),r=i):i==r&&a.push(e,n)})),a},shaka.util.StreamUtils.findCodecsByLowestBandwidth_=function(e){var t="",r=1/0;return e.forEach((function(e,a){for(var n=0,i=0,o=(a=$jscomp.makeIterator(a)).next();!o.done;o=a.next())n+=o.value.bandwidth||0,++i;n/=i,shaka.log.debug("codecs",e,"avg bandwidth",n),n<r&&(t=e,r=n)})),goog.asserts.assert(""!==t,"Should have chosen codecs!"),goog.asserts.assert(!isNaN(r),"Bandwidth should be a number!"),t},shaka.util.StreamUtils.getVariantCodecs_=function(e){var t="";e.video&&(t=shaka.util.MimeUtils.getNormalizedCodec(e.video.codecs));var r="";return e.audio&&(r=shaka.util.MimeUtils.getNormalizedCodec(e.audio.codecs)),t+"-"+r},shaka.util.StreamUtils.filterByRestrictions=function(e,t,r){e.variants=e.variants.filter((function(e){return shaka.util.StreamUtils.meetsRestrictions(e,t,r)}))},shaka.util.StreamUtils.meetsRestrictions=function(e,t,r){var a=function(e,t,r){return e>=t&&e<=r},n=e.video;if(0!=e.disabledUntilTime){if(e.disabledUntilTime>Date.now()/1e3)return!1;e.disabledUntilTime=0}return!(n&&n.width&&n.height&&(!a(n.width,t.minWidth,Math.min(t.maxWidth,r.width))||!a(n.height,t.minHeight,Math.min(t.maxHeight,r.height))||!a(n.width*n.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!a(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!a(e.bandwidth,t.minBandwidth,t.maxBandwidth))},shaka.util.StreamUtils.applyRestrictions=function(e,t,r){for(var a=!1,n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){var i=(n=n.value).allowedByApplication;n.allowedByApplication=shaka.util.StreamUtils.meetsRestrictions(n,t,r),i!=n.allowedByApplication&&(a=!0)}return a},shaka.util.StreamUtils.filterManifest=function(e,t,r){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return 1==e.nextAddress?e.yield(shaka.util.StreamUtils.filterManifestByMediaCapabilities(r,0<r.offlineSessionIds.length),2):(shaka.util.StreamUtils.filterManifestByCurrentVariant(t,r),shaka.util.StreamUtils.filterTextStreams_(r),e.yield(shaka.util.StreamUtils.filterImageStreams_(r),0))}))},shaka.util.StreamUtils.filterManifestByMediaCapabilities=function(e,t){return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return goog.asserts.assert(navigator.mediaCapabilities,"MediaCapabilities should be valid."),r.yield(shaka.util.StreamUtils.getDecodingInfosForVariants(e.variants,t,!1),2);e.variants=e.variants.filter((function(e){var t=e.video,r=shaka.util.ManifestParserUtils.ContentType,a=shaka.media.Capabilities;if(t){var n=shaka.util.StreamUtils.getCorrectVideoCodecs_(t.codecs);if(t.codecs.includes(",")){var i=t.codecs.split(",");n=shaka.util.ManifestParserUtils.guessCodecs(r.VIDEO,i),n=shaka.util.StreamUtils.getCorrectVideoCodecs_(n),i=shaka.util.ManifestParserUtils.guessCodecs(r.AUDIO,i),i=shaka.util.StreamUtils.getCorrectAudioCodecs_(i);var o=shaka.util.MimeUtils.getFullOrConvertedType(t.mimeType,i,r.AUDIO);if(!a.isTypeSupported(o))return!1;n=[n,i].join()}if(i=shaka.util.MimeUtils.getFullOrConvertedType(t.mimeType,n,r.VIDEO),!a.isTypeSupported(i))return!1;t.codecs=n}if(n=e.audio){if(i=shaka.util.StreamUtils.getCorrectAudioCodecs_(n.codecs),r=shaka.util.MimeUtils.getFullOrConvertedType(n.mimeType,i,r.AUDIO),!a.isTypeSupported(r))return!1;n.codecs=i}return shaka.util.Platform.isXboxOne()&&t&&(t.width&&1920<t.width||t.height&&1080<t.height)&&(t.codecs.includes("avc1.")||t.codecs.includes("avc3."))?(shaka.log.debug("Dropping variant - not compatible with platform",shaka.util.StreamUtils.getVariantSummaryString_(e)),!1):((t=e.decodingInfos.some((function(e){return e.supported})))||shaka.log.debug("Dropping variant - not compatible with platform",shaka.util.StreamUtils.getVariantSummaryString_(e)),t)})),r.jumpToEnd()}))},shaka.util.StreamUtils.getDecodingInfosForVariants=function(e,t,r){var a,n,i,o,s,l,u,c,d,p;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){if(e.some((function(e){return e.decodingInfos.length})))return shaka.log.debug("Already got the variants' decodingInfo."),h.return();for(a=navigator.mediaCapabilities,n=[],i=function(e,t){var r,n;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(i.setCatchFinallyBlocks(2),i.yield(a.decodingInfo(t),4)):2!=i.nextAddress?(r=i.yieldResult,e.decodingInfos.push(r),i.leaveTryBlock(0)):(n=i.enterCatchBlock(),shaka.log.info("MediaCapabilities.decodingInfo() failed.",JSON.stringify(t),n),void i.jumpToEnd())}))},o=$jscomp.makeIterator(e),s=o.next();!s.done;s=o.next())for(l=s.value,u=shaka.util.StreamUtils.getDecodingConfigs_(l,t,r),c=$jscomp.makeIterator(u),d=c.next();!d.done;d=c.next())p=d.value,n.push(i(l,p));return h.yield(Promise.all(n),0)}))},shaka.util.StreamUtils.getDecodingConfigs_=function(e,t,r){var a=e.audio,n=e.video,i=shaka.util.ManifestParserUtils.ContentType;if(r={type:r?"file":"media-source"},n){var o=n.codecs;if(n.codecs.includes(",")){var s=n.codecs.split(",");o=shaka.util.ManifestParserUtils.guessCodecs(i.VIDEO,s),o=shaka.util.StreamUtils.getCorrectVideoCodecs_(o),s=shaka.util.ManifestParserUtils.guessCodecs(i.AUDIO,s),s=shaka.util.MimeUtils.getFullOrConvertedType(n.mimeType,s,i.AUDIO),r.audio={contentType:s,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1}}if(o=shaka.util.StreamUtils.getCorrectVideoCodecs_(o),o=shaka.util.MimeUtils.getFullOrConvertedType(n.mimeType,o,i.VIDEO),r.video={contentType:o,width:n.width||64,height:n.height||64,bitrate:n.bandwidth||e.bandwidth||1,framerate:n.frameRate||1},n.hdr)switch(n.hdr){case"SDR":r.video.transferFunction="srgb";break;case"PQ":r.video.transferFunction="pq";break;case"HLG":r.video.transferFunction="hlg"}}if(a&&(o=shaka.util.StreamUtils.getCorrectAudioCodecs_(a.codecs),i=shaka.util.MimeUtils.getFullOrConvertedType(a.mimeType,o,i.AUDIO),r.audio={contentType:i,channels:a.channelsCount||2,bitrate:a.bandwidth||e.bandwidth||1,samplerate:a.audioSamplingRate||1,spatialRendering:a.spatialAudio}),!(o=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])).length)return[r];e=[],i=new Map;for(var l=(o=$jscomp.makeIterator(o)).next();!l.done;l=o.next())s=l.value,i.get(s.keySystem)||i.set(s.keySystem,[]),i.get(s.keySystem).push(s);o=t?"required":"optional",t=t?["persistent-license"]:["temporary"];for(var u=(s=$jscomp.makeIterator(i.keys())).next();!u.done;u=s.next()){var c=u.value;u=Object.assign({},r);var d=i.get(c);for(c={keySystem:c,initDataType:"cenc",persistentState:o,distinctiveIdentifier:"optional",sessionTypes:t},l=(d=$jscomp.makeIterator(d)).next();!l.done;l=d.next()){if((l=l.value).initData&&l.initData.length){for(var p=new Set,h=$jscomp.makeIterator(l.initData),f=h.next();!f.done;f=h.next())p.add(f.value.initDataType);1<p.size&&shaka.log.v2("DrmInfo contains more than one initDataType,","and we use the initDataType of the first initData.",l),c.initDataType=l.initData[0].initDataType}l.distinctiveIdentifierRequired&&(c.distinctiveIdentifier="required"),l.persistentStateRequired&&(c.persistentState="required"),l.sessionType&&(c.sessionTypes=[l.sessionType]),a&&(""!=l.audioRobustness?c.audio?c.audio.robustness=c.audio.robustness||l.audioRobustness:c.audio={robustness:l.audioRobustness}:c.audio||(c.audio={})),n&&(""!=l.videoRobustness?c.video?c.video.robustness=c.video.robustness||l.videoRobustness:c.video={robustness:l.videoRobustness}:c.video||(c.video={}))}u.keySystemConfiguration=c,e.push(u)}return e},shaka.util.StreamUtils.getCorrectAudioCodecs_=function(e){return shaka.util.Platform.isTizen()&&"ac-3"==e.toLowerCase()?"ec-3":e},shaka.util.StreamUtils.getCorrectVideoCodecs_=function(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",(e+=parseInt(t.shift(),10).toString(16))+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e},shaka.util.StreamUtils.filterManifestByCurrentVariant=function(e,t){var r=shaka.util.StreamUtils;t.variants=t.variants.filter((function(t){var a=t.audio;return t=t.video,a&&e&&e.audio&&!r.areStreamsCompatible_(a,e.audio)?(shaka.log.debug("Droping variant - not compatible with active audio","active audio",r.getStreamSummaryString_(e.audio),"variant.audio",r.getStreamSummaryString_(a)),!1):!(t&&e&&e.video&&!r.areStreamsCompatible_(t,e.video))||(shaka.log.debug("Droping variant - not compatible with active video","active video",r.getStreamSummaryString_(e.video),"variant.video",r.getStreamSummaryString_(t)),!1)}))},shaka.util.StreamUtils.filterTextStreams_=function(e){e.textStreams=e.textStreams.filter((function(e){var t=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs);return(t=shaka.text.TextEngine.isTypeSupported(t))||shaka.log.debug("Dropping text stream. Is not supported by the platform.",e),t}))},shaka.util.StreamUtils.filterImageStreams_=function(e){var t,r,a,n,i,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:t=[],r=$jscomp.makeIterator(e.imageStreams),a=r.next();case 2:if(a.done){l.jumpTo(4);break}if(n=a.value,i=n.mimeType,shaka.util.StreamUtils.supportedImageMimeTypes_.has(i)){l.jumpTo(5);break}if(!(o=shaka.util.StreamUtils.minImage_.get(i))){shaka.util.StreamUtils.supportedImageMimeTypes_.set(i,!1),l.jumpTo(5);break}return l.yield(shaka.util.StreamUtils.isImageSupported_(o),7);case 7:s=l.yieldResult,shaka.util.StreamUtils.supportedImageMimeTypes_.set(i,s);case 5:shaka.util.StreamUtils.supportedImageMimeTypes_.get(i)?t.push(n):shaka.log.debug("Dropping image stream. Is not supported by the platform.",n),a=r.next(),l.jumpTo(2);break;case 4:e.imageStreams=t,l.jumpToEnd()}}))},shaka.util.StreamUtils.isImageSupported_=function(e){return new Promise((function(t){var r=new Image;r.src=e,"decode"in r?r.decode().then((function(){t(!0)})).catch((function(){t(!1)})):r.onload=r.onerror=function(){t(2===r.height)}}))},shaka.util.StreamUtils.areStreamsCompatible_=function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]},shaka.util.StreamUtils.variantToTrack=function(e){var t=e.audio,r=e.video,a=t?t.mimeType:null,n=r?r.mimeType:null,i=t?t.codecs:null,o=r?r.codecs:null,s=[];o&&s.push(o),i&&s.push(i);var l=[];r&&l.push(r.mimeType),t&&l.push(t.mimeType),l=l[0]||null;var u=[];t&&u.push(t.kind),r&&u.push(r.kind),u=u[0]||null;var c=new Set;if(t)for(var d=$jscomp.makeIterator(t.roles),p=d.next();!p.done;p=d.next())c.add(p.value);if(r)for(p=(d=$jscomp.makeIterator(r.roles)).next();!p.done;p=d.next())c.add(p.value);return e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:u,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:l,audioMimeType:a,videoMimeType:n,codecs:s.join(", "),audioCodec:i,videoCodec:o,primary:e.primary,roles:Array.from(c),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null},r&&(e.videoId=r.id,e.originalVideoId=r.originalId,e.width=r.width||null,e.height=r.height||null,e.frameRate=r.frameRate||null,e.pixelAspectRatio=r.pixelAspectRatio||null,e.videoBandwidth=r.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles),e},shaka.util.StreamUtils.textStreamToTrack=function(e){return{id:e.id,active:!1,type:shaka.util.ManifestParserUtils.ContentType.TEXT,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null}},shaka.util.StreamUtils.imageStreamToTrack=function(e){var t=shaka.util.ManifestParserUtils.ContentType,r=e.width||null,a=e.height||null,n=null;e.segmentIndex&&(n=e.segmentIndex.get(0));var i=e.tilesLayout;return n&&(i=n.getTilesLayout()||i),i&&null!=r&&(r/=Number(i.split("x")[0])),i&&null!=a&&(a/=Number(i.split("x")[1])),{id:e.id,active:!1,type:t.IMAGE,bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:r,height:a,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:i||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId}},shaka.util.StreamUtils.html5TrackId=function(e){return e.__shaka_id||(e.__shaka_id=shaka.util.StreamUtils.nextTrackId_++),e.__shaka_id},shaka.util.StreamUtils.html5TextTrackToTrack=function(e){var t=shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE,r=shaka.util.StreamUtils.html5TrackToGenericShakaTrack_(e);return r.active="disabled"!=e.mode,r.type="text",r.originalTextId=e.id,"captions"==e.kind&&(r.mimeType=t),e.kind&&(r.roles=[e.kind]),"forced"==e.kind&&(r.forced=!0),r},shaka.util.StreamUtils.html5AudioTrackToTrack=function(e){var t=shaka.util.StreamUtils.html5TrackToGenericShakaTrack_(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t},shaka.util.StreamUtils.html5TrackToGenericShakaTrack_=function(e){return{id:shaka.util.StreamUtils.html5TrackId(e),active:!1,type:"",bandwidth:0,language:shaka.util.LanguageUtils.normalize(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null}},shaka.util.StreamUtils.isPlayable=function(e){return e.allowedByApplication&&e.allowedByKeySystem},shaka.util.StreamUtils.getPlayableVariants=function(e){return e.filter((function(e){return shaka.util.StreamUtils.isPlayable(e)}))},shaka.util.StreamUtils.filterVariantsByAudioChannelCount=function(e,t){for(var r=e.filter((function(e){return e.audio&&e.audio.channelsCount})),a=new Map,n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next()){var i=(n=n.value).audio.channelsCount;goog.asserts.assert(null!=i,"Must have count after filtering!"),a.has(i)||a.set(i,[]),a.get(i).push(n)}return 0==(r=Array.from(a.keys())).length?e:(e=r.filter((function(e){return e<=t}))).length?a.get(Math.max.apply(Math,$jscomp.arrayFromIterable(e))):a.get(Math.min.apply(Math,$jscomp.arrayFromIterable(r)))},shaka.util.StreamUtils.filterStreamsByLanguageAndRole=function(e,t,r,a){var n=shaka.util.LanguageUtils,i=e,o=e.filter((function(e){return e.primary}));o.length&&(i=o);var s=i.length?i[0].language:"";if(i=i.filter((function(e){return e.language==s})),t){var l=n.findClosestLocale(n.normalize(t),e.map((function(e){return e.language})));l&&(i=e.filter((function(e){return n.normalize(e.language)==l})))}if(i=i.filter((function(e){return e.forced==a})),r){if((e=shaka.util.StreamUtils.filterTextStreamsByRole_(i,r)).length)return e;shaka.log.warning("No exact match for the text role could be found.")}else if((e=i.filter((function(e){return 0==e.roles.length}))).length)return e;return(e=i.map((function(e){return e.roles})).reduce(shaka.util.Functional.collapseArrays,[])).length?shaka.util.StreamUtils.filterTextStreamsByRole_(i,e[0]):i},shaka.util.StreamUtils.filterTextStreamsByRole_=function(e,t){return e.filter((function(e){return e.roles.includes(t)}))},shaka.util.StreamUtils.isAudio=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.AUDIO},shaka.util.StreamUtils.isVideo=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.VIDEO},shaka.util.StreamUtils.getVariantStreams=function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t},shaka.util.StreamUtils.getVariantSummaryString_=function(e){var t=[];return e.audio&&t.push(shaka.util.StreamUtils.getStreamSummaryString_(e.audio)),e.video&&t.push(shaka.util.StreamUtils.getStreamSummaryString_(e.video)),t.join(", ")},shaka.util.StreamUtils.getStreamSummaryString_=function(e){return shaka.util.StreamUtils.isAudio(e)?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:shaka.util.StreamUtils.isVideo(e)?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"},shaka.util.StreamUtils.nextTrackId_=0,shaka.util.StreamUtils.DecodingAttributes={SMOOTH:"smooth",POWER:"powerEfficient",BANDWIDTH:"bandwidth"},shaka.util.StreamUtils.supportedImageMimeTypes_=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),shaka.util.StreamUtils.minWebPImage_="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",shaka.util.StreamUtils.minAvifImage_="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",shaka.util.StreamUtils.minImage_=(new Map).set("image/webp",shaka.util.StreamUtils.minWebPImage_).set("image/avif",shaka.util.StreamUtils.minAvifImage_),shaka.abr.SimpleAbrManager=function(){var e=this;this.switch_=null,this.enabled_=!1,this.bandwidthEstimator_=new shaka.abr.EwmaBandwidthEstimator,navigator.connection&&navigator.connection.addEventListener("change",(function(){if(e.config_.useNetworkInformation&&e.enabled_){e.bandwidthEstimator_=new shaka.abr.EwmaBandwidthEstimator,e.config_&&e.bandwidthEstimator_.configure(e.config_.advanced);var t=e.chooseVariant();t&&e.switch_(t)}})),this.variants_=[],this.playbackRate_=1,this.startupComplete_=!1,this.resizeObserver_=this.mediaElement_=this.config_=this.lastTimeChosenMs_=null,this.resizeObserverTimer_=new shaka.util.Timer((function(){if(e.config_.restrictToElementSize){var t=e.chooseVariant();t&&e.switch_(t)}}))},shaka.abr.SimpleAbrManager.prototype.stop=function(){this.switch_=null,this.enabled_=!1,this.variants_=[],this.playbackRate_=1,this.mediaElement_=this.lastTimeChosenMs_=null,this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),this.resizeObserverTimer_.stop()},shaka.abr.SimpleAbrManager.prototype.init=function(e){this.switch_=e},shaka.abr.SimpleAbrManager.prototype.chooseVariant=function(){var e=shaka.abr.SimpleAbrManager,t=1/0,r=1/0;this.config_.restrictToScreenSize&&(r=this.config_.ignoreDevicePixelRatio?1:window.devicePixelRatio,t=window.screen.height*r,r*=window.screen.width),this.resizeObserver_&&this.config_.restrictToElementSize&&(r=this.config_.ignoreDevicePixelRatio?1:window.devicePixelRatio,t=this.mediaElement_.clientWidth*r,r*=this.mediaElement_.clientHeight),t=e.filterAndSortVariants_(this.config_.restrictions,this.variants_,t,r),r=this.getDefaultBandwidth_(),r=this.bandwidthEstimator_.getBandwidthEstimate(r),this.variants_.length&&!t.length&&(shaka.log.warning("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),t=[(t=e.filterAndSortVariants_(null,this.variants_,1/0,1/0))[0]]),e=t[0]||null;for(var a=0;a<t.length;a++){for(var n=t[a],i=isNaN(this.playbackRate_)?1:Math.abs(this.playbackRate_),o=i*n.bandwidth,s=o/this.config_.bandwidthDowngradeTarget,l={bandwidth:1/0},u=a+1;u<t.length;u++)if(n.bandwidth!=t[u].bandwidth){l=t[u];break}i=i*l.bandwidth/this.config_.bandwidthUpgradeTarget,shaka.log.v2("Bandwidth ranges:",(o/1e6).toFixed(3),(s/1e6).toFixed(3),(i/1e6).toFixed(3)),r>=s&&r<=i&&e.bandwidth!=n.bandwidth&&(e=n)}return this.lastTimeChosenMs_=Date.now(),e},shaka.abr.SimpleAbrManager.prototype.enable=function(){this.enabled_=!0},shaka.abr.SimpleAbrManager.prototype.disable=function(){this.enabled_=!1},shaka.abr.SimpleAbrManager.prototype.segmentDownloaded=function(e,t){shaka.log.v2("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.lastTimeChosenMs_,"enabled="+this.enabled_),goog.asserts.assert(0<=e,"expected a non-negative duration"),this.bandwidthEstimator_.sample(e,t),null!=this.lastTimeChosenMs_&&this.enabled_&&this.suggestStreams_()},shaka.abr.SimpleAbrManager.prototype.getBandwidthEstimate=function(){var e=this.getDefaultBandwidth_();return this.bandwidthEstimator_.getBandwidthEstimate(e)},shaka.abr.SimpleAbrManager.prototype.setVariants=function(e){this.variants_=e},shaka.abr.SimpleAbrManager.prototype.playbackRateChanged=function(e){this.playbackRate_=e},shaka.abr.SimpleAbrManager.prototype.setMediaElement=function(e){var t=this;this.mediaElement_=e,this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),this.mediaElement_&&"ResizeObserver"in window&&(this.resizeObserver_=new ResizeObserver((function(){t.resizeObserverTimer_.tickAfter(shaka.abr.SimpleAbrManager.RESIZE_OBSERVER_BATCH_TIME)})),this.resizeObserver_.observe(this.mediaElement_))},shaka.abr.SimpleAbrManager.prototype.configure=function(e){this.config_=e,this.bandwidthEstimator_&&this.config_&&this.bandwidthEstimator_.configure(this.config_.advanced)},shaka.abr.SimpleAbrManager.prototype.suggestStreams_=function(){if(shaka.log.v2("Suggesting Streams..."),goog.asserts.assert(null!=this.lastTimeChosenMs_,"lastTimeChosenMs_ should not be null"),this.startupComplete_){if(Date.now()-this.lastTimeChosenMs_<1e3*this.config_.switchInterval)return void shaka.log.v2("Still within switch interval...")}else{if(!this.bandwidthEstimator_.hasGoodEstimate())return void shaka.log.v2("Still waiting for a good estimate...");this.startupComplete_=!0}var e=this.chooseVariant(),t=this.getDefaultBandwidth_();t=this.bandwidthEstimator_.getBandwidthEstimate(t),t=Math.round(t/1e3),e&&(shaka.log.debug("Calling switch_(), bandwidth="+t+" kbps"),this.switch_(e))},shaka.abr.SimpleAbrManager.prototype.getDefaultBandwidth_=function(){var e=this.config_.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.config_.useNetworkInformation&&(e=1e6*navigator.connection.downlink),e},shaka.abr.SimpleAbrManager.filterAndSortVariants_=function(e,t,r,a){return e&&(t=t.filter((function(t){return goog.asserts.assert(e,"Restrictions should exist!"),shaka.util.StreamUtils.meetsRestrictions(t,e,{width:a,height:r})}))),t.sort((function(e,t){return e.bandwidth-t.bandwidth}))},goog.exportSymbol("shaka.abr.SimpleAbrManager",shaka.abr.SimpleAbrManager),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"configure",shaka.abr.SimpleAbrManager.prototype.configure),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"setMediaElement",shaka.abr.SimpleAbrManager.prototype.setMediaElement),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"playbackRateChanged",shaka.abr.SimpleAbrManager.prototype.playbackRateChanged),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"setVariants",shaka.abr.SimpleAbrManager.prototype.setVariants),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"getBandwidthEstimate",shaka.abr.SimpleAbrManager.prototype.getBandwidthEstimate),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"segmentDownloaded",shaka.abr.SimpleAbrManager.prototype.segmentDownloaded),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"disable",shaka.abr.SimpleAbrManager.prototype.disable),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"enable",shaka.abr.SimpleAbrManager.prototype.enable),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"chooseVariant",shaka.abr.SimpleAbrManager.prototype.chooseVariant),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"init",shaka.abr.SimpleAbrManager.prototype.init),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"stop",shaka.abr.SimpleAbrManager.prototype.stop),shaka.abr.SimpleAbrManager.RESIZE_OBSERVER_BATCH_TIME=1,shaka.deprecate={},shaka.deprecate.Version=function(e,t){this.major_=e,this.minor_=t},shaka.deprecate.Version.prototype.major=function(){return this.major_},shaka.deprecate.Version.prototype.minor=function(){return this.minor_},shaka.deprecate.Version.prototype.compareTo=function(e){var t=this.minor_-e.minor_;return this.major_-e.major_||t},shaka.deprecate.Version.prototype.toString=function(){return"v"+this.major_+"."+this.minor_},shaka.deprecate.Version.parse=function(e){return e=e.substring(1).split(".",2),new shaka.deprecate.Version(Number(e[0]),Number(e[1]))},shaka.deprecate.Enforcer=function(e,t,r){this.libraryVersion_=e,this.onPending_=t,this.onExpired_=r},shaka.deprecate.Enforcer.prototype.enforce=function(e,t,r){(0<e.compareTo(this.libraryVersion_)?this.onPending_:this.onExpired_)(this.libraryVersion_,e,t,r)},shaka.Deprecate=function(){},shaka.Deprecate.init=function(e){goog.asserts.assert(null==shaka.Deprecate.enforcer_,"Deprecate.init should only be called once."),shaka.Deprecate.enforcer_=new shaka.deprecate.Enforcer(shaka.deprecate.Version.parse(e),shaka.Deprecate.onPending_,shaka.Deprecate.onExpired_)},shaka.Deprecate.deprecateFeature=function(e,t,r){var a=shaka.Deprecate.enforcer_;goog.asserts.assert(a,"Missing deprecation enforcer. Was |init| called?"),e=new shaka.deprecate.Version(e,0),a.enforce(e,t,r)},shaka.Deprecate.onPending_=function(e,t,r,a){shaka.log.alwaysWarn([r,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",a].join(" "))},shaka.Deprecate.onExpired_=function(e,t,r,a){e=[r,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",a].join(""),shaka.log.alwaysError(e),goog.asserts.assert(!1,e)},shaka.Deprecate.enforcer_=null,shaka.config={},shaka.config.AutoShowText={NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3},goog.exportSymbol("shaka.config.AutoShowText",shaka.config.AutoShowText),shaka.media.AdaptationSet=function(e,t){for(this.root_=e,this.variants_=new Set([e]),t=t||[],t=(e=$jscomp.makeIterator(t)).next();!t.done;t=e.next())this.add(t.value)},shaka.media.AdaptationSet.prototype.add=function(e){return this.canInclude(e)?(this.variants_.add(e),!0):(shaka.log.warning("Rejecting variant - not compatible with root."),!1)},shaka.media.AdaptationSet.prototype.canInclude=function(e){return shaka.media.AdaptationSet.areAdaptable(this.root_,e)},shaka.media.AdaptationSet.areAdaptable=function(e,t){var r=shaka.media.AdaptationSet;return!!e.audio==!!t.audio&&!!e.video==!!t.video&&e.language==t.language&&(goog.asserts.assert(!!e.audio==!!t.audio,"Both should either have audio or not have audio."),!(e.audio&&t.audio&&!r.areAudiosCompatible_(e.audio,t.audio))&&(goog.asserts.assert(!!e.video==!!t.video,"Both should either have video or not have video."),!(e.video&&t.video&&!r.areVideosCompatible_(e.video,t.video))))},shaka.media.AdaptationSet.prototype.values=function(){return this.variants_.values()},shaka.media.AdaptationSet.areAudiosCompatible_=function(e,t){var r=shaka.media.AdaptationSet;return!((!e.channelsCount||!t.channelsCount||2<e.channelsCount||2<t.channelsCount)&&e.channelsCount!=t.channelsCount||!r.canTransitionBetween_(e,t)||!r.areRolesEqual_(e.roles,t.roles))},shaka.media.AdaptationSet.areVideosCompatible_=function(e,t){var r=shaka.media.AdaptationSet;return!(!r.canTransitionBetween_(e,t)||!r.areRolesEqual_(e.roles,t.roles))},shaka.media.AdaptationSet.canTransitionBetween_=function(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=shaka.util.MimeUtils.splitCodecs(e.codecs).map((function(e){return shaka.util.MimeUtils.getCodecBase(e)})),t=shaka.util.MimeUtils.splitCodecs(t.codecs).map((function(e){return shaka.util.MimeUtils.getCodecBase(e)})),e.length!=t.length)return!1;e.sort(),t.sort();for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0},shaka.media.AdaptationSet.areRolesEqual_=function(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if(!t.has(r.value))return!1;return!0},shaka.media.AdaptationSetCriteria=function(){},shaka.media.AdaptationSetCriteria.prototype.create=function(e){},shaka.media.ExampleBasedCriteria=function(e){this.example_=e,this.fallback_=new shaka.media.PreferenceBasedCriteria(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")},shaka.media.ExampleBasedCriteria.prototype.create=function(e){var t=this,r=e.filter((function(e){return shaka.media.AdaptationSet.areAdaptable(t.example_,e)}));return r.length?new shaka.media.AdaptationSet(r[0],r):this.fallback_.create(e)},shaka.media.PreferenceBasedCriteria=function(e,t,r,a){this.language_=e,this.role_=t,this.channelCount_=r,this.label_=void 0===a?"":a},shaka.media.PreferenceBasedCriteria.prototype.create=function(e){var t=shaka.media.PreferenceBasedCriteria,r=shaka.util.StreamUtils,a=[];a=t.filterByLanguage_(e,this.language_);var n=e.filter((function(e){return e.primary}));for(a=a.length?a:n.length?n:e,(e=t.filterVariantsByRole_(a,this.role_)).length?a=e:shaka.log.warning("No exact match for variant role could be found."),this.channelCount_&&((r=r.filterVariantsByAudioChannelCount(a,this.channelCount_)).length?a=r:shaka.log.warning("No exact match for the channel count could be found.")),this.label_&&((t=t.filterVariantsByLabel_(a,this.label_)).length?a=t:shaka.log.warning("No exact match for variant label could be found.")),t=new shaka.media.AdaptationSet(a[0]),r=(a=$jscomp.makeIterator(a)).next();!r.done;r=a.next())r=r.value,t.canInclude(r)&&t.add(r);return t},shaka.media.PreferenceBasedCriteria.filterByLanguage_=function(e,t){var r=shaka.util.LanguageUtils;t=r.normalize(t);var a=r.findClosestLocale(t,e.map((function(e){return r.getLocaleForVariant(e)})));return a?e.filter((function(e){return a==r.getLocaleForVariant(e)})):[]},shaka.media.PreferenceBasedCriteria.filterVariantsByRole_=function(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))},shaka.media.PreferenceBasedCriteria.filterVariantsByLabel_=function(e,t){return e.filter((function(e){return!!e.audio&&(e=e.audio.label.toLowerCase())==t.toLowerCase()}))},shaka.media.BufferingObserver=function(e,t){var r=shaka.media.BufferingObserver.State;this.previousState_=r.SATISFIED,this.thresholds_=(new Map).set(r.SATISFIED,t).set(r.STARVING,e)},shaka.media.BufferingObserver.prototype.setThresholds=function(e,t){var r=shaka.media.BufferingObserver.State;this.thresholds_.set(r.SATISFIED,t).set(r.STARVING,e)},shaka.media.BufferingObserver.prototype.update=function(e,t){var r=shaka.media.BufferingObserver.State,a=this.thresholds_.get(this.previousState_),n=this.previousState_;return this.previousState_=e=t||e>=a?r.SATISFIED:r.STARVING,n!=e},shaka.media.BufferingObserver.prototype.setState=function(e){this.previousState_=e},shaka.media.BufferingObserver.prototype.getState=function(){return this.previousState_},shaka.media.BufferingObserver.State={STARVING:0,SATISFIED:1},shaka.net={},shaka.net.Backoff=function(e,t){t=void 0!==t&&t;var r=shaka.net.Backoff.defaultRetryParameters();this.maxAttempts_=null==e.maxAttempts?r.maxAttempts:e.maxAttempts,goog.asserts.assert(1<=this.maxAttempts_,"maxAttempts should be >= 1"),this.baseDelay_=null==e.baseDelay?r.baseDelay:e.baseDelay,goog.asserts.assert(0<=this.baseDelay_,"baseDelay should be >= 0"),this.fuzzFactor_=null==e.fuzzFactor?r.fuzzFactor:e.fuzzFactor,goog.asserts.assert(0<=this.fuzzFactor_,"fuzzFactor should be >= 0"),this.backoffFactor_=null==e.backoffFactor?r.backoffFactor:e.backoffFactor,goog.asserts.assert(0<=this.backoffFactor_,"backoffFactor should be >= 0"),this.numAttempts_=0,this.nextUnfuzzedDelay_=this.baseDelay_,(this.autoReset_=t)&&(goog.asserts.assert(2<=this.maxAttempts_,"maxAttempts must be >= 2 for autoReset == true"),this.numAttempts_=1)},shaka.net.Backoff.prototype.attempt=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress){if(r.numAttempts_>=r.maxAttempts_){if(!r.autoReset_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.ATTEMPTS_EXHAUSTED);r.reset_()}return e=r.numAttempts_,r.numAttempts_++,0==e?(goog.asserts.assert(!r.autoReset_,"Failed to delay with auto-reset!"),a.return()):(t=shaka.net.Backoff.fuzz_(r.nextUnfuzzedDelay_,r.fuzzFactor_),a.yield(new Promise((function(e){shaka.net.Backoff.defer(t,e)})),2))}r.nextUnfuzzedDelay_*=r.backoffFactor_,a.jumpToEnd()}))},shaka.net.Backoff.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},shaka.net.Backoff.fuzz_=function(e,t){return e*(1+(2*Math.random()-1)*t)},shaka.net.Backoff.prototype.reset_=function(){goog.asserts.assert(this.autoReset_,"Should only be used for auto-reset!"),this.numAttempts_=1,this.nextUnfuzzedDelay_=this.baseDelay_},shaka.net.Backoff.defer=function(e,t){new shaka.util.Timer(t).tickAfter(e/1e3)},shaka.util.AbortableOperation=function(e,t){this.promise=e,this.onAbort_=t,this.aborted_=!1},shaka.util.AbortableOperation.failed=function(e){return new shaka.util.AbortableOperation(Promise.reject(e),(function(){return Promise.resolve()}))},shaka.util.AbortableOperation.aborted=function(){var e=Promise.reject(shaka.util.AbortableOperation.abortError());return e.catch((function(){})),new shaka.util.AbortableOperation(e,(function(){return Promise.resolve()}))},shaka.util.AbortableOperation.abortError=function(){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED)},shaka.util.AbortableOperation.completed=function(e){return new shaka.util.AbortableOperation(Promise.resolve(e),(function(){return Promise.resolve()}))},shaka.util.AbortableOperation.notAbortable=function(e){return new shaka.util.AbortableOperation(e,(function(){return e.catch((function(){}))}))},shaka.util.AbortableOperation.prototype.abort=function(){return this.aborted_=!0,this.onAbort_()},shaka.util.AbortableOperation.all=function(e){return new shaka.util.AbortableOperation(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))},shaka.util.AbortableOperation.prototype.finally=function(e){return this.promise.then((function(t){return e(!0)}),(function(t){return e(!1)})),this},shaka.util.AbortableOperation.prototype.chain=function(e,t){var r=this,a=new shaka.util.PublicPromise,n=shaka.util.AbortableOperation.abortError(),i=function(){return a.reject(n),r.abort()},o=function(o){return function(s){if(r.aborted_&&o)a.reject(n);else{var l=o?e:t;l?i=shaka.util.AbortableOperation.wrapChainCallback_(l,s,a):(o?a.resolve:a.reject)(s)}}};return this.promise.then(o(!0),o(!1)),new shaka.util.AbortableOperation(a,(function(){return i()}))},shaka.util.AbortableOperation.wrapChainCallback_=function(e,t,r){try{var a=e(t);return a&&a.promise&&a.abort?(r.resolve(a.promise),function(){return a.abort()}):(r.resolve(a),function(){return Promise.resolve(a).then((function(){}),(function(){}))})}catch(e){return r.reject(e),function(){return Promise.resolve()}}},goog.exportSymbol("shaka.util.AbortableOperation",shaka.util.AbortableOperation),goog.exportProperty(shaka.util.AbortableOperation.prototype,"chain",shaka.util.AbortableOperation.prototype.chain),goog.exportProperty(shaka.util.AbortableOperation.prototype,"finally",shaka.util.AbortableOperation.prototype.finally),goog.exportProperty(shaka.util.AbortableOperation,"all",shaka.util.AbortableOperation.all),goog.exportProperty(shaka.util.AbortableOperation.prototype,"abort",shaka.util.AbortableOperation.prototype.abort),goog.exportProperty(shaka.util.AbortableOperation,"notAbortable",shaka.util.AbortableOperation.notAbortable),goog.exportProperty(shaka.util.AbortableOperation,"completed",shaka.util.AbortableOperation.completed),goog.exportProperty(shaka.util.AbortableOperation,"aborted",shaka.util.AbortableOperation.aborted),goog.exportProperty(shaka.util.AbortableOperation,"failed",shaka.util.AbortableOperation.failed),shaka.util.FakeEvent=function(e,t){if(t)if(t instanceof Map)for(var r=$jscomp.makeIterator(t.keys()),a=r.next();!a.done;a=r.next())a=a.value,Object.defineProperty(this,a,{value:t.get(a),writable:!0,enumerable:!0});else for(r in t=shaka.util.FakeEvent.recastDictAsObject_(t))Object.defineProperty(this,r,{value:t[r],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.stopped=!1},shaka.util.FakeEvent.fromRealEvent=function(e){var t,r=new shaka.util.FakeEvent(e.type);for(t in e)Object.defineProperty(r,t,{value:e[t],writable:!0,enumerable:!0});return r},shaka.util.FakeEvent.recastDictAsObject_=function(e){return goog.asserts.assert(!(e instanceof Map),"dict should not be a map"),e},shaka.util.FakeEvent.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},shaka.util.FakeEvent.prototype.stopImmediatePropagation=function(){this.stopped=!0},shaka.util.FakeEvent.prototype.stopPropagation=function(){},goog.exportSymbol("shaka.util.FakeEvent",shaka.util.FakeEvent),shaka.util.FakeEvent.EventName={AbrStatusChanged:"abrstatuschanged",Adaptation:"adaptation",Buffering:"buffering",DownloadFailed:"downloadfailed",DownloadHeadersReceived:"downloadheadersreceived",DrmSessionUpdate:"drmsessionupdate",Emsg:"emsg",Prft:"prft",Error:"error",ExpirationUpdated:"expirationupdated",GapJumped:"gapjumped",Loaded:"loaded",Loading:"loading",ManifestParsed:"manifestparsed",MediaQualityChanged:"mediaqualitychanged",Metadata:"metadata",OnStateChange:"onstatechange",OnStateIdle:"onstateidle",RateChange:"ratechange",SegmentAppended:"segmentappended",SessionDataEvent:"sessiondata",StallDetected:"stalldetected",Streaming:"streaming",TextChanged:"textchanged",TextTrackVisibility:"texttrackvisibility",TimelineRegionAdded:"timelineregionadded",TimelineRegionEnter:"timelineregionenter",TimelineRegionExit:"timelineregionexit",TracksChanged:"trackschanged",Unloading:"unloading",VariantChanged:"variantchanged"},shaka.util.IReleasable=function(){},shaka.util.IReleasable.prototype.release=function(){},shaka.util.FakeEventTarget=function(){this.listeners_=new shaka.util.MultiMap,this.dispatchTarget=this},shaka.util.FakeEventTarget.prototype.addEventListener=function(e,t,r){this.listeners_&&this.listeners_.push(e,t)},shaka.util.FakeEventTarget.prototype.listenToAllEvents=function(e){this.addEventListener(shaka.util.FakeEventTarget.ALL_EVENTS_,e)},shaka.util.FakeEventTarget.prototype.removeEventListener=function(e,t,r){this.listeners_&&this.listeners_.remove(e,t)},shaka.util.FakeEventTarget.prototype.dispatchEvent=function(e){if(goog.asserts.assert(e instanceof shaka.util.FakeEvent,"FakeEventTarget can only dispatch FakeEvents!"),!this.listeners_)return!0;var t=this.listeners_.get(e.type)||[],r=this.listeners_.get(shaka.util.FakeEventTarget.ALL_EVENTS_);for(r&&(t=t.concat(r)),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next()){r=r.value,e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;try{r.handleEvent?r.handleEvent(e):r.call(this,e)}catch(e){shaka.log.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.stopped)break}return e.defaultPrevented},shaka.util.FakeEventTarget.prototype.release=function(){this.listeners_=null},shaka.util.FakeEventTarget.ALL_EVENTS_="All",shaka.util.ObjectUtils=function(){},shaka.util.ObjectUtils.cloneObject=function(e){var t=new Set,r=function(e){switch(typeof e){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return e;default:if(!e||e.buffer&&e.buffer.constructor==ArrayBuffer)return e;if(t.has(e))return null;var a=e.constructor==Array;if(e.constructor!=Object&&!a)return null;t.add(e);var n,i=a?[]:{};for(n in e)i[n]=r(e[n]);return a&&(i.length=e.length),i}};return r(e)},shaka.util.ObjectUtils.shallowCloneObject=function(e){var t,r={};for(t in e)r[t]=e[t];return r},shaka.util.OperationManager=function(){this.operations_=[]},shaka.util.OperationManager.prototype.manage=function(e){var t=this;this.operations_.push(e.finally((function(){shaka.util.ArrayUtils.remove(t.operations_,e)})))},shaka.util.OperationManager.prototype.destroy=function(){for(var e=[],t=$jscomp.makeIterator(this.operations_),r=t.next();!r.done;r=t.next())(r=r.value).promise.catch((function(){})),e.push(r.abort());return this.operations_=[],Promise.all(e)},shaka.net.NetworkingEngine=function(e,t,r){shaka.util.FakeEventTarget.call(this),this.destroyed_=!1,this.operationManager_=new shaka.util.OperationManager,this.requestFilters_=new Set,this.responseFilters_=new Set,this.onProgressUpdated_=e||null,this.onHeadersReceived_=t||null,this.onDownloadFailed_=r||null,this.forceHTTPS_=!1},$jscomp.inherits(shaka.net.NetworkingEngine,shaka.util.FakeEventTarget),shaka.net.NetworkingEngine.prototype.setForceHTTPS=function(e){this.forceHTTPS_=e},shaka.net.NetworkingEngine.registerScheme=function(e,t,r,a){a=void 0!==a&&a,goog.asserts.assert(null==r||0<r,"explicit priority must be > 0"),r=r||shaka.net.NetworkingEngine.PluginPriority.APPLICATION;var n=shaka.net.NetworkingEngine.schemes_[e];(!n||r>=n.priority)&&(shaka.net.NetworkingEngine.schemes_[e]={priority:r,plugin:t,progressSupport:a})},shaka.net.NetworkingEngine.unregisterScheme=function(e){delete shaka.net.NetworkingEngine.schemes_[e]},shaka.net.NetworkingEngine.prototype.registerRequestFilter=function(e){this.requestFilters_.add(e)},shaka.net.NetworkingEngine.prototype.unregisterRequestFilter=function(e){this.requestFilters_.delete(e)},shaka.net.NetworkingEngine.prototype.clearAllRequestFilters=function(){this.requestFilters_.clear()},shaka.net.NetworkingEngine.prototype.registerResponseFilter=function(e){this.responseFilters_.add(e)},shaka.net.NetworkingEngine.prototype.unregisterResponseFilter=function(e){this.responseFilters_.delete(e)},shaka.net.NetworkingEngine.prototype.clearAllResponseFilters=function(){this.responseFilters_.clear()},shaka.net.NetworkingEngine.defaultRetryParameters=function(){return shaka.net.Backoff.defaultRetryParameters()},shaka.net.NetworkingEngine.makeRequest=function(e,t,r){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===r?null:r}},shaka.net.NetworkingEngine.prototype.destroy=function(){return this.destroyed_=!0,this.requestFilters_.clear(),this.responseFilters_.clear(),shaka.util.FakeEventTarget.prototype.release.call(this),this.operationManager_.destroy()},shaka.net.NetworkingEngine.prototype.request=function(e,t){var r=this,a=shaka.util.ObjectUtils,n=new shaka.net.NetworkingEngine.NumBytesRemainingClass;if(this.destroyed_)return(a=Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED))).catch((function(){})),new shaka.net.NetworkingEngine.PendingRequest(a,(function(){return Promise.resolve()}),n);goog.asserts.assert(t.uris&&t.uris.length,"Request without URIs!"),t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?a.cloneObject(t.retryParameters):shaka.net.NetworkingEngine.defaultRetryParameters(),t.uris=a.cloneObject(t.uris);var i=(a=this.filterRequest_(e,t)).chain((function(){return r.makeRequestWithRetry_(e,t,n)})),o=i.chain((function(t){return r.filterResponse_(e,t)})),s=Date.now(),l=0;a.promise.then((function(){l=Date.now()-s}),(function(){}));var u=0;i.promise.then((function(){u=Date.now()}),(function(){}));var c=o.chain((function(t){var a=Date.now()-u,n=t.response;return n.timeMs+=l,n.timeMs+=a,t.gotProgress||!r.onProgressUpdated_||n.fromCache||e!=shaka.net.NetworkingEngine.RequestType.SEGMENT||r.onProgressUpdated_(n.timeMs,n.data.byteLength),n}),(function(e){throw e&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type"),e.severity=shaka.util.Error.Severity.CRITICAL),e}));return a=new shaka.net.NetworkingEngine.PendingRequest(c.promise,(function(){return c.abort()}),n),this.operationManager_.manage(a),a},shaka.net.NetworkingEngine.prototype.filterRequest_=function(e,t){for(var r=shaka.util.AbortableOperation.completed(void 0),a={},n=$jscomp.makeIterator(this.requestFilters_),i=n.next();!i.done;a={$jscomp$loop$prop$requestFilter$634:a.$jscomp$loop$prop$requestFilter$634},i=n.next())a.$jscomp$loop$prop$requestFilter$634=i.value,r=r.chain(function(r){return function(){return t.body&&(t.body=shaka.util.BufferUtils.toArrayBuffer(t.body)),r.$jscomp$loop$prop$requestFilter$634(e,t)}}(a));return r.chain(void 0,(function(e){if(e instanceof shaka.util.Error&&e.code==shaka.util.Error.Code.OPERATION_ABORTED)throw e;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.REQUEST_FILTER_ERROR,e)}))},shaka.net.NetworkingEngine.prototype.makeRequestWithRetry_=function(e,t,r){var a=new shaka.net.Backoff(t.retryParameters,!1);return this.send_(e,t,a,0,null,r)},shaka.net.NetworkingEngine.prototype.send_=function(e,t,r,a,n,i){var o=this;this.forceHTTPS_&&(t.uris[a]=t.uris[a].replace("http://","https://"));var s=new goog.Uri(t.uris[a]),l=s.getScheme(),u=!1;l||(l=shaka.net.NetworkingEngine.getLocationProtocol_(),goog.asserts.assert(":"==l[l.length-1],"location.protocol expected to end with a colon!"),l=l.slice(0,-1),s.setScheme(l),t.uris[a]=s.toString()),l=l.toLowerCase();var c=(l=shaka.net.NetworkingEngine.schemes_[l])?l.plugin:null;if(!c)return shaka.util.AbortableOperation.failed(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.UNSUPPORTED_SCHEME,s));var d,p=l.progressSupport,h=null,f=null,g=!1,y=!1;return shaka.util.AbortableOperation.notAbortable(r.attempt()).chain((function(){if(o.destroyed_)return shaka.util.AbortableOperation.aborted();d=Date.now();var r=shaka.net.NetworkingEngine.RequestType.SEGMENT,n=c(t.uris[a],t,e,(function(t,a,n){h&&h.stop(),f&&f.tickAfter(l/1e3),o.onProgressUpdated_&&e==r&&(o.onProgressUpdated_(t,a),u=!0,i.setBytes(n))}),(function(r){o.onHeadersReceived_&&o.onHeadersReceived_(r,t,e),y=!0}));if(!p)return n;var s=t.retryParameters.connectionTimeout;s&&(h=new shaka.util.Timer((function(){g=!0,n.abort()}))).tickAfter(s/1e3);var l=t.retryParameters.stallTimeout;return l&&(f=new shaka.util.Timer((function(){g=!0,n.abort()}))),n})).chain((function(r){h&&h.stop(),f&&f.stop(),null==r.timeMs&&(r.timeMs=Date.now()-d);var a={response:r,gotProgress:u};return!y&&o.onHeadersReceived_&&o.onHeadersReceived_(r.headers,t,e),a}),(function(s){if(h&&h.stop(),f&&f.stop(),o.onDownloadFailed_){var l=null,u=0;s instanceof shaka.util.Error&&(l=s,s.code==shaka.util.Error.Code.BAD_HTTP_STATUS&&(u=s.data[1])),o.onDownloadFailed_(t,l,u,g)}if(o.destroyed_)return shaka.util.AbortableOperation.aborted();if(g&&(s=new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,t.uris[a],e)),s instanceof shaka.util.Error){if(s.code==shaka.util.Error.Code.OPERATION_ABORTED)throw s;if(s.code==shaka.util.Error.Code.ATTEMPTS_EXHAUSTED)throw goog.asserts.assert(n,"Should have last error"),n;if(s.severity==shaka.util.Error.Severity.RECOVERABLE)return l=(new Map).set("error",s),l=new shaka.util.FakeEvent("retry",l),o.dispatchEvent(l),a=(a+1)%t.uris.length,o.send_(e,t,r,a,s,i)}throw s}))},shaka.net.NetworkingEngine.prototype.filterResponse_=function(e,t){for(var r=shaka.util.AbortableOperation.completed(void 0),a={},n=$jscomp.makeIterator(this.responseFilters_),i=n.next();!i.done;a={$jscomp$loop$prop$responseFilter$636:a.$jscomp$loop$prop$responseFilter$636},i=n.next())a.$jscomp$loop$prop$responseFilter$636=i.value,r=r.chain(function(r){return function(){var a=t.response;return a.data&&(a.data=shaka.util.BufferUtils.toArrayBuffer(a.data)),r.$jscomp$loop$prop$responseFilter$636(e,a)}}(a));return r.chain((function(){return t}),(function(e){var t=shaka.util.Error.Severity.CRITICAL;if(e instanceof shaka.util.Error){if(e.code==shaka.util.Error.Code.OPERATION_ABORTED)throw e;t=e.severity}throw new shaka.util.Error(t,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.RESPONSE_FILTER_ERROR,e)}))},shaka.net.NetworkingEngine.getLocationProtocol_=function(){return location.protocol},goog.exportSymbol("shaka.net.NetworkingEngine",shaka.net.NetworkingEngine),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"request",shaka.net.NetworkingEngine.prototype.request),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"destroy",shaka.net.NetworkingEngine.prototype.destroy),goog.exportProperty(shaka.net.NetworkingEngine,"makeRequest",shaka.net.NetworkingEngine.makeRequest),goog.exportProperty(shaka.net.NetworkingEngine,"defaultRetryParameters",shaka.net.NetworkingEngine.defaultRetryParameters),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"clearAllResponseFilters",shaka.net.NetworkingEngine.prototype.clearAllResponseFilters),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"unregisterResponseFilter",shaka.net.NetworkingEngine.prototype.unregisterResponseFilter),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"registerResponseFilter",shaka.net.NetworkingEngine.prototype.registerResponseFilter),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"clearAllRequestFilters",shaka.net.NetworkingEngine.prototype.clearAllRequestFilters),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"unregisterRequestFilter",shaka.net.NetworkingEngine.prototype.unregisterRequestFilter),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"registerRequestFilter",shaka.net.NetworkingEngine.prototype.registerRequestFilter),goog.exportProperty(shaka.net.NetworkingEngine,"unregisterScheme",shaka.net.NetworkingEngine.unregisterScheme),goog.exportProperty(shaka.net.NetworkingEngine,"registerScheme",shaka.net.NetworkingEngine.registerScheme),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"setForceHTTPS",shaka.net.NetworkingEngine.prototype.setForceHTTPS),shaka.net.NetworkingEngine.NumBytesRemainingClass=function(){this.bytesToLoad_=0},shaka.net.NetworkingEngine.NumBytesRemainingClass.prototype.setBytes=function(e){this.bytesToLoad_=e},shaka.net.NetworkingEngine.NumBytesRemainingClass.prototype.getBytes=function(){return this.bytesToLoad_},goog.exportProperty(shaka.net.NetworkingEngine,"NumBytesRemainingClass",shaka.net.NetworkingEngine.NumBytesRemainingClass),shaka.net.NetworkingEngine.PendingRequest=function(e,t,r){shaka.util.AbortableOperation.call(this,e,t),this.bytesRemaining_=r},$jscomp.inherits(shaka.net.NetworkingEngine.PendingRequest,shaka.util.AbortableOperation),shaka.net.NetworkingEngine.PendingRequest.prototype.getBytesRemaining=function(){return this.bytesRemaining_.getBytes()},goog.exportProperty(shaka.net.NetworkingEngine,"PendingRequest",shaka.net.NetworkingEngine.PendingRequest),shaka.net.NetworkingEngine.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6},goog.exportProperty(shaka.net.NetworkingEngine,"RequestType",shaka.net.NetworkingEngine.RequestType),shaka.net.NetworkingEngine.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3},goog.exportProperty(shaka.net.NetworkingEngine,"PluginPriority",shaka.net.NetworkingEngine.PluginPriority),shaka.net.NetworkingEngine.schemes_={},shaka.util.Destroyer=function(e){this.destroyed_=!1,this.waitOnDestroy_=new shaka.util.PublicPromise,this.onDestroy_=e},shaka.util.Destroyer.prototype.destroyed=function(){return this.destroyed_},shaka.util.Destroyer.prototype.destroy=function(){var e=this;return this.destroyed_?this.waitOnDestroy_:(this.destroyed_=!0,this.onDestroy_().then((function(){e.waitOnDestroy_.resolve()}),(function(){e.waitOnDestroy_.resolve()})))},shaka.util.Destroyer.prototype.ensureNotDestroyed=function(e){if(this.destroyed_){if(e instanceof shaka.util.Error&&e.code==shaka.util.Error.Code.OBJECT_DESTROYED)throw e;throw shaka.util.Destroyer.destroyedError(e)}},shaka.util.Destroyer.destroyedError=function(e){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OBJECT_DESTROYED,e)},shaka.util.EventManager=function(){this.bindingMap_=new shaka.util.MultiMap},shaka.util.EventManager.prototype.release=function(){this.removeAll(),this.bindingMap_=null},shaka.util.EventManager.prototype.listen=function(e,t,r,a){this.bindingMap_&&(e=new shaka.util.EventManager.Binding_(e,t,r,a),this.bindingMap_.push(t,e))},shaka.util.EventManager.prototype.listenOnce=function(e,t,r,a){var n=this,i=function(a){n.unlisten(e,t,i),r(a)};this.listen(e,t,i,a)},shaka.util.EventManager.prototype.unlisten=function(e,t,r){if(this.bindingMap_)for(var a=this.bindingMap_.get(t)||[],n=(a=$jscomp.makeIterator(a)).next();!n.done;n=a.next())(n=n.value).target!=e||r!=n.listener&&r||(n.unlisten(),this.bindingMap_.remove(t,n))},shaka.util.EventManager.prototype.removeAll=function(){if(this.bindingMap_){for(var e=this.bindingMap_.getAll(),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())t.value.unlisten();this.bindingMap_.clear()}},goog.exportSymbol("shaka.util.EventManager",shaka.util.EventManager),goog.exportProperty(shaka.util.EventManager.prototype,"removeAll",shaka.util.EventManager.prototype.removeAll),goog.exportProperty(shaka.util.EventManager.prototype,"unlisten",shaka.util.EventManager.prototype.unlisten),goog.exportProperty(shaka.util.EventManager.prototype,"listenOnce",shaka.util.EventManager.prototype.listenOnce),goog.exportProperty(shaka.util.EventManager.prototype,"listen",shaka.util.EventManager.prototype.listen),goog.exportProperty(shaka.util.EventManager.prototype,"release",shaka.util.EventManager.prototype.release),shaka.util.EventManager.Binding_=function(e,t,r,a){this.target=e,this.type=t,this.listener=r,this.options=shaka.util.EventManager.Binding_.convertOptions_(e,a),this.target.addEventListener(t,r,this.options)},shaka.util.EventManager.Binding_.prototype.unlisten=function(){goog.asserts.assert(this.target,"Missing target"),this.target.removeEventListener(this.type,this.listener,this.options),this.listener=this.target=null,this.options=!1},shaka.util.EventManager.Binding_.convertOptions_=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var r=new Set(["passive","capture"]),a=Object.keys(t).filter((function(e){return!r.has(e)}));return goog.asserts.assert(0==a.length,"Unsupported flag(s) to addEventListener: "+a.join(",")),shaka.util.EventManager.Binding_.doesSupportObject_(e)?t:t.capture||!1},shaka.util.EventManager.Binding_.doesSupportObject_=function(e){var t=shaka.util.EventManager.Binding_.supportsObject_;if(null==t){t=!1;try{var r={},a={get:function(){return t=!0,!1}};Object.defineProperty(r,"passive",a),Object.defineProperty(r,"capture",a),a=function(){},e.addEventListener("test",a,r),e.removeEventListener("test",a,r)}catch(e){t=!1}shaka.util.EventManager.Binding_.supportsObject_=t}return t||!1},shaka.util.EventManager.Binding_.supportsObject_=void 0,shaka.util.Iterables=function(){},shaka.util.Iterables.map=function(e,t){for(var r=[],a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())r.push(t(a.value));return r},shaka.util.Iterables.every=function(e,t){for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if(!t(r.value))return!1;return!0},shaka.util.Iterables.some=function(e,t){for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if(t(r.value))return!0;return!1},shaka.util.Iterables.filter=function(e,t){for(var r=[],a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())t(a=a.value)&&r.push(a);return r},shaka.util.MapUtils=function(){},shaka.util.MapUtils.asMap=function(e){for(var t=new Map,r=$jscomp.makeIterator(Object.keys(e)),a=r.next();!a.done;a=r.next())a=a.value,t.set(a,e[a]);return t},shaka.util.MapUtils.asObject=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},shaka.util.MapUtils.hasSameElements=function(e,t){if(!e&&!t)return!0;if(e&&!t||t&&!e)return!1;if(e.size!=t.size)return!1;for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var a=$jscomp.makeIterator(r.value);if(r=a.next().value,a=a.next().value,!t.has(r))return!1;if((r=t.get(r))!=a||null==r)return!1}return!0},shaka.util.DataViewReader=function(e,t){this.dataView_=shaka.util.BufferUtils.toDataView(e),this.littleEndian_=t==shaka.util.DataViewReader.Endianness.LITTLE_ENDIAN,this.position_=0},shaka.util.DataViewReader.prototype.getDataView=function(){return this.dataView_},shaka.util.DataViewReader.prototype.hasMoreData=function(){return this.position_<this.dataView_.byteLength},shaka.util.DataViewReader.prototype.getPosition=function(){return this.position_},shaka.util.DataViewReader.prototype.getLength=function(){return this.dataView_.byteLength},shaka.util.DataViewReader.prototype.readUint8=function(){try{var e=this.dataView_.getUint8(this.position_);return this.position_+=1,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readUint16=function(){try{var e=this.dataView_.getUint16(this.position_,this.littleEndian_);return this.position_+=2,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readUint32=function(){try{var e=this.dataView_.getUint32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readInt32=function(){try{var e=this.dataView_.getInt32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readUint64=function(){try{if(this.littleEndian_)var e=this.dataView_.getUint32(this.position_,!0),t=this.dataView_.getUint32(this.position_+4,!0);else t=this.dataView_.getUint32(this.position_,!1),e=this.dataView_.getUint32(this.position_+4,!1)}catch(e){throw this.outOfBounds_()}if(2097151<t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.JS_INTEGER_OVERFLOW);return this.position_+=8,t*Math.pow(2,32)+e},shaka.util.DataViewReader.prototype.readBytes=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.readBytes"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();var t=shaka.util.BufferUtils.toUint8(this.dataView_,this.position_,e);return this.position_+=e,t},shaka.util.DataViewReader.prototype.skip=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.skip"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_+=e},shaka.util.DataViewReader.prototype.rewind=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.rewind"),this.position_<e)throw this.outOfBounds_();this.position_-=e},shaka.util.DataViewReader.prototype.seek=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.seek"),0>e||e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_=e},shaka.util.DataViewReader.prototype.readTerminatedString=function(){for(var e=this.position_;this.hasMoreData()&&0!=this.dataView_.getUint8(this.position_);)this.position_+=1;return e=shaka.util.BufferUtils.toUint8(this.dataView_,e,this.position_-e),this.position_+=1,shaka.util.StringUtils.fromUTF8(e)},shaka.util.DataViewReader.prototype.outOfBounds_=function(){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS)},goog.exportSymbol("shaka.util.DataViewReader",shaka.util.DataViewReader),goog.exportProperty(shaka.util.DataViewReader.prototype,"readTerminatedString",shaka.util.DataViewReader.prototype.readTerminatedString),goog.exportProperty(shaka.util.DataViewReader.prototype,"seek",shaka.util.DataViewReader.prototype.seek),goog.exportProperty(shaka.util.DataViewReader.prototype,"rewind",shaka.util.DataViewReader.prototype.rewind),goog.exportProperty(shaka.util.DataViewReader.prototype,"skip",shaka.util.DataViewReader.prototype.skip),goog.exportProperty(shaka.util.DataViewReader.prototype,"readBytes",shaka.util.DataViewReader.prototype.readBytes),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint64",shaka.util.DataViewReader.prototype.readUint64),goog.exportProperty(shaka.util.DataViewReader.prototype,"readInt32",shaka.util.DataViewReader.prototype.readInt32),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint32",shaka.util.DataViewReader.prototype.readUint32),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint16",shaka.util.DataViewReader.prototype.readUint16),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint8",shaka.util.DataViewReader.prototype.readUint8),goog.exportProperty(shaka.util.DataViewReader.prototype,"getLength",shaka.util.DataViewReader.prototype.getLength),goog.exportProperty(shaka.util.DataViewReader.prototype,"getPosition",shaka.util.DataViewReader.prototype.getPosition),goog.exportProperty(shaka.util.DataViewReader.prototype,"hasMoreData",shaka.util.DataViewReader.prototype.hasMoreData),shaka.util.DataViewReader.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:1},goog.exportProperty(shaka.util.DataViewReader,"Endianness",shaka.util.DataViewReader.Endianness),shaka.util.Mp4Parser=function(){this.headers_=[],this.boxDefinitions_=[],this.done_=!1},shaka.util.Mp4Parser.prototype.box=function(e,t){return e=shaka.util.Mp4Parser.typeFromString_(e),this.headers_[e]=shaka.util.Mp4Parser.BoxType_.BASIC_BOX,this.boxDefinitions_[e]=t,this},shaka.util.Mp4Parser.prototype.fullBox=function(e,t){return e=shaka.util.Mp4Parser.typeFromString_(e),this.headers_[e]=shaka.util.Mp4Parser.BoxType_.FULL_BOX,this.boxDefinitions_[e]=t,this},shaka.util.Mp4Parser.prototype.stop=function(){this.done_=!0},shaka.util.Mp4Parser.prototype.parse=function(e,t,r){for(e=new shaka.util.DataViewReader(e,shaka.util.DataViewReader.Endianness.BIG_ENDIAN),this.done_=!1;e.hasMoreData()&&!this.done_;)this.parseNext(0,e,t,r)},shaka.util.Mp4Parser.prototype.parseNext=function(e,t,r,a){var n=t.getPosition();if(a&&n+8>t.getLength())this.done_=!0;else{var i=t.readUint32(),o=t.readUint32(),s=shaka.util.Mp4Parser.typeToString(o),l=!1;switch(shaka.log.v2("Parsing MP4 box",s),i){case 0:i=t.getLength()-n;break;case 1:if(a&&t.getPosition()+8>t.getLength())return void(this.done_=!0);i=t.readUint64(),l=!0}var u=this.boxDefinitions_[o];if(u){var c=null,d=null;if(this.headers_[o]==shaka.util.Mp4Parser.BoxType_.FULL_BOX){if(a&&t.getPosition()+4>t.getLength())return void(this.done_=!0);c=(d=t.readUint32())>>>24,d&=16777215}o=n+i,r&&o>t.getLength()&&(o=t.getLength()),a&&o>t.getLength()?this.done_=!0:(a=o-t.getPosition(),t=0<a?t.readBytes(a):new Uint8Array(0),u({name:s,parser:this,partialOkay:r||!1,version:c,flags:d,reader:t=new shaka.util.DataViewReader(t,shaka.util.DataViewReader.Endianness.BIG_ENDIAN),size:i,start:n+e,has64BitSize:l}))}else e=Math.min(n+i-t.getPosition(),t.getLength()-t.getPosition()),t.skip(e)}},shaka.util.Mp4Parser.children=function(e){for(var t=shaka.util.Mp4Parser.headerSize(e);e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)},shaka.util.Mp4Parser.sampleDescription=function(e){for(var t=shaka.util.Mp4Parser.headerSize(e),r=e.reader.readUint32(),a=0;a<r&&(e.parser.parseNext(e.start+t,e.reader,e.partialOkay),!e.parser.done_);a++);},shaka.util.Mp4Parser.visualSampleEntry=function(e){var t=shaka.util.Mp4Parser.headerSize(e);for(e.reader.skip(78);e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)},shaka.util.Mp4Parser.allData=function(e){return function(t){var r=t.reader.getLength()-t.reader.getPosition();e(t.reader.readBytes(r))}},shaka.util.Mp4Parser.typeFromString_=function(e){goog.asserts.assert(4==e.length,"Mp4 box names must be 4 characters long");for(var t=0,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())t=t<<8|r.value.charCodeAt(0);return t},shaka.util.Mp4Parser.typeToString=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},shaka.util.Mp4Parser.headerSize=function(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)},goog.exportSymbol("shaka.util.Mp4Parser",shaka.util.Mp4Parser),goog.exportProperty(shaka.util.Mp4Parser,"headerSize",shaka.util.Mp4Parser.headerSize),goog.exportProperty(shaka.util.Mp4Parser,"typeToString",shaka.util.Mp4Parser.typeToString),goog.exportProperty(shaka.util.Mp4Parser,"allData",shaka.util.Mp4Parser.allData),goog.exportProperty(shaka.util.Mp4Parser,"visualSampleEntry",shaka.util.Mp4Parser.visualSampleEntry),goog.exportProperty(shaka.util.Mp4Parser,"sampleDescription",shaka.util.Mp4Parser.sampleDescription),goog.exportProperty(shaka.util.Mp4Parser,"children",shaka.util.Mp4Parser.children),goog.exportProperty(shaka.util.Mp4Parser.prototype,"parseNext",shaka.util.Mp4Parser.prototype.parseNext),goog.exportProperty(shaka.util.Mp4Parser.prototype,"parse",shaka.util.Mp4Parser.prototype.parse),goog.exportProperty(shaka.util.Mp4Parser.prototype,"stop",shaka.util.Mp4Parser.prototype.stop),goog.exportProperty(shaka.util.Mp4Parser.prototype,"fullBox",shaka.util.Mp4Parser.prototype.fullBox),goog.exportProperty(shaka.util.Mp4Parser.prototype,"box",shaka.util.Mp4Parser.prototype.box),shaka.util.Mp4Parser.BoxType_={BASIC_BOX:0,FULL_BOX:1},shaka.util.Pssh=function(e){var t=this;this.systemIds=[],this.cencKeyIds=[],this.data=[],(new shaka.util.Mp4Parser).box("moov",shaka.util.Mp4Parser.children).box("moof",shaka.util.Mp4Parser.children).fullBox("pssh",(function(e){return t.parsePsshBox_(e)})).parse(e),0==this.data.length&&shaka.log.v2("No pssh box found!")},shaka.util.Pssh.prototype.parsePsshBox_=function(e){if(goog.asserts.assert(null!=e.version,"PSSH boxes are full boxes and must have a valid version"),goog.asserts.assert(null!=e.flags,"PSSH boxes are full boxes and must have a valid flag"),1<e.version)shaka.log.warning("Unrecognized PSSH version found!");else{var t=e.reader.getDataView();if(goog.asserts.assert(12<=t.byteOffset,"DataView at incorrect position"),t=shaka.util.BufferUtils.toUint8(t,-12,e.size),this.data.push(t),this.systemIds.push(shaka.util.Uint8ArrayUtils.toHex(e.reader.readBytes(16))),0<e.version){t=e.reader.readUint32();for(var r=0;r<t;r++){var a=shaka.util.Uint8ArrayUtils.toHex(e.reader.readBytes(16));this.cencKeyIds.push(a)}}}},shaka.util.Pssh.createPssh=function(e,t,r,a){goog.asserts.assert(16==t.byteLength,"Invalid system ID length");var n=e.length,i=12+t.length+4+n;0<a&&(i+=4+16*r.size);var o=new Uint8Array(i),s=shaka.util.BufferUtils.toDataView(o),l=0;if(s.setUint32(l,i),l+=4,s.setUint32(l,1886614376),l+=4,1>a?s.setUint32(l,0):s.setUint32(l,16777216),l+=4,o.set(t,l),l+=t.length,0<a)for(s.setUint32(l,r.size),l+=4,t=shaka.util.Uint8ArrayUtils,a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next())a=t.fromHex(a.value),o.set(a,l),l+=a.length;return s.setUint32(l,n),l+=4,o.set(e,l),goog.asserts.assert(l+n===i,"PSSH invalid length."),o},shaka.util.Pssh.normaliseInitData=function(e){if(!e)return e;var t=new shaka.util.Pssh(e);if(1>=t.data.length)return e;e=[];for(var r={},a=(t=$jscomp.makeIterator(t.data)).next();!a.done;r={$jscomp$loop$prop$initData$428$638:r.$jscomp$loop$prop$initData$428$638},a=t.next())r.$jscomp$loop$prop$initData$428$638=a.value,e.some(function(e){return function(t){return shaka.util.BufferUtils.equal(t,e.$jscomp$loop$prop$initData$428$638)}}(r))||e.push(r.$jscomp$loop$prop$initData$428$638);return shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(e))},shaka.util.XmlUtils=function(){},shaka.util.XmlUtils.findChild=function(e,t){return 1!=(e=shaka.util.XmlUtils.findChildren(e,t)).length?null:e[0]},shaka.util.XmlUtils.findChildNS=function(e,t,r){return 1!=(e=shaka.util.XmlUtils.findChildrenNS(e,t,r)).length?null:e[0]},shaka.util.XmlUtils.findChildren=function(e,t){for(var r=[],a=(e=$jscomp.makeIterator(e.childNodes)).next();!a.done;a=e.next())(a=a.value)instanceof Element&&a.tagName==t&&r.push(a);return r},shaka.util.XmlUtils.getChildren=function(e){return Array.from(e.childNodes).filter((function(e){return e instanceof Element}))},shaka.util.XmlUtils.findChildrenNS=function(e,t,r){for(var a=[],n=(e=$jscomp.makeIterator(e.childNodes)).next();!n.done;n=e.next())(n=n.value)instanceof Element&&n.localName==r&&n.namespaceURI==t&&a.push(n);return a},shaka.util.XmlUtils.getAttributeNS=function(e,t,r){return e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null},shaka.util.XmlUtils.getAttributeNSList=function(e,t,r){for(var a=(t=$jscomp.makeIterator(t)).next();!a.done;a=t.next())if(a=a.value,e.hasAttributeNS(a,r))return e.getAttributeNS(a,r);return null},shaka.util.XmlUtils.getContents=function(e){var t=shaka.util.XmlUtils;return Array.from(e.childNodes).every(t.isText)?e.textContent.trim():null},shaka.util.XmlUtils.isText=function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE},shaka.util.XmlUtils.parseAttr=function(e,t,r,a){a=void 0===a?null:a;var n=null;return null!=(e=e.getAttribute(t))&&(n=r(e)),null==n?a:n},shaka.util.XmlUtils.parseDate=function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null},shaka.util.XmlUtils.parseDuration=function(e){if(!e)return null;var t=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e);return t?(e=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(e)?e:null):(shaka.log.warning("Invalid duration string:",e),null)},shaka.util.XmlUtils.parseRange=function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},shaka.util.XmlUtils.parseInt=function(e){return 0==(e=Number(e))%1?e:null},shaka.util.XmlUtils.parsePositiveInt=function(e){return 0==(e=Number(e))%1&&0<e?e:null},shaka.util.XmlUtils.parseNonNegativeInt=function(e){return 0==(e=Number(e))%1&&0<=e?e:null},shaka.util.XmlUtils.parseFloat=function(e){return e=Number(e),isNaN(e)?null:e},shaka.util.XmlUtils.evalDivision=function(e){var t,r=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(r)?null:r},shaka.util.XmlUtils.parseXmlString=function(e,t){var r=new DOMParser,a=shaka.util.XmlUtils.trustedHTMLFromString_.value()(e);e=null;try{e=r.parseFromString(a,"text/xml")}catch(e){return shaka.log.error("XML parsing exception:",e),null}if(goog.asserts.assert(e,"Parsed XML document cannot be null!"),!(r=e.documentElement))return shaka.log.error("XML document was empty!"),null;if((a=r.getElementsByTagName("parsererror")).length)return shaka.log.error("XML parser error found:",a[0]),null;if(r.tagName!=t)return shaka.log.error('XML tag name does not match expected "'+t+'":',r.tagName),null;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return shaka.log.error("XML document embeds unsafe content!"),null;return r},shaka.util.XmlUtils.parseXml=function(e,t){try{var r=shaka.util.StringUtils.fromUTF8(e);return shaka.util.XmlUtils.parseXmlString(r,t)}catch(e){return shaka.log.error("parseXmlString threw!",e),null}},shaka.util.XmlUtils.trustedHTMLFromString_=new shaka.util.Lazy((function(){if("undefined"!=typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}})),shaka.media.DrmEngine=function(e,t){var r=this;t=void 0===t?1:t,this.playerInterface_=e,this.supportedTypes_=new Set,this.video_=this.mediaKeys_=null,this.initializedForStorage_=this.initialized_=!1,this.licenseTimeSeconds_=0,this.currentDrmInfo_=null,this.eventManager_=new shaka.util.EventManager,this.activeSessions_=new Map,this.offlineSessionIds_=[],this.allSessionsLoaded_=new shaka.util.PublicPromise,this.config_=null,this.onError_=function(t){r.allSessionsLoaded_.reject(t),e.onError(t)},this.keyStatusByKeyId_=new Map,this.announcedKeyStatusByKeyId_=new Map,this.keyStatusTimer_=new shaka.util.Timer((function(){return r.processKeyStatusChanges_()})),this.usePersistentLicenses_=!1,this.mediaKeyMessageEvents_=[],this.initialRequestsSent_=!1,this.expirationTimer_=new shaka.util.Timer((function(){r.pollExpiration_()})).tickEvery(t),this.allSessionsLoaded_.catch((function(){})),this.destroyer_=new shaka.util.Destroyer((function(){return r.destroyNow_()})),this.srcEquals_=!1,this.mediaKeysAttached_=null},shaka.media.DrmEngine.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.media.DrmEngine.prototype.destroyNow_=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:return e.eventManager_.release(),e.eventManager_=null,e.allSessionsLoaded_.reject(),e.expirationTimer_.stop(),e.expirationTimer_=null,e.keyStatusTimer_.stop(),e.keyStatusTimer_=null,t.yield(e.closeOpenSessions_(),2);case 2:if(!e.video_){t.jumpTo(3);break}return goog.asserts.assert(!e.video_.src,"video src must be removed first!"),t.setCatchFinallyBlocks(4),t.yield(e.video_.setMediaKeys(null),6);case 6:t.leaveTryBlock(5);break;case 4:t.enterCatchBlock();case 5:e.video_=null;case 3:e.currentDrmInfo_=null,e.supportedTypes_.clear(),e.mediaKeys_=null,e.offlineSessionIds_=[],e.config_=null,e.onError_=function(){},e.playerInterface_=null,e.srcEquals_=!1,e.mediaKeysAttached_=null,t.jumpToEnd()}}))},shaka.media.DrmEngine.prototype.configure=function(e){this.config_=e},shaka.media.DrmEngine.prototype.setSrcEquals=function(e){this.srcEquals_=e},shaka.media.DrmEngine.prototype.initForStorage=function(e,t){return this.initializedForStorage_=!0,this.offlineSessionIds_=[],this.usePersistentLicenses_=t,this.init_(e)},shaka.media.DrmEngine.prototype.initForPlayback=function(e,t){return this.offlineSessionIds_=t,this.usePersistentLicenses_=0<t.length,this.init_(e)},shaka.media.DrmEngine.prototype.initForRemoval=function(e,t,r,a,n){var i=new Map;return(a={audioCapabilities:a,videoCapabilities:n,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:e}).drmInfos=[{keySystem:e,licenseServerUri:t,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,serverCertificateUri:"",initData:null,keyIds:null}],i.set(e,a),this.queryMediaKeys_(i,[])},shaka.media.DrmEngine.prototype.init_=function(e){var t,r,a,n,i,o,s,l,u,c,d,p,h,f=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(g){if(1==g.nextAddress){if(goog.asserts.assert(f.config_,"DrmEngine configure() must be called before init()!"),t=f.configureClearKey_())for(r=$jscomp.makeIterator(e),a=r.next();!a.done;a=r.next())(n=a.value).video&&(n.video.drmInfos=[t]),n.audio&&(n.audio.drmInfos=[t]);for((i=e.some((function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)})))||(o=shaka.util.MapUtils.asMap(f.config_.servers),shaka.media.DrmEngine.replaceDrmInfo_(e,o)),s=$jscomp.makeIterator(e),a=s.next();!a.done;a=s.next())for(l=a.value,u=f.getVariantDrmInfos_(l),c=$jscomp.makeIterator(u),d=c.next();!d.done;d=c.next())p=d.value,shaka.media.DrmEngine.fillInDrmInfoDefaults_(p,shaka.util.MapUtils.asMap(f.config_.servers),shaka.util.MapUtils.asMap(f.config_.advanced||{}),f.config_.keySystemsMapping);return g.yield(shaka.util.StreamUtils.getDecodingInfosForVariants(e,f.usePersistentLicenses_,f.srcEquals_),2)}return i||Object.keys(f.config_.servers).length?(h=f.queryMediaKeys_(void 0,e),g.return(i?h:h.catch((function(){})))):(f.initialized_=!0,g.return(Promise.resolve()))}))},shaka.media.DrmEngine.prototype.attachMediaKeys_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:if(t.video_.mediaKeys)return r.return();if(!t.mediaKeysAttached_){r.jumpTo(2);break}return r.yield(t.mediaKeysAttached_,3);case 3:return t.destroyer_.ensureNotDestroyed(),r.return();case 2:return r.setCatchFinallyBlocks(4),t.mediaKeysAttached_=t.video_.setMediaKeys(t.mediaKeys_),r.yield(t.mediaKeysAttached_,6);case 6:r.leaveTryBlock(5);break;case 4:e=r.enterCatchBlock(),goog.asserts.assert(e instanceof Error,"Wrong error type!"),t.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_ATTACH_TO_VIDEO,e.message));case 5:t.destroyer_.ensureNotDestroyed(),r.jumpToEnd()}}))},shaka.media.DrmEngine.prototype.onEncryptedEvent_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(t.attachMediaKeys_(),2);t.newInitData(e.initDataType,shaka.util.BufferUtils.toUint8(e.initData)),r.jumpToEnd()}))},shaka.media.DrmEngine.prototype.attach=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return r.mediaKeys_?(r.video_=e,r.eventManager_.listenOnce(r.video_,"play",(function(){return r.onPlay_()})),"webkitCurrentPlaybackTargetIsWireless"in r.video_&&r.eventManager_.listen(r.video_,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return r.closeOpenSessions_()})),(t=r.currentDrmInfo_?r.currentDrmInfo_.initData.find((function(e){return 0<e.initData.length})):null)||"com.apple.fps"!==r.currentDrmInfo_.keySystem||r.offlineSessionIds_.length?a.yield(r.attachMediaKeys_(),2):a.jumpTo(2)):(r.eventManager_.listenOnce(e,"encrypted",(function(e){r.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.ENCRYPTED_CONTENT_WITHOUT_DRM_INFO))})),a.return());r.createOrLoad(),t||r.offlineSessionIds_.length||r.config_.parseInbandPsshEnabled||r.eventManager_.listen(r.video_,"encrypted",(function(e){return r.onEncryptedEvent_(e)})),a.jumpToEnd()}))},shaka.media.DrmEngine.prototype.setServerCertificate=function(){var e,t,r,a,n,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:if(goog.asserts.assert(i.initialized_,"Must call init() before setServerCertificate"),!i.mediaKeys_||!i.currentDrmInfo_)return o.return();if(!i.currentDrmInfo_.serverCertificateUri||i.currentDrmInfo_.serverCertificate&&i.currentDrmInfo_.serverCertificate.length){o.jumpTo(2);break}return e=shaka.net.NetworkingEngine.makeRequest([i.currentDrmInfo_.serverCertificateUri],i.config_.retryParameters),o.setCatchFinallyBlocks(3),t=i.playerInterface_.netEngine.request(shaka.net.NetworkingEngine.RequestType.SERVER_CERTIFICATE,e),o.yield(t.promise,5);case 5:r=o.yieldResult,i.currentDrmInfo_.serverCertificate=shaka.util.BufferUtils.toUint8(r.data),o.leaveTryBlock(4);break;case 3:throw a=o.enterCatchBlock(),goog.asserts.assert(a instanceof shaka.util.Error,"Wrong NetworkingEngine error type!"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.SERVER_CERTIFICATE_REQUEST_FAILED,a);case 4:if(i.destroyer_.destroyed())return o.return();case 2:return i.currentDrmInfo_.serverCertificate&&i.currentDrmInfo_.serverCertificate.length?(o.setCatchFinallyBlocks(6),o.yield(i.mediaKeys_.setServerCertificate(i.currentDrmInfo_.serverCertificate),8)):o.return();case 8:o.yieldResult||shaka.log.warning("Server certificates are not supported by the key system.  The server certificate has been ignored."),o.leaveTryBlock(0);break;case 6:throw n=o.enterCatchBlock(),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.INVALID_SERVER_CERTIFICATE,n.message)}}))},shaka.media.DrmEngine.prototype.removeSession=function(e){var t,r,a,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(goog.asserts.assert(n.mediaKeys_,"Must call init() before removeSession"),i.yield(n.loadOfflineSession_(e),2)):3!=i.nextAddress?(t=i.yieldResult)?(r=[],(a=n.activeSessions_.get(t))&&(a.updatePromise=new shaka.util.PublicPromise,r.push(a.updatePromise)),shaka.log.v2("Attempting to remove session",e),r.push(t.remove()),i.yield(Promise.all(r),3)):(shaka.log.v2("Ignoring attempt to remove missing session",e),i.return()):(n.activeSessions_.delete(t),void i.jumpToEnd())}))},shaka.media.DrmEngine.prototype.createOrLoad=function(){for(var e=(this.currentDrmInfo_?this.currentDrmInfo_.initData:[])||[],t=$jscomp.makeIterator(e),r=t.next();!r.done;r=t.next())r=r.value,this.newInitData(r.initDataType,r.initData);for(r=(t=$jscomp.makeIterator(this.offlineSessionIds_)).next();!r.done;r=t.next())this.loadOfflineSession_(r.value);return e.length||this.offlineSessionIds_.length||this.allSessionsLoaded_.resolve(),this.allSessionsLoaded_},shaka.media.DrmEngine.prototype.newInitData=function(e,t){if(t.length){for(var r=this.activeSessions_.values(),a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next())if(shaka.util.BufferUtils.equal(t,a.value.initData)&&!shaka.util.Platform.isTizen2())return void shaka.log.debug("Ignoring duplicate init data.");0<this.activeSessions_.size&&this.areAllSessionsLoaded_()&&(this.allSessionsLoaded_.resolve(),this.allSessionsLoaded_=new shaka.util.PublicPromise,this.allSessionsLoaded_.catch((function(){}))),this.createSession(e,t,this.currentDrmInfo_.sessionType)}},shaka.media.DrmEngine.prototype.initialized=function(){return this.initialized_},shaka.media.DrmEngine.keySystem=function(e){return e?e.keySystem:""},shaka.media.DrmEngine.isPlayReadyKeySystem=function(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)},shaka.media.DrmEngine.isFairPlayKeySystem=function(e){return!!e&&!!e.match(/^com\.apple\.fps/)},shaka.media.DrmEngine.prototype.willSupport=function(e){if(shaka.util.Platform.isLegacyEdge())return!0;if(e=e.toLowerCase(),shaka.util.Platform.isTizen()&&e.includes('codecs="ac-3"')){var t=e.replace("ac-3","ec-3");return this.supportedTypes_.has(e)||this.supportedTypes_.has(t)}return this.supportedTypes_.has(e)},shaka.media.DrmEngine.prototype.getSessionIds=function(){var e=this.activeSessions_.keys();return e=shaka.util.Iterables.map(e,(function(e){return e.sessionId})),Array.from(e)},shaka.media.DrmEngine.prototype.getExpiration=function(){for(var e=1/0,t=this.activeSessions_.keys(),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=r.value,isNaN(r.expiration)||(e=Math.min(e,r.expiration));return e},shaka.media.DrmEngine.prototype.getLicenseTime=function(){return this.licenseTimeSeconds_?this.licenseTimeSeconds_:NaN},shaka.media.DrmEngine.prototype.getDrmInfo=function(){return this.currentDrmInfo_},shaka.media.DrmEngine.prototype.getMediaKeys=function(){return this.mediaKeys_},shaka.media.DrmEngine.prototype.getKeyStatuses=function(){return shaka.util.MapUtils.asObject(this.announcedKeyStatusByKeyId_)},shaka.media.DrmEngine.prototype.getMediaKeySessions=function(){return Array.from(this.activeSessions_.keys())},shaka.media.DrmEngine.computeMimeType_=function(e,t){return t=shaka.util.MimeUtils.getFullType(e.mimeType,t||e.codecs),shaka.media.Transmuxer.isSupported(t)?shaka.media.Transmuxer.convertCodecs(e.type,t):t},shaka.media.DrmEngine.prototype.queryMediaKeys_=function(e,t){var r,a,n,i,o,s,l,u,c,d,p,h,f,g=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(y){switch(y.nextAddress){case 1:if(r=new Map,t.length){a=g.getKeySystemAccessFromVariants_(t,r),y.jumpTo(2);break}return y.yield(g.getKeySystemAccessByConfigs_(e),3);case 3:a=y.yieldResult;case 2:if(!(n=a))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE);for(g.destroyer_.ensureNotDestroyed(),y.setCatchFinallyBlocks(4),g.supportedTypes_.clear(),i=n.getConfiguration(),shaka.log.v2("Got MediaKeySystemAccess with configuration",i),o=i.audioCapabilities||[],s=i.videoCapabilities||[],l=$jscomp.makeIterator(o),u=l.next();!u.done;u=l.next())c=u.value,g.supportedTypes_.add(c.contentType.toLowerCase());for(d=$jscomp.makeIterator(s),u=d.next();!u.done;u=d.next())p=u.value,g.supportedTypes_.add(p.contentType.toLowerCase());if(goog.asserts.assert(g.supportedTypes_.size,"We should get at least one supported MIME type"),g.currentDrmInfo_=t.length?g.createDrmInfoByInfos_(n.keySystem,r.get(n.keySystem)):shaka.media.DrmEngine.createDrmInfoByConfigs_(n.keySystem,e.get(n.keySystem)),!g.currentDrmInfo_.licenseServerUri)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.NO_LICENSE_SERVER_GIVEN,g.currentDrmInfo_.keySystem);return y.yield(n.createMediaKeys(),6);case 6:return h=y.yieldResult,g.destroyer_.ensureNotDestroyed(),shaka.log.info("Created MediaKeys object for key system",g.currentDrmInfo_.keySystem),g.mediaKeys_=h,g.initialized_=!0,y.yield(g.setServerCertificate(),7);case 7:g.destroyer_.ensureNotDestroyed(),y.leaveTryBlock(0);break;case 4:if(f=y.enterCatchBlock(),g.destroyer_.ensureNotDestroyed(f),g.currentDrmInfo_=null,g.supportedTypes_.clear(),f instanceof shaka.util.Error)throw f;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_CDM,f.message)}}))},shaka.media.DrmEngine.prototype.getKeySystemAccessFromVariants_=function(e,t){for(var r=$jscomp.makeIterator(e),a=r.next();!a.done;a=r.next()){var n=this.getVariantDrmInfos_(a.value);for(a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next()){var i=a.value;t.has(i.keySystem)||t.set(i.keySystem,[]),t.get(i.keySystem).push(i)}}if(1==t.size&&t.has(""))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.NO_RECOGNIZED_KEY_SYSTEMS);for(r={},i=(n=$jscomp.makeIterator(this.config_.preferredKeySystems)).next();!i.done;r={$jscomp$loop$prop$preferredKeySystem$640:r.$jscomp$loop$prop$preferredKeySystem$640},i=n.next())for(r.$jscomp$loop$prop$preferredKeySystem$640=i.value,a=(i=$jscomp.makeIterator(e)).next();!a.done;a=i.next())if(a=a.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.$jscomp$loop$prop$preferredKeySystem$640}}(r)))return a.keySystemAccess;for(n=(r=$jscomp.makeIterator([!0,!1])).next();!n.done;n=r.next())for(n=n.value,a=(i=$jscomp.makeIterator(e)).next();!a.done;a=i.next()){var o=$jscomp.makeIterator(a.value.decodingInfos);for(a=o.next();!a.done;a=o.next()){var s=a.value;if(s.supported&&s.keySystemAccess){a=t.get(s.keySystemAccess.keySystem);var l=$jscomp.makeIterator(a);for(a=l.next();!a.done;a=l.next())if(!!a.value.licenseServerUri==n)return s.keySystemAccess}}}return null},shaka.media.DrmEngine.prototype.getKeySystemAccessByConfigs_=function(e){var t,r,a,n,i,o,s,l,u,c,d,p,h,f,g,y,m=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){switch(v.nextAddress){case 1:if(1==e.size&&e.has(""))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.NO_RECOGNIZED_KEY_SYSTEMS);for(r=$jscomp.makeIterator(e.values()),a=r.next();!a.done;a=r.next())0==(n=a.value).audioCapabilities.length&&delete n.audioCapabilities,0==n.videoCapabilities.length&&delete n.videoCapabilities;i=$jscomp.makeIterator(m.config_.preferredKeySystems),o=i.next();case 2:if(o.done){v.jumpTo(4);break}if(s=o.value,!e.has(s)){v.jumpTo(3);break}return l=e.get(s),v.setCatchFinallyBlocks(6),v.yield(navigator.requestMediaKeySystemAccess(s,[l]),8);case 8:return t=v.yieldResult,v.return(t);case 6:u=v.enterCatchBlock(),shaka.log.v2("Requesting",s,"failed with config",l,u);case 7:m.destroyer_.ensureNotDestroyed();case 3:o=i.next(),v.jumpTo(2);break;case 4:c=$jscomp.makeIterator([!0,!1]),d=c.next();case 9:if(d.done){v.jumpTo(11);break}p=d.value,h=$jscomp.makeIterator(e.keys()),o=h.next();case 12:if(o.done){d=c.next(),v.jumpTo(9);break}if(f=o.value,g=e.get(f),g.drmInfos.some((function(e){return!!e.licenseServerUri}))!=p){v.jumpTo(13);break}return v.setCatchFinallyBlocks(15),v.yield(navigator.requestMediaKeySystemAccess(f,[g]),17);case 17:return t=v.yieldResult,v.return(t);case 15:y=v.enterCatchBlock(),shaka.log.v2("Requesting",f,"failed with config",g,y);case 16:m.destroyer_.ensureNotDestroyed();case 13:o=h.next(),v.jumpTo(12);break;case 11:return v.return(t)}}))},shaka.media.DrmEngine.prototype.configureClearKey_=function(){var e=shaka.util.MapUtils.asMap(this.config_.clearKeys);if(0==e.size)return null;var t=shaka.util.StringUtils,r=shaka.util.Uint8ArrayUtils,a=[],n=[];e.forEach((function(e,t){var i=t;22!=i.length&&(i=r.toBase64(r.fromHex(t),!1)),22!=(t=e).length&&(t=r.toBase64(r.fromHex(e),!1)),e={kty:"oct",kid:i,k:t},a.push(e),n.push(e.kid)})),e=JSON.stringify({keys:a});var i=JSON.stringify({kids:n});return t=[{initData:shaka.util.BufferUtils.toUint8(t.toUTF8(i)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:t,keyIds:new Set(n)}},shaka.media.DrmEngine.prototype.loadOfflineSession_=function(e){var t,r,a,n,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:try{shaka.log.v1("Attempting to load an offline session",e),t=o.mediaKeys_.createSession("persistent-license")}catch(e){return r=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,e.message),o.onError_(r),s.return(Promise.reject(r))}return o.eventManager_.listen(t,"message",(function(e){return o.onSessionMessage_(e)})),o.eventManager_.listen(t,"keystatuseschange",(function(e){return o.onKeyStatusesChange_(e)})),a={initData:null,initDataType:null,loaded:!1,oldExpiration:1/0,updatePromise:null,type:"persistent-license"},o.activeSessions_.set(t,a),s.setCatchFinallyBlocks(2),s.yield(t.load(e),4);case 4:return n=s.yieldResult,o.destroyer_.ensureNotDestroyed(),shaka.log.v2("Loaded offline session",e,n),n?(a.loaded=!0,o.areAllSessionsLoaded_()&&o.allSessionsLoaded_.resolve(),s.return(t)):(o.activeSessions_.delete(t),o.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.OFFLINE_SESSION_REMOVED)),s.return(Promise.resolve()));case 2:i=s.enterCatchBlock(),o.destroyer_.ensureNotDestroyed(i),o.activeSessions_.delete(t),o.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,i.message));case 3:return s.return(Promise.resolve())}}))},shaka.media.DrmEngine.prototype.createSession=function(e,t,r){var a=this;goog.asserts.assert(this.mediaKeys_,"mediaKeys_ should be valid when creating temporary session.");try{shaka.log.info("Creating new",r,"session");var n=this.mediaKeys_.createSession(r)}catch(e){return void this.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,e.message))}this.eventManager_.listen(n,"message",(function(e){return a.onSessionMessage_(e)})),this.eventManager_.listen(n,"keystatuseschange",(function(e){return a.onKeyStatusesChange_(e)})),this.activeSessions_.set(n,{initData:t,initDataType:e,loaded:!1,oldExpiration:1/0,updatePromise:null,type:r});try{t=this.config_.initDataTransform(t,e,this.currentDrmInfo_)}catch(t){return e=t,t instanceof shaka.util.Error||(e=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.INIT_DATA_TRANSFORM_ERROR,t)),void this.onError_(e)}this.config_.logLicenseExchange&&(r=shaka.util.Uint8ArrayUtils.toBase64(t),shaka.log.info("EME init data: type=",e,"data=",r)),n.generateRequest(e,t).catch((function(e){if(!a.destroyer_.destroyed()){goog.asserts.assert(e instanceof Error,"Wrong error type!"),a.activeSessions_.delete(n);var t=e.errorCode;if(t&&t.systemCode){var r=t.systemCode;0>r&&(r+=Math.pow(2,32)),r="0x"+r.toString(16)}a.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_GENERATE_LICENSE_REQUEST,e.message,e,r))}}))},shaka.media.DrmEngine.prototype.onSessionMessage_=function(e){this.delayLicenseRequest_()?this.mediaKeyMessageEvents_.push(e):this.sendLicenseRequest_(e)},shaka.media.DrmEngine.prototype.delayLicenseRequest_=function(){return!!this.video_&&(this.config_.delayLicenseRequestUntilPlayed&&this.video_.paused&&!this.initialRequestsSent_)},shaka.media.DrmEngine.prototype.sendLicenseRequest_=function(e){var t,r,a,n,i,o,s,l,u,c,d,p,h,f,g,y,m=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){switch(v.nextAddress){case 1:return t=e.target,shaka.log.v1("Sending license request for session",t.sessionId,"of type",e.messageType),m.config_.logLicenseExchange&&(r=shaka.util.Uint8ArrayUtils.toBase64(e.message),shaka.log.info("EME license request",r)),a=m.activeSessions_.get(t),n=m.currentDrmInfo_.licenseServerUri,i=m.config_.advanced[m.currentDrmInfo_.keySystem],"individualization-request"==e.messageType&&i&&i.individualizationServer&&(n=i.individualizationServer),o=shaka.net.NetworkingEngine.RequestType.LICENSE,(s=shaka.net.NetworkingEngine.makeRequest([n],m.config_.retryParameters)).body=e.message,s.method="POST",s.licenseRequestType=e.messageType,s.sessionId=t.sessionId,s.drmInfo=m.currentDrmInfo_,a&&(s.initData=a.initData,s.initDataType=a.initDataType),shaka.media.DrmEngine.isPlayReadyKeySystem(m.currentDrmInfo_.keySystem)&&m.unpackPlayReadyRequest_(s),l=Date.now(),v.setCatchFinallyBlocks(2),c=m.playerInterface_.netEngine.request(o,s),v.yield(c.promise,4);case 4:u=v.yieldResult,v.leaveTryBlock(3);break;case 2:return d=v.enterCatchBlock(),goog.asserts.assert(d instanceof shaka.util.Error,"Wrong NetworkingEngine error type!"),p=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.LICENSE_REQUEST_FAILED,d),m.onError_(p),a&&a.updatePromise&&a.updatePromise.reject(p),v.return();case 3:return m.destroyer_.destroyed()?v.return():(m.licenseTimeSeconds_+=(Date.now()-l)/1e3,m.config_.logLicenseExchange&&(h=shaka.util.Uint8ArrayUtils.toBase64(u.data),shaka.log.info("EME license response",h)),v.setCatchFinallyBlocks(5),shaka.log.v1("Updating session",t.sessionId),v.yield(t.update(u.data),7));case 7:v.leaveTryBlock(6);break;case 5:return f=v.enterCatchBlock(),g=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.LICENSE_RESPONSE_REJECTED,f.message),m.onError_(g),a&&a.updatePromise&&a.updatePromise.reject(g),v.return();case 6:if(m.destroyer_.destroyed())return v.return();y=new shaka.util.FakeEvent("drmsessionupdate"),m.playerInterface_.onEvent(y),a&&(a.updatePromise&&a.updatePromise.resolve(),new shaka.util.Timer((function(){a.loaded=!0,m.areAllSessionsLoaded_()&&m.allSessionsLoaded_.resolve()})).tickAfter(shaka.media.DrmEngine.SESSION_LOAD_TIMEOUT_)),v.jumpToEnd()}}))},shaka.media.DrmEngine.prototype.unpackPlayReadyRequest_=function(e){var t=shaka.util.StringUtils.fromUTF16(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){shaka.log.debug("Unwrapping PlayReady request."),t=shaka.util.XmlUtils.parseXmlString(t,"PlayReadyKeyMessage"),goog.asserts.assert(t,"Failed to parse PlayReady XML!");for(var r=t.getElementsByTagName("HttpHeader"),a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next()){var n=a.value;a=n.getElementsByTagName("name")[0],n=n.getElementsByTagName("value")[0],goog.asserts.assert(a&&n,"Malformed PlayReady headers!"),e.headers[a.textContent]=n.textContent}t=t.getElementsByTagName("Challenge")[0],goog.asserts.assert(t,"Malformed PlayReady challenge!"),goog.asserts.assert("base64encoded"==t.getAttribute("encoding"),"Unexpected PlayReady challenge encoding!"),e.body=shaka.util.Uint8ArrayUtils.fromBase64(t.textContent)}else shaka.log.debug("PlayReady request is already unwrapped."),e.headers["Content-Type"]="text/xml; charset=utf-8"},shaka.media.DrmEngine.prototype.onKeyStatusesChange_=function(e){var t=this;e=e.target,shaka.log.v2("Key status changed for session",e.sessionId);var r=this.activeSessions_.get(e),a=!1;e.keyStatuses.forEach((function(e,n){if("string"==typeof n){var i=n;n=e,e=i}if(shaka.media.DrmEngine.isPlayReadyKeySystem(t.currentDrmInfo_.keySystem)&&16==n.byteLength&&(shaka.util.Platform.isEdge()||shaka.util.Platform.isPS4())){var o=(i=shaka.util.BufferUtils.toDataView(n)).getUint32(0,!0),s=i.getUint16(4,!0),l=i.getUint16(6,!0);i.setUint32(0,o,!1),i.setUint16(4,s,!1),i.setUint16(6,l,!1)}"status-pending"!=e&&(r.loaded=!0),r||goog.asserts.assert("usable"!=e,"Usable keys found in closed session"),"expired"==e&&(a=!0),n=shaka.util.Uint8ArrayUtils.toHex(n).slice(0,32),t.keyStatusByKeyId_.set(n,e)}));var n=e.expiration-Date.now();(0>n||a&&1e3>n)&&r&&!r.updatePromise&&(shaka.log.debug("Session has expired",e.sessionId),this.activeSessions_.delete(e),e.close().catch((function(){}))),this.areAllSessionsLoaded_()&&(this.allSessionsLoaded_.resolve(),this.keyStatusTimer_.tickAfter(shaka.media.DrmEngine.KEY_STATUS_BATCH_TIME))},shaka.media.DrmEngine.prototype.processKeyStatusChanges_=function(){var e=this.keyStatusByKeyId_,t=this.announcedKeyStatusByKeyId_;t.clear(),e.forEach((function(e,r){return t.set(r,e)})),(e=Array.from(t.values())).length&&e.every((function(e){return"expired"==e}))&&this.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.EXPIRED)),this.playerInterface_.onKeyStatus(shaka.util.MapUtils.asObject(t))},shaka.media.DrmEngine.isBrowserSupported=function(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)},shaka.media.DrmEngine.probeSupport=function(){var e,t,r,a,n,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(goog.asserts.assert(shaka.media.DrmEngine.isBrowserSupported(),"Must have basic EME support"),e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.recommendation com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" "),r=[{videoCapabilities:t=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{initDataTypes:["cenc"],videoCapabilities:t}],a=new Map,n=function(e){var t,n,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:if(o.setCatchFinallyBlocks(2),"org.w3.clearkey"===e&&shaka.util.Platform.isSafari())throw Error("Unsupported keySystem");return o.yield(navigator.requestMediaKeySystemAccess(e,r),4);case 4:return t=o.yieldResult,i=!!(n=t.getConfiguration().sessionTypes)&&n.includes("persistent-license"),shaka.util.Platform.isTizen3()&&(i=!1),a.set(e,{persistentState:i}),o.yield(t.createMediaKeys(),5);case 5:o.leaveTryBlock(0);break;case 2:o.enterCatchBlock(),a.set(e,null),o.jumpToEnd()}}))},i=e.map((function(e){return n(e)})),o.yield(Promise.all(i),2)):o.return(shaka.util.MapUtils.asObject(a))}))},shaka.media.DrmEngine.prototype.onPlay_=function(){for(var e=$jscomp.makeIterator(this.mediaKeyMessageEvents_),t=e.next();!t.done;t=e.next())this.sendLicenseRequest_(t.value);this.initialRequestsSent_=!0,this.mediaKeyMessageEvents_=[]},shaka.media.DrmEngine.prototype.closeSession_=function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(t=shaka.media.DrmEngine,r=new Promise((function(e,r){new shaka.util.Timer(r).tickAfter(t.CLOSE_TIMEOUT_)})),a.setCatchFinallyBlocks(2),a.yield(Promise.race([Promise.all([e.close(),e.closed]),r]),4)):2!=a.nextAddress?a.leaveTryBlock(0):(a.enterCatchBlock(),shaka.log.warning("Timeout waiting for session close"),void a.jumpToEnd())}))},shaka.media.DrmEngine.prototype.closeOpenSessions_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return e=Array.from(t.activeSessions_.entries()),t.activeSessions_.clear(),r.yield(Promise.all(e.map((function(e){var r,a=(e=$jscomp.makeIterator(e)).next().value,n=e.next().value;return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return 1==e.nextAddress?(e.setCatchFinallyBlocks(2),t.initializedForStorage_||t.offlineSessionIds_.includes(a.sessionId)||"persistent-license"!==n.type?(shaka.log.v1("Closing session",a.sessionId,n),e.yield(t.closeSession_(a),5)):(shaka.log.v1("Removing session",a.sessionId),e.yield(a.remove(),5))):2!=e.nextAddress?e.leaveTryBlock(0):(r=e.enterCatchBlock(),shaka.log.error("Failed to close or remove the session",r),void e.jumpToEnd())}))}))),0)}))},shaka.media.DrmEngine.prototype.supportsVariant=function(e){var t=e.audio,r=e.video;if(t&&t.encrypted&&(t=shaka.media.DrmEngine.computeMimeType_(t),!this.willSupport(t))||r&&r.encrypted&&(r=shaka.media.DrmEngine.computeMimeType_(r),!this.willSupport(r)))return!1;var a=shaka.media.DrmEngine.keySystem(this.currentDrmInfo_);return 0==(e=this.getVariantDrmInfos_(e)).length||e.some((function(e){return e.keySystem==a}))},shaka.media.DrmEngine.areDrmCompatible=function(e,t){return!e.length||!t.length||0<shaka.media.DrmEngine.getCommonDrmInfos(e,t).length},shaka.media.DrmEngine.getCommonDrmInfos=function(e,t){if(!e.length)return t;if(!t.length)return e;for(var r=[],a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){a=a.value;for(var n={},i=$jscomp.makeIterator(t),o=i.next();!o.done;n={$jscomp$loop$prop$initData$642:n.$jscomp$loop$prop$initData$642},o=i.next())if(o=o.value,a.keySystem==o.keySystem){n.$jscomp$loop$prop$initData$642=[],n.$jscomp$loop$prop$initData$642=n.$jscomp$loop$prop$initData$642.concat(a.initData||[]),n.$jscomp$loop$prop$initData$642=n.$jscomp$loop$prop$initData$642.concat(o.initData||[]),n.$jscomp$loop$prop$initData$642=n.$jscomp$loop$prop$initData$642.filter(function(e){return function(t,r){return void 0===t.keyId||r===e.$jscomp$loop$prop$initData$642.findIndex((function(e){return e.keyId===t.keyId}))}}(n)),i=a.keyIds&&o.keyIds?new Set([].concat($jscomp.arrayFromIterable(a.keyIds),$jscomp.arrayFromIterable(o.keyIds))):a.keyIds||o.keyIds,r.push({keySystem:a.keySystem,licenseServerUri:a.licenseServerUri||o.licenseServerUri,distinctiveIdentifierRequired:a.distinctiveIdentifierRequired||o.distinctiveIdentifierRequired,persistentStateRequired:a.persistentStateRequired||o.persistentStateRequired,videoRobustness:a.videoRobustness||o.videoRobustness,audioRobustness:a.audioRobustness||o.audioRobustness,serverCertificate:a.serverCertificate||o.serverCertificate,serverCertificateUri:a.serverCertificateUri||o.serverCertificateUri,initData:n.$jscomp$loop$prop$initData$642,keyIds:i});break}}return r},shaka.media.DrmEngine.prototype.getVariantDrmInfos_=function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])},shaka.media.DrmEngine.prototype.pollExpiration_=function(){var e=this;this.activeSessions_.forEach((function(t,r){var a=t.oldExpiration,n=r.expiration;isNaN(n)&&(n=1/0),n!=a&&(e.playerInterface_.onExpirationUpdated(r.sessionId,n),t.oldExpiration=n)}))},shaka.media.DrmEngine.prototype.areAllSessionsLoaded_=function(){var e=this.activeSessions_.values();return shaka.util.Iterables.every(e,(function(e){return e.loaded}))},shaka.media.DrmEngine.replaceDrmInfo_=function(e,t){var r=[];for(t.forEach((function(e,t){r.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})})),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())(t=t.value).video&&(t.video.drmInfos=r),t.audio&&(t.audio.drmInfos=r)},shaka.media.DrmEngine.prototype.createDrmInfoByInfos_=function(e,t){var r=[],a=[],n=[],i=[],o=new Set;shaka.media.DrmEngine.processDrmInfos_(t,r,n,a,i,o),1<n.length&&shaka.log.warning("Multiple unique server certificates found! Only the first will be used."),1<r.length&&shaka.log.warning("Multiple unique license server URIs found! Only the first will be used."),1<a.length&&shaka.log.warning("Multiple unique server certificate URIs found! Only the first will be used.");var s=this.usePersistentLicenses_?"persistent-license":"temporary";for(e={keySystem:e,licenseServerUri:r[0],distinctiveIdentifierRequired:t[0].distinctiveIdentifierRequired,persistentStateRequired:t[0].persistentStateRequired,sessionType:t[0].sessionType||s,audioRobustness:t[0].audioRobustness||"",videoRobustness:t[0].videoRobustness||"",serverCertificate:n[0],serverCertificateUri:a[0],initData:i,keyIds:o},r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())(r=r.value).distinctiveIdentifierRequired&&(e.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),r.persistentStateRequired&&(e.persistentStateRequired=r.persistentStateRequired);return e},shaka.media.DrmEngine.createDrmInfoByConfigs_=function(e,t){var r=[],a=[],n=[],i=[],o=new Set;return shaka.media.DrmEngine.processDrmInfos_(t.drmInfos,r,n,a,i,o),1<n.length&&shaka.log.warning("Multiple unique server certificates found! Only the first will be used."),1<a.length&&shaka.log.warning("Multiple unique server certificate URIs found! Only the first will be used."),1<r.length&&shaka.log.warning("Multiple unique license server URIs found! Only the first will be used."),{keySystem:e,licenseServerUri:r[0],distinctiveIdentifierRequired:"required"==t.distinctiveIdentifier,persistentStateRequired:"required"==t.persistentState,sessionType:t.sessionTypes[0]||"temporary",audioRobustness:(t.audioCapabilities?t.audioCapabilities[0].robustness:"")||"",videoRobustness:(t.videoCapabilities?t.videoCapabilities[0].robustness:"")||"",serverCertificate:n[0],serverCertificateUri:a[0],initData:i,keyIds:o}},shaka.media.DrmEngine.processDrmInfos_=function(e,t,r,a,n,i){for(var o={},s=(e=$jscomp.makeIterator(e)).next();!s.done;o={$jscomp$loop$prop$drmInfo$644:o.$jscomp$loop$prop$drmInfo$644},s=e.next()){if(o.$jscomp$loop$prop$drmInfo$644=s.value,t.includes(o.$jscomp$loop$prop$drmInfo$644.licenseServerUri)||t.push(o.$jscomp$loop$prop$drmInfo$644.licenseServerUri),a.includes(o.$jscomp$loop$prop$drmInfo$644.serverCertificateUri)||a.push(o.$jscomp$loop$prop$drmInfo$644.serverCertificateUri),o.$jscomp$loop$prop$drmInfo$644.serverCertificate&&(r.some(function(e){return function(t){return shaka.util.BufferUtils.equal(t,e.$jscomp$loop$prop$drmInfo$644.serverCertificate)}}(o))||r.push(o.$jscomp$loop$prop$drmInfo$644.serverCertificate)),o.$jscomp$loop$prop$drmInfo$644.initData){s={};for(var l=$jscomp.makeIterator(o.$jscomp$loop$prop$drmInfo$644.initData),u=l.next();!u.done;s={$jscomp$loop$prop$initDataOverride$646:s.$jscomp$loop$prop$initDataOverride$646},u=l.next())s.$jscomp$loop$prop$initDataOverride$646=u.value,n.some(function(e){return function(t){var r=e.$jscomp$loop$prop$initDataOverride$646;return t=!(!t.keyId||t.keyId!=r.keyId)||t.initDataType==r.initDataType&&shaka.util.BufferUtils.equal(t.initData,r.initData)}}(s))||n.push(s.$jscomp$loop$prop$initDataOverride$646)}if(o.$jscomp$loop$prop$drmInfo$644.keyIds)for(l=(s=$jscomp.makeIterator(o.$jscomp$loop$prop$drmInfo$644.keyIds)).next();!l.done;l=s.next())i.add(l.value)}},shaka.media.DrmEngine.fillInDrmInfoDefaults_=function(e,t,r,a){var n=e.keySystem;!n||"org.w3.clearkey"==n&&e.licenseServerUri||(t.size&&(t=t.get(n)||"",e.licenseServerUri=t),e.keyIds||(e.keyIds=new Set),(r=r.get(n))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=r.persistentStateRequired),e.videoRobustness||(e.videoRobustness=r.videoRobustness),e.audioRobustness||(e.audioRobustness=r.audioRobustness),e.serverCertificate||(e.serverCertificate=r.serverCertificate),r.sessionType&&(e.sessionType=r.sessionType),e.serverCertificateUri||(e.serverCertificateUri=r.serverCertificateUri)),a[n]&&(e.keySystem=a[n]),window.cast&&window.cast.__platform__&&"com.microsoft.playready"==n&&(e.keySystem="com.chromecast.playready"))},shaka.media.DrmEngine.prototype.parseInbandPssh=function(e,t){if(!this.config_.parseInbandPsshEnabled)return Promise.resolve();var r=shaka.util.ManifestParserUtils.ContentType;if(![r.AUDIO,r.VIDEO].includes(e))return Promise.resolve();t=new shaka.util.Pssh(shaka.util.BufferUtils.toUint8(t)),r=0;var a=$jscomp.makeIterator(t.data);for(e=a.next();!e.done;e=a.next())r+=e.value.length;if(0==r)return Promise.resolve();for(r=new Uint8Array(r),a=0,e=(t=$jscomp.makeIterator(t.data)).next();!e.done;e=t.next())e=e.value,r.set(e,a),a+=e.length;return this.newInitData("cenc",r),this.allSessionsLoaded_},shaka.media.DrmEngine.CLOSE_TIMEOUT_=1,shaka.media.DrmEngine.SESSION_LOAD_TIMEOUT_=5,shaka.media.DrmEngine.KEY_STATUS_BATCH_TIME=.5,shaka.media.DrmEngine.DUMMY_KEY_ID=new shaka.util.Lazy((function(){return shaka.util.BufferUtils.toArrayBuffer(new Uint8Array([0]))})),shaka.media.ManifestParser=function(){},shaka.media.ManifestParser.registerParserByExtension=function(e,t){shaka.media.ManifestParser.parsersByExtension[e]=t},shaka.media.ManifestParser.registerParserByMime=function(e,t){shaka.media.ManifestParser.parsersByMime[e]=t},shaka.media.ManifestParser.unregisterParserByMime=function(e){delete shaka.media.ManifestParser.parsersByMime[e]},shaka.media.ManifestParser.probeSupport=function(){var e=shaka.media.ManifestParser,t={};if(shaka.util.Platform.supportsMediaSource()){for(var r in e.parsersByMime)t[r]=!0;for(var a in e.parsersByExtension)t[a]=!0}r={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var n=(a=$jscomp.makeIterator(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!n.done;n=a.next())n=n.value,shaka.util.Platform.supportsMediaSource()?t[n]=!!e.parsersByMime[n]:t[n]=shaka.util.Platform.supportsMediaType(n);for(var i in r)shaka.util.Platform.supportsMediaSource()?t[i]=!!e.parsersByExtension[i]:t[i]=shaka.util.Platform.supportsMediaType(r[i]);return t},shaka.media.ManifestParser.getFactory=function(e,t,r,a){var n,i,o,s,l;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress){if(n=shaka.media.ManifestParser,a){if(i=n.parsersByMime[a.toLowerCase()])return u.return(i);shaka.log.warning("Could not determine manifest type using MIME type ",a)}if(o=n.getExtension(e)){if(s=n.parsersByExtension[o])return u.return(s);shaka.log.warning("Could not determine manifest type for extension ",o)}else shaka.log.warning("Could not find extension for ",e);return a?u.jumpTo(2):u.yield(n.getMimeType(e,t,r),3)}if(2!=u.nextAddress&&(a=u.yieldResult)){if(l=shaka.media.ManifestParser.parsersByMime[a])return u.return(l);shaka.log.warning("Could not determine manifest type using MIME type",a)}throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.UNABLE_TO_GUESS_MANIFEST_TYPE,e)}))},shaka.media.ManifestParser.getMimeType=function(e,t,r){var a,n,i,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(a=shaka.net.NetworkingEngine.RequestType.MANIFEST,(n=shaka.net.NetworkingEngine.makeRequest([e],r)).method="HEAD",s.yield(t.request(a,n).promise,2)):(i=s.yieldResult,o=i.headers["content-type"],s.return(o?o.toLowerCase().split(";").shift():""))}))},shaka.media.ManifestParser.getExtension=function(e){return 1==(e=new goog.Uri(e).getPath().split("/").pop().split(".")).length?"":e.pop().toLowerCase()},shaka.media.ManifestParser.isSupported=function(e,t){return!!shaka.util.Platform.supportsMediaSource()&&(t in shaka.media.ManifestParser.parsersByMime||shaka.media.ManifestParser.getExtension(e)in shaka.media.ManifestParser.parsersByExtension)},goog.exportSymbol("shaka.media.ManifestParser",shaka.media.ManifestParser),goog.exportProperty(shaka.media.ManifestParser,"unregisterParserByMime",shaka.media.ManifestParser.unregisterParserByMime),goog.exportProperty(shaka.media.ManifestParser,"registerParserByMime",shaka.media.ManifestParser.registerParserByMime),goog.exportProperty(shaka.media.ManifestParser,"registerParserByExtension",shaka.media.ManifestParser.registerParserByExtension),shaka.media.ManifestParser.parsersByMime={},shaka.media.ManifestParser.parsersByExtension={},shaka.media.ContentWorkarounds=function(){},shaka.media.ContentWorkarounds.fakeEncryption=function(e){var t=shaka.media.ContentWorkarounds;e=shaka.util.BufferUtils.toUint8(e);var r,a=!1,n=[],i=function(e){n.push(e),shaka.util.Mp4Parser.children(e)},o=function(e){a=!0},s=[];if((new shaka.util.Mp4Parser).box("moov",i).box("trak",i).box("mdia",i).box("minf",i).box("stbl",i).fullBox("stsd",(function(e){r=e,n.push(e),shaka.util.Mp4Parser.sampleDescription(e)})).fullBox("encv",o).fullBox("enca",o).fullBox("hev1",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("hvc1",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("avc1",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("avc3",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("ac-3",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCA_})})).fullBox("ec-3",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCA_})})).fullBox("mp4a",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCA_})})).parse(e),a)return shaka.log.debug("Init segment already indicates encryption."),e;if(0==s.length||!r)throw shaka.log.error("Failed to find boxes needed to fake encryption!"),shaka.log.v2("Failed init segment (hex):",shaka.util.Uint8ArrayUtils.toHex(e)),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.CONTENT_TRANSFORMATION_FAILED);for(s.reverse(),o=(i=$jscomp.makeIterator(s)).next();!o.done;o=i.next()){o=o.value;var l=shaka.util.Mp4Parser.typeToString(o.newType);shaka.log.debug('Inserting "'+l+'" box into init segment.'),e=t.insertEncryptionMetadata_(e,r,o.box,n,o.newType)}return e},shaka.media.ContentWorkarounds.insertEncryptionMetadata_=function(e,t,r,a,n){var i=shaka.media.ContentWorkarounds,o=i.createEncryptionMetadata_(e,r,n);n=new Uint8Array(e.byteLength+o.byteLength),r=shaka.util.Platform.isXboxOne()?r.start:r.start+r.size;var s=e.subarray(0,r);for(e=e.subarray(r),n.set(s),n.set(o,r),n.set(e,r+o.byteLength),e=(a=$jscomp.makeIterator(a)).next();!e.done;e=a.next())e=e.value,goog.asserts.assert(e.start<r,"Ancestor MP4 box found in the wrong location!  Modified init segment will not make sense!"),i.updateBoxSize_(n,e.start,e.size+o.byteLength);return i=shaka.util.BufferUtils.toDataView(n,t.start),t=shaka.util.Mp4Parser.headerSize(t),o=i.getUint32(t),i.setUint32(t,o+1),n},shaka.media.ContentWorkarounds.createEncryptionMetadata_=function(e,t,r){var a=shaka.media.ContentWorkarounds,n=a.CANNED_SINF_BOX_.value(),i=e.subarray(t.start,t.start+t.size),o=shaka.util.BufferUtils.toDataView(i);return(e=new Uint8Array(t.size+n.byteLength)).set(i,0),(i=shaka.util.BufferUtils.toDataView(e)).setUint32(a.BOX_TYPE_OFFSET_,r),e.set(n,t.size),r=o.getUint32(a.BOX_TYPE_OFFSET_),i.setUint32(t.size+a.CANNED_SINF_BOX_FORMAT_OFFSET_,r),a.updateBoxSize_(e,0,e.byteLength),e},shaka.media.ContentWorkarounds.updateBoxSize_=function(e,t,r){var a=shaka.media.ContentWorkarounds;0!=(t=(e=shaka.util.BufferUtils.toDataView(e,t)).getUint32(a.BOX_SIZE_OFFSET_))&&(1==t?(e.setUint32(a.BOX_SIZE_64_OFFSET_,r>>32),e.setUint32(a.BOX_SIZE_64_OFFSET_+4,4294967295&r)):e.setUint32(a.BOX_SIZE_OFFSET_,r))},shaka.media.ContentWorkarounds.CANNED_SINF_BOX_=new shaka.util.Lazy((function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])})),shaka.media.ContentWorkarounds.CANNED_SINF_BOX_FORMAT_OFFSET_=16,shaka.media.ContentWorkarounds.BOX_SIZE_OFFSET_=0,shaka.media.ContentWorkarounds.BOX_TYPE_OFFSET_=4,shaka.media.ContentWorkarounds.BOX_SIZE_64_OFFSET_=8,shaka.media.ContentWorkarounds.BOX_TYPE_ENCV_=1701733238,shaka.media.ContentWorkarounds.BOX_TYPE_ENCA_=1701733217,shaka.cea={},shaka.cea.ICaptionDecoder=function(){},shaka.cea.ICaptionDecoder.prototype.extract=function(e,t){},shaka.cea.ICaptionDecoder.prototype.decode=function(){},shaka.cea.ICaptionDecoder.prototype.clear=function(){},shaka.cea.CeaUtils=function(){},shaka.cea.CeaUtils.getParsedCaption=function(e,t,r,a,n){if(a>=n)return null;for(var i=-1,o=-1,s=0;s<r.length;s++)if(r[s].some((function(e){return null!=e&&""!=e.getChar().trim()}))){i=s;break}for(s=r.length-1;0<=s;s--)if(r[s].some((function(e){return null!=e&&""!=e.getChar().trim()}))){o=s;break}if(-1===i||-1===o)return null;for(var l=s=!1,u=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,c=shaka.cea.CeaUtils.DEFAULT_BG_COLOR,d=shaka.cea.CeaUtils.createStyledCue(a,n,s,l,u,c);i<=o;i++){for(var p=r[i],h=-1,f=-1,g=0;g<p.length;g++)if(null!=p[g]&&""!==p[g].getChar().trim()){h=g;break}for(g=p.length-1;0<=g;g--)if(null!=p[g]&&""!==p[g].getChar().trim()){f=g;break}if(-1===h||-1===f)p=shaka.cea.CeaUtils.createLineBreakCue(a,n),e.nestedCues.push(p);else{for(;h<=f;h++)if(g=p[h]){var y=g.isUnderlined(),m=g.isItalicized(),v=g.getTextColor(),_=g.getBackgroundColor();y==s&&m==l&&v==u&&_==c||(d.payload&&e.nestedCues.push(d),d=shaka.cea.CeaUtils.createStyledCue(a,n,y,m,v,_),s=y,l=m,u=v,c=_),d.payload+=g.getChar()}else d.payload+=" ";d.payload&&e.nestedCues.push(d),i!==o&&(d=shaka.cea.CeaUtils.createLineBreakCue(a,n),e.nestedCues.push(d)),d=shaka.cea.CeaUtils.createStyledCue(a,n,s,l,u,c)}}return e.nestedCues.length?{cue:e,stream:t}:null},shaka.cea.CeaUtils.createStyledCue=function(e,t,r,a,n,i){return e=new shaka.text.Cue(e,t,""),r&&e.textDecoration.push(shaka.text.Cue.textDecoration.UNDERLINE),a&&(e.fontStyle=shaka.text.Cue.fontStyle.ITALIC),e.color=n,e.backgroundColor=i,e},shaka.cea.CeaUtils.createLineBreakCue=function(e,t){return(e=new shaka.text.Cue(e,t,"")).lineBreak=!0,e},shaka.cea.CeaUtils.StyledChar=function(e,t,r,a,n){this.character_=e,this.underline_=t,this.italics_=r,this.backgroundColor_=a,this.textColor_=n},shaka.cea.CeaUtils.StyledChar.prototype.getChar=function(){return this.character_},shaka.cea.CeaUtils.StyledChar.prototype.isUnderlined=function(){return this.underline_},shaka.cea.CeaUtils.StyledChar.prototype.isItalicized=function(){return this.italics_},shaka.cea.CeaUtils.StyledChar.prototype.getBackgroundColor=function(){return this.backgroundColor_},shaka.cea.CeaUtils.StyledChar.prototype.getTextColor=function(){return this.textColor_},shaka.cea.CeaUtils.DEFAULT_BG_COLOR="black",shaka.cea.CeaUtils.DEFAULT_TXT_COLOR="white",shaka.cea.Cea608Memory=function(e,t){this.rows_=[],this.row_=1,this.scrollRows_=0,this.fieldNum_=e,this.channelNum_=t,this.italics_=this.underline_=!1,this.textColor_=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,this.backgroundColor_=shaka.cea.CeaUtils.DEFAULT_BG_COLOR,this.reset()},shaka.cea.Cea608Memory.prototype.forceEmit=function(e,t){var r="CC"+(this.fieldNum_<<1|this.channelNum_+1),a=new shaka.text.Cue(e,t,"");return shaka.cea.CeaUtils.getParsedCaption(a,r,this.rows_,e,t)},shaka.cea.Cea608Memory.prototype.reset=function(){this.resetAllRows(),this.row_=1},shaka.cea.Cea608Memory.prototype.getRow=function(){return this.row_},shaka.cea.Cea608Memory.prototype.setRow=function(e){this.row_=e},shaka.cea.Cea608Memory.prototype.getScrollSize=function(){return this.scrollRows_},shaka.cea.Cea608Memory.prototype.setScrollSize=function(e){this.scrollRows_=e},shaka.cea.Cea608Memory.prototype.addChar=function(e,t){if(!(32>t||127<t)){var r="";switch(e){case shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN:r=shaka.cea.Cea608Memory.CharSet.BasicNorthAmericanChars.has(t)?shaka.cea.Cea608Memory.CharSet.BasicNorthAmericanChars.get(t):String.fromCharCode(t);break;case shaka.cea.Cea608Memory.CharSet.SPECIAL_NORTH_AMERICAN:r=shaka.cea.Cea608Memory.CharSet.SpecialNorthAmericanChars.get(t);break;case shaka.cea.Cea608Memory.CharSet.SPANISH_FRENCH:this.eraseChar(),r=shaka.cea.Cea608Memory.CharSet.ExtendedSpanishFrench.get(t);break;case shaka.cea.Cea608Memory.CharSet.PORTUGUESE_GERMAN:this.eraseChar(),r=shaka.cea.Cea608Memory.CharSet.ExtendedPortugueseGerman.get(t)}r&&(e=new shaka.cea.CeaUtils.StyledChar(r,this.underline_,this.italics_,this.backgroundColor_,this.textColor_),this.rows_[this.row_].push(e))}},shaka.cea.Cea608Memory.prototype.eraseChar=function(){this.rows_[this.row_].pop()},shaka.cea.Cea608Memory.prototype.moveRows=function(e,t,r){if(!(0>t||0>e))if(e>=t)for(--r;0<=r;r--)this.rows_[e+r]=this.rows_[t+r].map((function(e){return e}));else for(var a=0;a<r;a++)this.rows_[e+a]=this.rows_[t+a].map((function(e){return e}))},shaka.cea.Cea608Memory.prototype.resetRows=function(e,t){for(var r=0;r<=t;r++)this.rows_[e+r]=[]},shaka.cea.Cea608Memory.prototype.resetAllRows=function(){this.resetRows(0,shaka.cea.Cea608Memory.CC_ROWS)},shaka.cea.Cea608Memory.prototype.eraseBuffer=function(){this.row_=0<this.scrollRows_?this.scrollRows_:0,this.resetAllRows()},shaka.cea.Cea608Memory.prototype.setUnderline=function(e){this.underline_=e},shaka.cea.Cea608Memory.prototype.setItalics=function(e){this.italics_=e},shaka.cea.Cea608Memory.prototype.setTextColor=function(e){this.textColor_=e},shaka.cea.Cea608Memory.prototype.setBackgroundColor=function(e){this.backgroundColor_=e},shaka.cea.Cea608Memory.CC_ROWS=15,shaka.cea.Cea608Memory.CharSet={BASIC_NORTH_AMERICAN:0,SPECIAL_NORTH_AMERICAN:1,SPANISH_FRENCH:2,PORTUGUESE_GERMAN:3},shaka.cea.Cea608Memory.CharSet.BasicNorthAmericanChars=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),shaka.cea.Cea608Memory.CharSet.SpecialNorthAmericanChars=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57,"⠀"],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),shaka.cea.Cea608Memory.CharSet.ExtendedSpanishFrench=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),shaka.cea.Cea608Memory.CharSet.ExtendedPortugueseGerman=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]),shaka.cea.Cea608DataChannel=function(e,t){this.type_=shaka.cea.Cea608DataChannel.CaptionType.NONE,this.text_=new shaka.cea.Cea608Memory(e,t),this.displayedMemory_=new shaka.cea.Cea608Memory(e,t),this.nonDisplayedMemory_=new shaka.cea.Cea608Memory(e,t),this.curbuf_=this.displayedMemory_,this.prevEndTime_=0,this.lastcp_=null},shaka.cea.Cea608DataChannel.prototype.reset=function(){this.type_=shaka.cea.Cea608DataChannel.CaptionType.PAINTON,this.curbuf_=this.displayedMemory_,this.lastcp_=null,this.displayedMemory_.reset(),this.nonDisplayedMemory_.reset(),this.text_.reset()},shaka.cea.Cea608DataChannel.prototype.pacToRow_=function(e,t){return[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&e)<<1|t>>5&1]},shaka.cea.Cea608DataChannel.prototype.controlPac_=function(e,t){e=this.pacToRow_(e,t);var r=(30&t)>>1,a=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,n=!1;if(7>r?a=shaka.cea.Cea608DataChannel.TEXT_COLORS[r]:7===r&&(n=!0),t=1==(1&t),this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT){if(r=this.curbuf_,this.type_===shaka.cea.Cea608DataChannel.CaptionType.ROLLUP&&e!==r.getRow()){var i=1+r.getRow()-r.getScrollSize(),o=1+e-r.getScrollSize();r.moveRows(o,i,r.getScrollSize()),r.resetRows(0,o-1),r.resetRows(e+1,shaka.cea.Cea608Memory.CC_ROWS-e)}r.setRow(e),this.curbuf_.setUnderline(t),this.curbuf_.setItalics(n),this.curbuf_.setTextColor(a),this.curbuf_.setBackgroundColor(shaka.cea.CeaUtils.DEFAULT_BG_COLOR)}},shaka.cea.Cea608DataChannel.prototype.controlMidrow_=function(e){this.curbuf_.setUnderline(!1),this.curbuf_.setItalics(!1),this.curbuf_.setTextColor(shaka.cea.CeaUtils.DEFAULT_TXT_COLOR),this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,32);var t=!1,r=shaka.cea.Cea608DataChannel.TEXT_COLORS[(14&e)>>1];"white_italics"===r&&(r="white",t=!0),this.curbuf_.setUnderline(1==(1&e)),this.curbuf_.setItalics(t),this.curbuf_.setTextColor(r)},shaka.cea.Cea608DataChannel.prototype.controlBackgroundAttribute_=function(e,t){var r=shaka.cea.CeaUtils.DEFAULT_BG_COLOR;0==(7&e)&&(r=shaka.cea.Cea608DataChannel.BG_COLORS[(14&t)>>1]),this.curbuf_.setBackgroundColor(r)},shaka.cea.Cea608DataChannel.prototype.controlMiscellaneous_=function(e){var t=shaka.cea.Cea608DataChannel.MiscCmd_,r=e.pts,a=null;switch(e.ccData2){case t.RCL:this.controlRcl_();break;case t.BS:this.controlBs_();break;case t.RU2:a=this.controlRu_(2,r);break;case t.RU3:a=this.controlRu_(3,r);break;case t.RU4:a=this.controlRu_(4,r);break;case t.FON:this.controlFon_();break;case t.RDC:this.controlRdc_(r);break;case t.TR:this.controlTr_();break;case t.RTD:this.controlRtd_();break;case t.EDM:a=this.controlEdm_(r);break;case t.CR:a=this.controlCr_(r);break;case t.ENM:this.controlEnm_();break;case t.EOC:a=this.controlEoc_(r)}return a},shaka.cea.Cea608DataChannel.prototype.controlCr_=function(e){var t=this.curbuf_;if(this.type_!==shaka.cea.Cea608DataChannel.CaptionType.ROLLUP)return null;var r=t.forceEmit(this.prevEndTime_,e),a=t.getRow()-t.getScrollSize()+1;return t.moveRows(a-1,a,t.getScrollSize()),t.resetRows(0,a-1),t.resetRows(t.getRow(),shaka.cea.Cea608Memory.CC_ROWS-t.getRow()),this.prevEndTime_=e,r},shaka.cea.Cea608DataChannel.prototype.controlRu_=function(e,t){var r=this.curbuf_=this.displayedMemory_,a=null;return this.type_!==shaka.cea.Cea608DataChannel.CaptionType.ROLLUP&&this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT&&(a=r.forceEmit(this.prevEndTime_,t),this.displayedMemory_.eraseBuffer(),this.nonDisplayedMemory_.eraseBuffer(),r.setRow(shaka.cea.Cea608Memory.CC_ROWS)),this.type_=shaka.cea.Cea608DataChannel.CaptionType.ROLLUP,r.setScrollSize(e),a},shaka.cea.Cea608DataChannel.prototype.controlFon_=function(){this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,32)},shaka.cea.Cea608DataChannel.prototype.controlEdm_=function(e){var t=this.displayedMemory_,r=null;return this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT&&(r=t.forceEmit(this.prevEndTime_,e)),t.resetAllRows(),r},shaka.cea.Cea608DataChannel.prototype.controlRdc_=function(e){this.type_=shaka.cea.Cea608DataChannel.CaptionType.PAINTON,this.curbuf_=this.displayedMemory_,this.curbuf_.setScrollSize(0),this.prevEndTime_=e};shaka.cea.Cea608DataChannel.prototype.controlEnm_=function(){this.nonDisplayedMemory_.resetAllRows()},shaka.cea.Cea608DataChannel.prototype.controlEoc_=function(e){var t=null;this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT&&(t=this.displayedMemory_.forceEmit(this.prevEndTime_,e));var r=this.nonDisplayedMemory_;return this.nonDisplayedMemory_=this.displayedMemory_,this.displayedMemory_=r,this.controlRcl_(),this.prevEndTime_=e,t},shaka.cea.Cea608DataChannel.prototype.controlRcl_=function(){this.type_=shaka.cea.Cea608DataChannel.CaptionType.POPON,this.curbuf_=this.nonDisplayedMemory_,this.curbuf_.setScrollSize(0)},shaka.cea.Cea608DataChannel.prototype.controlBs_=function(){this.curbuf_.eraseChar()},shaka.cea.Cea608DataChannel.prototype.controlTr_=function(){this.text_.reset(),this.controlRtd_()},shaka.cea.Cea608DataChannel.prototype.controlRtd_=function(){shaka.log.warnOnce("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),this.curbuf_=this.text_,this.type_=shaka.cea.Cea608DataChannel.CaptionType.TEXT},shaka.cea.Cea608DataChannel.prototype.handleBasicNorthAmericanChar=function(e,t){this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,e),this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,t)},shaka.cea.Cea608DataChannel.prototype.handleExtendedWesternEuropeanChar_=function(e,t){this.curbuf_.addChar(1&e?shaka.cea.Cea608Memory.CharSet.PORTUGUESE_GERMAN:shaka.cea.Cea608Memory.CharSet.SPANISH_FRENCH,t)},shaka.cea.Cea608DataChannel.prototype.handleControlCode=function(e){var t=e.ccData1,r=e.ccData2;if(this.lastcp_===(t<<8|r))return this.lastcp_=null;if(this.lastcp_=t<<8|r,this.isPAC_(t,r))this.controlPac_(t,r);else if(this.isMidrowStyleChange_(t,r))this.controlMidrow_(r);else if(this.isBackgroundAttribute_(t,r))this.controlBackgroundAttribute_(t,r);else if(this.isSpecialNorthAmericanChar_(t,r))this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.SPECIAL_NORTH_AMERICAN,r);else if(this.isExtendedWesternEuropeanChar_(t,r))this.handleExtendedWesternEuropeanChar_(t,r);else if(this.isMiscellaneous_(t,r))return this.controlMiscellaneous_(e);return null},shaka.cea.Cea608DataChannel.prototype.isMiscellaneous_=function(e,t){return 20==(246&e)&&32==(240&t)},shaka.cea.Cea608DataChannel.prototype.isPAC_=function(e,t){return 16==(240&e)&&64==(192&t)},shaka.cea.Cea608DataChannel.prototype.isMidrowStyleChange_=function(e,t){return 17==(247&e)&&32==(240&t)},shaka.cea.Cea608DataChannel.prototype.isBackgroundAttribute_=function(e,t){return 16==(247&e)&&32==(240&t)||23==(247&e)&&45==(255&t)},shaka.cea.Cea608DataChannel.prototype.isSpecialNorthAmericanChar_=function(e,t){return 17==(247&e)&&48==(240&t)},shaka.cea.Cea608DataChannel.prototype.isExtendedWesternEuropeanChar_=function(e,t){return 18==(246&e)&&32==(224&t)},shaka.cea.Cea608DataChannel.isControlCode=function(e){return 16==(112&e)},shaka.cea.Cea608DataChannel.MiscCmd_={RCL:32,BS:33,AOD:34,AON:35,DER:36,RU2:37,RU3:38,RU4:39,FON:40,RDC:41,TR:42,RTD:43,EDM:44,CR:45,ENM:46,EOC:47},shaka.cea.Cea608DataChannel.CaptionType={NONE:0,POPON:1,PAINTON:2,ROLLUP:3,TEXT:4},shaka.cea.Cea608DataChannel.BG_COLORS="black green blue cyan red yellow magenta black".split(" "),shaka.cea.Cea608DataChannel.TEXT_COLORS="white green blue cyan red yellow magenta white_italics".split(" "),shaka.cea.Cea708Window=function(e){this.windowNum_=e,this.relativeToggle_=this.visible_=!1,this.colCount_=this.rowCount_=this.anchorId_=this.verticalAnchor_=this.horizontalAnchor_=0,this.justification_=shaka.cea.Cea708Window.TextJustification.CENTER,this.memory_=[],this.col_=this.row_=this.startTime_=0,this.underline_=this.italics_=!1,this.textColor_=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,this.backgroundColor_=shaka.cea.CeaUtils.DEFAULT_BG_COLOR,this.resetMemory(),shaka.util.Functional.ignored(this.verticalAnchor_,this.relativeToggle_,this.horizontalAnchor_,this.anchorId_,this.windowNum_)},shaka.cea.Cea708Window.prototype.defineWindow=function(e,t,r,a,n,i,o){this.visible_=e,this.verticalAnchor_=t,this.horizontalAnchor_=r,this.anchorId_=a,this.relativeToggle_=n,this.rowCount_=i,this.colCount_=o},shaka.cea.Cea708Window.prototype.resetMemory=function(){this.memory_=[];for(var e=0;e<shaka.cea.Cea708Window.MAX_ROWS;e++)this.memory_.push(this.createNewRow_())},shaka.cea.Cea708Window.prototype.createNewRow_=function(){for(var e=[],t=0;t<shaka.cea.Cea708Window.MAX_COLS;t++)e.push(null);return e},shaka.cea.Cea708Window.prototype.setCharacter=function(e){this.isPenInBounds_()&&(e=new shaka.cea.CeaUtils.StyledChar(e,this.underline_,this.italics_,this.backgroundColor_,this.textColor_),this.memory_[this.row_][this.col_]=e,this.col_++)},shaka.cea.Cea708Window.prototype.backspace=function(){!this.isPenInBounds_()||0>=this.col_&&0>=this.row_||(0>=this.col_?(this.col_=this.colCount_-1,this.row_--):this.col_--,this.memory_[this.row_][this.col_]=null)},shaka.cea.Cea708Window.prototype.isPenInBounds_=function(){var e=this.col_<this.colCount_&&0<=this.col_;return this.row_<this.rowCount_&&0<=this.row_&&e},shaka.cea.Cea708Window.prototype.isVisible=function(){return this.visible_},shaka.cea.Cea708Window.prototype.moveUpRows_=function(e){for(var t=0,r=e;r<shaka.cea.Cea708Window.MAX_ROWS;r++,t++)this.memory_[t]=this.memory_[r];for(r=0;r<e;r++,t++)this.memory_[t]=this.createNewRow_()},shaka.cea.Cea708Window.prototype.carriageReturn=function(){this.row_+1>=this.rowCount_?this.moveUpRows_(1):this.row_++,this.col_=0},shaka.cea.Cea708Window.prototype.horizontalCarriageReturn=function(){this.memory_[this.row_]=this.createNewRow_(),this.col_=0},shaka.cea.Cea708Window.prototype.forceEmit=function(e,t){t="svc"+t;var r=shaka.cea.Cea708Window.TextJustification,a=new shaka.text.Cue(this.startTime_,e,"");return a.textAlign=this.justification_===r.LEFT?shaka.text.Cue.textAlign.LEFT:this.justification_===r.RIGHT?shaka.text.Cue.textAlign.RIGHT:shaka.text.Cue.textAlign.CENTER,(t=shaka.cea.CeaUtils.getParsedCaption(a,t,this.memory_,this.startTime_,e))&&this.setStartTime(e),t},shaka.cea.Cea708Window.prototype.setPenLocation=function(e,t){this.row_=e,this.col_=t},shaka.cea.Cea708Window.prototype.setPenBackgroundColor=function(e){this.backgroundColor_=e},shaka.cea.Cea708Window.prototype.setPenTextColor=function(e){this.textColor_=e},shaka.cea.Cea708Window.prototype.setPenUnderline=function(e){this.underline_=e},shaka.cea.Cea708Window.prototype.setPenItalics=function(e){this.italics_=e},shaka.cea.Cea708Window.prototype.resetPen=function(){this.col_=this.row_=0,this.italics_=this.underline_=!1,this.textColor_=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,this.backgroundColor_=shaka.cea.CeaUtils.DEFAULT_BG_COLOR},shaka.cea.Cea708Window.prototype.setJustification=function(e){this.justification_=e},shaka.cea.Cea708Window.prototype.display=function(){this.visible_=!0},shaka.cea.Cea708Window.prototype.hide=function(){this.visible_=!1},shaka.cea.Cea708Window.prototype.toggle=function(){this.visible_=!this.visible_},shaka.cea.Cea708Window.prototype.setStartTime=function(e){this.startTime_=e},shaka.cea.Cea708Window.TextJustification={LEFT:0,RIGHT:1,CENTER:2,FULL:3},shaka.cea.Cea708Window.MAX_COLS=42,shaka.cea.Cea708Window.MAX_ROWS=16,shaka.cea.DtvccPacketBuilder=function(){this.builtPackets_=[],this.currentPacketBeingBuilt_=null,this.bytesLeftToAddInCurrentPacket_=0},shaka.cea.DtvccPacketBuilder.prototype.addByte=function(e){e.type===shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_START?(this.bytesLeftToAddInCurrentPacket_=2*(63&e.value)-1,this.currentPacketBeingBuilt_=[]):this.currentPacketBeingBuilt_&&(0<this.bytesLeftToAddInCurrentPacket_&&(this.currentPacketBeingBuilt_.push(e),this.bytesLeftToAddInCurrentPacket_--),0===this.bytesLeftToAddInCurrentPacket_&&(e=new shaka.cea.DtvccPacket(this.currentPacketBeingBuilt_),this.builtPackets_.push(e),this.currentPacketBeingBuilt_=null,this.bytesLeftToAddInCurrentPacket_=0))},shaka.cea.DtvccPacketBuilder.prototype.getBuiltPackets=function(){return this.builtPackets_},shaka.cea.DtvccPacketBuilder.prototype.clearBuiltPackets=function(){this.builtPackets_=[]},shaka.cea.DtvccPacketBuilder.prototype.clear=function(){this.builtPackets_=[],this.currentPacketBeingBuilt_=[],this.bytesLeftToAddInCurrentPacket_=0},shaka.cea.DtvccPacket=function(e){this.pos_=0,this.packetData_=e},shaka.cea.DtvccPacket.prototype.hasMoreData=function(){return this.pos_<this.packetData_.length},shaka.cea.DtvccPacket.prototype.getPosition=function(){return this.pos_},shaka.cea.DtvccPacket.prototype.readByte=function(){if(!this.hasMoreData())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS);return this.packetData_[this.pos_++]},shaka.cea.DtvccPacket.prototype.skip=function(e){if(this.pos_+e>this.packetData_.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS);this.pos_+=e},shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_DATA=2,shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_START=3,shaka.cea.Cea708Service=function(e){this.serviceNumber_=e,this.windows_=[null,null,null,null,null,null,null,null],this.currentWindow_=null},shaka.cea.Cea708Service.prototype.handleCea708ControlCode=function(e){var t=e.readByte(),r=t.value;(t=t.pts,r===shaka.cea.Cea708Service.EXT_CEA708_CTRL_CODE_BYTE1)&&(r=r<<16|e.readByte().value);return 0<=r&&31>=r?this.handleC0_(r,t):128<=r&&159>=r?this.handleC1_(e,r,t):(4096<=r&&4127>=r?this.handleC2_(e,255&r):4224<=r&&4255>=r?this.handleC3_(e,255&r):32<=r&&127>=r?this.handleG0_(r):160<=r&&255>=r?this.handleG1_(r):4128<=r&&4223>=r?this.handleG2_(255&r):4256<=r&&4351>=r&&this.handleG3_(255&r),null)},shaka.cea.Cea708Service.prototype.handleG0_=function(e){this.currentWindow_&&(127===e?this.currentWindow_.setCharacter("♪"):this.currentWindow_.setCharacter(String.fromCharCode(e)))},shaka.cea.Cea708Service.prototype.handleG1_=function(e){this.currentWindow_&&this.currentWindow_.setCharacter(String.fromCharCode(e))},shaka.cea.Cea708Service.prototype.handleG2_=function(e){this.currentWindow_&&(shaka.cea.Cea708Service.G2Charset.has(e)?(e=shaka.cea.Cea708Service.G2Charset.get(e),this.currentWindow_.setCharacter(e)):this.currentWindow_.setCharacter("_"))},shaka.cea.Cea708Service.prototype.handleG3_=function(e){this.currentWindow_&&(160!=e?this.currentWindow_.setCharacter("_"):this.currentWindow_.setCharacter("[CC]"))},shaka.cea.Cea708Service.prototype.handleC0_=function(e,t){if(!this.currentWindow_)return null;var r=this.currentWindow_,a=null;switch(e){case shaka.cea.Cea708Service.ASCII_BACKSPACE:r.backspace();break;case shaka.cea.Cea708Service.ASCII_CARRIAGE_RETURN:r.isVisible()&&(a=r.forceEmit(t,this.serviceNumber_)),r.carriageReturn();break;case shaka.cea.Cea708Service.ASCII_HOR_CARRIAGE_RETURN:r.isVisible()&&(a=r.forceEmit(t,this.serviceNumber_)),r.horizontalCarriageReturn();break;case shaka.cea.Cea708Service.ASCII_FORM_FEED:r.isVisible()&&(a=r.forceEmit(t,this.serviceNumber_)),r.resetMemory(),r.setPenLocation(0,0)}return a},shaka.cea.Cea708Service.prototype.handleC1_=function(e,t,r){if(128<=t&&135>=t)this.setCurrentWindow_(7&t);else{if(136===t)return e=e.readByte().value,this.clearWindows_(e,r);if(137===t)e=e.readByte().value,this.displayWindows_(e,r);else{if(138===t)return e=e.readByte().value,this.hideWindows_(e,r);if(139===t)return e=e.readByte().value,this.toggleWindows_(e,r);if(140===t)return e=e.readByte().value,this.deleteWindows_(e,r);if(143===t)return this.reset_(r);144===t?this.setPenAttributes_(e):145===t?this.setPenColor_(e):146===t?this.setPenLocation_(e):151===t?this.setWindowAttributes_(e):152<=t&&159>=t&&this.defineWindow_(e,(15&t)-8,r)}}return null},shaka.cea.Cea708Service.prototype.handleC2_=function(e,t){8<=t&&15>=t?e.skip(1):16<=t&&23>=t?e.skip(2):24<=t&&31>=t&&e.skip(3)},shaka.cea.Cea708Service.prototype.handleC3_=function(e,t){128<=t&&135>=t?e.skip(4):136<=t&&143>=t&&e.skip(5)},shaka.cea.Cea708Service.prototype.setCurrentWindow_=function(e){this.windows_[e]&&(this.currentWindow_=this.windows_[e])},shaka.cea.Cea708Service.prototype.getSpecifiedWindowIds_=function(e){for(var t=[],r=0;8>r;r++)1==(1&e)&&this.windows_[r]&&t.push(r),e>>=1;return t},shaka.cea.Cea708Service.prototype.clearWindows_=function(e,t){for(var r=null,a=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!a.done;a=e.next())(a=this.windows_[a.value]).isVisible()&&(r=a.forceEmit(t,this.serviceNumber_)),a.resetMemory();return r},shaka.cea.Cea708Service.prototype.displayWindows_=function(e,t){for(var r=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!r.done;r=e.next())(r=this.windows_[r.value]).isVisible()||r.setStartTime(t),r.display()},shaka.cea.Cea708Service.prototype.hideWindows_=function(e,t){for(var r=null,a=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!a.done;a=e.next())(a=this.windows_[a.value]).isVisible()&&(r=a.forceEmit(t,this.serviceNumber_)),a.hide();return r},shaka.cea.Cea708Service.prototype.toggleWindows_=function(e,t){for(var r=null,a=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!a.done;a=e.next())(a=this.windows_[a.value]).isVisible()?r=a.forceEmit(t,this.serviceNumber_):a.setStartTime(t),a.toggle();return r},shaka.cea.Cea708Service.prototype.deleteWindows_=function(e,t){for(var r=null,a=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!a.done;a=e.next()){a=a.value;var n=this.windows_[a];n.isVisible()&&(r=n.forceEmit(t,this.serviceNumber_)),this.windows_[a]=null}return r},shaka.cea.Cea708Service.prototype.reset_=function(e){return e=this.deleteWindows_(255,e),this.clear(),e},shaka.cea.Cea708Service.prototype.clear=function(){this.currentWindow_=null,this.windows_=[null,null,null,null,null,null,null,null]},shaka.cea.Cea708Service.prototype.setPenAttributes_=function(e){if(e.skip(1),e=e.readByte().value,this.currentWindow_){var t=0<(64&e);this.currentWindow_.setPenItalics(0<(128&e)),this.currentWindow_.setPenUnderline(t)}},shaka.cea.Cea708Service.prototype.setPenColor_=function(e){var t=e.readByte().value,r=e.readByte().value;if(e.skip(1),this.currentWindow_){e=3&r;var a=(12&r)>>2;r=(48&r)>>4,t=this.rgbColorToHex_((48&t)>>4,(12&t)>>2,3&t),e=this.rgbColorToHex_(r,a,e),this.currentWindow_.setPenTextColor(t),this.currentWindow_.setPenBackgroundColor(e)}},shaka.cea.Cea708Service.prototype.setPenLocation_=function(e){var t=e.readByte().value;e=e.readByte().value,this.currentWindow_&&this.currentWindow_.setPenLocation(15&t,63&e)},shaka.cea.Cea708Service.prototype.setWindowAttributes_=function(e){e.skip(1),e.skip(1);var t=e.readByte().value;e.skip(1),this.currentWindow_&&this.currentWindow_.setJustification(3&t)},shaka.cea.Cea708Service.prototype.defineWindow_=function(e,t,r){var a=null!==this.windows_[t];if(!a){var n=new shaka.cea.Cea708Window(t);n.setStartTime(r),this.windows_[t]=n}var i=e.readByte().value,o=e.readByte().value;r=e.readByte().value;var s=e.readByte().value;n=e.readByte().value,e=e.readByte().value,i=0<(32&i);var l=127&o;o=0<(128&o);var u=1+(15&s);s=(240&s)>>4,n=1+(63&n),a&&0==(7&e)||this.windows_[t].resetPen(),this.windows_[t].defineWindow(i,l,r,s,o,u,n),this.currentWindow_=this.windows_[t]},shaka.cea.Cea708Service.prototype.rgbColorToHex_=function(e,t,r){var a={0:0,1:0,2:1,3:1};return e=a[e],t=a[t],r=a[r],shaka.cea.Cea708Service.Colors[e<<2|t<<1|r]},shaka.cea.Cea708Service.ASCII_BACKSPACE=8,shaka.cea.Cea708Service.ASCII_FORM_FEED=12,shaka.cea.Cea708Service.ASCII_CARRIAGE_RETURN=13,shaka.cea.Cea708Service.ASCII_HOR_CARRIAGE_RETURN=14,shaka.cea.Cea708Service.EXT_CEA708_CTRL_CODE_BYTE1=16,shaka.cea.Cea708Service.G2Charset=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),shaka.cea.Cea708Service.Colors="black blue green cyan red magenta yellow white".split(" "),shaka.cea.CeaDecoder=function(){this.cea608DataArray_=[],this.cea708DataArray_=[],this.dtvccPacketBuilder_=new shaka.cea.DtvccPacketBuilder,this.badFrames_=0,this.cea608ModeToStream_=new Map([["CC1",new shaka.cea.Cea608DataChannel(0,0)],["CC2",new shaka.cea.Cea608DataChannel(0,1)],["CC3",new shaka.cea.Cea608DataChannel(1,0)],["CC4",new shaka.cea.Cea608DataChannel(1,1)]]),this.currentField2Channel_=this.currentField1Channel_=0,this.serviceNumberToService_=new Map,this.reset()},shaka.cea.CeaDecoder.prototype.clear=function(){this.badFrames_=0,this.cea608DataArray_=[],this.cea708DataArray_=[],this.dtvccPacketBuilder_.clear(),this.reset();for(var e=$jscomp.makeIterator(this.serviceNumberToService_.values()),t=e.next();!t.done;t=e.next())t.value.clear()},shaka.cea.CeaDecoder.prototype.reset=function(){this.currentField2Channel_=this.currentField1Channel_=0;for(var e=$jscomp.makeIterator(this.cea608ModeToStream_.values()),t=e.next();!t.done;t=e.next())t.value.reset()},shaka.cea.CeaDecoder.prototype.extract=function(e,t){if((e=new shaka.util.DataViewReader(e,shaka.util.DataViewReader.Endianness.BIG_ENDIAN)).readUint8()===shaka.cea.CeaDecoder.USA_COUNTRY_CODE&&e.readUint16()===shaka.cea.CeaDecoder.ATSC_PROVIDER_CODE&&e.readUint32()===shaka.cea.CeaDecoder.ATSC1_USER_IDENTIFIER&&3===e.readUint8()){var r=e.readUint8();if(0!=(64&r)){r&=31,e.skip(1);for(var a=0;a<r;a++){var n=e.readUint8(),i=(4&n)>>2,o=e.readUint8(),s=e.readUint8();i&&((n&=3)===shaka.cea.CeaDecoder.NTSC_CC_FIELD_1||n===shaka.cea.CeaDecoder.NTSC_CC_FIELD_2?this.cea608DataArray_.push({pts:t,type:n,ccData1:o,ccData2:s,order:this.cea608DataArray_.length}):(this.cea708DataArray_.push({pts:t,type:n,value:o,order:this.cea708DataArray_.length}),this.cea708DataArray_.push({pts:t,type:shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_DATA,value:s,order:this.cea708DataArray_.length})))}}}},shaka.cea.CeaDecoder.prototype.decode=function(){var e=[],t=function(e,t){return e.pts-t.pts||e.order-t.order};this.cea608DataArray_.sort(t),this.cea708DataArray_.sort(t);for(var r=(t=$jscomp.makeIterator(this.cea608DataArray_)).next();!r.done;r=t.next())(r=this.decodeCea608_(r.value))&&e.push(r);for(r=(t=$jscomp.makeIterator(this.cea708DataArray_)).next();!r.done;r=t.next())this.dtvccPacketBuilder_.addByte(r.value);for(t=this.dtvccPacketBuilder_.getBuiltPackets(),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=this.decodeCea708_(r.value),e.push.apply(e,$jscomp.arrayFromIterable(r));return this.dtvccPacketBuilder_.clearBuiltPackets(),this.cea608DataArray_=[],this.cea708DataArray_=[],e},shaka.cea.CeaDecoder.prototype.decodeCea608_=function(e){var t=e.type;if(shaka.cea.Cea608DataChannel.isControlCode(e.ccData1)){var r=e.ccData1>>3&1;0===t?this.currentField1Channel_=r:this.currentField2Channel_=r}return t=this.cea608ModeToStream_.get("CC"+(t<<1|(t?this.currentField2Channel_:this.currentField1Channel_)+1)),255===e.ccData1&&255===e.ccData2||!e.ccData1&&!e.ccData2||!this.isOddParity_(e.ccData1)||!this.isOddParity_(e.ccData2)?(45<=++this.badFrames_&&this.reset(),null):(this.badFrames_=0,e.ccData1&=127,e.ccData2&=127,e.ccData1||e.ccData2?(r=null,shaka.cea.Cea608DataChannel.isControlCode(e.ccData1)?r=t.handleControlCode(e):t.handleBasicNorthAmericanChar(e.ccData1,e.ccData2),r):null)},shaka.cea.CeaDecoder.prototype.decodeCea708_=function(e){var t=[];try{for(;e.hasMoreData();){var r=e.readByte().value,a=(224&r)>>5,n=31&r;if(7===a&&0!=n&&(a=63&e.readByte().value),0!=a){if(!this.serviceNumberToService_.has(a)){var i=new shaka.cea.Cea708Service(a);this.serviceNumberToService_.set(a,i)}for(var o=this.serviceNumberToService_.get(a),s=e.getPosition();e.getPosition()-s<n;){var l=o.handleCea708ControlCode(e);l&&t.push(l)}}}}catch(e){if(!(e instanceof shaka.util.Error&&e.code===shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS))throw e;shaka.log.warnOnce("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return t},shaka.cea.CeaDecoder.prototype.isOddParity_=function(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t},shaka.cea.CeaDecoder.ATSC_PROVIDER_CODE=49,shaka.cea.CeaDecoder.ATSC1_USER_IDENTIFIER=1195456820,shaka.cea.CeaDecoder.NTSC_CC_FIELD_1=0,shaka.cea.CeaDecoder.NTSC_CC_FIELD_2=1,shaka.cea.CeaDecoder.USA_COUNTRY_CODE=181,shaka.cea.ICeaParser=function(){},shaka.cea.ICeaParser.prototype.init=function(e){},shaka.cea.ICeaParser.prototype.parse=function(e){},shaka.cea.ICeaParser.H264_NALU_TYPE_SEI=6,shaka.cea.ICeaParser.H265_PREFIX_NALU_TYPE_SEI=39,shaka.cea.ICeaParser.H265_SUFFIX_NALU_TYPE_SEI=40,shaka.cea.ICeaParser.DEFAULT_TIMESCALE_VALUE=9e4,shaka.cea.DummyCeaParser=function(){},shaka.cea.DummyCeaParser.prototype.init=function(e){},shaka.cea.DummyCeaParser.prototype.parse=function(e){return[]},shaka.cea.SeiProcessor=function(){},shaka.cea.SeiProcessor.prototype.process=function(e){var t=[];e=this.removeEmu(e);for(var r=0;r<e.length;){for(var a=0;255==e[r];)a+=255,r++;a+=e[r++];for(var n=0;255==e[r];)n+=255,r++;n+=e[r++],4==a&&t.push(e.subarray(r,r+n)),r+=n}return t},shaka.cea.SeiProcessor.prototype.removeEmu=function(e){for(var t=e,r=e=0;r<t.length;)2==e&&3==t[r]?(e=0,(t=[].concat($jscomp.arrayFromIterable(t))).splice(r,1),t=new Uint8Array(t)):0==t[r]?e++:e=0,r++;return t},shaka.util.Mp4BoxParsers=function(){},shaka.util.Mp4BoxParsers.parseTFHD=function(e,t){var r=null,a=null,n=null,i=e.readUint32();return 1&t&&(n=e.readUint64()),2&t&&e.skip(4),8&t&&(r=e.readUint32()),16&t&&(a=e.readUint32()),{trackId:i,defaultSampleDuration:r,defaultSampleSize:a,baseDataOffset:n}},shaka.util.Mp4BoxParsers.parseTFDT=function(e,t){return{baseMediaDecodeTime:1==t?e.readUint64():e.readUint32()}},shaka.util.Mp4BoxParsers.parseMDHD=function(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),{timescale:e.readUint32()}},shaka.util.Mp4BoxParsers.parseTREX=function(e){return e.skip(4),e.skip(4),{defaultSampleDuration:e.readUint32(),defaultSampleSize:e=e.readUint32()}},shaka.util.Mp4BoxParsers.parseTRUN=function(e,t,r){var a=e.readUint32(),n=[],i=null;1&r&&(i=e.readUint32()),4&r&&e.skip(4);for(var o=0;o<a;o++){var s={sampleDuration:null,sampleSize:null,sampleCompositionTimeOffset:null};256&r&&(s.sampleDuration=e.readUint32()),512&r&&(s.sampleSize=e.readUint32()),1024&r&&e.skip(4),2048&r&&(s.sampleCompositionTimeOffset=0==t?e.readUint32():e.readInt32()),n.push(s)}return{sampleCount:a,sampleData:n,dataOffset:i}},shaka.util.Mp4BoxParsers.parseTKHD=function(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),{trackId:e.readUint32()}},shaka.util.Mp4BoxParsers.parseFRMA=function(e){return e=e.readUint32(),{codec:shaka.util.Mp4Parser.typeToString(e)}},shaka.cea.Mp4CeaParser=function(){this.seiProcessor_=new shaka.cea.SeiProcessor,this.trackIdToTimescale_=new Map,this.defaultSampleSize_=this.defaultSampleDuration_=0,this.bitstreamFormat_=shaka.cea.Mp4CeaParser.BitstreamFormat.UNKNOWN},shaka.cea.Mp4CeaParser.prototype.init=function(e){var t=this,r=shaka.util.Mp4Parser,a=shaka.cea.Mp4CeaParser.BitstreamFormat,n=[],i=[],o=function(e){return t.setBitstreamFormat_(e.name)};if((new r).box("moov",r.children).box("mvex",r.children).fullBox("trex",(function(e){e=shaka.util.Mp4BoxParsers.parseTREX(e.reader),t.defaultSampleDuration_=e.defaultSampleDuration,t.defaultSampleSize_=e.defaultSampleSize})).box("trak",r.children).fullBox("tkhd",(function(e){goog.asserts.assert(null!=e.version,"TKHD is a full box and should have a valid version."),e=shaka.util.Mp4BoxParsers.parseTKHD(e.reader,e.version),n.push(e.trackId)})).box("mdia",r.children).fullBox("mdhd",(function(e){goog.asserts.assert(null!=e.version,"MDHD is a full box and should have a valid version."),e=shaka.util.Mp4BoxParsers.parseMDHD(e.reader,e.version),i.push(e.timescale)})).box("minf",r.children).box("stbl",r.children).fullBox("stsd",r.sampleDescription).box("avc1",o).box("avc3",o).box("hev1",o).box("hvc1",o).box("dvh1",o).box("dvhe",o).box("encv",r.visualSampleEntry).box("sinf",r.children).box("frma",(function(e){e=shaka.util.Mp4BoxParsers.parseFRMA(e.reader).codec,t.setBitstreamFormat_(e)})).parse(e,!0),!n.length||!i.length||n.length!=i.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_CEA);this.bitstreamFormat_==a.UNKNOWN&&shaka.log.alwaysWarn("Unable to determine bitstream format for CEA parsing!"),n.forEach((function(e,r){t.trackIdToTimescale_.set(e,i[r])}))},shaka.cea.Mp4CeaParser.prototype.parse=function(e){var t=this,r=shaka.util.Mp4Parser;if(this.bitstreamFormat_==shaka.cea.Mp4CeaParser.BitstreamFormat.UNKNOWN)return[];var a=[],n=this.defaultSampleDuration_,i=this.defaultSampleSize_,o=[],s=null,l=null,u=null,c=shaka.cea.ICeaParser.DEFAULT_TIMESCALE_VALUE;return(new r).box("moof",(function(e){s=e.start,r.children(e)})).box("traf",r.children).fullBox("trun",(function(e){goog.asserts.assert(null!=e.version&&null!=e.flags,"TRUN is a full box and should have a valid version & flags."),e=shaka.util.Mp4BoxParsers.parseTRUN(e.reader,e.version,e.flags),o=e.sampleData,l=e.dataOffset})).fullBox("tfhd",(function(e){goog.asserts.assert(null!=e.flags,"TFHD is a full box and should have valid flags."),e=shaka.util.Mp4BoxParsers.parseTFHD(e.reader,e.flags),n=e.defaultSampleDuration||t.defaultSampleDuration_,i=e.defaultSampleSize||t.defaultSampleSize_,e=e.trackId,t.trackIdToTimescale_.has(e)&&(c=t.trackIdToTimescale_.get(e))})).fullBox("tfdt",(function(e){goog.asserts.assert(null!=e.version,"TFDT is a full box and should have a valid version."),u=shaka.util.Mp4BoxParsers.parseTFDT(e.reader,e.version).baseMediaDecodeTime})).box("mdat",(function(e){if(null===u)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_CEA);t.parseMdat_(e.reader,u,c,n,i,(s||0)+(l||0)-e.start-8,o,a)})).parse(e,!1),a},shaka.cea.Mp4CeaParser.prototype.parseMdat_=function(e,t,r,a,n,i,o,s){var l=shaka.cea.Mp4CeaParser.BitstreamFormat,u=shaka.cea.ICeaParser,c=0,d=n;for(o.length&&(d=o[0].sampleSize||n),e.skip(i);e.hasMoreData();){i=e.readUint32();var p=e.readUint8();switch(goog.asserts.assert(this.bitstreamFormat_!=l.UNKNOWN,"Bitstream format should have been checked before now!"),this.bitstreamFormat_){case l.H264:p=(p&=31)==u.H264_NALU_TYPE_SEI;break;case l.H265:p=(p=p>>1&63)==u.H265_PREFIX_NALU_TYPE_SEI||p==u.H265_SUFFIX_NALU_TYPE_SEI;break;default:return}if(p){p=0,o.length>c&&(p=o[c].sampleCompositionTimeOffset||0),p=(t+p)/r;for(var h=$jscomp.makeIterator(this.seiProcessor_.process(e.readBytes(i-1))),f=h.next();!f.done;f=h.next())s.push({packet:f.value,pts:p})}else try{e.skip(i-1)}catch(e){break}0==(d-=i+4)&&(t=o.length>c?t+(o[c].sampleDuration||a):t+a,c++,d=o.length>c&&o[c].sampleSize||n)}},shaka.cea.Mp4CeaParser.prototype.setBitstreamFormat_=function(e){e in shaka.cea.Mp4CeaParser.CodecBitstreamMap_&&(this.bitstreamFormat_=shaka.cea.Mp4CeaParser.CodecBitstreamMap_[e])},shaka.cea.Mp4CeaParser.BitstreamFormat={UNKNOWN:0,H264:1,H265:2},shaka.cea.Mp4CeaParser.CodecBitstreamMap_={avc1:shaka.cea.Mp4CeaParser.BitstreamFormat.H264,avc3:shaka.cea.Mp4CeaParser.BitstreamFormat.H264,hev1:shaka.cea.Mp4CeaParser.BitstreamFormat.H265,hvc1:shaka.cea.Mp4CeaParser.BitstreamFormat.H265,dvh1:shaka.cea.Mp4CeaParser.BitstreamFormat.H265,dvhe:shaka.cea.Mp4CeaParser.BitstreamFormat.H265},shaka.media.IClosedCaptionParser=function(){},shaka.media.IClosedCaptionParser.prototype.init=function(e){},shaka.media.IClosedCaptionParser.prototype.parseFrom=function(e){},shaka.media.IClosedCaptionParser.prototype.reset=function(){},shaka.media.ClosedCaptionParser=function(e){this.ceaParser_=new shaka.cea.DummyCeaParser,e.includes("video/mp4")&&(this.ceaParser_=new shaka.cea.Mp4CeaParser),this.ceaDecoder_=new shaka.cea.CeaDecoder},shaka.media.ClosedCaptionParser.prototype.init=function(e){this.ceaParser_.init(e)},shaka.media.ClosedCaptionParser.prototype.parseFrom=function(e){e=this.ceaParser_.parse(e);for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){t=t.value;var r=shaka.util.BufferUtils.toUint8(t.packet);0<r.length&&this.ceaDecoder_.extract(r,t.pts)}return this.ceaDecoder_.decode()},shaka.media.ClosedCaptionParser.prototype.reset=function(){this.ceaDecoder_.clear()},shaka.media.InitSegmentReference=function(e,t,r,a,n){this.getUris=e,this.startByte=t,this.endByte=r,this.mediaQuality=void 0===a?null:a,this.timescale=n},shaka.media.InitSegmentReference.prototype.getStartByte=function(){return this.startByte},shaka.media.InitSegmentReference.prototype.getEndByte=function(){return this.endByte},shaka.media.InitSegmentReference.prototype.getSize=function(){return this.endByte?this.endByte-this.startByte:null},shaka.media.InitSegmentReference.prototype.getMediaQuality=function(){return this.mediaQuality},shaka.media.InitSegmentReference.equal=function(e,t){var r=shaka.util.ArrayUtils;return e&&t?e.getStartByte()==t.getStartByte()&&e.getEndByte()==t.getEndByte()&&r.equal(e.getUris(),t.getUris()):e==t},goog.exportSymbol("shaka.media.InitSegmentReference",shaka.media.InitSegmentReference),goog.exportProperty(shaka.media.InitSegmentReference.prototype,"getEndByte",shaka.media.InitSegmentReference.prototype.getEndByte),goog.exportProperty(shaka.media.InitSegmentReference.prototype,"getStartByte",shaka.media.InitSegmentReference.prototype.getStartByte),shaka.media.SegmentReference=function(e,t,r,a,n,i,o,s,l,u,c,d,p,h,f){u=void 0===u?[]:u,c=void 0===c?"":c,d=void 0===d?null:d,p=void 0===p?null:p,h=void 0===h?shaka.media.SegmentReference.Status.AVAILABLE:h,f=void 0===f?null:f,goog.asserts.assert(e<=t,"startTime must be less than or equal to endTime"),goog.asserts.assert(null==n||a<n,"startByte must be < endByte"),this.startTime=e,this.trueEndTime=this.endTime=t,this.getUrisInner=r,this.startByte=a,this.endByte=n,this.initSegmentReference=i,this.timestampOffset=o,this.appendWindowStart=s,this.appendWindowEnd=l,this.partialReferences=u,this.tilesLayout=c,this.tileDuration=d,this.syncTime=p,this.status=h,this.hlsAes128Key=f,this.thumbnailSprite=null,this.discontinuitySequence=0},shaka.media.SegmentReference.prototype.getUris=function(){return this.getUrisInner()},shaka.media.SegmentReference.prototype.getStartTime=function(){return this.startTime},shaka.media.SegmentReference.prototype.getEndTime=function(){return this.endTime},shaka.media.SegmentReference.prototype.getStartByte=function(){return this.startByte},shaka.media.SegmentReference.prototype.getEndByte=function(){return this.endByte},shaka.media.SegmentReference.prototype.getSize=function(){return this.endByte?this.endByte-this.startByte:null},shaka.media.SegmentReference.prototype.hasPartialSegments=function(){return 0<this.partialReferences.length},shaka.media.SegmentReference.prototype.getTilesLayout=function(){return this.tilesLayout},shaka.media.SegmentReference.prototype.getTileDuration=function(){return this.tileDuration},shaka.media.SegmentReference.prototype.getStatus=function(){return this.status},shaka.media.SegmentReference.prototype.markAsUnavailable=function(){this.status=shaka.media.SegmentReference.Status.UNAVAILABLE},shaka.media.SegmentReference.prototype.setThumbnailSprite=function(e){this.thumbnailSprite=e},shaka.media.SegmentReference.prototype.getThumbnailSprite=function(){return this.thumbnailSprite},shaka.media.SegmentReference.prototype.offset=function(e){this.startTime+=e,this.endTime+=e,this.trueEndTime+=e;for(var t=$jscomp.makeIterator(this.partialReferences),r=t.next();!r.done;r=t.next())(r=r.value).startTime+=e,r.endTime+=e,r.trueEndTime+=e},shaka.media.SegmentReference.prototype.syncAgainst=function(e){null==this.syncTime?shaka.log.alwaysError("Sync attempted without sync time!"):(e=this.syncTime-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},goog.exportSymbol("shaka.media.SegmentReference",shaka.media.SegmentReference),goog.exportProperty(shaka.media.SegmentReference.prototype,"syncAgainst",shaka.media.SegmentReference.prototype.syncAgainst),goog.exportProperty(shaka.media.SegmentReference.prototype,"offset",shaka.media.SegmentReference.prototype.offset),goog.exportProperty(shaka.media.SegmentReference.prototype,"getThumbnailSprite",shaka.media.SegmentReference.prototype.getThumbnailSprite),goog.exportProperty(shaka.media.SegmentReference.prototype,"setThumbnailSprite",shaka.media.SegmentReference.prototype.setThumbnailSprite),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsUnavailable",shaka.media.SegmentReference.prototype.markAsUnavailable),goog.exportProperty(shaka.media.SegmentReference.prototype,"getStatus",shaka.media.SegmentReference.prototype.getStatus),goog.exportProperty(shaka.media.SegmentReference.prototype,"getTileDuration",shaka.media.SegmentReference.prototype.getTileDuration),goog.exportProperty(shaka.media.SegmentReference.prototype,"getTilesLayout",shaka.media.SegmentReference.prototype.getTilesLayout),goog.exportProperty(shaka.media.SegmentReference.prototype,"getEndByte",shaka.media.SegmentReference.prototype.getEndByte),goog.exportProperty(shaka.media.SegmentReference.prototype,"getStartByte",shaka.media.SegmentReference.prototype.getStartByte),goog.exportProperty(shaka.media.SegmentReference.prototype,"getEndTime",shaka.media.SegmentReference.prototype.getEndTime),goog.exportProperty(shaka.media.SegmentReference.prototype,"getStartTime",shaka.media.SegmentReference.prototype.getStartTime),goog.exportProperty(shaka.media.SegmentReference.prototype,"getUris",shaka.media.SegmentReference.prototype.getUris),shaka.media.SegmentReference.Status={AVAILABLE:0,UNAVAILABLE:1,MISSING:2},goog.exportProperty(shaka.media.SegmentReference,"Status",shaka.media.SegmentReference.Status),shaka.media.TimeRangesUtils=function(){},shaka.media.TimeRangesUtils.bufferStart=function(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:1==e.length&&0>e.start(0)?0:e.length?e.start(0):null},shaka.media.TimeRangesUtils.bufferEnd=function(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null},shaka.media.TimeRangesUtils.isBuffered=function(e,t){return!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t>=e.start(0)},shaka.media.TimeRangesUtils.bufferedAheadOf=function(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var r=0,a=(e=$jscomp.makeIterator(shaka.media.TimeRangesUtils.getBufferedInfo(e))).next();!a.done;a=e.next()){var n=a.value;a=n.start,(n=n.end)>t&&(r+=n-Math.max(a,t))}return r},shaka.media.TimeRangesUtils.getGapIndex=function(e,t,r){var a=shaka.media.TimeRangesUtils;return!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)?null:0<=(e=a.getBufferedInfo(e).findIndex((function(e,a,n){return e.start>t&&(0==a||n[a-1].end-t<=r)})))?e:null},shaka.media.TimeRangesUtils.getBufferedInfo=function(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t},shaka.media.TimeRangesUtils.computeAddedRange=function(e,t){var r=shaka.media.TimeRangesUtils;if(!e||!e.length)return null;if(!t||!t.length)return r.getBufferedInfo(t).pop();for(t=r.getBufferedInfo(t).reverse(),e=r.getBufferedInfo(e).reverse(),t=(r=$jscomp.makeIterator(t)).next();!t.done;t=r.next()){t=t.value;for(var a=!1,n=$jscomp.makeIterator(e),i=n.next();!i.done;i=n.next())if((i=i.value).end>=t.start&&i.end<=t.end&&(a=!0,t.end>i.end))return{start:i.end,end:t.end};if(!a)return t}return null},
/*
 @license
 Shaka Player
 Copyright 2022 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
shaka.util.Id3Utils=function(){},shaka.util.Id3Utils.isHeader_=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]},shaka.util.Id3Utils.isFooter_=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]},shaka.util.Id3Utils.readSize_=function(e,t){var r=(127&e[t])<<21;return r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]},shaka.util.Id3Utils.getFrameData_=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=shaka.util.Id3Utils.readSize_(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}},shaka.util.Id3Utils.decodeFrame_=function(e){var t=shaka.util.BufferUtils,r=shaka.util.StringUtils,a={key:e.type,description:"",data:""};if("TXXX"===e.type){if(2>e.size)return null;if(e.data[0]!==shaka.util.Id3Utils.UTF8_encoding)return shaka.log.warning("Ignore frame with unrecognized character encoding"),null;var n=e.data.subarray(1).indexOf(0);if(-1===n)return null;var i=r.fromUTF8(t.toUint8(e.data,1,n));return e=r.fromUTF8(t.toUint8(e.data,2+n)).replace(/\0*$/,""),a.description=i,a.data=e,a}return"WXXX"===e.type?2>e.size?null:e.data[0]!==shaka.util.Id3Utils.UTF8_encoding?(shaka.log.warning("Ignore frame with unrecognized character encoding"),null):-1===(n=e.data.subarray(1).indexOf(0))?null:(i=r.fromUTF8(t.toUint8(e.data,1,n)),e=r.fromUTF8(t.toUint8(e.data,2+n)).replace(/\0*$/,""),a.description=i,a.data=e,a):"PRIV"===e.type?2>e.size||-1===(i=e.data.indexOf(0))?null:(r=r.fromUTF8(t.toUint8(e.data,0,i)),e=t.toArrayBuffer(e.data.subarray(r.length+1)),a.description=r,a.data=e,a):"T"===e.type[0]?2>e.size?null:e.data[0]!==shaka.util.Id3Utils.UTF8_encoding?(shaka.log.warning("Ignore frame with unrecognized character encoding"),null):(e=r.fromUTF8(e.data.subarray(1)).replace(/\0*$/,""),a.data=e,a):"W"===e.type[0]?(e=r.fromUTF8(e.data).replace(/\0*$/,""),a.data=e,a):e.data?(shaka.log.warning("Unrecognized ID3 frame type:",e.type),a.data=t.toArrayBuffer(e.data),a):null},shaka.util.Id3Utils.getID3Frames=function(e){for(var t=shaka.util.Id3Utils,r=0,a=[];t.isHeader_(e,r);){var n=t.readSize_(e,r+6);for(e[r+5]>>6&1&&(r+=10),n=(r+=10)+n;r+10<n;){var i=t.getFrameData_(e.subarray(r)),o=t.decodeFrame_(i);o&&a.push(o),r+=i.size+10}t.isFooter_(e,r)&&(r+=10)}return a},goog.exportSymbol("shaka.util.Id3Utils",shaka.util.Id3Utils),goog.exportProperty(shaka.util.Id3Utils,"getID3Frames",shaka.util.Id3Utils.getID3Frames),shaka.util.Id3Utils.UTF8_encoding=3,shaka.util.TsParser=function(){this.pmtId_=null,this.pmtParsed_=!1,this.videoCodec_=this.videoPid_=this.videoStartTime_=null,this.videoData_=[],this.audioCodec_=this.audioPid_=this.audioStartTime_=null,this.audioData_=[],this.id3Pid_=null,this.id3Data_=[]},shaka.util.TsParser.prototype.parse=function(e){var t=shaka.util.TsParser.Timescale_,r=shaka.util.TsParser.PacketLength_;if(e.length<3*r)return this;for(var a=Math.max(0,shaka.util.TsParser.syncOffset(e)),n=e.length-(e.length+a)%r,i=!1,o=a;o<n;o+=r)if(71===e[o]){var s=!!(64&e[o+1]),l=((31&e[o+1])<<8)+e[o+2];if(1<(48&e[o+3])>>4){var u=o+5+e[o+4];if(u===o+r)continue}else u=o+4;switch(l){case 0:s&&(u+=e[u]+1),this.pmtId_=this.getPmtId_(e,u);break;case 17:case 8191:break;case this.pmtId_:s&&(u+=e[u]+1),s=this.parsePMT(e,u),null==this.videoPid_&&(this.videoPid_=s.video,this.videoCodec_=s.videoCodec),null==this.audioPid_&&(this.audioPid_=s.audio,this.audioCodec_=s.audioCodec),null==this.id3Pid_&&(this.id3Pid_=s.id3),i&&!this.pmtParsed_&&(shaka.log.debug("reparse from beginning"),i=!1,o=a-r),this.pmtParsed_=!0;break;case this.videoPid_:s=e.subarray(u,o+r),null==this.videoStartTime_&&(l=this.parsePES(s))&&null!=l.pts&&(this.videoStartTime_=l.pts/t),this.videoData_.push(s);break;case this.audioPid_:s=e.subarray(u,o+r),null==this.audioStartTime_&&(l=this.parsePES(s))&&null!=l.pts&&(this.audioStartTime_=l.pts/t),this.audioData_.push(s);break;case this.id3Pid_:this.id3Data_.push(e.subarray(u,o+r));break;default:i=!0}}else shaka.log.warning("Found TS packet that do not start with 0x47");return this},shaka.util.TsParser.prototype.getPmtId_=function(e,t){return(31&e[t+10])<<8|e[t+11]},shaka.util.TsParser.prototype.parsePMT=function(e,t){var r={audio:-1,video:-1,id3:-1,audioCodec:"",videoCodec:""},a=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){var n=(31&e[t+1])<<8|e[t+2];switch(e[t]){case 15:-1===r.audio&&(r.audio=n,r.audioCodec="aac");break;case 21:-1===r.id3&&(r.id3=n);break;case 27:-1===r.video&&(r.video=n,r.videoCodec="avc");break;case 3:case 4:-1===r.audio&&(r.audio=n,r.audioCodec="mp3");break;case 36:-1===r.video&&(r.video=n,r.videoCodec="hvc")}t+=5+((15&e[t+3])<<8|e[t+4])}return r},shaka.util.TsParser.prototype.parsePES=function(e){if(1!=(e[0]<<16|e[1]<<8|e[2]))return null;var t={data:new Uint8Array(0),packetLength:6+(e[4]<<8|e[5]),pts:null,dts:null},r=e[7];return 192&r&&(t.pts=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,t.dts=t.pts,64&r&&(t.dts=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)),t.data=e.subarray(9+e[8]),t},shaka.util.TsParser.prototype.getMetadata=function(){for(var e=shaka.util.TsParser.Timescale_,t=shaka.util.Uint8ArrayUtils,r=[],a=new Uint8Array(0),n=this.id3Data_.length-1;0<=n;n--){var i=this.id3Data_[n];goog.asserts.assert(i,"We should have a data"),a=t.concat(i,a),(i=this.parsePES(a))&&(r.unshift({cueTime:i.pts?i.pts/e:null,data:i.data,frames:shaka.util.Id3Utils.getID3Frames(i.data),dts:i.dts,pts:i.pts}),a=new Uint8Array(0))}return r},shaka.util.TsParser.prototype.getStartTime=function(){return{audio:this.audioStartTime_,video:this.videoStartTime_}},shaka.util.TsParser.prototype.getCodecs=function(){return{audio:this.audioCodec_,video:this.videoCodec_}},shaka.util.TsParser.probe=function(e){return!(0>(e=shaka.util.TsParser.syncOffset(e)))&&(0<e&&shaka.log.warning("MPEG2-TS detected but first sync word found @ offset "+e+", junk ahead ?"),!0)},shaka.util.TsParser.syncOffset=function(e){for(var t=shaka.util.TsParser.PacketLength_,r=Math.min(1e3,e.length-3*t),a=0;a<r;){if(71===e[a]&&71===e[a+t]&&71===e[a+2*t])return a;a++}return-1},goog.exportSymbol("shaka.util.TsParser",shaka.util.TsParser),shaka.util.TsParser.PacketLength_=188,shaka.util.TsParser.Timescale_=9e4,shaka.lcevc={},shaka.lcevc.Dil=function(e,t,r){this.dil_=null,this.variantId_=-1,this.media_=e,this.canvas_=t,this.dilConfig_=r,this.create_()},shaka.lcevc.Dil.prototype.appendBuffer=function(e){this.dil_&&this.dil_.appendBuffer(e,"video",this.variantId_)},shaka.lcevc.Dil.prototype.hideCanvas=function(){this.dil_&&this.canvas_.classList.add("shaka-hidden")},shaka.lcevc.Dil.prototype.create_=function(){this.isSupported_()&&!this.dil_&&LcevcDil.SupportObject.webGLSupport(this.canvas_)&&(this.canvas_.classList.remove("shaka-hidden"),this.dil_=new LcevcDil.LcevcDil(this.media_,this.canvas_,this.dilConfig_))},shaka.lcevc.Dil.prototype.release=function(){this.dil_&&(this.dil_.close(),this.dil_=null)},shaka.lcevc.Dil.prototype.isSupported_=function(){return"undefined"==typeof libDPIModule&&shaka.log.alwaysWarn("Could not Find LCEVC Library dependencies on this page"),"undefined"==typeof LcevcDil?shaka.log.alwaysWarn("Could not Find LCEVC Library on this page"):LcevcDil.SupportObject.SupportStatus||shaka.log.alwaysWarn(LcevcDil.SupportObject.SupportError),"undefined"!=typeof LcevcDil&&"undefined"!=typeof libDPIModule&&this.canvas_ instanceof HTMLCanvasElement&&LcevcDil.SupportObject.SupportStatus},shaka.lcevc.Dil.prototype.updateVariant=function(e){var t=shaka.lcevc.Dil.ContainerFormat.MPEG2_TS;switch(e.mimeType){case"video/webm":t=shaka.lcevc.Dil.ContainerFormat.WEBM;break;case"video/mp4":t=shaka.lcevc.Dil.ContainerFormat.MP4}this.dil_&&(this.variantId_=e.id,this.dil_.setLevelSwitching(e.id,!0),this.dil_.setContainerFormat(t))},goog.exportSymbol("shaka.lcevc.Dil",shaka.lcevc.Dil),goog.exportProperty(shaka.lcevc.Dil.prototype,"release",shaka.lcevc.Dil.prototype.release),shaka.lcevc.Dil.ContainerFormat={MPEG2_TS:0,WEBM:1,MP4:2},shaka.media.MediaSourceEngine=function(e,t,r,a){var n=this;this.video_=e,this.config_=null,this.textDisplayer_=t,this.sourceBuffers_={},this.sourceBufferTypes_={},this.expectedEncryption_={},this.textEngine_=null,this.segmentRelativeVttTiming_=!1,e=function(e,t,r){},this.onMetadata_=r||e,this.lcevcDil_=a||null,this.queues_={},this.eventManager_=new shaka.util.EventManager,this.transmuxers_={},this.captionParser_=null,this.mediaSourceOpen_=new shaka.util.PublicPromise,this.mediaSource_=this.createMediaSource(this.mediaSourceOpen_),this.destroyer_=new shaka.util.Destroyer((function(){return n.doDestroy_()})),this.url_="",this.sequenceMode_=!1,this.textSequenceModeOffset_=new shaka.util.PublicPromise},shaka.media.MediaSourceEngine.prototype.createMediaSource=function(e){var t=this,r=new MediaSource;return this.eventManager_.listenOnce(r,"sourceopen",(function(){return t.onSourceOpen_(e)})),this.url_=shaka.media.MediaSourceEngine.createObjectURL(r),this.video_.src=this.url_,r},shaka.media.MediaSourceEngine.prototype.onSourceOpen_=function(e){URL.revokeObjectURL(this.url_),e.resolve()},shaka.media.MediaSourceEngine.isStreamSupported=function(e){var t=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs),r=shaka.util.MimeUtils.getExtendedType(e);return shaka.text.TextEngine.isTypeSupported(t)||shaka.media.Capabilities.isTypeSupported(r)||shaka.media.Transmuxer.isSupported(t,e.type)},shaka.media.MediaSourceEngine.probeSupport=function(){for(var e='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat($jscomp.arrayFromIterable(shaka.media.MediaSourceEngine.RAW_FORMATS)),t={},r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){r=r.value,shaka.util.Platform.supportsMediaSource()?shaka.text.TextEngine.isTypeSupported(r)?t[r]=!0:t[r]=shaka.media.Capabilities.isTypeSupported(r)||shaka.media.Transmuxer.isSupported(r):t[r]=shaka.util.Platform.supportsMediaType(r);var a=r.split(";")[0];t[a]=t[a]||t[r]}return t},shaka.media.MediaSourceEngine.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.media.MediaSourceEngine.prototype.doDestroy_=function(){var e,t,r,a,n,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r in e=shaka.util.Functional,t=[],u.queues_)for(a=u.queues_[r],n=a[0],u.queues_[r]=a.slice(0,1),n&&t.push(n.p.catch(e.noop)),i=$jscomp.makeIterator(a.slice(1)),o=i.next();!o.done;o=i.next())o.value.p.reject(shaka.util.Destroyer.destroyedError());for(s in u.textEngine_&&t.push(u.textEngine_.destroy()),u.textDisplayer_&&t.push(u.textDisplayer_.destroy()),u.transmuxers_)t.push(u.transmuxers_[s].destroy());return c.yield(Promise.all(t),2)}if(u.eventManager_&&(u.eventManager_.release(),u.eventManager_=null),u.video_&&(u.video_.removeAttribute("src"),u.video_.load(),u.video_=null),u.config_=null,u.mediaSource_=null,u.textEngine_=null,u.textDisplayer_=null,u.sourceBuffers_={},u.transmuxers_={},u.captionParser_=null,goog.DEBUG)for(l in u.queues_)goog.asserts.assert(0==u.queues_[l].length,l+" queue should be empty after destroy!");u.queues_={},u.lcevcDil_=null,c.jumpToEnd()}))},shaka.media.MediaSourceEngine.prototype.open=function(){return this.mediaSourceOpen_},shaka.media.MediaSourceEngine.prototype.init=function(e,t,r){r=void 0!==r&&r;var a,n,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress)return a=shaka.util.ManifestParserUtils.ContentType,p.yield(d.mediaSourceOpen_,2);for(d.sequenceMode_=r,n={},i=$jscomp.makeIterator(e.keys()),o=i.next();!o.done;n={$jscomp$loop$prop$contentType$649:n.$jscomp$loop$prop$contentType$649},o=i.next())n.$jscomp$loop$prop$contentType$649=o.value,s=e.get(n.$jscomp$loop$prop$contentType$649),goog.asserts.assert(shaka.media.MediaSourceEngine.isStreamSupported(s),"Type negotiation should happen before MediaSourceEngine.init!"),l=shaka.util.MimeUtils.getFullType(s.mimeType,s.codecs),n.$jscomp$loop$prop$contentType$649==a.TEXT?d.reinitText(l,r):(!t&&shaka.media.Capabilities.isTypeSupported(l)||!shaka.media.Transmuxer.isSupported(l,n.$jscomp$loop$prop$contentType$649)||(d.transmuxers_[n.$jscomp$loop$prop$contentType$649]=new shaka.media.Transmuxer(l),l=shaka.media.Transmuxer.convertCodecs(n.$jscomp$loop$prop$contentType$649,l)),u=l+d.config_.sourceBufferExtraFeatures,c=d.mediaSource_.addSourceBuffer(u),d.eventManager_.listen(c,"error",function(e){return function(){return d.onError_(e.$jscomp$loop$prop$contentType$649)}}(n)),d.eventManager_.listen(c,"updateend",function(e){return function(){return d.onUpdateEnd_(e.$jscomp$loop$prop$contentType$649)}}(n)),d.sourceBuffers_[n.$jscomp$loop$prop$contentType$649]=c,d.sourceBufferTypes_[n.$jscomp$loop$prop$contentType$649]=l,d.queues_[n.$jscomp$loop$prop$contentType$649]=[],d.expectedEncryption_[n.$jscomp$loop$prop$contentType$649]=!!s.drmInfos.length);p.jumpToEnd()}))},shaka.media.MediaSourceEngine.prototype.configure=function(e){this.config_=e},shaka.media.MediaSourceEngine.prototype.reinitText=function(e,t){this.textEngine_||(this.textEngine_=new shaka.text.TextEngine(this.textDisplayer_)),this.textEngine_.initParser(e,t,this.segmentRelativeVttTiming_)},shaka.media.MediaSourceEngine.prototype.ended=function(){return!this.mediaSource_||"ended"==this.mediaSource_.readyState},shaka.media.MediaSourceEngine.prototype.bufferStart=function(e){return e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.bufferStart():shaka.media.TimeRangesUtils.bufferStart(this.getBuffered_(e))},shaka.media.MediaSourceEngine.prototype.bufferEnd=function(e){return e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.bufferEnd():shaka.media.TimeRangesUtils.bufferEnd(this.getBuffered_(e))},shaka.media.MediaSourceEngine.prototype.isBuffered=function(e,t){return e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.isBuffered(t):(e=this.getBuffered_(e),shaka.media.TimeRangesUtils.isBuffered(e,t))},shaka.media.MediaSourceEngine.prototype.bufferedAheadOf=function(e,t){return e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.bufferedAheadOf(t):(e=this.getBuffered_(e),shaka.media.TimeRangesUtils.bufferedAheadOf(e,t))},shaka.media.MediaSourceEngine.prototype.getBufferedInfo=function(){var e=shaka.util.ManifestParserUtils.ContentType,t=shaka.media.TimeRangesUtils;if(e={total:t.getBufferedInfo(this.video_.buffered),audio:t.getBufferedInfo(this.getBuffered_(e.AUDIO)),video:t.getBufferedInfo(this.getBuffered_(e.VIDEO)),text:[]},this.textEngine_){t=this.textEngine_.bufferStart();var r=this.textEngine_.bufferEnd();null!=t&&null!=r&&e.text.push({start:t,end:r})}return e},shaka.media.MediaSourceEngine.prototype.getBuffered_=function(e){try{return this.sourceBuffers_[e].buffered}catch(t){return e in this.sourceBuffers_&&shaka.log.error("failed to get buffered range for "+e,t),null}},shaka.media.MediaSourceEngine.prototype.getCaptionParser=function(e){return new shaka.media.ClosedCaptionParser(e)},shaka.media.MediaSourceEngine.prototype.appendBuffer=function(e,t,r,a,n,i){n=void 0!==n&&n,i=void 0!==i&&i;var o,s,l,u,c,d,p,h,f,g,y,m,v,_,k,E,T,b,S,A,C,P,w,x,I,M,D,R=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(O){switch(O.nextAddress){case 1:if(o=shaka.util.ManifestParserUtils.ContentType,e!=o.TEXT){O.jumpTo(2);break}if(!R.sequenceMode_){O.jumpTo(3);break}return O.yield(R.textSequenceModeOffset_,4);case 4:s=O.yieldResult,R.textEngine_.setTimestampOffset(s);case 3:return O.yield(R.textEngine_.appendBuffer(t,r?r.startTime:null,r?r.endTime:null),5);case 5:return O.return();case 2:if(l=shaka.util.BufferUtils.toUint8(t),u=R.sourceBufferTypes_[e],R.transmuxers_[e]&&(u=R.transmuxers_[e].getOrginalMimeType()),shaka.util.TsParser.probe(l)?(c=(new shaka.util.TsParser).parse(l),d=r.startTime-(c.getStartTime()[e]||0),(p=c.getMetadata()).length&&R.onMetadata_(p,d,r?r.endTime:null)):shaka.media.MediaSourceEngine.RAW_FORMATS.includes(u)&&((h=shaka.util.Id3Utils.getID3Frames(l)).length&&r&&(f={cueTime:r.startTime,data:l,frames:h,dts:r.startTime,pts:r.startTime},R.onMetadata_([f],0,r.endTime))),!R.transmuxers_[e]){a&&e==o.VIDEO&&(R.textEngine_||R.reinitText("text/vtt",R.sequenceMode_),R.captionParser_||(R.captionParser_=R.getCaptionParser(u)),r?(g=R.captionParser_.parseFrom(t)).length&&(y=R.sourceBuffers_[o.VIDEO].timestampOffset,R.textEngine_.storeAndAppendClosedCaptions(g,r.startTime,r.endTime,y)):R.captionParser_.init(t)),O.jumpTo(6);break}return n&&R.transmuxers_[e].resetCaptions(),O.yield(R.transmuxers_[e].transmux(t),7);case 7:m=O.yieldResult,R.textEngine_||R.reinitText("text/vtt",R.sequenceMode_),m.captions&&m.captions.length&&(v=R.sourceBuffers_[o.VIDEO].timestampOffset,_=R.textEngine_.convertMuxjsCaptionsToShakaCaptions(m.captions),R.textEngine_.storeAndAppendClosedCaptions(_,r?r.startTime:null,r?r.endTime:null,v)),t=m.data;case 6:if(t=R.workAroundBrokenPlatforms_(t,r?r.startTime:null,e),k=R.sourceBuffers_[e],E=shaka.media.MediaSourceEngine.SourceBufferMode_.SEQUENCE,!R.sequenceMode_||k.mode==E||!r){O.jumpTo(8);break}if(T=R.mediaSource_.duration,!(e==o.VIDEO||!(o.VIDEO in R.sourceBuffers_))){O.jumpTo(9);break}return b=[k.appendWindowStart,k.appendWindowEnd],k.appendWindowStart=0,k.appendWindowEnd=1/0,S=k.timestampOffset,k.timestampOffset=0,O.yield(R.enqueueOperation_(e,(function(){return R.append_(e,t)})),10);case 10:return O.yield(R.enqueueOperation_(e,(function(){return R.abort_(e)})),11);case 11:return k.timestampOffset=S,k.appendWindowStart=b[0],k.appendWindowEnd=b[1],A=shaka.media.TimeRangesUtils.bufferStart(R.getBuffered_(e)),C=(r.startTime||0)-(A||0),R.textSequenceModeOffset_.resolve(C),O.yield(R.enqueueOperation_(e,(function(){return R.remove_(e,0,T)})),12);case 12:if(e!=o.VIDEO){O.jumpTo(9);break}return O.yield(R.enqueueOperation_(e,(function(){return R.flush_(e)})),9);case 9:return k.mode=E,O.yield(R.setDuration(T),8);case 8:return r&&R.sequenceMode_&&e!=o.TEXT&&(n||i)&&(P=r.startTime,R.enqueueOperation_(e,(function(){return R.abort_(e)})),R.enqueueOperation_(e,(function(){return R.setTimestampOffset_(e,P)}))),w=null,O.yield(R.enqueueOperation_(e,(function(){goog.DEBUG&&r&&(w=R.getBuffered_(e)),R.append_(e,t)})),16);case 16:goog.DEBUG&&r&&(x=R.getBuffered_(e),I=shaka.media.TimeRangesUtils.computeAddedRange(w,x))&&(M=r.endTime-r.startTime,D=Math.abs(I.end-r.endTime),.1<M&&D>M/2&&shaka.log.error("Possible encoding problem detected!","Unexpected buffered range for reference",r,"from URIs",r.getUris(),"should be",{start:r.startTime,end:r.endTime},"but got",I)),O.jumpToEnd()}}))},shaka.media.MediaSourceEngine.prototype.setSelectedClosedCaptionId=function(e){var t=this.bufferEnd(shaka.util.ManifestParserUtils.ContentType.VIDEO)||0;this.textEngine_.setSelectedClosedCaptionId(e,t)},shaka.media.MediaSourceEngine.prototype.clearSelectedClosedCaptionId=function(){this.textEngine_&&this.textEngine_.setSelectedClosedCaptionId("",0)},shaka.media.MediaSourceEngine.prototype.remove=function(e,t,r){var a,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return a=shaka.util.ManifestParserUtils.ContentType,e==a.TEXT?i.yield(n.textEngine_.remove(t,r),0):i.yield(n.enqueueOperation_(e,(function(){return n.remove_(e,t,r)})),0)}))},shaka.media.MediaSourceEngine.prototype.clear=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return t=shaka.util.ManifestParserUtils.ContentType,e==t.TEXT?r.textEngine_?a.yield(r.textEngine_.remove(0,1/0),0):a.return():a.yield(r.enqueueOperation_(e,(function(){return r.remove_(e,0,r.mediaSource_.duration)})),0)}))},shaka.media.MediaSourceEngine.prototype.resetCaptionParser=function(){this.captionParser_&&this.captionParser_.reset()},shaka.media.MediaSourceEngine.prototype.flush=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return t=shaka.util.ManifestParserUtils.ContentType,e==t.TEXT?a.return():a.yield(r.enqueueOperation_(e,(function(){return r.flush_(e)})),0)}))},shaka.media.MediaSourceEngine.prototype.setStreamProperties=function(e,t,r,a,n){var i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return i=shaka.util.ManifestParserUtils.ContentType,e==i.TEXT?(n||o.textEngine_.setTimestampOffset(t),o.textEngine_.setAppendWindow(r,a),s.return()):s.yield(Promise.all([o.enqueueOperation_(e,(function(){return o.abort_(e)})),n?Promise.resolve():o.enqueueOperation_(e,(function(){return o.setTimestampOffset_(e,t)})),o.enqueueOperation_(e,(function(){return o.setAppendWindow_(e,r,a)}))]),0)}))},shaka.media.MediaSourceEngine.prototype.resync=function(e,t){var r,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return r=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(a.sequenceMode_,"resync only used with sequence mode!"),e==r.TEXT?n.return():(a.enqueueOperation_(e,(function(){return a.abort_(e)})),n.yield(a.enqueueOperation_(e,(function(){return a.setTimestampOffset_(e,t)})),0))}))},shaka.media.MediaSourceEngine.prototype.endOfStream=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return r.yield(t.enqueueBlockingOperation_((function(){t.ended()||(e?t.mediaSource_.endOfStream(e):t.mediaSource_.endOfStream())})),0)}))},shaka.media.MediaSourceEngine.prototype.setDuration=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return r.yield(t.enqueueBlockingOperation_((function(){if(e<t.mediaSource_.duration)for(var r in t.sourceBuffers_){var a={start:function(){},p:new shaka.util.PublicPromise};t.queues_[r].unshift(a)}t.mediaSource_.duration=e})),0)}))},shaka.media.MediaSourceEngine.prototype.getDuration=function(){return this.mediaSource_.duration},shaka.media.MediaSourceEngine.prototype.append_=function(e,t){e==shaka.util.ManifestParserUtils.ContentType.VIDEO&&this.lcevcDil_&&this.lcevcDil_.appendBuffer(t),this.sourceBuffers_[e].appendBuffer(t)},shaka.media.MediaSourceEngine.prototype.remove_=function(e,t,r){r<=t?this.onUpdateEnd_(e):this.sourceBuffers_[e].remove(t,r)},shaka.media.MediaSourceEngine.prototype.abort_=function(e){var t=this.sourceBuffers_[e].appendWindowStart,r=this.sourceBuffers_[e].appendWindowEnd;this.sourceBuffers_[e].abort(),this.sourceBuffers_[e].appendWindowStart=t,this.sourceBuffers_[e].appendWindowEnd=r,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.flush_=function(e){goog.asserts.assert(0==this.video_.buffered.length,"MediaSourceEngine.flush_ should only be used after clearing all data!"),this.video_.currentTime-=.001,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.setTimestampOffset_=function(e,t){0>t&&(t+=.001),this.sourceBuffers_[e].timestampOffset=t,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.setAppendWindow_=function(e,t,r){this.sourceBuffers_[e].appendWindowStart=0,this.sourceBuffers_[e].appendWindowEnd=r,this.sourceBuffers_[e].appendWindowStart=t,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.onError_=function(e){var t=this.queues_[e][0];goog.asserts.assert(t,"Spurious error event!"),goog.asserts.assert(!this.sourceBuffers_[e].updating,"SourceBuffer should not be updating on error!"),t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_FAILED,this.video_.error?this.video_.error.code:0))},shaka.media.MediaSourceEngine.prototype.onUpdateEnd_=function(e){var t=this.queues_[e][0];goog.asserts.assert(t,"Spurious updateend event!"),t&&(goog.asserts.assert(!this.sourceBuffers_[e].updating,"SourceBuffer should not be updating on updateend!"),t.p.resolve(),this.popFromQueue_(e))},shaka.media.MediaSourceEngine.prototype.enqueueOperation_=function(e,t){return this.destroyer_.ensureNotDestroyed(),t={start:t,p:new shaka.util.PublicPromise},this.queues_[e].push(t),1==this.queues_[e].length&&this.startOperation_(e),t.p},shaka.media.MediaSourceEngine.prototype.enqueueBlockingOperation_=function(e){var t,r,a,n,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:for(a in u.destroyer_.ensureNotDestroyed(),t=[],r={},u.sourceBuffers_)r.$jscomp$loop$prop$ready$651=new shaka.util.PublicPromise,n={start:function(e){return function(){return e.$jscomp$loop$prop$ready$651.resolve()}}(r),p:r.$jscomp$loop$prop$ready$651},u.queues_[a].push(n),t.push(r.$jscomp$loop$prop$ready$651),1==u.queues_[a].length&&n.start(),r={$jscomp$loop$prop$ready$651:r.$jscomp$loop$prop$ready$651};return c.setCatchFinallyBlocks(2),c.yield(Promise.all(t),4);case 4:c.leaveTryBlock(3);break;case 2:if(i=c.enterCatchBlock(),goog.asserts.assert(u.destroyer_.destroyed(),"Should be destroyed by now"),goog.DEBUG)for(o in u.sourceBuffers_)u.queues_[o].length&&(goog.asserts.assert(1==u.queues_[o].length,"Should be at most one item in queue!"),goog.asserts.assert(t.includes(u.queues_[o][0].p),"The item in queue should be one of our waiters!"),u.queues_[o].shift());throw i;case 3:if(goog.DEBUG)for(s in u.sourceBuffers_)goog.asserts.assert(0==u.sourceBuffers_[s].updating,"SourceBuffers should not be updating after a blocking op!");try{e()}catch(e){throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,e)}finally{for(l in u.sourceBuffers_)u.popFromQueue_(l)}c.jumpToEnd()}}))},shaka.media.MediaSourceEngine.prototype.popFromQueue_=function(e){this.queues_[e].shift(),this.startOperation_(e)},shaka.media.MediaSourceEngine.prototype.startOperation_=function(e){var t=this.queues_[e][0];if(t)try{t.start()}catch(r){"QuotaExceededError"==r.name?t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.QUOTA_EXCEEDED_ERROR,e)):t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,r)),this.popFromQueue_(e)}},shaka.media.MediaSourceEngine.prototype.getTextDisplayer=function(){return goog.asserts.assert(this.textDisplayer_,"TextDisplayer should only be null when this is destroyed"),this.textDisplayer_},shaka.media.MediaSourceEngine.prototype.setTextDisplayer=function(e){var t=this.textDisplayer_;this.textDisplayer_=e,t&&(e.setTextVisibility(t.isTextVisible()),t.destroy()),this.textEngine_&&this.textEngine_.setDisplayer(e)},shaka.media.MediaSourceEngine.prototype.setSegmentRelativeVttTiming=function(e){this.segmentRelativeVttTiming_=e},shaka.media.MediaSourceEngine.prototype.workAroundBrokenPlatforms_=function(e,t,r){var a=this.expectedEncryption_[r];return null==t&&a&&shaka.util.Platform.requiresEncryptionInfoInAllInitSegments()&&"mp4"==shaka.util.MimeUtils.getContainerType(this.sourceBufferTypes_[r])&&(shaka.log.debug("Forcing fake encryption information in init segment."),e=shaka.media.ContentWorkarounds.fakeEncryption(e)),e},shaka.media.MediaSourceEngine.prototype.updateLcevcDil=function(e){this.lcevcDil_=e},shaka.media.MediaSourceEngine.createObjectURL=window.URL.createObjectURL,shaka.media.MediaSourceEngine.SourceBufferMode_={SEQUENCE:"sequence",SEGMENTS:"segments"},shaka.media.MediaSourceEngine.RAW_FORMATS=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],shaka.media.PresentationTimeline=function(e,t,r){this.presentationStartTime_=e,this.presentationDelay_=t,this.segmentAvailabilityDuration_=this.duration_=1/0,this.maxSegmentDuration_=1,this.maxSegmentEndTime_=this.minSegmentStartTime_=null,this.clockOffset_=0,this.static_=!0,this.userSeekStart_=0,this.autoCorrectDrift_=void 0===r||r,this.availabilityTimeOffset_=0,this.startTimeLocked_=!1},shaka.media.PresentationTimeline.prototype.getDuration=function(){return this.duration_},shaka.media.PresentationTimeline.prototype.getMaxSegmentDuration=function(){return this.maxSegmentDuration_},shaka.media.PresentationTimeline.prototype.setPresentationStartTime=function(e){goog.asserts.assert(0<=e,"presentationStartTime must be >= 0"),this.presentationStartTime_=e},shaka.media.PresentationTimeline.prototype.setDuration=function(e){goog.asserts.assert(0<e,"duration must be > 0"),this.duration_=e},shaka.media.PresentationTimeline.prototype.getPresentationStartTime=function(){return this.presentationStartTime_},shaka.media.PresentationTimeline.prototype.setClockOffset=function(e){this.clockOffset_=e},shaka.media.PresentationTimeline.prototype.setStatic=function(e){this.static_=e},shaka.media.PresentationTimeline.prototype.setSegmentAvailabilityDuration=function(e){goog.asserts.assert(0<=e,"segmentAvailabilityDuration must be >= 0"),this.segmentAvailabilityDuration_=e},shaka.media.PresentationTimeline.prototype.setDelay=function(e){goog.asserts.assert(0<=e,"delay must be >= 0"),this.presentationDelay_=e},shaka.media.PresentationTimeline.prototype.getDelay=function(){return this.presentationDelay_},shaka.media.PresentationTimeline.prototype.notifySegments=function(e){if(0!=e.length){for(var t=e[0].startTime,r=e[0].endTime,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())a=a.value,t=Math.min(t,a.startTime),r=Math.max(r,a.endTime),this.maxSegmentDuration_=Math.max(this.maxSegmentDuration_,a.endTime-a.startTime);this.notifyMinSegmentStartTime(t),this.maxSegmentEndTime_=Math.max(this.maxSegmentEndTime_,r),null!=this.presentationStartTime_&&this.autoCorrectDrift_&&!this.startTimeLocked_&&(this.presentationStartTime_=(Date.now()+this.clockOffset_)/1e3-this.maxSegmentEndTime_-this.maxSegmentDuration_),shaka.log.v1("notifySegments:","maxSegmentDuration="+this.maxSegmentDuration_)}},shaka.media.PresentationTimeline.prototype.lockStartTime=function(){this.startTimeLocked_=!0},shaka.media.PresentationTimeline.prototype.notifyMinSegmentStartTime=function(e){this.minSegmentStartTime_=null==this.minSegmentStartTime_?e:Math.min(this.minSegmentStartTime_,e)},shaka.media.PresentationTimeline.prototype.notifyMaxSegmentDuration=function(e){this.maxSegmentDuration_=Math.max(this.maxSegmentDuration_,e),shaka.log.v1("notifyNewSegmentDuration:","maxSegmentDuration="+this.maxSegmentDuration_)},shaka.media.PresentationTimeline.prototype.offset=function(e){null!=this.minSegmentStartTime_&&(this.minSegmentStartTime_+=e),null!=this.maxSegmentEndTime_&&(this.maxSegmentEndTime_+=e)},shaka.media.PresentationTimeline.prototype.isLive=function(){return 1/0==this.duration_&&!this.static_},shaka.media.PresentationTimeline.prototype.isInProgress=function(){return 1/0!=this.duration_&&!this.static_},shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityStart=function(){goog.asserts.assert(0<=this.segmentAvailabilityDuration_,"The availability duration should be positive");var e=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_;return Math.max(this.userSeekStart_,e)},shaka.media.PresentationTimeline.prototype.setUserSeekStart=function(e){this.userSeekStart_=e},shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityEnd=function(){return this.isLive()||this.isInProgress()?Math.min(this.getLiveEdge_()+this.availabilityTimeOffset_,this.duration_):this.maxSegmentEndTime_?Math.min(this.maxSegmentEndTime_,this.duration_):this.duration_},shaka.media.PresentationTimeline.prototype.getSafeSeekRangeStart=function(e){var t=Math.max(this.minSegmentStartTime_,this.userSeekStart_);if(1/0==this.segmentAvailabilityDuration_)return Math.ceil(1e3*t)/1e3;var r=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_;return e=Math.min(r+e,this.getSeekRangeEnd()),Math.max(t,e)},shaka.media.PresentationTimeline.prototype.getSeekRangeStart=function(){return this.getSafeSeekRangeStart(0)},shaka.media.PresentationTimeline.prototype.getSeekRangeEnd=function(){var e=this.isLive()||this.isInProgress()?this.presentationDelay_:0;return Math.max(0,this.getSegmentAvailabilityEnd()-e)},shaka.media.PresentationTimeline.prototype.usingPresentationStartTime=function(){return!(null==this.presentationStartTime_||null!=this.maxSegmentEndTime_&&this.autoCorrectDrift_)},shaka.media.PresentationTimeline.prototype.getLiveEdge_=function(){goog.asserts.assert(null!=this.presentationStartTime_,"Cannot compute timeline live edge without start time");var e=(Date.now()+this.clockOffset_)/1e3;return Math.max(0,e-this.maxSegmentDuration_-this.presentationStartTime_)},shaka.media.PresentationTimeline.prototype.setAvailabilityTimeOffset=function(e){this.availabilityTimeOffset_=e},shaka.media.PresentationTimeline.prototype.assertIsValid=function(){goog.DEBUG&&(this.isLive()?goog.asserts.assert(null!=this.presentationStartTime_,"Detected as live stream, but does not match our model of live!"):this.isInProgress()?goog.asserts.assert(null!=this.presentationStartTime_&&1/0==this.segmentAvailabilityDuration_,"Detected as IPR stream, but does not match our model of IPR!"):goog.asserts.assert(1/0==this.segmentAvailabilityDuration_&&1/0!=this.duration_&&this.static_,"Detected as VOD stream, but does not match our model of VOD!"))},goog.exportSymbol("shaka.media.PresentationTimeline",shaka.media.PresentationTimeline),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setAvailabilityTimeOffset",shaka.media.PresentationTimeline.prototype.setAvailabilityTimeOffset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"usingPresentationStartTime",shaka.media.PresentationTimeline.prototype.usingPresentationStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSeekRangeEnd",shaka.media.PresentationTimeline.prototype.getSeekRangeEnd),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSeekRangeStart",shaka.media.PresentationTimeline.prototype.getSeekRangeStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSafeSeekRangeStart",shaka.media.PresentationTimeline.prototype.getSafeSeekRangeStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSegmentAvailabilityEnd",shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityEnd),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setUserSeekStart",shaka.media.PresentationTimeline.prototype.setUserSeekStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSegmentAvailabilityStart",shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"isInProgress",shaka.media.PresentationTimeline.prototype.isInProgress),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"isLive",shaka.media.PresentationTimeline.prototype.isLive),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"offset",shaka.media.PresentationTimeline.prototype.offset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifyMaxSegmentDuration",shaka.media.PresentationTimeline.prototype.notifyMaxSegmentDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifyMinSegmentStartTime",shaka.media.PresentationTimeline.prototype.notifyMinSegmentStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"lockStartTime",shaka.media.PresentationTimeline.prototype.lockStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifySegments",shaka.media.PresentationTimeline.prototype.notifySegments),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getDelay",shaka.media.PresentationTimeline.prototype.getDelay),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setDelay",shaka.media.PresentationTimeline.prototype.setDelay),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setSegmentAvailabilityDuration",shaka.media.PresentationTimeline.prototype.setSegmentAvailabilityDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setStatic",shaka.media.PresentationTimeline.prototype.setStatic),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setClockOffset",shaka.media.PresentationTimeline.prototype.setClockOffset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getPresentationStartTime",shaka.media.PresentationTimeline.prototype.getPresentationStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setDuration",shaka.media.PresentationTimeline.prototype.setDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setPresentationStartTime",shaka.media.PresentationTimeline.prototype.setPresentationStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getMaxSegmentDuration",shaka.media.PresentationTimeline.prototype.getMaxSegmentDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getDuration",shaka.media.PresentationTimeline.prototype.getDuration),shaka.media.StallDetector=function(e,t,r){this.onEvent_=r,this.implementation_=e,this.wasMakingProgress_=e.shouldBeMakingProgress(),this.value_=e.getPresentationSeconds(),this.lastUpdateSeconds_=e.getWallSeconds(),this.didJump_=!1,this.stallsDetected_=0,this.stallThresholdSeconds_=t,this.onStall_=function(){}},shaka.media.StallDetector.prototype.release=function(){this.onEvent_=this.implementation_=null,this.onStall_=function(){}},shaka.media.StallDetector.prototype.onStall=function(e){this.onStall_=e},shaka.media.StallDetector.prototype.getStallsDetected=function(){return this.stallsDetected_},shaka.media.StallDetector.prototype.poll=function(){var e=this.implementation_,t=e.shouldBeMakingProgress(),r=e.getPresentationSeconds(),a=e.getWallSeconds();return this.value_==r&&this.wasMakingProgress_==t||(this.lastUpdateSeconds_=a,this.value_=r,this.wasMakingProgress_=t,this.didJump_=!1),(t=(r=a-this.lastUpdateSeconds_)>=this.stallThresholdSeconds_&&t&&!this.didJump_)&&(this.onStall_(this.value_,r),this.didJump_=!0,this.value_=e.getPresentationSeconds(),this.stallsDetected_++,this.onEvent_(new shaka.util.FakeEvent(shaka.util.FakeEvent.EventName.StallDetected))),t},shaka.media.StallDetector.Implementation=function(){},shaka.media.StallDetector.Implementation.prototype.shouldBeMakingProgress=function(){},shaka.media.StallDetector.Implementation.prototype.getPresentationSeconds=function(){},shaka.media.StallDetector.Implementation.prototype.getWallSeconds=function(){},shaka.media.StallDetector.MediaElementImplementation=function(e){this.mediaElement_=e},shaka.media.StallDetector.MediaElementImplementation.prototype.shouldBeMakingProgress=function(){return!this.mediaElement_.paused&&0!=this.mediaElement_.playbackRate&&0!=this.mediaElement_.buffered.length&&shaka.media.StallDetector.MediaElementImplementation.hasContentFor_(this.mediaElement_.buffered,this.mediaElement_.currentTime)},shaka.media.StallDetector.MediaElementImplementation.prototype.getPresentationSeconds=function(){return this.mediaElement_.currentTime},shaka.media.StallDetector.MediaElementImplementation.prototype.getWallSeconds=function(){return Date.now()/1e3},shaka.media.StallDetector.MediaElementImplementation.hasContentFor_=function(e,t){for(var r=(e=$jscomp.makeIterator(shaka.media.TimeRangesUtils.getBufferedInfo(e))).next();!r.done;r=e.next())if(!(t<(r=r.value).start-.1||t>r.end-.5))return!0;return!1},shaka.media.GapJumpingController=function(e,t,r,a,n){var i=this;this.onEvent_=n,this.video_=e,this.timeline_=t,this.config_=r,this.eventManager_=new shaka.util.EventManager,this.seekingEventReceived_=!1,this.prevReadyState_=e.readyState,this.gapsJumped_=0,this.stallDetector_=a,this.hadSegmentAppended_=!1,this.eventManager_.listen(e,"waiting",(function(){return i.onPollGapJump_()})),this.gapJumpTimer_=new shaka.util.Timer((function(){i.onPollGapJump_()})).tickEvery(.25)},shaka.media.GapJumpingController.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.gapJumpTimer_&&(this.gapJumpTimer_.stop(),this.gapJumpTimer_=null),this.stallDetector_&&(this.stallDetector_.release(),this.stallDetector_=null),this.video_=this.timeline_=this.onEvent_=null},shaka.media.GapJumpingController.prototype.onSegmentAppended=function(){this.hadSegmentAppended_=!0,this.onPollGapJump_()},shaka.media.GapJumpingController.prototype.onSeeking=function(){this.seekingEventReceived_=!0,this.hadSegmentAppended_=!1},shaka.media.GapJumpingController.prototype.getGapsJumped=function(){return this.gapsJumped_},shaka.media.GapJumpingController.prototype.onPollGapJump_=function(){if(0!=this.video_.readyState){if(this.video_.seeking){if(!this.seekingEventReceived_)return}else this.seekingEventReceived_=!1;if((!this.video_.paused||0==this.video_.currentTime&&(this.video_.autoplay||0!=this.video_.currentTime))&&(this.video_.readyState!=this.prevReadyState_&&(this.prevReadyState_=this.video_.readyState),!this.stallDetector_||!this.stallDetector_.poll())){var e=this.video_.currentTime,t=this.video_.buffered,r=shaka.media.TimeRangesUtils.getGapIndex(t,e,this.config_.gapDetectionThreshold);if(null!=r&&(0!=r||this.hadSegmentAppended_)){var a=t.start(r);a>=this.timeline_.getSeekRangeEnd()||((e=a-e)<shaka.media.GapJumpingController.BROWSER_GAP_TOLERANCE||(0==r?shaka.log.info("Jumping forward",e,"seconds because of gap before start time of",a):shaka.log.info("Jumping forward",e,"seconds because of gap starting at",t.end(r-1),"and ending at",a),this.video_.currentTime=a,this.gapsJumped_++,this.onEvent_(new shaka.util.FakeEvent(shaka.util.FakeEvent.EventName.GapJumped))))}}}},shaka.media.GapJumpingController.BROWSER_GAP_TOLERANCE=.001,shaka.util.MediaReadyState=function(){},shaka.util.MediaReadyState.waitForReadyState=function(e,t,r,a){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?a():(t=shaka.util.MediaReadyState.READY_STATES_TO_EVENT_NAMES_.value().get(t),r.listenOnce(e,t,a))},shaka.util.MediaReadyState.READY_STATES_TO_EVENT_NAMES_=new shaka.util.Lazy((function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])})),shaka.media.VideoWrapper=function(e,t,r){var a=this;this.video_=e,this.onSeek_=t,this.startTime_=r,this.started_=!1,this.eventManager_=new shaka.util.EventManager,this.mover_=new shaka.media.VideoWrapper.PlayheadMover(e,10),shaka.util.MediaReadyState.waitForReadyState(this.video_,HTMLMediaElement.HAVE_METADATA,this.eventManager_,(function(){a.setStartTime_(a.startTime_)}))},shaka.media.VideoWrapper.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.mover_&&(this.mover_.release(),this.mover_=null),this.onSeek_=function(){},this.video_=null},shaka.media.VideoWrapper.prototype.getTime=function(){return this.started_?this.video_.currentTime:this.startTime_},shaka.media.VideoWrapper.prototype.setTime=function(e){var t=this;0<this.video_.readyState?this.mover_.moveTo(e):shaka.util.MediaReadyState.waitForReadyState(this.video_,HTMLMediaElement.HAVE_METADATA,this.eventManager_,(function(){t.setStartTime_(t.startTime_)}))},shaka.media.VideoWrapper.prototype.setStartTime_=function(e){var t=this;.001>Math.abs(this.video_.currentTime-e)?this.startListeningToSeeks_():(this.eventManager_.listenOnce(this.video_,"seeking",(function(){t.startListeningToSeeks_()})),this.mover_.moveTo(this.video_.currentTime&&0!=this.video_.currentTime?this.video_.currentTime:e))},shaka.media.VideoWrapper.prototype.startListeningToSeeks_=function(){var e=this;goog.asserts.assert(0<this.video_.readyState,"The media element should be ready before we listen for seeking."),this.started_=!0,this.eventManager_.listen(this.video_,"seeking",(function(){return e.onSeek_()}))},shaka.media.VideoWrapper.PlayheadMover=function(e,t){var r=this;this.mediaElement_=e,this.maxAttempts_=t,this.targetTime_=this.originTime_=this.remainingAttempts_=0,this.timer_=new shaka.util.Timer((function(){return r.onTick_()}))},shaka.media.VideoWrapper.PlayheadMover.prototype.release=function(){this.timer_&&(this.timer_.stop(),this.timer_=null),this.mediaElement_=null},shaka.media.VideoWrapper.PlayheadMover.prototype.moveTo=function(e){this.originTime_=this.mediaElement_.currentTime,this.targetTime_=e,this.remainingAttempts_=this.maxAttempts_,this.mediaElement_.currentTime=e,this.timer_.tickEvery(.1)},shaka.media.VideoWrapper.PlayheadMover.prototype.onTick_=function(){0>=this.remainingAttempts_?(shaka.log.warning(["Failed to move playhead from",this.originTime_,"to",this.targetTime_].join(" ")),this.timer_.stop()):this.mediaElement_.currentTime!=this.originTime_?this.timer_.stop():(this.mediaElement_.currentTime=this.targetTime_,this.remainingAttempts_--)},shaka.media.Playhead=function(){},shaka.media.Playhead.prototype.ready=function(){},shaka.media.Playhead.prototype.setStartTime=function(e){},shaka.media.Playhead.prototype.getStallsDetected=function(){},shaka.media.Playhead.prototype.getGapsJumped=function(){},shaka.media.Playhead.prototype.getTime=function(){},shaka.media.Playhead.prototype.notifyOfBufferingChange=function(){},shaka.media.SrcEqualsPlayhead=function(e){this.mediaElement_=e,this.started_=!1,this.startTime_=null,this.eventManager_=new shaka.util.EventManager},shaka.media.SrcEqualsPlayhead.prototype.ready=function(){var e=this;goog.asserts.assert(null!=this.mediaElement_,"Playhead should not be released before calling ready()");shaka.util.MediaReadyState.waitForReadyState(this.mediaElement_,HTMLMediaElement.HAVE_CURRENT_DATA,this.eventManager_,(function(){null==e.startTime_||0==e.startTime_?e.started_=!0:(e.eventManager_.listenOnce(e.mediaElement_,"seeking",(function(){e.started_=!0})),e.mediaElement_.currentTime=Math.max(0,e.mediaElement_.currentTime+e.startTime_))}))},shaka.media.SrcEqualsPlayhead.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.mediaElement_=null},shaka.media.SrcEqualsPlayhead.prototype.setStartTime=function(e){this.startTime_=this.started_?this.startTime_:e},shaka.media.SrcEqualsPlayhead.prototype.getTime=function(){return(this.started_?this.mediaElement_.currentTime:this.startTime_)||0},shaka.media.SrcEqualsPlayhead.prototype.getStallsDetected=function(){return 0},shaka.media.SrcEqualsPlayhead.prototype.getGapsJumped=function(){return 0},shaka.media.SrcEqualsPlayhead.prototype.notifyOfBufferingChange=function(){},shaka.media.MediaSourcePlayhead=function(e,t,r,a,n,i){var o=this;this.minSeekRange_=3,this.mediaElement_=e,this.timeline_=t.presentationTimeline,this.minBufferTime_=t.minBufferTime||0,this.config_=r,this.onSeek_=n,this.lastCorrectiveSeek_=null,this.stallDetector_=this.createStallDetector_(e,r,i),this.gapController_=new shaka.media.GapJumpingController(e,t.presentationTimeline,r,this.stallDetector_,i),this.videoWrapper_=new shaka.media.VideoWrapper(e,(function(){return o.onSeeking_()}),this.getStartTime_(a)),this.checkWindowTimer_=new shaka.util.Timer((function(){o.onPollWindow_()}))},shaka.media.MediaSourcePlayhead.prototype.ready=function(){this.checkWindowTimer_.tickEvery(.25)},shaka.media.MediaSourcePlayhead.prototype.release=function(){this.videoWrapper_&&(this.videoWrapper_.release(),this.videoWrapper_=null),this.gapController_&&(this.gapController_.release(),this.gapController_=null),this.checkWindowTimer_&&(this.checkWindowTimer_.stop(),this.checkWindowTimer_=null),this.mediaElement_=this.videoWrapper_=this.timeline_=this.config_=null,this.onSeek_=function(){}},shaka.media.MediaSourcePlayhead.prototype.setStartTime=function(e){this.videoWrapper_.setTime(e)},shaka.media.MediaSourcePlayhead.prototype.getTime=function(){var e=this.videoWrapper_.getTime();return 0<this.mediaElement_.readyState&&!this.mediaElement_.paused?this.clampTime_(e):e},shaka.media.MediaSourcePlayhead.prototype.getStallsDetected=function(){return this.stallDetector_?this.stallDetector_.getStallsDetected():0},shaka.media.MediaSourcePlayhead.prototype.getGapsJumped=function(){return this.gapController_.getGapsJumped()},shaka.media.MediaSourcePlayhead.prototype.getStartTime_=function(e){return null==e?e=1/0>this.timeline_.getDuration()?this.timeline_.getSeekRangeStart():this.timeline_.getSeekRangeEnd():0>e&&(e=this.timeline_.getSeekRangeEnd()+e),this.clampSeekToDuration_(this.clampTime_(e))},shaka.media.MediaSourcePlayhead.prototype.notifyOfBufferingChange=function(){this.gapController_.onSegmentAppended()},shaka.media.MediaSourcePlayhead.prototype.onPollWindow_=function(){if(0!=this.mediaElement_.readyState&&!this.mediaElement_.paused){var e=this.videoWrapper_.getTime(),t=this.timeline_.getSeekRangeStart(),r=this.timeline_.getSeekRangeEnd();r-t<this.minSeekRange_&&(t=r-this.minSeekRange_),e<t&&(t=this.reposition_(e),shaka.log.info("Jumping forward "+(t-e)+" seconds to catch up with the seek range."),this.mediaElement_.currentTime=t)}},shaka.media.MediaSourcePlayhead.prototype.onSeeking_=function(){this.gapController_.onSeeking();var e=this.videoWrapper_.getTime(),t=this.reposition_(e);if(Math.abs(t-e)>shaka.media.GapJumpingController.BROWSER_GAP_TOLERANCE){var r=Date.now()/1e3;if(!this.lastCorrectiveSeek_||this.lastCorrectiveSeek_<r-1)return this.lastCorrectiveSeek_=r,void this.videoWrapper_.setTime(t)}shaka.log.v1("Seek to "+e),this.onSeek_()},shaka.media.MediaSourcePlayhead.prototype.clampSeekToDuration_=function(e){var t=this.timeline_.getDuration();return e>=t?(goog.asserts.assert(0<=this.config_.durationBackoff,"Duration backoff must be non-negative!"),t-this.config_.durationBackoff):e},shaka.media.MediaSourcePlayhead.prototype.reposition_=function(e){goog.asserts.assert(this.config_,"Cannot reposition playhead when it has beeen destroyed");var t=Math.max(this.minBufferTime_,this.config_.rebufferingGoal),r=this.config_.safeSeekOffset,a=this.timeline_.getSeekRangeStart(),n=this.timeline_.getSeekRangeEnd(),i=this.timeline_.getDuration();n-a<this.minSeekRange_&&(a=n-this.minSeekRange_);var o=this.timeline_.getSafeSeekRangeStart(t),s=this.timeline_.getSafeSeekRangeStart(r);return t=this.timeline_.getSafeSeekRangeStart(t+r),e>=i?(shaka.log.v1("Playhead past duration."),this.clampSeekToDuration_(e)):e>n?(shaka.log.v1("Playhead past end."),n):e<a?shaka.media.TimeRangesUtils.isBuffered(this.mediaElement_.buffered,s)?(shaka.log.v1("Playhead before start & start is buffered"),s):(shaka.log.v1("Playhead before start & start is unbuffered"),t):e>=o||shaka.media.TimeRangesUtils.isBuffered(this.mediaElement_.buffered,e)?(shaka.log.v1("Playhead in safe region or in buffered region."),e):(shaka.log.v1("Playhead outside safe region & in unbuffered region."),t)},shaka.media.MediaSourcePlayhead.prototype.clampTime_=function(e){var t=this.timeline_.getSeekRangeStart();return e<t||e>(t=this.timeline_.getSeekRangeEnd())?t:e},shaka.media.MediaSourcePlayhead.prototype.createStallDetector_=function(e,t,r){if(!t.stallEnabled)return null;var a=t.stallThreshold,n=t.stallSkip;return(t=new shaka.media.StallDetector(new shaka.media.StallDetector.MediaElementImplementation(e),a,r)).onStall((function(t,r){shaka.log.debug("Stall detected at "+t+" for "+r+" seconds."),n?(shaka.log.debug("Seeking forward "+n+" seconds to break stall."),e.currentTime+=n):(shaka.log.debug("Pausing and unpausing to break stall."),e.pause(),e.play())})),t},shaka.media.SegmentIndex=function(e){goog.DEBUG&&shaka.media.SegmentIndex.assertCorrectReferences_(e),this.references=e,this.timer_=null,this.numEvicted=0,this.immutable_=!1},shaka.media.SegmentIndex.prototype.release=function(){this.immutable_||(this.references=[],this.timer_&&this.timer_.stop(),this.timer_=null)},shaka.media.SegmentIndex.prototype.markImmutable=function(){this.immutable_=!0},shaka.media.SegmentIndex.prototype.forEachTopLevelReference=function(e){for(var t=$jscomp.makeIterator(this.references),r=t.next();!r.done;r=t.next())e(r.value)},shaka.media.SegmentIndex.prototype.earliestReference=function(){return this.references[0]||null},shaka.media.SegmentIndex.prototype.dropFirstReferences=function(e){this.references.splice(0,e)},shaka.media.SegmentIndex.prototype.find=function(e){for(var t=this.references.length-1,r=t;0<=r;--r){var a=this.references[r],n=r<t?this.references[r+1].startTime:a.endTime;if(e>=a.startTime&&e<n)return r+this.numEvicted}return this.references.length&&e<this.references[0].startTime?this.numEvicted:null},shaka.media.SegmentIndex.prototype.get=function(e){return 0==this.references.length||0>(e-=this.numEvicted)||e>=this.references.length?null:this.references[e]},shaka.media.SegmentIndex.prototype.offset=function(e){if(!this.immutable_)for(var t=$jscomp.makeIterator(this.references),r=t.next();!r.done;r=t.next())r.value.offset(e)},shaka.media.SegmentIndex.prototype.merge=function(e){if(goog.DEBUG&&shaka.media.SegmentIndex.assertCorrectReferences_(e),!this.immutable_&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.references=this.references.filter((function(e){return Math.round(1e3*e.startTime)/1e3<t})),this.references.push.apply(this.references,$jscomp.arrayFromIterable(e)),goog.DEBUG&&shaka.media.SegmentIndex.assertCorrectReferences_(this.references)}},shaka.media.SegmentIndex.prototype.mergeAndEvict=function(e,t){var r=this;e=e.filter((function(e){return e.endTime>t&&(0==r.references.length||e.endTime>r.references[0].startTime)}));var a=this.references[0];this.merge(e),e=this.references[0],a&&goog.asserts.assert(a.startTime==e.startTime,"SegmentIndex.merge should not change the first reference time!"),this.evict(t)},shaka.media.SegmentIndex.prototype.evict=function(e){if(!this.immutable_){var t=this.references.length;this.references=this.references.filter((function(t){return t.endTime>e})),this.numEvicted+=t-this.references.length}},shaka.media.SegmentIndex.prototype.fit=function(e,t,r){if(r=void 0!==r&&r,goog.asserts.assert(null!=t,"Content duration must be known for static content!"),goog.asserts.assert(1/0!=t,"Content duration must be finite for static content!"),!this.immutable_){for(;this.references.length&&this.references[this.references.length-1].startTime>=t;)this.references.pop();for(;this.references.length&&this.references[0].endTime<=e;)this.references.shift(),r||this.numEvicted++;0!=this.references.length&&(e=this.references[this.references.length-1],this.references[this.references.length-1]=new shaka.media.SegmentReference(e.startTime,t,e.getUrisInner,e.startByte,e.endByte,e.initSegmentReference,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.partialReferences,e.tilesLayout,e.tileDuration,e.syncTime,e.status,e.hlsAes128Key))}},shaka.media.SegmentIndex.prototype.updateEvery=function(e,t){var r=this;goog.asserts.assert(!this.timer_,"SegmentIndex timer already started!"),this.immutable_||(this.timer_&&this.timer_.stop(),this.timer_=new shaka.util.Timer((function(){var e=t();e?r.references.push.apply(r.references,$jscomp.arrayFromIterable(e)):(r.timer_.stop(),r.timer_=null)})),this.timer_.tickEvery(e))},shaka.media.SegmentIndex.prototype[Symbol.iterator]=function(){var e=this.getIteratorForTime(0);return goog.asserts.assert(null!=e,"Iterator for 0 should never be null!"),e},shaka.media.SegmentIndex.prototype.getIteratorForTime=function(e){var t=this.find(e);if(null==t)return null;t--;var r=this.get(t+1),a=-1;if(r&&r.hasPartialSegments())for(var n=r.partialReferences.length-1;0<=n;--n){var i=r.partialReferences[n];if(e>=i.startTime&&e<i.endTime){t++,a=n-1;break}}return new shaka.media.SegmentIterator(this,t,a)},shaka.media.SegmentIndex.prototype.isEmpty=function(){return 0==this.references.length},shaka.media.SegmentIndex.forSingleSegment=function(e,t,r){return e=new shaka.media.SegmentReference(e,e+t,(function(){return r}),0,null,null,e,e,e+t),new shaka.media.SegmentIndex([e])},goog.exportSymbol("shaka.media.SegmentIndex",shaka.media.SegmentIndex),goog.exportProperty(shaka.media.SegmentIndex,"forSingleSegment",shaka.media.SegmentIndex.forSingleSegment),goog.exportProperty(shaka.media.SegmentIndex.prototype,"getIteratorForTime",shaka.media.SegmentIndex.prototype.getIteratorForTime),goog.exportProperty(shaka.media.SegmentIndex.prototype,"updateEvery",shaka.media.SegmentIndex.prototype.updateEvery),goog.exportProperty(shaka.media.SegmentIndex.prototype,"fit",shaka.media.SegmentIndex.prototype.fit),goog.exportProperty(shaka.media.SegmentIndex.prototype,"evict",shaka.media.SegmentIndex.prototype.evict),goog.exportProperty(shaka.media.SegmentIndex.prototype,"mergeAndEvict",shaka.media.SegmentIndex.prototype.mergeAndEvict),goog.exportProperty(shaka.media.SegmentIndex.prototype,"offset",shaka.media.SegmentIndex.prototype.offset),goog.exportProperty(shaka.media.SegmentIndex.prototype,"get",shaka.media.SegmentIndex.prototype.get),goog.exportProperty(shaka.media.SegmentIndex.prototype,"find",shaka.media.SegmentIndex.prototype.find),goog.exportProperty(shaka.media.SegmentIndex.prototype,"markImmutable",shaka.media.SegmentIndex.prototype.markImmutable),goog.exportProperty(shaka.media.SegmentIndex.prototype,"release",shaka.media.SegmentIndex.prototype.release),goog.DEBUG&&(shaka.media.SegmentIndex.assertCorrectReferences_=function(e){goog.asserts.assert(e.every((function(t,r){return 0==r||((r=e[r-1]).startTime<t.startTime||!(r.startTime>t.startTime)&&r.endTime<=t.endTime)})),"SegmentReferences are incorrect")}),shaka.media.SegmentIterator=function(e,t,r){this.segmentIndex_=e,this.currentPosition_=t,this.currentPartialPosition_=r},shaka.media.SegmentIterator.prototype.currentPosition=function(){return this.currentPosition_},shaka.media.SegmentIterator.prototype.current=function(){var e=this.segmentIndex_.get(this.currentPosition_);return e&&e.hasPartialSegments()&&e.getUris().length&&this.currentPartialPosition_>=e.partialReferences.length&&(this.currentPosition_++,this.currentPartialPosition_=0,e=this.segmentIndex_.get(this.currentPosition_)),e&&e.hasPartialSegments()?e.partialReferences[this.currentPartialPosition_]:e},shaka.media.SegmentIterator.prototype.next=function(){var e=this.segmentIndex_.get(this.currentPosition_);return e&&e.hasPartialSegments()?(this.currentPartialPosition_++,e.getUris().length&&this.currentPartialPosition_==e.partialReferences.length&&(this.currentPosition_++,this.currentPartialPosition_=0)):(this.currentPosition_++,this.currentPartialPosition_=0),{value:e=this.current(),done:!e}},goog.exportSymbol("shaka.media.SegmentIterator",shaka.media.SegmentIterator),goog.exportProperty(shaka.media.SegmentIterator.prototype,"next",shaka.media.SegmentIterator.prototype.next),goog.exportProperty(shaka.media.SegmentIterator.prototype,"current",shaka.media.SegmentIterator.prototype.current),goog.exportProperty(shaka.media.SegmentIterator.prototype,"currentPosition",shaka.media.SegmentIterator.prototype.currentPosition),shaka.media.MetaSegmentIndex=function(){shaka.media.SegmentIndex.call(this,[]),this.indexes_=[]},$jscomp.inherits(shaka.media.MetaSegmentIndex,shaka.media.SegmentIndex),shaka.media.MetaSegmentIndex.prototype.appendSegmentIndex=function(e){goog.asserts.assert(0==this.indexes_.length||0==e.numEvicted,"Should not append a new segment index with already-evicted segments"),this.indexes_.push(e)},shaka.media.MetaSegmentIndex.prototype.clone=function(){var e=new shaka.media.MetaSegmentIndex;return e.indexes_=this.indexes_.slice(),e},shaka.media.MetaSegmentIndex.prototype.release=function(){for(var e=$jscomp.makeIterator(this.indexes_),t=e.next();!t.done;t=e.next())t.value.release();this.indexes_=[]},shaka.media.MetaSegmentIndex.prototype.find=function(e){for(var t=0,r=$jscomp.makeIterator(this.indexes_),a=r.next();!a.done;a=r.next()){var n=(a=a.value).find(e);if(null!=n)return n+t;t+=a.numEvicted+a.references.length}return null},shaka.media.MetaSegmentIndex.prototype.get=function(e){for(var t=0,r=!1,a=$jscomp.makeIterator(this.indexes_),n=a.next();!n.done;n=a.next()){n=n.value,goog.asserts.assert(!r||0==n.numEvicted,"Should not see evicted segments after available segments");var i=n.get(e-t);if(i)return i;t+=n.numEvicted+n.references.length,r=r||0!=n.references.length}return null},shaka.media.MetaSegmentIndex.prototype.offset=function(e){goog.asserts.assert(!1,"offset() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.merge=function(e){goog.asserts.assert(!1,"merge() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.evict=function(e){goog.asserts.assert(!1,"evict() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.mergeAndEvict=function(e,t){goog.asserts.assert(!1,"mergeAndEvict() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.fit=function(e,t){goog.asserts.assert(!1,"fit() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.updateEvery=function(e,t){goog.asserts.assert(!1,"updateEvery() should not be used in MetaSegmentIndex!")},goog.exportSymbol("shaka.media.MetaSegmentIndex",shaka.media.MetaSegmentIndex),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"updateEvery",shaka.media.MetaSegmentIndex.prototype.updateEvery),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"fit",shaka.media.MetaSegmentIndex.prototype.fit),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"mergeAndEvict",shaka.media.MetaSegmentIndex.prototype.mergeAndEvict),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"evict",shaka.media.MetaSegmentIndex.prototype.evict),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"merge",shaka.media.MetaSegmentIndex.prototype.merge),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"offset",shaka.media.MetaSegmentIndex.prototype.offset),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"get",shaka.media.MetaSegmentIndex.prototype.get),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"find",shaka.media.MetaSegmentIndex.prototype.find),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"release",shaka.media.MetaSegmentIndex.prototype.release),shaka.media.PlayRateController=function(e){var t=this;this.harness_=e,this.isBuffering_=!1,this.rate_=this.harness_.getRate(),this.pollRate_=.25,this.timer_=new shaka.util.Timer((function(){t.harness_.movePlayhead(t.rate_*t.pollRate_)}))},shaka.media.PlayRateController.prototype.release=function(){this.timer_&&(this.timer_.stop(),this.timer_=null),this.harness_=null},shaka.media.PlayRateController.prototype.setBuffering=function(e){this.isBuffering_=e,this.apply_()},shaka.media.PlayRateController.prototype.set=function(e){goog.asserts.assert(0!=e,"Should never set rate of 0 explicitly!"),this.rate_=e,this.apply_()},shaka.media.PlayRateController.prototype.getRealRate=function(){return this.rate_},shaka.media.PlayRateController.prototype.getDefaultRate=function(){return this.harness_.getDefaultRate()},shaka.media.PlayRateController.prototype.apply_=function(){this.timer_.stop();var e=this.calculateCurrentRate_();if(shaka.log.v1("Changing effective playback rate to",e),0<=e)try{return void this.applyRate_(e)}catch(e){}this.timer_.tickEvery(this.pollRate_),this.applyRate_(0)},shaka.media.PlayRateController.prototype.calculateCurrentRate_=function(){return this.isBuffering_?0:this.rate_},shaka.media.PlayRateController.prototype.applyRate_=function(e){var t=this.harness_.getRate();return t!=e&&this.harness_.setRate(e),t!=e},shaka.media.IPlayheadObserver=function(){},shaka.media.IPlayheadObserver.prototype.poll=function(e,t){},shaka.media.PlayheadObserverManager=function(e){var t=this;this.mediaElement_=e,this.observers_=new Set,this.pollingLoop_=new shaka.util.Timer((function(){t.pollAllObservers_(!1)})).tickEvery(.25)},shaka.media.PlayheadObserverManager.prototype.release=function(){this.pollingLoop_.stop();for(var e=$jscomp.makeIterator(this.observers_),t=e.next();!t.done;t=e.next())t.value.release();this.observers_.clear()},shaka.media.PlayheadObserverManager.prototype.manage=function(e){this.observers_.add(e)},shaka.media.PlayheadObserverManager.prototype.notifyOfSeek=function(){this.pollAllObservers_(!0)},shaka.media.PlayheadObserverManager.prototype.pollAllObservers_=function(e){for(var t=$jscomp.makeIterator(this.observers_),r=t.next();!r.done;r=t.next())r.value.poll(this.mediaElement_.currentTime,e)},shaka.media.QualityObserver=function(e){shaka.util.FakeEventTarget.call(this),this.contentTypeStates_=new Map,this.getBufferedInfo_=e},$jscomp.inherits(shaka.media.QualityObserver,shaka.util.FakeEventTarget),shaka.media.QualityObserver.prototype.release=function(){this.contentTypeStates_.clear(),shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.media.QualityObserver.prototype.getContentTypeState_=function(e){var t=this.contentTypeStates_.get(e);return t||(t={qualityChangePositions:[],currentQuality:null,contentType:e},this.contentTypeStates_.set(e,t)),t},shaka.media.QualityObserver.prototype.addMediaQualityChange=function(e,t){var r=this.getContentTypeState_(e.contentType);this.purgeQualityChangePositions_(r),e={mediaQuality:e,position:t};var a=(r=r.qualityChangePositions).findIndex((function(e){return e.position>=t}));0<=a?r.splice(a,r[a].position==t?1:0,e):r.push(e)},shaka.media.QualityObserver.getMediaQualityAtPosition_=function(e,t){for(var r=(t=t.qualityChangePositions).length-1;0<=r;r--){var a=t[r];if(a.position<=e)return a.mediaQuality}return null},shaka.media.QualityObserver.mediaQualitiesAreTheSame_=function(e,t){return e===t||!(!e||!t)&&(e.bandwidth==t.bandwidth&&e.audioSamplingRate==t.audioSamplingRate&&e.codecs==t.codecs&&e.contentType==t.contentType&&e.frameRate==t.frameRate&&e.height==t.height&&e.mimeType==t.mimeType&&e.channelsCount==t.channelsCount&&e.pixelAspectRatio==t.pixelAspectRatio&&e.width==t.width)},shaka.media.QualityObserver.prototype.poll=function(e,t){for(var r=(t=$jscomp.makeIterator(this.contentTypeStates_.values())).next();!r.done;r=t.next()){r=r.value;var a=shaka.media.QualityObserver.getMediaQualityAtPosition_(e,r);a&&!shaka.media.QualityObserver.mediaQualitiesAreTheSame_(r.currentQuality,a)&&this.positionIsBuffered_(e,a.contentType)&&(r.currentQuality=a,shaka.log.debug("Media quality changed at position "+e+" "+JSON.stringify(a)),r=new shaka.util.FakeEvent("qualitychange",new Map([["quality",a],["position",e]])),this.dispatchEvent(r))}},shaka.media.QualityObserver.prototype.positionIsBuffered_=function(e,t){if((t=this.getBufferedInfo_()[t])&&0<t.length){var r=t[t.length-1].end;if(e>=t[0].start&&e<r)return!0}return!1},shaka.media.QualityObserver.prototype.purgeQualityChangePositions_=function(e){var t=this.getBufferedInfo_()[e.contentType];if(t&&0<t.length){var r=t[0].start,a=t[t.length-1].end,n=e.qualityChangePositions;e.qualityChangePositions=n.filter((function(e,t){return!(e.position<=r&&t+1<n.length&&n[t+1].position<=r||e.position>=a)}))}else e.qualityChangePositions=[]},shaka.media.RegionTimeline=function(e){shaka.util.FakeEventTarget.call(this);var t=this;this.regions_=new Set,this.getSeekRange_=e,this.filterTimer_=new shaka.util.Timer((function(){t.filterBySeekRange_()})).tickEvery(shaka.media.RegionTimeline.REGION_FILTER_INTERVAL)},$jscomp.inherits(shaka.media.RegionTimeline,shaka.util.FakeEventTarget),shaka.media.RegionTimeline.prototype.release=function(){this.regions_.clear(),this.filterTimer_.stop(),shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.media.RegionTimeline.prototype.addRegion=function(e){null==this.findSimilarRegion_(e)&&(this.regions_.add(e),e=new shaka.util.FakeEvent("regionadd",new Map([["region",e]])),this.dispatchEvent(e))},shaka.media.RegionTimeline.prototype.filterBySeekRange_=function(){for(var e=this.getSeekRange_(),t=$jscomp.makeIterator(this.regions_),r=t.next();!r.done;r=t.next())(r=r.value).endTime<e.start&&(this.regions_.delete(r),r=new shaka.util.FakeEvent("regionremove",new Map([["region",r]])),this.dispatchEvent(r))},shaka.media.RegionTimeline.prototype.findSimilarRegion_=function(e){for(var t=$jscomp.makeIterator(this.regions_),r=t.next();!r.done;r=t.next())if((r=r.value).schemeIdUri==e.schemeIdUri&&r.id==e.id&&r.startTime==e.startTime&&r.endTime==e.endTime)return r;return null},shaka.media.RegionTimeline.prototype.regions=function(){return this.regions_},shaka.media.RegionTimeline.REGION_FILTER_INTERVAL=2,shaka.media.RegionObserver=function(e){shaka.util.FakeEventTarget.call(this);var t=this;this.timeline_=e,this.oldPosition_=new Map;var r=shaka.media.RegionObserver.RelativePosition_;e=r.BEFORE_THE_REGION;var a=r.IN_THE_REGION;r=r.AFTER_THE_REGION,this.rules_=[{weWere:null,weAre:a,invoke:function(e,r){return t.onEvent_("enter",e,r)}},{weWere:e,weAre:a,invoke:function(e,r){return t.onEvent_("enter",e,r)}},{weWere:r,weAre:a,invoke:function(e,r){return t.onEvent_("enter",e,r)}},{weWere:a,weAre:e,invoke:function(e,r){return t.onEvent_("exit",e,r)}},{weWere:a,weAre:r,invoke:function(e,r){return t.onEvent_("exit",e,r)}},{weWere:e,weAre:r,invoke:function(e,r){return t.onEvent_("skip",e,r)}},{weWere:r,weAre:e,invoke:function(e,r){return t.onEvent_("skip",e,r)}}],this.eventManager_=new shaka.util.EventManager,this.eventManager_.listen(this.timeline_,"regionremove",(function(e){t.oldPosition_.delete(e.region)}))},$jscomp.inherits(shaka.media.RegionObserver,shaka.util.FakeEventTarget),shaka.media.RegionObserver.prototype.release=function(){this.timeline_=null,this.oldPosition_.clear(),this.eventManager_.release(),this.eventManager_=null,shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.media.RegionObserver.prototype.poll=function(e,t){for(var r=shaka.media.RegionObserver,a=$jscomp.makeIterator(this.timeline_.regions()),n=a.next();!n.done;n=a.next()){n=n.value;var i=this.oldPosition_.get(n),o=r.determinePositionRelativeTo_(n,e);this.oldPosition_.set(n,o);for(var s=$jscomp.makeIterator(this.rules_),l=s.next();!l.done;l=s.next())(l=l.value).weWere==i&&l.weAre==o&&l.invoke(n,t)}},shaka.media.RegionObserver.prototype.onEvent_=function(e,t,r){e=new shaka.util.FakeEvent(e,new Map([["region",t],["seeking",r]])),this.dispatchEvent(e)},shaka.media.RegionObserver.determinePositionRelativeTo_=function(e,t){var r=shaka.media.RegionObserver.RelativePosition_;return t<e.startTime?r.BEFORE_THE_REGION:t>e.endTime?r.AFTER_THE_REGION:r.IN_THE_REGION},shaka.media.RegionObserver.RelativePosition_={BEFORE_THE_REGION:1,IN_THE_REGION:2,AFTER_THE_REGION:3},shaka.util.Networking=function(){},shaka.util.Networking.createSegmentRequest=function(e,t,r,a,n){return e=shaka.net.NetworkingEngine.makeRequest(e,a,n),0==t&&null==r||(e.headers.Range=r?"bytes="+t+"-"+r:"bytes="+t+"-"),e},shaka.media.StreamingEngine=function(e,t){var r=this;this.playerInterface_=t,this.manifest_=e,this.config_=null,this.bufferingGoalScale_=1,this.currentTextStream_=this.currentVariant_=null,this.parsedPrftEventRaised_=!1,this.mediaStates_=new Map,this.startupComplete_=!1,this.failureCallbackBackoff_=null,this.fatalError_=!1,this.destroyer_=new shaka.util.Destroyer((function(){return r.doDestroy_()}))},shaka.media.StreamingEngine.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.media.StreamingEngine.prototype.doDestroy_=function(){var e,t,r,a,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){if(1==i.nextAddress){for(e=[],t=$jscomp.makeIterator(n.mediaStates_.values()),r=t.next();!r.done;r=t.next())a=r.value,n.cancelUpdate_(a),e.push(n.abortOperations_(a));return i.yield(Promise.all(e),2)}n.mediaStates_.clear(),n.playerInterface_=null,n.manifest_=null,n.config_=null,i.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.configure=function(e){this.config_=e,this.failureCallbackBackoff_=new shaka.net.Backoff({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0)},shaka.media.StreamingEngine.prototype.start=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return goog.asserts.assert(e.config_,"StreamingEngine configure() must be called before init()!"),t.yield(e.initStreams_(),2);e.destroyer_.ensureNotDestroyed(),shaka.log.debug("init: completed initial Stream setup"),e.startupComplete_=!0,t.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.getCurrentVariant=function(){return this.currentVariant_},shaka.media.StreamingEngine.prototype.getCurrentTextStream=function(){return this.currentTextStream_},shaka.media.StreamingEngine.prototype.loadNewTextStream_=function(e){var t,r,a,n,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:return t=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(!o.mediaStates_.has(t.TEXT),"Should not call loadNewTextStream_ while streaming text!"),s.setCatchFinallyBlocks(2),s.yield(o.playerInterface_.mediaSourceEngine.clear(t.TEXT),4);case 4:s.leaveTryBlock(3);break;case 2:r=s.enterCatchBlock(),o.playerInterface_&&o.playerInterface_.onError(r);case 3:a=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs),o.playerInterface_.mediaSourceEngine.reinitText(a,o.manifest_.sequenceMode),n=o.playerInterface_.mediaSourceEngine.getTextDisplayer(),(n.isTextVisible()||o.config_.alwaysStreamText)&&(i=o.createMediaState_(e),o.mediaStates_.set(t.TEXT,i),o.scheduleUpdate_(i,0)),s.jumpToEnd()}}))},shaka.media.StreamingEngine.prototype.unloadTextStream=function(){var e=shaka.util.ManifestParserUtils.ContentType,t=this.mediaStates_.get(e.TEXT);t&&(this.cancelUpdate_(t),this.abortOperations_(t).catch((function(){})),this.mediaStates_.delete(e.TEXT)),this.currentTextStream_=null},shaka.media.StreamingEngine.prototype.setTrickPlay=function(e){var t=this.mediaStates_.get(shaka.util.ManifestParserUtils.ContentType.VIDEO);if(t){var r=t.stream;r&&(shaka.log.debug("setTrickPlay",e),e?(e=r.trickModeVideo)&&!t.restoreStreamAfterTrickPlay&&(shaka.log.debug("Engaging trick mode stream",e),this.switchInternal_(e,!1,0,!1),t.restoreStreamAfterTrickPlay=r):(r=t.restoreStreamAfterTrickPlay)&&(shaka.log.debug("Restoring non-trick-mode stream",r),t.restoreStreamAfterTrickPlay=null,this.switchInternal_(r,!0,0,!1)))}},shaka.media.StreamingEngine.prototype.switchVariant=function(e,t,r,a,n){t=void 0!==t&&t,r=void 0===r?0:r,a=void 0!==a&&a,n=void 0!==n&&n,this.currentVariant_=e,this.startupComplete_&&(e.video&&this.switchInternal_(e.video,t,r,a,n),e.audio&&this.switchInternal_(e.audio,t,r,a,n))},shaka.media.StreamingEngine.prototype.switchTextStream=function(e){if(this.currentTextStream_=e,this.startupComplete_){var t=shaka.util.ManifestParserUtils.ContentType;goog.asserts.assert(e&&e.type==t.TEXT,"Wrong stream type passed to switchTextStream!"),this.switchInternal_(e,!0,0,!1)}},shaka.media.StreamingEngine.prototype.reloadTextStream=function(){var e=this.mediaStates_.get(shaka.util.ManifestParserUtils.ContentType.TEXT);e&&this.switchInternal_(e.stream,!0,0,!0)},shaka.media.StreamingEngine.prototype.switchInternal_=function(e,t,r,a,n){var i=this,o=shaka.util.ManifestParserUtils.ContentType,s=this.mediaStates_.get(e.type);s||e.type!=o.TEXT?(goog.asserts.assert(s,"switch: expected mediaState to exist"),s&&(s.restoreStreamAfterTrickPlay&&(shaka.log.debug("switch during trick play mode",e),e.trickModeVideo?(s.restoreStreamAfterTrickPlay=e,e=e.trickModeVideo,shaka.log.debug("switch found trick play stream",e)):(s.restoreStreamAfterTrickPlay=null,shaka.log.debug("switch found no special trick play stream"))),s.stream!=e||a?(e.type==o.TEXT&&(a=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs),this.playerInterface_.mediaSourceEngine.reinitText(a,this.manifest_.sequenceMode)),s.stream.closeSegmentIndex&&s.stream.closeSegmentIndex(),s.stream=e,s.segmentIterator=null,s.adaptation=!!n,e=shaka.media.StreamingEngine.logPrefix_(s),shaka.log.debug("switch: switching to Stream "+e),t&&(s.clearingBuffer?s.waitingToFlushBuffer=!0:s.performingUpdate?(s.waitingToClearBuffer=!0,s.clearBufferSafeMargin=r,s.waitingToFlushBuffer=!0):(this.cancelUpdate_(s),this.clearBuffer_(s,!0,r).catch((function(e){i.playerInterface_&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),i.playerInterface_.onError(e))})))),this.makeAbortDecision_(s).catch((function(e){i.playerInterface_&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),i.playerInterface_.onError(e))}))):(t=shaka.media.StreamingEngine.logPrefix_(s),shaka.log.debug("switch: Stream "+t+" already active")))):this.loadNewTextStream_(e)},shaka.media.StreamingEngine.prototype.makeAbortDecision_=function(e){var t,r,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?e.operation?(t=e.stream,r=e.operation,t.segmentIndex?n.jumpTo(2):n.yield(t.createSegmentIndex(),2)):n.return():e.operation!=r||e.stream!=t?n.return():(goog.asserts.assert(e.stream.segmentIndex,"Segment index should exist by now!"),a.shouldAbortCurrentRequest_(e)&&(shaka.log.info("Aborting current segment request."),e.operation.abort()),void n.jumpToEnd())}))},shaka.media.StreamingEngine.prototype.shouldAbortCurrentRequest_=function(e){goog.asserts.assert(e.operation,"Abort logic requires an ongoing operation!"),goog.asserts.assert(e.stream&&e.stream.segmentIndex,"Abort logic requires a segment index");var t=this.playerInterface_.getPresentationTime(),r=this.playerInterface_.mediaSourceEngine.bufferEnd(e.type),a=this.getTimeNeeded_(e,t),n=null==(a=e.stream.segmentIndex.find(a))?null:e.stream.segmentIndex.get(a);return a=n?n.getSize():null,n&&!a&&(a=(n.getEndTime()-n.getStartTime())*(e.stream.bandwidth||0)/8),!!a&&((n=n.initSegmentReference)&&(a+=n.getSize()||0),8*a/(n=this.playerInterface_.getBandwidthEstimate())<(r||0)-t-Math.max(this.manifest_.minBufferTime||0,this.config_.rebufferingGoal)||e.operation.getBytesRemaining()>a)},shaka.media.StreamingEngine.prototype.seeked=function(){if(this.playerInterface_){for(var e=this.playerInterface_.getPresentationTime(),t=shaka.util.ManifestParserUtils.ContentType,r=!1,a=$jscomp.makeIterator(this.mediaStates_.keys()),n=a.next();!n.done;n=a.next()){n=n.value;var i=this.mediaStates_.get(n),o=shaka.media.StreamingEngine.logPrefix_(i);i.segmentIterator=null,this.playerInterface_.mediaSourceEngine.isBuffered(n,e)||((null!=this.playerInterface_.mediaSourceEngine.bufferEnd(n)||i.performingUpdate)&&(this.forceClearBuffer_(i),r=!0),i.operation&&(i.operation.abort(),shaka.log.debug(o,"Aborting operation due to seek"),i.operation=null),n===t.TEXT&&this.playerInterface_.mediaSourceEngine.resetCaptionParser(),i.seeked=!0)}r||shaka.log.debug("(all): seeked: buffered seek: presentationTime="+e)}},shaka.media.StreamingEngine.prototype.forceClearBuffer_=function(e){var t=this,r=shaka.media.StreamingEngine.logPrefix_(e);e.clearingBuffer?shaka.log.debug(r,"clear: already clearing the buffer"):e.waitingToClearBuffer?shaka.log.debug(r,"clear: already waiting"):e.performingUpdate?(shaka.log.debug(r,"clear: currently updating"),e.waitingToClearBuffer=!0,e.clearBufferSafeMargin=0):null==this.playerInterface_.mediaSourceEngine.bufferStart(e.type)?(shaka.log.debug(r,"clear: nothing buffered"),null==e.updateTimer&&this.scheduleUpdate_(e,0)):(shaka.log.debug(r,"clear: handling right now"),this.cancelUpdate_(e),this.clearBuffer_(e,!1,0).catch((function(e){t.playerInterface_&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),t.playerInterface_.onError(e))})))},shaka.media.StreamingEngine.prototype.initStreams_=function(){var e,t,r,a,n,i,o,s,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){if(1==d.nextAddress){if(e=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(c.config_,"StreamingEngine configure() must be called before init()!"),!c.currentVariant_)throw shaka.log.error("init: no Streams chosen"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STREAMING,shaka.util.Error.Code.STREAMING_ENGINE_STARTUP_INVALID_STATE);return t=new Map,r=new Set,c.currentVariant_.audio&&(t.set(e.AUDIO,c.currentVariant_.audio),r.add(c.currentVariant_.audio)),c.currentVariant_.video&&(t.set(e.VIDEO,c.currentVariant_.video),r.add(c.currentVariant_.video)),c.currentTextStream_&&(t.set(e.TEXT,c.currentTextStream_),r.add(c.currentTextStream_)),a=c.playerInterface_.mediaSourceEngine,n=c.config_.forceTransmux,d.yield(a.init(t,n,c.manifest_.sequenceMode),2)}for(c.destroyer_.ensureNotDestroyed(),c.updateDuration(),i=$jscomp.makeIterator(t.keys()),o=i.next();!o.done;o=i.next())s=o.value,l=t.get(s),c.mediaStates_.has(s)||(u=c.createMediaState_(l),c.mediaStates_.set(s,u),c.scheduleUpdate_(u,0));d.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.createMediaState_=function(e){return{stream:e,type:e.type,segmentIterator:null,lastSegmentReference:null,lastInitSegmentReference:null,lastTimestampOffset:null,lastAppendWindowStart:null,lastAppendWindowEnd:null,restoreStreamAfterTrickPlay:null,endOfStream:!1,performingUpdate:!1,updateTimer:null,waitingToClearBuffer:!1,clearBufferSafeMargin:0,waitingToFlushBuffer:!1,clearingBuffer:!1,seeked:!0,needsResync:!1,recovering:!1,hasError:!1,operation:null}},shaka.media.StreamingEngine.prototype.updateDuration=function(){var e=this.manifest_.presentationTimeline.getDuration();1/0>e?this.playerInterface_.mediaSourceEngine.setDuration(e):this.playerInterface_.mediaSourceEngine.setDuration(Math.pow(2,32))},shaka.media.StreamingEngine.prototype.onUpdate_=function(e){var t,r,a,n,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(s.destroyer_.ensureNotDestroyed(),t=shaka.media.StreamingEngine.logPrefix_(e),goog.asserts.assert(!e.performingUpdate&&null!=e.updateTimer,t+" unexpected call to onUpdate_()"),e.performingUpdate||null==e.updateTimer)return l.return();if(goog.asserts.assert(!e.clearingBuffer,t+" onUpdate_() should not be called when clearing the buffer"),e.clearingBuffer)return l.return();if(e.updateTimer=null,!e.waitingToClearBuffer){l.jumpTo(2);break}return shaka.log.debug(t,"skipping update and clearing the buffer"),l.yield(s.clearBuffer_(e,e.waitingToFlushBuffer,e.clearBufferSafeMargin),3);case 3:return l.return();case 2:if(e.stream.segmentIndex){l.jumpTo(4);break}return r=e.stream,l.yield(e.stream.createSegmentIndex(),5);case 5:if(r!=e.stream)return r.closeSegmentIndex&&(goog.asserts.assert(!e.stream.segmentIndex,"mediastate.stream should not have segmentIndex yet."),r.closeSegmentIndex()),e.performingUpdate||e.updateTimer||s.scheduleUpdate_(e,0),l.return();case 4:l.setCatchFinallyBlocks(6),null!=(a=s.update_(e))&&(s.scheduleUpdate_(e,a),e.hasError=!1),l.leaveTryBlock(7);break;case 6:return n=l.enterCatchBlock(),l.yield(s.handleStreamingError_(n),8);case 8:return l.return();case 7:if(i=Array.from(s.mediaStates_.values()),!s.startupComplete_||!i.every((function(e){return e.endOfStream}))){l.jumpTo(0);break}return shaka.log.v1(t,"calling endOfStream()..."),l.yield(s.playerInterface_.mediaSourceEngine.endOfStream(),10);case 10:s.destroyer_.ensureNotDestroyed(),0!=(o=s.playerInterface_.mediaSourceEngine.getDuration())&&o<s.manifest_.presentationTimeline.getDuration()&&s.manifest_.presentationTimeline.setDuration(o),l.jumpToEnd()}}))},shaka.media.StreamingEngine.prototype.update_=function(e){goog.asserts.assert(this.manifest_,"manifest_ should not be null"),goog.asserts.assert(this.config_,"config_ should not be null");var t=shaka.util.ManifestParserUtils.ContentType;if(shaka.media.StreamingEngine.isEmbeddedText_(e))return this.playerInterface_.mediaSourceEngine.setSelectedClosedCaptionId(e.stream.originalId||""),null;e.type==t.TEXT&&this.playerInterface_.mediaSourceEngine.clearSelectedClosedCaptionId();var r=shaka.media.StreamingEngine.logPrefix_(e),a=this.playerInterface_.getPresentationTime(),n=this.getTimeNeeded_(e,a);shaka.log.v2(r,"timeNeeded="+n);var i=this.playerInterface_.mediaSourceEngine.bufferedAheadOf(e.type,a);shaka.log.v2(r,"update_:","presentationTime="+a,"bufferedAhead="+i);var o=Math.max(this.manifest_.minBufferTime||0,this.config_.rebufferingGoal,this.config_.bufferingGoal)*this.bufferingGoalScale_,s=this.manifest_.presentationTimeline.getDuration()-n,l=this.playerInterface_.mediaSourceEngine.bufferEnd(e.type);if(1e-6>s&&l)return shaka.log.debug(r,"buffered to end of presentation"),e.endOfStream=!0,e.type==t.VIDEO&&(e=this.mediaStates_.get(t.TEXT))&&shaka.media.StreamingEngine.isEmbeddedText_(e)&&(e.endOfStream=!0),null;if(e.endOfStream=!1,i>=o)return shaka.log.v2(r,"buffering goal met"),this.config_.updateIntervalSeconds/2;if(!(t=this.getSegmentReferenceNeeded_(e,a,l)))return this.config_.updateIntervalSeconds;for(i=1/0,o=Array.from(this.mediaStates_.values()),s=(o=$jscomp.makeIterator(o)).next();!s.done;s=o.next())s=s.value,shaka.media.StreamingEngine.isEmbeddedText_(s)||s.segmentIterator&&!s.segmentIterator.current()||(s=this.getTimeNeeded_(s,a),i=Math.min(i,s));return n>=i+(o=this.manifest_.presentationTimeline.getMaxSegmentDuration()*shaka.media.StreamingEngine.MAX_RUN_AHEAD_SEGMENTS_)?(shaka.log.v2(r,"waiting for other streams to buffer"),this.config_.updateIntervalSeconds):(this.fetchAndAppend_(e,a,t).catch((function(){})),null)},shaka.media.StreamingEngine.prototype.getTimeNeeded_=function(e,t){return e.lastSegmentReference?e.lastSegmentReference.endTime:t},shaka.media.StreamingEngine.prototype.getSegmentReferenceNeeded_=function(e,t,r){var a=shaka.media.StreamingEngine.logPrefix_(e);if(goog.asserts.assert(e.stream.segmentIndex,"segment index should have been generated already"),e.segmentIterator)return e.segmentIterator.current();if(e.lastSegmentReference||r)return t=e.lastSegmentReference?e.lastSegmentReference.endTime:r,goog.asserts.assert(null!=t,"Should have a time to search"),shaka.log.v1(a,"looking up segment from new stream endTime:",t),e.needsResync=!0,e.segmentIterator=e.stream.segmentIndex.getIteratorForTime(t),null==(e=e.segmentIterator&&e.segmentIterator.next().value)&&shaka.log.warning(a,"cannot find segment","endTime:",t),e;r=this.config_.inaccurateManifestTolerance;var n=Math.max(t-r,0);shaka.log.v1(a,"looking up segment","lookupTime:",n,"presentationTime:",t);var i=null;return r&&(e.segmentIterator=e.stream.segmentIndex.getIteratorForTime(n),i=e.segmentIterator&&e.segmentIterator.next().value),i||(e.segmentIterator=e.stream.segmentIndex.getIteratorForTime(t),i=e.segmentIterator&&e.segmentIterator.next().value),null==i&&shaka.log.warning(a,"cannot find segment","lookupTime:",n,"presentationTime:",t),i},shaka.media.StreamingEngine.prototype.fetchAndAppend_=function(e,t,r){var a,n,i,o,s,l,u,c,d,p,h,f,g,y,m,v,_,k,E=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(T){switch(T.nextAddress){case 1:if(a=shaka.util.ManifestParserUtils.ContentType,n=shaka.media.StreamingEngine,i=n.logPrefix_(e),shaka.log.v1(i,"fetchAndAppend_:","presentationTime="+t,"reference.startTime="+r.startTime,"reference.endTime="+r.endTime),o=e.stream,s=e.segmentIterator,e.performingUpdate=!0,T.setCatchFinallyBlocks(2),r.getStatus()==shaka.media.SegmentReference.Status.MISSING)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.SEGMENT_MISSING);return T.yield(E.initSourceBuffer_(e,r),4);case 4:return E.destroyer_.ensureNotDestroyed(),E.fatalError_?T.return():(shaka.log.v2(i,"fetching segment"),l="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,u=window.ReadableStream,E.config_.lowLatencyMode&&u&&l&&!r.hlsAes128Key?(p=new Uint8Array(0),f=h=!1,g=function(a){var n,i,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return h?l.return():(f=!0,E.destroyer_.ensureNotDestroyed(),E.fatalError_?l.return():(p=E.concatArray_(p,a),n=!1,i=0,(new shaka.util.Mp4Parser).box("mdat",(function(e){i=e.size+e.start,n=!0})).parse(p,!1,!0),n?(s=p.subarray(0,i),p=p.subarray(i),l.yield(E.append_(e,t,o,r,s),0)):l.jumpTo(0)))}))},T.yield(E.fetch_(e,r,g),11)):(E.config_.lowLatencyMode&&!u&&shaka.log.warning("Low latency streaming mode is enabled, but ReadableStream is not supported by the browser."),c=E.fetch_(e,r),T.yield(c,7)));case 7:if(d=T.yieldResult,E.destroyer_.ensureNotDestroyed(),E.fatalError_)return T.return();if(!r.hlsAes128Key){T.jumpTo(8);break}return goog.asserts.assert(s,"mediaState.segmentIterator should exist"),T.yield(E.aes128Decrypt_(d,r,s),9);case 9:d=T.yieldResult;case 8:return E.destroyer_.ensureNotDestroyed(),e.waitingToClearBuffer?(shaka.log.info(i,"waitingToClearBuffer, skip append"),e.performingUpdate=!1,E.scheduleUpdate_(e,0),T.return()):T.yield(E.append_(e,t,o,r,d),6);case 11:if(y=T.yieldResult,f){T.jumpTo(6);break}return h=!0,E.destroyer_.ensureNotDestroyed(),E.fatalError_?T.return():e.waitingToClearBuffer?(shaka.log.info(i,"waitingToClearBuffer, skip append"),e.performingUpdate=!1,E.scheduleUpdate_(e,0),T.return()):T.yield(E.append_(e,t,o,r,y),6);case 6:if(E.destroyer_.ensureNotDestroyed(),E.fatalError_)return T.return();e.lastSegmentReference=r,m=s.next().value,shaka.log.v2(i,"advancing to next segment",m),e.performingUpdate=!1,e.recovering=!1,v=E.playerInterface_.mediaSourceEngine.getBufferedInfo(),_=v[e.type],shaka.log.v1(i,"finished fetch and append",JSON.stringify(_)),e.waitingToClearBuffer||E.playerInterface_.onSegmentAppended(r.startTime,r.endTime,e.type),E.scheduleUpdate_(e,0),T.leaveTryBlock(0);break;case 2:if(k=T.enterCatchBlock(),E.destroyer_.ensureNotDestroyed(k),E.fatalError_)return T.return();if(goog.asserts.assert(k instanceof shaka.util.Error,"Should only receive a Shaka error"),e.performingUpdate=!1,k.code==shaka.util.Error.Code.OPERATION_ABORTED)e.performingUpdate=!1,E.cancelUpdate_(e),E.scheduleUpdate_(e,0),T.jumpTo(0);else if(e.type==a.TEXT&&E.config_.ignoreTextStreamFailures)k.code==shaka.util.Error.Code.BAD_HTTP_STATUS?shaka.log.warning(i,"Text stream failed to download. Proceeding without it."):shaka.log.warning(i,"Text stream failed to parse. Proceeding without it."),E.mediaStates_.delete(a.TEXT),T.jumpTo(0);else{if(k.code!=shaka.util.Error.Code.QUOTA_EXCEEDED_ERROR)return shaka.log.error(i,"failed fetch and append: code="+k.code),e.hasError=!0,k.severity=shaka.util.Error.Severity.CRITICAL,T.yield(E.handleStreamingError_(k),0);E.handleQuotaExceeded_(e,k),T.jumpTo(0)}}}))},shaka.media.StreamingEngine.prototype.aes128Decrypt_=function(e,t,r){var a,n,i,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){if(1==s.nextAddress)return(a=t.hlsAes128Key).cryptoKey?s.jumpTo(2):(goog.asserts.assert(a.fetchKey,"If AES-128 cryptoKey was not preloaded, fetchKey function should be provided"),s.yield(a.fetchKey(),3));if(2!=s.nextAddress&&goog.asserts.assert(a.cryptoKey,"AES-128 cryptoKey should now be set"),!(n=a.iv))for(n=shaka.util.BufferUtils.toUint8(new ArrayBuffer(16)),i=a.firstMediaSequenceNumber+r.currentPosition(),o=n.byteLength-1;0<=o;o--)n[o]=255&i,i>>=8;return s.return(window.crypto.subtle.decrypt({name:"AES-CBC",iv:n},a.cryptoKey,e))}))},shaka.media.StreamingEngine.prototype.retry=function(e){if(this.destroyer_.destroyed())return shaka.log.error("Unable to retry after StreamingEngine is destroyed!"),!1;if(this.fatalError_)return shaka.log.error("Unable to retry after StreamingEngine encountered a fatal error!"),!1;for(var t=$jscomp.makeIterator(this.mediaStates_.values()),r=t.next();!r.done;r=t.next()){r=r.value;var a=shaka.media.StreamingEngine.logPrefix_(r);!r.hasError||r.performingUpdate||r.updateTimer||(shaka.log.info(a,"Retrying after failure..."),r.hasError=!1,this.scheduleUpdate_(r,e))}return!0},shaka.media.StreamingEngine.prototype.concatArray_=function(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r},shaka.media.StreamingEngine.prototype.handleQuotaExceeded_=function(e,t){var r=shaka.media.StreamingEngine.logPrefix_(e);if(Array.from(this.mediaStates_.values()).some((function(t){return t!=e&&t.recovering})))shaka.log.debug(r,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var a=Math.round(100*this.bufferingGoalScale_);if(20<a)this.bufferingGoalScale_-=.2;else{if(!(4<a))return shaka.log.error(r,"MediaSource threw QuotaExceededError too many times"),this.fatalError_=e.hasError=!0,void this.playerInterface_.onError(t);this.bufferingGoalScale_-=.04}shaka.log.warning(r,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*this.bufferingGoalScale_))+"%"),e.recovering=!0}this.scheduleUpdate_(e,4)},shaka.media.StreamingEngine.prototype.initSourceBuffer_=function(e,t){var r,a,n,i,o,s,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){return r=shaka.media.StreamingEngine,a=r.logPrefix_(e),n=[],i=Math.max(0,t.appendWindowStart-r.APPEND_WINDOW_START_FUDGE_),o=t.appendWindowEnd+r.APPEND_WINDOW_END_FUDGE_,goog.asserts.assert(t.startTime<=o,a+" segment should start before append window end"),(s=t.timestampOffset)==e.lastTimestampOffset&&i==e.lastAppendWindowStart&&o==e.lastAppendWindowEnd||(shaka.log.v1(a,"setting timestamp offset to "+s),shaka.log.v1(a,"setting append window start to "+i),shaka.log.v1(a,"setting append window end to "+o),l=function(){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.setCatchFinallyBlocks(2),e.lastAppendWindowStart=i,e.lastAppendWindowEnd=o,e.lastTimestampOffset=s,r.yield(p.playerInterface_.mediaSourceEngine.setStreamProperties(e.type,s,i,o,p.manifest_.sequenceMode),4);if(2!=r.nextAddress)return r.leaveTryBlock(0);throw t=r.enterCatchBlock(),e.lastAppendWindowStart=null,e.lastAppendWindowEnd=null,e.lastTimestampOffset=null,t}))},n.push(l())),!shaka.media.InitSegmentReference.equal(t.initSegmentReference,e.lastInitSegmentReference)&&(e.lastInitSegmentReference=t.initSegmentReference)&&(shaka.log.v1(a,"fetching init segment"),u=p.fetch_(e,t.initSegmentReference),c=function(){var r,n,i,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:return l.setCatchFinallyBlocks(2),l.yield(u,4);case 4:return r=l.yieldResult,p.destroyer_.ensureNotDestroyed(),n=new shaka.util.Mp4Parser,i=shaka.util.Mp4Parser,n.box("moov",i.children).box("trak",i.children).box("mdia",i.children).fullBox("mdhd",(function(e){p.parseMDHD_(t,e)})).parse(r),shaka.log.v1(a,"appending init segment"),o=e.stream.closedCaptions&&0<e.stream.closedCaptions.size,l.yield(p.playerInterface_.beforeAppendSegment(e.type,r),5);case 5:return l.yield(p.playerInterface_.mediaSourceEngine.appendBuffer(e.type,r,null,o),6);case 6:l.leaveTryBlock(0);break;case 2:throw s=l.enterCatchBlock(),e.lastInitSegmentReference=null,s}}))},p.playerInterface_.onInitSegmentAppended(t.startTime,t.initSegmentReference),n.push(c())),p.manifest_.sequenceMode&&(d=e.lastSegmentReference?e.lastSegmentReference.discontinuitySequence:null,t.discontinuitySequence!=d||e.needsResync)&&(e.needsResync=!1,n.push(p.playerInterface_.mediaSourceEngine.resync(e.type,t.startTime))),h.yield(Promise.all(n),0)}))},shaka.media.StreamingEngine.prototype.append_=function(e,t,r,a,n){var i,o,s,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){switch(h.nextAddress){case 1:return i=shaka.media.StreamingEngine.logPrefix_(e),o=r.closedCaptions&&0<r.closedCaptions.size,l=null!=r.emsgSchemeIdUris&&0<r.emsgSchemeIdUris.length||p.config_.dispatchAllEmsgBoxes,u=p.config_.parsePrftBox&&!p.parsedPrftEventRaised_,(l||u)&&(s=new shaka.util.Mp4Parser),l&&s.fullBox("emsg",(function(e){return p.parseEMSG_(a,r.emsgSchemeIdUris,e)})),u&&s.fullBox("prft",(function(e){return p.parsePrft_(a,e)})),(l||u)&&s.parse(n),h.yield(p.evict_(e,t),2);case 2:return p.destroyer_.ensureNotDestroyed(),c=e.seeked,e.seeked=!1,d=e.adaptation,e.adaptation=!1,h.yield(p.playerInterface_.beforeAppendSegment(e.type,n),3);case 3:return h.yield(p.playerInterface_.mediaSourceEngine.appendBuffer(e.type,n,a,o,c,d),4);case 4:p.destroyer_.ensureNotDestroyed(),shaka.log.v2(i,"appended media segment"),h.jumpToEnd()}}))},shaka.media.StreamingEngine.prototype.parseEMSG_=function(e,t,r){if(0===r.version)var a=r.reader.readTerminatedString(),n=r.reader.readTerminatedString(),i=r.reader.readUint32(),o=r.reader.readUint32(),s=r.reader.readUint32(),l=r.reader.readUint32(),u=e.startTime+o/i;else i=r.reader.readUint32(),o=(u=r.reader.readUint64()/i+e.timestampOffset)-e.startTime,s=r.reader.readUint32(),l=r.reader.readUint32(),a=r.reader.readTerminatedString(),n=r.reader.readTerminatedString();r=r.reader.readBytes(r.reader.getLength()-r.reader.getPosition()),(t&&t.includes(a)||this.config_.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==a?this.playerInterface_.onManifestUpdate():"https://aomedia.org/emsg/ID3"==a?(t=shaka.util.Id3Utils.getID3Frames(r)).length&&e&&this.playerInterface_.onMetadata([{cueTime:e.startTime,data:r,frames:t,dts:e.startTime,pts:e.startTime}],0,e.endTime):(t={startTime:u,endTime:u+s/i,schemeIdUri:a,value:n,timescale:i,presentationTimeDelta:o,eventDuration:s,id:l,messageData:r},e=shaka.util.FakeEvent.EventName.Emsg,t=(new Map).set("detail",t),e=new shaka.util.FakeEvent(e,t),this.playerInterface_.onEvent(e)))},shaka.media.StreamingEngine.prototype.parseMDHD_=function(e,t){t=shaka.util.Mp4BoxParsers.parseMDHD(t.reader||0,t.version||0),e.initSegmentReference.timescale=t.timescale},shaka.media.StreamingEngine.prototype.parsePrft_=function(e,t){if(!this.parsedPrftEventRaised_&&e.initSegmentReference.timescale){t.reader.readUint32();var r=t.reader.readUint32();if(r=1e3*r+t.reader.readUint32()/Math.pow(2,32)*1e3,0===t.version)var a=t.reader.readUint32();else try{a=t.reader.readUint64()}catch(e){return shaka.log.warning("parsePrft_: parsing mediatime resulted in a MEDIA.JS_INTEGER_OVERFLOW exception"),void(this.parsedPrftEventRaised_=!0)}e=e.initSegmentReference.timescale,e={wallClockTime:t=this.convertNtp(r),programStartDate:new Date(t-a/e*1e3)},a=shaka.util.FakeEvent.EventName.Prft,e=(new Map).set("detail",e),a=new shaka.util.FakeEvent(a,e),this.playerInterface_.onEvent(a),this.parsedPrftEventRaised_=!0}},shaka.media.StreamingEngine.prototype.convertNtp=function(e){var t=new Date(Date.UTC(1900,0,1,0,0,0));return new Date(t.getTime()+e).getTime()},shaka.media.StreamingEngine.prototype.evict_=function(e,t){var r,a,n,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress)return r=shaka.media.StreamingEngine.logPrefix_(e),shaka.log.v2(r,"checking buffer length"),a=Math.max(s.config_.bufferBehind,s.manifest_.presentationTimeline.getMaxSegmentDuration()),null==(n=s.playerInterface_.mediaSourceEngine.bufferStart(e.type))?(shaka.log.v2(r,"buffer behind okay because nothing buffered:","presentationTime="+t,"bufferBehind="+a),l.return()):.01>=(o=(i=t-n)-a)?(shaka.log.v2(r,"buffer behind okay:","presentationTime="+t,"bufferedBehind="+i,"bufferBehind="+a,"underflow="+Math.abs(o)),l.return()):(shaka.log.v1(r,"buffer behind too large:","presentationTime="+t,"bufferedBehind="+i,"bufferBehind="+a,"overflow="+o),l.yield(s.playerInterface_.mediaSourceEngine.remove(e.type,n,n+o),2));s.destroyer_.ensureNotDestroyed(),shaka.log.v1(r,"evicted "+o+" seconds"),l.jumpToEnd()}))},shaka.media.StreamingEngine.isEmbeddedText_=function(e){var t=shaka.util.MimeUtils,r=t.CEA608_CLOSED_CAPTION_MIMETYPE;return t=t.CEA708_CLOSED_CAPTION_MIMETYPE,e&&e.type==shaka.util.ManifestParserUtils.ContentType.TEXT&&(e.stream.mimeType==r||e.stream.mimeType==t)},shaka.media.StreamingEngine.prototype.fetch_=function(e,t,r){var a,n,i,o,s,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){return 1==u.nextAddress?(a=shaka.net.NetworkingEngine.RequestType.SEGMENT,n=shaka.util.Networking.createSegmentRequest(t.getUris(),t.startByte,t.endByte,l.config_.retryParameters,r),shaka.log.v2("fetching: reference=",t),i=e.stream,l.playerInterface_.modifySegmentRequest(n,{type:i.type,init:t instanceof shaka.media.InitSegmentReference,duration:t.endTime-t.startTime,mimeType:i.mimeType,codecs:i.codecs,bandwidth:i.bandwidth}),o=l.playerInterface_.netEngine.request(a,n),e.operation=o,u.yield(o.promise,2)):(s=u.yieldResult,e.operation=null,u.return(s.data))}))},shaka.media.StreamingEngine.prototype.clearBuffer_=function(e,t,r){var a,n,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(a=shaka.media.StreamingEngine.logPrefix_(e),goog.asserts.assert(!e.performingUpdate&&null==e.updateTimer,a+" unexpected call to clearBuffer_()"),e.waitingToClearBuffer=!1,e.waitingToFlushBuffer=!1,e.clearBufferSafeMargin=0,e.clearingBuffer=!0,e.lastSegmentReference=null,e.lastInitSegmentReference=null,e.segmentIterator=null,shaka.log.debug(a,"clearing buffer"),r?(n=o.playerInterface_.getPresentationTime(),i=o.playerInterface_.mediaSourceEngine.getDuration(),s.yield(o.playerInterface_.mediaSourceEngine.remove(e.type,n+r,i),3)):s.yield(o.playerInterface_.mediaSourceEngine.clear(e.type),4)):3!=s.nextAddress?(o.destroyer_.ensureNotDestroyed(),t?s.yield(o.playerInterface_.mediaSourceEngine.flush(e.type),3):s.jumpTo(3)):(o.destroyer_.ensureNotDestroyed(),shaka.log.debug(a,"cleared buffer"),e.clearingBuffer=!1,e.endOfStream=!1,e.performingUpdate||e.updateTimer||o.scheduleUpdate_(e,0),void s.jumpToEnd())}))},shaka.media.StreamingEngine.prototype.scheduleUpdate_=function(e,t){var r=this,a=shaka.media.StreamingEngine.logPrefix_(e),n=e.type;n!=shaka.util.ManifestParserUtils.ContentType.TEXT||this.mediaStates_.has(n)?(shaka.log.v2(a,"updating in "+t+" seconds"),goog.asserts.assert(null==e.updateTimer,a+" did not expect update to be scheduled"),e.updateTimer=new shaka.util.DelayedTick((function(){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(a.setCatchFinallyBlocks(2),a.yield(r.onUpdate_(e),4)):2!=a.nextAddress?a.leaveTryBlock(0):(t=a.enterCatchBlock(),r.playerInterface_&&r.playerInterface_.onError(t),void a.jumpToEnd())}))})).tickAfter(t)):shaka.log.v1(a,"Text stream is unloaded. No update is needed.")},shaka.media.StreamingEngine.prototype.cancelUpdate_=function(e){null!=e.updateTimer&&(e.updateTimer.stop(),e.updateTimer=null)},shaka.media.StreamingEngine.prototype.abortOperations_=function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return e.operation?t.yield(e.operation.abort(),0):t.jumpTo(0)}))},shaka.media.StreamingEngine.prototype.handleStreamingError_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(t.failureCallbackBackoff_.attempt(),2);t.destroyer_.ensureNotDestroyed(),t.playerInterface_.onError(e),e.handled||t.config_.failureCallback(e),r.jumpToEnd()}))},shaka.media.StreamingEngine.logPrefix_=function(e){return"("+e.type+":"+e.stream.id+")"},shaka.media.StreamingEngine.APPEND_WINDOW_START_FUDGE_=.1,shaka.media.StreamingEngine.APPEND_WINDOW_END_FUDGE_=.01,shaka.media.StreamingEngine.MAX_RUN_AHEAD_SEGMENTS_=1,shaka.routing={},shaka.routing.Node={},shaka.routing.Payload={},shaka.routing.Walker=function(e,t,r){var a=this;this.implementation_=r,this.currentlyAt_=e,this.currentlyWith_=t,this.waitForWork_=null,this.requests_=[],this.currentStep_=this.currentRoute_=null,this.mainLoopPromise_=Promise.resolve().then((function(){return a.mainLoop_()})),this.destroyer_=new shaka.util.Destroyer((function(){return a.doDestroy_()}))},shaka.routing.Walker.prototype.getCurrentPayload=function(){return this.currentlyWith_},shaka.routing.Walker.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.routing.Walker.prototype.doDestroy_=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return r.currentStep_&&r.currentStep_.abort(),r.unblockMainLoop_(),a.yield(r.mainLoopPromise_,2);for(r.currentRoute_&&r.currentRoute_.listeners.onCancel(),e=$jscomp.makeIterator(r.requests_),t=e.next();!t.done;t=e.next())t.value.listeners.onCancel();r.currentRoute_=null,r.requests_=[],r.implementation_=null,a.jumpToEnd()}))},shaka.routing.Walker.prototype.startNewRoute=function(e){var t={onStart:function(){},onEnd:function(){},onCancel:function(){},onError:function(e){},onSkip:function(){},onEnter:function(){}};return this.requests_.push({create:e,listeners:t}),this.currentStep_&&this.currentStep_.abort(),this.unblockMainLoop_(),t},shaka.routing.Walker.prototype.mainLoop_=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return e.destroyer_.destroyed()?t.jumpTo(0):t.yield(e.doOneThing_(),1)}))},shaka.routing.Walker.prototype.doOneThing_=function(){return this.tryNewRoute_()?Promise.resolve():this.currentRoute_?this.takeNextStep_():(goog.asserts.assert(null==this.waitForWork_,"We should not have a promise yet."),this.implementation_.onIdle(this.currentlyAt_),this.waitForWork_=new shaka.util.PublicPromise)},shaka.routing.Walker.prototype.tryNewRoute_=function(){if(goog.asserts.assert(null==this.currentStep_,"We should never have a current step between taking steps."),0==this.requests_.length||this.currentRoute_&&!this.currentRoute_.interruptible)return!1;this.currentRoute_&&(this.currentRoute_.listeners.onCancel(),this.currentRoute_=null);var e=this.requests_.shift(),t=e.create(this.currentlyWith_);return t?(e.listeners.onStart(),this.currentRoute_={node:t.node,payload:t.payload,interruptible:t.interruptible,listeners:e.listeners}):e.listeners.onSkip(),!0},shaka.routing.Walker.prototype.takeNextStep_=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){switch(a.nextAddress){case 1:return goog.asserts.assert(r.currentRoute_,"We need a current route to take the next step."),r.currentlyAt_=r.implementation_.getNext(r.currentlyAt_,r.currentlyWith_,r.currentRoute_.node,r.currentRoute_.payload),r.currentRoute_.listeners.onEnter(r.currentlyAt_),a.setCatchFinallyBlocks(2),r.currentStep_=r.implementation_.enterNode(r.currentlyAt_,r.currentlyWith_,r.currentRoute_.payload),a.yield(r.currentStep_.promise,4);case 4:r.currentStep_=null,r.currentlyAt_==r.currentRoute_.node&&(r.currentRoute_.listeners.onEnd(),r.currentRoute_=null),a.leaveTryBlock(0);break;case 2:return(e=a.enterCatchBlock()).code==shaka.util.Error.Code.OPERATION_ABORTED?(goog.asserts.assert(r.currentRoute_.interruptible,"Do not put abortable steps in non-interruptible routes!"),r.currentRoute_.listeners.onCancel()):r.currentRoute_.listeners.onError(e),r.currentRoute_=null,r.currentStep_=null,t=r,a.yield(r.implementation_.handleError(r.currentlyWith_,e),5);case 5:t.currentlyAt_=a.yieldResult,a.jumpToEnd()}}))},shaka.routing.Walker.prototype.unblockMainLoop_=function(){this.waitForWork_&&(this.waitForWork_.resolve(),this.waitForWork_=null)},shaka.text.Utils=function(){},shaka.text.Utils.flattenPayload_=function(e){var t=[],r=e.fontWeight>=shaka.text.Cue.fontWeight.BOLD,a=e.fontStyle==shaka.text.Cue.fontStyle.ITALIC,n=e.textDecoration.includes(shaka.text.Cue.textDecoration.UNDERLINE);return r&&t.push("b"),a&&t.push("i"),n&&t.push("u"),r=t.reduce((function(e,t){return e+"<"+t+">"}),""),t=t.reduceRight((function(e,t){return e+"</"+t+">"}),""),e.lineBreak?"\n":e.nestedCues.length?e.nestedCues.map(shaka.text.Utils.flattenPayload_).join(""):r+e.payload+t},shaka.text.Utils.getCuesToFlatten=function(e,t){for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if((r=r.value).isContainer)shaka.text.Utils.getCuesToFlatten(r.nestedCues,t);else{var a=r.clone();a.nestedCues=[],a.payload=shaka.text.Utils.flattenPayload_(r),t.push(a)}return t},shaka.text.SimpleTextDisplayer=function(e){this.textTrack_=null;for(var t=$jscomp.makeIterator(Array.from(e.textTracks)),r=t.next();!r.done;r=t.next())(r=r.value).mode="disabled",r.label==shaka.Player.TextTrackLabel&&(this.textTrack_=r);this.textTrack_||(this.textTrack_=e.addTextTrack("subtitles",shaka.Player.TextTrackLabel)),this.textTrack_.mode="hidden"},shaka.text.SimpleTextDisplayer.prototype.remove=function(e,t){return!!this.textTrack_&&(shaka.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,(function(r){return r.startTime<t&&r.endTime>e})),!0)},shaka.text.SimpleTextDisplayer.prototype.append=function(e){var t=shaka.text.Utils.getCuesToFlatten(e,[]),r=[];e=this.textTrack_.cues?Array.from(this.textTrack_.cues):[];for(var a={},n=(t=$jscomp.makeIterator(t)).next();!n.done;a={$jscomp$loop$prop$inCue$653:a.$jscomp$loop$prop$inCue$653},n=t.next())a.$jscomp$loop$prop$inCue$653=n.value,e.some(function(e){return function(t){return t.startTime==e.$jscomp$loop$prop$inCue$653.startTime&&t.endTime==e.$jscomp$loop$prop$inCue$653.endTime&&t.text==e.$jscomp$loop$prop$inCue$653.payload}}(a))||(n=shaka.text.SimpleTextDisplayer.convertToTextTrackCue_(a.$jscomp$loop$prop$inCue$653))&&r.push(n);for(e=r.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?r.indexOf(t)-r.indexOf(e):r.indexOf(e)-r.indexOf(t)})),a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())this.textTrack_.addCue(a.value)},shaka.text.SimpleTextDisplayer.prototype.destroy=function(){return this.textTrack_&&(shaka.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,(function(e){return!0})),this.textTrack_.mode="disabled"),this.textTrack_=null,Promise.resolve()},shaka.text.SimpleTextDisplayer.prototype.isTextVisible=function(){return"showing"==this.textTrack_.mode},shaka.text.SimpleTextDisplayer.prototype.setTextVisibility=function(e){this.textTrack_.mode=e?"showing":"hidden"},shaka.text.SimpleTextDisplayer.convertToTextTrackCue_=function(e){if(e.startTime>=e.endTime)return shaka.log.warning("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=shaka.text.Cue,r=new VTTCue(e.startTime,e.endTime,e.payload);r.lineAlign=e.lineAlign,r.positionAlign=e.positionAlign,e.size&&(r.size=e.size);try{r.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=r.align&&(r.align="middle"),e.writingMode==t.writingMode.VERTICAL_LEFT_TO_RIGHT?r.vertical="lr":e.writingMode==t.writingMode.VERTICAL_RIGHT_TO_LEFT&&(r.vertical="rl"),e.lineInterpretation==t.lineInterpretation.PERCENTAGE&&(r.snapToLines=!1),null!=e.line&&(r.line=e.line),null!=e.position&&(r.position=e.position),r},shaka.text.SimpleTextDisplayer.removeWhere_=function(e,t){var r=e.mode,a="showing"==r?"showing":"hidden";e.mode=a,goog.asserts.assert(e.cues,'Cues should be accessible when mode is set to "'+a+'".');for(var n=(a=$jscomp.makeIterator(Array.from(e.cues))).next();!n.done;n=a.next())(n=n.value)&&t(n)&&e.removeCue(n);e.mode=r},goog.exportSymbol("shaka.text.SimpleTextDisplayer",shaka.text.SimpleTextDisplayer),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"setTextVisibility",shaka.text.SimpleTextDisplayer.prototype.setTextVisibility),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"isTextVisible",shaka.text.SimpleTextDisplayer.prototype.isTextVisible),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"destroy",shaka.text.SimpleTextDisplayer.prototype.destroy),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"append",shaka.text.SimpleTextDisplayer.prototype.append),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"remove",shaka.text.SimpleTextDisplayer.prototype.remove),shaka.util.Dom=function(){},shaka.util.Dom.createHTMLElement=function(e){return document.createElement(e)},shaka.util.Dom.createButton=function(){var e=document.createElement("button");return e.setAttribute("type","button"),e},shaka.util.Dom.asHTMLElement=function(e){return e},shaka.util.Dom.asHTMLMediaElement=function(e){return e},shaka.util.Dom.getElementByClassName=function(e,t){return t=t.getElementsByClassName(e),goog.asserts.assert(1==t.length,"Should only be one element with class name "+e),shaka.util.Dom.asHTMLElement(t[0])},shaka.util.Dom.removeAllChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},goog.exportSymbol("shaka.util.Dom",shaka.util.Dom),goog.exportProperty(shaka.util.Dom,"removeAllChildren",shaka.util.Dom.removeAllChildren),shaka.text.UITextDisplayer=function(e,t){var r=this;goog.asserts.assert(t,"videoContainer should be valid."),this.isTextVisible_=!1,this.cues_=[],this.video_=e,this.videoContainer_=t,this.textContainer_=shaka.util.Dom.createHTMLElement("div"),this.textContainer_.classList.add("shaka-text-container"),this.textContainer_.style.textAlign="center",this.textContainer_.style.display="flex",this.textContainer_.style.flexDirection="column",this.textContainer_.style.alignItems="center",this.textContainer_.style.justifyContent="flex-end",this.videoContainer_.appendChild(this.textContainer_),this.captionsTimer_=new shaka.util.Timer((function(){r.updateCaptions_()})).tickEvery(.25),this.currentCuesMap_=new Map,this.eventManager_=new shaka.util.EventManager,this.eventManager_.listen(document,"fullscreenchange",(function(){r.updateCaptions_(!0)})),this.resizeObserver_=null,"ResizeObserver"in window&&(this.resizeObserver_=new ResizeObserver((function(){r.updateCaptions_(!0)})),this.resizeObserver_.observe(this.textContainer_)),this.regionElements_=new Map},shaka.text.UITextDisplayer.prototype.append=function(e){for(var t=[].concat($jscomp.arrayFromIterable(this.cues_)),r={},a=(e=$jscomp.makeIterator(e)).next();!a.done;r={$jscomp$loop$prop$cue$655:r.$jscomp$loop$prop$cue$655},a=e.next())r.$jscomp$loop$prop$cue$655=a.value,t.some(function(e){return function(t){return shaka.text.Cue.equal(t,e.$jscomp$loop$prop$cue$655)}}(r))||this.cues_.push(r.$jscomp$loop$prop$cue$655);this.updateCaptions_()},shaka.text.UITextDisplayer.prototype.destroy=function(){this.videoContainer_.removeChild(this.textContainer_),this.textContainer_=null,this.isTextVisible_=!1,this.cues_=[],this.captionsTimer_&&this.captionsTimer_.stop(),this.currentCuesMap_.clear(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null)},shaka.text.UITextDisplayer.prototype.remove=function(e,t){if(!this.textContainer_)return!1;var r=this.cues_.length;return this.cues_=this.cues_.filter((function(r){return r.startTime<e||r.endTime>=t})),this.updateCaptions_(r>this.cues_.length),!0},shaka.text.UITextDisplayer.prototype.isTextVisible=function(){return this.isTextVisible_},shaka.text.UITextDisplayer.prototype.setTextVisibility=function(e){this.isTextVisible_=e},shaka.text.UITextDisplayer.prototype.isElementUnderTextContainer_=function(e){for(;null!=e;){if(e==this.textContainer_)return!0;e=e.parentElement}return!1},shaka.text.UITextDisplayer.prototype.updateCuesRecursive_=function(e,t,r,a){for(var n=!1,i=[],o=[],s=(e=$jscomp.makeIterator(e)).next();!s.done;s=e.next()){s=s.value,a.push(s);var l=this.currentCuesMap_.get(s),u=s.startTime<=r&&s.endTime>r,c=l?l.wrapper:null;l&&(i.push(l.cueElement),l.regionElement&&i.push(l.regionElement),u||(n=!0,this.currentCuesMap_.delete(s),l=null)),u&&(o.push(s),l?this.isElementUnderTextContainer_(c)||(n=!0):(this.createCue_(s,a),c=(l=this.currentCuesMap_.get(s)).wrapper,n=!0)),0<s.nestedCues.length&&c&&this.updateCuesRecursive_(s.nestedCues,c,r,a),l=a.pop(),goog.asserts.assert(l==s,"Parent cues should be kept in order")}if(n){for(a=(r=$jscomp.makeIterator(i)).next();!a.done;a=r.next())(a=a.value).parentElement&&a.parentElement.removeChild(a);for(o.sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime})),s=(o=$jscomp.makeIterator(o)).next();!s.done;s=o.next())r=this.currentCuesMap_.get(s.value),goog.asserts.assert(r,"cueRegistry should exist."),r.regionElement?(t.appendChild(r.regionElement),r.regionElement.appendChild(r.cueElement)):t.appendChild(r.cueElement)}},shaka.text.UITextDisplayer.prototype.updateCaptions_=function(e){if(this.textContainer_){var t=this.video_.currentTime;if(!this.isTextVisible_||void 0!==e&&e){for(var r=(e=$jscomp.makeIterator(this.regionElements_.values())).next();!r.done;r=e.next())shaka.util.Dom.removeAllChildren(r.value);shaka.util.Dom.removeAllChildren(this.textContainer_),this.currentCuesMap_.clear(),this.regionElements_.clear()}if(this.isTextVisible_){e=new Map;for(var a=(r=$jscomp.makeIterator(this.currentCuesMap_.keys())).next();!a.done;a=r.next())a=a.value,e.set(a,this.currentCuesMap_.get(a));if(this.updateCuesRecursive_(this.cues_,this.textContainer_,t,[]),goog.DEBUG)for(a=(t=$jscomp.makeIterator(e.keys())).next();!a.done;a=t.next())r=a.value,this.currentCuesMap_.has(r)||(r=e.get(r).cueElement,goog.asserts.assert(!r.parentNode,"Cue was not properly removed!"))}}},shaka.text.UITextDisplayer.prototype.generateRegionId_=function(e){var t=shaka.text.CueRegion.units.PERCENTAGE;return e.id+"_"+e.width+"x"+e.height+(e.heightUnits==t?"%":"px")+"-"+e.viewportAnchorX+"x"+e.viewportAnchorY+(e.viewportAnchorUnits==t?"%":"px")},shaka.text.UITextDisplayer.prototype.getRegionElement_=function(e){var t=e.region,r=this.generateRegionId_(t);if(this.regionElements_.has(r))return this.regionElements_.get(r);var a=shaka.util.Dom.createHTMLElement("span"),n=shaka.text.CueRegion.units.PERCENTAGE,i=t.heightUnits==n?"%":"px",o=t.widthUnits==n?"%":"px";return n=t.viewportAnchorUnits==n?"%":"px",a.id="shaka-text-region---"+r,a.classList.add("shaka-text-region"),a.style.height=t.height+i,a.style.width=t.width+o,a.style.position="absolute",a.style.top=t.viewportAnchorY+n,a.style.left=t.viewportAnchorX+n,a.style.display="flex",a.style.flexDirection="column",a.style.alignItems="center",a.style.justifyContent=e.displayAlign==shaka.text.Cue.displayAlign.BEFORE?"flex-start":e.displayAlign==shaka.text.Cue.displayAlign.CENTER?"center":"flex-end",this.regionElements_.set(r,a),a},shaka.text.UITextDisplayer.prototype.createCue_=function(e,t){var r=1<t.length,a=r?"span":"div";e.lineBreak&&(a="br"),r=!r&&0<e.nestedCues.length;var n=shaka.util.Dom.createHTMLElement(a);"br"!=a&&this.setCaptionStyles_(n,e,t,r),t=null,e.region&&e.region.id&&(t=this.getRegionElement_(e)),a=n,r&&((a=shaka.util.Dom.createHTMLElement("span")).classList.add("shaka-text-wrapper"),a.style.backgroundColor=e.backgroundColor,a.style.lineHeight="normal",n.appendChild(a)),this.currentCuesMap_.set(e,{cueElement:n,wrapper:a,regionElement:t})},shaka.text.UITextDisplayer.prototype.setCaptionStyles_=function(e,t,r,a){var n=shaka.text.Cue,i=e.style,o=0==t.nestedCues.length,s=1<r.length;i.whiteSpace="pre-wrap";var l=t.payload.replace(/\s+$/g,(function(e){return" ".repeat(e.length)}));if(i.webkitTextStrokeColor=t.textStrokeColor,i.webkitTextStrokeWidth=t.textStrokeWidth,i.color=t.color,i.direction=t.direction,i.opacity=t.opacity,i.paddingLeft=shaka.text.UITextDisplayer.convertLengthValue_(t.linePadding,t,this.videoContainer_),i.paddingRight=shaka.text.UITextDisplayer.convertLengthValue_(t.linePadding,t,this.videoContainer_),i.textShadow=t.textShadow,t.backgroundImage)i.backgroundImage="url('"+t.backgroundImage+"')",i.backgroundRepeat="no-repeat",i.backgroundSize="contain",i.backgroundPosition="center",i.width="100%",i.height="100%";else{if(t.nestedCues.length)var u=e;else u=shaka.util.Dom.createHTMLElement("span"),e.appendChild(u);t.border&&(u.style.border=t.border),a||((e=shaka.text.UITextDisplayer.inheritProperty_(r,(function(e){return e.backgroundColor})))?u.style.backgroundColor=e:l&&(u.style.backgroundColor="rgba(0, 0, 0, 0.8)")),l&&(u.textContent=l)}s&&!r[r.length-1].isContainer?i.display="inline":(i.display="flex",i.flexDirection="column",i.alignItems="center",i.justifyContent=t.displayAlign==n.displayAlign.BEFORE?"flex-start":t.displayAlign==n.displayAlign.CENTER?"center":"flex-end"),o||(i.margin="0"),i.fontFamily=t.fontFamily,i.fontWeight=t.fontWeight.toString(),i.fontStyle=t.fontStyle,i.letterSpacing=t.letterSpacing,i.fontSize=shaka.text.UITextDisplayer.convertLengthValue_(t.fontSize,t,this.videoContainer_),null!=t.line&&t.lineInterpretation==n.lineInterpretation.PERCENTAGE&&(i.position="absolute",t.writingMode==n.writingMode.HORIZONTAL_TOP_TO_BOTTOM?(i.width="100%",t.lineAlign==n.lineAlign.START?i.top=t.line+"%":t.lineAlign==n.lineAlign.END&&(i.bottom=100-t.line+"%")):t.writingMode==n.writingMode.VERTICAL_LEFT_TO_RIGHT?(i.height="100%",t.lineAlign==n.lineAlign.START?i.left=t.line+"%":t.lineAlign==n.lineAlign.END&&(i.right=100-t.line+"%")):(i.height="100%",t.lineAlign==n.lineAlign.START?i.right=t.line+"%":t.lineAlign==n.lineAlign.END&&(i.left=100-t.line+"%"))),i.lineHeight=t.lineHeight,null!=t.position&&(t.writingMode==n.writingMode.HORIZONTAL_TOP_TO_BOTTOM?i.paddingLeft=t.position:i.paddingTop=t.position),t.positionAlign==n.positionAlign.LEFT?i.cssFloat="left":t.positionAlign==n.positionAlign.RIGHT&&(i.cssFloat="right"),i.textAlign=t.textAlign,i.textDecoration=t.textDecoration.join(" "),i.writingMode=t.writingMode,"writingMode"in document.documentElement.style&&i.writingMode==t.writingMode||(i.webkitWritingMode=t.writingMode),t.size&&(t.writingMode==n.writingMode.HORIZONTAL_TOP_TO_BOTTOM?i.width=t.size+"%":i.height=t.size+"%")},shaka.text.UITextDisplayer.getLengthValueInfo_=function(e){return(e=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(e[1]),unit:e[2]}:null},shaka.text.UITextDisplayer.convertLengthValue_=function(e,t,r){var a=shaka.text.UITextDisplayer.getLengthValueInfo_(e);if(!a)return e;var n=a.value;switch(a.unit){case"%":return shaka.text.UITextDisplayer.getAbsoluteLengthInPixels_(n/100,t,r);case"c":return shaka.text.UITextDisplayer.getAbsoluteLengthInPixels_(n,t,r);default:return e}},shaka.text.UITextDisplayer.getAbsoluteLengthInPixels_=function(e,t,r){return r.clientHeight*e/t.cellResolution.rows+"px"},shaka.text.UITextDisplayer.inheritProperty_=function(e,t){for(var r=e.length-1;0<=r;r--){var a=t(e[r]);if(a||0===a)return a}return null},goog.exportSymbol("shaka.text.UITextDisplayer",shaka.text.UITextDisplayer),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"setTextVisibility",shaka.text.UITextDisplayer.prototype.setTextVisibility),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"isTextVisible",shaka.text.UITextDisplayer.prototype.isTextVisible),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"remove",shaka.text.UITextDisplayer.prototype.remove),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"destroy",shaka.text.UITextDisplayer.prototype.destroy),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"append",shaka.text.UITextDisplayer.prototype.append),shaka.text.WebVttGenerator=function(){},shaka.text.WebVttGenerator.convert=function(e,t){var r=function(e){for(var r=e,a=$jscomp.makeIterator(t),n=a.next();!n.done;n=a.next())(n=n.value).end&&n.start<e&&(r+=n.end-n.start);return(10>(e=Math.floor(r/3600))?"0":"")+e+":"+(10>(a=Math.floor(r/60%60))?"0":"")+a+":"+(10>(n=Math.floor(r%60))?"0":"")+n+"."+(100>(r=Math.floor(1e3*r%1e3))?10>r?"00":"0":"")+r},a=shaka.text.Utils.getCuesToFlatten(e,[]);e="WEBVTT\n\n";for(var n=(a=$jscomp.makeIterator(a)).next();!n.done;n=a.next())e+=r((n=n.value).startTime)+" --\x3e "+r(n.endTime)+function(e){var t=[],r=shaka.text.Cue;switch(e.textAlign){case r.textAlign.LEFT:t.push("align:left");break;case r.textAlign.RIGHT:t.push("align:right");break;case r.textAlign.CENTER:t.push("align:middle");break;case r.textAlign.START:t.push("align:start");break;case r.textAlign.END:t.push("align:end")}switch(e.writingMode){case r.writingMode.VERTICAL_LEFT_TO_RIGHT:t.push("vertical:lr");break;case r.writingMode.VERTICAL_RIGHT_TO_LEFT:t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(n)+"\n",e+=n.payload+"\n\n";return e},goog.exportSymbol("shaka.text.WebVttGenerator",shaka.text.WebVttGenerator),shaka.util.CmcdManager=function(e,t){this.playerInterface_=e,this.config_=t,this.sid_="",this.sf_=void 0,this.playbackStarted_=!1,this.buffering_=!0,this.starved_=!1},shaka.util.CmcdManager.prototype.setBuffering=function(e){e||this.playbackStarted_||(this.playbackStarted_=!0),this.playbackStarted_&&e&&(this.starved_=!0),this.buffering_=e},shaka.util.CmcdManager.prototype.applyManifestData=function(e,t){try{this.config_.enabled&&(this.sf_=t.format,this.apply_(e,{ot:shaka.util.CmcdManager.ObjectType.MANIFEST,su:!this.playbackStarted_}))}catch(e){shaka.log.warnOnce("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",e)}},shaka.util.CmcdManager.prototype.applySegmentData=function(e,t){try{if(this.config_.enabled){var r={d:1e3*t.duration,st:this.getStreamType_()};r.ot=this.getObjectType_(t);var a=shaka.util.CmcdManager.ObjectType,n=r.ot===a.VIDEO||r.ot===a.AUDIO||r.ot===a.MUXED||r.ot===a.TIMED_TEXT;n&&(r.bl=this.getBufferLength_(t.type)),t.bandwidth&&(r.br=t.bandwidth/1e3),n&&r.ot!==a.TIMED_TEXT&&(r.tb=this.getTopBandwidth_(r.ot)/1e3),this.apply_(e,r)}}catch(e){shaka.log.warnOnce("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",e)}},shaka.util.CmcdManager.prototype.applyTextData=function(e){try{this.config_.enabled&&this.apply_(e,{ot:shaka.util.CmcdManager.ObjectType.CAPTION,su:!0})}catch(e){shaka.log.warnOnce("CMCD_TEXT_ERROR","Could not generate text CMCD data.",e)}},shaka.util.CmcdManager.prototype.appendSrcData=function(e,t){try{if(!this.config_.enabled)return e;var r=this.createData_();r.ot=this.getObjectTypeFromMimeType_(t),r.su=!0;var a=shaka.util.CmcdManager.toQuery(r);return shaka.util.CmcdManager.appendQueryToUri(e,a)}catch(t){return shaka.log.warnOnce("CMCD_SRC_ERROR","Could not generate src CMCD data.",t),e}},shaka.util.CmcdManager.prototype.appendTextTrackData=function(e){try{if(!this.config_.enabled)return e;var t=this.createData_();t.ot=shaka.util.CmcdManager.ObjectType.CAPTION,t.su=!0;var r=shaka.util.CmcdManager.toQuery(t);return shaka.util.CmcdManager.appendQueryToUri(e,r)}catch(t){return shaka.log.warnOnce("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",t),e}},shaka.util.CmcdManager.prototype.createData_=function(){return this.sid_||(this.sid_=this.config_.sessionId||window.crypto.randomUUID()),{v:shaka.util.CmcdManager.Version,sf:this.sf_,sid:this.sid_,cid:this.config_.contentId,mtp:this.playerInterface_.getBandwidthEstimate()/1e3}},shaka.util.CmcdManager.prototype.apply_=function(e,t,r){if(t=void 0===t?{}:t,r=void 0===r?this.config_.useHeaders:r,this.config_.enabled){Object.assign(t,this.createData_()),t.pr=this.playerInterface_.getPlaybackRate();var a=t.ot===shaka.util.CmcdManager.ObjectType.VIDEO||t.ot===shaka.util.CmcdManager.ObjectType.MUXED;if(this.starved_&&a&&(t.bs=!0,t.su=!0,this.starved_=!1),null==t.su&&(t.su=this.buffering_),r)t=shaka.util.CmcdManager.toHeaders(t),Object.keys(t).length&&Object.assign(e.headers,t);else{var n=shaka.util.CmcdManager.toQuery(t);n&&(e.uris=e.uris.map((function(e){return shaka.util.CmcdManager.appendQueryToUri(e,n)})))}}},shaka.util.CmcdManager.prototype.getObjectType_=function(e){var t=e.type;return e.init?shaka.util.CmcdManager.ObjectType.INIT:"video"==t?e.codecs.includes(",")?shaka.util.CmcdManager.ObjectType.MUXED:shaka.util.CmcdManager.ObjectType.VIDEO:"audio"==t?shaka.util.CmcdManager.ObjectType.AUDIO:"text"==t?"application/mp4"===e.mimeType?shaka.util.CmcdManager.ObjectType.TIMED_TEXT:shaka.util.CmcdManager.ObjectType.CAPTION:void 0},shaka.util.CmcdManager.prototype.getObjectTypeFromMimeType_=function(e){switch(e){case"video/webm":case"video/mp4":return shaka.util.CmcdManager.ObjectType.MUXED;case"application/x-mpegurl":return shaka.util.CmcdManager.ObjectType.MANIFEST}},shaka.util.CmcdManager.prototype.getBufferLength_=function(e){if(!(e=this.playerInterface_.getBufferedInfo()[e]).length)return NaN;var t=this.playerInterface_.getCurrentTime();return(e=e.find((function(e){return e.start<=t&&e.end>=t})))?1e3*(e.end-t):NaN},shaka.util.CmcdManager.prototype.getStreamType_=function(){return this.playerInterface_.isLive()?shaka.util.CmcdManager.StreamType.LIVE:shaka.util.CmcdManager.StreamType.VOD},shaka.util.CmcdManager.prototype.getTopBandwidth_=function(e){var t=this.playerInterface_.getVariantTracks();if(!t.length)return NaN;for(var r=t[0],a=(t=$jscomp.makeIterator(t)).next();!a.done;a=t.next())"variant"===(a=a.value).type&&a.bandwidth>r.bandwidth&&(r=a);switch(t=shaka.util.CmcdManager.ObjectType,e){case t.VIDEO:return r.videoBandwidth||NaN;case t.AUDIO:return r.audioBandwidth||NaN;default:return r.bandwidth}},shaka.util.CmcdManager.serialize=function(e){var t=[],r=function(e){return Math.round(e)},a=function(e){return 100*r(e/100)};a={br:r,d:r,bl:a,dl:a,mtp:a,nor:function(e){return encodeURIComponent(e)},rtp:a,tb:r};for(var n,i=Object.keys(e||{}).sort(),o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next()){var s=e[o=o.value];if(!(n=s,Number.isNaN(n)||null==n||""===n||!1===n||"v"===o&&1===s||"pr"==o&&1===s)){var l=a[o];l&&(s=l(s));var u;u="string"===(l=typeof s)&&"ot"!==o&&"sf"!==o&&"st"!==o?o+"="+JSON.stringify(s):"boolean"===l?o:"symbol"===l?o+"="+s.description:o+"="+s,t.push(u)}}return t.join(",")},shaka.util.CmcdManager.toHeaders=function(e){for(var t=Object.keys(e),r={},a=["Object","Request","Session","Status"],n=[{},{},{},{}],i={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},o=(t=$jscomp.makeIterator(t)).next();!o.done;o=t.next())n[null!=i[o=o.value]?i[o]:1][o]=e[o];for(e=0;e<n.length;e++)(i=shaka.util.CmcdManager.serialize(n[e]))&&(r["CMCD-"+a[e]]=i);return r},shaka.util.CmcdManager.toQuery=function(e){return shaka.util.CmcdManager.serialize(e)},shaka.util.CmcdManager.appendQueryToUri=function(e,t){return!t||e.includes("offline:")?e:((e=new goog.Uri(e)).getQueryData().set("CMCD",t),e.toString())},shaka.util.CmcdManager.ObjectType={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},shaka.util.CmcdManager.StreamType={VOD:"v",LIVE:"l"},shaka.util.CmcdManager.StreamingFormat={DASH:"d",HLS:"h",SMOOTH:"s",OTHER:"o"},goog.exportSymbol("shaka.util.CmcdManager.StreamingFormat",shaka.util.CmcdManager.StreamingFormat),shaka.util.CmcdManager.Version=1,shaka.util.ConfigUtils=function(){},shaka.util.ConfigUtils.mergeConfigObjects=function(e,t,r,a,n){goog.asserts.assert(e,"Destination config must not be null!");var i,o=n in a,s=!0;for(i in t){var l=n+"."+i,u=o?a[n]:r[i];o||i in r?void 0===t[i]?void 0===u||o?delete e[i]:e[i]=shaka.util.ObjectUtils.cloneObject(u):u.constructor==Object&&t[i]&&t[i].constructor==Object?(e[i]||(e[i]=shaka.util.ObjectUtils.cloneObject(u)),l=shaka.util.ConfigUtils.mergeConfigObjects(e[i],t[i],u,a,l),s=s&&l):typeof t[i]!=typeof u||null==t[i]||"function"!=typeof t[i]&&t[i].constructor!=u.constructor?(shaka.log.alwaysError("Invalid config, wrong type for "+l),s=!1):("function"==typeof r[i]&&r[i].length!=t[i].length&&shaka.log.alwaysWarn("Unexpected number of arguments for "+l),e[i]=t[i]):(shaka.log.alwaysError("Invalid config, unrecognized key "+l),s=!1)}return s},shaka.util.ConfigUtils.convertToConfigObject=function(e,t){for(var r={},a=r,n=0,i=0;!(0>(n=e.indexOf(".",n)));)0!=n&&"\\"==e[n-1]||(a[i=e.substring(i,n).replace(/\\\./g,".")]={},a=a[i],i=n+1),n+=1;return a[e.substring(i).replace(/\\\./g,".")]=t,r},shaka.util.ConfigUtils.referenceParametersAndReturn=function(e,t){return e&&t},goog.exportSymbol("shaka.util.ConfigUtils",shaka.util.ConfigUtils),goog.exportProperty(shaka.util.ConfigUtils,"convertToConfigObject",shaka.util.ConfigUtils.convertToConfigObject),goog.exportProperty(shaka.util.ConfigUtils,"mergeConfigObjects",shaka.util.ConfigUtils.mergeConfigObjects),shaka.util.FairPlayUtils=function(){},shaka.util.FairPlayUtils.isFairPlaySupported=function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},t.setCatchFinallyBlocks(2),t.yield(navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.nextAddress?t.return(!0):(t.enterCatchBlock(),t.return(!1))}))},shaka.util.FairPlayUtils.defaultGetContentId=function(e){return e=shaka.util.StringUtils.fromBytesAutoDetect(e),new goog.Uri(e).getDomain()},shaka.util.FairPlayUtils.initDataTransform=function(e,t,r){if(!r||!r.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.SERVER_CERTIFICATE_REQUIRED);t="string"==typeof t?shaka.util.StringUtils.toUTF16(t,!0):t,e=shaka.util.StringUtils.fromBytesAutoDetect(e),e=shaka.util.StringUtils.toUTF16(e,!0);var a=new Uint8Array(12+e.byteLength+t.byteLength+r.byteLength),n=0,i=function(e){shaka.util.BufferUtils.toDataView(a).setUint32(n,e.byteLength,!0),n+=4,a.set(shaka.util.BufferUtils.toUint8(e),n),n+=e.byteLength};return i(e),i(t),i(r),goog.asserts.assert(n==a.length,"Inconsistent init data length"),a},shaka.util.FairPlayUtils.verimatrixInitDataTransform=function(e,t,r){if("skd"!==t)return e;t=shaka.util.FairPlayUtils,r=r.serverCertificate;var a=shaka.util.StringUtils.fromBytesAutoDetect(e).split("skd://").pop();return t.initDataTransform(e,a,r)},shaka.util.FairPlayUtils.ezdrmInitDataTransform=function(e,t,r){if("skd"!==t)return e;t=shaka.util.FairPlayUtils,r=r.serverCertificate;var a=shaka.util.StringUtils.fromBytesAutoDetect(e).split(";").pop();return t.initDataTransform(e,a,r)},shaka.util.FairPlayUtils.conaxInitDataTransform=function(e,t,r){if("skd"!==t)return e;t=shaka.util.FairPlayUtils,r=r.serverCertificate;var a=shaka.util.StringUtils.fromBytesAutoDetect(e).split("skd://").pop().split("?").shift();a=window.atob(a);var n=new ArrayBuffer(2*a.length);n=new Uint16Array(n);for(var i=0,o=a.length;i<o;i++)n[i]=a.charCodeAt(i);return t.initDataTransform(e,n,r)},shaka.util.FairPlayUtils.verimatrixFairPlayRequest=function(e,t){e===shaka.net.NetworkingEngine.RequestType.LICENSE&&(e=shaka.util.BufferUtils.toUint8(t.body),e=shaka.util.Uint8ArrayUtils.toBase64(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=shaka.util.StringUtils.toUTF8("spc="+e))},shaka.util.FairPlayUtils.ezdrmFairPlayRequest=function(e,t){e===shaka.net.NetworkingEngine.RequestType.LICENSE&&(t.headers["Content-Type"]="application/octet-stream")},shaka.util.FairPlayUtils.conaxFairPlayRequest=function(e,t){e===shaka.net.NetworkingEngine.RequestType.LICENSE&&(t.headers["Content-Type"]="application/octet-stream")},shaka.util.FairPlayUtils.commonFairPlayResponse=function(e,t){if(e===shaka.net.NetworkingEngine.RequestType.LICENSE){try{var r=shaka.util.StringUtils.fromUTF8(t.data)}catch(e){return}e=!1,"<ckc>"===(r=r.trim()).substr(0,5)&&"</ckc>"===r.substr(-6)&&(r=r.slice(5,-6),e=!0);try{var a=JSON.parse(r);a.ckc&&(r=a.ckc,e=!0),a.CkcMessage&&(r=a.CkcMessage,e=!0),a.License&&(r=a.License,e=!0)}catch(e){}e&&(t.data=shaka.util.BufferUtils.toArrayBuffer(shaka.util.Uint8ArrayUtils.fromBase64(r)))}},goog.exportSymbol("shaka.util.FairPlayUtils",shaka.util.FairPlayUtils),goog.exportProperty(shaka.util.FairPlayUtils,"commonFairPlayResponse",shaka.util.FairPlayUtils.commonFairPlayResponse),goog.exportProperty(shaka.util.FairPlayUtils,"conaxFairPlayRequest",shaka.util.FairPlayUtils.conaxFairPlayRequest),goog.exportProperty(shaka.util.FairPlayUtils,"ezdrmFairPlayRequest",shaka.util.FairPlayUtils.ezdrmFairPlayRequest),goog.exportProperty(shaka.util.FairPlayUtils,"verimatrixFairPlayRequest",shaka.util.FairPlayUtils.verimatrixFairPlayRequest),goog.exportProperty(shaka.util.FairPlayUtils,"conaxInitDataTransform",shaka.util.FairPlayUtils.conaxInitDataTransform),goog.exportProperty(shaka.util.FairPlayUtils,"ezdrmInitDataTransform",shaka.util.FairPlayUtils.ezdrmInitDataTransform),goog.exportProperty(shaka.util.FairPlayUtils,"verimatrixInitDataTransform",shaka.util.FairPlayUtils.verimatrixInitDataTransform),goog.exportProperty(shaka.util.FairPlayUtils,"initDataTransform",shaka.util.FairPlayUtils.initDataTransform),goog.exportProperty(shaka.util.FairPlayUtils,"defaultGetContentId",shaka.util.FairPlayUtils.defaultGetContentId),goog.exportProperty(shaka.util.FairPlayUtils,"isFairPlaySupported",shaka.util.FairPlayUtils.isFairPlaySupported),shaka.util.PlayerConfiguration=function(){},shaka.util.PlayerConfiguration.createDefault=function(){var e=1/0;navigator.connection&&navigator.connection.saveData&&(e=360);var t={retryParameters:shaka.net.NetworkingEngine.defaultRetryParameters(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:function(e,t,r){return"com.apple.fps.1_0"==r.keySystem&&"skd"==t&&(t=r.serverCertificate,r=shaka.util.FairPlayUtils.defaultGetContentId(e),e=shaka.util.FairPlayUtils.initDataTransform(e,r,t)),e},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:shaka.util.Platform.isXboxOne()},r={retryParameters:shaka.net.NetworkingEngine.defaultRetryParameters(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},manifestPreprocessor:function(e){return shaka.util.ConfigUtils.referenceParametersAndReturn([e],e)},sequenceMode:!1},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',useSafariBehaviorForLive:!0,liveSegmentsDelay:3}},a={retryParameters:shaka.net.NetworkingEngine.defaultRetryParameters(),failureCallback:function(e){return shaka.log.error("Unhandled streaming error",e),shaka.util.ConfigUtils.referenceParametersAndReturn([e],void 0)},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,durationBackoff:1,forceTransmux:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1,maxDisabledTime:30,parsePrftBox:!1};(shaka.util.Platform.isWebOS()||shaka.util.Platform.isTizen()||shaka.util.Platform.isChromecast())&&(a.stallSkip=0);var n={trackSelectionCallback:function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return t.return(e)}))},downloadSizeCallback:function(e){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?navigator.storage&&navigator.storage.estimate?r.yield(navigator.storage.estimate(),3):r.return(!0):(t=r.yieldResult,r.return(t.usage+e<.95*t.quota))}))},progressCallback:function(e,t){return shaka.util.ConfigUtils.referenceParametersAndReturn([e,t],void 0)},usePersistentLicense:!0,numberOfParallelDownloads:5},i={drm:t,manifest:r,streaming:a,mediaSource:{sourceBufferExtraFeatures:""},offline:n,abrFactory:function(){return new shaka.abr.SimpleAbrManager},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1},autoShowText:shaka.config.AutoShowText.IF_SUBTITLES_MAY_BE_NEEDED,preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",useHeaders:!1},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1}};return n.trackSelectionCallback=function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return t.return(shaka.util.PlayerConfiguration.defaultTrackSelect(e,i.preferredAudioLanguage))}))},i},shaka.util.PlayerConfiguration.mergeConfigObjects=function(e,t,r){var a={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:""}};return shaka.util.ConfigUtils.mergeConfigObjects(e,t,r||shaka.util.PlayerConfiguration.createDefault(),a,"")},shaka.util.PlayerConfiguration.defaultTrackSelect=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType,a=shaka.util.LanguageUtils,n=e.filter((function(e){return"variant"==e.type})),i=[],o=a.findClosestLocale(t,n.map((function(e){return e.language})));o&&(i=n.filter((function(e){return a.normalize(e.language)==o}))),0==i.length&&(i=n.filter((function(e){return e.primary}))),0==i.length&&(1<new Set(n.map((function(e){return e.language}))).size&&shaka.log.warning("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),i=n);var s=i.filter((function(e){return e.height&&480>=e.height}));for(s.length&&(s.sort((function(e,t){return goog.asserts.assert(null!=e.height,"Null height"),goog.asserts.assert(null!=t.height,"Null height"),t.height-e.height})),i=s.filter((function(e){return e.height==s[0].height}))),t=[],i.length&&(n=Math.floor(i.length/2),i.sort((function(e,t){return e.bandwidth-t.bandwidth})),t.push(i[n])),i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next())(i=i.value).type!=r.TEXT&&i.type!=r.IMAGE||t.push(i);return t},goog.exportSymbol("shaka.util.PlayerConfiguration",shaka.util.PlayerConfiguration),goog.exportProperty(shaka.util.PlayerConfiguration,"mergeConfigObjects",shaka.util.PlayerConfiguration.mergeConfigObjects),goog.exportProperty(shaka.util.PlayerConfiguration,"createDefault",shaka.util.PlayerConfiguration.createDefault),shaka.util.StateHistory=function(){this.open_=null,this.closed_=[]},shaka.util.StateHistory.prototype.update=function(e){null==this.open_?this.start_(e):this.update_(e)},shaka.util.StateHistory.prototype.getTimeSpentIn=function(e){var t=0;this.open_&&this.open_.state==e&&(t+=this.open_.duration);for(var r=$jscomp.makeIterator(this.closed_),a=r.next();!a.done;a=r.next())t+=(a=a.value).state==e?a.duration:0;return t},shaka.util.StateHistory.prototype.getCopy=function(){for(var e=function(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}},t=[],r=$jscomp.makeIterator(this.closed_),a=r.next();!a.done;a=r.next())t.push(e(a.value));return this.open_&&t.push(e(this.open_)),t},shaka.util.StateHistory.prototype.start_=function(e){goog.asserts.assert(null==this.open_,"There must be no open entry in order when we start"),shaka.log.v1("Changing Player state to",e),this.open_={timestamp:this.getNowInSeconds_(),state:e,duration:0}},shaka.util.StateHistory.prototype.update_=function(e){goog.asserts.assert(this.open_,"There must be an open entry in order to update it");var t=this.getNowInSeconds_();this.open_.duration=t-this.open_.timestamp,this.open_.state!=e&&(shaka.log.v1("Changing Player state to",e),this.closed_.push(this.open_),this.open_={timestamp:t,state:e,duration:0})},shaka.util.StateHistory.prototype.getNowInSeconds_=function(){return Date.now()/1e3},shaka.util.SwitchHistory=function(){this.currentText_=this.currentVariant_=null,this.history_=[]},shaka.util.SwitchHistory.prototype.updateCurrentVariant=function(e,t){this.currentVariant_!=e&&(this.currentVariant_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"variant",fromAdaptation:t,bandwidth:e.bandwidth}))},shaka.util.SwitchHistory.prototype.updateCurrentText=function(e,t){this.currentText_!=e&&(this.currentText_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"text",fromAdaptation:t,bandwidth:null}))},shaka.util.SwitchHistory.prototype.getCopy=function(){for(var e=[],t=$jscomp.makeIterator(this.history_),r=t.next();!r.done;r=t.next())e.push(this.clone_(r.value));return e},shaka.util.SwitchHistory.prototype.getNowInSeconds_=function(){return Date.now()/1e3},shaka.util.SwitchHistory.prototype.clone_=function(e){return{timestamp:e.timestamp,id:e.id,type:e.type,fromAdaptation:e.fromAdaptation,bandwidth:e.bandwidth}},shaka.util.Stats=function(){this.bandwidthEstimate_=this.currentStreamBandwidth_=this.maxSegmentDurationSeconds_=this.liveLatencySeconds_=this.licenseTimeSeconds_=this.drmTimeSeconds_=this.manifestTimeSeconds_=this.loadLatencySeconds_=this.completionPercent_=this.totalGapsJumped_=this.totalStallsDetected_=this.totalCorruptedFrames_=this.totalDecodedFrames_=this.totalDroppedFrames_=this.height_=this.width_=NaN,this.stateHistory_=new shaka.util.StateHistory,this.switchHistory_=new shaka.util.SwitchHistory},shaka.util.Stats.prototype.setDroppedFrames=function(e,t){this.totalDroppedFrames_=e,this.totalDecodedFrames_=t},shaka.util.Stats.prototype.setCorruptedFrames=function(e){this.totalCorruptedFrames_=e},shaka.util.Stats.prototype.setStallsDetected=function(e){this.totalStallsDetected_=e},shaka.util.Stats.prototype.setGapsJumped=function(e){this.totalGapsJumped_=e},shaka.util.Stats.prototype.setResolution=function(e,t){this.width_=e,this.height_=t},shaka.util.Stats.prototype.setLoadLatency=function(e){this.loadLatencySeconds_=e},shaka.util.Stats.prototype.setManifestTime=function(e){this.manifestTimeSeconds_=e},shaka.util.Stats.prototype.setCompletionPercent=function(e){isNaN(this.completionPercent_)?this.completionPercent_=e:this.completionPercent_=Math.max(this.completionPercent_,e)},shaka.util.Stats.prototype.setDrmTime=function(e){this.drmTimeSeconds_=e},shaka.util.Stats.prototype.setLicenseTime=function(e){this.licenseTimeSeconds_=e},shaka.util.Stats.prototype.setLiveLatency=function(e){this.liveLatencySeconds_=e},shaka.util.Stats.prototype.setMaxSegmentDuration=function(e){this.maxSegmentDurationSeconds_=e},shaka.util.Stats.prototype.setCurrentStreamBandwidth=function(e){this.currentStreamBandwidth_=e},shaka.util.Stats.prototype.setBandwidthEstimate=function(e){this.bandwidthEstimate_=e},shaka.util.Stats.prototype.getStateHistory=function(){return this.stateHistory_},shaka.util.Stats.prototype.getSwitchHistory=function(){return this.switchHistory_},shaka.util.Stats.prototype.getBlob=function(){return{width:this.width_,height:this.height_,streamBandwidth:this.currentStreamBandwidth_,decodedFrames:this.totalDecodedFrames_,droppedFrames:this.totalDroppedFrames_,corruptedFrames:this.totalCorruptedFrames_,stallsDetected:this.totalStallsDetected_,gapsJumped:this.totalGapsJumped_,estimatedBandwidth:this.bandwidthEstimate_,completionPercent:this.completionPercent_,loadLatency:this.loadLatencySeconds_,manifestTimeSeconds:this.manifestTimeSeconds_,drmTimeSeconds:this.drmTimeSeconds_,playTime:this.stateHistory_.getTimeSpentIn("playing"),pauseTime:this.stateHistory_.getTimeSpentIn("paused"),bufferingTime:this.stateHistory_.getTimeSpentIn("buffering"),licenseTime:this.licenseTimeSeconds_,liveLatency:this.liveLatencySeconds_,maxSegmentDuration:this.maxSegmentDurationSeconds_,stateHistory:this.stateHistory_.getCopy(),switchHistory:this.switchHistory_.getCopy()}},shaka.util.Stats.getEmptyBlob=function(){return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,switchHistory:[],stateHistory:[]}},shaka.Player=function(e,t){shaka.util.FakeEventTarget.call(this);var r=this;this.loadMode_=shaka.Player.LoadMode.NOT_LOADED,this.videoContainer_=this.video_=null,this.isTextVisible_=!1,this.globalEventManager_=new shaka.util.EventManager,this.attachEventManager_=new shaka.util.EventManager,this.loadEventManager_=new shaka.util.EventManager,this.assetUri_=this.manifest_=this.parserFactory_=this.parser_=this.streamingEngine_=this.qualityObserver_=this.lcevcDil_=this.lcevcCanvas_=this.cmcdManager_=this.regionTimeline_=this.bufferObserver_=this.bufferPoller_=this.playRateController_=this.playheadObservers_=this.playhead_=this.mediaSourceEngine_=this.drmEngine_=this.networkingEngine_=null,this.fullyLoaded_=!1,this.abrManagerFactory_=this.abrManager_=null,this.nextExternalStreamId_=1e9,this.config_=this.defaultConfig_(),this.maxHwRes_={width:1/0,height:1/0},this.stats_=null,this.currentAdaptationSetCriteria_=new shaka.media.PreferenceBasedCriteria(this.config_.preferredAudioLanguage,this.config_.preferredVariantRole,this.config_.preferredAudioChannelCount),this.currentTextLanguage_=this.config_.preferredTextLanguage,this.currentTextRole_=this.config_.preferredTextRole,this.currentTextForced_=this.config_.preferForcedSubs,this.cleanupOnUnload_=[],this.updatedStartTime_=null,t&&t(this),this.networkingEngine_=this.createNetworkingEngine(),this.networkingEngine_.setForceHTTPS(this.config_.streaming.forceHTTPS),this.adManager_=null,shaka.Player.adManagerFactory_&&(this.adManager_=shaka.Player.adManagerFactory_()),this.globalEventManager_.listen(window,"online",(function(){r.retryStreaming()})),this.detachNode_={name:"detach"},this.attachNode_={name:"attach"},this.unloadNode_={name:"unload"},this.parserNode_={name:"manifest-parser"},this.manifestNode_={name:"manifest"},this.mediaSourceNode_={name:"media-source"},this.drmNode_={name:"drm-engine"},this.loadNode_={name:"load"},this.srcEqualsDrmNode_={name:"src-equals-drm-engine"},this.srcEqualsNode_={name:"src-equals"};var a=shaka.util.AbortableOperation,n=new Map;n.set(this.attachNode_,(function(e,t){return a.notAbortable(r.onAttach_(e,t))})),n.set(this.detachNode_,(function(e,t){return a.notAbortable(r.onDetach_(e,t))})),n.set(this.unloadNode_,(function(e,t){return a.notAbortable(r.onUnload_(e,t))})),n.set(this.mediaSourceNode_,(function(e,t){return e=r.onInitializeMediaSourceEngine_(e,t),a.notAbortable(e)})),n.set(this.parserNode_,(function(e,t){return e=r.onInitializeParser_(e,t),a.notAbortable(e)})),n.set(this.manifestNode_,(function(e,t){return r.onParseManifest_(e,t)})),n.set(this.drmNode_,(function(e,t){return e=r.onInitializeDrm_(e,t),a.notAbortable(e)})),n.set(this.loadNode_,(function(e,t){return a.notAbortable(r.onLoad_(e,t))})),n.set(this.srcEqualsDrmNode_,(function(e,t){return e=r.onInitializeSrcEqualsDrm_(e,t),a.notAbortable(e)})),n.set(this.srcEqualsNode_,(function(e,t){return r.onSrcEquals_(e,t)})),this.walker_=new shaka.routing.Walker(this.detachNode_,shaka.Player.createEmptyPayload_(),{getNext:function(e,t,a,n){return r.getNextStep_(e,t,a,n)},enterNode:function(e,t,a){return r.dispatchEvent(r.makeEvent_(shaka.util.FakeEvent.EventName.OnStateChange,(new Map).set("state",e.name))),n.get(e)(t,a)},handleError:function(e,t){return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(shaka.log.warning("The walker saw an error:"),t instanceof shaka.util.Error?shaka.log.warning("Error Code:",t.code):(shaka.log.warning("Error Message:",t.message),shaka.log.warning("Error Stack:",t.stack)),a.yield(r.onUnload_(e,shaka.Player.createEmptyPayload_()),2)):a.return(e.mediaElement?r.attachNode_:r.detachNode_)}))},onIdle:function(e){r.dispatchEvent(r.makeEvent_(shaka.util.FakeEvent.EventName.OnStateIdle,(new Map).set("state",e.name)))}}),this.checkVariantsTimer_=new shaka.util.Timer((function(){return r.checkVariants_()})),e&&this.attach(e,!0)},$jscomp.inherits(shaka.Player,shaka.util.FakeEventTarget),shaka.Player.prototype.createLcevcDil_=function(e){null==this.lcevcDil_&&(this.lcevcDil_=new shaka.lcevc.Dil(this.video_,this.lcevcCanvas_,e),this.mediaSourceEngine_&&this.mediaSourceEngine_.updateLcevcDil(this.lcevcDil_))},shaka.Player.prototype.closeLcevcDil_=function(){null!=this.lcevcDil_&&(this.lcevcDil_.release(),this.lcevcDil_=null)},shaka.Player.prototype.setupLcevc_=function(e){if(e.lcevc.enabled){var t=this.getVariantTracks();t&&t[0]&&t[0].videoMimeType==shaka.Player.SRC_EQUAL_EXTENSIONS_TO_MIME_TYPES_.ts&&(shaka.util.Platform.isEdge()||shaka.util.Platform.isLegacyEdge())&&(e.streaming.forceTransmux||shaka.log.alwaysWarn("LCEVC Warning: For MPEG-2 TS decoding the config.streaming.forceTransmux must be enabled.")),this.closeLcevcDil_(),this.createLcevcDil_(e.lcevc)}else this.closeLcevcDil_()},shaka.Player.prototype.makeEvent_=function(e,t){return new shaka.util.FakeEvent(e,t)},shaka.Player.prototype.destroy=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:return t.loadMode_==shaka.Player.LoadMode.DESTROYED?r.return():(t.closeLcevcDil_(),t.loadMode_=shaka.Player.LoadMode.DESTROYED,e=t.walker_.startNewRoute((function(e){return{node:t.detachNode_,payload:shaka.Player.createEmptyPayload_(),interruptible:!1}})),r.yield(new Promise((function(t){e.onStart=function(){shaka.log.info("Preparing to destroy walker...")},e.onEnd=function(){t()},e.onCancel=function(){goog.asserts.assert(!1,"Our final detach call should never be cancelled."),t()},e.onError=function(){goog.asserts.assert(!1,"Our final detach call should never see an error"),t()},e.onSkip=function(){goog.asserts.assert(!1,"Our final detach call should never be skipped"),t()}})),2));case 2:return r.yield(t.walker_.destroy(),3);case 3:if(t.globalEventManager_&&(t.globalEventManager_.release(),t.globalEventManager_=null),t.attachEventManager_&&(t.attachEventManager_.release(),t.attachEventManager_=null),t.loadEventManager_&&(t.loadEventManager_.release(),t.loadEventManager_=null),t.abrManagerFactory_=null,t.abrManager_=null,t.config_=null,t.stats_=null,t.videoContainer_=null,t.cmcdManager_=null,!t.networkingEngine_){r.jumpTo(4);break}return r.yield(t.networkingEngine_.destroy(),5);case 5:t.networkingEngine_=null;case 4:shaka.util.FakeEventTarget.prototype.release.call(t),r.jumpToEnd()}}))},shaka.Player.registerSupportPlugin=function(e,t){shaka.Player.supportPlugins_[e]=t},shaka.Player.setAdManagerFactory=function(e){shaka.Player.adManagerFactory_=e},shaka.Player.isBrowserSupported=function(){if(window.Promise||shaka.log.alwaysWarn("A Promise implementation or polyfill is required"),!(window.Promise&&window.Uint8Array&&Array.prototype.forEach)||shaka.util.Platform.isIE())return!1;var e=shaka.util.Platform.safariVersion();return!(e&&13>e||!shaka.media.DrmEngine.isBrowserSupported())&&(!!shaka.util.Platform.supportsMediaSource()||shaka.util.Platform.supportsMediaType("application/x-mpegurl"))},shaka.Player.probeSupport=function(e){var t,r,a,n,i,o;return e=void 0===e||e,$jscomp.asyncExecutePromiseGeneratorProgram((function(s){if(1==s.nextAddress)return goog.asserts.assert(shaka.Player.isBrowserSupported(),"Must have basic support"),t={},e?s.yield(shaka.media.DrmEngine.probeSupport(),3):s.jumpTo(2);for(o in 2!=s.nextAddress&&(t=s.yieldResult),r=shaka.media.ManifestParser.probeSupport(),a=shaka.media.MediaSourceEngine.probeSupport(),n={manifest:r,media:a,drm:t},i=shaka.Player.supportPlugins_)n[o]=i[o]();return s.return(n)}))},shaka.Player.prototype.attach=function(e,t){if(t=void 0===t||t,this.loadMode_==shaka.Player.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());var r=shaka.Player.createEmptyPayload_();r.mediaElement=e,shaka.util.Platform.supportsMediaSource()||(t=!1);var a=t?this.mediaSourceNode_:this.attachNode_;return(e=this.walker_.startNewRoute((function(e){return{node:a,payload:r,interruptible:!1}}))).onStart=function(){return shaka.log.info("Starting attach...")},this.wrapWalkerListenersWithPromise_(e)},shaka.Player.prototype.attachCanvas=function(e){this.lcevcCanvas_=e},shaka.Player.prototype.detach=function(){var e=this;if(this.loadMode_==shaka.Player.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());var t=this.walker_.startNewRoute((function(t){return{node:e.detachNode_,payload:shaka.Player.createEmptyPayload_(),interruptible:!1}}));return t.onStart=function(){return shaka.log.info("Starting detach...")},this.wrapWalkerListenersWithPromise_(t)},shaka.Player.prototype.unload=function(e){var t=this;if(e=void 0===e||e,this.loadMode_==shaka.Player.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());this.fullyLoaded_=!1,shaka.util.Platform.supportsMediaSource()||(e=!1),this.closeLcevcDil_();var r=shaka.Player.createEmptyPayload_(),a=this.walker_.startNewRoute((function(a){var n=a.mediaElement&&e?t.mediaSourceNode_:a.mediaElement?t.attachNode_:t.detachNode_;return goog.asserts.assert(n,"We should have picked a destination."),r.mediaElement=a.mediaElement,{node:n,payload:r,interruptible:!1}}));return a.onStart=function(){return shaka.log.info("Starting unload...")},this.wrapWalkerListenersWithPromise_(a)},shaka.Player.prototype.updateStartTime=function(e){this.updatedStartTime_=e},shaka.Player.prototype.load=function(e,t,r){var a=this;if(this.updatedStartTime_=null,this.fullyLoaded_=!1,this.loadMode_==shaka.Player.LoadMode.DESTROYED)return Promise.reject(this.createAbortLoadError_());this.dispatchEvent(this.makeEvent_(shaka.util.FakeEvent.EventName.Loading));var n=shaka.Player.createEmptyPayload_();n.uri=e,n.startTimeOfLoad=Date.now()/1e3,r&&(n.mimeType=r),void 0!==t&&(n.startTime=t);var i=this.shouldUseSrcEquals_(n)?this.srcEqualsNode_:this.loadNode_,o=this.walker_.startNewRoute((function(e){return null==e.mediaElement?null:(n.mediaElement=e.mediaElement,{node:i,payload:n,interruptible:!0})}));return this.stats_=new shaka.util.Stats,this.cmcdManager_=this.createCmcd_(),o.onStart=function(){return shaka.log.info("Starting load of "+e+"...")},new Promise((function(e,t){o.onSkip=function(){return t(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.NO_VIDEO_ELEMENT))},o.onEnd=function(){e(),a.dispatchEvent(a.makeEvent_(shaka.util.FakeEvent.EventName.Loaded))},o.onCancel=function(){return t(a.createAbortLoadError_())},o.onError=function(e){return t(e)}}))},shaka.Player.prototype.shouldUseSrcEquals_=function(e){var t=shaka.util.Platform;if(!t.supportsMediaSource())return!0;var r=e.mimeType,a=e.uri||"";if(r||(r=shaka.media.ManifestParser.getExtension(a),r=shaka.Player.SRC_EQUAL_EXTENSIONS_TO_MIME_TYPES_[r]),r){if(!(e=""!=(e.mediaElement||t.anyMediaElement()).canPlayType(r)))return!1;if(!(a=shaka.media.ManifestParser.isSupported(a,r)))return!0;if(goog.asserts.assert(e&&a,"Both native and MSE playback should be possible!"),this.config_.streaming.preferNativeHls)return!0;if(t.isApple())return this.config_.streaming.useNativeHlsOnSafari}return!1},shaka.Player.prototype.onAttach_=function(e,t){var r=this;return goog.asserts.assert(null==e.mediaElement||e.mediaElement==t.mediaElement,"The routing logic failed. MediaElement requirement failed."),null==e.mediaElement&&(e.mediaElement=t.mediaElement,this.attachEventManager_.listen(e.mediaElement,"error",(function(e){return r.onVideoError_(e)}))),this.video_=e.mediaElement,Promise.resolve()},shaka.Player.prototype.onDetach_=function(e,t){return e.mediaElement&&(this.attachEventManager_.removeAll(),e.mediaElement=null),this.adManager_&&this.adManager_.release(),this.video_=null,Promise.resolve()},shaka.Player.prototype.onUnload_=function(e,t){var r,a,n,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:return d.loadMode_!=shaka.Player.LoadMode.DESTROYED&&(d.loadMode_=shaka.Player.LoadMode.NOT_LOADED),r=d.cleanupOnUnload_.map((function(e){return e()})),d.cleanupOnUnload_=[],t.yield(Promise.all(r),2);case 2:if(d.dispatchEvent(d.makeEvent_(shaka.util.FakeEvent.EventName.Unloading)),e.mimeType=null,e.startTime=null,e.uri=null,d.regionTimeline_&&(d.regionTimeline_.release(),d.regionTimeline_=null),e.mediaElement&&d.loadEventManager_.removeAll(),d.checkVariantsTimer_.stop(),d.playheadObservers_&&(d.playheadObservers_.release(),d.playheadObservers_=null),d.bufferPoller_&&(d.bufferPoller_.stop(),d.bufferPoller_=null),!d.parser_){t.jumpTo(3);break}return t.yield(d.parser_.stop(),4);case 4:d.parser_=null,d.parserFactory_=null;case 3:if(!d.abrManager_){t.jumpTo(5);break}return t.yield(d.abrManager_.stop(),5);case 5:if(!d.streamingEngine_){t.jumpTo(7);break}return t.yield(d.streamingEngine_.destroy(),8);case 8:d.streamingEngine_=null;case 7:if(d.playRateController_&&(d.playRateController_.release(),d.playRateController_=null),d.playhead_&&(d.playhead_.release(),d.playhead_=null),!d.mediaSourceEngine_){t.jumpTo(9);break}return t.yield(d.mediaSourceEngine_.destroy(),10);case 10:d.mediaSourceEngine_=null;case 9:if(d.adManager_&&d.adManager_.onAssetUnload(),!e.mediaElement||!e.mediaElement.src){t.jumpTo(11);break}return t.yield(new Promise((function(e){return new shaka.util.Timer(e).tickAfter(.1)})),12);case 12:for(e.mediaElement.removeAttribute("src"),e.mediaElement.load();e.mediaElement.lastChild;)e.mediaElement.removeChild(e.mediaElement.firstChild);case 11:if(!d.drmEngine_){t.jumpTo(13);break}return t.yield(d.drmEngine_.destroy(),14);case 14:d.drmEngine_=null;case 13:if(d.assetUri_=null,d.bufferObserver_=null,d.manifest_){for(a=$jscomp.makeIterator(d.manifest_.variants),n=a.next();!n.done;n=a.next())for(i=n.value,o=$jscomp.makeIterator([i.audio,i.video]),s=o.next();!s.done;s=o.next())(l=s.value)&&l.segmentIndex&&l.segmentIndex.release();for(u=$jscomp.makeIterator(d.manifest_.textStreams),s=u.next();!s.done;s=u.next())(c=s.value).segmentIndex&&c.segmentIndex.release()}d.manifest_=null,d.stats_=new shaka.util.Stats,d.lastTextFactory_=null,d.updateBufferState_(),t.jumpToEnd()}}))},shaka.Player.prototype.onInitializeMediaSourceEngine_=function(e,t){var r,a,n,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress)return goog.asserts.assert(shaka.util.Platform.supportsMediaSource(),"We should not be initializing media source on a platform that does not support media source."),goog.asserts.assert(e.mediaElement,"We should have a media element when initializing media source."),goog.asserts.assert(e.mediaElement==t.mediaElement,"|has| and |wants| should have the same media element when initializing media source."),goog.asserts.assert(null==s.mediaSourceEngine_,"We should not have a media source engine yet."),r=s.config_.textDisplayFactory,a=r(),s.lastTextFactory_=r,(n=s.createMediaSourceEngine(e.mediaElement,a,(function(e,t,r){s.processTimedMetadataMediaSrc_(e,t,r)}),s.lcevcDil_)).configure(s.config_.mediaSource),i=s.config_.manifest,o=i.segmentRelativeVttTiming,n.setSegmentRelativeVttTiming(o),l.yield(n.open(),2);s.mediaSourceEngine_=n,l.jumpToEnd()}))},shaka.Player.prototype.onInitializeParser_=function(e,t){var r,a,n,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){if(1==s.nextAddress)return goog.asserts.assert(e.mediaElement,"We should have a media element when initializing the parser."),goog.asserts.assert(e.mediaElement==t.mediaElement,"|has| and |wants| should have the same media element when initializing the parser."),goog.asserts.assert(o.networkingEngine_,"Need networking engine when initializing the parser."),goog.asserts.assert(o.config_,"Need player config when initializing the parser."),e.mimeType=t.mimeType,e.uri=t.uri,goog.asserts.assert(e.uri,"We should have an asset uri when initializing the parsing."),r=e.uri,a=o.networkingEngine_,o.assetUri_=r,n=o,s.yield(shaka.media.ManifestParser.getFactory(r,a,o.config_.manifest.retryParameters,e.mimeType),2);n.parserFactory_=s.yieldResult,goog.asserts.assert(o.parserFactory_,"Must have manifest parser"),o.parser_=o.parserFactory_(),i=shaka.util.ObjectUtils.cloneObject(o.config_.manifest),t.mediaElement&&"AUDIO"===t.mediaElement.nodeName&&(i.disableVideo=!0),o.parser_.configure(i),s.jumpToEnd()}))},shaka.Player.prototype.onParseManifest_=function(e,t){var r=this;goog.asserts.assert(e.mimeType==t.mimeType,"|has| and |wants| should have the same mime type when parsing."),goog.asserts.assert(e.uri==t.uri,"|has| and |wants| should have the same uri when parsing."),goog.asserts.assert(e.uri,"|has| should have a valid uri when parsing."),goog.asserts.assert(e.uri==this.assetUri_,"|has.uri| should match the cached asset uri."),goog.asserts.assert(this.networkingEngine_,"Need networking engine to parse manifest."),goog.asserts.assert(this.cmcdManager_,"Need CMCD manager to populate manifest request data."),goog.asserts.assert(this.config_,"Need player config to parse manifest."),goog.asserts.assert(this.parser_,"|this.parser_| should have been set in an earlier step.");var a=e.uri;e=this.networkingEngine_,this.regionTimeline_=new shaka.media.RegionTimeline((function(){return r.seekRange()})),this.regionTimeline_.addEventListener("regionadd",(function(e){e=e.region,r.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionAdded,e),r.adManager_&&r.adManager_.onDashTimedMetadata(e)})),this.qualityObserver_=null,this.config_.streaming.observeQualityChanges&&(this.qualityObserver_=new shaka.media.QualityObserver((function(){return r.getBufferedInfo()})),this.qualityObserver_.addEventListener("qualitychange",(function(e){r.onMediaQualityChange_(e.quality,e.position)})));var n={networkingEngine:e,modifyManifestRequest:function(e,t){r.cmcdManager_.applyManifestData(e,t)},modifySegmentRequest:function(e,t){r.cmcdManager_.applySegmentData(e,t)},filter:function(e){return r.filterManifest_(e)},makeTextStreamsForClosedCaptions:function(e){return r.makeTextStreamsForClosedCaptions_(e)},onTimelineRegionAdded:function(e){return r.regionTimeline_.addRegion(e)},onEvent:function(e){return r.dispatchEvent(e)},onError:function(e){return r.onError_(e)},isLowLatencyMode:function(){return r.isLowLatencyMode_()},isAutoLowLatencyMode:function(){return r.isAutoLowLatencyMode_()},enableLowLatencyMode:function(){r.configure("streaming.lowLatencyMode",!0)},updateDuration:function(){r.streamingEngine_&&r.streamingEngine_.updateDuration()},newDrmInfo:function(e){var t=r.drmEngine_?r.drmEngine_.getDrmInfo():null;t&&r.drmEngine_.getMediaKeys()&&r.processDrmInfos_(t.keySystem,e)}},i=Date.now()/1e3;return new shaka.util.AbortableOperation(function(){var e,t,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress)return e=r,l.yield(r.parser_.start(a,n),2);if(e.manifest_=l.yieldResult,t=r.makeEvent_(shaka.util.FakeEvent.EventName.ManifestParsed),r.dispatchEvent(t),0==r.manifest_.variants.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.NO_VARIANTS);shaka.Player.filterForAVVariants_(r.manifest_),o=Date.now()/1e3,s=o-i,r.stats_.setManifestTime(s),l.jumpToEnd()}))}(),(function(){return shaka.log.info("Aborting parser step..."),r.parser_.stop()}))},shaka.Player.prototype.onInitializeDrm_=function(e,t){var r,a,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(goog.asserts.assert(e.mimeType==t.mimeType,"The load graph should have ensured the mime types matched."),goog.asserts.assert(e.uri==t.uri,"The load graph should have ensured the uris matched"),goog.asserts.assert(n.networkingEngine_,"|onInitializeDrm_| should never be called after |destroy|"),goog.asserts.assert(n.config_,"|onInitializeDrm_| should never be called after |destroy|"),goog.asserts.assert(n.manifest_,"|this.manifest_| should have been set in an earlier step."),goog.asserts.assert(e.mediaElement,"We should have a media element when initializing the DRM Engine."),r=Date.now()/1e3,a=!0,n.drmEngine_=n.createDrmEngine({netEngine:n.networkingEngine_,onError:function(e){n.onError_(e)},onKeyStatus:function(e){n.onKeyStatus_(e)},onExpirationUpdated:function(e,t){n.onExpirationUpdated_(e,t)},onEvent:function(e){n.dispatchEvent(e),e.type==shaka.util.FakeEvent.EventName.DrmSessionUpdate&&a&&(a=!1,e=Date.now()/1e3-r,n.stats_.setDrmTime(e),n.lcevcDil_&&n.lcevcDil_.hideCanvas())}}),n.drmEngine_.configure(n.config_.drm),i.yield(n.drmEngine_.initForPlayback(n.manifest_.variants,n.manifest_.offlineSessionIds),2)):3!=i.nextAddress?i.yield(n.drmEngine_.attach(e.mediaElement),3):i.yield(n.filterManifest_(n.manifest_),0)}))},shaka.Player.prototype.onLoad_=function(e,t){var r,a,n,i,o,s,l,u,c,d,p,h,f,g,y,m,v,_=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(k){switch(k.nextAddress){case 1:for(goog.asserts.assert(e.mimeType==t.mimeType,"|has| and |wants| should have the same mime type when loading."),goog.asserts.assert(e.uri==t.uri,"|has| and |wants| should have the same uri when loading."),goog.asserts.assert(e.mediaElement,"We should have a media element when loading."),goog.asserts.assert(!isNaN(t.startTimeOfLoad),"|wants| should tell us when the load was originally requested"),e.startTime=t.startTime,null!=_.updatedStartTime_&&(e.startTime=_.updatedStartTime_,_.updatedStartTime_=null),r=e.mediaElement,a=e.uri,_.assetUri_=a,_.playRateController_=new shaka.media.PlayRateController({getRate:function(){return r.playbackRate},getDefaultRate:function(){return r.defaultPlaybackRate},setRate:function(e){r.playbackRate=e},movePlayhead:function(e){r.currentTime+=e}}),n=function(){return _.updateStateHistory_()},i=function(){return _.onRateChange_()},_.loadEventManager_.listen(r,"playing",n),_.loadEventManager_.listen(r,"pause",n),_.loadEventManager_.listen(r,"ended",n),_.loadEventManager_.listen(r,"ratechange",i),_.setupLcevc_(_.config_),o=_.config_.abrFactory,_.abrManager_&&_.abrManagerFactory_==o||(_.abrManagerFactory_=o,_.abrManager_=o(),"function"!=typeof _.abrManager_.setMediaElement&&(shaka.Deprecate.deprecateFeature(5,"AbrManager","Please use an AbrManager with setMediaElement function."),_.abrManager_.setMediaElement=function(){}),_.abrManager_.configure(_.config_.abr)),_.currentAdaptationSetCriteria_=new shaka.media.PreferenceBasedCriteria(_.config_.preferredAudioLanguage,_.config_.preferredVariantRole,_.config_.preferredAudioChannelCount),_.currentTextLanguage_=_.config_.preferredTextLanguage,_.currentTextRole_=_.config_.preferredTextRole,_.currentTextForced_=_.config_.preferForcedSubs,shaka.Player.applyPlayRange_(_.manifest_.presentationTimeline,_.config_.playRangeStart,_.config_.playRangeEnd),_.abrManager_.init((function(e,t,r){return _.switch_(e,t,r)})),_.abrManager_.setMediaElement(r),shaka.util.StreamUtils.chooseCodecsAndFilterManifest(_.manifest_,_.config_.preferredVideoCodecs,_.config_.preferredAudioCodecs,_.config_.preferredAudioChannelCount,_.config_.preferredDecodingAttributes),_.streamingEngine_=_.createStreamingEngine(),_.streamingEngine_.configure(_.config_.streaming),_.loadMode_=shaka.Player.LoadMode.MEDIA_SOURCE,r.textTracks&&_.loadEventManager_.listen(r.textTracks,"addtrack",(function(e){if(e.track)switch(e=e.track,goog.asserts.assert(e instanceof TextTrack,"Wrong track type!"),e.kind){case"chapters":_.activateChaptersTrack_(e)}})),_.dispatchEvent(_.makeEvent_(shaka.util.FakeEvent.EventName.Streaming)),s=null,(l=_.streamingEngine_.getCurrentVariant())||(s=_.chooseVariant_(),goog.asserts.assert(s,"Must choose an initial variant!")),u=[],c=l||s,d=$jscomp.makeIterator([c.video,c.audio]),p=d.next();!p.done;p=d.next())(h=p.value)&&!h.segmentIndex&&u.push(h.createSegmentIndex());if(!(0<u.length)){k.jumpTo(2);break}return k.yield(Promise.all(u),2);case 2:if(_.playhead_=_.createPlayhead(e.startTime),_.playheadObservers_=_.createPlayheadObserversForMSE_(),f=Math.max(_.manifest_.minBufferTime,_.config_.streaming.rebufferingGoal),_.startBufferManagement_(f),l){k.jumpTo(4);break}if(goog.asserts.assert(s,"Must have choosen an initial variant!"),_.switchVariant_(s,!0,!1,0),!_.config_.streaming.startAtSegmentBoundary){k.jumpTo(5);break}return g=_.playhead_.getTime(),k.yield(_.adjustStartTime_(s,g),6);case 6:y=k.yieldResult,_.playhead_.setStartTime(y);case 5:_.onAdaptation_(null,shaka.util.StreamUtils.variantToTrack(s));case 4:return _.playhead_.ready(),_.getTextTracks().find((function(e){return e.active}))||((m=_.chooseTextStream_())&&_.addTextStreamToSwitchHistory_(m,!0),s&&_.setInitialTextState_(s,m),m&&_.shouldStreamText_()&&_.streamingEngine_.switchTextStream(m)),k.yield(_.streamingEngine_.start(),7);case 7:_.config_.abr.enabled&&(_.abrManager_.enable(),_.onAbrStatusChanged_()),_.filterManifestByCurrentVariant_(),_.onTracksChanged_(),_.updateAbrManagerVariants_(),v=_.manifest_.variants.some((function(e){return e.primary})),_.config_.preferredAudioLanguage||v||shaka.log.warning("No preferred audio language set.  We have chosen an arbitrary language initially"),_.fullyLoaded_=!0,_.loadEventManager_.listenOnce(r,"loadedmetadata",(function(){var e=Date.now()/1e3-t.startTimeOfLoad;_.stats_.setLoadLatency(e)})),k.jumpToEnd()}}))},shaka.Player.prototype.onInitializeSrcEqualsDrm_=function(e,t){var r,a,n,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){return 1==c.nextAddress?(r=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(u.networkingEngine_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),goog.asserts.assert(u.config_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),a=Date.now()/1e3,n=!0,u.drmEngine_=u.createDrmEngine({netEngine:u.networkingEngine_,onError:function(e){u.onError_(e)},onKeyStatus:function(e){u.onKeyStatus_(e)},onExpirationUpdated:function(e,t){u.onExpirationUpdated_(e,t)},onEvent:function(e){u.dispatchEvent(e),e.type==shaka.util.FakeEvent.EventName.DrmSessionUpdate&&n&&(n=!1,e=Date.now()/1e3-a,u.stats_.setDrmTime(e))}}),u.drmEngine_.configure(u.config_.drm),i=t.uri||"",o=shaka.media.ManifestParser.getExtension(i),"application/x-mpegurl"==(s=shaka.Player.SRC_EQUAL_EXTENSIONS_TO_MIME_TYPES_[o])&&shaka.util.Platform.isApple()&&(s="application/vnd.apple.mpegurl"),s||(s="video/mp4"),l={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:t.mimeType?shaka.util.MimeUtils.getBasicType(t.mimeType):s,codecs:t.mimeType?shaka.util.MimeUtils.getCodecs(t.mimeType):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",label:null,type:r.VIDEO,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},u.drmEngine_.setSrcEquals(!0),c.yield(u.drmEngine_.initForPlayback([l],[]),2)):c.yield(u.drmEngine_.attach(e.mediaElement),0)}))},shaka.Player.prototype.onSrcEquals_=function(e,t){var r=this;goog.asserts.assert(e.mediaElement,"We should have a media element when loading."),goog.asserts.assert(t.uri,"|has| should have a valid uri when loading."),goog.asserts.assert(!isNaN(t.startTimeOfLoad),"|wants| should tell us when the load was originally requested"),goog.asserts.assert(this.video_==e.mediaElement,"The video element should match our media element"),e.uri=t.uri,e.startTime=t.startTime,this.assetUri_=e.uri;var a=e.mediaElement;this.playhead_=new shaka.media.SrcEqualsPlayhead(a);var n=!1;this.cleanupOnUnload_.push((function(){n=!0})),null!=e.startTime&&this.playhead_.setStartTime(e.startTime),this.playRateController_=new shaka.media.PlayRateController({getRate:function(){return a.playbackRate},getDefaultRate:function(){return a.defaultPlaybackRate},setRate:function(e){a.playbackRate=e},movePlayhead:function(e){a.currentTime+=e}}),this.startBufferManagement_(this.config_.streaming.rebufferingGoal);var i=function(){return r.updateStateHistory_()};this.loadEventManager_.listen(a,"playing",i),this.loadEventManager_.listen(a,"pause",i),this.loadEventManager_.listen(a,"ended",i),this.loadEventManager_.listen(a,"ratechange",(function(){return r.onRateChange_()})),"none"!=a.preload&&this.loadEventManager_.listenOnce(a,"loadedmetadata",(function(){var e=Date.now()/1e3-t.startTimeOfLoad;r.stats_.setLoadLatency(e)})),a.audioTracks&&(this.loadEventManager_.listen(a.audioTracks,"addtrack",(function(){return r.onTracksChanged_()})),this.loadEventManager_.listen(a.audioTracks,"removetrack",(function(){return r.onTracksChanged_()})),this.loadEventManager_.listen(a.audioTracks,"change",(function(){return r.onTracksChanged_()}))),a.textTracks&&(this.loadEventManager_.listen(a.textTracks,"addtrack",(function(e){if(e.track)switch(e=e.track,goog.asserts.assert(e instanceof TextTrack,"Wrong track type!"),e.kind){case"metadata":r.processTimedMetadataSrcEqls_(e);break;case"chapters":r.activateChaptersTrack_(e);break;default:r.onTracksChanged_()}})),this.loadEventManager_.listen(a.textTracks,"removetrack",(function(){return r.onTracksChanged_()})),this.loadEventManager_.listen(a.textTracks,"change",(function(){return r.onTracksChanged_()}))),i=shaka.media.ManifestParser.getExtension(e.uri),a.src=this.cmcdManager_.appendSrcData(e.uri,shaka.Player.SRC_EQUAL_EXTENSIONS_TO_MIME_TYPES_[i]),(shaka.util.Platform.isTizen()||shaka.util.Platform.isWebOS())&&a.load(),this.loadMode_=shaka.Player.LoadMode.SRC_EQUALS,this.dispatchEvent(this.makeEvent_(shaka.util.FakeEvent.EventName.Streaming));var o=new shaka.util.PublicPromise;return shaka.util.MediaReadyState.waitForReadyState(a,HTMLMediaElement.HAVE_METADATA,this.loadEventManager_,(function(){r.playhead_.ready(),o.resolve()})),shaka.util.MediaReadyState.waitForReadyState(a,HTMLMediaElement.HAVE_CURRENT_DATA,this.loadEventManager_,(function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?(r.setupPreferredAudioOnSrc_(),(e=r.getFilteredTextTracks_()).find((function(e){return"disabled"!=e.mode}))?(0<e.length&&(r.isTextVisible_=!0),t.jumpTo(2)):t.yield(new Promise((function(e){r.loadEventManager_.listenOnce(a.textTracks,"change",e),new shaka.util.Timer(e).tickAfter(1)})),2)):n?t.return():(r.setupPreferredTextOnSrc_(),void t.jumpToEnd())}))})),a.error?o.reject(this.videoErrorToShakaError_()):"none"==a.preload&&(shaka.log.alwaysWarn('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),o.resolve()),this.loadEventManager_.listenOnce(a,"error",(function(){o.reject(r.videoErrorToShakaError_())})),new shaka.util.AbortableOperation(o,(function(){var e=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);return o.reject(e),Promise.resolve()})).chain((function(){r.fullyLoaded_=!0}))},shaka.Player.prototype.setupPreferredAudioOnSrc_=function(){var e=this.config_.preferredAudioLanguage;if(""!=e){this.selectAudioLanguage(e);var t=this.config_.preferredVariantRole;""!=t&&this.selectAudioLanguage(e,t)}},shaka.Player.prototype.setupPreferredTextOnSrc_=function(){var e=this.config_.preferredTextLanguage,t=this.config_.preferForcedSubs;if(""!=e){this.selectTextLanguage(e,"",t);var r=this.config_.preferredTextRole;""!=r&&this.selectTextLanguage(e,r,t)}},shaka.Player.prototype.processTimedMetadataSrcEqls_=function(e){var t=this;if("metadata"==e.kind){e.mode="hidden",this.loadEventManager_.listen(e,"cuechange",(function(){if(e.activeCues)for(var r=$jscomp.makeIterator(e.activeCues),a=r.next();!a.done;a=r.next())a=a.value,t.dispatchMetadataEvent_(a.startTime,a.endTime,a.type,a.value),t.adManager_&&t.adManager_.onCueMetadataChange(a.value)}));var r=new shaka.util.Timer((function(){for(var e=t.getMetadataTracks_(),r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())r.value.mode="hidden"})).tickNow().tickAfter(.5);this.cleanupOnUnload_.push((function(){r.stop()}))}},shaka.Player.prototype.processTimedMetadataMediaSrc_=function(e,t,r){for(var a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())if((a=a.value).data&&a.cueTime&&a.frames){var n=a.cueTime+t,i=r;i&&n>i&&(i=n);for(var o=$jscomp.makeIterator(a.frames),s=o.next();!s.done;s=o.next())this.dispatchMetadataEvent_(n,i,"org.id3",s.value);this.adManager_&&this.adManager_.onHlsTimedMetadata(a,n)}},shaka.Player.prototype.dispatchMetadataEvent_=function(e,t,r,a){goog.asserts.assert(!t||e<=t,"Metadata start time should be less or equal to the end time!");var n=shaka.util.FakeEvent.EventName.Metadata;e=(new Map).set("startTime",e).set("endTime",t).set("metadataType",r).set("payload",a),this.dispatchEvent(this.makeEvent_(n,e))},shaka.Player.prototype.activateChaptersTrack_=function(e){if(e&&"chapters"==e.kind){e.mode="hidden";var t=new shaka.util.Timer((function(){e.mode="hidden"})).tickNow().tickAfter(.5);this.cleanupOnUnload_.push((function(){t.stop()}))}},shaka.Player.filterForAVVariants_=function(e){var t=function(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")};e.variants.some(t)&&(shaka.log.debug("Found variant with audio and video content, so filtering out audio-only content."),e.variants=e.variants.filter(t))},shaka.Player.prototype.createDrmEngine=function(e){return new shaka.media.DrmEngine(e,this.config_.drm.updateExpirationTime)},shaka.Player.prototype.createNetworkingEngine=function(){var e=this;return new shaka.net.NetworkingEngine((function(t,r){e.abrManager_&&e.abrManager_.segmentDownloaded(t,r)}),(function(t,r,a){var n=shaka.util.FakeEvent.EventName.DownloadHeadersReceived;t=(new Map).set("headers",t).set("request",r).set("requestType",a),e.dispatchEvent(e.makeEvent_(n,t))}),(function(t,r,a,n){var i=shaka.util.FakeEvent.EventName.DownloadFailed;t=(new Map).set("request",t).set("error",r).set("httpResponseCode",a).set("aborted",n),e.dispatchEvent(e.makeEvent_(i,t))}))},shaka.Player.prototype.createPlayhead=function(e){var t=this;return goog.asserts.assert(this.manifest_,"Must have manifest"),goog.asserts.assert(this.video_,"Must have video"),new shaka.media.MediaSourcePlayhead(this.video_,this.manifest_,this.config_.streaming,e,(function(){return t.onSeek_()}),(function(e){return t.dispatchEvent(e)}))},shaka.Player.prototype.createPlayheadObserversForMSE_=function(){var e=this;goog.asserts.assert(this.manifest_,"Must have manifest"),goog.asserts.assert(this.regionTimeline_,"Must have region timeline"),goog.asserts.assert(this.video_,"Must have video element");var t=new shaka.media.RegionObserver(this.regionTimeline_);t.addEventListener("enter",(function(t){e.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionEnter,t.region)})),t.addEventListener("exit",(function(t){e.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionExit,t.region)})),t.addEventListener("skip",(function(t){var r=t.region;t.seeking||(e.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionEnter,r),e.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionExit,r))}));var r=new shaka.media.PlayheadObserverManager(this.video_);return r.manage(t),this.qualityObserver_&&r.manage(this.qualityObserver_),r},shaka.Player.prototype.startBufferManagement_=function(e){var t=this;goog.asserts.assert(!this.bufferObserver_,"No buffering observer should exist before initialization."),goog.asserts.assert(!this.bufferPoller_,"No buffer timer should exist before initialization."),this.bufferObserver_=new shaka.media.BufferingObserver(1,2),this.bufferObserver_.setState(shaka.media.BufferingObserver.State.STARVING),this.updateBufferingSettings_(e),this.updateBufferState_(),this.bufferPoller_=new shaka.util.Timer((function(){t.pollBufferState_()})).tickEvery(.25)},shaka.Player.prototype.updateBufferingSettings_=function(e){this.bufferObserver_.setThresholds(e,Math.min(shaka.Player.TYPICAL_BUFFERING_THRESHOLD_,e/2))},shaka.Player.prototype.pollBufferState_=function(){switch(goog.asserts.assert(this.video_,"Need a media element to update the buffering observer"),goog.asserts.assert(this.bufferObserver_,"Need a buffering observer to update"),this.loadMode_){case shaka.Player.LoadMode.SRC_EQUALS:var e=this.isBufferedToEndSrc_();break;case shaka.Player.LoadMode.MEDIA_SOURCE:e=this.isBufferedToEndMS_();break;default:e=!1}var t=shaka.media.TimeRangesUtils.bufferedAheadOf(this.video_.buffered,this.video_.currentTime);this.bufferObserver_.update(t,e)&&this.updateBufferState_()},shaka.Player.prototype.createMediaSourceEngine=function(e,t,r,a){return new shaka.media.MediaSourceEngine(e,t,r,a)},shaka.Player.prototype.createCmcd_=function(){var e=this;return new shaka.util.CmcdManager({getBandwidthEstimate:function(){return e.abrManager_?e.abrManager_.getBandwidthEstimate():NaN},getBufferedInfo:function(){return e.getBufferedInfo()},getCurrentTime:function(){return e.video_?e.video_.currentTime:0},getVariantTracks:function(){return e.getVariantTracks()},getPlaybackRate:function(){return e.getPlaybackRate()},isLive:function(){return e.isLive()}},this.config_.cmcd)},shaka.Player.prototype.createStreamingEngine=function(){var e=this;return goog.asserts.assert(this.abrManager_&&this.mediaSourceEngine_&&this.cmcdManager_&&this.manifest_,"Must not be destroyed"),new shaka.media.StreamingEngine(this.manifest_,{getPresentationTime:function(){return e.playhead_?e.playhead_.getTime():0},getBandwidthEstimate:function(){return e.abrManager_.getBandwidthEstimate()},modifySegmentRequest:function(t,r){e.cmcdManager_.applySegmentData(t,r)},mediaSourceEngine:this.mediaSourceEngine_,netEngine:this.networkingEngine_,onError:function(t){return e.onError_(t)},onEvent:function(t){return e.dispatchEvent(t)},onManifestUpdate:function(){return e.onManifestUpdate_()},onSegmentAppended:function(t,r,a){e.onSegmentAppended_(t,r,a)},onInitSegmentAppended:function(t,r){(r=r.getMediaQuality())&&e.qualityObserver_&&e.qualityObserver_.addMediaQualityChange(r,t)},beforeAppendSegment:function(t,r){return e.drmEngine_.parseInbandPssh(t,r)},onMetadata:function(t,r,a){e.processTimedMetadataMediaSrc_(t,r,a)}})},shaka.Player.prototype.configure=function(e,t){goog.asserts.assert(this.config_,"Config must not be null!"),goog.asserts.assert("object"==typeof e||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=shaka.util.ConfigUtils.convertToConfigObject(e,t)),goog.asserts.assert("object"==typeof e,"Should be an object!"),e.streaming&&"forceTransmuxTS"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.forceTransmuxTS configuration","Please Use streaming.forceTransmux instead."),e.streaming.forceTransmux=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&e.streaming.lowLatencyMode&&(null==e.streaming.inaccurateManifestTolerance&&(e.streaming.inaccurateManifestTolerance=0),null==e.streaming.rebufferingGoal&&(e.streaming.rebufferingGoal=.01));var r=shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,e,this.defaultConfig_());return this.applyConfig_(),r},shaka.Player.prototype.applyConfig_=function(){if(this.parser_){var e=shaka.util.ObjectUtils.cloneObject(this.config_.manifest);this.video_&&"AUDIO"===this.video_.nodeName&&(e.disableVideo=!0),this.parser_.configure(e)}if(this.drmEngine_&&this.drmEngine_.configure(this.config_.drm),this.streamingEngine_){this.streamingEngine_.configure(this.config_.streaming);try{this.filterManifestWithRestrictions_(this.manifest_)}catch(e){this.onError_(e)}this.abrManager_&&this.updateAbrManagerVariants_(),!(e=this.streamingEngine_.getCurrentVariant())||e.allowedByApplication&&e.allowedByKeySystem||(shaka.log.debug("Choosing new variant after changing configuration"),this.chooseVariantAndSwitch_())}if(this.networkingEngine_&&this.networkingEngine_.setForceHTTPS(this.config_.streaming.forceHTTPS),this.mediaSourceEngine_&&(this.mediaSourceEngine_.configure(this.config_.mediaSource),this.mediaSourceEngine_.setSegmentRelativeVttTiming(this.config_.manifest.segmentRelativeVttTiming),e=this.config_.textDisplayFactory,this.lastTextFactory_!=e)){var t=e();this.mediaSourceEngine_.setTextDisplayer(t),this.lastTextFactory_=e,this.streamingEngine_&&this.streamingEngine_.reloadTextStream()}this.abrManager_&&(this.abrManager_.configure(this.config_.abr),this.config_.abr.enabled?this.abrManager_.enable():this.abrManager_.disable(),this.onAbrStatusChanged_()),this.bufferObserver_&&(e=this.config_.streaming.rebufferingGoal,this.manifest_&&(e=Math.max(e,this.manifest_.minBufferTime)),this.updateBufferingSettings_(e)),this.manifest_&&shaka.Player.applyPlayRange_(this.manifest_.presentationTimeline,this.config_.playRangeStart,this.config_.playRangeEnd)},shaka.Player.prototype.getConfiguration=function(){goog.asserts.assert(this.config_,"Config must not be null!");var e=this.defaultConfig_();return shaka.util.PlayerConfiguration.mergeConfigObjects(e,this.config_,this.defaultConfig_()),e},shaka.Player.prototype.getSharedConfiguration=function(){return goog.asserts.assert(this.config_,"Cannot call getSharedConfiguration after call destroy!"),this.config_},shaka.Player.prototype.getBufferFullness=function(){if(this.video_){var e=this.video_.buffered.length;e=e?this.video_.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(e>=(t=Math.min(this.video_.currentTime+t,this.seekRange().end)))return 1;if(!(e<=this.video_.currentTime)&&e<t)return(e-this.video_.currentTime)/(t-this.video_.currentTime)}return 0},shaka.Player.prototype.resetConfiguration=function(){for(var e in goog.asserts.assert(this.config_,"Cannot be destroyed"),this.config_)delete this.config_[e];shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,this.defaultConfig_(),this.defaultConfig_()),this.applyConfig_()},shaka.Player.prototype.getLoadMode=function(){return this.loadMode_},shaka.Player.prototype.getMediaElement=function(){return this.video_},shaka.Player.prototype.getNetworkingEngine=function(){return this.networkingEngine_},shaka.Player.prototype.getAssetUri=function(){return this.assetUri_},shaka.Player.prototype.getAdManager=function(){return this.adManager_?this.adManager_:null},shaka.Player.prototype.isLive=function(){return this.manifest_?this.manifest_.presentationTimeline.isLive():!(!this.video_||!this.video_.src)&&1/0==this.video_.duration},shaka.Player.prototype.isInProgress=function(){return!!this.manifest_&&this.manifest_.presentationTimeline.isInProgress()},shaka.Player.prototype.isAudioOnly=function(){if(this.manifest_){var e=this.manifest_.variants;return!!e.length&&!e[0].video}return!(!this.video_||!this.video_.src)&&(this.video_.videoTracks?0==this.video_.videoTracks.length:0==this.video_.videoHeight)},shaka.Player.prototype.isLowLatencyMode_=function(){return this.config_.streaming.lowLatencyMode},shaka.Player.prototype.isAutoLowLatencyMode_=function(){return this.config_.streaming.autoLowLatencyMode},shaka.Player.prototype.seekRange=function(){if(!this.fullyLoaded_)return{start:0,end:0};if(this.manifest_){var e=this.manifest_.presentationTimeline;return{start:e.getSeekRangeStart(),end:e.getSeekRangeEnd()}}return this.video_&&this.video_.src&&(e=this.video_.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},shaka.Player.prototype.goToLive=function(){this.isLive()?this.video_.currentTime=this.seekRange().end:shaka.log.warning("goToLive is for live streams!")},shaka.Player.prototype.keySystem=function(){return shaka.media.DrmEngine.keySystem(this.drmInfo())},shaka.Player.prototype.drmInfo=function(){return this.drmEngine_?this.drmEngine_.getDrmInfo():null},shaka.Player.prototype.getDrmEngine=function(){return this.drmEngine_},shaka.Player.prototype.getExpiration=function(){return this.drmEngine_?this.drmEngine_.getExpiration():1/0},shaka.Player.prototype.getKeyStatuses=function(){return this.drmEngine_?this.drmEngine_.getKeyStatuses():{}},shaka.Player.prototype.isBuffering=function(){var e=shaka.media.BufferingObserver.State;return!!this.bufferObserver_&&this.bufferObserver_.getState()==e.STARVING},shaka.Player.prototype.getPlaybackRate=function(){return this.video_?this.playRateController_?this.playRateController_.getRealRate():1:0},shaka.Player.prototype.trickPlay=function(e){goog.asserts.assert(0!=e,"Should never set a trick play rate of 0!"),0==e?shaka.log.alwaysWarn("A trick play rate of 0 is unsupported!"):(this.video_.paused&&this.video_.play(),this.playRateController_.set(e),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&(this.abrManager_.playbackRateChanged(e),this.streamingEngine_.setTrickPlay(1<Math.abs(e))))},shaka.Player.prototype.cancelTrickPlay=function(){var e=this.playRateController_.getDefaultRate();this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&this.playRateController_.set(e),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&(this.playRateController_.set(e),this.abrManager_.playbackRateChanged(e),this.streamingEngine_.setTrickPlay(!1))},shaka.Player.prototype.getVariantTracks=function(){if(this.manifest_){for(var e=this.streamingEngine_?this.streamingEngine_.getCurrentVariant():null,t=[],r=0,a=$jscomp.makeIterator(this.manifest_.variants),n=a.next();!n.done;n=a.next())if(n=n.value,shaka.util.StreamUtils.isPlayable(n)){var i=shaka.util.StreamUtils.variantToTrack(n);i.active=n==e,i.active||1==r||null==e||n.video!=e.video||n.audio!=e.audio||(i.active=!0),i.active&&r++,t.push(i)}return goog.asserts.assert(1>=r,"It should only have one active track"),t}return this.video_&&this.video_.audioTracks?Array.from(this.video_.audioTracks).map((function(e){return shaka.util.StreamUtils.html5AudioTrackToTrack(e)})):[]},shaka.Player.prototype.getTextTracks=function(){if(this.manifest_){for(var e=this.streamingEngine_?this.streamingEngine_.getCurrentTextStream():null,t=[],r=$jscomp.makeIterator(this.manifest_.textStreams),a=r.next();!a.done;a=r.next()){a=a.value;var n=shaka.util.StreamUtils.textStreamToTrack(a);n.active=a==e,t.push(n)}return t}if(this.video_&&this.video_.src&&this.video_.textTracks){e=this.getFilteredTextTracks_();var i=shaka.util.StreamUtils;return e.map((function(e){return i.html5TextTrackToTrack(e)}))}return[]},shaka.Player.prototype.getImageTracks=function(){if(this.manifest_){var e=shaka.util.StreamUtils;return this.manifest_.imageStreams.map((function(t){return e.imageStreamToTrack(t)}))}return[]},shaka.Player.prototype.getThumbnails=function(e,t){var r,a,n,i,o,s,l,u,c,d,p,h,f,g,y,m,v,_,k,E,T=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(b){return 1==b.nextAddress?T.manifest_?(r=T.manifest_.imageStreams.find((function(t){return t.id==e})))?r.segmentIndex?b.jumpTo(3):b.yield(r.createSegmentIndex(),3):b.return(null):b.jumpTo(2):2!=b.nextAddress?null==(a=r.segmentIndex.find(t))?b.return(null):(n=r.segmentIndex.get(a),i=n.getTilesLayout()||r.tilesLayout,(o=/(\d+)x(\d+)/.exec(i))?(s=r.width||0,l=r.height||0,u=parseInt(o[1],10),c=parseInt(o[2],10),d=s/u,p=l/c,h=u*c,f=n.trueEndTime-n.startTime,g=n.getTileDuration()||f/h,y=n.startTime,v=m=0,1<h&&(_=Math.floor((t-n.startTime)/g),y=n.startTime+_*g,m=_%u*d,v=Math.floor(_/u)*p),k=!1,(E=n.getThumbnailSprite())&&(k=!0,p=E.height,m=E.positionX,v=E.positionY,d=E.width),b.return({imageHeight:l,imageWidth:s,height:p,positionX:m,positionY:v,startTime:y,duration:g,uris:n.getUris(),width:d,sprite:k})):(shaka.log.warning("Tiles layout does not contain a valid format  (columns x rows)"),b.return(null))):b.return(null)}))},shaka.Player.prototype.selectTextTrack=function(e){if(this.manifest_&&this.streamingEngine_){var t=this.manifest_.textStreams.find((function(t){return t.id==e.id}));t?t==this.streamingEngine_.getCurrentTextStream()?shaka.log.debug("Text track already selected."):(this.addTextStreamToSwitchHistory_(t,!1),this.streamingEngine_.switchTextStream(t),this.onTextChanged_(),this.currentTextLanguage_=t.language):shaka.log.error("No stream with id",e.id)}else if(this.video_&&this.video_.src&&this.video_.textTracks){t=this.getFilteredTextTracks_();for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=r.value,shaka.util.StreamUtils.html5TrackId(r)==e.id?r.mode=this.isTextVisible_?"showing":"hidden":r.mode="disabled";this.onTextChanged_()}},shaka.Player.prototype.selectVariantTrack=function(e,t,r){if(t=void 0!==t&&t,r=void 0===r?0:r,this.manifest_&&this.streamingEngine_){this.config_.abr.enabled&&shaka.log.alwaysWarn("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var a=this.manifest_.variants.find((function(t){return t.id==e.id}));a?shaka.util.StreamUtils.isPlayable(a)?(this.switchVariant_(a,!1,t,r),this.currentAdaptationSetCriteria_=new shaka.media.ExampleBasedCriteria(a),this.updateAbrManagerVariants_()):shaka.log.error("Unable to switch to restricted track",e.id):shaka.log.error("No variant with id",e.id)}else if(this.video_&&this.video_.audioTracks)for(t=Array.from(this.video_.audioTracks),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())if(r=r.value,shaka.util.StreamUtils.html5TrackId(r)==e.id){this.switchHtml5Track_(r);break}},shaka.Player.prototype.getAudioLanguagesAndRoles=function(){return shaka.Player.getLanguageAndRolesFrom_(this.getVariantTracks())},shaka.Player.prototype.getTextLanguagesAndRoles=function(){return shaka.Player.getLanguageAndRolesFrom_(this.getTextTracks())},shaka.Player.prototype.getAudioLanguages=function(){return Array.from(shaka.Player.getLanguagesFrom_(this.getVariantTracks()))},shaka.Player.prototype.getTextLanguages=function(){return Array.from(shaka.Player.getLanguagesFrom_(this.getTextTracks()))},shaka.Player.prototype.selectAudioLanguage=function(e,t,r){r=void 0===r?0:r;var a=shaka.util.LanguageUtils;if(this.manifest_&&this.playhead_){this.currentAdaptationSetCriteria_=new shaka.media.PreferenceBasedCriteria(e,t||"",r,""),t=function(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0},a=this.streamingEngine_.getCurrentVariant(),r=this.currentAdaptationSetCriteria_.create(this.manifest_.variants),e=null;for(var n=(r=$jscomp.makeIterator(r.values())).next();!n.done;n=r.next())n=n.value,(!e||t(e,a)>t(n,a))&&(e=n);e?(t=shaka.util.StreamUtils.variantToTrack(e),this.selectVariantTrack(t,!0)):this.chooseVariantAndSwitch_()}else if(this.video_&&this.video_.audioTracks){var i=Array.from(this.video_.audioTracks);e=a.normalize(e),n=r=null;for(var o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next()){o=o.value;var s=shaka.util.StreamUtils.html5AudioTrackToTrack(o);a.normalize(s.language)==e&&(r=o,t?s.roles.includes(t)&&(n=o):0==s.roles.length&&(n=o))}n?this.switchHtml5Track_(n):r&&this.switchHtml5Track_(r)}},shaka.Player.prototype.selectTextLanguage=function(e,t,r){r=void 0!==r&&r;var a=shaka.util.LanguageUtils;if(this.manifest_&&this.playhead_)this.currentTextLanguage_=e,this.currentTextRole_=t||"",this.currentTextForced_=r,(e=this.chooseTextStream_())&&(e==this.streamingEngine_.getCurrentTextStream()?shaka.log.debug("Text track already selected."):(this.addTextStreamToSwitchHistory_(e,!1),this.shouldStreamText_()&&(this.streamingEngine_.switchTextStream(e),this.onTextChanged_())));else{var n=a.normalize(e);(e=this.getTextTracks().find((function(e){return a.normalize(e.language)==n&&(!t||e.roles.includes(t))&&e.forced==r})))&&this.selectTextTrack(e)}},shaka.Player.prototype.selectVariantsByLabel=function(e){if(this.manifest_&&this.playhead_){for(var t=null,r=$jscomp.makeIterator(this.manifest_.variants),a=r.next();!a.done;a=r.next())if((a=a.value).audio.label==e){t=a;break}null==t?shaka.log.warning("No variants were found with label: "+e+". Ignoring the request to switch."):(this.currentAdaptationSetCriteria_=new shaka.media.PreferenceBasedCriteria(t.language,"",0,e),this.chooseVariantAndSwitch_())}},shaka.Player.prototype.isTextTrackVisible=function(){var e=this.isTextVisible_;if(this.mediaSourceEngine_){var t=this.mediaSourceEngine_.getTextDisplayer().isTextVisible();return goog.asserts.assert(t==e,"text visibility has fallen out of sync"),t}return this.video_&&this.video_.src&&this.video_.textTracks?this.getFilteredTextTracks_().some((function(e){return"showing"==e.mode})):e},shaka.Player.prototype.getChaptersTracks=function(){if(this.video_&&this.video_.src&&this.video_.textTracks){var e=this.getChaptersTracks_(),t=shaka.util.StreamUtils;return e.map((function(e){return t.html5TextTrackToTrack(e)}))}return[]},shaka.Player.prototype.getChapters=function(e){var t=shaka.util.LanguageUtils,r=t.normalize(e),a=this.getChaptersTracks_().filter((function(e){return t.normalize(e.language)==r}));if(!a||!a.length)return[];e=[];for(var n=new Set,i=(a=$jscomp.makeIterator(a)).next();!i.done;i=a.next())if((i=i.value)&&i.cues)for(var o=(i=$jscomp.makeIterator(i.cues)).next();!o.done;o=i.next()){var s=o.value;(o=s.id)&&""!=o||(o=s.startTime+"-"+s.endTime+"-"+s.text),s={id:o,title:s.text,startTime:s.startTime,endTime:s.endTime},n.has(o)||(e.push(s),n.add(o))}return e},shaka.Player.prototype.getFilteredTextTracks_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&e.label!=shaka.Player.TextTrackLabel}))},shaka.Player.prototype.getMetadataTracks_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).filter((function(e){return"metadata"==e.kind}))},shaka.Player.prototype.getChaptersTracks_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).filter((function(e){return"chapters"==e.kind}))},shaka.Player.prototype.setTextTrackVisibility=function(e){if(e=!!e,this.isTextVisible_!=e){if(this.isTextVisible_=e,this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE)this.mediaSourceEngine_.getTextDisplayer().setTextVisibility(e),this.config_.streaming.alwaysStreamText||(e?this.streamingEngine_.getCurrentTextStream()||0<(e=shaka.util.StreamUtils.filterStreamsByLanguageAndRole(this.manifest_.textStreams,this.currentTextLanguage_,this.currentTextRole_,this.currentTextForced_)).length&&(this.streamingEngine_.switchTextStream(e[0]),this.onTextChanged_()):this.streamingEngine_.unloadTextStream());else if(this.video_&&this.video_.src&&this.video_.textTracks)for(var t=this.getFilteredTextTracks_(),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())"disabled"!=(r=r.value).mode&&(r.mode=e?"showing":"hidden");this.onTextTrackVisibility_()}},shaka.Player.prototype.getPlayheadTimeAsDate=function(){if(!this.isLive())return shaka.log.warning("getPlayheadTimeAsDate is for live streams!"),null;var e=this.walker_.getCurrentPayload(),t=0;if(this.playhead_)t=this.playhead_.getTime();else if(e){if(null==e.startTime)return new Date;t=e.startTime}return this.manifest_?(e=this.manifest_.presentationTimeline.getPresentationStartTime(),new Date(1e3*(e+t))):this.video_&&this.video_.getStartDate?(e=this.video_.getStartDate(),isNaN(e.getTime())?(shaka.log.warning("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(e.getTime()+1e3*t)):(shaka.log.warning("No way to get playhead time as Date!"),null)},shaka.Player.prototype.getPresentationStartTimeAsDate=function(){if(!this.isLive())return shaka.log.warning("getPresentationStartTimeAsDate is for live streams!"),null;if(this.manifest_){var e=this.manifest_.presentationTimeline.getPresentationStartTime();return goog.asserts.assert(null!=e,"Presentation start time should not be null!"),new Date(1e3*e)}return this.video_&&this.video_.getStartDate?(e=this.video_.getStartDate(),isNaN(e.getTime())?(shaka.log.warning("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):e):(shaka.log.warning("No way to get presentation start time as Date!"),null)},shaka.Player.prototype.getBufferedInfo=function(){if(this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE)return this.mediaSourceEngine_.getBufferedInfo();var e={total:[],audio:[],video:[],text:[]};return this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&(e.total=shaka.media.TimeRangesUtils.getBufferedInfo(this.video_.buffered)),e},shaka.Player.prototype.getStats=function(){if(this.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&this.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)return shaka.util.Stats.getEmptyBlob();this.updateStateHistory_(),goog.asserts.assert(this.video_,"If we have stats, we should have video_");var e=this.video_,t=e.currentTime/e.duration;if(isNaN(t)||this.stats_.setCompletionPercent(Math.round(100*t)),this.playhead_&&(this.stats_.setGapsJumped(this.playhead_.getGapsJumped()),this.stats_.setStallsDetected(this.playhead_.getStallsDetected())),e.getVideoPlaybackQuality&&(t=e.getVideoPlaybackQuality(),this.stats_.setDroppedFrames(Number(t.droppedVideoFrames),Number(t.totalVideoFrames)),this.stats_.setCorruptedFrames(Number(t.corruptedVideoFrames))),t=this.drmEngine_?this.drmEngine_.getLicenseTime():NaN,this.stats_.setLicenseTime(t),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE){if(t=this.streamingEngine_.getCurrentVariant()){var r=(this.playRateController_?this.playRateController_.getRealRate():1)*t.bandwidth;this.stats_.setCurrentStreamBandwidth(r)}t&&t.video&&this.stats_.setResolution(t.video.width||NaN,t.video.height||NaN),this.isLive()&&(t=this.getPresentationStartTimeAsDate().valueOf()+1e3*this.seekRange().end,t=(Date.now()-t)/1e3,this.stats_.setLiveLatency(t)),this.manifest_&&this.manifest_.presentationTimeline&&(t=this.manifest_.presentationTimeline.getMaxSegmentDuration(),this.stats_.setMaxSegmentDuration(t)),t=this.abrManager_.getBandwidthEstimate(),this.stats_.setBandwidthEstimate(t)}return this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&this.stats_.setResolution(e.videoWidth||NaN,e.videoHeight||NaN),this.stats_.getBlob()},shaka.Player.prototype.addTextTrackAsync=function(e,t,r,a,n,i,o){o=void 0!==o&&o;var s,l,u,c,d,p,h,f,g,y,m=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){switch(v.nextAddress){case 1:if(m.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&m.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Must call load() and wait for it to resolve before adding text tracks."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.CONTENT_NOT_LOADED);if(a){v.jumpTo(2);break}return v.yield(m.getTextMimetype_(e),3);case 3:a=v.yieldResult;case 2:if(s=[],m.adManager_)try{s=m.adManager_.getServerSideCuePoints()}catch(e){}if(m.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS){v.jumpTo(4);break}return o&&(r="forced"),v.yield(m.addSrcTrackElement_(e,t,r,a,i||"",s),5);case 5:if(l=m.getTextTracks(),u=l.find((function(e){return e.language==t&&e.label==(i||"")&&e.kind==r})))return m.onTracksChanged_(),v.return(u);throw shaka.log.error("Cannot add this text when loaded with src="),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS);case 4:if(c=shaka.util.ManifestParserUtils.ContentType,1/0==(d=m.manifest_.presentationTimeline.getDuration()))throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM);if(!s.length){v.jumpTo(6);break}return goog.asserts.assert(m.networkingEngine_,"Need networking engine."),v.yield(m.getTextData_(e,m.networkingEngine_,m.config_.streaming.retryParameters),7);case 7:p=v.yieldResult,h=m.convertToWebVTT_(p,a,s),f=new Blob([h],{type:"text/vtt"}),e=shaka.media.MediaSourceEngine.createObjectURL(f),a="text/vtt";case 6:if(g={id:m.nextExternalStreamId_++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:shaka.media.SegmentIndex.forSingleSegment(0,d,[e]),mimeType:a||"",codecs:n||"",kind:r,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,label:i||null,type:c.TEXT,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},y=shaka.util.MimeUtils.getFullType(g.mimeType,g.codecs),!shaka.text.TextEngine.isTypeSupported(y))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,a);return m.manifest_.textStreams.push(g),m.onTracksChanged_(),v.return(shaka.util.StreamUtils.textStreamToTrack(g))}}))},shaka.Player.prototype.addThumbnailsTrack=function(e,t){var r,a,n,i,o,s,l,u,c,d,p,h,f,g,y,m,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:if(v.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&v.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Must call load() and wait for it to resolve before adding image tracks."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.CONTENT_NOT_LOADED);if(v.loadMode_==shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Cannot add this thumbnail track when loaded with src="),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_SRC_EQUALS);if(t){_.jumpTo(2);break}return _.yield(v.getTextMimetype_(e),3);case 3:t=_.yieldResult;case 2:if("text/vtt"!=t)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.UNSUPPORTED_EXTERNAL_THUMBNAILS_URI,e);if(r=shaka.util.ManifestParserUtils.ContentType,1/0==(a=v.manifest_.presentationTimeline.getDuration()))throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM);return goog.asserts.assert(v.networkingEngine_,"Need networking engine."),_.yield(v.getTextData_(e,v.networkingEngine_,v.config_.streaming.retryParameters),4);case 4:if(n=_.yieldResult,!(i=shaka.text.TextEngine.findParser(t)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,t);for(o=i(),s={periodStart:0,segmentStart:0,segmentEnd:a,vttOffset:0},l=shaka.util.BufferUtils.toUint8(n),u=o.parseMedia(l,s),c=[],d={},p=$jscomp.makeIterator(u),h=p.next();!h.done;d={$jscomp$loop$prop$imageUri$657:d.$jscomp$loop$prop$imageUri$657},h=p.next())f=h.value,d.$jscomp$loop$prop$imageUri$657=shaka.util.ManifestParserUtils.resolveUris([e],[f.payload])[0],g=new shaka.media.SegmentReference(f.startTime,f.endTime,function(e){return function(){return[e.$jscomp$loop$prop$imageUri$657]}}(d),0,null,null,0,0,1/0),d.$jscomp$loop$prop$imageUri$657.includes("#xywh")&&(4===(y=d.$jscomp$loop$prop$imageUri$657.split("#xywh=")[1].split(",")).length&&g.setThumbnailSprite({height:parseInt(y[3],10),positionX:parseInt(y[0],10),positionY:parseInt(y[1],10),width:parseInt(y[2],10)})),c.push(g);return m={id:v.nextExternalStreamId_++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new shaka.media.SegmentIndex(c),mimeType:t||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",label:null,type:r.IMAGE,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1"},v.manifest_.imageStreams.push(m),v.onTracksChanged_(),_.return(shaka.util.StreamUtils.imageStreamToTrack(m))}}))},shaka.Player.prototype.addChaptersTrack=function(e,t,r){var a,n,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(s.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&s.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Must call load() and wait for it to resolve before adding chapters tracks."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.CONTENT_NOT_LOADED);if(r){l.jumpTo(2);break}return l.yield(s.getTextMimetype_(e),3);case 3:r=l.yieldResult;case 2:if(a=[],s.adManager_)try{a=s.adManager_.getServerSideCuePoints()}catch(e){}return l.yield(s.addSrcTrackElement_(e,t,"chapters",r,"",a),4);case 4:if(n=l.yieldResult,i=s.getChaptersTracks(),!(o=i.find((function(e){return e.language==t})))){l.jumpTo(5);break}return l.yield(new Promise((function(e,t){s.loadEventManager_.listenOnce(n,"load",e),s.loadEventManager_.listenOnce(n,"error",(function(e){t(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CHAPTERS_TRACK_FAILED))}))})),6);case 6:return l.return(o);case 5:throw shaka.log.error("Cannot add this text when loaded with src="),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS)}}))},shaka.Player.prototype.getTextMimetype_=function(e){var t,r,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){switch(n.nextAddress){case 1:return t=shaka.media.ManifestParser.getExtension(e),(r=shaka.Player.TEXT_EXTENSIONS_TO_MIME_TYPES_[t])?n.return(r):(n.setCatchFinallyBlocks(2),goog.asserts.assert(a.networkingEngine_,"Need networking engine."),n.yield(shaka.media.ManifestParser.getMimeType(e,a.networkingEngine_,a.config_.streaming.retryParameters),4));case 4:r=n.yieldResult,n.leaveTryBlock(3);break;case 2:n.enterCatchBlock();case 3:if(r)return n.return(r);throw shaka.log.error("The mimeType has not been provided and it could not be deduced from its extension."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.TEXT_COULD_NOT_GUESS_MIME_TYPE,t)}}))};shaka.Player.prototype.addSrcTrackElement_=function(e,t,r,a,n,i){var o,s,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){return 1==d.nextAddress?"text/vtt"!=a||i.length?(goog.asserts.assert(c.networkingEngine_,"Need networking engine."),d.yield(c.getTextData_(e,c.networkingEngine_,c.config_.streaming.retryParameters),3)):d.jumpTo(2):(2!=d.nextAddress&&(o=d.yieldResult,s=c.convertToWebVTT_(o,a,i),l=new Blob([s],{type:"text/vtt"}),e=shaka.media.MediaSourceEngine.createObjectURL(l),a="text/vtt"),(u=document.createElement("track")).src=c.cmcdManager_.appendTextTrackData(e),u.label=n,u.kind=r,u.srclang=t,c.video_.getAttribute("crossorigin")||c.video_.setAttribute("crossorigin","anonymous"),c.video_.appendChild(u),d.return(u))}))},shaka.Player.prototype.getTextData_=function(e,t,r){var a,n,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(a=shaka.net.NetworkingEngine.RequestType.SEGMENT,(n=shaka.net.NetworkingEngine.makeRequest([e],r)).method="GET",o.cmcdManager_.applyTextData(n),s.yield(t.request(a,n).promise,2)):(i=s.yieldResult,s.return(i.data))}))},shaka.Player.prototype.convertToWebVTT_=function(e,t,r){var a=shaka.text.TextEngine.findParser(t);if(a)return t=a(),a={periodStart:0,segmentStart:0,segmentEnd:this.video_.duration,vttOffset:0},e=shaka.util.BufferUtils.toUint8(e),e=t.parseMedia(e,a),shaka.text.WebVttGenerator.convert(e,r);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,t)},shaka.Player.prototype.setMaxHardwareResolution=function(e,t){this.maxHwRes_.width=e,this.maxHwRes_.height=t},shaka.Player.prototype.retryStreaming=function(e){return this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&this.streamingEngine_.retry(void 0===e?.1:e)},shaka.Player.prototype.getManifest=function(){return shaka.log.alwaysWarn("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.manifest_},shaka.Player.prototype.getManifestParserFactory=function(){return this.parserFactory_},shaka.Player.prototype.addVariantToSwitchHistory_=function(e,t){this.stats_.getSwitchHistory().updateCurrentVariant(e,t)},shaka.Player.prototype.addTextStreamToSwitchHistory_=function(e,t){this.stats_.getSwitchHistory().updateCurrentText(e,t)},shaka.Player.prototype.defaultConfig_=function(){var e=this,t=shaka.util.PlayerConfiguration.createDefault();return t.streaming.failureCallback=function(t){e.defaultStreamingFailureCallback_(t)},t.textDisplayFactory=function(){return e.videoContainer_?new shaka.text.UITextDisplayer(e.video_,e.videoContainer_):new shaka.text.SimpleTextDisplayer(e.video_)},t},shaka.Player.prototype.setVideoContainer=function(e){this.videoContainer_=e},shaka.Player.prototype.defaultStreamingFailureCallback_=function(e){if(this.isLive()){var t=null;e.code==shaka.util.Error.Code.BAD_HTTP_STATUS||e.code==shaka.util.Error.Code.HTTP_ERROR?t=1:e.code==shaka.util.Error.Code.TIMEOUT&&(t=.1),null!=t&&(e.severity=shaka.util.Error.Severity.RECOVERABLE,shaka.log.warning("Live streaming error.  Retrying automatically..."),this.retryStreaming(t))}},shaka.Player.prototype.makeTextStreamsForClosedCaptions_=function(e){for(var t=shaka.util.ManifestParserUtils.ContentType,r=shaka.util.ManifestParserUtils.TextStreamKind,a=shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE,n=shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE,i=new Set,o=$jscomp.makeIterator(e.textStreams),s=o.next();!s.done;s=o.next())(s=s.value).mimeType!=a&&s.mimeType!=n||i.add(s.originalId);for(s=(o=$jscomp.makeIterator(e.variants)).next();!s.done;s=o.next())if((s=s.value.video)&&s.closedCaptions)for(var l=$jscomp.makeIterator(s.closedCaptions.keys()),u=l.next();!u.done;u=l.next())if(u=u.value,!i.has(u)){var c=u.startsWith("CC")?a:n,d=new shaka.media.MetaSegmentIndex;c={id:this.nextExternalStreamId_++,originalId:u,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:d,mimeType:c,codecs:"",kind:r.CLOSED_CAPTION,encrypted:!1,drmInfos:[],keyIds:new Set,language:s.closedCaptions.get(u),label:null,type:t.TEXT,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:s.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},e.textStreams.push(c),i.add(u)}},shaka.Player.prototype.filterManifest_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(t.filterManifestWithStreamUtils_(e),2);t.filterManifestWithRestrictions_(e),r.jumpToEnd()}))},shaka.Player.prototype.filterManifestWithStreamUtils_=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return goog.asserts.assert(e,"Manifest should exist!"),goog.asserts.assert(r.video_,"Must not be destroyed"),t=r.streamingEngine_?r.streamingEngine_.getCurrentVariant():null,a.yield(shaka.util.StreamUtils.filterManifest(r.drmEngine_,t,e),2);r.checkPlayableVariants_(e),a.jumpToEnd()}))},shaka.Player.prototype.filterManifestWithRestrictions_=function(e){if(this.loadMode_!=shaka.Player.LoadMode.DESTROYED){shaka.util.StreamUtils.applyRestrictions(e.variants,this.config_.restrictions,this.maxHwRes_)&&this.streamingEngine_&&this.onTracksChanged_();var t=this.drmEngine_?this.drmEngine_.getDrmInfo():null;if(t&&this.drmEngine_.getMediaKeys())for(var r=$jscomp.makeIterator(e.variants),a=r.next();!a.done;a=r.next())a=a.value,this.processDrmInfos_(t.keySystem,a.video),this.processDrmInfos_(t.keySystem,a.audio);this.checkRestrictedVariants_(e)}},shaka.Player.prototype.processDrmInfos_=function(e,t){if(t)for(var r=(t=$jscomp.makeIterator(t.drmInfos)).next();!r.done;r=t.next())if((r=r.value).keySystem==e)for(var a=(r=$jscomp.makeIterator(r.initData||[])).next();!a.done;a=r.next())a=a.value,this.drmEngine_.newInitData(a.initDataType,a.initData)},shaka.Player.prototype.filterManifestByCurrentVariant_=function(){goog.asserts.assert(this.manifest_,"Manifest should be valid"),goog.asserts.assert(this.streamingEngine_,"StreamingEngine should be valid");var e=this.streamingEngine_?this.streamingEngine_.getCurrentVariant():null;shaka.util.StreamUtils.filterManifestByCurrentVariant(e,this.manifest_),this.checkPlayableVariants_(this.manifest_)},shaka.Player.prototype.adjustStartTime_=function(e,t){var r,a,n,i,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(r=e.audio,a=e.video,n=function(e,t){var r,a,n;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?e?i.yield(e.createSegmentIndex(),2):i.return(null):(a=(r=e.segmentIndex.getIteratorForTime(t))?r.next().value:null)?(n=a.startTime,goog.asserts.assert(n<=t,"Segment should start before target time!"),i.return(n)):i.return(null)}))},s.yield(n(r,t),2)):3!=s.nextAddress?(i=s.yieldResult,s.yield(n(a,t),3)):null!=(o=s.yieldResult)&&null!=i?s.return(Math.max(o,i)):null!=o?s.return(o):null!=i?s.return(i):s.return(t)}))},shaka.Player.prototype.updateBufferState_=function(){var e=this.isBuffering();shaka.log.v2("Player changing buffering state to",e),this.stats_&&this.bufferObserver_&&this.playhead_&&(this.playRateController_.setBuffering(e),this.cmcdManager_&&this.cmcdManager_.setBuffering(e),this.updateStateHistory_());var t=shaka.util.FakeEvent.EventName.Buffering;e=(new Map).set("buffering",e),this.dispatchEvent(this.makeEvent_(t,e))},shaka.Player.prototype.onRateChange_=function(){var e=this.video_.playbackRate;0!=e&&(this.playRateController_&&this.playRateController_.set(e),e=this.makeEvent_(shaka.util.FakeEvent.EventName.RateChange),this.dispatchEvent(e))},shaka.Player.prototype.updateStateHistory_=function(){if(this.stats_&&this.bufferObserver_){var e=shaka.media.BufferingObserver.State,t=this.stats_.getStateHistory();this.bufferObserver_.getState()==e.STARVING?t.update("buffering"):this.video_.paused?t.update("paused"):this.video_.ended?t.update("ended"):t.update("playing")}},shaka.Player.prototype.onSeek_=function(){this.playheadObservers_&&this.playheadObservers_.notifyOfSeek(),this.streamingEngine_&&this.streamingEngine_.seeked(),this.bufferObserver_&&this.pollBufferState_()},shaka.Player.prototype.updateAbrManagerVariants_=function(){try{goog.asserts.assert(this.manifest_,"Manifest should exist by now!"),this.checkRestrictedVariants_(this.manifest_)}catch(e){return this.onError_(e),!1}var e=this.manifest_.variants.filter((function(e){return shaka.util.StreamUtils.isPlayable(e)}));return e=this.currentAdaptationSetCriteria_.create(e),this.abrManager_.setVariants(Array.from(e.values())),!0},shaka.Player.prototype.chooseVariant_=function(){return this.updateAbrManagerVariants_()?this.abrManager_.chooseVariant():null},shaka.Player.prototype.checkVariants_=function(){shaka.util.StreamUtils.applyRestrictions(this.manifest_.variants,this.config_.restrictions,this.maxHwRes_)&&this.chooseVariant_()},shaka.Player.prototype.chooseTextStream_=function(){return shaka.util.StreamUtils.filterStreamsByLanguageAndRole(this.manifest_.textStreams,this.currentTextLanguage_,this.currentTextRole_,this.currentTextForced_)[0]||null},shaka.Player.prototype.chooseVariantAndSwitch_=function(){goog.asserts.assert(this.config_,"Must not be destroyed");var e=this.chooseVariant_();e&&this.switchVariant_(e,!0,!0,0)},shaka.Player.prototype.switchVariant_=function(e,t,r,a){var n=this.streamingEngine_.getCurrentVariant();e==n?(shaka.log.debug("Variant already selected."),r&&this.streamingEngine_.switchVariant(e,r,a,!0)):(this.addVariantToSwitchHistory_(e,t),this.streamingEngine_.switchVariant(e,r,a,void 0,t),r=null,n&&(r=shaka.util.StreamUtils.variantToTrack(n)),e=shaka.util.StreamUtils.variantToTrack(e),t?this.onAdaptation_(r,e):this.onVariantChanged_(r,e))},shaka.Player.prototype.switchHtml5Track_=function(e){goog.asserts.assert(this.video_&&this.video_.audioTracks,"Video and video.audioTracks should not be null!");var t=Array.from(this.video_.audioTracks).find((function(e){return e.enabled}));e.enabled=!0,e.id!==t.id&&(t.enabled=!1),t=shaka.util.StreamUtils.html5AudioTrackToTrack(t),e=shaka.util.StreamUtils.html5AudioTrackToTrack(e),this.onVariantChanged_(t,e)},shaka.Player.prototype.setInitialTextState_=function(e,t){t?(e.audio&&this.shouldInitiallyShowText_(e.audio,t)&&(this.isTextVisible_=!0),this.isTextVisible_&&(this.mediaSourceEngine_.getTextDisplayer().setTextVisibility(!0),goog.asserts.assert(this.shouldStreamText_(),"Should be streaming text")),this.onTextTrackVisibility_()):this.isTextVisible_=!1},shaka.Player.prototype.shouldInitiallyShowText_=function(e,t){var r=shaka.config.AutoShowText;if(this.config_.autoShowText==r.NEVER)return!1;if(this.config_.autoShowText==r.ALWAYS)return!0;var a=shaka.util.LanguageUtils,n=a.normalize(this.config_.preferredTextLanguage);return t=a.normalize(t.language),this.config_.autoShowText==r.IF_PREFERRED_TEXT_LANGUAGE?a.areLanguageCompatible(t,n):this.config_.autoShowText==r.IF_SUBTITLES_MAY_BE_NEEDED?(e=a.normalize(e.language),a.areLanguageCompatible(t,n)&&!a.areLanguageCompatible(e,t)):(shaka.log.alwaysWarn("Invalid autoShowText setting!"),!1)},shaka.Player.prototype.onManifestUpdate_=function(){this.parser_&&this.parser_.update&&this.parser_.update()},shaka.Player.prototype.onSegmentAppended_=function(e,t,r){this.playhead_&&this.playhead_.notifyOfBufferingChange(),this.pollBufferState_(),e=(new Map).set("start",e).set("end",t).set("contentType",r),this.dispatchEvent(this.makeEvent_(shaka.util.FakeEvent.EventName.SegmentAppended,e))},shaka.Player.prototype.switch_=function(e,t,r){t=void 0!==t&&t,r=void 0===r?0:r,shaka.log.debug("switch_"),goog.asserts.assert(this.config_.abr.enabled,"AbrManager should not call switch while disabled!"),goog.asserts.assert(this.manifest_,"We need a manifest to switch variants."),this.streamingEngine_&&e!=this.streamingEngine_.getCurrentVariant()&&this.switchVariant_(e,!0,t,r)},shaka.Player.prototype.onAdaptation_=function(e,t){e=(new Map).set("oldTrack",e).set("newTrack",t),this.lcevcDil_&&this.lcevcDil_.updateVariant(t),t=this.makeEvent_(shaka.util.FakeEvent.EventName.Adaptation,e),this.delayDispatchEvent_(t)},shaka.Player.prototype.onTracksChanged_=function(){var e=this.makeEvent_(shaka.util.FakeEvent.EventName.TracksChanged);this.delayDispatchEvent_(e)},shaka.Player.prototype.onVariantChanged_=function(e,t){e=(new Map).set("oldTrack",e).set("newTrack",t),this.lcevcDil_&&this.lcevcDil_.updateVariant(t),t=this.makeEvent_(shaka.util.FakeEvent.EventName.VariantChanged,e),this.delayDispatchEvent_(t)},shaka.Player.prototype.onTextChanged_=function(){var e=this.makeEvent_(shaka.util.FakeEvent.EventName.TextChanged);this.delayDispatchEvent_(e)},shaka.Player.prototype.onTextTrackVisibility_=function(){var e=this.makeEvent_(shaka.util.FakeEvent.EventName.TextTrackVisibility);this.delayDispatchEvent_(e)},shaka.Player.prototype.onAbrStatusChanged_=function(){var e=(new Map).set("newStatus",this.config_.abr.enabled);this.delayDispatchEvent_(this.makeEvent_(shaka.util.FakeEvent.EventName.AbrStatusChanged,e))},shaka.Player.prototype.tryToRecoverFromError_=function(e){if(e.code!=shaka.util.Error.Code.HTTP_ERROR&&e.code!=shaka.util.Error.Code.SEGMENT_MISSING||e.category!=shaka.util.Error.Category.NETWORK||!navigator.onLine)return!1;var t=this.config_.streaming.maxDisabledTime;if(0==t){if(e.code!=shaka.util.Error.Code.SEGMENT_MISSING)return!1;t=1}e.code==shaka.util.Error.Code.HTTP_ERROR&&shaka.log.debug("Recoverable NETWORK HTTP_ERROR, trying to recover..."),e=this.getVariantTracks().find((function(e){return e.active})),goog.asserts.assert(e,"Active variant should be found");for(var r=this.manifest_,a=$jscomp.makeIterator(r.variants),n=a.next();!n.done;n=a.next())(n=n.value).id===e.id&&(n.disabledUntilTime=Date.now()/1e3+t);return shaka.util.StreamUtils.applyRestrictions(r.variants,this.config_.restrictions,this.maxHwRes_),(e=this.chooseVariant_())?(r=this.getBufferedInfo().video.reduce((function(e,t){return e+t.end-t.start}),0),this.switchVariant_(e,!1,!0,r),this.checkVariantsTimer_.tickAfter(t),!0):(shaka.log.warning("Not enough variants to recover from error"),!1)},shaka.Player.prototype.onError_=function(e){if(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),this.loadMode_!=shaka.Player.LoadMode.DESTROYED)if(this.tryToRecoverFromError_(e))e.handled=!0;else{var t=this.makeEvent_(shaka.util.FakeEvent.EventName.Error,(new Map).set("detail",e));this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)}},shaka.Player.prototype.onRegionEvent_=function(e,t){t={schemeIdUri:t.schemeIdUri,value:t.value,startTime:t.startTime,endTime:t.endTime,id:t.id,eventElement:t.eventElement},t=(new Map).set("detail",t),this.dispatchEvent(this.makeEvent_(e,t))},shaka.Player.prototype.onMediaQualityChange_=function(e,t){e={bandwidth:e.bandwidth,audioSamplingRate:e.audioSamplingRate,codecs:e.codecs,contentType:e.contentType,frameRate:e.frameRate,height:e.height,mimeType:e.mimeType,channelsCount:e.channelsCount,pixelAspectRatio:e.pixelAspectRatio,width:e.width},t=(new Map).set("mediaQuality",e).set("position",t),this.dispatchEvent(this.makeEvent_(shaka.util.FakeEvent.EventName.MediaQualityChanged,t))},shaka.Player.prototype.videoErrorToShakaError_=function(){if(goog.asserts.assert(this.video_.error,"Video error expected, but missing!"),!this.video_.error)return null;var e=this.video_.error.code;if(1==e)return null;var t=this.video_.error.msExtendedCode;return t&&(0>t&&(t+=Math.pow(2,32)),t=t.toString(16)),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.VIDEO_ERROR,e,t,this.video_.error.message)},shaka.Player.prototype.onVideoError_=function(e){(e=this.videoErrorToShakaError_())&&this.onError_(e)},shaka.Player.prototype.onKeyStatus_=function(e){if(this.streamingEngine_){var t=Object.keys(e);0==t.length&&shaka.log.warning("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var r=1==t.length&&"00"==t[0];r&&shaka.log.warning("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var a=shaka.Player.restrictedStatuses_,n=!1;if(t.length)for(var i=(t=$jscomp.makeIterator(this.manifest_.variants)).next();!i.done;i=t.next()){i=i.value;for(var o=shaka.util.StreamUtils.getVariantStreams(i),s=(o=$jscomp.makeIterator(o)).next();!s.done;s=o.next()){var l=s.value;if(s=i.allowedByKeySystem,l.keyIds.size){i.allowedByKeySystem=!0;for(var u=(l=$jscomp.makeIterator(l.keyIds)).next();!u.done;u=l.next())u=u.value,u=e[r?"00":u],i.allowedByKeySystem=i.allowedByKeySystem&&!!u&&!a.includes(u)}s!=i.allowedByKeySystem&&(n=!0)}}n&&!this.updateAbrManagerVariants_()||((e=this.streamingEngine_.getCurrentVariant())&&!e.allowedByKeySystem&&(shaka.log.debug("Choosing new streams after key status changed"),this.chooseVariantAndSwitch_()),n&&this.onTracksChanged_())}},shaka.Player.prototype.onExpirationUpdated_=function(e,t){this.parser_&&this.parser_.onExpirationUpdated&&this.parser_.onExpirationUpdated(e,t),e=this.makeEvent_(shaka.util.FakeEvent.EventName.ExpirationUpdated),this.dispatchEvent(e)},shaka.Player.prototype.shouldStreamText_=function(){return this.config_.streaming.alwaysStreamText||this.isTextTrackVisible()},shaka.Player.applyPlayRange_=function(e,t,r){0<t&&(e.isLive()?shaka.log.warning("|playRangeStart| has been configured for live content. Ignoring the setting."):e.setUserSeekStart(t)),r<(t=e.getDuration())&&(e.isLive()?shaka.log.warning("|playRangeEnd| has been configured for live content. Ignoring the setting."):e.setDuration(r))},shaka.Player.prototype.checkRestrictedVariants_=function(e){var t=shaka.Player.restrictedStatuses_,r=this.drmEngine_?this.drmEngine_.getKeyStatuses():{},a=Object.keys(r);a=a.length&&"00"==a[0];for(var n=!1,i=!1,o=new Set,s=new Set,l=(e=$jscomp.makeIterator(e.variants)).next();!l.done;l=e.next()){var u=[];(l=l.value).audio&&u.push(l.audio),l.video&&u.push(l.video);for(var c=(u=$jscomp.makeIterator(u)).next();!c.done;c=u.next())if((c=c.value).keyIds.size)for(var d=(c=$jscomp.makeIterator(c.keyIds)).next();!d.done;d=c.next()){d=d.value;var p=r[a?"00":d];p?t.includes(p)&&s.add(p):o.add(d)}l.allowedByApplication?l.allowedByKeySystem&&(n=!0):i=!0}if(!n)throw t={hasAppRestrictions:i,missingKeys:Array.from(o),restrictedKeyStatuses:Array.from(s)},new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.RESTRICTIONS_CANNOT_BE_MET,t)},shaka.Player.prototype.checkPlayableVariants_=function(e){if(!e.variants.some(shaka.util.StreamUtils.isPlayable))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.CONTENT_UNSUPPORTED_BY_BROWSER)},shaka.Player.prototype.delayDispatchEvent_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(Promise.resolve(),2);t.loadMode_!=shaka.Player.LoadMode.DESTROYED&&t.dispatchEvent(e),r.jumpToEnd()}))},shaka.Player.getLanguagesFrom_=function(e){for(var t=new Set,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value).language?t.add(shaka.util.LanguageUtils.normalize(r.language)):t.add("und");return t},shaka.Player.getLanguageAndRolesFrom_=function(e){for(var t=new Map,r=new Map,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){var n="und",i=[];(a=a.value).language&&(n=shaka.util.LanguageUtils.normalize(a.language)),(i="variant"==a.type?a.audioRoles:a.roles)&&i.length||(i=[""]),t.has(n)||t.set(n,new Set);for(var o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next())o=o.value,t.get(n).add(o),a.label&&(r.has(n)||r.set(n,new Map),r.get(n).set(o,a.label))}var s=[];return t.forEach((function(e,t){for(var a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){a=a.value;var n=null;r.has(t)&&r.get(t).has(a)&&(n=r.get(t).get(a)),s.push({language:t,role:a,label:n})}})),s},shaka.Player.prototype.isBufferedToEndMS_=function(){if(goog.asserts.assert(this.video_,"We need a video element to get buffering information"),goog.asserts.assert(this.mediaSourceEngine_,"We need a media source engine to get buffering information"),goog.asserts.assert(this.manifest_,"We need a manifest to get buffering information"),this.video_.ended||this.mediaSourceEngine_.ended())return!0;if(this.manifest_.presentationTimeline.isLive()){var e=this.manifest_.presentationTimeline.getSegmentAvailabilityEnd(),t=shaka.media.TimeRangesUtils.bufferEnd(this.video_.buffered);if(null!=t&&t>=e)return!0}return!1},shaka.Player.prototype.isBufferedToEndSrc_=function(){if(goog.asserts.assert(this.video_,"We need a video element to get buffering information"),this.video_.ended)return!0;var e=shaka.media.TimeRangesUtils.bufferEnd(this.video_.buffered);return null!=e&&e>=this.video_.duration-1},shaka.Player.prototype.createAbortLoadError_=function(){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.LOAD_INTERRUPTED)},shaka.Player.prototype.getNextStep_=function(e,t,r,a){var n=null;return e==this.detachNode_&&(n=r==this.detachNode_?this.detachNode_:this.attachNode_),e==this.attachNode_&&(n=this.getNextAfterAttach_(r,t,a)),e==this.mediaSourceNode_&&(n=this.getNextAfterMediaSource_(r,t,a)),e==this.parserNode_&&(n=this.getNextMatchingAllDependencies_(this.loadNode_,this.manifestNode_,this.unloadNode_,r,t,a)),e==this.manifestNode_&&(n=this.getNextMatchingAllDependencies_(this.loadNode_,this.drmNode_,this.unloadNode_,r,t,a)),e==this.drmNode_&&(n=this.getNextMatchingAllDependencies_(this.loadNode_,this.loadNode_,this.unloadNode_,r,t,a)),e==this.srcEqualsDrmNode_&&(n=r==this.srcEqualsNode_&&t.mediaElement==a.mediaElement?this.srcEqualsNode_:this.unloadNode_),e!=this.loadNode_&&e!=this.srcEqualsNode_||(n=this.unloadNode_),e==this.unloadNode_&&(n=this.getNextAfterUnload_(r,t,a)),goog.asserts.assert(n,"Missing next step!"),n},shaka.Player.prototype.getNextAfterAttach_=function(e,t,r){return e==this.detachNode_||t.mediaElement!=r.mediaElement?this.detachNode_:e==this.attachNode_?this.attachNode_:e==this.mediaSourceNode_||e==this.loadNode_?this.mediaSourceNode_:e==this.srcEqualsNode_?this.srcEqualsDrmNode_:null},shaka.Player.prototype.getNextAfterMediaSource_=function(e,t,r){return e==this.loadNode_&&t.mediaElement==r.mediaElement?this.parserNode_:this.unloadNode_},shaka.Player.prototype.getNextAfterUnload_=function(e,t,r){return r.mediaElement&&t.mediaElement==r.mediaElement?this.attachNode_:this.detachNode_},shaka.Player.prototype.getNextMatchingAllDependencies_=function(e,t,r,a,n,i){return a==e&&n.mediaElement==i.mediaElement&&n.uri==i.uri&&n.mimeType==i.mimeType?t:r},shaka.Player.createEmptyPayload_=function(){return{mediaElement:null,mimeType:null,startTime:null,startTimeOfLoad:NaN,uri:null}},shaka.Player.prototype.wrapWalkerListenersWithPromise_=function(e){var t=this;return new Promise((function(r,a){e.onCancel=function(){return a(t.createAbortLoadError_())},e.onEnd=function(){return r()},e.onError=function(e){return a(e)},e.onSkip=function(){return a(t.createAbortLoadError_())}}))},goog.exportSymbol("shaka.Player",shaka.Player),goog.exportProperty(shaka.Player.prototype,"setVideoContainer",shaka.Player.prototype.setVideoContainer),goog.exportProperty(shaka.Player.prototype,"getManifestParserFactory",shaka.Player.prototype.getManifestParserFactory),goog.exportProperty(shaka.Player.prototype,"getManifest",shaka.Player.prototype.getManifest),goog.exportProperty(shaka.Player.prototype,"retryStreaming",shaka.Player.prototype.retryStreaming),goog.exportProperty(shaka.Player.prototype,"setMaxHardwareResolution",shaka.Player.prototype.setMaxHardwareResolution),goog.exportProperty(shaka.Player.prototype,"addChaptersTrack",shaka.Player.prototype.addChaptersTrack),goog.exportProperty(shaka.Player.prototype,"addThumbnailsTrack",shaka.Player.prototype.addThumbnailsTrack),goog.exportProperty(shaka.Player.prototype,"addTextTrackAsync",shaka.Player.prototype.addTextTrackAsync),goog.exportProperty(shaka.Player.prototype,"getStats",shaka.Player.prototype.getStats),goog.exportProperty(shaka.Player.prototype,"getBufferedInfo",shaka.Player.prototype.getBufferedInfo),goog.exportProperty(shaka.Player.prototype,"getPresentationStartTimeAsDate",shaka.Player.prototype.getPresentationStartTimeAsDate),goog.exportProperty(shaka.Player.prototype,"getPlayheadTimeAsDate",shaka.Player.prototype.getPlayheadTimeAsDate),goog.exportProperty(shaka.Player.prototype,"setTextTrackVisibility",shaka.Player.prototype.setTextTrackVisibility),goog.exportProperty(shaka.Player.prototype,"getChapters",shaka.Player.prototype.getChapters),goog.exportProperty(shaka.Player.prototype,"getChaptersTracks",shaka.Player.prototype.getChaptersTracks),goog.exportProperty(shaka.Player.prototype,"isTextTrackVisible",shaka.Player.prototype.isTextTrackVisible),goog.exportProperty(shaka.Player.prototype,"selectVariantsByLabel",shaka.Player.prototype.selectVariantsByLabel),goog.exportProperty(shaka.Player.prototype,"selectTextLanguage",shaka.Player.prototype.selectTextLanguage),goog.exportProperty(shaka.Player.prototype,"selectAudioLanguage",shaka.Player.prototype.selectAudioLanguage),goog.exportProperty(shaka.Player.prototype,"getTextLanguages",shaka.Player.prototype.getTextLanguages),goog.exportProperty(shaka.Player.prototype,"getAudioLanguages",shaka.Player.prototype.getAudioLanguages),goog.exportProperty(shaka.Player.prototype,"getTextLanguagesAndRoles",shaka.Player.prototype.getTextLanguagesAndRoles),goog.exportProperty(shaka.Player.prototype,"getAudioLanguagesAndRoles",shaka.Player.prototype.getAudioLanguagesAndRoles),goog.exportProperty(shaka.Player.prototype,"selectVariantTrack",shaka.Player.prototype.selectVariantTrack),goog.exportProperty(shaka.Player.prototype,"selectTextTrack",shaka.Player.prototype.selectTextTrack),goog.exportProperty(shaka.Player.prototype,"getThumbnails",shaka.Player.prototype.getThumbnails),goog.exportProperty(shaka.Player.prototype,"getImageTracks",shaka.Player.prototype.getImageTracks),goog.exportProperty(shaka.Player.prototype,"getTextTracks",shaka.Player.prototype.getTextTracks),goog.exportProperty(shaka.Player.prototype,"getVariantTracks",shaka.Player.prototype.getVariantTracks),goog.exportProperty(shaka.Player.prototype,"cancelTrickPlay",shaka.Player.prototype.cancelTrickPlay),goog.exportProperty(shaka.Player.prototype,"trickPlay",shaka.Player.prototype.trickPlay),goog.exportProperty(shaka.Player.prototype,"getPlaybackRate",shaka.Player.prototype.getPlaybackRate),goog.exportProperty(shaka.Player.prototype,"isBuffering",shaka.Player.prototype.isBuffering),goog.exportProperty(shaka.Player.prototype,"getKeyStatuses",shaka.Player.prototype.getKeyStatuses),goog.exportProperty(shaka.Player.prototype,"getExpiration",shaka.Player.prototype.getExpiration),goog.exportProperty(shaka.Player.prototype,"drmInfo",shaka.Player.prototype.drmInfo),goog.exportProperty(shaka.Player.prototype,"keySystem",shaka.Player.prototype.keySystem),goog.exportProperty(shaka.Player.prototype,"goToLive",shaka.Player.prototype.goToLive),goog.exportProperty(shaka.Player.prototype,"seekRange",shaka.Player.prototype.seekRange),goog.exportProperty(shaka.Player.prototype,"isAudioOnly",shaka.Player.prototype.isAudioOnly),goog.exportProperty(shaka.Player.prototype,"isInProgress",shaka.Player.prototype.isInProgress),goog.exportProperty(shaka.Player.prototype,"isLive",shaka.Player.prototype.isLive),goog.exportProperty(shaka.Player.prototype,"getAdManager",shaka.Player.prototype.getAdManager),goog.exportProperty(shaka.Player.prototype,"getAssetUri",shaka.Player.prototype.getAssetUri),goog.exportProperty(shaka.Player.prototype,"getNetworkingEngine",shaka.Player.prototype.getNetworkingEngine),goog.exportProperty(shaka.Player.prototype,"getMediaElement",shaka.Player.prototype.getMediaElement),goog.exportProperty(shaka.Player.prototype,"getLoadMode",shaka.Player.prototype.getLoadMode),goog.exportProperty(shaka.Player.prototype,"resetConfiguration",shaka.Player.prototype.resetConfiguration),goog.exportProperty(shaka.Player.prototype,"getBufferFullness",shaka.Player.prototype.getBufferFullness),goog.exportProperty(shaka.Player.prototype,"getConfiguration",shaka.Player.prototype.getConfiguration),goog.exportProperty(shaka.Player.prototype,"configure",shaka.Player.prototype.configure),goog.exportProperty(shaka.Player.prototype,"load",shaka.Player.prototype.load),goog.exportProperty(shaka.Player.prototype,"updateStartTime",shaka.Player.prototype.updateStartTime),goog.exportProperty(shaka.Player.prototype,"unload",shaka.Player.prototype.unload),goog.exportProperty(shaka.Player.prototype,"detach",shaka.Player.prototype.detach),goog.exportProperty(shaka.Player.prototype,"attachCanvas",shaka.Player.prototype.attachCanvas),goog.exportProperty(shaka.Player.prototype,"attach",shaka.Player.prototype.attach),goog.exportProperty(shaka.Player,"probeSupport",shaka.Player.probeSupport),goog.exportProperty(shaka.Player,"isBrowserSupported",shaka.Player.isBrowserSupported),goog.exportProperty(shaka.Player,"setAdManagerFactory",shaka.Player.setAdManagerFactory),goog.exportProperty(shaka.Player,"registerSupportPlugin",shaka.Player.registerSupportPlugin),goog.exportProperty(shaka.Player.prototype,"destroy",shaka.Player.prototype.destroy),shaka.Player.LoadMode={DESTROYED:0,NOT_LOADED:1,MEDIA_SOURCE:2,SRC_EQUALS:3},goog.exportProperty(shaka.Player,"LoadMode",shaka.Player.LoadMode),shaka.Player.TYPICAL_BUFFERING_THRESHOLD_=.5,shaka.Player.version="v4.3.5-debug",goog.exportProperty(shaka.Player,"version",shaka.Player.version),shaka.Deprecate.init(shaka.Player.version),shaka.Player.restrictedStatuses_=["output-restricted","internal-error"],shaka.Player.supportPlugins_={},shaka.Player.adManagerFactory_=null,shaka.Player.SRC_EQUAL_EXTENSIONS_TO_MIME_TYPES_={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"},shaka.Player.TEXT_EXTENSIONS_TO_MIME_TYPES_={sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"},shaka.Player.TextTrackLabel="Shaka Player TextTrack",shaka.ads={},shaka.ads.AdsStats=function(){this.loadTimes_=[],this.skipped_=this.playedCompletely_=this.started_=0},shaka.ads.AdsStats.prototype.addLoadTime=function(e){this.loadTimes_.push(e)},shaka.ads.AdsStats.prototype.incrementStarted=function(){this.started_++},shaka.ads.AdsStats.prototype.incrementPlayedCompletely=function(){this.playedCompletely_++},shaka.ads.AdsStats.prototype.incrementSkipped=function(){this.skipped_++},shaka.ads.AdsStats.prototype.getBlob=function(){return{loadTimes:this.loadTimes_,started:this.started_,playedCompletely:this.playedCompletely_,skipped:this.skipped_}},shaka.ads.ClientSideAd=function(e,t,r){var a=this;this.ad_=e,this.manager_=t,this.video_=r,this.isPaused_=!1,this.volume_=this.manager_.getVolume(),this.eventManager_=new shaka.util.EventManager,this.eventManager_.listen(this.manager_,google.ima.AdEvent.Type.PAUSED,(function(){a.isPaused_=!0})),this.eventManager_.listen(this.manager_,google.ima.AdEvent.Type.RESUMED,(function(){a.isPaused_=!1}))},shaka.ads.ClientSideAd.prototype.getDuration=function(){return this.ad_.getDuration()},shaka.ads.ClientSideAd.prototype.getMinSuggestedDuration=function(){return this.ad_.getMinSuggestedDuration()},shaka.ads.ClientSideAd.prototype.getRemainingTime=function(){return this.manager_.getRemainingTime()},shaka.ads.ClientSideAd.prototype.isPaused=function(){return this.isPaused_},shaka.ads.ClientSideAd.prototype.isSkippable=function(){return 0<=this.ad_.getSkipTimeOffset()},shaka.ads.ClientSideAd.prototype.getTimeUntilSkippable=function(){var e=this.ad_.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},shaka.ads.ClientSideAd.prototype.canSkipNow=function(){return this.manager_.getAdSkippableState()},shaka.ads.ClientSideAd.prototype.skip=function(){return this.manager_.skip()},shaka.ads.ClientSideAd.prototype.setPaused=function(e){this.isPaused_=e},shaka.ads.ClientSideAd.prototype.pause=function(){return this.manager_.pause()},shaka.ads.ClientSideAd.prototype.play=function(){return this.manager_.resume()},shaka.ads.ClientSideAd.prototype.getVolume=function(){return this.manager_.getVolume()},shaka.ads.ClientSideAd.prototype.setVolume=function(e){return this.manager_.setVolume(e)},shaka.ads.ClientSideAd.prototype.isMuted=function(){return 0==this.manager_.getVolume()},shaka.ads.ClientSideAd.prototype.isLinear=function(){return this.ad_.isLinear()},shaka.ads.ClientSideAd.prototype.resize=function(e,t){var r=!1,a=this.video_;document.fullscreenEnabled?r=!!document.fullscreenElement:a.webkitSupportsFullscreen&&(r=a.webkitDisplayingFullscreen),this.manager_.resize(e,t,r?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},shaka.ads.ClientSideAd.prototype.setMuted=function(e){e?(this.volume_=this.getVolume(),this.setVolume(0)):this.setVolume(this.volume_)},shaka.ads.ClientSideAd.prototype.getSequenceLength=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getTotalAds()},shaka.ads.ClientSideAd.prototype.getPositionInSequence=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getAdPosition()},shaka.ads.ClientSideAd.prototype.getTitle=function(){return this.ad_.getTitle()},shaka.ads.ClientSideAd.prototype.getDescription=function(){return this.ad_.getDescription()},shaka.ads.ClientSideAd.prototype.release=function(){this.manager_=this.ad_=null},goog.exportSymbol("shaka.ads.ClientSideAd",shaka.ads.ClientSideAd),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"release",shaka.ads.ClientSideAd.prototype.release),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getDescription",shaka.ads.ClientSideAd.prototype.getDescription),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getTitle",shaka.ads.ClientSideAd.prototype.getTitle),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getPositionInSequence",shaka.ads.ClientSideAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getSequenceLength",shaka.ads.ClientSideAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"setMuted",shaka.ads.ClientSideAd.prototype.setMuted),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"resize",shaka.ads.ClientSideAd.prototype.resize),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isLinear",shaka.ads.ClientSideAd.prototype.isLinear),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isMuted",shaka.ads.ClientSideAd.prototype.isMuted),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"setVolume",shaka.ads.ClientSideAd.prototype.setVolume),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getVolume",shaka.ads.ClientSideAd.prototype.getVolume),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"play",shaka.ads.ClientSideAd.prototype.play),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"pause",shaka.ads.ClientSideAd.prototype.pause),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"skip",shaka.ads.ClientSideAd.prototype.skip),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"canSkipNow",shaka.ads.ClientSideAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getTimeUntilSkippable",shaka.ads.ClientSideAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isSkippable",shaka.ads.ClientSideAd.prototype.isSkippable),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isPaused",shaka.ads.ClientSideAd.prototype.isPaused),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getRemainingTime",shaka.ads.ClientSideAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getMinSuggestedDuration",shaka.ads.ClientSideAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getDuration",shaka.ads.ClientSideAd.prototype.getDuration),shaka.ads.ClientSideAdManager=function(e,t,r,a){var n=this;this.adContainer_=e,this.video_=t,this.resizeObserver_=null,this.requestAdsStartTime_=NaN,this.onEvent_=a,this.ad_=null,this.eventManager_=new shaka.util.EventManager,google.ima.settings.setLocale(r),(e=new google.ima.AdDisplayContainer(this.adContainer_,this.video_)).initialize(),this.adsLoader_=new google.ima.AdsLoader(e),this.adsLoader_.getSettings().setPlayerType("shaka-player"),this.adsLoader_.getSettings().setPlayerVersion(shaka.Player.version),this.imaAdsManager_=null,this.eventManager_.listenOnce(this.adsLoader_,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(e){n.onAdsManagerLoaded_(e)})),this.eventManager_.listen(this.adsLoader_,google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){n.onAdError_(e)})),this.eventManager_.listen(this.video_,"ended",(function(){n.adsLoader_.contentComplete()}))},shaka.ads.ClientSideAdManager.prototype.requestAds=function(e){goog.asserts.assert(e.adTagUrl||e.adsResponse,"The ad tag needs to be set up before requesting ads, or adsResponse must be filled."),this.requestAdsStartTime_=Date.now()/1e3,this.adsLoader_.requestAds(e)},shaka.ads.ClientSideAdManager.prototype.stop=function(){this.imaAdsManager_&&this.imaAdsManager_.stop(),this.adContainer_&&shaka.util.Dom.removeAllChildren(this.adContainer_)},shaka.ads.ClientSideAdManager.prototype.release=function(){this.stop(),this.resizeObserver_&&this.resizeObserver_.disconnect(),this.eventManager_&&this.eventManager_.release(),this.imaAdsManager_&&this.imaAdsManager_.destroy(),this.adsLoader_.destroy()},shaka.ads.ClientSideAdManager.prototype.onAdError_=function(e){shaka.log.warning("There was an ad error from the IMA SDK: "+e.getError()),shaka.log.warning("Resuming playback."),this.onAdComplete_(null),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.CUEPOINTS_CHANGED,(new Map).set("cuepoints",[])))},shaka.ads.ClientSideAdManager.prototype.onAdsManagerLoaded_=function(e){var t=this;goog.asserts.assert(null!=this.video_,"Video should not be null!");var r=Date.now()/1e3-this.requestAdsStartTime_;if(this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.ADS_LOADED,(new Map).set("loadTime",r))),this.imaAdsManager_=e.getAdsManager(this.video_),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.IMA_AD_MANAGER_LOADED,(new Map).set("imaAdManager",this.imaAdsManager_))),(r=this.imaAdsManager_.getCuePoints()).length){e=[];for(var a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next())e.push({start:a.value,end:null});this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.CUEPOINTS_CHANGED,(new Map).set("cuepoints",e)))}this.addImaEventListeners_();try{var n=this.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;this.imaAdsManager_.init(this.video_.offsetWidth,this.video_.offsetHeight,n),this.eventManager_.listen(this.video_,"loadeddata",(function(){var e=t.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;t.imaAdsManager_.resize(t.video_.offsetWidth,t.video_.offsetHeight,e)})),"ResizeObserver"in window?(this.resizeObserver_=new ResizeObserver((function(){var e=t.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;t.imaAdsManager_.resize(t.video_.offsetWidth,t.video_.offsetHeight,e)})),this.resizeObserver_.observe(this.video_)):this.eventManager_.listen(document,"fullscreenchange",(function(){var e=t.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;t.imaAdsManager_.resize(t.video_.offsetWidth,t.video_.offsetHeight,e)})),this.video_.addEventListener("play",(function(){t.imaAdsManager_.start()}),{once:!0})}catch(e){this.onAdComplete_(null)}},shaka.ads.ClientSideAdManager.prototype.isFullScreenEnabled_=function(){if(document.fullscreenEnabled)return!!document.fullscreenElement;var e=this.video_;return!!e.webkitSupportsFullscreen&&e.webkitDisplayingFullscreen},shaka.ads.ClientSideAdManager.prototype.addImaEventListeners_=function(){var e=this,t=function(t,r){t=(new Map).set("originalEvent",t),e.onEvent_(new shaka.util.FakeEvent(r,t))};this.eventManager_.listen(this.imaAdsManager_,google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){e.onAdError_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(t){e.onAdStart_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.STARTED,(function(t){e.onAdStart_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.FIRST_QUARTILE,(function(e){t(e,shaka.ads.AdManager.AD_FIRST_QUARTILE)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.MIDPOINT,(function(e){t(e,shaka.ads.AdManager.AD_MIDPOINT)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.THIRD_QUARTILE,(function(e){t(e,shaka.ads.AdManager.AD_THIRD_QUARTILE)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.COMPLETE,(function(e){t(e,shaka.ads.AdManager.AD_COMPLETE)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(t){e.onAdComplete_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){e.onAdComplete_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.SKIPPED,(function(e){t(e,shaka.ads.AdManager.AD_SKIPPED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.VOLUME_CHANGED,(function(e){t(e,shaka.ads.AdManager.AD_VOLUME_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.VOLUME_MUTED,(function(e){t(e,shaka.ads.AdManager.AD_MUTED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.PAUSED,(function(r){e.ad_&&(e.ad_.setPaused(!0),t(r,shaka.ads.AdManager.AD_PAUSED))})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.RESUMED,(function(r){e.ad_&&(e.ad_.setPaused(!1),t(r,shaka.ads.AdManager.AD_RESUMED))})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(r){e.ad_&&t(r,shaka.ads.AdManager.AD_SKIP_STATE_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.CLICK,(function(e){t(e,shaka.ads.AdManager.AD_CLICKED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_PROGRESS,(function(e){t(e,shaka.ads.AdManager.AD_PROGRESS)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_BUFFERING,(function(e){t(e,shaka.ads.AdManager.AD_BUFFERING)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.IMPRESSION,(function(e){t(e,shaka.ads.AdManager.AD_IMPRESSION)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.DURATION_CHANGE,(function(e){t(e,shaka.ads.AdManager.AD_DURATION_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.USER_CLOSE,(function(e){t(e,shaka.ads.AdManager.AD_CLOSED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.LOADED,(function(e){t(e,shaka.ads.AdManager.AD_LOADED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(e){t(e,shaka.ads.AdManager.ALL_ADS_COMPLETED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.LINEAR_CHANGED,(function(e){t(e,shaka.ads.AdManager.AD_LINEAR_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_METADATA,(function(e){t(e,shaka.ads.AdManager.AD_METADATA)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.LOG,(function(e){t(e,shaka.ads.AdManager.AD_RECOVERABLE_ERROR)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_BREAK_READY,(function(e){t(e,shaka.ads.AdManager.AD_BREAK_READY)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.INTERACTION,(function(e){t(e,shaka.ads.AdManager.AD_INTERACTION)}))},shaka.ads.ClientSideAdManager.prototype.onAdStart_=function(e){goog.asserts.assert(this.imaAdsManager_,"Should have an ads manager at this point!");var t=e.getAd();t?(this.ad_=new shaka.ads.ClientSideAd(t,this.imaAdsManager_,this.video_),e=(new Map).set("ad",this.ad_).set("sdkAdObject",t).set("originalEvent",e),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STARTED,e)),this.ad_.isLinear()&&(this.adContainer_.setAttribute("ad-active","true"),this.video_.pause(),this.ad_.setVolume(this.video_.muted?0:this.video_.volume))):shaka.log.alwaysWarn("The IMA SDK fired a "+e.type+" event with no associated ad. Unable to play ad!")},shaka.ads.ClientSideAdManager.prototype.onAdComplete_=function(e){this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STOPPED,(new Map).set("originalEvent",e))),this.ad_&&this.ad_.isLinear()&&(this.adContainer_.removeAttribute("ad-active"),this.video_.ended||this.video_.play())},shaka.ads.ServerSideAd=function(e,t){this.ad_=e,this.adProgressData_=null,this.video_=t},shaka.ads.ServerSideAd.prototype.setProgressData=function(e){this.adProgressData_=e},shaka.ads.ServerSideAd.prototype.getDuration=function(){return this.adProgressData_?this.adProgressData_.duration:-1},shaka.ads.ServerSideAd.prototype.getMinSuggestedDuration=function(){return this.getDuration()},shaka.ads.ServerSideAd.prototype.getRemainingTime=function(){return this.adProgressData_?this.adProgressData_.duration-this.adProgressData_.currentTime:-1},shaka.ads.ServerSideAd.prototype.isPaused=function(){return this.video_.paused},shaka.ads.ServerSideAd.prototype.isSkippable=function(){return this.ad_.isSkippable()},shaka.ads.ServerSideAd.prototype.getTimeUntilSkippable=function(){var e=this.ad_.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},shaka.ads.ServerSideAd.prototype.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},shaka.ads.ServerSideAd.prototype.skip=function(){this.video_.currentTime+=this.getRemainingTime()},shaka.ads.ServerSideAd.prototype.pause=function(){return this.video_.pause()},shaka.ads.ServerSideAd.prototype.play=function(){return this.video_.play()},shaka.ads.ServerSideAd.prototype.getVolume=function(){return this.video_.volume},shaka.ads.ServerSideAd.prototype.setVolume=function(e){this.video_.volume=e},shaka.ads.ServerSideAd.prototype.isMuted=function(){return this.video_.muted},shaka.ads.ServerSideAd.prototype.isLinear=function(){return!0},shaka.ads.ServerSideAd.prototype.resize=function(e,t){},shaka.ads.ServerSideAd.prototype.setMuted=function(e){this.video_.muted=e},shaka.ads.ServerSideAd.prototype.getSequenceLength=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getTotalAds()},shaka.ads.ServerSideAd.prototype.getPositionInSequence=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getAdPosition()},shaka.ads.ServerSideAd.prototype.getTitle=function(){return this.ad_.getTitle()},shaka.ads.ServerSideAd.prototype.getDescription=function(){return this.ad_.getDescription()},shaka.ads.ServerSideAd.prototype.release=function(){this.video_=this.adProgressData_=this.ad_=null},goog.exportSymbol("shaka.ads.ServerSideAd",shaka.ads.ServerSideAd),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"release",shaka.ads.ServerSideAd.prototype.release),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getDescription",shaka.ads.ServerSideAd.prototype.getDescription),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getTitle",shaka.ads.ServerSideAd.prototype.getTitle),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getPositionInSequence",shaka.ads.ServerSideAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getSequenceLength",shaka.ads.ServerSideAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"setMuted",shaka.ads.ServerSideAd.prototype.setMuted),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"resize",shaka.ads.ServerSideAd.prototype.resize),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isLinear",shaka.ads.ServerSideAd.prototype.isLinear),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isMuted",shaka.ads.ServerSideAd.prototype.isMuted),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"setVolume",shaka.ads.ServerSideAd.prototype.setVolume),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getVolume",shaka.ads.ServerSideAd.prototype.getVolume),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"play",shaka.ads.ServerSideAd.prototype.play),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"pause",shaka.ads.ServerSideAd.prototype.pause),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"skip",shaka.ads.ServerSideAd.prototype.skip),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"canSkipNow",shaka.ads.ServerSideAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getTimeUntilSkippable",shaka.ads.ServerSideAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isSkippable",shaka.ads.ServerSideAd.prototype.isSkippable),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isPaused",shaka.ads.ServerSideAd.prototype.isPaused),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getRemainingTime",shaka.ads.ServerSideAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getMinSuggestedDuration",shaka.ads.ServerSideAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getDuration",shaka.ads.ServerSideAd.prototype.getDuration),shaka.ads.ServerSideAdManager=function(e,t,r,a){var n=this;this.adContainer_=e,this.video_=t,this.streamPromise_=null,this.streamRequestStartTime_=NaN,this.onEvent_=a,this.isLiveContent_=!1,this.adProgressData_=this.ad_=this.snapForwardTime_=null,this.backupUrl_="",this.currentCuePoints_=[],this.eventManager_=new shaka.util.EventManager,(e=new google.ima.dai.api.UiSettings).setLocale(r),this.streamManager_=new google.ima.dai.api.StreamManager(this.video_,this.adContainer_,e),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.IMA_STREAM_MANAGER_LOADED,(new Map).set("imaStreamManager",this.streamManager_))),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.LOADED,(function(e){shaka.log.info("Ad SS Loaded"),n.onLoaded_(e)})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.ERROR,(function(){shaka.log.info("Ad SS Error"),n.onError_()})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,(function(){shaka.log.info("Ad Break Started")})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.STARTED,(function(e){shaka.log.info("Ad Started"),n.onAdStart_(e)})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,(function(){shaka.log.info("Ad Break Ended"),n.onAdBreakEnded_()})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,(function(e){n.onAdProgress_(e)})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,(function(){shaka.log.info("Ad event: First Quartile"),n.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_FIRST_QUARTILE))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.MIDPOINT,(function(){shaka.log.info("Ad event: Midpoint"),n.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_MIDPOINT))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,(function(){shaka.log.info("Ad event: Third Quartile"),n.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_THIRD_QUARTILE))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.COMPLETE,(function(){shaka.log.info("Ad event: Complete"),n.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_COMPLETE)),n.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STOPPED)),n.adContainer_.removeAttribute("ad-active"),n.ad_=null})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.SKIPPED,(function(){shaka.log.info("Ad event: Skipped"),n.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_SKIPPED)),n.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STOPPED))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,(function(e){shaka.log.info("Ad event: Cue points changed"),n.onCuePointsChanged_(e)}))},shaka.ads.ServerSideAdManager.prototype.streamRequest=function(e,t){return this.streamPromise_?Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CURRENT_DAI_REQUEST_NOT_FINISHED)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(this.isLiveContent_=!0),this.streamPromise_=new shaka.util.PublicPromise,this.streamManager_.requestStream(e),this.backupUrl_=t||"",this.streamRequestStartTime_=Date.now()/1e3,this.streamPromise_)},shaka.ads.ServerSideAdManager.prototype.replaceAdTagParameters=function(e){this.streamManager_.replaceAdTagParameters(e)},shaka.ads.ServerSideAdManager.prototype.stop=function(){this.backupUrl_="",this.snapForwardTime_=null,this.currentCuePoints_=[]},shaka.ads.ServerSideAdManager.prototype.release=function(){this.stop(),this.eventManager_&&this.eventManager_.release()},shaka.ads.ServerSideAdManager.prototype.onTimedMetadata=function(e,t,r){this.streamManager_.processMetadata(e,t,r)},shaka.ads.ServerSideAdManager.prototype.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.streamManager_.onTimedMetadata(t)}},shaka.ads.ServerSideAdManager.prototype.getCuePoints=function(){return this.currentCuePoints_},shaka.ads.ServerSideAdManager.prototype.checkForSnapback_=function(){var e=this.video_.currentTime;if(0!=e){this.streamManager_.streamTimeForContentTime(e);var t=this.streamManager_.previousCuePointForStreamTime(e);t&&!t.played&&(shaka.log.info("Seeking back to the start of the ad break at "+t.start+" and will return to "+e),this.snapForwardTime_=e,this.video_.currentTime=t.start)}},shaka.ads.ServerSideAdManager.prototype.onAdStart_=function(e){goog.asserts.assert(this.streamManager_,"Should have a stream manager at this point!"),e=e.getAd(),this.ad_=new shaka.ads.ServerSideAd(e,this.video_),this.adProgressData_&&this.ad_.setProgressData(this.adProgressData_),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STARTED,(new Map).set("ad",this.ad_))),this.adContainer_.setAttribute("ad-active","true")},shaka.ads.ServerSideAdManager.prototype.onAdBreakEnded_=function(){this.adContainer_.removeAttribute("ad-active");var e=this.video_.currentTime;this.snapForwardTime_&&this.snapForwardTime_>e&&(this.video_.currentTime=this.snapForwardTime_,this.snapForwardTime_=null)},shaka.ads.ServerSideAdManager.prototype.onLoaded_=function(e){var t=this,r=Date.now()/1e3-this.streamRequestStartTime_;this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.ADS_LOADED,(new Map).set("loadTime",r))),e=e.getStreamData().url,this.streamPromise_.resolve(e),this.streamPromise_=null,this.isLiveContent_||this.eventManager_.listen(this.video_,"seeked",(function(){t.checkForSnapback_()}))},shaka.ads.ServerSideAdManager.prototype.onError_=function(){this.backupUrl_.length?(shaka.log.warning("IMA stream request returned an error. Falling back to the backup asset uri."),this.streamPromise_.resolve(this.backupUrl_)):this.streamPromise_.reject("IMA Stream request returned an error and there was no backup asset uri provided."),this.streamPromise_=null},shaka.ads.ServerSideAdManager.prototype.onAdProgress_=function(e){this.adProgressData_=e.getStreamData().adProgressData,this.ad_&&this.ad_.setProgressData(this.adProgressData_)},shaka.ads.ServerSideAdManager.prototype.onCuePointsChanged_=function(e){var t=e.getStreamData();e=[];for(var r=(t=$jscomp.makeIterator(t.cuepoints)).next();!r.done;r=t.next())r=r.value,e.push({start:r.start,end:r.end});this.currentCuePoints_=e,this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.CUEPOINTS_CHANGED,(new Map).set("cuepoints",e)))},shaka.ads.AdManager=function(){shaka.util.FakeEventTarget.call(this),this.ssAdManager_=this.csAdManager_=null,this.stats_=new shaka.ads.AdsStats,this.locale_=navigator.language},$jscomp.inherits(shaka.ads.AdManager,shaka.util.FakeEventTarget),shaka.ads.AdManager.prototype.setLocale=function(e){this.locale_=e},shaka.ads.AdManager.prototype.initClientSide=function(e,t){var r=this;if(!window.google||!google.ima||!google.ima.AdsLoader)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CS_IMA_SDK_MISSING);this.csAdManager_&&this.csAdManager_.release(),this.csAdManager_=new shaka.ads.ClientSideAdManager(e,t,this.locale_,(function(e){if(e&&e.type)switch(e.type){case shaka.ads.AdManager.ADS_LOADED:r.stats_.addLoadTime(e.loadTime);break;case shaka.ads.AdManager.AD_STARTED:r.stats_.incrementStarted();break;case shaka.ads.AdManager.AD_COMPLETE:r.stats_.incrementPlayedCompletely();break;case shaka.ads.AdManager.AD_SKIPPED:r.stats_.incrementSkipped()}r.dispatchEvent(e)}))},shaka.ads.AdManager.prototype.release=function(){this.csAdManager_&&(this.csAdManager_.release(),this.csAdManager_=null),this.ssAdManager_&&(this.ssAdManager_.release(),this.ssAdManager_=null),shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.ads.AdManager.prototype.onAssetUnload=function(){this.csAdManager_&&this.csAdManager_.stop(),this.ssAdManager_&&this.ssAdManager_.stop(),this.dispatchEvent(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STOPPED)),this.stats_=new shaka.ads.AdsStats},shaka.ads.AdManager.prototype.requestClientSideAds=function(e){if(!this.csAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CS_AD_MANAGER_NOT_INITIALIZED);this.csAdManager_.requestAds(e)},shaka.ads.AdManager.prototype.initServerSide=function(e,t){var r=this;if(!window.google||!google.ima||!google.ima.dai)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_IMA_SDK_MISSING);this.ssAdManager_&&this.ssAdManager_.release(),this.ssAdManager_=new shaka.ads.ServerSideAdManager(e,t,this.locale_,(function(e){if(e&&e.type)switch(e.type){case shaka.ads.AdManager.ADS_LOADED:r.stats_.addLoadTime(e.loadTime);break;case shaka.ads.AdManager.AD_STARTED:r.stats_.incrementStarted();break;case shaka.ads.AdManager.AD_COMPLETE:r.stats_.incrementPlayedCompletely();break;case shaka.ads.AdManager.AD_SKIPPED:r.stats_.incrementSkipped()}r.dispatchEvent(e)}))},shaka.ads.AdManager.prototype.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.ssAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_AD_MANAGER_NOT_INITIALIZED);e.adTagParameters||(e.adTagParameters={});var r=e.adTagParameters;return(r.mpt||r.mpv)&&shaka.log.alwaysWarn('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv=shaka.Player.version,this.ssAdManager_.streamRequest(e,t)},shaka.ads.AdManager.prototype.replaceServerSideAdTagParameters=function(e){if(!this.ssAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_AD_MANAGER_NOT_INITIALIZED);(e.mpt||e.mpv)&&shaka.log.alwaysWarn('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.mpt="Shaka Player",e.mpv=shaka.Player.version,this.ssAdManager_.replaceAdTagParameters(e)},shaka.ads.AdManager.prototype.getServerSideCuePoints=function(){if(!this.ssAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_AD_MANAGER_NOT_INITIALIZED);return this.ssAdManager_.getCuePoints()},shaka.ads.AdManager.prototype.getStats=function(){return this.stats_.getBlob()},shaka.ads.AdManager.prototype.onDashTimedMetadata=function(e){if(this.ssAdManager_&&"urn:google:dai:2018"==e.schemeIdUri){var t=e.schemeIdUri,r=e.eventElement?e.eventElement.getAttribute("messageData"):null;this.ssAdManager_.onTimedMetadata(t,r,e.startTime)}},shaka.ads.AdManager.prototype.onHlsTimedMetadata=function(e,t){this.ssAdManager_&&this.ssAdManager_.onTimedMetadata("ID3",e.data,t)},shaka.ads.AdManager.prototype.onCueMetadataChange=function(e){this.ssAdManager_&&this.ssAdManager_.onCueMetadataChange(e)},goog.exportSymbol("shaka.ads.AdManager",shaka.ads.AdManager),goog.exportProperty(shaka.ads.AdManager.prototype,"onCueMetadataChange",shaka.ads.AdManager.prototype.onCueMetadataChange),goog.exportProperty(shaka.ads.AdManager.prototype,"onHlsTimedMetadata",shaka.ads.AdManager.prototype.onHlsTimedMetadata),goog.exportProperty(shaka.ads.AdManager.prototype,"onDashTimedMetadata",shaka.ads.AdManager.prototype.onDashTimedMetadata),goog.exportProperty(shaka.ads.AdManager.prototype,"getStats",shaka.ads.AdManager.prototype.getStats),goog.exportProperty(shaka.ads.AdManager.prototype,"getServerSideCuePoints",shaka.ads.AdManager.prototype.getServerSideCuePoints),goog.exportProperty(shaka.ads.AdManager.prototype,"replaceServerSideAdTagParameters",shaka.ads.AdManager.prototype.replaceServerSideAdTagParameters),goog.exportProperty(shaka.ads.AdManager.prototype,"requestServerSideStream",shaka.ads.AdManager.prototype.requestServerSideStream),goog.exportProperty(shaka.ads.AdManager.prototype,"initServerSide",shaka.ads.AdManager.prototype.initServerSide),goog.exportProperty(shaka.ads.AdManager.prototype,"requestClientSideAds",shaka.ads.AdManager.prototype.requestClientSideAds),goog.exportProperty(shaka.ads.AdManager.prototype,"onAssetUnload",shaka.ads.AdManager.prototype.onAssetUnload),goog.exportProperty(shaka.ads.AdManager.prototype,"release",shaka.ads.AdManager.prototype.release),goog.exportProperty(shaka.ads.AdManager.prototype,"initClientSide",shaka.ads.AdManager.prototype.initClientSide),goog.exportProperty(shaka.ads.AdManager.prototype,"setLocale",shaka.ads.AdManager.prototype.setLocale),shaka.ads.AdManager.ADS_LOADED="ads-loaded",goog.exportProperty(shaka.ads.AdManager,"ADS_LOADED",shaka.ads.AdManager.ADS_LOADED),shaka.ads.AdManager.AD_STARTED="ad-started",goog.exportProperty(shaka.ads.AdManager,"AD_STARTED",shaka.ads.AdManager.AD_STARTED),shaka.ads.AdManager.AD_FIRST_QUARTILE="ad-first-quartile",goog.exportProperty(shaka.ads.AdManager,"AD_FIRST_QUARTILE",shaka.ads.AdManager.AD_FIRST_QUARTILE),shaka.ads.AdManager.AD_MIDPOINT="ad-midpoint",goog.exportProperty(shaka.ads.AdManager,"AD_MIDPOINT",shaka.ads.AdManager.AD_MIDPOINT),shaka.ads.AdManager.AD_THIRD_QUARTILE="ad-third-quartile",goog.exportProperty(shaka.ads.AdManager,"AD_THIRD_QUARTILE",shaka.ads.AdManager.AD_THIRD_QUARTILE),shaka.ads.AdManager.AD_COMPLETE="ad-complete",goog.exportProperty(shaka.ads.AdManager,"AD_COMPLETE",shaka.ads.AdManager.AD_COMPLETE),shaka.ads.AdManager.AD_STOPPED="ad-stopped",goog.exportProperty(shaka.ads.AdManager,"AD_STOPPED",shaka.ads.AdManager.AD_STOPPED),shaka.ads.AdManager.AD_SKIPPED="ad-skipped",goog.exportProperty(shaka.ads.AdManager,"AD_SKIPPED",shaka.ads.AdManager.AD_SKIPPED),shaka.ads.AdManager.AD_VOLUME_CHANGED="ad-volume-changed",goog.exportProperty(shaka.ads.AdManager,"AD_VOLUME_CHANGED",shaka.ads.AdManager.AD_VOLUME_CHANGED),shaka.ads.AdManager.AD_MUTED="ad-muted",goog.exportProperty(shaka.ads.AdManager,"AD_MUTED",shaka.ads.AdManager.AD_MUTED),shaka.ads.AdManager.AD_PAUSED="ad-paused",goog.exportProperty(shaka.ads.AdManager,"AD_PAUSED",shaka.ads.AdManager.AD_PAUSED),shaka.ads.AdManager.AD_RESUMED="ad-resumed",goog.exportProperty(shaka.ads.AdManager,"AD_RESUMED",shaka.ads.AdManager.AD_RESUMED),shaka.ads.AdManager.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",goog.exportProperty(shaka.ads.AdManager,"AD_SKIP_STATE_CHANGED",shaka.ads.AdManager.AD_SKIP_STATE_CHANGED),shaka.ads.AdManager.CUEPOINTS_CHANGED="ad-cue-points-changed",goog.exportProperty(shaka.ads.AdManager,"CUEPOINTS_CHANGED",shaka.ads.AdManager.CUEPOINTS_CHANGED),shaka.ads.AdManager.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",goog.exportProperty(shaka.ads.AdManager,"IMA_AD_MANAGER_LOADED",shaka.ads.AdManager.IMA_AD_MANAGER_LOADED),shaka.ads.AdManager.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",goog.exportProperty(shaka.ads.AdManager,"IMA_STREAM_MANAGER_LOADED",shaka.ads.AdManager.IMA_STREAM_MANAGER_LOADED),shaka.ads.AdManager.AD_CLICKED="ad-clicked",goog.exportProperty(shaka.ads.AdManager,"AD_CLICKED",shaka.ads.AdManager.AD_CLICKED),shaka.ads.AdManager.AD_PROGRESS="ad-progress",goog.exportProperty(shaka.ads.AdManager,"AD_PROGRESS",shaka.ads.AdManager.AD_PROGRESS),shaka.ads.AdManager.AD_BUFFERING="ad-buffering",goog.exportProperty(shaka.ads.AdManager,"AD_BUFFERING",shaka.ads.AdManager.AD_BUFFERING),shaka.ads.AdManager.AD_IMPRESSION="ad-impression",goog.exportProperty(shaka.ads.AdManager,"AD_IMPRESSION",shaka.ads.AdManager.AD_IMPRESSION),shaka.ads.AdManager.AD_DURATION_CHANGED="ad-duration-changed",goog.exportProperty(shaka.ads.AdManager,"AD_DURATION_CHANGED",shaka.ads.AdManager.AD_DURATION_CHANGED),shaka.ads.AdManager.AD_CLOSED="ad-closed",goog.exportProperty(shaka.ads.AdManager,"AD_CLOSED",shaka.ads.AdManager.AD_CLOSED),shaka.ads.AdManager.AD_LOADED="ad-loaded",goog.exportProperty(shaka.ads.AdManager,"AD_LOADED",shaka.ads.AdManager.AD_LOADED),shaka.ads.AdManager.ALL_ADS_COMPLETED="all-ads-completed",goog.exportProperty(shaka.ads.AdManager,"ALL_ADS_COMPLETED",shaka.ads.AdManager.ALL_ADS_COMPLETED),shaka.ads.AdManager.AD_LINEAR_CHANGED="ad-linear-changed",goog.exportProperty(shaka.ads.AdManager,"AD_LINEAR_CHANGED",shaka.ads.AdManager.AD_LINEAR_CHANGED),shaka.ads.AdManager.AD_METADATA="ad-metadata",goog.exportProperty(shaka.ads.AdManager,"AD_METADATA",shaka.ads.AdManager.AD_METADATA),shaka.ads.AdManager.AD_RECOVERABLE_ERROR="ad-recoverable-error",goog.exportProperty(shaka.ads.AdManager,"AD_RECOVERABLE_ERROR",shaka.ads.AdManager.AD_RECOVERABLE_ERROR),shaka.ads.AdManager.AD_BREAK_READY="ad-break-ready",goog.exportProperty(shaka.ads.AdManager,"AD_BREAK_READY",shaka.ads.AdManager.AD_BREAK_READY),shaka.ads.AdManager.AD_INTERACTION="ad-interaction",goog.exportProperty(shaka.ads.AdManager,"AD_INTERACTION",shaka.ads.AdManager.AD_INTERACTION),shaka.Player.setAdManagerFactory((function(){return new shaka.ads.AdManager})),shaka.cast={},shaka.cast.CastUtils=function(){},shaka.cast.CastUtils.serialize=function(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof shaka.util.FakeEvent){for(var r in e={},t){var a=t[r];a&&"object"==typeof a?"detail"==r&&(e[r]=a):r in Event||(e[r]=a)}return e}return t instanceof Error?shaka.cast.CastUtils.unpackError_(t):t instanceof TimeRanges?shaka.cast.CastUtils.unpackTimeRanges_(t):t instanceof Uint8Array?shaka.cast.CastUtils.unpackUint8Array_(t):"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t}}))},shaka.cast.CastUtils.deserialize=function(e){return JSON.parse(e,(function(e,t){return"NaN"==t?NaN:"-Infinity"==t?-1/0:"Infinity"==t?1/0:t&&"object"==typeof t&&"TimeRanges"==t.__type__?shaka.cast.CastUtils.simulateTimeRanges_(t):t&&"object"==typeof t&&"Uint8Array"==t.__type__?shaka.cast.CastUtils.makeUint8Array_(t):t&&"object"==typeof t&&"Error"==t.__type__?shaka.cast.CastUtils.makeError_(t):t}))},shaka.cast.CastUtils.unpackTimeRanges_=function(e){for(var t={__type__:"TimeRanges",length:e.length,start:[],end:[]},r=(e=$jscomp.makeIterator(shaka.media.TimeRangesUtils.getBufferedInfo(e))).next();!r.done;r=e.next()){var a=(r=r.value).end;t.start.push(r.start),t.end.push(a)}return t},shaka.cast.CastUtils.simulateTimeRanges_=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}},shaka.cast.CastUtils.unpackUint8Array_=function(e){return{__type__:"Uint8Array",entries:Array.from(e)}},shaka.cast.CastUtils.makeUint8Array_=function(e){return new Uint8Array(e.entries)},shaka.cast.CastUtils.unpackError_=function(e){var t,r=new Set(["name","message","stack"]);for(t in e)r.add(t);var a=$jscomp.makeIterator(Object.getOwnPropertyNames(e));for(t=a.next();!t.done;t=a.next())r.add(t.value);for(a={},t=(r=$jscomp.makeIterator(r)).next();!t.done;t=r.next())a[t=t.value]=e[t];return{__type__:"Error",contents:a}},shaka.cast.CastUtils.makeError_=function(e){e=e.contents;var t,r=Error(e.message);for(t in e)r[t]=e[t];return r},shaka.cast.CastUtils.VideoEvents="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),shaka.cast.CastUtils.VideoAttributes="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),shaka.cast.CastUtils.VideoInitStateAttributes=["loop","playbackRate"],shaka.cast.CastUtils.VideoVoidMethods=["pause","play"],shaka.cast.CastUtils.PlayerGetterMethods={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10},shaka.cast.CastUtils.LargePlayerGetterMethods={getConfiguration:4,getStats:5,getTextTracks:2,getVariantTracks:2},shaka.cast.CastUtils.PlayerGetterMethodsThatRequireLive={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},shaka.cast.CastUtils.PlayerInitState=[["getConfiguration","configure"]],shaka.cast.CastUtils.PlayerInitAfterLoadState=[["isTextTrackVisible","setTextTrackVisibility"]],shaka.cast.CastUtils.PlayerVoidMethods="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),shaka.cast.CastUtils.PlayerPromiseMethods=["attach","attachCanvas","detach","load","unload"],shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE="urn:x-cast:com.google.shaka.v2",shaka.cast.CastUtils.GENERIC_MESSAGE_NAMESPACE="urn:x-cast:com.google.cast.media",shaka.cast.CastSender=function(e,t,r,a,n,i,o){var s=this;this.receiverAppId_=e,this.androidReceiverCompatible_=o,this.statusChangeTimer_=new shaka.util.Timer(t),this.onFirstCastStateUpdate_=r,this.hasJoinedExistingSession_=!1,this.onRemoteEvent_=a,this.onResumeLocal_=n,this.onInitStateRequired_=i,this.isCasting_=this.apiReady_=!1,this.receiverName_="",this.appData_=null,this.onConnectionStatusChangedBound_=function(){return s.onConnectionStatusChanged_()},this.onMessageReceivedBound_=function(e,t){return s.onMessageReceived_(e,t)},this.cachedProperties_={video:{},player:{}},this.nextAsyncCallId_=0,this.asyncCallPromises_={},this.castPromise_=null,shaka.cast.CastSender.instances_.add(this)},shaka.cast.CastSender.prototype.destroy=function(){return shaka.cast.CastSender.instances_.delete(this),this.rejectAllPromises_(),shaka.cast.CastSender.session_&&this.removeListeners_(),this.statusChangeTimer_&&(this.statusChangeTimer_.stop(),this.statusChangeTimer_=null),this.onResumeLocal_=this.onRemoteEvent_=null,this.isCasting_=this.apiReady_=!1,this.onMessageReceivedBound_=this.onConnectionStatusChangedBound_=this.castPromise_=this.asyncCallPromises_=this.cachedProperties_=this.appData_=null,Promise.resolve()},shaka.cast.CastSender.prototype.apiReady=function(){return this.apiReady_},shaka.cast.CastSender.prototype.hasReceivers=function(){return shaka.cast.CastSender.hasReceivers_},shaka.cast.CastSender.prototype.isCasting=function(){return this.isCasting_},shaka.cast.CastSender.prototype.receiverName=function(){return this.receiverName_},shaka.cast.CastSender.prototype.hasRemoteProperties=function(){return 0!=Object.keys(this.cachedProperties_.video).length},shaka.cast.CastSender.prototype.init=function(){var e=shaka.cast.CastSender;if(this.receiverAppId_.length)if(window.chrome&&chrome.cast&&chrome.cast.isAvailable){this.apiReady_=!0,this.statusChangeTimer_.tickNow();var t=new chrome.cast.SessionRequest(this.receiverAppId_,[],null,this.androidReceiverCompatible_,null);t=new chrome.cast.ApiConfig(t,(function(t){return e.onExistingSessionJoined_(t)}),(function(t){return e.onReceiverStatusChanged_(t)}),"origin_scoped"),chrome.cast.initialize(t,(function(){shaka.log.debug("CastSender: init")}),(function(e){shaka.log.error("CastSender: init error",e)})),shaka.cast.CastSender.hasReceivers_&&this.statusChangeTimer_.tickAfter(shaka.cast.CastSender.STATUS_DELAY),(t=shaka.cast.CastSender.session_)&&t.status!=chrome.cast.SessionStatus.STOPPED?(shaka.log.debug("CastSender: re-using existing connection"),this.onExistingSessionJoined_(t)):shaka.cast.CastSender.session_=null}else window.__onGCastApiAvailable!==e.onGCastApiAvailable_&&(e.__onGCastApiAvailable_=window.__onGCastApiAvailable||null,window.__onGCastApiAvailable=e.onGCastApiAvailable_)},shaka.cast.CastSender.prototype.setAppData=function(e){this.appData_=e,this.isCasting_&&this.sendMessage_({type:"appData",appData:this.appData_})},shaka.cast.CastSender.prototype.cast=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(!t.apiReady_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.CAST,shaka.util.Error.Code.CAST_API_UNAVAILABLE);if(!shaka.cast.CastSender.hasReceivers_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.CAST,shaka.util.Error.Code.NO_CAST_RECEIVERS);if(t.isCasting_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.CAST,shaka.util.Error.Code.ALREADY_CASTING);return t.castPromise_=new shaka.util.PublicPromise,chrome.cast.requestSession((function(r){return t.onSessionInitiated_(e,r)}),(function(e){return t.onConnectionError_(e)})),r.yield(t.castPromise_,0)}))},shaka.cast.CastSender.prototype.showDisconnectDialog=function(){var e=this;if(this.isCasting_){var t=this.onInitStateRequired_();chrome.cast.requestSession((function(r){return e.onSessionInitiated_(t,r)}),(function(t){return e.onConnectionError_(t)}))}},shaka.cast.CastSender.prototype.forceDisconnect=function(){if(this.isCasting_){if(this.rejectAllPromises_(),shaka.cast.CastSender.session_){this.removeListeners_();try{shaka.cast.CastSender.session_.stop((function(){}),(function(){}))}catch(e){}shaka.cast.CastSender.session_=null}this.onConnectionStatusChanged_()}},shaka.cast.CastSender.prototype.get=function(e,t){var r=this;goog.asserts.assert("video"==e||"player"==e,"Unexpected target name");var a=shaka.cast.CastUtils;if("video"==e){if(a.VideoVoidMethods.includes(t))return function(){var a=$jscomp.getRestArguments.apply(0,arguments);return r.remoteCall_.apply(r,[e,t].concat($jscomp.arrayFromIterable(a)))}}else if("player"==e){if(a.PlayerGetterMethodsThatRequireLive[t]){var n=this.get("player","isLive")();if(goog.asserts.assert(n,t+" should be called on a live stream!"),!n)return function(){}}if(a.PlayerVoidMethods.includes(t))return function(){var a=$jscomp.getRestArguments.apply(0,arguments);return r.remoteCall_.apply(r,[e,t].concat($jscomp.arrayFromIterable(a)))};if(a.PlayerPromiseMethods.includes(t))return function(){var a=$jscomp.getRestArguments.apply(0,arguments);return r.remoteAsyncCall_.apply(r,[e,t].concat($jscomp.arrayFromIterable(a)))};if(a.PlayerGetterMethods[t]||a.LargePlayerGetterMethods[t])return function(){return r.propertyGetter_(e,t)}}return this.propertyGetter_(e,t)},shaka.cast.CastSender.prototype.set=function(e,t,r){goog.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]=r,this.sendMessage_({type:"set",targetName:e,property:t,value:r})},shaka.cast.CastSender.prototype.onSessionInitiated_=function(e,t){shaka.log.debug("CastSender: onSessionInitiated"),this.onSessionCreated_(t),this.sendMessage_({type:"init",initState:e,appData:this.appData_}),this.castPromise_.resolve()},shaka.cast.CastSender.prototype.onConnectionError_=function(e){var t=shaka.util.Error.Code.UNEXPECTED_CAST_ERROR;switch(e.code){case"cancel":t=shaka.util.Error.Code.CAST_CANCELED_BY_USER;break;case"timeout":t=shaka.util.Error.Code.CAST_CONNECTION_TIMED_OUT;break;case"receiver_unavailable":t=shaka.util.Error.Code.CAST_RECEIVER_APP_UNAVAILABLE}this.castPromise_.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.CAST,t,e))},shaka.cast.CastSender.prototype.propertyGetter_=function(e,t){return goog.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]},shaka.cast.CastSender.prototype.remoteCall_=function(e,t){var r=$jscomp.getRestArguments.apply(2,arguments);goog.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.sendMessage_({type:"call",targetName:e,methodName:t,args:r})},shaka.cast.CastSender.prototype.remoteAsyncCall_=function(e,t){var r=$jscomp.getRestArguments.apply(2,arguments);goog.asserts.assert("video"==e||"player"==e,"Unexpected target name");var a=new shaka.util.PublicPromise,n=this.nextAsyncCallId_.toString();this.nextAsyncCallId_++,this.asyncCallPromises_[n]=a;try{this.sendMessage_({type:"asyncCall",targetName:e,methodName:t,args:r,id:n})}catch(e){a.reject(e)}return a},shaka.cast.CastSender.onExistingSessionJoined_=function(e){for(var t=$jscomp.makeIterator(shaka.cast.CastSender.instances_),r=t.next();!r.done;r=t.next())r.value.onExistingSessionJoined_(e)},shaka.cast.CastSender.prototype.onExistingSessionJoined_=function(e){shaka.log.debug("CastSender: onExistingSessionJoined");var t=this.onInitStateRequired_();this.castPromise_=new shaka.util.PublicPromise,this.hasJoinedExistingSession_=!0,this.onSessionInitiated_(t,e)},shaka.cast.CastSender.onReceiverStatusChanged_=function(e){for(var t=$jscomp.makeIterator(shaka.cast.CastSender.instances_),r=t.next();!r.done;r=t.next())r.value.onReceiverStatusChanged_(e)},shaka.cast.CastSender.prototype.onReceiverStatusChanged_=function(e){shaka.log.debug("CastSender: receiver status",e),shaka.cast.CastSender.hasReceivers_="available"==e,this.statusChangeTimer_.tickNow()},shaka.cast.CastSender.prototype.onSessionCreated_=function(e){shaka.cast.CastSender.session_=e,e.addUpdateListener(this.onConnectionStatusChangedBound_),e.addMessageListener(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_),this.onConnectionStatusChanged_()},shaka.cast.CastSender.prototype.removeListeners_=function(){var e=shaka.cast.CastSender.session_;e.removeUpdateListener(this.onConnectionStatusChangedBound_),e.removeMessageListener(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_)},shaka.cast.CastSender.prototype.onConnectionStatusChanged_=function(){var e=!!shaka.cast.CastSender.session_&&"connected"==shaka.cast.CastSender.session_.status;if(shaka.log.debug("CastSender: connection status",e),this.isCasting_&&!e){for(var t in this.onResumeLocal_(),this.cachedProperties_)this.cachedProperties_[t]={};this.rejectAllPromises_()}this.receiverName_=(this.isCasting_=e)?shaka.cast.CastSender.session_.receiver.friendlyName:"",this.statusChangeTimer_.tickNow()},shaka.cast.CastSender.prototype.rejectAllPromises_=function(){for(var e in this.asyncCallPromises_){var t=this.asyncCallPromises_[e];delete this.asyncCallPromises_[e],t.reject(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.LOAD_INTERRUPTED))}},shaka.cast.CastSender.prototype.onMessageReceived_=function(e,t){switch(e=shaka.cast.CastUtils.deserialize(t),shaka.log.v2("CastSender: message",e),e.type){case"event":var r=e.targetName,a=shaka.util.FakeEvent.fromRealEvent(e.event);this.onRemoteEvent_(r,a);break;case"update":for(a in r=e.update)for(var n in e=this.cachedProperties_[a]||{},r[a])e[n]=r[a][n];this.hasJoinedExistingSession_&&(this.onFirstCastStateUpdate_(),this.hasJoinedExistingSession_=!1);break;case"asyncComplete":if(a=e.id,n=e.error,e=this.asyncCallPromises_[a],delete this.asyncCallPromises_[a],goog.asserts.assert(e,"Unexpected async id"),e)if(n){for(r in a=new shaka.util.Error(n.severity,n.category,n.code),n)a[r]=n[r];e.reject(a)}else e.resolve()}},shaka.cast.CastSender.prototype.sendMessage_=function(e){e=shaka.cast.CastUtils.serialize(e);var t=shaka.cast.CastSender.session_;try{t.sendMessage(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,e,(function(){}),shaka.log.error)}catch(r){throw shaka.log.error("Cast session sendMessage threw",r),e=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.CAST,shaka.util.Error.Code.CAST_CONNECTION_TIMED_OUT,r),t=new shaka.util.FakeEvent("error",(new Map).set("detail",e)),this.onRemoteEvent_("player",t),this.forceDisconnect(),e}},shaka.cast.CastSender.STATUS_DELAY=.02,shaka.cast.CastSender.hasReceivers_=!1,shaka.cast.CastSender.session_=null,shaka.cast.CastSender.__onGCastApiAvailable_=null,shaka.cast.CastSender.instances_=new Set,shaka.cast.CastSender.onSdkLoaded_=function(e){if(e)for(var t=(e=$jscomp.makeIterator(shaka.cast.CastSender.instances_)).next();!t.done;t=e.next())t.value.init()},shaka.cast.CastSender.onGCastApiAvailable_=function(e){shaka.cast.CastSender.__onGCastApiAvailable_?window.__onGCastApiAvailable=shaka.cast.CastSender.__onGCastApiAvailable_:delete window.__onGCastApiAvailable,shaka.cast.CastSender.__onGCastApiAvailable_=null,shaka.cast.CastSender.onSdkLoaded_(e),"function"==typeof window.__onGCastApiAvailable&&window.__onGCastApiAvailable(e)},shaka.cast.CastProxy=function(e,t,r,a){a=void 0!==a&&a,shaka.util.FakeEventTarget.call(this);var n=this;this.localVideo_=e,this.localPlayer_=t,this.eventManager_=this.playerEventTarget_=this.videoEventTarget_=this.playerProxy_=this.videoProxy_=null,this.receiverAppId_=r,this.androidReceiverCompatible_=a,this.compiledToExternNames_=new Map,this.sender_=new shaka.cast.CastSender(r,(function(){return n.onCastStatusChanged_()}),(function(){return n.onFirstCastStateUpdate_()}),(function(e,t){return n.onRemoteEvent_(e,t)}),(function(){return n.onResumeLocal_()}),(function(){return n.getInitState_()}),a),this.init_()},$jscomp.inherits(shaka.cast.CastProxy,shaka.util.FakeEventTarget),shaka.cast.CastProxy.prototype.destroy=function(e){return e&&this.sender_.forceDisconnect(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),e=[],this.localPlayer_&&(e.push(this.localPlayer_.destroy()),this.localPlayer_=null),this.sender_&&(e.push(this.sender_.destroy()),this.sender_=null),this.playerProxy_=this.videoProxy_=this.localVideo_=null,shaka.util.FakeEventTarget.prototype.release.call(this),Promise.all(e)},shaka.cast.CastProxy.prototype.getVideo=function(){return this.videoProxy_},shaka.cast.CastProxy.prototype.getPlayer=function(){return this.playerProxy_},shaka.cast.CastProxy.prototype.canCast=function(){return this.sender_.apiReady()&&this.sender_.hasReceivers()},shaka.cast.CastProxy.prototype.isCasting=function(){return this.sender_.isCasting()},shaka.cast.CastProxy.prototype.receiverName=function(){return this.sender_.receiverName()},shaka.cast.CastProxy.prototype.cast=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(e=t.getInitState_(),r.yield(t.sender_.cast(e),2)):t.localPlayer_?r.yield(t.localPlayer_.unload(),0):r.return()}))},shaka.cast.CastProxy.prototype.setAppData=function(e){this.sender_.setAppData(e)},shaka.cast.CastProxy.prototype.suggestDisconnect=function(){this.sender_.showDisconnectDialog()},shaka.cast.CastProxy.prototype.forceDisconnect=function(){this.sender_.forceDisconnect()},shaka.cast.CastProxy.prototype.changeReceiverId=function(e,t){t=void 0!==t&&t;var r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return e==r.receiverAppId_&&t==r.androidReceiverCompatible_?a.return():(r.receiverAppId_=e,r.androidReceiverCompatible_=t,r.sender_.forceDisconnect(),a.yield(r.sender_.destroy(),2));r.sender_=null,r.sender_=new shaka.cast.CastSender(e,(function(){return r.onCastStatusChanged_()}),(function(){return r.onFirstCastStateUpdate_()}),(function(e,t){return r.onRemoteEvent_(e,t)}),(function(){return r.onResumeLocal_()}),(function(){return r.getInitState_()}),t),r.sender_.init(),a.jumpToEnd()}))},shaka.cast.CastProxy.prototype.init_=function(){var e=this;this.sender_.init(),this.eventManager_=new shaka.util.EventManager;for(var t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoEvents),r=t.next();!r.done;r=t.next())this.eventManager_.listen(this.localVideo_,r.value,(function(t){return e.videoProxyLocalEvent_(t)}));for(var a in shaka.util.FakeEvent.EventName)this.eventManager_.listen(this.localPlayer_,shaka.util.FakeEvent.EventName[a],(function(t){return e.playerProxyLocalEvent_(t)}));for(var n in this.videoProxy_={},t={},this.localVideo_)t.$jscomp$loop$prop$k$660=n,Object.defineProperty(this.videoProxy_,t.$jscomp$loop$prop$k$660,{configurable:!1,enumerable:!0,get:function(t){return function(){return e.videoProxyGet_(t.$jscomp$loop$prop$k$660)}}(t),set:function(t){return function(r){e.videoProxySet_(t.$jscomp$loop$prop$k$660,r)}}(t)}),t={$jscomp$loop$prop$k$660:t.$jscomp$loop$prop$k$660};this.playerProxy_={},this.iterateOverPlayerMethods_((function(t,r){goog.asserts.assert(e.playerProxy_,"Must have player proxy!"),Object.defineProperty(e.playerProxy_,t,{configurable:!1,enumerable:!0,get:function(){return e.playerProxyGet_(t)}})})),COMPILED&&this.mapCompiledToUncompiledPlayerMethodNames_(),this.videoEventTarget_=new shaka.util.FakeEventTarget,this.videoEventTarget_.dispatchTarget=this.videoProxy_,this.playerEventTarget_=new shaka.util.FakeEventTarget,this.playerEventTarget_.dispatchTarget=this.playerProxy_},shaka.cast.CastProxy.prototype.mapCompiledToUncompiledPlayerMethodNames_=function(){var e=this,t=new Map;this.iterateOverPlayerMethods_((function(r,a){t.has(a)?(a=t.get(a),r.length<a.length?e.compiledToExternNames_.set(r,a):e.compiledToExternNames_.set(a,r)):t.set(a,r)}))},shaka.cast.CastProxy.prototype.iterateOverPlayerMethods_=function(e){function t(e){return"constructor"!=e&&"function"==typeof r[e]&&!a.has(e)}goog.asserts.assert(this.localPlayer_,"Must have player!");var r=this.localPlayer_,a=new Set;for(n in r)t(n)&&(a.add(n),e(n,r[n]));for(var n=Object.getPrototypeOf(r),i=Object.getPrototypeOf({});n&&n!=i;){for(var o=$jscomp.makeIterator(Object.getOwnPropertyNames(n)),s=o.next();!s.done;s=o.next())t(s=s.value)&&(a.add(s),e(s,r[s]));n=Object.getPrototypeOf(n)}},shaka.cast.CastProxy.prototype.getInitState_=function(){var e={video:{},player:{},playerAfterLoad:{},manifest:this.localPlayer_.getAssetUri(),startTime:null};this.localVideo_.pause();for(var t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoInitStateAttributes),r=t.next();!r.done;r=t.next())r=r.value,e.video[r]=this.localVideo_[r];for(this.localVideo_.ended||(e.startTime=this.localVideo_.currentTime),r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitState)).next();!r.done;r=t.next()){var a=r.value;r=a[1],a=this.localPlayer_[a[0]](),e.player[r]=a}for(r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitAfterLoadState)).next();!r.done;r=t.next())r=(a=r.value)[1],a=this.localPlayer_[a[0]](),e.playerAfterLoad[r]=a;return e},shaka.cast.CastProxy.prototype.onCastStatusChanged_=function(){var e=new shaka.util.FakeEvent("caststatuschanged");this.dispatchEvent(e)},shaka.cast.CastProxy.prototype.onFirstCastStateUpdate_=function(){var e=new shaka.util.FakeEvent(this.videoProxy_.paused?"pause":"play");this.videoEventTarget_.dispatchEvent(e)},shaka.cast.CastProxy.prototype.onResumeLocal_=function(){for(var e=this,t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitState),r=t.next();!r.done;r=t.next()){var a=r.value;r=a[1],a=this.sender_.get("player",a[0])(),this.localPlayer_[r](a)}var n=this.sender_.get("player","getAssetUri")();r=this.sender_.get("video","ended"),t=Promise.resolve();var i=this.localVideo_.autoplay;a=null,r||(a=this.sender_.get("video","currentTime")),n&&(this.localVideo_.autoplay=!1,t=this.localPlayer_.load(n,a));var o={};for(a=(r=$jscomp.makeIterator(shaka.cast.CastUtils.VideoInitStateAttributes)).next();!a.done;a=r.next())a=a.value,o[a]=this.sender_.get("video",a);t.then((function(){if(e.localVideo_){for(var t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoInitStateAttributes),r=t.next();!r.done;r=t.next())r=r.value,e.localVideo_[r]=o[r];for(r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitAfterLoadState)).next();!r.done;r=t.next()){var a=r.value;r=a[1],a=e.sender_.get("player",a[0])(),e.localPlayer_[r](a)}e.localVideo_.autoplay=i,n&&e.localVideo_.play()}}),(function(t){goog.asserts.assert(t instanceof shaka.util.Error,"Wrong error type!");var r=shaka.util.FakeEvent.EventName.Error;t=(new Map).set("detail",t),r=new shaka.util.FakeEvent(r,t),e.localPlayer_.dispatchEvent(r)}))},shaka.cast.CastProxy.prototype.videoProxyGet_=function(e){var t=this;if("addEventListener"==e)return function(e,r,a){return t.videoEventTarget_.addEventListener(e,r,a)};if("removeEventListener"==e)return function(e,r,a){return t.videoEventTarget_.removeEventListener(e,r,a)};if(this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()){var r=this.localVideo_[e];if("function"!=typeof r)return r}return this.sender_.isCasting()?this.sender_.get("video",e):("function"==typeof(e=this.localVideo_[e])&&(e=e.bind(this.localVideo_)),e)},shaka.cast.CastProxy.prototype.videoProxySet_=function(e,t){this.sender_.isCasting()?this.sender_.set("video",e,t):this.localVideo_[e]=t},shaka.cast.CastProxy.prototype.videoProxyLocalEvent_=function(e){this.sender_.isCasting()||(e=shaka.util.FakeEvent.fromRealEvent(e),this.videoEventTarget_.dispatchEvent(e))},shaka.cast.CastProxy.prototype.playerProxyGet_=function(e){var t=this;if(this.compiledToExternNames_.has(e)&&(e=this.compiledToExternNames_.get(e)),"addEventListener"==e)return function(e,r,a){return t.playerEventTarget_.addEventListener(e,r,a)};if("removeEventListener"==e)return function(e,r,a){return t.playerEventTarget_.removeEventListener(e,r,a)};if("getMediaElement"==e)return function(){return t.videoProxy_};if("getSharedConfiguration"==e)return shaka.log.warning("Can't share configuration across a network. Returning copy."),this.sender_.get("player","getConfiguration");if("getNetworkingEngine"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: getNetworkingEngine() is always local!"),function(){return t.localPlayer_.getNetworkingEngine()};if("getDrmEngine"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: getDrmEngine() is always local!"),function(){return t.localPlayer_.getDrmEngine()};if("getAdManager"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: getAdManager() is always local!"),function(){return t.localPlayer_.getAdManager()};if("setVideoContainer"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: setVideoContainer() is always local!"),function(e){return t.localPlayer_.setVideoContainer(e)};if(this.sender_.isCasting()){if("getManifest"==e||"drmInfo"==e)return function(){return shaka.log.alwaysWarn(e+"() does not work while casting!"),null};if("attach"==e||"detach"==e)return function(){return shaka.log.alwaysWarn(e+"() does not work while casting!"),Promise.resolve()}}if(this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()&&(shaka.cast.CastUtils.PlayerGetterMethods[e]||shaka.cast.CastUtils.LargePlayerGetterMethods[e])){var r=this.localPlayer_[e];return goog.asserts.assert("function"==typeof r,"only methods on Player"),r.bind(this.localPlayer_)}return this.sender_.isCasting()?this.sender_.get("player",e):(r=this.localPlayer_[e],goog.asserts.assert("function"==typeof r,"only methods on Player"),r.bind(this.localPlayer_))},shaka.cast.CastProxy.prototype.playerProxyLocalEvent_=function(e){this.sender_.isCasting()||this.playerEventTarget_.dispatchEvent(e)},shaka.cast.CastProxy.prototype.onRemoteEvent_=function(e,t){goog.asserts.assert(this.sender_.isCasting(),"Should only receive remote events while casting"),this.sender_.isCasting()&&("video"==e?this.videoEventTarget_.dispatchEvent(t):"player"==e&&this.playerEventTarget_.dispatchEvent(t))},goog.exportSymbol("shaka.cast.CastProxy",shaka.cast.CastProxy),goog.exportProperty(shaka.cast.CastProxy.prototype,"changeReceiverId",shaka.cast.CastProxy.prototype.changeReceiverId),goog.exportProperty(shaka.cast.CastProxy.prototype,"forceDisconnect",shaka.cast.CastProxy.prototype.forceDisconnect),goog.exportProperty(shaka.cast.CastProxy.prototype,"suggestDisconnect",shaka.cast.CastProxy.prototype.suggestDisconnect),goog.exportProperty(shaka.cast.CastProxy.prototype,"setAppData",shaka.cast.CastProxy.prototype.setAppData),goog.exportProperty(shaka.cast.CastProxy.prototype,"cast",shaka.cast.CastProxy.prototype.cast),goog.exportProperty(shaka.cast.CastProxy.prototype,"receiverName",shaka.cast.CastProxy.prototype.receiverName),goog.exportProperty(shaka.cast.CastProxy.prototype,"isCasting",shaka.cast.CastProxy.prototype.isCasting),goog.exportProperty(shaka.cast.CastProxy.prototype,"canCast",shaka.cast.CastProxy.prototype.canCast),goog.exportProperty(shaka.cast.CastProxy.prototype,"getPlayer",shaka.cast.CastProxy.prototype.getPlayer),goog.exportProperty(shaka.cast.CastProxy.prototype,"getVideo",shaka.cast.CastProxy.prototype.getVideo),goog.exportProperty(shaka.cast.CastProxy.prototype,"destroy",shaka.cast.CastProxy.prototype.destroy),shaka.cast.CastReceiver=function(e,t,r,a){shaka.util.FakeEventTarget.call(this);var n=this;this.video_=e,this.player_=t,this.eventManager_=new shaka.util.EventManager,this.targets_={video:e,player:t},this.appDataCallback_=r||function(){},this.contentIdCallback_=a||function(e){return e},this.metadata_=null,this.isConnected_=!1,this.isIdle_=!0,this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!0,this.genericBus_=this.shakaBus_=null,this.pollTimer_=new shaka.util.Timer((function(){n.pollAttributes_()})),this.init_()},$jscomp.inherits(shaka.cast.CastReceiver,shaka.util.FakeEventTarget),shaka.cast.CastReceiver.prototype.isConnected=function(){return this.isConnected_},shaka.cast.CastReceiver.prototype.isIdle=function(){return this.isIdle_},shaka.cast.CastReceiver.prototype.setContentMetadata=function(e){this.metadata_=e},shaka.cast.CastReceiver.prototype.clearContentMetadata=function(){this.metadata_=null},shaka.cast.CastReceiver.prototype.setContentTitle=function(e){this.metadata_||(this.metadata_={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.metadata_.title=e},shaka.cast.CastReceiver.prototype.setContentImage=function(e){this.metadata_||(this.metadata_={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.metadata_.images=[{url:e}]},shaka.cast.CastReceiver.prototype.setContentArtist=function(e){this.metadata_||(this.metadata_={}),this.metadata_.artist=e,this.metadata_.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},shaka.cast.CastReceiver.prototype.destroy=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return t.eventManager_&&(t.eventManager_.release(),t.eventManager_=null),e=[],t.player_&&(e.push(t.player_.destroy()),t.player_=null),t.pollTimer_&&(t.pollTimer_.stop(),t.pollTimer_=null),t.video_=null,t.targets_=null,t.appDataCallback_=null,t.isConnected_=!1,t.isIdle_=!0,t.shakaBus_=null,t.genericBus_=null,shaka.util.FakeEventTarget.prototype.release.call(t),r.yield(Promise.all(e),2);cast.receiver.CastReceiverManager.getInstance().stop(),r.jumpToEnd()}))},shaka.cast.CastReceiver.prototype.init_=function(){var e=this,t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return e.onSendersChanged_()},t.onSenderDisconnected=function(){return e.onSendersChanged_()},t.onSystemVolumeChanged=function(){return e.fakeVolumeChangeEvent_()},this.genericBus_=t.getCastMessageBus(shaka.cast.CastUtils.GENERIC_MESSAGE_NAMESPACE),this.genericBus_.onMessage=function(t){return e.onGenericMessage_(t)},this.shakaBus_=t.getCastMessageBus(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE),this.shakaBus_.onMessage=function(t){return e.onShakaMessage_(t)},goog.DEBUG?shaka.util.Platform.isChromecast()&&t.start():t.start();for(var r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoEvents)).next();!r.done;r=t.next())this.eventManager_.listen(this.video_,r.value,(function(t){return e.proxyEvent_("video",t)}));for(var a in shaka.util.FakeEvent.EventName)this.eventManager_.listen(this.player_,shaka.util.FakeEvent.EventName[a],(function(t){return e.proxyEvent_("player",t)}));cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?this.player_.setMaxHardwareResolution(3840,2160):this.player_.setMaxHardwareResolution(1920,1080),this.eventManager_.listen(this.video_,"loadeddata",(function(){e.startUpdatingUpdateNumber_=!0})),this.eventManager_.listen(this.player_,"loading",(function(){e.isIdle_=!1,e.onCastStatusChanged_()})),this.eventManager_.listen(this.video_,"playing",(function(){e.isIdle_=!1,e.onCastStatusChanged_()})),this.eventManager_.listen(this.video_,"pause",(function(){e.onCastStatusChanged_()})),this.eventManager_.listen(this.player_,"unloading",(function(){e.isIdle_=!0,e.onCastStatusChanged_()})),this.eventManager_.listen(this.video_,"ended",(function(){new shaka.util.Timer((function(){e.video_&&e.video_.ended&&(e.isIdle_=!0,e.onCastStatusChanged_())})).tickAfter(shaka.cast.CastReceiver.IDLE_INTERVAL)}))},shaka.cast.CastReceiver.prototype.onSendersChanged_=function(){this.updateNumber_=0,this.initialStatusUpdatePending_=!0,this.isConnected_=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,this.onCastStatusChanged_()},shaka.cast.CastReceiver.prototype.onCastStatusChanged_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?r.yield(Promise.resolve(),2):t.player_?(e=new shaka.util.FakeEvent("caststatuschanged"),t.dispatchEvent(e),t.maybeSendMediaInfoMessage_()||t.sendMediaStatus_(),void r.jumpToEnd()):r.return()}))},shaka.cast.CastReceiver.prototype.initState_=function(e,t){var r,a,n,i,o,s,l,u,c,d,p,h=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(f){switch(f.nextAddress){case 1:for(r in e.player)a=e.player[r],h.player_[r](a);return h.appDataCallback_(t),n=h.video_.autoplay,e.manifest?(h.video_.autoplay=!1,f.setCatchFinallyBlocks(5),f.yield(h.player_.load(e.manifest,e.startTime),7)):f.yield(Promise.resolve(),3);case 7:f.leaveTryBlock(3);break;case 5:return i=f.enterCatchBlock(),goog.asserts.assert(i instanceof shaka.util.Error,"Wrong error type!"),o=shaka.util.FakeEvent.EventName.Error,s=(new Map).set("detail",i),l=new shaka.util.FakeEvent(o,s),h.player_&&h.player_.dispatchEvent(l),f.return();case 3:if(!h.player_)return f.return();for(u in e.video)c=e.video[u],h.video_[u]=c;for(d in e.playerAfterLoad)p=e.playerAfterLoad[d],h.player_[d](p);h.video_.autoplay=n,e.manifest&&(h.video_.play(),h.sendMediaStatus_()),f.jumpToEnd()}}))},shaka.cast.CastReceiver.prototype.proxyEvent_=function(e,t){this.player_&&(this.pollAttributes_(),this.sendMessage_({type:"event",targetName:e,event:t},this.shakaBus_))},shaka.cast.CastReceiver.prototype.pollAttributes_=function(){this.pollTimer_.tickAfter(shaka.cast.CastReceiver.POLL_INTERVAL);for(var e={video:{},player:{}},t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoAttributes),r=t.next();!r.done;r=t.next())r=r.value,e.video[r]=this.video_[r];if(this.player_.isLive())for(var a in t=shaka.cast.CastUtils.PlayerGetterMethodsThatRequireLive)0==this.updateNumber_%t[a]&&(e.player[a]=this.player_[a]());for(var n in shaka.cast.CastUtils.PlayerGetterMethods)0==this.updateNumber_%shaka.cast.CastUtils.PlayerGetterMethods[n]&&(e.player[n]=this.player_[n]());for(var i in(a=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(e.video.volume=a.level,e.video.muted=a.muted),this.sendMessage_({type:"update",update:e},this.shakaBus_),shaka.cast.CastUtils.LargePlayerGetterMethods)0==this.updateNumber_%shaka.cast.CastUtils.LargePlayerGetterMethods[i]&&((e={player:{}}).player[i]=this.player_[i](),this.sendMessage_({type:"update",update:e},this.shakaBus_));this.startUpdatingUpdateNumber_&&(this.updateNumber_+=1),this.maybeSendMediaInfoMessage_()},shaka.cast.CastReceiver.prototype.maybeSendMediaInfoMessage_=function(){return!(!this.initialStatusUpdatePending_||!this.video_.duration&&!this.player_.isLive())&&(this.sendMediaInfoMessage_(),this.initialStatusUpdatePending_=!1,!0)},shaka.cast.CastReceiver.prototype.sendMediaInfoMessage_=function(e){e=void 0===e?0:e;var t={contentId:this.player_.getAssetUri(),streamType:this.player_.isLive()?"LIVE":"BUFFERED",contentType:""};this.player_.isLive()||(t.duration=this.video_.duration),this.metadata_&&(t.metadata=this.metadata_),this.sendMediaStatus_(e,t)},shaka.cast.CastReceiver.prototype.fakeVolumeChangeEvent_=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();goog.asserts.assert(e,"System volume should not be null!"),e&&this.sendMessage_({type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.shakaBus_),this.sendMessage_({type:"event",targetName:"video",event:{type:"volumechange"}},this.shakaBus_)},shaka.cast.CastReceiver.prototype.onShakaMessage_=function(e){var t=this,r=shaka.cast.CastUtils.deserialize(e.data);switch(shaka.log.debug("CastReceiver: message",r),r.type){case"init":this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!0,this.initState_(r.initState,r.appData),this.pollAttributes_();break;case"appData":this.appDataCallback_(r.appData);break;case"set":var a=r.targetName,n=r.property;if(r=r.value,"video"==a){if(e=cast.receiver.CastReceiverManager.getInstance(),"volume"==n){e.setSystemVolumeLevel(r);break}if("muted"==n){e.setSystemVolumeMuted(r);break}}this.targets_[a][n]=r;break;case"call":(a=this.targets_[r.targetName])[r.methodName].apply(a,r.args);break;case"asyncCall":a=r.targetName,n=r.methodName,"player"==a&&"load"==n&&(this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1);var i=r.id,o=e.senderId;r=(e=this.targets_[a])[n].apply(e,r.args),"player"==a&&"load"==n&&(r=r.then((function(){t.initialStatusUpdatePending_=!0}))),r.then((function(){return t.sendAsyncComplete_(o,i,null)}),(function(e){return t.sendAsyncComplete_(o,i,e)}))}},shaka.cast.CastReceiver.prototype.onGenericMessage_=function(e){var t=this,r=shaka.cast.CastUtils.deserialize(e.data);switch(shaka.log.debug("CastReceiver: message",r),r.type){case"PLAY":this.video_.play(),this.sendMediaStatus_();break;case"PAUSE":this.video_.pause(),this.sendMediaStatus_();break;case"SEEK":e=r.currentTime;var a=r.resumeState;null!=e&&(this.video_.currentTime=Number(e)),a&&"PLAYBACK_START"==a?(this.video_.play(),this.sendMediaStatus_()):a&&"PLAYBACK_PAUSE"==a&&(this.video_.pause(),this.sendMediaStatus_());break;case"STOP":this.player_.unload().then((function(){t.player_&&t.sendMediaStatus_()}));break;case"GET_STATUS":this.sendMediaInfoMessage_(Number(r.requestId));break;case"VOLUME":e=(a=r.volume).level,a=a.muted;var n=this.video_.volume,i=this.video_.muted;null!=e&&(this.video_.volume=Number(e)),null!=a&&(this.video_.muted=a),n==this.video_.volume&&i==this.video_.muted||this.sendMediaStatus_();break;case"LOAD":this.updateNumber_=0,this.initialStatusUpdatePending_=this.startUpdatingUpdateNumber_=!1,e=r.media,a=r.currentTime,n=this.contentIdCallback_(e.contentId),i=r.autoplay||!0,this.appDataCallback_(e.customData),i&&(this.video_.autoplay=!0),this.player_.load(n,a).then((function(){t.player_&&t.sendMediaInfoMessage_()})).catch((function(e){goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!");var a="LOAD_FAILED";e.category==shaka.util.Error.Category.PLAYER&&e.code==shaka.util.Error.Code.LOAD_INTERRUPTED&&(a="LOAD_CANCELLED"),t.sendMessage_({requestId:Number(r.requestId),type:a},t.genericBus_)}));break;default:shaka.log.warning("Unrecognized message type from the generic Chromecast controller!",r.type),this.sendMessage_({requestId:Number(r.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.genericBus_)}},shaka.cast.CastReceiver.prototype.sendAsyncComplete_=function(e,t,r){this.player_&&this.sendMessage_({type:"asyncComplete",id:t,error:r},this.shakaBus_,e)},shaka.cast.CastReceiver.prototype.sendMessage_=function(e,t,r){this.isConnected_&&(e=shaka.cast.CastUtils.serialize(e),r?t.getCastChannel(r).send(e):t.broadcast(e))},shaka.cast.CastReceiver.prototype.getPlayState_=function(){var e=shaka.cast.CastReceiver.PLAY_STATE;return this.isIdle_?e.IDLE:this.player_.isBuffering()?e.BUFFERING:this.video_.paused?e.PAUSED:e.PLAYING},shaka.cast.CastReceiver.prototype.sendMediaStatus_=function(e,t){e=void 0===e?0:e,t=void 0===t?null:t;var r={mediaSessionId:0,playbackRate:this.video_.playbackRate,playerState:this.getPlayState_(),currentTime:this.video_.currentTime,supportedMediaCommands:63,volume:{level:this.video_.volume,muted:this.video_.muted}};t&&(r.media=t),this.sendMessage_({requestId:e,type:"MEDIA_STATUS",status:[r]},this.genericBus_)},goog.exportSymbol("shaka.cast.CastReceiver",shaka.cast.CastReceiver),goog.exportProperty(shaka.cast.CastReceiver.prototype,"destroy",shaka.cast.CastReceiver.prototype.destroy),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentArtist",shaka.cast.CastReceiver.prototype.setContentArtist),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentImage",shaka.cast.CastReceiver.prototype.setContentImage),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentTitle",shaka.cast.CastReceiver.prototype.setContentTitle),goog.exportProperty(shaka.cast.CastReceiver.prototype,"clearContentMetadata",shaka.cast.CastReceiver.prototype.clearContentMetadata),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentMetadata",shaka.cast.CastReceiver.prototype.setContentMetadata),goog.exportProperty(shaka.cast.CastReceiver.prototype,"isIdle",shaka.cast.CastReceiver.prototype.isIdle),goog.exportProperty(shaka.cast.CastReceiver.prototype,"isConnected",shaka.cast.CastReceiver.prototype.isConnected),shaka.cast.CastReceiver.POLL_INTERVAL=.5,shaka.cast.CastReceiver.IDLE_INTERVAL=5,shaka.cast.CastReceiver.PLAY_STATE={IDLE:"IDLE",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED"},shaka.dash={},shaka.dash.ContentProtection=function(){},shaka.dash.ContentProtection.parseFromAdaptationSet=function(e,t,r){var a=shaka.dash.ContentProtection,n=shaka.util.ManifestParserUtils,i=a.parseElements_(e),o=null;e=[];var s=[],l=new Set(i.map((function(e){return e.keyId})));if(l.delete(null),1<l.size)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_CONFLICTING_KEY_IDS);if(t||(s=i.filter((function(e){return e.schemeUri!=a.MP4Protection_||(goog.asserts.assert(!e.init||e.init.length,"Init data must be null or non-empty."),o=e.init||o,!1)}))).length&&(0==(e=a.convertElements_(o,s,r,l)).length&&(e=[n.createDrmInfo("",o)])),i.length&&(t||!s.length))for(e=[],r=(t=$jscomp.makeIterator(Object.values(r))).next();!r.done;r=t.next())"org.w3.clearkey"!=(r=r.value)&&(r=n.createDrmInfo(r,o),e.push(r));if(n=Array.from(l)[0]||null)for(t=(l=$jscomp.makeIterator(e)).next();!t.done;t=l.next())for(r=(t=$jscomp.makeIterator(t.value.initData)).next();!r.done;r=t.next())r.value.keyId=n;return{defaultKeyId:n,defaultInit:o,drmInfos:e,firstRepresentation:!0}},shaka.dash.ContentProtection.parseFromRepresentation=function(e,t,r,a){var n=shaka.dash.ContentProtection.parseFromAdaptationSet(e,r,a);if(t.firstRepresentation)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,r=0==n.drmInfos.length,(0==t.drmInfos.length||e&&!r)&&(t.drmInfos=n.drmInfos),t.firstRepresentation=!1;else if(0<n.drmInfos.length&&(t.drmInfos=t.drmInfos.filter((function(e){return n.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==t.drmInfos.length))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_COMMON_KEY_SYSTEM);return n.defaultKeyId||t.defaultKeyId},shaka.dash.ContentProtection.getWidevineLicenseUrl=function(e){return(e=shaka.util.XmlUtils.findChildNS(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""},shaka.dash.ContentProtection.getClearKeyLicenseUrl=function(e){return(e=shaka.util.XmlUtils.findChildNS(e.node,shaka.dash.ContentProtection.ClearKeyNamespaceUri_,"Laurl"))&&"EME-1.0"===e.getAttribute("Lic_type")&&e.textContent?e.textContent:""},shaka.dash.ContentProtection.parseMsProRecords_=function(e,t){for(var r=[];t<e.byteLength-1;){var a=e.getUint16(t,!0);t+=2;var n=e.getUint16(t,!0);if(t+=2,0!=(1&n)||n+t>e.byteLength)return shaka.log.warning("Malformed MS PRO object"),[];var i=shaka.util.BufferUtils.toUint8(e,t,n);r.push({type:a,value:i}),t+=n}return r},shaka.dash.ContentProtection.parseMsPro_=function(e){var t=0,r=shaka.util.BufferUtils.toDataView(e),a=r.getUint32(t,!0);return t+=4,a!=e.byteLength?(shaka.log.warning("PlayReady Object with invalid length encountered."),[]):shaka.dash.ContentProtection.parseMsProRecords_(r,t+2)},shaka.dash.ContentProtection.getLaurl_=function(e){for(var t=(e=$jscomp.makeIterator(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var r=(t=$jscomp.makeIterator(t.value.childNodes)).next();!r.done;r=t.next())if((r=r.value)instanceof Element&&"LA_URL"==r.tagName)return r.textContent;return""},shaka.dash.ContentProtection.getPlayReadyLicenseUrl=function(e){var t=shaka.util.XmlUtils.findChildNS(e.node,"urn:microsoft:playready","pro");if(!t)return"";var r=(e=shaka.dash.ContentProtection).PLAYREADY_RECORD_TYPES;return t=shaka.util.Uint8ArrayUtils.fromBase64(t.textContent),(t=e.parseMsPro_(t).filter((function(e){return e.type===r.RIGHTS_MANAGEMENT}))[0])?(t=shaka.util.StringUtils.fromUTF16(t.value,!0),(t=shaka.util.XmlUtils.parseXmlString(t,"WRMHEADER"))?e.getLaurl_(t):""):""},shaka.dash.ContentProtection.getInitDataFromPro_=function(e){var t=shaka.util.XmlUtils.findChildNS(e.node,"urn:microsoft:playready","pro");if(!t)return null;t=shaka.util.Uint8ArrayUtils.fromBase64(t.textContent);var r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),a=new Set;return[{initData:shaka.util.Pssh.createPssh(t,r,a,0),initDataType:"cenc",keyId:e.keyId}]},shaka.dash.ContentProtection.getInitDataClearKey_=function(e,t){if(0==t.size)return null;var r=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),a=new Uint8Array([]);return[{initData:shaka.util.Pssh.createPssh(a,r,t,1),initDataType:"cenc",keyId:e.keyId}]},shaka.dash.ContentProtection.convertElements_=function(e,t,r,a){for(var n=shaka.dash.ContentProtection,i=shaka.util.ManifestParserUtils,o=n.licenseUrlParsers_,s=[],l=(t=$jscomp.makeIterator(t)).next();!l.done;l=t.next()){var u=r[(l=l.value).schemeUri];if(u){goog.asserts.assert(!l.init||l.init.length,"Init data must be null or non-empty.");var c=n.getInitDataFromPro_(l),d=null;l.schemeUri===shaka.dash.ContentProtection.ClearKeySchemeUri_&&(d=n.getInitDataClearKey_(l,a)),c=i.createDrmInfo(u,l.init||e||c||d),(u=o.get(u))&&(c.licenseServerUri=u(l)),s.push(c)}}return s},shaka.dash.ContentProtection.parseElements_=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=shaka.dash.ContentProtection.parseElement_(r.value))&&t.push(r);return t},shaka.dash.ContentProtection.parseElement_=function(e){var t=shaka.dash.ContentProtection.CencNamespaceUri_,r=e.getAttribute("schemeIdUri"),a=shaka.util.XmlUtils.getAttributeNS(e,t,"default_KID");if(t=shaka.util.XmlUtils.findChildrenNS(e,t,"pssh").map(shaka.util.XmlUtils.getContents),!r)return shaka.log.error("Missing required schemeIdUri attribute on","ContentProtection element",e),null;if(r=r.toLowerCase(),a&&(a=a.replace(/-/g,"").toLowerCase()).includes(" "))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED);var n=[];try{n=t.map((function(e){return{initDataType:"cenc",initData:shaka.util.Uint8ArrayUtils.fromBase64(e),keyId:null}}))}catch(e){throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_PSSH_BAD_ENCODING)}return{node:e,schemeUri:r,keyId:a,init:0<n.length?n:null}},shaka.dash.ContentProtection.PLAYREADY_RECORD_TYPES={RIGHTS_MANAGEMENT:1,RESERVED:2,EMBEDDED_LICENSE:3},shaka.dash.ContentProtection.licenseUrlParsers_=(new Map).set("com.widevine.alpha",shaka.dash.ContentProtection.getWidevineLicenseUrl).set("com.microsoft.playready",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.recommendation",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.software",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.hardware",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("org.w3.clearkey",shaka.dash.ContentProtection.getClearKeyLicenseUrl),shaka.dash.ContentProtection.MP4Protection_="urn:mpeg:dash:mp4protection:2011",shaka.dash.ContentProtection.CencNamespaceUri_="urn:mpeg:cenc:2013",shaka.dash.ContentProtection.ClearKeyNamespaceUri_="http://dashif.org/guidelines/clearKey",shaka.dash.ContentProtection.ClearKeySchemeUri_="urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",shaka.dash.MpdUtils=function(){},shaka.dash.MpdUtils.fillUriTemplate=function(e,t,r,a,n){var i={RepresentationID:t,Number:r,Bandwidth:a,Time:n};return e.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(t,r,a,n){if("$$"==t)return"$";var o=i[r];if(goog.asserts.assert(void 0!==o,"Unrecognized identifier"),null==o)return shaka.log.warning("URL template does not have an available substitution for ",'identifier "'+r+'":',e),t;switch("RepresentationID"==r&&a&&(shaka.log.warning("URL template should not contain a width specifier for identifier",'"RepresentationID":',e),a=void 0),"Time"==r&&(goog.asserts.assert("number"==typeof o,"Time value should be a number!"),goog.asserts.assert(.2>Math.abs(o-Math.round(o)),"Calculated $Time$ values must be close to integers"),o=Math.round(o)),n){case void 0:case"d":case"i":case"u":t=o.toString();break;case"o":t=o.toString(8);break;case"x":t=o.toString(16);break;case"X":t=o.toString(16).toUpperCase();break;default:goog.asserts.assert(!1,"Unhandled format specifier"),t=o.toString()}return a=window.parseInt(a,10)||1,Array(Math.max(0,a-t.length)+1).join("0")+t}))},shaka.dash.MpdUtils.createTimeline=function(e,t,r,a){goog.asserts.assert(0<t&&1/0>t,"timescale must be a positive, finite integer"),goog.asserts.assert(0<a,"period duration must be a positive integer");var n=shaka.util.XmlUtils;e=n.findChildren(e,"S");for(var i=[],o=-r,s=0;s<e.length;++s){var l=e[s],u=e[s+1],c=n.parseAttr(l,"t",n.parseNonNegativeInt),d=n.parseAttr(l,"d",n.parseNonNegativeInt),p=n.parseAttr(l,"r",n.parseInt);if(null!=c&&(c-=r),!d){shaka.log.warning('"S" element must have a duration:','ignoring the remaining "S" elements.',l);break}if(c=null!=c?c:o,0>(p=p||0))if(u){if(null==(u=n.parseAttr(u,"t",n.parseNonNegativeInt))){shaka.log.warning('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',l);break}if(c>=u){shaka.log.warning('An "S" element cannot have a negative repeatif its start ','time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',l);break}p=Math.ceil((u-c)/d)-1}else{if(1/0==a){shaka.log.warning('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',l);break}if(c/t>=a){shaka.log.warning('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',l);break}p=Math.ceil((a*t-c)/d)-1}for(0<i.length&&c!=o&&(Math.abs((c-o)/t)>=shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS&&shaka.log.warning("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",l),i[i.length-1].end=c/t),l=0;l<=p;++l)o=c+d,i.push({start:c/t,end:o/t,unscaledStart:c}),c=o}return i},shaka.dash.MpdUtils.parseSegmentInfo=function(e,t){goog.asserts.assert(t(e.representation),"There must be at least one element of the given type.");var r=shaka.dash.MpdUtils,a=shaka.util.XmlUtils,n=r.inheritAttribute(e,t,"timescale"),i=1;n&&(i=a.parsePositiveInt(n)||1);var o=r.inheritAttribute(e,t,"duration");n=a.parsePositiveInt(o||""),e.representation.contentType==shaka.util.ManifestParserUtils.ContentType.IMAGE&&(n=a.parseFloat(o||"")),n&&(n/=i);var s=r.inheritAttribute(e,t,"startNumber");return o=Number(r.inheritAttribute(e,t,"presentationTimeOffset"))||0,a=a.parseNonNegativeInt(s||""),null!=s&&null!=a||(a=1),s=null,(t=r.inheritChild(e,t,"SegmentTimeline"))&&(s=r.createTimeline(t,i,o,e.periodInfo.duration||1/0)),{timescale:i,segmentDuration:n,startNumber:a,scaledPresentationTimeOffset:o/i||0,unscaledPresentationTimeOffset:o,timeline:s}},shaka.dash.MpdUtils.inheritAttribute=function(e,t,r){var a=shaka.util.Functional;return goog.asserts.assert(t(e.representation),"There must be at least one element of the given type"),[t(e.representation),t(e.adaptationSet),t(e.period)].filter(a.isNotNull).map((function(e){return e.getAttribute(r)})).reduce((function(e,t){return e||t}))},shaka.dash.MpdUtils.inheritChild=function(e,t,r){var a=shaka.util.Functional;goog.asserts.assert(t(e.representation),"There must be at least one element of the given type"),e=[t(e.representation),t(e.adaptationSet),t(e.period)].filter(a.isNotNull);var n=shaka.util.XmlUtils;return e.map((function(e){return n.findChild(e,r)})).reduce((function(e,t){return e||t}))},shaka.dash.MpdUtils.handleXlinkInElement_=function(e,t,r,a,n,i){var o=shaka.util.XmlUtils,s=shaka.util.Error,l=shaka.util.ManifestParserUtils,u=shaka.dash.MpdUtils.XlinkNamespaceUri_,c=o.getAttributeNS(e,u,"href");o=o.getAttributeNS(e,u,"actuate")||"onRequest";for(var d=$jscomp.makeIterator(Array.from(e.attributes)),p=d.next();!p.done;p=d.next())(p=p.value).namespaceURI==u&&e.removeAttributeNS(p.namespaceURI,p.localName);if(5<=i)return shaka.util.AbortableOperation.failed(new s(s.Severity.CRITICAL,s.Category.MANIFEST,s.Code.DASH_XLINK_DEPTH_LIMIT));if("onLoad"!=o)return shaka.util.AbortableOperation.failed(new s(s.Severity.CRITICAL,s.Category.MANIFEST,s.Code.DASH_UNSUPPORTED_XLINK_ACTUATE));var h=l.resolveUris([a],[c]);return a=shaka.net.NetworkingEngine.RequestType.MANIFEST,l=shaka.net.NetworkingEngine.makeRequest(h,t),a=n.request(a,l),goog.asserts.assert(a instanceof shaka.util.AbortableOperation,"Unexpected implementation of IAbortableOperation!"),a.chain((function(a){if(!(a=shaka.util.XmlUtils.parseXml(a.data,e.tagName)))return shaka.util.AbortableOperation.failed(new s(s.Severity.CRITICAL,s.Category.MANIFEST,s.Code.DASH_INVALID_XML,c));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;a.childNodes.length;){var o=a.childNodes[0];a.removeChild(o),e.appendChild(o)}for(o=(a=$jscomp.makeIterator(Array.from(a.attributes))).next();!o.done;o=a.next())e.setAttributeNode(o.value.cloneNode(!1));return shaka.dash.MpdUtils.processXlinks(e,t,r,h[0],n,i+1)}))},shaka.dash.MpdUtils.processXlinks=function(e,t,r,a,n,i){i=void 0===i?0:i;var o=shaka.dash.MpdUtils,s=shaka.util.XmlUtils,l=o.XlinkNamespaceUri_;if(s.getAttributeNS(e,l,"href"))return s=o.handleXlinkInElement_(e,t,r,a,n,i),r&&(s=s.chain(void 0,(function(s){return o.processXlinks(e,t,r,a,n,i)}))),s;for(var u=[],c=$jscomp.makeIterator(Array.from(e.childNodes)),d=c.next();!d.done;d=c.next())(d=d.value)instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==s.getAttributeNS(d,l,"href")?e.removeChild(d):"SegmentTimeline"!=d.tagName&&u.push(shaka.dash.MpdUtils.processXlinks(d,t,r,a,n,i)));return shaka.util.AbortableOperation.all(u).chain((function(){return e}))},shaka.dash.MpdUtils.XlinkNamespaceUri_="http://www.w3.org/1999/xlink",shaka.media.Mp4SegmentIndexParser=function(){},shaka.media.Mp4SegmentIndexParser.parse=function(e,t,r,a,n,i,o){var s,l=shaka.media.Mp4SegmentIndexParser,u=(new shaka.util.Mp4Parser).fullBox("sidx",(function(e){s=l.parseSIDX_(t,a,n,i,o,r,e)}));if(e&&u.parse(e),s)return s;throw shaka.log.error('Invalid box type, expected "sidx".'),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MP4_SIDX_WRONG_BOX_TYPE)},shaka.media.Mp4SegmentIndexParser.parseSIDX_=function(e,t,r,a,n,i,o){goog.asserts.assert(null!=o.version,"SIDX is a full box and should have a valid version.");var s=[];o.reader.skip(4);var l=o.reader.readUint32();if(0==l)throw shaka.log.error("Invalid timescale."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MP4_SIDX_INVALID_TIMESCALE);if(0==o.version)var u=o.reader.readUint32(),c=o.reader.readUint32();else u=o.reader.readUint64(),c=o.reader.readUint64();o.reader.skip(2);var d=o.reader.readUint16();for(e=e+o.size+c,c=0;c<d;c++){var p=o.reader.readUint32(),h=(2147483648&p)>>>31;p&=2147483647;var f=o.reader.readUint32();if(o.reader.skip(4),1==h)throw shaka.log.error("Heirarchical SIDXs are not supported."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MP4_SIDX_TYPE_NOT_SUPPORTED);s.push(new shaka.media.SegmentReference(u/l+r,(u+f)/l+r,(function(){return i}),e,e+p-1,t,r,a,n)),u+=f,e+=p}return o.parser.stop(),s},shaka.util.EbmlParser=function(e){this.dataView_=shaka.util.BufferUtils.toDataView(e),this.reader_=new shaka.util.DataViewReader(this.dataView_,shaka.util.DataViewReader.Endianness.BIG_ENDIAN)},shaka.util.EbmlParser.prototype.hasMoreData=function(){return this.reader_.hasMoreData()},shaka.util.EbmlParser.prototype.parseElement=function(){var e=this.parseId_(),t=this.parseVint_();t=shaka.util.EbmlParser.isDynamicSizeValue_(t)?this.dataView_.byteLength-this.reader_.getPosition():shaka.util.EbmlParser.getVintValue_(t),t=this.reader_.getPosition()+t<=this.dataView_.byteLength?t:this.dataView_.byteLength-this.reader_.getPosition();var r=shaka.util.BufferUtils.toDataView(this.dataView_,this.reader_.getPosition(),t);return this.reader_.skip(t),new shaka.util.EbmlElement(e,r)},shaka.util.EbmlParser.prototype.parseId_=function(){var e=this.parseVint_();if(7<e.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_OVERFLOW);for(var t=0,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())t=256*t+r.value;return t},shaka.util.EbmlParser.prototype.parseVint_=function(){var e=this.reader_.getPosition(),t=this.reader_.readUint8();if(0==t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_OVERFLOW);return t=8-Math.floor(Math.log2(t)),goog.asserts.assert(8>=t&&1<=t,"Incorrect log2 value"),this.reader_.skip(t-1),shaka.util.BufferUtils.toUint8(this.dataView_,e,t)},shaka.util.EbmlParser.getVintValue_=function(e){if(8==e.length&&224&e[1])throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.JS_INTEGER_OVERFLOW);for(var t=0,r=0;r<e.length;r++){var a=e[r];t=0==r?a&(1<<8-e.length)-1:256*t+a}return t},shaka.util.EbmlParser.isDynamicSizeValue_=function(e){for(var t=shaka.util.BufferUtils,r=$jscomp.makeIterator(shaka.util.EbmlParser.DYNAMIC_SIZES),a=r.next();!a.done;a=r.next())if(t.equal(e,new Uint8Array(a.value)))return!0;return!1},shaka.util.EbmlParser.DYNAMIC_SIZES=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]],shaka.util.EbmlElement=function(e,t){this.id=e,this.dataView_=t},shaka.util.EbmlElement.prototype.getOffset=function(){return this.dataView_.byteOffset},shaka.util.EbmlElement.prototype.createParser=function(){return new shaka.util.EbmlParser(this.dataView_)},shaka.util.EbmlElement.prototype.getUint=function(){if(8<this.dataView_.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_OVERFLOW);if(8==this.dataView_.byteLength&&224&this.dataView_.getUint8(0))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.JS_INTEGER_OVERFLOW);for(var e=0,t=0;t<this.dataView_.byteLength;t++){e=256*e+this.dataView_.getUint8(t)}return e},shaka.util.EbmlElement.prototype.getFloat=function(){if(4==this.dataView_.byteLength)return this.dataView_.getFloat32(0);if(8==this.dataView_.byteLength)return this.dataView_.getFloat64(0);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_BAD_FLOATING_POINT_SIZE)},shaka.media.WebmSegmentIndexParser=function(){},shaka.media.WebmSegmentIndexParser.parse=function(e,t,r,a,n,i,o){if(t=shaka.media.WebmSegmentIndexParser.parseWebmContainer_(t),(e=new shaka.util.EbmlParser(e).parseElement()).id!=shaka.media.WebmSegmentIndexParser.CUES_ID)throw shaka.log.error("Not a Cues element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_CUES_ELEMENT_MISSING);return shaka.media.WebmSegmentIndexParser.parseCues_(e,t.segmentOffset,t.timecodeScale,t.duration,r,a,n,i,o)},shaka.media.WebmSegmentIndexParser.parseWebmContainer_=function(e){if((e=new shaka.util.EbmlParser(e)).parseElement().id!=shaka.media.WebmSegmentIndexParser.EBML_ID)throw shaka.log.error("Not an EBML element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_EBML_HEADER_ELEMENT_MISSING);var t=e.parseElement();if(t.id!=shaka.media.WebmSegmentIndexParser.SEGMENT_ID)throw shaka.log.error("Not a Segment element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_SEGMENT_ELEMENT_MISSING);return{segmentOffset:e=t.getOffset(),timecodeScale:(t=shaka.media.WebmSegmentIndexParser.parseSegment_(t)).timecodeScale,duration:t.duration}},shaka.media.WebmSegmentIndexParser.parseSegment_=function(e){e=e.createParser();for(var t=null;e.hasMoreData();){var r=e.parseElement();if(r.id==shaka.media.WebmSegmentIndexParser.INFO_ID){t=r;break}}if(!t)throw shaka.log.error("Not an Info element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_INFO_ELEMENT_MISSING);return shaka.media.WebmSegmentIndexParser.parseInfo_(t)},shaka.media.WebmSegmentIndexParser.parseInfo_=function(e){var t=e.createParser(),r=1e6;for(e=null;t.hasMoreData();){var a=t.parseElement();a.id==shaka.media.WebmSegmentIndexParser.TIMECODE_SCALE_ID?r=a.getUint():a.id==shaka.media.WebmSegmentIndexParser.DURATION_ID&&(e=a.getFloat())}if(null==e)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_DURATION_ELEMENT_MISSING);return{timecodeScale:t=r/1e9,duration:e*t}},shaka.media.WebmSegmentIndexParser.parseCues_=function(e,t,r,a,n,i,o,s,l){var u=[],c=function(){return n};e=e.createParser();for(var d=null,p=null;e.hasMoreData();){var h=e.parseElement();if(h.id==shaka.media.WebmSegmentIndexParser.CUE_POINT_ID){var f=shaka.media.WebmSegmentIndexParser.parseCuePoint_(h);f&&(h=r*f.unscaledTime,f=t+f.relativeOffset,null!=d&&(goog.asserts.assert(null!=p,"last offset cannot be null"),u.push(new shaka.media.SegmentReference(d+o,h+o,c,p,f-1,i,o,s,l))),d=h,p=f)}}return null!=d&&(goog.asserts.assert(null!=p,"last offset cannot be null"),u.push(new shaka.media.SegmentReference(d+o,a+o,c,p,null,i,o,s,l))),u},shaka.media.WebmSegmentIndexParser.parseCuePoint_=function(e){var t=e.createParser();if((e=t.parseElement()).id!=shaka.media.WebmSegmentIndexParser.CUE_TIME_ID)throw shaka.log.warning("Not a CueTime element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_CUE_TIME_ELEMENT_MISSING);if(e=e.getUint(),(t=t.parseElement()).id!=shaka.media.WebmSegmentIndexParser.CUE_TRACK_POSITIONS_ID)throw shaka.log.warning("Not a CueTrackPositions element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING);t=t.createParser();for(var r=0;t.hasMoreData();){var a=t.parseElement();if(a.id==shaka.media.WebmSegmentIndexParser.CUE_CLUSTER_POSITION){r=a.getUint();break}}return{unscaledTime:e,relativeOffset:r}},shaka.media.WebmSegmentIndexParser.EBML_ID=440786851,shaka.media.WebmSegmentIndexParser.SEGMENT_ID=408125543,shaka.media.WebmSegmentIndexParser.INFO_ID=357149030,shaka.media.WebmSegmentIndexParser.TIMECODE_SCALE_ID=2807729,shaka.media.WebmSegmentIndexParser.DURATION_ID=17545,shaka.media.WebmSegmentIndexParser.CUES_ID=475249515,shaka.media.WebmSegmentIndexParser.CUE_POINT_ID=187,shaka.media.WebmSegmentIndexParser.CUE_TIME_ID=179,shaka.media.WebmSegmentIndexParser.CUE_TRACK_POSITIONS_ID=183,shaka.media.WebmSegmentIndexParser.CUE_CLUSTER_POSITION=241,shaka.dash.SegmentBase=function(){},shaka.dash.SegmentBase.createInitSegment=function(e,t){var r=shaka.util.XmlUtils,a=shaka.util.ManifestParserUtils;if(!(t=shaka.dash.MpdUtils.inheritChild(e,t,"Initialization")))return null;var n=e.representation.baseUris,i=t.getAttribute("sourceURL");return i&&(n=a.resolveUris(e.representation.baseUris,[i])),a=0,i=null,(r=r.parseAttr(t,"range",r.parseRange))&&(a=r.start,i=r.end),e=shaka.dash.SegmentBase.createQualityInfo(e),new shaka.media.InitSegmentReference((function(){return n}),a,i,e)},shaka.dash.SegmentBase.createStreamInfo=function(e,t){goog.asserts.assert(e.representation.segmentBase,"Should only be called with SegmentBase");var r=shaka.dash.MpdUtils,a=shaka.dash.SegmentBase,n=shaka.util.XmlUtils,i=Number(r.inheritAttribute(e,a.fromInheritance_,"presentationTimeOffset"))||0,o=1;(r=r.inheritAttribute(e,a.fromInheritance_,"timescale"))&&(o=n.parsePositiveInt(r)||1);var s=i/o||0,l=a.createInitSegment(e,a.fromInheritance_);a.checkSegmentIndexRangeSupport_(e,l);var u=shaka.util.ObjectUtils.shallowCloneObject(e);return{generateSegmentIndex:function(){return a.generateSegmentIndex_(u,t,l,s)}}},shaka.dash.SegmentBase.generateSegmentIndexFromUris=function(e,t,r,a,n,i,o){var s,l,u,c,d,p,h,f,g,y,m,v,_,k,E;return $jscomp.asyncExecutePromiseGeneratorProgram((function(T){return 1==T.nextAddress?(s=e.presentationTimeline,l=!e.dynamic||!e.periodInfo.isLastPeriod,u=e.periodInfo.start,c=e.periodInfo.duration,d=e.representation.mimeType.split("/")[1],h=null,f=[(p=t)(a,n,i),"webm"==d?p(r.getUris(),r.startByte,r.endByte):null],p=null,T.yield(Promise.all(f),2)):(g=T.yieldResult,y=g[0],m=g[1]||null,v=null,_=u-o,k=u,E=c?u+c:1/0,"mp4"==d?v=shaka.media.Mp4SegmentIndexParser.parse(y,n,a,r,_,k,E):(goog.asserts.assert(m,"WebM requires init data"),v=shaka.media.WebmSegmentIndexParser.parse(y,m,a,r,_,k,E)),s.notifySegments(v),goog.asserts.assert(!h,"Should not call generateSegmentIndex twice"),h=new shaka.media.SegmentIndex(v),l&&h.fit(k,E,!0),T.return(h))}))},shaka.dash.SegmentBase.fromInheritance_=function(e){return e.segmentBase},shaka.dash.SegmentBase.computeIndexRange_=function(e){var t=shaka.dash.MpdUtils,r=shaka.dash.SegmentBase,a=shaka.util.XmlUtils,n=t.inheritChild(e,r.fromInheritance_,"RepresentationIndex");return e=t.inheritAttribute(e,r.fromInheritance_,"indexRange"),e=a.parseRange(e||""),n&&(e=a.parseAttr(n,"range",a.parseRange,e)),e},shaka.dash.SegmentBase.computeIndexUris_=function(e){var t=shaka.util.ManifestParserUtils,r=shaka.dash.MpdUtils.inheritChild(e,shaka.dash.SegmentBase.fromInheritance_,"RepresentationIndex"),a=e.representation.baseUris;return r&&(r=r.getAttribute("sourceURL"))&&(a=t.resolveUris(e.representation.baseUris,[r])),a},shaka.dash.SegmentBase.checkSegmentIndexRangeSupport_=function(e,t){var r=shaka.dash.SegmentBase;if(r.checkSegmentIndexSupport(e,t),!r.computeIndexRange_(e))throw shaka.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)},shaka.dash.SegmentBase.checkSegmentIndexSupport=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType,a=e.representation.contentType,n=e.representation.mimeType.split("/")[1];if(a!=r.TEXT&&"mp4"!=n&&"webm"!=n)throw shaka.log.error("SegmentBase specifies an unsupported container type.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_CONTAINER);if("webm"==n&&!t)throw shaka.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_WEBM_MISSING_INIT)},shaka.dash.SegmentBase.generateSegmentIndex_=function(e,t,r,a){var n=shaka.dash.SegmentBase,i=n.computeIndexUris_(e);return n=n.computeIndexRange_(e),goog.asserts.assert(n,"Index range should not be null!"),shaka.dash.SegmentBase.generateSegmentIndexFromUris(e,t,r,i,n.start,n.end,a)},shaka.dash.SegmentBase.createQualityInfo=function(e){var t=e.representation;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.numChannels,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null}},shaka.dash.SegmentList=function(){},shaka.dash.SegmentList.createStreamInfo=function(e,t){goog.asserts.assert(e.representation.segmentList,"Should only be called with SegmentList");var r=shaka.dash.SegmentList,a=shaka.dash.SegmentBase.createInitSegment(e,r.fromInheritance_),n=r.parseSegmentListInfo_(e);r.checkSegmentListInfo_(e,n);var i=null,o=null;e.period.id&&e.representation.id&&(o=t[e.period.id+","+e.representation.id])&&(i=o.segmentIndex);var s=r.createSegmentReferences_(e.periodInfo.start,e.periodInfo.duration,n.startNumber,e.representation.baseUris,n,a);return t=!i,i?(r=e.presentationTimeline.getSegmentAvailabilityStart(),i.mergeAndEvict(s,r)):i=new shaka.media.SegmentIndex(s),e.presentationTimeline.notifySegments(s),e.dynamic&&e.periodInfo.isLastPeriod||i.fit(e.periodInfo.start,e.periodInfo.duration?e.periodInfo.start+e.periodInfo.duration:1/0,t),o&&(o.segmentIndex=i),{generateSegmentIndex:function(){return i&&!i.isEmpty()||i.merge(s),Promise.resolve(i)}}},shaka.dash.SegmentList.fromInheritance_=function(e){return e.segmentList},shaka.dash.SegmentList.parseSegmentListInfo_=function(e){var t=shaka.dash.SegmentList,r=shaka.dash.MpdUtils,a=t.parseMediaSegments_(e);return 0==(t=(e=r.parseSegmentInfo(e,t.fromInheritance_)).startNumber)&&(shaka.log.warning("SegmentList@startNumber must be > 0"),t=1),r=0,e.segmentDuration?r=e.segmentDuration*(t-1):e.timeline&&0<e.timeline.length&&(r=e.timeline[0].start),{segmentDuration:e.segmentDuration,startTime:r,startNumber:t,scaledPresentationTimeOffset:e.scaledPresentationTimeOffset,timeline:e.timeline,mediaSegments:a}},shaka.dash.SegmentList.checkSegmentListInfo_=function(e,t){if(!t.segmentDuration&&!t.timeline&&1<t.mediaSegments.length)throw shaka.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);if(!t.segmentDuration&&!e.periodInfo.duration&&!t.timeline&&1==t.mediaSegments.length)throw shaka.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);if(t.timeline&&0==t.timeline.length)throw shaka.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)},shaka.dash.SegmentList.createSegmentReferences_=function(e,t,r,a,n,i){r=shaka.util.ManifestParserUtils;var o=n.mediaSegments.length;n.timeline&&n.timeline.length!=n.mediaSegments.length&&(o=Math.min(n.timeline.length,n.mediaSegments.length),shaka.log.warning("The number of items in the segment timeline and the number of ","segment URLs do not match, truncating",n.mediaSegments.length,"to",o));for(var s=e-n.scaledPresentationTimeOffset,l=t?e+t:1/0,u=[],c=n.startTime,d={},p=0;p<o;d={$jscomp$loop$prop$mediaUri$662:d.$jscomp$loop$prop$mediaUri$662},p++){var h=n.mediaSegments[p];d.$jscomp$loop$prop$mediaUri$662=r.resolveUris(a,[h.mediaUri]);var f=void 0;null!=n.segmentDuration?f=c+n.segmentDuration:n.timeline?f=n.timeline[p].end:(goog.asserts.assert(1==n.mediaSegments.length&&t,"There should be exactly one segment with a Period duration."),f=c+t);var g=function(e){return function(){return e.$jscomp$loop$prop$mediaUri$662}}(d);u.push(new shaka.media.SegmentReference(e+c,e+f,g,h.start,h.end,i,s,e,l)),c=f}return u},shaka.dash.SegmentList.parseMediaSegments_=function(e){var t=[e.representation.segmentList,e.adaptationSet.segmentList,e.period.segmentList].filter(shaka.util.Functional.isNotNull),r=shaka.util.XmlUtils;return t.map((function(e){return r.findChildren(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.getAttribute("indexRange")&&!e.indexRangeWarningGiven&&(e.indexRangeWarningGiven=!0,shaka.log.warning("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{mediaUri:t.getAttribute("media"),start:(t=r.parseAttr(t,"mediaRange",r.parseRange,{start:0,end:null})).start,end:t.end}}))},shaka.dash.SegmentTemplate=function(){},shaka.dash.SegmentTemplate.createStreamInfo=function(e,t,r,a,n,i){goog.asserts.assert(e.representation.segmentTemplate,"Should only be called with SegmentTemplate");var o=shaka.dash.SegmentTemplate,s=o.createInitSegment_(e),l=o.parseSegmentTemplateInfo_(e);o.checkSegmentTemplateInfo_(e,l);var u=shaka.util.ObjectUtils.shallowCloneObject(e);if(l.indexTemplate)return shaka.dash.SegmentBase.checkSegmentIndexSupport(e,s),{generateSegmentIndex:function(){return o.generateSegmentIndexFromIndexTemplate_(u,t,s,l)}};if(l.segmentDuration)return a||"image"===e.adaptationSet.contentType||(e.presentationTimeline.notifyMaxSegmentDuration(l.segmentDuration),e.presentationTimeline.notifyMinSegmentStartTime(e.periodInfo.start)),{generateSegmentIndex:function(){return o.generateSegmentIndexFromDuration_(u,l,n,s,i)}};var c=null;a=a=null,e.period.id&&e.representation.id&&(a=r[a=e.period.id+","+e.representation.id])&&(c=a.segmentIndex);var d=o.createFromTimeline_(u,l,s);r=e.periodInfo.start;var p=e.periodInfo.duration?e.periodInfo.start+e.periodInfo.duration:1/0,h=!(e.dynamic&&e.periodInfo.isLastPeriod);return c?(h&&new shaka.media.SegmentIndex(d).fit(r,p,!0),c.mergeAndEvict(d,e.presentationTimeline.getSegmentAvailabilityStart())):c=new shaka.media.SegmentIndex(d),e.presentationTimeline.notifySegments(d),h&&c.fit(r,p),a&&e.dynamic&&(a.segmentIndex=c),{generateSegmentIndex:function(){return c&&!c.isEmpty()||c.merge(d),Promise.resolve(c)}}},shaka.dash.SegmentTemplate.fromInheritance_=function(e){return e.segmentTemplate},shaka.dash.SegmentTemplate.parseSegmentTemplateInfo_=function(e){var t=shaka.dash.SegmentTemplate,r=shaka.dash.MpdUtils,a=r.parseSegmentInfo(e,t.fromInheritance_),n=r.inheritAttribute(e,t.fromInheritance_,"media");return e=r.inheritAttribute(e,t.fromInheritance_,"index"),{segmentDuration:a.segmentDuration,timescale:a.timescale,startNumber:a.startNumber,scaledPresentationTimeOffset:a.scaledPresentationTimeOffset,unscaledPresentationTimeOffset:a.unscaledPresentationTimeOffset,timeline:a.timeline,mediaTemplate:n,indexTemplate:e}},shaka.dash.SegmentTemplate.checkSegmentTemplateInfo_=function(e,t){var r=t.indexTemplate?1:0;if(r+=t.timeline?1:0,0==(r+=t.segmentDuration?1:0))throw shaka.log.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);if(1!=r&&(shaka.log.warning("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.representation),t.indexTemplate?(shaka.log.info("Using the index URL template by default."),t.timeline=null):(goog.asserts.assert(t.timeline,"There should be a timeline"),shaka.log.info("Using the SegmentTimeline by default.")),t.segmentDuration=null),!t.indexTemplate&&!t.mediaTemplate)throw shaka.log.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)},shaka.dash.SegmentTemplate.generateSegmentIndexFromIndexTemplate_=function(e,t,r,a){var n=shaka.dash.MpdUtils,i=shaka.util.ManifestParserUtils;return goog.asserts.assert(a.indexTemplate,"must be using index template"),n=n.fillUriTemplate(a.indexTemplate,e.representation.id,null,e.bandwidth||null,null),i=i.resolveUris(e.representation.baseUris,[n]),shaka.dash.SegmentBase.generateSegmentIndexFromUris(e,t,r,i,0,null,a.scaledPresentationTimeOffset)},shaka.dash.SegmentTemplate.generateSegmentIndexFromDuration_=function(e,t,r,a,n){goog.asserts.assert(t.mediaTemplate,"There should be a media template with duration");var i=shaka.dash.MpdUtils,o=shaka.util.ManifestParserUtils,s=e.presentationTimeline,l=e.periodInfo.start,u=e.period.id,c=e.periodInfo.duration,d=function(){var e=null!=u&&n[u]||c;return e?l+e:1/0},p=t.segmentDuration;goog.asserts.assert(null!=p,"Segment duration must not be null!");var h=t.startNumber,f=t.timescale,g=t.mediaTemplate,y=e.bandwidth||null,m=e.representation.id,v=e.representation.baseUris,_=l-t.scaledPresentationTimeOffset,k=function(){var e=[Math.max(s.getSegmentAvailabilityStart(),l),Math.min(s.getSegmentAvailabilityEnd(),d())];return goog.asserts.assert(e.every(isFinite),"Available presentation times must be finite!"),goog.asserts.assert(e.every((function(e){return 0<=e})),"Available presentation times must be positive!"),goog.asserts.assert(null!=p,"Segment duration must not be null!"),e=e.map((function(e){return e-l})),[Math.ceil(e[0]/p),Math.ceil(e[1]/p)-1].map((function(e){return e+h}))},E=k();e=e.dynamic?Math.max(E[0],E[1]-r+1):E[0],E=E[1],r=[];for(var T=function(e){goog.asserts.assert(null!=p,"Segment duration must not be null!");var r=(e-h)*p,n=r+t.scaledPresentationTimeOffset,s=r+l;r=s+p;var u=Math.min(r,d());return goog.asserts.assert(s<u,"Generated a segment outside of the period!"),(s=new shaka.media.SegmentReference(s,u,(function(){var t=i.fillUriTemplate(g,m,e,y,n*f);return o.resolveUris(v,[t])}),0,null,a,_,l,d())).trueEndTime=r,s},b=e;b<=E;++b){var S=T(b);r.push(S)}var A=new shaka.media.SegmentIndex(r);if(r=s.getSegmentAvailabilityEnd()<d(),b=s.isLive(),r||b){var C=Math.max(e,E+1);A.updateEvery(p,(function(){var e=s.getSegmentAvailabilityStart();A.evict(e);var t=$jscomp.makeIterator(k());t.next(),t=t.next().value;for(var r=[];C<=t;){var a=T(C);r.push(a),C++}return e>d()&&!r.length?null:r}))}return Promise.resolve(A)},shaka.dash.SegmentTemplate.createFromTimeline_=function(e,t,r){var a=shaka.dash.MpdUtils,n=shaka.util.ManifestParserUtils,i=e.periodInfo.start,o=e.periodInfo.duration,s=i-t.scaledPresentationTimeOffset;o=o?i+o:1/0;for(var l=[],u={},c=0;c<t.timeline.length;u={$jscomp$loop$prop$mediaTemplate$664:u.$jscomp$loop$prop$mediaTemplate$664,$jscomp$loop$prop$repId$665:u.$jscomp$loop$prop$repId$665,$jscomp$loop$prop$segmentReplacement$666:u.$jscomp$loop$prop$segmentReplacement$666,$jscomp$loop$prop$bandwidth$667:u.$jscomp$loop$prop$bandwidth$667,$jscomp$loop$prop$timeReplacement$668:u.$jscomp$loop$prop$timeReplacement$668,$jscomp$loop$prop$baseUris$669:u.$jscomp$loop$prop$baseUris$669},c++){var d=t.timeline[c],p=d.start,h=d.unscaledStart;d=d.end,u.$jscomp$loop$prop$segmentReplacement$666=c+t.startNumber,u.$jscomp$loop$prop$timeReplacement$668=h+t.unscaledPresentationTimeOffset,u.$jscomp$loop$prop$repId$665=e.representation.id,u.$jscomp$loop$prop$bandwidth$667=e.bandwidth||null,u.$jscomp$loop$prop$mediaTemplate$664=t.mediaTemplate,u.$jscomp$loop$prop$baseUris$669=e.representation.baseUris,h=function(e){return function(){goog.asserts.assert(e.$jscomp$loop$prop$mediaTemplate$664,"There should be a media template with a timeline");var t=a.fillUriTemplate(e.$jscomp$loop$prop$mediaTemplate$664,e.$jscomp$loop$prop$repId$665,e.$jscomp$loop$prop$segmentReplacement$666,e.$jscomp$loop$prop$bandwidth$667||null,e.$jscomp$loop$prop$timeReplacement$668);return n.resolveUris(e.$jscomp$loop$prop$baseUris$669,[t]).map((function(e){return e.toString()}))}}(u),l.push(new shaka.media.SegmentReference(i+p,i+d,h,0,null,r,s,i,o))}return l},shaka.dash.SegmentTemplate.createInitSegment_=function(e){var t=shaka.dash.MpdUtils,r=shaka.util.ManifestParserUtils,a=t.inheritAttribute(e,shaka.dash.SegmentTemplate.fromInheritance_,"initialization");if(!a)return null;var n=e.representation.id,i=e.bandwidth||null,o=e.representation.baseUris;return e=shaka.dash.SegmentBase.createQualityInfo(e),new shaka.media.InitSegmentReference((function(){goog.asserts.assert(a,"Should have returned earler");var e=t.fillUriTemplate(a,n,null,i,null);return r.resolveUris(o,[e])}),0,null,e)},shaka.util.PeriodCombiner=function(){this.variants_=[],this.audioStreams_=[],this.videoStreams_=[],this.textStreams_=[],this.imageStreams_=[],this.usedPeriodIds_=new Set},shaka.util.PeriodCombiner.prototype.release=function(){for(var e=this.audioStreams_.concat(this.videoStreams_,this.textStreams_,this.imageStreams_),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();this.audioStreams_=[],this.videoStreams_=[],this.textStreams_=[],this.imageStreams_=[],this.variants_=[]},shaka.util.PeriodCombiner.prototype.getVariants=function(){return this.variants_},shaka.util.PeriodCombiner.prototype.getTextStreams=function(){return this.textStreams_.slice()},shaka.util.PeriodCombiner.prototype.getImageStreams=function(){return this.imageStreams_},shaka.util.PeriodCombiner.prototype.combinePeriods=function(e,t){var r,a,n,i,o,s,l,u,c,d,p,h,f,g,y,m,v,_,k,E,T,b,S,A,C,P,w,x,I=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(M){switch(M.nextAddress){case 1:if(r=shaka.util.ManifestParserUtils.ContentType,shaka.util.PeriodCombiner.filterOutAudioStreamDuplicates_(e),shaka.util.PeriodCombiner.filterOutVideoStreamDuplicates_(e),shaka.util.PeriodCombiner.filterOutTextStreamDuplicates_(e),shaka.util.PeriodCombiner.filterOutImageStreamDuplicates_(e),!t&&1==e.length){a=e[0],I.audioStreams_=a.audioStreams,I.videoStreams_=a.videoStreams,I.textStreams_=a.textStreams,I.imageStreams_=a.imageStreams,M.jumpTo(2);break}for(n=-1,i=0;i<e.length;i++)o=e[i],I.usedPeriodIds_.has(o.id)||(I.usedPeriodIds_.add(o.id),-1==n&&(n=i));if(-1==n)return M.return();for(s=e.map((function(e){return e.audioStreams})),l=e.map((function(e){return e.videoStreams})),u=e.map((function(e){return e.textStreams})),c=e.map((function(e){return e.imageStreams})),d=$jscomp.makeIterator(u),p=d.next();!p.done;p=d.next())p.value.push(shaka.util.PeriodCombiner.dummyStream_(r.TEXT));for(h=$jscomp.makeIterator(c),f=h.next();!f.done;f=h.next())f.value.push(shaka.util.PeriodCombiner.dummyStream_(r.IMAGE));return M.yield(shaka.util.PeriodCombiner.combine_(I.audioStreams_,s,n,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_),3);case 3:return M.yield(shaka.util.PeriodCombiner.combine_(I.videoStreams_,l,n,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_),4);case 4:return M.yield(shaka.util.PeriodCombiner.combine_(I.textStreams_,u,n,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_),5);case 5:return M.yield(shaka.util.PeriodCombiner.combine_(I.imageStreams_,c,n,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_),2);case 2:if(g=0,y=[],I.videoStreams_.length&&I.audioStreams_.length)for(T=$jscomp.makeIterator(I.audioStreams_),b=T.next();!b.done;b=T.next())for(S=b.value,A=$jscomp.makeIterator(I.videoStreams_),C=A.next();!C.done;C=A.next())P=C.value,w=shaka.media.DrmEngine.getCommonDrmInfos(S.drmInfos,P.drmInfos),S.drmInfos.length&&P.drmInfos.length&&!w.length?shaka.log.warning("Incompatible DRM in audio & video, skipping variant creation.",S,P):(x=g++,y.push({id:x,language:S.language,primary:S.primary,audio:S,video:P,bandwidth:(S.bandwidth||0)+(P.bandwidth||0),drmInfos:w,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(m=I.videoStreams_.concat(I.audioStreams_),v=$jscomp.makeIterator(m),_=v.next();!_.done;_=v.next())k=_.value,E=g++,y.push({id:E,language:k.language,primary:k.primary,audio:k.type==r.AUDIO?k:null,video:k.type==r.VIDEO?k:null,bandwidth:k.bandwidth||0,drmInfos:k.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});I.variants_=y,M.jumpToEnd()}}))},shaka.util.PeriodCombiner.filterOutAudioStreamDuplicates_=function(e){for(var t=shaka.util.ArrayUtils,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){r=r.value;for(var a=[],n=$jscomp.makeIterator(r.audioStreams),i=n.next();!i.done;i=n.next()){i=i.value;for(var o=!1,s=$jscomp.makeIterator(a),l=s.next();!l.done;l=s.next())l=l.value,i.id!=l.id&&i.channelsCount==l.channelsCount&&i.language==l.language&&i.bandwidth==l.bandwidth&&i.label==l.label&&i.codecs==l.codecs&&i.mimeType==l.mimeType&&t.hasSameElements(i.roles,l.roles)&&i.audioSamplingRate==l.audioSamplingRate&&i.primary==l.primary&&(o=!0);o||a.push(i)}r.audioStreams=a}},shaka.util.PeriodCombiner.filterOutTextStreamDuplicates_=function(e){for(var t=shaka.util.ArrayUtils,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){r=r.value;for(var a=[],n=$jscomp.makeIterator(r.textStreams),i=n.next();!i.done;i=n.next()){i=i.value;for(var o=!1,s=$jscomp.makeIterator(a),l=s.next();!l.done;l=s.next())l=l.value,i.id!=l.id&&i.language==l.language&&i.label==l.label&&i.codecs==l.codecs&&i.mimeType==l.mimeType&&i.bandwidth==l.bandwidth&&t.hasSameElements(i.roles,l.roles)&&(o=!0);o||a.push(i)}r.textStreams=a}},shaka.util.PeriodCombiner.filterOutVideoStreamDuplicates_=function(e){for(var t=shaka.util.ArrayUtils,r=shaka.util.MapUtils,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){a=a.value;for(var n=[],i=$jscomp.makeIterator(a.videoStreams),o=i.next();!o.done;o=i.next()){o=o.value;for(var s=!1,l=$jscomp.makeIterator(n),u=l.next();!u.done;u=l.next())u=u.value,o.id!=u.id&&o.width==u.width&&o.frameRate==u.frameRate&&o.codecs==u.codecs&&o.mimeType==u.mimeType&&o.label==u.label&&t.hasSameElements(o.roles,u.roles)&&r.hasSameElements(o.closedCaptions,u.closedCaptions)&&o.bandwidth==u.bandwidth&&(s=!0);s||n.push(o)}a.videoStreams=n}},shaka.util.PeriodCombiner.filterOutImageStreamDuplicates_=function(e){for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){t=t.value;for(var r=[],a=$jscomp.makeIterator(t.imageStreams),n=a.next();!n.done;n=a.next()){n=n.value;for(var i=!1,o=$jscomp.makeIterator(r),s=o.next();!s.done;s=o.next())s=s.value,n.id!=s.id&&n.width==s.width&&n.codecs==s.codecs&&n.mimeType==s.mimeType&&(i=!0);i||r.push(n)}t.imageStreams=r}},shaka.util.PeriodCombiner.combineDbStreams=function(e){var t,r,a,n,i,o,s,l,u,c,d,p,h,f,g,y,m,v,_,k,E,T,b,S;return $jscomp.asyncExecutePromiseGeneratorProgram((function(A){switch(A.nextAddress){case 1:if(t=shaka.util.ManifestParserUtils.ContentType,1==e.length)return A.return(e[0]);for(r=e.map((function(e){return e.filter((function(e){return e.type==t.AUDIO}))})),a=e.map((function(e){return e.filter((function(e){return e.type==t.VIDEO}))})),n=e.map((function(e){return e.filter((function(e){return e.type==t.TEXT}))})),i=e.map((function(e){return e.filter((function(e){return e.type==t.IMAGE}))})),o=$jscomp.makeIterator(n),s=o.next();!s.done;s=o.next())s.value.push(shaka.util.PeriodCombiner.dummyStreamDB_(t.TEXT));for(l=$jscomp.makeIterator(i),u=l.next();!u.done;u=l.next())u.value.push(shaka.util.PeriodCombiner.dummyStreamDB_(t.IMAGE));return A.yield(shaka.util.PeriodCombiner.combine_([],r,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_),2);case 2:return c=A.yieldResult,A.yield(shaka.util.PeriodCombiner.combine_([],a,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_),3);case 3:return d=A.yieldResult,A.yield(shaka.util.PeriodCombiner.combine_([],n,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_),4);case 4:return p=A.yieldResult,A.yield(shaka.util.PeriodCombiner.combine_([],i,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_),5);case 5:if(h=A.yieldResult,f=0,d.length&&c.length)for(v=$jscomp.makeIterator(c),_=v.next();!_.done;_=v.next())for(k=_.value,E=$jscomp.makeIterator(d),T=E.next();!T.done;T=E.next())b=T.value,S=f++,b.variantIds.push(S),k.variantIds.push(S);else for(g=d.concat(c),y=$jscomp.makeIterator(g),m=y.next();!m.done;m=y.next())m.value.variantIds=[f++];return A.return(d.concat(c).concat(p).concat(h))}}))},shaka.util.PeriodCombiner.combine_=function(e,t,r,a,n){var i,o,s,l,u,c,d,p,h,f,g,y,m,v,_,k,E,T,b;return $jscomp.asyncExecutePromiseGeneratorProgram((function(S){switch(S.nextAddress){case 1:for(i=shaka.util.ManifestParserUtils.ContentType,o=[],s=0;s<t.length;s++)s>=r?o.push(new Set(t[s])):o.push(new Set);l=$jscomp.makeIterator(e),u=l.next();case 2:if(u.done){S.jumpTo(4);break}return c=u.value,S.yield(shaka.util.PeriodCombiner.extendExistingOutputStream_(c,t,r,n,o),5);case 5:if(!S.yieldResult)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.PERIOD_FLATTENING_FAILED);u=l.next(),S.jumpTo(2);break;case 4:for(d=$jscomp.makeIterator(o),p=d.next();!p.done;p=d.next())for(h=p.value,f=$jscomp.makeIterator(h),g=f.next();!g.done;g=f.next())y=g.value,(m=shaka.util.PeriodCombiner.createNewOutputStream_(y,t,a,n,o))&&e.push(m);for(v=$jscomp.makeIterator(o),p=v.next();!p.done;p=v.next())for(_=p.value,k={},E=$jscomp.makeIterator(_),g=E.next();!g.done;k={$jscomp$loop$prop$stream$540$671:k.$jscomp$loop$prop$stream$540$671},g=E.next())if(k.$jscomp$loop$prop$stream$540$671=g.value,T=k.$jscomp$loop$prop$stream$540$671.type==i.TEXT&&!k.$jscomp$loop$prop$stream$540$671.language,b=k.$jscomp$loop$prop$stream$540$671.type==i.IMAGE&&!k.$jscomp$loop$prop$stream$540$671.tilesLayout,!T&&!b&&e.some(function(e){return function(t){return t.mimeType==e.$jscomp$loop$prop$stream$540$671.mimeType&&shaka.util.MimeUtils.getNormalizedCodec(t.codecs)==shaka.util.MimeUtils.getNormalizedCodec(e.$jscomp$loop$prop$stream$540$671.codecs)}}(k)))throw shaka.log.error("Unused stream in period-flattening!",k.$jscomp$loop$prop$stream$540$671,e),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.PERIOD_FLATTENING_FAILED);return S.return(e)}}))},shaka.util.PeriodCombiner.extendExistingOutputStream_=function(e,t,r,a,n){return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(shaka.util.PeriodCombiner.findMatchesInAllPeriods_(t,e),goog.asserts.assert(e.createSegmentIndex,"outputStream should be a Stream type!"),e.matchedStreams?e.segmentIndex?i.yield(shaka.util.PeriodCombiner.extendOutputSegmentIndex_(e,r),2):i.jumpTo(2):(shaka.log.error("No matches extending output stream!",e,t),i.return(!1))):(shaka.util.PeriodCombiner.extendOutputStream_(e,r,a,n),i.return(!0))}))},shaka.util.PeriodCombiner.extendOutputSegmentIndex_=function(e,t){var r,a,n,i,o,s,l;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress){for(r=[],a=e.matchedStreams,goog.asserts.assert(a,"matched streams should be valid"),n=$jscomp.makeIterator(a),i=n.next();!i.done;i=n.next())o=i.value,r.push(o.createSegmentIndex()),o.trickModeVideo&&!o.trickModeVideo.segmentIndex&&r.push(o.trickModeVideo.createSegmentIndex());return u.yield(Promise.all(r),2)}if(e.segmentIndex instanceof shaka.media.MetaSegmentIndex)for(s=0;s<a.length;s++)(l=a[s]).segmentIndex&&s>=t&&(goog.asserts.assert(l.segmentIndex,"stream should have a segmentIndex."),e.segmentIndex.appendSegmentIndex(l.segmentIndex));u.jumpToEnd()}))},shaka.util.PeriodCombiner.createNewOutputStream_=function(e,t,r,a,n){var i=r(e);return shaka.util.PeriodCombiner.findMatchesInAllPeriods_(t,i),i.createSegmentIndex&&(i.createSegmentIndex=function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return i.segmentIndex?e.jumpTo(0):(i.segmentIndex=new shaka.media.MetaSegmentIndex,e.yield(shaka.util.PeriodCombiner.extendOutputSegmentIndex_(i,0),0))}))}),i.matchedStreams?(shaka.util.PeriodCombiner.extendOutputStream_(i,0,a,n),i):null},shaka.util.PeriodCombiner.extendOutputStream_=function(e,t,r,a){var n=shaka.util.ManifestParserUtils.ContentType,i=shaka.util.LanguageUtils,o=e.matchedStreams;goog.asserts.assert(e.matchedStreams,"matchedStreams should be non-null");for(var s=0;s<o.length;s++)if(s>=t){var l=o[s];r(e,l);var u=!0;e.type==n.AUDIO&&0==i.relatedness(e.language,l.language)&&(u=!1),u&&a[s].delete(l)}},shaka.util.PeriodCombiner.cloneStream_=function(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var e=$jscomp.makeIterator(t.matchedStreams),r=e.next();!r.done;r=e.next())(r=r.value).segmentIndex&&(r.segmentIndex.release(),r.segmentIndex=null)},t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set,t.closedCaptions=null,t.trickModeVideo=null,t},shaka.util.PeriodCombiner.cloneStreamDB_=function(e){return(e=Object.assign({},e)).keyIds=new Set,e.segments=[],e.variantIds=[],e.closedCaptions=null,e},shaka.util.PeriodCombiner.concatenateStreams_=function(e,t){var r,a;e.roles=Array.from(new Set(e.roles.concat(t.roles))),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=Array.from(new Set(e.emsgSchemeIdUris.concat(t.emsgSchemeIdUris)))),e.keyIds=(r=e.keyIds,a=t.keyIds,new Set([].concat($jscomp.arrayFromIterable(r),$jscomp.arrayFromIterable(a)))),e.originalId=null==e.originalId?t.originalId:e.originalId+","+(t.originalId||"");var n=shaka.media.DrmEngine.getCommonDrmInfos(e.drmInfos,t.drmInfos);if(t.drmInfos.length&&e.drmInfos.length&&!n.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.INCONSISTENT_DRM_ACROSS_PERIODS);if(e.drmInfos=n,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions){e.closedCaptions||(e.closedCaptions=new Map);for(var i=(n=$jscomp.makeIterator(t.closedCaptions)).next();!i.done;i=n.next()){var o=$jscomp.makeIterator(i.value);i=o.next().value,o=o.next().value,e.closedCaptions.set(i,o)}}t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=shaka.util.PeriodCombiner.cloneStream_(t.trickModeVideo),e.trickModeVideo.createSegmentIndex=function(){return goog.asserts.assert(e.segmentIndex instanceof shaka.media.MetaSegmentIndex,"The stream should have a MetaSegmentIndex."),e.trickModeVideo.segmentIndex=e.segmentIndex.clone(),Promise.resolve()}),shaka.util.PeriodCombiner.concatenateStreams_(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&shaka.util.PeriodCombiner.concatenateStreams_(e.trickModeVideo,t)},shaka.util.PeriodCombiner.concatenateStreamDBs_=function(e,t){e.roles=Array.from(new Set(e.roles.concat(t.roles)));var r=t.keyIds;if(r=new Set([].concat($jscomp.arrayFromIterable(e.keyIds),$jscomp.arrayFromIterable(r))),e.keyIds=r,e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,$jscomp.arrayFromIterable(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),r=(t=$jscomp.makeIterator(t.closedCaptions)).next();!r.done;r=t.next()){var a=$jscomp.makeIterator(r.value);r=a.next().value,a=a.next().value,e.closedCaptions.set(r,a)}},shaka.util.PeriodCombiner.findMatchesInAllPeriods_=function(e,t){for(var r=[],a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){if(!(a=shaka.util.PeriodCombiner.findBestMatchInPeriod_(a.value,t)))return;r.push(a)}t.matchedStreams=r},shaka.util.PeriodCombiner.findBestMatchInPeriod_=function(e,t){for(var r={audio:shaka.util.PeriodCombiner.areAVStreamsCompatible_,video:shaka.util.PeriodCombiner.areAVStreamsCompatible_,text:shaka.util.PeriodCombiner.areTextStreamsCompatible_,image:shaka.util.PeriodCombiner.areImageStreamsCompatible_}[t.type],a={audio:shaka.util.PeriodCombiner.isAudioStreamBetterMatch_,video:shaka.util.PeriodCombiner.isVideoStreamBetterMatch_,text:shaka.util.PeriodCombiner.isTextStreamBetterMatch_,image:shaka.util.PeriodCombiner.isImageStreamBetterMatch_}[t.type],n=null,i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next())!r(t,i=i.value)||n&&!a(t,n,i)||(n=i);return n},shaka.util.PeriodCombiner.areAVStreamsCompatible_=function(e,t){return!(t.mimeType!=e.mimeType||shaka.util.MimeUtils.getNormalizedCodec(t.codecs)!=shaka.util.MimeUtils.getNormalizedCodec(e.codecs)||e.drmInfos&&!shaka.media.DrmEngine.areDrmCompatible(e.drmInfos,t.drmInfos))},shaka.util.PeriodCombiner.areTextStreamsCompatible_=function(e,t){return!!e.language&&(!t.language||0!=shaka.util.LanguageUtils.relatedness(e.language,t.language)&&t.kind==e.kind)},shaka.util.PeriodCombiner.areImageStreamsCompatible_=function(e,t){return!!e.tilesLayout},shaka.util.PeriodCombiner.isAudioStreamBetterMatch_=function(e,t,r){var a=shaka.util.LanguageUtils,n=shaka.util.PeriodCombiner.BetterOrWorse,i=n.BETTER;if(n=n.WORSE,e.id==r.id)return!0;var o=a.relatedness(e.language,t.language);return(a=a.relatedness(e.language,r.language))>o||!(a<o)&&(e.roles.length?(i=t.roles.filter((function(t){return e.roles.includes(t)})),(n=r.roles.filter((function(t){return e.roles.includes(t)}))).length>i.length||!(n.length<i.length)&&r.roles.length<t.roles.length):!(r.roles.length||!t.roles.length)||!(r.roles.length&&!t.roles.length)&&(!(t.primary||!r.primary)||!(t.primary&&!r.primary)&&((a=shaka.util.PeriodCombiner.compareClosestPreferLower(e.channelsCount,t.channelsCount,r.channelsCount))==i||a!=n&&((a=shaka.util.PeriodCombiner.compareClosestPreferLower(e.audioSamplingRate,t.audioSamplingRate,r.audioSamplingRate))==i||a!=n&&!(!e.bandwidth||shaka.util.PeriodCombiner.compareClosestPreferMinimalAbsDiff_(e.bandwidth,t.bandwidth,r.bandwidth)!=i)))))},shaka.util.PeriodCombiner.isVideoStreamBetterMatch_=function(e,t,r){var a=shaka.util.PeriodCombiner.BetterOrWorse,n=a.BETTER;if(a=a.WORSE,e.id==r.id)return!0;var i=shaka.util.PeriodCombiner.compareClosestPreferLower(e.width*e.height,t.width*t.height,r.width*r.height);if(i==n)return!0;if(i==a)return!1;if(e.frameRate){if((i=shaka.util.PeriodCombiner.compareClosestPreferLower(e.frameRate,t.frameRate,r.frameRate))==n)return!0;if(i==a)return!1}return!(!e.bandwidth||shaka.util.PeriodCombiner.compareClosestPreferMinimalAbsDiff_(e.bandwidth,t.bandwidth,r.bandwidth)!=n)},shaka.util.PeriodCombiner.isTextStreamBetterMatch_=function(e,t,r){var a=shaka.util.LanguageUtils;if(e.id==r.id)return!0;var n=a.relatedness(e.language,t.language);if((a=a.relatedness(e.language,r.language))>n)return!0;if(a<n)return!1;if(!t.primary&&r.primary)return!0;if(t.primary&&!r.primary)return!1;if(e.roles.length){if(n=t.roles.filter((function(t){return e.roles.includes(t)})),(a=r.roles.filter((function(t){return e.roles.includes(t)}))).length>n.length)return!0;if(a.length<n.length)return!1}else{if(!r.roles.length&&t.roles.length)return!0;if(r.roles.length&&!t.roles.length)return!1}return r.mimeType==e.mimeType&&r.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)},shaka.util.PeriodCombiner.isImageStreamBetterMatch_=function(e,t,r){var a=shaka.util.PeriodCombiner.BetterOrWorse.BETTER;return e.id==r.id||shaka.util.PeriodCombiner.compareClosestPreferLower(e.width*e.height,t.width*t.height,r.width*r.height)==a},shaka.util.PeriodCombiner.dummyStreamDB_=function(e){return{id:0,originalId:"",primary:!1,type:e,mimeType:"",codecs:"",language:"",label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}},shaka.util.PeriodCombiner.dummyStream_=function(e){return{id:0,originalId:"",createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new shaka.media.SegmentIndex([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",label:null,type:e,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}},shaka.util.PeriodCombiner.compareClosestPreferLower=function(e,t,r){var a=shaka.util.PeriodCombiner.BetterOrWorse,n=a.BETTER,i=a.WORSE;if(t==e&&e!=r)return i;if(r==e&&e!=t)return n;if(t>e){if(r<=e||r-e<t-e)return n;if(r-e>t-e)return i}else{if(r>e)return i;if(e-r<e-t)return n;if(e-r>e-t)return i}return a.EQUAL},shaka.util.PeriodCombiner.compareClosestPreferMinimalAbsDiff_=function(e,t,r){var a=shaka.util.PeriodCombiner.BetterOrWorse,n=a.BETTER,i=a.WORSE;return t=Math.abs(e-t),(e=Math.abs(e-r))<t?n:t<e?i:a.EQUAL},shaka.util.PeriodCombiner.BetterOrWorse={BETTER:1,EQUAL:0,WORSE:-1},shaka.dash.DashParser=function(){var e=this;this.playerInterface_=this.config_=null,this.manifestUris_=[],this.manifest_=null,this.globalId_=1,this.streamMap_={},this.periodDurations_={},this.periodCombiner_=new shaka.util.PeriodCombiner,this.updatePeriod_=0,this.averageUpdateDuration_=new shaka.abr.Ewma(5),this.updateTimer_=new shaka.util.Timer((function(){e.onUpdate_()})),this.operationManager_=new shaka.util.OperationManager,this.largestPeriodStartTime_=null,this.lastManifestUpdatePeriodIds_=[],this.minTotalAvailabilityTimeOffset_=1/0,this.lowLatencyMode_=!1},shaka.dash.DashParser.prototype.configure=function(e){goog.asserts.assert(null!=e.dash,"DashManifestConfiguration should not be null!"),this.config_=e},shaka.dash.DashParser.prototype.start=function(e,t){var r,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return goog.asserts.assert(a.config_,"Must call configure() before start()!"),a.lowLatencyMode_=t.isLowLatencyMode(),a.manifestUris_=[e],a.playerInterface_=t,n.yield(a.requestManifest_(),2);if(r=n.yieldResult,a.playerInterface_&&a.setUpdateTimer_(r),!a.playerInterface_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);return goog.asserts.assert(a.manifest_,"Manifest should be non-null!"),n.return(a.manifest_)}))},shaka.dash.DashParser.prototype.stop=function(){for(var e=$jscomp.makeIterator(Object.values(this.streamMap_)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();return this.periodCombiner_&&this.periodCombiner_.release(),this.config_=this.playerInterface_=null,this.manifestUris_=[],this.manifest_=null,this.streamMap_={},this.periodCombiner_=null,null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null),this.operationManager_.destroy()},shaka.dash.DashParser.prototype.update=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(r.setCatchFinallyBlocks(2),r.yield(t.requestManifest_(),4)):2!=r.nextAddress?r.leaveTryBlock(0):(e=r.enterCatchBlock(),t.playerInterface_&&e?(goog.asserts.assert(e instanceof shaka.util.Error,"Bad error type"),t.playerInterface_.onError(e),void r.jumpToEnd()):r.return())}))},shaka.dash.DashParser.prototype.onExpirationUpdated=function(e,t){},shaka.dash.DashParser.prototype.requestManifest_=function(){var e,t,r,a,n,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){return 1==c.nextAddress?(e=shaka.net.NetworkingEngine.RequestType.MANIFEST,t=shaka.net.NetworkingEngine.makeRequest(u.manifestUris_,u.config_.retryParameters),r=u.playerInterface_.networkingEngine,a=shaka.util.CmcdManager.StreamingFormat.DASH,u.playerInterface_.modifyManifestRequest(t,{format:a}),n=Date.now(),i=r.request(e,t),u.operationManager_.manage(i),c.yield(i.promise,2)):3!=c.nextAddress?(o=c.yieldResult,u.playerInterface_?(o.uri&&!u.manifestUris_.includes(o.uri)&&u.manifestUris_.unshift(o.uri),c.yield(u.parseManifest_(o.data,o.uri),3)):c.return(0)):(s=Date.now(),l=(s-n)/1e3,u.averageUpdateDuration_.sample(1,l),c.return(l))}))},shaka.dash.DashParser.prototype.parseManifest_=function(e,t){var r,a,n,i,o,s,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress){if(r=shaka.util.Error,a=shaka.dash.MpdUtils,!(n=shaka.util.XmlUtils.parseXml(e,"MPD")))throw new r(r.Severity.CRITICAL,r.Category.MANIFEST,r.Code.DASH_INVALID_XML,t);return l.config_.dash.disableXlinkProcessing?u.return(l.processManifest_(n,t)):(i=l.config_.dash.xlinkFailGracefully,o=a.processXlinks(n,l.config_.retryParameters,i,t,l.playerInterface_.networkingEngine),l.operationManager_.manage(o),u.yield(o.promise,2))}return s=u.yieldResult,u.return(l.processManifest_(s,t))}))},shaka.dash.DashParser.prototype.processManifest_=function(e,t){var r,a,n,i,o,s,l,u,c,d,p,h,f,g,y,m,v,_,k,E,T,b,S,A,C,P,w,x,I,M,D,R,O,L=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(N){switch(N.nextAddress){case 1:if(r=shaka.util.Functional,a=shaka.util.XmlUtils,(n=L.config_.dash.manifestPreprocessor)&&n(e),i=[t],0<(o=a.findChildren(e,"Location").map(a.getContents).filter(r.isNotNull)).length&&(s=shaka.util.ManifestParserUtils.resolveUris(i,o),i=L.manifestUris_=s),l=a.findChildren(e,"BaseURL"),u=l.map(a.getContents),c=shaka.util.ManifestParserUtils.resolveUris(i,u),d=0,l&&l.length&&(d=a.parseAttr(l[0],"availabilityTimeOffset",a.parseFloat)||0),p=L.config_.dash.ignoreMinBufferTime,h=0,p||(h=a.parseAttr(e,"minBufferTime",a.parseDuration)||0),L.updatePeriod_=a.parseAttr(e,"minimumUpdatePeriod",a.parseDuration,-1),f=a.parseAttr(e,"availabilityStartTime",a.parseDate),g=a.parseAttr(e,"timeShiftBufferDepth",a.parseDuration),y=L.config_.dash.ignoreSuggestedPresentationDelay,m=null,y||(m=a.parseAttr(e,"suggestedPresentationDelay",a.parseDuration)),v=L.config_.dash.ignoreMaxSegmentDuration,_=null,v||(_=a.parseAttr(e,"maxSegmentDuration",a.parseDuration)),k=e.getAttribute("type")||"static",L.manifest_)for(E=L.manifest_.presentationTimeline,T=$jscomp.makeIterator(Object.values(L.streamMap_)),b=T.next();!b.done;b=T.next())(S=b.value).segmentIndex&&S.segmentIndex.evict(E.getSegmentAvailabilityStart());else A=L.config_.defaultPresentationDelay||1.5*h,C=null!=m?m:A,E=new shaka.media.PresentationTimeline(f,C,L.config_.dash.autoCorrectDrift);return E.setStatic("static"==k),E.isLive()&&!isNaN(L.config_.availabilityWindowOverride)&&(g=L.config_.availabilityWindowOverride),null==g&&(g=1/0),E.setSegmentAvailabilityDuration(g),P=e.getAttribute("profiles")||"",w={dynamic:"static"!=k,presentationTimeline:E,period:null,periodInfo:null,adaptationSet:null,representation:null,bandwidth:0,indexRangeWarningGiven:!1,availabilityTimeOffset:d,profiles:P.split(",")},x=L.parsePeriods_(w,c,e),I=x.duration,M=x.periods,"static"!=k&&x.durationDerivedFromPeriods||E.setDuration(I||1/0),L.minTotalAvailabilityTimeOffset_&&!L.lowLatencyMode_&&L.playerInterface_.isAutoLowLatencyMode()&&(L.playerInterface_.enableLowLatencyMode(),L.lowLatencyMode_=L.playerInterface_.isLowLatencyMode()),L.lowLatencyMode_?E.setAvailabilityTimeOffset(L.minTotalAvailabilityTimeOffset_):L.minTotalAvailabilityTimeOffset_&&shaka.log.alwaysWarn("Low-latency DASH live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),E.notifyMaxSegmentDuration(_||1),goog.DEBUG&&E.assertIsValid(),N.yield(L.periodCombiner_.combinePeriods(M,w.dynamic),2);case 2:if(L.manifest_){L.manifest_.variants=L.periodCombiner_.getVariants(),L.manifest_.textStreams=L.periodCombiner_.getTextStreams(),L.manifest_.imageStreams=L.periodCombiner_.getImageStreams(),L.playerInterface_.filter(L.manifest_),N.jumpTo(3);break}if(L.manifest_={presentationTimeline:E,variants:L.periodCombiner_.getVariants(),textStreams:L.periodCombiner_.getTextStreams(),imageStreams:L.periodCombiner_.getImageStreams(),offlineSessionIds:[],minBufferTime:h||0,sequenceMode:L.config_.dash.sequenceMode},!E.usingPresentationStartTime()){N.jumpTo(4);break}return D=shaka.util.XmlUtils,R=D.findChildren(e,"UTCTiming"),N.yield(L.parseUtcTiming_(c,R),5);case 5:if(O=N.yieldResult,!L.playerInterface_)return N.return();E.setClockOffset(O);case 4:E.lockStartTime();case 3:L.playerInterface_.makeTextStreamsForClosedCaptions(L.manifest_),N.jumpToEnd()}}))},shaka.dash.DashParser.prototype.parsePeriods_=function(e,t,r){var a=shaka.util.XmlUtils,n=a.parseAttr(r,"mediaPresentationDuration",a.parseDuration),i=[],o=0;r=a.findChildren(r,"Period");for(var s=0;s<r.length;s++){var l=r[s],u=r[s+1],c=a.parseAttr(l,"start",a.parseDuration,o),d=l.id,p=a.parseAttr(l,"duration",a.parseDuration),h=null;if(u){var f=a.parseAttr(u,"start",a.parseDuration);null!=f&&(h=f-c)}else null!=n&&(h=n-c);if(f=shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS,h&&p&&Math.abs(h-p)>f&&shaka.log.warning("There is a gap/overlap between Periods",l),null==h&&(h=p),null!==this.largestPeriodStartTime_&&null!==d&&null!==c&&c<this.largestPeriodStartTime_&&!this.lastManifestUpdatePeriodIds_.includes(d)&&s+1!=r.length)shaka.log.debug("Skipping Period with ID "+d+" as its start time is smaller than the largest period start time that has been seen, and ID is unseen before");else{if(null!==c&&(null===this.largestPeriodStartTime_||c>this.largestPeriodStartTime_)&&(this.largestPeriodStartTime_=c),o=this.parsePeriod_(e,t,{start:c,duration:h,node:l,isLastPeriod:null==h||!u}),i.push(o),e.period.id&&h&&(this.periodDurations_[e.period.id]=h),null==h){u&&shaka.log.warning("Skipping Period",s+1,"and any subsequent Periods:","Period",s+1,"does not have a valid start time.",u),o=null;break}o=c+h}}return this.lastManifestUpdatePeriodIds_=i.map((function(e){return e.id})),null!=n?(o!=n&&shaka.log.warning("@mediaPresentationDuration does not match the total duration of ","all Periods."),{periods:i,duration:n,durationDerivedFromPeriods:!1}):{periods:i,duration:o,durationDerivedFromPeriods:!0}},shaka.dash.DashParser.prototype.parsePeriod_=function(e,t,r){var a=this,n=shaka.util.Functional,i=shaka.util.XmlUtils,o=shaka.util.ManifestParserUtils.ContentType;e.period=this.createFrame_(r.node,null,t),e.periodInfo=r,e.period.availabilityTimeOffset=e.availabilityTimeOffset,e.period.id||(shaka.log.info("No Period ID given for Period with start time "+r.start+",  Assigning a default"),e.period.id="__shaka_period_"+r.start);var s=i.findChildren(r.node,"EventStream");t=e.presentationTimeline.getSegmentAvailabilityStart();for(var l=(s=$jscomp.makeIterator(s)).next();!l.done;l=s.next())this.parseEventStream_(r.start,r.duration,l.value,t);if(n=i.findChildren(r.node,"AdaptationSet").map((function(t){return a.parseAdaptationSet_(e,t)})).filter(n.isNotNull),e.dynamic){for(r=[],t=(i=$jscomp.makeIterator(n)).next();!t.done;t=i.next())for(s=(t=$jscomp.makeIterator(t.value.representationIds)).next();!s.done;s=t.next())r.push(s.value);if(i=new Set(r),r.length!=i.size)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_DUPLICATE_REPRESENTATION_ID)}for(r=n.filter((function(e){return!e.trickModeFor})),n=n.filter((function(e){return e.trickModeFor})),i=(n=$jscomp.makeIterator(n)).next();!i.done;i=n.next())for(t=(i=i.value).trickModeFor.split(" "),l=(s=$jscomp.makeIterator(r)).next();!l.done;l=s.next()){var u=l.value;if(t.includes(u.id)){l={};for(var c=(u=$jscomp.makeIterator(u.streams)).next();!c.done;l={$jscomp$loop$prop$stream$673:l.$jscomp$loop$prop$stream$673},c=u.next())l.$jscomp$loop$prop$stream$673=c.value,l.$jscomp$loop$prop$stream$673.trickModeVideo=i.streams.find(function(e){return function(t){return shaka.util.MimeUtils.getNormalizedCodec(e.$jscomp$loop$prop$stream$673.codecs)==shaka.util.MimeUtils.getNormalizedCodec(t.codecs)}}(l))}}if(i=this.config_.disableAudio?[]:this.getSetsOfType_(r,o.AUDIO),t=this.config_.disableVideo?[]:this.getSetsOfType_(r,o.VIDEO),n=this.config_.disableText?[]:this.getSetsOfType_(r,o.TEXT),r=this.config_.disableThumbnails?[]:this.getSetsOfType_(r,o.IMAGE),!t.length&&!i.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_EMPTY_PERIOD);for(o=[],s=(i=$jscomp.makeIterator(i)).next();!s.done;s=i.next())o.push.apply(o,$jscomp.arrayFromIterable(s.value.streams));for(i=[],s=(t=$jscomp.makeIterator(t)).next();!s.done;s=t.next())i.push.apply(i,$jscomp.arrayFromIterable(s.value.streams));for(t=[],s=(n=$jscomp.makeIterator(n)).next();!s.done;s=n.next())t.push.apply(t,$jscomp.arrayFromIterable(s.value.streams));for(n=[],s=(r=$jscomp.makeIterator(r)).next();!s.done;s=r.next())n.push.apply(n,$jscomp.arrayFromIterable(s.value.streams));return{id:e.period.id,audioStreams:o,videoStreams:i,textStreams:t,imageStreams:n}},shaka.dash.DashParser.prototype.getSetsOfType_=function(e,t){return e.filter((function(e){return e.contentType==t}))},shaka.dash.DashParser.prototype.parseAdaptationSet_=function(e,t){var r=this,a=shaka.util.XmlUtils,n=shaka.util.Functional,i=shaka.util.ManifestParserUtils,o=i.ContentType,s=shaka.dash.ContentProtection;e.adaptationSet=this.createFrame_(t,e.period,null);var l,u=!1,c=a.findChildren(t,"Role"),d=c.map((function(e){return e.getAttribute("value")})).filter(n.isNotNull),p=void 0;(n=e.adaptationSet.contentType==o.TEXT)&&(p=i.TextStreamKind.SUBTITLE);for(var h=(c=$jscomp.makeIterator(c)).next();!h.done;h=c.next()){var f=(h=h.value).getAttribute("schemeIdUri");if(null==f||"urn:mpeg:dash:role:2011"==f)switch(h=h.getAttribute("value"),h){case"main":u=!0;break;case"caption":case"subtitle":p=h}}f=function(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}};var g=a.findChildren(t,"EssentialProperty");c=null,h=!1;for(var y=(g=$jscomp.makeIterator(g)).next();!y.done;y=g.next()){var m=(y=y.value).getAttribute("schemeIdUri");"http://dashif.org/guidelines/trickmode"==m?c=y.getAttribute("value"):"urn:mpeg:mpegB:cicp:TransferCharacteristics"==m?l=f(parseInt(y.getAttribute("value"),10)):h=!0}for(g=a.findChildren(t,"SupplementalProperty"),y=(g=$jscomp.makeIterator(g)).next();!y.done;y=g.next())"urn:mpeg:mpegB:cicp:TransferCharacteristics"==(y=y.value).getAttribute("schemeIdUri")&&(l=f(parseInt(y.getAttribute("value"),10)));g=a.findChildren(t,"Accessibility"),f=shaka.util.LanguageUtils;var v=new Map;for(y=(g=$jscomp.makeIterator(g)).next();!y.done;y=g.next())if(y=(m=y.value).getAttribute("schemeIdUri"),m=m.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==y)if(y=1,null!=m){m=m.split(";");for(var _=$jscomp.makeIterator(m),k=_.next();!k.done;k=_.next()){var E=k.value,T=k=void 0;E.includes("=")?(k=(E=E.split("="))[0].startsWith("CC")?E[0]:"CC"+E[0],T=E[1]||"und"):(k="CC"+y,2==m.length?y+=2:y++,T=E),v.set(k,f.normalize(T))}}else v.set("CC1","und");else if("urn:scte:dash:cc:cea-708:2015"==y)if(y=1,null!=m)for(k=(m=$jscomp.makeIterator(m.split(";"))).next();!k.done;k=m.next())E=_=void 0,(k=k.value).includes("=")?(_="svc"+(k=k.split("="))[0],E=k[1].split(",")[0].split(":").pop()):(_="svc"+y,y++,E=k),v.set(_,f.normalize(E));else v.set("svc1","und");else"urn:mpeg:dash:role:2011"==y&&null!=m&&(d.push(m),"captions"==m&&(p=i.TextStreamKind.CLOSED_CAPTION));if(h)return null;i=a.findChildren(t,"ContentProtection");var b=s.parseFromAdaptationSet(i,this.config_.dash.ignoreDrmInfo,this.config_.dash.keySystemsByURI),S=shaka.util.LanguageUtils.normalize(t.getAttribute("lang")||"und"),A=t.getAttribute("label");if((s=a.findChildren(t,"Label"))&&s.length&&((s=s[0]).textContent&&(A=s.textContent)),0==(t=(a=a.findChildren(t,"Representation")).map((function(t){return(t=r.parseRepresentation_(e,b,p,S,A,u,d,v,t))&&(t.hdr=t.hdr||l),t})).filter((function(e){return!!e}))).length){if(c=e.adaptationSet.contentType==o.IMAGE,this.config_.dash.ignoreEmptyAdaptationSet||n||c)return null;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_EMPTY_ADAPTATION_SET)}if(!e.adaptationSet.contentType||e.adaptationSet.contentType==o.APPLICATION)for(e.adaptationSet.contentType=shaka.dash.DashParser.guessContentType_(t[0].mimeType,t[0].codecs),n=(o=$jscomp.makeIterator(t)).next();!n.done;n=o.next())n.value.type=e.adaptationSet.contentType;for(n=(o=$jscomp.makeIterator(t)).next();!n.done;n=o.next())for(n=n.value,i=(s=$jscomp.makeIterator(b.drmInfos)).next();!i.done;i=s.next())(i=i.value).keyIds=i.keyIds&&n.keyIds?new Set([].concat($jscomp.arrayFromIterable(i.keyIds),$jscomp.arrayFromIterable(n.keyIds))):i.keyIds||n.keyIds;return o=a.map((function(e){return e.getAttribute("id")})).filter(shaka.util.Functional.isNotNull),{id:e.adaptationSet.id||"__fake__"+this.globalId_++,contentType:e.adaptationSet.contentType,language:S,main:u,streams:t,drmInfos:b.drmInfos,trickModeFor:c,representationIds:o}},shaka.dash.DashParser.prototype.parseRepresentation_=function(e,t,r,a,n,i,o,s,l){var u=this,c=shaka.util.XmlUtils,d=shaka.util.ManifestParserUtils.ContentType;if(e.representation=this.createFrame_(l,e.adaptationSet,null),this.minTotalAvailabilityTimeOffset_=Math.min(this.minTotalAvailabilityTimeOffset_,e.representation.availabilityTimeOffset),!this.verifyRepresentation_(e.representation))return shaka.log.warning("Skipping Representation",e.representation),null;var p=e.periodInfo.start;e.bandwidth=c.parseAttr(l,"bandwidth",c.parsePositiveInt)||0;var h=e.representation.contentType,f=h==d.TEXT||h==d.APPLICATION;d=h==d.IMAGE;try{if(h=function(e,t,r){return u.requestInitSegment_(e,t,r)},e.representation.segmentBase)var g=shaka.dash.SegmentBase.createStreamInfo(e,h);else if(e.representation.segmentList)g=shaka.dash.SegmentList.createStreamInfo(e,this.streamMap_);else if(e.representation.segmentTemplate)g=shaka.dash.SegmentTemplate.createStreamInfo(e,h,this.streamMap_,!!this.manifest_,this.config_.dash.initialSegmentLimit,this.periodDurations_);else{goog.asserts.assert(f,"Must have Segment* with non-text streams.");var y=e.representation.baseUris,m=e.periodInfo.duration||0;g={generateSegmentIndex:function(){return Promise.resolve(shaka.media.SegmentIndex.forSingleSegment(p,m,y))}}}}catch(e){if((f||d)&&e.code==shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)return null;throw e}h=c.findChildren(l,"ContentProtection"),h=shaka.dash.ContentProtection.parseFromRepresentation(h,t,this.config_.dash.ignoreDrmInfo,this.config_.dash.keySystemsByURI),h=new Set(h?[h]:[]);var v=!1;c.findChildren(l,"SupplementalProperty").some((function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.getAttribute("schemeIdUri")&&"JOC"==e.getAttribute("value")}))&&(v=!0);var _,k,E=!1;if(f&&(E=o.includes("forced_subtitle")||o.includes("forced-subtitle")),d&&((l=c.findChildren(l,"EssentialProperty").find((function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.getAttribute("schemeIdUri"))})))&&(_=l.getAttribute("value")),!_))return null;l=e.representation.codecs,e.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(l.includes("hvc1.2.4.L153.B0")||l.includes("hev1.2.4.L153.B0"))&&(k="PQ");var T=e.representation.id?e.period.id+","+e.representation.id:"",b={id:this.globalId_++,originalId:e.representation.id,createSegmentIndex:function(){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return(t=T&&e.dynamic&&u.streamMap_[T]?u.streamMap_[T]:b).segmentIndex?a.jumpTo(0):(r=t,a.yield(g.generateSegmentIndex(),3));r.segmentIndex=a.yieldResult,a.jumpToEnd()}))},closeSegmentIndex:function(){b.segmentIndex&&(b.segmentIndex.release(),b.segmentIndex=null)},segmentIndex:null,mimeType:e.representation.mimeType,codecs:e.representation.codecs,frameRate:e.representation.frameRate,pixelAspectRatio:e.representation.pixelAspectRatio,bandwidth:e.bandwidth,width:e.representation.width,height:e.representation.height,kind:r,encrypted:0<t.drmInfos.length,drmInfos:t.drmInfos,keyIds:h,language:a,label:n,type:e.adaptationSet.contentType,primary:i,trickModeVideo:null,emsgSchemeIdUris:e.representation.emsgSchemeIdUris,roles:o,forced:E,channelsCount:e.representation.numChannels,audioSamplingRate:e.representation.audioSamplingRate,spatialAudio:v,closedCaptions:s,hdr:k,tilesLayout:_,matchedStreams:[]};return T&&e.dynamic&&!this.streamMap_[T]&&(this.streamMap_[T]=b),b},shaka.dash.DashParser.prototype.onUpdate_=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){switch(a.nextAddress){case 1:return goog.asserts.assert(0<=r.updatePeriod_,"There should be an update period"),shaka.log.info("Updating manifest..."),e=0,a.setCatchFinallyBlocks(2),a.yield(r.requestManifest_(),4);case 4:e=a.yieldResult,a.leaveTryBlock(3);break;case 2:t=a.enterCatchBlock(),goog.asserts.assert(t instanceof shaka.util.Error,"Should only receive a Shaka error"),r.playerInterface_&&(t.severity=shaka.util.Error.Severity.RECOVERABLE,r.playerInterface_.onError(t));case 3:if(!r.playerInterface_)return a.return();r.setUpdateTimer_(e),a.jumpToEnd()}}))},shaka.dash.DashParser.prototype.setUpdateTimer_=function(e){0>this.updatePeriod_||(e=Math.max(shaka.dash.DashParser.MIN_UPDATE_PERIOD_,this.updatePeriod_-e,this.averageUpdateDuration_.getEstimate()),this.updateTimer_.tickAfter(e))},shaka.dash.DashParser.prototype.createFrame_=function(e,t,r){goog.asserts.assert(t||r,"Must provide either parent or baseUris");var a=shaka.util.ManifestParserUtils,n=shaka.util.XmlUtils;t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,numChannels:null,audioSamplingRate:null,availabilityTimeOffset:0},r=r||t.baseUris;var i=n.parseNonNegativeInt,o=n.evalDivision,s=n.findChildren(e,"BaseURL"),l=s.map(n.getContents),u=e.getAttribute("contentType")||t.contentType,c=e.getAttribute("mimeType")||t.mimeType,d=e.getAttribute("codecs")||t.codecs;o=n.parseAttr(e,"frameRate",o)||t.frameRate;var p=e.getAttribute("sar")||t.pixelAspectRatio,h=this.emsgSchemeIdUris_(n.findChildren(e,"InbandEventStream"),t.emsgSchemeIdUris),f=n.findChildren(e,"AudioChannelConfiguration");f=this.parseAudioChannels_(f)||t.numChannels;var g=n.parseAttr(e,"audioSamplingRate",i)||t.audioSamplingRate;u||(u=shaka.dash.DashParser.guessContentType_(c,d));var y=n.findChild(e,"SegmentBase"),m=n.findChild(e,"SegmentTemplate"),v=y&&n.parseAttr(y,"availabilityTimeOffset",n.parseFloat)||0,_=m&&n.parseAttr(m,"availabilityTimeOffset",n.parseFloat)||0;return s=s&&s.length&&n.parseAttr(s[0],"availabilityTimeOffset",n.parseFloat)||0,s=t.availabilityTimeOffset+s+v+_,{baseUris:a.resolveUris(r,l),segmentBase:y||t.segmentBase,segmentList:n.findChild(e,"SegmentList")||t.segmentList,segmentTemplate:m||t.segmentTemplate,width:n.parseAttr(e,"width",i)||t.width,height:n.parseAttr(e,"height",i)||t.height,contentType:u,mimeType:c,codecs:d,frameRate:o,pixelAspectRatio:p,emsgSchemeIdUris:h,id:e.getAttribute("id"),numChannels:f,audioSamplingRate:g,availabilityTimeOffset:s}},shaka.dash.DashParser.prototype.emsgSchemeIdUris_=function(e,t){t=t.slice();for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())r=r.value.getAttribute("schemeIdUri"),t.includes(r)||t.push(r);return t},shaka.dash.DashParser.prototype.parseAudioChannels_=function(e){for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value;if((t=r.getAttribute("schemeIdUri"))&&(r=r.getAttribute("value")))switch(t){case"urn:mpeg:dash:outputChannelPositionList:2012":return r.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var a=parseInt(r,10);if(!a){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}return a;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(a=parseInt(r,16))){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}for(e=0;a;)1&a&&++e,a>>=1;return e;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":a=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14];var n=parseInt(r,10);if(!n){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}if(0<n&&n<a.length)return a[n];continue;default:shaka.log.warning("Unrecognized audio channel scheme:",t,r)}}return null},shaka.dash.DashParser.prototype.verifyRepresentation_=function(e){var t=shaka.util.ManifestParserUtils.ContentType,r=e.segmentBase?1:0;return r+=e.segmentList?1:0,0==(r+=e.segmentTemplate?1:0)?e.contentType==t.TEXT||e.contentType==t.APPLICATION||(shaka.log.warning("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',e),!1):(1!=r&&(shaka.log.warning("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",e),e.segmentBase?(shaka.log.info("Using SegmentBase by default."),e.segmentList=null):(goog.asserts.assert(e.segmentList,"There should be a SegmentList"),shaka.log.info("Using SegmentList by default.")),e.segmentTemplate=null),!0)},shaka.dash.DashParser.prototype.requestForTiming_=function(e,t,r){var a,n,i,o,s,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){if(1==d.nextAddress)return a=shaka.util.ManifestParserUtils.resolveUris(e,[t]),(n=shaka.net.NetworkingEngine.makeRequest(a,c.config_.retryParameters)).method=r,i=shaka.net.NetworkingEngine.RequestType.TIMING,o=c.playerInterface_.networkingEngine.request(i,n),c.operationManager_.manage(o),d.yield(o.promise,2);if(s=d.yieldResult,"HEAD"==r){if(!s.headers||!s.headers.date)return shaka.log.warning("UTC timing response is missing","expected date header"),d.return(0);l=s.headers.date}else l=shaka.util.StringUtils.fromUTF8(s.data);return u=Date.parse(l),isNaN(u)?(shaka.log.warning("Unable to parse date from UTC timing response"),d.return(0)):d.return(u-Date.now())}))},shaka.dash.DashParser.prototype.parseUtcTiming_=function(e,t){var r,a,n,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){switch(p.nextAddress){case 1:r=t.map((function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}})),a=d.config_.dash.clockSyncUri,!r.length&&a&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:a}),n=$jscomp.makeIterator(r),i=n.next();case 2:if(i.done){p.jumpTo(4);break}switch(o=i.value,p.setCatchFinallyBlocks(5),s=o.scheme,l=o.value,s){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return p.jumpTo(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return p.jumpTo(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return u=Date.parse(l),p.return(isNaN(u)?0:u-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":shaka.log.alwaysWarn("NTP UTCTiming scheme is not supported");break;default:shaka.log.alwaysWarn("Unrecognized scheme in UTCTiming element",s)}p.jumpTo(9);break;case 7:return p.yield(d.requestForTiming_(e,l,"HEAD"),10);case 10:return p.return(p.yieldResult);case 8:return p.yield(d.requestForTiming_(e,l,"GET"),11);case 11:return p.return(p.yieldResult);case 9:p.leaveTryBlock(3);break;case 5:c=p.enterCatchBlock(),shaka.log.warning("Error fetching time from UTCTiming elem",c.message);case 3:i=n.next(),p.jumpTo(2);break;case 4:return shaka.log.alwaysWarn("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),p.return(0)}}))},shaka.dash.DashParser.prototype.parseEventStream_=function(e,t,r,a){for(var n=shaka.util.XmlUtils,i=n.parseNonNegativeInt,o=r.getAttribute("schemeIdUri")||"",s=r.getAttribute("value")||"",l=n.parseAttr(r,"timescale",i)||1,u=(r=$jscomp.makeIterator(n.findChildren(r,"Event"))).next();!u.done;u=r.next()){u=u.value;var c=n.parseAttr(u,"presentationTime",i)||0,d=n.parseAttr(u,"duration",i)||0;d=(c=c/l+e)+d/l,null!=t&&(c=Math.min(c,e+t),d=Math.min(d,e+t)),d<a||(u={schemeIdUri:o,value:s,startTime:c,endTime:d,id:u.getAttribute("id")||"",eventElement:u},this.playerInterface_.onTimelineRegionAdded(u))}},shaka.dash.DashParser.prototype.requestInitSegment_=function(e,t,r){var a,n,i,o,s,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){return 1==u.nextAddress?(a=shaka.net.NetworkingEngine.RequestType.SEGMENT,n=shaka.util.Networking.createSegmentRequest(e,t,r,l.config_.retryParameters),i=l.playerInterface_.networkingEngine,o=i.request(a,n),l.operationManager_.manage(o),u.yield(o.promise,2)):(s=u.yieldResult,u.return(s.data))}))},shaka.dash.DashParser.guessContentType_=function(e,t){return t=shaka.util.MimeUtils.getFullType(e,t),shaka.text.TextEngine.isTypeSupported(t)?shaka.util.ManifestParserUtils.ContentType.TEXT:e.split("/")[0]},goog.exportSymbol("shaka.dash.DashParser",shaka.dash.DashParser),shaka.dash.DashParser.MIN_UPDATE_PERIOD_=3,shaka.media.ManifestParser.registerParserByExtension("mpd",(function(){return new shaka.dash.DashParser})),shaka.media.ManifestParser.registerParserByMime("application/dash+xml",(function(){return new shaka.dash.DashParser})),shaka.media.ManifestParser.registerParserByMime("video/vnd.mpeg.dash.mpd",(function(){return new shaka.dash.DashParser})),shaka.hls={},shaka.hls.Playlist=function(e,t,r,a){this.absoluteUri=e,this.type=t,this.tags=r,this.segments=a||null},shaka.hls.PlaylistType={MASTER:0,MEDIA:1},shaka.hls.Tag=function(e,t,r,a){this.id=e,this.name=t,this.attributes=r,this.value=void 0===a?null:a},shaka.hls.Tag.prototype.toString=function(){var e=function(e){var t=isNaN(Number(e.value))?'"'+e.value+'"':e.value;return e.name+"="+t},t="#"+this.name;return e=this.attributes?this.attributes.map(e):[],this.value&&e.unshift(this.value),0<e.length&&(t+=":"+e.join(",")),t},shaka.hls.Tag.prototype.addAttribute=function(e){this.attributes.push(e)},shaka.hls.Tag.prototype.getAttribute=function(e){var t=this.attributes.filter((function(t){return t.name==e}));return goog.asserts.assert(2>t.length,"A tag should not have multiple attributes with the same name!"),t.length?t[0]:null},shaka.hls.Tag.prototype.getAttributeValue=function(e,t){return(e=this.getAttribute(e))?e.value:t||null},shaka.hls.Tag.prototype.getRequiredAttrValue=function(e){var t=this.getAttribute(e);if(!t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_REQUIRED_ATTRIBUTE_MISSING,e);return t.value},shaka.hls.Tag.prototype.setName=function(e){this.name=e},shaka.hls.Segment=function(e,t,r){r=void 0===r?[]:r,this.tags=t,this.absoluteUri=e,this.partialSegments=r},shaka.hls.Attribute=function(e,t){this.name=e,this.value=t},shaka.hls.Utils=function(){},shaka.hls.Utils.filterTagsByName=function(e,t){return e.filter((function(e){return e.name==t}))},shaka.hls.Utils.filterTagsByType=function(e,t){return e.filter((function(e){return e.getRequiredAttrValue("TYPE")==t}))},shaka.hls.Utils.getFirstTagWithName=function(e,t){return(e=shaka.hls.Utils.filterTagsByName(e,t)).length?e[0]:null},shaka.hls.Utils.getFirstTagWithNameAsNumber=function(e,t,r){return r=void 0===r?0:r,(e=shaka.hls.Utils.getFirstTagWithName(e,t))?Number(e.value):r},shaka.hls.Utils.constructAbsoluteUri=function(e,t){return shaka.util.ManifestParserUtils.resolveUris([e],[t])[0]},shaka.hls.Utils.isComment=function(e){return/^#(?!EXT)/m.test(e)},shaka.util.TextParser=function(e){this.data_=e,this.position_=0},shaka.util.TextParser.prototype.atEnd=function(){return this.position_==this.data_.length},shaka.util.TextParser.prototype.readLine=function(){return this.readRegexReturnCapture_(/(.*?)(\n|$)/gm,1)},shaka.util.TextParser.prototype.readWord=function(){return this.readRegexReturnCapture_(/[^ \t\n]*/gm,0)},shaka.util.TextParser.prototype.skipWhitespace=function(){this.readRegex(/[ \t]+/gm)},shaka.util.TextParser.prototype.readRegex=function(e){return e=this.indexOf_(e),this.atEnd()||null==e||e.position!=this.position_?null:(this.position_+=e.length,e.results)},shaka.util.TextParser.prototype.readRegexReturnCapture_=function(e,t){return this.atEnd()?null:(e=this.readRegex(e))?e[t]:null},shaka.util.TextParser.prototype.indexOf_=function(e){return goog.asserts.assert(e.global,"global flag should be set"),e.lastIndex=this.position_,null==(e=e.exec(this.data_))?null:{position:e.index,length:e[0].length,results:e}},shaka.hls.ManifestTextParser=function(){this.globalId_=0},shaka.hls.ManifestTextParser.prototype.parsePlaylist=function(e,t){var r=shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS,a=shaka.hls.ManifestTextParser.SEGMENT_TAGS,n=(e=(e=shaka.util.StringUtils.fromUTF8(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_PLAYLIST_HEADER_MISSING);e=shaka.hls.PlaylistType.MASTER;for(var i=!0,o=$jscomp.makeIterator(n),s=o.next();!s.done;s=o.next())if(s=s.value,shaka.hls.Utils.isComment(s)||i)i=!1;else{if(s=this.parseTag_(s),--this.globalId_,r.includes(s.name)){e=shaka.hls.PlaylistType.MEDIA;break}"EXT-X-STREAM-INF"==s.name&&(i=!0)}for(r=[],i=!0,o=0;o<n.length;o++){var l=n[o];if(s=n[o+1],shaka.hls.Utils.isComment(l)||i)i=!1;else{if(l=this.parseTag_(l),a.includes(l.name)){if(e!=shaka.hls.PlaylistType.MEDIA)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);return a=n.splice(o,n.length-o),a=this.parseSegments_(t,a,r),new shaka.hls.Playlist(t,e,r,a)}r.push(l),"EXT-X-STREAM-INF"==l.name&&(i=new shaka.hls.Attribute("URI",s),l.addAttribute(i),i=!0)}}return new shaka.hls.Playlist(t,e,r)},shaka.hls.ManifestTextParser.prototype.parseSegments_=function(e,t,r){for(var a=[],n=[],i=[],o=null,s=(t=$jscomp.makeIterator(t)).next();!s.done;s=t.next())s=s.value,/^(#EXT)/.test(s)?(s=this.parseTag_(s),shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS.includes(s.name)?r.push(s):"EXT-X-MAP"==s.name?o=s:"EXT-X-PART"==s.name?i.push(s):"EXT-X-PRELOAD-HINT"==s.name?"PART"==s.getAttributeValue("TYPE")?i.push(s):"MAP"==s.getAttributeValue("TYPE")&&(s.setName("EXT-X-MAP"),o=s):n.push(s)):shaka.hls.Utils.isComment(s)||(s=s.trim(),s=shaka.hls.Utils.constructAbsoluteUri(e,s),o&&n.push(o),n=new shaka.hls.Segment(s,n,i),a.push(n),n=[],i=[]);return i.length&&(o&&n.push(o),e=new shaka.hls.Segment("",n,i),a.push(e)),a},shaka.hls.ManifestTextParser.prototype.parseTag_=function(e){return shaka.hls.ManifestTextParser.parseTag(this.globalId_++,e)},shaka.hls.ManifestTextParser.parseTag=function(e,t){var r=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!r)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.INVALID_HLS_TAG,t);t=r[1];var a,n=r[2];if(r=[],n){var i,o=(n=new shaka.util.TextParser(n)).readRegex(/^([^,=]+)(?:,|$)/g);for(o&&(a=o[1]),o=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;i=n.readRegex(o);)i=new shaka.hls.Attribute(i[1],i[2]||i[3]),r.push(i),n.skipWhitespace()}return new shaka.hls.Tag(e,t,r,a)},shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP".split(" "),shaka.hls.ManifestTextParser.SEGMENT_TAGS="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP".split(" "),shaka.net.DataUriPlugin=function(){},shaka.net.DataUriPlugin.parse=function(e,t,r,a){try{var n=shaka.net.DataUriPlugin.parseRaw(e);return shaka.util.AbortableOperation.completed({uri:e,originalUri:e,data:n.data,headers:{"content-type":n.contentType}})}catch(e){return shaka.util.AbortableOperation.failed(e)}},shaka.net.DataUriPlugin.parseRaw=function(e){var t=e.split(":");if(2>t.length||"data"!=t[0])throw shaka.log.error("Bad data URI, failed to parse scheme"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_DATA_URI,e);if(2>(t=t.slice(1).join(":").split(",")).length)throw shaka.log.error("Bad data URI, failed to extract encoding and MIME type"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_DATA_URI,e);var r=t[0];e=window.decodeURIComponent(t.slice(1).join(",")),t=r.split(";"),r=t[0];var a=!1;return 1<t.length&&"base64"==t[t.length-1]&&(a=!0,t.pop()),{data:a?shaka.util.Uint8ArrayUtils.fromBase64(e):shaka.util.StringUtils.toUTF8(e),contentType:r}},goog.exportSymbol("shaka.net.DataUriPlugin",shaka.net.DataUriPlugin),goog.exportProperty(shaka.net.DataUriPlugin,"parse",shaka.net.DataUriPlugin.parse),shaka.net.NetworkingEngine.registerScheme("data",shaka.net.DataUriPlugin.parse),shaka.hls.HlsParser=function(){var e=this;this.config_=this.playerInterface_=null,this.globalId_=1,this.globalVariables_=new Map,this.groupIdToStreamInfosMap_=new Map,this.mediaSequenceToStartTimeByType_=new Map;var t=shaka.util.ManifestParserUtils.ContentType;this.mediaSequenceToStartTimeByType_.set(t.VIDEO,new Map),this.mediaSequenceToStartTimeByType_.set(t.AUDIO,new Map),this.mediaSequenceToStartTimeByType_.set(t.TEXT,new Map),this.mediaSequenceToStartTimeByType_.set(t.IMAGE,new Map),this.variantUriSet_=new Set,this.uriToStreamInfosMap_=new Map,this.presentationTimeline_=null,this.masterPlaylistUri_="",this.manifestTextParser_=new shaka.hls.ManifestTextParser,this.updatePlaylistDelay_=0,this.minSequenceNumber_=-1,this.lowestSyncTime_=1/0,this.streamsFinalized_=!1,this.updatePlaylistTimer_=new shaka.util.Timer((function(){e.onUpdate_()})),this.presentationType_=shaka.hls.HlsParser.PresentationType_.VOD,this.manifest_=null,this.maxTargetDuration_=0,this.minTargetDuration_=1/0,this.lowLatencyPresentationDelay_=this.partialTargetDuration_=0,this.operationManager_=new shaka.util.OperationManager,this.groupIdToClosedCaptionsMap_=new Map,this.groupIdToCodecsMap_=new Map,this.mapTagToInitSegmentRefMap_=new Map,this.lowLatencyMode_=!1},shaka.hls.HlsParser.prototype.configure=function(e){this.config_=e},shaka.hls.HlsParser.prototype.start=function(e,t){var r,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(goog.asserts.assert(a.config_,"Must call configure() before start()!"),a.playerInterface_=t,a.lowLatencyMode_=t.isLowLatencyMode(),n.yield(a.requestManifest_(e),2)):3!=n.nextAddress?(r=n.yieldResult,a.masterPlaylistUri_=r.uri,goog.asserts.assert(r.data,"Response data should be non-null!"),n.yield(a.parseManifest_(r.data,e),3)):(goog.asserts.assert(a.manifest_,"Manifest should be non-null"),n.return(a.manifest_))}))},shaka.hls.HlsParser.prototype.stop=function(){this.updatePlaylistTimer_&&(this.updatePlaylistTimer_.stop(),this.updatePlaylistTimer_=null);var e=[];return this.operationManager_&&(e.push(this.operationManager_.destroy()),this.operationManager_=null),this.config_=this.playerInterface_=null,this.variantUriSet_.clear(),this.manifest_=null,this.uriToStreamInfosMap_.clear(),this.groupIdToStreamInfosMap_.clear(),this.groupIdToCodecsMap_.clear(),this.globalVariables_.clear(),Promise.all(e)},shaka.hls.HlsParser.prototype.update=function(){var e,t,r,a,n,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){if(!u.isLive_())return c.return();for(e=[],t=Array.from(u.uriToStreamInfosMap_.values()),r=t.filter((function(e){return e.stream.segmentIndex})),a=$jscomp.makeIterator(r),n=a.next();!n.done;n=a.next())i=n.value,e.push(u.updateStream_(i));return c.yield(Promise.all(e),2)}u.notifySegmentsForStreams_(r.map((function(e){return e.stream}))),o=r.some((function(e){return 0==e.hasEndList})),r.length&&!o&&(s=shaka.hls.HlsParser.PresentationType_,u.setPresentationType_(s.VOD),l=r.map((function(e){return e.maxTimestamp})),u.presentationTimeline_.setDuration(Math.min.apply(Math,$jscomp.arrayFromIterable(l))),u.playerInterface_.updateDuration()),c.jumpToEnd()}))},shaka.hls.HlsParser.prototype.getMediaSequenceToStartTimeFor_=function(e){return this.isLive_()?this.mediaSequenceToStartTimeByType_.get(e.type):e.mediaSequenceToStartTime},shaka.hls.HlsParser.prototype.updateStream_=function(e){var t,r,a,n,i,o,s,l,u,c,d,p,h,f,g,y=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(m){if(1==m.nextAddress)return t=e.absoluteMediaPlaylistUri,r=new goog.Uri(t),y.lowLatencyMode_&&e.canSkipSegments&&r.setQueryData(new goog.Uri.QueryData("_HLS_skip=YES")),m.yield(y.requestManifest_(r.toString()),2);if(a=m.yieldResult,!e.stream.segmentIndex)return m.return();if((n=y.manifestTextParser_.parsePlaylist(a.data,a.uri)).type!=shaka.hls.PlaylistType.MEDIA)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);i=shaka.hls.Utils.filterTagsByName(n.tags,"EXT-X-DEFINE"),o=y.parseMediaVariables_(i),s=e.stream,l=y.getMediaSequenceToStartTimeFor_(e),u=y.parseDrmInfo_(n,s.mimeType),c=u.keyIds,d=u.drmInfos,function(e,t){return e.size===t.size&&[].concat($jscomp.arrayFromIterable(e)).every((function(e){return t.has(e)}))}(s.keyIds,c)||(s.keyIds=c,s.drmInfos=d,y.playerInterface_.newDrmInfo(s)),p=y.createSegments_(e.verbatimMediaPlaylistUri,n,s.type,s.mimeType,l,o),s.segmentIndex.mergeAndEvict(p,y.presentationTimeline_.getSegmentAvailabilityStart()),p.length&&(h=shaka.hls.Utils.getFirstTagWithNameAsNumber(n.tags,"EXT-X-MEDIA-SEQUENCE",0),f=l.get(h),s.segmentIndex.evict(f)),g=p[p.length-1],goog.asserts.assert(g,"Should have segments!"),shaka.hls.Utils.getFirstTagWithName(n.tags,"EXT-X-ENDLIST")&&(e.hasEndList=!0,e.maxTimestamp=g.endTime),m.jumpToEnd()}))},shaka.hls.HlsParser.prototype.onExpirationUpdated=function(e,t){},shaka.hls.HlsParser.prototype.syncStreamsWithSequenceNumber_=function(e){for(var t=-1==this.minSequenceNumber_,r=$jscomp.makeIterator(e),a=r.next();!a.done;a=r.next()){var n=(a=a.value).stream.segmentIndex;goog.asserts.assert(n,"Only loaded streams should be synced");var i=this.getMediaSequenceToStartTimeFor_(a);if(n=n.earliestReference()){if(goog.DEBUG){var o=i.values().next().value;goog.asserts.assert(o==n.startTime,"Sequence number map is not ordered as expected!")}for(o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next()){var s=(o=$jscomp.makeIterator(o.value)).next().value;if(o.next().value==n.startTime){t&&(this.minSequenceNumber_=Math.max(this.minSequenceNumber_,s)),a.firstSequenceNumber=s;break}}}}if(!(0>this.minSequenceNumber_))for(shaka.log.debug("Syncing HLS streams against base sequence number:",this.minSequenceNumber_),a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())(r=(t=a.value).stream.segmentIndex)&&(r.dropFirstReferences(this.minSequenceNumber_-t.firstSequenceNumber),(r=r.earliestReference())&&(r=-r.startTime,t.stream.segmentIndex.offset(r),this.offsetStreamInfo_(t,r)))},shaka.hls.HlsParser.prototype.syncStreamsWithProgramDateTime_=function(e){if(1/0==this.lowestSyncTime_)for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value.stream.segmentIndex;goog.asserts.assert(r,"Only loaded streams should be synced"),null!=(r=r.earliestReference())&&null!=r.syncTime&&(this.lowestSyncTime_=Math.min(this.lowestSyncTime_,r.syncTime))}if(1/0!=(e=this.lowestSyncTime_))for(shaka.log.debug("Syncing HLS streams against base time:",e),t=(r=$jscomp.makeIterator(this.uriToStreamInfosMap_.values())).next();!t.done;t=r.next()){var a=(t=t.value).stream.segmentIndex;if(null!=a){var n=a.earliestReference();if(null==n.syncTime)shaka.log.alwaysError("Missing EXT-X-PROGRAM-DATE-TIME for stream",t.verbatimMediaPlaylistUri,"Expect AV sync issues!");else for(this.offsetStreamInfo_(t,n.syncTime-e-n.startTime),a=(t=$jscomp.makeIterator(a)).next();!a.done;a=t.next())a.value.syncAgainst(e)}}},shaka.hls.HlsParser.prototype.offsetStreamInfo_=function(e,t){e.maxTimestamp+=t,goog.asserts.assert(0<=e.maxTimestamp,"Negative maxTimestamp after adjustment!");for(var r=this.getMediaSequenceToStartTimeFor_(e),a=$jscomp.makeIterator(r),n=a.next();!n.done;n=a.next()){var i=$jscomp.makeIterator(n.value);n=i.next().value,i=i.next().value,r.set(n,i+t)}shaka.log.debug("Offset",t,"applied to",e.verbatimMediaPlaylistUri)},shaka.hls.HlsParser.prototype.parseManifest_=function(e,t){var r,a,n,i,o,s,l,u,c,d,p,h,f,g,y,m,v,_,k,E,T,b,S,A,C,P,w,x,I,M,D,R,O,L,N=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(U){switch(U.nextAddress){case 1:if(r=shaka.hls.HlsParser,a=shaka.hls.Utils,goog.asserts.assert(N.masterPlaylistUri_,"Master playlist URI must be set before calling parseManifest_!"),n=N.manifestTextParser_.parsePlaylist(e,N.masterPlaylistUri_),i=a.filterTagsByName(n.tags,"EXT-X-DEFINE"),N.parseMasterVariables_(i),o=[],s=[],l=[],n.type==shaka.hls.PlaylistType.MEDIA)return b=N.config_.hls.mediaPlaylistFullMimeType,n.segments.length&&(S=new goog.Uri(n.segments[0].absoluteUri),A=S.getPath().split(".").pop(),(C=r.RAW_FORMATS_TO_MIME_TYPES_[A])?b=C:"ts"!==A&&"mp4"!==A&&(r.AUDIO_EXTENSIONS_TO_MIME_TYPES_[A]?(C=r.AUDIO_EXTENSIONS_TO_MIME_TYPES_[A],P=N.config_.hls.defaultAudioCodec,b=C+'; codecs="'+P+'"'):r.VIDEO_EXTENSIONS_TO_MIME_TYPES_[A]&&(C=r.VIDEO_EXTENSIONS_TO_MIME_TYPES_[A],w=N.config_.hls.defaultVideoCodec,b=C+'; codecs="'+w+'"'))),x=shaka.util.MimeUtils.getBasicType(b),I=x.split("/")[0],M=shaka.util.MimeUtils.getCodecs(b),D=new Map,U.yield(N.convertParsedPlaylistIntoStreamInfo_(n,t,t,M,I,"",!0,"Media Playlist",null,D,null,!1,!1,x),5);for(u=a.filterTagsByName(n.tags,"EXT-X-MEDIA"),c=a.filterTagsByName(n.tags,"EXT-X-STREAM-INF"),d=a.filterTagsByName(n.tags,"EXT-X-IMAGE-STREAM-INF"),p=a.filterTagsByName(n.tags,"EXT-X-SESSION-KEY"),N.parseCodecs_(c),h=a.filterTagsByName(n.tags,"EXT-X-SESSION-DATA"),f=$jscomp.makeIterator(h),g=f.next();!g.done;g=f.next())y=g.value,m=y.getAttributeValue("DATA-ID"),v=y.getAttributeValue("URI"),_=y.getAttributeValue("LANGUAGE"),k=y.getAttributeValue("VALUE"),E=(new Map).set("id",m),v&&E.set("uri",shaka.hls.Utils.constructAbsoluteUri(N.masterPlaylistUri_,v)),_&&E.set("language",_),k&&E.set("value",k),T=new shaka.util.FakeEvent("sessiondata",E),N.playerInterface_&&N.playerInterface_.onEvent(T);return N.createStreamInfosFromMediaTags_(u),N.parseClosedCaptions_(u),o=N.createVariantsForTags_(c,p),s=N.parseTexts_(u),U.yield(N.parseImages_(d),4);case 4:l=U.yieldResult,U.jumpTo(3);break;case 5:R=U.yieldResult,N.uriToStreamInfosMap_.set(t,R),o.push({id:0,language:"und",disabledUntilTime:0,primary:!0,audio:"audio"==I?R.stream:null,video:"video"==I?R.stream:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!N.playerInterface_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);goog.asserts.assert(null==N.presentationTimeline_,"Presentation timeline created early!"),N.presentationTimeline_=new shaka.media.PresentationTimeline(null,0),N.presentationTimeline_.setStatic(!0),n.type==shaka.hls.PlaylistType.MEDIA&&(N.isLive_()&&(N.changePresentationTimelineToLive_(),O=N.updatePlaylistDelay_,N.updatePlaylistTimer_.tickAfter(O)),L=Array.from(N.uriToStreamInfosMap_.values()),N.finalizeStreams_(L),N.determineDuration_()),N.manifest_={presentationTimeline:N.presentationTimeline_,variants:o,textStreams:s,imageStreams:l,offlineSessionIds:[],minBufferTime:0,sequenceMode:!0},N.playerInterface_.makeTextStreamsForClosedCaptions(N.manifest_),U.jumpToEnd()}}))},shaka.hls.HlsParser.prototype.determineDuration_=function(){if(goog.asserts.assert(this.presentationTimeline_,"Presentation timeline not created!"),this.isLive_()){if(this.updatePlaylistDelay_=this.minTargetDuration_,this.presentationType_==shaka.hls.HlsParser.PresentationType_.LIVE){var e=this.getMinDuration_();this.config_.hls.useSafariBehaviorForLive&&(e=this.presentationTimeline_.getDelay()),isNaN(this.config_.availabilityWindowOverride)||(e=this.config_.availabilityWindowOverride),this.presentationTimeline_.setSegmentAvailabilityDuration(e)}}else this.presentationTimeline_.setDuration(this.getMinDuration_());this.presentationTimeline_.lockStartTime(),goog.asserts.assert(!this.presentationTimeline_.usingPresentationStartTime(),"We should not be using the presentation start time in HLS!")},shaka.hls.HlsParser.prototype.parseMasterVariables_=function(e){for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value;t=r.getAttributeValue("NAME"),r=r.getAttributeValue("VALUE"),t&&r&&(this.globalVariables_.has(t)||this.globalVariables_.set(t,r))}},shaka.hls.HlsParser.prototype.parseMediaVariables_=function(e){for(var t=new Map,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var a=r.value;r=a.getAttributeValue("NAME");var n=a.getAttributeValue("VALUE");a=a.getAttributeValue("IMPORT"),r&&n&&t.set(r,n),a&&(r=this.globalVariables_.get(a))&&t.set(a,r)}return t},shaka.hls.HlsParser.prototype.parseCodecs_=function(e){for(var t=shaka.util.ManifestParserUtils.ContentType,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var a=r.value,n=a.getAttributeValue("AUDIO");r=a.getAttributeValue("VIDEO");var i=a.getAttributeValue("SUBTITLES");if(a=this.getCodecsForVariantTag_(a),i){var o=shaka.util.ManifestParserUtils.guessCodecsSafe(t.TEXT,a);goog.asserts.assert(null!=o,"Text codecs should be valid."),this.groupIdToCodecsMap_.set(i,o),shaka.util.ArrayUtils.remove(a,o)}n&&((i=shaka.util.ManifestParserUtils.guessCodecsSafe(t.AUDIO,a))||(i=this.config_.hls.defaultAudioCodec),this.groupIdToCodecsMap_.set(n,i)),r&&((n=shaka.util.ManifestParserUtils.guessCodecsSafe(t.VIDEO,a))||(n=this.config_.hls.defaultVideoCodec),this.groupIdToCodecsMap_.set(r,n))}},shaka.hls.HlsParser.prototype.parseTexts_=function(e){var t=this,r=shaka.hls.Utils.filterTagsByType(e,"SUBTITLES");e=r.map((function(e){if(t.config_.disableText)return null;try{return t.createStreamInfoFromMediaTag_(e).stream}catch(e){if(t.config_.hls.ignoreTextStreamFailures)return null;throw e}}));for(var a=shaka.util.ManifestParserUtils.ContentType.TEXT,n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next()){var i=n.value.getRequiredAttrValue("GROUP-ID");if((n=this.groupIdToCodecsMap_.get(i))&&(i=this.groupIdToStreamInfosMap_.get(i)))for(var o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next())(o=o.value).stream.codecs=n,o.stream.mimeType=this.guessMimeTypeBeforeLoading_(a,n)||this.guessMimeTypeFallback_(a)}return e.filter((function(e){return e}))},shaka.hls.HlsParser.prototype.parseImages_=function(e){var t,r,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=e.map((function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return a.config_.disableThumbnails?n.return(null):(n.setCatchFinallyBlocks(2),n.yield(a.createStreamInfoFromImageTag_(e),4));if(2!=n.nextAddress)return t=n.yieldResult,n.return(t.stream);if(r=n.enterCatchBlock(),a.config_.hls.ignoreImageStreamFailures)return n.return(null);throw r}))})),n.yield(Promise.all(t),2)):(r=n.yieldResult,n.return(r.filter((function(e){return e}))))}))},shaka.hls.HlsParser.prototype.createStreamInfosFromMediaTags_=function(e){e=e.filter((function(e){var t=e.getAttributeValue("URI")||"";return"SUBTITLES"!=e.getAttributeValue("TYPE")&&""!=t}));for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())this.createStreamInfoFromMediaTag_(t.value)},shaka.hls.HlsParser.prototype.createVariantsForTags_=function(e,t){var r=this,a=[],n=new Set;if(0<t.length)for(var i=(t=$jscomp.makeIterator(t)).next();!i.done;i=t.next()){var o=(i=i.value).getRequiredAttrValue("METHOD");if("NONE"!=o&&"AES-128"!=o){o=i.getAttributeValue("KEYFORMAT")||"identity";var s=shaka.hls.HlsParser.KEYFORMATS_TO_DRM_PARSERS_[o];if(i=s?s(i,""):null){if(i.keyIds)for(s=(o=$jscomp.makeIterator(i.keyIds)).next();!s.done;s=o.next())n.add(s.value);a.push(i)}else shaka.log.warning("Unsupported HLS KEYFORMAT",o)}}return(e=e.map((function(e){var t=e.getAttributeValue("FRAME-RATE"),i=Number(e.getAttributeValue("AVERAGE-BANDWIDTH"))||Number(e.getRequiredAttrValue("BANDWIDTH")),o=e.getAttributeValue("RESOLUTION"),s=$jscomp.makeIterator(o?o.split("x"):[null,null]),l=s.next().value;s=s.next().value;var u=e.getAttributeValue("VIDEO-RANGE");return e=r.createStreamInfosForVariantTag_(e,o,t),goog.asserts.assert(e.audio.length||e.video.length,"We should have created a stream!"),r.createVariants_(e.audio,e.video,i,l,s,t,u,a,n)})).reduce(shaka.util.Functional.collapseArrays,[])).filter((function(e){return null!=e}))},shaka.hls.HlsParser.prototype.createStreamInfosForVariantTag_=function(e,t,r){r=shaka.util.ManifestParserUtils.ContentType,t=this.getCodecsForVariantTag_(e);var a=e.getAttributeValue("AUDIO"),n=e.getAttributeValue("VIDEO");goog.asserts.assert(null==a||null==n,"Unexpected: both video and audio described by media tags!");var i=a||n;i=i&&this.groupIdToStreamInfosMap_.has(i)?this.groupIdToStreamInfosMap_.get(i):[],a={audio:a?i:[],video:n?i:[]},shaka.log.debug("Guessing stream type for",e.toString()),n=!1;var o=e.getRequiredAttrValue("URI"),s=a.audio.find((function(e){return e&&e.verbatimMediaPlaylistUri==o})),l=shaka.util.ManifestParserUtils.guessCodecsSafe(r.VIDEO,t),u=shaka.util.ManifestParserUtils.guessCodecsSafe(r.AUDIO,t);return u&&!l?(r=r.AUDIO,shaka.log.debug("Guessing audio-only.")):!i.length&&u&&l?(shaka.log.debug("Guessing multiplexed audio+video."),r=r.VIDEO,t=[[l,u].join()]):a.audio.length&&s?(shaka.log.debug("Guessing audio-only."),r=r.AUDIO,n=!0):a.video.length&&!a.audio.length?(shaka.log.debug("Guessing audio-only."),r=r.AUDIO):(shaka.log.debug("Guessing video-only."),r=r.VIDEO),n||(a[(e=this.createStreamInfoFromVariantTag_(e,t,r)).stream.type]=[e]),a},shaka.hls.HlsParser.prototype.getCodecsForVariantTag_=function(e){var t=[];this.config_.disableVideo||t.push(this.config_.hls.defaultVideoCodec),this.config_.disableAudio||t.push(this.config_.hls.defaultAudioCodec),t=t.join(",");var r=e.getAttributeValue("CODECS",t).split(/\s*,\s*/);e=new Set,t=[];for(var a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next()){a=a.value;var n=shaka.util.MimeUtils.getCodecBase(a);e.has(n)?shaka.log.debug("Ignoring duplicate codec"):(t.push(a),e.add(n))}return t},shaka.hls.HlsParser.prototype.getChannelsCount_=function(e){return(e=e.getAttributeValue("CHANNELS"))?(e=e.split("/")[0],parseInt(e,10)):null},shaka.hls.HlsParser.prototype.isSpatialAudio_=function(e){return!!(e=e.getAttributeValue("CHANNELS"))&&e.includes("/JOC")},shaka.hls.HlsParser.prototype.getClosedCaptions_=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType;return e=e.getAttributeValue("CLOSED-CAPTIONS"),t==r.VIDEO&&e&&"NONE"!=e?this.groupIdToClosedCaptionsMap_.get(e):null},shaka.hls.HlsParser.prototype.getLanguage_=function(e){var t=shaka.util.LanguageUtils;return e=e.getAttributeValue("LANGUAGE")||"und",t.normalize(e)},shaka.hls.HlsParser.prototype.getType_=function(e){return"subtitles"==(e=e.getRequiredAttrValue("TYPE").toLowerCase())&&(e=shaka.util.ManifestParserUtils.ContentType.TEXT),e},shaka.hls.HlsParser.prototype.createVariants_=function(e,t,r,a,n,i,o,s,l){for(var u=shaka.util.ManifestParserUtils.ContentType,c=shaka.media.DrmEngine,d=$jscomp.makeIterator(t),p=d.next();!p.done;p=d.next())this.addVideoAttributes_(p.value.stream,a,n,i,o);for(a=this.config_.disableAudio,e.length&&!a||(e=[null]),a=this.config_.disableVideo,t.length&&!a||(t=[null]),a=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())for(n=n.value,o=(i=$jscomp.makeIterator(t)).next();!o.done;o=i.next()){var h=o.value;(o=n?n.stream:null)&&(o.drmInfos=s,o.keyIds=l),(d=h?h.stream:null)&&(d.drmInfos=s,d.keyIds=l),p=n?n.stream.drmInfos:null;var f=h?h.stream.drmInfos:null;h=(h?h.verbatimMediaPlaylistUri:"")+" - "+(n?n.verbatimMediaPlaylistUri:""),o&&d&&!c.areDrmCompatible(p,f)?shaka.log.warning("Incompatible DRM info in HLS variant.  Skipping."):this.variantUriSet_.has(h)?shaka.log.debug("Skipping variant which only differs in text streams."):(goog.asserts.assert(!o||o.type==u.AUDIO,"Audio parameter mismatch!"),goog.asserts.assert(!d||d.type==u.VIDEO,"Video parameter mismatch!"),o={id:this.globalId_++,language:o?o.language:"und",primary:!!o&&o.primary||!!d&&d.primary,audio:o,video:d,bandwidth:r,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},a.push(o),this.variantUriSet_.add(h))}return a},shaka.hls.HlsParser.prototype.parseClosedCaptions_=function(e){e=shaka.hls.Utils.filterTagsByType(e,"CLOSED-CAPTIONS");for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value;goog.asserts.assert("EXT-X-MEDIA"==r.name,"Should only be called on media tags!"),t=this.getLanguage_(r);var a=r.getRequiredAttrValue("GROUP-ID");r=r.getRequiredAttrValue("INSTREAM-ID"),this.groupIdToClosedCaptionsMap_.get(a)||this.groupIdToClosedCaptionsMap_.set(a,new Map),this.groupIdToClosedCaptionsMap_.get(a).set(r,t)}},shaka.hls.HlsParser.prototype.createStreamInfoFromMediaTag_=function(e){goog.asserts.assert("EXT-X-MEDIA"==e.name,"Should only be called on media tags!");var t=e.getRequiredAttrValue("GROUP-ID"),r="",a=this.getType_(e);a!=shaka.util.ManifestParserUtils.ContentType.TEXT&&t&&this.groupIdToCodecsMap_.has(t)&&(r=this.groupIdToCodecsMap_.get(t));var n=this.variableSubstitution_(e.getRequiredAttrValue("URI"),this.globalVariables_);if(this.uriToStreamInfosMap_.has(n))return this.uriToStreamInfosMap_.get(n);var i=this.getLanguage_(e),o=e.getAttributeValue("NAME"),s="YES"==e.getAttributeValue("DEFAULT"),l="audio"==a?this.getChannelsCount_(e):null,u="audio"==a&&this.isSpatialAudio_(e),c=e.getAttributeValue("CHARACTERISTICS");return e=e.getAttributeValue("FORCED"),r=this.createStreamInfo_(n,r,a,i,s,o,l,null,c,"YES"==e,u),this.groupIdToStreamInfosMap_.has(t)?this.groupIdToStreamInfosMap_.get(t).push(r):this.groupIdToStreamInfosMap_.set(t,[r]),this.uriToStreamInfosMap_.has(n)?this.uriToStreamInfosMap_.get(n):(this.uriToStreamInfosMap_.set(n,r),r)},shaka.hls.HlsParser.prototype.createStreamInfoFromImageTag_=function(e){var t,r,a,n,i,o,s,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){return 1==h.nextAddress?(goog.asserts.assert("EXT-X-IMAGE-STREAM-INF"==e.name,"Should only be called on image tags!"),t=shaka.util.ManifestParserUtils.ContentType.IMAGE,r=p.variableSubstitution_(e.getRequiredAttrValue("URI"),p.globalVariables_),a=e.getAttributeValue("CODECS","jpeg")||"",p.uriToStreamInfosMap_.has(r)?h.return(p.uriToStreamInfosMap_.get(r)):(n=p.getLanguage_(e),i=e.getAttributeValue("NAME"),o=e.getAttributeValue("CHARACTERISTICS"),s=p.createStreamInfo_(r,a,t,n,!1,i,null,null,o,!1,!1),p.uriToStreamInfosMap_.has(r)?h.return(p.uriToStreamInfosMap_.get(r)):(l=e.getAttributeValue("RESOLUTION"))?h.yield(s.stream.createSegmentIndex(),3):h.jumpTo(2))):(2!=h.nextAddress&&(u=s.stream.segmentIndex.get(0),c=u.getTilesLayout())&&(s.stream.width=Number(l.split("x")[0])*Number(c.split("x")[0]),s.stream.height=Number(l.split("x")[1])*Number(c.split("x")[1])),(d=e.getAttributeValue("BANDWIDTH"))&&(s.stream.bandwidth=Number(d)),p.uriToStreamInfosMap_.set(r,s),h.return(s))}))},shaka.hls.HlsParser.prototype.createStreamInfoFromVariantTag_=function(e,t,r){goog.asserts.assert("EXT-X-STREAM-INF"==e.name,"Should only be called on variant tags!");var a=this.variableSubstitution_(e.getRequiredAttrValue("URI"),this.globalVariables_);return this.uriToStreamInfosMap_.has(a)?this.uriToStreamInfosMap_.get(a):(e=this.getClosedCaptions_(e,r),t=shaka.util.ManifestParserUtils.guessCodecs(r,t),r=this.createStreamInfo_(a,t,r,"und",!1,null,null,e,null,!1,!1),this.uriToStreamInfosMap_.has(a)?this.uriToStreamInfosMap_.get(a):(this.uriToStreamInfosMap_.set(a,r),r))},shaka.hls.HlsParser.prototype.createStreamInfo_=function(e,t,r,a,n,i,o,s,l,u,c){var d=this,p=shaka.hls.Utils.constructAbsoluteUri(this.masterPlaylistUri_,e),h=this.makeStreamObject_(t,r,a,n,i,o,s,l,u,c);shaka.media.MediaSourceEngine.RAW_FORMATS.includes(h.mimeType)&&(h.codecs="");var f={stream:h,type:r,verbatimMediaPlaylistUri:e,absoluteMediaPlaylistUri:p,maxTimestamp:0,mediaSequenceToStartTime:new Map,canSkipSegments:!1,hasEndList:!1,firstSequenceNumber:-1,loadedOnce:!1},g=null,y=new AbortController;return h.createSegmentIndex=function(){return g||(y=new AbortController,g=new Promise((function(p){p(function(p){var g,y,m,v,_,k,E,T,b,S,A,C,P;return $jscomp.asyncExecutePromiseGeneratorProgram((function(w){if(1==w.nextAddress)return w.yield(d.requestManifest_(f.absoluteMediaPlaylistUri),2);if(3!=w.nextAddress)return g=w.yieldResult,p.aborted?w.return():(y=g.uri,m=d.manifestTextParser_.parsePlaylist(g.data,y),v=d.isLive_(),w.yield(d.convertParsedPlaylistIntoStreamInfo_(m,e,y,t,r,a,n,i,o,s,l,u,c),3));if(_=w.yieldResult,p.aborted)return w.return();if(k=_.stream,d.isLive_()&&!v&&d.changePresentationTimelineToLive_(),f.absoluteMediaPlaylistUri=y,f.maxTimestamp=_.maxTimestamp,f.canSkipSegments=_.canSkipSegments,f.hasEndList=_.hasEndList,f.mediaSequenceToStartTime=_.mediaSequenceToStartTime,f.loadedOnce=!0,h.segmentIndex=k.segmentIndex,h.encrypted=k.encrypted,h.drmInfos=k.drmInfos,h.keyIds=k.keyIds,h.mimeType=k.mimeType,shaka.media.MediaSourceEngine.RAW_FORMATS.includes(h.mimeType)&&(h.codecs=""),h.drmInfos.length&&d.playerInterface_.newDrmInfo(h),E=shaka.util.ManifestParserUtils.ContentType,r==E.VIDEO||r==E.AUDIO)for(T=$jscomp.makeIterator(d.uriToStreamInfosMap_.values()),b=T.next();!b.done;b=T.next())(S=b.value).loadedOnce||S.type!=r||(S.stream.mimeType=k.mimeType,shaka.media.MediaSourceEngine.RAW_FORMATS.includes(S.stream.mimeType)&&(S.stream.codecs=""));d.hasEnoughInfoToFinalizeStreams_()&&(d.streamsFinalized_?d.finalizeStreams_([f]):(d.streamsFinalized_=!0,A=Array.from(d.uriToStreamInfosMap_.values()),C=A.filter((function(e){return e.stream.segmentIndex})),d.finalizeStreams_(C),d.determineDuration_(),0<(P=d.updatePlaylistDelay_)&&d.updatePlaylistTimer_.tickAfter(P))),w.jumpToEnd()}))}(y.signal))})))},h.closeSegmentIndex=function(){g&&!h.segmentIndex&&y.abort(),h.segmentIndex&&(h.segmentIndex.release(),h.segmentIndex=null),g=null},f},shaka.hls.HlsParser.prototype.getMinDuration_=function(){for(var e=1/0,t=$jscomp.makeIterator(this.uriToStreamInfosMap_.values()),r=t.next();!r.done;r=t.next())(r=r.value).stream.segmentIndex&&"text"!=r.stream.type&&(e=Math.min(e,r.maxTimestamp));return e},shaka.hls.HlsParser.prototype.notifySegmentsForStreams_=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value).segmentIndex&&r.segmentIndex.forEachTopLevelReference((function(e){t.push(e)}));this.presentationTimeline_.notifySegments(t)},shaka.hls.HlsParser.prototype.finalizeStreams_=function(e){if(!this.isLive_())for(var t=this.getMinDuration_(),r=$jscomp.makeIterator(e),a=r.next();!a.done;a=r.next())a.value.stream.segmentIndex.fit(0,t);for(a=(t=$jscomp.makeIterator(e)).next();!a.done;a=t.next())a=a.value.stream,shaka.media.MediaSourceEngine.RAW_FORMATS.includes(a.mimeType)&&(a.codecs="");this.notifySegmentsForStreams_(e.map((function(e){return e.stream}))),this.config_.hls.ignoreManifestProgramDateTime?this.syncStreamsWithSequenceNumber_(e):this.syncStreamsWithProgramDateTime_(e)},shaka.hls.HlsParser.prototype.hasEnoughInfoToFinalizeStreams_=function(){if(!this.manifest_)return!1;for(var e=[],t=[],r=$jscomp.makeIterator(this.manifest_.variants),a=r.next();!a.done;a=r.next())(a=a.value).video&&e.push(a.video),a.audio&&t.push(a.audio);return!(0<e.length&&!e.some((function(e){return e.segmentIndex}))||0<t.length&&!t.some((function(e){return e.segmentIndex})))},shaka.hls.HlsParser.prototype.convertParsedPlaylistIntoStreamInfo_=function(e,t,r,a,n,i,o,s,l,u,c,d,p,h){var f,g,y,m,v,_,k,E,T,b,S,A,C,P,w,x=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(I){if(1==I.nextAddress){if(e.type!=shaka.hls.PlaylistType.MEDIA)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);return f=shaka.hls.Utils.filterTagsByName(e.tags,"EXT-X-DEFINE"),g=x.parseMediaVariables_(f),goog.asserts.assert(null!=e.segments,"Media playlist should have segments!"),x.determinePresentationType_(e),h?I.jumpTo(2):I.yield(x.guessMimeType_(n,a,e,g),3)}if(2!=I.nextAddress&&(h=I.yieldResult),y=x.parseDrmInfo_(e,h),m=y.drmInfos,v=y.keyIds,_=y.encrypted,k=y.aesEncrypted,_&&!m.length&&!k)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_KEYFORMATS_NOT_SUPPORTED);return E=x.isLive_()?x.mediaSequenceToStartTimeByType_.get(n):new Map,T=x.lowLatencyMode_,b=x.createSegments_(t,e,n,h,E,g),T!=x.lowLatencyMode_&&x.determinePresentationType_(e),S=b[b.length-1].endTime,A=new shaka.media.SegmentIndex(b),P=!!(C=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-SERVER-CONTROL"))&&null!=C.getAttribute("CAN-SKIP-UNTIL"),(w=x.makeStreamObject_(a,n,i,o,s,l,u,c,d,p)).segmentIndex=A,w.encrypted=_,w.drmInfos=m,w.keyIds=v,w.mimeType=h,I.return({stream:w,type:n,verbatimMediaPlaylistUri:t,absoluteMediaPlaylistUri:r,maxTimestamp:S,canSkipSegments:P,hasEndList:!1,firstSequenceNumber:-1,mediaSequenceToStartTime:E,loadedOnce:!1})}))},shaka.hls.HlsParser.prototype.makeStreamObject_=function(e,t,r,a,n,i,o,s,l,u){var c=this.guessMimeTypeBeforeLoading_(t,e)||this.guessMimeTypeFallback_(t);return{id:this.globalId_++,originalId:n,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:c,codecs:e,kind:t==shaka.util.ManifestParserUtils.ContentType.TEXT?shaka.util.ManifestParserUtils.TextStreamKind.SUBTITLE:void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:r,label:n,type:t,primary:a,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:s?s.split(","):[],forced:l,channelsCount:i,audioSamplingRate:null,spatialAudio:u,closedCaptions:o,hdr:void 0,tilesLayout:void 0}},shaka.hls.HlsParser.prototype.parseDrmInfo_=function(e,t){var r=[];if(e.segments)for(var a=(e=$jscomp.makeIterator(e.segments)).next();!a.done;a=e.next())a=shaka.hls.Utils.filterTagsByName(a.value.tags,"EXT-X-KEY"),r.push.apply(r,$jscomp.arrayFromIterable(a));a=e=!1;for(var n=[],i=new Set,o=(r=$jscomp.makeIterator(r)).next();!o.done;o=r.next()){var s=(o=o.value).getRequiredAttrValue("METHOD");if("NONE"!=s)if(e=!0,"AES-128"==s)a=!0;else{s=o.getAttributeValue("KEYFORMAT")||"identity";var l=shaka.hls.HlsParser.KEYFORMATS_TO_DRM_PARSERS_[s];if(o=l?l(o,t):null){if(o.keyIds)for(l=(s=$jscomp.makeIterator(o.keyIds)).next();!l.done;l=s.next())i.add(l.value);n.push(o)}else shaka.log.warning("Unsupported HLS KEYFORMAT",s)}}return{drmInfos:n,keyIds:i,encrypted:e,aesEncrypted:a}},shaka.hls.HlsParser.prototype.parseAES128DrmTag_=function(e,t){var r=this;if(!window.crypto||!window.crypto.subtle)throw shaka.log.alwaysWarn("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.NO_WEB_CRYPTO_API);var a=0,n=e.getAttributeValue("IV","");if(n){var i=shaka.util.Uint8ArrayUtils.fromHex(n.substr(2));if(16!=i.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_AES_128_INVALID_IV_LENGTH)}else a=shaka.hls.Utils.getFirstTagWithNameAsNumber(t.tags,"EXT-X-MEDIA-SEQUENCE",0);e=shaka.hls.Utils.constructAbsoluteUri(t.absoluteUri,e.getRequiredAttrValue("URI"));var o=shaka.net.NetworkingEngine.RequestType.KEY,s=shaka.net.NetworkingEngine.makeRequest([e],this.config_.retryParameters),l={method:"AES-128",iv:i,firstMediaSequenceNumber:a,fetchKey:function(){var e,t,a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return n.yield(r.makeNetworkRequest_(s,o),2);if(3!=n.nextAddress){if(!(e=n.yieldResult).data||16!=e.data.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_AES_128_INVALID_KEY_LENGTH);return t={name:"AES-CBC"},a=l,n.yield(window.crypto.subtle.importKey("raw",e.data,t,!0,["decrypt"]),3)}a.cryptoKey=n.yieldResult,l.fetchKey=void 0,n.jumpToEnd()}))}};return l},shaka.hls.HlsParser.prototype.determinePresentationType_=function(e){var t=shaka.hls.HlsParser.PresentationType_,r=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-PLAYLIST-TYPE"),a=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-ENDLIST");a=r&&"VOD"==r.value||a,r=r&&"EVENT"==r.value&&!a,r=!a&&!r,a?this.setPresentationType_(t.VOD):(r?this.setPresentationType_(t.LIVE):this.setPresentationType_(t.EVENT),t=this.getRequiredTag_(e.tags,"EXT-X-TARGETDURATION"),t=Number(t.value),a=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-PART-INF"),this.lowLatencyMode_&&a?(this.partialTargetDuration_=Number(a.getRequiredAttrValue("PART-TARGET")),this.minTargetDuration_=Math.min(this.partialTargetDuration_,this.minTargetDuration_),this.lowLatencyPresentationDelay_=(e=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-SERVER-CONTROL"))?Number(e.getRequiredAttrValue("PART-HOLD-BACK")):0):this.minTargetDuration_=Math.min(t,this.minTargetDuration_),this.maxTargetDuration_=Math.max(t,this.maxTargetDuration_))},shaka.hls.HlsParser.prototype.changePresentationTimelineToLive_=function(){var e=this.config_.defaultPresentationDelay?this.config_.defaultPresentationDelay:this.lowLatencyPresentationDelay_?this.lowLatencyPresentationDelay_:this.maxTargetDuration_*this.config_.hls.liveSegmentsDelay;this.presentationTimeline_.setPresentationStartTime(0),this.presentationTimeline_.setDelay(e),this.presentationTimeline_.setStatic(!1)},shaka.hls.HlsParser.prototype.getInitSegmentReference_=function(e,t,r){if(!(t=shaka.hls.Utils.getFirstTagWithName(t,"EXT-X-MAP")))return null;var a=t.getRequiredAttrValue("URI");return e=[r=this.variableSubstitution_(shaka.hls.Utils.constructAbsoluteUri(e,a),r),t.getAttributeValue("BYTERANGE","")].join("-"),this.mapTagToInitSegmentRefMap_.has(e)||(t=this.createInitSegmentReference_(r,t),this.mapTagToInitSegmentRefMap_.set(e,t)),this.mapTagToInitSegmentRefMap_.get(e)},shaka.hls.HlsParser.prototype.createInitSegmentReference_=function(e,t){var r=0,a=null;return(t=t.getAttributeValue("BYTERANGE"))&&(r=t.split("@"),a=Number(r[0]),a=(r=Number(r[1]))+a-1),new shaka.media.InitSegmentReference((function(){return[e]}),r,a)},shaka.hls.HlsParser.prototype.createSegmentReference_=function(e,t,r,a,n,i,o,s){var l=r.tags,u=this.variableSubstitution_(r.absoluteUri,n),c=shaka.hls.Utils.getFirstTagWithName(l,"EXTINF"),d=0;n=0;var p=null;r.partialSegments.length&&!this.lowLatencyMode_&&shaka.log.alwaysWarn("Low-latency HLS live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.");var h=null;if(!this.config_.hls.ignoreManifestProgramDateTime){var f=shaka.hls.Utils.getFirstTagWithName(l,"EXT-X-PROGRAM-DATE-TIME");f&&f.value&&(h=shaka.util.XmlUtils.parseDate(f.value),goog.asserts.assert(null!=h,"EXT-X-PROGRAM-DATE-TIME format not valid"))}if(f=shaka.media.SegmentReference.Status.AVAILABLE,shaka.hls.Utils.getFirstTagWithName(l,"EXT-X-GAP")&&(f=shaka.media.SegmentReference.Status.MISSING),!c){if(0==r.partialSegments.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_REQUIRED_TAG_MISSING,"EXTINF");if(!this.lowLatencyMode_)return null}var g=[];if(this.lowLatencyMode_){d={};for(var y=0;y<r.partialSegments.length;d={$jscomp$loop$prop$pAbsoluteUri$675:d.$jscomp$loop$prop$pAbsoluteUri$675},y++){var m=r.partialSegments[y],v=0==y?t:g[g.length-1],_=0==y?a:v.endTime,k=Number(m.getAttributeValue("DURATION"))||this.partialTargetDuration_;if(k){k=_+k;var E=0,T=null;"EXT-X-PRELOAD-HINT"==m.name?E=(E=m.getAttributeValue("BYTERANGE-START"))?Number(E):0:(E=m.getAttributeValue("BYTERANGE"),E=(T=$jscomp.makeIterator(this.parseByteRange_(v,E))).next().value,T=T.next().value),(v=m.getAttributeValue("URI"))&&(d.$jscomp$loop$prop$pAbsoluteUri$675=shaka.hls.Utils.constructAbsoluteUri(i,v),v=shaka.media.SegmentReference.Status.AVAILABLE,"YES"==m.getAttributeValue("GAP")&&(v=shaka.media.SegmentReference.Status.MISSING),m=new shaka.media.SegmentReference(_,k,function(e){return function(){return[e.$jscomp$loop$prop$pAbsoluteUri$675]}}(d),E,T,e,0,0,1/0,[],"",null,null,v),g.push(m))}}}return c?(r=c.value.split(","),d=a+Number(r[0])):d=g[g.length-1].endTime,(r=shaka.hls.Utils.getFirstTagWithName(l,"EXT-X-BYTERANGE"))?(n=(p=$jscomp.makeIterator(this.parseByteRange_(t,r.value))).next().value,p=p.next().value):g.length&&(n=g[0].startByte,p=g[g.length-1].endByte),t="",r=null,o==shaka.util.ManifestParserUtils.ContentType.IMAGE&&(t="1x1",o=shaka.hls.Utils.getFirstTagWithName(l,"EXT-X-TILES"))&&(t=o.getRequiredAttrValue("LAYOUT"),(o=o.getAttributeValue("DURATION"))&&(r=Number(o))),new shaka.media.SegmentReference(a,d,(function(){return u.length?[u]:[]}),n,p,e,0,0,1/0,g,t,r,h,f,s)},shaka.hls.HlsParser.prototype.parseByteRange_=function(e,t){var r=0,a=null;return t&&(r=t.split("@"),t=Number(r[0]),r[1]?r=Number(r[1]):(goog.asserts.assert(e,"Cannot refer back to previous HLS segment!"),r=e.endByte+1),a=r+t-1),[r,a]},shaka.hls.HlsParser.prototype.createSegments_=function(e,t,r,a,n,i){e=t.segments,goog.asserts.assert(e.length,"Playlist should have segments!"),a=void 0;var o=shaka.hls.Utils.getFirstTagWithNameAsNumber(t.tags,"EXT-X-DISCONTINUITY-SEQUENCE",0),s=shaka.hls.Utils.getFirstTagWithNameAsNumber(t.tags,"EXT-X-MEDIA-SEQUENCE",0),l=shaka.hls.Utils.getFirstTagWithName(t.tags,"EXT-X-SKIP"),u=s+(l=l?Number(l.getAttributeValue("SKIPPED-SEGMENTS")):0),c=0;this.isLive_()&&n.has(u)&&(c=n.get(u));for(var d=[],p=null,h=0;h<e.length;h++){var f=e[h],g=0==h?c:p.endTime;u=s+l+h,shaka.hls.Utils.getFirstTagWithName(f.tags,"EXT-X-DISCONTINUITY")&&o++;for(var y=$jscomp.makeIterator(f.tags),m=y.next();!m.done;m=y.next())"EXT-X-KEY"==(m=m.value).name&&(a="AES-128"==m.getRequiredAttrValue("METHOD")?this.parseAES128DrmTag_(m,t):void 0);n.set(u,g),y=this.getInitSegmentReference_(t.absoluteUri,f.tags,i),!this.lowLatencyMode_&&this.playerInterface_.isAutoLowLatencyMode()&&(this.playerInterface_.enableLowLatencyMode(),this.lowLatencyMode_=this.playerInterface_.isLowLatencyMode()),(p=f=this.createSegmentReference_(y,p,f,g,i,t.absoluteUri,r,a))&&(f.discontinuitySequence=o,this.config_.hls.ignoreManifestProgramDateTime&&null!=this.minSequenceNumber_&&u<this.minSequenceNumber_||d.push(f))}if(t=d.some((function(e){return null!=e.syncTime})))for(r={},n=0;n<d.length;r={$jscomp$loop$prop$forwardI$677:r.$jscomp$loop$prop$forwardI$677,$jscomp$loop$prop$forwardAdd$678:r.$jscomp$loop$prop$forwardAdd$678,$jscomp$loop$prop$backwardI$679:r.$jscomp$loop$prop$backwardI$679,$jscomp$loop$prop$reference$568$680:r.$jscomp$loop$prop$reference$568$680,$jscomp$loop$prop$backwardAdd$681:r.$jscomp$loop$prop$backwardAdd$681},n++)if(r.$jscomp$loop$prop$reference$568$680=d[n],null==r.$jscomp$loop$prop$reference$568$680.syncTime)for(r.$jscomp$loop$prop$forwardAdd$678=0,r.$jscomp$loop$prop$forwardI$677=n,i=function(e){return function(){var t=d[e.$jscomp$loop$prop$forwardI$677];if(t){if(null!=t.syncTime)return t.syncTime+e.$jscomp$loop$prop$forwardAdd$678;e.$jscomp$loop$prop$forwardAdd$678-=t.endTime-t.startTime,e.$jscomp$loop$prop$forwardI$677+=1}return null}}(r),r.$jscomp$loop$prop$backwardAdd$681=0,r.$jscomp$loop$prop$backwardI$679=n,e=function(e){return function(){var t=d[e.$jscomp$loop$prop$backwardI$679];if(t){if(t!=e.$jscomp$loop$prop$reference$568$680&&(e.$jscomp$loop$prop$backwardAdd$681+=t.endTime-t.startTime),null!=t.syncTime)return t.syncTime+e.$jscomp$loop$prop$backwardAdd$681;--e.$jscomp$loop$prop$backwardI$679}return null}}(r);null==r.$jscomp$loop$prop$reference$568$680.syncTime;)r.$jscomp$loop$prop$reference$568$680.syncTime=e(),null==r.$jscomp$loop$prop$reference$568$680.syncTime&&(r.$jscomp$loop$prop$reference$568$680.syncTime=i());if(t)for(n=(r=$jscomp.makeIterator(d)).next();!n.done;n=r.next())for(n=(i=n.value).syncTime,e=(i=$jscomp.makeIterator(i.partialReferences)).next();!e.done;e=i.next())(e=e.value).syncTime=n,n+=e.endTime-e.startTime;if(r=this.lowestSyncTime_,t&&1/0!=r)for(n=(t=$jscomp.makeIterator(d)).next();!n.done;n=t.next())n.value.syncAgainst(r);return d},shaka.hls.HlsParser.prototype.variableSubstitution_=function(e,t){var r=(e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}")).match(/{\$\w*}/g);if(r)for(var a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next()){var n=(a=a.value).slice(2,a.length-1),i=t.get(n);if(!i)throw shaka.log.error("A variable has been found that is not declared",n),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_VARIABLE_NOT_FOUND,n);e=e.replace(a,i)}return e},shaka.hls.HlsParser.prototype.guessMimeTypeBeforeLoading_=function(e,t){if(e==shaka.util.ManifestParserUtils.ContentType.TEXT){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return e!=shaka.util.ManifestParserUtils.ContentType.IMAGE||t&&"jpeg"!=t?e==shaka.util.ManifestParserUtils.ContentType.AUDIO&&"mp4a.40.34"==t?"audio/mpeg":null:"image/jpeg"},shaka.hls.HlsParser.prototype.guessMimeTypeFallback_=function(e){return e==shaka.util.ManifestParserUtils.ContentType.TEXT?"text/vtt":shaka.hls.HlsParser.EXTENSION_MAP_BY_CONTENT_TYPE_[e].mp4},shaka.hls.HlsParser.prototype.guessMimeType_=function(e,t,r,a){var n,i,o,s,l,u,c,d,p,h,f,g=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(y){return 1==y.nextAddress?(n=shaka.hls.HlsParser,i=shaka.net.NetworkingEngine.RequestType.SEGMENT,goog.asserts.assert(r.segments.length,"Playlist should have segments!"),o=Math.trunc((r.segments.length-1)/2),s=g.variableSubstitution_(r.segments[o].absoluteUri,a),l=new goog.Uri(s),u=l.getPath().split(".").pop(),c=n.EXTENSION_MAP_BY_CONTENT_TYPE_[e],(d=c[u])||(d=n.RAW_FORMATS_TO_MIME_TYPES_[u])||(d=g.guessMimeTypeBeforeLoading_(e,t))?y.return(d):((p=shaka.net.NetworkingEngine.makeRequest([s],g.config_.retryParameters)).method="HEAD",y.yield(g.makeNetworkRequest_(p,i),2))):(h=y.yieldResult,(f=h.headers["content-type"])?y.return(f.split(";")[0]):y.return(g.guessMimeTypeFallback_(e)))}))},shaka.hls.HlsParser.prototype.getRequiredTag_=function(e,t){if(!(e=shaka.hls.Utils.getFirstTagWithName(e,t)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_REQUIRED_TAG_MISSING,t);return e},shaka.hls.HlsParser.prototype.addVideoAttributes_=function(e,t,r,a,n){e&&(e.width=Number(t)||void 0,e.height=Number(r)||void 0,e.frameRate=Number(a)||void 0,e.hdr=n||void 0)},shaka.hls.HlsParser.prototype.requestManifest_=function(e){var t=shaka.net.NetworkingEngine.RequestType.MANIFEST;return e=shaka.net.NetworkingEngine.makeRequest([e],this.config_.retryParameters),this.playerInterface_.modifyManifestRequest(e,{format:shaka.util.CmcdManager.StreamingFormat.HLS}),this.makeNetworkRequest_(e,t)},shaka.hls.HlsParser.prototype.onUpdate_=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(shaka.log.info("Updating manifest..."),goog.asserts.assert(0<r.updatePlaylistDelay_,"We should only call |onUpdate_| when we are suppose to be updating."),r.playerInterface_?(a.setCatchFinallyBlocks(2),a.yield(r.update(),4)):a.return()):2!=a.nextAddress?(r.isLive_()&&(e=r.updatePlaylistDelay_,r.updatePlaylistTimer_.tickAfter(e)),a.leaveTryBlock(0)):(t=a.enterCatchBlock(),r.playerInterface_?(goog.asserts.assert(t instanceof shaka.util.Error,"Should only receive a Shaka error"),t.severity=shaka.util.Error.Severity.RECOVERABLE,r.playerInterface_.onError(t),r.updatePlaylistTimer_.tickAfter(.1),void a.jumpToEnd()):a.return())}))},shaka.hls.HlsParser.prototype.isLive_=function(){return this.presentationType_!=shaka.hls.HlsParser.PresentationType_.VOD},shaka.hls.HlsParser.prototype.setPresentationType_=function(e){this.presentationType_=e,this.presentationTimeline_&&this.presentationTimeline_.setStatic(!this.isLive_()),this.isLive_()||this.updatePlaylistTimer_.stop()},shaka.hls.HlsParser.prototype.makeNetworkRequest_=function(e,t){if(!this.operationManager_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);return e=this.playerInterface_.networkingEngine.request(t,e),this.operationManager_.manage(e),e.promise},shaka.hls.HlsParser.fairplayDrmParser_=function(e,t){if("video/mp2t"==t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED);if(shaka.util.Platform.isMediaKeysPolyfilled())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED);return shaka.util.ManifestParserUtils.createDrmInfo("com.apple.fps",[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}])},shaka.hls.HlsParser.widevineDrmParser_=function(e){var t=e.getRequiredAttrValue("METHOD"),r=["SAMPLE-AES","SAMPLE-AES-CTR"];return r.includes(t)?(t=e.getRequiredAttrValue("URI"),t=shaka.net.DataUriPlugin.parseRaw(t),t=shaka.util.BufferUtils.toUint8(t.data),t=shaka.util.ManifestParserUtils.createDrmInfo("com.widevine.alpha",[{initDataType:"cenc",initData:t}]),(e=e.getAttributeValue("KEYID"))&&(e=e.toLowerCase(),goog.asserts.assert(e.startsWith("0x"),"Incorrect KEYID format!"),t.keyIds=new Set([e.substr(2)])),t):(shaka.log.error("Widevine in HLS is only supported with [",r.join(", "),"], not",t),null)},shaka.hls.HlsParser.playreadyDrmParser_=function(e){var t=e.getRequiredAttrValue("METHOD"),r=["SAMPLE-AES","SAMPLE-AES-CTR"];return r.includes(t)?(e=e.getRequiredAttrValue("URI"),e=shaka.net.DataUriPlugin.parseRaw(e),e=shaka.util.BufferUtils.toUint8(e.data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),r=new Set,e=shaka.util.Pssh.createPssh(e,t,r,0),shaka.util.ManifestParserUtils.createDrmInfo("com.microsoft.playready",[{initDataType:"cenc",initData:e}])):(shaka.log.error("PlayReady in HLS is only supported with [",r.join(", "),"], not",t),null)},shaka.hls.HlsParser.identityDrmParser_=function(e){e=e.getRequiredAttrValue("METHOD");var t=["SAMPLE-AES","SAMPLE-AES-CTR"];return t.includes(e)?shaka.util.ManifestParserUtils.createDrmInfo("org.w3.clearkey",null):(shaka.log.error("Identity (ClearKey) in HLS is only supported with [",t.join(", "),"], not",e),null)},goog.exportSymbol("shaka.hls.HlsParser",shaka.hls.HlsParser),shaka.hls.HlsParser.RAW_FORMATS_TO_MIME_TYPES_={aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},shaka.hls.HlsParser.AUDIO_EXTENSIONS_TO_MIME_TYPES_={mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",tsa:"video/mp2t"},shaka.hls.HlsParser.VIDEO_EXTENSIONS_TO_MIME_TYPES_={mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t",tsv:"video/mp2t"},shaka.hls.HlsParser.TEXT_EXTENSIONS_TO_MIME_TYPES_={mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml"},shaka.hls.HlsParser.IMAGE_EXTENSIONS_TO_MIME_TYPES_={jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"},shaka.hls.HlsParser.EXTENSION_MAP_BY_CONTENT_TYPE_={audio:shaka.hls.HlsParser.AUDIO_EXTENSIONS_TO_MIME_TYPES_,video:shaka.hls.HlsParser.VIDEO_EXTENSIONS_TO_MIME_TYPES_,text:shaka.hls.HlsParser.TEXT_EXTENSIONS_TO_MIME_TYPES_,image:shaka.hls.HlsParser.IMAGE_EXTENSIONS_TO_MIME_TYPES_},shaka.hls.HlsParser.KEYFORMATS_TO_DRM_PARSERS_={"com.apple.streamingkeydelivery":shaka.hls.HlsParser.fairplayDrmParser_,"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":shaka.hls.HlsParser.widevineDrmParser_,"com.microsoft.playready":shaka.hls.HlsParser.playreadyDrmParser_,identity:shaka.hls.HlsParser.identityDrmParser_},shaka.hls.HlsParser.PresentationType_={VOD:"VOD",EVENT:"EVENT",LIVE:"LIVE"},shaka.util.Platform.isTizen3()||shaka.util.Platform.isTizen2()||shaka.util.Platform.isWebOS3()||(shaka.media.ManifestParser.registerParserByExtension("m3u8",(function(){return new shaka.hls.HlsParser})),shaka.media.ManifestParser.registerParserByMime("application/x-mpegurl",(function(){return new shaka.hls.HlsParser})),shaka.media.ManifestParser.registerParserByMime("application/vnd.apple.mpegurl",(function(){return new shaka.hls.HlsParser}))),shaka.net.HttpPluginUtils=function(){},shaka.net.HttpPluginUtils.makeResponse=function(e,t,r,a,n,i){if(200<=r&&299>=r&&202!=r)return{uri:n||a,originalUri:a,data:t,status:r,headers:e,fromCache:!!e["x-shaka-from-cache"]};n=null;try{n=shaka.util.StringUtils.fromBytesAutoDetect(t)}catch(e){}throw shaka.log.debug("HTTP error text:",n),new shaka.util.Error(401==r||403==r?shaka.util.Error.Severity.CRITICAL:shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.BAD_HTTP_STATUS,a,r,n,e,i)},shaka.net.HttpFetchPlugin=function(){},shaka.net.HttpFetchPlugin.parse=function(e,t,r,a,n){var i=new shaka.net.HttpFetchPlugin.Headers_;shaka.util.MapUtils.asMap(t.headers).forEach((function(e,t){i.append(t,e)}));var o=new shaka.net.HttpFetchPlugin.AbortController_,s={canceled:!1,timedOut:!1};if(e=shaka.net.HttpFetchPlugin.request_(e,r,{body:t.body||void 0,headers:i,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,a,n,t.streamDataCallback),e=new shaka.util.AbortableOperation(e,(function(){return s.canceled=!0,o.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var l=new shaka.util.Timer((function(){s.timedOut=!0,o.abort()}));l.tickAfter(t/1e3),e.finally((function(){l.stop()}))}return e},shaka.net.HttpFetchPlugin.request_=function(e,t,r,a,n,i,o){var s,l,u,c,d,p,h,f,g,y,m,v;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:return s=shaka.net.HttpFetchPlugin.fetch_,l=shaka.net.HttpFetchPlugin.ReadableStream_,p=d=0,h=Date.now(),_.setCatchFinallyBlocks(2),_.yield(s(e,r),4);case 4:return u=_.yieldResult,i(shaka.net.HttpFetchPlugin.headersToGenericObject_(u.headers)),f=u.clone().body.getReader(),y=(g=u.headers.get("Content-Length"))?parseInt(g,10):0,new l({start:function(e){var t=function(){var r,a,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:return s.setCatchFinallyBlocks(2),s.yield(f.read(),4);case 4:r=s.yieldResult,s.leaveTryBlock(3);break;case 2:return a=s.enterCatchBlock(),shaka.log.v1("error reading from stream",a.message),s.return();case 3:if(r.done){s.jumpTo(5);break}if(d+=r.value.byteLength,!o){s.jumpTo(5);break}return s.yield(o(r.value),5);case 5:(100<(i=Date.now())-h||r.done)&&(n(i-h,d-p,y-d),p=d,h=i),r.done?(goog.asserts.assert(!r.value,'readObj should be unset when "done" is true.'),e.close()):(e.enqueue(r.value),t()),s.jumpToEnd()}}))};t()}}),_.yield(u.arrayBuffer(),5);case 5:c=_.yieldResult,_.leaveTryBlock(3);break;case 2:if(m=_.enterCatchBlock(),a.canceled)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.OPERATION_ABORTED,e,t);if(a.timedOut)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,e,t);throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.HTTP_ERROR,e,m,t);case 3:return v=shaka.net.HttpFetchPlugin.headersToGenericObject_(u.headers),_.return(shaka.net.HttpPluginUtils.makeResponse(v,c,u.status,e,u.url,t))}}))},shaka.net.HttpFetchPlugin.headersToGenericObject_=function(e){var t={};return e.forEach((function(e,r){t[r.trim()]=e})),t},shaka.net.HttpFetchPlugin.isSupported=function(){if(!window.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!window.fetch||!window.AbortController)},goog.exportSymbol("shaka.net.HttpFetchPlugin",shaka.net.HttpFetchPlugin),goog.exportProperty(shaka.net.HttpFetchPlugin,"isSupported",shaka.net.HttpFetchPlugin.isSupported),goog.exportProperty(shaka.net.HttpFetchPlugin,"parse",shaka.net.HttpFetchPlugin.parse),shaka.net.HttpFetchPlugin.fetch_=window.fetch,shaka.net.HttpFetchPlugin.AbortController_=window.AbortController,shaka.net.HttpFetchPlugin.ReadableStream_=window.ReadableStream,shaka.net.HttpFetchPlugin.Headers_=window.Headers,shaka.net.HttpFetchPlugin.isSupported()&&(shaka.net.NetworkingEngine.registerScheme("http",shaka.net.HttpFetchPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.PREFERRED,!0),shaka.net.NetworkingEngine.registerScheme("https",shaka.net.HttpFetchPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.PREFERRED,!0),shaka.net.NetworkingEngine.registerScheme("blob",shaka.net.HttpFetchPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.PREFERRED,!0)),shaka.net.HttpXHRPlugin=function(){},shaka.net.HttpXHRPlugin.parse=function(e,t,r,a,n){var i=new shaka.net.HttpXHRPlugin.Xhr_,o=Date.now(),s=0,l=new Promise((function(l,u){i.open(t.method,e,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){u(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.OPERATION_ABORTED,e,r))};var c=!1;for(var d in i.onreadystatechange=function(e){2!=i.readyState||c||(e=shaka.net.HttpXHRPlugin.headersToGenericObject_(i),n(e),c=!0)},i.onload=function(t){t=shaka.net.HttpXHRPlugin.headersToGenericObject_(i),goog.asserts.assert(i.response instanceof ArrayBuffer,"XHR should have a response by now!");var a=i.response;try{var n=shaka.net.HttpPluginUtils.makeResponse(t,a,i.status,e,i.responseURL,r);l(n)}catch(e){goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),u(e)}},i.onerror=function(t){u(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.HTTP_ERROR,e,t,r))},i.ontimeout=function(t){u(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,e,r))},i.onprogress=function(e){var t=Date.now();(100<t-o||e.lengthComputable&&e.loaded==e.total)&&(a(t-o,e.loaded-s,e.total-e.loaded),s=e.loaded,o=t)},t.headers){var p=d.toLowerCase();i.setRequestHeader(p,t.headers[d])}i.send(t.body)}));return new shaka.util.AbortableOperation(l,(function(){return i.abort(),Promise.resolve()}))},shaka.net.HttpXHRPlugin.headersToGenericObject_=function(e){var t=e.getAllResponseHeaders().trim().split("\r\n");e={};for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())e[(r=r.value.split(": "))[0].toLowerCase()]=r.slice(1).join(": ");return e},goog.exportSymbol("shaka.net.HttpXHRPlugin",shaka.net.HttpXHRPlugin),goog.exportProperty(shaka.net.HttpXHRPlugin,"parse",shaka.net.HttpXHRPlugin.parse),shaka.net.HttpXHRPlugin.Xhr_=window.XMLHttpRequest,shaka.net.NetworkingEngine.registerScheme("http",shaka.net.HttpXHRPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.FALLBACK,!0),shaka.net.NetworkingEngine.registerScheme("https",shaka.net.HttpXHRPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.FALLBACK,!0),shaka.net.NetworkingEngine.registerScheme("blob",shaka.net.HttpXHRPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.FALLBACK,!0),shaka.offline={},shaka.offline.DownloadInfo=function(e,t,r,a){this.ref=e,this.estimateId=t,this.groupId=r,this.isInitSegment=a},shaka.offline.DownloadInfo.idForSegmentRef=function(e){return e.getUris().map((function(e){return"{"+encodeURI(e)+"}"})).join("")+":"+e.startByte+":"+e.endByte},shaka.offline.DownloadInfo.prototype.getRefId=function(){return shaka.offline.DownloadInfo.idForSegmentRef(this.ref)},shaka.offline.DownloadInfo.prototype.makeSegmentRequest=function(e){return shaka.util.Networking.createSegmentRequest(this.ref.getUris(),this.ref.startByte,this.ref.endByte,e.streaming.retryParameters)},shaka.offline.DownloadProgressEstimator=function(){this.actualDownloaded_=this.estimatedDownloaded_=this.estimatedTotal_=0,this.pending_=new Map,this.nextId_=0},shaka.offline.DownloadProgressEstimator.prototype.open=function(e){this.estimatedTotal_+=e;var t=this.nextId_;return this.nextId_++,this.pending_.set(t,e),t},shaka.offline.DownloadProgressEstimator.prototype.close=function(e,t){if(this.pending_.has(e)){var r=this.pending_.get(e);this.pending_.delete(e),this.estimatedDownloaded_+=r,this.actualDownloaded_+=t}},shaka.offline.DownloadProgressEstimator.prototype.getEstimatedProgress=function(){return 0==this.estimatedTotal_?0:this.estimatedDownloaded_/this.estimatedTotal_},shaka.offline.DownloadProgressEstimator.prototype.getTotalDownloaded=function(){return this.actualDownloaded_},shaka.offline.DownloadManager=function(e){var t=this;this.networkingEngine_=e,this.groups_=new Map,this.destroyer_=new shaka.util.Destroyer((function(){return t.abortAll().catch((function(){}))})),this.abortCallbacks_=[],this.onProgress_=function(e,t){},this.onInitData_=function(e,t){},this.estimator_=new shaka.offline.DownloadProgressEstimator},shaka.offline.DownloadManager.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.offline.DownloadManager.prototype.setCallbacks=function(e,t){this.onProgress_=e,this.onInitData_=t},shaka.offline.DownloadManager.prototype.abortAll=function(){var e=this.abortCallbacks_.map((function(e){return e()}));return this.abortCallbacks_=[],Promise.all(e)},shaka.offline.DownloadManager.prototype.addDownloadEstimate=function(e){return this.estimator_.open(e)},shaka.offline.DownloadManager.prototype.queue=function(e,t,r,a,n){var i=this;this.destroyer_.ensureNotDestroyed();var o=(this.groups_.get(e)||Promise.resolve()).then((function(){var e,o,s,l,u,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress)return p.yield(i.fetchSegment_(t),2);if(e=p.yieldResult,i.destroyer_.destroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.OPERATION_ABORTED);if(a)for(l in o=shaka.util.BufferUtils.toUint8(e),(s=new shaka.util.Pssh(o)).data)u=Number(l),c=s.data[u],d=s.systemIds[u],i.onInitData_(c,d);return i.estimator_.close(r,e.byteLength),i.onProgress_(i.estimator_.getEstimatedProgress(),i.estimator_.getTotalDownloaded()),p.return(n(e))}))}));return this.groups_.set(e,o),o},shaka.offline.DownloadManager.prototype.queueWork=function(e,t){this.destroyer_.ensureNotDestroyed();var r=(this.groups_.get(e)||Promise.resolve()).then((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(t(),0)}))}));return this.groups_.set(e,r),r},shaka.offline.DownloadManager.prototype.waitToFinish=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?t.yield(Promise.all(e.groups_.values()),2):t.return(e.estimator_.getTotalDownloaded())}))},shaka.offline.DownloadManager.prototype.fetchSegment_=function(e){var t,r,a,n,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(t=shaka.net.NetworkingEngine.RequestType.SEGMENT,r=i.networkingEngine_.request(t,e),a=function(){return r.abort()},i.abortCallbacks_.push(a),o.yield(r.promise,2)):(n=o.yieldResult,shaka.util.ArrayUtils.remove(i.abortCallbacks_,a),o.return(n.data))}))},shaka.offline.indexeddb={},shaka.offline.indexeddb.DBOperation=function(e,t){var r=this;this.transaction_=e,this.store_=e.objectStore(t),this.promise_=new shaka.util.PublicPromise,e.onabort=function(e){e.preventDefault(),r.promise_.reject()},e.onerror=function(e){e.preventDefault(),r.promise_.reject()},e.oncomplete=function(e){r.promise_.resolve()}},shaka.offline.indexeddb.DBOperation.prototype.abort=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress){try{e.transaction_.abort()}catch(e){}return t.setCatchFinallyBlocks(2),t.yield(e.promise_,4)}if(2!=t.nextAddress)return t.leaveTryBlock(0);t.enterCatchBlock(),t.jumpToEnd()}))},shaka.offline.indexeddb.DBOperation.prototype.forEachEntry=function(e){var t=this;return new Promise((function(r,a){var n=t.store_.openCursor();n.onerror=a,n.onsuccess=function(t){var a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return null==n.result?(r(),t.return()):(a=n.result,t.yield(e(a.key,a.value,a),2));a.continue(),t.jumpToEnd()}))}}))},shaka.offline.indexeddb.DBOperation.prototype.store=function(){return this.store_};shaka.offline.indexeddb.DBOperation.prototype.promise=function(){return this.promise_},shaka.offline.indexeddb.DBConnection=function(e){this.connection_=e,this.pending_=[]},shaka.offline.indexeddb.DBConnection.prototype.destroy=function(){return Promise.all(this.pending_.map((function(e){return e.abort()})))},shaka.offline.indexeddb.DBConnection.prototype.startReadOnlyOperation=function(e){return this.startOperation_(e,"readonly")},shaka.offline.indexeddb.DBConnection.prototype.startReadWriteOperation=function(e){return this.startOperation_(e,"readwrite")},shaka.offline.indexeddb.DBConnection.prototype.startOperation_=function(e,t){var r=this;t=this.connection_.transaction([e],t);var a=new shaka.offline.indexeddb.DBOperation(t,e);return this.pending_.push(a),a.promise().then((function(){return r.stopTracking_(a)}),(function(){return r.stopTracking_(a)})),a},shaka.offline.indexeddb.DBConnection.prototype.stopTracking_=function(e){shaka.util.ArrayUtils.remove(this.pending_,e)},shaka.offline.indexeddb.BaseStorageCell=function(e,t,r){this.connection_=new shaka.offline.indexeddb.DBConnection(e),this.segmentStore_=t,this.manifestStore_=r},shaka.offline.indexeddb.BaseStorageCell.prototype.destroy=function(){return this.connection_.destroy()},shaka.offline.indexeddb.BaseStorageCell.prototype.hasFixedKeySpace=function(){return!0},shaka.offline.indexeddb.BaseStorageCell.prototype.addSegments=function(e){return this.rejectAdd(this.segmentStore_)},shaka.offline.indexeddb.BaseStorageCell.prototype.removeSegments=function(e,t){return this.remove_(this.segmentStore_,e,t)},shaka.offline.indexeddb.BaseStorageCell.prototype.getSegments=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?a.yield(r.get_(r.segmentStore_,e),2):(t=a.yieldResult,a.return(t.map((function(e){return r.convertSegmentData(e)}))))}))},shaka.offline.indexeddb.BaseStorageCell.prototype.addManifests=function(e){return this.rejectAdd(this.manifestStore_)},shaka.offline.indexeddb.BaseStorageCell.prototype.updateManifest=function(e,t){return this.rejectUpdate(this.manifestStore_)},shaka.offline.indexeddb.BaseStorageCell.prototype.updateManifestImplementation=function(e,t){var r=this.connection_.startReadWriteOperation(this.manifestStore_),a=r.store();return a.get(e).onsuccess=function(r){a.put(t,e)},r.promise()},shaka.offline.indexeddb.BaseStorageCell.prototype.updateManifestExpiration=function(e,t){var r=this.connection_.startReadWriteOperation(this.manifestStore_),a=r.store();return a.get(e).onsuccess=function(r){(r=r.target.result)&&(r.expiration=t,a.put(r,e))},r.promise()},shaka.offline.indexeddb.BaseStorageCell.prototype.removeManifests=function(e,t){return this.remove_(this.manifestStore_,e,t)},shaka.offline.indexeddb.BaseStorageCell.prototype.getManifests=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?a.yield(r.get_(r.manifestStore_,e),2):(t=a.yieldResult,a.return(Promise.all(t.map((function(e){return r.convertManifest(e)})))))}))},shaka.offline.indexeddb.BaseStorageCell.prototype.getAllManifests=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(e=r.connection_.startReadOnlyOperation(r.manifestStore_),t=new Map,a.yield(e.forEachEntry((function(e,a){var n;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){if(1==i.nextAddress)return i.yield(r.convertManifest(a),2);n=i.yieldResult,t.set(e,n),i.jumpToEnd()}))})),2)):3!=a.nextAddress?a.yield(e.promise(),3):a.return(t)}))},shaka.offline.indexeddb.BaseStorageCell.prototype.convertSegmentData=function(e){return e},shaka.offline.indexeddb.BaseStorageCell.prototype.convertManifest=function(e){return Promise.resolve(e)},shaka.offline.indexeddb.BaseStorageCell.prototype.rejectAdd=function(e){return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.NEW_KEY_OPERATION_NOT_SUPPORTED,"Cannot add new value to "+e))},shaka.offline.indexeddb.BaseStorageCell.prototype.rejectUpdate=function(e){return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MODIFY_OPERATION_NOT_SUPPORTED,"Cannot modify values in "+e))},shaka.offline.indexeddb.BaseStorageCell.prototype.add=function(e,t){var r,a,n,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r=u.connection_.startReadWriteOperation(e),a=r.store(),n=[],i={},o=$jscomp.makeIterator(t),s=o.next();!s.done;i={$jscomp$loop$prop$request$683:i.$jscomp$loop$prop$request$683},s=o.next())l=s.value,i.$jscomp$loop$prop$request$683=a.add(l),i.$jscomp$loop$prop$request$683.onsuccess=function(e){return function(t){n.push(e.$jscomp$loop$prop$request$683.result)}}(i);return c.yield(r.promise(),2)}return c.return(n)}))},shaka.offline.indexeddb.BaseStorageCell.prototype.remove_=function(e,t,r){for(var a=(e=this.connection_.startReadWriteOperation(e)).store(),n={},i=(t=$jscomp.makeIterator(t)).next();!i.done;n={$jscomp$loop$prop$key$685:n.$jscomp$loop$prop$key$685},i=t.next())n.$jscomp$loop$prop$key$685=i.value,a.delete(n.$jscomp$loop$prop$key$685).onsuccess=function(e){return function(){return r(e.$jscomp$loop$prop$key$685)}}(n);return e.promise()},shaka.offline.indexeddb.BaseStorageCell.prototype.get_=function(e,t){var r,a,n,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r=u.connection_.startReadOnlyOperation(e),a=r.store(),n={},i=[],o={},s=$jscomp.makeIterator(t),l=s.next();!l.done;o={$jscomp$loop$prop$request$687:o.$jscomp$loop$prop$request$687,$jscomp$loop$prop$key$688:o.$jscomp$loop$prop$key$688},l=s.next())o.$jscomp$loop$prop$key$688=l.value,o.$jscomp$loop$prop$request$687=a.get(o.$jscomp$loop$prop$key$688),o.$jscomp$loop$prop$request$687.onsuccess=function(e){return function(){null==e.$jscomp$loop$prop$request$687.result&&i.push(e.$jscomp$loop$prop$key$688),n[e.$jscomp$loop$prop$key$688]=e.$jscomp$loop$prop$request$687.result}}(o);return c.yield(r.promise(),2)}if(i.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+i);return c.return(t.map((function(e){return n[e]})))}))},shaka.offline.indexeddb.EmeSessionStorageCell=function(e,t){this.connection_=new shaka.offline.indexeddb.DBConnection(e),this.store_=t},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.destroy=function(){return this.connection_.destroy()},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.getAll=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(e=r.connection_.startReadOnlyOperation(r.store_),t=[],a.yield(e.forEachEntry((function(e,r){t.push(r)})),2)):3!=a.nextAddress?a.yield(e.promise(),3):a.return(t)}))},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.add=function(e){for(var t=this.connection_.startReadWriteOperation(this.store_),r=t.store(),a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())r.add(a.value);return t.promise()},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.remove=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(t=r.connection_.startReadWriteOperation(r.store_),a.yield(t.forEachEntry((function(t,r,a){e.includes(r.sessionId)&&a.delete()})),2)):a.yield(t.promise(),0)}))},shaka.offline.StorageCellHandle={},shaka.offline.StorageCellPath={},shaka.offline.StorageMuxer=function(){this.mechanisms_=new Map},shaka.offline.StorageMuxer.prototype.destroy=function(){for(var e=[],t=$jscomp.makeIterator(this.mechanisms_.values()),r=t.next();!r.done;r=t.next())e.push(r.value.destroy());return this.mechanisms_.clear(),Promise.all(e)},shaka.offline.StorageMuxer.prototype.init=function(){var e=this;shaka.offline.StorageMuxer.getRegistry_().forEach((function(t,r){(t=t())?e.mechanisms_.set(r,t):shaka.log.info("Skipping "+r+" as it is not supported on this platform")}));for(var t=[],r=$jscomp.makeIterator(this.mechanisms_.values()),a=r.next();!a.done;a=r.next())t.push(a.value.init());return Promise.all(t)},shaka.offline.StorageMuxer.prototype.getActive=function(){var e=null;if(this.mechanisms_.forEach((function(t,r){t.getCells().forEach((function(t,a){t.hasFixedKeySpace()||e||(e={path:{mechanism:r,cell:a},cell:t})}))})),e)return e;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MISSING_STORAGE_CELL,"Could not find a cell that supports add-operations")},shaka.offline.StorageMuxer.prototype.forEachCell=function(e){this.mechanisms_.forEach((function(t,r){t.getCells().forEach((function(t,a){e({mechanism:r,cell:a},t)}))}))},shaka.offline.StorageMuxer.prototype.getCell=function(e,t){var r=this.mechanisms_.get(e);if(!r)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MISSING_STORAGE_CELL,"Could not find mechanism with name "+e);if(!(e=r.getCells().get(t)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MISSING_STORAGE_CELL,"Could not find cell with name "+t);return e},shaka.offline.StorageMuxer.prototype.forEachEmeSessionCell=function(e){this.mechanisms_.forEach((function(t,r){e(t.getEmeSessionCell())}))},shaka.offline.StorageMuxer.prototype.getEmeSessionCell=function(){var e=Array.from(this.mechanisms_.keys());if(!e.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.STORAGE_NOT_SUPPORTED,"No supported storage mechanisms found");return this.mechanisms_.get(e[0]).getEmeSessionCell()},shaka.offline.StorageMuxer.prototype.resolvePath=function(e){var t=this.mechanisms_.get(e.mechanism);return t?t.getCells().get(e.cell):null},shaka.offline.StorageMuxer.prototype.erase=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(e=Array.from(r.mechanisms_.values()),(t=0<e.length)||shaka.offline.StorageMuxer.getRegistry_().forEach((function(t,r){(t=t())&&e.push(t)})),a.yield(Promise.all(e.map((function(e){return e.erase()}))),2)):t?a.jumpTo(0):a.yield(Promise.all(e.map((function(e){return e.destroy()}))),0)}))},shaka.offline.StorageMuxer.register=function(e,t){shaka.offline.StorageMuxer.registry_.set(e,t)},shaka.offline.StorageMuxer.unregister=function(e){shaka.offline.StorageMuxer.registry_.delete(e)},shaka.offline.StorageMuxer.support=function(){for(var e=shaka.offline.StorageMuxer.getRegistry_(),t=(e=$jscomp.makeIterator(e.values())).next();!t.done;t=e.next())if(t=(t=t.value)())return t.destroy(),!0;return!1},shaka.offline.StorageMuxer.overrideSupport=function(e){shaka.offline.StorageMuxer.override_=e},shaka.offline.StorageMuxer.clearOverride=function(){shaka.offline.StorageMuxer.override_=null},shaka.offline.StorageMuxer.getRegistry_=function(){var e=shaka.offline.StorageMuxer.override_,t=shaka.offline.StorageMuxer.registry_;return COMPILED?t:e||t},goog.exportSymbol("shaka.offline.StorageMuxer",shaka.offline.StorageMuxer),goog.exportProperty(shaka.offline.StorageMuxer,"unregister",shaka.offline.StorageMuxer.unregister),goog.exportProperty(shaka.offline.StorageMuxer,"register",shaka.offline.StorageMuxer.register),goog.exportProperty(shaka.offline.StorageMuxer.prototype,"destroy",shaka.offline.StorageMuxer.prototype.destroy),shaka.offline.StorageMuxer.override_=null,shaka.offline.StorageMuxer.registry_=new Map,shaka.offline.indexeddb.V1StorageCell=function(){shaka.offline.indexeddb.BaseStorageCell.apply(this,arguments)},$jscomp.inherits(shaka.offline.indexeddb.V1StorageCell,shaka.offline.indexeddb.BaseStorageCell),shaka.offline.indexeddb.V1StorageCell.prototype.updateManifestExpiration=function(e,t){var r,a,n,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return r=i.connection_.startReadWriteOperation(i.manifestStore_),a=r.store(),n=new shaka.util.PublicPromise,a.get(e).onsuccess=function(r){(r=r.target.result)?(goog.asserts.assert(r.key==e,"With in-line keys, the keys should match"),r.expiration=t,a.put(r),n.resolve()):n.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+e))},o.yield(Promise.all([r.promise(),n]),0)}))},shaka.offline.indexeddb.V1StorageCell.prototype.convertManifest=function(e){var t,r,a,n,i,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress){for(t=shaka.offline.indexeddb.V1StorageCell,r=[],a=0;a<e.periods.length;++a)n=a==e.periods.length-1?e.duration:e.periods[a+1].startTime,i=n-e.periods[a].startTime,o=t.convertPeriod_(e.periods[a],i),r.push(o);return l.yield(shaka.util.PeriodCombiner.combineDbStreams(r),2)}return s=l.yieldResult,l.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:s,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})}))},shaka.offline.indexeddb.V1StorageCell.convertPeriod_=function(e,t){var r=shaka.offline.indexeddb.V1StorageCell;r.fillMissingVariants_(e);for(var a=$jscomp.makeIterator(e.streams),n=a.next();!n.done;n=a.next())goog.asserts.assert(n.value.variantIds,"After filling in missing variants, each stream should have variant ids");return e.streams.map((function(a){return r.convertStream_(a,e.startTime,t)}))},shaka.offline.indexeddb.V1StorageCell.convertStream_=function(e,t,r){var a=shaka.offline.indexeddb.V1StorageCell,n=e.initSegmentUri?a.getKeyFromSegmentUri_(e.initSegmentUri):null,i=t+e.presentationTimeOffset,o=t+r;return{id:e.id,originalId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:n,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(e){return a.convertSegment_(e,n,t,o,i)})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}},shaka.offline.indexeddb.V1StorageCell.convertSegment_=function(e,t,r,a,n){var i=shaka.offline.indexeddb.V1StorageCell.getKeyFromSegmentUri_(e.uri);return{startTime:r+e.startTime,endTime:r+e.endTime,dataKey:i,initSegmentKey:t,appendWindowStart:r,appendWindowEnd:a,timestampOffset:n,tilesLayout:""}},shaka.offline.indexeddb.V1StorageCell.prototype.convertSegmentData=function(e){return{data:e.data}},shaka.offline.indexeddb.V1StorageCell.getKeyFromSegmentUri_=function(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,"Could not parse uri "+e)},shaka.offline.indexeddb.V1StorageCell.fillMissingVariants_=function(e){var t=shaka.util.ManifestParserUtils.ContentType.AUDIO,r=shaka.util.ManifestParserUtils.ContentType.VIDEO,a=e.streams.filter((function(e){return e.contentType==t}));if(e=e.streams.filter((function(e){return e.contentType==r})),!a.every((function(e){return e.variantIds}))||!e.every((function(e){return e.variantIds}))){goog.asserts.assert(a.every((function(e){return!e.variantIds})),"Some audio streams have variant ids and some do not."),goog.asserts.assert(e.every((function(e){return!e.variantIds})),"Some video streams have variant ids and some do not.");for(var n=$jscomp.makeIterator(a),i=n.next();!i.done;i=n.next())i.value.variantIds=[];for(i=(n=$jscomp.makeIterator(e)).next();!i.done;i=n.next())i.value.variantIds=[];if(n=0,e.length&&!a.length){shaka.log.debug("Found video-only content. Creating variants for video.");var o=n++,s=$jscomp.makeIterator(e);for(i=s.next();!i.done;i=s.next())i.value.variantIds.push(o)}if(!e.length&&a.length)for(shaka.log.debug("Found audio-only content. Creating variants for audio."),o=n++,i=(s=$jscomp.makeIterator(a)).next();!i.done;i=s.next())i.value.variantIds.push(o);if(e.length&&a.length)for(shaka.log.debug("Found audio-video content. Creating variants."),i=(a=$jscomp.makeIterator(a)).next();!i.done;i=a.next())for(i=i.value,s=(o=$jscomp.makeIterator(e)).next();!s.done;s=o.next()){s=s.value;var l=n++;i.variantIds.push(l),s.variantIds.push(l)}}},shaka.offline.indexeddb.V2StorageCell=function(){shaka.offline.indexeddb.BaseStorageCell.apply(this,arguments)},$jscomp.inherits(shaka.offline.indexeddb.V2StorageCell,shaka.offline.indexeddb.BaseStorageCell),shaka.offline.indexeddb.V2StorageCell.prototype.convertManifest=function(e){var t,r,a,n,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress){for(t=[],r=0;r<e.periods.length;++r)a=r==e.periods.length-1?e.duration:e.periods[r+1].startTime,n=a-e.periods[r].startTime,i=s.convertPeriod_(e.periods[r],n),t.push(i);return l.yield(shaka.util.PeriodCombiner.combineDbStreams(t),2)}return o=l.yieldResult,l.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:o,sequenceMode:!1})}))},shaka.offline.indexeddb.V2StorageCell.prototype.convertPeriod_=function(e,t){for(var r=[],a=$jscomp.makeIterator(e.streams),n=a.next();!n.done;n=a.next())0!=(n=n.value).variantIds.length&&r.push(this.convertStream_(n,e.startTime,e.startTime+t));return r},shaka.offline.indexeddb.V2StorageCell.prototype.convertStream_=function(e,t,r){var a=this;return{id:e.id,originalId:e.originalId,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(n){return a.convertSegment_(n,e.initSegmentKey,t,r,e.presentationTimeOffset)})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}},shaka.offline.indexeddb.V2StorageCell.prototype.convertSegment_=function(e,t,r,a,n){return{startTime:r+e.startTime,endTime:r+e.endTime,initSegmentKey:t,appendWindowStart:r,appendWindowEnd:a,timestampOffset:r-n,dataKey:e.dataKey,tilesLayout:""}},shaka.offline.indexeddb.V5StorageCell=function(){shaka.offline.indexeddb.BaseStorageCell.apply(this,arguments)},$jscomp.inherits(shaka.offline.indexeddb.V5StorageCell,shaka.offline.indexeddb.BaseStorageCell),shaka.offline.indexeddb.V5StorageCell.prototype.hasFixedKeySpace=function(){return!1},shaka.offline.indexeddb.V5StorageCell.prototype.addSegments=function(e){return this.add(this.segmentStore_,e)},shaka.offline.indexeddb.V5StorageCell.prototype.addManifests=function(e){return this.add(this.manifestStore_,e)},shaka.offline.indexeddb.V5StorageCell.prototype.updateManifest=function(e,t){return this.updateManifestImplementation(e,t)},shaka.offline.indexeddb.V5StorageCell.prototype.convertManifest=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},shaka.offline.indexeddb.StorageMechanism=function(){this.sessions_=this.v5_=this.v3_=this.v2_=this.v1_=this.db_=null},shaka.offline.indexeddb.StorageMechanism.prototype.init=function(){var e=this,t=shaka.offline.indexeddb.StorageMechanism.DB_NAME,r=shaka.offline.indexeddb.StorageMechanism.VERSION,a=new shaka.util.PublicPromise,n=!1,i=new shaka.util.Timer((function(){n=!0,a.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.INDEXED_DB_INIT_TIMED_OUT))}));i.tickAfter(5);var o=window.indexedDB.open(t,r);return o.onsuccess=function(t){n||(t=o.result,e.db_=t,e.v1_=shaka.offline.indexeddb.StorageMechanism.createV1_(t),e.v2_=shaka.offline.indexeddb.StorageMechanism.createV2_(t),e.v3_=shaka.offline.indexeddb.StorageMechanism.createV3_(t),e.v5_=shaka.offline.indexeddb.StorageMechanism.createV5_(t),e.sessions_=shaka.offline.indexeddb.StorageMechanism.createEmeSessionCell_(t),i.stop(),a.resolve())},o.onupgradeneeded=function(t){e.createStores_(o.result)},o.onerror=function(e){n||(a.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.INDEXED_DB_ERROR,o.error)),i.stop(),e.preventDefault())},a},shaka.offline.indexeddb.StorageMechanism.prototype.destroy=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:if(!e.v1_){t.jumpTo(2);break}return t.yield(e.v1_.destroy(),2);case 2:if(!e.v2_){t.jumpTo(4);break}return t.yield(e.v2_.destroy(),4);case 4:if(!e.v3_){t.jumpTo(6);break}return t.yield(e.v3_.destroy(),6);case 6:if(!e.v5_){t.jumpTo(8);break}return t.yield(e.v5_.destroy(),8);case 8:if(!e.sessions_){t.jumpTo(10);break}return t.yield(e.sessions_.destroy(),10);case 10:e.db_&&e.db_.close(),t.jumpToEnd()}}))},shaka.offline.indexeddb.StorageMechanism.prototype.getCells=function(){var e=new Map;return this.v1_&&e.set("v1",this.v1_),this.v2_&&e.set("v2",this.v2_),this.v3_&&e.set("v3",this.v3_),this.v5_&&e.set("v5",this.v5_),e},shaka.offline.indexeddb.StorageMechanism.prototype.getEmeSessionCell=function(){return goog.asserts.assert(this.sessions_,"Cannot be destroyed."),this.sessions_},shaka.offline.indexeddb.StorageMechanism.prototype.erase=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:if(!e.v1_){t.jumpTo(2);break}return t.yield(e.v1_.destroy(),2);case 2:if(!e.v2_){t.jumpTo(4);break}return t.yield(e.v2_.destroy(),4);case 4:if(!e.v3_){t.jumpTo(6);break}return t.yield(e.v3_.destroy(),6);case 6:if(!e.v5_){t.jumpTo(8);break}return t.yield(e.v5_.destroy(),8);case 8:return e.db_&&e.db_.close(),t.yield(shaka.offline.indexeddb.StorageMechanism.deleteAll_(),10);case 10:return e.db_=null,e.v1_=null,e.v2_=null,e.v3_=null,e.v5_=null,t.yield(e.init(),0)}}))},shaka.offline.indexeddb.StorageMechanism.createV1_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V1_SEGMENT_STORE;t=t.V1_MANIFEST_STORE;var a=e.objectStoreNames;return a.contains(t)&&a.contains(r)?(shaka.log.debug("Mounting v1 idb storage cell"),new shaka.offline.indexeddb.V1StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createV2_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V2_SEGMENT_STORE;t=t.V2_MANIFEST_STORE;var a=e.objectStoreNames;return a.contains(t)&&a.contains(r)?(shaka.log.debug("Mounting v2 idb storage cell"),new shaka.offline.indexeddb.V2StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createV3_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V3_SEGMENT_STORE;t=t.V3_MANIFEST_STORE;var a=e.objectStoreNames;return a.contains(t)&&a.contains(r)?(shaka.log.debug("Mounting v3 idb storage cell"),new shaka.offline.indexeddb.V2StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createV5_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V5_SEGMENT_STORE;t=t.V5_MANIFEST_STORE;var a=e.objectStoreNames;return a.contains(t)&&a.contains(r)?(shaka.log.debug("Mounting v5 idb storage cell"),new shaka.offline.indexeddb.V5StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createEmeSessionCell_=function(e){var t=shaka.offline.indexeddb.StorageMechanism.SESSION_ID_STORE;return e.objectStoreNames.contains(t)?(shaka.log.debug("Mounting session ID idb storage cell"),new shaka.offline.indexeddb.EmeSessionStorageCell(e,t)):null},shaka.offline.indexeddb.StorageMechanism.prototype.createStores_=function(e){for(var t=$jscomp.makeIterator([shaka.offline.indexeddb.StorageMechanism.V5_SEGMENT_STORE,shaka.offline.indexeddb.StorageMechanism.V5_MANIFEST_STORE,shaka.offline.indexeddb.StorageMechanism.SESSION_ID_STORE]),r=t.next();!r.done;r=t.next())r=r.value,e.objectStoreNames.contains(r)||e.createObjectStore(r,{autoIncrement:!0})},shaka.offline.indexeddb.StorageMechanism.deleteAll_=function(){var e=shaka.offline.indexeddb.StorageMechanism.DB_NAME,t=new shaka.util.PublicPromise,r=window.indexedDB.deleteDatabase(e);return r.onblocked=function(t){shaka.log.warning("Deleting",e,"is being blocked",t)},r.onsuccess=function(e){t.resolve()},r.onerror=function(e){t.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.INDEXED_DB_ERROR,r.error)),e.preventDefault()},t},shaka.offline.indexeddb.StorageMechanism.DB_NAME="shaka_offline_db",shaka.offline.indexeddb.StorageMechanism.VERSION=5,shaka.offline.indexeddb.StorageMechanism.V1_SEGMENT_STORE="segment",shaka.offline.indexeddb.StorageMechanism.V2_SEGMENT_STORE="segment-v2",shaka.offline.indexeddb.StorageMechanism.V3_SEGMENT_STORE="segment-v3",shaka.offline.indexeddb.StorageMechanism.V5_SEGMENT_STORE="segment-v5",shaka.offline.indexeddb.StorageMechanism.V1_MANIFEST_STORE="manifest",shaka.offline.indexeddb.StorageMechanism.V2_MANIFEST_STORE="manifest-v2",shaka.offline.indexeddb.StorageMechanism.V3_MANIFEST_STORE="manifest-v3",shaka.offline.indexeddb.StorageMechanism.V5_MANIFEST_STORE="manifest-v5",shaka.offline.indexeddb.StorageMechanism.SESSION_ID_STORE="session-ids",shaka.offline.StorageMuxer.register("idb",(function(){return shaka.util.Platform.isChromecast()||shaka.util.Platform.isXboxOne()||!window.indexedDB?null:new shaka.offline.indexeddb.StorageMechanism})),shaka.offline.OfflineUri=function(e,t,r,a){this.type_=e,this.mechanism_=t,this.cell_=r,this.key_=a,this.asString_=["offline:",e,"/",t,"/",r,"/",a].join("")},shaka.offline.OfflineUri.prototype.isManifest=function(){return"manifest"==this.type_},shaka.offline.OfflineUri.prototype.isSegment=function(){return"segment"==this.type_},shaka.offline.OfflineUri.prototype.mechanism=function(){return this.mechanism_},shaka.offline.OfflineUri.prototype.cell=function(){return this.cell_},shaka.offline.OfflineUri.prototype.key=function(){return this.key_},shaka.offline.OfflineUri.prototype.toString=function(){return this.asString_},shaka.offline.OfflineUri.parse=function(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var r=e[2];if(!r)return null;var a=e[3];return a&&null!=t?new shaka.offline.OfflineUri(t,r,a,Number(e[4])):null},shaka.offline.OfflineUri.manifest=function(e,t,r){return new shaka.offline.OfflineUri("manifest",e,t,r)},shaka.offline.OfflineUri.segment=function(e,t,r){return new shaka.offline.OfflineUri("segment",e,t,r)},shaka.offline.ManifestConverter=function(e,t){this.mechanism_=e,this.cell_=t},shaka.offline.ManifestConverter.prototype.fromManifestDB=function(e){var t=this,r=new shaka.media.PresentationTimeline(null,0);r.setDuration(e.duration);var a=e.streams.filter((function(e){return t.isAudio_(e)})),n=e.streams.filter((function(e){return t.isVideo_(e)}));a=this.createVariants(a,n,r),n=e.streams.filter((function(e){return t.isText_(e)})).map((function(e){return t.fromStreamDB_(e,r)}));var i=e.streams.filter((function(e){return t.isImage_(e)})).map((function(e){return t.fromStreamDB_(e,r)})),o=e.drmInfo?[e.drmInfo]:[];if(e.drmInfo)for(var s=$jscomp.makeIterator(a.values()),l=s.next();!l.done;l=s.next())(l=l.value).audio&&l.audio.encrypted&&(l.audio.drmInfos=o),l.video&&l.video.encrypted&&(l.video.drmInfos=o);return{presentationTimeline:r,minBufferTime:2,offlineSessionIds:e.sessionIds,variants:Array.from(a.values()),textStreams:n,imageStreams:i,sequenceMode:e.sequenceMode||!1}},shaka.offline.ManifestConverter.prototype.createVariants=function(e,t,r){for(var a=new Set,n=$jscomp.makeIterator(e),i=n.next();!i.done;i=n.next()){var o=$jscomp.makeIterator(i.value.variantIds);for(i=o.next();!i.done;i=o.next())a.add(i.value)}for(i=(n=$jscomp.makeIterator(t)).next();!i.done;i=n.next())for(i=(o=$jscomp.makeIterator(i.value.variantIds)).next();!i.done;i=o.next())a.add(i.value);for(n=new Map,i=(a=$jscomp.makeIterator(a)).next();!i.done;i=a.next())i=i.value,n.set(i,this.createEmptyVariant_(i));for(a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())for(a=a.value,i=this.fromStreamDB_(a,r),a=(o=$jscomp.makeIterator(a.variantIds)).next();!a.done;a=o.next())a=n.get(a.value),goog.asserts.assert(!a.audio,"A variant should only have one audio stream"),a.language=i.language,a.primary=a.primary||i.primary,a.audio=i;for(e=(t=$jscomp.makeIterator(t)).next();!e.done;e=t.next())for(a=e.value,e=this.fromStreamDB_(a,r),a=(i=$jscomp.makeIterator(a.variantIds)).next();!a.done;a=i.next())a=n.get(a.value),goog.asserts.assert(!a.video,"A variant should only have one video stream"),a.primary=a.primary||e.primary,a.video=e;return n},shaka.offline.ManifestConverter.prototype.fromStreamDB_=function(e,t){var r=this,a=e.segments.map((function(e,t){return r.fromSegmentDB_(t,e)}));return t.notifySegments(a),t=new shaka.media.SegmentIndex(a),{id:e.id,originalId:e.originalId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:t,mimeType:e.mimeType,codecs:e.codecs,width:e.width||void 0,height:e.height||void 0,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:e.hdr,kind:e.kind,encrypted:e.encrypted,drmInfos:[],keyIds:e.keyIds,language:e.language,label:e.label,type:e.type,primary:e.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:e.roles,forced:e.forced,channelsCount:e.channelsCount,audioSamplingRate:e.audioSamplingRate,spatialAudio:e.spatialAudio,closedCaptions:e.closedCaptions,tilesLayout:e.tilesLayout}},shaka.offline.ManifestConverter.prototype.fromSegmentDB_=function(e,t){var r=shaka.offline.OfflineUri.segment(this.mechanism_,this.cell_,t.dataKey);return e=null!=t.initSegmentKey?this.fromInitSegmentDB_(t.initSegmentKey):null,new shaka.media.SegmentReference(t.startTime,t.endTime,(function(){return[r.toString()]}),0,null,e,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||"")},shaka.offline.ManifestConverter.prototype.fromInitSegmentDB_=function(e){var t=shaka.offline.OfflineUri.segment(this.mechanism_,this.cell_,e);return new shaka.media.InitSegmentReference((function(){return[t.toString()]}),0,null)},shaka.offline.ManifestConverter.prototype.isAudio_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.AUDIO},shaka.offline.ManifestConverter.prototype.isVideo_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.VIDEO},shaka.offline.ManifestConverter.prototype.isText_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.TEXT},shaka.offline.ManifestConverter.prototype.isImage_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.IMAGE},shaka.offline.ManifestConverter.prototype.createEmptyVariant_=function(e){return{id:e,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}},shaka.offline.OfflineManifestParser=function(){this.uri_=null},shaka.offline.OfflineManifestParser.prototype.configure=function(e){},shaka.offline.OfflineManifestParser.prototype.start=function(e,t){var r,a,n,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:if(r=shaka.offline.OfflineUri.parse(e),u.uri_=r,null==r||!r.isManifest())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,e);return a=new shaka.offline.StorageMuxer,c.setFinallyBlock(2),c.yield(a.init(),4);case 4:return c.yield(a.getCell(r.mechanism(),r.cell()),5);case 5:return n=c.yieldResult,c.yield(n.getManifests([r.key()]),6);case 6:return i=c.yieldResult,o=i[0],s=new shaka.offline.ManifestConverter(r.mechanism(),r.cell()),l=s.fromManifestDB(o),t.makeTextStreamsForClosedCaptions(l),c.return(l);case 2:return c.enterFinallyBlock(),c.yield(a.destroy(),7);case 7:c.leaveFinallyBlock(0)}}))},shaka.offline.OfflineManifestParser.prototype.stop=function(){return Promise.resolve()},shaka.offline.OfflineManifestParser.prototype.update=function(){},shaka.offline.OfflineManifestParser.prototype.onExpirationUpdated=function(e,t){var r,a,n,i,o,s,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:return goog.asserts.assert(c.uri_,"Should not get update event before start has been called"),r=c.uri_,a=new shaka.offline.StorageMuxer,d.setCatchFinallyBlocks(2,3),d.yield(a.init(),5);case 5:return d.yield(a.getCell(r.mechanism(),r.cell()),6);case 6:return n=d.yieldResult,d.yield(n.getManifests([r.key()]),7);case 7:if(i=d.yieldResult,o=i[0],s=o.sessionIds.includes(e),l=null==o.expiration||o.expiration>t,!s||!l){d.jumpTo(3);break}return shaka.log.debug("Updating expiration for stored content"),d.yield(n.updateManifestExpiration(r.key(),t),3);case 3:return d.enterFinallyBlock(),d.yield(a.destroy(),10);case 10:d.leaveFinallyBlock(0);break;case 2:u=d.enterCatchBlock(),shaka.log.error("There was an error updating",r,u),d.jumpTo(3)}}))},shaka.media.ManifestParser.registerParserByMime("application/x-offline-manifest",(function(){return new shaka.offline.OfflineManifestParser})),shaka.offline.OfflineScheme=function(){},shaka.offline.OfflineScheme.plugin=function(e,t,r,a){return(t=shaka.offline.OfflineUri.parse(e))&&t.isManifest()?shaka.offline.OfflineScheme.getManifest_(e):t&&t.isSegment()?shaka.offline.OfflineScheme.getSegment_(t.key(),t):shaka.util.AbortableOperation.failed(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,e))},shaka.offline.OfflineScheme.getManifest_=function(e){return e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}},shaka.util.AbortableOperation.completed(e)},shaka.offline.OfflineScheme.getSegment_=function(e,t){goog.asserts.assert(t.isSegment(),"Only segment uri's should be given to getSegment");var r=new shaka.offline.StorageMuxer;return shaka.util.AbortableOperation.completed(void 0).chain((function(){return r.init()})).chain((function(){return r.getCell(t.mechanism(),t.cell())})).chain((function(e){return e.getSegments([t.key()])})).chain((function(e){return{uri:t,data:e[0].data,headers:{}}})).finally((function(){return r.destroy()}))},goog.exportSymbol("shaka.offline.OfflineScheme",shaka.offline.OfflineScheme),goog.exportProperty(shaka.offline.OfflineScheme,"plugin",shaka.offline.OfflineScheme.plugin),shaka.net.NetworkingEngine.registerScheme("offline",shaka.offline.OfflineScheme.plugin),shaka.offline.SessionDeleter=function(){},shaka.offline.SessionDeleter.prototype.delete=function(e,t,r){var a,n,i,o,s,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:a=shaka.offline.SessionDeleter,n=[],i=$jscomp.makeIterator(a.createBuckets_(r)),o=i.next();case 2:if(o.done){d.jumpTo(4);break}return s=o.value,l=c.doDelete_(e,t,s),d.yield(l,5);case 5:u=d.yieldResult,n=n.concat(u),o=i.next(),d.jumpTo(2);break;case 4:return d.return(n)}}))},shaka.offline.SessionDeleter.prototype.doDelete_=function(e,t,r){var a,n,i,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:return a=new shaka.media.DrmEngine({netEngine:t,onError:function(){},onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),s.setCatchFinallyBlocks(2),a.configure(e),s.yield(a.initForRemoval(r.info.keySystem,r.info.licenseUri,r.info.serverCertificate,r.info.audioCapabilities,r.info.videoCapabilities),4);case 4:s.leaveTryBlock(3);break;case 2:return n=s.enterCatchBlock(),shaka.log.warning("Error initializing EME",n),s.yield(a.destroy(),5);case 5:return s.return([]);case 3:return s.setCatchFinallyBlocks(6),s.yield(a.setServerCertificate(),8);case 8:s.leaveTryBlock(7);break;case 6:return i=s.enterCatchBlock(),shaka.log.warning("Error setting server certificate",i),s.yield(a.destroy(),9);case 9:return s.return([]);case 7:return o=[],s.yield(Promise.all(r.sessionIds.map((function(e){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(r.setCatchFinallyBlocks(2),r.yield(a.removeSession(e),4)):2!=r.nextAddress?(o.push(e),r.leaveTryBlock(0)):(t=r.enterCatchBlock(),shaka.log.warning("Error deleting offline session",t),void r.jumpToEnd())}))}))),10);case 10:return s.yield(a.destroy(),11);case 11:return s.return(o)}}))},shaka.offline.SessionDeleter.createBuckets_=function(e){for(var t=shaka.offline.SessionDeleter,r=[],a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){a=a.value;for(var n=!1,i=$jscomp.makeIterator(r),o=i.next();!o.done;o=i.next())if(o=o.value,t.isCompatible_(o.info,a)){o.sessionIds.push(a.sessionId),n=!0;break}n||r.push({info:a,sessionIds:[a.sessionId]})}return r},shaka.offline.SessionDeleter.isCompatible_=function(e,t){var r=shaka.util.ArrayUtils,a=function(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType};return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&r.hasSameElements(e.audioCapabilities,t.audioCapabilities,a)&&r.hasSameElements(e.videoCapabilities,t.videoCapabilities,a)},shaka.offline.StoredContentUtils=function(){},shaka.offline.StoredContentUtils.fromManifest=function(e,t,r,a){return goog.asserts.assert(t.variants.length,"Cannot create stored content from manifest with no variants."),{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.getDuration(),size:r,expiration:1/0,tracks:t=shaka.offline.StoredContentUtils.getTracks_(t),appMetadata:a,isIncomplete:!1}},shaka.offline.StoredContentUtils.fromManifestDB=function(e,t){goog.asserts.assert(t.streams.length,"Cannot create stored content from manifestDB with no streams.");var r=new shaka.offline.ManifestConverter(e.mechanism(),e.cell()).fromManifestDB(t),a=t.appMetadata||{};return r=shaka.offline.StoredContentUtils.getTracks_(r),goog.asserts.assert(null!=t.expiration,"Manifest expiration must be set by now!"),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:r,appMetadata:a,isIncomplete:t.isIncomplete||!1}},shaka.offline.StoredContentUtils.getTracks_=function(e){for(var t=shaka.util.StreamUtils,r=[],a=t.getPlayableVariants(e.variants),n=(a=$jscomp.makeIterator(a)).next();!n.done;n=a.next())r.push(t.variantToTrack(n.value));for(a=(e=$jscomp.makeIterator(e.textStreams)).next();!a.done;a=e.next())r.push(t.textStreamToTrack(a.value));return r},shaka.offline.StreamBandwidthEstimator=function(){this.estimateByStreamId_={}},shaka.offline.StreamBandwidthEstimator.prototype.addVariant=function(e){var t=e.audio,r=e.video;if(t&&!r&&this.setBitrate_(t.id,t.bandwidth||e.bandwidth),!t&&r&&this.setBitrate_(r.id,r.bandwidth||e.bandwidth),t&&r){var a=t.bandwidth||shaka.offline.StreamBandwidthEstimator.DEFAULT_AUDIO_BITRATE_,n=r.bandwidth||e.bandwidth-a;0>=n&&(shaka.log.warning("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),n=e.bandwidth),this.setBitrate_(t.id,a),this.setBitrate_(r.id,n)}},shaka.offline.StreamBandwidthEstimator.prototype.setBitrate_=function(e,t){this.estimateByStreamId_[e]=t},shaka.offline.StreamBandwidthEstimator.prototype.addText=function(e){this.estimateByStreamId_[e.id]=shaka.offline.StreamBandwidthEstimator.DEFAULT_TEXT_BITRATE_},shaka.offline.StreamBandwidthEstimator.prototype.addImage=function(e){this.estimateByStreamId_[e.id]=e.bandwidth||shaka.offline.StreamBandwidthEstimator.DEFAULT_IMAGE_BITRATE_},shaka.offline.StreamBandwidthEstimator.prototype.getSegmentEstimate=function(e,t){return t=t.endTime-t.startTime,this.getEstimate_(e)*t},shaka.offline.StreamBandwidthEstimator.prototype.getInitSegmentEstimate=function(e){return.5*this.getEstimate_(e)},shaka.offline.StreamBandwidthEstimator.prototype.getEstimate_=function(e){return null==(e=this.estimateByStreamId_[e])&&(e=0,shaka.log.error("Asking for bitrate of stream not given to the estimator")),0==e&&shaka.log.warning("Using bitrate of 0, this stream won't affect progress"),e},shaka.offline.StreamBandwidthEstimator.DEFAULT_AUDIO_BITRATE_=393216,shaka.offline.StreamBandwidthEstimator.DEFAULT_TEXT_BITRATE_=52,shaka.offline.StreamBandwidthEstimator.DEFAULT_IMAGE_BITRATE_=2048,shaka.offline.Storage=function(e){var t=this;if(e&&e.constructor!=shaka.Player)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.LOCAL_PLAYER_INSTANCE_REQUIRED);this.networkingEngine_=this.config_=null,e?(this.config_=e.getSharedConfiguration(),this.networkingEngine_=e.getNetworkingEngine(),goog.asserts.assert(this.networkingEngine_,"Storage should not be initialized with a player that had |destroy| called on it.")):(this.config_=shaka.util.PlayerConfiguration.createDefault(),this.networkingEngine_=new shaka.net.NetworkingEngine),this.openOperations_=[],this.openDownloadManagers_=[];var r=!e;this.destroyer_=new shaka.util.Destroyer((function(){var e,a,n,i,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:return s.yield(Promise.all(t.openDownloadManagers_.map((function(e){return e.abortAll()}))),2);case 2:for(e=function(){},a=[],n=$jscomp.makeIterator(t.openOperations_),i=n.next();!i.done;i=n.next())o=i.value,a.push(o.then(e,e));return s.yield(Promise.all(a),3);case 3:if(!r){s.jumpTo(4);break}return s.yield(t.networkingEngine_.destroy(),4);case 4:t.config_=null,t.networkingEngine_=null,s.jumpToEnd()}}))}))},shaka.offline.Storage.support=function(){return!!shaka.util.Platform.supportsMediaSource()&&shaka.offline.StorageMuxer.support()},shaka.offline.Storage.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.offline.Storage.prototype.configure=function(e,t){return goog.asserts.assert("object"==typeof e||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=shaka.util.ConfigUtils.convertToConfigObject(e,t)),goog.asserts.assert("object"==typeof e,"Should be an object!"),goog.asserts.assert(this.config_,"Cannot reconfigure storage after calling destroy."),shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,e)},shaka.offline.Storage.prototype.getConfiguration=function(){goog.asserts.assert(this.config_,"Config must not be null!");var e=shaka.util.PlayerConfiguration.createDefault();return shaka.util.PlayerConfiguration.mergeConfigObjects(e,this.config_,shaka.util.PlayerConfiguration.createDefault()),e},shaka.offline.Storage.prototype.getNetworkingEngine=function(){return this.networkingEngine_},shaka.offline.Storage.prototype.store=function(e,t,r){var a=this;goog.asserts.assert(this.networkingEngine_,"Cannot call |store| after calling |destroy|.");var n=this.getConfiguration(),i=new shaka.offline.DownloadManager(this.networkingEngine_);return this.openDownloadManagers_.push(i),t=this.store_(e,t||{},(function(){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(goog.asserts.assert(a.networkingEngine_,"Should not call |store| after |destroy|"),i.yield(shaka.media.ManifestParser.getFactory(e,a.networkingEngine_,n.manifest.retryParameters,r||null),2)):(t=i.yieldResult,i.return(t()))}))}),n,i),(t=new shaka.util.AbortableOperation(t,(function(){return i.abortAll()}))).finally((function(){shaka.util.ArrayUtils.remove(a.openDownloadManagers_,i)})),this.startAbortableOperation_(t)},shaka.offline.Storage.prototype.store_=function(e,t,r,a,n){var i,o,s,l,u,c,d,p,h,f,g,y,m,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:return v.requireSupport_(),o=i=null,s=new shaka.offline.StorageMuxer,c=u=l=null,_.setCatchFinallyBlocks(2,3),_.yield(r(),5);case 5:return i=_.yieldResult,_.yield(v.parseManifest(e,i,a),6);case 6:if(d=_.yieldResult,v.ensureNotDestroyed_(),!(!d.presentationTimeline.isLive()&&!d.presentationTimeline.isInProgress()))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.CANNOT_STORE_LIVE_OFFLINE,e);return _.yield(v.createDrmEngine(d,(function(e){c=c||e}),a),7);case 7:if(o=_.yieldResult,v.ensureNotDestroyed_(),c)throw c;return _.yield(v.filterManifest_(d,o,a),8);case 8:return _.yield(s.init(),9);case 9:return v.ensureNotDestroyed_(),_.yield(s.getActive(),10);case 10:return l=_.yieldResult,v.ensureNotDestroyed_(),goog.asserts.assert(o,"drmEngine should be non-null here."),p=v.makeManifestDB_(o,d,e,t,a,n),h=p.manifestDB,f=p.toDownload,_.yield(l.cell.addManifests([h]),11);case 11:if(g=_.yieldResult,v.ensureNotDestroyed_(),u=g[0],goog.asserts.assert(o,"drmEngine should be non-null here."),v.ensureNotDestroyed_(),c)throw c;return _.yield(v.downloadSegments_(f,u,h,n,a,l.cell,d,o),12);case 12:return v.ensureNotDestroyed_(),y=shaka.offline.OfflineUri.manifest(l.path.mechanism,l.path.cell,u),_.return(shaka.offline.StoredContentUtils.fromManifestDB(y,h));case 3:return _.enterFinallyBlock(),_.yield(s.destroy(),13);case 13:if(!i){_.jumpTo(14);break}return _.yield(i.stop(),14);case 14:if(!o){_.jumpTo(16);break}return _.yield(o.destroy(),16);case 16:_.leaveFinallyBlock(0);break;case 2:if(m=_.enterCatchBlock(),null==u){_.jumpTo(18);break}return _.yield(shaka.offline.Storage.cleanStoredManifest(u),18);case 18:throw c||m}}))},shaka.offline.Storage.prototype.downloadSegments_=function(e,t,r,a,n,i,o,s){var l,u,c,d,p,h,f,g,y,m,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:if(l={},u=0,c=function(e,c){var d,p,h,f,g,y,m;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){if(1==_.nextAddress){for(d={},p=$jscomp.makeIterator(e),h=p.next();!h.done;d={$jscomp$loop$prop$download$589$690:d.$jscomp$loop$prop$download$589$690},h=p.next())d.$jscomp$loop$prop$download$589$690=h.value,f=d.$jscomp$loop$prop$download$589$690.makeSegmentRequest(n),g=d.$jscomp$loop$prop$download$589$690.estimateId,y=d.$jscomp$loop$prop$download$589$690.isInitSegment,m=function(e){return function(t){var r,a,n;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){if(1==o.nextAddress)return o.yield(i.addSegments([{data:t}]),2);r=o.yieldResult,v.ensureNotDestroyed_(),a=e.$jscomp$loop$prop$download$589$690.ref,n=shaka.offline.DownloadInfo.idForSegmentRef(a),l[n]=r[0],u+=t.byteLength,o.jumpToEnd()}))}}(d),a.queue(d.$jscomp$loop$prop$download$589$690.groupId,f,g,y,m);return _.yield(a.waitToFinish(),2)}return c?(v.ensureNotDestroyed_(),v.setManifestDrmFields_(o,r,s,n),_.yield(i.updateManifest(t,r),0)):_.jumpTo(0)}))},d=!1,_.setCatchFinallyBlocks(2),!v.getManifestIsEncrypted_(o)||!d||v.getManifestIncludesInitData_(o)){_.jumpTo(4);break}return _.yield(c(e.filter((function(e){return e.isInitSegment})),!0),5);case 5:return v.ensureNotDestroyed_(),e=e.filter((function(e){return!e.isInitSegment})),p=l,h=u,l={},u=0,_.yield(shaka.offline.Storage.assignSegmentsToManifest(i,t,r,p,h,(function(){return v.ensureNotDestroyed_()})),6);case 6:v.ensureNotDestroyed_();case 4:if(d){_.jumpTo(7);break}return _.yield(c(e,!1),8);case 8:return v.ensureNotDestroyed_(),f=l,g=u,l={},u=0,_.yield(shaka.offline.Storage.assignSegmentsToManifest(i,t,r,f,g,(function(){return v.ensureNotDestroyed_()})),9);case 9:v.ensureNotDestroyed_(),goog.asserts.assert(!r.isIncomplete,"The manifest should be complete by now");case 7:_.leaveTryBlock(0);break;case 2:return y=_.enterCatchBlock(),m=Object.values(l),_.yield(i.removeSegments(m,(function(e){})),10);case 10:throw y}}))},shaka.offline.Storage.cleanStoredManifest=function(e){var t,r,a,n;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){switch(i.nextAddress){case 1:return t=new shaka.offline.StorageMuxer,i.yield(t.init(),2);case 2:return i.yield(t.getActive(),3);case 3:return r=i.yieldResult,a=shaka.offline.OfflineUri.manifest(r.path.mechanism,r.path.cell,e),i.yield(t.destroy(),4);case 4:return n=new shaka.offline.Storage,i.yield(n.remove(a.toString()),0)}}))},shaka.offline.Storage.assignSegmentsToManifest=function(e,t,r,a,n,i){var o,s,l,u,c,d,p,h,f,g,y;return $jscomp.asyncExecutePromiseGeneratorProgram((function(m){switch(m.nextAddress){case 1:for(o=!1,m.setCatchFinallyBlocks(2),s=!0,l=$jscomp.makeIterator(r.streams),u=l.next();!u.done;u=l.next())for(c=u.value,d=$jscomp.makeIterator(c.segments),p=d.next();!p.done;p=d.next())h=p.value,null!=(f=h.pendingSegmentRefId?a[h.pendingSegmentRefId]:null)&&(h.dataKey=f,h.pendingSegmentRefId=void 0),null!=(f=h.pendingInitSegmentRefId?a[h.pendingInitSegmentRefId]:null)&&(h.initSegmentKey=f,h.pendingInitSegmentRefId=void 0),h.pendingSegmentRefId&&(s=!1),h.pendingInitSegmentRefId&&(s=!1);return r.size+=n,s&&(r.isIncomplete=!1),m.yield(e.updateManifest(t,r),4);case 4:o=!0,i(),m.leaveTryBlock(0);break;case 2:return g=m.enterCatchBlock(),m.yield(shaka.offline.Storage.cleanStoredManifest(t),5);case 5:if(o){m.jumpTo(6);break}return y=Object.values(a),m.yield(e.removeSegments(y,(function(e){})),6);case 6:throw g}}))},shaka.offline.Storage.prototype.filterManifest_=function(e,t,r){var a,n,i,o,s,l,u,c,d,p,h,f,g,y,m,v,_,k,E,T,b,S,A,C,P,w,x,I;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:return a={width:1/0,height:1/0},shaka.util.StreamUtils.filterByRestrictions(e,r.restrictions,a),t.yield(shaka.util.StreamUtils.filterManifestByMediaCapabilities(e,r.offline.usePersistentLicense),2);case 2:for(n=[],i=r.preferredAudioChannelCount,o=r.preferredDecodingAttributes,s=r.preferredVideoCodecs,l=r.preferredAudioCodecs,shaka.util.StreamUtils.chooseCodecsAndFilterManifest(e,s,l,i,o),u=$jscomp.makeIterator(e.variants),c=u.next();!c.done;c=u.next())d=c.value,goog.asserts.assert(shaka.util.StreamUtils.isPlayable(d),'We should have already filtered by "is playable"'),n.push(shaka.util.StreamUtils.variantToTrack(d));for(p=$jscomp.makeIterator(e.textStreams),h=p.next();!h.done;h=p.next())f=h.value,n.push(shaka.util.StreamUtils.textStreamToTrack(f));for(g=$jscomp.makeIterator(e.imageStreams),y=g.next();!y.done;y=g.next())m=y.value,n.push(shaka.util.StreamUtils.imageStreamToTrack(m));return t.yield(r.offline.trackSelectionCallback(n),3);case 3:for(v=t.yieldResult,_=e.presentationTimeline.getDuration(),k=0,E=$jscomp.makeIterator(v),T=E.next();!T.done;T=E.next())b=T.value,S=b.bandwidth*_/8,k+=S;return t.setCatchFinallyBlocks(4),t.yield(r.offline.downloadSizeCallback(k),6);case 6:if(!t.yieldResult)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.STORAGE_LIMIT_REACHED);t.leaveTryBlock(5);break;case 4:if((A=t.enterCatchBlock())instanceof shaka.util.Error)throw A;throw shaka.log.warning("downloadSizeCallback has produced an unexpected error",A),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.DOWNLOAD_SIZE_CALLBACK_ERROR);case 5:for(C=new Set,P=new Set,w=new Set,x=$jscomp.makeIterator(v),T=x.next();!T.done;T=x.next())"variant"==(I=T.value).type&&C.add(I.id),"text"==I.type&&P.add(I.id),"image"==I.type&&w.add(I.id);e.variants=e.variants.filter((function(e){return C.has(e.id)})),e.textStreams=e.textStreams.filter((function(e){return P.has(e.id)})),e.imageStreams=e.imageStreams.filter((function(e){return w.has(e.id)})),shaka.offline.Storage.validateManifest_(e),t.jumpToEnd()}}))},shaka.offline.Storage.prototype.makeManifestDB_=function(e,t,r,a,n,i){var o=shaka.offline.StoredContentUtils.fromManifest(r,t,0,a),s=n.offline.progressCallback;i.setCallbacks((function(e,t){o.size=t,s(o,e)}),(function(t,r){l&&n.offline.usePersistentLicense&&u==r&&e.newInitData("cenc",t)}));var l=this.getManifestIsEncrypted_(t)&&!this.getManifestIncludesInitData_(t),u=null;if(l){var c=e.getDrmInfo();u=shaka.offline.Storage.defaultSystemIds_.get(c.keySystem)}c=new shaka.offline.StreamBandwidthEstimator;for(var d=$jscomp.makeIterator(t.textStreams),p=d.next();!p.done;p=d.next())c.addText(p.value);for(p=(d=$jscomp.makeIterator(t.imageStreams)).next();!p.done;p=d.next())c.addImage(p.value);for(d=(p=$jscomp.makeIterator(t.variants)).next();!d.done;d=p.next())c.addVariant(d.value);return i=(c=this.createStreams_(i,c,e,t,n)).streams,c=c.toDownload,p=e.getDrmInfo(),d=n.offline.usePersistentLicense,p&&d&&(p.initData=[]),{manifestDB:{creationTime:Date.now(),originalManifestUri:r,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.getExpiration(),streams:i,sessionIds:d?e.getSessionIds():[],drmInfo:p,appMetadata:a,isIncomplete:!0,sequenceMode:t.sequenceMode},toDownload:c}},shaka.offline.Storage.prototype.getManifestIsEncrypted_=function(e){return e.variants.some((function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t}))},shaka.offline.Storage.prototype.getManifestIncludesInitData_=function(e){return e.variants.some((function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some((function(e){return e.initData&&e.initData.length}))}))},shaka.offline.Storage.prototype.setManifestDrmFields_=function(e,t,r,a){if(t.expiration=r.getExpiration(),r=r.getSessionIds(),t.sessionIds=a.offline.usePersistentLicense?r:[],this.getManifestIsEncrypted_(e)&&a.offline.usePersistentLicense&&!r.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.NO_INIT_DATA_FOR_OFFLINE)},shaka.offline.Storage.prototype.remove=function(e){return this.startOperation_(this.remove_(e))},shaka.offline.Storage.prototype.remove_=function(e){var t,r,a,n,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(s.requireSupport_(),null==(t=shaka.offline.OfflineUri.parse(e))||!t.isManifest())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,e);return r=t,a=new shaka.offline.StorageMuxer,l.setFinallyBlock(2),l.yield(a.init(),4);case 4:return l.yield(a.getCell(r.mechanism(),r.cell()),5);case 5:return n=l.yieldResult,l.yield(n.getManifests([r.key()]),6);case 6:return i=l.yieldResult,o=i[0],l.yield(Promise.all([s.removeFromDRM_(r,o,a),s.removeFromStorage_(n,r,o)]),2);case 2:return l.enterFinallyBlock(),l.yield(a.destroy(),8);case 8:l.leaveFinallyBlock(0)}}))},shaka.offline.Storage.getCapabilities_=function(e,t){for(var r=shaka.util.MimeUtils,a=[],n=$jscomp.makeIterator(e.streams),i=n.next();!i.done;i=n.next())i=i.value,t&&"video"==i.type?a.push({contentType:r.getFullType(i.mimeType,i.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=i.type||a.push({contentType:r.getFullType(i.mimeType,i.codecs),robustness:e.drmInfo.audioRobustness});return a},shaka.offline.Storage.prototype.removeFromDRM_=function(e,t,r){var a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return goog.asserts.assert(a.networkingEngine_,"Cannot be destroyed"),e.yield(shaka.offline.Storage.deleteLicenseFor_(a.networkingEngine_,a.config_.drm,r,t),0)}))},shaka.offline.Storage.prototype.removeFromStorage_=function(e,t,r){var a=this,n=shaka.offline.Storage.getAllSegmentIds_(r),i=n.length+1,o=0,s=shaka.offline.StoredContentUtils.fromManifestDB(t,r);return r=function(e){o+=1,a.config_.offline.progressCallback(s,o/i)},Promise.all([e.removeSegments(n,r),e.removeManifests([t.key()],r)])},shaka.offline.Storage.prototype.removeEmeSessions=function(){return this.startOperation_(this.removeEmeSessions_())},shaka.offline.Storage.prototype.removeEmeSessions_=function(){var e,t,r,a,n,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){switch(p.nextAddress){case 1:return d.requireSupport_(),goog.asserts.assert(d.networkingEngine_,"Cannot be destroyed"),e=d.networkingEngine_,t=d.config_.drm,r=new shaka.offline.StorageMuxer,a=new shaka.offline.SessionDeleter,n=!1,p.setFinallyBlock(2),p.yield(r.init(),4);case 4:i=[],r.forEachEmeSessionCell((function(e){return i.push(e)})),o=$jscomp.makeIterator(i),s=o.next();case 5:if(s.done){p.jumpTo(2);break}return l=s.value,p.yield(l.getAll(),8);case 8:return u=p.yieldResult,p.yield(a.delete(t,e,u),9);case 9:return c=p.yieldResult,p.yield(l.remove(c),10);case 10:c.length!=u.length&&(n=!0),s=o.next(),p.jumpTo(5);break;case 2:return p.enterFinallyBlock(),p.yield(r.destroy(),11);case 11:p.leaveFinallyBlock(3);break;case 3:return p.return(!n)}}))},shaka.offline.Storage.prototype.list=function(){return this.startOperation_(this.list_())},shaka.offline.Storage.prototype.list_=function(){var e,t,r,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){switch(n.nextAddress){case 1:return a.requireSupport_(),e=[],t=new shaka.offline.StorageMuxer,n.setFinallyBlock(2),n.yield(t.init(),4);case 4:return r=Promise.resolve(),t.forEachCell((function(t,a){r=r.then((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(a.getAllManifests(),2);r.yieldResult.forEach((function(r,a){a=shaka.offline.OfflineUri.manifest(t.mechanism,t.cell,a),r=shaka.offline.StoredContentUtils.fromManifestDB(a,r),e.push(r)})),r.jumpToEnd()}))}))})),n.yield(r,2);case 2:return n.enterFinallyBlock(),n.yield(t.destroy(),6);case 6:n.leaveFinallyBlock(3);break;case 3:return n.return(e)}}))},shaka.offline.Storage.prototype.parseManifest=function(e,t,r){var a,n,i,o,s,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress)return a=null,n=l.networkingEngine_,goog.asserts.assert(n,"Should be initialized!"),i={networkingEngine:n,modifyManifestRequest:function(e,t){},modifySegmentRequest:function(e,t){},filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(e){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){a=e},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){},updateDuration:function(){},newDrmInfo:function(e){}},t.configure(r.manifest),l.ensureNotDestroyed_(),u.yield(t.start(e,i),2);if(3!=u.nextAddress)return o=u.yieldResult,l.ensureNotDestroyed_(),s=shaka.offline.Storage.getAllStreamsFromManifest_(o),u.yield(Promise.all(shaka.util.Iterables.map(s,(function(e){return e.createSegmentIndex()}))),3);if(l.ensureNotDestroyed_(),a)throw a;return u.return(o)}))},shaka.offline.Storage.prototype.createDrmEngine=function(e,t,r){var a,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){switch(i.nextAddress){case 1:return goog.asserts.assert(n.networkingEngine_,"Cannot call |createDrmEngine| after |destroy|"),(a=new shaka.media.DrmEngine({netEngine:n.networkingEngine_,onError:t,onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}})).configure(r.drm),i.yield(a.initForStorage(e.variants,r.offline.usePersistentLicense),2);case 2:return i.yield(a.setServerCertificate(),3);case 3:return i.yield(a.createOrLoad(),4);case 4:return i.return(a)}}))},shaka.offline.Storage.prototype.createStreams_=function(e,t,r,a,n){r=new Map;for(var i=shaka.offline.Storage.getAllStreamsFromManifest_(a),o=new Map,s=(i=$jscomp.makeIterator(i)).next();!s.done;s=i.next()){s=s.value;var l=this.createStream_(e,t,a,s,n,r);o.set(s.id,l)}for(t=(e=$jscomp.makeIterator(a.variants)).next();!t.done;t=e.next())(t=t.value).audio&&o.get(t.audio.id).variantIds.push(t.id),t.video&&o.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(o.values()),toDownload:Array.from(r.values())}},shaka.offline.Storage.prototype.createStream_=function(e,t,r,a,n,i){var o={id:a.id,originalId:a.originalId,primary:a.primary,type:a.type,mimeType:a.mimeType,codecs:a.codecs,frameRate:a.frameRate,pixelAspectRatio:a.pixelAspectRatio,hdr:a.hdr,kind:a.kind,language:a.language,label:a.label,width:a.width||null,height:a.height||null,encrypted:a.encrypted,keyIds:a.keyIds,segments:[],variantIds:[],roles:a.roles,forced:a.forced,channelsCount:a.channelsCount,audioSamplingRate:a.audioSamplingRate,spatialAudio:a.spatialAudio,closedCaptions:a.closedCaptions,tilesLayout:a.tilesLayout};r=r.presentationTimeline.getSegmentAvailabilityStart();var s=n.offline.numberOfParallelDownloads,l=0;return shaka.offline.Storage.forEachSegment_(a,r,(function(r){var n=shaka.offline.DownloadInfo.idForSegmentRef(r),u=void 0;if(!i.has(n)){var c=e.addDownloadEstimate(t.getSegmentEstimate(a.id,r));c=new shaka.offline.DownloadInfo(r,c,l,!1),i.set(n,c)}r.initSegmentReference&&(u=shaka.offline.DownloadInfo.idForSegmentRef(r.initSegmentReference),i.has(u)||(c=e.addDownloadEstimate(t.getInitSegmentEstimate(a.id)),c=new shaka.offline.DownloadInfo(r.initSegmentReference,c,l,!0),i.set(u,c))),o.segments.push({pendingInitSegmentRefId:u,initSegmentKey:u?0:null,startTime:r.startTime,endTime:r.endTime,appendWindowStart:r.appendWindowStart,appendWindowEnd:r.appendWindowEnd,timestampOffset:r.timestampOffset,tilesLayout:r.tilesLayout,pendingSegmentRefId:n,dataKey:0}),l=(l+1)%s})),o},shaka.offline.Storage.forEachSegment_=function(e,t,r){if(null!=(t=e.segmentIndex.find(t)))for(var a=e.segmentIndex.get(t);a;)r(a),a=e.segmentIndex.get(++t)},shaka.offline.Storage.prototype.ensureNotDestroyed_=function(){if(this.destroyer_.destroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.OPERATION_ABORTED)},shaka.offline.Storage.prototype.requireSupport_=function(){if(!shaka.offline.Storage.support())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.STORAGE_NOT_SUPPORTED)},shaka.offline.Storage.prototype.startOperation_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(t.openOperations_.push(e),r.setFinallyBlock(2),r.yield(e,4)):2!=r.nextAddress?r.return(r.yieldResult):(r.enterFinallyBlock(),shaka.util.ArrayUtils.remove(t.openOperations_,e),r.leaveFinallyBlock(0))}))},shaka.offline.Storage.prototype.startAbortableOperation_=function(e){var t=this,r=e.promise;return this.openOperations_.push(r),e.finally((function(){shaka.util.ArrayUtils.remove(t.openOperations_,r)}))},shaka.offline.Storage.getAllSegmentIds_=function(e){for(var t=new Set,r=(e=$jscomp.makeIterator(e.streams)).next();!r.done;r=e.next())for(var a=(r=$jscomp.makeIterator(r.value.segments)).next();!a.done;a=r.next())null!=(a=a.value).initSegmentKey&&t.add(a.initSegmentKey),t.add(a.dataKey);return Array.from(t)},shaka.offline.Storage.deleteAll=function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?(e=new shaka.offline.StorageMuxer,t.setFinallyBlock(2),t.yield(e.erase(),2)):5!=t.nextAddress?(t.enterFinallyBlock(),t.yield(e.destroy(),5)):t.leaveFinallyBlock(0)}))},shaka.offline.Storage.deleteLicenseFor_=function(e,t,r,a){var n,i,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return 1==l.nextAddress?a.drmInfo?(n=r.getEmeSessionCell(),i=a.sessionIds.map((function(e){return{sessionId:e,keySystem:a.drmInfo.keySystem,licenseUri:a.drmInfo.licenseServerUri,serverCertificate:a.drmInfo.serverCertificate,audioCapabilities:shaka.offline.Storage.getCapabilities_(a,!1),videoCapabilities:shaka.offline.Storage.getCapabilities_(a,!0)}})),o=new shaka.offline.SessionDeleter,l.yield(o.delete(t,e,i),2)):l.return():3!=l.nextAddress?(s=l.yieldResult,l.yield(n.remove(s),3)):l.yield(n.add(i.filter((function(e){return!s.includes(e.sessionId)}))),0)}))},shaka.offline.Storage.getAllStreamsFromManifest_=function(e){for(var t=new Set,r=$jscomp.makeIterator(e.textStreams),a=r.next();!a.done;a=r.next())t.add(a.value);for(a=(r=$jscomp.makeIterator(e.imageStreams)).next();!a.done;a=r.next())t.add(a.value);for(r=(e=$jscomp.makeIterator(e.variants)).next();!r.done;r=e.next())(r=r.value).audio&&t.add(r.audio),r.video&&t.add(r.video);return t},shaka.offline.Storage.validateManifest_=function(e){var t=new Set(e.variants.map((function(e){return e.video}))),r=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams,1<t.size&&shaka.log.warning("Multiple video tracks selected to be stored");for(var a=(t=$jscomp.makeIterator(r)).next();!a.done;a=t.next()){a=a.value;for(var n=$jscomp.makeIterator(r),i=n.next();!i.done;i=n.next())a!=(i=i.value)&&a.language==i.language&&shaka.log.warning("Similar audio tracks were selected to be stored",a.id,i.id)}for(t=(r=$jscomp.makeIterator(e)).next();!t.done;t=r.next())for(t=t.value,n=(a=$jscomp.makeIterator(e)).next();!n.done;n=a.next())t!=(n=n.value)&&t.language==n.language&&shaka.log.warning("Similar text tracks were selected to be stored",t.id,n.id)},goog.exportSymbol("shaka.offline.Storage",shaka.offline.Storage),goog.exportProperty(shaka.offline.Storage,"deleteAll",shaka.offline.Storage.deleteAll),goog.exportProperty(shaka.offline.Storage.prototype,"list",shaka.offline.Storage.prototype.list),goog.exportProperty(shaka.offline.Storage.prototype,"removeEmeSessions",shaka.offline.Storage.prototype.removeEmeSessions),goog.exportProperty(shaka.offline.Storage.prototype,"remove",shaka.offline.Storage.prototype.remove),goog.exportProperty(shaka.offline.Storage.prototype,"store",shaka.offline.Storage.prototype.store),goog.exportProperty(shaka.offline.Storage.prototype,"getNetworkingEngine",shaka.offline.Storage.prototype.getNetworkingEngine),goog.exportProperty(shaka.offline.Storage.prototype,"getConfiguration",shaka.offline.Storage.prototype.getConfiguration),goog.exportProperty(shaka.offline.Storage.prototype,"configure",shaka.offline.Storage.prototype.configure),goog.exportProperty(shaka.offline.Storage.prototype,"destroy",shaka.offline.Storage.prototype.destroy),goog.exportProperty(shaka.offline.Storage,"support",shaka.offline.Storage.support),shaka.offline.Storage.defaultSystemIds_=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb"),shaka.Player.registerSupportPlugin("offline",shaka.offline.Storage.support),shaka.polyfill=function(){},shaka.polyfill.installAll=function(){for(var e=$jscomp.makeIterator(shaka.polyfill.polyfills_),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(e){shaka.log.alwaysWarn("Error installing polyfill!",e)}}},shaka.polyfill.register=function(e,t){for(e={priority:t||0,callback:e},t=0;t<shaka.polyfill.polyfills_.length;t++)if(shaka.polyfill.polyfills_[t].priority<e.priority)return void shaka.polyfill.polyfills_.splice(t,0,e);shaka.polyfill.polyfills_.push(e)},goog.exportSymbol("shaka.polyfill",shaka.polyfill),goog.exportProperty(shaka.polyfill,"register",shaka.polyfill.register),goog.exportProperty(shaka.polyfill,"installAll",shaka.polyfill.installAll),shaka.polyfill.polyfills_=[],shaka.polyfill.AbortController=function(){this.signal_=new shaka.polyfill.AbortController.AbortSignal},shaka.polyfill.AbortController.install=function(){window.AbortController||(window.AbortController=shaka.polyfill.AbortController,window.AbortSignal=shaka.polyfill.AbortController.AbortSignal)},shaka.polyfill.AbortController.prototype.abort=function(e){this.signal_.doAbort_(e)},$jscomp.global.Object.defineProperties(shaka.polyfill.AbortController.prototype,{signal:{configurable:!0,enumerable:!0,get:function(){return this.signal_}}}),goog.exportProperty(shaka.polyfill,"AbortController",shaka.polyfill.AbortController),goog.exportProperty(shaka.polyfill.AbortController,"install",shaka.polyfill.AbortController.install),shaka.polyfill.AbortController.AbortSignal=function(){shaka.util.FakeEventTarget.call(this),this.aborted_=!1,this.reason_=void 0,this.onabort=null},$jscomp.inherits(shaka.polyfill.AbortController.AbortSignal,shaka.util.FakeEventTarget),shaka.polyfill.AbortController.AbortSignal.prototype.doAbort_=function(e){this.aborted_||(this.aborted_=!0,this.reason_=e,void 0===this.reason_&&(this.reason_=new DOMException("signal is aborted without reason","AbortError")),e=new shaka.util.FakeEvent("abort"),this.onabort&&this.onabort(e),this.dispatchEvent(e))},shaka.polyfill.AbortController.AbortSignal.abort=function(e){var t=new shaka.polyfill.AbortController.AbortSignal;return t.doAbort_(e),t},shaka.polyfill.AbortController.AbortSignal.timeout=function(e){var t=new shaka.polyfill.AbortController.AbortSignal;return window.setTimeout((function(){t.doAbort_(new DOMException("signal timed out","TimeoutError"))}),e),t},$jscomp.global.Object.defineProperties(shaka.polyfill.AbortController.AbortSignal.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return this.aborted_}},reason:{configurable:!0,enumerable:!0,get:function(){return this.reason_}}}),shaka.polyfill.register(shaka.polyfill.AbortController.install),shaka.polyfill.Aria=function(){},shaka.polyfill.Aria.install=function(){if(Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))shaka.log.info("Using native ARIAMixin interface.");else{shaka.log.info("ARIAMixin interface not detected. Installing polyfill.");for(var e=$jscomp.makeIterator(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())shaka.polyfill.Aria.addARIAMixinAttribute_(t.value)}},shaka.polyfill.Aria.addARIAMixinAttribute_=function(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||null==e?this.removeAttribute(t):this.setAttribute(t,e)}})},goog.exportProperty(shaka.polyfill,"Aria",shaka.polyfill.Aria),goog.exportProperty(shaka.polyfill.Aria,"install",shaka.polyfill.Aria.install),shaka.polyfill.register(shaka.polyfill.Aria.install),shaka.polyfill.EncryptionScheme=function(){},shaka.polyfill.EncryptionScheme.install=function(){EncryptionSchemePolyfills.install()},goog.exportProperty(shaka.polyfill,"EncryptionScheme",shaka.polyfill.EncryptionScheme),goog.exportProperty(shaka.polyfill.EncryptionScheme,"install",shaka.polyfill.EncryptionScheme.install),shaka.polyfill.register(shaka.polyfill.EncryptionScheme.install,-2),shaka.polyfill.Fullscreen=function(){},shaka.polyfill.Fullscreen.install=function(){if(window.Document){var e=Element.prototype;e.requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,(e=Document.prototype).exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),e=shaka.polyfill.Fullscreen.proxyEvent_,document.addEventListener("webkitfullscreenchange",e),document.addEventListener("webkitfullscreenerror",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("mozfullscreenerror",e),document.addEventListener("MSFullscreenChange",e),document.addEventListener("MSFullscreenError",e)}},shaka.polyfill.Fullscreen.proxyEvent_=function(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),r=document.createEvent("Event");r.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(r)},goog.exportProperty(shaka.polyfill,"Fullscreen",shaka.polyfill.Fullscreen),goog.exportProperty(shaka.polyfill.Fullscreen,"install",shaka.polyfill.Fullscreen.install),shaka.polyfill.register(shaka.polyfill.Fullscreen.install),shaka.polyfill.MediaCapabilities=function(){},shaka.polyfill.MediaCapabilities.install=function(){var e=!0;(shaka.util.Platform.isApple()||shaka.util.Platform.isPS5()||shaka.util.Platform.isPS4()||shaka.util.Platform.isWebOS()||shaka.util.Platform.isTizen()||shaka.util.Platform.isChromecast()||shaka.util.Platform.isEOS()||shaka.util.Platform.isHisense())&&(e=!1),e&&navigator.mediaCapabilities?shaka.log.info("MediaCapabilities: Native mediaCapabilities support found."):(shaka.log.info("MediaCapabilities: install"),navigator.mediaCapabilities||(navigator.mediaCapabilities={}),shaka.polyfill.MediaCapabilities.originalMcap=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=shaka.polyfill.MediaCapabilities.decodingInfo_)},shaka.polyfill.MediaCapabilities.decodingInfo_=function(e){var t,r,a,n,i,o,s,l,u,c,d,p,h,f;return $jscomp.asyncExecutePromiseGeneratorProgram((function(g){switch(g.nextAddress){case 1:if(t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},!e)return g.return(t);if(r=e.video,a=e.audio,n=shaka.media.Capabilities,"media-source"==e.type){if(!shaka.util.Platform.supportsMediaSource()||r&&!(shaka.util.Platform.isChromecast()?shaka.polyfill.MediaCapabilities.canCastDisplayType_(r):n.isTypeSupported(r.contentType))||a&&(i=a.contentType,!n.isTypeSupported(i)))return g.return(t)}else{if("file"!=e.type)return g.return(t);if(r&&(o=r.contentType,!shaka.util.Platform.supportsMediaType(o))||a&&(s=a.contentType,!shaka.util.Platform.supportsMediaType(s)))return g.return(t)}return e.keySystemConfiguration?(l=e.keySystemConfiguration,u=[],c=[],l.audio&&(d={robustness:l.audio.robustness||"",contentType:e.audio.contentType},u.push(d)),l.video&&(p={robustness:l.video.robustness||"",contentType:e.video.contentType},c.push(p)),h={initDataTypes:[l.initDataType],distinctiveIdentifier:l.distinctiveIdentifier,persistentState:l.persistentState,sessionTypes:l.sessionTypes},u.length&&(h.audioCapabilities=u),c.length&&(h.videoCapabilities=c),g.setCatchFinallyBlocks(3),g.yield(navigator.requestMediaKeySystemAccess(l.keySystem,[h]),5)):(t.supported=!0,g.return(Promise.resolve(t)));case 5:f=g.yieldResult,g.leaveTryBlock(4);break;case 3:g.enterCatchBlock(),shaka.log.info("navigator.requestMediaKeySystemAccess failed.");case 4:f&&(t.supported=!0,t.keySystemAccess=f);case 2:return g.return(t)}}))},shaka.polyfill.MediaCapabilities.canCastDisplayType_=function(e){if(!(window.cast&&cast.__platform__&&cast.__platform__.canDisplayType))return shaka.log.warning("Expected cast APIs to be available! Falling back to shaka.media.Capabilities.isTypeSupported() for type support."),shaka.media.Capabilities.isTypeSupported(e.contentType);var t=e.contentType;return e.width&&e.height&&(t+="; width="+e.width+"; height="+e.height),e.framerate&&(t+="; framerate="+e.framerate),"pq"===e.transferFunction&&(t+="; eotf=smpte2084"),cast.__platform__.canDisplayType(t)},goog.exportProperty(shaka.polyfill,"MediaCapabilities",shaka.polyfill.MediaCapabilities),goog.exportProperty(shaka.polyfill.MediaCapabilities,"install",shaka.polyfill.MediaCapabilities.install),shaka.polyfill.MediaCapabilities.originalMcap=null,goog.exportProperty(shaka.polyfill.MediaCapabilities,"originalMcap",shaka.polyfill.MediaCapabilities.originalMcap),shaka.polyfill.register(shaka.polyfill.MediaCapabilities.install,-1),shaka.polyfill.MediaSource=function(){},shaka.polyfill.MediaSource.install=function(){shaka.log.debug("MediaSource.install");var e=shaka.util.Platform.safariVersion();window.MediaSource?window.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(shaka.log.info("Patching Chromecast MSE bugs."),shaka.polyfill.MediaSource.patchCastIsTypeSupported_()):e?12>=e?(shaka.log.info("Patching Safari 11 & 12 MSE bugs."),shaka.polyfill.MediaSource.stubAbort_(),shaka.polyfill.MediaSource.patchRemovalRange_()):15>=e&&(shaka.log.info("Patching Safari 13 & 14 & 15 MSE bugs."),shaka.polyfill.MediaSource.stubAbort_()):shaka.util.Platform.isEdge()?(shaka.log.info("Rejecting TS container."),shaka.polyfill.MediaSource.rejectContainer_("mp2t")):shaka.util.Platform.isTizen2()||shaka.util.Platform.isTizen3()||shaka.util.Platform.isTizen4()?(shaka.log.info("Rejecting Opus."),shaka.polyfill.MediaSource.rejectCodec_("opus")):shaka.log.info("Using native MSE as-is."):shaka.log.info("No MSE implementation available."),window.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&(shaka.log.info("Patching vp09 support queries."),shaka.polyfill.MediaSource.patchVp09_())},shaka.polyfill.MediaSource.stubAbort_=function(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=$jscomp.getRestArguments.apply(0,arguments);return(t=e.apply(this,t)).abort=function(){},t}},shaka.polyfill.MediaSource.patchRemovalRange_=function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,r){return e.call(this,t,r-.001)}},shaka.polyfill.MediaSource.rejectContainer_=function(e){var t=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(r){return shaka.util.MimeUtils.getContainerType(r)!=e&&t(r)}},shaka.polyfill.MediaSource.rejectCodec_=function(e){var t=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(r){return shaka.util.MimeUtils.getCodecBase(r)!=e&&t(r)}},shaka.polyfill.MediaSource.patchCastIsTypeSupported_=function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){var r=t.split(/ *; */);return r.shift(),r.some((function(e){return e.startsWith("codecs=")}))?cast.__platform__.canDisplayType(t):e(t)}},shaka.polyfill.MediaSource.patchVp09_=function(){var e=MediaSource.isTypeSupported;shaka.util.Platform.isWebOS()||(MediaSource.isTypeSupported=function(t){var r=t.split(/ *; */),a=r.findIndex((function(e){return e.startsWith("codecs=")}));if(0>a)return e(t);var n=r[a].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),i=n.findIndex((function(e){return e.startsWith("vp09")}));return 0<=i&&(n[i]="vp9",r[a]='codecs="'+n.join(",")+'"',t=r.join("; ")),e(t)})},goog.exportProperty(shaka.polyfill,"MediaSource",shaka.polyfill.MediaSource),goog.exportProperty(shaka.polyfill.MediaSource,"install",shaka.polyfill.MediaSource.install),shaka.polyfill.register(shaka.polyfill.MediaSource.install),shaka.polyfill.Orientation=function(){},shaka.polyfill.Orientation.install=function(){screen.orientation||null!=window.orientation&&shaka.polyfill.Orientation.installBasedOnWindowMethods_()},shaka.polyfill.Orientation.installBasedOnWindowMethods_=function(){var e=new shaka.polyfill.Orientation.FakeOrientation;screen.orientation=e;var t=function(){switch(window.orientation){case-90:e.type="landscape-secondary",e.angle=270;break;case 0:e.type="portrait-primary",e.angle=0;break;case 90:e.type="landscape-primary",e.angle=90;break;case 180:e.type="portrait-secondary",e.angle=180}};t(),window.addEventListener("orientationchange",(function(){t(),e.dispatchChangeEvent()}))},goog.exportProperty(shaka.polyfill,"Orientation",shaka.polyfill.Orientation),goog.exportProperty(shaka.polyfill.Orientation,"install",shaka.polyfill.Orientation.install),shaka.polyfill.Orientation.FakeOrientation=function(){shaka.util.FakeEventTarget.call(this),this.type="",this.angle=0},$jscomp.inherits(shaka.polyfill.Orientation.FakeOrientation,shaka.util.FakeEventTarget),shaka.polyfill.Orientation.FakeOrientation.prototype.dispatchChangeEvent=function(){var e=new shaka.util.FakeEvent("change");this.dispatchEvent(e)},shaka.polyfill.Orientation.FakeOrientation.prototype.lock=function(e){var t=function(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)},r=!1;switch(e){case"natural":r=t("default");break;case"any":r=!0,this.unlock();break;default:r=t(e)}return r?Promise.resolve():((e=Error("screen.orientation.lock() is not available on this device")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},shaka.polyfill.Orientation.FakeOrientation.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},shaka.polyfill.register(shaka.polyfill.Orientation.install),shaka.polyfill.PatchedMediaKeysApple=function(){},shaka.polyfill.PatchedMediaKeysApple.install=function(e){var t=shaka.polyfill.PatchedMediaKeysApple;window.HTMLVideoElement&&window.WebKitMediaKeys&&(void 0!==e&&e&&(t.enableUninstall=!0,t.originalHTMLMediaElementPrototypeMediaKeys=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),t.originalHTMLMediaElementPrototypeSetMediaKeys=HTMLMediaElement.prototype.setMediaKeys,t.originalWindowMediaKeys=window.MediaKeys,t.originalWindowMediaKeySystemAccess=window.MediaKeySystemAccess,t.originalNavigatorRequestMediaKeySystemAccess=navigator.requestMediaKeySystemAccess),shaka.log.info("Using Apple-prefixed EME"),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=t.setMediaKeys,window.MediaKeys=t.MediaKeys,window.MediaKeySystemAccess=t.MediaKeySystemAccess,navigator.requestMediaKeySystemAccess=t.requestMediaKeySystemAccess,window.shakaMediaKeysPolyfill=!0)},shaka.polyfill.PatchedMediaKeysApple.uninstall=function(){var e=shaka.polyfill.PatchedMediaKeysApple;e.enableUninstall&&(shaka.log.info("Un-installing Apple-prefixed EME"),e.enableUninstall=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",e.originalHTMLMediaElementPrototypeMediaKeys),HTMLMediaElement.prototype.setMediaKeys=e.originalHTMLMediaElementPrototypeSetMediaKeys,window.MediaKeys=e.originalWindowMediaKeys,window.MediaKeySystemAccess=e.originalWindowMediaKeySystemAccess,navigator.requestMediaKeySystemAccess=e.originalNavigatorRequestMediaKeySystemAccess,e.originalWindowMediaKeys=null,e.originalWindowMediaKeySystemAccess=null,e.originalHTMLMediaElementPrototypeSetMediaKeys=null,e.originalNavigatorRequestMediaKeySystemAccess=null,e.originalHTMLMediaElementPrototypeMediaKeys=null,window.shakaMediaKeysPolyfill=!1)},shaka.polyfill.PatchedMediaKeysApple.requestMediaKeySystemAccess=function(e,t){shaka.log.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess"),goog.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');var r=shaka.polyfill.PatchedMediaKeysApple;try{var a=new r.MediaKeySystemAccess(e,t);return Promise.resolve(a)}catch(e){return Promise.reject(e)}},shaka.polyfill.PatchedMediaKeysApple.setMediaKeys=function(e){shaka.log.debug("PatchedMediaKeysApple.setMediaKeys"),goog.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=shaka.polyfill.PatchedMediaKeysApple,r=this.mediaKeys;return r&&r!=e&&(goog.asserts.assert(r instanceof t.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,(this.mediaKeys=e)?(goog.asserts.assert(e instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),e.setMedia(this)):Promise.resolve()},shaka.polyfill.PatchedMediaKeysApple.onWebkitNeedKey_=function(e){if(shaka.log.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e),goog.asserts.assert(this.mediaKeys instanceof shaka.polyfill.PatchedMediaKeysApple.MediaKeys,"non-polyfill instance of newMediaKeys"),goog.asserts.assert(null!=e.initData,"missing init data!"),e=shaka.util.BufferUtils.toUint8(e.initData),shaka.util.BufferUtils.toDataView(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=shaka.util.StringUtils.fromUTF16(e.subarray(4),!0),e=shaka.util.StringUtils.toUTF8(e);var t=new Event("encrypted");t.initDataType="skd",t.initData=shaka.util.BufferUtils.toArrayBuffer(e),this.dispatchEvent(t)},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysApple",shaka.polyfill.PatchedMediaKeysApple),goog.exportProperty(shaka.polyfill.PatchedMediaKeysApple,"uninstall",shaka.polyfill.PatchedMediaKeysApple.uninstall),goog.exportProperty(shaka.polyfill.PatchedMediaKeysApple,"install",shaka.polyfill.PatchedMediaKeysApple.install),shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess=function(e,t){if(shaka.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=e,e.startsWith("com.apple.fps"))for(t=(e=$jscomp.makeIterator(t)).next();!t.done;t=e.next())if(t=this.checkConfig_(t.value))return void(this.configuration_=t);throw(e=Error("Unsupported keySystem")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e},shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess.prototype.checkConfig_=function(e){if("required"==e.persistentState)return null;var t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"],label:e.label},r=!1,a=!1;if(e.audioCapabilities)for(var n=$jscomp.makeIterator(e.audioCapabilities),i=n.next();!i.done;i=n.next())if((i=i.value).contentType){r=!0;var o=i.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,o)&&(t.audioCapabilities.push(i),a=!0)}if(e.videoCapabilities)for(i=(e=$jscomp.makeIterator(e.videoCapabilities)).next();!i.done;i=e.next())(n=i.value).contentType&&(r=!0,i=n.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,i)&&(t.videoCapabilities.push(n),a=!0));return r||(a=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),a?t:null},shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess.prototype.createMediaKeys=function(){shaka.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new shaka.polyfill.PatchedMediaKeysApple.MediaKeys(this.keySystem);return Promise.resolve(e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess.prototype.getConfiguration=function(){return shaka.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.configuration_},shaka.polyfill.PatchedMediaKeysApple.MediaKeys=function(e){shaka.log.debug("PatchedMediaKeysApple.MediaKeys"),this.nativeMediaKeys_=new WebKitMediaKeys(e),this.eventManager_=new shaka.util.EventManager},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.createSession=function(e){if(shaka.log.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new shaka.polyfill.PatchedMediaKeysApple.MediaKeySession(this.nativeMediaKeys_,e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.setServerCertificate=function(e){return shaka.log.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),Promise.resolve(!1)},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.setMedia=function(e){var t=this,r=shaka.polyfill.PatchedMediaKeysApple;if(this.eventManager_.removeAll(),!e)return Promise.resolve();this.eventManager_.listen(e,"webkitneedkey",r.onWebkitNeedKey_);try{return shaka.util.MediaReadyState.waitForReadyState(e,HTMLMediaElement.HAVE_METADATA,this.eventManager_,(function(){e.webkitSetMediaKeys(t.nativeMediaKeys_)})),Promise.resolve()}catch(e){return Promise.reject(e)}},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession=function(e,t){shaka.log.debug("PatchedMediaKeysApple.MediaKeySession"),shaka.util.FakeEventTarget.call(this),this.nativeMediaKeySession_=null,this.nativeMediaKeys_=e,this.updatePromise_=this.generateRequestPromise_=null,this.eventManager_=new shaka.util.EventManager,this.sessionId="",this.expiration=NaN,this.closed=new shaka.util.PublicPromise,this.keyStatuses=new shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap},$jscomp.inherits(shaka.polyfill.PatchedMediaKeysApple.MediaKeySession,shaka.util.FakeEventTarget),shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.generateRequest=function(e,t){var r=this;shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.generateRequestPromise_=new shaka.util.PublicPromise;try{var a=this.nativeMediaKeys_.createSession("video/mp4",shaka.util.BufferUtils.toUint8(t));this.nativeMediaKeySession_=a,this.sessionId=a.sessionId||"",this.eventManager_.listen(this.nativeMediaKeySession_,"webkitkeymessage",(function(e){return r.onWebkitKeyMessage_(e)})),this.eventManager_.listen(a,"webkitkeyadded",(function(e){return r.onWebkitKeyAdded_(e)})),this.eventManager_.listen(a,"webkitkeyerror",(function(e){return r.onWebkitKeyError_(e)})),this.updateKeyStatus_("status-pending")}catch(e){this.generateRequestPromise_.reject(e)}return this.generateRequestPromise_},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.load=function(){return shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.update=function(e){shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.updatePromise_=new shaka.util.PublicPromise;try{this.nativeMediaKeySession_.update(shaka.util.BufferUtils.toUint8(e))}catch(e){this.updatePromise_.reject(e)}return this.updatePromise_},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.close=function(){shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.nativeMediaKeySession_.close(),this.closed.resolve(),this.eventManager_.removeAll()}catch(e){this.closed.reject(e)}return this.closed},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.remove=function(){return shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.onWebkitKeyMessage_=function(e){shaka.log.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),goog.asserts.assert(this.generateRequestPromise_,"generateRequestPromise_ should be set before now!"),this.generateRequestPromise_&&(this.generateRequestPromise_.resolve(),this.generateRequestPromise_=null);var t=null==this.keyStatuses.getStatus();e=(new Map).set("messageType",t?"license-request":"license-renewal").set("message",shaka.util.BufferUtils.toArrayBuffer(e.message)),e=new shaka.util.FakeEvent("message",e),this.dispatchEvent(e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.onWebkitKeyAdded_=function(e){shaka.log.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),goog.asserts.assert(!this.generateRequestPromise_,"Key added during generate!"),goog.asserts.assert(this.updatePromise_,"updatePromise_ should be set before now!"),this.updatePromise_&&(this.updateKeyStatus_("usable"),this.updatePromise_.resolve(),this.updatePromise_=null)},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.onWebkitKeyError_=function(e){if(shaka.log.debug("PatchedMediaKeysApple.onWebkitKeyError_",e),(e=Error("EME PatchedMediaKeysApple key error")).errorCode=this.nativeMediaKeySession_.error,null!=this.generateRequestPromise_)this.generateRequestPromise_.reject(e),this.generateRequestPromise_=null;else if(null!=this.updatePromise_)this.updatePromise_.reject(e),this.updatePromise_=null;else switch(this.nativeMediaKeySession_.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:this.updateKeyStatus_("output-not-allowed");break;default:this.updateKeyStatus_("internal-error")}},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.updateKeyStatus_=function(e){this.keyStatuses.setStatus(e),e=new shaka.util.FakeEvent("keystatuseschange"),this.dispatchEvent(e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap=function(){this.size=0,this.status_=void 0},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.setStatus=function(e){this.size=null==e?0:1,this.status_=e},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.getStatus=function(){return this.status_},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.forEach=function(e){this.status_&&e(this.status_,shaka.media.DrmEngine.DUMMY_KEY_ID.value())},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.get=function(e){if(this.has(e))return this.status_},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.has=function(e){var t=shaka.media.DrmEngine.DUMMY_KEY_ID.value();return!(!this.status_||!shaka.util.BufferUtils.equal(e,t))},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.entries=function(){goog.asserts.assert(!1,"Not used!  Provided only for the compiler.")},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.keys=function(){goog.asserts.assert(!1,"Not used!  Provided only for the compiler.")},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.values=function(){goog.asserts.assert(!1,"Not used!  Provided only for the compiler.")},shaka.polyfill.PatchedMediaKeysNop=function(){},shaka.polyfill.PatchedMediaKeysNop.install=function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){shaka.log.info("EME not available.");var e=shaka.polyfill.PatchedMediaKeysNop;navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess,window.shakaMediaKeysPolyfill=!0}},shaka.polyfill.PatchedMediaKeysNop.requestMediaKeySystemAccess=function(e,t){return shaka.log.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),goog.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess'),Promise.reject(Error("The key system specified is not supported."))},shaka.polyfill.PatchedMediaKeysNop.setMediaKeys=function(e){return shaka.log.debug("PatchedMediaKeysNop.setMediaKeys"),goog.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys'),null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysNop",shaka.polyfill.PatchedMediaKeysNop),goog.exportProperty(shaka.polyfill.PatchedMediaKeysNop,"install",shaka.polyfill.PatchedMediaKeysNop.install),shaka.polyfill.PatchedMediaKeysNop.MediaKeys=function(){throw new TypeError("Illegal constructor.")},shaka.polyfill.PatchedMediaKeysNop.MediaKeys.prototype.createSession=function(){},shaka.polyfill.PatchedMediaKeysNop.MediaKeys.prototype.setServerCertificate=function(){},shaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess=function(){throw this.keySystem="",new TypeError("Illegal constructor.")},shaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess.prototype.getConfiguration=function(){},shaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess.prototype.createMediaKeys=function(){},shaka.polyfill.register(shaka.polyfill.PatchedMediaKeysNop.install,-10),shaka.polyfill.PatchedMediaKeysWebkit=function(){},shaka.polyfill.PatchedMediaKeysWebkit.install=function(){var e=shaka.polyfill.PatchedMediaKeysWebkit;if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)shaka.log.info("Using webkit-prefixed EME v0.1b"),e.prefix_="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;shaka.log.info("Using nonprefixed EME v0.1b")}goog.asserts.assert(HTMLMediaElement.prototype[e.prefixApi_("generateKeyRequest")],"PatchedMediaKeysWebkit APIs not available!"),navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess,window.shakaMediaKeysPolyfill=!0}},shaka.polyfill.PatchedMediaKeysWebkit.prefixApi_=function(e){var t=shaka.polyfill.PatchedMediaKeysWebkit.prefix_;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e},shaka.polyfill.PatchedMediaKeysWebkit.requestMediaKeySystemAccess=function(e,t){shaka.log.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess"),goog.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');var r=shaka.polyfill.PatchedMediaKeysWebkit;try{var a=new r.MediaKeySystemAccess(e,t);return Promise.resolve(a)}catch(e){return Promise.reject(e)}},shaka.polyfill.PatchedMediaKeysWebkit.setMediaKeys=function(e){shaka.log.debug("PatchedMediaKeysWebkit.setMediaKeys"),goog.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=shaka.polyfill.PatchedMediaKeysWebkit,r=this.mediaKeys;return r&&r!=e&&(goog.asserts.assert(r instanceof t.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,(this.mediaKeys=e)&&(goog.asserts.assert(e instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),e.setMedia(this)),Promise.resolve()},shaka.polyfill.PatchedMediaKeysWebkit.getVideoElement_=function(){var e=document.getElementsByTagName("video");return e.length?e[0]:document.createElement("video")},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysWebkit",shaka.polyfill.PatchedMediaKeysWebkit),goog.exportProperty(shaka.polyfill.PatchedMediaKeysWebkit,"install",shaka.polyfill.PatchedMediaKeysWebkit.install),shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess=function(e,t){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.internalKeySystem_=this.keySystem=e;var r=!1;"org.w3.clearkey"==e&&(this.internalKeySystem_="webkit-org.w3.clearkey",r=!1);for(var a=!1,n=shaka.polyfill.PatchedMediaKeysWebkit.getVideoElement_(),i=(t=$jscomp.makeIterator(t)).next();!i.done;i=t.next()){var o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(i=i.value).initDataTypes,sessionTypes:["temporary"],label:i.label},s=!1;if(i.audioCapabilities)for(var l=$jscomp.makeIterator(i.audioCapabilities),u=l.next();!u.done;u=l.next())if((u=u.value).contentType){s=!0;var c=u.contentType.split(";")[0];n.canPlayType(c,this.internalKeySystem_)&&(o.audioCapabilities.push(u),a=!0)}if(i.videoCapabilities)for(u=(l=$jscomp.makeIterator(i.videoCapabilities)).next();!u.done;u=l.next())(u=u.value).contentType&&(s=!0,n.canPlayType(u.contentType,this.internalKeySystem_)&&(o.videoCapabilities.push(u),a=!0));if(s||(a=n.canPlayType("video/mp4",this.internalKeySystem_)||n.canPlayType("video/webm",this.internalKeySystem_)),"required"==i.persistentState&&(r?(o.persistentState="required",o.sessionTypes=["persistent-license"]):a=!1),a)return void(this.configuration_=o)}throw r="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(r="None of the requested configurations were supported."),(e=Error(r)).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.createMediaKeys=function(){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys(this.internalKeySystem_);return Promise.resolve(e)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.getConfiguration=function(){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.configuration_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys=function(e){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys"),this.keySystem_=e,this.media_=null,this.eventManager_=new shaka.util.EventManager,this.newSessions_=[],this.sessionMap_=new Map},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setMedia=function(e){var t=this;this.media_=e,this.eventManager_.removeAll();var r=shaka.polyfill.PatchedMediaKeysWebkit.prefix_;e&&(this.eventManager_.listen(e,r+"needkey",(function(e){return t.onWebkitNeedKey_(e)})),this.eventManager_.listen(e,r+"keymessage",(function(e){return t.onWebkitKeyMessage_(e)})),this.eventManager_.listen(e,r+"keyadded",(function(e){return t.onWebkitKeyAdded_(e)})),this.eventManager_.listen(e,r+"keyerror",(function(e){return t.onWebkitKeyError_(e)})))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.createSession=function(e){if(shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=shaka.polyfill.PatchedMediaKeysWebkit,r=this.media_||document.createElement("video");return r.src||(r.src="about:blank"),e=new t.MediaKeySession(r,this.keySystem_,e),this.newSessions_.push(e),e},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setServerCertificate=function(e){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitNeedKey_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e),goog.asserts.assert(this.media_,"media_ not set in onWebkitNeedKey_");var t=new CustomEvent("encrypted");t.initDataType="cenc",t.initData=shaka.util.BufferUtils.toArrayBuffer(e.initData),this.media_.dispatchEvent(t)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyMessage_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=this.findSession_(e.sessionId);if(t){var r=null==t.keyStatuses.getStatus();e=(new Map).set("messageType",r?"licenserequest":"licenserenewal").set("message",e.message),e=new shaka.util.FakeEvent("message",e),t.generated(),t.dispatchEvent(e)}else shaka.log.error("Session not found",e.sessionId)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyAdded_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e),e=this.findSession_(e.sessionId),goog.asserts.assert(e,"unable to find session in onWebkitKeyAdded_"),e&&e.ready()},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyError_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=this.findSession_(e.sessionId);goog.asserts.assert(t,"unable to find session in onWebkitKeyError_"),t&&t.handleError(e)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.findSession_=function(e){var t=this.sessionMap_.get(e);return t?(shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):(t=this.newSessions_.shift())?(t.sessionId=e,this.sessionMap_.set(e,t),shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):null},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession=function(e,t,r){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession"),shaka.util.FakeEventTarget.call(this),this.media_=e,this.initialized_=!1,this.updatePromise_=this.generatePromise_=null,this.keySystem_=t,this.type_=r,this.sessionId="",this.expiration=NaN,this.closed=new shaka.util.PublicPromise,this.keyStatuses=new shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap},$jscomp.inherits(shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession,shaka.util.FakeEventTarget),shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generated=function(){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),this.generatePromise_&&(this.generatePromise_.resolve(),this.generatePromise_=null)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.ready=function(){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),this.updateKeyStatus_("usable"),this.updatePromise_&&this.updatePromise_.resolve(),this.updatePromise_=null},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.handleError=function(e){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=Error("EME v0.1b key error"),r=e.errorCode;r.systemCode=e.systemCode,t.errorCode=r,!e.sessionId&&this.generatePromise_?(45==e.systemCode&&(t.message="Unsupported session type."),this.generatePromise_.reject(t),this.generatePromise_=null):e.sessionId&&this.updatePromise_?(this.updatePromise_.reject(t),this.updatePromise_=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?this.updateKeyStatus_("output-restricted"):1==t?this.updateKeyStatus_("expired"):this.updateKeyStatus_("internal-error"))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generate_=function(e,t){var r=this,a=shaka.polyfill.PatchedMediaKeysWebkit;if(this.initialized_)return Promise.reject(Error("The session is already initialized."));this.initialized_=!0;try{if("persistent-license"==this.type_){var n=shaka.util.StringUtils;if(t)var i=shaka.util.BufferUtils.toUint8(n.toUTF8("LOAD_SESSION|"+t));else{goog.asserts.assert(e,"expecting init data");var o=n.toUTF8("PERSISTENT|");i=shaka.util.Uint8ArrayUtils.concat(o,e)}}else goog.asserts.assert("temporary"==this.type_,"expected temporary session"),goog.asserts.assert(!t,"unexpected offline session ID"),goog.asserts.assert(e,"expecting init data"),i=shaka.util.BufferUtils.toUint8(e);goog.asserts.assert(i,"init data not set!")}catch(e){return Promise.reject(e)}goog.asserts.assert(null==this.generatePromise_,"generatePromise_ should be null"),this.generatePromise_=new shaka.util.PublicPromise;var s=a.prefixApi_("generateKeyRequest");try{this.media_[s](this.keySystem_,i)}catch(e){if("InvalidStateError"!=e.name)return this.generatePromise_=null,Promise.reject(e);new shaka.util.Timer((function(){try{r.media_[s](r.keySystem_,i)}catch(e){r.generatePromise_.reject(e),r.generatePromise_=null}})).tickAfter(.01)}return this.generatePromise_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update_=function(e,t){var r=this,a=shaka.polyfill.PatchedMediaKeysWebkit;if(this.updatePromise_)this.updatePromise_.then((function(){return r.update_(e,t)})).catch((function(){return r.update_(e,t)}));else{if(this.updatePromise_=e,"webkit-org.w3.clearkey"==this.keySystem_){var n=shaka.util.Uint8ArrayUtils,i=shaka.util.StringUtils.fromUTF8(t),o=JSON.parse(i);"oct"!=o.keys[0].kty&&(this.updatePromise_.reject(Error("Response is not a valid JSON Web Key Set.")),this.updatePromise_=null),i=n.fromBase64(o.keys[0].k),n=n.fromBase64(o.keys[0].kid)}else i=shaka.util.BufferUtils.toUint8(t),n=null;a=a.prefixApi_("addKey");try{this.media_[a](this.keySystem_,i,n,this.sessionId)}catch(e){this.updatePromise_.reject(e),this.updatePromise_=null}}},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.updateKeyStatus_=function(e){this.keyStatuses.setStatus(e),e=new shaka.util.FakeEvent("keystatuseschange"),this.dispatchEvent(e)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generateRequest=function(e,t){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),this.generate_(t,null)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.load=function(e){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.type_?this.generate_(null,e):Promise.reject(Error("Not a persistent session."))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update=function(e){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e),goog.asserts.assert(this.sessionId,"update without session ID");var t=new shaka.util.PublicPromise;return this.update_(t,e),t},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.close=function(){var e=shaka.polyfill.PatchedMediaKeysWebkit;if(shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.type_){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;e=e.prefixApi_("cancelKeyRequest");try{this.media_[e](this.keySystem_,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.remove=function(){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.type_?Promise.reject(Error("Not a persistent session.")):this.close()},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap=function(){this.size=0,this.status_=void 0},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.setStatus=function(e){this.size=null==e?0:1,this.status_=e},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.getStatus=function(){return this.status_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.forEach=function(e){this.status_&&e(this.status_,shaka.media.DrmEngine.DUMMY_KEY_ID.value())},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.get=function(e){if(this.has(e))return this.status_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.has=function(e){var t=shaka.media.DrmEngine.DUMMY_KEY_ID.value();return!(!this.status_||!shaka.util.BufferUtils.equal(e,t))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.entries=function(){goog.asserts.assert(!1,"Not used!  Provided only for compiler.")},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.keys=function(){goog.asserts.assert(!1,"Not used!  Provided only for compiler.")},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.values=function(){goog.asserts.assert(!1,"Not used!  Provided only for compiler.")},shaka.polyfill.PatchedMediaKeysWebkit.prefix_="",shaka.polyfill.register(shaka.polyfill.PatchedMediaKeysWebkit.install),shaka.polyfill.PiPWebkit=function(){},shaka.polyfill.PiPWebkit.install=function(){if(window.HTMLVideoElement){var e=HTMLVideoElement.prototype;if((!e.requestPictureInPicture||!document.exitPictureInPicture)&&e.webkitSupportsPresentationMode){var t=shaka.polyfill.PiPWebkit;shaka.log.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=t.requestPictureInPicture_,Object.defineProperty(e,"disablePictureInPicture",{get:t.getDisablePictureInPicture_,set:t.setDisablePictureInPicture_,enumerable:!0,configurable:!0}),document.exitPictureInPicture=t.exitPictureInPicture_,document.addEventListener("webkitpresentationmodechanged",t.proxyEvent_,!0)}}},shaka.polyfill.PiPWebkit.proxyEvent_=function(e){if((e=e.target).webkitPresentationMode==shaka.polyfill.PiPWebkit.PIP_MODE_){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)},shaka.polyfill.PiPWebkit.requestPictureInPicture_=function(){var e=shaka.polyfill.PiPWebkit;return this.webkitSupportsPresentationMode(e.PIP_MODE_)?(this.webkitSetPresentationMode(e.PIP_MODE_),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))},shaka.polyfill.PiPWebkit.exitPictureInPicture_=function(){var e=shaka.polyfill.PiPWebkit,t=document.pictureInPictureElement;return t?(t.webkitSetPresentationMode(e.INLINE_MODE_),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))},shaka.polyfill.PiPWebkit.getDisablePictureInPicture_=function(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode(shaka.polyfill.PiPWebkit.PIP_MODE_)},shaka.polyfill.PiPWebkit.setDisablePictureInPicture_=function(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")},goog.exportProperty(shaka.polyfill,"PiPWebkit",shaka.polyfill.PiPWebkit),goog.exportProperty(shaka.polyfill.PiPWebkit,"install",shaka.polyfill.PiPWebkit.install),shaka.polyfill.PiPWebkit.PIP_MODE_="picture-in-picture",shaka.polyfill.PiPWebkit.INLINE_MODE_="inline",shaka.polyfill.register(shaka.polyfill.PiPWebkit.install),shaka.polyfill.RandomUUID=function(){},shaka.polyfill.RandomUUID.install=function(){shaka.log.debug("randomUUID.install"),window.crypto?"randomUUID"in window.crypto?shaka.log.debug("RandomUUID: Native window.crypto.randomUUID() support found."):window.crypto.randomUUID=shaka.polyfill.RandomUUID.randomUUID_:shaka.log.debug("window.crypto must be available to install randomUUID polyfill.")},shaka.polyfill.RandomUUID.randomUUID_=function(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)},goog.exportProperty(shaka.polyfill,"RandomUUID",shaka.polyfill.RandomUUID),goog.exportProperty(shaka.polyfill.RandomUUID,"install",shaka.polyfill.RandomUUID.install),shaka.polyfill.register(shaka.polyfill.RandomUUID.install),shaka.polyfill.StorageEstimate=function(){},shaka.polyfill.StorageEstimate.install=function(){navigator.storage&&navigator.storage.estimate||!navigator.webkitTemporaryStorage||!navigator.webkitTemporaryStorage.queryUsageAndQuota||("storage"in navigator||(navigator.storage={}),navigator.storage.estimate=shaka.polyfill.StorageEstimate.storageEstimate_)},shaka.polyfill.StorageEstimate.storageEstimate_=function(){return new Promise((function(e,t){navigator.webkitTemporaryStorage.queryUsageAndQuota((function(t,r){e({usage:t,quota:r})}),t)}))},goog.exportProperty(shaka.polyfill,"StorageEstimate",shaka.polyfill.StorageEstimate),goog.exportProperty(shaka.polyfill.StorageEstimate,"install",shaka.polyfill.StorageEstimate.install),shaka.polyfill.register(shaka.polyfill.StorageEstimate.install),shaka.polyfill.Symbol=function(){},shaka.polyfill.Symbol.install=function(){shaka.log.debug("Symbol.install");var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:shaka.polyfill.Symbol.getSymbolDescription_})},shaka.polyfill.Symbol.getSymbolDescription_=function(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0},goog.exportProperty(shaka.polyfill,"Symbol",shaka.polyfill.Symbol),goog.exportProperty(shaka.polyfill.Symbol,"install",shaka.polyfill.Symbol.install),shaka.polyfill.register(shaka.polyfill.Symbol.install),shaka.polyfill.VideoPlayPromise=function(){},shaka.polyfill.VideoPlayPromise.install=function(){if(shaka.log.debug("VideoPlayPromise.install"),window.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch((function(){})),t}}},goog.exportProperty(shaka.polyfill,"VideoPlayPromise",shaka.polyfill.VideoPlayPromise),goog.exportProperty(shaka.polyfill.VideoPlayPromise,"install",shaka.polyfill.VideoPlayPromise.install),shaka.polyfill.register(shaka.polyfill.VideoPlayPromise.install),shaka.polyfill.VideoPlaybackQuality=function(){},shaka.polyfill.VideoPlaybackQuality.install=function(){if(window.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in e||shaka.util.Platform.isWebOS3())&&(e.getVideoPlaybackQuality=shaka.polyfill.VideoPlaybackQuality.webkit_)}},shaka.polyfill.VideoPlaybackQuality.webkit_=function(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}},goog.exportProperty(shaka.polyfill,"VideoPlaybackQuality",shaka.polyfill.VideoPlaybackQuality),goog.exportProperty(shaka.polyfill.VideoPlaybackQuality,"install",shaka.polyfill.VideoPlaybackQuality.install),shaka.polyfill.register(shaka.polyfill.VideoPlaybackQuality.install),shaka.polyfill.VTTCue=function(){},shaka.polyfill.VTTCue.install=function(){if(window.VTTCue)shaka.log.info("Using native VTTCue.");else if(window.TextTrackCue){var e=null,t=TextTrackCue.length;3==t?(shaka.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e=shaka.polyfill.VTTCue.from3ArgsTextTrackCue_):6==t?(shaka.log.info("Using VTTCue polyfill from 6 argument TextTrackCue."),e=shaka.polyfill.VTTCue.from6ArgsTextTrackCue_):shaka.polyfill.VTTCue.canUse3ArgsTextTrackCue_()&&(shaka.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e=shaka.polyfill.VTTCue.from3ArgsTextTrackCue_),e?window.VTTCue=function(t,r,a){return e(t,r,a)}:shaka.log.error("No recognized signature for TextTrackCue found!")}else shaka.log.error("VTTCue not available.")},shaka.polyfill.VTTCue.from3ArgsTextTrackCue_=function(e,t,r){return new window.TextTrackCue(e,t,r)},shaka.polyfill.VTTCue.from6ArgsTextTrackCue_=function(e,t,r){return new window.TextTrackCue(e+"-"+t+"-"+r,e,t,r)},shaka.polyfill.VTTCue.canUse3ArgsTextTrackCue_=function(){try{return!!shaka.polyfill.VTTCue.from3ArgsTextTrackCue_(1,2,"")}catch(e){return!1}},goog.exportProperty(shaka.polyfill,"VTTCue",shaka.polyfill.VTTCue),goog.exportProperty(shaka.polyfill.VTTCue,"install",shaka.polyfill.VTTCue.install),shaka.polyfill.register(shaka.polyfill.VTTCue.install),shaka.text.LrcTextParser=function(){},shaka.text.LrcTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"LRC does not have init segments")},shaka.text.LrcTextParser.prototype.setSequenceMode=function(e){},shaka.text.LrcTextParser.prototype.parseMedia=function(e,t){var r=shaka.text.LrcTextParser,a=null,n=[];e=shaka.util.StringUtils.fromUTF8(e).split(/\r?\n/);for(var i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next()){var o=i.value;o&&!/^\s+$/.test(o)&&((i=r.lyricLine_.exec(o))?(o=r.parseTime_(i[1]),i=new shaka.text.Cue(o,t.segmentEnd?t.segmentEnd:o+2,i[2]),a&&(a.endTime=o,n.push(a)),a=i):shaka.log.warning("LrcTextParser encountered an unknown line.",o))}return a&&n.push(a),n},shaka.text.LrcTextParser.parseTime_=function(e){var t=shaka.text.LrcTextParser.timeFormat_.exec(e);return 60*(e=parseInt(t[1],10))+(t=parseFloat(t[2].replace(",",".")))},goog.exportSymbol("shaka.text.LrcTextParser",shaka.text.LrcTextParser),goog.exportProperty(shaka.text.LrcTextParser.prototype,"parseMedia",shaka.text.LrcTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.LrcTextParser.prototype,"setSequenceMode",shaka.text.LrcTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.LrcTextParser.prototype,"parseInit",shaka.text.LrcTextParser.prototype.parseInit),shaka.text.LrcTextParser.lyricLine_=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,shaka.text.LrcTextParser.timeFormat_=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/,shaka.text.TextEngine.registerParser("application/x-subtitle-lrc",(function(){return new shaka.text.LrcTextParser})),shaka.text.TtmlTextParser=function(){},shaka.text.TtmlTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"TTML does not have init segments")},shaka.text.TtmlTextParser.prototype.setSequenceMode=function(e){},shaka.text.TtmlTextParser.prototype.parseMedia=function(e,t){var r=shaka.text.TtmlTextParser,a=shaka.util.XmlUtils,n=r.parameterNs_,i=r.styleNs_,o=shaka.util.StringUtils.fromUTF8(e);if(e=[],""==o)return e;var s=a.parseXmlString(o,"tt");if(!s)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_XML,"Failed to parse TTML.");if(!(o=s.getElementsByTagName("body")[0]))return[];var l=a.getAttributeNSList(s,n,"frameRate"),u=a.getAttributeNSList(s,n,"subFrameRate"),c=a.getAttributeNSList(s,n,"frameRateMultiplier"),d=a.getAttributeNSList(s,n,"tickRate"),p=a.getAttributeNSList(s,n,"cellResolution"),h=s.getAttribute("xml:space")||"default";if(n=a.getAttributeNSList(s,i,"extent"),"default"!=h&&"preserve"!=h)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_XML,"Invalid xml:space value: "+h);i="default"==h,l=new r.RateInfo_(l,u,c,d),u=r.getCellResolution_(p),c=(c=s.getElementsByTagName("metadata")[0])?a.getChildren(c):[],d=Array.from(s.getElementsByTagName("style")),s=Array.from(s.getElementsByTagName("region")),p=[];for(var f=(h=$jscomp.makeIterator(s)).next();!f.done;f=h.next())(f=r.parseCueRegion_(f.value,d,n))&&p.push(f);if(a.findChildren(o,"p").length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"<p> can only be inside <div> in TTML");for(h=(n=$jscomp.makeIterator(a.findChildren(o,"div"))).next();!h.done;h=n.next())if(a.findChildren(h.value,"span").length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"<span> can only be inside <p> in TTML");return(t=r.parseCue_(o,t,l,c,d,s,p,i,u,null,!1))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},shaka.text.TtmlTextParser.parseCue_=function(e,t,r,a,n,i,o,s,l,u,c){var d=e.parentNode;if(e.nodeType==Node.COMMENT_NODE)return null;if(e.nodeType==Node.TEXT_NODE){if(!c)return null;var p=document.createElement("span");p.textContent=e.textContent}else goog.asserts.assert(e.nodeType==Node.ELEMENT_NODE,"nodeType should be ELEMENT_NODE!"),p=e;goog.asserts.assert(p,"cueElement should be non-null!");for(var h=null,f=$jscomp.makeIterator(shaka.text.TtmlTextParser.smpteNsList_),g=f.next();!g.done&&!(h=shaka.text.TtmlTextParser.getElementsFromCollection_(p,"backgroundImage",a,"#",g.value)[0]);g=f.next());if(f=c,("p"==e.nodeName||h)&&(c=!0),s="default"==(p.getAttribute("xml:space")||(s?"default":"preserve")),e=[],!(g=Array.from(p.childNodes).every((function(e){return e.nodeType==Node.TEXT_NODE}))))for(var y=$jscomp.makeIterator(p.childNodes),m=y.next();!m.done;m=y.next())(m=shaka.text.TtmlTextParser.parseCue_(m.value,t,r,a,n,i,o,s,l,p,c))&&e.push(m);a=null!=u,y=/\S/.test(p.textContent);var v=p.hasAttribute("begin")||p.hasAttribute("end")||p.hasAttribute("dur");if(!(v||y||"br"==p.tagName||0!=e.length||a&&!s))return null;for(y=(m=shaka.text.TtmlTextParser.parseTime_(p,r)).start,m=m.end;d&&d.nodeType==Node.ELEMENT_NODE&&"tt"!=d.tagName;)y=(m=shaka.text.TtmlTextParser.resolveTime_(d,r,y,m)).start,m=m.end,d=d.parentNode;if(null==y&&(y=0),y+=t.periodStart,m=null==m?1/0:m+t.periodStart,y=Math.max(y,t.segmentStart),m=Math.min(m,t.segmentEnd),!v&&0<e.length)for(y=1/0,m=0,r=(t=$jscomp.makeIterator(e)).next();!r.done;r=t.next())r=r.value,y=Math.min(y,r.startTime),m=Math.max(m,r.endTime);if("br"==p.tagName)return(n=new shaka.text.Cue(y,m,"")).lineBreak=!0,n;if(t="",g&&(t=p.textContent,s&&(t=(t=t.trim()).replace(/\s+/g," "))),(t=new shaka.text.Cue(y,m,t)).nestedCues=e,c||(t.isContainer=!0),l&&(t.cellResolution=l),l=shaka.text.TtmlTextParser.getElementsFromCollection_(p,"region",i,"")[0],p.hasAttribute("region")&&l&&l.getAttribute("xml:id")){var _=l.getAttribute("xml:id");t.region=o.filter((function(e){return e.id==_}))[0]}return o=l,u&&a&&!p.getAttribute("region")&&!p.getAttribute("style")&&(o=shaka.text.TtmlTextParser.getElementsFromCollection_(u,"region",i,"")[0]),shaka.text.TtmlTextParser.addStyle_(t,p,o,h,n,f,0==e.length),t},shaka.text.TtmlTextParser.parseCueRegion_=function(e,t,r){var a,n,i=shaka.text.TtmlTextParser,o=new shaka.text.CueRegion,s=e.getAttribute("xml:id");return s?(o.id=s,s=null,r&&(s=i.percentValues_.exec(r)||i.pixelValues_.exec(r)),r=s?Number(s[1]):null,s=s?Number(s[2]):null,(a=i.getStyleAttributeFromRegion_(e,t,"extent"))&&(null!=(a=(n=i.percentValues_.exec(a))||i.pixelValues_.exec(a))&&(o.width=Number(a[1]),o.height=Number(a[2]),n||(null!=r&&(o.width=100*o.width/r),null!=s&&(o.height=100*o.height/s)),o.widthUnits=n||null!=r?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.PX,o.heightUnits=n||null!=s?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.PX)),(e=i.getStyleAttributeFromRegion_(e,t,"origin"))&&(null!=(a=(n=i.percentValues_.exec(e))||i.pixelValues_.exec(e))&&(o.viewportAnchorX=Number(a[1]),o.viewportAnchorY=Number(a[2]),n||(null!=s&&(o.viewportAnchorY=100*o.viewportAnchorY/s),null!=r&&(o.viewportAnchorX=100*o.viewportAnchorX/r)),o.viewportAnchorUnits=n||null!=r?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.PX)),o):(shaka.log.warning("TtmlTextParser parser encountered a region with no id. Region will be ignored."),null)},shaka.text.TtmlTextParser.addStyle_=function(e,t,r,a,n,i,o){var s=shaka.text.TtmlTextParser,l=shaka.text.Cue;if(i=i||o,"rtl"==s.getStyleAttribute_(t,r,n,"direction",i)&&(e.direction=l.direction.HORIZONTAL_RIGHT_TO_LEFT),"tb"==(o=s.getStyleAttribute_(t,r,n,"writingMode",i))||"tblr"==o?e.writingMode=l.writingMode.VERTICAL_LEFT_TO_RIGHT:"tbrl"==o?e.writingMode=l.writingMode.VERTICAL_RIGHT_TO_LEFT:"rltb"==o||"rl"==o?e.direction=l.direction.HORIZONTAL_RIGHT_TO_LEFT:o&&(e.direction=l.direction.HORIZONTAL_LEFT_TO_RIGHT),(o=s.getStyleAttribute_(t,r,n,"textAlign",!0))?(e.positionAlign=s.textAlignToPositionAlign_[o],e.lineAlign=s.textAlignToLineAlign_[o],goog.asserts.assert(o.toUpperCase()in l.textAlign,o.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=l.textAlign[o.toUpperCase()]):e.textAlign=l.textAlign.CENTER,(o=s.getStyleAttribute_(t,r,n,"displayAlign",!0))&&(goog.asserts.assert(o.toUpperCase()in l.displayAlign,o.toUpperCase()+" Should be in Cue.displayAlign values!"),e.displayAlign=l.displayAlign[o.toUpperCase()]),(o=s.getStyleAttribute_(t,r,n,"color",i))&&(e.color=o),(o=s.getStyleAttribute_(t,r,n,"backgroundColor",i))&&(e.backgroundColor=o),(o=s.getStyleAttribute_(t,r,n,"border",i))&&(e.border=o),o=s.getStyleAttribute_(t,r,n,"fontFamily",i))switch(o){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=o}(o=s.getStyleAttribute_(t,r,n,"fontWeight",i))&&"bold"==o&&(e.fontWeight=l.fontWeight.BOLD),o=s.getStyleAttribute_(t,r,n,"wrapOption",i),e.wrapLine=!o||"noWrap"!=o,(o=s.getStyleAttribute_(t,r,n,"lineHeight",i))&&o.match(s.unitValues_)&&(e.lineHeight=o),(o=s.getStyleAttribute_(t,r,n,"fontSize",i))&&(o.match(s.unitValues_)||o.match(s.percentValue_))&&(e.fontSize=o),(o=s.getStyleAttribute_(t,r,n,"fontStyle",i))&&(goog.asserts.assert(o.toUpperCase()in l.fontStyle,o.toUpperCase()+" Should be in Cue.fontStyle values!"),e.fontStyle=l.fontStyle[o.toUpperCase()]),a&&(l=a.getAttribute("imageType")||a.getAttribute("imagetype"),o=a.getAttribute("encoding"),a=a.textContent.trim(),"PNG"==l&&"Base64"==o&&a&&(e.backgroundImage="data:image/png;base64,"+a)),(a=s.getStyleAttribute_(t,r,n,"textOutline",i))&&((a=a.split(" "))[0].match(s.unitValues_)?e.textStrokeColor=e.color:(e.textStrokeColor=a[0],a.shift()),a[0]&&a[0].match(s.unitValues_)?e.textStrokeWidth=a[0]:e.textStrokeColor=""),(a=s.getStyleAttribute_(t,r,n,"letterSpacing",i))&&a.match(s.unitValues_)&&(e.letterSpacing=a),(a=s.getStyleAttribute_(t,r,n,"linePadding",i))&&a.match(s.unitValues_)&&(e.linePadding=a),(i=s.getStyleAttribute_(t,r,n,"opacity",i))&&(e.opacity=parseFloat(i)),(r=s.getStyleAttributeFromRegion_(r,n,"textDecoration"))&&s.addTextDecoration_(e,r),(t=s.getStyleAttributeFromElement_(t,n,"textDecoration"))&&s.addTextDecoration_(e,t)},shaka.text.TtmlTextParser.addTextDecoration_=function(e,t){for(var r=shaka.text.Cue,a=(t=$jscomp.makeIterator(t.split(" "))).next();!a.done;a=t.next())switch(a.value){case"underline":e.textDecoration.includes(r.textDecoration.UNDERLINE)||e.textDecoration.push(r.textDecoration.UNDERLINE);break;case"noUnderline":e.textDecoration.includes(r.textDecoration.UNDERLINE)&&shaka.util.ArrayUtils.remove(e.textDecoration,r.textDecoration.UNDERLINE);break;case"lineThrough":e.textDecoration.includes(r.textDecoration.LINE_THROUGH)||e.textDecoration.push(r.textDecoration.LINE_THROUGH);break;case"noLineThrough":e.textDecoration.includes(r.textDecoration.LINE_THROUGH)&&shaka.util.ArrayUtils.remove(e.textDecoration,r.textDecoration.LINE_THROUGH);break;case"overline":e.textDecoration.includes(r.textDecoration.OVERLINE)||e.textDecoration.push(r.textDecoration.OVERLINE);break;case"noOverline":e.textDecoration.includes(r.textDecoration.OVERLINE)&&shaka.util.ArrayUtils.remove(e.textDecoration,r.textDecoration.OVERLINE)}},shaka.text.TtmlTextParser.getStyleAttribute_=function(e,t,r,a,n){n=void 0===n||n;var i=shaka.text.TtmlTextParser;return(e=i.getStyleAttributeFromElement_(e,r,a))?e:n?i.getStyleAttributeFromRegion_(t,r,a):null},shaka.text.TtmlTextParser.getStyleAttributeFromRegion_=function(e,t,r){if(!e)return null;var a=shaka.util.XmlUtils.getAttributeNSList(e,shaka.text.TtmlTextParser.styleNs_,r);return a||shaka.text.TtmlTextParser.getInheritedStyleAttribute_(e,t,r)},shaka.text.TtmlTextParser.getStyleAttributeFromElement_=function(e,t,r){var a=shaka.util.XmlUtils.getAttributeNSList(e,shaka.text.TtmlTextParser.styleNs_,r);return a||shaka.text.TtmlTextParser.getInheritedStyleAttribute_(e,t,r)},shaka.text.TtmlTextParser.getInheritedStyleAttribute_=function(e,t,r){var a=shaka.util.XmlUtils,n=shaka.text.TtmlTextParser.styleNs_,i=shaka.text.TtmlTextParser.styleEbuttsNs_;e=shaka.text.TtmlTextParser.getElementsFromCollection_(e,"style",t,"");for(var o=null,s=0;s<e.length;s++){var l=a.getAttributeNS(e[s],i,r);l||(l=a.getAttributeNSList(e[s],n,r)),l||(l=shaka.text.TtmlTextParser.getStyleAttributeFromElement_(e[s],t,r)),l&&(o=l)}return o},shaka.text.TtmlTextParser.getElementsFromCollection_=function(e,t,r,a,n){var i=[];if(!e||1>r.length)return i;if(e=shaka.text.TtmlTextParser.getInheritedAttribute_(e,t,n))for(e=e.split(" "),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){t=t.value;for(var o=(n=$jscomp.makeIterator(r)).next();!o.done;o=n.next())if(a+(o=o.value).getAttribute("xml:id")==t){i.push(o);break}}return i},shaka.text.TtmlTextParser.getInheritedAttribute_=function(e,t,r){for(var a=null,n=shaka.util.XmlUtils;e&&!(a=r?n.getAttributeNS(e,r,t):e.getAttribute(t))&&(e=e.parentNode)instanceof Element;);return a},shaka.text.TtmlTextParser.resolveTime_=function(e,t,r,a){return e=shaka.text.TtmlTextParser.parseTime_(e,t),null==r?r=e.start:null!=e.start&&(r+=e.start),null==a?a=e.end:null!=e.start&&(a+=e.start),{start:r,end:a}},shaka.text.TtmlTextParser.parseTime_=function(e,t){var r=shaka.text.TtmlTextParser.parseTimeAttribute_(e.getAttribute("begin"),t),a=shaka.text.TtmlTextParser.parseTimeAttribute_(e.getAttribute("end"),t);return e=shaka.text.TtmlTextParser.parseTimeAttribute_(e.getAttribute("dur"),t),null==a&&null!=e&&(a=r+e),{start:r,end:a}},shaka.text.TtmlTextParser.parseTimeAttribute_=function(e,t){var r=null,a=shaka.text.TtmlTextParser;if(a.timeColonFormatFrames_.test(e))r=a.parseColonTimeWithFrames_(t,e);else if(a.timeColonFormat_.test(e))r=a.parseTimeFromRegex_(a.timeColonFormat_,e);else if(a.timeColonFormatMilliseconds_.test(e))r=a.parseTimeFromRegex_(a.timeColonFormatMilliseconds_,e);else if(a.timeFramesFormat_.test(e))r=a.parseFramesTime_(t,e);else if(a.timeTickFormat_.test(e))r=a.parseTickTime_(t,e);else if(a.timeHMSFormat_.test(e))r=a.parseTimeFromRegex_(a.timeHMSFormat_,e);else if(e)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"Could not parse cue time range in TTML");return r},shaka.text.TtmlTextParser.parseFramesTime_=function(e,t){return t=shaka.text.TtmlTextParser.timeFramesFormat_.exec(t),Number(t[1])/e.frameRate},shaka.text.TtmlTextParser.parseTickTime_=function(e,t){return t=shaka.text.TtmlTextParser.timeTickFormat_.exec(t),Number(t[1])/e.tickRate},shaka.text.TtmlTextParser.parseColonTimeWithFrames_=function(e,t){t=shaka.text.TtmlTextParser.timeColonFormatFrames_.exec(t);var r=Number(t[1]),a=Number(t[2]),n=Number(t[3]),i=Number(t[4]);return(n+=(i+=(Number(t[5])||0)/e.subFrameRate)/e.frameRate)+60*a+3600*r},shaka.text.TtmlTextParser.parseTimeFromRegex_=function(e,t){return null==(e=e.exec(t))||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)},shaka.text.TtmlTextParser.getCellResolution_=function(e){if(!e)return null;var t=/^(\d+) (\d+)$/.exec(e);return t?{columns:e=parseInt(t[1],10),rows:t=parseInt(t[2],10)}:null},goog.exportSymbol("shaka.text.TtmlTextParser",shaka.text.TtmlTextParser),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"parseMedia",shaka.text.TtmlTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"setSequenceMode",shaka.text.TtmlTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"parseInit",shaka.text.TtmlTextParser.prototype.parseInit),shaka.text.TtmlTextParser.RateInfo_=function(e,t,r,a){this.frameRate=Number(e)||30,this.subFrameRate=Number(t)||1,this.tickRate=Number(a),0==this.tickRate&&(this.tickRate=e?this.frameRate*this.subFrameRate:1),r&&(e=/^(\d+) (\d+)$/g.exec(r))&&(this.frameRate*=Number(e[1])/Number(e[2]))},shaka.text.TtmlTextParser.percentValues_=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,shaka.text.TtmlTextParser.percentValue_=/^(\d{1,2}(?:\.\d+)?|100)%$/,shaka.text.TtmlTextParser.unitValues_=/^(\d+px|\d+em|\d*\.?\d+c)$/,shaka.text.TtmlTextParser.pixelValues_=/^(\d+)px (\d+)px$/,shaka.text.TtmlTextParser.timeColonFormatFrames_=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,shaka.text.TtmlTextParser.timeColonFormat_=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,shaka.text.TtmlTextParser.timeColonFormatMilliseconds_=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,shaka.text.TtmlTextParser.timeFramesFormat_=/^(\d*(?:\.\d*)?)f$/,shaka.text.TtmlTextParser.timeTickFormat_=/^(\d*(?:\.\d*)?)t$/,shaka.text.TtmlTextParser.timeHMSFormat_=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),shaka.text.TtmlTextParser.textAlignToLineAlign_={left:shaka.text.Cue.lineAlign.START,center:shaka.text.Cue.lineAlign.CENTER,right:shaka.text.Cue.lineAlign.END,start:shaka.text.Cue.lineAlign.START,end:shaka.text.Cue.lineAlign.END},shaka.text.TtmlTextParser.textAlignToPositionAlign_={left:shaka.text.Cue.positionAlign.LEFT,center:shaka.text.Cue.positionAlign.CENTER,right:shaka.text.Cue.positionAlign.RIGHT},shaka.text.TtmlTextParser.parameterNs_=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],shaka.text.TtmlTextParser.styleNs_=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],shaka.text.TtmlTextParser.styleEbuttsNs_="urn:ebu:tt:style",shaka.text.TtmlTextParser.smpteNsList_=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"],shaka.text.TextEngine.registerParser("application/ttml+xml",(function(){return new shaka.text.TtmlTextParser})),shaka.text.Mp4TtmlParser=function(){this.parser_=new shaka.text.TtmlTextParser},shaka.text.Mp4TtmlParser.prototype.parseInit=function(e){var t=shaka.util.Mp4Parser,r=!1;if((new t).box("moov",t.children).box("trak",t.children).box("mdia",t.children).box("minf",t.children).box("stbl",t.children).fullBox("stsd",t.sampleDescription).box("stpp",(function(e){r=!0,e.parser.stop()})).parse(e),!r)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_TTML)},shaka.text.Mp4TtmlParser.prototype.setSequenceMode=function(e){},shaka.text.Mp4TtmlParser.prototype.parseMedia=function(e,t){var r=this,a=shaka.util.Mp4Parser,n=!1,i=[];if((new a).box("mdat",a.allData((function(e){n=!0,i=i.concat(r.parser_.parseMedia(e,t))}))).parse(e,!1),!n)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_TTML);return i},goog.exportSymbol("shaka.text.Mp4TtmlParser",shaka.text.Mp4TtmlParser),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"parseMedia",shaka.text.Mp4TtmlParser.prototype.parseMedia),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"setSequenceMode",shaka.text.Mp4TtmlParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"parseInit",shaka.text.Mp4TtmlParser.prototype.parseInit),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml.im1t"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.TTML.im1t"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.VttTextParser=function(){this.sequenceMode_=!1},shaka.text.VttTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"VTT does not have init segments")},shaka.text.VttTextParser.prototype.setSequenceMode=function(e){this.sequenceMode_=e},shaka.text.VttTextParser.prototype.parseMedia=function(e,t){var r=shaka.text.VttTextParser;if(e=(e=(e=shaka.util.StringUtils.fromUTF8(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(e[0]))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_HEADER);var a=t.vttOffset;if(e[0].includes("X-TIMESTAMP-MAP")&&this.sequenceMode_){var n=e[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),i=e[0].match(/MPEGTS:(\d+)/m);if(n&&i){if(a=new shaka.util.TextParser(n[1]),null==(a=shaka.text.VttTextParser.parseTime_(a)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_HEADER);i=Number(i[1]),n=shaka.text.VttTextParser.MPEG_TIMESCALE_;for(var o=shaka.text.VttTextParser.TS_ROLLOVER_/n,s=t.segmentStart-t.periodStart;s>=o;)s-=o,i+=shaka.text.VttTextParser.TS_ROLLOVER_;a=t.periodStart+i/n-a}}for(t=[],n=(i=$jscomp.makeIterator(e[0].split("\n"))).next();!n.done;n=i.next())n=n.value,/^Region:/.test(n)&&(n=r.parseRegion_(n),t.push(n));for(i=new Map,r.addDefaultTextColor_(i),n=[],o=(e=$jscomp.makeIterator(e.slice(1))).next();!o.done;o=e.next())o=o.value.split("\n"),r.parseStyle_(o,i),(o=r.parseCue_(o,a,t,i))&&n.push(o);return n},shaka.text.VttTextParser.addDefaultTextColor_=function(e){for(var t=$jscomp.makeIterator(Object.entries(shaka.text.Cue.defaultTextColor)),r=t.next();!r.done;r=t.next()){var a=$jscomp.makeIterator(r.value);r=a.next().value,a=a.next().value;var n=new shaka.text.Cue(0,0,"");n.color=a,e.set("."+r,n)}for(r=(t=$jscomp.makeIterator(Object.entries(shaka.text.Cue.defaultTextBackgroundColor))).next();!r.done;r=t.next())r=(a=$jscomp.makeIterator(r.value)).next().value,a=a.next().value,(n=new shaka.text.Cue(0,0,"")).backgroundColor=a,e.set("."+r,n)},shaka.text.VttTextParser.parseRegion_=function(e){var t=shaka.text.VttTextParser;e=new shaka.util.TextParser(e);var r=new shaka.text.CueRegion;e.readWord(),e.skipWhitespace();for(var a=e.readWord();a;)t.parseRegionSetting_(r,a)||shaka.log.warning("VTT parser encountered an invalid VTTRegion setting: ",a," The setting will be ignored."),e.skipWhitespace(),a=e.readWord();return r},shaka.text.VttTextParser.parseStyle_=function(e,t){if((1!=e.length||e[0])&&!/^NOTE($|[ \t])/.test(e[0])&&"STYLE"==e[0]){for(var r=[],a=-1,n=1;n<e.length;n++)e[n].includes("::cue")&&(r.push([]),a=r.length-1),-1!=a&&(r[a].push(e[n]),e[n].includes("}")&&(a=-1));for(r=(e=$jscomp.makeIterator(r)).next();!r.done;r=e.next()){n=r.value,r="global",(a=n[0].match(/\((.*)\)/))&&(r=a.pop()),a=n.slice(1,-1),n[0].includes("}")&&(n=/\{(.*?)\}/.exec(n[0]))&&(a=n[1].split(";")),(n=t.get(r))||(n=new shaka.text.Cue(0,0,""));for(var i=!1,o=0;o<a.length;o++){var s=/^\s*([^:]+):\s*(.*)/.exec(a[o]);if(s){var l=s[1].trim(),u=s[2].trim().replace(";","");switch(l){case"background-color":case"background":i=!0,n.backgroundColor=u;break;case"color":i=!0,n.color=u;break;case"font-family":i=!0,n.fontFamily=u;break;case"font-size":i=!0,n.fontSize=u;break;case"font-weight":(700<=parseInt(u,10)||"bold"==u)&&(i=!0,n.fontWeight=shaka.text.Cue.fontWeight.BOLD);break;case"font-style":switch(u){case"normal":i=!0,n.fontStyle=shaka.text.Cue.fontStyle.NORMAL;break;case"italic":i=!0,n.fontStyle=shaka.text.Cue.fontStyle.ITALIC;break;case"oblique":i=!0,n.fontStyle=shaka.text.Cue.fontStyle.OBLIQUE}break;case"opacity":i=!0,n.opacity=parseFloat(u);break;case"text-shadow":i=!0,n.textShadow=u;break;case"white-space":i=!0,n.wrapLine="noWrap"!=u;break;default:shaka.log.warning("VTT parser encountered an unsupported style: ",s)}}}i&&t.set(r,n)}}},shaka.text.VttTextParser.parseCue_=function(e,t,r,a){var n=shaka.text.VttTextParser;if(1==e.length&&!e[0]||/^NOTE($|[ \t])/.test(e[0])||"STYLE"==e[0]||"REGION"==e[0])return null;var i=null;e[0].includes("--\x3e")||(i=e[0],e.splice(0,1));var o=new shaka.util.TextParser(e[0]),s=n.parseTime_(o),l=o.readRegex(/[ \t]+--\x3e[ \t]+/g),u=n.parseTime_(o);if(null==s||null==l||null==u)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"Could not parse cue time range in WebVTT");for(s+=t,u+=t,t=e.slice(1).join("\n").trim(),a.has("global")?((e=a.get("global").clone()).startTime=s,e.endTime=u,e.payload=""):e=new shaka.text.Cue(s,u,""),n.parseCueStyles(t,e,a),o.skipWhitespace(),a=o.readWord();a;)n.parseCueSetting(e,a,r)||shaka.log.warning("VTT parser encountered an invalid VTT setting: ",a," The setting will be ignored."),o.skipWhitespace(),a=o.readWord();return null!=i&&(e.id=i),e},shaka.text.VttTextParser.parseCueStyles=function(e,t,r){var a=shaka.text.VttTextParser;0===r.size&&a.addDefaultTextColor_(r),e=a.replaceColorPayload_(e),e=a.replaceKaraokeStylePayload_(e),e=a.replaceVoiceStylePayload_(e);var n=shaka.util.XmlUtils.parseXmlString("<span>"+e+"</span>","span");if(n){var i=[];if(1==(n=n.childNodes).length){var o=n[0];if(o.nodeType==Node.TEXT_NODE||o.nodeType==Node.CDATA_SECTION_NODE)return void(t.payload=a.htmlUnescape_(e))}for(n=(e=$jscomp.makeIterator(n)).next();!n.done;n=e.next())a.generateCueFromElement_(n.value,t,i,r);t.nestedCues=i}else shaka.log.warning("The cue's markup could not be parsed: ",e),t.payload=a.htmlUnescape_(e)},shaka.text.VttTextParser.replaceVoiceStylePayload_=function(e){for(var t=[],r=-1,a="",n=!1,i=0;i<e.length;i++)if("/"===e[i]){var o=e.indexOf(">",i);if(-1===o)return e;if((o=e.substring(i+1,o))&&"v"==o){n=!0;var s=null;if(t.length&&(s=t[t.length-1]),s){if(s===o)a+="/"+o+">";else{if(!s.startsWith("v")){a+=e[i];continue}a+="/"+s+">"}i+=o.length+1}else a+=e[i]}else a+=e[i]}else"<"===e[i]?"v"!=e[r=i+1]&&(r=-1):">"===e[i]&&0<r&&(t.push(e.substr(r,i-r)),r=-1),a+=e[i];for(t=(e=$jscomp.makeIterator(t)).next();!t.done;t=e.next())r=(t=t.value).replace(" ",".voice-"),a=(a=a.replace("<"+t+">","<"+r+">")).replace("</"+t+">","</"+r+">"),n||(a+="</"+r+">");return a},shaka.text.VttTextParser.replaceKaraokeStylePayload_=function(e){for(var t=[],r=-1,a=0;a<e.length;a++)"<"===e[a]?r=a+1:">"===e[a]&&0<r&&((r=e.substr(r,a-r)).match(shaka.text.VttTextParser.timeFormat_)&&t.push(r),r=-1);for(a=(t=$jscomp.makeIterator(t)).next();!a.done;a=t.next())a=a.value,e=e.replace("<"+a+">",'<div time="'+a+'">'),e+="</div>";return e},shaka.text.VttTextParser.replaceColorPayload_=function(e){for(var t=[],r=-1,a="",n=0;n<e.length;n++)if("/"===e[n]&&0<n&&"<"===e[n-1]){var i=e.indexOf(">",n);if(i<=n)return e;if((i=e.substring(n+1,i))&&"c"===i){var o=t.pop();o?o===i?(a+="/"+i+">",n+=i.length+1):o.startsWith("c.")?(n+=i.length+1,a+="/"+o+">"):a+=e[n]:a+=e[n]}else a+=e[n]}else"<"===e[n]?"c"!=e[r=n+1]&&(r=-1):">"===e[n]&&0<r&&(t.push(e.substr(r,n-r)),r=-1),a+=e[n];return a},shaka.text.VttTextParser.getOrDefault_=function(e,t){return e&&0<e.length?e:t},shaka.text.VttTextParser.mergeStyle_=function(e,t){if(t){var r=shaka.text.VttTextParser;e.backgroundColor=r.getOrDefault_(t.backgroundColor,e.backgroundColor),e.color=r.getOrDefault_(t.color,e.color),e.fontFamily=r.getOrDefault_(t.fontFamily,e.fontFamily),e.fontSize=r.getOrDefault_(t.fontSize,e.fontSize),e.fontWeight=t.fontWeight,e.fontStyle=t.fontStyle,e.opacity=t.opacity,e.wrapLine=t.wrapLine}},shaka.text.VttTextParser.generateCueFromElement_=function(e,t,r,a){var n=shaka.text.VttTextParser,i=t.clone();if(e.nodeType===Node.ELEMENT_NODE&&e.nodeName)for(var o=shaka.text.Cue.fontWeight.BOLD,s=shaka.text.Cue.fontStyle.ITALIC,l=shaka.text.Cue.textDecoration.UNDERLINE,u=e.nodeName.split(/(?=[ .])+/g),c=(u=$jscomp.makeIterator(u)).next();!c.done;c=u.next()){var d=c=c.value;if(d.startsWith(".voice-")){var p=d.split("-").pop();d='v[voice="'+p+'"]',a.has(d)||(d="v[voice="+p+"]")}switch(a.has(d)&&n.mergeStyle_(i,a.get(d)),c){case"br":(c=t.clone()).lineBreak=!0,r.push(c);break;case"b":i.fontWeight=o;break;case"i":i.fontStyle=s;break;case"u":i.textDecoration.push(l);break;case"div":(c=e.getAttribute("time"))&&(c=new shaka.util.TextParser(c),(c=shaka.text.VttTextParser.parseTime_(c))&&(i.startTime=c))}}if(shaka.util.XmlUtils.isText(e))for(a=e.textContent.split("\n"),e=!0,o=(a=$jscomp.makeIterator(a)).next();!o.done;o=a.next())o=o.value,e||((e=t.clone()).lineBreak=!0,r.push(e)),0<o.length&&((e=i.clone()).payload=n.htmlUnescape_(o),r.push(e)),e=!1;else for(e=(t=$jscomp.makeIterator(e.childNodes)).next();!e.done;e=t.next())n.generateCueFromElement_(e.value,i,r,a)},shaka.text.VttTextParser.parseCueSetting=function(e,t,r){var a,n=shaka.text.VttTextParser;if(a=/^align:(start|middle|center|end|left|right)$/.exec(t))n.setTextAlign_(e,a[1]);else if(a=/^vertical:(lr|rl)$/.exec(t))n.setVerticalWritingMode_(e,a[1]);else if(a=/^size:([\d.]+)%$/.exec(t))e.size=Number(a[1]);else if(a=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.position=Number(a[1]),a[2]&&n.setPositionAlign_(e,a[2]);else{if(!(a=/^region:(.*)$/.exec(t)))return n.parsedLineValueAndInterpretation_(e,t);(t=n.getRegionById_(r,a[1]))&&(e.region=t)}return!0},shaka.text.VttTextParser.getRegionById_=function(e,t){return(e=e.filter((function(e){return e.id==t}))).length?(goog.asserts.assert(1==e.length,"VTTRegion ids should be unique!"),e[0]):(shaka.log.warning("VTT parser could not find a region with id: ",t," The region will be ignored."),null)},shaka.text.VttTextParser.parseRegionSetting_=function(e,t){var r;if(r=/^id=(.*)$/.exec(t))e.id=r[1];else if(r=/^width=(\d{1,2}|100)%$/.exec(t))e.width=Number(r[1]);else if(r=/^lines=(\d+)$/.exec(t))e.height=Number(r[1]),e.heightUnits=shaka.text.CueRegion.units.LINES;else if(r=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.regionAnchorX=Number(r[1]),e.regionAnchorY=Number(r[2]);else if(r=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.viewportAnchorX=Number(r[1]),e.viewportAnchorY=Number(r[2]);else{if(!/^scroll=up$/.exec(t))return!1;e.scroll=shaka.text.CueRegion.scrollMode.UP}return!0},shaka.text.VttTextParser.setTextAlign_=function(e,t){var r=shaka.text.Cue;"middle"==t?e.textAlign=r.textAlign.CENTER:(goog.asserts.assert(t.toUpperCase()in r.textAlign,t.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=r.textAlign[t.toUpperCase()])},shaka.text.VttTextParser.setPositionAlign_=function(e,t){var r=shaka.text.Cue;e.positionAlign="line-left"==t||"start"==t?r.positionAlign.LEFT:"line-right"==t||"end"==t?r.positionAlign.RIGHT:r.positionAlign.CENTER},shaka.text.VttTextParser.setVerticalWritingMode_=function(e,t){var r=shaka.text.Cue;e.writingMode="lr"==t?r.writingMode.VERTICAL_LEFT_TO_RIGHT:r.writingMode.VERTICAL_RIGHT_TO_LEFT},shaka.text.VttTextParser.parsedLineValueAndInterpretation_=function(e,t){var r,a=shaka.text.Cue;if(r=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=a.lineInterpretation.PERCENTAGE,e.line=Number(r[1]),r[2]&&(goog.asserts.assert(r[2].toUpperCase()in a.lineAlign,r[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=a.lineAlign[r[2].toUpperCase()]);else{if(!(r=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t)))return!1;e.lineInterpretation=a.lineInterpretation.LINE_NUMBER,e.line=Number(r[1]),r[2]&&(goog.asserts.assert(r[2].toUpperCase()in a.lineAlign,r[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=a.lineAlign[r[2].toUpperCase()])}return!0},shaka.text.VttTextParser.parseTime_=function(e){if(null==(e=e.readRegex(shaka.text.VttTextParser.timeFormat_)))return null;var t=Number(e[2]),r=Number(e[3]);return 59<t||59<r?null:Number(e[4])/1e3+r+60*t+3600*(Number(e[1])||0)},shaka.text.VttTextParser.htmlUnescape_=function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&nbsp;":" ","&lrm;":"‎","&rlm;":"‏"},r=/&(?:amp|lt|gt|quot|#(0+)?39|nbsp|lrm|rlm);/g,a=RegExp(r.source);return e&&a.test(e)?e.replace(r,(function(e){return t[e]||"'"})):e||""},goog.exportSymbol("shaka.text.VttTextParser",shaka.text.VttTextParser),goog.exportProperty(shaka.text.VttTextParser.prototype,"parseMedia",shaka.text.VttTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.VttTextParser.prototype,"setSequenceMode",shaka.text.VttTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.VttTextParser.prototype,"parseInit",shaka.text.VttTextParser.prototype.parseInit),shaka.text.VttTextParser.MPEG_TIMESCALE_=9e4,shaka.text.VttTextParser.TS_ROLLOVER_=8589934592,shaka.text.VttTextParser.timeFormat_=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g,shaka.text.TextEngine.registerParser("text/vtt",(function(){return new shaka.text.VttTextParser})),shaka.text.TextEngine.registerParser('text/vtt; codecs="vtt"',(function(){return new shaka.text.VttTextParser})),shaka.text.TextEngine.registerParser('text/vtt; codecs="wvtt"',(function(){return new shaka.text.VttTextParser})),shaka.text.Mp4VttParser=function(){this.timescale_=null},shaka.text.Mp4VttParser.prototype.parseInit=function(e){var t=this,r=shaka.util.Mp4Parser,a=!1;if((new r).box("moov",r.children).box("trak",r.children).box("mdia",r.children).fullBox("mdhd",(function(e){goog.asserts.assert(0==e.version||1==e.version,"MDHD version can only be 0 or 1"),e=shaka.util.Mp4BoxParsers.parseMDHD(e.reader,e.version),t.timescale_=e.timescale})).box("minf",r.children).box("stbl",r.children).fullBox("stsd",r.sampleDescription).box("wvtt",(function(e){a=!0})).parse(e),!this.timescale_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT);if(!a)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT)},shaka.text.Mp4VttParser.prototype.setSequenceMode=function(e){},shaka.text.Mp4VttParser.prototype.parseMedia=function(e,t){if(!this.timescale_)throw shaka.log.error("No init segment for MP4+VTT!"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT);var r,a=shaka.util.Mp4Parser,n=0,i=[],o=[],s=!1,l=!1,u=!1,c=null;if((new a).box("moof",a.children).box("traf",a.children).fullBox("tfdt",(function(e){s=!0,goog.asserts.assert(0==e.version||1==e.version,"TFDT version can only be 0 or 1"),n=shaka.util.Mp4BoxParsers.parseTFDT(e.reader,e.version).baseMediaDecodeTime})).fullBox("tfhd",(function(e){goog.asserts.assert(null!=e.flags,"A TFHD box should have a valid flags value"),c=shaka.util.Mp4BoxParsers.parseTFHD(e.reader,e.flags).defaultSampleDuration})).fullBox("trun",(function(e){l=!0,goog.asserts.assert(null!=e.version,"A TRUN box should have a valid version value"),goog.asserts.assert(null!=e.flags,"A TRUN box should have a valid flags value"),i=shaka.util.Mp4BoxParsers.parseTRUN(e.reader,e.version,e.flags).sampleData})).box("mdat",a.allData((function(e){goog.asserts.assert(!u,"VTT cues in mp4 with multiple MDAT are not currently supported"),u=!0,r=e}))).parse(e,!1),!u&&!s&&!l)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT);e=n,a=new shaka.util.DataViewReader(r,shaka.util.DataViewReader.Endianness.BIG_ENDIAN);for(var d=$jscomp.makeIterator(i),p=d.next();!p.done;p=d.next()){var h=(p=p.value).sampleDuration||c,f=p.sampleCompositionTimeOffset?n+p.sampleCompositionTimeOffset:e;e=f+(h||0);var g=0;do{var y=a.readUint32();g+=y;var m=a.readUint32(),v=null;"vttc"==(m=shaka.util.Mp4Parser.typeToString(m))?8<y&&(v=a.readBytes(y-8)):("vtte"!=m&&shaka.log.error("Unknown box "+m+"! Skipping!"),a.skip(y-8)),h?v&&(goog.asserts.assert(null!=this.timescale_,"Timescale should not be null!"),y=shaka.text.Mp4VttParser.parseVTTC_(v,t.periodStart+f/this.timescale_,t.periodStart+e/this.timescale_),o.push(y)):shaka.log.error("WVTT sample duration unknown, and no default found!"),goog.asserts.assert(!p.sampleSize||g<=p.sampleSize,"The samples do not fit evenly into the sample sizes given in the TRUN box!")}while(p.sampleSize&&g<p.sampleSize)}return goog.asserts.assert(!a.hasMoreData(),"MDAT which contain VTT cues and non-VTT data are not currently supported!"),o.filter(shaka.util.Functional.isNotNull)},shaka.text.Mp4VttParser.parseVTTC_=function(e,t,r){var a,n,i;return(new shaka.util.Mp4Parser).box("payl",shaka.util.Mp4Parser.allData((function(e){a=shaka.util.StringUtils.fromUTF8(e)}))).box("iden",shaka.util.Mp4Parser.allData((function(e){n=shaka.util.StringUtils.fromUTF8(e)}))).box("sttg",shaka.util.Mp4Parser.allData((function(e){i=shaka.util.StringUtils.fromUTF8(e)}))).parse(e),a?shaka.text.Mp4VttParser.assembleCue_(a,n,i,t,r):null},shaka.text.Mp4VttParser.assembleCue_=function(e,t,r,a,n){if(a=new shaka.text.Cue(a,n,""),n=new Map,shaka.text.VttTextParser.parseCueStyles(e,a,n),t&&(a.id=t),r)for(t=(e=new shaka.util.TextParser(r)).readWord();t;)shaka.text.VttTextParser.parseCueSetting(a,t,[])||shaka.log.warning("VTT parser encountered an invalid VTT setting: ",t," The setting will be ignored."),e.skipWhitespace(),t=e.readWord();return a},goog.exportSymbol("shaka.text.Mp4VttParser",shaka.text.Mp4VttParser),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"parseMedia",shaka.text.Mp4VttParser.prototype.parseMedia),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"setSequenceMode",shaka.text.Mp4VttParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"parseInit",shaka.text.Mp4VttParser.prototype.parseInit),shaka.text.TextEngine.registerParser('application/mp4; codecs="wvtt"',(function(){return new shaka.text.Mp4VttParser})),shaka.text.SbvTextParser=function(){},shaka.text.SbvTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"SubViewer does not have init segments")},shaka.text.SbvTextParser.prototype.setSequenceMode=function(e){},shaka.text.SbvTextParser.prototype.parseMedia=function(e,t){t=shaka.text.SbvTextParser;var r=shaka.util.StringUtils.fromUTF8(e).replace(/\r+/g,"");if(e=[],""==(r=r.trim()))return e;r=r.split("\n\n");for(var a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next()){var n=a.value.split("\n"),i=new shaka.util.TextParser(n[0]);a=t.parseTime_(i);var o=i.readRegex(/,/g);if(i=t.parseTime_(i),null==a||null==o||null==i)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"Could not parse cue time range in SubViewer");n=n.slice(1).join("\n").trim(),a=new shaka.text.Cue(a,i,n),e.push(a)}return e},shaka.text.SbvTextParser.parseTime_=function(e){if(null==(e=e.readRegex(/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g)))return null;var t=Number(e[2]),r=Number(e[3]);return 59<t||59<r?null:Number(e[4])/1e3+r+60*t+3600*(Number(e[1])||0)},goog.exportSymbol("shaka.text.SbvTextParser",shaka.text.SbvTextParser),goog.exportProperty(shaka.text.SbvTextParser.prototype,"parseMedia",shaka.text.SbvTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.SbvTextParser.prototype,"setSequenceMode",shaka.text.SbvTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.SbvTextParser.prototype,"parseInit",shaka.text.SbvTextParser.prototype.parseInit),shaka.text.TextEngine.registerParser("text/x-subviewer",(function(){return new shaka.text.SbvTextParser})),shaka.text.SrtTextParser=function(){this.parser_=new shaka.text.VttTextParser},shaka.text.SrtTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"SRT does not have init segments")},shaka.text.SrtTextParser.prototype.setSequenceMode=function(e){},shaka.text.SrtTextParser.prototype.parseMedia=function(e,t){var r=shaka.text.SrtTextParser,a=shaka.util.BufferUtils,n=shaka.util.StringUtils;return e=n.fromUTF8(e),r=r.srt2webvtt(e),a=a.toUint8(n.toUTF8(r)),this.parser_.parseMedia(a,t)},shaka.text.SrtTextParser.srt2webvtt=function(e){var t=shaka.text.SrtTextParser,r="WEBVTT\n\n";if(""==e)return r;e=(e=(e=e.replace(/\r+/g,"")).trim()).split("\n\n");for(var a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())r+=t.convertSrtCue_(a.value);return r},shaka.text.SrtTextParser.convertSrtCue_=function(e){return(e=e.split(/\n/))[0].match(/\d+/)&&e.shift(),e[0]=e[0].replace(/,/g,"."),e.join("\n")+"\n\n"},goog.exportSymbol("shaka.text.SrtTextParser",shaka.text.SrtTextParser),goog.exportProperty(shaka.text.SrtTextParser,"srt2webvtt",shaka.text.SrtTextParser.srt2webvtt),goog.exportProperty(shaka.text.SrtTextParser.prototype,"parseMedia",shaka.text.SrtTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.SrtTextParser.prototype,"setSequenceMode",shaka.text.SrtTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.SrtTextParser.prototype,"parseInit",shaka.text.SrtTextParser.prototype.parseInit),shaka.text.TextEngine.registerParser("text/srt",(function(){return new shaka.text.SrtTextParser})),shaka.text.SsaTextParser=function(){},shaka.text.SsaTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"SSA does not have init segments")},shaka.text.SsaTextParser.prototype.setSequenceMode=function(e){},shaka.text.SsaTextParser.prototype.parseMedia=function(e,t){t=shaka.text.SsaTextParser;var r="",a="";e=shaka.util.StringUtils.fromUTF8(e).split(/\r?\n\s*\r?\n/);for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;var i=t.ssaContent_.exec(n);if(i){var o=i[1];if(i=i[2],"V4 Styles"==o||"V4+ Styles"==o){r=i;continue}if("Events"==o){a=i;continue}}shaka.log.warning("SsaTextParser parser encountered an unknown part.",n)}for(e=[],n=null,r=r.split(/\r?\n/),i=(r=$jscomp.makeIterator(r)).next();!i.done;i=r.next())if(o=i.value,!/^\s*;/.test(o)&&(i=t.lineParts_.exec(o)))if(o=i[1].trim(),i=i[2].trim(),"Format"==o)n=i.split(t.valuesFormat_);else if("Style"==o){o=i.split(t.valuesFormat_),i={};for(var s=0;s<n.length&&s<o.length;s++)i[n[s]]=o[s];e.push(i)}for(n=[],r=null,o=a.split(/\r?\n/),a={},i=(o=$jscomp.makeIterator(o)).next();!i.done;a={$jscomp$loop$prop$styleName$692:a.$jscomp$loop$prop$styleName$692},i=o.next())if(i=i.value,!/^\s*;/.test(i)&&(s=t.lineParts_.exec(i)))if(i=s[1].trim(),s=s[2].trim(),"Format"==i)r=s.split(t.valuesFormat_);else if("Dialogue"==i){s=s.split(t.valuesFormat_),i={};for(var l=0;l<r.length&&l<s.length;l++)i[r[l]]=s[l];l=t.parseTime_(i.Start);var u=t.parseTime_(i.End);s=s.slice(r.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,""),s=new shaka.text.Cue(l,u,s),a.$jscomp$loop$prop$styleName$692=i.Style,(i=e.find(function(e){return function(t){return t.Name==e.$jscomp$loop$prop$styleName$692}}(a)))&&t.addStyle_(s,i),n.push(s)}return n},shaka.text.SsaTextParser.addStyle_=function(e,t){var r=shaka.text.Cue,a=shaka.text.SsaTextParser,n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=a.parseSsaColor_(n))&&(e.color=n),(n=t.BackColour)&&(a=a.parseSsaColor_(n))&&(e.backgroundColor=a),t.Bold&&(e.fontWeight=r.fontWeight.BOLD),t.Italic&&(e.fontStyle=r.fontStyle.ITALIC),t.Underline&&e.textDecoration.push(r.textDecoration.UNDERLINE),(a=t.Spacing)&&(e.letterSpacing=a+"px"),a=t.Alignment)switch(parseInt(a,10)){case 1:e.displayAlign=r.displayAlign.AFTER,e.textAlign=r.textAlign.START;break;case 2:e.displayAlign=r.displayAlign.AFTER,e.textAlign=r.textAlign.CENTER;break;case 3:e.displayAlign=r.displayAlign.AFTER,e.textAlign=r.textAlign.END;break;case 5:e.displayAlign=r.displayAlign.BEFORE,e.textAlign=r.textAlign.START;break;case 6:e.displayAlign=r.displayAlign.BEFORE,e.textAlign=r.textAlign.CENTER;break;case 7:e.displayAlign=r.displayAlign.BEFORE,e.textAlign=r.textAlign.END;break;case 9:e.displayAlign=r.displayAlign.CENTER,e.textAlign=r.textAlign.START;break;case 10:e.displayAlign=r.displayAlign.CENTER,e.textAlign=r.textAlign.CENTER;break;case 11:e.displayAlign=r.displayAlign.CENTER,e.textAlign=r.textAlign.END}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))},shaka.text.SsaTextParser.parseSsaColor_=function(e){return 0<=(e=parseInt(e.replace("&H",""),16))?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null},shaka.text.SsaTextParser.parseTime_=function(e){var t=shaka.text.SsaTextParser.timeFormat_.exec(e);return 3600*(e=t[1]?parseInt(t[1].replace(":",""),10):0)+60*parseInt(t[2],10)+(t=parseFloat(t[3]))},goog.exportSymbol("shaka.text.SsaTextParser",shaka.text.SsaTextParser),goog.exportProperty(shaka.text.SsaTextParser.prototype,"parseMedia",shaka.text.SsaTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.SsaTextParser.prototype,"setSequenceMode",shaka.text.SsaTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.SsaTextParser.prototype,"parseInit",shaka.text.SsaTextParser.prototype.parseInit),shaka.text.SsaTextParser.ssaContent_=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,shaka.text.SsaTextParser.lineParts_=/^\s*([^:]+):\s*(.*)/,shaka.text.SsaTextParser.valuesFormat_=/\s*,\s*/,shaka.text.SsaTextParser.timeFormat_=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/,shaka.text.TextEngine.registerParser("text/x-ssa",(function(){return new shaka.text.SsaTextParser}));
/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
var EmeEncryptionSchemePolyfill=function(){};EmeEncryptionSchemePolyfill.install=function(){EmeEncryptionSchemePolyfill.originalRMKSA_?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(EmeEncryptionSchemePolyfill.originalRMKSA_=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=EmeEncryptionSchemePolyfill.probeRMKSA_):console.debug("EmeEncryptionSchemePolyfill: EME not found")},EmeEncryptionSchemePolyfill.probeRMKSA_=function(e,t){var r,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(console.assert(a==navigator,'bad "this" for requestMediaKeySystemAccess'),n.yield(EmeEncryptionSchemePolyfill.originalRMKSA_.call(a,e,t),2)):hasEncryptionScheme(r=n.yieldResult)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=EmeEncryptionSchemePolyfill.originalRMKSA_,n.return(r)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=EmeEncryptionSchemePolyfill.polyfillRMKSA_,n.return(EmeEncryptionSchemePolyfill.polyfillRMKSA_.call(a,e,t)))}))},EmeEncryptionSchemePolyfill.polyfillRMKSA_=function(e,t){var r,a,n,i,o,s,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){if(1==h.nextAddress){for(console.assert(p==navigator,'bad "this" for requestMediaKeySystemAccess'),r=guessSupportedScheme(e),a=[],n=$jscomp.makeIterator(t),i=n.next();!i.done;i=n.next())o=i.value,s=EmeEncryptionSchemePolyfill.filterCapabilities_(o.videoCapabilities,r),l=EmeEncryptionSchemePolyfill.filterCapabilities_(o.audioCapabilities,r),o.videoCapabilities&&o.videoCapabilities.length&&!s.length||o.audioCapabilities&&o.audioCapabilities.length&&!l.length||((u=Object.assign({},o)).videoCapabilities=s,u.audioCapabilities=l,a.push(u));if(!a.length)throw(c=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c;return h.yield(EmeEncryptionSchemePolyfill.originalRMKSA_.call(p,e,a),2)}return d=h.yieldResult,h.return(new EmeEncryptionSchemePolyfillMediaKeySystemAccess(d,r))}))},EmeEncryptionSchemePolyfill.filterCapabilities_=function(e,t){return e?e.filter((function(e){return!e.encryptionScheme||e.encryptionScheme==t})):e},goog.exportSymbol("EmeEncryptionSchemePolyfill",EmeEncryptionSchemePolyfill),goog.exportProperty(EmeEncryptionSchemePolyfill,"install",EmeEncryptionSchemePolyfill.install);var McEncryptionSchemePolyfill=function(){};McEncryptionSchemePolyfill.install=function(){McEncryptionSchemePolyfill.originalDecodingInfo_?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(McEncryptionSchemePolyfill.originalDecodingInfo_=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=McEncryptionSchemePolyfill.probeDecodingInfo_):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")},McEncryptionSchemePolyfill.probeDecodingInfo_=function(e){var t,r,a,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){switch(i.nextAddress){case 1:return console.assert(n==navigator.mediaCapabilities,'bad "this" for decodingInfo'),i.yield(McEncryptionSchemePolyfill.originalDecodingInfo_.call(n,e),2);case 2:if(t=i.yieldResult,!e.keySystemConfiguration)return i.return(t);if((r=t.keySystemAccess)&&hasEncryptionScheme(r))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=McEncryptionSchemePolyfill.originalDecodingInfo_,i.return(t);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=McEncryptionSchemePolyfill.polyfillDecodingInfo_,r){i.jumpTo(3);break}return a=t,i.yield(McEncryptionSchemePolyfill.getMediaKeySystemAccess_(e),4);case 4:return a.keySystemAccess=i.yieldResult,i.return(t);case 3:return i.return(McEncryptionSchemePolyfill.polyfillDecodingInfo_.call(n,e))}}))},McEncryptionSchemePolyfill.polyfillDecodingInfo_=function(e){var t,r,a,n,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:return console.assert(u==navigator.mediaCapabilities,'bad "this" for decodingInfo'),t=null,e.keySystemConfiguration&&(r=e.keySystemConfiguration,a=r.keySystem,n=r.audio&&r.audio.encryptionScheme,i=r.video&&r.video.encryptionScheme,t=guessSupportedScheme(a),o={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},n&&n!=t||i&&i!=t)?c.return(o):c.yield(McEncryptionSchemePolyfill.originalDecodingInfo_.call(u,e),2);case 2:if((s=c.yieldResult).keySystemAccess){s.keySystemAccess=new EmeEncryptionSchemePolyfillMediaKeySystemAccess(s.keySystemAccess,t),c.jumpTo(3);break}if(!e.keySystemConfiguration){c.jumpTo(3);break}return l=s,c.yield(McEncryptionSchemePolyfill.getMediaKeySystemAccess_(e),5);case 5:l.keySystemAccess=c.yieldResult;case 3:return c.return(s)}}))},McEncryptionSchemePolyfill.getMediaKeySystemAccess_=function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(t=McEncryptionSchemePolyfill.convertToMediaKeySystemConfig_(e),a.yield(navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)):(r=a.yieldResult,a.return(r))}))},McEncryptionSchemePolyfill.convertToMediaKeySystemConfig_=function(e){var t=e.keySystemConfiguration,r=[],a=[];return t.audio&&r.push({robustness:t.audio.robustness||"",contentType:e.audio.contentType}),t.video&&a.push({robustness:t.video.robustness||"",contentType:e.video.contentType}),e={initDataTypes:t.initDataType?[t.initDataType]:[],distinctiveIdentifier:t.distinctiveIdentifier,persistentState:t.persistentState,sessionTypes:t.sessionTypes},r.length&&(e.audioCapabilities=r),a.length&&(e.videoCapabilities=a),e},goog.exportSymbol("McEncryptionSchemePolyfill",McEncryptionSchemePolyfill),goog.exportProperty(McEncryptionSchemePolyfill,"install",McEncryptionSchemePolyfill.install);var EmeEncryptionSchemePolyfillMediaKeySystemAccess=function(e,t){this.mksa_=e,this.scheme_=t,this.keySystem=e.keySystem};function guessSupportedScheme(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function hasEncryptionScheme(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}EmeEncryptionSchemePolyfillMediaKeySystemAccess.prototype.getConfiguration=function(){var e=this.mksa_.getConfiguration();if(e.videoCapabilities)for(var t=$jscomp.makeIterator(e.videoCapabilities),r=t.next();!r.done;r=t.next())r.value.encryptionScheme=this.scheme_;if(e.audioCapabilities)for(r=(t=$jscomp.makeIterator(e.audioCapabilities)).next();!r.done;r=t.next())r.value.encryptionScheme=this.scheme_;return e},EmeEncryptionSchemePolyfillMediaKeySystemAccess.prototype.createMediaKeys=function(){return this.mksa_.createMediaKeys()};var EncryptionSchemePolyfills=function(){};EncryptionSchemePolyfills.install=function(){EmeEncryptionSchemePolyfill.install(),McEncryptionSchemePolyfill.install()},goog.exportSymbol("EncryptionSchemePolyfills",EncryptionSchemePolyfills),goog.exportProperty(EncryptionSchemePolyfills,"install",EncryptionSchemePolyfills.install),void 0!==module&&module.exports&&(module.exports=EncryptionSchemePolyfills)}.call(exportTo,innerGlobal,innerGlobal,void 0),exportTo.shaka)exports[k]=exportTo.shaka[k]}()}).call(this,__webpack_require__(92))},function(e,t){!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=function(e){for(var t=window.document,r=n(t);r;)r=n(t=r.ownerDocument);return t}(),t=[],r=null,a=null;o.prototype.THROTTLE_TIMEOUT=100,o.prototype.POLL_INTERVAL=null,o.prototype.USE_MUTATION_OBSERVER=!0,o._setupCrossOriginUpdater=function(){return r||(r=function(e,r){a=e&&r?d(e,r):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach((function(e){e._checkForIntersections()}))}),r},o._resetCrossOriginUpdater=function(){r=null,a=null},o.prototype.observe=function(e){if(!this._observationTargets.some((function(t){return t.element==e}))){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},o.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter((function(t){return t.element!=e})),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},o.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},o.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},o.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter((function(e,t,r){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==r[t-1]}))},o.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map((function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}}));return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},o.prototype._monitorIntersections=function(t){var r=t.defaultView;if(r&&-1==this._monitoringDocuments.indexOf(t)){var a=this._checkForIntersections,i=null,o=null;this.POLL_INTERVAL?i=r.setInterval(a,this.POLL_INTERVAL):(s(r,"resize",a,!0),s(t,"scroll",a,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in r&&(o=new r.MutationObserver(a)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push((function(){var e=t.defaultView;e&&(i&&e.clearInterval(i),l(e,"resize",a,!0)),l(t,"scroll",a,!0),o&&o.disconnect()}));var u=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=u){var c=n(t);c&&this._monitorIntersections(c.ownerDocument)}}},o.prototype._unmonitorIntersections=function(t){var r=this._monitoringDocuments.indexOf(t);if(-1!=r){var a=this.root&&(this.root.ownerDocument||this.root)||e;if(!this._observationTargets.some((function(e){var r=e.element.ownerDocument;if(r==t)return!0;for(;r&&r!=a;){var i=n(r);if((r=i&&i.ownerDocument)==t)return!0}return!1}))){var i=this._monitoringUnsubscribes[r];if(this._monitoringDocuments.splice(r,1),this._monitoringUnsubscribes.splice(r,1),i(),t!=a){var o=n(t);o&&this._unmonitorIntersections(o.ownerDocument)}}}},o.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},o.prototype._checkForIntersections=function(){if(this.root||!r||a){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(a){var n=a.element,o=u(n),s=this._rootContainsTarget(n),l=a.entry,c=e&&s&&this._computeTargetAndRootIntersection(n,o,t),d=null;this._rootContainsTarget(n)?r&&!this.root||(d=t):d={top:0,bottom:0,left:0,right:0,width:0,height:0};var p=a.entry=new i({time:window.performance&&performance.now&&performance.now(),target:n,boundingClientRect:o,rootBounds:d,intersectionRect:c});l?e&&s?this._hasCrossedThreshold(l,p)&&this._queuedEntries.push(p):l&&l.isIntersecting&&this._queuedEntries.push(p):this._queuedEntries.push(p)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},o.prototype._computeTargetAndRootIntersection=function(t,n,i){if("none"!=window.getComputedStyle(t).display){for(var o,s,l,c,p,f,g,y,m=n,v=h(t),_=!1;!_&&v;){var k=null,E=1==v.nodeType?window.getComputedStyle(v):{};if("none"==E.display)return null;if(v==this.root||9==v.nodeType)if(_=!0,v==this.root||v==e)r&&!this.root?!a||0==a.width&&0==a.height?(v=null,k=null,m=null):k=a:k=i;else{var T=h(v),b=T&&u(T),S=T&&this._computeTargetAndRootIntersection(T,b,i);b&&S?(v=T,k=d(b,S)):(v=null,m=null)}else{var A=v.ownerDocument;v!=A.body&&v!=A.documentElement&&"visible"!=E.overflow&&(k=u(v))}if(k&&(o=k,s=m,l=void 0,c=void 0,p=void 0,f=void 0,g=void 0,y=void 0,l=Math.max(o.top,s.top),c=Math.min(o.bottom,s.bottom),p=Math.max(o.left,s.left),f=Math.min(o.right,s.right),y=c-l,m=(g=f-p)>=0&&y>=0&&{top:l,bottom:c,left:p,right:f,width:g,height:y}||null),!m)break;v=v&&h(v)}return m}},o.prototype._getRootRect=function(){var t;if(this.root&&!f(this.root))t=u(this.root);else{var r=f(this.root)?this.root:e,a=r.documentElement,n=r.body;t={top:0,left:0,right:a.clientWidth||n.clientWidth,width:a.clientWidth||n.clientWidth,bottom:a.clientHeight||n.clientHeight,height:a.clientHeight||n.clientHeight}}return this._expandRectByRootMargin(t)},o.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map((function(t,r){return"px"==t.unit?t.value:t.value*(r%2?e.width:e.height)/100})),r={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return r.width=r.right-r.left,r.height=r.bottom-r.top,r},o.prototype._hasCrossedThreshold=function(e,t){var r=e&&e.isIntersecting?e.intersectionRatio||0:-1,a=t.isIntersecting?t.intersectionRatio||0:-1;if(r!==a)for(var n=0;n<this.thresholds.length;n++){var i=this.thresholds[n];if(i==r||i==a||i<r!=i<a)return!0}},o.prototype._rootIsInDom=function(){return!this.root||p(e,this.root)},o.prototype._rootContainsTarget=function(t){var r=this.root&&(this.root.ownerDocument||this.root)||e;return p(r,t)&&(!this.root||r==t.ownerDocument)},o.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},o.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=o,window.IntersectionObserverEntry=i}function n(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function i(e){this.time=e.time,this.target=e.target,this.rootBounds=c(e.rootBounds),this.boundingClientRect=c(e.boundingClientRect),this.intersectionRect=c(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,r=t.width*t.height,a=this.intersectionRect,n=a.width*a.height;this.intersectionRatio=r?Number((n/r).toFixed(4)):this.isIntersecting?1:0}function o(e,t){var r,a,n,i=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(i.root&&1!=i.root.nodeType&&9!=i.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(r=this._checkForIntersections.bind(this),a=this.THROTTLE_TIMEOUT,n=null,function(){n||(n=setTimeout((function(){r(),n=null}),a))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(i.rootMargin),this.thresholds=this._initThresholds(i.threshold),this.root=i.root||null,this.rootMargin=this._rootMarginValues.map((function(e){return e.value+e.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function s(e,t,r,a){"function"==typeof e.addEventListener?e.addEventListener(t,r,a||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,r)}function l(e,t,r,a){"function"==typeof e.removeEventListener?e.removeEventListener(t,r,a||!1):"function"==typeof e.detachEvent&&e.detachEvent("on"+t,r)}function u(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function c(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function d(e,t){var r=t.top-e.top,a=t.left-e.left;return{top:r,left:a,height:t.height,width:t.width,bottom:r+t.height,right:a+t.width}}function p(e,t){for(var r=t;r;){if(r==e)return!0;r=h(r)}return!1}function h(t){var r=t.parentNode;return 9==t.nodeType&&t!=e?n(t):(r&&r.assignedSlot&&(r=r.assignedSlot.parentNode),r&&11==r.nodeType&&r.host?r.host:r)}function f(e){return e&&9===e.nodeType}}()},function(e,t,r){var a=r(321),n=r(322);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var i={insert:"head",singleton:!1};a(n,i);e.exports=n.locals||{}},function(e,t,r){"use strict";var a,n=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},i=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),o=[];function s(e){for(var t=-1,r=0;r<o.length;r++)if(o[r].identifier===e){t=r;break}return t}function l(e,t){for(var r={},a=[],n=0;n<e.length;n++){var i=e[n],l=t.base?i[0]+t.base:i[0],u=r[l]||0,c="".concat(l," ").concat(u);r[l]=u+1;var d=s(c),p={css:i[1],media:i[2],sourceMap:i[3]};-1!==d?(o[d].references++,o[d].updater(p)):o.push({identifier:c,updater:y(p,t),references:1}),a.push(c)}return a}function u(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var n=r.nc;n&&(a.nonce=n)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,d=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function p(e,t,r,a){var n=r?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=d(t,n);else{var i=document.createTextNode(n),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function h(e,t,r){var a=r.css,n=r.media,i=r.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var f=null,g=0;function y(e,t){var r,a,n;if(t.singleton){var i=g++;r=f||(f=u(t)),a=p.bind(null,r,i,!1),n=p.bind(null,r,i,!0)}else r=u(t),a=h.bind(null,r,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var r=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<r.length;a++){var n=s(r[a]);o[n].references--}for(var i=l(e,t),u=0;u<r.length;u++){var c=s(r[u]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}r=i}}}},function(e,t,r){(t=r(323)(!1)).push([e.i,".kaltura-player-container {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  background-color: #000;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n",""]),e.exports=t},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",a=e[3];if(!a)return r;if(t&&"function"==typeof btoa){var n=(o=a,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),i=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[r].concat(i).concat([n]).join("\n")}var o,s,l;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,a){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(a)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(n[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&n[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},function(e,t,r){"use strict";r.r(t),r.d(t,"getPlayers",(function(){return gr})),r.d(t,"getPlayer",(function(){return yr})),r.d(t,"core",(function(){return l})),r.d(t,"ui",(function(){return u})),r.d(t,"providers",(function(){return c})),r.d(t,"setup",(function(){return _r})),r.d(t,"cast",(function(){return Pr})),r.d(t,"playlist",(function(){return wr})),r.d(t,"Ad",(function(){return _t})),r.d(t,"AdBreak",(function(){return yt})),r.d(t,"BasePlugin",(function(){return Q})),r.d(t,"registerPlugin",(function(){return ee})),r.d(t,"PLAYER_TYPE",(function(){return Ir})),r.d(t,"VERSION",(function(){return Mr})),r.d(t,"PLAYER_NAME",(function(){return xr}));var a=r(46);r(312);var n,i,o,s=function(){function e(){}return e.install=function(){[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach((function(e){var r=e instanceof Node;t.appendChild(r?e:document.createTextNode(String(e)))})),this.insertBefore(t,this.firstChild)}})}))},e}();n=s,o="prepend",(i=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(i="id"))in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,a.a.register(s);r(313);var l=r(0),u=r(14),c=r(63);r(315),r(317);function d(e,t){var r=function(e){var t=document.createElement("a");return t.href=e,t.hostname},a=r(t),n=!1,i="",o="";return e&&(e.flavors&&Array.isArray(e.flavors)?(i=(n=1===e.flavors.length)&&r(e.flavors[0].url),o=e.flavors[0].url):e.result&&(n=!0,i=r(e.result.url),o=e.result.url)),n&&a!==i?o:t}function p(e,t){return void 0===t&&(t={}),l.Utils.Object.mergeDeep({},function(e,t){void 0===t&&(t={});var r={},a=l.Utils.Object.getPropertyPath(e,"sources.options.redirectExternalStreamsHandler"),n=l.Utils.Object.getPropertyPath(t,"sources.options.redirectExternalStreamsHandler");return"function"!=typeof a&&"function"!=typeof n&&l.Utils.Object.mergeDeep(r,{sources:{options:{redirectExternalStreamsHandler:d}}}),r}(e,t))}var h="Must provide initial providers config",f="Must provide target id",g="Must provide DOM element with id of: ",y="The target id provided is already in use. Id: ";function m(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,v(a.key),a)}}function v(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var _=function(){function e(){}var t,r,a;return e.isLocalStorageAvailable=function(){if("undefined"==typeof Storage)return!1;try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(e){return!1}},e.setItem=function(t,r){e._validateKey(t);try{e._logger.debug("Sets item for key: "+t,r),localStorage.setItem("kaltura-player-js_"+t,r)}catch(t){e._isQuotaExceeded(t)?e._logger.error("Quota exceeded: "+t.message):e._logger.error(t.message)}},e.getItem=function(t){e._validateKey(t);var r=null;try{return"string"==typeof(r=localStorage.getItem("kaltura-player-js_"+t))?JSON.parse(r):null}catch(e){return r}},e._isQuotaExceeded=function(e){var t=!1;if(e)if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t},e._validateKey=function(e){if("string"!=typeof e||0===e.length)throw new Error("Invalid key")},t=e,a=[{key:"size",get:function(){return Object.keys(localStorage).filter((function(e){return e.startsWith("kaltura-player-js_")})).length}}],(r=null)&&m(t.prototype,r),a&&m(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function k(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(_,"_logger",Object(l.getLogger)("StorageWrapper"));var E=function(){function e(){}return e.isLocalStorageAvailable=function(){return _.isLocalStorageAvailable()},e.attach=function(t){e._logger.debug("Attach local storage");var r=new l.EventManager;r.listen(t,t.Event.UI.USER_CLICKED_MUTE,(function(){t.isCasting()||_.setItem(e.StorageKeys.MUTED,t.muted)})),r.listen(t,t.Event.UI.USER_CLICKED_UNMUTE,(function(){t.isCasting()||_.setItem(e.StorageKeys.MUTED,t.muted)})),r.listen(t,t.Event.UI.USER_CHANGED_VOLUME,(function(){t.isCasting()||(t.volume>0?_.setItem(e.StorageKeys.MUTED,!1):_.setItem(e.StorageKeys.MUTED,!0),_.setItem(e.StorageKeys.VOLUME,t.volume))})),r.listen(t,t.Event.UI.USER_SELECTED_AUDIO_TRACK,(function(t){var r=t.payload.audioTrack;_.setItem(e.StorageKeys.AUDIO_LANG,r.language)})),r.listen(t,t.Event.UI.USER_SELECTED_CAPTION_TRACK,(function(t){var r=t.payload.captionTrack;_.setItem(e.StorageKeys.TEXT_LANG,r.language)}));var a=function(){r.listenOnce(t,t.Event.TEXT_TRACK_CHANGED,(function(t){var r=t.payload.selectedTextTrack;_.setItem(e.StorageKeys.TEXT_LANG,r.language)}))};r.listen(t,t.Event.UI.USER_SHOWED_CAPTIONS,a),r.listen(t,t.Event.UI.USER_HID_CAPTIONS,a),r.listen(t,t.Event.UI.USER_SELECTED_CAPTIONS_STYLE,(function(t){try{var r=JSON.stringify(t.payload.captionsStyle);_.setItem(e.StorageKeys.TEXT_STYLE,r)}catch(t){e._logger.error(t.message)}})),r.listen(t,t.Event.PLAYER_DESTROY,(function(){return r.destroy()}))},e.getPlayerTextStyle=function(){return _.getItem(e.StorageKeys.TEXT_STYLE)},e.hasStorage=function(){var t=_.size,r=0!==t;return r?e._logger.debug("Storage found with size of ",t):e._logger.debug("No storage found"),r},e.getStorageConfig=function(){var t=e._getExistingValues(),r=e._buildStorageConfig(t);return e._logger.debug("Gets storage config",r),r},e._getExistingValues=function(){var t={};return Object.keys(e.StorageKeys).forEach((function(r){var a=e.StorageKeys[r],n=_.getItem(a);null!=n&&(t[a]=n)})),t},e._buildStorageConfig=function(e){var t=l.Utils.Object.mergeDeep({},e);return delete t.textStyle,{playback:t}},e}();k(E,"StorageKeys",{MUTED:"muted",VOLUME:"volume",AUDIO_LANG:"audioLanguage",TEXT_LANG:"textLanguage",TEXT_STYLE:"textStyle"}),k(E,"_logger",Object(l.getLogger)("StorageManager"));var T="kaltura.com",b="custom_data=",S="signature=";function A(e,t){e.config.session&&e.config.session.id?function(e,t){var r=/:((?:[a-z0-9]|-)*)/i.exec(e.config.session.id);r&&r[1]&&C(t,e.config.session.id.replace(r[1],l.Utils.Generator.guid()))}(e,t):function(e){var t=l.Utils.Generator.guid(),r=l.Utils.Generator.guid();C(e,t+":"+r)}(t)}function C(e,t){e.session=e.session||{},e.session.id=t}function P(e,t,r){if(void 0===r&&(r="playSessionId="),t){var a=new RegExp(r+"((?:[a-z0-9]|-)*:(?:[a-z0-9]|-)*)","i").exec(e);a&&a[1]?e=e.replace(a[1],t):e+=I(e)+r+t}return e}function w(){var e;try{e=window.parent.document.URL}catch(t){e=document.referrer}return e}function x(e){if(-1===e.indexOf("referrer=")){var t=btoa(w().substr(0,1e3));e+=I(e)+"referrer="+t}return e}function I(e){return-1===e.indexOf("?")?"?":"&"}function M(e,t){return-1===e.indexOf("clientTag=html5:v")&&(e+=I(e)+"clientTag=html5:v"+(t||"3.13.1-test-shaka-9-4-23.5")),e}function D(e,t){var r;A(e,t);var a=t.sources,n=t.session&&t.session.id,i=null==(r=$())?void 0:r.productVersion;Object.values(l.StreamType).forEach((function(e){a[e]&&a[e].forEach((function(e){"string"==typeof e.url&&e.url.toLowerCase().indexOf("playmanifest/")>-1&&!e.localSource&&(e.url=P(e.url,n),e.url=x(e.url),e.url=M(e.url,i)),e.drmData&&e.drmData.length&&e.drmData.forEach((function(e){"string"==typeof e.licenseUrl&&[T,b,S].every((function(t){return e.licenseUrl.includes(t)}))&&(e.licenseUrl=P(e.licenseUrl,n,"sessionId="),e.licenseUrl=M(e.licenseUrl,i),e.licenseUrl=x(e.licenseUrl),e.licenseUrl=function(e,t){var r=l.Utils.Object.getPropertyPath(t,"provider.uiConfId");return-1===e.indexOf("uiConfId=")&&"number"==typeof r&&(e+=I(e)+"uiConfId="+r),e}(e.licenseUrl,t))}))}))}))}r(319);var R=function(){function e(e){void 0===e&&(e={}),e.observedThresholds=e.observedThresholds||N,e.playerThreshold="number"==typeof e.playerThreshold?e.playerThreshold:U,this._config=e,this._eventManager=new l.EventManager,this._targetsObserved=new l.Utils.MultiMap;var t={threshold:e.observedThresholds.map((function(e){return e/100}))};this._observer=new window.IntersectionObserver(this._intersectionChangedHandler.bind(this),t),this._initTabVisibility()}var t=e.prototype;return t._intersectionChangedHandler=function(e){var t=this;e.forEach((function(e){t._targetsObserved.get(e.target).forEach((function(t){var r=e.intersectionRatio>=t.threshold;t.lastIntersectionRatio=e.intersectionRatio,r!==t.lastVisible&&(t.lastVisible=r,t.listener(r,O.VIEWPORT))}))}))},t._handleTabVisibilityChange=function(){var e=this;this._isTabVisible=!document[this._visibilityTabHiddenAttr],this._targetsObserved.getAll().forEach((function(t){t.lastVisible&&t.listener(e._isTabVisible,O.TAB)}))},t._initTabVisibility=function(){void 0!==document.hidden?(this._visibilityTabHiddenAttr="hidden",this._visibilityTabChangeEventName="visibilitychange"):void 0!==document.msHidden?(this._visibilityTabHiddenAttr="msHidden",this._visibilityTabChangeEventName="msvisibilitychange"):void 0!==document.webkitHidden&&(this._visibilityTabHiddenAttr="webkitHidden",this._visibilityTabChangeEventName="webkitvisibilitychange"),this._visibilityTabHiddenAttr&&this._visibilityTabChangeEventName&&(this._eventManager.listen(document,this._visibilityTabChangeEventName,this._handleTabVisibilityChange.bind(this)),this._isTabVisible=!document[this._visibilityTabHiddenAttr])},t.observe=function(e,t,r){if(this._observer){var a="number"==typeof r?r:this._config.playerThreshold,n=new L(a/100,t);if(this._targetsObserved.has(e)){var i=this._targetsObserved.get(e)[0].lastIntersectionRatio;void 0!==i&&(n.lastIntersectionRatio=i,n.listener(this._isTabVisible&&i>=n.threshold,O.VIEWPORT))}else this._observer.observe(e);this._targetsObserved.push(e,n)}},t.unObserve=function(e,t){this._observer&&(this._targetsObserved.remove(e,t),this._targetsObserved.has(e)||this._observer.unobserve(e))},t.destroy=function(){this._observer&&(this._eventManager.destroy(),this._observer.disconnect(),this._targetsObserved.clear())},e}(),O={VIEWPORT:"viewport",TAB:"tab"},L=function(e,t){this.threshold=e,this.listener=t},N=[0,10,20,30,40,50,60,70,80,90,100],U=50,F=[];function B(e){if(!e)throw new Error(h);!function(e){if(!e)throw new Error(f);var t=document.getElementById(e);if(!t)throw new Error(g+e);if(t.getElementsByClassName("kaltura-player-container").length>0)throw new Error(y+e)}(e.targetId)}function j(e){l.Utils.Object.getPropertyPath(e,"ui.log")||l.Utils.Object.createPropertyPath(e,"ui.log",{}),l.Utils.Object.getPropertyPath(e,"provider.log")||l.Utils.Object.createPropertyPath(e,"provider.log",{}),l.Utils.Object.getPropertyPath(e,"log")||l.Utils.Object.createPropertyPath(e,"log",{}),e.log&&"function"==typeof e.log.handler&&(Object(l.setLogHandler)(e.log.handler),e.ui.log.handler=e.provider.log.handler=e.log.handler);var t=l.LogLevel.ERROR;!e.log||!0!==window.DEBUG_KALTURA_PLAYER&&""!==V("debugKalturaPlayer")?e.log&&e.log.level&&l.LogLevel[e.log.level]&&(t=l.LogLevel[e.log.level]):(t=l.LogLevel.DEBUG,e.log.level=l.LogLevel.DEBUG.name),e.ui.log.level=e.provider.log.level=t.name,Object(l.setLogLevel)(t)}function V(e){var t;window.URLSearchParams?t=new URLSearchParams(window.location.search).get(e):t=function(e){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search),r=location.search.indexOf(e)>-1;return null===t?r?"":null:decodeURIComponent(t[1].replace(/\+/g," "))}(e);return t}function $(){return window.__kalturaplayerdata||{}}function H(e){var t=function(e){var t=document.createElement("div");t.id=l.Utils.Generator.uniqueId(5),t.className="kaltura-player-container",t.setAttribute("tabindex","-1");var r=document.getElementById(e);return r&&t&&r.appendChild(t),t.id}(e.targetId),r={targetId:e.targetId,provider:{partnerId:e.provider.partnerId},ui:{targetId:t},plugins:{},advertising:{adBreaks:[]},viewability:{observedThresholds:N,playerThreshold:U}};if(l.Utils.Object.mergeDeep(r,e),!e.provider.ignoreServerConfig){var a=l.Utils.Object.copyDeep($());delete a.productVersion,r=l.Utils.Object.mergeDeep({},G(a),r)}return function(e){if(l.Env.isMacOS&&l.Env.isSafari||l.Env.isIOS){"boolean"!=typeof l.Utils.Object.getPropertyPath(e,"playback.preferNative.hls")&&l.Utils.Object.mergeDeep(e,{playback:{preferNative:{hls:!0}}})}}(r),function(e){if(l.Env.isMacOS&&l.Env.isSafari||l.Env.isIOS){"boolean"!=typeof l.Utils.Object.getPropertyPath(e,"text.useNativeTextTrack")&&l.Utils.Object.mergeDeep(e,{text:{useNativeTextTrack:!0}})}}(r),function(e){l.Utils.Object.getPropertyPath(e,"plugins.kava")||l.Utils.Object.mergeDeep(e,{plugins:{kava:{disable:!0}}}),l.Utils.Object.getPropertyPath(e,"plugins.ottAnalytics")||l.Utils.Object.mergeDeep(e,{plugins:{ottAnalytics:{}}})}(r),function(e){if(l.Env.isSmartTV){if(Object(l.setCapabilities)(l.EngineType.HTML5,{autoplay:!0}),function(e){"boolean"!=typeof l.Utils.Object.getPropertyPath(e,"playback.playAdsWithMSE")&&(e=l.Utils.Object.createPropertyPath(e,"playback.playAdsWithMSE",!0));var t=l.Utils.Object.getPropertyPath(e,"plugins.ima.disableMediaPreload"),r=l.Utils.Object.getPropertyPath(e,"plugins.bumper.disableMediaPreload");e.plugins&&e.plugins.ima&&"boolean"!=typeof t&&(e=l.Utils.Object.createPropertyPath(e,"plugins.ima.disableMediaPreload",!0));e.plugins&&e.plugins.bumper&&"boolean"!=typeof r&&(e=l.Utils.Object.createPropertyPath(e,"plugins.bumper.disableMediaPreload",!0))}(e),function(e){"boolean"!=typeof l.Utils.Object.getPropertyPath(e,"playback.options.html5.hls.liveSyncDurationCount")&&l.Env.isSafari&&(e=l.Utils.Object.createPropertyPath(e,"playback.options.html5.hls.liveSyncDurationCount",2))}(e),e.plugins&&e.plugins.ima){var t=l.Utils.Object.getPropertyPath(e,"plugins.ima.forceReloadMediaAfterAds"),r=l.Utils.Object.getPropertyPath(e,"plugins.ima.delayInitUntilSourceSelected");"boolean"!=typeof t&&(e=l.Utils.Object.createPropertyPath(e,"plugins.ima.forceReloadMediaAfterAds",!0)),"boolean"!=typeof r&&(e=l.Utils.Object.createPropertyPath(e,"plugins.ima.delayInitUntilSourceSelected",!0))}if(e.plugins&&e.plugins.youbora)"number"!=typeof l.Utils.Object.getPropertyPath(e,"plugins.youbora.playheadMonitorInterval")&&(e=l.Utils.Object.createPropertyPath(e,"plugins.youbora.playheadMonitorInterval",2e3));"boolean"!=typeof l.Utils.Object.getPropertyPath(e,"streaming.lowLatencyMode")&&(e=l.Utils.Object.createPropertyPath(e,"streaming.lowLatencyMode",!1))}}(r),function(e){if("Edge"===l.Env.browser.name){l.Utils.Object.getPropertyPath(e,"drm.keySystem")||(e="Windows"===l.Env.os.name?l.Utils.Object.createPropertyPath(e,"drm.keySystem",l.DrmScheme.PLAYREADY):l.Utils.Object.createPropertyPath(e,"drm.keySystem",l.DrmScheme.WIDEVINE))}}(r),function(e){if(l.Env.isIOS&&e.plugins&&e.plugins.ima&&!e.plugins.ima.disable){var t=l.Utils.Object.getPropertyPath(e,"playback.playsinline"),r=l.Utils.Object.getPropertyPath(e,"plugins.ima.disableMediaPreload");!1===t&&"boolean"!=typeof r&&l.Utils.Object.createPropertyPath(e,"plugins.ima.disableMediaPreload",!0)}}(r),function(e){if(e.plugins&&e.plugins.imadai&&!e.plugins.imadai.disable){"boolean"!=typeof l.Utils.Object.getPropertyPath(e,"playback.options.html5.hls.autoStartLoad")&&l.Utils.Object.mergeDeep(e,{playback:{options:{html5:{hls:{autoStartLoad:!1}}}}})}}(r),function(e){var t=l.Utils.Object.getPropertyPath(e,"plugins.bumper"),r=l.Utils.Object.getPropertyPath(e,"plugins.imadai");if(t){var a={};"boolean"!=typeof t.playOnMainVideoTag&&(l.Env.isSmartTV||l.Env.isIOS&&e.playback&&!1===e.playback.playsinline)&&(a.playOnMainVideoTag=!0),r&&!r.disable&&(Array.isArray(t.position)||(a.position=[0]),"boolean"!=typeof t.disableMediaPreload&&(a.disableMediaPreload=!0)),l.Utils.Object.mergeDeep(e,{plugins:{bumper:a}})}}(r),function(e){var t=l.Utils.Object.getPropertyPath(e,"plugins.vr");if(t&&!t.disable){"boolean"!=typeof l.Utils.Object.getPropertyPath(e,"playback.inBrowserFullscreen")&&l.Utils.Object.mergeDeep(e,{playback:{inBrowserFullscreen:!0}})}}(r),function(e){if(l.Env.isIOS){var t=l.Utils.Object.getPropertyPath(e,"playback.playsinline"),r=l.Utils.Object.hasPropertyPath(e,"plugins.airplay"),a=!1!==t;r?Object(l.setCapabilities)(l.EngineType.HTML5,{autoplay:!1,mutedAutoPlay:a}):"iPhone"!==l.Env.device.model||a||Object(l.setCapabilities)(l.EngineType.HTML5,{autoplay:!1,mutedAutoPlay:!1})}}(r),r}function G(e){return function(){if(e.player){F.push({level:"warn",msg:"Path config.player will be deprecated soon. Please update your config structure as describe here: https://github.com/kaltura/kaltura-player-js/blob/master/docs/configuration.md"});var t=l.Utils.Object.copyDeep(e.player);delete e.player,l.Utils.Object.mergeDeep(e,t)}}(),[["duration","sources.duration"],["type","sources.type"],["dvr","sources.dvr"],["id","sources.id"],["name","metadata.name"],["metadata.poster","sources.poster"],["metadata","sources.metadata"],["logLevel","log.level"],["ui.components.fullscreen.inBrowserFullscreenForIOS","playback.inBrowserFullscreen"],["playback.enableCEA708Captions","text.enableCEA708Captions"],["playback.useNativeTextTrack","text.useNativeTextTrack"],["playback.options.html5.dash.useShakaTextTrackDisplay","text.useShakaTextTrackDisplay"],["playback.captionsTextTrack1Label","text.captionsTextTrack1Label"],["playback.captionsTextTrack1LanguageCode","text.captionsTextTrack1LanguageCode"],["playback.captionsTextTrack2Label","text.captionsTextTrack2Label"],["playback.captionsTextTrack2LanguageCode","text.captionsTextTrack2LanguageCode"],["plugins.visibility.threshold","viewability.playerThreshold"],["plugins.visibility.floating","plugins.floating"],["playback.startTime","sources.startTime"]].forEach((function(t){return function(t,r){if(l.Utils.Object.hasPropertyPath(e,t))if(F.push({level:"warn",msg:"Path config.player."+t+" will be deprecated soon. Please update your config structure as describe here: https://github.com/kaltura/kaltura-player-js/blob/master/docs/configuration.md"}),l.Utils.Object.hasPropertyPath(e,r))l.Utils.Object.deletePropertyPath(e,t);else{var a=l.Utils.Object.getPropertyPath(e,t),n=l.Utils.Object.createPropertyPath({},r,a);l.Utils.Object.mergeDeep(e,n),l.Utils.Object.deletePropertyPath(e,t)}}(t[0],t[1])})),e}function K(e,t,r){var a=e.config.playback,n=!1;return a.streamPriority.forEach((function(e){e.engine===t&&(n=!0)})),n||a.streamPriority.push({engine:t,format:r}),a}function W(e){var t=e&&e.progressive;return!(!t||!t[0]||"video/youtube"!==t[0].mimetype)}function z(e){var t=e&&e.image;return!(!t||!t[0])}function q(e,t){var r={},a={};return l.Utils.Object.isObject(e)&&Object.entries(e).forEach((function(e){var n=e[0],i=e[1];r[n]={},a[n]={},Object.entries(i).forEach((function(e){var i=e[0],o=e[1],s=l.Utils.Object.getPropertyPath(t[n],i);r[n][i]=s||o,a[n][i]=s}))})),[r,a]}function Y(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,X(a.key),a)}}function X(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var Q=function(){function e(e,t,r){this.name=e,this.player=t,this.eventManager=new l.EventManager,this.logger=Object(l.getLogger)(l.Utils.String.capitlize(this.name)),this.config={},l.Utils.Object.mergeDeep(this.config,this.constructor.defaultConfig,r)}e.createPlugin=function(e,t,r){return void 0===r&&(r={}),new this(e,t,r)},e.isValid=function(){throw new l.Error(l.Error.Severity.CRITICAL,l.Error.Category.PLAYER,l.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"isValid()")};var t,r,a,n=e.prototype;return n.getConfig=function(e){return e?l.Utils.Object.copyDeep(this.config[e]):l.Utils.Object.copyDeep(this.config)},n.updateConfig=function(e){l.Utils.Object.mergeDeep(this.config,e)},n.loadMedia=function(){},n.destroy=function(){this.eventManager.destroy()},n.reset=function(){},n.getName=function(){return this.name},n.dispatchEvent=function(e,t){this.logger.debug("Fire event: "+e,t),this.player.dispatchEvent(new l.FakeEvent(e,t))},t=e,(r=[{key:"ready",get:function(){return Promise.resolve()}}])&&Y(t.prototype,r),a&&Y(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function J(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){(t=X(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Q,"defaultConfig",{});var Z=function(){function e(){J(this,"_plugins",{}),J(this,"_isDisabledPluginMap",new Map)}e.register=function(t,r){return"function"!=typeof r||r.prototype instanceof Q==!1?(e._logger.error("Plugin <"+t+"> registration failed, either plugin is not an instance of BasePlugin or plugin handler is not a function"),!1):e._registry.has(t)?(e._logger.debug("Plugin <"+t+"> is already registered, do not register again"),!1):(e._registry.set(t,r),e._logger.debug("Plugin <"+t+"> has been registered successfully"),!0)},e.unRegister=function(t){e._registry.has(t)&&(e._registry.delete(t),e._logger.debug("Unregistered <"+t+"> plugin."))};var t=e.prototype;return t.load=function(t,r,a){if(void 0===a&&(a={}),!e._registry.has(t))throw e._logger.warn("Plugin <"+t+"> loading failed, plugin is not registered"),new l.Error(l.Error.Severity.RECOVERABLE,l.Error.Category.PLAYER,l.Error.Code.RUNTIME_ERROR_NOT_REGISTERED_PLUGIN,t);var n=e._registry.get(t);"boolean"==typeof a.disable&&this._isDisabledPluginMap.set(t,a.disable);var i=!!this._isDisabledPluginMap.get(t),o=!!n&&n.isValid();if(n&&o&&!i){try{this._plugins[t]=n.createPlugin(t,r,a)}catch(e){throw new l.Error(l.Error.Severity.RECOVERABLE,l.Error.Category.PLAYER,l.Error.Code.PLUGIN_LOAD_FAILED,e)}return this._isDisabledPluginMap.set(t,!1),e._logger.debug("Plugin <"+t+"> has been loaded"),!0}return e._logger.debug("Plugin <"+t+"> isn't loaded, isValid()="+o.toString()+", disabled="+i.toString()),!1},t.loadMedia=function(){var e=this;Object.keys(this._plugins).forEach((function(t){return e._plugins[t].loadMedia()}))},t.destroy=function(){var e=this;Object.keys(this._plugins).forEach((function(t){e._plugins[t].destroy(),delete e._plugins[t]}))},t.reset=function(){var e=this;Object.keys(this._plugins).forEach((function(t){return e._plugins[t].reset()}))},t.get=function(e){return this._plugins[e]},t.getAll=function(){return this._plugins},e}();J(Z,"_logger",Object(l.getLogger)("PluginManager")),J(Z,"_registry",new Map);var ee=Z.register,te={youbora:{playerVersion:"{{pVersion}}",playerName:"{{pName}}",entryId:"{{entryId}}",entryName:"{{entryName}}",entryType:"{{entryType}}",sessionId:"{{sessionId}}",uiConfId:"{{uiConfId}}"},googleAnalytics:{entryId:"{{entryId}}",entryName:"{{entryName}}",uiConfId:"{{uiConfId}}",partnerId:"{{partnerId}}"},ottAnalytics:{entryId:"{{entryId}}",ks:"{{ks}}",isAnonymous:"{{isAnonymous}}",partnerId:"{{partnerId}}",serviceUrl:"{{serviceUrl}}"},ima:{playerVersion:"{{pVersion}}",playerName:"{{pName}}"},kava:{playerVersion:"{{pVersion}}",playerName:"{{pName}}",partnerId:"{{partnerId}}",playlistId:"{{playlistId}}",entryId:"{{entryId}}",entryType:"{{entryType}}",sessionId:"{{sessionId}}",ks:"{{ks}}",uiConfId:"{{uiConfId}}",referrer:"{{referrer}}",encodedReferrer:"{{encodedReferrer}}",serviceUrl:"{{analyticsServiceUrl}}"},comscore:{playerVersion:"{{pVersion}}"},vr:{rootElement:"{{domRootElementId}}"},share:{partnerId:"{{partnerId}}",uiConfId:"{{uiConfId}}",entryId:"{{entryId}}",embedBaseUrl:"{{embedBaseUrl}}"}},re=new RegExp("{{.*}}");function ae(e,t){return(ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ne(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ie=function(e){var t,r;function a(){var t;return ne(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t=e.call(this)||this),"_ottPluginsConfig",{kava:{ks:""}}),t._config=l.Utils.Object.mergeDeep({},t._basePluginsConfig,t._ottPluginsConfig),t}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,ae(t,r),a}(function(){function e(){this._basePluginsConfig=l.Utils.Object.copyDeep(te)}var t=e.prototype;return t.get=function(){return this._config},t.set=function(e){if(e){var t=function e(t){return void 0===t&&(t={}),Object.entries(t).reduce((function(t,r){var a=r[0],n=r[1];return l.Utils.Object.isObject(n)?t[a]=e(n):"string"==typeof n&&re.test(n)?t[a]=n:t[a]=void 0,t}),{})}(e);this._config=function e(t){return void 0===t&&(t={}),Object.entries(t).reduce((function(t,r){var a=r[0],n=r[1];return l.Utils.Object.isObject(n)?t[a]=e(n):n&&(t[a]=n),t}),{})}(l.Utils.Object.mergeDeep(this._config,t))}},t.reset=function(){this._config=l.Utils.Object.copyDeep(te)},e}());var oe=function(e,t){void 0===t&&(t={});try{var r,a=e;for(var n in t){var i=void 0!==t[n]&&null!==t[n]?t[n]:"";"string"==typeof i&&i.indexOf('"')>-1&&(i=i.replace(/"/g,'\\"')),r=new RegExp("{{"+n+"}}","g"),a=a.replace(r,i)}return a}catch(e){return""}},se=Object(l.getLogger)("PluginsConfig"),le=function(e){return("number"==typeof e||"function"==typeof e||"string"==typeof e||"boolean"==typeof e||l.Utils.Object.isClassInstance(e))&&!re.test(e.toString())},ue=function(e){return l.Utils.Object.isObject(e)&&"function"!=typeof e&&!l.Utils.Object.isClassInstance(e)},ce=function(e){return e.map((function(e){if(ue(e)){var t=de(e);return l.Utils.Object.isEmptyObject(t)?null:t}return le(e)?e:null})).filter((function(e){return null!==e}))},de=function e(t){return void 0===t&&(t={}),Object.entries(t).reduce((function(t,r){var a=r[0],n=r[1];return ue(n)?t[a]=e(n):Array.isArray(n)?t[a]=ce(n):le(n)&&(t[a]=n),t}),{})};var pe=function(){function e(){this._pluginConfigStore=new ie}return e.prototype.evaluatePluginsConfig=function(e,t){if(e){this._pluginConfigStore.set(e);var r=function(e){var t,r={pVersion:(null==(t=$())?void 0:t.productVersion)||"3.13.1-test-shaka-9-4-23.5",pName:"kaltura-player-js"};if(e.targetId&&(r.domRootElementId=e.targetId),e.provider&&e.provider.env){r.serviceUrl=e.provider.env.serviceUrl;var a=l.Utils.Object.getPropertyPath(e,"provider.env.analyticsServiceUrl");a&&(r.analyticsServiceUrl=a+"/api_v3/index.php"),r.serviceUrl&&(r.embedBaseUrl=r.serviceUrl.replace("api_v3",""))}var n,i={referrer:w(),encodedReferrer:(n=w(),encodeURIComponent(n))};return e.provider&&l.Utils.Object.mergeDeep(i,{ks:e.provider.ks,uiConfId:e.provider.uiConfId,partnerId:e.provider.partnerId}),e.session&&l.Utils.Object.mergeDeep(i,{sessionId:e.session.id,ks:e.session.ks,isAnonymous:e.session.isAnonymous,uiConfId:e.session.uiConfId,partnerId:e.session.partnerId}),e.sources&&l.Utils.Object.mergeDeep(i,{entryId:e.sources.id,entryName:e.sources.metadata&&e.sources.metadata.name,entryType:e.sources.type}),e.playlist&&l.Utils.Object.mergeDeep(i,{playlistId:e.playlist.id}),Object.keys(i).forEach((function(e){void 0===i[e]&&delete i[e]})),l.Utils.Object.mergeDeep(r,i),r}(t),a=l.Utils.Object.mergeDeep({},this._pluginConfigStore.get(),e);!function(e,t){var r=de(t),a=de(e);a&&r&&Object.keys(e).forEach((function(t){e&&e[t]&&(e[t]=l.Utils.Object.mergeDeep({},r[t],a[t]))}))}(e,function(e){var t,r;e=(r=e)?r.replace(/\\n/g,"\\n").replace(/\\'/g,"\\'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f").replace(/[\u0000-\u0019]+/g,""):"";try{t=JSON.parse(e,(function(e){try{return JSON.parse(this[e])}catch(t){return this[e]}}))}catch(e){se.error("An error occurred while formatting config string.",e),t={}}return t}(oe(JSON.stringify(a),r)))}},e}();function he(e,t,r){var a=e.poster,n=t.poster,i=r.width,o=r.height;if("string"==typeof a&&a===n){/.*\/thumbnail\/.*(?:width|height)\/\d+\/(?:height|width)\/\d+/.test(a)&&(e.poster=function(e,t,r){var a=e.match(/width\/(\d+)/),n=e.match(/height\/(\d+)/);Array.isArray(a)&&(e=e.replace(a[1],t.toString()));Array.isArray(n)&&(e=e.replace(n[1],r.toString()));return e}(a,i,o))}else Array.isArray(a)&&(e.poster=function(e,t,r){var a=1/0,n="";return e.forEach((function(e){var i=e.width,o=e.height,s=Math.abs(i-t)+Math.abs(o-r);s<a&&(a=s,n=e.url)})),n}(a,i,o));t.poster=e.poster||""}r(320);function fe(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,ye(a.key),a)}}function ge(e,t,r){return(t=ye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ye(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var me=function(){function e(e,t){var r=this;ge(this,"_disabled",!1),this._player=e;var a=t.ui;if(a.disable){this._disabled=!0;var n=document.getElementById(a.targetId);n&&n.appendChild(e.getView())}else this._uiManager=new u.UIManager(e,a),a.customPreset?this._uiManager.buildCustomUI(a.customPreset):this._uiManager.buildDefaultUI(),this._handleVr(t.plugins),this._handleExternalCSS(a);return new Proxy(this,{get:function(e,t){return r._disabled?function(){}:e[t]}})}var t,r,a,n=e.prototype;return n.destroy=function(){this._uiManager.destroy()},n.reset=function(){this._resetErrorState()},n.setConfig=function(e,t){this._uiManager.setConfig(e,t)},n.addComponent=function(e){return this._uiManager.addComponent(e)},n.removeComponent=function(e){var t={label:"Remove_"+e.removeComponent,get:u.Components.Remove,presets:e.presets,area:e.area||e.container,replaceComponent:e.removeComponent};return this._uiManager.addComponent(t)},n.registerManager=function(e,t){this._player.registerService(e,t)},n.getManager=function(e){return this._player.getService(e)},n.hasManager=function(e){return this._player.hasService(e)},n.setLoadingSpinnerState=function(e){this.setConfig({show:e},"loading")},n._resetErrorState=function(){this.setConfig({hasError:!1},"engine")},n._handleExternalCSS=function(t){t.css&&l.Utils.Dom.loadStyleSheetAsync(t.css).then((function(){e._logger.debug("external css was loaded successfully")}),(function(){e._logger.error("external css failed to load")}))},n._handleVr=function(e){void 0===e&&(e={}),e.vr&&!e.vr.disable&&this._setStereoConfig(e.vr)},n._setStereoConfig=function(e){(e.toggleStereo||(l.Env.isMobile||l.Env.isTablet)&&!1!==e.toggleStereo)&&this.setConfig(l.Utils.Object.mergeDeep({},{vrStereoMode:!!e.startInStereo}),"vrStereo")},t=e,(r=[{key:"store",get:function(){return this._uiManager.store}}])&&fe(t.prototype,r),a&&fe(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();ge(me,"_logger",Object(l.getLogger)("UIWrapper"));var ve={PLAYLIST_LOADED:"kaltura-player-playlistloaded",PLAYLIST_ITEM_CHANGED:"kaltura-player-playlistitemchanged",PLAYLIST_ENDED:"kaltura-player-playlistended"};function _e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,ke(a.key),a)}}function ke(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var Ee=["hls","dash","progressive","image"],Te=function(){function e(e,t,r){this._sources=e,this._config=t,this._index=r}var t,r,a,n=e.prototype;return n.updateSources=function(e){this._sources=l.Utils.Object.mergeDeep({},e)},n.updatePlugins=function(e){this._plugins=l.Utils.Object.copyDeep(e)},n.isPlayable=function(){var e=this;return!!Ee.find((function(t){return e._sources&&e._sources[t]&&e._sources[t].length}))},t=e,(r=[{key:"sources",get:function(){var e=this;return Ee.forEach((function(t){e._sources&&e._sources[t]&&0===e._sources[t].length&&delete e._sources[t]})),this._sources}},{key:"config",get:function(){return this._config}},{key:"plugins",get:function(){return this._plugins||{}}},{key:"index",get:function(){return this._index}}])&&_e(t.prototype,r),a&&_e(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function be(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Se(a.key),a)}}function Se(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var Ae=function(){function e(){this._id="",this._metadata={name:"",description:""},this._poster="",this._items=[],this._activeItemIndex=-1}var t,r,a,n=e.prototype;return n.configure=function(e,t){var r=this;this._id=e.id?e.id:this._id,this._poster=e.poster?e.poster:this._poster,this._metadata=e.metadata?e.metadata:this._metadata,e.items&&(this._items=[],e.items.forEach((function(e,a){if(e.sources){var n=l.Utils.Object.mergeDeep({},t),i=e.sources.options||{};e.sources.options=l.Utils.Object.mergeDeep(n,i)}r._items.push(new Te(e.sources,e.config,a))})))},n.updateItemSources=function(e,t){this._items[e].updateSources(t)},n.updateItemPlugins=function(e,t){this._items[e].updatePlugins(t)},n.getNext=function(e){var t=e?(this._activeItemIndex+1)%this._items.length:this._activeItemIndex+1;return this._items[t]||null},t=e,(r=[{key:"id",get:function(){return this._id}},{key:"items",get:function(){return this._items}},{key:"metadata",get:function(){return this._metadata}},{key:"poster",get:function(){return this._poster}},{key:"current",get:function(){return this._items[this._activeItemIndex]||null}},{key:"prev",get:function(){return this._items[this._activeItemIndex-1]||null}},{key:"activeItemIndex",set:function(e){this._activeItemIndex=e}}])&&be(t.prototype,r),a&&be(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ce(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Pe(a.key),a)}}function Pe(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var we=function(){function e(e,t){this._player=e,this._eventManager=new l.EventManager,this._playlist=new Ae,this._options={autoContinue:!0,loop:!1,imageDuration:5},this._countdown={duration:10,showing:!0},this._mediaInfoList=[],this._playerOptions=t,this._appPluginConfig={}}var t,r,a,n=e.prototype;return n.configure=function(e,t){e&&(this._playlist.configure(e,l.Utils.Object.getPropertyPath(this._player.sources,"options")),l.Utils.Object.mergeDeep(this._options,e.options),l.Utils.Object.mergeDeep(this._countdown,e.countdown),e.items&&e.items.find((function(e){return!!e.sources}))&&(this._mediaInfoList=e.items.map((function(e,r){return t&&t.entries&&"object"==typeof t.entries[r]?t.entries[r]:{entryId:e.sources.id}})),this._player.dispatchEvent(new l.FakeEvent(ve.PLAYLIST_LOADED,{playlist:this})),this._addBindings(),this.playNext()))},n.load=function(e,t,r){var a=this._getMergedPlaylistData(e,t);this.configure(a,r)},n.reset=function(){this._eventManager.removeAll(),this._playlist=new Ae,this._mediaInfoList=[]},n.playNext=function(){e._logger.debug("playNext");var t=this._playlist.getNext(!0);t&&this._setItem(t)},n.playPrev=function(){e._logger.debug("playPrev");var t=this._playlist.prev;t&&this._setItem(t)},n.playItem=function(t){e._logger.debug("playItem("+t+")");var r=this._playlist.items[t];r&&this._setItem(r)},n._getMergedPlaylistData=function(e,t){var r=this;return{id:e.id,metadata:e.metadata,poster:e.poster,options:t?t.options:this._options,countdown:t?t.countdown:this.countdown,items:e.items.map((function(e,a){var n=l.Utils.Object.copyDeep(e);return l.Utils.Object.mergeDeep(n.sources,t&&t.items&&t.items[a]&&t.items[a].sources),Array.isArray(n.sources.poster)&&r._player.updateKalturaPoster(n.sources,e.sources,r._player.dimensions),{sources:n.sources,config:t&&t.items&&t.items[a]&&t.items[a].config}}))}},n._addBindings=function(){var e=this;this._eventManager.listen(this._player,this._player.Event.Core.PLAYBACK_ENDED,(function(){return e._onPlaybackEnded()})),this._eventManager.listen(this._player,this._player.Event.Core.CHANGE_SOURCE_STARTED,(function(){return e._onChangeSourceStarted()}))},n._onPlaybackEnded=function(){var e=this._playlist.getNext(!1);e||this._player.dispatchEvent(new l.FakeEvent(ve.PLAYLIST_ENDED)),!this._playerOptions.ui.disable&&this.countdown.showing||(e&&this._options.autoContinue||this._options.loop)&&this.playNext()},n._onChangeSourceStarted=function(){var e;"Image"===(null==(e=this._playlist.items[this._playlist._activeItemIndex].sources)?void 0:e.type)&&this._player.configure({sources:{duration:this._options.imageDuration}})},n._setItem=function(t){var r=this,a=t.index;e._logger.debug("Playing item number "+a,t);var n={loop:!1};if(this._playlist.current&&(n.autoplay=!0),this._player.configure({playback:n}),this._playlist.activeItemIndex=a,t.isPlayable()){this._resetProviderPluginsConfig();var i=q(t.plugins,this._player.config.plugins),o=i[0];this._appPluginConfig=i[1];var s={session:this._player.config.session,plugins:o,sources:t.sources};return this._player.setMedia(s),this._player.dispatchEvent(new l.FakeEvent(ve.PLAYLIST_ITEM_CHANGED,{index:a,activeItem:t})),Promise.resolve()}if(this._mediaInfoList[a]){this._resetProviderPluginsConfig();var u={sources:t.sources};return this._player.setMedia(u),this._player.loadMedia(this._mediaInfoList[a]).then((function(e){r._playlist.updateItemSources(a,e.sources),r._playlist.updateItemPlugins(a,e.plugins),r._player.dispatchEvent(new l.FakeEvent(ve.PLAYLIST_ITEM_CHANGED,{index:a,activeItem:t}))}))}return Promise.reject()},n._resetProviderPluginsConfig=function(){this._player.configure({plugins:this._appPluginConfig}),this._appPluginConfig={}},n.destroy=function(){this._eventManager.destroy()},t=e,(r=[{key:"items",get:function(){return this._playlist.items}},{key:"current",get:function(){return this._playlist.current}},{key:"next",get:function(){return this._playlist.getNext(this._options.loop)}},{key:"prev",get:function(){return this._playlist.prev}},{key:"id",get:function(){return this._playlist.id}},{key:"metadata",get:function(){return this._playlist.metadata}},{key:"poster",get:function(){return this._playlist.poster}},{key:"countdown",get:function(){if(this._playlist.current&&this._playlist.current.config){var e={duration:10,showing:!0};return l.Utils.Object.mergeDeep(e,this._countdown,this._playlist.current.config.countdown),e}return this._countdown}},{key:"options",get:function(){return this._options}}])&&Ce(t.prototype,r),a&&Ce(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();!function(e,t,r){(t=Pe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(we,"_logger",Object(l.getLogger)("PlaylistManager"));var xe={CAST_SESSION_START_FAILED:"kaltura-player-castsessionstartfailed",CAST_SESSION_STARTING:"kaltura-player-castsessionstarting",CAST_SESSION_STARTED:"kaltura-player-castsessionstarted",CAST_SESSION_ENDING:"kaltura-player-castsessionending",CAST_SESSION_ENDED:"kaltura-player-castsessionended",CAST_AVAILABLE:"kaltura-player-castavailable"},Ie=function(e){this.textStyle=e.textStyle,this.mediaInfo=e.getMediaInfo(),this.mediaConfig=e.getMediaConfig(),this.advertising=e.config.plugins&&e.config.plugins.ima,this.config=l.Utils.Object.mergeDeep({},e.config,{sources:{startTime:Me(e)},playback:{autoplay:0===e.currentTime||!e.paused,audioLanguage:De(l.TrackType.AUDIO,e),textLanguage:De(l.TrackType.TEXT,e)}})};function Me(e){return e.isLive()?e.isDvr()?e.duration-e.currentTime<e.config.cast.dvrThreshold||!e.currentTime?-1:e.currentTime:-1:!e.isCasting()&&!e.currentTime&&e.config.sources.startTime>-1?e.config.sources.startTime:e.currentTime}function De(e,t){var r=t.getActiveTracks();if(r[e])return r[e].language;try{return t.config.playback[e+"Language"]}catch(e){return null}}function Re(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Oe(a.key),a)}}function Oe(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var Le=function(){function e(e,t,r){this._id=e,this._friendlyName=t,this._resuming=r}var t,r,a;return t=e,(r=[{key:"deviceFriendlyName",get:function(){return this._friendlyName}},{key:"id",get:function(){return this._id}},{key:"resuming",get:function(){return this._resuming}}])&&Re(t.prototype,r),a&&Re(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ne(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Be(a.key),a)}}function Ue(e,t){return(Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e,t,r){return(t=Be(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Be(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var je=function(e){var t,r;function a(t,r,n){var i;return Fe(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i=e.call(this)||this),"_isCastInitiator",!1),i._playerConfig={},a._logger=Object(l.getLogger)(t),i._remoteControl=n,i._castConfig=l.Utils.Object.mergeDeep({},i.constructor.defaultConfig,r),i._eventManager=new l.EventManager,a._logger.debug("Initialized"),i}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Ue(t,r),a.isSupported=function(){return!0};var n,i,o,s=a.prototype;return s.loadMedia=function(e){return Promise.resolve()},s.setMedia=function(e){},s.getMediaInfo=function(){},s.getMediaConfig=function(){},s.configure=function(e){void 0===e&&(e={})},s.ready=function(){return Promise.resolve()},s.load=function(){},s.play=function(){},s.pause=function(){},s.reset=function(){},s.destroy=function(){},s.isLive=function(){return!1},s.isDvr=function(){return!1},s.seekToLiveEdge=function(){},s.getStartTimeOfDvrWindow=function(){return 0},s.getTracks=function(e){return[]},s.getActiveTracks=function(){return{audio:void 0,video:void 0,text:void 0}},s.selectTrack=function(e){},s.hideTextTrack=function(){},s.enableAdaptiveBitrate=function(){},s.isAdaptiveBitrateEnabled=function(){return!0},s.setTextDisplaySettings=function(e){},s.startCasting=function(){},s.stopCasting=function(){},s.isCasting=function(){return!0},s.isCastAvailable=function(){return!0},s.getCastSession=function(){return new Le("","")},s.isVr=function(){return!1},s.toggleVrStereoMode=function(){},s.isInVrStereoMode=function(){return!1},n=a,(i=[{key:"ads",get:function(){return null}},{key:"textStyle",get:function(){return new l.TextStyle},set:function(e){}},{key:"buffered",get:function(){return[]}},{key:"currentTime",get:function(){return 0},set:function(e){}},{key:"duration",get:function(){return 0}},{key:"liveDuration",get:function(){return NaN}},{key:"volume",get:function(){return 1},set:function(e){}},{key:"paused",get:function(){return!1}},{key:"ended",get:function(){return!1}},{key:"seeking",get:function(){return!1}},{key:"muted",get:function(){return!1},set:function(e){}},{key:"src",get:function(){return""}},{key:"poster",get:function(){return""}},{key:"playbackRate",get:function(){return 1},set:function(e){}},{key:"engineType",get:function(){return""}},{key:"streamType",get:function(){return""}},{key:"type",get:function(){return a.Type}},{key:"config",get:function(){return this._playerConfig}},{key:"isCastInitiator",get:function(){return this._isCastInitiator},set:function(e){this._isCastInitiator=e}}])&&Ne(n.prototype,i),o&&Ne(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(l.FakeEventTarget);function Ve(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,$e(a.key),a)}}function $e(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}Fe(je,"defaultConfig",{}),Fe(je,"Type","BaseRemotePlayer");var He=function(){function e(){var e=this;!function(e,t,r){(t=$e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"_uis",[{template:function(t){return e.idleUI(t)},condition:function(e){return e.engine.isIdle}},{template:function(t){return e.errorUI(t)},condition:function(e){return e.engine.hasError}},{template:function(t){return e.adsUI(t)},condition:function(e){return e.engine.adBreak}},{template:function(t){return e.liveUI(t)},condition:function(e){return e.engine.isLive}},{template:function(t){return e.playbackUI(t)}}])}var t,r,a,n=e.prototype;return n.playbackUI=function(e){return u.Presets.playbackUI(e)},n.idleUI=function(e){return u.Presets.idleUI(e)},n.adsUI=function(e){return u.Presets.adsUI(e)},n.liveUI=function(e){return u.Presets.liveUI(e)},n.errorUI=function(e){return u.Presets.errorUI(e)},t=e,(r=[{key:"uis",get:function(){return this._uis}}])&&Ve(t.prototype,r),a&&Ve(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ge(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Ke(e,t)}function Ke(e,t){return(Ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function We(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,qe(a.key),a)}}function ze(e,t,r){return t&&We(e.prototype,t),r&&We(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qe(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var Ye=function(){function e(e){this._player=e}return ze(e,[{key:"player",get:function(){return this._player}}]),e}(),Xe=function(e){function t(t,r,a){var n;return(n=e.call(this,t)||this)._session=r,a&&(n._ui=a),n}return Ge(t,e),ze(t,[{key:"ui",get:function(){return this._ui}},{key:"session",get:function(){return this._session}}]),t}(Ye),Qe=function(e){function t(t,r){var a;return(a=e.call(this,t)||this)._snapshot=r,a}return Ge(t,e),ze(t,[{key:"snapshot",get:function(){return this._snapshot}}]),t}(Ye),Je=function(e){function t(t,r){var a;return(a=e.call(this,t)||this)._available=r,a}return Ge(t,e),ze(t,[{key:"available",get:function(){return this._available}}]),t}(Ye);var Ze=function(e){this.getPlayerSnapshot=ot.bind(e),this.getUIWrapper=st.bind(e),this.onRemoteDeviceAvailable=nt.bind(e),this.onRemoteDeviceConnected=tt.bind(e),this.onRemoteDeviceDisconnected=at.bind(e),this.onRemoteDeviceConnecting=et.bind(e),this.onRemoteDeviceDisconnecting=rt.bind(e),this.onRemoteDeviceConnectFailed=it.bind(e)};function et(){Ze._logger.debug("onRemoteDeviceConnecting"),this.dispatchEvent(new l.FakeEvent(xe.CAST_SESSION_STARTING))}function tt(e){var t=this;Ze._logger.debug("onRemoteDeviceConnected",e);var r=e.player,a=e.ui,n=e.session;this._eventManager.removeAll(),Object.values(l.EventType).forEach((function(e){return t._eventManager.listen(r,e,(function(e){return t.dispatchEvent(e)}))}));var i=this.config;a&&l.Utils.Object.mergeDeep(i,{ui:{customPreset:a.uis}}),this.configure({playback:{muted:this.muted,volume:this.volume}}),this._localPlayer.reset(),this._uiWrapper.destroy(),this._remotePlayer=r,this._uiWrapper=new me(this,i),this.dispatchEvent(new l.FakeEvent(xe.CAST_SESSION_STARTED,{session:n}))}function rt(){Ze._logger.debug("onRemoteDeviceDisconnecting"),this.dispatchEvent(new l.FakeEvent(xe.CAST_SESSION_ENDING))}function at(e){var t=this;Ze._logger.debug("onRemoteDeviceDisconnected",e);var r=e.player,a=e.snapshot;if(this._remotePlayer&&this._remotePlayer===r&&(this._eventManager.removeAll(),lt.call(this,a),a)){this.dispatchEvent(new l.FakeEvent(xe.CAST_SESSION_ENDED));var n,i=this.config,o=!a.config.playback.autoplay,s=a.mediaInfo,u=a.mediaConfig;a.config.playback.autoplay=!0,ut.call(this,a.config),this._eventManager.listenOnce(this,this.Event.Core.CHANGE_SOURCE_ENDED,(function(){ct.call(t,a.config.sources)})),s?n=this.loadMedia(s):u&&(n=Promise.resolve(),this.setMedia(u)),n&&n.then((function(){t._eventManager.listenOnce(t,t.Event.Core.FIRST_PLAYING,(function(){t.textStyle=a.textStyle,ut.call(t,i),dt.call(t,a.config.playback),o&&t.pause()}))}))}}function nt(e){Ze._logger.debug("onRemoteDeviceAvailable",e);var t=e.player,r=e.available;this.dispatchEvent(new l.FakeEvent(xe.CAST_AVAILABLE,{type:t.type,available:r}))}function it(){Ze._logger.debug("onRemoteDeviceConnectFailed"),this.dispatchEvent(new l.FakeEvent(xe.CAST_SESSION_START_FAILED))}function ot(){var e=new Ie(this);return Ze._logger.debug("getPlayerSnapshot",e),e}function st(){return Ze._logger.debug("getUIWrapper"),this._uiWrapper}function lt(e){var t=this;this._uiWrapper.destroy();var r=this._localPlayer.config;if(r.plugins&&r.plugins.ima){var a={};if(r.cast.advertising&&r.cast.advertising.vast){if(e.config.sources.startTime>0){var n=r.plugins.ima.adTagUrl;a={adTagUrl:""},this._eventManager.listen(this,l.EventType.FIRST_PLAYING,(function(){return t.configure({plugins:{ima:{adTagUrl:n}}})}))}}else a={delayInitUntilSourceSelected:!0};l.Utils.Object.mergeDeep(r,{plugins:{ima:a}}),this._localPlayer.destroy(),this._remotePlayer=null,this._localPlayer=Object(l.loadPlayer)(r)}else this._remotePlayer=null;Object.values(l.EventType).forEach((function(e){return t._eventManager.listen(t._localPlayer,e,(function(e){return t.dispatchEvent(e)}))})),this._uiWrapper=new me(this,this.config),this._uiWrapper.setConfig({isCastAvailable:this.isCastAvailable()},"engine")}function ut(e){var t=e.sources.startTime,r=e.playback.autoplay;this.configure({sources:{startTime:t},playback:{autoplay:r}})}function ct(e){if(e.captions.length){var t=e.captions;this.configure({sources:{captions:t}})}}function dt(e){if(e.audioLanguage){var t=this.getTracks(l.TrackType.AUDIO).find((function(t){return t.language===e.audioLanguage}));this.selectTrack(t)}if(e.textLanguage){var r=this.getTracks(l.TrackType.TEXT).find((function(t){return t.language===e.textLanguage}));this.selectTrack(r)}}function pt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ze,"_logger",Object(l.getLogger)("RemoteControl"));var ht=function(){function e(){pt(this,"_remotePlayers",new Map)}e.register=function(t,r){"function"==typeof r?e._registry.has(t)?e._logger.debug("Remote player of type "+t+" is already registered"):(e._logger.debug("Register remote player of type "+t),e._registry.set(t,r)):e._logger.debug("remote player must be instance of BaseRemotePlayer")};var t=e.prototype;return t.load=function(t,r){var a=this;e._registry.forEach((function(n,i){e._logger.debug("Load remote player of type "+i);var o=new n(t,new Ze(r),r.config.targetId);a._remotePlayers.set(i,o)}))},t.startCasting=function(t){e._logger.debug("Start casting");var r=this._getRemotePlayer(t);return r?r.startCasting():Promise.reject()},t.isCastAvailable=function(t){var r=this._getRemotePlayer(t);return!!r&&(e._logger.debug("isCastAvailable: "+r.isCastAvailable()),r.isCastAvailable())},t.destroy=function(){var e=this._remotePlayers;Array.from(e.values()).forEach((function(e){return e.destroy()}))},t.setIsCastInitiator=function(e,t){var r=this._getRemotePlayer(e);r&&(r.isCastInitiator=t)},t._getRemotePlayer=function(e){var t=this._remotePlayers;return e&&t.get(e)?t.get(e):t.size>0?Array.from(t.values())[0]:void 0},e}();function ft(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,gt(a.key),a)}}function gt(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}pt(ht,"_registry",new Map),pt(ht,"_logger",Object(l.getLogger)("RemotePlayerManager"));var yt=function(){function e(e){this._type=e.type,this._position=e.position,this._numAds=e.numAds}var t,r,a;return e.prototype.toJSON=function(){return{type:this.type,position:this.position,numAds:this.numAds}},t=e,(r=[{key:"type",get:function(){return this._type}},{key:"position",get:function(){return this._position}},{key:"numAds",get:function(){return this._numAds}}])&&ft(t.prototype,r),a&&ft(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function mt(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,vt(a.key),a)}}function vt(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var _t=function(){function e(e,t){this._id=e,this._system=t.system,this._url=t.url,this._contentType=t.contentType,this._title=t.title,this._position=t.position,this._duration=t.duration,this._clickThroughUrl=t.clickThroughUrl,this._posterUrl=t.posterUrl,this._skipOffset=t.skipOffset,this._linear=t.linear,this._width=t.width||0,this._height=t.height||0,this._bitrate=t.bitrate||0,this._bumper=t.bumper,this._inStream=t.inStream||!1,this._vpaid=t.vpaid||!1,this._streamId=t.streamId||"",this._wrapperAdIds=t.wrapperAdIds,this._wrapperCreativeIds=t.wrapperCreativeIds,this._wrapperAdSystems=t.wrapperAdSystems}var t,r,a;return e.prototype.toJSON=function(){return{id:this.id,system:this.system,url:this.url,contentType:this.contentType,title:this.title,position:this.position,duration:this.duration,clickThroughUrl:this.clickThroughUrl,posterUrl:this.posterUrl,skipOffset:this.skipOffset,linear:this.linear,skippable:this.skippable,width:this.width,height:this.height,bitrate:this.bitrate,bumper:this.bumper,inStream:this.inStream,vpaid:this.vpaid}},t=e,(r=[{key:"id",get:function(){return this._id}},{key:"system",get:function(){return this._system}},{key:"contentType",get:function(){return this._contentType}},{key:"url",get:function(){return this._url}},{key:"title",get:function(){return this._title}},{key:"position",get:function(){return this._position}},{key:"duration",get:function(){return this._duration}},{key:"clickThroughUrl",get:function(){return this._clickThroughUrl}},{key:"posterUrl",get:function(){return this._posterUrl}},{key:"skipOffset",get:function(){return this._skipOffset}},{key:"linear",get:function(){return this._linear}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"bitrate",get:function(){return this._bitrate}},{key:"bumper",get:function(){return this._bumper}},{key:"inStream",get:function(){return this._inStream}},{key:"skippable",get:function(){return!!(this.skipOffset&&this.skipOffset>0)}},{key:"vpaid",get:function(){return this._vpaid}},{key:"streamId",get:function(){return this._streamId}},{key:"wrapperAdIds",get:function(){return this._wrapperAdIds}},{key:"wrapperCreativeIds",get:function(){return this._wrapperCreativeIds}},{key:"wrapperAdSystems",get:function(){return this._wrapperAdSystems}}])&&mt(t.prototype,r),a&&mt(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function kt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Et=function(){function e(t){var r=this;kt(this,"_prebid",null),this._loadPromise=l.Utils.Object.defer(),this._loadPromise.catch((function(){return e._logger.warn("Prebid SDK failed to load")})),t?(this._config=t,this._loadPrebidSDKLib(this._config.libUrl).then((function(){r._isPrebidSDKLibLoaded()?(r._prebid=window.pbjs,r._loadPromise.resolve()):r._loadPromise.reject()})).catch((function(){r._loadPromise.reject()}))):this._loadPromise.reject()}var t=e.prototype;return t._isPrebidSDKLibLoaded=function(){return window.pbjs&&window.pbjs.que},t._loadPrebidSDKLib=function(e){return this._isPrebidSDKLibLoaded()?Promise.resolve():l.Utils.Dom.loadScriptAsync(e)},t._load=function(t){var r=this;return new Promise((function(a,n){r._loadPromise.then((function(){var i=setTimeout(n,t.timeout||4e3);r._prebid.que.push((function(){r._prebid.addAdUnits(t.adUnit),t.options&&r._prebid.setConfig(t.options),r._prebid.requestBids({bidsBackHandler:function(o){if(e._logger.debug("returned bids",o),clearTimeout(i),t.params){var s={};t.adUnit&&(s.adUnit=t.adUnit),s.params=t.params;var l=r._prebid.adServers.dfp.buildVideoUrl(s);a([{vastUrl:l}])}else try{var u=o[t.adUnit.code||Object.keys(o)[0]].bids;a(u)}catch(e){n()}}})}))})).catch(n)}))},t.load=function(e){return this._load(e||this._config)},e}();function Tt(e,t){return(Tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function bt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}kt(Et,"_logger",Object(l.getLogger)("PrebidManager"));var St=function(e){var t,r;function a(t){var r;return bt(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r=e.call(this)||this),"id","AdLayoutMiddleware"),r._context=t,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Tt(t,r);var n=a.prototype;return n.load=function(e){var t=this;this._context.prerollReady.then((function(){return t.callNext(e)}))},n.play=function(e){var t=this;this._context.prerollReady.then((function(){return t.callNext(e)}))},a}(l.BaseMiddleware);function At(){return(At=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ct(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,wt(a.key),a)}}function Pt(e,t){return(Pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function wt(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var xt=function(e){var t,r;function a(t,r){var a;return(a=e.call(this)||this)._player=t,a._eventManager=new l.EventManager,a._liveEventManager=new l.EventManager,a._adsPluginControllers=r,a._prebidManager=new Et(a._player.config.advertising&&a._player.config.advertising.prebid),a._init(),a}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Pt(t,r);var n,i,o,s=a.prototype;return s.isAdPlaying=function(){return this.isAdBreak()&&this._isAdPlaying},s.isAdBreak=function(){return!!this._adBreak},s.getAdBreaksLayout=function(){return this._adBreaksLayout},s.getAdBreak=function(){return this._adBreak},s.getAd=function(){return this._ad},s.skipAd=function(){var e=this._adsPluginControllers.find((function(e){return e.active}));e&&e.skipAd()},s.playAdNow=function(e){var t=this;if(this.isAdBreak())a._logger.warn("Tried to call playAdNow during an ad break");else{var r=Promise.all(e.map((function(e){return t._getPrebidAds(e)})));this._playAdBreak({position:this._player.currentTime||0,ads:e,played:!1,loadedPromise:r})}},s.getMiddleware=function(){return this._middleware?this._middleware:this._middleware=new St(this)},s._init=function(){this._initMembers(),this._addBindings()},s._initMembers=function(){this._allAdsCompleted=!0,this._adBreaksLayout=[],this._adBreak=null,this._ad=null,this._adPlayed=!1,this._snapback=0,this._adIsLoading=!1,this._isAdPlaying=!1,this._liveSeeking=!1},s._addBindings=function(){var e=this;this._eventManager.listen(this._player,l.CustomEventType.SOURCE_SELECTED,(function(){return e._handleConfiguredAdBreaks()})),this._eventManager.listen(this._player,l.AdEventType.AD_MANIFEST_LOADED,(function(t){return e._onAdManifestLoaded(t)})),this._eventManager.listen(this._player,l.AdEventType.AD_BREAK_START,(function(t){return e._onAdBreakStart(t)})),this._eventManager.listen(this._player,l.AdEventType.AD_LOADED,(function(){return e._onAdLoaded()})),this._eventManager.listen(this._player,l.AdEventType.AD_STARTED,(function(t){return e._onAdStarted(t)})),this._eventManager.listen(this._player,l.AdEventType.AD_COMPLETED,(function(){return e._isAdPlaying=!1})),this._eventManager.listen(this._player,l.AdEventType.AD_BREAK_END,(function(){return e._onAdBreakEnd()})),this._eventManager.listen(this._player,l.AdEventType.ADS_COMPLETED,(function(){return e._onAdsCompleted()})),this._eventManager.listen(this._player,l.AdEventType.AD_ERROR,(function(t){return e._onAdError(t)})),this._eventManager.listen(this._player,l.CustomEventType.PLAYER_RESET,(function(){return e._reset()})),this._eventManager.listen(this._player,l.CustomEventType.PLAYER_DESTROY,(function(){return e._destroy()})),this._eventManager.listenOnce(this._player,l.Html5EventType.ENDED,(function(){return e._onEnded()})),this._eventManager.listenOnce(this._player,l.CustomEventType.PLAYBACK_ENDED,(function(){return e._onPlaybackEnded()})),this._eventManager.listen(this._player,l.AdEventType.AD_RESUMED,(function(){return e._isAdPlaying=!0})),this._eventManager.listen(this._player,l.AdEventType.AD_PAUSED,(function(){return e._isAdPlaying=!1}))},s._handleConfiguredAdBreaks=function(){var e=this,t=this._player.config.advertising.playAdsAfterTime||this._player.config.sources.startTime;this._configAdBreaks=this._player.config.advertising.adBreaks.filter((function(e){return("number"==typeof e.every||"number"==typeof e.position||"number"==typeof e.percentage)&&e.ads.length})).map((function(r){e._validateOneTimeConfig(r);var a=r.position;0===r.percentage&&(a=0),100===r.percentage&&(a=-1),r.every&&(a=r.every);var n=e._player.isLive()?a<t:a<=t;return{position:a,percentage:r.percentage,every:r.every,ads:r.ads.slice(),played:-1<a&&n}})),this._configAdBreaks.length?(this._dispatchAdManifestLoaded(),this._handlePrebidAdConfig(),this._handleConfiguredPreroll(),this._eventManager.listenOnce(this._player,l.Html5EventType.DURATION_CHANGE,(function(){e._player.isLive()?e._eventManager.listenOnce(e._player,l.Html5EventType.SEEKING,(function(){e._pushNextAdsForLive(e._configAdBreaks,(function(t){return e._player.currentTime+t.every})),e._attachLiveSeekedHandler()})):e._handleEveryAndPercentage(),e._configAdBreaks.sort((function(e,t){return e.position-t.position})),e._configAdBreaks.some((function(e){return e.position>0}))&&e._handleConfiguredMidrolls()}))):this.prerollReady=Promise.resolve()},s._validateOneTimeConfig=function(e){"number"==typeof e.position&&("number"==typeof e.percentage&&(a._logger.warn("Validate ad break - ignore percentage "+e.percentage+" as position "+e.position+" configured"),delete e.percentage),"number"==typeof e.every&&(a._logger.warn("Validate ad break - ignore every "+e.every+" as position "+e.position+" configured"),delete e.every)),"number"==typeof e.percentage&&"number"==typeof e.every&&(a._logger.warn("Validate ad break - ignore every "+e.every+" as percentage "+e.percentage+" configured"),delete e.every)},s._dispatchAdManifestLoaded=function(){var e=this,t=Array.from(new Set(this._configAdBreaks.map((function(e){return e.every&&e.every+"s"||"number"==typeof e.percentage&&e.percentage+"%"||e.position}))));a._logger.debug(l.AdEventType.AD_MANIFEST_LOADED,t),this._player.dispatchEvent(new l.FakeEvent(l.AdEventType.AD_MANIFEST_LOADED,{adBreaksPosition:t})),this._player.hasService("timeline")&&this._player.config.advertising.showAdBreakCuePoint&&t.forEach((function(t){e._player.getService("timeline").addCuePoint(At({time:-1!==t?t:1/0},e._player.config.advertising.adBreakCuePointStyle))}))},s._handlePrebidAdConfig=function(){var e=this;this._prebidManager&&this._configAdBreaks.filter((function(e){return!e.played})).map((function(t){var r=Promise.all(t.ads.map((function(t){return e._getPrebidAds(t)})));t.loadedPromise=r,r.then((function(e){return t.ads=e}))}))},s._getPrebidAds=function(e){var t=this;return new Promise((function(r){if(e.prebid&&t._prebidManager){var a=l.Utils.Object.mergeDeep({},e.prebid,t._player.config.advertising.prebid);t._prebidManager.load(a).then((function(t){var a=t.map((function(e){return e&&e.vastUrl}));e.url=a.concat(e.url),r(e)})).catch((function(){r(e)}))}else r(e)}))},s._handleConfiguredPreroll=function(){var e=this._configAdBreaks.filter((function(e){return 0===e.position&&!e.played})),t=this._mergeAdBreaks(e);this.prerollReady=t&&t.loadedPromise?t.loadedPromise:Promise.resolve(),t&&this._playAdBreak(t)},s._handleEveryAndPercentage=function(){var e=this;this._configAdBreaks.forEach((function(t){if(e._player.duration&&t.every)for(var r=2*t.every;r<=e._player.duration;)e._configAdBreaks.push({position:r,ads:t.ads,played:!1,loadedPromise:Promise.resolve()}),r+=t.every;else e._player.duration&&t.percentage&&!t.position&&(t.position=Math.floor(e._player.duration*t.percentage/100))}))},s._attachLiveSeekedHandler=function(){var e=this;this._eventManager.listenOnce(this._player,l.CustomEventType.FIRST_PLAYING,(function(){e._eventManager.listen(e._player,l.Html5EventType.SEEKING,(function(){e._liveSeeking=!0})),e._eventManager.listen(e._player,l.Html5EventType.SEEKED,(function(){e._liveSeeking=!1,e._pushNextAdsForLive(e._configAdBreaks,(function(t){return e._player.currentTime+t.every}))}))}))},s._pushNextAdsForLive=function(e,t){this._liveEventManager.removeAll();var r=[];e.forEach((function(e){if(![-1,0].includes(e.position)){var n=e.every,i=e.ads,o={every:n,position:t(e),ads:i,played:!1,loadedPromise:Promise.resolve()};a._logger.debug("Pushing next ad for live",o),r.push(o)}})),r.length&&(this._configAdBreaks=[].concat(r,this._configAdBreaks.filter((function(e){return-1===e.position}))))},s._handleConfiguredMidrolls=function(){var e=this;this._eventManager.listen(this._player,l.Html5EventType.TIME_UPDATE,(function(){if(!e._player.paused&&!e._liveSeeking){var t=e._configAdBreaks.filter((function(t){return!t.played&&e._player.currentTime&&t.position<=e._player.currentTime&&t.position>e._snapback}));if(t.length){var r=t[t.length-1].position,n=t.filter((function(e){return e.position===r}));if(e._player.isLive())!e._player.isDvr()||e._player.isOnLiveEdge()&&e._player.config.advertising.returnToLive?e._handleReturnToLive(n):e._pushNextAdsForLive(n,(function(t){return(e._player.isOnLiveEdge()?e._player.currentTime:t.position)+t.every}));else e._snapback=r,a._logger.debug("Set snapback value "+e._snapback),e._eventManager.listen(e._player,l.Html5EventType.SEEKED,(function(){var t=e._configAdBreaks.findIndex((function(t){return t.played&&"number"==typeof e._player.currentTime&&e._player.currentTime<t.position}));t>0&&!e._configAdBreaks[t-1].played&&(e._snapback=0,a._logger.debug("Reset snapback value"))}));var i=e._mergeAdBreaks(n);i&&e._playAdBreak(i)}}}))},s._handleReturnToLive=function(e){var t=this;this._liveEventManager.listenOnce(this._player,l.AdEventType.AD_ERROR,(function(){t._pushNextAdsForLive(e,(function(e){return(t._player.isOnLiveEdge()?t._player.currentTime:e.position)+e.every}))})),this._liveEventManager.listenOnce(this._player,l.AdEventType.AD_BREAK_END,(function(){t._player.seekToLiveEdge()}))},s._playAdBreak=function(e){var t=this._adsPluginControllers.find((function(e){return"function"==typeof e.playAdNow}));t?(e.played=!0,this._adIsLoading=!0,a._logger.debug("Playing ad break positioned in "+e.position),e.loadedPromise.then((function(){return t.playAdNow(e.ads)}))):a._logger.warn("No ads plugin registered")},s._onAdManifestLoaded=function(e){this._adBreaksLayout=Array.from(new Set(this._adBreaksLayout.concat(e.payload.adBreaksPosition))).sort(),this._allAdsCompleted=!1},s._onAdBreakStart=function(e){this._adBreak=e.payload.adBreak},s._onAdLoaded=function(){this._adIsLoading=!1},s._onAdStarted=function(e){this._ad=e.payload.ad,this._adPlayed=!0,this._isAdPlaying=!0},s._onAdBreakEnd=function(){this._adBreak=null,this._ad=null},s._onAdsCompleted=function(){this._adsPluginControllers.every((function(e){return e.done}))&&this._configAdBreaks.every((function(e){return e.played}))&&(this._allAdsCompleted=!0,a._logger.debug(l.AdEventType.ALL_ADS_COMPLETED),this.dispatchEvent(new l.FakeEvent(l.AdEventType.ALL_ADS_COMPLETED)))},s._onAdError=function(e){this._adIsLoading=!1,e.payload.severity===l.Error.Severity.CRITICAL&&(this._isAdPlaying=!1,this._adsPluginControllers.every((function(e){return e.done}))&&this._configAdBreaks.every((function(e){return e.played}))&&(this._allAdsCompleted=!0,this._adPlayed&&(a._logger.debug(l.AdEventType.ALL_ADS_COMPLETED),this.dispatchEvent(new l.FakeEvent(l.AdEventType.ALL_ADS_COMPLETED)))))},s._isBumper=function(e){return"bumper"===e.name},s._onEnded=function(){var e=this;if(!this._adIsLoading){var t=this._adsPluginControllers.find((function(t){return e._isBumper(t)})),r=this._adsPluginControllers.find((function(t){return!e._isBumper(t)&&!t.done})),a=t&&"function"==typeof t.onPlaybackEnded?function(){return t.onPlaybackEnded()}:function(){return Promise.resolve()},n=r&&"function"==typeof r.onPlaybackEnded?function(){return r.onPlaybackEnded()}:function(){return Promise.resolve()};this._adBreaksLayout.includes(-1)||this._adBreaksLayout.includes("100%")||(this._allAdsCompleted=!0),a().finally((function(){n().finally((function(){return e._handleConfiguredPostroll()}))}))}},s._onPlaybackEnded=function(){this._configAdBreaks.forEach((function(e){return e.played=!0}))},s._handleConfiguredPostroll=function(){var e=this._configAdBreaks.filter((function(e){return!e.played&&-1===e.position}));if(e.length){var t=this._mergeAdBreaks(e);t&&this._playAdBreak(t)}this._configAdBreaks.forEach((function(e){return e.played=!0}))},s._reset=function(){this._eventManager.removeAll(),this._liveEventManager.removeAll(),this._init()},s._destroy=function(){this._adsPluginControllers=[],this._eventManager.destroy(),this._liveEventManager.destroy()},s._mergeAdBreaks=function(e){if(e.length)return e.forEach((function(e){return e.played=!0})),{position:e[0].position,ads:e.reduce((function(e,t){return e.concat(t.ads)}),[]),played:!1,loadedPromise:Promise.all(e.map((function(e){return e.loadedPromise})))}},n=a,(i=[{key:"allAdsCompleted",get:function(){return this._allAdsCompleted}}])&&Ct(n.prototype,i),o&&Ct(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(l.FakeEventTarget);!function(e,t,r){(t=wt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(xt,"_logger",Object(l.getLogger)("AdsController"));var It=function(){function e(e){this._pluginManager=e}return e.prototype.getAdsControllers=function(){return Object.values(this._pluginManager.getAll()).filter((function(e){return"function"==typeof e.getAdsController})).map((function(e){return e.getAdsController()}))},e}();function Mt(e,t){return(Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Dt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Rt=function(e){var t,r;function a(t){var r;return Dt(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r=e.call(this)||this),"id","PluginReadinessMiddleware"),r._plugins=t,a._logger.debug("plugins readiness",r._plugins),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,Mt(t,r);var n=a.prototype;return n.load=function(e){this._checkNextSettle(0,e)},n._checkNextSettle=function(e,t){e<this._plugins.length?this._checkSettle(e,t):this.callNext(t)},n._checkSettle=function(e,t){var r=this;(this._plugins[e].ready?this._plugins[e].ready:Promise.resolve()).then((function(){a._logger.debug("plugin "+r._plugins[e].name+" ready promise resolved"),r._checkNextSettle(e+1,t)})).catch((function(){a._logger.debug("plugin "+r._plugins[e].name+" ready promise rejected"),r._checkNextSettle(e+1,t)}))},n.play=function(e){this._checkNextSettle(0,e)},a}(l.BaseMiddleware);function Ot(){return(Ot=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Lt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Dt(Rt,"_logger",Object(l.getLogger)("PluginReadinessMiddleware"));var Nt={thumbsWidth:164,thumbsHeight:92,thumbsSlices:100},Ut=/.*\/p\/\d+\/(?:[a-zA-Z]+\/\d+\/)*thumbnail\/entry_id\/\w+\/.*\d+/,Ft=function(){function e(e,t,r){var a=this;if(Lt(this,"_isUsingKalturaThumbnail",(function(){return!(!a._thumbnailConfig||!a._thumbnailConfig.thumbsSprite)})),Lt(this,"_convertKalturaThumbnailToThumbnailInfo",(function(e){if(a._thumbnailConfig){var t=a._thumbnailConfig,r=t.thumbsSprite,n=t.thumbsWidth,i=t.thumbsSlices,o=a._player.duration/i,s={x:Math.floor(e/o)*n,y:0,url:r,height:a._thumbsHeight,width:n};return new l.ThumbnailInfo(s)}})),Lt(this,"_buildKalturaThumbnailConfig",(function(e,t){var r,n=l.Utils.Object.getPropertyPath(e,"components.seekbar"),i=t.sources&&t.sources.poster,o=t.sources&&t.sources.type===l.MediaType.VOD,s=a._player.shouldAddKs(t)?null==(r=t.session)?void 0:r.ks:"",u=l.Utils.Object.mergeDeep(Nt,n);return Ot({thumbsSprite:o?a._getThumbSlicesUrl(i,s,u):""},u)})),Lt(this,"_getThumbSlicesUrl",(function(e,t,r){if("string"==typeof e&&Ut.test(e))try{var a=Ot({thumbnailUrl:e},r),n=oe("{{thumbnailUrl}}/width/{{thumbsWidth}}/vid_slices/{{thumbsSlices}}",a);return t?n+"/ks/"+t:n}catch(e){return""}return""})),this._player=e,this._thumbnailConfig=this._buildKalturaThumbnailConfig(t,r),this._eventManager=new l.EventManager,this._isUsingKalturaThumbnail()){var n,i=new Image;this._eventManager.listenOnce(i,"load",(function(){a._thumbsHeight=i.naturalHeight})),i.src=(null==(n=this._thumbnailConfig)?void 0:n.thumbsSprite)||""}}var t=e.prototype;return t.destroy=function(){this._eventManager.destroy()},t.getThumbnail=function(e){return this._isUsingKalturaThumbnail()?this._convertKalturaThumbnailToThumbnailInfo(e):this._player._localPlayer.getThumbnail(e)},t.getKalturaThumbnailConfig=function(){return this._thumbnailConfig},e}();function Bt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var jt=function(){function e(e){Bt(this,"_textTrack",null),this._player=e}var t=e.prototype;return t._addTextTrack=function(){this._textTrack=this._player.addTextTrack(l.TextTrack.KIND.METADATA,"CuePoints")},t._getMetadataTracks=function(){return this._player.getNativeTextTracks().filter((function(e){return e.kind===l.TextTrack.KIND.METADATA&&e.cues}))},t._createTextTrackCue=function(e){var t=e.startTime,r=e.endTime,a=e.id,n=e.metadata;return Object(l.createTextTrackCue)({startTime:t,endTime:r,id:a,type:l.TimedMetadata.TYPE.CUE_POINT,metadata:n})},t._cuesSorter=function(e,t){return e.startTime-t.startTime},t.getAllCuePoints=function(){return this._getMetadataTracks().reduce((function(e,t){return e.concat(Array.from(t.cues).map((function(e){return Object(l.createTimedMetadata)(e)})))}),[]).sort(this._cuesSorter)},t.getActiveCuePoints=function(){return this._getMetadataTracks().reduce((function(e,t){return e.concat(Array.from(t.activeCues).map((function(e){return Object(l.createTimedMetadata)(e)})))}),[]).sort(this._cuesSorter)},t._getTextTrackCueById=function(e){var t=null;return this._getMetadataTracks().some((function(r){return t=r.cues.getCueById(e)})),t},t._removeTextTrackCue=function(e){this._getMetadataTracks().forEach((function(t){try{t.removeCue(e)}catch(e){}}))},t.addCuePoints=function(e){var t=this;this._player.ready().then((function(){t._textTrack||t._addTextTrack();var r=[];e.forEach((function(e){var a,n=t._createTextTrackCue(e),i=t._getTextTrackCueById(e.id);i&&t._removeTextTrackCue(i),null==(a=t._textTrack)||a.addCue(n),r.push(Object(l.createTimedMetadata)(n))})),t._player.dispatchEvent(new l.FakeEvent(l.EventType.TIMED_METADATA_ADDED,{cues:r}))}))},t._clearAllTextTrackCues=function(){var e=this;this._getMetadataTracks().forEach((function(t){for(;t.cues.length;)e._removeTextTrackCue(t.cues[0])}))},t.reset=function(){this._clearAllTextTrackCues()},t.destroy=function(){this.reset()},e}();function Vt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $t=function(){function e(t){var r=this;Vt(this,"_servicesRegistry",new Map),e._logger=Object(l.getLogger)("ServiceProvider"),this._eventManager=new l.EventManager,this._eventManager.listen(t,t.Event.Core.PLAYER_RESET,(function(){return r.reset()}))}var t=e.prototype;return t.register=function(t,r){this._servicesRegistry.has(t)?e._logger.debug(t+" service already exists"):(this._servicesRegistry.set(t,r),e._logger.debug(t+" service registered"))},t.get=function(e){return this._servicesRegistry.get(e)},t.has=function(e){return this._servicesRegistry.has(e)},t.reset=function(){this._servicesRegistry.forEach((function(e){return"function"==typeof e.reset&&e.reset()}))},t.destroy=function(){this._servicesRegistry.forEach((function(e){return"function"==typeof e.destroy&&e.destroy()})),this._eventManager.removeAll(),this._servicesRegistry.clear()},e}();function Ht(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Gt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gt(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Kt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Kt=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),s=new A(n||[]);return a(o,"_invoke",{value:E(e,r,s)}),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function p(){}function h(){}function f(){}var g={};l(g,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(C([])));m&&m!==t&&r.call(m,i)&&(g=m);var v=f.prototype=p.prototype=Object.create(g);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){var n;a(this,"_invoke",{value:function(a,i){function o(){return new t((function(n,o){!function a(n,i,o,s){var l=c(e[n],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,o,s)}),(function(e){a("throw",e,o,s)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return a("throw",e,o,s)}))}s(l.arg)}(a,i,n,o)}))}return n=n?n.then(o,o):o()}})}function E(e,t,r){var a="suspendedStart";return function(n,i){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===n)throw i;return P()}for(r.method=n,r.arg=i;;){var o=r.delegate;if(o){var s=T(o,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===a)throw a="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a="executing";var l=c(e,t,r);if("normal"===l.type){if(a=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a="completed",r.method="throw",r.arg=l.arg)}}}function T(e,t){var r=t.method,a=e.iterator[r];if(void 0===a)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var n=c(a,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,n=function t(){for(;++a<e.length;)if(r.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=f,a(v,"constructor",{value:f,configurable:!0}),a(f,"constructor",{value:h,configurable:!0}),h.displayName=l(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},_(k.prototype),l(k.prototype,o,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new k(u(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(v),l(v,s,"Generator"),l(v,i,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var a in t)r.push(a);return r.reverse(),function e(){for(;r.length;){var a=r.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},e.values=C,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(r,a){return o.type="throw",o.arg=e,t.next=r,a&&(t.method="next",t.arg=void 0),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],o=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var n=a.arg;S(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function Wt(e,t,r,a,n,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function zt(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var i=e.apply(t,r);function o(e){Wt(i,a,n,o,s,"next",e)}function s(e){Wt(i,a,n,o,s,"throw",e)}o(void 0)}))}}var qt=[["widevine","com.widevine.alpha"],["playready","com.microsoft.playready"],["fairplay","com.apple.fps"]],Yt=Object(l.getLogger)("MediaCapabilities"),Xt=1,Qt=0,Jt=-1;function Zt(){return(Zt=zt(Kt().mark((function e(t){var r,a,n;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Yt.debug("Starting to get media capabilities..."),e.next=4,rr(t);case 4:return a=e.sent,e.next=7,er();case 7:return n=e.sent,r=Object.assign({},a,n),Yt.debug("Finished getting media capabilities ",{mediaCapabilities:r}),e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(0),Yt.debug("There was a problem with getting the media capabilities, ",e.t0.message),r={isHEVCSupported:Qt,isPowerEfficient:Qt,isDRMSupported:Qt,supportedDRMs:[]},Yt.debug("Returning media capabilities defaults ",{mediaCapabilities:r}),e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function er(){return tr.apply(this,arguments)}function tr(){return(tr=zt(Kt().mark((function e(){var t,r,a,n,i,o,s,l;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={isDRMSupported:Jt,supportedDRMs:[]},navigator.requestMediaKeySystemAccess){e.next=3;break}return e.abrupt("return",t);case 3:r=[{initDataTypes:["cenc"],videoCapabilities:[{contentType:'video/mp4;codecs="avc1.42E01E"'}]}],a=new Map(qt),n=Ht(a);case 6:if((i=n()).done){e.next=19;break}return o=i.value,s=o[0],l=o[1],e.prev=8,e.next=11,navigator.requestMediaKeySystemAccess(l,r);case 11:t.supportedDRMs.push(s),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),Yt.debug(l+" not supported ("+e.t0.name+": "+e.t0.message+").");case 17:e.next=6;break;case 19:return t.isDRMSupported=t.supportedDRMs.length>0?Xt:Qt,e.abrupt("return",t);case 21:case"end":return e.stop()}}),e,null,[[8,14]])})))).apply(this,arguments)}function rr(e){return ar.apply(this,arguments)}function ar(){return(ar=zt(Kt().mark((function e(t){var r,a,n;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={isHEVCSupported:Jt,isPowerEfficient:Jt},navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo){e.next=3;break}return e.abrupt("return",r);case 3:return a={type:"media-source",video:{contentType:'video/mp4; codecs="hvc1.1.6.L150.90"',width:(null==t?void 0:t.width)||1920,height:(null==t?void 0:t.height)||1080,bitrate:(null==t?void 0:t.bitrate)||12e5,framerate:(null==t?void 0:t.framerate)||30}},e.prev=4,e.next=7,navigator.mediaCapabilities.decodingInfo(a);case 7:n=e.sent,r.isHEVCSupported=n.supported?Xt:Qt,r.isPowerEfficient=n.powerEfficient?Xt:Qt,e.next=17;break;case 12:e.prev=12,e.t0=e.catch(4),Yt.debug("Failed to get the media capabilities from navigator. ("+e.t0.name+": "+e.t0.message+")."),r.isHEVCSupported=Jt,r.isPowerEfficient=Jt;case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}var nr=function(e){return Zt.apply(this,arguments)};function ir(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ir=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),s=new A(n||[]);return a(o,"_invoke",{value:E(e,r,s)}),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function p(){}function h(){}function f(){}var g={};l(g,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(C([])));m&&m!==t&&r.call(m,i)&&(g=m);var v=f.prototype=p.prototype=Object.create(g);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){var n;a(this,"_invoke",{value:function(a,i){function o(){return new t((function(n,o){!function a(n,i,o,s){var l=c(e[n],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,o,s)}),(function(e){a("throw",e,o,s)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return a("throw",e,o,s)}))}s(l.arg)}(a,i,n,o)}))}return n=n?n.then(o,o):o()}})}function E(e,t,r){var a="suspendedStart";return function(n,i){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===n)throw i;return P()}for(r.method=n,r.arg=i;;){var o=r.delegate;if(o){var s=T(o,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===a)throw a="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a="executing";var l=c(e,t,r);if("normal"===l.type){if(a=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a="completed",r.method="throw",r.arg=l.arg)}}}function T(e,t){var r=t.method,a=e.iterator[r];if(void 0===a)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var n=c(a,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,n=function t(){for(;++a<e.length;)if(r.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=f,a(v,"constructor",{value:f,configurable:!0}),a(f,"constructor",{value:h,configurable:!0}),h.displayName=l(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},_(k.prototype),l(k.prototype,o,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new k(u(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(v),l(v,s,"Generator"),l(v,i,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var a in t)r.push(a);return r.reverse(),function e(){for(;r.length;){var a=r.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},e.values=C,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(r,a){return o.type="throw",o.arg=e,t.next=r,a&&(t.method="next",t.arg=void 0),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],o=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var n=a.arg;S(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function or(e,t,r,a,n,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function sr(){return(sr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function lr(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,pr(a.key),a)}}function ur(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cr(e,t){return(cr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function dr(e,t,r){return(t=pr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pr(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var hr=function(e){var t,r;function a(t){var r;dr(ur(r=e.call(this)||this),"_eventManager",new l.EventManager),dr(ur(r),"_mediaInfo",null),dr(ur(r),"_remotePlayer",null),dr(ur(r),"_pluginManager",new Z),dr(ur(r),"_pluginsConfig",{}),dr(ur(r),"_reset",!0),dr(ur(r),"_firstPlay",!0),dr(ur(r),"_sourceSelected",null),dr(ur(r),"_appPluginConfig",{}),dr(ur(r),"_thumbnailManager",null),dr(ur(r),"_isVisible",!1),dr(ur(r),"_autoPaused",!1);var a=t.sources,n=t.plugins;r._configEvaluator=new pe,r._configEvaluator.evaluatePluginsConfig(n,t),r._playbackStart=!1;var i=l.Utils.Object.mergeDeep({},t);delete i.plugins,delete i.sources,r._localPlayer=Object(l.loadPlayer)(i),r._controllerProvider=new It(r._pluginManager),r._viewabilityManager=new R(r.config.viewability),r._uiWrapper=new me(ur(r),l.Utils.Object.mergeDeep(t,{ui:{logger:{getLogger:l.getLogger,LogLevel:l.LogLevel}}})),r._serviceProvider=new $t(ur(r)),r._cuepointManager=new jt(ur(r)),r._provider=new c.Provider(l.Utils.Object.mergeDeep(t.provider,{logger:{getLogger:l.getLogger,LogLevel:l.LogLevel}}),"3.13.1-test-shaka-9-4-23.5"),r._playlistManager=new we(ur(r),t),Object.values(l.EventType).forEach((function(e){return r._eventManager.listen(r._localPlayer,e,(function(e){return r.dispatchEvent(e)}))})),r._addBindings();var o=l.Utils.Object.mergeDeep({},t.playlist,{items:null});return r._playlistManager.configure(o),r.configure({plugins:n}),r._playlistManager.configure({items:t.playlist&&t.playlist.items||[]}),r._localPlayer.setSources(a||{}),r._remotePlayerManager=new ht,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,cr(t,r);var n,i,o,s=a.prototype;return s.loadMedia=function(e,t){var r=this;return a._logger.debug("loadMedia",e),this._mediaInfo=e,this.reset(),this._localPlayer.loadingMedia=!0,this._uiWrapper.setLoadingSpinnerState(!0),new Promise((function(a,n){r._provider.getMediaConfig(e).then((function(e){var n=l.Utils.Object.copyDeep(e);t&&(n.sources=n.sources||{},n.sources=l.Utils.Object.mergeDeep(n.sources,t));var i=q(n.plugins,r.config.plugins);n.plugins=i[0],r._appPluginConfig=i[1],r.configure(p({sources:r.sources},n)),r.setMedia(n),a(n)}),(function(e){var t=new l.Error(l.Error.Severity.CRITICAL,l.Error.Category.PLAYER,l.Error.Code.LOAD_FAILED,e);r._localPlayer.dispatchEvent(new l.FakeEvent(l.EventType.ERROR,t)),n(e)}))}))},s.setMedia=function(e){a._logger.debug("setMedia",e),this.reset(!0);var t=l.Utils.Object.copyDeep(e),r=l.Utils.Object.mergeDeep({},t.sources,this._localPlayer.sources);delete t.sources,l.Utils.Object.mergeDeep(t.session,this._localPlayer.config.session),t.plugins=t.plugins||{},Object.keys(this._pluginsConfig).forEach((function(e){t.plugins[e]=t.plugins[e]||{}})),this.configure({session:e.session}),W(r)||z(r)?this._thumbnailManager=null:this._thumbnailManager=new Ft(this,this.config.ui,e),this.updateKalturaPoster(r,e.sources,this._localPlayer.dimensions),D(this,sr({},t,{sources:r}));var n=function(e,t){return t&&W(t)?K(e,"youtube","progressive"):t&&z(t)?K(e,"image","image"):null}(this,r);n&&(t.playback=n),this.configure(sr({},t,{sources:r}))},s.updateKalturaPoster=function(e,t,r){var a,n;he(e,t,r,this.shouldAddKs()&&(null==(a=this.config)||null==(n=a.session)||n.ks))},s.shouldAddKs=function(e){var t,r;return!(!this.config.provider.loadThumbnailWithKs||!1!==(null==(t=e||this.config)||null==(r=t.session)?void 0:r.isAnonymous))},s.loadPlaylist=function(e,t){var r=this;return a._logger.debug("loadPlaylist",e),this._uiWrapper.setLoadingSpinnerState(!0),new Promise((function(a,n){r._provider.getPlaylistConfig(e).then((function(e){r.setPlaylist(e,t),a(e)}),(function(e){var t=new l.Error(l.Error.Severity.CRITICAL,l.Error.Category.PLAYER,l.Error.Code.LOAD_FAILED,e);r._localPlayer.dispatchEvent(new l.FakeEvent(l.EventType.ERROR,t)),n(e)}))}))},s.loadPlaylistByEntryList=function(e,t){var r=this;return a._logger.debug("loadPlaylistByEntryList",e),this._uiWrapper.setLoadingSpinnerState(!0),new Promise((function(a,n){r._provider.getEntryListConfig(e).then((function(n){r.setPlaylist(n,t,e),a(n)}),(function(e){var t=new l.Error(l.Error.Severity.CRITICAL,l.Error.Category.PLAYER,l.Error.Code.LOAD_FAILED,e);r._localPlayer.dispatchEvent(new l.FakeEvent(l.EventType.ERROR,t)),n(e)}))}))},s.setPlaylist=function(e,t,r){a._logger.debug("setPlaylist",e);var n={playlist:e,plugins:{}};Object.keys(this._pluginsConfig).forEach((function(e){n.plugins[e]={}})),this._configEvaluator.evaluatePluginsConfig(n.plugins,n),this._configureOrLoadPlugins(n.plugins),this._playlistManager.load(e,t,r)},s.getMediaInfo=function(){return l.Utils.Object.copyDeep(this._mediaInfo)},s.getDrmInfo=function(){return this._localPlayer.getDrmInfo()},s.getMediaConfig=function(){var e={sources:this._localPlayer.sources,plugins:this._pluginsConfig};return l.Utils.Object.copyDeep(e)},s.setSourcesMetadata=function(e){this._localPlayer.setSourcesMetadata(e)},s.configure=function(e){void 0===e&&(e={}),e=G(e);var t=l.Utils.Object.mergeDeep({},this.config,e);this._configEvaluator.evaluatePluginsConfig(e.plugins,t),this._configureOrLoadPlugins(e.plugins);var r=l.Utils.Object.mergeDeep({},e);if(delete r.plugins,r.sources){var a=r.sources;delete r.sources,this._localPlayer.configure(r),this._localPlayer.setSources(a||{})}else this._localPlayer.configure(r);e.ui&&this._uiWrapper.setConfig(t.ui),e.playlist&&this._playlistManager.configure(e.playlist)},s.ready=function(){return this._localPlayer.ready()},s.load=function(){this._localPlayer.load()},s.play=function(){this._localPlayer.play()},s.pause=function(){this._localPlayer.pause()},s.getView=function(){return this._localPlayer.getView()},s.getVideoElement=function(){return this._localPlayer.getVideoElement()},s.reset=function(e){var t;(void 0===e&&(e=!1),this._reset)||(this._reset=!0,this._firstPlay=!0,this._sourceSelected=null,this._attachEventManager&&this._attachEventManager.removeAll(),this._uiWrapper.reset(),this._resetProviderPluginsConfig(),this._pluginManager.reset(),this._cuepointManager.reset(),this._localPlayer.reset(e),null==(t=this._thumbnailManager)||t.destroy())},s.destroy=function(){var e,t=this.config.ui.targetId;this._reset=!0,this._playbackStart=!1,this._firstPlay=!0,this._uiWrapper.destroy(),this._pluginManager.destroy(),this._cuepointManager.destroy(),this._playlistManager.destroy(),this._localPlayer.destroy(),this._eventManager.destroy(),null==(e=this._thumbnailManager)||e.destroy(),this._viewabilityManager.destroy(),this._remotePlayerManager.destroy(),this._pluginsConfig={};var r=document.getElementById(t);r&&r.parentNode&&l.Utils.Dom.removeChild(r.parentNode,r)},s.isLive=function(){return this._localPlayer.isLive()},s.isOnLiveEdge=function(){return this._localPlayer.isOnLiveEdge()},s.isDvr=function(){return this._localPlayer.isDvr()},s.isUntimedImg=function(){return z(this.sources)&&!("number"==typeof this.config.sources.duration&&this.config.sources.duration>0)},s.isImage=function(){return z(this.sources)},s.seekToLiveEdge=function(){this._localPlayer.seekToLiveEdge()},s.getStartTimeOfDvrWindow=function(){return this._localPlayer.getStartTimeOfDvrWindow()},s.getTracks=function(e){return this._localPlayer.getTracks(e)},s.getActiveTracks=function(){return this._localPlayer.getActiveTracks()},s.selectTrack=function(e){this._localPlayer.selectTrack(e)},s.hideTextTrack=function(){this._localPlayer.hideTextTrack()},s.showTextTrack=function(){this._localPlayer.showTextTrack()},s.enableAdaptiveBitrate=function(){this._localPlayer.enableAdaptiveBitrate()},s.isAdaptiveBitrateEnabled=function(){return this._localPlayer.isAdaptiveBitrateEnabled()},s.setTextDisplaySettings=function(e){this._localPlayer.setTextDisplaySettings(e)},s.isFullscreen=function(){return this._localPlayer.isFullscreen()},s.notifyEnterFullscreen=function(){this._localPlayer.notifyEnterFullscreen()},s.notifyExitFullscreen=function(){this._localPlayer.notifyExitFullscreen()},s.enterFullscreen=function(e){var t=e||this.config.ui.targetId;this._localPlayer.enterFullscreen(t)},s.exitFullscreen=function(){this._localPlayer.exitFullscreen()},s.enterPictureInPicture=function(){this._localPlayer.enterPictureInPicture()},s.exitPictureInPicture=function(){this._localPlayer.exitPictureInPicture()},s.isInPictureInPicture=function(){return this._localPlayer.isInPictureInPicture()},s.isPictureInPictureSupported=function(){return this._localPlayer.isPictureInPictureSupported()},s.getLogLevel=function(e){return this._localPlayer.getLogLevel(e)},s.startCasting=function(e){var t=this;return this.setIsCastInitiator(e,!0),new Promise((function(r,a){t.remotePlayerManager.startCasting(e).then(r).catch((function(){t.setIsCastInitiator(e,!1),a()}))}))},s.setIsCastInitiator=function(e,t){this._remotePlayerManager.setIsCastInitiator(e,t)},s.isCastAvailable=function(e){return this._remotePlayerManager.isCastAvailable(e)},s.getCastSession=function(){return null},s.stopCasting=function(){},s.isCasting=function(){return!1},s.isVr=function(){return this._localPlayer.isVr()},s.toggleVrStereoMode=function(){var e=this._pluginManager.get("vr");e&&"function"==typeof e.toggleVrStereoMode&&e.toggleVrStereoMode()},s.isInVrStereoMode=function(){var e=this._pluginManager.get("vr");return!(!e||"function"!=typeof e.isInStereoMode)&&e.isInStereoMode()},s.setLogLevel=function(e,t){this._localPlayer.setLogLevel(e,t)},s.getThumbnail=function(e){if(!e){if(isNaN(this.currentTime))return null;e=this.currentTime}if(e=this.isLive()?e+this.getStartTimeOfDvrWindow():e,this._thumbnailManager)return this._thumbnailManager.getThumbnail(e)},s._addBindings=function(){var e=this;this._eventManager.listen(this,l.EventType.CHANGE_SOURCE_STARTED,(function(){return e._onChangeSourceStarted()})),this._eventManager.listen(this,l.EventType.CHANGE_SOURCE_ENDED,(function(){return e._onChangeSourceEnded()})),this._eventManager.listen(this,l.EventType.PLAYER_RESET,(function(){return e._onPlayerReset()})),this._eventManager.listen(this,l.EventType.ENDED,(function(){return e._onEnded()})),this._eventManager.listen(this,l.EventType.FIRST_PLAY,(function(){return e._firstPlay=!1})),this._eventManager.listen(this,l.EventType.SOURCE_SELECTED,(function(t){return e._sourceSelected=t.payload.selectedSource[0]})),this._eventManager.listen(this,l.EventType.PLAYBACK_ENDED,(function(){return e._onPlaybackEnded()})),this._eventManager.listen(this,l.EventType.PLAYBACK_START,(function(){e._playbackStart=!0})),this._eventManager.listen(this,l.AdEventType.AD_AUTOPLAY_FAILED,(function(t){return e._onAdAutoplayFailed(t)})),this._eventManager.listen(this,l.AdEventType.AD_STARTED,(function(){return e._onAdStarted()})),this.config.playback.playAdsWithMSE&&(this._attachEventManager=new l.EventManager,this._eventManager.listen(this,l.AdEventType.AD_LOADED,(function(t){var r=t.payload.ad;r&&r.linear&&1===r.position&&!r.inStream&&e.src?(e._attachEventManager.listenOnce(e,l.AdEventType.AD_BREAK_START,(function(){return e.detachMediaSource()})),e._attachEventManager.listenOnce(e,l.AdEventType.AD_BREAK_END,(function(){return e.attachMediaSource()})),e._attachEventManager.listenOnce(e,l.AdEventType.AD_ERROR,(function(){return e.attachMediaSource()}))):e._attachEventManager.removeAll()}))),this._eventManager.listen(this,l.EventType.ERROR,(function(t){t.payload.severity===l.Error.Severity.CRITICAL&&(e._reset=!1)}))},s._onChangeSourceEnded=function(){l.Utils.Object.getPropertyPath(this.config,"ui.targetId")?this._viewabilityManager.observe(l.Utils.Dom.getElementById(this.config.ui.targetId),this._handleVisibilityChange.bind(this)):a._logger.warn("Cannot observe visibility change without config.ui.targetId")},s._onPlayerReset=function(){this._playbackStart=!1,l.Utils.Object.getPropertyPath(this.config,"ui.targetId")&&this._viewabilityManager.unObserve(l.Utils.Dom.getElementById(this.config.ui.targetId),this._handleVisibilityChange.bind(this))},s._onChangeSourceStarted=function(){this._configureOrLoadPlugins(this._pluginsConfig),this.reset(),this._pluginManager.loadMedia(),this._reset=!1},s._onEnded=function(){var e=this;setTimeout((function(){e._adsController&&!e._adsController.allAdsCompleted?e._eventManager.listenOnce(e._adsController,l.AdEventType.ALL_ADS_COMPLETED,(function(){e.dispatchEvent(new l.FakeEvent(l.EventType.PLAYBACK_ENDED))})):e.dispatchEvent(new l.FakeEvent(l.EventType.PLAYBACK_ENDED))}))},s._onPlaybackEnded=function(){this.config.playback.loop&&(this.currentTime=0,this.play())},s._onAdStarted=function(){this._firstPlay&&(this._localPlayer.posterManager.hide(),this._localPlayer.hideBlackCover())},s._onAdAutoplayFailed=function(e){this._firstPlay&&this.config.playback.autoplay&&(this._localPlayer.posterManager.show(),this.dispatchEvent(new l.FakeEvent(l.EventType.AUTOPLAY_FAILED,e.payload)))},s._configureOrLoadPlugins=function(e){var t=this;void 0===e&&(e={});var r=[],a=[],n=[];Object.keys(e).forEach((function(i){var o=t._pluginManager.get(i);if(o)o.updateConfig(e[i]),e[i]=o.getConfig();else if(t._sourceSelected)delete e[i];else{try{t._pluginManager.load(i,t,e[i])}catch(e){t.dispatchEvent(new l.FakeEvent(l.Error.Code.ERROR,e))}var s=t._pluginManager.get(i);s&&(n.push(s),e[i]=s.getConfig(),"function"==typeof s.getMiddlewareImpl&&("bumper"===s.name?r.push(s.getMiddlewareImpl()):r.unshift(s.getMiddlewareImpl())),"function"==typeof s.getUIComponents&&a.push.apply(a,s.getUIComponents()||[]),"function"==typeof s.getEngineDecorator&&t._localPlayer.registerEngineDecoratorProvider(new l.EngineDecoratorProvider(s)))}})),a.forEach((function(e){return t._uiWrapper.addComponent(e)})),this._pluginReadinessMiddleware||(this._pluginReadinessMiddleware=new Rt(n),this._localPlayer.playbackMiddleware.use(this._pluginReadinessMiddleware)),this._maybeCreateAdsController(),r.forEach((function(e){return t._localPlayer.playbackMiddleware.use(e)})),l.Utils.Object.mergeDeep(this._pluginsConfig,e)},s._maybeCreateAdsController=function(){var e=this;if(!this._adsController){var t=this._controllerProvider.getAdsControllers();t.length&&(this._adsController=new xt(this,t),this._localPlayer.playbackMiddleware.use(this._adsController.getMiddleware()),this._eventManager.listen(this._adsController,l.AdEventType.ALL_ADS_COMPLETED,(function(t){e.dispatchEvent(t)})))}},s.attachMediaSource=function(){this._localPlayer.attachMediaSource()},s.detachMediaSource=function(){this._localPlayer.detachMediaSource()},s._resetProviderPluginsConfig=function(){this.configure({plugins:this._appPluginConfig}),this._appPluginConfig={}},s._handleVisibilityChange=function(e){this._isVisible=e,this.dispatchEvent(new l.FakeEvent("visibilitychange",{visible:this._isVisible})),this.config.playback.autoplay===l.AutoPlayType.IN_VIEW&&this._isVisible&&!this._playbackStart&&this._localPlayer.play({programmatic:!0}),!0===this.config.playback.autopause&&this._handleAutoPause(e)},s._handleAutoPause=function(e){var t=!this.paused||this._adsController&&this._adsController.isAdPlaying(),r=!this.isInPictureInPicture()&&this._playbackStart&&t;e?this._autoPaused&&(this.paused&&this.play(),this._autoPaused=!1):r&&(this.pause(),this._autoPaused=!0)},s.getService=function(e){return this._serviceProvider.get(e)},s.hasService=function(e){return this._serviceProvider.has(e)},s.registerService=function(e,t){this._serviceProvider.register(e,t)},s.addTextTrack=function(e,t){return this._localPlayer.addTextTrack(e,t)},s.getNativeTextTracks=function(){return this._localPlayer.getNativeTextTracks()},s.getMediaCapabilities=function(){var e,t=(e=ir().mark((function e(t){return ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nr(t));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(a,n){var i=e.apply(t,r);function o(e){or(i,a,n,o,s,"next",e)}function s(e){or(i,a,n,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),n=a,(i=[{key:"textDisplaySetting",get:function(){return this._localPlayer.textDisplaySetting}},{key:"textStyle",get:function(){return this._localPlayer.textStyle},set:function(e){this._localPlayer.textStyle=e}},{key:"buffered",get:function(){return this._localPlayer.buffered}},{key:"stats",get:function(){return this._localPlayer.stats}},{key:"currentTime",get:function(){return this._localPlayer.currentTime},set:function(e){this._localPlayer.currentTime=e}},{key:"duration",get:function(){return this._localPlayer.duration}},{key:"liveDuration",get:function(){return this._localPlayer.liveDuration}},{key:"normalizedCurrentTime",get:function(){return this.isLive()?this.currentTime-this.getStartTimeOfDvrWindow():this.currentTime},set:function(e){this.isLive()?this.currentTime=e+this.getStartTimeOfDvrWindow():this.currentTime=e}},{key:"normalizedDuration",get:function(){return this.isLive()?this.liveDuration-this.getStartTimeOfDvrWindow():this.duration}},{key:"volume",get:function(){return this._localPlayer.volume},set:function(e){this._localPlayer.volume=e}},{key:"paused",get:function(){return this._localPlayer.paused}},{key:"seeking",get:function(){return this._localPlayer.seeking}},{key:"playsinline",get:function(){return this._localPlayer.playsinline},set:function(e){this._localPlayer.playsinline=e}},{key:"muted",get:function(){return this._localPlayer.muted},set:function(e){this._localPlayer.muted=e}},{key:"src",get:function(){return this._localPlayer.src}},{key:"videoHeight",get:function(){return this._localPlayer.videoHeight}},{key:"videoWidth",get:function(){return this._localPlayer.videoWidth}},{key:"dimensions",get:function(){return this._localPlayer.dimensions},set:function(e){this._localPlayer.dimensions=e}},{key:"poster",get:function(){return this._localPlayer.poster}},{key:"ended",get:function(){return this._localPlayer.ended}},{key:"playbackRate",get:function(){return this._localPlayer.playbackRate},set:function(e){this._localPlayer.playbackRate=e}},{key:"playbackRates",get:function(){return this._localPlayer.playbackRates}},{key:"defaultPlaybackRate",get:function(){return this._localPlayer.defaultPlaybackRate}},{key:"engineType",get:function(){return this._localPlayer.engineType}},{key:"streamType",get:function(){return this._localPlayer.streamType}},{key:"env",get:function(){return this._localPlayer.env}},{key:"selectedSource",get:function(){return this._sourceSelected}},{key:"sources",get:function(){return sr({},this._localPlayer.sources)}},{key:"config",get:function(){return sr({},this._localPlayer.config,{plugins:this._pluginsConfig,sources:this._localPlayer.sources})}},{key:"hasUserInteracted",get:function(){return this._localPlayer.hasUserInteracted}},{key:"loadingMedia",set:function(e){this._localPlayer.loadingMedia=e}},{key:"ads",get:function(){return this._adsController}},{key:"plugins",get:function(){return this._pluginManager.getAll()}},{key:"provider",get:function(){return this._provider}},{key:"ui",get:function(){return this._uiWrapper}},{key:"playlist",get:function(){return this._playlistManager}},{key:"Event",get:function(){return sr({Cast:xe,Core:l.EventType,Playlist:ve,UI:u.EventType},l.EventType,{VISIBILITY_CHANGE:"visibilitychange"})}},{key:"TextStyle",get:function(){return this._localPlayer.TextStyle}},{key:"ViewabilityType",get:function(){return O}},{key:"State",get:function(){return this._localPlayer.State}},{key:"Track",get:function(){return this._localPlayer.Track}},{key:"LogLevelType",get:function(){return this._localPlayer.LogLevelType}},{key:"LogLevel",get:function(){return this._localPlayer.LogLevel}},{key:"AbrMode",get:function(){return this._localPlayer.AbrMode}},{key:"MediaType",get:function(){return this._localPlayer.MediaType}},{key:"StreamType",get:function(){return this._localPlayer.StreamType}},{key:"EngineType",get:function(){return this._localPlayer.EngineType}},{key:"Error",get:function(){return this._localPlayer.Error}},{key:"crossOrigin",get:function(){return this._localPlayer.crossOrigin},set:function(e){this._localPlayer.crossOrigin=e}},{key:"isVisible",get:function(){return this._isVisible}},{key:"viewabilityManager",get:function(){return this._viewabilityManager}},{key:"cuePointManager",get:function(){return this._cuepointManager}},{key:"remotePlayerManager",get:function(){return this._remotePlayerManager}}])&&lr(n.prototype,i),o&&lr(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(l.FakeEventTarget);dr(hr,"_logger",Object(l.getLogger)("KalturaPlayer"+l.Utils.Generator.uniqueId(5)));var fr={};function gr(){return fr}function yr(e){return fr[e]?fr[e]:null}var mr=["_remotePlayer","_listeners","_uiWrapper"],vr={get:function(e,t){if("destroy"===t){var r=e.config.targetId;delete fr[r]}return t in l.FakeEventTarget.prototype||mr.includes(t)?e[t]:e._remotePlayer&&t in e._remotePlayer?e._remotePlayer[t]:e[t]},set:function(e,t,r){return e._remotePlayer&&!mr.includes(t)?t in e._remotePlayer&&(e._remotePlayer[t]=r):e[t]=r,!0}};function _r(e){!function(e){!1!==l.Utils.Object.getPropertyPath(e,"log.playerVersion")&&(Object(l.setLogLevel)(l.LogLevel.INFO),Object(l.getLogger)().log("%c kaltura-player-js 3.13.1-test-shaka-9-4-23.5","color: #ff98f9;  font-size: large"),Object(l.getLogger)().log("%c For more details see https://github.com/kaltura/kaltura-player-js","color: #ff98f9;"))}(e),B(e=G(e));var t=H(e);!function(e){var t,r=e.provider,a=null==(t=$())?void 0:t.productVersion;if(!r.partnerId||2504201===r.partnerId){var n={url:"https://analytics.kaltura.com/api_v3/index.php?service=analytics&action=trackEvent&apiVersion=3.3.0&format=1&eventType=1&partnerId=2504201&entryId=1_3bwzbc9o&&eventIndex=1&position=0",mimetype:""};n.url=function(e,t){return t&&(e+="&clientVer="+t),e}(n.url,a),n.url=x(n.url),n.url=M(n.url,a),n.url=P(n.url,l.Utils.Generator.guid()+":"+l.Utils.Generator.guid()),navigator.sendBeacon&&navigator.sendBeacon(n.url)}}(t),j(t),function(e){var t=parseFloat(V("kalturaStartTime"));isNaN(t)||l.Utils.Object.createPropertyPath(e,"sources.startTime",t)}(t),F.forEach((function(e){return Object(l.getLogger)("KalturaPlayer:Setup")[e.level](e.msg)})),function(e){!e.disableUserCache&&E.isLocalStorageAvailable()&&E.hasStorage()&&l.Utils.Object.mergeDeep(e,E.getStorageConfig())}(t);var r=function(e){var t=new hr(e),r=new Proxy(t,vr);return fr[e.targetId]=r,r}(t);return function(e){if(!e.config.disableUserCache&&E.isLocalStorageAvailable()){var t=E.getPlayerTextStyle();t&&(e.textStyle=l.Utils.Object.mergeDeep(new l.TextStyle,t))}}(r),function(e){E.isLocalStorageAvailable()&&E.attach(e)}(r),function(e,t){e.cast&&t.remotePlayerManager.load(e.cast,t)}(t,r),function(e){if(l.Env.isIOS||l.Env.isIPadOS){var t=function t(){e.removeEventListener(e.Event.UI.UI_CLICKED,t),Object(l.setCapabilities)(l.EngineType.HTML5,{autoplay:!0})};e.addEventListener(e.Event.SOURCE_SELECTED,(function r(){e.removeEventListener(e.Event.SOURCE_SELECTED,r),e.addEventListener(e.Event.UI.UI_CLICKED,t)}))}}(r),r}var kr=function(){function e(){}return e.toCastTextStyle=function(t){if(window.chrome&&window.chrome.cast){var r=new window.chrome.cast.media.TextTrackStyle;return r.fontFamily=t.fontFamily,r.backgroundColor=e.rgbToHex(t.backgroundColor),r.foregroundColor=e.rgbToHex(t.fontColor),r.fontScale=Number.parseFloat(t.fontSize)/100,r}return{}},e.toPlayerTextStyle=function(t){var r=new l.TextStyle;return r.fontFamily=t.fontFamily,r.fontSize=100*t.fontScale+"%",r.fontColor=e.hexToRGB(t.foregroundColor),r.backgroundColor=e.hexToRGB(t.backgroundColor),r},e.rgbToHex=function(e){var t="#"+("0"+parseInt(e[0],10).toString(16)).slice(-2)+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2);if(e[3]){var r=e[3];r=Math.round(100*r)/100,t+=(Math.round(255*r)+65536).toString(16).substr(-2).toUpperCase()}else t+="FF";return t.toUpperCase()},e.hexToRGB=function(e){for(var t=[],r=(e=e.slice(1)).match(/.{1,2}/g),a=0;a<3;a++){var n=r&&r[a];n&&t.push(parseInt(n,16))}return t},e}();function Er(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Tr(e,t)}function Tr(e,t){return(Tr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var br={ACTION:"action",EVENT:"event"},Sr=function(e){this.type=e},Ar=function(e){function t(t,r){var a;return(a=e.call(this,br.EVENT)||this).event=t,a.payload=r,a}return Er(t,e),t}(Sr),Cr=function(e){function t(t,r){var a;return(a=e.call(this,br.ACTION)||this).action=t,a.args=r,a}return Er(t,e),t}(Sr),Pr={registerRemotePlayer:ht.register,PlayerSnapshot:Ie,RemoteControl:Ze,RemoteSession:Le,BaseRemotePlayer:je,RemoteConnectedPayload:Xe,RemoteDisconnectedPayload:Qe,RemoteAvailablePayload:Je,RemotePlayerUI:He,CastEventType:xe,RemotePlayerType:{CHROMECAST:"chromecast"},TextStyleConverter:kr,CustomEventMessage:Ar,CustomActionMessage:Cr,CustomMessageType:br,CustomActionType:{SKIP_AD:"skipAd"},CustomMessage:Sr},wr={PlaylistEventType:ve},xr="kaltura-player-js",Ir="ott",Mr="3.13.1-test-shaka-9-4-23.5";a.a.installAll(),l.Ad=_t,l.AdBreak=yt,l.BasePlugin=Q,l.registerPlugin=ee}]);
//# sourceMappingURL=kaltura-tv-player.js.map